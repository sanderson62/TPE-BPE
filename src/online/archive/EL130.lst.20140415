* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page   1
* EL130.cbl
* Options: int("EL130.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL130.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL130.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL130.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL130 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/18/95 07:28:16.
     7*                            VMOD=2.055.
     8*
     9*
    10*AUTHOR.     LOGIC,INC.
    11*            DALLAS, TEXAS.
    12
    13*REMARKS.    TRANSACTION - EX19 - NEW CLAIM SETUP
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page   2
* EL130.cbl
    14*
    15******************************************************************
    16*                   C H A N G E   L O G
    17*
    18* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    19*-----------------------------------------------------------------
    20*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    21* EFFECTIVE    NUMBER
    22*-----------------------------------------------------------------
    23* 041002    2002040200004  SMVA  MAKE SURE CLAIM TYPE IS ALWAYS
    24*                               POPULATED -MOVE PI-LAST-CLAIM-TYPE
    25* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYP I
    26* 031405                   PEMA  ADD PROCESSING FOR NEW CLAM TYP G
    27* 050807    2007020800002  AJRA  AUTO POPULATE I1 ADDRESS FROM CER
    28* 071508    2008071000003  AJRA  ADD EDIT FOR SOC SEC NUMBER
    29* 012009    2007042600001  PEMA  RESTRICT CLAIM TYPE FOR CID
    30* 041309    2009031600001  AJRA  ADD VIN TO DIAG FOR BENE 55 AND 5
    31* 100809    2009081800004  AJRA  ADD MSG FOR BENE CD 2O - 2V
    32* 061511    2011042000002  AJRA  VERIFY 2ND BENEFICIARY SSN
    33* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
    34* 020513  CR2011090100001  PEMA  FORCE ENTRY OF SEX CODE
    35* 020613    2012092400007  AJRA  ADD CAUSAL STATE MESSAGE
    36* 042413    2013042300001  AJRA  FIX SPECIAL MSG WHEN MULTIPLE CER
    37* 052113    2012113000002  PEMA  ADD SPECIAL STUFF FOR SPP DDF
    38* 032514    2013111100001  AJRA  VERIFY SSN FOR DISAB PMTS
    39******************************************************************
    40
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page   3
* EL130.cbl
    42 ENVIRONMENT DIVISION.
    43 DATA DIVISION.
    44 WORKING-STORAGE SECTION.
    45 01  DFH-START PIC X(04).
    46 77  FILLER  PIC X(32)  VALUE '********************************'.
    47 77  FILLER  PIC X(32)  VALUE '*    EL130 WORKING STORAGE     *'.
    48 77  FILLER  PIC X(32)  VALUE '********** VMOD=2.055 **********'.
    49 77  A1                          PIC S999 COMP-3 VALUE +0.
    50 77  E1                          PIC S999 COMP-3 VALUE +0.
    51 77  s1                          pic s999 comp-3 value +0.
    52 77  s2                          pic s999 comp-3 value +0.
    53 77  P1                          PIC S999 COMP-3 VALUE +0.
    54 77  P2                          PIC S999 COMP-3 VALUE +0.
    55 77  WS-CRIT-PER-RECURRENT       PIC X     VALUE ' '.
    56 77  WS-MAX-BENEFITS             PIC 99    VALUE ZEROS.
    57 77  WS-CRIT-PER-RTW-MOS         PIC 99    VALUE ZEROS.
    58 77  WS-EXCL-PERIOD              PIC S999 COMP-3 VALUE +0.
    59 77  WS-COV-ENDS                 PIC S999 COMP-3 VALUE +0.
    60 77  WS-ACC-PERIOD               PIC S999 COMP-3 VALUE +0.
    61 77  WS-MONTHS-BETWEEN           PIC S999 COMP-3 VALUE +0.
    62 77  WS-ERPDEF-SW                PIC X     VALUE ' '.
    63     88  ERPDEF-FOUND                 VALUE 'Y'.
    64 77  ws-monthly-benefit          pic s9(11)v99 comp-3 value +0.
    65 77  WS-BENEFITS-PREV-PAID       PIC S9(4)V999 VALUE +0  COMP-3.
    66 77  ws-dcc-product-code         pic xxx value spaces.
    67
    68*    COPY ELCSCTM.
    69******************************************************************
    70*                                                                *
    71*                                                                *
    72*                            ELCSCTM                             *
    73*                            VMOD=2.001                          *
    74*                                                                *
    75*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    76*                                                                *
    77******************************************************************
    78 01  SECURITY-MESSAGE.
    79     12  FILLER                          PIC X(30)
    80            VALUE '** LOGIC SECURITY VIOLATION -'.
    81     12  SM-READ                         PIC X(6).
    82     12  FILLER                          PIC X(5)
    83            VALUE ' PGM='.
    84     12  SM-PGM                          PIC X(6).
    85     12  FILLER                          PIC X(5)
    86            VALUE ' OPR='.
    87     12  SM-PROCESSOR-ID                 PIC X(4).
    88     12  FILLER                          PIC X(6)
    89            VALUE ' TERM='.
    90     12  SM-TERMID                       PIC X(4).
    91     12  FILLER                          PIC XX   VALUE SPACE.
    92     12  SM-JUL-DATE                     PIC 9(5).
    93     12  FILLER                          PIC X    VALUE SPACE.
    94     12  SM-TIME                         PIC 99.99.
    95
    96
    97*    COPY ELCSCRTY.
    98******************************************************************
    99*                                                                *
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page   4
* EL130.cbl
   100*                                                                *
   101*                            ELCSCRTY                            *
   102*                            VMOD=2.001                          *
   103*                                                                *
   104*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   105*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   106*        SAVED IN PI-SECURITY-ADDRESS.                           *
   107*                                                                *
   108******************************************************************
   109 01  SECURITY-CONTROL.
   110     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   111     12  FILLER                       PIC XX    VALUE 'SC'.
   112     12  SC-CREDIT-CODES.
   113         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   114             20  SC-CREDIT-DISPLAY    PIC X.
   115             20  SC-CREDIT-UPDATE     PIC X.
   116     12  SC-CLAIMS-CODES.
   117         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   118             20  SC-CLAIMS-DISPLAY    PIC X.
   119             20  SC-CLAIMS-UPDATE     PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page   5
* EL130.cbl
   121 01  WS-DATE-AREA.
   122     05  SAVE-DATE           PIC X(8)    VALUE SPACES.
   123     05  SAVE-BIN-DATE       PIC XX      VALUE SPACES.
   124     05  SAVE-SEND-DT        PIC XX      VALUE LOW-VALUES.
   125
   126 01  ws-dcc-error-line.
   127     05  filler occurs 15.
   128         10  ws-error-no        pic x(4).
   129 01  WS-CRI-SSN-WORK-AREA.
   130     05  WS-CRI-SOC-SEC-NO.
   131         10  WS-SS-REPT-CD       PIC X(5).
   132         10  WS-SS-LAST-NAME     PIC X(5).
   133         10  WS-SS-INITIAL       PIC X.
   134
   135     05  WS-CRI-REPORT-CODE.
   136         10  FILLER              PIC X(5).
   137         10  WS-CRI-RPT-CD-MOVE  PIC X(5).
   138
   139     05  WS-CRI-LAST-NAME.
   140         10  WS-CRI-NAME-MOVE    PIC X(5).
   141         10  FILLER              PIC X(10).
   142
   143 01  STANDARD-AREAS.
   144     12  SC-ITEM             PIC S9(4)   VALUE +0001      COMP.
   145     12  GETMAIN-SPACE       PIC X       VALUE SPACES.
   146     12  MAP-NAME            PIC X(8)    VALUE 'EL130A'.
   147     12  MAPSET-NAME         PIC X(8)    VALUE 'EL130S'.
   148     12  TRANS-ID            PIC X(4)    VALUE 'EX19'.
   149     12  START-TRANS-ID      PIC X(4)    VALUE 'EX58'.
   150     12  THIS-PGM            PIC X(8)    VALUE 'EL130'.
   151     12  PGM-NAME            PIC X(8).
   152     12  TIME-IN             PIC S9(7).
   153     12  TIME-OUT-R  REDEFINES TIME-IN.
   154         16  FILLER          PIC X.
   155         16  TIME-OUT        PIC 99V99.
   156         16  FILLER          PIC X(2).
   157     12  XCTL-005            PIC X(8)    VALUE 'EL005'.
   158     12  XCTL-010            PIC X(8)    VALUE 'EL010'.
   159     12  XCTL-114            PIC X(8)    VALUE 'EL114'.
   160     12  XCTL-126            PIC X(8)    VALUE 'EL126'.
   161     12  XCTL-127            PIC X(8)    VALUE 'EL127'.
   162     12  XCTL-727            PIC X(8)    VALUE 'EL727'.
   163     12  XCTL-131            PIC X(8)    VALUE 'EL131'.
   164     12  XCTL-132            PIC X(8)    VALUE 'EL132'.
   165     12  XCTL-141            PIC X(8)    VALUE 'EL141'.
   166     12  XCTL-150            PIC X(8)    VALUE 'EL150'.
   167     12  XCTL-157            PIC X(8)    VALUE 'EL157'.
   168     12  XCTL-650            PIC X(8)    VALUE 'EL650'.
   169     12  XCTL-659            PIC X(8)    VALUE 'EL659'.
   170     12  XCTL-6592           PIC X(8)    VALUE 'EL6592'.
   171     12  XCTL-725            PIC X(8)    VALUE 'EL725'.
   172     12  LINK-001            PIC X(8)    VALUE 'EL001'.
   173     12  LINK-004            PIC X(8)    VALUE 'EL004'.
   174     12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
   175     12  LINK-ELRTRM         PIC X(8)    VALUE 'ELRTRM'.
   176     12  LINK-1523           PIC X(8)    VALUE 'EL1523'.
   177     12  ELCNTL-DSID         PIC X(8)    VALUE 'ELCNTL'.
   178     12  ELMSTR-DSID         PIC X(8)    VALUE 'ELMSTR'.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page   6
* EL130.cbl
   179     12  ELMSTR5-DSID        PIC X(8)    VALUE 'ELMSTR5'.
   180     12  ELTRLR-DSID         PIC X(8)    VALUE 'ELTRLR'.
   181     12  ERACCT2-DSID        PIC X(8)    VALUE 'ERACCT2'.
   182     12  ELCERT-DSID         PIC X(8)    VALUE 'ELCERT'.
   183     12  ELCERT5-DSID        PIC X(8)    VALUE 'ELCERT5'.
   184     12  ELACTQ-DSID         PIC X(8)    VALUE 'ELACTQ'.
   185     12  ELARCH-DSID         PIC X(8)    VALUE 'ELARCH'.
   186     12  ELBENE-DSID         PIC X(8)    VALUE 'ELBENE'.
   187     12  ERREIN-DSID         PIC X(8)    VALUE 'ERREIN'.
   188     12  DLYACTV-DSID        PIC X(8)    VALUE 'DLYACTV'.
   189     12  ERMAIL-DSID         PIC X(8)    VALUE 'ERMAIL'.
   190     12  ELCRTT-DSID         PIC X(8)    VALUE 'ELCRTT'.
   191     12  FILE-ID             PIC X(8).
   192     12  DLYACTV-LENGTH      PIC S9(04)    COMP     VALUE +25.
   193     12  ELACTQ-LENGTH       PIC S9(04)    COMP     VALUE +60.
   194     12  ELARCH-LENGTH       PIC S9(04)    COMP     VALUE +90.
   195     12  ELCERT-LENGTH       PIC S9(04)    COMP     VALUE +450.
   196     12  ELMSTR-LENGTH       PIC S9(04)    COMP     VALUE +350.
   197     12  ELTRLR-LENGTH       PIC S9(04)    COMP     VALUE +200.
   198     12  ELMSTR-GENERIC-LENGTH PIC S9(4)   VALUE +9      COMP.
   199     12  ERMAIL-LENGTH       PIC S9(04)    COMP     VALUE +374.
   200     12  ELCRTT-LENGTH       PIC S9(04)    COMP     VALUE +552.
   201
   202 01  TERM-CALCULATION-WORK-AREA     COMP-3.
   203     12  M                   PIC S9(7)V99           VALUE ZEROS.
   204     12  L                   PIC S9(7)V99           VALUE ZEROS.
   205     12  N                   PIC S9(3)              VALUE ZEROS.
   206     12  N-STORE             PIC S9(3)              VALUE ZEROS.
   207     12  NV-STORE            PIC S9(3)              VALUE ZEROS.
   208     12  I                   PIC S99V9(5)           VALUE ZEROS.
   209     12  A-N                 PIC S9(7)V9(8)         VALUE ZEROS.
   210     12  IA-N                PIC S9(7)V9(8)         VALUE ZEROS.
   211     12  V                   PIC S9(3)V9(14)        VALUE ZEROS.
   212     12  R                   PIC S9(3)              VALUE ZEROS.
   213     12  M1                  PIC S9(7)V99           VALUE ZEROS.
   214     12  V-EX-N              PIC S9(3)V9(14)        VALUE ZEROS.
   215     12  TERM1               PIC S9(8)V9(9)         VALUE ZEROS.
   216     12  TERM2               PIC S9(8)V9(9)         VALUE ZEROS.
   217     12  TERM3               PIC S9(8)V9(9)         VALUE ZEROS.
   218     12  TERM4               PIC S9(3)V9(14)        VALUE ZEROS.
   219     12  LEFT-TOT-1          PIC S9(9)V9(8)         VALUE ZEROS.
   220     12  RIGHT-TOT-1         PIC S9(9)V9(8)         VALUE ZEROS.
   221     12  RIGHT-TOT-2         PIC S9(9)V9(8)         VALUE ZEROS.
   222
   223 01  TERM-CALC-WORK-AREA.
   224     12  WS-AH-RATE          PIC S999V9(5)          VALUE ZEROS.
   225     12  WS-LF-RATE          PIC S999V9(5)          VALUE ZEROS.
   226     12  WS-TERM             PIC S9(3)              VALUE ZEROS.
   227     12  WS-TERM-REM         PIC S9(3)V99           VALUE ZEROS.
   228     12  WS-REMAIN           PIC S99                VALUE ZEROS.
   229     12  V-EXPONENTS.
   230        14  V-EXPONENT       PIC S9(3)V9(14) COMP-3 OCCURS 250.
   231     12  V-EX-ONETIME        PIC 9                  VALUE 1.
   232
   233 01  MISC-WORK-AREAS.
   234     12  SAVE-BENEFICIARY    PIC X(10)   VALUE LOW-VALUES.
   235     12  FILE-SWITCH         PIC X(4)    VALUE SPACES.
   236     12  CLAIM-SWITCH        PIC X       VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page   7
* EL130.cbl
   237     12  QID.
   238         16  QID-TERM        PIC X(4).
   239         16  FILLER          PIC X(4)    VALUE '130A'.
   240     12  RETURNED-FROM       PIC X(8)    VALUE SPACES.
   241     12  SAVE-AT-PRIMARY-KEY PIC X(22)   VALUE SPACES.
   242     12  WS-GROUP-NO.
   243         16  WS-GROUP-NO-1   PIC X(01)   VALUE SPACES.
   244         16  WS-GROUP-NO-2-6 PIC X(05)   VALUE SPACES.
   245
   246     12  WS-RESPONSE         PIC S9(8)   COMP.
   247         88  WS-RESP-NORMAL              VALUE +00.
   248         88  WS-RESP-ERROR               VALUE +01.
   249         88  WS-RESP-NOTFND              VALUE +13.
   250         88  WS-RESP-DUPKEY              VALUE +15.
   251         88  WS-RESP-NOTOPEN             VALUE +19.
   252         88  WS-RESP-ENDFILE             VALUE +20.
   253
   254***************************************************************
   255*                                                             *
   256*    QID-MAP-LENGTH MUST BE ADJUSTED EVERY TIME THAT ANY      *
   257*    FIELDS ARE ADDED, DELETED, OR THE SIZE OF ANY FIELD      *
   258*    CHANGES WITH IN MAP EL130A.                              *
   259*                                                             *
   260***************************************************************
   261
   262     12  QID-MAP-LENGTH            PIC S9(4) VALUE +1084 COMP.
   263     12  WS-SAVE-CLAIM-MASTER.
   264         16  FILLER                    PIC XX.
   265         16  WS-SAVE-CLAIM-KEY.
   266             20  WS-SAVE-COMPANY-CD    PIC X.
   267             20  WS-SAVE-CARRIER       PIC X.
   268             20  WS-SAVE-CLAIM-NO      PIC X(7).
   269             20  WS-SAVE-CERT-NO       PIC X(11).
   270         16  FILLER                    PIC X(328).
   271     12  SAVE-CURRENT-DATE         PIC XX.
   272     12  SAVE-CONTROL              PIC X(39).
   273     12  SAVE-ERACCT-KEY           PIC X(26).
   274     12  SAVE-COUNTER              PIC S9(8)   COMP.
   275     12  SAVE-METHOD               PIC X.
   276     12  SAVE-COMPANY-ID           PIC XXX.
   277     12  SAVE-COMPANY-CD           PIC X.
   278     12  SAVE-JOURNAL-FILE-ID      PIC S9(4)   COMP.
   279     12  SAVE-CREDIT-USER          PIC X.
   280     12  SAVE-CLAIM-USER           PIC X.
   281     12  SAVE-LIFE-OVERRIDE-L1     PIC X.
   282     12  SAVE-LIFE-OVERRIDE-L2     PIC XX.
   283     12  SAVE-LIFE-OVERRIDE-L6     PIC X(6).
   284     12  SAVE-LIFE-OVERRIDE-L12    PIC X(12).
   285     12  SAVE-AH-OVERRIDE-L1       PIC X.
   286     12  SAVE-AH-OVERRIDE-L2       PIC XX.
   287     12  SAVE-AH-OVERRIDE-L6       PIC X(6).
   288     12  SAVE-AH-OVERRIDE-L12      PIC X(12).
   289     12  FILLER                    PIC X.
   290*    12  SAVE-CLAIM-ACCESS-CONTROL PIC X.
   291     12  SAVE-CERT-ACCESS-CONTROL  PIC X.
   292     12  SAVE-CARRIER-CONTROL-LEVEL    PIC X.
   293     12  SAVE-EL127-TO-EL130-CNTRL.
   294         16  SAVE-CERT-SELECT-CNT    PIC S9(04) COMP.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page   8
* EL130.cbl
   295         16  SAVE-CERT-PROCESSED     PIC S9(04) COMP.
   296         16  SAVE-CERT-CONTROLS-EL127 OCCURS 5 TIMES.
   297             20  SAVE-EL127-CARRIER  PIC X.
   298             20  SAVE-EL127-GROUPING PIC X(6).
   299             20  SAVE-EL127-STATE    PIC X(2).
   300             20  SAVE-EL127-ACCOUNT  PIC X(10).
   301             20  SAVE-EL127-CERT-NO  PIC X(11).
   302             20  SAVE-EL127-EFF-DT   PIC XX.
   303     12  SAVE-EL659-TO-EL130-CNTRL.
   304         16  SAVE-EL659-CARRIER    PIC X.
   305         16  SAVE-EL659-GROUPING   PIC X(6).
   306         16  SAVE-EL659-STATE      PIC XX.
   307         16  SAVE-EL659-ACCOUNT    PIC X(10).
   308     12  DIVIDE-QUOT               PIC 999.
   309     12  DIVIDE-REM                PIC 999.
   310     12  WS-CURRENT-MANUAL-RESERVE PIC S9(5)V99 COMP-3.
   311     12  WS-ITD-ADDITIONAL-RESERVE PIC S9(5)V99 COMP-3.
   312     12  WS-ITD-PAID-EXPENSE       PIC S9(3)V99 COMP-3.
   313     12  WS-ITD-CHARGABLE-EXPENSE  PIC S9(5)V99 COMP-3.
   314     12  WS-INITIAL-MANUAL-RESERVE PIC S9(5)V99 COMP-3.
   315     12  WS-RESERVE-CONTROLS       PIC X(9).
   316     12  WS-EXPENSE-CONTROLS       PIC X(7).
   317     12  WS-REIN-TABLE.
   318         16  WS-REIN-1             PIC X            VALUE SPACE.
   319         16  WS-REIN-2             PIC X            VALUE SPACE.
   320         16  WS-REIN-3             PIC X            VALUE SPACE.
   321     12  WS-BENE-CALC-METHOD       PIC X.
   322     12  WS-EARNINGS-CALC          PIC X.
   323     12  WS-LF-EARNINGS-CALC       PIC X.
   324         88 TEX-REG                VALUE '4'.
   325         88 NET-PAY                VALUE '5'.
   326     12  WS-AH-EARNINGS-CALC       PIC X.
   327     12  WS-SPECIAL-CALC-CD        PIC X(01).
   328     12  WS-LF-SPECIAL-CALC-CD     PIC X(01).
   329     12  WS-AH-SPECIAL-CALC-CD     PIC X(01).
   330     12  WS-DIAGNOSIS-DESCRIPT     PIC X(60).
   331     12  WS-CLAIM-NUMBER.
   332         16  WS-CN-PREFIX.
   333             20  WS-CN-PRF-A PIC X.
   334             20  WS-CN-PRF-B PIC X.
   335         16  WS-CN-NUMBER    PIC 9(5).
   336     12  WS-CLAIM-NUMBER-R1 REDEFINES WS-CLAIM-NUMBER PIC 9(7).
   337     12  WS-CLAIM-SEQU.
   338         16  FILLER          PIC X    VALUE '('.
   339         16  WS-CURRENT-SEQU PIC Z9.
   340         16  FILLER          PIC X(4) VALUE ' OF '.
   341         16  WS-OF-SEQU      PIC Z9.
   342         16  FILLER          PIC X    VALUE ')'.
   343     12  DATE-WORK.
   344       14  FILLER                PIC XX.
   345       14  DATE-MM               PIC XX.
   346       14  DATE-DD               PIC XX.
   347       14  DATE-YY               PIC XX.
   348     12  CURR-DATE REDEFINES DATE-WORK.
   349         16  CURR-MM.
   350           18  CURR-M1           PIC 9.
   351           18  CURR-M2           PIC 9.
   352         16  FILLER              PIC X(5).
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page   9
* EL130.cbl
   353         16  CURR-YEAR           PIC 9.
   354     12  NUM-WORK   REDEFINES DATE-WORK   PIC 9(8).
   355     12  SUB                     PIC 99.
   356     12  MY-DATE.
   357         16  MY-MM               PIC XX.
   358         16  FILLER              PIC X VALUE '/'.
   359         16  MY-YY               PIC XX.
   360
   361     12  WS-EDIT-BEN-CODE        PIC XX.
   362         88  INVALID-BENEFIT-CODE   VALUE '  ' '00'
   363                                          '90' THRU '99'.
   364
   365     12  WS-NUM-HOLD             PIC S9(4)     VALUE +0  COMP-3.
   366     12  WS-BEN-HOLD             PIC XX.
   367     12  WS-BEN-ALPHA-HOLD.
   368         15  WS-BEN-ALPHA-2      PIC XX.
   369         15  WS-BEN-ALPHA-1      PIC X.
   370     12  WS-FORM-HOLD            PIC X(12)  VALUE SPACES.
   371     12  WS-REC-TYPE             PIC X.
   372     12  HOLD-LOAN-BAL           PIC 9(7)V99   VALUE ZEROS.
   373     12  DEEDIT-FIELD            PIC 9(10)V99  VALUE ZEROS.
   374     12  ARCH-NUMBER             PIC S9(8)   COMP.
   375     12  WS-REIN-REC-FOUND-SW    PIC X(01)   VALUE ' '.
   376         88  REIN-REC-NOT-FOUND              VALUE 'N'.
   377         88  REIN-REC-FOUND                  VALUE 'Y'.
   378
   379     12  WS-REC-FOUND-SW         PIC X(01)   VALUE ' '.
   380     12  WS-LETTER-SW            PIC X(01)   VALUE 'N'.
   381
   382
   383 01  CSO-WORK-FIELDS.
   384     12  WS-BLANK            PIC X       VALUE ' '.
   385
   386     12  WS-MA-CONTROL-PRIMARY.
   387         16  WS-MA-COMPANY-CD        PIC  X.
   388         16  WS-MA-CARRIER           PIC  X.
   389         16  WS-MA-GROUPING          PIC  X(6).
   390         16  WS-MA-STATE             PIC  XX.
   391         16  WS-MA-ACCOUNT           PIC  X(10).
   392         16  WS-MA-CERT-EFF-DT       PIC  XX.
   393         16  WS-MA-CERT-NO.
   394             20  WS-MA-CERT-PRIME    PIC  X(10).
   395             20  WS-MA-CERT-SFX      PIC  X.
   396
   397     12  WS-INSURED-ADDR-CNT         PIC  S9(1) VALUE +0.
   398     12  WS-NO-INSURED-ADDRESS       PIC  X(01) VALUE 'N'.
   399     12  WS-SOC-SEC-NUMBER.
   400         16  WS-SOC-SEC-NO       PIC 9(9).
   401         16  WS-SOC-SEC-BLANK    PIC X(2).
   402     12  WS-SOC-SEC-REDEF REDEFINES WS-SOC-SEC-NUMBER.
   403         16  WS-SSN-1-3          PIC 9(3).
   404         16  WS-SSN-DASH1        PIC X(1).
   405         16  WS-SSN-4-5          PIC 9(2).
   406         16  WS-SSN-DASH2        PIC X(1).
   407         16  WS-SSN-6-9          PIC 9(4).
   408
   409     12  WS-DIAG-VIN-MSG.
   410         16  FILLER          PIC X(11)
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  10
* EL130.cbl
   411             VALUE 'VIN NUMBER '.
   412         16  WS-DIAG-VIN     PIC X(17).
   413
   414     12  WS-VERIFY-NOTE      PIC X(34)
   415         VALUE '2ND BENE SSN VERIFICATION REQUIRED'.
   416
   417     12  WS-CAUSAL-NOTE      PIC X(40)
   418         VALUE 'VERIFY IF DX RELATED TO PRIOR CONDITION '.
   419
   420     12  WS-VFY-SSN-NOTE     PIC X(25)
   421         VALUE 'SSN VERIFICATION REQUIRED'.
   422
   423 01  MAP-DATE-AREAS.
   424     12  WS-EFFDT            PIC XX      VALUE LOW-VALUES.
   425     12  WS-EXPIRE           PIC XX      VALUE LOW-VALUES.
   426     12  WS-ADD-ON-DT        PIC XX      VALUE LOW-VALUES.
   427     12  WS-BIRTHDT          PIC XX      VALUE LOW-VALUES.
   428     12  WS-INCUR            PIC XX      VALUE LOW-VALUES.
   429     12  WS-REPORT           PIC XX      VALUE LOW-VALUES.
   430     12  WS-ESTEND           PIC XX      VALUE LOW-VALUES.
   431     12  WS-ACVCNDT          PIC XX      VALUE LOW-VALUES.
   432     12  WS-LCVCNDT          PIC XX      VALUE LOW-VALUES.
   433     12  WS-TODAY-DT         PIC XX      VALUE LOW-VALUES.
   434     12  WS-ENTRYDT          PIC XX      VALUE LOW-VALUES.
   435     12  WS-MANRSV           PIC S9(6)V99  VALUE ZEROS COMP-3.
   436     12  WS-ACVRATE          PIC S9(4)V99  VALUE ZEROS COMP-3.
   437     12  WS-ACVBENE          PIC S9(9)V99  VALUE ZEROS COMP-3.
   438     12  WS-LCVRATE          PIC S9(4)V99  VALUE ZEROS COMP-3.
   439     12  WS-LCVBENE          PIC S9(9)V99  VALUE ZEROS COMP-3.
   440     12  WS-APR              PIC S999V9999 VALUE ZEROS COMP-3.
   441     12  WS-PMTFREQ          PIC 99        VALUE ZEROS COMP-3.
   442     12  WS-ASSOC-CERT-TOTAL PIC S99       VALUE ZEROS.
   443         88  NO-ASSOCIATED-CERTS           VALUE ZEROS.
   444     12  WS-ASSOC-CERT-SEQU  PIC S99       VALUE ZEROS.
   445     12  WS-READNEXT-SWITCH  PIC S99       VALUE +1.
   446     12  WS-ASSOCIATED-CERTS PIC S9        VALUE ZEROS COMP-3.
   447     12  ONE-OR-MIN1         PIC S9        VALUE +1    COMP-3.
   448
   449 01  ACCESS-KEYS.
   450     12  ELACTQ-KEY.
   451         16  ELACTQ-COMPANY-CD       PIC X.
   452         16  ELACTQ-CARRIER          PIC X.
   453         16  ELACTQ-CLAIM-NO         PIC X(7).
   454         16  ELACTQ-CERT-NO          PIC X(11).
   455     12  ELMSTR-KEY.
   456         16  MSTR-COMP-CD            PIC X.
   457         16  MSTR-CARRIER            PIC X.
   458         16  MSTR-CLAIM-NO           PIC X(7).
   459         16  MSTR-CERT-NO.
   460             20  MSTR-CERT-NO-PRIME  PIC X(10).
   461             20  MSTR-CERT-NO-SUFX   PIC X.
   462     12  SAVE-ELMSTR-KEY.
   463         16  SAVE-COMP-CD            PIC X.
   464         16  SAVE-CARRIER            PIC X.
   465         16  SAVE-CLAIM-NO           PIC X(7).
   466         16  SAVE-CERT-NO.
   467             20  SAVE-CERT-NO-PRIME  PIC X(10).
   468             20  SAVE-CERT-NO-SUFX   PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  11
* EL130.cbl
   469     12  ELMSTR5-KEY.
   470         16  MSTR5-COMP-CD           PIC X.
   471         16  MSTR5-CERT-NO.
   472             20  MSTR5-CERT-NO-PRIME PIC X(10).
   473             20  MSTR5-CERT-NO-SUFX  PIC X.
   474     12  INCUR-DTE-DUPE-SW           PIC X VALUE 'N'.
   475         88  NO-CLAIMS-FOR-CERT            VALUE 'N'.
   476         88  INCURRED-DATE-MATCH           VALUE 'Y'.
   477         88  CLAIM-RECORD-FOUND            VALUE 'H'.
   478     12  ELCNTL-KEY.
   479         16  CNTL-COMP-ID    PIC X(3).
   480         16  CNTL-REC-TYPE   PIC X.
   481         16  CNTL-ACCESS.
   482             20  FILLER      PIC XX.
   483             20  CNTL-BENEFIT.
   484                 24  FILLER  PIC X.
   485                 24  CNTL-CARRIER PIC X.
   486         16  CNTL-SEQ-NO     PIC S9(4)    COMP.
   487     12  ELCERT-KEY.
   488         16  CERT-COMP-CD    PIC X.
   489         16  CERT-CARRIER    PIC X.
   490         16  CERT-GROUPING   PIC X(6).
   491         16  CERT-STATE      PIC X(2).
   492         16  CERT-ACCOUNT.
   493             20  CERT-ACCOUNT-PREFIX PIC X(4).
   494             20  CERT-ACCOUNT-PRIME  PIC X(6).
   495         16  CERT-EFF-DT     PIC XX.
   496         16  CERT-CERT-NO.
   497             20  CERT-CERT-NO-PRIME  PIC X(10).
   498             20  CERT-CERT-NO-SUFX   PIC X.
   499     12  ELCERT-KEY-5.
   500         16  CERT-COMP-CD-5      PIC X.
   501         16  CERT-CERT-5.
   502             20  CERT-CERT-5-PRIME   PIC X(10).
   503             20  CERT-CERT-5-SUFX    PIC X.
   504     12  ERACCT-KEY.
   505         16  ACCT-COMP-CD    PIC X.
   506         16  ACCT-CARRIER    PIC X.
   507         16  ACCT-GROUPING   PIC X(6).
   508         16  ACCT-STATE      PIC X(2).
   509         16  ACCT-ACCOUNT    PIC X(10).
   510         16  ACCT-EXP-DT     PIC XX.
   511     12  ELTRLR-KEY.
   512         16  TRLR-COMP-CD    PIC X.
   513         16  TRLR-CARRIER    PIC X.
   514         16  TRLR-CLAIM-NO   PIC X(7).
   515         16  TRLR-CERT-NO.
   516             20  TRLR-CERT-NO-PRIME  PIC X(10).
   517             20  TRLR-CERT-NO-SUFX   PIC X.
   518         16  TRLR-SEQ-NO     PIC S9(4)   COMP.
   519         16  TRLR-TYPE       PIC X.
   520     12  ELBENE-KEY.
   521         16  BENE-COMP-CD    PIC X.
   522         16  BENE-RCD-TYPE   PIC X.
   523         16  BENE-CODE       PIC X(10).
   524     12  ERREIN-KEY.
   525         16  REIN-COMP-CD        PIC X(01).
   526         16  REIN-TYPE           PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  12
* EL130.cbl
   527         16  REIN-TABLE-CO.
   528             20  REIN-CODE-1     PIC X(01).
   529             20  REIN-CODE-2     PIC X(01).
   530             20  REIN-CODE-3     PIC X(01).
   531         16  FILLER              PIC X(03).
   532     12  ELCRTT-KEY.
   533         16  CTRLR-COMP-CD       PIC X.
   534         16  CTRLR-CARRIER       PIC X.
   535         16  CTRLR-GROUPING      PIC X(6).
   536         16  CTRLR-STATE         PIC X(2).
   537         16  CTRLR-ACCOUNT       PIC X(10).
   538         16  CTRLR-EFF-DT        PIC XX.
   539         16  CTRLR-CERT-NO       PIC X(11).
   540         16  CTRLR-REC-TYPE      PIC X.
   541 01  ERPDEF-KEY-SAVE             PIC X(18).
   542 01  ERPDEF-KEY.
   543     12  ERPDEF-COMPANY-CD       PIC X.
   544     12  ERPDEF-STATE            PIC XX.
   545     12  ERPDEF-PROD-CD          PIC XXX.
   546     12  F                       PIC X(7).
   547     12  ERPDEF-BEN-TYPE         PIC X.
   548     12  ERPDEF-BEN-CODE         PIC XX.
   549     12  ERPDEF-EXP-DT           PIC XX.
   550 01  ERROR-MESSAGES.
   551     12  ER-0000                 PIC X(4)  VALUE '0000'.
   552     12  ER-0004                 PIC X(4)  VALUE '0004'.
   553     12  ER-0019                 PIC X(4)  VALUE '0019'.
   554     12  ER-0023                 PIC X(4)  VALUE '0023'.
   555     12  ER-0029                 PIC X(4)  VALUE '0029'.
   556     12  ER-0033                 PIC X(4)  VALUE '0033'.
   557     12  ER-0068                 PIC X(4)  VALUE '0068'.
   558     12  ER-0070                 PIC X(4)  VALUE '0070'.
   559     12  ER-0194                 PIC X(4)  VALUE '0194'.
   560     12  ER-0202                 PIC X(4)  VALUE '0202'.
   561     12  ER-0203                 PIC X(4)  VALUE '0203'.
   562     12  ER-0204                 PIC X(4)  VALUE '0204'.
   563     12  ER-0205                 PIC X(4)  VALUE '0205'.
   564     12  ER-0206                 PIC X(4)  VALUE '0206'.
   565     12  ER-0207                 PIC X(4)  VALUE '0207'.
   566     12  ER-0213                 PIC X(4)  VALUE '0213'.
   567     12  ER-0214                 PIC X(4)  VALUE '0214'.
   568     12  ER-0217                 PIC X(4)  VALUE '0217'.
   569     12  ER-0219                 PIC X(4)  VALUE '0219'.
   570     12  ER-0220                 PIC X(4)  VALUE '0220'.
   571     12  ER-0221                 PIC X(4)  VALUE '0221'.
   572     12  ER-0222                 PIC X(4)  VALUE '0222'.
   573     12  ER-0223                 PIC X(4)  VALUE '0223'.
   574     12  ER-0224                 PIC X(4)  VALUE '0224'.
   575     12  ER-0225                 PIC X(4)  VALUE '0225'.
   576     12  ER-0226                 PIC X(4)  VALUE '0226'.
   577     12  ER-0227                 PIC X(4)  VALUE '0227'.
   578     12  ER-0229                 PIC X(4)  VALUE '0229'.
   579     12  ER-0230                 PIC X(4)  VALUE '0230'.
   580     12  ER-0231                 PIC X(4)  VALUE '0231'.
   581     12  ER-0232                 PIC X(4)  VALUE '0232'.
   582     12  ER-0233                 PIC X(4)  VALUE '0233'.
   583     12  ER-0234                 PIC X(4)  VALUE '0234'.
   584     12  ER-0235                 PIC X(4)  VALUE '0235'.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  13
* EL130.cbl
   585     12  ER-0236                 PIC X(4)  VALUE '0236'.
   586     12  ER-0237                 PIC X(4)  VALUE '0237'.
   587     12  ER-0238                 PIC X(4)  VALUE '0238'.
   588     12  ER-0239                 PIC X(4)  VALUE '0239'.
   589     12  ER-0240                 PIC X(4)  VALUE '0240'.
   590     12  ER-0241                 PIC X(4)  VALUE '0241'.
   591     12  ER-0243                 PIC X(4)  VALUE '0243'.
   592     12  ER-0244                 PIC X(4)  VALUE '0244'.
   593     12  ER-0245                 PIC X(4)  VALUE '0245'.
   594     12  ER-0246                 PIC X(4)  VALUE '0246'.
   595     12  ER-0247                 PIC X(4)  VALUE '0247'.
   596     12  ER-0248                 PIC X(4)  VALUE '0248'.
   597     12  ER-0250                 PIC X(4)  VALUE '0250'.
   598     12  ER-0251                 PIC X(4)  VALUE '0251'.
   599     12  ER-0252                 PIC X(4)  VALUE '0252'.
   600     12  ER-0253                 PIC X(4)  VALUE '0253'.
   601     12  ER-0254                 PIC X(4)  VALUE '0254'.
   602     12  ER-0257                 PIC X(4)  VALUE '0257'.
   603     12  ER-0258                 PIC X(4)  VALUE '0258'.
   604     12  ER-0260                 PIC X(4)  VALUE '0260'.
   605     12  ER-0261                 PIC X(4)  VALUE '0261'.
   606     12  ER-0263                 PIC X(4)  VALUE '0263'.
   607     12  ER-0264                 PIC X(4)  VALUE '0264'.
   608     12  ER-0265                 PIC X(4)  VALUE '0265'.
   609     12  ER-0266                 PIC X(4)  VALUE '0266'.
   610     12  ER-0267                 PIC X(4)  VALUE '0267'.
   611     12  ER-0334                 PIC X(4)  VALUE '0334'.
   612     12  ER-0337                 PIC X(4)  VALUE '0337'.
   613     12  ER-0412                 PIC X(4)  VALUE '0412'.
   614     12  ER-0413                 PIC X(4)  VALUE '0413'.
   615     12  ER-0428                 PIC X(4)  VALUE '0428'.
   616     12  ER-0429                 PIC X(4)  VALUE '0429'.
   617     12  ER-0430                 PIC X(4)  VALUE '0430'.
   618     12  ER-0433                 PIC X(4)  VALUE '0433'.
   619     12  ER-0434                 PIC X(4)  VALUE '0434'.
   620     12  ER-0458                 PIC X(4)  VALUE '0458'.
   621     12  ER-0489                 PIC X(4)  VALUE '0489'.
   622     12  ER-0509                 PIC X(4)  VALUE '0509'.
   623     12  ER-0510                 PIC X(4)  VALUE '0510'.
   624     12  ER-0511                 PIC X(4)  VALUE '0511'.
   625     12  ER-0512                 PIC X(4)  VALUE '0512'.
   626     12  ER-0516                 PIC X(4)  VALUE '0516'.
   627     12  ER-0517                 PIC X(4)  VALUE '0517'.
   628     12  ER-0518                 PIC X(4)  VALUE '0518'.
   629     12  ER-0519                 PIC X(4)  VALUE '0519'.
   630     12  ER-0520                 PIC X(4)  VALUE '0520'.
   631     12  ER-0521                 PIC X(4)  VALUE '0521'.
   632     12  ER-0522                 PIC X(4)  VALUE '0522'.
   633     12  ER-0523                 PIC X(4)  VALUE '0523'.
   634     12  ER-0544                 PIC X(4)  VALUE '0544'.
   635     12  ER-0546                 PIC X(4)  VALUE '0546'.
   636     12  ER-0558                 PIC X(4)  VALUE '0558'.
   637     12  ER-0560                 PIC X(4)  VALUE '0560'.
   638     12  ER-0562                 PIC X(4)  VALUE '0562'.
   639     12  ER-0565                 PIC X(4)  VALUE '0565'.
   640     12  ER-0569                 PIC X(4)  VALUE '0569'.
   641     12  ER-0693                 PIC X(4)  VALUE '0693'.
   642     12  ER-0715                 PIC X(4)  VALUE '0715'.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  14
* EL130.cbl
   643     12  ER-0840                 PIC X(4)  VALUE '0840'.
   644     12  ER-0841                 PIC X(4)  VALUE '0841'.
   645     12  ER-0842                 PIC X(4)  VALUE '0842'.
   646     12  ER-0843                 PIC X(4)  VALUE '0843'.
   647     12  ER-0878                 PIC X(4)  VALUE '0878'.
   648     12  ER-0887                 PIC X(4)  VALUE '0887'.
   649     12  ER-1651                 PIC X(4)  VALUE '1651'.
   650     12  ER-1652                 PIC X(4)  VALUE '1652'.
   651     12  ER-1653                 PIC X(4)  VALUE '1653'.
   652     12  ER-1654                 PIC X(4)  VALUE '1654'.
   653     12  ER-1655                 PIC X(4)  VALUE '1655'.
   654     12  er-1659                 pic x(4)  value '1659'.
   655     12  er-1660                 pic x(4)  value '1660'.
   656     12  er-1661                 pic x(4)  value '1661'.
   657     12  ER-2280                 PIC X(4)  VALUE '2280'.
   658     12  ER-2370                 PIC X(4)  VALUE '2370'.
   659     12  ER-2371                 PIC X(4)  VALUE '2371'.
   660     12  ER-2378                 PIC X(4)  VALUE '2378'.
   661     12  ER-2380                 PIC X(4)  VALUE '2380'.
   662     12  ER-2566                 PIC X(4)  VALUE '2566'.
   663     12  ER-2848                 PIC X(4)  VALUE '2848'.
   664     12  ER-3548                 PIC X(4)  VALUE '3548'.
   665     12  ER-7008                 PIC X(4)  VALUE '7008'.
   666     12  ER-7319                 PIC X(4)  VALUE '7319'.
   667     12  ER-7321                 PIC X(4)  VALUE '7321'.
   668     12  ER-7352                 PIC X(4)  VALUE '7352'.
   669     12  ER-7353                 PIC X(4)  VALUE '7353'.
   670     12  ER-7575                 PIC X(4)  VALUE '7575'.
   671     12  ER-7577                 PIC X(4)  VALUE '7577'.
   672     12  ER-7582                 PIC X(4)  VALUE '7582'.
   673     12  ER-7634                 PIC X(4)  VALUE '7634'.
   674     12  ER-7635                 PIC X(4)  VALUE '7635'.
   675     12  ER-7636                 PIC X(4)  VALUE '7636'.
   676     12  ER-7637                 PIC X(4)  VALUE '7637'.
   677     12  ER-7638                 PIC X(4)  VALUE '7638'.
   678     12  ER-7639                 PIC X(4)  VALUE '7639'.
   679     12  ER-7640                 PIC X(4)  VALUE '7640'.
   680     12  ER-7641                 PIC X(4)  VALUE '7641'.
   681     12  ER-7642                 PIC X(4)  VALUE '7642'.
   682     12  ER-7643                 PIC X(4)  VALUE '7643'.
   683     12  ER-7646                 PIC X(4)  VALUE '7646'.
   684     12  ER-7647                 PIC X(4)  VALUE '7647'.
   685     12  ER-7648                 PIC X(4)  VALUE '7648'.
   686     12  ER-7649                 PIC X(4)  VALUE '7649'.
   687     12  ER-7651                 PIC X(4)  VALUE '7651'.
   688     12  ER-7670                 PIC X(4)  VALUE '7670'.
   689     12  ER-7671                 PIC X(4)  VALUE '7671'.
   690     12  ER-7686                 PIC X(4)  VALUE '7686'.
   691     12  ER-7688                 PIC X(4)  VALUE '7688'.
   692     12  ER-7689                 PIC X(4)  VALUE '7689'.
   693     12  ER-7691                 PIC X(4)  VALUE '7691'.
   694*    COPY ERCPDEF.
   695******************************************************************
   696*                                                                *
   697*                                                                *
   698*                            ERCPDEF.                            *
   699*                                                                *
   700*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  15
* EL130.cbl
   701*                                                                *
   702*    FILE TYPE = VSAM,KSDS                                       *
   703*    RECORD SIZE = 1319 RECFORM = FIXED                          *
   704*                                                                *
   705*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
   706*                                                                *
   707*    LOG = YES                                                   *
   708*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   709******************************************************************
   710 01  PRODUCT-MASTER.
   711    12  PD-RECORD-ID                 PIC X(02).
   712        88  VALID-PD-ID                  VALUE 'PD'.
   713    12  PD-CONTROL-PRIMARY.
   714        16  PD-COMPANY-CD            PIC X.
   715        16  PD-STATE                 PIC XX.
   716        16  PD-PRODUCT-CD            PIC XXX.
   717        16  PD-FILLER                PIC X(7).
   718        16  PD-BEN-TYPE              PIC X.
   719        16  PD-BEN-CODE              PIC XX.
   720        16  PD-PROD-EXP-DT           PIC XX.
   721    12  FILLER                       PIC X(50).
   722    12  PD-PRODUCT-DATA OCCURS 8.
   723        16  PD-PROD-CODE             PIC X.
   724            88  PD-PROD-LIFE           VALUE 'L'.
   725            88  PD-PROD-PROP           VALUE 'P'.
   726            88  PD-PROD-AH             VALUE 'A'.
   727            88  PD-PROD-IU             VALUE 'I'.
   728            88  PD-PROD-GAP            VALUE 'G'.
   729        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
   730        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
   731        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
   732        16  PD-MAX-TERM              PIC S999        COMP-3.
   733        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
   734        16  FILLER                   PIC X.
   735        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
   736        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
   737        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
   738        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
   739        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
   740        16  PD-REC-CRIT-PERIOD       PIC X.
   741        16  PD-RTW-MOS               PIC 99.
   742        16  FILLER                   PIC X(5).
   743    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
   744    12  PD-TERM-LIMITS OCCURS 15.
   745        16  PD-LOW-TERM              PIC S999        COMP-3.
   746        16  PD-HI-TERM               PIC S999        COMP-3.
   747*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
   748    12  PD-LOAN-AMT-LIMITS OCCURS 15.
   749        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
   750        16  PD-HI-AMT                PIC S9(7)       COMP-3.
   751    12  PD-EARN-FACTORS.
   752        16  FILLER OCCURS 15.
   753            20  FILLER OCCURS 15.
   754                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
   755    12  PD-PRODUCT-DESC              PIC X(80).
   756    12  PD-TRUNCATED                 PIC X.
   757    12  FILLER                       PIC X(59).
   758    12  PD-MAINT-INFORMATION.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  16
* EL130.cbl
   759        16  PD-LAST-MAINT-DT         PIC X(02).
   760        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
   761        16  PD-LAST-MAINT-BY         PIC X(04).
   762*    COPY ELCLNKLT.
   763******************************************************************
   764*                                                                *
   765*                                                                *
   766*                           ELCLNKLT                             *
   767*                            VMOD=2.003                          *
   768*                                                                *
   769*   THIS COPY BOOK IS USED TO PASS DATA TO THE LETTER GENERATOR  *
   770*   PROGRAM (EL1523). THE AREA SHOULD BE INITIALIZED TO LOW-     *
   771*   VALUES BEFORE ENTERING YOUR INFORMATION.                     *
   772*                                                                *
   773*   MOVE THE PROGRAM-INTERFACE-BLOCK TO W-1523-LINK-DATA BEFORE  *
   774*   COMPLETING THE REQUIRED FIELDS.                              *
   775*                                                                *
   776*   THE CALLING PROGRAM SHOULD CHECK:                            *
   777*   1. W-1523-ERROR-CODE WHERE 0000 INDICATES NO ERROR DETECTED. *
   778*                              9999 INDICATES AN UNKNOWN ABEND   *
   779*                                   WAS DETECTED.                *
   780*                              ALL OTHER VALUES ARE NORMAL ERROR *
   781*                              CODES FOUND IN THE ERROR FILE.    *
   782******************************************************************
   783 01  W-1523-LINKDATA.
   784     12  W-1523-COMMON-PI-DATA.
   785         16  W-1523-COMM-LENGTH  PIC S9(04) COMP   VALUE +1024.
   786         16  FILLER              PIC  X(67).
   787         16  W-1523-COMPANY-CD   PIC  X(01).
   788         16  FILLER              PIC  X(10).
   789         16  W-1523-CONTROL-IN-PROGRESS.
   790             20  W-1523-CARRIER  PIC  X(01).
   791             20  W-1523-GROUPING PIC  X(06).
   792             20  W-1523-STATE    PIC  X(02).
   793             20  W-1523-ACCOUNT  PIC  X(10).
   794             20  W-1523-CLAIM-CERT-GRP.
   795                 24  W-1523-CLAIM-NO
   796                                 PIC  X(07).
   797                 24  W-1523-CERT-NO.
   798                     28  W-1523-CERT-PRIME
   799                                 PIC  X(10).
   800                     28  W-1523-CERT-SFX
   801                                 PIC  X(01).
   802                 24  W-1523-CERT-EFF-DT
   803                                 PIC  X(02).
   804         16  FILLER              PIC X(265).
   805
   806     12  W-1523-WORK-AREA.
   807         16  W-1523-FORM-NUMBER  PIC  X(04).
   808         16  W-1523-NUMBER-COPIES
   809                                 PIC  9(01).
   810         16  W-1523-ADDR-TYPE    PIC  X(02).
   811         16  W-1523-FOLLOW-UP-DATE
   812                                 PIC  X(02).
   813         16  W-1523-RESEND-DATE  PIC  X(02).
   814         16  W-1523-ERROR-CODE   PIC  9(04).
   815             88  W-1523-NO-ERRORS-DETECTED VALUE 0000.
   816             88  W-1523-FATAL-ERROR
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  17
* EL130.cbl
   817                                    VALUES  0006 0013 0042
   818                                            0154 0168 0169
   819                                            0176 9999 0172
   820                                            0179 0186 0281
   821                                            0332 2055 3697
   822                                            3698 3699 3770
   823                                            3771 3772 7675
   824                                            9106 9808 9883
   825                                            9887.
   826             88  W-1523-STOP-ERRORS
   827                                    VALUES  0013 0042 0154
   828                                            0168 0169 0172
   829                                            0281 0332 2055
   830                                            3698 3699 7675
   831                                            9106 9808 9883
   832                                            9999.
   833         16  W-1523-REASON       PIC  X(70).
   834         16  W-1523-ARCHIVE-NUMBER
   835                                 PIC  9(08).
   836     12  W-1523-POINTER-AREA.
   837         16  W-1523-ACCT-POINTER PIC S9(08) COMP.
   838         16  W-1523-ACTY-POINTER PIC S9(08) COMP.
   839         16  W-1523-ARCH-POINTER PIC S9(08) COMP.
   840         16  W-1523-VAR-POINTER  PIC S9(08) COMP.
   841         16  W-1523-PROD-POINTER PIC S9(08) COMP.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  18
* EL130.cbl
   843*    COPY ELCINTF.
   844******************************************************************
   845*                                                                *
   846*                                                                *
   847*                            ELCINTF.                            *
   848*                            VMOD=2.017                          *
   849*                                                                *
   850*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   851*                                                                *
   852*       LENGTH = 1024                                            *
   853*                                                                *
   854******************************************************************
   855*                   C H A N G E   L O G
   856*
   857* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   858*-----------------------------------------------------------------
   859*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   860* EFFECTIVE    NUMBER
   861*-----------------------------------------------------------------
   862* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   863******************************************************************
   864 01  PROGRAM-INTERFACE-BLOCK.
   865     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   866     12  PI-CALLING-PROGRAM              PIC X(8).
   867     12  PI-SAVED-PROGRAM-1              PIC X(8).
   868     12  PI-SAVED-PROGRAM-2              PIC X(8).
   869     12  PI-SAVED-PROGRAM-3              PIC X(8).
   870     12  PI-SAVED-PROGRAM-4              PIC X(8).
   871     12  PI-SAVED-PROGRAM-5              PIC X(8).
   872     12  PI-SAVED-PROGRAM-6              PIC X(8).
   873     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   874     12  PI-COMPANY-ID                   PIC XXX.
   875     12  PI-COMPANY-CD                   PIC X.
   876
   877     12  PI-COMPANY-PASSWORD             PIC X(8).
   878
   879     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   880
   881     12  PI-CONTROL-IN-PROGRESS.
   882         16  PI-CARRIER                  PIC X.
   883         16  PI-GROUPING                 PIC X(6).
   884         16  PI-STATE                    PIC XX.
   885         16  PI-ACCOUNT                  PIC X(10).
   886         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   887                                         PIC X(10).
   888         16  PI-CLAIM-CERT-GRP.
   889             20  PI-CLAIM-NO             PIC X(7).
   890             20  PI-CERT-NO.
   891                 25  PI-CERT-PRIME       PIC X(10).
   892                 25  PI-CERT-SFX         PIC X.
   893             20  PI-CERT-EFF-DT          PIC XX.
   894         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   895             20  PI-PLAN-CODE            PIC X(2).
   896             20  PI-REVISION-NUMBER      PIC X(3).
   897             20  PI-PLAN-EFF-DT          PIC X(2).
   898             20  PI-PLAN-EXP-DT          PIC X(2).
   899             20  FILLER                  PIC X(11).
   900         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  19
* EL130.cbl
   901             20  PI-OE-REFERENCE-1.
   902                 25  PI-OE-REF-1-PRIME   PIC X(18).
   903                 25  PI-OE-REF-1-SUFF    PIC XX.
   904
   905     12  PI-SESSION-IN-PROGRESS          PIC X.
   906         88  CLAIM-SESSION                   VALUE '1'.
   907         88  CREDIT-SESSION                  VALUE '2'.
   908         88  WARRANTY-SESSION                VALUE '3'.
   909         88  MORTGAGE-SESSION                VALUE '4'.
   910         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   911
   912
   913*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   914
   915     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   916     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   917
   918     12  PI-CREDIT-USER                  PIC X.
   919         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   920         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   921
   922     12  PI-CLAIM-USER                   PIC X.
   923         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   924         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   925
   926     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   927         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   928         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   929         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   930         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   931         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   932
   933     12  PI-PROCESSOR-ID                 PIC X(4).
   934
   935     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   936
   937     12  PI-MEMBER-CAPTION               PIC X(10).
   938
   939     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   940         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   941
   942     12  PI-LIFE-OVERRIDE-L1             PIC X.
   943     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   944     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   945     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   946
   947     12  PI-AH-OVERRIDE-L1               PIC X.
   948     12  PI-AH-OVERRIDE-L2               PIC XX.
   949     12  PI-AH-OVERRIDE-L6               PIC X(6).
   950     12  PI-AH-OVERRIDE-L12              PIC X(12).
   951
   952     12  PI-NEW-SYSTEM                   PIC X(2).
   953
   954     12  PI-PRIMARY-CERT-NO              PIC X(11).
   955     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   956         88  PI-USES-PAID-TO                 VALUE '1'.
   957     12  PI-CRDTCRD-SYSTEM.
   958         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  20
* EL130.cbl
   959             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   960             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   961         16  PI-CC-MONTH-END-DT          PIC XX.
   962     12  PI-PROCESSOR-PRINTER            PIC X(4).
   963
   964     12  PI-OE-REFERENCE-2.
   965         16  PI-OE-REF-2-PRIME           PIC X(10).
   966         16  PI-OE-REF-2-SUFF            PIC X.
   967
   968     12  PI-REM-TRM-CALC-OPTION          PIC X.
   969
   970     12  PI-LANGUAGE-TYPE                PIC X.
   971             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   972             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   973             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   974
   975     12  PI-POLICY-LINKAGE-IND           PIC X.
   976         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   977         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   978                                                   LOW-VALUES.
   979
   980     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   981     12  PI-CLAIM-PW-SESSION             PIC X(1).
   982         88  PI-CLAIM-CREDIT                 VALUE '1'.
   983         88  PI-CLAIM-CONVEN                 VALUE '2'.
   984
   985     12  PI-PROCESSOR-CSR-IND            PIC X.
   986         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
   987         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
   988
   989     12  FILLER                          PIC X(3).
   990
   991     12  PI-SYSTEM-LEVEL                 PIC X(145).
   992
   993     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   994         PI-SYSTEM-LEVEL.
   995
   996         16  PI-ENTRY-CODES.
   997             20  PI-ENTRY-CD-1           PIC X.
   998             20  PI-ENTRY-CD-2           PIC X.
   999
  1000         16  PI-RETURN-CODES.
  1001             20  PI-RETURN-CD-1          PIC X.
  1002             20  PI-RETURN-CD-2          PIC X.
  1003
  1004         16  PI-UPDATE-STATUS-SAVE.
  1005             20  PI-UPDATE-BY            PIC X(4).
  1006             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1007
  1008         16  PI-LOWER-CASE-LETTERS       PIC X.
  1009             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1010
  1011*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1012*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1013*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1014
  1015         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1016             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  21
* EL130.cbl
  1017             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1018             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1019             88  ACCNT-CNTL                  VALUE '3'.
  1020             88  CARR-ACCNT-CNTL             VALUE '4'.
  1021
  1022         16  PI-PROCESSOR-CAP-LIST.
  1023             20  PI-SYSTEM-CONTROLS.
  1024                24 PI-SYSTEM-DISPLAY     PIC X.
  1025                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1026                24 PI-SYSTEM-MODIFY      PIC X.
  1027                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1028             20  FILLER                  PIC XX.
  1029             20  PI-DISPLAY-CAP          PIC X.
  1030                 88  DISPLAY-CAP             VALUE 'Y'.
  1031             20  PI-MODIFY-CAP           PIC X.
  1032                 88  MODIFY-CAP              VALUE 'Y'.
  1033             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1034                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1035             20  PI-FORCE-CAP            PIC X.
  1036                 88  FORCE-CAP               VALUE 'Y'.
  1037
  1038         16  PI-PROGRAM-CONTROLS.
  1039             20  PI-PGM-PRINT-OPT        PIC X.
  1040             20  PI-PGM-FORMAT-OPT       PIC X.
  1041             20  PI-PGM-PROCESS-OPT      PIC X.
  1042             20  PI-PGM-TOTALS-OPT       PIC X.
  1043
  1044         16  PI-HELP-INTERFACE.
  1045             20  PI-LAST-ERROR-NO        PIC X(4).
  1046             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1047
  1048         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1049             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1050
  1051         16  PI-CR-CONTROL-IN-PROGRESS.
  1052             20  PI-CR-CARRIER           PIC X.
  1053             20  PI-CR-GROUPING          PIC X(6).
  1054             20  PI-CR-STATE             PIC XX.
  1055             20  PI-CR-ACCOUNT           PIC X(10).
  1056             20  PI-CR-FIN-RESP          PIC X(10).
  1057             20  PI-CR-TYPE              PIC X.
  1058
  1059         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1060
  1061         16  PI-CR-MONTH-END-DT          PIC XX.
  1062
  1063         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1064             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1065             88  PI-ZERO-CARRIER             VALUE '1'.
  1066             88  PI-ZERO-GROUPING            VALUE '2'.
  1067             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1068
  1069         16  PI-CARRIER-SECURITY         PIC X.
  1070             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1071
  1072         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1073             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1074             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  22
* EL130.cbl
  1075
  1076         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1077             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1078                                         INDEXED BY PI-ACCESS-NDX
  1079                                         PIC X.
  1080
  1081         16  PI-GA-BILLING-CONTROL       PIC X.
  1082             88  PI-GA-BILLING               VALUE '1'.
  1083
  1084         16  PI-MAIL-PROCESSING          PIC X.
  1085             88  PI-MAIL-YES                 VALUE 'Y'.
  1086
  1087         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1088
  1089         16  PI-AR-SYSTEM.
  1090             20  PI-AR-PROCESSING-CNTL   PIC X.
  1091                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1092             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1093             20  PI-AR-MONTH-END-DT      PIC XX.
  1094
  1095         16  PI-MP-SYSTEM.
  1096             20  PI-MORTGAGE-USER            PIC X.
  1097                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1098                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1099             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1100                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1101                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1102                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1103                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1104                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1105             20  PI-MP-MONTH-END-DT          PIC XX.
  1106             20  PI-MP-REFERENCE-NO.
  1107                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1108                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1109
  1110         16  PI-LABEL-CONTROL            PIC X(01).
  1111             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1112             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1113
  1114         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1115             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1116
  1117         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1118             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1119             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1120
  1121         16  FILLER                      PIC X(14).
  1122
  1123     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1124******************************************************************
  1125     12  PI-REDEF     REDEFINES PI-PROGRAM-WORK-AREA.
  1126         16  PI-MSTR-DT               PIC XX.
  1127         16  PI-MSTR-WHEN             PIC S9(6)   COMP-3.
  1128         16  PI-TRLR-DT               PIC XX.
  1129         16  PI-TRLR-WHEN             PIC S9(6)   COMP-3.
  1130         16  PI-LAST-CLAIM            PIC X(7).
  1131         16  PI-LAST-CARR             PIC X.
  1132         16  PI-LAST-CERT.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  23
* EL130.cbl
  1133             20  PI-LAST-CERT-PRIME   PIC X(10).
  1134             20  PI-LAST-CERT-SUFX    PIC X.
  1135         16  PI-LAST-CLAIM-TYPE       PIC X.
  1136         16  PI-CURSOR                PIC S9(4)   COMP.
  1137         16  PI-SAVE-CERT.
  1138             20  PI-SAVE-CERT-PRIME   PIC X(10).
  1139             20  PI-SAVE-CERT-SUFX    PIC X.
  1140         16  PI-SAVE-EFFDT            PIC X(2).
  1141         16  PI-SAVE-ACCOUNT          PIC X(10).
  1142         16  PI-INCURR-SW             PIC X.
  1143         16  PI-PRT-OPT               PIC X.
  1144         16  PI-ALT-PRT               PIC X(4).
  1145         16  PI-CLAIM-DELETED-SWITCH  PIC X.
  1146             88  CLAIM-DELETED-BY-EL131   VALUE 'D'.
  1147         16  FILLER                   PIC X(272).
  1148         16  PI-EL127-TO-EL130-CNTRL.
  1149             20  PI-CERT-SELECT-CNT          PIC S9(04) COMP.
  1150             20  PI-CERT-PROCESSED           PIC S9(04) COMP.
  1151             20  PI-CERT-CONTROLS-EL127  OCCURS 5 TIMES.
  1152                 24  PI-EL127-CARRIER        PIC X.
  1153                 24  PI-EL127-GROUPING       PIC X(6).
  1154                 24  PI-EL127-STATE          PIC X(2).
  1155                 24  PI-EL127-ACCOUNT        PIC X(10).
  1156                 24  PI-EL127-CERT-NO.
  1157                     28  PI-EL127-CERT-PRIME PIC X(10).
  1158                     28  PI-EL127-CERT-SUFX  PIC X.
  1159                 24  PI-EL127-EFF-DT         PIC XX.
  1160*        16  FILLER                          PIC X(50).
  1161         16  FILLER                          PIC X(31).
  1162         16  PI-EL659-TO-EL130-CNTRL.
  1163             20  PI-EL659-CARRIER            PIC X.
  1164             20  PI-EL659-GROUPING           PIC X(6).
  1165             20  PI-EL659-STATE              PIC XX.
  1166             20  PI-EL659-ACCOUNT            PIC X(10).
  1167
  1168         16  FILLER                          PIC X(19).
  1169
  1170         16  PI-SAVE-INCUR-DT                PIC X(02).
  1171         16  PI-LETTER-ERROR-CODE            PIC 9(04).
  1172*         16  FILLER                          PIC X(65).
  1173         16  PI-ST-VFY-2ND-BENE              PIC X.
  1174         16  PI-ST-CAUSAL-STATE              PIC X.
  1175         16  pi-dcc-max-benefits             pic s999 comp-3.
  1176         16  pi-dcc-max-amt                  pic s9(9)v99 comp-3.
  1177         16  pi-emi-sub                      pic 99.
  1178         16  FILLER                          PIC X(53).
  1179
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  24
* EL130.cbl
  1181*    COPY EL130S.
  1182 01  EL130AI.
  1183     05  FILLER            PIC  X(0012).
  1184*    -------------------------------
  1185     05  RUNDTEL PIC S9(0004) COMP.
  1186     05  RUNDTEF PIC  X(0001).
  1187     05  FILLER REDEFINES RUNDTEF.
  1188         10  RUNDTEA PIC  X(0001).
  1189     05  RUNDTEI PIC  X(0008).
  1190*    -------------------------------
  1191     05  RUNTIMEL PIC S9(0004) COMP.
  1192     05  RUNTIMEF PIC  X(0001).
  1193     05  FILLER REDEFINES RUNTIMEF.
  1194         10  RUNTIMEA PIC  X(0001).
  1195     05  RUNTIMEI PIC  X(0005).
  1196*    -------------------------------
  1197     05  COMPL PIC S9(0004) COMP.
  1198     05  COMPF PIC  X(0001).
  1199     05  FILLER REDEFINES COMPF.
  1200         10  COMPA PIC  X(0001).
  1201     05  COMPI PIC  X(0003).
  1202*    -------------------------------
  1203     05  SEQUL PIC S9(0004) COMP.
  1204     05  SEQUF PIC  X(0001).
  1205     05  FILLER REDEFINES SEQUF.
  1206         10  SEQUA PIC  X(0001).
  1207     05  SEQUI PIC  X(0010).
  1208*    -------------------------------
  1209     05  MAINTL PIC S9(0004) COMP.
  1210     05  MAINTF PIC  X(0001).
  1211     05  FILLER REDEFINES MAINTF.
  1212         10  MAINTA PIC  X(0001).
  1213     05  MAINTI PIC  X(0001).
  1214*    -------------------------------
  1215     05  CLMNOL PIC S9(0004) COMP.
  1216     05  CLMNOF PIC  X(0001).
  1217     05  FILLER REDEFINES CLMNOF.
  1218         10  CLMNOA PIC  X(0001).
  1219     05  CLMNOI PIC  X(0007).
  1220*    -------------------------------
  1221     05  CLMCARRL PIC S9(0004) COMP.
  1222     05  CLMCARRF PIC  X(0001).
  1223     05  FILLER REDEFINES CLMCARRF.
  1224         10  CLMCARRA PIC  X(0001).
  1225     05  CLMCARRI PIC  X(0001).
  1226*    -------------------------------
  1227     05  CLMTYPEL PIC S9(0004) COMP.
  1228     05  CLMTYPEF PIC  X(0001).
  1229     05  FILLER REDEFINES CLMTYPEF.
  1230         10  CLMTYPEA PIC  X(0001).
  1231     05  CLMTYPEI PIC  X(0001).
  1232*    -------------------------------
  1233     05  INSTYPEL PIC S9(0004) COMP.
  1234     05  INSTYPEF PIC  X(0001).
  1235     05  FILLER REDEFINES INSTYPEF.
  1236         10  INSTYPEA PIC  X(0001).
  1237     05  INSTYPEI PIC  X(0001).
  1238*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  25
* EL130.cbl
  1239     05  CERTNOL PIC S9(0004) COMP.
  1240     05  CERTNOF PIC  X(0001).
  1241     05  FILLER REDEFINES CERTNOF.
  1242         10  CERTNOA PIC  X(0001).
  1243     05  CERTNOI PIC  X(0010).
  1244*    -------------------------------
  1245     05  SUFXL PIC S9(0004) COMP.
  1246     05  SUFXF PIC  X(0001).
  1247     05  FILLER REDEFINES SUFXF.
  1248         10  SUFXA PIC  X(0001).
  1249     05  SUFXI PIC  X(0001).
  1250*    -------------------------------
  1251     05  PCERTNOL PIC S9(0004) COMP.
  1252     05  PCERTNOF PIC  X(0001).
  1253     05  FILLER REDEFINES PCERTNOF.
  1254         10  PCERTNOA PIC  X(0001).
  1255     05  PCERTNOI PIC  X(0010).
  1256*    -------------------------------
  1257     05  PSUFXL PIC S9(0004) COMP.
  1258     05  PSUFXF PIC  X(0001).
  1259     05  FILLER REDEFINES PSUFXF.
  1260         10  PSUFXA PIC  X(0001).
  1261     05  PSUFXI PIC  X(0001).
  1262*    -------------------------------
  1263     05  INCURL PIC S9(0004) COMP.
  1264     05  INCURF PIC  X(0001).
  1265     05  FILLER REDEFINES INCURF.
  1266         10  INCURA PIC  X(0001).
  1267     05  INCURI PIC  X(0008).
  1268*    -------------------------------
  1269     05  REPORTL PIC S9(0004) COMP.
  1270     05  REPORTF PIC  X(0001).
  1271     05  FILLER REDEFINES REPORTF.
  1272         10  REPORTA PIC  X(0001).
  1273     05  REPORTI PIC  X(0008).
  1274*    -------------------------------
  1275     05  CAUSEL PIC S9(0004) COMP.
  1276     05  CAUSEF PIC  X(0001).
  1277     05  FILLER REDEFINES CAUSEF.
  1278         10  CAUSEA PIC  X(0001).
  1279     05  CAUSEI PIC  X(0006).
  1280*    -------------------------------
  1281     05  ESTENDL PIC S9(0004) COMP.
  1282     05  ESTENDF PIC  X(0001).
  1283     05  FILLER REDEFINES ESTENDF.
  1284         10  ESTENDA PIC  X(0001).
  1285     05  ESTENDI PIC  X(0008).
  1286*    -------------------------------
  1287     05  DIAGL PIC S9(0004) COMP.
  1288     05  DIAGF PIC  X(0001).
  1289     05  FILLER REDEFINES DIAGF.
  1290         10  DIAGA PIC  X(0001).
  1291     05  DIAGI PIC  X(0060).
  1292*    -------------------------------
  1293     05  BENECDL PIC S9(0004) COMP.
  1294     05  BENECDF PIC  X(0001).
  1295     05  FILLER REDEFINES BENECDF.
  1296         10  BENECDA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  26
* EL130.cbl
  1297     05  BENECDI PIC  X(0010).
  1298*    -------------------------------
  1299     05  BIRTHDTL PIC S9(0004) COMP.
  1300     05  BIRTHDTF PIC  X(0001).
  1301     05  FILLER REDEFINES BIRTHDTF.
  1302         10  BIRTHDTA PIC  X(0001).
  1303     05  BIRTHDTI PIC  X(0008).
  1304*    -------------------------------
  1305     05  SSNL PIC S9(0004) COMP.
  1306     05  SSNF PIC  X(0001).
  1307     05  FILLER REDEFINES SSNF.
  1308         10  SSNA PIC  X(0001).
  1309     05  SSNI PIC  X(0011).
  1310*    -------------------------------
  1311     05  SEXL PIC S9(0004) COMP.
  1312     05  SEXF PIC  X(0001).
  1313     05  FILLER REDEFINES SEXF.
  1314         10  SEXA PIC  X(0001).
  1315     05  SEXI PIC  X(0001).
  1316*    -------------------------------
  1317     05  OCCCDL PIC S9(0004) COMP.
  1318     05  OCCCDF PIC  X(0001).
  1319     05  FILLER REDEFINES OCCCDF.
  1320         10  OCCCDA PIC  X(0001).
  1321     05  OCCCDI PIC  X(0006).
  1322*    -------------------------------
  1323     05  LSTNMEL PIC S9(0004) COMP.
  1324     05  LSTNMEF PIC  X(0001).
  1325     05  FILLER REDEFINES LSTNMEF.
  1326         10  LSTNMEA PIC  X(0001).
  1327     05  LSTNMEI PIC  X(0015).
  1328*    -------------------------------
  1329     05  FSTNMEL PIC S9(0004) COMP.
  1330     05  FSTNMEF PIC  X(0001).
  1331     05  FILLER REDEFINES FSTNMEF.
  1332         10  FSTNMEA PIC  X(0001).
  1333     05  FSTNMEI PIC  X(0012).
  1334*    -------------------------------
  1335     05  INITL PIC S9(0004) COMP.
  1336     05  INITF PIC  X(0001).
  1337     05  FILLER REDEFINES INITF.
  1338         10  INITA PIC  X(0001).
  1339     05  INITI PIC  X(0001).
  1340*    -------------------------------
  1341     05  LOANNOL PIC S9(0004) COMP.
  1342     05  LOANNOF PIC  X(0001).
  1343     05  FILLER REDEFINES LOANNOF.
  1344         10  LOANNOA PIC  X(0001).
  1345     05  LOANNOI PIC  X(0008).
  1346*    -------------------------------
  1347     05  CRTLNMEL PIC S9(0004) COMP.
  1348     05  CRTLNMEF PIC  X(0001).
  1349     05  FILLER REDEFINES CRTLNMEF.
  1350         10  CRTLNMEA PIC  X(0001).
  1351     05  CRTLNMEI PIC  X(0015).
  1352*    -------------------------------
  1353     05  CRTFNMEL PIC S9(0004) COMP.
  1354     05  CRTFNMEF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  27
* EL130.cbl
  1355     05  FILLER REDEFINES CRTFNMEF.
  1356         10  CRTFNMEA PIC  X(0001).
  1357     05  CRTFNMEI PIC  X(0012).
  1358*    -------------------------------
  1359     05  CRTINITL PIC S9(0004) COMP.
  1360     05  CRTINITF PIC  X(0001).
  1361     05  FILLER REDEFINES CRTINITF.
  1362         10  CRTINITA PIC  X(0001).
  1363     05  CRTINITI PIC  X(0001).
  1364*    -------------------------------
  1365     05  LOANBALL PIC S9(0004) COMP.
  1366     05  LOANBALF PIC  X(0001).
  1367     05  FILLER REDEFINES LOANBALF.
  1368         10  LOANBALA PIC  X(0001).
  1369     05  LOANBALI PIC  9(7)V99.
  1370*    -------------------------------
  1371     05  MANRSVL PIC S9(0004) COMP.
  1372     05  MANRSVF PIC  X(0001).
  1373     05  FILLER REDEFINES MANRSVF.
  1374         10  MANRSVA PIC  X(0001).
  1375     05  MANRSVI PIC  9(7)V99.
  1376*    -------------------------------
  1377     05  SUPVL PIC S9(0004) COMP.
  1378     05  SUPVF PIC  X(0001).
  1379     05  FILLER REDEFINES SUPVF.
  1380         10  SUPVA PIC  X(0001).
  1381     05  SUPVI PIC  X(0001).
  1382*    -------------------------------
  1383     05  PRICDL PIC S9(0004) COMP.
  1384     05  PRICDF PIC  X(0001).
  1385     05  FILLER REDEFINES PRICDF.
  1386         10  PRICDA PIC  X(0001).
  1387     05  PRICDI PIC  X(0001).
  1388*    -------------------------------
  1389     05  PRODL PIC S9(0004) COMP.
  1390     05  PRODF PIC  X(0001).
  1391     05  FILLER REDEFINES PRODF.
  1392         10  PRODA PIC  X(0001).
  1393     05  PRODI PIC  X(0008).
  1394*    -------------------------------
  1395     05  PRODCDL PIC S9(0004) COMP.
  1396     05  PRODCDF PIC  X(0001).
  1397     05  FILLER REDEFINES PRODCDF.
  1398         10  PRODCDA PIC  X(0001).
  1399     05  PRODCDI PIC  X(0001).
  1400*    -------------------------------
  1401     05  FILETOL PIC S9(0004) COMP.
  1402     05  FILETOF PIC  X(0001).
  1403     05  FILLER REDEFINES FILETOF.
  1404         10  FILETOA PIC  X(0001).
  1405     05  FILETOI PIC  X(0004).
  1406*    -------------------------------
  1407     05  PROCCDL PIC S9(0004) COMP.
  1408     05  PROCCDF PIC  X(0001).
  1409     05  FILLER REDEFINES PROCCDF.
  1410         10  PROCCDA PIC  X(0001).
  1411     05  PROCCDI PIC  X(0004).
  1412*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  28
* EL130.cbl
  1413     05  RELCLML PIC S9(0004) COMP.
  1414     05  RELCLMF PIC  X(0001).
  1415     05  FILLER REDEFINES RELCLMF.
  1416         10  RELCLMA PIC  X(0001).
  1417     05  RELCLMI PIC  X(0007).
  1418*    -------------------------------
  1419     05  PRTOPTL PIC S9(0004) COMP.
  1420     05  PRTOPTF PIC  X(0001).
  1421     05  FILLER REDEFINES PRTOPTF.
  1422         10  PRTOPTA PIC  X(0001).
  1423     05  PRTOPTI PIC  X(0001).
  1424*    -------------------------------
  1425     05  ALTPRTL PIC S9(0004) COMP.
  1426     05  ALTPRTF PIC  X(0001).
  1427     05  FILLER REDEFINES ALTPRTF.
  1428         10  ALTPRTA PIC  X(0001).
  1429     05  ALTPRTI PIC  X(0004).
  1430*    -------------------------------
  1431     05  CERTMTL PIC S9(0004) COMP.
  1432     05  CERTMTF PIC  X(0001).
  1433     05  FILLER REDEFINES CERTMTF.
  1434         10  CERTMTA PIC  X(0001).
  1435     05  CERTMTI PIC  X(0001).
  1436*    -------------------------------
  1437     05  CRTCARRL PIC S9(0004) COMP.
  1438     05  CRTCARRF PIC  X(0001).
  1439     05  FILLER REDEFINES CRTCARRF.
  1440         10  CRTCARRA PIC  X(0001).
  1441     05  CRTCARRI PIC  X(0001).
  1442*    -------------------------------
  1443     05  GROUPL PIC S9(0004) COMP.
  1444     05  GROUPF PIC  X(0001).
  1445     05  FILLER REDEFINES GROUPF.
  1446         10  GROUPA PIC  X(0001).
  1447     05  GROUPI PIC  X(0006).
  1448*    -------------------------------
  1449     05  STATEL PIC S9(0004) COMP.
  1450     05  STATEF PIC  X(0001).
  1451     05  FILLER REDEFINES STATEF.
  1452         10  STATEA PIC  X(0001).
  1453     05  STATEI PIC  X(0002).
  1454*    -------------------------------
  1455     05  ACCOUNTL PIC S9(0004) COMP.
  1456     05  ACCOUNTF PIC  X(0001).
  1457     05  FILLER REDEFINES ACCOUNTF.
  1458         10  ACCOUNTA PIC  X(0001).
  1459     05  ACCOUNTI PIC  X(0010).
  1460*    -------------------------------
  1461     05  EFFDTL PIC S9(0004) COMP.
  1462     05  EFFDTF PIC  X(0001).
  1463     05  FILLER REDEFINES EFFDTF.
  1464         10  EFFDTA PIC  X(0001).
  1465     05  EFFDTI PIC  X(0008).
  1466*    -------------------------------
  1467     05  CRTSSNL PIC S9(0004) COMP.
  1468     05  CRTSSNF PIC  X(0001).
  1469     05  FILLER REDEFINES CRTSSNF.
  1470         10  CRTSSNA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  29
* EL130.cbl
  1471     05  CRTSSNI PIC  X(0011).
  1472*    -------------------------------
  1473     05  MEMCAPL PIC S9(0004) COMP.
  1474     05  MEMCAPF PIC  X(0001).
  1475     05  FILLER REDEFINES MEMCAPF.
  1476         10  MEMCAPA PIC  X(0001).
  1477     05  MEMCAPI PIC  X(0010).
  1478*    -------------------------------
  1479     05  MEMBERL PIC S9(0004) COMP.
  1480     05  MEMBERF PIC  X(0001).
  1481     05  FILLER REDEFINES MEMBERF.
  1482         10  MEMBERA PIC  X(0001).
  1483     05  MEMBERI PIC  X(0012).
  1484*    -------------------------------
  1485     05  REINCDL PIC S9(0004) COMP.
  1486     05  REINCDF PIC  X(0001).
  1487     05  FILLER REDEFINES REINCDF.
  1488         10  REINCDA PIC  X(0001).
  1489     05  REINCDI PIC  X(0001).
  1490*    -------------------------------
  1491     05  ISSAGEL PIC S9(0004) COMP.
  1492     05  ISSAGEF PIC  X(0001).
  1493     05  FILLER REDEFINES ISSAGEF.
  1494         10  ISSAGEA PIC  X(0001).
  1495     05  ISSAGEI PIC  X(0002).
  1496*    -------------------------------
  1497     05  APRL PIC S9(0004) COMP.
  1498     05  APRF PIC  X(0001).
  1499     05  FILLER REDEFINES APRF.
  1500         10  APRA PIC  X(0001).
  1501     05  APRI PIC  9(4)V9(4).
  1502*    -------------------------------
  1503     05  PMTFREQL PIC S9(0004) COMP.
  1504     05  PMTFREQF PIC  X(0001).
  1505     05  FILLER REDEFINES PMTFREQF.
  1506         10  PMTFREQA PIC  X(0001).
  1507     05  PMTFREQI PIC  99.
  1508*    -------------------------------
  1509     05  INDGRPL PIC S9(0004) COMP.
  1510     05  INDGRPF PIC  X(0001).
  1511     05  FILLER REDEFINES INDGRPF.
  1512         10  INDGRPA PIC  X(0001).
  1513     05  INDGRPI PIC  X(0001).
  1514*    -------------------------------
  1515     05  PREMTYPL PIC S9(0004) COMP.
  1516     05  PREMTYPF PIC  X(0001).
  1517     05  FILLER REDEFINES PREMTYPF.
  1518         10  PREMTYPA PIC  X(0001).
  1519     05  PREMTYPI PIC  X(0001).
  1520*    -------------------------------
  1521     05  ADDONDTL PIC S9(0004) COMP.
  1522     05  ADDONDTF PIC  X(0001).
  1523     05  FILLER REDEFINES ADDONDTF.
  1524         10  ADDONDTA PIC  X(0001).
  1525     05  ADDONDTI PIC  X(0008).
  1526*    -------------------------------
  1527     05  JNTLNMEL PIC S9(0004) COMP.
  1528     05  JNTLNMEF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  30
* EL130.cbl
  1529     05  FILLER REDEFINES JNTLNMEF.
  1530         10  JNTLNMEA PIC  X(0001).
  1531     05  JNTLNMEI PIC  X(0015).
  1532*    -------------------------------
  1533     05  JNTFNMEL PIC S9(0004) COMP.
  1534     05  JNTFNMEF PIC  X(0001).
  1535     05  FILLER REDEFINES JNTFNMEF.
  1536         10  JNTFNMEA PIC  X(0001).
  1537     05  JNTFNMEI PIC  X(0002).
  1538*    -------------------------------
  1539     05  JNTINITL PIC S9(0004) COMP.
  1540     05  JNTINITF PIC  X(0001).
  1541     05  FILLER REDEFINES JNTINITF.
  1542         10  JNTINITA PIC  X(0001).
  1543     05  JNTINITI PIC  X(0001).
  1544*    -------------------------------
  1545     05  JNTAGEL PIC S9(0004) COMP.
  1546     05  JNTAGEF PIC  X(0001).
  1547     05  FILLER REDEFINES JNTAGEF.
  1548         10  JNTAGEA PIC  X(0001).
  1549     05  JNTAGEI PIC  X(0002).
  1550*    -------------------------------
  1551     05  LCVDSCRL PIC S9(0004) COMP.
  1552     05  LCVDSCRF PIC  X(0001).
  1553     05  FILLER REDEFINES LCVDSCRF.
  1554         10  LCVDSCRA PIC  X(0001).
  1555     05  LCVDSCRI PIC  X(0006).
  1556*    -------------------------------
  1557     05  LCVKINDL PIC S9(0004) COMP.
  1558     05  LCVKINDF PIC  X(0001).
  1559     05  FILLER REDEFINES LCVKINDF.
  1560         10  LCVKINDA PIC  X(0001).
  1561     05  LCVKINDI PIC  X(0003).
  1562*    -------------------------------
  1563     05  LCVCDL PIC S9(0004) COMP.
  1564     05  LCVCDF PIC  X(0001).
  1565     05  FILLER REDEFINES LCVCDF.
  1566         10  LCVCDA PIC  X(0001).
  1567     05  LCVCDI PIC  X(0002).
  1568*    -------------------------------
  1569     05  LCVOTRML PIC S9(0004) COMP.
  1570     05  LCVOTRMF PIC  X(0001).
  1571     05  FILLER REDEFINES LCVOTRMF.
  1572         10  LCVOTRMA PIC  X(0001).
  1573     05  LCVOTRMI PIC  999.
  1574*    -------------------------------
  1575     05  LCVRTRML PIC S9(0004) COMP.
  1576     05  LCVRTRMF PIC  X(0001).
  1577     05  FILLER REDEFINES LCVRTRMF.
  1578         10  LCVRTRMA PIC  X(0001).
  1579     05  LCVRTRMI PIC  X(0003).
  1580*    -------------------------------
  1581     05  LCVRATEL PIC S9(0004) COMP.
  1582     05  LCVRATEF PIC  X(0001).
  1583     05  FILLER REDEFINES LCVRATEF.
  1584         10  LCVRATEA PIC  X(0001).
  1585     05  LCVRATEI PIC  9999V99.
  1586*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  31
* EL130.cbl
  1587     05  LCVBENEL PIC S9(0004) COMP.
  1588     05  LCVBENEF PIC  X(0001).
  1589     05  FILLER REDEFINES LCVBENEF.
  1590         10  LCVBENEA PIC  X(0001).
  1591     05  LCVBENEI PIC  9(9)V99.
  1592*    -------------------------------
  1593     05  LCVFORML PIC S9(0004) COMP.
  1594     05  LCVFORMF PIC  X(0001).
  1595     05  FILLER REDEFINES LCVFORMF.
  1596         10  LCVFORMA PIC  X(0001).
  1597     05  LCVFORMI PIC  X(0012).
  1598*    -------------------------------
  1599     05  LCVCNDTL PIC S9(0004) COMP.
  1600     05  LCVCNDTF PIC  X(0001).
  1601     05  FILLER REDEFINES LCVCNDTF.
  1602         10  LCVCNDTA PIC  X(0001).
  1603     05  LCVCNDTI PIC  X(0008).
  1604*    -------------------------------
  1605     05  LCVEXITL PIC S9(0004) COMP.
  1606     05  LCVEXITF PIC  X(0001).
  1607     05  FILLER REDEFINES LCVEXITF.
  1608         10  LCVEXITA PIC  X(0001).
  1609     05  LCVEXITI PIC  X(0008).
  1610*    -------------------------------
  1611     05  LCVSTATL PIC S9(0004) COMP.
  1612     05  LCVSTATF PIC  X(0001).
  1613     05  FILLER REDEFINES LCVSTATF.
  1614         10  LCVSTATA PIC  X(0001).
  1615     05  LCVSTATI PIC  X(0006).
  1616*    -------------------------------
  1617     05  ACVDSCRL PIC S9(0004) COMP.
  1618     05  ACVDSCRF PIC  X(0001).
  1619     05  FILLER REDEFINES ACVDSCRF.
  1620         10  ACVDSCRA PIC  X(0001).
  1621     05  ACVDSCRI PIC  X(0006).
  1622*    -------------------------------
  1623     05  ACVKINDL PIC S9(0004) COMP.
  1624     05  ACVKINDF PIC  X(0001).
  1625     05  FILLER REDEFINES ACVKINDF.
  1626         10  ACVKINDA PIC  X(0001).
  1627     05  ACVKINDI PIC  X(0003).
  1628*    -------------------------------
  1629     05  ACVCDL PIC S9(0004) COMP.
  1630     05  ACVCDF PIC  X(0001).
  1631     05  FILLER REDEFINES ACVCDF.
  1632         10  ACVCDA PIC  X(0001).
  1633     05  ACVCDI PIC  X(0002).
  1634*    -------------------------------
  1635     05  ACVOTRML PIC S9(0004) COMP.
  1636     05  ACVOTRMF PIC  X(0001).
  1637     05  FILLER REDEFINES ACVOTRMF.
  1638         10  ACVOTRMA PIC  X(0001).
  1639     05  ACVOTRMI PIC  999.
  1640*    -------------------------------
  1641     05  ACVRTRML PIC S9(0004) COMP.
  1642     05  ACVRTRMF PIC  X(0001).
  1643     05  FILLER REDEFINES ACVRTRMF.
  1644         10  ACVRTRMA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  32
* EL130.cbl
  1645     05  ACVRTRMI PIC  X(0003).
  1646*    -------------------------------
  1647     05  ACVRATEL PIC S9(0004) COMP.
  1648     05  ACVRATEF PIC  X(0001).
  1649     05  FILLER REDEFINES ACVRATEF.
  1650         10  ACVRATEA PIC  X(0001).
  1651     05  ACVRATEI PIC  9999V99.
  1652*    -------------------------------
  1653     05  ACVBENEL PIC S9(0004) COMP.
  1654     05  ACVBENEF PIC  X(0001).
  1655     05  FILLER REDEFINES ACVBENEF.
  1656         10  ACVBENEA PIC  X(0001).
  1657     05  ACVBENEI PIC  9(9)V99.
  1658*    -------------------------------
  1659     05  ACVFORML PIC S9(0004) COMP.
  1660     05  ACVFORMF PIC  X(0001).
  1661     05  FILLER REDEFINES ACVFORMF.
  1662         10  ACVFORMA PIC  X(0001).
  1663     05  ACVFORMI PIC  X(0012).
  1664*    -------------------------------
  1665     05  ACVCNDTL PIC S9(0004) COMP.
  1666     05  ACVCNDTF PIC  X(0001).
  1667     05  FILLER REDEFINES ACVCNDTF.
  1668         10  ACVCNDTA PIC  X(0001).
  1669     05  ACVCNDTI PIC  X(0008).
  1670*    -------------------------------
  1671     05  ACVEXITL PIC S9(0004) COMP.
  1672     05  ACVEXITF PIC  X(0001).
  1673     05  FILLER REDEFINES ACVEXITF.
  1674         10  ACVEXITA PIC  X(0001).
  1675     05  ACVEXITI PIC  X(0008).
  1676*    -------------------------------
  1677     05  ACVSTATL PIC S9(0004) COMP.
  1678     05  ACVSTATF PIC  X(0001).
  1679     05  FILLER REDEFINES ACVSTATF.
  1680         10  ACVSTATA PIC  X(0001).
  1681     05  ACVSTATI PIC  X(0006).
  1682*    -------------------------------
  1683     05  ERRMSG1L PIC S9(0004) COMP.
  1684     05  ERRMSG1F PIC  X(0001).
  1685     05  FILLER REDEFINES ERRMSG1F.
  1686         10  ERRMSG1A PIC  X(0001).
  1687     05  ERRMSG1I PIC  X(0072).
  1688*    -------------------------------
  1689     05  ERRMSG2L PIC S9(0004) COMP.
  1690     05  ERRMSG2F PIC  X(0001).
  1691     05  FILLER REDEFINES ERRMSG2F.
  1692         10  ERRMSG2A PIC  X(0001).
  1693     05  ERRMSG2I PIC  X(0072).
  1694*    -------------------------------
  1695     05  BCERT1L PIC S9(0004) COMP.
  1696     05  BCERT1F PIC  X(0001).
  1697     05  FILLER REDEFINES BCERT1F.
  1698         10  BCERT1A PIC  X(0001).
  1699     05  BCERT1I PIC  X(0010).
  1700*    -------------------------------
  1701     05  BSUFX1L PIC S9(0004) COMP.
  1702     05  BSUFX1F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  33
* EL130.cbl
  1703     05  FILLER REDEFINES BSUFX1F.
  1704         10  BSUFX1A PIC  X(0001).
  1705     05  BSUFX1I PIC  X(0001).
  1706*    -------------------------------
  1707     05  BCERT2L PIC S9(0004) COMP.
  1708     05  BCERT2F PIC  X(0001).
  1709     05  FILLER REDEFINES BCERT2F.
  1710         10  BCERT2A PIC  X(0001).
  1711     05  BCERT2I PIC  X(0010).
  1712*    -------------------------------
  1713     05  BSUFX2L PIC S9(0004) COMP.
  1714     05  BSUFX2F PIC  X(0001).
  1715     05  FILLER REDEFINES BSUFX2F.
  1716         10  BSUFX2A PIC  X(0001).
  1717     05  BSUFX2I PIC  X(0001).
  1718*    -------------------------------
  1719     05  BCERT3L PIC S9(0004) COMP.
  1720     05  BCERT3F PIC  X(0001).
  1721     05  FILLER REDEFINES BCERT3F.
  1722         10  BCERT3A PIC  X(0001).
  1723     05  BCERT3I PIC  X(0010).
  1724*    -------------------------------
  1725     05  BSUFX3L PIC S9(0004) COMP.
  1726     05  BSUFX3F PIC  X(0001).
  1727     05  FILLER REDEFINES BSUFX3F.
  1728         10  BSUFX3A PIC  X(0001).
  1729     05  BSUFX3I PIC  X(0001).
  1730*    -------------------------------
  1731     05  BCERT4L PIC S9(0004) COMP.
  1732     05  BCERT4F PIC  X(0001).
  1733     05  FILLER REDEFINES BCERT4F.
  1734         10  BCERT4A PIC  X(0001).
  1735     05  BCERT4I PIC  X(0010).
  1736*    -------------------------------
  1737     05  BSUFX4L PIC S9(0004) COMP.
  1738     05  BSUFX4F PIC  X(0001).
  1739     05  FILLER REDEFINES BSUFX4F.
  1740         10  BSUFX4A PIC  X(0001).
  1741     05  BSUFX4I PIC  X(0001).
  1742*    -------------------------------
  1743     05  BCERT5L PIC S9(0004) COMP.
  1744     05  BCERT5F PIC  X(0001).
  1745     05  FILLER REDEFINES BCERT5F.
  1746         10  BCERT5A PIC  X(0001).
  1747     05  BCERT5I PIC  X(0010).
  1748*    -------------------------------
  1749     05  BSUFX5L PIC S9(0004) COMP.
  1750     05  BSUFX5F PIC  X(0001).
  1751     05  FILLER REDEFINES BSUFX5F.
  1752         10  BSUFX5A PIC  X(0001).
  1753     05  BSUFX5I PIC  X(0001).
  1754*    -------------------------------
  1755     05  ENTERPFL PIC S9(0004) COMP.
  1756     05  ENTERPFF PIC  X(0001).
  1757     05  FILLER REDEFINES ENTERPFF.
  1758         10  ENTERPFA PIC  X(0001).
  1759     05  ENTERPFI PIC  99.
  1760*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  34
* EL130.cbl
  1761     05  PF5L PIC S9(0004) COMP.
  1762     05  PF5F PIC  X(0001).
  1763     05  FILLER REDEFINES PF5F.
  1764         10  PF5A PIC  X(0001).
  1765     05  PF5I PIC  X(0013).
  1766 01  EL130AO REDEFINES EL130AI.
  1767     05  FILLER            PIC  X(0012).
  1768*    -------------------------------
  1769     05  FILLER            PIC  X(0003).
  1770     05  RUNDTEO PIC  X(0008).
  1771*    -------------------------------
  1772     05  FILLER            PIC  X(0003).
  1773     05  RUNTIMEO PIC  99.99.
  1774*    -------------------------------
  1775     05  FILLER            PIC  X(0003).
  1776     05  COMPO PIC  X(0003).
  1777*    -------------------------------
  1778     05  FILLER            PIC  X(0003).
  1779     05  SEQUO PIC  X(0010).
  1780*    -------------------------------
  1781     05  FILLER            PIC  X(0003).
  1782     05  MAINTO PIC  X(0001).
  1783*    -------------------------------
  1784     05  FILLER            PIC  X(0003).
  1785     05  CLMNOO PIC  X(0007).
  1786*    -------------------------------
  1787     05  FILLER            PIC  X(0003).
  1788     05  CLMCARRO PIC  X(0001).
  1789*    -------------------------------
  1790     05  FILLER            PIC  X(0003).
  1791     05  CLMTYPEO PIC  X(0001).
  1792*    -------------------------------
  1793     05  FILLER            PIC  X(0003).
  1794     05  INSTYPEO PIC  X(0001).
  1795*    -------------------------------
  1796     05  FILLER            PIC  X(0003).
  1797     05  CERTNOO PIC  X(0010).
  1798*    -------------------------------
  1799     05  FILLER            PIC  X(0003).
  1800     05  SUFXO PIC  X(0001).
  1801*    -------------------------------
  1802     05  FILLER            PIC  X(0003).
  1803     05  PCERTNOO PIC  X(0010).
  1804*    -------------------------------
  1805     05  FILLER            PIC  X(0003).
  1806     05  PSUFXO PIC  X(0001).
  1807*    -------------------------------
  1808     05  FILLER            PIC  X(0003).
  1809     05  INCURO PIC  X(0008).
  1810*    -------------------------------
  1811     05  FILLER            PIC  X(0003).
  1812     05  REPORTO PIC  X(0008).
  1813*    -------------------------------
  1814     05  FILLER            PIC  X(0003).
  1815     05  CAUSEO PIC  X(0006).
  1816*    -------------------------------
  1817     05  FILLER            PIC  X(0003).
  1818     05  ESTENDO PIC  X(0008).
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  35
* EL130.cbl
  1819*    -------------------------------
  1820     05  FILLER            PIC  X(0003).
  1821     05  DIAGO PIC  X(0060).
  1822*    -------------------------------
  1823     05  FILLER            PIC  X(0003).
  1824     05  BENECDO PIC  X(0010).
  1825*    -------------------------------
  1826     05  FILLER            PIC  X(0003).
  1827     05  BIRTHDTO PIC  X(0008).
  1828*    -------------------------------
  1829     05  FILLER            PIC  X(0003).
  1830     05  SSNO PIC  X(0011).
  1831*    -------------------------------
  1832     05  FILLER            PIC  X(0003).
  1833     05  SEXO PIC  X(0001).
  1834*    -------------------------------
  1835     05  FILLER            PIC  X(0003).
  1836     05  OCCCDO PIC  X(0006).
  1837*    -------------------------------
  1838     05  FILLER            PIC  X(0003).
  1839     05  LSTNMEO PIC  X(0015).
  1840*    -------------------------------
  1841     05  FILLER            PIC  X(0003).
  1842     05  FSTNMEO PIC  X(0012).
  1843*    -------------------------------
  1844     05  FILLER            PIC  X(0003).
  1845     05  INITO PIC  X(0001).
  1846*    -------------------------------
  1847     05  FILLER            PIC  X(0003).
  1848     05  LOANNOO PIC  X(0008).
  1849*    -------------------------------
  1850     05  FILLER            PIC  X(0003).
  1851     05  CRTLNMEO PIC  X(0015).
  1852*    -------------------------------
  1853     05  FILLER            PIC  X(0003).
  1854     05  CRTFNMEO PIC  X(0012).
  1855*    -------------------------------
  1856     05  FILLER            PIC  X(0003).
  1857     05  CRTINITO PIC  X(0001).
  1858*    -------------------------------
  1859     05  FILLER            PIC  X(0003).
  1860     05  LOANBALO PIC  ZZZZZ9.99.
  1861*    -------------------------------
  1862     05  FILLER            PIC  X(0003).
  1863     05  MANRSVO PIC  Z(5)9.99.
  1864*    -------------------------------
  1865     05  FILLER            PIC  X(0003).
  1866     05  SUPVO PIC  X(0001).
  1867*    -------------------------------
  1868     05  FILLER            PIC  X(0003).
  1869     05  PRICDO PIC  X(0001).
  1870*    -------------------------------
  1871     05  FILLER            PIC  X(0003).
  1872     05  PRODO PIC  X(0008).
  1873*    -------------------------------
  1874     05  FILLER            PIC  X(0003).
  1875     05  PRODCDO PIC  X(0001).
  1876*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  36
* EL130.cbl
  1877     05  FILLER            PIC  X(0003).
  1878     05  FILETOO PIC  X(0004).
  1879*    -------------------------------
  1880     05  FILLER            PIC  X(0003).
  1881     05  PROCCDO PIC  X(0004).
  1882*    -------------------------------
  1883     05  FILLER            PIC  X(0003).
  1884     05  RELCLMO PIC  X(0007).
  1885*    -------------------------------
  1886     05  FILLER            PIC  X(0003).
  1887     05  PRTOPTO PIC  X(0001).
  1888*    -------------------------------
  1889     05  FILLER            PIC  X(0003).
  1890     05  ALTPRTO PIC  X(0004).
  1891*    -------------------------------
  1892     05  FILLER            PIC  X(0003).
  1893     05  CERTMTO PIC  X(0001).
  1894*    -------------------------------
  1895     05  FILLER            PIC  X(0003).
  1896     05  CRTCARRO PIC  X(0001).
  1897*    -------------------------------
  1898     05  FILLER            PIC  X(0003).
  1899     05  GROUPO PIC  X(0006).
  1900*    -------------------------------
  1901     05  FILLER            PIC  X(0003).
  1902     05  STATEO PIC  X(0002).
  1903*    -------------------------------
  1904     05  FILLER            PIC  X(0003).
  1905     05  ACCOUNTO PIC  X(0010).
  1906*    -------------------------------
  1907     05  FILLER            PIC  X(0003).
  1908     05  EFFDTO PIC  X(0008).
  1909*    -------------------------------
  1910     05  FILLER            PIC  X(0003).
  1911     05  CRTSSNO PIC  X(0011).
  1912*    -------------------------------
  1913     05  FILLER            PIC  X(0003).
  1914     05  MEMCAPO PIC  X(0010).
  1915*    -------------------------------
  1916     05  FILLER            PIC  X(0003).
  1917     05  MEMBERO PIC  X(0012).
  1918*    -------------------------------
  1919     05  FILLER            PIC  X(0003).
  1920     05  REINCDO PIC  X(0001).
  1921*    -------------------------------
  1922     05  FILLER            PIC  X(0003).
  1923     05  ISSAGEO PIC  X(0002).
  1924*    -------------------------------
  1925     05  FILLER            PIC  X(0003).
  1926     05  APRO PIC  9(3).9(4).
  1927*    -------------------------------
  1928     05  FILLER            PIC  X(0003).
  1929     05  PMTFREQO PIC  99.
  1930*    -------------------------------
  1931     05  FILLER            PIC  X(0003).
  1932     05  INDGRPO PIC  X(0001).
  1933*    -------------------------------
  1934     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  37
* EL130.cbl
  1935     05  PREMTYPO PIC  X(0001).
  1936*    -------------------------------
  1937     05  FILLER            PIC  X(0003).
  1938     05  ADDONDTO PIC  X(0008).
  1939*    -------------------------------
  1940     05  FILLER            PIC  X(0003).
  1941     05  JNTLNMEO PIC  X(0015).
  1942*    -------------------------------
  1943     05  FILLER            PIC  X(0003).
  1944     05  JNTFNMEO PIC  X(0002).
  1945*    -------------------------------
  1946     05  FILLER            PIC  X(0003).
  1947     05  JNTINITO PIC  X(0001).
  1948*    -------------------------------
  1949     05  FILLER            PIC  X(0003).
  1950     05  JNTAGEO PIC  X(0002).
  1951*    -------------------------------
  1952     05  FILLER            PIC  X(0003).
  1953     05  LCVDSCRO PIC  X(0006).
  1954*    -------------------------------
  1955     05  FILLER            PIC  X(0003).
  1956     05  LCVKINDO PIC  X(0003).
  1957*    -------------------------------
  1958     05  FILLER            PIC  X(0003).
  1959     05  LCVCDO PIC  X(0002).
  1960*    -------------------------------
  1961     05  FILLER            PIC  X(0003).
  1962     05  LCVOTRMO PIC  999.
  1963*    -------------------------------
  1964     05  FILLER            PIC  X(0003).
  1965     05  LCVRTRMO PIC  ZZZ.
  1966*    -------------------------------
  1967     05  FILLER            PIC  X(0003).
  1968     05  LCVRATEO PIC  ZZZ.ZZ.
  1969*    -------------------------------
  1970     05  FILLER            PIC  X(0003).
  1971     05  LCVBENEO PIC  ZZZZZZZZ.ZZ.
  1972*    -------------------------------
  1973     05  FILLER            PIC  X(0003).
  1974     05  LCVFORMO PIC  X(0012).
  1975*    -------------------------------
  1976     05  FILLER            PIC  X(0003).
  1977     05  LCVCNDTO PIC  X(0008).
  1978*    -------------------------------
  1979     05  FILLER            PIC  X(0003).
  1980     05  LCVEXITO PIC  X(0008).
  1981*    -------------------------------
  1982     05  FILLER            PIC  X(0003).
  1983     05  LCVSTATO PIC  X(0006).
  1984*    -------------------------------
  1985     05  FILLER            PIC  X(0003).
  1986     05  ACVDSCRO PIC  X(0006).
  1987*    -------------------------------
  1988     05  FILLER            PIC  X(0003).
  1989     05  ACVKINDO PIC  X(0003).
  1990*    -------------------------------
  1991     05  FILLER            PIC  X(0003).
  1992     05  ACVCDO PIC  X(0002).
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  38
* EL130.cbl
  1993*    -------------------------------
  1994     05  FILLER            PIC  X(0003).
  1995     05  ACVOTRMO PIC  999.
  1996*    -------------------------------
  1997     05  FILLER            PIC  X(0003).
  1998     05  ACVRTRMO PIC  ZZZ.
  1999*    -------------------------------
  2000     05  FILLER            PIC  X(0003).
  2001     05  ACVRATEO PIC  ZZZ.ZZ.
  2002*    -------------------------------
  2003     05  FILLER            PIC  X(0003).
  2004     05  ACVBENEO PIC  ZZZZZZZZ.ZZ.
  2005*    -------------------------------
  2006     05  FILLER            PIC  X(0003).
  2007     05  ACVFORMO PIC  X(0012).
  2008*    -------------------------------
  2009     05  FILLER            PIC  X(0003).
  2010     05  ACVCNDTO PIC  X(0008).
  2011*    -------------------------------
  2012     05  FILLER            PIC  X(0003).
  2013     05  ACVEXITO PIC  X(0008).
  2014*    -------------------------------
  2015     05  FILLER            PIC  X(0003).
  2016     05  ACVSTATO PIC  X(0006).
  2017*    -------------------------------
  2018     05  FILLER            PIC  X(0003).
  2019     05  ERRMSG1O PIC  X(0072).
  2020*    -------------------------------
  2021     05  FILLER            PIC  X(0003).
  2022     05  ERRMSG2O PIC  X(0072).
  2023*    -------------------------------
  2024     05  FILLER            PIC  X(0003).
  2025     05  BCERT1O PIC  X(0010).
  2026*    -------------------------------
  2027     05  FILLER            PIC  X(0003).
  2028     05  BSUFX1O PIC  X(0001).
  2029*    -------------------------------
  2030     05  FILLER            PIC  X(0003).
  2031     05  BCERT2O PIC  X(0010).
  2032*    -------------------------------
  2033     05  FILLER            PIC  X(0003).
  2034     05  BSUFX2O PIC  X(0001).
  2035*    -------------------------------
  2036     05  FILLER            PIC  X(0003).
  2037     05  BCERT3O PIC  X(0010).
  2038*    -------------------------------
  2039     05  FILLER            PIC  X(0003).
  2040     05  BSUFX3O PIC  X(0001).
  2041*    -------------------------------
  2042     05  FILLER            PIC  X(0003).
  2043     05  BCERT4O PIC  X(0010).
  2044*    -------------------------------
  2045     05  FILLER            PIC  X(0003).
  2046     05  BSUFX4O PIC  X(0001).
  2047*    -------------------------------
  2048     05  FILLER            PIC  X(0003).
  2049     05  BCERT5O PIC  X(0010).
  2050*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  39
* EL130.cbl
  2051     05  FILLER            PIC  X(0003).
  2052     05  BSUFX5O PIC  X(0001).
  2053*    -------------------------------
  2054     05  FILLER            PIC  X(0003).
  2055     05  ENTERPFO PIC  X(0002).
  2056*    -------------------------------
  2057     05  FILLER            PIC  X(0003).
  2058     05  PF5O PIC  X(0013).
  2059*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  40
* EL130.cbl
  2061*    COPY ELCDATE.
  2062******************************************************************
  2063*                                                                *
  2064*                                                                *
  2065*                            ELCDATE.                            *
  2066*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2067*                            VMOD=2.003
  2068*                                                                *
  2069*                                                                *
  2070*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  2071*                 LENGTH = 200                                   *
  2072******************************************************************
  2073
  2074 01  DATE-CONVERSION-DATA.
  2075     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  2076     12  DC-OPTION-CODE                PIC X.
  2077         88  BIN-TO-GREG                VALUE ' '.
  2078         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  2079         88  EDIT-GREG-TO-BIN           VALUE '2'.
  2080         88  YMD-GREG-TO-BIN            VALUE '3'.
  2081         88  MDY-GREG-TO-BIN            VALUE '4'.
  2082         88  JULIAN-TO-BIN              VALUE '5'.
  2083         88  BIN-PLUS-ELAPSED           VALUE '6'.
  2084         88  FIND-CENTURY               VALUE '7'.
  2085         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  2086         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  2087         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  2088         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  2089         88  JULIAN-TO-BIN-3            VALUE 'C'.
  2090         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  2091         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  2092         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  2093         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  2094         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  2095         88  CHECK-LEAP-YEAR            VALUE 'H'.
  2096         88  BIN-3-TO-GREG              VALUE 'I'.
  2097         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  2098         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  2099         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  2100         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  2101         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  2102         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  2103         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  2104         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  2105         88  THREE-CHARACTER-BIN
  2106                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  2107         88  GREGORIAN-TO-BIN
  2108                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  2109         88  BIN-TO-GREGORIAN
  2110                  VALUES ' ' '1' 'I' '8' 'G'.
  2111         88  JULIAN-TO-BINARY
  2112                  VALUES '5' 'C' 'E' 'F'.
  2113     12  DC-ERROR-CODE                 PIC X.
  2114         88  NO-CONVERSION-ERROR        VALUE ' '.
  2115         88  DATE-CONVERSION-ERROR
  2116                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  2117         88  DATE-IS-ZERO               VALUE '1'.
  2118         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  41
* EL130.cbl
  2119         88  DATE-IS-INVALID            VALUE '3'.
  2120         88  DATE1-GREATER-DATE2        VALUE '4'.
  2121         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  2122         88  DATE-INVALID-OPTION        VALUE '9'.
  2123         88  INVALID-CENTURY            VALUE 'A'.
  2124         88  ONLY-CENTURY               VALUE 'B'.
  2125         88  ONLY-LEAP-YEAR             VALUE 'C'.
  2126         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  2127     12  DC-END-OF-MONTH               PIC X.
  2128         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  2129     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  2130         88  USE-NORMAL-PROCESS         VALUE ' '.
  2131         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  2132         88  ADJUST-UP-100-YRS          VALUE '2'.
  2133     12  FILLER                        PIC X.
  2134     12  DC-CONVERSION-DATES.
  2135         16  DC-BIN-DATE-1             PIC XX.
  2136         16  DC-BIN-DATE-2             PIC XX.
  2137         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  2138         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  2139                       DC-GREG-DATE-1-EDIT.
  2140             20  DC-EDIT1-MONTH        PIC 99.
  2141             20  SLASH1-1              PIC X.
  2142             20  DC-EDIT1-DAY          PIC 99.
  2143             20  SLASH1-2              PIC X.
  2144             20  DC-EDIT1-YEAR         PIC 99.
  2145         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  2146         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  2147                     DC-GREG-DATE-2-EDIT.
  2148             20  DC-EDIT2-MONTH        PIC 99.
  2149             20  SLASH2-1              PIC X.
  2150             20  DC-EDIT2-DAY          PIC 99.
  2151             20  SLASH2-2              PIC X.
  2152             20  DC-EDIT2-YEAR         PIC 99.
  2153         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  2154         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  2155                     DC-GREG-DATE-1-YMD.
  2156             20  DC-YMD-YEAR           PIC 99.
  2157             20  DC-YMD-MONTH          PIC 99.
  2158             20  DC-YMD-DAY            PIC 99.
  2159         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  2160         16  DC-GREG-DATE-1-MDY-R REDEFINES
  2161                      DC-GREG-DATE-1-MDY.
  2162             20  DC-MDY-MONTH          PIC 99.
  2163             20  DC-MDY-DAY            PIC 99.
  2164             20  DC-MDY-YEAR           PIC 99.
  2165         16  DC-GREG-DATE-1-ALPHA.
  2166             20  DC-ALPHA-MONTH        PIC X(10).
  2167             20  DC-ALPHA-DAY          PIC 99.
  2168             20  FILLER                PIC XX.
  2169             20  DC-ALPHA-CENTURY.
  2170                 24 DC-ALPHA-CEN-N     PIC 99.
  2171             20  DC-ALPHA-YEAR         PIC 99.
  2172         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  2173         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  2174         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  2175         16  DC-JULIAN-DATE            PIC 9(05).
  2176         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  42
* EL130.cbl
  2177                                       PIC 9(05).
  2178         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  2179             20  DC-JULIAN-YEAR        PIC 99.
  2180             20  DC-JULIAN-DAYS        PIC 999.
  2181         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  2182         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  2183         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  2184     12  DATE-CONVERSION-VARIBLES.
  2185         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  2186         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  2187             20  FILLER                PIC 9(3).
  2188             20  HOLD-CEN-1-CCYY.
  2189                 24  HOLD-CEN-1-CC     PIC 99.
  2190                 24  HOLD-CEN-1-YY     PIC 99.
  2191             20  HOLD-CEN-1-MO         PIC 99.
  2192             20  HOLD-CEN-1-DA         PIC 99.
  2193         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  2194             20  HOLD-CEN-1-R-MO       PIC 99.
  2195             20  HOLD-CEN-1-R-DA       PIC 99.
  2196             20  HOLD-CEN-1-R-CCYY.
  2197                 24  HOLD-CEN-1-R-CC   PIC 99.
  2198                 24  HOLD-CEN-1-R-YY   PIC 99.
  2199             20  FILLER                PIC 9(3).
  2200         16  HOLD-CENTURY-1-X.
  2201             20  FILLER                PIC X(3)  VALUE SPACES.
  2202             20  HOLD-CEN-1-X-CCYY.
  2203                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  2204                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  2205             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  2206             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  2207         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  2208             20  HOLD-CEN-1-R-X-MO     PIC XX.
  2209             20  HOLD-CEN-1-R-X-DA     PIC XX.
  2210             20  HOLD-CEN-1-R-X-CCYY.
  2211                 24  HOLD-CEN-1-R-X-CC PIC XX.
  2212                 24  HOLD-CEN-1-R-X-YY PIC XX.
  2213             20  FILLER                PIC XXX.
  2214         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  2215         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  2216         16  DC-JULIAN-DATE-1          PIC 9(07).
  2217         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  2218             20  DC-JULIAN-1-CCYY.
  2219                 24  DC-JULIAN-1-CC    PIC 99.
  2220                 24  DC-JULIAN-1-YR    PIC 99.
  2221             20  DC-JULIAN-DA-1        PIC 999.
  2222         16  DC-JULIAN-DATE-2          PIC 9(07).
  2223         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  2224             20  DC-JULIAN-2-CCYY.
  2225                 24  DC-JULIAN-2-CC    PIC 99.
  2226                 24  DC-JULIAN-2-YR    PIC 99.
  2227             20  DC-JULIAN-DA-2        PIC 999.
  2228         16  DC-GREG-DATE-A-EDIT.
  2229             20  DC-EDITA-MONTH        PIC 99.
  2230             20  SLASHA-1              PIC X VALUE '/'.
  2231             20  DC-EDITA-DAY          PIC 99.
  2232             20  SLASHA-2              PIC X VALUE '/'.
  2233             20  DC-EDITA-CCYY.
  2234                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  43
* EL130.cbl
  2235                 24  DC-EDITA-YEAR     PIC 99.
  2236         16  DC-GREG-DATE-B-EDIT.
  2237             20  DC-EDITB-MONTH        PIC 99.
  2238             20  SLASHB-1              PIC X VALUE '/'.
  2239             20  DC-EDITB-DAY          PIC 99.
  2240             20  SLASHB-2              PIC X VALUE '/'.
  2241             20  DC-EDITB-CCYY.
  2242                 24  DC-EDITB-CENT     PIC 99.
  2243                 24  DC-EDITB-YEAR     PIC 99.
  2244         16  DC-GREG-DATE-CYMD         PIC 9(08).
  2245         16  DC-GREG-DATE-CYMD-R REDEFINES
  2246                              DC-GREG-DATE-CYMD.
  2247             20  DC-CYMD-CEN           PIC 99.
  2248             20  DC-CYMD-YEAR          PIC 99.
  2249             20  DC-CYMD-MONTH         PIC 99.
  2250             20  DC-CYMD-DAY           PIC 99.
  2251         16  DC-GREG-DATE-MDCY         PIC 9(08).
  2252         16  DC-GREG-DATE-MDCY-R REDEFINES
  2253                              DC-GREG-DATE-MDCY.
  2254             20  DC-MDCY-MONTH         PIC 99.
  2255             20  DC-MDCY-DAY           PIC 99.
  2256             20  DC-MDCY-CEN           PIC 99.
  2257             20  DC-MDCY-YEAR          PIC 99.
  2258    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  2259        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  2260    12  DC-EL310-DATE                  PIC X(21).
  2261    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  44
* EL130.cbl
  2263*    COPY ELCCALC.
  2264******************************************************************
  2265*                                                                *
  2266*                           ELCCALC.                            *
  2267*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2268*                            VMOD=2.025                          *
  2269*                                                                *
  2270*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  2271*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  2272*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  2273*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  2274*                                                                *
  2275*  PASSED TO ELRTRM                                              *
  2276*  -----------------                                             *
  2277*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  2278*  ORIGINAL TERM                                                 *
  2279*  BEGINNING DATE                                                *
  2280*  ENDING DATE                                                   *
  2281*  COMPANY I.D.                                                  *
  2282*  ACCOUNT MASTER USER FIELD                                     *
  2283*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  2284*  FREE LOOK DAYS                                                *
  2285*                                                                *
  2286*  RETURNED FROM ELRTRM                                          *
  2287*  ---------------------                                         *
  2288*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  2289*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  2290*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  2291*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  2292*----------------------------------------------------------------*
  2293*  PASSED TO ELRAMT                                              *
  2294*  ----------------                                              *
  2295*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  2296*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2297*  ORIGINAL AMOUNT                                               *
  2298*  ALTERNATE BENEFIT (BALLON)                                    *
  2299*  A.P.R. - NET PAY ONLY                                         *
  2300*  METHOD
  2301*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  2302*  COMPANY I.D.                                                  *
  2303*  BENEFIT TYPE                                                  *
  2304*                                                                *
  2305*  RETURNED FROM ELRAMT                                          *
  2306*  --------------------                                          *
  2307*  REMAINING AMOUNT 1 - CURRENT                                  *
  2308*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  2309*  REMAINING AMOUNT FACTOR
  2310*----------------------------------------------------------------*
  2311*  PASSED TO ELRESV                                              *
  2312*  -----------------                                             *
  2313*  CERTIFICATE EFFECTIVE DATE                                    *
  2314*  VALUATION DATE                                                *
  2315*  PAID THRU DATE                                                *
  2316*  BENEFIT                                                       *
  2317*  INCURRED DATE                                                 *
  2318*  REPORTED DATE                                                 *
  2319*  ISSUE AGE                                                     *
  2320*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  45
* EL130.cbl
  2321*  CDT PERCENT                                                   *
  2322*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  2323* *CLAIM TYPE (LIFE, A/H)                                        *
  2324* *REMAINING BENEFIT (FROM ELRAMT)                               *
  2325* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  2326*                                                                *
  2327*  RETURNED FROM ELRESV                                          *
  2328*  --------------------                                          *
  2329*  CDT TABLE USED                                                *
  2330*  CDT FACTOR USED                                               *
  2331*  PAY TO CURRENT RESERVE                                        *
  2332*  I.B.N.R. - A/H ONLY                                           *
  2333*  FUTURE (ACCRUED) AH ONLY                                      *
  2334*----------------------------------------------------------------*
  2335*  PASSED TO ELRATE                                              *
  2336*  ----------------                                              *
  2337*  CERT ISSUE DATE                                               *
  2338*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2339*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2340*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  2341*  STATE CODE (CLIENT DEFINED)                                   *
  2342*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2343*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2344*  DEVIATION CODE                                                *
  2345*  ISSUE AGE                                                     *
  2346*  ORIGINAL BENEFIT AMOUNT                                       *
  2347*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2348*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  2349*  BENEFIT KIND (LIFE OR A/H)                                    *
  2350*  A.P.R.                                                        *
  2351*  METHOD
  2352*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2353*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2354*  COMPANY I.D. (3 CHARACTER)                                    *
  2355*  BENEFIT CODE                                                  *
  2356*  BENEFIT OVERRIDE CODE                                         *
  2357*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  2358*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  2359*  JOINT INDICATOR (CSL ONLY)                                    *
  2360*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  2361*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  2362*                                                                *
  2363*  RETURNED FROM ELRATE                                          *
  2364*  --------------------                                          *
  2365*  CALCULATED PREMIUM                                            *
  2366*  PREMIUM RATE                                                  *
  2367*  MORTALITY CODE                                                *
  2368*  MAX ATTAINED AGE                                              *
  2369*  MAX AGE                                                       *
  2370*  MAX TERM                                                      *
  2371*  MAX MONTHLY BENEFIT                                           *
  2372*  MAX TOTAL BENIFIT                                             *
  2373*  COMPOSITE RATE (OPEN-END ONLY)                                *
  2374*----------------------------------------------------------------*
  2375*  PASSED TO ELRFND                                              *
  2376*  ----------------                                              *
  2377*  CERT ISSUE DATE                                               *
  2378*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  46
* EL130.cbl
  2379*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2380*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2381*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2382*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2383*  STATE CODE (CLIENT DEFINED)                                   *
  2384*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2385*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2386*  DEVIATION CODE                                                *
  2387*  ISSUE AGE                                                     *
  2388*  ORIGINAL BENEFIT AMOUNT                                       *
  2389*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2390*  PROCESS TYPE (CANCEL)                                         *
  2391*  BENEFIT KIND (LIFE OR A/H)                                    *
  2392*  A.P.R.                                                        *
  2393*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  2394*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  2395*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2396*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2397*  COMPANY I.D. (3 CHARACTER)                                    *
  2398*  BENEFIT CODE                                                  *
  2399*  BENEFIT OVERRIDE CODE                                         *
  2400*                                                                *
  2401*  RETURNED FROM ELRFND                                          *
  2402*  --------------------                                          *
  2403*  CALCULATED REFUND                                             *
  2404*----------------------------------------------------------------*
  2405*  PASSED TO ELEARN                                              *
  2406*  ----------------                                              *
  2407*  CERT ISSUE DATE                                               *
  2408*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2409*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2410*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2411*  STATE CODE (CLIENT DEFINED)                                   *
  2412*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2413*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2414*  DEVIATION CODE                                                *
  2415*  ISSUE AGE                                                     *
  2416*  ORIGINAL BENEFIT AMOUNT                                       *
  2417*  BENEFIT KIND (LIFE OR A/H)                                    *
  2418*  A.P.R.                                                        *
  2419*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  2420*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2421*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2422*  COMPANY I.D. (3 CHARACTER)                                    *
  2423*  BENEFIT CODE                                                  *
  2424*  BENEFIT OVERRIDE CODE                                         *
  2425*                                                                *
  2426*  RETURNED FROM ELEARN                                          *
  2427*  --------------------                                          *
  2428*  INDICATED  EARNINGS                                           *
  2429*----------------------------------------------------------------*
  2430*                 LENGTH = 450                                   *
  2431*                                                                *
  2432******************************************************************
  2433******************************************************************
  2434*                   C H A N G E   L O G
  2435*
  2436* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  47
* EL130.cbl
  2437*-----------------------------------------------------------------
  2438*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2439* EFFECTIVE    NUMBER
  2440*-----------------------------------------------------------------
  2441* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  2442* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2443* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  2444* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  2445* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  2446* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  2447* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  2448* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  2449* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2450******************************************************************
  2451
  2452 01  CALCULATION-PASS-AREA.
  2453     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  2454                                     COMP.
  2455
  2456     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  2457       88  NO-CP-ERROR                             VALUE ZERO.
  2458       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  2459                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  2460       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  2461       88  CP-ERROR-IN-DATES                       VALUE '2'.
  2462       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  2463       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  2464       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  2465       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  2466       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  2467       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  2468       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  2469       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  2470       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  2471       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  2472       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  2473       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  2474       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  2475       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  2476       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  2477
  2478     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  2479       88  NO-CP-ERROR-2                           VALUE ZERO.
  2480***********************  INPUT AREAS ****************************
  2481
  2482     12  CP-CALCULATION-AREA.
  2483         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  2484         16  CP-CERT-EFF-DT        PIC XX.
  2485         16  CP-VALUATION-DT       PIC XX.
  2486         16  CP-PAID-THRU-DT       PIC XX.
  2487         16  CP-BENEFIT-TYPE       PIC X.
  2488           88  CP-AH                               VALUE 'A' 'D'
  2489                                                   'I' 'U'.
  2490           88  CP-REDUCING-LIFE                    VALUE 'R'.
  2491           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  2492         16  CP-INCURRED-DT        PIC XX.
  2493         16  CP-REPORTED-DT        PIC XX.
  2494         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  48
* EL130.cbl
  2495         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  2496         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  2497                                     COMP-3.
  2498         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  2499                                     COMP-3.
  2500         16  CP-CDT-METHOD         PIC X.
  2501           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  2502           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  2503           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  2504         16  CP-CLAIM-TYPE         PIC X.
  2505           88  CP-AH-CLAIM                         VALUE 'A'.
  2506           88  CP-LIFE-CLAIM                       VALUE 'L'.
  2507         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  2508                                     COMP-3.
  2509         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  2510                                     COMP-3.
  2511         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  2512                                     COMP-3.
  2513         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  2514                                     COMP-3.
  2515         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2516                                     COMP-3.
  2517         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  2518                                     COMP-3.
  2519         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  2520                                     COMP-3.
  2521         16  CP-REM-TERM-METHOD    PIC X.
  2522           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  2523           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  2524           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  2525           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  2526           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  2527           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  2528           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  2529         16  CP-EARNING-METHOD     PIC X.
  2530           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  2531           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  2532           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  2533           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  2534           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  2535           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  2536           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  2537           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  2538           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  2539           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  2540           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  2541           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  2542           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  2543           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  2544         16  CP-PROCESS-TYPE       PIC X.
  2545           88  CP-CLAIM                            VALUE '1'.
  2546           88  CP-CANCEL                           VALUE '2'.
  2547           88  CP-ISSUE                            VALUE '3'.
  2548         16  CP-SPECIAL-CALC-CD    PIC X.
  2549           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  2550           88  CP-1-MTH-INTEREST               VALUE ' '.
  2551           88  CP-0-MTH-INTEREST               VALUE 'A'.
  2552           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  49
* EL130.cbl
  2553           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  2554           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  2555           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  2556           88  CP-FARM-PLAN                    VALUE 'F'.
  2557           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  2558           88  CP-2-MTH-INTEREST               VALUE 'I'.
  2559           88  CP-3-MTH-INTEREST               VALUE 'J'.
  2560           88  CP-4-MTH-INTEREST               VALUE 'K'.
  2561           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  2562           88  CP-MORTGAGE-REC                 VALUE 'M'.
  2563           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  2564           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  2565           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  2566           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  2567                                                     'W' 'X'.
  2568           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  2569           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  2570           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  2571           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  2572           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  2573           88  CP-SUMMARY-REC                  VALUE 'Z'.
  2574           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  2575           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  2576           88  CP-AD-D-BENEFIT                 VALUE '4'.
  2577           88  CP-CSL-METH-1                   VALUE '5'.
  2578           88  CP-CSL-METH-2                   VALUE '6'.
  2579           88  CP-CSL-METH-3                   VALUE '7'.
  2580           88  CP-CSL-METH-4                   VALUE '8'.
  2581
  2582         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  2583                                     COMP-3.
  2584         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  2585         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  2586         16  CP-STATE              PIC XX          VALUE SPACE.
  2587         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  2588         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  2589           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  2590               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  2591         16  CP-R78-OPTION         PIC X.
  2592           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  2593           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  2594
  2595         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  2596         16  CP-IBNR-RESERVE-SW    PIC X.
  2597         16  CP-CLAIM-STATUS       PIC X.
  2598         16  CP-RATE-FILE          PIC X.
  2599         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  2600                                     COMP-3.
  2601
  2602         16  CP-LIFE-OVERRIDE-CODE PIC X.
  2603         16  CP-AH-OVERRIDE-CODE   PIC X.
  2604
  2605         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  2606                                     COMP-3.
  2607         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  2608                                   PIC S9(5)V99 COMP-3.
  2609         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  2610                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  50
* EL130.cbl
  2611         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2612                                     COMP-3.
  2613         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  2614                                     COMP-3.
  2615         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  2616                                  PIC S9(7)V99 COMP-3.
  2617
  2618         16  CP-PAID-FROM-DATE     PIC X(02).
  2619         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  2620         16  CP-EXT-DAYS-CALC      PIC X.
  2621           88  CP-EXT-NO-CHG                   VALUE ' '.
  2622           88  CP-EXT-CHG-LF                   VALUE '1'.
  2623           88  CP-EXT-CHG-AH                   VALUE '2'.
  2624           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  2625         16  CP-DOMICILE-STATE     PIC XX.
  2626         16  CP-CARRIER            PIC X.
  2627         16  CP-REIN-FLAG          PIC X.
  2628         16  CP-REM-TRM-CALC-OPTION PIC X.
  2629           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  2630                      '2' '3' '4' '5'.
  2631           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  2632           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  2633           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  2634           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  2635           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  2636           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  2637           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  2638           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  2639         16  CP-SIG-SWITCH         PIC X.
  2640         16  CP-RATING-METHOD      PIC X.
  2641           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  2642           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  2643           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  2644           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  2645           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  2646           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  2647           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  2648           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  2649           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  2650         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  2651                                     COMP-3.
  2652         16  CP-BEN-CATEGORY       PIC X.
  2653         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2654         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  2655                                   PIC S99V9(5) COMP-3.
  2656         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2657         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  2658                                   PIC S99V9(5) COMP-3.
  2659         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  2660         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  2661         16  CP-EXPIRE-DT          PIC XX.
  2662         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  2663         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  2664         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  2665         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  2666         16  CP-DDF-SPEC-CALC      PIC X.
  2667             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  2668             88  CP-CALC-CLP              VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  51
* EL130.cbl
  2669         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  2670         16  CP-CANCEL-REASON      PIC X.
  2671         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  2672         16  CP-PMT-MODE           PIC X.
  2673         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  2674         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  2675         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  2676         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  2677         16  FILLER                PIC X.
  2678
  2679***************    OUTPUT FROM ELRESV   ************************
  2680
  2681         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  2682
  2683         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  2684                                     COMP-3.
  2685         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  2686                                     COMP-3.
  2687         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  2688                                     COMP-3.
  2689         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  2690                                     COMP-3.
  2691         16  FILLER                PIC X(09).
  2692***************    OUTPUT FROM ELRTRM   *************************
  2693
  2694         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  2695                                     COMP-3.
  2696         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  2697                                     COMP-3.
  2698         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  2699                                     COMP-3.
  2700         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  2701                                     COMP-3.
  2702         16  FILLER                PIC X(12).
  2703
  2704***************    OUTPUT FROM ELRAMT   *************************
  2705
  2706         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  2707                                     COMP-3.
  2708         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  2709                                     COMP-3.
  2710         16  FILLER                PIC X(12).
  2711
  2712***************    OUTPUT FROM ELRATE   *************************
  2713
  2714         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  2715                                     COMP-3.
  2716         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  2717                                     COMP-3.
  2718         16  CP-MORTALITY-CODE     PIC X(4).
  2719         16  CP-RATE-EDIT-FLAG     PIC X.
  2720             88  CP-RATES-NEED-APR                  VALUE '1'.
  2721         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  2722                                     COMP-3.
  2723         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  2724         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  2725         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  2726                                   PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  52
* EL130.cbl
  2727         16  FILLER                PIC X(07).
  2728
  2729***************    OUTPUT FROM ELRFND   *************************
  2730
  2731         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  2732                                     COMP-3.
  2733         16  CP-REFUND-TYPE-USED   PIC X.
  2734           88  CP-R-AS-R78                         VALUE '1'.
  2735           88  CP-R-AS-PRORATA                     VALUE '2'.
  2736           88  CP-R-AS-CALIF                       VALUE '3'.
  2737           88  CP-R-AS-TEXAS                       VALUE '4'.
  2738           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  2739           88  CP-R-AS-NET-PAY                     VALUE '5'.
  2740           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  2741           88  CP-R-AS-MEAN                        VALUE '8'.
  2742           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  2743           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  2744           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  2745           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  2746           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  2747           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  2748         16  FILLER                PIC X(12).
  2749
  2750***************    OUTPUT FROM ELEARN   *************************
  2751
  2752         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  2753                                     COMP-3.
  2754         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  2755                                     COMP-3.
  2756         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  2757                                     COMP-3.
  2758         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  2759                                     COMP-3.
  2760         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  2761                                     COMP-3.
  2762         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  2763                                     COMP-3.
  2764         16  CP-EARNING-TYPE-USED  PIC X.
  2765           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  2766           88  CP-E-AS-R78                         VALUE '1'.
  2767           88  CP-E-AS-PRORATA                     VALUE '2'.
  2768           88  CP-E-AS-TEXAS                       VALUE '4'.
  2769           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  2770           88  CP-E-AS-NET-PAY                     VALUE '5'.
  2771           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  2772           88  CP-E-AS-MEAN                        VALUE '8'.
  2773           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  2774         16  FILLER                PIC X(12).
  2775
  2776***************    OUTPUT FROM ELPMNT   *************************
  2777
  2778         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  2779                                     COMP-3.
  2780         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  2781                                     COMP-3.
  2782         16  FILLER                PIC X(12).
  2783
  2784***************   MISC WORK AREAS    *****************************
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  53
* EL130.cbl
  2785         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  2786                                     COMP-3.
  2787         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  2788                                     COMP-3.
  2789         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  2790                                     COMP-3.
  2791         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  2792                                     COMP-3.
  2793         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  2794                                     COMP-3.
  2795         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  2796                                     COMP-3.
  2797         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  2798             88  OPEN-RATE-FILE                   VALUE 'O'.
  2799             88  CLOSE-RATE-FILE                  VALUE 'C'.
  2800             88  IO-ERROR                         VALUE 'E'.
  2801
  2802         16  CP-FIRST-PAY-DATE     PIC XX.
  2803
  2804         16  CP-JOINT-INDICATOR    PIC X.
  2805
  2806         16  CP-RESERVE-REMAINING-TERM
  2807                                   PIC S9(4)V9    VALUE ZERO
  2808                                     COMP-3.
  2809
  2810         16  CP-INSURED-BIRTH-DT   PIC XX.
  2811
  2812         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  2813                                     COMP-3.
  2814
  2815         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  2816                                     COMP-3.
  2817
  2818         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  2819                                     COMP-3.
  2820
  2821         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  2822                                     COMP-3.
  2823
  2824         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  2825                                     COMP-3.
  2826
  2827         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  2828                                     COMP-3.
  2829
  2830         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  2831                                     COMP-3.
  2832
  2833         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  2834             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  2835
  2836         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  2837                                     COMP-3.
  2838         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  2839                                     COMP-3.
  2840         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  2841         16  FILLER                PIC X(15).
  2842******************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  54
* EL130.cbl
  2844*    COPY ELCLOGOF.
  2845******************************************************************
  2846*                                                                *
  2847*                                                                *
  2848*                            ELCLOGOF.                           *
  2849*                            VMOD=2.001                          *
  2850*                                                                *
  2851*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  2852*                                                                *
  2853******************************************************************
  2854 01  CLASIC-LOGOFF.
  2855     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  2856     12  LOGOFF-TEXT.
  2857         16  FILLER          PIC X(5)    VALUE SPACES.
  2858         16  LOGOFF-MSG.
  2859             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  2860             20  FILLER      PIC X       VALUE SPACES.
  2861             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  2862         16  FILLER          PIC X(80)
  2863           VALUE '* YOU ARE NOW LOGGED OFF'.
  2864         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  2865         16  FILLER          PIC X       VALUE QUOTE.
  2866         16  LOGOFF-SYS-MSG  PIC X(17)
  2867           VALUE 'S CLAS-IC SYSTEM '.
  2868     12  TEXT-MESSAGES.
  2869         16  UNACCESS-MSG    PIC X(29)
  2870             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  2871         16  PGMIDERR-MSG    PIC X(17)
  2872             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  55
* EL130.cbl
  2874*    COPY ELCATTR.
  2875******************************************************************
  2876*                                                                *
  2877*                            ELCATTR.                            *
  2878*                            VMOD=2.001                          *
  2879*                                                                *
  2880*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  2881*                                                                *
  2882*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  2883*                                                                *
  2884*                   POS 1   P=PROTECTED                          *
  2885*                           U=UNPROTECTED                        *
  2886*                           S=ASKIP                              *
  2887*                   POS 2   A=ALPHA/NUMERIC                      *
  2888*                           N=NUMERIC                            *
  2889*                   POS 3   N=NORMAL                             *
  2890*                           B=BRIGHT                             *
  2891*                           D=DARK                               *
  2892*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  2893*                           OF=MODIFIED DATA TAG OFF             *
  2894*                                                                *
  2895*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  2896******************************************************************
  2897 01  ATTRIBUTE-LIST.
  2898     12  AL-PABOF            PIC X       VALUE 'Y'.
  2899     12  AL-PABON            PIC X       VALUE 'Z'.
  2900     12  AL-PADOF            PIC X       VALUE '%'.
  2901     12  AL-PADON            PIC X       VALUE '_'.
  2902     12  AL-PANOF            PIC X       VALUE '-'.
  2903     12  AL-PANON            PIC X       VALUE '/'.
  2904     12  AL-SABOF            PIC X       VALUE '8'.
  2905     12  AL-SABON            PIC X       VALUE '9'.
  2906     12  AL-SADOF            PIC X       VALUE '@'.
  2907     12  AL-SADON            PIC X       VALUE QUOTE.
  2908     12  AL-SANOF            PIC X       VALUE '0'.
  2909     12  AL-SANON            PIC X       VALUE '1'.
  2910     12  AL-UABOF            PIC X       VALUE 'H'.
  2911     12  AL-UABON            PIC X       VALUE 'I'.
  2912     12  AL-UADOF            PIC X       VALUE '<'.
  2913     12  AL-UADON            PIC X       VALUE '('.
  2914     12  AL-UANOF            PIC X       VALUE ' '.
  2915     12  AL-UANON            PIC X       VALUE 'A'.
  2916     12  AL-UNBOF            PIC X       VALUE 'Q'.
  2917     12  AL-UNBON            PIC X       VALUE 'R'.
  2918     12  AL-UNDOF            PIC X       VALUE '*'.
  2919     12  AL-UNDON            PIC X       VALUE ')'.
  2920     12  AL-UNNOF            PIC X       VALUE '&'.
  2921     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  56
* EL130.cbl
  2923*    COPY ELCEMIB.
  2924******************************************************************
  2925*                                                                *
  2926*                                                                *
  2927*                            ELCEMIB.                            *
  2928*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2929*                            VMOD=2.005                          *
  2930*                                                                *
  2931*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  2932*                                                                *
  2933******************************************************************
  2934 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  2935     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  2936     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  2937     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  2938     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  2939     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  2940     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  2941     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  2942     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  2943     12  EMI-SWITCH1             PIC X        VALUE '1'.
  2944         88  EMI-NO-ERRORS                    VALUE '1'.
  2945         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  2946         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  2947     12  EMI-SWITCH2             PIC X        VALUE '1'.
  2948         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  2949     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  2950         88  EMI-AREA1-EMPTY                  VALUE '1'.
  2951         88  EMI-AREA1-FULL                   VALUE '2'.
  2952     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  2953         88  EMI-AREA2-EMPTY                  VALUE '1'.
  2954         88  EMI-AREA2-FULL                   VALUE '2'.
  2955     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  2956         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  2957         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  2958         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  2959         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  2960         88  EMI-BYPASS-FATALS                VALUE 'X'.
  2961     12  EMI-ERROR-LINES.
  2962         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  2963         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  2964         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  2965         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  2966             20  EMI-ERR-CODES OCCURS 10 TIMES.
  2967                 24  EMI-ERR-NUM         PIC X(4).
  2968                 24  EMI-FILLER          PIC X.
  2969                 24  EMI-SEV             PIC X.
  2970                 24  FILLER              PIC X.
  2971             20  FILLER                  PIC X(02).
  2972     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  2973         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  2974             20  EMI-ERROR-NUMBER    PIC X(4).
  2975             20  EMI-FILL            PIC X.
  2976             20  EMI-SEVERITY        PIC X.
  2977             20  FILLER              PIC X.
  2978             20  EMI-ERROR-TEXT.
  2979                 24  EMI-TEXT-VARIABLE   PIC X(10).
  2980                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  57
* EL130.cbl
  2981     12  EMI-SEVERITY-SAVE           PIC X.
  2982         88  EMI-NOTE                    VALUE 'N'.
  2983         88  EMI-WARNING                 VALUE 'W'.
  2984         88  EMI-FORCABLE                VALUE 'F'.
  2985         88  EMI-FATAL                   VALUE 'X'.
  2986     12  EMI-MESSAGE-FLAG            PIC X.
  2987         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  2988         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  2989     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  2990     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  2991         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  2992         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  2993         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  2994     12  emi-claim-no                pic x(7).
  2995     12  emi-claim-type              pic x(6).
  2996     12  FILLER                      PIC X(124)  VALUE SPACES.
  2997     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  2998     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  2999     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  3000     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  58
* EL130.cbl
  3002*    COPY ELCJPFX.
  3003******************************************************************
  3004*                                                                *
  3005*                                                                *
  3006*                            ELCJPFX.                            *
  3007*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3008*                            VMOD=2.002                          *
  3009*                                                                *
  3010*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  3011*                                                                *
  3012*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  3013*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  3014*        ELCNTL - CONTROL FILE                                   *
  3015*        ELMSTR - CLAIM MASTERS                                  *
  3016*        ELTRLR - ACTIVITY TRAILERS                              *
  3017*        ELCHKQ - CHECK QUE                                      *
  3018******************************************************************
  3019 01  JOURNAL-RECORD.
  3020     12  jp-date                     pic s9(5) comp-3.
  3021     12  jp-time                     pic s9(7) comp-3.
  3022     12  JP-USER-ID                  PIC X(4).
  3023     12  JP-FILE-ID                  PIC X(8).
  3024     12  JP-PROGRAM-ID               PIC X(8).
  3025     12  JP-RECORD-TYPE              PIC X.
  3026         88 JP-ADD              VALUE 'A'.
  3027         88 JP-BEFORE-CHANGE    VALUE 'B'.
  3028         88 JP-AFTER-CHANGE     VALUE 'C'.
  3029         88 JP-DELETE           VALUE 'D'.
  3030         88 JP-GENERIC-DELETE   VALUE 'G'.
  3031         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  3032         88 JP-KEY-CHG-ADD      VALUE 'N'.
  3033     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  3034     12  JP-RECORD-AREA
  3035
  3036
  3037         PIC X(512).
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  59
* EL130.cbl
  3039*    COPY ELCAID.
  3040******************************************************************
  3041*                                                                *
  3042*                            ELCAID.                             *
  3043*                            VMOD=2.001                          *
  3044*                                                                *
  3045*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  3046*                                                                *
  3047*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  3048*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  3049******************************************************************
  3050
  3051 01  DFHAID.
  3052   02  DFHNULL   PIC  X  VALUE  ' '.
  3053   02  DFHENTER  PIC  X  VALUE  QUOTE.
  3054   02  DFHCLEAR  PIC  X  VALUE  '_'.
  3055   02  DFHPEN    PIC  X  VALUE  '='.
  3056   02  DFHOPID   PIC  X  VALUE  'W'.
  3057   02  DFHPA1    PIC  X  VALUE  '%'.
  3058   02  DFHPA2    PIC  X  VALUE  '>'.
  3059   02  DFHPA3    PIC  X  VALUE  ','.
  3060   02  DFHPF1    PIC  X  VALUE  '1'.
  3061   02  DFHPF2    PIC  X  VALUE  '2'.
  3062   02  DFHPF3    PIC  X  VALUE  '3'.
  3063   02  DFHPF4    PIC  X  VALUE  '4'.
  3064   02  DFHPF5    PIC  X  VALUE  '5'.
  3065   02  DFHPF6    PIC  X  VALUE  '6'.
  3066   02  DFHPF7    PIC  X  VALUE  '7'.
  3067   02  DFHPF8    PIC  X  VALUE  '8'.
  3068   02  DFHPF9    PIC  X  VALUE  '9'.
  3069   02  DFHPF10   PIC  X  VALUE  ':'.
  3070   02  DFHPF11   PIC  X  VALUE  '#'.
  3071   02  DFHPF12   PIC  X  VALUE  '@'.
  3072   02  DFHPF13   PIC  X  VALUE  'A'.
  3073   02  DFHPF14   PIC  X  VALUE  'B'.
  3074   02  DFHPF15   PIC  X  VALUE  'C'.
  3075   02  DFHPF16   PIC  X  VALUE  'D'.
  3076   02  DFHPF17   PIC  X  VALUE  'E'.
  3077   02  DFHPF18   PIC  X  VALUE  'F'.
  3078   02  DFHPF19   PIC  X  VALUE  'G'.
  3079   02  DFHPF20   PIC  X  VALUE  'H'.
  3080   02  DFHPF21   PIC  X  VALUE  'I'.
  3081*00039    02  DFHPF22   PIC  X  VALUE  ''.
  3082   02  DFHPF22   PIC  X  VALUE  '['.
  3083   02  DFHPF23   PIC  X  VALUE  '.'.
  3084   02  DFHPF24   PIC  X  VALUE  '<'.
  3085   02  DFHMSRE   PIC  X  VALUE  'X'.
  3086   02  DFHSTRF   PIC  X  VALUE  'h'.
  3087   02  DFHTRIG   PIC  X  VALUE  '"'.
  3088
  3089 01  FILLER    REDEFINES DFHAID.
  3090     12  FILLER              PIC X(8).
  3091     12  PF-VALUES           PIC X       OCCURS 12.
  3092
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  60
* EL130.cbl
  3094****************************************************************
  3095*
  3096* Copyright (c) 2007 by Clerity Solutions, Inc.
  3097* All rights reserved.
  3098*
  3099****************************************************************
  3100 01  DFHEIV.
  3101   02  DFHEIV0               PIC X(35).
  3102   02  DFHEIV1               PIC X(08).
  3103   02  DFHEIV2               PIC X(08).
  3104   02  DFHEIV3               PIC X(08).
  3105   02  DFHEIV4               PIC X(06).
  3106   02  DFHEIV5               PIC X(04).
  3107   02  DFHEIV6               PIC X(04).
  3108   02  DFHEIV7               PIC X(02).
  3109   02  DFHEIV8               PIC X(02).
  3110   02  DFHEIV9               PIC X(01).
  3111   02  DFHEIV10              PIC S9(7) COMP-3.
  3112   02  DFHEIV11              PIC S9(4) COMP SYNC.
  3113   02  DFHEIV12              PIC S9(4) COMP SYNC.
  3114   02  DFHEIV13              PIC S9(4) COMP SYNC.
  3115   02  DFHEIV14              PIC S9(4) COMP SYNC.
  3116   02  DFHEIV15              PIC S9(4) COMP SYNC.
  3117   02  DFHEIV16              PIC S9(9) COMP SYNC.
  3118   02  DFHEIV17              PIC X(04).
  3119   02  DFHEIV18              PIC X(04).
  3120   02  DFHEIV19              PIC X(04).
  3121   02  DFHEIV20              USAGE IS POINTER.
  3122   02  DFHEIV21              USAGE IS POINTER.
  3123   02  DFHEIV22              USAGE IS POINTER.
  3124   02  DFHEIV23              USAGE IS POINTER.
  3125   02  DFHEIV24              USAGE IS POINTER.
  3126   02  DFHEIV25              PIC S9(9) COMP SYNC.
  3127   02  DFHEIV26              PIC S9(9) COMP SYNC.
  3128   02  DFHEIV27              PIC S9(9) COMP SYNC.
  3129   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3130   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3131   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3132   02  FILLER                PIC X(02).
  3133   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3134   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  3135   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3136   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3137   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3138 LINKAGE  SECTION.
  3139*****************************************************************
  3140*                                                               *
  3141* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  3142* All rights reserved.                                          *
  3143*                                                               *
  3144*****************************************************************
  3145 01  dfheiblk.
  3146     02  eibtime          pic s9(7) comp-3.
  3147     02  eibdate          pic s9(7) comp-3.
  3148     02  eibtrnid         pic x(4).
  3149     02  eibtaskn         pic s9(7) comp-3.
  3150     02  eibtrmid         pic x(4).
  3151     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  61
* EL130.cbl
  3152     02  eibcposn         pic s9(4) comp.
  3153     02  eibcalen         pic s9(4) comp.
  3154     02  eibaid           pic x(1).
  3155     02  eibfiller1       pic x(1).
  3156     02  eibfn            pic x(2).
  3157     02  eibfiller2       pic x(2).
  3158     02  eibrcode         pic x(6).
  3159     02  eibfiller3       pic x(2).
  3160     02  eibds            pic x(8).
  3161     02  eibreqid         pic x(8).
  3162     02  eibrsrce         pic x(8).
  3163     02  eibsync          pic x(1).
  3164     02  eibfree          pic x(1).
  3165     02  eibrecv          pic x(1).
  3166     02  eibsend          pic x(1).
  3167     02  eibatt           pic x(1).
  3168     02  eibeoc           pic x(1).
  3169     02  eibfmh           pic x(1).
  3170     02  eibcompl         pic x(1).
  3171     02  eibsig           pic x(1).
  3172     02  eibconf          pic x(1).
  3173     02  eiberr           pic x(1).
  3174     02  eibrldbk         pic x(1).
  3175     02  eiberrcd         pic x(4).
  3176     02  eibsynrb         pic x(1).
  3177     02  eibnodat         pic x(1).
  3178     02  eibfiller5       pic x(2).
  3179     02  eibresp          pic 9(09) comp.
  3180     02  eibresp2         pic 9(09) comp.
  3181     02  dfheigdj         pic s9(4) comp.
  3182     02  dfheigdk         pic s9(4) comp.
  3183
  3184 01  DFHCOMMAREA             PIC X(1024).
  3185
  3186*01 PARMLIST .
  3187*    02  FILLER              PIC S9(8)   COMP.
  3188*    02  ELMSTR-POINTER      PIC S9(8)   COMP.
  3189*    02  ELCNTL-POINTER      PIC S9(8)   COMP.
  3190*    02  ELCERT-POINTER      PIC S9(8)   COMP.
  3191*    02  ERACCT-POINTER      PIC S9(8)   COMP.
  3192*    02  ELTRLR-POINTER      PIC S9(8)   COMP.
  3193*    02  ELBENE-POINTER      PIC S9(8)   COMP.
  3194*    02  ELACTQ-POINTER      PIC S9(8)   COMP.
  3195*    02  ELARCH-POINTER      PIC S9(8)   COMP.
  3196*    02  ERREIN-POINTER      PIC S9(8)   COMP.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  62
* EL130.cbl
  3198*    COPY ELCMSTR.
  3199******************************************************************
  3200*                                                                *
  3201*                            ELCMSTR.                            *
  3202*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3203*                            VMOD=2.012                          *
  3204*                                                                *
  3205*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  3206*                                                                *
  3207*   FILE TYPE = VSAM,KSDS                                        *
  3208*   RECORD SIZE = 350  RECFORM = FIXED                           *
  3209*                                                                *
  3210*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  3211*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  3212*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  3213*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  3214*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  3215*                                                 RKP=75,LEN=21  *
  3216*                                                                *
  3217*   **** NOTE ****                                               *
  3218*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  3219*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  3220*                                                                *
  3221*   LOG = YES                                                    *
  3222*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3223******************************************************************
  3224*                   C H A N G E   L O G
  3225*
  3226* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3227*-----------------------------------------------------------------
  3228*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3229* EFFECTIVE    NUMBER
  3230*-----------------------------------------------------------------
  3231* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  3232* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  3233* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  3234******************************************************************
  3235 01  CLAIM-MASTER.
  3236     12  CL-RECORD-ID                PIC XX.
  3237         88  VALID-CL-ID         VALUE 'CL'.
  3238
  3239     12  CL-CONTROL-PRIMARY.
  3240         16  CL-COMPANY-CD           PIC X.
  3241         16  CL-CARRIER              PIC X.
  3242         16  CL-CLAIM-NO             PIC X(7).
  3243         16  CL-CERT-NO.
  3244             20  CL-CERT-PRIME       PIC X(10).
  3245             20  CL-CERT-SFX         PIC X.
  3246
  3247     12  CL-CONTROL-BY-NAME.
  3248         16  CL-COMPANY-CD-A1        PIC X.
  3249         16  CL-INSURED-LAST-NAME    PIC X(15).
  3250         16  CL-INSURED-NAME.
  3251             20  CL-INSURED-1ST-NAME PIC X(12).
  3252             20  CL-INSURED-MID-INIT PIC X.
  3253
  3254     12  CL-CONTROL-BY-SSN.
  3255         16  CL-COMPANY-CD-A2        PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  63
* EL130.cbl
  3256         16  CL-SOC-SEC-NO.
  3257             20  CL-SSN-STATE        PIC XX.
  3258             20  CL-SSN-ACCOUNT      PIC X(6).
  3259             20  CL-SSN-LN3          PIC X(3).
  3260
  3261     12  CL-CONTROL-BY-CERT-NO.
  3262         16  CL-COMPANY-CD-A4        PIC X.
  3263         16  CL-CERT-NO-A4.
  3264             20  CL-CERT-A4-PRIME    PIC X(10).
  3265             20  CL-CERT-A4-SFX      PIC X.
  3266
  3267     12  CL-CONTROL-BY-CCN.
  3268         16  CL-COMPANY-CD-A5        PIC X.
  3269         16  CL-CCN-A5.
  3270             20  CL-CCN.
  3271                 24  CL-CCN-PREFIX-A5 PIC X(4).
  3272                 24  CL-CCN-PRIME-A5 PIC X(12).
  3273             20  CL-CCN-FILLER-A5    PIC X(4).
  3274
  3275     12  CL-INSURED-PROFILE-DATA.
  3276         16  CL-INSURED-BIRTH-DT     PIC XX.
  3277         16  CL-INSURED-SEX-CD       PIC X.
  3278             88  INSURED-IS-MALE        VALUE 'M'.
  3279             88  INSURED-IS-FEMALE      VALUE 'F'.
  3280             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  3281         16  CL-INSURED-OCC-CD       PIC X(6).
  3282         16  FILLER                  PIC X(5).
  3283
  3284     12  CL-PROCESSING-INFO.
  3285         16  CL-PROCESSOR-ID         PIC X(4).
  3286         16  CL-CLAIM-STATUS         PIC X.
  3287             88  CLAIM-IS-OPEN          VALUE 'O'.
  3288             88  CLAIM-IS-CLOSED        VALUE 'C'.
  3289         16  CL-CLAIM-TYPE           PIC X.
  3290*            88  AH-CLAIM               VALUE 'A'.
  3291*            88  LIFE-CLAIM             VALUE 'L'.
  3292*            88  PROPERTY-CLAIM         VALUE 'P'.
  3293*            88  IUI-CLAIM              VALUE 'I'.
  3294*            88  GAP-CLAIM              VALUE 'G'.
  3295         16  CL-CLAIM-PREM-TYPE      PIC X.
  3296             88  SINGLE-PREMIUM         VALUE '1'.
  3297             88  O-B-COVERAGE           VALUE '2'.
  3298             88  OPEN-END-COVERAGE      VALUE '3'.
  3299         16  CL-INCURRED-DT          PIC XX.
  3300         16  CL-REPORTED-DT          PIC XX.
  3301         16  CL-FILE-ESTABLISH-DT    PIC XX.
  3302         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  3303         16  CL-LAST-PMT-DT          PIC XX.
  3304         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  3305         16  CL-PAID-THRU-DT         PIC XX.
  3306         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  3307         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  3308         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  3309         16  CL-PMT-CALC-METHOD      PIC X.
  3310             88  CL-360-DAY-YR          VALUE '1'.
  3311             88  CL-365-DAY-YR          VALUE '2'.
  3312             88  CL-FULL-MONTHS         VALUE '3'.
  3313         16  CL-CAUSE-CD             PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  64
* EL130.cbl
  3314
  3315         16  CL-PRIME-CERT-NO.
  3316             20  CL-PRIME-CERT-PRIME PIC X(10).
  3317             20  CL-PRIME-CERT-SFX   PIC X.
  3318
  3319         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  3320             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  3321             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  3322
  3323         16  CL-MICROFILM-NO         PIC X(10).
  3324         16  CL-PROG-FORM-TYPE       PIC X.
  3325         16  CL-LAST-ADD-ON-DT       PIC XX.
  3326
  3327         16  CL-LAST-REOPEN-DT       PIC XX.
  3328         16  CL-LAST-CLOSE-DT        PIC XX.
  3329         16  CL-LAST-CLOSE-REASON    PIC X(01).
  3330             88  FINAL-PAID             VALUE '1'.
  3331             88  CLAIM-DENIED           VALUE '2'.
  3332             88  AUTO-CLOSE             VALUE '3'.
  3333             88  MANUAL-CLOSE           VALUE '4'.
  3334             88  BENEFITS-CHANGED       VALUE 'C'.
  3335             88  SETUP-ERRORS           VALUE 'E'.
  3336         16  CL-ASSOC-CERT-SEQU      PIC S99.
  3337         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  3338         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  3339             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  3340         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  3341         16  FILLER                  PIC X.
  3342
  3343     12  CL-CERTIFICATE-DATA.
  3344         16  CL-CERT-ORIGIN          PIC X.
  3345             88  CERT-WAS-ONLINE        VALUE '1'.
  3346             88  CERT-WAS-CREATED       VALUE '2'.
  3347             88  COVERAGE-WAS-ADDED     VALUE '3'.
  3348         16  CL-CERT-KEY-DATA.
  3349             20  CL-CERT-CARRIER     PIC X.
  3350             20  CL-CERT-GROUPING    PIC X(6).
  3351             20  CL-CERT-STATE       PIC XX.
  3352             20  CL-CERT-ACCOUNT.
  3353                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  3354                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  3355             20  CL-CERT-EFF-DT      PIC XX.
  3356
  3357     12  CL-STATUS-CONTROLS.
  3358         16  CL-PRIORITY-CD          PIC X.
  3359             88  CONFIDENTIAL-DATA      VALUE '8'.
  3360             88  HIGHEST-PRIORITY       VALUE '9'.
  3361         16  CL-SUPV-ATTN-CD         PIC X.
  3362             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  3363             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  3364         16  CL-PURGED-DT            PIC XX.
  3365         16  CL-RESTORED-DT          PIC XX.
  3366         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  3367         16  CL-NEXT-RESEND-DT       PIC XX.
  3368         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  3369         16  CL-CRITICAL-PERIOD      PIC 99.
  3370*        16  FILLER                  PIC XX.
  3371         16  CL-LAST-MAINT-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  65
* EL130.cbl
  3372         16  CL-LAST-MAINT-USER      PIC X(4).
  3373         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  3374         16  CL-LAST-MAINT-TYPE      PIC X.
  3375             88  CLAIM-SET-UP           VALUE ' '.
  3376             88  PAYMENT-MADE           VALUE '1'.
  3377             88  LETTER-SENT            VALUE '2'.
  3378             88  MASTER-WAS-ALTERED     VALUE '3'.
  3379             88  MASTER-WAS-RESTORED    VALUE '4'.
  3380             88  INCURRED-DATE-CHANGED  VALUE '5'.
  3381             88  FILE-CONVERTED         VALUE '6'.
  3382             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  3383             88  ERROR-CORRECTION       VALUE 'E'.
  3384         16  CL-RELATED-CLAIM-NO     PIC X(7).
  3385         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  3386         16  CL-BENEFICIARY          PIC X(10).
  3387         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  3388         16  CL-DENIAL-TYPE          PIC X.
  3389             88  CL-TYPE-DENIAL          VALUE '1'.
  3390             88  CL-TYPE-RESCISSION      VALUE '2'.
  3391             88  CL-TYPE-REFORMATION     VALUE '3'.
  3392             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  3393             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  3394         16  CL-CRIT-PER-RECURRENT   PIC X.
  3395         16  CL-CRIT-PER-RTW-MOS     PIC 99.
  3396         16  CL-RTW-DT               PIC XX.
  3397
  3398     12  CL-TRAILER-CONTROLS.
  3399         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  3400             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  3401             88  CL-LAST-TRL-AVAIL      VALUE +100.
  3402             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  3403         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  3404         16  FILLER                  PIC XX.
  3405         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  3406         16  CL-ADDRESS-TRAILER-CNT.
  3407             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  3408                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  3409             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  3410                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  3411             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  3412                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  3413             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  3414                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  3415             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  3416                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  3417             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  3418                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  3419             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  3420                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  3421
  3422     12  CL-CV-REFERENCE-NO.
  3423         16  CL-CV-REFNO-PRIME       PIC X(18).
  3424         16  CL-CV-REFNO-SFX         PIC XX.
  3425
  3426     12  CL-FILE-LOCATION            PIC X(4).
  3427
  3428     12  CL-PROCESS-ERRORS.
  3429         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  66
* EL130.cbl
  3430             88  NO-FATAL-ERRORS        VALUE ZERO.
  3431         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  3432             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  3433
  3434     12  CL-PRODUCT-CD               PIC X.
  3435
  3436     12  CL-CURRENT-KEY-DATA.
  3437         16  CL-CURRENT-CARRIER      PIC X.
  3438         16  CL-CURRENT-GROUPING     PIC X(6).
  3439         16  CL-CURRENT-STATE        PIC XX.
  3440         16  CL-CURRENT-ACCOUNT      PIC X(10).
  3441
  3442     12  CL-ASSOCIATES               PIC X.
  3443         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  3444         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  3445         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  3446         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  3447
  3448     12  CL-ACTIVITY-CODE            PIC 99.
  3449     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  3450     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  3451
  3452     12  CL-LAPSE-REPORT-CODE        PIC 9.
  3453     12  CL-LAG-REPORT-CODE          PIC 9.
  3454     12  CL-LOAN-TYPE                PIC XX.
  3455     12  CL-LEGAL-STATE              PIC XX.
  3456
  3457     12  CL-YESNOSW                  PIC X.
  3458     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  3459         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  3460         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  3461         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  3462     12  cl-insured-claim            pic x.
  3463         88  cl-claim-on-primary         value 'P'.
  3464         88  cl-claim-on-secondary       value 'S'.
  3465     12  cl-benefit-expiration-dt    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  67
* EL130.cbl
  3467*    COPY ELCCNTL.
  3468******************************************************************
  3469*                                                                *
  3470*                                                                *
  3471*                            ELCCNTL.                            *
  3472*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3473*                            VMOD=2.059                          *
  3474*                                                                *
  3475*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  3476*                                                                *
  3477*   FILE TYPE = VSAM,KSDS                                        *
  3478*   RECORD SIZE = 750  RECFORM = FIXED                           *
  3479*                                                                *
  3480*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  3481*       ALTERNATE INDEX = NONE                                   *
  3482*                                                                *
  3483*   LOG = YES                                                    *
  3484*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3485******************************************************************
  3486*                   C H A N G E   L O G
  3487*
  3488* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3489*-----------------------------------------------------------------
  3490*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3491* EFFECTIVE    NUMBER
  3492*-----------------------------------------------------------------
  3493* 082503                   PEMA  ADD BENEFIT GROUP
  3494* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3495* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3496* 092705    2005050300006  PEMA  ADD SPP LEASES
  3497* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  3498* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  3499* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  3500* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  3501* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  3502* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  3503* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  3504* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  3505* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  3506******************************************************************
  3507*
  3508 01  CONTROL-FILE.
  3509     12  CF-RECORD-ID                       PIC XX.
  3510         88  VALID-CF-ID                        VALUE 'CF'.
  3511
  3512     12  CF-CONTROL-PRIMARY.
  3513         16  CF-COMPANY-ID                  PIC XXX.
  3514         16  CF-RECORD-TYPE                 PIC X.
  3515             88  CF-COMPANY-MASTER              VALUE '1'.
  3516             88  CF-PROCESSOR-MASTER            VALUE '2'.
  3517             88  CF-STATE-MASTER                VALUE '3'.
  3518             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  3519             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  3520             88  CF-CARRIER-MASTER              VALUE '6'.
  3521             88  CF-MORTALITY-MASTER            VALUE '7'.
  3522             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  3523             88  CF-TERMINAL-MASTER             VALUE '9'.
  3524             88  CF-AH-EDIT-MASTER              VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  68
* EL130.cbl
  3525             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  3526             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  3527             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  3528             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  3529             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  3530             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  3531             88  CF-REMINDERS-MASTER            VALUE 'R'.
  3532             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  3533         16  CF-ACCESS-CD-GENL              PIC X(4).
  3534         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  3535             20  CF-PROCESSOR               PIC X(4).
  3536         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  3537             20  CF-STATE-CODE              PIC XX.
  3538             20  FILLER                     PIC XX.
  3539         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  3540             20  FILLER                     PIC XX.
  3541             20  CF-HI-BEN-IN-REC           PIC XX.
  3542         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  3543             20  FILLER                     PIC XXX.
  3544             20  CF-CARRIER-CNTL            PIC X.
  3545         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  3546             20  FILLER                     PIC XX.
  3547             20  CF-HI-TYPE-IN-REC          PIC 99.
  3548         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  3549             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  3550                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  3551             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  3552             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  3553         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  3554             20  FILLER                     PIC X.
  3555             20  CF-CUSTOM-REPORT-NO        PIC 999.
  3556         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  3557             20  FILLER                     PIC XX.
  3558             20  CF-MORTGAGE-PLAN           PIC XX.
  3559         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  3560
  3561     12  CF-LAST-MAINT-DT                   PIC XX.
  3562     12  CF-LAST-MAINT-BY                   PIC X(4).
  3563     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  3564
  3565     12  CF-RECORD-BODY                     PIC X(728).
  3566
  3567
  3568****************************************************************
  3569*             COMPANY MASTER RECORD                            *
  3570****************************************************************
  3571
  3572     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3573         16  CF-COMPANY-ADDRESS.
  3574             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  3575             20  CF-CL-IN-CARE-OF           PIC X(30).
  3576             20  CF-CL-ADDR-LINE-1          PIC X(30).
  3577             20  CF-CL-ADDR-LINE-2          PIC X(30).
  3578             20  CF-CL-CITY-STATE           PIC X(30).
  3579             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  3580             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  3581         16  CF-COMPANY-CD                  PIC X.
  3582         16  CF-COMPANY-PASSWORD            PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  69
* EL130.cbl
  3583         16  CF-SECURITY-OPTION             PIC X.
  3584             88  ALL-SECURITY                   VALUE '1'.
  3585             88  COMPANY-VERIFY                 VALUE '2'.
  3586             88  PROCESSOR-VERIFY               VALUE '3'.
  3587             88  NO-SECURITY                    VALUE '4'.
  3588             88  ALL-BUT-TERM                   VALUE '5'.
  3589         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  3590             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  3591         16  CF-LGX-INTERFACE-CNTL          PIC X.
  3592             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  3593         16  CF-INFORCE-LOCATION            PIC X.
  3594             88  CERTS-ARE-ONLINE               VALUE '1'.
  3595             88  CERTS-ARE-OFFLINE              VALUE '2'.
  3596             88  NO-CERTS-AVAILABLE             VALUE '3'.
  3597         16  CF-LOWER-CASE-LETTERS          PIC X.
  3598         16  CF-CERT-ACCESS-CONTROL         PIC X.
  3599             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  3600             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  3601             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  3602             88  CF-ACCNT-CNTL                  VALUE '3'.
  3603             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  3604
  3605         16  CF-FORMS-PRINTER-ID            PIC X(4).
  3606         16  CF-CHECK-PRINTER-ID            PIC X(4).
  3607
  3608         16  CF-LGX-CREDIT-USER             PIC X.
  3609             88  CO-IS-NOT-USER                 VALUE 'N'.
  3610             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  3611
  3612         16 CF-CREDIT-CALC-CODES.
  3613             20  CF-CR-REM-TERM-CALC PIC X.
  3614               88  CR-EARN-AFTER-15TH           VALUE '1'.
  3615               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  3616               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  3617               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  3618               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  3619               88  CR-EARN-AFTER-14TH           VALUE '6'.
  3620               88  CR-EARN-AFTER-16TH           VALUE '7'.
  3621             20  CF-CR-R78-METHOD           PIC X.
  3622               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  3623               88  DONT-USE-PLUS-ONE            VALUE '1'.
  3624
  3625         16  CF-CLAIM-CONTROL-COUNTS.
  3626             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  3627                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  3628
  3629             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  3630                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  3631
  3632             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  3633                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  3634
  3635             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  3636                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  3637
  3638         16  CF-CURRENT-MONTH-END           PIC XX.
  3639
  3640         16  CF-CO-CALC-QUOTE-TOLERANCE.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  70
* EL130.cbl
  3641             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  3642             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  3643             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  3644             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  3645                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3646                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3647             20  CF-CO-PREM-REJECT-SW       PIC X.
  3648                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  3649                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  3650             20  CF-CO-REF-REJECT-SW        PIC X.
  3651                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  3652                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  3653
  3654         16  CF-CO-REPORTING-DT             PIC XX.
  3655         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  3656         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  3657           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  3658           88  CF-CO-MONTH-END                  VALUE '1'.
  3659
  3660         16  CF-LGX-CLAIM-USER              PIC X.
  3661             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  3662             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  3663
  3664         16  CF-CREDIT-EDIT-CONTROLS.
  3665             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  3666             20  CF-MIN-AGE                 PIC 99.
  3667             20  CF-DEFAULT-AGE             PIC 99.
  3668             20  CF-MIN-TERM                PIC S999      COMP-3.
  3669             20  CF-MAX-TERM                PIC S999      COMP-3.
  3670             20  CF-DEFAULT-SEX             PIC X.
  3671             20  CF-JOINT-AGE-INPUT         PIC X.
  3672                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  3673             20  CF-BIRTH-DATE-INPUT        PIC X.
  3674                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  3675             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  3676                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  3677                 88  CF-ZERO-CARRIER            VALUE '1'.
  3678                 88  CF-ZERO-GROUPING           VALUE '2'.
  3679                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  3680             20  CF-EDIT-SW                 PIC X.
  3681                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  3682             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  3683             20  CF-CR-PR-METHOD            PIC X.
  3684               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  3685               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  3686             20  FILLER                     PIC X.
  3687
  3688         16  CF-CREDIT-MISC-CONTROLS.
  3689             20  CF-REIN-TABLE-SW           PIC X.
  3690                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  3691             20  CF-COMP-TABLE-SW           PIC X.
  3692                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  3693             20  CF-EXPERIENCE-RETENTION-AGE
  3694                                            PIC S9        COMP-3.
  3695             20  CF-CONVERSION-DT           PIC XX.
  3696             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  3697             20  CF-RUN-FREQUENCY-SW        PIC X.
  3698                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  71
* EL130.cbl
  3699                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  3700
  3701             20  CF-CR-CHECK-NO-CONTROL.
  3702                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  3703                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  3704                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  3705                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  3706                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  3707                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  3708
  3709                 24  CF-CR-CHECK-COUNT       REDEFINES
  3710                     CF-CR-CHECK-COUNTER      PIC X(4).
  3711
  3712                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  3713                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  3714
  3715                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  3716                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  3717                 24  CF-MAIL-PROCESSING       PIC X.
  3718                     88  MAIL-PROCESSING          VALUE 'Y'.
  3719
  3720         16  CF-MISC-SYSTEM-CONTROL.
  3721             20  CF-SYSTEM-C                 PIC X.
  3722                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  3723             20  CF-SYSTEM-D                 PIC X.
  3724                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  3725             20  CF-SOC-SEC-NO-SW            PIC X.
  3726                 88  SOC-SEC-NO-USED             VALUE '1'.
  3727             20  CF-MEMBER-NO-SW             PIC X.
  3728                 88  MEMBER-NO-USED              VALUE '1'.
  3729             20  CF-TAX-ID-NUMBER            PIC X(11).
  3730             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  3731             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  3732                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  3733                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  3734                 88  CF-ALL-APPROVED             VALUE 'Y'.
  3735                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  3736             20  CF-SYSTEM-E                 PIC X.
  3737                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  3738
  3739         16  CF-LGX-LIFE-USER               PIC X.
  3740             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  3741             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  3742
  3743         16  CF-CR-MONTH-END-DT             PIC XX.
  3744
  3745         16  CF-FILE-MAINT-DATES.
  3746             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  3747                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  3748             20  CF-LAST-BATCH       REDEFINES
  3749                 CF-LAST-BATCH-NO               PIC X(4).
  3750             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  3751             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  3752             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  3753             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  3754             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  3755             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  3756             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  72
* EL130.cbl
  3757             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  3758             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  3759             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  3760
  3761         16  CF-NEXT-COMPANY-ID             PIC XXX.
  3762         16  FILLER                         PIC X.
  3763
  3764         16  CF-ALT-MORT-CODE               PIC X(4).
  3765         16  CF-MEMBER-CAPTION              PIC X(10).
  3766
  3767         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  3768             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  3769             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  3770             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  3771             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  3772             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  3773
  3774         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  3775
  3776         16  CF-LIFE-OVERRIDE-L1            PIC X.
  3777         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  3778         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  3779         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  3780
  3781         16  CF-AH-OVERRIDE-L1              PIC X.
  3782         16  CF-AH-OVERRIDE-L2              PIC XX.
  3783         16  CF-AH-OVERRIDE-L6              PIC X(6).
  3784         16  CF-AH-OVERRIDE-L12             PIC X(12).
  3785
  3786         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  3787         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  3788
  3789         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  3790         16  CF-AR-LAST-EL860-DT            PIC XX.
  3791         16  CF-MP-MONTH-END-DT             PIC XX.
  3792
  3793         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  3794         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  3795             88  CF-CLAIM-PAID-TO               VALUE '1'.
  3796
  3797         16  CF-AR-MONTH-END-DT             PIC XX.
  3798
  3799         16  CF-CRDTCRD-USER                PIC X.
  3800             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  3801             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  3802
  3803         16  CF-CC-MONTH-END-DT             PIC XX.
  3804
  3805         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  3806
  3807         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  3808             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  3809             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  3810             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  3811         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  3812         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  3813         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  3814         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  73
* EL130.cbl
  3815             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  3816             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  3817         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  3818         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  3819         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  3820             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  3821         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  3822
  3823         16  CF-CL-ZIP-CODE.
  3824             20  CF-CL-ZIP-PRIME.
  3825                 24  CF-CL-ZIP-1ST          PIC X.
  3826                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  3827                 24  FILLER                 PIC X(4).
  3828             20  CF-CL-ZIP-PLUS4            PIC X(4).
  3829         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  3830             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  3831             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  3832             20  FILLER                     PIC XXX.
  3833
  3834         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  3835         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  3836         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  3837         16  CF-CO-OPTION-START-DATE        PIC XX.
  3838         16  CF-REM-TRM-CALC-OPTION         PIC X.
  3839           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  3840                                                      '3' '4'.
  3841           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  3842           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  3843           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  3844           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  3845           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  3846           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  3847
  3848         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  3849
  3850         16  CF-PAYMENT-APPROVAL-LEVELS.
  3851             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  3852             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  3853             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  3854             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  3855             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  3856             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  3857
  3858         16  CF-END-USER-REPORTING-USER     PIC X.
  3859             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  3860             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  3861
  3862         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  3863             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  3864             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  3865
  3866         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  3867
  3868         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  3869         16  FILLER                         PIC X.
  3870
  3871         16  CF-CREDIT-ARCHIVE-CNTL.
  3872             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  74
* EL130.cbl
  3873             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  3874             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  3875
  3876         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  3877
  3878         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  3879             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  3880             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  3881
  3882         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  3883             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  3884             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  3885
  3886         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  3887
  3888         16  CF-CO-ACH-ID-CODE              PIC  X.
  3889             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  3890             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  3891             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  3892         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  3893         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  3894         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  3895         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  3896         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  3897         16  CF-CO-ACH-RECV-NO              PIC X(08).
  3898         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  3899         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  3900         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  3901                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  3902         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  3903                 CF-CO-ACH-TRACE-NO         PIC X(4).
  3904
  3905         16  CF-CO-OVER-SHORT.
  3906             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3907             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3908
  3909*         16  FILLER                         PIC X(102).
  3910         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  3911             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  3912             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  3913
  3914         16  CF-AH-APPROVAL-DAYS.
  3915             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  3916             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  3917             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  3918             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  3919
  3920         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  3921
  3922         16  CF-APPROV-LEV-5.
  3923             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  3924             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  3925             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  3926
  3927         16  FILLER                         PIC X(68).
  3928****************************************************************
  3929*             PROCESSOR/USER RECORD                            *
  3930****************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  75
* EL130.cbl
  3931
  3932     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3933         16  CF-PROCESSOR-NAME              PIC X(30).
  3934         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  3935         16  CF-PROCESSOR-TITLE             PIC X(26).
  3936         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  3937                 88  MESSAGE-YES                VALUE 'Y'.
  3938                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  3939
  3940*****************************************************
  3941****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  3942****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  3943****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  3944****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  3945*****************************************************
  3946
  3947         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  3948             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  3949             20  CF-APPLICATION-FORCE       PIC X.
  3950             20  CF-INDIVIDUAL-APP.
  3951                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  3952                     28  CF-BROWSE-APP      PIC X.
  3953                     28  CF-UPDATE-APP      PIC X.
  3954
  3955         16  CF-CURRENT-TERM-ON             PIC X(4).
  3956         16  CF-PROCESSOR-LIMITS-CLAIMS.
  3957             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  3958             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  3959             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  3960             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  3961             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  3962             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  3963             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  3964         16  CF-PROCESSOR-CARRIER           PIC X.
  3965             88  NO-CARRIER-SECURITY            VALUE ' '.
  3966         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  3967             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  3968         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  3969             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  3970         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  3971             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  3972
  3973         16  CF-PROC-SYS-ACCESS-SW.
  3974             20  CF-PROC-CREDIT-CLAIMS-SW.
  3975                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  3976                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  3977                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  3978                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  3979             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  3980                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  3981                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  3982             20  CF-PROC-LIFE-GNRLDGR-SW.
  3983                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  3984                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  3985                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  3986                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  3987             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  3988                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  76
* EL130.cbl
  3989                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  3990         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  3991             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  3992             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  3993         16  CF-PROCESSOR-PRINTER               PIC X(4).
  3994
  3995         16  CF-APPROVAL-LEVEL                  PIC X.
  3996             88  APPROVAL-LEVEL-1                   VALUE '1'.
  3997             88  APPROVAL-LEVEL-2                   VALUE '2'.
  3998             88  APPROVAL-LEVEL-3                   VALUE '3'.
  3999             88  APPROVAL-LEVEL-4                   VALUE '4'.
  4000             88  APPROVAL-LEVEL-5                   VALUE '5'.
  4001
  4002         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  4003
  4004         16  CF-LANGUAGE-TYPE                   PIC X.
  4005             88  CF-LANG-IS-ENG                     VALUE 'E'.
  4006             88  CF-LANG-IS-FR                      VALUE 'F'.
  4007
  4008         16  CF-CSR-IND                         PIC X.
  4009         16  FILLER                             PIC X(239).
  4010
  4011****************************************************************
  4012*             PROCESSOR/REMINDERS RECORD                       *
  4013****************************************************************
  4014
  4015     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  4016         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  4017             20  CF-START-REMIND-DT         PIC XX.
  4018             20  CF-END-REMIND-DT           PIC XX.
  4019             20  CF-REMINDER-TEXT           PIC X(50).
  4020         16  FILLER                         PIC X(296).
  4021
  4022
  4023****************************************************************
  4024*             STATE MASTER RECORD                              *
  4025****************************************************************
  4026
  4027     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4028         16  CF-STATE-ABBREVIATION          PIC XX.
  4029         16  CF-STATE-NAME                  PIC X(25).
  4030         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  4031         16  CF-ST-CALC-QUOTE-TOLERANCE.
  4032             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  4033             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  4034             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  4035             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  4036                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4037                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4038             20  CF-ST-PREM-REJECT-SW       PIC X.
  4039                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  4040                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  4041             20  CF-ST-REF-REJECT-SW        PIC X.
  4042                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  4043                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  4044         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  4045         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  4046         16  CF-ST-REFUND-RULES.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  77
* EL130.cbl
  4047             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  4048             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  4049             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  4050         16  CF-ST-FST-PMT-EXTENSION.
  4051             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  4052             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  4053                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  4054                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  4055                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  4056                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  4057         16  CF-ST-STATE-CALL.
  4058             20  CF-ST-CALL-UNEARNED        PIC X.
  4059             20  CF-ST-CALL-RPT-CNTL        PIC X.
  4060             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  4061         16  CF-REPLACEMENT-LAW-SW          PIC X.
  4062             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  4063             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  4064         16  CF-REPLACEMENT-LETTER          PIC X(4).
  4065         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  4066         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  4067         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  4068         16  CF-ST-SPLIT-PAYMENT            PIC X.
  4069         16  FILLER                         PIC X.
  4070         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  4071             20  CF-ST-BENEFIT-CD           PIC XX.
  4072             20  CF-ST-BENEFIT-KIND         PIC X.
  4073                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  4074                 88  CF-ST-AH-KIND              VALUE 'A'.
  4075             20  CF-ST-REM-TERM-CALC        PIC X.
  4076                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  4077                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  4078                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  4079                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  4080                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  4081                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  4082                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  4083                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  4084
  4085             20  CF-ST-REFUND-CALC          PIC X.
  4086                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  4087                 88  ST-REFD-BY-R78             VALUE '1'.
  4088                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  4089                 88  ST-REFD-AS-CALIF           VALUE '3'.
  4090                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  4091                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  4092                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  4093                 88  ST-REFD-UTAH               VALUE '7'.
  4094                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  4095                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  4096                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  4097
  4098             20  CF-ST-EARNING-CALC         PIC X.
  4099                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  4100                 88  ST-EARN-BY-R78             VALUE '1'.
  4101                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  4102                 88  ST-EARN-AS-CALIF           VALUE '3'.
  4103                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  4104                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  78
* EL130.cbl
  4105                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  4106                 88  ST-EARN-MEAN               VALUE '8'.
  4107                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  4108
  4109             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  4110                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  4111                 88  ST-OVRD-BY-R78             VALUE '1'.
  4112                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  4113                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  4114                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  4115                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  4116                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  4117                 88  ST-OVRD-MEAN               VALUE '8'.
  4118                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  4119             20  FILLER                     PIC X.
  4120
  4121         16  CF-ST-COMMISSION-CAPS.
  4122             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  4123             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  4124             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  4125             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  4126         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  4127                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  4128
  4129         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  4130
  4131         16  CF-ST-STATUTORY-INTEREST.
  4132             20  CF-ST-STAT-DATE-FROM       PIC X.
  4133                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  4134                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  4135             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  4136             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  4137             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  4138             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  4139             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  4140
  4141         16  CF-ST-OVER-SHORT.
  4142             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  4143             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  4144
  4145         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  4146
  4147         16  CF-ST-RT-CALC                  PIC X.
  4148
  4149         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  4150         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  4151         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  4152         16  CF-ST-RF-LR-CALC               PIC X.
  4153         16  CF-ST-RF-LL-CALC               PIC X.
  4154         16  CF-ST-RF-LN-CALC               PIC X.
  4155         16  CF-ST-RF-AH-CALC               PIC X.
  4156         16  CF-ST-RF-CP-CALC               PIC X.
  4157*        16  FILLER                         PIC X(206).
  4158*CIDMOD         16  FILLER                         PIC X(192).
  4159         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  4160             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  4161         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  4162         16  CF-ST-VFY-2ND-BENE             PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  79
* EL130.cbl
  4163         16  CF-ST-CAUSAL-STATE             PIC X.
  4164         16  FILLER                         PIC X(185).
  4165
  4166****************************************************************
  4167*             BENEFIT MASTER RECORD                            *
  4168****************************************************************
  4169
  4170     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4171         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  4172             20  CF-BENEFIT-CODE            PIC XX.
  4173             20  CF-BENEFIT-NUMERIC  REDEFINES
  4174                 CF-BENEFIT-CODE            PIC XX.
  4175             20  CF-BENEFIT-ALPHA           PIC XXX.
  4176             20  CF-BENEFIT-DESCRIP         PIC X(10).
  4177             20  CF-BENEFIT-COMMENT         PIC X(10).
  4178
  4179             20  CF-LF-COVERAGE-TYPE        PIC X.
  4180                 88  CF-REDUCING                VALUE 'R'.
  4181                 88  CF-LEVEL                   VALUE 'L' 'P'.
  4182
  4183             20  CF-SPECIAL-CALC-CD         PIC X.
  4184                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  4185                 88  CF-NP-0-MO-INT             VALUE 'A'.
  4186                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  4187                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  4188                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  4189                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  4190                 88  CF-FARM-PLAN               VALUE 'F'.
  4191                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  4192                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  4193                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  4194                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  4195                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  4196                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  4197                 88  CF-PRUDENTIAL              VALUE 'P'.
  4198                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  4199                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  4200                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  4201                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  4202                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  4203                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  4204
  4205             20  CF-JOINT-INDICATOR         PIC X.
  4206                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  4207
  4208*            20  FILLER                     PIC X(12).
  4209             20  FILLER                     PIC X(11).
  4210             20  CF-BENEFIT-CATEGORY        PIC X.
  4211             20  CF-LOAN-TYPE               PIC X(8).
  4212
  4213             20  CF-CO-REM-TERM-CALC        PIC X.
  4214                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  4215                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  4216                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  4217                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  4218                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  4219
  4220             20  CF-CO-EARNINGS-CALC        PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  80
* EL130.cbl
  4221                 88  CO-EARN-BY-R78             VALUE '1'.
  4222                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  4223                 88  CO-EARN-AS-CALIF           VALUE '3'.
  4224                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  4225                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  4226                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  4227                 88  CO-EARN-AS-MEAN            VALUE '8'.
  4228                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  4229
  4230             20  CF-CO-REFUND-CALC          PIC X.
  4231                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  4232                 88  CO-REFD-BY-R78             VALUE '1'.
  4233                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  4234                 88  CO-REFD-AS-CALIF           VALUE '3'.
  4235                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  4236                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  4237                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  4238                 88  CO-REFD-MEAN               VALUE '8'.
  4239                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  4240                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  4241                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  4242
  4243             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  4244                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  4245                 88  CO-OVRD-BY-R78             VALUE '1'.
  4246                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  4247                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  4248                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  4249                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  4250                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  4251                 88  CO-OVRD-MEAN               VALUE '8'.
  4252                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  4253
  4254             20  CF-CO-BEN-I-G-CD           PIC X.
  4255                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  4256                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  4257                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  4258
  4259         16  FILLER                         PIC X(304).
  4260
  4261
  4262****************************************************************
  4263*             CARRIER MASTER RECORD                            *
  4264****************************************************************
  4265
  4266     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4267         16  CF-ADDRESS-DATA.
  4268             20  CF-MAIL-TO-NAME            PIC X(30).
  4269             20  CF-IN-CARE-OF              PIC X(30).
  4270             20  CF-ADDRESS-LINE-1          PIC X(30).
  4271             20  CF-ADDRESS-LINE-2          PIC X(30).
  4272             20  CF-CITY-STATE              PIC X(30).
  4273             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  4274             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  4275
  4276         16  CF-CLAIM-NO-CONTROL.
  4277             20  CF-CLAIM-NO-METHOD         PIC X.
  4278                 88  CLAIM-NO-MANUAL            VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  81
* EL130.cbl
  4279                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  4280                 88  CLAIM-NO-SEQ               VALUE '3'.
  4281                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  4282             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  4283                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  4284                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  4285                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  4286
  4287         16  CF-CHECK-NO-CONTROL.
  4288             20  CF-CHECK-NO-METHOD         PIC X.
  4289                 88  CHECK-NO-MANUAL            VALUE '1'.
  4290                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  4291                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  4292                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  4293             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  4294                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  4295
  4296         16  CF-DOMICILE-STATE              PIC XX.
  4297
  4298         16  CF-EXPENSE-CONTROLS.
  4299             20  CF-EXPENSE-METHOD          PIC X.
  4300                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  4301                 88  DOLLARS-PER-PMT            VALUE '2'.
  4302                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  4303                 88  DOLLARS-PER-MONTH          VALUE '4'.
  4304             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  4305             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  4306
  4307         16  CF-CORRESPONDENCE-CONTROL.
  4308             20  CF-LETTER-RESEND-OPT       PIC X.
  4309                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  4310                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  4311             20  FILLER                     PIC X(4).
  4312
  4313         16  CF-RESERVE-CONTROLS.
  4314             20  CF-MANUAL-SW               PIC X.
  4315                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  4316             20  CF-FUTURE-SW               PIC X.
  4317                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  4318             20  CF-PTC-SW                  PIC X.
  4319                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  4320             20  CF-IBNR-SW                 PIC X.
  4321                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  4322             20  CF-PTC-LF-SW               PIC X.
  4323                 88  CF-LF-PTC-USED             VALUE '1'.
  4324             20  CF-CDT-ACCESS-METHOD       PIC X.
  4325                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  4326                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  4327                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  4328             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  4329
  4330         16  CF-CLAIM-CALC-METHOD           PIC X.
  4331             88  360-PLUS-MONTHS                VALUE '1'.
  4332             88  365-PLUS-MONTHS                VALUE '2'.
  4333             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  4334             88  360-DAILY                      VALUE '4'.
  4335             88  365-DAILY                      VALUE '5'.
  4336
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  82
* EL130.cbl
  4337         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  4338         16  FILLER                         PIC X(11).
  4339
  4340         16  CF-LIMIT-AMOUNTS.
  4341             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  4342             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  4343             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  4344             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  4345             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  4346             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  4347             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  4348             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  4349             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  4350             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  4351
  4352         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  4353         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  4354         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  4355
  4356         16  CF-ZIP-CODE.
  4357             20  CF-ZIP-PRIME.
  4358                 24  CF-ZIP-1ST             PIC X.
  4359                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4360                 24  FILLER                 PIC X(4).
  4361             20  CF-ZIP-PLUS4               PIC X(4).
  4362         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  4363             20  CF-CAN-POSTAL-1            PIC XXX.
  4364             20  CF-CAN-POSTAL-2            PIC XXX.
  4365             20  FILLER                     PIC XXX.
  4366
  4367         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  4368         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  4369         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  4370
  4371         16  CF-RATING-SWITCH               PIC X.
  4372             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  4373             88  CF-NO-RATING                   VALUE 'N'.
  4374
  4375         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  4376
  4377         16  CF-CARRIER-OVER-SHORT.
  4378             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  4379             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  4380
  4381         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  4382         16  CF-SECPAY-SWITCH               PIC X.
  4383             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  4384             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  4385         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  4386         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  4387         16  FILLER                         PIC X(444).
  4388*        16  FILLER                         PIC X(452).
  4389
  4390
  4391****************************************************************
  4392*             MORTALITY MASTER RECORD                          *
  4393****************************************************************
  4394
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  83
* EL130.cbl
  4395     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4396         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  4397                                INDEXED BY CF-MORT-NDX.
  4398             20  CF-MORT-TABLE              PIC X(5).
  4399             20  CF-MORT-TABLE-TYPE         PIC X.
  4400                 88  CF-MORT-JOINT              VALUE 'J'.
  4401                 88  CF-MORT-SINGLE             VALUE 'S'.
  4402                 88  CF-MORT-COMBINED           VALUE 'C'.
  4403                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  4404                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  4405             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  4406             20  CF-MORT-AGE-METHOD         PIC XX.
  4407                 88  CF-AGE-LAST                VALUE 'AL'.
  4408                 88  CF-AGE-NEAR                VALUE 'AN'.
  4409             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  4410             20  CF-MORT-ADJUSTMENT-DIRECTION
  4411                                            PIC X.
  4412                 88  CF-MINUS                   VALUE '-'.
  4413                 88  CF-PLUS                    VALUE '+'.
  4414             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  4415             20  CF-MORT-JOINT-CODE         PIC X.
  4416                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  4417             20  CF-MORT-PC-Q               PIC X.
  4418                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  4419             20  CF-MORT-TABLE-CODE         PIC X(4).
  4420             20  CF-MORT-COMMENTS           PIC X(15).
  4421             20  FILLER                     PIC X(14).
  4422
  4423         16  FILLER                         PIC X(251).
  4424
  4425
  4426****************************************************************
  4427*             BUSSINESS TYPE MASTER RECORD                     *
  4428****************************************************************
  4429
  4430     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4431* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  4432* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  4433* AND RECORD 05 IS TYPES 81-99
  4434         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  4435             20  CF-BUSINESS-TITLE          PIC  X(19).
  4436             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  4437                                            PIC S9V9(4) COMP-3.
  4438             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  4439             20  FILLER                     PIC  X.
  4440         16  FILLER                         PIC  X(248).
  4441
  4442
  4443****************************************************************
  4444*             TERMINAL MASTER RECORD                           *
  4445****************************************************************
  4446
  4447     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4448
  4449         16  CF-COMPANY-TERMINALS.
  4450             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  4451                                  PIC X(4).
  4452         16  FILLER               PIC X(248).
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  84
* EL130.cbl
  4453
  4454
  4455****************************************************************
  4456*             LIFE EDIT MASTER RECORD                          *
  4457****************************************************************
  4458
  4459     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4460         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  4461             20  CF-LIFE-CODE-IN            PIC XX.
  4462             20  CF-LIFE-CODE-OUT           PIC XX.
  4463         16  FILLER                         PIC X(248).
  4464
  4465
  4466****************************************************************
  4467*             AH EDIT MASTER RECORD                            *
  4468****************************************************************
  4469
  4470     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4471         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  4472             20  CF-AH-CODE-IN              PIC XXX.
  4473             20  CF-AH-CODE-OUT             PIC XX.
  4474         16  FILLER                         PIC X(248).
  4475
  4476
  4477****************************************************************
  4478*             CREDIBILITY TABLES                               *
  4479****************************************************************
  4480
  4481     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4482         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  4483                             INDEXED BY CF-CRDB-NDX.
  4484             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  4485             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  4486             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  4487         16  FILLER                         PIC  X(332).
  4488
  4489
  4490****************************************************************
  4491*             REPORT CUSTOMIZATION RECORD                      *
  4492****************************************************************
  4493
  4494     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  4495         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  4496             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  4497             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  4498             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  4499**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  4500****       A T-TRANSFER.                                   ****
  4501             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  4502
  4503         16  FILLER                         PIC XX.
  4504
  4505         16  CF-CARRIER-CNTL-OPT.
  4506             20  CF-CARRIER-OPT-SEQ         PIC 9.
  4507                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  4508                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  4509             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  4510                                            PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  85
* EL130.cbl
  4511         16  CF-GROUP-CNTL-OPT.
  4512             20  CF-GROUP-OPT-SEQ           PIC 9.
  4513                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  4514                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  4515             20  CF-GROUP-SELECT OCCURS 3 TIMES
  4516                                            PIC X(6).
  4517         16  CF-STATE-CNTL-OPT.
  4518             20  CF-STATE-OPT-SEQ           PIC 9.
  4519                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  4520                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  4521             20  CF-STATE-SELECT OCCURS 3 TIMES
  4522                                            PIC XX.
  4523         16  CF-ACCOUNT-CNTL-OPT.
  4524             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  4525                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  4526                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  4527             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  4528                                            PIC X(10).
  4529         16  CF-BUS-TYP-CNTL-OPT.
  4530             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  4531                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  4532                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  4533             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  4534                                            PIC XX.
  4535         16  CF-LF-TYP-CNTL-OPT.
  4536             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  4537                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  4538                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  4539             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  4540                                            PIC XX.
  4541         16  CF-AH-TYP-CNTL-OPT.
  4542             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  4543                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  4544                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  4545             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  4546                                            PIC XX.
  4547         16  CF-REPTCD1-CNTL-OPT.
  4548             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  4549                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  4550                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  4551             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  4552                                            PIC X(10).
  4553         16  CF-REPTCD2-CNTL-OPT.
  4554             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  4555                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  4556                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  4557             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  4558                                            PIC X(10).
  4559         16  CF-USER1-CNTL-OPT.
  4560             20  CF-USER1-OPT-SEQ           PIC 9.
  4561                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  4562                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  4563             20  CF-USER1-SELECT OCCURS 3 TIMES
  4564                                            PIC X(10).
  4565         16  CF-USER2-CNTL-OPT.
  4566             20  CF-USER2-OPT-SEQ           PIC 9.
  4567                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  4568                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  86
* EL130.cbl
  4569             20  CF-USER2-SELECT OCCURS 3 TIMES
  4570                                            PIC X(10).
  4571         16  CF-USER3-CNTL-OPT.
  4572             20  CF-USER3-OPT-SEQ           PIC 9.
  4573                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  4574                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  4575             20  CF-USER3-SELECT OCCURS 3 TIMES
  4576                                            PIC X(10).
  4577         16  CF-USER4-CNTL-OPT.
  4578             20  CF-USER4-OPT-SEQ           PIC 9.
  4579                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  4580                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  4581             20  CF-USER4-SELECT OCCURS 3 TIMES
  4582                                            PIC X(10).
  4583         16  CF-USER5-CNTL-OPT.
  4584             20  CF-USER5-OPT-SEQ           PIC 9.
  4585                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  4586                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  4587             20  CF-USER5-SELECT OCCURS 3 TIMES
  4588                                            PIC X(10).
  4589         16  CF-REINS-CNTL-OPT.
  4590             20  CF-REINS-OPT-SEQ           PIC 9.
  4591                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  4592                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  4593             20  CF-REINS-SELECT OCCURS 3 TIMES.
  4594                 24  CF-REINS-PRIME         PIC XXX.
  4595                 24  CF-REINS-SUB           PIC XXX.
  4596
  4597         16  CF-AGENT-CNTL-OPT.
  4598             20  CF-AGENT-OPT-SEQ           PIC 9.
  4599                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  4600                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  4601             20  CF-AGENT-SELECT OCCURS 3 TIMES
  4602                                            PIC X(10).
  4603
  4604         16  FILLER                         PIC X(43).
  4605
  4606         16  CF-LOSS-RATIO-SELECT.
  4607             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  4608             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  4609         16  CF-ENTRY-DATE-SELECT.
  4610             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  4611             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  4612         16  CF-EFFECTIVE-DATE-SELECT.
  4613             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  4614             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  4615
  4616         16  CF-EXCEPTION-LIST-IND          PIC X.
  4617             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  4618
  4619         16  FILLER                         PIC X(318).
  4620
  4621****************************************************************
  4622*                  EXCEPTION REPORTING RECORD                  *
  4623****************************************************************
  4624
  4625     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  4626         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  87
* EL130.cbl
  4627             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  4628
  4629         16  CF-COMBINED-LIFE-AH-OPT.
  4630             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  4631             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  4632             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  4633             20  CF-CANCELLATION-RATIO      PIC S9(02).
  4634
  4635         16  CF-LIFE-OPT.
  4636             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4637             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4638             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4639             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4640             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4641             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4642             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4643             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4644             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4645             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  4646
  4647         16  CF-AH-OPT.
  4648             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4649             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4650             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4651             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4652             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4653             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4654             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4655             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4656             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4657             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  4658
  4659         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  4660             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  4661             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  4662             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  4663
  4664         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  4665
  4666         16  FILLER                         PIC X(673).
  4667
  4668
  4669****************************************************************
  4670*             MORTGAGE SYSTEM PLAN RECORD                      *
  4671****************************************************************
  4672
  4673     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  4674         16  CF-PLAN-TYPE                   PIC X.
  4675             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  4676             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  4677             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  4678         16  CF-PLAN-ABBREV                 PIC XXX.
  4679         16  CF-PLAN-DESCRIPT               PIC X(10).
  4680         16  CF-PLAN-NOTES                  PIC X(20).
  4681         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  4682         16  CF-PLAN-UNDERWRITING.
  4683             20  CF-PLAN-TERM-DATA.
  4684                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  88
* EL130.cbl
  4685                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  4686             20  CF-PLAN-AGE-DATA.
  4687                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  4688                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  4689                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  4690             20  CF-PLAN-BENEFIT-DATA.
  4691                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4692                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4693                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  4694                                            PIC S9(7)V99  COMP-3.
  4695         16  CF-PLAN-POLICY-FORMS.
  4696             20  CF-POLICY-FORM             PIC X(12).
  4697             20  CF-MASTER-APPLICATION      PIC X(12).
  4698             20  CF-MASTER-POLICY           PIC X(12).
  4699         16  CF-PLAN-RATING.
  4700             20  CF-RATE-CODE               PIC X(5).
  4701             20  CF-SEX-RATING              PIC X.
  4702                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  4703                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  4704             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  4705             20  CF-SUB-STD-TYPE            PIC X.
  4706                 88  CF-PCT-OF-PREM            VALUE '1'.
  4707                 88  CF-PCT-OF-BENE            VALUE '2'.
  4708         16  CF-PLAN-PREM-TOLERANCES.
  4709             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  4710             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  4711         16  CF-PLAN-PYMT-TOLERANCES.
  4712             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  4713             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  4714         16  CF-PLAN-MISC-DATA.
  4715             20  FILLER                     PIC X.
  4716             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  4717             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  4718         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  4719         16  CF-PLAN-IND-GRP                PIC X.
  4720             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  4721                                                     '1'.
  4722             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  4723                                                     '2'.
  4724         16  CF-MIB-SEARCH-SW               PIC X.
  4725             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  4726             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  4727             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  4728             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  4729         16  CF-ALPHA-SEARCH-SW             PIC X.
  4730             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  4731             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  4732             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  4733             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  4734             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  4735             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  4736             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  4737             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  4738             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  4739             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  4740                                                     'A' 'B' 'C'
  4741                                                     'X' 'Y' 'Z'.
  4742         16  CF-EFF-DT-RULE-SW              PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  89
* EL130.cbl
  4743             88  CF-EFF-DT-ENTER               VALUE 'E'.
  4744             88  CF-EFF-DT-MONTH               VALUE 'M'.
  4745             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  4746             88  CF-EFF-DT-SEMI                VALUE 'S'.
  4747             88  CF-EFF-DT-ANN                 VALUE 'A'.
  4748         16  FILLER                         PIC X(4).
  4749         16  CF-HEALTH-QUESTIONS            PIC X.
  4750             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  4751         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  4752         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  4753         16  CF-PLAN-SNGL-JNT               PIC X.
  4754             88  CF-COMBINED-PLAN              VALUE 'C'.
  4755             88  CF-JNT-PLAN                   VALUE 'J'.
  4756             88  CF-SNGL-PLAN                  VALUE 'S'.
  4757         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  4758         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  4759         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  4760         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  4761         16  CF-RERATE-CNTL                 PIC  X.
  4762             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  4763             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  4764             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  4765             88  CF-AUTO-RECALC                 VALUE '4'.
  4766         16  CF-BENEFIT-TYPE                PIC  X.
  4767             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  4768             88  CF-BENEFIT-REDUCES             VALUE '2'.
  4769         16  CF-POLICY-FEE                  PIC S999V99
  4770                                                    COMP-3.
  4771         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  4772         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  4773         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  4774         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  4775         16  FILLER                         PIC  X(32).
  4776         16  CF-TERMINATION-FORM            PIC  X(04).
  4777         16  FILLER                         PIC  X(08).
  4778         16  CF-CLAIM-CAP                   PIC S9(7)V99
  4779                                                       COMP-3.
  4780         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  4781         16  CF-ISSUE-LETTER                PIC  X(4).
  4782         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  4783         16  CF-DEPENDENT-COVERAGE          PIC  X.
  4784             88  CF-YES-DEP-COV                 VALUE 'Y'.
  4785             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  4786         16  CF-MP-REFUND-CALC              PIC X.
  4787             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  4788             88  CF-MP-REFD-BY-R78              VALUE '1'.
  4789             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  4790             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  4791             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  4792             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  4793             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  4794             88  CF-MP-REFD-MEAN                VALUE '8'.
  4795         16  CF-ALT-RATE-CODE               PIC  X(5).
  4796
  4797
  4798         16  FILLER                         PIC X(498).
  4799****************************************************************
  4800*             MORTGAGE COMPANY MASTER RECORD                   *
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  90
* EL130.cbl
  4801****************************************************************
  4802
  4803     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4804         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  4805         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  4806             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  4807             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  4808             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  4809             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  4810             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  4811
  4812         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  4813         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  4814         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  4815         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  4816         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  4817
  4818         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  4819             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  4820         16  CF-MP-RECON-USE-IND            PIC X(1).
  4821             88  CF-MP-USE-RECON             VALUE 'Y'.
  4822         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  4823             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  4824         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  4825             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  4826             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  4827         16  FILLER                         PIC X(1).
  4828         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  4829             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  4830         16  CF-MORTG-MIB-VERSION           PIC X.
  4831             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  4832             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  4833             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  4834         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  4835             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  4836                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  4837             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  4838                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  4839             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  4840                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  4841             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  4842                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  4843             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  4844                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  4845             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  4846                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  4847         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  4848         16  FILLER                         PIC X(7).
  4849         16  CF-MORTG-DESTINATION-SYMBOL.
  4850             20  CF-MORTG-MIB-COMM          PIC X(5).
  4851             20  CF-MORTG-MIB-TERM          PIC X(5).
  4852         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  4853             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  4854         16  FILLER                         PIC X(03).
  4855         16  CF-MP-CHECK-NO-CONTROL.
  4856             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  4857                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  4858                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  91
* EL130.cbl
  4859                                                ' ' LOW-VALUES.
  4860                 88  CF-MP-CHECK-NO-PRE-PRINTED
  4861                                               VALUE '3'.
  4862         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  4863         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  4864         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  4865             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  4866                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  4867             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  4868                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  4869             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  4870                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  4871             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  4872                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  4873             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  4874                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  4875             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  4876                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  4877         16  CF-MORTG-BILLING-AREA.
  4878             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  4879                                            PIC X.
  4880         16  CF-MORTG-MONTH-END-DT          PIC XX.
  4881         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  4882         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  4883         16  CF-MORTG-MIB-DEST-SW           PIC X.
  4884             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  4885             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  4886         16  FILLER                         PIC X.
  4887         16  CF-MORTG-LABEL-CONTROL         PIC X.
  4888             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  4889             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  4890         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  4891         16  FILLER                         PIC X(8).
  4892         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  4893         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  4894         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  4895         16  CF-ACH-COMPANY-ID.
  4896             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  4897                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  4898                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  4899                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  4900             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  4901         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  4902             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  4903         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  4904             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  4905             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  4906         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  4907         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  4908         16  FILLER                         PIC X(536).
  4909
  4910****************************************************************
  4911*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  4912****************************************************************
  4913
  4914     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  4915         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  4916             20  CF-FEMALE-HEIGHT.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  92
* EL130.cbl
  4917                 24  CF-FEMALE-FT           PIC 99.
  4918                 24  CF-FEMALE-IN           PIC 99.
  4919             20  CF-FEMALE-MIN-WT           PIC 999.
  4920             20  CF-FEMALE-MAX-WT           PIC 999.
  4921         16  FILLER                         PIC X(428).
  4922
  4923     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  4924         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  4925             20  CF-MALE-HEIGHT.
  4926                 24  CF-MALE-FT             PIC 99.
  4927                 24  CF-MALE-IN             PIC 99.
  4928             20  CF-MALE-MIN-WT             PIC 999.
  4929             20  CF-MALE-MAX-WT             PIC 999.
  4930         16  FILLER                         PIC X(428).
  4931******************************************************************
  4932*             AUTOMATIC ACTIVITY RECORD                          *
  4933******************************************************************
  4934     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  4935         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  4936             20  CF-SYS-ACTIVE-SW           PIC X(01).
  4937             20  CF-SYS-LETTER-ID           PIC X(04).
  4938             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  4939             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  4940             20  CF-SYS-RESET-SW            PIC X(01).
  4941             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  4942             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  4943
  4944         16  FILLER                         PIC X(50).
  4945
  4946         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  4947             20  CF-USER-ACTIVE-SW          PIC X(01).
  4948             20  CF-USER-LETTER-ID          PIC X(04).
  4949             20  CF-USER-RESEND-DAYS        PIC 9(03).
  4950             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  4951             20  CF-USER-RESET-SW           PIC X(01).
  4952             20  CF-USER-REPORT-DAYS        PIC 9(03).
  4953             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  4954             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  4955
  4956         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  93
* EL130.cbl
  4958*    COPY ELCCERT.
  4959******************************************************************
  4960*                                                                *
  4961*                            ELCCERT.                            *
  4962*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4963*                            VMOD=2.013                          *
  4964*                                                                *
  4965*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  4966*                                                                *
  4967*   FILE TYPE = VSAM,KSDS                                        *
  4968*   RECORD SIZE = 450  RECFORM = FIXED                           *
  4969*                                                                *
  4970*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  4971*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  4972*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  4973*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  4974*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  4975*                                                                *
  4976*   LOG = YES                                                    *
  4977*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4978******************************************************************
  4979*                   C H A N G E   L O G
  4980*
  4981* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4982*-----------------------------------------------------------------
  4983*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4984* EFFECTIVE    NUMBER
  4985*-----------------------------------------------------------------
  4986* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4987* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4988* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  4989* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4990* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4991* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  4992* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4993* 032612  CR2011110200001  PEMA  AHL CHANGES
  4994******************************************************************
  4995
  4996 01  CERTIFICATE-MASTER.
  4997     12  CM-RECORD-ID                      PIC XX.
  4998         88  VALID-CM-ID                      VALUE 'CM'.
  4999
  5000     12  CM-CONTROL-PRIMARY.
  5001         16  CM-COMPANY-CD                 PIC X.
  5002         16  CM-CARRIER                    PIC X.
  5003         16  CM-GROUPING.
  5004             20  CM-GROUPING-PREFIX        PIC X(3).
  5005             20  CM-GROUPING-PRIME         PIC X(3).
  5006         16  CM-STATE                      PIC XX.
  5007         16  CM-ACCOUNT.
  5008             20  CM-ACCOUNT-PREFIX         PIC X(4).
  5009             20  CM-ACCOUNT-PRIME          PIC X(6).
  5010         16  CM-CERT-EFF-DT                PIC XX.
  5011         16  CM-CERT-NO.
  5012             20  CM-CERT-PRIME             PIC X(10).
  5013             20  CM-CERT-SFX               PIC X.
  5014
  5015     12  CM-CONTROL-BY-NAME.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  94
* EL130.cbl
  5016         16  CM-COMPANY-CD-A1              PIC X.
  5017         16  CM-INSURED-LAST-NAME          PIC X(15).
  5018         16  CM-INSURED-INITIALS.
  5019             20  CM-INSURED-INITIAL1       PIC X.
  5020             20  CM-INSURED-INITIAL2       PIC X.
  5021
  5022     12  CM-CONTROL-BY-SSN.
  5023         16  CM-COMPANY-CD-A2              PIC X.
  5024         16  CM-SOC-SEC-NO.
  5025             20  CM-SSN-STATE              PIC XX.
  5026             20  CM-SSN-ACCOUNT            PIC X(6).
  5027             20  CM-SSN-LN3.
  5028                 25  CM-INSURED-INITIALS-A2.
  5029                     30 CM-INSURED-INITIAL1-A2   PIC X.
  5030                     30 CM-INSURED-INITIAL2-A2   PIC X.
  5031                 25 CM-PART-LAST-NAME-A2         PIC X.
  5032
  5033     12  CM-CONTROL-BY-CERT-NO.
  5034         16  CM-COMPANY-CD-A4              PIC X.
  5035         16  CM-CERT-NO-A4                 PIC X(11).
  5036
  5037     12  CM-CONTROL-BY-MEMB.
  5038         16  CM-COMPANY-CD-A5              PIC X.
  5039         16  CM-MEMBER-NO.
  5040             20  CM-MEMB-STATE             PIC XX.
  5041             20  CM-MEMB-ACCOUNT           PIC X(6).
  5042             20  CM-MEMB-LN4.
  5043                 25  CM-INSURED-INITIALS-A5.
  5044                     30 CM-INSURED-INITIAL1-A5   PIC X.
  5045                     30 CM-INSURED-INITIAL2-A5   PIC X.
  5046                 25 CM-PART-LAST-NAME-A5         PIC XX.
  5047
  5048     12  CM-INSURED-PROFILE-DATA.
  5049         16  CM-INSURED-FIRST-NAME.
  5050             20  CM-INSURED-1ST-INIT       PIC X.
  5051             20  FILLER                    PIC X(9).
  5052         16  CM-INSURED-ISSUE-AGE          PIC 99.
  5053         16  CM-INSURED-SEX                PIC X.
  5054             88  CM-SEX-MALE                  VALUE 'M'.
  5055             88  CM-SEX-FEMAL                 VALUE 'F'.
  5056         16  CM-INSURED-JOINT-AGE          PIC 99.
  5057         16  CM-JOINT-INSURED-NAME.
  5058             20  CM-JT-LAST-NAME           PIC X(15).
  5059             20  CM-JT-FIRST-NAME.
  5060                 24  CM-JT-1ST-INIT        PIC X.
  5061                 24  FILLER                PIC X(9).
  5062             20  CM-JT-INITIAL             PIC X.
  5063
  5064     12  CM-LIFE-DATA.
  5065         16  CM-LF-BENEFIT-CD              PIC XX.
  5066         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  5067         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  5068         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  5069         16  CM-LF-DEV-CODE                PIC XXX.
  5070         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  5071         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  5072         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  5073         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  95
* EL130.cbl
  5074         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5075         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5076         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  5077         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5078         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  5079         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  5080         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  5081         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  5082         16  FILLER                        PIC XX.
  5083
  5084     12  CM-AH-DATA.
  5085         16  CM-AH-BENEFIT-CD              PIC XX.
  5086         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  5087         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  5088         16  CM-AH-DEV-CODE                PIC XXX.
  5089         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  5090         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  5091         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  5092         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5093         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5094         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  5095         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  5096         16  CM-AH-PAID-THRU-DT            PIC XX.
  5097             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  5098         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  5099         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  5100         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  5101         16  FILLER                        PIC X.
  5102
  5103     12  CM-LOAN-INFORMATION.
  5104         16  CM-LIVES                      PIC S9(7)     COMP-3.
  5105         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  5106                                           PIC S9(5)V99  COMP-3.
  5107         16  CM-BILLED                     PIC S9(7)     COMP-3.
  5108         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  5109         16  CM-PAY-FREQUENCY              PIC S99.
  5110         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  5111         16  CM-RATE-CLASS                 PIC XX.
  5112         16  CM-BENEFICIARY                PIC X(25).
  5113         16  CM-POLICY-FORM-NO             PIC X(12).
  5114         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  5115         16  CM-LAST-ADD-ON-DT             PIC XX.
  5116         16  CM-DEDUCTIBLE-AMOUNTS.
  5117             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  5118             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  5119         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  5120             20  CM-RESIDENT-STATE         PIC XX.
  5121             20  CM-RATE-CODE              PIC X(4).
  5122             20  FILLER                    PIC XX.
  5123         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  5124             20  CM-LOAN-OFFICER           PIC X(5).
  5125             20  FILLER                    PIC XXX.
  5126         16  CM-CSR-CODE                   PIC XXX.
  5127         16  CM-UNDERWRITING-CODE          PIC X.
  5128             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  5129         16  CM-POST-CARD-IND              PIC X.
  5130         16  CM-NH-INTERFACE-SW            PIC X.
  5131         16  CM-PREMIUM-TYPE               PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  96
* EL130.cbl
  5132             88  CM-SING-PRM                  VALUE '1'.
  5133             88  CM-O-B-COVERAGE              VALUE '2'.
  5134             88  CM-OPEN-END                  VALUE '3'.
  5135         16  CM-IND-GRP-TYPE               PIC X.
  5136             88  CM-INDIVIDUAL                VALUE 'I'.
  5137             88  CM-GROUP                     VALUE 'G'.
  5138         16  CM-SKIP-CODE                  PIC X.
  5139             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  5140             88  SKIP-JULY                    VALUE '1'.
  5141             88  SKIP-AUGUST                  VALUE '2'.
  5142             88  SKIP-SEPTEMBER               VALUE '3'.
  5143             88  SKIP-JULY-AUG                VALUE '4'.
  5144             88  SKIP-AUG-SEPT                VALUE '5'.
  5145             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  5146             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  5147             88  SKIP-JUNE                    VALUE '8'.
  5148             88  SKIP-JUNE-JULY               VALUE '9'.
  5149             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  5150             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  5151         16  CM-PAYMENT-MODE               PIC X.
  5152             88  PAY-MONTHLY                  VALUE SPACE.
  5153             88  PAY-WEEKLY                   VALUE '1'.
  5154             88  PAY-SEMI-MONTHLY             VALUE '2'.
  5155             88  PAY-BI-WEEKLY                VALUE '3'.
  5156             88  PAY-SEMI-ANUALLY             VALUE '4'.
  5157         16  CM-LOAN-NUMBER                PIC X(8).
  5158         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  5159         16  CM-OLD-LOF                    PIC XXX.
  5160*        16  CM-LOAN-OFFICER               PIC XXX.
  5161         16  CM-REIN-TABLE                 PIC XXX.
  5162         16  CM-SPECIAL-REIN-CODE          PIC X.
  5163         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  5164         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  5165         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  5166
  5167     12  CM-STATUS-DATA.
  5168         16  CM-ENTRY-STATUS               PIC X.
  5169         16  CM-ENTRY-DT                   PIC XX.
  5170
  5171         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  5172         16  CM-LF-CANCEL-DT               PIC XX.
  5173         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  5174
  5175         16  CM-LF-STATUS-AT-DEATH         PIC X.
  5176         16  CM-LF-DEATH-DT                PIC XX.
  5177         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  5178
  5179         16  CM-LF-CURRENT-STATUS          PIC X.
  5180             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5181                                                'M' '4' '5' '9'.
  5182             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  5183             88  CM-LF-POLICY-PENDING         VALUE '2'.
  5184             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  5185             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  5186             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  5187             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  5188             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  5189             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  97
* EL130.cbl
  5190             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  5191             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  5192             88  CM-LF-DECLINED               VALUE 'D'.
  5193             88  CM-LF-VOIDED                 VALUE 'V'.
  5194
  5195         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  5196         16  CM-AH-CANCEL-DT               PIC XX.
  5197         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  5198
  5199         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  5200         16  CM-AH-SETTLEMENT-DT           PIC XX.
  5201         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  5202
  5203         16  CM-AH-CURRENT-STATUS          PIC X.
  5204             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5205                                                'M' '4' '5' '9'.
  5206             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  5207             88  CM-AH-POLICY-PENDING         VALUE '2'.
  5208             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  5209             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  5210             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  5211             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  5212             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  5213             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  5214             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  5215             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  5216             88  CM-AH-DECLINED               VALUE 'D'.
  5217             88  CM-AH-VOIDED                 VALUE 'V'.
  5218
  5219         16  CM-CLAIM-INTERFACE-SW         PIC X.
  5220             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  5221             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  5222             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  5223         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  5224
  5225         16  CM-ENTRY-BATCH                PIC X(6).
  5226         16  CM-LF-EXIT-BATCH              PIC X(6).
  5227         16  CM-AH-EXIT-BATCH              PIC X(6).
  5228         16  CM-LAST-MONTH-END             PIC XX.
  5229
  5230     12  CM-NOTE-SW                        PIC X.
  5231         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  5232         88  CERT-NOTES-PRESENT               VALUE '1'.
  5233         88  BILLING-NOTES-PRESENT            VALUE '2'.
  5234         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  5235         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  5236         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  5237         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  5238         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  5239     12  CM-COMP-EXCP-SW                   PIC X.
  5240         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  5241         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  5242     12  CM-INSURED-ADDRESS-SW             PIC X.
  5243         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  5244         88  INSURED-ADDR-PRESENT             VALUE '1'.
  5245
  5246*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  5247     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  98
* EL130.cbl
  5248     12  FILLER                            PIC X.
  5249
  5250*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  5251     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  5252     12  FILLER                            PIC X.
  5253*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  5254     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  5255
  5256     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  5257         88  CERT-ADDED-BATCH                 VALUE ' '.
  5258         88  CERT-ADDED-ONLINE                VALUE '1'.
  5259         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  5260         88  CERT-PURGED-OFFLINE              VALUE '3'.
  5261         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  5262     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  5263         88  CERT-AS-LOADED                   VALUE ' '.
  5264         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  5265         88  CERT-CLAIM-ONLINE                VALUE '2'.
  5266         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  5267         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  5268         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  5269         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  5270         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  5271
  5272     12  CM-ACCOUNT-COMM-PCTS.
  5273         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  5274         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  5275
  5276     12  CM-USER-FIELD                     PIC X.
  5277     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  5278     12  CM-CLP-STATE                      PIC XX.
  5279     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  5280     12  CM-USER-RESERVED                  PIC XXX.
  5281     12  FILLER REDEFINES CM-USER-RESERVED.
  5282         16  CM-AH-CLASS-CD                PIC XX.
  5283         16  F                             PIC X.
  5284******************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page  99
* EL130.cbl
  5286*    COPY ERCACCT.
  5287******************************************************************
  5288*                                                                *
  5289*                                                                *
  5290*                            ERCACCT                             *
  5291*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5292*                            VMOD=2.031                          *
  5293*                                                                *
  5294*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  5295*                                                                *
  5296*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  5297*   VSAM ACCOUNT MASTER FILES.                                   *
  5298*                                                                *
  5299*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  5300*                                                                *
  5301*   FILE TYPE = VSAM,KSDS                                        *
  5302*   RECORD SIZE = 2000  RECFORM = FIX                            *
  5303*                                                                *
  5304*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  5305*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  5306*                                                                *
  5307*   LOG = NO                                                     *
  5308*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5309*                                                                *
  5310*                                                                *
  5311******************************************************************
  5312*                   C H A N G E   L O G
  5313*
  5314* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5315*-----------------------------------------------------------------
  5316*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5317* EFFECTIVE    NUMBER
  5318*-----------------------------------------------------------------
  5319* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  5320* 092705    2005050300006  PEMA  ADD SPP LEASES
  5321* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  5322* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5323* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  5324* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  5325* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  5326******************************************************************
  5327
  5328 01  ACCOUNT-MASTER.
  5329     12  AM-RECORD-ID                      PIC XX.
  5330         88  VALID-AM-ID                      VALUE 'AM'.
  5331
  5332     12  AM-CONTROL-PRIMARY.
  5333         16  AM-COMPANY-CD                 PIC X.
  5334         16  AM-MSTR-CNTRL.
  5335             20  AM-CONTROL-A.
  5336                 24  AM-CARRIER            PIC X.
  5337                 24  AM-GROUPING.
  5338                     28 AM-GROUPING-PREFIX PIC XXX.
  5339                     28 AM-GROUPING-PRIME  PIC XXX.
  5340                 24  AM-STATE              PIC XX.
  5341                 24  AM-ACCOUNT.
  5342                     28  AM-ACCOUNT-PREFIX PIC X(4).
  5343                     28  AM-ACCOUNT-PRIME  PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 100
* EL130.cbl
  5344             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  5345                                           PIC X(19).
  5346             20  AM-CNTRL-B.
  5347                 24  AM-EXPIRATION-DT      PIC XX.
  5348                 24  FILLER                PIC X(4).
  5349             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  5350                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  5351
  5352     12  AM-CONTROL-BY-VAR-GRP.
  5353         16  AM-COMPANY-CD-A1              PIC X.
  5354         16  AM-VG-CARRIER                 PIC X.
  5355         16  AM-VG-GROUPING                PIC X(6).
  5356         16  AM-VG-STATE                   PIC XX.
  5357         16  AM-VG-ACCOUNT                 PIC X(10).
  5358         16  AM-VG-DATE.
  5359             20  AM-VG-EXPIRATION-DT       PIC XX.
  5360             20  FILLER                    PIC X(4).
  5361         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  5362                                           PIC 9(11)      COMP-3.
  5363     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  5364         16  FILLER                        PIC X(10).
  5365         16  AM-VG-KEY3.
  5366             20  AM-VG3-ACCOUNT            PIC X(10).
  5367             20  AM-VG3-EXP-DT             PIC XX.
  5368         16  FILLER                        PIC X(4).
  5369     12  AM-MAINT-INFORMATION.
  5370         16  AM-LAST-MAINT-DT              PIC XX.
  5371         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  5372         16  AM-LAST-MAINT-USER            PIC X(4).
  5373         16  FILLER                        PIC XX.
  5374
  5375     12  AM-EFFECTIVE-DT                   PIC XX.
  5376     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  5377
  5378     12  AM-PREV-DATES  COMP-3.
  5379         16  AM-PREV-EXP-DT                PIC 9(11).
  5380         16  AM-PREV-EFF-DT                PIC 9(11).
  5381
  5382     12  AM-REPORT-CODE-1                  PIC X(10).
  5383     12  AM-REPORT-CODE-2                  PIC X(10).
  5384
  5385     12  AM-CITY-CODE                      PIC X(4).
  5386     12  AM-COUNTY-PARISH                  PIC X(6).
  5387
  5388     12  AM-NAME                           PIC X(30).
  5389     12  AM-PERSON                         PIC X(30).
  5390     12  AM-ADDRS                          PIC X(30).
  5391     12  AM-CITY.
  5392         16  AM-ADDR-CITY                  PIC X(28).
  5393         16  AM-ADDR-STATE                 PIC XX.
  5394     12  AM-ZIP.
  5395         16  AM-ZIP-PRIME.
  5396             20  AM-ZIP-PRI-1ST            PIC X.
  5397                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  5398             20  FILLER                    PIC X(4).
  5399         16  AM-ZIP-PLUS4                  PIC X(4).
  5400     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  5401         16  AM-CAN-POSTAL-1               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 101
* EL130.cbl
  5402         16  AM-CAN-POSTAL-2               PIC XXX.
  5403         16  FILLER                        PIC XXX.
  5404     12  AM-TEL-NO.
  5405         16  AM-AREA-CODE                  PIC 999.
  5406         16  AM-TEL-PRE                    PIC 999.
  5407         16  AM-TEL-NBR                    PIC 9(4).
  5408     12  AM-TEL-LOC                        PIC X.
  5409         88  AM-TEL-AT-HOME                   VALUE 'H'.
  5410         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  5411
  5412     12  AM-COMM-STRUCTURE.
  5413         16  AM-DEFN-1.
  5414             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  5415                 24  AM-AGT.
  5416                     28  AM-AGT-PREFIX     PIC X(4).
  5417                     28  AM-AGT-PRIME      PIC X(6).
  5418                 24  AM-COM-TYP            PIC X.
  5419                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  5420                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  5421                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  5422                 24  AM-RECALC-LV-INDIC    PIC X.
  5423                 24  AM-RETRO-LV-INDIC     PIC X.
  5424                 24  AM-GL-CODES           PIC X.
  5425                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  5426                 24  FILLER                PIC X(01).
  5427         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  5428             20  AM-COM-TBLS        OCCURS 10 TIMES.
  5429                 24  FILLER                PIC X(11).
  5430                 24  AM-L-COMA             PIC XXX.
  5431                 24  AM-J-COMA             PIC XXX.
  5432                 24  AM-A-COMA             PIC XXX.
  5433                 24  FILLER                PIC X(6).
  5434
  5435     12  AM-COMM-CHANGE-STATUS             PIC X.
  5436         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  5437
  5438     12  AM-CSR-CODE                       PIC X(4).
  5439
  5440     12  AM-BILLING-STATUS                 PIC X.
  5441         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  5442         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  5443     12  AM-AUTO-REFUND-SW                 PIC X.
  5444         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  5445         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  5446     12  AM-GPCD                           PIC 99.
  5447     12  AM-IG                             PIC X.
  5448         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  5449         88  AM-HAS-GROUP                     VALUE '2'.
  5450     12  AM-STATUS                         PIC X.
  5451         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  5452         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  5453         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  5454         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  5455         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  5456         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  5457     12  AM-REMIT-TO                       PIC 99.
  5458     12  AM-ID-NO                          PIC X(11).
  5459
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 102
* EL130.cbl
  5460     12  AM-CAL-TABLE                      PIC XX.
  5461     12  AM-LF-DEVIATION                   PIC XXX.
  5462     12  AM-AH-DEVIATION                   PIC XXX.
  5463     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  5464     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  5465     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  5466     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  5467     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  5468     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  5469
  5470     12  AM-USER-FIELDS.
  5471         16  AM-FLD-1                      PIC XX.
  5472         16  AM-FLD-2                      PIC XX.
  5473         16  AM-FLD-3                      PIC XX.
  5474         16  AM-FLD-4                      PIC XX.
  5475         16  AM-FLD-5                      PIC XX.
  5476
  5477     12  AM-1ST-PROD-DATE.
  5478         16  AM-1ST-PROD-YR                PIC XX.
  5479         16  AM-1ST-PROD-MO                PIC XX.
  5480         16  AM-1ST-PROD-DA                PIC XX.
  5481     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  5482     12  AM-CERTS-PURGED-DATE.
  5483         16  AM-PUR-YR                     PIC XX.
  5484         16  AM-PUR-MO                     PIC XX.
  5485         16  AM-PUR-DA                     PIC XX.
  5486     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  5487     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  5488     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  5489     12  AM-INACTIVE-DATE.
  5490         16  AM-INA-MO                     PIC 99.
  5491         16  AM-INA-DA                     PIC 99.
  5492         16  AM-INA-YR                     PIC 99.
  5493     12  AM-AR-HI-CERT-DATE                PIC XX.
  5494
  5495     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  5496     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  5497
  5498     12  AM-OB-PAYMENT-MODE                PIC X.
  5499         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  5500         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  5501         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  5502         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  5503
  5504     12  AM-AH-ONLY-INDICATOR              PIC X.
  5505         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  5506         88  AM-NO-AH-ONLY                    VALUE 'N'.
  5507
  5508     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  5509
  5510     12  AM-OVER-SHORT.
  5511         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  5512         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  5513
  5514     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  5515     12  AM-DCC-CLP-STATE                  PIC XX.
  5516
  5517     12  AM-RECALC-COMM                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 103
* EL130.cbl
  5518     12  AM-RECALC-REIN                    PIC X.
  5519
  5520     12  AM-REI-TABLE                      PIC XXX.
  5521     12  AM-REI-ET-LF                      PIC X.
  5522     12  AM-REI-ET-AH                      PIC X.
  5523     12  AM-REI-PE-LF                      PIC X.
  5524     12  AM-REI-PE-AH                      PIC X.
  5525     12  AM-REI-PRT-ST                     PIC X.
  5526     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  5527     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  5528     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  5529     12  AM-REI-GROUP-A                    PIC X(6).
  5530     12  AM-REI-MORT                       PIC X(4).
  5531     12  AM-REI-PRT-OW                     PIC X.
  5532     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  5533     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  5534     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  5535     12  AM-REI-GROUP-B                    PIC X(6).
  5536
  5537     12  AM-TRUST-TYPE                     PIC X(2).
  5538
  5539     12  AM-EMPLOYER-STMT-USED             PIC X.
  5540     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  5541
  5542     12  AM-STD-AH-TYPE                    PIC XX.
  5543     12  AM-EARN-METHODS.
  5544         16  AM-EARN-METHOD-R              PIC X.
  5545             88 AM-REF-RL-R78                 VALUE 'R'.
  5546             88 AM-REF-RL-PR                  VALUE 'P'.
  5547             88 AM-REF-RL-MEAN                VALUE 'M'.
  5548             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  5549         16  AM-EARN-METHOD-L              PIC X.
  5550             88 AM-REF-LL-R78                 VALUE 'R'.
  5551             88 AM-REF-LL-PR                  VALUE 'P'.
  5552             88 AM-REF-LL-MEAN                VALUE 'M'.
  5553             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  5554         16  AM-EARN-METHOD-A              PIC X.
  5555             88 AM-REF-AH-R78                 VALUE 'R'.
  5556             88 AM-REF-AH-PR                  VALUE 'P'.
  5557             88 AM-REF-AH-MEAN                VALUE 'M'.
  5558             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  5559             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  5560             88 AM-REF-AH-NET                 VALUE 'N'.
  5561
  5562     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  5563     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  5564     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  5565
  5566     12  AM-RET-Y-N                        PIC X.
  5567     12  AM-RET-P-E                        PIC X.
  5568     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  5569     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  5570     12  AM-RET-GRP                        PIC X(6).
  5571     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  5572         16  AM-POOL-PRIME                 PIC XXX.
  5573         16  AM-POOL-SUB                   PIC XXX.
  5574     12  AM-RETRO-EARNINGS.
  5575         16  AM-RET-EARN-R                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 104
* EL130.cbl
  5576         16  AM-RET-EARN-L                 PIC X.
  5577         16  AM-RET-EARN-A                 PIC X.
  5578     12  AM-RET-ST-TAX-USE                 PIC X.
  5579         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  5580         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  5581     12  AM-RETRO-BEG-EARNINGS.
  5582         16  AM-RET-BEG-EARN-R             PIC X.
  5583         16  AM-RET-BEG-EARN-L             PIC X.
  5584         16  AM-RET-BEG-EARN-A             PIC X.
  5585     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  5586     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  5587
  5588     12  AM-USER-SELECT-OPTIONS.
  5589         16  AM-USER-SELECT-1              PIC X(10).
  5590         16  AM-USER-SELECT-2              PIC X(10).
  5591         16  AM-USER-SELECT-3              PIC X(10).
  5592         16  AM-USER-SELECT-4              PIC X(10).
  5593         16  AM-USER-SELECT-5              PIC X(10).
  5594
  5595     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  5596
  5597     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  5598
  5599     12  AM-RPT045A-SWITCH                 PIC X.
  5600         88  RPT045A-OFF                   VALUE 'N'.
  5601
  5602     12  AM-INSURANCE-LIMITS.
  5603         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  5604         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  5605
  5606     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  5607         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  5608
  5609     12  AM-DISMBR-COVERAGE-SW             PIC X.
  5610         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  5611         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  5612
  5613     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  5614
  5615     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  5616     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  5617     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  5618     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  5619     12  AM-DCC-UEF-STATE                  PIC XX.
  5620     12  FILLER                            PIC XXX.
  5621     12  AM-REPORT-CODE-3                  PIC X(10).
  5622*    12  FILLER                            PIC X(22).
  5623
  5624     12  AM-RESERVE-DATE.
  5625         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  5626         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  5627         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  5628
  5629     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  5630     12  AM-NOTIFICATION-TYPES.
  5631         16  AM-NOTIF-OF-LETTERS           PIC X.
  5632         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  5633         16  AM-NOTIF-OF-REPORTS           PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 105
* EL130.cbl
  5634         16  AM-NOTIF-OF-STATUS            PIC X.
  5635
  5636     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  5637         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  5638         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  5639         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  5640         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  5641
  5642     12  AM-BENEFIT-CONTROLS.
  5643         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  5644             20  AM-BENEFIT-CODE           PIC XX.
  5645             20  AM-BENEFIT-TYPE           PIC X.
  5646             20  AM-BENEFIT-REVISION       PIC XXX.
  5647             20  AM-BENEFIT-REM-TERM       PIC X.
  5648             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  5649             20  FILLER                    PIC XX.
  5650         16  FILLER                        PIC X(80).
  5651
  5652     12  AM-TRANSFER-DATA.
  5653         16  AM-TRANSFERRED-FROM.
  5654             20  AM-TRNFROM-CARRIER        PIC X.
  5655             20  AM-TRNFROM-GROUPING.
  5656                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  5657                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  5658             20  AM-TRNFROM-STATE          PIC XX.
  5659             20  AM-TRNFROM-ACCOUNT.
  5660                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  5661                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  5662             20  AM-TRNFROM-DTE            PIC XX.
  5663         16  AM-TRANSFERRED-TO.
  5664             20  AM-TRNTO-CARRIER          PIC X.
  5665             20  AM-TRNTO-GROUPING.
  5666                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  5667                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  5668             20  AM-TRNTO-STATE            PIC XX.
  5669             20  AM-TRNTO-ACCOUNT.
  5670                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  5671                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  5672             20  AM-TRNTO-DTE              PIC XX.
  5673         16  FILLER                        PIC X(10).
  5674
  5675     12  AM-SAVED-REMIT-TO                 PIC 99.
  5676
  5677     12  AM-COMM-STRUCTURE-SAVED.
  5678         16  AM-DEFN-1-SAVED.
  5679             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  5680                 24  AM-AGT-SV             PIC X(10).
  5681                 24  AM-COM-TYP-SV         PIC X.
  5682                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  5683                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  5684                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  5685                 24  AM-RECALC-LV-INDIC-SV PIC X.
  5686                 24  FILLER                PIC X.
  5687                 24  AM-GL-CODES-SV        PIC X.
  5688                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  5689                 24  FILLER                PIC X.
  5690         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  5691             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 106
* EL130.cbl
  5692                 24  FILLER                PIC X(11).
  5693                 24  AM-L-COMA-SV          PIC XXX.
  5694                 24  AM-J-COMA-SV          PIC XXX.
  5695                 24  AM-A-COMA-SV          PIC XXX.
  5696                 24  FILLER                PIC X(6).
  5697
  5698     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  5699         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  5700            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  5701            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  5702            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  5703
  5704     12  AM-ORIG-DEALER-NO                 PIC X(10).
  5705     12  FILLER                            PIC X(120).
  5706
  5707     12  AM-ACCOUNT-EXECUTIVE-DATA.
  5708         16  AM-CONTROL-NAME               PIC X(30).
  5709         16  AM-EXECUTIVE-ONE.
  5710             20  AM-EXEC1-NAME             PIC X(15).
  5711             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  5712                                                          COMP-3.
  5713             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  5714                                                          COMP-3.
  5715         16  AM-EXECUTIVE-TWO.
  5716             20  AM-EXEC2-NAME             PIC X(15).
  5717             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  5718                                                          COMP-3.
  5719             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  5720                                                          COMP-3.
  5721
  5722     12  AM-RETRO-ADDITIONAL-DATA.
  5723         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  5724         16  AM-RETRO-PREM-P-E             PIC X.
  5725         16  AM-RETRO-CLMS-P-I             PIC X.
  5726         16  AM-RETRO-RET-BRACKET-LF.
  5727             20  AM-RETRO-RET-METHOD-LF    PIC X.
  5728                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  5729                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  5730             20  AM-RETRO-RET-BASIS-LF     PIC X.
  5731                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  5732                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  5733             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  5734                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  5735                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  5736         16  AM-RETRO-RET-BRACKET-AH.
  5737             20  AM-RETRO-RET-METHOD-AH    PIC X.
  5738                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  5739                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  5740                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  5741             20  AM-RETRO-RET-BASIS-AH     PIC X.
  5742                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  5743                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  5744             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  5745                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  5746                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  5747
  5748     12  AM-COMMENTS.
  5749         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 107
* EL130.cbl
  5750
  5751     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  5752         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  5753         16  AM-FLI-BILLING-CODE           PIC X.
  5754         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  5755         16  AM-FLI-UNITED-IDENT           PIC X.
  5756         16  AM-FLI-INTEREST-LOST-DATA.
  5757             20  AM-FLI-BANK-NO            PIC X(5).
  5758             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  5759             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  5760             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  5761         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  5762             20  AM-FLI-AGT                PIC X(9).
  5763             20  AM-FLI-AGT-COMM-ACC       PIC X.
  5764             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  5765         16  FILLER                        PIC X(102).
  5766
  5767     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  5768         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  5769             20  AM-BENEFIT-DMD-CODE         PIC XX.
  5770             20  AM-BENEFIT-DMD-TYPE         PIC X.
  5771             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  5772             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  5773             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  5774         16  FILLER                          PIC X(10).
  5775******************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 108
* EL130.cbl
  5777*    COPY ELCTRLR.
  5778******************************************************************
  5779*                                                                *
  5780*                            ELCTRLR.                            *
  5781*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5782*                            VMOD=2.014                          *
  5783*                                                                *
  5784*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  5785*                                                                *
  5786*   FILE TYPE = VSAM,KSDS                                        *
  5787*   RECORD SIZE = 200    RECFORM = FIXED                         *
  5788*                                                                *
  5789*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  5790*       ALTERNATE INDEX = NONE                                   *
  5791*                                                                *
  5792*   LOG = YES                                                    *
  5793*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5794******************************************************************
  5795*                   C H A N G E   L O G
  5796*
  5797* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5798*-----------------------------------------------------------------
  5799*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5800* EFFECTIVE    NUMBER
  5801*-----------------------------------------------------------------
  5802* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  5803* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
  5804* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
  5805* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
  5806* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  5807* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  5808* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  5809* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
  5810* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  5811* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  5812* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  5813* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  5814* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAIL
  5815* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
  5816* 021213    2012092400007  AJRA  CAUSAL STATE SEQUENCE NO
  5817* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  5818* 102413  CR2013100800001  AJRA  ADD SPECIAL RELEASE IND
  5819* 022614    2013050100003  AJRA  ADD CERT CANCELLED NOTE TYPE - T
  5820******************************************************************
  5821 01  ACTIVITY-TRAILERS.
  5822     12  AT-RECORD-ID                    PIC XX.
  5823         88  VALID-AT-ID                       VALUE 'AT'.
  5824
  5825     12  AT-CONTROL-PRIMARY.
  5826         16  AT-COMPANY-CD               PIC X.
  5827         16  AT-CARRIER                  PIC X.
  5828         16  AT-CLAIM-NO                 PIC X(7).
  5829         16  AT-CERT-NO.
  5830             20  AT-CERT-PRIME           PIC X(10).
  5831             20  AT-CERT-SFX             PIC X.
  5832         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
  5833             88  AT-1ST-TRL-AVAIL             VALUE +4095.
  5834             88  AT-LAST-TRL-AVAIL            VALUE +100.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 109
* EL130.cbl
  5835             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
  5836             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
  5837             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
  5838             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  5839             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
  5840             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
  5841             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  5842             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  5843             88  AT-DIAGNOSIS-TRL             VALUE +90.
  5844             88  AT-BENEFICIARY-TRL           VALUE +91.
  5845             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  5846             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
  5847             88  AT-VFY-CAUSAL-STATE          VALUE +94.
  5848             88  AT-ERROR-MSGS-TRL            VALUE +95.
  5849
  5850     12  AT-TRAILER-TYPE                 PIC X.
  5851         88  RESERVE-EXPENSE-TR               VALUE '1'.
  5852         88  PAYMENT-TR                       VALUE '2'.
  5853         88  AUTO-PAY-TR                      VALUE '3'.
  5854         88  CORRESPONDENCE-TR                VALUE '4'.
  5855         88  ADDRESS-TR                       VALUE '5'.
  5856         88  GENERAL-INFO-TR                  VALUE '6'.
  5857         88  AUTO-PROMPT-TR                   VALUE '7'.
  5858         88  DENIAL-TR                        VALUE '8'.
  5859         88  INCURRED-CHG-TR                  VALUE '9'.
  5860         88  FORM-CONTROL-TR                  VALUE 'A'.
  5861
  5862     12  AT-RECORDED-DT                  PIC XX.
  5863     12  AT-RECORDED-BY                  PIC X(4).
  5864     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  5865
  5866     12  AT-TRAILER-BODY                 PIC X(165).
  5867
  5868     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  5869         16  AT-RESERVE-CONTROLS.
  5870             20  AT-MANUAL-SW            PIC X.
  5871                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  5872             20  AT-FUTURE-SW            PIC X.
  5873                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  5874             20  AT-PTC-SW               PIC X.
  5875                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  5876             20  AT-IBNR-SW              PIC X.
  5877                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  5878             20  AT-PTC-LF-SW            PIC X.
  5879                 88  AT-LF-PTC-USED          VALUE '1'.
  5880             20  AT-CDT-ACCESS-METHOD    PIC X.
  5881                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  5882                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  5883                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  5884             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
  5885         16  AT-LAST-COMPUTED-DT         PIC XX.
  5886         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
  5887         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
  5888         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
  5889         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  5890         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  5891         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
  5892         16  AT-EXPENSE-CONTROLS.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 110
* EL130.cbl
  5893             20  AT-EXPENSE-METHOD       PIC X.
  5894                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
  5895                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  5896                 88  PERCENT-OF-PMT           VALUE '3'.
  5897                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  5898             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  5899             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
  5900         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  5901         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
  5902
  5903         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  5904         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  5905
  5906*        16  FILLER                      PIC X(53).
  5907         16  FILLER                      PIC X(47).
  5908
  5909         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  5910         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  5911
  5912         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  5913             20  AT-OPEN-CLOSE-DATE      PIC XX.
  5914             20  AT-OPEN-CLOSE-TYPE      PIC X.
  5915*                    C = CLOSED
  5916*                    O = OPEN
  5917             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  5918*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  5919
  5920     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  5921         16  AT-PAYMENT-TYPE             PIC X.
  5922             88  PARTIAL-PAYMENT                VALUE '1'.
  5923             88  FINAL-PAYMENT                  VALUE '2'.
  5924             88  LUMP-SUM-PAYMENT               VALUE '3'.
  5925             88  ADDITIONAL-PAYMENT             VALUE '4'.
  5926             88  CHARGEABLE-EXPENSE             VALUE '5'.
  5927             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  5928             88  VOIDED-PAYMENT                 VALUE '9'.
  5929             88  TRANSFER                       VALUE 'T'.
  5930             88  LIFE-INTEREST                  VALUE 'I'.
  5931
  5932         16  AT-CLAIM-TYPE               PIC X.
  5933             88  PAID-FOR-AH                    VALUE 'A'.
  5934             88  PAID-FOR-LIFE                  VALUE 'L'.
  5935             88  PAID-FOR-IUI                   VALUE 'I'.
  5936             88  PAID-FOR-GAP                   VALUE 'G'.
  5937         16  AT-CLAIM-PREM-TYPE          PIC X.
  5938             88  AT-SINGLE-PREMIUM              VALUE '1'.
  5939             88  AT-O-B-COVERAGE                VALUE '2'.
  5940             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  5941         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
  5942         16  AT-CHECK-NO                 PIC X(7).
  5943         16  AT-PAID-FROM-DT             PIC XX.
  5944         16  AT-PAID-THRU-DT             PIC XX.
  5945         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
  5946         16  FILLER                      PIC X.
  5947         16  AT-PAYEES-NAME              PIC X(30).
  5948         16  AT-PAYMENT-ORIGIN           PIC X.
  5949             88  ONLINE-MANUAL-PMT              VALUE '1'.
  5950             88  ONLINE-AUTO-PMT                VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 111
* EL130.cbl
  5951             88  OFFLINE-PMT                    VALUE '3'.
  5952         16  AT-CHECK-WRITTEN-DT         PIC XX.
  5953         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  5954         16  AT-VOID-DATA.
  5955             20  AT-VOID-DT              PIC XX.
  5956*00144       20  AT-VOID-REASON          PIC X(30).
  5957             20  AT-VOID-REASON          PIC X(26).
  5958         16  AT-PMT-APPROVED-BY          PIC X(04).
  5959         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
  5960         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  5961         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  5962                                         PIC S99V9(5)  COMP-3.
  5963         16  AT-CREDIT-INTERFACE.
  5964             20  AT-PMT-SELECT-DT        PIC XX.
  5965                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  5966             20  AT-PMT-ACCEPT-DT        PIC XX.
  5967                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  5968             20  AT-VOID-SELECT-DT       PIC XX.
  5969                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  5970             20  AT-VOID-ACCEPT-DT       PIC XX.
  5971                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
  5972
  5973         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
  5974                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  5975                 88  CONVERSION-PAYMENT           VALUE +99999999.
  5976         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  5977
  5978         16  AT-FORCE-CONTROL            PIC X.
  5979             88  PAYMENT-WAS-FORCED           VALUE '1'.
  5980         16  AT-PREV-LAST-PMT-DT         PIC XX.
  5981         16  AT-PREV-PAID-THRU-DT        PIC XX.
  5982         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  5983         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  5984         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  5985         16  AT-BENEFIT-TYPE             PIC X.
  5986
  5987         16  AT-EXPENSE-TYPE             PIC X.
  5988         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  5989
  5990         16  AT-PAYEE-TYPE-CD.
  5991             20  AT-PAYEE-TYPE           PIC X.
  5992                 88  INSURED-PAID           VALUE 'I'.
  5993                 88  BENEFICIARY-PAID       VALUE 'B'.
  5994                 88  ACCOUNT-PAID           VALUE 'A'.
  5995                 88  OTHER-1-PAID           VALUE 'O'.
  5996                 88  OTHER-2-PAID           VALUE 'Q'.
  5997                 88  DOCTOR-PAID            VALUE 'P'.
  5998                 88  EMPLOYER-PAID          VALUE 'E'.
  5999             20  AT-PAYEE-SEQ            PIC X.
  6000
  6001         16  AT-CASH-PAYMENT             PIC X.
  6002         16  AT-GROUPED-PAYMENT          PIC X.
  6003         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
  6004         16  AT-APPROVAL-LEVEL-REQD      PIC X.
  6005         16  AT-APPROVED-LEVEL           PIC X.
  6006         16  AT-VOID-TYPE                PIC X.
  6007             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
  6008             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 112
* EL130.cbl
  6009         16  AT-AIG-UNEMP-IND            PIC X.
  6010             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
  6011         16  AT-ASSOCIATES               PIC X.
  6012             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
  6013             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  6014
  6015         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
  6016         16  AT-CV-PMT-CODE              PIC X.
  6017             88  FULL-DEATH-PAYMENT         VALUE '1'.
  6018             88  HALF-DEATH-PAYMENT         VALUE '2'.
  6019             88  FULL-ADD-PAYMENT           VALUE '3'.
  6020             88  HALF-ADD-PAYMENT           VALUE '4'.
  6021             88  FULL-RIDER-PAYMENT         VALUE '5'.
  6022             88  HALF-RIDER-PAYMENT         VALUE '6'.
  6023             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  6024             88  ADDL-PAYMENT               VALUE '8'.
  6025
  6026         16  AT-EOB-CODE1                PIC XXX.
  6027         16  AT-EOB-CODE2                PIC XXX.
  6028         16  AT-EOB-CODE3                PIC XXX.
  6029         16  FILLER REDEFINES AT-EOB-CODE3.
  6030             20  AT-PRINT-CLM-FORM       PIC X.
  6031             20  AT-PRINT-SURVEY         PIC X.
  6032             20  AT-SPECIAL-RELEASE      PIC X.
  6033         16  AT-EOB-CODE4                PIC XXX.
  6034         16  FILLER REDEFINES AT-EOB-CODE4.
  6035             20  AT-INT-PMT-SELECT-DT    PIC XX.
  6036             20  FILLER                  PIC X.
  6037         16  AT-EOB-CODE5                PIC XXX.
  6038         16  FILLER REDEFINES AT-EOB-CODE5.
  6039             20  AT-PMT-PROOF-DT         PIC XX.
  6040             20  FILLER                  PIC X.
  6041
  6042         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  6043             88  AT-PRINT-EOB            VALUE 'Y'.
  6044
  6045         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  6046         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  6047
  6048     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  6049         16  AT-SCHEDULE-START-DT        PIC XX.
  6050         16  AT-SCHEDULE-END-DT          PIC XX.
  6051         16  AT-TERMINATED-DT            PIC XX.
  6052         16  AT-LAST-PMT-TYPE            PIC X.
  6053             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  6054             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  6055         16  AT-FIRST-PMT-DATA.
  6056             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
  6057             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
  6058             20  AT-1ST-PAY-THRU-DT      PIC XX.
  6059         16  AT-REGULAR-PMT-DATA.
  6060             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
  6061             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
  6062             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
  6063         16  AT-AUTO-PAYEE-CD.
  6064             20  AT-AUTO-PAYEE-TYPE      PIC X.
  6065                 88  INSURED-PAID-AUTO      VALUE 'I'.
  6066                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 113
* EL130.cbl
  6067                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
  6068                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
  6069                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  6070             20  AT-AUTO-PAYEE-SEQ       PIC X.
  6071         16  AT-AUTO-PAY-DAY             PIC 99.
  6072         16  AT-AUTO-CASH                PIC X.
  6073             88  AT-CASH                      VALUE 'Y'.
  6074             88  AT-NON-CASH                  VALUE 'N'.
  6075*        16  FILLER                      PIC X(129).
  6076         16  AT-AUTO-END-LETTER          PIC X(4).
  6077         16  FILLER                      PIC X(125).
  6078
  6079         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
  6080         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  6081
  6082     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  6083         16  AT-LETTER-SENT-DT           PIC XX.
  6084         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  6085         16  AT-AUTO-RE-SEND-DT          PIC XX.
  6086         16  AT-LETTER-ANSWERED-DT       PIC XX.
  6087         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  6088         16  AT-LETTER-ORIGIN            PIC X.
  6089             88  ONLINE-CREATION              VALUE '1' '3'.
  6090             88  OFFLINE-CREATION             VALUE '2' '4'.
  6091             88  NAPER-ONLINE-CREATION        VALUE '3'.
  6092             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  6093         16  AT-STD-LETTER-FORM          PIC X(4).
  6094         16  AT-REASON-TEXT              PIC X(70).
  6095         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  6096         16  AT-ADDRESEE-TYPE            PIC X.
  6097              88  INSURED-ADDRESEE            VALUE 'I'.
  6098              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  6099              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  6100              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  6101              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  6102              88  OTHER-ADDRESEE-1            VALUE 'O'.
  6103              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  6104         16  AT-ADDRESSEE-NAME           PIC X(30).
  6105         16  AT-INITIAL-PRINT-DATE       PIC XX.
  6106         16  AT-RESEND-PRINT-DATE        PIC XX.
  6107         16  AT-CORR-SOL-UNSOL           PIC X.
  6108         16  AT-LETTER-PURGED-DT         PIC XX.
  6109*
  6110*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  6111*
  6112         16  AT-CSO-REDEFINITION.
  6113             20  AT-RESEND-LETTER-FORM   PIC X(4).
  6114             20  AT-AUTO-CLOSE-IND       PIC X(1).
  6115             20  AT-LETTER-TO-BENE       PIC X(1).
  6116             20  AT-STOP-LETTER-DT       PIC X(2).
  6117             20  FILLER                  PIC X(19).
  6118*             20  FILLER                  PIC X(27).
  6119             20  AT-CSO-LETTER-STATUS    PIC X.
  6120                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  6121                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
  6122                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  6123             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
  6124             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 114
* EL130.cbl
  6125*
  6126*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  6127*
  6128*        16  FILLER                      PIC X(26).
  6129*
  6130*        16  AT-DMD-BSR-CODE             PIC X.
  6131*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  6132*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  6133*
  6134*        16  AT-DMD-LETTER-STATUS        PIC X.
  6135*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
  6136*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  6137*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
  6138*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  6139*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  6140
  6141         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  6142         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  6143
  6144     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  6145         16  AT-ADDRESS-TYPE             PIC X.
  6146             88  INSURED-ADDRESS               VALUE 'I'.
  6147             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  6148             88  ACCOUNT-ADDRESS               VALUE 'A'.
  6149             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  6150             88  EMPLOYER-ADDRESS              VALUE 'E'.
  6151             88  OTHER-ADDRESS-1               VALUE 'O'.
  6152             88  OTHER-ADDRESS-2               VALUE 'Q'.
  6153         16  AT-MAIL-TO-NAME             PIC X(30).
  6154         16  AT-ADDRESS-LINE-1           PIC X(30).
  6155         16  AT-ADDRESS-LINE-2           PIC X(30).
  6156         16  AT-CITY-STATE.
  6157             20  AT-CITY                 PIC X(28).
  6158             20  AT-STATE                PIC XX.
  6159         16  AT-ZIP.
  6160             20  AT-ZIP-CODE.
  6161                 24  AT-ZIP-1ST          PIC X.
  6162                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6163                 24  FILLER              PIC X(4).
  6164             20  AT-ZIP-PLUS4            PIC X(4).
  6165         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  6166             20  AT-CAN-POSTAL-1         PIC XXX.
  6167             20  AT-CAN-POSTAL-2         PIC XXX.
  6168             20  FILLER                  PIC XXX.
  6169         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  6170*         16  FILLER                      PIC X(23).
  6171         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
  6172         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
  6173         16  FILLER                      PIC X(13).
  6174         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  6175         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
  6176
  6177     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6178         16  AT-INFO-LINE-1              PIC X(60).
  6179         16  FILLER REDEFINES AT-INFO-LINE-1.
  6180             20  AT-NOTE-ERROR-NO OCCURS 15
  6181                                         PIC X(4).
  6182         16  AT-INFO-LINE-2              PIC X(60).
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 115
* EL130.cbl
  6183         16  AT-INFO-TRAILER-TYPE        PIC X.
  6184             88  AT-ERRORS-NOTE          VALUE 'E'.
  6185             88  AT-PAYMENT-NOTE         VALUE 'P'.
  6186             88  AT-CALL-NOTE            VALUE 'C'.
  6187             88  AT-MAINT-NOTE           VALUE 'M'.
  6188             88  AT-CERT-CHANGE          VALUE 'X'.
  6189             88  AT-APPROVAL-NOTE        VALUE 'R'.
  6190             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  6191             88  AT-CERT-CANCELLED       VALUE 'T'.
  6192         16  AT-CALL-TYPE                PIC X.
  6193             88  AT-PHONE-CALL-IN        VALUE 'I'.
  6194             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  6195         16  AT-NOTE-CONTINUATION        PIC X.
  6196             88  AT-CONTINUED-NOTE       VALUE 'X'.
  6197         16  AT-EOB-CODES-EXIST          PIC X.
  6198             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
  6199         16  FILLER                      PIC X(35).
  6200         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  6201         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  6202
  6203     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
  6204         16  AT-PROMPT-LINE-1            PIC X(60).
  6205         16  AT-PROMPT-LINE-2            PIC X(60).
  6206         16  AT-PROMPT-START-DT          PIC XX.
  6207         16  AT-PROMPT-END-DT            PIC XX.
  6208         16  FILLER                      PIC X(35).
  6209         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  6210         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  6211
  6212     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6213         16  AT-DENIAL-INFO-1            PIC X(60).
  6214         16  AT-DENIAL-INFO-2            PIC X(60).
  6215         16  AT-DENIAL-DT                PIC XX.
  6216         16  AT-RETRACTION-DT            PIC XX.
  6217         16  AT-DENIAL-REASON-CODE       PIC X(4).
  6218*         16  FILLER                      PIC X(31).
  6219         16  AT-DENIAL-PROOF-DT          PIC XX.
  6220         16  FILLER                      PIC X(29).
  6221         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  6222         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  6223
  6224     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  6225         16  AT-OLD-INCURRED-DT          PIC XX.
  6226         16  AT-OLD-REPORTED-DT          PIC XX.
  6227         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  6228         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  6229         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
  6230         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  6231         16  AT-OLD-PAID-THRU-DT         PIC XX.
  6232         16  AT-LAST-PMT-MADE-DT         PIC XX.
  6233         16  FILLER                      PIC X(26).
  6234         16  AT-OLD-DIAG-CODE            PIC X(6).
  6235         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  6236         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  6237         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  6238         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  6239         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  6240         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 116
* EL130.cbl
  6241         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  6242         16  FILLER                      PIC X(25).
  6243         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  6244
  6245     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  6246         16  AT-FORM-SEND-ON-DT          PIC XX.
  6247         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  6248         16  AT-FORM-RE-SEND-DT          PIC XX.
  6249         16  AT-FORM-ANSWERED-DT         PIC XX.
  6250         16  AT-FORM-PRINTED-DT          PIC XX.
  6251         16  AT-FORM-REPRINT-DT          PIC XX.
  6252         16  AT-FORM-TYPE                PIC X.
  6253             88  INITIAL-FORM                  VALUE '1'.
  6254             88  PROGRESS-FORM                 VALUE '2'.
  6255         16  AT-INSTRUCT-LN-1            PIC X(28).
  6256         16  AT-INSTRUCT-LN-2            PIC X(28).
  6257         16  AT-INSTRUCT-LN-3            PIC X(28).
  6258         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  6259         16  AT-FORM-ADDRESS             PIC X.
  6260             88  FORM-TO-INSURED              VALUE 'I'.
  6261             88  FORM-TO-ACCOUNT              VALUE 'A'.
  6262             88  FORM-TO-OTHER-1              VALUE 'O'.
  6263             88  FORM-TO-OTHER-2              VALUE 'Q'.
  6264         16  AT-RELATED-1.
  6265             20 AT-REL-CARR-1            PIC X.
  6266             20 AT-REL-CLAIM-1           PIC X(7).
  6267             20 AT-REL-CERT-1            PIC X(11).
  6268         16  AT-RELATED-2.
  6269             20 AT-REL-CARR-2            PIC X.
  6270             20 AT-REL-CLAIM-2           PIC X(7).
  6271             20 AT-REL-CERT-2            PIC X(11).
  6272         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  6273         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  6274         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  6275         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  6276         16  AT-FORM-REM-PRINT-DT        PIC XX.
  6277         16  AT-STOP-FORM-DT             PIC X(2).
  6278
  6279         16  FILLER                      PIC X(09).
  6280         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  6281         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
  6282******************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 117
* EL130.cbl
  6284*    COPY ELCBENE.
  6285******************************************************************
  6286*                                                                *
  6287*                            ELCBENE.                            *
  6288*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6289*                            VMOD=2.006                          *
  6290*                                                                *
  6291*   FILE DESCRIPTION = BENEFICIARY FILE                          *
  6292*                                                                *
  6293*   FILE TYPE = VSAM,KSDS                                        *
  6294*   RECORD SIZE = 500   RECFORM = FIX                            *
  6295*                                                                *
  6296*   BASE CLUSTER NAME = ELBENE                   RKP=2,LEN=12    *
  6297*     ALTERNATE PATH1 = ELBENE2 (ALT BY NAME)    RKP=14,LEN=42   *
  6298*                                                                *
  6299*   LOG = YES                                                    *
  6300*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6301*                                                                *
  6302*  NO  CID  MODS  TO  COPYBOOK  ELCBENE                          *
  6303******************************************************************
  6304
  6305 01  BENEFICIARY-MASTER.
  6306     12  BE-RECORD-ID                PIC XX.
  6307         88  VALID-BE-ID                VALUE 'BE'.
  6308
  6309     12  BE-CONTROL-PRIMARY.
  6310         16  BE-COMPANY-CD           PIC X.
  6311         16  BE-RECORD-TYPE          PIC X.
  6312             88  BENEFICIARY-RECORD  VALUE 'B'.
  6313             88  ADJUSTOR-RECORD     VALUE 'A'.
  6314         16  BE-BENEFICIARY          PIC X(10).
  6315     12  BE-CONTROL-BY-NAME.
  6316         16  BE-COMPANY-CD-A1        PIC X.
  6317         16  BE-RECORD-TYPE-A1       PIC X.
  6318         16  BE-MAIL-TO-NAME-A1      PIC X(30).
  6319         16  BE-ALTERNATE-PRIME-A1   PIC X(10).
  6320
  6321     12  BE-LAST-MAINT-DT            PIC XX.
  6322     12  BE-LAST-MAINT-BY            PIC X(4).
  6323     12  BE-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  6324
  6325     12  BE-ADDRESS-DATA.
  6326         16  BE-MAIL-TO-NAME         PIC X(30).
  6327         16  BE-ADDRESS-LINE-1       PIC X(30).
  6328         16  BE-ADDRESS-LINE-2       PIC X(30).
  6329         16  BE-ADDRESS-LINE-3       PIC X(30).
  6330         16  BE-CITY-STATE.
  6331             20  BE-CITY             PIC X(28).
  6332             20  BE-STATE            PIC XX.
  6333         16  BE-ZIP-CODE.
  6334             20  BE-ZIP-PRIME.
  6335                 24  BE-ZIP-1ST      PIC X.
  6336                     88  BE-CANADIAN-POST-CODE
  6337                                         VALUE 'A' THRU 'Z'.
  6338                 24  FILLER          PIC X(4).
  6339             20  BE-ZIP-PLUS4        PIC X(4).
  6340         16  BE-CANADIAN-POSTAL-CODE  REDEFINES  BE-ZIP-CODE.
  6341             20  BE-CAN-POSTAL-1     PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 118
* EL130.cbl
  6342             20  BE-CAN-POSTAL-2     PIC XXX.
  6343             20  FILLER              PIC XXX.
  6344         16  BE-PHONE-NO             PIC 9(11)     COMP-3.
  6345         16  BE-GROUP-CHECKS-Y-N     PIC X.
  6346
  6347******************************************************************
  6348*    THE BE-CARRIER FIELD IS USED BY 'AIG' TO DETERMINE HOW TO   *
  6349*    SET THE CARRIER CODE IN THE PENDING CLAIM FILE.             *
  6350******************************************************************
  6351     12  BE-CARRIER                  PIC X.
  6352
  6353     12  BE-ADDRESS-DATA2.
  6354         16  BE-MAIL-TO-NAME2        PIC X(30).
  6355         16  BE-ADDRESS-LINE-12      PIC X(30).
  6356         16  BE-ADDRESS-LINE-22      PIC X(30).
  6357         16  BE-ADDRESS-LINE-32      PIC X(30).
  6358         16  BE-CITY-STATE2.
  6359             20  BE-CITY2            PIC X(28).
  6360             20  BE-STATE2           PIC XX.
  6361         16  BE-ZIP-CODE2.
  6362             20  BE-ZIP-PRIME2.
  6363                 24  BE-ZIP-1ST2     PIC X.
  6364                     88  BE-CANADIAN-POST-CODE2
  6365                                         VALUE 'A' THRU 'Z'.
  6366                 24  FILLER          PIC X(4).
  6367             20  BE-ZIP-PLUS42       PIC X(4).
  6368         16  BE-CANADIAN-POSTAL-CODE2 REDEFINES  BE-ZIP-CODE2.
  6369             20  BE-CAN-POSTAL-12    PIC XXX.
  6370             20  BE-CAN-POSTAL-22    PIC XXX.
  6371             20  FILLER              PIC XXX.
  6372         16  BE-PHONE-NO2            PIC 9(11)     COMP-3.
  6373         16  BE-BILLING-STMT-DATA.
  6374             20  BE-BSR              PIC X.
  6375                 88  BE-AUTOMATED-BSR      VALUE 'A'.
  6376                 88  BE-NOT-AUTOMATED-BSR  VALUE ' '.
  6377             20  BE-BSR-FROM         PIC X(30).
  6378             20  BE-BSR-DEPT         PIC X(30).
  6379             20  BE-BSR-PHONE-NUM    PIC 9(11)     COMP-3.
  6380             20  BE-BSR-FAX-NUM      PIC 9(11)     COMP-3.
  6381             20  BE-OUTPUT-TYPE      PIC X.
  6382                 88  BE-FAX-OUTPUT         VALUE 'F'.
  6383                 88  BE-PRINT-OUTPUT       VALUE 'P' ' '.
  6384
  6385     12  FILLER                      PIC X(28).
  6386******************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 119
* EL130.cbl
  6388*    COPY ELCDAR.
  6389******************************************************************
  6390*                                                                *
  6391*   FILE DESC. = DAILY ACTIVITY FILE, FOR PROCESSING NITELY      *
  6392*   FILE TYPE = VSAM,KSDS                                        *
  6393*   RECORD SIZE = 25   RECFORM = FIXED                           *
  6394*   BASE CLUSTER = DLYACTV                                       *
  6395*   LOG = YES                                                    *
  6396*   NARRATIVE - FILE IS BUILT DURING DAYTIME CICS PROCESSING AND *
  6397*               IS THEN PROCESSED BY CYCLE PROCESSING AT NIGHT.  *
  6398*               THIS IS USED TO BUILD THE LOGIC "F" EXTRACT      *
  6399*               RECORDS FOR THOSE CLAIMS WHICH HAVE HAD ACTIVITY *
  6400*               DURING THE DAY. THE EXTRACTS THEN GET READ IN    *
  6401*               BY PROGRAM "LGINFCE".                            *
  6402*                                                                *
  6403******************************************************************
  6404 01  DAILY-ACTIVITY-RECORD.
  6405     05  DA-KEY.
  6406         10  DA-COMP-CD          PIC X.
  6407         10  DA-CARRIER          PIC X.
  6408         10  DA-CLAIM-NO         PIC X(7).
  6409         10  DA-CERT-NO.
  6410             15  DA-CERT-PRIME   PIC X(10).
  6411             15  DA-CERT-SFX     PIC X.
  6412     05  DA-TRAILER-SEQ-NO       PIC S9(4)  COMP.
  6413     05  DA-RECORD-TYPE          PIC X.
  6414     05  FILLER                  PIC X(2).
  6415******************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 120
* EL130.cbl
  6417*    COPY ELCACTQ.
  6418******************************************************************
  6419*                                                                *
  6420*                            ELCACTQ.                            *
  6421*           PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
  6422*                            VMOD=2.004                          *
  6423*                                                                *
  6424*   FILE DESCRIPTION = ACTIVITY QUE FILE                         *
  6425*                                                                *
  6426*   FILE TYPE = VSAM,KSDS                                        *
  6427*   RECORD SIZE = 60     RECFORM = FIXED                         *
  6428*                                                                *
  6429*   BASE CLUSTER NAME = ELACTQ             RKP=2,LEN=20          *
  6430*       ALTERNATE INDEX = NONE                                   *
  6431*                                                                *
  6432*   LOG = YES                                                    *
  6433*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6434*                                                                *
  6435*  NO  CID  MODS  IN  COPYBOOK  ELCACTQ                          *
  6436******************************************************************
  6437
  6438 01  ACTIVITY-QUE.
  6439     12  AQ-RECORD-ID                PIC XX.
  6440         88  VALID-AQ-ID                VALUE 'AQ'.
  6441
  6442     12  AQ-CONTROL-PRIMARY.
  6443         16  AQ-COMPANY-CD           PIC X.
  6444         16  AQ-CARRIER              PIC X.
  6445         16  AQ-CLAIM-NO             PIC X(7).
  6446         16  AQ-CERT-NO.
  6447             20  AQ-CERT-PRIME       PIC X(10).
  6448             20  AQ-CERT-SFX         PIC X.
  6449
  6450     12  AQ-PENDING-ACTIVITY-FLAGS.
  6451         88  NO-PENDING-ACTIVITY        VALUE SPACES.
  6452         16  AQ-PENDING-PAYMENT-FLAG PIC X.
  6453             88  PENDING-PAYMENTS       VALUE '1'.
  6454         16  AQ-PENDING-STATUS-FLAG  PIC X.
  6455             88  PENDING-FULL-PRINT     VALUE '1'.
  6456             88  PENDING-PART-PRINT     VALUE '2'.
  6457         16  AQ-PENDING-LETTER-FLAG  PIC X.
  6458             88  PENDING-LETTERS        VALUE '1'.
  6459         16  AQ-PENDING-CLAIM-RESTORE PIC X.
  6460             88  PENDING-RESTORE        VALUE 'C'.
  6461             88  PENDING-RESTORE-LETTER VALUE 'L'.
  6462
  6463     12  FILLER                      PIC X(20).
  6464
  6465     12  AQ-RESEND-DATE              PIC XX.
  6466     12  AQ-FOLLOWUP-DATE            PIC XX.
  6467     12  AQ-PAYMENT-COUNTER          PIC S9        COMP-3.
  6468     12  AQ-PMT-UNAPPROVED-COUNT     PIC S9        COMP-3.
  6469     12  AQ-AUTO-LETTER              PIC X(4).
  6470     12  FILLER                      PIC XX.
  6471     12  AQ-LAST-UPDATED-BY          PIC S9(4)     COMP.
  6472*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 121
* EL130.cbl
  6474*    COPY ELCARCH.
  6475******************************************************************
  6476*                                                                *
  6477*                            ELCARCH.                            *
  6478*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6479*                            VMOD=2.007                          *
  6480*                                                                *
  6481*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  6482*                                                                *
  6483*   FILE TYPE = VSAM,KSDS                                        *
  6484*   RECORD SIZE = 090  RECFORM = FIXED                           *
  6485*                                                                *
  6486*   BASE CLUSTER = ELARCH                        RKP=2,LEN=8     *
  6487*       ALTERNATE PATH1 = ELARCH2 (RECORD TYPE)  RKP=10,LEN=8    *
  6488*                                                                *
  6489*   LOG = NO                                                     *
  6490*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6491*                                                                *
  6492*  THERE ARE CID MODS IN COPYBOOK ELCARCH                        *
  6493******************************************************************
  6494 01  LETTER-ARCHIVE.
  6495     12  LA-RECORD-ID                PIC XX.
  6496         88  VALID-LA-ID                VALUE 'LA'.
  6497
  6498     12  LA-CONTROL-PRIMARY.
  6499         16  LA-COMPANY-CD           PIC X.
  6500         16  LA-ARCHIVE-NO           PIC S9(8)     COMP.
  6501         16  LA-RECORD-TYPE          PIC X.
  6502             88  LA-HEADER-DATA         VALUE '1'.
  6503             88  LA-ADDRESS-DATA        VALUE '2'.
  6504             88  LA-TEXT-DATA           VALUE '3'.
  6505             88  LA-FORM-CONTROL-HDR    VALUE '4'.
  6506         16  LA-LINE-SEQ-NO          PIC S9(4)     COMP.
  6507
  6508     12  LA-CONTROL-BY-TYPE.
  6509         16  LA-COMPANY-CD-A1        PIC X.
  6510         16  LA-RECORD-TYPE-A1       PIC X.
  6511         16  LA-ARCHIVE-NO-A1        PIC S9(8)     COMP.
  6512         16  LA-LINE-SEQ-NO-A1       PIC S9(4)     COMP.
  6513
  6514     12  LA-TEXT-RECORD.
  6515         16  LA-SKIP-CONTROL         PIC XX.
  6516             88  NO-LINES-SKIPPED       VALUE SPACES.
  6517             88  SKIP-TO-NEXT-PAGE      VALUE '99'.
  6518         16  LA-TEXT-LINE            PIC X(70).
  6519
  6520     12  LA-ADDRESS-RECORD  REDEFINES  LA-TEXT-RECORD.
  6521         16  FILLER                  PIC XX.
  6522         16  LA-ADDRESS-LINE         PIC X(30).
  6523         16  FILLER                  PIC X(40).
  6524
  6525     12  LA-HEADER-RECORD  REDEFINES  LA-TEXT-RECORD.
  6526         16  FILLER                  PIC XX.
  6527         16  LA-CARRIER              PIC X.
  6528         16  LA-CLAIM-NO             PIC X(7).
  6529         16  LA-CERT-NO.
  6530             20  LA-CERT-PRIME       PIC X(10).
  6531             20  LA-CERT-SFX         PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 122
* EL130.cbl
  6532         16  LA-NO-OF-COPIES         PIC S9.
  6533         16  LA-RESEND-DATE          PIC XX.
  6534         16  LA-PROCESSOR-CD         PIC X(4).
  6535         16  LA-CREATION-DT          PIC XX.
  6536         16  LA-INITIAL-PRINT-DATE   PIC XX.
  6537         16  LA-RESEND-PRINT-DATE    PIC XX.
  6538         16  LA-CORR-TRLR-SEQ        PIC S9(4)    COMP.
  6539         16  LA-1ST-RESEND-PRINT-DT  PIC XX.
  6540*
  6541* -----  16  LA-DMD-ADDITIONAL-FIELDS.
  6542*   I        20  LA-DMD-LETTER-FORM      PIC X(4).
  6543*   I        20  LA-DMD-PROD-CODE        PIC XX.
  6544*   I        20  LA-DMD-RES-ST           PIC XX.
  6545*   I        20  LA-DMD-CORR-TRLR-SEQ    PIC S9(4)    COMP.
  6546*   I        20  LA-DMD-LETTER-STATUS    PIC X.
  6547*  NEW           88  LA-DMD-LETTER-ONLINE   VALUE '1'.
  6548*  DMD           88  LA-DMD-LETTER-PURGED   VALUE '2'.
  6549*  CHGS          88  LA-DMD-LETTER-RELOADED VALUE '3'.
  6550*   I        20  LA-DMD-LETTER-PURGE-DT  PIC XX.
  6551*   I        20  LA-DMD-LETTER-RELOAD-DT PIC XX.
  6552*   I        20  LA-DMD-UND-CODE         PIC XX.
  6553*   I        20  LA-DMD-BEN-CODE         PIC XX.
  6554*   V    16  FILLER                  PIC X(15).
  6555* -----
  6556*
  6557* REINSERTED  CSO  MODS
  6558*
  6559         16  FILLER.
  6560             20  FILLER                  PIC X(29).
  6561             20  LA-CSO-LETTER-STATUS    PIC X.
  6562                 88  LA-CSO-LETTER-ONLINE   VALUE '1'.
  6563                 88  LA-CSO-LETTER-PURGED   VALUE '2'.
  6564                 88  LA-CSO-LETTER-RELOADED VALUE '3'.
  6565             20  LA-CSO-LETTER-PURGE-DT  PIC XX.
  6566             20  LA-CSO-LETTER-RELOAD-DT PIC XX.
  6567*
  6568
  6569     12  LA-FORM-CONTROL-HEADER REDEFINES  LA-TEXT-RECORD.
  6570         16  FILLER                  PIC XX.
  6571         16  LA4-CARRIER             PIC X.
  6572         16  LA4-CLAIM-NO            PIC X(7).
  6573         16  LA4-CERT-NO.
  6574             20  LA4-CERT-PRIME      PIC X(10).
  6575             20  LA4-CERT-SFX        PIC X.
  6576         16  LA4-NO-OF-COPIES        PIC S9.
  6577         16  LA4-RESEND-DATE         PIC XX.
  6578         16  LA4-PROCESSOR-CD        PIC X(4).
  6579         16  LA4-CREATION-DT         PIC XX.
  6580         16  LA4-INITIAL-PRINT-DATE  PIC XX.
  6581         16  LA4-RESEND-PRINT-DATE   PIC XX.
  6582         16  LA4-FORM-TRLR-SEQ       PIC S9(4)    COMP.
  6583         16  LA4-FORM-TYPE           PIC X.
  6584             88  LA4-INITIAL-FORM    VALUE '1'.
  6585             88  LA4-PROGRESS-FORM   VALUE '2'.
  6586         16  LA4-FORM-REM-PRINT-DT   PIC X(02).
  6587         16  LA4-STATE               PIC X(02).
  6588         16  FILLER                  PIC X(31).
  6589******************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 123
* EL130.cbl
  6591*    COPY ERCREIN.
  6592******************************************************************
  6593*                                                                *
  6594*                            ERCREIN                             *
  6595*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6596*                            VMOD=2.010                          *
  6597*                                                                *
  6598*   ONLINE CREDIT SYSTEM                                         *
  6599*                                                                *
  6600*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *
  6601*                                                                *
  6602*   FILE TYPE = VSAM,KSDS                                        *
  6603*   RECORD SIZE = 4000  RECFORM = FIXED                          *
  6604*                                                                *
  6605*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *
  6606*       ALTERNATE PATH = NONE                                    *
  6607*                                                                *
  6608*   LOG = NO                                                     *
  6609*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6610*                                                                *
  6611******************************************************************
  6612*                   C H A N G E   L O G
  6613*
  6614* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6615*-----------------------------------------------------------------
  6616*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6617* EFFECTIVE    NUMBER
  6618*-----------------------------------------------------------------
  6619* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
  6620* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
  6621******************************************************************
  6622 01  REINSURANCE-RECORD.
  6623     12  RE-RECORD-ID                      PIC XX.
  6624         88  VALID-RE-ID                      VALUE 'RE'.
  6625
  6626     12  RE-CONTROL-PRIMARY.
  6627         16  RE-COMPANY-CD                 PIC X.
  6628         16  RE-KEY.
  6629             20  RE-CODE                   PIC X.
  6630                 88  RE-TABLE-RECORD          VALUE 'A'.
  6631                 88  RE-COMPANY-RECORD        VALUE 'B'.
  6632             20  RE-TABLE                  PIC XXX.
  6633             20  FILLER                    PIC XXX.
  6634         16  RE-COMPANY-KEY REDEFINES RE-KEY.
  6635             20  FILLER                    PIC X.
  6636             20  RE-COMPANY.
  6637                 24  RE-COMP-PRIME         PIC XXX.
  6638                 24  RE-COMP-SUB           PIC XXX.
  6639
  6640     12  RE-MAINT-INFORMATION.
  6641         16  RE-LAST-MAINT-DT              PIC XX.
  6642         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6643         16  RE-LAST-MAINT-USER            PIC X(4).
  6644         16  FILLER                        PIC X(10).
  6645
  6646     12  RE-TABLE-DATA.
  6647         16  RE-100-COMP                   PIC 99.
  6648
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 124
* EL130.cbl
  6649         16  RE-COMP-INFO    OCCURS 30 TIMES.
  6650             20  RE-REI-COMP-NO.
  6651                 24  RE-REI-COMP           PIC XXX.
  6652                 24  RE-REI-COMP-SUB       PIC XXX.
  6653             20  RE-LF-QC                  PIC X.
  6654             20  RE-AH-QC                  PIC X.
  6655             20  RE-LO-DATE                PIC 9(11)     COMP-3.
  6656             20  RE-HI-DATE                PIC 9(11)     COMP-3.
  6657             20  RE-LFAGE-LO               PIC 99.
  6658             20  RE-LFAGE-HI               PIC 99.
  6659             20  RE-AHAGE-LO               PIC 99.
  6660             20  RE-AHAGE-HI               PIC 99.
  6661             20  RE-LFTRM-LO               PIC S999       COMP-3.
  6662             20  RE-LFTRM-HI               PIC S999       COMP-3.
  6663             20  RE-AHTRM-LO               PIC S999       COMP-3.
  6664             20  RE-AHTRM-HI               PIC S999       COMP-3.
  6665             20  RE-LF-PCT                 PIC S9V9999    COMP-3.
  6666             20  RE-AH-PCT                 PIC S9V9999    COMP-3.
  6667             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3.
  6668             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3.
  6669             20  RE-LF-LO                  PIC S9(9)V99   COMP-3.
  6670             20  RE-LF-HI                  PIC S9(9)V99   COMP-3.
  6671             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3.
  6672             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3.
  6673             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3.
  6674             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3.
  6675             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3.
  6676             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3.
  6677             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3.
  6678             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3.
  6679             20  RE-LF-BEN-CODE            PIC X.
  6680             20  RE-AH-BEN-CODE            PIC X.
  6681             20  RE-INTERACTIVE            PIC X.
  6682             20  RE-REMAINING              PIC X.
  6683             20  RE-LF-RUNOFF-SW           PIC X.
  6684             20  RE-AH-RUNOFF-SW           PIC X.
  6685             20  FILLER                    PIC X(19).
  6686
  6687         16  RE-COMP-INFO-END              PIC X(6).
  6688         16  RE-NSP-ST-CD-LF               PIC XX.
  6689         16  RE-NSP-ST-CD-AH               PIC XX.
  6690         16  RE-TABLE-CARRIER-SECURITY     PIC X.
  6691             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.
  6692
  6693         16  FILLER                        PIC X(27).
  6694
  6695     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.
  6696         16  RE-NAME                       PIC X(30).
  6697         16  RE-LF-PE                      PIC X.
  6698         16  RE-AH-PE                      PIC X.
  6699         16  RE-LF-FEE                     PIC S9V9999    COMP-3.
  6700         16  RE-AH-FEE                     PIC S9V9999    COMP-3.
  6701         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3.
  6702         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3.
  6703         16  RE-PRT-ST                     PIC X.
  6704         16  RE-PRT-OW                     PIC X.
  6705         16  RE-MORT-CODE                  PIC X(4).
  6706         16  RE-CLAIM-CODE                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 125
* EL130.cbl
  6707         16  RE-ZERO-LF-FEE                PIC X.
  6708         16  RE-ZERO-AH-FEE                PIC X.
  6709         16  RE-CEDE-NAME                  PIC X(30).
  6710         16  RE-LF-COMM                    PIC X.
  6711         16  RE-AH-COMM                    PIC X.
  6712         16  RE-LF-TAX                     PIC X.
  6713         16  RE-AH-TAX                     PIC X.
  6714         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.
  6715         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3.
  6716         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3.
  6717
  6718         16  RE-COMP-CARRIER-SECURITY      PIC X.
  6719             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.
  6720
  6721         16  RE-LF-CEDING-FEE-BRACKETS.
  6722             20  RE-LF-FEE-METHOD          PIC X.
  6723                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.
  6724                 88  RE-LF-FEE-METHOD-1          VALUE '1'.
  6725                 88  RE-LF-FEE-METHOD-2          VALUE '2'.
  6726                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.
  6727             20  RE-LF-FEE-BASIS           PIC X.
  6728                 88  RE-LF-GROSS-CEDED             VALUE '1'.
  6729                 88  RE-LF-NET-CEDED               VALUE '2'.
  6730                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.
  6731                 88  RE-LF-NET-WRITTEN             VALUE '4'.
  6732                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.
  6733                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.
  6734                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.
  6735                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.
  6736             20  FILLER                    PIC XXX.
  6737             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.
  6738                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  6739                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  6740
  6741         16  RE-AH-CEDING-FEE-BRACKETS.
  6742             20  RE-AH-FEE-METHOD          PIC X.
  6743                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.
  6744                 88  RE-AH-FEE-METHOD-1          VALUE '1'.
  6745                 88  RE-AH-FEE-METHOD-2          VALUE '2'.
  6746                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.
  6747             20  RE-AH-FEE-BASIS           PIC X.
  6748                 88  RE-AH-GROSS-CEDED             VALUE '1'.
  6749                 88  RE-AH-NET-CEDED               VALUE '2'.
  6750                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.
  6751                 88  RE-AH-NET-WRITTEN             VALUE '4'.
  6752                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.
  6753                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.
  6754                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.
  6755                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.
  6756             20  FILLER                    PIC XXX.
  6757             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.
  6758                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  6759                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  6760
  6761         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.
  6762
  6763         16  RE-OLD-CEDING-STMT            PIC X.
  6764
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 126
* EL130.cbl
  6765         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3.
  6766         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3.
  6767         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3.
  6768         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3.
  6769         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3.
  6770         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3.
  6771         16  RE-REINS-GROUPING-CODE        PIC X(6).
  6772         16  RE-MORT-SW                    PIC X.
  6773         16  RE-CEDING-TYPE-FLAG           PIC X.
  6774             88  RE-NO-CESSION-TYPE                VALUE ' '.
  6775             88  RE-CEDED                          VALUE 'C'.
  6776             88  RE-ASSUMED                        VALUE 'A'.
  6777             88  RE-PHANTOM                        VALUE 'P'.
  6778
  6779         16  RE-CEDING-STMT-OPT-A          PIC X.
  6780             88  REPORT-A-WANTED    VALUE ' ' 'Y'.
  6781         16  RE-CEDING-STMT-OPT-B          PIC X.
  6782             88  REPORT-B-WANTED    VALUE ' ' 'Y'.
  6783         16  RE-CEDING-STMT-OPT-C          PIC X.
  6784             88  REPORT-C-WANTED    VALUE ' ' 'Y'.
  6785         16  RE-CEDING-STMT-OPT-D          PIC X.
  6786             88  REPORT-D-WANTED    VALUE ' ' 'Y'.
  6787         16  RE-CEDING-STMT-OPT-E          PIC X.
  6788             88  REPORT-E-WANTED    VALUE ' ' 'Y'.
  6789
  6790         16  RE-PRT-CRSV                   PIC X.
  6791
  6792         16  RE-GL-CENTER                  PIC X(4).
  6793
  6794         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.
  6795
  6796         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.
  6797
  6798         16  RE-EARN-STOP-CODE             PIC X.
  6799             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.
  6800             88  STOP-AH-EARNING    VALUE 'A' 'B'.
  6801
  6802         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  6803             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  6804
  6805         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  6806         16  FILLER                        PIC X(2281).
  6807
  6808         16  RE-DESC OCCURS 18 TIMES       PIC X(79).
  6809
  6810******************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 127
* EL130.cbl
  6812*    COPY ERCMAIL.
  6813******************************************************************
  6814*                                                                *
  6815*                                                                *
  6816*                            ERCMAIL                             *
  6817*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6818*                            VMOD=2.003                          *
  6819*                                                                *
  6820*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  6821*                                                                *
  6822*   FILE TYPE = VSAM,KSDS                                        *
  6823*   RECORD SIZE = 374   RECFORM = FIX                            *
  6824*                                                                *
  6825*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  6826*   ALTERNATE PATH    = NOT USED                                 *
  6827*                                                                *
  6828*   LOG = YES                                                    *
  6829*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6830******************************************************************
  6831*                   C H A N G E   L O G
  6832*
  6833* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6834*-----------------------------------------------------------------
  6835*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6836* EFFECTIVE    NUMBER
  6837*-----------------------------------------------------------------
  6838* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  6839* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  6840* 111108                   PEMA  ADD CRED BENE ADDR2
  6841******************************************************************
  6842
  6843 01  MAILING-DATA.
  6844     12  MA-RECORD-ID                      PIC XX.
  6845         88  VALID-MA-ID                       VALUE 'MA'.
  6846
  6847     12  MA-CONTROL-PRIMARY.
  6848         16  MA-COMPANY-CD                 PIC X.
  6849         16  MA-CARRIER                    PIC X.
  6850         16  MA-GROUPING.
  6851             20  MA-GROUPING-PREFIX        PIC XXX.
  6852             20  MA-GROUPING-PRIME         PIC XXX.
  6853         16  MA-STATE                      PIC XX.
  6854         16  MA-ACCOUNT.
  6855             20  MA-ACCOUNT-PREFIX         PIC X(4).
  6856             20  MA-ACCOUNT-PRIME          PIC X(6).
  6857         16  MA-CERT-EFF-DT                PIC XX.
  6858         16  MA-CERT-NO.
  6859             20  MA-CERT-PRIME             PIC X(10).
  6860             20  MA-CERT-SFX               PIC X.
  6861
  6862     12  FILLER                            PIC XX.
  6863
  6864     12  MA-ACCESS-CONTROL.
  6865         16  MA-SOURCE-SYSTEM              PIC XX.
  6866             88  MA-FROM-CREDIT                VALUE 'CR'.
  6867             88  MA-FROM-VSI                   VALUE 'VS'.
  6868             88  MA-FROM-WARRANTY              VALUE 'WA'.
  6869             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 128
* EL130.cbl
  6870         16  MA-RECORD-ADD-DT              PIC XX.
  6871         16  MA-RECORD-ADDED-BY            PIC XXXX.
  6872         16  MA-LAST-MAINT-DT              PIC XX.
  6873         16  MA-LAST-MAINT-BY              PIC XXXX.
  6874         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  6875
  6876     12  MA-PROFILE-INFO.
  6877         16  MA-QUALIFY-CODE-1             PIC XX.
  6878         16  MA-QUALIFY-CODE-2             PIC XX.
  6879         16  MA-QUALIFY-CODE-3             PIC XX.
  6880         16  MA-QUALIFY-CODE-4             PIC XX.
  6881         16  MA-QUALIFY-CODE-5             PIC XX.
  6882
  6883         16  MA-INSURED-LAST-NAME          PIC X(15).
  6884         16  MA-INSURED-FIRST-NAME         PIC X(10).
  6885         16  MA-INSURED-MIDDLE-INIT        PIC X.
  6886         16  MA-INSURED-ISSUE-AGE          PIC 99.
  6887         16  MA-INSURED-BIRTH-DT           PIC XX.
  6888         16  MA-INSURED-SEX                PIC X.
  6889             88  MA-SEX-MALE                   VALUE 'M'.
  6890             88  MA-SEX-FEMALE                 VALUE 'F'.
  6891         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  6892
  6893         16  MA-ADDRESS-CORRECTED          PIC X.
  6894         16  MA-JOINT-BIRTH-DT             PIC XX.
  6895*        16  FILLER                        PIC X(12).
  6896
  6897         16  MA-ADDRESS-LINE-1             PIC X(30).
  6898         16  MA-ADDRESS-LINE-2             PIC X(30).
  6899         16  MA-CITY-STATE.
  6900             20  MA-CITY                   PIC X(28).
  6901             20  MA-ADDR-STATE             PIC XX.
  6902         16  MA-ZIP.
  6903             20  MA-ZIP-CODE.
  6904                 24  MA-ZIP-CODE-1ST       PIC X(1).
  6905                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6906                 24  FILLER                PIC X(4).
  6907             20  MA-ZIP-PLUS4              PIC X(4).
  6908         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  6909             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  6910             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  6911             20  FILLER                    PIC X(3).
  6912
  6913         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  6914
  6915         16  FILLER                        PIC XXX.
  6916*        16  FILLER                        PIC X(10).
  6917
  6918     12  MA-CRED-BENE-INFO.
  6919         16  MA-CRED-BENE-NAME                 PIC X(25).
  6920         16  MA-CRED-BENE-ADDR                 PIC X(30).
  6921         16  MA-CRED-BENE-ADDR2                PIC X(30).
  6922         16  MA-CRED-BENE-CTYST.
  6923             20  MA-CRED-BENE-CITY             PIC X(28).
  6924             20  MA-CRED-BENE-STATE            PIC XX.
  6925         16  MA-CRED-BENE-ZIP.
  6926             20  MA-CB-ZIP-CODE.
  6927                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 129
* EL130.cbl
  6928                     88  MA-CB-CANADIAN-POST-CODE
  6929                                           VALUE 'A' THRU 'Z'.
  6930                 24  FILLER                    PIC X(4).
  6931             20  MA-CB-ZIP-PLUS4               PIC X(4).
  6932         16  MA-CB-CANADIAN-POSTAL-CODE
  6933                            REDEFINES MA-CRED-BENE-ZIP.
  6934             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  6935             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  6936             20  FILLER                        PIC X(3).
  6937     12  MA-POST-CARD-MAIL-DATA.
  6938         16  MA-MAIL-DATA OCCURS 7.
  6939             20  MA-MAIL-TYPE              PIC X.
  6940                 88  MA-12MO-MAILING           VALUE '1'.
  6941                 88  MA-EXP-MAILING            VALUE '2'.
  6942             20  MA-MAIL-STATUS            PIC X.
  6943                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  6944                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  6945                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  6946             20  MA-MAIL-DATE              PIC XX.
  6947     12  FILLER                            PIC XX.
  6948     12  FILLER                            PIC XX.
  6949*    12  FILLER                            PIC X(30).
  6950******************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 130
* EL130.cbl
  6952*    COPY ELCCRTT.
  6953******************************************************************
  6954*                                                                *
  6955*                            ELCCRTT.                            *
  6956*                                                                *
  6957*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  6958*                                                                *
  6959*   FILE TYPE = VSAM,KSDS                                        *
  6960*   RECORD SIZE = 552  RECFORM = FIXED                           *
  6961*                                                                *
  6962*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  6963*                                                                *
  6964*   LOG = YES                                                    *
  6965*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6966******************************************************************
  6967*                   C H A N G E   L O G
  6968*
  6969* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6970*-----------------------------------------------------------------
  6971*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6972* EFFECTIVE    NUMBER
  6973*-----------------------------------------------------------------
  6974* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  6975* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  6976* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  6977* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  6978* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  6979******************************************************************
  6980
  6981 01  CERTIFICATE-TRAILERS.
  6982     12  CS-RECORD-ID                      PIC XX.
  6983         88  VALID-CS-ID                      VALUE 'CS'.
  6984
  6985     12  CS-CONTROL-PRIMARY.
  6986         16  CS-COMPANY-CD                 PIC X.
  6987         16  CS-CARRIER                    PIC X.
  6988         16  CS-GROUPING                   PIC X(6).
  6989         16  CS-STATE                      PIC XX.
  6990         16  CS-ACCOUNT                    PIC X(10).
  6991         16  CS-CERT-EFF-DT                PIC XX.
  6992         16  CS-CERT-NO.
  6993             20  CS-CERT-PRIME             PIC X(10).
  6994             20  CS-CERT-SFX               PIC X.
  6995         16  CS-TRAILER-TYPE               PIC X.
  6996             88  COMM-TRLR           VALUE 'A'.
  6997             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  6998             88  CERT-DATA-TRLR      VALUE 'C'.
  6999
  7000     12  CS-DATA-AREA                      PIC X(516).
  7001
  7002     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  7003         16  CS-BANK-COMMISSION-AREA.
  7004             20  CS-BANK-COMMS       OCCURS 10.
  7005                 24  CS-AGT                PIC X(10).
  7006                 24  CS-COM-TYP            PIC X.
  7007                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  7008                 24  CS-RECALC-LV-INDIC    PIC X.
  7009                 24  FILLER                PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 131
* EL130.cbl
  7010         16  FILLER                        PIC X(256).
  7011
  7012     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  7013****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  7014****  1ST OCCURANCE IS PRIMARY, 2ND IS SECONDARY INSURED
  7015         16  CS-MB-CLAIM-DATA OCCURS 2.
  7016             20  FILLER OCCURS 10.
  7017                 24  CS-CLAIM-TYPE         PIC X.
  7018                     88  CS-AH-CLM           VALUE 'A'.
  7019                     88  CS-IU-CLM           VALUE 'I'.
  7020                     88  CS-GP-CLM           VALUE 'G'.
  7021                     88  CS-LF-CLM           VALUE 'L'.
  7022                     88  CS-PR-CLM           VALUE 'P'.
  7023                 24  CS-BANK               PIC S999 COMP-3.
  7024                 24  CS-NO-OF-CLAIMS       PIC S999 COMP-3.
  7025                 24  CS-DAYS-PAID          PIC S9(7) COMP-3.
  7026                 24  CS-TOTAL-PAID         PIC S9(9)V99 COMP-3.
  7027         16  FILLER                        PIC X(216).
  7028     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  7029         16  CS-VIN-NUMBER                 PIC X(17).
  7030         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  7031         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  7032         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  7033         16  FILLER                        PIC X(496).
  7034******************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 132
* EL130.cbl
  7036
  7037 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CLAIM-MASTER
  7038                          CONTROL-FILE CERTIFICATE-MASTER
  7039                          ACCOUNT-MASTER ACTIVITY-TRAILERS
  7040                          BENEFICIARY-MASTER
  7041                          DAILY-ACTIVITY-RECORD ACTIVITY-QUE
  7042                          LETTER-ARCHIVE REINSURANCE-RECORD
  7043                          MAILING-DATA CERTIFICATE-TRAILERS.
  7044 0000-DFHEXIT SECTION.
  7045     MOVE '9#                    $   ' TO DFHEIV0.
  7046     MOVE 'EL130' TO DFHEIV1.
  7047     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7048     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  7049     MOVE '5'                    TO DC-OPTION-CODE.
  7050     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  7051     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  7052     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  7053
  7054     IF EIBCALEN = ZERO
  7055         GO TO 8800-UNAUTHORIZED-ACCESS
  7056     END-IF.
  7057
  7058     MOVE DFHCOMMAREA TO PROGRAM-INTERFACE-BLOCK.
  7059     MOVE EIBTRMID               TO QID-TERM.
  7060     MOVE +2                     TO EMI-NUMBER-OF-LINES
  7061     move spaces                 to emi-error-lines
  7062     MOVE '2'                    TO EMI-SWITCH2.
  7063     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  7064     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  7065
  7066
  7067* EXEC CICS HANDLE CONDITION
  7068*        QIDERR     (0100-TEST-ENTRY)
  7069*        MAPFAIL    (8100-SEND-INITIAL-MAP)
  7070*        PGMIDERR   (9600-PGMID-ERROR)
  7071*        TERMIDERR  (8820-TERM-ERROR)
  7072*        TRANSIDERR (8830-TRAN-ERROR)
  7073*        ERROR      (9990-ABEND)
  7074*    END-EXEC.
  7075*    MOVE '"$N?L[\.              ! " #00007062' TO DFHEIV0
  7076     MOVE X'22244E3F4C5B5C2E20202020' TO DFHEIV0(1:12)
  7077     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7078     MOVE X'2220233030303037303632' TO DFHEIV0(25:11)
  7079     CALL 'kxdfhei1' USING DFHEIV0
  7080     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7081
  7082
  7083     IF PI-RETURN-TO-PROGRAM = THIS-PGM  OR
  7084        PI-CALLING-PROGRAM   = XCTL-6592
  7085         MOVE PI-CALLING-PROGRAM TO RETURNED-FROM
  7086     ELSE
  7087         MOVE SPACES             TO RETURNED-FROM
  7088     END-IF.
  7089
  7090     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  7091         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  7092             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  7093             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 133
* EL130.cbl
  7094             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  7095             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  7096             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  7097             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  7098             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  7099             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  7100         ELSE
  7101             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  7102             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  7103             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  7104             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  7105             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  7106             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  7107             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  7108             MOVE SPACES               TO PI-SAVED-PROGRAM-6
  7109         END-IF
  7110     END-IF.
  7111
  7112     IF EIBTRNID = TRANS-ID
  7113         IF EIBAID = DFHCLEAR
  7114             GO TO 9400-CLEAR
  7115         ELSE
  7116             GO TO 0200-RECEIVE
  7117         END-IF
  7118     END-IF.
  7119
  7120     IF RETURNED-FROM NOT = SPACES
  7121         GO TO 0600-RECOVER-TEMP-STORAGE
  7122     END-IF.
  7123
  7124     MOVE LOW-VALUES TO EL130AO.
  7125     move zeros to pi-dcc-max-amt
  7126                   pi-dcc-max-benefits
  7127
  7128
  7129
  7130* EXEC CICS DELETEQ TS
  7131*         QUEUE   (QID)
  7132*    END-EXEC.
  7133*    MOVE '*&                    #   #00007117' TO DFHEIV0
  7134     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  7135     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7136     MOVE X'2020233030303037313137' TO DFHEIV0(25:11)
  7137     CALL 'kxdfhei1' USING DFHEIV0,
  7138           QID,
  7139           DFHEIV99
  7140     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7141
  7142
  7143 0100-TEST-ENTRY.
  7144     IF PI-RETURN-TO-PROGRAM = XCTL-127 OR XCTL-727
  7145         GO TO 0650-FROM-EL127
  7146     ELSE
  7147         MOVE ZEROS              TO PI-CERT-SELECT-CNT
  7148                                    PI-CERT-PROCESSED
  7149                                    PI-LETTER-ERROR-CODE
  7150     END-IF.
  7151
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 134
* EL130.cbl
  7152     IF PI-RETURN-TO-PROGRAM = XCTL-132
  7153         GO TO 0640-FROM-EL132
  7154     END-IF.
  7155
  7156     GO TO 8100-SEND-INITIAL-MAP.
  7157
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 135
* EL130.cbl
  7159 0200-RECEIVE.
  7160     MOVE LOW-VALUES             TO EL130AI.
  7161
  7162     IF PI-PROCESSOR-ID = 'LGXX'
  7163*        NEXT SENTENCE
  7164         CONTINUE
  7165     ELSE
  7166
  7167* EXEC CICS READQ TS
  7168*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  7169*            INTO    (SECURITY-CONTROL)
  7170*            LENGTH  (SC-COMM-LENGTH)
  7171*            ITEM    (SC-ITEM)
  7172*        END-EXEC
  7173*    MOVE '*$II   L              ''   #00007144' TO DFHEIV0
  7174     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  7175     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7176     MOVE X'2020233030303037313434' TO DFHEIV0(25:11)
  7177     CALL 'kxdfhei1' USING DFHEIV0,
  7178           PI-SECURITY-TEMP-STORE-ID,
  7179           SECURITY-CONTROL,
  7180           SC-COMM-LENGTH,
  7181           SC-ITEM,
  7182           DFHEIV99,
  7183           DFHEIV99
  7184     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7185         MOVE SC-CLAIMS-DISPLAY (1)   TO  PI-DISPLAY-CAP
  7186         MOVE SC-CLAIMS-UPDATE  (1)   TO  PI-MODIFY-CAP
  7187         IF NOT DISPLAY-CAP
  7188             MOVE 'READ'              TO  SM-READ
  7189             PERFORM 9995-SECURITY-VIOLATION
  7190             MOVE ER-0070             TO  EMI-ERROR
  7191             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7192             GO TO 8100-SEND-INITIAL-MAP
  7193         END-IF
  7194     END-IF.
  7195
  7196     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  7197         MOVE ER-7008 TO EMI-ERROR
  7198         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7199         MOVE -1 TO MAINTL
  7200         GO TO 8200-SEND-DATAONLY
  7201     END-IF.
  7202
  7203
  7204
  7205* EXEC CICS RECEIVE
  7206*         MAP     (MAP-NAME)
  7207*         MAPSET  (MAPSET-NAME)
  7208*         INTO    (EL130AI)
  7209*    END-EXEC.
  7210     MOVE LENGTH OF
  7211      EL130AI
  7212       TO DFHEIV11
  7213*    MOVE '8"T I  L              ''   #00007169' TO DFHEIV0
  7214     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  7215     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7216     MOVE X'2020233030303037313639' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 136
* EL130.cbl
  7217     CALL 'kxdfhei1' USING DFHEIV0,
  7218           MAP-NAME,
  7219           EL130AI,
  7220           DFHEIV11,
  7221           MAPSET-NAME,
  7222           DFHEIV99,
  7223           DFHEIV99
  7224     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7225
  7226
  7227     IF NOT PI-NO-CARRIER-SECURITY
  7228        MOVE +1                  TO CLMCARRL
  7229        MOVE PI-CARRIER-SECURITY TO CLMCARRI
  7230     END-IF.
  7231
  7232     IF ENTERPFL = ZERO
  7233         GO TO 0300-CHECK-PFKEYS
  7234     END-IF.
  7235
  7236     IF EIBAID NOT = DFHENTER
  7237         MOVE ER-0004            TO EMI-ERROR
  7238         GO TO 0320-INPUT-ERROR
  7239     END-IF.
  7240
  7241     IF (ENTERPFI NUMERIC) AND (ENTERPFI GREATER 0 AND LESS 25)
  7242         MOVE PF-VALUES (ENTERPFI) TO EIBAID
  7243     ELSE
  7244         MOVE ER-0029            TO EMI-ERROR
  7245         GO TO 0320-INPUT-ERROR
  7246     END-IF.
  7247
  7248 0300-CHECK-PFKEYS.
  7249     IF EIBAID = DFHPF23
  7250         GO TO 8810-PF23
  7251     END-IF.
  7252
  7253     IF EIBAID = DFHPF24
  7254         GO TO 9200-RETURN-MAIN-MENU
  7255     END-IF.
  7256
  7257     IF EIBAID = DFHPF12
  7258         GO TO 9500-PF12
  7259     END-IF.
  7260
  7261     IF EIBAID = DFHPF3
  7262         MOVE SPACES              TO MAINTI
  7263         MOVE ZEROS               TO MAINTL
  7264         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  7265         MOVE XCTL-127            TO PGM-NAME
  7266         GO TO 9300-XCTL
  7267     END-IF.
  7268
  7269     IF EIBAID = DFHPF4
  7270         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  7271         MOVE XCTL-132            TO PGM-NAME
  7272         GO TO 9300-XCTL
  7273     END-IF.
  7274
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 137
* EL130.cbl
  7275     IF EIBAID = DFHPF13
  7276         IF PI-ACCESS-TO-BOTH-SYSTEMS
  7277             PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  7278             MOVE PI-CARRIER          TO  PI-CR-CARRIER
  7279             MOVE PI-GROUPING         TO  PI-CR-GROUPING
  7280             MOVE PI-STATE            TO  PI-CR-STATE
  7281             MOVE PI-ACCOUNT          TO  PI-CR-ACCOUNT
  7282             MOVE XCTL-650            TO  PGM-NAME
  7283             GO TO 9300-XCTL
  7284         ELSE
  7285             MOVE -1                  TO  ENTERPFL
  7286             MOVE ER-2566             TO  EMI-ERROR
  7287             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7288             GO TO 8100-SEND-INITIAL-MAP
  7289         END-IF
  7290     END-IF.
  7291
  7292     IF EIBAID = DFHPF5
  7293         IF PI-CERT-PROCESSED LESS THAN PI-CERT-SELECT-CNT
  7294             ADD +1 TO PI-CERT-PROCESSED
  7295             GO TO 0650-FROM-EL127
  7296         ELSE
  7297             MOVE ER-7686         TO EMI-ERROR
  7298             GO TO 0320-INPUT-ERROR
  7299         END-IF
  7300     END-IF.
  7301
  7302     IF EIBAID = DFHPF7 OR DFHPF8 OR DFHPF9
  7303         GO TO 0800-TEST-PREVIOUS-CONTROL
  7304     END-IF.
  7305
  7306     IF PI-HAS-CLAS-IC-CRDTCRD
  7307         IF EIBAID = DFHPF10
  7308             MOVE XCTL-725          TO PGM-NAME
  7309             GO TO 9300-XCTL
  7310         END-IF
  7311     END-IF.
  7312
  7313     IF EIBAID = DFHPF14
  7314         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  7315         MOVE SPACES              TO PI-EL659-TO-EL130-CNTRL
  7316         MOVE XCTL-659            TO PGM-NAME
  7317         GO TO 9300-XCTL
  7318     END-IF.
  7319
  7320     IF EIBAID = DFHPF15
  7321         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  7322         MOVE XCTL-114            TO PGM-NAME
  7323         GO TO 9300-XCTL
  7324     END-IF.
  7325
  7326     IF EIBAID = DFHPF11
  7327        GO TO 0600-RECOVER-TEMP-STORAGE
  7328     END-IF
  7329     IF EIBAID = DFHENTER OR DFHPF6 OR DFHPF11
  7330         GO TO 0330-EDIT-DATA
  7331     END-IF.
  7332
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 138
* EL130.cbl
  7333     MOVE ER-0029                TO EMI-ERROR.
  7334
  7335 0320-INPUT-ERROR.
  7336     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7337
  7338     MOVE AL-UNBON               TO ENTERPFA.
  7339
  7340     IF ENTERPFL = ZERO
  7341         MOVE -1                 TO MAINTL
  7342     ELSE
  7343         MOVE -1                 TO ENTERPFL
  7344     END-IF.
  7345
  7346     GO TO 8200-SEND-DATAONLY.
  7347
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 139
* EL130.cbl
  7349 0330-EDIT-DATA.
  7350
  7351     IF MAINTI = 'S'
  7352         IF PRTOPTL GREATER THAN 0
  7353             IF PRTOPTI NOT = 'N' AND 'L'
  7354                 MOVE AL-UABON   TO  PRTOPTA
  7355                 MOVE -1         TO  PRTOPTL
  7356                 MOVE ER-0334    TO  EMI-ERROR
  7357                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7358                 GO TO 8200-SEND-DATAONLY
  7359             ELSE
  7360                 IF PRTOPTI = 'L'
  7361                     GO TO 0400-CREATE-ELACTQ
  7362                 ELSE
  7363                     GO TO 0480-PRINT-NOW
  7364                 END-IF
  7365             END-IF
  7366         ELSE
  7367             GO TO 1000-SHOW-CLAIM
  7368         END-IF
  7369     END-IF.
  7370
  7371     IF NOT MODIFY-CAP
  7372         MOVE 'UPDATE'       TO  SM-READ
  7373         PERFORM 9995-SECURITY-VIOLATION
  7374         MOVE ER-0070        TO  EMI-ERROR
  7375         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7376         GO TO 8100-SEND-INITIAL-MAP
  7377     END-IF.
  7378
  7379     IF MAINTI = 'D'
  7380         GO TO 2000-DELETE-CLAIM
  7381     END-IF.
  7382
  7383     IF MAINTI = 'A'
  7384         GO TO 3000-ADD-CLAIM
  7385     END-IF.
  7386
  7387     IF MAINTI = 'I'
  7388         GO TO 5000-INCURRED-CHANGE
  7389     END-IF.
  7390
  7391     MOVE ER-0023                TO EMI-ERROR.
  7392     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7393     MOVE -1                     TO MAINTL.
  7394     MOVE AL-UABON               TO MAINTA.
  7395
  7396     GO TO 8200-SEND-DATAONLY.
  7397
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 140
* EL130.cbl
  7399 0400-CREATE-ELACTQ.
  7400     IF CLMNOI   = PI-LAST-CLAIM      AND
  7401        CLMCARRI = PI-LAST-CARR       AND
  7402        CERTNOI  = PI-LAST-CERT-PRIME AND
  7403        SUFXI    = PI-LAST-CERT-SUFX
  7404         MOVE PI-LAST-CLAIM      TO PI-CLAIM-NO
  7405         MOVE PI-LAST-CARR       TO PI-CARRIER
  7406         MOVE PI-LAST-CERT       TO PI-CERT-NO
  7407     ELSE
  7408         MOVE ER-0207            TO EMI-ERROR
  7409         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7410         MOVE -1                 TO MAINTL
  7411         GO TO 8200-SEND-DATAONLY
  7412     END-IF.
  7413
  7414     IF (NOT PI-NO-CARRIER-SECURITY OR
  7415         NOT PI-NO-ACCOUNT-SECURITY)
  7416         MOVE AL-UABON      TO  PRTOPTA
  7417         MOVE -1            TO  PRTOPTL
  7418         MOVE ER-2378       TO  EMI-ERROR
  7419         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7420         GO TO 8200-SEND-DATAONLY
  7421     END-IF.
  7422
  7423     MOVE PI-COMPANY-CD      TO ELACTQ-COMPANY-CD.
  7424     MOVE PI-LAST-CARR       TO ELACTQ-CARRIER.
  7425     MOVE PI-LAST-CLAIM      TO ELACTQ-CLAIM-NO.
  7426     MOVE PI-LAST-CERT       TO ELACTQ-CERT-NO.
  7427
  7428
  7429
  7430* EXEC CICS HANDLE CONDITION
  7431*         NOTFND     (0450-ADD-ELACTQ-RECORD)
  7432*    END-EXEC.
  7433*    MOVE '"$I                   ! # #00007377' TO DFHEIV0
  7434     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7435     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7436     MOVE X'2320233030303037333737' TO DFHEIV0(25:11)
  7437     CALL 'kxdfhei1' USING DFHEIV0
  7438     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7439
  7440
  7441
  7442
  7443* EXEC CICS READ
  7444*         UPDATE
  7445*         DATASET    (ELACTQ-DSID)
  7446*         SET        (ADDRESS OF ACTIVITY-QUE)
  7447*         RIDFLD     (ELACTQ-KEY)
  7448*    END-EXEC.
  7449*    MOVE '&"S        EU         (   #00007382' TO DFHEIV0
  7450     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7451     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7452     MOVE X'2020233030303037333832' TO DFHEIV0(25:11)
  7453     CALL 'kxdfhei1' USING DFHEIV0,
  7454           ELACTQ-DSID,
  7455           DFHEIV20,
  7456           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 141
* EL130.cbl
  7457           ELACTQ-KEY,
  7458           DFHEIV99,
  7459           DFHEIV99,
  7460           DFHEIV99
  7461     SET ADDRESS OF ACTIVITY-QUE TO
  7462         DFHEIV20
  7463     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7464
  7465
  7466     MOVE '2'         TO AQ-PENDING-STATUS-FLAG.
  7467     MOVE +130        TO AQ-LAST-UPDATED-BY.
  7468
  7469
  7470
  7471* EXEC CICS REWRITE
  7472*         DATASET     (ELACTQ-DSID)
  7473*         FROM        (ACTIVITY-QUE)
  7474*    END-EXEC.
  7475     MOVE LENGTH OF
  7476      ACTIVITY-QUE
  7477       TO DFHEIV11
  7478*    MOVE '&& L                  %   #00007393' TO DFHEIV0
  7479     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7480     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7481     MOVE X'2020233030303037333933' TO DFHEIV0(25:11)
  7482     CALL 'kxdfhei1' USING DFHEIV0,
  7483           ELACTQ-DSID,
  7484           ACTIVITY-QUE,
  7485           DFHEIV11,
  7486           DFHEIV99
  7487     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7488
  7489
  7490     GO TO 0470-STATUS-FINISH.
  7491
  7492 0450-ADD-ELACTQ-RECORD.
  7493
  7494
  7495* EXEC CICS GETMAIN
  7496*        SET     (ADDRESS OF ACTIVITY-QUE)
  7497*        LENGTH  (ELACTQ-LENGTH)
  7498*        INITIMG (GETMAIN-SPACE)
  7499*    END-EXEC.
  7500*    MOVE ',"IL                  $   #00007402' TO DFHEIV0
  7501     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7502     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7503     MOVE X'2020233030303037343032' TO DFHEIV0(25:11)
  7504     CALL 'kxdfhei1' USING DFHEIV0,
  7505           DFHEIV20,
  7506           ELACTQ-LENGTH,
  7507           GETMAIN-SPACE
  7508     SET ADDRESS OF ACTIVITY-QUE TO
  7509         DFHEIV20
  7510     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7511
  7512
  7513     MOVE 'AQ'              TO AQ-RECORD-ID.
  7514     MOVE ELACTQ-KEY        TO AQ-CONTROL-PRIMARY.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 142
* EL130.cbl
  7515     MOVE +0                TO AQ-PAYMENT-COUNTER
  7516                               AQ-PMT-UNAPPROVED-COUNT.
  7517     MOVE LOW-VALUES        TO AQ-RESEND-DATE
  7518                               AQ-FOLLOWUP-DATE.
  7519     MOVE '2'               TO AQ-PENDING-STATUS-FLAG.
  7520     MOVE +130              TO AQ-LAST-UPDATED-BY.
  7521
  7522
  7523
  7524* EXEC CICS WRITE
  7525*         DATASET     (ELACTQ-DSID)
  7526*         FROM        (ACTIVITY-QUE)
  7527*         RIDFLD      (ELACTQ-KEY)
  7528*    END-EXEC.
  7529     MOVE LENGTH OF
  7530      ACTIVITY-QUE
  7531       TO DFHEIV11
  7532*    MOVE '&$ L                  ''   #00007418' TO DFHEIV0
  7533     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7534     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7535     MOVE X'2020233030303037343138' TO DFHEIV0(25:11)
  7536     CALL 'kxdfhei1' USING DFHEIV0,
  7537           ELACTQ-DSID,
  7538           ACTIVITY-QUE,
  7539           DFHEIV11,
  7540           ELACTQ-KEY,
  7541           DFHEIV99,
  7542           DFHEIV99
  7543     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7544
  7545
  7546 0470-STATUS-FINISH.
  7547     MOVE AL-UANOF               TO  PRTOPTA
  7548                                     ALTPRTA.
  7549
  7550     MOVE SPACES                 TO  PRTOPTO
  7551                                     ALTPRTO.
  7552
  7553     MOVE ER-0000                TO EMI-ERROR.
  7554     MOVE -1                     TO MAINTL.
  7555     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7556     GO TO 8100-SEND-INITIAL-MAP.
  7557
  7558 0480-PRINT-NOW.
  7559
  7560
  7561* EXEC CICS HANDLE CONDITION
  7562*        TERMIDERR   (8820-TERM-ERROR)
  7563*        TRANSIDERR  (8830-TRAN-ERROR)
  7564*    END-EXEC.
  7565*    MOVE '"$[\                  ! $ #00007438' TO DFHEIV0
  7566     MOVE X'22245B5C2020202020202020' TO DFHEIV0(1:12)
  7567     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7568     MOVE X'2420233030303037343338' TO DFHEIV0(25:11)
  7569     CALL 'kxdfhei1' USING DFHEIV0
  7570     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7571
  7572
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 143
* EL130.cbl
  7573     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
  7574     MOVE '1'                    TO  CNTL-REC-TYPE.
  7575     MOVE SPACES                 TO  CNTL-ACCESS.
  7576     MOVE +0                     TO  CNTL-SEQ-NO.
  7577     MOVE 'CNTL'                 TO  FILE-SWITCH.
  7578
  7579     PERFORM 7970-READ-CNTL THRU 7970-EXIT.
  7580
  7581     IF CF-FORMS-PRINTER-ID = SPACES
  7582         IF ALTPRTL NOT GREATER THAN 0
  7583             MOVE ER-0337        TO  EMI-ERROR
  7584             MOVE -1             TO  ALTPRTL
  7585             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7586             GO TO 8200-SEND-DATAONLY
  7587         END-IF
  7588     END-IF.
  7589
  7590     IF ALTPRTL GREATER THAN 0
  7591         MOVE ALTPRTI            TO  CF-FORMS-PRINTER-ID
  7592     END-IF.
  7593
  7594     MOVE PI-LAST-CLAIM          TO  PI-CLAIM-NO.
  7595     MOVE PI-LAST-CARR           TO  PI-CARRIER.
  7596     MOVE PI-LAST-CERT           TO  PI-CERT-NO.
  7597
  7598
  7599
  7600* EXEC CICS START
  7601*        TRANSID   (START-TRANS-ID)
  7602*        TERMID    (CF-FORMS-PRINTER-ID)
  7603*        FROM      (PROGRAM-INTERFACE-BLOCK)
  7604*        LENGTH    (PI-COMM-LENGTH)
  7605*    END-EXEC.
  7606*    MOVE '0( LFT                1   #00007469' TO DFHEIV0
  7607     MOVE X'3028204C4654202020202020' TO DFHEIV0(1:12)
  7608     MOVE X'202020202020202020203120' TO DFHEIV0(13:12)
  7609     MOVE X'2020233030303037343639' TO DFHEIV0(25:11)
  7610     CALL 'kxdfhei1' USING DFHEIV0,
  7611           DFHEIV99,
  7612           START-TRANS-ID,
  7613           DFHEIV99,
  7614           PROGRAM-INTERFACE-BLOCK,
  7615           PI-COMM-LENGTH,
  7616           CF-FORMS-PRINTER-ID,
  7617           DFHEIV99,
  7618           DFHEIV99,
  7619           DFHEIV99,
  7620           DFHEIV99,
  7621           DFHEIV99,
  7622           DFHEIV99,
  7623           DFHEIV99,
  7624           DFHEIV99,
  7625           DFHEIV99,
  7626           DFHEIV99
  7627     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7628
  7629
  7630     MOVE AL-UANOF               TO  PRTOPTA
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 144
* EL130.cbl
  7631                                     ALTPRTA.
  7632
  7633     MOVE SPACES                 TO  PRTOPTO
  7634                                     ALTPRTO.
  7635
  7636     MOVE ER-0000                TO  EMI-ERROR.
  7637     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7638     MOVE -1                     TO  MAINTL.
  7639     GO TO 8100-SEND-INITIAL-MAP.
  7640
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 145
* EL130.cbl
  7642 0500-CREATE-TEMP-STORAGE.
  7643     MOVE EIBCPOSN               TO PI-CURSOR.
  7644
  7645    move emi-line1               to errmsg1o
  7646    move emi-line2               to errmsg2o
  7647    move emi-sub                 to pi-emi-sub
  7648
  7649
  7650* EXEC CICS WRITEQ TS
  7651*        QUEUE   (QID)
  7652*        FROM    (EL130AI)
  7653*        LENGTH  (QID-MAP-LENGTH)
  7654*    END-EXEC.
  7655*    MOVE '*"                    ''   #00007495' TO DFHEIV0
  7656     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  7657     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7658     MOVE X'2020233030303037343935' TO DFHEIV0(25:11)
  7659     CALL 'kxdfhei1' USING DFHEIV0,
  7660           QID,
  7661           EL130AI,
  7662           QID-MAP-LENGTH,
  7663           DFHEIV99,
  7664           DFHEIV99,
  7665           DFHEIV99
  7666     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7667
  7668
  7669
  7670
  7671* EXEC CICS WRITEQ TS
  7672*        QUEUE    (QID)
  7673*        FROM     (PROGRAM-INTERFACE-BLOCK)
  7674*        LENGTH   (PI-COMM-LENGTH)
  7675*    END-EXEC.
  7676*    MOVE '*"                    ''   #00007502' TO DFHEIV0
  7677     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  7678     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7679     MOVE X'2020233030303037353032' TO DFHEIV0(25:11)
  7680     CALL 'kxdfhei1' USING DFHEIV0,
  7681           QID,
  7682           PROGRAM-INTERFACE-BLOCK,
  7683           PI-COMM-LENGTH,
  7684           DFHEIV99,
  7685           DFHEIV99,
  7686           DFHEIV99
  7687     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7688
  7689
  7690 0599-EXIT.
  7691      EXIT.
  7692
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 146
* EL130.cbl
  7694 0600-RECOVER-TEMP-STORAGE.
  7695     MOVE PI-CONTROL-IN-PROGRESS TO SAVE-CONTROL.
  7696     MOVE PI-EL127-TO-EL130-CNTRL
  7697                                 TO SAVE-EL127-TO-EL130-CNTRL.
  7698     MOVE PI-EL659-TO-EL130-CNTRL
  7699                                 TO SAVE-EL659-TO-EL130-CNTRL.
  7700     MOVE PI-COMPANY-ID          TO SAVE-COMPANY-ID.
  7701     MOVE PI-COMPANY-CD          TO SAVE-COMPANY-CD.
  7702     MOVE PI-JOURNAL-FILE-ID     TO SAVE-JOURNAL-FILE-ID.
  7703     MOVE PI-CREDIT-USER         TO SAVE-CREDIT-USER.
  7704     MOVE PI-CLAIM-USER          TO SAVE-CLAIM-USER.
  7705     MOVE PI-LIFE-OVERRIDE-L1    TO SAVE-LIFE-OVERRIDE-L1.
  7706     MOVE PI-LIFE-OVERRIDE-L2    TO SAVE-LIFE-OVERRIDE-L2.
  7707     MOVE PI-LIFE-OVERRIDE-L6    TO SAVE-LIFE-OVERRIDE-L6.
  7708     MOVE PI-LIFE-OVERRIDE-L12   TO SAVE-LIFE-OVERRIDE-L12.
  7709     MOVE PI-AH-OVERRIDE-L1      TO SAVE-AH-OVERRIDE-L1.
  7710     MOVE PI-AH-OVERRIDE-L2      TO SAVE-AH-OVERRIDE-L2.
  7711     MOVE PI-AH-OVERRIDE-L6      TO SAVE-AH-OVERRIDE-L6.
  7712     MOVE PI-AH-OVERRIDE-L12     TO SAVE-AH-OVERRIDE-L12.
  7713     MOVE PI-CERT-ACCESS-CONTROL TO SAVE-CERT-ACCESS-CONTROL.
  7714     MOVE PI-CARRIER-CONTROL-LEVEL  TO SAVE-CARRIER-CONTROL-LEVEL.
  7715     MOVE PI-PROGRAM-WORK-AREA (1:10)
  7716                                 TO SAVE-BENEFICIARY
  7717
  7718
  7719
  7720* EXEC CICS HANDLE CONDITION
  7721*        NOTFND  (0660-NOT-FOUND)
  7722*        QIDERR  (0670-QIDERR)
  7723*    END-EXEC.
  7724*    MOVE '"$IN                  ! % #00007537' TO DFHEIV0
  7725     MOVE X'2224494E2020202020202020' TO DFHEIV0(1:12)
  7726     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7727     MOVE X'2520233030303037353337' TO DFHEIV0(25:11)
  7728     CALL 'kxdfhei1' USING DFHEIV0
  7729     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7730
  7731
  7732
  7733
  7734* EXEC CICS READQ TS
  7735*        QUEUE    (QID)
  7736*        INTO     (EL130AI)
  7737*        LENGTH   (QID-MAP-LENGTH)
  7738*    END-EXEC.
  7739*    MOVE '*$I    L              ''   #00007543' TO DFHEIV0
  7740     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7741     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7742     MOVE X'2020233030303037353433' TO DFHEIV0(25:11)
  7743     CALL 'kxdfhei1' USING DFHEIV0,
  7744           QID,
  7745           EL130AI,
  7746           QID-MAP-LENGTH,
  7747           DFHEIV99,
  7748           DFHEIV99,
  7749           DFHEIV99
  7750     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7751
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 147
* EL130.cbl
  7752
  7753     IF RETURNED-FROM = XCTL-131
  7754        IF CLAIM-DELETED-BY-EL131
  7755            MOVE LOW-VALUES      TO CERTNOI
  7756                                    SUFXI
  7757            MOVE ZEROS           TO CERTNOL
  7758                                    SUFXL
  7759         END-IF
  7760     END-IF.
  7761
  7762     IF RETURNED-FROM = XCTL-131
  7763         MOVE LOW-VALUES         TO PI-PROGRAM-WORK-AREA
  7764         MOVE ZEROS              TO PI-CERT-SELECT-CNT
  7765                                    PI-CERT-PROCESSED
  7766     ELSE
  7767
  7768
  7769* EXEC CICS READQ TS
  7770*             QUEUE   (QID)
  7771*             INTO    (PROGRAM-INTERFACE-BLOCK)
  7772*             LENGTH  (PI-COMM-LENGTH)
  7773*        END-EXEC
  7774*    MOVE '*$I    L              ''   #00007564' TO DFHEIV0
  7775     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7776     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7777     MOVE X'2020233030303037353634' TO DFHEIV0(25:11)
  7778     CALL 'kxdfhei1' USING DFHEIV0,
  7779           QID,
  7780           PROGRAM-INTERFACE-BLOCK,
  7781           PI-COMM-LENGTH,
  7782           DFHEIV99,
  7783           DFHEIV99,
  7784           DFHEIV99
  7785     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7786     END-IF.
  7787
  7788
  7789* EXEC CICS DELETEQ TS
  7790*        QUEUE   (QID)
  7791*    END-EXEC.
  7792*    MOVE '*&                    #   #00007571' TO DFHEIV0
  7793     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  7794     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7795     MOVE X'2020233030303037353731' TO DFHEIV0(25:11)
  7796     CALL 'kxdfhei1' USING DFHEIV0,
  7797           QID,
  7798           DFHEIV99
  7799     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7800
  7801
  7802     MOVE SAVE-CONTROL           TO PI-CONTROL-IN-PROGRESS.
  7803
  7804     IF RETURNED-FROM = XCTL-127 OR XCTL-132
  7805         MOVE SAVE-COMPANY-CD        TO PI-COMPANY-CD
  7806         MOVE SAVE-COMPANY-ID        TO PI-COMPANY-ID
  7807         MOVE SAVE-JOURNAL-FILE-ID   TO PI-JOURNAL-FILE-ID
  7808         MOVE SAVE-CREDIT-USER       TO PI-CREDIT-USER
  7809         MOVE SAVE-CLAIM-USER        TO PI-CLAIM-USER
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 148
* EL130.cbl
  7810         MOVE SAVE-LIFE-OVERRIDE-L1  TO PI-LIFE-OVERRIDE-L1
  7811         MOVE SAVE-LIFE-OVERRIDE-L2  TO PI-LIFE-OVERRIDE-L2
  7812         MOVE SAVE-LIFE-OVERRIDE-L6  TO PI-LIFE-OVERRIDE-L6
  7813         MOVE SAVE-LIFE-OVERRIDE-L12 TO PI-LIFE-OVERRIDE-L12
  7814         MOVE SAVE-AH-OVERRIDE-L1    TO PI-AH-OVERRIDE-L1
  7815         MOVE SAVE-AH-OVERRIDE-L2    TO PI-AH-OVERRIDE-L2
  7816         MOVE SAVE-AH-OVERRIDE-L6    TO PI-AH-OVERRIDE-L6
  7817         MOVE SAVE-AH-OVERRIDE-L12   TO PI-AH-OVERRIDE-L12
  7818         MOVE SAVE-CERT-ACCESS-CONTROL
  7819                                    TO PI-CERT-ACCESS-CONTROL
  7820         MOVE SAVE-CARRIER-CONTROL-LEVEL
  7821                                    TO PI-CARRIER-CONTROL-LEVEL
  7822     END-IF.
  7823
  7824     IF EIBAID = DFHPF11
  7825        move errmsg1i            to emi-line1
  7826        move errmsg2i            to emi-line2
  7827        move pi-emi-sub          to emi-sub
  7828        go to 8200-SEND-DATAONLY
  7829     end-if
  7830     IF RETURNED-FROM = XCTL-127
  7831         MOVE SAVE-EL127-TO-EL130-CNTRL
  7832                                 TO PI-EL127-TO-EL130-CNTRL
  7833     END-IF.
  7834
  7835     IF RETURNED-FROM = XCTL-6592
  7836        MOVE SAVE-EL659-TO-EL130-CNTRL
  7837                                 TO PI-EL659-TO-EL130-CNTRL
  7838     END-IF.
  7839
  7840     IF RETURNED-FROM = XCTL-114
  7841        IF SAVE-BENEFICIARY NOT = SPACES AND LOW-VALUES
  7842           MOVE SAVE-BENEFICIARY TO BENECDI
  7843           MOVE +10              TO BENECDL
  7844           MOVE -1               TO BIRTHDTL
  7845        END-IF
  7846     END-IF.
  7847     PERFORM 3993-MODIFY-SCREEN-ATTRB THRU 3993-EXIT.
  7848
  7849     IF MAINTL NOT = ZERO
  7850         MOVE AL-UANON           TO MAINTA
  7851     END-IF.
  7852
  7853     IF ENTERPFL NOT = ZERO
  7854         MOVE AL-UNNON           TO ENTERPFA
  7855     END-IF.
  7856
  7857     IF RETURNED-FROM = XCTL-127
  7858         GO TO 0650-FROM-EL127
  7859     END-IF.
  7860
  7861     IF RETURNED-FROM = XCTL-132
  7862         GO TO 0640-FROM-EL132
  7863     END-IF.
  7864
  7865     IF RETURNED-FROM = XCTL-650
  7866         MOVE AL-SABON           TO PF5A
  7867         PERFORM 0690-HIGHLIGHT-CERTS THRU 0690-EXIT
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 149
* EL130.cbl
  7868     END-IF.
  7869
  7870     IF RETURNED-FROM = XCTL-6592
  7871         GO TO 0630-FROM-EL6592
  7872     END-IF.
  7873
  7874     IF MAINTI = 'S' OR 'I'
  7875        GO TO 1000-SHOW-CLAIM
  7876     END-IF.
  7877
  7878     GO TO 8100-SEND-INITIAL-MAP.
  7879
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 150
* EL130.cbl
  7881 0630-FROM-EL6592.
  7882     MOVE PI-EL659-CARRIER       TO CRTCARRO.
  7883     MOVE PI-EL659-GROUPING      TO GROUPO.
  7884     MOVE PI-EL659-STATE         TO STATEO.
  7885     MOVE PI-EL659-ACCOUNT       TO ACCOUNTO.
  7886
  7887     MOVE AL-UANON               TO CRTCARRA
  7888                                    GROUPA
  7889                                    STATEA
  7890                                    ACCOUNTA.
  7891     GO TO 8100-SEND-INITIAL-MAP.
  7892
  7893 0640-FROM-EL132.
  7894     IF PI-CLAIM-NO = SPACES
  7895         GO TO 0645-NO-CLAIM-SELECTED
  7896     END-IF.
  7897
  7898     MOVE LOW-VALUES             TO EL130AI.
  7899     MOVE 'MSTR'                 TO FILE-SWITCH.
  7900     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  7901     MOVE PI-CARRIER             TO MSTR-CARRIER.
  7902     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO
  7903                                    CLMNOO.
  7904     MOVE AL-UANON               TO CLMNOA.
  7905     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
  7906
  7907
  7908
  7909* EXEC CICS HANDLE CONDITION
  7910*        NOTFND   (1025-SHOW-RECORD-NOT-FOUND)
  7911*    END-EXEC.
  7912*    MOVE '"$I                   ! & #00007681' TO DFHEIV0
  7913     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7914     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7915     MOVE X'2620233030303037363831' TO DFHEIV0(25:11)
  7916     CALL 'kxdfhei1' USING DFHEIV0
  7917     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7918
  7919
  7920     PERFORM 7950-READ-CLAIM THRU 7950-EXIT.
  7921     MOVE 'X'                    TO CLAIM-SWITCH.
  7922     PERFORM 7910-READ-NINETY THRU 7910-EXIT.
  7923     MOVE AT-INFO-LINE-1         TO WS-DIAGNOSIS-DESCRIPT.
  7924     PERFORM 7910-READ-ACTV THRU 7910-EXIT.
  7925     PERFORM 7000-BUILD-OUTPUT-MAP THRU 7099-EXIT.
  7926
  7927     MOVE ER-0213                TO EMI-ERROR.
  7928     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7929     MOVE PI-CLAIM-NO            TO EMI-TEXT-VARIABLE (1).
  7930     GO TO 8100-SEND-INITIAL-MAP.
  7931
  7932 0645-NO-CLAIM-SELECTED.
  7933
  7934     IF MAINTI = 'S' OR 'I'
  7935        GO TO 1000-SHOW-CLAIM
  7936     END-IF.
  7937
  7938     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 151
* EL130.cbl
  7939
  7940 0650-FROM-EL127.
  7941
  7942     IF PI-CERT-SELECT-CNT GREATER THAN +6
  7943         MOVE ZEROS              TO PI-CERT-SELECT-CNT
  7944                                    PI-CERT-PROCESSED
  7945     END-IF.
  7946
  7947     IF PI-RETURN-TO-PROGRAM = XCTL-727
  7948         MOVE +1                 TO PI-CERT-SELECT-CNT
  7949                                    PI-CERT-PROCESSED
  7950         MOVE PI-CARRIER         TO PI-EL127-CARRIER (1)
  7951         MOVE PI-GROUPING        TO PI-EL127-GROUPING (1)
  7952         MOVE PI-STATE           TO PI-EL127-STATE   (1)
  7953         MOVE PI-ACCOUNT         TO PI-EL127-ACCOUNT (1)
  7954         MOVE PI-CERT-EFF-DT     TO PI-EL127-EFF-DT  (1)
  7955         MOVE PI-CERT-NO         TO PI-EL127-CERT-NO (1)
  7956     END-IF.
  7957
  7958     IF PI-CERT-SELECT-CNT = ZERO
  7959         IF CERTNOI NOT = SPACES AND LOW-VALUES
  7960             MOVE CERTNOI        TO PI-CERT-NO
  7961             MOVE SUFXI          TO PI-CERT-SFX
  7962             GO TO 3000-READ-CERT
  7963         ELSE
  7964             GO TO 8100-SEND-INITIAL-MAP
  7965         END-IF
  7966     END-IF.
  7967
  7968     MOVE AL-SABON               TO PF5A.
  7969
  7970     IF PI-CERT-PROCESSED = 1
  7971         PERFORM 0680-PLUG-SELECTED-CERTS THRU 0680-EXIT
  7972     END-IF.
  7973
  7974     PERFORM 0690-HIGHLIGHT-CERTS    THRU 0690-EXIT.
  7975     PERFORM 3993-MODIFY-CLAIM-ATTRB THRU 3993-EXIT.
  7976
  7977     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
  7978     MOVE PI-EL127-CARRIER (PI-CERT-PROCESSED)
  7979                                 TO CERT-CARRIER
  7980                                    PI-CARRIER.
  7981     MOVE PI-EL127-GROUPING(PI-CERT-PROCESSED)
  7982                                 TO CERT-GROUPING
  7983                                    PI-GROUPING.
  7984     MOVE PI-EL127-STATE   (PI-CERT-PROCESSED)
  7985                                 TO CERT-STATE
  7986                                    PI-STATE.
  7987     MOVE PI-EL127-ACCOUNT (PI-CERT-PROCESSED)
  7988                                 TO CERT-ACCOUNT
  7989                                    PI-ACCOUNT.
  7990     MOVE PI-EL127-EFF-DT  (PI-CERT-PROCESSED)
  7991                                 TO CERT-EFF-DT
  7992                                    PI-CERT-EFF-DT.
  7993     MOVE PI-EL127-CERT-NO (PI-CERT-PROCESSED)
  7994                                 TO CERT-CERT-NO
  7995                                    PI-CERT-NO.
  7996
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 152
* EL130.cbl
  7997     MOVE 'CERT'                 TO FILE-SWITCH.
  7998     PERFORM 7940-READ-CERT THRU 7940-EXIT.
  7999
  8000     MOVE CERT-CERT-NO           TO PI-SAVE-CERT.
  8001     MOVE CERT-ACCOUNT           TO PI-SAVE-ACCOUNT.
  8002     MOVE CERT-EFF-DT            TO PI-SAVE-EFFDT.
  8003
  8004     IF CM-CLAIM-ATTACHED-COUNT NOT = ZERO
  8005         MOVE PI-COMPANY-CD      TO MSTR5-COMP-CD
  8006         MOVE CERT-CERT-NO       TO MSTR5-CERT-NO
  8007         PERFORM 7500-BROWSE-FOR-DUPLICATE THRU 7500-EXIT
  8008         IF INCURRED-DATE-MATCH
  8009             MOVE ER-7352        TO EMI-ERROR
  8010             MOVE -1             TO CERTNOL
  8011             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8012         ELSE
  8013             IF NO-CLAIMS-FOR-CERT
  8014                 MOVE ER-7353    TO EMI-ERROR
  8015                 MOVE -1         TO CERTNOL
  8016                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8017             ELSE
  8018                 MOVE ER-0558    TO EMI-ERROR
  8019                 MOVE -1         TO CERTNOL
  8020                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8021             END-IF
  8022         END-IF
  8023     END-IF.
  8024
  8025     MOVE SPACES                 TO PI-PRT-OPT
  8026                                    PI-ALT-PRT.
  8027
  8028     PERFORM 7000-BUILD-OUTPUT-MAP THRU 7099-EXIT.
  8029
  8030     IF LSTNMEL NOT GREATER ZERO
  8031        AND CRTLNMEI NOT = (SPACES AND LOW-VALUES)
  8032         MOVE CRTLNMEI           TO  LSTNMEO
  8033         MOVE CRTFNMEI           TO  FSTNMEO
  8034         MOVE CRTINITI           TO  INITO
  8035         MOVE AL-UANON           TO  LSTNMEA
  8036                                     FSTNMEA
  8037                                     INITA
  8038     END-IF.
  8039
  8040     IF SSNL GREATER ZERO
  8041         GO TO 0655-SKIP-SOCIAL-SECURITY
  8042     END-IF.
  8043
  8044     IF CRTSSNI = SPACES OR LOW-VALUES
  8045         GO TO 0655-SKIP-SOCIAL-SECURITY
  8046     END-IF.
  8047
  8048     IF CM-SSN-STATE   = CM-STATE AND
  8049        CM-SSN-ACCOUNT = CM-ACCOUNT-PRIME
  8050            GO TO 0655-SKIP-SOCIAL-SECURITY
  8051     END-IF.
  8052
  8053     MOVE CRTSSNI                TO SSNO
  8054     MOVE AL-UANON               TO SSNA.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 153
* EL130.cbl
  8055
  8056 0655-SKIP-SOCIAL-SECURITY.
  8057
  8058     IF CLMCARRL NOT = ZERO  AND
  8059        CLMCARRI NOT = CRTCARRI
  8060        MOVE ER-0562             TO EMI-ERROR
  8061        MOVE AL-UABON            TO CLMCARRA
  8062        MOVE -1                  TO CLMCARRL
  8063        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8064     END-IF.
  8065
  8066     IF CLMCARRL = ZERO
  8067        MOVE AL-UANON            TO CLMCARRA
  8068        MOVE CRTCARRI            TO CLMCARRI
  8069     END-IF.
  8070
  8071     MOVE 'A'                    TO MAINTO.
  8072     MOVE AL-UANON               TO MAINTA.
  8073
  8074     IF PI-RETURN-TO-PROGRAM = XCTL-127 OR XCTL-727
  8075        GO TO 8100-SEND-INITIAL-MAP
  8076     ELSE
  8077        GO TO 8150-SEND-MAP-CURSOR
  8078     END-IF.
  8079
  8080 0660-NOT-FOUND.
  8081     MOVE ER-0214                TO EMI-ERROR.
  8082     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8083     GO TO 8100-SEND-INITIAL-MAP.
  8084
  8085 0670-QIDERR.
  8086     MOVE ER-0033                TO EMI-ERROR.
  8087     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8088     GO TO 8100-SEND-INITIAL-MAP.
  8089
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 154
* EL130.cbl
  8091 0680-PLUG-SELECTED-CERTS.
  8092
  8093     MOVE AL-SANON               TO BCERT1A
  8094                                    BSUFX1A
  8095                                    BCERT2A
  8096                                    BSUFX2A
  8097                                    BCERT3A
  8098                                    BSUFX3A
  8099                                    BCERT4A
  8100                                    BSUFX4A
  8101                                    BCERT5A
  8102                                    BSUFX5A.
  8103
  8104     IF PCERTNOO = SPACES OR LOW-VALUES
  8105         MOVE PI-EL127-CERT-PRIME (1)
  8106                                 TO PCERTNOO
  8107         MOVE PI-EL127-CERT-SUFX  (1)
  8108                                 TO PSUFXO
  8109     END-IF.
  8110
  8111     MOVE PI-EL127-CERT-PRIME (1)
  8112                                 TO BCERT1O.
  8113     MOVE PI-EL127-CERT-SUFX  (1)
  8114                                 TO BSUFX1O.
  8115
  8116     IF PI-CERT-SELECT-CNT GREATER THAN 1
  8117         MOVE PI-EL127-CERT-PRIME (2)
  8118                                 TO BCERT2O
  8119         MOVE PI-EL127-CERT-SUFX  (2)
  8120                                 TO BSUFX2O
  8121     ELSE
  8122         MOVE LOW-VALUES         TO BCERT2O
  8123                                    BSUFX2O
  8124     END-IF.
  8125
  8126     IF PI-CERT-SELECT-CNT GREATER THAN 2
  8127         MOVE PI-EL127-CERT-PRIME (3)
  8128                                 TO BCERT3O
  8129         MOVE PI-EL127-CERT-SUFX  (3)
  8130                                 TO BSUFX3O
  8131     ELSE
  8132         MOVE LOW-VALUES         TO BCERT3O
  8133                                    BSUFX3O
  8134     END-IF.
  8135
  8136     IF PI-CERT-SELECT-CNT GREATER THAN 3
  8137         MOVE PI-EL127-CERT-PRIME (4)
  8138                                 TO BCERT4O
  8139         MOVE PI-EL127-CERT-SUFX  (4)
  8140                                 TO BSUFX4O
  8141     ELSE
  8142         MOVE LOW-VALUES         TO BCERT4O
  8143                                    BSUFX4O
  8144     END-IF.
  8145
  8146     IF PI-CERT-SELECT-CNT GREATER THAN 4
  8147         MOVE PI-EL127-CERT-PRIME (5)
  8148                                 TO BCERT5O
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 155
* EL130.cbl
  8149         MOVE PI-EL127-CERT-SUFX  (5)
  8150                                 TO BSUFX5O
  8151     ELSE
  8152         MOVE LOW-VALUES         TO BCERT5O
  8153                                    BSUFX5O
  8154     END-IF.
  8155
  8156 0680-EXIT.
  8157     EXIT.
  8158
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 156
* EL130.cbl
  8160 0690-HIGHLIGHT-CERTS.
  8161
  8162     MOVE AL-UANON               TO PCERTNOA
  8163                                    PSUFXA.
  8164
  8165     IF BCERT1O = PI-EL127-CERT-PRIME (PI-CERT-PROCESSED) AND
  8166        BSUFX1O = PI-EL127-CERT-SUFX  (PI-CERT-PROCESSED)
  8167            MOVE AL-SABON        TO BCERT1A
  8168                                    BSUFX1A
  8169     ELSE
  8170         MOVE AL-SANON           TO BCERT1A
  8171                                    BSUFX1A
  8172     END-IF.
  8173
  8174     IF BCERT2O = PI-EL127-CERT-PRIME (PI-CERT-PROCESSED) AND
  8175        BSUFX2O = PI-EL127-CERT-SUFX  (PI-CERT-PROCESSED)
  8176            MOVE AL-SABON        TO BCERT2A
  8177                                    BSUFX2A
  8178     ELSE
  8179         MOVE AL-SANON           TO BCERT2A
  8180                                    BSUFX2A
  8181     END-IF.
  8182
  8183     IF BCERT3O = PI-EL127-CERT-PRIME (PI-CERT-PROCESSED) AND
  8184        BSUFX3O = PI-EL127-CERT-SUFX  (PI-CERT-PROCESSED)
  8185            MOVE AL-SABON        TO BCERT3A
  8186                                    BSUFX3A
  8187     ELSE
  8188         MOVE AL-SANON           TO BCERT3A
  8189                                    BSUFX3A
  8190     END-IF.
  8191
  8192     IF BCERT4O = PI-EL127-CERT-PRIME (PI-CERT-PROCESSED) AND
  8193        BSUFX4O = PI-EL127-CERT-SUFX  (PI-CERT-PROCESSED)
  8194            MOVE AL-SABON        TO BCERT4A
  8195                                    BSUFX4A
  8196     ELSE
  8197         MOVE AL-SANON           TO BCERT4A
  8198                                    BSUFX4A
  8199     END-IF.
  8200
  8201     IF BCERT5O = PI-EL127-CERT-PRIME (PI-CERT-PROCESSED) AND
  8202        BSUFX5O = PI-EL127-CERT-SUFX  (PI-CERT-PROCESSED)
  8203            MOVE AL-SABON        TO BCERT5A
  8204                                    BSUFX5A
  8205     ELSE
  8206         MOVE AL-SANON           TO BCERT5A
  8207                                    BSUFX5A
  8208     END-IF.
  8209
  8210 0690-EXIT.
  8211     EXIT.
  8212
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 157
* EL130.cbl
  8214 0800-TEST-PREVIOUS-CONTROL.
  8215     IF CLMNOI   = PI-LAST-CLAIM       AND
  8216        CLMCARRI = PI-LAST-CARR        AND
  8217        CERTNOI  = PI-LAST-CERT-PRIME  AND
  8218        SUFXI    = PI-LAST-CERT-SUFX
  8219*        NEXT SENTENCE
  8220         CONTINUE
  8221     ELSE
  8222         MOVE ER-0207            TO EMI-ERROR
  8223         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8224         MOVE -1                 TO MAINTL
  8225         GO TO 8200-SEND-DATAONLY
  8226     END-IF.
  8227
  8228     PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT.
  8229
  8230     MOVE PI-LAST-CLAIM          TO PI-CLAIM-NO.
  8231     MOVE PI-LAST-CARR           TO PI-CARRIER.
  8232     MOVE PI-LAST-CERT           TO PI-CERT-NO.
  8233
  8234     IF EIBAID = DFHPF7
  8235         MOVE XCTL-157           TO PGM-NAME
  8236     END-IF.
  8237
  8238     IF EIBAID = DFHPF8
  8239         MOVE XCTL-141           TO PGM-NAME
  8240     END-IF.
  8241
  8242     IF EIBAID = DFHPF9
  8243        MOVE SPACES              TO PI-SAVED-PROGRAM-1
  8244                                    PI-SAVED-PROGRAM-2
  8245                                    PI-SAVED-PROGRAM-3
  8246                                    PI-SAVED-PROGRAM-4
  8247                                    PI-SAVED-PROGRAM-5
  8248                                    PI-SAVED-PROGRAM-6
  8249        MOVE XCTL-126            TO PI-RETURN-TO-PROGRAM
  8250        MOVE XCTL-132            TO PI-CALLING-PROGRAM
  8251        MOVE XCTL-150            TO PGM-NAME
  8252     END-IF.
  8253
  8254     GO TO 9300-XCTL.
  8255
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 158
* EL130.cbl
  8257 1000-SHOW-CLAIM.
  8258
  8259     IF CLMNOL = ZERO
  8260         MOVE -1                 TO CLMNOL
  8261         MOVE AL-UABON           TO CLMNOA
  8262         MOVE ER-0202            TO EMI-ERROR
  8263         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8264     ELSE
  8265         MOVE AL-UANON           TO CLMNOA
  8266     END-IF.
  8267
  8268     IF PI-NO-CARRIER-SECURITY
  8269        IF CLMCARRL = ZERO
  8270             MOVE -1             TO CLMCARRL
  8271             MOVE AL-UABON       TO CLMCARRA
  8272             MOVE ER-0194        TO EMI-ERROR
  8273             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8274         ELSE
  8275             MOVE AL-UANON       TO CLMCARRA
  8276         END-IF
  8277     END-IF.
  8278
  8279     IF SUFXL = ZERO
  8280         MOVE SPACES             TO SUFXI
  8281         MOVE AL-UANON           TO SUFXA
  8282     ELSE
  8283         MOVE AL-UANON           TO SUFXA
  8284     END-IF.
  8285
  8286     IF NOT EMI-NO-ERRORS
  8287         GO TO 1050-SEND-CHECK
  8288     END-IF.
  8289
  8290
  8291
  8292* EXEC CICS HANDLE CONDITION
  8293*        NOTFND   (1025-SHOW-RECORD-NOT-FOUND)
  8294*    END-EXEC.
  8295*    MOVE '"$I                   ! '' #00008056' TO DFHEIV0
  8296     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8297     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8298     MOVE X'2720233030303038303536' TO DFHEIV0(25:11)
  8299     CALL 'kxdfhei1' USING DFHEIV0
  8300     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8301
  8302
  8303     MOVE 'MSTR'                 TO FILE-SWITCH
  8304     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  8305
  8306     MOVE CLMCARRI               TO MSTR-CARRIER.
  8307     MOVE CLMNOI                 TO MSTR-CLAIM-NO.
  8308
  8309     IF CERTNOL = ZERO     OR
  8310        CERTNOI = SPACES   OR
  8311        CERTNOI = LOW-VALUES
  8312         PERFORM 7600-BROWSE-CLAIM THRU 7699-EXIT
  8313         MOVE AL-SANON        TO CERTNOA
  8314                                 SUFXA
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 159
* EL130.cbl
  8315     ELSE
  8316         PERFORM 7610-BROWSE-CLAIM-LOOP THRU 7699-EXIT
  8317     END-IF.
  8318
  8319     MOVE CERTNOI                TO MSTR-CERT-NO-PRIME.
  8320     MOVE SUFXI                  TO MSTR-CERT-NO-SUFX.
  8321
  8322
  8323
  8324* EXEC CICS HANDLE CONDITION
  8325*        NOTFND   (1025-SHOW-RECORD-NOT-FOUND)
  8326*    END-EXEC.
  8327*    MOVE '"$I                   ! ( #00008080' TO DFHEIV0
  8328     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8329     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8330     MOVE X'2820233030303038303830' TO DFHEIV0(25:11)
  8331     CALL 'kxdfhei1' USING DFHEIV0
  8332     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8333
  8334
  8335     PERFORM 7950-READ-CLAIM THRU 7950-EXIT.
  8336
  8337     IF NOT PI-NO-ACCOUNT-SECURITY
  8338         IF PI-ACCOUNT-SECURITY NOT = CL-CERT-ACCOUNT
  8339           MOVE ER-2371          TO EMI-ERROR
  8340           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8341           MOVE -1               TO MAINTL
  8342           GO TO 8200-SEND-DATAONLY
  8343         END-IF
  8344     END-IF.
  8345
  8346
  8347
  8348* EXEC CICS HANDLE CONDITION
  8349*        NOTFND   (1025-SHOW-RECORD-NOT-FOUND)
  8350*    END-EXEC.
  8351*    MOVE '"$I                   ! ) #00008096' TO DFHEIV0
  8352     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8353     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8354     MOVE X'2920233030303038303936' TO DFHEIV0(25:11)
  8355     CALL 'kxdfhei1' USING DFHEIV0
  8356     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8357
  8358
  8359     MOVE 'Y'                    TO CLAIM-SWITCH.
  8360     PERFORM 7910-READ-NINETY THRU 7910-EXIT.
  8361     MOVE AT-INFO-LINE-1         TO WS-DIAGNOSIS-DESCRIPT.
  8362     PERFORM 7910-READ-ACTV THRU 7910-EXIT.
  8363
  8364 1000-SHOW-END-OF-PERFORM.
  8365
  8366     MOVE MSTR-COMP-CD           TO CERT-COMP-CD.
  8367     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
  8368     MOVE CL-CERT-GROUPING       TO CERT-GROUPING.
  8369     MOVE CL-CERT-STATE          TO CERT-STATE.
  8370     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
  8371     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
  8372     MOVE CL-CERT-NO             TO CERT-CERT-NO.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 160
* EL130.cbl
  8373
  8374     MOVE 'CERT'                 TO FILE-SWITCH.
  8375
  8376     PERFORM 7940-READ-CERT THRU 7940-EXIT.
  8377
  8378     MOVE CL-LAST-MAINT-DT       TO PI-MSTR-DT.
  8379     MOVE CL-LAST-MAINT-HHMMSS   TO PI-MSTR-WHEN.
  8380     MOVE AT-RECORDED-DT         TO PI-TRLR-DT.
  8381     MOVE AT-LAST-MAINT-HHMMSS   TO PI-TRLR-WHEN.
  8382     MOVE CLMNOI                 TO PI-LAST-CLAIM.
  8383     MOVE CERTNOI                TO PI-LAST-CERT-PRIME.
  8384     MOVE SUFXI                  TO PI-LAST-CERT-SUFX.
  8385     MOVE CLMCARRI               TO PI-LAST-CARR.
  8386
  8387     PERFORM 7000-BUILD-OUTPUT-MAP THRU 7099-EXIT.
  8388
  8389     IF MAINTI = 'I'
  8390         MOVE AL-SANOF TO  FSTNMEA   INITA     SEXA
  8391                 BIRTHDTA  LSTNMEA   RELCLMA   OCCCDA
  8392                 LOANNOA   LOANBALA  BENECDA
  8393         MOVE AL-SANON TO  SSNA
  8394         MOVE SPACES   TO  INCURI    REPORTI  ESTENDI
  8395         MOVE 'Y'      TO PI-INCURR-SW
  8396         MOVE ER-0522  TO EMI-ERROR
  8397         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8398     ELSE
  8399         MOVE ' '      TO PI-INCURR-SW
  8400     END-IF.
  8401
  8402     MOVE -1                     TO MAINTL.
  8403     MOVE MSTR-CARRIER           TO PI-CARRIER.
  8404     MOVE CERT-GROUPING          TO PI-GROUPING.
  8405     MOVE CERT-STATE             TO PI-STATE.
  8406     MOVE CERT-ACCOUNT           TO PI-ACCOUNT.
  8407     MOVE MSTR-CLAIM-NO          TO PI-CLAIM-NO.
  8408     MOVE MSTR-CERT-NO           TO PI-CERT-NO.
  8409     MOVE CERT-EFF-DT            TO PI-CERT-EFF-DT.
  8410
  8411     IF RETURNED-FROM NOT = SPACES
  8412         GO TO 8100-SEND-INITIAL-MAP
  8413     ELSE
  8414         GO TO 8200-SEND-DATAONLY
  8415     END-IF.
  8416
  8417 1025-SHOW-RECORD-NOT-FOUND.
  8418
  8419     IF FILE-SWITCH = 'MSTR'
  8420         MOVE ER-0204            TO EMI-ERROR
  8421     ELSE
  8422         IF FILE-SWITCH = 'TRLR'
  8423             MOVE ER-0205        TO EMI-ERROR
  8424         ELSE
  8425             MOVE ER-0206        TO EMI-ERROR
  8426         END-IF
  8427     END-IF.
  8428
  8429     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8430
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 161
* EL130.cbl
  8431 1050-SEND-CHECK.
  8432
  8433     IF RETURNED-FROM NOT = SPACES
  8434         GO TO 8100-SEND-INITIAL-MAP
  8435     ELSE
  8436         MOVE -1                 TO MAINTL
  8437         GO TO 8200-SEND-DATAONLY
  8438     END-IF.
  8439
  8440 2000-DELETE-CLAIM.
  8441     IF NOT MODIFY-CAP
  8442         MOVE ER-0070            TO EMI-ERROR
  8443         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8444         MOVE -1                 TO MAINTL
  8445         GO TO 8200-SEND-DATAONLY
  8446     END-IF.
  8447
  8448     IF CLMNOI   NOT = PI-LAST-CLAIM       OR
  8449        CLMCARRI NOT = PI-LAST-CARR        OR
  8450        CERTNOI  NOT = PI-LAST-CERT-PRIME  OR
  8451        SUFXI    NOT = PI-LAST-CERT-SUFX
  8452         MOVE ER-0207            TO EMI-ERROR
  8453         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8454         MOVE -1                 TO MAINTL
  8455         GO TO 8200-SEND-DATAONLY
  8456     END-IF.
  8457
  8458
  8459
  8460* EXEC CICS HANDLE CONDITION
  8461*        NOTFND   (2050-DELETE-NOT-FOUND)
  8462*    END-EXEC.
  8463*    MOVE '"$I                   ! * #00008200' TO DFHEIV0
  8464     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8465     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8466     MOVE X'2A20233030303038323030' TO DFHEIV0(25:11)
  8467     CALL 'kxdfhei1' USING DFHEIV0
  8468     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8469
  8470
  8471     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  8472
  8473     MOVE CLMCARRI               TO MSTR-CARRIER.
  8474     MOVE CLMNOI                 TO MSTR-CLAIM-NO.
  8475     MOVE CERTNOI                TO MSTR-CERT-NO-PRIME.
  8476     MOVE SUFXI                  TO MSTR-CERT-NO-SUFX.
  8477
  8478     MOVE 'MSTR'                 TO FILE-SWITCH.
  8479     PERFORM 7920-READ-CLAIM-UPDATE THRU 7920-EXIT.
  8480
  8481     MOVE 'Y'                    TO CLAIM-SWITCH.
  8482
  8483     IF PI-MSTR-DT   NOT = CL-LAST-MAINT-DT  OR
  8484        PI-MSTR-WHEN NOT = CL-LAST-MAINT-HHMMSS
  8485         MOVE ER-0068        TO EMI-ERROR
  8486         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8487         MOVE -1             TO MAINTL
  8488         GO TO 8200-SEND-DATAONLY
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 162
* EL130.cbl
  8489     END-IF.
  8490
  8491     IF CL-TRAILER-SEQ-CNT NOT = 4095
  8492         MOVE ER-0569            TO EMI-ERROR
  8493         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8494         MOVE -1                 TO MAINTL
  8495         GO TO 8200-SEND-DATAONLY
  8496     END-IF.
  8497
  8498     IF CL-CLAIM-PAYMENT-STATUS NOT NUMERIC
  8499         MOVE ZEROS              TO CL-CLAIM-PAYMENT-STATUS
  8500     END-IF.
  8501
  8502     IF CL-PURGED-DT NOT = LOW-VALUES
  8503         MOVE ER-7691            TO EMI-ERROR
  8504         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8505         MOVE -1                 TO MAINTL
  8506         GO TO 8200-SEND-DATAONLY
  8507     END-IF.
  8508
  8509     MOVE MSTR-COMP-CD           TO TRLR-COMP-CD.
  8510     MOVE MSTR-CARRIER           TO TRLR-CARRIER.
  8511     MOVE MSTR-CLAIM-NO          TO TRLR-CLAIM-NO.
  8512     MOVE MSTR-CERT-NO           TO TRLR-CERT-NO.
  8513     MOVE +0                     TO TRLR-SEQ-NO.
  8514     MOVE '1'                    TO TRLR-TYPE.
  8515
  8516     MOVE 'TRLR'                 TO FILE-SWITCH.
  8517
  8518
  8519
  8520* EXEC CICS READ
  8521*        UPDATE
  8522*        DATASET  (ELTRLR-DSID)
  8523*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
  8524*        RIDFLD   (ELTRLR-KEY)
  8525*    END-EXEC.
  8526*    MOVE '&"S        EU         (   #00008252' TO DFHEIV0
  8527     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8528     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8529     MOVE X'2020233030303038323532' TO DFHEIV0(25:11)
  8530     CALL 'kxdfhei1' USING DFHEIV0,
  8531           ELTRLR-DSID,
  8532           DFHEIV20,
  8533           DFHEIV99,
  8534           ELTRLR-KEY,
  8535           DFHEIV99,
  8536           DFHEIV99,
  8537           DFHEIV99
  8538     SET ADDRESS OF ACTIVITY-TRAILERS TO
  8539         DFHEIV20
  8540     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8541
  8542
  8543     IF PI-TRLR-DT   NOT = AT-RECORDED-DT  OR
  8544        PI-TRLR-WHEN NOT = AT-LAST-MAINT-HHMMSS
  8545         MOVE ER-0068        TO EMI-ERROR
  8546         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 163
* EL130.cbl
  8547         MOVE -1             TO MAINTL
  8548         GO TO 8200-SEND-DATAONLY
  8549     END-IF.
  8550
  8551
  8552
  8553* EXEC CICS DELETE
  8554*        DATASET   (ELTRLR-DSID)
  8555*    END-EXEC.
  8556*    MOVE '&(                    &   #00008268' TO DFHEIV0
  8557     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8558     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8559     MOVE X'2020233030303038323638' TO DFHEIV0(25:11)
  8560     CALL 'kxdfhei1' USING DFHEIV0,
  8561           ELTRLR-DSID,
  8562           DFHEIV99,
  8563           DFHEIV99,
  8564           DFHEIV99,
  8565           DFHEIV99
  8566     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8567
  8568
  8569     MOVE +90                    TO TRLR-SEQ-NO.
  8570     MOVE '6'                    TO TRLR-TYPE.
  8571
  8572
  8573
  8574* EXEC CICS READ
  8575*        UPDATE
  8576*        DATASET  (ELTRLR-DSID)
  8577*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
  8578*        RIDFLD   (ELTRLR-KEY)
  8579*    END-EXEC.
  8580*    MOVE '&"S        EU         (   #00008276' TO DFHEIV0
  8581     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8582     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8583     MOVE X'2020233030303038323736' TO DFHEIV0(25:11)
  8584     CALL 'kxdfhei1' USING DFHEIV0,
  8585           ELTRLR-DSID,
  8586           DFHEIV20,
  8587           DFHEIV99,
  8588           ELTRLR-KEY,
  8589           DFHEIV99,
  8590           DFHEIV99,
  8591           DFHEIV99
  8592     SET ADDRESS OF ACTIVITY-TRAILERS TO
  8593         DFHEIV20
  8594     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8595
  8596
  8597
  8598
  8599* EXEC CICS DELETE
  8600*        DATASET   (ELTRLR-DSID)
  8601*    END-EXEC.
  8602*    MOVE '&(                    &   #00008284' TO DFHEIV0
  8603     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8604     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 164
* EL130.cbl
  8605     MOVE X'2020233030303038323834' TO DFHEIV0(25:11)
  8606     CALL 'kxdfhei1' USING DFHEIV0,
  8607           ELTRLR-DSID,
  8608           DFHEIV99,
  8609           DFHEIV99,
  8610           DFHEIV99,
  8611           DFHEIV99
  8612     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8613
  8614
  8615     MOVE +91                    TO TRLR-SEQ-NO.
  8616     MOVE '6'                    TO TRLR-TYPE.
  8617
  8618
  8619
  8620* EXEC CICS READ
  8621*        UPDATE
  8622*        DATASET  (ELTRLR-DSID)
  8623*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
  8624*        RIDFLD   (ELTRLR-KEY)
  8625*        RESP     (WS-RESPONSE)
  8626*    END-EXEC
  8627*    MOVE '&"S        EU         (  N#00008292' TO DFHEIV0
  8628     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8629     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8630     MOVE X'204E233030303038323932' TO DFHEIV0(25:11)
  8631     CALL 'kxdfhei1' USING DFHEIV0,
  8632           ELTRLR-DSID,
  8633           DFHEIV20,
  8634           DFHEIV99,
  8635           ELTRLR-KEY,
  8636           DFHEIV99,
  8637           DFHEIV99,
  8638           DFHEIV99
  8639     SET ADDRESS OF ACTIVITY-TRAILERS TO
  8640         DFHEIV20
  8641     MOVE EIBRESP  TO WS-RESPONSE
  8642     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8643
  8644     IF WS-RESP-NORMAL
  8645
  8646* EXEC CICS DELETE
  8647*          DATASET   (ELTRLR-DSID)
  8648*       END-EXEC
  8649*    MOVE '&(                    &   #00008301' TO DFHEIV0
  8650     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8651     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8652     MOVE X'2020233030303038333031' TO DFHEIV0(25:11)
  8653     CALL 'kxdfhei1' USING DFHEIV0,
  8654           ELTRLR-DSID,
  8655           DFHEIV99,
  8656           DFHEIV99,
  8657           DFHEIV99,
  8658           DFHEIV99
  8659     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8660     END-IF.
  8661
  8662     MOVE MSTR-COMP-CD           TO CERT-COMP-CD.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 165
* EL130.cbl
  8663     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
  8664     MOVE CL-CERT-GROUPING       TO CERT-GROUPING.
  8665     MOVE CL-CERT-STATE          TO CERT-STATE.
  8666     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
  8667     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
  8668     MOVE CL-CERT-NO             TO CERT-CERT-NO.
  8669
  8670     MOVE 'CERT'                 TO FILE-SWITCH.
  8671
  8672     PERFORM 7930-READ-CERT-UPDATE THRU 7930-EXIT.
  8673
  8674     SUBTRACT +1 FROM CM-CLAIM-ATTACHED-COUNT GIVING WS-NUM-HOLD.
  8675
  8676     IF WS-NUM-HOLD NOT = +0
  8677         GO TO 2005-REWRITE-CERT
  8678     END-IF.
  8679
  8680     IF NOT CERT-WAS-CREATED
  8681         MOVE SPACE              TO CM-CLAIM-INTERFACE-SW
  8682         GO TO 2005-REWRITE-CERT
  8683     END-IF.
  8684
  8685
  8686
  8687* EXEC CICS DELETE
  8688*        DATASET   (ELCERT-DSID)
  8689*    END-EXEC.
  8690*    MOVE '&(                    &   #00008330' TO DFHEIV0
  8691     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8692     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8693     MOVE X'2020233030303038333330' TO DFHEIV0(25:11)
  8694     CALL 'kxdfhei1' USING DFHEIV0,
  8695           ELCERT-DSID,
  8696           DFHEIV99,
  8697           DFHEIV99,
  8698           DFHEIV99,
  8699           DFHEIV99
  8700     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8701
  8702
  8703     GO TO 2010-DELETE-CL.
  8704
  8705 2005-REWRITE-CERT.
  8706
  8707     SUBTRACT +1 FROM CM-CLAIM-ATTACHED-COUNT.
  8708
  8709
  8710
  8711* EXEC CICS HANDLE CONDITION
  8712*         DUPKEY   (2010-DELETE-CL)
  8713*    END-EXEC.
  8714*    MOVE '"$$                   ! + #00008341' TO DFHEIV0
  8715     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  8716     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8717     MOVE X'2B20233030303038333431' TO DFHEIV0(25:11)
  8718     CALL 'kxdfhei1' USING DFHEIV0
  8719     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8720
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 166
* EL130.cbl
  8721
  8722
  8723
  8724* EXEC CICS REWRITE
  8725*        DATASET  (ELCERT-DSID)
  8726*        FROM     (CERTIFICATE-MASTER)
  8727*    END-EXEC.
  8728     MOVE LENGTH OF
  8729      CERTIFICATE-MASTER
  8730       TO DFHEIV11
  8731*    MOVE '&& L                  %   #00008346' TO DFHEIV0
  8732     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8733     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8734     MOVE X'2020233030303038333436' TO DFHEIV0(25:11)
  8735     CALL 'kxdfhei1' USING DFHEIV0,
  8736           ELCERT-DSID,
  8737           CERTIFICATE-MASTER,
  8738           DFHEIV11,
  8739           DFHEIV99
  8740     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8741
  8742
  8743 2010-DELETE-CL.
  8744
  8745
  8746
  8747* EXEC CICS DELETE
  8748*        DATASET  (ELMSTR-DSID)
  8749*    END-EXEC.
  8750*    MOVE '&(                    &   #00008354' TO DFHEIV0
  8751     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8752     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8753     MOVE X'2020233030303038333534' TO DFHEIV0(25:11)
  8754     CALL 'kxdfhei1' USING DFHEIV0,
  8755           ELMSTR-DSID,
  8756           DFHEIV99,
  8757           DFHEIV99,
  8758           DFHEIV99,
  8759           DFHEIV99
  8760     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8761
  8762
  8763     MOVE -1                     TO ONE-OR-MIN1.
  8764     PERFORM 7700-CHECK-SEQUENCE THRU 7799-EXIT.
  8765
  8766     IF WS-ASSOC-CERT-TOTAL NOT = ZERO
  8767         MOVE CL-CONTROL-PRIMARY TO ELMSTR-KEY
  8768                                    WS-SAVE-CLAIM-KEY
  8769         MOVE +1                 TO ONE-OR-MIN1
  8770         PERFORM 7710-RESEQUENCE-CLAIMS THRU 7799-EXIT
  8771     END-IF.
  8772
  8773     MOVE ER-0000                TO EMI-ERROR.
  8774     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8775     MOVE LOW-VALUES             TO EL130AO.
  8776     MOVE -1                     TO MAINTL.
  8777     MOVE SPACES                 TO PI-PROGRAM-WORK-AREA.
  8778     MOVE ZEROS                  TO PI-CERT-SELECT-CNT
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 167
* EL130.cbl
  8779                                    PI-CERT-PROCESSED
  8780                                    PI-LETTER-ERROR-CODE.
  8781     GO TO 8100-SEND-INITIAL-MAP.
  8782
  8783 2050-DELETE-NOT-FOUND.
  8784     IF FILE-SWITCH = 'MSTR'
  8785         MOVE -1                 TO CLMNOL
  8786         MOVE ER-0204            TO EMI-ERROR
  8787     ELSE
  8788         IF FILE-SWITCH = 'TRLR'
  8789             MOVE -1             TO MAINTL
  8790             MOVE ER-0205        TO EMI-ERROR
  8791         ELSE
  8792             MOVE -1             TO CERTNOL
  8793             MOVE ER-0206        TO EMI-ERROR
  8794         END-IF
  8795     END-IF.
  8796
  8797     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8798     GO TO 8200-SEND-DATAONLY.
  8799
  8800 3000-ADD-CLAIM.
  8801     IF NOT MODIFY-CAP
  8802         MOVE ER-0070            TO EMI-ERROR
  8803         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8804         MOVE -1                 TO MAINTL
  8805         GO TO 8200-SEND-DATAONLY
  8806     END-IF.
  8807
  8808     PERFORM 6000-EDIT-CLAIM-DATA THRU 6000-EXIT.
  8809
  8810     IF CERTMTI = 'S'
  8811         IF CERTNOI  = PI-SAVE-CERT-PRIME  AND
  8812            SUFXI    = PI-SAVE-CERT-SUFX   AND
  8813            WS-EFFDT = PI-SAVE-EFFDT       AND
  8814            ACCOUNTI = PI-SAVE-ACCOUNT
  8815             IF EMI-ERROR = 0
  8816                 GO TO 3010-TEST-FOR-ERRORS
  8817             ELSE
  8818                 MOVE PI-COMPANY-CD    TO  CERT-COMP-CD
  8819                 MOVE PI-CARRIER       TO  CERT-CARRIER
  8820                 MOVE PI-GROUPING      TO  CERT-GROUPING
  8821                 MOVE PI-STATE         TO  CERT-STATE
  8822                 MOVE PI-ACCOUNT       TO  CERT-ACCOUNT
  8823                 MOVE PI-CERT-EFF-DT   TO  CERT-EFF-DT
  8824                 MOVE PI-CERT-NO       TO  CERT-CERT-NO
  8825
  8826
  8827* EXEC CICS HANDLE CONDITION
  8828*                    NOTFND   (3010-TEST-FOR-ERRORS)
  8829*                END-EXEC
  8830*    MOVE '"$I                   ! , #00008421' TO DFHEIV0
  8831     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8832     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8833     MOVE X'2C20233030303038343231' TO DFHEIV0(25:11)
  8834     CALL 'kxdfhei1' USING DFHEIV0
  8835     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8836                 PERFORM 7940-READ-CERT THRU 7940-EXIT
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 168
* EL130.cbl
  8837                 PERFORM 7050-BUILD-MAP-CERT-DATA THRU 7099-EXIT
  8838                 GO TO 3010-TEST-FOR-ERRORS
  8839             END-IF
  8840         END-IF
  8841     END-IF.
  8842
  8843     IF CERTMTI = 'A'
  8844         IF NOT PI-NO-CARRIER-SECURITY OR
  8845             NOT PI-NO-ACCOUNT-SECURITY
  8846             MOVE ER-2370          TO EMI-ERROR
  8847             MOVE -1               TO MAINTL
  8848             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8849             GO TO 8200-SEND-DATAONLY
  8850         ELSE
  8851             PERFORM 6300-REQUIRED-CERT-EDIT THRU 6399-EXIT
  8852             GO TO 3010-TEST-FOR-ERRORS
  8853         END-IF
  8854     END-IF.
  8855
  8856     IF CERTNOL = ZEROS
  8857        GO TO 3010-TEST-FOR-ERRORS
  8858     END-IF.
  8859
  8860 3000-READ-CERT.
  8861
  8862     MOVE PI-COMPANY-CD          TO CERT-COMP-CD-5
  8863                                    MSTR5-COMP-CD.
  8864     MOVE CERTNOI                TO CERT-CERT-5-PRIME
  8865                                    MSTR5-CERT-NO-PRIME.
  8866     MOVE SUFXI                  TO CERT-CERT-5-SUFX
  8867                                    MSTR5-CERT-NO-SUFX.
  8868
  8869
  8870
  8871* EXEC CICS HANDLE CONDITION
  8872*         DUPKEY   (3008-DUP-ERROR)
  8873*         NOTFND   (3009-NOT-FOUND)
  8874*    END-EXEC
  8875*    MOVE '"$$I                  ! - #00008458' TO DFHEIV0
  8876     MOVE X'222424492020202020202020' TO DFHEIV0(1:12)
  8877     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8878     MOVE X'2D20233030303038343538' TO DFHEIV0(25:11)
  8879     CALL 'kxdfhei1' USING DFHEIV0
  8880     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8881
  8882     PERFORM 7980-READ-CERT5 THRU 7980-EXIT.
  8883
  8884     IF NOT PI-NO-ACCOUNT-SECURITY
  8885         IF PI-ACCOUNT-SECURITY NOT = CM-ACCOUNT
  8886             MOVE ER-2371          TO EMI-ERROR
  8887             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8888             MOVE -1               TO MAINTL
  8889             GO TO 8200-SEND-DATAONLY
  8890         END-IF
  8891     END-IF.
  8892
  8893     MOVE CM-CERT-NO             TO PI-SAVE-CERT.
  8894     MOVE CM-ACCOUNT             TO PI-SAVE-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 169
* EL130.cbl
  8895     MOVE CM-CERT-EFF-DT         TO PI-SAVE-EFFDT.
  8896     MOVE CM-COMPANY-CD          TO PI-COMPANY-CD.
  8897     MOVE CM-CARRIER             TO PI-CARRIER.
  8898     MOVE CM-GROUPING            TO PI-GROUPING.
  8899     MOVE CM-STATE               TO PI-STATE.
  8900     MOVE CM-ACCOUNT             TO PI-ACCOUNT.
  8901     MOVE CM-CERT-EFF-DT         TO PI-CERT-EFF-DT.
  8902     MOVE CM-CERT-NO             TO PI-CERT-NO.
  8903     PERFORM 7050-BUILD-MAP-CERT-DATA THRU 7099-EXIT.
  8904
  8905     IF CRTLNMEI NOT = SPACES AND LOW-VALUES
  8906         IF LSTNMEO = SPACES OR LOW-VALUES
  8907             MOVE CRTLNMEI       TO  LSTNMEO
  8908             MOVE AL-UANON       TO  LSTNMEA
  8909         END-IF
  8910     END-IF.
  8911
  8912     MOVE 'S'                    TO CERTMTO.
  8913*    MOVE AL-UANON               TO CERTMTA  CERTNOA  CLMCARRA
  8914     MOVE AL-SANON               TO CERTNOA.
  8915     MOVE AL-UANON               TO CERTMTA   CLMCARRA
  8916                                 EFFDTA ACCOUNTA STATEA   GROUPA.
  8917     IF EMI-NO-ERRORS
  8918         MOVE -1                  TO MAINTL
  8919     END-IF.
  8920
  8921     IF CM-CLAIM-ATTACHED-COUNT NOT = ZERO
  8922         PERFORM 7500-BROWSE-FOR-DUPLICATE THRU 7500-EXIT
  8923         IF INCURRED-DATE-MATCH
  8924             MOVE ER-7352         TO EMI-ERROR
  8925             MOVE -1              TO CERTNOL
  8926             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8927         ELSE
  8928             IF NO-CLAIMS-FOR-CERT
  8929                 MOVE ER-7353     TO EMI-ERROR
  8930                 MOVE -1          TO CERTNOL
  8931                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8932             ELSE
  8933                 MOVE ER-0558     TO EMI-ERROR
  8934                 MOVE -1          TO CERTNOL
  8935                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8936                 GO TO 3010-TEST-FOR-ERRORS
  8937             END-IF
  8938         END-IF
  8939     END-IF.
  8940
  8941 3007-SEND-SCREEN.
  8942     IF RETURNED-FROM = XCTL-132 OR XCTL-127
  8943         GO TO 8150-SEND-MAP-CURSOR
  8944     ELSE
  8945         GO TO 8200-SEND-DATAONLY
  8946     END-IF.
  8947
  8948 3008-DUP-ERROR.
  8949     MOVE ER-0560                TO EMI-ERROR.
  8950     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8951     MOVE -1                     TO CERTNOL.
  8952     GO TO 3007-SEND-SCREEN.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 170
* EL130.cbl
  8953
  8954 3009-NOT-FOUND.
  8955     MOVE ER-0214                TO EMI-ERROR.
  8956     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8957     MOVE -1                     TO CERTNOL.
  8958     GO TO 3007-SEND-SCREEN.
  8959
  8960 3010-TEST-FOR-ERRORS.
  8961
  8962     PERFORM 6200-EDIT-CERT-DATA           THRU 6200-EXIT.
  8963     PERFORM 6400-TEST-CLAIM-REASONABILITY THRU 6499-EXIT.
  8964     if pi-company-id = 'DCC'
  8965        perform 6500-get-acct    thru 6500-exit
  8966     end-if
  8967
  8968     MOVE ZEROS                  TO WS-MONTHS-BETWEEN
  8969     move +0                     to e1
  8970     move spaces                 to ws-dcc-error-line
  8971
  8972     IF PI-COMPANY-ID = 'DCC'
  8973        PERFORM 3997-GET-ERPDEF  THRU 3997-EXIT
  8974        IF ERPDEF-FOUND
  8975           MOVE CM-CERT-EFF-DT   TO DC-BIN-DATE-1
  8976           MOVE WS-INCUR         TO DC-BIN-DATE-2
  8977           MOVE '1'              TO DC-OPTION-CODE
  8978           MOVE +0               TO DC-ELAPSED-MONTHS
  8979                                    DC-ELAPSED-DAYS
  8980           PERFORM 9700-LINK-DATE-CONVERT
  8981                                 THRU 9700-EXIT
  8982           IF NO-CONVERSION-ERROR
  8983              MOVE DC-ELAPSED-MONTHS
  8984                                 TO WS-MONTHS-BETWEEN
  8985              IF DC-ELAPSED-DAYS > 1
  8986                 ADD 1 TO WS-MONTHS-BETWEEN
  8987              END-IF
  8988           ELSE
  8989              MOVE ZEROS         TO WS-MONTHS-BETWEEN
  8990           END-IF
  8991
  8992           evaluate true
  8993              when (ws-excl-period not = zeros)
  8994                 and (ws-months-between <= ws-excl-period)
  8995                 MOVE -1         TO MAINTL
  8996                 add +1          to e1
  8997                 MOVE ER-1651    TO EMI-ERROR
  8998                                    ws-error-no (e1)
  8999                 PERFORM 9900-ERROR-FORMAT
  9000                                 THRU 9900-EXIT
  9001              when (ws-cov-ends not = zeros)
  9002                 and (ws-months-between > ws-cov-ends)
  9003                 MOVE -1         TO MAINTL
  9004                 add +1          to e1
  9005                 MOVE ER-1653    TO EMI-ERROR
  9006                                    ws-error-no (e1)
  9007                 evaluate true
  9008                    when clmtypei = 'L'
  9009                       move '  LF  ' to emi-claim-type
  9010                    when clmtypei = 'I'
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 171
* EL130.cbl
  9011                       move '  IU  ' to emi-claim-type
  9012                    when other
  9013                       move '  AH  ' to emi-claim-type
  9014                 end-evaluate
  9015                 PERFORM 9900-ERROR-FORMAT
  9016                                 THRU 9900-EXIT
  9017              when (ws-acc-period not = zeros)
  9018                 and (ws-months-between <= ws-acc-period)
  9019                 MOVE -1         TO MAINTL
  9020                 add +1          to e1
  9021                 MOVE ER-1652    TO EMI-ERROR
  9022                                    ws-error-no (e1)
  9023                 PERFORM 9900-ERROR-FORMAT
  9024                                 THRU 9900-EXIT
  9025                 add +1          to e1
  9026                 move er-1655    to emi-error
  9027                                    ws-error-no (e1)
  9028                 PERFORM 9900-ERROR-FORMAT
  9029                                 THRU 9900-EXIT
  9030              when clmtypei = 'I'
  9031                 add +1          to e1
  9032                 move er-1661    to emi-error
  9033                                    ws-error-no (e1)
  9034                 PERFORM 9900-ERROR-FORMAT
  9035                                 THRU 9900-EXIT
  9036           end-evaluate
  9037        END-IF
  9038        perform 3996-read-cert-claim-trailer
  9039                                 thru 3996-exit
  9040     END-IF
  9041     IF CERTMTI NOT = 'A'
  9042         IF CM-CLAIM-ATTACHED-COUNT NOT = ZERO
  9043             MOVE PI-COMPANY-CD       TO MSTR5-COMP-CD
  9044             MOVE CERTNOI             TO MSTR5-CERT-NO-PRIME
  9045             MOVE SUFXI               TO MSTR5-CERT-NO-SUFX
  9046             PERFORM 7500-BROWSE-FOR-DUPLICATE THRU 7500-EXIT
  9047             IF INCURRED-DATE-MATCH
  9048                 MOVE ER-7352         TO EMI-ERROR
  9049                 MOVE -1              TO CERTNOL
  9050                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9051             ELSE
  9052                 IF NO-CLAIMS-FOR-CERT
  9053                     MOVE ER-7353     TO EMI-ERROR
  9054                     MOVE -1          TO CERTNOL
  9055                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9056                 ELSE
  9057                     MOVE ER-0558     TO EMI-ERROR
  9058                     MOVE -1          TO CERTNOL
  9059                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9060                 END-IF
  9061             END-IF
  9062         END-IF
  9063     END-IF.
  9064
  9065     IF EIBAID = DFHPF6  AND NOT FORCE-CAP
  9066         MOVE ER-0433             TO EMI-ERROR
  9067         MOVE -1                  TO MAINTL
  9068         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 172
* EL130.cbl
  9069         GO TO 8200-SEND-DATAONLY
  9070     END-IF.
  9071
  9072     IF (EMI-NO-ERRORS)
  9073        OR (ZEROS = EMI-FATAL-CTR AND EMI-FORCABLE-CTR)
  9074         GO TO 3015-TRY-TO-BUILD
  9075     END-IF.
  9076
  9077     IF EIBAID = DFHPF6
  9078         IF EMI-FATAL-CTR NOT EQUAL ZERO
  9079             MOVE ER-0434         TO EMI-ERROR
  9080             MOVE -1              TO MAINTL
  9081             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9082             GO TO 8200-SEND-DATAONLY
  9083         ELSE
  9084             MOVE +1              TO INCURL
  9085             GO TO 3015-TRY-TO-BUILD
  9086         END-IF
  9087     END-IF.
  9088
  9089     IF RETURNED-FROM = XCTL-132 OR XCTL-127
  9090         GO TO 8150-SEND-MAP-CURSOR
  9091     ELSE
  9092         GO TO 8200-SEND-DATAONLY
  9093     END-IF.
  9094
  9095 3015-TRY-TO-BUILD.
  9096     IF CLMNOL EQUAL ZERO
  9097         GO TO 3030-BUILD-CONT
  9098     END-IF.
  9099
  9100
  9101
  9102* EXEC CICS HANDLE CONDITION
  9103*        NOTFND   (3030-BUILD-CONT)
  9104*    END-EXEC.
  9105*    MOVE '"$I                   ! . #00008682' TO DFHEIV0
  9106     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9107     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9108     MOVE X'2E20233030303038363832' TO DFHEIV0(25:11)
  9109     CALL 'kxdfhei1' USING DFHEIV0
  9110     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9111
  9112
  9113     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  9114
  9115     MOVE CLMCARRI               TO MSTR-CARRIER.
  9116     MOVE CLMNOI                 TO MSTR-CLAIM-NO.
  9117     MOVE CERTNOI                TO MSTR-CERT-NO-PRIME.
  9118     MOVE SUFXI                  TO MSTR-CERT-NO-SUFX.
  9119
  9120     MOVE 'MSTR'                 TO FILE-SWITCH.
  9121
  9122     PERFORM 7950-READ-CLAIM THRU 7950-EXIT.
  9123
  9124     MOVE ER-0221                TO EMI-ERROR.
  9125
  9126     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 173
* EL130.cbl
  9127     MOVE -1                     TO MAINTL.
  9128     GO TO 8200-SEND-DATAONLY.
  9129
  9130 3030-BUILD-CONT.
  9131     IF (CERTMTI NOT = 'A')
  9132        and (pi-company-id not = 'DCC')
  9133         GO TO 3060-BUILD-CONT
  9134     END-IF.
  9135
  9136
  9137
  9138* EXEC CICS HANDLE CONDITION
  9139*        NOTFND   (3033-ACCT-NOT-FOUND)
  9140*        ENDFILE  (3033-ACCT-NOT-FOUND)
  9141*    END-EXEC.
  9142*    MOVE '"$I''                  ! / #00008710' TO DFHEIV0
  9143     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  9144     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9145     MOVE X'2F20233030303038373130' TO DFHEIV0(25:11)
  9146     CALL 'kxdfhei1' USING DFHEIV0
  9147     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9148
  9149
  9150     MOVE SPACES                 TO ERACCT-KEY.
  9151
  9152     IF CARR-GROUP-ST-ACCNT-CNTL
  9153         MOVE PI-COMPANY-CD      TO ACCT-COMP-CD
  9154         MOVE CRTCARRI           TO ACCT-CARRIER
  9155         MOVE GROUPI             TO ACCT-GROUPING
  9156         MOVE STATEI             TO ACCT-STATE
  9157         MOVE ACCOUNTI           TO ACCT-ACCOUNT
  9158         GO TO 3031-MOVE-ACCT-KEY
  9159     END-IF.
  9160
  9161     MOVE PI-COMPANY-CD          TO ACCT-COMP-CD.
  9162     MOVE ACCOUNTI               TO ACCT-ACCOUNT.
  9163
  9164     IF PI-CERT-ACCESS-CONTROL = ' ' OR '2'
  9165         MOVE STATEI             TO ACCT-STATE
  9166     END-IF.
  9167
  9168     IF PI-CERT-ACCESS-CONTROL = '2' OR '4'
  9169         MOVE CRTCARRI           TO ACCT-CARRIER
  9170     END-IF.
  9171
  9172 3031-MOVE-ACCT-KEY.
  9173     MOVE ERACCT-KEY             TO SAVE-ERACCT-KEY.
  9174
  9175
  9176
  9177* EXEC CICS STARTBR
  9178*        DATASET     (ERACCT2-DSID)
  9179*        RIDFLD      (SAVE-ERACCT-KEY)
  9180*        GENERIC
  9181*        KEYLENGTH   (20)
  9182*    END-EXEC.
  9183     MOVE 20
  9184       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 174
* EL130.cbl
  9185     MOVE 0
  9186       TO DFHEIV12
  9187*    MOVE '&,   KG    G          &   #00008741' TO DFHEIV0
  9188     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
  9189     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9190     MOVE X'2020233030303038373431' TO DFHEIV0(25:11)
  9191     CALL 'kxdfhei1' USING DFHEIV0,
  9192           ERACCT2-DSID,
  9193           SAVE-ERACCT-KEY,
  9194           DFHEIV11,
  9195           DFHEIV12,
  9196           DFHEIV99
  9197     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9198
  9199
  9200
  9201
  9202* EXEC CICS HANDLE CONDITION
  9203*        ENDFILE   (3032-NOT-IN-DT-RANGE)
  9204*    END-EXEC.
  9205*    MOVE '"$''                   ! 0 #00008749' TO DFHEIV0
  9206     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
  9207     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9208     MOVE X'3020233030303038373439' TO DFHEIV0(25:11)
  9209     CALL 'kxdfhei1' USING DFHEIV0
  9210     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9211
  9212
  9213 3031-READ-ACCT-LOOP.
  9214
  9215
  9216* EXEC CICS READNEXT
  9217*        DATASET   (ERACCT2-DSID)
  9218*        SET       (ADDRESS OF ACCOUNT-MASTER)
  9219*        RIDFLD    (SAVE-ERACCT-KEY)
  9220*    END-EXEC.
  9221     MOVE 0
  9222       TO DFHEIV11
  9223*    MOVE '&.S                   )   #00008755' TO DFHEIV0
  9224     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9225     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  9226     MOVE X'2020233030303038373535' TO DFHEIV0(25:11)
  9227     CALL 'kxdfhei1' USING DFHEIV0,
  9228           ERACCT2-DSID,
  9229           DFHEIV20,
  9230           DFHEIV99,
  9231           SAVE-ERACCT-KEY,
  9232           DFHEIV99,
  9233           DFHEIV11,
  9234           DFHEIV99,
  9235           DFHEIV99
  9236     SET ADDRESS OF ACCOUNT-MASTER TO
  9237         DFHEIV20
  9238     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9239
  9240
  9241     IF ACCT-COMP-CD  NOT = AM-COMPANY-CD-A1  OR
  9242        ACCT-CARRIER  NOT = AM-VG-CARRIER     OR
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 175
* EL130.cbl
  9243        ACCT-GROUPING NOT = AM-VG-GROUPING    OR
  9244        ACCT-STATE    NOT = AM-VG-STATE       OR
  9245        ACCT-ACCOUNT  NOT = AM-VG-ACCOUNT
  9246         GO TO 3033-ACCT-NOT-FOUND
  9247     END-IF.
  9248
  9249     IF WS-EFFDT NOT LESS AM-EFFECTIVE-DT  AND
  9250        WS-EFFDT LESS AM-EXPIRATION-DT
  9251         MOVE PI-COMPANY-CD    TO CERT-COMP-CD
  9252         MOVE AM-CARRIER       TO CERT-CARRIER
  9253         MOVE AM-GROUPING      TO CERT-GROUPING
  9254         MOVE AM-STATE         TO CERT-STATE
  9255         MOVE AM-ACCOUNT       TO CERT-ACCOUNT
  9256         MOVE WS-EFFDT         TO CERT-EFF-DT
  9257         MOVE CERTNOI          TO CERT-CERT-NO-PRIME
  9258         MOVE SUFXI            TO CERT-CERT-NO-SUFX
  9259         MOVE AM-REI-TABLE     TO WS-REIN-TABLE
  9260         GO TO 3034-CHECK-EMPLOYER-STATEMENT
  9261     END-IF.
  9262
  9263     IF WS-EFFDT NOT LESS AM-EXPIRATION-DT
  9264         GO TO 3031-READ-ACCT-LOOP
  9265     END-IF.
  9266
  9267 3032-NOT-IN-DT-RANGE.
  9268     MOVE ER-0226                TO EMI-ERROR.
  9269     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9270     MOVE -1                     TO EFFDTL.
  9271     GO TO 8200-SEND-DATAONLY.
  9272
  9273 3033-ACCT-NOT-FOUND.
  9274     MOVE ER-0226 TO EMI-ERROR.
  9275     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9276     MOVE -1                     TO ACCOUNTL.
  9277     GO TO 8200-SEND-DATAONLY.
  9278
  9279 3034-CHECK-EMPLOYER-STATEMENT.
  9280
  9281     IF AM-EMPLOYER-STMT-USED = '1' OR '2' OR '3' OR 'Y'
  9282*        NEXT SENTENCE
  9283         CONTINUE
  9284     ELSE
  9285         GO TO  3034-CHECK-ACCOUNT-LIMITS
  9286     END-IF.
  9287
  9288     MOVE CERT-EFF-DT            TO  DC-BIN-DATE-1.
  9289     MOVE WS-INCUR               TO  DC-BIN-DATE-2.
  9290     MOVE '1'                    TO  DC-OPTION-CODE.
  9291     MOVE +0                     TO  DC-ELAPSED-MONTHS
  9292                                     DC-ELAPSED-DAYS.
  9293     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  9294
  9295     IF (AM-EMPLOYER-STMT-USED = '1' AND
  9296         DC-ELAPSED-DAYS LESS THAN +31)
  9297                      OR
  9298        (AM-EMPLOYER-STMT-USED = '2' AND
  9299         DC-ELAPSED-DAYS LESS THAN +61)
  9300                      OR
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 176
* EL130.cbl
  9301        (AM-EMPLOYER-STMT-USED = '3' AND
  9302         DC-ELAPSED-DAYS LESS THAN +91)
  9303            MOVE 'Y'             TO  AM-EMPLOYER-STMT-USED
  9304     END-IF.
  9305
  9306 3034-CHECK-ACCOUNT-LIMITS.
  9307
  9308     IF CERTMTI NOT = 'A'
  9309         GO TO 3060-BUILD-CONT
  9310     END-IF.
  9311
  9312     IF AM-STATUS NOT = '0'
  9313         MOVE ER-0225                TO EMI-ERROR
  9314         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9315         MOVE -1                     TO ACCOUNTL
  9316     END-IF.
  9317
  9318     IF EIBAID = DFHPF6
  9319         IF EMI-FATAL-CTR NOT = ZERO
  9320             MOVE ER-0434         TO EMI-ERROR
  9321             MOVE -1              TO MAINTL
  9322             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9323             GO TO 8200-SEND-DATAONLY
  9324         END-IF
  9325     END-IF.
  9326
  9327*    IF PI-COMPANY-ID NOT = 'CRI'
  9328*        GO TO 3035-END-BROWSE
  9329*    END-IF.
  9330
  9331 3035-END-BROWSE.
  9332
  9333
  9334* EXEC CICS ENDBR
  9335*        DATASET    (ERACCT2-DSID)
  9336*    END-EXEC.
  9337     MOVE 0
  9338       TO DFHEIV11
  9339*    MOVE '&2                    $   #00008853' TO DFHEIV0
  9340     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9341     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9342     MOVE X'2020233030303038383533' TO DFHEIV0(25:11)
  9343     CALL 'kxdfhei1' USING DFHEIV0,
  9344           ERACCT2-DSID,
  9345           DFHEIV11,
  9346           DFHEIV99
  9347     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9348
  9349
  9350 3040-CHECK-CERT-ALREADY-ON.
  9351
  9352
  9353* EXEC CICS HANDLE CONDITION
  9354*        NOTFND   (3070-BUILD-CONT)
  9355*    END-EXEC.
  9356*    MOVE '"$I                   ! 1 #00008859' TO DFHEIV0
  9357     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9358     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 177
* EL130.cbl
  9359     MOVE X'3120233030303038383539' TO DFHEIV0(25:11)
  9360     CALL 'kxdfhei1' USING DFHEIV0
  9361     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9362
  9363
  9364     PERFORM 7940-READ-CERT THRU 7940-EXIT.
  9365
  9366     MOVE ER-0229                TO EMI-ERROR.
  9367     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9368     MOVE -1                     TO MAINTL.
  9369     GO TO 8200-SEND-DATAONLY.
  9370
  9371 3060-BUILD-CONT.
  9372     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
  9373     MOVE CRTCARRI               TO CERT-CARRIER.
  9374     MOVE GROUPI                 TO CERT-GROUPING.
  9375     MOVE STATEI                 TO CERT-STATE.
  9376     MOVE PI-SAVE-ACCOUNT        TO CERT-ACCOUNT.
  9377     MOVE CERTNOI                TO CERT-CERT-NO-PRIME.
  9378     MOVE SUFXI                  TO CERT-CERT-NO-SUFX.
  9379     MOVE PI-SAVE-EFFDT          TO CERT-EFF-DT.
  9380
  9381
  9382
  9383* EXEC CICS HANDLE CONDITION
  9384*        NOTFND  (3065-CERT-NOT-FOUND)
  9385*    END-EXEC.
  9386*    MOVE '"$I                   ! 2 #00008881' TO DFHEIV0
  9387     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9388     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9389     MOVE X'3220233030303038383831' TO DFHEIV0(25:11)
  9390     CALL 'kxdfhei1' USING DFHEIV0
  9391     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9392
  9393
  9394     PERFORM 7930-READ-CERT-UPDATE THRU 7930-EXIT.
  9395
  9396     GO TO 3070-BUILD-CONT.
  9397
  9398 3065-CERT-NOT-FOUND.
  9399     MOVE ER-0244                TO EMI-ERROR.
  9400     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9401     MOVE -1                     TO CERTNOL.
  9402     GO TO 8200-SEND-DATAONLY.
  9403
  9404 3070-BUILD-CONT.
  9405     IF CLMNOL NOT = ZERO
  9406         GO TO 3200-BUILD-ZERO-TRAILER
  9407     END-IF.
  9408
  9409     MOVE SPACES                 TO ELCNTL-KEY.
  9410
  9411     IF CONTROL-IS-ACTUAL-CARRIER
  9412         MOVE PI-CARRIER         TO CNTL-CARRIER
  9413     ELSE
  9414         MOVE PI-CARRIER-CONTROL-LEVEL
  9415                                 TO CNTL-CARRIER
  9416     END-IF.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 178
* EL130.cbl
  9417
  9418     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
  9419     MOVE '6'                    TO CNTL-REC-TYPE.
  9420     MOVE +0                     TO CNTL-SEQ-NO.
  9421
  9422
  9423
  9424* EXEC CICS HANDLE CONDITION
  9425*        NOTFND   (3100-CARRIER-NOT-FOUND)
  9426*    END-EXEC.
  9427*    MOVE '"$I                   ! 3 #00008914' TO DFHEIV0
  9428     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9429     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9430     MOVE X'3320233030303038393134' TO DFHEIV0(25:11)
  9431     CALL 'kxdfhei1' USING DFHEIV0
  9432     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9433
  9434
  9435
  9436
  9437* EXEC CICS READ
  9438*        UPDATE
  9439*        DATASET   (ELCNTL-DSID)
  9440*        SET       (ADDRESS OF CONTROL-FILE)
  9441*        RIDFLD    (ELCNTL-KEY)
  9442*    END-EXEC.
  9443*    MOVE '&"S        EU         (   #00008919' TO DFHEIV0
  9444     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9445     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9446     MOVE X'2020233030303038393139' TO DFHEIV0(25:11)
  9447     CALL 'kxdfhei1' USING DFHEIV0,
  9448           ELCNTL-DSID,
  9449           DFHEIV20,
  9450           DFHEIV99,
  9451           ELCNTL-KEY,
  9452           DFHEIV99,
  9453           DFHEIV99,
  9454           DFHEIV99
  9455     SET ADDRESS OF CONTROL-FILE TO
  9456         DFHEIV20
  9457     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9458
  9459
  9460     IF CLAIM-NO-MANUAL
  9461         GO TO 3120-CLAIM-MUST-BE-INPUT
  9462     END-IF.
  9463
  9464     MOVE CF-CLAIM-NO-METHOD     TO SAVE-METHOD.
  9465     MOVE CF-CLAIM-COUNTER       TO SAVE-COUNTER.
  9466
  9467     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
  9468         CONTINUE
  9469     ELSE
  9470         GO TO 3080-ASSIGN-LOOP
  9471     END-IF.
  9472
  9473
  9474
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 179
* EL130.cbl
  9475* EXEC CICS UNLOCK
  9476*        DATASET   (ELCNTL-DSID)
  9477*    END-EXEC.
  9478*    MOVE '&*                    #   #00008940' TO DFHEIV0
  9479     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  9480     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9481     MOVE X'2020233030303038393430' TO DFHEIV0(25:11)
  9482     CALL 'kxdfhei1' USING DFHEIV0,
  9483           ELCNTL-DSID,
  9484           DFHEIV99
  9485     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9486
  9487
  9488     MOVE '1'                    TO CNTL-REC-TYPE.
  9489     MOVE SPACES                 TO CNTL-ACCESS.
  9490
  9491     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID
  9492
  9493
  9494
  9495* EXEC CICS HANDLE CONDITION
  9496*        NOTFND   (3110-COMPANY-NOT-FOUND)
  9497*    END-EXEC.
  9498*    MOVE '"$I                   ! 4 #00008950' TO DFHEIV0
  9499     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9500     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9501     MOVE X'3420233030303038393530' TO DFHEIV0(25:11)
  9502     CALL 'kxdfhei1' USING DFHEIV0
  9503     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9504
  9505
  9506     PERFORM 7960-READ-CNTL-UPDATE THRU 7960-EXIT.
  9507
  9508     MOVE CF-CO-CLAIM-COUNTER    TO SAVE-COUNTER.
  9509
  9510 3080-ASSIGN-LOOP.
  9511     IF (SAVE-COUNTER = +99999   AND SAVE-METHOD = '2') OR
  9512        (SAVE-COUNTER = +9999999 AND SAVE-METHOD = '3')
  9513         MOVE +0                 TO SAVE-COUNTER
  9514     END-IF.
  9515
  9516     ADD +1 TO SAVE-COUNTER.
  9517
  9518     IF SAVE-METHOD  = '3'
  9519         MOVE SAVE-COUNTER        TO WS-CLAIM-NUMBER-R1
  9520         GO TO 3090-SET-COMP
  9521     END-IF.
  9522
  9523     IF SAVE-METHOD  = '4'
  9524         MOVE SAVE-COUNTER       TO WS-CLAIM-NUMBER-R1
  9525         MOVE CLMCARRI           TO WS-CN-PRF-A
  9526         GO TO 3090-SET-COMP
  9527     END-IF.
  9528
  9529     MOVE ZEROS                  TO WS-CLAIM-NUMBER.
  9530     MOVE SAVE-COUNTER           TO WS-CN-NUMBER.
  9531     MOVE SAVE-DATE              TO CURR-DATE.
  9532
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 180
* EL130.cbl
  9533     IF CURR-MM LESS '10'
  9534         MOVE CURR-M2             TO WS-CN-PRF-B
  9535     END-IF.
  9536
  9537     IF CURR-MM = '10'
  9538        MOVE 'A'                 TO WS-CN-PRF-B
  9539     END-IF.
  9540     IF CURR-MM = '11'
  9541        MOVE 'B'                 TO WS-CN-PRF-B
  9542     END-IF.
  9543     IF CURR-MM = '12'
  9544        MOVE 'C'                 TO WS-CN-PRF-B
  9545     END-IF.
  9546
  9547     MOVE CURR-YEAR              TO WS-CN-PRF-A.
  9548
  9549 3090-SET-COMP.
  9550
  9551     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  9552     MOVE WS-CLAIM-NUMBER        TO MSTR-CLAIM-NO
  9553                                    CLMNOO.
  9554     MOVE AL-UANON               TO CLMNOA.
  9555     MOVE CERTNOI                TO MSTR-CERT-NO-PRIME.
  9556     MOVE SUFXI                  TO MSTR-CERT-NO-SUFX.
  9557     MOVE CLMCARRI               TO MSTR-CARRIER.
  9558
  9559
  9560
  9561* EXEC CICS HANDLE CONDITION
  9562*        NOTFND  (3200-BUILD-ZERO-TRAILER)
  9563*    END-EXEC.
  9564*    MOVE '"$I                   ! 5 #00009008' TO DFHEIV0
  9565     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9566     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9567     MOVE X'3520233030303039303038' TO DFHEIV0(25:11)
  9568     CALL 'kxdfhei1' USING DFHEIV0
  9569     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9570
  9571
  9572     PERFORM 7950-READ-CLAIM THRU 7950-EXIT.
  9573
  9574     GO TO 3080-ASSIGN-LOOP.
  9575
  9576 3100-CARRIER-NOT-FOUND.
  9577     MOVE ER-0252                TO EMI-ERROR.
  9578     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9579     MOVE -1                     TO CLMCARRL.
  9580     GO TO 8200-SEND-DATAONLY.
  9581
  9582 3110-COMPANY-NOT-FOUND.
  9583     MOVE ER-0254                TO EMI-ERROR.
  9584     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9585     MOVE -1                     TO MAINTL.
  9586     GO TO 8200-SEND-DATAONLY.
  9587
  9588 3120-CLAIM-MUST-BE-INPUT.
  9589     MOVE ER-0264                TO EMI-ERROR.
  9590     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 181
* EL130.cbl
  9591     MOVE -1                     TO CLMNOL.
  9592     GO TO 8200-SEND-DATAONLY.
  9593
  9594 3200-BUILD-ZERO-TRAILER.
  9595
  9596
  9597* EXEC CICS HANDLE CONDITION
  9598*        NOTFND
  9599*    END-EXEC.
  9600*    MOVE '"$                   ! 6 #00009036' TO DFHEIV0
  9601     MOVE X'2224B9202020202020202020' TO DFHEIV0(1:12)
  9602     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9603     MOVE X'3620233030303039303336' TO DFHEIV0(25:11)
  9604     CALL 'kxdfhei1' USING DFHEIV0
  9605     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9606
  9607
  9608
  9609
  9610* EXEC CICS GETMAIN
  9611*        SET     (ADDRESS OF ACTIVITY-TRAILERS)
  9612*        LENGTH  (ELTRLR-LENGTH)
  9613*    END-EXEC.
  9614*    MOVE '," L                  $   #00009041' TO DFHEIV0
  9615     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
  9616     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9617     MOVE X'2020233030303039303431' TO DFHEIV0(25:11)
  9618     CALL 'kxdfhei1' USING DFHEIV0,
  9619           DFHEIV20,
  9620           ELTRLR-LENGTH,
  9621           DFHEIV99
  9622     SET ADDRESS OF ACTIVITY-TRAILERS TO
  9623         DFHEIV20
  9624     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9625
  9626
  9627     MOVE SPACES                 TO ACTIVITY-TRAILERS.
  9628     MOVE 'AT'                   TO AT-RECORD-ID.
  9629
  9630     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
  9631     MOVE CLMCARRI               TO AT-CARRIER.
  9632     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
  9633     MOVE CERT-CERT-NO           TO AT-CERT-NO.
  9634     MOVE +0                     TO AT-SEQUENCE-NO.
  9635     MOVE '1'                    TO AT-TRAILER-TYPE.
  9636
  9637     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  9638     MOVE '5'                    TO DC-OPTION-CODE.
  9639     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  9640     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT
  9641                                    AT-RESERVES-LAST-MAINT-DT.
  9642
  9643     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
  9644                                    AT-RESERVES-LAST-UPDATED-BY.
  9645
  9646     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
  9647
  9648     MOVE WS-RESERVE-CONTROLS    TO AT-RESERVE-CONTROLS.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 182
* EL130.cbl
  9649
  9650     MOVE +0                     TO AT-FUTURE-RESERVE
  9651                                    AT-IBNR-RESERVE
  9652                                    AT-PAY-CURRENT-RESERVE
  9653                                    AT-INITIAL-MANUAL-RESERVE
  9654                                    AT-CURRENT-MANUAL-RESERVE
  9655                                    AT-ITD-LIFE-REFUNDS
  9656                                    AT-ITD-AH-REFUNDS
  9657                                    AT-ITD-ADDITIONAL-RESERVE.
  9658
  9659     MOVE LOW-VALUES             TO AT-LAST-COMPUTED-DT.
  9660
  9661     IF MANRSVL NOT = ZERO
  9662         MOVE WS-MANRSV          TO AT-INITIAL-MANUAL-RESERVE
  9663                                    AT-CURRENT-MANUAL-RESERVE
  9664     END-IF.
  9665
  9666     MOVE WS-EXPENSE-CONTROLS    TO AT-EXPENSE-CONTROLS.
  9667
  9668     MOVE +0                     TO AT-ITD-PAID-EXPENSES
  9669                                    AT-ITD-CHARGEABLE-EXPENSE.
  9670
  9671     MOVE WS-TODAY-DT            TO AT-OPEN-CLOSE-DATE (1).
  9672     MOVE 'O'                    TO AT-OPEN-CLOSE-TYPE (1).
  9673     MOVE 'NEW'                  TO AT-OPEN-CLOSE-REASON (1).
  9674
  9675
  9676
  9677* EXEC CICS WRITE
  9678*        DATASET   (ELTRLR-DSID)
  9679*        FROM      (ACTIVITY-TRAILERS)
  9680*        RIDFLD    (AT-CONTROL-PRIMARY)
  9681*    END-EXEC.
  9682     MOVE LENGTH OF
  9683      ACTIVITY-TRAILERS
  9684       TO DFHEIV11
  9685*    MOVE '&$ L                  ''   #00009095' TO DFHEIV0
  9686     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9687     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9688     MOVE X'2020233030303039303935' TO DFHEIV0(25:11)
  9689     CALL 'kxdfhei1' USING DFHEIV0,
  9690           ELTRLR-DSID,
  9691           ACTIVITY-TRAILERS,
  9692           DFHEIV11,
  9693           AT-CONTROL-PRIMARY,
  9694           DFHEIV99,
  9695           DFHEIV99
  9696     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9697
  9698
  9699     MOVE AT-CONTROL-PRIMARY  TO  SAVE-AT-PRIMARY-KEY.
  9700
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 183
* EL130.cbl
  9702
  9703 3250-BUILD-I1-ADDRESS-TRAILER.
  9704
  9705     MOVE 'N'                    TO WS-NO-INSURED-ADDRESS.
  9706     MOVE +0                     TO WS-INSURED-ADDR-CNT.
  9707     MOVE PI-COMPANY-CD          TO WS-MA-COMPANY-CD.
  9708     MOVE CRTCARRI               TO WS-MA-CARRIER.
  9709     MOVE GROUPI                 TO WS-MA-GROUPING.
  9710     MOVE STATEI                 TO WS-MA-STATE.
  9711     MOVE PI-SAVE-ACCOUNT        TO WS-MA-ACCOUNT.
  9712     MOVE CERTNOI                TO WS-MA-CERT-PRIME.
  9713     MOVE SUFXI                  TO WS-MA-CERT-SFX.
  9714     MOVE PI-SAVE-EFFDT          TO WS-MA-CERT-EFF-DT.
  9715
  9716
  9717* EXEC CICS HANDLE CONDITION
  9718*        NOTFND   (3290-NO-INSURED-ADDRESS)
  9719*    END-EXEC.
  9720*    MOVE '"$I                   ! 7 #00009118' TO DFHEIV0
  9721     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9722     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9723     MOVE X'3720233030303039313138' TO DFHEIV0(25:11)
  9724     CALL 'kxdfhei1' USING DFHEIV0
  9725     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9726
  9727
  9728
  9729* EXEC CICS READ
  9730*        EQUAL
  9731*        DATASET   (ERMAIL-DSID)
  9732*        SET       (ADDRESS OF MAILING-DATA)
  9733*        RIDFLD    (WS-MA-CONTROL-PRIMARY)
  9734*    END-EXEC.
  9735*    MOVE '&"S        E          (   #00009122' TO DFHEIV0
  9736     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9737     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9738     MOVE X'2020233030303039313232' TO DFHEIV0(25:11)
  9739     CALL 'kxdfhei1' USING DFHEIV0,
  9740           ERMAIL-DSID,
  9741           DFHEIV20,
  9742           DFHEIV99,
  9743           WS-MA-CONTROL-PRIMARY,
  9744           DFHEIV99,
  9745           DFHEIV99,
  9746           DFHEIV99
  9747     SET ADDRESS OF MAILING-DATA TO
  9748         DFHEIV20
  9749     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9750
  9751
  9752     IF MA-INSURED-LAST-NAME NOT GREATER THAN SPACES
  9753         GO TO 3290-NO-INSURED-ADDRESS
  9754     END-IF.
  9755
  9756     MOVE SPACES                 TO ACTIVITY-TRAILERS.
  9757     MOVE 'AT'                   TO AT-RECORD-ID.
  9758
  9759     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 184
* EL130.cbl
  9760     MOVE CLMCARRI               TO AT-CARRIER.
  9761     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
  9762     MOVE CERT-CERT-NO           TO AT-CERT-NO.
  9763     MOVE +1                     TO AT-SEQUENCE-NO.
  9764     MOVE '5'                    TO AT-TRAILER-TYPE.
  9765
  9766     MOVE 'I'                    TO AT-ADDRESS-TYPE.
  9767     IF MA-INSURED-MIDDLE-INIT > SPACES
  9768        STRING MA-INSURED-FIRST-NAME DELIMITED BY '  '
  9769               ' ' DELIMITED BY SIZE
  9770               MA-INSURED-MIDDLE-INIT DELIMITED BY SIZE
  9771               ' ' DELIMITED BY SIZE
  9772               MA-INSURED-LAST-NAME DELIMITED BY SIZE
  9773        INTO AT-MAIL-TO-NAME
  9774     ELSE
  9775        STRING MA-INSURED-FIRST-NAME DELIMITED BY '  '
  9776               ' ' DELIMITED BY SIZE
  9777               MA-INSURED-LAST-NAME DELIMITED BY SIZE
  9778        INTO AT-MAIL-TO-NAME
  9779     END-IF.
  9780     MOVE MA-ADDRESS-LINE-1      TO AT-ADDRESS-LINE-1.
  9781     MOVE MA-ADDRESS-LINE-2      TO AT-ADDRESS-LINE-2.
  9782*    MOVE MA-CITY-STATE          TO AT-CITY-STATE.
  9783     MOVE MA-CITY                TO AT-CITY
  9784     MOVE MA-ADDR-STATE          TO AT-STATE
  9785     MOVE MA-ZIP                 TO AT-ZIP
  9786     MOVE MA-PHONE-NO            TO AT-PHONE-NO
  9787
  9788     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT
  9789                                    AT-ADDRESS-LAST-MAINT-DT.
  9790
  9791     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
  9792                                    AT-ADDRESS-LAST-UPDATED-BY.
  9793
  9794     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
  9795
  9796
  9797* EXEC CICS WRITE
  9798*        DATASET   (ELTRLR-DSID)
  9799*        FROM      (ACTIVITY-TRAILERS)
  9800*        RIDFLD    (AT-CONTROL-PRIMARY)
  9801*    END-EXEC.
  9802     MOVE LENGTH OF
  9803      ACTIVITY-TRAILERS
  9804       TO DFHEIV11
  9805*    MOVE '&$ L                  ''   #00009173' TO DFHEIV0
  9806     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9807     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9808     MOVE X'2020233030303039313733' TO DFHEIV0(25:11)
  9809     CALL 'kxdfhei1' USING DFHEIV0,
  9810           ELTRLR-DSID,
  9811           ACTIVITY-TRAILERS,
  9812           DFHEIV11,
  9813           AT-CONTROL-PRIMARY,
  9814           DFHEIV99,
  9815           DFHEIV99
  9816     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9817
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 185
* EL130.cbl
  9818
  9819     ADD +1                      TO WS-INSURED-ADDR-CNT.
  9820     GO TO 3300-BUILD-NINETY-TRAILER.
  9821
  9822 3290-NO-INSURED-ADDRESS.
  9823      MOVE 'Y' TO WS-NO-INSURED-ADDRESS.
  9824
  9825 3300-BUILD-NINETY-TRAILER.
  9826
  9827     MOVE SPACES                 TO ACTIVITY-TRAILERS.
  9828     MOVE 'AT'                   TO AT-RECORD-ID.
  9829
  9830     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
  9831     MOVE CLMCARRI               TO AT-CARRIER.
  9832
  9833     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
  9834     MOVE CERT-CERT-NO           TO AT-CERT-NO.
  9835     MOVE +90                    TO AT-SEQUENCE-NO.
  9836     MOVE '6'                    TO AT-TRAILER-TYPE.
  9837
  9838     IF DIAGL NOT = ZERO
  9839         MOVE DIAGI              TO AT-INFO-LINE-1
  9840     END-IF.
  9841
  9842     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT
  9843                                    AT-GEN-INFO-LAST-MAINT-DT.
  9844
  9845     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
  9846                                    AT-GEN-INFO-LAST-UPDATED-BY.
  9847     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
  9848
  9849
  9850
  9851* EXEC CICS WRITE
  9852*        DATASET   (ELTRLR-DSID)
  9853*        FROM      (ACTIVITY-TRAILERS)
  9854*        RIDFLD    (AT-CONTROL-PRIMARY)
  9855*    END-EXEC.
  9856     MOVE LENGTH OF
  9857      ACTIVITY-TRAILERS
  9858       TO DFHEIV11
  9859*    MOVE '&$ L                  ''   #00009210' TO DFHEIV0
  9860     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9861     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9862     MOVE X'2020233030303039323130' TO DFHEIV0(25:11)
  9863     CALL 'kxdfhei1' USING DFHEIV0,
  9864           ELTRLR-DSID,
  9865           ACTIVITY-TRAILERS,
  9866           DFHEIV11,
  9867           AT-CONTROL-PRIMARY,
  9868           DFHEIV99,
  9869           DFHEIV99
  9870     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9871
  9872
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 186
* EL130.cbl
  9874 3400-CHECK-CERT-MAINT.
  9875
  9876     IF CERTMTI = 'A'
  9877         GO TO 3600-BUILD-NEW-CERT
  9878     END-IF.
  9879
  9880     IF NO-CLAIM-ATTACHED
  9881         MOVE '1'                TO CM-CLAIM-INTERFACE-SW
  9882     END-IF.
  9883
  9884     ADD +1                      TO CM-CLAIM-ATTACHED-COUNT.
  9885
  9886     IF CM-LF-CURRENT-STATUS = '2' OR
  9887        CM-AH-CURRENT-STATUS = '2'
  9888         GO TO 3400-REWRITE-CERT
  9889     END-IF.
  9890
  9891     PERFORM 3700-BUILD-CERT THRU 3700-EXIT.
  9892
  9893 3400-REWRITE-CERT.
  9894
  9895
  9896
  9897* EXEC CICS HANDLE CONDITION
  9898*        DUPKEY (3410-DUP-KEY)
  9899*    END-EXEC.
  9900*    MOVE '"$$                   ! 8 #00009239' TO DFHEIV0
  9901     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  9902     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9903     MOVE X'3820233030303039323339' TO DFHEIV0(25:11)
  9904     CALL 'kxdfhei1' USING DFHEIV0
  9905     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9906
  9907
  9908
  9909
  9910* EXEC CICS REWRITE
  9911*        DATASET   (ELCERT-DSID)
  9912*        FROM      (CERTIFICATE-MASTER)
  9913*    END-EXEC.
  9914     MOVE LENGTH OF
  9915      CERTIFICATE-MASTER
  9916       TO DFHEIV11
  9917*    MOVE '&& L                  %   #00009244' TO DFHEIV0
  9918     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9919     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9920     MOVE X'2020233030303039323434' TO DFHEIV0(25:11)
  9921     CALL 'kxdfhei1' USING DFHEIV0,
  9922           ELCERT-DSID,
  9923           CERTIFICATE-MASTER,
  9924           DFHEIV11,
  9925           DFHEIV99
  9926     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9927
  9928
  9929 3410-DUP-KEY.
  9930     GO TO 3800-BUILD-NEW-CLAIM.
  9931
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 187
* EL130.cbl
  9932 3600-BUILD-NEW-CERT.
  9933
  9934
  9935* EXEC CICS GETMAIN
  9936*        SET      (ADDRESS OF CERTIFICATE-MASTER)
  9937*        LENGTH   (ELCERT-LENGTH)
  9938*    END-EXEC.
  9939*    MOVE '," L                  $   #00009254' TO DFHEIV0
  9940     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
  9941     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9942     MOVE X'2020233030303039323534' TO DFHEIV0(25:11)
  9943     CALL 'kxdfhei1' USING DFHEIV0,
  9944           DFHEIV20,
  9945           ELCERT-LENGTH,
  9946           DFHEIV99
  9947     SET ADDRESS OF CERTIFICATE-MASTER TO
  9948         DFHEIV20
  9949     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9950
  9951
  9952     MOVE SPACES                 TO CERTIFICATE-MASTER.
  9953
  9954     MOVE 'CM'                   TO CM-RECORD-ID.
  9955
  9956     MOVE PI-COMPANY-CD          TO CM-COMPANY-CD
  9957                                    CM-COMPANY-CD-A1
  9958                                    CM-COMPANY-CD-A2
  9959                                    CM-COMPANY-CD-A4
  9960                                    CM-COMPANY-CD-A5.
  9961
  9962     MOVE CERT-CARRIER           TO CM-CARRIER.
  9963     MOVE CERT-GROUPING          TO CM-GROUPING.
  9964     MOVE CERT-STATE             TO CM-STATE.
  9965     MOVE CERT-ACCOUNT           TO CM-ACCOUNT.
  9966     MOVE CERT-CERT-NO           TO CM-CERT-NO  CM-CERT-NO-A4.
  9967     MOVE CERT-EFF-DT            TO CM-CERT-EFF-DT.
  9968
  9969     MOVE ZERO      TO CM-LF-ORIG-TERM       CM-LF-BENEFIT-AMT
  9970                       CM-INSURED-ISSUE-AGE  CM-INSURED-JOINT-AGE
  9971                       CM-LF-BENEFIT-CD      CM-AH-BENEFIT-CD
  9972                       CM-LF-PREMIUM-AMT     CM-LF-REMAINING-AMT
  9973                       CM-LF-ITD-CANCEL-AMT  CM-LF-ITD-DEATH-AMT
  9974                       CM-LIVES              CM-LOAN-TERM
  9975                       CM-AH-ITD-AH-PMT      CM-AH-NSP-PREMIUM-AMT
  9976                       CM-AH-DEV-PCT         CM-AH-CRITICAL-PERIOD
  9977                       CM-LF-TERM-IN-DAYS    CM-LF-ALT-PREMIUM-AMT
  9978                       CM-LF-DEV-PCT         CM-LF-NSP-PREMIUM-AMT
  9979                       CM-LF-CRITICAL-PERIOD CM-LF-ALT-BENEFIT-AMT
  9980                       CM-LF-PREMIUM-RATE    CM-AH-PREMIUM-RATE
  9981                       CM-LF-ALT-PREMIUM-RATE
  9982                       CM-AH-ORIG-TERM       CM-AH-BENEFIT-AMT
  9983                       CM-AH-PREMIUM-AMT     CM-AH-ITD-CANCEL-AMT
  9984                       CM-AH-ITD-LUMP-PMT    CM-LOAN-APR
  9985                       CM-LOAN-BALANCE       CM-PAY-FREQUENCY
  9986                       CM-LIFE-COMM-PCT      CM-AH-COMM-PCT.
  9987
  9988     MOVE LOW-VALUES             TO CM-AH-LOAN-EXPIRE-DT
  9989                                    CM-AH-CANCEL-DT
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 188
* EL130.cbl
  9990                                    CM-AH-SETTLEMENT-DT
  9991                                    CM-AH-CANCEL-EXIT-DT
  9992                                    CM-AH-SETTLEMENT-EXIT-DT
  9993                                    CM-LF-LOAN-EXPIRE-DT
  9994                                    CM-LF-CANCEL-DT
  9995                                    CM-LF-DEATH-DT
  9996                                    CM-LF-CANCEL-EXIT-DT
  9997                                    CM-LF-DEATH-EXIT-DT
  9998                                    CM-LAST-ADD-ON-DT
  9999                                    CM-ENTRY-DT.
 10000
 10001     MOVE '2'                    TO CM-CLAIM-INTERFACE-SW.
 10002     MOVE +1                     TO CM-CLAIM-ATTACHED-COUNT.
 10003     MOVE LOW-VALUES             TO CM-LAST-MONTH-END.
 10004
 10005     MOVE CRTLNMEI               TO CM-INSURED-LAST-NAME
 10006                                    CM-PART-LAST-NAME-A2
 10007                                    CM-PART-LAST-NAME-A5.
 10008
 10009     MOVE CRTFNMEI               TO CM-INSURED-INITIAL1
 10010                                    CM-INSURED-INITIAL1-A2
 10011                                    CM-INSURED-INITIAL1-A5
 10012                                    CM-INSURED-FIRST-NAME.
 10013
 10014     IF CRTINITL GREATER ZERO
 10015         MOVE CRTINITI           TO CM-INSURED-INITIAL2
 10016                                    CM-INSURED-INITIAL2-A2
 10017                                    CM-INSURED-INITIAL2-A5
 10018     ELSE
 10019         MOVE SPACES             TO CM-INSURED-INITIAL2
 10020                                    CM-INSURED-INITIAL2-A2
 10021                                    CM-INSURED-INITIAL2-A5
 10022     END-IF.
 10023
 10024     IF CM-INSURED-INITIALS = SPACES
 10025         MOVE '**'               TO CM-INSURED-INITIALS
 10026     END-IF.
 10027
 10028     IF MEMBERL GREATER ZERO
 10029         MOVE MEMBERI              TO CM-MEMBER-NO
 10030     ELSE
 10031         MOVE CERT-STATE           TO CM-MEMB-STATE
 10032         MOVE CERT-ACCOUNT-PRIME   TO CM-MEMB-ACCOUNT
 10033         MOVE CM-INSURED-INITIALS  TO CM-INSURED-INITIALS-A5
 10034         MOVE CM-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A5
 10035     END-IF.
 10036
 10037     IF JNTLNMEL GREATER ZERO
 10038         MOVE JNTLNMEI           TO CM-JT-LAST-NAME
 10039     END-IF.
 10040
 10041     IF JNTFNMEL GREATER ZERO
 10042         MOVE JNTFNMEI           TO CM-JT-FIRST-NAME
 10043     END-IF.
 10044
 10045     IF JNTINITL GREATER ZERO
 10046         MOVE JNTINITI           TO CM-JT-INITIAL
 10047     END-IF.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 189
* EL130.cbl
 10048
 10049     PERFORM 3700-BUILD-CERT THRU 3700-EXIT.
 10050
 10051
 10052
 10053* EXEC CICS HANDLE CONDITION
 10054*        DUPKEY   (3690-CERT-WRITTEN)
 10055*    END-EXEC.
 10056*    MOVE '"$$                   ! 9 #00009359' TO DFHEIV0
 10057     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10058     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10059     MOVE X'3920233030303039333539' TO DFHEIV0(25:11)
 10060     CALL 'kxdfhei1' USING DFHEIV0
 10061     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10062
 10063
 10064
 10065
 10066* EXEC CICS WRITE
 10067*        DATASET   (ELCERT-DSID)
 10068*        FROM      (CERTIFICATE-MASTER)
 10069*        RIDFLD    (CM-CONTROL-PRIMARY)
 10070*    END-EXEC.
 10071     MOVE LENGTH OF
 10072      CERTIFICATE-MASTER
 10073       TO DFHEIV11
 10074*    MOVE '&$ L                  ''   #00009364' TO DFHEIV0
 10075     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10076     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10077     MOVE X'2020233030303039333634' TO DFHEIV0(25:11)
 10078     CALL 'kxdfhei1' USING DFHEIV0,
 10079           ELCERT-DSID,
 10080           CERTIFICATE-MASTER,
 10081           DFHEIV11,
 10082           CM-CONTROL-PRIMARY,
 10083           DFHEIV99,
 10084           DFHEIV99
 10085     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10086
 10087
 10088 3690-CERT-WRITTEN.
 10089
 10090     GO TO 3800-BUILD-NEW-CLAIM.
 10091
 10092 3690-EXIT.
 10093      EXIT.
 10094
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 190
* EL130.cbl
 10096 3700-BUILD-CERT.
 10097
 10098     IF CERTMTI NOT = 'A'
 10099         GO TO 3700-FINISH-CERT-BUILD
 10100     END-IF.
 10101
 10102     IF CERTMTI = 'A'
 10103         IF LCVCDL = ZEROS
 10104             MOVE ZEROS          TO CM-LF-BENEFIT-CD
 10105                                    CM-LF-ORIG-TERM
 10106                                    CM-LF-BENEFIT-AMT
 10107                                    CM-LF-PREMIUM-RATE
 10108             GO TO 3700-BUILD-AH-COVERAGE-SIDE
 10109         END-IF
 10110     END-IF.
 10111
 10112     IF LCVCDL GREATER ZERO
 10113         MOVE LCVCDI             TO CM-LF-BENEFIT-CD
 10114     END-IF.
 10115
 10116     IF LCVOTRML GREATER ZERO
 10117         MOVE LCVOTRMI           TO CM-LF-ORIG-TERM
 10118     END-IF.
 10119
 10120     IF LCVBENEL GREATER ZERO
 10121         MOVE WS-LCVBENE         TO CM-LF-BENEFIT-AMT
 10122     END-IF.
 10123
 10124     IF LCVRATEL GREATER ZERO
 10125         MOVE WS-LCVRATE         TO CM-LF-PREMIUM-RATE
 10126     END-IF.
 10127
 10128     IF WS-EXPIRE NOT = LOW-VALUES
 10129         MOVE WS-EXPIRE          TO CM-LF-LOAN-EXPIRE-DT
 10130     END-IF.
 10131
 10132     IF LCVFORML GREATER ZERO
 10133         MOVE LCVFORMI           TO CM-POLICY-FORM-NO
 10134     END-IF.
 10135
 10136     IF LCVCNDTL = ZERO
 10137        GO TO 3700-BUILD-AH-COVERAGE-SIDE
 10138     END-IF.
 10139
 10140     IF WS-LCVCNDT NOT = LOW-VALUES
 10141        MOVE '8'                 TO CM-LF-CURRENT-STATUS
 10142        MOVE WS-LCVCNDT          TO CM-LF-CANCEL-DT
 10143        GO TO 3700-BUILD-AH-COVERAGE-SIDE
 10144     END-IF.
 10145
 10146     IF CM-LF-CURRENT-STATUS = '7'
 10147        MOVE CM-LF-STATUS-AT-DEATH TO CM-LF-CURRENT-STATUS
 10148        MOVE SPACES              TO CM-LF-STATUS-AT-DEATH
 10149        MOVE LOW-VALUES          TO CM-LF-DEATH-EXIT-DT
 10150                                    CM-LF-DEATH-DT
 10151        GO TO 3700-BUILD-AH-COVERAGE-SIDE
 10152     END-IF.
 10153
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 191
* EL130.cbl
 10154     IF CM-LF-CURRENT-STATUS = '8'
 10155        MOVE '1'                 TO CM-LF-CURRENT-STATUS
 10156        MOVE LOW-VALUES          TO CM-LF-CANCEL-DT
 10157     END-IF.
 10158
 10159 3700-BUILD-AH-COVERAGE-SIDE.
 10160
 10161     IF CERTMTI = 'A'
 10162         IF ACVCDL = ZEROS
 10163             MOVE ZEROS          TO CM-AH-BENEFIT-CD
 10164                                    CM-AH-ORIG-TERM
 10165                                    CM-AH-BENEFIT-AMT
 10166                                    CM-AH-PREMIUM-RATE
 10167             GO TO 3700-COVERAGE-BUILT
 10168         END-IF
 10169     END-IF.
 10170
 10171     IF ACVCDL GREATER ZERO
 10172         MOVE ACVCDI             TO CM-AH-BENEFIT-CD
 10173     END-IF.
 10174
 10175     IF ACVOTRML GREATER ZERO
 10176         MOVE ACVOTRMI           TO CM-AH-ORIG-TERM
 10177     END-IF.
 10178
 10179     IF ACVBENEL GREATER ZERO
 10180         MOVE WS-ACVBENE         TO CM-AH-BENEFIT-AMT
 10181     END-IF.
 10182
 10183     IF ACVRATEL GREATER ZERO
 10184         MOVE WS-ACVRATE         TO CM-AH-PREMIUM-RATE
 10185     END-IF.
 10186
 10187     IF WS-EXPIRE NOT = LOW-VALUES
 10188         MOVE WS-EXPIRE          TO CM-AH-LOAN-EXPIRE-DT
 10189     END-IF.
 10190
 10191     IF ACVFORML GREATER ZERO
 10192         MOVE ACVFORMI           TO CM-POLICY-FORM-NO
 10193     END-IF.
 10194
 10195     IF ACVCNDTL = ZERO
 10196        GO TO 3700-COVERAGE-BUILT
 10197     END-IF.
 10198
 10199     IF WS-ACVCNDT NOT = LOW-VALUES
 10200        MOVE '8'                 TO CM-AH-CURRENT-STATUS
 10201        MOVE WS-ACVCNDT          TO CM-AH-CANCEL-DT
 10202        GO TO 3700-COVERAGE-BUILT
 10203     END-IF.
 10204
 10205     IF CM-AH-CURRENT-STATUS = '6'
 10206        MOVE CM-AH-STATUS-AT-SETTLEMENT TO CM-AH-CURRENT-STATUS
 10207        MOVE SPACES              TO CM-AH-STATUS-AT-SETTLEMENT
 10208        MOVE LOW-VALUES          TO CM-AH-SETTLEMENT-EXIT-DT
 10209        MOVE LOW-VALUES          TO CM-AH-SETTLEMENT-DT
 10210        GO TO 3700-COVERAGE-BUILT
 10211     END-IF.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 192
* EL130.cbl
 10212
 10213     IF CM-AH-CURRENT-STATUS = '8'
 10214        MOVE '1'                 TO CM-AH-CURRENT-STATUS
 10215        MOVE LOW-VALUES          TO CM-AH-CANCEL-DT
 10216     END-IF.
 10217
 10218 3700-COVERAGE-BUILT.
 10219     IF ISSAGEL GREATER ZERO
 10220         MOVE ISSAGEI            TO CM-INSURED-ISSUE-AGE
 10221     END-IF.
 10222
 10223     IF JNTAGEL GREATER ZERO
 10224         MOVE JNTAGEI            TO CM-INSURED-JOINT-AGE
 10225     END-IF.
 10226
 10227     IF SEXL GREATER ZERO
 10228         MOVE SEXI               TO CM-INSURED-SEX
 10229     END-IF.
 10230
 10231     IF APRL GREATER ZERO
 10232         MOVE WS-APR             TO CM-LOAN-APR
 10233     END-IF.
 10234
 10235     IF PMTFREQL GREATER ZERO
 10236         MOVE WS-PMTFREQ         TO CM-PAY-FREQUENCY
 10237     END-IF.
 10238
 10239     IF INDGRPL GREATER ZERO
 10240         MOVE INDGRPI            TO CM-IND-GRP-TYPE
 10241     END-IF.
 10242
 10243     IF CERTMTI = 'A'
 10244         MOVE WS-REIN-TABLE      TO CM-REIN-TABLE
 10245     END-IF.
 10246
 10247     IF REINCDL GREATER ZERO
 10248         MOVE REINCDI            TO CM-SPECIAL-REIN-CODE
 10249                                    WS-REIN-1
 10250                                    WS-REIN-2
 10251                                    WS-REIN-3
 10252         MOVE WS-REIN-TABLE      TO CM-REIN-TABLE
 10253     END-IF.
 10254
 10255     IF WS-ADD-ON-DT NOT = LOW-VALUES
 10256         MOVE WS-ADD-ON-DT   TO CM-LAST-ADD-ON-DT
 10257     END-IF.
 10258
 10259     IF CRTSSNL GREATER ZERO
 10260         MOVE CRTSSNI            TO CM-SOC-SEC-NO
 10261     ELSE
 10262         IF SSNL GREATER ZERO
 10263             MOVE SSNI           TO CM-SOC-SEC-NO
 10264         END-IF
 10265     END-IF.
 10266
 10267     IF CRTSSNL = ZERO AND
 10268        SSNL    = ZERO
 10269         MOVE CM-STATE             TO CM-SSN-STATE
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 193
* EL130.cbl
 10270         MOVE CM-ACCOUNT-PRIME     TO CM-SSN-ACCOUNT
 10271         MOVE CM-INSURED-INITIALS  TO CM-INSURED-INITIALS-A2
 10272         MOVE CM-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A2
 10273     END-IF.
 10274
 10275     IF CM-LF-CURRENT-STATUS = SPACES
 10276         MOVE '1'                TO CM-LF-CURRENT-STATUS
 10277     END-IF.
 10278
 10279     IF CM-AH-CURRENT-STATUS = SPACES
 10280         MOVE '1'                TO CM-AH-CURRENT-STATUS
 10281     END-IF.
 10282
 10283     IF CERTMTI = 'A'
 10284         MOVE SAVE-BIN-DATE      TO CM-ENTRY-DT
 10285     END-IF.
 10286
 10287 3700-FINISH-CERT-BUILD.
 10288
 10289     IF LOANNOL GREATER ZERO
 10290         MOVE LOANNOI            TO CM-LOAN-NUMBER
 10291     END-IF.
 10292
 10293     IF LOANBALL GREATER ZERO
 10294         MOVE HOLD-LOAN-BAL      TO CM-LOAN-BALANCE
 10295     END-IF.
 10296
 10297     IF PREMTYPL GREATER ZERO
 10298         MOVE PREMTYPI           TO CM-PREMIUM-TYPE
 10299     END-IF.
 10300
 10301 3700-EXIT.
 10302      EXIT.
 10303
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 194
* EL130.cbl
 10305 3800-BUILD-NEW-CLAIM.
 10306
 10307*************************************************************
 10308*****           START OF ACTIVITY FILE PROCESSING          **
 10309*************************************************************
 10310     IF PI-COMPANY-ID EQUAL 'CID' OR 'AHL'
 10311         PERFORM 6700-OUTPUT-ACTIVITY-RECORD THRU
 10312                 6700-EXIT
 10313     END-IF.
 10314*************************************************************
 10315*****            END OF ACTIVITY FILE PROCESSING           **
 10316*************************************************************
 10317
 10318
 10319
 10320
 10321* EXEC CICS GETMAIN
 10322*        SET     (ADDRESS OF CLAIM-MASTER)
 10323*        LENGTH  (ELMSTR-LENGTH)
 10324*    END-EXEC.
 10325*    MOVE '," L                  $   #00009602' TO DFHEIV0
 10326     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 10327     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10328     MOVE X'2020233030303039363032' TO DFHEIV0(25:11)
 10329     CALL 'kxdfhei1' USING DFHEIV0,
 10330           DFHEIV20,
 10331           ELMSTR-LENGTH,
 10332           DFHEIV99
 10333     SET ADDRESS OF CLAIM-MASTER TO
 10334         DFHEIV20
 10335     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10336
 10337
 10338     MOVE SPACES TO CLAIM-MASTER.
 10339
 10340     MOVE LOW-VALUES   TO       CL-INSURED-BIRTH-DT CL-INCURRED-DT
 10341         CL-NEXT-FOLLOWUP-DT    CL-REPORTED-DT      CL-LAST-PMT-DT
 10342         CL-EST-END-OF-DISAB-DT CL-PAID-THRU-DT   CL-LAST-CLOSE-DT
 10343         CL-LAST-REOPEN-DT      CL-PURGED-DT        CL-RESTORED-DT
 10344         CL-NEXT-AUTO-PAY-DT    CL-NEXT-RESEND-DT
 10345         CL-LAST-ADD-ON-DT      CL-FILE-ESTABLISH-DT
 10346         CL-LAST-MAINT-DT       CL-HISTORY-ARCHIVE-DT
 10347         CL-ACTIVITY-MAINT-DT   cl-benefit-expiration-dt
 10348         cl-rtw-dt
 10349
 10350     MOVE +0 TO CL-LAST-PMT-AMT      CL-TOTAL-PAID-AMT
 10351             CL-NO-OF-PMTS-MADE      CL-NO-OF-DAYS-PAID
 10352             CL-LAST-INC-DT-CHANGE   CL-AUTO-PAY-SEQ
 10353             CL-INSURED-ADDR-CNT     CL-ACCOUNT-ADDR-CNT
 10354             CL-BENIF-ADDR-CNT       CL-EMPLOYER-ADDR-CNT
 10355             CL-DOCTOR-ADDR-CNT      CL-OTHER-1-ADDR-CNT
 10356             CL-OTHER-2-ADDR-CNT     CL-FATAL-ERROR-CNT
 10357             CL-CLAIM-PAYMENT-STATUS CL-LAST-MAINT-HHMMSS
 10358             CL-FORCEABLE-ERROR-CNT.
 10359
 10360     MOVE WS-INSURED-ADDR-CNT    TO CL-INSURED-ADDR-CNT.
 10361
 10362     MOVE ZEROS                  TO CL-ACTIVITY-CODE
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 195
* EL130.cbl
 10363                                    CL-LAPSE-REPORT-CODE
 10364                                    CL-LAG-REPORT-CODE
 10365                                    CL-CRITICAL-PERIOD
 10366                                    CL-CRIT-PER-RTW-MOS
 10367
 10368     MOVE EMI-FORCABLE-CTR       TO CL-FORCEABLE-ERROR-CNT.
 10369     MOVE +4095                  TO CL-TRAILER-SEQ-CNT.
 10370
 10371     IF BENECDL NOT = ZEROS
 10372        MOVE BENECDI             TO CL-BENEFICIARY
 10373     END-IF.
 10374
 10375     MOVE 'CL'                   TO CL-RECORD-ID.
 10376     MOVE 'CR'                   TO CL-SYSTEM-IDENTIFIER.
 10377
 10378     MOVE PI-COMPANY-CD  TO  CL-COMPANY-CD     CL-COMPANY-CD-A1
 10379                             CL-COMPANY-CD-A2  CL-COMPANY-CD-A4
 10380                             CL-COMPANY-CD-A5.
 10381
 10382     MOVE CLMCARRI               TO CL-CARRIER.
 10383
 10384     IF CLMNOL = ZERO
 10385         MOVE WS-CLAIM-NUMBER    TO CL-CLAIM-NO
 10386     ELSE
 10387         MOVE CLMNOI             TO CL-CLAIM-NO
 10388     END-IF.
 10389
 10390     MOVE CERTNOI                TO CL-CERT-PRIME
 10391                                    CL-CERT-A4-PRIME.
 10392
 10393     MOVE SUFXI                  TO CL-CERT-SFX
 10394                                    CL-CERT-A4-SFX.
 10395
 10396     MOVE PCERTNOI               TO CL-PRIME-CERT-PRIME.
 10397
 10398     MOVE PSUFXI                 TO CL-PRIME-CERT-SFX.
 10399
 10400     MOVE CL-PRIME-CERT-NO       TO PI-PRIMARY-CERT-NO.
 10401
 10402     MOVE LSTNMEI                TO CL-INSURED-LAST-NAME.
 10403
 10404     MOVE WS-TODAY-DT            TO CL-FILE-ESTABLISH-DT.
 10405     MOVE ' '                    TO CL-LAST-MAINT-TYPE.
 10406
 10407     PERFORM 3995-BUILD-CLAIM-RECORD THRU 3995-EXIT.
 10408
 10409     IF CERTMTI = 'A'
 10410         MOVE '2'                TO CL-CERT-ORIGIN
 10411     ELSE
 10412         MOVE '1'                TO CL-CERT-ORIGIN
 10413     END-IF.
 10414
 10415     MOVE CERT-CARRIER        TO CL-CERT-CARRIER   PI-CARRIER.
 10416     MOVE CERT-GROUPING       TO CL-CERT-GROUPING  PI-GROUPING.
 10417     MOVE CERT-STATE          TO CL-CERT-STATE     PI-STATE.
 10418     MOVE CERT-ACCOUNT        TO CL-CERT-ACCOUNT   PI-ACCOUNT.
 10419     MOVE WS-EFFDT            TO CL-CERT-EFF-DT    PI-CERT-EFF-DT.
 10420
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 196
* EL130.cbl
 10421 3820-REWRITE-CONTROL-FILE.
 10422
 10423     IF CLMNOL GREATER ZERO
 10424         GO TO 3830-SEQUENCE-CLAIM-RECORDS
 10425     END-IF.
 10426
 10427     IF CF-RECORD-TYPE = '6'
 10428         MOVE SAVE-COUNTER    TO  CF-CLAIM-COUNTER
 10429     ELSE
 10430         MOVE SAVE-COUNTER    TO  CF-CO-CLAIM-COUNTER
 10431     END-IF.
 10432
 10433
 10434
 10435* EXEC CICS REWRITE
 10436*        DATASET   (ELCNTL-DSID)
 10437*        FROM      (CONTROL-FILE)
 10438*    END-EXEC.
 10439     MOVE LENGTH OF
 10440      CONTROL-FILE
 10441       TO DFHEIV11
 10442*    MOVE '&& L                  %   #00009703' TO DFHEIV0
 10443     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10444     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10445     MOVE X'2020233030303039373033' TO DFHEIV0(25:11)
 10446     CALL 'kxdfhei1' USING DFHEIV0,
 10447           ELCNTL-DSID,
 10448           CONTROL-FILE,
 10449           DFHEIV11,
 10450           DFHEIV99
 10451     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10452
 10453
 10454 3830-SEQUENCE-CLAIM-RECORDS.
 10455
 10456     MOVE CLAIM-MASTER           TO WS-SAVE-CLAIM-MASTER.
 10457     MOVE CL-CONTROL-PRIMARY     TO ELMSTR-KEY.
 10458     PERFORM 7700-CHECK-SEQUENCE THRU 7799-EXIT.
 10459
 10460     IF WS-ASSOC-CERT-TOTAL = ZERO
 10461         MOVE 1                  TO CL-ASSOC-CERT-SEQU
 10462                                    CL-ASSOC-CERT-TOTAL
 10463         GO TO 3840-WRITE-CLAIM-MASTER
 10464     END-IF.
 10465
 10466     IF CL-CONTROL-PRIMARY LESS THAN WS-SAVE-CLAIM-KEY
 10467         MOVE CL-CONTROL-PRIMARY TO ELMSTR-KEY
 10468     ELSE
 10469         MOVE WS-SAVE-CLAIM-KEY  TO ELMSTR-KEY
 10470     END-IF.
 10471
 10472     MOVE WS-SAVE-CLAIM-MASTER   TO CLAIM-MASTER.
 10473     MOVE ZERO                   TO CL-ASSOC-CERT-SEQU.
 10474     MOVE WS-ASSOC-CERT-TOTAL    TO CL-ASSOC-CERT-TOTAL.
 10475
 10476 3840-WRITE-CLAIM-MASTER.
 10477
 10478     PERFORM 6600-CHECK-AUTO-ACTIVITY THRU 6600-EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 197
* EL130.cbl
 10479     IF WS-REC-FOUND-SW = 'Y'
 10480         MOVE 01                 TO  CL-ACTIVITY-CODE
 10481         MOVE SAVE-BIN-DATE      TO  CL-ACTIVITY-MAINT-DT
 10482         MOVE 'ADD '             TO  CL-ACTIVITY-MAINT-TYPE
 10483     END-IF.
 10484
 10485
 10486
 10487* EXEC CICS HANDLE CONDITION
 10488*         DUPKEY    (3850-CLAIM-MSTR-WRITTEN)
 10489*    END-EXEC.
 10490*    MOVE '"$$                   ! : #00009740' TO DFHEIV0
 10491     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10492     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10493     MOVE X'3A20233030303039373430' TO DFHEIV0(25:11)
 10494     CALL 'kxdfhei1' USING DFHEIV0
 10495     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10496
 10497
 10498** POPULATE THE CREDIT-CARD NO WITH THE CERT NO.
 10499     MOVE CL-CERT-NO             TO CL-CCN-A5.
 10500
 10501
 10502*    DISPLAY ' ABOUT TO WRITE ELMSTR '
 10503*    DISPLAY ' KEY ' CL-CARRIER ' ' CL-CLAIM-NO ' '
 10504*       CL-CERT-NO
 10505*    IF CL-COMPANY-CD = X'04'
 10506*       DISPLAY ' CID COMP CD '
 10507*    ELSE
 10508*       IF CL-COMPANY-CD = X'05'
 10509*          DISPLAY ' DCC COMP CD '
 10510*       ELSE
 10511*          DISPLAY ' UNKNOWN COMP CD '
 10512*       END-IF
 10513*    END-IF
 10514
 10515* EXEC CICS WRITE
 10516*        DATASET   (ELMSTR-DSID)
 10517*        FROM      (CLAIM-MASTER)
 10518*        RIDFLD    (CL-CONTROL-PRIMARY)
 10519*    END-EXEC.
 10520     MOVE LENGTH OF
 10521      CLAIM-MASTER
 10522       TO DFHEIV11
 10523*    MOVE '&$ L                  ''   #00009760' TO DFHEIV0
 10524     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10525     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10526     MOVE X'2020233030303039373630' TO DFHEIV0(25:11)
 10527     CALL 'kxdfhei1' USING DFHEIV0,
 10528           ELMSTR-DSID,
 10529           CLAIM-MASTER,
 10530           DFHEIV11,
 10531           CL-CONTROL-PRIMARY,
 10532           DFHEIV99,
 10533           DFHEIV99
 10534     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10535
 10536
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 198
* EL130.cbl
 10537 3850-CLAIM-MSTR-WRITTEN.
 10538
 10539     IF WS-ASSOC-CERT-TOTAL NOT = ZERO
 10540         PERFORM 7710-RESEQUENCE-CLAIMS THRU 7799-EXIT
 10541     END-IF.
 10542
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 199
* EL130.cbl
 10544 3990-ADD-DONE.
 10545*    MOVE 1                     TO EMI-SWITCH1  EMI-SWITCH-AREA-1
 10546*                                  EMI-SUB      EMI-SWITCH-AREA-2.
 10547*    MOVE SPACES                TO EMI-ACTION-SWITCH
 10548*                                  EMI-ERROR-LINES.
 10549
 10550     IF CLMNOL = ZERO
 10551         move spaces             to emi-claim-no
 10552         MOVE ER-0265            TO EMI-ERROR
 10553         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10554         MOVE WS-CLAIM-NUMBER    TO EMI-TEXT-VARIABLE (EMI-SUB)
 10555                                    PI-LAST-CLAIM
 10556     ELSE
 10557         MOVE CLMNOI             TO PI-LAST-CLAIM
 10558                                    MSTR-CLAIM-NO
 10559         MOVE ER-0000            TO EMI-ERROR
 10560         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10561     END-IF.
 10562
 10563     IF CLMTYPEI = PI-LIFE-OVERRIDE-L1
 10564       AND (PI-ST-VFY-2ND-BENE = 'L' OR 'B')
 10565         PERFORM 3994-BUILD-NINETY-THREE-TRAILER THRU 3994-EXIT
 10566         MOVE ER-7575            TO EMI-ERROR
 10567         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10568     END-IF.
 10569
 10570     IF CLMTYPEI NOT = PI-LIFE-OVERRIDE-L1
 10571       AND (PI-ST-VFY-2ND-BENE = 'A' OR 'B')
 10572         PERFORM 3994-BUILD-NINETY-THREE-TRAILER THRU 3994-EXIT
 10573         MOVE ER-7582            TO EMI-ERROR
 10574         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10575     END-IF.
 10576
 10577     IF WS-NO-INSURED-ADDRESS = 'Y'
 10578         MOVE ER-3548            TO EMI-ERROR
 10579         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10580     END-IF.
 10581
 10582     IF PI-ST-CAUSAL-STATE = 'B'  OR
 10583       (PI-ST-CAUSAL-STATE = 'L' AND
 10584              CLMTYPEI = PI-LIFE-OVERRIDE-L1)   OR
 10585       (PI-ST-CAUSAL-STATE = 'A' AND
 10586              CLMTYPEI = PI-AH-OVERRIDE-L1)
 10587         PERFORM 3994B-BUILD-NINETY-FOUR-TRAILER THRU 3994B-EXIT
 10588         MOVE ER-7577            TO EMI-ERROR
 10589         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10590     END-IF.
 10591     if pi-company-id = 'DCC'
 10592        PERFORM 3994C-BUILD-NINETY-FIVE-TRAILER
 10593                                 THRU 3994C-EXIT
 10594     end-if
 10595     MOVE CLMNOI                     TO  PI-CLAIM-NO.
 10596     MOVE CLMCARRI                   TO  PI-CARRIER.
 10597     MOVE CERTNOI                    TO  PI-CERT-PRIME.
 10598     MOVE SUFXI                      TO  PI-CERT-SFX.
 10599
 10600     IF WS-LETTER-SW = 'Y'
 10601         PERFORM 6600-START-AUTO-LETTER-WRITER THRU 6600-EXIT
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 200
* EL130.cbl
 10602         IF W-1523-ERROR-CODE NOT = ZEROS
 10603             MOVE W-1523-ERROR-CODE  TO  EMI-ERROR
 10604             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10605         END-IF
 10606     END-IF.
 10607
 10608     perform 3998-update-cert-claim-trailer
 10609                                 thru 3998-exit
 10610     MOVE CLMTYPEI               TO PI-LAST-CLAIM-TYPE.
 10611     MOVE CERTNOI                TO PI-LAST-CERT-PRIME.
 10612     MOVE SUFXI                  TO PI-LAST-CERT-SUFX.
 10613     MOVE CLMCARRI               TO PI-LAST-CARR.
 10614
 10615     IF PRTOPTL GREATER THAN 0
 10616         MOVE PRTOPTI            TO PI-PRT-OPT
 10617     END-IF.
 10618     IF ALTPRTL GREATER THAN 0
 10619         MOVE ALTPRTI            TO PI-ALT-PRT
 10620     END-IF.
 10621
 10622     IF PI-CERT-PROCESSED NOT LESS THAN PI-CERT-SELECT-CNT
 10623         MOVE LOW-VALUES         TO EL130AI
 10624         MOVE PI-LAST-CERT-PRIME TO CERTNOO
 10625         MOVE AL-SANON           TO CERTNOA
 10626         MOVE PI-LAST-CERT-SUFX  TO SUFXO
 10627         MOVE AL-SANON           TO SUFXA
 10628         MOVE PI-LAST-CARR       TO CLMCARRO
 10629         MOVE AL-UANON           TO CLMCARRA
 10630         MOVE PI-LAST-CLAIM      TO CLMNOO
 10631         MOVE AL-UANON           TO CLMNOA
 10632         MOVE PI-LAST-CLAIM-TYPE TO CLMTYPEO
 10633         MOVE AL-UANON           TO CLMTYPEA
 10634     ELSE
 10635         PERFORM 0690-HIGHLIGHT-CERTS THRU 0690-EXIT
 10636         PERFORM 3993-MODIFY-CLAIM-ATTRB THRU 3993-EXIT
 10637     END-IF.
 10638
 10639     IF PI-PRT-OPT = 'N' OR 'L'
 10640         MOVE PI-PRT-OPT         TO PRTOPTO
 10641         MOVE 1                  TO PRTOPTL
 10642     END-IF.
 10643
 10644     IF PI-ALT-PRT NOT = SPACES AND LOW-VALUES
 10645         MOVE PI-ALT-PRT         TO ALTPRTO
 10646         MOVE 4                  TO ALTPRTL
 10647     END-IF.
 10648
 10649     IF PRTOPTL GREATER THAN 0
 10650         IF PRTOPTI = 'L'
 10651             GO TO 0400-CREATE-ELACTQ
 10652         ELSE
 10653             GO TO 0480-PRINT-NOW
 10654         END-IF
 10655     END-IF.
 10656     move 'S'                    to mainti
 10657     PERFORM 0500-CREATE-TEMP-STORAGE
 10658                                 THRU 0599-EXIT
 10659     IF PI-CERT-PROCESSED NOT LESS THAN PI-CERT-SELECT-CNT
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 201
* EL130.cbl
 10660         GO TO 8100-SEND-INITIAL-MAP
 10661     ELSE
 10662         MOVE LOW-VALUES         TO MAINTO
 10663         MOVE -1                 TO MAINTL
 10664         GO TO 8200-SEND-DATAONLY
 10665     END-IF.
 10666
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 202
* EL130.cbl
 10668 3993-MODIFY-SCREEN-ATTRB.
 10669
 10670     IF CERTMTL GREATER ZERO
 10671         MOVE AL-UANON           TO CERTMTA
 10672     END-IF.
 10673
 10674     IF EFFDTL GREATER ZERO
 10675         MOVE AL-UANON           TO EFFDTA
 10676     END-IF.
 10677
 10678     IF ACCOUNTL GREATER ZERO
 10679         MOVE AL-UANON           TO ACCOUNTA
 10680     END-IF.
 10681
 10682     IF STATEL GREATER ZERO
 10683         MOVE AL-UANON           TO STATEA
 10684     END-IF.
 10685
 10686     IF CRTCARRL GREATER ZERO
 10687         MOVE AL-UANON           TO CRTCARRA
 10688     END-IF.
 10689
 10690     IF GROUPL GREATER ZERO
 10691         MOVE AL-UANON           TO GROUPA
 10692     END-IF.
 10693
 10694     IF CRTLNMEL GREATER ZERO
 10695         MOVE AL-UANON           TO CRTLNMEA
 10696     END-IF.
 10697
 10698     IF CRTFNMEL GREATER ZERO
 10699         MOVE AL-UANON           TO CRTFNMEA
 10700     END-IF.
 10701
 10702     IF CRTINITL GREATER ZERO
 10703         MOVE AL-UANON           TO CRTINITA
 10704     END-IF.
 10705
 10706     IF ISSAGEL GREATER ZERO
 10707         MOVE AL-UNNON           TO ISSAGEA
 10708     END-IF.
 10709
 10710     IF JNTLNMEL GREATER ZERO
 10711         MOVE AL-UANON           TO JNTLNMEA
 10712     END-IF.
 10713
 10714     IF JNTFNMEL GREATER ZERO
 10715         MOVE AL-UANON           TO JNTFNMEA
 10716     END-IF.
 10717
 10718     IF JNTINITL GREATER ZERO
 10719         MOVE AL-UANON           TO JNTINITA
 10720     END-IF.
 10721
 10722     IF JNTAGEL GREATER ZERO
 10723         MOVE AL-UNNON           TO JNTAGEA
 10724     END-IF.
 10725
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 203
* EL130.cbl
 10726     IF CRTSSNL GREATER ZERO
 10727         MOVE AL-UANON           TO CRTSSNA
 10728     END-IF.
 10729
 10730     IF ACVDSCRL GREATER ZERO
 10731         MOVE AL-SANON           TO ACVDSCRA
 10732     END-IF.
 10733
 10734     IF ACVKINDL GREATER ZERO
 10735         MOVE AL-SANON           TO ACVKINDA
 10736     END-IF.
 10737
 10738     IF ACVCDL GREATER ZERO
 10739         MOVE AL-UANON           TO ACVCDA
 10740     END-IF.
 10741
 10742     IF ACVOTRML GREATER ZERO
 10743         MOVE AL-UNNON           TO ACVOTRMA
 10744     END-IF.
 10745
 10746     IF ACVRTRML GREATER ZERO
 10747         MOVE AL-UNNON           TO ACVRTRMA
 10748     END-IF.
 10749
 10750     IF ACVRATEL GREATER ZERO
 10751         MOVE AL-UNNON           TO ACVRATEA
 10752     END-IF.
 10753
 10754     IF ACVBENEL GREATER ZERO
 10755         MOVE AL-UNNON           TO ACVBENEA
 10756     END-IF.
 10757
 10758     IF ACVFORML GREATER ZERO
 10759         MOVE AL-UANON           TO ACVFORMA
 10760     END-IF.
 10761
 10762     IF ACVCNDTL GREATER ZERO
 10763         MOVE AL-UANON           TO ACVCNDTA
 10764     END-IF.
 10765
 10766     IF ACVEXITL GREATER ZERO
 10767         MOVE AL-UANON           TO ACVEXITA
 10768     END-IF.
 10769
 10770     IF ACVSTATL GREATER ZERO
 10771         MOVE AL-UANON           TO ACVSTATA
 10772     END-IF.
 10773
 10774     IF LCVDSCRL GREATER ZERO
 10775         MOVE AL-SANON           TO LCVDSCRA
 10776     END-IF.
 10777
 10778     IF LCVKINDL GREATER ZERO
 10779         MOVE AL-SANON           TO LCVKINDA
 10780     END-IF.
 10781
 10782     IF LCVCDL GREATER ZERO
 10783         MOVE AL-UANON           TO LCVCDA
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 204
* EL130.cbl
 10784     END-IF.
 10785
 10786     IF LCVOTRML GREATER ZERO
 10787         MOVE AL-UNNON           TO LCVOTRMA
 10788     END-IF.
 10789
 10790     IF LCVRTRML GREATER ZERO
 10791         MOVE AL-UNNON           TO LCVRTRMA
 10792     END-IF.
 10793
 10794     IF LCVRATEL GREATER ZERO
 10795         MOVE AL-UNNON           TO LCVRATEA
 10796     END-IF.
 10797
 10798     IF LCVBENEL GREATER ZERO
 10799         MOVE AL-UNNON           TO LCVBENEA
 10800     END-IF.
 10801
 10802     IF LCVFORML GREATER ZERO
 10803         MOVE AL-UANON           TO LCVFORMA
 10804     END-IF.
 10805
 10806     IF LCVCNDTL GREATER ZERO
 10807         MOVE AL-UANON           TO LCVCNDTA
 10808     END-IF.
 10809
 10810     IF LCVEXITL GREATER ZERO
 10811         MOVE AL-UANON           TO LCVEXITA
 10812     END-IF.
 10813
 10814     IF LCVSTATL GREATER ZERO
 10815         MOVE AL-UANON           TO LCVSTATA
 10816     END-IF.
 10817
 10818     IF MEMCAPL GREATER ZERO
 10819         MOVE AL-UANON           TO MEMCAPA
 10820     END-IF.
 10821
 10822     IF APRL GREATER ZERO
 10823         MOVE AL-UNNON           TO APRA
 10824     END-IF.
 10825
 10826     IF PMTFREQL GREATER ZERO
 10827         MOVE AL-UNNON           TO PMTFREQA
 10828     END-IF.
 10829
 10830     IF INDGRPL GREATER ZERO
 10831         MOVE AL-UANON           TO INDGRPA
 10832     END-IF.
 10833
 10834     IF PREMTYPL GREATER ZERO
 10835         MOVE AL-UANON           TO PREMTYPA
 10836     END-IF.
 10837
 10838     IF REINCDL GREATER ZERO
 10839         MOVE AL-UANON           TO REINCDA
 10840     END-IF.
 10841
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 205
* EL130.cbl
 10842     IF ADDONDTL GREATER ZERO
 10843         MOVE AL-UANON           TO ADDONDTA
 10844     END-IF.
 10845
 10846     IF MEMBERL GREATER ZERO
 10847         MOVE AL-UANON           TO MEMBERA
 10848     END-IF.
 10849
 10850     IF BCERT1L GREATER ZERO
 10851         MOVE AL-SANON           TO BCERT1A
 10852                                    BSUFX1A
 10853     END-IF.
 10854
 10855     IF BCERT2L GREATER ZERO
 10856         MOVE AL-SANON           TO BCERT2A
 10857                                    BSUFX2A
 10858     END-IF.
 10859
 10860     IF BCERT3L GREATER ZERO
 10861         MOVE AL-SANON           TO BCERT3A
 10862                                    BSUFX3A
 10863     END-IF.
 10864
 10865     IF BCERT4L GREATER ZERO
 10866         MOVE AL-SANON           TO BCERT4A
 10867                                    BSUFX4A
 10868     END-IF.
 10869
 10870     IF BCERT5L GREATER ZERO
 10871         MOVE AL-SANON           TO BCERT5A
 10872                                    BSUFX5A
 10873     END-IF.
 10874
 10875 3993-MODIFY-CLAIM-ATTRB.
 10876
 10877     IF PCERTNOL GREATER ZERO
 10878         MOVE AL-UANON           TO PCERTNOA
 10879     END-IF.
 10880
 10881     IF PSUFXL GREATER ZERO
 10882         MOVE AL-UANON           TO PSUFXA
 10883     END-IF.
 10884
 10885     IF LSTNMEL GREATER ZERO
 10886         MOVE AL-UANON           TO LSTNMEA
 10887     END-IF.
 10888
 10889     IF FSTNMEL GREATER ZERO
 10890         MOVE AL-UANON           TO FSTNMEA
 10891     END-IF.
 10892
 10893     IF INITL GREATER ZERO
 10894         MOVE AL-UANON           TO INITA
 10895     END-IF.
 10896
 10897     IF SEXL GREATER ZERO
 10898         MOVE AL-UANON           TO SEXA
 10899     END-IF.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 206
* EL130.cbl
 10900
 10901     IF OCCCDL GREATER ZERO
 10902         MOVE AL-UANON           TO OCCCDA
 10903     END-IF.
 10904
 10905     IF BIRTHDTL GREATER ZERO
 10906         MOVE AL-UANON           TO BIRTHDTA
 10907     END-IF.
 10908
 10909     IF SSNL GREATER ZERO
 10910         MOVE AL-UANON           TO SSNA
 10911     END-IF.
 10912
 10913     IF INCURL GREATER ZERO
 10914         MOVE AL-UANON           TO INCURA
 10915     END-IF.
 10916
 10917     IF REPORTL GREATER ZERO
 10918         MOVE AL-UANON           TO REPORTA
 10919     END-IF.
 10920
 10921     IF ESTENDL GREATER ZERO
 10922         MOVE AL-UANON           TO ESTENDA
 10923     END-IF.
 10924
 10925     IF DIAGL GREATER ZERO
 10926         MOVE AL-UANON           TO DIAGA
 10927     END-IF.
 10928
 10929     IF CAUSEL GREATER ZERO
 10930         MOVE AL-UANON           TO CAUSEA
 10931     END-IF.
 10932
 10933     IF MANRSVL GREATER ZERO
 10934         MOVE AL-UNNON           TO MANRSVA
 10935     END-IF.
 10936
 10937     IF RELCLML GREATER ZERO
 10938         MOVE AL-UANON           TO RELCLMA
 10939     END-IF.
 10940
 10941     IF LOANNOL GREATER ZERO
 10942         MOVE AL-UANON           TO LOANNOA
 10943     END-IF.
 10944
 10945     IF LOANBALL GREATER ZERO
 10946         MOVE AL-UNNON           TO LOANBALA
 10947     END-IF.
 10948
 10949     IF PROCCDL GREATER ZERO
 10950         MOVE AL-UANON           TO PROCCDA
 10951     END-IF.
 10952
 10953     IF BENECDL GREATER THAN ZERO
 10954         MOVE AL-UANON           TO  BENECDA
 10955     END-IF.
 10956
 10957     IF PRICDL GREATER ZERO
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 207
* EL130.cbl
 10958         MOVE AL-UANON           TO PRICDA
 10959     END-IF.
 10960
 10961     IF SUPVL GREATER ZERO
 10962         MOVE AL-UANON           TO SUPVA
 10963     END-IF.
 10964
 10965     IF FILETOL GREATER ZERO
 10966         MOVE AL-UANON           TO FILETOA
 10967     END-IF.
 10968
 10969
 10970 3993-MODIFY-CLAIM-KEY-ATTRB.
 10971
 10972     IF CLMNOL GREATER ZERO
 10973         MOVE AL-UANON           TO CLMNOA
 10974     END-IF.
 10975
 10976     IF CLMCARRL GREATER ZERO
 10977         MOVE AL-UANON           TO CLMCARRA
 10978     END-IF.
 10979
 10980     IF CLMTYPEL GREATER ZERO
 10981         MOVE AL-UANON           TO CLMTYPEA
 10982     END-IF.
 10983
 10984     IF CERTNOL GREATER ZERO
 10985         MOVE AL-SANON           TO CERTNOA
 10986     END-IF.
 10987
 10988     IF SUFXL GREATER ZERO
 10989         MOVE AL-SANON           TO SUFXA
 10990     END-IF.
 10991
 10992 3993-EXIT.
 10993     EXIT.
 10994
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 208
* EL130.cbl
 10996 3994-BUILD-NINETY-THREE-TRAILER.
 10997
 10998     MOVE SPACES                 TO ACTIVITY-TRAILERS.
 10999     MOVE 'AT'                   TO AT-RECORD-ID.
 11000
 11001     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
 11002     MOVE CLMCARRI               TO AT-CARRIER.
 11003
 11004     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
 11005     MOVE CERT-CERT-NO           TO AT-CERT-NO.
 11006     MOVE +93                    TO AT-SEQUENCE-NO.
 11007     MOVE '6'                    TO AT-TRAILER-TYPE.
 11008     MOVE 'M'                    TO AT-INFO-TRAILER-TYPE.
 11009
 11010     IF CLMTYPEI = PI-LIFE-OVERRIDE-L1
 11011         MOVE WS-VERIFY-NOTE     TO AT-INFO-LINE-1
 11012     ELSE
 11013         MOVE WS-VFY-SSN-NOTE    TO AT-INFO-LINE-1
 11014     END-IF
 11015
 11016     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT
 11017                                    AT-GEN-INFO-LAST-MAINT-DT.
 11018
 11019     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 11020                                    AT-GEN-INFO-LAST-UPDATED-BY.
 11021     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 11022
 11023
 11024
 11025* EXEC CICS WRITE
 11026*        DATASET   (ELTRLR-DSID)
 11027*        FROM      (ACTIVITY-TRAILERS)
 11028*        RIDFLD    (AT-CONTROL-PRIMARY)
 11029*    END-EXEC.
 11030     MOVE LENGTH OF
 11031      ACTIVITY-TRAILERS
 11032       TO DFHEIV11
 11033*    MOVE '&$ L                  ''   #00010253' TO DFHEIV0
 11034     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11035     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11036     MOVE X'2020233030303130323533' TO DFHEIV0(25:11)
 11037     CALL 'kxdfhei1' USING DFHEIV0,
 11038           ELTRLR-DSID,
 11039           ACTIVITY-TRAILERS,
 11040           DFHEIV11,
 11041           AT-CONTROL-PRIMARY,
 11042           DFHEIV99,
 11043           DFHEIV99
 11044     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11045
 11046
 11047 3994-EXIT.
 11048     EXIT.
 11049
 11050 3994B-BUILD-NINETY-FOUR-TRAILER.
 11051
 11052     MOVE SPACES                 TO ACTIVITY-TRAILERS.
 11053     MOVE 'AT'                   TO AT-RECORD-ID.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 209
* EL130.cbl
 11054
 11055     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
 11056     MOVE CLMCARRI               TO AT-CARRIER.
 11057
 11058     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
 11059     MOVE CERT-CERT-NO           TO AT-CERT-NO.
 11060     MOVE +94                    TO AT-SEQUENCE-NO.
 11061     MOVE '6'                    TO AT-TRAILER-TYPE.
 11062     MOVE 'M'                    TO AT-INFO-TRAILER-TYPE.
 11063
 11064     MOVE WS-CAUSAL-NOTE         TO AT-INFO-LINE-1.
 11065
 11066     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT
 11067                                    AT-GEN-INFO-LAST-MAINT-DT.
 11068
 11069     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 11070                                    AT-GEN-INFO-LAST-UPDATED-BY.
 11071     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 11072
 11073
 11074
 11075* EXEC CICS WRITE
 11076*        DATASET   (ELTRLR-DSID)
 11077*        FROM      (ACTIVITY-TRAILERS)
 11078*        RIDFLD    (AT-CONTROL-PRIMARY)
 11079*    END-EXEC.
 11080     MOVE LENGTH OF
 11081      ACTIVITY-TRAILERS
 11082       TO DFHEIV11
 11083*    MOVE '&$ L                  ''   #00010286' TO DFHEIV0
 11084     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11085     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11086     MOVE X'2020233030303130323836' TO DFHEIV0(25:11)
 11087     CALL 'kxdfhei1' USING DFHEIV0,
 11088           ELTRLR-DSID,
 11089           ACTIVITY-TRAILERS,
 11090           DFHEIV11,
 11091           AT-CONTROL-PRIMARY,
 11092           DFHEIV99,
 11093           DFHEIV99
 11094     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11095
 11096
 11097 3994B-EXIT.
 11098     EXIT.
 11099 3994C-BUILD-NINETY-FIVE-TRAILER.
 11100
 11101     MOVE SPACES                 TO ACTIVITY-TRAILERS
 11102     MOVE 'AT'                   TO AT-RECORD-ID
 11103
 11104     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD
 11105     MOVE CLMCARRI               TO AT-CARRIER
 11106
 11107     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO
 11108     MOVE CERT-CERT-NO           TO AT-CERT-NO
 11109     MOVE +95                    TO AT-SEQUENCE-NO
 11110     MOVE '6'                    TO AT-TRAILER-TYPE
 11111     MOVE 'E'                    TO AT-INFO-TRAILER-TYPE
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 210
* EL130.cbl
 11112
 11113     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT
 11114                                    AT-GEN-INFO-LAST-MAINT-DT
 11115
 11116     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 11117                                    AT-GEN-INFO-LAST-UPDATED-BY
 11118     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS
 11119
 11120     perform varying e1 from +1 by +1 until
 11121        ws-error-no (e1) = spaces
 11122        move ws-error-no (e1)    to at-note-error-no (e1)
 11123     end-perform
 11124
 11125     if at-info-line-1 not = spaces
 11126
 11127* EXEC CICS WRITE
 11128*          DATASET  (ELTRLR-DSID)
 11129*          FROM     (ACTIVITY-TRAILERS)
 11130*          RIDFLD   (AT-CONTROL-PRIMARY)
 11131*       END-EXEC
 11132     MOVE LENGTH OF
 11133      ACTIVITY-TRAILERS
 11134       TO DFHEIV11
 11135*    MOVE '&$ L                  ''   #00010321' TO DFHEIV0
 11136     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11137     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11138     MOVE X'2020233030303130333231' TO DFHEIV0(25:11)
 11139     CALL 'kxdfhei1' USING DFHEIV0,
 11140           ELTRLR-DSID,
 11141           ACTIVITY-TRAILERS,
 11142           DFHEIV11,
 11143           AT-CONTROL-PRIMARY,
 11144           DFHEIV99,
 11145           DFHEIV99
 11146     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11147     end-if
 11148
 11149     .
 11150 3994C-EXIT.
 11151     EXIT.
 11152 3995-BUILD-CLAIM-RECORD.
 11153     IF PROCCDL GREATER ZERO
 11154         MOVE PROCCDI            TO CL-PROCESSOR-ID
 11155     ELSE
 11156         MOVE PI-PROCESSOR-ID    TO CL-PROCESSOR-ID
 11157     END-IF.
 11158
 11159     IF FSTNMEL GREATER ZERO
 11160         MOVE FSTNMEI            TO CL-INSURED-1ST-NAME
 11161     END-IF.
 11162
 11163     IF INITL GREATER ZERO
 11164         MOVE INITI              TO CL-INSURED-MID-INIT
 11165     END-IF.
 11166
 11167     IF BIRTHDTL GREATER ZERO
 11168         MOVE WS-BIRTHDT         TO CL-INSURED-BIRTH-DT
 11169     END-IF.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 211
* EL130.cbl
 11170
 11171     IF SEXL GREATER ZERO
 11172         MOVE SEXI               TO CL-INSURED-SEX-CD
 11173     END-IF.
 11174
 11175     IF OCCCDL GREATER ZERO
 11176         MOVE OCCCDI             TO CL-INSURED-OCC-CD
 11177     END-IF.
 11178
 11179     MOVE 'O'                    TO CL-CLAIM-STATUS.
 11180
 11181*    IF CLMTYPEL GREATER ZERO
 11182     MOVE CLMTYPEI               TO CL-CLAIM-TYPE.
 11183*    END-IF.
 11184
 11185     IF PREMTYPL GREATER ZERO
 11186         MOVE PREMTYPI           TO CL-CLAIM-PREM-TYPE
 11187     END-IF.
 11188
 11189     IF INCURL GREATER ZERO
 11190         MOVE WS-INCUR           TO CL-INCURRED-DT
 11191     END-IF.
 11192
 11193     IF (PI-COMPANY-ID = 'DCC')
 11194        AND (ERPDEF-FOUND)
 11195        MOVE WS-MAX-BENEFITS     TO CL-CRITICAL-PERIOD
 11196*       MOVE WS-CRIT-PER-RECURRENT
 11197*                                TO CL-CRIT-PER-RECURRENT
 11198*       MOVE WS-CRIT-PER-RTW-MOS TO CL-CRIT-PER-RTW-MOS
 11199     ELSE
 11200        IF CL-CLAIM-TYPE = 'L' OR 'P'
 11201           MOVE CM-LF-CRITICAL-PERIOD
 11202                                 TO CL-CRITICAL-PERIOD
 11203        ELSE
 11204           MOVE CM-AH-CRITICAL-PERIOD
 11205                                 TO CL-CRITICAL-PERIOD
 11206        END-IF
 11207     END-IF
 11208
 11209     IF CL-CRITICAL-PERIOD NOT = ZEROS
 11210        COMPUTE DC-ELAPSED-MONTHS =
 11211           CL-CRITICAL-PERIOD - WS-BENEFITS-PREV-PAID
 11212        MOVE CL-INCURRED-DT      TO DC-BIN-DATE-1
 11213        MOVE ZEROS               TO DC-ELAPSED-DAYS
 11214        MOVE '6'                 TO DC-OPTION-CODE
 11215        PERFORM 9700-LINK-DATE-CONVERT
 11216                                 THRU 9700-EXIT
 11217        MOVE DC-BIN-DATE-2       TO CL-BENEFIT-EXPIRATION-DT
 11218     END-IF
 11219
 11220     if instypel > zero
 11221        move instypei            to cl-insured-claim
 11222     end-if
 11223     IF REPORTL GREATER ZERO
 11224         MOVE WS-REPORT          TO CL-REPORTED-DT
 11225     END-IF.
 11226
 11227     IF EIBAID = DFHPF6
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 212
* EL130.cbl
 11228         IF WS-REPORT = LOW-VALUES  OR   REPORTL = ZEROS
 11229             MOVE WS-TODAY-DT    TO CL-REPORTED-DT
 11230                 IF EMI-FORCABLE-CTR = +1
 11231                     MOVE ZEROS  TO CL-FORCEABLE-ERROR-CNT
 11232                 END-IF
 11233         END-IF
 11234     END-IF.
 11235
 11236     IF ESTENDL GREATER ZERO
 11237        MOVE WS-ESTEND           TO CL-EST-END-OF-DISAB-DT
 11238     END-IF.
 11239
 11240     IF ADDONDTL GREATER ZERO
 11241         MOVE WS-ADD-ON-DT   TO CL-LAST-ADD-ON-DT
 11242     END-IF.
 11243
 11244     IF CAUSEL GREATER ZERO
 11245         MOVE CAUSEI             TO CL-CAUSE-CD
 11246     END-IF.
 11247
 11248     IF SSNL GREATER ZERO
 11249         MOVE SSNI               TO CL-SOC-SEC-NO
 11250     ELSE
 11251         MOVE CERT-STATE         TO CL-SSN-STATE
 11252         MOVE CERT-ACCOUNT-PRIME TO CL-SSN-ACCOUNT
 11253         MOVE CL-INSURED-LAST-NAME TO CL-SSN-LN3
 11254     END-IF.
 11255
 11256     IF PRICDL GREATER ZERO
 11257         MOVE PRICDI             TO CL-PRIORITY-CD
 11258     END-IF.
 11259
 11260     IF SUPVL GREATER ZERO
 11261         MOVE SUPVI              TO CL-SUPV-ATTN-CD
 11262     END-IF.
 11263
 11264     MOVE WS-TODAY-DT            TO CL-LAST-MAINT-DT.
 11265     MOVE CL-PROCESSOR-ID        TO CL-LAST-MAINT-USER.
 11266     MOVE EIBTIME                TO CL-LAST-MAINT-HHMMSS.
 11267
 11268     IF RELCLML GREATER ZERO
 11269         MOVE RELCLMI            TO CL-RELATED-CLAIM-NO
 11270     END-IF.
 11271
 11272     IF FILETOL GREATER ZERO
 11273         MOVE FILETOI            TO CL-FILE-LOCATION
 11274     END-IF.
 11275
 11276 3995-EXIT.
 11277      EXIT.
 11278 3996-read-cert-claim-trailer.
 11279
 11280     move cm-ah-benefit-amt      to ws-monthly-benefit
 11281     if pi-dcc-max-amt < ws-monthly-benefit
 11282        move pi-dcc-max-amt      to ws-monthly-benefit
 11283     end-if
 11284
 11285     MOVE CM-COMPANY-CD          TO CTRLR-COMP-CD
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 213
* EL130.cbl
 11286     MOVE CM-CARRIER             TO CTRLR-CARRIER
 11287     MOVE CM-GROUPING            TO CTRLR-GROUPING
 11288     MOVE CM-STATE               TO CTRLR-STATE
 11289     MOVE CM-ACCOUNT             TO CTRLR-ACCOUNT
 11290     MOVE CM-CERT-EFF-DT         TO CTRLR-EFF-DT
 11291     MOVE CM-CERT-NO             TO CTRLR-CERT-NO
 11292     MOVE 'B'                    TO CTRLR-REC-TYPE
 11293
 11294* EXEC CICS READ
 11295*       DATASET  (ELCRTT-DSID)
 11296*       set     (address of CERTIFICATE-TRAILERS)
 11297*       RIDFLD   (ELCRTT-KEY)
 11298*       RESP     (WS-RESPONSE)
 11299*    END-EXEC
 11300*    MOVE '&"S        E          (  N#00010472' TO DFHEIV0
 11301     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11302     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11303     MOVE X'204E233030303130343732' TO DFHEIV0(25:11)
 11304     CALL 'kxdfhei1' USING DFHEIV0,
 11305           ELCRTT-DSID,
 11306           DFHEIV20,
 11307           DFHEIV99,
 11308           ELCRTT-KEY,
 11309           DFHEIV99,
 11310           DFHEIV99,
 11311           DFHEIV99
 11312     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 11313         DFHEIV20
 11314     MOVE EIBRESP  TO WS-RESPONSE
 11315     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11316     IF WS-RESP-NORMAL
 11317*       if instypei = 'P'
 11318*          move +1 to s1
 11319*       else
 11320*          MOVE +2 to s1
 11321*       end-if
 11322
 11323        move +1 to s1
 11324        evaluate clmtypei
 11325           when 'A'
 11326              move +1 to s2
 11327           when 'I'
 11328              move +2 to s2
 11329           when 'G'
 11330              move +3 to s2
 11331           when 'L'
 11332              move +4 to s2
 11333           when 'P'
 11334              move +5 to s2
 11335        end-evaluate
 11336        if cs-claim-type (s1 s2) = clmtypei
 11337           if cs-no-of-claims (s1 s2) > zeros
 11338              move er-1659       to ws-error-no (e1)
 11339           end-if
 11340           compute WS-BENEFITS-PREV-PAID =
 11341              cs-total-paid (s1 s2) / ws-monthly-benefit
 11342           if (WS-BENEFITS-PREV-PAID >= pi-dcc-max-benefits)
 11343              and (pi-dcc-max-benefits not = zeros)
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 214
* EL130.cbl
 11344              add +1             to e1
 11345              MOVE ER-1660       TO EMI-ERROR
 11346                                    ws-error-no (e1)
 11347              PERFORM 9900-ERROR-FORMAT
 11348                                 THRU 9900-EXIT
 11349           end-if
 11350        end-if
 11351     end-if
 11352
 11353     .
 11354 3996-exit.
 11355     exit.
 11356
 11357 3997-GET-ERPDEF.
 11358
 11359     MOVE SPACES                 TO WS-CRIT-PER-RECURRENT
 11360                                    WS-ERPDEF-SW
 11361     MOVE ZEROS                  TO WS-MAX-BENEFITS
 11362                                    WS-CRIT-PER-RTW-MOS
 11363
 11364     MOVE PI-COMPANY-CD       TO ERPDEF-KEY
 11365     MOVE CM-STATE            TO ERPDEF-STATE
 11366     MOVE ws-dcc-product-code TO ERPDEF-PROD-CD
 11367     MOVE 'A'                 TO ERPDEF-BEN-TYPE
 11368     MOVE CM-AH-BENEFIT-CD    TO ERPDEF-BEN-CODE
 11369     MOVE CM-CERT-EFF-DT      TO ERPDEF-EXP-DT
 11370     MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 11371
 11372
 11373* EXEC CICS STARTBR
 11374*        DATASET  ('ERPDEF')
 11375*        RIDFLD   (ERPDEF-KEY)
 11376*        GTEQ
 11377*        RESP     (WS-RESPONSE)
 11378*    END-EXEC
 11379     MOVE 'ERPDEF' TO DFHEIV1
 11380     MOVE 0
 11381       TO DFHEIV11
 11382*    MOVE '&,         G          &  N#00010534' TO DFHEIV0
 11383     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11384     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11385     MOVE X'204E233030303130353334' TO DFHEIV0(25:11)
 11386     CALL 'kxdfhei1' USING DFHEIV0,
 11387           DFHEIV1,
 11388           ERPDEF-KEY,
 11389           DFHEIV99,
 11390           DFHEIV11,
 11391           DFHEIV99
 11392     MOVE EIBRESP  TO WS-RESPONSE
 11393     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11394
 11395     IF WS-RESP-NORMAL
 11396
 11397* EXEC CICS READNEXT
 11398*          DATASET  ('ERPDEF')
 11399*          INTO     (PRODUCT-MASTER)
 11400*          RIDFLD   (ERPDEF-KEY)
 11401*          RESP     (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 215
* EL130.cbl
 11402*       END-EXEC
 11403     MOVE LENGTH OF
 11404      PRODUCT-MASTER
 11405       TO DFHEIV12
 11406     MOVE 'ERPDEF' TO DFHEIV1
 11407     MOVE 0
 11408       TO DFHEIV11
 11409*    MOVE '&.IL                  )  N#00010542' TO DFHEIV0
 11410     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 11411     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 11412     MOVE X'204E233030303130353432' TO DFHEIV0(25:11)
 11413     CALL 'kxdfhei1' USING DFHEIV0,
 11414           DFHEIV1,
 11415           PRODUCT-MASTER,
 11416           DFHEIV12,
 11417           ERPDEF-KEY,
 11418           DFHEIV99,
 11419           DFHEIV11,
 11420           DFHEIV99,
 11421           DFHEIV99
 11422     MOVE EIBRESP  TO WS-RESPONSE
 11423     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11424
 11425        IF WS-RESP-NORMAL
 11426           IF (ERPDEF-KEY-SAVE (1:16) =
 11427              PD-CONTROL-PRIMARY (1:16))
 11428              AND (CM-CERT-EFF-DT < PD-PROD-EXP-DT)
 11429
 11430              PERFORM VARYING A1 FROM +1 BY +1 UNTIL
 11431                 (A1 > +8)
 11432                 OR (PD-PROD-CODE (A1) = CLMTYPEI)
 11433              END-PERFORM
 11434              IF A1 < +9
 11435
 11436                 SET ERPDEF-FOUND TO TRUE
 11437                 move pd-max-amt (a1)
 11438                              to pi-dcc-max-amt
 11439                 MOVE PD-CRIT-PERIOD (A1)
 11440                              TO WS-MAX-BENEFITS
 11441                                 pi-dcc-max-benefits
 11442                 MOVE PD-REC-CRIT-PERIOD (A1)
 11443                              TO WS-CRIT-PER-RECURRENT
 11444                 IF PD-RTW-MOS (A1) NUMERIC
 11445                    MOVE PD-RTW-MOS (A1)
 11446                              TO WS-CRIT-PER-RTW-MOS
 11447                 ELSE
 11448                    MOVE 0    TO WS-CRIT-PER-RTW-MOS
 11449                 END-IF
 11450                 IF PD-EXCLUSION-PERIOD-DAYS (A1) NUMERIC
 11451                    MOVE PD-EXCLUSION-PERIOD-DAYS (A1)
 11452                                 TO WS-EXCL-PERIOD
 11453                 END-IF
 11454                 IF PD-COVERAGE-ENDS-MOS (A1) NUMERIC
 11455                    MOVE PD-COVERAGE-ENDS-MOS (A1)
 11456                                 TO WS-COV-ENDS
 11457                 END-IF
 11458                 IF PD-ACCIDENT-ONLY-MOS (A1) NUMERIC
 11459                    MOVE PD-ACCIDENT-ONLY-MOS (A1)
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 216
* EL130.cbl
 11460                                 TO WS-ACC-PERIOD
 11461                 END-IF
 11462              END-IF
 11463           END-IF
 11464        END-IF
 11465     END-IF
 11466
 11467     .
 11468 3997-EXIT.
 11469     EXIT.
 11470
 11471 3998-update-cert-claim-trailer.
 11472
 11473
 11474* EXEC CICS GETMAIN
 11475*       SET      (ADDRESS OF CERTIFICATE-TRAILERS)
 11476*       LENGTH   (ELCRTT-LENGTH)
 11477*       INITIMG  (GETMAIN-SPACE)
 11478*    END-EXEC
 11479*    MOVE ',"IL                  $   #00010597' TO DFHEIV0
 11480     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11481     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11482     MOVE X'2020233030303130353937' TO DFHEIV0(25:11)
 11483     CALL 'kxdfhei1' USING DFHEIV0,
 11484           DFHEIV20,
 11485           ELCRTT-LENGTH,
 11486           GETMAIN-SPACE
 11487     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 11488         DFHEIV20
 11489     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11490
 11491     MOVE CM-COMPANY-CD    TO CTRLR-COMP-CD
 11492     MOVE CM-CARRIER       TO CTRLR-CARRIER
 11493     MOVE CM-GROUPING      TO CTRLR-GROUPING
 11494     MOVE CM-STATE         TO CTRLR-STATE
 11495     MOVE CM-ACCOUNT       TO CTRLR-ACCOUNT
 11496     MOVE CM-CERT-EFF-DT   TO CTRLR-EFF-DT
 11497     MOVE CM-CERT-NO       TO CTRLR-CERT-NO
 11498     MOVE 'B'              TO CTRLR-REC-TYPE
 11499
 11500* EXEC CICS READ
 11501*       UPDATE
 11502*       DATASET  (ELCRTT-DSID)
 11503*       into     (CERTIFICATE-TRAILERS)
 11504*       RIDFLD   (ELCRTT-KEY)
 11505*       RESP     (WS-RESPONSE)
 11506*    END-EXEC
 11507     MOVE LENGTH OF
 11508      CERTIFICATE-TRAILERS
 11509       TO DFHEIV11
 11510*    MOVE '&"IL       EU         (  N#00010611' TO DFHEIV0
 11511     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11512     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11513     MOVE X'204E233030303130363131' TO DFHEIV0(25:11)
 11514     CALL 'kxdfhei1' USING DFHEIV0,
 11515           ELCRTT-DSID,
 11516           CERTIFICATE-TRAILERS,
 11517           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 217
* EL130.cbl
 11518           ELCRTT-KEY,
 11519           DFHEIV99,
 11520           DFHEIV99,
 11521           DFHEIV99
 11522     MOVE EIBRESP  TO WS-RESPONSE
 11523     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11524     IF WS-RESP-NORMAL
 11525        perform 3999-upd-crt-trlr thru 3999-exit
 11526
 11527* EXEC CICS REWRITE
 11528*          DATASET  (ELCRTT-DSID)
 11529*          from     (CERTIFICATE-TRAILERS)
 11530*          RESP     (WS-RESPONSE)
 11531*       END-EXEC
 11532     MOVE LENGTH OF
 11533      CERTIFICATE-TRAILERS
 11534       TO DFHEIV11
 11535*    MOVE '&& L                  %  N#00010620' TO DFHEIV0
 11536     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11537     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11538     MOVE X'204E233030303130363230' TO DFHEIV0(25:11)
 11539     CALL 'kxdfhei1' USING DFHEIV0,
 11540           ELCRTT-DSID,
 11541           CERTIFICATE-TRAILERS,
 11542           DFHEIV11,
 11543           DFHEIV99
 11544     MOVE EIBRESP  TO WS-RESPONSE
 11545     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11546     else
 11547        if ws-resp-notfnd
 11548           move 'CS'             to certificate-trailers
 11549           move cm-control-primary to cs-control-primary
 11550           move 'B'              to cs-trailer-type
 11551           perform varying s1 from +1 by +1 until s1 > +2
 11552              perform varying s2 from +1 by +1 until s2 > +10
 11553                 move zeros      to cs-bank (s1 s2)
 11554                                    cs-no-of-claims (s1 s2)
 11555                                    cs-days-paid (s1 s2)
 11556                                    cs-total-paid (s1 s2)
 11557              end-perform
 11558           end-perform
 11559           perform 3999-upd-crt-trlr
 11560                                 thru 3999-exit
 11561
 11562* EXEC CICS WRITE
 11563*             DATASET  (ELCRTT-DSID)
 11564*             from     (CERTIFICATE-TRAILERS)
 11565*             RIDFLD   (cs-control-primary)
 11566*             RESP     (WS-RESPONSE)
 11567*          END-EXEC
 11568     MOVE LENGTH OF
 11569      CERTIFICATE-TRAILERS
 11570       TO DFHEIV11
 11571*    MOVE '&$ L                  ''  N#00010640' TO DFHEIV0
 11572     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11573     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11574     MOVE X'204E233030303130363430' TO DFHEIV0(25:11)
 11575     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 218
* EL130.cbl
 11576           ELCRTT-DSID,
 11577           CERTIFICATE-TRAILERS,
 11578           DFHEIV11,
 11579           cs-control-primary,
 11580           DFHEIV99,
 11581           DFHEIV99
 11582     MOVE EIBRESP  TO WS-RESPONSE
 11583     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11584        end-if
 11585     END-IF
 11586
 11587     .
 11588 3998-exit.
 11589     exit.
 11590
 11591 3999-upd-crt-trlr.
 11592
 11593*    if instypei = 'P'
 11594*       move +1 to s1
 11595*    else
 11596*       MOVE +2 to s1
 11597*    end-if
 11598
 11599     move +1 to s1
 11600     evaluate clmtypei
 11601        when 'A'
 11602           move +1 to s2
 11603        when 'I'
 11604           move +2 to s2
 11605        when 'G'
 11606           move +3 to s2
 11607        when 'L'
 11608           move +4 to s2
 11609        when 'P'
 11610           move +5 to s2
 11611     end-evaluate
 11612
 11613     move clmtypei         to cs-claim-type (s1 s2)
 11614     add +1                to cs-no-of-claims (s1 s2)
 11615
 11616     .
 11617 3999-exit.
 11618     exit.
 11619 4000-CALCULATE-CERT-TERM.
 11620
 11621     PERFORM 4100-CALC-GROSS-TERM THRU 4200-EXIT.
 11622
 11623     MOVE N                      TO WS-TERM.
 11624
 11625     IF WS-TERM GREATER 120
 11626         MOVE 120                TO WS-TERM
 11627     END-IF.
 11628
 11629 4000-CALC-TERM-EXIT.
 11630      EXIT.
 11631
 11632 4100-CALC-GROSS-TERM.
 11633     MOVE HOLD-LOAN-BAL           TO L.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 219
* EL130.cbl
 11634     MOVE WS-ACVBENE              TO M.
 11635     COMPUTE N = L / M.
 11636     IF N LESS 1
 11637         MOVE 1  TO N
 11638     END-IF.
 11639
 11640     IF LCVCDL GREATER ZERO
 11641         COMPUTE WS-LF-RATE = WS-LCVRATE / +1000
 11642     ELSE
 11643         MOVE ZEROS               TO WS-LF-RATE
 11644     END-IF.
 11645
 11646     IF ACVCDL GREATER ZERO
 11647         COMPUTE WS-AH-RATE = WS-ACVRATE / +1000
 11648     ELSE
 11649         MOVE ZEROS               TO WS-AH-RATE
 11650     END-IF.
 11651
 11652     COMPUTE I = WS-APR / +1200.
 11653
 11654 4105-LOOP.
 11655     IF N GREATER 240
 11656         GO TO 4200-EXIT
 11657     END-IF.
 11658
 11659     PERFORM 4210-CALC-LEFT-RIGHTONE THRU 4220-EXIT.
 11660
 11661     IF LEFT-TOT-1 GREATER RIGHT-TOT-1
 11662         ADD 1 TO N
 11663         GO TO 4105-LOOP
 11664     END-IF.
 11665
 11666 4200-EXIT.
 11667      EXIT.
 11668
 11669 4210-CALC-LEFT-RIGHTONE.
 11670      MOVE L         TO LEFT-TOT-1.
 11671      SUBTRACT 1 FROM N.
 11672      PERFORM 4300-CALC-A-N THRU 4300-EXIT.
 11673      PERFORM 4350-CALC-IA-N THRU 4400-EXIT.
 11674      ADD 1 TO N.
 11675
 11676 4211-CALC-TERM1.
 11677      MOVE N         TO TERM1.
 11678      MULTIPLY M BY TERM1.
 11679
 11680 4212-LOOP.
 11681      COMPUTE TERM1 = (WS-AH-RATE + WS-LF-RATE) * TERM1.
 11682      ADD 1 TO A-N.
 11683      MULTIPLY A-N BY TERM1.
 11684      SUBTRACT 1 FROM A-N.
 11685      ADD TERM1 TO LEFT-TOT-1.
 11686
 11687 4213-CALC-TERM2.
 11688      MOVE M         TO TERM2.
 11689      COMPUTE TERM2 = (WS-AH-RATE + WS-LF-RATE) * TERM2.
 11690      MULTIPLY IA-N BY TERM2.
 11691      SUBTRACT TERM2 FROM LEFT-TOT-1.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 220
* EL130.cbl
 11692
 11693 4215-CALC-RIGHTONE.
 11694      MOVE M         TO RIGHT-TOT-1.
 11695      PERFORM 4300-CALC-A-N THRU 4300-EXIT.
 11696      MULTIPLY A-N BY RIGHT-TOT-1.
 11697
 11698 4220-EXIT.
 11699      EXIT.
 11700
 11701 4300-CALC-A-N.
 11702     IF N LESS 1
 11703         MOVE 0     TO A-N
 11704         GO TO 4300-EXIT
 11705     END-IF.
 11706
 11707     IF I = 0
 11708         MOVE .00001 TO I
 11709     END-IF.
 11710
 11711     ADD 1 TO I.
 11712     DIVIDE I INTO 1 GIVING V.
 11713     SUBTRACT 1 FROM I.
 11714     PERFORM 4450-CALC-V-EX-N THRU 4490-EXIT.
 11715     SUBTRACT V-EX-N FROM 1 GIVING TERM3.
 11716     DIVIDE I INTO TERM3 GIVING A-N.
 11717
 11718 4300-EXIT.
 11719      EXIT.
 11720
 11721 4350-CALC-IA-N.
 11722     IF N LESS 1
 11723         MOVE 0      TO IA-N
 11724         GO TO 4400-EXIT
 11725     END-IF.
 11726
 11727     ADD 1 TO N.
 11728     PERFORM 4450-CALC-V-EX-N THRU 4490-EXIT.
 11729     SUBTRACT 1 FROM N.
 11730     MULTIPLY N BY V-EX-N GIVING TERM3.
 11731     SUBTRACT TERM3 FROM A-N GIVING TERM3.
 11732     SUBTRACT V FROM 1 GIVING TERM4.
 11733     DIVIDE TERM4 INTO TERM3 GIVING IA-N.
 11734
 11735 4400-EXIT.
 11736      EXIT.
 11737
 11738 4450-CALC-V-EX-N.
 11739     IF N LESS 1
 11740         MOVE 1    TO V-EX-N
 11741         GO TO 4490-EXIT
 11742     END-IF.
 11743
 11744     MOVE N        TO NV-STORE.
 11745
 11746     IF V-EX-ONETIME = 1  OR
 11747        V NOT = V-EXPONENT (1)
 11748          PERFORM 4470-BUILD-V-EX-TABLE THRU 4480-EXIT
 11749     END-IF.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 221
* EL130.cbl
 11750
 11751 4460-LOOP.
 11752     IF N GREATER 248
 11753         MOVE 248 TO N
 11754     END-IF.
 11755
 11756     IF N = 1
 11757         MOVE V               TO V-EX-N
 11758     ELSE
 11759         MOVE V-EXPONENT (N)  TO V-EX-N
 11760     END-IF.
 11761
 11762     GO TO 4490-EXIT.
 11763
 11764 4470-BUILD-V-EX-TABLE.
 11765     MOVE 2      TO N.
 11766     MOVE V      TO V-EXPONENT (1)
 11767                    V-EX-N.
 11768
 11769 4471-LOOP.
 11770     MULTIPLY V BY V-EX-N.
 11771     MOVE V-EX-N   TO V-EXPONENT (N).
 11772
 11773     ADD 1 TO N.
 11774     IF N LESS 248
 11775         GO TO 4471-LOOP
 11776     END-IF.
 11777
 11778     MOVE NV-STORE     TO N.
 11779     MOVE ZERO         TO V-EX-ONETIME.
 11780
 11781 4480-EXIT.
 11782      EXIT.
 11783
 11784 4490-EXIT.
 11785      EXIT.
 11786
 11787 4500-CALC-NET-TERM.
 11788     MOVE HOLD-LOAN-BAL           TO L.
 11789     MOVE WS-ACVBENE              TO M.
 11790     DIVIDE L BY M GIVING N REMAINDER WS-REMAIN.
 11791
 11792     IF WS-REMAIN GREATER ZERO
 11793         ADD 1 TO N
 11794     END-IF.
 11795
 11796     IF N = 0
 11797         MOVE 1 TO N
 11798     END-IF.
 11799
 11800 4700-EXIT.
 11801      EXIT.
 11802
 11803 4999-CALC-TERM-EXIT.
 11804     EXIT.
 11805
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 222
* EL130.cbl
 11807 5000-INCURRED-CHANGE.
 11808     IF NOT MODIFY-CAP
 11809         MOVE ER-0070            TO EMI-ERROR
 11810         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11811         MOVE -1                 TO MAINTL
 11812         GO TO 8200-SEND-DATAONLY
 11813     END-IF.
 11814
 11815     IF CLMNOI       NOT = PI-LAST-CLAIM       OR
 11816        CLMCARRI     NOT = PI-LAST-CARR        OR
 11817        CERTNOI      NOT = PI-LAST-CERT-PRIME  OR
 11818        SUFXI        NOT = PI-LAST-CERT-SUFX   OR
 11819        PI-INCURR-SW NOT = 'Y'
 11820          GO TO 1000-SHOW-CLAIM
 11821     END-IF.
 11822
 11823     PERFORM 6000-EDIT-CLAIM-DATA THRU 6000-EXIT.
 11824     PERFORM 6200-EDIT-CERT-DATA  THRU 6200-EXIT.
 11825     PERFORM 6400-TEST-CLAIM-REASONABILITY THRU 6499-EXIT.
 11826
 11827     IF EMI-NO-ERRORS
 11828         GO TO 5000-TRY-TO-BUILD
 11829     END-IF.
 11830
 11831     IF EIBAID = DFHPF6  AND NOT FORCE-CAP
 11832        MOVE ER-0433             TO EMI-ERROR
 11833        MOVE -1                  TO MAINTL
 11834        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11835        GO TO 8200-SEND-DATAONLY
 11836     END-IF.
 11837
 11838     IF EIBAID = DFHPF6
 11839         IF EMI-FATAL-CTR NOT EQUAL ZERO
 11840            MOVE ER-0434         TO EMI-ERROR
 11841            MOVE -1              TO MAINTL
 11842            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11843            GO TO 8200-SEND-DATAONLY
 11844         ELSE
 11845            MOVE +1              TO INCURL
 11846            GO TO 5000-TRY-TO-BUILD
 11847         END-IF
 11848     END-IF.
 11849
 11850     GO TO 8200-SEND-DATAONLY.
 11851
 11852 5000-TRY-TO-BUILD.
 11853
 11854     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 11855
 11856     MOVE CLMCARRI               TO MSTR-CARRIER.
 11857
 11858     MOVE CLMNOI                 TO MSTR-CLAIM-NO.
 11859     MOVE CERTNOI                TO MSTR-CERT-NO-PRIME.
 11860     MOVE SUFXI                  TO MSTR-CERT-NO-SUFX.
 11861
 11862     PERFORM 7920-READ-CLAIM-UPDATE THRU 7920-EXIT.
 11863
 11864     IF CL-CLAIM-PAYMENT-STATUS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 223
* EL130.cbl
 11865         MOVE ZEROS              TO CL-CLAIM-PAYMENT-STATUS
 11866     END-IF.
 11867
 11868     IF CL-PURGED-DT NOT = LOW-VALUES
 11869
 11870
 11871* EXEC CICS UNLOCK
 11872*            DATASET   (ELMSTR-DSID)
 11873*        END-EXEC
 11874*    MOVE '&*                    #   #00010932' TO DFHEIV0
 11875     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 11876     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 11877     MOVE X'2020233030303130393332' TO DFHEIV0(25:11)
 11878     CALL 'kxdfhei1' USING DFHEIV0,
 11879           ELMSTR-DSID,
 11880           DFHEIV99
 11881     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11882         MOVE ER-7691            TO EMI-ERROR
 11883         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11884         MOVE -1                 TO MAINTL
 11885         GO TO 8200-SEND-DATAONLY
 11886     END-IF.
 11887
 11888     IF CL-AUTO-PAY-SEQ NOT = ZERO
 11889
 11890
 11891* EXEC CICS UNLOCK
 11892*            DATASET   (ELMSTR-DSID)
 11893*       END-EXEC
 11894*    MOVE '&*                    #   #00010943' TO DFHEIV0
 11895     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 11896     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 11897     MOVE X'2020233030303130393433' TO DFHEIV0(25:11)
 11898     CALL 'kxdfhei1' USING DFHEIV0,
 11899           ELMSTR-DSID,
 11900           DFHEIV99
 11901     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11902         MOVE ER-0523             TO EMI-ERROR
 11903         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11904         MOVE -1                  TO MAINTL
 11905         GO TO 8200-SEND-DATAONLY
 11906     END-IF.
 11907
 11908     PERFORM 7900-READ-ACTV-UPDATE THRU 7900-EXIT.
 11909
 11910     MOVE AT-ITD-PAID-EXPENSES       TO WS-ITD-PAID-EXPENSE.
 11911     MOVE AT-ITD-CHARGEABLE-EXPENSE  TO WS-ITD-CHARGABLE-EXPENSE.
 11912     MOVE AT-INITIAL-MANUAL-RESERVE  TO WS-INITIAL-MANUAL-RESERVE.
 11913     MOVE AT-CURRENT-MANUAL-RESERVE  TO WS-CURRENT-MANUAL-RESERVE.
 11914     MOVE AT-ITD-ADDITIONAL-RESERVE  TO WS-ITD-ADDITIONAL-RESERVE.
 11915
 11916     IF MANRSVL GREATER ZERO
 11917        MOVE WS-MANRSV           TO AT-INITIAL-MANUAL-RESERVE
 11918                                    AT-CURRENT-MANUAL-RESERVE
 11919     END-IF.
 11920     MOVE 1                      TO SUB.
 11921
 11922 5010-LOOP.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 224
* EL130.cbl
 11923     IF SUB = 1
 11924        MOVE WS-TODAY-DT         TO AT-OPEN-CLOSE-DATE   (SUB)
 11925        MOVE 'O'                 TO AT-OPEN-CLOSE-TYPE   (SUB)
 11926        MOVE 'NEW'               TO AT-OPEN-CLOSE-REASON (SUB)
 11927     ELSE
 11928        MOVE LOW-VALUES          TO AT-OPEN-CLOSE-DATE   (SUB)
 11929        MOVE SPACES              TO AT-OPEN-CLOSE-TYPE   (SUB)
 11930                                    AT-OPEN-CLOSE-REASON (SUB)
 11931     END-IF.
 11932
 11933     IF SUB NOT = 6
 11934        ADD 1                    TO SUB
 11935        GO TO 5010-LOOP
 11936     END-IF.
 11937
 11938 5020-UPDATE.
 11939
 11940     PERFORM 7915-REWRITE-TRAILER THRU 7915-EXIT.
 11941
 11942     IF DIAGL = ZERO
 11943         PERFORM 7910-READ-NINETY THRU 7910-EXIT
 11944         MOVE AT-INFO-LINE-1     TO WS-DIAGNOSIS-DESCRIPT
 11945         GO TO 5025-BYPASS-UPDATE
 11946     END-IF.
 11947
 11948     PERFORM 7900-READ-NINETY-UPDATE THRU 7900-EXIT.
 11949
 11950     MOVE AT-INFO-LINE-1         TO WS-DIAGNOSIS-DESCRIPT.
 11951     MOVE DIAGI                  TO AT-INFO-LINE-1.
 11952
 11953     PERFORM 7915-REWRITE-TRAILER THRU 7915-EXIT.
 11954
 11955 5025-BYPASS-UPDATE.
 11956
 11957
 11958
 11959* EXEC CICS GETMAIN
 11960*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 11961*        LENGTH   (ELTRLR-LENGTH)
 11962*    END-EXEC.
 11963*    MOVE '," L                  $   #00011002' TO DFHEIV0
 11964     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 11965     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11966     MOVE X'2020233030303131303032' TO DFHEIV0(25:11)
 11967     CALL 'kxdfhei1' USING DFHEIV0,
 11968           DFHEIV20,
 11969           ELTRLR-LENGTH,
 11970           DFHEIV99
 11971     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11972         DFHEIV20
 11973     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11974
 11975
 11976     MOVE SPACES                 TO ACTIVITY-TRAILERS.
 11977     MOVE 'AT'                   TO AT-RECORD-ID.
 11978
 11979     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
 11980     MOVE MSTR-CARRIER           TO AT-CARRIER.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 225
* EL130.cbl
 11981     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
 11982     MOVE MSTR-CERT-NO           TO AT-CERT-NO.
 11983     MOVE CL-TRAILER-SEQ-CNT     TO AT-TRAILER-CNT-AT-CHG.
 11984     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT.
 11985     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 11986     MOVE '9'                    TO AT-TRAILER-TYPE.
 11987     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 11988     MOVE '5'                    TO DC-OPTION-CODE.
 11989     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11990     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT.
 11991
 11992     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY.
 11993     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 11994
 11995     MOVE CL-INCURRED-DT         TO AT-OLD-INCURRED-DT.
 11996     MOVE CL-REPORTED-DT         TO AT-OLD-REPORTED-DT.
 11997     MOVE CL-FILE-ESTABLISH-DT   TO AT-OLD-ESTABLISHED-DT.
 11998     MOVE CL-TOTAL-PAID-AMT      TO AT-OLD-TOTAL-PAID.
 11999     MOVE CL-NO-OF-DAYS-PAID     TO AT-OLD-DAYS-PAID.
 12000     MOVE CL-NO-OF-PMTS-MADE     TO AT-OLD-NO-OF-PMTS.
 12001     MOVE CL-PAID-THRU-DT        TO AT-OLD-PAID-THRU-DT.
 12002     MOVE CL-LAST-PMT-DT         TO AT-LAST-PMT-MADE-DT.
 12003     MOVE WS-DIAGNOSIS-DESCRIPT  TO AT-OLD-DIAG-DESCRIP.
 12004     MOVE CL-CAUSE-CD            TO AT-OLD-DIAG-CODE.
 12005
 12006     MOVE WS-ITD-PAID-EXPENSE    TO AT-OLD-ITD-PAID-EXPENSE.
 12007     MOVE WS-ITD-CHARGABLE-EXPENSE   TO AT-OLD-CHARGABLE-EXPENSE.
 12008     MOVE WS-INITIAL-MANUAL-RESERVE  TO AT-OLD-INIT-MAN-RESV.
 12009     MOVE WS-CURRENT-MANUAL-RESERVE  TO AT-OLD-CURRENT-MAN-RESV.
 12010     MOVE WS-ITD-ADDITIONAL-RESERVE  TO AT-OLD-ADDL-MAN-RESV.
 12011
 12012
 12013
 12014* EXEC CICS WRITE
 12015*        DATASET   (ELTRLR-DSID)
 12016*        FROM      (ACTIVITY-TRAILERS)
 12017*        RIDFLD    (AT-CONTROL-PRIMARY)
 12018*    END-EXEC.
 12019     MOVE LENGTH OF
 12020      ACTIVITY-TRAILERS
 12021       TO DFHEIV11
 12022*    MOVE '&$ L                  ''   #00011044' TO DFHEIV0
 12023     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12024     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12025     MOVE X'2020233030303131303434' TO DFHEIV0(25:11)
 12026     CALL 'kxdfhei1' USING DFHEIV0,
 12027           ELTRLR-DSID,
 12028           ACTIVITY-TRAILERS,
 12029           DFHEIV11,
 12030           AT-CONTROL-PRIMARY,
 12031           DFHEIV99,
 12032           DFHEIV99
 12033     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12034
 12035
 12036     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
 12037     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
 12038     MOVE CL-CERT-GROUPING       TO CERT-GROUPING.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 226
* EL130.cbl
 12039     MOVE CL-CERT-STATE          TO CERT-STATE.
 12040     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
 12041     MOVE CL-CERT-NO             TO CERT-CERT-NO.
 12042     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
 12043
 12044
 12045
 12046* EXEC CICS HANDLE CONDITION
 12047*        NOTFND   (5050-CERT-NOT-FOUND)
 12048*    END-EXEC.
 12049*    MOVE '"$I                   ! ; #00011059' TO DFHEIV0
 12050     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12051     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12052     MOVE X'3B20233030303131303539' TO DFHEIV0(25:11)
 12053     CALL 'kxdfhei1' USING DFHEIV0
 12054     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12055
 12056
 12057     PERFORM 7930-READ-CERT-UPDATE THRU 7930-EXIT.
 12058
 12059     PERFORM 3700-BUILD-CERT THRU 3700-EXIT.
 12060
 12061
 12062
 12063* EXEC CICS HANDLE CONDITION
 12064*         DUPKEY   (5030-CERT-WRITTEN)
 12065*    END-EXEC.
 12066*    MOVE '"$$                   ! < #00011068' TO DFHEIV0
 12067     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 12068     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12069     MOVE X'3C20233030303131303638' TO DFHEIV0(25:11)
 12070     CALL 'kxdfhei1' USING DFHEIV0
 12071     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12072
 12073
 12074
 12075
 12076* EXEC CICS REWRITE
 12077*        DATASET  (ELCERT-DSID)
 12078*        FROM     (CERTIFICATE-MASTER)
 12079*    END-EXEC.
 12080     MOVE LENGTH OF
 12081      CERTIFICATE-MASTER
 12082       TO DFHEIV11
 12083*    MOVE '&& L                  %   #00011073' TO DFHEIV0
 12084     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12085     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12086     MOVE X'2020233030303131303733' TO DFHEIV0(25:11)
 12087     CALL 'kxdfhei1' USING DFHEIV0,
 12088           ELCERT-DSID,
 12089           CERTIFICATE-MASTER,
 12090           DFHEIV11,
 12091           DFHEIV99
 12092     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12093
 12094
 12095 5030-CERT-WRITTEN.
 12096
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 227
* EL130.cbl
 12097     MOVE LOW-VALUES             TO CL-LAST-PMT-DT
 12098                                    CL-INCURRED-DT
 12099                                    CL-REPORTED-DT
 12100                                    CL-EST-END-OF-DISAB-DT
 12101                                    CL-PAID-THRU-DT.
 12102
 12103     MOVE ZEROS                  TO CL-TOTAL-PAID-AMT
 12104                                    CL-NO-OF-PMTS-MADE
 12105                                    CL-NO-OF-DAYS-PAID.
 12106
 12107     IF CLAIM-IS-CLOSED
 12108        MOVE WS-TODAY-DT         TO CL-LAST-REOPEN-DT
 12109        MOVE 'O'                 TO CL-CLAIM-STATUS
 12110     END-IF.
 12111
 12112     PERFORM 3995-BUILD-CLAIM-RECORD THRU 3995-EXIT.
 12113     MOVE '5'                    TO CL-LAST-MAINT-TYPE.
 12114     MOVE EMI-FORCABLE-CTR       TO CL-FORCEABLE-ERROR-CNT.
 12115
 12116
 12117
 12118* EXEC CICS HANDLE CONDITION
 12119*         DUPKEY   (5035-CLAIM-WRITTEN)
 12120*    END-EXEC.
 12121*    MOVE '"$$                   ! = #00011100' TO DFHEIV0
 12122     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 12123     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12124     MOVE X'3D20233030303131313030' TO DFHEIV0(25:11)
 12125     CALL 'kxdfhei1' USING DFHEIV0
 12126     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12127
 12128
 12129
 12130
 12131* EXEC CICS REWRITE
 12132*        DATASET   (ELMSTR-DSID)
 12133*        FROM      (CLAIM-MASTER)
 12134*    END-EXEC.
 12135     MOVE LENGTH OF
 12136      CLAIM-MASTER
 12137       TO DFHEIV11
 12138*    MOVE '&& L                  %   #00011105' TO DFHEIV0
 12139     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12140     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12141     MOVE X'2020233030303131313035' TO DFHEIV0(25:11)
 12142     CALL 'kxdfhei1' USING DFHEIV0,
 12143           ELMSTR-DSID,
 12144           CLAIM-MASTER,
 12145           DFHEIV11,
 12146           DFHEIV99
 12147     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12148
 12149
 12150 5035-CLAIM-WRITTEN.
 12151
 12152     MOVE ER-0000                TO EMI-ERROR.
 12153     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12154
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 228
* EL130.cbl
 12155     MOVE CLMNOI                 TO PI-LAST-CLAIM.
 12156     MOVE CERTNOI                TO PI-LAST-CERT-PRIME.
 12157     MOVE SUFXI                  TO PI-LAST-CERT-SUFX.
 12158     MOVE CLMCARRI               TO PI-LAST-CARR.
 12159
 12160     IF PRTOPTL GREATER ZERO
 12161         MOVE PRTOPTI            TO PI-PRT-OPT
 12162     END-IF.
 12163
 12164     IF ALTPRTL GREATER ZERO
 12165         MOVE ALTPRTI            TO PI-ALT-PRT
 12166     END-IF.
 12167
 12168     MOVE LOW-VALUES             TO EL130AI.
 12169
 12170     MOVE PI-LAST-CERT-PRIME     TO CERTNOO.
 12171     MOVE PI-LAST-CERT-SUFX      TO SUFXO.
 12172     MOVE PI-LAST-CARR           TO CLMCARRO.
 12173     MOVE PI-LAST-CLAIM          TO CLMNOO.
 12174
 12175     IF PI-PRT-OPT = 'N' OR 'L'
 12176         MOVE PI-PRT-OPT         TO PRTOPTO
 12177         MOVE 1                  TO PRTOPTL
 12178     END-IF.
 12179
 12180     IF PI-ALT-PRT NOT = SPACES AND LOW-VALUES
 12181         MOVE PI-ALT-PRT         TO ALTPRTO
 12182         MOVE 4                  TO ALTPRTL
 12183     END-IF.
 12184
 12185     MOVE AL-UANON               TO CLMNOA CLMCARRA.
 12186     MOVE AL-SANON               TO CERTNOA SUFXA.
 12187
 12188     MOVE SPACES                 TO PI-INCURR-SW.
 12189
 12190     IF PRTOPTL GREATER ZERO
 12191         IF PRTOPTI = 'L'
 12192             GO TO 0400-CREATE-ELACTQ
 12193         ELSE
 12194             GO TO 0480-PRINT-NOW
 12195         END-IF
 12196     END-IF.
 12197
 12198     GO TO 8100-SEND-INITIAL-MAP.
 12199
 12200 5050-CERT-NOT-FOUND.
 12201
 12202     MOVE ER-0244                TO EMI-ERROR.
 12203     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12204     MOVE -1                     TO CERTNOL.
 12205     GO TO 8200-SEND-DATAONLY.
 12206
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 229
* EL130.cbl
 12208 5500-BUILD-FORM-TRAILER.
 12209*************************************************************
 12210*           THIS CODE IS FOR 'CRI' ONLY         04/18/88
 12211*************************************************************
 12212
 12213     MOVE WS-TODAY-DT            TO SAVE-SEND-DT.
 12214
 12215     IF  WS-BEN-ALPHA-2 = '30'
 12216         MOVE WS-TODAY-DT        TO DC-BIN-DATE-1
 12217         MOVE '6'                TO DC-OPTION-CODE
 12218         IF CL-CARRIER = 'C'
 12219             MOVE +14            TO DC-ELAPSED-DAYS
 12220             MOVE +0             TO DC-ELAPSED-MONTHS
 12221             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12222             MOVE DC-BIN-DATE-2  TO SAVE-SEND-DT
 12223         ELSE
 12224             MOVE +21            TO DC-ELAPSED-DAYS
 12225             MOVE +0             TO DC-ELAPSED-MONTHS
 12226             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12227             MOVE DC-BIN-DATE-2      TO  SAVE-SEND-DT
 12228         END-IF
 12229     END-IF.
 12230
 12231
 12232
 12233* EXEC CICS GETMAIN
 12234*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 12235*         LENGTH   (ELTRLR-LENGTH)
 12236*         INITIMG  (GETMAIN-SPACE)
 12237*    END-EXEC.
 12238*    MOVE ',"IL                  $   #00011192' TO DFHEIV0
 12239     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12240     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12241     MOVE X'2020233030303131313932' TO DFHEIV0(25:11)
 12242     CALL 'kxdfhei1' USING DFHEIV0,
 12243           DFHEIV20,
 12244           ELTRLR-LENGTH,
 12245           GETMAIN-SPACE
 12246     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12247         DFHEIV20
 12248     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12249
 12250
 12251     MOVE SAVE-AT-PRIMARY-KEY    TO AT-CONTROL-PRIMARY.
 12252     MOVE 'AT'                   TO AT-RECORD-ID.
 12253
 12254     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 12255     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 12256     MOVE 'A'                    TO AT-TRAILER-TYPE.
 12257     MOVE WS-TODAY-DT            TO AT-RECORDED-DT
 12258                                    AT-FORM-LAST-MAINT-DT.
 12259     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 12260                                    AT-FORM-LAST-UPDATED-BY.
 12261     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 12262     MOVE SAVE-SEND-DT           TO AT-FORM-SEND-ON-DT.
 12263     MOVE LOW-VALUES             TO AT-FORM-FOLLOW-UP-DT
 12264                                    AT-FORM-RE-SEND-DT
 12265                                    AT-FORM-ANSWERED-DT
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 230
* EL130.cbl
 12266                                    AT-EMP-FORM-ANSWERED-DT
 12267                                    AT-PHY-FORM-ANSWERED-DT
 12268                                    AT-EMP-FORM-SEND-ON-DT
 12269                                    AT-FORM-PRINTED-DT
 12270                                    AT-FORM-REPRINT-DT.
 12271     MOVE '1'                    TO AT-FORM-TYPE.
 12272
 12273     MOVE SPACES                 TO AT-INSTRUCT-LN-1
 12274                                    AT-INSTRUCT-LN-2
 12275                                    AT-INSTRUCT-LN-3.
 12276
 12277     MOVE CL-INSURED-ADDR-CNT    TO AT-FORM-ADDR-SEQ-NO.
 12278     MOVE 'I'                    TO AT-FORM-ADDRESS.
 12279
 12280     MOVE SAVE-SEND-DT           TO AT-PHY-FORM-SEND-ON-DT.
 12281
 12282     IF AM-EMPLOYER-STMT-USED = 'Y'
 12283        MOVE SAVE-SEND-DT       TO AT-EMP-FORM-SEND-ON-DT
 12284     END-IF.
 12285
 12286
 12287
 12288* EXEC CICS WRITE
 12289*         DATASET  (ELTRLR-DSID)
 12290*         FROM     (ACTIVITY-TRAILERS)
 12291*         RIDFLD   (AT-CONTROL-PRIMARY)
 12292*    END-EXEC.
 12293     MOVE LENGTH OF
 12294      ACTIVITY-TRAILERS
 12295       TO DFHEIV11
 12296*    MOVE '&$ L                  ''   #00011234' TO DFHEIV0
 12297     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12298     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12299     MOVE X'2020233030303131323334' TO DFHEIV0(25:11)
 12300     CALL 'kxdfhei1' USING DFHEIV0,
 12301           ELTRLR-DSID,
 12302           ACTIVITY-TRAILERS,
 12303           DFHEIV11,
 12304           AT-CONTROL-PRIMARY,
 12305           DFHEIV99,
 12306           DFHEIV99
 12307     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12308
 12309
 12310 5599-EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 231
* EL130.cbl
 12312*************************************************************
 12313*           THIS CODE IS FOR 'CRI' ONLY         04/18/88
 12314*************************************************************
 12315
 12316 5700-BUILD-ARCHIVE-HEADER.
 12317
 12318     MOVE '1'                    TO CNTL-REC-TYPE.
 12319     MOVE ZEROS                  TO CNTL-SEQ-NO.
 12320     MOVE SPACES                 TO CNTL-ACCESS.
 12321
 12322
 12323
 12324* EXEC CICS READ
 12325*         DATASET  (ELCNTL-DSID)
 12326*         SET      (ADDRESS OF CONTROL-FILE)
 12327*         RIDFLD   (ELCNTL-KEY)
 12328*         UPDATE
 12329*    END-EXEC.
 12330*    MOVE '&"S        EU         (   #00011253' TO DFHEIV0
 12331     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12332     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12333     MOVE X'2020233030303131323533' TO DFHEIV0(25:11)
 12334     CALL 'kxdfhei1' USING DFHEIV0,
 12335           ELCNTL-DSID,
 12336           DFHEIV20,
 12337           DFHEIV99,
 12338           ELCNTL-KEY,
 12339           DFHEIV99,
 12340           DFHEIV99,
 12341           DFHEIV99
 12342     SET ADDRESS OF CONTROL-FILE TO
 12343         DFHEIV20
 12344     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12345
 12346
 12347     ADD 1 TO CF-CO-ARCHIVE-COUNTER.
 12348
 12349     MOVE CF-CO-ARCHIVE-COUNTER  TO ARCH-NUMBER.
 12350
 12351
 12352
 12353* EXEC CICS REWRITE
 12354*         FROM     (CONTROL-FILE)
 12355*         DATASET  (ELCNTL-DSID)
 12356*    END-EXEC.
 12357     MOVE LENGTH OF
 12358      CONTROL-FILE
 12359       TO DFHEIV11
 12360*    MOVE '&& L                  %   #00011265' TO DFHEIV0
 12361     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12362     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12363     MOVE X'2020233030303131323635' TO DFHEIV0(25:11)
 12364     CALL 'kxdfhei1' USING DFHEIV0,
 12365           ELCNTL-DSID,
 12366           CONTROL-FILE,
 12367           DFHEIV11,
 12368           DFHEIV99
 12369     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 232
* EL130.cbl
 12370
 12371
 12372
 12373
 12374* EXEC CICS HANDLE CONDITION
 12375*         NOTOPEN  (9990-ABEND)
 12376*         DUPKEY   (5799-EXIT)
 12377*    END-EXEC.
 12378*    MOVE '"$J$                  ! > #00011271' TO DFHEIV0
 12379     MOVE X'22244A242020202020202020' TO DFHEIV0(1:12)
 12380     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12381     MOVE X'3E20233030303131323731' TO DFHEIV0(25:11)
 12382     CALL 'kxdfhei1' USING DFHEIV0
 12383     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12384
 12385
 12386
 12387
 12388* EXEC CICS GETMAIN
 12389*         SET     (ADDRESS OF LETTER-ARCHIVE)
 12390*         LENGTH  (ELARCH-LENGTH)
 12391*    END-EXEC.
 12392*    MOVE '," L                  $   #00011277' TO DFHEIV0
 12393     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 12394     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12395     MOVE X'2020233030303131323737' TO DFHEIV0(25:11)
 12396     CALL 'kxdfhei1' USING DFHEIV0,
 12397           DFHEIV20,
 12398           ELARCH-LENGTH,
 12399           DFHEIV99
 12400     SET ADDRESS OF LETTER-ARCHIVE TO
 12401         DFHEIV20
 12402     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12403
 12404
 12405     MOVE SPACES                 TO LETTER-ARCHIVE.
 12406     MOVE 'LA'                   TO LA-RECORD-ID.
 12407     MOVE ARCH-NUMBER            TO LA-ARCHIVE-NO
 12408                                    LA-ARCHIVE-NO-A1.
 12409     MOVE '4'                    TO LA-RECORD-TYPE
 12410                                    LA-RECORD-TYPE-A1.
 12411     MOVE ZEROS                  TO LA-LINE-SEQ-NO
 12412                                    LA-LINE-SEQ-NO-A1.
 12413     MOVE PI-COMPANY-CD          TO LA-COMPANY-CD
 12414                                    LA-COMPANY-CD-A1.
 12415     MOVE CL-CARRIER             TO LA4-CARRIER.
 12416     MOVE CL-CLAIM-NO            TO LA4-CLAIM-NO.
 12417     MOVE CL-CERT-NO             TO LA4-CERT-NO.
 12418     MOVE CL-CERT-STATE          TO LA4-STATE.
 12419     MOVE  ZEROS                 TO LA4-NO-OF-COPIES.
 12420     MOVE PI-PROCESSOR-ID        TO LA4-PROCESSOR-CD.
 12421     MOVE WS-TODAY-DT            TO LA4-CREATION-DT.
 12422     MOVE LOW-VALUES             TO LA4-INITIAL-PRINT-DATE
 12423                                    LA4-RESEND-PRINT-DATE
 12424                                    LA4-FORM-REM-PRINT-DT
 12425                                    LA4-RESEND-DATE.
 12426     MOVE CL-TRAILER-SEQ-CNT     TO LA4-FORM-TRLR-SEQ.
 12427     MOVE '1'                    TO LA4-FORM-TYPE.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 233
* EL130.cbl
 12428
 12429
 12430
 12431* EXEC CICS WRITE
 12432*         DATASET  (ELARCH-DSID)
 12433*         FROM     (LETTER-ARCHIVE)
 12434*         RIDFLD   (LA-CONTROL-PRIMARY)
 12435*    END-EXEC.
 12436     MOVE LENGTH OF
 12437      LETTER-ARCHIVE
 12438       TO DFHEIV11
 12439*    MOVE '&$ L                  ''   #00011307' TO DFHEIV0
 12440     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12441     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12442     MOVE X'2020233030303131333037' TO DFHEIV0(25:11)
 12443     CALL 'kxdfhei1' USING DFHEIV0,
 12444           ELARCH-DSID,
 12445           LETTER-ARCHIVE,
 12446           DFHEIV11,
 12447           LA-CONTROL-PRIMARY,
 12448           DFHEIV99,
 12449           DFHEIV99
 12450     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12451
 12452
 12453 5799-EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 234
* EL130.cbl
 12455 6000-EDIT-CLAIM-DATA.
 12456
 12457     MOVE SAVE-DATE              TO DC-GREG-DATE-1-EDIT.
 12458     MOVE '2'                    TO DC-OPTION-CODE.
 12459     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12460     MOVE DC-BIN-DATE-1          TO WS-TODAY-DT.
 12461
 12462     IF CLMNOL GREATER ZERO
 12463         IF CLMNOI = SPACES OR LOW-VALUES
 12464             MOVE -1             TO CLMNOL
 12465             MOVE AL-UABON       TO CLMNOA
 12466             MOVE ER-7688        TO EMI-ERROR
 12467             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12468         ELSE
 12469             MOVE AL-UANON       TO CLMNOA
 12470         END-IF
 12471     END-IF.
 12472
 12473     IF CERTNOL = ZERO
 12474         MOVE -1                 TO CERTNOL
 12475         MOVE AL-SABON           TO CERTNOA
 12476         MOVE ER-0203            TO EMI-ERROR
 12477         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12478     ELSE
 12479         MOVE AL-SANON           TO CERTNOA
 12480     END-IF.
 12481
 12482     IF SUFXL = ZERO
 12483         MOVE SPACES             TO SUFXI
 12484         MOVE AL-SANON           TO SUFXA
 12485     ELSE
 12486         MOVE AL-SANON           TO SUFXA
 12487     END-IF.
 12488
 12489     IF CLMCARRL = ZERO
 12490         MOVE -1                 TO CLMCARRL
 12491         MOVE ER-0194            TO EMI-ERROR
 12492         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12493     ELSE
 12494         MOVE CLMCARRI           TO PI-CARRIER
 12495         IF PI-NO-CARRIER-SECURITY
 12496             MOVE AL-UANON       TO CLMCARRA
 12497         END-IF
 12498     END-IF.
 12499
 12500     IF CLMTYPEL > ZERO
 12501        IF ((PI-COMPANY-ID = 'DCC')
 12502           AND (CLMTYPEI NOT = PI-LIFE-OVERRIDE-L1
 12503              AND PI-AH-OVERRIDE-L1 AND 'I' AND 'G'))
 12504                        OR
 12505           ((PI-COMPANY-ID = 'CID' OR 'AHL')
 12506           AND (CLMTYPEI NOT = PI-LIFE-OVERRIDE-L1
 12507              AND PI-AH-OVERRIDE-L1))
 12508              MOVE -1             TO CLMTYPEL
 12509              MOVE AL-UABON       TO CLMTYPEA
 12510              MOVE ER-7634        TO EMI-ERROR
 12511              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12512        ELSE
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 235
* EL130.cbl
 12513           MOVE AL-UANON       TO CLMTYPEA
 12514        END-IF
 12515     ELSE
 12516        IF MAINTI = 'A'
 12517           MOVE -1             TO CLMTYPEL
 12518           MOVE AL-UABON       TO CLMTYPEA
 12519           MOVE ER-0546        TO EMI-ERROR
 12520           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12521        END-IF
 12522     END-IF
 12523*    if instypel > ZERO
 12524*       if instypei = 'P' OR 'S'
 12525*          move al-uanon         to instypea
 12526*       else
 12527*          MOVE -1               TO INSTYPEL
 12528*          MOVE AL-UABON         TO INSTYPEA
 12529*          MOVE ER-1654          TO EMI-ERROR
 12530*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12531*       END-IF
 12532*    ELSE
 12533*       IF MAINTI = 'A'
 12534*          MOVE -1               TO INSTYPEL
 12535*          MOVE AL-UABON         TO INSTYPEA
 12536*          MOVE ER-1654          TO EMI-ERROR
 12537*          PERFORM 9900-ERROR-FORMAT
 12538*                                THRU 9900-EXIT
 12539*       END-IF
 12540*    END-IF
 12541     IF PCERTNOL = ZERO
 12542        MOVE CERTNOI             TO PCERTNOI
 12543        MOVE CERTNOL             TO PCERTNOL
 12544        MOVE AL-UANON            TO PCERTNOA
 12545     ELSE
 12546        MOVE AL-UANON            TO PCERTNOA
 12547     END-IF.
 12548
 12549     IF PSUFXL = ZERO
 12550        MOVE SUFXI               TO PSUFXI
 12551        MOVE SUFXL               TO PSUFXL
 12552        MOVE AL-UANON            TO PSUFXA
 12553     ELSE
 12554        MOVE AL-UANON            TO PSUFXA
 12555     END-IF.
 12556
 12557     IF MAINTI = 'I'
 12558         GO TO 6020-EDIT
 12559     END-IF.
 12560
 12561     IF LSTNMEL = ZERO AND CERTMTL NOT = ZEROS
 12562         MOVE -1                 TO LSTNMEL
 12563         MOVE ER-0236            TO EMI-ERROR
 12564         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12565     ELSE
 12566         MOVE AL-UANON           TO LSTNMEA
 12567     END-IF.
 12568     IF SEXL > ZEROS
 12569        IF SEXI = 'M' OR 'F'
 12570           CONTINUE
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 236
* EL130.cbl
 12571        ELSE
 12572           MOVE -1               TO SEXL
 12573           MOVE AL-UABON         TO SEXA
 12574           MOVE ER-0219          TO EMI-ERROR
 12575           PERFORM 9900-ERROR-FORMAT
 12576                                 THRU 9900-EXIT
 12577        END-IF
 12578     ELSE
 12579        IF MAINTI = 'A'
 12580           MOVE -1               TO SEXL
 12581           MOVE AL-UABON         TO SEXA
 12582           MOVE ER-0219          TO EMI-ERROR
 12583           PERFORM 9900-ERROR-FORMAT
 12584                                 THRU 9900-EXIT
 12585        END-IF
 12586     END-IF
 12587     IF SSNL GREATER THAN ZERO
 12588         MOVE SSNI TO WS-SOC-SEC-NUMBER
 12589         IF WS-SOC-SEC-NO NUMERIC AND
 12590           (WS-SOC-SEC-BLANK = SPACES OR LOW-VALUES)
 12591             NEXT SENTENCE
 12592         ELSE
 12593            IF WS-SSN-1-3 NUMERIC AND WS-SSN-4-5 NUMERIC AND
 12594               WS-SSN-6-9 NUMERIC AND WS-SSN-DASH1 = '-' AND
 12595               WS-SSN-DASH2 = '-'
 12596                 NEXT SENTENCE
 12597            ELSE
 12598                 MOVE ER-0887        TO  EMI-ERROR
 12599                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12600                 MOVE AL-UABON       TO  SSNA
 12601                 MOVE -1             TO  SSNL
 12602            END-IF
 12603        END-IF
 12604     END-IF.
 12605
 12606     IF BIRTHDTL = ZERO
 12607         GO TO 6020-EDIT
 12608     END-IF.
 12609
 12610     IF BIRTHDTL GREATER ZERO
 12611         MOVE BIRTHDTI           TO DATE-WORK
 12612         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 12613         MOVE NUM-WORK           TO DC-GREG-DATE-1-MDY
 12614         MOVE '4'                TO DC-OPTION-CODE
 12615         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12616         IF DATE-CONVERSION-ERROR
 12617             MOVE AL-UABON       TO BIRTHDTA
 12618             MOVE -1             TO BIRTHDTL
 12619             MOVE ER-0220        TO EMI-ERROR
 12620             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12621             GO TO 6020-EDIT
 12622         END-IF
 12623     END-IF.
 12624
 12625******************************************************************
 12626**   IF CALCULATED BIRTH DATE GREATER THAN TODAYS DATE          **
 12627**   USE THE CENTURY ADJUSTMENT SWITCH IN THE DATE ROUTINE      **
 12628**   TO SUBTRACT 100 YEARS TO OBTAIN THE CORRECT BIRTH DATE.    **
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 237
* EL130.cbl
 12629******************************************************************
 12630
 12631     IF DC-BIN-DATE-1 GREATER THAN SAVE-BIN-DATE
 12632         MOVE BIRTHDTI           TO  DATE-WORK
 12633         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 12634         MOVE NUM-WORK           TO  DC-GREG-DATE-1-MDY
 12635         MOVE '4'                TO  DC-OPTION-CODE
 12636         MOVE '1'                TO  DC-CENTURY-ADJUSTMENT
 12637         MOVE +0                 TO  DC-ELAPSED-MONTHS
 12638                                     DC-ELAPSED-DAYS
 12639         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12640         IF DATE-CONVERSION-ERROR
 12641             MOVE AL-UABON       TO  BIRTHDTA
 12642             MOVE -1             TO  BIRTHDTL
 12643             MOVE ER-0220        TO  EMI-ERROR
 12644             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12645             GO TO 6020-EDIT
 12646         END-IF
 12647     END-IF.
 12648
 12649     MOVE AL-UANON               TO  BIRTHDTA.
 12650     MOVE DC-GREG-DATE-1-EDIT    TO  BIRTHDTI.
 12651     MOVE DC-BIN-DATE-1          TO  WS-BIRTHDT.
 12652     MOVE ' '                    TO  DC-CENTURY-ADJUSTMENT.
 12653
 12654 6020-EDIT.
 12655     IF INCURL GREATER ZERO
 12656         MOVE INCURI             TO DATE-WORK
 12657         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 12658         MOVE NUM-WORK           TO DC-GREG-DATE-1-MDY
 12659         MOVE '4'                TO DC-OPTION-CODE
 12660         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12661         IF DATE-CONVERSION-ERROR
 12662             MOVE AL-UABON       TO INCURA
 12663             MOVE -1             TO INCURL
 12664             MOVE ER-0222        TO EMI-ERROR
 12665             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12666         ELSE
 12667             MOVE AL-UANON       TO INCURA
 12668             MOVE DC-GREG-DATE-1-EDIT  TO INCURI
 12669             MOVE DC-BIN-DATE-1  TO WS-INCUR
 12670                                    PI-SAVE-INCUR-DT
 12671             IF WS-INCUR GREATER THAN WS-TODAY-DT
 12672                 MOVE ER-0511     TO EMI-ERROR
 12673                 MOVE -1          TO INCURL
 12674                 MOVE AL-UABON    TO INCURA
 12675                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12676             ELSE
 12677*                NEXT SENTENCE
 12678                 CONTINUE
 12679             END-IF
 12680         END-IF
 12681     ELSE
 12682         MOVE ER-0516         TO EMI-ERROR
 12683         MOVE AL-UABON        TO INCURA
 12684         MOVE -1              TO INCURL
 12685         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12686     END-IF.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 238
* EL130.cbl
 12687
 12688     IF REPORTL GREATER ZERO
 12689         MOVE REPORTI            TO DATE-WORK
 12690         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 12691         MOVE NUM-WORK           TO DC-GREG-DATE-1-MDY
 12692         MOVE '4'                TO DC-OPTION-CODE
 12693         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12694         IF DATE-CONVERSION-ERROR
 12695             MOVE AL-UABON       TO REPORTA
 12696             MOVE -1             TO REPORTL
 12697             MOVE ER-0223        TO EMI-ERROR
 12698             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12699         ELSE
 12700             MOVE AL-UANON       TO REPORTA
 12701             MOVE DC-GREG-DATE-1-EDIT  TO REPORTI
 12702             MOVE DC-BIN-DATE-1  TO WS-REPORT
 12703             IF WS-REPORT GREATER THAN WS-TODAY-DT
 12704                 MOVE ER-0512     TO EMI-ERROR
 12705                 MOVE -1          TO REPORTL
 12706                 MOVE AL-UABON    TO REPORTA
 12707                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12708             ELSE
 12709*                NEXT SENTENCE
 12710                 CONTINUE
 12711             END-IF
 12712         END-IF
 12713     ELSE
 12714         MOVE ER-0517         TO EMI-ERROR
 12715         MOVE -1              TO REPORTL
 12716         MOVE AL-UABON        TO REPORTA
 12717         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12718     END-IF.
 12719
 12720     IF WS-REPORT NOT = LOW-VALUES
 12721         IF WS-INCUR GREATER THAN WS-REPORT
 12722             MOVE AL-UABON       TO REPORTA
 12723             MOVE -1             TO REPORTL
 12724             MOVE ER-0509        TO EMI-ERROR
 12725             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12726         END-IF
 12727     END-IF.
 12728
 12729     IF ESTENDL GREATER ZERO
 12730         MOVE ESTENDI            TO DATE-WORK
 12731         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 12732         MOVE NUM-WORK           TO DC-GREG-DATE-1-MDY
 12733         MOVE '4'                TO DC-OPTION-CODE
 12734         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12735         IF DATE-CONVERSION-ERROR
 12736             MOVE AL-UABON       TO ESTENDA
 12737             MOVE -1             TO ESTENDL
 12738             MOVE ER-0224        TO EMI-ERROR
 12739             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12740         ELSE
 12741             MOVE AL-UANON       TO ESTENDA
 12742             MOVE DC-GREG-DATE-1-EDIT  TO ESTENDI
 12743             MOVE DC-BIN-DATE-1  TO WS-ESTEND
 12744             IF CLMTYPEI = PI-LIFE-OVERRIDE-L1
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 239
* EL130.cbl
 12745                MOVE AL-UABON    TO ESTENDA
 12746                MOVE -1          TO ESTENDL
 12747                MOVE ER-0544     TO EMI-ERROR
 12748                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12749             END-IF
 12750         END-IF
 12751     END-IF.
 12752
 12753     IF WS-ESTEND NOT = LOW-VALUES
 12754         IF WS-INCUR GREATER THAN WS-ESTEND
 12755             MOVE AL-UABON       TO ESTENDA
 12756             MOVE -1             TO ESTENDL
 12757             MOVE ER-0510        TO EMI-ERROR
 12758             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12759         END-IF
 12760     END-IF.
 12761
 12762     IF PRTOPTL GREATER ZERO
 12763         IF PRTOPTI NOT = 'N' AND 'L'
 12764             MOVE AL-UABON       TO PRTOPTA
 12765             MOVE -1             TO PRTOPTL
 12766             MOVE ER-0334        TO EMI-ERROR
 12767             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12768         END-IF
 12769     END-IF.
 12770
 12771     IF MANRSVL GREATER ZERO
 12772
 12773* EXEC CICS BIF DEEDIT
 12774*            FIELD   (MANRSVI)
 12775*            LENGTH  (9)
 12776*        END-EXEC
 12777     MOVE 9
 12778       TO DFHEIV11
 12779*    MOVE '@"L                   #   #00011632' TO DFHEIV0
 12780     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 12781     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12782     MOVE X'2020233030303131363332' TO DFHEIV0(25:11)
 12783     CALL 'kxdfhei1' USING DFHEIV0,
 12784           MANRSVI,
 12785           DFHEIV11
 12786     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12787         IF MANRSVI NOT NUMERIC
 12788             MOVE AL-UNBON       TO MANRSVA
 12789             MOVE -1             TO MANRSVL
 12790             MOVE ER-0489        TO EMI-ERROR
 12791             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12792         ELSE
 12793             MOVE AL-UNNON       TO MANRSVA
 12794             MOVE MANRSVI        TO WS-MANRSV  MANRSVO
 12795         END-IF
 12796     END-IF.
 12797
 12798     MOVE SPACES                 TO ELCNTL-KEY.
 12799
 12800     IF CONTROL-IS-ACTUAL-CARRIER
 12801         MOVE PI-CARRIER         TO CNTL-CARRIER
 12802     ELSE
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 240
* EL130.cbl
 12803         MOVE PI-CARRIER-CONTROL-LEVEL TO CNTL-CARRIER
 12804     END-IF.
 12805
 12806     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 12807     MOVE '6'                    TO CNTL-REC-TYPE.
 12808     MOVE +0                     TO CNTL-SEQ-NO.
 12809
 12810
 12811
 12812* EXEC CICS HANDLE CONDITION
 12813*        NOTFND   (3100-CARRIER-NOT-FOUND)
 12814*    END-EXEC.
 12815*    MOVE '"$I                   ! ? #00011660' TO DFHEIV0
 12816     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12817     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12818     MOVE X'3F20233030303131363630' TO DFHEIV0(25:11)
 12819     CALL 'kxdfhei1' USING DFHEIV0
 12820     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12821
 12822
 12823     PERFORM 7970-READ-CNTL THRU 7970-EXIT.
 12824
 12825     IF NOT CF-MANUAL-RESERVES-USED AND
 12826           WS-MANRSV GREATER ZERO
 12827         MOVE ER-0518             TO EMI-ERROR
 12828         MOVE -1                  TO MANRSVL
 12829         MOVE AL-UNBON            TO MANRSVA
 12830         MOVE ZEROS               TO WS-MANRSV
 12831         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12832     END-IF.
 12833
 12834     MOVE CF-RESERVE-CONTROLS    TO WS-RESERVE-CONTROLS.
 12835     MOVE CF-EXPENSE-CONTROLS    TO WS-EXPENSE-CONTROLS.
 12836
 12837     IF SUPVL GREATER ZERO
 12838         IF SUPVI NOT = ' ' AND 'Y' AND 'N'
 12839             MOVE -1             TO SUPVL
 12840             MOVE AL-UABON       TO SUPVA
 12841             MOVE ER-0230        TO EMI-ERROR
 12842             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12843         ELSE
 12844             MOVE AL-UANON       TO SUPVA
 12845         END-IF
 12846     END-IF.
 12847
 12848     IF PROCCDL = ZERO
 12849        GO TO 6050-CONTINUE-EDITS
 12850     END-IF.
 12851
 12852     MOVE SPACES                 TO ELCNTL-KEY.
 12853     MOVE PROCCDI                TO CNTL-ACCESS.
 12854
 12855     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 12856     MOVE '2'                    TO CNTL-REC-TYPE.
 12857     MOVE +0                     TO CNTL-SEQ-NO.
 12858
 12859
 12860
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 241
* EL130.cbl
 12861* EXEC CICS HANDLE CONDITION
 12862*        NOTFND   (6040-NO-PROCESSOR-RECORD)
 12863*    END-EXEC.
 12864*    MOVE '"$I                   ! @ #00011701' TO DFHEIV0
 12865     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12866     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12867     MOVE X'4020233030303131373031' TO DFHEIV0(25:11)
 12868     CALL 'kxdfhei1' USING DFHEIV0
 12869     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12870
 12871
 12872     PERFORM 7970-READ-CNTL THRU 7970-EXIT.
 12873
 12874     GO TO 6050-CONTINUE-EDITS.
 12875
 12876 6040-NO-PROCESSOR-RECORD.
 12877     MOVE ER-0019                TO EMI-ERROR.
 12878     MOVE -1                     TO PROCCDL.
 12879     MOVE AL-UABON               TO PROCCDA.
 12880     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12881
 12882 6050-CONTINUE-EDITS.
 12883     IF (BENECDL = ZERO) OR (BENECDI = SPACES OR LOW-VALUES)
 12884           GO TO 6070-CONTINUE-EDITS
 12885     END-IF.
 12886
 12887     MOVE BENECDI                TO BENE-CODE.
 12888     MOVE 'B'                    TO BENE-RCD-TYPE.
 12889     MOVE PI-COMPANY-CD          TO BENE-COMP-CD.
 12890
 12891
 12892
 12893* EXEC CICS HANDLE CONDITION
 12894*        NOTFND   (6060-NO-BENEFICIARY-RECORD)
 12895*    END-EXEC.
 12896*    MOVE '"$I                   ! A #00011725' TO DFHEIV0
 12897     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12898     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12899     MOVE X'4120233030303131373235' TO DFHEIV0(25:11)
 12900     CALL 'kxdfhei1' USING DFHEIV0
 12901     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12902
 12903
 12904
 12905* EXEC CICS READ
 12906*         DATASET   (ELBENE-DSID)
 12907*         SET       (ADDRESS OF BENEFICIARY-MASTER)
 12908*         RIDFLD    (ELBENE-KEY)
 12909*    END-EXEC.
 12910*    MOVE '&"S        E          (   #00011729' TO DFHEIV0
 12911     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12912     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12913     MOVE X'2020233030303131373239' TO DFHEIV0(25:11)
 12914     CALL 'kxdfhei1' USING DFHEIV0,
 12915           ELBENE-DSID,
 12916           DFHEIV20,
 12917           DFHEIV99,
 12918           ELBENE-KEY,
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 242
* EL130.cbl
 12919           DFHEIV99,
 12920           DFHEIV99,
 12921           DFHEIV99
 12922     SET ADDRESS OF BENEFICIARY-MASTER TO
 12923         DFHEIV20
 12924     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12925
 12926
 12927     GO TO 6070-CONTINUE-EDITS.
 12928
 12929 6060-NO-BENEFICIARY-RECORD.
 12930     MOVE ER-0565                TO EMI-ERROR.
 12931     MOVE -1                     TO BENECDL.
 12932     MOVE AL-UABON               TO BENECDA.
 12933     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12934
 12935
 12936 6070-CONTINUE-EDITS.
 12937     IF CERTMTL GREATER ZERO
 12938         IF CERTMTI NOT = 'A' AND 'S'
 12939             MOVE -1             TO CERTMTL
 12940             MOVE AL-UABON       TO CERTMTA
 12941             MOVE ER-0267        TO EMI-ERROR
 12942             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12943         ELSE
 12944             MOVE AL-UANON       TO CERTMTA
 12945         END-IF
 12946     ELSE
 12947         GO TO 6000-EXIT
 12948     END-IF.
 12949
 12950     IF EFFDTL GREATER ZERO
 12951         MOVE EFFDTI             TO DATE-WORK
 12952         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 12953         MOVE NUM-WORK           TO DC-GREG-DATE-1-MDY
 12954         MOVE '4'                TO DC-OPTION-CODE
 12955         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12956         IF DATE-CONVERSION-ERROR
 12957             MOVE AL-UABON       TO EFFDTA
 12958             MOVE -1             TO EFFDTL
 12959             MOVE ER-0231        TO EMI-ERROR
 12960             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12961         ELSE
 12962             MOVE AL-UANON       TO EFFDTA
 12963             MOVE DC-GREG-DATE-1-EDIT  TO EFFDTI
 12964             MOVE DC-BIN-DATE-1  TO WS-EFFDT
 12965         END-IF
 12966     ELSE
 12967         MOVE ER-0231            TO EMI-ERROR
 12968         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12969         MOVE -1                 TO EFFDTL
 12970         MOVE AL-UABON           TO EFFDTA
 12971     END-IF.
 12972
 12973     IF ACCOUNTL = ZERO
 12974         MOVE ER-0232            TO EMI-ERROR
 12975         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12976         MOVE AL-UABON           TO ACCOUNTA
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 243
* EL130.cbl
 12977         MOVE -1                 TO ACCOUNTL
 12978     ELSE
 12979         MOVE AL-UANON           TO ACCOUNTA
 12980     END-IF.
 12981
 12982     IF (PI-CERT-ACCESS-CONTROL = ' ' OR '1' OR '2')  AND
 12983        (STATEL = ZERO)
 12984         MOVE ER-0233        TO EMI-ERROR
 12985         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12986         MOVE AL-UABON       TO STATEA
 12987         MOVE -1             TO STATEL
 12988     ELSE
 12989         MOVE AL-UANON       TO STATEA
 12990     END-IF.
 12991
 12992     IF (PI-CERT-ACCESS-CONTROL = '1' OR '2' OR '4') AND
 12993        (CRTCARRL = ZERO)
 12994         MOVE ER-0234        TO EMI-ERROR
 12995         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12996         MOVE AL-UABON       TO CRTCARRA
 12997         MOVE -1             TO CRTCARRL
 12998     ELSE
 12999         MOVE AL-UANON       TO CRTCARRA
 13000     END-IF.
 13001
 13002     IF PI-CERT-ACCESS-CONTROL = '1' AND
 13003        GROUPL = ZERO
 13004         MOVE ER-0235            TO EMI-ERROR
 13005         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13006         MOVE AL-UABON           TO GROUPA
 13007         MOVE -1                 TO GROUPL
 13008     ELSE
 13009         MOVE AL-UANON           TO GROUPA
 13010     END-IF.
 13011
 13012     IF CRTLNMEL = ZERO
 13013         IF LSTNMEI = SPACES OR LOW-VALUES
 13014             MOVE ER-0236            TO  EMI-ERROR
 13015             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13016             MOVE AL-UABON           TO  CRTLNMEA
 13017             MOVE -1                 TO  CRTLNMEL
 13018         ELSE
 13019             MOVE LSTNMEI            TO  CRTLNMEI
 13020             MOVE AL-UANON           TO  CRTLNMEA
 13021         END-IF
 13022     ELSE
 13023         MOVE AL-UANON               TO  CRTLNMEA
 13024     END-IF.
 13025
 13026     IF CRTFNMEL = ZERO
 13027         IF FSTNMEI = SPACES OR LOW-VALUES
 13028*            NEXT SENTENCE
 13029             CONTINUE
 13030         ELSE
 13031             MOVE FSTNMEI            TO  CRTFNMEI
 13032             MOVE AL-UANON           TO  CRTFNMEA
 13033         END-IF
 13034     END-IF.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 244
* EL130.cbl
 13035
 13036     IF CRTINITL = ZERO
 13037         IF INITI = SPACES OR LOW-VALUES
 13038*            NEXT SENTENCE
 13039             CONTINUE
 13040         ELSE
 13041             MOVE INITI              TO  CRTINITI
 13042             MOVE AL-UANON           TO  CRTINITA
 13043         END-IF
 13044     END-IF.
 13045
 13046 6000-EXIT.
 13047     EXIT.
 13048
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 245
* EL130.cbl
 13050 6200-EDIT-CERT-DATA.
 13051     IF ISSAGEL GREATER ZERO
 13052         IF ISSAGEI NOT NUMERIC
 13053             MOVE ER-0237        TO EMI-ERROR
 13054             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13055             MOVE -1             TO ISSAGEL
 13056             MOVE AL-UNBON       TO ISSAGEA
 13057         ELSE
 13058             MOVE AL-UNNON       TO ISSAGEA
 13059         END-IF
 13060     END-IF.
 13061
 13062     IF JNTAGEL GREATER ZERO
 13063         IF JNTAGEI NOT NUMERIC
 13064             MOVE ER-0238        TO EMI-ERROR
 13065             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13066             MOVE -1             TO JNTAGEL
 13067             MOVE AL-UNBON       TO JNTAGEA
 13068         ELSE
 13069             MOVE AL-UNNON       TO JNTAGEA
 13070         END-IF
 13071     END-IF.
 13072
 13073     IF LCVCDL GREATER ZERO
 13074         MOVE LCVCDI             TO WS-EDIT-BEN-CODE
 13075         IF INVALID-BENEFIT-CODE
 13076             MOVE ER-7635        TO EMI-ERROR
 13077             MOVE -1             TO LCVCDL
 13078             MOVE AL-UABON       TO LCVCDA
 13079             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13080         ELSE
 13081             MOVE LCVCDI         TO WS-BEN-HOLD
 13082             MOVE '4'            TO WS-REC-TYPE
 13083             PERFORM 7100-READ-BENEFIT THRU 7199-EXIT
 13084             IF WS-BEN-ALPHA-HOLD = SPACES
 13085                MOVE ER-7635     TO EMI-ERROR
 13086                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13087                MOVE -1          TO LCVCDL
 13088                MOVE AL-UABON    TO LCVCDA
 13089             ELSE
 13090                MOVE WS-BEN-ALPHA-HOLD  TO LCVKINDO
 13091                MOVE WS-EARNINGS-CALC   TO WS-LF-EARNINGS-CALC
 13092                MOVE WS-SPECIAL-CALC-CD TO WS-LF-SPECIAL-CALC-CD
 13093                MOVE AL-UANON           TO LCVCDA
 13094             END-IF
 13095         END-IF
 13096     END-IF.
 13097
 13098     IF ACVCDL GREATER ZERO
 13099         MOVE ACVCDI             TO WS-EDIT-BEN-CODE
 13100         IF INVALID-BENEFIT-CODE
 13101             MOVE ER-7635        TO EMI-ERROR
 13102             MOVE -1             TO ACVCDL
 13103             MOVE AL-UABON       TO ACVCDA
 13104             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13105         ELSE
 13106             MOVE ACVCDI         TO WS-BEN-HOLD
 13107             MOVE '5'            TO WS-REC-TYPE
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 246
* EL130.cbl
 13108             PERFORM 7100-READ-BENEFIT THRU 7199-EXIT
 13109             IF WS-BEN-ALPHA-HOLD = SPACES
 13110                MOVE ER-7635     TO EMI-ERROR
 13111                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13112                MOVE -1          TO ACVCDL
 13113                MOVE AL-UABON    TO ACVCDA
 13114             ELSE
 13115                MOVE WS-BEN-ALPHA-HOLD  TO ACVKINDO
 13116                MOVE WS-EARNINGS-CALC   TO WS-AH-EARNINGS-CALC
 13117                MOVE WS-SPECIAL-CALC-CD TO WS-AH-SPECIAL-CALC-CD
 13118                MOVE AL-UANON           TO ACVCDA
 13119             END-IF
 13120         END-IF
 13121     END-IF.
 13122
 13123     IF LCVOTRML GREATER ZERO
 13124         IF LCVOTRMI NOT NUMERIC
 13125             MOVE ER-7636        TO EMI-ERROR
 13126             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13127             MOVE -1             TO LCVOTRML
 13128             MOVE AL-UNBON       TO LCVOTRMA
 13129         ELSE
 13130             MOVE AL-UNNON       TO LCVOTRMA
 13131         END-IF
 13132     END-IF.
 13133
 13134     IF ACVOTRML GREATER ZERO
 13135         IF ACVOTRMI NOT NUMERIC
 13136             MOVE ER-7636        TO EMI-ERROR
 13137             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13138             MOVE -1             TO ACVOTRML
 13139             MOVE AL-UNBON       TO ACVOTRMA
 13140         ELSE
 13141             MOVE AL-UNNON       TO ACVOTRMA
 13142         END-IF
 13143     END-IF.
 13144
 13145     IF LCVRATEL GREATER ZERO
 13146
 13147* EXEC CICS BIF DEEDIT
 13148*            FIELD    (LCVRATEI)
 13149*            LENGTH   (06)
 13150*        END-EXEC
 13151     MOVE 06
 13152       TO DFHEIV11
 13153*    MOVE '@"L                   #   #00011954' TO DFHEIV0
 13154     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13155     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13156     MOVE X'2020233030303131393534' TO DFHEIV0(25:11)
 13157     CALL 'kxdfhei1' USING DFHEIV0,
 13158           LCVRATEI,
 13159           DFHEIV11
 13160     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13161         IF LCVRATEI NOT NUMERIC
 13162             MOVE AL-UNBON       TO LCVRATEA
 13163             MOVE -1             TO LCVRATEL
 13164             MOVE ER-2280        TO EMI-ERROR
 13165             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 247
* EL130.cbl
 13166         ELSE
 13167             MOVE AL-UNNON       TO LCVRATEA
 13168             MOVE LCVRATEI       TO WS-LCVRATE LCVRATEO
 13169         END-IF
 13170     END-IF.
 13171
 13172     IF ACVRATEL GREATER ZERO
 13173
 13174* EXEC CICS BIF DEEDIT
 13175*            FIELD    (ACVRATEI)
 13176*            LENGTH   (06)
 13177*        END-EXEC
 13178     MOVE 06
 13179       TO DFHEIV11
 13180*    MOVE '@"L                   #   #00011970' TO DFHEIV0
 13181     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13182     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13183     MOVE X'2020233030303131393730' TO DFHEIV0(25:11)
 13184     CALL 'kxdfhei1' USING DFHEIV0,
 13185           ACVRATEI,
 13186           DFHEIV11
 13187     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13188         IF ACVRATEI NOT NUMERIC
 13189             MOVE AL-UNBON       TO ACVRATEA
 13190             MOVE -1             TO ACVRATEL
 13191             MOVE ER-2280        TO EMI-ERROR
 13192             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13193         ELSE
 13194             MOVE AL-UNNON       TO ACVRATEA
 13195             MOVE ACVRATEI       TO WS-ACVRATE ACVRATEO
 13196         END-IF
 13197     END-IF.
 13198
 13199     IF LCVBENEL GREATER ZERO
 13200
 13201* EXEC CICS BIF DEEDIT
 13202*            FIELD    (LCVBENEI)
 13203*            LENGTH   (11)
 13204*        END-EXEC
 13205     MOVE 11
 13206       TO DFHEIV11
 13207*    MOVE '@"L                   #   #00011986' TO DFHEIV0
 13208     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13209     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13210     MOVE X'2020233030303131393836' TO DFHEIV0(25:11)
 13211     CALL 'kxdfhei1' USING DFHEIV0,
 13212           LCVBENEI,
 13213           DFHEIV11
 13214     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13215         IF LCVBENEI NOT NUMERIC
 13216             MOVE AL-UNBON       TO LCVBENEA
 13217             MOVE -1             TO LCVBENEL
 13218             MOVE ER-7637        TO EMI-ERROR
 13219             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13220         ELSE
 13221             MOVE AL-UNNON       TO LCVBENEA
 13222             MOVE LCVBENEI       TO WS-LCVBENE LCVBENEO
 13223         END-IF
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 248
* EL130.cbl
 13224     END-IF.
 13225
 13226     IF ACVBENEL GREATER ZERO
 13227
 13228* EXEC CICS BIF DEEDIT
 13229*            FIELD    (ACVBENEI)
 13230*            LENGTH   (11)
 13231*        END-EXEC
 13232     MOVE 11
 13233       TO DFHEIV11
 13234*    MOVE '@"L                   #   #00012002' TO DFHEIV0
 13235     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13236     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13237     MOVE X'2020233030303132303032' TO DFHEIV0(25:11)
 13238     CALL 'kxdfhei1' USING DFHEIV0,
 13239           ACVBENEI,
 13240           DFHEIV11
 13241     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13242         IF ACVBENEI NOT NUMERIC
 13243             MOVE AL-UNBON       TO ACVBENEA
 13244             MOVE -1             TO ACVBENEL
 13245             MOVE ER-7637        TO EMI-ERROR
 13246             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13247         ELSE
 13248             MOVE AL-UNNON       TO ACVBENEA
 13249             MOVE ACVBENEI       TO WS-ACVBENE ACVBENEO
 13250         END-IF
 13251     END-IF.
 13252
 13253     IF LCVCNDTL GREATER ZERO
 13254         IF LCVCNDTI NOT = SPACES
 13255             MOVE LCVCNDTI        TO DATE-WORK
 13256             PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 13257             MOVE NUM-WORK        TO DC-GREG-DATE-1-MDY
 13258             MOVE '4'             TO DC-OPTION-CODE
 13259             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13260             IF DATE-CONVERSION-ERROR
 13261                 MOVE AL-UABON    TO LCVCNDTA
 13262                 MOVE -1          TO LCVCNDTL
 13263                 MOVE ER-7638     TO EMI-ERROR
 13264                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13265             ELSE
 13266                 MOVE AL-UANON    TO LCVCNDTA
 13267                 MOVE DC-GREG-DATE-1-EDIT TO LCVCNDTI
 13268                 MOVE DC-BIN-DATE-1 TO WS-LCVCNDT
 13269             END-IF
 13270         END-IF
 13271     END-IF.
 13272
 13273     IF ACVCNDTL GREATER ZERO
 13274         IF ACVCNDTI NOT = SPACES
 13275             MOVE ACVCNDTI        TO DATE-WORK
 13276             PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 13277             MOVE NUM-WORK        TO DC-GREG-DATE-1-MDY
 13278             MOVE '4'             TO DC-OPTION-CODE
 13279             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13280             IF DATE-CONVERSION-ERROR
 13281                 MOVE AL-UABON    TO ACVCNDTA
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 249
* EL130.cbl
 13282                 MOVE -1          TO ACVCNDTL
 13283                 MOVE ER-7638     TO EMI-ERROR
 13284                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13285             ELSE
 13286                 MOVE AL-UANON    TO ACVCNDTA
 13287                 MOVE DC-GREG-DATE-1-EDIT TO ACVCNDTI
 13288                 MOVE DC-BIN-DATE-1 TO WS-ACVCNDT
 13289             END-IF
 13290         END-IF
 13291     END-IF.
 13292
 13293     IF ADDONDTL GREATER ZERO
 13294         MOVE ADDONDTI        TO DATE-WORK
 13295         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 13296         MOVE NUM-WORK        TO DC-GREG-DATE-1-MDY
 13297         MOVE '4'             TO DC-OPTION-CODE
 13298         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13299         IF DATE-CONVERSION-ERROR
 13300             MOVE AL-UABON    TO ADDONDTA
 13301             MOVE -1          TO ADDONDTL
 13302             MOVE ER-7651     TO EMI-ERROR
 13303             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13304         ELSE
 13305             MOVE AL-UANON    TO ADDONDTA
 13306             MOVE DC-GREG-DATE-1-EDIT TO ADDONDTI
 13307             MOVE DC-BIN-DATE-1 TO WS-ADD-ON-DT
 13308         END-IF
 13309     END-IF.
 13310
 13311     IF APRL GREATER ZERO
 13312
 13313* EXEC CICS BIF DEEDIT
 13314*            FIELD    (APRI)
 13315*            LENGTH   (8)
 13316*        END-EXEC
 13317     MOVE 8
 13318       TO DFHEIV11
 13319*    MOVE '@"L                   #   #00012076' TO DFHEIV0
 13320     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13321     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13322     MOVE X'2020233030303132303736' TO DFHEIV0(25:11)
 13323     CALL 'kxdfhei1' USING DFHEIV0,
 13324           APRI,
 13325           DFHEIV11
 13326     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13327         IF APRI NOT NUMERIC
 13328             MOVE AL-UNBON       TO APRA
 13329             MOVE -1             TO APRL
 13330             MOVE ER-0248        TO EMI-ERROR
 13331             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13332         ELSE
 13333             MOVE AL-UNNON       TO APRA
 13334             MOVE APRI           TO WS-APR APRO
 13335         END-IF
 13336     END-IF.
 13337
 13338     IF PMTFREQL GREATER ZERO
 13339
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 250
* EL130.cbl
 13340* EXEC CICS BIF DEEDIT
 13341*            FIELD   (PMTFREQI)
 13342*            LENGTH  (2)
 13343*        END-EXEC
 13344     MOVE 2
 13345       TO DFHEIV11
 13346*    MOVE '@"L                   #   #00012092' TO DFHEIV0
 13347     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13348     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13349     MOVE X'2020233030303132303932' TO DFHEIV0(25:11)
 13350     CALL 'kxdfhei1' USING DFHEIV0,
 13351           PMTFREQI,
 13352           DFHEIV11
 13353     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13354         IF PMTFREQI NOT NUMERIC
 13355             MOVE -1             TO PMTFREQL
 13356             MOVE AL-UNBON       TO PMTFREQA
 13357             MOVE ER-0258        TO EMI-ERROR
 13358             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13359         ELSE
 13360             MOVE AL-UNNON       TO PMTFREQA
 13361             MOVE PMTFREQI       TO WS-PMTFREQ  PMTFREQO
 13362         END-IF
 13363     END-IF.
 13364
 13365     IF INDGRPL GREATER ZERO
 13366         IF INDGRPI = 'I' OR 'G'
 13367             MOVE AL-UANON       TO INDGRPA
 13368         ELSE
 13369             MOVE -1 TO INDGRPL
 13370             MOVE AL-UABON       TO INDGRPA
 13371             MOVE ER-0260        TO EMI-ERROR
 13372             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13373         END-IF
 13374     END-IF.
 13375
 13376     IF LOANBALL GREATER ZERO
 13377         MOVE LOANBALI           TO DEEDIT-FIELD
 13378
 13379* EXEC CICS BIF DEEDIT
 13380*            FIELD   (DEEDIT-FIELD)
 13381*            LENGTH  (12)
 13382*        END-EXEC
 13383     MOVE 12
 13384       TO DFHEIV11
 13385*    MOVE '@"L                   #   #00012120' TO DFHEIV0
 13386     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13387     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13388     MOVE X'2020233030303132313230' TO DFHEIV0(25:11)
 13389     CALL 'kxdfhei1' USING DFHEIV0,
 13390           DEEDIT-FIELD,
 13391           DFHEIV11
 13392     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13393         IF DEEDIT-FIELD NOT NUMERIC
 13394             MOVE AL-UNBON       TO LOANBALA
 13395             MOVE -1             TO LOANBALL
 13396             MOVE ER-0247        TO EMI-ERROR
 13397             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 251
* EL130.cbl
 13398         ELSE
 13399             MOVE AL-UNNON       TO LOANBALA
 13400             MOVE DEEDIT-FIELD   TO HOLD-LOAN-BAL  LOANBALO
 13401         END-IF
 13402     END-IF.
 13403
 13404     IF PREMTYPL GREATER ZERO
 13405         IF (PREMTYPI = '1' OR '2' OR '3')
 13406             MOVE AL-UANON       TO PREMTYPA
 13407         ELSE
 13408             MOVE -1             TO PREMTYPL
 13409             MOVE AL-UABON       TO PREMTYPA
 13410             MOVE ER-0227        TO EMI-ERROR
 13411             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13412         END-IF
 13413     END-IF.
 13414
 13415     IF REINCDL GREATER ZERO
 13416         MOVE LOW-VALUES         TO  ERREIN-KEY
 13417         MOVE PI-COMPANY-CD      TO  REIN-COMP-CD
 13418         MOVE REINCDI            TO  REIN-CODE-1
 13419                                     REIN-CODE-2
 13420                                     REIN-CODE-3
 13421         MOVE 'A'                TO  REIN-TYPE
 13422         PERFORM 7992-READ-REIN THRU 7992-EXIT
 13423         IF REIN-REC-NOT-FOUND
 13424             MOVE ER-0266        TO  EMI-ERROR
 13425             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13426             MOVE -1             TO  REINCDL
 13427             MOVE AL-UABON       TO  REINCDA
 13428         ELSE
 13429             MOVE AL-UANON       TO  REINCDA
 13430         END-IF
 13431     END-IF.
 13432
 13433     IF CERTMTI NOT = 'A'
 13434        GO TO 6200-EXIT
 13435     END-IF.
 13436
 13437     IF PREMTYPI = '1'
 13438         IF LCVCDL GREATER ZERO
 13439             IF WS-LF-SPECIAL-CALC-CD = 'O'
 13440                 MOVE ER-0841        TO  EMI-ERROR
 13441                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13442                 MOVE -1             TO  PREMTYPL
 13443                 MOVE AL-UABON       TO  PREMTYPA
 13444             END-IF
 13445         END-IF
 13446     END-IF.
 13447
 13448     IF PREMTYPI = '1'
 13449         IF ACVCDL GREATER ZERO
 13450             IF WS-AH-SPECIAL-CALC-CD = 'O'
 13451                 MOVE ER-0841        TO  EMI-ERROR
 13452                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13453                 MOVE -1             TO  PREMTYPL
 13454                 MOVE AL-UABON       TO  PREMTYPA
 13455             END-IF
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 252
* EL130.cbl
 13456         END-IF
 13457     END-IF.
 13458
 13459     IF PREMTYPI = '2'
 13460         IF LCVCDL GREATER ZERO
 13461             IF (PI-COMPANY-ID = 'HAN') AND
 13462                (WS-LF-SPECIAL-CALC-CD = 'O' OR 'M')
 13463                        OR
 13464                 WS-LF-SPECIAL-CALC-CD = 'O'
 13465*                NEXT SENTENCE
 13466                 CONTINUE
 13467             ELSE
 13468                 MOVE ER-0840        TO  EMI-ERROR
 13469                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13470                 MOVE -1             TO  PREMTYPL
 13471                 MOVE AL-UABON       TO  PREMTYPA
 13472             END-IF
 13473         END-IF
 13474     END-IF.
 13475
 13476     IF PREMTYPI = '2'
 13477         IF ACVCDL GREATER ZERO
 13478             IF (PI-COMPANY-ID = 'HAN')  AND
 13479                (WS-AH-SPECIAL-CALC-CD = 'O' OR 'M')
 13480                        OR
 13481                 WS-AH-SPECIAL-CALC-CD = 'O'
 13482*                NEXT SENTENCE
 13483                 CONTINUE
 13484             ELSE
 13485                 MOVE ER-0840        TO  EMI-ERROR
 13486                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13487                 MOVE -1             TO  PREMTYPL
 13488                 MOVE AL-UABON       TO  PREMTYPA
 13489             END-IF
 13490         END-IF
 13491     END-IF.
 13492
 13493     IF LCVCDL = ZEROS
 13494        GO TO 6200-EXIT
 13495     END-IF.
 13496
 13497     IF PMTFREQL NOT = ZEROS  AND NOT TEX-REG
 13498         IF PMTFREQI NOT = ZEROS
 13499             MOVE ER-0428        TO EMI-ERROR
 13500             MOVE -1             TO PMTFREQL
 13501             MOVE AL-UNBON       TO PMTFREQA
 13502             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13503             GO TO 6200-CHECK-APR
 13504         END-IF
 13505     END-IF.
 13506
 13507     IF PMTFREQL = ZEROS AND TEX-REG
 13508         MOVE ER-0429            TO EMI-ERROR
 13509         MOVE -1                 TO PMTFREQL
 13510         MOVE AL-UNBON           TO PMTFREQA
 13511         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13512         GO TO 6200-CHECK-APR
 13513     END-IF.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 253
* EL130.cbl
 13514
 13515     IF LCVOTRMI NOT NUMERIC
 13516         GO TO 6200-CHECK-APR
 13517     END-IF.
 13518
 13519     IF WS-PMTFREQ NOT = ZERO
 13520         DIVIDE WS-PMTFREQ INTO LCVOTRMI
 13521         GIVING DIVIDE-QUOT
 13522         REMAINDER DIVIDE-REM
 13523         IF DIVIDE-REM GREATER ZERO
 13524             MOVE ER-0430            TO EMI-ERROR
 13525             MOVE -1                 TO PMTFREQL
 13526             MOVE AL-UNBON           TO PMTFREQA
 13527             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13528         END-IF
 13529     END-IF.
 13530
 13531 6200-CHECK-APR.
 13532     IF NET-PAY AND APRL = ZEROS
 13533        MOVE ER-0257             TO EMI-ERROR
 13534        MOVE -1                  TO APRL
 13535        MOVE AL-UABON            TO APRA
 13536        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13537     END-IF.
 13538
 13539 6200-EXIT.
 13540     EXIT.
 13541
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 254
* EL130.cbl
 13543 6300-REQUIRED-CERT-EDIT.
 13544
 13545     IF CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 13546        GO TO 6300-REQUIRED-AH-EDIT
 13547     END-IF
 13548
 13549     IF LCVCDL = ZERO
 13550        MOVE ER-7639             TO EMI-ERROR
 13551        MOVE -1                  TO LCVCDL
 13552        MOVE AL-UABON            TO LCVCDA
 13553        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13554     END-IF.
 13555
 13556     IF LCVOTRML = ZERO
 13557        MOVE ER-7670             TO EMI-ERROR
 13558        MOVE -1                  TO LCVOTRML
 13559        MOVE AL-UNBON            TO LCVOTRMA
 13560        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13561     END-IF.
 13562
 13563     IF LCVBENEL = ZERO
 13564        MOVE ER-7671             TO EMI-ERROR
 13565        MOVE -1                  TO LCVBENEL
 13566        MOVE AL-UNBON            TO LCVBENEA
 13567        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13568     END-IF.
 13569
 13570     GO TO 6399-EXIT.
 13571
 13572 6300-REQUIRED-AH-EDIT.
 13573
 13574     IF ACVCDL = ZERO
 13575        MOVE ER-7639             TO EMI-ERROR
 13576        MOVE -1                  TO ACVCDL
 13577        MOVE AL-UABON            TO ACVCDA
 13578        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13579     END-IF.
 13580
 13581     IF ACVOTRML = ZERO
 13582         MOVE ER-7670             TO EMI-ERROR
 13583         MOVE -1                  TO ACVOTRML
 13584         MOVE AL-UNBON            TO ACVOTRMA
 13585         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13586     END-IF.
 13587
 13588     IF ACVBENEL = ZERO
 13589        MOVE ER-7671             TO EMI-ERROR
 13590        MOVE -1                  TO ACVBENEL
 13591        MOVE AL-UNBON            TO ACVBENEA
 13592        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13593     END-IF.
 13594
 13595 6399-EXIT.
 13596      EXIT.
 13597
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 255
* EL130.cbl
 13599 6400-TEST-CLAIM-REASONABILITY.
 13600
 13601     IF WS-INCUR = LOW-VALUES
 13602        GO TO 6499-EXIT
 13603     END-IF.
 13604
 13605     IF WS-EFFDT NOT = LOW-VALUES
 13606         IF WS-INCUR LESS WS-EFFDT
 13607             MOVE ER-0458          TO EMI-ERROR
 13608             MOVE -1               TO INCURL
 13609             MOVE AL-UABON         TO INCURA
 13610             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13611         END-IF
 13612     END-IF.
 13613
 13614     IF CERTMTI = 'A'
 13615        GO TO 6460-TEST-NEW-CERT
 13616     END-IF.
 13617
 13618     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
 13619     MOVE CRTCARRI               TO CERT-CARRIER.
 13620     MOVE GROUPI                 TO CERT-GROUPING.
 13621     MOVE STATEI                 TO CERT-STATE.
 13622     MOVE PI-SAVE-ACCOUNT        TO CERT-ACCOUNT.
 13623     MOVE PI-SAVE-CERT           TO CERT-CERT-NO.
 13624     MOVE PI-SAVE-EFFDT          TO CERT-EFF-DT.
 13625
 13626
 13627
 13628* EXEC CICS HANDLE CONDITION
 13629*         DUPKEY   (6499-EXIT)
 13630*         NOTFND   (6499-EXIT)
 13631*    END-EXEC.
 13632*    MOVE '"$$I                  ! B #00012358' TO DFHEIV0
 13633     MOVE X'222424492020202020202020' TO DFHEIV0(1:12)
 13634     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13635     MOVE X'4220233030303132333538' TO DFHEIV0(25:11)
 13636     CALL 'kxdfhei1' USING DFHEIV0
 13637     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13638
 13639
 13640     PERFORM 7940-READ-CERT THRU 7940-EXIT.
 13641
 13642     IF (CLMTYPEI = PI-AH-OVERRIDE-L1  OR
 13643        'I' OR 'G')
 13644        MOVE CM-AH-ORIG-TERM     TO DC-ELAPSED-MONTHS
 13645     ELSE
 13646        MOVE CM-LF-ORIG-TERM     TO DC-ELAPSED-MONTHS
 13647     END-IF.
 13648
 13649     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1.
 13650     MOVE '6'                    TO DC-OPTION-CODE.
 13651     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13652
 13653     IF WS-INCUR GREATER THAN DC-BIN-DATE-2
 13654        MOVE ER-0519             TO EMI-ERROR
 13655        MOVE -1                  TO INCURL
 13656        MOVE AL-UABON            TO INCURA
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 256
* EL130.cbl
 13657        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13658     END-IF.
 13659
 13660     IF CLMCARRI NOT = CRTCARRI
 13661        MOVE ER-0562             TO EMI-ERROR
 13662        MOVE AL-UABON            TO CLMCARRA
 13663        MOVE -1                  TO CLMCARRL
 13664        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13665     END-IF.
 13666
 13667     IF ((CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G') AND
 13668        CM-AH-BENEFIT-CD = '00')
 13669                  OR
 13670        (CLMTYPEI = PI-LIFE-OVERRIDE-L1 AND
 13671        CM-LF-BENEFIT-CD = '00')
 13672         MOVE ER-0521         TO EMI-ERROR
 13673         MOVE AL-UABON        TO CLMTYPEA
 13674         MOVE -1              TO CLMTYPEL
 13675         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13676     END-IF.
 13677*    IF CLMTYPEI = 'I' AND
 13678*       CM-AH-CRITICAL-PERIOD = +0
 13679*        MOVE ER-0521         TO EMI-ERROR
 13680*        MOVE AL-UABON        TO CLMTYPEA
 13681*        MOVE -1              TO CLMTYPEL
 13682*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13683*    END-IF
 13684
 13685*    IF PI-COMPANY-ID = 'CRI'
 13686*        IF MAINTI = 'A'
 13687*            IF CERT-PEND-ISSUE-ERROR  OR
 13688*               CERT-PEND-ISSUE-RETURNED
 13689*                MOVE -1                 TO CERTNOL
 13690*                MOVE AL-UABON           TO CERTNOA
 13691*                MOVE ER-7640            TO EMI-ERROR
 13692*                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13693*            END-IF
 13694*        END-IF
 13695*    END-IF.
 13696
 13697     IF (CM-AH-CANCEL-DT  NOT  =  LOW-VALUES AND
 13698         (CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'))
 13699         IF WS-INCUR GREATER THAN CM-AH-CANCEL-DT
 13700             GO TO 6450-DATE-ERROR
 13701         END-IF
 13702     END-IF.
 13703
 13704     IF (CM-LF-CANCEL-DT  NOT  =  LOW-VALUES AND
 13705         CLMTYPEI = PI-LIFE-OVERRIDE-L1)
 13706         IF WS-INCUR GREATER THAN CM-LF-CANCEL-DT
 13707             GO TO 6450-DATE-ERROR
 13708         END-IF
 13709     END-IF.
 13710
 13711     IF CM-LF-DEATH-DT NOT = LOW-VALUES
 13712         IF WS-INCUR GREATER THAN CM-LF-DEATH-DT
 13713             GO TO 6450-DATE-ERROR
 13714         END-IF
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 257
* EL130.cbl
 13715     END-IF.
 13716
 13717     GO TO 6499-EXIT.
 13718
 13719 6450-DATE-ERROR.
 13720     MOVE ER-0520                TO EMI-ERROR.
 13721     MOVE -1                     TO INCURL.
 13722     MOVE AL-UABON               TO INCURA.
 13723     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13724
 13725*    IF (PI-COMPANY-ID = 'FIM' OR 'LGX') AND
 13726*       (EMI-SEVERITY-SAVE = 'X')
 13727*        ADD 1                TO EMI-FORCABLE-CTR
 13728*        SUBTRACT 1 FROM EMI-FATAL-CTR
 13729*    END-IF.
 13730
 13731     GO TO 6499-EXIT.
 13732
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 258
* EL130.cbl
 13734 6460-TEST-NEW-CERT.
 13735
 13736     IF NOT EMI-NO-ERRORS
 13737        GO TO 6499-EXIT
 13738     END-IF.
 13739
 13740     MOVE ZEROS                  TO DC-ELAPSED-MONTHS.
 13741
 13742     IF ((CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G') AND
 13743         ACVOTRML GREATER ZERO)
 13744        MOVE ACVOTRMI       TO DC-ELAPSED-MONTHS
 13745     END-IF.
 13746
 13747     IF CLMTYPEI = PI-LIFE-OVERRIDE-L1 AND
 13748         LCVOTRML GREATER ZERO
 13749        MOVE LCVOTRMI       TO DC-ELAPSED-MONTHS
 13750     END-IF.
 13751
 13752     MOVE WS-EFFDT               TO DC-BIN-DATE-1.
 13753
 13754*    IF PI-COMPANY-ID = 'HAN'
 13755*        IF ADDONDTL GREATER ZERO
 13756*            MOVE WS-ADD-ON-DT   TO  DC-BIN-DATE-1
 13757*            IF CLMTYPEI = 'A'
 13758*                IF ACVOTRMI NOT = ZEROS
 13759*                    COMPUTE DC-ELAPSED-MONTHS = (ACVOTRMI - 1)
 13760*                ELSE
 13761*                    NEXT SENTENCE
 13762*                    CONTINUE
 13763*                END-IF
 13764*            ELSE
 13765*                IF LCVOTRMI NOT = ZEROS
 13766*                    COMPUTE DC-ELAPSED-MONTHS = (LCVOTRMI - 1)
 13767*                END-IF
 13768*            END-IF
 13769*        END-IF
 13770*    END-IF.
 13771
 13772     MOVE '6'                    TO DC-OPTION-CODE.
 13773     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13774
 13775     IF NO-CONVERSION-ERROR
 13776         MOVE DC-BIN-DATE-2      TO WS-EXPIRE
 13777     END-IF.
 13778
 13779     IF WS-INCUR GREATER THAN WS-EXPIRE
 13780        MOVE ER-0519             TO EMI-ERROR
 13781        MOVE -1                  TO INCURL
 13782        MOVE AL-UABON            TO INCURA
 13783        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13784     END-IF.
 13785
 13786     IF CLMCARRI NOT = CRTCARRI
 13787        MOVE ER-0562             TO EMI-ERROR
 13788        MOVE AL-UABON            TO CLMCARRA
 13789        MOVE -1                  TO CLMCARRL
 13790        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13791     END-IF.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 259
* EL130.cbl
 13792
 13793     IF ((CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G') AND
 13794         ACVCDL = ZEROS)
 13795             MOVE ER-0521        TO EMI-ERROR
 13796             MOVE AL-UABON       TO CLMTYPEA
 13797             MOVE -1             TO CLMTYPEL
 13798             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13799     END-IF.
 13800
 13801     IF CLMTYPEI = PI-LIFE-OVERRIDE-L1 AND
 13802         LCVCDL = ZEROS
 13803             MOVE ER-0521        TO EMI-ERROR
 13804             MOVE AL-UABON       TO CLMTYPEA
 13805             MOVE -1             TO CLMTYPEL
 13806             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13807     END-IF.
 13808
 13809     IF CLMTYPEI = PI-LIFE-OVERRIDE-L1
 13810         IF LCVCNDTL GREATER ZERO
 13811             IF WS-INCUR GREATER THAN WS-LCVCNDT
 13812                 GO TO 6450-DATE-ERROR
 13813             END-IF
 13814         END-IF
 13815     END-IF.
 13816
 13817     IF CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 13818         IF ACVCNDTL GREATER ZERO
 13819             IF WS-INCUR GREATER THAN WS-ACVCNDT
 13820                 GO TO 6450-DATE-ERROR
 13821             END-IF
 13822         END-IF
 13823     END-IF.
 13824
 13825 6499-EXIT.
 13826     EXIT.
 13827 6500-get-acct.
 13828
 13829     MOVE SPACES                 TO ERACCT-KEY
 13830                                    ws-dcc-product-code
 13831
 13832     IF CARR-GROUP-ST-ACCNT-CNTL
 13833        MOVE PI-COMPANY-CD       TO ACCT-COMP-CD
 13834        MOVE CRTCARRI            TO ACCT-CARRIER
 13835        MOVE GROUPI              TO ACCT-GROUPING
 13836        MOVE STATEI              TO ACCT-STATE
 13837        MOVE ACCOUNTI            TO ACCT-ACCOUNT
 13838        GO TO 6500-startbr
 13839     END-IF
 13840
 13841     MOVE PI-COMPANY-CD          TO ACCT-COMP-CD
 13842     MOVE ACCOUNTI               TO ACCT-ACCOUNT
 13843
 13844     IF PI-CERT-ACCESS-CONTROL = ' ' OR '2'
 13845        MOVE STATEI             TO ACCT-STATE
 13846     END-IF
 13847
 13848     IF PI-CERT-ACCESS-CONTROL = '2' OR '4'
 13849        MOVE CRTCARRI           TO ACCT-CARRIER
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 260
* EL130.cbl
 13850     END-IF
 13851
 13852     .
 13853 6500-startbr.
 13854
 13855     MOVE ERACCT-KEY             TO SAVE-ERACCT-KEY
 13856
 13857
 13858* EXEC CICS STARTBR
 13859*       DATASET     (ERACCT2-DSID)
 13860*       RIDFLD      (SAVE-ERACCT-KEY)
 13861*       GENERIC
 13862*       KEYLENGTH   (20)
 13863*       resp        (ws-response)
 13864*    END-EXEC
 13865     MOVE 20
 13866       TO DFHEIV11
 13867     MOVE 0
 13868       TO DFHEIV12
 13869*    MOVE '&,   KG    G          &  N#00012580' TO DFHEIV0
 13870     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
 13871     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13872     MOVE X'204E233030303132353830' TO DFHEIV0(25:11)
 13873     CALL 'kxdfhei1' USING DFHEIV0,
 13874           ERACCT2-DSID,
 13875           SAVE-ERACCT-KEY,
 13876           DFHEIV11,
 13877           DFHEIV12,
 13878           DFHEIV99
 13879     MOVE EIBRESP  TO ws-response
 13880     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13881
 13882     if not ws-resp-normal
 13883        go to 6500-exit
 13884     end-if
 13885
 13886     .
 13887 6500-readnext.
 13888
 13889
 13890* EXEC CICS READNEXT
 13891*       DATASET   (ERACCT2-DSID)
 13892*       SET       (ADDRESS OF ACCOUNT-MASTER)
 13893*       RIDFLD    (SAVE-ERACCT-KEY)
 13894*    END-EXEC
 13895     MOVE 0
 13896       TO DFHEIV11
 13897*    MOVE '&.S                   )   #00012595' TO DFHEIV0
 13898     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 13899     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 13900     MOVE X'2020233030303132353935' TO DFHEIV0(25:11)
 13901     CALL 'kxdfhei1' USING DFHEIV0,
 13902           ERACCT2-DSID,
 13903           DFHEIV20,
 13904           DFHEIV99,
 13905           SAVE-ERACCT-KEY,
 13906           DFHEIV99,
 13907           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 261
* EL130.cbl
 13908           DFHEIV99,
 13909           DFHEIV99
 13910     SET ADDRESS OF ACCOUNT-MASTER TO
 13911         DFHEIV20
 13912     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13913
 13914     IF (ACCT-COMP-CD  NOT = AM-COMPANY-CD-A1)
 13915        or (ACCT-CARRIER  NOT = AM-VG-CARRIER )
 13916        or (ACCT-GROUPING NOT = AM-VG-GROUPING)
 13917        or (ACCT-STATE    NOT = AM-VG-STATE   )
 13918        or (ACCT-ACCOUNT  NOT = AM-VG-ACCOUNT )
 13919        go to 6500-endbr
 13920     END-IF
 13921
 13922     IF (WS-EFFDT >= AM-EFFECTIVE-DT)
 13923        and (WS-EFFDT < AM-EXPIRATION-DT)
 13924        MOVE AM-dcc-product-code to ws-dcc-product-code
 13925        GO TO 6500-endbr
 13926     END-IF
 13927
 13928     IF WS-EFFDT >= AM-EXPIRATION-DT
 13929         GO TO 6500-readnext
 13930     END-IF
 13931
 13932     .
 13933 6500-endbr.
 13934
 13935
 13936* EXEC CICS ENDBR
 13937*        DATASET    (ERACCT2-DSID)
 13938*    END-EXEC
 13939     MOVE 0
 13940       TO DFHEIV11
 13941*    MOVE '&2                    $   #00012622' TO DFHEIV0
 13942     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 13943     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13944     MOVE X'2020233030303132363232' TO DFHEIV0(25:11)
 13945     CALL 'kxdfhei1' USING DFHEIV0,
 13946           ERACCT2-DSID,
 13947           DFHEIV11,
 13948           DFHEIV99
 13949     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13950
 13951     .
 13952 6500-exit.
 13953     exit.
 13954 6600-CHECK-AUTO-ACTIVITY.
 13955
 13956
 13957* EXEC CICS HANDLE CONDITION
 13958*        NOTFND   (6600-NOT-FOUND)
 13959*    END-EXEC.
 13960*    MOVE '"$I                   ! C #00012631' TO DFHEIV0
 13961     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13962     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13963     MOVE X'4320233030303132363331' TO DFHEIV0(25:11)
 13964     CALL 'kxdfhei1' USING DFHEIV0
 13965     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 262
* EL130.cbl
 13966
 13967
 13968     MOVE PI-COMPANY-ID              TO  CNTL-COMP-ID.
 13969     MOVE 'T'                        TO  CNTL-REC-TYPE.
 13970     MOVE SPACES                     TO  CNTL-ACCESS.
 13971     MOVE +0                         TO  CNTL-SEQ-NO.
 13972
 13973     PERFORM 7970-READ-CNTL THRU 7970-EXIT.
 13974
 13975     IF CF-SYS-ACTIVE-SW (1) = 'N' OR ' '
 13976         MOVE 'N'                    TO  WS-REC-FOUND-SW
 13977                                         WS-LETTER-SW
 13978         GO TO 6600-EXIT
 13979     END-IF.
 13980
 13981     IF CF-SYS-LETTER-ID (1) = SPACES OR LOW-VALUES
 13982         MOVE 'N'                     TO  WS-LETTER-SW
 13983     ELSE
 13984         MOVE 'Y'                     TO  WS-LETTER-SW
 13985     END-IF.
 13986
 13987     MOVE 'Y'                         TO  WS-REC-FOUND-SW.
 13988     GO TO 6600-EXIT.
 13989
 13990 6600-START-AUTO-LETTER-WRITER.
 13991
 13992     MOVE LOW-VALUES                  TO  W-1523-LINKDATA.
 13993     MOVE PROGRAM-INTERFACE-BLOCK     TO  W-1523-COMMON-PI-DATA.
 13994
 13995     MOVE CF-SYS-LETTER-ID (1)        TO  W-1523-FORM-NUMBER.
 13996
 13997     IF CF-SYS-RESEND-DAYS (1) NOT = ZEROS
 13998         MOVE SAVE-BIN-DATE           TO  DC-BIN-DATE-1
 13999         MOVE '6'                     TO  DC-OPTION-CODE
 14000         MOVE CF-SYS-RESEND-DAYS (1)  TO  DC-ELAPSED-DAYS
 14001         MOVE +0                      TO  DC-ELAPSED-MONTHS
 14002         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14003         IF NO-CONVERSION-ERROR
 14004             MOVE DC-BIN-DATE-2       TO  W-1523-RESEND-DATE
 14005         ELSE
 14006             MOVE LOW-VALUES          TO  W-1523-RESEND-DATE
 14007         END-IF
 14008     END-IF.
 14009
 14010     IF CF-SYS-FOLLOW-UP-DAYS (1) NOT = ZEROS
 14011         MOVE SAVE-BIN-DATE           TO  DC-BIN-DATE-1
 14012         MOVE '6'                     TO  DC-OPTION-CODE
 14013         MOVE CF-SYS-FOLLOW-UP-DAYS (1)   TO  DC-ELAPSED-DAYS
 14014         MOVE +0                      TO  DC-ELAPSED-MONTHS
 14015         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14016         IF NO-CONVERSION-ERROR
 14017             MOVE DC-BIN-DATE-2       TO  W-1523-FOLLOW-UP-DATE
 14018         ELSE
 14019             MOVE LOW-VALUES          TO  W-1523-FOLLOW-UP-DATE
 14020         END-IF
 14021     END-IF.
 14022
 14023
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 263
* EL130.cbl
 14024
 14025* EXEC CICS LINK
 14026*        PROGRAM    (LINK-1523)
 14027*        COMMAREA   (W-1523-LINKDATA)
 14028*        LENGTH     (W-1523-COMM-LENGTH)
 14029*    END-EXEC.
 14030*    MOVE '."C                   (   #00012691' TO DFHEIV0
 14031     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14032     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14033     MOVE X'2020233030303132363931' TO DFHEIV0(25:11)
 14034     CALL 'kxdfhei1' USING DFHEIV0,
 14035           LINK-1523,
 14036           W-1523-LINKDATA,
 14037           W-1523-COMM-LENGTH,
 14038           DFHEIV99,
 14039           DFHEIV99,
 14040           DFHEIV99,
 14041           DFHEIV99
 14042     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14043
 14044
 14045     GO TO 6600-EXIT.
 14046
 14047 6600-NOT-FOUND.
 14048     MOVE 'N'                         TO  WS-REC-FOUND-SW.
 14049
 14050 6600-EXIT.
 14051     EXIT.
 14052
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 264
* EL130.cbl
 14053/
 14054*************************************************************
 14055*****        START OF ACTIVITY FILE OUTPUT PROCESSING      **
 14056*************************************************************
 14057
 14058 6700-OUTPUT-ACTIVITY-RECORD.
 14059
 14060
 14061
 14062* EXEC CICS GETMAIN
 14063*        SET (ADDRESS OF DAILY-ACTIVITY-RECORD)
 14064*        LENGTH (DLYACTV-LENGTH)
 14065*        INITIMG (WS-BLANK)
 14066*    END-EXEC.
 14067*    MOVE ',"IL                  $   #00012713' TO DFHEIV0
 14068     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 14069     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14070     MOVE X'2020233030303132373133' TO DFHEIV0(25:11)
 14071     CALL 'kxdfhei1' USING DFHEIV0,
 14072           DFHEIV20,
 14073           DLYACTV-LENGTH,
 14074           WS-BLANK
 14075     SET ADDRESS OF DAILY-ACTIVITY-RECORD TO
 14076         DFHEIV20
 14077     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14078
 14079
 14080     MOVE SPACES                 TO DAILY-ACTIVITY-RECORD.
 14081     MOVE PI-COMPANY-CD          TO DA-COMP-CD.
 14082     MOVE CLMCARRI               TO DA-CARRIER.
 14083     IF CLMNOL EQUAL ZERO
 14084         MOVE WS-CLAIM-NUMBER    TO DA-CLAIM-NO
 14085     ELSE
 14086         MOVE CLMNOI             TO DA-CLAIM-NO
 14087     END-IF.
 14088     MOVE CERTNOI                TO DA-CERT-PRIME.
 14089     MOVE SUFXI                  TO DA-CERT-SFX.
 14090     MOVE +0                     TO DA-TRAILER-SEQ-NO.
 14091     MOVE 'A'                    TO DA-RECORD-TYPE.
 14092
 14093
 14094* EXEC CICS HANDLE CONDITION
 14095*        NOTOPEN (6700-NOTOPEN-ERROR)
 14096*        DUPREC (6700-EXIT)
 14097*    END-EXEC.
 14098*    MOVE '"$J%                  ! D #00012732' TO DFHEIV0
 14099     MOVE X'22244A252020202020202020' TO DFHEIV0(1:12)
 14100     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14101     MOVE X'4420233030303132373332' TO DFHEIV0(25:11)
 14102     CALL 'kxdfhei1' USING DFHEIV0
 14103     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14104
 14105
 14106
 14107* EXEC CICS WRITE
 14108*        DATASET (DLYACTV-DSID)
 14109*        RIDFLD (DA-KEY)
 14110*        FROM (DAILY-ACTIVITY-RECORD)
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 265
* EL130.cbl
 14111*        LENGTH (DLYACTV-LENGTH)
 14112*    END-EXEC.
 14113*    MOVE '&$ L                  ''   #00012737' TO DFHEIV0
 14114     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 14115     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14116     MOVE X'2020233030303132373337' TO DFHEIV0(25:11)
 14117     CALL 'kxdfhei1' USING DFHEIV0,
 14118           DLYACTV-DSID,
 14119           DAILY-ACTIVITY-RECORD,
 14120           DLYACTV-LENGTH,
 14121           DA-KEY,
 14122           DFHEIV99,
 14123           DFHEIV99
 14124     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14125
 14126     GO TO 6700-EXIT.
 14127
 14128 6700-NOTOPEN-ERROR.
 14129     MOVE '2955'                 TO EMI-ERROR.
 14130     MOVE -1                     TO MAINTL.
 14131     MOVE AL-UANON               TO MAINTA.
 14132     PERFORM 9900-ERROR-FORMAT THRU
 14133             9900-EXIT.
 14134     GO TO 8200-SEND-DATAONLY.
 14135
 14136 6700-EXIT.
 14137     EXIT.
 14138
 14139*************************************************************
 14140*****         END OF ACTIVITY FILE OUTPUT PROCESSING        *
 14141*************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 266
* EL130.cbl
 14142/
 14143 6990-DEEDIT-DATE.
 14144
 14145
 14146* EXEC CICS BIF DEEDIT
 14147*        FIELD   (DATE-WORK)
 14148*        LENGTH  (8)
 14149*    END-EXEC.
 14150     MOVE 8
 14151       TO DFHEIV11
 14152*    MOVE '@"L                   #   #00012762' TO DFHEIV0
 14153     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 14154     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14155     MOVE X'2020233030303132373632' TO DFHEIV0(25:11)
 14156     CALL 'kxdfhei1' USING DFHEIV0,
 14157           DATE-WORK,
 14158           DFHEIV11
 14159     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14160
 14161 6990-EXIT.
 14162     EXIT.
 14163
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 267
* EL130.cbl
 14165 7000-BUILD-OUTPUT-MAP.
 14166
 14167     IF CLAIM-SWITCH = 'N'
 14168         GO TO 7050-BUILD-MAP-CERT-DATA
 14169     END-IF.
 14170
 14171     IF CL-ASSOC-CERT-TOTAL = +0 OR +1
 14172         MOVE SPACES                 TO SEQUO
 14173         MOVE AL-SABOF               TO SEQUA
 14174     ELSE
 14175         MOVE CL-ASSOC-CERT-SEQU     TO WS-CURRENT-SEQU
 14176         MOVE CL-ASSOC-CERT-TOTAL    TO WS-OF-SEQU
 14177         MOVE WS-CLAIM-SEQU          TO SEQUO
 14178         MOVE AL-SABON               TO SEQUA
 14179     END-IF.
 14180
 14181     MOVE CL-CARRIER             TO CLMCARRO.
 14182     MOVE CL-CLAIM-TYPE          TO CLMTYPEO.
 14183     MOVE CL-PRIME-CERT-PRIME    TO PCERTNOO.
 14184     MOVE CL-PRIME-CERT-SFX      TO PSUFXO.
 14185     MOVE CL-INSURED-LAST-NAME   TO LSTNMEO.
 14186     MOVE CL-INSURED-1ST-NAME    TO FSTNMEO.
 14187     MOVE CL-INSURED-MID-INIT    TO INITO.
 14188     MOVE CL-INSURED-SEX-CD      TO SEXO.
 14189     MOVE CL-INSURED-OCC-CD      TO OCCCDO.
 14190
 14191     MOVE AL-UANON               TO CLMCARRA
 14192                                    CLMTYPEA
 14193                                    PCERTNOA
 14194                                    PSUFXA
 14195                                    LSTNMEA
 14196                                    FSTNMEA
 14197                                    INITA
 14198                                    SEXA
 14199                                    OCCCDA.
 14200
 14201     MOVE CL-PRIME-CERT-NO       TO PI-PRIMARY-CERT-NO.
 14202
 14203     IF CL-INSURED-BIRTH-DT NOT = LOW-VALUES
 14204         MOVE ' '                 TO DC-OPTION-CODE
 14205         MOVE CL-INSURED-BIRTH-DT TO DC-BIN-DATE-1
 14206         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14207         IF NOT DATE-CONVERSION-ERROR
 14208             MOVE DC-GREG-DATE-1-EDIT TO BIRTHDTO
 14209             MOVE AL-UANON            TO BIRTHDTA
 14210         END-IF
 14211     END-IF.
 14212
 14213     MOVE CL-SOC-SEC-NO          TO SSNO.
 14214     MOVE AL-UANON               TO SSNA.
 14215
 14216     IF CL-INCURRED-DT NOT = LOW-VALUES
 14217         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 14218         MOVE ' '                TO DC-OPTION-CODE
 14219         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14220         IF NOT DATE-CONVERSION-ERROR
 14221             MOVE DC-GREG-DATE-1-EDIT TO INCURO
 14222             MOVE AL-UANON            TO INCURA
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 268
* EL130.cbl
 14223         END-IF
 14224     END-IF.
 14225
 14226     IF CL-REPORTED-DT NOT = LOW-VALUES
 14227         MOVE ' '                TO DC-OPTION-CODE
 14228         MOVE CL-REPORTED-DT     TO DC-BIN-DATE-1
 14229         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14230         IF NOT DATE-CONVERSION-ERROR
 14231             MOVE DC-GREG-DATE-1-EDIT TO REPORTO
 14232             MOVE AL-UANON            TO REPORTA
 14233         END-IF
 14234     END-IF.
 14235
 14236     IF CL-EST-END-OF-DISAB-DT NOT = LOW-VALUES
 14237         MOVE ' '                 TO DC-OPTION-CODE
 14238         MOVE CL-EST-END-OF-DISAB-DT TO DC-BIN-DATE-1
 14239         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14240         IF NOT DATE-CONVERSION-ERROR
 14241             MOVE DC-GREG-DATE-1-EDIT TO ESTENDO
 14242             MOVE AL-UANON            TO ESTENDA
 14243         END-IF
 14244     END-IF.
 14245
 14246     MOVE WS-DIAGNOSIS-DESCRIPT  TO DIAGO.
 14247     MOVE CL-CAUSE-CD            TO CAUSEO.
 14248     MOVE AT-CURRENT-MANUAL-RESERVE TO MANRSVO.
 14249     MOVE CL-RELATED-CLAIM-NO    TO RELCLMO.
 14250     MOVE CL-PROCESSOR-ID        TO PROCCDO.
 14251     MOVE CL-PRIORITY-CD         TO PRICDO.
 14252     MOVE AL-UANON               TO DIAGA
 14253                                    CAUSEA
 14254                                    RELCLMA
 14255                                    PROCCDA
 14256                                    PRICDA.
 14257     MOVE AL-UNNON               TO MANRSVA.
 14258
 14259*    IF PI-COMPANY-ID  = 'ACC'  OR  'FDL' OR 'LGX'
 14260*        MOVE CL-PRODUCT-CD          TO PRODCDO
 14261*        MOVE AL-UANON               TO PRODCDA
 14262*    END-IF.
 14263
 14264     MOVE CL-SUPV-ATTN-CD        TO SUPVO.
 14265     MOVE CL-FILE-LOCATION       TO FILETOO.
 14266     MOVE CL-BENEFICIARY         TO BENECDO.
 14267     MOVE AL-UANON               TO SUPVA
 14268                                    FILETOA
 14269                                    BENECDA.
 14270
 14271     IF CLAIM-SWITCH = 'X'
 14272         GO TO 7099-EXIT
 14273     END-IF.
 14274
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 269
* EL130.cbl
 14276 7050-BUILD-MAP-CERT-DATA.
 14277     MOVE CM-CERT-PRIME          TO CERTNOO.
 14278     MOVE CM-CERT-SFX            TO SUFXO.
 14279     MOVE AL-SANON               TO CERTNOA
 14280                                    SUFXA.
 14281
 14282     IF CM-CERT-EFF-DT NOT = LOW-VALUES
 14283         MOVE CM-CERT-EFF-DT     TO DC-BIN-DATE-1
 14284         MOVE ' '                TO DC-OPTION-CODE
 14285         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14286         IF NOT DATE-CONVERSION-ERROR
 14287             MOVE DC-GREG-DATE-1-EDIT TO EFFDTO
 14288         END-IF
 14289     END-IF.
 14290
 14291     MOVE CM-ACCOUNT             TO ACCOUNTO.
 14292     MOVE CM-STATE               TO STATEO.
 14293     MOVE CM-CARRIER             TO CRTCARRO.
 14294     MOVE CM-GROUPING            TO GROUPO.
 14295     MOVE CM-INSURED-LAST-NAME   TO CRTLNMEO.
 14296     MOVE CM-INSURED-FIRST-NAME  TO CRTFNMEO.
 14297     MOVE CM-INSURED-INITIAL2    TO CRTINITO.
 14298     MOVE CM-INSURED-ISSUE-AGE   TO ISSAGEO.
 14299     MOVE CM-JT-LAST-NAME        TO JNTLNMEO.
 14300     MOVE CM-JT-FIRST-NAME       TO JNTFNMEO.
 14301     MOVE CM-JT-INITIAL          TO JNTINITO.
 14302     MOVE CM-INSURED-JOINT-AGE   TO JNTAGEO.
 14303     MOVE AL-UANON               TO ACCOUNTA
 14304                                    STATEA
 14305                                    CRTCARRA
 14306                                    GROUPA
 14307                                    CRTLNMEA
 14308                                    CRTFNMEA
 14309                                    CRTINITA
 14310                                    JNTLNMEA
 14311                                    JNTFNMEA
 14312                                    JNTINITA.
 14313     MOVE AL-UNNON               TO ISSAGEA
 14314                                    JNTAGEA.
 14315
 14316     IF CM-SSN-STATE   = CM-STATE AND
 14317        CM-SSN-ACCOUNT = CM-ACCOUNT-PRIME
 14318*        NEXT SENTENCE
 14319         CONTINUE
 14320     ELSE
 14321         MOVE CM-SOC-SEC-NO      TO CRTSSNO
 14322     END-IF.
 14323
 14324     MOVE AL-UANON               TO CRTSSNA.
 14325
 14326     MOVE SAVE-DATE              TO DC-GREG-DATE-1-EDIT.
 14327     MOVE '2'                    TO DC-OPTION-CODE.
 14328     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14329     MOVE DC-BIN-DATE-1          TO SAVE-CURRENT-DATE.
 14330
 14331*** READ STATE MASTER RECORD FOR FREE LOOK PERIOD ***
 14332     MOVE SPACES                 TO ELCNTL-KEY.
 14333     MOVE CM-STATE               TO CNTL-ACCESS.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 270
* EL130.cbl
 14334     MOVE '3'                    TO CNTL-REC-TYPE.
 14335     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 14336     MOVE ZEROS                  TO CNTL-SEQ-NO.
 14337
 14338
 14339
 14340* EXEC CICS READ
 14341*        DATASET  (ELCNTL-DSID)
 14342*        SET      (ADDRESS OF CONTROL-FILE)
 14343*        RIDFLD   (ELCNTL-KEY)
 14344*        RESP     (WS-RESPONSE)
 14345*    END-EXEC.
 14346*    MOVE '&"S        E          (  N#00012944' TO DFHEIV0
 14347     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14348     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14349     MOVE X'204E233030303132393434' TO DFHEIV0(25:11)
 14350     CALL 'kxdfhei1' USING DFHEIV0,
 14351           ELCNTL-DSID,
 14352           DFHEIV20,
 14353           DFHEIV99,
 14354           ELCNTL-KEY,
 14355           DFHEIV99,
 14356           DFHEIV99,
 14357           DFHEIV99
 14358     SET ADDRESS OF CONTROL-FILE TO
 14359         DFHEIV20
 14360     MOVE EIBRESP  TO WS-RESPONSE
 14361     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14362
 14363
 14364     IF WS-RESP-NOTFND
 14365          MOVE ER-2848           TO EMI-ERROR
 14366          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14367          GO TO 8100-SEND-INITIAL-MAP
 14368     END-IF.
 14369
 14370     MOVE CF-ST-FREE-LOOK-PERIOD TO CP-FREE-LOOK.
 14371     MOVE CF-ST-VFY-2ND-BENE TO PI-ST-VFY-2ND-BENE.
 14372     MOVE CF-ST-CAUSAL-STATE TO PI-ST-CAUSAL-STATE.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 271
* EL130.cbl
 14374     IF CM-LF-BENEFIT-CD = '00'
 14375         MOVE ZEROS              TO LCVOTRMO
 14376                                    LCVRTRMO
 14377                                    LCVRATEO
 14378                                    LCVBENEO
 14379         MOVE SPACES             TO LCVDSCRO
 14380                                    LCVCDO
 14381                                    LCVKINDO
 14382                                    LCVFORMO
 14383                                    LCVCNDTO
 14384                                    LCVEXITO
 14385                                    LCVSTATO
 14386         IF CLMTYPEL GREATER THAN ZERO AND
 14387            CLMTYPEI = PI-LIFE-OVERRIDE-L1
 14388                MOVE ER-0521     TO EMI-ERROR
 14389                MOVE AL-UABON    TO CLMTYPEA
 14390                MOVE -1          TO CLMTYPEL
 14391                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14392                GO TO 7060-FILL-AH-COVERAGE
 14393         ELSE
 14394             GO TO 7060-FILL-AH-COVERAGE
 14395         END-IF
 14396     END-IF.
 14397
 14398     MOVE PI-LIFE-OVERRIDE-L6    TO LCVDSCRO.
 14399     MOVE AL-UANON               TO LCVDSCRA.
 14400     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-HOLD.
 14401     MOVE '4'                    TO WS-REC-TYPE.
 14402     PERFORM 7100-READ-BENEFIT THRU 7199-EXIT.
 14403     MOVE WS-BEN-ALPHA-HOLD      TO LCVKINDO.
 14404     MOVE CM-LF-BENEFIT-CD       TO LCVCDO.
 14405     MOVE AL-UANON               TO LCVCDA.
 14406     MOVE CM-LF-ORIG-TERM        TO LCVOTRMO
 14407                                    CP-ORIGINAL-TERM.
 14408     MOVE AL-UNNON               TO LCVOTRMA.
 14409     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14410     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 14411     MOVE SAVE-CURRENT-DATE      TO CP-VALUATION-DT.
 14412     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 14413     MOVE '4'                    TO CP-REM-TERM-METHOD.
 14414     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 14415
 14416     PERFORM 9800-LINK-REM-TERM THRU 9800-EXIT.
 14417     MOVE CP-REMAINING-TERM-3    TO LCVRTRMO.
 14418
 14419     IF CM-LF-PREMIUM-RATE NUMERIC
 14420         MOVE CM-LF-PREMIUM-RATE TO LCVRATEO
 14421     ELSE
 14422         MOVE ZEROS              TO LCVRATEO
 14423     END-IF.
 14424
 14425     MOVE AL-UNNON               TO LCVRATEA.
 14426
 14427     IF CM-LF-ALT-BENEFIT-AMT NOT NUMERIC
 14428         MOVE ZEROS              TO CM-LF-ALT-BENEFIT-AMT
 14429     END-IF.
 14430
 14431     COMPUTE LCVBENEO = CM-LF-BENEFIT-AMT + CM-LF-ALT-BENEFIT-AMT.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 272
* EL130.cbl
 14432
 14433     MOVE AL-UNNON               TO LCVBENEA.
 14434
 14435     IF CM-POLICY-FORM-NO NOT = SPACES
 14436         MOVE CM-POLICY-FORM-NO  TO LCVFORMO
 14437     ELSE
 14438         MOVE WS-FORM-HOLD       TO LCVFORMO
 14439     END-IF.
 14440
 14441     MOVE SPACES                 TO WS-FORM-HOLD.
 14442     MOVE 'L'                    TO WS-REC-TYPE.
 14443     PERFORM 7400-READ-STATE THRU 7499-EXIT.
 14444
 14445     IF WS-FORM-HOLD NOT = SPACES
 14446         MOVE WS-FORM-HOLD       TO LCVFORMO
 14447         MOVE AL-UANON           TO LCVFORMA
 14448     END-IF.
 14449
 14450     IF CM-LF-CURRENT-STATUS = '8'
 14451         IF CM-LF-CANCEL-DT NOT = LOW-VALUES
 14452             MOVE CM-LF-CANCEL-DT TO DC-BIN-DATE-1
 14453             MOVE ' '             TO DC-OPTION-CODE
 14454             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14455             IF NOT DATE-CONVERSION-ERROR
 14456                 MOVE DC-GREG-DATE-1-EDIT TO LCVCNDTO
 14457                 MOVE AL-UANON            TO LCVCNDTA
 14458             END-IF
 14459         END-IF
 14460     END-IF.
 14461
 14462     IF CM-LF-CURRENT-STATUS = '7'
 14463         IF CM-LF-DEATH-DT NOT = LOW-VALUES
 14464             MOVE CM-LF-DEATH-DT TO DC-BIN-DATE-1
 14465             MOVE ' '            TO DC-OPTION-CODE
 14466             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14467             IF NOT DATE-CONVERSION-ERROR
 14468                 MOVE DC-GREG-DATE-1-EDIT TO LCVCNDTO
 14469                 MOVE AL-UANON   TO LCVCNDTA
 14470             END-IF
 14471         END-IF
 14472     END-IF.
 14473
 14474     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
 14475         IF CM-LF-DEATH-EXIT-DT NOT = SPACES
 14476             MOVE ' '            TO DC-OPTION-CODE
 14477             MOVE CM-LF-DEATH-EXIT-DT
 14478                                 TO DC-BIN-DATE-1
 14479             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14480             IF NOT DATE-CONVERSION-ERROR
 14481                 MOVE DC-GREG-DATE-1-EDIT
 14482                                 TO LCVEXITO
 14483             END-IF
 14484         END-IF
 14485     END-IF.
 14486
 14487     IF CM-LF-CURRENT-STATUS = '1' OR = '4'
 14488         IF CP-REMAINING-TERM-3 = ZEROS
 14489             MOVE 'EXPIRED'      TO LCVSTATO
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 273
* EL130.cbl
 14490         ELSE
 14491             MOVE 'ACTIVE'       TO LCVSTATO
 14492         END-IF
 14493     END-IF.
 14494
 14495     IF CM-LF-CURRENT-STATUS = '2'
 14496        MOVE 'PEND  '            TO LCVSTATO
 14497     END-IF.
 14498     IF CM-LF-CURRENT-STATUS = '3'
 14499        MOVE 'RESTORE'           TO LCVSTATO
 14500     END-IF.
 14501     IF CM-LF-CURRENT-STATUS = '5'
 14502        MOVE 'REISSUE'           TO LCVSTATO
 14503     END-IF.
 14504     IF CM-LF-CURRENT-STATUS = '6'
 14505        MOVE 'LMP DIS'           TO LCVSTATO
 14506     END-IF.
 14507     IF CM-LF-CURRENT-STATUS = '7'
 14508        MOVE 'DEATH  '           TO LCVSTATO
 14509     END-IF.
 14510     IF CM-LF-CURRENT-STATUS = '8'
 14511        MOVE 'CANCEL '           TO LCVSTATO
 14512     END-IF.
 14513     IF CM-LF-CURRENT-STATUS = '9'
 14514        MOVE 'RE-ONLY'           TO LCVSTATO
 14515     END-IF.
 14516     IF CM-LF-CURRENT-STATUS = 'V'
 14517        MOVE 'VOID   '           TO LCVSTATO
 14518     END-IF.
 14519     IF CM-LF-CURRENT-STATUS = 'D'
 14520        MOVE 'DECLINE'           TO LCVSTATO
 14521     END-IF.
 14522
 14523     IF PI-COMPANY-ID = 'CID'
 14524         IF CM-LF-BENEFIT-CD >= '2O' AND
 14525            CM-LF-BENEFIT-CD <= '2V'
 14526             MOVE ER-0878       TO EMI-ERROR
 14527             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14528         END-IF
 14529     END-IF.
 14530
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 274
* EL130.cbl
 14532 7060-FILL-AH-COVERAGE.
 14533
 14534     IF CM-AH-BENEFIT-CD = '00'
 14535         MOVE ZEROS              TO ACVOTRMO
 14536                                    ACVRTRMO
 14537                                    ACVRATEO
 14538                                    ACVBENEO
 14539         MOVE SPACES             TO ACVDSCRO
 14540                                    ACVCDO
 14541                                    ACVKINDO
 14542                                    ACVFORMO
 14543                                    ACVCNDTO
 14544                                    ACVEXITO
 14545                                    ACVSTATO
 14546         IF (CLMTYPEL GREATER THAN ZERO AND
 14547             (CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'))
 14548             MOVE ER-0521     TO EMI-ERROR
 14549             MOVE AL-UABON    TO CLMTYPEA
 14550             MOVE -1          TO CLMTYPEL
 14551             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14552             GO TO 7070-BUILD-MAP-FINISH
 14553         ELSE
 14554             GO TO 7070-BUILD-MAP-FINISH
 14555         END-IF
 14556     END-IF.
 14557
 14558     MOVE PI-AH-OVERRIDE-L6      TO ACVDSCRO.
 14559     MOVE CM-AH-BENEFIT-CD       TO ACVCDO WS-BEN-HOLD.
 14560     MOVE AL-UANON               TO ACVDSCRA
 14561                                    ACVCDA.
 14562     MOVE '5'                    TO WS-REC-TYPE.
 14563     PERFORM 7100-READ-BENEFIT THRU 7199-EXIT.
 14564     MOVE WS-BEN-ALPHA-HOLD      TO ACVKINDO.
 14565
 14566     MOVE CM-AH-ORIG-TERM        TO ACVOTRMO
 14567                                    CP-ORIGINAL-TERM.
 14568     MOVE AL-UNNON               TO ACVOTRMA.
 14569
 14570     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14571     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 14572     MOVE SAVE-CURRENT-DATE      TO CP-VALUATION-DT.
 14573     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 14574     MOVE '4'                    TO CP-REM-TERM-METHOD.
 14575     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 14576
 14577     PERFORM 9800-LINK-REM-TERM THRU 9800-EXIT.
 14578     MOVE CP-REMAINING-TERM-3    TO ACVRTRMO.
 14579
 14580     IF CM-AH-PREMIUM-RATE NUMERIC
 14581         MOVE CM-AH-PREMIUM-RATE TO ACVRATEO
 14582     ELSE
 14583         MOVE ZEROS              TO ACVRATEO
 14584     END-IF.
 14585
 14586     MOVE CM-AH-BENEFIT-AMT      TO ACVBENEO.
 14587     MOVE AL-UNNON               TO ACVRATEA
 14588                                    ACVBENEA.
 14589
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 275
* EL130.cbl
 14590     IF CM-POLICY-FORM-NO NOT = SPACES
 14591         MOVE CM-POLICY-FORM-NO  TO ACVFORMO
 14592     ELSE
 14593         MOVE WS-FORM-HOLD       TO ACVFORMO
 14594         MOVE SPACES TO WS-FORM-HOLD
 14595         MOVE 'A'                TO WS-REC-TYPE
 14596         PERFORM 7400-READ-STATE THRU 7499-EXIT
 14597         IF WS-FORM-HOLD NOT = SPACES
 14598             MOVE WS-FORM-HOLD   TO ACVFORMO
 14599         END-IF
 14600     END-IF.
 14601
 14602     MOVE AL-UANON               TO ACVFORMA.
 14603
 14604     IF CM-AH-CURRENT-STATUS = '8'
 14605         IF CM-AH-CANCEL-DT NOT = LOW-VALUES
 14606             MOVE CM-AH-CANCEL-DT TO DC-BIN-DATE-1
 14607             MOVE ' '             TO DC-OPTION-CODE
 14608             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14609             IF NOT DATE-CONVERSION-ERROR
 14610                MOVE DC-GREG-DATE-1-EDIT TO ACVCNDTO
 14611                MOVE AL-UANON    TO ACVCNDTA
 14612             END-IF
 14613         END-IF
 14614     END-IF.
 14615
 14616     IF CM-AH-CURRENT-STATUS = '6' OR '7'
 14617         IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
 14618             MOVE CM-AH-SETTLEMENT-DT TO DC-BIN-DATE-1
 14619             MOVE ' '             TO DC-OPTION-CODE
 14620             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14621             IF NOT DATE-CONVERSION-ERROR
 14622                MOVE DC-GREG-DATE-1-EDIT TO ACVCNDTO
 14623                MOVE AL-UANON            TO ACVCNDTA
 14624             END-IF
 14625         END-IF
 14626     END-IF.
 14627
 14628     IF CM-AH-SETTLEMENT-EXIT-DT NOT = LOW-VALUES
 14629         MOVE ' '                TO DC-OPTION-CODE
 14630         MOVE CM-AH-SETTLEMENT-EXIT-DT TO DC-BIN-DATE-1
 14631         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14632         IF NOT DATE-CONVERSION-ERROR
 14633             MOVE DC-GREG-DATE-1-EDIT TO ACVEXITO
 14634         END-IF
 14635     END-IF.
 14636
 14637     IF CM-AH-CURRENT-STATUS = '1' OR = '4'
 14638         IF CP-REMAINING-TERM-3 = ZEROS
 14639             MOVE 'EXPIRED'      TO ACVSTATO
 14640         ELSE
 14641             MOVE 'ACTIVE'       TO ACVSTATO
 14642         END-IF
 14643     END-IF.
 14644
 14645     IF CM-AH-CURRENT-STATUS = '2'
 14646         MOVE 'PEND  '           TO ACVSTATO
 14647     END-IF.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 276
* EL130.cbl
 14648     IF CM-AH-CURRENT-STATUS = '3'
 14649         MOVE 'RESTORE'          TO ACVSTATO
 14650     END-IF.
 14651     IF CM-AH-CURRENT-STATUS = '5'
 14652         MOVE 'REISSUE'          TO ACVSTATO
 14653     END-IF.
 14654     IF CM-AH-CURRENT-STATUS = '6'
 14655         MOVE 'LMP DIS'          TO ACVSTATO
 14656     END-IF.
 14657     IF CM-AH-CURRENT-STATUS = '7'
 14658         MOVE 'DEATH  '          TO ACVSTATO
 14659     END-IF.
 14660     IF CM-AH-CURRENT-STATUS = '8'
 14661         MOVE 'CANCEL '          TO ACVSTATO
 14662     END-IF.
 14663     IF CM-AH-CURRENT-STATUS = '9'
 14664         MOVE 'RE-ONLY'          TO ACVSTATO
 14665     END-IF.
 14666     IF CM-AH-CURRENT-STATUS = 'V'
 14667         MOVE 'VOID   '          TO ACVSTATO
 14668     END-IF.
 14669     IF CM-AH-CURRENT-STATUS = 'D'
 14670         MOVE 'DECLINE'          TO ACVSTATO
 14671     END-IF.
 14672
 14673     IF PI-COMPANY-ID = 'DCC'
 14674        IF CM-ACCOUNT (9:2) = 'BI'
 14675           MOVE CM-COMPANY-CD    TO CTRLR-COMP-CD
 14676           MOVE CM-CARRIER       TO CTRLR-CARRIER
 14677           MOVE CM-GROUPING      TO CTRLR-GROUPING
 14678           MOVE CM-STATE         TO CTRLR-STATE
 14679           MOVE CM-ACCOUNT       TO CTRLR-ACCOUNT
 14680           MOVE CM-CERT-EFF-DT   TO CTRLR-EFF-DT
 14681           MOVE CM-CERT-NO       TO CTRLR-CERT-NO
 14682           MOVE 'C'              TO CTRLR-REC-TYPE
 14683
 14684* EXEC CICS READ
 14685*            DATASET  (ELCRTT-DSID)
 14686*            SET      (ADDRESS OF CERTIFICATE-TRAILERS)
 14687*            RIDFLD   (ELCRTT-KEY)
 14688*            RESP     (WS-RESPONSE)
 14689*          END-EXEC
 14690*    MOVE '&"S        E          (  N#00013270' TO DFHEIV0
 14691     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14692     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14693     MOVE X'204E233030303133323730' TO DFHEIV0(25:11)
 14694     CALL 'kxdfhei1' USING DFHEIV0,
 14695           ELCRTT-DSID,
 14696           DFHEIV20,
 14697           DFHEIV99,
 14698           ELCRTT-KEY,
 14699           DFHEIV99,
 14700           DFHEIV99,
 14701           DFHEIV99
 14702     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 14703         DFHEIV20
 14704     MOVE EIBRESP  TO WS-RESPONSE
 14705     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 277
* EL130.cbl
 14706           IF WS-RESP-NORMAL
 14707               MOVE CS-VIN-NUMBER   TO WS-DIAG-VIN
 14708               MOVE WS-DIAG-VIN-MSG TO DIAGO
 14709               MOVE AL-UANON        TO DIAGA
 14710           END-IF
 14711        END-IF
 14712     END-IF.
 14713
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 278
* EL130.cbl
 14715 7070-BUILD-MAP-FINISH.
 14716     MOVE CM-LOAN-APR            TO APRO.
 14717     MOVE CM-PAY-FREQUENCY       TO PMTFREQO.
 14718     MOVE CM-IND-GRP-TYPE        TO INDGRPO.
 14719     MOVE CM-PREMIUM-TYPE        TO PREMTYPO.
 14720     MOVE AL-UNNON               TO APRA
 14721                                    PMTFREQA.
 14722     MOVE AL-UANON               TO INDGRPA
 14723                                    PREMTYPA.
 14724
 14725     IF (CM-SPECIAL-REIN-CODE NOT = SPACES AND LOW-VALUES)
 14726         MOVE CM-SPECIAL-REIN-CODE   TO REINCDO
 14727         MOVE AL-UANON               TO REINCDA
 14728     END-IF.
 14729
 14730     IF CM-LAST-ADD-ON-DT = SPACES OR LOW-VALUES
 14731*        NEXT SENTENCE
 14732         CONTINUE
 14733     ELSE
 14734         MOVE CM-LAST-ADD-ON-DT  TO DC-BIN-DATE-1
 14735         MOVE ' '                TO DC-OPTION-CODE
 14736         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14737         IF NOT DATE-CONVERSION-ERROR
 14738             MOVE DC-GREG-DATE-1-EDIT TO ADDONDTO
 14739             MOVE AL-UANON            TO ADDONDTA
 14740         END-IF
 14741     END-IF.
 14742
 14743     IF CLAIM-SWITCH = 'N'
 14744         IF SEXL = ZEROS
 14745             MOVE CM-INSURED-SEX TO SEXO
 14746*            MOVE AL-UANON       TO SEXA
 14747         END-IF
 14748     END-IF.
 14749
 14750     IF CM-MEMB-ACCOUNT NOT = CM-ACCOUNT-PRIME
 14751         MOVE CM-MEMBER-NO       TO MEMBERO
 14752         MOVE AL-UANON           TO MEMBERA
 14753     END-IF.
 14754
 14755     IF MAINTI = 'A'
 14756         IF (LOANNOL = ZEROS OR
 14757             EIBAID = DFHPF5)
 14758             MOVE CM-LOAN-NUMBER TO LOANNOO
 14759             MOVE AL-UANON       TO LOANNOA
 14760         ELSE
 14761*            NEXT SENTENCE
 14762             CONTINUE
 14763         END-IF
 14764     ELSE
 14765         MOVE CM-LOAN-NUMBER     TO LOANNOO
 14766         MOVE AL-UANON           TO LOANNOA
 14767     END-IF.
 14768
 14769     IF MAINTI = 'A'
 14770         IF (LOANBALL = ZEROS OR
 14771             EIBAID = DFHPF5)
 14772             MOVE CM-LOAN-BALANCE TO LOANBALO
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 279
* EL130.cbl
 14773             MOVE AL-UNNON       TO LOANBALA
 14774         ELSE
 14775*            NEXT SENTENCE
 14776             CONTINUE
 14777         END-IF
 14778     ELSE
 14779         MOVE CM-LOAN-BALANCE    TO LOANBALO
 14780         MOVE AL-UNNON           TO LOANBALA
 14781     END-IF.
 14782
 14783     IF CM-PREMIUM-TYPE NOT = '3'
 14784         IF NOT CERT-WAS-CREATED-FOR-CLAIM
 14785             PERFORM 7200-PROTECT-CERT-FIELDS
 14786         ELSE
 14787             PERFORM 7300-RESET-KEY-ATTRBS
 14788         END-IF
 14789     ELSE
 14790         PERFORM 7300-RESET-KEY-ATTRBS
 14791     END-IF.
 14792
 14793*    IF PI-COMPANY-ID  = 'CRI' OR 'LGX' OR 'NCL' OR 'HAN'
 14794*        NEXT SENTENCE
 14795*        CONTINUE
 14796*    ELSE
 14797         MOVE AL-SANOF           TO LCVRATEA  ACVRATEA.
 14798*    END-IF.
 14799
 14800 7099-EXIT.
 14801     EXIT.
 14802
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 280
* EL130.cbl
 14804 7100-READ-BENEFIT.
 14805
 14806
 14807* EXEC CICS HANDLE CONDITION
 14808*         NOTFND   (7120-NOT-FOUND)
 14809*    END-EXEC.
 14810*    MOVE '"$I                   ! E #00013376' TO DFHEIV0
 14811     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14812     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14813     MOVE X'4520233030303133333736' TO DFHEIV0(25:11)
 14814     CALL 'kxdfhei1' USING DFHEIV0
 14815     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14816
 14817
 14818     MOVE SPACES                 TO ELCNTL-KEY.
 14819     MOVE WS-BEN-HOLD            TO CNTL-BENEFIT.
 14820     MOVE WS-REC-TYPE            TO CNTL-REC-TYPE.
 14821     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 14822     MOVE ZEROS                  TO CNTL-SEQ-NO.
 14823
 14824 7105-READ-FILE.
 14825     PERFORM 7975-READ-CNTL-GTEQ THRU 7975-EXIT.
 14826
 14827     IF PI-COMPANY-ID NOT = CF-COMPANY-ID  OR
 14828        WS-REC-TYPE   NOT = CF-RECORD-TYPE
 14829          GO TO 7120-NOT-FOUND
 14830     END-IF.
 14831
 14832     MOVE 1                      TO SUB.
 14833 7110-LOOP.
 14834     IF SUB = 9
 14835         GO TO 7120-NOT-FOUND
 14836     END-IF.
 14837
 14838     IF WS-BEN-HOLD NOT = CF-BENEFIT-CODE (SUB)
 14839         ADD 1                   TO SUB
 14840         GO TO 7110-LOOP
 14841     END-IF.
 14842
 14843     MOVE CF-BENEFIT-ALPHA (SUB)    TO WS-BEN-ALPHA-HOLD.
 14844     MOVE CF-CO-EARNINGS-CALC (SUB) TO WS-EARNINGS-CALC.
 14845     MOVE CF-SPECIAL-CALC-CD (SUB)  TO WS-SPECIAL-CALC-CD.
 14846
 14847     GO TO 7199-EXIT.
 14848
 14849 7120-NOT-FOUND.
 14850     MOVE SPACES                 TO WS-BEN-ALPHA-HOLD
 14851                                    WS-FORM-HOLD.
 14852
 14853 7199-EXIT.
 14854      EXIT.
 14855
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 281
* EL130.cbl
 14857 7200-PROTECT-CERT-FIELDS.
 14858     MOVE AL-SANON           TO CERTMTA EFFDTA ACCOUNTA STATEA
 14859                                CRTCARRA GROUPA CRTLNMEA CRTFNMEA
 14860                                LCVFORMA ACVFORMA JNTLNMEA
 14861                                JNTFNMEA JNTINITA.
 14862
 14863     IF CM-LF-CURRENT-STATUS = '2' OR
 14864        CM-AH-CURRENT-STATUS = '2'
 14865         MOVE AL-SANON           TO LOANNOA LOANBALA PREMTYPA
 14866     END-IF.
 14867
 14868     MOVE AL-SANOF TO
 14869            CRTINITA   ISSAGEA    JNTAGEA    CRTSSNA   ADDONDTA
 14870            LCVDSCRA   LCVCDA     LCVOTRMA   LCVBENEA  LCVCNDTA
 14871            ACVDSCRA   ACVCDA     ACVOTRMA   ACVBENEA  ACVCNDTA
 14872            APRA       PMTFREQA   INDGRPA    MEMBERA   REINCDA
 14873            LCVRATEA   ACVRATEA.
 14874
 14875     MOVE 'S'                    TO CERTMTI.
 14876
 14877 7300-RESET-KEY-ATTRBS.
 14878     MOVE AL-UANON           TO CERTMTA EFFDTA ACCOUNTA STATEA
 14879                                CRTCARRA GROUPA CRTLNMEA CRTFNMEA
 14880                                LCVFORMA ACVFORMA JNTLNMEA
 14881                                JNTFNMEA JNTINITA.
 14882
 14883     IF NOT CERT-WAS-CREATED-FOR-CLAIM
 14884         MOVE AL-SANOF           TO REINCDA
 14885     END-IF.
 14886
 14887     MOVE 'S'                    TO CERTMTI.
 14888
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 282
* EL130.cbl
 14890 7400-READ-STATE.
 14891
 14892
 14893* EXEC CICS HANDLE CONDITION
 14894*         NOTFND   (7499-EXIT)
 14895*    END-EXEC.
 14896*    MOVE '"$I                   ! F #00013454' TO DFHEIV0
 14897     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14898     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14899     MOVE X'4620233030303133343534' TO DFHEIV0(25:11)
 14900     CALL 'kxdfhei1' USING DFHEIV0
 14901     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14902
 14903
 14904     MOVE SPACES                 TO ELCNTL-KEY.
 14905     MOVE CM-STATE               TO CNTL-ACCESS.
 14906     MOVE '3'                    TO CNTL-REC-TYPE.
 14907     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 14908     MOVE ZEROS                  TO CNTL-SEQ-NO.
 14909
 14910     PERFORM 7970-READ-CNTL THRU 7970-EXIT.
 14911
 14912     MOVE 1                      TO SUB.
 14913
 14914 7410-LOOP.
 14915     IF SUB = 21
 14916        GO TO 7499-EXIT
 14917     END-IF.
 14918
 14919*    IF (WS-BEN-HOLD  = CF-ST-BENEFIT-CD (SUB))  AND
 14920*       (WS-REC-TYPE  = CF-ST-BENEFIT-KIND (SUB))
 14921*        MOVE CF-ST-FORM-NO (SUB) TO WS-FORM-HOLD
 14922*        GO TO 7499-EXIT.
 14923
 14924     ADD 1                       TO SUB.
 14925     GO TO 7410-LOOP.
 14926
 14927 7499-EXIT.
 14928      EXIT.
 14929
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 283
* EL130.cbl
 14931 7500-BROWSE-FOR-DUPLICATE.
 14932
 14933     MOVE 'N'                    TO INCUR-DTE-DUPE-SW.
 14934
 14935
 14936
 14937* EXEC CICS HANDLE CONDITION
 14938*        NOTFND   (7500-EXIT)
 14939*        DUPKEY   (7500-DUPLICATE-KEY)
 14940*        ENDFILE  (7500-EXIT)
 14941*    END-EXEC.
 14942*    MOVE '"$I$''                 ! G #00013490' TO DFHEIV0
 14943     MOVE X'222449242720202020202020' TO DFHEIV0(1:12)
 14944     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14945     MOVE X'4720233030303133343930' TO DFHEIV0(25:11)
 14946     CALL 'kxdfhei1' USING DFHEIV0
 14947     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14948
 14949
 14950
 14951
 14952* EXEC CICS STARTBR
 14953*        DATASET    (ELMSTR5-DSID)
 14954*        RIDFLD     (ELMSTR5-KEY)
 14955*    END-EXEC.
 14956     MOVE 0
 14957       TO DFHEIV11
 14958*    MOVE '&,         G          &   #00013497' TO DFHEIV0
 14959     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 14960     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14961     MOVE X'2020233030303133343937' TO DFHEIV0(25:11)
 14962     CALL 'kxdfhei1' USING DFHEIV0,
 14963           ELMSTR5-DSID,
 14964           ELMSTR5-KEY,
 14965           DFHEIV99,
 14966           DFHEIV11,
 14967           DFHEIV99
 14968     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14969
 14970
 14971
 14972
 14973* EXEC CICS HANDLE CONDITION
 14974*        ENDFILE  (7500-END-BROWSE)
 14975*    END-EXEC.
 14976*    MOVE '"$''                   ! H #00013503' TO DFHEIV0
 14977     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 14978     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14979     MOVE X'4820233030303133353033' TO DFHEIV0(25:11)
 14980     CALL 'kxdfhei1' USING DFHEIV0
 14981     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14982
 14983
 14984 7500-READ-CLAIM-LOOP.
 14985
 14986
 14987
 14988* EXEC CICS READNEXT
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 284
* EL130.cbl
 14989*        DATASET   (ELMSTR5-DSID)
 14990*        SET       (ADDRESS OF CLAIM-MASTER)
 14991*        RIDFLD    (ELMSTR5-KEY)
 14992*    END-EXEC.
 14993     MOVE 0
 14994       TO DFHEIV11
 14995*    MOVE '&.S                   )   #00013510' TO DFHEIV0
 14996     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 14997     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 14998     MOVE X'2020233030303133353130' TO DFHEIV0(25:11)
 14999     CALL 'kxdfhei1' USING DFHEIV0,
 15000           ELMSTR5-DSID,
 15001           DFHEIV20,
 15002           DFHEIV99,
 15003           ELMSTR5-KEY,
 15004           DFHEIV99,
 15005           DFHEIV11,
 15006           DFHEIV99,
 15007           DFHEIV99
 15008     SET ADDRESS OF CLAIM-MASTER TO
 15009         DFHEIV20
 15010     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15011
 15012
 15013 7500-DUPLICATE-KEY.
 15014
 15015     IF CL-COMPANY-CD     NOT = CM-COMPANY-CD  OR
 15016        CL-CERT-CARRIER   NOT = CM-CARRIER     OR
 15017        CL-CERT-GROUPING  NOT = CM-GROUPING    OR
 15018        CL-CERT-STATE     NOT = CM-STATE       OR
 15019        CL-CERT-ACCOUNT   NOT = CM-ACCOUNT     OR
 15020        CL-CERT-EFF-DT    NOT = CM-CERT-EFF-DT OR
 15021        CL-CERT-NO        NOT = CM-CERT-NO
 15022           GO TO 7500-CHECK-MATCH-COUNT
 15023     END-IF.
 15024
 15025     MOVE 'H'                    TO INCUR-DTE-DUPE-SW.
 15026
 15027     IF CL-INCURRED-DT = PI-SAVE-INCUR-DT
 15028        MOVE 'Y'                 TO INCUR-DTE-DUPE-SW
 15029        GO TO 7500-END-BROWSE
 15030     ELSE
 15031        GO TO 7500-READ-CLAIM-LOOP
 15032     END-IF.
 15033
 15034 7500-CHECK-MATCH-COUNT.
 15035
 15036     IF CL-COMPANY-CD = CM-COMPANY-CD AND
 15037        CL-CERT-NO    = CM-CERT-NO
 15038          GO TO 7500-READ-CLAIM-LOOP
 15039     END-IF.
 15040
 15041 7500-END-BROWSE.
 15042
 15043
 15044
 15045* EXEC CICS ENDBR
 15046*        DATASET   (ELMSTR5-DSID)
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 285
* EL130.cbl
 15047*    END-EXEC.
 15048     MOVE 0
 15049       TO DFHEIV11
 15050*    MOVE '&2                    $   #00013547' TO DFHEIV0
 15051     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 15052     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15053     MOVE X'2020233030303133353437' TO DFHEIV0(25:11)
 15054     CALL 'kxdfhei1' USING DFHEIV0,
 15055           ELMSTR5-DSID,
 15056           DFHEIV11,
 15057           DFHEIV99
 15058     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15059
 15060
 15061 7500-EXIT.
 15062     EXIT.
 15063
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 286
* EL130.cbl
 15065 7550-FALL-THRU-PARA.
 15066
 15067
 15068
 15069* EXEC CICS DUMP
 15070*         DUMPCODE ('E130')
 15071*         TASK
 15072*    END-EXEC.
 15073     MOVE 'E130' TO DFHEIV5
 15074*    MOVE '<"   T                $   #00013558' TO DFHEIV0
 15075     MOVE X'3C2220202054202020202020' TO DFHEIV0(1:12)
 15076     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15077     MOVE X'2020233030303133353538' TO DFHEIV0(25:11)
 15078     CALL 'kxdfhei1' USING DFHEIV0,
 15079           DFHEIV5,
 15080           DFHEIV99,
 15081           DFHEIV99
 15082     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15083
 15084
 15085
 15086
 15087* EXEC CICS RETURN
 15088*    END-EXEC.
 15089*    MOVE '.(                    ''   #00013564' TO DFHEIV0
 15090     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 15091     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15092     MOVE X'2020233030303133353634' TO DFHEIV0(25:11)
 15093     CALL 'kxdfhei1' USING DFHEIV0,
 15094           DFHEIV99,
 15095           DFHEIV99,
 15096           DFHEIV99,
 15097           DFHEIV99,
 15098           DFHEIV99,
 15099           DFHEIV99
 15100     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15101
 15102
 15103 7600-BROWSE-CLAIM.
 15104
 15105
 15106
 15107* EXEC CICS READ
 15108*        DATASET(ELMSTR-DSID)
 15109*        SET    (ADDRESS OF CLAIM-MASTER)
 15110*        RIDFLD (ELMSTR-KEY)
 15111*        GENERIC
 15112*        EQUAL
 15113*        KEYLENGTH(ELMSTR-GENERIC-LENGTH)
 15114*    END-EXEC.
 15115*    MOVE '&"S  KG    E          (   #00013570' TO DFHEIV0
 15116     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 15117     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15118     MOVE X'2020233030303133353730' TO DFHEIV0(25:11)
 15119     CALL 'kxdfhei1' USING DFHEIV0,
 15120           ELMSTR-DSID,
 15121           DFHEIV20,
 15122           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 287
* EL130.cbl
 15123           ELMSTR-KEY,
 15124           ELMSTR-GENERIC-LENGTH,
 15125           DFHEIV99,
 15126           DFHEIV99
 15127     SET ADDRESS OF CLAIM-MASTER TO
 15128         DFHEIV20
 15129     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15130
 15131
 15132     MOVE CL-CERT-PRIME          TO CERTNOI.
 15133     MOVE CL-CERT-SFX            TO SUFXI.
 15134
 15135 7610-BROWSE-CLAIM-LOOP.
 15136
 15137     MOVE LOW-VALUES             TO BCERT1O
 15138                                    BSUFX1O
 15139                                    BCERT2O
 15140                                    BSUFX2O
 15141                                    BCERT3O
 15142                                    BSUFX3O
 15143                                    BCERT4O
 15144                                    BSUFX4O
 15145                                    BCERT5O
 15146                                    BSUFX5O.
 15147
 15148     MOVE ELMSTR-KEY             TO SAVE-ELMSTR-KEY.
 15149
 15150
 15151
 15152* EXEC CICS HANDLE CONDITION
 15153*        ENDFILE  (7630-END-BROWSE)
 15154*    END-EXEC.
 15155*    MOVE '"$''                   ! I #00013598' TO DFHEIV0
 15156     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 15157     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15158     MOVE X'4920233030303133353938' TO DFHEIV0(25:11)
 15159     CALL 'kxdfhei1' USING DFHEIV0
 15160     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15161
 15162
 15163
 15164
 15165* EXEC CICS STARTBR
 15166*        DATASET    (ELMSTR-DSID)
 15167*        RIDFLD     (ELMSTR-KEY)
 15168*    END-EXEC.
 15169     MOVE 0
 15170       TO DFHEIV11
 15171*    MOVE '&,         G          &   #00013603' TO DFHEIV0
 15172     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 15173     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 15174     MOVE X'2020233030303133363033' TO DFHEIV0(25:11)
 15175     CALL 'kxdfhei1' USING DFHEIV0,
 15176           ELMSTR-DSID,
 15177           ELMSTR-KEY,
 15178           DFHEIV99,
 15179           DFHEIV11,
 15180           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 288
* EL130.cbl
 15181     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15182
 15183
 15184     MOVE +1                     TO WS-ASSOCIATED-CERTS.
 15185
 15186 7620-READ-CLAIM-LOOP.
 15187
 15188
 15189
 15190* EXEC CICS READNEXT
 15191*        DATASET   (ELMSTR-DSID)
 15192*        SET       (ADDRESS OF CLAIM-MASTER)
 15193*        RIDFLD    (ELMSTR-KEY)
 15194*    END-EXEC.
 15195     MOVE 0
 15196       TO DFHEIV11
 15197*    MOVE '&.S                   )   #00013613' TO DFHEIV0
 15198     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 15199     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 15200     MOVE X'2020233030303133363133' TO DFHEIV0(25:11)
 15201     CALL 'kxdfhei1' USING DFHEIV0,
 15202           ELMSTR-DSID,
 15203           DFHEIV20,
 15204           DFHEIV99,
 15205           ELMSTR-KEY,
 15206           DFHEIV99,
 15207           DFHEIV11,
 15208           DFHEIV99,
 15209           DFHEIV99
 15210     SET ADDRESS OF CLAIM-MASTER TO
 15211         DFHEIV20
 15212     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15213
 15214
 15215     IF CL-COMPANY-CD  NOT = PI-COMPANY-CD  OR
 15216        CL-CARRIER     NOT = CLMCARRI       OR
 15217        CL-CLAIM-NO    NOT = CLMNOI
 15218          GO TO 7630-END-BROWSE
 15219     END-IF.
 15220
 15221     IF WS-ASSOCIATED-CERTS = 1
 15222         MOVE CL-CERT-PRIME      TO BCERT1O
 15223         MOVE CL-CERT-SFX        TO BSUFX1O
 15224     END-IF.
 15225
 15226     IF WS-ASSOCIATED-CERTS = 2
 15227         MOVE CL-CERT-PRIME      TO BCERT2O
 15228         MOVE CL-CERT-SFX        TO BSUFX2O
 15229     END-IF.
 15230
 15231     IF WS-ASSOCIATED-CERTS = 3
 15232         MOVE CL-CERT-PRIME      TO BCERT3O
 15233         MOVE CL-CERT-SFX        TO BSUFX3O
 15234     END-IF.
 15235
 15236     IF WS-ASSOCIATED-CERTS = 4
 15237         MOVE CL-CERT-PRIME      TO BCERT4O
 15238         MOVE CL-CERT-SFX        TO BSUFX4O
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 289
* EL130.cbl
 15239     END-IF.
 15240
 15241     IF WS-ASSOCIATED-CERTS = 5
 15242         MOVE CL-CERT-PRIME      TO BCERT5O
 15243         MOVE CL-CERT-SFX        TO BSUFX5O
 15244     ELSE
 15245         ADD +1                  TO WS-ASSOCIATED-CERTS
 15246         GO TO 7620-READ-CLAIM-LOOP
 15247     END-IF.
 15248
 15249 7630-END-BROWSE.
 15250
 15251
 15252
 15253* EXEC CICS ENDBR
 15254*        DATASET   (ELMSTR-DSID)
 15255*    END-EXEC.
 15256     MOVE 0
 15257       TO DFHEIV11
 15258*    MOVE '&2                    $   #00013656' TO DFHEIV0
 15259     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 15260     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15261     MOVE X'2020233030303133363536' TO DFHEIV0(25:11)
 15262     CALL 'kxdfhei1' USING DFHEIV0,
 15263           ELMSTR-DSID,
 15264           DFHEIV11,
 15265           DFHEIV99
 15266     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15267
 15268
 15269 7640-HIGHLIGHT-CERT-DISPLAYED.
 15270
 15271     MOVE SAVE-ELMSTR-KEY        TO ELMSTR-KEY.
 15272     MOVE AL-SANON               TO BCERT1A
 15273                                    BSUFX1A
 15274                                    BCERT2A
 15275                                    BSUFX2A
 15276                                    BCERT3A
 15277                                    BSUFX3A
 15278                                    BCERT4A
 15279                                    BSUFX4A
 15280                                    BCERT5A
 15281                                    BSUFX5A.
 15282
 15283     IF BCERT1O = CERTNOI AND
 15284        BSUFX1O = SUFXI
 15285            MOVE AL-SABON        TO BCERT1A
 15286                                    BSUFX1A
 15287     END-IF.
 15288
 15289     IF BCERT2O = CERTNOI AND
 15290        BSUFX2O = SUFXI
 15291            MOVE AL-SABON        TO BCERT2A
 15292                                    BSUFX2A
 15293     END-IF.
 15294
 15295     IF BCERT3O = CERTNOI AND
 15296        BSUFX3O = SUFXI
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 290
* EL130.cbl
 15297            MOVE AL-SABON        TO BCERT3A
 15298                                    BSUFX3A
 15299     END-IF.
 15300
 15301     IF BCERT4O = CERTNOI AND
 15302        BSUFX4O = SUFXI
 15303            MOVE AL-SABON        TO BCERT4A
 15304                                    BSUFX4A
 15305     END-IF.
 15306
 15307     IF BCERT5O = CERTNOI AND
 15308        BSUFX5O = SUFXI
 15309            MOVE AL-SABON        TO BCERT5A
 15310                                    BSUFX5A
 15311     END-IF.
 15312
 15313 7699-EXIT.
 15314     EXIT.
 15315
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 291
* EL130.cbl
 15317 7700-CHECK-SEQUENCE.
 15318
 15319
 15320
 15321* EXEC CICS HANDLE CONDITION
 15322*        ENDFILE  (7799-EXIT)
 15323*        NOTFND   (7799-EXIT)
 15324*    END-EXEC.
 15325*    MOVE '"$''I                  ! J #00013711' TO DFHEIV0
 15326     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 15327     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15328     MOVE X'4A20233030303133373131' TO DFHEIV0(25:11)
 15329     CALL 'kxdfhei1' USING DFHEIV0
 15330     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15331
 15332
 15333
 15334
 15335* EXEC CICS READ
 15336*        DATASET(ELMSTR-DSID)
 15337*        SET    (ADDRESS OF CLAIM-MASTER)
 15338*        RIDFLD (ELMSTR-KEY)
 15339*        GENERIC
 15340*        EQUAL
 15341*        KEYLENGTH(ELMSTR-GENERIC-LENGTH)
 15342*    END-EXEC.
 15343*    MOVE '&"S  KG    E          (   #00013717' TO DFHEIV0
 15344     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 15345     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15346     MOVE X'2020233030303133373137' TO DFHEIV0(25:11)
 15347     CALL 'kxdfhei1' USING DFHEIV0,
 15348           ELMSTR-DSID,
 15349           DFHEIV20,
 15350           DFHEIV99,
 15351           ELMSTR-KEY,
 15352           ELMSTR-GENERIC-LENGTH,
 15353           DFHEIV99,
 15354           DFHEIV99
 15355     SET ADDRESS OF CLAIM-MASTER TO
 15356         DFHEIV20
 15357     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15358
 15359
 15360     COMPUTE WS-ASSOC-CERT-TOTAL =
 15361             CL-ASSOC-CERT-TOTAL + ONE-OR-MIN1.
 15362
 15363     GO TO 7799-EXIT.
 15364
 15365 7710-RESEQUENCE-CLAIMS.
 15366
 15367
 15368
 15369* EXEC CICS HANDLE CONDITION
 15370*        ENDFILE  (7790-END-BROWSE)
 15371*    END-EXEC.
 15372*    MOVE '"$''                   ! K #00013734' TO DFHEIV0
 15373     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 15374     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 292
* EL130.cbl
 15375     MOVE X'4B20233030303133373334' TO DFHEIV0(25:11)
 15376     CALL 'kxdfhei1' USING DFHEIV0
 15377     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15378
 15379
 15380
 15381
 15382* EXEC CICS STARTBR
 15383*        DATASET    (ELMSTR-DSID)
 15384*        RIDFLD     (ELMSTR-KEY)
 15385*    END-EXEC.
 15386     MOVE 0
 15387       TO DFHEIV11
 15388*    MOVE '&,         G          &   #00013739' TO DFHEIV0
 15389     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 15390     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 15391     MOVE X'2020233030303133373339' TO DFHEIV0(25:11)
 15392     CALL 'kxdfhei1' USING DFHEIV0,
 15393           ELMSTR-DSID,
 15394           ELMSTR-KEY,
 15395           DFHEIV99,
 15396           DFHEIV11,
 15397           DFHEIV99
 15398     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15399
 15400
 15401     ADD +1 TO WS-ASSOC-CERT-SEQU
 15402               WS-READNEXT-SWITCH.
 15403
 15404 7720-READ-CLAIM-LOOP.
 15405
 15406
 15407
 15408* EXEC CICS READNEXT
 15409*        DATASET   (ELMSTR-DSID)
 15410*        SET       (ADDRESS OF CLAIM-MASTER)
 15411*        RIDFLD    (ELMSTR-KEY)
 15412*    END-EXEC.
 15413     MOVE 0
 15414       TO DFHEIV11
 15415*    MOVE '&.S                   )   #00013750' TO DFHEIV0
 15416     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 15417     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 15418     MOVE X'2020233030303133373530' TO DFHEIV0(25:11)
 15419     CALL 'kxdfhei1' USING DFHEIV0,
 15420           ELMSTR-DSID,
 15421           DFHEIV20,
 15422           DFHEIV99,
 15423           ELMSTR-KEY,
 15424           DFHEIV99,
 15425           DFHEIV11,
 15426           DFHEIV99,
 15427           DFHEIV99
 15428     SET ADDRESS OF CLAIM-MASTER TO
 15429         DFHEIV20
 15430     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15431
 15432
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 293
* EL130.cbl
 15433     IF WS-READNEXT-SWITCH = 1
 15434         ADD 1 TO WS-READNEXT-SWITCH
 15435         GO TO 7720-READ-CLAIM-LOOP
 15436     END-IF.
 15437
 15438 7730-END-BROWSE.
 15439
 15440
 15441
 15442* EXEC CICS ENDBR
 15443*        DATASET   (ELMSTR-DSID)
 15444*    END-EXEC.
 15445     MOVE 0
 15446       TO DFHEIV11
 15447*    MOVE '&2                    $   #00013764' TO DFHEIV0
 15448     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 15449     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15450     MOVE X'2020233030303133373634' TO DFHEIV0(25:11)
 15451     CALL 'kxdfhei1' USING DFHEIV0,
 15452           ELMSTR-DSID,
 15453           DFHEIV11,
 15454           DFHEIV99
 15455     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15456
 15457
 15458 7740-READ-CLAIM-UPDATE.
 15459
 15460     IF CL-COMPANY-CD NOT = WS-SAVE-COMPANY-CD OR
 15461        CL-CARRIER    NOT = WS-SAVE-CARRIER    OR
 15462        CL-CLAIM-NO   NOT = WS-SAVE-CLAIM-NO
 15463          GO TO 7799-EXIT
 15464     ELSE
 15465          MOVE ZERO              TO WS-READNEXT-SWITCH
 15466     END-IF.
 15467
 15468
 15469
 15470* EXEC CICS READ
 15471*        DATASET(ELMSTR-DSID)
 15472*        SET    (ADDRESS OF CLAIM-MASTER)
 15473*        RIDFLD (ELMSTR-KEY)
 15474*        UPDATE
 15475*    END-EXEC.
 15476*    MOVE '&"S        EU         (   #00013779' TO DFHEIV0
 15477     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15478     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15479     MOVE X'2020233030303133373739' TO DFHEIV0(25:11)
 15480     CALL 'kxdfhei1' USING DFHEIV0,
 15481           ELMSTR-DSID,
 15482           DFHEIV20,
 15483           DFHEIV99,
 15484           ELMSTR-KEY,
 15485           DFHEIV99,
 15486           DFHEIV99,
 15487           DFHEIV99
 15488     SET ADDRESS OF CLAIM-MASTER TO
 15489         DFHEIV20
 15490     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 294
* EL130.cbl
 15491
 15492
 15493     MOVE WS-ASSOC-CERT-TOTAL    TO CL-ASSOC-CERT-TOTAL.
 15494     MOVE WS-ASSOC-CERT-SEQU     TO CL-ASSOC-CERT-SEQU.
 15495
 15496
 15497
 15498* EXEC CICS REWRITE
 15499*         DATASET     (ELMSTR-DSID)
 15500*         FROM        (CLAIM-MASTER)
 15501*    END-EXEC.
 15502     MOVE LENGTH OF
 15503      CLAIM-MASTER
 15504       TO DFHEIV11
 15505*    MOVE '&& L                  %   #00013790' TO DFHEIV0
 15506     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15507     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15508     MOVE X'2020233030303133373930' TO DFHEIV0(25:11)
 15509     CALL 'kxdfhei1' USING DFHEIV0,
 15510           ELMSTR-DSID,
 15511           CLAIM-MASTER,
 15512           DFHEIV11,
 15513           DFHEIV99
 15514     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15515
 15516
 15517     GO TO 7710-RESEQUENCE-CLAIMS.
 15518
 15519 7790-END-BROWSE.
 15520
 15521
 15522
 15523* EXEC CICS ENDBR
 15524*        DATASET   (ELMSTR-DSID)
 15525*    END-EXEC.
 15526     MOVE 0
 15527       TO DFHEIV11
 15528*    MOVE '&2                    $   #00013800' TO DFHEIV0
 15529     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 15530     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15531     MOVE X'2020233030303133383030' TO DFHEIV0(25:11)
 15532     CALL 'kxdfhei1' USING DFHEIV0,
 15533           ELMSTR-DSID,
 15534           DFHEIV11,
 15535           DFHEIV99
 15536     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15537
 15538
 15539 7799-EXIT.
 15540     EXIT.
 15541
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 295
* EL130.cbl
 15543************************************************
 15544*  I/O REQUESTS AGAINST ACTIVITY TRAILER FILE  *
 15545************************************************
 15546
 15547 7900-READ-ACTV-UPDATE.
 15548     MOVE MSTR-COMP-CD           TO TRLR-COMP-CD.
 15549     MOVE MSTR-CARRIER           TO TRLR-CARRIER.
 15550     MOVE MSTR-CLAIM-NO          TO TRLR-CLAIM-NO.
 15551     MOVE MSTR-CERT-NO           TO TRLR-CERT-NO.
 15552     MOVE +0                     TO TRLR-SEQ-NO.
 15553     MOVE '1'                    TO TRLR-TYPE.
 15554     GO TO 7900-READ-TRAILER-UPDATE.
 15555
 15556 7900-READ-NINETY-UPDATE.
 15557     MOVE MSTR-COMP-CD           TO TRLR-COMP-CD.
 15558     MOVE MSTR-CARRIER           TO TRLR-CARRIER.
 15559     MOVE MSTR-CLAIM-NO          TO TRLR-CLAIM-NO.
 15560     MOVE MSTR-CERT-NO           TO TRLR-CERT-NO.
 15561     MOVE +90                    TO TRLR-SEQ-NO.
 15562     MOVE '6'                    TO TRLR-TYPE.
 15563
 15564 7900-READ-TRAILER-UPDATE.
 15565
 15566
 15567* EXEC CICS READ  UPDATE
 15568*        DATASET    (ELTRLR-DSID)
 15569*        SET        (ADDRESS OF ACTIVITY-TRAILERS)
 15570*        RIDFLD     (ELTRLR-KEY)
 15571*    END-EXEC.
 15572*    MOVE '&"S        EU         (   #00013831' TO DFHEIV0
 15573     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15574     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15575     MOVE X'2020233030303133383331' TO DFHEIV0(25:11)
 15576     CALL 'kxdfhei1' USING DFHEIV0,
 15577           ELTRLR-DSID,
 15578           DFHEIV20,
 15579           DFHEIV99,
 15580           ELTRLR-KEY,
 15581           DFHEIV99,
 15582           DFHEIV99,
 15583           DFHEIV99
 15584     SET ADDRESS OF ACTIVITY-TRAILERS TO
 15585         DFHEIV20
 15586     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15587
 15588
 15589 7900-EXIT.
 15590      EXIT.
 15591
 15592 7910-READ-ACTV.
 15593     MOVE MSTR-COMP-CD           TO TRLR-COMP-CD.
 15594     MOVE MSTR-CARRIER           TO TRLR-CARRIER.
 15595     MOVE MSTR-CLAIM-NO          TO TRLR-CLAIM-NO.
 15596     MOVE MSTR-CERT-NO           TO TRLR-CERT-NO.
 15597     MOVE +0                     TO TRLR-SEQ-NO.
 15598     MOVE '1'                    TO TRLR-TYPE.
 15599     GO TO 7910-READ-TRAILER.
 15600
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 296
* EL130.cbl
 15601 7910-READ-NINETY.
 15602     MOVE MSTR-COMP-CD           TO TRLR-COMP-CD.
 15603     MOVE MSTR-CARRIER           TO TRLR-CARRIER.
 15604     MOVE MSTR-CLAIM-NO          TO TRLR-CLAIM-NO.
 15605     MOVE MSTR-CERT-NO           TO TRLR-CERT-NO.
 15606     MOVE +90                    TO TRLR-SEQ-NO.
 15607     MOVE '6'                    TO TRLR-TYPE.
 15608
 15609 7910-READ-TRAILER.
 15610     MOVE 'TRLR'                 TO FILE-SWITCH.
 15611
 15612
 15613
 15614* EXEC CICS READ
 15615*        DATASET   (ELTRLR-DSID)
 15616*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 15617*        RIDFLD    (ELTRLR-KEY)
 15618*    END-EXEC.
 15619*    MOVE '&"S        E          (   #00013861' TO DFHEIV0
 15620     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15621     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15622     MOVE X'2020233030303133383631' TO DFHEIV0(25:11)
 15623     CALL 'kxdfhei1' USING DFHEIV0,
 15624           ELTRLR-DSID,
 15625           DFHEIV20,
 15626           DFHEIV99,
 15627           ELTRLR-KEY,
 15628           DFHEIV99,
 15629           DFHEIV99,
 15630           DFHEIV99
 15631     SET ADDRESS OF ACTIVITY-TRAILERS TO
 15632         DFHEIV20
 15633     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15634
 15635
 15636 7910-EXIT.
 15637      EXIT.
 15638
 15639 7915-REWRITE-TRAILER.
 15640
 15641
 15642* EXEC CICS REWRITE
 15643*        DATASET   (ELTRLR-DSID)
 15644*        FROM      (ACTIVITY-TRAILERS)
 15645*    END-EXEC.
 15646     MOVE LENGTH OF
 15647      ACTIVITY-TRAILERS
 15648       TO DFHEIV11
 15649*    MOVE '&& L                  %   #00013872' TO DFHEIV0
 15650     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15651     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15652     MOVE X'2020233030303133383732' TO DFHEIV0(25:11)
 15653     CALL 'kxdfhei1' USING DFHEIV0,
 15654           ELTRLR-DSID,
 15655           ACTIVITY-TRAILERS,
 15656           DFHEIV11,
 15657           DFHEIV99
 15658     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 297
* EL130.cbl
 15659
 15660
 15661 7915-EXIT.
 15662      EXIT.
 15663
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 298
* EL130.cbl
 15665********************************************
 15666*  I/O REQUESTS AGAINST CLAIM MASTER FILE  *
 15667********************************************
 15668
 15669 7920-READ-CLAIM-UPDATE.
 15670
 15671
 15672
 15673* EXEC CICS READ
 15674*        UPDATE
 15675*        DATASET   (ELMSTR-DSID)
 15676*        SET       (ADDRESS OF CLAIM-MASTER)
 15677*        RIDFLD    (ELMSTR-KEY)
 15678*    END-EXEC.
 15679*    MOVE '&"S        EU         (   #00013888' TO DFHEIV0
 15680     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15681     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15682     MOVE X'2020233030303133383838' TO DFHEIV0(25:11)
 15683     CALL 'kxdfhei1' USING DFHEIV0,
 15684           ELMSTR-DSID,
 15685           DFHEIV20,
 15686           DFHEIV99,
 15687           ELMSTR-KEY,
 15688           DFHEIV99,
 15689           DFHEIV99,
 15690           DFHEIV99
 15691     SET ADDRESS OF CLAIM-MASTER TO
 15692         DFHEIV20
 15693     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15694
 15695
 15696 7920-EXIT.
 15697      EXIT.
 15698
 15699 7950-READ-CLAIM.
 15700
 15701
 15702* EXEC CICS READ
 15703*        DATASET   (ELMSTR-DSID)
 15704*        SET       (ADDRESS OF CLAIM-MASTER)
 15705*        RIDFLD    (ELMSTR-KEY)
 15706*    END-EXEC.
 15707*    MOVE '&"S        E          (   #00013900' TO DFHEIV0
 15708     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15709     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15710     MOVE X'2020233030303133393030' TO DFHEIV0(25:11)
 15711     CALL 'kxdfhei1' USING DFHEIV0,
 15712           ELMSTR-DSID,
 15713           DFHEIV20,
 15714           DFHEIV99,
 15715           ELMSTR-KEY,
 15716           DFHEIV99,
 15717           DFHEIV99,
 15718           DFHEIV99
 15719     SET ADDRESS OF CLAIM-MASTER TO
 15720         DFHEIV20
 15721     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15722
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 299
* EL130.cbl
 15723
 15724 7950-EXIT.
 15725      EXIT.
 15726
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 300
* EL130.cbl
 15728***************************************
 15729*  I/O REQUESTS AGAINST CONTROL FILE  *
 15730***************************************
 15731
 15732 7960-READ-CNTL-UPDATE.
 15733
 15734
 15735* EXEC CICS READ
 15736*        UPDATE
 15737*        DATASET  (ELCNTL-DSID)
 15738*        SET      (ADDRESS OF CONTROL-FILE)
 15739*        RIDFLD   (ELCNTL-KEY)
 15740*    END-EXEC.
 15741*    MOVE '&"S        EU         (   #00013916' TO DFHEIV0
 15742     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15743     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15744     MOVE X'2020233030303133393136' TO DFHEIV0(25:11)
 15745     CALL 'kxdfhei1' USING DFHEIV0,
 15746           ELCNTL-DSID,
 15747           DFHEIV20,
 15748           DFHEIV99,
 15749           ELCNTL-KEY,
 15750           DFHEIV99,
 15751           DFHEIV99,
 15752           DFHEIV99
 15753     SET ADDRESS OF CONTROL-FILE TO
 15754         DFHEIV20
 15755     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15756
 15757
 15758 7960-EXIT.
 15759      EXIT.
 15760
 15761 7970-READ-CNTL.
 15762
 15763
 15764* EXEC CICS READ
 15765*        DATASET  (ELCNTL-DSID)
 15766*        SET      (ADDRESS OF CONTROL-FILE)
 15767*        RIDFLD   (ELCNTL-KEY)
 15768*    END-EXEC.
 15769*    MOVE '&"S        E          (   #00013928' TO DFHEIV0
 15770     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15771     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15772     MOVE X'2020233030303133393238' TO DFHEIV0(25:11)
 15773     CALL 'kxdfhei1' USING DFHEIV0,
 15774           ELCNTL-DSID,
 15775           DFHEIV20,
 15776           DFHEIV99,
 15777           ELCNTL-KEY,
 15778           DFHEIV99,
 15779           DFHEIV99,
 15780           DFHEIV99
 15781     SET ADDRESS OF CONTROL-FILE TO
 15782         DFHEIV20
 15783     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15784
 15785
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 301
* EL130.cbl
 15786 7970-EXIT.
 15787      EXIT.
 15788
 15789 7975-READ-CNTL-GTEQ.
 15790
 15791
 15792* EXEC CICS READ
 15793*         DATASET   (ELCNTL-DSID)
 15794*         SET       (ADDRESS OF CONTROL-FILE)
 15795*         RIDFLD    (ELCNTL-KEY)
 15796*         GTEQ
 15797*     END-EXEC.
 15798*    MOVE '&"S        G          (   #00013939' TO DFHEIV0
 15799     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 15800     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15801     MOVE X'2020233030303133393339' TO DFHEIV0(25:11)
 15802     CALL 'kxdfhei1' USING DFHEIV0,
 15803           ELCNTL-DSID,
 15804           DFHEIV20,
 15805           DFHEIV99,
 15806           ELCNTL-KEY,
 15807           DFHEIV99,
 15808           DFHEIV99,
 15809           DFHEIV99
 15810     SET ADDRESS OF CONTROL-FILE TO
 15811         DFHEIV20
 15812     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15813
 15814
 15815 7975-EXIT.
 15816      EXIT.
 15817
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 302
* EL130.cbl
 15819**************************************************
 15820*  I/O REQUESTS AGAINST CERTIFICATE MASTER FILE  *
 15821**************************************************
 15822
 15823 7980-READ-CERT5.
 15824
 15825
 15826* EXEC CICS READ
 15827*         DATASET  (ELCERT5-DSID)
 15828*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 15829*         RIDFLD   (ELCERT-KEY-5)
 15830*     END-EXEC.
 15831*    MOVE '&"S        E          (   #00013956' TO DFHEIV0
 15832     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15833     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15834     MOVE X'2020233030303133393536' TO DFHEIV0(25:11)
 15835     CALL 'kxdfhei1' USING DFHEIV0,
 15836           ELCERT5-DSID,
 15837           DFHEIV20,
 15838           DFHEIV99,
 15839           ELCERT-KEY-5,
 15840           DFHEIV99,
 15841           DFHEIV99,
 15842           DFHEIV99
 15843     SET ADDRESS OF CERTIFICATE-MASTER TO
 15844         DFHEIV20
 15845     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15846
 15847
 15848 7980-EXIT.
 15849      EXIT.
 15850
 15851 7930-READ-CERT-UPDATE.
 15852
 15853
 15854* EXEC CICS READ
 15855*        DATASET  (ELCERT-DSID)
 15856*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 15857*        RIDFLD   (ELCERT-KEY)
 15858*        UPDATE
 15859*    END-EXEC.
 15860*    MOVE '&"S        EU         (   #00013967' TO DFHEIV0
 15861     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15862     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15863     MOVE X'2020233030303133393637' TO DFHEIV0(25:11)
 15864     CALL 'kxdfhei1' USING DFHEIV0,
 15865           ELCERT-DSID,
 15866           DFHEIV20,
 15867           DFHEIV99,
 15868           ELCERT-KEY,
 15869           DFHEIV99,
 15870           DFHEIV99,
 15871           DFHEIV99
 15872     SET ADDRESS OF CERTIFICATE-MASTER TO
 15873         DFHEIV20
 15874     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15875
 15876
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 303
* EL130.cbl
 15877 7930-EXIT.
 15878      EXIT.
 15879
 15880 7940-READ-CERT.
 15881
 15882
 15883* EXEC CICS READ
 15884*        DATASET  (ELCERT-DSID)
 15885*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 15886*        RIDFLD   (ELCERT-KEY)
 15887*    END-EXEC.
 15888*    MOVE '&"S        E          (   #00013979' TO DFHEIV0
 15889     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15890     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15891     MOVE X'2020233030303133393739' TO DFHEIV0(25:11)
 15892     CALL 'kxdfhei1' USING DFHEIV0,
 15893           ELCERT-DSID,
 15894           DFHEIV20,
 15895           DFHEIV99,
 15896           ELCERT-KEY,
 15897           DFHEIV99,
 15898           DFHEIV99,
 15899           DFHEIV99
 15900     SET ADDRESS OF CERTIFICATE-MASTER TO
 15901         DFHEIV20
 15902     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15903
 15904
 15905 7940-EXIT.
 15906      EXIT.
 15907
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 304
* EL130.cbl
 15909**************************************************
 15910*  I/O REQUESTS AGAINST BENEFICIARY MASTER FILE  *
 15911**************************************************
 15912
 15913 7991-READ-BENE.
 15914
 15915
 15916* EXEC CICS READ
 15917*         DATASET   (ELBENE-DSID)
 15918*         SET       (ADDRESS OF BENEFICIARY-MASTER)
 15919*         RIDFLD    (ELBENE-KEY)
 15920*     END-EXEC.
 15921*    MOVE '&"S        E          (   #00013995' TO DFHEIV0
 15922     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15923     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15924     MOVE X'2020233030303133393935' TO DFHEIV0(25:11)
 15925     CALL 'kxdfhei1' USING DFHEIV0,
 15926           ELBENE-DSID,
 15927           DFHEIV20,
 15928           DFHEIV99,
 15929           ELBENE-KEY,
 15930           DFHEIV99,
 15931           DFHEIV99,
 15932           DFHEIV99
 15933     SET ADDRESS OF BENEFICIARY-MASTER TO
 15934         DFHEIV20
 15935     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15936
 15937
 15938 7991-EXIT.
 15939      EXIT.
 15940
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 305
* EL130.cbl
 15942**************************************************
 15943*  I/O REQUESTS AGAINST REINSURANCE MASTER FILE  *
 15944**************************************************
 15945
 15946 7992-READ-REIN.
 15947
 15948
 15949
 15950* EXEC CICS HANDLE CONDITION
 15951*        NOTFND   (7992-NOT-FOUND)
 15952*    END-EXEC.
 15953*    MOVE '"$I                   ! L #00014012' TO DFHEIV0
 15954     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15955     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15956     MOVE X'4C20233030303134303132' TO DFHEIV0(25:11)
 15957     CALL 'kxdfhei1' USING DFHEIV0
 15958     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15959
 15960
 15961
 15962
 15963* EXEC CICS READ
 15964*        DATASET   (ERREIN-DSID)
 15965*        SET       (ADDRESS OF REINSURANCE-RECORD)
 15966*        RIDFLD    (ERREIN-KEY)
 15967*    END-EXEC.
 15968*    MOVE '&"S        E          (   #00014017' TO DFHEIV0
 15969     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15970     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15971     MOVE X'2020233030303134303137' TO DFHEIV0(25:11)
 15972     CALL 'kxdfhei1' USING DFHEIV0,
 15973           ERREIN-DSID,
 15974           DFHEIV20,
 15975           DFHEIV99,
 15976           ERREIN-KEY,
 15977           DFHEIV99,
 15978           DFHEIV99,
 15979           DFHEIV99
 15980     SET ADDRESS OF REINSURANCE-RECORD TO
 15981         DFHEIV20
 15982     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15983
 15984
 15985     MOVE 'Y'                       TO  WS-REIN-REC-FOUND-SW.
 15986
 15987     GO TO 7992-EXIT.
 15988
 15989 7992-NOT-FOUND.
 15990     MOVE 'N'                       TO  WS-REIN-REC-FOUND-SW.
 15991
 15992 7992-EXIT.
 15993     EXIT.
 15994
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 306
* EL130.cbl
 15996 8000-LOAD-ERROR-MESSAGES.
 15997     MOVE SPACES                 TO ERRMSG1O  ERRMSG2O.
 15998
 15999     IF EMI-NO-ERRORS
 16000         GO TO 8000-EXIT
 16001     END-IF.
 16002
 16003     perform varying e1 from +1 by +1 until e1 > +3
 16004        if emi-error-number (e1) = '1651' or '1652' or '1653'
 16005                                or '1655' or '1660'
 16006           move 'W'              to emi-severity (e1)
 16007        end-if
 16008     end-perform
 16009     IF EMI-NUMBER-OF-LINES = 1
 16010         MOVE EMI-LINE1          TO ERRMSG1O
 16011         GO TO 8000-EXIT
 16012     END-IF.
 16013
 16014     IF EMI-NUMBER-OF-LINES = 2
 16015          MOVE EMI-LINE1         TO ERRMSG1O
 16016          MOVE EMI-LINE2         TO ERRMSG2O
 16017          GO TO 8000-EXIT
 16018     END-IF.
 16019
 16020     MOVE EMI-LINE1              TO ERRMSG1O.
 16021
 16022 8000-EXIT.
 16023     EXIT.
 16024
 16025 8100-SEND-INITIAL-MAP.
 16026     MOVE SAVE-DATE              TO RUNDTEO.
 16027     MOVE EIBTIME                TO TIME-IN.
 16028     MOVE TIME-OUT               TO RUNTIMEO.
 16029     IF RETURNED-FROM = XCTL-114
 16030        CONTINUE
 16031     ELSE
 16032        MOVE -1                  TO MAINTL
 16033     END-IF.
 16034
 16035*    IF PI-COMPANY-ID NOT = 'ACC' AND 'FDL' AND 'LGX'
 16036         MOVE SPACES             TO PRODO.
 16037         MOVE AL-SANOF           TO PRODCDA.
 16038*    END-IF.
 16039
 16040     MOVE PI-COMPANY-ID          TO COMPO.
 16041     MOVE AL-PABOF               TO COMPA.
 16042     MOVE PI-MEMBER-CAPTION      TO MEMCAPO.
 16043     MOVE PI-LIFE-OVERRIDE-L6    TO LCVDSCRO.
 16044     MOVE PI-AH-OVERRIDE-L6      TO ACVDSCRO.
 16045
 16046     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 16047
 16048     IF NOT PI-NO-CARRIER-SECURITY
 16049        MOVE PI-CARRIER-SECURITY TO CLMCARRO
 16050        MOVE AL-SABOF            TO CLMCARRA
 16051     END-IF.
 16052
 16053     IF PI-PROCESSOR-ID = 'PEMA'
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 307
* EL130.cbl
 16054        MOVE AL-UANON            TO CERTNOA
 16055                                    SUFXA
 16056     END-IF.
 16057*    IF PI-COMPANY-ID  = 'CRI' OR 'LGX' OR 'NCL' OR 'HAN'
 16058*        NEXT SENTENCE
 16059*        CONTINUE
 16060*    ELSE
 16061         MOVE AL-SANOF           TO LCVRATEA  ACVRATEA
 16062*    END-IF.
 16063
 16064
 16065
 16066* EXEC CICS SEND
 16067*        MAP     (MAP-NAME)
 16068*        MAPSET  (MAPSET-NAME)
 16069*        FROM    (EL130AO)
 16070*        ERASE
 16071*        CURSOR
 16072*    END-EXEC.
 16073     MOVE LENGTH OF
 16074      EL130AO
 16075       TO DFHEIV12
 16076     MOVE -1
 16077       TO DFHEIV11
 16078*    MOVE '8$     CT  E    H L F ,   #00014103' TO DFHEIV0
 16079     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 16080     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 16081     MOVE X'2020233030303134313033' TO DFHEIV0(25:11)
 16082     CALL 'kxdfhei1' USING DFHEIV0,
 16083           MAP-NAME,
 16084           EL130AO,
 16085           DFHEIV12,
 16086           MAPSET-NAME,
 16087           DFHEIV99,
 16088           DFHEIV99,
 16089           DFHEIV99,
 16090           DFHEIV11,
 16091           DFHEIV99,
 16092           DFHEIV99,
 16093           DFHEIV99
 16094     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16095
 16096
 16097     GO TO 9100-RETURN-TRAN.
 16098
 16099 8150-SEND-MAP-CURSOR.
 16100     MOVE SAVE-DATE              TO RUNDTEO.
 16101     MOVE EIBTIME                TO TIME-IN.
 16102     MOVE TIME-OUT               TO RUNTIMEO.
 16103     MOVE PI-COMPANY-ID          TO COMPO.
 16104     MOVE AL-PABOF               TO COMPA
 16105     MOVE PI-MEMBER-CAPTION      TO MEMCAPO.
 16106     MOVE PI-LIFE-OVERRIDE-L6    TO LCVDSCRO.
 16107     MOVE PI-AH-OVERRIDE-L6      TO ACVDSCRO.
 16108
 16109*    IF PI-COMPANY-ID NOT = 'ACC' AND 'FDL' AND 'LGX'
 16110         MOVE SPACES             TO PRODO.
 16111         MOVE AL-SANOF           TO PRODCDA.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 308
* EL130.cbl
 16112*    END-IF.
 16113
 16114     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 16115
 16116     IF NOT PI-NO-CARRIER-SECURITY
 16117         MOVE PI-CARRIER-SECURITY TO CLMCARRO
 16118         MOVE AL-SABOF            TO CLMCARRA
 16119     END-IF.
 16120
 16121     IF PI-PROCESSOR-ID = 'PEMA'
 16122        MOVE AL-UANON            TO CERTNOA
 16123                                    SUFXA
 16124     END-IF.
 16125*    IF PI-COMPANY-ID  = 'CRI' OR 'LGX' OR 'NCL' OR 'HAN'
 16126*        NEXT SENTENCE
 16127*        CONTINUE
 16128*    ELSE
 16129         MOVE AL-SANOF           TO LCVRATEA  ACVRATEA
 16130*    END-IF.
 16131
 16132
 16133
 16134* EXEC CICS SEND
 16135*        MAP      (MAP-NAME)
 16136*        MAPSET   (MAPSET-NAME)
 16137*        FROM     (EL130AO)
 16138*        CURSOR   (PI-CURSOR)
 16139*        ERASE
 16140*    END-EXEC.
 16141     MOVE LENGTH OF
 16142      EL130AO
 16143       TO DFHEIV11
 16144*    MOVE '8$     CT  E    H L F ,   #00014147' TO DFHEIV0
 16145     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 16146     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 16147     MOVE X'2020233030303134313437' TO DFHEIV0(25:11)
 16148     CALL 'kxdfhei1' USING DFHEIV0,
 16149           MAP-NAME,
 16150           EL130AO,
 16151           DFHEIV11,
 16152           MAPSET-NAME,
 16153           DFHEIV99,
 16154           DFHEIV99,
 16155           DFHEIV99,
 16156           PI-CURSOR,
 16157           DFHEIV99,
 16158           DFHEIV99,
 16159           DFHEIV99
 16160     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16161
 16162
 16163     GO TO 9100-RETURN-TRAN.
 16164
 16165 8200-SEND-DATAONLY.
 16166     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 16167
 16168     IF EIBAID = DFHPF11
 16169        MOVE 'Y'                 TO EMI-ROLL-SWITCH
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 309
* EL130.cbl
 16170        move pi-last-claim       to emi-claim-no
 16171        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16172        go to 8100-send-initial-map
 16173     END-IF.
 16174
 16175 8200-BYPASS-ERROR.
 16176     MOVE SAVE-DATE              TO RUNDTEO.
 16177     MOVE EIBTIME                TO TIME-IN.
 16178     MOVE TIME-OUT               TO RUNTIMEO.
 16179     MOVE PI-COMPANY-ID          TO COMPO.
 16180     MOVE AL-PABOF               TO COMPA
 16181     MOVE PI-MEMBER-CAPTION      TO MEMCAPO.
 16182
 16183*    IF PI-COMPANY-ID NOT = 'ACC' AND 'FDL' AND 'LGX'
 16184         MOVE SPACES             TO PRODO.
 16185         MOVE AL-SANOF           TO PRODCDA.
 16186*    END-IF.
 16187
 16188     MOVE PI-LIFE-OVERRIDE-L6    TO LCVDSCRO.
 16189     MOVE PI-AH-OVERRIDE-L6      TO ACVDSCRO.
 16190
 16191     IF PI-PROCESSOR-ID = 'PEMA'
 16192        MOVE AL-UANON            TO CERTNOA
 16193                                    SUFXA
 16194     END-IF.
 16195     IF NOT PI-NO-CARRIER-SECURITY
 16196        MOVE PI-CARRIER-SECURITY TO CLMCARRO
 16197        MOVE AL-SABOF            TO CLMCARRA
 16198     END-IF.
 16199
 16200*    IF PI-COMPANY-ID  = 'CRI' OR 'LGX' OR 'NCL' OR 'HAN'
 16201*        NEXT SENTENCE
 16202*        CONTINUE
 16203*    ELSE
 16204         MOVE AL-SANOF           TO LCVRATEA  ACVRATEA
 16205*    END-IF.
 16206
 16207*    IF PI-COMPANY-ID NOT = 'ACC' AND 'FDL'
 16208         MOVE AL-SANOF           TO PRODCDA.
 16209*    END-IF.
 16210
 16211
 16212
 16213* EXEC CICS SEND
 16214*        MAP      (MAP-NAME)
 16215*        MAPSET   (MAPSET-NAME)
 16216*        FROM     (EL130AO)
 16217*        DATAONLY
 16218*        CURSOR
 16219*    END-EXEC.
 16220     MOVE LENGTH OF
 16221      EL130AO
 16222       TO DFHEIV12
 16223     MOVE -1
 16224       TO DFHEIV11
 16225*    MOVE '8$D    CT       H L F ,   #00014204' TO DFHEIV0
 16226     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 16227     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 310
* EL130.cbl
 16228     MOVE X'2020233030303134323034' TO DFHEIV0(25:11)
 16229     CALL 'kxdfhei1' USING DFHEIV0,
 16230           MAP-NAME,
 16231           EL130AO,
 16232           DFHEIV12,
 16233           MAPSET-NAME,
 16234           DFHEIV99,
 16235           DFHEIV99,
 16236           DFHEIV99,
 16237           DFHEIV11,
 16238           DFHEIV99,
 16239           DFHEIV99,
 16240           DFHEIV99
 16241     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16242
 16243
 16244     GO TO 9100-RETURN-TRAN.
 16245
 16246 8300-SEND-TEXT.
 16247
 16248
 16249* EXEC CICS SEND TEXT
 16250*        FROM     (LOGOFF-TEXT)
 16251*        LENGTH   (LOGOFF-LENGTH)
 16252*        ERASE
 16253*        FREEKB
 16254*    END-EXEC.
 16255*    MOVE '8&      T  E F  H   F -   #00014216' TO DFHEIV0
 16256     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 16257     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 16258     MOVE X'2020233030303134323136' TO DFHEIV0(25:11)
 16259     CALL 'kxdfhei1' USING DFHEIV0,
 16260           LOGOFF-TEXT,
 16261           LOGOFF-LENGTH,
 16262           DFHEIV99,
 16263           DFHEIV99,
 16264           DFHEIV99,
 16265           DFHEIV99,
 16266           DFHEIV99,
 16267           DFHEIV99,
 16268           DFHEIV99,
 16269           DFHEIV99,
 16270           DFHEIV99,
 16271           DFHEIV99
 16272     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16273
 16274
 16275
 16276
 16277* EXEC CICS RETURN
 16278*    END-EXEC.
 16279*    MOVE '.(                    ''   #00014224' TO DFHEIV0
 16280     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 16281     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16282     MOVE X'2020233030303134323234' TO DFHEIV0(25:11)
 16283     CALL 'kxdfhei1' USING DFHEIV0,
 16284           DFHEIV99,
 16285           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 311
* EL130.cbl
 16286           DFHEIV99,
 16287           DFHEIV99,
 16288           DFHEIV99,
 16289           DFHEIV99
 16290     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16291
 16292
 16293 8800-UNAUTHORIZED-ACCESS.
 16294     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 16295     GO TO 8300-SEND-TEXT.
 16296
 16297 8810-PF23.
 16298     MOVE EIBAID TO PI-ENTRY-CD-1.
 16299     MOVE XCTL-005               TO PGM-NAME.
 16300     GO TO 9300-XCTL.
 16301
 16302 8820-TERM-ERROR.
 16303     MOVE ER-0412                TO EMI-ERROR.
 16304     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16305     MOVE -1                     TO MAINTL.
 16306     GO TO 8200-SEND-DATAONLY.
 16307
 16308 8830-TRAN-ERROR.
 16309     MOVE ER-0413                TO EMI-ERROR.
 16310     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16311     MOVE -1                     TO MAINTL.
 16312     GO TO 8200-SEND-DATAONLY.
 16313
 16314 9000-RETURN-CICS.
 16315
 16316
 16317* EXEC CICS RETURN
 16318*    END-EXEC.
 16319*    MOVE '.(                    ''   #00014250' TO DFHEIV0
 16320     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 16321     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16322     MOVE X'2020233030303134323530' TO DFHEIV0(25:11)
 16323     CALL 'kxdfhei1' USING DFHEIV0,
 16324           DFHEIV99,
 16325           DFHEIV99,
 16326           DFHEIV99,
 16327           DFHEIV99,
 16328           DFHEIV99,
 16329           DFHEIV99
 16330     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16331
 16332
 16333 9100-RETURN-TRAN.
 16334     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 16335     MOVE '130A'                 TO PI-CURRENT-SCREEN-NO.
 16336
 16337
 16338
 16339* EXEC CICS RETURN
 16340*        TRANSID   (TRANS-ID)
 16341*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
 16342*        LENGTH    (PI-COMM-LENGTH)
 16343*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 312
* EL130.cbl
 16344*    MOVE '.(CT                  ''   #00014258' TO DFHEIV0
 16345     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 16346     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16347     MOVE X'2020233030303134323538' TO DFHEIV0(25:11)
 16348     CALL 'kxdfhei1' USING DFHEIV0,
 16349           TRANS-ID,
 16350           PROGRAM-INTERFACE-BLOCK,
 16351           PI-COMM-LENGTH,
 16352           DFHEIV99,
 16353           DFHEIV99,
 16354           DFHEIV99
 16355     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16356
 16357
 16358 9200-RETURN-MAIN-MENU.
 16359     MOVE XCTL-126               TO PGM-NAME.
 16360     GO TO 9300-XCTL.
 16361
 16362 9300-XCTL.
 16363
 16364
 16365* EXEC CICS XCTL
 16366*        PROGRAM   (PGM-NAME)
 16367*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
 16368*        LENGTH    (PI-COMM-LENGTH)
 16369*    END-EXEC.
 16370*    MOVE '.$C                   %   #00014270' TO DFHEIV0
 16371     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 16372     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16373     MOVE X'2020233030303134323730' TO DFHEIV0(25:11)
 16374     CALL 'kxdfhei1' USING DFHEIV0,
 16375           PGM-NAME,
 16376           PROGRAM-INTERFACE-BLOCK,
 16377           PI-COMM-LENGTH,
 16378           DFHEIV99
 16379     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16380
 16381
 16382 9400-CLEAR.
 16383     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
 16384     GO TO 9300-XCTL.
 16385
 16386 9500-PF12.
 16387     MOVE XCTL-010               TO PGM-NAME.
 16388     GO TO 9300-XCTL.
 16389
 16390 9600-PGMID-ERROR.
 16391
 16392
 16393* EXEC CICS HANDLE CONDITION
 16394*        PGMIDERR  (8300-SEND-TEXT)
 16395*    END-EXEC.
 16396*    MOVE '"$L                   ! M #00014286' TO DFHEIV0
 16397     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 16398     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16399     MOVE X'4D20233030303134323836' TO DFHEIV0(25:11)
 16400     CALL 'kxdfhei1' USING DFHEIV0
 16401     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 313
* EL130.cbl
 16402
 16403
 16404     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
 16405     MOVE ' '                    TO PI-ENTRY-CD-1.
 16406     MOVE XCTL-005               TO PGM-NAME.
 16407     MOVE PGM-NAME               TO LOGOFF-PGM.
 16408     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
 16409     GO TO 9300-XCTL.
 16410
 16411 9700-LINK-DATE-CONVERT.
 16412     MOVE LINK-ELDATCV           TO PGM-NAME.
 16413
 16414
 16415* EXEC CICS LINK
 16416*        PROGRAM    (PGM-NAME)
 16417*        COMMAREA   (DATE-CONVERSION-DATA)
 16418*        LENGTH     (DC-COMM-LENGTH)
 16419*    END-EXEC.
 16420*    MOVE '."C                   (   #00014300' TO DFHEIV0
 16421     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16422     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16423     MOVE X'2020233030303134333030' TO DFHEIV0(25:11)
 16424     CALL 'kxdfhei1' USING DFHEIV0,
 16425           PGM-NAME,
 16426           DATE-CONVERSION-DATA,
 16427           DC-COMM-LENGTH,
 16428           DFHEIV99,
 16429           DFHEIV99,
 16430           DFHEIV99,
 16431           DFHEIV99
 16432     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16433
 16434
 16435 9700-EXIT.
 16436     EXIT.
 16437
 16438 9800-LINK-REM-TERM.
 16439     MOVE LINK-ELRTRM            TO PGM-NAME.
 16440
 16441
 16442* EXEC CICS LINK
 16443*        PROGRAM    (PGM-NAME)
 16444*        COMMAREA   (CALCULATION-PASS-AREA)
 16445*        LENGTH     (CP-COMM-LENGTH)
 16446*    END-EXEC.
 16447*    MOVE '."C                   (   #00014312' TO DFHEIV0
 16448     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16449     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16450     MOVE X'2020233030303134333132' TO DFHEIV0(25:11)
 16451     CALL 'kxdfhei1' USING DFHEIV0,
 16452           PGM-NAME,
 16453           CALCULATION-PASS-AREA,
 16454           CP-COMM-LENGTH,
 16455           DFHEIV99,
 16456           DFHEIV99,
 16457           DFHEIV99,
 16458           DFHEIV99
 16459     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 314
* EL130.cbl
 16460
 16461
 16462 9800-EXIT.
 16463     EXIT.
 16464
 16465 9900-ERROR-FORMAT.
 16466*    if emi-error = 1651 or 1652 or 1653 or 1655
 16467*       display ' 9900 error ' emi-error
 16468*       display emi-message-area (1)
 16469*       display emi-message-area (2)
 16470*       display emi-message-area (3)
 16471*    end-if
 16472     IF NOT EMI-ERRORS-COMPLETE
 16473         MOVE LINK-001           TO PGM-NAME
 16474
 16475* EXEC CICS LINK
 16476*            PROGRAM   (PGM-NAME)
 16477*            COMMAREA  (ERROR-MESSAGE-INTERFACE-BLOCK)
 16478*            LENGTH    (EMI-COMM-LENGTH)
 16479*        END-EXEC
 16480*    MOVE '."C                   (   #00014330' TO DFHEIV0
 16481     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16482     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16483     MOVE X'2020233030303134333330' TO DFHEIV0(25:11)
 16484     CALL 'kxdfhei1' USING DFHEIV0,
 16485           PGM-NAME,
 16486           ERROR-MESSAGE-INTERFACE-BLOCK,
 16487           EMI-COMM-LENGTH,
 16488           DFHEIV99,
 16489           DFHEIV99,
 16490           DFHEIV99,
 16491           DFHEIV99
 16492     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16493         if emi-error = 1651 or 1652 or 1653 or 1655 or 1660
 16494            subtract 1 from emi-fatal-ctr
 16495         end-if
 16496     END-IF.
 16497
 16498     .
 16499 9900-EXIT.
 16500     EXIT.
 16501
 16502 9990-ABEND.
 16503     MOVE -1                     TO MAINTL.
 16504     MOVE LINK-004               TO PGM-NAME.
 16505     MOVE DFHEIBLK               TO EMI-LINE1.
 16506
 16507
 16508* EXEC CICS LINK
 16509*        PROGRAM   (PGM-NAME)
 16510*        COMMAREA  (EMI-LINE1)
 16511*        LENGTH    (72)
 16512*    END-EXEC.
 16513     MOVE 72
 16514       TO DFHEIV11
 16515*    MOVE '."C                   (   #00014349' TO DFHEIV0
 16516     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16517     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 315
* EL130.cbl
 16518     MOVE X'2020233030303134333439' TO DFHEIV0(25:11)
 16519     CALL 'kxdfhei1' USING DFHEIV0,
 16520           PGM-NAME,
 16521           EMI-LINE1,
 16522           DFHEIV11,
 16523           DFHEIV99,
 16524           DFHEIV99,
 16525           DFHEIV99,
 16526           DFHEIV99
 16527     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16528
 16529
 16530     MOVE EMI-LINE1              TO ERRMSG2O.
 16531
 16532     GO TO 8200-BYPASS-ERROR.
 16533
 16534
 16535
 16536* GOBACK.
 16537     MOVE '9%                    "   ' TO DFHEIV0
 16538     MOVE 'EL130' TO DFHEIV1
 16539     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 16540     GOBACK.
 16541
 16542 9995-SECURITY-VIOLATION.
 16543*             COPY ELCSCTP.
 16544******************************************************************
 16545*                                                                *
 16546*                            ELCSCTP                             *
 16547*                            VMOD=2.001                          *
 16548*                                                                *
 16549*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 16550******************************************************************
 16551
 16552
 16553     MOVE EIBDATE          TO SM-JUL-DATE.
 16554     MOVE EIBTRMID         TO SM-TERMID.
 16555     MOVE THIS-PGM         TO SM-PGM.
 16556     MOVE EIBTIME          TO TIME-IN.
 16557     MOVE TIME-OUT         TO SM-TIME.
 16558     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 16559
 16560
 16561* EXEC CICS LINK
 16562*         PROGRAM  ('EL003')
 16563*         COMMAREA (SECURITY-MESSAGE)
 16564*         LENGTH   (80)
 16565*    END-EXEC.
 16566     MOVE 'EL003' TO DFHEIV1
 16567     MOVE 80
 16568       TO DFHEIV11
 16569*    MOVE '."C                   (   #00014380' TO DFHEIV0
 16570     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16571     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16572     MOVE X'2020233030303134333830' TO DFHEIV0(25:11)
 16573     CALL 'kxdfhei1' USING DFHEIV0,
 16574           DFHEIV1,
 16575           SECURITY-MESSAGE,
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 316
* EL130.cbl
 16576           DFHEIV11,
 16577           DFHEIV99,
 16578           DFHEIV99,
 16579           DFHEIV99,
 16580           DFHEIV99
 16581     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16582
 16583
 16584******************************************************************
 16585
 16586
 16587 9995-EXIT.
 16588     EXIT.
 16589
 16590
 16591 9999-DFHBACK SECTION.
 16592     MOVE '9%                    "   ' TO DFHEIV0
 16593     MOVE 'EL130' TO DFHEIV1
 16594     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 16595     GOBACK.
 16596 9999-DFHEXIT.
 16597     IF DFHEIGDJ EQUAL 0001
 16598         NEXT SENTENCE
 16599     ELSE IF DFHEIGDJ EQUAL 2
 16600         GO TO 0100-TEST-ENTRY,
 16601               8100-SEND-INITIAL-MAP,
 16602               9600-PGMID-ERROR,
 16603               8820-TERM-ERROR,
 16604               8830-TRAN-ERROR,
 16605               9990-ABEND
 16606         DEPENDING ON DFHEIGDI
 16607     ELSE IF DFHEIGDJ EQUAL 3
 16608         GO TO 0450-ADD-ELACTQ-RECORD
 16609         DEPENDING ON DFHEIGDI
 16610     ELSE IF DFHEIGDJ EQUAL 4
 16611         GO TO 8820-TERM-ERROR,
 16612               8830-TRAN-ERROR
 16613         DEPENDING ON DFHEIGDI
 16614     ELSE IF DFHEIGDJ EQUAL 5
 16615         GO TO 0660-NOT-FOUND,
 16616               0670-QIDERR
 16617         DEPENDING ON DFHEIGDI
 16618     ELSE IF DFHEIGDJ EQUAL 6
 16619         GO TO 1025-SHOW-RECORD-NOT-FOUND
 16620         DEPENDING ON DFHEIGDI
 16621     ELSE IF DFHEIGDJ EQUAL 7
 16622         GO TO 1025-SHOW-RECORD-NOT-FOUND
 16623         DEPENDING ON DFHEIGDI
 16624     ELSE IF DFHEIGDJ EQUAL 8
 16625         GO TO 1025-SHOW-RECORD-NOT-FOUND
 16626         DEPENDING ON DFHEIGDI
 16627     ELSE IF DFHEIGDJ EQUAL 9
 16628         GO TO 1025-SHOW-RECORD-NOT-FOUND
 16629         DEPENDING ON DFHEIGDI
 16630     ELSE IF DFHEIGDJ EQUAL 10
 16631         GO TO 2050-DELETE-NOT-FOUND
 16632         DEPENDING ON DFHEIGDI
 16633     ELSE IF DFHEIGDJ EQUAL 11
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 317
* EL130.cbl
 16634         GO TO 2010-DELETE-CL
 16635         DEPENDING ON DFHEIGDI
 16636     ELSE IF DFHEIGDJ EQUAL 12
 16637         GO TO 3010-TEST-FOR-ERRORS
 16638         DEPENDING ON DFHEIGDI
 16639     ELSE IF DFHEIGDJ EQUAL 13
 16640         GO TO 3008-DUP-ERROR,
 16641               3009-NOT-FOUND
 16642         DEPENDING ON DFHEIGDI
 16643     ELSE IF DFHEIGDJ EQUAL 14
 16644         GO TO 3030-BUILD-CONT
 16645         DEPENDING ON DFHEIGDI
 16646     ELSE IF DFHEIGDJ EQUAL 15
 16647         GO TO 3033-ACCT-NOT-FOUND,
 16648               3033-ACCT-NOT-FOUND
 16649         DEPENDING ON DFHEIGDI
 16650     ELSE IF DFHEIGDJ EQUAL 16
 16651         GO TO 3032-NOT-IN-DT-RANGE
 16652         DEPENDING ON DFHEIGDI
 16653     ELSE IF DFHEIGDJ EQUAL 17
 16654         GO TO 3070-BUILD-CONT
 16655         DEPENDING ON DFHEIGDI
 16656     ELSE IF DFHEIGDJ EQUAL 18
 16657         GO TO 3065-CERT-NOT-FOUND
 16658         DEPENDING ON DFHEIGDI
 16659     ELSE IF DFHEIGDJ EQUAL 19
 16660         GO TO 3100-CARRIER-NOT-FOUND
 16661         DEPENDING ON DFHEIGDI
 16662     ELSE IF DFHEIGDJ EQUAL 20
 16663         GO TO 3110-COMPANY-NOT-FOUND
 16664         DEPENDING ON DFHEIGDI
 16665     ELSE IF DFHEIGDJ EQUAL 21
 16666         GO TO 3200-BUILD-ZERO-TRAILER
 16667         DEPENDING ON DFHEIGDI
 16668     ELSE IF DFHEIGDJ EQUAL 22
 16669         GO TO 9999-DFHBACK
 16670         DEPENDING ON DFHEIGDI
 16671     ELSE IF DFHEIGDJ EQUAL 23
 16672         GO TO 3290-NO-INSURED-ADDRESS
 16673         DEPENDING ON DFHEIGDI
 16674     ELSE IF DFHEIGDJ EQUAL 24
 16675         GO TO 3410-DUP-KEY
 16676         DEPENDING ON DFHEIGDI
 16677     ELSE IF DFHEIGDJ EQUAL 25
 16678         GO TO 3690-CERT-WRITTEN
 16679         DEPENDING ON DFHEIGDI
 16680     ELSE IF DFHEIGDJ EQUAL 26
 16681         GO TO 3850-CLAIM-MSTR-WRITTEN
 16682         DEPENDING ON DFHEIGDI
 16683     ELSE IF DFHEIGDJ EQUAL 27
 16684         GO TO 5050-CERT-NOT-FOUND
 16685         DEPENDING ON DFHEIGDI
 16686     ELSE IF DFHEIGDJ EQUAL 28
 16687         GO TO 5030-CERT-WRITTEN
 16688         DEPENDING ON DFHEIGDI
 16689     ELSE IF DFHEIGDJ EQUAL 29
 16690         GO TO 5035-CLAIM-WRITTEN
 16691         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 318
* EL130.cbl
 16692     ELSE IF DFHEIGDJ EQUAL 30
 16693         GO TO 9990-ABEND,
 16694               5799-EXIT
 16695         DEPENDING ON DFHEIGDI
 16696     ELSE IF DFHEIGDJ EQUAL 31
 16697         GO TO 3100-CARRIER-NOT-FOUND
 16698         DEPENDING ON DFHEIGDI
 16699     ELSE IF DFHEIGDJ EQUAL 32
 16700         GO TO 6040-NO-PROCESSOR-RECORD
 16701         DEPENDING ON DFHEIGDI
 16702     ELSE IF DFHEIGDJ EQUAL 33
 16703         GO TO 6060-NO-BENEFICIARY-RECORD
 16704         DEPENDING ON DFHEIGDI
 16705     ELSE IF DFHEIGDJ EQUAL 34
 16706         GO TO 6499-EXIT,
 16707               6499-EXIT
 16708         DEPENDING ON DFHEIGDI
 16709     ELSE IF DFHEIGDJ EQUAL 35
 16710         GO TO 6600-NOT-FOUND
 16711         DEPENDING ON DFHEIGDI
 16712     ELSE IF DFHEIGDJ EQUAL 36
 16713         GO TO 6700-NOTOPEN-ERROR,
 16714               6700-EXIT
 16715         DEPENDING ON DFHEIGDI
 16716     ELSE IF DFHEIGDJ EQUAL 37
 16717         GO TO 7120-NOT-FOUND
 16718         DEPENDING ON DFHEIGDI
 16719     ELSE IF DFHEIGDJ EQUAL 38
 16720         GO TO 7499-EXIT
 16721         DEPENDING ON DFHEIGDI
 16722     ELSE IF DFHEIGDJ EQUAL 39
 16723         GO TO 7500-EXIT,
 16724               7500-DUPLICATE-KEY,
 16725               7500-EXIT
 16726         DEPENDING ON DFHEIGDI
 16727     ELSE IF DFHEIGDJ EQUAL 40
 16728         GO TO 7500-END-BROWSE
 16729         DEPENDING ON DFHEIGDI
 16730     ELSE IF DFHEIGDJ EQUAL 41
 16731         GO TO 7630-END-BROWSE
 16732         DEPENDING ON DFHEIGDI
 16733     ELSE IF DFHEIGDJ EQUAL 42
 16734         GO TO 7799-EXIT,
 16735               7799-EXIT
 16736         DEPENDING ON DFHEIGDI
 16737     ELSE IF DFHEIGDJ EQUAL 43
 16738         GO TO 7790-END-BROWSE
 16739         DEPENDING ON DFHEIGDI
 16740     ELSE IF DFHEIGDJ EQUAL 44
 16741         GO TO 7992-NOT-FOUND
 16742         DEPENDING ON DFHEIGDI
 16743     ELSE IF DFHEIGDJ EQUAL 45
 16744         GO TO 8300-SEND-TEXT
 16745         DEPENDING ON DFHEIGDI.
 16746     MOVE '9%                    "   ' TO DFHEIV0
 16747     MOVE 'EL130' TO DFHEIV1
 16748     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 16749     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-14 10:16 Page 319
* EL130.cbl
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       12192     Code:       53099
