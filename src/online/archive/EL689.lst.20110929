* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page   1
* EL689.cbl
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INT"EL689.int" INTDATE"ANSI" INTLEVEL"2"
*          IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT KEYCHECK
*          KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL689.lst" LISTPATH""
*          LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME NOMAXERROR
*          METHODDEFAULT"REFERENCE" MF"13" MFCOMMENT NOMOVELENCHECK NOMS NOMVS
*          NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR NONEWBASENAME NONLS
*          NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE NOOLDBLANKLINE NOOLDCOPY
*          NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO NOOLDSTRMIX OOCTRL
*          "-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT"" NOOSVS NOOUTDD
*          NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST NOPREPROCESS
*          NOPRINT-EXT NOPROFILE NOPROGID-COMMENT NOPROGID-INT-NAME
*          NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL QUALPROC NOQUERY NOQUOTE
*          NORAWLIST NORDW RECMODE"F" NOREENTRANT NOREF NOREFNO REMAINDER"1"
*          REPORT-LINE"256" RESEQ NORETRYLOCK REWRITE-LS NORM RTNCODE-SIZE"4"
*          NORWHARDPAGE NOSAA SEG NOSEQCHK SEQUENTIAL"RECORD" NOSERIAL SETTING
*          "LINE" NOSHAREOUTDD NOSHOW-DIR SIGN"ASCII" NOSIGNFIXUP SORTTYPE
*          "DFSORT" SOURCEFORMAT"FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE
*          STDERR STICKY-LINKAGE"2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1"
*          SYMBSTART"1" SYSPUNCH"132" TERMPAGE TIME NOTRACE NOTRUNC
*          NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC"10" UNICODE"NATIVE" NOVERBOSE
*          VSC2"4" WARNING"1" NOWB NOWB2 NOWB3 WEBSERVER"CGI" NOWRITELOCK
*          NOWRITETHRU NOXOPEN NOXREF NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL689 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/20/94 15:10:07.
     7*                            VMOD=2.037
     8*
     9*AUTHOR.     LOGIC,INC.
    10*            DALLAS, TEXAS.
    11*DATE-COMPILED.
    12*REMARKS.    TRANSACTION - EXH3 - CREDIT LETTER WRITER.
    13*
    14******************************************************************
    15
    16* W-FILE-USED REFERENCE LIST:
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page   2
* EL689.cbl
    17* (1)  ELCNTL - COMPANY
    18* (2)  ELCNTL - LIFE BENEFIT
    19* (3)  ELCNTL - A&H BENEFIT
    20* (4)  ELCNTL - CARRIER
    21* (5)  MAIL
    22* (6)  ERACCT
    23* (7)  USED FOR SYSTEM VARIABLES ?
    24* (8)  ELCERT
    25* (9)  PENDING BUSINESS
    26* (10) COMPENSATION
    27* (11) ELCNTL - PROCESSOR DATA ?
    28* (12) ERCHEK
    29* (13) ERPYAJ
    30* (14) NOT USED
    31* (15) NOT USED
    32* (16) NOT USED
    33* (17) NOT USED
    34* (18) NOT USED
    35* (19) NOT USED
    36* (20) NOT USED
    37*
    38******************************************************************
    39*                   C H A N G E   L O G
    40*
    41* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    42*-----------------------------------------------------------------
    43*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    44* EFFECTIVE    NUMBER
    45*-----------------------------------------------------------------
    46* 101501    2001100100006  SMVA  ADD USERID to screen header
    47*                                ADJUSTED REDEFINES EL689AI FILLER
    48* 031504    2004020600009  SMVA  PULL MOST CURRENT ACCT ADDRESS
    49* 081004                   PEMA  CONVERT TO PSUEDO CONVERSATIONAL
    50* 100705    2004072800003  PEMA  ADD NEW VARIABLES
    51* 072308    2008062700001  PEMA  ADD NEW VARIABLES
    52* 092908    2008013100006  PEMA  MOVE VAR 154
    53* 102408  CR2008091000001  PEMA  MOVE PNDB VARS TO CERT VARS
    54* 051209  CR2009021700003  PEMA  ADD CRED BENE VARIABLES
    55* 051209  CR2009042700002  PEMA  ADD ERACCT ACCT NUMBER VARIABLE
    56* 022510  IR2009062300003  PEMA  ADD ENDFILE TEST TO ERACCT READ
    57* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
    58* 041811  CR2011010400001  PEMA  DISABLE PF8 FOR CERTAIN USERS
    59* 042011  CR2011010400001  PEMA  FIX CRED BENE ADDRESS LINES
    60* 061411  CR2011061300001  PEMA  ADD ALWA TO PF8 DISABLE LIST
    61******************************************************************
    62
    63 DATA DIVISION.
    64 WORKING-STORAGE SECTION.
    65 01  DFH-START PIC X(04).
    66 77  LCP-WS-ADDR-COMP              PIC x(4) comp-5 value 0.
    67 77  LCP-WS-ADDR-PNTR              REDEFINES LCP-WS-ADDR-COMP
    68                                   USAGE POINTER.
    69 77  FILLER  PIC X(32) VALUE '********************************'.
    70 77  FILLER  PIC X(32) VALUE '*    EL689 WORKING STORAGE     *'.
    71 77  FILLER  PIC X(32) VALUE '*********** VMOD=2.037 *********'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page   3
* EL689.cbl
    73
    74 01  W-WORK-AREAS.
    75     12  FILLER                  PIC  X(18)
    76                                      VALUE 'PROGRAM WORK AREA:'.
    77
    78     12  W-ASKTIME-CTR           PIC S9(04)  COMP   VALUE +0.
    79     12  W-CWA-NDX               PIC S9(04)  COMP   VALUE +0.
    80     12  W-DISPLAY-NDX           PIC S9(04)  COMP   VALUE +0.
    81     12  W-FIRST-BAD-VARIABLE    PIC S9(04)  COMP   VALUE +0.
    82     12  W-NDX                   PIC S9(04)  COMP   VALUE +0.
    83     12  W-NDX2                  PIC S9(04)  COMP   VALUE +0.
    84     12  W-SEQ-CTR               PIC S9(04)  COMP   VALUE +0.
    85     12  W-TS-ITEM               PIC S9(04)  COMP   VALUE +0.
    86     12  W-TOTAL-LINE-LENGTH     PIC S9(04)  COMP   VALUE +0.
    87     12  W-WORK-NDX              PIC S9(04)  COMP   VALUE +0.
    88
    89     12  W-ADJUST-SHORT          PIC S9(03) VALUE +0   COMP-3.
    90     12  W-DIFFERENCE            PIC S9(07)V9(02)
    91                                            VALUE +0   COMP-3.
    92     12  W-INITIAL-COLUMN        PIC S9(03) VALUE +0   COMP-3.
    93     12  W-LAST-COLUMN           PIC S9(03) VALUE +70 COMP-3.
    94     12  W-LAST-SQUEEZED-SPACE   PIC S9(03) VALUE +0   COMP-3.
    95     12  W-LAST-TX-SPACE         PIC S9(03) VALUE +0   COMP-3.
    96     12  W-LAST-WC-SPACE         PIC S9(03) VALUE +0   COMP-3.
    97     12  W-LINE-COUNT            PIC S9(03) VALUE +0   COMP-3.
    98     12  W-LINE-INDENT-1         PIC  9(02) VALUE 0    COMP-3.
    99     12  W-LINE-INDENT-2         PIC  9(02) VALUE 0    COMP-3.
   100     12  W-LINE-INDENT-3         PIC  9(02) VALUE 0    COMP-3.
   101     12  W-LINE-INDENT-4         PIC  9(02) VALUE 0    COMP-3.
   102     12  W-LINE-INDENT-5         PIC  9(02) VALUE 0    COMP-3.
   103     12  W-MAX-LINES-PER-PAGE    PIC  9(02) VALUE 56   COMP-3.
   104     12  W-NEXT-INDENT           PIC  9(02) VALUE 0    COMP-3.
   105     12  W-PAGE                  PIC S9(02) VALUE +0   COMP-3.
   106     12  W-PAGE-LINE             PIC S9(03) VALUE +0   COMP-3.
   107     12  W-PARAGRAPH-INDENT      PIC  9(02) VALUE 0    COMP-3.
   108     12  W-ROLL-COUNTER          PIC S9(03) VALUE +0   COMP-3.
   109     12  W-START-COLUMN          PIC S9(03) VALUE +1   COMP-3.
   110     12  W-TEMP-CURRENT-LINE     PIC S9(03) VALUE +0   COMP-3.
   111     12  W-TOO-FAR               PIC S9(03) VALUE +71 COMP-3.
   112     12  W-TOP-MARGIN            PIC  9(02) VALUE 0    COMP-3.
   113     12  W-TOTAL-TX-LINES        PIC S9(03) VALUE +0   COMP-3.
   114     12  W-TS-GROUP-WORK         PIC  9(05) VALUE 0    COMP-3.
   115     12  W-WORK-INDENT           PIC  9(02) VALUE 0    COMP-3.
   116     12  W-WORK-AMOUNT           PIC S9(09)V9(02)
   117                                            VALUE +0   COMP-3.
   118
   119     12  W-DATA-SOURCE           PIC  9(01) VALUE 0.
   120     12  W-LABEL-SOURCE          PIC  9(01) value 0.
   121         88  W-LABEL-SOURCE-VALID           VALUE 1 THRU 7.
   122     12  W-LABEL-JOINT-NAME      PIC  X(30) VALUE SPACES.
   123     12  W-LAST-ERROR            PIC  9(04) VALUE 9999.
   124     12  W-NUMB-LABEL-LINES      PIC  9(01) VALUE 0.
   125     12  W-PRINT-CONTROL         PIC  9(02) VALUE 0.
   126     12  W-SAVE-REVISION         PIC  9(03) value 0.
   127     12  W-DISPLAY-3             PIC  9(03) value 0.
   128     12  W-DISPLAY-8             PIC  9(08) value 0.
   129     12  W-DISPLAY-7             PIC  9(07) value 0.
   130     12  W-EDIT-2-5-S            PIC  Z9.9(05).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page   4
* EL689.cbl
   131     12  W-EDIT-3-0              PIC  ZZ9.
   132     12  W-EDIT-7-2              PIC  $$,$$$,$$9.99.
   133     12  W-EDIT-7-2-NEGATIVE     PIC  $$,$$$,$$9.99-.
   134     12  W-EDIT-9-2              PIC  $$$$,$$$,$$9.99.
   135     12  W-EDIT-12-2             PIC  $$$$,$$$,$$$,$$9.99.
   136
   137     12  WS-ACCT-PKEY-MATCH-SW   PIC  X(01) VALUE SPACE.
   138         88  PRIOR-MATCH-ACCT-PKEY          VALUE 'Y'.
   139
   140     12  W-ARCH-SUPPRESS         PIC ZZZZZZZ9.
   141     12  W-ARCH-EDIT REDEFINES W-ARCH-SUPPRESS
   142                                 PIC  X(08).
   143     12  W-COMP-WORK-AREA.
   144         16  W-CWA-CHAR OCCURS 10 TIMES
   145                                 PIC  X(01).
   146     12  W-INCOMING-ARCHIVE      PIC  X(08).
   147     12  W-INCOMING-ARCH-NO REDEFINES W-INCOMING-ARCHIVE
   148                                 PIC  9(08).
   149
   150     12  W-BATCH-BREAKDOWN.
   151         16  W-BATCH-CONTROL     PIC S9(08) COMP.
   152         16  W-BATCH-SEQ         PIC S9(04) COMP.
   153     12  W-BEN-HOLD              PIC  X(02).
   154     12  W-BENEFIT-WORK          PIC  X(03).
   155     12  W-BEN-R REDEFINES W-BENEFIT-WORK.
   156         16  W-ELIM-DAYS         PIC  X(02).
   157         16  FILLER              PIC  X(01).
   158     12  W-CALL-PGM              PIC  X(08).
   159     12  W-CURRENT-SAVE          PIC  X(02) VALUE SPACES.
   160
   161     12  FILLER                  PIC  X(09) VALUE 'LINE CNTL'.
   162     12  W-LINE-CONTROL-RECORD.
   163         16  W-LC-LINE-WIDTH     PIC  9(02).
   164         16  FILLER              PIC  X(01).
   165         16  W-LC-PARAGRAPH-INDENT
   166                                 PIC  9(02).
   167         16  FILLER              PIC  X(01).
   168         16  W-LC-MAX-LINES-PER-PAGE
   169                                 PIC  9(02).
   170         16  FILLER              PIC  X(01).
   171         16  W-LC-LINE-ADJUST    PIC  9(02).
   172         16  FILLER              PIC  X(01).
   173         16  W-LC-LINE-INDENT-1  PIC  9(02).
   174         16  FILLER              PIC  X(01).
   175         16  W-LC-LINE-INDENT-2  PIC  9(02).
   176         16  FILLER              PIC  X(01).
   177         16  W-LC-LINE-INDENT-3  PIC  9(02).
   178         16  FILLER              PIC  X(01).
   179         16  W-LC-LINE-INDENT-4  PIC  9(02).
   180         16  FILLER              PIC  X(01).
   181         16  W-LC-LINE-INDENT-5  PIC  9(02).
   182         16  FILLER              PIC  X(01).
   183         16  W-LC-TOP-MARGIN     PIC  9(02).
   184         16  FILLER              PIC  X(01).
   185         16  W-LC-CASE-IND       PIC  X(01).
   186             88  W-LC-USE-BOTH-CASES        VALUE 'Y'.
   187         16  FILLER              PIC  X(01).
   188         16  W-LC-PAGE-IND       PIC  X(01).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page   5
* EL689.cbl
   189             88  W-LC-CREATE-PAGES          VALUE 'Y'.
   190     12  W-DATE-WORK             PIC  9(07).
   191     12  W-DT-REDEF REDEFINES W-DATE-WORK.
   192         16  FILLER              PIC  X(02).
   193         16  W-DT-WORK           PIC  9(05).
   194
   195     12  W-DEEDIT-FIELD          PIC  X(15).
   196     12  W-DEEDIT-FIELD-V0 REDEFINES W-DEEDIT-FIELD PIC S9(15).
   197
   198     12  W-EDIT-DATE-1.
   199         16  W-ED1-MM            PIC  X(02).
   200         16  FILLER              PIC  X(01) VALUE '/'.
   201         16  W-ED1-DD            PIC  X(02).
   202         16  FILLER              PIC  X(01) VALUE '/'.
   203         16  W-ED1-YY            PIC  X(02).
   204
   205     12  W-EDIT-DATE-2.
   206         16  W-ED2-DD            PIC  X(02).
   207         16  FILLER              PIC  X(01) VALUE '/'.
   208         16  W-ED2-MM            PIC  X(02).
   209         16  FILLER              PIC  X(01) VALUE '/'.
   210         16  W-ED2-YY            PIC  X(02).
   211
   212     12  W-LABEL-HOLD-AREA.
   213         16  W-LABEL-LINES OCCURS 6 TIMES.
   214             20  W-LABEL-ZIP.
   215                 24  W-LABEL-1ST-ZIP  PIC  X(05).
   216                 24  W-LABEL-DASH     PIC  X(01).
   217                 24  W-LABEL-2ND-ZIP  PIC  X(04).
   218             20  W-LAB-CAN-POSTAL-CODES REDEFINES W-LABEL-ZIP.
   219                 24  W-LAB-CAN-POSTAL-CD-1
   220                                      PIC  X(03).
   221                 24  W-LAB-CAN-DASH   PIC  X(01).
   222                 24  W-LAB-CAN-POSTAL-CD-2
   223                                      PIC  X(03).
   224                 24  W-LAB-CAN-FILLER PIC  X(03).
   225             20  FILLER               PIC  X(10).
   226             20  W-LAST-ZIP.
   227                 24  W-LAST-1ST-ZIP   PIC  X(05).
   228                 24  W-LABEL-DASH-LAST
   229                                      PIC  X(01).
   230                 24  W-LAST-2ND-ZIP   PIC  X(04).
   231             20  W-LAST-CAN-POSTAL-CODES REDEFINES W-LAST-ZIP.
   232                 24  W-LAST-CAN-POSTAL-CD-1
   233                                      PIC  X(03).
   234                 24  W-LAST-CAN-DASH  PIC  X(01).
   235                 24  W-LAST-CAN-POSTAL-CD-2
   236                                      PIC  X(03).
   237                 24  W-LAST-CAN-FILLER
   238                                      PIC  X(03).
   239
   240     12  W-LAST-CHAR             PIC  X(01).
   241         88  W-LAST-CHAR-PUNC    VALUE '-' '/'.
   242     12  W-LAST-SQ-CHAR          PIC  X(01).
   243
   244     12  W-LINE-NUM.
   245         16  W-LINE1             PIC  X(01).
   246         16  W-LINE23            PIC  9(02).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page   6
* EL689.cbl
   247     12  W-LIN-NUM REDEFINES W-LINE-NUM
   248                                 PIC  9(03).
   249
   250     12  W-NAME-LAST             PIC  X(15).
   251     12  W-NAME-FIRST.
   252         16  W-NAME-FIRST-INIT   PIC  X(01).
   253         16  W-NAME-FIRST-REMAIN PIC  X(14).
   254     12  W-NAME-MIDDLE.
   255         16  FILLER              PIC  X(01).
   256         16  W-NAME-MIDDLE-2     PIC  X(01).
   257         16  FILLER              PIC  X(13).
   258
   259     12  W-PAGE-PRT.
   260         16  FILLER              PIC  X(34) VALUE SPACES.
   261         16  W-PAGE-NUMBER       PIC  Z9.
   262         16  FILLER              PIC  X(01) VALUE '.'.
   263         16  FILLER              PIC  X(33) VALUE SPACES.
   264
   265     12  W-PHONE-IN              PIC  9(11) VALUE ZEROS.
   266     12  W-PHONE-IN-R   REDEFINES W-PHONE-IN.
   267         16  FILLER              PIC  9(01).
   268         16  W-PHI-AREA          PIC  9(03).
   269         16  W-PHI-PFX           PIC  9(03).
   270         16  W-PHI-SFX           PIC  9(04).
   271     12  W-PHONE-OUT.
   272         16  W-PO-AREA           PIC  X(03).
   273         16  FILLER              PIC  X(01) VALUE '-'.
   274         16  W-PO-PFX            PIC  X(03).
   275         16  FILLER              PIC  X(01) VALUE '-'.
   276         16  W-PO-SFX            PIC  X(04).
   277
   278     12  W-SAVE-BIN-DATE         PIC  X(02) VALUE SPACES.
   279     12  W-SAVE-DATE             PIC  X(08) VALUE SPACES.
   280     12  W-SAVE-PLAN             PIC  X(02) VALUE SPACES.
   281
   282     12  W-SINGLE-LINE           PIC  X(70).
   283     12  W-SINGLE-LINE-BY REDEFINES W-SINGLE-LINE.
   284         16  ONE-CHAR OCCURS 70 TIMES INDEXED BY NDX1 NDX2 NDXA
   285                                 PIC  X(01).
   286
   287     12  W-SQUEEZED-LINE.
   288         16  W-SQ-CHAR OCCURS 70 TIMES
   289                       INDEXED BY W-SQ-NDX
   290                                 PIC  X(01).
   291
   292     12  W-TIME-IN               PIC S9(07).
   293     12  W-TIME-OUT-R REDEFINES W-TIME-IN.
   294         16  FILLER              PIC  X(01).
   295         16  W-TIME-OUT          PIC  99V9(02).
   296         16  FILLER              PIC  X(02).
   297
   298     12  W-TS-NAME-TEXT.
   299         16  W-TS-ID-TEXT        PIC  X(04) VALUE '104A'.
   300         16  W-TS-ID-TIME
   301             REDEFINES W-TS-ID-TEXT
   302                                 PIC S9(07) COMP-3.
   303         16  W-TS-TERM-TEXT.
   304             20 W-TS-TERM-PREFIX PIC  X(02).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page   7
* EL689.cbl
   305             20 FILLER           PIC  X(02).
   306     12  W-TS-NAME-SCREEN.
   307         16  FILLER              PIC  X(04) VALUE '689X'.
   308         16  W-TS-TERM-SCREEN    PIC  X(04).
   309
   310     12  W-WORK-LINE.
   311         16  W-WORK-CHAR OCCURS 70 TIMES
   312                       INDEXED BY W-WC-NDX
   313                                  W-WC-NDX2
   314                                  W-WC-NDX3
   315                                 PIC  X(01).
   316
   317     12  W-WORK-ZIP-NUMERIC      PIC  9(09).
   318     12  W-WORK-ZIP REDEFINES W-WORK-ZIP-NUMERIC.
   319         16  W-WORK-ZIP5         PIC  X(05).
   320         16  W-WORK-ZIP4         PIC  X(04).
   321     12  W-CANADIAN-POSTAL-CODES REDEFINES W-WORK-ZIP-NUMERIC.
   322         16  W-CAN-POSTAL-CD-1.
   323             20  FILLER          PIC  X(01).
   324                 88 W-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
   325             20  FILLER          PIC  X(02).
   326         16  W-CAN-POSTAL-CD-2   PIC  X(03).
   327         16  W-FILLER            PIC  X(03).
   328
   329     12  W-Z-CONTROL-DATA.
   330         16  W-NUMBER-OF-COPIES  PIC  9.
   331         16  FILLER              PIC  X.
   332         16  W-DAYS-TO-FOLLOW-UP PIC  999.
   333         16  FILLER              PIC  X.
   334         16  W-DAYS-TO-RESEND    PIC  999.
   335         16  FILLER              PIC  X.
   336         16  W-FORM-TO-RESEND    PIC  X(4).
   337         16  FILLER              PIC  X.
   338         16  W-PROMPT-LETTER     PIC  X.
   339         16  FILLER              PIC  X.
   340         16  W-ENCLOSURE-CODE    PIC  XXX.
   341         16  F                   PIC  X.
   342         16  W-AUTO-CLOSE-IND    PIC  X.
   343         16  F                   PIC  X.
   344         16  W-LETTER-TO-BENE    PIC  X.
   345*        16  W-PRINT-RESTRICTED-IND
   346*                                PIC  X(01).
   347*            88  W-PRINT-RESTRICTED-TO-CNTL VALUE 'C'.
   348*            88  W-PRINT-RESTRICTED-TO-FORM VALUE 'F'.
   349*            88  W-PRINT-RESTRICTED-TO-PROC VALUE 'P'.
   350*            88  W-PRINT-RESTRICTED         VALUE 'C' 'F' 'P'.
   351*        16  FILLER              PIC X.
   352*        16  W-RESEND-LETR-1     PIC X(4).
   353*        16  FILLER              PIC X.
   354*        16  W-RESEND-LETR-2     PIC X(4).
   355*        16  FILLER              PIC X.
   356*        16  W-RESEND-LETR-3     PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page   8
* EL689.cbl
   358 01  W-SWITCH-INDICATORS-AREA.
   359     12  FILLER                  PIC  X(16)
   360                                      VALUE 'PROGRAM SWITCHS:'.
   361     12  W-ADDRESS-ONLY-SW       PIC  X(01) VALUE ' '.
   362         88  W-ADDRESS-ONLY      VALUE 'Y'.
   363         88  W-FULL-DATA         VALUE ' '.
   364     12  W-ACCT-BROWSE-STARTED-SW
   365                                 PIC  X(01) VALUE 'N'.
   366         88  W-ACCT-BROWSE-STARTED          VALUE 'Y'.
   367     12  W-ARCT-BROWSE-STARTED   PIC  X(01) VALUE 'N'.
   368     12  W-CERT-FOUND-SW         PIC  X(01) VALUE 'N'.
   369         88  W-CERT-FOUND                   VALUE 'Y'.
   370     12  W-CHARACTER-TYPE        PIC  X(01).
   371         88  W-END-OF-SENTENCE   VALUE '.' '?' '!'.
   372         88  W-PUNCTUATION       VALUE '.' '?' '!' ',' ';'.
   373         88  W-SPACE             VALUE ' '.
   374     12  W-COMP-BROWSE-SW        PIC  X(01) VALUE 'N'.
   375         88  W-COMP-BROWSE-STARTED          VALUE 'Y'.
   376     12  W-DATA-SHRINK-IND       PIC  X(01) VALUE SPACES.
   377         88  W-DATA-SHRINKING    VALUE 'Y'.
   378     12  W-END-OF-SENTENCE-IND   PIC  X(01) VALUE SPACES.
   379         88  W-END-OF-SENTENCE-WORKING      VALUE 'Y'.
   380     12  W-FIRST-BAD-VARIABLE-IND
   381                                 PIC  X(01) VALUE SPACES.
   382         88  W-FIRST-BAD-VARIABLE-FOUND     VALUE 'Y'.
   383     12  W-FIRST-CHAR-FOUND-IND  PIC  X(01) VALUE SPACES.
   384         88  W-FIRST-CHAR-FOUND             VALUE 'Y'.
   385         88  W-FIRST-CHAR-NOT-FOUND         VALUE SPACES.
   386     12  W-FORM-CHANGED-IND      PIC  X(01) VALUE SPACES.
   387         88  W-FORM-CHANGED                 VALUE 'Y'.
   388     12  W-FORM-SQUEEZE-IND      PIC  X(01) VALUE SPACES.
   389         88  W-FORM-SQUEEZE-ON              VALUE 'Y'.
   390         88  W-FORM-SQUEEZE-OFF             VALUE ' '.
   391     12  W-HOLD-IND              PIC  X(01) VALUE SPACES.
   392         88  W-HOLD-ON                      VALUE 'Y'.
   393         88  W-HOLD-OFF                     VALUE ' '.
   394     12  W-INDIVIDUAL-DATA-SW    PIC  X(01) VALUE ' '.
   395         88  W-INDIVIDUAL-DATA-COMPLETED    VALUE 'Y'.
   396         88  W-INDIV-DATA-NOT-COMPLETED     VALUE ' '.
   397     12  W-KEY-FIELDS-CHANGED-IND
   398                                 PIC  X(01) VALUE ' '.
   399         88  W-KEY-FIELDS-CHANGED           VALUE 'Y'.
   400         88  W-KEY-FIELDS-NOT-CHANGED       VALUE ' '.
   401     12  W-LAST-ONE              PIC  X(01) VALUE HIGH-VALUES.
   402         88  W-LAST-ONE-A-SPACE  VALUE ' '.
   403     12  W-LINE-SQUEEZE-IND      PIC  X(01) VALUE SPACES.
   404         88  W-NEW-PARAGRAPH                VALUE 'P' 'Q' 'R' 'S'
   405                                                   'T' 'U'.
   406         88  W-CONTINUE-PARAGRAPH           VALUE 'C' 'D' 'E' 'F'
   407                                                   'G' 'H'.
   408         88  W-FORM-CONTROL-LINE            VALUE 'K'.
   409         88  W-DO-NOT-ADJUST                VALUE 'N'.
   410         88  W-ADJUST-TO-LINE-LENGTH        VALUE 'A'.
   411         88  W-AS-IS                        VALUE 'A' 'N'.
   412         88  W-CONTINUE-PREVIOUS-PROCESS    VALUE ' ' '1' '2' '3'
   413                                                   '4' '5'.
   414
   415     12  W-PNDB-FOUND-SW         PIC  X(01) VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page   9
* EL689.cbl
   416         88  W-PNDB-FOUND                   VALUE 'Y'.
   417     12  W-REMAINING-VAR-SW      PIC  X(01) VALUE SPACES.
   418         88  W-REMAINING-VAR-FOUND          VALUE 'Y'.
   419     12  W-REVERSE-DATE-SW       PIC  X(01) VALUE SPACES.
   420         88  W-REVERSE-DATE                 VALUE 'Y'.
   421     12  W-TEXT-BROWSED-SW       PIC  X(01) VALUE 'N'.
   422         88  W-TEXT-BROWSE-STARTED          VALUE 'Y'.
   423         88  W-TEXT-BROWSE-NOT-STARTED      VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page  10
* EL689.cbl
   425 01  WS-SAVE-AREA.
   426     12  WS-SAV-AM-DEFN-1.
   427         16  WS-SAV-AM-AGT-COMMS OCCURS 10 TIMES.
   428             20  WS-SAV-AM-AGT             PIC  X(10).
   429             20  WS-SAV-AM-COM-TYP         PIC  X(01).
   430             20  FILLER                    PIC  X(15).
   431     12  WS-SAV-AM-REMIT-TO                PIC  9(02).
   432     12  WS-SAV-AM-CSR-CODE                PIC  X(04).
   433     12  WS-SAV-AM-CARRIER                 PIC  X(01).
   434     12  WS-SAV-AM-ACCOUNT                 PIC  X(10).
   435     12  WS-SAV-AM-CONTROL-NAME            PIC  X(30).
   436     12  WS-SAV-AM-NAME                    PIC  X(30).
   437     12  WS-SAV-AM-PERSON                  PIC  X(30).
   438     12  WS-SAV-AM-ADDRS                   PIC  X(30).
   439     12  WS-SAV-AM-CITY                    PIC  X(30).
   440     12  WS-SAV-AM-ERACCT-ACCOUNT          PIC  X(10).
   441     12  WS-SAV-AM-ZIP.
   442         16  WS-SAV-AM-ZIP-PRIME.
   443             20  WS-SAV-AM-ZIP-PRI-1ST     PIC  X(01).
   444                 88  SAVE-AM-CANADIAN-POST-CODE       VALUE
   445                     'A' THRU 'Z'.
   446             20  FILLER                    PIC  X(04).
   447         16  FILLER                        PIC  X(04).
   448     12  WS-SAV-AM-CANADIAN-POSTAL-CODE REDEFINES
   449                        WS-SAV-AM-ZIP      PIC  X(09).
   450     12  WS-SAV-AM-TEL-NO.
   451         16  WS-SAV-AM-AREA-CODE           PIC 9(03).
   452         16  WS-SAV-AM-TEL-PRE             PIC 9(03).
   453         16  WS-SAV-AM-TEL-NBR             PIC 9(04).
   454 01  W-KEY-AREAS.
   455     12  FILLER                    PIC  X(13)
   456                                      VALUE 'PROGRAM KEYS:'.
   457
   458     12  W-ACCT-SAVE-KEY           PIC  X(20).
   459     12  W-ACCT-KEY.
   460         16  W-ACCT-PARTIAL-KEY.
   461             20  W-ACCT-COMPANY-CD PIC  X(01).
   462             20  W-ACCT-CARRIER    PIC  X(01).
   463             20  W-ACCT-GROUPING   PIC  X(06).
   464             20  W-ACCT-STATE      PIC  X(02).
   465             20  W-ACCT-ACCOUNT    PIC  X(10).
   466         16  W-ACCT-EXP-DT         PIC  X(02).
   467
   468     12  W-ARCH-SAVE-KEY         PIC  X(05).
   469     12  W-ARCH-KEY.
   470         16  W-ARCH-PARTIAL-KEY.
   471             20  W-ARCH-COMPANY-CD
   472                                 PIC  X(01).
   473             20  W-ARCH-NUMBER   PIC S9(08)      COMP.
   474         16  W-ARCH-SEQ-NO       PIC S9(04)      COMP VALUE +0.
   475
   476     12  W-ARCT-KEY.
   477         16  W-ARCT-PARTIAL-KEY.
   478             20  W-ARCT-COMPANY-CD
   479                                 PIC  X(01).
   480             20  W-ARCT-NUMBER   PIC S9(08)      COMP.
   481         16  W-ARCT-REC-TYPE     PIC  X(01).
   482         16  W-ARCT-SEQ-NO       PIC S9(04)      COMP VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page  11
* EL689.cbl
   483
   484     12  W-CERT-KEY.
   485         16  W-CERT-COMPANY-CD   PIC  X(01).
   486         16  W-CERT-CARRIER      PIC  X(01).
   487         16  W-CERT-GROUPING     PIC  X(06).
   488         16  W-CERT-STATE        PIC  X(02).
   489         16  W-CERT-ACCOUNT      PIC  X(10).
   490         16  W-CERT-EFF-DT       PIC  X(02).
   491         16  W-CERT-CERT-NO.
   492             20  W-CERT-CERT-PRIME
   493                                 PIC  X(10).
   494             20  W-CERT-CERT-SFX PIC  X(01).
   495
   496     12  W-CHEK-KEY.
   497         16  W-CHEK-COMPANY-CD   PIC  X(01).
   498         16  W-CHEK-CARRIER      PIC  X(01).
   499         16  W-CHEK-GROUPING     PIC  X(06).
   500         16  W-CHEK-STATE        PIC  X(02).
   501         16  W-CHEK-ACCOUNT      PIC  X(10).
   502         16  W-CHEK-EFF-DT       PIC  X(02).
   503         16  W-CHEK-CERT-NO.
   504             20  W-CHEK-CERT-PRIME
   505                                 PIC  X(10).
   506             20  W-CHEK-CERT-SFX PIC  X(01).
   507         16  W-CHEK-SEQ-NO       PIC S9(04)   VALUE +0    COMP.
   508
   509     12  W-CNTL-KEY.
   510         16  W-CNTL-COMPANY-ID   PIC  X(03).
   511         16  W-CNTL-RECORD-TYPE  PIC  X(01)   VALUE '1'.
   512         16  W-CNTL-GENL.
   513             20  W-CNTL-GEN1     PIC  X(02)   VALUE SPACES.
   514             20  W-CNTL-GEN2.
   515                 24 W-CNTL-GEN3  PIC  X(01)   VALUE SPACES.
   516                 24 W-CNTL-GEN4  PIC  X(01)   VALUE SPACES.
   517         16  W-CNTL-SEQ-NO       PIC S9(04)   VALUE +0    COMP.
   518
   519     12  W-COMP-SAVE-KEY         PIC  X(29).
   520     12  W-COMP-KEY.
   521         16  W-COMP-COMPANY-CD   PIC  X(01).
   522         16  W-COMP-CARRIER      PIC  X(01).
   523         16  W-COMP-GROUPING     PIC  X(06).
   524         16  W-COMP-RESP-PERSON.
   525             20  W-COMP-RP-CHAR OCCURS 10 TIMES
   526                                INDEXED BY W-COMP-NDX
   527                                 PIC  X(01).
   528         16  W-COMP-ACCOUNT      PIC  X(10).
   529         16  W-COMP-TYPE         PIC  X(01).
   530
   531     12  W-DELETE-KEY.
   532         16  W-DELETE-PARTIAL-KEY.
   533             20  W-DELETE-COMPANY-CD
   534                                 PIC  X(01).
   535             20  W-DELETE-NUMBER PIC S9(08)      COMP.
   536         16  W-DELETE-RECORD-TYPE
   537                                 PIC  X(01).
   538         16  W-DELETE-SEQ        PIC S9(04)      COMP VALUE +0.
   539
   540     12  W-MAIL-KEY.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page  12
* EL689.cbl
   541         16  W-MAIL-COMPANY-CD   PIC  X(01).
   542         16  W-MAIL-CARRIER      PIC  X(01).
   543         16  W-MAIL-GROUPING     PIC  X(06).
   544         16  W-MAIL-STATE        PIC  X(02).
   545         16  W-MAIL-ACCOUNT      PIC  X(10).
   546         16  W-MAIL-EFF-DT       PIC  X(02).
   547         16  W-MAIL-CERT-NO.
   548             20  W-MAIL-CERT-PRIME
   549                                 PIC  X(10).
   550             20  W-MAIL-CERT-SFX PIC  X(01).
   551
   552     12  W-PNDB-KEY.
   553         16  W-PNDB-COMPANY-CD   PIC  X(01).
   554         16  W-PNDB-ENTRY        PIC  X(06).
   555         16  W-PNDB-SEQ-NO       PIC S9(04)  COMP.
   556         16  W-PNDB-CHG-SEQ-NO   PIC S9(04)  COMP.
   557
   558     12  W-PNDB2-KEY.
   559         16  W-PNDB2-COMPANY-CD  PIC  X(01).
   560         16  W-PNDB2-CARRIER     PIC  X(01).
   561         16  W-PNDB2-GROUPING    PIC  X(06).
   562         16  W-PNDB2-STATE       PIC  X(02).
   563         16  W-PNDB2-ACCOUNT     PIC  X(10).
   564         16  W-PNDB2-EFF-DT      PIC  X(02).
   565         16  W-PNDB2-CERT-NO.
   566             20  W-PNDB2-CERT-PRIME
   567                                 PIC  X(10).
   568             20  W-PNDB2-CERT-SFX
   569                                 PIC  X(01).
   570         16  W-PNDB2-ALT-CHG-SEQ-NO
   571                                 PIC S9(04)  COMP.
   572         16  W-PNDB2-TYPE        PIC  X(01).
   573
   574     12  W-PYAJ-KEY.
   575         16  W-PYAJ-COMPANY-CD   PIC  X(01).
   576         16  W-PYAJ-CARRIER      PIC  X(01).
   577         16  W-PYAJ-GROUPING     PIC  X(06).
   578         16  W-PYAJ-FIN-RESP     PIC  X(10).
   579         16  W-PYAJ-ACCOUNT      PIC  X(10).
   580         16  W-PYAJ-FILE-SEQ-NO  PIC S9(08)    COMP.
   581         16  W-PYAJ-RECORD-TYPE  PIC  X(01).
   582
   583     12  W-SC-QUID-KEY.
   584         16  W-SC-QUID-TERMINAL  PIC  X(04).
   585         16  W-SC-QUID-SYSTEM    PIC  X(04).
   586
   587     12  W-TEXT-SAVE-KEY         PIC  X(05).
   588     12  W-TEXT-KEY.
   589         16  W-TEXT-PARTIAL-KEY.
   590             20  W-TEXT-COMPANY-CD
   591                                 PIC  X(01).
   592             20  W-TEXT-LETTER   PIC  X(04).
   593         16  W-TEXT-FILLER       PIC  X(08)   VALUE SPACES.
   594         16  W-TEXT-SEQ          PIC S9(04)   VALUE +0    COMP.
   595
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page  13
* EL689.cbl
   597 01  FILLER                      PIC  X(22)
   598                                 VALUE 'INTERFACE AREA STARTS:'.
   599*    COPY ELCINTF.
   600******************************************************************
   601*                                                                *
   602*                                                                *
   603*                            ELCINTF.                            *
   604*                            VMOD=2.017                          *
   605*                                                                *
   606*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   607*                                                                *
   608*       LENGTH = 1024                                            *
   609*                                                                *
   610******************************************************************
   611 01  PROGRAM-INTERFACE-BLOCK.
   612     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   613     12  PI-CALLING-PROGRAM              PIC X(8).
   614     12  PI-SAVED-PROGRAM-1              PIC X(8).
   615     12  PI-SAVED-PROGRAM-2              PIC X(8).
   616     12  PI-SAVED-PROGRAM-3              PIC X(8).
   617     12  PI-SAVED-PROGRAM-4              PIC X(8).
   618     12  PI-SAVED-PROGRAM-5              PIC X(8).
   619     12  PI-SAVED-PROGRAM-6              PIC X(8).
   620     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   621     12  PI-COMPANY-ID                   PIC XXX.
   622     12  PI-COMPANY-CD                   PIC X.
   623
   624     12  PI-COMPANY-PASSWORD             PIC X(8).
   625
   626     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   627
   628     12  PI-CONTROL-IN-PROGRESS.
   629         16  PI-CARRIER                  PIC X.
   630         16  PI-GROUPING                 PIC X(6).
   631         16  PI-STATE                    PIC XX.
   632         16  PI-ACCOUNT                  PIC X(10).
   633         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   634                                         PIC X(10).
   635         16  PI-CLAIM-CERT-GRP.
   636             20  PI-CLAIM-NO             PIC X(7).
   637             20  PI-CERT-NO.
   638                 25  PI-CERT-PRIME       PIC X(10).
   639                 25  PI-CERT-SFX         PIC X.
   640             20  PI-CERT-EFF-DT          PIC XX.
   641         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   642             20  PI-PLAN-CODE            PIC X(2).
   643             20  PI-REVISION-NUMBER      PIC X(3).
   644             20  PI-PLAN-EFF-DT          PIC X(2).
   645             20  PI-PLAN-EXP-DT          PIC X(2).
   646             20  FILLER                  PIC X(11).
   647         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   648             20  PI-OE-REFERENCE-1.
   649                 25  PI-OE-REF-1-PRIME   PIC X(18).
   650                 25  PI-OE-REF-1-SUFF    PIC XX.
   651
   652     12  PI-SESSION-IN-PROGRESS          PIC X.
   653         88  CLAIM-SESSION                   VALUE '1'.
   654         88  CREDIT-SESSION                  VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page  14
* EL689.cbl
   655         88  WARRANTY-SESSION                VALUE '3'.
   656         88  MORTGAGE-SESSION                VALUE '4'.
   657         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   658
   659
   660*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   661
   662     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   663     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   664
   665     12  PI-CREDIT-USER                  PIC X.
   666         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   667         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   668
   669     12  PI-CLAIM-USER                   PIC X.
   670         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   671         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   672
   673     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   674         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   675         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   676         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   677         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   678         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   679
   680     12  PI-PROCESSOR-ID                 PIC X(4).
   681
   682     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   683
   684     12  PI-MEMBER-CAPTION               PIC X(10).
   685
   686     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   687         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   688
   689     12  PI-LIFE-OVERRIDE-L1             PIC X.
   690     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   691     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   692     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   693
   694     12  PI-AH-OVERRIDE-L1               PIC X.
   695     12  PI-AH-OVERRIDE-L2               PIC XX.
   696     12  PI-AH-OVERRIDE-L6               PIC X(6).
   697     12  PI-AH-OVERRIDE-L12              PIC X(12).
   698
   699     12  PI-NEW-SYSTEM                   PIC X(2).
   700
   701     12  PI-PRIMARY-CERT-NO              PIC X(11).
   702     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   703         88  PI-USES-PAID-TO                 VALUE '1'.
   704     12  PI-CRDTCRD-SYSTEM.
   705         16  PI-CRDTCRD-USER             PIC X.
   706             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   707             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   708         16  PI-CC-MONTH-END-DT          PIC XX.
   709     12  PI-PROCESSOR-PRINTER            PIC X(4).
   710
   711     12  PI-OE-REFERENCE-2.
   712         16  PI-OE-REF-2-PRIME           PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page  15
* EL689.cbl
   713         16  PI-OE-REF-2-SUFF            PIC X.
   714
   715     12  PI-REM-TRM-CALC-OPTION          PIC X.
   716
   717     12  PI-LANGUAGE-TYPE                PIC X.
   718             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   719             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   720             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   721
   722     12  PI-POLICY-LINKAGE-IND           PIC X.
   723         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   724         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   725                                                   LOW-VALUES.
   726
   727     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   728     12  PI-CLAIM-PW-SESSION             PIC X(1).
   729         88  PI-CLAIM-CREDIT                 VALUE '1'.
   730         88  PI-CLAIM-CONVEN                 VALUE '2'.
   731     12  FILLER                          PIC X(4).
   732
   733     12  PI-SYSTEM-LEVEL                 PIC X(145).
   734
   735     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   736         PI-SYSTEM-LEVEL.
   737
   738         16  PI-ENTRY-CODES.
   739             20  PI-ENTRY-CD-1           PIC X.
   740             20  PI-ENTRY-CD-2           PIC X.
   741
   742         16  PI-RETURN-CODES.
   743             20  PI-RETURN-CD-1          PIC X.
   744             20  PI-RETURN-CD-2          PIC X.
   745
   746         16  PI-UPDATE-STATUS-SAVE.
   747             20  PI-UPDATE-BY            PIC X(4).
   748             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   749
   750         16  PI-LOWER-CASE-LETTERS       PIC X.
   751             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   752
   753*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   754*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   755*            88  CARRIER-CLM-CNTL            VALUE '2'.
   756
   757         16  PI-CERT-ACCESS-CONTROL      PIC X.
   758             88  ST-ACCNT-CNTL               VALUE ' '.
   759             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   760             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   761             88  ACCNT-CNTL                  VALUE '3'.
   762             88  CARR-ACCNT-CNTL             VALUE '4'.
   763
   764         16  PI-PROCESSOR-CAP-LIST.
   765             20  PI-SYSTEM-CONTROLS.
   766                24 PI-SYSTEM-DISPLAY     PIC X.
   767                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   768                24 PI-SYSTEM-MODIFY      PIC X.
   769                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   770             20  FILLER                  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page  16
* EL689.cbl
   771             20  PI-DISPLAY-CAP          PIC X.
   772                 88  DISPLAY-CAP             VALUE 'Y'.
   773             20  PI-MODIFY-CAP           PIC X.
   774                 88  MODIFY-CAP              VALUE 'Y'.
   775             20  PI-MSG-AT-LOGON-CAP     PIC X.
   776                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   777             20  PI-FORCE-CAP            PIC X.
   778                 88  FORCE-CAP               VALUE 'Y'.
   779
   780         16  PI-PROGRAM-CONTROLS.
   781             20  PI-PGM-PRINT-OPT        PIC X.
   782             20  PI-PGM-FORMAT-OPT       PIC X.
   783             20  PI-PGM-PROCESS-OPT      PIC X.
   784             20  PI-PGM-TOTALS-OPT       PIC X.
   785
   786         16  PI-HELP-INTERFACE.
   787             20  PI-LAST-ERROR-NO        PIC X(4).
   788             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   789
   790         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   791             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   792
   793         16  PI-CR-CONTROL-IN-PROGRESS.
   794             20  PI-CR-CARRIER           PIC X.
   795             20  PI-CR-GROUPING          PIC X(6).
   796             20  PI-CR-STATE             PIC XX.
   797             20  PI-CR-ACCOUNT           PIC X(10).
   798             20  PI-CR-FIN-RESP          PIC X(10).
   799             20  PI-CR-TYPE              PIC X.
   800
   801         16  PI-CR-BATCH-NUMBER          PIC X(6).
   802
   803         16  PI-CR-MONTH-END-DT          PIC XX.
   804
   805         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   806             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   807             88  PI-ZERO-CARRIER             VALUE '1'.
   808             88  PI-ZERO-GROUPING            VALUE '2'.
   809             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   810
   811         16  PI-CARRIER-SECURITY         PIC X.
   812             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   813
   814         16  PI-ACCOUNT-SECURITY         PIC X(10).
   815             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   816             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   817
   818         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   819             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   820                                         INDEXED BY PI-ACCESS-NDX
   821                                         PIC X.
   822
   823         16  PI-GA-BILLING-CONTROL       PIC X.
   824             88  PI-GA-BILLING               VALUE '1'.
   825
   826         16  PI-MAIL-PROCESSING          PIC X.
   827             88  PI-MAIL-YES                 VALUE 'Y'.
   828
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page  17
* EL689.cbl
   829         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   830
   831         16  PI-AR-SYSTEM.
   832             20  PI-AR-PROCESSING-CNTL   PIC X.
   833                 88  PI-AR-PROCESSING        VALUE 'Y'.
   834             20  PI-AR-SUMMARY-CODE      PIC X(6).
   835             20  PI-AR-MONTH-END-DT      PIC XX.
   836
   837         16  PI-MP-SYSTEM.
   838             20  PI-MORTGAGE-USER            PIC X.
   839                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   840                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   841             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   842                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   843                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   844                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   845                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   846                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   847             20  PI-MP-MONTH-END-DT          PIC XX.
   848             20  PI-MP-REFERENCE-NO.
   849                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   850                 24  PI-MP-REFERENCE-SFX     PIC XX.
   851
   852         16  PI-LABEL-CONTROL            PIC X(01).
   853             88  PI-CREATE-LABELS                    VALUE 'Y'.
   854             88  PI-BYPASS-LABELS                    VALUE 'N'.
   855
   856         16  PI-BILL-GROUPING-CODE       PIC X(01).
   857             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   858
   859         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   860             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   861             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   862
   863         16  FILLER                      PIC X(14).
   864
   865     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   866******************************************************************
   867     12  PI-WA REDEFINES PI-PROGRAM-WORK-AREA.
   868*    COPY ELC1042.
   869******************************************************************
   870*                                                                *
   871*                                                                *
   872*                           ELC1042                              *
   873*                            VMOD=2.002                          *
   874*                                                                *
   875*    NOTE                                                        *
   876*        THE WORK AREA IS USED BY EL152, EL1522, EL1042, EL153,  *
   877*        EM152, EM1522, EL689, EL6892, EL6311, AND EL690.        *
   878*        THIS COPYBOOK SHOULD NOT BE CHANGED WITHOUT REFERENCE   *
   879*        TO THESE PROGRAMS.                                      *
   880*                                                                *
   881*    NOTE                                                        *
   882*        THE FILLER AREA AT THE BOTTOM ARE FOR FUTURE EL1042     *
   883*        USE ONLY!                                               *
   884*                                                                *
   885******************************************************************
   886
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page  18
* EL689.cbl
   887         16  PI-1042-WA.
   888             20  PI-ACTION       PIC  X(01).
   889                 88 PI-SHOW-MODE           VALUE '1'.
   890                 88 PI-CLEAR-MODE          VALUE '2'.
   891                 88 PI-CREATE-MODE         VALUE '3'.
   892             20  PI-COMM-CONTROL PIC  X(12).
   893             20  PI-CURRENT-LINE PIC S9(03) COMP-3.
   894             20  PI-EOF-SW       PIC  X(01).
   895                 88  PI-FILE-EOF           VALUE 'Y'.
   896             20  PI-FILETYP      PIC  X(01).
   897             20  PI-FORM-SQUEEZE-CONTROL
   898                                 PIC  X(01).
   899                 88  PI-FORM-SQUEEZE-ON     VALUE 'Y'.
   900                 88  PI-FORM-SQUEEZE-OFF    VALUE ' '.
   901             20  PI-LAST-CONTROL PIC  X(12).
   902             20  PI-TEMP-STOR-ITEMS
   903                                 PIC S9(04) COMP.
   904             20  PI-TOTAL-LINES  PIC S9(03) COMP-3.
   905             20  PI-UPDATE-SW    PIC  9(01).
   906                 88 ANY-UPDATES            VALUE 1.
   907             20  PI-104-SCREEN-SENT-IND
   908                                 PIC  X(01).
   909                 88  PI-104-SCREEN-SENT    VALUE 'Y'.
   910                 88  PI-104-SCREEN-NOT-SENT VALUE 'N'.
   911             20  PI-1042-SCREEN-SENT-IND
   912                                 PIC  X(01).
   913                 88  PI-1042-SCREEN-SENT    VALUE 'Y'.
   914                 88  PI-1042-SCREEN-NOT-SENT VALUE 'N'.
   915             20  PI-1042-ARCHIVE-IND
   916                                 PIC  X(01).
   917                 88  PI-1042-ARCHIVE-LETTER VALUE 'Y'.
   918             20  FILLER          PIC  X(29).
   919*    COPY ELC689PI.
   920******************************************************************
   921*                                                                *
   922*                            ELC689PI                            *
   923*                            VMOD=2.003                          *
   924*                                                                *
   925*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
   926*    CREDIT CORRESPONDENCE SUB-SYSTEM.  ANY CHANGES WILL         *
   927*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
   928*                                                                *
   929*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
   930*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
   931*    BETWEEN PROGRAMS.                                           *
   932*                                                                *
   933*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
   934*                                                                *
   935*               EL631 - EL689  - EL6891 - EL6892                 *
   936*                                                                *
   937******************************************************************
   938*                   C H A N G E   L O G
   939*
   940* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   941*-----------------------------------------------------------------
   942*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   943* EFFECTIVE    NUMBER
   944*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page  19
* EL689.cbl
   945* 081004                   PEMA  CONVERT TO PSUEDO CONVERSATIONAL
   946* 100705  CR2004072800004  PEMA  ADD LETTERS TO BE RESENT
   947* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
   948******************************************************************
   949
   950
   951         16  PI-689-WORK-AREA.
   952             20  PI-689-ALT-PRINTER-ID
   953                                 PIC  X(04).
   954             20  PI-689-ARCHIVE-NUMBER
   955                                 PIC  9(08).
   956             20  PI-689-ARCHIVE-SW
   957                                 PIC  X(01).
   958                 88  PI-689-ARCHIVE-LETTER VALUE 'Y'.
   959             20  PI-689-DATA-SOURCE
   960                                 PIC  X(01).
   961                 88  PI-689-SRC-ACCOUNT        VALUE '1'.
   962                 88  PI-689-SRC-CERTIFICATE    VALUE '2'.
   963                 88  PI-689-SRC-COMPENSATION   VALUE '3'.
   964                 88  PI-689-SRC-PEND-BUSINESS  VALUE '4'.
   965                 88  PI-689-SRC-CHECKS         VALUE '5'.
   966             20  PI-689-ERROR-IND
   967                                 PIC  X(01).
   968                 88  PI-689-ERR-DETECTED-PREV  VALUE 'Y'.
   969             20  PI-689-ERROR    PIC  9(04).
   970                 88  PI-689-NO-ERRORS-DETECTED VALUE 0000.
   971                 88  PI-689-FATAL-ERROR
   972                     VALUES 0004 0006 0008 0013 0023 0029 0033
   973                            0042 0047 0051 0066 0067 0070
   974                            0168 0169 0174 0175 0176 0177 0179
   975                            0180 0181 0182 0184 0185 0189 0190
   976                            0191
   977                            0215 0279 0280
   978                            0412 0413 0454
   979                            0533 0537
   980                            2055 2114 2208 2209 2216 2232 2369
   981                            2398 2433 2908 2999
   982                            3000 3770 3771 3775
   983                            7250 7365 7367 7368 7369 7370 7371
   984                            7272 7373 7374 7376 7377 7378 7379
   985                            7381 7388 7390 7393 7395 7396 7398
   986                            9095 9096 9281 9298 9299 9320 9327
   987                            9426 9427.
   988                 88  PI-689-STOP-ERROR
   989                     VALUES 0004 0008 0013 0023 0029 0033
   990                            0042 0047 0066 0067 0070
   991                            0168 0169 0174 0175 0176 0177
   992                            0181 0182 0184 0185 0189 0190
   993                            0279 0280
   994                            0412 0413 0454
   995                            2055 2208 2209 2216 2232
   996                            2398 2999
   997                            3000 3770 3771 3775
   998                            7250 7365 7369 7370 7371
   999                            7272 7373 7374 7376 7377 7378 7379
  1000                            7381 7388 7390 7393 7396 7398
  1001                            9095 9096 9299 9320 9426.
  1002             20  PI-689-FOLLOW-UP-DATE
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page  20
* EL689.cbl
  1003                                 PIC  X(02).
  1004             20  PI-689-FORM-NUMBER
  1005                                 PIC  X(04).
  1006             20  PI-689-LABEL-SOURCE
  1007                                 PIC X(01).
  1008                 88  PI-689-SOURCE-ACCOUNT  VALUE '1'.
  1009                 88  PI-689-SOURCE-CARRIER  VALUE '2'.
  1010                 88  PI-689-SOURCE-COMPANY  VALUE '3'.
  1011                 88  PI-689-SOURCE-COMP     VALUE '4'.
  1012                 88  PI-689-SOURCE-MAIL     VALUE '5'.
  1013                 88  PI-689-SOURCE-CHECK    VALUE '6'.
  1014                 88  PI-689-SOURCE-VARIABLE VALUE '7'.
  1015             20  PI-689-NUMBER-COPIES
  1016                                 PIC  9(01).
  1017             20  PI-689-NUMBER-LABEL-LINES
  1018                                 PIC  9(01).
  1019             20  PI-689-NUMBER-TEXT-RECORDS
  1020                                 PIC  9(03).
  1021             20  PI-689-PRINT-ORDER-SW
  1022                                 PIC  X(01).
  1023                 88  PI-689-PRINT-FIRST     VALUE '1'.
  1024                 88  PI-689-PRINT-SECOND    VALUE '2'.
  1025                 88  PI-689-PRINT-LATER     VALUE '3'.
  1026                 88  PI-689-PRINT-ONLY      VALUE '4'.
  1027             20  PI-689-PRINT-RESTRICTION
  1028                                 PIC  X(01).
  1029                 88  PI-689-VALID-RESTRICT     VALUE 'C' 'F'.
  1030                 88  PI-689-PRT-ONLY-WITH-CNTL VALUE 'C'.
  1031                 88  PI-689-PRT-ONLY-WITH-FORM VALUE 'F'.
  1032             20  PI-689-PRINT-SW PIC  X(01).
  1033                 88  PI-689-PRINT-PERFORMED VALUE '1'.
  1034             20  PI-689-RESEND-DATE-1
  1035                                 PIC  X(02).
  1036             20  PI-689-RESEND-LETR-1
  1037                                 PIC X(4).
  1038             20  PI-689-TEMP-STOR-ID
  1039                                 PIC  X(08).
  1040             20  PI-689-USE-SCREEN-IND
  1041                                 PIC  X(01).
  1042                 88  PI-689-CREATE-NO-SCREENS VALUE '1'.
  1043             20  PI-689-ARCH-POINTER
  1044                                 PIC S9(08) COMP.
  1045                 88  PI-689-GET-ARCH-MAIN     VALUE +0.
  1046             20  PI-689-ARCT-POINTER
  1047                                 PIC S9(08) COMP.
  1048                 88  PI-689-GET-ARCT-MAIN     VALUE +0.
  1049             20  PI-689-VARIABLE-DATA-GRP.
  1050                 24  PI-689-VARIABLE-DATA-1
  1051                                 PIC  X(30).
  1052                 24  PI-689-VARIABLE-DATA-2
  1053                                 PIC  X(30).
  1054                 24  PI-689-VARIABLE-DATA-3
  1055                                 PIC  X(30).
  1056                 24  PI-689-VARIABLE-DATA-4
  1057                                 PIC  X(30).
  1058
  1059         16  PI-689-KEY-DATA-FIELDS.
  1060             20  PI-689-ACCOUNT  PIC  X(10).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page  21
* EL689.cbl
  1061             20  PI-689-CARRIER  PIC  X(01).
  1062             20  PI-689-CERT-NO.
  1063                 24  PI-689-CERT-PRIME
  1064                                 PIC  X(10).
  1065                 24  PI-689-CERT-SFX
  1066                                 PIC  X(01).
  1067             20  PI-689-CHG-SEQ-NO
  1068                                 PIC S9(04)    COMP.
  1069             20  PI-689-CHG-SEQ-NOX REDEFINES PI-689-CHG-SEQ-NO
  1070                                 PIC  X(02).
  1071             20  PI-689-ENTRY-BATCH
  1072                                 PIC  X(06).
  1073             20  PI-689-EFF-DATE PIC  X(02).
  1074             20  PI-689-EXP-DATE PIC  X(02).
  1075             20  PI-689-GROUPING PIC  X(06).
  1076             20  PI-689-RESP-PERSON
  1077                                 PIC  X(10).
  1078             20  PI-689-SEQ-NO   PIC S9(08)    COMP.
  1079             20  PI-689-SEQ-NOX REDEFINES PI-689-SEQ-NO
  1080                                 PIC  X(04).
  1081             20  PI-689-STATE    PIC  X(02).
  1082             20  PI-689-TYPE     PIC  X(01).
  1083             20  PI-689-CONTROL  PIC S9(08)    COMP.
  1084             20  PI-689-ALT-SEQ-NO
  1085                                 PIC S9(04)    COMP.
  1086         16  PI-689-DATE-EDIT    PIC  X(08).
  1087         16  PI-689-FOLLOW-UP-EDIT
  1088                                 PIC  X(08).
  1089         16  PI-689-RESEND1-EDIT PIC  X(08).
  1090         16  PI-689-SEQ-EDIT     PIC  X(08).
  1091         16  PI-689-BCSEQ-EDIT   PIC  X(04).
  1092         16  PI-689-LBL-OVERRIDE PIC  X(01).
  1093             88  PI-689-LABELS-OVERRIDEN  VALUES 'N'.
  1094         16  PI-689-FATAL-CTR    PIC 999     COMP-3.
  1095         16  PI-689-FORCABLE-CTR PIC 999     COMP-3.
  1096         16  FILLER              PIC X(264).
  1097*        16  FILLER                        PIC X(276).
  1098*        16  FILLER                        PIC X(280).
  1099
  1100 01  FILLER                      PIC  X(20)
  1101                                 VALUE ':INTERFACE AREA ENDS'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page  22
* EL689.cbl
  1103 01  FILLER                      PIC  X(16)
  1104                        VALUE 'MAP AREA STARTS:'.
  1105*    COPY EL689S.
  1106 01  EL689AI.
  1107     05  FILLER            PIC  X(0012).
  1108*    -------------------------------
  1109     05  RUNDTEL PIC S9(0004) COMP.
  1110     05  RUNDTEF PIC  X(0001).
  1111     05  FILLER REDEFINES RUNDTEF.
  1112         10  RUNDTEA PIC  X(0001).
  1113     05  RUNDTEI PIC  X(0008).
  1114*    -------------------------------
  1115     05  RUNTIMEL PIC S9(0004) COMP.
  1116     05  RUNTIMEF PIC  X(0001).
  1117     05  FILLER REDEFINES RUNTIMEF.
  1118         10  RUNTIMEA PIC  X(0001).
  1119     05  RUNTIMEI PIC  X(0005).
  1120*    -------------------------------
  1121     05  COMPANYL PIC S9(0004) COMP.
  1122     05  COMPANYF PIC  X(0001).
  1123     05  FILLER REDEFINES COMPANYF.
  1124         10  COMPANYA PIC  X(0001).
  1125     05  COMPANYI PIC  X(0003).
  1126*    -------------------------------
  1127     05  USERIDL PIC S9(0004) COMP.
  1128     05  USERIDF PIC  X(0001).
  1129     05  FILLER REDEFINES USERIDF.
  1130         10  USERIDA PIC  X(0001).
  1131     05  USERIDI PIC  X(0004).
  1132*    -------------------------------
  1133     05  MAINTL PIC S9(0004) COMP.
  1134     05  MAINTF PIC  X(0001).
  1135     05  FILLER REDEFINES MAINTF.
  1136         10  MAINTA PIC  X(0001).
  1137     05  MAINTI PIC  X(0001).
  1138*    -------------------------------
  1139     05  FORML PIC S9(0004) COMP.
  1140     05  FORMF PIC  X(0001).
  1141     05  FILLER REDEFINES FORMF.
  1142         10  FORMA PIC  X(0001).
  1143     05  FORMI PIC  X(0004).
  1144*    -------------------------------
  1145     05  ARCHNUML PIC S9(0004) COMP.
  1146     05  ARCHNUMF PIC  X(0001).
  1147     05  FILLER REDEFINES ARCHNUMF.
  1148         10  ARCHNUMA PIC  X(0001).
  1149     05  ARCHNUMI PIC  99999999.
  1150*    -------------------------------
  1151     05  PRTRESTL PIC S9(0004) COMP.
  1152     05  PRTRESTF PIC  X(0001).
  1153     05  FILLER REDEFINES PRTRESTF.
  1154         10  PRTRESTA PIC  X(0001).
  1155     05  PRTRESTI PIC  X(0001).
  1156*    -------------------------------
  1157     05  FOLLOWL PIC S9(0004) COMP.
  1158     05  FOLLOWF PIC  X(0001).
  1159     05  FILLER REDEFINES FOLLOWF.
  1160         10  FOLLOWA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page  23
* EL689.cbl
  1161     05  FOLLOWI PIC  X(0008).
  1162*    -------------------------------
  1163     05  RESEND1L PIC S9(0004) COMP.
  1164     05  RESEND1F PIC  X(0001).
  1165     05  FILLER REDEFINES RESEND1F.
  1166         10  RESEND1A PIC  X(0001).
  1167     05  RESEND1I PIC  X(0008).
  1168*    -------------------------------
  1169     05  ADDRSL PIC S9(0004) COMP.
  1170     05  ADDRSF PIC  X(0001).
  1171     05  FILLER REDEFINES ADDRSF.
  1172         10  ADDRSA PIC  X(0001).
  1173     05  ADDRSI PIC  X(0001).
  1174*    -------------------------------
  1175     05  PRINTERL PIC S9(0004) COMP.
  1176     05  PRINTERF PIC  X(0001).
  1177     05  FILLER REDEFINES PRINTERF.
  1178         10  PRINTERA PIC  X(0001).
  1179     05  PRINTERI PIC  X(0004).
  1180*    -------------------------------
  1181     05  COPIESL PIC S9(0004) COMP.
  1182     05  COPIESF PIC  X(0001).
  1183     05  FILLER REDEFINES COPIESF.
  1184         10  COPIESA PIC  X(0001).
  1185     05  COPIESI PIC  X(0001).
  1186*    -------------------------------
  1187     05  DATASORL PIC S9(0004) COMP.
  1188     05  DATASORF PIC  X(0001).
  1189     05  FILLER REDEFINES DATASORF.
  1190         10  DATASORA PIC  X(0001).
  1191     05  DATASORI PIC  X(0001).
  1192*    -------------------------------
  1193     05  ADDRLBLL PIC S9(0004) COMP.
  1194     05  ADDRLBLF PIC  X(0001).
  1195     05  FILLER REDEFINES ADDRLBLF.
  1196         10  ADDRLBLA PIC  X(0001).
  1197     05  ADDRLBLI PIC  X(0001).
  1198*    -------------------------------
  1199     05  CARRIERL PIC S9(0004) COMP.
  1200     05  CARRIERF PIC  X(0001).
  1201     05  FILLER REDEFINES CARRIERF.
  1202         10  CARRIERA PIC  X(0001).
  1203     05  CARRIERI PIC  X(0001).
  1204*    -------------------------------
  1205     05  GROUPL PIC S9(0004) COMP.
  1206     05  GROUPF PIC  X(0001).
  1207     05  FILLER REDEFINES GROUPF.
  1208         10  GROUPA PIC  X(0001).
  1209     05  GROUPI PIC  X(0006).
  1210*    -------------------------------
  1211     05  STATEL PIC S9(0004) COMP.
  1212     05  STATEF PIC  X(0001).
  1213     05  FILLER REDEFINES STATEF.
  1214         10  STATEA PIC  X(0001).
  1215     05  STATEI PIC  X(0002).
  1216*    -------------------------------
  1217     05  ACCTL PIC S9(0004) COMP.
  1218     05  ACCTF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page  24
* EL689.cbl
  1219     05  FILLER REDEFINES ACCTF.
  1220         10  ACCTA PIC  X(0001).
  1221     05  ACCTI PIC  X(0010).
  1222*    -------------------------------
  1223     05  CERTL PIC S9(0004) COMP.
  1224     05  CERTF PIC  X(0001).
  1225     05  FILLER REDEFINES CERTF.
  1226         10  CERTA PIC  X(0001).
  1227     05  CERTI PIC  X(0010).
  1228*    -------------------------------
  1229     05  SFXL PIC S9(0004) COMP.
  1230     05  SFXF PIC  X(0001).
  1231     05  FILLER REDEFINES SFXF.
  1232         10  SFXA PIC  X(0001).
  1233     05  SFXI PIC  X(0001).
  1234*    -------------------------------
  1235     05  TYPEL PIC S9(0004) COMP.
  1236     05  TYPEF PIC  X(0001).
  1237     05  FILLER REDEFINES TYPEF.
  1238         10  TYPEA PIC  X(0001).
  1239     05  TYPEI PIC  X(0001).
  1240*    -------------------------------
  1241     05  DATEL PIC S9(0004) COMP.
  1242     05  DATEF PIC  X(0001).
  1243     05  FILLER REDEFINES DATEF.
  1244         10  DATEA PIC  X(0001).
  1245     05  DATEI PIC  X(0008).
  1246*    -------------------------------
  1247     05  RPERSONL PIC S9(0004) COMP.
  1248     05  RPERSONF PIC  X(0001).
  1249     05  FILLER REDEFINES RPERSONF.
  1250         10  RPERSONA PIC  X(0001).
  1251     05  RPERSONI PIC  X(0010).
  1252*    -------------------------------
  1253     05  BENTRYL PIC S9(0004) COMP.
  1254     05  BENTRYF PIC  X(0001).
  1255     05  FILLER REDEFINES BENTRYF.
  1256         10  BENTRYA PIC  X(0001).
  1257     05  BENTRYI PIC  X(0006).
  1258*    -------------------------------
  1259     05  SEQL PIC S9(0004) COMP.
  1260     05  SEQF PIC  X(0001).
  1261     05  FILLER REDEFINES SEQF.
  1262         10  SEQA PIC  X(0001).
  1263     05  SEQI PIC  X(0008).
  1264*    -------------------------------
  1265     05  BCSEQL PIC S9(0004) COMP.
  1266     05  BCSEQF PIC  X(0001).
  1267     05  FILLER REDEFINES BCSEQF.
  1268         10  BCSEQA PIC  X(0001).
  1269     05  BCSEQI PIC  X(0004).
  1270*    -------------------------------
  1271     05  L1L PIC S9(0004) COMP.
  1272     05  L1F PIC  X(0001).
  1273     05  FILLER REDEFINES L1F.
  1274         10  L1A PIC  X(0001).
  1275     05  L1I PIC  X(0003).
  1276*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page  25
* EL689.cbl
  1277     05  TEXT1L PIC S9(0004) COMP.
  1278     05  TEXT1F PIC  X(0001).
  1279     05  FILLER REDEFINES TEXT1F.
  1280         10  TEXT1A PIC  X(0001).
  1281     05  TEXT1I PIC  X(0070).
  1282*    -------------------------------
  1283     05  L2L PIC S9(0004) COMP.
  1284     05  L2F PIC  X(0001).
  1285     05  FILLER REDEFINES L2F.
  1286         10  L2A PIC  X(0001).
  1287     05  L2I PIC  X(0003).
  1288*    -------------------------------
  1289     05  TEXT2L PIC S9(0004) COMP.
  1290     05  TEXT2F PIC  X(0001).
  1291     05  FILLER REDEFINES TEXT2F.
  1292         10  TEXT2A PIC  X(0001).
  1293     05  TEXT2I PIC  X(0070).
  1294*    -------------------------------
  1295     05  L3L PIC S9(0004) COMP.
  1296     05  L3F PIC  X(0001).
  1297     05  FILLER REDEFINES L3F.
  1298         10  L3A PIC  X(0001).
  1299     05  L3I PIC  X(0003).
  1300*    -------------------------------
  1301     05  TEXT3L PIC S9(0004) COMP.
  1302     05  TEXT3F PIC  X(0001).
  1303     05  FILLER REDEFINES TEXT3F.
  1304         10  TEXT3A PIC  X(0001).
  1305     05  TEXT3I PIC  X(0070).
  1306*    -------------------------------
  1307     05  L4L PIC S9(0004) COMP.
  1308     05  L4F PIC  X(0001).
  1309     05  FILLER REDEFINES L4F.
  1310         10  L4A PIC  X(0001).
  1311     05  L4I PIC  X(0003).
  1312*    -------------------------------
  1313     05  TEXT4L PIC S9(0004) COMP.
  1314     05  TEXT4F PIC  X(0001).
  1315     05  FILLER REDEFINES TEXT4F.
  1316         10  TEXT4A PIC  X(0001).
  1317     05  TEXT4I PIC  X(0070).
  1318*    -------------------------------
  1319     05  L5L PIC S9(0004) COMP.
  1320     05  L5F PIC  X(0001).
  1321     05  FILLER REDEFINES L5F.
  1322         10  L5A PIC  X(0001).
  1323     05  L5I PIC  X(0003).
  1324*    -------------------------------
  1325     05  TEXT5L PIC S9(0004) COMP.
  1326     05  TEXT5F PIC  X(0001).
  1327     05  FILLER REDEFINES TEXT5F.
  1328         10  TEXT5A PIC  X(0001).
  1329     05  TEXT5I PIC  X(0070).
  1330*    -------------------------------
  1331     05  L6L PIC S9(0004) COMP.
  1332     05  L6F PIC  X(0001).
  1333     05  FILLER REDEFINES L6F.
  1334         10  L6A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page  26
* EL689.cbl
  1335     05  L6I PIC  X(0003).
  1336*    -------------------------------
  1337     05  TEXT6L PIC S9(0004) COMP.
  1338     05  TEXT6F PIC  X(0001).
  1339     05  FILLER REDEFINES TEXT6F.
  1340         10  TEXT6A PIC  X(0001).
  1341     05  TEXT6I PIC  X(0070).
  1342*    -------------------------------
  1343     05  L7L PIC S9(0004) COMP.
  1344     05  L7F PIC  X(0001).
  1345     05  FILLER REDEFINES L7F.
  1346         10  L7A PIC  X(0001).
  1347     05  L7I PIC  X(0003).
  1348*    -------------------------------
  1349     05  TEXT7L PIC S9(0004) COMP.
  1350     05  TEXT7F PIC  X(0001).
  1351     05  FILLER REDEFINES TEXT7F.
  1352         10  TEXT7A PIC  X(0001).
  1353     05  TEXT7I PIC  X(0070).
  1354*    -------------------------------
  1355     05  L8L PIC S9(0004) COMP.
  1356     05  L8F PIC  X(0001).
  1357     05  FILLER REDEFINES L8F.
  1358         10  L8A PIC  X(0001).
  1359     05  L8I PIC  X(0003).
  1360*    -------------------------------
  1361     05  TEXT8L PIC S9(0004) COMP.
  1362     05  TEXT8F PIC  X(0001).
  1363     05  FILLER REDEFINES TEXT8F.
  1364         10  TEXT8A PIC  X(0001).
  1365     05  TEXT8I PIC  X(0070).
  1366*    -------------------------------
  1367     05  L9L PIC S9(0004) COMP.
  1368     05  L9F PIC  X(0001).
  1369     05  FILLER REDEFINES L9F.
  1370         10  L9A PIC  X(0001).
  1371     05  L9I PIC  X(0003).
  1372*    -------------------------------
  1373     05  TEXT9L PIC S9(0004) COMP.
  1374     05  TEXT9F PIC  X(0001).
  1375     05  FILLER REDEFINES TEXT9F.
  1376         10  TEXT9A PIC  X(0001).
  1377     05  TEXT9I PIC  X(0070).
  1378*    -------------------------------
  1379     05  L10L PIC S9(0004) COMP.
  1380     05  L10F PIC  X(0001).
  1381     05  FILLER REDEFINES L10F.
  1382         10  L10A PIC  X(0001).
  1383     05  L10I PIC  X(0003).
  1384*    -------------------------------
  1385     05  TEXT10L PIC S9(0004) COMP.
  1386     05  TEXT10F PIC  X(0001).
  1387     05  FILLER REDEFINES TEXT10F.
  1388         10  TEXT10A PIC  X(0001).
  1389     05  TEXT10I PIC  X(0070).
  1390*    -------------------------------
  1391     05  L11L PIC S9(0004) COMP.
  1392     05  L11F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page  27
* EL689.cbl
  1393     05  FILLER REDEFINES L11F.
  1394         10  L11A PIC  X(0001).
  1395     05  L11I PIC  X(0003).
  1396*    -------------------------------
  1397     05  TEXT11L PIC S9(0004) COMP.
  1398     05  TEXT11F PIC  X(0001).
  1399     05  FILLER REDEFINES TEXT11F.
  1400         10  TEXT11A PIC  X(0001).
  1401     05  TEXT11I PIC  X(0070).
  1402*    -------------------------------
  1403     05  L12L PIC S9(0004) COMP.
  1404     05  L12F PIC  X(0001).
  1405     05  FILLER REDEFINES L12F.
  1406         10  L12A PIC  X(0001).
  1407     05  L12I PIC  X(0003).
  1408*    -------------------------------
  1409     05  TEXT12L PIC S9(0004) COMP.
  1410     05  TEXT12F PIC  X(0001).
  1411     05  FILLER REDEFINES TEXT12F.
  1412         10  TEXT12A PIC  X(0001).
  1413     05  TEXT12I PIC  X(0070).
  1414*    -------------------------------
  1415     05  ERRMSGL PIC S9(0004) COMP.
  1416     05  ERRMSGF PIC  X(0001).
  1417     05  FILLER REDEFINES ERRMSGF.
  1418         10  ERRMSGA PIC  X(0001).
  1419     05  ERRMSGI PIC  X(0079).
  1420*    -------------------------------
  1421     05  ENTERPFL PIC S9(0004) COMP.
  1422     05  ENTERPFF PIC  X(0001).
  1423     05  FILLER REDEFINES ENTERPFF.
  1424         10  ENTERPFA PIC  X(0001).
  1425     05  ENTERPFI PIC  99.
  1426*    -------------------------------
  1427     05  PF8HDL PIC S9(0004) COMP.
  1428     05  PF8HDF PIC  X(0001).
  1429     05  FILLER REDEFINES PF8HDF.
  1430         10  PF8HDA PIC  X(0001).
  1431     05  PF8HDI PIC  X(0022).
  1432 01  EL689AO REDEFINES EL689AI.
  1433     05  FILLER            PIC  X(0012).
  1434*    -------------------------------
  1435     05  FILLER            PIC  X(0003).
  1436     05  RUNDTEO PIC  X(0008).
  1437*    -------------------------------
  1438     05  FILLER            PIC  X(0003).
  1439     05  RUNTIMEO PIC  99.99.
  1440*    -------------------------------
  1441     05  FILLER            PIC  X(0003).
  1442     05  COMPANYO PIC  X(0003).
  1443*    -------------------------------
  1444     05  FILLER            PIC  X(0003).
  1445     05  USERIDO PIC  X(0004).
  1446*    -------------------------------
  1447     05  FILLER            PIC  X(0003).
  1448     05  MAINTO PIC  X(0001).
  1449*    -------------------------------
  1450     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page  28
* EL689.cbl
  1451     05  FORMO PIC  X(0004).
  1452*    -------------------------------
  1453     05  FILLER            PIC  X(0003).
  1454     05  ARCHNUMO PIC  ZZZZZZZ9.
  1455*    -------------------------------
  1456     05  FILLER            PIC  X(0003).
  1457     05  PRTRESTO PIC  X(0001).
  1458*    -------------------------------
  1459     05  FILLER            PIC  X(0003).
  1460     05  FOLLOWO PIC  X(0008).
  1461*    -------------------------------
  1462     05  FILLER            PIC  X(0003).
  1463     05  RESEND1O PIC  X(0008).
  1464*    -------------------------------
  1465     05  FILLER            PIC  X(0003).
  1466     05  ADDRSO PIC  X(0001).
  1467*    -------------------------------
  1468     05  FILLER            PIC  X(0003).
  1469     05  PRINTERO PIC  X(0004).
  1470*    -------------------------------
  1471     05  FILLER            PIC  X(0003).
  1472     05  COPIESO PIC  X(0001).
  1473*    -------------------------------
  1474     05  FILLER            PIC  X(0003).
  1475     05  DATASORO PIC  X(0001).
  1476*    -------------------------------
  1477     05  FILLER            PIC  X(0003).
  1478     05  ADDRLBLO PIC  X(0001).
  1479*    -------------------------------
  1480     05  FILLER            PIC  X(0003).
  1481     05  CARRIERO PIC  X(0001).
  1482*    -------------------------------
  1483     05  FILLER            PIC  X(0003).
  1484     05  GROUPO PIC  X(0006).
  1485*    -------------------------------
  1486     05  FILLER            PIC  X(0003).
  1487     05  STATEO PIC  X(0002).
  1488*    -------------------------------
  1489     05  FILLER            PIC  X(0003).
  1490     05  ACCTO PIC  X(0010).
  1491*    -------------------------------
  1492     05  FILLER            PIC  X(0003).
  1493     05  CERTO PIC  X(0010).
  1494*    -------------------------------
  1495     05  FILLER            PIC  X(0003).
  1496     05  SFXO PIC  X(0001).
  1497*    -------------------------------
  1498     05  FILLER            PIC  X(0003).
  1499     05  TYPEO PIC  X(0001).
  1500*    -------------------------------
  1501     05  FILLER            PIC  X(0003).
  1502     05  DATEO PIC  X(0008).
  1503*    -------------------------------
  1504     05  FILLER            PIC  X(0003).
  1505     05  RPERSONO PIC  X(0010).
  1506*    -------------------------------
  1507     05  FILLER            PIC  X(0003).
  1508     05  BENTRYO PIC  X(0006).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page  29
* EL689.cbl
  1509*    -------------------------------
  1510     05  FILLER            PIC  X(0003).
  1511     05  SEQO PIC  X(0008).
  1512*    -------------------------------
  1513     05  FILLER            PIC  X(0003).
  1514     05  BCSEQO PIC  X(0004).
  1515*    -------------------------------
  1516     05  FILLER            PIC  X(0003).
  1517     05  L1O PIC  X(0003).
  1518*    -------------------------------
  1519     05  FILLER            PIC  X(0003).
  1520     05  TEXT1O PIC  X(0070).
  1521*    -------------------------------
  1522     05  FILLER            PIC  X(0003).
  1523     05  L2O PIC  X(0003).
  1524*    -------------------------------
  1525     05  FILLER            PIC  X(0003).
  1526     05  TEXT2O PIC  X(0070).
  1527*    -------------------------------
  1528     05  FILLER            PIC  X(0003).
  1529     05  L3O PIC  X(0003).
  1530*    -------------------------------
  1531     05  FILLER            PIC  X(0003).
  1532     05  TEXT3O PIC  X(0070).
  1533*    -------------------------------
  1534     05  FILLER            PIC  X(0003).
  1535     05  L4O PIC  X(0003).
  1536*    -------------------------------
  1537     05  FILLER            PIC  X(0003).
  1538     05  TEXT4O PIC  X(0070).
  1539*    -------------------------------
  1540     05  FILLER            PIC  X(0003).
  1541     05  L5O PIC  X(0003).
  1542*    -------------------------------
  1543     05  FILLER            PIC  X(0003).
  1544     05  TEXT5O PIC  X(0070).
  1545*    -------------------------------
  1546     05  FILLER            PIC  X(0003).
  1547     05  L6O PIC  X(0003).
  1548*    -------------------------------
  1549     05  FILLER            PIC  X(0003).
  1550     05  TEXT6O PIC  X(0070).
  1551*    -------------------------------
  1552     05  FILLER            PIC  X(0003).
  1553     05  L7O PIC  X(0003).
  1554*    -------------------------------
  1555     05  FILLER            PIC  X(0003).
  1556     05  TEXT7O PIC  X(0070).
  1557*    -------------------------------
  1558     05  FILLER            PIC  X(0003).
  1559     05  L8O PIC  X(0003).
  1560*    -------------------------------
  1561     05  FILLER            PIC  X(0003).
  1562     05  TEXT8O PIC  X(0070).
  1563*    -------------------------------
  1564     05  FILLER            PIC  X(0003).
  1565     05  L9O PIC  X(0003).
  1566*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page  30
* EL689.cbl
  1567     05  FILLER            PIC  X(0003).
  1568     05  TEXT9O PIC  X(0070).
  1569*    -------------------------------
  1570     05  FILLER            PIC  X(0003).
  1571     05  L10O PIC  X(0003).
  1572*    -------------------------------
  1573     05  FILLER            PIC  X(0003).
  1574     05  TEXT10O PIC  X(0070).
  1575*    -------------------------------
  1576     05  FILLER            PIC  X(0003).
  1577     05  L11O PIC  X(0003).
  1578*    -------------------------------
  1579     05  FILLER            PIC  X(0003).
  1580     05  TEXT11O PIC  X(0070).
  1581*    -------------------------------
  1582     05  FILLER            PIC  X(0003).
  1583     05  L12O PIC  X(0003).
  1584*    -------------------------------
  1585     05  FILLER            PIC  X(0003).
  1586     05  TEXT12O PIC  X(0070).
  1587*    -------------------------------
  1588     05  FILLER            PIC  X(0003).
  1589     05  ERRMSGO PIC  X(0079).
  1590*    -------------------------------
  1591     05  FILLER            PIC  X(0003).
  1592     05  ENTERPFO PIC  X(0002).
  1593*    -------------------------------
  1594     05  FILLER            PIC  X(0003).
  1595     05  PF8HDO PIC  X(0022).
  1596*    -------------------------------
  1597 01  W-MAP-REDEF REDEFINES EL689AI.
  1598     12  FILLER                  PIC X(218).
  1599*    12  FILLER                  PIC X(240).
  1600     12  EL689RI.
  1601         16  W-TEXT-LINES OCCURS 12 TIMES INDEXED BY W-SC-NDX.
  1602             20  W-SC-LINEL      PIC S9(04) COMP.
  1603             20  W-SC-LINEA      PIC  X(01).
  1604             20  W-SC-LINE       PIC  X(03).
  1605             20  W-SC-TEXTL      PIC S9(04) COMP.
  1606             20  W-SC-TEXTA      PIC  X(01).
  1607             20  W-SC-TEXT       PIC  X(70).
  1608*    12  FILLER                  PIC  X(87).
  1609     12  FILLER                  PIC  X(112).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page  31
* EL689.cbl
  1611 01  W-CONSTANT-AREA.
  1612     12  FILLER                  PIC  X(18)
  1613                                 VALUE 'PROGRAM CONSTANTS:'.
  1614     12  W-APPL-SCRTY-NDX        PIC S9(04)  COMP  VALUE +03.
  1615     12  W-ARCH-LENGTH           PIC S9(04)  COMP  VALUE +250.
  1616     12  W-ARCT-LENGTH           PIC S9(04)  COMP  VALUE +1640.
  1617     12  W-MAX-LINES             PIC S9(03) VALUE +300 COMP-3.
  1618     12  W-NUM-LINES-PER-SCREEN  PIC  9(02)        VALUE 12.
  1619     12  W-TS-NUM-REC-IN-GROUP   PIC  9(02)        VALUE 50.
  1620     12  W-TS-LENGTH             PIC S9(04)  COMP  VALUE +3650.
  1621     12  W-TS-MAP-LENGTH         PIC S9(04)  COMP  VALUE +1260.
  1622     12  W-ZEROS                 PIC S9(03) VALUE +000 COMP-3.
  1623
  1624     12  W-ACCT-FILE-ID          PIC  X(08) VALUE 'ERACCT'.
  1625     12  W-ACCT2-FILE-ID         PIC  X(08) VALUE 'ERACCT2'.
  1626     12  W-ARCH-FILE-ID          PIC  X(08) VALUE 'ERARCH'.
  1627     12  W-ARCH2-FILE-ID         PIC  X(08) VALUE 'ERARCH2'.
  1628     12  W-ARCH3-FILE-ID         PIC  X(08) VALUE 'ERARCH3'.
  1629     12  W-ARCH4-FILE-ID         PIC  X(08) VALUE 'ERARCH4'.
  1630     12  W-ARCH5-FILE-ID         PIC  X(08) VALUE 'ERARCH5'.
  1631     12  W-ARCT-FILE-ID          PIC  X(08) VALUE 'ERARCT'.
  1632     12  W-CERT-FILE-ID          PIC  X(08) VALUE 'ELCERT'.
  1633     12  W-CHEK-FILE-ID          PIC  X(08) VALUE 'ERCHEK'.
  1634     12  W-CNTL-FILE-ID          PIC  X(08) VALUE 'ELCNTL'.
  1635     12  W-COMP-FILE-ID          PIC  X(08) VALUE 'ERCOMP'.
  1636     12  W-GETMAIN-SPACE         PIC  X(01) VALUE SPACE.
  1637     12  W-LGXX-ID               PIC  X(04) VALUE 'LGXX'.
  1638     12  W-LINK-001              PIC  X(05) VALUE 'EL001'.
  1639     12  W-LINK-004              PIC  X(05) VALUE 'EL004'.
  1640     12  W-LINK-ELDATCV          PIC  X(07) VALUE 'ELDATCV'.
  1641     12  W-LOWER-CASE            PIC  X(26)
  1642         VALUE 'abcdefghijklmnopqrstuvwxyz'.
  1643     12  W-MAIL-FILE-ID          PIC  X(08) VALUE 'ERMAIL'.
  1644     12  W-MAP.
  1645         16  W-MAP-PREFIX        PIC  X(02) VALUE 'EL'.
  1646         16  W-MAP-NUM           PIC  X(04) VALUE '689A'.
  1647         16  W-MAP-FILLER        PIC  X(02) VALUE SPACES.
  1648     12  W-MAPSET                PIC  X(08) VALUE 'EL689S'.
  1649     12  W-PGM-EL1042            PIC  X(08) VALUE 'EL1042'.
  1650     12  W-PGM-EL690             PIC  X(08) VALUE 'EL690'.
  1651     12  W-PGM-EL626             PIC  X(08) VALUE 'EL626'.
  1652     12  W-PNDB-FILE-ID          PIC  X(08) VALUE 'ERPNDB'.
  1653     12  W-PRINT-TRANS           PIC  X(04) VALUE 'EXH5'.
  1654     12  W-PYAJ-FILE-ID          PIC  X(08) VALUE 'ERPYAJ'.
  1655
  1656     12  W-TEXT-FILE-ID          PIC  X(08) VALUE 'ELLETR'.
  1657     12  W-THIS-PGM              PIC  X(08) VALUE 'EL689'.
  1658     12  W-TOP-FORM              PIC  X(70)
  1659                              VALUE '*****TOP OF FORM *****'.
  1660     12  W-TRANSACTION           PIC  X(04) VALUE 'EXH3'.
  1661     12  W-UPPER-CASE            PIC  X(26)
  1662         VALUE 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'.
  1663     12  W-XCTL-005              PIC  X(05) VALUE 'EL005'.
  1664     12  W-XCTL-010              PIC  X(05) VALUE 'EL010'.
  1665     12  W-XCTL-626              PIC  X(05) VALUE 'EL626'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page  32
* EL689.cbl
  1667 01  W-VARIABLE-PROCESS-CNTLS.
  1668     12  FILLER                  PIC  X(26)
  1669                        VALUE 'VARIABLE WORK AREA STARTS:'.
  1670     12  W-NUM-OF-VARIABLES      PIC S9(03) VALUE +189 COMP-3.
  1671     12  W-VAR-HOLD.
  1672         16  W-V1                PIC  X(01).
  1673         16  W-V2                PIC  X(01).
  1674         16  W-V3                PIC  X(01).
  1675     12  FILLER REDEFINES W-VAR-HOLD.
  1676         16  W-VAR-RELATIVE-NUM  PIC  9(03).
  1677     12  W-FIELD-SQUEEZE-IND     PIC  X(01).
  1678         88  W-SQUEEZE-FIELD          VALUE '#'.
  1679
  1680 01  W-SUPPORTED-VARIABLES.
  1681
  1682*****************COMPANY VARIABLES - ELCNTL ********************
  1683*****COMPANY NAME
  1684     12  FILLER                  PIC  X(03) VALUE '001'.
  1685     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1686     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1687     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1688     12  FILLER                  PIC S9(04) COMP VALUE +01.
  1689
  1690*****FULL COMPANY ADDRESS
  1691     12  FILLER                  PIC  X(03) VALUE '002'.
  1692     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1693     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1694     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1695     12  FILLER                  PIC S9(04) COMP VALUE +01.
  1696
  1697     12  FILLER                  PIC  X(03) VALUE '003'.
  1698     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1699     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1700     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1701     12  FILLER                  PIC S9(04) COMP VALUE +01.
  1702
  1703     12  FILLER                  PIC  X(03) VALUE '004'.
  1704     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1705     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1706     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1707     12  FILLER                  PIC S9(04) COMP VALUE +01.
  1708
  1709     12  FILLER                  PIC  X(03) VALUE '005'.
  1710     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1711     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1712     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1713     12  FILLER                  PIC S9(04) COMP VALUE +01.
  1714
  1715     12  FILLER                  PIC  X(03) VALUE '006'.
  1716     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1717     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1718     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1719     12  FILLER                  PIC S9(04) COMP VALUE +01.
  1720
  1721*****REMAINING 4 ARE NOT CURRENTLY USED
  1722     12  FILLER                  PIC  X(03) VALUE '007'.
  1723     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1724     12  FILLER                  PIC  X(30) VALUE ALL '*'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page  33
* EL689.cbl
  1725     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  1726     12  FILLER                  PIC S9(04) COMP VALUE +01.
  1727
  1728     12  FILLER                  PIC  X(03) VALUE '008'.
  1729     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1730     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1731     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  1732     12  FILLER                  PIC S9(04) COMP VALUE +01.
  1733
  1734     12  FILLER                  PIC  X(03) VALUE '009'.
  1735     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1736     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1737     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  1738     12  FILLER                  PIC S9(04) COMP VALUE +01.
  1739
  1740     12  FILLER                  PIC  X(03) VALUE '010'.
  1741     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1742     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1743     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  1744     12  FILLER                  PIC S9(04) COMP VALUE +01.
  1745
  1746************ LIFE BENEFIT VARIABLES - ELCNTL *******************
  1747*****LIFE BENEFIT DESCRIPTION
  1748     12  FILLER                  PIC  X(03) VALUE '011'.
  1749     12  FILLER                  PIC S9(04) COMP VALUE +10.
  1750     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1751     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1752     12  FILLER                  PIC S9(04) COMP VALUE +02.
  1753
  1754*****REMAINING 3 ARE NOT CURRENTLY USED
  1755     12  FILLER                  PIC  X(03) VALUE '012'.
  1756     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1757     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1758     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  1759     12  FILLER                  PIC S9(04) COMP VALUE +02.
  1760
  1761     12  FILLER                  PIC  X(03) VALUE '013'.
  1762     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1763     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1764     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  1765     12  FILLER                  PIC S9(04) COMP VALUE +02.
  1766
  1767     12  FILLER                  PIC  X(03) VALUE '014'.
  1768     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1769     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1770     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  1771     12  FILLER                  PIC S9(04) COMP VALUE +02.
  1772
  1773************* A&H BENEFIT VARIABLES - ELCNTL *******************
  1774*****AH BENEFIT DESCRIPTION
  1775     12  FILLER                  PIC  X(03) VALUE '015'.
  1776     12  FILLER                  PIC S9(04) COMP VALUE +10.
  1777     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1778     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1779     12  FILLER                  PIC S9(04) COMP VALUE +03.
  1780
  1781*****ELIMINATION PERIOD
  1782     12  FILLER                  PIC  X(03) VALUE '016'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page  34
* EL689.cbl
  1783     12  FILLER                  PIC S9(04) COMP VALUE +2.
  1784     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1785     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  1786     12  FILLER                  PIC S9(04) COMP VALUE +03.
  1787
  1788*****REMAINING 3 ARE NOT CURRENTLY USED
  1789     12  FILLER                  PIC  X(03) VALUE '017'.
  1790     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1791     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1792     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  1793     12  FILLER                  PIC S9(04) COMP VALUE +03.
  1794
  1795     12  FILLER                  PIC  X(03) VALUE '018'.
  1796     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1797     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1798     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  1799     12  FILLER                  PIC S9(04) COMP VALUE +03.
  1800
  1801     12  FILLER                  PIC  X(03) VALUE '019'.
  1802     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1803     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1804     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  1805     12  FILLER                  PIC S9(04) COMP VALUE +03.
  1806
  1807*****************CARRIER VARIABLES - ELCNTL ********************
  1808*****CARRIER NAME
  1809     12  FILLER                  PIC  X(03) VALUE '020'.
  1810     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1811     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1812     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1813     12  FILLER                  PIC S9(04) COMP VALUE +04.
  1814
  1815*****FULL CARRIER ADDRESS
  1816     12  FILLER                  PIC  X(03) VALUE '021'.
  1817     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1818     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1819     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1820     12  FILLER                  PIC S9(04) COMP VALUE +04.
  1821
  1822     12  FILLER                  PIC  X(03) VALUE '022'.
  1823     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1824     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1825     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1826     12  FILLER                  PIC S9(04) COMP VALUE +04.
  1827
  1828     12  FILLER                  PIC  X(03) VALUE '023'.
  1829     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1830     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1831     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1832     12  FILLER                  PIC S9(04) COMP VALUE +04.
  1833
  1834     12  FILLER                  PIC  X(03) VALUE '024'.
  1835     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1836     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1837     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1838     12  FILLER                  PIC S9(04) COMP VALUE +04.
  1839
  1840     12  FILLER                  PIC  X(03) VALUE '025'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page  35
* EL689.cbl
  1841     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1842     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1843     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1844     12  FILLER                  PIC S9(04) COMP VALUE +04.
  1845
  1846*****CARRIER PHONE NUMBER
  1847     12  FILLER                  PIC  X(03) VALUE '026'.
  1848     12  FILLER                  PIC S9(04) COMP VALUE +12.
  1849     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1850     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  1851     12  FILLER                  PIC S9(04) COMP VALUE +04.
  1852
  1853*****REMAINING 4 ARE NOT CURRENTLY USED
  1854     12  FILLER                  PIC  X(03) VALUE '027'.
  1855     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1856     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1857     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  1858     12  FILLER                  PIC S9(04) COMP VALUE +04.
  1859
  1860     12  FILLER                  PIC  X(03) VALUE '028'.
  1861     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1862     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1863     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  1864     12  FILLER                  PIC S9(04) COMP VALUE +04.
  1865
  1866     12  FILLER                  PIC  X(03) VALUE '029'.
  1867     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1868     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1869     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  1870     12  FILLER                  PIC S9(04) COMP VALUE +04.
  1871
  1872     12  FILLER                  PIC  X(03) VALUE '030'.
  1873     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1874     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1875     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  1876     12  FILLER                  PIC S9(04) COMP VALUE +04.
  1877
  1878***************** MAIL VARIABLES - ELMAIL **********************
  1879*****FULL MAIL ADDRESS
  1880     12  FILLER                  PIC  X(03) VALUE '031'.
  1881     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1882     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1883     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1884     12  FILLER                  PIC S9(04) COMP VALUE +05.
  1885
  1886     12  FILLER                  PIC  X(03) VALUE '032'.
  1887     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1888     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1889     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1890     12  FILLER                  PIC S9(04) COMP VALUE +05.
  1891
  1892     12  FILLER                  PIC  X(03) VALUE '033'.
  1893     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1894     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1895     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1896     12  FILLER                  PIC S9(04) COMP VALUE +05.
  1897
  1898     12  FILLER                  PIC  X(03) VALUE '034'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page  36
* EL689.cbl
  1899     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1900     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1901     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1902     12  FILLER                  PIC S9(04) COMP VALUE +05.
  1903
  1904     12  FILLER                  PIC  X(03) VALUE '035'.
  1905     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1906     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1907     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1908     12  FILLER                  PIC S9(04) COMP VALUE +05.
  1909
  1910     12  FILLER                  PIC  X(03) VALUE '036'.
  1911     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1912     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1913     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1914     12  FILLER                  PIC S9(04) COMP VALUE +05.
  1915**** CRED BENE NAME FROM ERMAIL
  1916     12  FILLER                  PIC  X(03) VALUE '037'.
  1917     12  FILLER                  PIC S9(04) COMP VALUE +25.
  1918     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1919     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  1920     12  FILLER                  PIC S9(04) COMP VALUE +05.
  1921*****REMAINING 2 ARE NOT CURRENTLY USED
  1922     12  FILLER                  PIC  X(03) VALUE '038'.
  1923     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1924     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1925     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  1926     12  FILLER                  PIC S9(04) COMP VALUE +05.
  1927
  1928     12  FILLER                  PIC  X(03) VALUE '039'.
  1929     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1930     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1931     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  1932     12  FILLER                  PIC S9(04) COMP VALUE +05.
  1933
  1934*************** ACCOUNT VARIABLES - ERACCT *********************
  1935*****ACCOUNT NAME
  1936     12  FILLER                  PIC  X(03) VALUE '040'.
  1937     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1938     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1939     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1940     12  FILLER                  PIC S9(04) COMP VALUE +06.
  1941
  1942*****FULL ACCOUNT ADDRESS
  1943     12  FILLER                  PIC  X(03) VALUE '041'.
  1944     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1945     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1946     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1947     12  FILLER                  PIC S9(04) COMP VALUE +06.
  1948
  1949     12  FILLER                  PIC  X(03) VALUE '042'.
  1950     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1951     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1952     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1953     12  FILLER                  PIC S9(04) COMP VALUE +06.
  1954
  1955     12  FILLER                  PIC  X(03) VALUE '043'.
  1956     12  FILLER                  PIC S9(04) COMP VALUE +30.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page  37
* EL689.cbl
  1957     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1958     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1959     12  FILLER                  PIC S9(04) COMP VALUE +06.
  1960
  1961     12  FILLER                  PIC  X(03) VALUE '044'.
  1962     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1963     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1964     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1965     12  FILLER                  PIC S9(04) COMP VALUE +06.
  1966
  1967     12  FILLER                  PIC  X(03) VALUE '045'.
  1968     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1969     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1970     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1971     12  FILLER                  PIC S9(04) COMP VALUE +06.
  1972
  1973*****ACCOUNT PHONE NUMBER
  1974     12  FILLER                  PIC  X(03) VALUE '046'.
  1975     12  FILLER                  PIC S9(04) COMP VALUE +12.
  1976     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1977     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  1978     12  FILLER                  PIC S9(04) COMP VALUE +06.
  1979
  1980*****ACCOUNT CONTROL NAME AM-CONTROL-NAME
  1981     12  FILLER                  PIC  X(03) VALUE '047'.
  1982     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1983     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1984     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  1985     12  FILLER                  PIC S9(04) COMP VALUE +06.
  1986
  1987****ACCOUNT CSR CODE
  1988     12  FILLER                  PIC  X(03) VALUE '048'.
  1989     12  FILLER                  PIC S9(04) COMP VALUE +4..
  1990     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1991     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  1992     12  FILLER                  PIC S9(04) COMP VALUE +06.
  1993****ACCOUNT ACCOUNT NUMBER
  1994     12  FILLER                  PIC  X(03) VALUE '049'.
  1995     12  FILLER                  PIC S9(04) COMP VALUE +10.
  1996     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1997     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  1998     12  FILLER                  PIC S9(04) COMP VALUE +06.
  1999
  2000**** CRED BENE ADDRESS LINE 1 ERMAIL
  2001     12  FILLER                  PIC  X(03) VALUE '050'.
  2002     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2003     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2004     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2005     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2006
  2007**** CRED BENE ADDRESS LINE 2 ERMAIL
  2008     12  FILLER                  PIC  X(03) VALUE '051'.
  2009     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2010     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2011     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2012     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2013
  2014**** CRED BENE CITY STATE   ERMAIL
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page  38
* EL689.cbl
  2015     12  FILLER                  PIC  X(03) VALUE '052'.
  2016     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2017     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2018     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2019     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2020
  2021**** CRED BENE ZIP  1 ERMAIL
  2022     12  FILLER                  PIC  X(03) VALUE '053'.
  2023     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2024     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2025     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2026     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2027
  2028*****REMAINING 6 ARE NOT CURRENTLY USED
  2029     12  FILLER                  PIC  X(03) VALUE '054'.
  2030     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2031     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2032     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2033     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2034
  2035     12  FILLER                  PIC  X(03) VALUE '055'.
  2036     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2037     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2038     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2039     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2040
  2041     12  FILLER                  PIC  X(03) VALUE '056'.
  2042     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2043     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2044     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2045     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2046
  2047     12  FILLER                  PIC  X(03) VALUE '057'.
  2048     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2049     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2050     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2051     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2052
  2053     12  FILLER                  PIC  X(03) VALUE '058'.
  2054     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2055     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2056     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2057     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2058
  2059     12  FILLER                  PIC  X(03) VALUE '059'.
  2060     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2061     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2062     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2063     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2064
  2065*************** NON FILE VARIABLES *****************************
  2066*****CURRENT DATE
  2067     12  FILLER                  PIC  X(03) VALUE '060'.
  2068     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2069     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2070     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2071     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2072
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page  39
* EL689.cbl
  2073*****FULL CURRENT DATE
  2074     12  FILLER                  PIC  X(03) VALUE '061'.
  2075     12  FILLER                  PIC S9(04) COMP VALUE +18.
  2076     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2077     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2078     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2079
  2080*****FORM
  2081     12  FILLER                  PIC  X(03) VALUE '062'.
  2082     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2083     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2084     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2085     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2086
  2087*****VARIABLE 1
  2088     12  FILLER                  PIC  X(03) VALUE '063'.
  2089     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2090     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2091     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2092     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2093
  2094*****VARIABLE 2
  2095     12  FILLER                  PIC  X(03) VALUE '064'.
  2096     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2097     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2098     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2099     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2100
  2101*****VARIABLE 3
  2102     12  FILLER                  PIC  X(03) VALUE '065'.
  2103     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2104     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2105     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2106     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2107
  2108*****VARIABLE 4
  2109     12  FILLER                  PIC  X(03) VALUE '066'.
  2110     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2111     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2112     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2113     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2114
  2115*****REMAINING 3 ARE NOT CURRENTLY USED
  2116     12  FILLER                  PIC  X(03) VALUE '067'.
  2117     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2118     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2119     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2120     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2121
  2122     12  FILLER                  PIC  X(03) VALUE '068'.
  2123     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2124     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2125     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2126     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2127
  2128     12  FILLER                  PIC  X(03) VALUE '069'.
  2129     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2130     12  FILLER                  PIC  X(30) VALUE ALL '*'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page  40
* EL689.cbl
  2131     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2132     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2133
  2134************** CERTIFICATE VARIABLES - ELCERT *****************
  2135*****CARRIER CODE IN CERT
  2136     12  FILLER                  PIC  X(03) VALUE '070'.
  2137     12  FILLER                  PIC S9(04) COMP VALUE +1.
  2138     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2139     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2140     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2141
  2142*****GROUPING CODE IN CERT
  2143     12  FILLER                  PIC  X(03) VALUE '071'.
  2144     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2145     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2146     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2147     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2148
  2149*****ACCOUNT NUMBER IN CERT
  2150     12  FILLER                  PIC  X(03) VALUE '072'.
  2151     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2152     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2153     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2154     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2155
  2156*****CERTIFICATE NUMBER
  2157     12  FILLER                  PIC  X(03) VALUE '073'.
  2158     12  FILLER                  PIC S9(04) COMP VALUE +11.
  2159     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2160     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2161     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2162
  2163*****CERT EFFECTIVE DATE
  2164     12  FILLER                  PIC  X(03) VALUE '074'.
  2165     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2166     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2167     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2168     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2169
  2170*****CERT EXPIRATION DATE (LIFE)
  2171     12  FILLER                  PIC  X(03) VALUE '075'.
  2172     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2173     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2174     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2175     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2176
  2177*****CERT EXPIRATION DATE (AH)
  2178     12  FILLER                  PIC  X(03) VALUE '076'.
  2179     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2180     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2181     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2182     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2183
  2184*****LIFE TERM
  2185     12  FILLER                  PIC  X(03) VALUE '077'.
  2186     12  FILLER                  PIC S9(04) COMP VALUE +3.
  2187     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2188     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page  41
* EL689.cbl
  2189     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2190
  2191*****AH  TERM
  2192     12  FILLER                  PIC  X(03) VALUE '078'.
  2193     12  FILLER                  PIC S9(04) COMP VALUE +3.
  2194     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2195     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2196     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2197
  2198*****LIFE COVERAGE AMOUNT
  2199     12  FILLER                  PIC  X(03) VALUE '079'.
  2200     12  FILLER                  PIC S9(04) COMP VALUE +15.
  2201     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2202     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2203     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2204
  2205*****AH MONTHLY BENEFIT
  2206     12  FILLER                  PIC  X(03) VALUE '080'.
  2207     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2208     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2209     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2210     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2211
  2212*****LIFE CANCEL DATE
  2213     12  FILLER                  PIC  X(03) VALUE '081'.
  2214     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2215     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2216     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2217     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2218
  2219*****AH CANCEL DATE
  2220     12  FILLER                  PIC  X(03) VALUE '082'.
  2221     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2222     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2223     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2224     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2225
  2226*****LIFE COVERAGE FORM NUMBER
  2227     12  FILLER                  PIC  X(03) VALUE '083'.
  2228     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2229     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2230     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2231     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2232
  2233*****UNUSED
  2234     12  FILLER                  PIC  X(03) VALUE '084'.
  2235     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2236     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2237     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2238     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2239
  2240*****INSUREDS AGE AT POLICY ISSUE (NOT USED)
  2241     12  FILLER                  PIC  X(03) VALUE '085'.
  2242     12  FILLER                  PIC S9(04) COMP VALUE +3.
  2243     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2244     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2245     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2246
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page  42
* EL689.cbl
  2247*****LOAN NUMBER
  2248     12  FILLER                  PIC  X(03) VALUE '086'.
  2249     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2250     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2251     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2252     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2253
  2254*****LOAN BALANCE
  2255     12  FILLER                  PIC  X(03) VALUE '087'.
  2256     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2257     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2258     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2259     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2260
  2261*****MEMBER NUMBER
  2262     12  FILLER                  PIC  X(03) VALUE '088'.
  2263     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2264     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2265     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2266     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2267
  2268*****INSURED SOC SEC NUMBER
  2269     12  FILLER                  PIC  X(03) VALUE '089'.
  2270     12  FILLER                  PIC S9(04) COMP VALUE +11.
  2271     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2272     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2273     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2274
  2275*****INSURED INITIALS & LAST NAME (CERTIFICATE)
  2276     12  FILLER                  PIC  X(03) VALUE '090'.
  2277     12  FILLER                  PIC S9(04) COMP VALUE +15.
  2278     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2279     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2280     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2281
  2282*****INSURED FIRST NAME (CERTIFICATE)
  2283     12  FILLER                  PIC  X(03) VALUE '091'.
  2284     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2285     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2286     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2287     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2288
  2289*****INSURED MIDDLE INITIAL (CERTIFICATE)
  2290     12  FILLER                  PIC  X(03) VALUE '092'.
  2291     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2292     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2293     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2294     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2295
  2296*****ORIG TERM * MON BEN
  2297     12  FILLER                  PIC  X(03) VALUE '093'.
  2298     12  FILLER                  PIC S9(04) COMP VALUE +15.
  2299     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2300     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2301     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2302
  2303*****INSURED'S NAME (LAST, FIRST, INIT)
  2304     12  FILLER                  PIC  X(03) VALUE '094'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page  43
* EL689.cbl
  2305     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2306     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2307     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2308     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2309
  2310*****INSURED'S NAME (FIRST, INIT, LAST)
  2311     12  FILLER                  PIC  X(03) VALUE  '095'.
  2312     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2313     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2314     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2315     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2316
  2317*****TITLE (MR/MS)
  2318     12  FILLER                  PIC  X(03) VALUE '096'.
  2319     12  FILLER                  PIC S9(04) COMP VALUE +3.
  2320     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2321     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2322     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2323
  2324*****LIFE PREMIUM (CERTIFICATE)
  2325     12  FILLER                  PIC  X(03) VALUE '097'.
  2326     12  FILLER                  PIC S9(04) COMP VALUE +15.
  2327     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2328     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2329     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2330
  2331*****A/H PREMIUM (CERTIFICATE)
  2332     12  FILLER                  PIC  X(03) VALUE '098'.
  2333     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2334     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2335     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2336     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2337
  2338*****JOINT'S INITIALS & LAST NAME (CERTIFICATE)
  2339     12  FILLER                  PIC  X(03) VALUE '099'.
  2340     12  FILLER                  PIC S9(04) COMP VALUE +15.
  2341     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2342     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2343     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2344
  2345*****JOINT'S FIRST NAME (CERTIFICATE)
  2346     12  FILLER                  PIC  X(03) VALUE '100'.
  2347     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2348     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2349     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2350     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2351
  2352*****JOINT'S MIDDLE INITIAL (CERTIFICATE)
  2353     12  FILLER                  PIC  X(03) VALUE '101'.
  2354     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2355     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2356     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2357     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2358
  2359*****JOINT'S NAME (LAST, FIRST, INIT)
  2360     12  FILLER                  PIC  X(03) VALUE '102'.
  2361     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2362     12  FILLER                  PIC  X(30) VALUE ALL '*'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page  44
* EL689.cbl
  2363     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2364     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2365
  2366*****JOINT'S NAME (FIRST, INIT, LAST)
  2367     12  FILLER                  PIC  X(03) VALUE '103'.
  2368     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2369     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2370     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2371     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2372
  2373*****INSURED'S FIRST AND LAST NAME
  2374     12  FILLER                  PIC  X(03) VALUE '104'.
  2375     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2376     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2377     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2378     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2379
  2380*****JOINT'S FIRST AND LAST NAME
  2381     12  FILLER                  PIC  X(03) VALUE '105'.
  2382     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2383     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2384     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2385     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2386
  2387*****ENTERED LIFE REFUND (CERT)
  2388     12  FILLER                  PIC  X(03) VALUE '106'.
  2389     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2390     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2391     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2392     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2393
  2394*****ENTERED A/H REFUND (CERT)
  2395     12  FILLER                  PIC  X(03) VALUE '107'.
  2396     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2397     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2398     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2399     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2400
  2401*****INSURED'S LAST NAME
  2402     12  FILLER                  PIC  X(03) VALUE '108'.
  2403     12  FILLER                  PIC S9(04) COMP VALUE +15.
  2404     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2405     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2406     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2407
  2408*****BENEFICIARY
  2409     12  FILLER                  PIC  X(03) VALUE  '109'.
  2410     12  FILLER                  PIC S9(04) COMP VALUE +25.
  2411     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2412     12  FILLER                  PIC  X(01) VALUE 'Y'.
  2413     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2414
  2415************** PENDING VARIABLES - ERPNDB *********************
  2416*****INSURED DATE OF BIRTH
  2417     12  FILLER                  PIC  X(03) VALUE '110'.
  2418     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2419     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2420     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page  45
* EL689.cbl
  2421     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2422
  2423*****ENTERED LIFE PREMIUM (PENDING)
  2424     12  FILLER                  PIC  X(03) VALUE '111'.
  2425     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2426     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2427     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2428     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2429
  2430*****ENTERED A/H PREMIUM (PENDING)
  2431     12  FILLER                  PIC  X(03) VALUE '112'.
  2432     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2433     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2434     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2435     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2436
  2437*****CALCULATED LIFE PREMIUM (PENDING)
  2438     12  FILLER                  PIC  X(03) VALUE '113'.
  2439     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2440     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2441     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2442     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2443
  2444*****CALCULATED A/H PREMIUM (PENDING)
  2445     12  FILLER                  PIC  X(03) VALUE '114'.
  2446     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2447     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2448     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2449     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2450
  2451*****DIFFERENCE ENTER/COMPUTED LIFE PREMIUM (PENDING)
  2452     12  FILLER                  PIC  X(03) VALUE '115'.
  2453     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2454     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2455     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2456     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2457
  2458*****DIFFERENCE ENTER/COMPUTED A/H PREMIUM (PENDING)
  2459     12  FILLER                  PIC  X(03) VALUE '116'.
  2460     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2461     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2462     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2463     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2464
  2465*****PRIOR CANCEL DATE
  2466     12  FILLER                  PIC  X(03) VALUE '117'.
  2467     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2468     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2469     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2470     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2471
  2472*****ENTERED LIFE REFUND (PENDING)
  2473     12  FILLER                  PIC  X(03) VALUE '118'.
  2474     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2475     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2476     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2477     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2478
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page  46
* EL689.cbl
  2479*****ENTERED A/H REFUND (PENDING)
  2480     12  FILLER                  PIC  X(03) VALUE '119'.
  2481     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2482     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2483     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2484     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2485
  2486*****CALCULATED LIFE REFUND (PENDING)
  2487     12  FILLER                  PIC  X(03) VALUE '120'.
  2488     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2489     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2490     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2491     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2492
  2493*****CALCULATED A/H REFUND (PENDING)
  2494     12  FILLER                  PIC  X(03) VALUE '121'.
  2495     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2496     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2497     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2498     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2499
  2500*****DIFFERENCE ENTER/COMPUTED LIFE REFUND (PENDING)
  2501     12  FILLER                  PIC  X(03) VALUE '122'.
  2502     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2503     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2504     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2505     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2506
  2507*****DIFFERENCE ENTER/COMPUTED A/H REFUND (PENDING)
  2508     12  FILLER                  PIC  X(03) VALUE '123'.
  2509     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2510     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2511     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2512     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2513
  2514*****INSUREDS AGE
  2515     12  FILLER                  PIC  X(03) VALUE '124'.
  2516     12  FILLER                  PIC S9(04) COMP VALUE +3.
  2517     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2518     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2519     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2520
  2521*****LIFE BENEFIT (PENDING)
  2522     12  FILLER                  PIC  X(03) VALUE '125'.
  2523     12  FILLER                  PIC S9(04) COMP VALUE +15.
  2524     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2525     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2526     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2527
  2528*****A/H BENEFIT (PENDING)
  2529     12  FILLER                  PIC  X(03) VALUE '126'.
  2530     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2531     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2532     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2533     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2534
  2535*****LIFE RATE
  2536     12  FILLER                  PIC  X(03) VALUE '127'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page  47
* EL689.cbl
  2537     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2538     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2539     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2540     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2541
  2542*****A/H RATE
  2543     12  FILLER                  PIC  X(03) VALUE '128'.
  2544     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2545     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2546     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2547     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2548
  2549*****TERM (PENDING)
  2550     12  FILLER                  PIC  X(03) VALUE '129'.
  2551     12  FILLER                  PIC S9(04) COMP VALUE +3.
  2552     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2553     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2554     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2555
  2556*****BATCH NUMBER
  2557     12  FILLER                  PIC  X(03) VALUE '130'.
  2558     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2559     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2560     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2561     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2562
  2563*****TOTAL OF LIFE AND A&H REFUND
  2564     12  FILLER                  PIC  X(03) VALUE '131'.
  2565     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2566     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2567     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2568     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2569
  2570*****NH INTEREST ON REFUNDS
  2571     12  FILLER                  PIC  X(03) VALUE '132'.
  2572     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2573     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2574     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2575     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2576*****GREATER OF THE LIFE AND AH CANCEL DATE
  2577     12  FILLER                  PIC  X(03) VALUE '133'.
  2578     12  FILLER                  PIC S9(04) COMP VALUE +8.
  2579     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2580     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2581     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2582
  2583*****THE NEXT 6 NOT CURRENTLY USED
  2584     12  FILLER                  PIC  X(03) VALUE '134'.
  2585     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2586     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2587     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2588     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2589
  2590     12  FILLER                  PIC  X(03) VALUE '135'.
  2591     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2592     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2593     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2594     12  FILLER                  PIC S9(04) COMP VALUE +09.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page  48
* EL689.cbl
  2595
  2596     12  FILLER                  PIC  X(03) VALUE '136'.
  2597     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2598     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2599     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2600     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2601
  2602     12  FILLER                  PIC  X(03) VALUE '137'.
  2603     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2604     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2605     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2606     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2607
  2608     12  FILLER                  PIC  X(03) VALUE '138'.
  2609     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2610     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2611     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2612     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2613
  2614     12  FILLER                  PIC  X(03) VALUE '139'.
  2615     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2616     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2617     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2618     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2619
  2620************** COMPENSATION VARIABLES - ERCOMP ****************
  2621*****COMPENSATION ACCT NAME
  2622     12  FILLER                  PIC  X(03) VALUE '140'.
  2623     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2624     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2625     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2626     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2627
  2628*****FULL COMPENSATION ADDRESS TYPE 'A'
  2629     12  FILLER                  PIC  X(03) VALUE '141'.
  2630     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2631     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2632     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2633     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2634
  2635     12  FILLER                  PIC  X(03) VALUE '142'.
  2636     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2637     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2638     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2639     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2640
  2641     12  FILLER                  PIC  X(03) VALUE '143'.
  2642     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2643     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2644     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2645     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2646
  2647     12  FILLER                  PIC  X(03) VALUE '144'.
  2648     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2649     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2650     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2651     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2652
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page  49
* EL689.cbl
  2653     12  FILLER                  PIC  X(03) VALUE '145'.
  2654     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2655     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2656     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2657     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2658
  2659     12  FILLER                  PIC  X(03) VALUE '146'.
  2660     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2661     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2662     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2663     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2664
  2665*****COMPENSATION PHONE NUMBER
  2666     12  FILLER                  PIC  X(03) VALUE '147'.
  2667     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2668     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2669     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2670     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2671
  2672*****COMPENSATION CSR NAME
  2673     12  FILLER                  PIC  X(03) VALUE '148'.
  2674     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2675     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2676     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2677     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2678
  2679*****COMPENSATION LAST STATEMENT DATE
  2680     12  FILLER                  PIC  X(03) VALUE '149'.
  2681     12  FILLER                  PIC S9(04) COMP VALUE +18.
  2682     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2683     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2684     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2685
  2686*****COMPENSATION ENDING BALANCE
  2687     12  FILLER                  PIC  X(03) VALUE '150'.
  2688     12  FILLER                  PIC S9(04) COMP VALUE +14.
  2689     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2690     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2691     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2692
  2693******************  PROCESSOR DATA - ELCNTL (2) ****************
  2694*****EXECUTING PROCESSOR NAME
  2695     12  FILLER                  PIC  X(03) VALUE '151'.
  2696     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2697     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2698     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2699     12  FILLER                  PIC S9(04) COMP VALUE +11.
  2700
  2701*****PROCESSOR TITLE
  2702     12  FILLER                  PIC  X(03) VALUE '152'.
  2703     12  FILLER                  PIC S9(04) COMP VALUE +26.
  2704     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2705     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2706     12  FILLER                  PIC S9(04) COMP VALUE +11.
  2707
  2708*****PROCESSOR
  2709     12  FILLER                  PIC  X(03) VALUE '153'.
  2710     12  FILLER                  PIC S9(04) COMP VALUE +04.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page  50
* EL689.cbl
  2711     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2712     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2713     12  FILLER                  PIC S9(04) COMP VALUE +11.
  2714
  2715*****CSR TITLE
  2716     12  FILLER                  PIC  X(03) VALUE '154'.
  2717     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2718     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2719     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2720     12  FILLER                  PIC S9(04) COMP VALUE +11.
  2721*****REMAINING 2 ARE NOT CURRENTLY USED
  2722     12  FILLER                  PIC  X(03) VALUE '155'.
  2723     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2724     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2725     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2726     12  FILLER                  PIC S9(04) COMP VALUE +11.
  2727
  2728     12  FILLER                  PIC  X(03) VALUE '156'.
  2729     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2730     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2731     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2732     12  FILLER                  PIC S9(04) COMP VALUE +11.
  2733
  2734******************  CHECK DATA - ERCHEK    *********************
  2735*****CHECK AMOUNT
  2736     12  FILLER                  PIC  X(03) VALUE '157'.
  2737     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2738     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2739     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2740     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2741
  2742*****CHECK NUMBER
  2743     12  FILLER                  PIC  X(03) VALUE '158'.
  2744     12  FILLER                  PIC S9(04) COMP VALUE +7.
  2745     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2746     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2747     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2748
  2749*****PAYEE 1 NAME
  2750     12  FILLER                  PIC  X(03) VALUE '159'.
  2751     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2752     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2753     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2754     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2755
  2756*****PAYEE 2 NAME
  2757     12  FILLER                  PIC  X(03) VALUE '160'.
  2758     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2759     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2760     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2761     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2762
  2763*****ADDRSS 1
  2764     12  FILLER                  PIC  X(03) VALUE '161'.
  2765     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2766     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2767     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2768     12  FILLER                  PIC S9(04) COMP VALUE +12.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page  51
* EL689.cbl
  2769
  2770*****ADDRESS 2
  2771     12  FILLER                  PIC  X(03) VALUE '162'.
  2772     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2773     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2774     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2775     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2776
  2777*****PAYEE CITY STATE
  2778     12  FILLER                  PIC  X(03) VALUE '163'.
  2779     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2780     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2781     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2782     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2783
  2784*****ZIP CODE
  2785     12  FILLER                  PIC  X(03) VALUE '164'.
  2786     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2787     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2788     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2789     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2790
  2791*****CHECK CONTROL
  2792     12  FILLER                  PIC  X(03) VALUE '165'.
  2793     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2794     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2795     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2796     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2797
  2798*****REASON FOR CHECK
  2799     12  FILLER                  PIC  X(03) VALUE '166'.
  2800     12  FILLER                  PIC S9(04) COMP VALUE +25.
  2801     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2802     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2803     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2804
  2805*****REMAINING 3 ARE NOT CURRENTLY USED
  2806     12  FILLER                  PIC  X(03) VALUE '167'.
  2807     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2808     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2809     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2810     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2811
  2812     12  FILLER                  PIC  X(03) VALUE '168'.
  2813     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2814     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2815     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2816     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2817
  2818     12  FILLER                  PIC  X(03) VALUE '169'.
  2819     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2820     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2821     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2822     12  FILLER                  PIC S9(04) COMP VALUE +11.
  2823
  2824
  2825*********** PAYMENT AND ADJUSTMENT DATA - ERPYAJ  **************
  2826*****CHECK AMOUNT - PYAJ
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page  52
* EL689.cbl
  2827     12  FILLER                  PIC  X(03) VALUE '170'.
  2828     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2829     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2830     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2831     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2832
  2833*****CHECK NUMBER - PYAJ
  2834     12  FILLER                  PIC  X(03) VALUE '171'.
  2835     12  FILLER                  PIC S9(04) COMP VALUE +7.
  2836     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2837     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2838     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2839
  2840*****CHECK CONTROL - PYAJ
  2841     12  FILLER                  PIC  X(03) VALUE '172'.
  2842     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2843     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2844     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2845     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2846
  2847***** COMMENT - PYAJ
  2848     12  FILLER                  PIC  X(03) VALUE '173'.
  2849     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2850     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2851     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2852     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2853
  2854*****NEW FIELDS.
  2855*****COMPENSATION FULL ADDRESS TYPE 'G'
  2856     12  FILLER                  PIC  X(03) VALUE '174'.
  2857     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2858     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2859     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2860     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2861
  2862     12  FILLER                  PIC  X(03) VALUE '175'.
  2863     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2864     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2865     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2866     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2867
  2868     12  FILLER                  PIC  X(03) VALUE '176'.
  2869     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2870     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2871     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2872     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2873
  2874     12  FILLER                  PIC  X(03) VALUE '177'.
  2875     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2876     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2877     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2878     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2879
  2880     12  FILLER                  PIC  X(03) VALUE '178'.
  2881     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2882     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2883     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2884     12  FILLER                  PIC S9(04) COMP VALUE +10.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page  53
* EL689.cbl
  2885
  2886     12  FILLER                  PIC  X(03) VALUE '179'.
  2887     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2888     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2889     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2890     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2891
  2892*****COMPENSATION FINANCIAL RESPONSIBLE NO.
  2893     12  FILLER                  PIC  X(03) VALUE '180'.
  2894     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2895     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2896     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2897     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2898**** COMPENSATION BILLING SWITCH
  2899     12  FILLER                  PIC XXX    VALUE '181'.
  2900     12  FILLER                  PIC S9(4)  COMP VALUE +7.
  2901     12  FILLER                  PIC X(30)  VALUE ALL '*'.
  2902     12  FILLER                  PIC X      VALUE ALL 'N'.
  2903     12  FILLER                  PIC S9(4)  COMP VALUE +10.
  2904*****COMPENSATION FAX NUMBER
  2905     12  FILLER                  PIC  X(03) VALUE '182'.
  2906     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2907     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2908     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2909     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2910**** COMPENSATION STATUS
  2911     12  FILLER                  PIC XXX    VALUE '183'.
  2912     12  FILLER                  PIC S9(4)  COMP VALUE +7.
  2913     12  FILLER                  PIC X(30)  VALUE ALL '*'.
  2914     12  FILLER                  PIC X      VALUE ALL 'N'.
  2915     12  FILLER                  PIC S9(4)  COMP VALUE +10.
  2916***** THE VARS 184 - 189 WILL TYPICALLY BE USED FOR DCC BANKS
  2917*****COMPENSATION FULL ADDRESS TYPE 'B'
  2918     12  FILLER                  PIC  X(03) VALUE '184'.
  2919     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2920     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2921     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2922     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2923
  2924     12  FILLER                  PIC  X(03) VALUE '185'.
  2925     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2926     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2927     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2928     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2929
  2930     12  FILLER                  PIC  X(03) VALUE '186'.
  2931     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2932     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2933     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2934     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2935
  2936     12  FILLER                  PIC  X(03) VALUE '187'.
  2937     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2938     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2939     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2940     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2941
  2942     12  FILLER                  PIC  X(03) VALUE '188'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page  54
* EL689.cbl
  2943     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2944     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2945     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2946     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2947
  2948     12  FILLER                  PIC  X(03) VALUE '189'.
  2949     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2950     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2951     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2952     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2953
  2954
  2955 01  FILLER REDEFINES W-SUPPORTED-VARIABLES.
  2956*    12  W-VARIABLE-GRP OCCURS 180 TIMES
  2957     12  W-VARIABLE-GRP OCCURS 189 TIMES
  2958                        INDEXED BY W-VG-NDX.
  2959         16  W-VARIABLE-ID         PIC  X(03).
  2960         16  W-VARIABLE-SIZE       PIC S9(04) COMP.
  2961         16  W-VG-TEXT.
  2962             20  W-VAR-CHAR
  2963                        OCCURS 30 TIMES
  2964                        INDEXED BY W-VC-NDX
  2965                                   PIC  X(01).
  2966         16  W-VARIABLE-UPLOW-IND  PIC  X(01).
  2967             88  W-USE-UPPER-AND-LOWER-CASE VALUE 'Y'.
  2968
  2969         16  W-VARIABLE-SOURCE   PIC S9(04) COMP.
  2970
  2971 01  W-VAR-END                   PIC  X(23)
  2972                        VALUE ':VARIABLE WORK AREA END'.
  2973
  2974 01  W-PROGRAM-TABLE-AREA.
  2975     12  FILLER                  PIC  X(15)
  2976                                 VALUE 'PROGRAM TABLES:'.
  2977
  2978     12  W-RECORD-TABLE              VALUE SPACES.
  2979         16  W-RC-GRP OCCURS 500 TIMES
  2980                       INDEXED BY W-RG-NDX
  2981                                  W-RG-NDX1.
  2982             20  W-RC-TEXT.
  2983                 24  W-RC-CHAR OCCURS 70 TIMES
  2984                                INDEXED BY W-RC-NDX
  2985                                           W-RC-NDX1
  2986                                 PIC  X(01).
  2987             20  W-RC-PC         PIC  9(02).
  2988             20  W-RC-SC         PIC  X(01).
  2989
  2990     12  FILLER REDEFINES W-RECORD-TABLE.
  2991         16  W-REC-CHAR OCCURS 36500 TIMES
  2992                        INDEXED BY W-RVS-NDX
  2993                                   W-RVS-NDX2
  2994                                 PIC  X(01).
  2995     12  FILLER REDEFINES W-RECORD-TABLE.
  2996         16  W-TS-GROUP OCCURS 10 TIMES
  2997                        INDEXED BY W-TS-NDX
  2998                                 PIC X(3650).
  2999
  3000     12  FILLER                  PIC  X(11)
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page  55
* EL689.cbl
  3001                                 VALUE 'TEXT TABLE:'.
  3002     12  W-TX-TABLE                  VALUE SPACES.
  3003         16  W-TX-GRP OCCURS 500 TIMES
  3004                       INDEXED BY W-TG-NDX
  3005                                  W-TG-NDX2.
  3006             20  W-TX-TEXT.
  3007                 24  W-TX-CHAR OCCURS 70 TIMES
  3008                                    INDEXED BY W-TX-NDX
  3009                                               W-TX-NDX1
  3010                                               W-TX-NDX2
  3011                                 PIC  X(01).
  3012             20  W-TX-PC         PIC  9(02).
  3013             20  W-TX-SC         PIC  X(01).
  3014
  3015     12  FILLER                  PIC  X(11)
  3016                                 VALUE 'FILE TABLE:'.
  3017     12  W-FILE-TABLE                VALUE SPACES.
  3018         16  W-FILE-USE-IND OCCURS 20 TIMES
  3019                       INDEXED BY W-FILE-NDX
  3020                                 PIC  X(01).
  3021             88  W-FILE-NOT-USED     VALUE SPACE.
  3022             88  W-FILE-USED         VALUE 'Y'.
  3023
  3024     12  FILLER                  PIC  X(14)
  3025                                 VALUE 'END OF TABLES:'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page  56
* EL689.cbl
  3027 01  ERROR-MESSAGES.
  3028     12  ER-0000                 PIC  X(04) VALUE '0000'.
  3029     12  ER-0004                 PIC  X(04) VALUE '0004'.
  3030     12  ER-0006                 PIC  X(04) VALUE '0006'.
  3031     12  ER-0008                 PIC  X(04) VALUE '0008'.
  3032     12  ER-0013                 PIC  X(04) VALUE '0013'.
  3033     12  ER-0023                 PIC  X(04) VALUE '0023'.
  3034     12  ER-0029                 PIC  X(04) VALUE '0029'.
  3035     12  ER-0033                 PIC  X(04) VALUE '0033'.
  3036     12  ER-0042                 PIC  X(04) VALUE '0042'.
  3037     12  ER-0047                 PIC  X(04) VALUE '0047'.
  3038     12  ER-0051                 PIC  X(04) VALUE '0051'.
  3039     12  ER-0066                 PIC  X(04) VALUE '0066'.
  3040     12  ER-0067                 PIC  X(04) VALUE '0067'.
  3041     12  ER-0070                 PIC  X(04) VALUE '0070'.
  3042     12  ER-0168                 PIC  X(04) VALUE '0168'.
  3043     12  ER-0169                 PIC  X(04) VALUE '0169'.
  3044     12  ER-0174                 PIC  X(04) VALUE '0174'.
  3045     12  ER-0175                 PIC  X(04) VALUE '0175'.
  3046     12  ER-0176                 PIC  X(04) VALUE '0176'.
  3047     12  ER-0177                 PIC  X(04) VALUE '0177'.
  3048     12  ER-0179                 PIC  X(04) VALUE '0179'.
  3049     12  ER-0180                 PIC  X(04) VALUE '0180'.
  3050     12  ER-0181                 PIC  X(04) VALUE '0181'.
  3051     12  ER-0182                 PIC  X(04) VALUE '0182'.
  3052     12  ER-0184                 PIC  X(04) VALUE '0184'.
  3053     12  ER-0185                 PIC  X(04) VALUE '0185'.
  3054     12  ER-0187                 PIC  X(04) VALUE '0187'.
  3055     12  ER-0188                 PIC  X(04) VALUE '0188'.
  3056     12  ER-0189                 PIC  X(04) VALUE '0189'.
  3057     12  ER-0190                 PIC  X(04) VALUE '0190'.
  3058     12  ER-0191                 PIC  X(04) VALUE '0191'.
  3059     12  ER-0215                 PIC  X(04) VALUE '0215'.
  3060     12  ER-0279                 PIC  X(04) VALUE '0279'.
  3061     12  ER-0280                 PIC  X(04) VALUE '0280'.
  3062     12  ER-0412                 PIC  X(04) VALUE '0412'.
  3063     12  ER-0413                 PIC  X(04) VALUE '0413'.
  3064     12  ER-0454                 PIC  X(04) VALUE '0454'.
  3065     12  ER-0533                 PIC  X(04) VALUE '0533'.
  3066     12  ER-0537                 PIC  X(04) VALUE '0537'.
  3067     12  ER-2055                 PIC  X(04) VALUE '2055'.
  3068     12  ER-2114                 PIC  X(04) VALUE '2114'.
  3069     12  ER-2208                 PIC  X(04) VALUE '2208'.
  3070     12  ER-2209                 PIC  X(04) VALUE '2209'.
  3071     12  ER-2216                 PIC  X(04) VALUE '2216'.
  3072     12  ER-2232                 PIC  X(04) VALUE '2232'.
  3073     12  ER-2369                 PIC  X(04) VALUE '2369'.
  3074     12  ER-2398                 PIC  X(04) VALUE '2398'.
  3075     12  ER-2433                 PIC  X(04) VALUE '2433'.
  3076     12  ER-2908                 PIC  X(04) VALUE '2908'.
  3077     12  ER-2999                 PIC  X(04) VALUE '2999'.
  3078     12  ER-3000                 PIC  X(04) VALUE '3000'.
  3079     12  ER-3770                 PIC  X(04) VALUE '3770'.
  3080     12  ER-3771                 PIC  X(04) VALUE '3771'.
  3081     12  ER-3775                 PIC  X(04) VALUE '3775'.
  3082     12  ER-3783                 PIC  X(04) VALUE '3783'.
  3083     12  ER-7243                 PIC  X(04) VALUE '7243'.
  3084     12  ER-7245                 PIC  X(04) VALUE '7245'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page  57
* EL689.cbl
  3085     12  ER-7246                 PIC  X(04) VALUE '7246'.
  3086     12  ER-7247                 PIC  X(04) VALUE '7247'.
  3087     12  ER-7250                 PIC  X(04) VALUE '7250'.
  3088     12  ER-7365                 PIC  X(04) VALUE '7365'.
  3089     12  ER-7367                 PIC  X(04) VALUE '7367'.
  3090     12  ER-7368                 PIC  X(04) VALUE '7368'.
  3091     12  ER-7369                 PIC  X(04) VALUE '7369'.
  3092     12  ER-7370                 PIC  X(04) VALUE '7370'.
  3093     12  ER-7371                 PIC  X(04) VALUE '7371'.
  3094     12  ER-7372                 PIC  X(04) VALUE '7372'.
  3095     12  ER-7373                 PIC  X(04) VALUE '7373'.
  3096     12  ER-7374                 PIC  X(04) VALUE '7374'.
  3097     12  ER-7376                 PIC  X(04) VALUE '7376'.
  3098     12  ER-7377                 PIC  X(04) VALUE '7377'.
  3099     12  ER-7378                 PIC  X(04) VALUE '7378'.
  3100     12  ER-7379                 PIC  X(04) VALUE '7379'.
  3101     12  ER-7381                 PIC  X(04) VALUE '7381'.
  3102     12  ER-7388                 PIC  X(04) VALUE '7388'.
  3103     12  ER-7390                 PIC  X(04) VALUE '7390'.
  3104     12  ER-7393                 PIC  X(04) VALUE '7393'.
  3105     12  ER-7395                 PIC  X(04) VALUE '7395'.
  3106     12  ER-7396                 PIC  X(04) VALUE '7396'.
  3107     12  ER-7398                 PIC  X(04) VALUE '7398'.
  3108     12  ER-8965                 PIC  X(04) VALUE '8965'.
  3109     12  ER-9095                 PIC  X(04) VALUE '9095'.
  3110     12  ER-9097                 PIC  X(04) VALUE '9097'.
  3111     12  ER-9281                 PIC  X(04) VALUE '9281'.
  3112     12  ER-9283                 PIC  X(04) VALUE '9283'.
  3113     12  ER-9298                 PIC  X(04) VALUE '9298'.
  3114     12  ER-9299                 PIC  X(04) VALUE '9299'.
  3115     12  ER-9320                 PIC  X(04) VALUE '9320'.
  3116     12  ER-9327                 PIC  X(04) VALUE '9327'.
  3117     12  ER-9426                 PIC  X(04) VALUE '9426'.
  3118     12  ER-9427                 PIC  X(04) VALUE '9427'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page  58
* EL689.cbl
  3120*    COPY ELCAID.
  3121******************************************************************
  3122*                                                                *
  3123*                            ELCAID.                             *
  3124*                            VMOD=2.001                          *
  3125*                                                                *
  3126*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  3127*                                                                *
  3128*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  3129*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  3130******************************************************************
  3131
  3132 01  DFHAID.
  3133   02  DFHNULL   PIC  X  VALUE  ' '.
  3134   02  DFHENTER  PIC  X  VALUE  QUOTE.
  3135   02  DFHCLEAR  PIC  X  VALUE  '_'.
  3136   02  DFHPEN    PIC  X  VALUE  '='.
  3137   02  DFHOPID   PIC  X  VALUE  'W'.
  3138   02  DFHPA1    PIC  X  VALUE  '%'.
  3139   02  DFHPA2    PIC  X  VALUE  '>'.
  3140   02  DFHPA3    PIC  X  VALUE  ','.
  3141   02  DFHPF1    PIC  X  VALUE  '1'.
  3142   02  DFHPF2    PIC  X  VALUE  '2'.
  3143   02  DFHPF3    PIC  X  VALUE  '3'.
  3144   02  DFHPF4    PIC  X  VALUE  '4'.
  3145   02  DFHPF5    PIC  X  VALUE  '5'.
  3146   02  DFHPF6    PIC  X  VALUE  '6'.
  3147   02  DFHPF7    PIC  X  VALUE  '7'.
  3148   02  DFHPF8    PIC  X  VALUE  '8'.
  3149   02  DFHPF9    PIC  X  VALUE  '9'.
  3150   02  DFHPF10   PIC  X  VALUE  ':'.
  3151   02  DFHPF11   PIC  X  VALUE  '#'.
  3152   02  DFHPF12   PIC  X  VALUE  '@'.
  3153   02  DFHPF13   PIC  X  VALUE  'A'.
  3154   02  DFHPF14   PIC  X  VALUE  'B'.
  3155   02  DFHPF15   PIC  X  VALUE  'C'.
  3156   02  DFHPF16   PIC  X  VALUE  'D'.
  3157   02  DFHPF17   PIC  X  VALUE  'E'.
  3158   02  DFHPF18   PIC  X  VALUE  'F'.
  3159   02  DFHPF19   PIC  X  VALUE  'G'.
  3160   02  DFHPF20   PIC  X  VALUE  'H'.
  3161   02  DFHPF21   PIC  X  VALUE  'I'.
  3162*00039    02  DFHPF22   PIC  X  VALUE  ''.
  3163   02  DFHPF22   PIC  X  VALUE  '['.
  3164   02  DFHPF23   PIC  X  VALUE  '.'.
  3165   02  DFHPF24   PIC  X  VALUE  '<'.
  3166   02  DFHMSRE   PIC  X  VALUE  'X'.
  3167   02  DFHSTRF   PIC  X  VALUE  'h'.
  3168   02  DFHTRIG   PIC  X  VALUE  '"'.
  3169 01  FILLER    REDEFINES DFHAID.
  3170     12  FILLER                  PIC  X(08).
  3171     12  PF-VALUES               PIC  X(01) OCCURS 2.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page  59
* EL689.cbl
  3173*    COPY ELCATTR.
  3174******************************************************************
  3175*                                                                *
  3176*                            ELCATTR.                            *
  3177*                            VMOD=2.001                          *
  3178*                                                                *
  3179*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  3180*                                                                *
  3181*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  3182*                                                                *
  3183*                   POS 1   P=PROTECTED                          *
  3184*                           U=UNPROTECTED                        *
  3185*                           S=ASKIP                              *
  3186*                   POS 2   A=ALPHA/NUMERIC                      *
  3187*                           N=NUMERIC                            *
  3188*                   POS 3   N=NORMAL                             *
  3189*                           B=BRIGHT                             *
  3190*                           D=DARK                               *
  3191*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  3192*                           OF=MODIFIED DATA TAG OFF             *
  3193*                                                                *
  3194*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  3195******************************************************************
  3196 01  ATTRIBUTE-LIST.
  3197     12  AL-PABOF            PIC X       VALUE 'Y'.
  3198     12  AL-PABON            PIC X       VALUE 'Z'.
  3199     12  AL-PADOF            PIC X       VALUE '%'.
  3200     12  AL-PADON            PIC X       VALUE '_'.
  3201     12  AL-PANOF            PIC X       VALUE '-'.
  3202     12  AL-PANON            PIC X       VALUE '/'.
  3203     12  AL-SABOF            PIC X       VALUE '8'.
  3204     12  AL-SABON            PIC X       VALUE '9'.
  3205     12  AL-SADOF            PIC X       VALUE '@'.
  3206     12  AL-SADON            PIC X       VALUE QUOTE.
  3207     12  AL-SANOF            PIC X       VALUE '0'.
  3208     12  AL-SANON            PIC X       VALUE '1'.
  3209     12  AL-UABOF            PIC X       VALUE 'H'.
  3210     12  AL-UABON            PIC X       VALUE 'I'.
  3211     12  AL-UADOF            PIC X       VALUE '<'.
  3212     12  AL-UADON            PIC X       VALUE '('.
  3213     12  AL-UANOF            PIC X       VALUE ' '.
  3214     12  AL-UANON            PIC X       VALUE 'A'.
  3215     12  AL-UNBOF            PIC X       VALUE 'Q'.
  3216     12  AL-UNBON            PIC X       VALUE 'R'.
  3217     12  AL-UNDOF            PIC X       VALUE '*'.
  3218     12  AL-UNDON            PIC X       VALUE ')'.
  3219     12  AL-UNNOF            PIC X       VALUE '&'.
  3220     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page  60
* EL689.cbl
  3222*    COPY ELCDATE.
  3223******************************************************************
  3224*                                                                *
  3225*                                                                *
  3226*                            ELCDATE.                            *
  3227*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3228*                            VMOD=2.003
  3229*                                                                *
  3230*                                                                *
  3231*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  3232*                 LENGTH = 200                                   *
  3233******************************************************************
  3234
  3235 01  DATE-CONVERSION-DATA.
  3236     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  3237     12  DC-OPTION-CODE                PIC X.
  3238         88  BIN-TO-GREG                VALUE ' '.
  3239         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  3240         88  EDIT-GREG-TO-BIN           VALUE '2'.
  3241         88  YMD-GREG-TO-BIN            VALUE '3'.
  3242         88  MDY-GREG-TO-BIN            VALUE '4'.
  3243         88  JULIAN-TO-BIN              VALUE '5'.
  3244         88  BIN-PLUS-ELAPSED           VALUE '6'.
  3245         88  FIND-CENTURY               VALUE '7'.
  3246         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  3247         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  3248         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  3249         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  3250         88  JULIAN-TO-BIN-3            VALUE 'C'.
  3251         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  3252         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  3253         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3254         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3255         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  3256         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3257         88  BIN-3-TO-GREG              VALUE 'I'.
  3258         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3259         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3260         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3261         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  3262         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3263         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3264         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3265         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3266         88  THREE-CHARACTER-BIN
  3267                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3268         88  GREGORIAN-TO-BIN
  3269                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3270         88  BIN-TO-GREGORIAN
  3271                  VALUES ' ' '1' 'I' '8' 'G'.
  3272         88  JULIAN-TO-BINARY
  3273                  VALUES '5' 'C' 'E' 'F'.
  3274     12  DC-ERROR-CODE                 PIC X.
  3275         88  NO-CONVERSION-ERROR        VALUE ' '.
  3276         88  DATE-CONVERSION-ERROR
  3277                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  3278         88  DATE-IS-ZERO               VALUE '1'.
  3279         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page  61
* EL689.cbl
  3280         88  DATE-IS-INVALID            VALUE '3'.
  3281         88  DATE1-GREATER-DATE2        VALUE '4'.
  3282         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  3283         88  DATE-INVALID-OPTION        VALUE '9'.
  3284         88  INVALID-CENTURY            VALUE 'A'.
  3285         88  ONLY-CENTURY               VALUE 'B'.
  3286         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3287         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3288     12  DC-END-OF-MONTH               PIC X.
  3289         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3290     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3291         88  USE-NORMAL-PROCESS         VALUE ' '.
  3292         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  3293         88  ADJUST-UP-100-YRS          VALUE '2'.
  3294     12  FILLER                        PIC X.
  3295     12  DC-CONVERSION-DATES.
  3296         16  DC-BIN-DATE-1             PIC XX.
  3297         16  DC-BIN-DATE-2             PIC XX.
  3298         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  3299         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3300                       DC-GREG-DATE-1-EDIT.
  3301             20  DC-EDIT1-MONTH        PIC 99.
  3302             20  SLASH1-1              PIC X.
  3303             20  DC-EDIT1-DAY          PIC 99.
  3304             20  SLASH1-2              PIC X.
  3305             20  DC-EDIT1-YEAR         PIC 99.
  3306         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3307         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  3308                     DC-GREG-DATE-2-EDIT.
  3309             20  DC-EDIT2-MONTH        PIC 99.
  3310             20  SLASH2-1              PIC X.
  3311             20  DC-EDIT2-DAY          PIC 99.
  3312             20  SLASH2-2              PIC X.
  3313             20  DC-EDIT2-YEAR         PIC 99.
  3314         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3315         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3316                     DC-GREG-DATE-1-YMD.
  3317             20  DC-YMD-YEAR           PIC 99.
  3318             20  DC-YMD-MONTH          PIC 99.
  3319             20  DC-YMD-DAY            PIC 99.
  3320         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3321         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3322                      DC-GREG-DATE-1-MDY.
  3323             20  DC-MDY-MONTH          PIC 99.
  3324             20  DC-MDY-DAY            PIC 99.
  3325             20  DC-MDY-YEAR           PIC 99.
  3326         16  DC-GREG-DATE-1-ALPHA.
  3327             20  DC-ALPHA-MONTH        PIC X(10).
  3328             20  DC-ALPHA-DAY          PIC 99.
  3329             20  FILLER                PIC XX.
  3330             20  DC-ALPHA-CENTURY.
  3331                 24 DC-ALPHA-CEN-N     PIC 99.
  3332             20  DC-ALPHA-YEAR         PIC 99.
  3333         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3334         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3335         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3336         16  DC-JULIAN-DATE            PIC 9(05).
  3337         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page  62
* EL689.cbl
  3338                                       PIC 9(05).
  3339         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3340             20  DC-JULIAN-YEAR        PIC 99.
  3341             20  DC-JULIAN-DAYS        PIC 999.
  3342         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3343         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3344         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3345     12  DATE-CONVERSION-VARIBLES.
  3346         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3347         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3348             20  FILLER                PIC 9(3).
  3349             20  HOLD-CEN-1-CCYY.
  3350                 24  HOLD-CEN-1-CC     PIC 99.
  3351                 24  HOLD-CEN-1-YY     PIC 99.
  3352             20  HOLD-CEN-1-MO         PIC 99.
  3353             20  HOLD-CEN-1-DA         PIC 99.
  3354         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3355             20  HOLD-CEN-1-R-MO       PIC 99.
  3356             20  HOLD-CEN-1-R-DA       PIC 99.
  3357             20  HOLD-CEN-1-R-CCYY.
  3358                 24  HOLD-CEN-1-R-CC   PIC 99.
  3359                 24  HOLD-CEN-1-R-YY   PIC 99.
  3360             20  FILLER                PIC 9(3).
  3361         16  HOLD-CENTURY-1-X.
  3362             20  FILLER                PIC X(3)  VALUE SPACES.
  3363             20  HOLD-CEN-1-X-CCYY.
  3364                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3365                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3366             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3367             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3368         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3369             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3370             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3371             20  HOLD-CEN-1-R-X-CCYY.
  3372                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3373                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3374             20  FILLER                PIC XXX.
  3375         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3376         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3377         16  DC-JULIAN-DATE-1          PIC 9(07).
  3378         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3379             20  DC-JULIAN-1-CCYY.
  3380                 24  DC-JULIAN-1-CC    PIC 99.
  3381                 24  DC-JULIAN-1-YR    PIC 99.
  3382             20  DC-JULIAN-DA-1        PIC 999.
  3383         16  DC-JULIAN-DATE-2          PIC 9(07).
  3384         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3385             20  DC-JULIAN-2-CCYY.
  3386                 24  DC-JULIAN-2-CC    PIC 99.
  3387                 24  DC-JULIAN-2-YR    PIC 99.
  3388             20  DC-JULIAN-DA-2        PIC 999.
  3389         16  DC-GREG-DATE-A-EDIT.
  3390             20  DC-EDITA-MONTH        PIC 99.
  3391             20  SLASHA-1              PIC X VALUE '/'.
  3392             20  DC-EDITA-DAY          PIC 99.
  3393             20  SLASHA-2              PIC X VALUE '/'.
  3394             20  DC-EDITA-CCYY.
  3395                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page  63
* EL689.cbl
  3396                 24  DC-EDITA-YEAR     PIC 99.
  3397         16  DC-GREG-DATE-B-EDIT.
  3398             20  DC-EDITB-MONTH        PIC 99.
  3399             20  SLASHB-1              PIC X VALUE '/'.
  3400             20  DC-EDITB-DAY          PIC 99.
  3401             20  SLASHB-2              PIC X VALUE '/'.
  3402             20  DC-EDITB-CCYY.
  3403                 24  DC-EDITB-CENT     PIC 99.
  3404                 24  DC-EDITB-YEAR     PIC 99.
  3405         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3406         16  DC-GREG-DATE-CYMD-R REDEFINES
  3407                              DC-GREG-DATE-CYMD.
  3408             20  DC-CYMD-CEN           PIC 99.
  3409             20  DC-CYMD-YEAR          PIC 99.
  3410             20  DC-CYMD-MONTH         PIC 99.
  3411             20  DC-CYMD-DAY           PIC 99.
  3412         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3413         16  DC-GREG-DATE-MDCY-R REDEFINES
  3414                              DC-GREG-DATE-MDCY.
  3415             20  DC-MDCY-MONTH         PIC 99.
  3416             20  DC-MDCY-DAY           PIC 99.
  3417             20  DC-MDCY-CEN           PIC 99.
  3418             20  DC-MDCY-YEAR          PIC 99.
  3419    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3420        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3421    12  DC-EL310-DATE                  PIC X(21).
  3422    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page  64
* EL689.cbl
  3424*    COPY ELCNWA.
  3425*****************************************************************
  3426*                                                               *
  3427*                                                               *
  3428*                            ELCNWA.                            *
  3429*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3430*                            VMOD=2.003                         *
  3431*                                                               *
  3432*            M O V E   N A M E   W O R K   A R E A.             *
  3433*                                                               *
  3434*****************************************************************.
  3435
  3436 01  WS-NAME-WORK-AREA.
  3437     05  WS-INSURED-LAST-NAME        PIC X(15).
  3438     05  WS-INSURED-1ST-NAME         PIC X(12).
  3439     05  WS-INSURED-MID-INIT         PIC X.
  3440
  3441     05  WS-NAME-WORK.
  3442         10  WS-NW                   PIC X
  3443             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
  3444
  3445     05  WS-NAME-WORK2.
  3446         10  WS-NW2                  PIC X
  3447             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
  3448                                        NWA-INDEX0.
  3449
  3450     05  WS-NAME-SW                  PIC S9          VALUE ZERO
  3451                                     COMP-3.
  3452
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page  65
* EL689.cbl
  3454*    COPY ELCEMIB.
  3455******************************************************************
  3456*                                                                *
  3457*                                                                *
  3458*                            ELCEMIB.                            *
  3459*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3460*                            VMOD=2.005                          *
  3461*                                                                *
  3462*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  3463*                                                                *
  3464******************************************************************
  3465 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  3466     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  3467     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  3468     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  3469     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  3470     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  3471     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  3472     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  3473     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  3474     12  EMI-SWITCH1             PIC X        VALUE '1'.
  3475         88  EMI-NO-ERRORS                    VALUE '1'.
  3476         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  3477         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  3478     12  EMI-SWITCH2             PIC X        VALUE '1'.
  3479         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  3480     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  3481         88  EMI-AREA1-EMPTY                  VALUE '1'.
  3482         88  EMI-AREA1-FULL                   VALUE '2'.
  3483     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  3484         88  EMI-AREA2-EMPTY                  VALUE '1'.
  3485         88  EMI-AREA2-FULL                   VALUE '2'.
  3486     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  3487         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  3488         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  3489         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  3490         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  3491         88  EMI-BYPASS-FATALS                VALUE 'X'.
  3492     12  EMI-ERROR-LINES.
  3493         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  3494         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  3495         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  3496         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  3497             20  EMI-ERR-CODES OCCURS 10 TIMES.
  3498                 24  EMI-ERR-NUM         PIC X(4).
  3499                 24  EMI-FILLER          PIC X.
  3500                 24  EMI-SEV             PIC X.
  3501                 24  FILLER              PIC X.
  3502             20  FILLER                  PIC X(02).
  3503     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  3504         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  3505             20  EMI-ERROR-NUMBER    PIC X(4).
  3506             20  EMI-FILL            PIC X.
  3507             20  EMI-SEVERITY        PIC X.
  3508             20  FILLER              PIC X.
  3509             20  EMI-ERROR-TEXT.
  3510                 24  EMI-TEXT-VARIABLE   PIC X(10).
  3511                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page  66
* EL689.cbl
  3512     12  EMI-SEVERITY-SAVE           PIC X.
  3513         88  EMI-NOTE                    VALUE 'N'.
  3514         88  EMI-WARNING                 VALUE 'W'.
  3515         88  EMI-FORCABLE                VALUE 'F'.
  3516         88  EMI-FATAL                   VALUE 'X'.
  3517     12  EMI-MESSAGE-FLAG            PIC X.
  3518         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  3519         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  3520     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  3521     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  3522         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  3523         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  3524         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  3525     12  FILLER                      PIC X(137)  VALUE SPACES.
  3526     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  3527     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  3528     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  3529     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  3530 01  EMI-SAVE-AREA               PIC X(400).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page  67
* EL689.cbl
  3532*    COPY ELCLOGOF.
  3533******************************************************************
  3534*                                                                *
  3535*                                                                *
  3536*                            ELCLOGOF.                           *
  3537*                            VMOD=2.001                          *
  3538*                                                                *
  3539*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  3540*                                                                *
  3541******************************************************************
  3542 01  CLASIC-LOGOFF.
  3543     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  3544     12  LOGOFF-TEXT.
  3545         16  FILLER          PIC X(5)    VALUE SPACES.
  3546         16  LOGOFF-MSG.
  3547             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  3548             20  FILLER      PIC X       VALUE SPACES.
  3549             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  3550         16  FILLER          PIC X(80)
  3551           VALUE '* YOU ARE NOW LOGGED OFF'.
  3552         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  3553         16  FILLER          PIC X       VALUE QUOTE.
  3554         16  LOGOFF-SYS-MSG  PIC X(17)
  3555           VALUE 'S CLAS-IC SYSTEM '.
  3556     12  TEXT-MESSAGES.
  3557         16  UNACCESS-MSG    PIC X(29)
  3558             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  3559         16  PGMIDERR-MSG    PIC X(17)
  3560             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page  68
* EL689.cbl
  3562*    COPY ELCSCTM.
  3563******************************************************************
  3564*                                                                *
  3565*                                                                *
  3566*                            ELCSCTM                             *
  3567*                            VMOD=2.001                          *
  3568*                                                                *
  3569*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
  3570*                                                                *
  3571******************************************************************
  3572 01  SECURITY-MESSAGE.
  3573     12  FILLER                          PIC X(30)
  3574            VALUE '** LOGIC SECURITY VIOLATION -'.
  3575     12  SM-READ                         PIC X(6).
  3576     12  FILLER                          PIC X(5)
  3577            VALUE ' PGM='.
  3578     12  SM-PGM                          PIC X(6).
  3579     12  FILLER                          PIC X(5)
  3580            VALUE ' OPR='.
  3581     12  SM-PROCESSOR-ID                 PIC X(4).
  3582     12  FILLER                          PIC X(6)
  3583            VALUE ' TERM='.
  3584     12  SM-TERMID                       PIC X(4).
  3585     12  FILLER                          PIC XX   VALUE SPACE.
  3586     12  SM-JUL-DATE                     PIC 9(5).
  3587     12  FILLER                          PIC X    VALUE SPACE.
  3588     12  SM-TIME                         PIC 99.99.
  3589
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page  69
* EL689.cbl
  3591*    COPY ELCSCRTY.
  3592******************************************************************
  3593*                                                                *
  3594*                                                                *
  3595*                            ELCSCRTY                            *
  3596*                            VMOD=2.001                          *
  3597*                                                                *
  3598*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
  3599*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
  3600*        SAVED IN PI-SECURITY-ADDRESS.                           *
  3601*                                                                *
  3602******************************************************************
  3603 01  SECURITY-CONTROL.
  3604     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
  3605     12  FILLER                       PIC XX    VALUE 'SC'.
  3606     12  SC-CREDIT-CODES.
  3607         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
  3608             20  SC-CREDIT-DISPLAY    PIC X.
  3609             20  SC-CREDIT-UPDATE     PIC X.
  3610     12  SC-CLAIMS-CODES.
  3611         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
  3612             20  SC-CLAIMS-DISPLAY    PIC X.
  3613             20  SC-CLAIMS-UPDATE     PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page  70
* EL689.cbl
  3615
  3616 01  W-TS-WORK-AREA              PIC X(3650).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page  71
* EL689.cbl
  3618****************************************************************
  3619*
  3620* Copyright (c) 2007 by Clerity Solutions, Inc.
  3621* All rights reserved.
  3622*
  3623****************************************************************
  3624 01  DFHEIV.
  3625   02  DFHEIV0               PIC X(35).
  3626   02  DFHEIV1               PIC X(08).
  3627   02  DFHEIV2               PIC X(08).
  3628   02  DFHEIV3               PIC X(08).
  3629   02  DFHEIV4               PIC X(06).
  3630   02  DFHEIV5               PIC X(04).
  3631   02  DFHEIV6               PIC X(04).
  3632   02  DFHEIV7               PIC X(02).
  3633   02  DFHEIV8               PIC X(02).
  3634   02  DFHEIV9               PIC X(01).
  3635   02  DFHEIV10              PIC S9(7) COMP-3.
  3636   02  DFHEIV11              PIC S9(4) COMP SYNC.
  3637   02  DFHEIV12              PIC S9(4) COMP SYNC.
  3638   02  DFHEIV13              PIC S9(4) COMP SYNC.
  3639   02  DFHEIV14              PIC S9(4) COMP SYNC.
  3640   02  DFHEIV15              PIC S9(4) COMP SYNC.
  3641   02  DFHEIV16              PIC S9(9) COMP SYNC.
  3642   02  DFHEIV17              PIC X(04).
  3643   02  DFHEIV18              PIC X(04).
  3644   02  DFHEIV19              PIC X(04).
  3645   02  DFHEIV20              USAGE IS POINTER.
  3646   02  DFHEIV21              USAGE IS POINTER.
  3647   02  DFHEIV22              USAGE IS POINTER.
  3648   02  DFHEIV23              USAGE IS POINTER.
  3649   02  DFHEIV24              USAGE IS POINTER.
  3650   02  DFHEIV25              PIC S9(9) COMP SYNC.
  3651   02  DFHEIV26              PIC S9(9) COMP SYNC.
  3652   02  DFHEIV27              PIC S9(9) COMP SYNC.
  3653   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3654   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3655   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3656   02  FILLER                PIC X(02).
  3657   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3658   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  3659   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3660   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3661   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3662 LINKAGE  SECTION.
  3663*****************************************************************
  3664*                                                               *
  3665* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  3666* All rights reserved.                                          *
  3667*                                                               *
  3668*****************************************************************
  3669 01  dfheiblk.
  3670     02  eibtime          pic s9(7) comp-3.
  3671     02  eibdate          pic s9(7) comp-3.
  3672     02  eibtrnid         pic x(4).
  3673     02  eibtaskn         pic s9(7) comp-3.
  3674     02  eibtrmid         pic x(4).
  3675     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page  72
* EL689.cbl
  3676     02  eibcposn         pic s9(4) comp.
  3677     02  eibcalen         pic s9(4) comp.
  3678     02  eibaid           pic x(1).
  3679     02  eibfiller1       pic x(1).
  3680     02  eibfn            pic x(2).
  3681     02  eibfiller2       pic x(2).
  3682     02  eibrcode         pic x(6).
  3683     02  eibfiller3       pic x(2).
  3684     02  eibds            pic x(8).
  3685     02  eibreqid         pic x(8).
  3686     02  eibrsrce         pic x(8).
  3687     02  eibsync          pic x(1).
  3688     02  eibfree          pic x(1).
  3689     02  eibrecv          pic x(1).
  3690     02  eibsend          pic x(1).
  3691     02  eibatt           pic x(1).
  3692     02  eibeoc           pic x(1).
  3693     02  eibfmh           pic x(1).
  3694     02  eibcompl         pic x(1).
  3695     02  eibsig           pic x(1).
  3696     02  eibconf          pic x(1).
  3697     02  eiberr           pic x(1).
  3698     02  eibrldbk         pic x(1).
  3699     02  eiberrcd         pic x(4).
  3700     02  eibsynrb         pic x(1).
  3701     02  eibnodat         pic x(1).
  3702     02  eibfiller5       pic x(2).
  3703     02  eibresp          pic 9(09) comp.
  3704     02  eibresp2         pic 9(09) comp.
  3705     02  dfheigdj         pic s9(4) comp.
  3706     02  dfheigdk         pic s9(4) comp.
  3707 01  DFHCOMMAREA                 PIC X(1024).
  3708
  3709*    COPY ERCACCT.
  3710******************************************************************
  3711*                                                                *
  3712*                                                                *
  3713*                            ERCACCT                             *
  3714*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3715*                            VMOD=2.031                          *
  3716*                                                                *
  3717*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  3718*                                                                *
  3719*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  3720*   VSAM ACCOUNT MASTER FILES.                                   *
  3721*                                                                *
  3722*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  3723*                                                                *
  3724*   FILE TYPE = VSAM,KSDS                                        *
  3725*   RECORD SIZE = 2000  RECFORM = FIX                            *
  3726*                                                                *
  3727*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  3728*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  3729*                                                                *
  3730*   LOG = NO                                                     *
  3731*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3732*                                                                *
  3733*                                                                *
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page  73
* EL689.cbl
  3734******************************************************************
  3735*                   C H A N G E   L O G
  3736*
  3737* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3738*-----------------------------------------------------------------
  3739*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3740* EFFECTIVE    NUMBER
  3741*-----------------------------------------------------------------
  3742* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  3743* 092705    2005050300006  PEMA  ADD SPP LEASES
  3744* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  3745* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3746* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  3747* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  3748******************************************************************
  3749
  3750 01  ACCOUNT-MASTER.
  3751     12  AM-RECORD-ID                      PIC XX.
  3752         88  VALID-AM-ID                      VALUE 'AM'.
  3753
  3754     12  AM-CONTROL-PRIMARY.
  3755         16  AM-COMPANY-CD                 PIC X.
  3756         16  AM-MSTR-CNTRL.
  3757             20  AM-CONTROL-A.
  3758                 24  AM-CARRIER            PIC X.
  3759                 24  AM-GROUPING.
  3760                     28 AM-GROUPING-PREFIX PIC XXX.
  3761                     28 AM-GROUPING-PRIME  PIC XXX.
  3762                 24  AM-STATE              PIC XX.
  3763                 24  AM-ACCOUNT.
  3764                     28  AM-ACCOUNT-PREFIX PIC X(4).
  3765                     28  AM-ACCOUNT-PRIME  PIC X(6).
  3766             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  3767                                           PIC X(19).
  3768             20  AM-CNTRL-B.
  3769                 24  AM-EXPIRATION-DT      PIC XX.
  3770                 24  FILLER                PIC X(4).
  3771             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  3772                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  3773
  3774     12  AM-CONTROL-BY-VAR-GRP.
  3775         16  AM-COMPANY-CD-A1              PIC X.
  3776         16  AM-VG-CARRIER                 PIC X.
  3777         16  AM-VG-GROUPING                PIC X(6).
  3778         16  AM-VG-STATE                   PIC XX.
  3779         16  AM-VG-ACCOUNT                 PIC X(10).
  3780         16  AM-VG-DATE.
  3781             20  AM-VG-EXPIRATION-DT       PIC XX.
  3782             20  FILLER                    PIC X(4).
  3783         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  3784                                           PIC 9(11)      COMP-3.
  3785     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  3786         16  FILLER                        PIC X(10).
  3787         16  AM-VG-KEY3.
  3788             20  AM-VG3-ACCOUNT            PIC X(10).
  3789             20  AM-VG3-EXP-DT             PIC XX.
  3790         16  FILLER                        PIC X(4).
  3791     12  AM-MAINT-INFORMATION.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page  74
* EL689.cbl
  3792         16  AM-LAST-MAINT-DT              PIC XX.
  3793         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  3794         16  AM-LAST-MAINT-USER            PIC X(4).
  3795         16  FILLER                        PIC XX.
  3796
  3797     12  AM-EFFECTIVE-DT                   PIC XX.
  3798     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  3799
  3800     12  AM-PREV-DATES  COMP-3.
  3801         16  AM-PREV-EXP-DT                PIC 9(11).
  3802         16  AM-PREV-EFF-DT                PIC 9(11).
  3803
  3804     12  AM-REPORT-CODE-1                  PIC X(10).
  3805     12  AM-REPORT-CODE-2                  PIC X(10).
  3806
  3807     12  AM-CITY-CODE                      PIC X(4).
  3808     12  AM-COUNTY-PARISH                  PIC X(6).
  3809
  3810     12  AM-NAME                           PIC X(30).
  3811     12  AM-PERSON                         PIC X(30).
  3812     12  AM-ADDRS                          PIC X(30).
  3813     12  AM-CITY.
  3814         16  AM-ADDR-CITY                  PIC X(28).
  3815         16  AM-ADDR-STATE                 PIC XX.
  3816     12  AM-ZIP.
  3817         16  AM-ZIP-PRIME.
  3818             20  AM-ZIP-PRI-1ST            PIC X.
  3819                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  3820             20  FILLER                    PIC X(4).
  3821         16  AM-ZIP-PLUS4                  PIC X(4).
  3822     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  3823         16  AM-CAN-POSTAL-1               PIC XXX.
  3824         16  AM-CAN-POSTAL-2               PIC XXX.
  3825         16  FILLER                        PIC XXX.
  3826     12  AM-TEL-NO.
  3827         16  AM-AREA-CODE                  PIC 999.
  3828         16  AM-TEL-PRE                    PIC 999.
  3829         16  AM-TEL-NBR                    PIC 9(4).
  3830     12  AM-TEL-LOC                        PIC X.
  3831         88  AM-TEL-AT-HOME                   VALUE 'H'.
  3832         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  3833
  3834     12  AM-COMM-STRUCTURE.
  3835         16  AM-DEFN-1.
  3836             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  3837                 24  AM-AGT.
  3838                     28  AM-AGT-PREFIX     PIC X(4).
  3839                     28  AM-AGT-PRIME      PIC X(6).
  3840                 24  AM-COM-TYP            PIC X.
  3841                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  3842                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  3843                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  3844                 24  AM-RECALC-LV-INDIC    PIC X.
  3845                 24  AM-RETRO-LV-INDIC     PIC X.
  3846                 24  AM-GL-CODES           PIC X.
  3847                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  3848                 24  FILLER                PIC X(01).
  3849         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page  75
* EL689.cbl
  3850             20  AM-COM-TBLS        OCCURS 10 TIMES.
  3851                 24  FILLER                PIC X(11).
  3852                 24  AM-L-COMA             PIC XXX.
  3853                 24  AM-J-COMA             PIC XXX.
  3854                 24  AM-A-COMA             PIC XXX.
  3855                 24  FILLER                PIC X(6).
  3856
  3857     12  AM-COMM-CHANGE-STATUS             PIC X.
  3858         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  3859
  3860     12  AM-CSR-CODE                       PIC X(4).
  3861
  3862     12  AM-BILLING-STATUS                 PIC X.
  3863         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  3864         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  3865     12  AM-AUTO-REFUND-SW                 PIC X.
  3866         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  3867         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  3868     12  AM-GPCD                           PIC 99.
  3869     12  AM-IG                             PIC X.
  3870         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  3871         88  AM-HAS-GROUP                     VALUE '2'.
  3872     12  AM-STATUS                         PIC X.
  3873         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  3874         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  3875         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  3876         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  3877         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  3878         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  3879     12  AM-REMIT-TO                       PIC 99.
  3880     12  AM-ID-NO                          PIC X(11).
  3881
  3882     12  AM-CAL-TABLE                      PIC XX.
  3883     12  AM-LF-DEVIATION                   PIC XXX.
  3884     12  AM-AH-DEVIATION                   PIC XXX.
  3885     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  3886     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  3887     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  3888     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  3889     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  3890     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  3891
  3892     12  AM-USER-FIELDS.
  3893         16  AM-FLD-1                      PIC XX.
  3894         16  AM-FLD-2                      PIC XX.
  3895         16  AM-FLD-3                      PIC XX.
  3896         16  AM-FLD-4                      PIC XX.
  3897         16  AM-FLD-5                      PIC XX.
  3898
  3899     12  AM-1ST-PROD-DATE.
  3900         16  AM-1ST-PROD-YR                PIC XX.
  3901         16  AM-1ST-PROD-MO                PIC XX.
  3902         16  AM-1ST-PROD-DA                PIC XX.
  3903     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  3904     12  AM-CERTS-PURGED-DATE.
  3905         16  AM-PUR-YR                     PIC XX.
  3906         16  AM-PUR-MO                     PIC XX.
  3907         16  AM-PUR-DA                     PIC XX.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page  76
* EL689.cbl
  3908     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  3909     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  3910     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  3911     12  AM-INACTIVE-DATE.
  3912         16  AM-INA-MO                     PIC 99.
  3913         16  AM-INA-DA                     PIC 99.
  3914         16  AM-INA-YR                     PIC 99.
  3915     12  AM-AR-HI-CERT-DATE                PIC XX.
  3916
  3917     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  3918     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  3919
  3920     12  AM-OB-PAYMENT-MODE                PIC X.
  3921         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  3922         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  3923         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  3924         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  3925
  3926     12  AM-AH-ONLY-INDICATOR              PIC X.
  3927         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  3928         88  AM-NO-AH-ONLY                    VALUE 'N'.
  3929
  3930     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  3931
  3932     12  AM-OVER-SHORT.
  3933         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  3934         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  3935
  3936     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  3937     12  AM-DCC-CLP-STATE                  PIC XX.
  3938
  3939     12  AM-RECALC-COMM                    PIC X.
  3940     12  AM-RECALC-REIN                    PIC X.
  3941
  3942     12  AM-REI-TABLE                      PIC XXX.
  3943     12  AM-REI-ET-LF                      PIC X.
  3944     12  AM-REI-ET-AH                      PIC X.
  3945     12  AM-REI-PE-LF                      PIC X.
  3946     12  AM-REI-PE-AH                      PIC X.
  3947     12  AM-REI-PRT-ST                     PIC X.
  3948     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  3949     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  3950     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  3951     12  AM-REI-GROUP-A                    PIC X(6).
  3952     12  AM-REI-MORT                       PIC X(4).
  3953     12  AM-REI-PRT-OW                     PIC X.
  3954     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  3955     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  3956     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  3957     12  AM-REI-GROUP-B                    PIC X(6).
  3958
  3959     12  AM-TRUST-TYPE                     PIC X(2).
  3960
  3961     12  AM-EMPLOYER-STMT-USED             PIC X.
  3962     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  3963
  3964     12  AM-STD-AH-TYPE                    PIC XX.
  3965     12  AM-EARN-METHODS.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page  77
* EL689.cbl
  3966         16  AM-EARN-METHOD-R              PIC X.
  3967             88 AM-REF-RL-R78                 VALUE 'R'.
  3968             88 AM-REF-RL-PR                  VALUE 'P'.
  3969             88 AM-REF-RL-MEAN                VALUE 'M'.
  3970             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  3971         16  AM-EARN-METHOD-L              PIC X.
  3972             88 AM-REF-LL-R78                 VALUE 'R'.
  3973             88 AM-REF-LL-PR                  VALUE 'P'.
  3974             88 AM-REF-LL-MEAN                VALUE 'M'.
  3975             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  3976         16  AM-EARN-METHOD-A              PIC X.
  3977             88 AM-REF-AH-R78                 VALUE 'R'.
  3978             88 AM-REF-AH-PR                  VALUE 'P'.
  3979             88 AM-REF-AH-MEAN                VALUE 'M'.
  3980             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  3981             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  3982             88 AM-REF-AH-NET                 VALUE 'N'.
  3983
  3984     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  3985     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  3986     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  3987
  3988     12  AM-RET-Y-N                        PIC X.
  3989     12  AM-RET-P-E                        PIC X.
  3990     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  3991     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  3992     12  AM-RET-GRP                        PIC X(6).
  3993     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  3994         16  AM-POOL-PRIME                 PIC XXX.
  3995         16  AM-POOL-SUB                   PIC XXX.
  3996     12  AM-RETRO-EARNINGS.
  3997         16  AM-RET-EARN-R                 PIC X.
  3998         16  AM-RET-EARN-L                 PIC X.
  3999         16  AM-RET-EARN-A                 PIC X.
  4000     12  AM-RET-ST-TAX-USE                 PIC X.
  4001         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  4002         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  4003     12  AM-RETRO-BEG-EARNINGS.
  4004         16  AM-RET-BEG-EARN-R             PIC X.
  4005         16  AM-RET-BEG-EARN-L             PIC X.
  4006         16  AM-RET-BEG-EARN-A             PIC X.
  4007     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  4008     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  4009
  4010     12  AM-USER-SELECT-OPTIONS.
  4011         16  AM-USER-SELECT-1              PIC X(10).
  4012         16  AM-USER-SELECT-2              PIC X(10).
  4013         16  AM-USER-SELECT-3              PIC X(10).
  4014         16  AM-USER-SELECT-4              PIC X(10).
  4015         16  AM-USER-SELECT-5              PIC X(10).
  4016
  4017     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  4018
  4019     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  4020
  4021     12  AM-RPT045A-SWITCH                 PIC X.
  4022         88  RPT045A-OFF                   VALUE 'N'.
  4023
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page  78
* EL689.cbl
  4024     12  AM-INSURANCE-LIMITS.
  4025         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  4026         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  4027
  4028     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  4029         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  4030
  4031     12  AM-DISMBR-COVERAGE-SW             PIC X.
  4032         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  4033         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  4034
  4035     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  4036
  4037     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  4038     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  4039     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  4040     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  4041     12  FILLER                            PIC X(5).
  4042     12  AM-REPORT-CODE-3                  PIC X(10).
  4043*    12  FILLER                            PIC X(22).
  4044
  4045     12  AM-RESERVE-DATE.
  4046         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  4047         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  4048         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  4049
  4050     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  4051     12  AM-NOTIFICATION-TYPES.
  4052         16  AM-NOTIF-OF-LETTERS           PIC X.
  4053         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  4054         16  AM-NOTIF-OF-REPORTS           PIC X.
  4055         16  AM-NOTIF-OF-STATUS            PIC X.
  4056
  4057     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  4058         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  4059         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  4060         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  4061         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  4062
  4063     12  AM-BENEFIT-CONTROLS.
  4064         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  4065             20  AM-BENEFIT-CODE           PIC XX.
  4066             20  AM-BENEFIT-TYPE           PIC X.
  4067             20  AM-BENEFIT-REVISION       PIC XXX.
  4068             20  AM-BENEFIT-REM-TERM       PIC X.
  4069             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  4070             20  FILLER                    PIC XX.
  4071         16  FILLER                        PIC X(80).
  4072
  4073     12  AM-TRANSFER-DATA.
  4074         16  AM-TRANSFERRED-FROM.
  4075             20  AM-TRNFROM-CARRIER        PIC X.
  4076             20  AM-TRNFROM-GROUPING.
  4077                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  4078                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  4079             20  AM-TRNFROM-STATE          PIC XX.
  4080             20  AM-TRNFROM-ACCOUNT.
  4081                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page  79
* EL689.cbl
  4082                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  4083             20  AM-TRNFROM-DTE            PIC XX.
  4084         16  AM-TRANSFERRED-TO.
  4085             20  AM-TRNTO-CARRIER          PIC X.
  4086             20  AM-TRNTO-GROUPING.
  4087                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  4088                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  4089             20  AM-TRNTO-STATE            PIC XX.
  4090             20  AM-TRNTO-ACCOUNT.
  4091                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  4092                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  4093             20  AM-TRNTO-DTE              PIC XX.
  4094         16  FILLER                        PIC X(10).
  4095
  4096     12  AM-SAVED-REMIT-TO                 PIC 99.
  4097
  4098     12  AM-COMM-STRUCTURE-SAVED.
  4099         16  AM-DEFN-1-SAVED.
  4100             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  4101                 24  AM-AGT-SV             PIC X(10).
  4102                 24  AM-COM-TYP-SV         PIC X.
  4103                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  4104                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  4105                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  4106                 24  AM-RECALC-LV-INDIC-SV PIC X.
  4107                 24  FILLER                PIC X.
  4108                 24  AM-GL-CODES-SV        PIC X.
  4109                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  4110                 24  FILLER                PIC X.
  4111         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  4112             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  4113                 24  FILLER                PIC X(11).
  4114                 24  AM-L-COMA-SV          PIC XXX.
  4115                 24  AM-J-COMA-SV          PIC XXX.
  4116                 24  AM-A-COMA-SV          PIC XXX.
  4117                 24  FILLER                PIC X(6).
  4118
  4119     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  4120         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  4121            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  4122            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  4123            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  4124
  4125     12  AM-ORIG-DEALER-NO                 PIC X(10).
  4126     12  FILLER                            PIC X(120).
  4127
  4128     12  AM-ACCOUNT-EXECUTIVE-DATA.
  4129         16  AM-CONTROL-NAME               PIC X(30).
  4130         16  AM-EXECUTIVE-ONE.
  4131             20  AM-EXEC1-NAME             PIC X(15).
  4132             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  4133                                                          COMP-3.
  4134             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  4135                                                          COMP-3.
  4136         16  AM-EXECUTIVE-TWO.
  4137             20  AM-EXEC2-NAME             PIC X(15).
  4138             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  4139                                                          COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page  80
* EL689.cbl
  4140             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  4141                                                          COMP-3.
  4142
  4143     12  AM-RETRO-ADDITIONAL-DATA.
  4144         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  4145         16  AM-RETRO-PREM-P-E             PIC X.
  4146         16  AM-RETRO-CLMS-P-I             PIC X.
  4147         16  AM-RETRO-RET-BRACKET-LF.
  4148             20  AM-RETRO-RET-METHOD-LF    PIC X.
  4149                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  4150                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  4151             20  AM-RETRO-RET-BASIS-LF     PIC X.
  4152                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  4153                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  4154             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  4155                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  4156                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  4157         16  AM-RETRO-RET-BRACKET-AH.
  4158             20  AM-RETRO-RET-METHOD-AH    PIC X.
  4159                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  4160                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  4161                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  4162             20  AM-RETRO-RET-BASIS-AH     PIC X.
  4163                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  4164                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  4165             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  4166                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  4167                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  4168
  4169     12  AM-COMMENTS.
  4170         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  4171
  4172     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  4173         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  4174         16  AM-FLI-BILLING-CODE           PIC X.
  4175         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  4176         16  AM-FLI-UNITED-IDENT           PIC X.
  4177         16  AM-FLI-INTEREST-LOST-DATA.
  4178             20  AM-FLI-BANK-NO            PIC X(5).
  4179             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  4180             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  4181             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  4182         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  4183             20  AM-FLI-AGT                PIC X(9).
  4184             20  AM-FLI-AGT-COMM-ACC       PIC X.
  4185             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  4186         16  FILLER                        PIC X(102).
  4187
  4188     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  4189         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  4190             20  AM-BENEFIT-DMD-CODE         PIC XX.
  4191             20  AM-BENEFIT-DMD-TYPE         PIC X.
  4192             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  4193             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  4194             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  4195         16  FILLER                          PIC X(10).
  4196******************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page  81
* EL689.cbl
  4198*    COPY ERCARCH.
  4199******************************************************************
  4200*                                                                *
  4201*                            ERCARCH.                            *
  4202*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4203*                            VMOD=2.002                          *
  4204*                                                                *
  4205*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  4206*                                                                *
  4207*   FILE TYPE = VSAM,KSDS                                        *
  4208*   RECORD SIZE = 250  RECFORM = FIXED                           *
  4209*                                                                *
  4210*   BASE CLUSTER = ERARCH                        RKP=2,LEN=5     *
  4211*     ALTERNATE PATH1 = ERARCH2 (CERT/RESP)      RKP=07,LEN=35   *
  4212*     ALTERNATE PATH2 = ERARCH3 (FORM NUMBER)    RKP=44,LEN=28   *
  4213*     ALTERNATE PATH3 = ERARCH4 (PROCCESSOR ID)  RKP=73,LEN=28   *
  4214*     ALTERNATE PATH4 = ERARCH5 (ACCOUNT KEY)    RKP=100,LEN=24  *
  4215*     ALTERNATE PATH5 = ERARCH6 (BTCH/CHK KEY)   RKP=124,LEN=11  *
  4216*                                                                *
  4217*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4218******************************************************************
  4219*                   C H A N G E   L O G
  4220*
  4221* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4222*-----------------------------------------------------------------
  4223*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4224* EFFECTIVE    NUMBER
  4225*-----------------------------------------------------------------
  4226* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  4227******************************************************************
  4228 01  LETTER-ARCHIVE.
  4229     12  LA-RECORD-ID                PIC  X(02).
  4230         88  LA-VALID-ID                VALUE 'LA'.
  4231
  4232     12  LA-CONTROL-PRIMARY.
  4233         16  LA-COMPANY-CD           PIC  X(01).
  4234         16  LA-ARCHIVE-NO           PIC S9(08)    COMP.
  4235
  4236     12  LA-CONTROL-BY-CERT-RESP.
  4237         16  LA-COMPANY-CD-A2        PIC  X(01).
  4238         16  LA-CERT-NO-A2.
  4239             20  LA-CERT-PRIME-A2    PIC  X(10).
  4240             20  LA-CERT-SUFFIX-A2   PIC  X(01).
  4241         16  LA-RSP-PERSON-A2 REDEFINES LA-CERT-NO-A2.
  4242             20  LA-RESP-PERSON-A2   PIC  X(10).
  4243             20  LA-TYPE-A2          PIC  X(01).
  4244         16  LA-CARRIER-A2           PIC  X(01).
  4245         16  LA-GROUPING-A2          PIC  X(06).
  4246         16  LA-STATE-A2             PIC  X(02).
  4247         16  LA-ACCOUNT-A2           PIC  X(10).
  4248         16  LA-EFFECT-DATE-A2       PIC  X(02).
  4249         16  LA-ARCHIVE-NO-A2        PIC S9(08)    COMP.
  4250
  4251     12  LA-CONTROL-BY-FORM.
  4252         16  LA-COMPANY-CD-A3        PIC  X(01).
  4253         16  LA-FORM-A3              PIC  X(04).
  4254         16  LA-CARRIER-A3           PIC  X(01).
  4255         16  LA-GROUPING-A3          PIC  X(06).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page  82
* EL689.cbl
  4256         16  LA-STATE-A3             PIC  X(02).
  4257         16  LA-ACCOUNT-A3           PIC  X(10).
  4258         16  LA-ARCHIVE-NO-A3        PIC S9(08)    COMP.
  4259
  4260     12  LA-CONTROL-BY-PROCESSOR.
  4261         16  LA-COMPANY-CD-A4        PIC  X(01).
  4262         16  LA-PROCESSOR-CD         PIC  X(04).
  4263         16  LA-CARRIER-A4           PIC  X(01).
  4264         16  LA-GROUPING-A4          PIC  X(06).
  4265         16  LA-STATE-A4             PIC  X(02).
  4266         16  LA-ACCOUNT-A4           PIC  X(10).
  4267         16  LA-ARCHIVE-NO-A4        PIC S9(08)    COMP.
  4268
  4269     12  LA-CONTROL-BY-KEY-FIELDS.
  4270         16  LA-COMPANY-CD-A5        PIC  X(01).
  4271         16  LA-CARRIER-A5           PIC  X(01).
  4272         16  LA-GROUPING-A5          PIC  X(06).
  4273         16  LA-STATE-A5             PIC  X(02).
  4274         16  LA-ACCOUNT-A5           PIC  X(10).
  4275         16  LA-ARCHIVE-NO-A5        PIC S9(08)    COMP.
  4276
  4277     12  LA-CONTROL-BY-GROUP-CODE.
  4278         16  LA-COMPANY-CD-A6        PIC  X(01).
  4279         16  LA-ENTRY-A6.
  4280             20  LA-FILLER           PIC  X(02).
  4281             20  LA-QUE-CONTROL-A6   PIC S9(08)    COMP.
  4282         16  LA-ARCHIVE-NO-A6        PIC S9(08)    COMP.
  4283
  4284     12  FILLER                      PIC  X(09).
  4285
  4286     12  LA-HEADER-RECORD.
  4287         16  LA-NUMBER-LABEL-LINES   PIC S9(04)    COMP.
  4288         16  LA-CREATION-DATE        PIC  X(02).
  4289         16  LA-FOLLOW-UP-DATE       PIC  X(02).
  4290         16  LA-INITIAL-PRINT-DATE   PIC  X(02).
  4291         16  LA-NO-OF-COPIES         PIC S9(01).
  4292         16  LA-NO-OF-TEXT-RECORDS   PIC S9(04)    COMP.
  4293         16  LA-REPLY-DATE           PIC  X(02).
  4294         16  LA-RESEND-DATES.
  4295             20  LA-RESEND-DATE      PIC  X(02).
  4296             20  LA-SENT-DATE        PIC  X(02).
  4297             20  FILLER              PIC  X(08).
  4298         16  LA-SOURCE-INFORMATION.
  4299             20  LA-DATA-SOURCE      PIC  X(01).
  4300             20  LA-ADDR-SOURCE      PIC  X(01).
  4301         16  LA-STATUS               PIC  X(01).
  4302             88  LA-STATUS-ACTIVE         VALUE 'A'.
  4303             88  LA-STATUS-COMPLETED      VALUE 'C'.
  4304             88  LA-STATUS-ON-HOLD        VALUE 'H'.
  4305             88  LA-STATUS-TO-BE-PURGED   VALUE 'X'.
  4306             88  LA-STATUS-PURGED         VALUE 'P'.
  4307             88  LA-STATUS-VOIDED         VALUE 'V'.
  4308         16  LA-LAST-RESENT-PRINT-DATE
  4309                                     PIC  X(02).
  4310         16  LA-PRINT-RESTRICTION    PIC  X(01).
  4311             88  LA-PRINT-ONLY-WHEN-CNTL-GIVEN
  4312                                          VALUE 'C'.
  4313             88  LA-PRINT-ONLY-WHEN-FORM-GIVEN
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page  83
* EL689.cbl
  4314                                          VALUE 'F'.
  4315             88  LA-PRINT-ONLY-WHEN-PROC-GIVEN
  4316                                          VALUE 'P'.
  4317         16  LA-PURGED-DATE          PIC  X(02).
  4318         16  LA-VOIDED-DATE          PIC  X(02).
  4319         16  LA-RESEND-LETR          PIC  X(4).
  4320         16  FILLER                  PIC  X(08).
  4321*        16  LA-RESEND-LETR-2        PIC  X(4).
  4322*        16  LA-RESEND-LETR-3        PIC  X(4).
  4323         16  FILLER                  PIC  X(59).
  4324*        16  FILLER                  PIC  X(71).
  4325
  4326******************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page  84
* EL689.cbl
  4328*    COPY ERCARCT.
  4329******************************************************************
  4330*                                                                *
  4331*                            ERCARCT.                            *
  4332*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4333*                            VMOD=2.002                          *
  4334*                                                                *
  4335*   FILE DESCRIPTION = TEXT OF ARCHIVED LETTERDS                 *
  4336*                                                                *
  4337*   FILE TYPE = VSAM,KSDS                                        *
  4338*   RECORD SIZE = 1640  RECFORM = FIXED                          *
  4339*                                                                *
  4340*   BASE CLUSTER = ERARCT                        RKP=2,LEN=8     *
  4341*                                                                *
  4342*   LOG = NO                                                     *
  4343*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4344******************************************************************
  4345 01  LETTER-ARCHIVE-TEXT.
  4346     12  LT-RECORD-ID                PIC  X(02).
  4347         88  LT-VALID-ID                VALUE 'LA'.
  4348
  4349     12  LT-CONTROL-PRIMARY.
  4350         16  LT-COMPANY-CD           PIC  X(01).
  4351         16  LT-ARCHIVE-NO           PIC S9(08)    COMP.
  4352         16  LT-RECORD-TYPE          PIC  X(01).
  4353             88  LT-ADDRESS-DATA        VALUE '1'.
  4354             88  LT-TEXT-DATA           VALUE '2'.
  4355         16  LT-LINE-SEQ-NO          PIC S9(04)    COMP.
  4356
  4357     12  FILLER                      PIC  X(28).
  4358     12  LT-NUM-LINES-ON-RECORD      PIC S9(04)    COMP.
  4359
  4360     12  LT-TEXT-RECORD.
  4361         16  LT-LETTER-TEXT OCCURS 20 TIMES
  4362                            INDEXED BY LT-NDX.
  4363             20  LT-TEXT-LINE        PIC  X(70).
  4364             20  LT-SKIP-CONTROL     PIC  X(02).
  4365                 88  LT-NO-LINES-SKIPPED             VALUE SPACES.
  4366                 88  LT-SKIP-TO-NEXT-PAGE            VALUE '99'.
  4367             20  FILLER              PIC  X(08).
  4368
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page  85
* EL689.cbl
  4370*    COPY ELCCERT.
  4371******************************************************************
  4372*                                                                *
  4373*                            ELCCERT.                            *
  4374*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4375*                            VMOD=2.013                          *
  4376*                                                                *
  4377*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  4378*                                                                *
  4379*   FILE TYPE = VSAM,KSDS                                        *
  4380*   RECORD SIZE = 450  RECFORM = FIXED                           *
  4381*                                                                *
  4382*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  4383*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  4384*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  4385*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  4386*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  4387*                                                                *
  4388*   LOG = YES                                                    *
  4389*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4390******************************************************************
  4391*                   C H A N G E   L O G
  4392*
  4393* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4394*-----------------------------------------------------------------
  4395*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4396* EFFECTIVE    NUMBER
  4397*-----------------------------------------------------------------
  4398* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4399* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4400* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  4401* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4402* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4403* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  4404* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4405******************************************************************
  4406
  4407 01  CERTIFICATE-MASTER.
  4408     12  CM-RECORD-ID                      PIC XX.
  4409         88  VALID-CM-ID                      VALUE 'CM'.
  4410
  4411     12  CM-CONTROL-PRIMARY.
  4412         16  CM-COMPANY-CD                 PIC X.
  4413         16  CM-CARRIER                    PIC X.
  4414         16  CM-GROUPING.
  4415             20  CM-GROUPING-PREFIX        PIC X(3).
  4416             20  CM-GROUPING-PRIME         PIC X(3).
  4417         16  CM-STATE                      PIC XX.
  4418         16  CM-ACCOUNT.
  4419             20  CM-ACCOUNT-PREFIX         PIC X(4).
  4420             20  CM-ACCOUNT-PRIME          PIC X(6).
  4421         16  CM-CERT-EFF-DT                PIC XX.
  4422         16  CM-CERT-NO.
  4423             20  CM-CERT-PRIME             PIC X(10).
  4424             20  CM-CERT-SFX               PIC X.
  4425
  4426     12  CM-CONTROL-BY-NAME.
  4427         16  CM-COMPANY-CD-A1              PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page  86
* EL689.cbl
  4428         16  CM-INSURED-LAST-NAME          PIC X(15).
  4429         16  CM-INSURED-INITIALS.
  4430             20  CM-INSURED-INITIAL1       PIC X.
  4431             20  CM-INSURED-INITIAL2       PIC X.
  4432
  4433     12  CM-CONTROL-BY-SSN.
  4434         16  CM-COMPANY-CD-A2              PIC X.
  4435         16  CM-SOC-SEC-NO.
  4436             20  CM-SSN-STATE              PIC XX.
  4437             20  CM-SSN-ACCOUNT            PIC X(6).
  4438             20  CM-SSN-LN3.
  4439                 25  CM-INSURED-INITIALS-A2.
  4440                     30 CM-INSURED-INITIAL1-A2   PIC X.
  4441                     30 CM-INSURED-INITIAL2-A2   PIC X.
  4442                 25 CM-PART-LAST-NAME-A2         PIC X.
  4443
  4444     12  CM-CONTROL-BY-CERT-NO.
  4445         16  CM-COMPANY-CD-A4              PIC X.
  4446         16  CM-CERT-NO-A4                 PIC X(11).
  4447
  4448     12  CM-CONTROL-BY-MEMB.
  4449         16  CM-COMPANY-CD-A5              PIC X.
  4450         16  CM-MEMBER-NO.
  4451             20  CM-MEMB-STATE             PIC XX.
  4452             20  CM-MEMB-ACCOUNT           PIC X(6).
  4453             20  CM-MEMB-LN4.
  4454                 25  CM-INSURED-INITIALS-A5.
  4455                     30 CM-INSURED-INITIAL1-A5   PIC X.
  4456                     30 CM-INSURED-INITIAL2-A5   PIC X.
  4457                 25 CM-PART-LAST-NAME-A5         PIC XX.
  4458
  4459     12  CM-INSURED-PROFILE-DATA.
  4460         16  CM-INSURED-FIRST-NAME.
  4461             20  CM-INSURED-1ST-INIT       PIC X.
  4462             20  FILLER                    PIC X(9).
  4463         16  CM-INSURED-ISSUE-AGE          PIC 99.
  4464         16  CM-INSURED-SEX                PIC X.
  4465             88  CM-SEX-MALE                  VALUE 'M'.
  4466             88  CM-SEX-FEMAL                 VALUE 'F'.
  4467         16  CM-INSURED-JOINT-AGE          PIC 99.
  4468         16  CM-JOINT-INSURED-NAME.
  4469             20  CM-JT-LAST-NAME           PIC X(15).
  4470             20  CM-JT-FIRST-NAME.
  4471                 24  CM-JT-1ST-INIT        PIC X.
  4472                 24  FILLER                PIC X(9).
  4473             20  CM-JT-INITIAL             PIC X.
  4474
  4475     12  CM-LIFE-DATA.
  4476         16  CM-LF-BENEFIT-CD              PIC XX.
  4477         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  4478         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  4479         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  4480         16  CM-LF-DEV-CODE                PIC XXX.
  4481         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4482         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  4483         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4484         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  4485         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page  87
* EL689.cbl
  4486         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4487         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  4488         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4489         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  4490         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4491         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4492         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  4493         16  FILLER                        PIC XX.
  4494
  4495     12  CM-AH-DATA.
  4496         16  CM-AH-BENEFIT-CD              PIC XX.
  4497         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  4498         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  4499         16  CM-AH-DEV-CODE                PIC XXX.
  4500         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4501         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  4502         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4503         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4504         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4505         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  4506         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  4507         16  CM-AH-PAID-THRU-DT            PIC XX.
  4508             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  4509         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4510         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4511         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  4512         16  FILLER                        PIC X.
  4513
  4514     12  CM-LOAN-INFORMATION.
  4515         16  CM-LIVES                      PIC S9(7)     COMP-3.
  4516         16  CM-BILLED                     PIC S9(7)     COMP-3.
  4517         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  4518         16  CM-PAY-FREQUENCY              PIC S99.
  4519         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  4520         16  CM-RATE-CLASS                 PIC XX.
  4521         16  CM-BENEFICIARY                PIC X(25).
  4522         16  CM-POLICY-FORM-NO             PIC X(12).
  4523         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  4524         16  CM-LAST-ADD-ON-DT             PIC XX.
  4525         16  CM-DEDUCTIBLE-AMOUNTS.
  4526             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  4527             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  4528         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4529             20  CM-RESIDENT-STATE         PIC XX.
  4530             20  CM-RATE-CODE              PIC X(4).
  4531             20  FILLER                    PIC XX.
  4532         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4533             20  CM-LOAN-OFFICER           PIC X(5).
  4534             20  FILLER                    PIC XXX.
  4535         16  CM-CSR-CODE                   PIC XXX.
  4536         16  CM-UNDERWRITING-CODE          PIC X.
  4537             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  4538         16  CM-POST-CARD-IND              PIC X.
  4539         16  CM-NH-INTERFACE-SW            PIC X.
  4540         16  CM-PREMIUM-TYPE               PIC X.
  4541             88  CM-SING-PRM                  VALUE '1'.
  4542             88  CM-O-B-COVERAGE              VALUE '2'.
  4543             88  CM-OPEN-END                  VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page  88
* EL689.cbl
  4544         16  CM-IND-GRP-TYPE               PIC X.
  4545             88  CM-INDIVIDUAL                VALUE 'I'.
  4546             88  CM-GROUP                     VALUE 'G'.
  4547         16  CM-SKIP-CODE                  PIC X.
  4548             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  4549             88  SKIP-JULY                    VALUE '1'.
  4550             88  SKIP-AUGUST                  VALUE '2'.
  4551             88  SKIP-SEPTEMBER               VALUE '3'.
  4552             88  SKIP-JULY-AUG                VALUE '4'.
  4553             88  SKIP-AUG-SEPT                VALUE '5'.
  4554             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  4555             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  4556             88  SKIP-JUNE                    VALUE '8'.
  4557             88  SKIP-JUNE-JULY               VALUE '9'.
  4558             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  4559             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  4560         16  CM-PAYMENT-MODE               PIC X.
  4561             88  PAY-MONTHLY                  VALUE SPACE.
  4562             88  PAY-WEEKLY                   VALUE '1'.
  4563             88  PAY-SEMI-MONTHLY             VALUE '2'.
  4564             88  PAY-BI-WEEKLY                VALUE '3'.
  4565             88  PAY-SEMI-ANUALLY             VALUE '4'.
  4566         16  CM-LOAN-NUMBER                PIC X(8).
  4567         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  4568         16  CM-OLD-LOF                    PIC XXX.
  4569*        16  CM-LOAN-OFFICER               PIC XXX.
  4570         16  CM-REIN-TABLE                 PIC XXX.
  4571         16  CM-SPECIAL-REIN-CODE          PIC X.
  4572         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  4573         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  4574         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  4575
  4576     12  CM-STATUS-DATA.
  4577         16  CM-ENTRY-STATUS               PIC X.
  4578         16  CM-ENTRY-DT                   PIC XX.
  4579
  4580         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  4581         16  CM-LF-CANCEL-DT               PIC XX.
  4582         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  4583
  4584         16  CM-LF-STATUS-AT-DEATH         PIC X.
  4585         16  CM-LF-DEATH-DT                PIC XX.
  4586         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  4587
  4588         16  CM-LF-CURRENT-STATUS          PIC X.
  4589             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4590                                                'M' '4' '5' '9'.
  4591             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  4592             88  CM-LF-POLICY-PENDING         VALUE '2'.
  4593             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  4594             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  4595             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  4596             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4597             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  4598             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4599             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  4600             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  4601             88  CM-LF-DECLINED               VALUE 'D'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page  89
* EL689.cbl
  4602             88  CM-LF-VOIDED                 VALUE 'V'.
  4603
  4604         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  4605         16  CM-AH-CANCEL-DT               PIC XX.
  4606         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  4607
  4608         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  4609         16  CM-AH-SETTLEMENT-DT           PIC XX.
  4610         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  4611
  4612         16  CM-AH-CURRENT-STATUS          PIC X.
  4613             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4614                                                'M' '4' '5' '9'.
  4615             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  4616             88  CM-AH-POLICY-PENDING         VALUE '2'.
  4617             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  4618             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  4619             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  4620             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4621             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  4622             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4623             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  4624             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  4625             88  CM-AH-DECLINED               VALUE 'D'.
  4626             88  CM-AH-VOIDED                 VALUE 'V'.
  4627
  4628         16  CM-CLAIM-INTERFACE-SW         PIC X.
  4629             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  4630             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  4631             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  4632         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  4633
  4634         16  CM-ENTRY-BATCH                PIC X(6).
  4635         16  CM-LF-EXIT-BATCH              PIC X(6).
  4636         16  CM-AH-EXIT-BATCH              PIC X(6).
  4637         16  CM-LAST-MONTH-END             PIC XX.
  4638
  4639     12  CM-NOTE-SW                        PIC X.
  4640         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  4641         88  CERT-NOTES-PRESENT               VALUE '1'.
  4642         88  BILLING-NOTES-PRESENT            VALUE '2'.
  4643         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  4644         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  4645         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  4646         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  4647         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  4648     12  CM-COMP-EXCP-SW                   PIC X.
  4649         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  4650         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  4651     12  CM-INSURED-ADDRESS-SW             PIC X.
  4652         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  4653         88  INSURED-ADDR-PRESENT             VALUE '1'.
  4654
  4655*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  4656     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  4657     12  FILLER                            PIC X.
  4658
  4659*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page  90
* EL689.cbl
  4660     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  4661     12  FILLER                            PIC X.
  4662*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  4663     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  4664
  4665     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  4666         88  CERT-ADDED-BATCH                 VALUE ' '.
  4667         88  CERT-ADDED-ONLINE                VALUE '1'.
  4668         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  4669         88  CERT-PURGED-OFFLINE              VALUE '3'.
  4670         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  4671     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  4672         88  CERT-AS-LOADED                   VALUE ' '.
  4673         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  4674         88  CERT-CLAIM-ONLINE                VALUE '2'.
  4675         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  4676         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  4677         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  4678         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  4679         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  4680
  4681     12  CM-ACCOUNT-COMM-PCTS.
  4682         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  4683         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  4684
  4685     12  CM-USER-FIELD                     PIC X.
  4686     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  4687     12  CM-CLP-STATE                      PIC XX.
  4688     12  CM-USER-RESERVED                  PIC XXX.
  4689******************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page  91
* EL689.cbl
  4691*    COPY ERCCHEK.
  4692******************************************************************
  4693*                                                                *
  4694*                                                                *
  4695*                            ERCCHEK                             *
  4696*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4697*                            VMOD=2.008                          *
  4698*                                                                *
  4699*   FILE DESCRIPTION = CHECK RECORDS                             *
  4700*                                                                *
  4701*   FILE TYPE = VSAM,KSDS                                        *
  4702*   RECORD SIZE = 600    RECFORM = FIXED                         *
  4703*                                                                *
  4704*   BASE CLUSTER NAME = ERCHEK             RKP=2,LEN=35          *
  4705*       ALTERNATE INDEX = NONE                                   *
  4706*                                                                *
  4707*   LOG = YES                                                    *
  4708*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4709******************************************************************
  4710 01  CHECK-RECORDS.
  4711     12  CH-RECORD-ID                      PIC XX.
  4712         88  VALID-CH-ID                      VALUE 'CH'.
  4713
  4714     12  CH-CONTROL-PRIMARY.
  4715         16  CH-COMPANY-CD                 PIC X.
  4716         16  CH-CARRIER                    PIC X.
  4717         16  CH-GROUPING                   PIC X(6).
  4718         16  CH-STATE                      PIC XX.
  4719         16  CH-ACCOUNT                    PIC X(10).
  4720         16  CH-CERT-EFF-DT                PIC XX.
  4721         16  CH-CERT-NO.
  4722             20  CH-CERT-PRIME             PIC X(10).
  4723             20  CH-CERT-SFX               PIC X.
  4724         16  CH-SEQUENCE-NO                PIC S9(4)     COMP.
  4725
  4726     12  CH-RECORDED-DT                    PIC XX.
  4727     12  CH-RECORDED-BY                    PIC X(4).
  4728     12  CH-LAST-MAINT-HHMMSS              PIC S9(6)     COMP-3.
  4729
  4730     12  CH-AMOUNT-PAID                    PIC S9(7)V99  COMP-3.
  4731     12  CH-CHECK-NO                       PIC X(7).
  4732     12  CH-REASON-FOR-CHECK               PIC X(25).
  4733     12  CH-CHECK-WRITTEN-DT               PIC XX.
  4734     12  CH-OFFLINE-CHECK-IND              PIC X.
  4735         88  MANUAL-CHECK-WRITTEN             VALUE 'Y'.
  4736
  4737     12  CH-PAYEE-INFO.
  4738         16  CH-PAYEE-NAME-1               PIC X(30).
  4739         16  CH-PAYEE-NAME-2               PIC X(30).
  4740         16  CH-PAYEE-ADDRESS-1            PIC X(30).
  4741         16  CH-PAYEE-ADDRESS-2            PIC X(30).
  4742         16  CH-PAYEE-CITY-ST              PIC X(30).
  4743         16  CH-PAYEE-ZIP-CODE.
  4744             20  CH-PAYEE-ZIP.
  4745                 24  CH-ZIP-PRI-1ST        PIC X.
  4746                     88  CH-CANADIAN-POST-CODE
  4747                                           VALUES 'A' THRU 'Z'.
  4748                 24  FILLER                PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page  92
* EL689.cbl
  4749             20  CH-PAYEE-ZIP-EXT          PIC X(4).
  4750         16  CH-CANADIAN-POSTAL-CODE REDEFINES CH-PAYEE-ZIP-CODE.
  4751             20  CH-CAN-POSTAL-1           PIC XXX.
  4752             20  CH-CAN-POSTAL-2           PIC XXX.
  4753             20  FILLER                    PIC XXX.
  4754
  4755     12  CH-CHECK-STUB-TEXT.
  4756         16  CH-STUB-LINE-1                PIC X(50).
  4757         16  CH-STUB-LINE-2                PIC X(50).
  4758         16  CH-STUB-LINE-3                PIC X(50).
  4759         16  FILLER.
  4760           18  CH-STUB-LINE-4              PIC X(20).
  4761           18  CH-LIENHOLDER-NAME          PIC X(30).
  4762
  4763     12  CH-COMPENSATION-CONTROL.
  4764         16  CH-COMP-CARRIER               PIC X.
  4765         16  CH-COMP-GROUPING              PIC X(6).
  4766         16  CH-COMP-FIN-RESP              PIC X(10).
  4767         16  CH-COMP-ACCOUNT               PIC X(10).
  4768
  4769     12  CH-CREDIT-SELECT-DT               PIC XX.
  4770     12  CH-CREDIT-ACCEPT-DT               PIC XX.
  4771     12  CH-PAYEE-CODE                     PIC X(6).
  4772
  4773     12  CH-VOID-DATA.
  4774         20  CH-VOID-DT                    PIC XX.
  4775         20  CH-VOID-BY                    PIC X(4).
  4776         20  CH-VOID-REASON                PIC X(25).
  4777
  4778     12  CH-CHECK-QUE-CONTROL              PIC S9(8)     COMP.
  4779             88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  4780     12  CH-CHECK-QUE-SEQUENCE             PIC S9(4)     COMP.
  4781
  4782     12  CH-CHECK-REFERENCE                PIC X(12).
  4783     12  CH-CHECK-ORIGIN-SW                PIC X.
  4784             88  CH-REFUND-CHECK              VALUE 'R'.
  4785             88  CH-MAINT-CHECK               VALUE 'M'.
  4786
  4787     12  CH-CANC-DT                        PIC XX.
  4788     12  CH-LF-REFUND                      PIC S9(7)V99  COMP-3.
  4789     12  CH-AH-REFUND                      PIC S9(7)V99  COMP-3.
  4790
  4791     12  CH-INSURED-NAME                   PIC X(28).
  4792
  4793     12  CH-DEDUCT-WITHHELD                PIC S9(5)V99  COMP-3.
  4794     12  CH-ADDITIONAL-CHARGE              PIC S9(5)V99  COMP-3.
  4795
  4796     12  CH-LETTER-TABLE.
  4797         16  CH-LETTERS OCCURS 3 TIMES
  4798                        INDEXED BY CH-LT-NDX
  4799                                           PIC X(04).
  4800
  4801     12  FILLER                            PIC X(07).
  4802
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page  93
* EL689.cbl
  4804*    COPY ELCCNTL.
  4805******************************************************************
  4806*                                                                *
  4807*                                                                *
  4808*                            ELCCNTL.                            *
  4809*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4810*                            VMOD=2.059                          *
  4811*                                                                *
  4812*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  4813*                                                                *
  4814*   FILE TYPE = VSAM,KSDS                                        *
  4815*   RECORD SIZE = 750  RECFORM = FIXED                           *
  4816*                                                                *
  4817*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  4818*       ALTERNATE INDEX = NONE                                   *
  4819*                                                                *
  4820*   LOG = YES                                                    *
  4821*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4822******************************************************************
  4823*                   C H A N G E   L O G
  4824*
  4825* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4826*-----------------------------------------------------------------
  4827*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4828* EFFECTIVE    NUMBER
  4829*-----------------------------------------------------------------
  4830* 082503                   PEMA  ADD BENEFIT GROUP
  4831* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4832* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  4833* 092705    2005050300006  PEMA  ADD SPP LEASES
  4834* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  4835* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  4836* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  4837* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  4838******************************************************************
  4839*
  4840 01  CONTROL-FILE.
  4841     12  CF-RECORD-ID                       PIC XX.
  4842         88  VALID-CF-ID                        VALUE 'CF'.
  4843
  4844     12  CF-CONTROL-PRIMARY.
  4845         16  CF-COMPANY-ID                  PIC XXX.
  4846         16  CF-RECORD-TYPE                 PIC X.
  4847             88  CF-COMPANY-MASTER              VALUE '1'.
  4848             88  CF-PROCESSOR-MASTER            VALUE '2'.
  4849             88  CF-STATE-MASTER                VALUE '3'.
  4850             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  4851             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  4852             88  CF-CARRIER-MASTER              VALUE '6'.
  4853             88  CF-MORTALITY-MASTER            VALUE '7'.
  4854             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  4855             88  CF-TERMINAL-MASTER             VALUE '9'.
  4856             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  4857             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  4858             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  4859             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  4860             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  4861             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page  94
* EL689.cbl
  4862             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  4863             88  CF-REMINDERS-MASTER            VALUE 'R'.
  4864             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  4865         16  CF-ACCESS-CD-GENL              PIC X(4).
  4866         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  4867             20  CF-PROCESSOR               PIC X(4).
  4868         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  4869             20  CF-STATE-CODE              PIC XX.
  4870             20  FILLER                     PIC XX.
  4871         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  4872             20  FILLER                     PIC XX.
  4873             20  CF-HI-BEN-IN-REC           PIC XX.
  4874         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  4875             20  FILLER                     PIC XXX.
  4876             20  CF-CARRIER-CNTL            PIC X.
  4877         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  4878             20  FILLER                     PIC XX.
  4879             20  CF-HI-TYPE-IN-REC          PIC 99.
  4880         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  4881             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  4882                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  4883             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  4884             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  4885         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  4886             20  FILLER                     PIC X.
  4887             20  CF-CUSTOM-REPORT-NO        PIC 999.
  4888         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  4889             20  FILLER                     PIC XX.
  4890             20  CF-MORTGAGE-PLAN           PIC XX.
  4891         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  4892
  4893     12  CF-LAST-MAINT-DT                   PIC XX.
  4894     12  CF-LAST-MAINT-BY                   PIC X(4).
  4895     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  4896
  4897     12  CF-RECORD-BODY                     PIC X(728).
  4898
  4899
  4900****************************************************************
  4901*             COMPANY MASTER RECORD                            *
  4902****************************************************************
  4903
  4904     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4905         16  CF-COMPANY-ADDRESS.
  4906             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  4907             20  CF-CL-IN-CARE-OF           PIC X(30).
  4908             20  CF-CL-ADDR-LINE-1          PIC X(30).
  4909             20  CF-CL-ADDR-LINE-2          PIC X(30).
  4910             20  CF-CL-CITY-STATE           PIC X(30).
  4911             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  4912             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  4913         16  CF-COMPANY-CD                  PIC X.
  4914         16  CF-COMPANY-PASSWORD            PIC X(8).
  4915         16  CF-SECURITY-OPTION             PIC X.
  4916             88  ALL-SECURITY                   VALUE '1'.
  4917             88  COMPANY-VERIFY                 VALUE '2'.
  4918             88  PROCESSOR-VERIFY               VALUE '3'.
  4919             88  NO-SECURITY                    VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page  95
* EL689.cbl
  4920             88  ALL-BUT-TERM                   VALUE '5'.
  4921         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  4922             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  4923         16  CF-LGX-INTERFACE-CNTL          PIC X.
  4924             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  4925         16  CF-INFORCE-LOCATION            PIC X.
  4926             88  CERTS-ARE-ONLINE               VALUE '1'.
  4927             88  CERTS-ARE-OFFLINE              VALUE '2'.
  4928             88  NO-CERTS-AVAILABLE             VALUE '3'.
  4929         16  CF-LOWER-CASE-LETTERS          PIC X.
  4930         16  CF-CERT-ACCESS-CONTROL         PIC X.
  4931             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  4932             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  4933             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  4934             88  CF-ACCNT-CNTL                  VALUE '3'.
  4935             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  4936
  4937         16  CF-FORMS-PRINTER-ID            PIC X(4).
  4938         16  CF-CHECK-PRINTER-ID            PIC X(4).
  4939
  4940         16  CF-LGX-CREDIT-USER             PIC X.
  4941             88  CO-IS-NOT-USER                 VALUE 'N'.
  4942             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  4943
  4944         16 CF-CREDIT-CALC-CODES.
  4945             20  CF-CR-REM-TERM-CALC PIC X.
  4946               88  CR-EARN-AFTER-15TH           VALUE '1'.
  4947               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  4948               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  4949               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  4950               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  4951               88  CR-EARN-AFTER-14TH           VALUE '6'.
  4952               88  CR-EARN-AFTER-16TH           VALUE '7'.
  4953             20  CF-CR-R78-METHOD           PIC X.
  4954               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  4955               88  DONT-USE-PLUS-ONE            VALUE '1'.
  4956
  4957         16  CF-CLAIM-CONTROL-COUNTS.
  4958             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  4959                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  4960
  4961             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  4962                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  4963
  4964             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  4965                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  4966
  4967             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  4968                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  4969
  4970         16  CF-CURRENT-MONTH-END           PIC XX.
  4971
  4972         16  CF-CO-CALC-QUOTE-TOLERANCE.
  4973             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  4974             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  4975             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  4976             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  4977                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page  96
* EL689.cbl
  4978                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4979             20  CF-CO-PREM-REJECT-SW       PIC X.
  4980                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  4981                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  4982             20  CF-CO-REF-REJECT-SW        PIC X.
  4983                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  4984                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  4985
  4986         16  CF-CO-REPORTING-DT             PIC XX.
  4987         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  4988         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  4989           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  4990           88  CF-CO-MONTH-END                  VALUE '1'.
  4991
  4992         16  CF-LGX-CLAIM-USER              PIC X.
  4993             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  4994             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  4995
  4996         16  CF-CREDIT-EDIT-CONTROLS.
  4997             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  4998             20  CF-MIN-AGE                 PIC 99.
  4999             20  CF-DEFAULT-AGE             PIC 99.
  5000             20  CF-MIN-TERM                PIC S999      COMP-3.
  5001             20  CF-MAX-TERM                PIC S999      COMP-3.
  5002             20  CF-DEFAULT-SEX             PIC X.
  5003             20  CF-JOINT-AGE-INPUT         PIC X.
  5004                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  5005             20  CF-BIRTH-DATE-INPUT        PIC X.
  5006                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  5007             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  5008                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  5009                 88  CF-ZERO-CARRIER            VALUE '1'.
  5010                 88  CF-ZERO-GROUPING           VALUE '2'.
  5011                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  5012             20  CF-EDIT-SW                 PIC X.
  5013                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  5014             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  5015             20  CF-CR-PR-METHOD            PIC X.
  5016               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  5017               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  5018             20  FILLER                     PIC X.
  5019
  5020         16  CF-CREDIT-MISC-CONTROLS.
  5021             20  CF-REIN-TABLE-SW           PIC X.
  5022                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  5023             20  CF-COMP-TABLE-SW           PIC X.
  5024                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  5025             20  CF-EXPERIENCE-RETENTION-AGE
  5026                                            PIC S9        COMP-3.
  5027             20  CF-CONVERSION-DT           PIC XX.
  5028             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  5029             20  CF-RUN-FREQUENCY-SW        PIC X.
  5030                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  5031                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  5032
  5033             20  CF-CR-CHECK-NO-CONTROL.
  5034                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  5035                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page  97
* EL689.cbl
  5036                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  5037                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  5038                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  5039                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  5040
  5041                 24  CF-CR-CHECK-COUNT       REDEFINES
  5042                     CF-CR-CHECK-COUNTER      PIC X(4).
  5043
  5044                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  5045                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  5046
  5047                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  5048                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  5049                 24  CF-MAIL-PROCESSING       PIC X.
  5050                     88  MAIL-PROCESSING          VALUE 'Y'.
  5051
  5052         16  CF-MISC-SYSTEM-CONTROL.
  5053             20  CF-SYSTEM-C                 PIC X.
  5054                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  5055             20  CF-SYSTEM-D                 PIC X.
  5056                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  5057             20  CF-SOC-SEC-NO-SW            PIC X.
  5058                 88  SOC-SEC-NO-USED             VALUE '1'.
  5059             20  CF-MEMBER-NO-SW             PIC X.
  5060                 88  MEMBER-NO-USED              VALUE '1'.
  5061             20  CF-TAX-ID-NUMBER            PIC X(11).
  5062             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  5063             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  5064                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  5065                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  5066                 88  CF-ALL-APPROVED             VALUE 'Y'.
  5067                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  5068             20  CF-SYSTEM-E                 PIC X.
  5069                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  5070
  5071         16  CF-LGX-LIFE-USER               PIC X.
  5072             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  5073             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  5074
  5075         16  CF-CR-MONTH-END-DT             PIC XX.
  5076
  5077         16  CF-FILE-MAINT-DATES.
  5078             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  5079                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  5080             20  CF-LAST-BATCH       REDEFINES
  5081                 CF-LAST-BATCH-NO               PIC X(4).
  5082             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  5083             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  5084             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  5085             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  5086             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  5087             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  5088             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  5089             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  5090             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  5091             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  5092
  5093         16  CF-NEXT-COMPANY-ID             PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page  98
* EL689.cbl
  5094         16  FILLER                         PIC X.
  5095
  5096         16  CF-ALT-MORT-CODE               PIC X(4).
  5097         16  CF-MEMBER-CAPTION              PIC X(10).
  5098
  5099         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  5100             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  5101             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  5102             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  5103             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  5104             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  5105
  5106         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  5107
  5108         16  CF-LIFE-OVERRIDE-L1            PIC X.
  5109         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  5110         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  5111         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  5112
  5113         16  CF-AH-OVERRIDE-L1              PIC X.
  5114         16  CF-AH-OVERRIDE-L2              PIC XX.
  5115         16  CF-AH-OVERRIDE-L6              PIC X(6).
  5116         16  CF-AH-OVERRIDE-L12             PIC X(12).
  5117
  5118         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  5119         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  5120
  5121         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  5122         16  CF-AR-LAST-EL860-DT            PIC XX.
  5123         16  CF-MP-MONTH-END-DT             PIC XX.
  5124
  5125         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  5126         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  5127             88  CF-CLAIM-PAID-TO               VALUE '1'.
  5128
  5129         16  CF-AR-MONTH-END-DT             PIC XX.
  5130
  5131         16  CF-CRDTCRD-USER                PIC X.
  5132             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  5133             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  5134
  5135         16  CF-CC-MONTH-END-DT             PIC XX.
  5136
  5137         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  5138
  5139         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  5140             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  5141             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  5142             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  5143         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  5144         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  5145         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  5146         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  5147             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  5148             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  5149         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  5150         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  5151         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page  99
* EL689.cbl
  5152             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  5153         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  5154
  5155         16  CF-CL-ZIP-CODE.
  5156             20  CF-CL-ZIP-PRIME.
  5157                 24  CF-CL-ZIP-1ST          PIC X.
  5158                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  5159                 24  FILLER                 PIC X(4).
  5160             20  CF-CL-ZIP-PLUS4            PIC X(4).
  5161         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  5162             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  5163             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  5164             20  FILLER                     PIC XXX.
  5165
  5166         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  5167         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  5168         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  5169         16  CF-CO-OPTION-START-DATE        PIC XX.
  5170         16  CF-REM-TRM-CALC-OPTION         PIC X.
  5171           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  5172                                                      '3' '4'.
  5173           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  5174           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  5175           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  5176           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  5177           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  5178           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  5179
  5180         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  5181
  5182         16  CF-PAYMENT-APPROVAL-LEVELS.
  5183             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  5184             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  5185             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  5186             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  5187             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  5188             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  5189
  5190         16  CF-END-USER-REPORTING-USER     PIC X.
  5191             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  5192             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  5193
  5194         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  5195             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  5196             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  5197
  5198         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  5199
  5200         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  5201         16  FILLER                         PIC X.
  5202
  5203         16  CF-CREDIT-ARCHIVE-CNTL.
  5204             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  5205             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  5206             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  5207
  5208         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  5209
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 100
* EL689.cbl
  5210         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  5211             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  5212             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  5213
  5214         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  5215             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  5216             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  5217
  5218         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  5219
  5220         16  CF-CO-ACH-ID-CODE              PIC  X.
  5221             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  5222             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  5223             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  5224         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  5225         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  5226         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  5227         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  5228         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  5229         16  CF-CO-ACH-RECV-NO              PIC X(08).
  5230         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  5231         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  5232         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  5233                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  5234         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  5235                 CF-CO-ACH-TRACE-NO         PIC X(4).
  5236
  5237         16  CF-CO-OVER-SHORT.
  5238             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5239             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5240
  5241*         16  FILLER                         PIC X(102).
  5242         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  5243             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  5244             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  5245
  5246         16  CF-AH-APPROVAL-DAYS.
  5247             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  5248             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  5249             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  5250             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  5251
  5252         16  FILLER                         PIC X(82).
  5253****************************************************************
  5254*             PROCESSOR/USER RECORD                            *
  5255****************************************************************
  5256
  5257     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5258         16  CF-PROCESSOR-NAME              PIC X(30).
  5259         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  5260         16  CF-PROCESSOR-TITLE             PIC X(26).
  5261         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  5262                 88  MESSAGE-YES                VALUE 'Y'.
  5263                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  5264
  5265*****************************************************
  5266****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  5267****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 101
* EL689.cbl
  5268****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  5269****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  5270*****************************************************
  5271
  5272         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  5273             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  5274             20  CF-APPLICATION-FORCE       PIC X.
  5275             20  CF-INDIVIDUAL-APP.
  5276                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  5277                     28  CF-BROWSE-APP      PIC X.
  5278                     28  CF-UPDATE-APP      PIC X.
  5279
  5280         16  CF-CURRENT-TERM-ON             PIC X(4).
  5281         16  CF-PROCESSOR-LIMITS-CLAIMS.
  5282             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  5283             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  5284             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  5285             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  5286             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  5287             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  5288             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  5289         16  CF-PROCESSOR-CARRIER           PIC X.
  5290             88  NO-CARRIER-SECURITY            VALUE ' '.
  5291         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  5292             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  5293         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  5294             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  5295         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  5296             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  5297
  5298         16  CF-PROC-SYS-ACCESS-SW.
  5299             20  CF-PROC-CREDIT-CLAIMS-SW.
  5300                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  5301                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  5302                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  5303                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  5304             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  5305                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  5306                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  5307             20  CF-PROC-LIFE-GNRLDGR-SW.
  5308                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  5309                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  5310                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  5311                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  5312             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  5313                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  5314                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  5315         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  5316             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  5317             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  5318         16  CF-PROCESSOR-PRINTER               PIC X(4).
  5319
  5320         16  CF-APPROVAL-LEVEL                  PIC X.
  5321             88  APPROVAL-LEVEL-1                   VALUE '1'.
  5322             88  APPROVAL-LEVEL-2                   VALUE '2'.
  5323             88  APPROVAL-LEVEL-3                   VALUE '3'.
  5324             88  APPROVAL-LEVEL-4                   VALUE '4'.
  5325
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 102
* EL689.cbl
  5326         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  5327
  5328         16  CF-LANGUAGE-TYPE                   PIC X.
  5329             88  CF-LANG-IS-ENG                     VALUE 'E'.
  5330             88  CF-LANG-IS-FR                      VALUE 'F'.
  5331         16  FILLER                             PIC  X(240).
  5332
  5333****************************************************************
  5334*             PROCESSOR/REMINDERS RECORD                       *
  5335****************************************************************
  5336
  5337     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  5338         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  5339             20  CF-START-REMIND-DT         PIC XX.
  5340             20  CF-END-REMIND-DT           PIC XX.
  5341             20  CF-REMINDER-TEXT           PIC X(50).
  5342         16  FILLER                         PIC X(296).
  5343
  5344
  5345****************************************************************
  5346*             STATE MASTER RECORD                              *
  5347****************************************************************
  5348
  5349     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5350         16  CF-STATE-ABBREVIATION          PIC XX.
  5351         16  CF-STATE-NAME                  PIC X(25).
  5352         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  5353         16  CF-ST-CALC-QUOTE-TOLERANCE.
  5354             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  5355             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  5356             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  5357             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  5358                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5359                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5360             20  CF-ST-PREM-REJECT-SW       PIC X.
  5361                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  5362                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  5363             20  CF-ST-REF-REJECT-SW        PIC X.
  5364                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  5365                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  5366         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  5367         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  5368         16  CF-ST-REFUND-RULES.
  5369             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  5370             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  5371             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  5372         16  CF-ST-FST-PMT-EXTENSION.
  5373             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  5374             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  5375                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  5376                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  5377                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  5378                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  5379         16  CF-ST-STATE-CALL.
  5380             20  CF-ST-CALL-UNEARNED        PIC X.
  5381             20  CF-ST-CALL-RPT-CNTL        PIC X.
  5382             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  5383         16  CF-REPLACEMENT-LAW-SW          PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 103
* EL689.cbl
  5384             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  5385             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  5386         16  CF-REPLACEMENT-LETTER          PIC X(4).
  5387         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  5388         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  5389         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  5390         16  CF-ST-SPLIT-PAYMENT            PIC X.
  5391         16  FILLER                         PIC X.
  5392         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  5393             20  CF-ST-BENEFIT-CD           PIC XX.
  5394             20  CF-ST-BENEFIT-KIND         PIC X.
  5395                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  5396                 88  CF-ST-AH-KIND              VALUE 'A'.
  5397             20  CF-ST-REM-TERM-CALC        PIC X.
  5398                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  5399                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  5400                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  5401                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  5402                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  5403                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  5404                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  5405                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  5406
  5407             20  CF-ST-REFUND-CALC          PIC X.
  5408                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  5409                 88  ST-REFD-BY-R78             VALUE '1'.
  5410                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  5411                 88  ST-REFD-AS-CALIF           VALUE '3'.
  5412                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  5413                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  5414                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  5415                 88  ST-REFD-UTAH               VALUE '7'.
  5416                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  5417                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  5418                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  5419
  5420             20  CF-ST-EARNING-CALC         PIC X.
  5421                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  5422                 88  ST-EARN-BY-R78             VALUE '1'.
  5423                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  5424                 88  ST-EARN-AS-CALIF           VALUE '3'.
  5425                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  5426                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  5427                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  5428                 88  ST-EARN-MEAN               VALUE '8'.
  5429                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  5430
  5431             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  5432                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  5433                 88  ST-OVRD-BY-R78             VALUE '1'.
  5434                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  5435                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  5436                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  5437                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  5438                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  5439                 88  ST-OVRD-MEAN               VALUE '8'.
  5440                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  5441             20  FILLER                     PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 104
* EL689.cbl
  5442
  5443         16  CF-ST-COMMISSION-CAPS.
  5444             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  5445             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  5446             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  5447             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  5448         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  5449                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  5450
  5451         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  5452
  5453         16  CF-ST-STATUTORY-INTEREST.
  5454             20  CF-ST-STAT-DATE-FROM       PIC X.
  5455                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  5456                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  5457             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  5458             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  5459             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  5460             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  5461             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  5462
  5463         16  CF-ST-OVER-SHORT.
  5464             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  5465             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  5466
  5467         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  5468
  5469         16  CF-ST-RT-CALC                  PIC X.
  5470
  5471         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5472         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  5473         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5474         16  CF-ST-RF-LR-CALC               PIC X.
  5475         16  CF-ST-RF-LL-CALC               PIC X.
  5476         16  CF-ST-RF-LN-CALC               PIC X.
  5477         16  CF-ST-RF-AH-CALC               PIC X.
  5478         16  CF-ST-RF-CP-CALC               PIC X.
  5479*        16  FILLER                         PIC X(206).
  5480*CIDMOD         16  FILLER                         PIC X(192).
  5481         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  5482             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  5483         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  5484         16  FILLER                         PIC X(187).
  5485
  5486****************************************************************
  5487*             BENEFIT MASTER RECORD                            *
  5488****************************************************************
  5489
  5490     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5491         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  5492             20  CF-BENEFIT-CODE            PIC XX.
  5493             20  CF-BENEFIT-NUMERIC  REDEFINES
  5494                 CF-BENEFIT-CODE            PIC XX.
  5495             20  CF-BENEFIT-ALPHA           PIC XXX.
  5496             20  CF-BENEFIT-DESCRIP         PIC X(10).
  5497             20  CF-BENEFIT-COMMENT         PIC X(10).
  5498
  5499             20  CF-LF-COVERAGE-TYPE        PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 105
* EL689.cbl
  5500                 88  CF-REDUCING                VALUE 'R'.
  5501                 88  CF-LEVEL                   VALUE 'L' 'P'.
  5502
  5503             20  CF-SPECIAL-CALC-CD         PIC X.
  5504                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  5505                 88  CF-NP-0-MO-INT             VALUE 'A'.
  5506                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  5507                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  5508                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  5509                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  5510                 88  CF-FARM-PLAN               VALUE 'F'.
  5511                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  5512                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  5513                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  5514                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  5515                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  5516                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  5517                 88  CF-PRUDENTIAL              VALUE 'P'.
  5518                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  5519                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  5520                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  5521                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  5522                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  5523                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  5524
  5525             20  CF-JOINT-INDICATOR         PIC X.
  5526                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  5527
  5528*            20  FILLER                     PIC X(12).
  5529             20  FILLER                     PIC X(11).
  5530             20  CF-BENEFIT-CATEGORY        PIC X.
  5531             20  CF-LOAN-TYPE               PIC X(8).
  5532
  5533             20  CF-CO-REM-TERM-CALC        PIC X.
  5534                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  5535                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  5536                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  5537                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  5538                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  5539
  5540             20  CF-CO-EARNINGS-CALC        PIC X.
  5541                 88  CO-EARN-BY-R78             VALUE '1'.
  5542                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  5543                 88  CO-EARN-AS-CALIF           VALUE '3'.
  5544                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  5545                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  5546                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  5547                 88  CO-EARN-AS-MEAN            VALUE '8'.
  5548                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  5549
  5550             20  CF-CO-REFUND-CALC          PIC X.
  5551                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  5552                 88  CO-REFD-BY-R78             VALUE '1'.
  5553                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  5554                 88  CO-REFD-AS-CALIF           VALUE '3'.
  5555                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  5556                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  5557                 88  CO-REFD-ANTICIPATION       VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 106
* EL689.cbl
  5558                 88  CO-REFD-MEAN               VALUE '8'.
  5559                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  5560                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  5561                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  5562
  5563             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  5564                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  5565                 88  CO-OVRD-BY-R78             VALUE '1'.
  5566                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  5567                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  5568                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  5569                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  5570                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  5571                 88  CO-OVRD-MEAN               VALUE '8'.
  5572                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  5573
  5574             20  CF-CO-BEN-I-G-CD           PIC X.
  5575                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  5576                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  5577                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  5578
  5579         16  FILLER                         PIC X(304).
  5580
  5581
  5582****************************************************************
  5583*             CARRIER MASTER RECORD                            *
  5584****************************************************************
  5585
  5586     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5587         16  CF-ADDRESS-DATA.
  5588             20  CF-MAIL-TO-NAME            PIC X(30).
  5589             20  CF-IN-CARE-OF              PIC X(30).
  5590             20  CF-ADDRESS-LINE-1          PIC X(30).
  5591             20  CF-ADDRESS-LINE-2          PIC X(30).
  5592             20  CF-CITY-STATE              PIC X(30).
  5593             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  5594             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  5595
  5596         16  CF-CLAIM-NO-CONTROL.
  5597             20  CF-CLAIM-NO-METHOD         PIC X.
  5598                 88  CLAIM-NO-MANUAL            VALUE '1'.
  5599                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  5600                 88  CLAIM-NO-SEQ               VALUE '3'.
  5601                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  5602             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  5603                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  5604                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  5605                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  5606
  5607         16  CF-CHECK-NO-CONTROL.
  5608             20  CF-CHECK-NO-METHOD         PIC X.
  5609                 88  CHECK-NO-MANUAL            VALUE '1'.
  5610                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  5611                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  5612                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  5613             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  5614                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  5615
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 107
* EL689.cbl
  5616         16  CF-DOMICILE-STATE              PIC XX.
  5617
  5618         16  CF-EXPENSE-CONTROLS.
  5619             20  CF-EXPENSE-METHOD          PIC X.
  5620                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  5621                 88  DOLLARS-PER-PMT            VALUE '2'.
  5622                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  5623                 88  DOLLARS-PER-MONTH          VALUE '4'.
  5624             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  5625             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  5626
  5627         16  CF-CORRESPONDENCE-CONTROL.
  5628             20  CF-LETTER-RESEND-OPT       PIC X.
  5629                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  5630                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  5631             20  FILLER                     PIC X(4).
  5632
  5633         16  CF-RESERVE-CONTROLS.
  5634             20  CF-MANUAL-SW               PIC X.
  5635                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  5636             20  CF-FUTURE-SW               PIC X.
  5637                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  5638             20  CF-PTC-SW                  PIC X.
  5639                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  5640             20  CF-IBNR-SW                 PIC X.
  5641                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  5642             20  CF-PTC-LF-SW               PIC X.
  5643                 88  CF-LF-PTC-USED             VALUE '1'.
  5644             20  CF-CDT-ACCESS-METHOD       PIC X.
  5645                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  5646                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  5647                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  5648             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  5649
  5650         16  CF-CLAIM-CALC-METHOD           PIC X.
  5651             88  360-PLUS-MONTHS                VALUE '1'.
  5652             88  365-PLUS-MONTHS                VALUE '2'.
  5653             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  5654             88  360-DAILY                      VALUE '4'.
  5655             88  365-DAILY                      VALUE '5'.
  5656
  5657         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  5658         16  FILLER                         PIC X(11).
  5659
  5660         16  CF-LIMIT-AMOUNTS.
  5661             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  5662             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  5663             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  5664             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  5665             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  5666             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  5667             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  5668             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  5669             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  5670             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  5671
  5672         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  5673         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 108
* EL689.cbl
  5674         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  5675
  5676         16  CF-ZIP-CODE.
  5677             20  CF-ZIP-PRIME.
  5678                 24  CF-ZIP-1ST             PIC X.
  5679                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5680                 24  FILLER                 PIC X(4).
  5681             20  CF-ZIP-PLUS4               PIC X(4).
  5682         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  5683             20  CF-CAN-POSTAL-1            PIC XXX.
  5684             20  CF-CAN-POSTAL-2            PIC XXX.
  5685             20  FILLER                     PIC XXX.
  5686
  5687         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  5688         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  5689         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  5690
  5691         16  CF-RATING-SWITCH               PIC X.
  5692             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  5693             88  CF-NO-RATING                   VALUE 'N'.
  5694
  5695         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  5696
  5697         16  CF-CARRIER-OVER-SHORT.
  5698             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5699             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5700
  5701         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  5702         16  CF-SECPAY-SWITCH               PIC X.
  5703             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  5704             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  5705         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  5706         16  FILLER                         PIC X(448).
  5707*        16  FILLER                         PIC X(452).
  5708
  5709
  5710****************************************************************
  5711*             MORTALITY MASTER RECORD                          *
  5712****************************************************************
  5713
  5714     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5715         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  5716                                INDEXED BY CF-MORT-NDX.
  5717             20  CF-MORT-TABLE              PIC X(5).
  5718             20  CF-MORT-TABLE-TYPE         PIC X.
  5719                 88  CF-MORT-JOINT              VALUE 'J'.
  5720                 88  CF-MORT-SINGLE             VALUE 'S'.
  5721                 88  CF-MORT-COMBINED           VALUE 'C'.
  5722                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  5723                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  5724             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  5725             20  CF-MORT-AGE-METHOD         PIC XX.
  5726                 88  CF-AGE-LAST                VALUE 'AL'.
  5727                 88  CF-AGE-NEAR                VALUE 'AN'.
  5728             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  5729             20  CF-MORT-ADJUSTMENT-DIRECTION
  5730                                            PIC X.
  5731                 88  CF-MINUS                   VALUE '-'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 109
* EL689.cbl
  5732                 88  CF-PLUS                    VALUE '+'.
  5733             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  5734             20  CF-MORT-JOINT-CODE         PIC X.
  5735                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  5736             20  CF-MORT-PC-Q               PIC X.
  5737                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  5738             20  CF-MORT-TABLE-CODE         PIC X(4).
  5739             20  CF-MORT-COMMENTS           PIC X(15).
  5740             20  FILLER                     PIC X(14).
  5741
  5742         16  FILLER                         PIC X(251).
  5743
  5744
  5745****************************************************************
  5746*             BUSSINESS TYPE MASTER RECORD                     *
  5747****************************************************************
  5748
  5749     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5750* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  5751* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  5752* AND RECORD 05 IS TYPES 81-99
  5753         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  5754             20  CF-BUSINESS-TITLE          PIC  X(19).
  5755             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  5756                                            PIC S9V9(4) COMP-3.
  5757             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  5758             20  FILLER                     PIC  X.
  5759         16  FILLER                         PIC  X(248).
  5760
  5761
  5762****************************************************************
  5763*             TERMINAL MASTER RECORD                           *
  5764****************************************************************
  5765
  5766     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5767
  5768         16  CF-COMPANY-TERMINALS.
  5769             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  5770                                  PIC X(4).
  5771         16  FILLER               PIC X(248).
  5772
  5773
  5774****************************************************************
  5775*             LIFE EDIT MASTER RECORD                          *
  5776****************************************************************
  5777
  5778     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5779         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  5780             20  CF-LIFE-CODE-IN            PIC XX.
  5781             20  CF-LIFE-CODE-OUT           PIC XX.
  5782         16  FILLER                         PIC X(248).
  5783
  5784
  5785****************************************************************
  5786*             AH EDIT MASTER RECORD                            *
  5787****************************************************************
  5788
  5789     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 110
* EL689.cbl
  5790         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  5791             20  CF-AH-CODE-IN              PIC XXX.
  5792             20  CF-AH-CODE-OUT             PIC XX.
  5793         16  FILLER                         PIC X(248).
  5794
  5795
  5796****************************************************************
  5797*             CREDIBILITY TABLES                               *
  5798****************************************************************
  5799
  5800     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5801         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  5802                             INDEXED BY CF-CRDB-NDX.
  5803             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  5804             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  5805             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  5806         16  FILLER                         PIC  X(332).
  5807
  5808
  5809****************************************************************
  5810*             REPORT CUSTOMIZATION RECORD                      *
  5811****************************************************************
  5812
  5813     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  5814         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  5815             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  5816             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  5817             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  5818**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  5819****       A T-TRANSFER.                                   ****
  5820             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  5821
  5822         16  FILLER                         PIC XX.
  5823
  5824         16  CF-CARRIER-CNTL-OPT.
  5825             20  CF-CARRIER-OPT-SEQ         PIC 9.
  5826                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  5827                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  5828             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  5829                                            PIC X.
  5830         16  CF-GROUP-CNTL-OPT.
  5831             20  CF-GROUP-OPT-SEQ           PIC 9.
  5832                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  5833                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  5834             20  CF-GROUP-SELECT OCCURS 3 TIMES
  5835                                            PIC X(6).
  5836         16  CF-STATE-CNTL-OPT.
  5837             20  CF-STATE-OPT-SEQ           PIC 9.
  5838                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  5839                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  5840             20  CF-STATE-SELECT OCCURS 3 TIMES
  5841                                            PIC XX.
  5842         16  CF-ACCOUNT-CNTL-OPT.
  5843             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  5844                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  5845                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  5846             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  5847                                            PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 111
* EL689.cbl
  5848         16  CF-BUS-TYP-CNTL-OPT.
  5849             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  5850                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  5851                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  5852             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  5853                                            PIC XX.
  5854         16  CF-LF-TYP-CNTL-OPT.
  5855             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  5856                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  5857                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  5858             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  5859                                            PIC XX.
  5860         16  CF-AH-TYP-CNTL-OPT.
  5861             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  5862                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  5863                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  5864             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  5865                                            PIC XX.
  5866         16  CF-REPTCD1-CNTL-OPT.
  5867             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  5868                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  5869                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  5870             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  5871                                            PIC X(10).
  5872         16  CF-REPTCD2-CNTL-OPT.
  5873             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  5874                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  5875                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  5876             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  5877                                            PIC X(10).
  5878         16  CF-USER1-CNTL-OPT.
  5879             20  CF-USER1-OPT-SEQ           PIC 9.
  5880                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  5881                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  5882             20  CF-USER1-SELECT OCCURS 3 TIMES
  5883                                            PIC X(10).
  5884         16  CF-USER2-CNTL-OPT.
  5885             20  CF-USER2-OPT-SEQ           PIC 9.
  5886                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  5887                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  5888             20  CF-USER2-SELECT OCCURS 3 TIMES
  5889                                            PIC X(10).
  5890         16  CF-USER3-CNTL-OPT.
  5891             20  CF-USER3-OPT-SEQ           PIC 9.
  5892                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  5893                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  5894             20  CF-USER3-SELECT OCCURS 3 TIMES
  5895                                            PIC X(10).
  5896         16  CF-USER4-CNTL-OPT.
  5897             20  CF-USER4-OPT-SEQ           PIC 9.
  5898                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  5899                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  5900             20  CF-USER4-SELECT OCCURS 3 TIMES
  5901                                            PIC X(10).
  5902         16  CF-USER5-CNTL-OPT.
  5903             20  CF-USER5-OPT-SEQ           PIC 9.
  5904                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  5905                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 112
* EL689.cbl
  5906             20  CF-USER5-SELECT OCCURS 3 TIMES
  5907                                            PIC X(10).
  5908         16  CF-REINS-CNTL-OPT.
  5909             20  CF-REINS-OPT-SEQ           PIC 9.
  5910                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  5911                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  5912             20  CF-REINS-SELECT OCCURS 3 TIMES.
  5913                 24  CF-REINS-PRIME         PIC XXX.
  5914                 24  CF-REINS-SUB           PIC XXX.
  5915
  5916         16  CF-AGENT-CNTL-OPT.
  5917             20  CF-AGENT-OPT-SEQ           PIC 9.
  5918                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  5919                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  5920             20  CF-AGENT-SELECT OCCURS 3 TIMES
  5921                                            PIC X(10).
  5922
  5923         16  FILLER                         PIC X(43).
  5924
  5925         16  CF-LOSS-RATIO-SELECT.
  5926             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  5927             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  5928         16  CF-ENTRY-DATE-SELECT.
  5929             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  5930             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  5931         16  CF-EFFECTIVE-DATE-SELECT.
  5932             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  5933             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  5934
  5935         16  CF-EXCEPTION-LIST-IND          PIC X.
  5936             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  5937
  5938         16  FILLER                         PIC X(318).
  5939
  5940****************************************************************
  5941*                  EXCEPTION REPORTING RECORD                  *
  5942****************************************************************
  5943
  5944     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  5945         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  5946             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  5947
  5948         16  CF-COMBINED-LIFE-AH-OPT.
  5949             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  5950             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  5951             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  5952             20  CF-CANCELLATION-RATIO      PIC S9(02).
  5953
  5954         16  CF-LIFE-OPT.
  5955             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5956             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5957             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5958             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5959             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5960             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5961             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5962             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5963             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 113
* EL689.cbl
  5964             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  5965
  5966         16  CF-AH-OPT.
  5967             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5968             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5969             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5970             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5971             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5972             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5973             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5974             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5975             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5976             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  5977
  5978         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  5979             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  5980             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  5981             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  5982
  5983         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  5984
  5985         16  FILLER                         PIC X(673).
  5986
  5987
  5988****************************************************************
  5989*             MORTGAGE SYSTEM PLAN RECORD                      *
  5990****************************************************************
  5991
  5992     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  5993         16  CF-PLAN-TYPE                   PIC X.
  5994             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  5995             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  5996             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  5997         16  CF-PLAN-ABBREV                 PIC XXX.
  5998         16  CF-PLAN-DESCRIPT               PIC X(10).
  5999         16  CF-PLAN-NOTES                  PIC X(20).
  6000         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  6001         16  CF-PLAN-UNDERWRITING.
  6002             20  CF-PLAN-TERM-DATA.
  6003                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  6004                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  6005             20  CF-PLAN-AGE-DATA.
  6006                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  6007                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  6008                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  6009             20  CF-PLAN-BENEFIT-DATA.
  6010                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6011                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6012                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  6013                                            PIC S9(7)V99  COMP-3.
  6014         16  CF-PLAN-POLICY-FORMS.
  6015             20  CF-POLICY-FORM             PIC X(12).
  6016             20  CF-MASTER-APPLICATION      PIC X(12).
  6017             20  CF-MASTER-POLICY           PIC X(12).
  6018         16  CF-PLAN-RATING.
  6019             20  CF-RATE-CODE               PIC X(5).
  6020             20  CF-SEX-RATING              PIC X.
  6021                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 114
* EL689.cbl
  6022                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  6023             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  6024             20  CF-SUB-STD-TYPE            PIC X.
  6025                 88  CF-PCT-OF-PREM            VALUE '1'.
  6026                 88  CF-PCT-OF-BENE            VALUE '2'.
  6027         16  CF-PLAN-PREM-TOLERANCES.
  6028             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  6029             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  6030         16  CF-PLAN-PYMT-TOLERANCES.
  6031             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  6032             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  6033         16  CF-PLAN-MISC-DATA.
  6034             20  FILLER                     PIC X.
  6035             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  6036             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  6037         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  6038         16  CF-PLAN-IND-GRP                PIC X.
  6039             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  6040                                                     '1'.
  6041             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  6042                                                     '2'.
  6043         16  CF-MIB-SEARCH-SW               PIC X.
  6044             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  6045             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  6046             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  6047             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  6048         16  CF-ALPHA-SEARCH-SW             PIC X.
  6049             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  6050             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  6051             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  6052             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  6053             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  6054             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  6055             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  6056             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  6057             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  6058             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  6059                                                     'A' 'B' 'C'
  6060                                                     'X' 'Y' 'Z'.
  6061         16  CF-EFF-DT-RULE-SW              PIC X.
  6062             88  CF-EFF-DT-ENTER               VALUE 'E'.
  6063             88  CF-EFF-DT-MONTH               VALUE 'M'.
  6064             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  6065             88  CF-EFF-DT-SEMI                VALUE 'S'.
  6066             88  CF-EFF-DT-ANN                 VALUE 'A'.
  6067         16  FILLER                         PIC X(4).
  6068         16  CF-HEALTH-QUESTIONS            PIC X.
  6069             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  6070         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  6071         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  6072         16  CF-PLAN-SNGL-JNT               PIC X.
  6073             88  CF-COMBINED-PLAN              VALUE 'C'.
  6074             88  CF-JNT-PLAN                   VALUE 'J'.
  6075             88  CF-SNGL-PLAN                  VALUE 'S'.
  6076         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  6077         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  6078         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  6079         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 115
* EL689.cbl
  6080         16  CF-RERATE-CNTL                 PIC  X.
  6081             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  6082             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  6083             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  6084             88  CF-AUTO-RECALC                 VALUE '4'.
  6085         16  CF-BENEFIT-TYPE                PIC  X.
  6086             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  6087             88  CF-BENEFIT-REDUCES             VALUE '2'.
  6088         16  CF-POLICY-FEE                  PIC S999V99
  6089                                                    COMP-3.
  6090         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  6091         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  6092         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  6093         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  6094         16  FILLER                         PIC  X(32).
  6095         16  CF-TERMINATION-FORM            PIC  X(04).
  6096         16  FILLER                         PIC  X(08).
  6097         16  CF-CLAIM-CAP                   PIC S9(7)V99
  6098                                                       COMP-3.
  6099         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  6100         16  CF-ISSUE-LETTER                PIC  X(4).
  6101         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  6102         16  CF-DEPENDENT-COVERAGE          PIC  X.
  6103             88  CF-YES-DEP-COV                 VALUE 'Y'.
  6104             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  6105         16  CF-MP-REFUND-CALC              PIC X.
  6106             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  6107             88  CF-MP-REFD-BY-R78              VALUE '1'.
  6108             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  6109             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  6110             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  6111             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  6112             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  6113             88  CF-MP-REFD-MEAN                VALUE '8'.
  6114         16  CF-ALT-RATE-CODE               PIC  X(5).
  6115
  6116
  6117         16  FILLER                         PIC X(498).
  6118****************************************************************
  6119*             MORTGAGE COMPANY MASTER RECORD                   *
  6120****************************************************************
  6121
  6122     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6123         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  6124         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  6125             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  6126             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  6127             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  6128             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  6129             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  6130
  6131         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  6132         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  6133         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  6134         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  6135         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  6136
  6137         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 116
* EL689.cbl
  6138             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  6139         16  CF-MP-RECON-USE-IND            PIC X(1).
  6140             88  CF-MP-USE-RECON             VALUE 'Y'.
  6141         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  6142             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  6143         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  6144             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  6145             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  6146         16  FILLER                         PIC X(1).
  6147         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  6148             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  6149         16  CF-MORTG-MIB-VERSION           PIC X.
  6150             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  6151             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  6152             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  6153         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  6154             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  6155                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  6156             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  6157                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  6158             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  6159                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  6160             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  6161                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  6162             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  6163                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  6164             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  6165                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  6166         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  6167         16  FILLER                         PIC X(7).
  6168         16  CF-MORTG-DESTINATION-SYMBOL.
  6169             20  CF-MORTG-MIB-COMM          PIC X(5).
  6170             20  CF-MORTG-MIB-TERM          PIC X(5).
  6171         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  6172             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  6173         16  FILLER                         PIC X(03).
  6174         16  CF-MP-CHECK-NO-CONTROL.
  6175             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  6176                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  6177                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  6178                                                ' ' LOW-VALUES.
  6179                 88  CF-MP-CHECK-NO-PRE-PRINTED
  6180                                               VALUE '3'.
  6181         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  6182         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  6183         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  6184             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  6185                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  6186             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  6187                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  6188             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  6189                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  6190             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  6191                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  6192             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  6193                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  6194             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  6195                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 117
* EL689.cbl
  6196         16  CF-MORTG-BILLING-AREA.
  6197             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  6198                                            PIC X.
  6199         16  CF-MORTG-MONTH-END-DT          PIC XX.
  6200         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  6201         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  6202         16  CF-MORTG-MIB-DEST-SW           PIC X.
  6203             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  6204             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  6205         16  FILLER                         PIC X.
  6206         16  CF-MORTG-LABEL-CONTROL         PIC X.
  6207             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  6208             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  6209         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  6210         16  FILLER                         PIC X(8).
  6211         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  6212         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  6213         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  6214         16  CF-ACH-COMPANY-ID.
  6215             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  6216                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  6217                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  6218                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  6219             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  6220         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  6221             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  6222         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  6223             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  6224             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  6225         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  6226         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  6227         16  FILLER                         PIC X(536).
  6228
  6229****************************************************************
  6230*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  6231****************************************************************
  6232
  6233     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  6234         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  6235             20  CF-FEMALE-HEIGHT.
  6236                 24  CF-FEMALE-FT           PIC 99.
  6237                 24  CF-FEMALE-IN           PIC 99.
  6238             20  CF-FEMALE-MIN-WT           PIC 999.
  6239             20  CF-FEMALE-MAX-WT           PIC 999.
  6240         16  FILLER                         PIC X(428).
  6241
  6242     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  6243         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  6244             20  CF-MALE-HEIGHT.
  6245                 24  CF-MALE-FT             PIC 99.
  6246                 24  CF-MALE-IN             PIC 99.
  6247             20  CF-MALE-MIN-WT             PIC 999.
  6248             20  CF-MALE-MAX-WT             PIC 999.
  6249         16  FILLER                         PIC X(428).
  6250******************************************************************
  6251*             AUTOMATIC ACTIVITY RECORD                          *
  6252******************************************************************
  6253     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 118
* EL689.cbl
  6254         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  6255             20  CF-SYS-ACTIVE-SW           PIC X(01).
  6256             20  CF-SYS-LETTER-ID           PIC X(04).
  6257             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  6258             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  6259             20  CF-SYS-RESET-SW            PIC X(01).
  6260             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  6261             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  6262
  6263         16  FILLER                         PIC X(50).
  6264
  6265         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  6266             20  CF-USER-ACTIVE-SW          PIC X(01).
  6267             20  CF-USER-LETTER-ID          PIC X(04).
  6268             20  CF-USER-RESEND-DAYS        PIC 9(03).
  6269             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  6270             20  CF-USER-RESET-SW           PIC X(01).
  6271             20  CF-USER-REPORT-DAYS        PIC 9(03).
  6272             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  6273             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  6274
  6275         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 119
* EL689.cbl
  6277*    COPY ERCCOMP.
  6278******************************************************************
  6279*                                                                *
  6280*                                                                *
  6281*                            ERCCOMP                             *
  6282*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6283*                            VMOD=2.019                          *
  6284*                                                                *
  6285*   ONLINE CREDIT SYSTEM                                         *
  6286*                                                                *
  6287*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  6288*                                                                *
  6289*   FILE TYPE = VSAM,KSDS                                        *
  6290*   RECORD SIZE = 700   RECFORM = FIXED                          *
  6291*                                                                *
  6292*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  6293*       ALTERNATE PATH = NONE                                    *
  6294*                                                                *
  6295*   LOG = NO                                                     *
  6296*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6297*                                                                *
  6298******************************************************************
  6299*                   C H A N G E   L O G
  6300*
  6301* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6302*-----------------------------------------------------------------
  6303*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6304* EFFECTIVE    NUMBER
  6305*-----------------------------------------------------------------
  6306* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  6307* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  6308* 092205    2005050300006  PEMA  ADD LEASE FEE
  6309* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  6310* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  6311* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  6312* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6313* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  6314******************************************************************
  6315
  6316 01  COMPENSATION-MASTER.
  6317     12  CO-RECORD-ID                          PIC XX.
  6318         88  VALID-CO-ID                          VALUE 'CO'.
  6319
  6320     12  CO-CONTROL-PRIMARY.
  6321         16  CO-COMPANY-CD                     PIC X.
  6322         16  CO-CONTROL.
  6323             20  CO-CTL-1.
  6324                 24  CO-CARR-GROUP.
  6325                     28  CO-CARRIER            PIC X.
  6326                     28  CO-GROUPING.
  6327                         32  CO-GROUP-PREFIX   PIC XXX.
  6328                         32  CO-GROUP-PRIME    PIC XXX.
  6329                 24  CO-RESP-NO.
  6330                     28  CO-RESP-PREFIX        PIC X(4).
  6331                     28  CO-RESP-PRIME         PIC X(6).
  6332             20  CO-CTL-2.
  6333                 24  CO-ACCOUNT.
  6334                     28  CO-ACCT-PREFIX        PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 120
* EL689.cbl
  6335                     28  CO-ACCT-PRIME         PIC X(6).
  6336         16  CO-TYPE                           PIC X.
  6337             88  CO-COMPANY-TYPE                  VALUE 'C'.
  6338             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  6339             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  6340
  6341     12  CO-MAINT-INFORMATION.
  6342         16  CO-LAST-MAINT-DT                  PIC XX.
  6343         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  6344         16  CO-LAST-MAINT-USER                PIC X(4).
  6345     12  FILLER                                PIC XX.
  6346     12  CO-STMT-TYPE                          PIC XXX.
  6347     12  CO-COMP-TYPE                          PIC X.
  6348         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  6349     12  CO-STMT-OWNER                         PIC X(4).
  6350     12  CO-BALANCE-CONTROL                    PIC X.
  6351         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  6352         88  CO-NO-BALANCE                        VALUE 'N'.
  6353
  6354     12  CO-INTERNAL-CONTROL-1                 PIC X.
  6355         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  6356         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  6357         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  6358
  6359     12  CO-INTERNAL-CONTROL-2                 PIC X.
  6360         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  6361         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  6362
  6363     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  6364     12  CO-GA-DIRECT-DEP                      PIC X.
  6365     12  CO-FUTURE-SPACE                       PIC X.
  6366         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  6367
  6368     12  CO-ACCT-NAME                          PIC X(30).
  6369     12  CO-MAIL-NAME                          PIC X(30).
  6370     12  CO-ADDR-1                             PIC X(30).
  6371     12  CO-ADDR-2                             PIC X(30).
  6372     12  CO-ADDR-3.
  6373         16  CO-ADDR-CITY                      PIC X(27).
  6374         16  CO-ADDR-STATE                     PIC XX.
  6375     12  CO-CSO-1099                           PIC X.
  6376     12  CO-ZIP.
  6377         16  CO-ZIP-PRIME.
  6378             20  CO-ZIP-PRI-1ST                PIC X.
  6379                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  6380             20  FILLER                        PIC X(4).
  6381         16  CO-ZIP-PLUS4                      PIC X(4).
  6382     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  6383         16  CO-CAN-POSTAL-1                   PIC XXX.
  6384         16  CO-CAN-POSTAL-2                   PIC XXX.
  6385         16  FILLER                            PIC XXX.
  6386     12  CO-SOC-SEC                            PIC X(13).
  6387     12  CO-TELEPHONE.
  6388         16  CO-AREA-CODE                      PIC XXX.
  6389         16  CO-PREFIX                         PIC XXX.
  6390         16  CO-PHONE                          PIC X(4).
  6391
  6392     12  CO-ROLADEX-PRINT-DT                   PIC XX.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 121
* EL689.cbl
  6393
  6394     12  CO-AR-BAL-LEVEL                       PIC X.
  6395         88  CO-AR-REF-LVL                        VALUE '1'.
  6396         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  6397         88  CO-AR-BILL-LVL                       VALUE '2'.
  6398         88  CO-AR-AGT-LVL                        VALUE '3'.
  6399         88  CO-AR-FR-LVL                         VALUE '4'.
  6400
  6401     12  CO-AR-NORMAL-PRINT                    PIC X.
  6402         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  6403         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  6404
  6405     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  6406
  6407     12  CO-AR-REPORTING                       PIC X.
  6408         88  CO-AR-NET-REPORT                     VALUE 'N'.
  6409         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  6410
  6411     12  CO-AR-PULL-CHECK                      PIC X.
  6412         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  6413         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  6414
  6415     12  CO-AR-BALANCE-PRINT                   PIC X.
  6416         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  6417
  6418     12  CO-AR-LAST-RUN-CODE                   PIC X.
  6419         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  6420         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  6421         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  6422
  6423     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  6424
  6425     12  CO-USER-CODE                          PIC X.
  6426     12  CO-REPORT-GROUP-ID                    PIC X(12).
  6427
  6428******************************************************************
  6429*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  6430*    THE LAST MONTH END RUN.
  6431******************************************************************
  6432
  6433     12  CO-LAST-ACTIVITY-DATE.
  6434         16  CO-ACT-YEAR                       PIC 99.
  6435         16  CO-ACT-MONTH                      PIC 99.
  6436         16  CO-ACT-DAY                        PIC 99.
  6437
  6438     12  CO-LAST-STMT-DT.
  6439         16  CO-LAST-STMT-YEAR                 PIC 99.
  6440         16  CO-LAST-STMT-MONTH                PIC 99.
  6441         16  CO-LAST-STMT-DAY                  PIC 99.
  6442
  6443     12  CO-MO-END-TOTALS.
  6444         16  CO-MONTHLY-TOTALS.
  6445             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  6446             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  6447             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  6448             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  6449             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  6450
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 122
* EL689.cbl
  6451         16  CO-AGING-TOTALS.
  6452             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  6453             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  6454             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  6455             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  6456
  6457         16  CO-YTD-TOTALS.
  6458             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  6459             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  6460
  6461         16  CO-OVER-UNDER-TOTALS.
  6462             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  6463             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  6464
  6465     12  CO-MISCELLANEOUS-TOTALS.
  6466         16  CO-FICA-TOTALS.
  6467             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  6468             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  6469
  6470         16  CO-CLAIM-TOTALS.
  6471             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  6472             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  6473
  6474******************************************************************
  6475*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  6476*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  6477******************************************************************
  6478
  6479     12  CO-CURRENT-TOTALS.
  6480         16  CO-CURRENT-LAST-STMT-DT.
  6481             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  6482             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  6483             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  6484
  6485         16  CO-CURRENT-MONTHLY-TOTALS.
  6486             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  6487             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  6488             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  6489             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  6490             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  6491
  6492         16  CO-CURRENT-AGING-TOTALS.
  6493             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  6494             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  6495             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  6496             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  6497
  6498         16  CO-CURRENT-YTD-TOTALS.
  6499             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  6500             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  6501
  6502     12  CO-PAID-COMM-TOTALS.
  6503         16  CO-YTD-PAID-COMMS.
  6504             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  6505             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  6506
  6507     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  6508         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 123
* EL689.cbl
  6509         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  6510
  6511     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  6512         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  6513         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  6514         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  6515         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  6516         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  6517         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  6518         88  CO-FINAL-LETTER                  VALUE 'F'.
  6519         88  CO-RECONCILING                   VALUE 'R'.
  6520         88  CO-PHONE-CALL                    VALUE 'P'.
  6521         88  CO-LEGAL                         VALUE 'L'.
  6522         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  6523         88  CO-WRITE-OFF                     VALUE 'W'.
  6524         88  CO-NO-ACTION                     VALUE 'N' ' '.
  6525
  6526     12  CO-CSR-CODE                       PIC X(4).
  6527
  6528     12  CO-GA-STATUS-INFO.
  6529         16  CO-GA-EFFECTIVE-DT            PIC XX.
  6530         16  CO-GA-TERMINATION-DT          PIC XX.
  6531         16  CO-GA-STATUS-CODE             PIC X.
  6532             88  CO-GA-ACTIVE                 VALUE 'A'.
  6533             88  CO-GA-INACTIVE               VALUE 'I'.
  6534             88  CO-GA-PENDING                VALUE 'P'.
  6535         16  CO-GA-COMMENTS.
  6536             20  CO-GA-COMMENT-1           PIC X(40).
  6537             20  CO-GA-COMMENT-2           PIC X(40).
  6538             20  CO-GA-COMMENT-3           PIC X(40).
  6539             20  CO-GA-COMMENT-4           PIC X(40).
  6540
  6541     12  CO-RPTCD2                         PIC X(10).
  6542
  6543     12  CO-TYPE-AGENT                     PIC X(01).
  6544         88  CO-CORPORATION                   VALUE 'C'.
  6545         88  CO-PARTNERSHIP                   VALUE 'P'.
  6546         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  6547         88  CO-TRUST                         VALUE 'T'.
  6548         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  6549
  6550     12  CO-FAXNO.
  6551         16  CO-FAX-AREA-CODE                  PIC XXX.
  6552         16  CO-FAX-PREFIX                     PIC XXX.
  6553         16  CO-FAX-PHONE                      PIC X(4).
  6554
  6555     12  CO-BANK-INFORMATION.
  6556         16  CO-BANK-TRANSIT-NO                PIC X(8).
  6557         16  CO-BANK-TRANSIT-NON REDEFINES
  6558             CO-BANK-TRANSIT-NO                PIC 9(8).
  6559
  6560         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  6561     12  CO-MISC-DEDUCT-INFO REDEFINES
  6562                  CO-BANK-INFORMATION.
  6563         16  CO-MD-GL-ACCT                     PIC X(10).
  6564         16  CO-MD-DIV                         PIC XX.
  6565         16  CO-MD-CENTER                      PIC X(4).
  6566         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 124
* EL689.cbl
  6567         16  CO-CREATE-AP-CHECK                PIC X.
  6568         16  CO-DELIVER-CK-TO-MEL              PIC X.
  6569         16  FILLER                            PIC XXX.
  6570     12  CO-ACH-STATUS                         PIC X.
  6571         88  CO-ACH-ACTIVE                         VALUE 'A'.
  6572         88  CO-ACH-PENDING                        VALUE 'P'.
  6573
  6574     12  CO-BILL-SW                            PIC X.
  6575     12  CO-CONTROL-NAME                       PIC X(30).
  6576     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  6577     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  6578     12  CO-CLP-STATE                          PIC XX.
  6579     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  6580     12  CO-SPP-REFUND-EDIT                    PIC X.
  6581
  6582******************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 125
* EL689.cbl
  6584*    COPY ERCMAIL.
  6585******************************************************************
  6586*                                                                *
  6587*                                                                *
  6588*                            ERCMAIL                             *
  6589*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6590*                            VMOD=2.003                          *
  6591*                                                                *
  6592*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  6593*                                                                *
  6594*   FILE TYPE = VSAM,KSDS                                        *
  6595*   RECORD SIZE = 374   RECFORM = FIX                            *
  6596*                                                                *
  6597*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  6598*   ALTERNATE PATH    = NOT USED                                 *
  6599*                                                                *
  6600*   LOG = YES                                                    *
  6601*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6602******************************************************************
  6603*                   C H A N G E   L O G
  6604*
  6605* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6606*-----------------------------------------------------------------
  6607*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6608* EFFECTIVE    NUMBER
  6609*-----------------------------------------------------------------
  6610* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  6611* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  6612* 111108                   PEMA  ADD CRED BENE ADDR2
  6613******************************************************************
  6614
  6615 01  MAILING-DATA.
  6616     12  MA-RECORD-ID                      PIC XX.
  6617         88  VALID-MA-ID                       VALUE 'MA'.
  6618
  6619     12  MA-CONTROL-PRIMARY.
  6620         16  MA-COMPANY-CD                 PIC X.
  6621         16  MA-CARRIER                    PIC X.
  6622         16  MA-GROUPING.
  6623             20  MA-GROUPING-PREFIX        PIC XXX.
  6624             20  MA-GROUPING-PRIME         PIC XXX.
  6625         16  MA-STATE                      PIC XX.
  6626         16  MA-ACCOUNT.
  6627             20  MA-ACCOUNT-PREFIX         PIC X(4).
  6628             20  MA-ACCOUNT-PRIME          PIC X(6).
  6629         16  MA-CERT-EFF-DT                PIC XX.
  6630         16  MA-CERT-NO.
  6631             20  MA-CERT-PRIME             PIC X(10).
  6632             20  MA-CERT-SFX               PIC X.
  6633
  6634     12  FILLER                            PIC XX.
  6635
  6636     12  MA-ACCESS-CONTROL.
  6637         16  MA-SOURCE-SYSTEM              PIC XX.
  6638             88  MA-FROM-CREDIT                VALUE 'CR'.
  6639             88  MA-FROM-VSI                   VALUE 'VS'.
  6640             88  MA-FROM-WARRANTY              VALUE 'WA'.
  6641             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 126
* EL689.cbl
  6642         16  MA-RECORD-ADD-DT              PIC XX.
  6643         16  MA-RECORD-ADDED-BY            PIC XXXX.
  6644         16  MA-LAST-MAINT-DT              PIC XX.
  6645         16  MA-LAST-MAINT-BY              PIC XXXX.
  6646         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  6647
  6648     12  MA-PROFILE-INFO.
  6649         16  MA-QUALIFY-CODE-1             PIC XX.
  6650         16  MA-QUALIFY-CODE-2             PIC XX.
  6651         16  MA-QUALIFY-CODE-3             PIC XX.
  6652         16  MA-QUALIFY-CODE-4             PIC XX.
  6653         16  MA-QUALIFY-CODE-5             PIC XX.
  6654
  6655         16  MA-INSURED-LAST-NAME          PIC X(15).
  6656         16  MA-INSURED-FIRST-NAME         PIC X(10).
  6657         16  MA-INSURED-MIDDLE-INIT        PIC X.
  6658         16  MA-INSURED-ISSUE-AGE          PIC 99.
  6659         16  MA-INSURED-BIRTH-DT           PIC XX.
  6660         16  MA-INSURED-SEX                PIC X.
  6661             88  MA-SEX-MALE                   VALUE 'M'.
  6662             88  MA-SEX-FEMALE                 VALUE 'F'.
  6663         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  6664
  6665         16  MA-ADDRESS-CORRECTED          PIC X.
  6666         16  MA-JOINT-BIRTH-DT             PIC XX.
  6667*        16  FILLER                        PIC X(12).
  6668
  6669         16  MA-ADDRESS-LINE-1             PIC X(30).
  6670         16  MA-ADDRESS-LINE-2             PIC X(30).
  6671         16  MA-CITY-STATE.
  6672             20  MA-CITY                   PIC X(28).
  6673             20  MA-ADDR-STATE             PIC XX.
  6674         16  MA-ZIP.
  6675             20  MA-ZIP-CODE.
  6676                 24  MA-ZIP-CODE-1ST       PIC X(1).
  6677                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6678                 24  FILLER                PIC X(4).
  6679             20  MA-ZIP-PLUS4              PIC X(4).
  6680         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  6681             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  6682             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  6683             20  FILLER                    PIC X(3).
  6684
  6685         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  6686
  6687         16  FILLER                        PIC XXX.
  6688*        16  FILLER                        PIC X(10).
  6689
  6690     12  MA-CRED-BENE-INFO.
  6691         16  MA-CRED-BENE-NAME                 PIC X(25).
  6692         16  MA-CRED-BENE-ADDR                 PIC X(30).
  6693         16  MA-CRED-BENE-ADDR2                PIC X(30).
  6694         16  MA-CRED-BENE-CTYST.
  6695             20  MA-CRED-BENE-CITY             PIC X(28).
  6696             20  MA-CRED-BENE-STATE            PIC XX.
  6697         16  MA-CRED-BENE-ZIP.
  6698             20  MA-CB-ZIP-CODE.
  6699                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 127
* EL689.cbl
  6700                     88  MA-CB-CANADIAN-POST-CODE
  6701                                           VALUE 'A' THRU 'Z'.
  6702                 24  FILLER                    PIC X(4).
  6703             20  MA-CB-ZIP-PLUS4               PIC X(4).
  6704         16  MA-CB-CANADIAN-POSTAL-CODE
  6705                            REDEFINES MA-CRED-BENE-ZIP.
  6706             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  6707             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  6708             20  FILLER                        PIC X(3).
  6709     12  MA-POST-CARD-MAIL-DATA.
  6710         16  MA-MAIL-DATA OCCURS 7.
  6711             20  MA-MAIL-TYPE              PIC X.
  6712                 88  MA-12MO-MAILING           VALUE '1'.
  6713                 88  MA-EXP-MAILING            VALUE '2'.
  6714             20  MA-MAIL-STATUS            PIC X.
  6715                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  6716                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  6717                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  6718             20  MA-MAIL-DATE              PIC XX.
  6719     12  FILLER                            PIC XX.
  6720     12  FILLER                            PIC XX.
  6721*    12  FILLER                            PIC X(30).
  6722******************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 128
* EL689.cbl
  6724*    COPY ERCPNDB.
  6725******************************************************************
  6726*                                                                *
  6727*                                                                *
  6728*                            ERCPNDB.                            *
  6729*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6730*                            VMOD=2.025                          *
  6731*                                                                *
  6732*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  6733*                                                                *
  6734******************************************************************
  6735*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  6736*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  6737******************************************************************
  6738*                                                                *
  6739*                                                                *
  6740*   FILE TYPE = VSAM,KSDS                                        *
  6741*   RECORD SIZE = 585  RECFORM = FIXED                           *
  6742*                                                                *
  6743*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  6744*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  6745*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  6746*                                                 RKP=13,LEN=36  *
  6747*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  6748*                                      AND CHG-SEQ.)             *
  6749*                                                RKP=49,LEN=11   *
  6750*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  6751*                                      AND CHG-SEQ.)             *
  6752*                                                RKP=60,LEN=15   *
  6753*                                                                *
  6754*   LOG = NO                                                     *
  6755*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6756******************************************************************
  6757******************************************************************
  6758*                   C H A N G E   L O G
  6759*
  6760* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6761*-----------------------------------------------------------------
  6762*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6763* EFFECTIVE    NUMBER
  6764*-----------------------------------------------------------------
  6765* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  6766* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  6767* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  6768* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  6769* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  6770* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  6771* 032306                   PEMA  ADD BOW LOAN NUMBER
  6772* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  6773* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  6774* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  6775* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  6776* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  6777* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  6778* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6779******************************************************************
  6780
  6781 01  PENDING-BUSINESS.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 129
* EL689.cbl
  6782     12  PB-RECORD-ID                     PIC XX.
  6783         88  VALID-PB-ID                        VALUE 'PB'.
  6784
  6785     12  PB-CONTROL-PRIMARY.
  6786         16  PB-COMPANY-CD                PIC X.
  6787         16  PB-ENTRY-BATCH               PIC X(6).
  6788         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  6789         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  6790
  6791     12  PB-CONTROL-BY-ACCOUNT.
  6792         16  PB-COMPANY-CD-A1             PIC X.
  6793         16  PB-CARRIER                   PIC X.
  6794         16  PB-GROUPING.
  6795             20  PB-GROUPING-PREFIX       PIC XXX.
  6796             20  PB-GROUPING-PRIME        PIC XXX.
  6797         16  PB-STATE                     PIC XX.
  6798         16  PB-ACCOUNT.
  6799             20  PB-ACCOUNT-PREFIX        PIC X(4).
  6800             20  PB-ACCOUNT-PRIME         PIC X(6).
  6801         16  PB-CERT-EFF-DT               PIC XX.
  6802         16  PB-CERT-NO.
  6803             20  PB-CERT-PRIME            PIC X(10).
  6804             20  PB-CERT-SFX              PIC X.
  6805         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  6806
  6807         16  PB-RECORD-TYPE               PIC X.
  6808             88  PB-MAILING-DATA                VALUE '0'.
  6809             88  PB-ISSUE                       VALUE '1'.
  6810             88  PB-CANCELLATION                VALUE '2'.
  6811             88  PB-BATCH-TRAILER               VALUE '9'.
  6812
  6813     12  PB-CONTROL-BY-ORIG-BATCH.
  6814         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  6815         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  6816         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  6817         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  6818
  6819     12  PB-CONTROL-BY-CSR.
  6820         16  PB-CSR-COMPANY-CD            PIC X.
  6821         16  PB-CSR-ID                    PIC X(4).
  6822         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  6823         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  6824         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  6825******************************************************************
  6826*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  6827******************************************************************
  6828
  6829     12  PB-LAST-MAINT-DT                 PIC XX.
  6830     12  PB-LAST-MAINT-BY                 PIC X(4).
  6831     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  6832
  6833     12  PB-RECORD-BODY                   PIC X(375).
  6834
  6835     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  6836         16  PB-CERT-ORIGIN               PIC X.
  6837             88  CLASIC-CREATED-CERT         VALUE '1'.
  6838         16  PB-I-NAME.
  6839             20  PB-I-INSURED-LAST-NAME   PIC X(15).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 130
* EL689.cbl
  6840             20  PB-I-INSURED-FIRST-NAME.
  6841                 24  PB-I-INSURED-1ST-INIT PIC X.
  6842                 24  FILLER                PIC X(9).
  6843             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  6844         16  PB-I-AGE                     PIC S99   COMP-3.
  6845         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  6846         16  PB-I-BIRTHDAY                PIC XX.
  6847         16  PB-I-INSURED-SEX             PIC X.
  6848             88  PB-SEX-MALE     VALUE 'M'.
  6849             88  PB-SEX-FEMALE   VALUE 'F'.
  6850
  6851         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  6852         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  6853         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  6854         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  6855         16  PB-I-SKIP-CODE               PIC X.
  6856             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  6857             88  PB-SKIP-JULY              VALUE '1'.
  6858             88  PB-SKIP-AUGUST            VALUE '2'.
  6859             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  6860             88  PB-SKIP-JULY-AUG          VALUE '4'.
  6861             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  6862             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  6863             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  6864             88  PB-SKIP-JUNE              VALUE '8'.
  6865             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  6866             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  6867             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  6868         16  PB-I-TERM-TYPE               PIC X.
  6869             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  6870             88  PB-PAID-WEEKLY            VALUE 'W'.
  6871             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  6872             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  6873             88  PB-PAID-13-YEARLY         VALUE 'T'.
  6874         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  6875         16  PB-I-POLICY-FORM-NO          PIC X(12).
  6876         16  PB-I-DATA-ENTRY-SW           PIC X.
  6877             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  6878             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  6879             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  6880             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  6881         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  6882         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  6883*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  6884         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  6885         16  FILLER                       PIC X.
  6886
  6887         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  6888             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  6889             88  PB-INVALID-LIFE             VALUE '  ' '00'
  6890                                                   '90' THRU '99'.
  6891         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  6892                                          PIC XX.
  6893         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  6894         16  PB-I-AMOUNT-FINANCED REDEFINES
  6895                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  6896         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  6897         16  PB-I-UNPAID-CASH-PRICE REDEFINES
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 131
* EL689.cbl
  6898                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  6899         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  6900         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  6901         16  PB-I-CLP-AMOUNT REDEFINES
  6902                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  6903         16  PB-I-LF-CALC-FLAG            PIC X.
  6904             88 PB-COMP-LF-PREM               VALUE '?'.
  6905         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  6906         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  6907         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  6908         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  6909         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  6910         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  6911         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  6912         16  PB-I-LF-ABBR                 PIC XXX.
  6913         16  PB-I-LF-INPUT-CD             PIC XX.
  6914
  6915         16  PB-I-AH-BENEFIT-CD           PIC XX.
  6916             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  6917             88  PB-INVALID-AH               VALUE '  ' '00'
  6918                                                   '90' THRU '99'.
  6919         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  6920         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  6921         16  PB-I-AH-CALC-FLAG            PIC X.
  6922             88 PB-COMP-AH-PREM                  VALUE '?'.
  6923         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  6924         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  6925         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  6926         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  6927         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  6928         16  PB-I-AH-ABBR                 PIC XXX.
  6929         16  PB-I-AH-INPUT-CD             PIC XXX.
  6930
  6931         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  6932         16  PB-I-REIN-TABLE              PIC XXX.
  6933         16  PB-I-BUSINESS-TYPE           PIC 99.
  6934         16  PB-I-INDV-GRP-CD             PIC X.
  6935         16  PB-I-MORT-CODE.
  6936             20  PB-I-TABLE               PIC X.
  6937             20  PB-I-INTEREST            PIC XX.
  6938             20  PB-I-MORT-TYP            PIC X.
  6939         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  6940         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  6941         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  6942         16  PB-I-INDV-GRP-OVRD           PIC X.
  6943         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  6944         16  PB-I-SIG-SW                  PIC X.
  6945             88  PB-POLICY-SIGNED             VALUE 'Y'.
  6946         16  PB-I-RATE-CLASS              PIC XX.
  6947         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  6948         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  6949         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  6950         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  6951         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  6952         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  6953         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  6954         16  PB-I-BENEFIT-TYPE            PIC XXX.
  6955         16  PB-I-OB-FLAG                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 132
* EL689.cbl
  6956             88  PB-I-OB                      VALUE 'B'.
  6957             88  PB-I-SUMMARY                 VALUE 'Z'.
  6958         16  PB-I-ENTRY-STATUS            PIC X.
  6959             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  6960                                              'M' '5' '9' '2'.
  6961             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  6962             88  PB-I-POLICY-PENDING          VALUE '2'.
  6963             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  6964             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  6965             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  6966             88  PB-I-REIN-ONLY               VALUE '9'.
  6967             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  6968             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  6969             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  6970             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  6971         16  PB-I-INT-CODE                PIC X.
  6972             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  6973             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  6974         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  6975         16  PB-I-SOC-SEC-NO              PIC X(11).
  6976         16  PB-I-MEMBER-NO               PIC X(12).
  6977         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  6978*        16  PB-I-LOAN-OFFICER            PIC XXX.
  6979         16  PB-I-OLD-LOF                 PIC XXX.
  6980         16  PB-I-LF-EXPIRE-DT            PIC XX.
  6981         16  PB-I-AH-EXPIRE-DT            PIC XX.
  6982         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  6983         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  6984         16  PB-I-LIFE-INDICATOR          PIC X.
  6985             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  6986         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  6987         16  PB-I-MAIL-ADDRS-SW           PIC X.
  6988             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  6989             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  6990         16  PB-I-1ST-PMT-DT              PIC XX.
  6991         16  PB-I-JOINT-INSURED.
  6992             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  6993             20 PB-I-JOINT-FIRST-NAME.
  6994                24  PB-I-JOINT-FIRST-INIT PIC X.
  6995                24  FILLER                PIC X(9).
  6996             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  6997*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  6998         16  PB-I-BENEFICIARY-NAME.
  6999             20  PB-I-BANK-NUMBER         PIC X(10).
  7000             20  FILLER                   PIC X(15).
  7001         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  7002         16  PB-I-REFERENCE               PIC X(12).
  7003         16  FILLER REDEFINES PB-I-REFERENCE.
  7004             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  7005             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  7006             20  PB-I-CLP-STATE           PIC XX.
  7007         16  PB-I-UNDERWRITING-STATUS     PIC X.
  7008             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  7009             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  7010             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  7011         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  7012         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  7013         16  PB-I-RESIDENT-STATE          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 133
* EL689.cbl
  7014         16  PB-I-RATE-CODE               PIC X(4).
  7015         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  7016         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  7017         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  7018         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  7019         16  PB-I-BANK-NOCHRGB            PIC 99.
  7020         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  7021         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  7022
  7023     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  7024         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  7025             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  7026         16  PB-C-CANCEL-ORIGIN           PIC X.
  7027             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  7028         16  PB-C-LF-CANCEL-DT            PIC XX.
  7029         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  7030         16  PB-C-LF-CALC-REQ             PIC X.
  7031             88 PB-COMP-LF-CANCEL            VALUE '?'.
  7032         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  7033         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  7034         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  7035             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  7036         16  PB-C-AH-CANCEL-DT            PIC XX.
  7037         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  7038         16  PB-C-AH-CALC-REQ             PIC X.
  7039             88 PB-COMP-AH-CANCEL            VALUE '?'.
  7040         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  7041         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  7042         16  PB-C-LAST-NAME               PIC X(15).
  7043         16  PB-C-REFUND-SW               PIC X.
  7044             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  7045             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  7046         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  7047         16  PB-C-PAYEE-CODE              PIC X(6).
  7048         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  7049         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  7050         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  7051         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  7052         16  PB-C-REFERENCE               PIC X(12).
  7053         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  7054         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  7055         16  PB-C-POST-CARD-IND           PIC X.
  7056         16  PB-C-CANCEL-REASON           PIC X.
  7057         16  PB-C-REF-INTERFACE-SW        PIC X.
  7058         16  FILLER                       PIC X(09).
  7059*        16  FILLER                       PIC X(18).
  7060         16  PB-C-POLICY-FORM-NO          PIC X(12).
  7061*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  7062         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  7063         16  PB-CANCELED-CERT-DATA.
  7064             20  PB-CI-INSURED-NAME.
  7065                 24  PB-CI-LAST-NAME      PIC X(15).
  7066                 24  PB-CI-INITIALS       PIC XX.
  7067             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  7068             20  PB-CI-INSURED-SEX        PIC X.
  7069             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  7070             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  7071             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 134
* EL689.cbl
  7072             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  7073             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  7074             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  7075             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  7076             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  7077             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  7078             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  7079             20  PB-CI-RATE-CLASS         PIC XX.
  7080             20  PB-CI-RATE-DEV-LF        PIC XXX.
  7081             20  PB-CI-RATE-DEV-AH        PIC XXX.
  7082             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  7083             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  7084             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  7085             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  7086             20  PB-CI-LF-ABBR            PIC X(3).
  7087             20  PB-CI-AH-ABBR            PIC X(3).
  7088             20  PB-CI-OB-FLAG            PIC X.
  7089                 88  PB-CI-OB                VALUE 'B'.
  7090             20  PB-CI-LF-POLICY-STATUS   PIC X.
  7091                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  7092                                           'M' '4' '5' '9' '2'.
  7093                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  7094                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  7095                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  7096                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  7097                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  7098                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  7099                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  7100                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  7101                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  7102                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  7103                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  7104                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  7105             20  PB-CI-AH-POLICY-STATUS   PIC X.
  7106                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  7107                                           'M' '4' '5' '9' '2'.
  7108                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  7109                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  7110                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  7111                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  7112                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  7113                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  7114                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  7115                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  7116                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  7117                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  7118                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  7119                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  7120             20  PB-CI-PAY-FREQUENCY      PIC 99.
  7121             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  7122             20  PB-CI-SOC-SEC-NO         PIC X(11).
  7123             20  PB-CI-MEMBER-NO          PIC X(12).
  7124             20  PB-CI-INT-CODE           PIC X.
  7125                 88  PB-CI-ADD-ON                  VALUE 'A'.
  7126                 88  PB-CI-SIMPLE                  VALUE 'S'.
  7127             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  7128             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  7129             20  PB-CI-COMP-EXCP-SW       PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 135
* EL689.cbl
  7130                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  7131                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  7132             20  PB-CI-ENTRY-STATUS       PIC X.
  7133             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  7134             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  7135             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  7136             20  PB-CI-DEATH-DT           PIC XX.
  7137             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  7138             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  7139             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  7140             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  7141             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  7142             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  7143             20  PB-CI-ENTRY-DT              PIC XX.
  7144             20  PB-CI-ENTRY-BATCH           PIC X(6).
  7145             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  7146             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  7147             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  7148             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  7149             20  PB-CI-OLD-LOF               PIC XXX.
  7150*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  7151             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  7152             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  7153             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  7154             20  PB-CI-INDV-GRP-CD           PIC X.
  7155             20  PB-CI-BENEFICIARY-NAME.
  7156                 24  PB-CI-BANK-NUMBER       PIC X(10).
  7157                 24  FILLER                  PIC X(15).
  7158             20  PB-CI-NOTE-SW               PIC X.
  7159             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  7160             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  7161             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  7162             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  7163             20  PB-CI-LOAN-OFFICER          PIC X(5).
  7164             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  7165             20  PB-CI-FIRST-NAME            PIC X(10).
  7166
  7167         16  FILLER                       PIC X(17).
  7168*032306  16  FILLER                       PIC X(27).
  7169*        16  FILLER                       PIC X(46).
  7170
  7171     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  7172         16  FILLER                       PIC X(10).
  7173         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  7174         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  7175         16  PB-M-INSURED-MID-INIT        PIC X.
  7176         16  PB-M-INSURED-AGE             PIC 99.
  7177         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  7178         16  PB-M-INSURED-SEX             PIC X.
  7179         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  7180         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  7181         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  7182         16  PB-M-INSURED-CITY-STATE.
  7183             20  PB-M-INSURED-CITY        PIC X(28).
  7184             20  PB-M-INSURED-STATE       PIC XX.
  7185         16  PB-M-INSURED-ZIP-CODE.
  7186             20  PB-M-INSURED-ZIP-PRIME.
  7187                 24  PB-M-INSURED-ZIP-1   PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 136
* EL689.cbl
  7188                     88  PB-M-CANADIAN-POST-CODE
  7189                                             VALUE 'A' THRU 'Z'.
  7190                 24  FILLER               PIC X(4).
  7191             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  7192         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  7193                                        PB-M-INSURED-ZIP-CODE.
  7194             20  PM-M-INS-CAN-POST1       PIC XXX.
  7195             20  PM-M-INS-CAN-POST2       PIC XXX.
  7196             20  FILLER                   PIC XXX.
  7197         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  7198         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  7199         16  PB-M-CRED-BENE-NAME          PIC X(30).
  7200         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  7201         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  7202         16  PB-M-CRED-BENE-CITYST.
  7203             20  PB-M-CRED-BENE-CITY      PIC X(28).
  7204             20  PB-M-CRED-BENE-STATE     PIC XX.
  7205         16  FILLER                       PIC X(92).
  7206
  7207     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  7208         16  FILLER                       PIC X(10).
  7209         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  7210         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  7211         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  7212         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  7213         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  7214         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  7215         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  7216         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  7217         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  7218         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  7219         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  7220         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  7221         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  7222         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  7223         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  7224         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  7225         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  7226         16  PB-ACCOUNT-NAME              PIC X(30).
  7227         16  PB-PREM-REF-RPT-FLAG         PIC X.
  7228         16  PB-REFERENCE                 PIC X(12).
  7229         16  PB-B-RECEIVED-DT             PIC XX.
  7230         16  FILLER                       PIC X(234).
  7231
  7232     12  PB-RECORD-STATUS.
  7233         16  PB-CREDIT-SELECT-DT          PIC XX.
  7234         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  7235         16  PB-BILLED-DT                 PIC XX.
  7236         16  PB-BILLING-STATUS            PIC X.
  7237             88  PB-ENTRY-REVERSED            VALUE 'R'.
  7238             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  7239             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  7240         16  PB-RECORD-BILL               PIC X.
  7241             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  7242             88  PB-RECORD-RETURNED           VALUE 'R'.
  7243             88  PB-RECORD-ENDORSED           VALUE 'E'.
  7244             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  7245             88  PB-OVERRIDE-AH               VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 137
* EL689.cbl
  7246             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  7247         16  PB-BATCH-ENTRY               PIC X.
  7248             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  7249             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  7250             88  PB-REISSUED-CERT             VALUE 'E'.
  7251             88  PB-MONTHLY-CERT              VALUE 'M'.
  7252             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  7253             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  7254             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  7255         16  PB-FORCE-CODE                PIC X.
  7256             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  7257             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  7258             88  PB-CANCEL-FORCE              VALUE '8'.
  7259             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  7260             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  7261             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  7262             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  7263             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  7264             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  7265             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  7266         16  PB-FATAL-FLAG                PIC X.
  7267             88  PB-FATAL-ERRORS              VALUE 'X'.
  7268         16  PB-FORCE-ER-CD               PIC X.
  7269             88  PB-FORCE-ERRORS              VALUE 'F'.
  7270             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  7271         16  PB-WARN-ER-CD                PIC X.
  7272             88  PB-WARNING-ERRORS            VALUE 'W'.
  7273         16  FILLER                       PIC X.
  7274         16  PB-OUT-BAL-CD                PIC X.
  7275             88  PB-OUT-OF-BAL                VALUE 'O'.
  7276         16  PB-LIFE-OVERRIDE-L1          PIC X.
  7277         16  PB-AH-OVERRIDE-L1            PIC X.
  7278         16  PB-INPUT-DT                  PIC XX.
  7279         16  PB-INPUT-BY                  PIC X(4).
  7280         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  7281         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  7282         16  PB-TOLERANCE-REJECT-SW       PIC X.
  7283         16  PB-LF-EARNING-METHOD         PIC X.
  7284         16  PB-AH-EARNING-METHOD         PIC X.
  7285         16  PB-LF-TERM-CALC-METHOD       PIC X.
  7286         16  PB-AH-TERM-CALC-METHOD       PIC X.
  7287         16  PB-REIN-CD                   PIC XXX.
  7288         16  PB-LF-REFUND-TYPE            PIC X.
  7289         16  PB-AH-REFUND-TYPE            PIC X.
  7290         16  PB-ACCT-EFF-DT               PIC XX.
  7291         16  PB-ACCT-EXP-DT               PIC XX.
  7292         16  PB-COMPANY-ID                PIC X(3).
  7293         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  7294         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  7295         16  PB-SV-CARRIER                PIC X.
  7296         16  PB-SV-GROUPING               PIC X(6).
  7297         16  PB-SV-STATE                  PIC XX.
  7298         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  7299         16  PB-GA-BILLING-INFO.
  7300             20  PB-GA-BILL-DT OCCURS 5 TIMES
  7301                                          PIC XX.
  7302         16  PB-SV-REMIT-TO  REDEFINES
  7303             PB-GA-BILLING-INFO           PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 138
* EL689.cbl
  7304         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  7305         16  PB-I-LOAN-OFFICER            PIC X(5).
  7306         16  PB-I-VIN                     PIC X(17).
  7307
  7308         16  FILLER                       PIC X(04).
  7309         16  IMNET-BYPASS-SW              PIC X.
  7310
  7311******************************************************************
  7312*                COMMON EDIT ERRORS                              *
  7313******************************************************************
  7314
  7315     12  PB-COMMON-ERRORS.
  7316         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  7317                                           PIC S9(4)     COMP.
  7318
  7319******************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 139
* EL689.cbl
  7321*    COPY ERCPYAJ.
  7322******************************************************************
  7323*                                                                *
  7324*                            ERCPYAJ                             *
  7325*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7326*                            VMOD=2.015                          *
  7327*                                                                *
  7328*   FILE DESCRIPTION = PENDING PAYMENT AND ADJUSTMENTS           *
  7329*                                                                *
  7330*                                                                *
  7331*   FILE TYPE = VSAM,KSDS                                        *
  7332*   RECORD SIZE = 200  RECFORM = FIXED                           *
  7333*                                                                *
  7334*   BASE CLUSTER = ERPYAJ                         RKP=2,LEN=33   *
  7335*       ALTERNATE PATHS = NONE                                   *
  7336*                                                                *
  7337*   LOG = YES                                                    *
  7338*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7339******************************************************************
  7340******************************************************************
  7341*                   C H A N G E   L O G
  7342*
  7343* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7344*-----------------------------------------------------------------
  7345*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7346* EFFECTIVE    NUMBER
  7347*-----------------------------------------------------------------
  7348* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
  7349* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
  7350******************************************************************
  7351
  7352 01  PENDING-PAY-ADJ.
  7353     12  PY-RECORD-ID                     PIC XX.
  7354         88  VALID-PY-ID                        VALUE 'PY'.
  7355
  7356     12  PY-CONTROL-PRIMARY.
  7357         16  PY-COMPANY-CD                PIC X.
  7358         16  PY-CARRIER                   PIC X.
  7359         16  PY-GROUPING                  PIC X(6).
  7360         16  PY-FIN-RESP                  PIC X(10).
  7361         16  PY-ACCOUNT                   PIC X(10).
  7362         16  PY-PRODUCER REDEFINES PY-ACCOUNT
  7363                                          PIC X(10).
  7364         16  PY-FILE-SEQ-NO               PIC S9(8)     COMP.
  7365         16  PY-RECORD-TYPE               PIC X.
  7366             88  PY-REMIT-RECEIVED            VALUE 'R'.
  7367             88  PY-DEPOSIT                   VALUE 'D'.
  7368             88  PY-CHARGE-TO-AGENT           VALUE 'C'.
  7369             88  PY-ADJ-REM-RECEIVED          VALUE 'S'.
  7370             88  PY-ADJ-DEPOSIT               VALUE 'T'.
  7371             88  PY-ADJ-CHG-TO-AGT            VALUE 'U'.
  7372             88  PY-ADD-TO-YTD-COMP           VALUE 'X'.
  7373             88  PY-SUBTRACT-YTD-COMP         VALUE 'Y'.
  7374             88  PY-ADD-TO-BALANCE            VALUE 'Z'.
  7375             88  PY-FICA-ENTRY                VALUE 'F'.
  7376             88  PY-REMIT-IND-GROUPING        VALUE 'G'.
  7377             88  PY-POLICY-FEE                VALUE 'W'.
  7378             88  PY-DUE-PREM-ADJ              VALUE 'P'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 140
* EL689.cbl
  7379
  7380     12  PY-PYMT-TYPE                     PIC X.
  7381             88  PY-NEW-BUS-PYMT              VALUE 'B'.
  7382             88  PY-REINS-PYMT                VALUE 'R'.
  7383             88  PY-EXP-PYMT                  VALUE 'E'.
  7384
  7385     12  PY-BIL-INV                       PIC X(6).
  7386     12  PY-REF-NO                        PIC X(12).
  7387
  7388     12  PY-LAST-MAINT-DT                 PIC XX.
  7389     12  PY-LAST-MAINT-BY                 PIC X(4).
  7390     12  PY-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  7391
  7392     12  PY-PYADJ-RECORD.
  7393         16  PY-ENTRY-AMT                 PIC S9(7)V99  COMP-3.
  7394         16  PY-ENTRY-COMMENT             PIC X(30).
  7395         16  PY-GL-DATA      REDEFINES PY-ENTRY-COMMENT.
  7396             20  PY-GL-ACCOUNT            PIC X(10).
  7397             20  PY-GL-STATE              PIC X(02).
  7398             20  PY-GL-CANC-SW            PIC X(01).
  7399                 88  PY-GL-CANC-SW-ON     VALUE 'Y'.
  7400                 88  PY-GL-CANC-SW-OFF    VALUE 'N'.
  7401             20  PY-GL-COMMENT            PIC X(10).
  7402             20  FILLER      REDEFINES PY-GL-COMMENT.
  7403                 24  PY-GL-CHECK-NO       PIC 9(06).
  7404                 24  FILLER               PIC X(04).
  7405             20  FILLER                   PIC X(07).
  7406         16  PY-SAVE-ACCOUNT              PIC X(10).
  7407         16  PY-SAVE-TYPE                 PIC X(01).
  7408
  7409         16  PY-LETTERS.
  7410             20  PY-LETTER OCCURS 3 TIMES
  7411                           INDEXED BY PY-LET-NDX
  7412                                          PIC X(04).
  7413
  7414         16  PY-ERCOMP-TYPE               PIC X.
  7415             88  PY-ACCOUNT-TYPE              VALUE 'A'.
  7416             88  PY-GA-TYPE                   VALUE 'G'.
  7417             88  PY-BANK-TYPE                 VALUE 'B'.
  7418         16  FILLER                       PIC X(05).
  7419
  7420     12  PY-RECORD-STATUS.
  7421         16  PY-CREDIT-SELECT-DT          PIC XX.
  7422         16  PY-CREDIT-ACCEPT-DT          PIC XX.
  7423         16  PY-BILLED-DATE               PIC XX.
  7424         16  PY-REPORTED-DT               PIC XX.
  7425         16  PY-PMT-APPLIED               PIC X.
  7426             88  PY-ACCOUNT-PMT               VALUE 'A'.
  7427             88  PY-GA-PMT                    VALUE 'G'.
  7428             88  PY-OVWRITE-PMT               VALUE 'O'.
  7429             88  PY-NON-AR-PMT                VALUE 'N'.
  7430         16  FILLER                       PIC X(5).
  7431         16  PY-INPUT-DT                  PIC XX.
  7432         16  PY-CHECK-NUMBER              PIC X(6).
  7433         16  PY-VOID-SW                   PIC X.
  7434             88  PY-CHECK-VOIDED              VALUE 'V'.
  7435         16  PY-CHECK-ORIGIN-SW           PIC X.
  7436             88  PY-BILLING-CHECK             VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 141
* EL689.cbl
  7437             88  PY-REFUND-CHECK              VALUE 'R'.
  7438             88  PY-GA-CHECK                  VALUE 'G'.
  7439             88  PY-CHECK-WRITTEN             VALUE 'W'.
  7440             88  PY-CHECK-REVERSAL            VALUE 'V'.
  7441         16  PY-CHECK-WRITTEN-DT          PIC XX.
  7442         16  PY-CHECK-QUE-CONTROL         PIC S9(8) COMP.
  7443         16  PY-CHECK-QUE-SEQUENCE        PIC S9(4) COMP.
  7444         16  PY-BILL-FLAG                 PIC X.
  7445             88  PY-BILLED                    VALUE 'B'.
  7446         16  PY-AR-FLAG                   PIC X.
  7447             88  PY-AR-CYCLE                  VALUE 'C'.
  7448             88  PY-AR-MONTH-END              VALUE 'M'.
  7449         16  PY-AR-DATE                   PIC XX.
  7450
  7451     12  PY-GL-CODES.
  7452         16  PY-GL-DB                     PIC X(14).
  7453         16  PY-GL-CR                     PIC X(14).
  7454         16  PY-GL-FLAG                   PIC X.
  7455         16  PY-GL-DATE                   PIC XX.
  7456
  7457     12  PY-CANCEL-FEE-FLAG               PIC X(2).
  7458     12  FILLER                           PIC X(3).
  7459******************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 142
* EL689.cbl
  7461*    COPY ELCTEXT.
  7462******************************************************************
  7463*                                                                *
  7464*                                                                *
  7465*                            ELCTEXT.                            *
  7466*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7467*                            VMOD=2.008                          *
  7468*                                                                *
  7469*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
  7470*                                     FORM LETTERS,              *
  7471*                                     CERT FORM DISPLAY.
  7472*                                                                *
  7473*   FILE TYPE = VSAM,KSDS                                        *
  7474*   RECORD SIZE = 100   RECFORM = FIXED                          *
  7475*                                                                *
  7476*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
  7477*       ALTERNATE INDEX = NONE                                   *
  7478*                                                                *
  7479*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
  7480*       ALTERNATE INDEX = NONE                                   *
  7481*                                                                *
  7482*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
  7483*       ALTERNATE INDEX = NONE                                   *
  7484*                                                                *
  7485*   LOG = NO                                                     *
  7486*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7487******************************************************************
  7488 01  TEXT-FILES.
  7489     12  TEXT-FILE-ID                PIC XX.
  7490         88  FORMS-FILE-TEXT            VALUE 'TF'.
  7491         88  LETTER-FILE-TEXT           VALUE 'TL'.
  7492         88  HELP-FILE-TEXT             VALUE 'TH'.
  7493
  7494     12  TX-CONTROL-PRIMARY.
  7495         16  TX-COMPANY-CD           PIC X.
  7496             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
  7497         16  TX-ACCESS-CD-GENL       PIC X(12).
  7498
  7499         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  7500             20  TX-LETTER-NO        PIC X(4).
  7501             20  FILLER              PIC X(8).
  7502
  7503         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  7504             20  TX-FORM-NO          PIC X(12).
  7505
  7506         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  7507             20  TX-HELP-TYPE        PIC X.
  7508                 88  HELP-FOR-GENERAL   VALUE ' '.
  7509                 88  HELP-BY-SCREEN     VALUE 'S'.
  7510                 88  HELP-BY-ERROR      VALUE 'E'.
  7511             20  TX-SCREEN-OR-ERROR  PIC X(4).
  7512                 88  GENERAL-INFO-HELP  VALUE '0000'.
  7513             20  TX-HELP-FOR-COMPANY  PIC XXX.
  7514                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
  7515             20  FILLER              PIC X(4).
  7516
  7517         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
  7518
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 143
* EL689.cbl
  7519     12  TX-PROCESS-CONTROL          PIC XX.
  7520         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
  7521
  7522     12  TX-TEXT-LINE                PIC X(70).
  7523
  7524     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
  7525         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
  7526         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
  7527         88  TX-VALID-FORM-SQUEEZE-VALUE
  7528                                        VALUE 'Y' ' '.
  7529
  7530     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
  7531         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
  7532         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
  7533         88  TX-DO-NOT-ADJUST           VALUE 'N'.
  7534         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
  7535         88  TX-NEW-PARAGRAPH           VALUE 'P'.
  7536         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
  7537         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
  7538                                              'K' 'N' ' '
  7539                                              'Z'.
  7540
  7541     12  TX-ARCHIVE-SW               PIC X.
  7542         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
  7543         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
  7544         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
  7545
  7546     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
  7547     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
  7548
  7549     12  TX-BSR-CODE                 PIC X.
  7550         88  TX-BSR-LETTER              VALUE 'B'.
  7551         88  TX-NON-BSR-LETTER          VALUE ' '.
  7552
  7553     12  FILLER                      PIC X.
  7554*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 144
* EL689.cbl
  7556 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA ACCOUNT-MASTER
  7557                          LETTER-ARCHIVE LETTER-ARCHIVE-TEXT
  7558                          CERTIFICATE-MASTER CHECK-RECORDS
  7559                          CONTROL-FILE COMPENSATION-MASTER
  7560                          MAILING-DATA PENDING-BUSINESS
  7561                          PENDING-PAY-ADJ TEXT-FILES.
  7562 0000-DFHEXIT SECTION.
  7563     MOVE '9#                    $   ' TO DFHEIV0.
  7564     MOVE 'EL689' TO DFHEIV1.
  7565     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7566     MOVE DFHCOMMAREA TO PROGRAM-INTERFACE-BLOCK.
  7567
  7568     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  7569     MOVE '5'                    TO DC-OPTION-CODE.
  7570     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
  7571     MOVE DC-GREG-DATE-1-EDIT    TO W-SAVE-DATE.
  7572     MOVE DC-BIN-DATE-1          TO W-SAVE-BIN-DATE
  7573                                    W-CURRENT-SAVE.
  7574
  7575     MOVE 2                      TO EMI-NUMBER-OF-LINES.
  7576     MOVE ERROR-MESSAGE-INTERFACE-BLOCK
  7577                                 TO EMI-SAVE-AREA.
  7578
  7579     MOVE EIBTRMID               TO W-TS-TERM-TEXT
  7580                                    W-TS-TERM-SCREEN.
  7581
  7582     IF  EIBCALEN EQUAL 0
  7583         MOVE UNACCESS-MSG       TO LOGOFF-MSG
  7584         GO TO 8300-SEND-TEXT
  7585     END-IF.
  7586
  7587     IF  PI-689-CREATE-NO-SCREENS
  7588         GO TO 0600-BYPASS-SCREEN-CNTL
  7589     END-IF.
  7590
  7591     IF  PI-CALLING-PROGRAM NOT EQUAL W-THIS-PGM
  7592         IF  PI-RETURN-TO-PROGRAM NOT EQUAL W-THIS-PGM
  7593             MOVE PI-SAVED-PROGRAM-5
  7594                                 TO PI-SAVED-PROGRAM-6
  7595             MOVE PI-SAVED-PROGRAM-4
  7596                                 TO PI-SAVED-PROGRAM-5
  7597             MOVE PI-SAVED-PROGRAM-3
  7598                                 TO PI-SAVED-PROGRAM-4
  7599             MOVE PI-SAVED-PROGRAM-2
  7600                                 TO PI-SAVED-PROGRAM-3
  7601             MOVE PI-SAVED-PROGRAM-1
  7602                                 TO PI-SAVED-PROGRAM-2
  7603             MOVE PI-RETURN-TO-PROGRAM
  7604                                 TO PI-SAVED-PROGRAM-1
  7605             MOVE PI-CALLING-PROGRAM
  7606                                 TO PI-RETURN-TO-PROGRAM
  7607             MOVE W-THIS-PGM     TO PI-CALLING-PROGRAM
  7608             PERFORM 7780-DELETE-TEMP-STOR-TEXT THRU 7780-EXIT
  7609             MOVE LOW-VALUES     TO EL689AO
  7610             PERFORM 9905-INITIALIZE-SECURITY THRU 9905-EXIT
  7611             IF PI-689-ARCHIVE-NUMBER NOT NUMERIC
  7612                MOVE ZEROS       TO PI-689-ARCHIVE-NUMBEr
  7613             END-IF
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 145
* EL689.cbl
  7614             IF  PI-RETURN-TO-PROGRAM EQUAL 'EL6311'
  7615                     AND
  7616                 PI-689-KEY-DATA-FIELDS GREATER THAN LOW-VALUES
  7617                 GO TO 0400-EL6311-INCOMING
  7618             ELSE
  7619                 MOVE PI-689-ARCHIVE-NUMBER
  7620                                 TO W-INCOMING-ARCHIVE
  7621                 MOVE LOW-VALUES TO PI-1042-WA
  7622                                    PI-689-WORK-AREA
  7623                 MOVE ZEROS      TO PI-CURRENT-LINE
  7624                                    PI-TEMP-STOR-ITEMS
  7625                                    PI-TOTAL-LINES
  7626                                    PI-UPDATE-SW
  7627                                    PI-689-NUMBER-LABEL-LINES
  7628                                    PI-689-NUMBER-TEXT-RECORDS
  7629                                    PI-689-ERROR
  7630                 MOVE SPACES     TO PI-689-PRINT-SW
  7631                                    PI-689-ALT-PRINTER-ID
  7632                                    PI-689-LBL-OVERRIDE
  7633                                    PI-COMM-CONTROL
  7634                                    PI-689-FORM-NUMBER
  7635                                    PI-689-TEMP-STOR-ID
  7636                                    PI-689-LABEL-SOURCE
  7637                                    PI-689-USE-SCREEN-IND
  7638                 MOVE '2'        TO PI-ACTION
  7639                 MOVE -1         TO MAINTL
  7640                 MOVE PI-LOWER-CASE-LETTERS
  7641                                 TO W-LC-CASE-IND
  7642                 IF  W-INCOMING-ARCHIVE NUMERIC
  7643                         AND
  7644                     W-INCOMING-ARCH-NO GREATER THAN ZEROS
  7645                     MOVE 'S'    TO MAINTI
  7646                     MOVE +1     TO MAINTL
  7647                     MOVE AL-UANON
  7648                                 TO MAINTA
  7649                     MOVE W-INCOMING-ARCH-NO
  7650                                 TO ARCHNUMI
  7651                     MOVE +8     TO ARCHNUML
  7652                     MOVE AL-UNNON
  7653                                 TO ARCHNUMA
  7654                     GO TO 1000-SHOW
  7655                 ELSE
  7656                     GO TO 0450-SPECIAL-INPUT-PROCESS
  7657                 END-IF
  7658             END-IF
  7659         ELSE
  7660             MOVE PI-CALLING-PROGRAM TO W-CALL-PGM
  7661             MOVE PI-RETURN-TO-PROGRAM
  7662                                     TO PI-CALLING-PROGRAM
  7663             MOVE PI-SAVED-PROGRAM-1 TO PI-RETURN-TO-PROGRAM
  7664             MOVE PI-SAVED-PROGRAM-2 TO PI-SAVED-PROGRAM-1
  7665             MOVE PI-SAVED-PROGRAM-3 TO PI-SAVED-PROGRAM-2
  7666             MOVE PI-SAVED-PROGRAM-4 TO PI-SAVED-PROGRAM-3
  7667             MOVE PI-SAVED-PROGRAM-5 TO PI-SAVED-PROGRAM-4
  7668             MOVE PI-SAVED-PROGRAM-6 TO PI-SAVED-PROGRAM-5
  7669             MOVE SPACES             TO PI-SAVED-PROGRAM-6
  7670             PERFORM 7700-READ-TEXT-TS THRU 7700-EXIT
  7671             MOVE LOW-VALUES         TO EL689AO
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 146
* EL689.cbl
  7672             PERFORM 7740-RESTORE-SCREEN THRU 7749-EXIT
  7673             SET W-RG-NDX            TO PI-CURRENT-LINE
  7674             PERFORM 7000-FORMAT-SCREEN THRU 7000-EXIT
  7675                 VARYING
  7676                     W-SC-NDX FROM 1 BY 1
  7677                 UNTIL
  7678                     W-SC-NDX GREATER THAN
  7679                     W-NUM-LINES-PER-SCREEN
  7680             MOVE PI-689-ALT-PRINTER-ID
  7681                                     TO PRINTERO
  7682             MOVE AL-UANON           TO PRINTERA
  7683             MOVE -1                 TO PRINTERL
  7684             GO TO 8100-SEND-INITIAL-MAP
  7685         END-IF
  7686     END-IF.
  7687
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 147
* EL689.cbl
  7689 0200-RECEIVE.
  7690
  7691     MOVE PI-689-FATAL-CTR       TO EMI-FATAL-CTR
  7692     MOVE PI-689-FORCABLE-CTR    TO EMI-FORCABLE-CTR
  7693     IF  EMI-FATAL-CTR GREATER THAN ZEROS
  7694             OR
  7695         EMI-FORCABLE-CTR GREATER THAN ZEROS
  7696         MOVE 'Y'                TO W-HOLD-IND.
  7697
  7698     MOVE W-TRANSACTION          TO EIBTRNID.
  7699     MOVE EMI-SAVE-AREA          TO ERROR-MESSAGE-INTERFACE-BLOCK.
  7700     MOVE ZEROS                  TO W-LAST-ERROR.
  7701     MOVE LOW-VALUES             TO EL689AI.
  7702     MOVE '104A'                 TO W-TS-ID-TEXT.
  7703     MOVE EIBTRMID               TO W-TS-TERM-TEXT
  7704                                    W-TS-TERM-SCREEN.
  7705
  7706
  7707* EXEC CICS HANDLE AID
  7708*        CLEAR    (9300-DFHCLEAR)
  7709*        PA1      (9200-PA)
  7710*        PA2      (9200-PA)
  7711*        PA3      (9200-PA)
  7712*    END-EXEC.
  7713*    MOVE '"&=!"#               V! " #00007702' TO DFHEIV0
  7714     MOVE X'22263D212223202020202020' TO DFHEIV0(1:12)
  7715     MOVE X'202020202020202020562120' TO DFHEIV0(13:12)
  7716     MOVE X'2220233030303037373032' TO DFHEIV0(25:11)
  7717     CALL 'kxdfhei1' USING DFHEIV0
  7718     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7719
  7720
  7721
  7722* EXEC CICS HANDLE CONDITION
  7723*        PGMIDERR (9700-PGMID-ERROR)
  7724*        ERROR    (9800-ABEND)
  7725*        MAPFAIL  (0325-MAPFAIL)
  7726*    END-EXEC.
  7727*    MOVE '"$L.?                 ! # #00007709' TO DFHEIV0
  7728     MOVE X'22244C2E3F20202020202020' TO DFHEIV0(1:12)
  7729     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7730     MOVE X'2320233030303037373039' TO DFHEIV0(25:11)
  7731     CALL 'kxdfhei1' USING DFHEIV0
  7732     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7733
  7734
  7735
  7736* EXEC CICS SYNCPOINT
  7737*    END-EXEC.
  7738*    MOVE '6"                    !   #00007715' TO DFHEIV0
  7739     MOVE X'362220202020202020202020' TO DFHEIV0(1:12)
  7740     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7741     MOVE X'2020233030303037373135' TO DFHEIV0(25:11)
  7742     CALL 'kxdfhei1' USING DFHEIV0
  7743     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7744
  7745
  7746     IF PI-LOWER-CASE-LETTERS = 'Y'
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 148
* EL689.cbl
  7747*    IF  W-LC-USE-BOTH-CASES
  7748
  7749* EXEC CICS RECEIVE
  7750*            MAP      (W-MAP)
  7751*            MAPSET   (W-MAPSET)
  7752*            INTO     (EL689AI)
  7753*            ASIS
  7754*        END-EXEC
  7755     MOVE LENGTH OF
  7756      EL689AI
  7757       TO DFHEIV11
  7758*    MOVE '8"TAI  L              ''   #00007720' TO DFHEIV0
  7759     MOVE X'382254414920204C20202020' TO DFHEIV0(1:12)
  7760     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7761     MOVE X'2020233030303037373230' TO DFHEIV0(25:11)
  7762     CALL 'kxdfhei1' USING DFHEIV0,
  7763           W-MAP,
  7764           EL689AI,
  7765           DFHEIV11,
  7766           W-MAPSET,
  7767           DFHEIV99,
  7768           DFHEIV99
  7769     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7770     ELSE
  7771
  7772* EXEC CICS RECEIVE
  7773*            MAP      (W-MAP)
  7774*            MAPSET   (W-MAPSET)
  7775*            INTO     (EL689AI)
  7776*        END-EXEC.
  7777     MOVE LENGTH OF
  7778      EL689AI
  7779       TO DFHEIV11
  7780*    MOVE '8"T I  L              ''   #00007727' TO DFHEIV0
  7781     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  7782     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7783     MOVE X'2020233030303037373237' TO DFHEIV0(25:11)
  7784     CALL 'kxdfhei1' USING DFHEIV0,
  7785           W-MAP,
  7786           EL689AI,
  7787           DFHEIV11,
  7788           W-MAPSET,
  7789           DFHEIV99,
  7790           DFHEIV99
  7791     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7792
  7793
  7794     IF  NOT DISPLAY-CAP
  7795         MOVE 'READ'             TO SM-READ
  7796         PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  7797         MOVE ER-9097            TO EMI-ERROR
  7798         MOVE -1                 TO MAINTL
  7799         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7800         GO TO 8100-SEND-INITIAL-MAP.
  7801
  7802     INSPECT MAINTI CONVERTING W-LOWER-CASE TO W-UPPER-CASE.
  7803
  7804     IF  ENTERPFL EQUAL 0
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 149
* EL689.cbl
  7805         GO TO 0300-CHECK-PFKEYS.
  7806
  7807     IF  EIBAID NOT EQUAL DFHENTER
  7808         MOVE ER-0004            TO EMI-ERROR
  7809         GO TO 0320-INPUT-ERROR.
  7810
  7811     IF  ENTERPFI NUMERIC
  7812             AND
  7813         ENTERPFI GREATER THAN 0
  7814             AND
  7815         ENTERPFI LESS THAN 25
  7816         MOVE PF-VALUES (ENTERPFI)
  7817                                 TO EIBAID
  7818     ELSE
  7819         MOVE ER-0029            TO EMI-ERROR
  7820         GO TO 0320-INPUT-ERROR.
  7821
  7822 0300-CHECK-PFKEYS.
  7823
  7824     IF  EIBAID EQUAL DFHPF23
  7825         PERFORM 7780-DELETE-TEMP-STOR-TEXT THRU 7780-EXIT
  7826         MOVE ZEROS              TO PI-TOTAL-LINES
  7827                                    PI-CURRENT-LINE
  7828         MOVE EIBAID             TO PI-ENTRY-CD-1
  7829         MOVE W-XCTL-005         TO W-CALL-PGM
  7830         GO TO 9400-XCTL.
  7831
  7832     IF  EIBAID EQUAL DFHPF24
  7833         PERFORM 7780-DELETE-TEMP-STOR-TEXT THRU 7780-EXIT
  7834         MOVE ZEROS              TO PI-TOTAL-LINES
  7835                                    PI-CURRENT-LINE
  7836         MOVE W-XCTL-626         TO W-CALL-PGM
  7837         GO TO 9400-XCTL.
  7838
  7839     MOVE SPACES                 TO W-KEY-FIELDS-CHANGED-IND
  7840                                    W-FORM-CHANGED-IND.
  7841
  7842     IF  PI-689-KEY-DATA-FIELDS EQUAL LOW-VALUES OR SPACES
  7843             OR
  7844         PI-SHOW-MODE
  7845         NEXT SENTENCE
  7846     ELSE
  7847         IF  PI-689-FORM-NUMBER GREATER THAN SPACES
  7848                 AND
  7849             FORML NOT EQUAL ZEROS
  7850                 AND
  7851             PI-689-FORM-NUMBER NOT EQUAL FORMI
  7852             MOVE FORMI          TO PI-689-FORM-NUMBER
  7853             MOVE LOW-VALUES     TO EL689AI
  7854                                    PI-1042-WA
  7855                                    PI-689-FOLLOW-UP-DATE
  7856                                    PI-689-PRINT-RESTRICTION
  7857                                    PI-689-RESEND-DATE-1
  7858                                    PI-689-RESEND1-EDIT
  7859                                    PI-689-FOLLOW-UP-DATE
  7860                                    PI-689-FOLLOW-UP-EDIT
  7861                                    PI-689-ERROR-IND
  7862             MOVE ZEROS          TO PI-689-ERROR
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 150
* EL689.cbl
  7863                                    PI-689-NUMBER-COPIES
  7864                                    PI-689-NUMBER-LABEL-LINES
  7865                                    PI-689-NUMBER-TEXT-RECORDS
  7866                                    PI-CURRENT-LINE
  7867                                    PI-TEMP-STOR-ITEMS
  7868                                    PI-TOTAL-LINES
  7869                                    PI-UPDATE-SW
  7870             MOVE SPACES         TO PI-689-PRINT-SW
  7871                                    PI-689-ALT-PRINTER-ID
  7872                                    PI-COMM-CONTROL
  7873                                    PI-689-TEMP-STOR-ID
  7874                                    PI-689-USE-SCREEN-IND
  7875                                    PI-689-RESEND-LETR-1
  7876             PERFORM 7740-RESTORE-SCREEN THRU 7749-EXIT
  7877             MOVE DFHENTER       TO EIBAID
  7878             MOVE 'Y'            TO W-FORM-CHANGED-IND
  7879             GO TO 0330-FUNCTION-CHECK
  7880         ELSE
  7881             IF  PI-689-DATA-SOURCE NOT EQUAL DATASORI
  7882                     OR
  7883                 (PI-689-LABEL-SOURCE NOT EQUAL ADDRSI
  7884                         AND
  7885                     (PI-689-LABEL-SOURCE NOT EQUAL SPACES
  7886                             OR
  7887                         ADDRSI NOT EQUAL LOW-VALUES))
  7888                     OR
  7889                 PI-689-CARRIER NOT EQUAL CARRIERI
  7890                     OR
  7891                 PI-689-GROUPING NOT EQUAL GROUPI
  7892                     OR
  7893                 PI-689-STATE NOT EQUAL STATEI
  7894                     OR
  7895                 PI-689-ACCOUNT NOT EQUAL ACCTI
  7896                     OR
  7897                 PI-689-CERT-PRIME NOT EQUAL CERTI
  7898                     OR
  7899                 PI-689-CERT-SFX NOT EQUAL SFXI
  7900                     OR
  7901                 PI-689-TYPE NOT EQUAL TYPEI
  7902                     OR
  7903                 PI-689-DATE-EDIT NOT EQUAL DATEI
  7904                     OR
  7905                 PI-689-RESP-PERSON NOT EQUAL RPERSONI
  7906                     OR
  7907                 PI-689-SEQ-EDIT NOT EQUAL SEQI
  7908                     OR
  7909                 PI-689-ENTRY-BATCH NOT EQUAL BENTRYI
  7910                     OR
  7911                 PI-689-BCSEQ-EDIT NOT EQUAL BCSEQI
  7912                 MOVE 'Y'        TO W-KEY-FIELDS-CHANGED-IND
  7913                 MOVE DFHENTER   TO EIBAID
  7914                 GO TO 0330-FUNCTION-CHECK.
  7915
  7916     IF  EIBAID EQUAL DFHPF1
  7917         MOVE +7                 TO W-ROLL-COUNTER
  7918         GO TO 4000-ROLL-PAGE.
  7919
  7920     IF  EIBAID EQUAL DFHPF2
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 151
* EL689.cbl
  7921         MOVE -7                 TO W-ROLL-COUNTER
  7922         GO TO 4000-ROLL-PAGE.
  7923
  7924     IF  EIBAID EQUAL DFHPF3
  7925         IF  W-HOLD-ON
  7926             MOVE ER-7245        TO EMI-ERROR
  7927             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7928             MOVE -1             TO MAINTL
  7929             MOVE AL-UABON       TO MAINTA
  7930             GO TO 8200-SEND-DATAONLY
  7931         ELSE
  7932             GO TO 0330-FUNCTION-CHECK.
  7933     IF (EIBAID = DFHPF8)
  7934        AND (PI-PROCESSOR-ID = 'LMLC' OR 'SPJA' OR 'KAWA' OR
  7935          'CAGB' OR 'DLVA' OR 'ECCA' OR 'KRHA' OR 'ALWA')
  7936        MOVE ER-0029             TO EMI-ERROR
  7937        GO TO 0320-INPUT-ERROR
  7938     END-IF
  7939     IF EIBAID = DFHPF4 OR DFHPF8
  7940         IF  W-HOLD-ON
  7941             MOVE ER-7245        TO EMI-ERROR
  7942             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7943             MOVE -1             TO MAINTL
  7944             MOVE AL-UABON       TO MAINTA
  7945             GO TO 8200-SEND-DATAONLY
  7946         ELSE
  7947             GO TO 0330-FUNCTION-CHECK.
  7948
  7949     IF  EIBAID = DFHPF5
  7950         COMPUTE W-ROLL-COUNTER = ((PI-TOTAL-LINES - 1) * -1)
  7951         GO TO 4000-ROLL-PAGE.
  7952
  7953     IF  EIBAID = DFHPF6
  7954         MOVE PI-TOTAL-LINES     TO W-ROLL-COUNTER
  7955         GO TO 4000-ROLL-PAGE.
  7956
  7957     IF  EIBAID EQUAL DFHPF7
  7958         IF  W-HOLD-ON
  7959             MOVE ER-7245        TO EMI-ERROR
  7960             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7961             MOVE -1             TO MAINTL
  7962             MOVE AL-UABON       TO MAINTA
  7963             GO TO 8200-SEND-DATAONLY
  7964         ELSE
  7965             GO TO 0330-FUNCTION-CHECK.
  7966
  7967     IF  EIBAID EQUAL DFHENTER
  7968         GO TO 0330-FUNCTION-CHECK.
  7969
  7970     MOVE ER-0029                TO EMI-ERROR.
  7971
  7972 0320-INPUT-ERROR.
  7973
  7974     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7975
  7976     IF  ENTERPFL EQUAL 0
  7977         MOVE -1                 TO MAINTL
  7978         MOVE AL-UABON           TO MAINTA
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 152
* EL689.cbl
  7979     ELSE
  7980         MOVE AL-UNBON           TO ENTERPFA
  7981         MOVE -1                 TO ENTERPFL.
  7982
  7983     GO TO 8200-SEND-DATAONLY.
  7984
  7985 0325-MAPFAIL.
  7986***********************************************************
  7987*      ROUTINE SHOULD ONLY BE PERFORMED WHEN PRINTING     *
  7988*      LETTERS ON A 3275 PRINTER.                         *
  7989***********************************************************
  7990
  7991     PERFORM 7700-READ-TEXT-TS THRU 7700-EXIT
  7992
  7993     SET W-RG-NDX                TO PI-CURRENT-LINE.
  7994     PERFORM 7000-FORMAT-SCREEN THRU 7000-EXIT
  7995             VARYING
  7996         W-SC-NDX FROM 1 BY 1
  7997             UNTIL
  7998         W-SC-NDX GREATER THAN W-NUM-LINES-PER-SCREEN.
  7999
  8000     MOVE -1                     TO MAINTL.
  8001     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 153
* EL689.cbl
  8003 0330-FUNCTION-CHECK.
  8004
  8005     IF  MAINTI EQUAL 'S'
  8006         IF EIBAID = DFHPF4 OR DFHPF8
  8007             GO TO 7900-PRINT-LETTER-NOW
  8008         ELSE
  8009             GO TO 1000-SHOW.
  8010
  8011     IF  NOT MODIFY-CAP
  8012         MOVE 'UPDATE'           TO SM-READ
  8013         PERFORM 9995-SECURITY-VIOLATION
  8014         MOVE ER-0070            TO EMI-ERROR
  8015         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8016         MOVE -1                 TO MAINTL
  8017         GO TO 8100-SEND-INITIAL-MAP.
  8018
  8019     IF  W-FORM-CHANGED
  8020             OR
  8021         W-KEY-FIELDS-CHANGED
  8022         GO TO 0330-EDIT.
  8023
  8024     IF  EIBAID EQUAL DFHPF3
  8025         IF  PI-NO-CARRIER-SECURITY
  8026                 AND
  8027             PI-NO-ACCOUNT-SECURITY
  8028             GO TO 5000-EDIT-MODE.
  8029
  8030     IF  EIBAID EQUAL DFHPF7
  8031         IF  PI-NO-CARRIER-SECURITY
  8032                 AND
  8033             PI-NO-ACCOUNT-SECURITY
  8034             GO TO 5400-LETTER-RELEASE
  8035         ELSE
  8036             IF  PI-689-PRINT-PERFORMED
  8037                 GO TO 5400-LETTER-RELEASE
  8038             ELSE
  8039                 MOVE AL-UNBON TO ENTERPFA
  8040                 MOVE -1       TO ENTERPFL
  8041                 MOVE ER-2398  TO EMI-ERROR
  8042                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8043                 GO TO 8200-SEND-DATAONLY.
  8044
  8045     IF  EIBAID = DFHPF4 OR DFHPF8
  8046         GO TO 7900-PRINT-LETTER-NOW.
  8047
  8048 0330-EDIT.
  8049
  8050     IF  W-SC-TEXTL (1) NOT EQUAL ZEROS
  8051             OR
  8052         W-SC-TEXTL (2) NOT EQUAL ZEROS
  8053             OR
  8054         W-SC-TEXTL (3) NOT EQUAL ZEROS
  8055             OR
  8056         W-SC-TEXTL (4) NOT EQUAL ZEROS
  8057             OR
  8058         W-SC-TEXTL (5) NOT EQUAL ZEROS
  8059             OR
  8060         W-SC-TEXTL (6) NOT EQUAL ZEROS
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 154
* EL689.cbl
  8061             OR
  8062         W-SC-TEXTL (7) NOT EQUAL ZEROS
  8063             OR
  8064         W-SC-TEXTL (8) NOT EQUAL ZEROS
  8065             OR
  8066         W-SC-TEXTL (9) NOT EQUAL ZEROS
  8067             OR
  8068         W-SC-TEXTL (10) NOT EQUAL ZEROS
  8069             OR
  8070         W-SC-TEXTL (11) NOT EQUAL ZEROS
  8071         IF  W-KEY-FIELDS-CHANGED
  8072                 OR
  8073             W-FORM-CHANGED
  8074             MOVE ER-7250        TO EMI-ERROR
  8075             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8076             MOVE -1             TO MAINTL
  8077             MOVE AL-UABON       TO MAINTA
  8078         ELSE
  8079             PERFORM 4100-SET-NDX THRU 4100-EXIT
  8080             PERFORM 4200-UPDATE-TABLE-FROM-SCREEN THRU 4200-EXIT
  8081                     VARYING
  8082                 W-SC-NDX FROM 1 BY 1
  8083                     UNTIL
  8084                 W-SC-NDX GREATER THAN W-NUM-LINES-PER-SCREEN
  8085             MOVE ER-7398        TO EMI-ERROR
  8086             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8087             MOVE -1             TO MAINTL
  8088             MOVE AL-UABON       TO MAINTA
  8089             GO TO 8200-SEND-DATAONLY.
  8090
  8091     PERFORM 0350-EDIT-ROUTINE THRU 0350-EXIT.
  8092
  8093     IF  W-KEY-FIELDS-CHANGED
  8094             OR
  8095         PI-689-KEY-DATA-FIELDS EQUAL LOW-VALUES OR SPACES
  8096         PERFORM 0800-EDIT-KEY-FIELDS THRU 0800-EXIT
  8097         IF  MAINTI EQUAL 'C'
  8098             GO TO 2000-CREATE
  8099         ELSE
  8100             NEXT SENTENCE
  8101     ELSE
  8102         IF  W-FORM-CHANGED
  8103             PERFORM 0800-EDIT-KEY-FIELDS THRU 0800-EXIT
  8104             IF  MAINTI EQUAL 'C'
  8105                 GO TO 2000-CREATE
  8106             ELSE
  8107                 NEXT SENTENCE
  8108         ELSE
  8109             MOVE -1             TO MAINTL
  8110             GO TO 8200-SEND-DATAONLY.
  8111
  8112     MOVE ER-0023                TO EMI-ERROR.
  8113     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8114     MOVE -1                     TO MAINTL.
  8115     MOVE AL-UABON               TO MAINTA.
  8116     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 155
* EL689.cbl
  8118 0350-EDIT-ROUTINE.
  8119
  8120     IF  MAINTI EQUAL 'C'
  8121             AND
  8122         FORML EQUAL ZEROS
  8123         MOVE -1                 TO FORML
  8124         MOVE ER-0177            TO EMI-ERROR
  8125         MOVE AL-UABON           TO FORMA
  8126         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8127
  8128     IF  PRTRESTL NOT EQUAL ZEROS
  8129         PERFORM 0360-EDIT-PRINT-RESTRICTIONS THRU 0360-EXIT.
  8130
  8131     IF  FOLLOWL NOT EQUAL ZEROS
  8132         MOVE FOLLOWI            TO W-DEEDIT-FIELD
  8133         PERFORM 8600-DEEDIT
  8134         MOVE W-DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
  8135         MOVE '4'                TO DC-OPTION-CODE
  8136         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  8137         IF  DATE-CONVERSION-ERROR
  8138             MOVE ER-0182        TO EMI-ERROR
  8139             MOVE -1             TO FOLLOWL
  8140             MOVE AL-UABON       TO FOLLOWA
  8141             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8142         ELSE
  8143             MOVE DC-GREG-DATE-1-EDIT
  8144                                 TO FOLLOWO
  8145                                    PI-689-FOLLOW-UP-EDIT
  8146             MOVE AL-UANON       TO FOLLOWA
  8147             MOVE DC-BIN-DATE-1  TO PI-689-FOLLOW-UP-DATE
  8148     ELSE
  8149         MOVE LOW-VALUES         TO PI-689-FOLLOW-UP-DATE.
  8150
  8151     IF  PI-689-FOLLOW-UP-DATE NOT EQUAL LOW-VALUES
  8152         IF  PI-689-FOLLOW-UP-DATE NOT GREATER THAN
  8153                 W-SAVE-BIN-DATE
  8154             MOVE ER-0533        TO EMI-ERROR
  8155             MOVE AL-UABON       TO FOLLOWA
  8156             MOVE -1             TO FOLLOWL
  8157             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8158
  8159     IF  RESEND1L NOT EQUAL ZEROS
  8160         MOVE RESEND1I           TO W-DEEDIT-FIELD
  8161         PERFORM 8600-DEEDIT
  8162         MOVE W-DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
  8163         MOVE '4'                TO DC-OPTION-CODE
  8164         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  8165         IF  DATE-CONVERSION-ERROR
  8166             MOVE ER-0185        TO EMI-ERROR
  8167             MOVE -1             TO RESEND1L
  8168             MOVE AL-UABON       TO RESEND1A
  8169             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8170         ELSE
  8171             MOVE DC-GREG-DATE-1-EDIT
  8172                                 TO RESEND1O
  8173                                    PI-689-RESEND1-EDIT
  8174             MOVE AL-UANON       TO RESEND1A
  8175             MOVE DC-BIN-DATE-1  TO PI-689-RESEND-DATE-1
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 156
* EL689.cbl
  8176     ELSE
  8177         MOVE LOW-VALUES         TO PI-689-RESEND-DATE-1.
  8178
  8179     IF  PI-689-RESEND-DATE-1 NOT EQUAL LOW-VALUES
  8180         IF  PI-689-RESEND-DATE-1 NOT GREATER THAN
  8181                 W-SAVE-BIN-DATE
  8182             MOVE ER-0537        TO EMI-ERROR
  8183             MOVE AL-UABON       TO RESEND1A
  8184             MOVE -1             TO RESEND1L
  8185             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8186
  8187     IF NOT PI-CREATE-LABELS
  8188         MOVE PI-LABEL-CONTROL   TO ADDRLBLI
  8189         MOVE AL-PANON           TO ADDRLBLA
  8190         GO TO 0350-BYPASS-OVERRIDE.
  8191
  8192     IF  ADDRLBLL GREATER THAN ZEROS
  8193          INSPECT ADDRLBLI CONVERTING W-LOWER-CASE TO W-UPPER-CASE
  8194          IF ADDRLBLI = 'N' OR 'Y'
  8195              MOVE ADDRLBLI      TO PI-689-LBL-OVERRIDE
  8196              MOVE AL-UANON      TO ADDRLBLA
  8197          ELSE
  8198             MOVE ER-3783        TO EMI-ERROR
  8199             MOVE -1             TO ADDRLBLL
  8200             MOVE AL-UABON       TO ADDRLBLA
  8201             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8202
  8203 0350-BYPASS-OVERRIDE.
  8204
  8205     IF  PI-BYPASS-LABELS
  8206             OR
  8207         FORMI EQUAL '9999'
  8208             OR
  8209         PI-689-LABELS-OVERRIDEN
  8210         MOVE SPACES             TO PI-689-LABEL-SOURCE
  8211         MOVE LOW-VALUES         TO ADDRSI
  8212         MOVE AL-UANOF           TO ADDRSA
  8213         MOVE ZEROS              TO ADDRSL
  8214     ELSE
  8215         IF  ADDRSL GREATER THAN ZEROS
  8216             MOVE ADDRSI         TO W-LABEL-SOURCE
  8217             IF  W-LABEL-SOURCE-VALID
  8218                 MOVE ADDRSI     TO PI-689-LABEL-SOURCE
  8219             ELSE
  8220                 MOVE -1         TO ADDRSL
  8221                 MOVE ER-0176    TO EMI-ERROR
  8222                 MOVE AL-UABON   TO ADDRSA
  8223                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8224         ELSE
  8225             IF  MAINTI EQUAL 'C'
  8226                 MOVE -1         TO ADDRSL
  8227                 MOVE ER-0176    TO EMI-ERROR
  8228                 MOVE AL-UABON   TO ADDRSA
  8229                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8230
  8231     MOVE SPACES                 TO PI-ALT-DMD-PRT-ID.
  8232     IF  PRINTERL GREATER ZERO
  8233         INSPECT PRINTERI CONVERTING W-LOWER-CASE TO W-UPPER-CASE
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 157
* EL689.cbl
  8234         MOVE AL-UANON           TO PRINTERA
  8235         MOVE PRINTERI           TO PI-689-ALT-PRINTER-ID
  8236                                    PI-ALT-DMD-PRT-ID
  8237     ELSE
  8238         IF  PI-NO-CARRIER-SECURITY
  8239                 AND
  8240             PI-NO-ACCOUNT-SECURITY
  8241             IF  PI-PROCESSOR-PRINTER GREATER THAN SPACES
  8242                 MOVE PI-PROCESSOR-PRINTER
  8243                                 TO PI-689-ALT-PRINTER-ID
  8244                                    PRINTERI
  8245                 MOVE AL-UABON   TO PRINTERA
  8246             ELSE
  8247                 MOVE PI-COMPANY-ID
  8248                                 TO W-CNTL-COMPANY-ID
  8249                 MOVE '1'        TO W-CNTL-RECORD-TYPE
  8250                 MOVE SPACES     TO W-CNTL-GENL
  8251                 MOVE ZEROS      TO W-CNTL-SEQ-NO
  8252
  8253* EXEC CICS HANDLE CONDITION
  8254*                     NOTOPEN    (8040-CNTL-NOT-OPEN)
  8255*                     NOTFND     (7945-NOT-FOUND)
  8256*                END-EXEC
  8257*    MOVE '"$JI                  ! $ #00008191' TO DFHEIV0
  8258     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  8259     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8260     MOVE X'2420233030303038313931' TO DFHEIV0(25:11)
  8261     CALL 'kxdfhei1' USING DFHEIV0
  8262     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8263
  8264* EXEC CICS READ
  8265*                     DATASET    (W-CNTL-FILE-ID)
  8266*                     SET        (ADDRESS OF CONTROL-FILE)
  8267*                     RIDFLD     (W-CNTL-KEY)
  8268*                END-EXEC
  8269*    MOVE '&"S        E          (   #00008195' TO DFHEIV0
  8270     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8271     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8272     MOVE X'2020233030303038313935' TO DFHEIV0(25:11)
  8273     CALL 'kxdfhei1' USING DFHEIV0,
  8274           W-CNTL-FILE-ID,
  8275           DFHEIV20,
  8276           DFHEIV99,
  8277           W-CNTL-KEY,
  8278           DFHEIV99,
  8279           DFHEIV99,
  8280           DFHEIV99
  8281     SET ADDRESS OF CONTROL-FILE TO
  8282         DFHEIV20
  8283     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8284                 MOVE CF-FORMS-PRINTER-ID
  8285                                 TO PI-689-ALT-PRINTER-ID
  8286                                    PRINTERI
  8287                                    W-TS-TERM-TEXT
  8288                 MOVE AL-UABON   TO PRINTERA
  8289         ELSE
  8290             MOVE AL-UABON       TO PRINTERA
  8291             MOVE -1             TO PRINTERL
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 158
* EL689.cbl
  8292             MOVE ER-9283        TO EMI-ERROR
  8293             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8294
  8295     IF  COPIESL NOT EQUAL ZEROS
  8296         IF  COPIESI NOT NUMERIC
  8297                 OR
  8298             COPIESI EQUAL '0'
  8299             MOVE ER-0184        TO EMI-ERROR
  8300             MOVE -1             TO COPIESL
  8301             MOVE AL-UABON       TO COPIESA
  8302             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8303         ELSE
  8304             MOVE COPIESI        TO PI-689-NUMBER-COPIES
  8305             MOVE AL-UANON       TO COPIESA
  8306     ELSE
  8307         IF FORMI EQUAL '9999'
  8308             MOVE 1              TO PI-689-NUMBER-COPIES
  8309                                    COPIESL
  8310                                    COPIESO.
  8311
  8312     IF  FORML NOT EQUAL ZEROS
  8313         INSPECT FORMI CONVERTING W-LOWER-CASE TO W-UPPER-CASE
  8314         MOVE FORMI              TO PI-689-FORM-NUMBER.
  8315
  8316     MOVE SPACES                 TO W-HOLD-IND.
  8317
  8318     IF  NOT EMI-NO-ERRORS
  8319         IF  EMI-ERROR EQUAL ER-7250
  8320             GO TO 0350-EXIT
  8321         ELSE
  8322            MOVE -1             TO MAINTL
  8323            GO TO 8200-SEND-DATAONLY.
  8324
  8325 0350-EXIT.
  8326      EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 159
* EL689.cbl
  8328 0360-EDIT-PRINT-RESTRICTIONS.
  8329
  8330     INSPECT PRTRESTI CONVERTING W-LOWER-CASE
  8331                                 TO W-UPPER-CASE.
  8332
  8333     IF  (PI-689-PRINT-RESTRICTION EQUAL ' ' OR 'F'
  8334                                      OR 'P' OR LOW-VALUES)
  8335             AND
  8336         PRTRESTI EQUAL 'C'
  8337             AND
  8338         PI-689-CONTROL NOT GREATER THAN ZEROS
  8339         MOVE ER-7243            TO EMI-ERROR
  8340         MOVE -1                 TO PRTRESTL
  8341         MOVE AL-UABON           TO PRTRESTA
  8342         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8343         GO TO 0360-EXIT.
  8344
  8345     IF  PRTRESTL NOT EQUAL ZEROS
  8346         IF PRTRESTI = 'C' OR 'F' OR 'P'
  8347             MOVE PRTRESTI       TO PI-689-PRINT-RESTRICTION
  8348             MOVE AL-UANON       TO PRTRESTA
  8349         ELSE
  8350             IF  PRTRESTI EQUAL ' '
  8351                 MOVE SPACES     TO PI-689-PRINT-RESTRICTION
  8352                 MOVE AL-UANON   TO PRTRESTA
  8353             ELSE
  8354                 MOVE ER-7393    TO EMI-ERROR
  8355                 MOVE -1         TO PRTRESTL
  8356                 MOVE AL-UABON   TO PRTRESTA
  8357                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8358
  8359     IF  PI-689-PRINT-RESTRICTION EQUAL 'C'
  8360             AND
  8361         W-HOLD-ON
  8362             AND
  8363         PI-689-CONTROL NOT GREATER THAN ZEROS
  8364         MOVE ER-7243            TO EMI-ERROR
  8365         MOVE -1                 TO PRTRESTL
  8366         MOVE AL-UABON           TO PRTRESTA
  8367         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8368
  8369 0360-EXIT.
  8370      EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 160
* EL689.cbl
  8372 0400-EL6311-INCOMING.
  8373
  8374     MOVE ZEROS                  TO PI-CURRENT-LINE
  8375                                    PI-TEMP-STOR-ITEMS
  8376                                    PI-TOTAL-LINES
  8377                                    PI-UPDATE-SW
  8378                                    PI-689-NUMBER-LABEL-LINES
  8379                                    PI-689-ERROR
  8380                                    PI-689-NUMBER-TEXT-RECORDS.
  8381     MOVE SPACES                 TO PI-689-PRINT-SW
  8382                                    PI-689-ALT-PRINTER-ID
  8383                                    PI-COMM-CONTROL
  8384                                    PI-689-FORM-NUMBER
  8385                                    PI-689-TEMP-STOR-ID
  8386                                    PI-689-LABEL-SOURCE
  8387                                    PI-689-USE-SCREEN-IND.
  8388
  8389     IF PI-CREATE-LABELS
  8390         MOVE  AL-UANON          TO ADDRLBLA
  8391         MOVE  +1                TO ADDRLBLL.
  8392
  8393     MOVE PI-LABEL-CONTROL       TO ADDRLBLI
  8394                                    PI-689-LBL-OVERRIDE.
  8395
  8396     MOVE PI-LOWER-CASE-LETTERS  TO W-LC-CASE-IND.
  8397     MOVE '2'                    TO PI-ACTION.
  8398     MOVE -1                     TO MAINTL.
  8399
  8400     IF  PI-689-CARRIER NOT EQUAL LOW-VALUES
  8401         MOVE AL-UANON           TO CARRIERA
  8402         MOVE +1                 TO CARRIERL
  8403         MOVE PI-689-CARRIER     TO CARRIERI.
  8404
  8405     IF  PI-689-GROUPING NOT EQUAL LOW-VALUES
  8406         MOVE +6                 TO GROUPL
  8407         MOVE AL-UANON           TO GROUPA
  8408         MOVE PI-689-GROUPING    TO GROUPI.
  8409
  8410     IF  PI-689-STATE NOT EQUAL LOW-VALUES
  8411         MOVE +2                 TO STATEL
  8412         MOVE AL-UANON           TO STATEA
  8413         MOVE PI-689-STATE       TO STATEI.
  8414
  8415     IF  PI-689-ACCOUNT NOT EQUAL LOW-VALUES
  8416         MOVE +10                TO ACCTL
  8417         MOVE AL-UANON           TO ACCTA
  8418         MOVE PI-689-ACCOUNT     TO ACCTI.
  8419
  8420     IF  PI-689-CERT-PRIME NOT EQUAL LOW-VALUES
  8421         MOVE +10                TO CERTL
  8422         MOVE AL-UANON           TO CERTA
  8423         MOVE PI-689-CERT-PRIME  TO CERTI.
  8424
  8425     IF  PI-689-CERT-SFX NOT EQUAL LOW-VALUES
  8426         MOVE +1                 TO SFXL
  8427         MOVE AL-UANON           TO SFXA
  8428         MOVE PI-689-CERT-SFX    TO SFXI.
  8429
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 161
* EL689.cbl
  8430     IF  PI-689-ENTRY-BATCH NOT EQUAL LOW-VALUES
  8431         MOVE +6                 TO BENTRYL
  8432         MOVE AL-UANON           TO BENTRYA
  8433         MOVE PI-689-ENTRY-BATCH TO BENTRYI.
  8434
  8435     MOVE +4                     TO BCSEQL.
  8436     MOVE AL-UANON               TO BCSEQA.
  8437     MOVE PI-689-CHG-SEQ-NO      TO BCSEQI.
  8438
  8439     IF  PI-689-SEQ-NO NOT EQUAL ZEROS
  8440         MOVE +8                 TO SEQL
  8441         MOVE AL-UANON           TO SEQA
  8442         MOVE PI-689-SEQ-NO      TO SEQI.
  8443
  8444     IF  PI-689-EFF-DATE NOT EQUAL LOW-VALUES
  8445         MOVE PI-689-EFF-DATE    TO DC-BIN-DATE-1
  8446         MOVE ' '                TO DC-OPTION-CODE
  8447         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  8448         MOVE +8                 TO DATEL
  8449         MOVE DC-GREG-DATE-1-EDIT
  8450                                 TO DATEI
  8451         MOVE AL-UANON           TO DATEA.
  8452
  8453     MOVE -1                     TO MAINTL.
  8454     MOVE '4'                    TO DATASORI
  8455                                    PI-689-DATA-SOURCE.
  8456     MOVE +1                     TO DATASORL.
  8457     MOVE AL-UANON               TO DATASORA.
  8458
  8459     GO TO 8100-SEND-INITIAL-MAP.
  8460
  8461 0400-EXIT.
  8462      EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 162
* EL689.cbl
  8464 0450-SPECIAL-INPUT-PROCESS.
  8465
  8466     IF  PI-RETURN-TO-PROGRAM EQUAL 'EL6501'
  8467             AND
  8468         PI-CARRIER GREATER THAN LOW-VALUES
  8469         MOVE '1'                TO DATASORI
  8470                                    PI-689-DATA-SOURCE
  8471         MOVE PI-CARRIER         TO CARRIERI
  8472         MOVE PI-GROUPING        TO GROUPI
  8473         MOVE PI-STATE           TO STATEI
  8474         MOVE PI-ACCOUNT         TO ACCTI
  8475         MOVE PI-CERT-EFF-DT     TO DC-BIN-DATE-1
  8476         MOVE ' '                TO DC-OPTION-CODE
  8477         PERFORM 9500-LINK-DATE-CONVERT
  8478             THRU 9500-EXIT
  8479         MOVE DC-GREG-DATE-1-EDIT
  8480                                 TO DATEI
  8481         MOVE AL-UANON           TO ACCTA
  8482                                    CARRIERA
  8483                                    DATEA
  8484                                    DATASORA
  8485                                    GROUPA
  8486                                    STATEA
  8487         MOVE +1                 TO CARRIERL
  8488                                    DATASORL
  8489         MOVE -1                 TO MAINTL
  8490         MOVE +6                 TO GROUPL
  8491         MOVE +2                 TO STATEL
  8492         MOVE +8                 TO DATEL
  8493         MOVE +10                TO ACCTL
  8494     ELSE
  8495         IF  PI-RETURN-TO-PROGRAM EQUAL 'EL652'
  8496                 AND
  8497             PI-CARRIER GREATER THAN LOW-VALUES
  8498             MOVE '3'            TO DATASORI
  8499                                    PI-689-DATA-SOURCE
  8500             MOVE PI-CR-CARRIER  TO CARRIERI
  8501             MOVE PI-CR-GROUPING TO GROUPI
  8502             MOVE PI-CR-ACCOUNT  TO ACCTI
  8503             MOVE PI-CR-FIN-RESP TO RPERSONI
  8504             MOVE PI-CR-TYPE     TO TYPEI
  8505             MOVE AL-UANON       TO CARRIERA
  8506                                    GROUPA
  8507                                    ACCTA
  8508                                    DATASORA
  8509                                    RPERSONA
  8510                                    TYPEA
  8511             MOVE +1             TO CARRIERL
  8512                                    DATASORL
  8513                                    TYPEL
  8514             MOVE -1             TO MAINTL
  8515             MOVE +6             TO GROUPL
  8516             MOVE +10            TO ACCTL
  8517                                    RPERSONL
  8518         ELSE
  8519             IF  PI-RETURN-TO-PROGRAM EQUAL 'EL1273'
  8520                     AND
  8521                 PI-CARRIER GREATER THAN LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 163
* EL689.cbl
  8522                 MOVE '2'        TO DATASORI
  8523                                    PI-689-DATA-SOURCE
  8524                 MOVE PI-CARRIER TO CARRIERI
  8525                 MOVE PI-GROUPING
  8526                                 TO GROUPI
  8527                 MOVE PI-STATE   TO STATEI
  8528                 MOVE PI-ACCOUNT TO ACCTI
  8529                 MOVE PI-CERT-PRIME
  8530                                 TO CERTI
  8531                 MOVE PI-CERT-SFX
  8532                                 TO SFXI
  8533                 MOVE PI-CERT-EFF-DT
  8534                                 TO DC-BIN-DATE-1
  8535                 MOVE ' '        TO DC-OPTION-CODE
  8536                 PERFORM 9500-LINK-DATE-CONVERT
  8537                     THRU 9500-EXIT
  8538                 MOVE DC-GREG-DATE-1-EDIT
  8539                                 TO DATEI
  8540                 MOVE AL-UANON   TO CARRIERA
  8541                                    GROUPA
  8542                                    STATEA
  8543                                    ACCTA
  8544                                    CERTA
  8545                                    SFXA
  8546                                    DATEA
  8547                                    ADDRSA
  8548                                    DATASORA
  8549                 MOVE +1         TO CARRIERL
  8550                                    SFXL
  8551                                    DATASORL
  8552                                    ADDRSL
  8553                 MOVE -1         TO MAINTL
  8554                 MOVE +6         TO GROUPL
  8555                 MOVE +2         TO STATEL
  8556                 MOVE +8         TO DATEL
  8557                 MOVE +10        TO ACCTL
  8558                                    CERTL.
  8559
  8560     IF PI-CREATE-LABELS
  8561         MOVE  AL-UANON          TO ADDRLBLA
  8562         MOVE  +1                TO ADDRLBLL.
  8563
  8564     MOVE PI-LABEL-CONTROL       TO ADDRLBLI
  8565                                    PI-689-LBL-OVERRIDE.
  8566
  8567     MOVE LOW-VALUES             TO PI-689-KEY-DATA-FIELDS.
  8568     GO TO 8100-SEND-INITIAL-MAP.
  8569
  8570 0450-EXIT.
  8571      EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 164
* EL689.cbl
  8573 0600-BYPASS-SCREEN-CNTL.
  8574***************************************************************
  8575*     THIS ROUTINE WILL PROCESS A NEW LETTER REQUIREMENT      *
  8576*     WITH THE INFORMATION FOUND IN THE PI AREA WITHOUT       *
  8577*     PERFORMING ANY SCREEN IO.                               *
  8578***************************************************************
  8579
  8580
  8581* EXEC CICS HANDLE CONDITION
  8582*        PGMIDERR (9700-PGMID-ERROR)
  8583*        MAPFAIL  (0325-MAPFAIL)
  8584*        ERROR    (9800-ABEND)
  8585*    END-EXEC.
  8586*    MOVE '"$L?.                 ! % #00008496' TO DFHEIV0
  8587     MOVE X'22244C3F2E20202020202020' TO DFHEIV0(1:12)
  8588     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8589     MOVE X'2520233030303038343936' TO DFHEIV0(25:11)
  8590     CALL 'kxdfhei1' USING DFHEIV0
  8591     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8592
  8593
  8594     MOVE LOW-VALUES             TO EL689AI.
  8595
  8596     MOVE W-THIS-PGM             TO PI-CALLING-PROGRAM
  8597
  8598     MOVE PI-689-FORM-NUMBER     TO FORMI.
  8599     MOVE +4                     TO FORML.
  8600
  8601     IF  PI-689-NUMBER-COPIES GREATER THAN ZERO
  8602         MOVE PI-689-NUMBER-COPIES
  8603                                 TO COPIESI
  8604         MOVE +1                 TO COPIESL.
  8605
  8606     MOVE PI-689-LABEL-SOURCE    TO ADDRSI.
  8607     MOVE +1                     TO ADDRSL.
  8608     MOVE PI-689-DATA-SOURCE     TO DATASORI.
  8609     MOVE +1                     TO DATASORL.
  8610
  8611     IF  PI-689-PRINT-RESTRICTION = 'C' OR 'F' OR 'P'
  8612         MOVE PI-689-PRINT-RESTRICTION
  8613                                 TO PRTRESTI
  8614         MOVE +1                 TO PRTRESTL.
  8615
  8616     MOVE SPACES                 TO PI-689-PRINT-SW
  8617                                    PI-689-LBL-OVERRIDE.
  8618     MOVE ZEROS                  TO PI-TOTAL-LINES
  8619                                    PI-CURRENT-LINE
  8620                                    PI-TEMP-STOR-ITEMS
  8621                                    PI-UPDATE-SW
  8622                                    PI-689-ERROR
  8623                                    PI-689-NUMBER-LABEL-LINES
  8624                                    PI-689-NUMBER-TEXT-RECORDS.
  8625
  8626     IF  PI-689-ALT-PRINTER-ID NOT EQUAL LOW-VALUES
  8627         MOVE +4                 TO PRINTERL
  8628         MOVE PI-689-ALT-PRINTER-ID
  8629                                 TO PRINTERI PI-ALT-DMD-PRT-ID.
  8630
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 165
* EL689.cbl
  8631     MOVE SPACES                 TO PI-689-ALT-PRINTER-ID.
  8632
  8633     IF  PI-689-SOURCE-VARIABLE
  8634         PERFORM 0700-GET-VARIABLE-LABEL THRU 0700-EXIT.
  8635
  8636     MOVE SPACES                 TO W-CNTL-KEY
  8637     MOVE LOW-VALUES             TO W-ACCT-KEY
  8638                                    W-CERT-KEY
  8639                                    W-CHEK-KEY
  8640                                    W-COMP-KEY
  8641                                    W-MAIL-KEY
  8642                                    W-PNDB-KEY
  8643                                    W-PNDB2-KEY
  8644                                    W-PYAJ-KEY.
  8645
  8646     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID.
  8647     MOVE PI-COMPANY-CD          TO W-ACCT-COMPANY-CD
  8648                                    W-CERT-COMPANY-CD
  8649                                    W-CHEK-COMPANY-CD
  8650                                    W-COMP-COMPANY-CD
  8651                                    W-MAIL-COMPANY-CD
  8652                                    W-PNDB-COMPANY-CD
  8653                                    W-PNDB2-COMPANY-CD
  8654                                    W-PYAJ-COMPANY-CD.
  8655
  8656     IF  PI-689-CARRIER GREATER THAN LOW-VALUES
  8657         MOVE PI-689-CARRIER     TO W-ACCT-CARRIER
  8658                                    W-CERT-CARRIER
  8659                                    W-MAIL-CARRIER
  8660                                    W-CERT-CARRIER
  8661                                    W-COMP-CARRIER
  8662                                    W-CHEK-CARRIER
  8663                                    W-PNDB2-CARRIER
  8664                                    W-PYAJ-CARRIER.
  8665
  8666     IF  PI-689-GROUPING GREATER THAN LOW-VALUES
  8667         MOVE PI-689-GROUPING    TO W-ACCT-GROUPING
  8668                                    W-CERT-GROUPING
  8669                                    W-CHEK-GROUPING
  8670                                    W-COMP-GROUPING
  8671                                    W-MAIL-GROUPING
  8672                                    W-PNDB2-GROUPING
  8673                                    W-PYAJ-GROUPING.
  8674
  8675     IF  PI-689-STATE GREATER THAN LOW-VALUES
  8676         MOVE PI-689-STATE       TO W-ACCT-STATE
  8677                                    W-CERT-STATE
  8678                                    W-CHEK-STATE
  8679                                    W-MAIL-STATE
  8680                                    W-PNDB2-STATE.
  8681
  8682     IF  PI-689-ACCOUNT GREATER THAN LOW-VALUES
  8683         IF PI-689-DATA-SOURCE = '3' OR '6'
  8684             MOVE PI-689-ACCOUNT TO W-COMP-ACCOUNT
  8685                                    W-PYAJ-ACCOUNT
  8686         ELSE
  8687             MOVE PI-689-ACCOUNT TO W-ACCT-ACCOUNT
  8688                                    W-CERT-ACCOUNT
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 166
* EL689.cbl
  8689                                    W-CHEK-ACCOUNT
  8690                                    W-MAIL-ACCOUNT
  8691                                    W-PNDB2-ACCOUNT.
  8692
  8693     IF  PI-689-EFF-DATE GREATER THAN LOW-VALUES
  8694         MOVE PI-689-EFF-DATE    TO W-CERT-EFF-DT
  8695                                    W-CHEK-EFF-DT
  8696                                    W-MAIL-EFF-DT
  8697                                    W-PNDB2-EFF-DT.
  8698
  8699     IF  PI-689-CERT-PRIME GREATER THAN LOW-VALUES
  8700         MOVE PI-689-CERT-PRIME  TO W-CERT-CERT-PRIME
  8701                                    W-CHEK-CERT-PRIME
  8702                                    W-MAIL-CERT-PRIME
  8703                                    W-PNDB2-CERT-PRIME
  8704
  8705         IF  PI-689-CERT-SFX GREATER THAN LOW-VALUES
  8706             MOVE PI-689-CERT-SFX
  8707                                 TO W-CERT-CERT-SFX
  8708                                    W-CHEK-CERT-SFX
  8709                                    W-MAIL-CERT-SFX
  8710                                    W-PNDB2-CERT-SFX
  8711         ELSE
  8712             MOVE SPACES         TO W-CERT-CERT-SFX
  8713                                    W-CHEK-CERT-SFX
  8714                                    W-MAIL-CERT-SFX
  8715                                    W-PNDB2-CERT-SFX.
  8716
  8717     IF  PI-689-RESP-PERSON GREATER THAN LOW-VALUES
  8718         IF PI-689-DATA-SOURCE = '3' OR '6'
  8719             MOVE PI-689-RESP-PERSON
  8720                                 TO W-COMP-RESP-PERSON
  8721                                    W-PYAJ-FIN-RESP.
  8722
  8723     IF  PI-689-TYPE GREATER THAN LOW-VALUES
  8724         IF PI-689-DATA-SOURCE = '3' OR '6'
  8725             MOVE PI-689-TYPE    TO W-COMP-TYPE
  8726                                    W-PYAJ-RECORD-TYPE
  8727         ELSE
  8728             MOVE PI-689-TYPE    TO W-PNDB2-TYPE.
  8729
  8730     IF  PI-689-SEQ-NO GREATER THAN ZEROS
  8731         MOVE PI-689-SEQ-NO      TO W-PNDB-SEQ-NO
  8732                                    W-PYAJ-FILE-SEQ-NO
  8733                                    W-CHEK-SEQ-NO.
  8734
  8735     IF  PI-689-CHG-SEQ-NO GREATER THAN ZEROS
  8736         MOVE PI-689-CHG-SEQ-NO  TO W-PNDB-CHG-SEQ-NO
  8737                                    W-PNDB2-ALT-CHG-SEQ-NO.
  8738
  8739     IF  PI-689-ENTRY-BATCH GREATER THAN LOW-VALUES
  8740         MOVE PI-689-ENTRY-BATCH TO W-PNDB-ENTRY.
  8741
  8742     IF  PI-689-NO-ERRORS-DETECTED
  8743         PERFORM 2000-CREATE THRU 2000-EXIT
  8744         IF  NOT PI-689-FATAL-ERROR
  8745                 AND
  8746             NOT PI-689-ERR-DETECTED-PREV
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 167
* EL689.cbl
  8747             IF  PI-689-PRINT-ONLY
  8748                 PERFORM 7900-PRINT-LETTER-NOW THRU 7900-EXIT
  8749             ELSE
  8750                 IF  PI-689-PRINT-FIRST
  8751                     PERFORM 7900-PRINT-LETTER-NOW THRU 7900-EXIT
  8752                     IF  NOT PI-689-FATAL-ERROR
  8753                         IF  PI-689-ARCHIVE-LETTER
  8754                             PERFORM 5400-LETTER-RELEASE
  8755                                 THRU 5400-EXIT
  8756                         ELSE
  8757                             MOVE ER-7390
  8758                                 TO PI-689-ERROR
  8759                     ELSE
  8760                         NEXT SENTENCE
  8761                 ELSE
  8762                     IF  NOT PI-689-ARCHIVE-LETTER
  8763                         MOVE ER-7390
  8764                                 TO PI-689-ERROR
  8765                     ELSE
  8766                         PERFORM 5400-LETTER-RELEASE
  8767                             THRU 5400-EXIT
  8768                         IF  NOT PI-689-FATAL-ERROR
  8769                             IF  PI-689-PRINT-SECOND
  8770                                 PERFORM 7900-PRINT-LETTER-NOW
  8771                                     THRU 7900-EXIT.
  8772
  8773 0600-EXIT.
  8774     EXIT.
  8775
  8776 0620-RETURN-TO-CALLER.
  8777
  8778     MOVE PROGRAM-INTERFACE-BLOCK
  8779                                 TO DFHCOMMAREA.
  8780
  8781* EXEC CICS RETURN
  8782*    END-EXEC.
  8783*    MOVE '.(                    &   #00008688' TO DFHEIV0
  8784     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  8785     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8786     MOVE X'2020233030303038363838' TO DFHEIV0(25:11)
  8787     CALL 'kxdfhei1' USING DFHEIV0,
  8788           DFHEIV99,
  8789           DFHEIV99,
  8790           DFHEIV99,
  8791           DFHEIV99,
  8792           DFHEIV99
  8793     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8794
  8795
  8796 0700-GET-VARIABLE-LABEL.
  8797
  8798     IF  PI-689-VARIABLE-DATA-1 NOT GREATER THAN SPACES
  8799         MOVE '(VARIABLE NOT PROVIDED)'
  8800                                 TO W-RC-TEXT (1)
  8801                                    W-VG-TEXT (48)
  8802         GO TO 0700-EXIT.
  8803
  8804     MOVE PI-689-VARIABLE-DATA-1 TO W-RC-TEXT (1)
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 168
* EL689.cbl
  8805                                    W-VG-TEXT (48).
  8806     MOVE PI-689-VARIABLE-DATA-2 TO W-RC-TEXT (2)
  8807                                    W-VG-TEXT (49).
  8808     MOVE PI-689-VARIABLE-DATA-3 TO W-RC-TEXT (3)
  8809                                    W-VG-TEXT (50).
  8810     MOVE PI-689-VARIABLE-DATA-4 TO W-RC-TEXT (4)
  8811                                    W-VG-TEXT (51).
  8812     SET W-RG-NDX                TO +5.
  8813
  8814 0700-EXIT.
  8815     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 169
* EL689.cbl
  8817 0800-EDIT-KEY-FIELDS.
  8818***************************************************************
  8819*     THIS ROUTINE WILL DECIDE WHAT FIELDS ARE NECESSARY      *
  8820*     FROM THE DATA SOURCE FIELD.  IF A NECESSARY FIELD       *
  8821*     IS NOT PROVIDED AN ERROR WILL PREVENT FURTHER           *
  8822*     PROCESSING.                                             *
  8823***************************************************************
  8824     MOVE SPACES                 TO W-CNTL-KEY
  8825     MOVE LOW-VALUES             TO W-ACCT-KEY
  8826                                    W-CERT-KEY
  8827                                    W-CHEK-KEY
  8828                                    W-COMP-KEY
  8829                                    W-MAIL-KEY
  8830                                    W-PNDB-KEY
  8831                                    W-PNDB2-KEY
  8832                                    W-PYAJ-KEY.
  8833
  8834     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID.
  8835     MOVE PI-COMPANY-CD          TO W-ACCT-COMPANY-CD
  8836                                    W-CERT-COMPANY-CD
  8837                                    W-CHEK-COMPANY-CD
  8838                                    W-COMP-COMPANY-CD
  8839                                    W-MAIL-COMPANY-CD
  8840                                    W-PNDB-COMPANY-CD
  8841                                    W-PNDB2-COMPANY-CD
  8842                                    W-PYAJ-COMPANY-CD.
  8843
  8844     PERFORM 0900-EDIT-CARRIER THRU 0900-EXIT.
  8845     PERFORM 0905-EDIT-GROUPING THRU 0905-EXIT.
  8846     PERFORM 0910-EDIT-STATE THRU 0910-EXIT.
  8847     PERFORM 0915-EDIT-ACCOUNT THRU 0915-EXIT.
  8848     PERFORM 0920-EDIT-EXP-DATE THRU 0920-EXIT.
  8849     PERFORM 0925-EDIT-EFF-DATE THRU 0925-EXIT.
  8850     PERFORM 0930-EDIT-CERTIFICATE THRU 0930-EXIT.
  8851     PERFORM 0935-EDIT-RESP-PERSON THRU 0935-EXIT.
  8852     PERFORM 0940-EDIT-ACCOUNT THRU 0940-EXIT.
  8853     PERFORM 0945-EDIT-TYPE THRU 0945-EXIT.
  8854     PERFORM 0950-EDIT-ENTRY THRU 0950-EXIT.
  8855     PERFORM 0955-EDIT-SEQUENCE THRU 0955-EXIT.
  8856     PERFORM 0960-EDIT-BATCH-SEQ THRU 0960-EXIT.
  8857     PERFORM 0965-EDIT-TYPE THRU 0965-EXIT.
  8858
  8859     IF  DATASORI NUMERIC
  8860         MOVE DATASORI           TO W-DATA-SOURCE
  8861                                    PI-689-DATA-SOURCE
  8862         GO TO 0800-SOURCE-ACCOUNT
  8863               0800-SOURCE-CERTIFICATE
  8864               0800-SOURCE-COMPENSATION
  8865               0800-SOURCE-PENDING
  8866               0800-SOURCE-CHEK
  8867               0800-SOURCE-PAYMENTS-ADJS
  8868                                 DEPENDING ON W-DATA-SOURCE.
  8869
  8870     IF  FORMI NOT EQUAL '9999'
  8871         MOVE ER-7365            TO EMI-ERROR
  8872         MOVE -1                 TO MAINTL
  8873         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8874         GO TO 8200-SEND-DATAONLY
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 170
* EL689.cbl
  8875
  8876     ELSE
  8877         GO TO 0800-EXIT.
  8878
  8879 0800-SOURCE-ACCOUNT.
  8880
  8881     IF  W-ACCT-COMPANY-CD EQUAL LOW-VALUES
  8882             OR
  8883         W-ACCT-CARRIER EQUAL LOW-VALUES
  8884             OR
  8885         W-ACCT-GROUPING EQUAL LOW-VALUES
  8886             OR
  8887         W-ACCT-STATE EQUAL LOW-VALUES
  8888             OR
  8889         W-ACCT-ACCOUNT EQUAL LOW-VALUES
  8890             OR
  8891         W-ACCT-EXP-DT EQUAL LOW-VALUES
  8892         MOVE ER-7376            TO EMI-ERROR
  8893         MOVE -1                 TO MAINTL
  8894         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8895
  8896     GO TO 0800-ERROR-TEST.
  8897
  8898 0800-SOURCE-CERTIFICATE.
  8899
  8900     IF  W-CERT-COMPANY-CD EQUAL LOW-VALUES
  8901             OR
  8902         W-CERT-CARRIER EQUAL LOW-VALUES
  8903             OR
  8904         W-CERT-GROUPING EQUAL LOW-VALUES
  8905             OR
  8906         W-CERT-STATE EQUAL LOW-VALUES
  8907             OR
  8908         W-CERT-ACCOUNT EQUAL LOW-VALUES
  8909             OR
  8910         W-CERT-EFF-DT EQUAL LOW-VALUES
  8911             OR
  8912         W-CERT-CERT-NO EQUAL LOW-VALUES
  8913         MOVE ER-7377            TO EMI-ERROR
  8914         MOVE -1                 TO MAINTL
  8915         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8916
  8917     GO TO 0800-ERROR-TEST.
  8918
  8919 0800-SOURCE-COMPENSATION.
  8920
  8921     IF  W-COMP-COMPANY-CD EQUAL LOW-VALUES
  8922             OR
  8923         W-COMP-CARRIER EQUAL LOW-VALUES
  8924             OR
  8925         W-COMP-GROUPING EQUAL LOW-VALUES
  8926             OR
  8927         W-COMP-RESP-PERSON EQUAL LOW-VALUES
  8928             OR
  8929         W-COMP-TYPE EQUAL LOW-VALUES
  8930             OR
  8931         (W-COMP-TYPE EQUAL 'A'
  8932                 AND
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 171
* EL689.cbl
  8933             W-COMP-ACCOUNT EQUAL LOW-VALUES)
  8934         MOVE ER-7378            TO EMI-ERROR
  8935         MOVE -1                 TO MAINTL
  8936         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8937
  8938     GO TO 0800-ERROR-TEST.
  8939
  8940 0800-SOURCE-PENDING.
  8941
  8942     IF  BENTRYL EQUAL ZEROS
  8943         IF  W-PNDB2-COMPANY-CD EQUAL LOW-VALUES
  8944                 OR
  8945             W-PNDB2-CARRIER EQUAL LOW-VALUES
  8946                 OR
  8947             W-PNDB2-GROUPING EQUAL LOW-VALUES
  8948                 OR
  8949             W-PNDB2-STATE EQUAL LOW-VALUES
  8950                 OR
  8951             W-PNDB2-ACCOUNT EQUAL LOW-VALUES
  8952                 OR
  8953             W-PNDB2-EFF-DT EQUAL LOW-VALUES
  8954                 OR
  8955             W-PNDB2-CERT-NO EQUAL LOW-VALUES
  8956                 OR
  8957             W-PNDB2-TYPE EQUAL LOW-VALUES
  8958                 OR
  8959             W-PNDB2-ALT-CHG-SEQ-NO NOT = ZEROS
  8960             MOVE ER-7379        TO EMI-ERROR
  8961             MOVE -1             TO MAINTL
  8962             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8963         ELSE
  8964             NEXT SENTENCE
  8965     ELSE
  8966         IF  W-PNDB-COMPANY-CD EQUAL LOW-VALUES
  8967                 OR
  8968             W-PNDB-ENTRY EQUAL LOW-VALUES
  8969                 OR
  8970             W-PNDB-SEQ-NO EQUAL ZEROS
  8971             MOVE ER-7379        TO EMI-ERROR
  8972             MOVE -1             TO MAINTL
  8973             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8974
  8975     GO TO 0800-ERROR-TEST.
  8976
  8977 0800-SOURCE-CHEK.
  8978
  8979     IF  W-CHEK-COMPANY-CD EQUAL LOW-VALUES
  8980             OR
  8981         W-CHEK-CARRIER EQUAL LOW-VALUES
  8982             OR
  8983         W-CHEK-GROUPING EQUAL LOW-VALUES
  8984             OR
  8985         W-CHEK-STATE EQUAL LOW-VALUES
  8986             OR
  8987         W-CHEK-ACCOUNT EQUAL LOW-VALUES
  8988             OR
  8989         W-CHEK-EFF-DT EQUAL LOW-VALUES
  8990             OR
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 172
* EL689.cbl
  8991         W-CHEK-CERT-NO EQUAL LOW-VALUES
  8992         MOVE ER-7381            TO EMI-ERROR
  8993         MOVE -1                 TO MAINTL
  8994         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8995
  8996     GO TO 0800-ERROR-TEST.
  8997
  8998 0800-SOURCE-PAYMENTS-ADJS.
  8999
  9000     IF  W-PYAJ-COMPANY-CD EQUAL LOW-VALUES
  9001             OR
  9002         W-PYAJ-CARRIER EQUAL LOW-VALUES
  9003             OR
  9004         W-PYAJ-GROUPING EQUAL LOW-VALUES
  9005             OR
  9006         W-PYAJ-FIN-RESP EQUAL LOW-VALUES
  9007             OR
  9008         W-PYAJ-ACCOUNT EQUAL LOW-VALUES
  9009             OR
  9010         W-PYAJ-RECORD-TYPE EQUAL LOW-VALUES
  9011         MOVE ER-7396            TO EMI-ERROR
  9012         MOVE -1                 TO MAINTL
  9013         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9014
  9015     GO TO 0800-ERROR-TEST.
  9016
  9017 0800-ERROR-TEST.
  9018
  9019     IF  NOT EMI-NO-ERRORS
  9020         IF  EMI-ERROR EQUAL ER-7250
  9021             GO TO 0800-EXIT
  9022         ELSE
  9023             GO TO 8200-SEND-DATAONLY.
  9024
  9025 0800-EXIT.
  9026     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 173
* EL689.cbl
  9028 0900-EDIT-CARRIER.
  9029
  9030     IF  CARRIERL EQUAL ZEROES
  9031         MOVE LOW-VALUES         TO PI-689-CARRIER
  9032                                    W-ACCT-CARRIER
  9033                                    W-CERT-CARRIER
  9034                                    W-COMP-CARRIER
  9035                                    W-CHEK-CARRIER
  9036                                    W-MAIL-CARRIER
  9037                                    W-PNDB2-CARRIER
  9038                                    W-PYAJ-CARRIER
  9039     ELSE
  9040         PERFORM 0990-CARRIER-VALIDITY-CHECK THRU 0990-EXIT.
  9041
  9042 0900-EXIT.
  9043     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 174
* EL689.cbl
  9045 0905-EDIT-GROUPING.
  9046
  9047     IF  GROUPL EQUAL ZEROES
  9048         MOVE LOW-VALUES         TO PI-689-GROUPING
  9049                                    W-ACCT-GROUPING
  9050                                    W-CERT-GROUPING
  9051                                    W-CHEK-GROUPING
  9052                                    W-COMP-GROUPING
  9053                                    W-MAIL-GROUPING
  9054                                    W-PNDB2-GROUPING
  9055                                    W-PYAJ-GROUPING
  9056     ELSE
  9057         MOVE AL-UANON           TO GROUPA
  9058         MOVE GROUPI             TO PI-689-GROUPING
  9059                                    W-ACCT-GROUPING
  9060                                    W-CERT-GROUPING
  9061                                    W-CHEK-GROUPING
  9062                                    W-COMP-GROUPING
  9063                                    W-MAIL-GROUPING
  9064                                    W-PNDB2-GROUPING
  9065                                    W-PYAJ-GROUPING.
  9066
  9067 0905-EXIT.
  9068     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 175
* EL689.cbl
  9070 0910-EDIT-STATE.
  9071
  9072     IF  STATEL EQUAL ZEROES
  9073         MOVE LOW-VALUES         TO PI-689-STATE
  9074                                    W-ACCT-STATE
  9075                                    W-CERT-STATE
  9076                                    W-CHEK-STATE
  9077                                    W-MAIL-STATE
  9078                                    W-PNDB2-STATE
  9079     ELSE
  9080         PERFORM 0994-STATE-VALIDITY-CHECK THRU 0994-EXIT.
  9081
  9082 0910-EXIT.
  9083     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 176
* EL689.cbl
  9085 0915-EDIT-ACCOUNT.
  9086
  9087     IF  ACCTL EQUAL ZEROES
  9088         MOVE LOW-VALUES         TO PI-689-ACCOUNT
  9089                                    W-ACCT-ACCOUNT
  9090                                    W-CERT-ACCOUNT
  9091                                    W-CHEK-ACCOUNT
  9092                                    W-COMP-ACCOUNT
  9093                                    W-MAIL-ACCOUNT
  9094                                    W-PNDB2-ACCOUNT
  9095                                    W-PYAJ-ACCOUNT
  9096     ELSE
  9097         MOVE AL-UANON           TO ACCTA
  9098         MOVE ACCTI              TO PI-689-ACCOUNT
  9099                                    W-ACCT-ACCOUNT
  9100                                    W-CERT-ACCOUNT
  9101                                    W-CHEK-ACCOUNT
  9102                                    W-COMP-ACCOUNT
  9103                                    W-MAIL-ACCOUNT
  9104                                    W-PYAJ-ACCOUNT
  9105                                    W-PNDB2-ACCOUNT.
  9106
  9107 0915-EXIT.
  9108     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 177
* EL689.cbl
  9110 0920-EDIT-EXP-DATE.
  9111
  9112     IF  DATEL NOT EQUAL ZEROS
  9113         IF  DATEI EQUAL '99/99/99' OR '999999'
  9114             MOVE '99/99/99'     TO DATEO
  9115                                    PI-689-DATE-EDIT
  9116             MOVE AL-UANON       TO DATEA
  9117             MOVE HIGH-VALUES    TO PI-689-EXP-DATE
  9118                                    W-ACCT-EXP-DT
  9119         ELSE
  9120             MOVE DATEI          TO W-DEEDIT-FIELD
  9121             PERFORM 8600-DEEDIT
  9122             MOVE W-DEEDIT-FIELD-V0
  9123                                 TO DC-GREG-DATE-1-MDY
  9124             MOVE '4'            TO DC-OPTION-CODE
  9125             PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  9126             IF  DATE-CONVERSION-ERROR
  9127                 MOVE ER-0454    TO EMI-ERROR
  9128                 MOVE -1         TO DATEL
  9129                 MOVE AL-UABON   TO DATEA
  9130                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9131             ELSE
  9132                 MOVE DC-GREG-DATE-1-EDIT
  9133                                 TO DATEO
  9134                                    PI-689-DATE-EDIT
  9135                 MOVE AL-UANON   TO DATEA
  9136                 MOVE DC-BIN-DATE-1
  9137                                 TO PI-689-EXP-DATE
  9138                                    W-ACCT-EXP-DT
  9139     ELSE
  9140         MOVE LOW-VALUES         TO PI-689-EXP-DATE
  9141                                    W-ACCT-EXP-DT
  9142                                    PI-689-DATE-EDIT.
  9143
  9144 0920-EXIT.
  9145     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 178
* EL689.cbl
  9147 0925-EDIT-EFF-DATE.
  9148
  9149     IF  CERTL EQUAL ZERO
  9150             AND
  9151         DATASORI NOT EQUAL '2'
  9152         GO TO 0925-EXIT.
  9153
  9154     IF  DATEL NOT EQUAL ZEROS
  9155         MOVE DATEI              TO W-DEEDIT-FIELD
  9156         PERFORM 8600-DEEDIT
  9157         MOVE W-DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
  9158         MOVE '4'                TO DC-OPTION-CODE
  9159         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  9160
  9161         IF  DATE-CONVERSION-ERROR
  9162             MOVE ER-0215        TO EMI-ERROR
  9163             MOVE -1             TO DATEL
  9164             MOVE AL-UABON       TO DATEA
  9165             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9166         ELSE
  9167             MOVE DC-GREG-DATE-1-EDIT
  9168                                 TO DATEO
  9169                                    PI-689-DATE-EDIT
  9170             MOVE AL-UANON       TO DATEA
  9171             MOVE DC-BIN-DATE-1  TO PI-689-EFF-DATE
  9172                                    W-CERT-EFF-DT
  9173                                    W-CHEK-EFF-DT
  9174                                    W-MAIL-EFF-DT
  9175                                    W-PNDB2-EFF-DT
  9176     ELSE
  9177         MOVE LOW-VALUES         TO PI-689-EFF-DATE
  9178                                    W-PNDB2-EFF-DT
  9179                                    W-CHEK-EFF-DT
  9180                                    W-MAIL-EFF-DT
  9181                                    W-CERT-EFF-DT
  9182                                    PI-689-DATE-EDIT.
  9183
  9184 0925-EXIT.
  9185     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 179
* EL689.cbl
  9187 0930-EDIT-CERTIFICATE.
  9188
  9189     IF  CERTL EQUAL ZEROES
  9190         MOVE LOW-VALUES         TO PI-689-CERT-PRIME
  9191                                    W-CERT-CERT-PRIME
  9192                                    W-CHEK-CERT-PRIME
  9193                                    W-MAIL-CERT-PRIME
  9194                                    W-PNDB2-CERT-PRIME
  9195                                    PI-689-CERT-SFX
  9196                                    W-CERT-CERT-SFX
  9197                                    W-CHEK-CERT-SFX
  9198                                    W-MAIL-CERT-SFX
  9199                                    W-PNDB2-CERT-SFX
  9200     ELSE
  9201         MOVE AL-UANON           TO CERTA
  9202         MOVE CERTI              TO PI-689-CERT-PRIME
  9203                                    W-CERT-CERT-PRIME
  9204                                    W-CHEK-CERT-PRIME
  9205                                    W-MAIL-CERT-PRIME
  9206                                    W-PNDB2-CERT-PRIME
  9207         IF  SFXL EQUAL ZEROES
  9208                 OR
  9209             SFXI EQUAL LOW-VALUES
  9210             MOVE SPACES         TO PI-689-CERT-SFX
  9211                                    W-CERT-CERT-SFX
  9212                                    W-CHEK-CERT-SFX
  9213                                    W-MAIL-CERT-SFX
  9214                                    W-PNDB2-CERT-SFX
  9215         ELSE
  9216             MOVE AL-UANON       TO SFXA
  9217             MOVE SFXI           TO PI-689-CERT-SFX
  9218                                    W-CERT-CERT-SFX
  9219                                    W-CHEK-CERT-SFX
  9220                                    W-MAIL-CERT-SFX
  9221                                    W-PNDB2-CERT-SFX.
  9222
  9223 0930-EXIT.
  9224     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 180
* EL689.cbl
  9226 0935-EDIT-RESP-PERSON.
  9227
  9228     IF  RPERSONL EQUAL ZEROES
  9229         MOVE LOW-VALUES         TO PI-689-RESP-PERSON
  9230                                    W-COMP-RESP-PERSON
  9231                                    W-PYAJ-FIN-RESP
  9232     ELSE
  9233         MOVE AL-UANON           TO RPERSONA
  9234         MOVE RPERSONI           TO PI-689-RESP-PERSON
  9235                                    W-PYAJ-FIN-RESP
  9236                                    W-COMP-RESP-PERSON.
  9237
  9238 0935-EXIT.
  9239     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 181
* EL689.cbl
  9241 0940-EDIT-ACCOUNT.
  9242
  9243     IF  ACCTL EQUAL ZEROES
  9244         MOVE LOW-VALUES         TO PI-689-ACCOUNT
  9245                                    W-COMP-ACCOUNT
  9246                                    W-PYAJ-ACCOUNT
  9247     ELSE
  9248         MOVE AL-UANON           TO ACCTA
  9249         MOVE ACCTI              TO PI-689-ACCOUNT
  9250                                    W-PYAJ-ACCOUNT
  9251                                    W-COMP-ACCOUNT.
  9252
  9253 0940-EXIT.
  9254     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 182
* EL689.cbl
  9256 0945-EDIT-TYPE.
  9257
  9258     IF  TYPEL EQUAL ZEROES
  9259         MOVE LOW-VALUES         TO PI-689-TYPE
  9260                                    W-COMP-TYPE
  9261                                    W-PYAJ-RECORD-TYPE
  9262     ELSE
  9263         INSPECT TYPEI CONVERTING W-LOWER-CASE TO W-UPPER-CASE
  9264         IF TYPEI = 'C' OR 'G' OR 'A'
  9265             MOVE AL-UANON       TO TYPEA
  9266             MOVE TYPEI          TO PI-689-TYPE
  9267                                    W-COMP-TYPE
  9268                                    W-PYAJ-RECORD-TYPE
  9269         ELSE
  9270             MOVE ER-7368        TO EMI-ERROR
  9271             MOVE -1             TO TYPEL
  9272             MOVE AL-UABON       TO TYPEA
  9273             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9274
  9275 0945-EXIT.
  9276     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 183
* EL689.cbl
  9278 0950-EDIT-ENTRY.
  9279
  9280     IF  BENTRYL EQUAL ZEROES
  9281         MOVE LOW-VALUES         TO PI-689-ENTRY-BATCH
  9282                                    W-PNDB-ENTRY
  9283     ELSE
  9284         MOVE AL-UANON           TO BENTRYA
  9285         MOVE BENTRYI            TO PI-689-ENTRY-BATCH
  9286                                    W-PNDB-ENTRY.
  9287
  9288 0950-EXIT.
  9289     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 184
* EL689.cbl
  9291 0955-EDIT-SEQUENCE.
  9292
  9293     IF  SEQL NOT EQUAL ZEROS
  9294         IF  SEQI NOT NUMERIC
  9295                 OR
  9296             SEQI EQUAL '0'
  9297             MOVE ER-7367        TO EMI-ERROR
  9298             MOVE -1             TO SEQL
  9299             MOVE AL-UABON       TO SEQA
  9300             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9301         ELSE
  9302             MOVE AL-UANON       TO SEQA
  9303             MOVE SEQI           TO PI-689-SEQ-NO
  9304                                    W-CHEK-SEQ-NO
  9305                                    W-PYAJ-FILE-SEQ-NO
  9306                                    W-PNDB-SEQ-NO
  9307                                    PI-689-SEQ-EDIT
  9308     ELSE
  9309         MOVE LOW-VALUES         TO PI-689-SEQ-EDIT.
  9310
  9311 0955-EXIT.
  9312     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 185
* EL689.cbl
  9314 0960-EDIT-BATCH-SEQ.
  9315
  9316     IF  BCSEQL NOT EQUAL ZEROS
  9317         IF  BCSEQI NOT NUMERIC
  9318             MOVE ER-7368        TO EMI-ERROR
  9319             MOVE -1             TO BCSEQL
  9320             MOVE AL-UABON       TO BCSEQA
  9321             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9322         ELSE
  9323             MOVE AL-UANON       TO BCSEQA
  9324             MOVE BCSEQI         TO PI-689-CHG-SEQ-NO
  9325                                    W-PNDB-CHG-SEQ-NO
  9326                                    W-PNDB2-ALT-CHG-SEQ-NO
  9327                                    PI-689-BCSEQ-EDIT
  9328     ELSE
  9329         MOVE LOW-VALUES         TO PI-689-BCSEQ-EDIT.
  9330
  9331 0960-EXIT.
  9332     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 186
* EL689.cbl
  9334 0965-EDIT-TYPE.
  9335
  9336     IF  TYPEL EQUAL ZEROES
  9337         MOVE LOW-VALUES         TO PI-689-TYPE
  9338                                    W-PNDB2-TYPE
  9339     ELSE
  9340         IF  DATASORI NOT EQUAL '4'
  9341             GO TO 0965-EXIT
  9342         ELSE
  9343             IF TYPEI = '0' OR '1' OR '2' OR '3'
  9344                 MOVE AL-UANON   TO TYPEA
  9345                 MOVE TYPEI      TO PI-689-TYPE
  9346                                    W-PNDB2-TYPE
  9347             ELSE
  9348                 MOVE ER-7370    TO EMI-ERROR
  9349                 MOVE -1         TO TYPEL
  9350                 MOVE AL-UABON   TO TYPEA
  9351                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9352
  9353 0965-EXIT.
  9354     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 187
* EL689.cbl
  9356 0990-CARRIER-VALIDITY-CHECK.
  9357
  9358     IF  CARRIERI EQUAL SPACES
  9359         GO TO 0990-EXIT.
  9360
  9361     MOVE SPACES                 TO W-CNTL-KEY.
  9362     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID.
  9363     MOVE '6'                    TO W-CNTL-RECORD-TYPE.
  9364     MOVE CARRIERI               TO W-CNTL-GEN4.
  9365     MOVE +0                     TO W-CNTL-SEQ-NO.
  9366
  9367
  9368* EXEC CICS HANDLE CONDITION
  9369*        NOTFND  (0990-CARRIER-NOT-FOUND)
  9370*        NOTOPEN (8040-CNTL-NOT-OPEN)
  9371*    END-EXEC.
  9372*    MOVE '"$IJ                  ! & #00009262' TO DFHEIV0
  9373     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  9374     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9375     MOVE X'2620233030303039323632' TO DFHEIV0(25:11)
  9376     CALL 'kxdfhei1' USING DFHEIV0
  9377     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9378
  9379
  9380
  9381* EXEC CICS READ
  9382*        DATASET (W-CNTL-FILE-ID)
  9383*        SET     (ADDRESS OF CONTROL-FILE)
  9384*        RIDFLD  (W-CNTL-KEY)
  9385*    END-EXEC.
  9386*    MOVE '&"S        E          (   #00009267' TO DFHEIV0
  9387     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9388     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9389     MOVE X'2020233030303039323637' TO DFHEIV0(25:11)
  9390     CALL 'kxdfhei1' USING DFHEIV0,
  9391           W-CNTL-FILE-ID,
  9392           DFHEIV20,
  9393           DFHEIV99,
  9394           W-CNTL-KEY,
  9395           DFHEIV99,
  9396           DFHEIV99,
  9397           DFHEIV99
  9398     SET ADDRESS OF CONTROL-FILE TO
  9399         DFHEIV20
  9400     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9401
  9402
  9403     IF  PI-NO-CARRIER-SECURITY
  9404             OR
  9405         PI-CARRIER-SECURITY EQUAL CARRIERI
  9406         MOVE AL-UANON           TO CARRIERA
  9407         MOVE CARRIERI           TO PI-689-CARRIER
  9408                                    W-ACCT-CARRIER
  9409                                    W-CERT-CARRIER
  9410                                    W-CHEK-CARRIER
  9411                                    W-COMP-CARRIER
  9412                                    W-MAIL-CARRIER
  9413                                    W-PNDB2-CARRIER
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 188
* EL689.cbl
  9414                                    W-PYAJ-CARRIER
  9415     ELSE
  9416         PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  9417         MOVE ER-9095            TO EMI-ERROR
  9418         MOVE -1                 TO MAINTL
  9419         MOVE AL-UANON           TO MAINTA
  9420         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9421
  9422     GO TO 0990-EXIT.
  9423
  9424 0990-CARRIER-NOT-FOUND.
  9425
  9426     MOVE -1                     TO CARRIERL.
  9427     MOVE AL-UABON               TO CARRIERA.
  9428     MOVE ER-2208                TO EMI-ERROR.
  9429     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9430
  9431 0990-EXIT.
  9432     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 189
* EL689.cbl
  9434 0994-STATE-VALIDITY-CHECK.
  9435
  9436     IF  STATEI EQUAL SPACES
  9437         GO TO 0994-EXIT.
  9438
  9439     MOVE SPACES                 TO W-CNTL-KEY.
  9440     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID.
  9441     MOVE '3'                    TO W-CNTL-RECORD-TYPE.
  9442     MOVE STATEI                 TO W-CNTL-GEN1.
  9443     MOVE +0                     TO W-CNTL-SEQ-NO.
  9444
  9445
  9446* EXEC CICS HANDLE CONDITION
  9447*        NOTFND  (0994-STATE-NOT-FOUND)
  9448*        NOTOPEN (8040-CNTL-NOT-OPEN)
  9449*    END-EXEC.
  9450*    MOVE '"$IJ                  ! '' #00009315' TO DFHEIV0
  9451     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  9452     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9453     MOVE X'2720233030303039333135' TO DFHEIV0(25:11)
  9454     CALL 'kxdfhei1' USING DFHEIV0
  9455     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9456
  9457
  9458
  9459* EXEC CICS READ
  9460*        DATASET (W-CNTL-FILE-ID)
  9461*        SET     (ADDRESS OF CONTROL-FILE)
  9462*        RIDFLD  (W-CNTL-KEY)
  9463*    END-EXEC.
  9464*    MOVE '&"S        E          (   #00009320' TO DFHEIV0
  9465     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9466     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9467     MOVE X'2020233030303039333230' TO DFHEIV0(25:11)
  9468     CALL 'kxdfhei1' USING DFHEIV0,
  9469           W-CNTL-FILE-ID,
  9470           DFHEIV20,
  9471           DFHEIV99,
  9472           W-CNTL-KEY,
  9473           DFHEIV99,
  9474           DFHEIV99,
  9475           DFHEIV99
  9476     SET ADDRESS OF CONTROL-FILE TO
  9477         DFHEIV20
  9478     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9479
  9480
  9481     MOVE AL-UANON               TO STATEA.
  9482     MOVE STATEI                 TO PI-689-STATE
  9483                                    W-ACCT-STATE
  9484                                    W-CERT-STATE
  9485                                    W-CHEK-STATE
  9486                                    W-MAIL-STATE
  9487                                    W-PNDB2-STATE.
  9488
  9489     GO TO 0994-EXIT.
  9490
  9491 0994-STATE-NOT-FOUND.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 190
* EL689.cbl
  9492
  9493     MOVE -1                     TO STATEL.
  9494     MOVE AL-UABON               TO STATEA.
  9495     MOVE ER-2209                TO EMI-ERROR.
  9496     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9497
  9498 0994-EXIT.
  9499     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 191
* EL689.cbl
  9501 1000-SHOW.
  9502***************************************************************
  9503*     THIS ROUTINE WILL BROWSE THE ARCHIVE FILE WITH THE      *
  9504*     ARCHIVE NUMBER SPECIFIED FROM THE SCREEN.  IF THE       *
  9505*     HEADER RECORD IS FOUND THE TEXT IS THEN READ AND        *
  9506*     WILL BE INSERTED INTO THE W-TS-TABLE AND DISPLAYED.     *
  9507***************************************************************
  9508
  9509     MOVE SPACES                 TO W-RECORD-TABLE.
  9510
  9511     IF  PI-689-LBL-OVERRIDE GREATER THAN SPACES
  9512          MOVE PI-689-LBL-OVERRIDE
  9513                                 TO ADDRLBLI
  9514          MOVE +1                TO ADDRLBLL
  9515          MOVE AL-UANON          TO ADDRLBLA
  9516     ELSE
  9517          MOVE PI-LABEL-CONTROL  TO ADDRLBLI
  9518          MOVE +1                TO ADDRLBLL
  9519          MOVE AL-UANON          TO ADDRLBLA.
  9520
  9521     IF  ARCHNUML EQUAL ZEROS
  9522         MOVE -1                 TO ARCHNUML
  9523         MOVE AL-UNBON           TO ARCHNUMA
  9524         MOVE ER-0174            TO EMI-ERROR
  9525         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9526         GO TO 8200-SEND-DATAONLY.
  9527
  9528     IF  ARCHNUMI NOT NUMERIC
  9529         MOVE -1                 TO ARCHNUML
  9530         MOVE AL-UNBON           TO ARCHNUMA
  9531         MOVE ER-0175            TO EMI-ERROR
  9532         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9533         GO TO 8200-SEND-DATAONLY.
  9534
  9535     IF  PI-SHOW-MODE
  9536
  9537         IF  PI-689-ARCHIVE-NUMBER EQUAL ARCHNUMI
  9538             MOVE -1             TO MAINTL
  9539             GO TO 8200-SEND-DATAONLY
  9540         ELSE
  9541             PERFORM 7780-DELETE-TEMP-STOR-TEXT THRU 7780-EXIT.
  9542
  9543     MOVE +0                     TO W-ARCH-SEQ-NO
  9544                                    W-ARCT-SEQ-NO.
  9545     MOVE PI-COMPANY-CD          TO W-ARCH-COMPANY-CD
  9546                                    W-ARCT-COMPANY-CD.
  9547     MOVE ARCHNUMI               TO W-ARCH-NUMBER
  9548                                    W-ARCT-NUMBER
  9549                                    PI-689-ARCHIVE-NUMBER.
  9550     MOVE ' '                    TO W-ARCT-REC-TYPE.
  9551     MOVE '1'                    TO PI-ACTION.
  9552     MOVE SPACES                 TO PI-689-PRINT-SW
  9553                                    PI-689-FORM-NUMBER
  9554                                    W-DELETE-KEY.
  9555     SET W-RG-NDX                TO W-ZEROS.
  9556
  9557
  9558* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 192
* EL689.cbl
  9559*         NOTOPEN    (8010-ARCH-NOT-OPEN)
  9560*         NOTFND     (1070-ARCH-NOT-FOUND)
  9561*         ENDFILE    (1070-ARCH-NOT-FOUND)
  9562*    END-EXEC.
  9563*    MOVE '"$JI''                 ! ( #00009402' TO DFHEIV0
  9564     MOVE X'22244A492720202020202020' TO DFHEIV0(1:12)
  9565     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9566     MOVE X'2820233030303039343032' TO DFHEIV0(25:11)
  9567     CALL 'kxdfhei1' USING DFHEIV0
  9568     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9569
  9570
  9571
  9572* EXEC CICS READ
  9573*        DATASET (W-ARCH-FILE-ID)
  9574*        SET     (ADDRESS OF LETTER-ARCHIVE)
  9575*        RIDFLD  (W-ARCH-KEY)
  9576*    END-EXEC.
  9577*    MOVE '&"S        E          (   #00009408' TO DFHEIV0
  9578     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9579     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9580     MOVE X'2020233030303039343038' TO DFHEIV0(25:11)
  9581     CALL 'kxdfhei1' USING DFHEIV0,
  9582           W-ARCH-FILE-ID,
  9583           DFHEIV20,
  9584           DFHEIV99,
  9585           W-ARCH-KEY,
  9586           DFHEIV99,
  9587           DFHEIV99,
  9588           DFHEIV99
  9589     SET ADDRESS OF LETTER-ARCHIVE TO
  9590         DFHEIV20
  9591     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9592
  9593
  9594     PERFORM 1040-FORMAT-HEADER-DATA THRU 1040-EXIT.
  9595
  9596
  9597* EXEC CICS HANDLE CONDITION
  9598*         NOTOPEN    (8015-ARCT-NOT-OPEN)
  9599*         NOTFND     (1020-ARCT-ENDBR)
  9600*         ENDFILE    (1020-ARCT-ENDBR)
  9601*    END-EXEC.
  9602*    MOVE '"$JI''                 ! ) #00009416' TO DFHEIV0
  9603     MOVE X'22244A492720202020202020' TO DFHEIV0(1:12)
  9604     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9605     MOVE X'2920233030303039343136' TO DFHEIV0(25:11)
  9606     CALL 'kxdfhei1' USING DFHEIV0
  9607     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9608
  9609
  9610 1005-START-BROWSE.
  9611
  9612
  9613* EXEC CICS STARTBR
  9614*         DATASET    (W-ARCT-FILE-ID)
  9615*         RIDFLD     (W-ARCT-KEY)
  9616*         GTEQ
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 193
* EL689.cbl
  9617*    END-EXEC.
  9618     MOVE 0
  9619       TO DFHEIV11
  9620*    MOVE '&,         G          &   #00009424' TO DFHEIV0
  9621     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9622     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9623     MOVE X'2020233030303039343234' TO DFHEIV0(25:11)
  9624     CALL 'kxdfhei1' USING DFHEIV0,
  9625           W-ARCT-FILE-ID,
  9626           W-ARCT-KEY,
  9627           DFHEIV99,
  9628           DFHEIV11,
  9629           DFHEIV99
  9630     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9631
  9632
  9633     MOVE 'Y'                    TO W-ARCT-BROWSE-STARTED.
  9634
  9635 1010-READ-NEXT.
  9636
  9637
  9638* EXEC CICS READNEXT
  9639*         SET       (ADDRESS OF LETTER-ARCHIVE-TEXT)
  9640*         DATASET   (W-ARCT-FILE-ID)
  9641*         RIDFLD    (W-ARCT-KEY)
  9642*    END-EXEC.
  9643     MOVE 0
  9644       TO DFHEIV11
  9645*    MOVE '&.S                   )   #00009434' TO DFHEIV0
  9646     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9647     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  9648     MOVE X'2020233030303039343334' TO DFHEIV0(25:11)
  9649     CALL 'kxdfhei1' USING DFHEIV0,
  9650           W-ARCT-FILE-ID,
  9651           DFHEIV20,
  9652           DFHEIV99,
  9653           W-ARCT-KEY,
  9654           DFHEIV99,
  9655           DFHEIV11,
  9656           DFHEIV99,
  9657           DFHEIV99
  9658     SET ADDRESS OF LETTER-ARCHIVE-TEXT TO
  9659         DFHEIV20
  9660     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9661
  9662
  9663     IF  W-ARCH-PARTIAL-KEY EQUAL W-ARCT-PARTIAL-KEY
  9664         IF  LT-ADDRESS-DATA
  9665             IF  PI-CREATE-LABELS  AND
  9666                 NOT PI-689-LABELS-OVERRIDEN
  9667                 PERFORM 1050-MOVE-LABELS THRU 1050-EXIT
  9668                         VARYING
  9669                     LT-NDX FROM 1 BY 1
  9670                         UNTIL
  9671                     LT-NDX GREATER THAN PI-689-NUMBER-LABEL-LINES
  9672                 GO TO 1010-READ-NEXT
  9673             ELSE
  9674                 MOVE LT-CONTROL-PRIMARY
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 194
* EL689.cbl
  9675                                 TO W-DELETE-KEY
  9676                 GO TO 1010-READ-NEXT
  9677         ELSE
  9678             PERFORM 1030-TEXT-BUILD THRU 1030-EXIT
  9679                     VARYING
  9680                 LT-NDX FROM 1 BY 1
  9681                     UNTIL
  9682                 LT-NDX GREATER THAN LT-NUM-LINES-ON-RECORD
  9683                     OR
  9684                 LT-NDX GREATER THAN +20
  9685             GO TO 1010-READ-NEXT.
  9686
  9687 1020-ARCT-ENDBR.
  9688
  9689     IF  W-ARCT-BROWSE-STARTED EQUAL 'Y'
  9690
  9691* EXEC CICS ENDBR
  9692*             DATASET   (W-ARCT-FILE-ID)
  9693*        END-EXEC.
  9694     MOVE 0
  9695       TO DFHEIV11
  9696*    MOVE '&2                    $   #00009467' TO DFHEIV0
  9697     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9698     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9699     MOVE X'2020233030303039343637' TO DFHEIV0(25:11)
  9700     CALL 'kxdfhei1' USING DFHEIV0,
  9701           W-ARCT-FILE-ID,
  9702           DFHEIV11,
  9703           DFHEIV99
  9704     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9705
  9706
  9707     IF  W-RG-NDX EQUAL ZEROS
  9708         GO TO 1080-ARCHIVE-TEXT-NOT-FOUND.
  9709
  9710     IF  PI-689-NUMBER-LABEL-LINES GREATER THAN +0
  9711             AND
  9712         PI-BYPASS-LABELS
  9713         MOVE W-DELETE-KEY       TO W-ARCT-KEY
  9714         PERFORM 1060-DELETE-ADDRESS-RECORD THRU 1060-EXIT
  9715         MOVE +0                 TO PI-689-NUMBER-LABEL-LINES.
  9716
  9717     SET PI-TOTAL-LINES          TO W-RG-NDX.
  9718     MOVE 1                      TO PI-CURRENT-LINE.
  9719     SET W-RG-NDX                TO +1.
  9720
  9721     PERFORM 7000-FORMAT-SCREEN THRU 7000-EXIT
  9722             VARYING
  9723         W-SC-NDX FROM 1 BY 1
  9724             UNTIL
  9725         W-SC-NDX GREATER THAN W-NUM-LINES-PER-SCREEN.
  9726
  9727     MOVE -1                     TO MAINTL.
  9728     GO TO 8100-SEND-INITIAL-MAP.
  9729
  9730 1020-EXIT.
  9731     EXIT.
  9732
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 195
* EL689.cbl
  9733 1030-TEXT-BUILD.
  9734
  9735     SET W-RG-NDX UP BY 1.
  9736     MOVE LT-SKIP-CONTROL (LT-NDX)
  9737                                 TO W-PRINT-CONTROL.
  9738
  9739     IF  W-PRINT-CONTROL EQUAL 99
  9740         MOVE W-TOP-FORM         TO W-RC-TEXT (W-RG-NDX)
  9741         SET W-RG-NDX UP BY 1
  9742     ELSE
  9743         SET W-RG-NDX UP BY W-PRINT-CONTROL.
  9744
  9745     MOVE LT-TEXT-LINE (LT-NDX)  TO W-RC-TEXT (W-RG-NDX).
  9746     MOVE LT-SKIP-CONTROL (LT-NDX)
  9747                                 TO W-RC-PC (W-RG-NDX).
  9748     MOVE SPACES                 TO W-RC-SC (W-RG-NDX).
  9749
  9750 1030-EXIT.
  9751     EXIT.
  9752
  9753 1040-FORMAT-HEADER-DATA.
  9754
  9755     MOVE LA-ACCOUNT-A2          TO ACCTO.
  9756     MOVE LA-ADDR-SOURCE         TO ADDRSO.
  9757     MOVE LA-CARRIER-A2          TO CARRIERO.
  9758     MOVE LA-CERT-NO-A2          TO CERTO.
  9759     MOVE LA-CERT-SUFFIX-A2      TO SFXO.
  9760     MOVE LA-DATA-SOURCE         TO DATASORO.
  9761
  9762     IF  LA-EFFECT-DATE-A2 EQUAL LOW-VALUES
  9763         MOVE ZEROES             TO DATEO
  9764
  9765     ELSE
  9766         MOVE LA-EFFECT-DATE-A2  TO DC-BIN-DATE-1
  9767         MOVE ' '                TO DC-OPTION-CODE
  9768         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  9769         MOVE DC-GREG-DATE-1-EDIT
  9770                                 TO DATEO.
  9771
  9772     IF  LA-FOLLOW-UP-DATE EQUAL LOW-VALUES
  9773         MOVE ZEROES             TO FOLLOWO
  9774     ELSE
  9775         MOVE LA-FOLLOW-UP-DATE  TO DC-BIN-DATE-1
  9776         MOVE ' '                TO DC-OPTION-CODE
  9777         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  9778         MOVE DC-GREG-DATE-1-EDIT
  9779                                 TO FOLLOWO.
  9780
  9781     MOVE LA-FORM-A3             TO FORMO.
  9782     MOVE LA-GROUPING-A2         TO GROUPO.
  9783     MOVE LA-NO-OF-COPIES        TO COPIESO
  9784                                    PI-689-NUMBER-COPIES.
  9785
  9786     IF LA-PRINT-RESTRICTION = 'C' OR 'F' OR 'P'
  9787         MOVE LA-PRINT-RESTRICTION
  9788                                 TO PRTRESTO
  9789     ELSE
  9790         MOVE SPACES             TO PRTRESTO.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 196
* EL689.cbl
  9791
  9792     IF  LA-RESEND-DATE = LOW-VALUES
  9793         MOVE ZEROES             TO RESEND1O
  9794     ELSE
  9795         MOVE LA-RESEND-DATE     TO DC-BIN-DATE-1
  9796         MOVE ' '                TO DC-OPTION-CODE
  9797         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  9798         MOVE DC-GREG-DATE-1-EDIT
  9799                                 TO RESEND1O.
  9800
  9801     MOVE LA-STATE-A2            TO STATEO.
  9802
  9803     MOVE LA-NUMBER-LABEL-LINES  TO PI-689-NUMBER-LABEL-LINES.
  9804
  9805 1040-EXIT.
  9806     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 197
* EL689.cbl
  9808 1050-MOVE-LABELS.
  9809
  9810     SET W-RG-NDX                TO LT-NDX.
  9811     MOVE ZEROS                  TO W-RC-PC (W-RG-NDX).
  9812     MOVE SPACES                 TO W-RC-SC (W-RG-NDX).
  9813     MOVE LT-TEXT-LINE (LT-NDX)  TO W-RC-TEXT (W-RG-NDX).
  9814
  9815 1050-EXIT.
  9816     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 198
* EL689.cbl
  9818 1060-DELETE-ADDRESS-RECORD.
  9819
  9820
  9821* EXEC CICS DELETE
  9822*        DATASET (W-ARCT-FILE-ID)
  9823*        RIDFLD  (W-DELETE-KEY)
  9824*    END-EXEC.
  9825*    MOVE '&(  R                 &   #00009584' TO DFHEIV0
  9826     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
  9827     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9828     MOVE X'2020233030303039353834' TO DFHEIV0(25:11)
  9829     CALL 'kxdfhei1' USING DFHEIV0,
  9830           W-ARCT-FILE-ID,
  9831           W-DELETE-KEY,
  9832           DFHEIV99,
  9833           DFHEIV99,
  9834           DFHEIV99
  9835     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9836
  9837
  9838
  9839* EXEC CICS READ
  9840*        DATASET (W-ARCH-FILE-ID)
  9841*        SET     (ADDRESS OF LETTER-ARCHIVE)
  9842*        RIDFLD  (W-ARCH-KEY)
  9843*        UPDATE
  9844*    END-EXEC.
  9845*    MOVE '&"S        EU         (   #00009589' TO DFHEIV0
  9846     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9847     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9848     MOVE X'2020233030303039353839' TO DFHEIV0(25:11)
  9849     CALL 'kxdfhei1' USING DFHEIV0,
  9850           W-ARCH-FILE-ID,
  9851           DFHEIV20,
  9852           DFHEIV99,
  9853           W-ARCH-KEY,
  9854           DFHEIV99,
  9855           DFHEIV99,
  9856           DFHEIV99
  9857     SET ADDRESS OF LETTER-ARCHIVE TO
  9858         DFHEIV20
  9859     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9860
  9861
  9862     MOVE ZEROS                  TO LA-NUMBER-LABEL-LINES.
  9863
  9864
  9865* EXEC CICS REWRITE
  9866*         FROM      (LETTER-ARCHIVE)
  9867*         DATASET   (W-ARCH-FILE-ID)
  9868*    END-EXEC.
  9869     MOVE LENGTH OF
  9870      LETTER-ARCHIVE
  9871       TO DFHEIV11
  9872*    MOVE '&& L                  %   #00009598' TO DFHEIV0
  9873     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9874     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9875     MOVE X'2020233030303039353938' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 199
* EL689.cbl
  9876     CALL 'kxdfhei1' USING DFHEIV0,
  9877           W-ARCH-FILE-ID,
  9878           LETTER-ARCHIVE,
  9879           DFHEIV11,
  9880           DFHEIV99
  9881     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9882
  9883
  9884 1060-EXIT.
  9885     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 200
* EL689.cbl
  9887 1070-ARCH-NOT-FOUND.
  9888
  9889     MOVE ER-7371                TO EMI-ERROR.
  9890     MOVE -1                     TO ARCHNUML.
  9891     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9892     GO TO 8100-SEND-INITIAL-MAP.
  9893
  9894 1080-ARCHIVE-TEXT-NOT-FOUND.
  9895
  9896     MOVE ER-7372                TO EMI-ERROR.
  9897     MOVE -1                     TO ARCHNUML.
  9898     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9899     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 201
* EL689.cbl
  9901 2000-CREATE.
  9902***************************************************************
  9903*    THIS ROUTINE WILL CREATE A NEW LETTER BY READING THE     *
  9904*    TEXT FILE WITH THE FORM CODE SPECIFIED FROM THE SCREEN.  *
  9905*    ALL VARIABLE SYMBOLS WILL BE RESOLVED AND THE LETTER     *
  9906*    WILL BE DISPLAYED ON THE SCREEN.                         *
  9907*                                                             *
  9908***************************************************************
  9909
  9910***************************************************************
  9911*    CHECK TO SEE IF IT IS THE SAME REQUEST OR NOT.           *
  9912*    IF IT IS A NEW REQUEST AND A LETTER WAS PRINTED          *
  9913*    THEN FORCE AN ERROR.                                     *
  9914***************************************************************
  9915
  9916     IF  PI-689-CREATE-NO-SCREENS
  9917         GO TO 2000-GET-TEXT.
  9918
  9919     IF  PI-CREATE-MODE
  9920         IF  PI-689-PRINT-PERFORMED
  9921                 AND
  9922             FORMI NOT EQUAL 9999
  9923             MOVE ER-0279    TO EMI-ERROR
  9924             MOVE -1         TO MAINTL
  9925             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9926             GO TO 8200-SEND-DATAONLY.
  9927
  9928     IF  ARCHNUML GREATER THAN ZEROS
  9929         MOVE ER-9320            TO EMI-ERROR
  9930         MOVE -1                 TO ARCHNUML
  9931         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9932         GO TO 8200-SEND-DATAONLY.
  9933
  9934***************************************************************
  9935*    IF  A NEW LETTER IS BEING CREATED FROM SCRATCH, SAVE     *
  9936*    THE EXISTING SCREEN AND PASS CONTROL TO THE TEXT EDITOR  *
  9937***************************************************************
  9938
  9939     IF  FORMI EQUAL '9999'
  9940         MOVE 16                 TO PI-TOTAL-LINES
  9941         MOVE 1                  TO PI-CURRENT-LINE
  9942         MOVE SPACES             TO W-FILE-TABLE
  9943                                    W-LINE-CONTROL-RECORD
  9944                                    W-RECORD-TABLE
  9945                                    W-SINGLE-LINE
  9946                                    W-SQUEEZED-LINE
  9947                                    W-TS-WORK-AREA
  9948                                    W-TX-TABLE
  9949         PERFORM 7760-PUT-TEMP-STORAGE THRU 7760-EXIT
  9950         MOVE '3'                TO PI-ACTION
  9951         MOVE FORMI              TO PI-689-FORM-NUMBER
  9952                                    PI-COMM-CONTROL
  9953         MOVE ZEROS              TO PI-UPDATE-SW
  9954         MOVE W-PGM-EL1042       TO W-CALL-PGM
  9955         GO TO 9400-XCTL.
  9956
  9957 2000-GET-TEXT.
  9958
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 202
* EL689.cbl
  9959     MOVE SPACES                 TO W-FILE-TABLE
  9960                                    W-LINE-CONTROL-RECORD
  9961                                    W-RECORD-TABLE
  9962                                    W-SINGLE-LINE
  9963                                    W-SQUEEZED-LINE
  9964                                    W-TS-WORK-AREA
  9965                                    W-TX-TABLE.
  9966     SET W-TG-NDX                TO +1
  9967     MOVE ZEROS                  TO W-INITIAL-COLUMN
  9968                                    W-LINE-COUNT
  9969                                    W-LINE-INDENT-1
  9970                                    W-LINE-INDENT-2
  9971                                    W-LINE-INDENT-3
  9972                                    W-LINE-INDENT-4
  9973                                    W-LINE-INDENT-5
  9974                                    W-PAGE
  9975                                    W-PARAGRAPH-INDENT
  9976                                    W-TOP-MARGIN
  9977                                    W-WORK-INDENT.
  9978     MOVE PI-LOWER-CASE-LETTERS  TO W-LC-CASE-IND.
  9979     MOVE +70                    TO W-LAST-COLUMN.
  9980     MOVE +56                    TO W-MAX-LINES-PER-PAGE.
  9981     MOVE +1                     TO W-START-COLUMN.
  9982     MOVE +71                    TO W-TOO-FAR.
  9983
  9984     MOVE PI-COMPANY-CD          TO W-TEXT-COMPANY-CD.
  9985     MOVE FORMI                  TO W-TEXT-LETTER.
  9986     MOVE W-TEXT-PARTIAL-KEY     TO W-TEXT-SAVE-KEY.
  9987     MOVE 'N'                    TO W-TEXT-BROWSED-SW.
  9988
  9989
  9990* EXEC CICS HANDLE CONDITION
  9991*         NOTFND     (2001-NOT-FOUND)
  9992*         ENDFILE    (2001-NOT-FOUND)
  9993*         NOTOPEN    (8050-TEXT-NOT-OPEN)
  9994*    END-EXEC.
  9995*    MOVE '"$I''J                 ! * #00009708' TO DFHEIV0
  9996     MOVE X'222449274A20202020202020' TO DFHEIV0(1:12)
  9997     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9998     MOVE X'2A20233030303039373038' TO DFHEIV0(25:11)
  9999     CALL 'kxdfhei1' USING DFHEIV0
 10000     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10001
 10002
 10003
 10004* EXEC CICS STARTBR
 10005*         DATASET    (W-TEXT-FILE-ID)
 10006*         RIDFLD     (W-TEXT-KEY)
 10007*         GTEQ
 10008*    END-EXEC.
 10009     MOVE 0
 10010       TO DFHEIV11
 10011*    MOVE '&,         G          &   #00009714' TO DFHEIV0
 10012     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 10013     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10014     MOVE X'2020233030303039373134' TO DFHEIV0(25:11)
 10015     CALL 'kxdfhei1' USING DFHEIV0,
 10016           W-TEXT-FILE-ID,
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 203
* EL689.cbl
 10017           W-TEXT-KEY,
 10018           DFHEIV99,
 10019           DFHEIV11,
 10020           DFHEIV99
 10021     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10022
 10023
 10024
 10025* EXEC CICS HANDLE CONDITION
 10026*         ENDFILE    (2000-ENDBR)
 10027*    END-EXEC.
 10028*    MOVE '"$''                   ! + #00009720' TO DFHEIV0
 10029     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 10030     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10031     MOVE X'2B20233030303039373230' TO DFHEIV0(25:11)
 10032     CALL 'kxdfhei1' USING DFHEIV0
 10033     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10034
 10035
 10036 2000-READ-NEXT.
 10037
 10038     IF  W-TG-NDX GREATER THAN W-MAX-LINES
 10039         MOVE ER-0051            TO EMI-ERROR
 10040         MOVE -1                 TO MAINTL
 10041         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10042         GO TO 2000-ENDBR.
 10043
 10044
 10045* EXEC CICS READNEXT
 10046*         DATASET    (W-TEXT-FILE-ID)
 10047*         SET        (ADDRESS OF TEXT-FILES)
 10048*         RIDFLD     (W-TEXT-KEY)
 10049*    END-EXEC.
 10050     MOVE 0
 10051       TO DFHEIV11
 10052*    MOVE '&.S                   )   #00009732' TO DFHEIV0
 10053     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 10054     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 10055     MOVE X'2020233030303039373332' TO DFHEIV0(25:11)
 10056     CALL 'kxdfhei1' USING DFHEIV0,
 10057           W-TEXT-FILE-ID,
 10058           DFHEIV20,
 10059           DFHEIV99,
 10060           W-TEXT-KEY,
 10061           DFHEIV99,
 10062           DFHEIV11,
 10063           DFHEIV99,
 10064           DFHEIV99
 10065     SET ADDRESS OF TEXT-FILES TO
 10066         DFHEIV20
 10067     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10068
 10069
 10070     IF  W-TEXT-PARTIAL-KEY NOT EQUAL W-TEXT-SAVE-KEY
 10071         GO TO 2000-ENDBR.
 10072
 10073     MOVE 'Y'                    TO W-TEXT-BROWSED-SW.
 10074
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 204
* EL689.cbl
 10075     MOVE TX-FORM-SQUEEZE-CONTROL
 10076                                 TO W-FORM-SQUEEZE-IND.
 10077
 10078     IF  PI-689-ARCHIVE-SW NOT GREATER THAN SPACES
 10079         MOVE TX-ARCHIVE-SW      TO PI-689-ARCHIVE-SW.
 10080
 10081     IF  TX-FORM-CONTROL-LINE
 10082         PERFORM 2100-PROCESS-FORM-CONTROL-LINE THRU 2100-EXIT
 10083         GO TO 2000-READ-NEXT.
 10084
 10085     IF  TX-LINE-SQUEEZE-CONTROL EQUAL 'Z'
 10086         PERFORM 2150-PROCESS-Z-CONTROLS THRU 2150-EXIT
 10087         GO TO 2000-READ-NEXT.
 10088
 10089     MOVE TX-TEXT-LINE           TO W-TX-TEXT (W-TG-NDX).
 10090     MOVE TX-PROCESS-CONTROL     TO W-TX-PC (W-TG-NDX).
 10091     PERFORM 2200-CHECK-FOR-VARIABLE THRU 2200-EXIT.
 10092     MOVE TX-LINE-SQUEEZE-CONTROL
 10093                                 TO W-TX-SC (W-TG-NDX).
 10094
 10095     SET W-TG-NDX UP BY 1.
 10096     GO TO 2000-READ-NEXT.
 10097
 10098 2000-ENDBR.
 10099
 10100
 10101* EXEC CICS ENDBR
 10102*        DATASET     (W-TEXT-FILE-ID)
 10103*    END-EXEC.
 10104     MOVE 0
 10105       TO DFHEIV11
 10106*    MOVE '&2                    $   #00009768' TO DFHEIV0
 10107     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 10108     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10109     MOVE X'2020233030303039373638' TO DFHEIV0(25:11)
 10110     CALL 'kxdfhei1' USING DFHEIV0,
 10111           W-TEXT-FILE-ID,
 10112           DFHEIV11,
 10113           DFHEIV99
 10114     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10115
 10116
 10117     IF  W-TEXT-BROWSE-NOT-STARTED
 10118         MOVE ER-0006            TO EMI-ERROR
 10119         MOVE -1                 TO FORML
 10120         MOVE AL-UABON           TO FORMA
 10121         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10122         GO TO 8350-SEND-DATAONLY-ERASEAUP.
 10123
 10124     SET  W-TOTAL-TX-LINES       TO W-TG-NDX.
 10125     SUBTRACT +1 FROM W-TOTAL-TX-LINES.
 10126     MOVE 1                      TO PI-CURRENT-LINE.
 10127
 10128     IF  COPIESL NOT GREATER THAN ZEROS
 10129         MOVE +1                 TO COPIESI
 10130                                    PI-689-NUMBER-COPIES
 10131         MOVE +1                 TO COPIESL
 10132         MOVE AL-UNNON           TO COPIESA.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 205
* EL689.cbl
 10133
 10134***************************************************************
 10135*    IF IT IS A FORM WITH VARIABLES, THEN RESOLVE ALL OF      *
 10136*    VARIABLE SYMBOLS AND INSERT THEM INTO THE TEXT DATA.     *
 10137***************************************************************
 10138
 10139     PERFORM 6000-RESOLVE-VARIABLES THRU 6000-EXIT.
 10140
 10141     IF  PI-689-PRINT-RESTRICTION EQUAL 'C'
 10142         IF  PI-689-CONTROL NOT GREATER THAN ZEROS
 10143             MOVE ER-7243        TO EMI-ERROR
 10144             MOVE -1             TO PRTRESTL
 10145             MOVE AL-UABON       TO PRTRESTA
 10146             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10147
 10148     IF  PI-CREATE-LABELS AND
 10149         NOT  PI-689-LABELS-OVERRIDEN
 10150         SET W-RG-NDX            TO PI-689-NUMBER-LABEL-LINES
 10151         SET W-RG-NDX UP BY +1
 10152     ELSE
 10153         SET W-RG-NDX            TO +1.
 10154
 10155     MOVE W-TOP-FORM             TO W-RC-TEXT (W-RG-NDX).
 10156     SET W-RG-NDX UP BY W-TOP-MARGIN.
 10157
 10158     PERFORM 7400-CREATE-LETTER THRU 7400-EXIT.
 10159
 10160     SET PI-TOTAL-LINES          TO W-RG-NDX.
 10161
 10162     IF  W-FIRST-BAD-VARIABLE-FOUND
 10163         SET W-RG-NDX            TO W-FIRST-BAD-VARIABLE
 10164         MOVE W-FIRST-BAD-VARIABLE
 10165                                 TO PI-CURRENT-LINE
 10166     ELSE
 10167         SET W-RG-NDX            TO 1.
 10168
 10169     PERFORM 7000-FORMAT-SCREEN THRU 7000-EXIT
 10170             VARYING
 10171         W-SC-NDX FROM 1 BY 1
 10172             UNTIL
 10173         W-SC-NDX GREATER W-NUM-LINES-PER-SCREEN.
 10174     IF  PI-689-CREATE-NO-SCREENS
 10175         GO TO 2000-EXIT
 10176     ELSE
 10177         IF  W-FORM-CHANGED
 10178             MOVE '3'            TO PI-ACTION
 10179             MOVE -1             TO MAINTL
 10180             GO TO 8100-SEND-INITIAL-MAP
 10181         ELSE
 10182             MOVE '3'            TO PI-ACTION
 10183             MOVE -1             TO MAINTL
 10184             GO TO 8350-SEND-DATAONLY-ERASEAUP.
 10185
 10186 2000-EXIT.
 10187     EXIT.
 10188
 10189 2001-NOT-FOUND.
 10190
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 206
* EL689.cbl
 10191     MOVE ER-0006                TO EMI-ERROR.
 10192     MOVE -1                     TO FORML.
 10193     MOVE AL-UABON               TO FORMA.
 10194     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10195     GO TO 8350-SEND-DATAONLY-ERASEAUP.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 207
* EL689.cbl
 10197 2100-PROCESS-FORM-CONTROL-LINE.
 10198
 10199     MOVE TX-TEXT-LINE           TO W-LINE-CONTROL-RECORD.
 10200
 10201     IF  W-LC-LINE-WIDTH NUMERIC
 10202             AND
 10203         W-LC-LINE-WIDTH GREATER THAN ZEROS
 10204         COMPUTE W-INITIAL-COLUMN
 10205             = (70 - W-LC-LINE-WIDTH) / 2
 10206         COMPUTE W-START-COLUMN = W-INITIAL-COLUMN + 1
 10207         COMPUTE W-LAST-COLUMN ROUNDED
 10208             = W-INITIAL-COLUMN + W-LC-LINE-WIDTH
 10209         COMPUTE W-TOO-FAR = W-LAST-COLUMN + 1
 10210     ELSE
 10211         MOVE 70                 TO W-LC-LINE-WIDTH.
 10212
 10213     IF  W-LC-PARAGRAPH-INDENT NUMERIC
 10214             AND
 10215         W-LC-PARAGRAPH-INDENT GREATER THAN ZEROS
 10216         MOVE W-LC-PARAGRAPH-INDENT
 10217                                 TO W-PARAGRAPH-INDENT.
 10218
 10219     IF  W-LC-MAX-LINES-PER-PAGE NUMERIC
 10220             AND
 10221         W-LC-MAX-LINES-PER-PAGE GREATER THAN ZEROS
 10222         MOVE W-LC-MAX-LINES-PER-PAGE
 10223                                 TO W-MAX-LINES-PER-PAGE.
 10224
 10225     IF  W-LC-LINE-ADJUST NUMERIC
 10226             AND
 10227         W-LC-LINE-ADJUST GREATER THAN ZEROS
 10228         COMPUTE W-TOTAL-LINE-LENGTH
 10229             = W-LC-LINE-WIDTH + (W-LC-LINE-ADJUST * 2)
 10230         IF  W-TOTAL-LINE-LENGTH LESS THAN +71
 10231             ADD W-LC-LINE-ADJUST
 10232                                 TO W-INITIAL-COLUMN
 10233                                    W-LAST-COLUMN
 10234                                    W-START-COLUMN
 10235                                    W-TOO-FAR.
 10236
 10237     IF  W-LC-LINE-INDENT-1 NUMERIC
 10238             AND
 10239         W-LC-LINE-INDENT-1 LESS THAN W-LC-LINE-WIDTH
 10240         MOVE W-LC-LINE-INDENT-1 TO W-LINE-INDENT-1
 10241     ELSE
 10242         MOVE +0                 TO W-LINE-INDENT-1.
 10243
 10244     IF  W-LC-LINE-INDENT-2 NUMERIC
 10245             AND
 10246         W-LC-LINE-INDENT-2 LESS THAN W-LC-LINE-WIDTH
 10247         MOVE W-LC-LINE-INDENT-2 TO W-LINE-INDENT-2
 10248     ELSE
 10249         MOVE +0                 TO W-LINE-INDENT-2.
 10250
 10251     IF  W-LC-LINE-INDENT-3 NUMERIC
 10252             AND
 10253         W-LC-LINE-INDENT-3 LESS THAN W-LC-LINE-WIDTH
 10254         MOVE W-LC-LINE-INDENT-3 TO W-LINE-INDENT-3
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 208
* EL689.cbl
 10255     ELSE
 10256         MOVE +0                 TO W-LINE-INDENT-3.
 10257
 10258     IF  W-LC-LINE-INDENT-4 NUMERIC
 10259             AND
 10260         W-LC-LINE-INDENT-4 LESS THAN W-LC-LINE-WIDTH
 10261         MOVE W-LC-LINE-INDENT-4 TO W-LINE-INDENT-4
 10262     ELSE
 10263         MOVE +0                 TO W-LINE-INDENT-4.
 10264
 10265     IF  W-LC-LINE-INDENT-5 NUMERIC
 10266             AND
 10267         W-LC-LINE-INDENT-5 LESS THAN W-LC-LINE-WIDTH
 10268         MOVE W-LC-LINE-INDENT-5 TO W-LINE-INDENT-5
 10269
 10270     ELSE
 10271         MOVE +0                 TO W-LINE-INDENT-5.
 10272
 10273     IF  W-LC-TOP-MARGIN NUMERIC
 10274         MOVE W-LC-TOP-MARGIN    TO W-TOP-MARGIN
 10275     ELSE
 10276         MOVE +0                 TO W-TOP-MARGIN.
 10277
 10278     IF W-LC-CASE-IND = 'Y' OR 'N'
 10279         NEXT SENTENCE
 10280     ELSE
 10281         MOVE PI-LOWER-CASE-LETTERS
 10282                                 TO W-LC-CASE-IND.
 10283
 10284 2100-EXIT.
 10285     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 209
* EL689.cbl
 10287 2150-PROCESS-Z-CONTROLS.
 10288
 10289     MOVE TX-TEXT-LINE           TO W-Z-CONTROL-DATA.
 10290
 10291     IF PI-689-RESEND-DATE-1 = LOW-VALUES
 10292        IF W-DAYS-TO-RESEND NUMERIC
 10293           IF W-DAYS-TO-RESEND > ZEROS
 10294              MOVE '6'           TO DC-OPTION-CODE
 10295              MOVE W-SAVE-BIN-DATE
 10296                                 TO DC-BIN-DATE-1
 10297              MOVE ZEROS         TO DC-ELAPSED-MONTHS
 10298              MOVE W-DAYS-TO-RESEND
 10299                                 TO DC-ELAPSED-DAYS
 10300              PERFORM 9500-LINK-DATE-CONVERT
 10301                                 THRU 9500-EXIT
 10302              IF NO-CONVERSION-ERROR
 10303                 MOVE DC-BIN-DATE-2
 10304                                 TO PI-689-RESEND-DATE-1
 10305                 MOVE DC-GREG-DATE-1-EDIT
 10306                                 TO RESEND1O
 10307                                    PI-689-RESEND1-EDIT
 10308                 MOVE AL-UANON
 10309                                 TO RESEND1A
 10310                 MOVE +8         TO RESEND1L
 10311              ELSE
 10312                 MOVE ER-3770
 10313                                 TO EMI-ERROR
 10314                 MOVE -1         TO MAINTL
 10315                 PERFORM 9900-ERROR-FORMAT
 10316                                 THRU 9900-EXIT
 10317                 GO TO 8200-SEND-DATAONLY
 10318              END-IF
 10319           END-IF
 10320        END-IF
 10321     END-IF
 10322     IF W-FORM-TO-RESEND NOT = SPACES AND ZEROS
 10323        MOVE W-FORM-TO-RESEND    TO PI-689-RESEND-LETR-1
 10324     END-IF
 10325     IF  PI-689-FOLLOW-UP-DATE EQUAL LOW-VALUES
 10326         IF  W-DAYS-TO-FOLLOW-UP NUMERIC
 10327             IF  W-DAYS-TO-FOLLOW-UP GREATER THAN ZEROS
 10328                 MOVE '6'        TO DC-OPTION-CODE
 10329                 MOVE W-SAVE-BIN-DATE
 10330                                 TO DC-BIN-DATE-1
 10331                 MOVE ZEROS      TO DC-ELAPSED-MONTHS
 10332                 MOVE W-DAYS-TO-FOLLOW-UP
 10333                                 TO DC-ELAPSED-DAYS
 10334                 PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
 10335                 IF  NO-CONVERSION-ERROR
 10336                     MOVE DC-BIN-DATE-2
 10337                                 TO PI-689-FOLLOW-UP-DATE
 10338                     MOVE DC-GREG-DATE-1-EDIT
 10339                                 TO FOLLOWO
 10340                     MOVE AL-UANON
 10341                                 TO FOLLOWA
 10342                     MOVE +8     TO FOLLOWL
 10343                 ELSE
 10344                     MOVE ER-3771
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 210
* EL689.cbl
 10345                                 TO EMI-ERROR
 10346                     MOVE -1     TO MAINTL
 10347                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10348                     GO TO 8200-SEND-DATAONLY.
 10349
 10350     IF  COPIESI NOT NUMERIC
 10351             OR
 10352         COPIESI NOT GREATER THAN ZEROS
 10353         IF  W-NUMBER-OF-COPIES NUMERIC
 10354             IF  W-NUMBER-OF-COPIES GREATER THAN ZEROS
 10355                 MOVE W-NUMBER-OF-COPIES
 10356                                 TO COPIESI
 10357                                    PI-689-NUMBER-COPIES
 10358                 MOVE AL-UNNON   TO COPIESA
 10359                 MOVE +1         TO COPIESL
 10360             ELSE
 10361                 MOVE +1         TO COPIESI
 10362                                    PI-689-NUMBER-COPIES
 10363                 MOVE AL-UNNON   TO COPIESA
 10364                 MOVE +1         TO COPIESL
 10365         ELSE
 10366             MOVE +1             TO COPIESI
 10367                                    PI-689-NUMBER-COPIES
 10368             MOVE AL-UNNON       TO COPIESA
 10369             MOVE +1             TO COPIESL.
 10370
 10371*    IF  PI-689-PRINT-RESTRICTION NOT = 'C' AND 'F' AND 'P' AND
 10372*                                       SPACES
 10373*        IF  W-PRINT-RESTRICTED
 10374*            MOVE W-PRINT-RESTRICTED-IND
 10375*                                TO PRTRESTI
 10376*                                   PI-689-PRINT-RESTRICTION
 10377*            MOVE AL-UANON       TO PRTRESTA
 10378*            MOVE +1             TO PRTRESTL.
 10379     .
 10380 2150-EXIT.
 10381     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 211
* EL689.cbl
 10383 2200-CHECK-FOR-VARIABLE.
 10384
 10385     IF  W-TX-TEXT (W-TG-NDX) EQUAL SPACES
 10386         GO TO 2200-EXIT.
 10387
 10388     SET W-TX-NDX                TO +1.
 10389
 10390 2200-CONTINUE.
 10391
 10392     SEARCH W-TX-CHAR
 10393         VARYING
 10394             W-TX-NDX
 10395         AT END
 10396             GO TO 2200-EXIT
 10397         WHEN
 10398             W-TX-CHAR (W-TG-NDX W-TX-NDX) EQUAL '@'
 10399             NEXT SENTENCE.
 10400
 10401     SET W-TX-NDX UP BY +1.
 10402
 10403     IF  W-TX-CHAR (W-TG-NDX W-TX-NDX) EQUAL '@'
 10404         PERFORM 2220-BUILD-VARIABLE-NUMBER THRU 2220-EXIT
 10405         GO TO 2200-CONTINUE.
 10406
 10407 2200-EXIT.
 10408     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 212
* EL689.cbl
 10410 2220-BUILD-VARIABLE-NUMBER.
 10411
 10412     SET W-TX-NDX UP BY +1.
 10413     MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX) TO W-V1.
 10414     SET W-TX-NDX UP BY +1.
 10415     MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX) TO W-V2.
 10416     SET W-TX-NDX UP BY +1.
 10417     MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX) TO W-V3.
 10418
 10419     IF  W-VAR-RELATIVE-NUM NUMERIC
 10420         SET W-FILE-NDX TO W-VARIABLE-SOURCE (W-VAR-RELATIVE-NUM)
 10421         MOVE 'Y' TO W-FILE-USE-IND (W-FILE-NDX).
 10422
 10423 2220-EXIT.
 10424     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 213
* EL689.cbl
 10426 4000-ROLL-PAGE.
 10427
 10428     IF  ENTERPFL NOT EQUAL ZEROS
 10429         MOVE -1                 TO ENTERPFL
 10430     ELSE
 10431         MOVE -1                 TO MAINTL.
 10432
 10433     IF  PI-TOTAL-LINES EQUAL 0
 10434         MOVE ER-0047            TO EMI-ERROR
 10435         MOVE -1                 TO MAINTL
 10436         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10437         GO TO 8200-SEND-DATAONLY.
 10438
 10439     COMPUTE W-TEMP-CURRENT-LINE EQUAL
 10440         PI-CURRENT-LINE + W-ROLL-COUNTER.
 10441
 10442     IF  W-TEMP-CURRENT-LINE NEGATIVE
 10443             OR
 10444         W-TEMP-CURRENT-LINE EQUAL ZEROS
 10445         MOVE ER-0067            TO EMI-ERROR
 10446         MOVE -1                 TO MAINTL
 10447         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10448         MOVE 1                  TO W-TEMP-CURRENT-LINE.
 10449
 10450     IF  W-TEMP-CURRENT-LINE GREATER THAN PI-TOTAL-LINES
 10451             AND
 10452         (EIBAID EQUAL DFHPF1 OR DFHPF6)
 10453         MOVE ER-0066            TO EMI-ERROR
 10454         MOVE -1                 TO MAINTL
 10455         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10456         COMPUTE W-TEMP-CURRENT-LINE
 10457             = PI-TOTAL-LINES + 1 - W-NUM-LINES-PER-SCREEN
 10458         IF  W-TEMP-CURRENT-LINE NEGATIVE
 10459                 OR
 10460             W-TEMP-CURRENT-LINE = ZEROS
 10461             MOVE 1 TO W-TEMP-CURRENT-LINE.
 10462
 10463     IF  EMI-ERROR NOT EQUAL ER-0191
 10464             AND
 10465         MAINTI NOT EQUAL 'S'
 10466         PERFORM 7700-READ-TEXT-TS THRU 7700-EXIT
 10467         PERFORM 4100-SET-NDX THRU 4100-EXIT
 10468         PERFORM 4200-UPDATE-TABLE-FROM-SCREEN THRU 4200-EXIT
 10469                 VARYING
 10470             W-SC-NDX FROM 1 BY 1
 10471                 UNTIL
 10472             W-SC-NDX GREATER THAN W-NUM-LINES-PER-SCREEN.
 10473
 10474     IF  EMI-ERROR EQUAL ER-0066 OR ER-0067 OR ER-0000 OR
 10475                         ER-0191
 10476         NEXT SENTENCE
 10477     ELSE
 10478         GO TO 8200-SEND-DATAONLY.
 10479
 10480     MOVE W-TEMP-CURRENT-LINE    TO PI-CURRENT-LINE
 10481     SET W-RG-NDX                TO PI-CURRENT-LINE
 10482     MOVE LOW-VALUES             TO EL689RI
 10483*    PERFORM 7700-READ-TEXT-TS   THRU 7700-EXIT
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 214
* EL689.cbl
 10484     PERFORM 7740-RESTORE-SCREEN THRU 7749-EXIT
 10485     SET W-RG-NDX                TO PI-CURRENT-LINE
 10486     PERFORM 7000-FORMAT-SCREEN THRU 7000-EXIT
 10487             VARYING
 10488         W-SC-NDX FROM 1 BY 1
 10489             UNTIL
 10490         W-SC-NDX GREATER W-NUM-LINES-PER-SCREEN.
 10491
 10492     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 215
* EL689.cbl
 10494 4100-SET-NDX.
 10495
 10496     IF  PI-CURRENT-LINE EQUAL 0
 10497         SET W-RG-NDX            TO 1
 10498     ELSE
 10499         SET W-RG-NDX            TO PI-CURRENT-LINE.
 10500
 10501 4100-EXIT.
 10502      EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 216
* EL689.cbl
 10504 4200-UPDATE-TABLE-FROM-SCREEN.
 10505
 10506     IF  W-SC-TEXTL (W-SC-NDX) NOT EQUAL ZEROS
 10507         MOVE ZEROS              TO W-SC-TEXTL (W-SC-NDX)
 10508         IF  W-RG-NDX GREATER THAN PI-TOTAL-LINES
 10509             IF  PI-TOTAL-LINES EQUAL W-MAX-LINES
 10510                 MOVE ER-0051    TO EMI-ERROR
 10511                 MOVE -1         TO MAINTL
 10512                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10513                 GO TO 8200-SEND-DATAONLY
 10514             ELSE
 10515                 MOVE W-SC-TEXT (W-SC-NDX)
 10516                                 TO W-RC-TEXT (W-RG-NDX)
 10517                 ADD 1           TO PI-TOTAL-LINES
 10518         ELSE
 10519             MOVE W-SC-TEXT (W-SC-NDX)
 10520                                 TO W-RC-TEXT (W-RG-NDX).
 10521
 10522     SET W-RG-NDX UP BY 1.
 10523
 10524 4200-EXIT.
 10525      EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 217
* EL689.cbl
 10527 5000-EDIT-MODE.
 10528***************************************************************
 10529*    THIS ROUTINE WILL SAVE A COPY OF THE EXISTING SCREEN     *
 10530*    AND THE W-TS-TABLE OF LETTER TEXT.  IT WILL THEN         *
 10531*    TRANSFER TO THE W-TEXT-EDITOR PROGRAM.                   *
 10532***************************************************************
 10533
 10534     IF  PI-SHOW-MODE
 10535         MOVE ER-0188            TO EMI-ERROR
 10536         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10537         MOVE -1                 TO MAINTL
 10538         MOVE AL-UABON           TO MAINTA
 10539         GO TO 8200-SEND-DATAONLY.
 10540
 10541     IF  PI-CURRENT-LINE EQUAL ZEROS
 10542         MOVE ER-0187            TO EMI-ERROR
 10543         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10544         MOVE -1                 TO MAINTL
 10545         GO TO 8200-SEND-DATAONLY.
 10546
 10547     PERFORM 7700-READ-TEXT-TS   THRU 7700-EXIT
 10548     PERFORM 4100-SET-NDX THRU 4100-EXIT.
 10549     PERFORM 4200-UPDATE-TABLE-FROM-SCREEN THRU 4200-EXIT
 10550             VARYING
 10551         W-SC-NDX FROM 1 BY 1
 10552             UNTIL
 10553         W-SC-NDX GREATER THAN W-NUM-LINES-PER-SCREEN.
 10554
 10555     PERFORM 7760-PUT-TEMP-STORAGE THRU 7760-EXIT.
 10556
 10557     MOVE PI-689-FORM-NUMBER     TO PI-COMM-CONTROL.
 10558     MOVE ZEROS                  TO PI-UPDATE-SW.
 10559     MOVE '1'                    TO PI-ENTRY-CD-1.
 10560     MOVE W-PGM-EL1042           TO W-CALL-PGM.
 10561     GO TO 9400-XCTL.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 218
* EL689.cbl
 10563 5400-LETTER-RELEASE.
 10564***************************************************************
 10565*    THIS ROUTINE WILL BE USED WHEN THE LETTER HAS BEEN       *
 10566*    COMPLETED AND IS TO BE PUT AS PERMANENT RECORDS IN       *
 10567*    THE ARCHIVE FILE.                                        *
 10568*    THE FUNCTIONS BELOW WILL BE PERFORMED.                   *
 10569*        1. CHECK SECURITY.                                   *
 10570*        2. MAKE SURE THERE ARE NO UNRESOLVED SYMBOLS.        *
 10571*        3. GET THE ARCHIVE NUMBER FROM THE CONTROL FILE.     *
 10572*        4. WRITE THE NEW ARCHIVE RECORDS FROM W-TS-TABLE.    *
 10573*        5. RESET INSURED'S CONTROL FIELDS AND RETURN THE     *
 10574*           ARCHIVE NUMBER USED  TO FILE THE RECORDS.         *
 10575***************************************************************
 10576
 10577     IF  NOT MODIFY-CAP
 10578         MOVE ER-0070            TO EMI-ERROR
 10579         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10580         MOVE -1                 TO MAINTL
 10581         GO TO 8200-SEND-DATAONLY.
 10582
 10583     IF  PI-SHOW-MODE
 10584         MOVE ER-0188            TO EMI-ERROR
 10585         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10586         MOVE -1                 TO MAINTL
 10587         MOVE AL-UABON           TO MAINTA
 10588         GO TO 8200-SEND-DATAONLY.
 10589
 10590     IF  ARCHNUML GREATER THAN ZEROS
 10591         MOVE ER-9320            TO EMI-ERROR
 10592         MOVE -1                 TO ARCHNUML
 10593         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10594         GO TO 8200-SEND-DATAONLY.
 10595
 10596     IF  PI-CURRENT-LINE EQUAL ZEROS
 10597         MOVE ER-0187            TO EMI-ERROR
 10598         MOVE -1                 TO MAINTL
 10599         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10600         GO TO 8200-SEND-DATAONLY.
 10601
 10602     PERFORM 7700-READ-TEXT-TS   THRU 7700-EXIT
 10603     IF  NOT PI-689-CREATE-NO-SCREENS
 10604         PERFORM 4100-SET-NDX THRU 4100-EXIT
 10605         PERFORM 4200-UPDATE-TABLE-FROM-SCREEN THRU 4200-EXIT
 10606                 VARYING
 10607             W-SC-NDX FROM 1 BY 1
 10608                 UNTIL
 10609             W-SC-NDX GREATER THAN W-NUM-LINES-PER-SCREEN
 10610         IF  EMI-FATAL-CTR GREATER THAN ZEROS
 10611                 OR
 10612             PI-689-FATAL-ERROR
 10613             GO TO 8200-SEND-DATAONLY.
 10614
 10615     MOVE SPACES                 TO W-REMAINING-VAR-SW.
 10616     PERFORM 7915-SEARCH-REMAINING-VARS THRU 7915-EXIT
 10617             VARYING
 10618         W-RVS-NDX FROM +1 BY +1
 10619             UNTIL
 10620         W-RVS-NDX > +36500
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 219
* EL689.cbl
 10621             OR
 10622         W-REMAINING-VAR-FOUND.
 10623
 10624     IF  NOT PI-689-CREATE-NO-SCREENS
 10625         IF  W-REMAINING-VAR-FOUND
 10626             GO TO 4000-ROLL-PAGE.
 10627
 10628     MOVE SPACES                 TO W-CNTL-KEY.
 10629     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID.
 10630     MOVE '1'                    TO W-CNTL-RECORD-TYPE.
 10631     MOVE ZEROS                  TO W-CNTL-SEQ-NO.
 10632
 10633
 10634* EXEC CICS HANDLE CONDITION
 10635*         NOTOPEN    (8040-CNTL-NOT-OPEN)
 10636*         NOTFND     (5470-CNTL-NOT-FOUND)
 10637*    END-EXEC.
 10638*    MOVE '"$JI                  ! , #00010288' TO DFHEIV0
 10639     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 10640     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10641     MOVE X'2C20233030303130323838' TO DFHEIV0(25:11)
 10642     CALL 'kxdfhei1' USING DFHEIV0
 10643     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10644
 10645
 10646
 10647* EXEC CICS READ
 10648*         DATASET    (W-CNTL-FILE-ID)
 10649*         SET        (ADDRESS OF CONTROL-FILE)
 10650*         RIDFLD     (W-CNTL-KEY)
 10651*         UPDATE
 10652*    END-EXEC.
 10653*    MOVE '&"S        EU         (   #00010293' TO DFHEIV0
 10654     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10655     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10656     MOVE X'2020233030303130323933' TO DFHEIV0(25:11)
 10657     CALL 'kxdfhei1' USING DFHEIV0,
 10658           W-CNTL-FILE-ID,
 10659           DFHEIV20,
 10660           DFHEIV99,
 10661           W-CNTL-KEY,
 10662           DFHEIV99,
 10663           DFHEIV99,
 10664           DFHEIV99
 10665     SET ADDRESS OF CONTROL-FILE TO
 10666         DFHEIV20
 10667     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10668
 10669
 10670     IF  CF-CREDIT-LAST-ARCH-NUM NOT NUMERIC
 10671         MOVE ZEROS              TO CF-CREDIT-LAST-ARCH-NUM
 10672                                    CF-CREDIT-START-ARCH-NUM.
 10673
 10674     ADD 1                       TO CF-CREDIT-LAST-ARCH-NUM.
 10675     MOVE CF-CREDIT-LAST-ARCH-NUM
 10676                                 TO W-ARCH-NUMBER
 10677                                    W-ARCT-NUMBER.
 10678
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 220
* EL689.cbl
 10679
 10680* EXEC CICS REWRITE
 10681*         FROM      (CONTROL-FILE)
 10682*         DATASET   (W-CNTL-FILE-ID)
 10683*    END-EXEC
 10684     MOVE LENGTH OF
 10685      CONTROL-FILE
 10686       TO DFHEIV11
 10687*    MOVE '&& L                  %   #00010309' TO DFHEIV0
 10688     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10689     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10690     MOVE X'2020233030303130333039' TO DFHEIV0(25:11)
 10691     CALL 'kxdfhei1' USING DFHEIV0,
 10692           W-CNTL-FILE-ID,
 10693           CONTROL-FILE,
 10694           DFHEIV11,
 10695           DFHEIV99
 10696     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10697
 10698
 10699* EXEC CICS HANDLE CONDITION
 10700*         NOTOPEN   (8010-ARCH-NOT-OPEN)
 10701*    END-EXEC.
 10702*    MOVE '"$J                   ! - #00010314' TO DFHEIV0
 10703     MOVE X'22244A202020202020202020' TO DFHEIV0(1:12)
 10704     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10705     MOVE X'2D20233030303130333134' TO DFHEIV0(25:11)
 10706     CALL 'kxdfhei1' USING DFHEIV0
 10707     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10708
 10709
 10710     IF  PI-689-CREATE-NO-SCREENS
 10711         IF  PI-689-GET-ARCH-MAIN
 10712
 10713* EXEC CICS GETMAIN
 10714*                 SET      (ADDRESS OF LETTER-ARCHIVE)
 10715*                 LENGTH   (W-ARCH-LENGTH)
 10716*            END-EXEC
 10717*    MOVE '," L                  $   #00010320' TO DFHEIV0
 10718     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 10719     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10720     MOVE X'2020233030303130333230' TO DFHEIV0(25:11)
 10721     CALL 'kxdfhei1' USING DFHEIV0,
 10722           DFHEIV20,
 10723           W-ARCH-LENGTH,
 10724           DFHEIV99
 10725     SET ADDRESS OF LETTER-ARCHIVE TO
 10726         DFHEIV20
 10727     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10728             SET LCP-WS-ADDR-PNTR TO ADDRESS OF LETTER-ARCHIVE
 10729             MOVE LCP-WS-ADDR-COMP TO PI-689-ARCH-POINTER
 10730         ELSE
 10731             MOVE PI-689-ARCH-POINTER
 10732                                 TO LCP-WS-ADDR-COMP
 10733             SET ADDRESS OF LETTER-ARCHIVE TO LCP-WS-ADDR-PNTR
 10734     ELSE
 10735
 10736* EXEC CICS GETMAIN
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 221
* EL689.cbl
 10737*             SET      (ADDRESS OF LETTER-ARCHIVE)
 10738*             LENGTH   (W-ARCH-LENGTH)
 10739*        END-EXEC.
 10740*    MOVE '," L                  $   #00010331' TO DFHEIV0
 10741     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 10742     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10743     MOVE X'2020233030303130333331' TO DFHEIV0(25:11)
 10744     CALL 'kxdfhei1' USING DFHEIV0,
 10745           DFHEIV20,
 10746           W-ARCH-LENGTH,
 10747           DFHEIV99
 10748     SET ADDRESS OF LETTER-ARCHIVE TO
 10749         DFHEIV20
 10750     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10751
 10752
 10753     MOVE SPACES                 TO LETTER-ARCHIVE.
 10754     MOVE 'LA'                   TO LA-RECORD-ID.
 10755     MOVE W-ARCH-NUMBER          TO LA-ARCHIVE-NO
 10756                                    LA-ARCHIVE-NO-A2
 10757                                    LA-ARCHIVE-NO-A3
 10758                                    LA-ARCHIVE-NO-A4
 10759                                    LA-ARCHIVE-NO-A5
 10760                                    LA-ARCHIVE-NO-A6
 10761                                    PI-689-ARCHIVE-NUMBER.
 10762     MOVE PI-COMPANY-CD          TO LA-COMPANY-CD
 10763                                    LA-COMPANY-CD-A2
 10764                                    LA-COMPANY-CD-A3
 10765                                    LA-COMPANY-CD-A4
 10766                                    LA-COMPANY-CD-A5
 10767                                    LA-COMPANY-CD-A6.
 10768     MOVE PI-689-CARRIER         TO LA-CARRIER-A2
 10769                                    LA-CARRIER-A3
 10770                                    LA-CARRIER-A4
 10771                                    LA-CARRIER-A5.
 10772     MOVE PI-689-EFF-DATE        TO LA-EFFECT-DATE-A2.
 10773     MOVE PI-689-GROUPING        TO LA-GROUPING-A2
 10774                                    LA-GROUPING-A3
 10775                                    LA-GROUPING-A4
 10776                                    LA-GROUPING-A5.
 10777     MOVE PI-689-ACCOUNT         TO LA-ACCOUNT-A2
 10778                                    LA-ACCOUNT-A3
 10779                                    LA-ACCOUNT-A4
 10780                                    LA-ACCOUNT-A5.
 10781     MOVE PI-689-STATE           TO LA-STATE-A2
 10782                                    LA-STATE-A3
 10783                                    LA-STATE-A4
 10784                                    LA-STATE-A5.
 10785
 10786     IF  PI-689-DATA-SOURCE EQUAL '3'
 10787             AND
 10788         PI-689-RESP-PERSON GREATER THAN SPACES
 10789         MOVE PI-689-RESP-PERSON
 10790                                 TO LA-RESP-PERSON-A2
 10791         MOVE PI-689-TYPE        TO LA-TYPE-A2
 10792     ELSE
 10793         IF  PI-689-CERT-PRIME GREATER THAN SPACES
 10794             MOVE PI-689-CERT-PRIME
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 222
* EL689.cbl
 10795                                 TO LA-CERT-PRIME-A2
 10796             MOVE PI-689-CERT-SFX
 10797                                 TO LA-CERT-SUFFIX-A2
 10798         ELSE
 10799             MOVE LOW-VALUE      TO LA-RESP-PERSON-A2
 10800                                    LA-TYPE-A2.
 10801
 10802     IF  PI-689-ENTRY-BATCH GREATER THAN SPACES
 10803         MOVE PI-689-ENTRY-BATCH TO LA-ENTRY-A6
 10804         IF  PI-689-CONTROL GREATER THAN ZEROS
 10805                 AND
 10806             PI-689-PRINT-RESTRICTION EQUAL 'C'
 10807             MOVE PI-689-CONTROL TO LA-QUE-CONTROL-A6
 10808             MOVE 'CK'           TO LA-FILLER
 10809         ELSE
 10810             NEXT SENTENCE
 10811     ELSE
 10812         IF  PI-689-CONTROL GREATER THAN ZEROS
 10813             MOVE PI-689-CONTROL TO LA-QUE-CONTROL-A6
 10814             MOVE 'CK'           TO LA-FILLER
 10815         ELSE
 10816             MOVE LOW-VALUES     TO LA-ENTRY-A6.
 10817
 10818     MOVE ZEROS                  TO W-SEQ-CTR.
 10819
 10820     MOVE PI-PROCESSOR-ID        TO LA-PROCESSOR-CD.
 10821
 10822     MOVE LOW-VALUES             TO LA-LAST-RESENT-PRINT-DATE
 10823                                    LA-INITIAL-PRINT-DATE
 10824                                    LA-SENT-DATE
 10825                                    LA-REPLY-DATE.
 10826     MOVE 'A'                    TO LA-STATUS.
 10827
 10828     IF  PI-689-NUMBER-COPIES NOT NUMERIC
 10829             OR
 10830         PI-689-NUMBER-COPIES EQUAL ZEROS
 10831         MOVE  1                 TO LA-NO-OF-COPIES
 10832     ELSE
 10833         MOVE PI-689-NUMBER-COPIES
 10834                                 TO LA-NO-OF-COPIES.
 10835
 10836     MOVE PI-689-FORM-NUMBER     TO LA-FORM-A3.
 10837     MOVE PI-689-FOLLOW-UP-DATE  TO LA-FOLLOW-UP-DATE.
 10838     MOVE PI-689-PRINT-RESTRICTION
 10839                                 TO LA-PRINT-RESTRICTION
 10840     MOVE PI-689-LABEL-SOURCE    TO LA-ADDR-SOURCE.
 10841     MOVE PI-689-DATA-SOURCE     TO LA-DATA-SOURCE.
 10842     MOVE PI-689-RESEND-DATE-1   TO LA-RESEND-DATE
 10843     MOVE PI-689-RESEND-LETR-1   TO LA-RESEND-LETR
 10844     MOVE W-CURRENT-SAVE         TO LA-CREATION-DATE.
 10845
 10846     IF  PI-689-PRINT-PERFORMED
 10847         MOVE SPACES             TO PI-689-PRINT-SW
 10848         MOVE W-CURRENT-SAVE     TO LA-INITIAL-PRINT-DATE
 10849         IF  LA-RESEND-DATE = LOW-VALUES
 10850             MOVE 'C'            TO LA-STATUS.
 10851
 10852     MOVE PI-689-NUMBER-LABEL-LINES
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 223
* EL689.cbl
 10853                                 TO LA-NUMBER-LABEL-LINES.
 10854     MOVE ZEROS                  TO PI-689-NUMBER-TEXT-RECORDS.
 10855
 10856     PERFORM 5410-CREATE-TEXT-RECORDS THRU 5410-EXIT.
 10857
 10858     MOVE PI-689-NUMBER-TEXT-RECORDS
 10859                                 TO LA-NO-OF-TEXT-RECORDS.
 10860
 10861
 10862* EXEC CICS HANDLE CONDITION
 10863*        DUPREC    (5460-DUPLICATE-ARCHIVE-RCD)
 10864*    END-EXEC.
 10865*    MOVE '"$%                   ! . #00010444' TO DFHEIV0
 10866     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 10867     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10868     MOVE X'2E20233030303130343434' TO DFHEIV0(25:11)
 10869     CALL 'kxdfhei1' USING DFHEIV0
 10870     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10871
 10872
 10873     PERFORM 5650-WRITE-ARCHIVE THRU 5650-EXIT.
 10874
 10875     IF  PI-689-CREATE-NO-SCREENS
 10876         GO TO 5400-END.
 10877
 10878     MOVE ER-0280                TO EMI-ERROR.
 10879     MOVE -1                     TO MAINTL.
 10880     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10881     MOVE W-ARCH-NUMBER          TO W-ARCH-SUPPRESS
 10882     MOVE W-ARCH-EDIT            TO EMI-TEXT-VARIABLE (1).
 10883
 10884 5400-END.
 10885
 10886     MOVE '2'                    TO PI-ACTION.
 10887     MOVE ZEROS                  TO PI-TOTAL-LINES
 10888                                    PI-CURRENT-LINE.
 10889     MOVE SPACES                 TO PI-689-PRINT-SW
 10890                                    PI-689-FORM-NUMBER.
 10891
 10892     IF  PI-689-CREATE-NO-SCREENS
 10893         GO TO 5400-EXIT
 10894     ELSE
 10895         MOVE LOW-VALUES         TO EL689AI
 10896         MOVE -1                 TO MAINTL
 10897         GO TO 8350-SEND-DATAONLY-ERASEAUP.
 10898
 10899 5400-EXIT.
 10900     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 224
* EL689.cbl
 10902 5410-CREATE-TEXT-RECORDS.
 10903
 10904
 10905* EXEC CICS HANDLE CONDITION
 10906*         NOTOPEN   (8015-ARCT-NOT-OPEN)
 10907*         DUPREC    (5465-DUPLICATE-ARCH-TEXT)
 10908*    END-EXEC.
 10909*    MOVE '"$J%                  ! / #00010479' TO DFHEIV0
 10910     MOVE X'22244A252020202020202020' TO DFHEIV0(1:12)
 10911     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10912     MOVE X'2F20233030303130343739' TO DFHEIV0(25:11)
 10913     CALL 'kxdfhei1' USING DFHEIV0
 10914     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10915
 10916
 10917     IF  PI-689-CREATE-NO-SCREENS
 10918         IF  PI-689-GET-ARCT-MAIN
 10919
 10920* EXEC CICS GETMAIN
 10921*                 SET      (ADDRESS OF LETTER-ARCHIVE-TEXT)
 10922*                 LENGTH   (W-ARCT-LENGTH)
 10923*            END-EXEC
 10924*    MOVE '," L                  $   #00010486' TO DFHEIV0
 10925     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 10926     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10927     MOVE X'2020233030303130343836' TO DFHEIV0(25:11)
 10928     CALL 'kxdfhei1' USING DFHEIV0,
 10929           DFHEIV20,
 10930           W-ARCT-LENGTH,
 10931           DFHEIV99
 10932     SET ADDRESS OF LETTER-ARCHIVE-TEXT TO
 10933         DFHEIV20
 10934     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10935             SET LCP-WS-ADDR-PNTR TO ADDRESS OF
 10936                                     LETTER-ARCHIVE-TEXT
 10937             MOVE LCP-WS-ADDR-COMP
 10938                                 TO PI-689-ARCT-POINTER
 10939         ELSE
 10940             MOVE PI-689-ARCT-POINTER
 10941                                 TO LCP-WS-ADDR-COMP
 10942             SET ADDRESS OF LETTER-ARCHIVE-TEXT
 10943                                 TO LCP-WS-ADDR-PNTR
 10944     ELSE
 10945
 10946* EXEC CICS GETMAIN
 10947*             SET      (ADDRESS OF LETTER-ARCHIVE-TEXT)
 10948*             LENGTH   (W-ARCT-LENGTH)
 10949*        END-EXEC.
 10950*    MOVE '," L                  $   #00010500' TO DFHEIV0
 10951     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 10952     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10953     MOVE X'2020233030303130353030' TO DFHEIV0(25:11)
 10954     CALL 'kxdfhei1' USING DFHEIV0,
 10955           DFHEIV20,
 10956           W-ARCT-LENGTH,
 10957           DFHEIV99
 10958     SET ADDRESS OF LETTER-ARCHIVE-TEXT TO
 10959         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 225
* EL689.cbl
 10960     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10961
 10962
 10963     PERFORM 5415-INITIALIZE-TEXT THRU 5415-EXIT.
 10964
 10965     MOVE ZEROS                  TO W-SEQ-CTR
 10966
 10967     IF  PI-CREATE-LABELS AND
 10968         NOT PI-689-LABELS-OVERRIDEN
 10969         MOVE '1'                TO LT-RECORD-TYPE
 10970         MOVE +0                 TO LT-LINE-SEQ-NO
 10971         PERFORM 5600-FORMAT-ADDRESS-LINE THRU 5600-EXIT
 10972                 VARYING
 10973             W-RG-NDX FROM 1 BY 1
 10974                 UNTIL
 10975             W-RG-NDX GREATER THAN PI-689-NUMBER-LABEL-LINES
 10976         PERFORM 5655-WRITE-ARCHIVE-TEXT THRU 5655-EXIT
 10977         PERFORM 5415-INITIALIZE-TEXT THRU 5415-EXIT
 10978     ELSE
 10979         SET W-RG-NDX            TO +1.
 10980
 10981     SET LT-NDX                  TO W-ZEROS.
 10982
 10983     PERFORM 5500-FORMAT-TEXT THRU 5500-EXIT
 10984             VARYING
 10985         W-RG-NDX FROM W-RG-NDX BY +1
 10986             UNTIL
 10987         W-RG-NDX GREATER THAN PI-TOTAL-LINES.
 10988
 10989 5410-EXIT.
 10990     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 226
* EL689.cbl
 10992 5415-INITIALIZE-TEXT.
 10993
 10994     MOVE SPACES                 TO LETTER-ARCHIVE-TEXT.
 10995     MOVE 'LT'                   TO LT-RECORD-ID.
 10996
 10997     MOVE LA-ARCHIVE-NO          TO LT-ARCHIVE-NO.
 10998     MOVE PI-COMPANY-CD          TO LT-COMPANY-CD.
 10999
 11000     MOVE ZEROS                  TO LT-LINE-SEQ-NO
 11001                                    LT-NUM-LINES-ON-RECORD.
 11002
 11003 5415-EXIT.
 11004     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 227
* EL689.cbl
 11006 5460-DUPLICATE-ARCHIVE-RCD.
 11007
 11008     IF  NOT PI-689-CREATE-NO-SCREENS
 11009
 11010* EXEC CICS SYNCPOINT ROLLBACK
 11011*        END-EXEC.
 11012*    MOVE '6"R                   !   #00010551' TO DFHEIV0
 11013     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 11014     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11015     MOVE X'2020233030303130353531' TO DFHEIV0(25:11)
 11016     CALL 'kxdfhei1' USING DFHEIV0
 11017     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11018
 11019
 11020     MOVE ER-9426                TO EMI-ERROR.
 11021     MOVE -1                     TO MAINTL.
 11022     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11023     GO TO 8200-SEND-DATAONLY.
 11024
 11025 5465-DUPLICATE-ARCH-TEXT.
 11026
 11027     IF  NOT PI-689-CREATE-NO-SCREENS
 11028
 11029* EXEC CICS SYNCPOINT ROLLBACK
 11030*        END-EXEC.
 11031*    MOVE '6"R                   !   #00010562' TO DFHEIV0
 11032     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 11033     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11034     MOVE X'2020233030303130353632' TO DFHEIV0(25:11)
 11035     CALL 'kxdfhei1' USING DFHEIV0
 11036     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11037
 11038
 11039     MOVE ER-7369                TO EMI-ERROR.
 11040     MOVE -1                     TO MAINTL.
 11041     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11042     GO TO 8200-SEND-DATAONLY.
 11043
 11044 5470-CNTL-NOT-FOUND.
 11045
 11046     MOVE ER-9299                TO EMI-ERROR.
 11047     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11048     MOVE -1                     TO MAINTL.
 11049     MOVE AL-UANON               TO MAINTA.
 11050     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 228
* EL689.cbl
 11052 5500-FORMAT-TEXT.
 11053
 11054     SET LT-NDX UP BY +1.
 11055
 11056     IF  W-RC-TEXT (W-RG-NDX) EQUAL W-TOP-FORM
 11057         SET W-RG-NDX UP BY 1
 11058         MOVE 99                 TO LT-SKIP-CONTROL (LT-NDX)
 11059         MOVE W-RC-TEXT (W-RG-NDX)
 11060                                 TO LT-TEXT-LINE (LT-NDX)
 11061     ELSE
 11062         IF  W-RC-TEXT (W-RG-NDX) EQUAL SPACES
 11063             MOVE ZEROS          TO W-PRINT-CONTROL
 11064             PERFORM 5505-FIND-USED-LINE THRU 5505-EXIT
 11065                     VARYING
 11066                 W-RG-NDX FROM W-RG-NDX BY 1
 11067                     UNTIL
 11068                 W-RG-NDX GREATER THAN PI-TOTAL-LINES
 11069                     OR
 11070                 W-RC-TEXT (W-RG-NDX) GREATER THAN SPACES
 11071             IF  W-RG-NDX GREATER THAN PI-TOTAL-LINES
 11072                 GO TO 5500-WRITE-TEST
 11073             ELSE
 11074                 MOVE W-PRINT-CONTROL
 11075                                 TO LT-SKIP-CONTROL (LT-NDX)
 11076                 MOVE W-RC-TEXT (W-RG-NDX)
 11077                                 TO LT-TEXT-LINE (LT-NDX)
 11078         ELSE
 11079             MOVE W-RC-TEXT (W-RG-NDX)
 11080                                 TO LT-TEXT-LINE (LT-NDX)
 11081             MOVE ZEROS          TO W-PRINT-CONTROL.
 11082
 11083     ADD +1                      TO LT-NUM-LINES-ON-RECORD.
 11084
 11085 5500-WRITE-TEST.
 11086
 11087     IF  W-RG-NDX NOT LESS THAN PI-TOTAL-LINES
 11088         IF  LT-TEXT-RECORD NOT EQUAL SPACES
 11089             ADD +1              TO PI-689-NUMBER-TEXT-RECORDS
 11090             MOVE '2'            TO LT-RECORD-TYPE
 11091             ADD +1              TO W-SEQ-CTR
 11092             MOVE W-SEQ-CTR      TO LT-LINE-SEQ-NO
 11093             PERFORM 5655-WRITE-ARCHIVE-TEXT THRU 5655-EXIT
 11094         ELSE
 11095             NEXT SENTENCE
 11096     ELSE
 11097         IF  LT-NDX EQUAL +20
 11098             ADD +1              TO PI-689-NUMBER-TEXT-RECORDS
 11099             MOVE '2'            TO LT-RECORD-TYPE
 11100             ADD +1              TO W-SEQ-CTR
 11101             MOVE W-SEQ-CTR      TO LT-LINE-SEQ-NO
 11102             PERFORM 5655-WRITE-ARCHIVE-TEXT THRU 5655-EXIT
 11103             SET LT-NDX          TO W-ZEROS
 11104             PERFORM 5415-INITIALIZE-TEXT THRU 5415-EXIT.
 11105
 11106 5500-EXIT.
 11107      EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 229
* EL689.cbl
 11109 5505-FIND-USED-LINE.
 11110
 11111     ADD +1                      TO W-PRINT-CONTROL.
 11112
 11113 5505-EXIT.
 11114      EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 230
* EL689.cbl
 11116 5600-FORMAT-ADDRESS-LINE.
 11117
 11118     SET LT-NDX                  TO W-RG-NDX.
 11119     MOVE W-RC-TEXT (W-RG-NDX)   TO LT-TEXT-LINE (LT-NDX).
 11120
 11121 5600-EXIT.
 11122     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 231
* EL689.cbl
 11124 5650-WRITE-ARCHIVE.
 11125
 11126
 11127* EXEC CICS WRITE
 11128*         DATASET   (W-ARCH-FILE-ID)
 11129*         FROM      (LETTER-ARCHIVE)
 11130*         RIDFLD    (LA-CONTROL-PRIMARY)
 11131*    END-EXEC.
 11132     MOVE LENGTH OF
 11133      LETTER-ARCHIVE
 11134       TO DFHEIV11
 11135*    MOVE '&$ L                  ''   #00010652' TO DFHEIV0
 11136     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11137     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11138     MOVE X'2020233030303130363532' TO DFHEIV0(25:11)
 11139     CALL 'kxdfhei1' USING DFHEIV0,
 11140           W-ARCH-FILE-ID,
 11141           LETTER-ARCHIVE,
 11142           DFHEIV11,
 11143           LA-CONTROL-PRIMARY,
 11144           DFHEIV99,
 11145           DFHEIV99
 11146     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11147
 11148
 11149 5650-EXIT.
 11150     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 232
* EL689.cbl
 11152 5655-WRITE-ARCHIVE-TEXT.
 11153
 11154
 11155* EXEC CICS WRITE
 11156*         DATASET   (W-ARCT-FILE-ID)
 11157*         FROM      (LETTER-ARCHIVE-TEXT)
 11158*         RIDFLD    (LT-CONTROL-PRIMARY)
 11159*    END-EXEC.
 11160     MOVE LENGTH OF
 11161      LETTER-ARCHIVE-TEXT
 11162       TO DFHEIV11
 11163*    MOVE '&$ L                  ''   #00010663' TO DFHEIV0
 11164     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11165     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11166     MOVE X'2020233030303130363633' TO DFHEIV0(25:11)
 11167     CALL 'kxdfhei1' USING DFHEIV0,
 11168           W-ARCT-FILE-ID,
 11169           LETTER-ARCHIVE-TEXT,
 11170           DFHEIV11,
 11171           LT-CONTROL-PRIMARY,
 11172           DFHEIV99,
 11173           DFHEIV99
 11174     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11175
 11176
 11177 5655-EXIT.
 11178     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 233
* EL689.cbl
 11180 6000-RESOLVE-VARIABLES.
 11181***************************************************************
 11182*    THIS ROUTINE WILL FORMAT THE SYSTEM DEFINED SYMBOLS      *
 11183*    WITH DATA PERTAINING TO THE FORM WITH VARIABLES.         *
 11184*    THIS ROUTINE IS PERFORM THRU 6000-EXIT IN ORDER TO       *
 11185*    RESOLVE ALL OF THE SYMBOLS.                              *
 11186*                                                             *
 11187***************************************************************
 11188
 11189     PERFORM 6200-GET-COMPANY-DATA THRU 6200-EXIT.
 11190     PERFORM 6250-GET-CNTL2-DATA THRU 6250-EXIT.
 11191     PERFORM 6400-GET-PENDING-DATA THRU 6400-EXIT.
 11192     PERFORM 6450-GET-CERT-DATA THRU 6450-EXIT.
 11193     PERFORM 6500-GET-ACCOUNT-DATA THRU 6500-EXIT
 11194*    PERFORM 6350-GET-CSR-DATA   THRU 6350-EXIT
 11195     PERFORM 6600-GET-COMPENSATION-DATA THRU 6600-EXIT.
 11196     PERFORM 6700-GET-MAIL-DATA THRU 6700-EXIT.
 11197     PERFORM 6300-GET-CARRIER-DATA THRU 6300-EXIT.
 11198     PERFORM 6750-GET-LIFE-BENEFIT-DATA THRU 6750-EXIT.
 11199     PERFORM 6800-GET-A-H-BENEFIT-DATA THRU 6800-EXIT.
 11200     PERFORM 6850-GET-CHECK-DATA THRU 6850-EXIT.
 11201     PERFORM 6900-GET-PYAJ-DATA THRU 6900-EXIT.
 11202     PERFORM 6950-MOVE-SYSTEM-DATA THRU 6950-EXIT.
 11203
 11204     MOVE SPACES                 TO W-REVERSE-DATE-SW.
 11205
 11206 6000-EXIT.
 11207     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 234
* EL689.cbl
 11209 6200-GET-COMPANY-DATA.
 11210
 11211     IF  ADDRSI EQUAL '3'
 11212             AND
 11213         PI-CREATE-LABELS
 11214             AND
 11215         NOT PI-689-LABELS-OVERRIDEN
 11216         NEXT SENTENCE
 11217     ELSE
 11218         IF  W-FILE-NOT-USED (1)
 11219             GO TO 6200-EXIT.
 11220
 11221     MOVE SPACES                 TO W-CNTL-KEY.
 11222     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID.
 11223     MOVE +0                     TO W-CNTL-SEQ-NO.
 11224     MOVE '1'                    TO W-CNTL-RECORD-TYPE.
 11225
 11226
 11227* EXEC CICS HANDLE CONDITION
 11228*         NOTOPEN   (8040-CNTL-NOT-OPEN)
 11229*         NOTFND    (6200-CNTL1-NOT-FOUND)
 11230*    END-EXEC.
 11231*    MOVE '"$JI                  ! 0 #00010718' TO DFHEIV0
 11232     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 11233     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11234     MOVE X'3020233030303130373138' TO DFHEIV0(25:11)
 11235     CALL 'kxdfhei1' USING DFHEIV0
 11236     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11237
 11238
 11239
 11240* EXEC CICS READ
 11241*         DATASET   (W-CNTL-FILE-ID)
 11242*         SET       (ADDRESS OF CONTROL-FILE)
 11243*         RIDFLD    (W-CNTL-KEY)
 11244*    END-EXEC.
 11245*    MOVE '&"S        E          (   #00010723' TO DFHEIV0
 11246     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11247     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11248     MOVE X'2020233030303130373233' TO DFHEIV0(25:11)
 11249     CALL 'kxdfhei1' USING DFHEIV0,
 11250           W-CNTL-FILE-ID,
 11251           DFHEIV20,
 11252           DFHEIV99,
 11253           W-CNTL-KEY,
 11254           DFHEIV99,
 11255           DFHEIV99,
 11256           DFHEIV99
 11257     SET ADDRESS OF CONTROL-FILE TO
 11258         DFHEIV20
 11259     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11260
 11261
 11262     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 11263     MOVE CF-CL-MAIL-TO-NAME     TO W-LABEL-LINES (1)
 11264                                    W-VG-TEXT (25).
 11265     MOVE CF-CL-IN-CARE-OF       TO W-LABEL-LINES (2).
 11266     MOVE CF-CL-ADDR-LINE-1      TO W-LABEL-LINES (3).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 235
* EL689.cbl
 11267     MOVE CF-CL-ADDR-LINE-2      TO W-LABEL-LINES (4).
 11268     MOVE CF-CL-CITY-STATE       TO W-LABEL-LINES (5).
 11269
 11270     IF  CF-CL-CAN-POST-CODE
 11271         MOVE CF-CL-CANADIAN-POSTAL-CODE
 11272                                 TO W-CANADIAN-POSTAL-CODES
 11273         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (6)
 11274         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (6)
 11275         MOVE SPACES             TO W-LAB-CAN-DASH (6)
 11276                                    W-LAB-CAN-FILLER (6)
 11277         GO TO 6200-CONTINUE.
 11278
 11279     IF CF-CL-ZIP-CODE NOT = SPACES AND ZEROS AND LOW-VALUES
 11280         MOVE CF-CL-ZIP-CODE     TO W-WORK-ZIP
 11281         MOVE SPACES             TO W-LABEL-ZIP (6)
 11282         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (6)
 11283
 11284         IF  W-WORK-ZIP4 GREATER THAN '0000'
 11285             MOVE '-'            TO W-LABEL-DASH (6)
 11286             MOVE W-WORK-ZIP4    TO W-LABEL-2ND-ZIP (6)
 11287             GO TO 6200-CONTINUE
 11288         ELSE
 11289             MOVE SPACES         TO W-LABEL-DASH (6)
 11290                                    W-LABEL-2ND-ZIP (6)
 11291             GO TO 6200-CONTINUE.
 11292
 11293     IF  CF-CL-ZIP-CODE-NUM NOT NUMERIC
 11294         GO TO 6200-CONTINUE.
 11295
 11296     MOVE CF-CL-ZIP-CODE-NUM     TO W-WORK-ZIP-NUMERIC.
 11297
 11298     IF  W-WORK-ZIP-NUMERIC LESS THAN +100000
 11299         COMPUTE W-WORK-ZIP-NUMERIC
 11300             = W-WORK-ZIP-NUMERIC * 10000.
 11301
 11302     MOVE SPACES                 TO W-LABEL-ZIP (6).
 11303     MOVE W-WORK-ZIP5            TO W-LABEL-1ST-ZIP (6).
 11304
 11305     IF  W-WORK-ZIP4 GREATER THAN '0000'
 11306         MOVE '-'                TO W-LABEL-DASH (6)
 11307         MOVE W-WORK-ZIP4        TO W-LABEL-2ND-ZIP (6)
 11308         GO TO 6200-CONTINUE
 11309     ELSE
 11310         MOVE SPACES             TO W-LABEL-DASH (6)
 11311                                    W-LABEL-2ND-ZIP (6)
 11312         GO TO 6200-CONTINUE.
 11313
 11314 6200-CONTINUE.
 11315
 11316     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT.
 11317
 11318     IF  ADDRSI EQUAL '3'
 11319             AND
 11320         PI-CREATE-LABELS
 11321             AND
 11322         NOT PI-689-LABELS-OVERRIDEN
 11323         MOVE W-LABEL-LINES (1)  TO W-RC-TEXT (1) W-VG-TEXT (1)
 11324         MOVE W-LABEL-LINES (2)  TO W-RC-TEXT (2) W-VG-TEXT (2)
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 236
* EL689.cbl
 11325         MOVE W-LABEL-LINES (3)  TO W-RC-TEXT (3) W-VG-TEXT (3)
 11326         MOVE W-LABEL-LINES (4)  TO W-RC-TEXT (4) W-VG-TEXT (04)
 11327         MOVE W-LABEL-LINES (5)  TO W-RC-TEXT (5) W-VG-TEXT (5)
 11328         MOVE W-LABEL-LINES (6)  TO W-RC-TEXT (6) W-VG-TEXT (6)
 11329         MOVE W-NUMB-LABEL-LINES TO PI-689-NUMBER-LABEL-LINES
 11330         SET W-RG-NDX            TO PI-689-NUMBER-LABEL-LINES
 11331         SET W-RG-NDX UP BY +1
 11332     ELSE
 11333         MOVE W-LABEL-LINES (1)  TO W-VG-TEXT (1)
 11334         MOVE W-LABEL-LINES (2)  TO W-VG-TEXT (2)
 11335         MOVE W-LABEL-LINES (3)  TO W-VG-TEXT (3)
 11336         MOVE W-LABEL-LINES (4)  TO W-VG-TEXT (4)
 11337         MOVE W-LABEL-LINES (5)  TO W-VG-TEXT (5)
 11338         MOVE W-LABEL-LINES (6)  TO W-VG-TEXT (6).
 11339
 11340     GO TO 6200-EXIT.
 11341
 11342 6200-CNTL1-NOT-FOUND.
 11343
 11344     MOVE ER-9299                TO EMI-ERROR.
 11345     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11346     MOVE -1                     TO ADDRSL.
 11347     MOVE AL-UANON               TO ADDRSA.
 11348     GO TO 8200-SEND-DATAONLY.
 11349
 11350 6200-EXIT.
 11351     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 237
* EL689.cbl
 11353 6250-GET-CNTL2-DATA.
 11354
 11355     IF  PI-PROCESSOR-ID EQUAL W-LGXX-ID
 11356         GO TO 6250-EXIT.
 11357
 11358     IF  W-FILE-NOT-USED (11)
 11359         GO TO 6250-EXIT.
 11360
 11361     MOVE SPACES                 TO W-CNTL-KEY.
 11362     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID.
 11363     MOVE +0                     TO W-CNTL-SEQ-NO.
 11364     MOVE '2'                    TO W-CNTL-RECORD-TYPE.
 11365     MOVE PI-PROCESSOR-ID        TO W-CNTL-GENL.
 11366
 11367
 11368* EXEC CICS HANDLE CONDITION
 11369*         NOTOPEN    (8040-CNTL-NOT-OPEN)
 11370*         NOTFND     (6250-CNTL2-NOT-FOUND)
 11371*    END-EXEC.
 11372*    MOVE '"$JI                  ! 1 #00010834' TO DFHEIV0
 11373     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 11374     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11375     MOVE X'3120233030303130383334' TO DFHEIV0(25:11)
 11376     CALL 'kxdfhei1' USING DFHEIV0
 11377     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11378
 11379
 11380
 11381* EXEC CICS READ
 11382*         DATASET    (W-CNTL-FILE-ID)
 11383*         SET        (ADDRESS OF CONTROL-FILE)
 11384*         RIDFLD     (W-CNTL-KEY)
 11385*    END-EXEC.
 11386*    MOVE '&"S        E          (   #00010839' TO DFHEIV0
 11387     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11388     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11389     MOVE X'2020233030303130383339' TO DFHEIV0(25:11)
 11390     CALL 'kxdfhei1' USING DFHEIV0,
 11391           W-CNTL-FILE-ID,
 11392           DFHEIV20,
 11393           DFHEIV99,
 11394           W-CNTL-KEY,
 11395           DFHEIV99,
 11396           DFHEIV99,
 11397           DFHEIV99
 11398     SET ADDRESS OF CONTROL-FILE TO
 11399         DFHEIV20
 11400     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11401
 11402
 11403     MOVE CF-PROCESSOR           TO W-VG-TEXT (153).
 11404     MOVE CF-PROCESSOR-NAME      TO W-VG-TEXT (151).
 11405     MOVE CF-PROCESSOR-TITLE     TO W-VG-TEXT (152).
 11406     GO TO 6250-EXIT.
 11407
 11408 6250-CNTL2-NOT-FOUND.
 11409
 11410     MOVE ER-9299                TO EMI-ERROR.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 238
* EL689.cbl
 11411     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11412     MOVE -1                     TO MAINTL.
 11413     MOVE AL-UANON               TO MAINTA.
 11414     GO TO 8200-SEND-DATAONLY.
 11415
 11416 6250-EXIT.
 11417     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 239
* EL689.cbl
 11419 6300-GET-CARRIER-DATA.
 11420
 11421     IF  ADDRSI EQUAL '2'
 11422             AND
 11423         PI-CREATE-LABELS
 11424             AND
 11425         NOT PI-689-LABELS-OVERRIDEN
 11426         NEXT SENTENCE
 11427     ELSE
 11428         IF  W-FILE-NOT-USED (4)
 11429             GO TO 6300-EXIT.
 11430
 11431     IF  PI-689-CARRIER GREATER THAN LOW-VALUES
 11432         MOVE SPACES             TO W-CNTL-KEY
 11433         MOVE PI-COMPANY-ID      TO W-CNTL-COMPANY-ID
 11434         MOVE +0                 TO W-CNTL-SEQ-NO
 11435         MOVE '6'                TO W-CNTL-RECORD-TYPE
 11436         MOVE PI-689-CARRIER     TO W-CNTL-GEN4
 11437     ELSE
 11438         MOVE ER-9327            TO EMI-ERROR
 11439         MOVE -1                 TO CARRIERL
 11440         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11441         GO TO 6300-EXIT.
 11442
 11443
 11444* EXEC CICS HANDLE CONDITION
 11445*         NOTOPEN    (8040-CNTL-NOT-OPEN)
 11446*         NOTFND     (6300-CNTL6-NOT-FOUND)
 11447*    END-EXEC.
 11448*    MOVE '"$JI                  ! 2 #00010885' TO DFHEIV0
 11449     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 11450     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11451     MOVE X'3220233030303130383835' TO DFHEIV0(25:11)
 11452     CALL 'kxdfhei1' USING DFHEIV0
 11453     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11454
 11455
 11456
 11457* EXEC CICS READ
 11458*         DATASET    (W-CNTL-FILE-ID)
 11459*         SET        (ADDRESS OF CONTROL-FILE)
 11460*         RIDFLD     (W-CNTL-KEY)
 11461*    END-EXEC.
 11462*    MOVE '&"S        E          (   #00010890' TO DFHEIV0
 11463     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11464     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11465     MOVE X'2020233030303130383930' TO DFHEIV0(25:11)
 11466     CALL 'kxdfhei1' USING DFHEIV0,
 11467           W-CNTL-FILE-ID,
 11468           DFHEIV20,
 11469           DFHEIV99,
 11470           W-CNTL-KEY,
 11471           DFHEIV99,
 11472           DFHEIV99,
 11473           DFHEIV99
 11474     SET ADDRESS OF CONTROL-FILE TO
 11475         DFHEIV20
 11476     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 240
* EL689.cbl
 11477
 11478
 11479     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 11480     MOVE CF-MAIL-TO-NAME        TO W-LABEL-LINES (1).
 11481     MOVE CF-IN-CARE-OF          TO W-LABEL-LINES (2).
 11482     MOVE CF-ADDRESS-LINE-1      TO W-LABEL-LINES (3).
 11483     MOVE CF-ADDRESS-LINE-2      TO W-LABEL-LINES (4).
 11484     MOVE CF-CITY-STATE          TO W-LABEL-LINES (5).
 11485
 11486     IF  CF-CANADIAN-POST-CODE
 11487         MOVE CF-CANADIAN-POSTAL-CODE
 11488                                 TO W-CANADIAN-POSTAL-CODES
 11489         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (6)
 11490         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (6)
 11491         MOVE SPACES             TO W-LAB-CAN-DASH (6)
 11492                                    W-LAB-CAN-FILLER (6)
 11493         GO TO 6300-CONTINUE.
 11494
 11495     IF CF-ZIP-CODE NOT = SPACES AND ZEROS AND LOW-VALUES
 11496         MOVE CF-ZIP-CODE        TO W-WORK-ZIP
 11497         MOVE SPACES             TO W-LABEL-ZIP (6)
 11498         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (6)
 11499         IF  W-WORK-ZIP4 GREATER THAN '0000'
 11500             MOVE '-'            TO W-LABEL-DASH (6)
 11501             MOVE W-WORK-ZIP4
 11502                                 TO W-LABEL-2ND-ZIP (6)
 11503             GO TO 6300-CONTINUE
 11504         ELSE
 11505             MOVE SPACES         TO W-LABEL-DASH (6)
 11506                                    W-LABEL-2ND-ZIP (6)
 11507             GO TO 6300-CONTINUE.
 11508
 11509     IF  CF-ZIP-CODE-NUM NOT NUMERIC
 11510         GO TO 6300-CONTINUE.
 11511
 11512     MOVE CF-ZIP-CODE-NUM TO W-WORK-ZIP-NUMERIC.
 11513
 11514     IF  W-WORK-ZIP-NUMERIC LESS THAN +100000
 11515         COMPUTE W-WORK-ZIP-NUMERIC
 11516             = W-WORK-ZIP-NUMERIC * 10000.
 11517
 11518     MOVE SPACES                 TO W-LABEL-ZIP (6).
 11519     MOVE W-WORK-ZIP5            TO W-LABEL-1ST-ZIP (6).
 11520
 11521     IF  W-WORK-ZIP4 GREATER THAN '0000'
 11522         MOVE '-'                TO W-LABEL-DASH (6)
 11523         MOVE W-WORK-ZIP4        TO W-LABEL-2ND-ZIP (6)
 11524         GO TO 6300-CONTINUE
 11525     ELSE
 11526         MOVE SPACES             TO W-LABEL-DASH (6)
 11527                                    W-LABEL-2ND-ZIP (6)
 11528         GO TO 6300-CONTINUE.
 11529
 11530 6300-CONTINUE.
 11531
 11532     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT.
 11533
 11534     IF  ADDRSI EQUAL '2'
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 241
* EL689.cbl
 11535             AND
 11536         PI-CREATE-LABELS
 11537             AND
 11538         NOT PI-689-LABELS-OVERRIDEN
 11539         MOVE W-LABEL-LINES (1)  TO W-RC-TEXT (1) W-VG-TEXT (20)
 11540         MOVE W-LABEL-LINES (2)  TO W-RC-TEXT (2) W-VG-TEXT (21)
 11541         MOVE W-LABEL-LINES (3)  TO W-RC-TEXT (3) W-VG-TEXT (22)
 11542         MOVE W-LABEL-LINES (4)  TO W-RC-TEXT (4) W-VG-TEXT (23)
 11543         MOVE W-LABEL-LINES (5)  TO W-RC-TEXT (5) W-VG-TEXT (24)
 11544         MOVE W-LABEL-LINES (6)  TO W-RC-TEXT (6) W-VG-TEXT (25)
 11545         MOVE W-NUMB-LABEL-LINES TO PI-689-NUMBER-LABEL-LINES
 11546         SET W-RG-NDX            TO PI-689-NUMBER-LABEL-LINES
 11547         SET W-RG-NDX UP BY +1
 11548     ELSE
 11549         MOVE W-LABEL-LINES (1)  TO W-VG-TEXT (20)
 11550         MOVE W-LABEL-LINES (2)  TO W-VG-TEXT (21)
 11551         MOVE W-LABEL-LINES (3)  TO W-VG-TEXT (22)
 11552         MOVE W-LABEL-LINES (4)  TO W-VG-TEXT (23)
 11553         MOVE W-LABEL-LINES (5)  TO W-VG-TEXT (24)
 11554         MOVE W-LABEL-LINES (6)  TO W-VG-TEXT (25).
 11555
 11556     IF  W-FULL-DATA
 11557         MOVE ZEROS              TO W-PHONE-IN
 11558         MOVE CF-PHONE-NO        TO W-PHONE-IN
 11559         MOVE W-PHI-AREA         TO W-PO-AREA
 11560         MOVE W-PHI-PFX          TO W-PO-PFX
 11561         MOVE W-PHI-SFX          TO W-PO-SFX
 11562         MOVE W-PHONE-OUT        TO W-VG-TEXT (26).
 11563
 11564     GO TO 6300-EXIT.
 11565
 11566 6300-CNTL6-NOT-FOUND.
 11567
 11568     MOVE ER-9298                TO EMI-ERROR.
 11569     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11570     MOVE -1                     TO ADDRSL.
 11571     MOVE AL-UANON               TO ADDRSA.
 11572     GO TO 8200-SEND-DATAONLY.
 11573
 11574 6300-EXIT.
 11575     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 242
* EL689.cbl
 11577 6350-GET-CSR-DATA.
 11578     IF W-VG-TEXT (148) (1:4) = '****' OR SPACES
 11579        GO TO 6350-EXIT
 11580     END-IF
 11581*    IF W-FILE-NOT-USED (11)
 11582*       GO TO 6350-EXIT
 11583*    END-IF
 11584     MOVE SPACES                 TO W-CNTL-KEY
 11585     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID
 11586     MOVE +0                     TO W-CNTL-SEQ-NO
 11587     MOVE '2'                    TO W-CNTL-RECORD-TYPE
 11588     MOVE CO-CSR-CODE            TO W-CNTL-GENL
 11589
 11590* EXEC CICS HANDLE CONDITION
 11591*         NOTOPEN    (8040-CNTL-NOT-OPEN)
 11592*         NOTFND     (6350-CNTL2-NOT-FOUND)
 11593*    END-EXEC
 11594*    MOVE '"$JI                  ! 3 #00011006' TO DFHEIV0
 11595     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 11596     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11597     MOVE X'3320233030303131303036' TO DFHEIV0(25:11)
 11598     CALL 'kxdfhei1' USING DFHEIV0
 11599     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11600
 11601* EXEC CICS READ
 11602*         DATASET    (W-CNTL-FILE-ID)
 11603*         SET        (ADDRESS OF CONTROL-FILE)
 11604*         RIDFLD     (W-CNTL-KEY)
 11605*    END-EXEC
 11606*    MOVE '&"S        E          (   #00011010' TO DFHEIV0
 11607     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11608     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11609     MOVE X'2020233030303131303130' TO DFHEIV0(25:11)
 11610     CALL 'kxdfhei1' USING DFHEIV0,
 11611           W-CNTL-FILE-ID,
 11612           DFHEIV20,
 11613           DFHEIV99,
 11614           W-CNTL-KEY,
 11615           DFHEIV99,
 11616           DFHEIV99,
 11617           DFHEIV99
 11618     SET ADDRESS OF CONTROL-FILE TO
 11619         DFHEIV20
 11620     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11621     MOVE CF-PROCESSOR-TITLE     TO W-VG-TEXT (154)
 11622     GO TO 6350-EXIT
 11623     .
 11624 6350-CNTL2-NOT-FOUND.
 11625     MOVE ER-9299                TO EMI-ERROR.
 11626     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11627     MOVE -1                     TO MAINTL.
 11628     MOVE AL-UANON               TO MAINTA.
 11629     GO TO 8200-SEND-DATAONLY.
 11630 6350-EXIT.
 11631     EXIT.
 11632 6400-GET-PENDING-DATA.
 11633
 11634     IF (ADDRSI EQUAL '7')
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 243
* EL689.cbl
 11635        AND (PI-CREATE-LABELS)
 11636        AND (NOT PI-689-LABELS-OVERRIDEN)
 11637        CONTINUE
 11638     ELSE
 11639        IF PI-689-DATA-SOURCE = '4'
 11640           CONTINUE
 11641        ELSE
 11642           IF W-FILE-NOT-USED (9)
 11643              GO TO 6400-EXIT
 11644           END-IF
 11645        END-IF
 11646     END-IF
 11647     IF  W-PNDB-ENTRY EQUAL LOW-VALUES
 11648         MOVE ER-9327            TO EMI-ERROR
 11649         MOVE -1                 TO MAINTL
 11650         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11651         GO TO 6400-EXIT.
 11652
 11653 6400-READ-PNDB-ONLY.
 11654
 11655
 11656* EXEC CICS HANDLE CONDITION
 11657*         NOTOPEN (8060-PNDB-NOT-OPEN)
 11658*         NOTFND  (8070-PNDB-NOT-FOUND)
 11659*    END-EXEC.
 11660*    MOVE '"$JI                  ! 4 #00011049' TO DFHEIV0
 11661     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 11662     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11663     MOVE X'3420233030303131303439' TO DFHEIV0(25:11)
 11664     CALL 'kxdfhei1' USING DFHEIV0
 11665     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11666
 11667
 11668
 11669* EXEC CICS READ
 11670*         DATASET (W-PNDB-FILE-ID)
 11671*         SET     (ADDRESS OF PENDING-BUSINESS)
 11672*         RIDFLD  (W-PNDB-KEY)
 11673*    END-EXEC.
 11674*    MOVE '&"S        E          (   #00011054' TO DFHEIV0
 11675     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11676     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11677     MOVE X'2020233030303131303534' TO DFHEIV0(25:11)
 11678     CALL 'kxdfhei1' USING DFHEIV0,
 11679           W-PNDB-FILE-ID,
 11680           DFHEIV20,
 11681           DFHEIV99,
 11682           W-PNDB-KEY,
 11683           DFHEIV99,
 11684           DFHEIV99,
 11685           DFHEIV99
 11686     SET ADDRESS OF PENDING-BUSINESS TO
 11687         DFHEIV20
 11688     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11689
 11690
 11691     MOVE 'Y'                    TO W-PNDB-FOUND-SW.
 11692
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 244
* EL689.cbl
 11693     IF  W-CERT-CERT-PRIME EQUAL LOW-VALUES
 11694         MOVE PB-SV-CARRIER      TO PB-CARRIER
 11695                                    PI-689-CARRIER
 11696         MOVE PB-SV-GROUPING     TO PB-GROUPING
 11697                                    PI-689-GROUPING
 11698         MOVE PB-SV-STATE        TO PB-STATE
 11699                                    PI-689-STATE
 11700         MOVE PB-CONTROL-BY-ACCOUNT
 11701                                 TO W-CERT-KEY
 11702                                    W-MAIL-KEY
 11703                                    W-ACCT-KEY
 11704         MOVE PB-ACCOUNT         TO PI-689-ACCOUNT
 11705         MOVE PB-CERT-EFF-DT     TO PI-689-EFF-DATE
 11706         MOVE PB-CERT-NO         TO PI-689-CERT-NO.
 11707
 11708 6400-ONLY-STOP.
 11709
 11710     MOVE PB-ENTRY-BATCH         TO W-VG-TEXT (130).
 11711
 11712     IF  NOT PB-ISSUE
 11713         GO TO 6400-CANCEL.
 11714
 11715     MOVE PB-I-BIRTHDAY          TO DC-BIN-DATE-1.
 11716     MOVE SPACES                 TO DC-OPTION-CODE.
 11717     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 11718
 11719     IF  NO-CONVERSION-ERROR
 11720         MOVE DC-GREG-DATE-1-EDIT
 11721                                 TO W-VG-TEXT (110).
 11722
 11723     MOVE PB-I-AGE               TO W-EDIT-3-0.
 11724     MOVE W-EDIT-3-0             TO W-VG-TEXT (124).
 11725     MOVE PB-I-LF-PREMIUM-AMT    TO W-EDIT-7-2.
 11726     MOVE W-EDIT-7-2             TO W-VG-TEXT (111).
 11727     MOVE PB-I-AH-PREMIUM-AMT    TO W-EDIT-7-2.
 11728     MOVE W-EDIT-7-2             TO W-VG-TEXT (112).
 11729     MOVE PB-I-LF-PREM-CALC      TO W-EDIT-7-2.
 11730     MOVE W-EDIT-7-2             TO W-VG-TEXT (113).
 11731     MOVE PB-I-AH-PREM-CALC      TO W-EDIT-7-2.
 11732     MOVE W-EDIT-7-2             TO W-VG-TEXT (114).
 11733     MOVE PB-I-LF-BENEFIT-AMT    TO W-EDIT-9-2.
 11734     MOVE W-EDIT-9-2             TO W-VG-TEXT (125).
 11735     MOVE PB-I-AH-BENEFIT-AMT    TO W-EDIT-7-2.
 11736     MOVE W-EDIT-7-2             TO W-VG-TEXT (126).
 11737     MOVE PB-I-LF-RATE           TO W-EDIT-2-5-S.
 11738     MOVE W-EDIT-2-5-S           TO W-VG-TEXT (127).
 11739     MOVE PB-I-AH-RATE           TO W-EDIT-2-5-S.
 11740     MOVE W-EDIT-2-5-S           TO W-VG-TEXT (128).
 11741     MOVE PB-I-LOAN-TERM         TO W-EDIT-3-0.
 11742     MOVE W-EDIT-3-0             TO W-VG-TEXT (129).
 11743
 11744     COMPUTE W-DIFFERENCE
 11745         = PB-I-LF-PREM-CALC - PB-I-LF-PREMIUM-AMT.
 11746
 11747     MOVE W-DIFFERENCE           TO W-EDIT-7-2.
 11748     MOVE W-EDIT-7-2             TO W-VG-TEXT (115).
 11749
 11750     COMPUTE W-DIFFERENCE
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 245
* EL689.cbl
 11751         = PB-I-AH-PREM-CALC - PB-I-AH-PREMIUM-AMT.
 11752
 11753     MOVE W-DIFFERENCE           TO W-EDIT-7-2.
 11754     MOVE W-EDIT-7-2             TO W-VG-TEXT (116).
 11755
 11756 6400-CANCEL.
 11757
 11758     IF  NOT PB-CANCELLATION
 11759         GO TO 6400-EXIT.
 11760
 11761     MOVE PB-CI-AH-PRIOR-CANCEL-DT
 11762                                 TO DC-BIN-DATE-1.
 11763     MOVE SPACES                 TO DC-OPTION-CODE.
 11764     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 11765
 11766     IF  NO-CONVERSION-ERROR
 11767         MOVE DC-GREG-DATE-1-EDIT
 11768                                 TO W-VG-TEXT (117).
 11769
 11770     MOVE PB-C-LF-CANCEL-AMT     TO W-EDIT-7-2.
 11771     MOVE W-EDIT-7-2             TO W-VG-TEXT (118).
 11772     MOVE PB-C-AH-CANCEL-AMT     TO W-EDIT-7-2.
 11773     MOVE W-EDIT-7-2             TO W-VG-TEXT (119).
 11774     MOVE PB-C-LF-REF-CALC       TO W-EDIT-7-2.
 11775     MOVE W-EDIT-7-2             TO W-VG-TEXT (120).
 11776     MOVE PB-C-AH-REF-CALC       TO W-EDIT-7-2.
 11777     MOVE W-EDIT-7-2             TO W-VG-TEXT (121).
 11778     COMPUTE W-EDIT-7-2 = PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT
 11779     MOVE W-EDIT-7-2             TO W-VG-TEXT (131)
 11780
 11781     IF PB-C-NH-INT-ON-REFS NOT NUMERIC
 11782        MOVE ZEROS               TO PB-C-NH-INT-ON-REFS
 11783     END-IF
 11784     MOVE PB-C-NH-INT-ON-REFS    TO W-EDIT-7-2
 11785     MOVE W-EDIT-7-2             TO W-VG-TEXT (132)
 11786     MOVE PB-C-LF-CANCEL-DT      TO DC-BIN-DATE-1
 11787     IF PB-C-AH-CANCEL-DT > DC-BIN-DATE-1
 11788        MOVE PB-C-AH-CANCEL-DT   TO DC-BIN-DATE-1
 11789     END-IF
 11790     MOVE SPACES                 TO DC-OPTION-CODE
 11791     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
 11792
 11793     IF NO-CONVERSION-ERROR
 11794        MOVE DC-GREG-DATE-1-EDIT TO W-VG-TEXT (133)
 11795     END-IF
 11796
 11797     COMPUTE W-DIFFERENCE = PB-C-LF-REF-CALC
 11798                           - PB-C-LF-CANCEL-AMT.
 11799
 11800     MOVE W-DIFFERENCE           TO W-EDIT-7-2.
 11801     MOVE W-EDIT-7-2             TO W-VG-TEXT (122).
 11802
 11803     COMPUTE W-DIFFERENCE = PB-C-AH-REF-CALC
 11804                           - PB-C-AH-CANCEL-AMT.
 11805
 11806     MOVE W-DIFFERENCE           TO W-EDIT-7-2.
 11807     MOVE W-EDIT-7-2             TO W-VG-TEXT (123).
 11808
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 246
* EL689.cbl
 11809 6400-EXIT.
 11810     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 247
* EL689.cbl
 11812 6450-GET-CERT-DATA.
 11813     IF  W-FILE-NOT-USED (8)
 11814         GO TO 6450-EXIT.
 11815
 11816     IF  W-CERT-CERT-PRIME EQUAL LOW-VALUES
 11817         MOVE ER-9327            TO EMI-ERROR
 11818         MOVE -1                 TO MAINTL
 11819         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11820         GO TO 6450-EXIT.
 11821
 11822 6450-READ-CERT-ONLY.
 11823
 11824
 11825* EXEC CICS HANDLE CONDITION
 11826*         NOTOPEN (8030-CERT-NOT-OPEN)
 11827*         NOTFND  (8035-CERT-NOT-FOUND)
 11828*    END-EXEC.
 11829*    MOVE '"$JI                  ! 5 #00011193' TO DFHEIV0
 11830     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 11831     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11832     MOVE X'3520233030303131313933' TO DFHEIV0(25:11)
 11833     CALL 'kxdfhei1' USING DFHEIV0
 11834     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11835
 11836
 11837
 11838* EXEC CICS READ
 11839*         DATASET (W-CERT-FILE-ID)
 11840*         SET     (ADDRESS OF CERTIFICATE-MASTER)
 11841*         RIDFLD  (W-CERT-KEY)
 11842*    END-EXEC.
 11843*    MOVE '&"S        E          (   #00011198' TO DFHEIV0
 11844     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11845     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11846     MOVE X'2020233030303131313938' TO DFHEIV0(25:11)
 11847     CALL 'kxdfhei1' USING DFHEIV0,
 11848           W-CERT-FILE-ID,
 11849           DFHEIV20,
 11850           DFHEIV99,
 11851           W-CERT-KEY,
 11852           DFHEIV99,
 11853           DFHEIV99,
 11854           DFHEIV99
 11855     SET ADDRESS OF CERTIFICATE-MASTER TO
 11856         DFHEIV20
 11857     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11858
 11859
 11860     MOVE 'Y'                    TO W-CERT-FOUND-SW.
 11861
 11862 6450-ONLY-STOP.
 11863
 11864     MOVE CM-INSURED-LAST-NAME   TO W-VG-TEXT (108).
 11865
 11866     MOVE CM-BENEFICIARY         TO W-VG-TEXT (109).
 11867
 11868     MOVE CM-INSURED-LAST-NAME   TO W-NAME-LAST.
 11869     MOVE CM-INSURED-FIRST-NAME  TO W-NAME-FIRST.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 248
* EL689.cbl
 11870     MOVE CM-INSURED-INITIAL2    TO W-NAME-MIDDLE.
 11871     PERFORM 7200-FORMAT-NAME-STRAIGHT THRU 7200-EXIT.
 11872     MOVE WS-NAME-WORK           TO W-VG-TEXT (95).
 11873
 11874     MOVE CM-INSURED-LAST-NAME   TO W-NAME-LAST.
 11875     MOVE CM-INSURED-FIRST-NAME  TO W-NAME-FIRST.
 11876     MOVE CM-INSURED-INITIAL2    TO W-NAME-MIDDLE.
 11877     PERFORM 7100-FORMAT-LAST-NAME-1ST THRU 7100-EXIT.
 11878     MOVE WS-NAME-WORK           TO W-VG-TEXT (94).
 11879
 11880     MOVE CM-INSURED-LAST-NAME   TO W-NAME-LAST.
 11881     MOVE CM-INSURED-FIRST-NAME  TO W-NAME-FIRST.
 11882     MOVE '.'                    TO W-NAME-FIRST-REMAIN.
 11883     MOVE CM-INSURED-INITIAL2    TO W-NAME-MIDDLE.
 11884     PERFORM 7200-FORMAT-NAME-STRAIGHT THRU 7200-EXIT.
 11885     MOVE WS-NAME-WORK           TO W-VG-TEXT (90).
 11886
 11887     MOVE CM-INSURED-LAST-NAME   TO W-NAME-LAST.
 11888     MOVE CM-INSURED-FIRST-NAME  TO W-NAME-FIRST.
 11889     MOVE SPACES                 TO W-NAME-MIDDLE.
 11890     PERFORM 7200-FORMAT-NAME-STRAIGHT THRU 7200-EXIT.
 11891     MOVE WS-NAME-WORK           TO W-VG-TEXT (104).
 11892
 11893     MOVE CM-INSURED-FIRST-NAME  TO W-VG-TEXT (91).
 11894     MOVE CM-INSURED-INITIAL2    TO W-VG-TEXT (92).
 11895
 11896     MOVE CM-JT-LAST-NAME        TO W-NAME-LAST.
 11897     MOVE CM-JT-FIRST-NAME       TO W-NAME-FIRST.
 11898     MOVE CM-JT-INITIAL          TO W-NAME-MIDDLE.
 11899     PERFORM 7200-FORMAT-NAME-STRAIGHT THRU 7200-EXIT.
 11900     MOVE WS-NAME-WORK           TO W-VG-TEXT (103)
 11901                                    W-LABEL-JOINT-NAME.
 11902
 11903     MOVE CM-JT-LAST-NAME        TO W-NAME-LAST.
 11904     MOVE CM-JT-FIRST-NAME       TO W-NAME-FIRST.
 11905     MOVE CM-JT-INITIAL          TO W-NAME-MIDDLE.
 11906     PERFORM 7100-FORMAT-LAST-NAME-1ST THRU 7100-EXIT.
 11907     MOVE WS-NAME-WORK           TO W-VG-TEXT (102).
 11908
 11909     MOVE CM-JT-LAST-NAME        TO W-NAME-LAST.
 11910     MOVE CM-JT-FIRST-NAME       TO W-NAME-FIRST.
 11911     MOVE '.'                    TO W-NAME-FIRST-REMAIN.
 11912     MOVE CM-JT-INITIAL          TO W-NAME-MIDDLE.
 11913     PERFORM 7200-FORMAT-NAME-STRAIGHT THRU 7200-EXIT.
 11914     MOVE WS-NAME-WORK           TO W-VG-TEXT (99).
 11915
 11916     MOVE CM-JT-LAST-NAME        TO W-NAME-LAST.
 11917     MOVE CM-JT-FIRST-NAME       TO W-NAME-FIRST.
 11918     MOVE SPACES                 TO W-NAME-MIDDLE.
 11919     PERFORM 7200-FORMAT-NAME-STRAIGHT THRU 7200-EXIT.
 11920     MOVE WS-NAME-WORK           TO W-VG-TEXT (105).
 11921
 11922     MOVE CM-JT-FIRST-NAME       TO W-VG-TEXT (100).
 11923     MOVE CM-JT-INITIAL          TO W-VG-TEXT (101).
 11924
 11925     COMPUTE W-WORK-AMOUNT
 11926         = CM-LF-PREMIUM-AMT + CM-LF-ALT-PREMIUM-AMT.
 11927     MOVE W-WORK-AMOUNT          TO W-EDIT-9-2.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 249
* EL689.cbl
 11928     MOVE W-EDIT-9-2             TO W-VG-TEXT (97).
 11929     MOVE CM-AH-PREMIUM-AMT      TO W-EDIT-7-2.
 11930     MOVE W-EDIT-7-2             TO W-VG-TEXT (98).
 11931
 11932     IF  CM-SEX-FEMAL
 11933         MOVE 'MS.'              TO W-VG-TEXT (96)
 11934
 11935     ELSE
 11936         MOVE 'MR.'              TO W-VG-TEXT (96).
 11937
 11938     MOVE CM-CARRIER OF CERTIFICATE-MASTER
 11939                                 TO W-VG-TEXT (70).
 11940     MOVE CM-GROUPING            TO W-VG-TEXT (71).
 11941     MOVE CM-ACCOUNT             TO W-VG-TEXT (72).
 11942     MOVE CM-CERT-NO             TO W-VG-TEXT (73).
 11943     MOVE CM-INSURED-ISSUE-AGE   TO W-DISPLAY-3.
 11944     MOVE W-DISPLAY-3            TO W-VG-TEXT (83).
 11945     MOVE CM-LOAN-NUMBER         TO W-VG-TEXT (86).
 11946     MOVE CM-LOAN-BALANCE        TO W-EDIT-7-2.
 11947     MOVE W-EDIT-7-2             TO W-VG-TEXT (87).
 11948     MOVE CM-MEMBER-NO           TO W-VG-TEXT (88).
 11949     MOVE CM-SOC-SEC-NO          TO W-VG-TEXT (89).
 11950     MOVE CM-POLICY-FORM-NO      TO W-VG-TEXT (83).
 11951     MOVE CM-LF-ORIG-TERM        TO W-EDIT-3-0.
 11952     MOVE W-EDIT-3-0             TO W-VG-TEXT (77).
 11953     MOVE CM-LF-BENEFIT-AMT      TO W-EDIT-9-2.
 11954     MOVE W-EDIT-9-2             TO W-VG-TEXT (79).
 11955     MOVE CM-AH-ORIG-TERM        TO W-EDIT-3-0.
 11956     MOVE W-EDIT-3-0             TO W-VG-TEXT (78).
 11957     MOVE CM-AH-BENEFIT-AMT      TO W-EDIT-7-2.
 11958     MOVE W-EDIT-7-2             TO W-VG-TEXT (80).
 11959     MOVE CM-AH-ITD-CANCEL-AMT   TO W-EDIT-7-2.
 11960     MOVE W-EDIT-7-2             TO W-VG-TEXT (107).
 11961     MOVE CM-LF-ITD-CANCEL-AMT   TO W-EDIT-7-2.
 11962     MOVE W-EDIT-7-2             TO W-VG-TEXT (106).
 11963     IF PI-689-DATA-SOURCE NOT = '4'
 11964     COMPUTE W-EDIT-7-2 = CM-LF-ITD-CANCEL-AMT
 11965        + CM-AH-ITD-CANCEL-AMT
 11966     MOVE W-EDIT-7-2             TO W-VG-TEXT (131)
 11967     IF CM-NH-INT-ON-REFS NOT NUMERIC
 11968        MOVE ZEROS               TO CM-NH-INT-ON-REFS
 11969     END-IF
 11970     MOVE CM-NH-INT-ON-REFS      TO W-EDIT-7-2
 11971     MOVE W-EDIT-7-2             TO W-VG-TEXT (132)
 11972     MOVE CM-LF-CANCEL-DT        TO DC-BIN-DATE-1
 11973     IF CM-AH-CANCEL-DT > DC-BIN-DATE-1
 11974        MOVE CM-AH-CANCEL-DT     TO DC-BIN-DATE-1
 11975     END-IF
 11976     MOVE SPACES                 TO DC-OPTION-CODE
 11977     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
 11978
 11979     IF NO-CONVERSION-ERROR
 11980        MOVE DC-GREG-DATE-1-EDIT TO W-VG-TEXT (133)
 11981     END-IF
 11982     END-IF
 11983     COMPUTE W-WORK-AMOUNT = CM-AH-ORIG-TERM * CM-AH-BENEFIT-AMT.
 11984     MOVE W-WORK-AMOUNT          TO W-EDIT-9-2.
 11985     MOVE W-EDIT-9-2             TO W-VG-TEXT (93).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 250
* EL689.cbl
 11986
 11987     MOVE CM-LF-CANCEL-DT        TO DC-BIN-DATE-1.
 11988     MOVE SPACES                 TO DC-OPTION-CODE.
 11989     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 11990
 11991     IF  NO-CONVERSION-ERROR
 11992         MOVE DC-GREG-DATE-1-EDIT
 11993                                 TO W-VG-TEXT (81).
 11994
 11995     MOVE CM-AH-CANCEL-DT        TO DC-BIN-DATE-1.
 11996     MOVE SPACES                 TO DC-OPTION-CODE.
 11997     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 11998
 11999     IF  NO-CONVERSION-ERROR
 12000         MOVE DC-GREG-DATE-1-EDIT
 12001                                 TO W-VG-TEXT (82).
 12002
 12003     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12004     MOVE SPACES                 TO DC-OPTION-CODE.
 12005     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 12006
 12007     IF  NO-CONVERSION-ERROR
 12008         MOVE DC-GREG-DATE-1-EDIT
 12009                                 TO W-VG-TEXT (74).
 12010
 12011     MOVE CM-LF-ORIG-TERM        TO DC-ELAPSED-MONTHS.
 12012
 12013     IF  CM-PMT-EXTENSION-DAYS NUMERIC
 12014         MOVE CM-PMT-EXTENSION-DAYS
 12015                                 TO DC-ELAPSED-DAYS
 12016     ELSE
 12017         MOVE ZEROS              TO DC-ELAPSED-DAYS.
 12018
 12019     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12020     MOVE '6'                    TO DC-OPTION-CODE.
 12021     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 12022
 12023     IF  NO-CONVERSION-ERROR
 12024         MOVE DC-GREG-DATE-1-EDIT
 12025                                 TO W-VG-TEXT (75).
 12026
 12027     MOVE CM-AH-ORIG-TERM        TO DC-ELAPSED-MONTHS.
 12028     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12029     MOVE '6'                    TO DC-OPTION-CODE.
 12030     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 12031
 12032     IF  NO-CONVERSION-ERROR
 12033         MOVE DC-GREG-DATE-1-EDIT
 12034                                 TO W-VG-TEXT (76).
 12035
 12036 6450-EXIT.
 12037     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 251
* EL689.cbl
 12039 6500-GET-ACCOUNT-DATA.
 12040
 12041     IF  ADDRSI EQUAL '1'
 12042             AND
 12043         PI-CREATE-LABELS
 12044             AND
 12045         NOT PI-689-LABELS-OVERRIDEN
 12046         NEXT SENTENCE
 12047     ELSE
 12048         IF  W-FILE-NOT-USED (6)
 12049             GO TO 6500-EXIT
 12050         END-IF
 12051     END-IF.
 12052
 12053 6500-READ-ACCT-ONLY.
 12054
 12055     IF  W-ACCT-ACCOUNT EQUAL LOW-VALUES
 12056         MOVE ER-9327            TO EMI-ERROR
 12057         MOVE -1                 TO MAINTL
 12058         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12059         GO TO 6500-EXIT.
 12060
 12061
 12062* EXEC CICS HANDLE CONDITION
 12063*         NOTOPEN    (8020-ACCT-NOT-OPEN)
 12064*         NOTFND     (6500-ACCT-NOT-FOUND)
 12065*         ENDFILE    (6500-ONLY-STOP)
 12066*    END-EXEC.
 12067*    MOVE '"$JI''                 ! 6 #00011405' TO DFHEIV0
 12068     MOVE X'22244A492720202020202020' TO DFHEIV0(1:12)
 12069     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12070     MOVE X'3620233030303131343035' TO DFHEIV0(25:11)
 12071     CALL 'kxdfhei1' USING DFHEIV0
 12072     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12073
 12074
 12075
 12076* EXEC CICS STARTBR
 12077*         RIDFLD     (W-ACCT-KEY)
 12078*         DATASET    (W-ACCT-FILE-ID)
 12079*         KEYLENGTH  (20)
 12080*         GENERIC
 12081*    END-EXEC.
 12082     MOVE 20
 12083       TO DFHEIV11
 12084     MOVE 0
 12085       TO DFHEIV12
 12086*    MOVE '&,   KG    G          &   #00011411' TO DFHEIV0
 12087     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
 12088     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12089     MOVE X'2020233030303131343131' TO DFHEIV0(25:11)
 12090     CALL 'kxdfhei1' USING DFHEIV0,
 12091           W-ACCT-FILE-ID,
 12092           W-ACCT-KEY,
 12093           DFHEIV11,
 12094           DFHEIV12,
 12095           DFHEIV99
 12096     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 252
* EL689.cbl
 12097
 12098
 12099     MOVE W-ACCT-PARTIAL-KEY     TO W-ACCT-SAVE-KEY.
 12100     MOVE 'Y'                    TO W-ACCT-BROWSE-STARTED-SW.
 12101
 12102 6500-READNEXT.
 12103
 12104
 12105* EXEC CICS READNEXT
 12106*         DATASET    (W-ACCT-FILE-ID)
 12107*         SET        (ADDRESS OF ACCOUNT-MASTER)
 12108*         RIDFLD     (W-ACCT-KEY)
 12109*    END-EXEC.
 12110     MOVE 0
 12111       TO DFHEIV11
 12112*    MOVE '&.S                   )   #00011423' TO DFHEIV0
 12113     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 12114     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 12115     MOVE X'2020233030303131343233' TO DFHEIV0(25:11)
 12116     CALL 'kxdfhei1' USING DFHEIV0,
 12117           W-ACCT-FILE-ID,
 12118           DFHEIV20,
 12119           DFHEIV99,
 12120           W-ACCT-KEY,
 12121           DFHEIV99,
 12122           DFHEIV11,
 12123           DFHEIV99,
 12124           DFHEIV99
 12125     SET ADDRESS OF ACCOUNT-MASTER TO
 12126         DFHEIV20
 12127     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12128
 12129
 12130     IF  W-ACCT-PARTIAL-KEY NOT EQUAL W-ACCT-SAVE-KEY
 12131         IF  PRIOR-MATCH-ACCT-PKEY
 12132             CONTINUE
 12133*            GO TO 6500-ONLY-STOP
 12134         ELSE
 12135             IF  W-FILE-NOT-USED (6)
 12136                 PERFORM 6500-ENDBR
 12137                 GO TO 6500-EXIT
 12138             ELSE
 12139                 GO TO 6500-ACCT-NOT-FOUND
 12140             END-IF
 12141         END-IF
 12142     ELSE
 12143         SET PRIOR-MATCH-ACCT-PKEY TO TRUE
 12144         MOVE AM-CARRIER           TO WS-SAV-AM-CARRIER
 12145         MOVE AM-ACCOUNT           TO WS-SAV-AM-ACCOUNT
 12146         MOVE AM-DEFN-1            TO WS-SAV-AM-DEFN-1
 12147         MOVE AM-REMIT-TO          TO WS-SAV-AM-REMIT-TO
 12148         MOVE AM-NAME              TO WS-SAV-AM-NAME
 12149         MOVE AM-PERSON            TO WS-SAV-AM-PERSON
 12150         MOVE AM-ADDRS             TO WS-SAV-AM-ADDRS
 12151         MOVE SPACES               TO WS-SAV-AM-CITY
 12152*        MOVE AM-CITY              TO WS-SAV-AM-CITY
 12153         STRING AM-ADDR-CITY ' ' AM-ADDR-STATE
 12154            DELIMITED BY '  ' INTO WS-SAV-AM-CITY
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 253
* EL689.cbl
 12155         END-STRING
 12156         MOVE AM-ZIP               TO WS-SAV-AM-ZIP
 12157         MOVE AM-TEL-NO            TO WS-SAV-AM-TEL-NO
 12158         MOVE AM-CONTROL-NAME      TO WS-SAV-AM-CONTROL-NAME
 12159         MOVE AM-CSR-CODE          TO WS-SAV-AM-CSR-CODE
 12160         MOVE AM-ACCOUNT           TO WS-SAV-AM-ERACCT-ACCOUNT
 12161         GO TO 6500-READNEXT
 12162     END-IF
 12163     .
 12164 6500-ONLY-STOP.
 12165
 12166     IF  NOT PI-NO-CARRIER-SECURITY
 12167             AND
 12168         PI-CARRIER-SECURITY NOT = WS-SAV-AM-CARRIER
 12169         MOVE -1                 TO CARRIERL
 12170         MOVE AL-UANON           TO CARRIERA
 12171         MOVE ER-9095            TO EMI-ERROR
 12172         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12173         PERFORM 6500-ENDBR
 12174         GO TO 8200-SEND-DATAONLY.
 12175
 12176     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 12177     MOVE WS-SAV-AM-NAME         TO W-LABEL-LINES (1).
 12178     MOVE WS-SAV-AM-PERSON       TO W-LABEL-LINES (2).
 12179     MOVE WS-SAV-AM-ADDRS        TO W-LABEL-LINES (3).
 12180     MOVE WS-SAV-AM-CITY         TO W-LABEL-LINES (4).
 12181
 12182     MOVE WS-SAV-AM-ZIP          TO W-WORK-ZIP.
 12183     MOVE SPACES                 TO W-LABEL-ZIP (5).
 12184
 12185     IF  SAVE-AM-CANADIAN-POST-CODE
 12186         MOVE WS-SAV-AM-CANADIAN-POSTAL-CODE
 12187                                 TO W-CANADIAN-POSTAL-CODES
 12188         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (5)
 12189         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (5)
 12190         MOVE SPACES             TO W-LAB-CAN-DASH (5)
 12191                                    W-LAB-CAN-FILLER (5)
 12192     ELSE
 12193         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (5)
 12194
 12195         IF  W-WORK-ZIP4 GREATER THAN '0000'
 12196             MOVE '-'            TO W-LABEL-DASH (5)
 12197             MOVE W-WORK-ZIP4    TO W-LABEL-2ND-ZIP (5)
 12198         ELSE
 12199             MOVE SPACES         TO W-LABEL-DASH (5)
 12200                                    W-LABEL-2ND-ZIP (5).
 12201
 12202     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT.
 12203
 12204     IF  ADDRSI EQUAL '1'
 12205             AND
 12206         PI-CREATE-LABELS
 12207             AND
 12208         NOT PI-689-LABELS-OVERRIDEN
 12209         MOVE W-LABEL-LINES (1)  TO W-RC-TEXT (1)
 12210                                    W-VG-TEXT (40)
 12211         MOVE W-LABEL-LINES (2)  TO W-RC-TEXT (2)
 12212                                    W-VG-TEXT (41)
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 254
* EL689.cbl
 12213         MOVE W-LABEL-LINES (3)  TO W-RC-TEXT (3)
 12214                                    W-VG-TEXT (42)
 12215         MOVE W-LABEL-LINES (4)  TO W-RC-TEXT (4)
 12216                                    W-VG-TEXT (43)
 12217         MOVE W-LABEL-LINES (5)  TO W-RC-TEXT (5)
 12218                                    W-VG-TEXT (44)
 12219         MOVE W-LABEL-LINES (6)  TO W-RC-TEXT (6)
 12220                                    W-VG-TEXT (45)
 12221         MOVE W-NUMB-LABEL-LINES TO PI-689-NUMBER-LABEL-LINES
 12222         SET W-RG-NDX            TO PI-689-NUMBER-LABEL-LINES
 12223         SET W-RG-NDX UP BY +1
 12224     ELSE
 12225         MOVE W-LABEL-LINES (1)  TO W-VG-TEXT (40)
 12226         MOVE W-LABEL-LINES (2)  TO W-VG-TEXT (41)
 12227         MOVE W-LABEL-LINES (3)  TO W-VG-TEXT (42)
 12228         MOVE W-LABEL-LINES (4)  TO W-VG-TEXT (43)
 12229         MOVE W-LABEL-LINES (5)  TO W-VG-TEXT (44)
 12230         MOVE W-LABEL-LINES (6)  TO W-VG-TEXT (45).
 12231
 12232     IF  WS-SAV-AM-TEL-NO NOT NUMERIC
 12233             OR
 12234         WS-SAV-AM-TEL-NO EQUAL ZEROS
 12235         MOVE SPACES             TO W-VG-TEXT (46)
 12236     ELSE
 12237         MOVE ZEROS                  TO W-PHONE-IN
 12238         MOVE WS-SAV-AM-AREA-CODE    TO W-PO-AREA
 12239         MOVE WS-SAV-AM-TEL-PRE      TO W-PO-PFX
 12240         MOVE WS-SAV-AM-TEL-NBR      TO W-PO-SFX
 12241         MOVE W-PHONE-OUT            TO W-VG-TEXT (46).
 12242
 12243     IF WS-SAV-AM-CONTROL-NAME (1:1) NOT = LOW-VALUES
 12244        MOVE WS-SAV-AM-CONTROL-NAME  TO W-VG-TEXT (47)
 12245     ELSE
 12246        MOVE SPACES                   TO W-VG-TEXT (47)
 12247     END-IF.
 12248     MOVE WS-SAV-AM-CSR-CODE     TO W-VG-TEXT (48)
 12249     MOVE WS-SAV-AM-ERACCT-ACCOUNT
 12250                                 TO W-VG-TEXT (49)
 12251
 12252     MOVE WS-SAV-AM-ACCOUNT      TO W-VG-TEXT (72)
 12253     PERFORM 6500-ENDBR.
 12254
 12255     GO TO 6500-EXIT.
 12256
 12257 6500-ENDBR.
 12258
 12259     IF  W-ACCT-BROWSE-STARTED
 12260         MOVE 'N'                TO W-ACCT-BROWSE-STARTED-SW
 12261
 12262* EXEC CICS ENDBR
 12263*            DATASET (W-ACCT-FILE-ID)
 12264*        END-EXEC
 12265     MOVE 0
 12266       TO DFHEIV11
 12267*    MOVE '&2                    $   #00011560' TO DFHEIV0
 12268     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 12269     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12270     MOVE X'2020233030303131353630' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 255
* EL689.cbl
 12271     CALL 'kxdfhei1' USING DFHEIV0,
 12272           W-ACCT-FILE-ID,
 12273           DFHEIV11,
 12274           DFHEIV99
 12275     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12276     END-IF.
 12277
 12278 6500-ACCT-NOT-FOUND.
 12279
 12280     PERFORM 6500-ENDBR.
 12281
 12282     IF  DATASORI NOT EQUAL '1'
 12283         MOVE ER-0179            TO EMI-ERROR
 12284         GO TO 6500-EXIT.
 12285
 12286     MOVE ER-0179                TO EMI-ERROR.
 12287     MOVE -1                     TO MAINTL.
 12288     MOVE AL-UNBON               TO MAINTA.
 12289     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12290     GO TO 8200-SEND-DATAONLY.
 12291
 12292 6500-EXIT.
 12293     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 256
* EL689.cbl
 12295 6600-GET-COMPENSATION-DATA.
 12296
 12297     IF  ADDRSI EQUAL '4'
 12298             AND
 12299         PI-CREATE-LABELS
 12300             AND
 12301         NOT PI-689-LABELS-OVERRIDEN
 12302         NEXT SENTENCE
 12303     ELSE
 12304         IF  W-FILE-NOT-USED (10)
 12305             GO TO 6600-EXIT.
 12306
 12307     IF  W-COMP-RESP-PERSON GREATER THAN LOW-VALUES
 12308         MOVE W-COMP-KEY         TO W-COMP-SAVE-KEY
 12309         GO TO 6600-START.
 12310
 12311     IF  PI-ZERO-CARRIER
 12312             OR
 12313         PI-ZERO-CAR-GROUP
 12314         MOVE ZEROS              TO W-COMP-CARRIER.
 12315
 12316     IF  PI-ZERO-GROUPING
 12317             OR
 12318         PI-ZERO-CAR-GROUP
 12319         MOVE ZEROS              TO W-COMP-GROUPING.
 12320
 12321     IF  W-FILE-NOT-USED (6)
 12322         PERFORM 6500-READ-ACCT-ONLY THRU 6500-READNEXT
 12323         IF  EMI-ERROR EQUAL ER-0179
 12324             MOVE ER-9327        TO EMI-ERROR
 12325             MOVE -1             TO MAINTL
 12326             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12327             GO TO 6600-EXIT.
 12328
 12329     MOVE  'A'                   TO W-COMP-TYPE.
 12330
 12331     IF  WS-SAV-AM-REMIT-TO GREATER THAN ZEROS
 12332         MOVE WS-SAV-AM-AGT (WS-SAV-AM-REMIT-TO)
 12333                                 TO W-COMP-RESP-PERSON
 12334     ELSE
 12335         MOVE PI-689-ACCOUNT     TO W-COMP-ACCOUNT.
 12336
 12337     PERFORM VARYING W-NDX FROM +1 BY +1 UNTIL
 12338        (W-NDX > +10)
 12339            OR
 12340         (WS-SAV-AM-COM-TYP (W-NDX) = 'C' OR 'D' OR 'S' OR 'F')
 12341     END-PERFORM
 12342
 12343     IF  WS-SAV-AM-COM-TYP (W-NDX) = 'C' OR 'D' OR 'S' OR 'F'
 12344         MOVE WS-SAV-AM-AGT (W-NDX)  TO W-COMP-ACCOUNT
 12345     ELSE
 12346         MOVE PI-689-ACCOUNT     TO W-COMP-ACCOUNT.
 12347
 12348     PERFORM 6500-ENDBR.
 12349     MOVE W-COMP-KEY             TO W-COMP-SAVE-KEY.
 12350
 12351     IF  W-COMP-RESP-PERSON EQUAL LOW-VALUES
 12352         MOVE ER-9327            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 257
* EL689.cbl
 12353         MOVE -1                 TO MAINTL
 12354         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12355         GO TO 6600-EXIT.
 12356
 12357 6600-START.
 12358
 12359
 12360* EXEC CICS HANDLE CONDITION
 12361*         NOTOPEN (8080-COMP-NOT-OPEN)
 12362*         NOTFND  (6600-COMP-NOT-FOUND)
 12363*    END-EXEC.
 12364*    MOVE '"$JI                  ! 7 #00011646' TO DFHEIV0
 12365     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 12366     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12367     MOVE X'3720233030303131363436' TO DFHEIV0(25:11)
 12368     CALL 'kxdfhei1' USING DFHEIV0
 12369     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12370
 12371
 12372
 12373* EXEC CICS STARTBR
 12374*         RIDFLD  (W-COMP-KEY)
 12375*         DATASET (W-COMP-FILE-ID)
 12376*    END-EXEC.
 12377     MOVE 0
 12378       TO DFHEIV11
 12379*    MOVE '&,         G          &   #00011651' TO DFHEIV0
 12380     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 12381     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12382     MOVE X'2020233030303131363531' TO DFHEIV0(25:11)
 12383     CALL 'kxdfhei1' USING DFHEIV0,
 12384           W-COMP-FILE-ID,
 12385           W-COMP-KEY,
 12386           DFHEIV99,
 12387           DFHEIV11,
 12388           DFHEIV99
 12389     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12390
 12391
 12392     MOVE 'Y'                    TO W-COMP-BROWSE-SW.
 12393
 12394 6600-READNEXT.
 12395
 12396
 12397* EXEC CICS READNEXT
 12398*         DATASET (W-COMP-FILE-ID)
 12399*         SET     (ADDRESS OF COMPENSATION-MASTER)
 12400*         RIDFLD  (W-COMP-KEY)
 12401*    END-EXEC.
 12402     MOVE 0
 12403       TO DFHEIV11
 12404*    MOVE '&.S                   )   #00011660' TO DFHEIV0
 12405     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 12406     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 12407     MOVE X'2020233030303131363630' TO DFHEIV0(25:11)
 12408     CALL 'kxdfhei1' USING DFHEIV0,
 12409           W-COMP-FILE-ID,
 12410           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 258
* EL689.cbl
 12411           DFHEIV99,
 12412           W-COMP-KEY,
 12413           DFHEIV99,
 12414           DFHEIV11,
 12415           DFHEIV99,
 12416           DFHEIV99
 12417     SET ADDRESS OF COMPENSATION-MASTER TO
 12418         DFHEIV20
 12419     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12420
 12421
 12422     IF CO-CONTROL-PRIMARY
 12423           NOT = W-COMP-SAVE-KEY
 12424        GO TO 6600-COMP-NOT-FOUND.
 12425
 12426     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 12427     MOVE CO-ACCT-NAME           TO W-LABEL-LINES (1)
 12428                                    W-VG-TEXT (140).
 12429     MOVE CO-MAIL-NAME           TO W-LABEL-LINES (2).
 12430     MOVE CO-ADDR-1              TO W-LABEL-LINES (3).
 12431     MOVE CO-ADDR-2              TO W-LABEL-LINES (4).
 12432*    MOVE CO-ADDR-3              TO W-LABEL-LINES (5).
 12433     STRING CO-ADDR-CITY ' ' CO-ADDR-STATE
 12434        DELIMITED BY '  ' INTO W-LABEL-LINES (5)
 12435     END-STRING
 12436
 12437     MOVE CO-ZIP                 TO W-WORK-ZIP.
 12438
 12439     IF  CO-CANADIAN-POST-CODE
 12440         MOVE CO-CANADIAN-POSTAL-CODE
 12441                                 TO W-CANADIAN-POSTAL-CODES
 12442         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (6)
 12443         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (6)
 12444         MOVE SPACES             TO W-LAB-CAN-DASH (6)
 12445                                    W-LAB-CAN-FILLER (6)
 12446     ELSE
 12447         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (6)
 12448
 12449         IF  W-WORK-ZIP4 GREATER THAN '0000'
 12450             MOVE '-'            TO W-LABEL-DASH (6)
 12451             MOVE W-WORK-ZIP4    TO W-LABEL-2ND-ZIP (6)
 12452         ELSE
 12453             MOVE SPACES         TO W-LABEL-DASH (6)
 12454                                    W-LABEL-2ND-ZIP (6).
 12455
 12456     IF  CO-TELEPHONE NOT NUMERIC
 12457             OR
 12458         CO-TELEPHONE = ZEROS
 12459         MOVE SPACES             TO W-VG-TEXT (147)
 12460     ELSE
 12461         MOVE ZEROS              TO W-PHONE-IN
 12462         MOVE CO-AREA-CODE       TO W-PO-AREA
 12463         MOVE CO-PREFIX          TO W-PO-PFX
 12464         MOVE CO-PHONE           TO W-PO-SFX
 12465         MOVE W-PHONE-OUT        TO W-VG-TEXT (147).
 12466
 12467     IF (CO-FAXNO NOT NUMERIC)
 12468        OR (CO-FAXNO = ZEROS)
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 259
* EL689.cbl
 12469        MOVE SPACES              TO W-VG-TEXT (182)
 12470     ELSE
 12471        MOVE ZEROS               TO W-PHONE-IN
 12472        MOVE CO-FAX-AREA-CODE    TO W-PO-AREA
 12473        MOVE CO-FAX-PREFIX       TO W-PO-PFX
 12474        MOVE CO-FAX-PHONE        TO W-PO-SFX
 12475        MOVE W-PHONE-OUT         TO W-VG-TEXT (182)
 12476     END-IF
 12477     IF CO-GA-STATUS-CODE NOT = 'A' AND 'I' AND 'P'
 12478        MOVE SPACES              TO W-VG-TEXT (183)
 12479     ELSE
 12480        EVALUATE CO-GA-STATUS-CODE
 12481           WHEN 'A'
 12482              MOVE 'ACTIVE'      TO W-VG-TEXT (183)
 12483           WHEN 'I'
 12484              MOVE 'INACTIVE'    TO W-VG-TEXT (183)
 12485           WHEN 'P'
 12486              MOVE 'PENDING'     TO W-VG-TEXT (183)
 12487        END-EVALUATE
 12488     END-IF
 12489     IF CO-BILL-SW NOT = 'B' AND 'R' AND 'T' AND 'S'
 12490        MOVE SPACES              TO W-VG-TEXT (181)
 12491     ELSE
 12492        EVALUATE CO-BILL-SW
 12493           WHEN 'B'
 12494              MOVE 'BILLED'      TO W-VG-TEXT (181)
 12495           WHEN 'R'
 12496              MOVE 'REMIT'       TO W-VG-TEXT (181)
 12497           WHEN 'T'
 12498              MOVE 'T'           TO W-VG-TEXT (181)
 12499           WHEN 'S'
 12500              MOVE 'S'           TO W-VG-TEXT (181)
 12501        END-EVALUATE
 12502     END-IF
 12503     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT.
 12504
 12505     IF  ADDRSI EQUAL '4'
 12506             AND
 12507         PI-CREATE-LABELS
 12508             AND
 12509         NOT PI-689-LABELS-OVERRIDEN
 12510         MOVE W-LABEL-LINES (1)  TO W-RC-TEXT (1)
 12511                                    W-VG-TEXT (141)
 12512         MOVE W-LABEL-LINES (2)  TO W-RC-TEXT (2)
 12513                                    W-VG-TEXT (142)
 12514         MOVE W-LABEL-LINES (3)  TO W-RC-TEXT (3)
 12515                                    W-VG-TEXT (143)
 12516         MOVE W-LABEL-LINES (4)  TO W-RC-TEXT (4)
 12517                                    W-VG-TEXT (144)
 12518         MOVE W-LABEL-LINES (5)  TO W-RC-TEXT (5)
 12519                                    W-VG-TEXT (145)
 12520         MOVE W-LABEL-LINES (6)  TO W-RC-TEXT (6)
 12521                                    W-VG-TEXT (146)
 12522         MOVE W-NUMB-LABEL-LINES TO PI-689-NUMBER-LABEL-LINES
 12523         SET W-RG-NDX            TO PI-689-NUMBER-LABEL-LINES
 12524         SET W-RG-NDX UP BY +1
 12525     ELSE
 12526         MOVE W-LABEL-LINES (1)  TO W-VG-TEXT (141)
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 260
* EL689.cbl
 12527         MOVE W-LABEL-LINES (2)  TO W-VG-TEXT (142)
 12528         MOVE W-LABEL-LINES (3)  TO W-VG-TEXT (143)
 12529         MOVE W-LABEL-LINES (4)  TO W-VG-TEXT (144)
 12530         MOVE W-LABEL-LINES (5)  TO W-VG-TEXT (145)
 12531         MOVE W-LABEL-LINES (6)  TO W-VG-TEXT (146).
 12532
 12533     PERFORM 6630-GET-CSR-NAME THRU 6630-EXIT.
 12534
 12535     MOVE CO-RESP-NO             TO W-VG-TEXT (180).
 12536     MOVE CO-END-BAL             TO W-EDIT-7-2-NEGATIVE.
 12537     MOVE W-EDIT-7-2-NEGATIVE    TO W-VG-TEXT (150).
 12538
 12539     MOVE CO-LAST-STMT-DT        TO DC-GREG-DATE-1-YMD.
 12540     MOVE '3'                    TO DC-OPTION-CODE.
 12541     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 12542
 12543     IF  NO-CONVERSION-ERROR
 12544         MOVE DC-GREG-DATE-1-ALPHA
 12545                                 TO W-VG-TEXT (149).
 12546
 12547     PERFORM 6620-GET-G-DATA THRU 6620-EXIT.
 12548     PERFORM 6626-GET-B-DATA     THRU 6626-EXIT
 12549
 12550     PERFORM 6600-ENDBR.
 12551     GO TO 6600-EXIT.
 12552
 12553 6600-ENDBR.
 12554
 12555     IF  W-COMP-BROWSE-STARTED
 12556         MOVE 'N'                      TO W-COMP-BROWSE-SW
 12557
 12558* EXEC CICS ENDBR
 12559*             DATASET(W-COMP-FILE-ID)
 12560*        END-EXEC.
 12561     MOVE 0
 12562       TO DFHEIV11
 12563*    MOVE '&2                    $   #00011801' TO DFHEIV0
 12564     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 12565     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12566     MOVE X'2020233030303131383031' TO DFHEIV0(25:11)
 12567     CALL 'kxdfhei1' USING DFHEIV0,
 12568           W-COMP-FILE-ID,
 12569           DFHEIV11,
 12570           DFHEIV99
 12571     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12572
 12573
 12574 6600-COMP-NOT-FOUND.
 12575
 12576     PERFORM 6600-ENDBR.
 12577
 12578     IF ADDRSL GREATER ZERO
 12579         IF ADDRSI = '4'
 12580            IF PI-689-TYPE EQUAL LOW-VALUES OR SPACES
 12581                MOVE ER-7378                TO EMI-ERROR
 12582                MOVE -1                     TO TYPEL
 12583                MOVE AL-UNBON               TO TYPEA
 12584                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 261
* EL689.cbl
 12585                GO TO 8200-SEND-DATAONLY
 12586            ELSE
 12587                MOVE ER-2114                TO EMI-ERROR
 12588                MOVE -1                     TO ADDRSL
 12589                MOVE AL-UNBON               TO ADDRSA
 12590                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12591                GO TO 8200-SEND-DATAONLY.
 12592
 12593 6600-EXIT.
 12594     EXIT.
 12595 6620-GET-G-DATA.
 12596
 12597     MOVE W-COMP-SAVE-KEY        TO W-COMP-KEY.
 12598
 12599     IF  CO-RPTCD2 GREATER THAN SPACES
 12600         MOVE SPACES             TO W-COMP-RESP-PERSON
 12601         MOVE CO-RPTCD2          TO W-COMP-WORK-AREA
 12602         MOVE +10                TO W-CWA-NDX
 12603         PERFORM 6622-FIND-LAST-NON-SPACE
 12604         SET W-COMP-NDX          TO +10
 12605         PERFORM 6625-FILL-IN-RESP-PERSON.
 12606         INSPECT W-COMP-RESP-PERSON CONVERTING SPACES TO ZEROS.
 12607
 12608     MOVE LOW-VALUES             TO W-COMP-ACCOUNT.
 12609     MOVE 'G'                    TO W-COMP-TYPE.
 12610     MOVE W-COMP-KEY             TO W-COMP-SAVE-KEY.
 12611
 12612
 12613* EXEC CICS RESETBR
 12614*         RIDFLD  (W-COMP-KEY)
 12615*         DATASET (W-COMP-FILE-ID)
 12616*    END-EXEC.
 12617     MOVE 0
 12618       TO DFHEIV11
 12619*    MOVE '&4         G          &   #00011843' TO DFHEIV0
 12620     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 12621     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12622     MOVE X'2020233030303131383433' TO DFHEIV0(25:11)
 12623     CALL 'kxdfhei1' USING DFHEIV0,
 12624           W-COMP-FILE-ID,
 12625           W-COMP-KEY,
 12626           DFHEIV99,
 12627           DFHEIV11,
 12628           DFHEIV99
 12629     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12630
 12631
 12632
 12633* EXEC CICS READNEXT
 12634*         DATASET (W-COMP-FILE-ID)
 12635*         SET     (ADDRESS OF COMPENSATION-MASTER)
 12636*         RIDFLD  (W-COMP-KEY)
 12637*    END-EXEC.
 12638     MOVE 0
 12639       TO DFHEIV11
 12640*    MOVE '&.S                   )   #00011848' TO DFHEIV0
 12641     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 12642     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 262
* EL689.cbl
 12643     MOVE X'2020233030303131383438' TO DFHEIV0(25:11)
 12644     CALL 'kxdfhei1' USING DFHEIV0,
 12645           W-COMP-FILE-ID,
 12646           DFHEIV20,
 12647           DFHEIV99,
 12648           W-COMP-KEY,
 12649           DFHEIV99,
 12650           DFHEIV11,
 12651           DFHEIV99,
 12652           DFHEIV99
 12653     SET ADDRESS OF COMPENSATION-MASTER TO
 12654         DFHEIV20
 12655     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12656
 12657
 12658     IF  CO-CONTROL-PRIMARY NOT = W-COMP-SAVE-KEY
 12659         GO TO 6620-EXIT.
 12660
 12661     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 12662     MOVE CO-ACCT-NAME           TO W-LABEL-LINES (1).
 12663     MOVE CO-MAIL-NAME           TO W-LABEL-LINES (2).
 12664     MOVE CO-ADDR-1              TO W-LABEL-LINES (3).
 12665     MOVE CO-ADDR-2              TO W-LABEL-LINES (4).
 12666*    MOVE CO-ADDR-3              TO W-LABEL-LINES (5).
 12667     STRING CO-ADDR-CITY ' ' CO-ADDR-STATE
 12668        DELIMITED BY '  ' INTO W-LABEL-LINES (5)
 12669     END-STRING
 12670
 12671     MOVE CO-ZIP                 TO W-WORK-ZIP.
 12672
 12673     IF  CO-CANADIAN-POST-CODE
 12674         MOVE CO-CANADIAN-POSTAL-CODE
 12675                                 TO W-CANADIAN-POSTAL-CODES
 12676         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (6)
 12677         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (6)
 12678         MOVE SPACES             TO W-LAB-CAN-DASH (6)
 12679                                    W-LAB-CAN-FILLER (6)
 12680     ELSE
 12681         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (6)
 12682         IF  W-WORK-ZIP4 GREATER THAN '0000'
 12683             MOVE '-'            TO W-LABEL-DASH (6)
 12684             MOVE W-WORK-ZIP4    TO W-LABEL-2ND-ZIP (6)
 12685         ELSE
 12686             MOVE SPACES         TO W-LABEL-DASH (6)
 12687                                    W-LABEL-2ND-ZIP (6).
 12688
 12689     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT.
 12690
 12691     MOVE W-LABEL-LINES (1)      TO W-VG-TEXT (174).
 12692     MOVE W-LABEL-LINES (2)      TO W-VG-TEXT (175).
 12693     MOVE W-LABEL-LINES (3)      TO W-VG-TEXT (176).
 12694     MOVE W-LABEL-LINES (4)      TO W-VG-TEXT (177).
 12695     MOVE W-LABEL-LINES (5)      TO W-VG-TEXT (178).
 12696     MOVE W-LABEL-LINES (6)      TO W-VG-TEXT (179).
 12697
 12698 6620-EXIT.
 12699     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 263
* EL689.cbl
 12701 6622-FIND-LAST-NON-SPACE.
 12702
 12703     IF  W-CWA-CHAR (W-CWA-NDX) EQUAL SPACES
 12704         SUBTRACT +1 FROM W-CWA-NDX
 12705         GO TO 6622-FIND-LAST-NON-SPACE.
 12706
 12707 6622-EXIT.
 12708     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 264
* EL689.cbl
 12710 6625-FILL-IN-RESP-PERSON.
 12711
 12712     MOVE W-CWA-CHAR (W-CWA-NDX) TO W-COMP-RP-CHAR (W-COMP-NDX)
 12713     SET W-COMP-NDX DOWN BY +1.
 12714     SUBTRACT +1 FROM W-CWA-NDX.
 12715
 12716     IF  W-CWA-NDX GREATER THAN ZEROS
 12717         GO TO 6625-FILL-IN-RESP-PERSON.
 12718
 12719 6625-EXIT.
 12720     EXIT.
 12721 6626-GET-B-DATA.
 12722     MOVE W-COMP-SAVE-KEY        TO W-COMP-KEY
 12723     IF W-FILE-USED (8)
 12724        PERFORM 6450-READ-CERT-ONLY
 12725        IF W-CERT-FOUND
 12726           MOVE CM-BENEFICIARY (1:10)
 12727                                 TO W-COMP-RESP-PERSON
 12728        ELSE
 12729           MOVE SPACES           TO W-COMP-RESP-PERSON
 12730           GO TO 6626-EXIT
 12731        END-IF
 12732     ELSE
 12733        MOVE CM-BENEFICIARY (1:10)
 12734                                 TO W-COMP-RESP-PERSON
 12735     END-IF
 12736     MOVE LOW-VALUES             TO W-COMP-ACCOUNT
 12737     MOVE 'B'                    TO W-COMP-TYPE
 12738     MOVE W-COMP-KEY             TO W-COMP-SAVE-KEY
 12739
 12740
 12741* EXEC CICS RESETBR
 12742*         RIDFLD  (W-COMP-KEY)
 12743*         DATASET (W-COMP-FILE-ID)
 12744*    END-EXEC.
 12745     MOVE 0
 12746       TO DFHEIV11
 12747*    MOVE '&4         G          &   #00011936' TO DFHEIV0
 12748     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 12749     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12750     MOVE X'2020233030303131393336' TO DFHEIV0(25:11)
 12751     CALL 'kxdfhei1' USING DFHEIV0,
 12752           W-COMP-FILE-ID,
 12753           W-COMP-KEY,
 12754           DFHEIV99,
 12755           DFHEIV11,
 12756           DFHEIV99
 12757     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12758
 12759
 12760
 12761* EXEC CICS READNEXT
 12762*         DATASET (W-COMP-FILE-ID)
 12763*         SET     (ADDRESS OF COMPENSATION-MASTER)
 12764*         RIDFLD  (W-COMP-KEY)
 12765*    END-EXEC.
 12766     MOVE 0
 12767       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 265
* EL689.cbl
 12768*    MOVE '&.S                   )   #00011941' TO DFHEIV0
 12769     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 12770     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 12771     MOVE X'2020233030303131393431' TO DFHEIV0(25:11)
 12772     CALL 'kxdfhei1' USING DFHEIV0,
 12773           W-COMP-FILE-ID,
 12774           DFHEIV20,
 12775           DFHEIV99,
 12776           W-COMP-KEY,
 12777           DFHEIV99,
 12778           DFHEIV11,
 12779           DFHEIV99,
 12780           DFHEIV99
 12781     SET ADDRESS OF COMPENSATION-MASTER TO
 12782         DFHEIV20
 12783     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12784
 12785
 12786     IF  CO-CONTROL-PRIMARY NOT = W-COMP-SAVE-KEY
 12787         GO TO 6626-EXIT.
 12788
 12789     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 12790     MOVE CO-ACCT-NAME           TO W-LABEL-LINES (1).
 12791     MOVE CO-MAIL-NAME           TO W-LABEL-LINES (2).
 12792     MOVE CO-ADDR-1              TO W-LABEL-LINES (3).
 12793     MOVE CO-ADDR-2              TO W-LABEL-LINES (4).
 12794*    MOVE CO-ADDR-3              TO W-LABEL-LINES (5).
 12795     STRING CO-ADDR-CITY ' ' CO-ADDR-STATE
 12796        DELIMITED BY '  ' INTO W-LABEL-LINES (5)
 12797     END-STRING
 12798
 12799     MOVE CO-ZIP                 TO W-WORK-ZIP.
 12800
 12801     IF  CO-CANADIAN-POST-CODE
 12802         MOVE CO-CANADIAN-POSTAL-CODE
 12803                                 TO W-CANADIAN-POSTAL-CODES
 12804         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (6)
 12805         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (6)
 12806         MOVE SPACES             TO W-LAB-CAN-DASH (6)
 12807                                    W-LAB-CAN-FILLER (6)
 12808     ELSE
 12809         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (6)
 12810         IF  W-WORK-ZIP4 GREATER THAN '0000'
 12811             MOVE '-'            TO W-LABEL-DASH (6)
 12812             MOVE W-WORK-ZIP4    TO W-LABEL-2ND-ZIP (6)
 12813         ELSE
 12814             MOVE SPACES         TO W-LABEL-DASH (6)
 12815                                    W-LABEL-2ND-ZIP (6).
 12816
 12817     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT.
 12818
 12819     MOVE W-LABEL-LINES (1)      TO W-VG-TEXT (184).
 12820     MOVE W-LABEL-LINES (2)      TO W-VG-TEXT (185).
 12821     MOVE W-LABEL-LINES (3)      TO W-VG-TEXT (186).
 12822     MOVE W-LABEL-LINES (4)      TO W-VG-TEXT (187).
 12823     MOVE W-LABEL-LINES (5)      TO W-VG-TEXT (188).
 12824     MOVE W-LABEL-LINES (6)      TO W-VG-TEXT (189).
 12825
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 266
* EL689.cbl
 12826 6626-EXIT.
 12827     EXIT.
 12828 6630-GET-CSR-NAME.
 12829
 12830     MOVE SPACES                 TO W-CNTL-KEY.
 12831     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID.
 12832     MOVE +0                     TO W-CNTL-SEQ-NO.
 12833     MOVE '2'                    TO W-CNTL-RECORD-TYPE.
 12834     MOVE CO-CSR-CODE            TO W-CNTL-GENL.
 12835
 12836
 12837* EXEC CICS HANDLE CONDITION
 12838*         NOTOPEN    (8040-CNTL-NOT-OPEN)
 12839*         NOTFND     (6630-CNTL2-NOT-FOUND)
 12840*    END-EXEC.
 12841*    MOVE '"$JI                  ! 8 #00011997' TO DFHEIV0
 12842     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 12843     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12844     MOVE X'3820233030303131393937' TO DFHEIV0(25:11)
 12845     CALL 'kxdfhei1' USING DFHEIV0
 12846     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12847
 12848
 12849
 12850* EXEC CICS READ
 12851*         DATASET    (W-CNTL-FILE-ID)
 12852*         SET        (ADDRESS OF CONTROL-FILE)
 12853*         RIDFLD     (W-CNTL-KEY)
 12854*    END-EXEC.
 12855*    MOVE '&"S        E          (   #00012002' TO DFHEIV0
 12856     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12857     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12858     MOVE X'2020233030303132303032' TO DFHEIV0(25:11)
 12859     CALL 'kxdfhei1' USING DFHEIV0,
 12860           W-CNTL-FILE-ID,
 12861           DFHEIV20,
 12862           DFHEIV99,
 12863           W-CNTL-KEY,
 12864           DFHEIV99,
 12865           DFHEIV99,
 12866           DFHEIV99
 12867     SET ADDRESS OF CONTROL-FILE TO
 12868         DFHEIV20
 12869     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12870
 12871
 12872     MOVE CF-PROCESSOR-NAME      TO W-VG-TEXT (148).
 12873     MOVE CF-PROCESSOR-TITLE     TO W-VG-TEXT (154)
 12874     GO TO 6630-EXIT.
 12875
 12876 6630-CNTL2-NOT-FOUND.
 12877
 12878*    MOVE ER-8965                TO EMI-ERROR.
 12879*    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12880*    MOVE -1                     TO MAINTL.
 12881*    MOVE AL-UANON               TO MAINTA.
 12882*    GO TO 8200-SEND-DATAONLY
 12883     .
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 267
* EL689.cbl
 12884 6630-EXIT.
 12885     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 268
* EL689.cbl
 12887 6700-GET-MAIL-DATA.
 12888
 12889     IF  ADDRSI EQUAL '5'
 12890             AND
 12891         PI-CREATE-LABELS
 12892             AND
 12893         NOT PI-689-LABELS-OVERRIDEN
 12894         NEXT SENTENCE
 12895     ELSE
 12896         IF  W-FILE-NOT-USED (5)
 12897             GO TO 6700-EXIT.
 12898
 12899     IF  W-MAIL-CERT-NO EQUAL LOW-VALUES
 12900         MOVE ER-9327            TO EMI-ERROR
 12901         MOVE -1                 TO MAINTL
 12902         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12903         GO TO 6700-EXIT.
 12904
 12905
 12906* EXEC CICS HANDLE CONDITION
 12907*         NOTOPEN (8090-MAIL-NOT-OPEN)
 12908*         NOTFND  (6700-MAIL-NOT-FOUND)
 12909*    END-EXEC.
 12910*    MOVE '"$JI                  ! 9 #00012041' TO DFHEIV0
 12911     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 12912     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12913     MOVE X'3920233030303132303431' TO DFHEIV0(25:11)
 12914     CALL 'kxdfhei1' USING DFHEIV0
 12915     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12916
 12917
 12918
 12919* EXEC CICS READ
 12920*         DATASET(W-MAIL-FILE-ID)
 12921*         SET    (ADDRESS OF MAILING-DATA)
 12922*         RIDFLD (W-MAIL-KEY)
 12923*    END-EXEC.
 12924*    MOVE '&"S        E          (   #00012046' TO DFHEIV0
 12925     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12926     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12927     MOVE X'2020233030303132303436' TO DFHEIV0(25:11)
 12928     CALL 'kxdfhei1' USING DFHEIV0,
 12929           W-MAIL-FILE-ID,
 12930           DFHEIV20,
 12931           DFHEIV99,
 12932           W-MAIL-KEY,
 12933           DFHEIV99,
 12934           DFHEIV99,
 12935           DFHEIV99
 12936     SET ADDRESS OF MAILING-DATA TO
 12937         DFHEIV20
 12938     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12939
 12940
 12941     MOVE MA-INSURED-LAST-NAME   TO W-NAME-LAST.
 12942     MOVE MA-INSURED-FIRST-NAME  TO W-NAME-FIRST.
 12943     MOVE MA-INSURED-MIDDLE-INIT TO W-NAME-MIDDLE.
 12944     PERFORM 7200-FORMAT-NAME-STRAIGHT THRU 7200-EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 269
* EL689.cbl
 12945
 12946     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 12947     MOVE WS-NAME-WORK           TO W-LABEL-LINES (1).
 12948     MOVE W-LABEL-JOINT-NAME     TO W-LABEL-LINES (2).
 12949     MOVE MA-ADDRESS-LINE-1      TO W-LABEL-LINES (3).
 12950     MOVE MA-ADDRESS-LINE-2      TO W-LABEL-LINES (4).
 12951*    MOVE MA-CITY-STATE          TO W-LABEL-LINES (5).
 12952     STRING MA-CITY ' ' MA-ADDR-STATE
 12953        DELIMITED BY '  ' INTO W-LABEL-LINES (5)
 12954     END-STRING
 12955
 12956     MOVE MA-ZIP                 TO W-WORK-ZIP.
 12957     MOVE SPACES                 TO W-LABEL-ZIP (6).
 12958
 12959     IF  MA-CANADIAN-POST-CODE
 12960         MOVE MA-CANADIAN-POSTAL-CODE
 12961                                 TO W-CANADIAN-POSTAL-CODES
 12962         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (6)
 12963         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (6)
 12964         MOVE SPACES             TO W-LAB-CAN-DASH (6)
 12965                                    W-LAB-CAN-FILLER (6)
 12966     ELSE
 12967         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (6)
 12968         IF  W-WORK-ZIP4 GREATER THAN '0000'
 12969             MOVE '-'            TO W-LABEL-DASH (6)
 12970             MOVE W-WORK-ZIP4    TO W-LABEL-2ND-ZIP (6)
 12971         ELSE
 12972             MOVE SPACES         TO W-LABEL-DASH (6)
 12973                                    W-LABEL-2ND-ZIP (6).
 12974
 12975     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT.
 12976
 12977     IF  ADDRSI EQUAL '5'
 12978             AND
 12979         PI-CREATE-LABELS
 12980             AND
 12981         NOT PI-689-LABELS-OVERRIDEN
 12982         MOVE W-LABEL-LINES (1)  TO W-RC-TEXT (1)
 12983                                    W-VG-TEXT (31)
 12984         MOVE W-LABEL-LINES (2)  TO W-RC-TEXT (2)
 12985                                    W-VG-TEXT (32)
 12986         MOVE W-LABEL-LINES (3)  TO W-RC-TEXT (3)
 12987                                    W-VG-TEXT (33)
 12988         MOVE W-LABEL-LINES (4)  TO W-RC-TEXT (4)
 12989                                    W-VG-TEXT (34)
 12990         MOVE W-LABEL-LINES (5)  TO W-RC-TEXT (5)
 12991                                    W-VG-TEXT (35)
 12992         MOVE W-LABEL-LINES (6)  TO W-RC-TEXT (6)
 12993                                    W-VG-TEXT (36)
 12994         MOVE W-NUMB-LABEL-LINES TO PI-689-NUMBER-LABEL-LINES
 12995         SET W-RG-NDX            TO PI-689-NUMBER-LABEL-LINES
 12996         SET W-RG-NDX UP BY +1
 12997     ELSE
 12998         MOVE W-LABEL-LINES (1)  TO W-VG-TEXT (31)
 12999         MOVE W-LABEL-LINES (2)  TO W-VG-TEXT (32)
 13000         MOVE W-LABEL-LINES (3)  TO W-VG-TEXT (33)
 13001         MOVE W-LABEL-LINES (4)  TO W-VG-TEXT (34)
 13002         MOVE W-LABEL-LINES (5)  TO W-VG-TEXT (35)
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 270
* EL689.cbl
 13003         MOVE W-LABEL-LINES (6)  TO W-VG-TEXT (36).
 13004     MOVE MA-CRED-BENE-NAME      TO W-LABEL-LINES (1)
 13005     MOVE MA-CRED-BENE-ADDR      TO W-LABEL-LINES (2)
 13006     MOVE MA-CRED-BENE-ADDR2     TO W-LABEL-LINES (3)
 13007     STRING MA-CRED-BENE-CITY ' ' MA-CRED-BENE-STATE
 13008        DELIMITED BY '  ' INTO W-LABEL-LINES (4)
 13009     END-STRING
 13010
 13011     MOVE MA-CRED-BENE-ZIP       TO W-WORK-ZIP
 13012     MOVE SPACES                 TO W-LABEL-ZIP (5)
 13013
 13014     IF  MA-CB-CANADIAN-POST-CODE
 13015         MOVE MA-CB-CANADIAN-POSTAL-CODE
 13016                                 TO W-CANADIAN-POSTAL-CODES
 13017         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (5)
 13018         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (5)
 13019         MOVE SPACES             TO W-LAB-CAN-DASH (5)
 13020                                    W-LAB-CAN-FILLER (5)
 13021     ELSE
 13022         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (5)
 13023         IF  W-WORK-ZIP4 GREATER THAN '0000'
 13024             MOVE '-'            TO W-LABEL-DASH (5)
 13025             MOVE W-WORK-ZIP4    TO W-LABEL-2ND-ZIP (5)
 13026         ELSE
 13027             MOVE SPACES         TO W-LABEL-DASH (5)
 13028                                    W-LABEL-2ND-ZIP (5)
 13029         END-IF
 13030     END-IF
 13031     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT
 13032     MOVE W-LABEL-LINES (1)      TO W-VG-TEXT (37)
 13033     MOVE W-LABEL-LINES (2)      TO W-VG-TEXT (50)
 13034     MOVE W-LABEL-LINES (3)      TO W-VG-TEXT (51)
 13035     MOVE W-LABEL-LINES (4)      TO W-VG-TEXT (52)
 13036     MOVE W-LABEL-LINES (5)      TO W-VG-TEXT (53)
 13037     GO TO 6700-EXIT.
 13038
 13039 6700-MAIL-NOT-FOUND.
 13040
 13041     IF  ADDRSL GREATER ZERO
 13042         IF ADDRSI = '5'
 13043            MOVE ER-3000         TO EMI-ERROR
 13044            MOVE -1              TO ADDRSL
 13045            MOVE AL-UNBON        TO ADDRSA
 13046            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13047            GO TO 8200-SEND-DATAONLY.
 13048
 13049 6700-EXIT.
 13050     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 271
* EL689.cbl
 13052 6750-GET-LIFE-BENEFIT-DATA.
 13053
 13054     IF  W-FILE-NOT-USED (2)
 13055         GO TO 6750-EXIT.
 13056
 13057     MOVE SPACES                 TO W-CNTL-GEN2.
 13058
 13059     IF  DATASORI EQUAL '2'
 13060         IF  W-FILE-NOT-USED (8)
 13061             PERFORM 6450-READ-CERT-ONLY
 13062             IF  W-CERT-FOUND
 13063                 MOVE CM-LF-BENEFIT-CD
 13064                                 TO W-BEN-HOLD
 13065                                    W-CNTL-GEN2
 13066             ELSE
 13067                 NEXT SENTENCE
 13068         ELSE
 13069             MOVE CM-LF-BENEFIT-CD
 13070                                 TO W-BEN-HOLD
 13071                                    W-CNTL-GEN2
 13072     ELSE
 13073         IF  DATASORI EQUAL '4'
 13074             IF  W-FILE-NOT-USED (9)
 13075                 PERFORM 6400-READ-PNDB-ONLY
 13076                 IF  W-PNDB-FOUND
 13077                     IF  PI-689-TYPE = '1'
 13078                         MOVE PB-I-LF-BENEFIT-CD
 13079                                 TO W-BEN-HOLD
 13080                                    W-CNTL-GEN2
 13081                     ELSE
 13082                         MOVE PB-CI-LF-BENEFIT-CD
 13083                                 TO W-BEN-HOLD
 13084                                    W-CNTL-GEN2
 13085             ELSE
 13086                 NEXT SENTENCE
 13087         ELSE
 13088             IF  W-FILE-USED (8)
 13089                 MOVE CM-LF-BENEFIT-CD
 13090                                 TO W-BEN-HOLD
 13091                                    W-CNTL-GEN2
 13092             ELSE
 13093                 IF  W-FILE-USED (9)
 13094                     IF  PI-689-TYPE = '1'
 13095                         MOVE PB-I-LF-BENEFIT-CD
 13096                                 TO W-BEN-HOLD
 13097                                    W-CNTL-GEN2
 13098                     ELSE
 13099                         MOVE PB-CI-LF-BENEFIT-CD
 13100                                 TO W-BEN-HOLD
 13101                                    W-CNTL-GEN2.
 13102
 13103     IF  W-CNTL-GEN2 EQUAL SPACES
 13104         MOVE ER-9327            TO EMI-ERROR
 13105         MOVE -1                 TO MAINTL
 13106         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13107         GO TO 6750-EXIT.
 13108
 13109     MOVE SPACES                 TO W-CNTL-GEN1.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 272
* EL689.cbl
 13110     MOVE '4'                    TO W-CNTL-RECORD-TYPE.
 13111     MOVE ZEROS                  TO W-CNTL-SEQ-NO.
 13112
 13113
 13114* EXEC CICS HANDLE CONDITION
 13115*         NOTOPEN (8040-CNTL-NOT-OPEN)
 13116*         NOTFND  (6750-EXIT)
 13117*    END-EXEC.
 13118*    MOVE '"$JI                  ! : #00012224' TO DFHEIV0
 13119     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 13120     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13121     MOVE X'3A20233030303132323234' TO DFHEIV0(25:11)
 13122     CALL 'kxdfhei1' USING DFHEIV0
 13123     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13124
 13125
 13126
 13127* EXEC CICS READ
 13128*         DATASET (W-CNTL-FILE-ID)
 13129*         SET     (ADDRESS OF CONTROL-FILE)
 13130*         GTEQ
 13131*         RIDFLD  (W-CNTL-KEY)
 13132*    END-EXEC.
 13133*    MOVE '&"S        G          (   #00012229' TO DFHEIV0
 13134     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 13135     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13136     MOVE X'2020233030303132323239' TO DFHEIV0(25:11)
 13137     CALL 'kxdfhei1' USING DFHEIV0,
 13138           W-CNTL-FILE-ID,
 13139           DFHEIV20,
 13140           DFHEIV99,
 13141           W-CNTL-KEY,
 13142           DFHEIV99,
 13143           DFHEIV99,
 13144           DFHEIV99
 13145     SET ADDRESS OF CONTROL-FILE TO
 13146         DFHEIV20
 13147     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13148
 13149
 13150     MOVE 1                      TO W-NDX.
 13151
 13152 6750-LOOP.
 13153
 13154     IF  W-NDX = 9
 13155         GO TO 6750-EXIT.
 13156
 13157     IF  CF-BENEFIT-CODE (W-NDX) LESS W-BEN-HOLD
 13158         ADD 1                   TO W-NDX
 13159         GO TO 6750-LOOP.
 13160
 13161     IF  W-BEN-HOLD = CF-BENEFIT-CODE (W-NDX)
 13162         MOVE CF-BENEFIT-DESCRIP (W-NDX)
 13163                                 TO W-VG-TEXT (11).
 13164
 13165 6750-EXIT.
 13166     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 273
* EL689.cbl
 13168 6800-GET-A-H-BENEFIT-DATA.
 13169
 13170     IF  W-FILE-NOT-USED (3)
 13171         GO TO 6800-EXIT.
 13172
 13173     MOVE SPACES                 TO W-CNTL-GEN2.
 13174
 13175     IF  DATASORI EQUAL '2'
 13176         IF  W-FILE-NOT-USED (8)
 13177             PERFORM 6450-READ-CERT-ONLY
 13178             IF  W-CERT-FOUND
 13179                 MOVE CM-AH-BENEFIT-CD
 13180                                 TO W-BEN-HOLD
 13181                                    W-CNTL-GEN2
 13182             ELSE
 13183                 NEXT SENTENCE
 13184         ELSE
 13185             MOVE CM-AH-BENEFIT-CD
 13186                                 TO W-BEN-HOLD
 13187                                    W-CNTL-GEN2
 13188     ELSE
 13189         IF  DATASORI EQUAL '4'
 13190             IF  W-FILE-NOT-USED (9)
 13191                 PERFORM 6400-READ-PNDB-ONLY
 13192                 IF  W-PNDB-FOUND
 13193                     IF  PI-689-TYPE = '1'
 13194                         MOVE PB-I-AH-BENEFIT-CD
 13195                                 TO W-BEN-HOLD
 13196                                    W-CNTL-GEN2
 13197                     ELSE
 13198                         MOVE PB-CI-AH-BENEFIT-CD
 13199                                 TO W-BEN-HOLD
 13200                                    W-CNTL-GEN2
 13201             ELSE
 13202                 NEXT SENTENCE
 13203         ELSE
 13204             IF  W-FILE-USED (8)
 13205                 MOVE CM-AH-BENEFIT-CD
 13206                                 TO W-BEN-HOLD
 13207                                    W-CNTL-GEN2
 13208             ELSE
 13209                 IF  W-FILE-USED (9)
 13210                     IF  PI-689-TYPE = '1'
 13211                         MOVE PB-I-AH-BENEFIT-CD
 13212                                 TO W-BEN-HOLD
 13213                                    W-CNTL-GEN2
 13214                     ELSE
 13215                         MOVE PB-CI-AH-BENEFIT-CD
 13216                                 TO W-BEN-HOLD
 13217                                    W-CNTL-GEN2.
 13218
 13219     IF  W-CNTL-GEN2 EQUAL SPACES
 13220         MOVE ER-9327            TO EMI-ERROR
 13221         MOVE -1                 TO MAINTL
 13222         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13223         GO TO 6800-EXIT.
 13224
 13225     MOVE SPACES                 TO W-CNTL-GEN1.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 274
* EL689.cbl
 13226     MOVE '5'                    TO W-CNTL-RECORD-TYPE.
 13227     MOVE ZEROS                  TO W-CNTL-SEQ-NO.
 13228
 13229
 13230* EXEC CICS HANDLE CONDITION
 13231*         NOTOPEN (8040-CNTL-NOT-OPEN)
 13232*         NOTFND  (6800-EXIT)
 13233*    END-EXEC.
 13234*    MOVE '"$JI                  ! ; #00012315' TO DFHEIV0
 13235     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 13236     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13237     MOVE X'3B20233030303132333135' TO DFHEIV0(25:11)
 13238     CALL 'kxdfhei1' USING DFHEIV0
 13239     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13240
 13241
 13242
 13243* EXEC CICS READ
 13244*         DATASET (W-CNTL-FILE-ID)
 13245*         SET     (ADDRESS OF CONTROL-FILE)
 13246*         RIDFLD  (W-CNTL-KEY)
 13247*         GTEQ
 13248*    END-EXEC.
 13249*    MOVE '&"S        G          (   #00012320' TO DFHEIV0
 13250     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 13251     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13252     MOVE X'2020233030303132333230' TO DFHEIV0(25:11)
 13253     CALL 'kxdfhei1' USING DFHEIV0,
 13254           W-CNTL-FILE-ID,
 13255           DFHEIV20,
 13256           DFHEIV99,
 13257           W-CNTL-KEY,
 13258           DFHEIV99,
 13259           DFHEIV99,
 13260           DFHEIV99
 13261     SET ADDRESS OF CONTROL-FILE TO
 13262         DFHEIV20
 13263     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13264
 13265
 13266     MOVE 1                      TO W-NDX.
 13267
 13268 6800-LOOP-AH.
 13269
 13270     IF  W-NDX = 9
 13271         GO TO 6800-EXIT.
 13272
 13273     IF  CF-BENEFIT-CODE (W-NDX) LESS W-BEN-HOLD
 13274         ADD 1                   TO W-NDX
 13275         GO TO 6800-LOOP-AH.
 13276
 13277     IF  W-BEN-HOLD = CF-BENEFIT-CODE (W-NDX)
 13278         MOVE CF-BENEFIT-DESCRIP (W-NDX)
 13279                                 TO W-VG-TEXT (15)
 13280         MOVE CF-BENEFIT-ALPHA (W-NDX)
 13281                                 TO W-BENEFIT-WORK
 13282         MOVE W-ELIM-DAYS        TO W-VG-TEXT (16).
 13283
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 275
* EL689.cbl
 13284 6800-EXIT.
 13285     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 276
* EL689.cbl
 13287 6850-GET-CHECK-DATA.
 13288
 13289     IF  ADDRSI EQUAL '6'
 13290             AND
 13291         PI-CREATE-LABELS
 13292             AND
 13293         NOT PI-689-LABELS-OVERRIDEN
 13294         NEXT SENTENCE
 13295     ELSE
 13296         IF  W-FILE-NOT-USED (12)
 13297             GO TO 6850-EXIT.
 13298
 13299     IF  W-CHEK-CERT-NO EQUAL LOW-VALUES
 13300         MOVE ER-9327            TO EMI-ERROR
 13301         MOVE -1                 TO MAINTL
 13302         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13303         GO TO 6850-EXIT.
 13304
 13305
 13306* EXEC CICS HANDLE CONDITION
 13307*         NOTOPEN (8045-CHEK-NOT-OPEN)
 13308*         NOTFND  (6850-CHEK-NOT-FOUND)
 13309*    END-EXEC.
 13310*    MOVE '"$JI                  ! < #00012366' TO DFHEIV0
 13311     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 13312     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13313     MOVE X'3C20233030303132333636' TO DFHEIV0(25:11)
 13314     CALL 'kxdfhei1' USING DFHEIV0
 13315     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13316
 13317
 13318
 13319* EXEC CICS READ
 13320*         DATASET (W-CHEK-FILE-ID)
 13321*         SET     (ADDRESS OF CHECK-RECORDS)
 13322*         RIDFLD  (W-CHEK-KEY)
 13323*    END-EXEC.
 13324*    MOVE '&"S        E          (   #00012371' TO DFHEIV0
 13325     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13326     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13327     MOVE X'2020233030303132333731' TO DFHEIV0(25:11)
 13328     CALL 'kxdfhei1' USING DFHEIV0,
 13329           W-CHEK-FILE-ID,
 13330           DFHEIV20,
 13331           DFHEIV99,
 13332           W-CHEK-KEY,
 13333           DFHEIV99,
 13334           DFHEIV99,
 13335           DFHEIV99
 13336     SET ADDRESS OF CHECK-RECORDS TO
 13337         DFHEIV20
 13338     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13339
 13340
 13341     MOVE CH-CHECK-NO            TO W-VG-TEXT (158).
 13342     MOVE CH-AMOUNT-PAID         TO W-EDIT-7-2.
 13343     MOVE W-EDIT-7-2             TO W-VG-TEXT (157).
 13344     MOVE CH-CHECK-QUE-CONTROL   TO W-DISPLAY-8
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 277
* EL689.cbl
 13345                                    PI-689-CONTROL.
 13346     MOVE W-DISPLAY-8            TO W-VG-TEXT (165).
 13347     MOVE CH-REASON-FOR-CHECK    TO W-VG-TEXT (166).
 13348
 13349     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 13350     MOVE CH-PAYEE-NAME-1        TO W-LABEL-LINES (1).
 13351     MOVE CH-PAYEE-NAME-2        TO W-LABEL-LINES (2).
 13352     MOVE CH-PAYEE-ADDRESS-1     TO W-LABEL-LINES (3).
 13353     MOVE CH-PAYEE-ADDRESS-2     TO W-LABEL-LINES (4).
 13354     MOVE CH-PAYEE-CITY-ST       TO W-LABEL-LINES (5).
 13355
 13356     MOVE CH-PAYEE-ZIP           TO W-WORK-ZIP.
 13357     MOVE SPACES                 TO W-LABEL-ZIP (6).
 13358
 13359     IF  CH-CANADIAN-POST-CODE
 13360         MOVE CH-CANADIAN-POSTAL-CODE
 13361                                 TO W-CANADIAN-POSTAL-CODES
 13362         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (6)
 13363         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (6)
 13364         MOVE SPACES             TO W-LAB-CAN-DASH (6)
 13365                                    W-LAB-CAN-FILLER (6)
 13366     ELSE
 13367         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (6)
 13368         IF  W-WORK-ZIP4 GREATER THAN '0000'
 13369             MOVE '-'            TO W-LABEL-DASH (6)
 13370             MOVE W-WORK-ZIP4    TO W-LABEL-2ND-ZIP (6)
 13371         ELSE
 13372             MOVE SPACES         TO W-LABEL-DASH (6)
 13373                                    W-LABEL-2ND-ZIP (6).
 13374
 13375     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT.
 13376
 13377     IF  ADDRSI EQUAL '6'
 13378             AND
 13379         PI-CREATE-LABELS
 13380             AND
 13381         NOT PI-689-LABELS-OVERRIDEN
 13382         MOVE W-LABEL-LINES (1)  TO W-RC-TEXT (1)
 13383                                    W-VG-TEXT (159)
 13384         MOVE W-LABEL-LINES (2)  TO W-RC-TEXT (2)
 13385                                    W-VG-TEXT (160)
 13386         MOVE W-LABEL-LINES (3)  TO W-RC-TEXT (3)
 13387                                    W-VG-TEXT (161)
 13388         MOVE W-LABEL-LINES (4)  TO W-RC-TEXT (4)
 13389                                    W-VG-TEXT (162)
 13390         MOVE W-LABEL-LINES (5)  TO W-RC-TEXT (5)
 13391                                    W-VG-TEXT (163)
 13392         MOVE W-LABEL-LINES (6)  TO W-RC-TEXT (6)
 13393                                    W-VG-TEXT (164)
 13394         MOVE W-NUMB-LABEL-LINES TO PI-689-NUMBER-LABEL-LINES
 13395         SET W-RG-NDX            TO PI-689-NUMBER-LABEL-LINES
 13396         SET W-RG-NDX UP BY +1
 13397     ELSE
 13398         MOVE W-LABEL-LINES (1)  TO W-VG-TEXT (159)
 13399         MOVE W-LABEL-LINES (2)  TO W-VG-TEXT (160)
 13400         MOVE W-LABEL-LINES (3)  TO W-VG-TEXT (161)
 13401         MOVE W-LABEL-LINES (4)  TO W-VG-TEXT (162)
 13402         MOVE W-LABEL-LINES (5)  TO W-VG-TEXT (163)
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 278
* EL689.cbl
 13403         MOVE W-LABEL-LINES (6)  TO W-VG-TEXT (164).
 13404
 13405     GO TO 6850-EXIT.
 13406
 13407 6850-CHEK-NOT-FOUND.
 13408
 13409     IF  ADDRSL GREATER ZERO
 13410         IF ADDRSI = '6'
 13411            MOVE ER-2908         TO EMI-ERROR
 13412            MOVE -1              TO ADDRSL
 13413            MOVE AL-UNBON        TO ADDRSA
 13414            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13415            GO TO 8200-SEND-DATAONLY.
 13416
 13417 6850-EXIT.
 13418     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 279
* EL689.cbl
 13420 6900-GET-PYAJ-DATA.
 13421
 13422     IF  W-FILE-NOT-USED (13)
 13423         GO TO 6900-EXIT.
 13424
 13425     IF  W-PYAJ-FIN-RESP EQUAL LOW-VALUES
 13426         MOVE ER-9327            TO EMI-ERROR
 13427         MOVE -1                 TO MAINTL
 13428         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13429         GO TO 6900-EXIT.
 13430
 13431
 13432* EXEC CICS HANDLE CONDITION
 13433*         NOTOPEN (8085-PYAJ-NOT-OPEN)
 13434*         NOTFND  (6900-PYAJ-NOT-FOUND)
 13435*    END-EXEC.
 13436*    MOVE '"$JI                  ! = #00012467' TO DFHEIV0
 13437     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 13438     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13439     MOVE X'3D20233030303132343637' TO DFHEIV0(25:11)
 13440     CALL 'kxdfhei1' USING DFHEIV0
 13441     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13442
 13443
 13444 6900-READ-NEXT.
 13445
 13446
 13447* EXEC CICS READ
 13448*         DATASET (W-PYAJ-FILE-ID)
 13449*         SET     (ADDRESS OF PENDING-PAY-ADJ)
 13450*         RIDFLD  (W-PYAJ-KEY)
 13451*         GTEQ
 13452*    END-EXEC.
 13453*    MOVE '&"S        G          (   #00012474' TO DFHEIV0
 13454     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 13455     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13456     MOVE X'2020233030303132343734' TO DFHEIV0(25:11)
 13457     CALL 'kxdfhei1' USING DFHEIV0,
 13458           W-PYAJ-FILE-ID,
 13459           DFHEIV20,
 13460           DFHEIV99,
 13461           W-PYAJ-KEY,
 13462           DFHEIV99,
 13463           DFHEIV99,
 13464           DFHEIV99
 13465     SET ADDRESS OF PENDING-PAY-ADJ TO
 13466         DFHEIV20
 13467     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13468
 13469
 13470     IF  PY-COMPANY-CD NOT EQUAL W-PYAJ-COMPANY-CD
 13471             OR
 13472         PY-CARRIER NOT EQUAL W-PYAJ-CARRIER
 13473             OR
 13474         PY-GROUPING NOT EQUAL W-PYAJ-GROUPING
 13475             OR
 13476         PY-FIN-RESP NOT EQUAL W-PYAJ-FIN-RESP
 13477             OR
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 280
* EL689.cbl
 13478         PY-ACCOUNT NOT EQUAL W-PYAJ-ACCOUNT
 13479         GO TO 6900-PYAJ-NOT-FOUND.
 13480
 13481     IF  PI-689-SEQ-NO GREATER THAN ZEROS
 13482             AND
 13483         PY-FILE-SEQ-NO NOT EQUAL PI-689-SEQ-NO
 13484         GO TO 6900-PYAJ-NOT-FOUND.
 13485
 13486     IF  PY-RECORD-TYPE NOT EQUAL W-PYAJ-RECORD-TYPE
 13487         MOVE PY-CONTROL-PRIMARY TO W-PYAJ-KEY
 13488         ADD +1                  TO W-PYAJ-FILE-SEQ-NO
 13489         GO TO 6900-READ-NEXT.
 13490
 13491     MOVE PY-CHECK-NUMBER        TO W-DISPLAY-7.
 13492     MOVE W-DISPLAY-7            TO W-VG-TEXT (171).
 13493
 13494     MOVE PY-ENTRY-AMT           TO W-EDIT-7-2.
 13495     MOVE W-EDIT-7-2             TO W-VG-TEXT (170).
 13496
 13497     MOVE PY-CHECK-QUE-CONTROL   TO W-DISPLAY-8
 13498                                    PI-689-CONTROL.
 13499     MOVE W-DISPLAY-8            TO W-VG-TEXT (172).
 13500     MOVE PY-ENTRY-COMMENT       TO W-VG-TEXT (173).
 13501
 13502     GO TO 6900-EXIT.
 13503
 13504 6900-PYAJ-NOT-FOUND.
 13505
 13506     MOVE ER-7395                TO EMI-ERROR
 13507     MOVE -1                     TO DATASORL
 13508     MOVE AL-UNBON               TO DATASORA
 13509     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13510     GO TO 8200-SEND-DATAONLY.
 13511
 13512 6900-EXIT.
 13513     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 281
* EL689.cbl
 13515 6950-MOVE-SYSTEM-DATA.
 13516
 13517     IF  W-FILE-NOT-USED (7)
 13518         GO TO 6950-EXIT.
 13519
 13520     MOVE EIBDATE                TO W-DATE-WORK.
 13521     MOVE W-DT-WORK              TO DC-JULIAN-YYDDD.
 13522     MOVE '5'                    TO DC-OPTION-CODE.
 13523     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 13524     MOVE DC-GREG-DATE-1-EDIT    TO W-VG-TEXT (60).
 13525     MOVE DC-GREG-DATE-1-ALPHA   TO W-VG-TEXT (61).
 13526
 13527     MOVE FORMI                  TO W-VG-TEXT (62).
 13528
 13529     IF  PI-689-VARIABLE-DATA-1 GREATER THAN SPACES
 13530         MOVE PI-689-VARIABLE-DATA-1
 13531                                 TO W-VG-TEXT (63)
 13532         MOVE PI-689-VARIABLE-DATA-2
 13533                                 TO W-VG-TEXT (64)
 13534         MOVE PI-689-VARIABLE-DATA-3
 13535                                 TO W-VG-TEXT (65)
 13536         MOVE PI-689-VARIABLE-DATA-4
 13537                                 TO W-VG-TEXT (66)
 13538     ELSE
 13539         MOVE '(VARIABLE NOT PROVIDED)'
 13540                                 TO W-VG-TEXT (63).
 13541
 13542 6950-EXIT.
 13543     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 282
* EL689.cbl
 13545 7000-FORMAT-SCREEN.
 13546
 13547     IF  MAINTI EQUAL 'S'
 13548             OR
 13549         PI-SHOW-MODE
 13550         MOVE AL-PANOF           TO W-SC-TEXTA (W-SC-NDX)
 13551     ELSE
 13552         MOVE AL-UANOF           TO W-SC-TEXTA (W-SC-NDX).
 13553
 13554     IF  W-RG-NDX NOT GREATER THAN PI-689-NUMBER-LABEL-LINES
 13555         SET W-LINE23            TO W-RG-NDX
 13556         MOVE 'A'                TO W-LINE1
 13557     ELSE
 13558         SET W-LIN-NUM           TO W-RG-NDX
 13559         COMPUTE W-LIN-NUM
 13560             = W-LIN-NUM - PI-689-NUMBER-LABEL-LINES - 1.
 13561
 13562     MOVE W-LINE-NUM             TO W-SC-LINE (W-SC-NDX).
 13563     MOVE W-RC-TEXT (W-RG-NDX)   TO W-SC-TEXT (W-SC-NDX).
 13564     SET W-RG-NDX UP BY 1.
 13565
 13566 7000-EXIT.
 13567      EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 283
* EL689.cbl
 13569 7100-FORMAT-LAST-NAME-1ST.
 13570*****************************************************************
 13571*             M O V E   N A M E   R O U T I N E                 *
 13572*     THE FOLLOWING ROUTINE REARRANGES A GIVEN NAME SO          *
 13573*     THAT IT READS LAST, FIRST, MIDDLE.  PLACE NAME            *
 13574*     FIELDS IN THE FOLLOWING WORKING STORAGE FIELDS.           *
 13575*                  FIELD                   VALUE                *
 13576*           W-NAME-LAST    (CL15)      SMITH                    *
 13577*           W-NAME-FIRST   (CL15)      JOHN                     *
 13578*           W-NAME-MIDDLE  (CL15)      ALLEN/A                  *
 13579*     AFTER NAME HAS BEEN MOVED WS-NAME-WORK (CL30) WILL        *
 13580*     CONTAIN                                                   *
 13581*                SMITH, JOHN ALLEN                              *
 13582*     OR                                                        *
 13583*                SMITH, JOHN A.                                 *
 13584*     TO USE THIS ROUTINE YOU NEED THE WORKING STORAGE          *
 13585*     COPYBOOK, ELCNWA.                                         *
 13586*****************************************************************.
 13587
 13588     MOVE SPACES                 TO WS-NAME-WORK-AREA.
 13589     MOVE ZERO                   TO WS-NAME-SW.
 13590     SET NWA-INDEX               TO +1.
 13591
 13592     IF  W-NAME-LAST EQUAL SPACES
 13593             AND
 13594         W-NAME-MIDDLE EQUAL SPACES
 13595         MOVE +1                 TO WS-NAME-SW.
 13596
 13597     MOVE W-NAME-LAST            TO WS-NAME-WORK2.
 13598     PERFORM 7110-MOVE-NAME THRU 7110-EXIT.
 13599
 13600     MOVE W-NAME-FIRST           TO WS-NAME-WORK2.
 13601     PERFORM 7110-MOVE-NAME THRU 7110-EXIT.
 13602
 13603     SET NWA-INDEX UP BY +1.
 13604
 13605     IF  W-NAME-MIDDLE NOT EQUAL SPACES
 13606         IF  W-NAME-MIDDLE-2 EQUAL SPACES
 13607             MOVE W-NAME-MIDDLE  TO WS-NW (NWA-INDEX)
 13608             SET NWA-INDEX UP BY +1
 13609             MOVE '.'            TO WS-NW (NWA-INDEX)
 13610             SET NWA-INDEX UP BY +2
 13611         ELSE
 13612             MOVE W-NAME-MIDDLE  TO WS-NAME-WORK2
 13613             PERFORM 7110-MOVE-NAME THRU 7110-EXIT.
 13614
 13615 7100-EXIT.
 13616     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 284
* EL689.cbl
 13618 7110-MOVE-NAME.
 13619
 13620     IF  WS-NAME-SW GREATER THAN +1
 13621         GO TO 7110-EXIT.
 13622
 13623     IF  WS-NAME-WORK2 = SPACES
 13624         GO TO 7110-EXIT.
 13625
 13626     SET NWA-INDEX2            TO +1.
 13627     SET NWA-INDEX3            TO +2.
 13628
 13629 7110-MOVE-NAME-CYCLE.
 13630
 13631     MOVE WS-NW2 (NWA-INDEX2)  TO WS-NW (NWA-INDEX).
 13632
 13633     IF  NWA-INDEX LESS THAN +30
 13634         SET NWA-INDEX UP BY +1
 13635     ELSE
 13636         ADD +2                TO WS-NAME-SW
 13637         GO TO 7110-EXIT.
 13638
 13639     IF  NWA-INDEX2 LESS THAN +20
 13640         SET NWA-INDEX3 UP BY +1
 13641         SET NWA-INDEX2 UP BY +1.
 13642
 13643     IF  WS-NW2 (NWA-INDEX2) EQUAL SPACES
 13644             AND
 13645         WS-NW2 (NWA-INDEX3) EQUAL SPACES
 13646         IF  WS-NAME-SW EQUAL ZERO
 13647             MOVE ','            TO WS-NW (NWA-INDEX)
 13648             SET NWA-INDEX UP BY +2
 13649             MOVE +1             TO WS-NAME-SW
 13650             GO TO 7110-EXIT
 13651         ELSE
 13652             GO TO 7110-EXIT.
 13653
 13654     GO TO 7110-MOVE-NAME-CYCLE.
 13655
 13656 7110-EXIT.
 13657     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 285
* EL689.cbl
 13659 7200-FORMAT-NAME-STRAIGHT.
 13660*****************************************************************
 13661*           M O V E   N A M E   R O U T I N E                   *
 13662*     THE FOLLOWING ROUTINE REARRANGES A GIVEN NAME SO          *
 13663*     THAT IT READS LAST, FIRST, MIDDLE.  PLACE NAME            *
 13664*     FIELDS IN THE FOLLOWING WORKING STORAGE FIELDS.           *
 13665*                  FIELD                   VALUE                *
 13666*           W-NAME-LAST    (CL15)      SMITH                    *
 13667*           W-NAME-FIRST   (CL15)      JOHN                     *
 13668*           W-NAME-MIDDLE  (CL15)      ALLEN/A                  *
 13669*     AFTER NAME HAS BEEN MOVED WS-NAME-WORK (CL30) WILL        *
 13670*     CONTAIN                                                   *
 13671*              JOHN A. SMITH                                    *
 13672*     OR                                                        *
 13673*              JOHN ALLEN SMITH                                 *
 13674*     TO USE THIS ROUTINE YOU NEED THE WORKING STORAGE          *
 13675*     COPYBOOK, ELCNWA.                                         *
 13676*****************************************************************
 13677
 13678     MOVE SPACES                 TO WS-NAME-WORK-AREA.
 13679     MOVE ZERO                   TO WS-NAME-SW.
 13680     SET NWA-INDEX               TO +1.
 13681
 13682     IF  W-NAME-FIRST EQUAL SPACES
 13683             AND
 13684         W-NAME-MIDDLE EQUAL SPACES
 13685         MOVE W-NAME-LAST        TO WS-NAME-WORK
 13686         GO TO 7200-EXIT.
 13687
 13688     MOVE W-NAME-FIRST           TO WS-NAME-WORK2.
 13689     PERFORM 7290-MOVE-NAME THRU 7290-EXIT.
 13690
 13691     IF  W-NAME-MIDDLE NOT EQUAL SPACES
 13692         SET NWA-INDEX UP BY +1
 13693
 13694         IF  W-NAME-MIDDLE-2 EQUAL SPACES
 13695             MOVE W-NAME-MIDDLE  TO WS-NW (NWA-INDEX)
 13696             SET NWA-INDEX UP BY +1
 13697             MOVE '.'            TO WS-NW (NWA-INDEX)
 13698             SET NWA-INDEX UP BY +1
 13699
 13700         ELSE
 13701             MOVE W-NAME-MIDDLE  TO WS-NAME-WORK2
 13702             PERFORM 7290-MOVE-NAME THRU 7290-EXIT.
 13703
 13704     SET NWA-INDEX UP BY +1
 13705     MOVE W-NAME-LAST            TO WS-NAME-WORK2.
 13706     PERFORM 7290-MOVE-NAME THRU 7290-EXIT.
 13707
 13708 7200-EXIT.
 13709     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 286
* EL689.cbl
 13711 7290-MOVE-NAME.
 13712
 13713     IF  WS-NAME-SW GREATER THAN +1
 13714         GO TO 7290-EXIT.
 13715
 13716     IF  WS-NAME-WORK2 EQUAL SPACES
 13717         GO TO 7290-EXIT.
 13718
 13719     SET NWA-INDEX2            TO +1.
 13720     SET NWA-INDEX3            TO +2.
 13721
 13722 7290-MOVE-NAME-CYCLE.
 13723
 13724     MOVE WS-NW2 (NWA-INDEX2)  TO WS-NW (NWA-INDEX).
 13725
 13726     IF  NWA-INDEX LESS THAN +30
 13727         SET NWA-INDEX UP BY +1
 13728     ELSE
 13729         ADD +2                TO WS-NAME-SW
 13730         GO TO 7290-EXIT.
 13731
 13732     IF  NWA-INDEX2 LESS THAN +20
 13733         SET NWA-INDEX2 UP BY +1
 13734         SET NWA-INDEX3 UP BY +1.
 13735
 13736     IF  WS-NW2 (NWA-INDEX2) EQUAL SPACES
 13737             AND
 13738         WS-NW2 (NWA-INDEX3) EQUAL SPACES
 13739         GO TO 7290-EXIT.
 13740
 13741     GO TO 7290-MOVE-NAME-CYCLE.
 13742
 13743 7290-EXIT.
 13744     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 287
* EL689.cbl
 13746 7300-LABEL-MOVE.
 13747
 13748     IF  W-LABEL-HOLD-AREA = SPACES
 13749         MOVE +0                 TO W-NUMB-LABEL-LINES
 13750         GO TO 7300-EXIT.
 13751
 13752     IF  W-LABEL-LINES (1) = SPACES
 13753         MOVE W-LABEL-LINES (2)  TO W-LABEL-LINES (1)
 13754         MOVE W-LABEL-LINES (3)  TO W-LABEL-LINES (2)
 13755         MOVE W-LABEL-LINES (4)  TO W-LABEL-LINES (3)
 13756         MOVE W-LABEL-LINES (5)  TO W-LABEL-LINES (4)
 13757         MOVE W-LABEL-LINES (6)  TO W-LABEL-LINES (5)
 13758         MOVE SPACES             TO W-LABEL-LINES (6)
 13759         GO TO 7300-LABEL-MOVE.
 13760
 13761     IF  W-LABEL-LINES (2) = SPACES
 13762             AND
 13763         W-LABEL-LINES (3) = SPACES
 13764             AND
 13765         W-LABEL-LINES (4) = SPACES
 13766             AND
 13767         W-LABEL-LINES (5) = SPACES
 13768             AND
 13769         W-LABEL-LINES (6) = SPACES
 13770         MOVE 1                  TO W-NDX
 13771                                    W-NUMB-LABEL-LINES
 13772         GO TO 7300-EXIT.
 13773
 13774 7300-TRY-2.
 13775
 13776     IF  W-LABEL-LINES (2) = SPACES
 13777         MOVE W-LABEL-LINES (3)  TO W-LABEL-LINES (2)
 13778         MOVE W-LABEL-LINES (4)  TO W-LABEL-LINES (3)
 13779         MOVE W-LABEL-LINES (5)  TO W-LABEL-LINES (4)
 13780         MOVE W-LABEL-LINES (6)  TO W-LABEL-LINES (5)
 13781         MOVE SPACES             TO W-LABEL-LINES (6)
 13782         GO TO 7300-TRY-2.
 13783
 13784     IF  W-LABEL-LINES (3) = SPACES
 13785             AND
 13786         W-LABEL-LINES (4) = SPACES
 13787             AND
 13788         W-LABEL-LINES (5) = SPACES
 13789             AND
 13790         W-LABEL-LINES (6) = SPACES
 13791         MOVE 2                  TO W-NDX
 13792         GO TO 7300-MOVE-ZIP.
 13793
 13794 7300-TRY-3.
 13795
 13796     IF  W-LABEL-LINES (3) = SPACES
 13797         MOVE W-LABEL-LINES (4)  TO W-LABEL-LINES (3)
 13798         MOVE W-LABEL-LINES (5)  TO W-LABEL-LINES (4)
 13799         MOVE W-LABEL-LINES (6)  TO W-LABEL-LINES (5)
 13800         MOVE SPACES             TO W-LABEL-LINES (6)
 13801         GO TO 7300-TRY-3.
 13802
 13803     IF  W-LABEL-LINES (4) = SPACES
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 288
* EL689.cbl
 13804             AND
 13805         W-LABEL-LINES (5) = SPACES
 13806             AND
 13807         W-LABEL-LINES (6) = SPACES
 13808         MOVE 3                   TO W-NDX
 13809         GO TO 7300-MOVE-ZIP.
 13810
 13811 7300-TRY-4.
 13812
 13813     IF  W-LABEL-LINES (4) = SPACES
 13814         MOVE W-LABEL-LINES (5)  TO W-LABEL-LINES (4)
 13815         MOVE W-LABEL-LINES (6)  TO W-LABEL-LINES (5)
 13816         MOVE SPACES             TO W-LABEL-LINES (6)
 13817         GO TO 7300-TRY-4.
 13818
 13819     IF  W-LABEL-LINES (5) = SPACES
 13820             AND
 13821         W-LABEL-LINES (6) = SPACES
 13822         MOVE 4                  TO W-NDX
 13823         GO TO 7300-MOVE-ZIP.
 13824
 13825 7300-TRY-5.
 13826
 13827     IF  W-LABEL-LINES (5) = SPACES
 13828         MOVE W-LABEL-LINES (6)  TO W-LABEL-LINES (5)
 13829         MOVE SPACES             TO W-LABEL-LINES (6)
 13830         GO TO 7300-TRY-5
 13831     ELSE
 13832         IF  W-LABEL-LINES (6) = SPACES
 13833             MOVE 5              TO W-NDX
 13834             GO TO 7300-MOVE-ZIP
 13835         ELSE
 13836             MOVE 6              TO W-NDX.
 13837
 13838 7300-MOVE-ZIP.
 13839
 13840     COMPUTE W-NDX2 = W-NDX - 1.
 13841
 13842     IF  W-LAST-ZIP (W-NDX2) = SPACES
 13843*****CANADIAN ZIP CODES (NON NUMERIC) STAY ON THE LAST LINE
 13844
 13845         IF  W-LABEL-1ST-ZIP (W-NDX) NUMERIC
 13846                 MOVE W-LABEL-ZIP (W-NDX)
 13847                                 TO W-LAST-ZIP (W-NDX2)
 13848                 MOVE SPACES     TO W-LABEL-LINES (W-NDX)
 13849                 MOVE W-NDX2     TO W-NUMB-LABEL-LINES
 13850                 GO TO 7300-EXIT.
 13851
 13852     MOVE W-NDX                  TO W-NUMB-LABEL-LINES.
 13853
 13854 7300-EXIT.
 13855     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 289
* EL689.cbl
 13857 7400-CREATE-LETTER.
 13858****************************************************************
 13859*    THIS AREA CONTROLS THE PROCESSING OF INDIVIDUAL INPUT     *
 13860*    RECORDS.                                                  *
 13861****************************************************************
 13862
 13863     SET W-SQ-NDX                TO W-START-COLUMN.
 13864     MOVE SPACES                 TO W-SQUEEZED-LINE
 13865                                    W-WORK-LINE.
 13866     MOVE W-START-COLUMN         TO W-LAST-SQUEEZED-SPACE
 13867     MOVE +1                     TO W-LAST-WC-SPACE.
 13868     MOVE HIGH-VALUES            TO W-LAST-SQ-CHAR.
 13869
 13870     SET W-TG-NDX                TO +1.
 13871
 13872     PERFORM 7410-TEXT-LINE-PROCESS THRU 7410-EXIT
 13873            VARYING
 13874         W-TG-NDX FROM W-TG-NDX BY +1
 13875            UNTIL
 13876         W-TG-NDX GREATER THAN W-TOTAL-TX-LINES.
 13877
 13878     IF  W-FORM-SQUEEZE-ON
 13879             AND
 13880         W-SQUEEZED-LINE GREATER THAN SPACES
 13881         PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT.
 13882
 13883     PERFORM 7640-PAGING THRU 7640-EXIT.
 13884
 13885 7400-EXIT.
 13886     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 290
* EL689.cbl
 13888 7410-TEXT-LINE-PROCESS.
 13889***************************************************************
 13890*    THIS ROUTINE SEARCHES THE TEXT WORK AREA FOR ANY         *
 13891*    VARIABLE SYMBOL AND WILL REPLACE THE VARIABLE SYMBOL     *
 13892*    WITH THE CORRESPONDING DATA FROM THE SYSTEM DEFINED      *
 13893*    DATA THAT WAS GENERATED PREVIOUSLY.  WHILE PERFORMING    *
 13894*    THIS FUNCTION THE ROUTINE MOVES EACH CHARACTER OR ITS    *
 13895*    VARIABLE REPLACEMENT TO A WORK LINE.                     *
 13896***************************************************************
 13897
 13898
 13899     SET W-WC-NDX                TO W-ZEROS.
 13900     MOVE HIGH-VALUES            TO W-LAST-CHAR.
 13901
 13902     MOVE W-TX-SC (W-TG-NDX)     TO W-LINE-SQUEEZE-IND.
 13903
 13904     PERFORM 7420-TEXT-CHAR-PROCESS THRU 7420-EXIT
 13905             VARYING
 13906         W-TX-NDX FROM +1 BY +1
 13907             UNTIL
 13908         W-TX-NDX GREATER THAN +70.
 13909
 13910****************************************************************
 13911*    IF SPACE 'SQUEEZING' IS INDICATED ON A FORM WIDE BASIS    *
 13912*    EACH LINE OF TEXT IS PROCESSED ACCORDING TO THE INDICATED *
 13913*    LINE SQUEEZE CONTROL.                                     *
 13914****************************************************************
 13915     IF  W-FORM-SQUEEZE-ON
 13916
 13917         IF  W-WORK-LINE GREATER THAN SPACES
 13918                 OR
 13919             W-AS-IS
 13920             PERFORM 7450-SQUEEZING THRU 7450-EXIT
 13921
 13922         ELSE
 13923             NEXT SENTENCE
 13924****************************************************************
 13925*    IF NO SPACE 'SQUEEZING' IS INDICATED ON A FORM WIDE BASIS *
 13926*    EACH LINE OF TEXT IS PRINT AS IS EXCEPT FOR VARIABLES     *
 13927****************************************************************
 13928     ELSE
 13929         IF  W-WORK-LINE GREATER THAN SPACES
 13930             MOVE W-TX-PC (W-TG-NDX)
 13931                                 TO W-PRINT-CONTROL
 13932             MOVE W-WORK-LINE    TO W-SQUEEZED-LINE
 13933             PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 13934             MOVE SPACES         TO W-WORK-LINE.
 13935
 13936 7410-EXIT.
 13937     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 291
* EL689.cbl
 13939 7420-TEXT-CHAR-PROCESS.
 13940****************************************************************
 13941*    LOOKING FOR VARIABLE INDICATORS (**XXX) THIS SECTION      *
 13942*    CONTROLS THE CONVERSION OF THESE INDICATORS INTO THEIR    *
 13943*    ACTUAL VALUES.  IT MOVES THESE REPLACEMENTS AND THE       *
 13944*    REMAINING CHARACTERS TO THE WORK LINE.                    *
 13945****************************************************************
 13946
 13947     IF  W-TX-CHAR (W-TG-NDX W-TX-NDX) EQUAL '@'
 13948             AND
 13949         W-LAST-CHAR EQUAL '@'
 13950         PERFORM 7430-PROCESS-VARIABLE THRU 7430-EXIT.
 13951
 13952     SET W-WC-NDX UP BY +1.
 13953
 13954     IF  W-WC-NDX GREATER THAN +70
 13955         IF  W-FORM-SQUEEZE-ON
 13956                 AND
 13957             NOT W-AS-IS
 13958             PERFORM 7440-BACK-TO-NEAREST-WORD THRU 7440-EXIT
 13959                     VARYING
 13960                 W-WC-NDX FROM W-LAST-WC-SPACE BY +1
 13961                     UNTIL
 13962                 W-WC-NDX EQUAL +71
 13963             SET W-TX-NDX        TO W-LAST-TX-SPACE
 13964
 13965             IF  W-WORK-LINE GREATER THAN SPACES
 13966                 PERFORM 7450-SQUEEZING THRU 7450-EXIT
 13967                 MOVE SPACES     TO W-WORK-LINE
 13968                                    W-LINE-SQUEEZE-IND
 13969                 SET W-WC-NDX    TO +1
 13970             ELSE
 13971                 SET W-WC-NDX    TO +1
 13972         ELSE
 13973             PERFORM 7460-REMAIN-CHAR-CHECK THRU 7460-EXIT.
 13974
 13975     MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX)
 13976                                 TO W-CHARACTER-TYPE.
 13977
 13978     SET W-WC-NDX2               TO W-WC-NDX.
 13979     SET W-WC-NDX2 DOWN BY +1.
 13980
 13981     IF  W-PUNCTUATION
 13982             AND
 13983         W-WC-NDX2 GREATER THAN W-ZEROS
 13984             AND
 13985         W-WORK-CHAR (W-WC-NDX2) EQUAL SPACES
 13986         SET W-WC-NDX DOWN BY +1.
 13987
 13988     MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX)
 13989                                 TO W-LAST-CHAR
 13990                                    W-WORK-CHAR (W-WC-NDX).
 13991
 13992     IF  W-LAST-CHAR EQUAL SPACES
 13993         SET W-LAST-WC-SPACE     TO W-WC-NDX
 13994         SET W-LAST-TX-SPACE     TO W-TX-NDX.
 13995
 13996 7420-EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 292
* EL689.cbl
 13997     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 293
* EL689.cbl
 13999 7430-PROCESS-VARIABLE.
 14000******************************************************************
 14001*    THIS SECTION CHECKS ON ALL '@@XXX' FORMATED CHARACTER       *
 14002*    GROUPS.  IF IN PROPER FORMAT, EACH GROUP IS REPLACED WITH   *
 14003*    ITS CORRESPONDING VALUES.                                   *
 14004******************************************************************
 14005
 14006     SET W-TX-NDX UP BY +1.
 14007
 14008     IF  W-TX-CHAR (W-TG-NDX W-TX-NDX) NUMERIC
 14009         MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX)
 14010                                 TO W-V1
 14011         SET W-TX-NDX UP BY +1
 14012
 14013         IF  W-TX-CHAR (W-TG-NDX W-TX-NDX) NUMERIC
 14014             MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX)
 14015                                 TO W-V2
 14016             SET W-TX-NDX UP BY +1
 14017             IF  W-TX-CHAR (W-TG-NDX W-TX-NDX) NUMERIC
 14018                 MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX)
 14019                                 TO W-V3
 14020                 SET W-TX-NDX UP BY +1
 14021                 MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX)
 14022                                 TO W-FIELD-SQUEEZE-IND
 14023                 GO TO 7430-CONTINUE
 14024             ELSE
 14025                 SET W-TX-NDX DOWN BY +3
 14026                 MOVE ER-0180    TO EMI-ERROR
 14027                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14028                 MOVE -1         TO MAINTL
 14029                 MOVE HIGH-VALUES
 14030                                 TO W-LAST-CHAR
 14031         ELSE
 14032             SET W-TX-NDX DOWN BY +2
 14033             MOVE ER-0180        TO EMI-ERROR
 14034             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14035             MOVE -1             TO MAINTL
 14036             MOVE HIGH-VALUES    TO W-LAST-CHAR
 14037     ELSE
 14038         SET W-TX-NDX DOWN BY +1
 14039         MOVE ER-7246            TO EMI-ERROR
 14040         MOVE -1                 TO MAINTL
 14041         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14042         MOVE HIGH-VALUES        TO W-LAST-CHAR.
 14043
 14044****************************************************************
 14045*    WHEN THE PROPER FORM IS NOT FOUND THE CHARACTERS INVOLVED *
 14046*    ARE TRANSFERRED INTACT AND A NOTE MADE INDICATING THIS    *
 14047*    ACTION.                                                   *
 14048****************************************************************
 14049
 14050     IF  W-FIRST-BAD-VARIABLE EQUAL ZEROS
 14051         MOVE 'Y'                TO W-FIRST-BAD-VARIABLE-IND
 14052         GO TO 7430-EXIT
 14053     ELSE
 14054         GO TO 7430-EXIT.
 14055
 14056 7430-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 294
* EL689.cbl
 14057
 14058     IF  W-VAR-RELATIVE-NUM LESS THAN 001
 14059             OR
 14060         W-VAR-RELATIVE-NUM GREATER THAN W-NUM-OF-VARIABLES
 14061         SET W-TX-NDX DOWN BY +4
 14062         MOVE ER-0180            TO EMI-ERROR
 14063         MOVE -1                 TO MAINTL
 14064         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14065         MOVE HIGH-VALUES        TO W-LAST-CHAR
 14066         IF  W-FIRST-BAD-VARIABLE EQUAL ZEROS
 14067             MOVE 'Y'                TO W-FIRST-BAD-VARIABLE-IND
 14068             GO TO 7430-EXIT
 14069         ELSE
 14070             GO TO 7430-EXIT.
 14071
 14072     SET W-VG-NDX                TO W-VAR-RELATIVE-NUM.
 14073
 14074     SET W-WC-NDX DOWN BY +1.
 14075
 14076     IF  (W-FORM-SQUEEZE-OFF
 14077                 AND
 14078             NOT W-SQUEEZE-FIELD)
 14079             OR
 14080         (W-FORM-SQUEEZE-ON
 14081                 AND
 14082             W-AS-IS)
 14083         PERFORM 7435-MOVE-VARIABLE-DIRECT THRU 7435-EXIT
 14084                 VARYING
 14085             W-VC-NDX FROM +1 BY +1
 14086                 UNTIL
 14087             W-VC-NDX GREATER THAN
 14088                 W-VARIABLE-SIZE (W-VG-NDX)
 14089
 14090         IF  W-VARIABLE-SIZE (W-VG-NDX) GREATER THAN +5
 14091             SET W-TX-NDX UP BY W-VARIABLE-SIZE (W-VG-NDX)
 14092             SET W-TX-NDX DOWN BY +5
 14093             IF  W-TX-NDX GREATER THAN +70
 14094                 SET W-TX-NDX    TO +70
 14095                 GO TO 7430-EXIT
 14096             ELSE
 14097                 GO TO 7430-EXIT
 14098         ELSE
 14099             COMPUTE W-ADJUST-SHORT
 14100                 = 5 - W-VARIABLE-SIZE (W-VG-NDX)
 14101             SET W-WC-NDX UP BY W-ADJUST-SHORT
 14102             GO TO 7430-EXIT.
 14103
 14104     IF  W-SQUEEZE-FIELD
 14105         SET W-TX-NDX UP BY +1.
 14106
 14107     MOVE SPACES                 TO W-FIRST-CHAR-FOUND-IND.
 14108
 14109     PERFORM 7470-MOVE-CHAR THRU 7470-EXIT
 14110             VARYING
 14111         W-VC-NDX FROM +1 BY +1
 14112             UNTIL
 14113         W-VC-NDX GREATER THAN
 14114             W-VARIABLE-SIZE (W-VG-NDX).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 295
* EL689.cbl
 14115
 14116     MOVE HIGH-VALUES            TO W-LAST-CHAR.
 14117
 14118     IF  W-FORM-SQUEEZE-ON
 14119         GO TO 7430-EXIT.
 14120
 14121     IF  W-VARIABLE-SIZE (W-VG-NDX) GREATER THAN +6
 14122         SET W-TX-NDX UP BY W-VARIABLE-SIZE (W-VG-NDX)
 14123         SET W-TX-NDX DOWN BY +6
 14124         IF  W-TX-NDX GREATER THAN +70
 14125             SET W-TX-NDX        TO +70.
 14126
 14127     IF  W-WORK-CHAR (W-WC-NDX) EQUAL SPACES
 14128         SET W-WC-NDX DOWN BY +1.
 14129
 14130 7430-EXIT.
 14131     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 296
* EL689.cbl
 14133 7435-MOVE-VARIABLE-DIRECT.
 14134
 14135     IF  W-USE-UPPER-AND-LOWER-CASE (W-VAR-RELATIVE-NUM)
 14136             AND
 14137         W-VAR-CHAR (W-VG-NDX W-VC-NDX) NOT EQUAL SPACES
 14138             AND
 14139         W-VAR-CHAR (W-VG-NDX W-VC-NDX) ALPHABETIC
 14140             AND
 14141         (W-VC-NDX GREATER THAN +1
 14142                 AND
 14143             W-LAST-CHAR NOT EQUAL SPACE
 14144                 AND
 14145             NOT W-LAST-CHAR-PUNC)
 14146         IF  W-LC-USE-BOTH-CASES
 14147             INSPECT W-VAR-CHAR (W-VG-NDX W-VC-NDX)
 14148                 CONVERTING W-UPPER-CASE TO W-LOWER-CASE
 14149         ELSE
 14150             INSPECT W-VAR-CHAR (W-VG-NDX W-VC-NDX)
 14151                 CONVERTING W-LOWER-CASE TO W-UPPER-CASE.
 14152
 14153     SET W-WC-NDX UP BY +1.
 14154     MOVE W-VAR-CHAR (W-VG-NDX W-VC-NDX)
 14155                                 TO W-WORK-CHAR (W-WC-NDX)
 14156                                    W-LAST-CHAR.
 14157
 14158 7435-EXIT.
 14159     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 297
* EL689.cbl
 14161 7437-FIND-NEXT-CHARACTER.
 14162*DELIBERATELY LEFT BLANK.
 14163 7437-EXIT.
 14164     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 298
* EL689.cbl
 14166 7440-BACK-TO-NEAREST-WORD.
 14167
 14168     MOVE SPACES                 TO W-WORK-CHAR (W-WC-NDX).
 14169
 14170 7440-EXIT.
 14171     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 299
* EL689.cbl
 14173 7450-SQUEEZING.
 14174
 14175     IF  W-NEW-PARAGRAPH
 14176         PERFORM 7600-SET-PARA-INDENT THRU 7600-EXIT
 14177         MOVE SPACES             TO W-LINE-SQUEEZE-IND
 14178         IF  W-SQUEEZED-LINE GREATER THAN SPACES
 14179             PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 14180             MOVE W-TX-PC (W-TG-NDX)
 14181                                 TO W-PRINT-CONTROL
 14182             MOVE SPACES         TO W-SQUEEZED-LINE
 14183             SET W-SQ-NDX        TO W-INITIAL-COLUMN
 14184             SET W-SQ-NDX UP BY W-WORK-INDENT
 14185         ELSE
 14186             MOVE W-TX-PC (W-TG-NDX)
 14187                                 TO W-PRINT-CONTROL
 14188             SET W-SQ-NDX        TO W-INITIAL-COLUMN
 14189             SET W-SQ-NDX UP BY W-WORK-INDENT
 14190     ELSE
 14191         IF  W-DO-NOT-ADJUST
 14192             MOVE SPACES         TO W-LINE-SQUEEZE-IND
 14193             IF  W-SQUEEZED-LINE GREATER THAN SPACES
 14194                 PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 14195                 MOVE W-WORK-LINE
 14196                                 TO W-SQUEEZED-LINE
 14197                 MOVE W-TX-PC (W-TG-NDX)
 14198                                 TO W-PRINT-CONTROL
 14199                 PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 14200                 SET W-SQ-NDX    TO W-INITIAL-COLUMN
 14201                 MOVE SPACES     TO W-SQUEEZED-LINE
 14202                 GO TO 7450-EXIT
 14203             ELSE
 14204                 MOVE W-WORK-LINE
 14205                                 TO W-SQUEEZED-LINE
 14206                 MOVE W-TX-PC (W-TG-NDX)
 14207                                 TO W-PRINT-CONTROL
 14208                 PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 14209                 MOVE SPACES     TO W-SQUEEZED-LINE
 14210                                    W-WORK-LINE
 14211                 SET W-SQ-NDX    TO W-INITIAL-COLUMN
 14212                 GO TO 7450-EXIT
 14213         ELSE
 14214             IF  W-ADJUST-TO-LINE-LENGTH
 14215                 MOVE SPACES     TO W-LINE-SQUEEZE-IND
 14216
 14217                 IF  W-SQUEEZED-LINE GREATER THAN SPACES
 14218                     PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 14219                     SET W-SQ-NDX
 14220                                 TO W-INITIAL-COLUMN
 14221                     PERFORM 7505-MOVE-STRAIGHT THRU 7505-EXIT
 14222                             VARYING
 14223                         W-WC-NDX FROM 1 BY 1
 14224                             UNTIL
 14225                         W-SQ-NDX EQUAL W-TOO-FAR
 14226                     MOVE W-TX-PC (W-TG-NDX)
 14227                                 TO W-PRINT-CONTROL
 14228                     PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 14229                     SET W-SQ-NDX
 14230                                 TO W-INITIAL-COLUMN
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 300
* EL689.cbl
 14231                     MOVE SPACES TO W-SQUEEZED-LINE
 14232                                    W-WORK-LINE
 14233                     GO TO 7450-EXIT
 14234                 ELSE
 14235                     SET W-SQ-NDX
 14236                                 TO W-INITIAL-COLUMN
 14237                     PERFORM 7505-MOVE-STRAIGHT THRU 7505-EXIT
 14238                             VARYING
 14239                         W-WC-NDX FROM 1 BY 1
 14240                             UNTIL
 14241                         W-SQ-NDX EQUAL W-TOO-FAR
 14242                     MOVE W-TX-PC (W-TG-NDX)
 14243                                 TO W-PRINT-CONTROL
 14244                     PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 14245                     MOVE SPACES TO W-SQUEEZED-LINE
 14246                                    W-WORK-LINE
 14247                     SET W-SQ-NDX
 14248                                 TO W-INITIAL-COLUMN
 14249                     GO TO 7450-EXIT
 14250             ELSE
 14251                 IF  W-CONTINUE-PARAGRAPH
 14252                     IF  W-SQUEEZED-LINE GREATER THAN SPACES
 14253                         PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 14254                         PERFORM 7610-SET-CONP-INDENT
 14255                             THRU 7610-EXIT
 14256                         MOVE SPACES
 14257                                 TO W-LINE-SQUEEZE-IND
 14258                         MOVE W-TX-PC (W-TG-NDX)
 14259                                 TO W-PRINT-CONTROL
 14260                         MOVE SPACES
 14261                                 TO W-SQUEEZED-LINE
 14262                         SET W-SQ-NDX
 14263                                 TO W-INITIAL-COLUMN
 14264                         SET W-SQ-NDX UP BY W-WORK-INDENT
 14265                     ELSE
 14266                         PERFORM 7610-SET-CONP-INDENT
 14267                             THRU 7610-EXIT
 14268                         MOVE SPACES
 14269                                 TO W-LINE-SQUEEZE-IND
 14270                         MOVE W-TX-PC (W-TG-NDX)
 14271                                 TO W-PRINT-CONTROL
 14272                         MOVE SPACES
 14273                                 TO W-SQUEEZED-LINE
 14274                         SET W-SQ-NDX
 14275                                 TO W-INITIAL-COLUMN
 14276                         SET W-SQ-NDX UP BY W-WORK-INDENT.
 14277
 14278
 14279     PERFORM 7480-UPDATE-SQUEEZED-LINE THRU 7480-EXIT
 14280             VARYING
 14281         W-WC-NDX FROM +1 BY +1
 14282             UNTIL
 14283         W-WC-NDX GREATER THAN +70.
 14284
 14285 7450-EXIT.
 14286     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 301
* EL689.cbl
 14288 7460-REMAIN-CHAR-CHECK.
 14289
 14290     IF  W-TX-NDX EQUAL W-WC-NDX
 14291         MOVE W-TX-PC (W-TG-NDX)
 14292                                 TO W-PRINT-CONTROL
 14293         MOVE W-WORK-LINE        TO W-SQUEEZED-LINE
 14294         PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 14295         MOVE SPACES             TO W-WORK-LINE
 14296         SET W-WC-NDX            TO +1
 14297     ELSE
 14298         SET W-TX-NDX1           TO W-TX-NDX
 14299         SEARCH W-TX-CHAR
 14300             VARYING W-TX-NDX1
 14301             AT END
 14302                 MOVE W-TX-PC (W-TG-NDX)
 14303                                 TO W-PRINT-CONTROL
 14304                 MOVE W-WORK-LINE
 14305                                 TO W-SQUEEZED-LINE
 14306                 PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 14307                 MOVE SPACES     TO W-WORK-LINE
 14308                 SET W-WC-NDX    TO +1
 14309                 SET W-TX-NDX    TO +1
 14310                 SET W-TG-NDX UP BY +1
 14311             WHEN
 14312                 W-TX-CHAR (W-TG-NDX W-TX-NDX1) NOT EQUAL SPACES
 14313                 MOVE ER-9427    TO EMI-ERROR
 14314                 MOVE -1         TO MAINTL
 14315                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14316                 MOVE W-TX-PC (W-TG-NDX)
 14317                                 TO W-PRINT-CONTROL
 14318                 MOVE W-WORK-LINE
 14319                                 TO W-SQUEEZED-LINE
 14320                 PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 14321                 MOVE SPACES     TO W-WORK-LINE
 14322                 SET W-WC-NDX    TO +1.
 14323
 14324 7460-EXIT.
 14325     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 302
* EL689.cbl
 14327 7470-MOVE-CHAR.
 14328
 14329     IF  W-FIRST-CHAR-NOT-FOUND
 14330             AND
 14331         W-VAR-CHAR (W-VG-NDX W-VC-NDX) EQUAL SPACES
 14332         MOVE SPACES             TO W-LAST-CHAR
 14333         GO TO 7470-EXIT.
 14334
 14335     MOVE 'Y'                    TO W-FIRST-CHAR-FOUND-IND.
 14336
 14337     IF  W-SQUEEZE-FIELD
 14338             AND
 14339         W-LAST-CHAR EQUAL SPACES
 14340             AND
 14341         W-VAR-CHAR (W-VG-NDX W-VC-NDX) EQUAL SPACES
 14342         GO TO 7470-EXIT.
 14343
 14344     SET W-WC-NDX UP BY +1.
 14345
 14346     IF  W-WC-NDX GREATER THAN +70
 14347         IF  W-FORM-SQUEEZE-ON
 14348             GO TO 7470-EXIT
 14349         ELSE
 14350             MOVE ER-9427        TO EMI-ERROR
 14351             MOVE -1             TO MAINTL
 14352             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14353             GO TO 7470-EXIT.
 14354
 14355     IF  W-USE-UPPER-AND-LOWER-CASE (W-VAR-RELATIVE-NUM)
 14356             AND
 14357         W-VAR-CHAR (W-VG-NDX W-VC-NDX) NOT EQUAL SPACES
 14358             AND
 14359         W-VAR-CHAR (W-VG-NDX W-VC-NDX) ALPHABETIC
 14360             AND
 14361         (W-VC-NDX GREATER THAN +1
 14362                 AND
 14363             W-LAST-CHAR NOT EQUAL SPACE
 14364                 AND
 14365             NOT W-LAST-CHAR-PUNC)
 14366         IF  W-LC-USE-BOTH-CASES
 14367             INSPECT W-VAR-CHAR (W-VG-NDX W-VC-NDX)
 14368                 CONVERTING W-UPPER-CASE TO W-LOWER-CASE
 14369         ELSE
 14370             INSPECT W-VAR-CHAR (W-VG-NDX W-VC-NDX)
 14371                 CONVERTING W-LOWER-CASE TO W-UPPER-CASE.
 14372
 14373     MOVE W-VAR-CHAR (W-VG-NDX W-VC-NDX)
 14374                                 TO W-WORK-CHAR (W-WC-NDX)
 14375                                    W-LAST-CHAR.
 14376
 14377     IF  W-LAST-CHAR EQUAL SPACES
 14378         SET W-LAST-WC-SPACE     TO W-WC-NDX.
 14379
 14380 7470-EXIT.
 14381     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 303
* EL689.cbl
 14383 7480-UPDATE-SQUEEZED-LINE.
 14384****************************************************************
 14385*    THIS SECTION CONTROLS THE MOVEMENT FROM THE WORK LINE TO *
 14386*    THE SQUEEZED LINE.  DURING THIS PROCESS ALL EXTRA SPACES  *
 14387*    (DEFINED AS TWO OR MORE SPACES NOT FOLLOWING A END OF     *
 14388*    SENTENCE INDICATOR) ARE REMOVED.  IF THE LAST CHARACTER   *
 14389*    IS NOT A SPACE OR PUNCTUATION MARK AN UNFINISHED WORD IS  *
 14390*    ASSUMED.  EVERYTHING TO THE PREVIOUS SPACE IS REMOVED     *
 14391****************************************************************
 14392
 14393     SET W-SQ-NDX UP BY +1.
 14394
 14395     IF  W-SQ-NDX GREATER THAN W-LAST-COLUMN
 14396         MOVE W-SQ-CHAR (W-LAST-COLUMN)
 14397                                 TO W-CHARACTER-TYPE
 14398         IF  W-PUNCTUATION
 14399                 OR
 14400             W-SPACE
 14401             PERFORM 7485-FIND-NEXT-CHARACTER THRU 7485-EXIT
 14402             PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 14403             MOVE SPACES         TO W-SQUEEZED-LINE
 14404             SET W-SQ-NDX        TO W-START-COLUMN
 14405             SET W-SQ-NDX UP BY W-NEXT-INDENT
 14406             SET W-LAST-SQUEEZED-SPACE
 14407                                 TO W-SQ-NDX
 14408         ELSE
 14409             PERFORM 7490-REMOVE-LAST-WORD THRU 7490-EXIT
 14410             PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 14411             MOVE SPACES         TO W-SQUEEZED-LINE
 14412             SET W-SQ-NDX        TO W-START-COLUMN
 14413             SET W-SQ-NDX UP BY W-NEXT-INDENT
 14414             SET W-LAST-SQUEEZED-SPACE
 14415                                 TO W-SQ-NDX.
 14416
 14417     IF  W-WC-NDX GREATER THAN +70
 14418         GO TO 7480-EXIT.
 14419
 14420     MOVE W-WORK-CHAR (W-WC-NDX) TO W-CHARACTER-TYPE.
 14421
 14422     IF  W-END-OF-SENTENCE
 14423         MOVE 'Y'                TO W-END-OF-SENTENCE-IND
 14424         SET W-WORK-NDX          TO W-SQ-NDX
 14425         COMPUTE W-DISPLAY-NDX = W-WORK-NDX - 1
 14426         IF  W-DISPLAY-NDX EQUAL W-LAST-SQUEEZED-SPACE
 14427             SET W-SQ-NDX        TO W-LAST-SQUEEZED-SPACE
 14428         ELSE
 14429             NEXT SENTENCE
 14430     ELSE
 14431         IF  W-PUNCTUATION
 14432                 AND
 14433             W-LAST-SQ-CHAR EQUAL SPACES
 14434             SET W-SQ-NDX DOWN BY +1
 14435             MOVE SPACES         TO W-END-OF-SENTENCE-IND
 14436         ELSE
 14437             IF  W-WORK-CHAR (W-WC-NDX) EQUAL SPACES
 14438                 IF  W-LAST-SQ-CHAR EQUAL SPACES
 14439                     IF  W-END-OF-SENTENCE-WORKING
 14440                         MOVE SPACES
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 304
* EL689.cbl
 14441                                 TO W-END-OF-SENTENCE-IND
 14442                         SET W-LAST-SQUEEZED-SPACE
 14443                                 TO W-SQ-NDX
 14444                     ELSE
 14445                         SET W-SQ-NDX DOWN BY +1
 14446                         GO TO 7480-EXIT
 14447                 ELSE
 14448                     SET W-LAST-SQUEEZED-SPACE
 14449                                 TO W-SQ-NDX
 14450             ELSE
 14451                 MOVE SPACES     TO W-END-OF-SENTENCE-IND.
 14452
 14453     MOVE W-WORK-CHAR (W-WC-NDX) TO W-SQ-CHAR (W-SQ-NDX)
 14454                                    W-LAST-SQ-CHAR.
 14455
 14456     IF  W-WC-NDX EQUAL +70
 14457             AND
 14458         W-WORK-CHAR (W-WC-NDX) GREATER THAN SPACES
 14459             AND
 14460         W-SQ-NDX NOT EQUAL W-LAST-COLUMN
 14461         SET W-SQ-NDX UP BY +1
 14462         SET W-LAST-SQUEEZED-SPACE
 14463                                 TO W-SQ-NDX
 14464         MOVE SPACES             TO W-SQ-CHAR (W-SQ-NDX)
 14465                                    W-LAST-SQ-CHAR.
 14466
 14467 7480-EXIT.
 14468     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 305
* EL689.cbl
 14470 7485-FIND-NEXT-CHARACTER.
 14471
 14472     MOVE W-WORK-CHAR (W-WC-NDX) TO W-CHARACTER-TYPE.
 14473
 14474     IF  W-PUNCTUATION
 14475         PERFORM 7490-REMOVE-LAST-WORD THRU 7490-EXIT
 14476     ELSE
 14477         SET W-WC-NDX            TO W-WC-NDX
 14478         SEARCH W-WORK-CHAR
 14479             VARYING W-WC-NDX
 14480             AT END
 14481                 GO TO 7485-EXIT
 14482             WHEN
 14483                 W-WORK-CHAR (W-WC-NDX) NOT EQUAL SPACES
 14484                 GO TO 7485-EXIT.
 14485
 14486 7485-EXIT.
 14487     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 306
* EL689.cbl
 14489 7490-REMOVE-LAST-WORD.
 14490
 14491*********  NOTE: W-WORK-LINE ALWAYS STARTS WITH A FULL WORD*******
 14492     IF  W-WC-NDX EQUAL +1
 14493         GO TO 7490-EXIT.
 14494
 14495     ADD +1                      TO W-LAST-SQUEEZED-SPACE.
 14496
 14497     PERFORM 7500-CLEAR-SQUEEZED-EXCESS THRU 7500-EXIT
 14498             VARYING
 14499         W-SQ-NDX FROM W-LAST-SQUEEZED-SPACE BY +1
 14500             UNTIL
 14501         W-SQ-NDX EQUAL W-TOO-FAR.
 14502
 14503     SET W-WORK-NDX              TO W-WC-NDX.
 14504     COMPUTE W-LAST-WC-SPACE
 14505         = W-WORK-NDX - W-TOO-FAR + W-LAST-SQUEEZED-SPACE.
 14506     SET W-WC-NDX                TO W-LAST-WC-SPACE.
 14507
 14508 7490-EXIT.
 14509     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 307
* EL689.cbl
 14511 7500-CLEAR-SQUEEZED-EXCESS.
 14512
 14513     MOVE SPACES                 TO W-SQ-CHAR (W-SQ-NDX).
 14514
 14515 7500-EXIT.
 14516     EXIT.
 14517
 14518 7505-MOVE-STRAIGHT.
 14519
 14520     SET W-SQ-NDX UP BY +1.
 14521
 14522     MOVE W-WORK-CHAR (W-WC-NDX) TO W-SQ-CHAR (W-SQ-NDX).
 14523
 14524 7505-EXIT.
 14525     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 308
* EL689.cbl
 14527 7510-MOVE-TO-TABLE.
 14528
 14529     IF  W-PRINT-CONTROL NOT NUMERIC
 14530         MOVE 00                 TO W-PRINT-CONTROL
 14531         ADD +1                  TO W-LINE-COUNT
 14532     ELSE
 14533         IF  W-PRINT-CONTROL EQUAL 99
 14534             PERFORM 7640-PAGING THRU 7640-EXIT
 14535             MOVE 00             TO W-PRINT-CONTROL
 14536             SET W-RG-NDX UP BY +1
 14537             MOVE W-TOP-FORM     TO W-RC-TEXT (W-RG-NDX)
 14538             MOVE +1             TO W-LINE-COUNT
 14539             SET W-RG-NDX UP BY W-TOP-MARGIN
 14540         ELSE
 14541             COMPUTE W-LINE-COUNT
 14542                 = W-LINE-COUNT + W-PRINT-CONTROL + 1.
 14543
 14544     IF  W-LINE-COUNT GREATER THAN W-MAX-LINES-PER-PAGE
 14545         PERFORM 7640-PAGING THRU 7640-EXIT
 14546         MOVE 00                 TO W-PRINT-CONTROL
 14547         SET W-RG-NDX UP BY +1
 14548         MOVE W-TOP-FORM         TO W-RC-TEXT (W-RG-NDX)
 14549         SET W-RG-NDX UP BY W-TOP-MARGIN
 14550         MOVE +1                 TO W-LINE-COUNT.
 14551
 14552     SET W-RG-NDX UP BY W-PRINT-CONTROL.
 14553     SET W-RG-NDX UP BY +1.
 14554     MOVE W-SQUEEZED-LINE        TO W-RC-TEXT (W-RG-NDX).
 14555     MOVE 00                     TO W-PRINT-CONTROL.
 14556
 14557     IF  W-FIRST-BAD-VARIABLE-FOUND
 14558             AND
 14559         W-FIRST-BAD-VARIABLE EQUAL ZEROS
 14560         SET W-FIRST-BAD-VARIABLE
 14561                                 TO W-RG-NDX.
 14562
 14563 7510-EXIT.
 14564     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 309
* EL689.cbl
 14566 7600-SET-PARA-INDENT.
 14567
 14568     IF  W-LINE-SQUEEZE-IND EQUAL 'P'
 14569         MOVE W-PARAGRAPH-INDENT TO W-WORK-INDENT
 14570     ELSE
 14571     IF  W-LINE-SQUEEZE-IND EQUAL 'Q'
 14572         MOVE W-LINE-INDENT-1    TO W-WORK-INDENT
 14573         ADD W-PARAGRAPH-INDENT  TO W-WORK-INDENT
 14574     ELSE
 14575     IF  W-LINE-SQUEEZE-IND EQUAL 'R'
 14576         MOVE W-LINE-INDENT-2    TO W-WORK-INDENT
 14577         ADD W-PARAGRAPH-INDENT  TO W-WORK-INDENT
 14578     ELSE
 14579     IF  W-LINE-SQUEEZE-IND EQUAL 'S'
 14580         MOVE W-LINE-INDENT-3    TO W-WORK-INDENT
 14581         ADD W-PARAGRAPH-INDENT  TO W-WORK-INDENT
 14582     ELSE
 14583     IF  W-LINE-SQUEEZE-IND EQUAL 'T'
 14584         MOVE W-LINE-INDENT-4    TO W-WORK-INDENT
 14585         ADD W-PARAGRAPH-INDENT  TO W-WORK-INDENT
 14586     ELSE
 14587     IF  W-LINE-SQUEEZE-IND EQUAL 'U'
 14588         MOVE W-LINE-INDENT-5    TO W-WORK-INDENT
 14589         ADD W-PARAGRAPH-INDENT  TO W-WORK-INDENT.
 14590
 14591     SET W-TG-NDX2               TO W-TG-NDX.
 14592     SET W-TG-NDX2 UP BY +1.
 14593
 14594     IF  W-TG-NDX EQUAL W-TOTAL-TX-LINES
 14595         MOVE W-WORK-INDENT      TO W-NEXT-INDENT
 14596     ELSE
 14597         PERFORM 7630-NEXT-LINE THRU 7630-EXIT.
 14598
 14599 7600-EXIT.
 14600     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 310
* EL689.cbl
 14602 7610-SET-CONP-INDENT.
 14603
 14604     IF  W-LINE-SQUEEZE-IND EQUAL 'C'
 14605         MOVE +0                 TO W-WORK-INDENT
 14606     ELSE
 14607     IF  W-LINE-SQUEEZE-IND EQUAL 'D'
 14608         MOVE W-LINE-INDENT-1    TO W-WORK-INDENT
 14609     ELSE
 14610     IF  W-LINE-SQUEEZE-IND EQUAL 'E'
 14611         MOVE W-LINE-INDENT-2    TO W-WORK-INDENT
 14612     ELSE
 14613     IF  W-LINE-SQUEEZE-IND EQUAL 'F'
 14614         MOVE W-LINE-INDENT-3    TO W-WORK-INDENT
 14615     ELSE
 14616     IF  W-LINE-SQUEEZE-IND EQUAL 'G'
 14617         MOVE W-LINE-INDENT-4    TO W-WORK-INDENT
 14618     ELSE
 14619     IF  W-LINE-SQUEEZE-IND EQUAL 'H'
 14620         MOVE W-LINE-INDENT-5    TO W-WORK-INDENT.
 14621
 14622     SET W-TG-NDX2               TO W-TG-NDX.
 14623     SET W-TG-NDX2 UP BY +1.
 14624
 14625     IF  W-TG-NDX EQUAL W-TOTAL-TX-LINES
 14626         MOVE W-WORK-INDENT      TO W-NEXT-INDENT
 14627     ELSE
 14628         PERFORM 7630-NEXT-LINE THRU 7630-EXIT.
 14629
 14630 7610-EXIT.
 14631     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 311
* EL689.cbl
 14633 7630-NEXT-LINE.
 14634
 14635     IF  W-TX-SC (W-TG-NDX2) EQUAL ' '
 14636         MOVE ZEROS              TO W-NEXT-INDENT
 14637     ELSE
 14638     IF  W-TX-SC (W-TG-NDX2) EQUAL '1'
 14639         MOVE W-LINE-INDENT-1    TO W-NEXT-INDENT
 14640     ELSE
 14641     IF  W-TX-SC (W-TG-NDX2) EQUAL '2'
 14642         MOVE W-LINE-INDENT-2    TO W-NEXT-INDENT
 14643     ELSE
 14644     IF  W-TX-SC (W-TG-NDX2) EQUAL '3'
 14645         MOVE W-LINE-INDENT-3    TO W-NEXT-INDENT
 14646     ELSE
 14647     IF  W-TX-SC (W-TG-NDX2) EQUAL '4'
 14648         MOVE W-LINE-INDENT-4    TO W-NEXT-INDENT
 14649     ELSE
 14650     IF  W-TX-SC (W-TG-NDX2) EQUAL '5'
 14651         MOVE W-LINE-INDENT-5    TO W-NEXT-INDENT
 14652     ELSE
 14653         MOVE W-WORK-INDENT      TO W-NEXT-INDENT
 14654         SUBTRACT W-PARAGRAPH-INDENT
 14655                                  FROM W-NEXT-INDENT.
 14656
 14657 7630-EXIT.
 14658     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 312
* EL689.cbl
 14660 7640-PAGING.
 14661
 14662     IF  NOT W-LC-CREATE-PAGES
 14663         GO TO 7640-EXIT.
 14664
 14665     IF  W-LINE-COUNT GREATER ZEROS
 14666             AND
 14667         W-RG-NDX GREATER THAN +1
 14668         ADD +1                  TO W-PAGE
 14669         MOVE W-PAGE             TO W-PAGE-NUMBER
 14670         COMPUTE W-PAGE-LINE
 14671             = W-MAX-LINES-PER-PAGE - W-LINE-COUNT + 3
 14672         IF  W-PAGE-LINE GREATER THAN +2
 14673             SET W-RG-NDX UP BY W-PAGE-LINE
 14674             MOVE W-PAGE-PRT     TO W-RC-TEXT (W-RG-NDX)
 14675         ELSE
 14676             SET W-RG-NDX UP BY +2
 14677             MOVE W-PAGE-PRT     TO W-RC-TEXT (W-RG-NDX).
 14678
 14679 7640-EXIT.
 14680     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 313
* EL689.cbl
 14682 7700-READ-TEXT-TS.
 14683**************************************************************
 14684*  THIS PARAGRAPH READS THE TEMPORARY STORAGE RECORDS THAT   *
 14685*  CONTAIN THE TEXT THAT IS PAST BETWEEN EL689, EL6892       *
 14686*  AND EL1042.                                               *
 14687**************************************************************
 14688
 14689
 14690* EXEC CICS HANDLE CONDITION
 14691*         QIDERR     (7700-TS-ERROR)
 14692*         ITEMERR    (7700-TS-ERROR)
 14693*    END-EXEC.
 14694*    MOVE '"$N<                  ! > #00013700' TO DFHEIV0
 14695     MOVE X'22244E3C2020202020202020' TO DFHEIV0(1:12)
 14696     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14697     MOVE X'3E20233030303133373030' TO DFHEIV0(25:11)
 14698     CALL 'kxdfhei1' USING DFHEIV0
 14699     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14700
 14701
 14702     SET W-TS-NDX                TO 1.
 14703     MOVE 1                      TO W-TS-ITEM.
 14704
 14705 7700-LOOP.
 14706
 14707     IF  W-TS-ITEM GREATER THAN PI-TEMP-STOR-ITEMS
 14708         IF  PI-TEMP-STOR-ITEMS GREATER THAN ZEROS
 14709             PERFORM 7780-DELETE-TEMP-STOR-TEXT THRU 7780-EXIT
 14710             GO TO 7700-EXIT
 14711         ELSE
 14712             GO TO 7700-EXIT.
 14713
 14714
 14715* EXEC CICS READQ TS
 14716*         INTO     (W-TS-WORK-AREA)
 14717*         QUEUE    (W-TS-NAME-TEXT)
 14718*         LENGTH   (W-TS-LENGTH)
 14719*         ITEM     (W-TS-ITEM)
 14720*    END-EXEC.
 14721*    MOVE '*$II   L              ''   #00013717' TO DFHEIV0
 14722     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
 14723     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14724     MOVE X'2020233030303133373137' TO DFHEIV0(25:11)
 14725     CALL 'kxdfhei1' USING DFHEIV0,
 14726           W-TS-NAME-TEXT,
 14727           W-TS-WORK-AREA,
 14728           W-TS-LENGTH,
 14729           W-TS-ITEM,
 14730           DFHEIV99,
 14731           DFHEIV99
 14732     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14733
 14734
 14735     MOVE W-TS-WORK-AREA         TO W-TS-GROUP (W-TS-NDX).
 14736     SET W-TS-NDX UP BY 1.
 14737     ADD 1                       TO W-TS-ITEM.
 14738     GO TO 7700-LOOP.
 14739
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 314
* EL689.cbl
 14740 7700-TS-ERROR.
 14741
 14742     IF  EIBTRNID = W-TRANSACTION OR 'EX14'
 14743         MOVE ER-0033            TO EMI-ERROR
 14744         MOVE -1                 TO MAINTL
 14745         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14746         GO TO 8200-SEND-DATAONLY.
 14747
 14748 7700-EXIT.
 14749      EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 315
* EL689.cbl
 14751 7740-RESTORE-SCREEN.
 14752
 14753     MOVE 'C'                    TO MAINTI.
 14754     MOVE +1                     TO MAINTL.
 14755     MOVE AL-UANON               TO MAINTA.
 14756
 14757     MOVE PI-689-FORM-NUMBER     TO FORMI.
 14758     MOVE +4                     TO FORML.
 14759     MOVE AL-UANON               TO FORMA.
 14760
 14761     IF  PI-689-PRINT-RESTRICTION GREATER THAN SPACES
 14762         MOVE PI-689-PRINT-RESTRICTION
 14763                                 TO PRTRESTL
 14764         MOVE +1                 TO PRTRESTL
 14765         MOVE AL-UANON           TO PRTRESTA.
 14766
 14767     IF  PI-689-FOLLOW-UP-EDIT GREATER THAN SPACES
 14768         MOVE PI-689-FOLLOW-UP-EDIT
 14769                                 TO FOLLOWI
 14770         MOVE +8                 TO FOLLOWL
 14771         MOVE AL-UANON           TO FOLLOWA.
 14772
 14773     IF  PI-689-RESEND1-EDIT GREATER THAN SPACES
 14774         MOVE PI-689-RESEND1-EDIT
 14775                                 TO RESEND1I
 14776         MOVE +8                 TO RESEND1L
 14777         MOVE AL-UANON           TO RESEND1A.
 14778     IF  PI-689-ALT-PRINTER-ID GREATER THAN SPACES
 14779         MOVE PI-689-ALT-PRINTER-ID
 14780                                 TO PRINTERI
 14781         MOVE +1                 TO PRINTERL
 14782         MOVE AL-UANON           TO PRINTERA.
 14783
 14784     IF  PI-BYPASS-LABELS
 14785          MOVE PI-LABEL-CONTROL  TO ADDRLBLI
 14786          MOVE +1                TO ADDRLBLL
 14787          MOVE AL-UANON          TO ADDRLBLA
 14788     ELSE
 14789          IF  PI-689-LBL-OVERRIDE GREATER THAN SPACES
 14790               MOVE PI-689-LBL-OVERRIDE
 14791                                 TO ADDRLBLI
 14792               MOVE +1           TO ADDRLBLL
 14793               MOVE AL-UANON     TO ADDRLBLA.
 14794
 14795     IF  PI-689-NUMBER-COPIES GREATER THAN ZEROS
 14796         MOVE PI-689-NUMBER-COPIES   TO COPIESI
 14797         MOVE +1                     TO COPIESL
 14798         MOVE AL-UNNON               TO COPIESA.
 14799
 14800     IF  PI-689-LABEL-SOURCE GREATER THAN SPACES
 14801         MOVE PI-689-LABEL-SOURCE
 14802                                 TO ADDRSI
 14803         MOVE +1                 TO ADDRSL
 14804         MOVE AL-UANON           TO ADDRSA.
 14805
 14806     MOVE PI-689-DATA-SOURCE     TO DATASORI.
 14807     MOVE +1                     TO DATASORL.
 14808     MOVE AL-UANON               TO DATASORA.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 316
* EL689.cbl
 14809
 14810     IF  PI-689-CARRIER GREATER THAN SPACES
 14811         MOVE PI-689-CARRIER     TO CARRIERI
 14812         MOVE +1                 TO CARRIERL
 14813         MOVE AL-UANON           TO CARRIERA.
 14814
 14815     IF  PI-689-GROUPING GREATER THAN SPACES
 14816         MOVE PI-689-GROUPING    TO GROUPI
 14817         MOVE +6                 TO GROUPL
 14818         MOVE AL-UANON           TO GROUPA.
 14819
 14820     IF  PI-689-STATE GREATER THAN SPACES
 14821         MOVE PI-689-STATE       TO STATEI
 14822         MOVE +2                 TO STATEL
 14823         MOVE AL-UANON           TO STATEA.
 14824
 14825     IF  PI-689-ACCOUNT GREATER THAN SPACES
 14826         MOVE PI-689-ACCOUNT     TO ACCTI
 14827         MOVE +10                TO ACCTL
 14828         MOVE AL-UANON           TO ACCTA.
 14829
 14830     IF  PI-689-CERT-PRIME GREATER THAN SPACES
 14831         MOVE PI-689-CERT-PRIME  TO CERTI
 14832         MOVE +10                TO CERTL
 14833         MOVE AL-UANON           TO CERTA.
 14834
 14835     IF  PI-689-CERT-PRIME GREATER THAN SPACES
 14836         MOVE PI-689-CERT-SFX    TO SFXI
 14837         MOVE +1                 TO SFXL
 14838         MOVE AL-UANON           TO SFXA.
 14839
 14840     IF  PI-689-TYPE GREATER THAN SPACES
 14841         MOVE PI-689-TYPE        TO TYPEI
 14842         MOVE +1                 TO TYPEL
 14843         MOVE AL-UANON           TO TYPEA.
 14844
 14845     IF  PI-689-RESP-PERSON GREATER THAN SPACES
 14846         MOVE PI-689-RESP-PERSON TO RPERSONI
 14847         MOVE +10                TO RPERSONL
 14848         MOVE AL-UANON           TO RPERSONA.
 14849
 14850     IF  PI-689-ENTRY-BATCH GREATER THAN SPACES
 14851         MOVE PI-689-ENTRY-BATCH TO BENTRYI
 14852         MOVE +6                 TO BENTRYL
 14853         MOVE AL-UANON           TO BENTRYA.
 14854
 14855     IF  PI-689-SEQ-EDIT GREATER THAN SPACES
 14856         MOVE PI-689-SEQ-EDIT    TO SEQI
 14857         MOVE +8                 TO SEQL
 14858         MOVE AL-UNNON           TO SEQA.
 14859
 14860     IF  PI-689-BCSEQ-EDIT GREATER THAN SPACES
 14861         MOVE PI-689-BCSEQ-EDIT  TO BCSEQI
 14862         MOVE +4                 TO BCSEQL
 14863         MOVE AL-UNNON           TO BCSEQA.
 14864
 14865     IF  PI-689-DATE-EDIT GREATER THAN SPACES
 14866         MOVE PI-689-DATE-EDIT   TO DATEI
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 317
* EL689.cbl
 14867         MOVE +8                 TO DATEL
 14868         MOVE AL-UNNON           TO DATEA.
 14869
 14870 7749-EXIT.
 14871     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 318
* EL689.cbl
 14873 7760-PUT-TEMP-STORAGE.
 14874**************************************************************
 14875*  THIS PARAGRAPH WRITES THE TEMPORARY STORAGE RECORDS THAT  *
 14876*  WILL CONTAIN THE CONTENTS OF THE TEXT TABLE FOR USE BY    *
 14877*  EL1042 AND EL6892.                                        *
 14878**************************************************************
 14879
 14880     SET W-TS-NDX                TO 1.
 14881     MOVE 0                      TO PI-TEMP-STOR-ITEMS.
 14882
 14883     MOVE -1                     TO MAINTL.
 14884     PERFORM 7840-WRITE-TS THRU 7840-EXIT
 14885             VARYING
 14886         W-TS-GROUP-WORK FROM 0 BY W-TS-NUM-REC-IN-GROUP
 14887             UNTIL
 14888         W-TS-GROUP-WORK NOT LESS THAN PI-TOTAL-LINES.
 14889
 14890 7760-EXIT.
 14891      EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 319
* EL689.cbl
 14893 7780-DELETE-TEMP-STOR-TEXT.
 14894
 14895
 14896* EXEC CICS HANDLE CONDITION
 14897*         QIDERR      (7780-EXIT)
 14898*    END-EXEC.
 14899*    MOVE '"$N                   ! ? #00013884' TO DFHEIV0
 14900     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 14901     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14902     MOVE X'3F20233030303133383834' TO DFHEIV0(25:11)
 14903     CALL 'kxdfhei1' USING DFHEIV0
 14904     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14905
 14906
 14907
 14908* EXEC CICS DELETEQ TS
 14909*         QUEUE       (W-TS-NAME-TEXT)
 14910*    END-EXEC.
 14911*    MOVE '*&                    #   #00013888' TO DFHEIV0
 14912     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
 14913     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14914     MOVE X'2020233030303133383838' TO DFHEIV0(25:11)
 14915     CALL 'kxdfhei1' USING DFHEIV0,
 14916           W-TS-NAME-TEXT,
 14917           DFHEIV99
 14918     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14919
 14920
 14921 7780-EXIT.
 14922     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 320
* EL689.cbl
 14924 7840-WRITE-TS.
 14925
 14926     MOVE W-TS-GROUP (W-TS-NDX)  TO W-TS-WORK-AREA.
 14927     SET W-TS-NDX UP BY 1.
 14928     ADD 1                       TO PI-TEMP-STOR-ITEMS.
 14929
 14930
 14931* EXEC CICS WRITEQ TS
 14932*         FROM    (W-TS-WORK-AREA)
 14933*         QUEUE   (W-TS-NAME-TEXT)
 14934*         LENGTH  (W-TS-LENGTH)
 14935*         ITEM    (PI-TEMP-STOR-ITEMS)
 14936*    END-EXEC.
 14937*    MOVE '*" I                  ''   #00013901' TO DFHEIV0
 14938     MOVE X'2A2220492020202020202020' TO DFHEIV0(1:12)
 14939     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14940     MOVE X'2020233030303133393031' TO DFHEIV0(25:11)
 14941     CALL 'kxdfhei1' USING DFHEIV0,
 14942           W-TS-NAME-TEXT,
 14943           W-TS-WORK-AREA,
 14944           W-TS-LENGTH,
 14945           PI-TEMP-STOR-ITEMS,
 14946           DFHEIV99,
 14947           DFHEIV99
 14948     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14949
 14950
 14951 7840-EXIT.
 14952     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 321
* EL689.cbl
 14954 7900-PRINT-LETTER-NOW.
 14955***************************************************************
 14956*     THIS ROUTINE WILL CAUSE THE CURRENTLY CREATED LETTER    *
 14957*     TO BE PRINTED ON A HARDCOPY PRINTER.                    *
 14958*     THE TEXT IS EDITED FOR ANY UNRESOLVED SYMBOLS.          *
 14959*     THE PRINTER ID IS OBTAINED FROM THE CONTROL FILE.       *
 14960*     THE LETTER IS SAVED IN TEMP-STORAGE AND A START IS      *
 14961*     ISSUED FOR THE PRINT TRANSACTION.                       *
 14962***************************************************************
 14963
 14964     IF (EIBAID = DFHPF4 OR DFHPF8)
 14965             AND
 14966         PI-SHOW-MODE
 14967         IF  PRINTERL GREATER ZERO
 14968             INSPECT PRINTERI CONVERTING W-LOWER-CASE TO
 14969                                                     W-UPPER-CASE
 14970             MOVE PRINTERI       TO PI-689-ALT-PRINTER-ID
 14971                                    PI-ALT-DMD-PRT-ID.
 14972
 14973     IF  EIBAID EQUAL DFHPF8
 14974             AND
 14975         PI-SHOW-MODE
 14976             AND
 14977         LA-INITIAL-PRINT-DATE GREATER THAN LOW-VALUES
 14978         MOVE ER-7247            TO EMI-ERROR
 14979         MOVE -1                 TO MAINTL
 14980         MOVE AL-UABON           TO MAINTA
 14981         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14982         GO TO 8200-SEND-DATAONLY.
 14983
 14984     IF  PI-TOTAL-LINES EQUAL 0
 14985         MOVE ER-0187            TO EMI-ERROR
 14986         MOVE -1                 TO MAINTL
 14987         MOVE AL-UABON           TO MAINTA
 14988         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14989         GO TO 8200-SEND-DATAONLY.
 14990
 14991     IF  EMI-ERROR NOT EQUAL ER-0191
 14992         IF  PI-689-CREATE-NO-SCREENS
 14993                 OR
 14994             (EIBAID = DFHPF4 OR DFHPF8)
 14995             SET W-RG-NDX        TO +1
 14996         ELSE
 14997             PERFORM 4100-SET-NDX THRU 4100-EXIT
 14998             PERFORM 4200-UPDATE-TABLE-FROM-SCREEN THRU 4200-EXIT
 14999                     VARYING
 15000                 W-SC-NDX FROM 1 BY 1
 15001                     UNTIL
 15002                 W-SC-NDX GREATER THAN W-NUM-LINES-PER-SCREEN.
 15003
 15004     MOVE SPACES                 TO W-REMAINING-VAR-SW.
 15005
 15006     IF EIBAID NOT = DFHPF4 AND DFHPF8
 15007         PERFORM 7915-SEARCH-REMAINING-VARS THRU 7915-EXIT
 15008                 VARYING
 15009             W-RVS-NDX FROM +1 BY +1
 15010                 UNTIL
 15011             W-RVS-NDX GREATER THAN +36500
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 322
* EL689.cbl
 15012                 OR
 15013             W-REMAINING-VAR-FOUND
 15014         IF  W-REMAINING-VAR-FOUND
 15015             GO TO 4000-ROLL-PAGE.
 15016
 15017     IF EIBAID = DFHPF4 OR DFHPF8
 15018        PERFORM 7700-READ-TEXT-TS
 15019                                 THRU 7700-EXIT
 15020         PERFORM 4100-SET-NDX THRU 4100-EXIT
 15021         PERFORM 4200-UPDATE-TABLE-FROM-SCREEN THRU 4200-EXIT
 15022                 VARYING
 15023             W-SC-NDX FROM 1 BY 1
 15024                 UNTIL
 15025             W-SC-NDX GREATER THAN W-NUM-LINES-PER-SCREEN
 15026        PERFORM 7760-PUT-TEMP-STORAGE
 15027                                 THRU 7760-EXIT
 15028     END-IF
 15029     IF PI-689-ALT-PRINTER-ID NOT = SPACES AND LOW-VALUES
 15030         MOVE PI-689-ALT-PRINTER-ID
 15031                                 TO W-TS-TERM-TEXT
 15032     ELSE
 15033         IF PI-PROCESSOR-PRINTER NOT = SPACES AND LOW-VALUES
 15034             MOVE PI-PROCESSOR-PRINTER
 15035                                 TO W-TS-TERM-TEXT
 15036         ELSE
 15037             MOVE PI-COMPANY-ID  TO W-CNTL-COMPANY-ID
 15038             MOVE '1'            TO W-CNTL-RECORD-TYPE
 15039             MOVE SPACES         TO W-CNTL-GENL
 15040             MOVE ZEROS          TO W-CNTL-SEQ-NO
 15041
 15042* EXEC CICS HANDLE CONDITION
 15043*                 NOTOPEN    (8040-CNTL-NOT-OPEN)
 15044*                 NOTFND     (7945-NOT-FOUND)
 15045*            END-EXEC
 15046*    MOVE '"$JI                  ! @ #00013998' TO DFHEIV0
 15047     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 15048     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15049     MOVE X'4020233030303133393938' TO DFHEIV0(25:11)
 15050     CALL 'kxdfhei1' USING DFHEIV0
 15051     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15052
 15053* EXEC CICS READ
 15054*                 DATASET    (W-CNTL-FILE-ID)
 15055*                 SET        (ADDRESS OF CONTROL-FILE)
 15056*                 RIDFLD     (W-CNTL-KEY)
 15057*            END-EXEC
 15058*    MOVE '&"S        E          (   #00014002' TO DFHEIV0
 15059     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15060     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15061     MOVE X'2020233030303134303032' TO DFHEIV0(25:11)
 15062     CALL 'kxdfhei1' USING DFHEIV0,
 15063           W-CNTL-FILE-ID,
 15064           DFHEIV20,
 15065           DFHEIV99,
 15066           W-CNTL-KEY,
 15067           DFHEIV99,
 15068           DFHEIV99,
 15069           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 323
* EL689.cbl
 15070     SET ADDRESS OF CONTROL-FILE TO
 15071         DFHEIV20
 15072     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15073             MOVE CF-FORMS-PRINTER-ID
 15074                                 TO W-TS-TERM-TEXT.
 15075
 15076***********************************************************
 15077*      CHECK TO SEE IF IT IS A PRINT REQUEST FOR PRINTING *
 15078*      LETTERS ON A 3275 PRINTER. IF SO, SAVE THE SCREEN  *
 15079***********************************************************
 15080
 15081     SET W-TS-NDX                TO 1.
 15082     MOVE EIBTIME                TO W-TS-ID-TIME.
 15083     MOVE W-TS-NAME-TEXT         TO PI-689-TEMP-STOR-ID.
 15084     MOVE 0                      TO PI-TEMP-STOR-ITEMS.
 15085
 15086     PERFORM 7840-WRITE-TS THRU 7840-EXIT
 15087             VARYING
 15088         W-TS-GROUP-WORK FROM 0 BY W-TS-NUM-REC-IN-GROUP
 15089             UNTIL
 15090         W-TS-GROUP-WORK NOT LESS THAN PI-TOTAL-LINES.
 15091
 15092     IF  EIBAID EQUAL DFHPF8
 15093         MOVE '1'                TO PI-689-PRINT-SW
 15094     ELSE
 15095         MOVE SPACES             TO PI-689-PRINT-SW.
 15096
 15097
 15098* EXEC CICS HANDLE CONDITION
 15099*         TERMIDERR  (7935-TERM-ERROR)
 15100*         TRANSIDERR (7940-TRAN-ERROR)
 15101*    END-EXEC.
 15102*    MOVE '"$[\                  ! A #00014031' TO DFHEIV0
 15103     MOVE X'22245B5C2020202020202020' TO DFHEIV0(1:12)
 15104     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15105     MOVE X'4120233030303134303331' TO DFHEIV0(25:11)
 15106     CALL 'kxdfhei1' USING DFHEIV0
 15107     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15108
 15109
 15110
 15111* EXEC CICS START
 15112*             INTERVAL    (0)
 15113*             TRANSID     (W-PRINT-TRANS)
 15114*             FROM        (PROGRAM-INTERFACE-BLOCK)
 15115*             LENGTH      (PI-COMM-LENGTH)
 15116*             TERMID      (W-TS-TERM-TEXT)
 15117*    END-EXEC.
 15118     MOVE 0 TO DFHEIV10
 15119*    MOVE '0(ILFT                0   #00014036' TO DFHEIV0
 15120     MOVE X'3028494C4654202020202020' TO DFHEIV0(1:12)
 15121     MOVE X'202020202020202020203020' TO DFHEIV0(13:12)
 15122     MOVE X'2020233030303134303336' TO DFHEIV0(25:11)
 15123     CALL 'kxdfhei1' USING DFHEIV0,
 15124           DFHEIV10,
 15125           W-PRINT-TRANS,
 15126           DFHEIV99,
 15127           PROGRAM-INTERFACE-BLOCK,
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 324
* EL689.cbl
 15128           PI-COMM-LENGTH,
 15129           W-TS-TERM-TEXT,
 15130           DFHEIV99,
 15131           DFHEIV99,
 15132           DFHEIV99,
 15133           DFHEIV99,
 15134           DFHEIV99,
 15135           DFHEIV99,
 15136           DFHEIV99,
 15137           DFHEIV99,
 15138           DFHEIV99
 15139     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15140
 15141
 15142
 15143* EXEC CICS SYNCPOINT
 15144*    END-EXEC.
 15145*    MOVE '6"                    !   #00014044' TO DFHEIV0
 15146     MOVE X'362220202020202020202020' TO DFHEIV0(1:12)
 15147     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15148     MOVE X'2020233030303134303434' TO DFHEIV0(25:11)
 15149     CALL 'kxdfhei1' USING DFHEIV0
 15150     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15151
 15152
 15153     IF  PI-689-CREATE-NO-SCREENS
 15154         GO TO 7900-EXIT.
 15155
 15156     IF  EIBAID EQUAL DFHPF8
 15157             AND
 15158         PI-SHOW-MODE
 15159             AND
 15160         LA-INITIAL-PRINT-DATE EQUAL LOW-VALUES
 15161         PERFORM 7920-UPDATE-INITIAL-PRINT THRU 7920-EXIT.
 15162
 15163     MOVE ER-0189                TO EMI-ERROR.
 15164     MOVE -1                     TO MAINTL.
 15165
 15166     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 15167     MOVE -1                     TO MAINTL
 15168     MOVE AL-UABON               TO MAINTA
 15169     MOVE '104A'                 TO W-TS-ID-TEXT
 15170     MOVE EIBTRMID               TO W-TS-TERM-TEXT
 15171                                    W-TS-TERM-SCREEN
 15172     GO TO 8200-SEND-DATAONLY.
 15173
 15174 7900-EXIT.
 15175     EXIT.
 15176
 15177 7915-SEARCH-REMAINING-VARS.
 15178
 15179     IF  W-REC-CHAR (W-RVS-NDX) EQUAL '@'
 15180         SET W-RVS-NDX2          TO W-RVS-NDX
 15181         SET W-RVS-NDX2 UP BY +1
 15182         IF  W-REC-CHAR (W-RVS-NDX2) EQUAL '@'
 15183             SET W-RVS-NDX2 UP BY +1
 15184             IF  W-REC-CHAR (W-RVS-NDX2) NUMERIC
 15185                 SET PI-CURRENT-LINE  TO W-RVS-NDX
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 325
* EL689.cbl
 15186                 COMPUTE PI-CURRENT-LINE
 15187                     = PI-CURRENT-LINE / 73
 15188                 MOVE 'Y'        TO W-REMAINING-VAR-SW
 15189                 MOVE +0         TO W-ROLL-COUNTER
 15190                 MOVE ER-0191    TO EMI-ERROR
 15191                 MOVE -1         TO MAINTL
 15192                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15193
 15194 7915-EXIT.
 15195     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 326
* EL689.cbl
 15197 7920-UPDATE-INITIAL-PRINT.
 15198
 15199
 15200* EXEC CICS HANDLE CONDITION
 15201*         NOTOPEN    (8010-ARCH-NOT-OPEN)
 15202*         NOTFND     (1070-ARCH-NOT-FOUND)
 15203*         ENDFILE    (1070-ARCH-NOT-FOUND)
 15204*    END-EXEC.
 15205*    MOVE '"$JI''                 ! B #00014093' TO DFHEIV0
 15206     MOVE X'22244A492720202020202020' TO DFHEIV0(1:12)
 15207     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15208     MOVE X'4220233030303134303933' TO DFHEIV0(25:11)
 15209     CALL 'kxdfhei1' USING DFHEIV0
 15210     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15211
 15212     MOVE PI-COMPANY-CD TO W-ARCH-COMPANY-CD
 15213     MOVE ARCHNUMI               TO W-ARCH-NUMBER
 15214
 15215* EXEC CICS READ
 15216*        DATASET (W-ARCH-FILE-ID)
 15217*        SET     (ADDRESS OF LETTER-ARCHIVE)
 15218*        RIDFLD  (W-ARCH-PARTIAL-KEY)
 15219*        UPDATE
 15220*    END-EXEC.
 15221*    MOVE '&"S        EU         (   #00014100' TO DFHEIV0
 15222     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15223     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15224     MOVE X'2020233030303134313030' TO DFHEIV0(25:11)
 15225     CALL 'kxdfhei1' USING DFHEIV0,
 15226           W-ARCH-FILE-ID,
 15227           DFHEIV20,
 15228           DFHEIV99,
 15229           W-ARCH-PARTIAL-KEY,
 15230           DFHEIV99,
 15231           DFHEIV99,
 15232           DFHEIV99
 15233     SET ADDRESS OF LETTER-ARCHIVE TO
 15234         DFHEIV20
 15235     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15236
 15237
 15238     MOVE W-SAVE-BIN-DATE        TO LA-INITIAL-PRINT-DATE.
 15239
 15240     IF  LA-RESEND-DATE = LOW-VALUES
 15241         MOVE 'C'                TO LA-STATUS.
 15242
 15243
 15244* EXEC CICS REWRITE
 15245*         FROM      (LETTER-ARCHIVE)
 15246*         DATASET   (W-ARCH-FILE-ID)
 15247*    END-EXEC.
 15248     MOVE LENGTH OF
 15249      LETTER-ARCHIVE
 15250       TO DFHEIV11
 15251*    MOVE '&& L                  %   #00014112' TO DFHEIV0
 15252     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15253     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15254     MOVE X'2020233030303134313132' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 327
* EL689.cbl
 15255     CALL 'kxdfhei1' USING DFHEIV0,
 15256           W-ARCH-FILE-ID,
 15257           LETTER-ARCHIVE,
 15258           DFHEIV11,
 15259           DFHEIV99
 15260     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15261
 15262
 15263 7920-EXIT.
 15264     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 328
* EL689.cbl
 15266 7935-TERM-ERROR.
 15267
 15268     MOVE ER-0412                TO EMI-ERROR.
 15269     MOVE SPACES                 TO PI-689-PRINT-SW.
 15270     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15271     MOVE -1                     TO MAINTL.
 15272     GO TO 8200-SEND-DATAONLY.
 15273
 15274 7940-TRAN-ERROR.
 15275
 15276     MOVE ER-0413                TO EMI-ERROR.
 15277     MOVE SPACES                 TO PI-689-PRINT-SW.
 15278     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15279     MOVE -1                     TO MAINTL.
 15280     GO TO 8200-SEND-DATAONLY.
 15281
 15282 7945-NOT-FOUND.
 15283
 15284     MOVE ER-0190                TO EMI-ERROR.
 15285     MOVE -1                     TO MAINTL.
 15286     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15287     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 329
* EL689.cbl
 15289 8010-ARCH-NOT-OPEN.
 15290
 15291     MOVE ER-7388                TO EMI-ERROR.
 15292     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15293     MOVE -1                     TO MAINTL.
 15294     GO TO 8200-SEND-DATAONLY.
 15295
 15296 8015-ARCT-NOT-OPEN.
 15297
 15298     MOVE ER-7373                TO EMI-ERROR.
 15299     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15300     MOVE -1                     TO MAINTL.
 15301     GO TO 8200-SEND-DATAONLY.
 15302
 15303 8020-ACCT-NOT-OPEN.
 15304
 15305     MOVE ER-0168 TO EMI-ERROR
 15306     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15307     MOVE -1                     TO MAINTL.
 15308     GO TO 8200-SEND-DATAONLY.
 15309
 15310 8030-CERT-NOT-OPEN.
 15311
 15312     MOVE ER-0169 TO EMI-ERROR.
 15313     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15314     MOVE -1                     TO MAINTL.
 15315     GO TO 8200-SEND-DATAONLY.
 15316
 15317 8035-CERT-NOT-FOUND.
 15318
 15319     MOVE ER-2369 TO EMI-ERROR.
 15320     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15321     MOVE -1                     TO MAINTL.
 15322     GO TO 8200-SEND-DATAONLY.
 15323
 15324 8040-CNTL-NOT-OPEN.
 15325
 15326     MOVE ER-0042                TO EMI-ERROR.
 15327     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15328     MOVE -1                     TO MAINTL.
 15329     GO TO 8200-SEND-DATAONLY.
 15330
 15331 8045-CHEK-NOT-OPEN.
 15332
 15333     MOVE ER-3775                TO EMI-ERROR.
 15334     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15335     MOVE -1                     TO MAINTL.
 15336     GO TO 8200-SEND-DATAONLY.
 15337
 15338 8050-TEXT-NOT-OPEN.
 15339
 15340     MOVE ER-0013                TO EMI-ERROR.
 15341     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15342     MOVE -1                     TO MAINTL.
 15343     GO TO 8200-SEND-DATAONLY.
 15344
 15345 8060-PNDB-NOT-OPEN.
 15346
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 330
* EL689.cbl
 15347     MOVE ER-2216 TO EMI-ERROR.
 15348     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15349     MOVE -1                     TO MAINTL.
 15350     GO TO 8200-SEND-DATAONLY.
 15351
 15352 8070-PNDB-NOT-FOUND.
 15353
 15354     MOVE ER-7374 TO EMI-ERROR.
 15355     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15356     MOVE -1                     TO MAINTL.
 15357     GO TO 8200-SEND-DATAONLY.
 15358
 15359 8080-COMP-NOT-OPEN.
 15360
 15361     MOVE ER-2055 TO EMI-ERROR
 15362     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15363     MOVE -1                     TO MAINTL.
 15364     GO TO 8200-SEND-DATAONLY.
 15365
 15366 8085-PYAJ-NOT-OPEN.
 15367
 15368     MOVE ER-2232 TO EMI-ERROR
 15369     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15370     MOVE -1                     TO MAINTL.
 15371     GO TO 8200-SEND-DATAONLY.
 15372
 15373 8090-MAIL-NOT-OPEN.
 15374
 15375     MOVE ER-2999                TO EMI-ERROR.
 15376     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15377     MOVE -1                     TO MAINTL.
 15378     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 331
* EL689.cbl
 15380 8100-SEND-INITIAL-MAP.
 15381
 15382     PERFORM 7760-PUT-TEMP-STORAGE THRU 7760-EXIT
 15383     IF  PI-689-CREATE-NO-SCREENS
 15384         MOVE '9999'             TO PI-689-ERROR
 15385         GO TO 0620-RETURN-TO-CALLER.
 15386
 15387     PERFORM 9600-FORMAT-DATE-TIME THRU 9600-EXIT.
 15388
 15389     IF  NOT EMI-NO-ERRORS
 15390         MOVE EMI-MESSAGE-AREA (1)
 15391                                 TO ERRMSGO
 15392     ELSE
 15393         MOVE SPACES             TO ERRMSGO.
 15394     IF PI-PROCESSOR-ID = 'LMLC' OR 'SPJA' OR 'KAWA' OR 'CAGB'
 15395        OR 'DLVA' OR 'ECCA' OR 'KRHA'
 15396        MOVE AL-SADOF            TO PF8HDA
 15397     END-IF
 15398     IF NOT PI-CREATE-LABELS
 15399         MOVE AL-PANON           TO ADDRLBLA.
 15400
 15401
 15402* EXEC CICS SEND
 15403*        MAP    (W-MAP)
 15404*        MAPSET (W-MAPSET)
 15405*        FROM   (EL689AO)
 15406*        ERASE
 15407*        CURSOR
 15408*    END-EXEC.
 15409     MOVE LENGTH OF
 15410      EL689AO
 15411       TO DFHEIV12
 15412     MOVE -1
 15413       TO DFHEIV11
 15414*    MOVE '8$     CT  E    H L F ,   #00014255' TO DFHEIV0
 15415     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 15416     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 15417     MOVE X'2020233030303134323535' TO DFHEIV0(25:11)
 15418     CALL 'kxdfhei1' USING DFHEIV0,
 15419           W-MAP,
 15420           EL689AO,
 15421           DFHEIV12,
 15422           W-MAPSET,
 15423           DFHEIV99,
 15424           DFHEIV99,
 15425           DFHEIV99,
 15426           DFHEIV11,
 15427           DFHEIV99,
 15428           DFHEIV99,
 15429           DFHEIV99
 15430     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15431
 15432
 15433     GO TO 9000-RETURN-TRANS.
 15434
 15435 8100-EXIT.
 15436     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 332
* EL689.cbl
 15438 8200-SEND-DATAONLY.
 15439
 15440     PERFORM 7760-PUT-TEMP-STORAGE THRU 7760-EXIT.
 15441     IF  PI-689-CREATE-NO-SCREENS
 15442         MOVE '9999'             TO PI-689-ERROR
 15443         GO TO 0620-RETURN-TO-CALLER.
 15444
 15445     PERFORM 9600-FORMAT-DATE-TIME THRU 9600-EXIT.
 15446
 15447     IF  NOT EMI-NO-ERRORS
 15448         MOVE EMI-MESSAGE-AREA (1)
 15449                                 TO ERRMSGO
 15450     ELSE
 15451         MOVE SPACES             TO ERRMSGO.
 15452
 15453
 15454* EXEC CICS SEND
 15455*        MAP    (W-MAP)
 15456*        MAPSET (W-MAPSET)
 15457*        FROM   (EL689AO)
 15458*        DATAONLY
 15459*        CURSOR
 15460*    END-EXEC.
 15461     MOVE LENGTH OF
 15462      EL689AO
 15463       TO DFHEIV12
 15464     MOVE -1
 15465       TO DFHEIV11
 15466*    MOVE '8$D    CT       H L F ,   #00014283' TO DFHEIV0
 15467     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 15468     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 15469     MOVE X'2020233030303134323833' TO DFHEIV0(25:11)
 15470     CALL 'kxdfhei1' USING DFHEIV0,
 15471           W-MAP,
 15472           EL689AO,
 15473           DFHEIV12,
 15474           W-MAPSET,
 15475           DFHEIV99,
 15476           DFHEIV99,
 15477           DFHEIV99,
 15478           DFHEIV11,
 15479           DFHEIV99,
 15480           DFHEIV99,
 15481           DFHEIV99
 15482     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15483
 15484
 15485     GO TO 9000-RETURN-TRANS.
 15486
 15487 8200-EXIT.
 15488     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 333
* EL689.cbl
 15490 8300-SEND-TEXT.
 15491
 15492     IF  PI-689-CREATE-NO-SCREENS
 15493         MOVE '9999'             TO PI-689-ERROR
 15494         GO TO 0620-RETURN-TO-CALLER.
 15495
 15496
 15497* EXEC CICS SEND TEXT
 15498*        FROM    (LOGOFF-TEXT)
 15499*        LENGTH  (LOGOFF-LENGTH)
 15500*        ERASE
 15501*        FREEKB
 15502*    END-EXEC.
 15503*    MOVE '8&      T  E F  H   F -   #00014302' TO DFHEIV0
 15504     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 15505     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 15506     MOVE X'2020233030303134333032' TO DFHEIV0(25:11)
 15507     CALL 'kxdfhei1' USING DFHEIV0,
 15508           LOGOFF-TEXT,
 15509           LOGOFF-LENGTH,
 15510           DFHEIV99,
 15511           DFHEIV99,
 15512           DFHEIV99,
 15513           DFHEIV99,
 15514           DFHEIV99,
 15515           DFHEIV99,
 15516           DFHEIV99,
 15517           DFHEIV99,
 15518           DFHEIV99,
 15519           DFHEIV99
 15520     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15521
 15522
 15523     GO TO 9000-RETURN-TRANS.
 15524
 15525 8300-EXIT.
 15526     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 334
* EL689.cbl
 15528 8350-SEND-DATAONLY-ERASEAUP.
 15529
 15530     MOVE EIBTRMID               TO W-TS-TERM-TEXT
 15531     PERFORM 7760-PUT-TEMP-STORAGE
 15532                                 THRU 7760-EXIT
 15533     IF  PI-689-CREATE-NO-SCREENS
 15534         MOVE '9999'             TO PI-689-ERROR
 15535         GO TO 0620-RETURN-TO-CALLER.
 15536
 15537     PERFORM 9600-FORMAT-DATE-TIME THRU 9600-EXIT.
 15538
 15539     IF  NOT EMI-NO-ERRORS
 15540         MOVE EMI-MESSAGE-AREA (1)
 15541                                 TO ERRMSGO
 15542     ELSE
 15543         MOVE SPACES             TO ERRMSGO.
 15544
 15545
 15546* EXEC CICS SEND
 15547*        MAP      (W-MAP)
 15548*        MAPSET   (W-MAPSET)
 15549*        FROM     (EL689AO)
 15550*        DATAONLY
 15551*        ERASEAUP
 15552*        CURSOR
 15553*    END-EXEC.
 15554     MOVE LENGTH OF
 15555      EL689AO
 15556       TO DFHEIV12
 15557     MOVE -1
 15558       TO DFHEIV11
 15559*    MOVE '8$D    CT  A    H L F ,   #00014331' TO DFHEIV0
 15560     MOVE X'382444202020204354202041' TO DFHEIV0(1:12)
 15561     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 15562     MOVE X'2020233030303134333331' TO DFHEIV0(25:11)
 15563     CALL 'kxdfhei1' USING DFHEIV0,
 15564           W-MAP,
 15565           EL689AO,
 15566           DFHEIV12,
 15567           W-MAPSET,
 15568           DFHEIV99,
 15569           DFHEIV99,
 15570           DFHEIV99,
 15571           DFHEIV11,
 15572           DFHEIV99,
 15573           DFHEIV99,
 15574           DFHEIV99
 15575     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15576
 15577
 15578     GO TO 9000-RETURN-TRANS.
 15579
 15580 8350-EXIT.
 15581     EXIT.
 15582
 15583 8600-DEEDIT.
 15584
 15585
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 335
* EL689.cbl
 15586* EXEC CICS BIF DEEDIT
 15587*         FIELD    (W-DEEDIT-FIELD)
 15588*         LENGTH   (15)
 15589*    END-EXEC.
 15590     MOVE 15
 15591       TO DFHEIV11
 15592*    MOVE '@"L                   #   #00014347' TO DFHEIV0
 15593     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 15594     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 15595     MOVE X'2020233030303134333437' TO DFHEIV0(25:11)
 15596     CALL 'kxdfhei1' USING DFHEIV0,
 15597           W-DEEDIT-FIELD,
 15598           DFHEIV11
 15599     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15600
 15601
 15602 8600-EXIT.
 15603     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 336
* EL689.cbl
 15605 9000-RETURN-TRANS.
 15606
 15607     MOVE EMI-FATAL-CTR      TO PI-689-FATAL-CTR
 15608     MOVE EMI-FORCABLE-CTR   TO PI-689-FORCABLE-CTR
 15609     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO
 15610     MOVE W-MAP-NUM              TO PI-CURRENT-SCREEN-NO
 15611
 15612* EXEC CICS RETURN
 15613*        TRANSID    (W-TRANSACTION)
 15614*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 15615*        LENGTH     (PI-COMM-LENGTH)
 15616*    END-EXEC.
 15617*    MOVE '.(CT                  &   #00014361' TO DFHEIV0
 15618     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 15619     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 15620     MOVE X'2020233030303134333631' TO DFHEIV0(25:11)
 15621     CALL 'kxdfhei1' USING DFHEIV0,
 15622           W-TRANSACTION,
 15623           PROGRAM-INTERFACE-BLOCK,
 15624           PI-COMM-LENGTH,
 15625           DFHEIV99,
 15626           DFHEIV99
 15627     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15628
 15629*    MOVE W-MAP-NUM              TO PI-CURRENT-SCREEN-NO.
 15630*    MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 15631*    GO TO 0200-RECEIVE.
 15632
 15633 9000-EXIT.
 15634     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 337
* EL689.cbl
 15636 9200-PA.
 15637
 15638     MOVE ER-0008                TO EMI-ERROR.
 15639     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15640     MOVE -1                     TO MAINTL.
 15641     GO TO 8200-SEND-DATAONLY.
 15642
 15643 9200-EXIT.
 15644     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 338
* EL689.cbl
 15646 9300-DFHCLEAR.
 15647
 15648     IF PI-RETURN-TO-PROGRAM = 'EL689' OR 'EL690'
 15649         MOVE '2'                TO PI-ACTION.
 15650
 15651     IF  PI-CLEAR-MODE
 15652         MOVE PI-RETURN-TO-PROGRAM
 15653                                 TO W-CALL-PGM
 15654         PERFORM 7780-DELETE-TEMP-STOR-TEXT THRU 7780-EXIT
 15655         GO TO 9400-XCTL
 15656     ELSE
 15657         PERFORM 7780-DELETE-TEMP-STOR-TEXT THRU 7780-EXIT
 15658         MOVE LOW-VALUES         TO EL689AO
 15659                                    PI-1042-WA
 15660                                    PI-689-WORK-AREA
 15661         MOVE ZEROS              TO PI-CURRENT-LINE
 15662                                    PI-TEMP-STOR-ITEMS
 15663                                    PI-TOTAL-LINES
 15664                                    PI-UPDATE-SW
 15665                                    PI-689-NUMBER-LABEL-LINES
 15666         MOVE SPACES             TO PI-689-PRINT-SW
 15667                                    PI-689-ALT-PRINTER-ID
 15668                                    PI-COMM-CONTROL
 15669                                    PI-689-FORM-NUMBER
 15670                                    PI-689-TEMP-STOR-ID
 15671                                    PI-689-LABEL-SOURCE
 15672                                    PI-689-USE-SCREEN-IND
 15673         MOVE '2'                TO PI-ACTION
 15674         MOVE -1                 TO MAINTL
 15675         GO TO 8100-SEND-INITIAL-MAP.
 15676
 15677 9300-EXIT.
 15678     EXIT.
 15679
 15680 9400-XCTL.
 15681
 15682
 15683* EXEC CICS XCTL
 15684*        PROGRAM  (W-CALL-PGM)
 15685*        COMMAREA (PROGRAM-INTERFACE-BLOCK)
 15686*        LENGTH   (PI-COMM-LENGTH)
 15687*    END-EXEC.
 15688*    MOVE '.$C                   $   #00014419' TO DFHEIV0
 15689     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 15690     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15691     MOVE X'2020233030303134343139' TO DFHEIV0(25:11)
 15692     CALL 'kxdfhei1' USING DFHEIV0,
 15693           W-CALL-PGM,
 15694           PROGRAM-INTERFACE-BLOCK,
 15695           PI-COMM-LENGTH
 15696     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15697
 15698
 15699 9400-EXIT.
 15700     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 339
* EL689.cbl
 15702 9500-LINK-DATE-CONVERT.
 15703
 15704     IF  DC-BIN-DATE-1 EQUAL HIGH-VALUES
 15705             AND
 15706         DC-OPTION-CODE EQUAL ' '
 15707         MOVE '99/99/99'         TO DC-GREG-DATE-1-EDIT
 15708         GO TO 9500-EXIT.
 15709
 15710
 15711* EXEC CICS LINK
 15712*        PROGRAM    ('ELDATCV')
 15713*        COMMAREA   (DATE-CONVERSION-DATA)
 15714*        LENGTH     (DC-COMM-LENGTH)
 15715*    END-EXEC.
 15716     MOVE 'ELDATCV' TO DFHEIV1
 15717*    MOVE '."C                   ''   #00014436' TO DFHEIV0
 15718     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 15719     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15720     MOVE X'2020233030303134343336' TO DFHEIV0(25:11)
 15721     CALL 'kxdfhei1' USING DFHEIV0,
 15722           DFHEIV1,
 15723           DATE-CONVERSION-DATA,
 15724           DC-COMM-LENGTH,
 15725           DFHEIV99,
 15726           DFHEIV99,
 15727           DFHEIV99
 15728     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15729
 15730
 15731     IF  NO-CONVERSION-ERROR
 15732             AND
 15733         PI-COMPANY-ID EQUAL 'AUK'
 15734             AND
 15735         W-REVERSE-DATE
 15736         MOVE DC-GREG-DATE-1-EDIT
 15737                                 TO W-EDIT-DATE-1
 15738         MOVE W-ED1-MM           TO W-ED2-MM
 15739         MOVE W-ED1-DD           TO W-ED2-DD
 15740         MOVE W-ED1-YY           TO W-ED2-YY
 15741         MOVE W-EDIT-DATE-2      TO DC-GREG-DATE-1-EDIT.
 15742
 15743 9500-EXIT.
 15744     EXIT.
 15745
 15746 9600-FORMAT-DATE-TIME.
 15747
 15748     MOVE W-SAVE-DATE            TO RUNDTEO.
 15749     MOVE EIBTIME                TO W-TIME-IN.
 15750     MOVE W-TIME-OUT             TO RUNTIMEO.
 15751     MOVE PI-COMPANY-ID          TO COMPANYO.
 15752     MOVE PI-PROCESSOR-ID        TO USERIDO.
 15753     MOVE W-MAP-NUM              TO PI-CURRENT-SCREEN-NO.
 15754
 15755 9600-EXIT.
 15756     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 340
* EL689.cbl
 15758 9700-PGMID-ERROR.
 15759
 15760     IF  PI-689-CREATE-NO-SCREENS
 15761         MOVE '9999'             TO PI-689-ERROR
 15762         GO TO 0620-RETURN-TO-CALLER.
 15763
 15764
 15765* EXEC CICS  HANDLE CONDITION
 15766*        PGMIDERR  (8300-SEND-TEXT)
 15767*    END-EXEC.
 15768*    MOVE '"$L                   ! C #00014475' TO DFHEIV0
 15769     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 15770     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15771     MOVE X'4320233030303134343735' TO DFHEIV0(25:11)
 15772     CALL 'kxdfhei1' USING DFHEIV0
 15773     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15774
 15775
 15776     MOVE W-THIS-PGM             TO PI-CALLING-PROGRAM.
 15777     MOVE ' '                    TO PI-ENTRY-CD-1.
 15778     MOVE W-XCTL-005             TO W-CALL-PGM
 15779                                    LOGOFF-PGM.
 15780     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
 15781
 15782     PERFORM 9400-XCTL THRU 9400-EXIT.
 15783
 15784 9700-EXIT.
 15785     EXIT.
 15786
 15787 9800-ABEND.
 15788
 15789     IF  PI-689-CREATE-NO-SCREENS
 15790         MOVE '9999'             TO PI-689-ERROR
 15791         GO TO 0620-RETURN-TO-CALLER.
 15792
 15793     MOVE W-LINK-004             TO W-CALL-PGM.
 15794     MOVE DFHEIBLK               TO EMI-LINE1
 15795
 15796
 15797* EXEC CICS  LINK
 15798*        PROGRAM   (W-CALL-PGM)
 15799*        COMMAREA  (EMI-LINE1)
 15800*        LENGTH    (72)
 15801*    END-EXEC.
 15802     MOVE 72
 15803       TO DFHEIV11
 15804*    MOVE '."C                   ''   #00014499' TO DFHEIV0
 15805     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 15806     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15807     MOVE X'2020233030303134343939' TO DFHEIV0(25:11)
 15808     CALL 'kxdfhei1' USING DFHEIV0,
 15809           W-CALL-PGM,
 15810           EMI-LINE1,
 15811           DFHEIV11,
 15812           DFHEIV99,
 15813           DFHEIV99,
 15814           DFHEIV99
 15815     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 341
* EL689.cbl
 15816
 15817
 15818     GO TO 8200-SEND-DATAONLY.
 15819
 15820 9800-EXIT.
 15821     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 342
* EL689.cbl
 15823 9900-ERROR-FORMAT.
 15824
 15825     IF  PI-689-CREATE-NO-SCREENS
 15826         MOVE EMI-ERROR          TO PI-689-ERROR
 15827         IF  PI-689-FATAL-ERROR
 15828             GO TO 0620-RETURN-TO-CALLER
 15829         ELSE
 15830             GO TO 9900-EXIT.
 15831
 15832     IF  EMI-ERROR EQUAL ER-9097
 15833         NEXT SENTENCE
 15834     ELSE
 15835         IF  EMI-ERRORS-COMPLETE
 15836                 OR
 15837             EMI-ERROR EQUAL W-LAST-ERROR
 15838             GO TO 9900-EXIT.
 15839
 15840     MOVE W-LINK-001             TO W-CALL-PGM.
 15841
 15842
 15843* EXEC CICS LINK
 15844*        PROGRAM    (W-CALL-PGM)
 15845*        COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 15846*        LENGTH     (EMI-COMM-LENGTH)
 15847*    END-EXEC.
 15848*    MOVE '."C                   ''   #00014529' TO DFHEIV0
 15849     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 15850     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15851     MOVE X'2020233030303134353239' TO DFHEIV0(25:11)
 15852     CALL 'kxdfhei1' USING DFHEIV0,
 15853           W-CALL-PGM,
 15854           ERROR-MESSAGE-INTERFACE-BLOCK,
 15855           EMI-COMM-LENGTH,
 15856           DFHEIV99,
 15857           DFHEIV99,
 15858           DFHEIV99
 15859     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15860
 15861
 15862     IF  EMI-SEVERITY (2) EQUAL 'X'
 15863             AND
 15864         EMI-SEVERITY (1) NOT EQUAL 'X'
 15865         MOVE EMI-MESSAGE-AREA (2)
 15866                                 TO EMI-MESSAGE-AREA (1).
 15867
 15868     MOVE EMI-ERROR              TO W-LAST-ERROR.
 15869
 15870 9900-EXIT.
 15871     EXIT.
 15872
 15873 9905-INITIALIZE-SECURITY.
 15874******************************************************************
 15875*                                                                *
 15876*       THIS LOGIC SETS UP AND READS THE TEMPORARY STORAGE       *
 15877*       USER SECURITY RECORD SET UP BY EL125.  BASED ON THE      *
 15878*       APPLICATION NUMBER FOUND IN WORKING STORAGE UNDER        *
 15879*       W-APPL-SECRTY-NDX (PIC  S9(04) COMP), THIS PROGRAM       *
 15880*       MOVES THE APPROPRIATE APPLICATION AUTHORIZATION INTO     *
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 343
* EL689.cbl
 15881*       PI-DISPLAY-CAP AND PI-MODIFY-CAP.  IT THEN CHECKS FOR    *
 15882*       BROWSE AUTHORITY AND IF NOT AUTHORIZED WILL SET AN       *
 15883*       ERROR CONDITION AND EXIT THE PROGRAM.                    *
 15884*                                                                *
 15885*       NOTE:  THE CARRIER/GRP/STATE/ACCOUNT SECURITY DATA       *
 15886*       IS ALSO PROVIDED BY THIS LOGIC.                          *
 15887*                                                                *
 15888******************************************************************
 15889
 15890     IF  PI-PROCESSOR-ID EQUAL 'LGXX'
 15891         MOVE 'Y'                TO PI-DISPLAY-CAP
 15892                                    PI-MODIFY-CAP
 15893     ELSE
 15894
 15895* EXEC CICS READQ TS
 15896*            QUEUE  (PI-SECURITY-TEMP-STORE-ID)
 15897*            INTO   (SECURITY-CONTROL)
 15898*            LENGTH (SC-COMM-LENGTH)
 15899*            ITEM   (1)
 15900*        END-EXEC
 15901     MOVE 1
 15902       TO DFHEIV11
 15903*    MOVE '*$II   L              ''   #00014567' TO DFHEIV0
 15904     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
 15905     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15906     MOVE X'2020233030303134353637' TO DFHEIV0(25:11)
 15907     CALL 'kxdfhei1' USING DFHEIV0,
 15908           PI-SECURITY-TEMP-STORE-ID,
 15909           SECURITY-CONTROL,
 15910           SC-COMM-LENGTH,
 15911           DFHEIV11,
 15912           DFHEIV99,
 15913           DFHEIV99
 15914     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15915         MOVE SC-CREDIT-DISPLAY (W-APPL-SCRTY-NDX)
 15916                                 TO PI-DISPLAY-CAP
 15917         MOVE SC-CREDIT-UPDATE (W-APPL-SCRTY-NDX)
 15918                                 TO PI-MODIFY-CAP.
 15919
 15920 9905-EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 344
* EL689.cbl
 15922 9995-SECURITY-VIOLATION.
 15923
 15924     MOVE EIBDATE                TO SM-JUL-DATE.
 15925     MOVE EIBTRMID               TO SM-TERMID.
 15926     MOVE W-THIS-PGM             TO SM-PGM.
 15927     MOVE EIBTIME                TO W-TIME-IN.
 15928     MOVE W-TIME-OUT             TO SM-TIME.
 15929     MOVE PI-PROCESSOR-ID        TO SM-PROCESSOR-ID.
 15930
 15931
 15932* EXEC CICS LINK
 15933*         PROGRAM  ('EL003')
 15934*         COMMAREA (SECURITY-MESSAGE)
 15935*         LENGTH   (80)
 15936*    END-EXEC.
 15937     MOVE 'EL003' TO DFHEIV1
 15938     MOVE 80
 15939       TO DFHEIV11
 15940*    MOVE '."C                   ''   #00014589' TO DFHEIV0
 15941     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 15942     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15943     MOVE X'2020233030303134353839' TO DFHEIV0(25:11)
 15944     CALL 'kxdfhei1' USING DFHEIV0,
 15945           DFHEIV1,
 15946           SECURITY-MESSAGE,
 15947           DFHEIV11,
 15948           DFHEIV99,
 15949           DFHEIV99,
 15950           DFHEIV99
 15951     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15952
 15953
 15954 9995-EXIT.
 15955     EXIT.
 15956
 15957 9999-GOBACK.
 15958
 15959
 15960* GOBACK.
 15961     MOVE '9%                    "   ' TO DFHEIV0
 15962     MOVE 'EL689' TO DFHEIV1
 15963     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 15964     GOBACK.
 15965
 15966 9999-EXIT.
 15967     EXIT.
 15968
 15969 9999-DFHBACK SECTION.
 15970     MOVE '9%                    "   ' TO DFHEIV0
 15971     MOVE 'EL689' TO DFHEIV1
 15972     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 15973     GOBACK.
 15974 9999-DFHEXIT.
 15975     IF DFHEIGDJ EQUAL 0001
 15976         NEXT SENTENCE
 15977     ELSE IF DFHEIGDJ EQUAL 2
 15978         GO TO 9300-DFHCLEAR,
 15979               9200-PA,
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 345
* EL689.cbl
 15980               9200-PA,
 15981               9200-PA
 15982         DEPENDING ON DFHEIGDI
 15983     ELSE IF DFHEIGDJ EQUAL 3
 15984         GO TO 9700-PGMID-ERROR,
 15985               9800-ABEND,
 15986               0325-MAPFAIL
 15987         DEPENDING ON DFHEIGDI
 15988     ELSE IF DFHEIGDJ EQUAL 4
 15989         GO TO 8040-CNTL-NOT-OPEN,
 15990               7945-NOT-FOUND
 15991         DEPENDING ON DFHEIGDI
 15992     ELSE IF DFHEIGDJ EQUAL 5
 15993         GO TO 9700-PGMID-ERROR,
 15994               0325-MAPFAIL,
 15995               9800-ABEND
 15996         DEPENDING ON DFHEIGDI
 15997     ELSE IF DFHEIGDJ EQUAL 6
 15998         GO TO 0990-CARRIER-NOT-FOUND,
 15999               8040-CNTL-NOT-OPEN
 16000         DEPENDING ON DFHEIGDI
 16001     ELSE IF DFHEIGDJ EQUAL 7
 16002         GO TO 0994-STATE-NOT-FOUND,
 16003               8040-CNTL-NOT-OPEN
 16004         DEPENDING ON DFHEIGDI
 16005     ELSE IF DFHEIGDJ EQUAL 8
 16006         GO TO 8010-ARCH-NOT-OPEN,
 16007               1070-ARCH-NOT-FOUND,
 16008               1070-ARCH-NOT-FOUND
 16009         DEPENDING ON DFHEIGDI
 16010     ELSE IF DFHEIGDJ EQUAL 9
 16011         GO TO 8015-ARCT-NOT-OPEN,
 16012               1020-ARCT-ENDBR,
 16013               1020-ARCT-ENDBR
 16014         DEPENDING ON DFHEIGDI
 16015     ELSE IF DFHEIGDJ EQUAL 10
 16016         GO TO 2001-NOT-FOUND,
 16017               2001-NOT-FOUND,
 16018               8050-TEXT-NOT-OPEN
 16019         DEPENDING ON DFHEIGDI
 16020     ELSE IF DFHEIGDJ EQUAL 11
 16021         GO TO 2000-ENDBR
 16022         DEPENDING ON DFHEIGDI
 16023     ELSE IF DFHEIGDJ EQUAL 12
 16024         GO TO 8040-CNTL-NOT-OPEN,
 16025               5470-CNTL-NOT-FOUND
 16026         DEPENDING ON DFHEIGDI
 16027     ELSE IF DFHEIGDJ EQUAL 13
 16028         GO TO 8010-ARCH-NOT-OPEN
 16029         DEPENDING ON DFHEIGDI
 16030     ELSE IF DFHEIGDJ EQUAL 14
 16031         GO TO 5460-DUPLICATE-ARCHIVE-RCD
 16032         DEPENDING ON DFHEIGDI
 16033     ELSE IF DFHEIGDJ EQUAL 15
 16034         GO TO 8015-ARCT-NOT-OPEN,
 16035               5465-DUPLICATE-ARCH-TEXT
 16036         DEPENDING ON DFHEIGDI
 16037     ELSE IF DFHEIGDJ EQUAL 16
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 346
* EL689.cbl
 16038         GO TO 8040-CNTL-NOT-OPEN,
 16039               6200-CNTL1-NOT-FOUND
 16040         DEPENDING ON DFHEIGDI
 16041     ELSE IF DFHEIGDJ EQUAL 17
 16042         GO TO 8040-CNTL-NOT-OPEN,
 16043               6250-CNTL2-NOT-FOUND
 16044         DEPENDING ON DFHEIGDI
 16045     ELSE IF DFHEIGDJ EQUAL 18
 16046         GO TO 8040-CNTL-NOT-OPEN,
 16047               6300-CNTL6-NOT-FOUND
 16048         DEPENDING ON DFHEIGDI
 16049     ELSE IF DFHEIGDJ EQUAL 19
 16050         GO TO 8040-CNTL-NOT-OPEN,
 16051               6350-CNTL2-NOT-FOUND
 16052         DEPENDING ON DFHEIGDI
 16053     ELSE IF DFHEIGDJ EQUAL 20
 16054         GO TO 8060-PNDB-NOT-OPEN,
 16055               8070-PNDB-NOT-FOUND
 16056         DEPENDING ON DFHEIGDI
 16057     ELSE IF DFHEIGDJ EQUAL 21
 16058         GO TO 8030-CERT-NOT-OPEN,
 16059               8035-CERT-NOT-FOUND
 16060         DEPENDING ON DFHEIGDI
 16061     ELSE IF DFHEIGDJ EQUAL 22
 16062         GO TO 8020-ACCT-NOT-OPEN,
 16063               6500-ACCT-NOT-FOUND,
 16064               6500-ONLY-STOP
 16065         DEPENDING ON DFHEIGDI
 16066     ELSE IF DFHEIGDJ EQUAL 23
 16067         GO TO 8080-COMP-NOT-OPEN,
 16068               6600-COMP-NOT-FOUND
 16069         DEPENDING ON DFHEIGDI
 16070     ELSE IF DFHEIGDJ EQUAL 24
 16071         GO TO 8040-CNTL-NOT-OPEN,
 16072               6630-CNTL2-NOT-FOUND
 16073         DEPENDING ON DFHEIGDI
 16074     ELSE IF DFHEIGDJ EQUAL 25
 16075         GO TO 8090-MAIL-NOT-OPEN,
 16076               6700-MAIL-NOT-FOUND
 16077         DEPENDING ON DFHEIGDI
 16078     ELSE IF DFHEIGDJ EQUAL 26
 16079         GO TO 8040-CNTL-NOT-OPEN,
 16080               6750-EXIT
 16081         DEPENDING ON DFHEIGDI
 16082     ELSE IF DFHEIGDJ EQUAL 27
 16083         GO TO 8040-CNTL-NOT-OPEN,
 16084               6800-EXIT
 16085         DEPENDING ON DFHEIGDI
 16086     ELSE IF DFHEIGDJ EQUAL 28
 16087         GO TO 8045-CHEK-NOT-OPEN,
 16088               6850-CHEK-NOT-FOUND
 16089         DEPENDING ON DFHEIGDI
 16090     ELSE IF DFHEIGDJ EQUAL 29
 16091         GO TO 8085-PYAJ-NOT-OPEN,
 16092               6900-PYAJ-NOT-FOUND
 16093         DEPENDING ON DFHEIGDI
 16094     ELSE IF DFHEIGDJ EQUAL 30
 16095         GO TO 7700-TS-ERROR,
* Micro Focus Server Express         V5.1 revision 000 14-Jun-11 14:02 Page 347
* EL689.cbl
 16096               7700-TS-ERROR
 16097         DEPENDING ON DFHEIGDI
 16098     ELSE IF DFHEIGDJ EQUAL 31
 16099         GO TO 7780-EXIT
 16100         DEPENDING ON DFHEIGDI
 16101     ELSE IF DFHEIGDJ EQUAL 32
 16102         GO TO 8040-CNTL-NOT-OPEN,
 16103               7945-NOT-FOUND
 16104         DEPENDING ON DFHEIGDI
 16105     ELSE IF DFHEIGDJ EQUAL 33
 16106         GO TO 7935-TERM-ERROR,
 16107               7940-TRAN-ERROR
 16108         DEPENDING ON DFHEIGDI
 16109     ELSE IF DFHEIGDJ EQUAL 34
 16110         GO TO 8010-ARCH-NOT-OPEN,
 16111               1070-ARCH-NOT-FOUND,
 16112               1070-ARCH-NOT-FOUND
 16113         DEPENDING ON DFHEIGDI
 16114     ELSE IF DFHEIGDJ EQUAL 35
 16115         GO TO 8300-SEND-TEXT
 16116         DEPENDING ON DFHEIGDI.
 16117     MOVE '9%                    "   ' TO DFHEIV0
 16118     MOVE 'EL689' TO DFHEIV1
 16119     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 16120     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) 1984-2009 Micro Focus (IP) Limited.      URN RXCTI/AA0/00000Q
*                                                        REF GNR-015065002AD
* Total Messages:     0
* Data:       91956     Code:       60525
