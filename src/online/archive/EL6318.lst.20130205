* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page   1
* EL6318.cbl
* Options: int("EL6318.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL6318.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL6318.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL6318.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.                 EL6318.
     3*
     4*AUTHOR.        PABLO
     5*               OMAHA, NEBRASKA
     6*DATE-COMPILED.
     7*SECURITY.   *****************************************************
     8*            *                                                   *
     9*            *   THIS PROGRAM IS THE PROPERTY OF CNETRAL STATES  *
    10*            *   HEALTH AND LIFE                                 *
    11*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    12*            *   OF CSO.        IS EXPRESSLY PROHIBITED WITHOUT  *
    13*            *   THE PRIOR WRITTEN PERMISSION OF CENTRAL STATES. *
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page   2
* EL6318.cbl
    14*            *                                                   *
    15*            *****************************************************
    16*-----------------------------------------------------------------
    17*                   C H A N G E   L O G
    18*
    19* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    20*-----------------------------------------------------------------
    21*  CHANGE  CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    22* EFFECTIVE    NUMBER
    23*-----------------------------------------------------------------
    24*          2011022800001  PEMA  NEW PROGRAM
    25* 012412   2011022800001  AJRA  NAPERSOFT
    26* 060612   2011022800001  AJRA  NAPERSOFT
    27* 062712   2011022800001  AJRA  REDEFINE ORIG DATA
    28* 072312   2011022800001  AJRA  NAPERSOFT MISC
    29* 102212   2012101700002  AJRA  SCREEN ID
    30* 103012   2012101700002  AJRA  ADD CERT NOTES TO TOP OF LIST
    31* 110612   2012101700002  AJRA  ADD NEW FIELDS
    32* 112612   2012101700002  AJRA  CHECK FOR PROMPT LETTER
    33* 121012   2012101700002  AJRA  HIGHLIGHT REASON CODES
    34* 121112   2012101700002  AJRA  CHANGE PF1, PF2 TO PF3, PF4
    35* 121212   2012101700002  AJRA  CHG LAST 2 CERT NOTES TO BILLING N
    36* 121712   2012101700002  AJRA  ADD DEFAULT AGE FLAG
    37* 122712   2012122700001  AJRA  FIX CERT PRINT FLAG
    38*-----------------------------------------------------------------
    39*REMARKS.
    40*        TRANSACTION - EXBE - GENERAL CHANGE ENDORSEMENT
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page   3
* EL6318.cbl
    42 ENVIRONMENT DIVISION.
    43 DATA DIVISION.
    44 WORKING-STORAGE SECTION.
    45 01  DFH-START PIC X(04).
    46 77  FILLER  PIC X(32)  VALUE '********************************'.
    47 77  FILLER  PIC X(32)  VALUE '*    EL6318 WORKING STORAGE    *'.
    48 77  FILLER  PIC X(32)  VALUE '******** VMOD=2.001 ************'.
    49 77  NOTE-SUB PIC S9(5) COMP-3 VALUE +0.
    50 77  WS-SEQ-NO                   PIC 9(4) BINARY.
    51 77  WS-SET-CODES-MDT            PIC X  VALUE SPACES.
    52 77  s1                          pic s999 comp-3 value +0.
    53 77  s2                          pic s999 comp-3 value +0.
    54 77  W-ARCH-NUMBER               PIC S9(08)      COMP value +0.
    55 77  WS-ERACCT-SW                PIC X  VALUE ' '.
    56     88  ACCT-FOUND                 VALUE 'Y'.
    57 77  WS-CHGBACK                 PIC 99  VALUE ZEROS.
    58 77  WS-CSO-PORTION              PIC S9(5)V99 COMP-3 VALUE +0.
    59 77  WS-ACCT-PORTION             PIC S9(5)V99 COMP-3 VALUE +0.
    60 77  WS-DIFF                     PIC 99 VALUE ZEROS.
    61 77  WS-SAVE-ERACCT-KEY          PIC X(20)  VALUE SPACES.
    62 77  WS-DUE-BORROWER             PIC S9(7)V99 COMP-3 VALUE +0.
    63 77  WS-REASON-SW                PIC X  VALUE ' '.
    64     88  REASONS-FOUND                  VALUE 'Y'.
    65     88  REASONS-NOT-FOUND              VALUE 'N'.
    66 77  WS-CERT-UPDATE-SW           PIC X  VALUE ' '.
    67     88  NO-CERT-RW                 VALUE 'N'.
    68     88  CERT-RW                    VALUE 'Y'.
    69 01  P pointer.
    70 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
    71 01  KIXHOST             pic x(9) value Z"HOSTNAME".
    72 01  var-ptr pointer.
    73 01  env-var-len                 pic 9(4)  binary.
    74 01  rc                          pic 9(9)  binary.
    75 01  WS-KIXHOST                  PIC X(10).
    76 01  WS-KIXSYS.
    77     05  WS-KIX-FIL1             PIC X(10).
    78     05  WS-KIX-APPS             PIC X(10).
    79     05  WS-KIX-ENV              PIC X(10).
    80     05  WS-KIX-MYENV            PIC X(10).
    81     05  WS-KIX-SYS              PIC X(10).
    82*                                COPY ELCSCTM.
    83******************************************************************
    84*                                                                *
    85*                                                                *
    86*                            ELCSCTM                             *
    87*                            VMOD=2.001                          *
    88*                                                                *
    89*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    90*                                                                *
    91******************************************************************
    92 01  SECURITY-MESSAGE.
    93     12  FILLER                          PIC X(30)
    94            VALUE '** LOGIC SECURITY VIOLATION -'.
    95     12  SM-READ                         PIC X(6).
    96     12  FILLER                          PIC X(5)
    97            VALUE ' PGM='.
    98     12  SM-PGM                          PIC X(6).
    99     12  FILLER                          PIC X(5)
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page   4
* EL6318.cbl
   100            VALUE ' OPR='.
   101     12  SM-PROCESSOR-ID                 PIC X(4).
   102     12  FILLER                          PIC X(6)
   103            VALUE ' TERM='.
   104     12  SM-TERMID                       PIC X(4).
   105     12  FILLER                          PIC XX   VALUE SPACE.
   106     12  SM-JUL-DATE                     PIC 9(5).
   107     12  FILLER                          PIC X    VALUE SPACE.
   108     12  SM-TIME                         PIC 99.99.
   109
   110*                                COPY ELCSCRTY.
   111******************************************************************
   112*                                                                *
   113*                                                                *
   114*                            ELCSCRTY                            *
   115*                            VMOD=2.001                          *
   116*                                                                *
   117*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   118*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   119*        SAVED IN PI-SECURITY-ADDRESS.                           *
   120*                                                                *
   121******************************************************************
   122 01  SECURITY-CONTROL.
   123     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   124     12  FILLER                       PIC XX    VALUE 'SC'.
   125     12  SC-CREDIT-CODES.
   126         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   127             20  SC-CREDIT-DISPLAY    PIC X.
   128             20  SC-CREDIT-UPDATE     PIC X.
   129     12  SC-CLAIMS-CODES.
   130         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   131             20  SC-CLAIMS-DISPLAY    PIC X.
   132             20  SC-CLAIMS-UPDATE     PIC X.
   133 01 srch-commarea.
   134*                                copy ELCADLTRSPI.
   135******************************************************************
   136*                   C H A N G E   L O G
   137*
   138* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   139*-----------------------------------------------------------------
   140*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   141* EFFECTIVE    NUMBER
   142*-----------------------------------------------------------------
   143* 060611    2011022800001  PEMA  NEW COPYBOOK
   144* 101812    2012101700002  AJRA  ADD ENDT ARCHIVE NO, SCREENID
   145* 110612    2012101700002  AJRA  EXPAND PASSED DATA
   146******************************************************************
   147****************************************
   148*  commarea for NaperSoft On Demand Admin services letters
   149*  (business logic input & output)
   150****************************************
   151     03  BL-INPUT.
   152         05  BL-DATA-SRCE        PIC X.
   153         05  BL-LETTER-ID        PIC XXXX.
   154         05  BL-CARRIER          PIC X.
   155         05  BL-GROUP            PIC X(6).
   156         05  BL-STATE            PIC XX.
   157         05  BL-ACCOUNT          PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page   5
* EL6318.cbl
   158         05  BL-EFF-DT           PIC X(10).
   159         05  BL-CERT-NO          PIC X(11).
   160         05  BL-BATCH-NO         PIC X(6).
   161         05  BL-BATCH-SEQ        PIC 9(8).
   162         05  BL-RESP-NO          PIC X(10).
   163         05  BL-NO-OF-COPIES     PIC 99.
   164         05  BL-PROC-ID          PIC XXXX.
   165         05  BL-COMP-ID          PIC XXX.
   166         05  BL-PRINT-NOW-SW     PIC X.
   167         05  BL-ENC-CD           PIC XXX.
   168         05  BL-RESEND-DT        PIC X(10).
   169         05  BL-FOLLOW-UP-DT     PIC X(10).
   170         05  BL-ARCHIVE-NO       PIC 9(8).
   171         05  BL-FUNC             PIC X(8).
   172         05  BL-COMMENTS         PIC X(100).
   173         05  FILLER REDEFINES BL-COMMENTS.
   174             10  BL-REASON-CODE OCCURS 12 PIC X(4).
   175             10  BL-LETTER-TO-ACCT PIC X.
   176             10  BL-LETTER-TO-BENE PIC X.
   177             10  BL-WRITE-ERARCH   PIC X.
   178                 88  ERARCH-QWS      VALUE 'Q'.
   179                 88  ERARCH-BATCH    VALUE 'B'.
   180                 88  ERARCH-TEMP     VALUE 'T'.
   181             10  BL-PROCESS-TYPE PIC X(07).
   182             10  BL-CERT-FORM-ID PIC X(05).
   183             10  BL-ENDT-ARCH-NO PIC 9(08) BINARY.
   184             10  BL-SOURCE-SCREEN PIC X(8).
   185             10  FILLER          PIC X(25).
   186     03  BL-OUTPUT.
   187         05  BL-STATUS                   PIC X.
   188             88  BL-OK                      VALUE "P".
   189             88  BL-FAIL                  VALUE "F".
   190         05  BL-MESSAGE          PIC X(50).
   191     03  BL-RECORD-PASSED-DATA   PIC X(6200).
   192     03  FILLER                  PIC X(31).
   193
   194*** Z CONTROL LAYOUT MOVED TO COPYBOOK ELCZREC
   195*                                COPY ELCZREC.
   196******************************************************************
   197*                                                                *
   198*                                                                *
   199*                            ELCZREC.                            *
   200*                                                                *
   201*   FILE DESCRIPTION = Z CONTROL RECORD LAYOUT                   *
   202*                                                                *
   203******************************************************************
   204*-----------------------------------------------------------------
   205*                   C H A N G E   L O G
   206*
   207* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   208*-----------------------------------------------------------------
   209*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   210* EFFECTIVE    NUMBER
   211*-----------------------------------------------------------------
   212* 122011    2011022800001  AJRA  NEW FILE
   213* 073112    2011022800001  AJRA  ADD ACCT SUMM, CSO SUMM
   214* 122712    2012101700002  AJRA  ADD REASON CODE REQUIRED FLAG
   215*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page   6
* EL6318.cbl
   216 01  W-Z-CONTROL-DATA.
   217     05  W-NUMBER-OF-COPIES      PIC  9.
   218     05  FILLER                  PIC  X.
   219     05  W-DAYS-TO-FOLLOW-UP     PIC  999.
   220     05  FILLER                  PIC  X.
   221     05  W-DAYS-TO-RESEND        PIC  999.
   222     05  FILLER                  PIC  X.
   223     05  W-FORM-TO-RESEND        PIC  X(4).
   224     05  FILLER                  PIC  X.
   225     05  W-PROMPT-LETTER         PIC  X.
   226     05  FILLER                  PIC  X.
   227     05  W-ENCLOSURE-CD          PIC  XXX.
   228     05  FILLER                  PIC  X.
   229     05  W-AUTO-CLOSE-IND        PIC  X.
   230     05  FILLER                  PIC  X.
   231     05  W-LETTER-TO-BENE        PIC  X.
   232     05  FILLER                  PIC  X.
   233     05  W-LETTER-TO-ACCT        PIC  X.
   234     05  FILLER                  PIC  X.
   235     05  W-LETTER-TYPE           PIC  X.
   236     05  FILLER                  PIC  X.
   237     05  W-PRINT-CERTIFICATE     PIC  X.
   238     05  FILLER                  PIC  X.
   239     05  W-REFUND-REQUIRED       PIC  X.
   240     05  FILLER                  PIC  X.
   241     05  W-ONBASE-CODE           PIC  XX.
   242     05  FILLER                  PIC  X.
   243     05  W-ACCT-SUMM             PIC  X.
   244     05  FILLER                  PIC  X.
   245     05  W-CSO-SUMM              PIC  X.
   246     05  FILLER                  PIC  X.
   247     05  W-REASONS-REQUIRED      PIC  X.
   248     05  FILLER                  PIC  X(29).
   249 01  WS-PASSED-REASON-CODES      PIC X(60)  VALUE SPACES.
   250 01  STANDARD-AREAS.
   251     12  W-ARCH-SUPPRESS         PIC ZZZZZZZ9.
   252     12  W-ARCH-EDIT REDEFINES W-ARCH-SUPPRESS
   253                                 PIC  X(08).
   254     12  W-ARCH-LENGTH           PIC S9(04)  COMP  VALUE +250.
   255     12  QID.
   256         16  QID-TERM        PIC X(4)    VALUE SPACES.
   257         16  FILLER          PIC X(4)    VALUE '631K'.
   258     12  MAP-LENGTH          PIC 9(4)   VALUE 359 BINARY.
   259     12  TIME-MT                 PIC S9(7).
   260     12  TIME-MT-R  REDEFINES TIME-MT.
   261         16  FILLER              PIC X.
   262         16  TIME-LMT            PIC 99V99.
   263         16  FILLER              PIC X(2).
   264     12  GETMAIN-SPACE           PIC X VALUE SPACES.
   265     12  ERENDT-LENGTH           PIC S9(04) VALUE +579 COMP.
   266     12  ERPNDB-LENGTH           PIC 9(04)  VALUE 585 COMP.
   267     12  ERCNOT-LENGTH           PIC S9(04) VALUE +150 COMP.
   268     12  ERNOTE-LENGTH           PIC S9(04) VALUE +825 COMP.
   269     12  ELEOBC-LENGTH           PIC S9(04) VALUE +350 COMP.
   270     12  ELCRTT-LENGTH           PIC S9(4) COMP VALUE +552.
   271     12  W-CNTL-KEY.
   272         16  W-CNTL-COMPANY-ID   PIC  X(03).
   273         16  W-CNTL-RECORD-TYPE  PIC  X(01)   VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page   7
* EL6318.cbl
   274         16  W-CNTL-GENL.
   275             20  W-CNTL-GEN1     PIC  X(02)   VALUE SPACES.
   276             20  W-CNTL-GEN2.
   277                 24 W-CNTL-GEN3  PIC  X(01)   VALUE SPACES.
   278                 24 W-CNTL-GEN4  PIC  X(01)   VALUE SPACES.
   279         16  W-CNTL-SEQ-NO       PIC S9(04)   VALUE +0    COMP.
   280     12  WS-ELCERT-KEY.
   281         16  W-CERT-COMPANY-CD   PIC X.
   282         16  W-CERT-CARRIER      PIC X.
   283         16  W-CERT-GROUPING     PIC X(6).
   284         16  W-CERT-STATE        PIC XX.
   285         16  W-CERT-ACCOUNT      PIC X(10).
   286         16  W-CERT-CERT-EFF-DT  PIC XX.
   287         16  W-CERT-CERT-PRIME   PIC X(10).
   288         16  W-CERT-CERT-SFX     PIC X.
   289     12  WS-ELEOBC-KEY.
   290         16  WS-EOBC-COMPANY-CD  PIC X.
   291         16  WS-EOBC-REC-TYPE    PIC X.
   292         16  WS-EOBC-CODE        PIC X(4).
   293         16  FILLER              PIC X(9).
   294     12  WS-ERNOTE-KEY.
   295         16  W-NOTE-COMPANY-CD   PIC X.
   296         16  W-NOTE-CARRIER      PIC X.
   297         16  W-NOTE-GROUPING     PIC X(6).
   298         16  W-NOTE-STATE        PIC XX.
   299         16  W-NOTE-ACCOUNT      PIC X(10).
   300         16  W-NOTE-CERT-EFF-DT  PIC XX.
   301         16  W-NOTE-CERT-PRIME   PIC X(10).
   302         16  W-NOTE-CERT-SFX     PIC X.
   303     12  ELLETR-KEY.
   304         16  LETR-PART-KEY.
   305             20  LETR-COMPANY-CD PIC X.
   306             20  LETR-LETTER-ID  PIC X(4).
   307         16  LETR-FILLER         PIC X(8).
   308         16  LETR-SEQ-NO         PIC 9(4) BINARY.
   309     12  ELLETR-SAVE-PART-KEY    PIC X(5).
   310     12  ERPNDB2-KEY.
   311         16  PNDB2-COMPANY-CD    PIC X.
   312         16  PNDB2-CARRIER       PIC X.
   313         16  PNDB2-GROUPING      PIC X(6).
   314         16  PNDB2-STATE         PIC XX.
   315         16  PNDB2-ACCOUNT       PIC X(10).
   316         16  PNDB2-CERT-EFF-DT   PIC XX.
   317         16  PNDB2-CERT-PRIME    PIC X(10).
   318         16  PNDB2-CERT-SFX      PIC X.
   319         16  PNDB2-CHG-SEQ-NO    PIC 9(4) BINARY.
   320         16  PNDB2-RECORD-TYPE   PIC X.
   321     12  ERPNDB-KEY.
   322         16  PNDB-COMPANY-CD     PIC X.
   323         16  PNDB-BATCH-NO       PIC X(6).
   324         16  PNDB-BATCH-SEQ-NO   PIC 9(4) BINARY.
   325         16  PNDB-CHG-SEQ-NO     PIC 9(4) BINARY.
   326     12  ERENDT-KEY.
   327         16  ENDT-COMPANY-CD       PIC X.
   328         16  ENDT-CARRIER          PIC X.
   329         16  ENDT-GROUPING         PIC X(6).
   330         16  ENDT-STATE            PIC XX.
   331         16  ENDT-ACCOUNT          PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page   8
* EL6318.cbl
   332         16  ENDT-CERT-EFF-DT      PIC XX.
   333         16  ENDT-CERT-PRIME       PIC X(10).
   334         16  ENDT-CERT-SFX         PIC X.
   335         16  ENDT-RECORD-TYPE      PIC X.
   336         16  ENDT-SEQ-NO           PIC 9(4) BINARY.
   337     12  ELCRTO-KEY.
   338         16  CRTO-COMPANY-CD     PIC X.
   339         16  CRTO-CARRIER        PIC X.
   340         16  CRTO-GROUPING       PIC X(6).
   341         16  CRTO-STATE          PIC XX.
   342         16  CRTO-ACCOUNT        PIC X(10).
   343         16  CRTO-CERT-EFF-DT    PIC XX.
   344         16  CRTO-CERT-PRIME     PIC X(10).
   345         16  CRTO-CERT-SFX       PIC X.
   346         16  CRTO-RECORD-TYPE    PIC X.
   347         16  CRTO-SEQ-NO         PIC 9(4) BINARY.
   348     12  WS-ELCRTT-KEY.
   349         16  WS-ELCRTT-PRIMARY   PIC X(33).
   350         16  WS-ELCRTT-REC-TYPE  PIC X(1).
   351     12  WS-ERMAIL-KEY.
   352         16  MAIL-COMPANY-CD     PIC X.
   353         16  MAIL-CARRIER        PIC X.
   354         16  MAIL-GROUPING       PIC X(6).
   355         16  MAIL-STATE          PIC XX.
   356         16  MAIL-ACCOUNT        PIC X(10).
   357         16  MAIL-CERT-EFF-DT    PIC XX.
   358         16  MAIL-CERT-PRIME     PIC X(10).
   359         16  MAIL-CERT-SFX       PIC X.
   360     12  WS-LF-CANC-DT           PIC XX   VALUE LOW-VALUES.
   361     12  WS-AH-CANC-DT           PIC XX   VALUE LOW-VALUES.
   362     12  WS-CURRENT-DT.
   363         16  FILLER              PIC X(6)    VALUE SPACES.
   364         16  WS-CURRENT-YR       PIC XX      VALUE SPACES.
   365     12  WS-CURRENT-BIN-DT       PIC XX    VALUE LOW-VALUES.
   366     12  WS-ISS-CAN-SW           PIC X     VALUE LOW-VALUES.
   367         88  CANCEL-REC            VALUE 'C'.
   368         88  ISSUE-REC             VALUE 'I'.
   369     12  WS-WORK-AMT             PIC S9(9)V99 COMP-3 VALUE +0.
   370     12  WS-HOLD-ACCT-KEY        PIC X(26) VALUE LOW-VALUES.
   371     12  ELCNTL-KEY.
   372         16  CNTL-COMP-ID        PIC X(3)  VALUE SPACES.
   373         16  CNTL-REC-TYPE       PIC X     VALUE SPACES.
   374         16  CNTL-ACCESS.
   375             20  CNTL-STATE      PIC XX    VALUE SPACES.
   376             20  FILLER          PIC X     VALUE SPACES.
   377             20  CNTL-CARRIER    PIC X     VALUE SPACES.
   378         16  CNTL-SEQ            PIC S9(4) VALUE +0 COMP.
   379     12  WS-ERACCT-KEY.
   380         16  ACCT-COMPANY-CD     PIC X.
   381         16  ACCT-CARRIER        PIC X.
   382         16  ACCT-GROUPING       PIC X(6).
   383         16  ACCT-STATE          PIC XX.
   384         16  ACCT-ACCOUNT        PIC X(10).
   385         16  ACCT-EXP-DATE       PIC XX    VALUE SPACES.
   386         16  FILLER              PIC X(4)  VALUE LOW-VALUES.
   387     12  ERACCT-SAVE-KEY         PIC X(20) VALUE SPACES.
   388     12  WS-ELCERT-FILE-ID       PIC X(8) VALUE 'ELCERT'.
   389     12  WS-ELCNTL-FILE-ID       PIC X(8) VALUE 'ELCNTL'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page   9
* EL6318.cbl
   390     12  WS-ERNOTE-FILE-ID       PIC X(8) VALUE 'ERNOTE'.
   391     12  WS-ELCRTO-FILE-ID       PIC X(8) VALUE 'ELCRTO'.
   392     12  WS-ERENDT-FILE-ID       PIC X(8) VALUE 'ERENDT'.
   393     12  WS-ERPNDB2-FILE-ID      PIC X(8) VALUE 'ERPNDB2'.
   394     12  WS-ERPNDB-FILE-ID       PIC X(8) VALUE 'ERPNDB'.
   395     12  WS-ERACCT2-FILE-ID      PIC X(8) VALUE 'ERACCT2'.
   396     12  WS-ERCNOT-FILE-ID       PIC X(8) VALUE 'ERCNOT'.
   397     12  WS-ELEOBC-FILE-ID       PIC X(8) VALUE 'ELEOBC'.
   398     12  WS-ELCRTT-FILE-ID       PIC X(8) VALUE 'ELCRTT'.
   399     12  WS-RESPONSE             PIC S9(8)   COMP.
   400         88  RESP-NORMAL                  VALUE +00.
   401         88  RESP-NOTFND                  VALUE +13.
   402         88  RESP-DUPREC                  VALUE +14.
   403         88  RESP-DUPKEY                  VALUE +15.
   404         88  RESP-NOTOPEN                 VALUE +19.
   405         88  RESP-ENDFILE                 VALUE +20.
   406     12  MAP-NAME            PIC X(8)    VALUE 'EL631K'.
   407     12  MAPSET-NAME         PIC X(8)    VALUE 'EL6318S'.
   408     12  SCREEN-NUMBER       PIC X(4)    VALUE '631K'.
   409     12  TRANS-ID            PIC X(4)    VALUE 'EXBE'.
   410     12  THIS-PGM            PIC X(8)    VALUE 'EL6318'.
   411     12  PGM-NAME            PIC X(8).
   412     12  TIME-IN             PIC S9(7).
   413     12  TIME-OUT-R  REDEFINES TIME-IN.
   414         16  FILLER          PIC X.
   415         16  TIME-OUT        PIC 99V99.
   416         16  FILLER          PIC X(2).
   417     12  XCTL-005            PIC X(8)    VALUE 'EL005'.
   418     12  XCTL-010            PIC X(8)    VALUE 'EL010'.
   419     12  XCTL-626            PIC X(8)    VALUE 'EL626'.
   420     12  XCTL-6311           PIC X(8)    VALUE 'EL6311'.
   421     12  LINK-001            PIC X(8)    VALUE 'EL001'.
   422     12  LINK-004            PIC X(8)    VALUE 'EL004'.
   423     12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
   424     12  WS-PHONE.
   425         16  WS-PH1              PIC XXX.
   426         16  WS-PH2              PIC XXX.
   427         16  WS-PH3              PIC XXXX.
   428     12  WS-PHONE-NUM REDEFINES WS-PHONE PIC 9(10).
   429     12  WS-DEV-RT               PIC S9V9(6) COMP-3.
   430
   431     12  WS-BILLING-NOTE.
   432         16  WS-BN-NOTE          PIC X(25).
   433         16  WS-BN-LTRID         PIC X(4).
   434         16  FILLER              PIC X(3).
   435         16  WS-BN-DATE          PIC X(8).
   436         16  FILLER              PIC X(3).
   437         16  WS-BN-USERID        PIC X(4).
   438         16  FILLER              PIC X(30).
   439     12  WS-MANUAL-BILL-NOTE REDEFINES WS-BILLING-NOTE.
   440         16  WS-MAN-BN-NOTE      PIC X(63).
   441         16  FILLER              PIC X(14).
   442     12  WS-LEN                  PIC S9(5) COMP-3 VALUE +0.
   443
   444     12  WS-SAVE-REASON-CODE-IND PIC X(26).
   445
   446 01  NEW-ELCRTO-REC.
   447     12  NEW-ELCRTO-KEY.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  10
* EL6318.cbl
   448         16  NCRTO-COMPANY-CD      PIC X.
   449         16  NCRTO-CARRIER         PIC X.
   450         16  NCRTO-GROUPING        PIC X(6).
   451         16  NCRTO-STATE           PIC XX.
   452         16  NCRTO-ACCOUNT         PIC X(10).
   453         16  NCRTO-CERT-EFF-DT     PIC XX.
   454         16  NCRTO-CERT-PRIME      PIC X(10).
   455         16  NCRTO-CERT-SFX        PIC X.
   456         16  NCRTO-RECORD-TYPE     PIC X.
   457         16  NCRTO-SEQ-NO          PIC 9(4) BINARY.
   458     12  NEW-ORIG-REC.
   459         16  NCRTO-INS-LAST-NAME   PIC X(15).
   460         16  NCRTO-INS-FIRST-NAME  PIC X(10).
   461         16  NCRTO-INS-MIDDLE-INIT PIC X.
   462         16  NCRTO-INS-AGE         PIC S999     COMP-3.
   463         16  NCRTO-JNT-LAST-NAME   PIC X(15).
   464         16  NCRTO-JNT-FIRST-NAME  PIC X(10).
   465         16  NCRTO-JNT-MIDDLE-INIT PIC X.
   466         16  NCRTO-JNT-AGE         PIC S999     COMP-3.
   467         16  NCRTO-LF-BENCD        PIC XX.
   468         16  NCRTO-LF-TERM         PIC S999      COMP-3.
   469         16  NCRTO-LF-BEN-AMT      PIC S9(9)V99  COMP-3.
   470         16  NCRTO-LF-PRM-AMT      PIC S9(7)V99  COMP-3.
   471         16  NCRTO-LF-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
   472         16  NCRTO-LF-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
   473         16  NCRTO-LF-EXP-DT       PIC XX.
   474         16  NCRTO-LF-COMM-PCT     PIC SV9(5)    COMP-3.
   475         16  NCRTO-LF-CANCEL-DT    PIC XX.
   476         16  NCRTO-LF-CANCEL-AMT   PIC S9(7)V99  COMP-3.
   477         16  NCRTO-LF-ITD-CANCEL-AMT PIC S9(7)V99 COMP-3.
   478         16  NCRTO-AH-BENCD        PIC XX.
   479         16  NCRTO-AH-TERM         PIC S999      COMP-3.
   480         16  NCRTO-AH-BEN-AMT      PIC S9(9)V99  COMP-3.
   481         16  NCRTO-AH-PRM-AMT      PIC S9(7)V99  COMP-3.
   482         16  NCRTO-AH-EXP-DT       PIC XX.
   483         16  NCRTO-AH-COMM-PCT     PIC SV9(5)    COMP-3.
   484         16  NCRTO-AH-CP           PIC 99.
   485         16  NCRTO-AH-CANCEL-DT    PIC XX.
   486         16  NCRTO-AH-CANCEL-AMT   PIC S9(7)V99  COMP-3.
   487         16  NCRTO-AH-ITD-CANCEL-AMT PIC S9(7)V99 COMP-3.
   488         16  NCRTO-CRED-BENE-NAME  PIC X(25).
   489         16  NCRTO-1ST-PMT-DT      PIC XX.
   490         16  NCRTO-INS-AGE-DEFAULT-FLAG PIC X.
   491         16  NCRTO-JNT-AGE-DEFAULT-FLAG PIC X.
   492         16  FILLER                PIC X(237).
   493
   494 01  CERT-NOTE-ENTRIES.
   495     12  CERT-NT OCCURS 300 TIMES INDEXED BY TB-INDX TB-INDX1.
   496         16  CERT-NT-TEXT                PIC X(63).
   497         16  CERT-NT-LAST-MAINT-BY       PIC XXXX.
   498         16  CERT-NT-LAST-MAINT-DT       PIC XX.
   499         16  CERT-NT-LAST-MAINT-HHMMSS   PIC S9(7) COMP-3.
   500
   501 01  ERCNOT-AREA.
   502     12  ERCNOT-KEY-LENGTH       PIC S9(4)   COMP VALUE +36.
   503     12  ERCNOT-START-LENGTH     PIC S9(4)   COMP VALUE +34.
   504     12  ERCNOT-KEY.
   505         16  ERCNOT-PARTIAL-KEY.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  11
* EL6318.cbl
   506             20 ERCNOT-COMPANY-CD    PIC X.
   507             20 ERCNOT-CARRIER       PIC X.
   508             20 ERCNOT-GROUPING      PIC X(06).
   509             20 ERCNOT-STATE         PIC XX.
   510             20 ERCNOT-ACCOUNT       PIC X(10).
   511             20 ERCNOT-EFF-DT        PIC XX.
   512             20 ERCNOT-CERT-NO.
   513                25 ERCNOT-CERT-PRIME PIC X(10).
   514                25 ERCNOT-CERT-SFX   PIC X.
   515             20 ERCNOT-REC-TYP       PIC X.
   516         16 ERCNOT-SEQ           PIC S9(4) COMP.
   517     12  SV-PARTIAL-KEY.
   518         20 SV-COMPANY-CD            PIC X.
   519         20 SV-CARRIER               PIC X.
   520         20 SV-GROUPING              PIC X(06).
   521         20 SV-STATE                 PIC XX.
   522         20 SV-ACCOUNT               PIC X(10).
   523         20 SV-EFF-DT                PIC XX.
   524         20 SV-CERT-NO.
   525            25 SV-CERT-PRIME         PIC X(10).
   526            25 SV-CERT-SFX           PIC X(1).
   527         20 SV-REC-TYP               PIC X.
   528 01  ERROR-MESSAGES.
   529     12  ER-0000                 PIC X(4)  VALUE '0000'.
   530     12  ER-0004                 PIC X(4)  VALUE '0004'.
   531     12  ER-0008                 PIC X(4)  VALUE '0008'.
   532     12  ER-0023                 PIC X(4)  VALUE '0023'.
   533     12  ER-0029                 PIC X(4)  VALUE '0029'.
   534     12  ER-0068                 PIC X(4)  VALUE '0068'.
   535     12  ER-0132                 PIC X(4)  VALUE '0132'.
   536     12  ER-0142                 PIC X(4)  VALUE '0142'.
   537     12  ER-0148                 PIC X(4)  VALUE '0148'.
   538     12  ER-0215                 PIC X(4)  VALUE '0215'.
   539     12  ER-0280                 PIC X(4)  VALUE '0280'.
   540     12  ER-0348                 PIC X(4)  VALUE '0348'.
   541     12  ER-0419                 PIC X(4)  VALUE '0419'.
   542     12  ER-0715                 PIC X(4)  VALUE '0715'.
   543     12  ER-0894                 PIC X(4)  VALUE '0894'.
   544     12  ER-1101                 PIC X(4)  VALUE '1101'.
   545     12  ER-1236                 PIC X(4)  VALUE '1236'.
   546     12  ER-1778                 PIC X(4)  VALUE '1778'.
   547     12  ER-1818                 PIC X(4)  VALUE '1818'.
   548     12  ER-1820                 PIC X(4)  VALUE '1820'.
   549     12  ER-1821                 PIC X(4)  VALUE '1821'.
   550     12  ER-2056                 PIC X(4)  VALUE '2056'.
   551     12  ER-2079                 PIC X(4)  VALUE '2079'.
   552     12  ER-2208                 PIC X(4)  VALUE '2208'.
   553     12  ER-2209                 PIC X(4)  VALUE '2209'.
   554     12  ER-2237                 PIC X(4)  VALUE '2237'.
   555     12  ER-2238                 PIC X(4)  VALUE '2238'.
   556     12  ER-2253                 PIC X(4)  VALUE '2253'.
   557     12  ER-2619                 PIC X(4)  VALUE '2619'.
   558     12  ER-2651                 PIC X(4)  VALUE '2651'.
   559     12  ER-2784                 PIC X(4)  VALUE '2784'.
   560     12  ER-2785                 PIC X(4)  VALUE '2785'.
   561     12  ER-2786                 PIC X(4)  VALUE '2786'.
   562     12  ER-2791                 PIC X(4)  VALUE '2791'.
   563     12  ER-2845                 PIC X(4)  VALUE '2845'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  12
* EL6318.cbl
   564     12  ER-2848                 PIC X(4)  VALUE '2848'.
   565     12  ER-2851                 PIC X(4)  VALUE '2851'.
   566     12  ER-3830                 PIC X(4)  VALUE '3830'.
   567     12  ER-3833                 PIC X(4)  VALUE '3833'.
   568     12  ER-7345                 PIC X(4)  VALUE '7345'.
   569     12  ER-7638                 PIC X(4)  VALUE '7638'.
   570     12  ER-8888                 PIC X(4)  VALUE '8888'.
   571     12  ER-9999                 PIC X(4)  VALUE '9999'.
   572*    COPY ELCDATE.
   573******************************************************************
   574*                                                                *
   575*                                                                *
   576*                            ELCDATE.                            *
   577*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   578*                            VMOD=2.003
   579*                                                                *
   580*                                                                *
   581*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   582*                 LENGTH = 200                                   *
   583******************************************************************
   584
   585 01  DATE-CONVERSION-DATA.
   586     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   587     12  DC-OPTION-CODE                PIC X.
   588         88  BIN-TO-GREG                VALUE ' '.
   589         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   590         88  EDIT-GREG-TO-BIN           VALUE '2'.
   591         88  YMD-GREG-TO-BIN            VALUE '3'.
   592         88  MDY-GREG-TO-BIN            VALUE '4'.
   593         88  JULIAN-TO-BIN              VALUE '5'.
   594         88  BIN-PLUS-ELAPSED           VALUE '6'.
   595         88  FIND-CENTURY               VALUE '7'.
   596         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   597         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   598         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   599         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   600         88  JULIAN-TO-BIN-3            VALUE 'C'.
   601         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   602         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   603         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   604         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   605         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   606         88  CHECK-LEAP-YEAR            VALUE 'H'.
   607         88  BIN-3-TO-GREG              VALUE 'I'.
   608         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   609         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   610         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   611         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   612         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   613         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   614         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   615         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   616         88  THREE-CHARACTER-BIN
   617                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   618         88  GREGORIAN-TO-BIN
   619                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   620         88  BIN-TO-GREGORIAN
   621                  VALUES ' ' '1' 'I' '8' 'G'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  13
* EL6318.cbl
   622         88  JULIAN-TO-BINARY
   623                  VALUES '5' 'C' 'E' 'F'.
   624     12  DC-ERROR-CODE                 PIC X.
   625         88  NO-CONVERSION-ERROR        VALUE ' '.
   626         88  DATE-CONVERSION-ERROR
   627                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   628         88  DATE-IS-ZERO               VALUE '1'.
   629         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   630         88  DATE-IS-INVALID            VALUE '3'.
   631         88  DATE1-GREATER-DATE2        VALUE '4'.
   632         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   633         88  DATE-INVALID-OPTION        VALUE '9'.
   634         88  INVALID-CENTURY            VALUE 'A'.
   635         88  ONLY-CENTURY               VALUE 'B'.
   636         88  ONLY-LEAP-YEAR             VALUE 'C'.
   637         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   638     12  DC-END-OF-MONTH               PIC X.
   639         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   640     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   641         88  USE-NORMAL-PROCESS         VALUE ' '.
   642         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   643         88  ADJUST-UP-100-YRS          VALUE '2'.
   644     12  FILLER                        PIC X.
   645     12  DC-CONVERSION-DATES.
   646         16  DC-BIN-DATE-1             PIC XX.
   647         16  DC-BIN-DATE-2             PIC XX.
   648         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   649         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   650                       DC-GREG-DATE-1-EDIT.
   651             20  DC-EDIT1-MONTH        PIC 99.
   652             20  SLASH1-1              PIC X.
   653             20  DC-EDIT1-DAY          PIC 99.
   654             20  SLASH1-2              PIC X.
   655             20  DC-EDIT1-YEAR         PIC 99.
   656         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   657         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   658                     DC-GREG-DATE-2-EDIT.
   659             20  DC-EDIT2-MONTH        PIC 99.
   660             20  SLASH2-1              PIC X.
   661             20  DC-EDIT2-DAY          PIC 99.
   662             20  SLASH2-2              PIC X.
   663             20  DC-EDIT2-YEAR         PIC 99.
   664         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   665         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   666                     DC-GREG-DATE-1-YMD.
   667             20  DC-YMD-YEAR           PIC 99.
   668             20  DC-YMD-MONTH          PIC 99.
   669             20  DC-YMD-DAY            PIC 99.
   670         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   671         16  DC-GREG-DATE-1-MDY-R REDEFINES
   672                      DC-GREG-DATE-1-MDY.
   673             20  DC-MDY-MONTH          PIC 99.
   674             20  DC-MDY-DAY            PIC 99.
   675             20  DC-MDY-YEAR           PIC 99.
   676         16  DC-GREG-DATE-1-ALPHA.
   677             20  DC-ALPHA-MONTH        PIC X(10).
   678             20  DC-ALPHA-DAY          PIC 99.
   679             20  FILLER                PIC XX.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  14
* EL6318.cbl
   680             20  DC-ALPHA-CENTURY.
   681                 24 DC-ALPHA-CEN-N     PIC 99.
   682             20  DC-ALPHA-YEAR         PIC 99.
   683         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   684         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   685         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   686         16  DC-JULIAN-DATE            PIC 9(05).
   687         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   688                                       PIC 9(05).
   689         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   690             20  DC-JULIAN-YEAR        PIC 99.
   691             20  DC-JULIAN-DAYS        PIC 999.
   692         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   693         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   694         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   695     12  DATE-CONVERSION-VARIBLES.
   696         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   697         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   698             20  FILLER                PIC 9(3).
   699             20  HOLD-CEN-1-CCYY.
   700                 24  HOLD-CEN-1-CC     PIC 99.
   701                 24  HOLD-CEN-1-YY     PIC 99.
   702             20  HOLD-CEN-1-MO         PIC 99.
   703             20  HOLD-CEN-1-DA         PIC 99.
   704         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   705             20  HOLD-CEN-1-R-MO       PIC 99.
   706             20  HOLD-CEN-1-R-DA       PIC 99.
   707             20  HOLD-CEN-1-R-CCYY.
   708                 24  HOLD-CEN-1-R-CC   PIC 99.
   709                 24  HOLD-CEN-1-R-YY   PIC 99.
   710             20  FILLER                PIC 9(3).
   711         16  HOLD-CENTURY-1-X.
   712             20  FILLER                PIC X(3)  VALUE SPACES.
   713             20  HOLD-CEN-1-X-CCYY.
   714                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   715                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   716             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   717             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   718         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   719             20  HOLD-CEN-1-R-X-MO     PIC XX.
   720             20  HOLD-CEN-1-R-X-DA     PIC XX.
   721             20  HOLD-CEN-1-R-X-CCYY.
   722                 24  HOLD-CEN-1-R-X-CC PIC XX.
   723                 24  HOLD-CEN-1-R-X-YY PIC XX.
   724             20  FILLER                PIC XXX.
   725         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   726         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   727         16  DC-JULIAN-DATE-1          PIC 9(07).
   728         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   729             20  DC-JULIAN-1-CCYY.
   730                 24  DC-JULIAN-1-CC    PIC 99.
   731                 24  DC-JULIAN-1-YR    PIC 99.
   732             20  DC-JULIAN-DA-1        PIC 999.
   733         16  DC-JULIAN-DATE-2          PIC 9(07).
   734         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   735             20  DC-JULIAN-2-CCYY.
   736                 24  DC-JULIAN-2-CC    PIC 99.
   737                 24  DC-JULIAN-2-YR    PIC 99.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  15
* EL6318.cbl
   738             20  DC-JULIAN-DA-2        PIC 999.
   739         16  DC-GREG-DATE-A-EDIT.
   740             20  DC-EDITA-MONTH        PIC 99.
   741             20  SLASHA-1              PIC X VALUE '/'.
   742             20  DC-EDITA-DAY          PIC 99.
   743             20  SLASHA-2              PIC X VALUE '/'.
   744             20  DC-EDITA-CCYY.
   745                 24  DC-EDITA-CENT     PIC 99.
   746                 24  DC-EDITA-YEAR     PIC 99.
   747         16  DC-GREG-DATE-B-EDIT.
   748             20  DC-EDITB-MONTH        PIC 99.
   749             20  SLASHB-1              PIC X VALUE '/'.
   750             20  DC-EDITB-DAY          PIC 99.
   751             20  SLASHB-2              PIC X VALUE '/'.
   752             20  DC-EDITB-CCYY.
   753                 24  DC-EDITB-CENT     PIC 99.
   754                 24  DC-EDITB-YEAR     PIC 99.
   755         16  DC-GREG-DATE-CYMD         PIC 9(08).
   756         16  DC-GREG-DATE-CYMD-R REDEFINES
   757                              DC-GREG-DATE-CYMD.
   758             20  DC-CYMD-CEN           PIC 99.
   759             20  DC-CYMD-YEAR          PIC 99.
   760             20  DC-CYMD-MONTH         PIC 99.
   761             20  DC-CYMD-DAY           PIC 99.
   762         16  DC-GREG-DATE-MDCY         PIC 9(08).
   763         16  DC-GREG-DATE-MDCY-R REDEFINES
   764                              DC-GREG-DATE-MDCY.
   765             20  DC-MDCY-MONTH         PIC 99.
   766             20  DC-MDCY-DAY           PIC 99.
   767             20  DC-MDCY-CEN           PIC 99.
   768             20  DC-MDCY-YEAR          PIC 99.
   769    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   770        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   771    12  DC-EL310-DATE                  PIC X(21).
   772    12  FILLER                         PIC X(28).
   773*    COPY ELCTEXT.
   774******************************************************************
   775*                                                                *
   776*                                                                *
   777*                            ELCTEXT.                            *
   778*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   779*                            VMOD=2.008                          *
   780*                                                                *
   781*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
   782*                                     FORM LETTERS,              *
   783*                                     CERT FORM DISPLAY.
   784*                                                                *
   785*   FILE TYPE = VSAM,KSDS                                        *
   786*   RECORD SIZE = 100   RECFORM = FIXED                          *
   787*                                                                *
   788*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
   789*       ALTERNATE INDEX = NONE                                   *
   790*                                                                *
   791*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
   792*       ALTERNATE INDEX = NONE                                   *
   793*                                                                *
   794*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
   795*       ALTERNATE INDEX = NONE                                   *
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  16
* EL6318.cbl
   796*                                                                *
   797*   LOG = NO                                                     *
   798*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   799******************************************************************
   800 01  TEXT-FILES.
   801     12  TEXT-FILE-ID                PIC XX.
   802         88  FORMS-FILE-TEXT            VALUE 'TF'.
   803         88  LETTER-FILE-TEXT           VALUE 'TL'.
   804         88  HELP-FILE-TEXT             VALUE 'TH'.
   805
   806     12  TX-CONTROL-PRIMARY.
   807         16  TX-COMPANY-CD           PIC X.
   808             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
   809         16  TX-ACCESS-CD-GENL       PIC X(12).
   810
   811         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
   812             20  TX-LETTER-NO        PIC X(4).
   813             20  FILLER              PIC X(8).
   814
   815         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
   816             20  TX-FORM-NO          PIC X(12).
   817
   818         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
   819             20  TX-HELP-TYPE        PIC X.
   820                 88  HELP-FOR-GENERAL   VALUE ' '.
   821                 88  HELP-BY-SCREEN     VALUE 'S'.
   822                 88  HELP-BY-ERROR      VALUE 'E'.
   823             20  TX-SCREEN-OR-ERROR  PIC X(4).
   824                 88  GENERAL-INFO-HELP  VALUE '0000'.
   825             20  TX-HELP-FOR-COMPANY  PIC XXX.
   826                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
   827             20  FILLER              PIC X(4).
   828
   829         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
   830
   831     12  TX-PROCESS-CONTROL          PIC XX.
   832         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
   833
   834     12  TX-TEXT-LINE                PIC X(70).
   835
   836     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
   837         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
   838         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
   839         88  TX-VALID-FORM-SQUEEZE-VALUE
   840                                        VALUE 'Y' ' '.
   841
   842     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
   843         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
   844         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
   845         88  TX-DO-NOT-ADJUST           VALUE 'N'.
   846         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
   847         88  TX-NEW-PARAGRAPH           VALUE 'P'.
   848         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
   849         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
   850                                              'K' 'N' ' '
   851                                              'Z'.
   852
   853     12  TX-ARCHIVE-SW               PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  17
* EL6318.cbl
   854         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
   855         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
   856         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
   857
   858     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
   859     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
   860
   861     12  TX-BSR-CODE                 PIC X.
   862         88  TX-BSR-LETTER              VALUE 'B'.
   863         88  TX-NON-BSR-LETTER          VALUE ' '.
   864
   865     12  FILLER                      PIC X.
   866*****************************************************************
   867*    COPY ELCLOGOF.
   868******************************************************************
   869*                                                                *
   870*                                                                *
   871*                            ELCLOGOF.                           *
   872*                            VMOD=2.001                          *
   873*                                                                *
   874*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   875*                                                                *
   876******************************************************************
   877 01  CLASIC-LOGOFF.
   878     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   879     12  LOGOFF-TEXT.
   880         16  FILLER          PIC X(5)    VALUE SPACES.
   881         16  LOGOFF-MSG.
   882             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   883             20  FILLER      PIC X       VALUE SPACES.
   884             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   885         16  FILLER          PIC X(80)
   886           VALUE '* YOU ARE NOW LOGGED OFF'.
   887         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   888         16  FILLER          PIC X       VALUE QUOTE.
   889         16  LOGOFF-SYS-MSG  PIC X(17)
   890           VALUE 'S CLAS-IC SYSTEM '.
   891     12  TEXT-MESSAGES.
   892         16  UNACCESS-MSG    PIC X(29)
   893             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   894         16  PGMIDERR-MSG    PIC X(17)
   895             VALUE 'PROGRAM NOT FOUND'.
   896*    COPY ELCATTR.
   897******************************************************************
   898*                                                                *
   899*                            ELCATTR.                            *
   900*                            VMOD=2.001                          *
   901*                                                                *
   902*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   903*                                                                *
   904*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   905*                                                                *
   906*                   POS 1   P=PROTECTED                          *
   907*                           U=UNPROTECTED                        *
   908*                           S=ASKIP                              *
   909*                   POS 2   A=ALPHA/NUMERIC                      *
   910*                           N=NUMERIC                            *
   911*                   POS 3   N=NORMAL                             *
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  18
* EL6318.cbl
   912*                           B=BRIGHT                             *
   913*                           D=DARK                               *
   914*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   915*                           OF=MODIFIED DATA TAG OFF             *
   916*                                                                *
   917*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   918******************************************************************
   919 01  ATTRIBUTE-LIST.
   920     12  AL-PABOF            PIC X       VALUE 'Y'.
   921     12  AL-PABON            PIC X       VALUE 'Z'.
   922     12  AL-PADOF            PIC X       VALUE '%'.
   923     12  AL-PADON            PIC X       VALUE '_'.
   924     12  AL-PANOF            PIC X       VALUE '-'.
   925     12  AL-PANON            PIC X       VALUE '/'.
   926     12  AL-SABOF            PIC X       VALUE '8'.
   927     12  AL-SABON            PIC X       VALUE '9'.
   928     12  AL-SADOF            PIC X       VALUE '@'.
   929     12  AL-SADON            PIC X       VALUE QUOTE.
   930     12  AL-SANOF            PIC X       VALUE '0'.
   931     12  AL-SANON            PIC X       VALUE '1'.
   932     12  AL-UABOF            PIC X       VALUE 'H'.
   933     12  AL-UABON            PIC X       VALUE 'I'.
   934     12  AL-UADOF            PIC X       VALUE '<'.
   935     12  AL-UADON            PIC X       VALUE '('.
   936     12  AL-UANOF            PIC X       VALUE ' '.
   937     12  AL-UANON            PIC X       VALUE 'A'.
   938     12  AL-UNBOF            PIC X       VALUE 'Q'.
   939     12  AL-UNBON            PIC X       VALUE 'R'.
   940     12  AL-UNDOF            PIC X       VALUE '*'.
   941     12  AL-UNDON            PIC X       VALUE ')'.
   942     12  AL-UNNOF            PIC X       VALUE '&'.
   943     12  AL-UNNON            PIC X       VALUE 'J'.
   944*    COPY ELCEMIB.
   945******************************************************************
   946*                                                                *
   947*                                                                *
   948*                            ELCEMIB.                            *
   949*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   950*                            VMOD=2.005                          *
   951*                                                                *
   952*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   953*                                                                *
   954******************************************************************
   955 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   956     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   957     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   958     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   959     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   960     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   961     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   962     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   963     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   964     12  EMI-SWITCH1             PIC X        VALUE '1'.
   965         88  EMI-NO-ERRORS                    VALUE '1'.
   966         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   967         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   968     12  EMI-SWITCH2             PIC X        VALUE '1'.
   969         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  19
* EL6318.cbl
   970     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   971         88  EMI-AREA1-EMPTY                  VALUE '1'.
   972         88  EMI-AREA1-FULL                   VALUE '2'.
   973     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   974         88  EMI-AREA2-EMPTY                  VALUE '1'.
   975         88  EMI-AREA2-FULL                   VALUE '2'.
   976     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   977         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   978         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   979         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   980         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   981         88  EMI-BYPASS-FATALS                VALUE 'X'.
   982     12  EMI-ERROR-LINES.
   983         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   984         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   985         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   986         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   987             20  EMI-ERR-CODES OCCURS 10 TIMES.
   988                 24  EMI-ERR-NUM         PIC X(4).
   989                 24  EMI-FILLER          PIC X.
   990                 24  EMI-SEV             PIC X.
   991                 24  FILLER              PIC X.
   992             20  FILLER                  PIC X(02).
   993     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   994         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   995             20  EMI-ERROR-NUMBER    PIC X(4).
   996             20  EMI-FILL            PIC X.
   997             20  EMI-SEVERITY        PIC X.
   998             20  FILLER              PIC X.
   999             20  EMI-ERROR-TEXT.
  1000                 24  EMI-TEXT-VARIABLE   PIC X(10).
  1001                 24  FILLER          PIC X(55).
  1002     12  EMI-SEVERITY-SAVE           PIC X.
  1003         88  EMI-NOTE                    VALUE 'N'.
  1004         88  EMI-WARNING                 VALUE 'W'.
  1005         88  EMI-FORCABLE                VALUE 'F'.
  1006         88  EMI-FATAL                   VALUE 'X'.
  1007     12  EMI-MESSAGE-FLAG            PIC X.
  1008         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  1009         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  1010     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  1011     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  1012         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  1013         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  1014         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  1015     12  FILLER                      PIC X(137)  VALUE SPACES.
  1016     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  1017     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  1018     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  1019     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  1020*    COPY ELCINTF.
  1021******************************************************************
  1022*                                                                *
  1023*                                                                *
  1024*                            ELCINTF.                            *
  1025*                            VMOD=2.017                          *
  1026*                                                                *
  1027*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  20
* EL6318.cbl
  1028*                                                                *
  1029*       LENGTH = 1024                                            *
  1030*                                                                *
  1031******************************************************************
  1032*                   C H A N G E   L O G
  1033*
  1034* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1035*-----------------------------------------------------------------
  1036*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1037* EFFECTIVE    NUMBER
  1038*-----------------------------------------------------------------
  1039* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  1040******************************************************************
  1041 01  PROGRAM-INTERFACE-BLOCK.
  1042     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  1043     12  PI-CALLING-PROGRAM              PIC X(8).
  1044     12  PI-SAVED-PROGRAM-1              PIC X(8).
  1045     12  PI-SAVED-PROGRAM-2              PIC X(8).
  1046     12  PI-SAVED-PROGRAM-3              PIC X(8).
  1047     12  PI-SAVED-PROGRAM-4              PIC X(8).
  1048     12  PI-SAVED-PROGRAM-5              PIC X(8).
  1049     12  PI-SAVED-PROGRAM-6              PIC X(8).
  1050     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  1051     12  PI-COMPANY-ID                   PIC XXX.
  1052     12  PI-COMPANY-CD                   PIC X.
  1053
  1054     12  PI-COMPANY-PASSWORD             PIC X(8).
  1055
  1056     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  1057
  1058     12  PI-CONTROL-IN-PROGRESS.
  1059         16  PI-CARRIER                  PIC X.
  1060         16  PI-GROUPING                 PIC X(6).
  1061         16  PI-STATE                    PIC XX.
  1062         16  PI-ACCOUNT                  PIC X(10).
  1063         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  1064                                         PIC X(10).
  1065         16  PI-CLAIM-CERT-GRP.
  1066             20  PI-CLAIM-NO             PIC X(7).
  1067             20  PI-CERT-NO.
  1068                 25  PI-CERT-PRIME       PIC X(10).
  1069                 25  PI-CERT-SFX         PIC X.
  1070             20  PI-CERT-EFF-DT          PIC XX.
  1071         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  1072             20  PI-PLAN-CODE            PIC X(2).
  1073             20  PI-REVISION-NUMBER      PIC X(3).
  1074             20  PI-PLAN-EFF-DT          PIC X(2).
  1075             20  PI-PLAN-EXP-DT          PIC X(2).
  1076             20  FILLER                  PIC X(11).
  1077         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
  1078             20  PI-OE-REFERENCE-1.
  1079                 25  PI-OE-REF-1-PRIME   PIC X(18).
  1080                 25  PI-OE-REF-1-SUFF    PIC XX.
  1081
  1082     12  PI-SESSION-IN-PROGRESS          PIC X.
  1083         88  CLAIM-SESSION                   VALUE '1'.
  1084         88  CREDIT-SESSION                  VALUE '2'.
  1085         88  WARRANTY-SESSION                VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  21
* EL6318.cbl
  1086         88  MORTGAGE-SESSION                VALUE '4'.
  1087         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  1088
  1089
  1090*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  1091
  1092     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  1093     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  1094
  1095     12  PI-CREDIT-USER                  PIC X.
  1096         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  1097         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  1098
  1099     12  PI-CLAIM-USER                   PIC X.
  1100         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  1101         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  1102
  1103     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  1104         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  1105         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  1106         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  1107         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  1108         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  1109
  1110     12  PI-PROCESSOR-ID                 PIC X(4).
  1111
  1112     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  1113
  1114     12  PI-MEMBER-CAPTION               PIC X(10).
  1115
  1116     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1117         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  1118
  1119     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1120     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1121     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1122     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1123
  1124     12  PI-AH-OVERRIDE-L1               PIC X.
  1125     12  PI-AH-OVERRIDE-L2               PIC XX.
  1126     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1127     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1128
  1129     12  PI-NEW-SYSTEM                   PIC X(2).
  1130
  1131     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1132     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1133         88  PI-USES-PAID-TO                 VALUE '1'.
  1134     12  PI-CRDTCRD-SYSTEM.
  1135         16  PI-CRDTCRD-USER             PIC X.
  1136             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1137             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1138         16  PI-CC-MONTH-END-DT          PIC XX.
  1139     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1140
  1141     12  PI-OE-REFERENCE-2.
  1142         16  PI-OE-REF-2-PRIME           PIC X(10).
  1143         16  PI-OE-REF-2-SUFF            PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  22
* EL6318.cbl
  1144
  1145     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1146
  1147     12  PI-LANGUAGE-TYPE                PIC X.
  1148             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1149             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1150             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1151
  1152     12  PI-POLICY-LINKAGE-IND           PIC X.
  1153         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1154         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1155                                                   LOW-VALUES.
  1156
  1157     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1158     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1159         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1160         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1161
  1162     12  PI-PROCESSOR-CSR-IND            PIC X.
  1163         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1164         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  1165
  1166     12  FILLER                          PIC X(3).
  1167
  1168     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1169
  1170     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1171         PI-SYSTEM-LEVEL.
  1172
  1173         16  PI-ENTRY-CODES.
  1174             20  PI-ENTRY-CD-1           PIC X.
  1175             20  PI-ENTRY-CD-2           PIC X.
  1176
  1177         16  PI-RETURN-CODES.
  1178             20  PI-RETURN-CD-1          PIC X.
  1179             20  PI-RETURN-CD-2          PIC X.
  1180
  1181         16  PI-UPDATE-STATUS-SAVE.
  1182             20  PI-UPDATE-BY            PIC X(4).
  1183             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1184
  1185         16  PI-LOWER-CASE-LETTERS       PIC X.
  1186             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1187
  1188*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1189*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1190*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1191
  1192         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1193             88  ST-ACCNT-CNTL               VALUE ' '.
  1194             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1195             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1196             88  ACCNT-CNTL                  VALUE '3'.
  1197             88  CARR-ACCNT-CNTL             VALUE '4'.
  1198
  1199         16  PI-PROCESSOR-CAP-LIST.
  1200             20  PI-SYSTEM-CONTROLS.
  1201                24 PI-SYSTEM-DISPLAY     PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  23
* EL6318.cbl
  1202                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1203                24 PI-SYSTEM-MODIFY      PIC X.
  1204                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1205             20  FILLER                  PIC XX.
  1206             20  PI-DISPLAY-CAP          PIC X.
  1207                 88  DISPLAY-CAP             VALUE 'Y'.
  1208             20  PI-MODIFY-CAP           PIC X.
  1209                 88  MODIFY-CAP              VALUE 'Y'.
  1210             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1211                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1212             20  PI-FORCE-CAP            PIC X.
  1213                 88  FORCE-CAP               VALUE 'Y'.
  1214
  1215         16  PI-PROGRAM-CONTROLS.
  1216             20  PI-PGM-PRINT-OPT        PIC X.
  1217             20  PI-PGM-FORMAT-OPT       PIC X.
  1218             20  PI-PGM-PROCESS-OPT      PIC X.
  1219             20  PI-PGM-TOTALS-OPT       PIC X.
  1220
  1221         16  PI-HELP-INTERFACE.
  1222             20  PI-LAST-ERROR-NO        PIC X(4).
  1223             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1224
  1225         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1226             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1227
  1228         16  PI-CR-CONTROL-IN-PROGRESS.
  1229             20  PI-CR-CARRIER           PIC X.
  1230             20  PI-CR-GROUPING          PIC X(6).
  1231             20  PI-CR-STATE             PIC XX.
  1232             20  PI-CR-ACCOUNT           PIC X(10).
  1233             20  PI-CR-FIN-RESP          PIC X(10).
  1234             20  PI-CR-TYPE              PIC X.
  1235
  1236         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1237
  1238         16  PI-CR-MONTH-END-DT          PIC XX.
  1239
  1240         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1241             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1242             88  PI-ZERO-CARRIER             VALUE '1'.
  1243             88  PI-ZERO-GROUPING            VALUE '2'.
  1244             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1245
  1246         16  PI-CARRIER-SECURITY         PIC X.
  1247             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1248
  1249         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1250             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1251             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
  1252
  1253         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1254             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1255                                         INDEXED BY PI-ACCESS-NDX
  1256                                         PIC X.
  1257
  1258         16  PI-GA-BILLING-CONTROL       PIC X.
  1259             88  PI-GA-BILLING               VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  24
* EL6318.cbl
  1260
  1261         16  PI-MAIL-PROCESSING          PIC X.
  1262             88  PI-MAIL-YES                 VALUE 'Y'.
  1263
  1264         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1265
  1266         16  PI-AR-SYSTEM.
  1267             20  PI-AR-PROCESSING-CNTL   PIC X.
  1268                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1269             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1270             20  PI-AR-MONTH-END-DT      PIC XX.
  1271
  1272         16  PI-MP-SYSTEM.
  1273             20  PI-MORTGAGE-USER            PIC X.
  1274                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1275                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1276             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1277                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1278                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1279                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1280                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1281                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1282             20  PI-MP-MONTH-END-DT          PIC XX.
  1283             20  PI-MP-REFERENCE-NO.
  1284                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1285                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1286
  1287         16  PI-LABEL-CONTROL            PIC X(01).
  1288             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1289             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1290
  1291         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1292             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1293
  1294         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1295             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1296             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1297
  1298         16  FILLER                      PIC X(14).
  1299
  1300     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1301******************************************************************
  1302     12  FILLER REDEFINES PI-PROGRAM-WORK-AREA.
  1303        16  PI-ISS-CAN-SW           PIC X.
  1304        16  PI-ERENDT-KEY.
  1305            20  PI-ENDT-COMPANY-CD  PIC X.
  1306            20  PI-ENDT-CARRIER     PIC X.
  1307            20  PI-ENDT-GROUPING    PIC X(6).
  1308            20  PI-ENDT-STATE       PIC XX.
  1309            20  PI-ENDT-ACCOUNT     PIC X(10).
  1310            20  PI-ENDT-CERT-EFF-DT PIC XX.
  1311            20  PI-ENDT-CERT-PRIME  PIC X(10).
  1312            20  PI-ENDT-CERT-SFX    PIC X.
  1313            20  PI-ENDT-RECORD-TYPE PIC X.
  1314            20  PI-ENDT-SEQ-NO      PIC 9(4) BINARY.
  1315        16  PI-ELCRTO-KEY.
  1316            20  PI-CRTO-COMPANY-CD  PIC X.
  1317            20  PI-CRTO-CARRIER     PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  25
* EL6318.cbl
  1318            20  PI-CRTO-GROUPING    PIC X(6).
  1319            20  PI-CRTO-STATE       PIC XX.
  1320            20  PI-CRTO-ACCOUNT     PIC X(10).
  1321            20  PI-CRTO-CERT-EFF-DT PIC XX.
  1322            20  PI-CRTO-CERT-PRIME  PIC X(10).
  1323            20  PI-CRTO-CERT-SFX    PIC X.
  1324            20  PI-CRTO-RECORD-TYPE PIC X.
  1325            20  PI-CRTO-SEQ-NO      PIC 9(4) BINARY.
  1326        16  PI-ERPNDB-KEY           PIC X(11).
  1327        16  PI-DOCUMENT-PROCESSED   PIC X.
  1328            88  PI-VERI-PROCESSED      VALUE 'V'.
  1329            88  PI-ENDO-PROCESSED      VALUE 'G'.
  1330        16  PI-PREV-ERENDT-KEY      PIC X(36).
  1331        16  PI-RES-REF-CLM-TYPE     PIC X.
  1332        16  PI-CLM-REFORM-IND       PIC X.
  1333            88  PI-CLAIM-REFORMATION   VALUE 'Y'.
  1334        16  PI-CLEAR-ERROR-SW       PIC X.
  1335            88  PI-CLEAR-ERROR         VALUE 'Y'.
  1336        16  PI-PRINT-CERTIFICATE    PIC X.
  1337        16  PI-ENTERED.
  1338            20  PI-PRTSW-ENTERED    PIC X.
  1339            20  PI-SIGREQ-ENTERED   PIC X.
  1340            20  PI-MONEY-ENTERED    PIC X.
  1341            20  PI-LTRID-ENTERED    PIC X(4).
  1342            20  PI-VOUCHER-ENTERED  PIC X.
  1343            20  PI-HLTHAPP-ENTERED  PIC X.
  1344            20  PI-PAYEE-ENTERED    PIC X(10).
  1345            20  PI-CERTID-ENTERED   PIC X(5).
  1346            20  PI-REASONS-ENTERED  PIC X(84).
  1347            20  PI-CERTNT1-ENTERED  PIC X(63).
  1348            20  PI-CERTNT2-ENTERED  PIC X(63).
  1349        16  PI-FINALIZED-IND        PIC X.
  1350        16  PI-CERTNT3-ENTERED      PIC X(63).
  1351        16  PI-CERTNT4-ENTERED      PIC X(63).
  1352        16  PI-BILLNT1-ENTERED      PIC X(63).
  1353        16  PI-BILLNT2-ENTERED      PIC X(63).
  1354        16  PI-REASON-CODE-IND      PIC X(26).
  1355        16  FILLER                  PIC X(2).
  1356    12  FILLER                      PIC X(276).
  1357*    COPY ELCAID.
  1358******************************************************************
  1359*                                                                *
  1360*                            ELCAID.                             *
  1361*                            VMOD=2.001                          *
  1362*                                                                *
  1363*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1364*                                                                *
  1365*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1366*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1367******************************************************************
  1368
  1369 01  DFHAID.
  1370   02  DFHNULL   PIC  X  VALUE  ' '.
  1371   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1372   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1373   02  DFHPEN    PIC  X  VALUE  '='.
  1374   02  DFHOPID   PIC  X  VALUE  'W'.
  1375   02  DFHPA1    PIC  X  VALUE  '%'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  26
* EL6318.cbl
  1376   02  DFHPA2    PIC  X  VALUE  '>'.
  1377   02  DFHPA3    PIC  X  VALUE  ','.
  1378   02  DFHPF1    PIC  X  VALUE  '1'.
  1379   02  DFHPF2    PIC  X  VALUE  '2'.
  1380   02  DFHPF3    PIC  X  VALUE  '3'.
  1381   02  DFHPF4    PIC  X  VALUE  '4'.
  1382   02  DFHPF5    PIC  X  VALUE  '5'.
  1383   02  DFHPF6    PIC  X  VALUE  '6'.
  1384   02  DFHPF7    PIC  X  VALUE  '7'.
  1385   02  DFHPF8    PIC  X  VALUE  '8'.
  1386   02  DFHPF9    PIC  X  VALUE  '9'.
  1387   02  DFHPF10   PIC  X  VALUE  ':'.
  1388   02  DFHPF11   PIC  X  VALUE  '#'.
  1389   02  DFHPF12   PIC  X  VALUE  '@'.
  1390   02  DFHPF13   PIC  X  VALUE  'A'.
  1391   02  DFHPF14   PIC  X  VALUE  'B'.
  1392   02  DFHPF15   PIC  X  VALUE  'C'.
  1393   02  DFHPF16   PIC  X  VALUE  'D'.
  1394   02  DFHPF17   PIC  X  VALUE  'E'.
  1395   02  DFHPF18   PIC  X  VALUE  'F'.
  1396   02  DFHPF19   PIC  X  VALUE  'G'.
  1397   02  DFHPF20   PIC  X  VALUE  'H'.
  1398   02  DFHPF21   PIC  X  VALUE  'I'.
  1399*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1400   02  DFHPF22   PIC  X  VALUE  '['.
  1401   02  DFHPF23   PIC  X  VALUE  '.'.
  1402   02  DFHPF24   PIC  X  VALUE  '<'.
  1403   02  DFHMSRE   PIC  X  VALUE  'X'.
  1404   02  DFHSTRF   PIC  X  VALUE  'h'.
  1405   02  DFHTRIG   PIC  X  VALUE  '"'.
  1406 01  FILLER    REDEFINES DFHAID.
  1407     12  FILLER              PIC X(8).
  1408     12  PF-VALUES           PIC X       OCCURS 24 TIMES.
  1409     12  FILLER              PIC X(3).
  1410*   COPY EL6318S.
  1411 01  EL631KI.
  1412     05  FILLER            PIC  X(0012).
  1413*    -------------------------------
  1414     05  DATEL PIC S9(0004) COMP.
  1415     05  DATEF PIC  X(0001).
  1416     05  FILLER REDEFINES DATEF.
  1417         10  DATEA PIC  X(0001).
  1418     05  DATEI PIC  X(0008).
  1419*    -------------------------------
  1420     05  TIMEL PIC S9(0004) COMP.
  1421     05  TIMEF PIC  X(0001).
  1422     05  FILLER REDEFINES TIMEF.
  1423         10  TIMEA PIC  X(0001).
  1424     05  TIMEI PIC  X(0005).
  1425*    -------------------------------
  1426     05  PROCIDL PIC S9(0004) COMP.
  1427     05  PROCIDF PIC  X(0001).
  1428     05  FILLER REDEFINES PROCIDF.
  1429         10  PROCIDA PIC  X(0001).
  1430     05  PROCIDI PIC  X(0004).
  1431*    -------------------------------
  1432     05  HOSTL PIC S9(0004) COMP.
  1433     05  HOSTF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  27
* EL6318.cbl
  1434     05  FILLER REDEFINES HOSTF.
  1435         10  HOSTA PIC  X(0001).
  1436     05  HOSTI PIC  X(0009).
  1437*    -------------------------------
  1438     05  SYSL PIC S9(0004) COMP.
  1439     05  SYSF PIC  X(0001).
  1440     05  FILLER REDEFINES SYSF.
  1441         10  SYSA PIC  X(0001).
  1442     05  SYSI PIC  X(0005).
  1443*    -------------------------------
  1444     05  COMPANYL PIC S9(0004) COMP.
  1445     05  COMPANYF PIC  X(0001).
  1446     05  FILLER REDEFINES COMPANYF.
  1447         10  COMPANYA PIC  X(0001).
  1448     05  COMPANYI PIC  X(0003).
  1449*    -------------------------------
  1450     05  DATASORL PIC S9(0004) COMP.
  1451     05  DATASORF PIC  X(0001).
  1452     05  FILLER REDEFINES DATASORF.
  1453         10  DATASORA PIC  X(0001).
  1454     05  DATASORI PIC  X(0001).
  1455*    -------------------------------
  1456     05  BATCHNOL PIC S9(0004) COMP.
  1457     05  BATCHNOF PIC  X(0001).
  1458     05  FILLER REDEFINES BATCHNOF.
  1459         10  BATCHNOA PIC  X(0001).
  1460     05  BATCHNOI PIC  X(0006).
  1461*    -------------------------------
  1462     05  BSEQNOL PIC S9(0004) COMP.
  1463     05  BSEQNOF PIC  X(0001).
  1464     05  FILLER REDEFINES BSEQNOF.
  1465         10  BSEQNOA PIC  X(0001).
  1466     05  BSEQNOI PIC  X(0008).
  1467*    -------------------------------
  1468     05  ARCHNOL PIC S9(0004) COMP.
  1469     05  ARCHNOF PIC  X(0001).
  1470     05  FILLER REDEFINES ARCHNOF.
  1471         10  ARCHNOA PIC  X(0001).
  1472     05  ARCHNOI PIC  X(0008).
  1473*    -------------------------------
  1474     05  PRTSWL PIC S9(0004) COMP.
  1475     05  PRTSWF PIC  X(0001).
  1476     05  FILLER REDEFINES PRTSWF.
  1477         10  PRTSWA PIC  X(0001).
  1478     05  PRTSWI PIC  X(0001).
  1479*    -------------------------------
  1480     05  CARRL PIC S9(0004) COMP.
  1481     05  CARRF PIC  X(0001).
  1482     05  FILLER REDEFINES CARRF.
  1483         10  CARRA PIC  X(0001).
  1484     05  CARRI PIC  X(0001).
  1485*    -------------------------------
  1486     05  GROUPL PIC S9(0004) COMP.
  1487     05  GROUPF PIC  X(0001).
  1488     05  FILLER REDEFINES GROUPF.
  1489         10  GROUPA PIC  X(0001).
  1490     05  GROUPI PIC  X(0006).
  1491*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  28
* EL6318.cbl
  1492     05  STATEL PIC S9(0004) COMP.
  1493     05  STATEF PIC  X(0001).
  1494     05  FILLER REDEFINES STATEF.
  1495         10  STATEA PIC  X(0001).
  1496     05  STATEI PIC  X(0002).
  1497*    -------------------------------
  1498     05  ACCTL PIC S9(0004) COMP.
  1499     05  ACCTF PIC  X(0001).
  1500     05  FILLER REDEFINES ACCTF.
  1501         10  ACCTA PIC  X(0001).
  1502     05  ACCTI PIC  X(0010).
  1503*    -------------------------------
  1504     05  EFFDTL PIC S9(0004) COMP.
  1505     05  EFFDTF PIC  X(0001).
  1506     05  FILLER REDEFINES EFFDTF.
  1507         10  EFFDTA PIC  X(0001).
  1508     05  EFFDTI PIC  X(0008).
  1509*    -------------------------------
  1510     05  CERTNOL PIC S9(0004) COMP.
  1511     05  CERTNOF PIC  X(0001).
  1512     05  FILLER REDEFINES CERTNOF.
  1513         10  CERTNOA PIC  X(0001).
  1514     05  CERTNOI PIC  X(0010).
  1515*    -------------------------------
  1516     05  CRTSFXL PIC S9(0004) COMP.
  1517     05  CRTSFXF PIC  X(0001).
  1518     05  FILLER REDEFINES CRTSFXF.
  1519         10  CRTSFXA PIC  X(0001).
  1520     05  CRTSFXI PIC  X(0001).
  1521*    -------------------------------
  1522     05  SEQNOL PIC S9(0004) COMP.
  1523     05  SEQNOF PIC  X(0001).
  1524     05  FILLER REDEFINES SEQNOF.
  1525         10  SEQNOA PIC  X(0001).
  1526     05  SEQNOI PIC  X(0006).
  1527*    -------------------------------
  1528     05  SIGREQL PIC S9(0004) COMP.
  1529     05  SIGREQF PIC  X(0001).
  1530     05  FILLER REDEFINES SIGREQF.
  1531         10  SIGREQA PIC  X(0001).
  1532     05  SIGREQI PIC  X(0001).
  1533*    -------------------------------
  1534     05  LTRIDL PIC S9(0004) COMP.
  1535     05  LTRIDF PIC  X(0001).
  1536     05  FILLER REDEFINES LTRIDF.
  1537         10  LTRIDA PIC  X(0001).
  1538     05  LTRIDI PIC  X(0004).
  1539*    -------------------------------
  1540     05  HLTHAPPL PIC S9(0004) COMP.
  1541     05  HLTHAPPF PIC  X(0001).
  1542     05  FILLER REDEFINES HLTHAPPF.
  1543         10  HLTHAPPA PIC  X(0001).
  1544     05  HLTHAPPI PIC  X(0001).
  1545*    -------------------------------
  1546     05  VOUCHL PIC S9(0004) COMP.
  1547     05  VOUCHF PIC  X(0001).
  1548     05  FILLER REDEFINES VOUCHF.
  1549         10  VOUCHA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  29
* EL6318.cbl
  1550     05  VOUCHI PIC  X(0001).
  1551*    -------------------------------
  1552     05  PAYEEL PIC S9(0004) COMP.
  1553     05  PAYEEF PIC  X(0001).
  1554     05  FILLER REDEFINES PAYEEF.
  1555         10  PAYEEA PIC  X(0001).
  1556     05  PAYEEI PIC  X(0010).
  1557*    -------------------------------
  1558     05  CERTIDL PIC S9(0004) COMP.
  1559     05  CERTIDF PIC  X(0001).
  1560     05  FILLER REDEFINES CERTIDF.
  1561         10  CERTIDA PIC  X(0001).
  1562     05  CERTIDI PIC  X(0005).
  1563*    -------------------------------
  1564     05  RCD01L PIC S9(0004) COMP.
  1565     05  RCD01F PIC  X(0001).
  1566     05  FILLER REDEFINES RCD01F.
  1567         10  RCD01A PIC  X(0001).
  1568     05  RCD01I PIC  X(0004).
  1569*    -------------------------------
  1570     05  RCD02L PIC S9(0004) COMP.
  1571     05  RCD02F PIC  X(0001).
  1572     05  FILLER REDEFINES RCD02F.
  1573         10  RCD02A PIC  X(0001).
  1574     05  RCD02I PIC  X(0004).
  1575*    -------------------------------
  1576     05  RCD03L PIC S9(0004) COMP.
  1577     05  RCD03F PIC  X(0001).
  1578     05  FILLER REDEFINES RCD03F.
  1579         10  RCD03A PIC  X(0001).
  1580     05  RCD03I PIC  X(0004).
  1581*    -------------------------------
  1582     05  RCD04L PIC S9(0004) COMP.
  1583     05  RCD04F PIC  X(0001).
  1584     05  FILLER REDEFINES RCD04F.
  1585         10  RCD04A PIC  X(0001).
  1586     05  RCD04I PIC  X(0004).
  1587*    -------------------------------
  1588     05  RCD05L PIC S9(0004) COMP.
  1589     05  RCD05F PIC  X(0001).
  1590     05  FILLER REDEFINES RCD05F.
  1591         10  RCD05A PIC  X(0001).
  1592     05  RCD05I PIC  X(0004).
  1593*    -------------------------------
  1594     05  RCD06L PIC S9(0004) COMP.
  1595     05  RCD06F PIC  X(0001).
  1596     05  FILLER REDEFINES RCD06F.
  1597         10  RCD06A PIC  X(0001).
  1598     05  RCD06I PIC  X(0004).
  1599*    -------------------------------
  1600     05  RCD07L PIC S9(0004) COMP.
  1601     05  RCD07F PIC  X(0001).
  1602     05  FILLER REDEFINES RCD07F.
  1603         10  RCD07A PIC  X(0001).
  1604     05  RCD07I PIC  X(0004).
  1605*    -------------------------------
  1606     05  RCD08L PIC S9(0004) COMP.
  1607     05  RCD08F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  30
* EL6318.cbl
  1608     05  FILLER REDEFINES RCD08F.
  1609         10  RCD08A PIC  X(0001).
  1610     05  RCD08I PIC  X(0004).
  1611*    -------------------------------
  1612     05  RCD09L PIC S9(0004) COMP.
  1613     05  RCD09F PIC  X(0001).
  1614     05  FILLER REDEFINES RCD09F.
  1615         10  RCD09A PIC  X(0001).
  1616     05  RCD09I PIC  X(0004).
  1617*    -------------------------------
  1618     05  RCD10L PIC S9(0004) COMP.
  1619     05  RCD10F PIC  X(0001).
  1620     05  FILLER REDEFINES RCD10F.
  1621         10  RCD10A PIC  X(0001).
  1622     05  RCD10I PIC  X(0004).
  1623*    -------------------------------
  1624     05  RCD11L PIC S9(0004) COMP.
  1625     05  RCD11F PIC  X(0001).
  1626     05  FILLER REDEFINES RCD11F.
  1627         10  RCD11A PIC  X(0001).
  1628     05  RCD11I PIC  X(0004).
  1629*    -------------------------------
  1630     05  RCD12L PIC S9(0004) COMP.
  1631     05  RCD12F PIC  X(0001).
  1632     05  FILLER REDEFINES RCD12F.
  1633         10  RCD12A PIC  X(0001).
  1634     05  RCD12I PIC  X(0004).
  1635*    -------------------------------
  1636     05  CRTNT1L PIC S9(0004) COMP.
  1637     05  CRTNT1F PIC  X(0001).
  1638     05  FILLER REDEFINES CRTNT1F.
  1639         10  CRTNT1A PIC  X(0001).
  1640     05  CRTNT1I PIC  X(0063).
  1641*    -------------------------------
  1642     05  CRTNT2L PIC S9(0004) COMP.
  1643     05  CRTNT2F PIC  X(0001).
  1644     05  FILLER REDEFINES CRTNT2F.
  1645         10  CRTNT2A PIC  X(0001).
  1646     05  CRTNT2I PIC  X(0063).
  1647*    -------------------------------
  1648     05  CRTNT3L PIC S9(0004) COMP.
  1649     05  CRTNT3F PIC  X(0001).
  1650     05  FILLER REDEFINES CRTNT3F.
  1651         10  CRTNT3A PIC  X(0001).
  1652     05  CRTNT3I PIC  X(0063).
  1653*    -------------------------------
  1654     05  CRTNT4L PIC S9(0004) COMP.
  1655     05  CRTNT4F PIC  X(0001).
  1656     05  FILLER REDEFINES CRTNT4F.
  1657         10  CRTNT4A PIC  X(0001).
  1658     05  CRTNT4I PIC  X(0063).
  1659*    -------------------------------
  1660     05  BILNT1L PIC S9(0004) COMP.
  1661     05  BILNT1F PIC  X(0001).
  1662     05  FILLER REDEFINES BILNT1F.
  1663         10  BILNT1A PIC  X(0001).
  1664     05  BILNT1I PIC  X(0063).
  1665*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  31
* EL6318.cbl
  1666     05  BILNT2L PIC S9(0004) COMP.
  1667     05  BILNT2F PIC  X(0001).
  1668     05  FILLER REDEFINES BILNT2F.
  1669         10  BILNT2A PIC  X(0001).
  1670     05  BILNT2I PIC  X(0063).
  1671*    -------------------------------
  1672     05  ERRMSG1L PIC S9(0004) COMP.
  1673     05  ERRMSG1F PIC  X(0001).
  1674     05  FILLER REDEFINES ERRMSG1F.
  1675         10  ERRMSG1A PIC  X(0001).
  1676     05  ERRMSG1I PIC  X(0075).
  1677*    -------------------------------
  1678     05  ERRMSG2L PIC S9(0004) COMP.
  1679     05  ERRMSG2F PIC  X(0001).
  1680     05  FILLER REDEFINES ERRMSG2F.
  1681         10  ERRMSG2A PIC  X(0001).
  1682     05  ERRMSG2I PIC  X(0075).
  1683*    -------------------------------
  1684     05  PFENTRL PIC S9(0004) COMP.
  1685     05  PFENTRF PIC  X(0001).
  1686     05  FILLER REDEFINES PFENTRF.
  1687         10  PFENTRA PIC  X(0001).
  1688     05  PFENTRI PIC  9(2).
  1689 01  EL631KO REDEFINES EL631KI.
  1690     05  FILLER            PIC  X(0012).
  1691*    -------------------------------
  1692     05  FILLER            PIC  X(0003).
  1693     05  DATEO PIC  X(0008).
  1694*    -------------------------------
  1695     05  FILLER            PIC  X(0003).
  1696     05  TIMEO PIC  99.99.
  1697*    -------------------------------
  1698     05  FILLER            PIC  X(0003).
  1699     05  PROCIDO PIC  X(0004).
  1700*    -------------------------------
  1701     05  FILLER            PIC  X(0003).
  1702     05  HOSTO PIC  X(0009).
  1703*    -------------------------------
  1704     05  FILLER            PIC  X(0003).
  1705     05  SYSO PIC  X(0005).
  1706*    -------------------------------
  1707     05  FILLER            PIC  X(0003).
  1708     05  COMPANYO PIC  X(0003).
  1709*    -------------------------------
  1710     05  FILLER            PIC  X(0003).
  1711     05  DATASORO PIC  X(0001).
  1712*    -------------------------------
  1713     05  FILLER            PIC  X(0003).
  1714     05  BATCHNOO PIC  X(0006).
  1715*    -------------------------------
  1716     05  FILLER            PIC  X(0003).
  1717     05  BSEQNOO PIC  X(0008).
  1718*    -------------------------------
  1719     05  FILLER            PIC  X(0003).
  1720     05  ARCHNOO PIC  X(0008).
  1721*    -------------------------------
  1722     05  FILLER            PIC  X(0003).
  1723     05  PRTSWO PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  32
* EL6318.cbl
  1724*    -------------------------------
  1725     05  FILLER            PIC  X(0003).
  1726     05  CARRO PIC  X(0001).
  1727*    -------------------------------
  1728     05  FILLER            PIC  X(0003).
  1729     05  GROUPO PIC  X(0006).
  1730*    -------------------------------
  1731     05  FILLER            PIC  X(0003).
  1732     05  STATEO PIC  X(0002).
  1733*    -------------------------------
  1734     05  FILLER            PIC  X(0003).
  1735     05  ACCTO PIC  X(0010).
  1736*    -------------------------------
  1737     05  FILLER            PIC  X(0003).
  1738     05  EFFDTO PIC  X(0008).
  1739*    -------------------------------
  1740     05  FILLER            PIC  X(0003).
  1741     05  CERTNOO PIC  X(0010).
  1742*    -------------------------------
  1743     05  FILLER            PIC  X(0003).
  1744     05  CRTSFXO PIC  X(0001).
  1745*    -------------------------------
  1746     05  FILLER            PIC  X(0003).
  1747     05  SEQNOO PIC  999999.
  1748*    -------------------------------
  1749     05  FILLER            PIC  X(0003).
  1750     05  SIGREQO PIC  X(0001).
  1751*    -------------------------------
  1752     05  FILLER            PIC  X(0003).
  1753     05  LTRIDO PIC  X(0004).
  1754*    -------------------------------
  1755     05  FILLER            PIC  X(0003).
  1756     05  HLTHAPPO PIC  X(0001).
  1757*    -------------------------------
  1758     05  FILLER            PIC  X(0003).
  1759     05  VOUCHO PIC  X(0001).
  1760*    -------------------------------
  1761     05  FILLER            PIC  X(0003).
  1762     05  PAYEEO PIC  X(0010).
  1763*    -------------------------------
  1764     05  FILLER            PIC  X(0003).
  1765     05  CERTIDO PIC  X(0005).
  1766*    -------------------------------
  1767     05  FILLER            PIC  X(0003).
  1768     05  RCD01O PIC  X(0004).
  1769*    -------------------------------
  1770     05  FILLER            PIC  X(0003).
  1771     05  RCD02O PIC  X(0004).
  1772*    -------------------------------
  1773     05  FILLER            PIC  X(0003).
  1774     05  RCD03O PIC  X(0004).
  1775*    -------------------------------
  1776     05  FILLER            PIC  X(0003).
  1777     05  RCD04O PIC  X(0004).
  1778*    -------------------------------
  1779     05  FILLER            PIC  X(0003).
  1780     05  RCD05O PIC  X(0004).
  1781*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  33
* EL6318.cbl
  1782     05  FILLER            PIC  X(0003).
  1783     05  RCD06O PIC  X(0004).
  1784*    -------------------------------
  1785     05  FILLER            PIC  X(0003).
  1786     05  RCD07O PIC  X(0004).
  1787*    -------------------------------
  1788     05  FILLER            PIC  X(0003).
  1789     05  RCD08O PIC  X(0004).
  1790*    -------------------------------
  1791     05  FILLER            PIC  X(0003).
  1792     05  RCD09O PIC  X(0004).
  1793*    -------------------------------
  1794     05  FILLER            PIC  X(0003).
  1795     05  RCD10O PIC  X(0004).
  1796*    -------------------------------
  1797     05  FILLER            PIC  X(0003).
  1798     05  RCD11O PIC  X(0004).
  1799*    -------------------------------
  1800     05  FILLER            PIC  X(0003).
  1801     05  RCD12O PIC  X(0004).
  1802*    -------------------------------
  1803     05  FILLER            PIC  X(0003).
  1804     05  CRTNT1O PIC  X(0063).
  1805*    -------------------------------
  1806     05  FILLER            PIC  X(0003).
  1807     05  CRTNT2O PIC  X(0063).
  1808*    -------------------------------
  1809     05  FILLER            PIC  X(0003).
  1810     05  CRTNT3O PIC  X(0063).
  1811*    -------------------------------
  1812     05  FILLER            PIC  X(0003).
  1813     05  CRTNT4O PIC  X(0063).
  1814*    -------------------------------
  1815     05  FILLER            PIC  X(0003).
  1816     05  BILNT1O PIC  X(0063).
  1817*    -------------------------------
  1818     05  FILLER            PIC  X(0003).
  1819     05  BILNT2O PIC  X(0063).
  1820*    -------------------------------
  1821     05  FILLER            PIC  X(0003).
  1822     05  ERRMSG1O PIC  X(0075).
  1823*    -------------------------------
  1824     05  FILLER            PIC  X(0003).
  1825     05  ERRMSG2O PIC  X(0075).
  1826*    -------------------------------
  1827     05  FILLER            PIC  X(0003).
  1828     05  PFENTRO PIC  X(0002).
  1829*    -------------------------------
  1830 01  FILLER REDEFINES EL631KI.
  1831     12  FILLER             PIC X(211).
  1832     12  REASONCDS.
  1833         16  FILLER OCCURS 12.
  1834           20  REACDL       PIC S9(4) COMP.
  1835           20  REACDA       PIC X.
  1836           20  REACD-IN     PIC X(4).
  1837     12  FILLER             PIC X(293).
  1838****************************************************************
  1839*
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  34
* EL6318.cbl
  1840* Copyright (c) 2007 by Clerity Solutions, Inc.
  1841* All rights reserved.
  1842*
  1843****************************************************************
  1844 01  DFHEIV.
  1845   02  DFHEIV0               PIC X(35).
  1846   02  DFHEIV1               PIC X(08).
  1847   02  DFHEIV2               PIC X(08).
  1848   02  DFHEIV3               PIC X(08).
  1849   02  DFHEIV4               PIC X(06).
  1850   02  DFHEIV5               PIC X(04).
  1851   02  DFHEIV6               PIC X(04).
  1852   02  DFHEIV7               PIC X(02).
  1853   02  DFHEIV8               PIC X(02).
  1854   02  DFHEIV9               PIC X(01).
  1855   02  DFHEIV10              PIC S9(7) COMP-3.
  1856   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1857   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1858   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1859   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1860   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1861   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1862   02  DFHEIV17              PIC X(04).
  1863   02  DFHEIV18              PIC X(04).
  1864   02  DFHEIV19              PIC X(04).
  1865   02  DFHEIV20              USAGE IS POINTER.
  1866   02  DFHEIV21              USAGE IS POINTER.
  1867   02  DFHEIV22              USAGE IS POINTER.
  1868   02  DFHEIV23              USAGE IS POINTER.
  1869   02  DFHEIV24              USAGE IS POINTER.
  1870   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1871   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1872   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1873   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1874   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1875   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1876   02  FILLER                PIC X(02).
  1877   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1878   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1879   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1880   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1881   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1882 LINKAGE  SECTION.
  1883*****************************************************************
  1884*                                                               *
  1885* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1886* All rights reserved.                                          *
  1887*                                                               *
  1888*****************************************************************
  1889 01  dfheiblk.
  1890     02  eibtime          pic s9(7) comp-3.
  1891     02  eibdate          pic s9(7) comp-3.
  1892     02  eibtrnid         pic x(4).
  1893     02  eibtaskn         pic s9(7) comp-3.
  1894     02  eibtrmid         pic x(4).
  1895     02  dfheigdi         pic s9(4) comp.
  1896     02  eibcposn         pic s9(4) comp.
  1897     02  eibcalen         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  35
* EL6318.cbl
  1898     02  eibaid           pic x(1).
  1899     02  eibfiller1       pic x(1).
  1900     02  eibfn            pic x(2).
  1901     02  eibfiller2       pic x(2).
  1902     02  eibrcode         pic x(6).
  1903     02  eibfiller3       pic x(2).
  1904     02  eibds            pic x(8).
  1905     02  eibreqid         pic x(8).
  1906     02  eibrsrce         pic x(8).
  1907     02  eibsync          pic x(1).
  1908     02  eibfree          pic x(1).
  1909     02  eibrecv          pic x(1).
  1910     02  eibsend          pic x(1).
  1911     02  eibatt           pic x(1).
  1912     02  eibeoc           pic x(1).
  1913     02  eibfmh           pic x(1).
  1914     02  eibcompl         pic x(1).
  1915     02  eibsig           pic x(1).
  1916     02  eibconf          pic x(1).
  1917     02  eiberr           pic x(1).
  1918     02  eibrldbk         pic x(1).
  1919     02  eiberrcd         pic x(4).
  1920     02  eibsynrb         pic x(1).
  1921     02  eibnodat         pic x(1).
  1922     02  eibfiller5       pic x(2).
  1923     02  eibresp          pic 9(09) comp.
  1924     02  eibresp2         pic 9(09) comp.
  1925     02  dfheigdj         pic s9(4) comp.
  1926     02  dfheigdk         pic s9(4) comp.
  1927 01  DFHCOMMAREA                 PIC X(1300).
  1928 01  var  pic x(30).
  1929*                                COPY ERCACCT.
  1930******************************************************************
  1931*                                                                *
  1932*                                                                *
  1933*                            ERCACCT                             *
  1934*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1935*                            VMOD=2.031                          *
  1936*                                                                *
  1937*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  1938*                                                                *
  1939*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  1940*   VSAM ACCOUNT MASTER FILES.                                   *
  1941*                                                                *
  1942*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  1943*                                                                *
  1944*   FILE TYPE = VSAM,KSDS                                        *
  1945*   RECORD SIZE = 2000  RECFORM = FIX                            *
  1946*                                                                *
  1947*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  1948*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  1949*                                                                *
  1950*   LOG = NO                                                     *
  1951*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1952*                                                                *
  1953*                                                                *
  1954******************************************************************
  1955*                   C H A N G E   L O G
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  36
* EL6318.cbl
  1956*
  1957* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1958*-----------------------------------------------------------------
  1959*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1960* EFFECTIVE    NUMBER
  1961*-----------------------------------------------------------------
  1962* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  1963* 092705    2005050300006  PEMA  ADD SPP LEASES
  1964* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  1965* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1966* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  1967* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  1968* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  1969******************************************************************
  1970
  1971 01  ACCOUNT-MASTER.
  1972     12  AM-RECORD-ID                      PIC XX.
  1973         88  VALID-AM-ID                      VALUE 'AM'.
  1974
  1975     12  AM-CONTROL-PRIMARY.
  1976         16  AM-COMPANY-CD                 PIC X.
  1977         16  AM-MSTR-CNTRL.
  1978             20  AM-CONTROL-A.
  1979                 24  AM-CARRIER            PIC X.
  1980                 24  AM-GROUPING.
  1981                     28 AM-GROUPING-PREFIX PIC XXX.
  1982                     28 AM-GROUPING-PRIME  PIC XXX.
  1983                 24  AM-STATE              PIC XX.
  1984                 24  AM-ACCOUNT.
  1985                     28  AM-ACCOUNT-PREFIX PIC X(4).
  1986                     28  AM-ACCOUNT-PRIME  PIC X(6).
  1987             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  1988                                           PIC X(19).
  1989             20  AM-CNTRL-B.
  1990                 24  AM-EXPIRATION-DT      PIC XX.
  1991                 24  FILLER                PIC X(4).
  1992             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  1993                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  1994
  1995     12  AM-CONTROL-BY-VAR-GRP.
  1996         16  AM-COMPANY-CD-A1              PIC X.
  1997         16  AM-VG-CARRIER                 PIC X.
  1998         16  AM-VG-GROUPING                PIC X(6).
  1999         16  AM-VG-STATE                   PIC XX.
  2000         16  AM-VG-ACCOUNT                 PIC X(10).
  2001         16  AM-VG-DATE.
  2002             20  AM-VG-EXPIRATION-DT       PIC XX.
  2003             20  FILLER                    PIC X(4).
  2004         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  2005                                           PIC 9(11)      COMP-3.
  2006     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  2007         16  FILLER                        PIC X(10).
  2008         16  AM-VG-KEY3.
  2009             20  AM-VG3-ACCOUNT            PIC X(10).
  2010             20  AM-VG3-EXP-DT             PIC XX.
  2011         16  FILLER                        PIC X(4).
  2012     12  AM-MAINT-INFORMATION.
  2013         16  AM-LAST-MAINT-DT              PIC XX.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  37
* EL6318.cbl
  2014         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2015         16  AM-LAST-MAINT-USER            PIC X(4).
  2016         16  FILLER                        PIC XX.
  2017
  2018     12  AM-EFFECTIVE-DT                   PIC XX.
  2019     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  2020
  2021     12  AM-PREV-DATES  COMP-3.
  2022         16  AM-PREV-EXP-DT                PIC 9(11).
  2023         16  AM-PREV-EFF-DT                PIC 9(11).
  2024
  2025     12  AM-REPORT-CODE-1                  PIC X(10).
  2026     12  AM-REPORT-CODE-2                  PIC X(10).
  2027
  2028     12  AM-CITY-CODE                      PIC X(4).
  2029     12  AM-COUNTY-PARISH                  PIC X(6).
  2030
  2031     12  AM-NAME                           PIC X(30).
  2032     12  AM-PERSON                         PIC X(30).
  2033     12  AM-ADDRS                          PIC X(30).
  2034     12  AM-CITY.
  2035         16  AM-ADDR-CITY                  PIC X(28).
  2036         16  AM-ADDR-STATE                 PIC XX.
  2037     12  AM-ZIP.
  2038         16  AM-ZIP-PRIME.
  2039             20  AM-ZIP-PRI-1ST            PIC X.
  2040                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  2041             20  FILLER                    PIC X(4).
  2042         16  AM-ZIP-PLUS4                  PIC X(4).
  2043     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  2044         16  AM-CAN-POSTAL-1               PIC XXX.
  2045         16  AM-CAN-POSTAL-2               PIC XXX.
  2046         16  FILLER                        PIC XXX.
  2047     12  AM-TEL-NO.
  2048         16  AM-AREA-CODE                  PIC 999.
  2049         16  AM-TEL-PRE                    PIC 999.
  2050         16  AM-TEL-NBR                    PIC 9(4).
  2051     12  AM-TEL-LOC                        PIC X.
  2052         88  AM-TEL-AT-HOME                   VALUE 'H'.
  2053         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  2054
  2055     12  AM-COMM-STRUCTURE.
  2056         16  AM-DEFN-1.
  2057             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  2058                 24  AM-AGT.
  2059                     28  AM-AGT-PREFIX     PIC X(4).
  2060                     28  AM-AGT-PRIME      PIC X(6).
  2061                 24  AM-COM-TYP            PIC X.
  2062                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  2063                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  2064                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  2065                 24  AM-RECALC-LV-INDIC    PIC X.
  2066                 24  AM-RETRO-LV-INDIC     PIC X.
  2067                 24  AM-GL-CODES           PIC X.
  2068                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  2069                 24  FILLER                PIC X(01).
  2070         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  2071             20  AM-COM-TBLS        OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  38
* EL6318.cbl
  2072                 24  FILLER                PIC X(11).
  2073                 24  AM-L-COMA             PIC XXX.
  2074                 24  AM-J-COMA             PIC XXX.
  2075                 24  AM-A-COMA             PIC XXX.
  2076                 24  FILLER                PIC X(6).
  2077
  2078     12  AM-COMM-CHANGE-STATUS             PIC X.
  2079         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  2080
  2081     12  AM-CSR-CODE                       PIC X(4).
  2082
  2083     12  AM-BILLING-STATUS                 PIC X.
  2084         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  2085         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  2086     12  AM-AUTO-REFUND-SW                 PIC X.
  2087         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  2088         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  2089     12  AM-GPCD                           PIC 99.
  2090     12  AM-IG                             PIC X.
  2091         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  2092         88  AM-HAS-GROUP                     VALUE '2'.
  2093     12  AM-STATUS                         PIC X.
  2094         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  2095         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  2096         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  2097         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  2098         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  2099         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  2100     12  AM-REMIT-TO                       PIC 99.
  2101     12  AM-ID-NO                          PIC X(11).
  2102
  2103     12  AM-CAL-TABLE                      PIC XX.
  2104     12  AM-LF-DEVIATION                   PIC XXX.
  2105     12  AM-AH-DEVIATION                   PIC XXX.
  2106     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2107     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2108     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  2109     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  2110     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2111     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2112
  2113     12  AM-USER-FIELDS.
  2114         16  AM-FLD-1                      PIC XX.
  2115         16  AM-FLD-2                      PIC XX.
  2116         16  AM-FLD-3                      PIC XX.
  2117         16  AM-FLD-4                      PIC XX.
  2118         16  AM-FLD-5                      PIC XX.
  2119
  2120     12  AM-1ST-PROD-DATE.
  2121         16  AM-1ST-PROD-YR                PIC XX.
  2122         16  AM-1ST-PROD-MO                PIC XX.
  2123         16  AM-1ST-PROD-DA                PIC XX.
  2124     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  2125     12  AM-CERTS-PURGED-DATE.
  2126         16  AM-PUR-YR                     PIC XX.
  2127         16  AM-PUR-MO                     PIC XX.
  2128         16  AM-PUR-DA                     PIC XX.
  2129     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  39
* EL6318.cbl
  2130     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  2131     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  2132     12  AM-INACTIVE-DATE.
  2133         16  AM-INA-MO                     PIC 99.
  2134         16  AM-INA-DA                     PIC 99.
  2135         16  AM-INA-YR                     PIC 99.
  2136     12  AM-AR-HI-CERT-DATE                PIC XX.
  2137
  2138     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2139     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2140
  2141     12  AM-OB-PAYMENT-MODE                PIC X.
  2142         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  2143         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  2144         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  2145         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  2146
  2147     12  AM-AH-ONLY-INDICATOR              PIC X.
  2148         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  2149         88  AM-NO-AH-ONLY                    VALUE 'N'.
  2150
  2151     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  2152
  2153     12  AM-OVER-SHORT.
  2154         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  2155         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  2156
  2157     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  2158     12  AM-DCC-CLP-STATE                  PIC XX.
  2159
  2160     12  AM-RECALC-COMM                    PIC X.
  2161     12  AM-RECALC-REIN                    PIC X.
  2162
  2163     12  AM-REI-TABLE                      PIC XXX.
  2164     12  AM-REI-ET-LF                      PIC X.
  2165     12  AM-REI-ET-AH                      PIC X.
  2166     12  AM-REI-PE-LF                      PIC X.
  2167     12  AM-REI-PE-AH                      PIC X.
  2168     12  AM-REI-PRT-ST                     PIC X.
  2169     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  2170     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  2171     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  2172     12  AM-REI-GROUP-A                    PIC X(6).
  2173     12  AM-REI-MORT                       PIC X(4).
  2174     12  AM-REI-PRT-OW                     PIC X.
  2175     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  2176     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  2177     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  2178     12  AM-REI-GROUP-B                    PIC X(6).
  2179
  2180     12  AM-TRUST-TYPE                     PIC X(2).
  2181
  2182     12  AM-EMPLOYER-STMT-USED             PIC X.
  2183     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  2184
  2185     12  AM-STD-AH-TYPE                    PIC XX.
  2186     12  AM-EARN-METHODS.
  2187         16  AM-EARN-METHOD-R              PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  40
* EL6318.cbl
  2188             88 AM-REF-RL-R78                 VALUE 'R'.
  2189             88 AM-REF-RL-PR                  VALUE 'P'.
  2190             88 AM-REF-RL-MEAN                VALUE 'M'.
  2191             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  2192         16  AM-EARN-METHOD-L              PIC X.
  2193             88 AM-REF-LL-R78                 VALUE 'R'.
  2194             88 AM-REF-LL-PR                  VALUE 'P'.
  2195             88 AM-REF-LL-MEAN                VALUE 'M'.
  2196             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  2197         16  AM-EARN-METHOD-A              PIC X.
  2198             88 AM-REF-AH-R78                 VALUE 'R'.
  2199             88 AM-REF-AH-PR                  VALUE 'P'.
  2200             88 AM-REF-AH-MEAN                VALUE 'M'.
  2201             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  2202             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  2203             88 AM-REF-AH-NET                 VALUE 'N'.
  2204
  2205     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  2206     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  2207     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  2208
  2209     12  AM-RET-Y-N                        PIC X.
  2210     12  AM-RET-P-E                        PIC X.
  2211     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  2212     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  2213     12  AM-RET-GRP                        PIC X(6).
  2214     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  2215         16  AM-POOL-PRIME                 PIC XXX.
  2216         16  AM-POOL-SUB                   PIC XXX.
  2217     12  AM-RETRO-EARNINGS.
  2218         16  AM-RET-EARN-R                 PIC X.
  2219         16  AM-RET-EARN-L                 PIC X.
  2220         16  AM-RET-EARN-A                 PIC X.
  2221     12  AM-RET-ST-TAX-USE                 PIC X.
  2222         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  2223         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  2224     12  AM-RETRO-BEG-EARNINGS.
  2225         16  AM-RET-BEG-EARN-R             PIC X.
  2226         16  AM-RET-BEG-EARN-L             PIC X.
  2227         16  AM-RET-BEG-EARN-A             PIC X.
  2228     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  2229     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  2230
  2231     12  AM-USER-SELECT-OPTIONS.
  2232         16  AM-USER-SELECT-1              PIC X(10).
  2233         16  AM-USER-SELECT-2              PIC X(10).
  2234         16  AM-USER-SELECT-3              PIC X(10).
  2235         16  AM-USER-SELECT-4              PIC X(10).
  2236         16  AM-USER-SELECT-5              PIC X(10).
  2237
  2238     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2239
  2240     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2241
  2242     12  AM-RPT045A-SWITCH                 PIC X.
  2243         88  RPT045A-OFF                   VALUE 'N'.
  2244
  2245     12  AM-INSURANCE-LIMITS.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  41
* EL6318.cbl
  2246         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  2247         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  2248
  2249     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  2250         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  2251
  2252     12  AM-DISMBR-COVERAGE-SW             PIC X.
  2253         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  2254         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  2255
  2256     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  2257
  2258     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  2259     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  2260     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  2261     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  2262     12  AM-DCC-UEF-STATE                  PIC XX.
  2263     12  FILLER                            PIC XXX.
  2264     12  AM-REPORT-CODE-3                  PIC X(10).
  2265*    12  FILLER                            PIC X(22).
  2266
  2267     12  AM-RESERVE-DATE.
  2268         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  2269         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  2270         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  2271
  2272     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  2273     12  AM-NOTIFICATION-TYPES.
  2274         16  AM-NOTIF-OF-LETTERS           PIC X.
  2275         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  2276         16  AM-NOTIF-OF-REPORTS           PIC X.
  2277         16  AM-NOTIF-OF-STATUS            PIC X.
  2278
  2279     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  2280         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  2281         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  2282         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  2283         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  2284
  2285     12  AM-BENEFIT-CONTROLS.
  2286         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  2287             20  AM-BENEFIT-CODE           PIC XX.
  2288             20  AM-BENEFIT-TYPE           PIC X.
  2289             20  AM-BENEFIT-REVISION       PIC XXX.
  2290             20  AM-BENEFIT-REM-TERM       PIC X.
  2291             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  2292             20  FILLER                    PIC XX.
  2293         16  FILLER                        PIC X(80).
  2294
  2295     12  AM-TRANSFER-DATA.
  2296         16  AM-TRANSFERRED-FROM.
  2297             20  AM-TRNFROM-CARRIER        PIC X.
  2298             20  AM-TRNFROM-GROUPING.
  2299                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  2300                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  2301             20  AM-TRNFROM-STATE          PIC XX.
  2302             20  AM-TRNFROM-ACCOUNT.
  2303                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  42
* EL6318.cbl
  2304                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  2305             20  AM-TRNFROM-DTE            PIC XX.
  2306         16  AM-TRANSFERRED-TO.
  2307             20  AM-TRNTO-CARRIER          PIC X.
  2308             20  AM-TRNTO-GROUPING.
  2309                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  2310                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  2311             20  AM-TRNTO-STATE            PIC XX.
  2312             20  AM-TRNTO-ACCOUNT.
  2313                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  2314                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  2315             20  AM-TRNTO-DTE              PIC XX.
  2316         16  FILLER                        PIC X(10).
  2317
  2318     12  AM-SAVED-REMIT-TO                 PIC 99.
  2319
  2320     12  AM-COMM-STRUCTURE-SAVED.
  2321         16  AM-DEFN-1-SAVED.
  2322             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  2323                 24  AM-AGT-SV             PIC X(10).
  2324                 24  AM-COM-TYP-SV         PIC X.
  2325                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  2326                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  2327                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  2328                 24  AM-RECALC-LV-INDIC-SV PIC X.
  2329                 24  FILLER                PIC X.
  2330                 24  AM-GL-CODES-SV        PIC X.
  2331                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  2332                 24  FILLER                PIC X.
  2333         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  2334             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  2335                 24  FILLER                PIC X(11).
  2336                 24  AM-L-COMA-SV          PIC XXX.
  2337                 24  AM-J-COMA-SV          PIC XXX.
  2338                 24  AM-A-COMA-SV          PIC XXX.
  2339                 24  FILLER                PIC X(6).
  2340
  2341     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  2342         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  2343            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  2344            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  2345            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  2346
  2347     12  AM-ORIG-DEALER-NO                 PIC X(10).
  2348     12  FILLER                            PIC X(120).
  2349
  2350     12  AM-ACCOUNT-EXECUTIVE-DATA.
  2351         16  AM-CONTROL-NAME               PIC X(30).
  2352         16  AM-EXECUTIVE-ONE.
  2353             20  AM-EXEC1-NAME             PIC X(15).
  2354             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  2355                                                          COMP-3.
  2356             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  2357                                                          COMP-3.
  2358         16  AM-EXECUTIVE-TWO.
  2359             20  AM-EXEC2-NAME             PIC X(15).
  2360             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  2361                                                          COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  43
* EL6318.cbl
  2362             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  2363                                                          COMP-3.
  2364
  2365     12  AM-RETRO-ADDITIONAL-DATA.
  2366         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  2367         16  AM-RETRO-PREM-P-E             PIC X.
  2368         16  AM-RETRO-CLMS-P-I             PIC X.
  2369         16  AM-RETRO-RET-BRACKET-LF.
  2370             20  AM-RETRO-RET-METHOD-LF    PIC X.
  2371                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  2372                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  2373             20  AM-RETRO-RET-BASIS-LF     PIC X.
  2374                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  2375                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  2376             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  2377                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  2378                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  2379         16  AM-RETRO-RET-BRACKET-AH.
  2380             20  AM-RETRO-RET-METHOD-AH    PIC X.
  2381                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  2382                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  2383                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  2384             20  AM-RETRO-RET-BASIS-AH     PIC X.
  2385                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  2386                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  2387             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  2388                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  2389                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  2390
  2391     12  AM-COMMENTS.
  2392         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  2393
  2394     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  2395         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  2396         16  AM-FLI-BILLING-CODE           PIC X.
  2397         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  2398         16  AM-FLI-UNITED-IDENT           PIC X.
  2399         16  AM-FLI-INTEREST-LOST-DATA.
  2400             20  AM-FLI-BANK-NO            PIC X(5).
  2401             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  2402             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  2403             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  2404         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  2405             20  AM-FLI-AGT                PIC X(9).
  2406             20  AM-FLI-AGT-COMM-ACC       PIC X.
  2407             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  2408         16  FILLER                        PIC X(102).
  2409
  2410     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  2411         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  2412             20  AM-BENEFIT-DMD-CODE         PIC XX.
  2413             20  AM-BENEFIT-DMD-TYPE         PIC X.
  2414             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  2415             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  2416             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  2417         16  FILLER                          PIC X(10).
  2418******************************************************************
  2419*                                COPY ELCCNTL.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  44
* EL6318.cbl
  2420******************************************************************
  2421*                                                                *
  2422*                                                                *
  2423*                            ELCCNTL.                            *
  2424*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2425*                            VMOD=2.059                          *
  2426*                                                                *
  2427*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  2428*                                                                *
  2429*   FILE TYPE = VSAM,KSDS                                        *
  2430*   RECORD SIZE = 750  RECFORM = FIXED                           *
  2431*                                                                *
  2432*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  2433*       ALTERNATE INDEX = NONE                                   *
  2434*                                                                *
  2435*   LOG = YES                                                    *
  2436*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2437******************************************************************
  2438*                   C H A N G E   L O G
  2439*
  2440* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2441*-----------------------------------------------------------------
  2442*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2443* EFFECTIVE    NUMBER
  2444*-----------------------------------------------------------------
  2445* 082503                   PEMA  ADD BENEFIT GROUP
  2446* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2447* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2448* 092705    2005050300006  PEMA  ADD SPP LEASES
  2449* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  2450* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  2451* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  2452* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  2453* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  2454* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2455******************************************************************
  2456*
  2457 01  CONTROL-FILE.
  2458     12  CF-RECORD-ID                       PIC XX.
  2459         88  VALID-CF-ID                        VALUE 'CF'.
  2460
  2461     12  CF-CONTROL-PRIMARY.
  2462         16  CF-COMPANY-ID                  PIC XXX.
  2463         16  CF-RECORD-TYPE                 PIC X.
  2464             88  CF-COMPANY-MASTER              VALUE '1'.
  2465             88  CF-PROCESSOR-MASTER            VALUE '2'.
  2466             88  CF-STATE-MASTER                VALUE '3'.
  2467             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  2468             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  2469             88  CF-CARRIER-MASTER              VALUE '6'.
  2470             88  CF-MORTALITY-MASTER            VALUE '7'.
  2471             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  2472             88  CF-TERMINAL-MASTER             VALUE '9'.
  2473             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  2474             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  2475             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  2476             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  2477             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  45
* EL6318.cbl
  2478             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  2479             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  2480             88  CF-REMINDERS-MASTER            VALUE 'R'.
  2481             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  2482         16  CF-ACCESS-CD-GENL              PIC X(4).
  2483         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  2484             20  CF-PROCESSOR               PIC X(4).
  2485         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  2486             20  CF-STATE-CODE              PIC XX.
  2487             20  FILLER                     PIC XX.
  2488         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  2489             20  FILLER                     PIC XX.
  2490             20  CF-HI-BEN-IN-REC           PIC XX.
  2491         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  2492             20  FILLER                     PIC XXX.
  2493             20  CF-CARRIER-CNTL            PIC X.
  2494         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  2495             20  FILLER                     PIC XX.
  2496             20  CF-HI-TYPE-IN-REC          PIC 99.
  2497         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  2498             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  2499                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  2500             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  2501             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  2502         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  2503             20  FILLER                     PIC X.
  2504             20  CF-CUSTOM-REPORT-NO        PIC 999.
  2505         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  2506             20  FILLER                     PIC XX.
  2507             20  CF-MORTGAGE-PLAN           PIC XX.
  2508         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  2509
  2510     12  CF-LAST-MAINT-DT                   PIC XX.
  2511     12  CF-LAST-MAINT-BY                   PIC X(4).
  2512     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2513
  2514     12  CF-RECORD-BODY                     PIC X(728).
  2515
  2516
  2517****************************************************************
  2518*             COMPANY MASTER RECORD                            *
  2519****************************************************************
  2520
  2521     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2522         16  CF-COMPANY-ADDRESS.
  2523             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  2524             20  CF-CL-IN-CARE-OF           PIC X(30).
  2525             20  CF-CL-ADDR-LINE-1          PIC X(30).
  2526             20  CF-CL-ADDR-LINE-2          PIC X(30).
  2527             20  CF-CL-CITY-STATE           PIC X(30).
  2528             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  2529             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  2530         16  CF-COMPANY-CD                  PIC X.
  2531         16  CF-COMPANY-PASSWORD            PIC X(8).
  2532         16  CF-SECURITY-OPTION             PIC X.
  2533             88  ALL-SECURITY                   VALUE '1'.
  2534             88  COMPANY-VERIFY                 VALUE '2'.
  2535             88  PROCESSOR-VERIFY               VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  46
* EL6318.cbl
  2536             88  NO-SECURITY                    VALUE '4'.
  2537             88  ALL-BUT-TERM                   VALUE '5'.
  2538         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  2539             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  2540         16  CF-LGX-INTERFACE-CNTL          PIC X.
  2541             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  2542         16  CF-INFORCE-LOCATION            PIC X.
  2543             88  CERTS-ARE-ONLINE               VALUE '1'.
  2544             88  CERTS-ARE-OFFLINE              VALUE '2'.
  2545             88  NO-CERTS-AVAILABLE             VALUE '3'.
  2546         16  CF-LOWER-CASE-LETTERS          PIC X.
  2547         16  CF-CERT-ACCESS-CONTROL         PIC X.
  2548             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  2549             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2550             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  2551             88  CF-ACCNT-CNTL                  VALUE '3'.
  2552             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  2553
  2554         16  CF-FORMS-PRINTER-ID            PIC X(4).
  2555         16  CF-CHECK-PRINTER-ID            PIC X(4).
  2556
  2557         16  CF-LGX-CREDIT-USER             PIC X.
  2558             88  CO-IS-NOT-USER                 VALUE 'N'.
  2559             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  2560
  2561         16 CF-CREDIT-CALC-CODES.
  2562             20  CF-CR-REM-TERM-CALC PIC X.
  2563               88  CR-EARN-AFTER-15TH           VALUE '1'.
  2564               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  2565               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  2566               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  2567               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  2568               88  CR-EARN-AFTER-14TH           VALUE '6'.
  2569               88  CR-EARN-AFTER-16TH           VALUE '7'.
  2570             20  CF-CR-R78-METHOD           PIC X.
  2571               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  2572               88  DONT-USE-PLUS-ONE            VALUE '1'.
  2573
  2574         16  CF-CLAIM-CONTROL-COUNTS.
  2575             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  2576                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  2577
  2578             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  2579                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  2580
  2581             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  2582                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  2583
  2584             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  2585                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  2586
  2587         16  CF-CURRENT-MONTH-END           PIC XX.
  2588
  2589         16  CF-CO-CALC-QUOTE-TOLERANCE.
  2590             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  2591             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  2592             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  2593             20  CF-CO-CLAIM-REJECT-SW      PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  47
* EL6318.cbl
  2594                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2595                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2596             20  CF-CO-PREM-REJECT-SW       PIC X.
  2597                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  2598                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  2599             20  CF-CO-REF-REJECT-SW        PIC X.
  2600                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  2601                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  2602
  2603         16  CF-CO-REPORTING-DT             PIC XX.
  2604         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  2605         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  2606           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  2607           88  CF-CO-MONTH-END                  VALUE '1'.
  2608
  2609         16  CF-LGX-CLAIM-USER              PIC X.
  2610             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  2611             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  2612
  2613         16  CF-CREDIT-EDIT-CONTROLS.
  2614             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  2615             20  CF-MIN-AGE                 PIC 99.
  2616             20  CF-DEFAULT-AGE             PIC 99.
  2617             20  CF-MIN-TERM                PIC S999      COMP-3.
  2618             20  CF-MAX-TERM                PIC S999      COMP-3.
  2619             20  CF-DEFAULT-SEX             PIC X.
  2620             20  CF-JOINT-AGE-INPUT         PIC X.
  2621                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  2622             20  CF-BIRTH-DATE-INPUT        PIC X.
  2623                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  2624             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  2625                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  2626                 88  CF-ZERO-CARRIER            VALUE '1'.
  2627                 88  CF-ZERO-GROUPING           VALUE '2'.
  2628                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  2629             20  CF-EDIT-SW                 PIC X.
  2630                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  2631             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  2632             20  CF-CR-PR-METHOD            PIC X.
  2633               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  2634               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  2635             20  FILLER                     PIC X.
  2636
  2637         16  CF-CREDIT-MISC-CONTROLS.
  2638             20  CF-REIN-TABLE-SW           PIC X.
  2639                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  2640             20  CF-COMP-TABLE-SW           PIC X.
  2641                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  2642             20  CF-EXPERIENCE-RETENTION-AGE
  2643                                            PIC S9        COMP-3.
  2644             20  CF-CONVERSION-DT           PIC XX.
  2645             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  2646             20  CF-RUN-FREQUENCY-SW        PIC X.
  2647                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  2648                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  2649
  2650             20  CF-CR-CHECK-NO-CONTROL.
  2651                 24  CF-CR-CHECK-NO-METHOD    PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  48
* EL6318.cbl
  2652                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  2653                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  2654                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  2655                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  2656                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  2657
  2658                 24  CF-CR-CHECK-COUNT       REDEFINES
  2659                     CF-CR-CHECK-COUNTER      PIC X(4).
  2660
  2661                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  2662                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  2663
  2664                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  2665                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  2666                 24  CF-MAIL-PROCESSING       PIC X.
  2667                     88  MAIL-PROCESSING          VALUE 'Y'.
  2668
  2669         16  CF-MISC-SYSTEM-CONTROL.
  2670             20  CF-SYSTEM-C                 PIC X.
  2671                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  2672             20  CF-SYSTEM-D                 PIC X.
  2673                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  2674             20  CF-SOC-SEC-NO-SW            PIC X.
  2675                 88  SOC-SEC-NO-USED             VALUE '1'.
  2676             20  CF-MEMBER-NO-SW             PIC X.
  2677                 88  MEMBER-NO-USED              VALUE '1'.
  2678             20  CF-TAX-ID-NUMBER            PIC X(11).
  2679             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  2680             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  2681                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  2682                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  2683                 88  CF-ALL-APPROVED             VALUE 'Y'.
  2684                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  2685             20  CF-SYSTEM-E                 PIC X.
  2686                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  2687
  2688         16  CF-LGX-LIFE-USER               PIC X.
  2689             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  2690             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  2691
  2692         16  CF-CR-MONTH-END-DT             PIC XX.
  2693
  2694         16  CF-FILE-MAINT-DATES.
  2695             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  2696                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  2697             20  CF-LAST-BATCH       REDEFINES
  2698                 CF-LAST-BATCH-NO               PIC X(4).
  2699             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  2700             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  2701             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  2702             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  2703             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  2704             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  2705             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  2706             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  2707             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  2708             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  2709
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  49
* EL6318.cbl
  2710         16  CF-NEXT-COMPANY-ID             PIC XXX.
  2711         16  FILLER                         PIC X.
  2712
  2713         16  CF-ALT-MORT-CODE               PIC X(4).
  2714         16  CF-MEMBER-CAPTION              PIC X(10).
  2715
  2716         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  2717             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  2718             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  2719             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  2720             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  2721             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  2722
  2723         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  2724
  2725         16  CF-LIFE-OVERRIDE-L1            PIC X.
  2726         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  2727         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  2728         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  2729
  2730         16  CF-AH-OVERRIDE-L1              PIC X.
  2731         16  CF-AH-OVERRIDE-L2              PIC XX.
  2732         16  CF-AH-OVERRIDE-L6              PIC X(6).
  2733         16  CF-AH-OVERRIDE-L12             PIC X(12).
  2734
  2735         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  2736         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  2737
  2738         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  2739         16  CF-AR-LAST-EL860-DT            PIC XX.
  2740         16  CF-MP-MONTH-END-DT             PIC XX.
  2741
  2742         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  2743         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  2744             88  CF-CLAIM-PAID-TO               VALUE '1'.
  2745
  2746         16  CF-AR-MONTH-END-DT             PIC XX.
  2747
  2748         16  CF-CRDTCRD-USER                PIC X.
  2749             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  2750             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  2751
  2752         16  CF-CC-MONTH-END-DT             PIC XX.
  2753
  2754         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  2755
  2756         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  2757             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  2758             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  2759             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  2760         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  2761         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  2762         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  2763         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  2764             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  2765             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  2766         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  2767         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  50
* EL6318.cbl
  2768         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  2769             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  2770         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  2771
  2772         16  CF-CL-ZIP-CODE.
  2773             20  CF-CL-ZIP-PRIME.
  2774                 24  CF-CL-ZIP-1ST          PIC X.
  2775                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  2776                 24  FILLER                 PIC X(4).
  2777             20  CF-CL-ZIP-PLUS4            PIC X(4).
  2778         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  2779             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  2780             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  2781             20  FILLER                     PIC XXX.
  2782
  2783         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  2784         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  2785         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  2786         16  CF-CO-OPTION-START-DATE        PIC XX.
  2787         16  CF-REM-TRM-CALC-OPTION         PIC X.
  2788           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  2789                                                      '3' '4'.
  2790           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  2791           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  2792           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  2793           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  2794           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  2795           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  2796
  2797         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  2798
  2799         16  CF-PAYMENT-APPROVAL-LEVELS.
  2800             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  2801             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  2802             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  2803             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  2804             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  2805             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  2806
  2807         16  CF-END-USER-REPORTING-USER     PIC X.
  2808             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  2809             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  2810
  2811         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  2812             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  2813             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  2814
  2815         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  2816
  2817         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  2818         16  FILLER                         PIC X.
  2819
  2820         16  CF-CREDIT-ARCHIVE-CNTL.
  2821             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  2822             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  2823             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  2824
  2825         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  51
* EL6318.cbl
  2826
  2827         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  2828             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  2829             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  2830
  2831         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  2832             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  2833             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  2834
  2835         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  2836
  2837         16  CF-CO-ACH-ID-CODE              PIC  X.
  2838             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  2839             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  2840             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  2841         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  2842         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  2843         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  2844         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  2845         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  2846         16  CF-CO-ACH-RECV-NO              PIC X(08).
  2847         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  2848         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  2849         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  2850                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  2851         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  2852                 CF-CO-ACH-TRACE-NO         PIC X(4).
  2853
  2854         16  CF-CO-OVER-SHORT.
  2855             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2856             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2857
  2858*         16  FILLER                         PIC X(102).
  2859         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  2860             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  2861             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  2862
  2863         16  CF-AH-APPROVAL-DAYS.
  2864             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  2865             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  2866             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  2867             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  2868
  2869         16  FILLER                         PIC X(82).
  2870****************************************************************
  2871*             PROCESSOR/USER RECORD                            *
  2872****************************************************************
  2873
  2874     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2875         16  CF-PROCESSOR-NAME              PIC X(30).
  2876         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  2877         16  CF-PROCESSOR-TITLE             PIC X(26).
  2878         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  2879                 88  MESSAGE-YES                VALUE 'Y'.
  2880                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  2881
  2882*****************************************************
  2883****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  52
* EL6318.cbl
  2884****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  2885****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  2886****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  2887*****************************************************
  2888
  2889         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  2890             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  2891             20  CF-APPLICATION-FORCE       PIC X.
  2892             20  CF-INDIVIDUAL-APP.
  2893                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  2894                     28  CF-BROWSE-APP      PIC X.
  2895                     28  CF-UPDATE-APP      PIC X.
  2896
  2897         16  CF-CURRENT-TERM-ON             PIC X(4).
  2898         16  CF-PROCESSOR-LIMITS-CLAIMS.
  2899             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  2900             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  2901             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  2902             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  2903             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  2904             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  2905             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  2906         16  CF-PROCESSOR-CARRIER           PIC X.
  2907             88  NO-CARRIER-SECURITY            VALUE ' '.
  2908         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  2909             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  2910         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  2911             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  2912         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  2913             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  2914
  2915         16  CF-PROC-SYS-ACCESS-SW.
  2916             20  CF-PROC-CREDIT-CLAIMS-SW.
  2917                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  2918                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  2919                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  2920                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  2921             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  2922                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  2923                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  2924             20  CF-PROC-LIFE-GNRLDGR-SW.
  2925                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  2926                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  2927                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  2928                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  2929             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  2930                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  2931                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  2932         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  2933             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  2934             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  2935         16  CF-PROCESSOR-PRINTER               PIC X(4).
  2936
  2937         16  CF-APPROVAL-LEVEL                  PIC X.
  2938             88  APPROVAL-LEVEL-1                   VALUE '1'.
  2939             88  APPROVAL-LEVEL-2                   VALUE '2'.
  2940             88  APPROVAL-LEVEL-3                   VALUE '3'.
  2941             88  APPROVAL-LEVEL-4                   VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  53
* EL6318.cbl
  2942
  2943         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  2944
  2945         16  CF-LANGUAGE-TYPE                   PIC X.
  2946             88  CF-LANG-IS-ENG                     VALUE 'E'.
  2947             88  CF-LANG-IS-FR                      VALUE 'F'.
  2948
  2949         16  CF-CSR-IND                         PIC X.
  2950         16  FILLER                             PIC X(239).
  2951
  2952****************************************************************
  2953*             PROCESSOR/REMINDERS RECORD                       *
  2954****************************************************************
  2955
  2956     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  2957         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  2958             20  CF-START-REMIND-DT         PIC XX.
  2959             20  CF-END-REMIND-DT           PIC XX.
  2960             20  CF-REMINDER-TEXT           PIC X(50).
  2961         16  FILLER                         PIC X(296).
  2962
  2963
  2964****************************************************************
  2965*             STATE MASTER RECORD                              *
  2966****************************************************************
  2967
  2968     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2969         16  CF-STATE-ABBREVIATION          PIC XX.
  2970         16  CF-STATE-NAME                  PIC X(25).
  2971         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  2972         16  CF-ST-CALC-QUOTE-TOLERANCE.
  2973             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  2974             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  2975             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  2976             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  2977                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2978                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2979             20  CF-ST-PREM-REJECT-SW       PIC X.
  2980                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  2981                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  2982             20  CF-ST-REF-REJECT-SW        PIC X.
  2983                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  2984                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  2985         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  2986         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  2987         16  CF-ST-REFUND-RULES.
  2988             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  2989             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  2990             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  2991         16  CF-ST-FST-PMT-EXTENSION.
  2992             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  2993             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  2994                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  2995                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  2996                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  2997                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  2998         16  CF-ST-STATE-CALL.
  2999             20  CF-ST-CALL-UNEARNED        PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  54
* EL6318.cbl
  3000             20  CF-ST-CALL-RPT-CNTL        PIC X.
  3001             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  3002         16  CF-REPLACEMENT-LAW-SW          PIC X.
  3003             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  3004             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  3005         16  CF-REPLACEMENT-LETTER          PIC X(4).
  3006         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  3007         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  3008         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  3009         16  CF-ST-SPLIT-PAYMENT            PIC X.
  3010         16  FILLER                         PIC X.
  3011         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  3012             20  CF-ST-BENEFIT-CD           PIC XX.
  3013             20  CF-ST-BENEFIT-KIND         PIC X.
  3014                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  3015                 88  CF-ST-AH-KIND              VALUE 'A'.
  3016             20  CF-ST-REM-TERM-CALC        PIC X.
  3017                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  3018                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  3019                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  3020                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  3021                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  3022                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  3023                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  3024                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  3025
  3026             20  CF-ST-REFUND-CALC          PIC X.
  3027                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  3028                 88  ST-REFD-BY-R78             VALUE '1'.
  3029                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  3030                 88  ST-REFD-AS-CALIF           VALUE '3'.
  3031                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  3032                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  3033                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  3034                 88  ST-REFD-UTAH               VALUE '7'.
  3035                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  3036                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  3037                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  3038
  3039             20  CF-ST-EARNING-CALC         PIC X.
  3040                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  3041                 88  ST-EARN-BY-R78             VALUE '1'.
  3042                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  3043                 88  ST-EARN-AS-CALIF           VALUE '3'.
  3044                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  3045                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  3046                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  3047                 88  ST-EARN-MEAN               VALUE '8'.
  3048                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  3049
  3050             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  3051                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  3052                 88  ST-OVRD-BY-R78             VALUE '1'.
  3053                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  3054                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  3055                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  3056                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  3057                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  55
* EL6318.cbl
  3058                 88  ST-OVRD-MEAN               VALUE '8'.
  3059                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  3060             20  FILLER                     PIC X.
  3061
  3062         16  CF-ST-COMMISSION-CAPS.
  3063             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  3064             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  3065             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  3066             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  3067         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  3068                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  3069
  3070         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  3071
  3072         16  CF-ST-STATUTORY-INTEREST.
  3073             20  CF-ST-STAT-DATE-FROM       PIC X.
  3074                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  3075                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  3076             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  3077             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  3078             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  3079             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  3080             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  3081
  3082         16  CF-ST-OVER-SHORT.
  3083             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  3084             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  3085
  3086         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  3087
  3088         16  CF-ST-RT-CALC                  PIC X.
  3089
  3090         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  3091         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  3092         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  3093         16  CF-ST-RF-LR-CALC               PIC X.
  3094         16  CF-ST-RF-LL-CALC               PIC X.
  3095         16  CF-ST-RF-LN-CALC               PIC X.
  3096         16  CF-ST-RF-AH-CALC               PIC X.
  3097         16  CF-ST-RF-CP-CALC               PIC X.
  3098*        16  FILLER                         PIC X(206).
  3099*CIDMOD         16  FILLER                         PIC X(192).
  3100         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  3101             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  3102         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  3103         16  CF-ST-VFY-2ND-BENE             PIC X.
  3104         16  FILLER                         PIC X(186).
  3105
  3106****************************************************************
  3107*             BENEFIT MASTER RECORD                            *
  3108****************************************************************
  3109
  3110     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3111         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  3112             20  CF-BENEFIT-CODE            PIC XX.
  3113             20  CF-BENEFIT-NUMERIC  REDEFINES
  3114                 CF-BENEFIT-CODE            PIC XX.
  3115             20  CF-BENEFIT-ALPHA           PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  56
* EL6318.cbl
  3116             20  CF-BENEFIT-DESCRIP         PIC X(10).
  3117             20  CF-BENEFIT-COMMENT         PIC X(10).
  3118
  3119             20  CF-LF-COVERAGE-TYPE        PIC X.
  3120                 88  CF-REDUCING                VALUE 'R'.
  3121                 88  CF-LEVEL                   VALUE 'L' 'P'.
  3122
  3123             20  CF-SPECIAL-CALC-CD         PIC X.
  3124                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  3125                 88  CF-NP-0-MO-INT             VALUE 'A'.
  3126                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  3127                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  3128                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  3129                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  3130                 88  CF-FARM-PLAN               VALUE 'F'.
  3131                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  3132                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  3133                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  3134                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  3135                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  3136                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  3137                 88  CF-PRUDENTIAL              VALUE 'P'.
  3138                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  3139                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  3140                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  3141                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  3142                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  3143                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  3144
  3145             20  CF-JOINT-INDICATOR         PIC X.
  3146                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  3147
  3148*            20  FILLER                     PIC X(12).
  3149             20  FILLER                     PIC X(11).
  3150             20  CF-BENEFIT-CATEGORY        PIC X.
  3151             20  CF-LOAN-TYPE               PIC X(8).
  3152
  3153             20  CF-CO-REM-TERM-CALC        PIC X.
  3154                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  3155                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  3156                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  3157                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  3158                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  3159
  3160             20  CF-CO-EARNINGS-CALC        PIC X.
  3161                 88  CO-EARN-BY-R78             VALUE '1'.
  3162                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  3163                 88  CO-EARN-AS-CALIF           VALUE '3'.
  3164                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  3165                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  3166                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  3167                 88  CO-EARN-AS-MEAN            VALUE '8'.
  3168                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  3169
  3170             20  CF-CO-REFUND-CALC          PIC X.
  3171                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  3172                 88  CO-REFD-BY-R78             VALUE '1'.
  3173                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  57
* EL6318.cbl
  3174                 88  CO-REFD-AS-CALIF           VALUE '3'.
  3175                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  3176                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  3177                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  3178                 88  CO-REFD-MEAN               VALUE '8'.
  3179                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  3180                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  3181                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  3182
  3183             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  3184                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  3185                 88  CO-OVRD-BY-R78             VALUE '1'.
  3186                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  3187                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  3188                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  3189                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  3190                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  3191                 88  CO-OVRD-MEAN               VALUE '8'.
  3192                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  3193
  3194             20  CF-CO-BEN-I-G-CD           PIC X.
  3195                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  3196                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  3197                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  3198
  3199         16  FILLER                         PIC X(304).
  3200
  3201
  3202****************************************************************
  3203*             CARRIER MASTER RECORD                            *
  3204****************************************************************
  3205
  3206     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3207         16  CF-ADDRESS-DATA.
  3208             20  CF-MAIL-TO-NAME            PIC X(30).
  3209             20  CF-IN-CARE-OF              PIC X(30).
  3210             20  CF-ADDRESS-LINE-1          PIC X(30).
  3211             20  CF-ADDRESS-LINE-2          PIC X(30).
  3212             20  CF-CITY-STATE              PIC X(30).
  3213             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  3214             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  3215
  3216         16  CF-CLAIM-NO-CONTROL.
  3217             20  CF-CLAIM-NO-METHOD         PIC X.
  3218                 88  CLAIM-NO-MANUAL            VALUE '1'.
  3219                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  3220                 88  CLAIM-NO-SEQ               VALUE '3'.
  3221                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  3222             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  3223                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  3224                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  3225                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  3226
  3227         16  CF-CHECK-NO-CONTROL.
  3228             20  CF-CHECK-NO-METHOD         PIC X.
  3229                 88  CHECK-NO-MANUAL            VALUE '1'.
  3230                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  3231                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  58
* EL6318.cbl
  3232                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  3233             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  3234                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  3235
  3236         16  CF-DOMICILE-STATE              PIC XX.
  3237
  3238         16  CF-EXPENSE-CONTROLS.
  3239             20  CF-EXPENSE-METHOD          PIC X.
  3240                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  3241                 88  DOLLARS-PER-PMT            VALUE '2'.
  3242                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  3243                 88  DOLLARS-PER-MONTH          VALUE '4'.
  3244             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  3245             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  3246
  3247         16  CF-CORRESPONDENCE-CONTROL.
  3248             20  CF-LETTER-RESEND-OPT       PIC X.
  3249                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  3250                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  3251             20  FILLER                     PIC X(4).
  3252
  3253         16  CF-RESERVE-CONTROLS.
  3254             20  CF-MANUAL-SW               PIC X.
  3255                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  3256             20  CF-FUTURE-SW               PIC X.
  3257                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  3258             20  CF-PTC-SW                  PIC X.
  3259                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  3260             20  CF-IBNR-SW                 PIC X.
  3261                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  3262             20  CF-PTC-LF-SW               PIC X.
  3263                 88  CF-LF-PTC-USED             VALUE '1'.
  3264             20  CF-CDT-ACCESS-METHOD       PIC X.
  3265                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  3266                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  3267                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  3268             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  3269
  3270         16  CF-CLAIM-CALC-METHOD           PIC X.
  3271             88  360-PLUS-MONTHS                VALUE '1'.
  3272             88  365-PLUS-MONTHS                VALUE '2'.
  3273             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  3274             88  360-DAILY                      VALUE '4'.
  3275             88  365-DAILY                      VALUE '5'.
  3276
  3277         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  3278         16  FILLER                         PIC X(11).
  3279
  3280         16  CF-LIMIT-AMOUNTS.
  3281             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  3282             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  3283             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  3284             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  3285             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  3286             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  3287             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  3288             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  3289             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  59
* EL6318.cbl
  3290             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  3291
  3292         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  3293         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  3294         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  3295
  3296         16  CF-ZIP-CODE.
  3297             20  CF-ZIP-PRIME.
  3298                 24  CF-ZIP-1ST             PIC X.
  3299                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3300                 24  FILLER                 PIC X(4).
  3301             20  CF-ZIP-PLUS4               PIC X(4).
  3302         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  3303             20  CF-CAN-POSTAL-1            PIC XXX.
  3304             20  CF-CAN-POSTAL-2            PIC XXX.
  3305             20  FILLER                     PIC XXX.
  3306
  3307         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  3308         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  3309         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  3310
  3311         16  CF-RATING-SWITCH               PIC X.
  3312             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  3313             88  CF-NO-RATING                   VALUE 'N'.
  3314
  3315         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  3316
  3317         16  CF-CARRIER-OVER-SHORT.
  3318             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3319             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3320
  3321         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  3322         16  CF-SECPAY-SWITCH               PIC X.
  3323             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  3324             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  3325         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  3326         16  FILLER                         PIC X(448).
  3327*        16  FILLER                         PIC X(452).
  3328
  3329
  3330****************************************************************
  3331*             MORTALITY MASTER RECORD                          *
  3332****************************************************************
  3333
  3334     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3335         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  3336                                INDEXED BY CF-MORT-NDX.
  3337             20  CF-MORT-TABLE              PIC X(5).
  3338             20  CF-MORT-TABLE-TYPE         PIC X.
  3339                 88  CF-MORT-JOINT              VALUE 'J'.
  3340                 88  CF-MORT-SINGLE             VALUE 'S'.
  3341                 88  CF-MORT-COMBINED           VALUE 'C'.
  3342                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  3343                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  3344             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  3345             20  CF-MORT-AGE-METHOD         PIC XX.
  3346                 88  CF-AGE-LAST                VALUE 'AL'.
  3347                 88  CF-AGE-NEAR                VALUE 'AN'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  60
* EL6318.cbl
  3348             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  3349             20  CF-MORT-ADJUSTMENT-DIRECTION
  3350                                            PIC X.
  3351                 88  CF-MINUS                   VALUE '-'.
  3352                 88  CF-PLUS                    VALUE '+'.
  3353             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  3354             20  CF-MORT-JOINT-CODE         PIC X.
  3355                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  3356             20  CF-MORT-PC-Q               PIC X.
  3357                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  3358             20  CF-MORT-TABLE-CODE         PIC X(4).
  3359             20  CF-MORT-COMMENTS           PIC X(15).
  3360             20  FILLER                     PIC X(14).
  3361
  3362         16  FILLER                         PIC X(251).
  3363
  3364
  3365****************************************************************
  3366*             BUSSINESS TYPE MASTER RECORD                     *
  3367****************************************************************
  3368
  3369     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3370* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  3371* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  3372* AND RECORD 05 IS TYPES 81-99
  3373         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  3374             20  CF-BUSINESS-TITLE          PIC  X(19).
  3375             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  3376                                            PIC S9V9(4) COMP-3.
  3377             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  3378             20  FILLER                     PIC  X.
  3379         16  FILLER                         PIC  X(248).
  3380
  3381
  3382****************************************************************
  3383*             TERMINAL MASTER RECORD                           *
  3384****************************************************************
  3385
  3386     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3387
  3388         16  CF-COMPANY-TERMINALS.
  3389             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  3390                                  PIC X(4).
  3391         16  FILLER               PIC X(248).
  3392
  3393
  3394****************************************************************
  3395*             LIFE EDIT MASTER RECORD                          *
  3396****************************************************************
  3397
  3398     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3399         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  3400             20  CF-LIFE-CODE-IN            PIC XX.
  3401             20  CF-LIFE-CODE-OUT           PIC XX.
  3402         16  FILLER                         PIC X(248).
  3403
  3404
  3405****************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  61
* EL6318.cbl
  3406*             AH EDIT MASTER RECORD                            *
  3407****************************************************************
  3408
  3409     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3410         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  3411             20  CF-AH-CODE-IN              PIC XXX.
  3412             20  CF-AH-CODE-OUT             PIC XX.
  3413         16  FILLER                         PIC X(248).
  3414
  3415
  3416****************************************************************
  3417*             CREDIBILITY TABLES                               *
  3418****************************************************************
  3419
  3420     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3421         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  3422                             INDEXED BY CF-CRDB-NDX.
  3423             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  3424             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  3425             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  3426         16  FILLER                         PIC  X(332).
  3427
  3428
  3429****************************************************************
  3430*             REPORT CUSTOMIZATION RECORD                      *
  3431****************************************************************
  3432
  3433     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  3434         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  3435             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  3436             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  3437             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  3438**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  3439****       A T-TRANSFER.                                   ****
  3440             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  3441
  3442         16  FILLER                         PIC XX.
  3443
  3444         16  CF-CARRIER-CNTL-OPT.
  3445             20  CF-CARRIER-OPT-SEQ         PIC 9.
  3446                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  3447                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  3448             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  3449                                            PIC X.
  3450         16  CF-GROUP-CNTL-OPT.
  3451             20  CF-GROUP-OPT-SEQ           PIC 9.
  3452                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  3453                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  3454             20  CF-GROUP-SELECT OCCURS 3 TIMES
  3455                                            PIC X(6).
  3456         16  CF-STATE-CNTL-OPT.
  3457             20  CF-STATE-OPT-SEQ           PIC 9.
  3458                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  3459                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  3460             20  CF-STATE-SELECT OCCURS 3 TIMES
  3461                                            PIC XX.
  3462         16  CF-ACCOUNT-CNTL-OPT.
  3463             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  62
* EL6318.cbl
  3464                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  3465                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  3466             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  3467                                            PIC X(10).
  3468         16  CF-BUS-TYP-CNTL-OPT.
  3469             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  3470                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  3471                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  3472             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  3473                                            PIC XX.
  3474         16  CF-LF-TYP-CNTL-OPT.
  3475             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  3476                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  3477                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  3478             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  3479                                            PIC XX.
  3480         16  CF-AH-TYP-CNTL-OPT.
  3481             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  3482                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  3483                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  3484             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  3485                                            PIC XX.
  3486         16  CF-REPTCD1-CNTL-OPT.
  3487             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  3488                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  3489                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  3490             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  3491                                            PIC X(10).
  3492         16  CF-REPTCD2-CNTL-OPT.
  3493             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  3494                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  3495                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  3496             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  3497                                            PIC X(10).
  3498         16  CF-USER1-CNTL-OPT.
  3499             20  CF-USER1-OPT-SEQ           PIC 9.
  3500                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  3501                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  3502             20  CF-USER1-SELECT OCCURS 3 TIMES
  3503                                            PIC X(10).
  3504         16  CF-USER2-CNTL-OPT.
  3505             20  CF-USER2-OPT-SEQ           PIC 9.
  3506                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  3507                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  3508             20  CF-USER2-SELECT OCCURS 3 TIMES
  3509                                            PIC X(10).
  3510         16  CF-USER3-CNTL-OPT.
  3511             20  CF-USER3-OPT-SEQ           PIC 9.
  3512                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  3513                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  3514             20  CF-USER3-SELECT OCCURS 3 TIMES
  3515                                            PIC X(10).
  3516         16  CF-USER4-CNTL-OPT.
  3517             20  CF-USER4-OPT-SEQ           PIC 9.
  3518                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  3519                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  3520             20  CF-USER4-SELECT OCCURS 3 TIMES
  3521                                            PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  63
* EL6318.cbl
  3522         16  CF-USER5-CNTL-OPT.
  3523             20  CF-USER5-OPT-SEQ           PIC 9.
  3524                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  3525                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  3526             20  CF-USER5-SELECT OCCURS 3 TIMES
  3527                                            PIC X(10).
  3528         16  CF-REINS-CNTL-OPT.
  3529             20  CF-REINS-OPT-SEQ           PIC 9.
  3530                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  3531                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  3532             20  CF-REINS-SELECT OCCURS 3 TIMES.
  3533                 24  CF-REINS-PRIME         PIC XXX.
  3534                 24  CF-REINS-SUB           PIC XXX.
  3535
  3536         16  CF-AGENT-CNTL-OPT.
  3537             20  CF-AGENT-OPT-SEQ           PIC 9.
  3538                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  3539                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  3540             20  CF-AGENT-SELECT OCCURS 3 TIMES
  3541                                            PIC X(10).
  3542
  3543         16  FILLER                         PIC X(43).
  3544
  3545         16  CF-LOSS-RATIO-SELECT.
  3546             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  3547             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  3548         16  CF-ENTRY-DATE-SELECT.
  3549             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  3550             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  3551         16  CF-EFFECTIVE-DATE-SELECT.
  3552             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  3553             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  3554
  3555         16  CF-EXCEPTION-LIST-IND          PIC X.
  3556             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  3557
  3558         16  FILLER                         PIC X(318).
  3559
  3560****************************************************************
  3561*                  EXCEPTION REPORTING RECORD                  *
  3562****************************************************************
  3563
  3564     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  3565         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  3566             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  3567
  3568         16  CF-COMBINED-LIFE-AH-OPT.
  3569             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  3570             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  3571             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  3572             20  CF-CANCELLATION-RATIO      PIC S9(02).
  3573
  3574         16  CF-LIFE-OPT.
  3575             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3576             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3577             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3578             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3579             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  64
* EL6318.cbl
  3580             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3581             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3582             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3583             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3584             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  3585
  3586         16  CF-AH-OPT.
  3587             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3588             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3589             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3590             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3591             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3592             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3593             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3594             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3595             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3596             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  3597
  3598         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  3599             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  3600             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  3601             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  3602
  3603         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  3604
  3605         16  FILLER                         PIC X(673).
  3606
  3607
  3608****************************************************************
  3609*             MORTGAGE SYSTEM PLAN RECORD                      *
  3610****************************************************************
  3611
  3612     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  3613         16  CF-PLAN-TYPE                   PIC X.
  3614             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  3615             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  3616             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  3617         16  CF-PLAN-ABBREV                 PIC XXX.
  3618         16  CF-PLAN-DESCRIPT               PIC X(10).
  3619         16  CF-PLAN-NOTES                  PIC X(20).
  3620         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  3621         16  CF-PLAN-UNDERWRITING.
  3622             20  CF-PLAN-TERM-DATA.
  3623                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  3624                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  3625             20  CF-PLAN-AGE-DATA.
  3626                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  3627                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  3628                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  3629             20  CF-PLAN-BENEFIT-DATA.
  3630                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3631                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3632                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  3633                                            PIC S9(7)V99  COMP-3.
  3634         16  CF-PLAN-POLICY-FORMS.
  3635             20  CF-POLICY-FORM             PIC X(12).
  3636             20  CF-MASTER-APPLICATION      PIC X(12).
  3637             20  CF-MASTER-POLICY           PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  65
* EL6318.cbl
  3638         16  CF-PLAN-RATING.
  3639             20  CF-RATE-CODE               PIC X(5).
  3640             20  CF-SEX-RATING              PIC X.
  3641                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  3642                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  3643             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  3644             20  CF-SUB-STD-TYPE            PIC X.
  3645                 88  CF-PCT-OF-PREM            VALUE '1'.
  3646                 88  CF-PCT-OF-BENE            VALUE '2'.
  3647         16  CF-PLAN-PREM-TOLERANCES.
  3648             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  3649             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  3650         16  CF-PLAN-PYMT-TOLERANCES.
  3651             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  3652             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  3653         16  CF-PLAN-MISC-DATA.
  3654             20  FILLER                     PIC X.
  3655             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  3656             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  3657         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  3658         16  CF-PLAN-IND-GRP                PIC X.
  3659             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  3660                                                     '1'.
  3661             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  3662                                                     '2'.
  3663         16  CF-MIB-SEARCH-SW               PIC X.
  3664             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  3665             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  3666             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  3667             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  3668         16  CF-ALPHA-SEARCH-SW             PIC X.
  3669             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  3670             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  3671             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  3672             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  3673             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  3674             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  3675             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  3676             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  3677             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  3678             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  3679                                                     'A' 'B' 'C'
  3680                                                     'X' 'Y' 'Z'.
  3681         16  CF-EFF-DT-RULE-SW              PIC X.
  3682             88  CF-EFF-DT-ENTER               VALUE 'E'.
  3683             88  CF-EFF-DT-MONTH               VALUE 'M'.
  3684             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  3685             88  CF-EFF-DT-SEMI                VALUE 'S'.
  3686             88  CF-EFF-DT-ANN                 VALUE 'A'.
  3687         16  FILLER                         PIC X(4).
  3688         16  CF-HEALTH-QUESTIONS            PIC X.
  3689             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  3690         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  3691         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  3692         16  CF-PLAN-SNGL-JNT               PIC X.
  3693             88  CF-COMBINED-PLAN              VALUE 'C'.
  3694             88  CF-JNT-PLAN                   VALUE 'J'.
  3695             88  CF-SNGL-PLAN                  VALUE 'S'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  66
* EL6318.cbl
  3696         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  3697         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  3698         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  3699         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  3700         16  CF-RERATE-CNTL                 PIC  X.
  3701             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  3702             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  3703             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  3704             88  CF-AUTO-RECALC                 VALUE '4'.
  3705         16  CF-BENEFIT-TYPE                PIC  X.
  3706             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  3707             88  CF-BENEFIT-REDUCES             VALUE '2'.
  3708         16  CF-POLICY-FEE                  PIC S999V99
  3709                                                    COMP-3.
  3710         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  3711         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  3712         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  3713         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  3714         16  FILLER                         PIC  X(32).
  3715         16  CF-TERMINATION-FORM            PIC  X(04).
  3716         16  FILLER                         PIC  X(08).
  3717         16  CF-CLAIM-CAP                   PIC S9(7)V99
  3718                                                       COMP-3.
  3719         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  3720         16  CF-ISSUE-LETTER                PIC  X(4).
  3721         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  3722         16  CF-DEPENDENT-COVERAGE          PIC  X.
  3723             88  CF-YES-DEP-COV                 VALUE 'Y'.
  3724             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  3725         16  CF-MP-REFUND-CALC              PIC X.
  3726             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  3727             88  CF-MP-REFD-BY-R78              VALUE '1'.
  3728             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  3729             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  3730             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  3731             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  3732             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  3733             88  CF-MP-REFD-MEAN                VALUE '8'.
  3734         16  CF-ALT-RATE-CODE               PIC  X(5).
  3735
  3736
  3737         16  FILLER                         PIC X(498).
  3738****************************************************************
  3739*             MORTGAGE COMPANY MASTER RECORD                   *
  3740****************************************************************
  3741
  3742     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3743         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  3744         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  3745             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  3746             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  3747             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  3748             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  3749             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  3750
  3751         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  3752         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  3753         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  67
* EL6318.cbl
  3754         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  3755         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  3756
  3757         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  3758             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  3759         16  CF-MP-RECON-USE-IND            PIC X(1).
  3760             88  CF-MP-USE-RECON             VALUE 'Y'.
  3761         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  3762             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  3763         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  3764             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  3765             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  3766         16  FILLER                         PIC X(1).
  3767         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  3768             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  3769         16  CF-MORTG-MIB-VERSION           PIC X.
  3770             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  3771             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  3772             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  3773         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  3774             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  3775                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  3776             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  3777                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  3778             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  3779                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  3780             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  3781                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  3782             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  3783                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  3784             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  3785                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  3786         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  3787         16  FILLER                         PIC X(7).
  3788         16  CF-MORTG-DESTINATION-SYMBOL.
  3789             20  CF-MORTG-MIB-COMM          PIC X(5).
  3790             20  CF-MORTG-MIB-TERM          PIC X(5).
  3791         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  3792             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  3793         16  FILLER                         PIC X(03).
  3794         16  CF-MP-CHECK-NO-CONTROL.
  3795             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  3796                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  3797                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  3798                                                ' ' LOW-VALUES.
  3799                 88  CF-MP-CHECK-NO-PRE-PRINTED
  3800                                               VALUE '3'.
  3801         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  3802         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  3803         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  3804             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  3805                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  3806             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  3807                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  3808             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  3809                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  3810             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  3811                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  68
* EL6318.cbl
  3812             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  3813                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  3814             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  3815                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  3816         16  CF-MORTG-BILLING-AREA.
  3817             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  3818                                            PIC X.
  3819         16  CF-MORTG-MONTH-END-DT          PIC XX.
  3820         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  3821         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  3822         16  CF-MORTG-MIB-DEST-SW           PIC X.
  3823             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  3824             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  3825         16  FILLER                         PIC X.
  3826         16  CF-MORTG-LABEL-CONTROL         PIC X.
  3827             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  3828             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  3829         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  3830         16  FILLER                         PIC X(8).
  3831         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  3832         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  3833         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  3834         16  CF-ACH-COMPANY-ID.
  3835             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  3836                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  3837                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  3838                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  3839             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  3840         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  3841             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  3842         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  3843             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  3844             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  3845         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  3846         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  3847         16  FILLER                         PIC X(536).
  3848
  3849****************************************************************
  3850*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  3851****************************************************************
  3852
  3853     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  3854         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  3855             20  CF-FEMALE-HEIGHT.
  3856                 24  CF-FEMALE-FT           PIC 99.
  3857                 24  CF-FEMALE-IN           PIC 99.
  3858             20  CF-FEMALE-MIN-WT           PIC 999.
  3859             20  CF-FEMALE-MAX-WT           PIC 999.
  3860         16  FILLER                         PIC X(428).
  3861
  3862     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  3863         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  3864             20  CF-MALE-HEIGHT.
  3865                 24  CF-MALE-FT             PIC 99.
  3866                 24  CF-MALE-IN             PIC 99.
  3867             20  CF-MALE-MIN-WT             PIC 999.
  3868             20  CF-MALE-MAX-WT             PIC 999.
  3869         16  FILLER                         PIC X(428).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  69
* EL6318.cbl
  3870******************************************************************
  3871*             AUTOMATIC ACTIVITY RECORD                          *
  3872******************************************************************
  3873     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  3874         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  3875             20  CF-SYS-ACTIVE-SW           PIC X(01).
  3876             20  CF-SYS-LETTER-ID           PIC X(04).
  3877             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  3878             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  3879             20  CF-SYS-RESET-SW            PIC X(01).
  3880             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  3881             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  3882
  3883         16  FILLER                         PIC X(50).
  3884
  3885         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  3886             20  CF-USER-ACTIVE-SW          PIC X(01).
  3887             20  CF-USER-LETTER-ID          PIC X(04).
  3888             20  CF-USER-RESEND-DAYS        PIC 9(03).
  3889             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  3890             20  CF-USER-RESET-SW           PIC X(01).
  3891             20  CF-USER-REPORT-DAYS        PIC 9(03).
  3892             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  3893             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  3894
  3895         16  FILLER                         PIC X(246).
  3896*                                COPY ERCPNDB.
  3897******************************************************************
  3898*                                                                *
  3899*                                                                *
  3900*                            ERCPNDB.                            *
  3901*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3902*                            VMOD=2.025                          *
  3903*                                                                *
  3904*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  3905*                                                                *
  3906******************************************************************
  3907*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  3908*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  3909******************************************************************
  3910*                                                                *
  3911*                                                                *
  3912*   FILE TYPE = VSAM,KSDS                                        *
  3913*   RECORD SIZE = 585  RECFORM = FIXED                           *
  3914*                                                                *
  3915*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  3916*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  3917*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  3918*                                                 RKP=13,LEN=36  *
  3919*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  3920*                                      AND CHG-SEQ.)             *
  3921*                                                RKP=49,LEN=11   *
  3922*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  3923*                                      AND CHG-SEQ.)             *
  3924*                                                RKP=60,LEN=15   *
  3925*                                                                *
  3926*   LOG = NO                                                     *
  3927*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  70
* EL6318.cbl
  3928******************************************************************
  3929******************************************************************
  3930*                   C H A N G E   L O G
  3931*
  3932* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3933*-----------------------------------------------------------------
  3934*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3935* EFFECTIVE    NUMBER
  3936*-----------------------------------------------------------------
  3937* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3938* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3939* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  3940* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  3941* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  3942* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  3943* 032306                   PEMA  ADD BOW LOAN NUMBER
  3944* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  3945* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  3946* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  3947* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  3948* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  3949* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  3950* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3951* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  3952******************************************************************
  3953
  3954 01  PENDING-BUSINESS.
  3955     12  PB-RECORD-ID                     PIC XX.
  3956         88  VALID-PB-ID                        VALUE 'PB'.
  3957
  3958     12  PB-CONTROL-PRIMARY.
  3959         16  PB-COMPANY-CD                PIC X.
  3960         16  PB-ENTRY-BATCH               PIC X(6).
  3961         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  3962         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  3963
  3964     12  PB-CONTROL-BY-ACCOUNT.
  3965         16  PB-COMPANY-CD-A1             PIC X.
  3966         16  PB-CARRIER                   PIC X.
  3967         16  PB-GROUPING.
  3968             20  PB-GROUPING-PREFIX       PIC XXX.
  3969             20  PB-GROUPING-PRIME        PIC XXX.
  3970         16  PB-STATE                     PIC XX.
  3971         16  PB-ACCOUNT.
  3972             20  PB-ACCOUNT-PREFIX        PIC X(4).
  3973             20  PB-ACCOUNT-PRIME         PIC X(6).
  3974         16  PB-CERT-EFF-DT               PIC XX.
  3975         16  PB-CERT-NO.
  3976             20  PB-CERT-PRIME            PIC X(10).
  3977             20  PB-CERT-SFX              PIC X.
  3978         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  3979
  3980         16  PB-RECORD-TYPE               PIC X.
  3981             88  PB-MAILING-DATA                VALUE '0'.
  3982             88  PB-ISSUE                       VALUE '1'.
  3983             88  PB-CANCELLATION                VALUE '2'.
  3984             88  PB-BATCH-TRAILER               VALUE '9'.
  3985
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  71
* EL6318.cbl
  3986     12  PB-CONTROL-BY-ORIG-BATCH.
  3987         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  3988         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  3989         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  3990         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  3991
  3992     12  PB-CONTROL-BY-CSR.
  3993         16  PB-CSR-COMPANY-CD            PIC X.
  3994         16  PB-CSR-ID                    PIC X(4).
  3995         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  3996         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  3997         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  3998******************************************************************
  3999*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  4000******************************************************************
  4001
  4002     12  PB-LAST-MAINT-DT                 PIC XX.
  4003     12  PB-LAST-MAINT-BY                 PIC X(4).
  4004     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  4005
  4006     12  PB-RECORD-BODY                   PIC X(375).
  4007
  4008     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  4009         16  PB-CERT-ORIGIN               PIC X.
  4010             88  CLASIC-CREATED-CERT         VALUE '1'.
  4011         16  PB-I-NAME.
  4012             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  4013             20  PB-I-INSURED-FIRST-NAME.
  4014                 24  PB-I-INSURED-1ST-INIT PIC X.
  4015                 24  FILLER                PIC X(9).
  4016             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  4017         16  PB-I-AGE                     PIC S99   COMP-3.
  4018         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  4019         16  PB-I-BIRTHDAY                PIC XX.
  4020         16  PB-I-INSURED-SEX             PIC X.
  4021             88  PB-SEX-MALE     VALUE 'M'.
  4022             88  PB-SEX-FEMALE   VALUE 'F'.
  4023
  4024         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  4025         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  4026         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  4027         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  4028         16  PB-I-SKIP-CODE               PIC X.
  4029             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  4030             88  PB-SKIP-JULY              VALUE '1'.
  4031             88  PB-SKIP-AUGUST            VALUE '2'.
  4032             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  4033             88  PB-SKIP-JULY-AUG          VALUE '4'.
  4034             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  4035             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  4036             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  4037             88  PB-SKIP-JUNE              VALUE '8'.
  4038             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  4039             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  4040             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  4041         16  PB-I-TERM-TYPE               PIC X.
  4042             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  4043             88  PB-PAID-WEEKLY            VALUE 'W'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  72
* EL6318.cbl
  4044             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  4045             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  4046             88  PB-PAID-13-YEARLY         VALUE 'T'.
  4047         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  4048         16  PB-I-POLICY-FORM-NO          PIC X(12).
  4049         16  PB-I-DATA-ENTRY-SW           PIC X.
  4050             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  4051             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  4052             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  4053             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  4054         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  4055         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  4056*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  4057         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  4058         16  FILLER                       PIC X.
  4059
  4060         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  4061             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  4062             88  PB-INVALID-LIFE             VALUE '  ' '00'
  4063                                                   '90' THRU '99'.
  4064         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  4065                                          PIC XX.
  4066         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  4067         16  PB-I-AMOUNT-FINANCED REDEFINES
  4068                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  4069         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  4070         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  4071                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4072         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4073         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  4074         16  PB-I-CLP-AMOUNT REDEFINES
  4075                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  4076         16  PB-I-LF-CALC-FLAG            PIC X.
  4077             88 PB-COMP-LF-PREM               VALUE '?'.
  4078         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  4079         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  4080         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  4081         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  4082         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4083         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4084         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4085         16  PB-I-LF-ABBR                 PIC XXX.
  4086         16  PB-I-LF-INPUT-CD             PIC XX.
  4087
  4088         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4089             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4090             88  PB-INVALID-AH               VALUE '  ' '00'
  4091                                                   '90' THRU '99'.
  4092         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4093         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4094         16  PB-I-AH-CALC-FLAG            PIC X.
  4095             88 PB-COMP-AH-PREM                  VALUE '?'.
  4096         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4097         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4098         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4099         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  4100         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4101         16  PB-I-AH-ABBR                 PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  73
* EL6318.cbl
  4102         16  PB-I-AH-INPUT-CD             PIC XXX.
  4103
  4104         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4105         16  PB-I-REIN-TABLE              PIC XXX.
  4106         16  PB-I-BUSINESS-TYPE           PIC 99.
  4107         16  PB-I-INDV-GRP-CD             PIC X.
  4108         16  PB-I-MORT-CODE.
  4109             20  PB-I-TABLE               PIC X.
  4110             20  PB-I-INTEREST            PIC XX.
  4111             20  PB-I-MORT-TYP            PIC X.
  4112         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4113         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  4114         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  4115         16  PB-I-INDV-GRP-OVRD           PIC X.
  4116         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  4117         16  PB-I-SIG-SW                  PIC X.
  4118             88  PB-POLICY-SIGNED             VALUE 'Y'.
  4119         16  PB-I-RATE-CLASS              PIC XX.
  4120         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4121         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4122         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4123         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  4124         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  4125         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  4126         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  4127         16  PB-I-BENEFIT-TYPE            PIC XXX.
  4128         16  PB-I-OB-FLAG                 PIC X.
  4129             88  PB-I-OB                      VALUE 'B'.
  4130             88  PB-I-SUMMARY                 VALUE 'Z'.
  4131         16  PB-I-ENTRY-STATUS            PIC X.
  4132             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  4133                                              'M' '5' '9' '2'.
  4134             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  4135             88  PB-I-POLICY-PENDING          VALUE '2'.
  4136             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  4137             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  4138             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  4139             88  PB-I-REIN-ONLY               VALUE '9'.
  4140             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  4141             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  4142             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  4143             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  4144         16  PB-I-INT-CODE                PIC X.
  4145             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  4146             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  4147         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  4148         16  PB-I-SOC-SEC-NO              PIC X(11).
  4149         16  PB-I-MEMBER-NO               PIC X(12).
  4150         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  4151*        16  PB-I-LOAN-OFFICER            PIC XXX.
  4152         16  PB-I-OLD-LOF                 PIC XXX.
  4153         16  PB-I-LF-EXPIRE-DT            PIC XX.
  4154         16  PB-I-AH-EXPIRE-DT            PIC XX.
  4155         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  4156         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  4157         16  PB-I-LIFE-INDICATOR          PIC X.
  4158             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  4159         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  74
* EL6318.cbl
  4160         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  4161                                          PIC S9(5)V99    COMP-3.
  4162         16  PB-I-MAIL-ADDRS-SW           PIC X.
  4163             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  4164             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  4165         16  PB-I-1ST-PMT-DT              PIC XX.
  4166         16  PB-I-JOINT-INSURED.
  4167             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  4168             20 PB-I-JOINT-FIRST-NAME.
  4169                24  PB-I-JOINT-FIRST-INIT PIC X.
  4170                24  FILLER                PIC X(9).
  4171             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  4172*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  4173         16  PB-I-BENEFICIARY-NAME.
  4174             20  PB-I-BANK-NUMBER         PIC X(10).
  4175             20  FILLER                   PIC X(15).
  4176         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  4177         16  PB-I-REFERENCE               PIC X(12).
  4178         16  FILLER REDEFINES PB-I-REFERENCE.
  4179             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  4180             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  4181             20  PB-I-CLP-STATE           PIC XX.
  4182         16  PB-I-UNDERWRITING-STATUS     PIC X.
  4183             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  4184             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  4185             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  4186         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  4187         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  4188         16  PB-I-RESIDENT-STATE          PIC XX.
  4189         16  PB-I-RATE-CODE               PIC X(4).
  4190         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  4191         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4192         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4193         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  4194         16  PB-I-BANK-NOCHRGB            PIC 99.
  4195         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  4196         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  4197
  4198     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  4199         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  4200             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  4201         16  PB-C-CANCEL-ORIGIN           PIC X.
  4202             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  4203         16  PB-C-LF-CANCEL-DT            PIC XX.
  4204         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4205         16  PB-C-LF-CALC-REQ             PIC X.
  4206             88 PB-COMP-LF-CANCEL            VALUE '?'.
  4207         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  4208         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  4209         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  4210             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  4211         16  PB-C-AH-CANCEL-DT            PIC XX.
  4212         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4213         16  PB-C-AH-CALC-REQ             PIC X.
  4214             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4215         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4216         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4217         16  PB-C-LAST-NAME               PIC X(15).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  75
* EL6318.cbl
  4218         16  PB-C-REFUND-SW               PIC X.
  4219             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4220             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4221         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4222         16  PB-C-PAYEE-CODE              PIC X(6).
  4223         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4224         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4225         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4226         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4227         16  PB-C-REFERENCE               PIC X(12).
  4228         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4229         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4230         16  PB-C-POST-CARD-IND           PIC X.
  4231         16  PB-C-CANCEL-REASON           PIC X.
  4232         16  PB-C-REF-INTERFACE-SW        PIC X.
  4233         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4234         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  4235         16  FILLER                       PIC X(01).
  4236*        16  FILLER                       PIC X(18).
  4237         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4238*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  4239         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  4240         16  PB-CANCELED-CERT-DATA.
  4241             20  PB-CI-INSURED-NAME.
  4242                 24  PB-CI-LAST-NAME      PIC X(15).
  4243                 24  PB-CI-INITIALS       PIC XX.
  4244             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4245             20  PB-CI-INSURED-SEX        PIC X.
  4246             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4247             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4248             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4249             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4250             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4251             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4252             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4253             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4254             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4255             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4256             20  PB-CI-RATE-CLASS         PIC XX.
  4257             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4258             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4259             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4260             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4261             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4262             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4263             20  PB-CI-LF-ABBR            PIC X(3).
  4264             20  PB-CI-AH-ABBR            PIC X(3).
  4265             20  PB-CI-OB-FLAG            PIC X.
  4266                 88  PB-CI-OB                VALUE 'B'.
  4267             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4268                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4269                                           'M' '4' '5' '9' '2'.
  4270                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4271                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4272                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4273                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4274                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4275                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  76
* EL6318.cbl
  4276                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4277                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4278                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4279                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4280                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4281                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4282             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4283                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4284                                           'M' '4' '5' '9' '2'.
  4285                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  4286                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  4287                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  4288                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  4289                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  4290                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4291                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4292                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4293                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4294                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  4295                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4296                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  4297             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4298             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  4299             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4300             20  PB-CI-MEMBER-NO          PIC X(12).
  4301             20  PB-CI-INT-CODE           PIC X.
  4302                 88  PB-CI-ADD-ON                  VALUE 'A'.
  4303                 88  PB-CI-SIMPLE                  VALUE 'S'.
  4304             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  4305             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  4306             20  PB-CI-COMP-EXCP-SW       PIC X.
  4307                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  4308                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  4309             20  PB-CI-ENTRY-STATUS       PIC X.
  4310             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  4311             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  4312             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  4313             20  PB-CI-DEATH-DT           PIC XX.
  4314             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  4315             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  4316             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4317             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4318             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  4319             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  4320             20  PB-CI-ENTRY-DT              PIC XX.
  4321             20  PB-CI-ENTRY-BATCH           PIC X(6).
  4322             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  4323             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  4324             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  4325             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  4326             20  PB-CI-OLD-LOF               PIC XXX.
  4327*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  4328             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  4329             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  4330             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  4331             20  PB-CI-INDV-GRP-CD           PIC X.
  4332             20  PB-CI-BENEFICIARY-NAME.
  4333                 24  PB-CI-BANK-NUMBER       PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  77
* EL6318.cbl
  4334                 24  FILLER                  PIC X(15).
  4335             20  PB-CI-NOTE-SW               PIC X.
  4336             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  4337             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  4338             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  4339             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  4340             20  PB-CI-LOAN-OFFICER          PIC X(5).
  4341             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  4342             20  PB-CI-FIRST-NAME            PIC X(10).
  4343             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  4344
  4345         16  FILLER                       PIC X(13).
  4346*032306  16  FILLER                       PIC X(27).
  4347*        16  FILLER                       PIC X(46).
  4348
  4349     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  4350         16  FILLER                       PIC X(10).
  4351         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  4352         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  4353         16  PB-M-INSURED-MID-INIT        PIC X.
  4354         16  PB-M-INSURED-AGE             PIC 99.
  4355         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  4356         16  PB-M-INSURED-SEX             PIC X.
  4357         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  4358         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  4359         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  4360         16  PB-M-INSURED-CITY-STATE.
  4361             20  PB-M-INSURED-CITY        PIC X(28).
  4362             20  PB-M-INSURED-STATE       PIC XX.
  4363         16  PB-M-INSURED-ZIP-CODE.
  4364             20  PB-M-INSURED-ZIP-PRIME.
  4365                 24  PB-M-INSURED-ZIP-1   PIC X.
  4366                     88  PB-M-CANADIAN-POST-CODE
  4367                                             VALUE 'A' THRU 'Z'.
  4368                 24  FILLER               PIC X(4).
  4369             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  4370         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  4371                                        PB-M-INSURED-ZIP-CODE.
  4372             20  PM-M-INS-CAN-POST1       PIC XXX.
  4373             20  PM-M-INS-CAN-POST2       PIC XXX.
  4374             20  FILLER                   PIC XXX.
  4375         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  4376         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  4377         16  PB-M-CRED-BENE-NAME          PIC X(30).
  4378         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  4379         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  4380         16  PB-M-CRED-BENE-CITYST.
  4381             20  PB-M-CRED-BENE-CITY      PIC X(28).
  4382             20  PB-M-CRED-BENE-STATE     PIC XX.
  4383         16  FILLER                       PIC X(92).
  4384
  4385     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  4386         16  FILLER                       PIC X(10).
  4387         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4388         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4389         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4390         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4391         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  78
* EL6318.cbl
  4392         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4393         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4394         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4395         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4396         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4397         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4398         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4399         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  4400         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  4401         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  4402         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  4403         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  4404         16  PB-ACCOUNT-NAME              PIC X(30).
  4405         16  PB-PREM-REF-RPT-FLAG         PIC X.
  4406         16  PB-REFERENCE                 PIC X(12).
  4407         16  PB-B-RECEIVED-DT             PIC XX.
  4408         16  FILLER                       PIC X(234).
  4409
  4410     12  PB-RECORD-STATUS.
  4411         16  PB-CREDIT-SELECT-DT          PIC XX.
  4412         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  4413         16  PB-BILLED-DT                 PIC XX.
  4414         16  PB-BILLING-STATUS            PIC X.
  4415             88  PB-ENTRY-REVERSED            VALUE 'R'.
  4416             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  4417             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  4418         16  PB-RECORD-BILL               PIC X.
  4419             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  4420             88  PB-RECORD-RETURNED           VALUE 'R'.
  4421             88  PB-RECORD-ENDORSED           VALUE 'E'.
  4422             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  4423             88  PB-OVERRIDE-AH               VALUE 'A'.
  4424             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  4425         16  PB-BATCH-ENTRY               PIC X.
  4426             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  4427             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  4428             88  PB-REISSUED-CERT             VALUE 'E'.
  4429             88  PB-MONTHLY-CERT              VALUE 'M'.
  4430             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  4431             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  4432             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  4433         16  PB-FORCE-CODE                PIC X.
  4434             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  4435             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  4436             88  PB-CANCEL-FORCE              VALUE '8'.
  4437             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  4438             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  4439             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  4440             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  4441             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  4442             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  4443             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  4444         16  PB-FATAL-FLAG                PIC X.
  4445             88  PB-FATAL-ERRORS              VALUE 'X'.
  4446         16  PB-FORCE-ER-CD               PIC X.
  4447             88  PB-FORCE-ERRORS              VALUE 'F'.
  4448             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  4449         16  PB-WARN-ER-CD                PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  79
* EL6318.cbl
  4450             88  PB-WARNING-ERRORS            VALUE 'W'.
  4451         16  FILLER                       PIC X.
  4452         16  PB-OUT-BAL-CD                PIC X.
  4453             88  PB-OUT-OF-BAL                VALUE 'O'.
  4454         16  PB-LIFE-OVERRIDE-L1          PIC X.
  4455         16  PB-AH-OVERRIDE-L1            PIC X.
  4456         16  PB-INPUT-DT                  PIC XX.
  4457         16  PB-INPUT-BY                  PIC X(4).
  4458         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  4459         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  4460         16  PB-TOLERANCE-REJECT-SW       PIC X.
  4461         16  PB-LF-EARNING-METHOD         PIC X.
  4462         16  PB-AH-EARNING-METHOD         PIC X.
  4463         16  PB-LF-TERM-CALC-METHOD       PIC X.
  4464         16  PB-AH-TERM-CALC-METHOD       PIC X.
  4465         16  PB-REIN-CD                   PIC XXX.
  4466         16  PB-LF-REFUND-TYPE            PIC X.
  4467         16  PB-AH-REFUND-TYPE            PIC X.
  4468         16  PB-ACCT-EFF-DT               PIC XX.
  4469         16  PB-ACCT-EXP-DT               PIC XX.
  4470         16  PB-COMPANY-ID                PIC X(3).
  4471         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4472         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4473         16  PB-SV-CARRIER                PIC X.
  4474         16  PB-SV-GROUPING               PIC X(6).
  4475         16  PB-SV-STATE                  PIC XX.
  4476         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  4477         16  PB-GA-BILLING-INFO.
  4478             20  PB-GA-BILL-DT OCCURS 5 TIMES
  4479                                          PIC XX.
  4480         16  PB-SV-REMIT-TO  REDEFINES
  4481             PB-GA-BILLING-INFO           PIC X(10).
  4482         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  4483         16  PB-I-LOAN-OFFICER            PIC X(5).
  4484         16  PB-I-VIN                     PIC X(17).
  4485
  4486         16  FILLER                       PIC X(04).
  4487         16  IMNET-BYPASS-SW              PIC X.
  4488
  4489******************************************************************
  4490*                COMMON EDIT ERRORS                              *
  4491******************************************************************
  4492
  4493     12  PB-COMMON-ERRORS.
  4494         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  4495                                           PIC S9(4)     COMP.
  4496
  4497******************************************************************
  4498*                                COPY ELCCERT.
  4499******************************************************************
  4500*                                                                *
  4501*                            ELCCERT.                            *
  4502*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4503*                            VMOD=2.013                          *
  4504*                                                                *
  4505*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  4506*                                                                *
  4507*   FILE TYPE = VSAM,KSDS                                        *
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  80
* EL6318.cbl
  4508*   RECORD SIZE = 450  RECFORM = FIXED                           *
  4509*                                                                *
  4510*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  4511*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  4512*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  4513*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  4514*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  4515*                                                                *
  4516*   LOG = YES                                                    *
  4517*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4518******************************************************************
  4519*                   C H A N G E   L O G
  4520*
  4521* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4522*-----------------------------------------------------------------
  4523*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4524* EFFECTIVE    NUMBER
  4525*-----------------------------------------------------------------
  4526* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4527* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4528* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  4529* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4530* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4531* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  4532* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4533* 032612  CR2011110200001  PEMA  AHL CHANGES
  4534******************************************************************
  4535
  4536 01  CERTIFICATE-MASTER.
  4537     12  CM-RECORD-ID                      PIC XX.
  4538         88  VALID-CM-ID                      VALUE 'CM'.
  4539
  4540     12  CM-CONTROL-PRIMARY.
  4541         16  CM-COMPANY-CD                 PIC X.
  4542         16  CM-CARRIER                    PIC X.
  4543         16  CM-GROUPING.
  4544             20  CM-GROUPING-PREFIX        PIC X(3).
  4545             20  CM-GROUPING-PRIME         PIC X(3).
  4546         16  CM-STATE                      PIC XX.
  4547         16  CM-ACCOUNT.
  4548             20  CM-ACCOUNT-PREFIX         PIC X(4).
  4549             20  CM-ACCOUNT-PRIME          PIC X(6).
  4550         16  CM-CERT-EFF-DT                PIC XX.
  4551         16  CM-CERT-NO.
  4552             20  CM-CERT-PRIME             PIC X(10).
  4553             20  CM-CERT-SFX               PIC X.
  4554
  4555     12  CM-CONTROL-BY-NAME.
  4556         16  CM-COMPANY-CD-A1              PIC X.
  4557         16  CM-INSURED-LAST-NAME          PIC X(15).
  4558         16  CM-INSURED-INITIALS.
  4559             20  CM-INSURED-INITIAL1       PIC X.
  4560             20  CM-INSURED-INITIAL2       PIC X.
  4561
  4562     12  CM-CONTROL-BY-SSN.
  4563         16  CM-COMPANY-CD-A2              PIC X.
  4564         16  CM-SOC-SEC-NO.
  4565             20  CM-SSN-STATE              PIC XX.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  81
* EL6318.cbl
  4566             20  CM-SSN-ACCOUNT            PIC X(6).
  4567             20  CM-SSN-LN3.
  4568                 25  CM-INSURED-INITIALS-A2.
  4569                     30 CM-INSURED-INITIAL1-A2   PIC X.
  4570                     30 CM-INSURED-INITIAL2-A2   PIC X.
  4571                 25 CM-PART-LAST-NAME-A2         PIC X.
  4572
  4573     12  CM-CONTROL-BY-CERT-NO.
  4574         16  CM-COMPANY-CD-A4              PIC X.
  4575         16  CM-CERT-NO-A4                 PIC X(11).
  4576
  4577     12  CM-CONTROL-BY-MEMB.
  4578         16  CM-COMPANY-CD-A5              PIC X.
  4579         16  CM-MEMBER-NO.
  4580             20  CM-MEMB-STATE             PIC XX.
  4581             20  CM-MEMB-ACCOUNT           PIC X(6).
  4582             20  CM-MEMB-LN4.
  4583                 25  CM-INSURED-INITIALS-A5.
  4584                     30 CM-INSURED-INITIAL1-A5   PIC X.
  4585                     30 CM-INSURED-INITIAL2-A5   PIC X.
  4586                 25 CM-PART-LAST-NAME-A5         PIC XX.
  4587
  4588     12  CM-INSURED-PROFILE-DATA.
  4589         16  CM-INSURED-FIRST-NAME.
  4590             20  CM-INSURED-1ST-INIT       PIC X.
  4591             20  FILLER                    PIC X(9).
  4592         16  CM-INSURED-ISSUE-AGE          PIC 99.
  4593         16  CM-INSURED-SEX                PIC X.
  4594             88  CM-SEX-MALE                  VALUE 'M'.
  4595             88  CM-SEX-FEMAL                 VALUE 'F'.
  4596         16  CM-INSURED-JOINT-AGE          PIC 99.
  4597         16  CM-JOINT-INSURED-NAME.
  4598             20  CM-JT-LAST-NAME           PIC X(15).
  4599             20  CM-JT-FIRST-NAME.
  4600                 24  CM-JT-1ST-INIT        PIC X.
  4601                 24  FILLER                PIC X(9).
  4602             20  CM-JT-INITIAL             PIC X.
  4603
  4604     12  CM-LIFE-DATA.
  4605         16  CM-LF-BENEFIT-CD              PIC XX.
  4606         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  4607         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  4608         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  4609         16  CM-LF-DEV-CODE                PIC XXX.
  4610         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4611         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  4612         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4613         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  4614         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4615         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4616         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  4617         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4618         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  4619         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4620         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4621         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  4622         16  FILLER                        PIC XX.
  4623
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  82
* EL6318.cbl
  4624     12  CM-AH-DATA.
  4625         16  CM-AH-BENEFIT-CD              PIC XX.
  4626         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  4627         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  4628         16  CM-AH-DEV-CODE                PIC XXX.
  4629         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4630         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  4631         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4632         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4633         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4634         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  4635         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  4636         16  CM-AH-PAID-THRU-DT            PIC XX.
  4637             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  4638         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4639         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4640         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  4641         16  FILLER                        PIC X.
  4642
  4643     12  CM-LOAN-INFORMATION.
  4644         16  CM-LIVES                      PIC S9(7)     COMP-3.
  4645         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  4646                                           PIC S9(5)V99  COMP-3.
  4647         16  CM-BILLED                     PIC S9(7)     COMP-3.
  4648         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  4649         16  CM-PAY-FREQUENCY              PIC S99.
  4650         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  4651         16  CM-RATE-CLASS                 PIC XX.
  4652         16  CM-BENEFICIARY                PIC X(25).
  4653         16  CM-POLICY-FORM-NO             PIC X(12).
  4654         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  4655         16  CM-LAST-ADD-ON-DT             PIC XX.
  4656         16  CM-DEDUCTIBLE-AMOUNTS.
  4657             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  4658             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  4659         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4660             20  CM-RESIDENT-STATE         PIC XX.
  4661             20  CM-RATE-CODE              PIC X(4).
  4662             20  FILLER                    PIC XX.
  4663         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4664             20  CM-LOAN-OFFICER           PIC X(5).
  4665             20  FILLER                    PIC XXX.
  4666         16  CM-CSR-CODE                   PIC XXX.
  4667         16  CM-UNDERWRITING-CODE          PIC X.
  4668             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  4669         16  CM-POST-CARD-IND              PIC X.
  4670         16  CM-NH-INTERFACE-SW            PIC X.
  4671         16  CM-PREMIUM-TYPE               PIC X.
  4672             88  CM-SING-PRM                  VALUE '1'.
  4673             88  CM-O-B-COVERAGE              VALUE '2'.
  4674             88  CM-OPEN-END                  VALUE '3'.
  4675         16  CM-IND-GRP-TYPE               PIC X.
  4676             88  CM-INDIVIDUAL                VALUE 'I'.
  4677             88  CM-GROUP                     VALUE 'G'.
  4678         16  CM-SKIP-CODE                  PIC X.
  4679             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  4680             88  SKIP-JULY                    VALUE '1'.
  4681             88  SKIP-AUGUST                  VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  83
* EL6318.cbl
  4682             88  SKIP-SEPTEMBER               VALUE '3'.
  4683             88  SKIP-JULY-AUG                VALUE '4'.
  4684             88  SKIP-AUG-SEPT                VALUE '5'.
  4685             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  4686             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  4687             88  SKIP-JUNE                    VALUE '8'.
  4688             88  SKIP-JUNE-JULY               VALUE '9'.
  4689             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  4690             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  4691         16  CM-PAYMENT-MODE               PIC X.
  4692             88  PAY-MONTHLY                  VALUE SPACE.
  4693             88  PAY-WEEKLY                   VALUE '1'.
  4694             88  PAY-SEMI-MONTHLY             VALUE '2'.
  4695             88  PAY-BI-WEEKLY                VALUE '3'.
  4696             88  PAY-SEMI-ANUALLY             VALUE '4'.
  4697         16  CM-LOAN-NUMBER                PIC X(8).
  4698         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  4699         16  CM-OLD-LOF                    PIC XXX.
  4700*        16  CM-LOAN-OFFICER               PIC XXX.
  4701         16  CM-REIN-TABLE                 PIC XXX.
  4702         16  CM-SPECIAL-REIN-CODE          PIC X.
  4703         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  4704         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  4705         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  4706
  4707     12  CM-STATUS-DATA.
  4708         16  CM-ENTRY-STATUS               PIC X.
  4709         16  CM-ENTRY-DT                   PIC XX.
  4710
  4711         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  4712         16  CM-LF-CANCEL-DT               PIC XX.
  4713         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  4714
  4715         16  CM-LF-STATUS-AT-DEATH         PIC X.
  4716         16  CM-LF-DEATH-DT                PIC XX.
  4717         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  4718
  4719         16  CM-LF-CURRENT-STATUS          PIC X.
  4720             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4721                                                'M' '4' '5' '9'.
  4722             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  4723             88  CM-LF-POLICY-PENDING         VALUE '2'.
  4724             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  4725             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  4726             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  4727             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4728             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  4729             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4730             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  4731             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  4732             88  CM-LF-DECLINED               VALUE 'D'.
  4733             88  CM-LF-VOIDED                 VALUE 'V'.
  4734
  4735         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  4736         16  CM-AH-CANCEL-DT               PIC XX.
  4737         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  4738
  4739         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  84
* EL6318.cbl
  4740         16  CM-AH-SETTLEMENT-DT           PIC XX.
  4741         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  4742
  4743         16  CM-AH-CURRENT-STATUS          PIC X.
  4744             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4745                                                'M' '4' '5' '9'.
  4746             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  4747             88  CM-AH-POLICY-PENDING         VALUE '2'.
  4748             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  4749             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  4750             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  4751             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4752             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  4753             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4754             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  4755             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  4756             88  CM-AH-DECLINED               VALUE 'D'.
  4757             88  CM-AH-VOIDED                 VALUE 'V'.
  4758
  4759         16  CM-CLAIM-INTERFACE-SW         PIC X.
  4760             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  4761             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  4762             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  4763         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  4764
  4765         16  CM-ENTRY-BATCH                PIC X(6).
  4766         16  CM-LF-EXIT-BATCH              PIC X(6).
  4767         16  CM-AH-EXIT-BATCH              PIC X(6).
  4768         16  CM-LAST-MONTH-END             PIC XX.
  4769
  4770     12  CM-NOTE-SW                        PIC X.
  4771         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  4772         88  CERT-NOTES-PRESENT               VALUE '1'.
  4773         88  BILLING-NOTES-PRESENT            VALUE '2'.
  4774         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  4775         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  4776         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  4777         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  4778         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  4779     12  CM-COMP-EXCP-SW                   PIC X.
  4780         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  4781         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  4782     12  CM-INSURED-ADDRESS-SW             PIC X.
  4783         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  4784         88  INSURED-ADDR-PRESENT             VALUE '1'.
  4785
  4786*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  4787     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  4788     12  FILLER                            PIC X.
  4789
  4790*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  4791     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  4792     12  FILLER                            PIC X.
  4793*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  4794     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  4795
  4796     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  4797         88  CERT-ADDED-BATCH                 VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  85
* EL6318.cbl
  4798         88  CERT-ADDED-ONLINE                VALUE '1'.
  4799         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  4800         88  CERT-PURGED-OFFLINE              VALUE '3'.
  4801         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  4802     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  4803         88  CERT-AS-LOADED                   VALUE ' '.
  4804         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  4805         88  CERT-CLAIM-ONLINE                VALUE '2'.
  4806         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  4807         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  4808         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  4809         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  4810         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  4811
  4812     12  CM-ACCOUNT-COMM-PCTS.
  4813         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  4814         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  4815
  4816     12  CM-USER-FIELD                     PIC X.
  4817     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  4818     12  CM-CLP-STATE                      PIC XX.
  4819     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  4820     12  CM-USER-RESERVED                  PIC XXX.
  4821     12  FILLER REDEFINES CM-USER-RESERVED.
  4822         16  CM-AH-CLASS-CD                PIC XX.
  4823         16  F                             PIC X.
  4824******************************************************************
  4825*                                COPY ELCCRTO.
  4826******************************************************************
  4827*                                                                *
  4828*                            ELCCRTO.                            *
  4829*                                                                *
  4830*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  4831*                                                                *
  4832*   FILE TYPE = VSAM,KSDS                                        *
  4833*   RECORD SIZE = 524  RECFORM = FIXED                           *
  4834*                                                                *
  4835*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  4836*                                                                *
  4837*   LOG = YES                                                    *
  4838*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4839******************************************************************
  4840*                   C H A N G E   L O G
  4841*
  4842* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4843*-----------------------------------------------------------------
  4844*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4845* EFFECTIVE    NUMBER
  4846*-----------------------------------------------------------------
  4847* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  4848* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  4849* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  4850* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  4851******************************************************************
  4852 01  ORIGINAL-CERTIFICATE.
  4853     12  OC-RECORD-ID                      PIC XX.
  4854         88  VALID-OC-ID                      VALUE 'OC'.
  4855     12  OC-CONTROL-PRIMARY.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  86
* EL6318.cbl
  4856         16  OC-COMPANY-CD                 PIC X.
  4857         16  OC-CARRIER                    PIC X.
  4858         16  OC-GROUPING                   PIC X(6).
  4859         16  OC-STATE                      PIC XX.
  4860         16  OC-ACCOUNT                    PIC X(10).
  4861         16  OC-CERT-EFF-DT                PIC XX.
  4862         16  OC-CERT-NO.
  4863             20  OC-CERT-PRIME             PIC X(10).
  4864             20  OC-CERT-SFX               PIC X.
  4865         16  OC-RECORD-TYPE                PIC X.
  4866         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  4867     12  OC-LAST-MAINT-DT                  PIC XX.
  4868     12  OC-LAST-MAINT-BY                  PIC X(4).
  4869     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  4870     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  4871     12  FILLER                            PIC X(49).
  4872     12  OC-ORIG-REC.
  4873         16  OC-INS-LAST-NAME              PIC X(15).
  4874         16  OC-INS-FIRST-NAME             PIC X(10).
  4875         16  OC-INS-MIDDLE-INIT            PIC X.
  4876         16  OC-INS-AGE                    PIC S999     COMP-3.
  4877         16  OC-JNT-LAST-NAME              PIC X(15).
  4878         16  OC-JNT-FIRST-NAME             PIC X(10).
  4879         16  OC-JNT-MIDDLE-INIT            PIC X.
  4880         16  OC-JNT-AGE                    PIC S999     COMP-3.
  4881         16  OC-LF-BENCD                   PIC XX.
  4882         16  OC-LF-TERM                    PIC S999      COMP-3.
  4883         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  4884         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  4885         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  4886         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  4887         16  OC-LF-EXP-DT                  PIC XX.
  4888         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  4889         16  OC-LF-CANCEL-DT               PIC XX.
  4890         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  4891         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4892         16  OC-AH-BENCD                   PIC XX.
  4893         16  OC-AH-TERM                    PIC S999      COMP-3.
  4894         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  4895         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  4896         16  OC-AH-EXP-DT                  PIC XX.
  4897         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  4898         16  OC-AH-CP                      PIC 99.
  4899         16  OC-AH-CANCEL-DT               PIC XX.
  4900         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  4901         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4902         16  OC-CRED-BENE-NAME             PIC X(25).
  4903         16  OC-1ST-PMT-DT                 PIC XX.
  4904         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  4905         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  4906         16  FILLER                        PIC X(213).
  4907
  4908     12  FILLER                            PIC X(50).
  4909******************************************************************
  4910*                                COPY ERCENDT.
  4911******************************************************************
  4912*                                                                *
  4913*                                                                *
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  87
* EL6318.cbl
  4914*                            ERCENDT.                            *
  4915*                            VMOD=2.001                          *
  4916*                                                                *
  4917*   FILE DESCRIPTION = ENDORSEMENT FILE                          *
  4918*                                                                *
  4919*   FILE TYPE = VSAM,KSDS                                        *
  4920*   RECORD SIZE = 579  RECFORM = FIXED                           *
  4921*                                                                *
  4922*   BASE CLUSTER = ERENDT                         RKP=02,LEN=36  *
  4923*       ALTERNATE PATH1 = ERENDT2 (BY ARCH NO)    RKP=38,LEN=05  *
  4924*                                                                *
  4925*   LOG = NO                                                     *
  4926*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4927******************************************************************
  4928*-----------------------------------------------------------------
  4929*                   C H A N G E   L O G
  4930*
  4931* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4932*-----------------------------------------------------------------
  4933*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4934* EFFECTIVE    NUMBER
  4935*-----------------------------------------------------------------
  4936* 052307    2006052600001  AJRA  ADDED FLAG FOR CANCELS ON CERTS
  4937*                                WITH OPEN CLAIMS
  4938* 072312    2011022800001  AJRA  ADDED BATCH NUMBER
  4939* 110612    2012101700002  AJRA  ADD NEW FIELDS
  4940* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  4941*-----------------------------------------------------------------
  4942 01  ENDORSEMENT-RECORD.
  4943     12  EN-RECORD-ID                PIC XX.
  4944         88  VALID-EN-ID                VALUE 'EN'.
  4945     12  EN-CONTROL-PRIMARY.
  4946         16  EN-COMPANY-CD           PIC X.
  4947         16  EN-CARRIER              PIC X.
  4948         16  EN-GROUPING             PIC X(6).
  4949         16  EN-STATE                PIC XX.
  4950         16  EN-ACCOUNT              PIC X(10).
  4951         16  EN-CERT-EFF-DT          PIC XX.
  4952         16  EN-CERT-NO.
  4953             20  EN-CERT-PRIME       PIC X(10).
  4954             20  EN-CERT-SFX         PIC X.
  4955         16  EN-REC-TYPE             PIC X.
  4956             88  EN-ISSUE               VALUE 'I'.
  4957             88  EN-CANCELLATION        VALUE 'C'.
  4958         16  EN-SEQ-NO               PIC 9(04) BINARY.
  4959     12  EN-CONTROL-BY-ARCH-NO.
  4960         16  EN-COMPANY-CD-A1              PIC X.
  4961         16  EN-ARCHIVE-NO                 PIC 9(8) BINARY.
  4962     12  EN-LAST-MAINT-DT            PIC XX.
  4963     12  EN-LAST-MAINT-BY            PIC X(4).
  4964     12  EN-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  4965     12  EN-ENDORSEMENT-RECORD       PIC X(329).
  4966     12  EN-ISSUE-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  4967         16  EN-INS-ORIG-LAST-NAME   PIC X(15).
  4968         16  EN-INS-ORIG-FIRST-NAME  PIC X(10).
  4969         16  EN-INS-ORIG-MIDDLE-INIT PIC X.
  4970         16  EN-INS-ORIG-AGE         PIC S999     COMP-3.
  4971         16  EN-JNT-ORIG-LAST-NAME   PIC X(15).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  88
* EL6318.cbl
  4972         16  EN-JNT-ORIG-FIRST-NAME  PIC X(10).
  4973         16  EN-JNT-ORIG-MIDDLE-INIT PIC X.
  4974         16  EN-JNT-ORIG-AGE         PIC S999     COMP-3.
  4975         16  EN-LF-ORIG-BENCD        PIC XX.
  4976         16  EN-LF-ORIG-TERM         PIC S999      COMP-3.
  4977         16  EN-LF-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  4978         16  EN-LF-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  4979         16  EN-LF-ORIG-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
  4980         16  EN-LF-ORIG-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
  4981         16  EN-LF-ORIG-EXP-DT       PIC XX.
  4982*        16  EN-LF-ORIG-COV-TYPE     PIC X(10).
  4983         16  EN-ORIG-CRED-BENE       PIC X(25).
  4984         16  EN-LF-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  4985         16  FILLER                  PIC X.
  4986         16  EN-AH-ORIG-BENCD        PIC XX.
  4987         16  EN-AH-ORIG-TERM         PIC S999      COMP-3.
  4988         16  EN-AH-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  4989         16  EN-AH-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  4990         16  EN-AH-ORIG-EXP-DT       PIC XX.
  4991*        16  EN-AH-ORIG-COV-TYPE     PIC X(10).
  4992*        16  EN-AH-ORIG-WAIT-PER     PIC 99.
  4993         16  EN-AH-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  4994         16  F                       PIC X(09).
  4995         16  EN-AH-ORIG-CP           PIC 99.
  4996         16  EN-INS-NEW-LAST-NAME    PIC X(15).
  4997         16  EN-INS-NEW-FIRST-NAME   PIC X(10).
  4998         16  EN-INS-NEW-MIDDLE-INIT  PIC X.
  4999         16  EN-INS-NEW-AGE          PIC S999     COMP-3.
  5000         16  EN-JNT-NEW-LAST-NAME    PIC X(15).
  5001         16  EN-JNT-NEW-FIRST-NAME   PIC X(10).
  5002         16  EN-JNT-NEW-MIDDLE-INIT  PIC X.
  5003         16  EN-JNT-NEW-AGE          PIC S999     COMP-3.
  5004         16  EN-LF-NEW-BENCD         PIC XX.
  5005         16  EN-LF-NEW-TERM          PIC S999      COMP-3.
  5006         16  EN-LF-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  5007         16  EN-LF-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  5008         16  EN-LF-NEW-ALT-BEN-AMT   PIC S9(9)V99  COMP-3.
  5009         16  EN-LF-NEW-ALT-PRM-AMT   PIC S9(7)V99  COMP-3.
  5010         16  EN-LF-NEW-EXP-DT        PIC XX.
  5011         16  EN-NEW-CRED-BENE        PIC X(25).
  5012         16  EN-LF-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  5013         16  FILLER                  PIC X.
  5014         16  EN-AH-NEW-BENCD         PIC XX.
  5015         16  EN-AH-NEW-TERM          PIC S999      COMP-3.
  5016         16  EN-AH-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  5017         16  EN-AH-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  5018         16  EN-AH-NEW-EXP-DT        PIC XX.
  5019*        16  EN-AH-NEW-COV-TYPE      PIC X(10).
  5020*        16  EN-AH-NEW-WAIT-PER      PIC 99.
  5021*        16  F                       PIC X(12).
  5022         16  EN-AH-NEW-CP            PIC 99.
  5023         16  EN-SIG-SW               PIC X.
  5024         16  EN-AH-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  5025         16  EN-INS-ORIG-AGE-DEF-FLAG PIC X.
  5026         16  EN-JNT-ORIG-AGE-DEF-FLAG PIC X.
  5027         16  EN-INS-NEW-AGE-DEF-FLAG PIC X.
  5028         16  EN-JNT-NEW-AGE-DEF-FLAG PIC X.
  5029         16  FILLER                  PIC X(33).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  89
* EL6318.cbl
  5030     12  EN-CANCEL-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  5031         16  EN-LF-ORIG-REF-DT       PIC XX.
  5032         16  EN-LF-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  5033         16  EN-AH-ORIG-REF-DT       PIC XX.
  5034         16  EN-AH-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  5035         16  EN-LF-NEW-REF-DT        PIC XX.
  5036         16  EN-LF-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  5037         16  EN-AH-NEW-REF-DT        PIC XX.
  5038         16  EN-AH-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  5039         16  EN-FLAG-CERT            PIC X.
  5040         16  EN-INS-LAST-NAME        PIC X(15).
  5041         16  EN-INS-FIRST-NAME       PIC X(10).
  5042         16  EN-INS-MIDDLE-INIT      PIC X.
  5043         16  EN-LF-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  5044         16  EN-AH-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  5045         16  EN-LF-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  5046         16  EN-AH-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  5047         16  FILLER                  PIC X(262).
  5048     12  EN-MONEY-SW             PIC X.
  5049     12  EN-HEALTH-APP           PIC X.
  5050     12  EN-VOUCHER-SW           PIC X.
  5051     12  EN-PAYEE                PIC X(14).
  5052     12  EN-INPUT-DT             PIC XX.
  5053     12  EN-PROCESS-DT           PIC XX.
  5054     12  EN-LF-COMMISSION        PIC SV9(5)    COMP-3.
  5055     12  EN-AH-COMMISSION        PIC SV9(5)    COMP-3.
  5056     12  EN-REASON-CODES.
  5057         16  F OCCURS 12.
  5058             20  EN-REASON-CODE  PIC X(4).
  5059     12  EN-TEMPLATE-USED        PIC X(8).
  5060     12  EN-DOCU-TYPE            PIC X.
  5061         88  EN-VERI-DOCU          VALUE 'V'.
  5062         88  EN-GCE-DOCU           VALUE 'G'.
  5063         88  EN-CANC-DOCU          VALUE 'C'.
  5064     12  EN-COMMENTS1            PIC X(13).
  5065     12  EN-COMMENTS2            PIC X(70).
  5066     12  EN-COMM-CHGBK           PIC X.
  5067         88  EN-DO-NOT-CHG-ACCT    VALUE 'N'.
  5068         88  EN-CHG-ACCT           VALUE 'Y'.
  5069     12  EN-CSO-PORTION          PIC S9(5)V99  COMP-3.
  5070     12  EN-ACCT-PORTION         PIC S9(5)V99  COMP-3.
  5071     12  EN-BATCH-NUMBER         PIC X(6).
  5072     12  EN-ACCT-SUMM            PIC X.
  5073     12  EN-CSO-SUMM             PIC X.
  5074     12  FILLER                  PIC X(13).
  5075******************************************************************
  5076*                                COPY ERCNOTE.
  5077******************************************************************
  5078*                                                                *
  5079*                                                                *
  5080*                            ERCNOTE                             *
  5081*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5082*                            VMOD=2.003                          *
  5083*                                                                *
  5084*        FILE DESCRIPTION = CERTIFICATE AND BILLING NOTES        *
  5085*                                                                *
  5086*        FILE TYPE= VSAM,KSDS                                    *
  5087*        RECORD SIZE = 825    RECFORM = FIXED                    *
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  90
* EL6318.cbl
  5088*                                                                *
  5089*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  5090*                                                                *
  5091*        LOG = YES                                               *
  5092*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  5093*                                                                *
  5094******************************************************************
  5095*                   C H A N G E   L O G
  5096*
  5097* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5098*-----------------------------------------------------------------
  5099*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5100* EFFECTIVE    NUMBER
  5101*-----------------------------------------------------------------
  5102* 091509  CR2008100900003  AJRA  CERT NOTES MOVED TO NEW FILE. THI
  5103*                                FILE WILL CONTAIN BILLING NOTES O
  5104******************************************************************
  5105
  5106 01  CERTIFICATE-NOTE.
  5107     12  CN-RECORD-ID                PIC  XX.
  5108         88  VALID-CN-ID                  VALUE 'CN'.
  5109
  5110     12  CN-CONTROL-PRIMARY.
  5111         16  CN-COMPANY-CD           PIC X.
  5112         16  CN-CARRIER              PIC X.
  5113         16  CN-GROUPING.
  5114             20 CN-GROUPING-PREFIX   PIC XXX.
  5115             20 CN-GROUPING-PRIME    PIC XXX.
  5116         16  CN-STATE                PIC XX.
  5117         16  CN-ACCOUNT.
  5118             20 CN-ACCOUNT-PREFIX    PIC X(4).
  5119             20 CN-ACCOUNT-PRIME     PIC X(6).
  5120         16  CN-CERT-EFF-DT          PIC XX.
  5121         16  CN-CERT-NO.
  5122             20  CN-CERT-PRIME       PIC X(10).
  5123             20  CN-CERT-SFX         PIC X.
  5124
  5125     12  CN-BILLING-START-LINE-NO    PIC 99.
  5126     12  CN-BILLING-END-LINE-NO      PIC 99.
  5127
  5128     12  CN-LINES.
  5129         16  CN-LINE OCCURS 10       PIC X(77).
  5130
  5131     12  CN-LAST-MAINT-DT            PIC XX.
  5132     12  CN-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  5133     12  CN-LAST-MAINT-USER          PIC X(4).
  5134     12  FILLER                      PIC X(6).
  5135******************************************************************
  5136*                                COPY ERCMAIL.
  5137******************************************************************
  5138*                                                                *
  5139*                                                                *
  5140*                            ERCMAIL                             *
  5141*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5142*                            VMOD=2.003                          *
  5143*                                                                *
  5144*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  5145*                                                                *
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  91
* EL6318.cbl
  5146*   FILE TYPE = VSAM,KSDS                                        *
  5147*   RECORD SIZE = 374   RECFORM = FIX                            *
  5148*                                                                *
  5149*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  5150*   ALTERNATE PATH    = NOT USED                                 *
  5151*                                                                *
  5152*   LOG = YES                                                    *
  5153*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5154******************************************************************
  5155*                   C H A N G E   L O G
  5156*
  5157* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5158*-----------------------------------------------------------------
  5159*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5160* EFFECTIVE    NUMBER
  5161*-----------------------------------------------------------------
  5162* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  5163* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  5164* 111108                   PEMA  ADD CRED BENE ADDR2
  5165******************************************************************
  5166
  5167 01  MAILING-DATA.
  5168     12  MA-RECORD-ID                      PIC XX.
  5169         88  VALID-MA-ID                       VALUE 'MA'.
  5170
  5171     12  MA-CONTROL-PRIMARY.
  5172         16  MA-COMPANY-CD                 PIC X.
  5173         16  MA-CARRIER                    PIC X.
  5174         16  MA-GROUPING.
  5175             20  MA-GROUPING-PREFIX        PIC XXX.
  5176             20  MA-GROUPING-PRIME         PIC XXX.
  5177         16  MA-STATE                      PIC XX.
  5178         16  MA-ACCOUNT.
  5179             20  MA-ACCOUNT-PREFIX         PIC X(4).
  5180             20  MA-ACCOUNT-PRIME          PIC X(6).
  5181         16  MA-CERT-EFF-DT                PIC XX.
  5182         16  MA-CERT-NO.
  5183             20  MA-CERT-PRIME             PIC X(10).
  5184             20  MA-CERT-SFX               PIC X.
  5185
  5186     12  FILLER                            PIC XX.
  5187
  5188     12  MA-ACCESS-CONTROL.
  5189         16  MA-SOURCE-SYSTEM              PIC XX.
  5190             88  MA-FROM-CREDIT                VALUE 'CR'.
  5191             88  MA-FROM-VSI                   VALUE 'VS'.
  5192             88  MA-FROM-WARRANTY              VALUE 'WA'.
  5193             88  MA-FROM-OTHER                 VALUE 'OT'.
  5194         16  MA-RECORD-ADD-DT              PIC XX.
  5195         16  MA-RECORD-ADDED-BY            PIC XXXX.
  5196         16  MA-LAST-MAINT-DT              PIC XX.
  5197         16  MA-LAST-MAINT-BY              PIC XXXX.
  5198         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  5199
  5200     12  MA-PROFILE-INFO.
  5201         16  MA-QUALIFY-CODE-1             PIC XX.
  5202         16  MA-QUALIFY-CODE-2             PIC XX.
  5203         16  MA-QUALIFY-CODE-3             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  92
* EL6318.cbl
  5204         16  MA-QUALIFY-CODE-4             PIC XX.
  5205         16  MA-QUALIFY-CODE-5             PIC XX.
  5206
  5207         16  MA-INSURED-LAST-NAME          PIC X(15).
  5208         16  MA-INSURED-FIRST-NAME         PIC X(10).
  5209         16  MA-INSURED-MIDDLE-INIT        PIC X.
  5210         16  MA-INSURED-ISSUE-AGE          PIC 99.
  5211         16  MA-INSURED-BIRTH-DT           PIC XX.
  5212         16  MA-INSURED-SEX                PIC X.
  5213             88  MA-SEX-MALE                   VALUE 'M'.
  5214             88  MA-SEX-FEMALE                 VALUE 'F'.
  5215         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  5216
  5217         16  MA-ADDRESS-CORRECTED          PIC X.
  5218         16  MA-JOINT-BIRTH-DT             PIC XX.
  5219*        16  FILLER                        PIC X(12).
  5220
  5221         16  MA-ADDRESS-LINE-1             PIC X(30).
  5222         16  MA-ADDRESS-LINE-2             PIC X(30).
  5223         16  MA-CITY-STATE.
  5224             20  MA-CITY                   PIC X(28).
  5225             20  MA-ADDR-STATE             PIC XX.
  5226         16  MA-ZIP.
  5227             20  MA-ZIP-CODE.
  5228                 24  MA-ZIP-CODE-1ST       PIC X(1).
  5229                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5230                 24  FILLER                PIC X(4).
  5231             20  MA-ZIP-PLUS4              PIC X(4).
  5232         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  5233             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  5234             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  5235             20  FILLER                    PIC X(3).
  5236
  5237         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  5238
  5239         16  FILLER                        PIC XXX.
  5240*        16  FILLER                        PIC X(10).
  5241
  5242     12  MA-CRED-BENE-INFO.
  5243         16  MA-CRED-BENE-NAME                 PIC X(25).
  5244         16  MA-CRED-BENE-ADDR                 PIC X(30).
  5245         16  MA-CRED-BENE-ADDR2                PIC X(30).
  5246         16  MA-CRED-BENE-CTYST.
  5247             20  MA-CRED-BENE-CITY             PIC X(28).
  5248             20  MA-CRED-BENE-STATE            PIC XX.
  5249         16  MA-CRED-BENE-ZIP.
  5250             20  MA-CB-ZIP-CODE.
  5251                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  5252                     88  MA-CB-CANADIAN-POST-CODE
  5253                                           VALUE 'A' THRU 'Z'.
  5254                 24  FILLER                    PIC X(4).
  5255             20  MA-CB-ZIP-PLUS4               PIC X(4).
  5256         16  MA-CB-CANADIAN-POSTAL-CODE
  5257                            REDEFINES MA-CRED-BENE-ZIP.
  5258             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  5259             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  5260             20  FILLER                        PIC X(3).
  5261     12  MA-POST-CARD-MAIL-DATA.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  93
* EL6318.cbl
  5262         16  MA-MAIL-DATA OCCURS 7.
  5263             20  MA-MAIL-TYPE              PIC X.
  5264                 88  MA-12MO-MAILING           VALUE '1'.
  5265                 88  MA-EXP-MAILING            VALUE '2'.
  5266             20  MA-MAIL-STATUS            PIC X.
  5267                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  5268                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  5269                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  5270             20  MA-MAIL-DATE              PIC XX.
  5271     12  FILLER                            PIC XX.
  5272     12  FILLER                            PIC XX.
  5273*    12  FILLER                            PIC X(30).
  5274******************************************************************
  5275*                                COPY ERCARCH.
  5276******************************************************************
  5277*                                                                *
  5278*                            ERCARCH.                            *
  5279*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5280*                            VMOD=2.002                          *
  5281*                                                                *
  5282*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  5283*                                                                *
  5284*   FILE TYPE = VSAM,KSDS                                        *
  5285*   RECORD SIZE = 250  RECFORM = FIXED                           *
  5286*                                                                *
  5287*   BASE CLUSTER = ERARCH                        RKP=2,LEN=5     *
  5288*     ALTERNATE PATH1 = ERARCH2 (CERT/RESP)      RKP=07,LEN=35   *
  5289*     ALTERNATE PATH2 = ERARCH3 (FORM NUMBER)    RKP=44,LEN=28   *
  5290*     ALTERNATE PATH3 = ERARCH4 (PROCCESSOR ID)  RKP=73,LEN=28   *
  5291*     ALTERNATE PATH4 = ERARCH5 (ACCOUNT KEY)    RKP=100,LEN=24  *
  5292*     ALTERNATE PATH5 = ERARCH6 (BTCH/CHK KEY)   RKP=124,LEN=11  *
  5293*                                                                *
  5294*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5295******************************************************************
  5296*                   C H A N G E   L O G
  5297*
  5298* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5299*-----------------------------------------------------------------
  5300*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5301* EFFECTIVE    NUMBER
  5302*-----------------------------------------------------------------
  5303* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  5304* 070711  CR2011022800001  AJRA  NAPERSOFT CHANGES
  5305* 110612    2012101700002  AJRA  ADD NEW FIELDS
  5306******************************************************************
  5307 01  LETTER-ARCHIVE.
  5308     12  LA-RECORD-ID                PIC  X(02).
  5309         88  LA-VALID-ID                VALUE 'LA'.
  5310
  5311     12  LA-CONTROL-PRIMARY.
  5312         16  LA-COMPANY-CD           PIC  X(01).
  5313         16  LA-ARCHIVE-NO           PIC S9(08)    COMP.
  5314
  5315     12  LA-CONTROL-BY-CERT-RESP.
  5316         16  LA-COMPANY-CD-A2        PIC  X(01).
  5317         16  LA-CERT-NO-A2.
  5318             20  LA-CERT-PRIME-A2    PIC  X(10).
  5319             20  LA-CERT-SUFFIX-A2   PIC  X(01).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  94
* EL6318.cbl
  5320         16  LA-RSP-PERSON-A2 REDEFINES LA-CERT-NO-A2.
  5321             20  LA-RESP-PERSON-A2   PIC  X(10).
  5322             20  LA-TYPE-A2          PIC  X(01).
  5323         16  LA-CARRIER-A2           PIC  X(01).
  5324         16  LA-GROUPING-A2          PIC  X(06).
  5325         16  LA-STATE-A2             PIC  X(02).
  5326         16  LA-ACCOUNT-A2           PIC  X(10).
  5327         16  LA-EFFECT-DATE-A2       PIC  X(02).
  5328         16  LA-ARCHIVE-NO-A2        PIC S9(08)    COMP.
  5329
  5330     12  LA-CONTROL-BY-FORM.
  5331         16  LA-COMPANY-CD-A3        PIC  X(01).
  5332         16  LA-FORM-A3              PIC  X(04).
  5333         16  LA-CARRIER-A3           PIC  X(01).
  5334         16  LA-GROUPING-A3          PIC  X(06).
  5335         16  LA-STATE-A3             PIC  X(02).
  5336         16  LA-ACCOUNT-A3           PIC  X(10).
  5337         16  LA-ARCHIVE-NO-A3        PIC S9(08)    COMP.
  5338
  5339     12  LA-CONTROL-BY-PROCESSOR.
  5340         16  LA-COMPANY-CD-A4        PIC  X(01).
  5341         16  LA-PROCESSOR-CD         PIC  X(04).
  5342         16  LA-CARRIER-A4           PIC  X(01).
  5343         16  LA-GROUPING-A4          PIC  X(06).
  5344         16  LA-STATE-A4             PIC  X(02).
  5345         16  LA-ACCOUNT-A4           PIC  X(10).
  5346         16  LA-ARCHIVE-NO-A4        PIC S9(08)    COMP.
  5347
  5348     12  LA-CONTROL-BY-KEY-FIELDS.
  5349         16  LA-COMPANY-CD-A5        PIC  X(01).
  5350         16  LA-CARRIER-A5           PIC  X(01).
  5351         16  LA-GROUPING-A5          PIC  X(06).
  5352         16  LA-STATE-A5             PIC  X(02).
  5353         16  LA-ACCOUNT-A5           PIC  X(10).
  5354         16  LA-ARCHIVE-NO-A5        PIC S9(08)    COMP.
  5355
  5356     12  LA-CONTROL-BY-GROUP-CODE.
  5357         16  LA-COMPANY-CD-A6        PIC  X(01).
  5358         16  LA-ENTRY-A6.
  5359             20  LA-FILLER           PIC  X(02).
  5360             20  LA-QUE-CONTROL-A6   PIC S9(08)    COMP.
  5361         16  LA-ARCHIVE-NO-A6        PIC S9(08)    COMP.
  5362
  5363     12  FILLER                      PIC  X(09).
  5364
  5365     12  LA-HEADER-RECORD.
  5366         16  LA-NUMBER-LABEL-LINES   PIC S9(04)    COMP.
  5367         16  LA-CREATION-DATE        PIC  X(02).
  5368         16  LA-FOLLOW-UP-DATE       PIC  X(02).
  5369         16  LA-FINAL-ACT-DATE       REDEFINES
  5370               LA-FOLLOW-UP-DATE     PIC  X(02).
  5371         16  LA-INITIAL-PRINT-DATE   PIC  X(02).
  5372         16  LA-NO-OF-COPIES         PIC S9(01).
  5373         16  LA-NO-OF-TEXT-RECORDS   PIC S9(04)    COMP.
  5374         16  LA-REPLY-DATE           PIC  X(02).
  5375         16  LA-RESEND-DATES.
  5376             20  LA-RESEND-DATE      PIC  X(02).
  5377             20  LA-SENT-DATE        PIC  X(02).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  95
* EL6318.cbl
  5378             20  FILLER              PIC  X(08).
  5379         16  LA-SOURCE-INFORMATION.
  5380             20  LA-DATA-SOURCE      PIC  X(01).
  5381             20  LA-ADDR-SOURCE      PIC  X(01).
  5382         16  LA-STATUS               PIC  X(01).
  5383             88  LA-STATUS-ACTIVE         VALUE 'A'.
  5384             88  LA-STATUS-COMPLETED      VALUE 'C'.
  5385             88  LA-STATUS-ON-HOLD        VALUE 'H'.
  5386             88  LA-STATUS-TO-BE-PURGED   VALUE 'X'.
  5387             88  LA-STATUS-PURGED         VALUE 'P'.
  5388             88  LA-STATUS-VOIDED         VALUE 'V'.
  5389         16  LA-LAST-RESENT-PRINT-DATE
  5390                                     PIC  X(02).
  5391         16  LA-PRINT-RESTRICTION    PIC  X(01).
  5392             88  LA-PRINT-ONLY-WHEN-CNTL-GIVEN
  5393                                          VALUE 'C'.
  5394             88  LA-PRINT-ONLY-WHEN-FORM-GIVEN
  5395                                          VALUE 'F'.
  5396             88  LA-PRINT-ONLY-WHEN-PROC-GIVEN
  5397                                          VALUE 'P'.
  5398         16  LA-PURGED-DATE          PIC  X(02).
  5399         16  LA-VOIDED-DATE          PIC  X(02).
  5400         16  LA-RESEND-LETR          PIC  X(4).
  5401         16  FILLER                  PIC  X(08).
  5402*        16  LA-RESEND-LETR-2        PIC  X(4).
  5403*        16  LA-RESEND-LETR-3        PIC  X(4).
  5404*        16  FILLER                  PIC  X(59).
  5405         16  LA-ARCHIVE-STATUS       PIC  X.
  5406             88  LA-TEMP                VALUE 'T'.
  5407             88  LA-QWS                 VALUE 'Q'.
  5408             88  LA-BATCH               VALUE 'B'.
  5409         16  LA-FINAL-ACT-IND        PIC  X(1).
  5410         16  LA-VA-DISCLOSURE-IND    PIC  X(1).
  5411         16  LA-ENDT-ARCH-NO         PIC S9(8) COMP.
  5412         16  LA-ENDT-ARCH-NO-X REDEFINES LA-ENDT-ARCH-NO
  5413                                     PIC X(4).
  5414         16  FILLER                  PIC  X(42).
  5415*        16  FILLER                  PIC  X(71).
  5416         16  LA-LAST-MAINT-DATE      PIC  X(2).
  5417         16  LA-LAST-MAINT-TIME      PIC S9(6) COMP-3.
  5418         16  LA-LAST-MAINT-TIMEX  REDEFINES LA-LAST-MAINT-TIME
  5419                                     PIC  X(4).
  5420         16  LA-LAST-UPDATED-BY      PIC  X(4).
  5421
  5422******************************************************************
  5423*                                COPY ERCCNOT.
  5424******************************************************************
  5425*                                                                *
  5426*                            ERCCNOT                             *
  5427*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5428*                            VMOD=2.003                          *
  5429*                                                                *
  5430*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  5431*                                                                *
  5432*        FILE TYPE= VSAM,KSDS                                    *
  5433*        RECORD SIZE = 150    RECFORM = FIXED                    *
  5434*                                                                *
  5435*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  96
* EL6318.cbl
  5436*                                                                *
  5437*        LOG = YES                                               *
  5438*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  5439*                                                                *
  5440******************************************************************
  5441*                   C H A N G E   L O G
  5442*
  5443* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5444*-----------------------------------------------------------------
  5445*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5446* EFFECTIVE    NUMBER
  5447*-----------------------------------------------------------------
  5448* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  5449******************************************************************
  5450
  5451 01  CERT-NOTE-FILE.
  5452     12  CZ-RECORD-ID                PIC  XX.
  5453         88  VALID-CZ-ID                  VALUE 'CZ'.
  5454
  5455     12  CZ-CONTROL-PRIMARY.
  5456         16  CZ-COMPANY-CD           PIC X.
  5457         16  CZ-CARRIER              PIC X.
  5458         16  CZ-GROUPING.
  5459             20 CZ-GROUPING-PREFIX   PIC XXX.
  5460             20 CZ-GROUPING-PRIME    PIC XXX.
  5461         16  CZ-STATE                PIC XX.
  5462         16  CZ-ACCOUNT.
  5463             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  5464             20 CZ-ACCOUNT-PRIME     PIC X(6).
  5465         16  CZ-CERT-EFF-DT          PIC XX.
  5466         16  CZ-CERT-NO.
  5467             20  CZ-CERT-PRIME       PIC X(10).
  5468             20  CZ-CERT-SFX         PIC X.
  5469         16  CZ-RECORD-TYPE          PIC X.
  5470             88  CERT-NOTE           VALUE '1'.
  5471             88  CLAIM-CERT-NOTE     VALUE '2'.
  5472         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  5473
  5474     12  CZ-LAST-MAINT-DT            PIC XX.
  5475     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  5476     12  CZ-LAST-MAINT-USER          PIC X(4).
  5477
  5478     12  CZ-NOTE-INFORMATION.
  5479         16  CZ-NOTE                 PIC X(63).
  5480         16  FILLER                  PIC X(39).
  5481******************************************************************
  5482*                                COPY ELCEOBC.
  5483******************************************************************
  5484*                                                                *
  5485*                                                                *
  5486*                            ELCEOBC                             *
  5487*                            VMOD=2.001                          *
  5488*                                                                *
  5489*   CLAIM SYSTEM EOB CODE TABLE                                  *
  5490*                                                                *
  5491*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  5492*   VSAM EOB CODE TABLE                                          *
  5493*                                                                *
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  97
* EL6318.cbl
  5494*   FILE DESCRIPTION = EOB CODE TABLE                            *
  5495*                                                                *
  5496*   FILE TYPE = VSAM,KSDS                                        *
  5497*   RECORD SIZE = 350   RECFORM = FIX                            *
  5498*                                                                *
  5499*   BASE CLUSTER NAME = ELEOBC                    RKP=2,LEN=15   *
  5500*                                                                *
  5501*   LOG = NO                                                     *
  5502*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5503*                                                                *
  5504*                                                                *
  5505******************************************************************
  5506*                   C H A N G E   L O G
  5507*
  5508* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5509*-----------------------------------------------------------------
  5510*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5511* EFFECTIVE    NUMBER
  5512*-----------------------------------------------------------------
  5513* 120808    2008100900001  PEMA  NEW COPYBOOK/FILE
  5514* 081511    2011022800001  PEMA  CHG FOR ADMIN SERV NAPERSOFT
  5515******************************************************************
  5516 01  EOB-CODES.
  5517     12  EO-RECORD-ID                      PIC XX.
  5518         88  VALID-DN-ID                      VALUE 'EO'.
  5519     12  EO-CONTROL-PRIMARY.
  5520         16  EO-COMPANY-CD                 PIC X.
  5521         16  EO-RECORD-TYPE                PIC X.
  5522             88  EO-EOB-RECS                  VALUE '1'.
  5523             88  EO-VERIF-RECS                VALUE '2'.
  5524             88  EO-GCE-RECS                  VALUE '3'.
  5525         16  EO-EOB-CODE                   PIC X(4).
  5526         16  FILLER                        PIC X(9).
  5527     12  EO-MAINT-INFORMATION.
  5528         16  EO-LAST-MAINT-DT              PIC XX.
  5529         16  EO-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  5530         16  EO-LAST-MAINT-USER            PIC X(4).
  5531         16  FILLER                        PIC XX.
  5532     12  EO-DESCRIPTION                    PIC X(275).
  5533     12  FILLER                            PIC X(46).
  5534******************************************************************
  5535*                                COPY ELCCRTT.
  5536******************************************************************
  5537*                                                                *
  5538*                            ELCCRTT.                            *
  5539*                                                                *
  5540*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  5541*                                                                *
  5542*   FILE TYPE = VSAM,KSDS                                        *
  5543*   RECORD SIZE = 552  RECFORM = FIXED                           *
  5544*                                                                *
  5545*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  5546*                                                                *
  5547*   LOG = YES                                                    *
  5548*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5549******************************************************************
  5550*                   C H A N G E   L O G
  5551*
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  98
* EL6318.cbl
  5552* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5553*-----------------------------------------------------------------
  5554*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5555* EFFECTIVE    NUMBER
  5556*-----------------------------------------------------------------
  5557* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  5558* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  5559* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  5560* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  5561******************************************************************
  5562
  5563 01  CERTIFICATE-TRAILERS.
  5564     12  CS-RECORD-ID                      PIC XX.
  5565         88  VALID-CS-ID                      VALUE 'CS'.
  5566
  5567     12  CS-CONTROL-PRIMARY.
  5568         16  CS-COMPANY-CD                 PIC X.
  5569         16  CS-CARRIER                    PIC X.
  5570         16  CS-GROUPING                   PIC X(6).
  5571         16  CS-STATE                      PIC XX.
  5572         16  CS-ACCOUNT                    PIC X(10).
  5573         16  CS-CERT-EFF-DT                PIC XX.
  5574         16  CS-CERT-NO.
  5575             20  CS-CERT-PRIME             PIC X(10).
  5576             20  CS-CERT-SFX               PIC X.
  5577         16  CS-TRAILER-TYPE               PIC X.
  5578             88  COMM-TRLR           VALUE 'A'.
  5579             88  FUTURE-TRLR         VALUE 'B'.
  5580             88  CERT-DATA-TRLR      VALUE 'C'.
  5581
  5582     12  CS-DATA-AREA                      PIC X(516).
  5583
  5584     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  5585         16  CS-BANK-COMMISSION-AREA.
  5586             20  CS-BANK-COMMS       OCCURS 10.
  5587                 24  CS-AGT                PIC X(10).
  5588                 24  CS-COM-TYP            PIC X.
  5589                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  5590                 24  CS-RECALC-LV-INDIC    PIC X.
  5591                 24  FILLER                PIC X(10).
  5592         16  FILLER                        PIC X(256).
  5593
  5594     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  5595         16  CS-VIN-NUMBER                 PIC X(17).
  5596         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  5597         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  5598         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  5599         16  FILLER                        PIC X(496).
  5600******************************************************************
  5601 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA VAR
  5602                          ACCOUNT-MASTER CONTROL-FILE
  5603                          PENDING-BUSINESS CERTIFICATE-MASTER
  5604                          ORIGINAL-CERTIFICATE
  5605                          ENDORSEMENT-RECORD CERTIFICATE-NOTE
  5606                          MAILING-DATA LETTER-ARCHIVE
  5607                          CERT-NOTE-FILE EOB-CODES
  5608                          CERTIFICATE-TRAILERS.
  5609 0000-DFHEXIT SECTION.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  99
* EL6318.cbl
  5610     MOVE '9#                    $   ' TO DFHEIV0.
  5611     MOVE 'EL6318' TO DFHEIV1.
  5612     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  5613     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK
  5614     MOVE EIBDATE                TO DC-JULIAN-YYDDD
  5615     MOVE '5'                    TO DC-OPTION-CODE
  5616     PERFORM 9700-DATE-LINK
  5617     MOVE DC-GREG-DATE-1-EDIT    TO WS-CURRENT-DT
  5618     MOVE DC-BIN-DATE-1          TO WS-CURRENT-BIN-DT
  5619     MOVE EIBTRMID               TO QID-TERM
  5620     MOVE 2                      TO EMI-NUMBER-OF-LINES
  5621     IF EIBCALEN = 0
  5622        GO TO 8800-UNAUTHORIZED-ACCESS
  5623     END-IF
  5624     MOVE FUNCTION LENGTH(EL631KI) TO MAP-LENGTH
  5625     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  5626        IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  5627           MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  5628           MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  5629           MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  5630           MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  5631           MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  5632           MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  5633           MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  5634           MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  5635           MOVE LOW-VALUES           TO EL631KI
  5636           MOVE 'Y'                  TO PI-CLEAR-ERROR-SW
  5637           GO TO 0350-BUILD-INIT-MAP
  5638        END-IF
  5639     END-IF
  5640     IF PI-CALLING-PROGRAM = 'EL614'
  5641        MOVE PI-PROGRAM-WORK-AREA (1:60)
  5642                                 TO WS-PASSED-REASON-CODES
  5643        DISPLAY ' COMING BACK FROM 614 ' WS-PASSED-REASON-CODES
  5644        IF WS-PASSED-REASON-CODES NOT = SPACES
  5645           MOVE 'Y'                TO WS-SET-CODES-MDT
  5646        ELSE
  5647           MOVE 'N'                TO WS-SET-CODES-MDT
  5648        END-IF
  5649        PERFORM 0600-RECOVER-TEMP-STORAGE
  5650                                 THRU 0600-EXIT
  5651        GO TO 0350-BUILD-INIT-MAP
  5652     END-IF
  5653     IF EIBAID = DFHCLEAR
  5654        IF PI-CLEAR-ERROR
  5655           MOVE SPACES            TO PI-CLEAR-ERROR-SW
  5656           MOVE ER-3833           TO EMI-ERROR
  5657           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5658           GO TO 0350-BUILD-INIT-MAP
  5659        ELSE
  5660           GO TO 9400-CLEAR
  5661        END-IF
  5662     END-IF
  5663     .
  5664 0200-RECEIVE.
  5665     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  5666        MOVE ER-0008             TO EMI-ERROR
  5667        PERFORM 9900-ERROR-FORMAT
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 100
* EL6318.cbl
  5668                                 THRU 9900-EXIT
  5669        MOVE -1                  TO PFENTRL
  5670        GO TO 8100-SEND-INITIAL-MAP
  5671     END-IF
  5672
  5673* EXEC CICS RECEIVE
  5674*        MAP      (MAP-NAME)
  5675*        MAPSET   (MAPSET-NAME)
  5676*        INTO     (EL631KI)
  5677*    END-EXEC
  5678     MOVE LENGTH OF
  5679      EL631KI
  5680       TO DFHEIV11
  5681*    MOVE '8"T I  L              ''   #00005668' TO DFHEIV0
  5682     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  5683     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5684     MOVE X'2020233030303035363638' TO DFHEIV0(25:11)
  5685     CALL 'kxdfhei1' USING DFHEIV0,
  5686           MAP-NAME,
  5687           EL631KI,
  5688           DFHEIV11,
  5689           MAPSET-NAME,
  5690           DFHEIV99,
  5691           DFHEIV99
  5692     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5693     IF PFENTRL = 0
  5694         GO TO 0300-CHECK-PFKEYS
  5695     END-IF
  5696     IF EIBAID NOT = DFHENTER
  5697         MOVE ER-0004            TO EMI-ERROR
  5698         GO TO 0320-INPUT-ERROR
  5699     END-IF
  5700     IF (PFENTRI NUMERIC) AND (PFENTRI > 0 AND < 25)
  5701        MOVE PF-VALUES (PFENTRI) TO EIBAID
  5702     ELSE
  5703        MOVE ER-0029            TO EMI-ERROR
  5704        GO TO 0320-INPUT-ERROR
  5705     END-IF
  5706     .
  5707 0300-CHECK-PFKEYS.
  5708     IF EIBAID = DFHPF3
  5709        MOVE 'Y'                 TO PI-CLEAR-ERROR-SW
  5710        PERFORM 0500-CREATE-TEMP-STORAGE THRU 0500-EXIT
  5711        MOVE 'EL614'             TO PGM-NAME
  5712        MOVE PI-REASON-CODE-IND  TO WS-SAVE-REASON-CODE-IND
  5713        MOVE SPACES              TO PI-PROGRAM-WORK-AREA
  5714        move +1                  to s2
  5715        perform varying s1 from +1 by +1 until s1 > +12
  5716           if reacd-in (s1) not = spaces and low-values
  5717              move reacd-in (s1)    to pi-program-work-area (s2:4)
  5718              add +5 to s2
  5719           end-if
  5720        END-perform
  5721        MOVE WS-SAVE-REASON-CODE-IND TO PI-REASON-CODE-IND
  5722        DISPLAY ' GOING TO 614 ' PI-PROGRAM-WORK-AREA (1:60)
  5723        GO TO 9300-XCTL
  5724     END-IF
  5725     IF EIBAID = DFHPF4 OR DFHPF8
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 101
* EL6318.cbl
  5726        GO TO 0360-FINALIZE
  5727     END-IF
  5728     IF EIBAID = DFHPF23
  5729        IF PI-CLEAR-ERROR
  5730           MOVE SPACES            TO PI-CLEAR-ERROR-SW
  5731           MOVE ER-3833           TO EMI-ERROR
  5732           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5733           GO TO 0350-BUILD-INIT-MAP
  5734        ELSE
  5735           GO TO 8810-PF23
  5736        END-IF
  5737     END-IF
  5738     IF EIBAID = DFHPF24
  5739        IF PI-CLEAR-ERROR
  5740           MOVE SPACES            TO PI-CLEAR-ERROR-SW
  5741           MOVE ER-3833           TO EMI-ERROR
  5742           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5743           GO TO 0350-BUILD-INIT-MAP
  5744        ELSE
  5745           GO TO 9200-RETURN-MAIN-MENU
  5746        END-IF
  5747     END-IF
  5748     IF EIBAID = DFHPF12
  5749        GO TO 9500-PF12
  5750     END-IF
  5751     IF EIBAID = DFHENTER
  5752        MOVE 'Y'                 TO PI-CLEAR-ERROR-SW
  5753        GO TO 0325-EDIT-SCREEN
  5754     END-IF
  5755     MOVE ER-0029                TO EMI-ERROR
  5756     .
  5757 0320-INPUT-ERROR.
  5758     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5759     MOVE AL-UNBON               TO PFENTRA
  5760     MOVE -1                     TO PFENTRL
  5761     GO TO 8200-SEND-DATAONLY
  5762     .
  5763 0325-EDIT-SCREEN.
  5764     IF PRTSWL > ZEROS
  5765       IF PRTSWI = 'Y' OR 'N' OR 'P' OR ' '
  5766*          MOVE AL-UANON       TO PRTSWA
  5767*          IF PRTSWI = ' '
  5768*             MOVE 'N'         TO PRTSWI
  5769              MOVE 'P'         TO PRTSWI
  5770*          END-IF
  5771*          MOVE PRTSWI         TO PI-PRTSW-ENTERED
  5772        END-IF
  5773     END-IF
  5774     IF (SIGREQL > ZEROS)
  5775        AND (SIGREQI = 'Y' OR 'N' OR ' ')
  5776        MOVE AL-UANON         TO SIGREQA
  5777        IF SIGREQI = ' '
  5778           MOVE 'N'           TO SIGREQI
  5779        END-IF
  5780        MOVE SIGREQI          TO PI-SIGREQ-ENTERED
  5781     ELSE
  5782        MOVE ER-2651          TO EMI-ERROR
  5783        MOVE -1               TO SIGREQL
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 102
* EL6318.cbl
  5784        MOVE AL-UABON         TO SIGREQA
  5785        PERFORM 9900-ERROR-FORMAT
  5786                                 THRU 9900-EXIT
  5787     END-IF
  5788     IF LTRIDL > ZEROS
  5789        AND LTRIDI > SPACES
  5790        MOVE PI-COMPANY-CD       TO LETR-COMPANY-CD
  5791        MOVE LTRIDI              TO LETR-LETTER-ID
  5792                                    PI-LTRID-ENTERED
  5793        MOVE LETR-PART-KEY       TO ELLETR-SAVE-PART-KEY
  5794        MOVE SPACES              TO LETR-FILLER
  5795        MOVE 0                   TO LETR-SEQ-NO
  5796        PERFORM 0326-GET-Z-RECORD THRU 0326-EXIT
  5797     ELSE
  5798        MOVE ER-1236          TO EMI-ERROR
  5799        MOVE -1               TO LTRIDL
  5800        MOVE AL-UABON         TO LTRIDA
  5801        PERFORM 9900-ERROR-FORMAT
  5802                                 THRU 9900-EXIT
  5803     END-IF
  5804
  5805     IF W-PROMPT-LETTER EQUAL 'Y'
  5806         MOVE ER-0894            TO EMI-ERROR
  5807         MOVE -1                 TO LTRIDL
  5808         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5809     END-IF
  5810     IF VOUCHL > ZEROS
  5811        IF VOUCHI = 'Y' OR 'N'
  5812           MOVE AL-UANON         TO VOUCHA
  5813           MOVE VOUCHI           TO PI-VOUCHER-ENTERED
  5814        ELSE
  5815           MOVE ER-9999          TO EMI-ERROR
  5816           MOVE -1               TO VOUCHL
  5817           MOVE AL-UABON         TO VOUCHA
  5818           PERFORM 9900-ERROR-FORMAT
  5819                                 THRU 9900-EXIT
  5820        END-IF
  5821     END-IF
  5822     IF HLTHAPPL > ZEROS
  5823        IF HLTHAPPI = 'Y' OR 'N'
  5824           MOVE AL-UANON         TO HLTHAPPA
  5825           MOVE HLTHAPPI         TO PI-HLTHAPP-ENTERED
  5826        ELSE
  5827           MOVE ER-9999          TO EMI-ERROR
  5828           MOVE -1               TO HLTHAPPL
  5829           MOVE AL-UABON         TO HLTHAPPA
  5830           PERFORM 9900-ERROR-FORMAT
  5831                                 THRU 9900-EXIT
  5832        END-IF
  5833     END-IF
  5834     IF PAYEEL > ZEROS
  5835        IF PAYEEI > SPACES
  5836           MOVE AL-UANON         TO PAYEEA
  5837           MOVE PAYEEI           TO PI-PAYEE-ENTERED
  5838        ELSE
  5839           MOVE ER-9999          TO EMI-ERROR
  5840           MOVE -1               TO PAYEEL
  5841           MOVE AL-UABON         TO PAYEEA
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 103
* EL6318.cbl
  5842           PERFORM 9900-ERROR-FORMAT
  5843                                 THRU 9900-EXIT
  5844        END-IF
  5845     END-IF
  5846     IF CERTIDL > ZEROS
  5847         IF CERTIDI NUMERIC
  5848            MOVE AL-UANON      TO CERTIDA
  5849            MOVE CERTIDI       TO PI-CERTID-ENTERED
  5850         ELSE
  5851            MOVE ER-1778       TO EMI-ERROR
  5852            MOVE -1            TO CERTIDL
  5853            MOVE AL-UABON      TO CERTIDA
  5854            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5855        END-IF
  5856     ELSE
  5857        IF PI-PRINT-CERTIFICATE = 'Y'
  5858            MOVE ER-0715       TO EMI-ERROR
  5859            MOVE -1            TO CERTIDL
  5860            MOVE AL-UABON      TO CERTIDA
  5861            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5862        END-IF
  5863     END-IF
  5864     SET REASONS-NOT-FOUND TO TRUE
  5865     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  5866        IF REACDL (S1) = +4 OR
  5867          (REACD-IN (S1) NOT = SPACES AND LOW-VALUES)
  5868              MOVE AL-SANON     TO REACDA (S1)
  5869              SET REASONS-FOUND TO TRUE
  5870        END-IF
  5871     END-PERFORM
  5872
  5873     IF REASONS-NOT-FOUND
  5874        MOVE ER-1820             TO EMI-ERROR
  5875        MOVE -1                  TO PFENTRL
  5876        PERFORM 9900-ERROR-FORMAT
  5877                                 THRU 9900-EXIT
  5878     ELSE
  5879        MOVE REASONCDS           TO PI-REASONS-ENTERED
  5880     END-IF
  5881
  5882     IF CRTNT1L > ZEROS
  5883        IF CRTNT1I > SPACES
  5884           MOVE CRTNT1I          TO PI-CERTNT1-ENTERED
  5885        END-IF
  5886     END-IF
  5887
  5888     IF CRTNT2L > ZEROS
  5889        IF CRTNT2I > SPACES
  5890           MOVE CRTNT2I          TO PI-CERTNT2-ENTERED
  5891        END-IF
  5892     END-IF
  5893
  5894     IF CRTNT3L > ZEROS
  5895        IF CRTNT3I > SPACES
  5896           MOVE CRTNT3I          TO PI-CERTNT3-ENTERED
  5897        END-IF
  5898     END-IF
  5899
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 104
* EL6318.cbl
  5900     IF CRTNT4L > ZEROS
  5901        IF CRTNT4I > SPACES
  5902           MOVE CRTNT4I          TO PI-CERTNT4-ENTERED
  5903        END-IF
  5904     END-IF
  5905
  5906     IF BILNT1L > ZEROS
  5907        IF BILNT1I > SPACES
  5908           MOVE BILNT1I          TO PI-BILLNT1-ENTERED
  5909        END-IF
  5910     END-IF
  5911
  5912     IF BILNT2L > ZEROS
  5913        IF BILNT2I > SPACES
  5914           MOVE BILNT2I          TO PI-BILLNT2-ENTERED
  5915        END-IF
  5916     END-IF
  5917
  5918     .
  5919 0325-EXIT.
  5920     EXIT.
  5921
  5922 0326-GET-Z-RECORD.
  5923
  5924     MOVE SPACES  TO W-Z-CONTROL-DATA
  5925
  5926
  5927* EXEC CICS STARTBR
  5928*         DATASET    ('ELLETR')
  5929*         RIDFLD     (ELLETR-KEY)
  5930*         GTEQ
  5931*         RESP      (WS-RESPONSE)
  5932*    END-EXEC.
  5933     MOVE 'ELLETR' TO DFHEIV1
  5934     MOVE 0
  5935       TO DFHEIV11
  5936*    MOVE '&,         G          &  N#00005906' TO DFHEIV0
  5937     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  5938     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5939     MOVE X'204E233030303035393036' TO DFHEIV0(25:11)
  5940     CALL 'kxdfhei1' USING DFHEIV0,
  5941           DFHEIV1,
  5942           ELLETR-KEY,
  5943           DFHEIV99,
  5944           DFHEIV11,
  5945           DFHEIV99
  5946     MOVE EIBRESP  TO WS-RESPONSE
  5947     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5948
  5949     IF NOT RESP-NORMAL
  5950         MOVE ER-1236          TO EMI-ERROR
  5951         MOVE -1               TO LTRIDL
  5952         MOVE AL-UABON         TO LTRIDA
  5953         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5954         GO TO 0326-ENDBR
  5955     END-IF.
  5956
  5957 0326-READNEXT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 105
* EL6318.cbl
  5958
  5959
  5960* EXEC CICS READNEXT
  5961*        DATASET   ('ELLETR')
  5962*        INTO      (TEXT-FILES)
  5963*        RIDFLD    (ELLETR-KEY)
  5964*        RESP      (WS-RESPONSE)
  5965*    END-EXEC
  5966     MOVE LENGTH OF
  5967      TEXT-FILES
  5968       TO DFHEIV12
  5969     MOVE 'ELLETR' TO DFHEIV1
  5970     MOVE 0
  5971       TO DFHEIV11
  5972*    MOVE '&.IL                  )  N#00005922' TO DFHEIV0
  5973     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  5974     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5975     MOVE X'204E233030303035393232' TO DFHEIV0(25:11)
  5976     CALL 'kxdfhei1' USING DFHEIV0,
  5977           DFHEIV1,
  5978           TEXT-FILES,
  5979           DFHEIV12,
  5980           ELLETR-KEY,
  5981           DFHEIV99,
  5982           DFHEIV11,
  5983           DFHEIV99,
  5984           DFHEIV99
  5985     MOVE EIBRESP  TO WS-RESPONSE
  5986     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5987     IF RESP-NORMAL
  5988        IF TX-CONTROL-PRIMARY(1:5) NOT = ELLETR-SAVE-PART-KEY
  5989           MOVE ER-1236          TO EMI-ERROR
  5990           MOVE -1               TO LTRIDL
  5991           MOVE AL-UABON         TO LTRIDA
  5992           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5993           GO TO 0326-ENDBR
  5994        END-IF
  5995
  5996        MOVE AL-UANON         TO LTRIDA
  5997        IF TX-LINE-SQUEEZE-CONTROL = 'Z'
  5998           MOVE TX-TEXT-LINE  TO W-Z-CONTROL-DATA
  5999        ELSE
  6000           GO TO 0326-READNEXT
  6001        END-IF
  6002     ELSE
  6003        MOVE ER-1236          TO EMI-ERROR
  6004        MOVE -1               TO LTRIDL
  6005        MOVE AL-UABON         TO LTRIDA
  6006        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6007        GO TO 0326-ENDBR
  6008     END-IF.
  6009
  6010     MOVE W-PRINT-CERTIFICATE TO PI-PRINT-CERTIFICATE.
  6011
  6012 0326-ENDBR.
  6013
  6014
  6015* EXEC CICS ENDBR
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 106
* EL6318.cbl
  6016*        DATASET     ('ELLETR')
  6017*    END-EXEC.
  6018     MOVE 'ELLETR' TO DFHEIV1
  6019     MOVE 0
  6020       TO DFHEIV11
  6021*    MOVE '&2                    $   #00005955' TO DFHEIV0
  6022     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6023     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6024     MOVE X'2020233030303035393535' TO DFHEIV0(25:11)
  6025     CALL 'kxdfhei1' USING DFHEIV0,
  6026           DFHEIV1,
  6027           DFHEIV11,
  6028           DFHEIV99
  6029     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6030
  6031
  6032 0326-EXIT.
  6033      EXIT.
  6034 0330-CHECK-ERRORS.
  6035     IF EMI-NO-ERRORS
  6036        GO TO 0350-BUILD-INIT-MAP
  6037     ELSE
  6038        GO TO 8200-SEND-DATAONLY
  6039     END-IF
  6040     .
  6041 0330-EXIT.
  6042     EXIT.
  6043 0350-BUILD-INIT-MAP.
  6044     MOVE PI-CRTO-CARRIER        TO CARRO
  6045     MOVE PI-CRTO-GROUPING       TO GROUPO
  6046     MOVE PI-CRTO-STATE          TO STATEO
  6047     MOVE PI-CRTO-ACCOUNT        TO ACCTO
  6048     MOVE PI-CRTO-CERT-PRIME     TO CERTNOO
  6049     MOVE PI-CRTO-CERT-SFX       TO CRTSFXO
  6050     MOVE PI-CRTO-SEQ-NO         TO SEQNOO
  6051     MOVE PI-CRTO-CERT-EFF-DT    TO DC-BIN-DATE-1
  6052     MOVE ' '                    TO DC-OPTION-CODE
  6053     PERFORM 9700-DATE-LINK
  6054     IF NO-CONVERSION-ERROR
  6055        MOVE DC-GREG-DATE-1-EDIT TO EFFDTO
  6056     END-IF
  6057*     IF PI-PRTSW-ENTERED > SPACES
  6058*        MOVE PI-PRTSW-ENTERED    TO PRTSWI
  6059*        MOVE AL-UANON            TO PRTSWA
  6060*        MOVE +1                  TO PRTSWL
  6061*     END-IF
  6062
  6063     IF PI-SIGREQ-ENTERED > SPACES
  6064        MOVE PI-SIGREQ-ENTERED   TO SIGREQI
  6065        MOVE AL-UANON            TO SIGREQA
  6066        MOVE +1                  TO SIGREQL
  6067     ELSE
  6068        IF PI-CLAIM-REFORMATION
  6069            MOVE 'Y'             TO SIGREQI
  6070            MOVE AL-UANON        TO SIGREQA
  6071            MOVE +1              TO SIGREQL
  6072        END-IF
  6073     END-IF
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 107
* EL6318.cbl
  6074
  6075     IF PI-LTRID-ENTERED > SPACES
  6076        MOVE PI-LTRID-ENTERED    TO LTRIDI
  6077        MOVE AL-UANON            TO LTRIDA
  6078        MOVE +4                  TO LTRIDL
  6079     ELSE
  6080        IF PI-CLAIM-REFORMATION
  6081            MOVE 'CLRF'          TO LTRIDI
  6082            MOVE AL-UANON        TO LTRIDA
  6083            MOVE +4              TO LTRIDL
  6084        END-IF
  6085     END-IF
  6086
  6087     IF PI-VOUCHER-ENTERED > SPACES
  6088        MOVE PI-VOUCHER-ENTERED  TO VOUCHI
  6089        MOVE AL-UANON            TO VOUCHA
  6090        MOVE +1                  TO VOUCHL
  6091     END-IF
  6092
  6093     IF PI-HLTHAPP-ENTERED > SPACES
  6094        MOVE PI-HLTHAPP-ENTERED  TO HLTHAPPI
  6095        MOVE AL-UANON            TO HLTHAPPA
  6096        MOVE +1                  TO HLTHAPPL
  6097     END-IF
  6098
  6099     IF PI-PAYEE-ENTERED > SPACES
  6100        MOVE PI-PAYEE-ENTERED    TO PAYEEI
  6101        MOVE AL-UANON            TO PAYEEA
  6102        MOVE +10                 TO PAYEEL
  6103     END-IF
  6104
  6105     IF PI-CERTID-ENTERED > SPACES
  6106        MOVE PI-CERTID-ENTERED   TO CERTIDI
  6107        MOVE AL-UANON            TO CERTIDA
  6108        MOVE +5                  TO CERTIDL
  6109     END-IF
  6110
  6111     SET REASONS-NOT-FOUND TO TRUE
  6112     MOVE PI-REASONS-ENTERED     TO REASONCDS
  6113     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  6114        IF REACDL (S1) = +4 OR
  6115          (REACD-IN (S1) NOT = SPACES AND LOW-VALUES)
  6116              MOVE AL-SANON      TO REACDA (S1)
  6117              MOVE +4            TO REACDL (S1)
  6118              SET REASONS-FOUND  TO TRUE
  6119        END-IF
  6120     END-PERFORM
  6121
  6122     IF REASONS-NOT-FOUND
  6123         IF PI-CLAIM-REFORMATION
  6124            MOVE 'CRNA'          TO REACD-IN (1)
  6125            MOVE AL-SANON        TO REACDA (1)
  6126            MOVE +4              TO REACDL (1)
  6127            SET REASONS-FOUND    TO TRUE
  6128        END-IF
  6129     END-IF
  6130
  6131     IF PI-CERTNT1-ENTERED > SPACES
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 108
* EL6318.cbl
  6132        MOVE PI-CERTNT1-ENTERED  TO CRTNT1I
  6133        MOVE AL-UANON            TO CRTNT1A
  6134        MOVE +63                 TO CRTNT1L
  6135     END-IF
  6136
  6137     IF PI-CERTNT2-ENTERED > SPACES
  6138        MOVE PI-CERTNT2-ENTERED  TO CRTNT2I
  6139        MOVE AL-UANON            TO CRTNT2A
  6140        MOVE +63                 TO CRTNT2L
  6141     END-IF
  6142
  6143     IF PI-CERTNT3-ENTERED > SPACES
  6144        MOVE PI-CERTNT3-ENTERED  TO CRTNT3I
  6145        MOVE AL-UANON            TO CRTNT3A
  6146        MOVE +63                 TO CRTNT3L
  6147     END-IF
  6148
  6149     IF PI-CERTNT4-ENTERED > SPACES
  6150        MOVE PI-CERTNT4-ENTERED  TO CRTNT4I
  6151        MOVE AL-UANON            TO CRTNT4A
  6152        MOVE +63                 TO CRTNT4L
  6153     END-IF
  6154
  6155     IF PI-BILLNT1-ENTERED > SPACES
  6156        MOVE PI-BILLNT1-ENTERED  TO BILNT1I
  6157        MOVE AL-UANON            TO BILNT1A
  6158        MOVE +63                 TO BILNT1L
  6159     END-IF
  6160
  6161     IF PI-BILLNT2-ENTERED > SPACES
  6162        MOVE PI-BILLNT2-ENTERED  TO BILNT2I
  6163        MOVE AL-UANON            TO BILNT2A
  6164        MOVE +63                 TO BILNT2L
  6165     END-IF
  6166
  6167     GO TO 8100-SEND-INITIAL-MAP
  6168     .
  6169 0360-FINALIZE.
  6170     display ' made it to 0360 '
  6171     set P to address of KIXSYS
  6172     CALL "getenv" using by value P returning var-ptr
  6173     if var-ptr = null then
  6174        display ' kixsys not set '
  6175     else
  6176        set address of var to var-ptr
  6177        move 0 to env-var-len
  6178        inspect var tallying env-var-len
  6179          for characters before X'00'
  6180*       DISPLAY '  KIXSYS = ' var (1:env-var-len)
  6181        unstring var (1:env-var-len) delimited by '/'
  6182           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  6183              WS-KIX-SYS
  6184        end-unstring
  6185*       DISPLAY ' WS KIX SYS ' WS-KIXSYS
  6186*       DISPLAY ' WS KIX MYENV ' WS-KIX-MYENV
  6187     end-if
  6188     set P to address of KIXHOST
  6189     CALL "getenv" using by value P returning var-ptr
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 109
* EL6318.cbl
  6190     if var-ptr = null then
  6191        display ' kixhost not set '
  6192     else
  6193        set address of var to var-ptr
  6194        move 0 to env-var-len
  6195        inspect var tallying env-var-len
  6196          for characters before X'00'
  6197*       DISPLAY '  KIXHOST = ' var (1:env-var-len)
  6198        MOVE var(1:env-var-len)  to ws-kixhost
  6199        DISPLAY ' WS KIX HOST ' WS-KIXhost
  6200     end-if
  6201     PERFORM 0325-EDIT-SCREEN    THRU 0325-EXIT
  6202     IF NOT EMI-NO-ERRORS
  6203       AND EIBAID = DFHPF4
  6204        GO TO 8200-SEND-DATAONLY
  6205     END-IF
  6206     MOVE LOW-VALUES             TO NEW-ELCRTO-REC
  6207     MOVE PI-ELCRTO-KEY          TO ELCRTO-KEY
  6208                                    NEW-ELCRTO-KEY
  6209     SUBTRACT +1               FROM NCRTO-SEQ-NO
  6210     PERFORM 0362-READ-ELCRTO    THRU 0362-EXIT
  6211     IF RESP-NORMAL
  6212        AND (PI-ELCRTO-KEY = OC-CONTROL-PRIMARY)
  6213        DISPLAY ' RESP NORMAL AND = '
  6214        PERFORM 0400-ADD-ERENDT  THRU 0400-EXIT
  6215*       PERFORM 1000-BUILD-ERARCH THRU 1000-EXIT
  6216        PERFORM 1100-CALL-NS-BUS-LOGIC
  6217                                 THRU 1100-EXIT
  6218        IF BL-OK
  6219           CONTINUE
  6220        ELSE
  6221           MOVE ER-8888          TO EMI-ERROR-NUMBER (1)
  6222           MOVE BL-MESSAGE       TO EMI-ERROR-TEXT (1)
  6223           MOVE -1               TO SIGREQL
  6224        END-IF
  6225     ELSE
  6226        MOVE ER-9999             TO EMI-ERROR
  6227        PERFORM 9900-ERROR-FORMAT
  6228                                 THRU 9900-EXIT
  6229        MOVE -1                  TO SIGREQL
  6230        GO TO 8100-SEND-INITIAL-MAP
  6231     END-IF
  6232     MOVE FUNCTION UPPER-CASE(WS-KIX-MYENV)
  6233                                 TO SYSO
  6234     MOVE WS-KIXHOST             TO HOSTO
  6235     MOVE PI-COMPANY-ID          TO COMPANYO
  6236     MOVE '4'                    TO DATASORO
  6237     MOVE BL-BATCH-NO            TO BATCHNOO
  6238     MOVE BL-BATCH-SEQ           TO BSEQNOO
  6239     MOVE BL-ARCHIVE-NO          TO ARCHNOO
  6240     MOVE PI-PROCESSOR-ID        TO PROCIDO
  6241*    MOVE 'N'                    TO PRTSWO
  6242*    MOVE -1                     TO PRTSWL
  6243*    MOVE AL-UANON               TO PRTSWA
  6244     MOVE -1                     TO SIGREQL
  6245     MOVE AL-UANON               TO SIGREQA
  6246     IF EIBAID = DFHPF4
  6247        MOVE SPACES              TO PI-CLEAR-ERROR-SW
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 110
* EL6318.cbl
  6248        MOVE ER-0280             TO EMI-ERROR
  6249        PERFORM 9900-ERROR-FORMAT
  6250                                 THRU 9900-EXIT
  6251        MOVE BL-ARCHIVE-NO       TO W-ARCH-SUPPRESS
  6252        MOVE W-ARCH-EDIT         TO EMI-TEXT-VARIABLE (1)
  6253        MOVE 'Y'                 TO PI-FINALIZED-IND
  6254        GO TO 9400-CLEAR
  6255     ELSE
  6256        MOVE ER-1818             TO EMI-ERROR
  6257        PERFORM 9900-ERROR-FORMAT
  6258                                 THRU 9900-EXIT
  6259     END-IF
  6260     GO TO 0350-BUILD-INIT-MAP
  6261     .
  6262 0360-EXIT.
  6263     EXIT.
  6264 0362-READ-ELCRTO.
  6265     display ' made it to 0362 '
  6266
  6267* EXEC CICS READ
  6268*        DATASET   (WS-ELCRTO-FILE-ID)
  6269*        SET       (ADDRESS OF ORIGINAL-CERTIFICATE)
  6270*        RIDFLD    (ELCRTO-KEY)
  6271*        RESP      (WS-RESPONSE)
  6272*    END-EXEC
  6273*    MOVE '&"S        E          (  N#00006193' TO DFHEIV0
  6274     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6275     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6276     MOVE X'204E233030303036313933' TO DFHEIV0(25:11)
  6277     CALL 'kxdfhei1' USING DFHEIV0,
  6278           WS-ELCRTO-FILE-ID,
  6279           DFHEIV20,
  6280           DFHEIV99,
  6281           ELCRTO-KEY,
  6282           DFHEIV99,
  6283           DFHEIV99,
  6284           DFHEIV99
  6285     SET ADDRESS OF ORIGINAL-CERTIFICATE TO
  6286         DFHEIV20
  6287     MOVE EIBRESP  TO WS-RESPONSE
  6288     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6289     .
  6290 0362-EXIT.
  6291     EXIT.
  6292 0363-READ-ELCRTO-UPD.
  6293     display ' made it to 0363 '
  6294
  6295* EXEC CICS READ
  6296*        DATASET   (WS-ELCRTO-FILE-ID)
  6297*        SET       (ADDRESS OF ORIGINAL-CERTIFICATE)
  6298*        RIDFLD    (ELCRTO-KEY)
  6299*        UPDATE
  6300*        RESP      (WS-RESPONSE)
  6301*    END-EXEC
  6302*    MOVE '&"S        EU         (  N#00006204' TO DFHEIV0
  6303     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6304     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  6305     MOVE X'204E233030303036323034' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 111
* EL6318.cbl
  6306     CALL 'kxdfhei1' USING DFHEIV0,
  6307           WS-ELCRTO-FILE-ID,
  6308           DFHEIV20,
  6309           DFHEIV99,
  6310           ELCRTO-KEY,
  6311           DFHEIV99,
  6312           DFHEIV99,
  6313           DFHEIV99
  6314     SET ADDRESS OF ORIGINAL-CERTIFICATE TO
  6315         DFHEIV20
  6316     MOVE EIBRESP  TO WS-RESPONSE
  6317     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6318     .
  6319 0363-EXIT.
  6320     EXIT.
  6321 0365-READ-ERENDT.
  6322
  6323* EXEC CICS READ
  6324*        DATASET   (WS-ERENDT-FILE-ID)
  6325*        SET       (ADDRESS OF ENDORSEMENT-RECORD)
  6326*        RIDFLD    (ERENDT-KEY)
  6327*        RESP      (WS-RESPONSE)
  6328*    END-EXEC
  6329*    MOVE '&"S        E          (  N#00006215' TO DFHEIV0
  6330     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6331     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6332     MOVE X'204E233030303036323135' TO DFHEIV0(25:11)
  6333     CALL 'kxdfhei1' USING DFHEIV0,
  6334           WS-ERENDT-FILE-ID,
  6335           DFHEIV20,
  6336           DFHEIV99,
  6337           ERENDT-KEY,
  6338           DFHEIV99,
  6339           DFHEIV99,
  6340           DFHEIV99
  6341     SET ADDRESS OF ENDORSEMENT-RECORD TO
  6342         DFHEIV20
  6343     MOVE EIBRESP  TO WS-RESPONSE
  6344     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6345     .
  6346 0365-EXIT.
  6347     EXIT.
  6348 0400-ADD-ERENDT.
  6349     PERFORM 1500-GET-ARCH-NO    THRU 1500-EXIT
  6350     display ' made it to 0400 '
  6351
  6352* EXEC CICS GETMAIN
  6353*         SET      (ADDRESS OF ENDORSEMENT-RECORD)
  6354*         LENGTH   (ERENDT-LENGTH)
  6355*         INITIMG  (GETMAIN-SPACE)
  6356*    END-EXEC
  6357*    MOVE ',"IL                  $   #00006227' TO DFHEIV0
  6358     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6359     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6360     MOVE X'2020233030303036323237' TO DFHEIV0(25:11)
  6361     CALL 'kxdfhei1' USING DFHEIV0,
  6362           DFHEIV20,
  6363           ERENDT-LENGTH,
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 112
* EL6318.cbl
  6364           GETMAIN-SPACE
  6365     SET ADDRESS OF ENDORSEMENT-RECORD TO
  6366         DFHEIV20
  6367     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6368     PERFORM 0410-INIT-ERENDT    THRU 0410-EXIT
  6369     MOVE PI-PROCESSOR-ID        TO EN-LAST-MAINT-BY
  6370     MOVE EIBTIME                TO EN-LAST-MAINT-HHMMSS
  6371     MOVE WS-CURRENT-BIN-DT      TO EN-LAST-MAINT-DT
  6372                                    EN-INPUT-DT
  6373                                    EN-PROCESS-DT
  6374
  6375     MOVE OC-INS-FIRST-NAME    TO EN-INS-ORIG-FIRST-NAME
  6376     MOVE OC-INS-MIDDLE-INIT   TO EN-INS-ORIG-MIDDLE-INIT
  6377     MOVE OC-INS-LAST-NAME     TO EN-INS-ORIG-LAST-NAME
  6378     MOVE OC-INS-AGE           TO EN-INS-ORIG-AGE
  6379     MOVE OC-INS-AGE-DEFAULT-FLAG TO EN-INS-ORIG-AGE-DEF-FLAG
  6380     MOVE OC-JNT-FIRST-NAME    TO EN-JNT-ORIG-FIRST-NAME
  6381     MOVE OC-JNT-MIDDLE-INIT   TO EN-JNT-ORIG-MIDDLE-INIT
  6382     MOVE OC-JNT-LAST-NAME     TO EN-JNT-ORIG-LAST-NAME
  6383     MOVE OC-JNT-AGE           TO EN-JNT-ORIG-AGE
  6384     MOVE OC-JNT-AGE-DEFAULT-FLAG TO EN-JNT-ORIG-AGE-DEF-FLAG
  6385     MOVE OC-LF-BENCD          TO EN-LF-ORIG-BENCD
  6386     IF OC-LF-BENCD NOT = '00' AND '  '
  6387        MOVE OC-LF-BEN-AMT       TO EN-LF-ORIG-BEN-AMT
  6388        MOVE OC-LF-PRM-AMT       TO EN-LF-ORIG-PRM-AMT
  6389        MOVE OC-LF-ALT-BEN-AMT   TO EN-LF-ORIG-ALT-BEN-AMT
  6390        MOVE OC-LF-ALT-PRM-AMT   TO EN-LF-ORIG-ALT-PRM-AMT
  6391        MOVE OC-LF-TERM          TO EN-LF-ORIG-TERM
  6392        MOVE OC-LF-EXP-DT        TO EN-LF-ORIG-EXP-DT
  6393        MOVE OC-LF-COMM-PCT      TO EN-LF-ORIG-COMM-PCT
  6394     END-IF
  6395     MOVE OC-AH-BENCD          TO EN-AH-ORIG-BENCD
  6396     IF OC-AH-BENCD NOT = '00' AND '  '
  6397        MOVE OC-AH-BEN-AMT       TO EN-AH-ORIG-BEN-AMT
  6398        MOVE OC-AH-PRM-AMT       TO EN-AH-ORIG-PRM-AMT
  6399        MOVE OC-AH-TERM          TO EN-AH-ORIG-TERM
  6400        MOVE OC-AH-EXP-DT        TO EN-AH-ORIG-EXP-DT
  6401        MOVE OC-AH-CP            TO EN-AH-ORIG-CP
  6402        MOVE OC-AH-COMM-PCT      TO EN-AH-ORIG-COMM-PCT
  6403     END-IF
  6404     MOVE OC-CRED-BENE-NAME      TO EN-ORIG-CRED-BENE
  6405
  6406* EXEC CICS GETMAIN
  6407*         SET      (ADDRESS OF PENDING-BUSINESS)
  6408*         LENGTH   (ERPNDB-LENGTH)
  6409*         INITIMG  (GETMAIN-SPACE)
  6410*    END-EXEC
  6411*    MOVE ',"IL                  $   #00006269' TO DFHEIV0
  6412     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6413     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6414     MOVE X'2020233030303036323639' TO DFHEIV0(25:11)
  6415     CALL 'kxdfhei1' USING DFHEIV0,
  6416           DFHEIV20,
  6417           ERPNDB-LENGTH,
  6418           GETMAIN-SPACE
  6419     SET ADDRESS OF PENDING-BUSINESS TO
  6420         DFHEIV20
  6421     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 113
* EL6318.cbl
  6422     DISPLAY ' JUST DID GETMAIN ON ERPNDB '
  6423     MOVE PI-ERPNDB-KEY          TO ERPNDB-KEY
  6424
  6425* EXEC CICS READ
  6426*        DATASET   (WS-ERPNDB-FILE-ID)
  6427*        INTO      (PENDING-BUSINESS)
  6428*        RIDFLD    (ERPNDB-KEY)
  6429*        RESP      (WS-RESPONSE)
  6430*    END-EXEC
  6431     MOVE LENGTH OF
  6432      PENDING-BUSINESS
  6433       TO DFHEIV11
  6434*    MOVE '&"IL       E          (  N#00006276' TO DFHEIV0
  6435     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  6436     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6437     MOVE X'204E233030303036323736' TO DFHEIV0(25:11)
  6438     CALL 'kxdfhei1' USING DFHEIV0,
  6439           WS-ERPNDB-FILE-ID,
  6440           PENDING-BUSINESS,
  6441           DFHEIV11,
  6442           ERPNDB-KEY,
  6443           DFHEIV99,
  6444           DFHEIV99,
  6445           DFHEIV99
  6446     MOVE EIBRESP  TO WS-RESPONSE
  6447     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6448     IF NOT RESP-NORMAL
  6449        GO TO 0400-EXIT
  6450     END-IF
  6451*    set found-pndb to true
  6452     display ' good read on erpndb '
  6453     MOVE PB-I-INSURED-FIRST-NAME  TO EN-INS-NEW-FIRST-NAME
  6454                                      NCRTO-INS-FIRST-NAME
  6455     MOVE PB-I-INSURED-MIDDLE-INIT TO EN-INS-NEW-MIDDLE-INIT
  6456                                      NCRTO-INS-MIDDLE-INIT
  6457     MOVE PB-I-INSURED-LAST-NAME   TO EN-INS-NEW-LAST-NAME
  6458                                      NCRTO-INS-LAST-NAME
  6459     MOVE PB-I-AGE                 TO EN-INS-NEW-AGE
  6460                                      NCRTO-INS-AGE
  6461     MOVE PB-I-JOINT-FIRST-NAME    TO EN-JNT-NEW-FIRST-NAME
  6462                                      NCRTO-JNT-FIRST-NAME
  6463     MOVE PB-I-JOINT-MIDDLE-INIT   TO EN-JNT-NEW-MIDDLE-INIT
  6464                                      NCRTO-JNT-MIDDLE-INIT
  6465     MOVE PB-I-JOINT-LAST-NAME     TO EN-JNT-NEW-LAST-NAME
  6466                                      NCRTO-JNT-LAST-NAME
  6467     MOVE PB-I-JOINT-AGE           TO EN-JNT-NEW-AGE
  6468                                      NCRTO-JNT-AGE
  6469     MOVE PB-I-LF-BENEFIT-CD       TO EN-LF-NEW-BENCD
  6470                                      NCRTO-LF-BENCD
  6471     IF PB-I-LF-BENEFIT-CD NOT = '00' AND '  '
  6472        MOVE PB-I-LF-BENEFIT-AMT   TO EN-LF-NEW-BEN-AMT
  6473                                      NCRTO-LF-BEN-AMT
  6474        MOVE PB-I-LF-PREMIUM-AMT   TO EN-LF-NEW-PRM-AMT
  6475                                      NCRTO-LF-PRM-AMT
  6476        MOVE PB-I-LF-ALT-BENEFIT-AMT TO EN-LF-NEW-ALT-BEN-AMT
  6477                                      NCRTO-LF-ALT-BEN-AMT
  6478        MOVE PB-I-LF-ALT-PREMIUM-AMT TO EN-LF-NEW-ALT-PRM-AMT
  6479                                      NCRTO-LF-ALT-PRM-AMT
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 114
* EL6318.cbl
  6480        MOVE PB-I-LF-TERM          TO EN-LF-NEW-TERM
  6481                                      NCRTO-LF-TERM
  6482        MOVE PB-I-LF-EXPIRE-DT     TO EN-LF-NEW-EXP-DT
  6483                                      NCRTO-LF-EXP-DT
  6484        IF PB-I-JOINT-COMMISSION > +0
  6485           MOVE PB-I-JOINT-COMMISSION
  6486                                   TO EN-LF-NEW-COMM-PCT
  6487                                      NCRTO-LF-COMM-PCT
  6488        ELSE
  6489           MOVE PB-I-LIFE-COMMISSION
  6490                                   TO EN-LF-NEW-COMM-PCT
  6491                                      NCRTO-LF-COMM-PCT
  6492        END-IF
  6493     END-IF
  6494     MOVE PB-I-AH-BENEFIT-CD       TO EN-AH-NEW-BENCD
  6495                                      NCRTO-AH-BENCD
  6496     IF PB-I-AH-BENEFIT-CD NOT = '00' AND '  '
  6497        MOVE PB-I-AH-BENEFIT-AMT   TO EN-AH-NEW-BEN-AMT
  6498                                      NCRTO-AH-BEN-AMT
  6499        MOVE PB-I-AH-PREMIUM-AMT   TO EN-AH-NEW-PRM-AMT
  6500                                      NCRTO-AH-PRM-AMT
  6501        MOVE PB-I-AH-TERM          TO EN-AH-NEW-TERM
  6502                                      NCRTO-AH-TERM
  6503        MOVE PB-I-AH-EXPIRE-DT     TO EN-AH-NEW-EXP-DT
  6504                                      NCRTO-AH-EXP-DT
  6505        MOVE PB-I-AH-CRIT-PER      TO EN-AH-NEW-CP
  6506                                      NCRTO-AH-CP
  6507        MOVE PB-I-AH-COMMISSION    TO EN-AH-NEW-COMM-PCT
  6508                                      NCRTO-AH-COMM-PCT
  6509     END-IF
  6510     MOVE PB-I-1ST-PMT-DT          TO NCRTO-1ST-PMT-DT
  6511     MOVE PB-ENTRY-BATCH           TO EN-BATCH-NUMBER
  6512     MOVE W-ACCT-SUMM              TO EN-ACCT-SUMM
  6513     MOVE W-CSO-SUMM               TO EN-CSO-SUMM
  6514*     PERFORM 0450-GET-ERACCT     THRU 0450-EXIT
  6515     MOVE 'Y'                    TO EN-COMM-CHGBK
  6516
  6517     COMPUTE WS-DUE-BORROWER = (EN-LF-ORIG-PRM-AMT
  6518        + EN-LF-ORIG-ALT-PRM-AMT + EN-AH-ORIG-PRM-AMT) -
  6519        (EN-LF-NEW-PRM-AMT + EN-LF-NEW-ALT-PRM-AMT +
  6520        EN-AH-NEW-PRM-AMT)
  6521     COMPUTE EN-ACCT-PORTION ROUNDED =
  6522        (((EN-LF-ORIG-PRM-AMT + EN-LF-ORIG-ALT-PRM-AMT) -
  6523        (EN-LF-NEW-PRM-AMT + EN-LF-NEW-ALT-PRM-AMT))
  6524        * EN-LF-NEW-COMM-PCT)
  6525                       +
  6526        ((EN-AH-ORIG-PRM-AMT - EN-AH-NEW-PRM-AMT)
  6527        * EN-AH-NEW-COMM-PCT)
  6528     COMPUTE EN-CSO-PORTION = WS-DUE-BORROWER -
  6529        EN-ACCT-PORTION
  6530     move pb-control-by-account (1:33)
  6531                                 to ws-ermail-key
  6532
  6533* EXEC CICS READ
  6534*        DATASET   ('ERMAIL')
  6535*        SET       (ADDRESS OF MAILING-DATA)
  6536*        RIDFLD    (WS-ERMAIL-KEY)
  6537*        RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 115
* EL6318.cbl
  6538*    END-EXEC
  6539     MOVE 'ERMAIL' TO DFHEIV1
  6540*    MOVE '&"S        E          (  N#00006366' TO DFHEIV0
  6541     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6542     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6543     MOVE X'204E233030303036333636' TO DFHEIV0(25:11)
  6544     CALL 'kxdfhei1' USING DFHEIV0,
  6545           DFHEIV1,
  6546           DFHEIV20,
  6547           DFHEIV99,
  6548           WS-ERMAIL-KEY,
  6549           DFHEIV99,
  6550           DFHEIV99,
  6551           DFHEIV99
  6552     SET ADDRESS OF MAILING-DATA TO
  6553         DFHEIV20
  6554     MOVE EIBRESP  TO WS-RESPONSE
  6555     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6556     IF RESP-NORMAL
  6557        DISPLAY ' FOUND ERMAIL '
  6558        MOVE MA-CRED-BENE-NAME   TO EN-NEW-CRED-BENE
  6559                                    NCRTO-CRED-BENE-NAME
  6560     ELSE
  6561        DISPLAY ' ERMAIL READ ' WS-RESPONSE
  6562     END-IF
  6563
  6564     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
  6565     MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
  6566
  6567
  6568* EXEC CICS READ
  6569*         DATASET  (WS-ELCRTT-FILE-ID)
  6570*         RIDFLD   (WS-ELCRTT-KEY)
  6571*         SET      (ADDRESS OF CERTIFICATE-TRAILERS)
  6572*         RESP     (WS-RESPONSE)
  6573*    END-EXEC
  6574*    MOVE '&"S        E          (  N#00006383' TO DFHEIV0
  6575     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6576     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6577     MOVE X'204E233030303036333833' TO DFHEIV0(25:11)
  6578     CALL 'kxdfhei1' USING DFHEIV0,
  6579           WS-ELCRTT-FILE-ID,
  6580           DFHEIV20,
  6581           DFHEIV99,
  6582           WS-ELCRTT-KEY,
  6583           DFHEIV99,
  6584           DFHEIV99,
  6585           DFHEIV99
  6586     SET ADDRESS OF CERTIFICATE-TRAILERS TO
  6587         DFHEIV20
  6588     MOVE EIBRESP  TO WS-RESPONSE
  6589     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6590
  6591     IF RESP-NORMAL
  6592        MOVE CS-INS-AGE-DEFAULT-FLAG TO EN-INS-NEW-AGE-DEF-FLAG
  6593                                     NCRTO-INS-AGE-DEFAULT-FLAG
  6594        MOVE CS-JNT-AGE-DEFAULT-FLAG TO EN-JNT-NEW-AGE-DEF-FLAG
  6595                                     NCRTO-JNT-AGE-DEFAULT-FLAG
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 116
* EL6318.cbl
  6596     END-IF.
  6597     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  6598        IF REACD-IN (S1) NOT = LOW-VALUES
  6599           MOVE REACD-IN (S1)    TO EN-REASON-CODE (S1)
  6600        END-IF
  6601     END-PERFORM
  6602     MOVE LTRIDI                 TO EN-TEMPLATE-USED
  6603     MOVE 'G'                    TO EN-DOCU-TYPE
  6604     MOVE 'Y'                    TO EN-MONEY-SW
  6605     MOVE SIGREQI                TO EN-SIG-SW
  6606     MOVE VOUCHI                 TO EN-VOUCHER-SW
  6607     MOVE PAYEEI                 TO EN-PAYEE
  6608     MOVE HLTHAPPI               TO EN-HEALTH-APP
  6609     DISPLAY ' 0400 EXIT '
  6610     PERFORM 0430-WRITE-ERENDT   THRU 0430-EXIT
  6611     .
  6612 0400-EXIT.
  6613     EXIT.
  6614 0410-INIT-ERENDT.
  6615     display ' made it to 0410 '
  6616     MOVE OC-CONTROL-PRIMARY     TO ERENDT-KEY
  6617     MOVE ZEROS                  TO ENDT-SEQ-NO
  6618
  6619* EXEC CICS READ
  6620*        DATASET    (WS-ERENDT-FILE-ID)
  6621*        RIDFLD     (ERENDT-KEY)
  6622*        INTO       (ENDORSEMENT-RECORD)
  6623*        RESP       (WS-RESPONSE)
  6624*        GTEQ
  6625*    END-EXEC
  6626     MOVE LENGTH OF
  6627      ENDORSEMENT-RECORD
  6628       TO DFHEIV11
  6629*    MOVE '&"IL       G          (  N#00006417' TO DFHEIV0
  6630     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  6631     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6632     MOVE X'204E233030303036343137' TO DFHEIV0(25:11)
  6633     CALL 'kxdfhei1' USING DFHEIV0,
  6634           WS-ERENDT-FILE-ID,
  6635           ENDORSEMENT-RECORD,
  6636           DFHEIV11,
  6637           ERENDT-KEY,
  6638           DFHEIV99,
  6639           DFHEIV99,
  6640           DFHEIV99
  6641     MOVE EIBRESP  TO WS-RESPONSE
  6642     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6643     IF RESP-NORMAL
  6644        AND (EN-CONTROL-PRIMARY (1:34) =
  6645           OC-CONTROL-PRIMARY (1:34))
  6646        COMPUTE WS-SEQ-NO = EN-SEQ-NO - +1
  6647     ELSE
  6648        MOVE +4096               TO WS-SEQ-NO
  6649     END-IF
  6650     MOVE 'EN'                   TO ENDORSEMENT-RECORD
  6651     MOVE OC-CONTROL-PRIMARY     TO EN-CONTROL-PRIMARY
  6652     MOVE EN-COMPANY-CD          TO EN-COMPANY-CD-A1
  6653     MOVE WS-SEQ-NO              TO EN-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 117
* EL6318.cbl
  6654     INITIALIZE EN-ISSUE-RECORD
  6655     MOVE LOW-VALUES             TO EN-LF-ORIG-EXP-DT
  6656                                    EN-AH-ORIG-EXP-DT
  6657                                    EN-LF-NEW-EXP-DT
  6658                                    EN-AH-NEW-EXP-DT
  6659                                    EN-PROCESS-DT
  6660     .
  6661 0410-EXIT.
  6662     EXIT.
  6663 0420-UPDATE-ELCRTO.
  6664     PERFORM 0363-READ-ELCRTO-UPD THRU 0363-EXIT
  6665     IF RESP-NORMAL
  6666        MOVE WS-CURRENT-BIN-DT   TO OC-ENDORSEMENT-PROCESSED-DT
  6667                                    OC-LAST-MAINT-DT
  6668        MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
  6669        MOVE PI-PROCESSOR-ID     TO OC-LAST-MAINT-BY
  6670
  6671* EXEC CICS REWRITE
  6672*          FROM     (ORIGINAL-CERTIFICATE)
  6673*          DATASET  ('ELCRTO')
  6674*       END-EXEC
  6675     MOVE LENGTH OF
  6676      ORIGINAL-CERTIFICATE
  6677       TO DFHEIV11
  6678     MOVE 'ELCRTO' TO DFHEIV1
  6679*    MOVE '&& L                  %   #00006451' TO DFHEIV0
  6680     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  6681     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  6682     MOVE X'2020233030303036343531' TO DFHEIV0(25:11)
  6683     CALL 'kxdfhei1' USING DFHEIV0,
  6684           DFHEIV1,
  6685           ORIGINAL-CERTIFICATE,
  6686           DFHEIV11,
  6687           DFHEIV99
  6688     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6689     END-IF
  6690     .
  6691 0420-EXIT.
  6692     EXIT.
  6693
  6694 0425-ADD-NEW-ELCRTO.
  6695     MOVE SPACES                 TO ORIGINAL-CERTIFICATE
  6696     MOVE 'OC'                   TO OC-RECORD-ID
  6697     MOVE NEW-ELCRTO-KEY         TO OC-CONTROL-PRIMARY
  6698     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
  6699     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
  6700     MOVE WS-CURRENT-BIN-DT      TO OC-LAST-MAINT-DT
  6701     MOVE NCRTO-INS-FIRST-NAME   TO OC-INS-FIRST-NAME
  6702     MOVE NCRTO-INS-MIDDLE-INIT  TO OC-INS-MIDDLE-INIT
  6703     MOVE NCRTO-INS-LAST-NAME    TO OC-INS-LAST-NAME
  6704     MOVE NCRTO-INS-AGE          TO OC-INS-AGE
  6705     MOVE NCRTO-JNT-FIRST-NAME   TO OC-JNT-FIRST-NAME
  6706     MOVE NCRTO-JNT-MIDDLE-INIT  TO OC-JNT-MIDDLE-INIT
  6707     MOVE NCRTO-JNT-LAST-NAME    TO OC-JNT-LAST-NAME
  6708     MOVE NCRTO-JNT-AGE          TO OC-JNT-AGE
  6709     MOVE NCRTO-LF-BENCD         TO OC-LF-BENCD
  6710     MOVE NCRTO-LF-BEN-AMT       TO OC-LF-BEN-AMT
  6711     MOVE NCRTO-LF-PRM-AMT       TO OC-LF-PRM-AMT
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 118
* EL6318.cbl
  6712     MOVE NCRTO-LF-ALT-BEN-AMT   TO OC-LF-ALT-BEN-AMT
  6713     MOVE NCRTO-LF-ALT-PRM-AMT   TO OC-LF-ALT-PRM-AMT
  6714     MOVE NCRTO-LF-TERM          TO OC-LF-TERM
  6715     MOVE NCRTO-LF-EXP-DT        TO OC-LF-EXP-DT
  6716     MOVE NCRTO-LF-COMM-PCT      TO OC-LF-COMM-PCT
  6717     MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
  6718     MOVE +0                     TO OC-LF-CANCEL-AMT
  6719                                    OC-LF-ITD-CANCEL-AMT
  6720     MOVE NCRTO-AH-BENCD         TO OC-AH-BENCD
  6721     MOVE NCRTO-AH-BEN-AMT       TO OC-AH-BEN-AMT
  6722     MOVE NCRTO-AH-PRM-AMT       TO OC-AH-PRM-AMT
  6723     MOVE NCRTO-AH-TERM          TO OC-AH-TERM
  6724     MOVE NCRTO-AH-EXP-DT        TO OC-AH-EXP-DT
  6725     MOVE NCRTO-AH-CP            TO OC-AH-CP
  6726     MOVE NCRTO-AH-COMM-PCT      TO OC-AH-COMM-PCT
  6727     MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
  6728     MOVE +0                     TO OC-AH-CANCEL-AMT
  6729                                    OC-AH-ITD-CANCEL-AMT
  6730     MOVE NCRTO-CRED-BENE-NAME   TO OC-CRED-BENE-NAME
  6731     MOVE NCRTO-1ST-PMT-DT       TO OC-1ST-PMT-DT
  6732     MOVE NCRTO-INS-AGE-DEFAULT-FLAG TO OC-INS-AGE-DEFAULT-FLAG
  6733     MOVE NCRTO-JNT-AGE-DEFAULT-FLAG TO OC-JNT-AGE-DEFAULT-FLAG
  6734     MOVE LOW-VALUES             TO OC-ENDORSEMENT-PROCESSED-DT
  6735     .
  6736 0425-WRITE-ELCRTO.
  6737
  6738
  6739* EXEC CICS WRITE
  6740*       DATASET   ('ELCRTO')
  6741*       FROM      (ORIGINAL-CERTIFICATE)
  6742*       RIDFLD    (OC-CONTROL-PRIMARY)
  6743*       RESP      (WS-RESPONSE)
  6744*    END-EXEC
  6745     MOVE LENGTH OF
  6746      ORIGINAL-CERTIFICATE
  6747       TO DFHEIV11
  6748     MOVE 'ELCRTO' TO DFHEIV1
  6749*    MOVE '&$ L                  ''  N#00006504' TO DFHEIV0
  6750     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6751     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6752     MOVE X'204E233030303036353034' TO DFHEIV0(25:11)
  6753     CALL 'kxdfhei1' USING DFHEIV0,
  6754           DFHEIV1,
  6755           ORIGINAL-CERTIFICATE,
  6756           DFHEIV11,
  6757           OC-CONTROL-PRIMARY,
  6758           DFHEIV99,
  6759           DFHEIV99
  6760     MOVE EIBRESP  TO WS-RESPONSE
  6761     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6762
  6763     display ' just wrote new crto ' ws-response
  6764     IF RESP-DUPKEY
  6765        SUBTRACT +1              FROM OC-KEY-SEQ-NO
  6766        GO TO 0425-WRITE-ELCRTO
  6767     ELSE
  6768        IF NOT RESP-NORMAL
  6769           MOVE -1               TO SIGREQL
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 119
* EL6318.cbl
  6770           MOVE ER-3830          TO EMI-ERROR
  6771           PERFORM 9900-ERROR-FORMAT
  6772                                 THRU 9900-EXIT
  6773        ELSE
  6774           MOVE OC-CONTROL-PRIMARY TO PI-ELCRTO-KEY
  6775        END-IF
  6776     END-IF
  6777
  6778     .
  6779 0425-EXIT.
  6780     EXIT.
  6781
  6782 0426-ADD-CERT-NOTES.
  6783
  6784     MOVE LOW-VALUES TO CERT-NOTE-ENTRIES
  6785     SET TB-INDX TO 1
  6786
  6787     IF PI-CERTNT1-ENTERED > SPACES
  6788         MOVE PI-CERTNT1-ENTERED TO CERT-NT-TEXT (TB-INDX)
  6789         MOVE PI-PROCESSOR-ID    TO
  6790                      CERT-NT-LAST-MAINT-BY (TB-INDX)
  6791         MOVE EIBTIME            TO
  6792                      CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  6793         MOVE WS-CURRENT-BIN-DT  TO
  6794                      CERT-NT-LAST-MAINT-DT (TB-INDX)
  6795         SET TB-INDX UP BY +1
  6796     END-IF
  6797
  6798     IF PI-CERTNT2-ENTERED > SPACES
  6799         MOVE PI-CERTNT2-ENTERED TO CERT-NT-TEXT (TB-INDX)
  6800         MOVE PI-PROCESSOR-ID    TO
  6801                      CERT-NT-LAST-MAINT-BY (TB-INDX)
  6802         MOVE EIBTIME            TO
  6803                      CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  6804         MOVE WS-CURRENT-BIN-DT  TO
  6805                      CERT-NT-LAST-MAINT-DT (TB-INDX)
  6806         SET TB-INDX UP BY +1
  6807     END-IF
  6808
  6809     IF PI-CERTNT3-ENTERED > SPACES
  6810         MOVE PI-CERTNT3-ENTERED TO CERT-NT-TEXT (TB-INDX)
  6811         MOVE PI-PROCESSOR-ID    TO
  6812                      CERT-NT-LAST-MAINT-BY (TB-INDX)
  6813         MOVE EIBTIME            TO
  6814                      CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  6815         MOVE WS-CURRENT-BIN-DT  TO
  6816                      CERT-NT-LAST-MAINT-DT (TB-INDX)
  6817         SET TB-INDX UP BY +1
  6818     END-IF
  6819
  6820     IF PI-CERTNT4-ENTERED > SPACES
  6821         MOVE PI-CERTNT4-ENTERED TO CERT-NT-TEXT (TB-INDX)
  6822         MOVE PI-PROCESSOR-ID    TO
  6823                      CERT-NT-LAST-MAINT-BY (TB-INDX)
  6824         MOVE EIBTIME            TO
  6825                      CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  6826         MOVE WS-CURRENT-BIN-DT  TO
  6827                      CERT-NT-LAST-MAINT-DT (TB-INDX)
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 120
* EL6318.cbl
  6828         SET TB-INDX UP BY +1
  6829     END-IF
  6830
  6831     IF CERT-NOTE-ENTRIES > SPACES
  6832         PERFORM 0427-LOAD-CURRENT-CERT-NOTES THRU 0427-EXIT
  6833         PERFORM 1700-WRITE-CERT-NOTE THRU 1799-EXIT
  6834     END-IF
  6835
  6836     IF PI-BILLNT1-ENTERED > SPACES
  6837         MOVE SPACES             TO WS-MANUAL-BILL-NOTE
  6838         MOVE PI-BILLNT1-ENTERED TO WS-MAN-BN-NOTE
  6839         MOVE +63 TO WS-LEN
  6840         PERFORM 0441-UPDATE-BILLING-NOTE THRU 0441-EXIT
  6841     END-IF
  6842
  6843     IF PI-BILLNT2-ENTERED > SPACES
  6844         MOVE SPACES             TO WS-MANUAL-BILL-NOTE
  6845         MOVE PI-BILLNT2-ENTERED TO WS-MAN-BN-NOTE
  6846         MOVE +63 TO WS-LEN
  6847         PERFORM 0441-UPDATE-BILLING-NOTE THRU 0441-EXIT
  6848     END-IF
  6849
  6850     .
  6851 0426-EXIT.
  6852     EXIT.
  6853
  6854 0427-LOAD-CURRENT-CERT-NOTES.
  6855
  6856     MOVE PI-CRTO-COMPANY-CD  TO ERCNOT-COMPANY-CD
  6857     MOVE PI-CRTO-CARRIER     TO ERCNOT-CARRIER
  6858     MOVE PI-CRTO-GROUPING    TO ERCNOT-GROUPING
  6859     MOVE PI-CRTO-STATE       TO ERCNOT-STATE
  6860     MOVE PI-CRTO-ACCOUNT     TO ERCNOT-ACCOUNT
  6861     MOVE PI-CRTO-CERT-EFF-DT TO ERCNOT-EFF-DT
  6862     MOVE PI-CRTO-CERT-PRIME  TO ERCNOT-CERT-PRIME
  6863     MOVE PI-CRTO-CERT-SFX    TO ERCNOT-CERT-SFX
  6864     MOVE '1'                 TO ERCNOT-REC-TYP
  6865     MOVE +0                  TO ERCNOT-SEQ
  6866     MOVE ERCNOT-PARTIAL-KEY  TO SV-PARTIAL-KEY
  6867
  6868
  6869* EXEC CICS STARTBR
  6870*         DATASET(WS-ERCNOT-FILE-ID)
  6871*         RIDFLD(ERCNOT-KEY)
  6872*         KEYLENGTH(ERCNOT-START-LENGTH)
  6873*         RESP      (WS-RESPONSE)
  6874*         GENERIC
  6875*         GTEQ
  6876*    END-EXEC.
  6877     MOVE 0
  6878       TO DFHEIV11
  6879*    MOVE '&,   KG    G          &  N#00006616' TO DFHEIV0
  6880     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
  6881     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6882     MOVE X'204E233030303036363136' TO DFHEIV0(25:11)
  6883     CALL 'kxdfhei1' USING DFHEIV0,
  6884           WS-ERCNOT-FILE-ID,
  6885           ERCNOT-KEY,
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 121
* EL6318.cbl
  6886           ERCNOT-START-LENGTH,
  6887           DFHEIV11,
  6888           DFHEIV99
  6889     MOVE EIBRESP  TO WS-RESPONSE
  6890     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6891
  6892
  6893     IF NOT RESP-NORMAL
  6894        GO TO 0427-ENDBR
  6895     END-IF.
  6896
  6897 0427-LOOP.
  6898
  6899* EXEC CICS READNEXT
  6900*         SET(ADDRESS OF CERT-NOTE-FILE)
  6901*         DATASET(WS-ERCNOT-FILE-ID)
  6902*         RIDFLD(ERCNOT-KEY)
  6903*    END-EXEC.
  6904     MOVE 0
  6905       TO DFHEIV11
  6906*    MOVE '&.S                   )   #00006630' TO DFHEIV0
  6907     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  6908     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6909     MOVE X'2020233030303036363330' TO DFHEIV0(25:11)
  6910     CALL 'kxdfhei1' USING DFHEIV0,
  6911           WS-ERCNOT-FILE-ID,
  6912           DFHEIV20,
  6913           DFHEIV99,
  6914           ERCNOT-KEY,
  6915           DFHEIV99,
  6916           DFHEIV11,
  6917           DFHEIV99,
  6918           DFHEIV99
  6919     SET ADDRESS OF CERT-NOTE-FILE TO
  6920         DFHEIV20
  6921     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6922
  6923
  6924     IF CZ-COMPANY-CD NOT = PI-CRTO-COMPANY-CD
  6925         GO TO 0427-ENDBR
  6926     END-IF.
  6927
  6928     IF (CZ-CARRIER = SV-CARRIER)
  6929        AND (CZ-GROUPING = SV-GROUPING)
  6930        AND (CZ-STATE = SV-STATE)
  6931        AND (CZ-ACCOUNT = SV-ACCOUNT)
  6932        AND (CZ-CERT-EFF-DT = SV-EFF-DT)
  6933        AND (CZ-CERT-NO = SV-CERT-NO)
  6934        AND (CZ-RECORD-TYPE = '1')
  6935          MOVE CZ-NOTE TO CERT-NT-TEXT (TB-INDX)
  6936          MOVE CZ-LAST-MAINT-USER TO
  6937                      CERT-NT-LAST-MAINT-BY (TB-INDX)
  6938          MOVE CZ-LAST-MAINT-DT TO
  6939                      CERT-NT-LAST-MAINT-DT (TB-INDX)
  6940          MOVE CZ-LAST-MAINT-HHMMSS TO
  6941                      CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  6942          SET TB-INDX UP BY 1
  6943          GO TO 0427-LOOP
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 122
* EL6318.cbl
  6944     END-IF.
  6945
  6946 0427-ENDBR.
  6947
  6948
  6949* EXEC CICS ENDBR
  6950*         DATASET(WS-ERCNOT-FILE-ID)
  6951*    END-EXEC.
  6952     MOVE 0
  6953       TO DFHEIV11
  6954*    MOVE '&2                    $   #00006660' TO DFHEIV0
  6955     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6956     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6957     MOVE X'2020233030303036363630' TO DFHEIV0(25:11)
  6958     CALL 'kxdfhei1' USING DFHEIV0,
  6959           WS-ERCNOT-FILE-ID,
  6960           DFHEIV11,
  6961           DFHEIV99
  6962     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6963
  6964
  6965     .
  6966 0427-EXIT.
  6967     EXIT.
  6968
  6969 0430-WRITE-ERENDT.
  6970     DISPLAY ' NO ERRORS, ABOUT TO WRITE ERENDT '
  6971     MOVE EN-CONTROL-PRIMARY     TO PI-ERENDT-KEY
  6972     MOVE W-ARCH-NUMBER          TO EN-ARCHIVE-NO
  6973
  6974* EXEC CICS WRITE
  6975*         DATASET   (WS-ERENDT-FILE-ID)
  6976*         FROM      (ENDORSEMENT-RECORD)
  6977*         RIDFLD    (EN-CONTROL-PRIMARY)
  6978*         RESP      (WS-RESPONSE)
  6979*    END-EXEC
  6980     MOVE LENGTH OF
  6981      ENDORSEMENT-RECORD
  6982       TO DFHEIV11
  6983*    MOVE '&$ L                  ''  N#00006672' TO DFHEIV0
  6984     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6985     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6986     MOVE X'204E233030303036363732' TO DFHEIV0(25:11)
  6987     CALL 'kxdfhei1' USING DFHEIV0,
  6988           WS-ERENDT-FILE-ID,
  6989           ENDORSEMENT-RECORD,
  6990           DFHEIV11,
  6991           EN-CONTROL-PRIMARY,
  6992           DFHEIV99,
  6993           DFHEIV99
  6994     MOVE EIBRESP  TO WS-RESPONSE
  6995     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6996     IF RESP-NORMAL
  6997        MOVE 'G'                 TO PI-DOCUMENT-PROCESSED
  6998        display ' good write erendt '
  6999        IF EIBAID = DFHPF4
  7000           PERFORM 0420-UPDATE-ELCRTO THRU 0420-EXIT
  7001           PERFORM 0425-ADD-NEW-ELCRTO THRU 0425-EXIT
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 123
* EL6318.cbl
  7002           PERFORM 0426-ADD-CERT-NOTES THRU 0426-EXIT
  7003           PERFORM 0440-ADD-BILLING-NOTE THRU 0440-EXIT
  7004        END-IF
  7005     ELSE
  7006        DISPLAY ' NOT A GOOD WRITE ERENDT ' WS-RESPONSE
  7007        MOVE -1                  TO SIGREQL
  7008        MOVE ER-0132             TO EMI-ERROR
  7009        MOVE AL-UABON            TO SIGREQA
  7010        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7011     END-IF
  7012     .
  7013 0430-EXIT.
  7014     EXIT.
  7015
  7016
  7017 0440-ADD-BILLING-NOTE.
  7018
  7019* EXEC CICS GETMAIN
  7020*         SET      (ADDRESS OF EOB-CODES)
  7021*         LENGTH   (ELEOBC-LENGTH)
  7022*         INITIMG  (GETMAIN-SPACE)
  7023*    END-EXEC
  7024*    MOVE ',"IL                  $   #00006700' TO DFHEIV0
  7025     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7026     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7027     MOVE X'2020233030303036373030' TO DFHEIV0(25:11)
  7028     CALL 'kxdfhei1' USING DFHEIV0,
  7029           DFHEIV20,
  7030           ELEOBC-LENGTH,
  7031           GETMAIN-SPACE
  7032     SET ADDRESS OF EOB-CODES TO
  7033         DFHEIV20
  7034     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7035
  7036     MOVE LOW-VALUES             TO WS-ELEOBC-KEY
  7037     MOVE PI-COMPANY-CD          TO WS-EOBC-COMPANY-CD
  7038     MOVE '5'                    TO WS-EOBC-REC-TYPE
  7039
  7040
  7041* EXEC CICS STARTBR
  7042*        DATASET   ('ELEOBC')
  7043*        RIDFLD    (WS-ELEOBC-KEY)
  7044*        GTEQ
  7045*        RESP      (WS-RESPONSE)
  7046*    END-EXEC
  7047     MOVE 'ELEOBC' TO DFHEIV1
  7048     MOVE 0
  7049       TO DFHEIV11
  7050*    MOVE '&,         G          &  N#00006710' TO DFHEIV0
  7051     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7052     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7053     MOVE X'204E233030303036373130' TO DFHEIV0(25:11)
  7054     CALL 'kxdfhei1' USING DFHEIV0,
  7055           DFHEIV1,
  7056           WS-ELEOBC-KEY,
  7057           DFHEIV99,
  7058           DFHEIV11,
  7059           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 124
* EL6318.cbl
  7060     MOVE EIBRESP  TO WS-RESPONSE
  7061     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7062
  7063     IF NOT RESP-NORMAL
  7064        GO TO 0440-EXIT
  7065     END-IF
  7066      .
  7067 0440-READNEXT-ELEOBC.
  7068
  7069
  7070* EXEC CICS READNEXT
  7071*       INTO    (EOB-CODES)
  7072*       DATASET ('ELEOBC')
  7073*       RIDFLD  (WS-ELEOBC-KEY)
  7074*       RESP    (WS-RESPONSE)
  7075*    END-EXEC
  7076     MOVE LENGTH OF
  7077      EOB-CODES
  7078       TO DFHEIV12
  7079     MOVE 'ELEOBC' TO DFHEIV1
  7080     MOVE 0
  7081       TO DFHEIV11
  7082*    MOVE '&.IL                  )  N#00006723' TO DFHEIV0
  7083     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  7084     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7085     MOVE X'204E233030303036373233' TO DFHEIV0(25:11)
  7086     CALL 'kxdfhei1' USING DFHEIV0,
  7087           DFHEIV1,
  7088           EOB-CODES,
  7089           DFHEIV12,
  7090           WS-ELEOBC-KEY,
  7091           DFHEIV99,
  7092           DFHEIV11,
  7093           DFHEIV99,
  7094           DFHEIV99
  7095     MOVE EIBRESP  TO WS-RESPONSE
  7096     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7097
  7098     IF RESP-NORMAL
  7099         IF EO-RECORD-TYPE NOT = '5'
  7100             GO TO 0440-EXIT
  7101         END-IF
  7102     ELSE
  7103         GO TO 0440-EXIT
  7104     END-IF
  7105
  7106     IF EO-RECORD-TYPE = '5' AND
  7107        EO-EOB-CODE = PI-LTRID-ENTERED
  7108           CONTINUE
  7109     ELSE
  7110         GO TO 0440-READNEXT-ELEOBC
  7111     END-IF
  7112
  7113     MOVE SPACES TO WS-BILLING-NOTE
  7114     MOVE EO-DESCRIPTION TO WS-BN-NOTE
  7115     MOVE PI-LTRID-ENTERED TO WS-BN-LTRID
  7116     MOVE WS-CURRENT-DT TO WS-BN-DATE
  7117     MOVE PI-PROCESSOR-ID TO WS-BN-USERID
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 125
* EL6318.cbl
  7118     MOVE +25 TO WS-LEN
  7119
  7120     PERFORM 0441-UPDATE-BILLING-NOTE THRU 0441-EXIT
  7121     .
  7122 0440-EXIT.
  7123     EXIT.
  7124
  7125 0441-UPDATE-BILLING-NOTE.
  7126
  7127* EXEC CICS GETMAIN
  7128*         SET      (ADDRESS OF CERTIFICATE-NOTE)
  7129*         LENGTH   (ERNOTE-LENGTH)
  7130*         INITIMG  (GETMAIN-SPACE)
  7131*    END-EXEC
  7132*    MOVE ',"IL                  $   #00006758' TO DFHEIV0
  7133     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7134     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7135     MOVE X'2020233030303036373538' TO DFHEIV0(25:11)
  7136     CALL 'kxdfhei1' USING DFHEIV0,
  7137           DFHEIV20,
  7138           ERNOTE-LENGTH,
  7139           GETMAIN-SPACE
  7140     SET ADDRESS OF CERTIFICATE-NOTE TO
  7141         DFHEIV20
  7142     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7143
  7144     MOVE PI-ERENDT-KEY (1:33) TO WS-ERNOTE-KEY
  7145
  7146
  7147* EXEC CICS READ
  7148*       DATASET    (WS-ERNOTE-FILE-ID)
  7149*       RIDFLD     (WS-ERNOTE-KEY)
  7150*       INTO       (CERTIFICATE-NOTE)
  7151*       RESP       (WS-RESPONSE)
  7152*       UPDATE
  7153*    END-EXEC
  7154     MOVE LENGTH OF
  7155      CERTIFICATE-NOTE
  7156       TO DFHEIV11
  7157*    MOVE '&"IL       EU         (  N#00006766' TO DFHEIV0
  7158     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  7159     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7160     MOVE X'204E233030303036373636' TO DFHEIV0(25:11)
  7161     CALL 'kxdfhei1' USING DFHEIV0,
  7162           WS-ERNOTE-FILE-ID,
  7163           CERTIFICATE-NOTE,
  7164           DFHEIV11,
  7165           WS-ERNOTE-KEY,
  7166           DFHEIV99,
  7167           DFHEIV99,
  7168           DFHEIV99
  7169     MOVE EIBRESP  TO WS-RESPONSE
  7170     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7171
  7172     IF RESP-NORMAL
  7173       IF CN-BILLING-START-LINE-NO NOT NUMERIC
  7174          MOVE ZEROS            TO CN-BILLING-START-LINE-NO
  7175       END-IF
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 126
* EL6318.cbl
  7176       IF CN-BILLING-END-LINE-NO NOT NUMERIC
  7177          MOVE ZEROS            TO CN-BILLING-END-LINE-NO
  7178       END-IF
  7179       PERFORM VARYING NOTE-SUB FROM +1 BY +1 UNTIL
  7180           (NOTE-SUB > +10) OR
  7181           (CN-LINE (NOTE-SUB) (1:WS-LEN) =
  7182                             WS-BILLING-NOTE (1:WS-LEN))
  7183       END-PERFORM
  7184       IF CN-LINE (NOTE-SUB) (1:WS-LEN) =
  7185                              WS-BILLING-NOTE (1:WS-LEN)
  7186
  7187* EXEC CICS UNLOCK
  7188*           DATASET    (WS-ERNOTE-FILE-ID)
  7189*        END-EXEC
  7190*    MOVE '&*                    #   #00006788' TO DFHEIV0
  7191     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  7192     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7193     MOVE X'2020233030303036373838' TO DFHEIV0(25:11)
  7194     CALL 'kxdfhei1' USING DFHEIV0,
  7195           WS-ERNOTE-FILE-ID,
  7196           DFHEIV99
  7197     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7198       ELSE
  7199         PERFORM VARYING NOTE-SUB FROM +1 BY +1 UNTIL
  7200           (NOTE-SUB > +10) OR
  7201           (CN-LINE (NOTE-SUB) = SPACES OR LOW-VALUES)
  7202         END-PERFORM
  7203         IF (NOTE-SUB < +11)
  7204           IF NOTE-SUB >= CN-BILLING-START-LINE-NO AND
  7205              NOTE-SUB <= CN-BILLING-END-LINE-NO
  7206                MOVE WS-BILLING-NOTE TO CN-LINE (NOTE-SUB)
  7207           ELSE
  7208             IF (CN-BILLING-END-LINE-NO NOT = ZEROS) AND
  7209              (NOTE-SUB = (CN-BILLING-END-LINE-NO + +1))
  7210                MOVE WS-BILLING-NOTE   TO CN-LINE (NOTE-SUB)
  7211                MOVE NOTE-SUB     TO CN-BILLING-END-LINE-NO
  7212             ELSE
  7213               IF (CN-BILLING-START-LINE-NO NOT = ZEROS) AND
  7214                  (NOTE-SUB = (CN-BILLING-START-LINE-NO - +1))
  7215                     MOVE WS-BILLING-NOTE TO CN-LINE (NOTE-SUB)
  7216                     MOVE NOTE-SUB  TO CN-BILLING-START-LINE-NO
  7217               ELSE
  7218                 IF (CN-BILLING-END-LINE-NO = ZEROS)
  7219                   MOVE WS-BILLING-NOTE  TO CN-LINE (NOTE-SUB)
  7220                   MOVE NOTE-SUB    TO CN-BILLING-END-LINE-NO
  7221                                       CN-BILLING-START-LINE-NO
  7222                 ELSE
  7223                    PERFORM 0442-SQUEEZE-IT-IN THRU 0442-EXIT
  7224                 END-IF
  7225               END-IF
  7226             END-IF
  7227           END-IF
  7228           MOVE PI-PROCESSOR-ID     TO CN-LAST-MAINT-USER
  7229           MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
  7230           MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
  7231
  7232* EXEC CICS REWRITE
  7233*             DATASET    (WS-ERNOTE-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 127
* EL6318.cbl
  7234*             FROM       (CERTIFICATE-NOTE)
  7235*             RESP       (WS-RESPONSE)
  7236*          END-EXEC
  7237     MOVE LENGTH OF
  7238      CERTIFICATE-NOTE
  7239       TO DFHEIV11
  7240*    MOVE '&& L                  %  N#00006824' TO DFHEIV0
  7241     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7242     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7243     MOVE X'204E233030303036383234' TO DFHEIV0(25:11)
  7244     CALL 'kxdfhei1' USING DFHEIV0,
  7245           WS-ERNOTE-FILE-ID,
  7246           CERTIFICATE-NOTE,
  7247           DFHEIV11,
  7248           DFHEIV99
  7249     MOVE EIBRESP  TO WS-RESPONSE
  7250     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7251           PERFORM 0445-CERTIFICATE-UPDATE THRU 0445-EXIT
  7252         END-IF
  7253       END-IF
  7254     ELSE
  7255        MOVE SPACES              TO CERTIFICATE-NOTE
  7256        MOVE 'CN'                TO CN-RECORD-ID
  7257        MOVE PI-ERENDT-KEY (1:33) TO CN-CONTROL-PRIMARY
  7258                                     WS-ERNOTE-KEY
  7259        MOVE 01                  TO CN-BILLING-START-LINE-NO
  7260                                    CN-BILLING-END-LINE-NO
  7261        MOVE WS-BILLING-NOTE     TO CN-LINE (01)
  7262        MOVE PI-PROCESSOR-ID     TO CN-LAST-MAINT-USER
  7263        MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
  7264        MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
  7265
  7266* EXEC CICS WRITE
  7267*          DATASET    (WS-ERNOTE-FILE-ID)
  7268*          FROM       (CERTIFICATE-NOTE)
  7269*          RIDFLD     (WS-ERNOTE-KEY)
  7270*          RESP       (WS-RESPONSE)
  7271*       END-EXEC
  7272     MOVE LENGTH OF
  7273      CERTIFICATE-NOTE
  7274       TO DFHEIV11
  7275*    MOVE '&$ L                  ''  N#00006843' TO DFHEIV0
  7276     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7277     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7278     MOVE X'204E233030303036383433' TO DFHEIV0(25:11)
  7279     CALL 'kxdfhei1' USING DFHEIV0,
  7280           WS-ERNOTE-FILE-ID,
  7281           CERTIFICATE-NOTE,
  7282           DFHEIV11,
  7283           WS-ERNOTE-KEY,
  7284           DFHEIV99,
  7285           DFHEIV99
  7286     MOVE EIBRESP  TO WS-RESPONSE
  7287     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7288
  7289        PERFORM 0445-CERTIFICATE-UPDATE THRU 0445-EXIT
  7290     END-IF
  7291
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 128
* EL6318.cbl
  7292     .
  7293 0441-EXIT.
  7294     EXIT.
  7295
  7296
  7297 0442-SQUEEZE-IT-IN.
  7298
  7299     IF NOTE-SUB < CN-BILLING-START-LINE-NO
  7300        PERFORM VARYING NOTE-SUB FROM NOTE-SUB BY +1 UNTIL
  7301           NOTE-SUB = +10
  7302           MOVE CN-LINE (NOTE-SUB + 1) TO CN-LINE (NOTE-SUB)
  7303           IF (NOTE-SUB + 1) = (CN-BILLING-START-LINE-NO - 1)
  7304             MOVE WS-BILLING-NOTE TO CN-LINE (NOTE-SUB + 1)
  7305             COMPUTE CN-BILLING-START-LINE-NO = NOTE-SUB + 1
  7306             MOVE +9 TO NOTE-SUB
  7307           END-IF
  7308        END-PERFORM
  7309     ELSE
  7310        IF NOTE-SUB > CN-BILLING-END-LINE-NO
  7311           PERFORM VARYING NOTE-SUB FROM NOTE-SUB BY -1
  7312             UNTIL NOTE-SUB = +1
  7313             MOVE CN-LINE (NOTE-SUB - 1) TO CN-LINE (NOTE-SUB)
  7314             IF (NOTE-SUB - 1) = (CN-BILLING-END-LINE-NO + 1)
  7315                MOVE WS-BILLING-NOTE  TO CN-LINE (NOTE-SUB - 1)
  7316                COMPUTE CN-BILLING-END-LINE-NO = NOTE-SUB - 1
  7317                MOVE +2          TO NOTE-SUB
  7318             END-IF
  7319           END-PERFORM
  7320        END-IF
  7321     END-IF
  7322
  7323     .
  7324 0442-EXIT.
  7325     EXIT.
  7326
  7327 0445-CERTIFICATE-UPDATE.
  7328    display 'billing note written, updating cert'
  7329     PERFORM 1800-READ-ELCERT-UPDATE THRU 1800-EXIT
  7330     IF RESP-NORMAL
  7331        EVALUATE CM-NOTE-SW
  7332           WHEN '2'
  7333           WHEN '3'
  7334           WHEN '6'
  7335           WHEN '7'
  7336              SET NO-CERT-RW     TO TRUE
  7337           WHEN ' '
  7338              MOVE '2'           TO CM-NOTE-SW
  7339           WHEN '1'
  7340              MOVE '3'           TO CM-NOTE-SW
  7341           WHEN '4'
  7342              MOVE '6'           TO CM-NOTE-SW
  7343           WHEN '5'
  7344              MOVE '7'           TO CM-NOTE-SW
  7345        END-EVALUATE
  7346     END-IF
  7347     IF NOT NO-CERT-RW
  7348        PERFORM 1810-REWRITE-ELCERT
  7349                                 THRU 1810-EXIT
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 129
* EL6318.cbl
  7350     ELSE
  7351
  7352* EXEC CICS UNLOCK
  7353*          DATASET    (WS-ELCERT-FILE-ID)
  7354*       END-EXEC
  7355*    MOVE '&*                    #   #00006912' TO DFHEIV0
  7356     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  7357     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7358     MOVE X'2020233030303036393132' TO DFHEIV0(25:11)
  7359     CALL 'kxdfhei1' USING DFHEIV0,
  7360           WS-ELCERT-FILE-ID,
  7361           DFHEIV99
  7362     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7363     END-IF
  7364
  7365     .
  7366 0445-EXIT.
  7367     EXIT.
  7368
  7369 0450-GET-ERACCT.
  7370     MOVE ' '                    TO WS-ERACCT-SW
  7371     MOVE ZEROS                  TO WS-CHGBACK
  7372                                    WS-CSO-PORTION
  7373                                    WS-ACCT-PORTION
  7374                                    WS-DIFF
  7375     PERFORM 0460-STARTBR-ERACCT THRU 0460-EXIT
  7376     IF RESP-NORMAL
  7377        PERFORM 0470-READNEXT-ERACCT
  7378                                 THRU 0470-EXIT
  7379     END-IF
  7380     IF RESP-NORMAL
  7381        IF AM-CONTROL-PRIMARY (1:20) = EN-CONTROL-PRIMARY (1:20)
  7382           IF EN-CERT-EFF-DT < AM-EXPIRATION-DT
  7383              AND >= AM-EFFECTIVE-DT
  7384              SET ACCT-FOUND TO TRUE
  7385           ELSE
  7386              PERFORM 0470-READNEXT-ERACCT
  7387                                 THRU 0470-EXIT
  7388              IF RESP-NORMAL
  7389                 IF AM-CONTROL-PRIMARY (1:20)
  7390                    = EN-CONTROL-PRIMARY (1:20)
  7391                    IF EN-CERT-EFF-DT < AM-EXPIRATION-DT
  7392                       AND >= AM-EFFECTIVE-DT
  7393                       SET ACCT-FOUND TO TRUE
  7394                    END-IF
  7395                 END-IF
  7396              END-IF
  7397           END-IF
  7398        END-IF
  7399     END-IF
  7400     IF ACCT-FOUND
  7401        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  7402           (AM-COM-TYP (S1) = 'C' OR 'D')
  7403           OR (S1 > +10)
  7404        END-PERFORM
  7405        IF S1 < +11
  7406           MOVE AM-COMM-CHARGEBACK (S1)
  7407                                 TO WS-CHGBACK
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 130
* EL6318.cbl
  7408        END-IF
  7409     END-IF
  7410    .
  7411 0450-EXIT.
  7412     EXIT.
  7413 0460-STARTBR-ERACCT.
  7414     MOVE LOW-VALUES             TO WS-ERACCT-KEY
  7415     MOVE EN-CONTROL-PRIMARY     TO WS-ERACCT-KEY (1:22)
  7416     MOVE WS-ERACCT-KEY          TO WS-SAVE-ERACCT-KEY
  7417
  7418* EXEC CICS STARTBR
  7419*        DATASET   ('ERACCT')
  7420*        RIDFLD    (WS-ERACCT-KEY)
  7421*        GTEQ
  7422*        RESP      (WS-RESPONSE)
  7423*    END-EXEC
  7424     MOVE 'ERACCT' TO DFHEIV1
  7425     MOVE 0
  7426       TO DFHEIV11
  7427*    MOVE '&,         G          &  N#00006969' TO DFHEIV0
  7428     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7429     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7430     MOVE X'204E233030303036393639' TO DFHEIV0(25:11)
  7431     CALL 'kxdfhei1' USING DFHEIV0,
  7432           DFHEIV1,
  7433           WS-ERACCT-KEY,
  7434           DFHEIV99,
  7435           DFHEIV11,
  7436           DFHEIV99
  7437     MOVE EIBRESP  TO WS-RESPONSE
  7438     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7439     .
  7440 0460-EXIT.
  7441     EXIT.
  7442 0470-READNEXT-ERACCT.
  7443
  7444* EXEC CICS READNEXT
  7445*       INTO    (ACCOUNT-MASTER)
  7446*       DATASET ('ERACCT')
  7447*       RIDFLD  (WS-ERACCT-KEY)
  7448*       RESP    (WS-RESPONSE)
  7449*    END-EXEC
  7450     MOVE LENGTH OF
  7451      ACCOUNT-MASTER
  7452       TO DFHEIV12
  7453     MOVE 'ERACCT' TO DFHEIV1
  7454     MOVE 0
  7455       TO DFHEIV11
  7456*    MOVE '&.IL                  )  N#00006979' TO DFHEIV0
  7457     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  7458     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7459     MOVE X'204E233030303036393739' TO DFHEIV0(25:11)
  7460     CALL 'kxdfhei1' USING DFHEIV0,
  7461           DFHEIV1,
  7462           ACCOUNT-MASTER,
  7463           DFHEIV12,
  7464           WS-ERACCT-KEY,
  7465           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 131
* EL6318.cbl
  7466           DFHEIV11,
  7467           DFHEIV99,
  7468           DFHEIV99
  7469     MOVE EIBRESP  TO WS-RESPONSE
  7470     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7471     .
  7472 0470-EXIT.
  7473     EXIT.
  7474 0500-CREATE-TEMP-STORAGE.
  7475     display ' about to write pi ' program-interface-block
  7476
  7477* EXEC CICS WRITEQ TS
  7478*        QUEUE (QID)
  7479*        FROM  (PROGRAM-INTERFACE-BLOCK)
  7480*        LENGTH(PI-COMM-LENGTH)
  7481*    END-EXEC
  7482*    MOVE '*"                    ''   #00006990' TO DFHEIV0
  7483     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  7484     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7485     MOVE X'2020233030303036393930' TO DFHEIV0(25:11)
  7486     CALL 'kxdfhei1' USING DFHEIV0,
  7487           QID,
  7488           PROGRAM-INTERFACE-BLOCK,
  7489           PI-COMM-LENGTH,
  7490           DFHEIV99,
  7491           DFHEIV99,
  7492           DFHEIV99
  7493     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7494     display ' about to write map ' el631ki
  7495
  7496* EXEC CICS WRITEQ TS
  7497*        QUEUE (QID)
  7498*        FROM  (EL631KI)
  7499*        LENGTH(MAP-LENGTH)
  7500*    END-EXEC.
  7501*    MOVE '*"                    ''   #00006996' TO DFHEIV0
  7502     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  7503     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7504     MOVE X'2020233030303036393936' TO DFHEIV0(25:11)
  7505     CALL 'kxdfhei1' USING DFHEIV0,
  7506           QID,
  7507           EL631KI,
  7508           MAP-LENGTH,
  7509           DFHEIV99,
  7510           DFHEIV99,
  7511           DFHEIV99
  7512     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7513
  7514 0500-EXIT.
  7515      EXIT.
  7516 0600-RECOVER-TEMP-STORAGE.
  7517     display ' about to recover pi '
  7518
  7519* EXEC CICS READQ TS
  7520*        QUEUE (QID)
  7521*        INTO  (PROGRAM-INTERFACE-BLOCK)
  7522*        LENGTH(PI-COMM-LENGTH)
  7523*    END-EXEC
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 132
* EL6318.cbl
  7524*    MOVE '*$I    L              ''   #00007005' TO DFHEIV0
  7525     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7526     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7527     MOVE X'2020233030303037303035' TO DFHEIV0(25:11)
  7528     CALL 'kxdfhei1' USING DFHEIV0,
  7529           QID,
  7530           PROGRAM-INTERFACE-BLOCK,
  7531           PI-COMM-LENGTH,
  7532           DFHEIV99,
  7533           DFHEIV99,
  7534           DFHEIV99
  7535     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7536     display ' pi ' pi-program-work-area
  7537     display ' about to recover map '
  7538
  7539* EXEC CICS READQ TS
  7540*        QUEUE (QID)
  7541*        INTO  (EL631KI)
  7542*        LENGTH(MAP-LENGTH)
  7543*    END-EXEC
  7544*    MOVE '*$I    L              ''   #00007012' TO DFHEIV0
  7545     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7546     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7547     MOVE X'2020233030303037303132' TO DFHEIV0(25:11)
  7548     CALL 'kxdfhei1' USING DFHEIV0,
  7549           QID,
  7550           EL631KI,
  7551           MAP-LENGTH,
  7552           DFHEIV99,
  7553           DFHEIV99,
  7554           DFHEIV99
  7555     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7556     display ' map ' el631ki
  7557     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
  7558     MOVE AL-UANON            TO SIGREQA
  7559     MOVE AL-UANON            TO LTRIDA
  7560     MOVE AL-UANON            TO VOUCHA
  7561     MOVE AL-UANON            TO HLTHAPPA
  7562     MOVE AL-UANON            TO PAYEEA
  7563     IF WS-SET-CODES-MDT = 'Y'
  7564        move +1                  to s2
  7565        perform varying s1 from +1 by +5 until s1 > +60
  7566           MOVE WS-PASSED-REASON-CODES (s1:4)
  7567                                 TO reacd-in (s2)
  7568           IF REACD-IN (S2) NOT EQUAL SPACES AND LOW-VALUES
  7569               MOVE AL-SANON     TO REACDA (S2)
  7570               MOVE +4           TO REACDL (S2)
  7571           END-IF
  7572           add +1                to s2
  7573        end-perform
  7574        MOVE REASONCDS       TO PI-REASONS-ENTERED
  7575     END-IF
  7576     IF CERTIDI > SPACES
  7577         MOVE AL-UANON       TO CERTIDA
  7578     END-IF
  7579
  7580     IF CRTNT1I > SPACES
  7581         MOVE AL-UANON       TO CRTNT1A
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 133
* EL6318.cbl
  7582     END-IF
  7583
  7584     IF CRTNT2I > SPACES
  7585         MOVE AL-UANON       TO CRTNT2A
  7586     END-IF
  7587
  7588     IF CRTNT3I > SPACES
  7589         MOVE AL-UANON       TO CRTNT3A
  7590     END-IF
  7591
  7592     IF CRTNT4I > SPACES
  7593         MOVE AL-UANON       TO CRTNT4A
  7594     END-IF
  7595
  7596     IF BILNT1I > SPACES
  7597         MOVE AL-UANON       TO BILNT1A
  7598     END-IF
  7599
  7600     IF BILNT2I > SPACES
  7601         MOVE AL-UANON       TO BILNT2A
  7602     END-IF
  7603     .
  7604 0600-EXIT.
  7605      EXIT.
  7606 0800-DELETE-TS.
  7607
  7608* EXEC CICS DELETEQ TS
  7609*        QUEUE(QID)
  7610*    END-EXEC
  7611*    MOVE '*&                    #   #00007068' TO DFHEIV0
  7612     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  7613     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7614     MOVE X'2020233030303037303638' TO DFHEIV0(25:11)
  7615     CALL 'kxdfhei1' USING DFHEIV0,
  7616           QID,
  7617           DFHEIV99
  7618     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7619     .
  7620 0800-EXIT.
  7621      EXIT.
  7622 1000-BUILD-ERARCH.
  7623     display ' made it to 1000 '
  7624     MOVE SPACES                 TO W-CNTL-KEY
  7625     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID
  7626     MOVE '1'                    TO W-CNTL-RECORD-TYPE
  7627     MOVE ZEROS                  TO W-CNTL-SEQ-NO
  7628
  7629* EXEC CICS READ
  7630*         DATASET    (WS-ELCNTL-FILE-ID)
  7631*         SET        (ADDRESS OF CONTROL-FILE)
  7632*         RIDFLD     (W-CNTL-KEY)
  7633*         UPDATE
  7634*         RESP       (WS-RESPONSE)
  7635*    END-EXEC
  7636*    MOVE '&"S        EU         (  N#00007080' TO DFHEIV0
  7637     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7638     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7639     MOVE X'204E233030303037303830' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 134
* EL6318.cbl
  7640     CALL 'kxdfhei1' USING DFHEIV0,
  7641           WS-ELCNTL-FILE-ID,
  7642           DFHEIV20,
  7643           DFHEIV99,
  7644           W-CNTL-KEY,
  7645           DFHEIV99,
  7646           DFHEIV99,
  7647           DFHEIV99
  7648     SET ADDRESS OF CONTROL-FILE TO
  7649         DFHEIV20
  7650     MOVE EIBRESP  TO WS-RESPONSE
  7651     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7652     IF RESP-NORMAL
  7653        display ' good read elcntl '
  7654        IF CF-CREDIT-LAST-ARCH-NUM NOT NUMERIC
  7655           MOVE ZEROS            TO CF-CREDIT-LAST-ARCH-NUM
  7656        END-IF
  7657        ADD 1                    TO CF-CREDIT-LAST-ARCH-NUM
  7658        MOVE CF-CREDIT-LAST-ARCH-NUM
  7659                                 TO W-ARCH-NUMBER
  7660
  7661* EXEC CICS REWRITE
  7662*          FROM      (CONTROL-FILE)
  7663*          DATASET   (WS-ELCNTL-FILE-ID)
  7664*       END-EXEC
  7665     MOVE LENGTH OF
  7666      CONTROL-FILE
  7667       TO DFHEIV11
  7668*    MOVE '&& L                  %   #00007095' TO DFHEIV0
  7669     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7670     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7671     MOVE X'2020233030303037303935' TO DFHEIV0(25:11)
  7672     CALL 'kxdfhei1' USING DFHEIV0,
  7673           WS-ELCNTL-FILE-ID,
  7674           CONTROL-FILE,
  7675           DFHEIV11,
  7676           DFHEIV99
  7677     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7678     END-IF
  7679
  7680* EXEC CICS GETMAIN
  7681*       SET      (ADDRESS OF LETTER-ARCHIVE)
  7682*       LENGTH   (W-ARCH-LENGTH)
  7683*    END-EXEC
  7684*    MOVE '," L                  $   #00007100' TO DFHEIV0
  7685     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
  7686     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7687     MOVE X'2020233030303037313030' TO DFHEIV0(25:11)
  7688     CALL 'kxdfhei1' USING DFHEIV0,
  7689           DFHEIV20,
  7690           W-ARCH-LENGTH,
  7691           DFHEIV99
  7692     SET ADDRESS OF LETTER-ARCHIVE TO
  7693         DFHEIV20
  7694     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7695     MOVE 'LA'                   TO LETTER-ARCHIVE
  7696     MOVE W-ARCH-NUMBER          TO LA-ARCHIVE-NO
  7697                                    LA-ARCHIVE-NO-A2
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 135
* EL6318.cbl
  7698                                    LA-ARCHIVE-NO-A3
  7699                                    LA-ARCHIVE-NO-A4
  7700                                    LA-ARCHIVE-NO-A5
  7701                                    LA-ARCHIVE-NO-A6
  7702     MOVE PI-COMPANY-CD          TO LA-COMPANY-CD
  7703                                    LA-COMPANY-CD-A2
  7704                                    LA-COMPANY-CD-A3
  7705                                    LA-COMPANY-CD-A4
  7706                                    LA-COMPANY-CD-A5
  7707                                    LA-COMPANY-CD-A6
  7708     MOVE PB-CARRIER             TO LA-CARRIER-A2
  7709                                    LA-CARRIER-A3
  7710                                    LA-CARRIER-A4
  7711                                    LA-CARRIER-A5
  7712     MOVE Pb-cert-eff-dt         TO LA-EFFECT-DATE-A2
  7713     MOVE PB-GROUPING            TO LA-GROUPING-A2
  7714                                    LA-GROUPING-A3
  7715                                    LA-GROUPING-A4
  7716                                    LA-GROUPING-A5
  7717     MOVE PB-ACCOUNT             TO LA-ACCOUNT-A2
  7718                                    LA-ACCOUNT-A3
  7719                                    LA-ACCOUNT-A4
  7720                                    LA-ACCOUNT-A5
  7721     MOVE PB-STATE               TO LA-STATE-A2
  7722                                    LA-STATE-A3
  7723                                    LA-STATE-A4
  7724                                    LA-STATE-A5
  7725     MOVE PB-CERT-PRIME          TO LA-CERT-PRIME-A2
  7726     MOVE PB-CERT-SFX            TO LA-CERT-SUFFIX-A2
  7727     MOVE PB-ENTRY-BATCH         TO LA-ENTRY-A6
  7728     MOVE PI-PROCESSOR-ID        TO LA-PROCESSOR-CD
  7729     MOVE LOW-VALUES             TO LA-LAST-RESENT-PRINT-DATE
  7730                                    LA-INITIAL-PRINT-DATE
  7731                                    LA-SENT-DATE
  7732                                    LA-REPLY-DATE
  7733                                    LA-RESEND-DATE
  7734                                    LA-FOLLOW-UP-DATE
  7735     MOVE 'A'                    TO LA-STATUS
  7736     MOVE W-NUMBER-OF-COPIES     TO LA-NO-OF-COPIES
  7737     MOVE W-AUTO-CLOSE-IND       TO LA-FINAL-ACT-IND
  7738     MOVE LTRIDI                 TO LA-FORM-A3
  7739     MOVE '4'                    TO LA-DATA-SOURCE
  7740     MOVE WS-CURRENT-BIN-DT      TO LA-CREATION-DATE
  7741     MOVE ZEROS                  TO LA-NUMBER-LABEL-LINES
  7742                                    LA-NO-OF-TEXT-RECORDS
  7743
  7744* EXEC CICS WRITE
  7745*         DATASET   ('ERARCH')
  7746*         FROM      (LETTER-ARCHIVE)
  7747*         RIDFLD    (LA-CONTROL-PRIMARY)
  7748*         RESP      (WS-RESPONSE)
  7749*    END-EXEC
  7750     MOVE LENGTH OF
  7751      LETTER-ARCHIVE
  7752       TO DFHEIV11
  7753     MOVE 'ERARCH' TO DFHEIV1
  7754*    MOVE '&$ L                  ''  N#00007152' TO DFHEIV0
  7755     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 136
* EL6318.cbl
  7756     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7757     MOVE X'204E233030303037313532' TO DFHEIV0(25:11)
  7758     CALL 'kxdfhei1' USING DFHEIV0,
  7759           DFHEIV1,
  7760           LETTER-ARCHIVE,
  7761           DFHEIV11,
  7762           LA-CONTROL-PRIMARY,
  7763           DFHEIV99,
  7764           DFHEIV99
  7765     MOVE EIBRESP  TO WS-RESPONSE
  7766     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7767     IF RESP-NORMAL
  7768        display ' good write erarch '
  7769        MOVE ER-0280             TO EMI-ERROR
  7770        MOVE -1                  TO SIGREQL
  7771        PERFORM 9900-ERROR-FORMAT
  7772                                 THRU 9900-EXIT
  7773        MOVE W-ARCH-NUMBER       TO W-ARCH-SUPPRESS
  7774        MOVE W-ARCH-EDIT         TO EMI-TEXT-VARIABLE (1)
  7775     ELSE
  7776        MOVE ER-7345             TO EMI-ERROR
  7777        MOVE -1                  TO SIGREQL
  7778        PERFORM 9900-ERROR-FORMAT
  7779                                 THRU 9900-EXIT
  7780     END-IF
  7781     .
  7782 1000-EXIT.
  7783     EXIT.
  7784 1100-CALL-NS-BUS-LOGIC.
  7785     DISPLAY ' MADE IT TO 1100 '
  7786     MOVE SPACES                 TO BL-INPUT
  7787     MOVE W-ARCH-NUMBER          TO BL-ARCHIVE-NO
  7788     MOVE '4'                    TO BL-DATA-SRCE
  7789     MOVE PB-CARRIER             TO BL-CARRIER
  7790     MOVE PB-GROUPING            TO BL-GROUP
  7791     MOVE PB-STATE               TO BL-STATE
  7792     MOVE PB-ACCOUNT             TO BL-ACCOUNT
  7793     IF PB-CERT-EFF-DT NOT = LOW-VALUES
  7794        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
  7795        MOVE ' '                 TO DC-OPTION-CODE
  7796        PERFORM 9700-date-link
  7797        IF NO-CONVERSION-ERROR
  7798           MOVE DC-GREG-DATE-B-EDIT
  7799                                 TO BL-EFF-DT
  7800        END-IF
  7801     END-IF
  7802     MOVE PB-CERT-NO             TO BL-CERT-NO
  7803     MOVE PB-ENTRY-BATCH         TO BL-BATCH-NO
  7804     MOVE PB-BATCH-SEQ-NO        TO BL-BATCH-SEQ
  7805     MOVE SPACES                 TO BL-RESP-NO
  7806     MOVE LTRIDI                 TO BL-LETTER-ID
  7807     MOVE W-NUMBER-OF-COPIES     TO BL-NO-OF-COPIES
  7808     MOVE PI-PROCESSOR-ID        TO BL-PROC-ID
  7809*    MOVE 'ALWA'                 TO BL-PROC-ID
  7810     MOVE PI-COMPANY-ID          TO BL-COMP-ID
  7811*    MOVE IFF-PRINT-NOW-SW       TO BL-PRINT-NOW-SW
  7812*    MOVE IFF-ENC-CD             TO BL-ENC-CD
  7813     IF EIBAID = DFHPF4
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 137
* EL6318.cbl
  7814        MOVE 'B'                 TO BL-WRITE-ERARCH
  7815     ELSE
  7816        MOVE 'T'                 TO BL-WRITE-ERARCH
  7817     END-IF
  7818     MOVE CERTIDI                TO BL-CERT-FORM-ID
  7819     MOVE W-ARCH-NUMBER          TO BL-ENDT-ARCH-NO
  7820     MOVE 'ISS ENDT'             TO BL-SOURCE-SCREEN
  7821     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  7822        IF REACD-IN (S1) NOT = LOW-VALUES
  7823           MOVE REACD-IN (S1)    TO BL-REASON-CODE (S1)
  7824        END-IF
  7825     END-PERFORM
  7826    DISPLAY ' ABOUT TO LINK TO NSRASBL '
  7827*****************************************
  7828* Invoke the LETTER business logic
  7829*****************************************
  7830
  7831* exec cics link
  7832*       program('NSRASBL')
  7833*       commarea(srch-commarea)
  7834*    end-exec.
  7835     MOVE LENGTH OF
  7836      srch-commarea
  7837       TO DFHEIV11
  7838     MOVE 'NSRASBL' TO DFHEIV1
  7839*    MOVE '."C                   (   #00007221' TO DFHEIV0
  7840     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  7841     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7842     MOVE X'2020233030303037323231' TO DFHEIV0(25:11)
  7843     CALL 'kxdfhei1' USING DFHEIV0,
  7844           DFHEIV1,
  7845           srch-commarea,
  7846           DFHEIV11,
  7847           DFHEIV99,
  7848           DFHEIV99,
  7849           DFHEIV99,
  7850           DFHEIV99
  7851     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7852
  7853     DISPLAY ' MADE IT BACK FROM NSRASBL ' BL-STATUS ' '
  7854        BL-MESSAGE
  7855     .
  7856 1100-EXIT.
  7857     EXIT.
  7858 1500-GET-ARCH-NO.
  7859     display ' made it to 1500 '
  7860     MOVE SPACES                 TO ELCNTL-KEY
  7861     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID
  7862     MOVE '1'                    TO CNTL-REC-TYPE
  7863     MOVE ZEROS                  TO CNTL-SEQ
  7864
  7865* EXEC CICS READ
  7866*         DATASET    (WS-ELCNTL-FILE-ID)
  7867*         SET        (ADDRESS OF CONTROL-FILE)
  7868*         RIDFLD     (ELCNTL-KEY)
  7869*         UPDATE
  7870*         RESP       (WS-RESPONSE)
  7871*    END-EXEC
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 138
* EL6318.cbl
  7872*    MOVE '&"S        EU         (  N#00007236' TO DFHEIV0
  7873     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7874     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7875     MOVE X'204E233030303037323336' TO DFHEIV0(25:11)
  7876     CALL 'kxdfhei1' USING DFHEIV0,
  7877           WS-ELCNTL-FILE-ID,
  7878           DFHEIV20,
  7879           DFHEIV99,
  7880           ELCNTL-KEY,
  7881           DFHEIV99,
  7882           DFHEIV99,
  7883           DFHEIV99
  7884     SET ADDRESS OF CONTROL-FILE TO
  7885         DFHEIV20
  7886     MOVE EIBRESP  TO WS-RESPONSE
  7887     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7888     IF RESP-NORMAL
  7889        display ' good read elcntl '
  7890        IF CF-CREDIT-LAST-ARCH-NUM NOT NUMERIC
  7891           MOVE ZEROS            TO CF-CREDIT-LAST-ARCH-NUM
  7892        END-IF
  7893        ADD 1                    TO CF-CREDIT-LAST-ARCH-NUM
  7894        MOVE CF-CREDIT-LAST-ARCH-NUM
  7895                                 TO W-ARCH-NUMBER
  7896        display ' new arch number ' w-arch-number
  7897
  7898* EXEC CICS REWRITE
  7899*          FROM      (CONTROL-FILE)
  7900*          DATASET   (WS-ELCNTL-FILE-ID)
  7901*       END-EXEC
  7902     MOVE LENGTH OF
  7903      CONTROL-FILE
  7904       TO DFHEIV11
  7905*    MOVE '&& L                  %   #00007252' TO DFHEIV0
  7906     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7907     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7908     MOVE X'2020233030303037323532' TO DFHEIV0(25:11)
  7909     CALL 'kxdfhei1' USING DFHEIV0,
  7910           WS-ELCNTL-FILE-ID,
  7911           CONTROL-FILE,
  7912           DFHEIV11,
  7913           DFHEIV99
  7914     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7915     END-IF
  7916     .
  7917 1500-EXIT.
  7918     EXIT.
  7919
  7920
  7921 1700-WRITE-CERT-NOTE      SECTION.
  7922
  7923     MOVE SV-PARTIAL-KEY TO ERCNOT-PARTIAL-KEY.
  7924     MOVE ZERO           TO ERCNOT-SEQ.
  7925     SET TB-INDX         DOWN BY 1.
  7926     SET TB-INDX1        TO TB-INDX.
  7927
  7928****DELETE CURRENT CERT NOTES
  7929 1700-LOOP.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 139
* EL6318.cbl
  7930
  7931* EXEC CICS READ
  7932*        DATASET (WS-ERCNOT-FILE-ID)
  7933*        RIDFLD  (ERCNOT-KEY)
  7934*        SET     (ADDRESS OF CERT-NOTE-FILE)
  7935*        RESP    (WS-RESPONSE)
  7936*        GTEQ
  7937*    END-EXEC.
  7938*    MOVE '&"S        G          (  N#00007271' TO DFHEIV0
  7939     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  7940     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7941     MOVE X'204E233030303037323731' TO DFHEIV0(25:11)
  7942     CALL 'kxdfhei1' USING DFHEIV0,
  7943           WS-ERCNOT-FILE-ID,
  7944           DFHEIV20,
  7945           DFHEIV99,
  7946           ERCNOT-KEY,
  7947           DFHEIV99,
  7948           DFHEIV99,
  7949           DFHEIV99
  7950     SET ADDRESS OF CERT-NOTE-FILE TO
  7951         DFHEIV20
  7952     MOVE EIBRESP  TO WS-RESPONSE
  7953     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7954
  7955
  7956     IF NOT RESP-NORMAL
  7957        GO TO 1700-ENDDEL
  7958     END-IF
  7959
  7960     MOVE CZ-CONTROL-PRIMARY     TO ERCNOT-KEY.
  7961
  7962     IF ERCNOT-PARTIAL-KEY NOT = SV-PARTIAL-KEY
  7963         GO TO 1700-ENDDEL
  7964     END-IF.
  7965
  7966
  7967* EXEC CICS DELETE
  7968*        DATASET (WS-ERCNOT-FILE-ID)
  7969*        RIDFLD  (ERCNOT-KEY)
  7970*    END-EXEC.
  7971*    MOVE '&(  R                 &   #00007289' TO DFHEIV0
  7972     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
  7973     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7974     MOVE X'2020233030303037323839' TO DFHEIV0(25:11)
  7975     CALL 'kxdfhei1' USING DFHEIV0,
  7976           WS-ERCNOT-FILE-ID,
  7977           ERCNOT-KEY,
  7978           DFHEIV99,
  7979           DFHEIV99,
  7980           DFHEIV99
  7981     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7982
  7983
  7984     GO TO 1700-LOOP.
  7985
  7986 1700-ENDDEL.
  7987
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 140
* EL6318.cbl
  7988
  7989* EXEC CICS GETMAIN
  7990*         LENGTH(ERCNOT-LENGTH)
  7991*         SET(ADDRESS OF CERT-NOTE-FILE)
  7992*         INITIMG(GETMAIN-SPACE)
  7993*    END-EXEC.
  7994*    MOVE ',"IL                  $   #00007298' TO DFHEIV0
  7995     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7996     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7997     MOVE X'2020233030303037323938' TO DFHEIV0(25:11)
  7998     CALL 'kxdfhei1' USING DFHEIV0,
  7999           DFHEIV20,
  8000           ERCNOT-LENGTH,
  8001           GETMAIN-SPACE
  8002     SET ADDRESS OF CERT-NOTE-FILE TO
  8003         DFHEIV20
  8004     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8005
  8006
  8007     SET TB-INDX TO 1.
  8008     MOVE SV-PARTIAL-KEY TO ERCNOT-PARTIAL-KEY
  8009     MOVE +0             TO ERCNOT-SEQ
  8010
  8011     PERFORM VARYING TB-INDX FROM 1 BY 1
  8012             UNTIL TB-INDX > TB-INDX1
  8013        MOVE SPACES                 TO  CERT-NOTE-FILE
  8014        ADD 1                       TO  ERCNOT-SEQ
  8015        MOVE ERCNOT-KEY             TO  CZ-CONTROL-PRIMARY
  8016        MOVE  'CZ'                  TO  CZ-RECORD-ID
  8017        MOVE CERT-NT-TEXT (TB-INDX) TO  CZ-NOTE
  8018        MOVE CERT-NT-LAST-MAINT-BY (TB-INDX)
  8019                                    TO  CZ-LAST-MAINT-USER
  8020        MOVE CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  8021                                    TO  CZ-LAST-MAINT-HHMMSS
  8022        MOVE CERT-NT-LAST-MAINT-DT (TB-INDX)
  8023                                    TO  CZ-LAST-MAINT-DT
  8024
  8025
  8026* EXEC CICS WRITE
  8027*            DATASET(WS-ERCNOT-FILE-ID)
  8028*            FROM(CERT-NOTE-FILE)
  8029*            RIDFLD(ERCNOT-KEY)
  8030*       END-EXEC
  8031     MOVE LENGTH OF
  8032      CERT-NOTE-FILE
  8033       TO DFHEIV11
  8034*    MOVE '&$ L                  ''   #00007322' TO DFHEIV0
  8035     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  8036     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8037     MOVE X'2020233030303037333232' TO DFHEIV0(25:11)
  8038     CALL 'kxdfhei1' USING DFHEIV0,
  8039           WS-ERCNOT-FILE-ID,
  8040           CERT-NOTE-FILE,
  8041           DFHEIV11,
  8042           ERCNOT-KEY,
  8043           DFHEIV99,
  8044           DFHEIV99
  8045     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 141
* EL6318.cbl
  8046     END-PERFORM
  8047
  8048     PERFORM 1800-READ-ELCERT-UPDATE THRU 1800-EXIT
  8049     IF RESP-NORMAL
  8050        EVALUATE CM-NOTE-SW
  8051           WHEN '1'
  8052           WHEN '3'
  8053           WHEN '5'
  8054           WHEN '7'
  8055              SET NO-CERT-RW     TO TRUE
  8056           WHEN ' '
  8057              MOVE '1'           TO CM-NOTE-SW
  8058           WHEN '2'
  8059              MOVE '3'           TO CM-NOTE-SW
  8060           WHEN '4'
  8061              MOVE '5'           TO CM-NOTE-SW
  8062           WHEN '6'
  8063              MOVE '7'           TO CM-NOTE-SW
  8064        END-EVALUATE
  8065     END-IF
  8066     IF NOT NO-CERT-RW
  8067        PERFORM 1810-REWRITE-ELCERT
  8068                                 THRU 1810-EXIT
  8069     ELSE
  8070
  8071* EXEC CICS UNLOCK
  8072*          DATASET    (WS-ELCERT-FILE-ID)
  8073*       END-EXEC
  8074*    MOVE '&*                    #   #00007351' TO DFHEIV0
  8075     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  8076     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8077     MOVE X'2020233030303037333531' TO DFHEIV0(25:11)
  8078     CALL 'kxdfhei1' USING DFHEIV0,
  8079           WS-ELCERT-FILE-ID,
  8080           DFHEIV99
  8081     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8082     END-IF
  8083
  8084     .
  8085 1799-EXIT.
  8086     EXIT.
  8087
  8088 1800-READ-ELCERT-UPDATE.
  8089
  8090     MOVE PI-COMPANY-CD          TO  W-CERT-COMPANY-CD.
  8091     MOVE PI-CRTO-CARRIER        TO  W-CERT-CARRIER.
  8092     MOVE PI-CRTO-GROUPING       TO  W-CERT-GROUPING.
  8093     MOVE PI-CRTO-STATE          TO  W-CERT-STATE.
  8094     MOVE PI-CRTO-ACCOUNT        TO  W-CERT-ACCOUNT.
  8095     MOVE PI-CRTO-CERT-EFF-DT    TO  W-CERT-CERT-EFF-DT.
  8096     MOVE PI-CRTO-CERT-PRIME     TO  W-CERT-CERT-PRIME.
  8097     MOVE PI-CRTO-CERT-SFX       TO  W-CERT-CERT-SFX.
  8098
  8099
  8100* EXEC CICS READ
  8101*        UPDATE
  8102*        DATASET  (WS-ELCERT-FILE-ID)
  8103*        RIDFLD   (WS-ELCERT-KEY)
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 142
* EL6318.cbl
  8104*        SET      (ADDRESS OF CERTIFICATE-MASTER)
  8105*        RESP     (WS-RESPONSE)
  8106*    END-EXEC
  8107*    MOVE '&"S        EU         (  N#00007371' TO DFHEIV0
  8108     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8109     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8110     MOVE X'204E233030303037333731' TO DFHEIV0(25:11)
  8111     CALL 'kxdfhei1' USING DFHEIV0,
  8112           WS-ELCERT-FILE-ID,
  8113           DFHEIV20,
  8114           DFHEIV99,
  8115           WS-ELCERT-KEY,
  8116           DFHEIV99,
  8117           DFHEIV99,
  8118           DFHEIV99
  8119     SET ADDRESS OF CERTIFICATE-MASTER TO
  8120         DFHEIV20
  8121     MOVE EIBRESP  TO WS-RESPONSE
  8122     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8123
  8124     .
  8125 1800-EXIT.
  8126     EXIT.
  8127
  8128 1810-REWRITE-ELCERT.
  8129
  8130
  8131* EXEC CICS REWRITE
  8132*        FROM     (CERTIFICATE-MASTER)
  8133*        DATASET  (WS-ELCERT-FILE-ID)
  8134*        RESP     (WS-RESPONSE)
  8135*    END-EXEC.
  8136     MOVE LENGTH OF
  8137      CERTIFICATE-MASTER
  8138       TO DFHEIV11
  8139*    MOVE '&& L                  %  N#00007385' TO DFHEIV0
  8140     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8141     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8142     MOVE X'204E233030303037333835' TO DFHEIV0(25:11)
  8143     CALL 'kxdfhei1' USING DFHEIV0,
  8144           WS-ELCERT-FILE-ID,
  8145           CERTIFICATE-MASTER,
  8146           DFHEIV11,
  8147           DFHEIV99
  8148     MOVE EIBRESP  TO WS-RESPONSE
  8149     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8150
  8151
  8152     .
  8153 1810-EXIT.
  8154     EXIT.
  8155
  8156 8100-SEND-INITIAL-MAP.
  8157     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  8158     MOVE '5'                    TO DC-OPTION-CODE.
  8159     PERFORM 9700-DATE-LINK.
  8160     MOVE DC-GREG-DATE-1-EDIT    TO DATEO.
  8161     MOVE EIBTIME                TO TIME-IN.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 143
* EL6318.cbl
  8162     MOVE TIME-OUT               TO TIMEO.
  8163     MOVE -1                     TO SIGREQL
  8164     IF PI-PROCESSOR-IS-CSR-SUPER
  8165        perform varying s1 from +1 by +1 until
  8166           s1 > +12
  8167           MOVE AL-UANON            TO reacda (s1)
  8168        end-perform
  8169     END-IF
  8170     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O.
  8171     MOVE EMI-MESSAGE-AREA (2)   TO ERRMSG2O.
  8172
  8173* EXEC CICS SEND
  8174*        MAP      (MAP-NAME)
  8175*        MAPSET   (MAPSET-NAME)
  8176*        FROM     (EL631KO)
  8177*        ERASE
  8178*        CURSOR
  8179*    END-EXEC.
  8180     MOVE LENGTH OF
  8181      EL631KO
  8182       TO DFHEIV12
  8183     MOVE -1
  8184       TO DFHEIV11
  8185*    MOVE '8$     CT  E    H L F ,   #00007411' TO DFHEIV0
  8186     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  8187     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  8188     MOVE X'2020233030303037343131' TO DFHEIV0(25:11)
  8189     CALL 'kxdfhei1' USING DFHEIV0,
  8190           MAP-NAME,
  8191           EL631KO,
  8192           DFHEIV12,
  8193           MAPSET-NAME,
  8194           DFHEIV99,
  8195           DFHEIV99,
  8196           DFHEIV99,
  8197           DFHEIV11,
  8198           DFHEIV99,
  8199           DFHEIV99,
  8200           DFHEIV99
  8201     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8202
  8203     GO TO 9100-RETURN-TRAN.
  8204 8200-SEND-DATAONLY.
  8205     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  8206     MOVE '5'                    TO DC-OPTION-CODE.
  8207     PERFORM 9700-DATE-LINK.
  8208     MOVE DC-GREG-DATE-1-EDIT    TO DATEO.
  8209     MOVE EIBTIME                TO TIME-IN.
  8210     MOVE TIME-OUT               TO TIMEO.
  8211     MOVE -1                     TO PFENTRL
  8212     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O
  8213     MOVE EMI-MESSAGE-AREA (2)   TO ERRMSG2O
  8214
  8215* EXEC CICS SEND
  8216*        MAP      (MAP-NAME)
  8217*        MAPSET   (MAPSET-NAME)
  8218*        FROM     (EL631KO)
  8219*        DATAONLY
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 144
* EL6318.cbl
  8220*        ERASEAUP
  8221*        CURSOR
  8222*    END-EXEC.
  8223     MOVE LENGTH OF
  8224      EL631KO
  8225       TO DFHEIV12
  8226     MOVE -1
  8227       TO DFHEIV11
  8228*    MOVE '8$D    CT  A    H L F ,   #00007429' TO DFHEIV0
  8229     MOVE X'382444202020204354202041' TO DFHEIV0(1:12)
  8230     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  8231     MOVE X'2020233030303037343239' TO DFHEIV0(25:11)
  8232     CALL 'kxdfhei1' USING DFHEIV0,
  8233           MAP-NAME,
  8234           EL631KO,
  8235           DFHEIV12,
  8236           MAPSET-NAME,
  8237           DFHEIV99,
  8238           DFHEIV99,
  8239           DFHEIV99,
  8240           DFHEIV11,
  8241           DFHEIV99,
  8242           DFHEIV99,
  8243           DFHEIV99
  8244     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8245
  8246     GO TO 9100-RETURN-TRAN.
  8247 8300-SEND-TEXT.
  8248
  8249* EXEC CICS SEND TEXT
  8250*        FROM     (LOGOFF-TEXT)
  8251*        LENGTH   (LOGOFF-LENGTH)
  8252*        ERASE
  8253*        FREEKB
  8254*    END-EXEC.
  8255*    MOVE '8&      T  E F  H   F -   #00007439' TO DFHEIV0
  8256     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  8257     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  8258     MOVE X'2020233030303037343339' TO DFHEIV0(25:11)
  8259     CALL 'kxdfhei1' USING DFHEIV0,
  8260           LOGOFF-TEXT,
  8261           LOGOFF-LENGTH,
  8262           DFHEIV99,
  8263           DFHEIV99,
  8264           DFHEIV99,
  8265           DFHEIV99,
  8266           DFHEIV99,
  8267           DFHEIV99,
  8268           DFHEIV99,
  8269           DFHEIV99,
  8270           DFHEIV99,
  8271           DFHEIV99
  8272     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8273
  8274
  8275* EXEC CICS RETURN
  8276*    END-EXEC.
  8277*    MOVE '.(                    ''   #00007445' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 145
* EL6318.cbl
  8278     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  8279     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8280     MOVE X'2020233030303037343435' TO DFHEIV0(25:11)
  8281     CALL 'kxdfhei1' USING DFHEIV0,
  8282           DFHEIV99,
  8283           DFHEIV99,
  8284           DFHEIV99,
  8285           DFHEIV99,
  8286           DFHEIV99,
  8287           DFHEIV99
  8288     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8289
  8290 8800-UNAUTHORIZED-ACCESS.
  8291     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
  8292     GO TO 8300-SEND-TEXT.
  8293 8810-PF23.
  8294     MOVE EIBAID                 TO PI-ENTRY-CD-1.
  8295     MOVE XCTL-005               TO PGM-NAME.
  8296     GO TO 9300-XCTL.
  8297 9000-RETURN-CICS.
  8298
  8299* EXEC CICS RETURN
  8300*    END-EXEC.
  8301*    MOVE '.(                    ''   #00007455' TO DFHEIV0
  8302     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  8303     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8304     MOVE X'2020233030303037343535' TO DFHEIV0(25:11)
  8305     CALL 'kxdfhei1' USING DFHEIV0,
  8306           DFHEIV99,
  8307           DFHEIV99,
  8308           DFHEIV99,
  8309           DFHEIV99,
  8310           DFHEIV99,
  8311           DFHEIV99
  8312     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8313
  8314 9100-RETURN-TRAN.
  8315     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
  8316     MOVE SCREEN-NUMBER          TO PI-CURRENT-SCREEN-NO.
  8317
  8318* EXEC CICS RETURN
  8319*        TRANSID    (TRANS-ID)
  8320*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  8321*        LENGTH     (PI-COMM-LENGTH)
  8322*    END-EXEC.
  8323*    MOVE '.(CT                  ''   #00007460' TO DFHEIV0
  8324     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  8325     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8326     MOVE X'2020233030303037343630' TO DFHEIV0(25:11)
  8327     CALL 'kxdfhei1' USING DFHEIV0,
  8328           TRANS-ID,
  8329           PROGRAM-INTERFACE-BLOCK,
  8330           PI-COMM-LENGTH,
  8331           DFHEIV99,
  8332           DFHEIV99,
  8333           DFHEIV99
  8334     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8335
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 146
* EL6318.cbl
  8336 9200-RETURN-MAIN-MENU.
  8337     MOVE XCTL-626               TO PGM-NAME.
  8338     GO TO 9300-XCTL.
  8339 9300-XCTL.
  8340
  8341* EXEC CICS XCTL
  8342*        PROGRAM    (PGM-NAME)
  8343*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  8344*        LENGTH     (PI-COMM-LENGTH)
  8345*    END-EXEC.
  8346*    MOVE '.$C                   %   #00007469' TO DFHEIV0
  8347     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  8348     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8349     MOVE X'2020233030303037343639' TO DFHEIV0(25:11)
  8350     CALL 'kxdfhei1' USING DFHEIV0,
  8351           PGM-NAME,
  8352           PROGRAM-INTERFACE-BLOCK,
  8353           PI-COMM-LENGTH,
  8354           DFHEIV99
  8355     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8356
  8357 9400-CLEAR.
  8358     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
  8359
  8360* EXEC CICS XCTL
  8361*        PROGRAM    (PGM-NAME)
  8362*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  8363*        LENGTH     (PI-COMM-LENGTH)
  8364*    END-EXEC.
  8365*    MOVE '.$C                   %   #00007476' TO DFHEIV0
  8366     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  8367     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8368     MOVE X'2020233030303037343736' TO DFHEIV0(25:11)
  8369     CALL 'kxdfhei1' USING DFHEIV0,
  8370           PGM-NAME,
  8371           PROGRAM-INTERFACE-BLOCK,
  8372           PI-COMM-LENGTH,
  8373           DFHEIV99
  8374     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8375
  8376 9500-PF12.
  8377     MOVE XCTL-010               TO PGM-NAME.
  8378     GO TO 9300-XCTL.
  8379 9600-PGMID-ERROR.
  8380
  8381* EXEC CICS HANDLE CONDITION
  8382*        PGMIDERR    (8300-SEND-TEXT)
  8383*    END-EXEC.
  8384*    MOVE '"$L                   ! " #00007485' TO DFHEIV0
  8385     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  8386     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8387     MOVE X'2220233030303037343835' TO DFHEIV0(25:11)
  8388     CALL 'kxdfhei1' USING DFHEIV0
  8389     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8390
  8391     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
  8392     MOVE ' '                    TO PI-ENTRY-CD-1.
  8393     MOVE XCTL-005               TO PGM-NAME.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 147
* EL6318.cbl
  8394     MOVE PGM-NAME               TO LOGOFF-PGM.
  8395     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
  8396     GO TO 9300-XCTL.
  8397 9700-DATE-LINK.
  8398     MOVE LINK-ELDATCV           TO PGM-NAME.
  8399
  8400* EXEC CICS LINK
  8401*        PROGRAM    (PGM-NAME)
  8402*        COMMAREA   (DATE-CONVERSION-DATA)
  8403*        LENGTH     (DC-COMM-LENGTH)
  8404*    END-EXEC.
  8405*    MOVE '."C                   (   #00007496' TO DFHEIV0
  8406     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8407     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8408     MOVE X'2020233030303037343936' TO DFHEIV0(25:11)
  8409     CALL 'kxdfhei1' USING DFHEIV0,
  8410           PGM-NAME,
  8411           DATE-CONVERSION-DATA,
  8412           DC-COMM-LENGTH,
  8413           DFHEIV99,
  8414           DFHEIV99,
  8415           DFHEIV99,
  8416           DFHEIV99
  8417     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8418
  8419 9900-ERROR-FORMAT.
  8420     IF NOT EMI-ERRORS-COMPLETE
  8421        MOVE LINK-001            TO PGM-NAME
  8422
  8423* EXEC CICS LINK
  8424*           PROGRAM    (PGM-NAME)
  8425*           COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
  8426*           LENGTH     (EMI-COMM-LENGTH)
  8427*       END-EXEC
  8428*    MOVE '."C                   (   #00007504' TO DFHEIV0
  8429     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8430     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8431     MOVE X'2020233030303037353034' TO DFHEIV0(25:11)
  8432     CALL 'kxdfhei1' USING DFHEIV0,
  8433           PGM-NAME,
  8434           ERROR-MESSAGE-INTERFACE-BLOCK,
  8435           EMI-COMM-LENGTH,
  8436           DFHEIV99,
  8437           DFHEIV99,
  8438           DFHEIV99,
  8439           DFHEIV99
  8440     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8441     END-IF
  8442     .
  8443 9900-EXIT.
  8444     EXIT.
  8445 9990-ABEND.
  8446     MOVE LINK-004               TO PGM-NAME.
  8447     MOVE DFHEIBLK               TO EMI-LINE1.
  8448
  8449* EXEC CICS LINK
  8450*        PROGRAM   (PGM-NAME)
  8451*        COMMAREA  (EMI-LINE1)
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 148
* EL6318.cbl
  8452*        LENGTH    (72)
  8453*    END-EXEC.
  8454     MOVE 72
  8455       TO DFHEIV11
  8456*    MOVE '."C                   (   #00007516' TO DFHEIV0
  8457     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8458     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8459     MOVE X'2020233030303037353136' TO DFHEIV0(25:11)
  8460     CALL 'kxdfhei1' USING DFHEIV0,
  8461           PGM-NAME,
  8462           EMI-LINE1,
  8463           DFHEIV11,
  8464           DFHEIV99,
  8465           DFHEIV99,
  8466           DFHEIV99,
  8467           DFHEIV99
  8468     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8469
  8470     GO TO 8200-SEND-DATAONLY.
  8471
  8472* GOBACK.
  8473     MOVE '9%                    "   ' TO DFHEIV0
  8474     MOVE 'EL6318' TO DFHEIV1
  8475     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  8476     GOBACK.
  8477 9995-SECURITY-VIOLATION.
  8478*                            COPY ELCSCTP.
  8479******************************************************************
  8480*                                                                *
  8481*                            ELCSCTP                             *
  8482*                            VMOD=2.001                          *
  8483*                                                                *
  8484*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  8485******************************************************************
  8486
  8487
  8488     MOVE EIBDATE          TO SM-JUL-DATE.
  8489     MOVE EIBTRMID         TO SM-TERMID.
  8490     MOVE THIS-PGM         TO SM-PGM.
  8491     MOVE EIBTIME          TO TIME-IN.
  8492     MOVE TIME-OUT         TO SM-TIME.
  8493     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  8494
  8495
  8496* EXEC CICS LINK
  8497*         PROGRAM  ('EL003')
  8498*         COMMAREA (SECURITY-MESSAGE)
  8499*         LENGTH   (80)
  8500*    END-EXEC.
  8501     MOVE 'EL003' TO DFHEIV1
  8502     MOVE 80
  8503       TO DFHEIV11
  8504*    MOVE '."C                   (   #00007541' TO DFHEIV0
  8505     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8506     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8507     MOVE X'2020233030303037353431' TO DFHEIV0(25:11)
  8508     CALL 'kxdfhei1' USING DFHEIV0,
  8509           DFHEIV1,
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 149
* EL6318.cbl
  8510           SECURITY-MESSAGE,
  8511           DFHEIV11,
  8512           DFHEIV99,
  8513           DFHEIV99,
  8514           DFHEIV99,
  8515           DFHEIV99
  8516     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8517
  8518
  8519******************************************************************
  8520
  8521 9995-EXIT.
  8522     EXIT.
  8523
  8524 9999-DFHBACK SECTION.
  8525     MOVE '9%                    "   ' TO DFHEIV0
  8526     MOVE 'EL6318' TO DFHEIV1
  8527     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  8528     GOBACK.
  8529 9999-DFHEXIT.
  8530     IF DFHEIGDJ EQUAL 0001
  8531         NEXT SENTENCE
  8532     ELSE IF DFHEIGDJ EQUAL 2
  8533         GO TO 8300-SEND-TEXT
  8534         DEPENDING ON DFHEIGDI.
  8535     MOVE '9%                    "   ' TO DFHEIV0
  8536     MOVE 'EL6318' TO DFHEIV1
  8537     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  8538     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       34808     Code:       19490
