* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page   1
* EL6311.cbl
* Options: int("EL6311.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL6311.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL6311.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL6311.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 ID DIVISION.
     2
     3 PROGRAM-ID.                 EL6311.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/20/94 16:50:32.
     7*                            VMOD=2.089.
     8*
     9*AUTHOR.     LOGIC,INC.
    10*            DALLAS, TEXAS.
    11
    12*DATE-COMPILED.
    13
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page   2
* EL6311.cbl
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    20*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    21*            *                                                   *
    22*            *****************************************************
    23
    24*REMARKS.
    25*        TRANSACTION - EXB1 - NEW BUSINESS, REVIEW AND CORRECTION
    26*                             ISSUES, CANCELS, AND BATCH HEADERS
    27******************************************************************
    28*                   C H A N G E   L O G
    29*
    30* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    31*-----------------------------------------------------------------
    32*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    33* EFFECTIVE    NUMBER
    34*-----------------------------------------------------------------
    35* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
    36* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    37* 011904                   PEMA  ADD TOTAL FEE PROCESSING
    38* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
    39* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
    40* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
    41* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
    42* 090607  CR2007010300001  PEMA  ADD CO TYPE TO OVERCHARGE
    43* 030708  CR2007092500001  PEMA  ADD VA DISCLOSURE PROCESSING
    44* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
    45* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
    46* 102408  CR2008080500002  PEMA  ADD BILLING NOTE FOR EC OF P
    47* 072009  IR2009062300002  AJRA  RESET CALC FLAG ON CHANGE
    48* 072209  CR2008101500003  AJRA  PRINT BORROWER FIRST NAME
    49* 111109  CR2008100900003  AJRA  CHANGE PF8 TO NEW CERT NOTE SCRN
    50* 032210  IR2010022400001  PEMA  CORRECT PF5 LOGIC, ADD APR PROC
    51* 101110  CR2010091000002  PEMA  ENHANCE PREMIUM EDIT
    52* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
    53* 100111  CR2011022800001  AJRA  NAPERSOFT VA DISC
    54* 010412  CR2011022800001  AJRA  NAPERSOFT
    55* 032612  CR2011110200001  PEMA  AHL CHANGES
    56* 062712  CR2011022800001  AJRA  REDEFINE ORIG DATA
    57* 072312  CR2011022800001  AJRA  NAPERSOFT MISC
    58* 091112  IR2012091100002  AJRA  FIX AKA
    59* 091312  IR2012091100004  AJRA  FIX ADDRESS CHECK
    60* 091712  IR2012091400003  AJRA  CHANGE PF6 TO GO TO CANCEL TRANS
    61* 100412  IR2012100300002  AJRA  FIX VA DISC FOR DISAB ONLY CERT
    62* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
    63* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    64* 080713  CR2012032000002  AJRA  HIGHLIGHT AGE ERRORS
    65* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR
    66* 102813  IR2013102100001  PEMA  CORRECT CANCEL VOID STATUS
    67* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
    68* 100213  CR2013090300001  AJRA  NAPERSOFT PHASE 2
    69* 111513  CR2013053000001  PEMA  DAILY CHECK REQUEST CHANGES
    70* 120513  CR2013090300001  AJRA  CHG ALL NINES IN PREM PROCESS
    71* 030314  IR2014030300003  PEMA  ADD CHK FOR STARTBR
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page   3
* EL6311.cbl
    72* 031114  IR2014031100001  PEMA  CHECK FOR 0 CHECK AMOUNT
    73* 041514  CR2014032600001  PEMA  ALLOW DEL CNC IF VOID CHKS
    74* 051914  IR2014050500003  PEMA  ALLOW DEL CNC IF NO CHK ATTACHED
    75* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
    76* 091615  CR2015082000001  PEMA  add endorsement check processing
    77* 101615  CR2015080300002  PEMA  ALLOW VIN FOR CID
    78* 010517  CR2016021600005  PEMA  ADD NEW FORCE CD FOR AGG
    79* 022017  IR2017022000002  PEMA  PREVENT DEL OF ISS W/CHECK
    80* 101016  CR2015082500001  PEMA  ADD COMPANY VPP
    81* 062017  CR2015091000001  PEMA  ADD PROCESSING FOR TN REF INTERES
    82* 020218  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
    83* 052918  CR2018040600002  PEMA  ADD REFUND DIRECT INDICATOR
    84* 021519  CR2019021100001  PEMA  non-monthly al calcs
    85* 012220  CR2018092700002  TANA  Add letter reqd field
    86* 012820  CR2020012800001  PEMA  Addd minimum term edit for extd t
    87* 031620  CR2019092700001  PEMA  Remove post card indicator
    88* 041320  CR2020040200001  PEMA  PENDING BUSINESS JOURNALING
    89* 041320  CR2020030500002  PEMA  Issue, cancel billing notes
    90* 052020  CR2019111300001  PEMA  Include all files in "K" trans
    91* 072120  CR2020072100002  PEMA  Allow deletion of dup pend iss re
    92* 102020 IR2020101300001   PEMA  Correct billing notes
    93******************************************************************
    94
    95 ENVIRONMENT DIVISION.
    96
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page   4
* EL6311.cbl
    98 DATA DIVISION.
    99 WORKING-STORAGE SECTION.
   100 01  DFH-START PIC X(04).
   101 77  LCP-ONCTR-01                  PIC S9(8) COMP-3 VALUE ZERO.
   102 77  LCP-ONCTR-02                  PIC S9(8) COMP-3 VALUE ZERO.
   103 77  FILLER  PIC X(32)  VALUE '********************************'.
   104 77  FILLER  PIC X(32)  VALUE '*    EL6311 WORKING STORAGE    *'.
   105 77  FILLER  PIC X(32)  VALUE '************VMOD=2.089**********'.
   106 77  A1                          PIC S999 COMP-3 VALUE +0.
   107 77  N1                          PIC S999 COMP-3 VALUE +0.
   108 77  N2                          PIC S999 COMP-3 VALUE +0.
   109 77  N3                          PIC S999 COMP-3 VALUE +0.
   110 77  WS-OC-AMT                   PIC S9(9)V99 COMP-3 VALUE +0.
   111 77  WS-SAVE-ERPYAJ-KEY          PIC X(33) VALUE SPACES.
   112 77  WS-REVERSE-SW               PIC X VALUE 'N'.
   113     88  REVERSAL                    VALUE 'Y'.
   114 77  WS-NOTE-SW                  PIC X  VALUE ' '.
   115 77  WS-BEG                      PIC S999 COMP-3 VALUE +0.
   116 77  WS-END                      PIC S999 COMP-3 VALUE +0.
   117 77  WS-TALLY                    PIC 99  VALUE ZEROS.
   118 77  WS-ERMAIL-SW                PIC X  VALUE ' '.
   119     88  ERMAIL-FOUND                 VALUE 'Y'.
   120 77  A2                          PIC S9(5) COMP-3 VALUE +0.
   121 77  M1                          PIC S9(5) COMP-3 VALUE +0.
   122 77  WS-WORK-FIELD               PIC X(80)    VALUE SPACES.
   123 77  WS-CERT-TRL-REC-NOT-FOUND   PIC S9       VALUE +0.
   124     88  CERT-TRL-REC-NOT-FOUND     VALUE +1.
   125 77  ws-stop-sw                  pic x value ' '.
   126     88  i-say-stop                 value 'Y'.
   127 77  ws-check-sw                 pic x value ' '.
   128     88  i-have-checks              value 'Y'.
   129 77  ws-proc-check-sw            pic x value ' '.
   130     88  i-have-processed-checks    value 'Y'.
   131 77  ws-any-check-sw             pic x value ' '.
   132     88  i-have-a-check-period      value 'Y'.
   133 77  ws-chek-browse-sw           pic x value ' '.
   134 77  ws-lf-diff                  pic s9(7)v99 comp-3 value +0.
   135 77  ws-ah-diff                  pic s9(7)v99 comp-3 value +0.
   136 77  ws-new-ref-total            pic s9(7)v99 comp-3 value +0.
   137 77  ws-new-iss-total            pic s9(7)v99 comp-3 value +0.
   138 77  ws-check-amts               pic s9(7)v99 comp-3 value +0.
   139 77  ws-tot-orig-prem            pic s9(7)v99 comp-3 value +0.
   140 77  ws-elcrtt-update-sw         pic x value ' '.
   141     88  update-elcrtt              value 'Y'.
   142 01  P pointer.
   143 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
   144 01  var-ptr pointer.
   145 01  env-var-len                 pic 9(4)  binary.
   146 01  rc                          pic 9(9)  binary.
   147 01  WS-KIXSYS.
   148     05  WS-KIX-FIL1             PIC X(10).
   149     05  WS-KIX-APPS             PIC X(10).
   150     05  WS-KIX-ENV              PIC X(10).
   151     05  WS-KIX-MYENV            PIC X(10).
   152     05  WS-KIX-SYS              PIC X(10).
   153*    COPY ELCSCTM.
   154******************************************************************
   155*                                                                *
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page   5
* EL6311.cbl
   156*                                                                *
   157*                            ELCSCTM                             *
   158*                            VMOD=2.001                          *
   159*                                                                *
   160*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   161*                                                                *
   162******************************************************************
   163 01  SECURITY-MESSAGE.
   164     12  FILLER                          PIC X(30)
   165            VALUE '** LOGIC SECURITY VIOLATION -'.
   166     12  SM-READ                         PIC X(6).
   167     12  FILLER                          PIC X(5)
   168            VALUE ' PGM='.
   169     12  SM-PGM                          PIC X(6).
   170     12  FILLER                          PIC X(5)
   171            VALUE ' OPR='.
   172     12  SM-PROCESSOR-ID                 PIC X(4).
   173     12  FILLER                          PIC X(6)
   174            VALUE ' TERM='.
   175     12  SM-TERMID                       PIC X(4).
   176     12  FILLER                          PIC XX   VALUE SPACE.
   177     12  SM-JUL-DATE                     PIC 9(5).
   178     12  FILLER                          PIC X    VALUE SPACE.
   179     12  SM-TIME                         PIC 99.99.
   180
   181
   182*    COPY ELCSCRTY.
   183******************************************************************
   184*                                                                *
   185*                                                                *
   186*                            ELCSCRTY                            *
   187*                            VMOD=2.001                          *
   188*                                                                *
   189*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   190*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   191*        SAVED IN PI-SECURITY-ADDRESS.                           *
   192*                                                                *
   193******************************************************************
   194 01  SECURITY-CONTROL.
   195     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   196     12  FILLER                       PIC XX    VALUE 'SC'.
   197     12  SC-CREDIT-CODES.
   198         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   199             20  SC-CREDIT-DISPLAY    PIC X.
   200             20  SC-CREDIT-UPDATE     PIC X.
   201     12  SC-CLAIMS-CODES.
   202         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   203             20  SC-CLAIMS-DISPLAY    PIC X.
   204             20  SC-CLAIMS-UPDATE     PIC X.
   205
   206 01  WS-VA-NO-COMM-MESS.
   207     12  FILLER                  PIC X(41) VALUE
   208        'MAXIMUM AGE EXCEEDED - NO COMMISSION PAID'.
   209 01  WS-OC-MESSAGE.
   210     12  FILLER                  PIC X(43) VALUE
   211        'OVERCHARGE AUTO CORRECTED IN THE AMOUNT OF '.
   212     12  WS-OC-DIS-AMT           PIC -----9.99.
   213     12  FILLER                  PIC X(4) VALUE ' ON '.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page   6
* EL6311.cbl
   214     12  WS-OC-DATE              PIC X(10).
   215 01  WS-DATE-AREA.
   216     12  WS-TEMP-EFF-DT          PIC XX     VALUE LOW-VALUES.
   217     12  WS-CURRENT-DT.
   218         16  FILLER              PIC X(6)    VALUE SPACES.
   219         16  WS-CURRENT-YR       PIC XX      VALUE SPACES.
   220     12  WS-CURRENT-BIN-DT       PIC XX      VALUE SPACES.
   221     12  WS-CREDIT-SELECT-DT     PIC XX      VALUE SPACES.
   222     12  WS-MONTH-END-DT         PIC X(8)    VALUE SPACES.
   223
   224 01  STANDARD-AREAS.
   225     12  GETMAIN-SPACE           PIC X       VALUE SPACE.
   226     12  EL631B                  PIC X(8)    VALUE 'EL631B'.
   227     12  EL631C                  PIC X(8)    VALUE 'EL631C'.
   228     12  EL631D                  PIC X(8)    VALUE 'EL631D'.
   229     12  MAPSET-EL6311S          PIC X(8)    VALUE 'EL6311S'.
   230     12  SCREEN-NUMBER           PIC X(6)    VALUE 'EL631B'.
   231     12  TRANS-EXB1              PIC X(4)    VALUE 'EXB1'.
   232     12  THIS-PGM                PIC X(8)    VALUE 'EL6311'.
   233     12  PGM-NAME                PIC X(8).
   234     12  TIME-IN                 PIC S9(7).
   235     12  TIME-OUT-R  REDEFINES TIME-IN.
   236         16  FILLER              PIC X.
   237         16  TIME-OUT            PIC 99V99.
   238         16  FILLER              PIC XX.
   239     12  XCTL-EL001              PIC X(8)    VALUE 'EL001'.
   240     12  XCTL-EL005              PIC X(8)    VALUE 'EL005'.
   241     12  XCTL-EL010              PIC X(8)    VALUE 'EL010'.
   242     12  XCTL-EL127              PIC X(8)    VALUE 'EL127'.
   243     12  XCTL-EL1272             PIC X(8)    VALUE 'EL1272'.
   244     12  XCTL-EL1273             PIC X(8)    VALUE 'EL1273'.
   245     12  XCTL-EL1276             PIC X(8)    VALUE 'EL1276'.
   246     12  XCTL-EL1279             PIC X(8)    VALUE 'EL1279'.
   247     12  XCTL-EL401DMD           PIC X(8)    VALUE 'EL401DMD'.
   248     12  XCTL-EL626              PIC X(8)    VALUE 'EL626'.
   249     12  XCTL-EL631              PIC X(8)    VALUE 'EL631'.
   250     12  XCTL-EL6312             PIC X(8)    VALUE 'EL6312'.
   251     12  XCTL-EL6313             PIC X(8)    VALUE 'EL6313'.
   252     12  XCTL-EL6314             PIC X(8)    VALUE 'EL6314'.
   253     12  XCTL-EL6315             PIC X(8)    VALUE 'EL6315'.
   254     12  XCTL-EL6316             PIC X(8)    VALUE 'EL6316'.
   255     12  XCTL-EL640              PIC X(8)    VALUE 'EL640'.
   256     12  XCTL-EL650              PIC X(8)    VALUE 'EL650'.
   257     12  XCTL-EL677              PIC X(8)    VALUE 'EL677'.
   258     12  XCTL-EL680              PIC X(8)    VALUE 'EL680'.
   259     12  XCTL-EL689              PIC X(8)    VALUE 'EL689'.
   260     12  XCTL-EL690              PIC X(8)    VALUE 'EL690'.
   261     12  LINK-EL001              PIC X(8)    VALUE 'EL001'.
   262     12  LINK-EL004              PIC X(8)    VALUE 'EL004'.
   263     12  LINK-EL050              PIC X(8)    VALUE 'EL050'.
   264     12  LINK-ELDATCV            PIC X(8)    VALUE 'ELDATCV'.
   265     12  LINK-ELVADS             PIC X(8)    VALUE 'ELVADS'.
   266     12  FILE-ID                 PIC X(8).
   267     12  FILE-ID-ELCERT          PIC X(8)    VALUE 'ELCERT'.
   268     12  FILE-ID-ERPNDB          PIC X(8)    VALUE 'ERPNDB'.
   269     12  FILE-ID-ERPNDB2         PIC X(8)    VALUE 'ERPNDB2'.
   270     12  FILE-ID-ERPNDB3         PIC X(8)    VALUE 'ERPNDB3'.
   271     12  FILE-ID-ERPNDB4         PIC X(8)    VALUE 'ERPNDB4'.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page   7
* EL6311.cbl
   272     12  FILE-ID-ERPNDM          PIC X(8)    VALUE 'ERPNDM'.
   273     12  FILE-ID-ERNOTE          PIC X(8)    VALUE 'ERNOTE'.
   274     12  FILE-ID-ERCNOT          PIC X(8)    VALUE 'ERCNOT'.
   275     12  FILE-ID-ERPYAJ          PIC X(8)    VALUE 'ERPYAJ'.
   276     12  FILE-ID-ERMAIL          PIC X(8)    VALUE 'ERMAIL'.
   277     12  FILE-ID-ERRQST          PIC X(8)    VALUE 'ERRQST'.
   278     12  FILE-ID-ERLOFC          PIC X(8)    VALUE 'ERLOFC'.
   279     12  CLMS-ID                 PIC X(8)    VALUE 'ELMSTR5'.
   280     12  FILE-ID-ERENDT          PIC X(8)    VALUE 'ERENDT'.
   281     12  CRTT-ID                 PIC X(8)    VALUE 'ELCRTT'.
   282
   283 01  WS-PASS-AREA.
   284     05  WS-PASS-AREA-LENGTH PIC S9(4) COMP VALUE +352.
   285     05  WS-PASS-VADS-REC    PIC X(350).
   286*** Z CONTROL LAYOUT MOVED TO COPYBOOK ELCZREC
   287*                                COPY ELCZREC.
   288******************************************************************
   289*                                                                *
   290*                                                                *
   291*                            ELCZREC.                            *
   292*                                                                *
   293*   FILE DESCRIPTION = Z CONTROL RECORD LAYOUT                   *
   294*                                                                *
   295******************************************************************
   296*-----------------------------------------------------------------
   297*                   C H A N G E   L O G
   298*
   299* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   300*-----------------------------------------------------------------
   301*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   302* EFFECTIVE    NUMBER
   303*-----------------------------------------------------------------
   304* 122011    2011022800001  AJRA  NEW FILE
   305* 073112    2011022800001  AJRA  ADD ACCT SUMM, CSO SUMM
   306* 122712    2012101700002  AJRA  ADD REASON CODE REQUIRED FLAG
   307* 072313    2013062000003  AJRA  ADD IND FOR INSERTION BAR CODE
   308* 091913    2013090300001  AJRA  ADD SIGNATURE FLAG DEFAULT
   309*-----------------------------------------------------------------
   310 01  W-Z-CONTROL-DATA.
   311     05  W-NUMBER-OF-COPIES      PIC  9.
   312     05  FILLER                  PIC  X.
   313     05  W-DAYS-TO-FOLLOW-UP     PIC  999.
   314     05  FILLER                  PIC  X.
   315     05  W-DAYS-TO-RESEND        PIC  999.
   316     05  FILLER                  PIC  X.
   317     05  W-FORM-TO-RESEND        PIC  X(4).
   318     05  W-ADD-BAR-CODE          PIC  X.
   319     05  W-PROMPT-LETTER         PIC  X.
   320     05  W-HAS-RETURN-ENV        PIC  X.
   321     05  W-ENCLOSURE-CD          PIC  XXX.
   322     05  W-SIG-FLAG-DEFAULT      PIC  X.
   323     05  W-AUTO-CLOSE-IND        PIC  X.
   324     05  FILLER                  PIC  X.
   325     05  W-LETTER-TO-BENE        PIC  X.
   326     05  FILLER                  PIC  X.
   327     05  W-LETTER-TO-ACCT        PIC  X.
   328     05  FILLER                  PIC  X.
   329     05  W-LETTER-TYPE           PIC  X.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page   8
* EL6311.cbl
   330     05  FILLER                  PIC  X.
   331     05  W-PRINT-CERTIFICATE     PIC  X.
   332     05  FILLER                  PIC  X.
   333     05  W-REFUND-REQUIRED       PIC  X.
   334     05  FILLER                  PIC  X.
   335     05  W-ONBASE-CODE           PIC  XX.
   336     05  FILLER                  PIC  X.
   337     05  W-ACCT-SUMM             PIC  X.
   338     05  FILLER                  PIC  X.
   339     05  W-CSO-SUMM              PIC  X.
   340     05  FILLER                  PIC  X.
   341     05  W-REASONS-REQUIRED      PIC  X.
   342     05  FILLER                  PIC  X(29).
   343******************************************************************
   344*                                                                *
   345*              A C C E S S   K E Y S                             *
   346*                                                                *
   347******************************************************************
   348
   349 01  ACCESS-KEYS.
   350     12  ERPYAJ-KEY.
   351         16  ERPYAJ-COMPANY-CD       PIC X.
   352         16  ERPYAJ-CARRIER          PIC X.
   353         16  ERPYAJ-GROUPING         PIC X(6).
   354         16  ERPYAJ-FIN-RESP         PIC X(10).
   355         16  ERPYAJ-ACCOUNT          PIC X(10).
   356         16  ERPYAJ-SEQ-NO           PIC S9(8) COMP.
   357         16  ERPYAJ-TYPE             PIC X.
   358     12  ERPYAJ-RECORD-LENGTH        PIC S9(4) COMP VALUE +200.
   359     12  ELCERT-KEY.
   360         16  ELCERT-COMPANY-CD       PIC X.
   361         16  ELCERT-CARRIER          PIC X.
   362         16  ELCERT-GROUPING         PIC X(6).
   363         16  ELCERT-STATE            PIC XX.
   364         16  ELCERT-ACCOUNT          PIC X(10).
   365         16  ELCERT-CERT-EFF-DT      PIC XX.
   366         16  ELCERT-CERT-NO.
   367             20  ELCERT-CERT-PRIME   PIC X(10).
   368             20  ELCERT-CERT-SFX     PIC X.
   369
   370     12  ELCERT-RECORD-LENGTH        PIC S9(4) COMP VALUE +450.
   371     12  ELCERT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +473.
   372     12  ELCRTO-KEY.
   373         16  ELCRTO-COMPANY-CD       PIC X.
   374         16  ELCRTO-CARRIER          PIC X.
   375         16  ELCRTO-GROUPING         PIC X(6).
   376         16  ELCRTO-STATE            PIC XX.
   377         16  ELCRTO-ACCOUNT          PIC X(10).
   378         16  ELCRTO-CERT-EFF-DT      PIC XX.
   379         16  ELCRTO-CERT-NO.
   380             20  ELCRTO-CERT-PRIME   PIC X(10).
   381             20  ELCRTO-CERT-SFX     PIC X.
   382         16  ELCRTO-RECORD-TYPE      PIC X.
   383         16  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
   384
   385     12  ELCRTT-KEY.
   386         16  ELCRTT-PRIMARY          PIC X(33).
   387         16  ELCRTT-REC-TYPE         PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page   9
* EL6311.cbl
   388     12  ELCRTT-RECORD-LENGTH        PIC S9(4) COMP VALUE +552.
   389     12  ELCRTT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +575.
   390
   391     12  ERPNDB-KEY.
   392         16  ERPNDB-COMPANY-CD       PIC X        VALUE SPACE.
   393         16  ERPNDB-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
   394         16  ERPNDB-BATCH-SEQ-NO     PIC S9(4)    VALUE +0 COMP.
   395         16  ERPNDB-BATCH-SEQ-ALPHA  REDEFINES
   396             ERPNDB-BATCH-SEQ-NO     PIC XX.
   397         16  ERPNDB-BATCH-CHG-SEQ-NO PIC S9(4)    VALUE +0 COMP.
   398
   399     12  ERPNDB-RECORD-LENGTH        PIC S9(4) COMP VALUE +585.
   400     12  ERPNDB-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +608.
   401     12  ERCHEK-KEY.
   402         16  CHEK-COMPANY-CD         PIC X       VALUE SPACE.
   403         16  CHEK-CARRIER            PIC X       VALUE SPACE.
   404         16  CHEK-GROUPING           PIC X(6)    VALUE SPACES.
   405         16  CHEK-STATE              PIC XX      VALUE SPACES.
   406         16  CHEK-ACCOUNT            PIC X(10)   VALUE SPACES.
   407         16  CHEK-EFF-DT             PIC XX      VALUE SPACES.
   408         16  CHEK-CERT-NO            PIC X(10)   VALUE SPACES.
   409         16  CHEK-SUF-NO             PIC X       VALUE SPACES.
   410         16  CHEK-RECORD-SEQ         PIC S9(4)   VALUE ZEROS COMP.
   411     12  ELLETR-KEY.
   412         16  LETR-COMPANY-CD     PIC X.
   413         16  LETR-LETTER-ID      PIC X(4).
   414         16  LETR-FILLER         PIC X(8).
   415         16  LETR-SEQ-NO         PIC 9(4) BINARY.
   416     12  ERPNDM-KEY.
   417         16  ERPNDM-COMPANY-CD       PIC X        VALUE SPACE.
   418         16  ERPNDM-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
   419         16  ERPNDM-BATCH-SEQ        PIC S9(4)    VALUE +1 COMP.
   420         16  ERPNDM-BATCH-CHG-SEQ    PIC S9(4)    VALUE +0 COMP.
   421
   422*    12  ERPNDM-RECORD-LENGTH        PIC S9(4) COMP VALUE +250.
   423     12  ERPNDM-RECORD-LENGTH        PIC S9(4) COMP VALUE +374.
   424*    12  ERPNDM-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +273.
   425     12  ERPNDM-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +397.
   426
   427     12  ERPNDB-ALT-KEY.
   428         16  ERPNDB-COMPANY-CD-A1    PIC X        VALUE SPACE.
   429         16  ERPNDB-CARRIER          PIC X        VALUE SPACES.
   430         16  ERPNDB-GROUPING         PIC X(6)     VALUE SPACES.
   431         16  ERPNDB-STATE            PIC XX       VALUE SPACES.
   432         16  ERPNDB-ACCOUNT          PIC X(10)    VALUE SPACES.
   433         16  ERPNDB-CERT-EFF-DT      PIC XX       VALUE SPACES.
   434         16  ERPNDB-CERT-NO.
   435             20  ERPNDB-CERT-PRIME   PIC X(10)    VALUE SPACES.
   436             20  ERPNDB-CERT-SFX     PIC X        VALUE SPACE.
   437         16  ERPNDB-ALT-CHG-SEQ-NO   PIC S9(4)    VALUE +0 COMP.
   438         16  ERPNDB-RECORD-TYPE      PIC X.
   439
   440      12  ERPNDB-CSR-KEY.
   441          20  ERPNDB-CSR-COMPANY-CD-A2     PIC X.
   442          20  ERPNDB-CSR-ID                PIC X(4).
   443          20  ERPNDB-CSR-ENTRY-BATCH       PIC X(6).
   444          20  ERPNDB-CSR-BTCH-SEQ-NO       PIC S9(4)     COMP.
   445          20  ERPNDB-CSR-BTCH-CHG-SEQ      PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  10
* EL6311.cbl
   446
   447     12  ERNOTE-KEY.
   448         16  ERNOTE-COMPANY-CD       PIC X        VALUE SPACE.
   449         16  ERNOTE-CARRIER          PIC X        VALUE SPACES.
   450         16  ERNOTE-GROUPING         PIC X(6)     VALUE SPACES.
   451         16  ERNOTE-STATE            PIC XX       VALUE SPACES.
   452         16  ERNOTE-ACCOUNT          PIC X(10)    VALUE SPACES.
   453         16  ERNOTE-CERT-EFF-DT      PIC XX       VALUE SPACES.
   454         16  ERNOTE-CERT-NO.
   455             20  ERNOTE-CERT-PRIME   PIC X(10)    VALUE SPACES.
   456             20  ERNOTE-CERT-SFX     PIC X        VALUE SPACES.
   457         16  ernote-record-type      pic x        value spaces.
   458
   459     12  ERNOTE-RECORD-LENGTH        PIC S9(4) COMP VALUE +825.
   460     12  ERNOTE-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +848.
   461
   462     12  ERCNOT-KEY.
   463         16  ERCNOT-PART-KEY.
   464             20  ERCNOT-COMPANY-CD   PIC X        VALUE SPACE.
   465             20  ERCNOT-CARRIER      PIC X        VALUE SPACES.
   466             20  ERCNOT-GROUPING     PIC X(6)     VALUE SPACES.
   467             20  ERCNOT-STATE        PIC XX       VALUE SPACES.
   468             20  ERCNOT-ACCOUNT      PIC X(10)    VALUE SPACES.
   469             20  ERCNOT-CERT-EFF-DT  PIC XX       VALUE SPACES.
   470             20  ERCNOT-CERT-NO.
   471                 25  ERCNOT-CERT-PRIME PIC X(10)  VALUE SPACES.
   472                 25  ERCNOT-CERT-SFX PIC X        VALUE SPACES.
   473         16  ERCNOT-REC-TYPE         PIC X        VALUE SPACES.
   474         16  ERCNOT-SEQUENCE         PIC S9(4) COMP VALUE +0.
   475
   476     12  ERCNOT-RECORD-LENGTH        PIC S9(4) COMP VALUE +150.
   477     12  ERCNOT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +173.
   478
   479     12  ERMAIL-KEY.
   480         16  ERMAIL-COMPANY-CD       PIC X        VALUE SPACE.
   481         16  ERMAIL-CARRIER          PIC X        VALUE SPACES.
   482         16  ERMAIL-GROUPING         PIC X(6)     VALUE SPACES.
   483         16  ERMAIL-STATE            PIC XX       VALUE SPACES.
   484         16  ERMAIL-ACCOUNT          PIC X(10)    VALUE SPACES.
   485         16  ERMAIL-CERT-EFF-DT      PIC XX       VALUE SPACES.
   486         16  ERMAIL-CERT-NO.
   487             20  ERMAIL-CERT-PRIME   PIC X(10)    VALUE SPACES.
   488             20  ERMAIL-CERT-SFX     PIC X        VALUE SPACES.
   489
   490     12  ERMAIL-RECORD-LENGTH        PIC S9(4) COMP VALUE +374.
   491     12  ERMAIL-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +393.
   492
   493     12  ERRQST-KEY.
   494         16  ERRQST-COMPANY-CD       PIC X        VALUE SPACE.
   495         16  ERRQST-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
   496
   497     12  ERRQST-RECORD-LENGTH        PIC S9(4) COMP VALUE +200.
   498     12  ERRQST-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +223.
   499
   500     12  WS-JOURNAL-RECORD-LENGTH    PIC S9(4) COMP VALUE +0000.
   501
   502     12  ERLOFC-KEY.
   503         16  ERLOFC-COMPANY-CD          PIC  X.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  11
* EL6311.cbl
   504         16  ERLOFC-CARRIER             PIC  X.
   505         16  ERLOFC-GROUPING            PIC  X(6).
   506         16  ERLOFC-STATE               PIC  XX.
   507         16  ERLOFC-ACCOUNT             PIC  X(10).
   508         16  ERLOFC-OFFICER-CODE        PIC  X(5).
   509*        16  ERLOFC-OFFICER-CODE        PIC  XXX.
   510
   511     12  ERACCT-KEY.
   512         16  ERACCT-COMPANY-CD          PIC  X.
   513         16  ERACCT-CARRIER             PIC  X.
   514         16  ERACCT-GROUPING            PIC  X(6).
   515         16  ERACCT-STATE               PIC  XX.
   516         16  ERACCT-ACCOUNT             PIC  X(10).
   517         16  ERACCT-EXP-DT.
   518             20  ERACCT-DT              PIC  XX.
   519             20  ERACCT-FILL            PIC  X(4).
   520     12  ERACNT-KEY.
   521         16  ERACNT-COMPANY-CD          PIC  X.
   522         16  ERACNT-CARRIER             PIC  X.
   523         16  ERACNT-GROUPING            PIC  X(6).
   524         16  ERACNT-STATE               PIC  XX.
   525         16  ERACNT-ACCOUNT             PIC  X(10).
   526         16  ERACNT-REC-TYPE            PIC  X.
   527         16  ERACNT-SEQ-NO              PIC  S9(4) COMP.
   528     12  ERENDT-KEY.
   529         16  ENDT-COMPANY-CD       PIC X.
   530         16  ENDT-CARRIER          PIC X.
   531         16  ENDT-GROUPING         PIC X(6).
   532         16  ENDT-STATE            PIC XX.
   533         16  ENDT-ACCOUNT          PIC X(10).
   534         16  ENDT-CERT-EFF-DT      PIC XX.
   535         16  ENDT-CERT-PRIME       PIC X(10).
   536         16  ENDT-CERT-SFX         PIC X.
   537         16  ENDT-RECORD-TYPE      PIC X.
   538         16  ENDT-SEQ-NO           PIC 9(4) BINARY.
   539
   540 01  WS-ELMSTR-WORK.
   541     12  ELMSTR-KEY.
   542         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
   543         16  MSTR-CERT-NO.
   544             20  MSTR-CERT-PRIME  PIC X(10)   VALUE SPACES.
   545             20  MSTR-CERT-SFX    PIC X(1)    VALUE SPACES.
   546     12  W-CLAIM-KEY.
   547         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
   548         16  W-CL-CERT-NO.
   549             20  W-CL-CERT-PRIME  PIC X(10)   VALUE SPACES.
   550             20  W-CL-CERT-SFX    PIC X(1)    VALUE SPACES.
   551      12  ELMSTR-LENGTH           PIC S9999 COMP  VALUE +11.
   552 01  EL055-PASS-AREA.
   553     05  PA-CURRENT-KEY          PIC X(11).
   554     05  PA-NEW-ALT-KEY          PIC X(36).
   555     05  PA-RETURN-AREA.
   556         10  ra-status-code      pic 9(4).
   557         10  ra-message          pic x(205).
   558 01  CANCEL-GEN-PASS-AREA.
   559     05  CG-OPTION-CODE          PIC X.
   560         88  CG-VALID-OPTION       VALUE '1' '2' '3' '4'.
   561         88  CG-FLAT-CANCEL        VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  12
* EL6311.cbl
   562         88  CG-CANCEL             VALUE '2'.
   563         88  CG-CANCEL-REISSUE     VALUE '3'.
   564     05  CG-ERROR-CODE           PIC 99.
   565         88  CG-SUCCESS            VALUE 00.
   566         88  CG-DATE-ERROR         VALUE 01.
   567         88  CG-CERT-NOT-FOUND     VALUE 02.
   568         88  CG-AMOUNT-ERROR       VALUE 04.
   569         88  CG-OPTION-ERROR       VALUE 05.
   570         88  CG-PREV-CAN           VALUE 06.
   571         88  CG-INVALID-DATA       VALUE 07.
   572         88  CG-NO-ACCT-MSTR       VALUE 08.
   573         88  CG-SFX-A-EXIST        VALUE 09.
   574         88  CG-MISC-ERROR         VALUE 99.
   575     05  CG-COMPANY-ID           PIC XXX.
   576     05  CG-PROC-ID              PIC XXXX.
   577     05  CG-CURRENT-DT           PIC XX.
   578     05  CG-MONTH-END-DT         PIC XX.
   579     05  CG-CERT-KEY.
   580         10  CG-CERT-COMPANY-CD  PIC X.
   581         10  CG-CERT-CARRIER     PIC X.
   582         10  CG-CERT-GROUP       PIC X(6).
   583         10  CG-CERT-STATE       PIC XX.
   584         10  CG-CERT-ACCOUNT     PIC X(10).
   585         10  CG-CERT-EFF-DT      PIC XX.
   586         10  CG-CERT-CERT-NO     PIC X(11).
   587     05  CG-LF-CAN-DATA.
   588         10  CG-LF-CAN-DT        PIC XX.
   589         10  CG-LF-CAN-AMT       PIC S9(7)V99 COMP-3.
   590     05  CG-AH-CAN-DATA.
   591         10  CG-AH-CAN-DT        PIC XX.
   592         10  CG-AH-CAN-AMT       PIC S9(7)V99 COMP-3.
   593     05  CG-CERT-PROFILE-DATA.
   594         10  CG-INS-LNAME        PIC X(15).
   595         10  CG-INS-FNAME        PIC X(10).
   596         10  CG-INS-MID-INIT     PIC X.
   597         10  CG-INS-AGE          PIC 99.
   598         10  CG-JNT-LNAME        PIC X(15).
   599         10  CG-JNT-FNAME        PIC X(10).
   600         10  CG-JNT-MID-INIT     PIC X.
   601         10  CG-JNT-AGE          PIC 99.
   602     05  CG-LF-ISS-DATA.
   603         10  CG-LF-BENCD         PIC XX.
   604         10  CG-LF-PREM-AMT      PIC S9(7)V99 COMP-3.
   605         10  CG-LF-ALT-PREM-AMT  PIC S9(7)V99 COMP-3.
   606     05  CG-AH-ISS-DATA.
   607         10  CG-AH-BENCD         PIC XX.
   608         10  CG-AH-PREM-AMT      PIC S9(7)V99 COMP-3.
   609     05  CG-BATCH-NO             PIC X(6).
   610     05  CG-BATCH-SEQ-NO         PIC 9(4)  COMP.
   611     05  FILLER                  PIC X(306).
   612******************************************************************
   613*                                                                *
   614*            G E N E R A L   W O R K   A R E A                   *
   615*                                                                *
   616******************************************************************
   617
   618 01  WORK-AREA.
   619     12  WS-RESPONSE             PIC S9(8)   COMP.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  13
* EL6311.cbl
   620         88  RESP-NORMAL           VALUE +0.
   621         88  resp-file-notfnd      value +12.
   622         88  RESP-NOTFND           VALUE +13.
   623         88  resp-duprec           value +14.
   624         88  resp-dupkey           value +15.
   625         88  resp-invreq           value +16.
   626         88  RESP-NOTOPEN          VALUE +19.
   627         88  RESP-ENDFILE          VALUE +20.
   628         88  resp-lengtherr        value +22.
   629     12  DEEDIT-FIELD            PIC X(15).
   630     12  FILLER          REDEFINES DEEDIT-FIELD.
   631         16  FILLER              PIC X(4).
   632         16  DEEDIT-FIELD-X11    PIC X(11).
   633     12  DEEDIT-FIELD-V0 REDEFINES DEEDIT-FIELD
   634                                 PIC S9(15).
   635     12  DEEDIT-FIELD-V2 REDEFINES DEEDIT-FIELD
   636                                 PIC S9(13)V99.
   637     12  DEEDIT-FIELD-V4 REDEFINES DEEDIT-FIELD
   638                                 PIC S9(11)V9999.
   639     12  W-ONE                   PIC S9(4) COMP VALUE +1.
   640     12  WS-CALC-TERM            PIC S999V9(5) VALUE ZEROS.
   641     12  WS-CALC-TERM-R REDEFINES WS-CALC-TERM.
   642         16  WS-CALC-TERM-WHOLE  PIC S999.
   643         16  WS-CALC-TERM-REMAIN PIC SV9(5).
   644
   645     12  WS-TIME                 PIC 9(6)   VALUE ZEROS.
   646     12  WS-HR-MINS-SECS REDEFINES WS-TIME.
   647         16  WS-HR-MINS          PIC 99V99.
   648         16  FILLER              PIC XX.
   649
   650     12  WS-EDIT-PASS-LENGTH     PIC S9(4)  VALUE +1036 COMP.
   651     12  WS-COMM-LENGTH          PIC S9(4)  VALUE +1306 COMP.
   652
   653     12  W-CANCEL-FEE-LONG       PIC S9(3)V9(2)  VALUE +0  COMP-3.
   654     12  W-CANCEL-FEE            PIC S99         VALUE +0  COMP-3.
   655
   656     12  WS-SUB                  PIC S9(4) VALUE +0  COMP-3.
   657     12  WS-SUB1                 PIC S9(4) VALUE +0  COMP.
   658     12  WS-SUB2                 PIC S9(4) VALUE +0  COMP.
   659     12  WS-SUB3                 PIC S9(4) VALUE +0  COMP.
   660     12  WS-SUB4                 PIC S9(4) VALUE +0  COMP.
   661     12  WS-COV-SUB              PIC S9(4) VALUE +0  COMP.
   662     12  WS-CSO-SUB              PIC S9(4) VALUE +0  COMP.
   663
   664     12  QID.
   665         16  QID-TERM            PIC X(4).
   666         16  FILLER              PIC X(4)    VALUE '607B'.
   667
   668     12  WS-DISPLAY-SW           PIC X     VALUE SPACE.
   669         88  WS-DISPLAY-SCREEN       VALUE 'Y'.
   670
   671     12  WS-LOAN-OFFICER         PIC X     VALUE SPACE.
   672         88  LOAN-OFFICER-FOUND      VALUE SPACE.
   673
   674     12  WS-MODE-CODE            PIC X     VALUE SPACE.
   675         88 WS-MODE-CODE-VALID     VALUE ' '
   676                                         'W'     *> Weekly
   677                                         'B'     *> Bi-weekly
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  14
* EL6311.cbl
   678                                         'S'     *> Semi-monthly
   679                                         'M'     *> Monthly (Def)
   680                                         'Q'     *> Quarterly
   681                                         'N'     *> Bi-Monthly??
   682                                         'T'     *> Semi-annual
   683                                         'A'.    *> Annual Pay
   684
   685     12  WS-ALL-NINES            PIC S9(7)V99 VALUE +9999999.99.
   686
   687     12  WS-NUMERIC-SW           PIC X.
   688        88  CSO-NUMERIC-FIELD   VALUE 'Y'.
   689
   690     12  WS-EDIT-CSO-FIELD.
   691         16  WS-EDIT-BYTE  OCCURS 9 TIMES
   692                                 PIC X.
   693     12  WS-SAVE-PEND-ISSUE          PIC X(375).
   694     12  WS-ARCHIVE-LETTER-SW    PIC X    VALUE 'N'.
   695        88  ARCHIVE-LETTER-RELEASED   VALUE 'Y'.
   696        88  CALLED-FROM-6315          VALUE '5'.
   697
   698     12  WS-SAVE-INPUT-FIELDS.
   699         16  WS-BAGE             PIC 99       VALUE ZERO.
   700*        16  WS-BAPR             PIC S99V9(4) VALUE +0 COMP-3.
   701         16  WS-BAPR                 PIC 99V9(4) VALUE ZEROS.
   702         16  FILLER REDEFINES WS-BAPR.
   703             20  WS-APR-WHOLE-NUM    PIC 99.
   704             20  WS-APR-DEC          PIC 9999.
   705         16  WS-BLIVES           PIC S9(7)    VALUE +0 COMP-3.
   706         16  WS-BILLED           PIC S9(7)    VALUE +0 COMP-3.
   707
   708         16  WS-B-COVERAGE OCCURS 2 TIMES.
   709             20  WS-TERM-IN-DAYS-SW  PIC X.
   710                 88  WS-TERM-IN-DAYS-FOUND        VALUE 'Y'.
   711             20  WS-BTERM        PIC 999       COMP-3.
   712             20  WS-BALT-TERM    PIC 999       COMP-3.
   713             20  WS-BCRIT-PERD   PIC 99        COMP-3.
   714             20  WS-BBEN         PIC S9(10)V99 COMP-3.
   715             20  WS-BALT-BEN     PIC S9(10)V99 COMP-3.
   716             20  WS-BPREM        PIC S9(7)V99  COMP-3.
   717             20  WS-BALT-PREM    PIC S9(7)V99  COMP-3.
   718             20  WS-BCPREM       PIC S9(7)V99  COMP-3.
   719
   720         16  WS-C-FIELDS COMP-3.
   721             20  WS-CLIVES       PIC S9(3)     VALUE +0.
   722             20  WS-CREFND1      PIC S9(7)V99  VALUE +0.
   723             20  WS-CREFND2      PIC S9(7)V99  VALUE +0.
   724
   725         16  WS-D-FIELDS COMP-3.
   726             20  WS-DRISS        PIC S9(5)    VALUE +0.
   727             20  WS-DRLFPRM      PIC S9(7)V99 VALUE +0.
   728             20  WS-DRAHPRM      PIC S9(7)V99 VALUE +0.
   729             20  WS-DRCANC       PIC S9(5)    VALUE +0.
   730             20  WS-DRLFRFD      PIC S9(7)V99 VALUE +0.
   731             20  WS-DRAHRFD      PIC S9(7)V99 VALUE +0.
   732
   733     12  WS-SAVE-BIRTH-DATE.
   734         16  FILLER              PIC X(4)   VALUE SPACES.
   735         16  WS-SAVE-BIRTH-YR    PIC X(2)   VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  15
* EL6311.cbl
   736
   737     12  CENTURY-ADJ             PIC S9(08) VALUE +38400 COMP.
   738     12  WS-WORK-BIN-RED         PIC S9(08) VALUE +0 COMP.
   739     12  FILLER REDEFINES WS-WORK-BIN-RED.
   740         16  FILLER              PIC X(02).
   741         16  WS-WORK-BIN-DT      PIC X(02).
   742     12  WS-SW-1                 PIC X     VALUE SPACE.
   743     12  WS-SW-2                 PIC X     VALUE SPACE.
   744     12  WS-REMOVE-AH-SW         PIC X     VALUE SPACE.
   745         88  REMOVE-AH-COVERAGE  VALUE 'Y'.
   746     12  WS-REMOVE-LF-SW         PIC X     VALUE SPACE.
   747         88  REMOVE-LF-COVERAGE  VALUE 'Y'.
   748
   749     12  WS-CONVERTED-BIRTH      PIC XX    VALUE SPACE.
   750     12  WS-CONVERTED-1ST-PMT-DT PIC XX    VALUE SPACE.
   751     12  WS-CONVERTED-EFFDT      PIC XX    VALUE SPACES.
   752     12  WS-CONVERTED-EXPIRDT      OCCURS 2 TIMES PIC XX.
   753     12  WS-CONVERTED-CANCEL-DATES.
   754         16  WS-CONVERTED-CANDT1                  PIC XX.
   755         16  WS-CONVERTED-CANDT2                  PIC XX.
   756
   757     12  WS-EXP-DT-EDIT          PIC 99B99B99.
   758
   759     12  WS-REC-FOUND-SW         PIC X.
   760         88  RECORD-NOT-FOUND    VALUE 'N'.
   761
   762     12  WS-PB-RECORDS-FOUND-SW  PIC X     VALUE 'N'.
   763         88  PENDING-BUS-RECS-NOT-FOUND    VALUE 'N'.
   764         88  PENDING-BUS-RECS-FOUND        VALUE 'Y'.
   765
   766     12  WS-ERRORS-PRESENT-SW    PIC X     VALUE 'N'.
   767         88  WS-ERRORS-PRESENT             VALUE 'Y'.
   768         88  WS-ERRORS-NOT-PRESENT         VALUE 'N'.
   769
   770     12  WS-BROWSE-STARTED-SW    PIC X            VALUE ' '.
   771         88  BROWSE-STARTED      VALUE 'Y'.
   772
   773     12  WS-FIRST-TIME-SW        PIC X            VALUE ' '.
   774         88  FIRST-TIME          VALUE 'Y'.
   775
   776     12  WS-FIRST-ENTRY-SW       PIC X            VALUE ' '.
   777         88  FIRST-ENTRY         VALUE 'Y'.
   778
   779     12  WS-REC-BILLED-SW        PIC X            VALUE ' '.
   780         88  REC-BILLED          VALUE 'Y'.
   781
   782     12  SET-CURSOR-SW           PIC S9  COMP-3   VALUE +0.
   783         88  NO-CURSOR-SET       VALUE +0.
   784         88  CURSOR-SET          VALUE +1.
   785
   786     12  WS-ERR-SW               PIC X.
   787         88  STD-ERRORS          VALUE 'S'.
   788         88  TRN-ERRORS          VALUE 'T'.
   789
   790     12  WS-CERT-NOTE-SW         PIC X            VALUE ' '.
   791         88 CERT-NOTES-ARE-PRESENT   VALUE 'Y'.
   792
   793     12  WS-CERT-ADDRESS-SW      PIC X            VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  16
* EL6311.cbl
   794         88 CERT-ADDRESS-PRESENT VALUE 'Y'.
   795
   796     12  WS-CANCEL-LETTER-SW     PIC X            VALUE ' '.
   797         88 CREATE-CANCEL-LETTER VALUE 'Y'.
   798
   799     12  WS-ERR-CODE.
   800         16  FILLER              PIC 99.
   801         16  WS-ERROR-SUB        PIC 99.
   802
   803     12  WS-DATE-WORK.
   804         16  WS-WORK-MM          PIC XX.
   805         16  WS-WORK-DD          PIC XX.
   806         16  WS-WORK-YY          PIC XX.
   807
   808     12  WS-MM-YY.
   809         16  WS-MM               PIC XX.
   810         16  FILLER              PIC X     VALUE '/'.
   811         16  WS-YY               PIC XX.
   812
   813     12  WS-CERT-EFF-DT          PIC XX.
   814
   815     12  WS-MEMBER-NO            PIC X(12).
   816     12  FILLER  REDEFINES  WS-MEMBER-NO.
   817         16  WS-MEMBER-NO-1-8    PIC 9(8).
   818         16  FILLER              PIC X(4).
   819
   820     12  WS-I-MICRO-NO           PIC S9(9)        COMP-3.
   821
   822     12  WS-ERPNDB-ALT-KEY.
   823         16  WS-PB-COMPANY-CD-A1         PIC X.
   824         16  WS-PB-CARRIER               PIC X.
   825         16  WS-PB-GROUPING              PIC X(6).
   826         16  WS-PB-STATE                 PIC XX.
   827         16  WS-PB-ACCOUNT               PIC X(10).
   828         16  WS-PB-CERT-EFF-DT           PIC XX.
   829         16  WS-PB-CERT-NO.
   830             20  WS-PB-CERT-PRIME        PIC X(10).
   831             20  WS-PB-CERT-SFX          PIC X.
   832         16  WS-PB-ALT-CHG-SEQ-NO        PIC S9(4)     COMP.
   833         16  WS-PB-RECORD-TYPE           PIC X.
   834
   835     12  WS-SHOW-SAVE-AREAS.
   836         16  WS-NEW-CERT-NO.
   837             20  WS-NEW-PRIME    PIC X(10).
   838             20  WS-NEW-SUFFIX   PIC X.
   839         16  WS-NEW-CERT-EFF-DT  PIC XX.
   840         16  WS-NEW-RECORD-TYPE  PIC X.
   841         16  WS-SHOW-SW          PIC X   VALUE 'N'.
   842             88   SHOW-RECORD            VALUE 'Y'.
   843
   844     12  WS-SEQ-SAVE             PIC S9(4) COMP.
   845
   846     12  WS-BATCH-NO.
   847         16  WS-BATCH-PREFIX     PIC XXX  VALUE SPACES.
   848         16  FILLER              PIC X(5) VALUE SPACES.
   849
   850     12  WS-FIRST-NAME.
   851         16  WS-1ST-INIT         PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  17
* EL6311.cbl
   852         16  FILLER              PIC X(9).
   853
   854     12  WS-INITIALS.
   855         16  WS-INITIAL-1        PIC X.
   856         16  WS-INITIAL-2        PIC X.
   857
   858     12  WS-C-HDG.
   859         16  WS-REF-HDG-OVERRIDE PIC XX   VALUE SPACES.
   860         16  FILLER              PIC X(4) VALUE '-REF'.
   861
   862     12  WS-D-PREM-HDG.
   863         16  WS-PREM-HDG-OVERRIDE    PIC XX   VALUE SPACES.
   864         16  FILLER                  PIC X(8) VALUE '-PREMIUM'.
   865
   866     12  WS-D-REFUND-HDG.
   867         16  WS-REFUND-HDG-OVERRIDE  PIC XX   VALUE SPACES.
   868         16  FILLER                  PIC X(7) VALUE '-REFUND'.
   869
   870     12  WS-BATCH-CSR-ID     PIC X(4)    VALUE SPACE.
   871
   872     12  CLIENT-ACE          PIC X(3)    VALUE 'ACE'.
   873     12  CLIENT-CRI          PIC X(3)    VALUE 'CRI'.
   874     12  CLIENT-CSO          PIC X(3)    VALUE 'CSO'.
   875     12  CLIENT-GIC          PIC X(3)    VALUE 'GIC'.
   876     12  CLIENT-LGX          PIC X(3)    VALUE 'LGX'.
   877     12  CLIENT-MIC          PIC X(3)    VALUE 'MIC'.
   878     12  CLIENT-PEM          PIC X(3)    VALUE 'PEM'.
   879
   880     12  WS-01-CANCEL-ERR        PIC X(25)
   881         VALUE 'CANCEL DATE ERROR'.
   882     12  WS-02-CANCEL-ERR        PIC X(25)
   883         VALUE 'CERT NOT FOUND'.
   884     12  WS-04-CANCEL-ERR        PIC X(25)
   885         VALUE 'CANCEL AMOUNT ERROR'.
   886     12  WS-05-CANCEL-ERR        PIC X(25)
   887         VALUE 'CANCEL OPTION ERROR'.
   888     12  WS-06-CANCEL-ERR        PIC X(25)
   889         VALUE 'PREVIOUSLY CANCELLED'.
   890     12  WS-07-CANCEL-ERR        PIC X(25)
   891         VALUE 'INVALID DATA'.
   892     12  WS-08-CANCEL-ERR        PIC X(25)
   893         VALUE 'NO ACCOUNT MASTER'.
   894     12  WS-09-CANCEL-ERR        PIC X(25)
   895         VALUE 'SUFFIX ALREADY EXISTS'.
   896     12  WS-99-CANCEL-ERR        PIC X(25)
   897         VALUE 'MISC CANCEL ERROR'.
   898
   899     12  ARCH-SUPPRESS           PIC ZZZZZZZZ99.
   900     12  ARCH-EDIT REDEFINES ARCH-SUPPRESS    PIC X(10).
   901
   902     12  WS-AGE-FIELDS.
   903         16  WS-INS-AGE-SET             PIC X VALUE 'N'.
   904         16  WS-JNT-AGE-SET             PIC X VALUE 'N'.
   905         16  WS-INS-AGE-DEFAULTED       PIC X VALUE 'N'.
   906         16  WS-JNT-AGE-DEFAULTED       PIC X VALUE 'N'.
   907
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  18
* EL6311.cbl
   909
   910******************************************************************
   911*                                                                *
   912*                 B A T C H   T O T A L S                        *
   913*                                                                *
   914******************************************************************
   915
   916     12  WS-BATCH-RECORD.
   917         16  FILLER                       PIC X(10).
   918         16  WS-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   919         16  WS-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   920         16  WS-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   921         16  WS-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   922         16  WS-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   923         16  WS-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   924         16  WS-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   925         16  WS-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   926         16  WS-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   927         16  WS-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   928         16  WS-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   929         16  WS-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   930         16  WS-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
   931         16  WS-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
   932         16  WS-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
   933         16  WS-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
   934         16  WS-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
   935         16  WS-ACCOUNT-NAME              PIC X(30).
   936         16  FILLER                       PIC X.
   937         16  WS-REFERENCE                 PIC X(12).
   938         16  FILLER                       PIC X(197).
   939
   940     12  WS-BATCH-TOTALS.
   941         16  WS-ISS-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   942         16  WS-ISS-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   943         16  WS-ISS-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   944         16  WS-ISS-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   945         16  WS-ISS-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   946         16  WS-ISS-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   947         16  WS-CAN-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   948         16  WS-CAN-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   949         16  WS-CAN-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   950         16  WS-CAN-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   951         16  WS-CAN-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   952         16  WS-CAN-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   953         16  WS-NET-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   954         16  WS-NET-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   955         16  WS-NET-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   956         16  WS-NET-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   957         16  WS-NET-AVAIL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   958         16  WS-NET-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   959         16  WS-NET-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   960
   961     12  WS-SEQ-NO-COUNTER       PIC S9(3)     COMP-3 VALUE ZEROS.
   962
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  19
* EL6311.cbl
   964
   965******************************************************************
   966*                                                                *
   967*                E R R O R   M E S S A G E S                     *
   968*                                                                *
   969******************************************************************
   970
   971 01  ERROR-MESSAGES.
   972     12  ER-0004                 PIC  9(4) VALUE 0004.
   973     12  ER-0008                 PIC  9(4) VALUE 0008.
   974     12  ER-0023                 PIC  9(4) VALUE 0023.
   975     12  ER-0029                 PIC  9(4) VALUE 0029.
   976     12  ER-0033                 PIC  9(4) VALUE 0033.
   977     12  ER-0070                 PIC  9(4) VALUE 0070.
   978     12  ER-0220                 PIC  9(4) VALUE 0220.
   979     12  er-0229                 pic  9(4) value 0229.
   980     12  ER-0248                 PIC  9(4) VALUE 0248.
   981     12  ER-0280                 PIC  9(4) VALUE 0280.
   982     12  ER-0348                 PIC  9(4) VALUE 0348.
   983     12  ER-0582                 PIC  9(4) VALUE 0582.
   984     12  ER-0877                 PIC  9(4) VALUE 0877.
   985     12  ER-1236                 PIC  9(4) VALUE 1236.
   986     12  ER-1570                 PIC  9(4) VALUE 1570.
   987     12  ER-1575                 PIC  9(4) VALUE 1575.
   988     12  ER-1577                 PIC  9(4) VALUE 1577.
   989     12  ER-1584                 PIC  9(4) VALUE 1584.
   990     12  ER-1585                 PIC  9(4) VALUE 1585.
   991     12  ER-1609                 PIC  9(4) VALUE 1609.
   992     12  er-1762                 pic  9(4) value 1762.
   993     12  ER-1819                 PIC  9(4) VALUE 1819.
   994     12  ER-2077                 PIC  9(4) VALUE 2077.
   995     12  ER-2129                 PIC  9(4) VALUE 2129.
   996     12  ER-2188                 PIC  9(4) VALUE 2188.
   997     12  ER-2192                 PIC  9(4) VALUE 2192.
   998     12  ER-2196                 PIC  9(4) VALUE 2196.
   999     12  ER-2197                 PIC  9(4) VALUE 2197.
  1000     12  ER-2198                 PIC  9(4) VALUE 2198.
  1001     12  ER-2200                 PIC  9(4) VALUE 2200.
  1002     12  ER-2212                 PIC  9(4) VALUE 2212.
  1003     12  ER-2218                 PIC  9(4) VALUE 2218.
  1004     12  ER-2220                 PIC  9(4) VALUE 2220.
  1005     12  ER-2222                 PIC  9(4) VALUE 2222.
  1006     12  ER-2223                 PIC  9(4) VALUE 2223.
  1007     12  ER-2224                 PIC  9(4) VALUE 2224.
  1008     12  ER-2225                 PIC  9(4) VALUE 2225.
  1009     12  ER-2226                 PIC  9(4) VALUE 2226.
  1010     12  ER-2227                 PIC  9(4) VALUE 2227.
  1011     12  ER-2228                 PIC  9(4) VALUE 2228.
  1012     12  ER-2240                 PIC  9(4) VALUE 2240.
  1013     12  ER-2241                 PIC  9(4) VALUE 2241.
  1014     12  ER-2242                 PIC  9(4) VALUE 2242.
  1015     12  ER-2243                 PIC  9(4) VALUE 2243.
  1016     12  ER-2244                 PIC  9(4) VALUE 2244.
  1017     12  ER-2245                 PIC  9(4) VALUE 2245.
  1018     12  ER-2246                 PIC  9(4) VALUE 2246.
  1019     12  ER-2247                 PIC  9(4) VALUE 2247.
  1020     12  ER-2251                 PIC  9(4) VALUE 2251.
  1021     12  ER-2252                 PIC  9(4) VALUE 2252.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  20
* EL6311.cbl
  1022     12  ER-2253                 PIC  9(4) VALUE 2253.
  1023     12  ER-2254                 PIC  9(4) VALUE 2254.
  1024     12  ER-2255                 PIC  9(4) VALUE 2255.
  1025     12  ER-2256                 PIC  9(4) VALUE 2256.
  1026     12  ER-2257                 PIC  9(4) VALUE 2257.
  1027     12  ER-2258                 PIC  9(4) VALUE 2258.
  1028     12  ER-2259                 PIC  9(4) VALUE 2259.
  1029     12  ER-2260                 PIC  9(4) VALUE 2260.
  1030     12  ER-2261                 PIC  9(4) VALUE 2261.
  1031     12  ER-2287                 PIC  9(4) VALUE 2287.
  1032     12  ER-2336                 PIC  9(4) VALUE 2336.
  1033     12  ER-2337                 PIC  9(4) VALUE 2337.
  1034     12  ER-2437                 PIC  9(4) VALUE 2437.
  1035     12  ER-2471                 PIC  9(4) VALUE 2471.
  1036     12  ER-2530                 PIC  9(4) VALUE 2530.
  1037     12  ER-2531                 PIC  9(4) VALUE 2531.
  1038     12  ER-2532                 PIC  9(4) VALUE 2532.
  1039     12  ER-2533                 PIC  9(4) VALUE 2533.
  1040     12  ER-2547                 PIC  9(4) VALUE 2547.
  1041     12  ER-2591                 PIC  9(4) VALUE 2591.
  1042     12  ER-2592                 PIC  9(4) VALUE 2592.
  1043     12  ER-2593                 PIC  9(4) VALUE 2593.
  1044     12  ER-2600                 PIC  9(4) VALUE 2600.
  1045     12  ER-2601                 PIC  9(4) VALUE 2601.
  1046     12  ER-2604                 PIC  9(4) VALUE 2604.
  1047     12  ER-2605                 PIC  9(4) VALUE 2605.
  1048     12  ER-2606                 PIC  9(4) VALUE 2606.
  1049     12  ER-2607                 PIC  9(4) VALUE 2607.
  1050     12  ER-2622                 PIC  9(4) VALUE 2622.
  1051     12  ER-2625                 PIC  9(4) VALUE 2625.
  1052     12  ER-2626                 PIC  9(4) VALUE 2626.
  1053     12  ER-2627                 PIC  9(4) VALUE 2627.
  1054     12  ER-2628                 PIC  9(4) VALUE 2628.
  1055     12  ER-2629                 PIC  9(4) VALUE 2629.
  1056     12  ER-2630                 PIC  9(4) VALUE 2630.
  1057     12  ER-2631                 PIC  9(4) VALUE 2631.
  1058     12  ER-2632                 PIC  9(4) VALUE 2632.
  1059     12  ER-2633                 PIC  9(4) VALUE 2633.
  1060     12  ER-2634                 PIC  9(4) VALUE 2634.
  1061     12  ER-2635                 PIC  9(4) VALUE 2635.
  1062     12  ER-2636                 PIC  9(4) VALUE 2636.
  1063     12  ER-2639                 PIC  9(4) VALUE 2639.
  1064     12  ER-2640                 PIC  9(4) VALUE 2640.
  1065     12  ER-2647                 PIC  9(4) VALUE 2647.
  1066     12  ER-2648                 PIC  9(4) VALUE 2648.
  1067     12  ER-2649                 PIC  9(4) VALUE 2649.
  1068     12  ER-2650                 PIC  9(4) VALUE 2650.
  1069     12  ER-2651                 PIC  9(4) VALUE 2651.
  1070     12  ER-2653                 PIC  9(4) VALUE 2653.
  1071     12  ER-2654                 PIC  9(4) VALUE 2654.
  1072     12  ER-2655                 PIC  9(4) VALUE 2655.
  1073     12  ER-2656                 PIC  9(4) VALUE 2656.
  1074     12  ER-2657                 PIC  9(4) VALUE 2657.
  1075     12  ER-2660                 PIC  9(4) VALUE 2660.
  1076     12  ER-2661                 PIC  9(4) VALUE 2661.
  1077     12  ER-2662                 PIC  9(4) VALUE 2662.
  1078     12  ER-2663                 PIC  9(4) VALUE 2663.
  1079     12  ER-2664                 PIC  9(4) VALUE 2664.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  21
* EL6311.cbl
  1080     12  ER-2667                 PIC  9(4) VALUE 2667.
  1081     12  ER-2668                 PIC  9(4) VALUE 2668.
  1082     12  ER-2669                 PIC  9(4) VALUE 2669.
  1083     12  ER-2670                 PIC  9(4) VALUE 2670.
  1084     12  ER-2671                 PIC  9(4) VALUE 2671.
  1085     12  ER-2672                 PIC  9(4) VALUE 2672.
  1086     12  ER-2673                 PIC  9(4) VALUE 2673.
  1087     12  ER-2677                 PIC  9(4) VALUE 2677.
  1088     12  ER-2678                 PIC  9(4) VALUE 2678.
  1089     12  ER-2679                 PIC  9(4) VALUE 2679.
  1090     12  ER-2680                 PIC  9(4) VALUE 2680.
  1091     12  ER-2681                 PIC  9(4) VALUE 2681.
  1092     12  ER-2682                 PIC  9(4) VALUE 2682.
  1093     12  ER-2683                 PIC  9(4) VALUE 2683.
  1094     12  ER-2684                 PIC  9(4) VALUE 2684.
  1095     12  ER-2686                 PIC  9(4) VALUE 2686.
  1096     12  ER-2689                 PIC  9(4) VALUE 2689.
  1097     12  ER-2690                 PIC  9(4) VALUE 2690.
  1098     12  ER-2693                 PIC  9(4) VALUE 2693.
  1099     12  ER-2695                 PIC  9(4) VALUE 2695.
  1100     12  ER-2701                 PIC  9(4) VALUE 2701.
  1101     12  ER-2720                 PIC  9(4) VALUE 2720.
  1102     12  ER-2709                 PIC  9(4) VALUE 2709.
  1103     12  ER-2704                 PIC  9(4) VALUE 2704.
  1104     12  ER-2725                 PIC  9(4) VALUE 2725.
  1105     12  ER-2726                 PIC  9(4) VALUE 2726.
  1106     12  ER-2728                 PIC  9(4) VALUE 2728.
  1107     12  ER-2729                 PIC  9(4) VALUE 2729.
  1108     12  ER-2731                 PIC  9(4) VALUE 2731.
  1109     12  ER-2732                 PIC  9(4) VALUE 2732.
  1110     12  ER-2733                 PIC  9(4) VALUE 2733.
  1111     12  ER-2735                 PIC  9(4) VALUE 2735.
  1112     12  ER-2738                 PIC  9(4) VALUE 2738.
  1113     12  ER-2742                 PIC  9(4) VALUE 2742.
  1114     12  ER-2743                 PIC  9(4) VALUE 2743.
  1115     12  ER-2744                 PIC  9(4) VALUE 2744.
  1116     12  ER-2747                 PIC  9(4) VALUE 2747.
  1117     12  ER-2749                 PIC  9(4) VALUE 2749.
  1118     12  ER-2753                 PIC  9(4) VALUE 2753.
  1119     12  ER-2755                 PIC  9(4) VALUE 2755.
  1120     12  ER-2757                 PIC  9(4) VALUE 2757.
  1121     12  ER-2771                 PIC  9(4) VALUE 2771.
  1122     12  ER-2774                 PIC  9(4) VALUE 2774.
  1123     12  ER-2775                 PIC  9(4) VALUE 2775.
  1124     12  ER-2776                 PIC  9(4) VALUE 2776.
  1125     12  ER-2777                 PIC  9(4) VALUE 2777.
  1126     12  ER-2794                 PIC  9(4) VALUE 2794.
  1127     12  ER-2799                 PIC  9(4) VALUE 2799.
  1128     12  er-2878                 pic  9(4) value 2878.
  1129     12  ER-2900                 PIC  9(4) VALUE 2900.
  1130     12  ER-2902                 PIC  9(4) VALUE 2902.
  1131     12  ER-2945                 PIC  9(4) VALUE 2945.
  1132     12  ER-3000                 PIC  9(4) VALUE 3000.
  1133     12  ER-3006                 PIC  9(4) VALUE 3006.
  1134     12  ER-3054                 PIC  9(4) VALUE 3054.
  1135     12  er-3070                 pic  9(4) value 3070.
  1136     12  ER-3224                 PIC  9(4) VALUE 3224.
  1137     12  ER-3269                 PIC  9(4) VALUE 3269.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  22
* EL6311.cbl
  1138     12  er-3444                 pic  9(4) value 3444.
  1139     12  er-3446                 pic  9(4) value 3446.
  1140     12  er-3447                 pic  9(4) value 3447.
  1141     12  er-3448                 pic  9(4) value 3448.
  1142     12  er-3449                 pic  9(4) value 3449.
  1143     12  ER-3456                 PIC  9(4) VALUE 3456.
  1144     12  ER-3457                 PIC  9(4) VALUE 3457.
  1145     12  ER-3458                 PIC  9(4) VALUE 3458.
  1146     12  ER-3504                 PIC  9(4) VALUE 3504.
  1147     12  ER-3513                 PIC  9(4) VALUE 3513.
  1148     12  ER-3831                 PIC  9(4) VALUE 3831.
  1149     12  ER-3834                 PIC  9(4) VALUE 3834.
  1150     12  ER-3835                 PIC  9(4) VALUE 3835.
  1151     12  ER-4005                 PIC  9(4) VALUE 4005.
  1152     12  ER-7144                 PIC  9(4) VALUE 7144.
  1153     12  ER-7401                 PIC  9(4) VALUE 7401.
  1154     12  ER-7402                 PIC  9(4) VALUE 7402.
  1155     12  ER-7403                 PIC  9(4) VALUE 7403.
  1156     12  ER-7404                 PIC  9(4) VALUE 7404.
  1157     12  ER-7423                 PIC  9(4) VALUE 7423.
  1158     12  ER-7424                 PIC  9(4) VALUE 7424.
  1159     12  ER-7433                 PIC  9(4) VALUE 7433.
  1160     12  ER-7450                 PIC  9(4) VALUE 7450.
  1161     12  ER-7451                 PIC  9(4) VALUE 7451.
  1162     12  ER-7530                 PIC  9(4) VALUE 7530.
  1163     12  ER-7573                 PIC  9(4) VALUE 7573.
  1164     12  ER-7631                 PIC  9(4) VALUE 7631.
  1165     12  ER-7632                 PIC  9(4) VALUE 7632.
  1166     12  ER-7633                 PIC  9(4) VALUE 7633.
  1167     12  ER-7537                 PIC  9(4) VALUE 7537.
  1168     12  ER-7538                 PIC  9(4) VALUE 7538.
  1169     12  ER-7574                 PIC  9(4) VALUE 7574.
  1170     12  ER-7997                 PIC  9(4) VALUE 7997.
  1171     12  ER-7998                 PIC  9(4) VALUE 7998.
  1172     12  ER-8148                 PIC  9(4) VALUE 8148.
  1173     12  ER-9063                 PIC  9(4) VALUE 9063.
  1174     12  ER-9076                 PIC  9(4) VALUE 9076.
  1175     12  ER-9618                 PIC  9(4) VALUE 9618.
  1176     12  ER-9841                 PIC  9(4) VALUE 9841.
  1177     12  er-9853                 pic  9(4) value 9853.
  1178
  1179*                                COPY ELCTEXT.
  1180******************************************************************
  1181*                                                                *
  1182*                                                                *
  1183*                            ELCTEXT.                            *
  1184*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1185*                            VMOD=2.008                          *
  1186*                                                                *
  1187*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
  1188*                                     FORM LETTERS,              *
  1189*                                     CERT FORM DISPLAY.
  1190*                                                                *
  1191*   FILE TYPE = VSAM,KSDS                                        *
  1192*   RECORD SIZE = 100   RECFORM = FIXED                          *
  1193*                                                                *
  1194*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
  1195*       ALTERNATE INDEX = NONE                                   *
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  23
* EL6311.cbl
  1196*                                                                *
  1197*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
  1198*       ALTERNATE INDEX = NONE                                   *
  1199*                                                                *
  1200*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
  1201*       ALTERNATE INDEX = NONE                                   *
  1202*                                                                *
  1203*   LOG = NO                                                     *
  1204*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1205******************************************************************
  1206 01  TEXT-FILES.
  1207     12  TEXT-FILE-ID                PIC XX.
  1208         88  FORMS-FILE-TEXT            VALUE 'TF'.
  1209         88  LETTER-FILE-TEXT           VALUE 'TL'.
  1210         88  HELP-FILE-TEXT             VALUE 'TH'.
  1211
  1212     12  TX-CONTROL-PRIMARY.
  1213         16  TX-COMPANY-CD           PIC X.
  1214             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
  1215         16  TX-ACCESS-CD-GENL       PIC X(12).
  1216
  1217         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1218             20  TX-LETTER-NO        PIC X(4).
  1219             20  FILLER              PIC X(8).
  1220
  1221         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1222             20  TX-FORM-NO          PIC X(12).
  1223
  1224         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1225             20  TX-HELP-TYPE        PIC X.
  1226                 88  HELP-FOR-GENERAL   VALUE ' '.
  1227                 88  HELP-BY-SCREEN     VALUE 'S'.
  1228                 88  HELP-BY-ERROR      VALUE 'E'.
  1229             20  TX-SCREEN-OR-ERROR  PIC X(4).
  1230                 88  GENERAL-INFO-HELP  VALUE '0000'.
  1231             20  TX-HELP-FOR-COMPANY  PIC XXX.
  1232                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
  1233             20  FILLER              PIC X(4).
  1234
  1235         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
  1236
  1237     12  TX-PROCESS-CONTROL          PIC XX.
  1238         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
  1239
  1240     12  TX-TEXT-LINE                PIC X(70).
  1241
  1242     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
  1243         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
  1244         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
  1245         88  TX-VALID-FORM-SQUEEZE-VALUE
  1246                                        VALUE 'Y' ' '.
  1247
  1248     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
  1249         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
  1250         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
  1251         88  TX-DO-NOT-ADJUST           VALUE 'N'.
  1252         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
  1253         88  TX-NEW-PARAGRAPH           VALUE 'P'.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  24
* EL6311.cbl
  1254         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
  1255         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
  1256                                              'K' 'N' ' '
  1257                                              'Z'.
  1258
  1259     12  TX-ARCHIVE-SW               PIC X.
  1260         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
  1261         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
  1262         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
  1263
  1264     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
  1265     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
  1266
  1267     12  TX-BSR-CODE                 PIC X.
  1268         88  TX-BSR-LETTER              VALUE 'B'.
  1269         88  TX-NON-BSR-LETTER          VALUE ' '.
  1270
  1271     12  FILLER                      PIC X.
  1272*****************************************************************
  1273*                                COPY ELCCRTO.
  1274******************************************************************
  1275*                                                                *
  1276*                            ELCCRTO.                            *
  1277*                                                                *
  1278*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  1279*                                                                *
  1280*   FILE TYPE = VSAM,KSDS                                        *
  1281*   RECORD SIZE = 524  RECFORM = FIXED                           *
  1282*                                                                *
  1283*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  1284*                                                                *
  1285*   LOG = YES                                                    *
  1286*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1287******************************************************************
  1288*                   C H A N G E   L O G
  1289*
  1290* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1291*-----------------------------------------------------------------
  1292*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1293* EFFECTIVE    NUMBER
  1294*-----------------------------------------------------------------
  1295* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  1296* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  1297* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  1298* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  1299* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  1300******************************************************************
  1301 01  ORIGINAL-CERTIFICATE.
  1302     12  OC-RECORD-ID                      PIC XX.
  1303         88  VALID-OC-ID                      VALUE 'OC'.
  1304     12  OC-CONTROL-PRIMARY.
  1305         16  OC-COMPANY-CD                 PIC X.
  1306         16  OC-CARRIER                    PIC X.
  1307         16  OC-GROUPING                   PIC X(6).
  1308         16  OC-STATE                      PIC XX.
  1309         16  OC-ACCOUNT                    PIC X(10).
  1310         16  OC-CERT-EFF-DT                PIC XX.
  1311         16  OC-CERT-NO.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  25
* EL6311.cbl
  1312             20  OC-CERT-PRIME             PIC X(10).
  1313             20  OC-CERT-SFX               PIC X.
  1314         16  OC-RECORD-TYPE                PIC X.
  1315         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  1316     12  OC-LAST-MAINT-DT                  PIC XX.
  1317     12  OC-LAST-MAINT-BY                  PIC X(4).
  1318     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  1319     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  1320     12  FILLER                            PIC X(49).
  1321     12  OC-ORIG-REC.
  1322         16  OC-INS-LAST-NAME              PIC X(15).
  1323         16  OC-INS-FIRST-NAME             PIC X(10).
  1324         16  OC-INS-MIDDLE-INIT            PIC X.
  1325         16  OC-INS-AGE                    PIC S999     COMP-3.
  1326         16  OC-JNT-LAST-NAME              PIC X(15).
  1327         16  OC-JNT-FIRST-NAME             PIC X(10).
  1328         16  OC-JNT-MIDDLE-INIT            PIC X.
  1329         16  OC-JNT-AGE                    PIC S999     COMP-3.
  1330         16  OC-LF-BENCD                   PIC XX.
  1331         16  OC-LF-TERM                    PIC S999      COMP-3.
  1332         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  1333         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  1334         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  1335         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  1336         16  OC-LF-EXP-DT                  PIC XX.
  1337         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  1338         16  OC-LF-CANCEL-DT               PIC XX.
  1339         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  1340         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1341         16  OC-AH-BENCD                   PIC XX.
  1342         16  OC-AH-TERM                    PIC S999      COMP-3.
  1343         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  1344         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  1345         16  OC-AH-EXP-DT                  PIC XX.
  1346         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  1347         16  OC-AH-CP                      PIC 99.
  1348         16  OC-AH-CANCEL-DT               PIC XX.
  1349         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  1350         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1351         16  OC-CRED-BENE-NAME             PIC X(25).
  1352         16  OC-1ST-PMT-DT                 PIC XX.
  1353         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  1354         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  1355         16  OC-ISSUE-TRAN-IND             PIC X.
  1356         16  OC-CANCEL-TRAN-IND            PIC X.
  1357         16  FILLER                        PIC X(211).
  1358
  1359     12  FILLER                            PIC X(50).
  1360******************************************************************
  1361*                                COPY ERCACCT.
  1362******************************************************************
  1363*                                                                *
  1364*                                                                *
  1365*                            ERCACCT                             *
  1366*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1367*                            VMOD=2.031                          *
  1368*                                                                *
  1369*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  26
* EL6311.cbl
  1370*                                                                *
  1371*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  1372*   VSAM ACCOUNT MASTER FILES.                                   *
  1373*                                                                *
  1374*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  1375*                                                                *
  1376*   FILE TYPE = VSAM,KSDS                                        *
  1377*   RECORD SIZE = 2000  RECFORM = FIX                            *
  1378*                                                                *
  1379*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  1380*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  1381*                                                                *
  1382*   LOG = NO                                                     *
  1383*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1384*                                                                *
  1385*                                                                *
  1386******************************************************************
  1387*                   C H A N G E   L O G
  1388*
  1389* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1390*-----------------------------------------------------------------
  1391*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1392* EFFECTIVE    NUMBER
  1393*-----------------------------------------------------------------
  1394* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  1395* 092705    2005050300006  PEMA  ADD SPP LEASES
  1396* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  1397* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1398* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  1399* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  1400* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  1401* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  1402******************************************************************
  1403
  1404 01  ACCOUNT-MASTER.
  1405     12  AM-RECORD-ID                      PIC XX.
  1406         88  VALID-AM-ID                      VALUE 'AM'.
  1407
  1408     12  AM-CONTROL-PRIMARY.
  1409         16  AM-COMPANY-CD                 PIC X.
  1410         16  AM-MSTR-CNTRL.
  1411             20  AM-CONTROL-A.
  1412                 24  AM-CARRIER            PIC X.
  1413                 24  AM-GROUPING.
  1414                     28 AM-GROUPING-PREFIX PIC XXX.
  1415                     28 AM-GROUPING-PRIME  PIC XXX.
  1416                 24  AM-STATE              PIC XX.
  1417                 24  AM-ACCOUNT.
  1418                     28  AM-ACCOUNT-PREFIX PIC X(4).
  1419                     28  AM-ACCOUNT-PRIME  PIC X(6).
  1420             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  1421                                           PIC X(19).
  1422             20  AM-CNTRL-B.
  1423                 24  AM-EXPIRATION-DT      PIC XX.
  1424                 24  FILLER                PIC X(4).
  1425             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  1426                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  1427
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  27
* EL6311.cbl
  1428     12  AM-CONTROL-BY-VAR-GRP.
  1429         16  AM-COMPANY-CD-A1              PIC X.
  1430         16  AM-VG-CARRIER                 PIC X.
  1431         16  AM-VG-GROUPING                PIC X(6).
  1432         16  AM-VG-STATE                   PIC XX.
  1433         16  AM-VG-ACCOUNT                 PIC X(10).
  1434         16  AM-VG-DATE.
  1435             20  AM-VG-EXPIRATION-DT       PIC XX.
  1436             20  FILLER                    PIC X(4).
  1437         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  1438                                           PIC 9(11)      COMP-3.
  1439     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  1440         16  FILLER                        PIC X(10).
  1441         16  AM-VG-KEY3.
  1442             20  AM-VG3-ACCOUNT            PIC X(10).
  1443             20  AM-VG3-EXP-DT             PIC XX.
  1444         16  FILLER                        PIC X(4).
  1445     12  AM-MAINT-INFORMATION.
  1446         16  AM-LAST-MAINT-DT              PIC XX.
  1447         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1448         16  AM-LAST-MAINT-USER            PIC X(4).
  1449         16  FILLER                        PIC XX.
  1450
  1451     12  AM-EFFECTIVE-DT                   PIC XX.
  1452     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  1453
  1454     12  AM-PREV-DATES  COMP-3.
  1455         16  AM-PREV-EXP-DT                PIC 9(11).
  1456         16  AM-PREV-EFF-DT                PIC 9(11).
  1457
  1458     12  AM-REPORT-CODE-1                  PIC X(10).
  1459     12  AM-REPORT-CODE-2                  PIC X(10).
  1460
  1461     12  AM-CITY-CODE                      PIC X(4).
  1462     12  AM-COUNTY-PARISH                  PIC X(6).
  1463
  1464     12  AM-NAME                           PIC X(30).
  1465     12  AM-PERSON                         PIC X(30).
  1466     12  AM-ADDRS                          PIC X(30).
  1467     12  AM-CITY.
  1468         16  AM-ADDR-CITY                  PIC X(28).
  1469         16  AM-ADDR-STATE                 PIC XX.
  1470     12  AM-ZIP.
  1471         16  AM-ZIP-PRIME.
  1472             20  AM-ZIP-PRI-1ST            PIC X.
  1473                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  1474             20  FILLER                    PIC X(4).
  1475         16  AM-ZIP-PLUS4                  PIC X(4).
  1476     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  1477         16  AM-CAN-POSTAL-1               PIC XXX.
  1478         16  AM-CAN-POSTAL-2               PIC XXX.
  1479         16  FILLER                        PIC XXX.
  1480     12  AM-TEL-NO.
  1481         16  AM-AREA-CODE                  PIC 999.
  1482         16  AM-TEL-PRE                    PIC 999.
  1483         16  AM-TEL-NBR                    PIC 9(4).
  1484     12  AM-TEL-LOC                        PIC X.
  1485         88  AM-TEL-AT-HOME                   VALUE 'H'.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  28
* EL6311.cbl
  1486         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  1487
  1488     12  AM-COMM-STRUCTURE.
  1489         16  AM-DEFN-1.
  1490             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  1491                 24  AM-AGT.
  1492                     28  AM-AGT-PREFIX     PIC X(4).
  1493                     28  AM-AGT-PRIME      PIC X(6).
  1494                 24  AM-COM-TYP            PIC X.
  1495                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  1496                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  1497                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  1498                 24  AM-RECALC-LV-INDIC    PIC X.
  1499                 24  AM-RETRO-LV-INDIC     PIC X.
  1500                 24  AM-GL-CODES           PIC X.
  1501                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  1502                 24  FILLER                PIC X(01).
  1503         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  1504             20  AM-COM-TBLS        OCCURS 10 TIMES.
  1505                 24  FILLER                PIC X(11).
  1506                 24  AM-L-COMA             PIC XXX.
  1507                 24  AM-J-COMA             PIC XXX.
  1508                 24  AM-A-COMA             PIC XXX.
  1509                 24  FILLER                PIC X(6).
  1510
  1511     12  AM-COMM-CHANGE-STATUS             PIC X.
  1512         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  1513
  1514     12  AM-CSR-CODE                       PIC X(4).
  1515
  1516     12  AM-BILLING-STATUS                 PIC X.
  1517         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  1518         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  1519     12  AM-AUTO-REFUND-SW                 PIC X.
  1520         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  1521         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  1522     12  AM-GPCD                           PIC 99.
  1523     12  AM-IG                             PIC X.
  1524         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  1525         88  AM-HAS-GROUP                     VALUE '2'.
  1526     12  AM-STATUS                         PIC X.
  1527         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  1528         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  1529         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  1530         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  1531         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  1532         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  1533         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  1534         88  AM-ACCOUNT-LAPSED                VALUE '7'.
  1535         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  1536         88  AM-ACCOUNT-PENDING               VALUE '9'.
  1537     12  AM-REMIT-TO                       PIC 99.
  1538     12  AM-ID-NO                          PIC X(11).
  1539
  1540     12  AM-CAL-TABLE                      PIC XX.
  1541     12  AM-LF-DEVIATION                   PIC XXX.
  1542     12  AM-AH-DEVIATION                   PIC XXX.
  1543     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  29
* EL6311.cbl
  1544     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  1545     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  1546     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  1547     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1548     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1549
  1550     12  AM-USER-FIELDS.
  1551         16  AM-FLD-1                      PIC XX.
  1552         16  AM-FLD-2                      PIC XX.
  1553         16  AM-FLD-3                      PIC XX.
  1554         16  AM-FLD-4                      PIC XX.
  1555         16  AM-FLD-5                      PIC XX.
  1556
  1557     12  AM-1ST-PROD-DATE.
  1558         16  AM-1ST-PROD-YR                PIC XX.
  1559         16  AM-1ST-PROD-MO                PIC XX.
  1560         16  AM-1ST-PROD-DA                PIC XX.
  1561     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  1562     12  AM-CERTS-PURGED-DATE.
  1563         16  AM-PUR-YR                     PIC XX.
  1564         16  AM-PUR-MO                     PIC XX.
  1565         16  AM-PUR-DA                     PIC XX.
  1566     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  1567     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  1568     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  1569     12  AM-INACTIVE-DATE.
  1570         16  AM-INA-MO                     PIC 99.
  1571         16  AM-INA-DA                     PIC 99.
  1572         16  AM-INA-YR                     PIC 99.
  1573     12  AM-AR-HI-CERT-DATE                PIC XX.
  1574
  1575     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  1576     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  1577
  1578     12  AM-OB-PAYMENT-MODE                PIC X.
  1579         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  1580         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  1581         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  1582         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  1583
  1584     12  AM-AH-ONLY-INDICATOR              PIC X.
  1585         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  1586         88  AM-NO-AH-ONLY                    VALUE 'N'.
  1587
  1588     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  1589
  1590     12  AM-OVER-SHORT.
  1591         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  1592         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  1593
  1594     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  1595     12  AM-DCC-CLP-STATE                  PIC XX.
  1596
  1597     12  AM-RECALC-COMM                    PIC X.
  1598     12  AM-RECALC-REIN                    PIC X.
  1599
  1600     12  AM-REI-TABLE                      PIC XXX.
  1601     12  AM-REI-ET-LF                      PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  30
* EL6311.cbl
  1602     12  AM-REI-ET-AH                      PIC X.
  1603     12  AM-REI-PE-LF                      PIC X.
  1604     12  AM-REI-PE-AH                      PIC X.
  1605     12  AM-REI-PRT-ST                     PIC X.
  1606     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  1607     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  1608     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  1609     12  AM-REI-GROUP-A                    PIC X(6).
  1610     12  AM-REI-MORT                       PIC X(4).
  1611     12  AM-REI-PRT-OW                     PIC X.
  1612     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  1613     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  1614     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  1615     12  AM-REI-GROUP-B                    PIC X(6).
  1616
  1617     12  AM-TRUST-TYPE                     PIC X(2).
  1618
  1619     12  AM-EMPLOYER-STMT-USED             PIC X.
  1620     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  1621
  1622     12  AM-STD-AH-TYPE                    PIC XX.
  1623     12  AM-EARN-METHODS.
  1624         16  AM-EARN-METHOD-R              PIC X.
  1625             88 AM-REF-RL-R78                 VALUE 'R'.
  1626             88 AM-REF-RL-PR                  VALUE 'P'.
  1627             88 AM-REF-RL-MEAN                VALUE 'M'.
  1628             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  1629         16  AM-EARN-METHOD-L              PIC X.
  1630             88 AM-REF-LL-R78                 VALUE 'R'.
  1631             88 AM-REF-LL-PR                  VALUE 'P'.
  1632             88 AM-REF-LL-MEAN                VALUE 'M'.
  1633             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  1634         16  AM-EARN-METHOD-A              PIC X.
  1635             88 AM-REF-AH-R78                 VALUE 'R'.
  1636             88 AM-REF-AH-PR                  VALUE 'P'.
  1637             88 AM-REF-AH-MEAN                VALUE 'M'.
  1638             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  1639             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  1640             88 AM-REF-AH-NET                 VALUE 'N'.
  1641
  1642     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  1643     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  1644     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  1645
  1646     12  AM-RET-Y-N                        PIC X.
  1647     12  AM-RET-P-E                        PIC X.
  1648     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  1649     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  1650     12  AM-RET-GRP                        PIC X(6).
  1651     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  1652         16  AM-POOL-PRIME                 PIC XXX.
  1653         16  AM-POOL-SUB                   PIC XXX.
  1654     12  AM-RETRO-EARNINGS.
  1655         16  AM-RET-EARN-R                 PIC X.
  1656         16  AM-RET-EARN-L                 PIC X.
  1657         16  AM-RET-EARN-A                 PIC X.
  1658     12  AM-RET-ST-TAX-USE                 PIC X.
  1659         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  31
* EL6311.cbl
  1660         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  1661     12  AM-RETRO-BEG-EARNINGS.
  1662         16  AM-RET-BEG-EARN-R             PIC X.
  1663         16  AM-RET-BEG-EARN-L             PIC X.
  1664         16  AM-RET-BEG-EARN-A             PIC X.
  1665     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  1666     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  1667
  1668     12  AM-USER-SELECT-OPTIONS.
  1669         16  AM-USER-SELECT-1              PIC X(10).
  1670         16  AM-USER-SELECT-2              PIC X(10).
  1671         16  AM-USER-SELECT-3              PIC X(10).
  1672         16  AM-USER-SELECT-4              PIC X(10).
  1673         16  AM-USER-SELECT-5              PIC X(10).
  1674
  1675     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  1676
  1677     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  1678
  1679     12  AM-RPT045A-SWITCH                 PIC X.
  1680         88  RPT045A-OFF                   VALUE 'N'.
  1681
  1682     12  AM-INSURANCE-LIMITS.
  1683         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  1684         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  1685
  1686     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  1687         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  1688
  1689     12  AM-DISMBR-COVERAGE-SW             PIC X.
  1690         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  1691         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  1692
  1693     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  1694
  1695     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  1696     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  1697     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  1698     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  1699     12  AM-DCC-UEF-STATE                  PIC XX.
  1700     12  FILLER                            PIC XXX.
  1701     12  AM-REPORT-CODE-3                  PIC X(10).
  1702*    12  FILLER                            PIC X(22).
  1703
  1704     12  AM-RESERVE-DATE.
  1705         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  1706         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  1707         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  1708
  1709     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  1710     12  AM-NOTIFICATION-TYPES.
  1711         16  AM-NOTIF-OF-LETTERS           PIC X.
  1712         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  1713         16  AM-NOTIF-OF-REPORTS           PIC X.
  1714         16  AM-NOTIF-OF-STATUS            PIC X.
  1715
  1716     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  1717         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  32
* EL6311.cbl
  1718         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  1719         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  1720         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  1721
  1722     12  AM-BENEFIT-CONTROLS.
  1723         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  1724             20  AM-BENEFIT-CODE           PIC XX.
  1725             20  AM-BENEFIT-TYPE           PIC X.
  1726             20  AM-BENEFIT-REVISION       PIC XXX.
  1727             20  AM-BENEFIT-REM-TERM       PIC X.
  1728             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  1729             20  FILLER                    PIC XX.
  1730         16  FILLER                        PIC X(80).
  1731
  1732     12  AM-TRANSFER-DATA.
  1733         16  AM-TRANSFERRED-FROM.
  1734             20  AM-TRNFROM-CARRIER        PIC X.
  1735             20  AM-TRNFROM-GROUPING.
  1736                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  1737                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  1738             20  AM-TRNFROM-STATE          PIC XX.
  1739             20  AM-TRNFROM-ACCOUNT.
  1740                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  1741                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  1742             20  AM-TRNFROM-DTE            PIC XX.
  1743         16  AM-TRANSFERRED-TO.
  1744             20  AM-TRNTO-CARRIER          PIC X.
  1745             20  AM-TRNTO-GROUPING.
  1746                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  1747                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  1748             20  AM-TRNTO-STATE            PIC XX.
  1749             20  AM-TRNTO-ACCOUNT.
  1750                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  1751                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  1752             20  AM-TRNTO-DTE              PIC XX.
  1753         16  FILLER                        PIC X(10).
  1754
  1755     12  AM-SAVED-REMIT-TO                 PIC 99.
  1756
  1757     12  AM-COMM-STRUCTURE-SAVED.
  1758         16  AM-DEFN-1-SAVED.
  1759             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  1760                 24  AM-AGT-SV             PIC X(10).
  1761                 24  AM-COM-TYP-SV         PIC X.
  1762                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  1763                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  1764                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  1765                 24  AM-RECALC-LV-INDIC-SV PIC X.
  1766                 24  FILLER                PIC X.
  1767                 24  AM-GL-CODES-SV        PIC X.
  1768                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  1769                 24  FILLER                PIC X.
  1770         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  1771             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  1772                 24  FILLER                PIC X(11).
  1773                 24  AM-L-COMA-SV          PIC XXX.
  1774                 24  AM-J-COMA-SV          PIC XXX.
  1775                 24  AM-A-COMA-SV          PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  33
* EL6311.cbl
  1776                 24  FILLER                PIC X(6).
  1777
  1778     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  1779         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  1780            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  1781            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  1782            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  1783
  1784     12  AM-ORIG-DEALER-NO                 PIC X(10).
  1785     12  FILLER                            PIC X(120).
  1786
  1787     12  AM-ACCOUNT-EXECUTIVE-DATA.
  1788         16  AM-CONTROL-NAME               PIC X(30).
  1789         16  AM-EXECUTIVE-ONE.
  1790             20  AM-EXEC1-NAME             PIC X(15).
  1791             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  1792                                                          COMP-3.
  1793             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  1794                                                          COMP-3.
  1795         16  AM-EXECUTIVE-TWO.
  1796             20  AM-EXEC2-NAME             PIC X(15).
  1797             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  1798                                                          COMP-3.
  1799             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  1800                                                          COMP-3.
  1801
  1802     12  AM-RETRO-ADDITIONAL-DATA.
  1803         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  1804         16  AM-RETRO-PREM-P-E             PIC X.
  1805         16  AM-RETRO-CLMS-P-I             PIC X.
  1806         16  AM-RETRO-RET-BRACKET-LF.
  1807             20  AM-RETRO-RET-METHOD-LF    PIC X.
  1808                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  1809                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  1810             20  AM-RETRO-RET-BASIS-LF     PIC X.
  1811                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  1812                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  1813             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  1814                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  1815                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  1816         16  AM-RETRO-RET-BRACKET-AH.
  1817             20  AM-RETRO-RET-METHOD-AH    PIC X.
  1818                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  1819                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  1820                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  1821             20  AM-RETRO-RET-BASIS-AH     PIC X.
  1822                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  1823                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  1824             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  1825                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  1826                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  1827
  1828     12  AM-COMMENTS.
  1829         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  1830
  1831     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  1832         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  1833         16  AM-FLI-BILLING-CODE           PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  34
* EL6311.cbl
  1834         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  1835         16  AM-FLI-UNITED-IDENT           PIC X.
  1836         16  AM-FLI-INTEREST-LOST-DATA.
  1837             20  AM-FLI-BANK-NO            PIC X(5).
  1838             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  1839             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  1840             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  1841         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  1842             20  AM-FLI-AGT                PIC X(9).
  1843             20  AM-FLI-AGT-COMM-ACC       PIC X.
  1844             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  1845         16  FILLER                        PIC X(102).
  1846
  1847     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  1848         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  1849             20  AM-BENEFIT-DMD-CODE         PIC XX.
  1850             20  AM-BENEFIT-DMD-TYPE         PIC X.
  1851             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  1852             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  1853             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  1854         16  FILLER                          PIC X(10).
  1855******************************************************************
  1856*                                copy ERCACNT.
  1857******************************************************************
  1858*                                                                *
  1859*                                                                *
  1860*                            ERCACNT.                            *
  1861*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1862*                            VMOD=2.002                          *
  1863*                                                                *
  1864*   FILE DESCRIPTION = NOTE FILE FOR RECORDING OF ACCOUNT NOTES  *
  1865*                                                                *
  1866*   FILE TYPE = VSAM,KSDS                                        *
  1867*   RECORD SIZE = 120   RECFORM = FIXED                          *
  1868*                                                                *
  1869*   BASE CLUSTER NAME = ERACNT             RKP=2,LEN=23          *
  1870*       ALTERNATE INDEX = NONE                                   *
  1871*                                                                *
  1872*                                                                *
  1873*   LOG = YES                                                    *
  1874*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1875******************************************************************
  1876*                   C H A N G E   L O G
  1877*
  1878* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1879*-----------------------------------------------------------------
  1880*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1881* EFFECTIVE    NUMBER
  1882*-----------------------------------------------------------------
  1883* 110706  CR2006071700004  PEMA  ADD BRANCH LOCATIONS
  1884*           AND SHIPPING ADDRESS TO ACCOUNT NOTES FILE
  1885******************************************************************
  1886 01  NOTE-FILE.
  1887     12  NT-FILE-ID                  PIC XX.
  1888         88  VALID-NOTE-ID              VALUE 'NT'.
  1889
  1890     12  NT-CONTROL-PRIMARY.
  1891         16  NT-COMPANY-CD           PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  35
* EL6311.cbl
  1892         16  NT-ACCT-NOTE-KEY.
  1893             18  NT-CARRIER              PIC X.
  1894             18  NT-GROUPING             PIC X(06).
  1895             18  NT-STATE                PIC XX.
  1896             18  NT-ACCOUNT              PIC X(10).
  1897         16  NT-RECORD-TYPE          PIC X.
  1898              88  ACCT-NOTE          VALUE '1'.
  1899              88  ACCT-BRANCH-LOC    VALUE '2'.
  1900              88  ACCT-SHIPPING-ADDR VALUE '3'.
  1901         16  NT-LINE-SEQUENCE        PIC S9(4)     COMP.
  1902
  1903     12  NT-LAST-MAINT-DT            PIC XX.
  1904     12  NT-LAST-MAINT-BY            PIC X(4).
  1905     12  NT-LAST-MAINT-HHMMSS        PIC S9(7) COMP-3.
  1906
  1907*  ALL NOTE LINES ARE RECORD TYPE '1' WITH ALMOST UNLIMITED
  1908*     SEQUENCE NUMBERS
  1909     12  NT-NOTE-INFORMATION.
  1910         16  NT-NOTE-LINE            PIC X(60).
  1911         16  FILLER                  PIC X(25).
  1912*  BOTH BRANCH LOCATION LINES ARE RECORD TYPE '2' SEQ 1 AND 2
  1913     12  NT-LOCATION-INFORMATION REDEFINES
  1914                         NT-NOTE-INFORMATION.
  1915         16  NT-BRANCH-LOC-LINE      PIC X(60).
  1916         16  FILLER                  PIC X(25).
  1917* Account special indicator is record type '2', sequence 3
  1918     12  filler REDEFINES NT-NOTE-INFORMATION.
  1919         16  nt-account-special      PIC X.
  1920         16  FILLER                  PIC X(84).
  1921*  ALL SHIPPING ADDRESS LINES ARE RECORD TYPE '3'AND
  1922*     SEQUENCE NUMBER 1 IS NAME LINE 1
  1923*     SEQUENCE NUMBER 2 IS NAME LINE 2
  1924*     SEQUENCE NUMBER 3 IS ADDR LINE 1
  1925*     SEQUENCE NUMBER 4 IS ADDR LINE 2
  1926*     SEQUENCE NUMBER 5 IS ADDR LINE 3
  1927*     SEQUENCE NUMBER 6 IS CITY, ST AND ZIP
  1928     12  NT-SHIPPING-INFORMATION REDEFINES
  1929                         NT-NOTE-INFORMATION.
  1930         16  NT-SHIPPING-LINE        PIC X(60).
  1931         16  NT-SHIP-STATE           PIC XX.
  1932         16  NT-SHIP-ZIP             PIC X(10).
  1933         16  FILLER                  PIC X(13).
  1934*****************************************************************
  1935*                                COPY ELCVADS.
  1936******************************************************************
  1937*                                                                *
  1938*                                                                *
  1939*                            ELCVADS.                            *
  1940*                                                                *
  1941*   FILE DESCRIPTION = VIRGINIA DISLCOSURE FIELDS PASSED TO      *
  1942*   ELVADS                  LENGTH = 350                         *
  1943******************************************************************
  1944******************************************************************
  1945*                   C H A N G E   L O G
  1946*
  1947* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1948*-----------------------------------------------------------------
  1949*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  36
* EL6311.cbl
  1950* EFFECTIVE    NUMBER
  1951*-----------------------------------------------------------------
  1952* 100111    2011022800001  AJRA  NAPERSOFT
  1953******************************************************************
  1954
  1955 01  VIRGINIA-DISCLOSURE.
  1956     12  VD-COMPANY-CD              PIC X.
  1957     12  VD-CARRIER                 PIC X.
  1958     12  VD-GROUPING.
  1959         20  VD-GROUPING-PREFIX     PIC XXX.
  1960         20  VD-GROUPING-PRIME      PIC XXX.
  1961     12  VD-STATE                   PIC XX.
  1962     12  VD-ACCOUNT.
  1963         20  VD-ACCOUNT-PREFIX      PIC X(4).
  1964         20  VD-ACCOUNT-PRIME       PIC X(6).
  1965     12  VD-CERT-EFF-DT             PIC XX.
  1966     12  VD-CERT-NO.
  1967         20  VD-CERT-PRIME          PIC X(10).
  1968         20  VD-CERT-SFX            PIC X.
  1969     12  VD-ENTRY-BATCH             PIC X(6).
  1970     12  VD-CSR-ID                  PIC X(4).
  1971     12  VD-NAME.
  1972         20  VD-INSURED-LAST-NAME   PIC X(15).
  1973         20  VD-INSURED-FIRST-NAME.
  1974             24  VD-INSURED-1ST-INIT PIC X.
  1975             24  FILLER             PIC X(9).
  1976         20  VD-INSURED-MIDDLE-INIT PIC X.
  1977     12  VD-JOINT-INSURED.
  1978         20 VD-JOINT-LAST-NAME      PIC X(15).
  1979         20 VD-JOINT-FIRST-NAME.
  1980            24  VD-JOINT-FIRST-INIT PIC X.
  1981            24  FILLER              PIC X(9).
  1982         20 VD-JOINT-MIDDLE-INIT    PIC X.
  1983     12  VD-INSURED-ADDRESS-1       PIC X(30).
  1984     12  VD-INSURED-ADDRESS-2       PIC X(30).
  1985     12  VD-INSURED-CITY-STATE.
  1986         20  VD-INSURED-CITY        PIC X(28).
  1987         20  VD-INSURED-STATE       PIC XX.
  1988     12  VD-INSURED-ZIP-CODE.
  1989         20  VD-INSURED-ZIP-PRIME.
  1990             24  VD-INSURED-ZIP-1   PIC X.
  1991                 88  VD-CANADIAN-POST-CODE
  1992                                       VALUE 'A' THRU 'Z'.
  1993             24  FILLER             PIC X(4).
  1994         20  VD-INSURED-ZIP-PLUS4   PIC X(4).
  1995     12  VD-BENEFICIARY-NAME        PIC X(30).
  1996     12  VD-ACCOUNT-NAME            PIC X(30).
  1997     12  VD-LOAN-TERM               PIC S999   COMP-3.
  1998     12  VD-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  1999     12  VD-1ST-PMT-DT              PIC XX.
  2000     12  VD-LIFE-BENEFIT-CD         PIC XX.
  2001         88  VD-VALID-LIFE             VALUE '01' THRU '89'.
  2002         88  VD-INVALID-LIFE           VALUE '  ' '00'
  2003                                             '90' THRU '99'.
  2004     12  VD-LF-BENEFIT-CD   REDEFINES VD-LIFE-BENEFIT-CD
  2005                                    PIC XX.
  2006     12  VD-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  2007     12  VD-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  37
* EL6311.cbl
  2008     12  VD-LF-RATE                 PIC S99V9(5)   COMP-3.
  2009     12  VD-LF-TERM                 PIC S999   COMP-3.
  2010     12  VD-AH-BENEFIT-CD           PIC XX.
  2011         88  VD-VALID-AH               VALUE '01' THRU '89'.
  2012         88  VD-INVALID-AH             VALUE '  ' '00'
  2013                                             '90' THRU '99'.
  2014     12  VD-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  2015     12  VD-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  2016     12  VD-AH-RATE                 PIC S99V9(5)   COMP-3.
  2017     12  VD-AH-TERM                 PIC S999   COMP-3.
  2018     12  VD-LETTER-ID               PIC X(4).
  2019     12  VD-PROC-ID                 PIC X(4).
  2020     12  VD-COMP-ID                 PIC X(3).
  2021     12  VD-CURRENT-DATE            PIC XX.
  2022     12  VD-CURRENT-TIME            PIC S9(6) COMP-3.
  2023     12  VD-ARCHIVE-NO              PIC S9(08) COMP VALUE +0.
  2024     12  FILLER                     PIC X(32).
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  38
* EL6311.cbl
  2026*    COPY ELCDATE.
  2027******************************************************************
  2028*                                                                *
  2029*                                                                *
  2030*                            ELCDATE.                            *
  2031*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2032*                            VMOD=2.003
  2033*                                                                *
  2034*                                                                *
  2035*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  2036*                 LENGTH = 200                                   *
  2037******************************************************************
  2038
  2039 01  DATE-CONVERSION-DATA.
  2040     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  2041     12  DC-OPTION-CODE                PIC X.
  2042         88  BIN-TO-GREG                VALUE ' '.
  2043         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  2044         88  EDIT-GREG-TO-BIN           VALUE '2'.
  2045         88  YMD-GREG-TO-BIN            VALUE '3'.
  2046         88  MDY-GREG-TO-BIN            VALUE '4'.
  2047         88  JULIAN-TO-BIN              VALUE '5'.
  2048         88  BIN-PLUS-ELAPSED           VALUE '6'.
  2049         88  FIND-CENTURY               VALUE '7'.
  2050         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  2051         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  2052         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  2053         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  2054         88  JULIAN-TO-BIN-3            VALUE 'C'.
  2055         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  2056         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  2057         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  2058         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  2059         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  2060         88  CHECK-LEAP-YEAR            VALUE 'H'.
  2061         88  BIN-3-TO-GREG              VALUE 'I'.
  2062         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  2063         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  2064         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  2065         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  2066         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  2067         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  2068         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  2069         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  2070         88  THREE-CHARACTER-BIN
  2071                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  2072         88  GREGORIAN-TO-BIN
  2073                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  2074         88  BIN-TO-GREGORIAN
  2075                  VALUES ' ' '1' 'I' '8' 'G'.
  2076         88  JULIAN-TO-BINARY
  2077                  VALUES '5' 'C' 'E' 'F'.
  2078     12  DC-ERROR-CODE                 PIC X.
  2079         88  NO-CONVERSION-ERROR        VALUE ' '.
  2080         88  DATE-CONVERSION-ERROR
  2081                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  2082         88  DATE-IS-ZERO               VALUE '1'.
  2083         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  39
* EL6311.cbl
  2084         88  DATE-IS-INVALID            VALUE '3'.
  2085         88  DATE1-GREATER-DATE2        VALUE '4'.
  2086         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  2087         88  DATE-INVALID-OPTION        VALUE '9'.
  2088         88  INVALID-CENTURY            VALUE 'A'.
  2089         88  ONLY-CENTURY               VALUE 'B'.
  2090         88  ONLY-LEAP-YEAR             VALUE 'C'.
  2091         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  2092     12  DC-END-OF-MONTH               PIC X.
  2093         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  2094     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  2095         88  USE-NORMAL-PROCESS         VALUE ' '.
  2096         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  2097         88  ADJUST-UP-100-YRS          VALUE '2'.
  2098     12  FILLER                        PIC X.
  2099     12  DC-CONVERSION-DATES.
  2100         16  DC-BIN-DATE-1             PIC XX.
  2101         16  DC-BIN-DATE-2             PIC XX.
  2102         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  2103         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  2104                       DC-GREG-DATE-1-EDIT.
  2105             20  DC-EDIT1-MONTH        PIC 99.
  2106             20  SLASH1-1              PIC X.
  2107             20  DC-EDIT1-DAY          PIC 99.
  2108             20  SLASH1-2              PIC X.
  2109             20  DC-EDIT1-YEAR         PIC 99.
  2110         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  2111         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  2112                     DC-GREG-DATE-2-EDIT.
  2113             20  DC-EDIT2-MONTH        PIC 99.
  2114             20  SLASH2-1              PIC X.
  2115             20  DC-EDIT2-DAY          PIC 99.
  2116             20  SLASH2-2              PIC X.
  2117             20  DC-EDIT2-YEAR         PIC 99.
  2118         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  2119         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  2120                     DC-GREG-DATE-1-YMD.
  2121             20  DC-YMD-YEAR           PIC 99.
  2122             20  DC-YMD-MONTH          PIC 99.
  2123             20  DC-YMD-DAY            PIC 99.
  2124         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  2125         16  DC-GREG-DATE-1-MDY-R REDEFINES
  2126                      DC-GREG-DATE-1-MDY.
  2127             20  DC-MDY-MONTH          PIC 99.
  2128             20  DC-MDY-DAY            PIC 99.
  2129             20  DC-MDY-YEAR           PIC 99.
  2130         16  DC-GREG-DATE-1-ALPHA.
  2131             20  DC-ALPHA-MONTH        PIC X(10).
  2132             20  DC-ALPHA-DAY          PIC 99.
  2133             20  FILLER                PIC XX.
  2134             20  DC-ALPHA-CENTURY.
  2135                 24 DC-ALPHA-CEN-N     PIC 99.
  2136             20  DC-ALPHA-YEAR         PIC 99.
  2137         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  2138         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  2139         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  2140         16  DC-JULIAN-DATE            PIC 9(05).
  2141         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  40
* EL6311.cbl
  2142                                       PIC 9(05).
  2143         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  2144             20  DC-JULIAN-YEAR        PIC 99.
  2145             20  DC-JULIAN-DAYS        PIC 999.
  2146         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  2147         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  2148         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  2149     12  DATE-CONVERSION-VARIBLES.
  2150         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  2151         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  2152             20  FILLER                PIC 9(3).
  2153             20  HOLD-CEN-1-CCYY.
  2154                 24  HOLD-CEN-1-CC     PIC 99.
  2155                 24  HOLD-CEN-1-YY     PIC 99.
  2156             20  HOLD-CEN-1-MO         PIC 99.
  2157             20  HOLD-CEN-1-DA         PIC 99.
  2158         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  2159             20  HOLD-CEN-1-R-MO       PIC 99.
  2160             20  HOLD-CEN-1-R-DA       PIC 99.
  2161             20  HOLD-CEN-1-R-CCYY.
  2162                 24  HOLD-CEN-1-R-CC   PIC 99.
  2163                 24  HOLD-CEN-1-R-YY   PIC 99.
  2164             20  FILLER                PIC 9(3).
  2165         16  HOLD-CENTURY-1-X.
  2166             20  FILLER                PIC X(3)  VALUE SPACES.
  2167             20  HOLD-CEN-1-X-CCYY.
  2168                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  2169                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  2170             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  2171             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  2172         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  2173             20  HOLD-CEN-1-R-X-MO     PIC XX.
  2174             20  HOLD-CEN-1-R-X-DA     PIC XX.
  2175             20  HOLD-CEN-1-R-X-CCYY.
  2176                 24  HOLD-CEN-1-R-X-CC PIC XX.
  2177                 24  HOLD-CEN-1-R-X-YY PIC XX.
  2178             20  FILLER                PIC XXX.
  2179         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  2180         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  2181         16  DC-JULIAN-DATE-1          PIC 9(07).
  2182         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  2183             20  DC-JULIAN-1-CCYY.
  2184                 24  DC-JULIAN-1-CC    PIC 99.
  2185                 24  DC-JULIAN-1-YR    PIC 99.
  2186             20  DC-JULIAN-DA-1        PIC 999.
  2187         16  DC-JULIAN-DATE-2          PIC 9(07).
  2188         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  2189             20  DC-JULIAN-2-CCYY.
  2190                 24  DC-JULIAN-2-CC    PIC 99.
  2191                 24  DC-JULIAN-2-YR    PIC 99.
  2192             20  DC-JULIAN-DA-2        PIC 999.
  2193         16  DC-GREG-DATE-A-EDIT.
  2194             20  DC-EDITA-MONTH        PIC 99.
  2195             20  SLASHA-1              PIC X VALUE '/'.
  2196             20  DC-EDITA-DAY          PIC 99.
  2197             20  SLASHA-2              PIC X VALUE '/'.
  2198             20  DC-EDITA-CCYY.
  2199                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  41
* EL6311.cbl
  2200                 24  DC-EDITA-YEAR     PIC 99.
  2201         16  DC-GREG-DATE-B-EDIT.
  2202             20  DC-EDITB-MONTH        PIC 99.
  2203             20  SLASHB-1              PIC X VALUE '/'.
  2204             20  DC-EDITB-DAY          PIC 99.
  2205             20  SLASHB-2              PIC X VALUE '/'.
  2206             20  DC-EDITB-CCYY.
  2207                 24  DC-EDITB-CENT     PIC 99.
  2208                 24  DC-EDITB-YEAR     PIC 99.
  2209         16  DC-GREG-DATE-CYMD         PIC 9(08).
  2210         16  DC-GREG-DATE-CYMD-R REDEFINES
  2211                              DC-GREG-DATE-CYMD.
  2212             20  DC-CYMD-CEN           PIC 99.
  2213             20  DC-CYMD-YEAR          PIC 99.
  2214             20  DC-CYMD-MONTH         PIC 99.
  2215             20  DC-CYMD-DAY           PIC 99.
  2216         16  DC-GREG-DATE-MDCY         PIC 9(08).
  2217         16  DC-GREG-DATE-MDCY-R REDEFINES
  2218                              DC-GREG-DATE-MDCY.
  2219             20  DC-MDCY-MONTH         PIC 99.
  2220             20  DC-MDCY-DAY           PIC 99.
  2221             20  DC-MDCY-CEN           PIC 99.
  2222             20  DC-MDCY-YEAR          PIC 99.
  2223    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  2224        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  2225    12  DC-EL310-DATE                  PIC X(21).
  2226    12  FILLER                         PIC X(28).
  2227
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  42
* EL6311.cbl
  2229*    COPY ELCLOGOF.
  2230******************************************************************
  2231*                                                                *
  2232*                                                                *
  2233*                            ELCLOGOF.                           *
  2234*                            VMOD=2.001                          *
  2235*                                                                *
  2236*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  2237*                                                                *
  2238******************************************************************
  2239 01  CLASIC-LOGOFF.
  2240     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  2241     12  LOGOFF-TEXT.
  2242         16  FILLER          PIC X(5)    VALUE SPACES.
  2243         16  LOGOFF-MSG.
  2244             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  2245             20  FILLER      PIC X       VALUE SPACES.
  2246             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  2247         16  FILLER          PIC X(80)
  2248           VALUE '* YOU ARE NOW LOGGED OFF'.
  2249         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  2250         16  FILLER          PIC X       VALUE QUOTE.
  2251         16  LOGOFF-SYS-MSG  PIC X(17)
  2252           VALUE 'S CLAS-IC SYSTEM '.
  2253     12  TEXT-MESSAGES.
  2254         16  UNACCESS-MSG    PIC X(29)
  2255             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  2256         16  PGMIDERR-MSG    PIC X(17)
  2257             VALUE 'PROGRAM NOT FOUND'.
  2258
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  43
* EL6311.cbl
  2260*    COPY ELCATTR.
  2261******************************************************************
  2262*                                                                *
  2263*                            ELCATTR.                            *
  2264*                            VMOD=2.001                          *
  2265*                                                                *
  2266*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  2267*                                                                *
  2268*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  2269*                                                                *
  2270*                   POS 1   P=PROTECTED                          *
  2271*                           U=UNPROTECTED                        *
  2272*                           S=ASKIP                              *
  2273*                   POS 2   A=ALPHA/NUMERIC                      *
  2274*                           N=NUMERIC                            *
  2275*                   POS 3   N=NORMAL                             *
  2276*                           B=BRIGHT                             *
  2277*                           D=DARK                               *
  2278*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  2279*                           OF=MODIFIED DATA TAG OFF             *
  2280*                                                                *
  2281*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  2282******************************************************************
  2283 01  ATTRIBUTE-LIST.
  2284     12  AL-PABOF            PIC X       VALUE 'Y'.
  2285     12  AL-PABON            PIC X       VALUE 'Z'.
  2286     12  AL-PADOF            PIC X       VALUE '%'.
  2287     12  AL-PADON            PIC X       VALUE '_'.
  2288     12  AL-PANOF            PIC X       VALUE '-'.
  2289     12  AL-PANON            PIC X       VALUE '/'.
  2290     12  AL-SABOF            PIC X       VALUE '8'.
  2291     12  AL-SABON            PIC X       VALUE '9'.
  2292     12  AL-SADOF            PIC X       VALUE '@'.
  2293     12  AL-SADON            PIC X       VALUE QUOTE.
  2294     12  AL-SANOF            PIC X       VALUE '0'.
  2295     12  AL-SANON            PIC X       VALUE '1'.
  2296     12  AL-UABOF            PIC X       VALUE 'H'.
  2297     12  AL-UABON            PIC X       VALUE 'I'.
  2298     12  AL-UADOF            PIC X       VALUE '<'.
  2299     12  AL-UADON            PIC X       VALUE '('.
  2300     12  AL-UANOF            PIC X       VALUE ' '.
  2301     12  AL-UANON            PIC X       VALUE 'A'.
  2302     12  AL-UNBOF            PIC X       VALUE 'Q'.
  2303     12  AL-UNBON            PIC X       VALUE 'R'.
  2304     12  AL-UNDOF            PIC X       VALUE '*'.
  2305     12  AL-UNDON            PIC X       VALUE ')'.
  2306     12  AL-UNNOF            PIC X       VALUE '&'.
  2307     12  AL-UNNON            PIC X       VALUE 'J'.
  2308
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  44
* EL6311.cbl
  2310*    COPY ELCEMIB.
  2311******************************************************************
  2312*                                                                *
  2313*                                                                *
  2314*                            ELCEMIB.                            *
  2315*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2316*                            VMOD=2.005                          *
  2317*                                                                *
  2318*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  2319*                                                                *
  2320******************************************************************
  2321 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  2322     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  2323     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  2324     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  2325     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  2326     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  2327     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  2328     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  2329     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  2330     12  EMI-SWITCH1             PIC X        VALUE '1'.
  2331         88  EMI-NO-ERRORS                    VALUE '1'.
  2332         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  2333         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  2334     12  EMI-SWITCH2             PIC X        VALUE '1'.
  2335         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  2336     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  2337         88  EMI-AREA1-EMPTY                  VALUE '1'.
  2338         88  EMI-AREA1-FULL                   VALUE '2'.
  2339     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  2340         88  EMI-AREA2-EMPTY                  VALUE '1'.
  2341         88  EMI-AREA2-FULL                   VALUE '2'.
  2342     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  2343         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  2344         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  2345         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  2346         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  2347         88  EMI-BYPASS-FATALS                VALUE 'X'.
  2348     12  EMI-ERROR-LINES.
  2349         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  2350         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  2351         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  2352         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  2353             20  EMI-ERR-CODES OCCURS 10 TIMES.
  2354                 24  EMI-ERR-NUM         PIC X(4).
  2355                 24  EMI-FILLER          PIC X.
  2356                 24  EMI-SEV             PIC X.
  2357                 24  FILLER              PIC X.
  2358             20  FILLER                  PIC X(02).
  2359     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  2360         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  2361             20  EMI-ERROR-NUMBER    PIC X(4).
  2362             20  EMI-FILL            PIC X.
  2363             20  EMI-SEVERITY        PIC X.
  2364             20  FILLER              PIC X.
  2365             20  EMI-ERROR-TEXT.
  2366                 24  EMI-TEXT-VARIABLE   PIC X(10).
  2367                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  45
* EL6311.cbl
  2368     12  EMI-SEVERITY-SAVE           PIC X.
  2369         88  EMI-NOTE                    VALUE 'N'.
  2370         88  EMI-WARNING                 VALUE 'W'.
  2371         88  EMI-FORCABLE                VALUE 'F'.
  2372         88  EMI-FATAL                   VALUE 'X'.
  2373     12  EMI-MESSAGE-FLAG            PIC X.
  2374         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  2375         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  2376     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  2377     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  2378         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  2379         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  2380         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  2381     12  emi-claim-no                pic x(7).
  2382     12  emi-claim-type              pic x(6).
  2383     12  FILLER                      PIC X(124)  VALUE SPACES.
  2384     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  2385     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  2386     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  2387     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  2388
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  46
* EL6311.cbl
  2390*    COPY ELCINTF.
  2391******************************************************************
  2392*                                                                *
  2393*                                                                *
  2394*                            ELCINTF.                            *
  2395*                            VMOD=2.017                          *
  2396*                                                                *
  2397*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  2398*                                                                *
  2399*       LENGTH = 1024                                            *
  2400*                                                                *
  2401******************************************************************
  2402*                   C H A N G E   L O G
  2403*
  2404* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2405*-----------------------------------------------------------------
  2406*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2407* EFFECTIVE    NUMBER
  2408*-----------------------------------------------------------------
  2409* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2410******************************************************************
  2411 01  PROGRAM-INTERFACE-BLOCK.
  2412     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  2413     12  PI-CALLING-PROGRAM              PIC X(8).
  2414     12  PI-SAVED-PROGRAM-1              PIC X(8).
  2415     12  PI-SAVED-PROGRAM-2              PIC X(8).
  2416     12  PI-SAVED-PROGRAM-3              PIC X(8).
  2417     12  PI-SAVED-PROGRAM-4              PIC X(8).
  2418     12  PI-SAVED-PROGRAM-5              PIC X(8).
  2419     12  PI-SAVED-PROGRAM-6              PIC X(8).
  2420     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  2421     12  PI-COMPANY-ID                   PIC XXX.
  2422     12  PI-COMPANY-CD                   PIC X.
  2423
  2424     12  PI-COMPANY-PASSWORD             PIC X(8).
  2425
  2426     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  2427
  2428     12  PI-CONTROL-IN-PROGRESS.
  2429         16  PI-CARRIER                  PIC X.
  2430         16  PI-GROUPING                 PIC X(6).
  2431         16  PI-STATE                    PIC XX.
  2432         16  PI-ACCOUNT                  PIC X(10).
  2433         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  2434                                         PIC X(10).
  2435         16  PI-CLAIM-CERT-GRP.
  2436             20  PI-CLAIM-NO             PIC X(7).
  2437             20  PI-CERT-NO.
  2438                 25  PI-CERT-PRIME       PIC X(10).
  2439                 25  PI-CERT-SFX         PIC X.
  2440             20  PI-CERT-EFF-DT          PIC XX.
  2441         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  2442             20  PI-PLAN-CODE            PIC X(2).
  2443             20  PI-REVISION-NUMBER      PIC X(3).
  2444             20  PI-PLAN-EFF-DT          PIC X(2).
  2445             20  PI-PLAN-EXP-DT          PIC X(2).
  2446             20  FILLER                  PIC X(11).
  2447         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  47
* EL6311.cbl
  2448             20  PI-OE-REFERENCE-1.
  2449                 25  PI-OE-REF-1-PRIME   PIC X(18).
  2450                 25  PI-OE-REF-1-SUFF    PIC XX.
  2451
  2452     12  PI-SESSION-IN-PROGRESS          PIC X.
  2453         88  CLAIM-SESSION                   VALUE '1'.
  2454         88  CREDIT-SESSION                  VALUE '2'.
  2455         88  WARRANTY-SESSION                VALUE '3'.
  2456         88  MORTGAGE-SESSION                VALUE '4'.
  2457         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  2458
  2459
  2460*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  2461
  2462     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  2463     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  2464
  2465     12  PI-CREDIT-USER                  PIC X.
  2466         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  2467         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  2468
  2469     12  PI-CLAIM-USER                   PIC X.
  2470         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  2471         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  2472
  2473     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  2474         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  2475         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  2476         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  2477         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  2478         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  2479
  2480     12  PI-PROCESSOR-ID                 PIC X(4).
  2481
  2482     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  2483
  2484     12  PI-MEMBER-CAPTION               PIC X(10).
  2485
  2486     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  2487         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  2488
  2489     12  PI-LIFE-OVERRIDE-L1             PIC X.
  2490     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  2491     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  2492     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  2493
  2494     12  PI-AH-OVERRIDE-L1               PIC X.
  2495     12  PI-AH-OVERRIDE-L2               PIC XX.
  2496     12  PI-AH-OVERRIDE-L6               PIC X(6).
  2497     12  PI-AH-OVERRIDE-L12              PIC X(12).
  2498
  2499     12  PI-NEW-SYSTEM                   PIC X(2).
  2500
  2501     12  PI-PRIMARY-CERT-NO              PIC X(11).
  2502     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  2503         88  PI-USES-PAID-TO                 VALUE '1'.
  2504     12  PI-CRDTCRD-SYSTEM.
  2505         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  48
* EL6311.cbl
  2506             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  2507             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  2508         16  PI-CC-MONTH-END-DT          PIC XX.
  2509     12  PI-PROCESSOR-PRINTER            PIC X(4).
  2510
  2511     12  PI-OE-REFERENCE-2.
  2512         16  PI-OE-REF-2-PRIME           PIC X(10).
  2513         16  PI-OE-REF-2-SUFF            PIC X.
  2514
  2515     12  PI-REM-TRM-CALC-OPTION          PIC X.
  2516
  2517     12  PI-LANGUAGE-TYPE                PIC X.
  2518             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  2519             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  2520             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  2521
  2522     12  PI-POLICY-LINKAGE-IND           PIC X.
  2523         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  2524         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  2525                                                   LOW-VALUES.
  2526
  2527     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  2528     12  PI-CLAIM-PW-SESSION             PIC X(1).
  2529         88  PI-CLAIM-CREDIT                 VALUE '1'.
  2530         88  PI-CLAIM-CONVEN                 VALUE '2'.
  2531
  2532     12  PI-PROCESSOR-CSR-IND            PIC X.
  2533         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  2534         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  2535
  2536     12  FILLER                          PIC X(3).
  2537
  2538     12  PI-SYSTEM-LEVEL                 PIC X(145).
  2539
  2540     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  2541         PI-SYSTEM-LEVEL.
  2542
  2543         16  PI-ENTRY-CODES.
  2544             20  PI-ENTRY-CD-1           PIC X.
  2545             20  PI-ENTRY-CD-2           PIC X.
  2546
  2547         16  PI-RETURN-CODES.
  2548             20  PI-RETURN-CD-1          PIC X.
  2549             20  PI-RETURN-CD-2          PIC X.
  2550
  2551         16  PI-UPDATE-STATUS-SAVE.
  2552             20  PI-UPDATE-BY            PIC X(4).
  2553             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  2554
  2555         16  PI-LOWER-CASE-LETTERS       PIC X.
  2556             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  2557
  2558*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  2559*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  2560*            88  CARRIER-CLM-CNTL            VALUE '2'.
  2561
  2562         16  PI-CERT-ACCESS-CONTROL      PIC X.
  2563             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  49
* EL6311.cbl
  2564             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2565             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  2566             88  ACCNT-CNTL                  VALUE '3'.
  2567             88  CARR-ACCNT-CNTL             VALUE '4'.
  2568
  2569         16  PI-PROCESSOR-CAP-LIST.
  2570             20  PI-SYSTEM-CONTROLS.
  2571                24 PI-SYSTEM-DISPLAY     PIC X.
  2572                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  2573                24 PI-SYSTEM-MODIFY      PIC X.
  2574                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  2575             20  FILLER                  PIC XX.
  2576             20  PI-DISPLAY-CAP          PIC X.
  2577                 88  DISPLAY-CAP             VALUE 'Y'.
  2578             20  PI-MODIFY-CAP           PIC X.
  2579                 88  MODIFY-CAP              VALUE 'Y'.
  2580             20  PI-MSG-AT-LOGON-CAP     PIC X.
  2581                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  2582             20  PI-FORCE-CAP            PIC X.
  2583                 88  FORCE-CAP               VALUE 'Y'.
  2584
  2585         16  PI-PROGRAM-CONTROLS.
  2586             20  PI-PGM-PRINT-OPT        PIC X.
  2587             20  PI-PGM-FORMAT-OPT       PIC X.
  2588             20  PI-PGM-PROCESS-OPT      PIC X.
  2589             20  PI-PGM-TOTALS-OPT       PIC X.
  2590
  2591         16  PI-HELP-INTERFACE.
  2592             20  PI-LAST-ERROR-NO        PIC X(4).
  2593             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  2594
  2595         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  2596             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  2597
  2598         16  PI-CR-CONTROL-IN-PROGRESS.
  2599             20  PI-CR-CARRIER           PIC X.
  2600             20  PI-CR-GROUPING          PIC X(6).
  2601             20  PI-CR-STATE             PIC XX.
  2602             20  PI-CR-ACCOUNT           PIC X(10).
  2603             20  PI-CR-FIN-RESP          PIC X(10).
  2604             20  PI-CR-TYPE              PIC X.
  2605
  2606         16  PI-CR-BATCH-NUMBER          PIC X(6).
  2607
  2608         16  PI-CR-MONTH-END-DT          PIC XX.
  2609
  2610         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  2611             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  2612             88  PI-ZERO-CARRIER             VALUE '1'.
  2613             88  PI-ZERO-GROUPING            VALUE '2'.
  2614             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  2615
  2616         16  PI-CARRIER-SECURITY         PIC X.
  2617             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  2618
  2619         16  PI-ACCOUNT-SECURITY         PIC X(10).
  2620             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  2621             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  50
* EL6311.cbl
  2622
  2623         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  2624             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  2625                                         INDEXED BY PI-ACCESS-NDX
  2626                                         PIC X.
  2627
  2628         16  PI-GA-BILLING-CONTROL       PIC X.
  2629             88  PI-GA-BILLING               VALUE '1'.
  2630
  2631         16  PI-MAIL-PROCESSING          PIC X.
  2632             88  PI-MAIL-YES                 VALUE 'Y'.
  2633
  2634         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  2635
  2636         16  PI-AR-SYSTEM.
  2637             20  PI-AR-PROCESSING-CNTL   PIC X.
  2638                 88  PI-AR-PROCESSING        VALUE 'Y'.
  2639             20  PI-AR-SUMMARY-CODE      PIC X(6).
  2640             20  PI-AR-MONTH-END-DT      PIC XX.
  2641
  2642         16  PI-MP-SYSTEM.
  2643             20  PI-MORTGAGE-USER            PIC X.
  2644                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  2645                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  2646             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  2647                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  2648                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  2649                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  2650                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  2651                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  2652             20  PI-MP-MONTH-END-DT          PIC XX.
  2653             20  PI-MP-REFERENCE-NO.
  2654                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  2655                 24  PI-MP-REFERENCE-SFX     PIC XX.
  2656
  2657         16  PI-LABEL-CONTROL            PIC X(01).
  2658             88  PI-CREATE-LABELS                    VALUE 'Y'.
  2659             88  PI-BYPASS-LABELS                    VALUE 'N'.
  2660
  2661         16  PI-BILL-GROUPING-CODE       PIC X(01).
  2662             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  2663
  2664         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  2665             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  2666             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  2667
  2668         16  FILLER                      PIC X(14).
  2669
  2670     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  2671******************************************************************
  2672
  2673     12  FILLER REDEFINES PI-PROGRAM-WORK-AREA.
  2674*    COPY ELC631PI.
  2675******************************************************************
  2676*                                                                *
  2677*                                                                *
  2678*                            ELC631PI                            *
  2679*                            VMOD=2.012                          *
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  51
* EL6311.cbl
  2680*                                                                *
  2681*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
  2682*    REVIEW AND CORRRECTION SUB-SYSTEM.  ANY CHANGES WILL        *
  2683*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
  2684*                                                                *
  2685*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
  2686*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
  2687*    BETWEEN PROGRAMS.                                           *
  2688*                                                                *
  2689*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
  2690*                                                                *
  2691*               EL631 - EL6311 - EL6312 - EL6313                 *
  2692*                                                                *
  2693******************************************************************
  2694*                   C H A N G E   L O G
  2695*
  2696* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2697*-----------------------------------------------------------------
  2698*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2699* EFFECTIVE    NUMBER
  2700*-----------------------------------------------------------------
  2701* 021414    2003053000001  PEMA  changes for auto chk request
  2702******************************************************************
  2703
  2704         16  PI-631-DATA.
  2705             20  PI-ERPNDB-KEY.
  2706                 24  PI-PB-COMPANY-CD     PIC X.
  2707                 24  PI-PB-ENTRY-BATCH    PIC X(6).
  2708                 24  PI-PB-BATCH-SEQ-NO   PIC S9(4) COMP.
  2709                 24  PI-PB-BATCH-CHG-SEQ-NO PIC S9(4) COMP.
  2710
  2711             20  PI-ERPNDB-ALT-KEY.
  2712                 24  PI-PB-COMPANY-CD-A1  PIC X.
  2713                 24  PI-PB-CARRIER        PIC X.
  2714                 24  PI-PB-GROUPING       PIC X(6).
  2715                 24  PI-PB-STATE          PIC XX.
  2716                 24  PI-PB-ACCOUNT        PIC X(10).
  2717                 24  PI-PB-CERT-EFF-DT    PIC XX.
  2718                 24  PI-PB-CERT-NO.
  2719                     28  PI-PB-CERT-PRIME PIC X(10).
  2720                     28  PI-PB-CERT-SFX   PIC X.
  2721                 24  PI-PB-ALT-CHG-SEQ-NO PIC S9(4) COMP.
  2722                 24  PI-PB-RECORD-TYPE    PIC X.
  2723
  2724             20  PI-ERPNDB-CSR-KEY.
  2725                 24  PI-PB-CSR-COMPANY-CD-A2  PIC X.
  2726                 24  PI-PB-CSR-ID             PIC X(4).
  2727                 24  PI-PB-CSR-ENTRY-BATCH    PIC X(6).
  2728                 24  PI-PB-CSR-BTCH-SEQ-NO    PIC S9(4) COMP.
  2729                 24  PI-PB-CSR-BTCH-CHG-SEQ-NO PIC S9(4) COMP.
  2730
  2731             20  PI-BROWSE-TYPE               PIC X.
  2732                 88  PI-FILE-BROWSE             VALUE ' '.
  2733                 88  PI-PRIMARY-BROWSE          VALUE '1'.
  2734                 88  PI-ALTERNATE-BROWSE        VALUE '2'.
  2735                 88  PI-PRIMARY-WITH-SELECT     VALUE '3'.
  2736                 88  PI-CSR-BROWSE              VALUE '4'.
  2737
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  52
* EL6311.cbl
  2738             20  PI-MAINT-FUNCTION            PIC X.
  2739                 88  PI-ADD-FUNCTION            VALUE 'A'.
  2740                 88  PI-BROWSE-FUNCTION         VALUE 'B'.
  2741                 88  PI-CHANGE-FUNCTION         VALUE 'C'.
  2742                 88  PI-DELETE-FUNCTION         VALUE 'D'.
  2743                 88  PI-SHOW-FUNCTION           VALUE 'S'.
  2744                 88  PI-PF5-FUNCTION            VALUE '5'.
  2745                 88  PI-PF6-FUNCTION            VALUE '6'.
  2746
  2747             20  PI-FILE-SWITCHES.
  2748                 24  PI-ALL-ISSUES-SW         PIC X.
  2749                     88  ALL-ISSUES             VALUE 'Y'.
  2750                 24  PI-ALL-CANCELS-SW        PIC X.
  2751                     88  ALL-CANCELS            VALUE 'Y'.
  2752                 24  PI-ISSUES-IN-ERROR-SW    PIC X.
  2753                     88  ISSUES-IN-ERROR        VALUE 'Y'.
  2754                 24  PI-CANCELS-IN-ERROR-SW   PIC X.
  2755                     88  CANCEL-IN-ERROR        VALUE 'Y'.
  2756                 24  PI-ONLY-BATCH-HEADERS-SW PIC X.
  2757                     88  ONLY-BATCH-HEADERS     VALUE 'Y'.
  2758                 24  PI-ALL-OUT-OF-BAL-SW     PIC X.
  2759                     88  ALL-OUT-OF-BAL         VALUE 'Y'.
  2760                 24  PI-HOLD-REC-SW           PIC X.
  2761                     88  DISPLAY-HOLD-RECORDS   VALUE 'Y'.
  2762                 24  PI-CHANGE-REC-SW         PIC X.
  2763                     88  DISPLAY-CHANGE-RECORDS VALUE 'Y'.
  2764                 24  PI-CHK-REQ-REC-SW        PIC X.
  2765                     88  DISPLAY-CHK-REQ-RECORDS VALUE 'Y'.
  2766                 24  PI-ISSUE-WARNING-SW      PIC X.
  2767                     88  ISSUE-WITH-WARNING     VALUE 'Y'.
  2768                 24  PI-CANCEL-WARNING-SW     PIC X.
  2769                     88  CANCEL-WITH-WARNING    VALUE 'Y'.
  2770             20  PI-DISPLAY-SCREEN-SW         PIC X.
  2771                     88  PI-DISPLAY-SCREEN      VALUE 'Y'.
  2772             20  PI-ORIGINAL-BATCH-SW         PIC X.
  2773                     88  PI-DISPLAY-ORIGINAL-BATCH VALUE 'Y'.
  2774
  2775             20  PI-MAP-NAME                  PIC X(8).
  2776
  2777             20  PI-CURSOR                    PIC S9(4) COMP.
  2778
  2779             20  PI-PREV-ALT-KEY              PIC X(36).
  2780             20  PI-PREV-CSR-KEY              PIC X(15).
  2781             20  PI-PREV-KEY.
  2782                 24  PI-PREV-COMPANY-CD       PIC X.
  2783                 24  PI-PREV-BATCH            PIC X(6).
  2784                 24  PI-PREV-SEQ-NO           PIC S9(4) COMP.
  2785                 24  PI-PREV-CHG-SEQ-NO       PIC S9(4) COMP.
  2786             20  PI-PREV-CONTROL-PRIMARY      PIC X(11).
  2787             20  PI-BROWSE-SW                 PIC X.
  2788                 88  PI-GOOD-BROWSE             VALUE 'Y'.
  2789                 88  PI-NO-PB-RECS-FOUND        VALUE '9'.
  2790             20  PI-SV-CARRIER                PIC X.
  2791             20  PI-SV-GROUPING               PIC X(6).
  2792             20  PI-SV-STATE                  PIC XX.
  2793             20  PI-EDIT-SW                   PIC X.
  2794             20  PI-DISPLAY-SW                PIC XX.
  2795                 88 PI-DISPLAY-LIFE        VALUE 'LF'.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  53
* EL6311.cbl
  2796                 88 PI-DISPLAY-AH          VALUE 'AH'.
  2797             20  PI-CRITERIA-DATA             PIC X(350).
  2798             20  PI-BMODE                     PIC X.
  2799             20  PI-BPMTAMT                   PIC S9(7)V99 COMP-3.
  2800             20  PI-BPMTS                     PIC S999     COMP-3.
  2801             20  PI-BTYPE                     PIC XXX OCCURS 2.
  2802             20  PI-HIGH-SEQ-NO               PIC S9(4) COMP.
  2803             20  PI-CSR-SESSION-SW            PIC X.
  2804                 88  CSR-EDIT-SESSION           VALUE 'Y'.
  2805             20  PI-ERRORS-SW                 PIC X.
  2806                 88  FATAL-ERRORS               VALUE 'X'.
  2807*                88  FATAL-OR-UNFORCED          VALUE 'X'.
  2808             20  pi-unforced-sw               pic x.
  2809                 88  unforced-errors            value 'X'.
  2810             20  FILLER                       PIC X(4).
  2811
  2812        16  pi-6311-fatal-ctr    pic s999 comp-3.
  2813        16  FILLER             PIC X(92).
  2814
  2815 01  W-LETTER-COMMUNICATION-AREAS.
  2816*    COPY ELC1042.
  2817******************************************************************
  2818*                                                                *
  2819*                                                                *
  2820*                           ELC1042                              *
  2821*                            VMOD=2.002                          *
  2822*                                                                *
  2823*    NOTE                                                        *
  2824*        THE WORK AREA IS USED BY EL152, EL1522, EL1042, EL153,  *
  2825*        EM152, EM1522, EL689, EL6892, EL6311, AND EL690.        *
  2826*        THIS COPYBOOK SHOULD NOT BE CHANGED WITHOUT REFERENCE   *
  2827*        TO THESE PROGRAMS.                                      *
  2828*                                                                *
  2829*    NOTE                                                        *
  2830*        THE FILLER AREA AT THE BOTTOM ARE FOR FUTURE EL1042     *
  2831*        USE ONLY!                                               *
  2832*                                                                *
  2833******************************************************************
  2834
  2835         16  PI-1042-WA.
  2836             20  PI-ACTION       PIC  X(01).
  2837                 88 PI-SHOW-MODE           VALUE '1'.
  2838                 88 PI-CLEAR-MODE          VALUE '2'.
  2839                 88 PI-CREATE-MODE         VALUE '3'.
  2840             20  PI-COMM-CONTROL PIC  X(12).
  2841             20  PI-CURRENT-LINE PIC S9(03) COMP-3.
  2842             20  PI-EOF-SW       PIC  X(01).
  2843                 88  PI-FILE-EOF           VALUE 'Y'.
  2844             20  PI-FILETYP      PIC  X(01).
  2845             20  PI-FORM-SQUEEZE-CONTROL
  2846                                 PIC  X(01).
  2847                 88  PI-FORM-SQUEEZE-ON     VALUE 'Y'.
  2848                 88  PI-FORM-SQUEEZE-OFF    VALUE ' '.
  2849             20  PI-LAST-CONTROL PIC  X(12).
  2850             20  PI-TEMP-STOR-ITEMS
  2851                                 PIC S9(04) COMP.
  2852             20  PI-TOTAL-LINES  PIC S9(03) COMP-3.
  2853             20  PI-UPDATE-SW    PIC  9(01).
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  54
* EL6311.cbl
  2854                 88 ANY-UPDATES            VALUE 1.
  2855             20  PI-104-SCREEN-SENT-IND
  2856                                 PIC  X(01).
  2857                 88  PI-104-SCREEN-SENT    VALUE 'Y'.
  2858                 88  PI-104-SCREEN-NOT-SENT VALUE 'N'.
  2859             20  PI-1042-SCREEN-SENT-IND
  2860                                 PIC  X(01).
  2861                 88  PI-1042-SCREEN-SENT    VALUE 'Y'.
  2862                 88  PI-1042-SCREEN-NOT-SENT VALUE 'N'.
  2863             20  PI-1042-ARCHIVE-IND
  2864                                 PIC  X(01).
  2865                 88  PI-1042-ARCHIVE-LETTER VALUE 'Y'.
  2866             20  FILLER          PIC  X(29).
  2867*    COPY ELC689PI.
  2868******************************************************************
  2869*                                                                *
  2870*                            ELC689PI                            *
  2871*                            VMOD=2.003                          *
  2872*                                                                *
  2873*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
  2874*    CREDIT CORRESPONDENCE SUB-SYSTEM.  ANY CHANGES WILL         *
  2875*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
  2876*                                                                *
  2877*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
  2878*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
  2879*    BETWEEN PROGRAMS.                                           *
  2880*                                                                *
  2881*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
  2882*                                                                *
  2883*               EL631 - EL689  - EL6891 - EL6892                 *
  2884*                                                                *
  2885******************************************************************
  2886*                   C H A N G E   L O G
  2887*
  2888* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2889*-----------------------------------------------------------------
  2890*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2891* EFFECTIVE    NUMBER
  2892*-----------------------------------------------------------------
  2893* 081004                   PEMA  CONVERT TO PSUEDO CONVERSATIONAL
  2894* 100705  CR2004072800004  PEMA  ADD LETTERS TO BE RESENT
  2895* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  2896******************************************************************
  2897
  2898
  2899         16  PI-689-WORK-AREA.
  2900             20  PI-689-ALT-PRINTER-ID
  2901                                 PIC  X(04).
  2902             20  PI-689-ARCHIVE-NUMBER
  2903                                 PIC  9(08).
  2904             20  PI-689-ARCHIVE-SW
  2905                                 PIC  X(01).
  2906                 88  PI-689-ARCHIVE-LETTER VALUE 'Y'.
  2907             20  PI-689-DATA-SOURCE
  2908                                 PIC  X(01).
  2909                 88  PI-689-SRC-ACCOUNT        VALUE '1'.
  2910                 88  PI-689-SRC-CERTIFICATE    VALUE '2'.
  2911                 88  PI-689-SRC-COMPENSATION   VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  55
* EL6311.cbl
  2912                 88  PI-689-SRC-PEND-BUSINESS  VALUE '4'.
  2913                 88  PI-689-SRC-CHECKS         VALUE '5'.
  2914             20  PI-689-ERROR-IND
  2915                                 PIC  X(01).
  2916                 88  PI-689-ERR-DETECTED-PREV  VALUE 'Y'.
  2917             20  PI-689-ERROR    PIC  9(04).
  2918                 88  PI-689-NO-ERRORS-DETECTED VALUE 0000.
  2919                 88  PI-689-FATAL-ERROR
  2920                     VALUES 0004 0006 0008 0013 0023 0029 0033
  2921                            0042 0047 0051 0066 0067 0070
  2922                            0168 0169 0174 0175 0176 0177 0179
  2923                            0180 0181 0182 0184 0185 0189 0190
  2924                            0191
  2925                            0215 0279 0280
  2926                            0412 0413 0454
  2927                            0533 0537
  2928                            2055 2114 2208 2209 2216 2232 2369
  2929                            2398 2433 2908 2999
  2930                            3000 3770 3771 3775
  2931                            7250 7365 7367 7368 7369 7370 7371
  2932                            7272 7373 7374 7376 7377 7378 7379
  2933                            7381 7388 7390 7393 7395 7396 7398
  2934                            9095 9096 9281 9298 9299 9320 9327
  2935                            9426 9427.
  2936                 88  PI-689-STOP-ERROR
  2937                     VALUES 0004 0008 0013 0023 0029 0033
  2938                            0042 0047 0066 0067 0070
  2939                            0168 0169 0174 0175 0176 0177
  2940                            0181 0182 0184 0185 0189 0190
  2941                            0279 0280
  2942                            0412 0413 0454
  2943                            2055 2208 2209 2216 2232
  2944                            2398 2999
  2945                            3000 3770 3771 3775
  2946                            7250 7365 7369 7370 7371
  2947                            7272 7373 7374 7376 7377 7378 7379
  2948                            7381 7388 7390 7393 7396 7398
  2949                            9095 9096 9299 9320 9426.
  2950             20  PI-689-FOLLOW-UP-DATE
  2951                                 PIC  X(02).
  2952             20  PI-689-FORM-NUMBER
  2953                                 PIC  X(04).
  2954             20  PI-689-LABEL-SOURCE
  2955                                 PIC X(01).
  2956                 88  PI-689-SOURCE-ACCOUNT  VALUE '1'.
  2957                 88  PI-689-SOURCE-CARRIER  VALUE '2'.
  2958                 88  PI-689-SOURCE-COMPANY  VALUE '3'.
  2959                 88  PI-689-SOURCE-COMP     VALUE '4'.
  2960                 88  PI-689-SOURCE-MAIL     VALUE '5'.
  2961                 88  PI-689-SOURCE-CHECK    VALUE '6'.
  2962                 88  PI-689-SOURCE-VARIABLE VALUE '7'.
  2963             20  PI-689-NUMBER-COPIES
  2964                                 PIC  9(01).
  2965             20  PI-689-NUMBER-LABEL-LINES
  2966                                 PIC  9(01).
  2967             20  PI-689-NUMBER-TEXT-RECORDS
  2968                                 PIC  9(03).
  2969             20  PI-689-PRINT-ORDER-SW
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  56
* EL6311.cbl
  2970                                 PIC  X(01).
  2971                 88  PI-689-PRINT-FIRST     VALUE '1'.
  2972                 88  PI-689-PRINT-SECOND    VALUE '2'.
  2973                 88  PI-689-PRINT-LATER     VALUE '3'.
  2974                 88  PI-689-PRINT-ONLY      VALUE '4'.
  2975             20  PI-689-PRINT-RESTRICTION
  2976                                 PIC  X(01).
  2977                 88  PI-689-VALID-RESTRICT     VALUE 'C' 'F'.
  2978                 88  PI-689-PRT-ONLY-WITH-CNTL VALUE 'C'.
  2979                 88  PI-689-PRT-ONLY-WITH-FORM VALUE 'F'.
  2980             20  PI-689-PRINT-SW PIC  X(01).
  2981                 88  PI-689-PRINT-PERFORMED VALUE '1'.
  2982             20  PI-689-RESEND-DATE-1
  2983                                 PIC  X(02).
  2984             20  PI-689-RESEND-LETR-1
  2985                                 PIC X(4).
  2986             20  PI-689-TEMP-STOR-ID
  2987                                 PIC  X(08).
  2988             20  PI-689-USE-SCREEN-IND
  2989                                 PIC  X(01).
  2990                 88  PI-689-CREATE-NO-SCREENS VALUE '1'.
  2991             20  PI-689-ARCH-POINTER
  2992                                 PIC S9(08) COMP.
  2993                 88  PI-689-GET-ARCH-MAIN     VALUE +0.
  2994             20  PI-689-ARCT-POINTER
  2995                                 PIC S9(08) COMP.
  2996                 88  PI-689-GET-ARCT-MAIN     VALUE +0.
  2997             20  PI-689-VARIABLE-DATA-GRP.
  2998                 24  PI-689-VARIABLE-DATA-1
  2999                                 PIC  X(30).
  3000                 24  PI-689-VARIABLE-DATA-2
  3001                                 PIC  X(30).
  3002                 24  PI-689-VARIABLE-DATA-3
  3003                                 PIC  X(30).
  3004                 24  PI-689-VARIABLE-DATA-4
  3005                                 PIC  X(30).
  3006
  3007         16  PI-689-KEY-DATA-FIELDS.
  3008             20  PI-689-ACCOUNT  PIC  X(10).
  3009             20  PI-689-CARRIER  PIC  X(01).
  3010             20  PI-689-CERT-NO.
  3011                 24  PI-689-CERT-PRIME
  3012                                 PIC  X(10).
  3013                 24  PI-689-CERT-SFX
  3014                                 PIC  X(01).
  3015             20  PI-689-CHG-SEQ-NO
  3016                                 PIC S9(04)    COMP.
  3017             20  PI-689-CHG-SEQ-NOX REDEFINES PI-689-CHG-SEQ-NO
  3018                                 PIC  X(02).
  3019             20  PI-689-ENTRY-BATCH
  3020                                 PIC  X(06).
  3021             20  PI-689-EFF-DATE PIC  X(02).
  3022             20  PI-689-EXP-DATE PIC  X(02).
  3023             20  PI-689-GROUPING PIC  X(06).
  3024             20  PI-689-RESP-PERSON
  3025                                 PIC  X(10).
  3026             20  PI-689-SEQ-NO   PIC S9(08)    COMP.
  3027             20  PI-689-SEQ-NOX REDEFINES PI-689-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  57
* EL6311.cbl
  3028                                 PIC  X(04).
  3029             20  PI-689-STATE    PIC  X(02).
  3030             20  PI-689-TYPE     PIC  X(01).
  3031             20  PI-689-CONTROL  PIC S9(08)    COMP.
  3032             20  PI-689-ALT-SEQ-NO
  3033                                 PIC S9(04)    COMP.
  3034         16  PI-689-DATE-EDIT    PIC  X(08).
  3035         16  PI-689-FOLLOW-UP-EDIT
  3036                                 PIC  X(08).
  3037         16  PI-689-RESEND1-EDIT PIC  X(08).
  3038         16  PI-689-SEQ-EDIT     PIC  X(08).
  3039         16  PI-689-BCSEQ-EDIT   PIC  X(04).
  3040         16  PI-689-LBL-OVERRIDE PIC  X(01).
  3041             88  PI-689-LABELS-OVERRIDEN  VALUES 'N'.
  3042         16  PI-689-FATAL-CTR    PIC 999     COMP-3.
  3043         16  PI-689-FORCABLE-CTR PIC 999     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  58
* EL6311.cbl
  3045
  3046 01  WS-EL6315-PASS-AREA.
  3047        16  PI-6315-ISS-CAN-SW      PIC X.
  3048        16  FILLER                  PIC X(120).
  3049        16  PI-RES-REF-CLM-TYPE     PIC X.
  3050        16  FILLER                  PIC X.
  3051        16  PI-6315-PASS-AREA.
  3052            20 FILLER               PIC X(236).
  3053            20 PI-6315-FINALIZED    PIC X.
  3054            20 FILLER               PIC X(280).
  3055
  3056 01  WS-EL6316-PASS-AREA.
  3057        16  PI-ISS-CAN-SW           PIC X.
  3058        16  FILLER                  PIC X(121).
  3059        16  PI-CLM-RESC-IND         PIC X.
  3060        16  PI-6316-PASS-AREA.
  3061            20 FILLER               PIC X(236).
  3062            20 PI-6316-FINALIZED    PIC X.
  3063            20 FILLER               PIC X(280).
  3064
  3065******************************************************************
  3066*                                                                *
  3067*         P A S S   A R E A   F O R   E D I T                    *
  3068*                                                                *
  3069******************************************************************
  3070
  3071 01  PASSED-RECORD.
  3072     12  RECORD-SAVE                  PIC X(585).
  3073* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
  3074*    COPY ELC50W1 REPLACING WK-CANCEL-EXIT-DT
  3075*                    BY  WK-CURRENT-DATE.
  3076******************************************************************
  3077*                                                                *
  3078*                                                                *
  3079*                             ELC50W1                            *
  3080*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3081*                            VMOD=2.004                          *
  3082*                                                                *
  3083*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *
  3084*                                                                *
  3085*                                                                *
  3086******************************************************************
  3087
  3088     12  WK-WORK-AREA.
  3089         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.
  3090         16  WK-LAST-CARRIER          PIC X   VALUE ' '.
  3091         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.
  3092         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.
  3093         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.
  3094         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.
  3095         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.
  3096         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.
  3097         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.
  3098         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.
  3099         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.
  3100         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.
  3101         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.
  3102         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  59
* EL6311.cbl
  3103         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE.
  3104         16  WK-CREDIT-EDIT-CONTROLS.
  3105             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.
  3106             20  WK-MIN-AGE           PIC 99  VALUE 00.
  3107             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.
  3108             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  3109             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  3110             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.
  3111         16  WK-CURRENT-DATE        PIC XX VALUE LOW-VALUE.
  3112         16  WK-SAVE-REIN-DATA.
  3113             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.
  3114             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.
  3115             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.
  3116         16  WK-ENTRY-SW              PIC X    VALUE ' '.
  3117             88  ENTRY-FROM-EL6311       VALUE '6'.
  3118         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.
  3119         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.
  3120     12  WK-RECORD-ADDRESSES.
  3121         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS.
  3122         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS.
  3123         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS.
  3124         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS.
  3125         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS.
  3126         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS.
  3127         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS.
  3128         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS.
  3129     12  WK-OVER-SHORT-AREA.
  3130         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.
  3131         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.
  3132         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  3133             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  3134         16  FILLER                   PIC X(5) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  60
* EL6311.cbl
  3136
  3137*    COPY ELCEDITC.
  3138******************************************************************
  3139*                                                                *
  3140*                                                                *
  3141*                            ELCEDITC                            *
  3142*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3143*                            VMOD=2.012                          *
  3144*                                                                *
  3145*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *
  3146*                     EL6313, EL050 AND EL517.                   *
  3147*                                                                *
  3148******************************************************************
  3149******************************************************************
  3150*                   C H A N G E   L O G
  3151*
  3152* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3153*-----------------------------------------------------------------
  3154*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3155* EFFECTIVE    NUMBER
  3156*-----------------------------------------------------------------
  3157* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3158******************************************************************
  3159
  3160     12  EDIT-CRITERIA-DATA.
  3161         16  EC-CO-MONTH-END-DT       PIC XX.
  3162         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.
  3163         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  3164         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.
  3165         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  3166         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.
  3167         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.
  3168         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.
  3169         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.
  3170         16  EC-CO-REM-TERM-CALC      PIC X.
  3171               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.
  3172               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.
  3173               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.
  3174               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.
  3175
  3176         16  EC-BR-LF-EARNINGS-CALC    PIC X.
  3177               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.
  3178               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.
  3179               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.
  3180               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.
  3181               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.
  3182               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.
  3183               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.
  3184               88  EC-BR-LF-EARN-MEAN               VALUE '8'.
  3185               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.
  3186               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.
  3187
  3188         16  EC-BR-AH-EARNINGS-CALC    PIC X.
  3189               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.
  3190               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.
  3191               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.
  3192               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.
  3193               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  61
* EL6311.cbl
  3194               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.
  3195               88  EC-BR-AH-EARN-MEAN               VALUE '8'.
  3196               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.
  3197
  3198         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.
  3199                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.
  3200                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.
  3201
  3202         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.
  3203                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.
  3204                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.
  3205                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.
  3206                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.
  3207                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.
  3208                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.
  3209                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.
  3210                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.
  3211
  3212         16  EC-BR-LF-COVERAGE-TYPE    PIC X.
  3213               88  EC-BR-REDUCING                   VALUE 'R'.
  3214               88  EC-BR-LEVEL                      VALUE 'L' 'P'.
  3215
  3216         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).
  3217         16  EC-BR-LF-DESC             PIC X(10).
  3218         16  EC-BR-AH-DESC             PIC X(10).
  3219         16  EC-BR-LF-COMMENT          PIC X(10).
  3220         16  EC-BR-AH-COMMENT          PIC X(10).
  3221
  3222         16  EC-BR-LF-REM-TERM-CALC    PIC X.
  3223               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.
  3224               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.
  3225               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.
  3226               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.
  3227
  3228         16  EC-BR-AH-REM-TERM-CALC    PIC X.
  3229               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.
  3230               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.
  3231               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.
  3232               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.
  3233
  3234         16  EC-BR-LF-REFUND-CALC      PIC X.
  3235                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.
  3236                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.
  3237                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.
  3238                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.
  3239                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.
  3240                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.
  3241                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  3242
  3243         16  EC-BR-AH-REFUND-CALC      PIC X.
  3244                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.
  3245                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.
  3246                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.
  3247                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.
  3248                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.
  3249                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.
  3250                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.
  3251                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  62
* EL6311.cbl
  3252
  3253         16  EC-BR-LF-BEN-I-G-CD       PIC X.
  3254                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.
  3255                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.
  3256                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.
  3257
  3258         16  EC-BR-AH-BEN-I-G-CD       PIC X.
  3259                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.
  3260                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.
  3261                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.
  3262
  3263         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.
  3264         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.
  3265         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  3266         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  3267
  3268         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.
  3269         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.
  3270                 88  EC-ST-EXT-NO-CHG               VALUE ' '.
  3271                 88  EC-ST-EXT-CHG-LF               VALUE '1'.
  3272                 88  EC-ST-EXT-CHG-AH               VALUE '2'.
  3273                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.
  3274
  3275         16  EC-ST-LF-REM-TERM-CALC    PIC X.
  3276               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.
  3277               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.
  3278               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.
  3279               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.
  3280               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.
  3281
  3282         16  EC-ST-AH-REM-TERM-CALC    PIC X.
  3283               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.
  3284               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.
  3285               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.
  3286               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.
  3287               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.
  3288
  3289         16  EC-ST-LF-REFUND-CALC      PIC X.
  3290                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.
  3291                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.
  3292                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.
  3293                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.
  3294                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.
  3295                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.
  3296                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.
  3297                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  3298
  3299         16  EC-ST-AH-REFUND-CALC      PIC X.
  3300                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.
  3301                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.
  3302                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.
  3303                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.
  3304                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.
  3305                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.
  3306                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.
  3307                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  3308
  3309         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  63
* EL6311.cbl
  3310         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.
  3311         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.
  3312         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.
  3313         16  EC-AM-EXPIRATION-DT       PIC XX.
  3314         16  EC-AM-EFFECTIVE-DT        PIC XX.
  3315         16  EC-AM-CLASS-CD            PIC XX.
  3316         16  EC-AM-LF-DEVIATION        PIC XXX.
  3317         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  3318         16  EC-AM-AH-DEVIATION        PIC XXX.
  3319         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  3320         16  EC-AM-PHONE-NO            PIC X(10).
  3321
  3322         16  EC-AM-LF-REFUND-CALC      PIC X.
  3323                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.
  3324                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.
  3325                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.
  3326                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.
  3327                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.
  3328                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.
  3329                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  3330
  3331         16  EC-AM-AH-REFUND-CALC      PIC X.
  3332                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.
  3333                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.
  3334                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.
  3335                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.
  3336                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.
  3337                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.
  3338                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  3339
  3340         16  EC-AM-BEN-I-G-CD          PIC X.
  3341                 88  WK-AM-I-G-NOT-USED             VALUE ' '.
  3342                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.
  3343                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.
  3344
  3345         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3346         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.
  3347         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.
  3348         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3349         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3350         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.
  3351         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.
  3352         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  3353         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3354
  3355         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3356         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.
  3357         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.
  3358         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3359         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3360         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.
  3361         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.
  3362         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  3363         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3364         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.
  3365         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.
  3366         16  EC-RT-LF-NSP-ST           PIC XX.
  3367         16  EC-RT-AH-NSP-ST           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  64
* EL6311.cbl
  3368         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  3369         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  3370
  3371         16  EC-CM-LF-PRIOR-STATUS     PIC X.
  3372             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  3373                                             'M' '5' '9' '2'.
  3374             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.
  3375             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.
  3376             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.
  3377             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.
  3378             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.
  3379             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.
  3380             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.
  3381             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.
  3382             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.
  3383             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.
  3384
  3385         16  EC-CM-AH-PRIOR-STATUS     PIC X.
  3386             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  3387                                             'M' '5' '9' '2'.
  3388             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.
  3389             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.
  3390             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.
  3391             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.
  3392             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.
  3393             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.
  3394             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.
  3395             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.
  3396             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.
  3397             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.
  3398
  3399         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  3400         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  3401         16  EC-CM-LF-CANCEL-DT        PIC XX.
  3402         16  EC-CM-AH-CANCEL-DT        PIC XX.
  3403         16  EC-CM-DEATH-DT            PIC XX.
  3404
  3405*DMD CUSTOM CODING FIELDS BELOW
  3406*POPULATED BY CF-RATING-SWITCH AT EL050 TIME
  3407         16  EC-BR-DMD-RATING-SW       PIC X.
  3408                 88  EC-DMD-AH-RATING            VALUE 'Y'.
  3409                 88  EC-DMD-LF-RATING            VALUE 'Y'.
  3410                 88  NO-DMD-RATING               VALUE 'N'.
  3411
  3412         16  EC-NEW-CERT               PIC X(11).
  3413         16  EC-NEW-STATE              PIC XX.
  3414         16  FILLER                    PIC X.
  3415*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.
  3416         16  OVER-SHORT-EDIT-FIELDS.
  3417             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.
  3418             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  3419             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.
  3420             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  3421             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.
  3422             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.
  3423             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  3424             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.
  3425             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  65
* EL6311.cbl
  3426         16  FILLER                    PIC X(71).
  3427
  3428******************************************************************
  3429
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  66
* EL6311.cbl
  3431
  3432*    COPY ELCJPFX.
  3433******************************************************************
  3434*                                                                *
  3435*                                                                *
  3436*                            ELCJPFX.                            *
  3437*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3438*                            VMOD=2.002                          *
  3439*                                                                *
  3440*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  3441*                                                                *
  3442*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  3443*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  3444*        ELCNTL - CONTROL FILE                                   *
  3445*        ELMSTR - CLAIM MASTERS                                  *
  3446*        ELTRLR - ACTIVITY TRAILERS                              *
  3447*        ELCHKQ - CHECK QUE                                      *
  3448******************************************************************
  3449 01  JOURNAL-RECORD.
  3450     12  jp-date                     pic s9(5) comp-3.
  3451     12  jp-time                     pic s9(7) comp-3.
  3452     12  JP-USER-ID                  PIC X(4).
  3453     12  JP-FILE-ID                  PIC X(8).
  3454     12  JP-PROGRAM-ID               PIC X(8).
  3455     12  JP-RECORD-TYPE              PIC X.
  3456         88 JP-ADD              VALUE 'A'.
  3457         88 JP-BEFORE-CHANGE    VALUE 'B'.
  3458         88 JP-AFTER-CHANGE     VALUE 'C'.
  3459         88 JP-DELETE           VALUE 'D'.
  3460         88 JP-GENERIC-DELETE   VALUE 'G'.
  3461         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  3462         88 JP-KEY-CHG-ADD      VALUE 'N'.
  3463     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  3464     12  JP-RECORD-AREA
  3465
  3466
  3467                             PIC X(825).
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  67
* EL6311.cbl
  3469*    COPY ELCAID.
  3470******************************************************************
  3471*                                                                *
  3472*                            ELCAID.                             *
  3473*                            VMOD=2.001                          *
  3474*                                                                *
  3475*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  3476*                                                                *
  3477*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  3478*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  3479******************************************************************
  3480
  3481 01  DFHAID.
  3482   02  DFHNULL   PIC  X  VALUE  ' '.
  3483   02  DFHENTER  PIC  X  VALUE  QUOTE.
  3484   02  DFHCLEAR  PIC  X  VALUE  '_'.
  3485   02  DFHPEN    PIC  X  VALUE  '='.
  3486   02  DFHOPID   PIC  X  VALUE  'W'.
  3487   02  DFHPA1    PIC  X  VALUE  '%'.
  3488   02  DFHPA2    PIC  X  VALUE  '>'.
  3489   02  DFHPA3    PIC  X  VALUE  ','.
  3490   02  DFHPF1    PIC  X  VALUE  '1'.
  3491   02  DFHPF2    PIC  X  VALUE  '2'.
  3492   02  DFHPF3    PIC  X  VALUE  '3'.
  3493   02  DFHPF4    PIC  X  VALUE  '4'.
  3494   02  DFHPF5    PIC  X  VALUE  '5'.
  3495   02  DFHPF6    PIC  X  VALUE  '6'.
  3496   02  DFHPF7    PIC  X  VALUE  '7'.
  3497   02  DFHPF8    PIC  X  VALUE  '8'.
  3498   02  DFHPF9    PIC  X  VALUE  '9'.
  3499   02  DFHPF10   PIC  X  VALUE  ':'.
  3500   02  DFHPF11   PIC  X  VALUE  '#'.
  3501   02  DFHPF12   PIC  X  VALUE  '@'.
  3502   02  DFHPF13   PIC  X  VALUE  'A'.
  3503   02  DFHPF14   PIC  X  VALUE  'B'.
  3504   02  DFHPF15   PIC  X  VALUE  'C'.
  3505   02  DFHPF16   PIC  X  VALUE  'D'.
  3506   02  DFHPF17   PIC  X  VALUE  'E'.
  3507   02  DFHPF18   PIC  X  VALUE  'F'.
  3508   02  DFHPF19   PIC  X  VALUE  'G'.
  3509   02  DFHPF20   PIC  X  VALUE  'H'.
  3510   02  DFHPF21   PIC  X  VALUE  'I'.
  3511*00039    02  DFHPF22   PIC  X  VALUE  ''.
  3512   02  DFHPF22   PIC  X  VALUE  '['.
  3513   02  DFHPF23   PIC  X  VALUE  '.'.
  3514   02  DFHPF24   PIC  X  VALUE  '<'.
  3515   02  DFHMSRE   PIC  X  VALUE  'X'.
  3516   02  DFHSTRF   PIC  X  VALUE  'h'.
  3517   02  DFHTRIG   PIC  X  VALUE  '"'.
  3518
  3519 01  FILLER    REDEFINES DFHAID.
  3520     12  FILLER              PIC X(8).
  3521     12  PF-VALUES           PIC X       OCCURS 24 TIMES.
  3522
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  68
* EL6311.cbl
  3524*    COPY EL6311S.
  3525 01  EL631BI.
  3526     05  FILLER            PIC  X(0012).
  3527*    -------------------------------
  3528     05  BDATEL PIC S9(0004) COMP.
  3529     05  BDATEF PIC  X(0001).
  3530     05  FILLER REDEFINES BDATEF.
  3531         10  BDATEA PIC  X(0001).
  3532     05  BDATEI PIC  X(0008).
  3533*    -------------------------------
  3534     05  BTIMEL PIC S9(0004) COMP.
  3535     05  BTIMEF PIC  X(0001).
  3536     05  FILLER REDEFINES BTIMEF.
  3537         10  BTIMEA PIC  X(0001).
  3538     05  BTIMEI PIC  X(0005).
  3539*    -------------------------------
  3540     05  BHEADL PIC S9(0004) COMP.
  3541     05  BHEADF PIC  X(0001).
  3542     05  FILLER REDEFINES BHEADF.
  3543         10  BHEADA PIC  X(0001).
  3544     05  BHEADI PIC  X(0038).
  3545*    -------------------------------
  3546     05  BNCERTLL PIC S9(0004) COMP.
  3547     05  BNCERTLF PIC  X(0001).
  3548     05  FILLER REDEFINES BNCERTLF.
  3549         10  BNCERTLA PIC  X(0001).
  3550     05  BNCERTLI PIC  X(0008).
  3551*    -------------------------------
  3552     05  BNCERTL PIC S9(0004) COMP.
  3553     05  BNCERTF PIC  X(0001).
  3554     05  FILLER REDEFINES BNCERTF.
  3555         10  BNCERTA PIC  X(0001).
  3556     05  BNCERTI PIC  X(0011).
  3557*    -------------------------------
  3558     05  BNSTATLL PIC S9(0004) COMP.
  3559     05  BNSTATLF PIC  X(0001).
  3560     05  FILLER REDEFINES BNSTATLF.
  3561         10  BNSTATLA PIC  X(0001).
  3562     05  BNSTATLI PIC  X(0009).
  3563*    -------------------------------
  3564     05  BNSTATL PIC S9(0004) COMP.
  3565     05  BNSTATF PIC  X(0001).
  3566     05  FILLER REDEFINES BNSTATF.
  3567         10  BNSTATA PIC  X(0001).
  3568     05  BNSTATI PIC  X(0002).
  3569*    -------------------------------
  3570     05  BCHGTL PIC S9(0004) COMP.
  3571     05  BCHGTF PIC  X(0001).
  3572     05  FILLER REDEFINES BCHGTF.
  3573         10  BCHGTA PIC  X(0001).
  3574     05  BCHGTI PIC  X(0004).
  3575*    -------------------------------
  3576     05  BCHGL PIC S9(0004) COMP.
  3577     05  BCHGF PIC  X(0001).
  3578     05  FILLER REDEFINES BCHGF.
  3579         10  BCHGA PIC  X(0001).
  3580     05  BCHGI PIC  X(0004).
  3581*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  69
* EL6311.cbl
  3582     05  BCOMPIDL PIC S9(0004) COMP.
  3583     05  BCOMPIDF PIC  X(0001).
  3584     05  FILLER REDEFINES BCOMPIDF.
  3585         10  BCOMPIDA PIC  X(0001).
  3586     05  BCOMPIDI PIC  X(0003).
  3587*    -------------------------------
  3588     05  BREGIONL PIC S9(0004) COMP.
  3589     05  BREGIONF PIC  X(0001).
  3590     05  FILLER REDEFINES BREGIONF.
  3591         10  BREGIONA PIC  X(0001).
  3592     05  BREGIONI PIC  X(0006).
  3593*    -------------------------------
  3594     05  BUSERL PIC S9(0004) COMP.
  3595     05  BUSERF PIC  X(0001).
  3596     05  FILLER REDEFINES BUSERF.
  3597         10  BUSERA PIC  X(0001).
  3598     05  BUSERI PIC  X(0004).
  3599*    -------------------------------
  3600     05  BMAINTL PIC S9(0004) COMP.
  3601     05  BMAINTF PIC  X(0001).
  3602     05  FILLER REDEFINES BMAINTF.
  3603         10  BMAINTA PIC  X(0001).
  3604     05  BMAINTI PIC  X(0001).
  3605*    -------------------------------
  3606     05  BMANTBYL PIC S9(0004) COMP.
  3607     05  BMANTBYF PIC  X(0001).
  3608     05  FILLER REDEFINES BMANTBYF.
  3609         10  BMANTBYA PIC  X(0001).
  3610     05  BMANTBYI PIC  X(0004).
  3611*    -------------------------------
  3612     05  BCHGHDGL PIC S9(0004) COMP.
  3613     05  BCHGHDGF PIC  X(0001).
  3614     05  FILLER REDEFINES BCHGHDGF.
  3615         10  BCHGHDGA PIC  X(0001).
  3616     05  BCHGHDGI PIC  X(0003).
  3617*    -------------------------------
  3618     05  BMANTDTL PIC S9(0004) COMP.
  3619     05  BMANTDTF PIC  X(0001).
  3620     05  FILLER REDEFINES BMANTDTF.
  3621         10  BMANTDTA PIC  X(0001).
  3622     05  BMANTDTI PIC  X(0008).
  3623*    -------------------------------
  3624     05  BMANTATL PIC S9(0004) COMP.
  3625     05  BMANTATF PIC  X(0001).
  3626     05  FILLER REDEFINES BMANTATF.
  3627         10  BMANTATA PIC  X(0001).
  3628     05  BMANTATI PIC  X(0005).
  3629*    -------------------------------
  3630     05  BCSRL PIC S9(0004) COMP.
  3631     05  BCSRF PIC  X(0001).
  3632     05  FILLER REDEFINES BCSRF.
  3633         10  BCSRA PIC  X(0001).
  3634     05  BCSRI PIC  X(0004).
  3635*    -------------------------------
  3636     05  BBATCHL PIC S9(0004) COMP.
  3637     05  BBATCHF PIC  X(0001).
  3638     05  FILLER REDEFINES BBATCHF.
  3639         10  BBATCHA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  70
* EL6311.cbl
  3640     05  BBATCHI PIC  X(0006).
  3641*    -------------------------------
  3642     05  BSEQL PIC S9(0004) COMP.
  3643     05  BSEQF PIC  X(0001).
  3644     05  FILLER REDEFINES BSEQF.
  3645         10  BSEQA PIC  X(0001).
  3646     05  BSEQI PIC  X(0004).
  3647*    -------------------------------
  3648     05  BMOENDTL PIC S9(0004) COMP.
  3649     05  BMOENDTF PIC  X(0001).
  3650     05  FILLER REDEFINES BMOENDTF.
  3651         10  BMOENDTA PIC  X(0001).
  3652     05  BMOENDTI PIC  X(0008).
  3653*    -------------------------------
  3654     05  BCARRL PIC S9(0004) COMP.
  3655     05  BCARRF PIC  X(0001).
  3656     05  FILLER REDEFINES BCARRF.
  3657         10  BCARRA PIC  X(0001).
  3658     05  BCARRI PIC  X(0001).
  3659*    -------------------------------
  3660     05  BGROUPL PIC S9(0004) COMP.
  3661     05  BGROUPF PIC  X(0001).
  3662     05  FILLER REDEFINES BGROUPF.
  3663         10  BGROUPA PIC  X(0001).
  3664     05  BGROUPI PIC  X(0006).
  3665*    -------------------------------
  3666     05  BSTATEL PIC S9(0004) COMP.
  3667     05  BSTATEF PIC  X(0001).
  3668     05  FILLER REDEFINES BSTATEF.
  3669         10  BSTATEA PIC  X(0001).
  3670     05  BSTATEI PIC  X(0002).
  3671*    -------------------------------
  3672     05  BACCTL PIC S9(0004) COMP.
  3673     05  BACCTF PIC  X(0001).
  3674     05  FILLER REDEFINES BACCTF.
  3675         10  BACCTA PIC  X(0001).
  3676     05  BACCTI PIC  X(0010).
  3677*    -------------------------------
  3678     05  BVINHL PIC S9(0004) COMP.
  3679     05  BVINHF PIC  X(0001).
  3680     05  FILLER REDEFINES BVINHF.
  3681         10  BVINHA PIC  X(0001).
  3682     05  BVINHI PIC  X(0004).
  3683*    -------------------------------
  3684     05  BVINL PIC S9(0004) COMP.
  3685     05  BVINF PIC  X(0001).
  3686     05  FILLER REDEFINES BVINF.
  3687         10  BVINA PIC  X(0001).
  3688     05  BVINI PIC  X(0017).
  3689*    -------------------------------
  3690     05  BREFHDGL PIC S9(0004) COMP.
  3691     05  BREFHDGF PIC  X(0001).
  3692     05  FILLER REDEFINES BREFHDGF.
  3693         10  BREFHDGA PIC  X(0001).
  3694     05  BREFHDGI PIC  X(0004).
  3695*    -------------------------------
  3696     05  BREFL PIC S9(0004) COMP.
  3697     05  BREFF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  71
* EL6311.cbl
  3698     05  FILLER REDEFINES BREFF.
  3699         10  BREFA PIC  X(0001).
  3700     05  BREFI PIC  X(0012).
  3701*    -------------------------------
  3702     05  LETRREQL PIC S9(0004) COMP.
  3703     05  LETRREQF PIC  X(0001).
  3704     05  FILLER REDEFINES LETRREQF.
  3705         10  LETRREQA PIC  X(0001).
  3706     05  LETRREQI PIC  X(0001).
  3707*    -------------------------------
  3708     05  BAGEDEFL PIC S9(0004) COMP.
  3709     05  BAGEDEFF PIC  X(0001).
  3710     05  FILLER REDEFINES BAGEDEFF.
  3711         10  BAGEDEFA PIC  X(0001).
  3712     05  BAGEDEFI PIC  X(0004).
  3713*    -------------------------------
  3714     05  BCERTNOL PIC S9(0004) COMP.
  3715     05  BCERTNOF PIC  X(0001).
  3716     05  FILLER REDEFINES BCERTNOF.
  3717         10  BCERTNOA PIC  X(0001).
  3718     05  BCERTNOI PIC  X(0010).
  3719*    -------------------------------
  3720     05  BSUFIXL PIC S9(0004) COMP.
  3721     05  BSUFIXF PIC  X(0001).
  3722     05  FILLER REDEFINES BSUFIXF.
  3723         10  BSUFIXA PIC  X(0001).
  3724     05  BSUFIXI PIC  X(0001).
  3725*    -------------------------------
  3726     05  BEFFDTL PIC S9(0004) COMP.
  3727     05  BEFFDTF PIC  X(0001).
  3728     05  FILLER REDEFINES BEFFDTF.
  3729         10  BEFFDTA PIC  X(0001).
  3730     05  BEFFDTI PIC  X(0008).
  3731*    -------------------------------
  3732     05  BLSTNML PIC S9(0004) COMP.
  3733     05  BLSTNMF PIC  X(0001).
  3734     05  FILLER REDEFINES BLSTNMF.
  3735         10  BLSTNMA PIC  X(0001).
  3736     05  BLSTNMI PIC  X(0015).
  3737*    -------------------------------
  3738     05  B1STNML PIC S9(0004) COMP.
  3739     05  B1STNMF PIC  X(0001).
  3740     05  FILLER REDEFINES B1STNMF.
  3741         10  B1STNMA PIC  X(0001).
  3742     05  B1STNMI PIC  X(0010).
  3743*    -------------------------------
  3744     05  BINITL PIC S9(0004) COMP.
  3745     05  BINITF PIC  X(0001).
  3746     05  FILLER REDEFINES BINITF.
  3747         10  BINITA PIC  X(0001).
  3748     05  BINITI PIC  X(0001).
  3749*    -------------------------------
  3750     05  BSEXL PIC S9(0004) COMP.
  3751     05  BSEXF PIC  X(0001).
  3752     05  FILLER REDEFINES BSEXF.
  3753         10  BSEXA PIC  X(0001).
  3754     05  BSEXI PIC  X(0001).
  3755*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  72
* EL6311.cbl
  3756     05  BAGEL PIC S9(0004) COMP.
  3757     05  BAGEF PIC  X(0001).
  3758     05  FILLER REDEFINES BAGEF.
  3759         10  BAGEA PIC  X(0001).
  3760     05  BAGEI PIC  X(0002).
  3761*    -------------------------------
  3762     05  BBIRTHL PIC S9(0004) COMP.
  3763     05  BBIRTHF PIC  X(0001).
  3764     05  FILLER REDEFINES BBIRTHF.
  3765         10  BBIRTHA PIC  X(0001).
  3766     05  BBIRTHI PIC  X(0008).
  3767*    -------------------------------
  3768     05  B1STPMTL PIC S9(0004) COMP.
  3769     05  B1STPMTF PIC  X(0001).
  3770     05  FILLER REDEFINES B1STPMTF.
  3771         10  B1STPMTA PIC  X(0001).
  3772     05  B1STPMTI PIC  X(0008).
  3773*    -------------------------------
  3774     05  BDAYSL PIC S9(0004) COMP.
  3775     05  BDAYSF PIC  X(0001).
  3776     05  FILLER REDEFINES BDAYSF.
  3777         10  BDAYSA PIC  X(0001).
  3778     05  BDAYSI PIC  X(0003).
  3779*    -------------------------------
  3780     05  BLNTRML PIC S9(0004) COMP.
  3781     05  BLNTRMF PIC  X(0001).
  3782     05  FILLER REDEFINES BLNTRMF.
  3783         10  BLNTRMA PIC  X(0001).
  3784     05  BLNTRMI PIC  X(0003).
  3785*    -------------------------------
  3786     05  BLNOFCRL PIC S9(0004) COMP.
  3787     05  BLNOFCRF PIC  X(0001).
  3788     05  FILLER REDEFINES BLNOFCRF.
  3789         10  BLNOFCRA PIC  X(0001).
  3790     05  BLNOFCRI PIC  X(0005).
  3791*    -------------------------------
  3792     05  BMODEL PIC S9(0004) COMP.
  3793     05  BMODEF PIC  X(0001).
  3794     05  FILLER REDEFINES BMODEF.
  3795         10  BMODEA PIC  X(0001).
  3796     05  BMODEI PIC  X(0001).
  3797*    -------------------------------
  3798     05  BFREQL PIC S9(0004) COMP.
  3799     05  BFREQF PIC  X(0001).
  3800     05  FILLER REDEFINES BFREQF.
  3801         10  BFREQA PIC  X(0001).
  3802     05  BFREQI PIC  X(0002).
  3803*    -------------------------------
  3804     05  BPMTSL PIC S9(0004) COMP.
  3805     05  BPMTSF PIC  X(0001).
  3806     05  FILLER REDEFINES BPMTSF.
  3807         10  BPMTSA PIC  X(0001).
  3808     05  BPMTSI PIC  999.
  3809*    -------------------------------
  3810     05  BPMTAMTL PIC S9(0004) COMP.
  3811     05  BPMTAMTF PIC  X(0001).
  3812     05  FILLER REDEFINES BPMTAMTF.
  3813         10  BPMTAMTA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  73
* EL6311.cbl
  3814     05  BPMTAMTI PIC  9(7)V99.
  3815*    -------------------------------
  3816     05  BAPRL PIC S9(0004) COMP.
  3817     05  BAPRF PIC  X(0001).
  3818     05  FILLER REDEFINES BAPRF.
  3819         10  BAPRA PIC  X(0001).
  3820     05  BAPRI PIC  X(7).
  3821*    -------------------------------
  3822     05  BLIVESL PIC S9(0004) COMP.
  3823     05  BLIVESF PIC  X(0001).
  3824     05  FILLER REDEFINES BLIVESF.
  3825         10  BLIVESA PIC  X(0001).
  3826     05  BLIVESI PIC  X(0009).
  3827*    -------------------------------
  3828     05  BMEMCAPL PIC S9(0004) COMP.
  3829     05  BMEMCAPF PIC  X(0001).
  3830     05  FILLER REDEFINES BMEMCAPF.
  3831         10  BMEMCAPA PIC  X(0001).
  3832     05  BMEMCAPI PIC  X(0011).
  3833*    -------------------------------
  3834     05  BORIGHDL PIC S9(0004) COMP.
  3835     05  BORIGHDF PIC  X(0001).
  3836     05  FILLER REDEFINES BORIGHDF.
  3837         10  BORIGHDA PIC  X(0001).
  3838     05  BORIGHDI PIC  X(0009).
  3839*    -------------------------------
  3840     05  DMDBILL PIC S9(0004) COMP.
  3841     05  DMDBILF PIC  X(0001).
  3842     05  FILLER REDEFINES DMDBILF.
  3843         10  DMDBILA PIC  X(0001).
  3844     05  DMDBILI PIC  X(0006).
  3845*    -------------------------------
  3846     05  BFORCEL PIC S9(0004) COMP.
  3847     05  BFORCEF PIC  X(0001).
  3848     05  FILLER REDEFINES BFORCEF.
  3849         10  BFORCEA PIC  X(0001).
  3850     05  BFORCEI PIC  X(0001).
  3851*    -------------------------------
  3852     05  BENTRYL PIC S9(0004) COMP.
  3853     05  BENTRYF PIC  X(0001).
  3854     05  FILLER REDEFINES BENTRYF.
  3855         10  BENTRYA PIC  X(0001).
  3856     05  BENTRYI PIC  X(0001).
  3857*    -------------------------------
  3858     05  BREINL PIC S9(0004) COMP.
  3859     05  BREINF PIC  X(0001).
  3860     05  FILLER REDEFINES BREINF.
  3861         10  BREINA PIC  X(0001).
  3862     05  BREINI PIC  X(0001).
  3863*    -------------------------------
  3864     05  BBILCDL PIC S9(0004) COMP.
  3865     05  BBILCDF PIC  X(0001).
  3866     05  FILLER REDEFINES BBILCDF.
  3867         10  BBILCDA PIC  X(0001).
  3868     05  BBILCDI PIC  X(0001).
  3869*    -------------------------------
  3870     05  BUNWRITL PIC S9(0004) COMP.
  3871     05  BUNWRITF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  74
* EL6311.cbl
  3872     05  FILLER REDEFINES BUNWRITF.
  3873         10  BUNWRITA PIC  X(0001).
  3874     05  BUNWRITI PIC  X(0001).
  3875*    -------------------------------
  3876     05  BSKPCDL PIC S9(0004) COMP.
  3877     05  BSKPCDF PIC  X(0001).
  3878     05  FILLER REDEFINES BSKPCDF.
  3879         10  BSKPCDA PIC  X(0001).
  3880     05  BSKPCDI PIC  X(0001).
  3881*    -------------------------------
  3882     05  BINDGRPL PIC S9(0004) COMP.
  3883     05  BINDGRPF PIC  X(0001).
  3884     05  FILLER REDEFINES BINDGRPF.
  3885         10  BINDGRPA PIC  X(0001).
  3886     05  BINDGRPI PIC  X(0001).
  3887*    -------------------------------
  3888     05  BSIGL PIC S9(0004) COMP.
  3889     05  BSIGF PIC  X(0001).
  3890     05  FILLER REDEFINES BSIGF.
  3891         10  BSIGA PIC  X(0001).
  3892     05  BSIGI PIC  X(0001).
  3893*    -------------------------------
  3894     05  BRTCLSL PIC S9(0004) COMP.
  3895     05  BRTCLSF PIC  X(0001).
  3896     05  FILLER REDEFINES BRTCLSF.
  3897         10  BRTCLSA PIC  X(0001).
  3898     05  BRTCLSI PIC  X(0002).
  3899*    -------------------------------
  3900     05  BCHGCNTL PIC S9(0004) COMP.
  3901     05  BCHGCNTF PIC  X(0001).
  3902     05  FILLER REDEFINES BCHGCNTF.
  3903         10  BCHGCNTA PIC  X(0001).
  3904     05  BCHGCNTI PIC  X(0003).
  3905*    -------------------------------
  3906     05  BMEMBERL PIC S9(0004) COMP.
  3907     05  BMEMBERF PIC  X(0001).
  3908     05  FILLER REDEFINES BMEMBERF.
  3909         10  BMEMBERA PIC  X(0001).
  3910     05  BMEMBERI PIC  X(0012).
  3911*    -------------------------------
  3912     05  BORGNOL PIC S9(0004) COMP.
  3913     05  BORGNOF PIC  X(0001).
  3914     05  FILLER REDEFINES BORGNOF.
  3915         10  BORGNOA PIC  X(0001).
  3916     05  BORGNOI PIC  X(0006).
  3917*    -------------------------------
  3918     05  BORGSEQL PIC S9(0004) COMP.
  3919     05  BORGSEQF PIC  X(0001).
  3920     05  FILLER REDEFINES BORGSEQF.
  3921         10  BORGSEQA PIC  X(0001).
  3922     05  BORGSEQI PIC  X(0004).
  3923*    -------------------------------
  3924     05  BBILLEDL PIC S9(0004) COMP.
  3925     05  BBILLEDF PIC  X(0001).
  3926     05  FILLER REDEFINES BBILLEDF.
  3927         10  BBILLEDA PIC  X(0001).
  3928     05  BBILLEDI PIC  9(9).
  3929*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  75
* EL6311.cbl
  3930     05  BKIND1L PIC S9(0004) COMP.
  3931     05  BKIND1F PIC  X(0001).
  3932     05  FILLER REDEFINES BKIND1F.
  3933         10  BKIND1A PIC  X(0001).
  3934     05  BKIND1I PIC  X(0002).
  3935*    -------------------------------
  3936     05  BTYPE1L PIC S9(0004) COMP.
  3937     05  BTYPE1F PIC  X(0001).
  3938     05  FILLER REDEFINES BTYPE1F.
  3939         10  BTYPE1A PIC  X(0001).
  3940     05  BTYPE1I PIC  X(0003).
  3941*    -------------------------------
  3942     05  BTERM1L PIC S9(0004) COMP.
  3943     05  BTERM1F PIC  X(0001).
  3944     05  FILLER REDEFINES BTERM1F.
  3945         10  BTERM1A PIC  X(0001).
  3946     05  BTERM1I PIC  X(0003).
  3947*    -------------------------------
  3948     05  BBEN1L PIC S9(0004) COMP.
  3949     05  BBEN1F PIC  X(0001).
  3950     05  FILLER REDEFINES BBEN1F.
  3951         10  BBEN1A PIC  X(0001).
  3952     05  BBEN1I PIC  X(0012).
  3953*    -------------------------------
  3954     05  BPREM1L PIC S9(0004) COMP.
  3955     05  BPREM1F PIC  X(0001).
  3956     05  FILLER REDEFINES BPREM1F.
  3957         10  BPREM1A PIC  X(0001).
  3958     05  BPREM1I PIC  X(0011).
  3959*    -------------------------------
  3960     05  BEXPIR1L PIC S9(0004) COMP.
  3961     05  BEXPIR1F PIC  X(0001).
  3962     05  FILLER REDEFINES BEXPIR1F.
  3963         10  BEXPIR1A PIC  X(0001).
  3964     05  BEXPIR1I PIC  X(0008).
  3965*    -------------------------------
  3966     05  BCP1L PIC S9(0004) COMP.
  3967     05  BCP1F PIC  X(0001).
  3968     05  FILLER REDEFINES BCP1F.
  3969         10  BCP1A PIC  X(0001).
  3970     05  BCP1I PIC  X(0002).
  3971*    -------------------------------
  3972     05  BALTBN1L PIC S9(0004) COMP.
  3973     05  BALTBN1F PIC  X(0001).
  3974     05  FILLER REDEFINES BALTBN1F.
  3975         10  BALTBN1A PIC  X(0001).
  3976     05  BALTBN1I PIC  X(0012).
  3977*    -------------------------------
  3978     05  BALTPR1L PIC S9(0004) COMP.
  3979     05  BALTPR1F PIC  X(0001).
  3980     05  FILLER REDEFINES BALTPR1F.
  3981         10  BALTPR1A PIC  X(0001).
  3982     05  BALTPR1I PIC  X(0011).
  3983*    -------------------------------
  3984     05  BBNCD1L PIC S9(0004) COMP.
  3985     05  BBNCD1F PIC  X(0001).
  3986     05  FILLER REDEFINES BBNCD1F.
  3987         10  BBNCD1A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  76
* EL6311.cbl
  3988     05  BBNCD1I PIC  X(0003).
  3989*    -------------------------------
  3990     05  BCPRM1L PIC S9(0004) COMP.
  3991     05  BCPRM1F PIC  X(0001).
  3992     05  FILLER REDEFINES BCPRM1F.
  3993         10  BCPRM1A PIC  X(0001).
  3994     05  BCPRM1I PIC  X(0011).
  3995*    -------------------------------
  3996     05  BCAPRM1L PIC S9(0004) COMP.
  3997     05  BCAPRM1F PIC  X(0001).
  3998     05  FILLER REDEFINES BCAPRM1F.
  3999         10  BCAPRM1A PIC  X(0001).
  4000     05  BCAPRM1I PIC  X(0011).
  4001*    -------------------------------
  4002     05  BENABR1L PIC S9(0004) COMP.
  4003     05  BENABR1F PIC  X(0001).
  4004     05  FILLER REDEFINES BENABR1F.
  4005         10  BENABR1A PIC  X(0001).
  4006     05  BENABR1I PIC  X(0005).
  4007*    -------------------------------
  4008     05  BDIFF1L PIC S9(0004) COMP.
  4009     05  BDIFF1F PIC  X(0001).
  4010     05  FILLER REDEFINES BDIFF1F.
  4011         10  BDIFF1A PIC  X(0001).
  4012     05  BDIFF1I PIC  X(0011).
  4013*    -------------------------------
  4014     05  BBILIT1L PIC S9(0004) COMP.
  4015     05  BBILIT1F PIC  X(0001).
  4016     05  FILLER REDEFINES BBILIT1F.
  4017         10  BBILIT1A PIC  X(0001).
  4018     05  BBILIT1I PIC  X(0008).
  4019*    -------------------------------
  4020     05  BADIFF1L PIC S9(0004) COMP.
  4021     05  BADIFF1F PIC  X(0001).
  4022     05  FILLER REDEFINES BADIFF1F.
  4023         10  BADIFF1A PIC  X(0001).
  4024     05  BADIFF1I PIC  X(0011).
  4025*    -------------------------------
  4026     05  BKIND2L PIC S9(0004) COMP.
  4027     05  BKIND2F PIC  X(0001).
  4028     05  FILLER REDEFINES BKIND2F.
  4029         10  BKIND2A PIC  X(0001).
  4030     05  BKIND2I PIC  X(0002).
  4031*    -------------------------------
  4032     05  BTYPE2L PIC S9(0004) COMP.
  4033     05  BTYPE2F PIC  X(0001).
  4034     05  FILLER REDEFINES BTYPE2F.
  4035         10  BTYPE2A PIC  X(0001).
  4036     05  BTYPE2I PIC  X(0003).
  4037*    -------------------------------
  4038     05  BTERM2L PIC S9(0004) COMP.
  4039     05  BTERM2F PIC  X(0001).
  4040     05  FILLER REDEFINES BTERM2F.
  4041         10  BTERM2A PIC  X(0001).
  4042     05  BTERM2I PIC  X(0003).
  4043*    -------------------------------
  4044     05  BBEN2L PIC S9(0004) COMP.
  4045     05  BBEN2F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  77
* EL6311.cbl
  4046     05  FILLER REDEFINES BBEN2F.
  4047         10  BBEN2A PIC  X(0001).
  4048     05  BBEN2I PIC  X(0012).
  4049*    -------------------------------
  4050     05  BPREM2L PIC S9(0004) COMP.
  4051     05  BPREM2F PIC  X(0001).
  4052     05  FILLER REDEFINES BPREM2F.
  4053         10  BPREM2A PIC  X(0001).
  4054     05  BPREM2I PIC  X(0011).
  4055*    -------------------------------
  4056     05  BEXPIR2L PIC S9(0004) COMP.
  4057     05  BEXPIR2F PIC  X(0001).
  4058     05  FILLER REDEFINES BEXPIR2F.
  4059         10  BEXPIR2A PIC  X(0001).
  4060     05  BEXPIR2I PIC  X(0008).
  4061*    -------------------------------
  4062     05  BCP2L PIC S9(0004) COMP.
  4063     05  BCP2F PIC  X(0001).
  4064     05  FILLER REDEFINES BCP2F.
  4065         10  BCP2A PIC  X(0001).
  4066     05  BCP2I PIC  X(0002).
  4067*    -------------------------------
  4068     05  BALTBN2L PIC S9(0004) COMP.
  4069     05  BALTBN2F PIC  X(0001).
  4070     05  FILLER REDEFINES BALTBN2F.
  4071         10  BALTBN2A PIC  X(0001).
  4072     05  BALTBN2I PIC  X(0012).
  4073*    -------------------------------
  4074     05  BALTPR2L PIC S9(0004) COMP.
  4075     05  BALTPR2F PIC  X(0001).
  4076     05  FILLER REDEFINES BALTPR2F.
  4077         10  BALTPR2A PIC  X(0001).
  4078     05  BALTPR2I PIC  X(0011).
  4079*    -------------------------------
  4080     05  BBNCD2L PIC S9(0004) COMP.
  4081     05  BBNCD2F PIC  X(0001).
  4082     05  FILLER REDEFINES BBNCD2F.
  4083         10  BBNCD2A PIC  X(0001).
  4084     05  BBNCD2I PIC  X(0003).
  4085*    -------------------------------
  4086     05  BCPRM2L PIC S9(0004) COMP.
  4087     05  BCPRM2F PIC  X(0001).
  4088     05  FILLER REDEFINES BCPRM2F.
  4089         10  BCPRM2A PIC  X(0001).
  4090     05  BCPRM2I PIC  X(0011).
  4091*    -------------------------------
  4092     05  BCAPRM2L PIC S9(0004) COMP.
  4093     05  BCAPRM2F PIC  X(0001).
  4094     05  FILLER REDEFINES BCAPRM2F.
  4095         10  BCAPRM2A PIC  X(0001).
  4096     05  BCAPRM2I PIC  X(0011).
  4097*    -------------------------------
  4098     05  BENABR2L PIC S9(0004) COMP.
  4099     05  BENABR2F PIC  X(0001).
  4100     05  FILLER REDEFINES BENABR2F.
  4101         10  BENABR2A PIC  X(0001).
  4102     05  BENABR2I PIC  X(0005).
  4103*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  78
* EL6311.cbl
  4104     05  BDIFF2L PIC S9(0004) COMP.
  4105     05  BDIFF2F PIC  X(0001).
  4106     05  FILLER REDEFINES BDIFF2F.
  4107         10  BDIFF2A PIC  X(0001).
  4108     05  BDIFF2I PIC  X(0011).
  4109*    -------------------------------
  4110     05  BBILIT2L PIC S9(0004) COMP.
  4111     05  BBILIT2F PIC  X(0001).
  4112     05  FILLER REDEFINES BBILIT2F.
  4113         10  BBILIT2A PIC  X(0001).
  4114     05  BBILIT2I PIC  X(0008).
  4115*    -------------------------------
  4116     05  BADIFF2L PIC S9(0004) COMP.
  4117     05  BADIFF2F PIC  X(0001).
  4118     05  FILLER REDEFINES BADIFF2F.
  4119         10  BADIFF2A PIC  X(0001).
  4120     05  BADIFF2I PIC  X(0011).
  4121*    -------------------------------
  4122     05  BERMSG1L PIC S9(0004) COMP.
  4123     05  BERMSG1F PIC  X(0001).
  4124     05  FILLER REDEFINES BERMSG1F.
  4125         10  BERMSG1A PIC  X(0001).
  4126     05  BERMSG1I PIC  X(0078).
  4127*    -------------------------------
  4128     05  BERMSG2L PIC S9(0004) COMP.
  4129     05  BERMSG2F PIC  X(0001).
  4130     05  FILLER REDEFINES BERMSG2F.
  4131         10  BERMSG2A PIC  X(0001).
  4132     05  BERMSG2I PIC  X(0078).
  4133*    -------------------------------
  4134     05  BERMSG3L PIC S9(0004) COMP.
  4135     05  BERMSG3F PIC  X(0001).
  4136     05  FILLER REDEFINES BERMSG3F.
  4137         10  BERMSG3A PIC  X(0001).
  4138     05  BERMSG3I PIC  X(0078).
  4139*    -------------------------------
  4140     05  BPFENTRL PIC S9(0004) COMP.
  4141     05  BPFENTRF PIC  X(0001).
  4142     05  FILLER REDEFINES BPFENTRF.
  4143         10  BPFENTRA PIC  X(0001).
  4144     05  BPFENTRI PIC  9(2).
  4145*    -------------------------------
  4146     05  BPF5HDRL PIC S9(0004) COMP.
  4147     05  BPF5HDRF PIC  X(0001).
  4148     05  FILLER REDEFINES BPF5HDRF.
  4149         10  BPF5HDRA PIC  X(0001).
  4150     05  BPF5HDRI PIC  X(0005).
  4151*    -------------------------------
  4152     05  BPF4HDRL PIC S9(0004) COMP.
  4153     05  BPF4HDRF PIC  X(0001).
  4154     05  FILLER REDEFINES BPF4HDRF.
  4155         10  BPF4HDRA PIC  X(0001).
  4156     05  BPF4HDRI PIC  X(0013).
  4157*    -------------------------------
  4158     05  BF15HDRL PIC S9(0004) COMP.
  4159     05  BF15HDRF PIC  X(0001).
  4160     05  FILLER REDEFINES BF15HDRF.
  4161         10  BF15HDRA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  79
* EL6311.cbl
  4162     05  BF15HDRI PIC  X(0010).
  4163 01  EL631BO REDEFINES EL631BI.
  4164     05  FILLER            PIC  X(0012).
  4165*    -------------------------------
  4166     05  FILLER            PIC  X(0003).
  4167     05  BDATEO PIC  X(0008).
  4168*    -------------------------------
  4169     05  FILLER            PIC  X(0003).
  4170     05  BTIMEO PIC  99.99.
  4171*    -------------------------------
  4172     05  FILLER            PIC  X(0003).
  4173     05  BHEADO PIC  X(0038).
  4174*    -------------------------------
  4175     05  FILLER            PIC  X(0003).
  4176     05  BNCERTLO PIC  X(0008).
  4177*    -------------------------------
  4178     05  FILLER            PIC  X(0003).
  4179     05  BNCERTO PIC  X(0011).
  4180*    -------------------------------
  4181     05  FILLER            PIC  X(0003).
  4182     05  BNSTATLO PIC  X(0009).
  4183*    -------------------------------
  4184     05  FILLER            PIC  X(0003).
  4185     05  BNSTATO PIC  X(0002).
  4186*    -------------------------------
  4187     05  FILLER            PIC  X(0003).
  4188     05  BCHGTO PIC  X(0004).
  4189*    -------------------------------
  4190     05  FILLER            PIC  X(0003).
  4191     05  BCHGO PIC  ZZZ9.
  4192*    -------------------------------
  4193     05  FILLER            PIC  X(0003).
  4194     05  BCOMPIDO PIC  X(0003).
  4195*    -------------------------------
  4196     05  FILLER            PIC  X(0003).
  4197     05  BREGIONO PIC  X(0006).
  4198*    -------------------------------
  4199     05  FILLER            PIC  X(0003).
  4200     05  BUSERO PIC  X(0004).
  4201*    -------------------------------
  4202     05  FILLER            PIC  X(0003).
  4203     05  BMAINTO PIC  X(0001).
  4204*    -------------------------------
  4205     05  FILLER            PIC  X(0003).
  4206     05  BMANTBYO PIC  X(0004).
  4207*    -------------------------------
  4208     05  FILLER            PIC  X(0003).
  4209     05  BCHGHDGO PIC  X(0003).
  4210*    -------------------------------
  4211     05  FILLER            PIC  X(0003).
  4212     05  BMANTDTO PIC  X(0008).
  4213*    -------------------------------
  4214     05  FILLER            PIC  X(0003).
  4215     05  BMANTATO PIC  99.99.
  4216*    -------------------------------
  4217     05  FILLER            PIC  X(0003).
  4218     05  BCSRO PIC  X(0004).
  4219*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  80
* EL6311.cbl
  4220     05  FILLER            PIC  X(0003).
  4221     05  BBATCHO PIC  X(0006).
  4222*    -------------------------------
  4223     05  FILLER            PIC  X(0003).
  4224     05  BSEQO PIC  X(0004).
  4225*    -------------------------------
  4226     05  FILLER            PIC  X(0003).
  4227     05  BMOENDTO PIC  X(0008).
  4228*    -------------------------------
  4229     05  FILLER            PIC  X(0003).
  4230     05  BCARRO PIC  X(0001).
  4231*    -------------------------------
  4232     05  FILLER            PIC  X(0003).
  4233     05  BGROUPO PIC  X(0006).
  4234*    -------------------------------
  4235     05  FILLER            PIC  X(0003).
  4236     05  BSTATEO PIC  X(0002).
  4237*    -------------------------------
  4238     05  FILLER            PIC  X(0003).
  4239     05  BACCTO PIC  X(0010).
  4240*    -------------------------------
  4241     05  FILLER            PIC  X(0003).
  4242     05  BVINHO PIC  X(0004).
  4243*    -------------------------------
  4244     05  FILLER            PIC  X(0003).
  4245     05  BVINO PIC  X(0017).
  4246*    -------------------------------
  4247     05  FILLER            PIC  X(0003).
  4248     05  BREFHDGO PIC  X(0004).
  4249*    -------------------------------
  4250     05  FILLER            PIC  X(0003).
  4251     05  BREFO PIC  X(0012).
  4252*    -------------------------------
  4253     05  FILLER            PIC  X(0003).
  4254     05  LETRREQO PIC  X(0001).
  4255*    -------------------------------
  4256     05  FILLER            PIC  X(0003).
  4257     05  BAGEDEFO PIC  X(0004).
  4258*    -------------------------------
  4259     05  FILLER            PIC  X(0003).
  4260     05  BCERTNOO PIC  X(0010).
  4261*    -------------------------------
  4262     05  FILLER            PIC  X(0003).
  4263     05  BSUFIXO PIC  X(0001).
  4264*    -------------------------------
  4265     05  FILLER            PIC  X(0003).
  4266     05  BEFFDTO PIC  X(0008).
  4267*    -------------------------------
  4268     05  FILLER            PIC  X(0003).
  4269     05  BLSTNMO PIC  X(0015).
  4270*    -------------------------------
  4271     05  FILLER            PIC  X(0003).
  4272     05  B1STNMO PIC  X(0010).
  4273*    -------------------------------
  4274     05  FILLER            PIC  X(0003).
  4275     05  BINITO PIC  X(0001).
  4276*    -------------------------------
  4277     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  81
* EL6311.cbl
  4278     05  BSEXO PIC  X(0001).
  4279*    -------------------------------
  4280     05  FILLER            PIC  X(0003).
  4281     05  BAGEO PIC  X(0002).
  4282*    -------------------------------
  4283     05  FILLER            PIC  X(0003).
  4284     05  BBIRTHO PIC  X(0008).
  4285*    -------------------------------
  4286     05  FILLER            PIC  X(0003).
  4287     05  B1STPMTO PIC  X(0008).
  4288*    -------------------------------
  4289     05  FILLER            PIC  X(0003).
  4290     05  BDAYSO PIC  X(0003).
  4291*    -------------------------------
  4292     05  FILLER            PIC  X(0003).
  4293     05  BLNTRMO PIC  X(0003).
  4294*    -------------------------------
  4295     05  FILLER            PIC  X(0003).
  4296     05  BLNOFCRO PIC  X(0005).
  4297*    -------------------------------
  4298     05  FILLER            PIC  X(0003).
  4299     05  BMODEO PIC  X(0001).
  4300*    -------------------------------
  4301     05  FILLER            PIC  X(0003).
  4302     05  BFREQO PIC  X(0002).
  4303*    -------------------------------
  4304     05  FILLER            PIC  X(0003).
  4305     05  BPMTSO PIC  X(0003).
  4306*    -------------------------------
  4307     05  FILLER            PIC  X(0003).
  4308     05  BPMTAMTO PIC  ZZZZZ9.99.
  4309*    -------------------------------
  4310     05  FILLER            PIC  X(0003).
  4311     05  BAPRO PIC  99.9999.
  4312*    -------------------------------
  4313     05  FILLER            PIC  X(0003).
  4314     05  BLIVESO PIC  Z,ZZZ,ZZZ.
  4315*    -------------------------------
  4316     05  FILLER            PIC  X(0003).
  4317     05  BMEMCAPO PIC  X(0011).
  4318*    -------------------------------
  4319     05  FILLER            PIC  X(0003).
  4320     05  BORIGHDO PIC  X(0009).
  4321*    -------------------------------
  4322     05  FILLER            PIC  X(0003).
  4323     05  DMDBILO PIC  X(0006).
  4324*    -------------------------------
  4325     05  FILLER            PIC  X(0003).
  4326     05  BFORCEO PIC  X(0001).
  4327*    -------------------------------
  4328     05  FILLER            PIC  X(0003).
  4329     05  BENTRYO PIC  X(0001).
  4330*    -------------------------------
  4331     05  FILLER            PIC  X(0003).
  4332     05  BREINO PIC  X(0001).
  4333*    -------------------------------
  4334     05  FILLER            PIC  X(0003).
  4335     05  BBILCDO PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  82
* EL6311.cbl
  4336*    -------------------------------
  4337     05  FILLER            PIC  X(0003).
  4338     05  BUNWRITO PIC  X(0001).
  4339*    -------------------------------
  4340     05  FILLER            PIC  X(0003).
  4341     05  BSKPCDO PIC  X(0001).
  4342*    -------------------------------
  4343     05  FILLER            PIC  X(0003).
  4344     05  BINDGRPO PIC  X(0001).
  4345*    -------------------------------
  4346     05  FILLER            PIC  X(0003).
  4347     05  BSIGO PIC  X(0001).
  4348*    -------------------------------
  4349     05  FILLER            PIC  X(0003).
  4350     05  BRTCLSO PIC  X(0002).
  4351*    -------------------------------
  4352     05  FILLER            PIC  X(0003).
  4353     05  BCHGCNTO PIC  X(0003).
  4354*    -------------------------------
  4355     05  FILLER            PIC  X(0003).
  4356     05  BMEMBERO PIC  X(0012).
  4357*    -------------------------------
  4358     05  FILLER            PIC  X(0003).
  4359     05  BORGNOO PIC  X(0006).
  4360*    -------------------------------
  4361     05  FILLER            PIC  X(0003).
  4362     05  BORGSEQO PIC  X(0004).
  4363*    -------------------------------
  4364     05  FILLER            PIC  X(0003).
  4365     05  BBILLEDO PIC  Z,ZZZ,ZZZ.
  4366*    -------------------------------
  4367     05  FILLER            PIC  X(0003).
  4368     05  BKIND1O PIC  X(0002).
  4369*    -------------------------------
  4370     05  FILLER            PIC  X(0003).
  4371     05  BTYPE1O PIC  X(0003).
  4372*    -------------------------------
  4373     05  FILLER            PIC  X(0003).
  4374     05  BTERM1O PIC  X(0003).
  4375*    -------------------------------
  4376     05  FILLER            PIC  X(0003).
  4377     05  BBEN1O PIC  X(0012).
  4378*    -------------------------------
  4379     05  FILLER            PIC  X(0003).
  4380     05  BPREM1O PIC  X(0011).
  4381*    -------------------------------
  4382     05  FILLER            PIC  X(0003).
  4383     05  BEXPIR1O PIC  X(0008).
  4384*    -------------------------------
  4385     05  FILLER            PIC  X(0003).
  4386     05  BCP1O PIC  X(0002).
  4387*    -------------------------------
  4388     05  FILLER            PIC  X(0003).
  4389     05  BALTBN1O PIC  X(0012).
  4390*    -------------------------------
  4391     05  FILLER            PIC  X(0003).
  4392     05  BALTPR1O PIC  X(0011).
  4393*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  83
* EL6311.cbl
  4394     05  FILLER            PIC  X(0003).
  4395     05  BBNCD1O PIC  X(0003).
  4396*    -------------------------------
  4397     05  FILLER            PIC  X(0003).
  4398     05  BCPRM1O PIC  X(0011).
  4399*    -------------------------------
  4400     05  FILLER            PIC  X(0003).
  4401     05  BCAPRM1O PIC  X(0011).
  4402*    -------------------------------
  4403     05  FILLER            PIC  X(0003).
  4404     05  BENABR1O PIC  X(0005).
  4405*    -------------------------------
  4406     05  FILLER            PIC  X(0003).
  4407     05  BDIFF1O PIC  X(0011).
  4408*    -------------------------------
  4409     05  FILLER            PIC  X(0003).
  4410     05  BBILIT1O PIC  X(0008).
  4411*    -------------------------------
  4412     05  FILLER            PIC  X(0003).
  4413     05  BADIFF1O PIC  X(0011).
  4414*    -------------------------------
  4415     05  FILLER            PIC  X(0003).
  4416     05  BKIND2O PIC  X(0002).
  4417*    -------------------------------
  4418     05  FILLER            PIC  X(0003).
  4419     05  BTYPE2O PIC  X(0003).
  4420*    -------------------------------
  4421     05  FILLER            PIC  X(0003).
  4422     05  BTERM2O PIC  X(0003).
  4423*    -------------------------------
  4424     05  FILLER            PIC  X(0003).
  4425     05  BBEN2O PIC  X(0012).
  4426*    -------------------------------
  4427     05  FILLER            PIC  X(0003).
  4428     05  BPREM2O PIC  X(0011).
  4429*    -------------------------------
  4430     05  FILLER            PIC  X(0003).
  4431     05  BEXPIR2O PIC  X(0008).
  4432*    -------------------------------
  4433     05  FILLER            PIC  X(0003).
  4434     05  BCP2O PIC  X(0002).
  4435*    -------------------------------
  4436     05  FILLER            PIC  X(0003).
  4437     05  BALTBN2O PIC  X(0012).
  4438*    -------------------------------
  4439     05  FILLER            PIC  X(0003).
  4440     05  BALTPR2O PIC  X(0011).
  4441*    -------------------------------
  4442     05  FILLER            PIC  X(0003).
  4443     05  BBNCD2O PIC  X(0003).
  4444*    -------------------------------
  4445     05  FILLER            PIC  X(0003).
  4446     05  BCPRM2O PIC  X(0011).
  4447*    -------------------------------
  4448     05  FILLER            PIC  X(0003).
  4449     05  BCAPRM2O PIC  X(0011).
  4450*    -------------------------------
  4451     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  84
* EL6311.cbl
  4452     05  BENABR2O PIC  X(0005).
  4453*    -------------------------------
  4454     05  FILLER            PIC  X(0003).
  4455     05  BDIFF2O PIC  X(0011).
  4456*    -------------------------------
  4457     05  FILLER            PIC  X(0003).
  4458     05  BBILIT2O PIC  X(0008).
  4459*    -------------------------------
  4460     05  FILLER            PIC  X(0003).
  4461     05  BADIFF2O PIC  X(0011).
  4462*    -------------------------------
  4463     05  FILLER            PIC  X(0003).
  4464     05  BERMSG1O PIC  X(0078).
  4465*    -------------------------------
  4466     05  FILLER            PIC  X(0003).
  4467     05  BERMSG2O PIC  X(0078).
  4468*    -------------------------------
  4469     05  FILLER            PIC  X(0003).
  4470     05  BERMSG3O PIC  X(0078).
  4471*    -------------------------------
  4472     05  FILLER            PIC  X(0003).
  4473     05  BPFENTRO PIC  X(0002).
  4474*    -------------------------------
  4475     05  FILLER            PIC  X(0003).
  4476     05  BPF5HDRO PIC  X(0005).
  4477*    -------------------------------
  4478     05  FILLER            PIC  X(0003).
  4479     05  BPF4HDRO PIC  X(0013).
  4480*    -------------------------------
  4481     05  FILLER            PIC  X(0003).
  4482     05  BF15HDRO PIC  X(0010).
  4483*    -------------------------------
  4484 01  EL631CI REDEFINES EL631BI.
  4485     05  FILLER            PIC  X(0012).
  4486*    -------------------------------
  4487     05  CDATEL PIC S9(0004) COMP.
  4488     05  CDATEF PIC  X(0001).
  4489     05  FILLER REDEFINES CDATEF.
  4490         10  CDATEA PIC  X(0001).
  4491     05  CDATEI PIC  X(0008).
  4492*    -------------------------------
  4493     05  CTIMEL PIC S9(0004) COMP.
  4494     05  CTIMEF PIC  X(0001).
  4495     05  FILLER REDEFINES CTIMEF.
  4496         10  CTIMEA PIC  X(0001).
  4497     05  CTIMEI PIC  X(0005).
  4498*    -------------------------------
  4499     05  CHEADL PIC S9(0004) COMP.
  4500     05  CHEADF PIC  X(0001).
  4501     05  FILLER REDEFINES CHEADF.
  4502         10  CHEADA PIC  X(0001).
  4503     05  CHEADI PIC  X(0038).
  4504*    -------------------------------
  4505     05  CCHGTL PIC S9(0004) COMP.
  4506     05  CCHGTF PIC  X(0001).
  4507     05  FILLER REDEFINES CCHGTF.
  4508         10  CCHGTA PIC  X(0001).
  4509     05  CCHGTI PIC  X(0004).
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  85
* EL6311.cbl
  4510*    -------------------------------
  4511     05  CCHGL PIC S9(0004) COMP.
  4512     05  CCHGF PIC  X(0001).
  4513     05  FILLER REDEFINES CCHGF.
  4514         10  CCHGA PIC  X(0001).
  4515     05  CCHGI PIC  X(0004).
  4516*    -------------------------------
  4517     05  CMAINTL PIC S9(0004) COMP.
  4518     05  CMAINTF PIC  X(0001).
  4519     05  FILLER REDEFINES CMAINTF.
  4520         10  CMAINTA PIC  X(0001).
  4521     05  CMAINTI PIC  X(0001).
  4522*    -------------------------------
  4523     05  CMANTBYL PIC S9(0004) COMP.
  4524     05  CMANTBYF PIC  X(0001).
  4525     05  FILLER REDEFINES CMANTBYF.
  4526         10  CMANTBYA PIC  X(0001).
  4527     05  CMANTBYI PIC  X(0004).
  4528*    -------------------------------
  4529     05  CCHGHDGL PIC S9(0004) COMP.
  4530     05  CCHGHDGF PIC  X(0001).
  4531     05  FILLER REDEFINES CCHGHDGF.
  4532         10  CCHGHDGA PIC  X(0001).
  4533     05  CCHGHDGI PIC  X(0003).
  4534*    -------------------------------
  4535     05  CMANTDTL PIC S9(0004) COMP.
  4536     05  CMANTDTF PIC  X(0001).
  4537     05  FILLER REDEFINES CMANTDTF.
  4538         10  CMANTDTA PIC  X(0001).
  4539     05  CMANTDTI PIC  X(0008).
  4540*    -------------------------------
  4541     05  CMANTATL PIC S9(0004) COMP.
  4542     05  CMANTATF PIC  X(0001).
  4543     05  FILLER REDEFINES CMANTATF.
  4544         10  CMANTATA PIC  X(0001).
  4545     05  CMANTATI PIC  X(0005).
  4546*    -------------------------------
  4547     05  CCSRL PIC S9(0004) COMP.
  4548     05  CCSRF PIC  X(0001).
  4549     05  FILLER REDEFINES CCSRF.
  4550         10  CCSRA PIC  X(0001).
  4551     05  CCSRI PIC  X(0004).
  4552*    -------------------------------
  4553     05  CBATCHL PIC S9(0004) COMP.
  4554     05  CBATCHF PIC  X(0001).
  4555     05  FILLER REDEFINES CBATCHF.
  4556         10  CBATCHA PIC  X(0001).
  4557     05  CBATCHI PIC  X(0006).
  4558*    -------------------------------
  4559     05  CSEQL PIC S9(0004) COMP.
  4560     05  CSEQF PIC  X(0001).
  4561     05  FILLER REDEFINES CSEQF.
  4562         10  CSEQA PIC  X(0001).
  4563     05  CSEQI PIC  X(0004).
  4564*    -------------------------------
  4565     05  CMOENDTL PIC S9(0004) COMP.
  4566     05  CMOENDTF PIC  X(0001).
  4567     05  FILLER REDEFINES CMOENDTF.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  86
* EL6311.cbl
  4568         10  CMOENDTA PIC  X(0001).
  4569     05  CMOENDTI PIC  X(0008).
  4570*    -------------------------------
  4571     05  CCARRL PIC S9(0004) COMP.
  4572     05  CCARRF PIC  X(0001).
  4573     05  FILLER REDEFINES CCARRF.
  4574         10  CCARRA PIC  X(0001).
  4575     05  CCARRI PIC  X(0001).
  4576*    -------------------------------
  4577     05  CGROUPL PIC S9(0004) COMP.
  4578     05  CGROUPF PIC  X(0001).
  4579     05  FILLER REDEFINES CGROUPF.
  4580         10  CGROUPA PIC  X(0001).
  4581     05  CGROUPI PIC  X(0006).
  4582*    -------------------------------
  4583     05  CSTATEL PIC S9(0004) COMP.
  4584     05  CSTATEF PIC  X(0001).
  4585     05  FILLER REDEFINES CSTATEF.
  4586         10  CSTATEA PIC  X(0001).
  4587     05  CSTATEI PIC  X(0002).
  4588*    -------------------------------
  4589     05  CACCTL PIC S9(0004) COMP.
  4590     05  CACCTF PIC  X(0001).
  4591     05  FILLER REDEFINES CACCTF.
  4592         10  CACCTA PIC  X(0001).
  4593     05  CACCTI PIC  X(0010).
  4594*    -------------------------------
  4595     05  CORIGHDL PIC S9(0004) COMP.
  4596     05  CORIGHDF PIC  X(0001).
  4597     05  FILLER REDEFINES CORIGHDF.
  4598         10  CORIGHDA PIC  X(0001).
  4599     05  CORIGHDI PIC  X(0011).
  4600*    -------------------------------
  4601     05  CORGNOL PIC S9(0004) COMP.
  4602     05  CORGNOF PIC  X(0001).
  4603     05  FILLER REDEFINES CORGNOF.
  4604         10  CORGNOA PIC  X(0001).
  4605     05  CORGNOI PIC  X(0006).
  4606*    -------------------------------
  4607     05  CORGSEQL PIC S9(0004) COMP.
  4608     05  CORGSEQF PIC  X(0001).
  4609     05  FILLER REDEFINES CORGSEQF.
  4610         10  CORGSEQA PIC  X(0001).
  4611     05  CORGSEQI PIC  X(0004).
  4612*    -------------------------------
  4613     05  CREFHDGL PIC S9(0004) COMP.
  4614     05  CREFHDGF PIC  X(0001).
  4615     05  FILLER REDEFINES CREFHDGF.
  4616         10  CREFHDGA PIC  X(0001).
  4617     05  CREFHDGI PIC  X(0010).
  4618*    -------------------------------
  4619     05  CREFL PIC S9(0004) COMP.
  4620     05  CREFF PIC  X(0001).
  4621     05  FILLER REDEFINES CREFF.
  4622         10  CREFA PIC  X(0001).
  4623     05  CREFI PIC  X(0012).
  4624*    -------------------------------
  4625     05  CNHINTL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  87
* EL6311.cbl
  4626     05  CNHINTF PIC  X(0001).
  4627     05  FILLER REDEFINES CNHINTF.
  4628         10  CNHINTA PIC  X(0001).
  4629     05  CNHINTI PIC  9(7)V99.
  4630*    -------------------------------
  4631     05  CCERTNOL PIC S9(0004) COMP.
  4632     05  CCERTNOF PIC  X(0001).
  4633     05  FILLER REDEFINES CCERTNOF.
  4634         10  CCERTNOA PIC  X(0001).
  4635     05  CCERTNOI PIC  X(0010).
  4636*    -------------------------------
  4637     05  CSUFIXL PIC S9(0004) COMP.
  4638     05  CSUFIXF PIC  X(0001).
  4639     05  FILLER REDEFINES CSUFIXF.
  4640         10  CSUFIXA PIC  X(0001).
  4641     05  CSUFIXI PIC  X(0001).
  4642*    -------------------------------
  4643     05  CEFFDTL PIC S9(0004) COMP.
  4644     05  CEFFDTF PIC  X(0001).
  4645     05  FILLER REDEFINES CEFFDTF.
  4646         10  CEFFDTA PIC  X(0001).
  4647     05  CEFFDTI PIC  X(0008).
  4648*    -------------------------------
  4649     05  CLSTNML PIC S9(0004) COMP.
  4650     05  CLSTNMF PIC  X(0001).
  4651     05  FILLER REDEFINES CLSTNMF.
  4652         10  CLSTNMA PIC  X(0001).
  4653     05  CLSTNMI PIC  X(0015).
  4654*    -------------------------------
  4655     05  CINAMEL PIC S9(0004) COMP.
  4656     05  CINAMEF PIC  X(0001).
  4657     05  FILLER REDEFINES CINAMEF.
  4658         10  CINAMEA PIC  X(0001).
  4659     05  CINAMEI PIC  X(0015).
  4660*    -------------------------------
  4661     05  CINITSL PIC S9(0004) COMP.
  4662     05  CINITSF PIC  X(0001).
  4663     05  FILLER REDEFINES CINITSF.
  4664         10  CINITSA PIC  X(0001).
  4665     05  CINITSI PIC  X(0010).
  4666*    -------------------------------
  4667     05  CCANREAL PIC S9(0004) COMP.
  4668     05  CCANREAF PIC  X(0001).
  4669     05  FILLER REDEFINES CCANREAF.
  4670         10  CCANREAA PIC  X(0001).
  4671     05  CCANREAI PIC  X(0001).
  4672*    -------------------------------
  4673     05  ACTSPCL PIC S9(0004) COMP.
  4674     05  ACTSPCF PIC  X(0001).
  4675     05  FILLER REDEFINES ACTSPCF.
  4676         10  ACTSPCA PIC  X(0001).
  4677     05  ACTSPCI PIC  X(0001).
  4678*    -------------------------------
  4679     05  CKIND1L PIC S9(0004) COMP.
  4680     05  CKIND1F PIC  X(0001).
  4681     05  FILLER REDEFINES CKIND1F.
  4682         10  CKIND1A PIC  X(0001).
  4683     05  CKIND1I PIC  X(0002).
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  88
* EL6311.cbl
  4684*    -------------------------------
  4685     05  CCANDT1L PIC S9(0004) COMP.
  4686     05  CCANDT1F PIC  X(0001).
  4687     05  FILLER REDEFINES CCANDT1F.
  4688         10  CCANDT1A PIC  X(0001).
  4689     05  CCANDT1I PIC  X(0008).
  4690*    -------------------------------
  4691     05  CREFND1L PIC S9(0004) COMP.
  4692     05  CREFND1F PIC  X(0001).
  4693     05  FILLER REDEFINES CREFND1F.
  4694         10  CREFND1A PIC  X(0001).
  4695     05  CREFND1I PIC  S9(9)V99.
  4696*    -------------------------------
  4697     05  CMTHD1L PIC S9(0004) COMP.
  4698     05  CMTHD1F PIC  X(0001).
  4699     05  FILLER REDEFINES CMTHD1F.
  4700         10  CMTHD1A PIC  X(0001).
  4701     05  CMTHD1I PIC  X(0001).
  4702*    -------------------------------
  4703     05  CKIND2L PIC S9(0004) COMP.
  4704     05  CKIND2F PIC  X(0001).
  4705     05  FILLER REDEFINES CKIND2F.
  4706         10  CKIND2A PIC  X(0001).
  4707     05  CKIND2I PIC  X(0002).
  4708*    -------------------------------
  4709     05  CCANDT2L PIC S9(0004) COMP.
  4710     05  CCANDT2F PIC  X(0001).
  4711     05  FILLER REDEFINES CCANDT2F.
  4712         10  CCANDT2A PIC  X(0001).
  4713     05  CCANDT2I PIC  X(0008).
  4714*    -------------------------------
  4715     05  CREFND2L PIC S9(0004) COMP.
  4716     05  CREFND2F PIC  X(0001).
  4717     05  FILLER REDEFINES CREFND2F.
  4718         10  CREFND2A PIC  X(0001).
  4719     05  CREFND2I PIC  S9(9)V99.
  4720*    -------------------------------
  4721     05  CMTHD2L PIC S9(0004) COMP.
  4722     05  CMTHD2F PIC  X(0001).
  4723     05  FILLER REDEFINES CMTHD2F.
  4724         10  CMTHD2A PIC  X(0001).
  4725     05  CMTHD2I PIC  X(0001).
  4726*    -------------------------------
  4727     05  CLIVESL PIC S9(0004) COMP.
  4728     05  CLIVESF PIC  X(0001).
  4729     05  FILLER REDEFINES CLIVESF.
  4730         10  CLIVESA PIC  X(0001).
  4731     05  CLIVESI PIC  X(0003).
  4732*    -------------------------------
  4733     05  CFORCEL PIC S9(0004) COMP.
  4734     05  CFORCEF PIC  X(0001).
  4735     05  FILLER REDEFINES CFORCEF.
  4736         10  CFORCEA PIC  X(0001).
  4737     05  CFORCEI PIC  X(0001).
  4738*    -------------------------------
  4739     05  CBILCDL PIC S9(0004) COMP.
  4740     05  CBILCDF PIC  X(0001).
  4741     05  FILLER REDEFINES CBILCDF.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  89
* EL6311.cbl
  4742         10  CBILCDA PIC  X(0001).
  4743     05  CBILCDI PIC  X(0001).
  4744*    -------------------------------
  4745     05  CCRFND1L PIC S9(0004) COMP.
  4746     05  CCRFND1F PIC  X(0001).
  4747     05  FILLER REDEFINES CCRFND1F.
  4748         10  CCRFND1A PIC  X(0001).
  4749     05  CCRFND1I PIC  X(0011).
  4750*    -------------------------------
  4751     05  CCRFND2L PIC S9(0004) COMP.
  4752     05  CCRFND2F PIC  X(0001).
  4753     05  FILLER REDEFINES CCRFND2F.
  4754         10  CCRFND2A PIC  X(0001).
  4755     05  CCRFND2I PIC  X(0011).
  4756*    -------------------------------
  4757     05  CBILIT1L PIC S9(0004) COMP.
  4758     05  CBILIT1F PIC  X(0001).
  4759     05  FILLER REDEFINES CBILIT1F.
  4760         10  CBILIT1A PIC  X(0001).
  4761     05  CBILIT1I PIC  X(0008).
  4762*    -------------------------------
  4763     05  CDRFND1L PIC S9(0004) COMP.
  4764     05  CDRFND1F PIC  X(0001).
  4765     05  FILLER REDEFINES CDRFND1F.
  4766         10  CDRFND1A PIC  X(0001).
  4767     05  CDRFND1I PIC  X(0011).
  4768*    -------------------------------
  4769     05  CBILIT2L PIC S9(0004) COMP.
  4770     05  CBILIT2F PIC  X(0001).
  4771     05  FILLER REDEFINES CBILIT2F.
  4772         10  CBILIT2A PIC  X(0001).
  4773     05  CBILIT2I PIC  X(0008).
  4774*    -------------------------------
  4775     05  CDRFND2L PIC S9(0004) COMP.
  4776     05  CDRFND2F PIC  X(0001).
  4777     05  FILLER REDEFINES CDRFND2F.
  4778         10  CDRFND2A PIC  X(0001).
  4779     05  CDRFND2I PIC  X(0011).
  4780*    -------------------------------
  4781     05  CCANTXTL PIC S9(0004) COMP.
  4782     05  CCANTXTF PIC  X(0001).
  4783     05  FILLER REDEFINES CCANTXTF.
  4784         10  CCANTXTA PIC  X(0001).
  4785     05  CCANTXTI PIC  X(0005).
  4786*    -------------------------------
  4787     05  CCANFEEL PIC S9(0004) COMP.
  4788     05  CCANFEEF PIC  X(0001).
  4789     05  FILLER REDEFINES CCANFEEF.
  4790         10  CCANFEEA PIC  X(0001).
  4791     05  CCANFEEI PIC  X(0002).
  4792*    -------------------------------
  4793     05  CTERM1L PIC S9(0004) COMP.
  4794     05  CTERM1F PIC  X(0001).
  4795     05  FILLER REDEFINES CTERM1F.
  4796         10  CTERM1A PIC  X(0001).
  4797     05  CTERM1I PIC  X(0003).
  4798*    -------------------------------
  4799     05  CRTERM1L PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  90
* EL6311.cbl
  4800     05  CRTERM1F PIC  X(0001).
  4801     05  FILLER REDEFINES CRTERM1F.
  4802         10  CRTERM1A PIC  X(0001).
  4803     05  CRTERM1I PIC  X(0003).
  4804*    -------------------------------
  4805     05  CPREM1L PIC S9(0004) COMP.
  4806     05  CPREM1F PIC  X(0001).
  4807     05  FILLER REDEFINES CPREM1F.
  4808         10  CPREM1A PIC  X(0001).
  4809     05  CPREM1I PIC  X(0011).
  4810*    -------------------------------
  4811     05  CTERM2L PIC S9(0004) COMP.
  4812     05  CTERM2F PIC  X(0001).
  4813     05  FILLER REDEFINES CTERM2F.
  4814         10  CTERM2A PIC  X(0001).
  4815     05  CTERM2I PIC  X(0003).
  4816*    -------------------------------
  4817     05  CRTERM2L PIC S9(0004) COMP.
  4818     05  CRTERM2F PIC  X(0001).
  4819     05  FILLER REDEFINES CRTERM2F.
  4820         10  CRTERM2A PIC  X(0001).
  4821     05  CRTERM2I PIC  X(0003).
  4822*    -------------------------------
  4823     05  CPREM2L PIC S9(0004) COMP.
  4824     05  CPREM2F PIC  X(0001).
  4825     05  FILLER REDEFINES CPREM2F.
  4826         10  CPREM2A PIC  X(0001).
  4827     05  CPREM2I PIC  X(0011).
  4828*    -------------------------------
  4829     05  CENTRDTL PIC S9(0004) COMP.
  4830     05  CENTRDTF PIC  X(0001).
  4831     05  FILLER REDEFINES CENTRDTF.
  4832         10  CENTRDTA PIC  X(0001).
  4833     05  CENTRDTI PIC  X(0008).
  4834*    -------------------------------
  4835     05  CPAYEEL PIC S9(0004) COMP.
  4836     05  CPAYEEF PIC  X(0001).
  4837     05  FILLER REDEFINES CPAYEEF.
  4838         10  CPAYEEA PIC  X(0001).
  4839     05  CPAYEEI PIC  X(0006).
  4840*    -------------------------------
  4841     05  CRFNDSWL PIC S9(0004) COMP.
  4842     05  CRFNDSWF PIC  X(0001).
  4843     05  FILLER REDEFINES CRFNDSWF.
  4844         10  CRFNDSWA PIC  X(0001).
  4845     05  CRFNDSWI PIC  X(0003).
  4846*    -------------------------------
  4847     05  CLFHDGL PIC S9(0004) COMP.
  4848     05  CLFHDGF PIC  X(0001).
  4849     05  FILLER REDEFINES CLFHDGF.
  4850         10  CLFHDGA PIC  X(0001).
  4851     05  CLFHDGI PIC  X(0006).
  4852*    -------------------------------
  4853     05  CAHHDGL PIC S9(0004) COMP.
  4854     05  CAHHDGF PIC  X(0001).
  4855     05  FILLER REDEFINES CAHHDGF.
  4856         10  CAHHDGA PIC  X(0001).
  4857     05  CAHHDGI PIC  X(0006).
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  91
* EL6311.cbl
  4858*    -------------------------------
  4859     05  CENTDTL PIC S9(0004) COMP.
  4860     05  CENTDTF PIC  X(0001).
  4861     05  FILLER REDEFINES CENTDTF.
  4862         10  CENTDTA PIC  X(0001).
  4863     05  CENTDTI PIC  X(0008).
  4864*    -------------------------------
  4865     05  CENTBYL PIC S9(0004) COMP.
  4866     05  CENTBYF PIC  X(0001).
  4867     05  FILLER REDEFINES CENTBYF.
  4868         10  CENTBYA PIC  X(0001).
  4869     05  CENTBYI PIC  X(0004).
  4870*    -------------------------------
  4871     05  CCHGCNTL PIC S9(0004) COMP.
  4872     05  CCHGCNTF PIC  X(0001).
  4873     05  FILLER REDEFINES CCHGCNTF.
  4874         10  CCHGCNTA PIC  X(0001).
  4875     05  CCHGCNTI PIC  X(0003).
  4876*    -------------------------------
  4877     05  CLFREFNL PIC S9(0004) COMP.
  4878     05  CLFREFNF PIC  X(0001).
  4879     05  FILLER REDEFINES CLFREFNF.
  4880         10  CLFREFNA PIC  X(0001).
  4881     05  CLFREFNI PIC  X(0006).
  4882*    -------------------------------
  4883     05  CAHREFNL PIC S9(0004) COMP.
  4884     05  CAHREFNF PIC  X(0001).
  4885     05  FILLER REDEFINES CAHREFNF.
  4886         10  CAHREFNA PIC  X(0001).
  4887     05  CAHREFNI PIC  X(0006).
  4888*    -------------------------------
  4889     05  CREINCDL PIC S9(0004) COMP.
  4890     05  CREINCDF PIC  X(0001).
  4891     05  FILLER REDEFINES CREINCDF.
  4892         10  CREINCDA PIC  X(0001).
  4893     05  CREINCDI PIC  X(0003).
  4894*    -------------------------------
  4895     05  CAEFFDTL PIC S9(0004) COMP.
  4896     05  CAEFFDTF PIC  X(0001).
  4897     05  FILLER REDEFINES CAEFFDTF.
  4898         10  CAEFFDTA PIC  X(0001).
  4899     05  CAEFFDTI PIC  X(0008).
  4900*    -------------------------------
  4901     05  CAEXPDTL PIC S9(0004) COMP.
  4902     05  CAEXPDTF PIC  X(0001).
  4903     05  FILLER REDEFINES CAEXPDTF.
  4904         10  CAEXPDTA PIC  X(0001).
  4905     05  CAEXPDTI PIC  X(0008).
  4906*    -------------------------------
  4907     05  COMMLFL PIC S9(0004) COMP.
  4908     05  COMMLFF PIC  X(0001).
  4909     05  FILLER REDEFINES COMMLFF.
  4910         10  COMMLFA PIC  X(0001).
  4911     05  COMMLFI PIC  X(0006).
  4912*    -------------------------------
  4913     05  COMMAHL PIC S9(0004) COMP.
  4914     05  COMMAHF PIC  X(0001).
  4915     05  FILLER REDEFINES COMMAHF.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  92
* EL6311.cbl
  4916         10  COMMAHA PIC  X(0001).
  4917     05  COMMAHI PIC  X(0006).
  4918*    -------------------------------
  4919     05  CERMSG1L PIC S9(0004) COMP.
  4920     05  CERMSG1F PIC  X(0001).
  4921     05  FILLER REDEFINES CERMSG1F.
  4922         10  CERMSG1A PIC  X(0001).
  4923     05  CERMSG1I PIC  X(0078).
  4924*    -------------------------------
  4925     05  CERMSG2L PIC S9(0004) COMP.
  4926     05  CERMSG2F PIC  X(0001).
  4927     05  FILLER REDEFINES CERMSG2F.
  4928         10  CERMSG2A PIC  X(0001).
  4929     05  CERMSG2I PIC  X(0078).
  4930*    -------------------------------
  4931     05  CERMSG3L PIC S9(0004) COMP.
  4932     05  CERMSG3F PIC  X(0001).
  4933     05  FILLER REDEFINES CERMSG3F.
  4934         10  CERMSG3A PIC  X(0001).
  4935     05  CERMSG3I PIC  X(0078).
  4936*    -------------------------------
  4937     05  CPFENTRL PIC S9(0004) COMP.
  4938     05  CPFENTRF PIC  X(0001).
  4939     05  FILLER REDEFINES CPFENTRF.
  4940         10  CPFENTRA PIC  X(0001).
  4941     05  CPFENTRI PIC  9(2).
  4942*    -------------------------------
  4943     05  CPF5HDRL PIC S9(0004) COMP.
  4944     05  CPF5HDRF PIC  X(0001).
  4945     05  FILLER REDEFINES CPF5HDRF.
  4946         10  CPF5HDRA PIC  X(0001).
  4947     05  CPF5HDRI PIC  X(0005).
  4948*    -------------------------------
  4949     05  CPF4HDRL PIC S9(0004) COMP.
  4950     05  CPF4HDRF PIC  X(0001).
  4951     05  FILLER REDEFINES CPF4HDRF.
  4952         10  CPF4HDRA PIC  X(0001).
  4953     05  CPF4HDRI PIC  X(0013).
  4954*    -------------------------------
  4955     05  CF15HDRL PIC S9(0004) COMP.
  4956     05  CF15HDRF PIC  X(0001).
  4957     05  FILLER REDEFINES CF15HDRF.
  4958         10  CF15HDRA PIC  X(0001).
  4959     05  CF15HDRI PIC  X(0022).
  4960 01  EL631CO REDEFINES EL631BI.
  4961     05  FILLER            PIC  X(0012).
  4962*    -------------------------------
  4963     05  FILLER            PIC  X(0003).
  4964     05  CDATEO PIC  X(0008).
  4965*    -------------------------------
  4966     05  FILLER            PIC  X(0003).
  4967     05  CTIMEO PIC  99.99.
  4968*    -------------------------------
  4969     05  FILLER            PIC  X(0003).
  4970     05  CHEADO PIC  X(0038).
  4971*    -------------------------------
  4972     05  FILLER            PIC  X(0003).
  4973     05  CCHGTO PIC  X(0004).
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  93
* EL6311.cbl
  4974*    -------------------------------
  4975     05  FILLER            PIC  X(0003).
  4976     05  CCHGO PIC  ZZZ9.
  4977*    -------------------------------
  4978     05  FILLER            PIC  X(0003).
  4979     05  CMAINTO PIC  X(0001).
  4980*    -------------------------------
  4981     05  FILLER            PIC  X(0003).
  4982     05  CMANTBYO PIC  X(0004).
  4983*    -------------------------------
  4984     05  FILLER            PIC  X(0003).
  4985     05  CCHGHDGO PIC  X(0003).
  4986*    -------------------------------
  4987     05  FILLER            PIC  X(0003).
  4988     05  CMANTDTO PIC  X(0008).
  4989*    -------------------------------
  4990     05  FILLER            PIC  X(0003).
  4991     05  CMANTATO PIC  99.99.
  4992*    -------------------------------
  4993     05  FILLER            PIC  X(0003).
  4994     05  CCSRO PIC  X(0004).
  4995*    -------------------------------
  4996     05  FILLER            PIC  X(0003).
  4997     05  CBATCHO PIC  X(0006).
  4998*    -------------------------------
  4999     05  FILLER            PIC  X(0003).
  5000     05  CSEQO PIC  X(0004).
  5001*    -------------------------------
  5002     05  FILLER            PIC  X(0003).
  5003     05  CMOENDTO PIC  X(0008).
  5004*    -------------------------------
  5005     05  FILLER            PIC  X(0003).
  5006     05  CCARRO PIC  X(0001).
  5007*    -------------------------------
  5008     05  FILLER            PIC  X(0003).
  5009     05  CGROUPO PIC  X(0006).
  5010*    -------------------------------
  5011     05  FILLER            PIC  X(0003).
  5012     05  CSTATEO PIC  X(0002).
  5013*    -------------------------------
  5014     05  FILLER            PIC  X(0003).
  5015     05  CACCTO PIC  X(0010).
  5016*    -------------------------------
  5017     05  FILLER            PIC  X(0003).
  5018     05  CORIGHDO PIC  X(0011).
  5019*    -------------------------------
  5020     05  FILLER            PIC  X(0003).
  5021     05  CORGNOO PIC  X(0006).
  5022*    -------------------------------
  5023     05  FILLER            PIC  X(0003).
  5024     05  CORGSEQO PIC  X(0004).
  5025*    -------------------------------
  5026     05  FILLER            PIC  X(0003).
  5027     05  CREFHDGO PIC  X(0010).
  5028*    -------------------------------
  5029     05  FILLER            PIC  X(0003).
  5030     05  CREFO PIC  X(0012).
  5031*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  94
* EL6311.cbl
  5032     05  FILLER            PIC  X(0003).
  5033     05  CNHINTO PIC  ZZZZZ9.99.
  5034*    -------------------------------
  5035     05  FILLER            PIC  X(0003).
  5036     05  CCERTNOO PIC  X(0010).
  5037*    -------------------------------
  5038     05  FILLER            PIC  X(0003).
  5039     05  CSUFIXO PIC  X(0001).
  5040*    -------------------------------
  5041     05  FILLER            PIC  X(0003).
  5042     05  CEFFDTO PIC  X(0008).
  5043*    -------------------------------
  5044     05  FILLER            PIC  X(0003).
  5045     05  CLSTNMO PIC  X(0015).
  5046*    -------------------------------
  5047     05  FILLER            PIC  X(0003).
  5048     05  CINAMEO PIC  X(0015).
  5049*    -------------------------------
  5050     05  FILLER            PIC  X(0003).
  5051     05  CINITSO PIC  X(0010).
  5052*    -------------------------------
  5053     05  FILLER            PIC  X(0003).
  5054     05  CCANREAO PIC  X(0001).
  5055*    -------------------------------
  5056     05  FILLER            PIC  X(0003).
  5057     05  ACTSPCO PIC  X(0001).
  5058*    -------------------------------
  5059     05  FILLER            PIC  X(0003).
  5060     05  CKIND1O PIC  X(0002).
  5061*    -------------------------------
  5062     05  FILLER            PIC  X(0003).
  5063     05  CCANDT1O PIC  X(0008).
  5064*    -------------------------------
  5065     05  FILLER            PIC  X(0003).
  5066     05  CREFND1O PIC  Z(7).99-.
  5067*    -------------------------------
  5068     05  FILLER            PIC  X(0003).
  5069     05  CMTHD1O PIC  X(0001).
  5070*    -------------------------------
  5071     05  FILLER            PIC  X(0003).
  5072     05  CKIND2O PIC  X(0002).
  5073*    -------------------------------
  5074     05  FILLER            PIC  X(0003).
  5075     05  CCANDT2O PIC  X(0008).
  5076*    -------------------------------
  5077     05  FILLER            PIC  X(0003).
  5078     05  CREFND2O PIC  Z(7).99-.
  5079*    -------------------------------
  5080     05  FILLER            PIC  X(0003).
  5081     05  CMTHD2O PIC  X(0001).
  5082*    -------------------------------
  5083     05  FILLER            PIC  X(0003).
  5084     05  CLIVESO PIC  X(0003).
  5085*    -------------------------------
  5086     05  FILLER            PIC  X(0003).
  5087     05  CFORCEO PIC  X(0001).
  5088*    -------------------------------
  5089     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  95
* EL6311.cbl
  5090     05  CBILCDO PIC  X(0001).
  5091*    -------------------------------
  5092     05  FILLER            PIC  X(0003).
  5093     05  CCRFND1O PIC  Z(7).99-.
  5094*    -------------------------------
  5095     05  FILLER            PIC  X(0003).
  5096     05  CCRFND2O PIC  Z(7).99-.
  5097*    -------------------------------
  5098     05  FILLER            PIC  X(0003).
  5099     05  CBILIT1O PIC  X(0008).
  5100*    -------------------------------
  5101     05  FILLER            PIC  X(0003).
  5102     05  CDRFND1O PIC  Z(7).99-.
  5103*    -------------------------------
  5104     05  FILLER            PIC  X(0003).
  5105     05  CBILIT2O PIC  X(0008).
  5106*    -------------------------------
  5107     05  FILLER            PIC  X(0003).
  5108     05  CDRFND2O PIC  Z(7).99-.
  5109*    -------------------------------
  5110     05  FILLER            PIC  X(0003).
  5111     05  CCANTXTO PIC  X(0005).
  5112*    -------------------------------
  5113     05  FILLER            PIC  X(0003).
  5114     05  CCANFEEO PIC  Z9.
  5115*    -------------------------------
  5116     05  FILLER            PIC  X(0003).
  5117     05  CTERM1O PIC  ZZ9.
  5118*    -------------------------------
  5119     05  FILLER            PIC  X(0003).
  5120     05  CRTERM1O PIC  ZZ9.
  5121*    -------------------------------
  5122     05  FILLER            PIC  X(0003).
  5123     05  CPREM1O PIC  ZZZZZZ9.99-.
  5124*    -------------------------------
  5125     05  FILLER            PIC  X(0003).
  5126     05  CTERM2O PIC  ZZ9.
  5127*    -------------------------------
  5128     05  FILLER            PIC  X(0003).
  5129     05  CRTERM2O PIC  ZZ9.
  5130*    -------------------------------
  5131     05  FILLER            PIC  X(0003).
  5132     05  CPREM2O PIC  ZZZZZZ9.99-.
  5133*    -------------------------------
  5134     05  FILLER            PIC  X(0003).
  5135     05  CENTRDTO PIC  X(0008).
  5136*    -------------------------------
  5137     05  FILLER            PIC  X(0003).
  5138     05  CPAYEEO PIC  X(0006).
  5139*    -------------------------------
  5140     05  FILLER            PIC  X(0003).
  5141     05  CRFNDSWO PIC  X(0003).
  5142*    -------------------------------
  5143     05  FILLER            PIC  X(0003).
  5144     05  CLFHDGO PIC  X(0006).
  5145*    -------------------------------
  5146     05  FILLER            PIC  X(0003).
  5147     05  CAHHDGO PIC  X(0006).
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  96
* EL6311.cbl
  5148*    -------------------------------
  5149     05  FILLER            PIC  X(0003).
  5150     05  CENTDTO PIC  X(0008).
  5151*    -------------------------------
  5152     05  FILLER            PIC  X(0003).
  5153     05  CENTBYO PIC  X(0004).
  5154*    -------------------------------
  5155     05  FILLER            PIC  X(0003).
  5156     05  CCHGCNTO PIC  X(0003).
  5157*    -------------------------------
  5158     05  FILLER            PIC  X(0003).
  5159     05  CLFREFNO PIC  X(0006).
  5160*    -------------------------------
  5161     05  FILLER            PIC  X(0003).
  5162     05  CAHREFNO PIC  X(0006).
  5163*    -------------------------------
  5164     05  FILLER            PIC  X(0003).
  5165     05  CREINCDO PIC  X(0003).
  5166*    -------------------------------
  5167     05  FILLER            PIC  X(0003).
  5168     05  CAEFFDTO PIC  X(0008).
  5169*    -------------------------------
  5170     05  FILLER            PIC  X(0003).
  5171     05  CAEXPDTO PIC  X(0008).
  5172*    -------------------------------
  5173     05  FILLER            PIC  X(0003).
  5174     05  COMMLFO PIC  .99999.
  5175*    -------------------------------
  5176     05  FILLER            PIC  X(0003).
  5177     05  COMMAHO PIC  .99999.
  5178*    -------------------------------
  5179     05  FILLER            PIC  X(0003).
  5180     05  CERMSG1O PIC  X(0078).
  5181*    -------------------------------
  5182     05  FILLER            PIC  X(0003).
  5183     05  CERMSG2O PIC  X(0078).
  5184*    -------------------------------
  5185     05  FILLER            PIC  X(0003).
  5186     05  CERMSG3O PIC  X(0078).
  5187*    -------------------------------
  5188     05  FILLER            PIC  X(0003).
  5189     05  CPFENTRO PIC  X(0002).
  5190*    -------------------------------
  5191     05  FILLER            PIC  X(0003).
  5192     05  CPF5HDRO PIC  X(0005).
  5193*    -------------------------------
  5194     05  FILLER            PIC  X(0003).
  5195     05  CPF4HDRO PIC  X(0013).
  5196*    -------------------------------
  5197     05  FILLER            PIC  X(0003).
  5198     05  CF15HDRO PIC  X(0022).
  5199*    -------------------------------
  5200 01  EL631DI REDEFINES EL631BI.
  5201     05  FILLER            PIC  X(0012).
  5202*    -------------------------------
  5203     05  DDATEL PIC S9(0004) COMP.
  5204     05  DDATEF PIC  X(0001).
  5205     05  FILLER REDEFINES DDATEF.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  97
* EL6311.cbl
  5206         10  DDATEA PIC  X(0001).
  5207     05  DDATEI PIC  X(0008).
  5208*    -------------------------------
  5209     05  DTIMEL PIC S9(0004) COMP.
  5210     05  DTIMEF PIC  X(0001).
  5211     05  FILLER REDEFINES DTIMEF.
  5212         10  DTIMEA PIC  X(0001).
  5213     05  DTIMEI PIC  X(0005).
  5214*    -------------------------------
  5215     05  DHEADL PIC S9(0004) COMP.
  5216     05  DHEADF PIC  X(0001).
  5217     05  FILLER REDEFINES DHEADF.
  5218         10  DHEADA PIC  X(0001).
  5219     05  DHEADI PIC  X(0038).
  5220*    -------------------------------
  5221     05  DLDATEL PIC S9(0004) COMP.
  5222     05  DLDATEF PIC  X(0001).
  5223     05  FILLER REDEFINES DLDATEF.
  5224         10  DLDATEA PIC  X(0001).
  5225     05  DLDATEI PIC  X(0010).
  5226*    -------------------------------
  5227     05  DBATCHL PIC S9(0004) COMP.
  5228     05  DBATCHF PIC  X(0001).
  5229     05  FILLER REDEFINES DBATCHF.
  5230         10  DBATCHA PIC  X(0001).
  5231     05  DBATCHI PIC  X(0011).
  5232*    -------------------------------
  5233     05  DACCTNML PIC S9(0004) COMP.
  5234     05  DACCTNMF PIC  X(0001).
  5235     05  FILLER REDEFINES DACCTNMF.
  5236         10  DACCTNMA PIC  X(0001).
  5237     05  DACCTNMI PIC  X(0030).
  5238*    -------------------------------
  5239     05  DPROCDTL PIC S9(0004) COMP.
  5240     05  DPROCDTF PIC  X(0001).
  5241     05  FILLER REDEFINES DPROCDTF.
  5242         10  DPROCDTA PIC  X(0001).
  5243     05  DPROCDTI PIC  X(0008).
  5244*    -------------------------------
  5245     05  DINPUTL PIC S9(0004) COMP.
  5246     05  DINPUTF PIC  X(0001).
  5247     05  FILLER REDEFINES DINPUTF.
  5248         10  DINPUTA PIC  X(0001).
  5249     05  DINPUTI PIC  X(0008).
  5250*    -------------------------------
  5251     05  DMAINDTL PIC S9(0004) COMP.
  5252     05  DMAINDTF PIC  X(0001).
  5253     05  FILLER REDEFINES DMAINDTF.
  5254         10  DMAINDTA PIC  X(0001).
  5255     05  DMAINDTI PIC  X(0008).
  5256*    -------------------------------
  5257     05  DCARRL PIC S9(0004) COMP.
  5258     05  DCARRF PIC  X(0001).
  5259     05  FILLER REDEFINES DCARRF.
  5260         10  DCARRA PIC  X(0001).
  5261     05  DCARRI PIC  X(0001).
  5262*    -------------------------------
  5263     05  DGROUPL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  98
* EL6311.cbl
  5264     05  DGROUPF PIC  X(0001).
  5265     05  FILLER REDEFINES DGROUPF.
  5266         10  DGROUPA PIC  X(0001).
  5267     05  DGROUPI PIC  X(0006).
  5268*    -------------------------------
  5269     05  DSTATEL PIC S9(0004) COMP.
  5270     05  DSTATEF PIC  X(0001).
  5271     05  FILLER REDEFINES DSTATEF.
  5272         10  DSTATEA PIC  X(0001).
  5273     05  DSTATEI PIC  X(0002).
  5274*    -------------------------------
  5275     05  DACCTL PIC S9(0004) COMP.
  5276     05  DACCTF PIC  X(0001).
  5277     05  FILLER REDEFINES DACCTF.
  5278         10  DACCTA PIC  X(0001).
  5279     05  DACCTI PIC  X(0010).
  5280*    -------------------------------
  5281     05  DRECVDTL PIC S9(0004) COMP.
  5282     05  DRECVDTF PIC  X(0001).
  5283     05  FILLER REDEFINES DRECVDTF.
  5284         10  DRECVDTA PIC  X(0001).
  5285     05  DRECVDTI PIC  X(0008).
  5286*    -------------------------------
  5287     05  DCSRL PIC S9(0004) COMP.
  5288     05  DCSRF PIC  X(0001).
  5289     05  FILLER REDEFINES DCSRF.
  5290         10  DCSRA PIC  X(0001).
  5291     05  DCSRI PIC  X(0004).
  5292*    -------------------------------
  5293     05  DREFHDGL PIC S9(0004) COMP.
  5294     05  DREFHDGF PIC  X(0001).
  5295     05  FILLER REDEFINES DREFHDGF.
  5296         10  DREFHDGA PIC  X(0001).
  5297     05  DREFHDGI PIC  X(0010).
  5298*    -------------------------------
  5299     05  DREFL PIC S9(0004) COMP.
  5300     05  DREFF PIC  X(0001).
  5301     05  FILLER REDEFINES DREFF.
  5302         10  DREFA PIC  X(0001).
  5303     05  DREFI PIC  X(0012).
  5304*    -------------------------------
  5305     05  DLFPHDGL PIC S9(0004) COMP.
  5306     05  DLFPHDGF PIC  X(0001).
  5307     05  FILLER REDEFINES DLFPHDGF.
  5308         10  DLFPHDGA PIC  X(0001).
  5309     05  DLFPHDGI PIC  X(0010).
  5310*    -------------------------------
  5311     05  DAHPHDGL PIC S9(0004) COMP.
  5312     05  DAHPHDGF PIC  X(0001).
  5313     05  FILLER REDEFINES DAHPHDGF.
  5314         10  DAHPHDGA PIC  X(0001).
  5315     05  DAHPHDGI PIC  X(0010).
  5316*    -------------------------------
  5317     05  DLFRHDGL PIC S9(0004) COMP.
  5318     05  DLFRHDGF PIC  X(0001).
  5319     05  FILLER REDEFINES DLFRHDGF.
  5320         10  DLFRHDGA PIC  X(0001).
  5321     05  DLFRHDGI PIC  X(0009).
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  99
* EL6311.cbl
  5322*    -------------------------------
  5323     05  DAHRHDGL PIC S9(0004) COMP.
  5324     05  DAHRHDGF PIC  X(0001).
  5325     05  FILLER REDEFINES DAHRHDGF.
  5326         10  DAHRHDGA PIC  X(0001).
  5327     05  DAHRHDGI PIC  X(0009).
  5328*    -------------------------------
  5329     05  DRISSL PIC S9(0004) COMP.
  5330     05  DRISSF PIC  X(0001).
  5331     05  FILLER REDEFINES DRISSF.
  5332         10  DRISSA PIC  X(0001).
  5333     05  DRISSI PIC  X(0005).
  5334*    -------------------------------
  5335     05  DRLFPRML PIC S9(0004) COMP.
  5336     05  DRLFPRMF PIC  X(0001).
  5337     05  FILLER REDEFINES DRLFPRMF.
  5338         10  DRLFPRMA PIC  X(0001).
  5339     05  DRLFPRMI PIC  S9(9)V99.
  5340*    -------------------------------
  5341     05  DRAHPRML PIC S9(0004) COMP.
  5342     05  DRAHPRMF PIC  X(0001).
  5343     05  FILLER REDEFINES DRAHPRMF.
  5344         10  DRAHPRMA PIC  X(0001).
  5345     05  DRAHPRMI PIC  S9(9)V99.
  5346*    -------------------------------
  5347     05  DRCANCL PIC S9(0004) COMP.
  5348     05  DRCANCF PIC  X(0001).
  5349     05  FILLER REDEFINES DRCANCF.
  5350         10  DRCANCA PIC  X(0001).
  5351     05  DRCANCI PIC  X(0005).
  5352*    -------------------------------
  5353     05  DRLFRFDL PIC S9(0004) COMP.
  5354     05  DRLFRFDF PIC  X(0001).
  5355     05  FILLER REDEFINES DRLFRFDF.
  5356         10  DRLFRFDA PIC  X(0001).
  5357     05  DRLFRFDI PIC  S9(9)V99.
  5358*    -------------------------------
  5359     05  DRAHRFDL PIC S9(0004) COMP.
  5360     05  DRAHRFDF PIC  X(0001).
  5361     05  FILLER REDEFINES DRAHRFDF.
  5362         10  DRAHRFDA PIC  X(0001).
  5363     05  DRAHRFDI PIC  S9(9)V99.
  5364*    -------------------------------
  5365     05  DEISSL PIC S9(0004) COMP.
  5366     05  DEISSF PIC  X(0001).
  5367     05  FILLER REDEFINES DEISSF.
  5368         10  DEISSA PIC  X(0001).
  5369     05  DEISSI PIC  X(0005).
  5370*    -------------------------------
  5371     05  DELFPRML PIC S9(0004) COMP.
  5372     05  DELFPRMF PIC  X(0001).
  5373     05  FILLER REDEFINES DELFPRMF.
  5374         10  DELFPRMA PIC  X(0001).
  5375     05  DELFPRMI PIC  X(0011).
  5376*    -------------------------------
  5377     05  DEAHPRML PIC S9(0004) COMP.
  5378     05  DEAHPRMF PIC  X(0001).
  5379     05  FILLER REDEFINES DEAHPRMF.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 100
* EL6311.cbl
  5380         10  DEAHPRMA PIC  X(0001).
  5381     05  DEAHPRMI PIC  X(0011).
  5382*    -------------------------------
  5383     05  DECANCL PIC S9(0004) COMP.
  5384     05  DECANCF PIC  X(0001).
  5385     05  FILLER REDEFINES DECANCF.
  5386         10  DECANCA PIC  X(0001).
  5387     05  DECANCI PIC  X(0005).
  5388*    -------------------------------
  5389     05  DELFRFDL PIC S9(0004) COMP.
  5390     05  DELFRFDF PIC  X(0001).
  5391     05  FILLER REDEFINES DELFRFDF.
  5392         10  DELFRFDA PIC  X(0001).
  5393     05  DELFRFDI PIC  X(0011).
  5394*    -------------------------------
  5395     05  DEAHRFDL PIC S9(0004) COMP.
  5396     05  DEAHRFDF PIC  X(0001).
  5397     05  FILLER REDEFINES DEAHRFDF.
  5398         10  DEAHRFDA PIC  X(0001).
  5399     05  DEAHRFDI PIC  X(0011).
  5400*    -------------------------------
  5401     05  DCISSL PIC S9(0004) COMP.
  5402     05  DCISSF PIC  X(0001).
  5403     05  FILLER REDEFINES DCISSF.
  5404         10  DCISSA PIC  X(0001).
  5405     05  DCISSI PIC  X(0005).
  5406*    -------------------------------
  5407     05  DCLFPRML PIC S9(0004) COMP.
  5408     05  DCLFPRMF PIC  X(0001).
  5409     05  FILLER REDEFINES DCLFPRMF.
  5410         10  DCLFPRMA PIC  X(0001).
  5411     05  DCLFPRMI PIC  X(0011).
  5412*    -------------------------------
  5413     05  DCAHPRML PIC S9(0004) COMP.
  5414     05  DCAHPRMF PIC  X(0001).
  5415     05  FILLER REDEFINES DCAHPRMF.
  5416         10  DCAHPRMA PIC  X(0001).
  5417     05  DCAHPRMI PIC  X(0011).
  5418*    -------------------------------
  5419     05  DCCANCL PIC S9(0004) COMP.
  5420     05  DCCANCF PIC  X(0001).
  5421     05  FILLER REDEFINES DCCANCF.
  5422         10  DCCANCA PIC  X(0001).
  5423     05  DCCANCI PIC  X(0005).
  5424*    -------------------------------
  5425     05  DCLFRFDL PIC S9(0004) COMP.
  5426     05  DCLFRFDF PIC  X(0001).
  5427     05  FILLER REDEFINES DCLFRFDF.
  5428         10  DCLFRFDA PIC  X(0001).
  5429     05  DCLFRFDI PIC  X(0011).
  5430*    -------------------------------
  5431     05  DCAHRFDL PIC S9(0004) COMP.
  5432     05  DCAHRFDF PIC  X(0001).
  5433     05  FILLER REDEFINES DCAHRFDF.
  5434         10  DCAHRFDA PIC  X(0001).
  5435     05  DCAHRFDI PIC  X(0011).
  5436*    -------------------------------
  5437     05  DOISSL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 101
* EL6311.cbl
  5438     05  DOISSF PIC  X(0001).
  5439     05  FILLER REDEFINES DOISSF.
  5440         10  DOISSA PIC  X(0001).
  5441     05  DOISSI PIC  X(0005).
  5442*    -------------------------------
  5443     05  DOLFPRML PIC S9(0004) COMP.
  5444     05  DOLFPRMF PIC  X(0001).
  5445     05  FILLER REDEFINES DOLFPRMF.
  5446         10  DOLFPRMA PIC  X(0001).
  5447     05  DOLFPRMI PIC  X(0011).
  5448*    -------------------------------
  5449     05  DOAHPRML PIC S9(0004) COMP.
  5450     05  DOAHPRMF PIC  X(0001).
  5451     05  FILLER REDEFINES DOAHPRMF.
  5452         10  DOAHPRMA PIC  X(0001).
  5453     05  DOAHPRMI PIC  X(0011).
  5454*    -------------------------------
  5455     05  DOCANCL PIC S9(0004) COMP.
  5456     05  DOCANCF PIC  X(0001).
  5457     05  FILLER REDEFINES DOCANCF.
  5458         10  DOCANCA PIC  X(0001).
  5459     05  DOCANCI PIC  X(0005).
  5460*    -------------------------------
  5461     05  DOLFRFDL PIC S9(0004) COMP.
  5462     05  DOLFRFDF PIC  X(0001).
  5463     05  FILLER REDEFINES DOLFRFDF.
  5464         10  DOLFRFDA PIC  X(0001).
  5465     05  DOLFRFDI PIC  X(0011).
  5466*    -------------------------------
  5467     05  DOAHRFDL PIC S9(0004) COMP.
  5468     05  DOAHRFDF PIC  X(0001).
  5469     05  FILLER REDEFINES DOAHRFDF.
  5470         10  DOAHRFDA PIC  X(0001).
  5471     05  DOAHRFDI PIC  X(0011).
  5472*    -------------------------------
  5473     05  DITOTALL PIC S9(0004) COMP.
  5474     05  DITOTALF PIC  X(0001).
  5475     05  FILLER REDEFINES DITOTALF.
  5476         10  DITOTALA PIC  X(0001).
  5477     05  DITOTALI PIC  X(0005).
  5478*    -------------------------------
  5479     05  DIFATALL PIC S9(0004) COMP.
  5480     05  DIFATALF PIC  X(0001).
  5481     05  FILLER REDEFINES DIFATALF.
  5482         10  DIFATALA PIC  X(0001).
  5483     05  DIFATALI PIC  X(0005).
  5484*    -------------------------------
  5485     05  DIFORCEL PIC S9(0004) COMP.
  5486     05  DIFORCEF PIC  X(0001).
  5487     05  FILLER REDEFINES DIFORCEF.
  5488         10  DIFORCEA PIC  X(0001).
  5489     05  DIFORCEI PIC  X(0005).
  5490*    -------------------------------
  5491     05  DIHOLDL PIC S9(0004) COMP.
  5492     05  DIHOLDF PIC  X(0001).
  5493     05  FILLER REDEFINES DIHOLDF.
  5494         10  DIHOLDA PIC  X(0001).
  5495     05  DIHOLDI PIC  X(0005).
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 102
* EL6311.cbl
  5496*    -------------------------------
  5497     05  DIAVAILL PIC S9(0004) COMP.
  5498     05  DIAVAILF PIC  X(0001).
  5499     05  FILLER REDEFINES DIAVAILF.
  5500         10  DIAVAILA PIC  X(0001).
  5501     05  DIAVAILI PIC  X(0005).
  5502*    -------------------------------
  5503     05  DIGPREML PIC S9(0004) COMP.
  5504     05  DIGPREMF PIC  X(0001).
  5505     05  FILLER REDEFINES DIGPREMF.
  5506         10  DIGPREMA PIC  X(0001).
  5507     05  DIGPREMI PIC  X(0011).
  5508*    -------------------------------
  5509     05  DIBPREML PIC S9(0004) COMP.
  5510     05  DIBPREMF PIC  X(0001).
  5511     05  FILLER REDEFINES DIBPREMF.
  5512         10  DIBPREMA PIC  X(0001).
  5513     05  DIBPREMI PIC  X(0011).
  5514*    -------------------------------
  5515     05  DCTOTALL PIC S9(0004) COMP.
  5516     05  DCTOTALF PIC  X(0001).
  5517     05  FILLER REDEFINES DCTOTALF.
  5518         10  DCTOTALA PIC  X(0001).
  5519     05  DCTOTALI PIC  X(0005).
  5520*    -------------------------------
  5521     05  DCFATALL PIC S9(0004) COMP.
  5522     05  DCFATALF PIC  X(0001).
  5523     05  FILLER REDEFINES DCFATALF.
  5524         10  DCFATALA PIC  X(0001).
  5525     05  DCFATALI PIC  X(0005).
  5526*    -------------------------------
  5527     05  DCFORCEL PIC S9(0004) COMP.
  5528     05  DCFORCEF PIC  X(0001).
  5529     05  FILLER REDEFINES DCFORCEF.
  5530         10  DCFORCEA PIC  X(0001).
  5531     05  DCFORCEI PIC  X(0005).
  5532*    -------------------------------
  5533     05  DCHOLDL PIC S9(0004) COMP.
  5534     05  DCHOLDF PIC  X(0001).
  5535     05  FILLER REDEFINES DCHOLDF.
  5536         10  DCHOLDA PIC  X(0001).
  5537     05  DCHOLDI PIC  X(0005).
  5538*    -------------------------------
  5539     05  DCAVAILL PIC S9(0004) COMP.
  5540     05  DCAVAILF PIC  X(0001).
  5541     05  FILLER REDEFINES DCAVAILF.
  5542         10  DCAVAILA PIC  X(0001).
  5543     05  DCAVAILI PIC  X(0005).
  5544*    -------------------------------
  5545     05  DCGPREML PIC S9(0004) COMP.
  5546     05  DCGPREMF PIC  X(0001).
  5547     05  FILLER REDEFINES DCGPREMF.
  5548         10  DCGPREMA PIC  X(0001).
  5549     05  DCGPREMI PIC  X(0011).
  5550*    -------------------------------
  5551     05  DCBPREML PIC S9(0004) COMP.
  5552     05  DCBPREMF PIC  X(0001).
  5553     05  FILLER REDEFINES DCBPREMF.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 103
* EL6311.cbl
  5554         10  DCBPREMA PIC  X(0001).
  5555     05  DCBPREMI PIC  X(0011).
  5556*    -------------------------------
  5557     05  DNTOTALL PIC S9(0004) COMP.
  5558     05  DNTOTALF PIC  X(0001).
  5559     05  FILLER REDEFINES DNTOTALF.
  5560         10  DNTOTALA PIC  X(0001).
  5561     05  DNTOTALI PIC  X(0005).
  5562*    -------------------------------
  5563     05  DNFATALL PIC S9(0004) COMP.
  5564     05  DNFATALF PIC  X(0001).
  5565     05  FILLER REDEFINES DNFATALF.
  5566         10  DNFATALA PIC  X(0001).
  5567     05  DNFATALI PIC  X(0005).
  5568*    -------------------------------
  5569     05  DNFORCEL PIC S9(0004) COMP.
  5570     05  DNFORCEF PIC  X(0001).
  5571     05  FILLER REDEFINES DNFORCEF.
  5572         10  DNFORCEA PIC  X(0001).
  5573     05  DNFORCEI PIC  X(0005).
  5574*    -------------------------------
  5575     05  DNHOLDL PIC S9(0004) COMP.
  5576     05  DNHOLDF PIC  X(0001).
  5577     05  FILLER REDEFINES DNHOLDF.
  5578         10  DNHOLDA PIC  X(0001).
  5579     05  DNHOLDI PIC  X(0005).
  5580*    -------------------------------
  5581     05  DNAVAILL PIC S9(0004) COMP.
  5582     05  DNAVAILF PIC  X(0001).
  5583     05  FILLER REDEFINES DNAVAILF.
  5584         10  DNAVAILA PIC  X(0001).
  5585     05  DNAVAILI PIC  X(0005).
  5586*    -------------------------------
  5587     05  DNGPREML PIC S9(0004) COMP.
  5588     05  DNGPREMF PIC  X(0001).
  5589     05  FILLER REDEFINES DNGPREMF.
  5590         10  DNGPREMA PIC  X(0001).
  5591     05  DNGPREMI PIC  X(0011).
  5592*    -------------------------------
  5593     05  DNBPREML PIC S9(0004) COMP.
  5594     05  DNBPREMF PIC  X(0001).
  5595     05  FILLER REDEFINES DNBPREMF.
  5596         10  DNBPREMA PIC  X(0001).
  5597     05  DNBPREMI PIC  X(0011).
  5598*    -------------------------------
  5599     05  DERMSGL PIC S9(0004) COMP.
  5600     05  DERMSGF PIC  X(0001).
  5601     05  FILLER REDEFINES DERMSGF.
  5602         10  DERMSGA PIC  X(0001).
  5603     05  DERMSGI PIC  X(0075).
  5604*    -------------------------------
  5605     05  DPFENTRL PIC S9(0004) COMP.
  5606     05  DPFENTRF PIC  X(0001).
  5607     05  FILLER REDEFINES DPFENTRF.
  5608         10  DPFENTRA PIC  X(0001).
  5609     05  DPFENTRI PIC  9(2).
  5610 01  EL631DO REDEFINES EL631BI.
  5611     05  FILLER            PIC  X(0012).
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 104
* EL6311.cbl
  5612*    -------------------------------
  5613     05  FILLER            PIC  X(0003).
  5614     05  DDATEO PIC  X(0008).
  5615*    -------------------------------
  5616     05  FILLER            PIC  X(0003).
  5617     05  DTIMEO PIC  99.99.
  5618*    -------------------------------
  5619     05  FILLER            PIC  X(0003).
  5620     05  DHEADO PIC  X(0038).
  5621*    -------------------------------
  5622     05  FILLER            PIC  X(0003).
  5623     05  DLDATEO PIC  X(0010).
  5624*    -------------------------------
  5625     05  FILLER            PIC  X(0003).
  5626     05  DBATCHO PIC  X(0011).
  5627*    -------------------------------
  5628     05  FILLER            PIC  X(0003).
  5629     05  DACCTNMO PIC  X(0030).
  5630*    -------------------------------
  5631     05  FILLER            PIC  X(0003).
  5632     05  DPROCDTO PIC  X(0008).
  5633*    -------------------------------
  5634     05  FILLER            PIC  X(0003).
  5635     05  DINPUTO PIC  X(0008).
  5636*    -------------------------------
  5637     05  FILLER            PIC  X(0003).
  5638     05  DMAINDTO PIC  X(0008).
  5639*    -------------------------------
  5640     05  FILLER            PIC  X(0003).
  5641     05  DCARRO PIC  X(0001).
  5642*    -------------------------------
  5643     05  FILLER            PIC  X(0003).
  5644     05  DGROUPO PIC  X(0006).
  5645*    -------------------------------
  5646     05  FILLER            PIC  X(0003).
  5647     05  DSTATEO PIC  X(0002).
  5648*    -------------------------------
  5649     05  FILLER            PIC  X(0003).
  5650     05  DACCTO PIC  X(0010).
  5651*    -------------------------------
  5652     05  FILLER            PIC  X(0003).
  5653     05  DRECVDTO PIC  X(0008).
  5654*    -------------------------------
  5655     05  FILLER            PIC  X(0003).
  5656     05  DCSRO PIC  X(0004).
  5657*    -------------------------------
  5658     05  FILLER            PIC  X(0003).
  5659     05  DREFHDGO PIC  X(0010).
  5660*    -------------------------------
  5661     05  FILLER            PIC  X(0003).
  5662     05  DREFO PIC  X(0012).
  5663*    -------------------------------
  5664     05  FILLER            PIC  X(0003).
  5665     05  DLFPHDGO PIC  X(0010).
  5666*    -------------------------------
  5667     05  FILLER            PIC  X(0003).
  5668     05  DAHPHDGO PIC  X(0010).
  5669*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 105
* EL6311.cbl
  5670     05  FILLER            PIC  X(0003).
  5671     05  DLFRHDGO PIC  X(0009).
  5672*    -------------------------------
  5673     05  FILLER            PIC  X(0003).
  5674     05  DAHRHDGO PIC  X(0009).
  5675*    -------------------------------
  5676     05  FILLER            PIC  X(0003).
  5677     05  DRISSO PIC  ZZ99-.
  5678*    -------------------------------
  5679     05  FILLER            PIC  X(0003).
  5680     05  DRLFPRMO PIC  ZZZZZZ9.99-.
  5681*    -------------------------------
  5682     05  FILLER            PIC  X(0003).
  5683     05  DRAHPRMO PIC  ZZZZZZ9.99-.
  5684*    -------------------------------
  5685     05  FILLER            PIC  X(0003).
  5686     05  DRCANCO PIC  ZZ99-.
  5687*    -------------------------------
  5688     05  FILLER            PIC  X(0003).
  5689     05  DRLFRFDO PIC  ZZZZZZ9.99-.
  5690*    -------------------------------
  5691     05  FILLER            PIC  X(0003).
  5692     05  DRAHRFDO PIC  ZZZZZZ9.99-.
  5693*    -------------------------------
  5694     05  FILLER            PIC  X(0003).
  5695     05  DEISSO PIC  ZZ99-.
  5696*    -------------------------------
  5697     05  FILLER            PIC  X(0003).
  5698     05  DELFPRMO PIC  ZZZZZZ9.99-.
  5699*    -------------------------------
  5700     05  FILLER            PIC  X(0003).
  5701     05  DEAHPRMO PIC  ZZZZZZ9.99-.
  5702*    -------------------------------
  5703     05  FILLER            PIC  X(0003).
  5704     05  DECANCO PIC  ZZ99-.
  5705*    -------------------------------
  5706     05  FILLER            PIC  X(0003).
  5707     05  DELFRFDO PIC  ZZZZZZ9.99-.
  5708*    -------------------------------
  5709     05  FILLER            PIC  X(0003).
  5710     05  DEAHRFDO PIC  ZZZZZZ9.99-.
  5711*    -------------------------------
  5712     05  FILLER            PIC  X(0003).
  5713     05  DCISSO PIC  ZZ99-.
  5714*    -------------------------------
  5715     05  FILLER            PIC  X(0003).
  5716     05  DCLFPRMO PIC  ZZZZZZ9.99-.
  5717*    -------------------------------
  5718     05  FILLER            PIC  X(0003).
  5719     05  DCAHPRMO PIC  ZZZZZZ9.99-.
  5720*    -------------------------------
  5721     05  FILLER            PIC  X(0003).
  5722     05  DCCANCO PIC  ZZ99-.
  5723*    -------------------------------
  5724     05  FILLER            PIC  X(0003).
  5725     05  DCLFRFDO PIC  ZZZZZZ9.99-.
  5726*    -------------------------------
  5727     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 106
* EL6311.cbl
  5728     05  DCAHRFDO PIC  ZZZZZZ9.99-.
  5729*    -------------------------------
  5730     05  FILLER            PIC  X(0003).
  5731     05  DOISSO PIC  ZZ99-.
  5732*    -------------------------------
  5733     05  FILLER            PIC  X(0003).
  5734     05  DOLFPRMO PIC  ZZZZZZ9.99-.
  5735*    -------------------------------
  5736     05  FILLER            PIC  X(0003).
  5737     05  DOAHPRMO PIC  ZZZZZZ9.99-.
  5738*    -------------------------------
  5739     05  FILLER            PIC  X(0003).
  5740     05  DOCANCO PIC  ZZ99-.
  5741*    -------------------------------
  5742     05  FILLER            PIC  X(0003).
  5743     05  DOLFRFDO PIC  ZZZZZZ9.99-.
  5744*    -------------------------------
  5745     05  FILLER            PIC  X(0003).
  5746     05  DOAHRFDO PIC  ZZZZZZ9.99-.
  5747*    -------------------------------
  5748     05  FILLER            PIC  X(0003).
  5749     05  DITOTALO PIC  ZZZ99.
  5750*    -------------------------------
  5751     05  FILLER            PIC  X(0003).
  5752     05  DIFATALO PIC  ZZZ99.
  5753*    -------------------------------
  5754     05  FILLER            PIC  X(0003).
  5755     05  DIFORCEO PIC  ZZZ99.
  5756*    -------------------------------
  5757     05  FILLER            PIC  X(0003).
  5758     05  DIHOLDO PIC  ZZZ99.
  5759*    -------------------------------
  5760     05  FILLER            PIC  X(0003).
  5761     05  DIAVAILO PIC  ZZZ99.
  5762*    -------------------------------
  5763     05  FILLER            PIC  X(0003).
  5764     05  DIGPREMO PIC  ZZZZZZZ9.99.
  5765*    -------------------------------
  5766     05  FILLER            PIC  X(0003).
  5767     05  DIBPREMO PIC  ZZZZZZZ9.99.
  5768*    -------------------------------
  5769     05  FILLER            PIC  X(0003).
  5770     05  DCTOTALO PIC  ZZZ99.
  5771*    -------------------------------
  5772     05  FILLER            PIC  X(0003).
  5773     05  DCFATALO PIC  ZZZ99.
  5774*    -------------------------------
  5775     05  FILLER            PIC  X(0003).
  5776     05  DCFORCEO PIC  ZZZ99.
  5777*    -------------------------------
  5778     05  FILLER            PIC  X(0003).
  5779     05  DCHOLDO PIC  ZZZ99.
  5780*    -------------------------------
  5781     05  FILLER            PIC  X(0003).
  5782     05  DCAVAILO PIC  ZZZ99.
  5783*    -------------------------------
  5784     05  FILLER            PIC  X(0003).
  5785     05  DCGPREMO PIC  ZZZZZZZ9.99.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 107
* EL6311.cbl
  5786*    -------------------------------
  5787     05  FILLER            PIC  X(0003).
  5788     05  DCBPREMO PIC  ZZZZZZZ9.99.
  5789*    -------------------------------
  5790     05  FILLER            PIC  X(0003).
  5791     05  DNTOTALO PIC  ---99.
  5792*    -------------------------------
  5793     05  FILLER            PIC  X(0003).
  5794     05  DNFATALO PIC  ---99.
  5795*    -------------------------------
  5796     05  FILLER            PIC  X(0003).
  5797     05  DNFORCEO PIC  ---99.
  5798*    -------------------------------
  5799     05  FILLER            PIC  X(0003).
  5800     05  DNHOLDO PIC  ---99.
  5801*    -------------------------------
  5802     05  FILLER            PIC  X(0003).
  5803     05  DNAVAILO PIC  ---99.
  5804*    -------------------------------
  5805     05  FILLER            PIC  X(0003).
  5806     05  DNGPREMO PIC  -------9.99.
  5807*    -------------------------------
  5808     05  FILLER            PIC  X(0003).
  5809     05  DNBPREMO PIC  -------9.99.
  5810*    -------------------------------
  5811     05  FILLER            PIC  X(0003).
  5812     05  DERMSGO PIC  X(0075).
  5813*    -------------------------------
  5814     05  FILLER            PIC  X(0003).
  5815     05  DPFENTRO PIC  X(0002).
  5816*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 108
* EL6311.cbl
  5818 01  MAP-B REDEFINES EL631BI.
  5819     12  FILLER                  PIC X(595).
  5820*    12  FILLER                  PIC X(591).
  5821*    12  FILLER                  PIC X(512).
  5822*    12  FILLER                  PIC X(510).
  5823     12  MAP-B-COVERAGE OCCURS 2 TIMES.
  5824         16  BKIND-LEN               PIC S9(4)  COMP.
  5825         16  BKIND-ATTRB             PIC X.
  5826         16  BKIND                   PIC XX.
  5827         16  BTYPE-LEN               PIC S9(4)  COMP.
  5828         16  BTYPE-ATTRB             PIC X.
  5829         16  BTYPE                   PIC X(3).
  5830         16  BTERM-LEN               PIC S9(4)  COMP.
  5831         16  BTERM-ATTRB             PIC X.
  5832         16  BTERMI                  PIC 999.
  5833         16  BTERMO REDEFINES BTERMI PIC ZZZ.
  5834         16  BBEN-LEN                PIC S9(4)  COMP.
  5835         16  BBEN-ATTRB              PIC X.
  5836         16  BBENI                   PIC 9(10)V99.
  5837*        16  BBENI                   PIC 9(12).
  5838         16  BBENO REDEFINES BBENI   PIC Z(9).99.
  5839         16  BPREM-LEN               PIC S9(4)  COMP.
  5840         16  BPREM-ATTRB             PIC X.
  5841         16  BPREMI                  PIC S9(9)V99.
  5842*        16  BPREMI                  PIC 9(11).
  5843         16  BPREMO REDEFINES BPREMI PIC Z(7).99-.
  5844         16  BPREM-ALPHA REDEFINES BPREMI PIC X(11).
  5845         16  BEXPIRE-LEN             PIC S9(4)  COMP.
  5846         16  BEXPIRE-ATTRB           PIC X.
  5847         16  BEXPIRE                 PIC X(8).
  5848         16  BCRIT-PERD-LEN          PIC S9(4)  COMP.
  5849         16  BCRIT-PERD-ATTRB        PIC X.
  5850         16  BCRIT-PERDI             PIC 99.
  5851         16  BCRIT-PERDO REDEFINES
  5852                         BCRIT-PERDI PIC ZZ.
  5853         16  BALT-BEN-LEN            PIC S9(4)  COMP.
  5854         16  BALT-BEN-ATTRB          PIC X.
  5855         16  BALT-BENI               PIC 9(10)V99.
  5856*        16  BALT-BENI               PIC 9(12).
  5857         16  BALT-BENO REDEFINES
  5858                           BALT-BENI PIC Z(9).ZZ.
  5859         16  BALT-PREM-LEN           PIC S9(4)  COMP.
  5860         16  BALT-PREM-ATTRB         PIC X.
  5861         16  BALT-PREMI              PIC 9(9)V99.
  5862*        16  BALT-PREMI              PIC 9(11).
  5863         16  BALT-PREMO REDEFINES
  5864                          BALT-PREMI PIC Z(7).ZZ-.
  5865         16  BBEN-CD-LEN             PIC S9(4)  COMP.
  5866         16  BBEN-CD-ATTRB           PIC X.
  5867         16  BBEN-CD                 PIC XXX.
  5868         16  BCPREM-LEN              PIC S9(4)  COMP.
  5869         16  BCPREM-ATTRB            PIC X.
  5870         16  BCPREMI                 PIC S9(9)V99.
  5871*        16  BCPREMI                 PIC X(11).
  5872         16  BCPREMO REDEFINES BCPREMI
  5873                                     PIC Z(7).99-.
  5874         16  BCALT-PREM-LEN          PIC S9(4)  COMP.
  5875         16  BCALT-PREM-ATTRB        PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 109
* EL6311.cbl
  5876         16  BCALT-PREM              PIC Z(7).99-.
  5877         16  BBEN-ABBR-LEN           PIC S9(4)  COMP.
  5878         16  BBEN-ABBR-ATTRB         PIC X.
  5879         16  BBEN-ABBR               PIC X(5).
  5880         16  BDIFF-LEN               PIC S9(4)  COMP.
  5881         16  BDIFF-ATTRB             PIC X.
  5882         16  BDIFFO                  PIC Z(7).99-.
  5883         16  BBILL-LIT-LEN           PIC S9(4)  COMP.
  5884         16  BBILL-LIT-ATTRB         PIC X.
  5885         16  BBILL-LIT               PIC X(8).
  5886         16  BDALT-PREM-LEN          PIC S9(4)  COMP.
  5887         16  BDALT-PREM-ATTRB        PIC X.
  5888         16  BDALT-PREM              PIC Z(7).99-.
  5889
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 110
* EL6311.cbl
  5891
  5892****************************************************************
  5893*
  5894* Copyright (c) 2007-2013 Dell Inc.
  5895* All rights reserved.
  5896*
  5897****************************************************************
  5898 01  DFHEIV.
  5899   02  DFHEIV0               PIC X(35).
  5900   02  DFHEIV1               PIC X(08).
  5901   02  DFHEIV2               PIC X(08).
  5902   02  DFHEIV3               PIC X(08).
  5903   02  DFHEIV4               PIC X(06).
  5904   02  DFHEIV5               PIC X(04).
  5905   02  DFHEIV6               PIC X(04).
  5906   02  DFHEIV7               PIC X(02).
  5907   02  DFHEIV8               PIC X(02).
  5908   02  DFHEIV9               PIC X(01).
  5909   02  DFHEIV10              PIC S9(7) COMP-3.
  5910   02  DFHEIV11              PIC S9(4) COMP SYNC.
  5911   02  DFHEIV12              PIC S9(4) COMP SYNC.
  5912   02  DFHEIV13              PIC S9(4) COMP SYNC.
  5913   02  DFHEIV14              PIC S9(4) COMP SYNC.
  5914   02  DFHEIV15              PIC S9(4) COMP SYNC.
  5915   02  DFHEIV16              PIC S9(9) COMP SYNC.
  5916   02  DFHEIV17              PIC X(04).
  5917   02  DFHEIV18              PIC X(04).
  5918   02  DFHEIV19              PIC X(04).
  5919   02  DFHEIV20              USAGE IS POINTER.
  5920   02  DFHEIV21              USAGE IS POINTER.
  5921   02  DFHEIV22              USAGE IS POINTER.
  5922   02  DFHEIV23              USAGE IS POINTER.
  5923   02  DFHEIV24              USAGE IS POINTER.
  5924   02  DFHEIV25              PIC S9(9) COMP SYNC.
  5925   02  DFHEIV26              PIC S9(9) COMP SYNC.
  5926   02  DFHEIV27              PIC S9(9) COMP SYNC.
  5927   02  DFHEIV28              PIC S9(9) COMP SYNC.
  5928   02  DFHEIV29              PIC S9(9) COMP SYNC.
  5929   02  DFHEIV30              PIC S9(9) COMP SYNC.
  5930   02  DFHEIV31              PIC S9(9) COMP SYNC.
  5931   02  DFHEIV32              PIC S9(4) COMP SYNC.
  5932   02  DFHEIV33              PIC S9(4) COMP SYNC.
  5933   02  DFHEIV34              PIC S9(4) COMP SYNC.
  5934   02  DFHEIV35              PIC S9(4) COMP SYNC.
  5935   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  5936   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  5937   02  FILLER                PIC X(02).
  5938   02  DFHEIV99              PIC X(08) VALUE SPACE.
  5939   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  5940   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  5941   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  5942   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  5943   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  5944   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  5945 LINKAGE  SECTION.
  5946*****************************************************************
  5947*                                                               *
  5948* Copyright (c) 2007-2013 Dell Inc.                             *
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 111
* EL6311.cbl
  5949* All rights reserved.                                          *
  5950*                                                               *
  5951*****************************************************************
  5952 01  dfheiblk.
  5953     02  eibtime          pic s9(7) comp-3.
  5954     02  eibdate          pic s9(7) comp-3.
  5955     02  eibtrnid         pic x(4).
  5956     02  eibtaskn         pic s9(7) comp-3.
  5957     02  eibtrmid         pic x(4).
  5958     02  dfheigdi         pic s9(4) comp.
  5959     02  eibcposn         pic s9(4) comp.
  5960     02  eibcalen         pic s9(4) comp.
  5961     02  eibaid           pic x(1).
  5962     02  eibfiller1       pic x(1).
  5963     02  eibfn            pic x(2).
  5964     02  eibfiller2       pic x(2).
  5965     02  eibrcode         pic x(6).
  5966     02  eibfiller3       pic x(2).
  5967     02  eibds            pic x(8).
  5968     02  eibreqid         pic x(8).
  5969     02  eibrsrce         pic x(8).
  5970     02  eibsync          pic x(1).
  5971     02  eibfree          pic x(1).
  5972     02  eibrecv          pic x(1).
  5973     02  eibsend          pic x(1).
  5974     02  eibatt           pic x(1).
  5975     02  eibeoc           pic x(1).
  5976     02  eibfmh           pic x(1).
  5977     02  eibcompl         pic x(1).
  5978     02  eibsig           pic x(1).
  5979     02  eibconf          pic x(1).
  5980     02  eiberr           pic x(1).
  5981     02  eibrldbk         pic x(1).
  5982     02  eiberrcd         pic x(4).
  5983     02  eibsynrb         pic x(1).
  5984     02  eibnodat         pic x(1).
  5985     02  eibfiller5       pic x(2).
  5986     02  eibresp          pic s9(8) comp.
  5987     02  eibresp2         pic s9(8) comp.
  5988     02  dfheigdj         pic s9(4) comp.
  5989     02  dfheigdk         pic s9(4) comp.
  5990 01  DFHCOMMAREA                 PIC X(1300).
  5991*                                COPY ERCPNDB.
  5992******************************************************************
  5993*                                                                *
  5994*                                                                *
  5995*                            ERCPNDB.                            *
  5996*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5997*                            VMOD=2.025                          *
  5998*                                                                *
  5999*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  6000*                                                                *
  6001******************************************************************
  6002*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  6003*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  6004******************************************************************
  6005*                                                                *
  6006*                                                                *
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 112
* EL6311.cbl
  6007*   FILE TYPE = VSAM,KSDS                                        *
  6008*   RECORD SIZE = 585  RECFORM = FIXED                           *
  6009*                                                                *
  6010*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  6011*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  6012*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  6013*                                                 RKP=13,LEN=36  *
  6014*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  6015*                                      AND CHG-SEQ.)             *
  6016*                                                RKP=49,LEN=11   *
  6017*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  6018*                                      AND CHG-SEQ.)             *
  6019*                                                RKP=60,LEN=15   *
  6020*                                                                *
  6021*   LOG = NO                                                     *
  6022*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6023******************************************************************
  6024******************************************************************
  6025*                   C H A N G E   L O G
  6026*
  6027* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6028*-----------------------------------------------------------------
  6029*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6030* EFFECTIVE    NUMBER
  6031*-----------------------------------------------------------------
  6032* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  6033* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  6034* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  6035* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  6036* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  6037* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  6038* 032306                   PEMA  ADD BOW LOAN NUMBER
  6039* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  6040* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  6041* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  6042* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  6043* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  6044* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  6045* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6046* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  6047* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
  6048* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  6049* 010517  CR2016021600005  PEMA ADD NEW FORCE CODE FOR AGG
  6050* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
  6051* 012220  CR2018092700002  TANA ADD LETTER REQUIRED FIELD
  6052******************************************************************
  6053
  6054 01  PENDING-BUSINESS.
  6055     12  PB-RECORD-ID                     PIC XX.
  6056         88  VALID-PB-ID                        VALUE 'PB'.
  6057
  6058     12  PB-CONTROL-PRIMARY.
  6059         16  PB-COMPANY-CD                PIC X.
  6060         16  PB-ENTRY-BATCH               PIC X(6).
  6061         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  6062         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  6063
  6064     12  PB-CONTROL-BY-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 113
* EL6311.cbl
  6065         16  PB-COMPANY-CD-A1             PIC X.
  6066         16  PB-CARRIER                   PIC X.
  6067         16  PB-GROUPING.
  6068             20  PB-GROUPING-PREFIX       PIC XXX.
  6069             20  PB-GROUPING-PRIME        PIC XXX.
  6070         16  PB-STATE                     PIC XX.
  6071         16  PB-ACCOUNT.
  6072             20  PB-ACCOUNT-PREFIX        PIC X(4).
  6073             20  PB-ACCOUNT-PRIME         PIC X(6).
  6074         16  PB-CERT-EFF-DT               PIC XX.
  6075         16  PB-CERT-NO.
  6076             20  PB-CERT-PRIME            PIC X(10).
  6077             20  PB-CERT-SFX              PIC X.
  6078         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  6079
  6080         16  PB-RECORD-TYPE               PIC X.
  6081             88  PB-MAILING-DATA                VALUE '0'.
  6082             88  PB-ISSUE                       VALUE '1'.
  6083             88  PB-CANCELLATION                VALUE '2'.
  6084             88  PB-BATCH-TRAILER               VALUE '9'.
  6085
  6086     12  PB-CONTROL-BY-ORIG-BATCH.
  6087         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  6088         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  6089         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  6090         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  6091
  6092     12  PB-CONTROL-BY-CSR.
  6093         16  PB-CSR-COMPANY-CD            PIC X.
  6094         16  PB-CSR-ID                    PIC X(4).
  6095         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  6096         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  6097         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  6098******************************************************************
  6099*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  6100******************************************************************
  6101
  6102     12  PB-LAST-MAINT-DT                 PIC XX.
  6103     12  PB-LAST-MAINT-BY                 PIC X(4).
  6104     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  6105
  6106     12  PB-RECORD-BODY                   PIC X(375).
  6107
  6108     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  6109         16  PB-CERT-ORIGIN               PIC X.
  6110             88  CLASIC-CREATED-CERT         VALUE '1'.
  6111         16  PB-I-NAME.
  6112             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  6113             20  PB-I-INSURED-FIRST-NAME.
  6114                 24  PB-I-INSURED-1ST-INIT PIC X.
  6115                 24  FILLER                PIC X(9).
  6116             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  6117         16  PB-I-AGE                     PIC S99   COMP-3.
  6118         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  6119         16  PB-I-BIRTHDAY                PIC XX.
  6120         16  PB-I-INSURED-SEX             PIC X.
  6121             88  PB-SEX-MALE     VALUE 'M'.
  6122             88  PB-SEX-FEMALE   VALUE 'F'.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 114
* EL6311.cbl
  6123
  6124         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  6125         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  6126         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  6127         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  6128         16  PB-I-SKIP-CODE               PIC X.
  6129             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  6130             88  PB-SKIP-JULY              VALUE '1'.
  6131             88  PB-SKIP-AUGUST            VALUE '2'.
  6132             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  6133             88  PB-SKIP-JULY-AUG          VALUE '4'.
  6134             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  6135             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  6136             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  6137             88  PB-SKIP-JUNE              VALUE '8'.
  6138             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  6139             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  6140             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  6141         16  PB-I-TERM-TYPE               PIC X.
  6142             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  6143             88  PB-PAID-WEEKLY            VALUE 'W'.
  6144             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  6145             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  6146             88  PB-PAID-13-YEARLY         VALUE 'T'.
  6147         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  6148         16  PB-I-POLICY-FORM-NO          PIC X(12).
  6149         16  PB-I-DATA-ENTRY-SW           PIC X.
  6150             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  6151             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  6152             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  6153             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  6154         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  6155         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  6156*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  6157         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  6158         16  PB-I-LETTER-REQD             PIC X.
  6159
  6160         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  6161             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  6162             88  PB-INVALID-LIFE             VALUE '  ' '00'
  6163                                                   '90' THRU '99'.
  6164         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  6165                                          PIC XX.
  6166         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  6167         16  PB-I-AMOUNT-FINANCED REDEFINES
  6168                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  6169         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  6170         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  6171                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  6172         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  6173         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  6174         16  PB-I-CLP-AMOUNT REDEFINES
  6175                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  6176         16  PB-I-LF-CALC-FLAG            PIC X.
  6177             88 PB-COMP-LF-PREM               VALUE '?'.
  6178         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  6179         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  6180         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 115
* EL6311.cbl
  6181         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  6182         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  6183         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  6184         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  6185         16  PB-I-LF-ABBR                 PIC XXX.
  6186         16  PB-I-LF-INPUT-CD             PIC XX.
  6187
  6188         16  PB-I-AH-BENEFIT-CD           PIC XX.
  6189             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  6190             88  PB-INVALID-AH               VALUE '  ' '00'
  6191                                                   '90' THRU '99'.
  6192         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  6193         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  6194         16  PB-I-AH-CALC-FLAG            PIC X.
  6195             88 PB-COMP-AH-PREM                  VALUE '?'.
  6196         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  6197         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  6198         16  PB-I-CANCEL-FEE              PIC S9(3)V99   COMP-3.
  6199         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  6200         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  6201         16  PB-I-AH-ABBR                 PIC XXX.
  6202         16  PB-I-AH-INPUT-CD             PIC XXX.
  6203
  6204         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  6205         16  PB-I-REIN-TABLE              PIC XXX.
  6206         16  PB-I-BUSINESS-TYPE           PIC 99.
  6207         16  PB-I-INDV-GRP-CD             PIC X.
  6208         16  PB-I-MORT-CODE.
  6209             20  PB-I-TABLE               PIC X.
  6210             20  PB-I-INTEREST            PIC XX.
  6211             20  PB-I-MORT-TYP            PIC X.
  6212         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  6213         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  6214         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  6215         16  PB-I-INDV-GRP-OVRD           PIC X.
  6216         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  6217         16  PB-I-SIG-SW                  PIC X.
  6218             88  PB-POLICY-SIGNED             VALUE 'Y'.
  6219         16  PB-I-RATE-CLASS              PIC XX.
  6220         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  6221         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  6222         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  6223         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  6224         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  6225         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  6226         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  6227         16  PB-I-BENEFIT-TYPE            PIC XXX.
  6228         16  PB-I-OB-FLAG                 PIC X.
  6229             88  PB-I-OB                      VALUE 'B'.
  6230             88  PB-I-SUMMARY                 VALUE 'Z'.
  6231         16  PB-I-ENTRY-STATUS            PIC X.
  6232             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  6233                                              'M' '5' '9' '2'.
  6234             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  6235             88  PB-I-POLICY-PENDING          VALUE '2'.
  6236             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  6237             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  6238             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 116
* EL6311.cbl
  6239             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  6240             88  PB-I-REIN-ONLY               VALUE '9'.
  6241             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  6242             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  6243             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  6244             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  6245         16  PB-I-INT-CODE                PIC X.
  6246             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  6247             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  6248         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  6249         16  PB-I-SOC-SEC-NO              PIC X(11).
  6250         16  PB-I-MEMBER-NO               PIC X(12).
  6251         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  6252*        16  PB-I-LOAN-OFFICER            PIC XXX.
  6253         16  PB-I-OLD-LOF                 PIC XXX.
  6254         16  PB-I-LF-EXPIRE-DT            PIC XX.
  6255         16  PB-I-AH-EXPIRE-DT            PIC XX.
  6256         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  6257         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  6258         16  PB-I-LIFE-INDICATOR          PIC X.
  6259             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  6260         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  6261         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  6262                                          PIC S9(5)V99    COMP-3.
  6263         16  PB-I-MAIL-ADDRS-SW           PIC X.
  6264             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  6265             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  6266         16  PB-I-1ST-PMT-DT              PIC XX.
  6267         16  PB-I-JOINT-INSURED.
  6268             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  6269             20 PB-I-JOINT-FIRST-NAME.
  6270                24  PB-I-JOINT-FIRST-INIT PIC X.
  6271                24  FILLER                PIC X(9).
  6272             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  6273*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  6274         16  PB-I-BENEFICIARY-NAME.
  6275             20  PB-I-BANK-NUMBER         PIC X(10).
  6276             20  FILLER                   PIC X(15).
  6277         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  6278         16  PB-I-REFERENCE               PIC X(12).
  6279         16  FILLER REDEFINES PB-I-REFERENCE.
  6280             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  6281             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  6282             20  PB-I-CLP-STATE           PIC XX.
  6283         16  PB-I-UNDERWRITING-STATUS     PIC X.
  6284             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  6285             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  6286             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  6287         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  6288         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  6289         16  PB-I-RESIDENT-STATE          PIC XX.
  6290         16  PB-I-RATE-CODE               PIC X(4).
  6291         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  6292         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  6293         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  6294         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  6295         16  PB-I-BANK-NOCHRGB            PIC 99.
  6296         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 117
* EL6311.cbl
  6297         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  6298
  6299     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  6300         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  6301             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  6302         16  PB-C-CANCEL-ORIGIN           PIC X.
  6303             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  6304         16  PB-C-LF-CANCEL-DT            PIC XX.
  6305         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  6306         16  PB-C-LF-CALC-REQ             PIC X.
  6307             88 PB-COMP-LF-CANCEL            VALUE '?'.
  6308         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  6309         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  6310         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  6311             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  6312         16  PB-C-AH-CANCEL-DT            PIC XX.
  6313         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  6314         16  PB-C-AH-CALC-REQ             PIC X.
  6315             88 PB-COMP-AH-CANCEL            VALUE '?'.
  6316         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  6317         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  6318         16  PB-C-LAST-NAME               PIC X(15).
  6319         16  PB-C-REFUND-SW               PIC X.
  6320             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  6321             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  6322         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  6323         16  PB-C-PAYEE-CODE              PIC X(6).
  6324         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  6325         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  6326         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  6327         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  6328         16  PB-C-REFERENCE               PIC X(12).
  6329         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  6330         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  6331         16  PB-C-POST-CARD-IND           PIC X.
  6332         16  PB-C-CANCEL-REASON           PIC X.
  6333         16  PB-C-REF-INTERFACE-SW        PIC X.
  6334         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  6335         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  6336         16  FILLER                       PIC X(01).
  6337*        16  FILLER                       PIC X(18).
  6338         16  PB-C-POLICY-FORM-NO          PIC X(12).
  6339*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  6340         16  PB-C-INT-ON-REFS             PIC S9(7)V99   COMP-3.
  6341         16  PB-CANCELED-CERT-DATA.
  6342             20  PB-CI-INSURED-NAME.
  6343                 24  PB-CI-LAST-NAME      PIC X(15).
  6344                 24  PB-CI-INITIALS       PIC XX.
  6345             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  6346             20  PB-CI-INSURED-SEX        PIC X.
  6347             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  6348             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  6349             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  6350             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  6351             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  6352             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  6353             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  6354             20  PB-CI-AH-BENEFIT-CD      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 118
* EL6311.cbl
  6355             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  6356             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  6357             20  PB-CI-RATE-CLASS         PIC XX.
  6358             20  PB-CI-RATE-DEV-LF        PIC XXX.
  6359             20  PB-CI-RATE-DEV-AH        PIC XXX.
  6360             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  6361             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  6362             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  6363             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  6364             20  PB-CI-LF-ABBR            PIC X(3).
  6365             20  PB-CI-AH-ABBR            PIC X(3).
  6366             20  PB-CI-OB-FLAG            PIC X.
  6367                 88  PB-CI-OB                VALUE 'B'.
  6368             20  PB-CI-LF-POLICY-STATUS   PIC X.
  6369                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  6370                                           'M' '4' '5' '9' '2'.
  6371                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  6372                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  6373                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  6374                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  6375                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  6376                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  6377                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  6378                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  6379                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  6380                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  6381                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  6382                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  6383                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  6384             20  PB-CI-AH-POLICY-STATUS   PIC X.
  6385                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  6386                                           'M' '4' '5' '9' '2'.
  6387                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  6388                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  6389                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  6390                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  6391                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  6392                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  6393                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  6394                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  6395                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  6396                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  6397                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  6398                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  6399                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  6400             20  PB-CI-PAY-FREQUENCY      PIC 99.
  6401             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  6402             20  PB-CI-SOC-SEC-NO         PIC X(11).
  6403             20  PB-CI-MEMBER-NO          PIC X(12).
  6404             20  PB-CI-INT-CODE           PIC X.
  6405                 88  PB-CI-ADD-ON                  VALUE 'A'.
  6406                 88  PB-CI-SIMPLE                  VALUE 'S'.
  6407             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  6408             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  6409             20  PB-CI-COMP-EXCP-SW       PIC X.
  6410                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  6411                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  6412             20  PB-CI-ENTRY-STATUS       PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 119
* EL6311.cbl
  6413             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  6414             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  6415             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  6416             20  PB-CI-DEATH-DT           PIC XX.
  6417             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  6418             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  6419             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  6420             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  6421             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  6422             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  6423             20  PB-CI-ENTRY-DT              PIC XX.
  6424             20  PB-CI-ENTRY-BATCH           PIC X(6).
  6425             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  6426             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  6427             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  6428             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  6429             20  PB-CI-OLD-LOF               PIC XXX.
  6430*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  6431             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  6432             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  6433             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  6434             20  PB-CI-INDV-GRP-CD           PIC X.
  6435             20  PB-CI-BENEFICIARY-NAME.
  6436                 24  PB-CI-BANK-NUMBER       PIC X(10).
  6437                 24  FILLER                  PIC X(15).
  6438             20  PB-CI-NOTE-SW               PIC X.
  6439             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  6440             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  6441             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  6442             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  6443             20  PB-CI-LOAN-OFFICER          PIC X(5).
  6444             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  6445             20  PB-CI-FIRST-NAME            PIC X(10).
  6446             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  6447
  6448         16  FILLER                       PIC X(13).
  6449*032306  16  FILLER                       PIC X(27).
  6450*        16  FILLER                       PIC X(46).
  6451
  6452     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  6453         16  FILLER                       PIC X(10).
  6454         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  6455         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  6456         16  PB-M-INSURED-MID-INIT        PIC X.
  6457         16  PB-M-INSURED-AGE             PIC 99.
  6458         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  6459         16  PB-M-INSURED-SEX             PIC X.
  6460         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  6461         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  6462         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  6463         16  PB-M-INSURED-CITY-STATE.
  6464             20  PB-M-INSURED-CITY        PIC X(28).
  6465             20  PB-M-INSURED-STATE       PIC XX.
  6466         16  PB-M-INSURED-ZIP-CODE.
  6467             20  PB-M-INSURED-ZIP-PRIME.
  6468                 24  PB-M-INSURED-ZIP-1   PIC X.
  6469                     88  PB-M-CANADIAN-POST-CODE
  6470                                             VALUE 'A' THRU 'Z'.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 120
* EL6311.cbl
  6471                 24  FILLER               PIC X(4).
  6472             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  6473         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  6474                                        PB-M-INSURED-ZIP-CODE.
  6475             20  PM-M-INS-CAN-POST1       PIC XXX.
  6476             20  PM-M-INS-CAN-POST2       PIC XXX.
  6477             20  FILLER                   PIC XXX.
  6478         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  6479         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  6480         16  PB-M-CRED-BENE-NAME          PIC X(30).
  6481         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  6482         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  6483         16  PB-M-CRED-BENE-CITYST.
  6484             20  PB-M-CRED-BENE-CITY      PIC X(28).
  6485             20  PB-M-CRED-BENE-STATE     PIC XX.
  6486         16  FILLER                       PIC X(92).
  6487
  6488     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  6489         16  FILLER                       PIC X(10).
  6490         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6491         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6492         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6493         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6494         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6495         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6496         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6497         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6498         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6499         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6500         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6501         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6502         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  6503         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  6504         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  6505         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  6506         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  6507         16  PB-ACCOUNT-NAME              PIC X(30).
  6508         16  PB-PREM-REF-RPT-FLAG         PIC X.
  6509         16  PB-REFERENCE                 PIC X(12).
  6510         16  PB-B-RECEIVED-DT             PIC XX.
  6511         16  FILLER                       PIC X(234).
  6512
  6513     12  PB-RECORD-STATUS.
  6514         16  PB-CREDIT-SELECT-DT          PIC XX.
  6515         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  6516         16  PB-BILLED-DT                 PIC XX.
  6517         16  PB-BILLING-STATUS            PIC X.
  6518             88  PB-ENTRY-REVERSED            VALUE 'R'.
  6519             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  6520             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  6521         16  PB-RECORD-BILL               PIC X.
  6522             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  6523             88  PB-RECORD-RETURNED           VALUE 'R'.
  6524             88  PB-RECORD-ENDORSED           VALUE 'E'.
  6525             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  6526             88  PB-OVERRIDE-AH               VALUE 'A'.
  6527             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  6528         16  PB-BATCH-ENTRY               PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 121
* EL6311.cbl
  6529             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  6530             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  6531             88  PB-REISSUED-CERT             VALUE 'E'.
  6532             88  PB-CASH-CERT                 VALUE 'C'.
  6533             88  PB-MONTHLY-CERT              VALUE 'M'.
  6534             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  6535             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  6536             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  6537         16  PB-FORCE-CODE                PIC X.
  6538             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  6539             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  6540             88  PB-CANCEL-FORCE              VALUE '8'.
  6541             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  6542             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  6543             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  6544             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  6545             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  6546             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  6547             88  PB-EXCEEDED-LIMIT-FORCED     VALUE 'L'.
  6548             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  6549         16  PB-FATAL-FLAG                PIC X.
  6550             88  PB-FATAL-ERRORS              VALUE 'X'.
  6551         16  PB-FORCE-ER-CD               PIC X.
  6552             88  PB-FORCE-ERRORS              VALUE 'F'.
  6553             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  6554         16  PB-WARN-ER-CD                PIC X.
  6555             88  PB-WARNING-ERRORS            VALUE 'W'.
  6556         16  FILLER                       PIC X.
  6557         16  PB-OUT-BAL-CD                PIC X.
  6558             88  PB-OUT-OF-BAL                VALUE 'O'.
  6559         16  PB-LIFE-OVERRIDE-L1          PIC X.
  6560         16  PB-AH-OVERRIDE-L1            PIC X.
  6561         16  PB-INPUT-DT                  PIC XX.
  6562         16  PB-INPUT-BY                  PIC X(4).
  6563         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  6564         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  6565         16  PB-TOLERANCE-REJECT-SW       PIC X.
  6566         16  PB-LF-EARNING-METHOD         PIC X.
  6567         16  PB-AH-EARNING-METHOD         PIC X.
  6568         16  PB-LF-TERM-CALC-METHOD       PIC X.
  6569         16  PB-AH-TERM-CALC-METHOD       PIC X.
  6570         16  PB-REIN-CD                   PIC XXX.
  6571         16  PB-LF-REFUND-TYPE            PIC X.
  6572         16  PB-AH-REFUND-TYPE            PIC X.
  6573         16  PB-ACCT-EFF-DT               PIC XX.
  6574         16  PB-ACCT-EXP-DT               PIC XX.
  6575         16  PB-COMPANY-ID                PIC X(3).
  6576         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  6577         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  6578         16  PB-SV-CARRIER                PIC X.
  6579         16  PB-SV-GROUPING               PIC X(6).
  6580         16  PB-SV-STATE                  PIC XX.
  6581         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  6582         16  PB-GA-BILLING-INFO.
  6583             20  PB-GA-BILL-DT OCCURS 5 TIMES
  6584                                          PIC XX.
  6585         16  PB-SV-REMIT-TO  REDEFINES
  6586             PB-GA-BILLING-INFO           PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 122
* EL6311.cbl
  6587         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  6588         16  PB-I-LOAN-OFFICER            PIC X(5).
  6589         16  PB-I-VIN                     PIC X(17).
  6590
  6591         16  FILLER                       PIC X(04).
  6592         16  IMNET-BYPASS-SW              PIC X.
  6593
  6594******************************************************************
  6595*                COMMON EDIT ERRORS                              *
  6596******************************************************************
  6597
  6598     12  PB-COMMON-ERRORS.
  6599         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  6600                                           PIC S9(4)     COMP.
  6601
  6602******************************************************************
  6603*                                COPY ELCCERT.
  6604******************************************************************
  6605*                                                                *
  6606*                            ELCCERT.                            *
  6607*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6608*                            VMOD=2.013                          *
  6609*                                                                *
  6610*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  6611*                                                                *
  6612*   FILE TYPE = VSAM,KSDS                                        *
  6613*   RECORD SIZE = 450  RECFORM = FIXED                           *
  6614*                                                                *
  6615*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  6616*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  6617*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  6618*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  6619*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  6620*                                                                *
  6621*   LOG = YES                                                    *
  6622*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6623******************************************************************
  6624*                   C H A N G E   L O G
  6625*
  6626* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6627*-----------------------------------------------------------------
  6628*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6629* EFFECTIVE    NUMBER
  6630*-----------------------------------------------------------------
  6631* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  6632* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  6633* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  6634* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  6635* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  6636* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  6637* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6638* 032612  CR2011110200001  PEMA  AHL CHANGES
  6639* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  6640* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  6641* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
  6642******************************************************************
  6643
  6644 01  CERTIFICATE-MASTER.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 123
* EL6311.cbl
  6645     12  CM-RECORD-ID                      PIC XX.
  6646         88  VALID-CM-ID                      VALUE 'CM'.
  6647
  6648     12  CM-CONTROL-PRIMARY.
  6649         16  CM-COMPANY-CD                 PIC X.
  6650         16  CM-CARRIER                    PIC X.
  6651         16  CM-GROUPING.
  6652             20  CM-GROUPING-PREFIX        PIC X(3).
  6653             20  CM-GROUPING-PRIME         PIC X(3).
  6654         16  CM-STATE                      PIC XX.
  6655         16  CM-ACCOUNT.
  6656             20  CM-ACCOUNT-PREFIX         PIC X(4).
  6657             20  CM-ACCOUNT-PRIME          PIC X(6).
  6658         16  CM-CERT-EFF-DT                PIC XX.
  6659         16  CM-CERT-NO.
  6660             20  CM-CERT-PRIME             PIC X(10).
  6661             20  CM-CERT-SFX               PIC X.
  6662
  6663     12  CM-CONTROL-BY-NAME.
  6664         16  CM-COMPANY-CD-A1              PIC X.
  6665         16  CM-INSURED-LAST-NAME          PIC X(15).
  6666         16  CM-INSURED-INITIALS.
  6667             20  CM-INSURED-INITIAL1       PIC X.
  6668             20  CM-INSURED-INITIAL2       PIC X.
  6669
  6670     12  CM-CONTROL-BY-SSN.
  6671         16  CM-COMPANY-CD-A2              PIC X.
  6672         16  CM-SOC-SEC-NO.
  6673             20  CM-SSN-STATE              PIC XX.
  6674             20  CM-SSN-ACCOUNT            PIC X(6).
  6675             20  CM-SSN-LN3.
  6676                 25  CM-INSURED-INITIALS-A2.
  6677                     30 CM-INSURED-INITIAL1-A2   PIC X.
  6678                     30 CM-INSURED-INITIAL2-A2   PIC X.
  6679                 25 CM-PART-LAST-NAME-A2         PIC X.
  6680
  6681     12  CM-CONTROL-BY-CERT-NO.
  6682         16  CM-COMPANY-CD-A4              PIC X.
  6683         16  CM-CERT-NO-A4                 PIC X(11).
  6684
  6685     12  CM-CONTROL-BY-MEMB.
  6686         16  CM-COMPANY-CD-A5              PIC X.
  6687         16  CM-MEMBER-NO.
  6688             20  CM-MEMB-STATE             PIC XX.
  6689             20  CM-MEMB-ACCOUNT           PIC X(6).
  6690             20  CM-MEMB-LN4.
  6691                 25  CM-INSURED-INITIALS-A5.
  6692                     30 CM-INSURED-INITIAL1-A5   PIC X.
  6693                     30 CM-INSURED-INITIAL2-A5   PIC X.
  6694                 25 CM-PART-LAST-NAME-A5         PIC XX.
  6695
  6696     12  CM-INSURED-PROFILE-DATA.
  6697         16  CM-INSURED-FIRST-NAME.
  6698             20  CM-INSURED-1ST-INIT       PIC X.
  6699             20  FILLER                    PIC X(9).
  6700         16  CM-INSURED-ISSUE-AGE          PIC 99.
  6701         16  CM-INSURED-SEX                PIC X.
  6702             88  CM-SEX-MALE                  VALUE 'M'.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 124
* EL6311.cbl
  6703             88  CM-SEX-FEMAL                 VALUE 'F'.
  6704         16  CM-INSURED-JOINT-AGE          PIC 99.
  6705         16  CM-JOINT-INSURED-NAME.
  6706             20  CM-JT-LAST-NAME           PIC X(15).
  6707             20  CM-JT-FIRST-NAME.
  6708                 24  CM-JT-1ST-INIT        PIC X.
  6709                 24  FILLER                PIC X(9).
  6710             20  CM-JT-INITIAL             PIC X.
  6711
  6712     12  CM-LIFE-DATA.
  6713         16  CM-LF-BENEFIT-CD              PIC XX.
  6714         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  6715         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  6716         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  6717         16  CM-LF-DEV-CODE                PIC XXX.
  6718         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  6719         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  6720         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  6721         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  6722         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  6723         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  6724         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  6725         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  6726         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  6727         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  6728         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  6729         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  6730         16  cm-temp-epiq                  pic xx.
  6731             88  EPIQ-CLASS                  value 'EQ'.
  6732*        16  FILLER                        PIC XX.
  6733
  6734     12  CM-AH-DATA.
  6735         16  CM-AH-BENEFIT-CD              PIC XX.
  6736         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  6737         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  6738         16  CM-AH-DEV-CODE                PIC XXX.
  6739         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  6740         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  6741         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  6742         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  6743         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  6744         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  6745         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  6746         16  CM-AH-PAID-THRU-DT            PIC XX.
  6747             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  6748         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  6749         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  6750         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  6751         16  FILLER                        PIC X.
  6752
  6753     12  CM-LOAN-INFORMATION.
  6754         16  CM-LIVES                      PIC S9(7)     COMP-3.
  6755         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  6756                                           PIC S9(5)V99  COMP-3.
  6757         16  CM-BILLED                     PIC S9(7)     COMP-3.
  6758         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  6759         16  CM-PAY-FREQUENCY              PIC S99.
  6760         16  CM-LOAN-TERM                  PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 125
* EL6311.cbl
  6761         16  CM-RATE-CLASS                 PIC XX.
  6762         16  CM-BENEFICIARY                PIC X(25).
  6763         16  CM-POLICY-FORM-NO             PIC X(12).
  6764         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  6765         16  CM-LAST-ADD-ON-DT             PIC XX.
  6766         16  CM-DEDUCTIBLE-AMOUNTS.
  6767             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  6768             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  6769         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  6770             20  CM-RESIDENT-STATE         PIC XX.
  6771             20  CM-RATE-CODE              PIC X(4).
  6772             20  FILLER                    PIC XX.
  6773         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  6774             20  CM-LOAN-OFFICER           PIC X(5).
  6775             20  FILLER                    PIC XXX.
  6776         16  CM-CSR-CODE                   PIC XXX.
  6777         16  CM-UNDERWRITING-CODE          PIC X.
  6778             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  6779         16  CM-POST-CARD-IND              PIC X.
  6780         16  CM-REF-INTERFACE-SW           PIC X.
  6781         16  CM-PREMIUM-TYPE               PIC X.
  6782             88  CM-SING-PRM                  VALUE '1'.
  6783             88  CM-O-B-COVERAGE              VALUE '2'.
  6784             88  CM-OPEN-END                  VALUE '3'.
  6785         16  CM-IND-GRP-TYPE               PIC X.
  6786             88  CM-INDIVIDUAL                VALUE 'I'.
  6787             88  CM-GROUP                     VALUE 'G'.
  6788         16  CM-SKIP-CODE                  PIC X.
  6789             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  6790             88  SKIP-JULY                    VALUE '1'.
  6791             88  SKIP-AUGUST                  VALUE '2'.
  6792             88  SKIP-SEPTEMBER               VALUE '3'.
  6793             88  SKIP-JULY-AUG                VALUE '4'.
  6794             88  SKIP-AUG-SEPT                VALUE '5'.
  6795             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  6796             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  6797             88  SKIP-JUNE                    VALUE '8'.
  6798             88  SKIP-JUNE-JULY               VALUE '9'.
  6799             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  6800             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  6801         16  CM-PAYMENT-MODE               PIC X.
  6802             88  PAY-MONTHLY                  VALUE SPACE.
  6803             88  PAY-WEEKLY                   VALUE '1'.
  6804             88  PAY-SEMI-MONTHLY             VALUE '2'.
  6805             88  PAY-BI-WEEKLY                VALUE '3'.
  6806             88  PAY-SEMI-ANUALLY             VALUE '4'.
  6807         16  CM-LOAN-NUMBER                PIC X(8).
  6808         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  6809         16  CM-OLD-LOF                    PIC XXX.
  6810*        16  CM-LOAN-OFFICER               PIC XXX.
  6811         16  CM-REIN-TABLE                 PIC XXX.
  6812         16  CM-SPECIAL-REIN-CODE          PIC X.
  6813         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  6814         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  6815         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  6816
  6817     12  CM-STATUS-DATA.
  6818         16  CM-ENTRY-STATUS               PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 126
* EL6311.cbl
  6819         16  CM-ENTRY-DT                   PIC XX.
  6820
  6821         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  6822         16  CM-LF-CANCEL-DT               PIC XX.
  6823         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  6824
  6825         16  CM-LF-STATUS-AT-DEATH         PIC X.
  6826         16  CM-LF-DEATH-DT                PIC XX.
  6827         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  6828
  6829         16  CM-LF-CURRENT-STATUS          PIC X.
  6830             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  6831                                                'M' '4' '5' '9'.
  6832             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  6833             88  CM-LF-POLICY-PENDING         VALUE '2'.
  6834             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  6835             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  6836             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  6837             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  6838             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  6839             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  6840             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  6841             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  6842             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  6843             88  CM-LF-DECLINED               VALUE 'D'.
  6844             88  CM-LF-VOIDED                 VALUE 'V'.
  6845
  6846         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  6847         16  CM-AH-CANCEL-DT               PIC XX.
  6848         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  6849
  6850         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  6851         16  CM-AH-SETTLEMENT-DT           PIC XX.
  6852         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  6853
  6854         16  CM-AH-CURRENT-STATUS          PIC X.
  6855             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  6856                                                'M' '4' '5' '9'.
  6857             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  6858             88  CM-AH-POLICY-PENDING         VALUE '2'.
  6859             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  6860             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  6861             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  6862             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  6863             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  6864             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  6865             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  6866             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  6867             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  6868             88  CM-AH-DECLINED               VALUE 'D'.
  6869             88  CM-AH-VOIDED                 VALUE 'V'.
  6870
  6871         16  CM-CLAIM-INTERFACE-SW         PIC X.
  6872             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  6873             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  6874             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  6875         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  6876
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 127
* EL6311.cbl
  6877         16  CM-ENTRY-BATCH                PIC X(6).
  6878         16  CM-LF-EXIT-BATCH              PIC X(6).
  6879         16  CM-AH-EXIT-BATCH              PIC X(6).
  6880         16  CM-LAST-MONTH-END             PIC XX.
  6881
  6882     12  CM-NOTE-SW                        PIC X.
  6883         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  6884         88  CERT-NOTES-PRESENT               VALUE '1'.
  6885         88  BILLING-NOTES-PRESENT            VALUE '2'.
  6886         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  6887         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  6888         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  6889         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  6890         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  6891     12  CM-COMP-EXCP-SW                   PIC X.
  6892         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  6893         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  6894     12  CM-INSURED-ADDRESS-SW             PIC X.
  6895         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  6896         88  INSURED-ADDR-PRESENT             VALUE '1'.
  6897
  6898*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  6899     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  6900     12  FILLER                            PIC X.
  6901
  6902*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  6903     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  6904     12  FILLER                            PIC X.
  6905*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  6906     12  CM-INT-ON-REFS                    PIC S9(7)V99   COMP-3.
  6907
  6908     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  6909         88  CERT-ADDED-BATCH                 VALUE ' '.
  6910         88  CERT-ADDED-ONLINE                VALUE '1'.
  6911         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  6912         88  CERT-PURGED-OFFLINE              VALUE '3'.
  6913         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  6914     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  6915         88  CERT-AS-LOADED                   VALUE ' '.
  6916         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  6917         88  CERT-CLAIM-ONLINE                VALUE '2'.
  6918         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  6919         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  6920         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  6921         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  6922         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  6923
  6924     12  CM-ACCOUNT-COMM-PCTS.
  6925         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  6926         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  6927
  6928     12  CM-USER-FIELD                     PIC X.
  6929     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  6930     12  CM-CLP-STATE                      PIC XX.
  6931     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  6932     12  CM-USER-RESERVED                  PIC XXX.
  6933     12  FILLER REDEFINES CM-USER-RESERVED.
  6934         16  CM-AH-CLASS-CD                PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 128
* EL6311.cbl
  6935         16  F                             PIC X.
  6936******************************************************************
  6937*                                COPY ERCNOTE.
  6938******************************************************************
  6939*                                                                *
  6940*                                                                *
  6941*                            ERCNOTE                             *
  6942*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6943*                            VMOD=2.003                          *
  6944*                                                                *
  6945*        FILE DESCRIPTION = CERTIFICATE AND BILLING NOTES        *
  6946*                                                                *
  6947*        FILE TYPE= VSAM,KSDS                                    *
  6948*        RECORD SIZE = 825    RECFORM = FIXED                    *
  6949*                                                                *
  6950*        BASE CLUSTER = ERNOTE        RKP=2,LEN=34               *
  6951*                                                                *
  6952*        LOG = YES                                               *
  6953*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  6954*                                                                *
  6955******************************************************************
  6956*                   C H A N G E   L O G
  6957*
  6958* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6959*-----------------------------------------------------------------
  6960*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6961* EFFECTIVE    NUMBER
  6962*-----------------------------------------------------------------
  6963* 091509  CR2008100900003  AJRA  CERT NOTES MOVED TO NEW FILE. THI
  6964*                                FILE WILL CONTAIN BILLING NOTES O
  6965* 041320  CR2020030500002  PEMA  Distinguish between iss and canc
  6966******************************************************************
  6967
  6968 01  CERTIFICATE-NOTE.
  6969     12  CN-RECORD-ID                PIC  XX.
  6970         88  VALID-CN-ID                  VALUE 'CN'.
  6971
  6972     12  CN-CONTROL-PRIMARY.
  6973         16  CN-COMPANY-CD           PIC X.
  6974         16  CN-CARRIER              PIC X.
  6975         16  CN-GROUPING.
  6976             20 CN-GROUPING-PREFIX   PIC XXX.
  6977             20 CN-GROUPING-PRIME    PIC XXX.
  6978         16  CN-STATE                PIC XX.
  6979         16  CN-ACCOUNT.
  6980             20 CN-ACCOUNT-PREFIX    PIC X(4).
  6981             20 CN-ACCOUNT-PRIME     PIC X(6).
  6982         16  CN-CERT-EFF-DT          PIC XX.
  6983         16  CN-CERT-NO.
  6984             20  CN-CERT-PRIME       PIC X(10).
  6985             20  CN-CERT-SFX         PIC X.
  6986         16  CN-RECORD-TYPE          PIC X.
  6987             88  CN-ISSUE-BILLING-NOTE    VALUE '1'.
  6988             88  CN-CANCEL-BILLING-NOTE   VALUE '2'.
  6989     12  CN-BILLING-START-LINE-NO    PIC 99.
  6990     12  CN-BILLING-END-LINE-NO      PIC 99.
  6991
  6992     12  CN-LINES.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 129
* EL6311.cbl
  6993         16  CN-LINE OCCURS 10       PIC X(77).
  6994
  6995     12  CN-LAST-MAINT-DT            PIC XX.
  6996     12  CN-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  6997     12  CN-LAST-MAINT-USER          PIC X(4).
  6998     12  FILLER                      PIC X(5).
  6999******************************************************************
  7000*                                COPY ERCPNDM.
  7001******************************************************************
  7002*                                                                *
  7003*                                                                *
  7004*                            ERCPNDM                             *
  7005*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7006*                            VMOD=2.003                          *
  7007*                                                                *
  7008*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  7009*                                                                *
  7010*   FILE TYPE = VSAM,KSDS                                        *
  7011*   RECORD SIZE = 374   RECFORM = FIX                            *
  7012*                                                                *
  7013*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  7014*   ALTERNATE PATH    = NOT USED                                 *
  7015*                                                                *
  7016*   LOG = YES                                                    *
  7017*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7018******************************************************************
  7019*                   C H A N G E   L O G
  7020*
  7021* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7022*-----------------------------------------------------------------
  7023*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7024* EFFECTIVE    NUMBER
  7025*-----------------------------------------------------------------
  7026* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  7027* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  7028* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  7029* 100217  CR2016091600001  PEMA  ADD EDIT FOR ZIP CODE
  7030******************************************************************
  7031
  7032 01  PENDING-MAILING-DATA.
  7033     12  PM-RECORD-ID                      PIC XX.
  7034         88  VALID-MA-ID                       VALUE 'PM'.
  7035
  7036     12  PM-CONTROL-PRIMARY.
  7037         16  PM-COMPANY-CD                 PIC X.
  7038         16  PM-ENTRY-BATCH                PIC X(6).
  7039         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  7040         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  7041
  7042     12  FILLER                            PIC X(14).
  7043
  7044     12  PM-ACCESS-CONTROL.
  7045         16  PM-SOURCE-SYSTEM              PIC XX.
  7046             88  PM-FROM-CREDIT                VALUE 'CR'.
  7047             88  PM-FROM-VSI                   VALUE 'VS'.
  7048             88  PM-FROM-WARRANTY              VALUE 'WA'.
  7049             88  PM-FROM-OTHER                 VALUE 'OT'.
  7050         16  PM-RECORD-ADD-DT              PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 130
* EL6311.cbl
  7051         16  PM-RECORD-ADDED-BY            PIC XXXX.
  7052         16  PM-LAST-MAINT-DT              PIC XX.
  7053         16  PM-LAST-MAINT-BY              PIC XXXX.
  7054         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  7055
  7056     12  PM-PROFILE-INFO.
  7057         16  PM-QUALIFY-CODE-1             PIC XX.
  7058         16  PM-QUALIFY-CODE-2             PIC XX.
  7059         16  PM-QUALIFY-CODE-3             PIC XX.
  7060         16  PM-QUALIFY-CODE-4             PIC XX.
  7061         16  PM-QUALIFY-CODE-5             PIC XX.
  7062
  7063         16  PM-INSURED-LAST-NAME          PIC X(15).
  7064         16  PM-INSURED-FIRST-NAME         PIC X(10).
  7065         16  PM-INSURED-MIDDLE-INIT        PIC X.
  7066         16  PM-INSURED-ISSUE-AGE          PIC 99.
  7067         16  PM-INSURED-BIRTH-DT           PIC XX.
  7068         16  PM-INSURED-SEX                PIC X.
  7069             88  PM-SEX-MALE                   VALUE 'M'.
  7070             88  PM-SEX-FEMALE                 VALUE 'F'.
  7071         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  7072
  7073         16  PM-ADDRESS-CORRECTED          PIC X.
  7074         16  PM-JOINT-BIRTH-DT             PIC XX.
  7075*        16  FILLER                        PIC X(12).
  7076
  7077         16  PM-ADDRESS-LINE-1             PIC X(30).
  7078         16  PM-ADDRESS-LINE-2             PIC X(30).
  7079         16  PM-CITY-STATE.
  7080             20  PM-CITY                   PIC X(28).
  7081             20  PM-STATE                  PIC XX.
  7082         16  PM-ZIP.
  7083             20  PM-ZIP-CODE.
  7084                 24  PM-ZIP-1              PIC X.
  7085                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  7086                 24  FILLER                PIC X(4).
  7087             20  PM-ZIP-PLUS4              PIC X(4).
  7088         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  7089             20  PM-CAN-POST1              PIC XXX.
  7090             20  PM-CAN-POST2              PIC XXX.
  7091             20  FILLER                    PIC XXX.
  7092
  7093         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  7094         16  pm-city-st-zip-verified       pic x.
  7095         16  FILLER                        PIC XX.
  7096
  7097     12  PM-CRED-BENE-INFO.
  7098         16  PM-CRED-BENE-NAME             PIC X(25).
  7099         16  PM-CRED-BENE-ADDR             PIC X(30).
  7100         16  PM-CRED-BENE-ADDR2            PIC X(30).
  7101         16  PM-CRED-BENE-CTYST.
  7102             20  PM-CRED-BENE-CITY         PIC X(28).
  7103             20  PM-CRED-BENE-STATE        PIC XX.
  7104         16  PM-CRED-BENE-ZIP.
  7105             20  PM-CB-ZIP-CODE.
  7106                 24  PM-CB-ZIP-1           PIC X.
  7107                     88  PM-CB-CANADIAN-POST-CODE
  7108                                  VALUE 'A' THRU 'Z'.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 131
* EL6311.cbl
  7109                 24  FILLER                PIC X(4).
  7110             20  PM-CB-ZIP-PLUS4           PIC X(4).
  7111         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  7112             20  PM-CB-CAN-POST1           PIC XXX.
  7113             20  PM-CB-CAN-POST2           PIC XXX.
  7114             20  FILLER                    PIC XXX.
  7115     12  PM-POST-CARD-MAIL-DATA.
  7116         16  PM-MAIL-DATA OCCURS 7.
  7117             20  PM-MAIL-TYPE              PIC X.
  7118                 88  PM-12MO-MAILING           VALUE '1'.
  7119                 88  PM-EXP-MAILING            VALUE '2'.
  7120             20  PM-MAIL-STATUS            PIC X.
  7121                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  7122                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  7123                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  7124             20  PM-MAIL-DATE              PIC XX.
  7125     12  FILLER                            PIC XX.
  7126     12  FILLER                            PIC X(12).
  7127*    12  FILLER                            PIC X(30).
  7128
  7129******************************************************************
  7130*                                COPY ERCMAIL.
  7131******************************************************************
  7132*                                                                *
  7133*                                                                *
  7134*                            ERCMAIL                             *
  7135*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7136*                            VMOD=2.003                          *
  7137*                                                                *
  7138*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  7139*                                                                *
  7140*   FILE TYPE = VSAM,KSDS                                        *
  7141*   RECORD SIZE = 374   RECFORM = FIX                            *
  7142*                                                                *
  7143*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  7144*   ALTERNATE PATH    = NOT USED                                 *
  7145*                                                                *
  7146*   LOG = YES                                                    *
  7147*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7148******************************************************************
  7149*                   C H A N G E   L O G
  7150*
  7151* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7152*-----------------------------------------------------------------
  7153*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7154* EFFECTIVE    NUMBER
  7155*-----------------------------------------------------------------
  7156* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  7157* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  7158* 111108                   PEMA  ADD CRED BENE ADDR2
  7159******************************************************************
  7160
  7161 01  MAILING-DATA.
  7162     12  MA-RECORD-ID                      PIC XX.
  7163         88  VALID-MA-ID                       VALUE 'MA'.
  7164
  7165     12  MA-CONTROL-PRIMARY.
  7166         16  MA-COMPANY-CD                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 132
* EL6311.cbl
  7167         16  MA-CARRIER                    PIC X.
  7168         16  MA-GROUPING.
  7169             20  MA-GROUPING-PREFIX        PIC XXX.
  7170             20  MA-GROUPING-PRIME         PIC XXX.
  7171         16  MA-STATE                      PIC XX.
  7172         16  MA-ACCOUNT.
  7173             20  MA-ACCOUNT-PREFIX         PIC X(4).
  7174             20  MA-ACCOUNT-PRIME          PIC X(6).
  7175         16  MA-CERT-EFF-DT                PIC XX.
  7176         16  MA-CERT-NO.
  7177             20  MA-CERT-PRIME             PIC X(10).
  7178             20  MA-CERT-SFX               PIC X.
  7179
  7180     12  FILLER                            PIC XX.
  7181
  7182     12  MA-ACCESS-CONTROL.
  7183         16  MA-SOURCE-SYSTEM              PIC XX.
  7184             88  MA-FROM-CREDIT                VALUE 'CR'.
  7185             88  MA-FROM-VSI                   VALUE 'VS'.
  7186             88  MA-FROM-WARRANTY              VALUE 'WA'.
  7187             88  MA-FROM-OTHER                 VALUE 'OT'.
  7188         16  MA-RECORD-ADD-DT              PIC XX.
  7189         16  MA-RECORD-ADDED-BY            PIC XXXX.
  7190         16  MA-LAST-MAINT-DT              PIC XX.
  7191         16  MA-LAST-MAINT-BY              PIC XXXX.
  7192         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  7193
  7194     12  MA-PROFILE-INFO.
  7195         16  MA-QUALIFY-CODE-1             PIC XX.
  7196         16  MA-QUALIFY-CODE-2             PIC XX.
  7197         16  MA-QUALIFY-CODE-3             PIC XX.
  7198         16  MA-QUALIFY-CODE-4             PIC XX.
  7199         16  MA-QUALIFY-CODE-5             PIC XX.
  7200
  7201         16  MA-INSURED-LAST-NAME          PIC X(15).
  7202         16  MA-INSURED-FIRST-NAME         PIC X(10).
  7203         16  MA-INSURED-MIDDLE-INIT        PIC X.
  7204         16  MA-INSURED-ISSUE-AGE          PIC 99.
  7205         16  MA-INSURED-BIRTH-DT           PIC XX.
  7206         16  MA-INSURED-SEX                PIC X.
  7207             88  MA-SEX-MALE                   VALUE 'M'.
  7208             88  MA-SEX-FEMALE                 VALUE 'F'.
  7209         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  7210
  7211         16  MA-ADDRESS-CORRECTED          PIC X.
  7212         16  MA-JOINT-BIRTH-DT             PIC XX.
  7213*        16  FILLER                        PIC X(12).
  7214
  7215         16  MA-ADDRESS-LINE-1             PIC X(30).
  7216         16  MA-ADDRESS-LINE-2             PIC X(30).
  7217         16  MA-CITY-STATE.
  7218             20  MA-CITY                   PIC X(28).
  7219             20  MA-ADDR-STATE             PIC XX.
  7220         16  MA-ZIP.
  7221             20  MA-ZIP-CODE.
  7222                 24  MA-ZIP-CODE-1ST       PIC X(1).
  7223                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  7224                 24  FILLER                PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 133
* EL6311.cbl
  7225             20  MA-ZIP-PLUS4              PIC X(4).
  7226         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  7227             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  7228             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  7229             20  FILLER                    PIC X(3).
  7230
  7231         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  7232
  7233         16  FILLER                        PIC XXX.
  7234*        16  FILLER                        PIC X(10).
  7235
  7236     12  MA-CRED-BENE-INFO.
  7237         16  MA-CRED-BENE-NAME                 PIC X(25).
  7238         16  MA-CRED-BENE-ADDR                 PIC X(30).
  7239         16  MA-CRED-BENE-ADDR2                PIC X(30).
  7240         16  MA-CRED-BENE-CTYST.
  7241             20  MA-CRED-BENE-CITY             PIC X(28).
  7242             20  MA-CRED-BENE-STATE            PIC XX.
  7243         16  MA-CRED-BENE-ZIP.
  7244             20  MA-CB-ZIP-CODE.
  7245                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  7246                     88  MA-CB-CANADIAN-POST-CODE
  7247                                           VALUE 'A' THRU 'Z'.
  7248                 24  FILLER                    PIC X(4).
  7249             20  MA-CB-ZIP-PLUS4               PIC X(4).
  7250         16  MA-CB-CANADIAN-POSTAL-CODE
  7251                            REDEFINES MA-CRED-BENE-ZIP.
  7252             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  7253             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  7254             20  FILLER                        PIC X(3).
  7255     12  MA-POST-CARD-MAIL-DATA.
  7256         16  MA-MAIL-DATA OCCURS 7.
  7257             20  MA-MAIL-TYPE              PIC X.
  7258                 88  MA-12MO-MAILING           VALUE '1'.
  7259                 88  MA-EXP-MAILING            VALUE '2'.
  7260             20  MA-MAIL-STATUS            PIC X.
  7261                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  7262                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  7263                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  7264             20  MA-MAIL-DATE              PIC XX.
  7265     12  FILLER                            PIC XX.
  7266     12  FILLER                            PIC XX.
  7267*    12  FILLER                            PIC X(30).
  7268******************************************************************
  7269*                                COPY ERCRQST.
  7270******************************************************************
  7271*                                                                *
  7272*                                                                *
  7273*                            ERCRQST.                            *
  7274*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7275*                            VMOD=2.002                          *
  7276*                                                                *
  7277*   FILE DESCRIPTION = ACCOUNTS RECEIVABLE REQUEST RECORD        *
  7278*                                                                *
  7279*   FILE TYPE = VSAM,KSDS                                        *
  7280*   RECORD SIZE = 200  RECFORM = FIXED                           *
  7281*                                                                *
  7282*   BASE CLUSTER = ERRQST                         RKP=2,LEN=7    *
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 134
* EL6311.cbl
  7283*       ALTERNATE PATH1 = ERRQST2  (BY CO, CAR, GROUP, ST,       *
  7284*                                   ACCOUNT, REF, BATCH)         *
  7285*                                                RKP=9, LEN=38   *
  7286*       ALTERNATE PATH2 = ERRQST3  (BY CO, CAR, GROUP, FIN  RESP *
  7287*                                   ACCOUNT, REF, BATCH)         *
  7288*                                                RKP=47, LEN=46  *
  7289*       ALTERNATE PATH3 = ERRQST4  (BY CO, CAR, GROUP, AGENT,    *
  7290*                                   BATCH)                       *
  7291*                                                RKP=93, LEN=24  *
  7292*       ALTERNATE PATH4 = ERRQST5  (BY CO, SUMMARY CODE, ACCT,   *
  7293*                                   REF, BATCH)                  *
  7294*                                                RKP=117, LEN=35 *
  7295*   LOG = NO                                                     *
  7296*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7297******************************************************************
  7298
  7299 01  AR-REQUEST-RECORD.
  7300     12  RQ-RECORD-ID                     PIC XX.
  7301         88  VALID-RQ-ID                        VALUE 'RQ'.
  7302
  7303     12  RQ-CONTROL-PRIMARY.
  7304         16  RQ-COMPANY-CD                PIC X.
  7305         16  RQ-ENTRY-BATCH               PIC X(6).
  7306
  7307     12  RQ-CONTROL-BY-ACCT-REF.
  7308         16  RQ-COMPANY-CD-A1             PIC X.
  7309         16  RQ-CARRIER-A1                PIC X.
  7310         16  RQ-GROUPING-A1               PIC X(6).
  7311         16  RQ-STATE-A1                  PIC XX.
  7312         16  RQ-ACCOUNT-A1                PIC X(10).
  7313         16  RQ-REFERENCE-A1              PIC X(12).
  7314         16  RQ-BATCH-A1                  PIC X(6).
  7315
  7316     12  RQ-CONTROL-BY-FIN-RESP.
  7317         16  RQ-COMPANY-CD-A2             PIC X.
  7318         16  RQ-CARRIER-A2                PIC X.
  7319         16  RQ-GROUPING-A2               PIC X(6).
  7320         16  RQ-FIN-RESP-A2               PIC X(10).
  7321         16  RQ-ACCT-AGENT-A2             PIC X(10).
  7322         16  RQ-REFERENCE-A2              PIC X(12).
  7323         16  RQ-BATCH-A2                  PIC X(6).
  7324
  7325     12  RQ-CONTROL-BY-ACCT-AGENT.
  7326         16  RQ-COMPANY-CD-A3             PIC X.
  7327         16  RQ-CARRIER-A3                PIC X.
  7328         16  RQ-GROUPING-A3               PIC X(6).
  7329         16  RQ-ACCT-AGENT-A3             PIC X(10).
  7330         16  RQ-BATCH-A3                  PIC X(6).
  7331
  7332     12  RQ-CONTROL-BY-SUMMARY.
  7333         16  RQ-COMPANY-CD-A4             PIC X.
  7334         16  RQ-SUMMARY-CODE              PIC X(6).
  7335         16  RQ-ACCOUNT-A4                PIC X(10).
  7336         16  RQ-REFERENCE-A4              PIC X(12).
  7337         16  RQ-BATCH-A4                  PIC X(6).
  7338
  7339     12  RQ-REQUEST-METHOD                PIC X.
  7340         88 RQ-FIN-RESP-REQUEST               VALUE 'F'.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 135
* EL6311.cbl
  7341         88 RQ-ACCT-AGENT-REQUEST             VALUE 'A'.
  7342         88 RQ-SUMMARY-REQUEST                VALUE 'S'.
  7343         88 RQ-BATCH-REQUEST                  VALUE 'B'.
  7344     12  FILLER                           PIC X.
  7345     12  RQ-STATUS                        PIC X.
  7346         88  RQ-REQUEST-ERROR                 VALUE 'E'.
  7347         88  RQ-RESUBMIT                      VALUE 'R'.
  7348     12  RQ-PROCESSOR-ID                  PIC X(4).
  7349     12  RQ-ENTRY-DT                      PIC XX.
  7350     12  RQ-MO-END-DT                     PIC XX.
  7351     12  RQ-REQUEST-DT                    PIC XX.
  7352     12  RQ-STMT-DT                       PIC XX.
  7353     12  RQ-REVERSAL-DT                   PIC XX.
  7354     12  RQ-CREDIT-SELECT-DT              PIC XX.
  7355     12  RQ-CREDIT-ACCEPT-DT              PIC XX.
  7356
  7357     12  FILLER                           PIC X(27).
  7358
  7359******************************************************************
  7360
  7361*                                COPY ERCLOFC.
  7362******************************************************************
  7363*                                                                *
  7364*                                                                *
  7365*                            ERCLOFC                             *
  7366*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7367*                            VMOD=2.003                          *
  7368*                                                                *
  7369*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *
  7370*                                                                *
  7371*   FILE TYPE = VSAM,KSDS                                        *
  7372*   RECORD SIZE = 670   RECFORM = FIX                            *
  7373*                                                                *
  7374*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *
  7375*                                                                *
  7376*   LOG = YES                                                    *
  7377*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7378*                                                                *
  7379******************************************************************
  7380
  7381 01  LOAN-OFFICER-MASTER.
  7382     12  LO-RECORD-ID                PIC XX.
  7383         88  VALID-LO-ID                VALUE 'LO'.
  7384
  7385     12  LO-CONTROL-PRIMARY.
  7386         16  LO-COMPANY-CD           PIC X.
  7387         16  LO-CARRIER              PIC X.
  7388         16  LO-GROUPING.
  7389             20  LO-GROUPING-PREFIX  PIC XXX.
  7390             20  LO-GROUPING-PRIME   PIC XXX.
  7391         16  LO-STATE                PIC XX.
  7392         16  LO-ACCOUNT.
  7393             20  LO-ACCOUNT-PREFIX   PIC X(4).
  7394             20  LO-ACCOUNT-PRIME    PIC X(6).
  7395         16  LO-OFFICER-CODE         PIC X(5).
  7396
  7397     12  LO-OFFICER-NAME             PIC X(30).
  7398
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 136
* EL6311.cbl
  7399     12  LO-LAST-MAINT-DT            PIC XX.
  7400     12  LO-LAST-USER                PIC X(4).
  7401     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.
  7402
  7403     12  LO-COMP-CONTROL             PIC X.
  7404             88  LO-SHOW-COMP           VALUE 'Y'.
  7405             88  LO-SUPPRESS-COMP       VALUE 'N'.
  7406     12  LO-DETAIL-CONTROL           PIC X.
  7407             88  LO-PRINT-DETAIL        VALUE 'D'.
  7408             88  LO-PRINT-SUMMARY       VALUE 'S'.
  7409
  7410     12  LO-SV-CARRIER               PIC X.
  7411     12  LO-SV-GROUPING              PIC X(6).
  7412     12  LO-SV-STATE                 PIC XX.
  7413
  7414     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.
  7415     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.
  7416
  7417     12  LO-OFFICER-INFO.
  7418         16  FILLER OCCURS 12 TIMES.
  7419             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.
  7420             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.
  7421             20  LO-LF-COUNT         PIC S9(5) COMP-3.
  7422             20  LO-LF-PREM          PIC S9(7) COMP-3.
  7423             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.
  7424             20  LO-AH-COUNT         PIC S9(5) COMP-3.
  7425             20  LO-AH-PREM          PIC S9(7) COMP-3.
  7426             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.
  7427     12  FILLER                      PIC X(198).
  7428******************************************************************
  7429*                                COPY ERCPYAJ.
  7430******************************************************************
  7431*                                                                *
  7432*                            ERCPYAJ                             *
  7433*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7434*                            VMOD=2.015                          *
  7435*                                                                *
  7436*   FILE DESCRIPTION = PENDING PAYMENT AND ADJUSTMENTS           *
  7437*                                                                *
  7438*                                                                *
  7439*   FILE TYPE = VSAM,KSDS                                        *
  7440*   RECORD SIZE = 200  RECFORM = FIXED                           *
  7441*                                                                *
  7442*   BASE CLUSTER = ERPYAJ                         RKP=2,LEN=33   *
  7443*       ALTERNATE PATHS = NONE                                   *
  7444*                                                                *
  7445*   LOG = YES                                                    *
  7446*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7447******************************************************************
  7448******************************************************************
  7449*                   C H A N G E   L O G
  7450*
  7451* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7452*-----------------------------------------------------------------
  7453*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7454* EFFECTIVE    NUMBER
  7455*-----------------------------------------------------------------
  7456* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 137
* EL6311.cbl
  7457* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
  7458******************************************************************
  7459
  7460 01  PENDING-PAY-ADJ.
  7461     12  PY-RECORD-ID                     PIC XX.
  7462         88  VALID-PY-ID                        VALUE 'PY'.
  7463
  7464     12  PY-CONTROL-PRIMARY.
  7465         16  PY-COMPANY-CD                PIC X.
  7466         16  PY-CARRIER                   PIC X.
  7467         16  PY-GROUPING                  PIC X(6).
  7468         16  PY-FIN-RESP                  PIC X(10).
  7469         16  PY-ACCOUNT                   PIC X(10).
  7470         16  PY-PRODUCER REDEFINES PY-ACCOUNT
  7471                                          PIC X(10).
  7472         16  PY-FILE-SEQ-NO               PIC S9(8)     COMP.
  7473         16  PY-RECORD-TYPE               PIC X.
  7474             88  PY-REMIT-RECEIVED            VALUE 'R'.
  7475             88  PY-DEPOSIT                   VALUE 'D'.
  7476             88  PY-CHARGE-TO-AGENT           VALUE 'C'.
  7477             88  PY-ADJ-REM-RECEIVED          VALUE 'S'.
  7478             88  PY-ADJ-DEPOSIT               VALUE 'T'.
  7479             88  PY-ADJ-CHG-TO-AGT            VALUE 'U'.
  7480             88  PY-ADD-TO-YTD-COMP           VALUE 'X'.
  7481             88  PY-SUBTRACT-YTD-COMP         VALUE 'Y'.
  7482             88  PY-ADD-TO-BALANCE            VALUE 'Z'.
  7483             88  PY-FICA-ENTRY                VALUE 'F'.
  7484             88  PY-REMIT-IND-GROUPING        VALUE 'G'.
  7485             88  PY-POLICY-FEE                VALUE 'W'.
  7486             88  PY-DUE-PREM-ADJ              VALUE 'P'.
  7487
  7488     12  PY-PYMT-TYPE                     PIC X.
  7489             88  PY-NEW-BUS-PYMT              VALUE 'B'.
  7490             88  PY-REINS-PYMT                VALUE 'R'.
  7491             88  PY-EXP-PYMT                  VALUE 'E'.
  7492
  7493     12  PY-BIL-INV                       PIC X(6).
  7494     12  PY-REF-NO                        PIC X(12).
  7495
  7496     12  PY-LAST-MAINT-DT                 PIC XX.
  7497     12  PY-LAST-MAINT-BY                 PIC X(4).
  7498     12  PY-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  7499
  7500     12  PY-PYADJ-RECORD.
  7501         16  PY-ENTRY-AMT                 PIC S9(7)V99  COMP-3.
  7502         16  PY-ENTRY-COMMENT             PIC X(30).
  7503         16  PY-GL-DATA      REDEFINES PY-ENTRY-COMMENT.
  7504             20  PY-GL-ACCOUNT            PIC X(10).
  7505             20  PY-GL-STATE              PIC X(02).
  7506             20  PY-GL-CANC-SW            PIC X(01).
  7507                 88  PY-GL-CANC-SW-ON     VALUE 'Y'.
  7508                 88  PY-GL-CANC-SW-OFF    VALUE 'N'.
  7509             20  PY-GL-COMMENT            PIC X(10).
  7510             20  FILLER      REDEFINES PY-GL-COMMENT.
  7511                 24  PY-GL-CHECK-NO       PIC 9(06).
  7512                 24  FILLER               PIC X(04).
  7513             20  FILLER                   PIC X(07).
  7514         16  PY-SAVE-ACCOUNT              PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 138
* EL6311.cbl
  7515         16  PY-SAVE-TYPE                 PIC X(01).
  7516
  7517         16  PY-LETTERS.
  7518             20  PY-LETTER OCCURS 3 TIMES
  7519                           INDEXED BY PY-LET-NDX
  7520                                          PIC X(04).
  7521
  7522         16  PY-ERCOMP-TYPE               PIC X.
  7523             88  PY-ACCOUNT-TYPE              VALUE 'A'.
  7524             88  PY-GA-TYPE                   VALUE 'G'.
  7525             88  PY-BANK-TYPE                 VALUE 'B'.
  7526         16  FILLER                       PIC X(05).
  7527
  7528     12  PY-RECORD-STATUS.
  7529         16  PY-CREDIT-SELECT-DT          PIC XX.
  7530         16  PY-CREDIT-ACCEPT-DT          PIC XX.
  7531         16  PY-BILLED-DATE               PIC XX.
  7532         16  PY-REPORTED-DT               PIC XX.
  7533         16  PY-PMT-APPLIED               PIC X.
  7534             88  PY-ACCOUNT-PMT               VALUE 'A'.
  7535             88  PY-GA-PMT                    VALUE 'G'.
  7536             88  PY-OVWRITE-PMT               VALUE 'O'.
  7537             88  PY-NON-AR-PMT                VALUE 'N'.
  7538         16  FILLER                       PIC X(5).
  7539         16  PY-INPUT-DT                  PIC XX.
  7540         16  PY-CHECK-NUMBER              PIC X(6).
  7541         16  PY-VOID-SW                   PIC X.
  7542             88  PY-CHECK-VOIDED              VALUE 'V'.
  7543         16  PY-CHECK-ORIGIN-SW           PIC X.
  7544             88  PY-BILLING-CHECK             VALUE 'B'.
  7545             88  PY-REFUND-CHECK              VALUE 'R'.
  7546             88  PY-GA-CHECK                  VALUE 'G'.
  7547             88  PY-CHECK-WRITTEN             VALUE 'W'.
  7548             88  PY-CHECK-REVERSAL            VALUE 'V'.
  7549         16  PY-CHECK-WRITTEN-DT          PIC XX.
  7550         16  PY-CHECK-QUE-CONTROL         PIC S9(8) COMP.
  7551         16  PY-CHECK-QUE-SEQUENCE        PIC S9(4) COMP.
  7552         16  PY-BILL-FLAG                 PIC X.
  7553             88  PY-BILLED                    VALUE 'B'.
  7554         16  PY-AR-FLAG                   PIC X.
  7555             88  PY-AR-CYCLE                  VALUE 'C'.
  7556             88  PY-AR-MONTH-END              VALUE 'M'.
  7557         16  PY-AR-DATE                   PIC XX.
  7558
  7559     12  PY-GL-CODES.
  7560         16  PY-GL-DB                     PIC X(14).
  7561         16  PY-GL-CR                     PIC X(14).
  7562         16  PY-GL-FLAG                   PIC X.
  7563         16  PY-GL-DATE                   PIC XX.
  7564
  7565     12  PY-CANCEL-FEE-FLAG               PIC X(2).
  7566     12  FILLER                           PIC X(3).
  7567******************************************************************
  7568*                                COPY ERCCNOT.
  7569******************************************************************
  7570*                                                                *
  7571*                            ERCCNOT                             *
  7572*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 139
* EL6311.cbl
  7573*                            VMOD=2.003                          *
  7574*                                                                *
  7575*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  7576*                                                                *
  7577*        FILE TYPE= VSAM,KSDS                                    *
  7578*        RECORD SIZE = 150    RECFORM = FIXED                    *
  7579*                                                                *
  7580*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  7581*                                                                *
  7582*        LOG = YES                                               *
  7583*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7584*                                                                *
  7585******************************************************************
  7586*                   C H A N G E   L O G
  7587*
  7588* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7589*-----------------------------------------------------------------
  7590*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7591* EFFECTIVE    NUMBER
  7592*-----------------------------------------------------------------
  7593* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  7594******************************************************************
  7595
  7596 01  CERT-NOTE-FILE.
  7597     12  CZ-RECORD-ID                PIC  XX.
  7598         88  VALID-CZ-ID                  VALUE 'CZ'.
  7599
  7600     12  CZ-CONTROL-PRIMARY.
  7601         16  CZ-COMPANY-CD           PIC X.
  7602         16  CZ-CARRIER              PIC X.
  7603         16  CZ-GROUPING.
  7604             20 CZ-GROUPING-PREFIX   PIC XXX.
  7605             20 CZ-GROUPING-PRIME    PIC XXX.
  7606         16  CZ-STATE                PIC XX.
  7607         16  CZ-ACCOUNT.
  7608             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  7609             20 CZ-ACCOUNT-PRIME     PIC X(6).
  7610         16  CZ-CERT-EFF-DT          PIC XX.
  7611         16  CZ-CERT-NO.
  7612             20  CZ-CERT-PRIME       PIC X(10).
  7613             20  CZ-CERT-SFX         PIC X.
  7614         16  CZ-RECORD-TYPE          PIC X.
  7615             88  CERT-NOTE           VALUE '1'.
  7616             88  CLAIM-CERT-NOTE     VALUE '2'.
  7617         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  7618
  7619     12  CZ-LAST-MAINT-DT            PIC XX.
  7620     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  7621     12  CZ-LAST-MAINT-USER          PIC X(4).
  7622
  7623     12  CZ-NOTE-INFORMATION.
  7624         16  CZ-NOTE                 PIC X(63).
  7625         16  FILLER                  PIC X(39).
  7626******************************************************************
  7627*                                COPY ELCMSTR.
  7628******************************************************************
  7629*                                                                *
  7630*                            ELCMSTR.                            *
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 140
* EL6311.cbl
  7631*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7632*                            VMOD=2.012                          *
  7633*                                                                *
  7634*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  7635*                                                                *
  7636*   FILE TYPE = VSAM,KSDS                                        *
  7637*   RECORD SIZE = 350  RECFORM = FIXED                           *
  7638*                                                                *
  7639*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  7640*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  7641*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  7642*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  7643*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  7644*                                                 RKP=75,LEN=21  *
  7645*                                                                *
  7646*   **** NOTE ****                                               *
  7647*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  7648*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  7649*                                                                *
  7650*   LOG = YES                                                    *
  7651*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7652******************************************************************
  7653*                   C H A N G E   L O G
  7654*
  7655* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7656*-----------------------------------------------------------------
  7657*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7658* EFFECTIVE    NUMBER
  7659*-----------------------------------------------------------------
  7660* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  7661* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  7662* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  7663* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7664* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  7665* 081817    2016100700001  TANA  ADD NBR OF EXTENSIONS
  7666* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  7667******************************************************************
  7668 01  CLAIM-MASTER.
  7669     12  CL-RECORD-ID                PIC XX.
  7670         88  VALID-CL-ID         VALUE 'CL'.
  7671
  7672     12  CL-CONTROL-PRIMARY.
  7673         16  CL-COMPANY-CD           PIC X.
  7674         16  CL-CARRIER              PIC X.
  7675         16  CL-CLAIM-NO             PIC X(7).
  7676         16  CL-CERT-NO.
  7677             20  CL-CERT-PRIME       PIC X(10).
  7678             20  CL-CERT-SFX         PIC X.
  7679
  7680     12  CL-CONTROL-BY-NAME.
  7681         16  CL-COMPANY-CD-A1        PIC X.
  7682         16  CL-INSURED-LAST-NAME    PIC X(15).
  7683         16  CL-INSURED-NAME.
  7684             20  CL-INSURED-1ST-NAME PIC X(12).
  7685             20  CL-INSURED-MID-INIT PIC X.
  7686
  7687     12  CL-CONTROL-BY-SSN.
  7688         16  CL-COMPANY-CD-A2        PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 141
* EL6311.cbl
  7689         16  CL-SOC-SEC-NO.
  7690             20  CL-SSN-STATE        PIC XX.
  7691             20  CL-SSN-ACCOUNT      PIC X(6).
  7692             20  CL-SSN-LN3          PIC X(3).
  7693
  7694     12  CL-CONTROL-BY-CERT-NO.
  7695         16  CL-COMPANY-CD-A4        PIC X.
  7696         16  CL-CERT-NO-A4.
  7697             20  CL-CERT-A4-PRIME    PIC X(10).
  7698             20  CL-CERT-A4-SFX      PIC X.
  7699
  7700     12  CL-CONTROL-BY-CCN.
  7701         16  CL-COMPANY-CD-A5        PIC X.
  7702         16  CL-CCN-A5.
  7703             20  CL-CCN.
  7704                 24  CL-CCN-PREFIX-A5 PIC X(4).
  7705                 24  CL-CCN-PRIME-A5 PIC X(12).
  7706             20  CL-CCN-FILLER-A5    PIC X(4).
  7707
  7708     12  CL-INSURED-PROFILE-DATA.
  7709         16  CL-INSURED-BIRTH-DT     PIC XX.
  7710         16  CL-INSURED-SEX-CD       PIC X.
  7711             88  INSURED-IS-MALE        VALUE 'M'.
  7712             88  INSURED-IS-FEMALE      VALUE 'F'.
  7713             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  7714         16  CL-INSURED-OCC-CD       PIC X(6).
  7715         16  FILLER                  PIC X(5).
  7716
  7717     12  CL-PROCESSING-INFO.
  7718         16  CL-PROCESSOR-ID         PIC X(4).
  7719         16  CL-CLAIM-STATUS         PIC X.
  7720             88  CLAIM-IS-OPEN          VALUE 'O'.
  7721             88  CLAIM-IS-CLOSED        VALUE 'C'.
  7722         16  CL-CLAIM-TYPE           PIC X.
  7723*            88  AH-CLAIM               VALUE 'A'.
  7724*            88  LIFE-CLAIM             VALUE 'L'.
  7725*            88  PROPERTY-CLAIM         VALUE 'P'.
  7726*            88  IUI-CLAIM              VALUE 'I'.
  7727*            88  GAP-CLAIM              VALUE 'G'.
  7728*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  7729*            88  OTHER-CLAIM            VALUE 'O'.
  7730         16  CL-CLAIM-PREM-TYPE      PIC X.
  7731             88  SINGLE-PREMIUM         VALUE '1'.
  7732             88  O-B-COVERAGE           VALUE '2'.
  7733             88  OPEN-END-COVERAGE      VALUE '3'.
  7734         16  CL-INCURRED-DT          PIC XX.
  7735         16  CL-REPORTED-DT          PIC XX.
  7736         16  CL-FILE-ESTABLISH-DT    PIC XX.
  7737         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  7738         16  CL-LAST-PMT-DT          PIC XX.
  7739         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  7740         16  CL-PAID-THRU-DT         PIC XX.
  7741         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  7742         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  7743         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  7744         16  CL-PMT-CALC-METHOD      PIC X.
  7745             88  CL-360-DAY-YR          VALUE '1'.
  7746             88  CL-365-DAY-YR          VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 142
* EL6311.cbl
  7747             88  CL-FULL-MONTHS         VALUE '3'.
  7748         16  CL-CAUSE-CD             PIC X(6).
  7749
  7750         16  CL-PRIME-CERT-NO.
  7751             20  CL-PRIME-CERT-PRIME PIC X(10).
  7752             20  CL-PRIME-CERT-SFX   PIC X.
  7753
  7754         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  7755             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  7756             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  7757
  7758         16  CL-MICROFILM-NO         PIC X(10).
  7759         16  FILLER REDEFINES CL-MICROFILM-NO.
  7760             20  CL-BENEFIT-PERIOD   PIC 99.
  7761             20  FILLER              PIC X(8).
  7762         16  CL-PROG-FORM-TYPE       PIC X.
  7763         16  CL-LAST-ADD-ON-DT       PIC XX.
  7764
  7765         16  CL-LAST-REOPEN-DT       PIC XX.
  7766         16  CL-LAST-CLOSE-DT        PIC XX.
  7767         16  CL-LAST-CLOSE-REASON    PIC X(01).
  7768             88  FINAL-PAID             VALUE '1'.
  7769             88  CLAIM-DENIED           VALUE '2'.
  7770             88  AUTO-CLOSE             VALUE '3'.
  7771             88  MANUAL-CLOSE           VALUE '4'.
  7772             88  BENEFITS-CHANGED       VALUE 'C'.
  7773             88  SETUP-ERRORS           VALUE 'E'.
  7774         16  CL-ASSOC-CERT-SEQU      PIC S99.
  7775         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  7776         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  7777             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  7778         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  7779         16  FILLER                  PIC X.
  7780
  7781     12  CL-CERTIFICATE-DATA.
  7782         16  CL-CERT-ORIGIN          PIC X.
  7783             88  CERT-WAS-ONLINE        VALUE '1'.
  7784             88  CERT-WAS-CREATED       VALUE '2'.
  7785             88  COVERAGE-WAS-ADDED     VALUE '3'.
  7786         16  CL-CERT-KEY-DATA.
  7787             20  CL-CERT-CARRIER     PIC X.
  7788             20  CL-CERT-GROUPING    PIC X(6).
  7789             20  CL-CERT-STATE       PIC XX.
  7790             20  CL-CERT-ACCOUNT.
  7791                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  7792                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  7793             20  CL-CERT-EFF-DT      PIC XX.
  7794
  7795     12  CL-STATUS-CONTROLS.
  7796         16  CL-PRIORITY-CD          PIC X.
  7797             88  CONFIDENTIAL-DATA      VALUE '8'.
  7798             88  HIGHEST-PRIORITY       VALUE '9'.
  7799         16  CL-SUPV-ATTN-CD         PIC X.
  7800             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  7801             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  7802         16  CL-PURGED-DT            PIC XX.
  7803         16  CL-RESTORED-DT          PIC XX.
  7804         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 143
* EL6311.cbl
  7805         16  CL-NEXT-RESEND-DT       PIC XX.
  7806         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  7807         16  CL-CRITICAL-PERIOD      PIC 99.
  7808*        16  FILLER                  PIC XX.
  7809         16  CL-LAST-MAINT-DT        PIC XX.
  7810         16  CL-LAST-MAINT-USER      PIC X(4).
  7811         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  7812         16  CL-LAST-MAINT-TYPE      PIC X.
  7813             88  CLAIM-SET-UP           VALUE ' '.
  7814             88  PAYMENT-MADE           VALUE '1'.
  7815             88  LETTER-SENT            VALUE '2'.
  7816             88  MASTER-WAS-ALTERED     VALUE '3'.
  7817             88  MASTER-WAS-RESTORED    VALUE '4'.
  7818             88  INCURRED-DATE-CHANGED  VALUE '5'.
  7819             88  FILE-CONVERTED         VALUE '6'.
  7820             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  7821             88  ERROR-CORRECTION       VALUE 'E'.
  7822         16  CL-RELATED-CLAIM-NO     PIC X(7).
  7823         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  7824         16  CL-BENEFICIARY          PIC X(10).
  7825         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  7826         16  CL-DENIAL-TYPE          PIC X.
  7827             88  CL-TYPE-DENIAL          VALUE '1'.
  7828             88  CL-TYPE-RESCISSION      VALUE '2'.
  7829             88  CL-TYPE-REFORMATION     VALUE '3'.
  7830             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  7831             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  7832         16  CL-NO-OF-EXTENSIONS     PIC 99.
  7833         16  filler                  pic x(3).
  7834*        16  CL-CRIT-PER-RECURRENT   PIC X.
  7835*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  7836*        16  CL-RTW-DT               PIC XX.
  7837
  7838     12  CL-TRAILER-CONTROLS.
  7839         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  7840             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  7841             88  CL-LAST-TRL-AVAIL      VALUE +100.
  7842             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  7843         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  7844         16  FILLER                  PIC XX.
  7845         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  7846         16  CL-ADDRESS-TRAILER-CNT.
  7847             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  7848                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  7849             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  7850                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  7851             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  7852                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  7853             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  7854                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  7855             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  7856                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  7857             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  7858                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  7859             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  7860                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  7861
  7862     12  CL-CV-REFERENCE-NO.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 144
* EL6311.cbl
  7863         16  CL-CV-REFNO-PRIME       PIC X(18).
  7864         16  CL-CV-REFNO-SFX         PIC XX.
  7865
  7866     12  CL-FILE-LOCATION            PIC X(4).
  7867
  7868     12  CL-PROCESS-ERRORS.
  7869         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  7870             88  NO-FATAL-ERRORS        VALUE ZERO.
  7871         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  7872             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  7873
  7874     12  CL-PRODUCT-CD               PIC X.
  7875
  7876     12  CL-CURRENT-KEY-DATA.
  7877         16  CL-CURRENT-CARRIER      PIC X.
  7878         16  CL-CURRENT-GROUPING     PIC X(6).
  7879         16  CL-CURRENT-STATE        PIC XX.
  7880         16  CL-CURRENT-ACCOUNT      PIC X(10).
  7881
  7882     12  CL-ASSOCIATES               PIC X.
  7883         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  7884         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  7885         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  7886         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  7887
  7888     12  CL-ACTIVITY-CODE            PIC 99.
  7889     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  7890     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  7891
  7892     12  CL-LAPSE-REPORT-CODE        PIC 9.
  7893     12  CL-LAG-REPORT-CODE          PIC 9.
  7894     12  CL-LOAN-TYPE                PIC XX.
  7895     12  CL-LEGAL-STATE              PIC XX.
  7896
  7897     12  CL-YESNOSW                  PIC X.
  7898     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  7899         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  7900         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  7901         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  7902     12  cl-insured-type             pic x.
  7903         88  cl-claim-on-primary         value 'P'.
  7904         88  cl-claim-on-co-borrower     value 'C'.
  7905     12  cl-benefit-expiration-dt    PIC XX.
  7906*                                COPY ERCENDT.
  7907******************************************************************
  7908*                                                                *
  7909*                                                                *
  7910*                            ERCENDT.                            *
  7911*                            VMOD=2.001                          *
  7912*                                                                *
  7913*   FILE DESCRIPTION = ENDORSEMENT FILE                          *
  7914*                                                                *
  7915*   FILE TYPE = VSAM,KSDS                                        *
  7916*   RECORD SIZE = 579  RECFORM = FIXED                           *
  7917*                                                                *
  7918*   BASE CLUSTER = ERENDT                         RKP=02,LEN=36  *
  7919*       ALTERNATE PATH1 = ERENDT2 (BY ARCH NO)    RKP=38,LEN=05  *
  7920*                                                                *
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 145
* EL6311.cbl
  7921*   LOG = NO                                                     *
  7922*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7923******************************************************************
  7924*-----------------------------------------------------------------
  7925*                   C H A N G E   L O G
  7926*
  7927* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7928*-----------------------------------------------------------------
  7929*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7930* EFFECTIVE    NUMBER
  7931*-----------------------------------------------------------------
  7932* 052307    2006052600001  AJRA  ADDED FLAG FOR CANCELS ON CERTS
  7933*                                WITH OPEN CLAIMS
  7934* 072312    2011022800001  AJRA  ADDED BATCH NUMBER
  7935* 110612    2012101700002  AJRA  ADD NEW FIELDS
  7936* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7937* 010616  CR2015082000001  PEMA  ADD ENDORSEMENT CHECK PROCESSING
  7938*-----------------------------------------------------------------
  7939 01  ENDORSEMENT-RECORD.
  7940     12  EN-RECORD-ID                PIC XX.
  7941         88  VALID-EN-ID                VALUE 'EN'.
  7942     12  EN-CONTROL-PRIMARY.
  7943         16  EN-COMPANY-CD           PIC X.
  7944         16  EN-CARRIER              PIC X.
  7945         16  EN-GROUPING             PIC X(6).
  7946         16  EN-STATE                PIC XX.
  7947         16  EN-ACCOUNT              PIC X(10).
  7948         16  EN-CERT-EFF-DT          PIC XX.
  7949         16  EN-CERT-NO.
  7950             20  EN-CERT-PRIME       PIC X(10).
  7951             20  EN-CERT-SFX         PIC X.
  7952         16  EN-REC-TYPE             PIC X.
  7953             88  EN-ISSUE               VALUE 'I'.
  7954             88  EN-CANCELLATION        VALUE 'C'.
  7955         16  EN-SEQ-NO               PIC 9(04) BINARY.
  7956     12  EN-CONTROL-BY-ARCH-NO.
  7957         16  EN-COMPANY-CD-A1              PIC X.
  7958         16  EN-ARCHIVE-NO                 PIC 9(8) BINARY.
  7959     12  EN-LAST-MAINT-DT            PIC XX.
  7960     12  EN-LAST-MAINT-BY            PIC X(4).
  7961     12  EN-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  7962     12  EN-ENDORSEMENT-RECORD       PIC X(329).
  7963     12  EN-ISSUE-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  7964         16  EN-INS-ORIG-LAST-NAME   PIC X(15).
  7965         16  EN-INS-ORIG-FIRST-NAME  PIC X(10).
  7966         16  EN-INS-ORIG-MIDDLE-INIT PIC X.
  7967         16  EN-INS-ORIG-AGE         PIC S999     COMP-3.
  7968         16  EN-JNT-ORIG-LAST-NAME   PIC X(15).
  7969         16  EN-JNT-ORIG-FIRST-NAME  PIC X(10).
  7970         16  EN-JNT-ORIG-MIDDLE-INIT PIC X.
  7971         16  EN-JNT-ORIG-AGE         PIC S999     COMP-3.
  7972         16  EN-LF-ORIG-BENCD        PIC XX.
  7973         16  EN-LF-ORIG-TERM         PIC S999      COMP-3.
  7974         16  EN-LF-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  7975         16  EN-LF-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  7976         16  EN-LF-ORIG-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
  7977         16  EN-LF-ORIG-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
  7978         16  EN-LF-ORIG-EXP-DT       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 146
* EL6311.cbl
  7979*        16  EN-LF-ORIG-COV-TYPE     PIC X(10).
  7980         16  EN-ORIG-CRED-BENE       PIC X(25).
  7981         16  EN-LF-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  7982         16  FILLER                  PIC X.
  7983         16  EN-AH-ORIG-BENCD        PIC XX.
  7984         16  EN-AH-ORIG-TERM         PIC S999      COMP-3.
  7985         16  EN-AH-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  7986         16  EN-AH-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  7987         16  EN-AH-ORIG-EXP-DT       PIC XX.
  7988*        16  EN-AH-ORIG-COV-TYPE     PIC X(10).
  7989*        16  EN-AH-ORIG-WAIT-PER     PIC 99.
  7990         16  EN-AH-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  7991         16  F                       PIC X(09).
  7992         16  EN-AH-ORIG-CP           PIC 99.
  7993         16  EN-INS-NEW-LAST-NAME    PIC X(15).
  7994         16  EN-INS-NEW-FIRST-NAME   PIC X(10).
  7995         16  EN-INS-NEW-MIDDLE-INIT  PIC X.
  7996         16  EN-INS-NEW-AGE          PIC S999     COMP-3.
  7997         16  EN-JNT-NEW-LAST-NAME    PIC X(15).
  7998         16  EN-JNT-NEW-FIRST-NAME   PIC X(10).
  7999         16  EN-JNT-NEW-MIDDLE-INIT  PIC X.
  8000         16  EN-JNT-NEW-AGE          PIC S999     COMP-3.
  8001         16  EN-LF-NEW-BENCD         PIC XX.
  8002         16  EN-LF-NEW-TERM          PIC S999      COMP-3.
  8003         16  EN-LF-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  8004         16  EN-LF-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  8005         16  EN-LF-NEW-ALT-BEN-AMT   PIC S9(9)V99  COMP-3.
  8006         16  EN-LF-NEW-ALT-PRM-AMT   PIC S9(7)V99  COMP-3.
  8007         16  EN-LF-NEW-EXP-DT        PIC XX.
  8008         16  EN-NEW-CRED-BENE        PIC X(25).
  8009         16  EN-LF-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  8010         16  FILLER                  PIC X.
  8011         16  EN-AH-NEW-BENCD         PIC XX.
  8012         16  EN-AH-NEW-TERM          PIC S999      COMP-3.
  8013         16  EN-AH-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  8014         16  EN-AH-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  8015         16  EN-AH-NEW-EXP-DT        PIC XX.
  8016*        16  EN-AH-NEW-COV-TYPE      PIC X(10).
  8017*        16  EN-AH-NEW-WAIT-PER      PIC 99.
  8018*        16  F                       PIC X(12).
  8019         16  EN-AH-NEW-CP            PIC 99.
  8020         16  EN-SIG-SW               PIC X.
  8021         16  EN-AH-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  8022         16  EN-INS-ORIG-AGE-DEF-FLAG PIC X.
  8023         16  EN-JNT-ORIG-AGE-DEF-FLAG PIC X.
  8024         16  EN-INS-NEW-AGE-DEF-FLAG PIC X.
  8025         16  EN-JNT-NEW-AGE-DEF-FLAG PIC X.
  8026         16  FILLER                  PIC X(33).
  8027     12  EN-CANCEL-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  8028         16  EN-LF-ORIG-REF-DT       PIC XX.
  8029         16  EN-LF-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  8030         16  EN-AH-ORIG-REF-DT       PIC XX.
  8031         16  EN-AH-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  8032         16  EN-LF-NEW-REF-DT        PIC XX.
  8033         16  EN-LF-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  8034         16  EN-AH-NEW-REF-DT        PIC XX.
  8035         16  EN-AH-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  8036         16  EN-FLAG-CERT            PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 147
* EL6311.cbl
  8037         16  EN-INS-LAST-NAME        PIC X(15).
  8038         16  EN-INS-FIRST-NAME       PIC X(10).
  8039         16  EN-INS-MIDDLE-INIT      PIC X.
  8040         16  EN-LF-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  8041         16  EN-AH-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  8042         16  EN-LF-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  8043         16  EN-AH-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  8044         16  FILLER                  PIC X(262).
  8045     12  EN-MONEY-SW             PIC X.
  8046     12  EN-HEALTH-APP           PIC X.
  8047     12  EN-VOUCHER-SW           PIC X.
  8048     12  EN-PAYEE                PIC X(14).
  8049     12  EN-INPUT-DT             PIC XX.
  8050     12  EN-PROCESS-DT           PIC XX.
  8051     12  EN-LF-COMMISSION        PIC SV9(5)    COMP-3.
  8052     12  EN-AH-COMMISSION        PIC SV9(5)    COMP-3.
  8053     12  EN-REASON-CODES.
  8054         16  F OCCURS 12.
  8055             20  EN-REASON-CODE  PIC X(4).
  8056     12  EN-TEMPLATE-USED        PIC X(8).
  8057     12  EN-DOCU-TYPE            PIC X.
  8058         88  EN-VERI-DOCU          VALUE 'V'.
  8059         88  EN-GCE-DOCU           VALUE 'G'.
  8060         88  EN-CANC-DOCU          VALUE 'C'.
  8061     12  EN-COMMENTS1            PIC X(13).
  8062     12  EN-COMMENTS2            PIC X(70).
  8063     12  EN-COMM-CHGBK           PIC X.
  8064         88  EN-DO-NOT-CHG-ACCT    VALUE 'N'.
  8065         88  EN-CHG-ACCT           VALUE 'Y'.
  8066     12  EN-CSO-PORTION          PIC S9(5)V99  COMP-3.
  8067     12  EN-ACCT-PORTION         PIC S9(5)V99  COMP-3.
  8068     12  EN-BATCH-NUMBER         PIC X(6).
  8069     12  EN-ACCT-SUMM            PIC X.
  8070     12  EN-CSO-SUMM             PIC X.
  8071     12  en-check-type           pic x.
  8072     12  FILLER                  PIC X(12).
  8073******************************************************************
  8074*                                COPY ELCCRTT.
  8075******************************************************************
  8076*                                                                *
  8077*                            ELCCRTT.                            *
  8078*                                                                *
  8079*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  8080*                                                                *
  8081*   FILE TYPE = VSAM,KSDS                                        *
  8082*   RECORD SIZE = 552  RECFORM = FIXED                           *
  8083*                                                                *
  8084*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  8085*                                                                *
  8086*   LOG = YES                                                    *
  8087*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  8088******************************************************************
  8089*                   C H A N G E   L O G
  8090*
  8091* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  8092*-----------------------------------------------------------------
  8093*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  8094* EFFECTIVE    NUMBER
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 148
* EL6311.cbl
  8095*-----------------------------------------------------------------
  8096* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  8097* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  8098* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  8099* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  8100* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  8101* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  8102* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  8103* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  8104* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  8105* 012918  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
  8106* 091318  CR2018073000001  PEMA  ADD Refund methods
  8107* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  8108******************************************************************
  8109
  8110 01  CERTIFICATE-TRAILERS.
  8111     12  CS-RECORD-ID                      PIC XX.
  8112         88  VALID-CS-ID                      VALUE 'CS'.
  8113
  8114     12  CS-CONTROL-PRIMARY.
  8115         16  CS-COMPANY-CD                 PIC X.
  8116         16  CS-CARRIER                    PIC X.
  8117         16  CS-GROUPING                   PIC X(6).
  8118         16  CS-STATE                      PIC XX.
  8119         16  CS-ACCOUNT                    PIC X(10).
  8120         16  CS-CERT-EFF-DT                PIC XX.
  8121         16  CS-CERT-NO.
  8122             20  CS-CERT-PRIME             PIC X(10).
  8123             20  CS-CERT-SFX               PIC X.
  8124         16  CS-TRAILER-TYPE               PIC X.
  8125             88  COMM-TRLR           VALUE 'A'.
  8126             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  8127             88  CERT-DATA-TRLR      VALUE 'C'.
  8128
  8129     12  CS-DATA-AREA                      PIC X(516).
  8130
  8131     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  8132         16  CS-BANK-COMMISSION-AREA.
  8133             20  CS-BANK-COMMS       OCCURS 10.
  8134                 24  CS-AGT                PIC X(10).
  8135                 24  CS-COM-TYP            PIC X.
  8136                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  8137                 24  CS-RECALC-LV-INDIC    PIC X.
  8138                 24  FILLER                PIC X(10).
  8139         16  FILLER                        PIC X(256).
  8140
  8141     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  8142****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  8143         16  CS-MB-CLAIM-DATA OCCURS 24.
  8144             20  CS-CLAIM-NO               PIC X(7).
  8145             20  CS-CLAIM-TYPE             PIC X.
  8146                 88  CS-AH-CLM               VALUE 'A'.
  8147                 88  CS-IU-CLM               VALUE 'I'.
  8148                 88  CS-GP-CLM               VALUE 'G'.
  8149                 88  CS-LF-CLM               VALUE 'L'.
  8150                 88  CS-PR-CLM               VALUE 'P'.
  8151                 88  CS-FL-CLM               VALUE 'F'.
  8152                 88  CS-OT-CLM               VALUE 'O'.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 149
* EL6311.cbl
  8153             20  CS-INSURED-TYPE           PIC X.
  8154                 88  CS-PRIM-INSURED          VALUE 'P'.
  8155                 88  CS-CO-BORROWER           VALUE 'C'.
  8156             20  CS-BENEFIT-PERIOD         PIC 99.
  8157             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  8158             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  8159             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  8160         16  FILLER                        PIC X(12).
  8161     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  8162         16  CS-VIN-NUMBER                 PIC X(17).
  8163         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  8164         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  8165         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  8166         16  cs-agent-name.
  8167             20  cs-agent-fname            pic x(20).
  8168             20  cs-agent-mi               pic x.
  8169             20  cs-agent-lname            pic x(25).
  8170         16  cs-license-no                 pic x(15).
  8171         16  cs-npn-number                 pic x(10).
  8172         16  cs-agent-edit-status          pic x.
  8173             88  cs-ae-refer-to-manager      value 'M'.
  8174             88  cs-ae-cover-sheet           value 'C'.
  8175             88  cs-ae-sig-form              value 'S'.
  8176             88  cs-ae-verified              value 'V'.
  8177             88  cs-unidentified-signature   value 'U'.
  8178             88  cs-cert-returned            value 'R'.
  8179             88  cs-accept-no-commission     value 'N'.
  8180         16  cs-year                       pic 9999.
  8181         16  cs-make                       pic x(20).
  8182         16  cs-model                      pic x(20).
  8183         16  cs-future                     pic x(20).
  8184         16  cs-vehicle-odometer           pic s9(7) comp-3.
  8185         16  cs-claim-verification-status  pic x.
  8186             88  cs-clm-ver-eligible         value 'A'.
  8187             88  cs-clm-ver-partial-elig     value 'B'.
  8188             88  cs-clm-ver-not-eligible     value 'C'.
  8189             88  cs-clm-ver-not-elig-opn-clm value 'D'.
  8190             88  cs-clm-ver-not-part-elig-rw value 'E'.
  8191             88  cs-clm-ver-ND-CERT          value 'F'.
  8192             88  cs-clm-ver-spec-other       value 'G'.
  8193             88  cs-clam-ver-pratial-corrected
  8194                                             value 'H'.
  8195             88  cs-clm-ver-no-matches       value 'I'.
  8196             88  cs-clm-ver-not-elig-corrected
  8197                                             value 'J'.
  8198             88  cs-clm-ver-needs-review     value 'R'.
  8199             88  cs-clm-ver-sent-to-claims   value 'W'.
  8200         16  CS-LF-REFUND-METHOD           PIC X.
  8201         16  CS-AH-REFUND-METHOD           PIC X.
  8202         16  FILLER                        PIC X(353). *> was 420
  8203*        16  FILLER                        PIC X(496).
  8204*                                COPY ERCCHEK.
  8205******************************************************************
  8206*                                                                *
  8207*                                                                *
  8208*                            ERCCHEK                             *
  8209*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  8210*                            VMOD=2.008                          *
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 150
* EL6311.cbl
  8211*                                                                *
  8212*   FILE DESCRIPTION = CHECK RECORDS                             *
  8213*                                                                *
  8214*   FILE TYPE = VSAM,KSDS                                        *
  8215*   RECORD SIZE = 600    RECFORM = FIXED                         *
  8216*                                                                *
  8217*   BASE CLUSTER NAME = ERCHEK             RKP=2,LEN=35          *
  8218*       ALTERNATE INDEX = NONE                                   *
  8219*                                                                *
  8220*   LOG = YES                                                    *
  8221*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  8222******************************************************************
  8223*                   C H A N G E   L O G
  8224*
  8225* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  8226*-----------------------------------------------------------------
  8227*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  8228* EFFECTIVE    NUMBER
  8229*-----------------------------------------------------------------
  8230* 021414    2003053000001  PEMA  changes for auto chk request
  8231******************************************************************
  8232 01  CHECK-RECORDS.
  8233     12  CH-RECORD-ID                      PIC XX.
  8234         88  VALID-CH-ID                      VALUE 'CH'.
  8235
  8236     12  CH-CONTROL-PRIMARY.
  8237         16  CH-COMPANY-CD                 PIC X.
  8238         16  CH-CARRIER                    PIC X.
  8239         16  CH-GROUPING                   PIC X(6).
  8240         16  CH-STATE                      PIC XX.
  8241         16  CH-ACCOUNT                    PIC X(10).
  8242         16  CH-CERT-EFF-DT                PIC XX.
  8243         16  CH-CERT-NO.
  8244             20  CH-CERT-PRIME             PIC X(10).
  8245             20  CH-CERT-SFX               PIC X.
  8246         16  CH-SEQUENCE-NO                PIC S9(4)     COMP.
  8247
  8248     12  CH-RECORDED-DT                    PIC XX.
  8249     12  CH-RECORDED-BY                    PIC X(4).
  8250     12  CH-LAST-MAINT-HHMMSS              PIC S9(6)     COMP-3.
  8251
  8252     12  CH-AMOUNT-PAID                    PIC S9(7)V99  COMP-3.
  8253     12  CH-CHECK-NO                       PIC X(7).
  8254     12  CH-REASON-FOR-CHECK               PIC X(25).
  8255     12  CH-CHECK-WRITTEN-DT               PIC XX.
  8256     12  FILLER                            PIC X.
  8257
  8258     12  CH-PAYEE-INFO.
  8259         16  CH-PAYEE-NAME-1               PIC X(30).
  8260         16  CH-PAYEE-NAME-2               PIC X(30).
  8261         16  CH-PAYEE-ADDRESS-1            PIC X(30).
  8262         16  CH-PAYEE-ADDRESS-2            PIC X(30).
  8263         16  CH-PAYEE-CITY-ST.
  8264             20  CH-PAYEE-CITY             PIC X(28).
  8265             20  CH-PAYEE-STATE            PIC XX.
  8266         16  CH-PAYEE-ZIP-CODE.
  8267             20  CH-PAYEE-ZIP.
  8268                 24  CH-ZIP-PRI-1ST        PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 151
* EL6311.cbl
  8269                     88  CH-CANADIAN-POST-CODE
  8270                                           VALUES 'A' THRU 'Z'.
  8271                 24  FILLER                PIC X(4).
  8272             20  CH-PAYEE-ZIP-EXT          PIC X(4).
  8273         16  CH-CANADIAN-POSTAL-CODE REDEFINES CH-PAYEE-ZIP-CODE.
  8274             20  CH-CAN-POSTAL-1           PIC XXX.
  8275             20  CH-CAN-POSTAL-2           PIC XXX.
  8276             20  FILLER                    PIC XXX.
  8277
  8278     12  CH-CHECK-STUB-TEXT.
  8279         16  CH-STUB-LINE-1                PIC X(30).
  8280         16  CH-TEXT-LINE-1                PIC X(50).
  8281         16  CH-TEXT-LINE-2                PIC X(50).
  8282         16  CH-TEXT-LINE-3                PIC X(40).
  8283     12  CH-RETURN-TO                      PIC X(30).
  8284
  8285     12  CH-COMPENSATION-CONTROL.
  8286         16  CH-COMP-CARRIER               PIC X.
  8287         16  CH-COMP-GROUPING              PIC X(6).
  8288         16  CH-COMP-FIN-RESP              PIC X(10).
  8289         16  CH-COMP-ACCOUNT               PIC X(10).
  8290
  8291     12  CH-CREDIT-SELECT-DT               PIC XX.
  8292     12  CH-CREDIT-ACCEPT-DT               PIC XX.
  8293     12  CH-PAYEE-CODE                     PIC X(6).
  8294
  8295     12  CH-VOID-DATA.
  8296         20  CH-VOID-DT                    PIC XX.
  8297         20  CH-VOID-BY                    PIC X(4).
  8298         20  CH-VOID-REASON                PIC X(25).
  8299
  8300     12  CH-APPROVAL-DATA.
  8301         20  CH-APPROVAL-DT                PIC XX.
  8302         20  CH-APPROVAL-STATUS            PIC X.
  8303             88  CH-IN-LIMBO                  VALUE ' '.
  8304             88  CH-APPROV-PENDING            VALUE 'P' '2'.
  8305             88  CH-APPROVED                  VALUE 'A'.
  8306             88  CH-DENIED                    VALUE 'D'.
  8307         20  CH-APPROVED-BY                PIC XXXX.
  8308     12  CH-CHECK-QUE-CONTROL              PIC S9(8)     COMP.
  8309             88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  8310     12  CH-CHECK-QUE-SEQUENCE             PIC S9(4)     COMP.
  8311
  8312     12  ch-released-dt                    pic xx.
  8313     12  ch-check-cashed-dt                pic xx.
  8314     12  FILLER                            PIC X.
  8315*    12  CH-CHECK-REFERENCE                PIC X(12).
  8316     12  CH-CHECK-ORIGIN-SW                PIC X.
  8317             88  CH-REFUND-CHECK              VALUE 'R'.
  8318             88  CH-MAINT-CHECK               VALUE 'M'.
  8319
  8320     12  CH-CANC-DT                        PIC XX.
  8321     12  CH-LF-REFUND                      PIC S9(7)V99  COMP-3.
  8322     12  CH-AH-REFUND                      PIC S9(7)V99  COMP-3.
  8323
  8324     12  CH-INSURED-NAME                   PIC X(28).
  8325
  8326     12  ch-released-by                    pic x(4).
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 152
* EL6311.cbl
  8327     12  ch-csr                            pic x(4).
  8328     12  ch-deduct-commission              pic x.
  8329         88  ch-deduct-comm                  value 'Y'.
  8330         88  ch-do-not-deduct-comm           value 'N'.
  8331
  8332     12  FILLER                            PIC X(11).
  8333*    12  CH-LETTER-TABLE.
  8334*        16  CH-LETTERS OCCURS 3 TIMES
  8335*                       INDEXED BY CH-LT-NDX
  8336*                                          PIC X(04).
  8337
  8338     12  FILLER                            PIC X(07).
  8339
  8340 01  var                         pic x(30).
  8341 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA PENDING-BUSINESS
  8342                          CERTIFICATE-MASTER CERTIFICATE-NOTE
  8343                          PENDING-MAILING-DATA MAILING-DATA
  8344                          AR-REQUEST-RECORD LOAN-OFFICER-MASTER
  8345                          PENDING-PAY-ADJ CERT-NOTE-FILE
  8346                          CLAIM-MASTER ENDORSEMENT-RECORD
  8347                          CERTIFICATE-TRAILERS CHECK-RECORDS
  8348                          VAR.
  8349 0000-DFHEXIT SECTION.
  8350     MOVE '9#                    $   ' TO DFHEIV0.
  8351     MOVE 'EL6311' TO DFHEIV1.
  8352     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  8353
  8354     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  8355     MOVE EIBTRMID               TO QID-TERM.
  8356     MOVE 3                      TO EMI-NUMBER-OF-LINES.
  8357     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  8358     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  8359     MOVE 2                      TO EMI-SWITCH2.
  8360
  8361     move spaces to ws-kix-myenv
  8362     set P to address of KIXSYS
  8363     CALL "getenv" using by value P returning var-ptr
  8364     if var-ptr = null then
  8365        display ' kixsys not set '
  8366     else
  8367        set address of var to var-ptr
  8368        move 0 to env-var-len
  8369        inspect var tallying env-var-len
  8370          for characters before X'00'
  8371        unstring var (1:env-var-len) delimited by '/'
  8372           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  8373              WS-KIX-SYS
  8374        end-unstring
  8375     end-if
  8376     perform varying a1 from +1 by +1 until a1 > +10
  8377        if ws-kix-myenv (a1:1) = low-values or high-values
  8378           display ' found low or hi val '
  8379           move spaces to ws-kix-myenv (a1:1)
  8380        end-if
  8381     end-perform
  8382*    display ' env *' ws-kix-myenv '*'
  8383     IF EIBCALEN = 0
  8384         GO TO 8800-UNAUTHORIZED-ACCESS.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 153
* EL6311.cbl
  8385
  8386     MOVE EIBDATE               TO DC-JULIAN-YYDDD.
  8387     MOVE '5'                   TO DC-OPTION-CODE.
  8388     PERFORM 9700-DATE-LINK.
  8389     MOVE DC-GREG-DATE-1-EDIT   TO  WS-CURRENT-DT.
  8390     MOVE DC-BIN-DATE-1         TO  WS-CURRENT-BIN-DT.
  8391
  8392     MOVE PI-CR-MONTH-END-DT     TO DC-BIN-DATE-1.
  8393     MOVE SPACE                  TO DC-OPTION-CODE.
  8394     PERFORM 9700-DATE-LINK.
  8395     MOVE DC-GREG-DATE-1-EDIT    TO WS-MONTH-END-DT.
  8396     MOVE LOW-VALUES             TO EL631BI.
  8397
  8398
  8399* EXEC CICS HANDLE CONDITION
  8400*        PGMIDERR  (9600-PGMID-ERROR)
  8401*        ERROR     (9990-ABEND)
  8402*        INVREQ    (9990-ABEND)
  8403*        QIDERR    (0010-MAIN-LOGIC)
  8404*    END-EXEC.
  8405*    MOVE '"$L.8N                ! " #00008394' TO DFHEIV0
  8406     MOVE X'22244C2E384E202020202020' TO DFHEIV0(1:12)
  8407     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8408     MOVE X'2220233030303038333934' TO DFHEIV0(25:11)
  8409     CALL 'kxdfhei1' USING DFHEIV0
  8410     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8411
  8412
  8413     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  8414         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  8415             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  8416             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  8417             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  8418             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  8419             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  8420             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  8421             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  8422             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  8423
  8424             IF  PI-RETURN-TO-PROGRAM EQUAL 'EL631'
  8425                 PERFORM 6050-DELETE-TEMP-STORAGE THRU 6050-EXIT
  8426
  8427             ELSE
  8428                 NEXT SENTENCE
  8429
  8430         ELSE
  8431             IF PI-CALLING-PROGRAM = 'EL6315'
  8432                SET CALLED-FROM-6315 TO TRUE
  8433             END-IF
  8434             MOVE PI-CALLING-PROGRAM   TO PGM-NAME
  8435             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  8436             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  8437             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  8438             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  8439             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  8440             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  8441             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  8442             MOVE SPACES               TO PI-SAVED-PROGRAM-6
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 154
* EL6311.cbl
  8443             PERFORM 6050-RECOVER-TEMP-STORAGE THRU 6050-EXIT
  8444             MOVE LOW-VALUES TO EC-NEW-CERT EC-NEW-STATE
  8445             GO TO 3900-RE-DISPLAY-RECORD
  8446     ELSE
  8447         GO TO 0020-MAIN-LOGIC.
  8448
  8449 0010-MAIN-LOGIC.
  8450     MOVE 'Y'                    TO WS-FIRST-TIME-SW
  8451                                    WS-FIRST-ENTRY-SW.
  8452
  8453     MOVE ' '                    TO WS-CANCEL-LETTER-SW.
  8454
  8455     MOVE LOW-VALUES             TO EC-NEW-CERT
  8456                                    EC-NEW-STATE.
  8457
  8458     IF PI-DISPLAY-ORIGINAL-BATCH
  8459         NEXT SENTENCE
  8460     ELSE
  8461         IF ALL-OUT-OF-BAL   OR  ONLY-BATCH-HEADERS
  8462             GO TO 5000-BROWSE-BATCH-HEADERS.
  8463
  8464     IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  8465         GO TO 4100-BROWSE-PRIMARY-FORWARD.
  8466
  8467     IF PI-CSR-BROWSE
  8468        GO TO 4200-BROWSE-CSR-FORWARD.
  8469
  8470     IF PI-FILE-BROWSE
  8471         GO TO 4300-BROWSE-FILE-FORWARD.
  8472
  8473     GO TO 4000-BROWSE-DETAIL-FORWARD.
  8474
  8475 0020-MAIN-LOGIC.
  8476     IF EIBAID = DFHCLEAR
  8477         GO TO 9400-CLEAR.
  8478
  8479     MOVE LOW-VALUES             TO EC-NEW-CERT
  8480                                    EC-NEW-STATE.
  8481
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 155
* EL6311.cbl
  8483
  8484******************************************************************
  8485*                                                                *
  8486*              R E C E I V E   M A P                             *
  8487*                                                                *
  8488******************************************************************
  8489
  8490 0200-RECEIVE.
  8491     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  8492         MOVE ER-0008            TO EMI-ERROR
  8493         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8494         IF PI-MAP-NAME = EL631B
  8495             MOVE -1                 TO BMAINTL
  8496             GO TO 8200-SEND-DATAONLY
  8497         ELSE
  8498             IF PI-MAP-NAME = EL631C
  8499                 MOVE -1                 TO CMAINTL
  8500                 GO TO 8200-SEND-DATAONLY
  8501             ELSE
  8502                 IF PI-MAP-NAME = EL631D
  8503                     MOVE -1                 TO DPFENTRL
  8504                     GO TO 8200-SEND-DATAONLY.
  8505
  8506
  8507* EXEC CICS RECEIVE
  8508*        MAP      (PI-MAP-NAME)
  8509*        MAPSET   (MAPSET-EL6311S)
  8510*        INTO     (EL631BI)
  8511*    END-EXEC.
  8512     MOVE LENGTH OF
  8513      EL631BI
  8514       TO DFHEIV11
  8515*    MOVE '8"T I  L              ''   #00008494' TO DFHEIV0
  8516     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  8517     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8518     MOVE X'2020233030303038343934' TO DFHEIV0(25:11)
  8519     CALL 'kxdfhei1' USING DFHEIV0,
  8520           PI-MAP-NAME,
  8521           EL631BI,
  8522           DFHEIV11,
  8523           MAPSET-EL6311S,
  8524           DFHEIV99,
  8525           DFHEIV99
  8526     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8527
  8528
  8529******************************************************************
  8530*        TRANSFORM  UNDERLINE CHARACTERS TO SPACES               *
  8531******************************************************************
  8532
  8533     IF BTYPE-LEN (1) EQUAL +3
  8534        IF BTYPE (1) EQUAL ALL ' '
  8535            MOVE 'Y' TO WS-REMOVE-LF-SW.
  8536
  8537     IF BTYPE-LEN (2) EQUAL +3
  8538        IF BTYPE (2) EQUAL ALL ' '
  8539            MOVE 'Y' TO WS-REMOVE-AH-SW.
  8540
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 156
* EL6311.cbl
  8541     INSPECT EL631BI CONVERTING '_' TO ' '.
  8542
  8543     IF PI-MAP-NAME = EL631B
  8544         IF BPFENTRL GREATER THAN ZEROS
  8545             IF EIBAID NOT = DFHENTER
  8546                 MOVE ER-0004       TO EMI-ERROR
  8547                 MOVE -1            TO BPFENTRL
  8548                 MOVE AL-UNBOF      TO BPFENTRA
  8549                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8550                 GO TO 8200-SEND-DATAONLY
  8551             ELSE
  8552                 IF BPFENTRI NUMERIC AND
  8553                   (BPFENTRI GREATER 0 AND LESS 25)
  8554                     MOVE PF-VALUES (BPFENTRI) TO EIBAID
  8555                 ELSE
  8556                     MOVE ER-0029  TO EMI-ERROR
  8557                     MOVE AL-UNBON TO BPFENTRA
  8558                     MOVE -1       TO BPFENTRL
  8559                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8560                     GO TO 8200-SEND-DATAONLY
  8561         ELSE
  8562             NEXT SENTENCE
  8563     ELSE
  8564         IF PI-MAP-NAME = EL631C
  8565            IF CPFENTRL GREATER THAN ZEROS
  8566                IF EIBAID NOT = DFHENTER
  8567                 MOVE ER-0004         TO EMI-ERROR
  8568                 MOVE -1              TO CPFENTRL
  8569                 MOVE AL-UNBOF        TO CPFENTRA
  8570                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8571                 GO TO 8200-SEND-DATAONLY
  8572             ELSE
  8573                 IF CPFENTRI NUMERIC AND
  8574                   (CPFENTRI GREATER 0 AND LESS 25)
  8575                     MOVE PF-VALUES (CPFENTRI) TO EIBAID
  8576                 ELSE
  8577                     MOVE ER-0029      TO EMI-ERROR
  8578                     MOVE AL-UNBON     TO CPFENTRA
  8579                     MOVE -1           TO CPFENTRL
  8580                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8581                     GO TO 8200-SEND-DATAONLY
  8582         ELSE
  8583             NEXT SENTENCE
  8584     ELSE
  8585     IF PI-MAP-NAME = EL631D
  8586         IF DPFENTRL GREATER THAN ZEROS
  8587             IF EIBAID NOT = DFHENTER
  8588                 MOVE ER-0004         TO EMI-ERROR
  8589                 MOVE -1              TO DPFENTRL
  8590                 MOVE AL-UNBOF        TO DPFENTRA
  8591                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8592                 GO TO 8200-SEND-DATAONLY
  8593             ELSE
  8594                 IF DPFENTRI NUMERIC AND
  8595                   (DPFENTRI GREATER 0 AND LESS 25)
  8596                     MOVE PF-VALUES (DPFENTRI) TO EIBAID
  8597                 ELSE
  8598                     MOVE ER-0029      TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 157
* EL6311.cbl
  8599                     MOVE AL-UNBON     TO DPFENTRA
  8600                     MOVE -1           TO DPFENTRL
  8601                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8602                     GO TO 8200-SEND-DATAONLY.
  8603
  8604     IF EIBAID = DFHPF23
  8605         GO TO 8810-PF23.
  8606
  8607     IF EIBAID = DFHPF24
  8608         GO TO 9200-RETURN-MAIN-MENU.
  8609
  8610     IF EIBAID = DFHPF12
  8611         GO TO 9500-PF12.
  8612
  8613     IF PI-MAP-NAME = EL631B
  8614        GO TO 0300-CHECK-ISSUE-PF-KEYS.
  8615
  8616     IF PI-MAP-NAME = EL631C
  8617        GO TO 0400-CHECK-CANCEL-PF-KEYS.
  8618
  8619     IF PI-MAP-NAME = EL631D
  8620        GO TO 0500-CHECK-BATCH-PF-KEYS.
  8621
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 158
* EL6311.cbl
  8623
  8624******************************************************************
  8625*                                                                *
  8626*      ISSUE SCREEN PF KEY CHECKING                              *
  8627*                                                                *
  8628******************************************************************
  8629
  8630******************************************************************
  8631*                                                                *
  8632*      PF KEY FUNCTIONS:                                         *
  8633*                                                                *
  8634*      PF1  = BROWSE FORWARD                                     *
  8635*      PF2  = BROWSE BACKWARD                                    *
  8636*      PF3  = CERTIFICATE LOOKUP                                 *
  8637*      PF4  = DISPLAY BATCH HEADER                               *
  8638*      PF5  = ADD ISSUE  SCREEN                                  *
  8639*      PF6  = ADD CANCEL SCREEN                                  *
  8640*      PF7  = CERTIFICATE DISPLAY                                *
  8641*      PF8  = CERTIFICATE NOTES                                  *
  8642*      PF9  = EDIT CONTROL                                       *
  8643*      PF10 = DISPLAY LETTER SCREEN                              *
  8644*      PF11 = DISPLAY EXPANDED LIST OF ERRORS                    *
  8645*      PF12 = HELP SCREEN                                        *
  8646*      PF13 = CONTINUE ISSUE DISPLAY (SECOND SCREEN)             *
  8647*      PF14 = ACCOUNT MASTER                                     *
  8648*      PF15 = PROCESS CERT VERIFICATION OR GENERAL CHG ENDORSEMNT*
  8649*      PF16 = DISPLAY LETTER REVIEW                              *
  8650*                                                                *
  8651******************************************************************
  8652
  8653 0300-CHECK-ISSUE-PF-KEYS.
  8654     IF EIBAID = DFHPF9 AND PI-EDIT-SW NOT = '1'
  8655        MOVE ER-2337            TO EMI-ERROR
  8656        MOVE -1                  TO BMAINTL
  8657        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8658        GO TO 8200-SEND-DATAONLY.
  8659
  8660     IF EIBAID = DFHPF1
  8661        MOVE '0'                TO PI-EDIT-SW
  8662        IF PI-PRIMARY-BROWSE
  8663           GO TO 4100-BROWSE-PRIMARY-FORWARD
  8664        ELSE
  8665           IF PI-PRIMARY-WITH-SELECT
  8666              GO TO 4100-BROWSE-PRIMARY-FORWARD
  8667           ELSE
  8668              IF PI-FILE-BROWSE
  8669                 GO TO 4300-BROWSE-FILE-FORWARD
  8670              ELSE
  8671                 IF PI-CSR-BROWSE
  8672                    GO TO 4200-BROWSE-CSR-FORWARD
  8673                 ELSE
  8674                    GO TO 4000-BROWSE-DETAIL-FORWARD.
  8675
  8676     IF EIBAID = DFHPF2
  8677        MOVE '0'                TO PI-EDIT-SW
  8678        IF PI-PRIMARY-BROWSE
  8679           GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8680        ELSE
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 159
* EL6311.cbl
  8681           IF PI-PRIMARY-WITH-SELECT
  8682              GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8683           ELSE
  8684              IF PI-FILE-BROWSE
  8685                 GO TO 4800-BROWSE-FILE-BACKWARD
  8686              ELSE
  8687                 IF PI-CSR-BROWSE
  8688                    GO TO 4900-BROWSE-CSR-BACKWARD
  8689                 ELSE
  8690                    GO TO 4500-BROWSE-DETAIL-BACKWARD.
  8691
  8692     IF EIBAID = DFHPF3
  8693        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8694        MOVE XCTL-EL127         TO PGM-NAME
  8695        GO TO 9300-XCTL.
  8696
  8697     IF (EIBAID = DFHPF15 OR DFHPF6)
  8698        AND (CSR-EDIT-SESSION)
  8699*       AND (FATAL-OR-UNFORCED)
  8700*       AND (FATAL-ERRORS)
  8701        and (pi-6311-fatal-ctr <> +0)
  8702        MOVE ER-1819             TO EMI-ERROR
  8703        MOVE -1                  TO BMAINTL
  8704        MOVE AL-UANON            TO BMAINTA
  8705        PERFORM 9900-ERROR-FORMAT
  8706                                 THRU 9900-EXIT
  8707        GO TO 8200-SEND-DATAONLY
  8708     END-IF
  8709     IF (EIBAID = DFHPF15 AND CSR-EDIT-SESSION)
  8710      OR (EIBAID = DFHPF10)
  8711        MOVE PI-PREV-ALT-KEY     TO PB-CONTROL-BY-ACCOUNT
  8712        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
  8713        IF (RESP-NORMAL)
  8714           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
  8715              AM-CONTROL-PRIMARY (1:20))
  8716            IF AM-NAME NOT GREATER THAN SPACES OR
  8717               AM-ADDRS NOT GREATER THAN SPACES  OR
  8718               AM-ADDR-CITY NOT GREATER THAN SPACES OR
  8719               AM-ADDR-STATE NOT GREATER THAN SPACES OR
  8720               AM-ZIP NOT GREATER THAN SPACES
  8721               MOVE ER-3834             TO EMI-ERROR
  8722               MOVE -1                  TO BMAINTL
  8723               MOVE AL-UANON            TO BMAINTA
  8724               PERFORM 9900-ERROR-FORMAT
  8725                                 THRU 9900-EXIT
  8726               GO TO 8200-SEND-DATAONLY
  8727            END-IF
  8728        ELSE
  8729           MOVE ER-1609             TO EMI-ERROR
  8730           MOVE -1                  TO BMAINTL
  8731           MOVE AL-UANON            TO BMAINTA
  8732           PERFORM 9900-ERROR-FORMAT
  8733                                THRU 9900-EXIT
  8734           GO TO 8200-SEND-DATAONLY
  8735        END-IF
  8736
  8737        MOVE PI-PREV-ALT-KEY (1:33) TO ELCERT-KEY
  8738        PERFORM 6220-READ-ERMAIL THRU 6220-EXIT
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 160
* EL6311.cbl
  8739        IF (ERMAIL-FOUND)
  8740            IF (MA-ADDRESS-LINE-1 NOT GREATER THAN SPACES AND
  8741               MA-ADDRESS-LINE-2 NOT GREATER THAN SPACES)  OR
  8742               MA-CITY NOT GREATER THAN SPACES OR
  8743               MA-ADDR-STATE NOT GREATER THAN SPACES OR
  8744               MA-ZIP-CODE NOT GREATER THAN SPACES
  8745               MOVE ER-3835             TO EMI-ERROR
  8746               MOVE -1                  TO BMAINTL
  8747               MOVE AL-UANON            TO BMAINTA
  8748               PERFORM 9900-ERROR-FORMAT
  8749                                 THRU 9900-EXIT
  8750               GO TO 8200-SEND-DATAONLY
  8751            END-IF
  8752        ELSE
  8753           MOVE ER-3000             TO EMI-ERROR
  8754           MOVE -1                  TO BMAINTL
  8755           MOVE AL-UANON            TO BMAINTA
  8756           PERFORM 9900-ERROR-FORMAT
  8757                                THRU 9900-EXIT
  8758           GO TO 8200-SEND-DATAONLY
  8759        END-IF
  8760
  8761     END-IF
  8762     IF (EIBAID = DFHPF15)
  8763        AND (CSR-EDIT-SESSION)
  8764        MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
  8765        MOVE PI-SV-CARRIER       TO PI-CARRIER
  8766        MOVE PI-SV-GROUPING      TO PI-GROUPING
  8767        MOVE PI-SV-STATE         TO PI-STATE
  8768        MOVE ERPNDB-ACCOUNT      TO PI-ACCOUNT
  8769        MOVE BCERTNOI            TO PI-CERT-PRIME
  8770        MOVE BSUFIXI             TO PI-CERT-SFX
  8771        MOVE BEFFDTI             TO DEEDIT-FIELD
  8772        PERFORM 8600-DEEDIT
  8773        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  8774        MOVE '4'                 TO DC-OPTION-CODE
  8775        PERFORM 9700-DATE-LINK
  8776        IF DATE-CONVERSION-ERROR
  8777           MOVE ER-0348          TO EMI-ERROR
  8778           MOVE -1               TO BEFFDTL
  8779           MOVE AL-UABON         TO BEFFDTA
  8780           PERFORM 9900-ERROR-FORMAT
  8781                                 THRU 9900-EXIT
  8782           GO TO 8200-SEND-DATAONLY
  8783        ELSE
  8784           MOVE DC-BIN-DATE-1    TO PI-CERT-EFF-DT
  8785           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8786           MOVE XCTL-EL6315      TO PGM-NAME
  8787           MOVE '1'              TO PI-6315-ISS-CAN-SW
  8788           MOVE LOW-VALUES       TO PI-6315-PASS-AREA
  8789           PERFORM 6400-CHECK-FOR-RES-REF-CLAIM THRU 6400-EXIT
  8790           MOVE WS-EL6315-PASS-AREA TO PI-PROGRAM-WORK-AREA
  8791           GO TO 9300-XCTL
  8792        END-IF
  8793     END-IF
  8794
  8795     IF EIBAID = DFHPF4
  8796        MOVE '0'                TO PI-EDIT-SW
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 161
* EL6311.cbl
  8797        IF PI-DISPLAY-ORIGINAL-BATCH
  8798           NEXT SENTENCE
  8799        ELSE
  8800           GO TO 7200-DISPLAY-BATCHES.
  8801
  8802     IF EIBAID = DFHPF5
  8803        MOVE ER-0029                TO EMI-ERROR
  8804        MOVE -1                     TO BPFENTRL
  8805        MOVE AL-UNBON               TO BPFENTRA
  8806        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8807        GO TO 8200-SEND-DATAONLY.
  8808*        MOVE '0'                TO PI-EDIT-SW
  8809*        IF PI-DISPLAY-ORIGINAL-BATCH
  8810*           NEXT SENTENCE
  8811*        ELSE
  8812*           MOVE EL631B              TO PI-MAP-NAME
  8813*           MOVE LOW-VALUES          TO EL631BI
  8814*           MOVE 'A'                 TO BMAINTO
  8815*           MOVE AL-UANON            TO BMAINTA
  8816*           MOVE -1                  TO BMAINTL
  8817*           MOVE '5'                 TO PI-MAINT-FUNCTION
  8818*           GO TO 8100-SEND-INITIAL-MAP.
  8819
  8820     IF EIBAID = DFHPF6
  8821        IF NOT CSR-EDIT-SESSION
  8822           MOVE ER-0029                TO EMI-ERROR
  8823           MOVE -1                     TO BPFENTRL
  8824           MOVE AL-UNBON               TO BPFENTRA
  8825           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8826           GO TO 8200-SEND-DATAONLY
  8827*           MOVE '0'              TO PI-EDIT-SW
  8828*           IF PI-DISPLAY-ORIGINAL-BATCH
  8829*              NEXT SENTENCE
  8830*           ELSE
  8831*              MOVE EL631C        TO PI-MAP-NAME
  8832*              MOVE LOW-VALUES    TO EL631CI
  8833*              MOVE 'A'           TO CMAINTO
  8834*              MOVE AL-UANON      TO CMAINTA
  8835*              MOVE -1            TO CMAINTL
  8836*              MOVE '6'           TO PI-MAINT-FUNCTION
  8837*              GO TO 8100-SEND-INITIAL-MAP
  8838*           END-IF
  8839        ELSE
  8840           PERFORM 5100-PROCESS-POL-RESC
  8841                                 THRU 5100-EXIT
  8842           MOVE  PI-PREV-CONTROL-PRIMARY
  8843                                 TO ERPNDB-KEY
  8844
  8845* EXEC CICS READ
  8846*              SET     (ADDRESS OF PENDING-BUSINESS)
  8847*              DATASET (FILE-ID-ERPNDB)
  8848*              RIDFLD  (ERPNDB-KEY)
  8849*          END-EXEC
  8850*    MOVE '&"S        E          (   #00008815' TO DFHEIV0
  8851     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8852     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8853     MOVE X'2020233030303038383135' TO DFHEIV0(25:11)
  8854     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 162
* EL6311.cbl
  8855           FILE-ID-ERPNDB,
  8856           DFHEIV20,
  8857           DFHEIV99,
  8858           ERPNDB-KEY,
  8859           DFHEIV99,
  8860           DFHEIV99,
  8861           DFHEIV99
  8862     SET ADDRESS OF PENDING-BUSINESS TO
  8863         DFHEIV20
  8864     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8865           PERFORM 9800-LINK-PENDING-EDIT
  8866                                 THRU 9800-EXIT
  8867           MOVE CG-BATCH-NO      TO PI-PB-ENTRY-BATCH
  8868           MOVE CG-BATCH-SEQ-NO  TO PI-PB-BATCH-SEQ-NO
  8869                                    PI-PREV-SEQ-NO
  8870           MOVE 'Y'              TO WS-FIRST-TIME-SW
  8871*                                    WS-CANCEL-LETTER-SW
  8872                                    PI-ALL-ISSUES-SW
  8873                                    PI-ALL-CANCELS-SW
  8874           GO TO 4100-BROWSE-PRIMARY-FORWARD
  8875        END-IF
  8876     END-IF
  8877     IF EIBAID = DFHPF7
  8878        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8879        MOVE PI-SV-CARRIER          TO PI-CARRIER
  8880        MOVE PI-SV-GROUPING         TO PI-GROUPING
  8881        MOVE PI-SV-STATE            TO PI-STATE
  8882        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  8883        MOVE BCERTNOI               TO PI-CERT-PRIME
  8884        MOVE BSUFIXI                TO PI-CERT-SFX
  8885        MOVE BEFFDTI                TO DEEDIT-FIELD
  8886        PERFORM 8600-DEEDIT
  8887        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  8888        MOVE '4'                    TO DC-OPTION-CODE
  8889        PERFORM 9700-DATE-LINK
  8890        IF DATE-CONVERSION-ERROR
  8891           MOVE ER-0348            TO EMI-ERROR
  8892           MOVE -1                  TO BEFFDTL
  8893           MOVE AL-UABON            TO BEFFDTA
  8894           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8895           GO TO 8200-SEND-DATAONLY
  8896        ELSE
  8897           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  8898           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8899           MOVE XCTL-EL1273        TO PGM-NAME
  8900           GO TO 9300-XCTL.
  8901
  8902     IF EIBAID = DFHPF8
  8903        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8904        MOVE PI-SV-CARRIER          TO PI-CARRIER
  8905        MOVE PI-SV-GROUPING         TO PI-GROUPING
  8906        MOVE PI-SV-STATE            TO PI-STATE
  8907        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  8908        MOVE BCERTNOI               TO PI-CERT-PRIME
  8909        MOVE BSUFIXI                TO PI-CERT-SFX
  8910        MOVE BEFFDTI                TO DEEDIT-FIELD
  8911        PERFORM 8600-DEEDIT
  8912        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 163
* EL6311.cbl
  8913        MOVE '4'                    TO DC-OPTION-CODE
  8914        PERFORM 9700-DATE-LINK
  8915        IF DATE-CONVERSION-ERROR
  8916           MOVE ER-0348            TO EMI-ERROR
  8917           MOVE -1                  TO BEFFDTL
  8918           MOVE AL-UABON            TO BEFFDTA
  8919           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8920           GO TO 8200-SEND-DATAONLY
  8921        ELSE
  8922           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  8923           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8924           move ERPNDB-RECORD-TYPE to pi-program-work-area(1:1)
  8925           IF PI-COMPANY-ID = 'DMD'
  8926               MOVE XCTL-EL401DMD      TO PGM-NAME
  8927             ELSE
  8928               MOVE XCTL-EL1279        TO PGM-NAME
  8929           END-IF
  8930           GO TO 9300-XCTL.
  8931
  8932     IF EIBAID = DFHPF9 AND PI-EDIT-SW = '1'
  8933        MOVE XCTL-EL6312         TO PGM-NAME
  8934
  8935* EXEC CICS XCTL
  8936*           PROGRAM   (PGM-NAME)
  8937*           COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  8938*           LENGTH    (WS-COMM-LENGTH)
  8939*       END-EXEC
  8940*    MOVE '.$C                   %   #00008889' TO DFHEIV0
  8941     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  8942     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8943     MOVE X'2020233030303038383839' TO DFHEIV0(25:11)
  8944     CALL 'kxdfhei1' USING DFHEIV0,
  8945           PGM-NAME,
  8946           PROGRAM-INTERFACE-BLOCK,
  8947           WS-COMM-LENGTH,
  8948           DFHEIV99
  8949     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8950     ELSE
  8951        MOVE '0'                 TO  PI-EDIT-SW.
  8952
  8953     IF  EIBAID = DFHPF10
  8954         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8955         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  8956         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  8957                                    PI-1042-WA
  8958         MOVE 4                  TO PI-689-DATA-SOURCE
  8959         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  8960         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  8961         MOVE PI-SV-STATE        TO PI-689-STATE
  8962         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  8963         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  8964         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  8965         MOVE PI-PB-ALT-CHG-SEQ-NO
  8966                                 TO PI-689-ALT-SEQ-NO
  8967         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  8968         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  8969         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  8970         MOVE +0                 TO PI-689-CONTROL
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 164
* EL6311.cbl
  8971         MOVE LOW-VALUES         TO PI-689-DATE-EDIT
  8972                                    PI-689-EXP-DATE
  8973                                    PI-689-RESP-PERSON
  8974                                    PI-689-TYPE
  8975                                    PI-689-FOLLOW-UP-EDIT
  8976                                    PI-689-RESEND1-EDIT
  8977                                    PI-689-SEQ-EDIT
  8978                                    PI-689-BCSEQ-EDIT
  8979                                    PI-689-LBL-OVERRIDE
  8980         MOVE W-LETTER-COMMUNICATION-AREAS
  8981                                 TO PI-PROGRAM-WORK-AREA
  8982         MOVE XCTL-EL689         TO PGM-NAME
  8983         GO TO 9300-XCTL.
  8984
  8985     IF  EIBAID = DFHPF16
  8986         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8987         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  8988         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  8989                                    PI-1042-WA
  8990         MOVE 4                  TO PI-689-DATA-SOURCE
  8991         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  8992         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  8993         MOVE PI-SV-STATE        TO PI-689-STATE
  8994         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  8995         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  8996         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  8997         MOVE PI-PB-ALT-CHG-SEQ-NO
  8998                                 TO PI-689-ALT-SEQ-NO
  8999         MOVE PI-PB-RECORD-TYPE  TO PI-689-CHG-SEQ-NO
  9000         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  9001         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  9002         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  9003         move '1'                to PI-689-CHG-SEQ-NOX
  9004         MOVE W-LETTER-COMMUNICATION-AREAS
  9005                                 TO PI-PROGRAM-WORK-AREA
  9006         MOVE XCTL-EL690         TO PGM-NAME
  9007         GO TO 9300-XCTL.
  9008
  9009     IF EIBAID = DFHPF13
  9010         MOVE XCTL-EL6313        TO PGM-NAME
  9011         GO TO 9300-XCTL.
  9012
  9013     IF EIBAID = DFHPF17
  9014        PERFORM 6200-CREATE-VADS THRU 6200-EXIT
  9015        IF (PB-I-LOAN-APR numeric)
  9016           and (pb-i-loan-apr < 99.9999)
  9017           AND (PB-I-BENEFICIARY-NAME NOT
  9018              = SPACES AND LOW-VALUES)
  9019
  9020           MOVE LINK-ELVADS          TO PGM-NAME
  9021
  9022* EXEC CICS LINK
  9023*              PROGRAM    (PGM-NAME)
  9024*              COMMAREA   (WS-PASS-AREA)
  9025*              LENGTH     (WS-PASS-AREA-LENGTH)
  9026*          END-EXEC
  9027*    MOVE '."C                   (   #00008965' TO DFHEIV0
  9028     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 165
* EL6311.cbl
  9029     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9030     MOVE X'2020233030303038393635' TO DFHEIV0(25:11)
  9031     CALL 'kxdfhei1' USING DFHEIV0,
  9032           PGM-NAME,
  9033           WS-PASS-AREA,
  9034           WS-PASS-AREA-LENGTH,
  9035           DFHEIV99,
  9036           DFHEIV99,
  9037           DFHEIV99,
  9038           DFHEIV99
  9039     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9040
  9041           MOVE 0000             TO EMI-ERROR
  9042           MOVE -1               TO BMAINTL
  9043           PERFORM 9900-ERROR-FORMAT
  9044                                 THRU 9900-EXIT
  9045           GO TO 8200-SEND-DATAONLY
  9046        ELSE
  9047           MOVE ER-0877            TO EMI-ERROR
  9048           MOVE -1                  TO BEFFDTL
  9049           MOVE AL-UABON            TO BEFFDTA
  9050           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9051           GO TO 8200-SEND-DATAONLY
  9052        END-IF
  9053     END-IF
  9054     IF EIBAID = DFHPF14
  9055        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9056        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
  9057        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
  9058        MOVE PI-SV-STATE            TO PI-CR-STATE
  9059        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  9060        MOVE SPACE                  TO PI-EDIT-SW
  9061        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9062        MOVE XCTL-EL650             TO PGM-NAME
  9063        GO TO 9300-XCTL.
  9064
  9065     IF EIBAID = DFHPF15
  9066        IF PI-COMPANY-ID  =  'HER'
  9067            PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9068            MOVE XCTL-EL680         TO PGM-NAME
  9069            GO TO 9300-XCTL.
  9070
  9071     IF EIBAID = DFHENTER OR DFHPF11
  9072        GO TO 1000-ISSUE-MAINLINE.
  9073
  9074     MOVE ER-0029                TO EMI-ERROR
  9075     MOVE -1                     TO BPFENTRL
  9076     MOVE AL-UNBON               TO BPFENTRA
  9077     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9078     GO TO 8200-SEND-DATAONLY.
  9079
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 166
* EL6311.cbl
  9081
  9082******************************************************************
  9083*                                                                *
  9084*      CANCEL SCREEN PF KEY CHECKING                             *
  9085*                                                                *
  9086******************************************************************
  9087
  9088******************************************************************
  9089*                                                                *
  9090*      PF KEY FUNCTIONS:                                         *
  9091*                                                                *
  9092*      PF1  = BROWSE FORWARD                                     *
  9093*      PF2  = BROWSE BACKWARD                                    *
  9094*      PF3  = CERTIFICATE LOOKUP                                 *
  9095*      PF4  = DISPLAY BATCH HEADER                               *
  9096*      PF5  = ADD ISSUE SCREEN                                   *
  9097*      PF6  = ADD CANCEL SCREEN                                  *
  9098*      PF7  = CERTIFICATE DISPLAY                                *
  9099*      PF8  = CERTIFICATE NOTES                                  *
  9100*      PF9  = EDIT CONTROL                                       *
  9101*      PF10 = DISPLAY LETTER SCREEN                              *
  9102*      PF11 = DISPLAY EXPANDED LIST OF ERRORS                    *
  9103*      PF12 = DISPLAY HELP SCREEN                                *
  9104*      PF13 = CHECK WRITER FOR CANCEL SETTLEMENTS                *
  9105*      PF14 = ACCOUNT MASTER                                     *
  9106*      PF16 = LETTER REVIEW                                      *
  9107*                                                                *
  9108******************************************************************
  9109
  9110 0400-CHECK-CANCEL-PF-KEYS.
  9111     IF EIBAID = DFHPF9 AND PI-EDIT-SW NOT = '1'
  9112        MOVE ER-2337             TO EMI-ERROR
  9113        MOVE -1                  TO CMAINTL
  9114        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9115        GO TO 8200-SEND-DATAONLY.
  9116
  9117     IF EIBAID = DFHPF1
  9118        MOVE '0'                TO PI-EDIT-SW
  9119        IF PI-PRIMARY-BROWSE
  9120           GO TO 4100-BROWSE-PRIMARY-FORWARD
  9121        ELSE
  9122           IF PI-PRIMARY-WITH-SELECT
  9123              GO TO 4100-BROWSE-PRIMARY-FORWARD
  9124           ELSE
  9125              IF PI-FILE-BROWSE
  9126                 GO TO 4300-BROWSE-FILE-FORWARD
  9127              ELSE
  9128                 IF PI-CSR-BROWSE
  9129                    GO TO 4200-BROWSE-CSR-FORWARD
  9130                 ELSE
  9131                    GO TO 4000-BROWSE-DETAIL-FORWARD.
  9132
  9133     IF EIBAID = DFHPF2
  9134        MOVE '0'                TO PI-EDIT-SW
  9135        IF PI-PRIMARY-BROWSE
  9136           GO TO 4600-BROWSE-PRIMARY-BACKWARD
  9137        ELSE
  9138           IF PI-PRIMARY-WITH-SELECT
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 167
* EL6311.cbl
  9139              GO TO 4600-BROWSE-PRIMARY-BACKWARD
  9140           ELSE
  9141              IF PI-FILE-BROWSE
  9142                 GO TO 4800-BROWSE-FILE-BACKWARD
  9143              ELSE
  9144                 IF PI-CSR-BROWSE
  9145                    GO TO 4900-BROWSE-CSR-BACKWARD
  9146                 ELSE
  9147                    GO TO 4500-BROWSE-DETAIL-BACKWARD.
  9148
  9149     IF EIBAID = DFHPF3
  9150        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9151        MOVE XCTL-EL127         TO PGM-NAME
  9152        GO TO 9300-XCTL.
  9153
  9154     IF (EIBAID = DFHPF15 OR DFHPF17)
  9155        AND (CSR-EDIT-SESSION)
  9156*       AND (FATAL-OR-UNFORCED)
  9157        AND (FATAL-ERRORS)
  9158        MOVE ER-1819             TO EMI-ERROR
  9159        MOVE -1                  TO CMAINTL
  9160        MOVE AL-UANON            TO CMAINTA
  9161        PERFORM 9900-ERROR-FORMAT
  9162                                 THRU 9900-EXIT
  9163        GO TO 8200-SEND-DATAONLY
  9164     END-IF
  9165     IF (EIBAID = DFHPF15 OR DFHPF17 OR DFHPF10)
  9166       AND (CSR-EDIT-SESSION)
  9167        MOVE PI-PREV-ALT-KEY     TO PB-CONTROL-BY-ACCOUNT
  9168        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
  9169        IF (RESP-NORMAL)
  9170           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
  9171              AM-CONTROL-PRIMARY (1:20))
  9172            IF AM-NAME NOT GREATER THAN SPACES OR
  9173               AM-ADDRS NOT GREATER THAN SPACES  OR
  9174               AM-ADDR-CITY NOT GREATER THAN SPACES OR
  9175               AM-ADDR-STATE NOT GREATER THAN SPACES OR
  9176               AM-ZIP NOT GREATER THAN SPACES
  9177               MOVE ER-3834             TO EMI-ERROR
  9178               MOVE -1                  TO BMAINTL
  9179               MOVE AL-UANON            TO BMAINTA
  9180               PERFORM 9900-ERROR-FORMAT
  9181                                 THRU 9900-EXIT
  9182               GO TO 8200-SEND-DATAONLY
  9183            END-IF
  9184        ELSE
  9185           MOVE ER-1609             TO EMI-ERROR
  9186           MOVE -1                  TO BMAINTL
  9187           MOVE AL-UANON            TO BMAINTA
  9188           PERFORM 9900-ERROR-FORMAT
  9189                                THRU 9900-EXIT
  9190           GO TO 8200-SEND-DATAONLY
  9191        END-IF
  9192
  9193        MOVE PI-PREV-ALT-KEY (1:33) TO ELCERT-KEY
  9194        PERFORM 6220-READ-ERMAIL THRU 6220-EXIT
  9195        IF (ERMAIL-FOUND)
  9196            IF (MA-ADDRESS-LINE-1 NOT GREATER THAN SPACES AND
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 168
* EL6311.cbl
  9197               MA-ADDRESS-LINE-2 NOT GREATER THAN SPACES)  OR
  9198               MA-CITY NOT GREATER THAN SPACES OR
  9199               MA-ADDR-STATE NOT GREATER THAN SPACES OR
  9200               MA-ZIP-CODE NOT GREATER THAN SPACES
  9201               MOVE ER-3835             TO EMI-ERROR
  9202               MOVE -1                  TO BMAINTL
  9203               MOVE AL-UANON            TO BMAINTA
  9204               PERFORM 9900-ERROR-FORMAT
  9205                                 THRU 9900-EXIT
  9206               GO TO 8200-SEND-DATAONLY
  9207            END-IF
  9208        ELSE
  9209           MOVE ER-3000             TO EMI-ERROR
  9210           MOVE -1                  TO BMAINTL
  9211           MOVE AL-UANON            TO BMAINTA
  9212           PERFORM 9900-ERROR-FORMAT
  9213                                THRU 9900-EXIT
  9214           GO TO 8200-SEND-DATAONLY
  9215        END-IF
  9216
  9217     END-IF
  9218     IF (EIBAID = DFHPF15 OR DFHPF17)
  9219        AND (CSR-EDIT-SESSION)
  9220        MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
  9221        MOVE PI-SV-CARRIER       TO PI-CARRIER
  9222        MOVE PI-SV-GROUPING      TO PI-GROUPING
  9223        MOVE PI-SV-STATE         TO PI-STATE
  9224        MOVE ERPNDB-ACCOUNT      TO PI-ACCOUNT
  9225        MOVE CCERTNOI            TO PI-CERT-PRIME
  9226        MOVE CSUFIXI             TO PI-CERT-SFX
  9227        MOVE CEFFDTI             TO DEEDIT-FIELD
  9228        PERFORM 8600-DEEDIT
  9229        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  9230        MOVE '4'                 TO DC-OPTION-CODE
  9231        PERFORM 9700-DATE-LINK
  9232        IF DATE-CONVERSION-ERROR
  9233           MOVE ER-0348          TO EMI-ERROR
  9234           MOVE -1               TO CEFFDTL
  9235           MOVE AL-UABON         TO CEFFDTA
  9236           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9237           GO TO 8200-SEND-DATAONLY
  9238        ELSE
  9239           MOVE DC-BIN-DATE-1    TO PI-CERT-EFF-DT
  9240           PERFORM 6000-CREATE-TEMP-STORAGE
  9241                                 THRU 6000-EXIT
  9242           IF EIBAID = DFHPF17
  9243               PERFORM 6400-CHECK-FOR-RES-REF-CLAIM
  9244                                  THRU 6400-EXIT
  9245               IF PI-RES-REF-CLM-TYPE NOT EQUAL
  9246                                 '2' AND '3' AND '4'
  9247                  MOVE ER-3831     TO  EMI-ERROR
  9248                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9249                  GO TO 8200-SEND-DATAONLY
  9250               END-IF
  9251               MOVE 'Y'          TO PI-CLM-RESC-IND
  9252           ELSE
  9253               MOVE 'N'          TO PI-CLM-RESC-IND
  9254           END-IF
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 169
* EL6311.cbl
  9255           MOVE XCTL-EL6316      TO PGM-NAME
  9256           MOVE '2'              TO PI-ISS-CAN-SW
  9257           MOVE LOW-VALUES       TO PI-6316-PASS-AREA
  9258           MOVE WS-EL6316-PASS-AREA TO PI-PROGRAM-WORK-AREA
  9259           GO TO 9300-XCTL
  9260        END-IF
  9261     END-IF
  9262
  9263     IF EIBAID = DFHPF4
  9264        MOVE '0'                TO PI-EDIT-SW
  9265        IF PI-DISPLAY-ORIGINAL-BATCH
  9266           NEXT SENTENCE
  9267        ELSE
  9268           GO TO 7200-DISPLAY-BATCHES.
  9269
  9270     IF EIBAID = DFHPF5
  9271        MOVE ER-0029                TO EMI-ERROR
  9272        MOVE -1                     TO BPFENTRL
  9273        MOVE AL-UNBON               TO BPFENTRA
  9274        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9275        GO TO 8200-SEND-DATAONLY.
  9276*        MOVE '0'                TO PI-EDIT-SW
  9277*        IF PI-DISPLAY-ORIGINAL-BATCH
  9278*           NEXT SENTENCE
  9279*        ELSE
  9280*           MOVE EL631B              TO PI-MAP-NAME
  9281*           MOVE LOW-VALUES          TO EL631BI
  9282*           MOVE 'A'                 TO BMAINTO
  9283*           MOVE AL-UANON            TO BMAINTA
  9284*           MOVE -1                  TO BMAINTL
  9285*           MOVE '5'                 TO PI-MAINT-FUNCTION
  9286*           GO TO 8100-SEND-INITIAL-MAP.
  9287
  9288     IF EIBAID = DFHPF6
  9289        MOVE ER-0029                TO EMI-ERROR
  9290        MOVE -1                     TO BPFENTRL
  9291        MOVE AL-UNBON               TO BPFENTRA
  9292        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9293        GO TO 8200-SEND-DATAONLY.
  9294*        MOVE '0'                TO PI-EDIT-SW
  9295*        IF PI-DISPLAY-ORIGINAL-BATCH
  9296*           NEXT SENTENCE
  9297*        ELSE
  9298*           MOVE EL631C              TO PI-MAP-NAME
  9299*           MOVE LOW-VALUES          TO EL631CI
  9300*           MOVE 'A'                 TO CMAINTO
  9301*           MOVE AL-UANON            TO CMAINTA
  9302*           MOVE -1                  TO CMAINTL
  9303*           MOVE '6'                 TO PI-MAINT-FUNCTION
  9304*           GO TO 8100-SEND-INITIAL-MAP.
  9305
  9306     IF EIBAID = DFHPF7
  9307        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9308        MOVE PI-SV-CARRIER          TO PI-CARRIER
  9309        MOVE PI-SV-GROUPING         TO PI-GROUPING
  9310        MOVE PI-SV-STATE            TO PI-STATE
  9311        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  9312        MOVE CCERTNOI               TO PI-CERT-PRIME
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 170
* EL6311.cbl
  9313        MOVE CSUFIXI                TO PI-CERT-SFX
  9314        MOVE CEFFDTI                TO DEEDIT-FIELD
  9315        PERFORM 8600-DEEDIT
  9316        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  9317        MOVE '4'                    TO DC-OPTION-CODE
  9318        PERFORM 9700-DATE-LINK
  9319        IF DATE-CONVERSION-ERROR
  9320           MOVE ER-0348            TO EMI-ERROR
  9321           MOVE -1                  TO BEFFDTL
  9322           MOVE AL-UABON            TO BEFFDTA
  9323           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9324           GO TO 8200-SEND-DATAONLY
  9325        ELSE
  9326           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  9327           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9328           MOVE XCTL-EL1273        TO PGM-NAME
  9329           GO TO 9300-XCTL.
  9330
  9331     IF EIBAID = DFHPF8
  9332        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9333        MOVE PI-SV-CARRIER          TO PI-CARRIER
  9334        MOVE PI-SV-GROUPING         TO PI-GROUPING
  9335        MOVE PI-SV-STATE            TO PI-STATE
  9336        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  9337        MOVE CCERTNOI               TO PI-CERT-PRIME
  9338        MOVE CSUFIXI                TO PI-CERT-SFX
  9339        MOVE CEFFDTI                TO DEEDIT-FIELD
  9340        PERFORM 8600-DEEDIT
  9341        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  9342        MOVE '4'                    TO DC-OPTION-CODE
  9343        PERFORM 9700-DATE-LINK
  9344        IF DATE-CONVERSION-ERROR
  9345           MOVE ER-0348             TO EMI-ERROR
  9346           MOVE -1                  TO BEFFDTL
  9347           MOVE AL-UABON            TO BEFFDTA
  9348           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9349           GO TO 8200-SEND-DATAONLY
  9350        ELSE
  9351           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  9352           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9353           move ERPNDB-RECORD-TYPE to pi-program-work-area(1:1)
  9354           IF PI-COMPANY-ID = 'DMD'
  9355               MOVE XCTL-EL401DMD      TO PGM-NAME
  9356             ELSE
  9357               MOVE XCTL-EL1279        TO PGM-NAME
  9358           END-IF
  9359           GO TO 9300-XCTL.
  9360
  9361     IF EIBAID = DFHPF9 AND PI-EDIT-SW = '1'
  9362        MOVE XCTL-EL6312     TO PGM-NAME
  9363
  9364* EXEC CICS XCTL
  9365*           PROGRAM  (PGM-NAME)
  9366*           COMMAREA (PROGRAM-INTERFACE-BLOCK)
  9367*           LENGTH   (WS-COMM-LENGTH)
  9368*       END-EXEC
  9369*    MOVE '.$C                   %   #00009293' TO DFHEIV0
  9370     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 171
* EL6311.cbl
  9371     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9372     MOVE X'2020233030303039323933' TO DFHEIV0(25:11)
  9373     CALL 'kxdfhei1' USING DFHEIV0,
  9374           PGM-NAME,
  9375           PROGRAM-INTERFACE-BLOCK,
  9376           WS-COMM-LENGTH,
  9377           DFHEIV99
  9378     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9379     ELSE
  9380        MOVE '0'                 TO  PI-EDIT-SW.
  9381
  9382     IF EIBAID = DFHPF10
  9383         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9384         MOVE PI-PREV-KEY        TO PI-ERPNDB-KEY
  9385         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  9386         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  9387                                    PI-1042-WA
  9388         MOVE 4                  TO PI-689-DATA-SOURCE
  9389         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  9390         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  9391         MOVE PI-SV-STATE        TO PI-689-STATE
  9392         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  9393         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  9394         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  9395         MOVE PI-PB-ALT-CHG-SEQ-NO
  9396                                 TO PI-689-ALT-SEQ-NO
  9397         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  9398         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  9399         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  9400         MOVE +0                 TO PI-689-CONTROL
  9401         MOVE LOW-VALUES         TO PI-689-DATE-EDIT
  9402                                    PI-689-EXP-DATE
  9403                                    PI-689-RESP-PERSON
  9404                                    PI-689-TYPE
  9405                                    PI-689-FOLLOW-UP-EDIT
  9406                                    PI-689-RESEND1-EDIT
  9407                                    PI-689-SEQ-EDIT
  9408                                    PI-689-BCSEQ-EDIT
  9409                                    PI-689-LBL-OVERRIDE
  9410         MOVE W-LETTER-COMMUNICATION-AREAS
  9411                                 TO PI-PROGRAM-WORK-AREA
  9412         MOVE XCTL-EL689         TO PGM-NAME
  9413         GO TO 9300-XCTL.
  9414
  9415     IF  EIBAID = DFHPF16
  9416         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9417         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  9418         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  9419                                    PI-1042-WA
  9420         MOVE 4                  TO PI-689-DATA-SOURCE
  9421         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  9422         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  9423         MOVE PI-SV-STATE        TO PI-689-STATE
  9424         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  9425         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  9426         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  9427         MOVE PI-PB-ALT-CHG-SEQ-NO
  9428                                 TO PI-689-ALT-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 172
* EL6311.cbl
  9429         MOVE PI-PB-RECORD-TYPE  TO PI-689-CHG-SEQ-NO
  9430         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  9431         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  9432         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  9433         move '2'                to PI-689-CHG-SEQ-NOX
  9434         MOVE W-LETTER-COMMUNICATION-AREAS
  9435                                 TO PI-PROGRAM-WORK-AREA
  9436         MOVE XCTL-EL690         TO PGM-NAME
  9437         GO TO 9300-XCTL.
  9438     IF (EIBAID = DFHPF13)
  9439        if (not fatal-errors)
  9440           and (not unforced-errors)
  9441           MOVE PI-PREV-ALT-KEY  TO ERPNDB-ALT-KEY
  9442           MOVE PI-SV-CARRIER    TO PI-CARRIER
  9443           MOVE PI-SV-GROUPING   TO PI-GROUPING
  9444           MOVE PI-SV-STATE      TO PI-STATE
  9445           MOVE ERPNDB-ACCOUNT   TO PI-ACCOUNT
  9446           MOVE CCERTNOI         TO PI-CERT-PRIME
  9447           MOVE CSUFIXI          TO PI-CERT-SFX
  9448           MOVE CEFFDTI          TO DEEDIT-FIELD
  9449           PERFORM 8600-DEEDIT
  9450           MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
  9451           MOVE '4'              TO DC-OPTION-CODE
  9452           PERFORM 9700-DATE-LINK
  9453           IF DATE-CONVERSION-ERROR
  9454              MOVE ER-0348       TO EMI-ERROR
  9455              MOVE -1            TO CEFFDTL
  9456              MOVE AL-UABON      TO CEFFDTA
  9457              PERFORM 9900-ERROR-FORMAT
  9458                                 THRU 9900-EXIT
  9459              GO TO 8200-SEND-DATAONLY
  9460           ELSE
  9461              MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
  9462              MOVE AL-UANON      TO CEFFDTA
  9463              MOVE DC-BIN-DATE-1 TO PI-CERT-EFF-DT
  9464              PERFORM 6000-CREATE-TEMP-STORAGE
  9465                                 THRU 6000-EXIT
  9466              MOVE XCTL-EL677    TO PGM-NAME
  9467              GO TO 9300-XCTL
  9468           end-if
  9469        else
  9470           MOVE ER-3444          TO EMI-ERROR
  9471           MOVE -1               TO CPFENTRL
  9472           MOVE AL-UNBON         TO CPFENTRA
  9473           PERFORM 9900-ERROR-FORMAT
  9474                                 THRU 9900-EXIT
  9475           GO TO 8200-SEND-DATAONLY
  9476        end-if
  9477     end-if
  9478
  9479     IF EIBAID = DFHPF14
  9480        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9481        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
  9482        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
  9483        MOVE PI-SV-STATE            TO PI-CR-STATE
  9484        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  9485        MOVE SPACE                  TO PI-EDIT-SW
  9486        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 173
* EL6311.cbl
  9487        MOVE XCTL-EL650             TO PGM-NAME
  9488        GO TO 9300-XCTL.
  9489
  9490     IF EIBAID = DFHENTER OR DFHPF11
  9491        GO TO 2000-CANCEL-MAINLINE.
  9492
  9493     MOVE ER-0029                TO EMI-ERROR.
  9494     MOVE -1                     TO CPFENTRL.
  9495     MOVE AL-UNBON               TO CPFENTRA.
  9496     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9497     GO TO 8200-SEND-DATAONLY.
  9498
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 174
* EL6311.cbl
  9500
  9501******************************************************************
  9502*                                                                *
  9503*      BATCH SCREEN PF KEY CHECKING                              *
  9504*                                                                *
  9505******************************************************************
  9506
  9507******************************************************************
  9508*                                                                *
  9509*      PF KEY FUNCTIONS:                                         *
  9510*                                                                *
  9511*      PF1 = BROWSE FORWARD                                      *
  9512*      PF2 = BROWSE BACKWARD                                     *
  9513*      PF3 = DISPLAY PREMIUM TOTALS                              *
  9514*      PF4 = TRANSFER TO ACCOUNT BILLING                         *
  9515*                                                                *
  9516*                                                                *
  9517******************************************************************
  9518
  9519 0500-CHECK-BATCH-PF-KEYS.
  9520     IF EIBAID = DFHPF1
  9521        MOVE '0'                TO PI-EDIT-SW
  9522        IF ONLY-BATCH-HEADERS  OR ALL-OUT-OF-BAL
  9523           GO TO 5000-BROWSE-BATCH-HEADERS
  9524        ELSE
  9525           IF PI-GOOD-BROWSE
  9526              IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  9527                 GO TO 4100-BROWSE-PRIMARY-FORWARD
  9528              ELSE
  9529                 IF PI-FILE-BROWSE
  9530                    GO TO 4300-BROWSE-FILE-FORWARD
  9531                 ELSE
  9532                    IF PI-CSR-BROWSE
  9533                       GO TO 4200-BROWSE-CSR-FORWARD
  9534                    ELSE
  9535                       GO TO 4000-BROWSE-DETAIL-FORWARD
  9536           ELSE
  9537              GO TO 0800-BROWSE-ERROR.
  9538
  9539     IF EIBAID = DFHPF2
  9540        MOVE '0'                TO PI-EDIT-SW
  9541        IF ONLY-BATCH-HEADERS  OR ALL-OUT-OF-BAL
  9542           GO TO 5500-BROWSE-BATCH-BACKWARD
  9543        ELSE
  9544           IF PI-GOOD-BROWSE
  9545              IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  9546                 GO TO 4600-BROWSE-PRIMARY-BACKWARD
  9547              ELSE
  9548                 IF PI-FILE-BROWSE
  9549                    GO TO 4800-BROWSE-FILE-BACKWARD
  9550                 ELSE
  9551                    IF PI-CSR-BROWSE
  9552                       GO TO 4900-BROWSE-CSR-BACKWARD
  9553                    ELSE
  9554                       GO TO 4500-BROWSE-DETAIL-BACKWARD
  9555           ELSE
  9556              GO TO 0800-BROWSE-ERROR.
  9557
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 175
* EL6311.cbl
  9558     IF EIBAID = DFHPF3
  9559        GO TO 3000-BATCH-MAINLINE.
  9560
  9561     IF  EIBAID = DFHPF4
  9562        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9563        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
  9564        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
  9565        MOVE PI-SV-STATE            TO PI-CR-STATE
  9566        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  9567                                       PI-CR-FIN-RESP
  9568        MOVE 'A'                    TO PI-CR-TYPE
  9569        MOVE SPACE                  TO PI-EDIT-SW
  9570        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9571        MOVE XCTL-EL640             TO PGM-NAME
  9572        GO TO 9300-XCTL.
  9573
  9574     IF (ONLY-BATCH-HEADERS OR ALL-OUT-OF-BAL)
  9575       AND
  9576        (EIBAID = DFHENTER)
  9577           GO TO 3500-EDIT-BATCH-DATA.
  9578
  9579     IF EIBAID = DFHENTER
  9580        GO TO 3500-EDIT-BATCH-DATA.
  9581
  9582     MOVE ER-0029             TO EMI-ERROR.
  9583     MOVE -1                  TO DPFENTRL.
  9584     MOVE AL-UNBON            TO DPFENTRA.
  9585     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9586     GO TO 8200-SEND-DATAONLY.
  9587
  9588 0800-BROWSE-ERROR.
  9589     MOVE ER-2258                TO EMI-ERROR.
  9590     MOVE -1                     TO DPFENTRL.
  9591     MOVE AL-UNBON               TO DPFENTRA.
  9592     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9593     GO TO 8200-SEND-DATAONLY.
  9594
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 176
* EL6311.cbl
  9596
  9597******************************************************************
  9598*                                                                *
  9599*                I S S U E   M A I N L I N E                     *
  9600*                                                                *
  9601******************************************************************
  9602
  9603 1000-ISSUE-MAINLINE.
  9604     IF PI-DISPLAY-ORIGINAL-BATCH
  9605        IF BMAINTI NOT = 'C' AND 'D' AND 'S' AND 'K'
  9606           MOVE ER-0023             TO EMI-ERROR
  9607           MOVE -1                  TO BMAINTL
  9608           MOVE AL-UABON            TO BMAINTA
  9609           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9610           GO TO 8200-SEND-DATAONLY
  9611        ELSE
  9612           NEXT SENTENCE
  9613     ELSE
  9614        IF BMAINTI NOT = 'A' AND 'C' AND 'D' AND 'S' AND 'K'
  9615           MOVE ER-0023             TO EMI-ERROR
  9616           MOVE -1                  TO BMAINTL
  9617           MOVE AL-UABON            TO BMAINTA
  9618           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9619           GO TO 8200-SEND-DATAONLY.
  9620
  9621     IF BMAINTI = 'S'
  9622        GO TO 1100-SHOW-REQUEST.
  9623
  9624     IF NOT MODIFY-CAP
  9625         MOVE 'UPDATE'       TO SM-READ
  9626         PERFORM 9995-SECURITY-VIOLATION
  9627         MOVE ER-0070        TO EMI-ERROR
  9628         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9629         GO TO 8100-SEND-INITIAL-MAP.
  9630
  9631     IF BMAINTL GREATER THAN ZEROS
  9632        IF PI-PF5-FUNCTION
  9633           IF BMAINTI NOT = 'A'
  9634              MOVE AL-UABON  TO BMAINTA
  9635              MOVE -1        TO BMAINTL
  9636              MOVE ER-2260   TO EMI-ERROR
  9637              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9638              GO TO 8200-SEND-DATAONLY.
  9639
  9640     IF BCERTNOL = ZEROS
  9641       AND (BMAINTI = 'C' OR 'K' OR 'D')
  9642         NEXT SENTENCE
  9643     ELSE
  9644         IF BCERTNOL NOT = ZEROS
  9645             MOVE AL-UANON       TO BCERTNOA
  9646         ELSE
  9647             MOVE -1             TO BCERTNOL
  9648             MOVE  1             TO SET-CURSOR-SW
  9649             MOVE ER-2218        TO EMI-ERROR
  9650             MOVE AL-UABON       TO BCERTNOA
  9651             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9652
  9653     IF BSUFIXL NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 177
* EL6311.cbl
  9654         MOVE AL-UANON       TO BSUFIXA
  9655     ELSE
  9656         MOVE AL-SANOF       TO BSUFIXA.
  9657
  9658
  9659* EXEC CICS READ
  9660*        DATASET (FILE-ID-ERPNDB)
  9661*        INTO    (PENDING-BUSINESS)
  9662*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
  9663*    END-EXEC.
  9664     MOVE LENGTH OF
  9665      PENDING-BUSINESS
  9666       TO DFHEIV11
  9667*    MOVE '&"IL       E          (   #00009577' TO DFHEIV0
  9668     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  9669     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9670     MOVE X'2020233030303039353737' TO DFHEIV0(25:11)
  9671     CALL 'kxdfhei1' USING DFHEIV0,
  9672           FILE-ID-ERPNDB,
  9673           PENDING-BUSINESS,
  9674           DFHEIV11,
  9675           PI-PREV-CONTROL-PRIMARY,
  9676           DFHEIV99,
  9677           DFHEIV99,
  9678           DFHEIV99
  9679     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9680
  9681
  9682     IF BEFFDTL = ZEROS AND (BMAINTI = 'C' OR 'K' OR 'D')
  9683        NEXT SENTENCE
  9684     ELSE
  9685        IF BEFFDTL NOT = ZEROS
  9686           MOVE AL-UNNON             TO BEFFDTA
  9687           MOVE BEFFDTI              TO DEEDIT-FIELD
  9688           PERFORM 8600-DEEDIT
  9689           MOVE DEEDIT-FIELD-V0      TO DC-GREG-DATE-1-MDY
  9690           MOVE 4                    TO DC-OPTION-CODE
  9691           PERFORM 9700-DATE-LINK
  9692           IF NO-CONVERSION-ERROR
  9693              MOVE DC-BIN-DATE-1     TO WS-CONVERTED-EFFDT
  9694              ELSE
  9695              MOVE -1                TO BEFFDTL
  9696              MOVE  1                TO SET-CURSOR-SW
  9697              MOVE ER-2226           TO EMI-ERROR
  9698              MOVE AL-UNBON          TO BEFFDTA
  9699              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9700           ELSE
  9701              MOVE -1                TO BEFFDTL
  9702              MOVE  1                TO SET-CURSOR-SW
  9703              MOVE ER-2220           TO EMI-ERROR
  9704              MOVE AL-UNBON          TO BEFFDTA
  9705              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9706
  9707     MOVE PI-PREV-ALT-KEY            TO WS-ERPNDB-ALT-KEY.
  9708
  9709     IF BCERTNOL NOT = ZEROS
  9710        MOVE BCERTNOI                TO WS-NEW-PRIME
  9711     ELSE
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 178
* EL6311.cbl
  9712        MOVE SPACES                  TO WS-NEW-PRIME.
  9713
  9714     IF BSUFIXL NOT = ZEROS
  9715        MOVE BSUFIXI                 TO WS-NEW-SUFFIX
  9716     ELSE
  9717        MOVE SPACE                   TO WS-NEW-SUFFIX.
  9718
  9719     IF BEFFDTL NOT = ZEROS
  9720        MOVE WS-CONVERTED-EFFDT      TO WS-NEW-CERT-EFF-DT
  9721     ELSE
  9722        MOVE LOW-VALUES              TO WS-NEW-CERT-EFF-DT.
  9723
  9724     IF BMAINTI = 'A' OR 'K' OR 'S'
  9725        NEXT SENTENCE
  9726     ELSE
  9727        MOVE PI-PREV-ALT-KEY     TO WS-ERPNDB-ALT-KEY
  9728        IF WS-PB-CERT-NO     NOT = WS-NEW-CERT-NO      OR
  9729           WS-PB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT  OR
  9730           WS-PB-RECORD-TYPE NOT = '1'
  9731           IF BMAINTI = 'C'
  9732               MOVE ER-2287          TO EMI-ERROR
  9733               MOVE -1               TO BCERTNOL
  9734               MOVE AL-UABON         TO BCERTNOA BEFFDTA
  9735               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9736               GO TO 8200-SEND-DATAONLY
  9737             ELSE
  9738               MOVE ER-2260          TO EMI-ERROR
  9739               MOVE -1               TO BCERTNOL
  9740               MOVE AL-UABON         TO BCERTNOA
  9741               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9742               GO TO 8200-SEND-DATAONLY.
  9743
  9744     IF BMAINTI = 'D'
  9745         GO TO 1400-DELETE-ISSUE-ROUTINE.
  9746
  9747*    IF BMICRNOL  NOT =  ZEROS
  9748*        IF BMICRNOI  NUMERIC
  9749*            MOVE AL-UNNON       TO  BMICRNOA
  9750*        ELSE
  9751*            MOVE -1             TO  BMICRNOL
  9752*            MOVE 1              TO  SET-CURSOR-SW
  9753*            MOVE AL-UNBON       TO  BMICRNOA
  9754*            MOVE ER-2701        TO  EMI-ERROR
  9755*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9756     IF BVINL NOT = ZEROS
  9757        MOVE AL-UANON            TO BVINA
  9758     END-IF
  9759
  9760     IF LETRREQL   GREATER THAN ZEROS
  9761        IF LETRREQI = 'Y'
  9762          AND (PB-I-LETTER-REQD = 'Y' OR 'N')
  9763           CONTINUE
  9764        ELSE
  9765        IF LETRREQI = 'N'
  9766          AND (PB-I-LETTER-REQD = 'Y' OR 'N')
  9767           CONTINUE
  9768        ELSE
  9769           MOVE -1               TO LETRREQL
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 179
* EL6311.cbl
  9770           MOVE ER-1585          TO EMI-ERROR
  9771           MOVE AL-UABON         TO LETRREQA
  9772           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9773        END-IF
  9774     END-IF.
  9775     IF B1STNML NOT = ZEROS
  9776         MOVE AL-UANON                TO B1STNMA.
  9777
  9778     IF BINITL  NOT = ZEROS
  9779        MOVE AL-UANON                TO BINITA.
  9780
  9781     IF BSEXL NOT = ZEROS
  9782        IF BSEXI = 'M' OR 'F'
  9783           MOVE AL-UANON             TO BSEXA
  9784        ELSE
  9785           MOVE -1               TO BSEXL
  9786           MOVE ER-2629          TO EMI-ERROR
  9787           MOVE AL-UABON         TO BSEXA
  9788           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9789
  9790     IF BAGEL NOT = ZEROS
  9791         IF BAGEI NUMERIC
  9792             MOVE BAGEI              TO WS-BAGE
  9793             MOVE AL-UNNON           TO BAGEA
  9794         ELSE
  9795             MOVE -1                 TO BAGEL
  9796             MOVE  1                 TO SET-CURSOR-SW
  9797             MOVE ER-2223            TO EMI-ERROR
  9798             MOVE AL-UNBON           TO BAGEA
  9799             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9800
  9801     IF BLSTNML NOT = ZERO  OR
  9802        B1STNML NOT = ZERO  OR
  9803        BINITL NOT = ZERO
  9804         IF BAGEL = ZEROS
  9805             MOVE -1                 TO BAGEL
  9806             MOVE  1                 TO SET-CURSOR-SW
  9807             MOVE ER-3269            TO EMI-ERROR
  9808             MOVE AL-UNBON           TO BAGEA
  9809             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9810         END-IF
  9811     END-IF.
  9812
  9813     MOVE LOW-VALUES             TO WS-CONVERTED-BIRTH
  9814
  9815     IF (BBIRTHL GREATER THAN +0) AND
  9816        (BBIRTHI NOT EQUAL SPACES)
  9817        NEXT SENTENCE
  9818     ELSE
  9819        GO TO 1010-CHECK-AGE.
  9820
  9821     MOVE BBIRTHI                TO DEEDIT-FIELD.
  9822     PERFORM 8600-DEEDIT.
  9823     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
  9824     MOVE DC-GREG-DATE-1-MDY     TO WS-SAVE-BIRTH-DATE
  9825     MOVE AL-UNNON               TO BBIRTHA.
  9826     MOVE '4'                    TO DC-OPTION-CODE.
  9827     PERFORM 9700-DATE-LINK.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 180
* EL6311.cbl
  9828     IF DATE-CONVERSION-ERROR
  9829        MOVE -1                  TO BBIRTHL
  9830        MOVE  1                  TO SET-CURSOR-SW
  9831        MOVE ER-2228             TO EMI-ERROR
  9832        MOVE AL-UNBON            TO BBIRTHA
  9833        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9834        GO TO 1010-CHECK-AGE.
  9835
  9836     IF (NO-CONVERSION-ERROR) AND
  9837        (DC-BIN-DATE-1 GREATER THAN WS-CONVERTED-EFFDT)
  9838        MOVE DC-BIN-DATE-1       TO WS-WORK-BIN-DT
  9839        SUBTRACT CENTURY-ADJ FROM WS-WORK-BIN-RED
  9840        MOVE WS-WORK-BIN-DT      TO DC-BIN-DATE-1
  9841                                    WS-CONVERTED-BIRTH
  9842        MOVE AL-UANON            TO BBIRTHA
  9843     ELSE
  9844        MOVE DC-BIN-DATE-1       TO WS-CONVERTED-BIRTH
  9845        MOVE AL-UANON            TO BBIRTHA.
  9846
  9847 1010-CHECK-AGE.
  9848
  9849*    IF BAGEL = ZERO
  9850*       IF BBIRTHL GREATER THAN ZERO
  9851*          PERFORM 1095-CALC-AGE THRU 1099-EXIT.
  9852
  9853     IF B1STPMTL NOT = ZEROS
  9854        IF B1STPMTI = SPACES
  9855           MOVE LOW-VALUES           TO WS-CONVERTED-1ST-PMT-DT
  9856        ELSE
  9857           MOVE B1STPMTI             TO DEEDIT-FIELD
  9858           PERFORM 8600-DEEDIT
  9859           MOVE DEEDIT-FIELD-V0      TO DC-GREG-DATE-1-MDY
  9860           MOVE AL-UNNON             TO B1STPMTA
  9861           MOVE 4                    TO DC-OPTION-CODE
  9862           PERFORM 9700-DATE-LINK
  9863           IF NO-CONVERSION-ERROR
  9864              MOVE DC-BIN-DATE-1     TO WS-CONVERTED-1ST-PMT-DT
  9865              MOVE AL-UANON          TO B1STPMTA
  9866           ELSE
  9867              MOVE -1                TO B1STPMTL
  9868              MOVE  1                TO SET-CURSOR-SW
  9869              MOVE ER-2200           TO EMI-ERROR
  9870              MOVE AL-UNBON          TO B1STPMTA
  9871              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9872
  9873     IF BDAYSL NOT = ZEROS
  9874         IF BDAYSI NUMERIC
  9875             MOVE AL-UNNON           TO BDAYSA
  9876         ELSE
  9877             MOVE -1                 TO BDAYSL
  9878             MOVE ER-2530            TO EMI-ERROR
  9879             MOVE AL-UNBON           TO BDAYSA
  9880             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9881
  9882     IF BLNTRML NOT = ZEROS
  9883         IF BLNTRMI NUMERIC
  9884             MOVE AL-UNNON       TO BLNTRMA
  9885         ELSE
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 181
* EL6311.cbl
  9886             MOVE -1             TO BLNTRML
  9887             MOVE ER-2533        TO EMI-ERROR
  9888             MOVE AL-UNBON       TO BLNTRMA
  9889             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9890
  9891**   IF PI-COMPANY-ID = 'DMD'
  9892     IF PI-COMPANY-ID = 'DMD' OR 'CID' or 'AHL'
  9893        NEXT SENTENCE
  9894     ELSE
  9895         IF BLNOFCRL NOT = ZEROS
  9896            PERFORM 7500-READ-ERLOFC THRU 7599-EXIT
  9897            IF LOAN-OFFICER-FOUND
  9898                MOVE AL-UANON        TO BLNOFCRA
  9899             ELSE
  9900                 MOVE SPACE          TO WS-LOAN-OFFICER
  9901                 MOVE -1             TO BLNOFCRL
  9902                 MOVE  1             TO SET-CURSOR-SW
  9903                 MOVE ER-3006        TO EMI-ERROR
  9904                 MOVE AL-UNBON       TO BLNOFCRA
  9905                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9906
  9907     IF BFREQL NOT = ZEROS
  9908         IF BFREQI NUMERIC
  9909             MOVE AL-UNNON       TO BFREQA
  9910         ELSE
  9911             MOVE -1             TO BFREQL
  9912             MOVE  1             TO SET-CURSOR-SW
  9913             MOVE ER-2223        TO EMI-ERROR
  9914             MOVE AL-UNBON       TO BFREQA
  9915             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9916
  9917     IF BMODEL NOT = ZEROS
  9918         MOVE BMODEI             TO WS-MODE-CODE
  9919                                    PI-BMODE
  9920         IF WS-MODE-CODE-VALID
  9921             MOVE AL-UANON       TO BMODEA
  9922         ELSE
  9923             MOVE -1             TO BMODEL
  9924             MOVE ER-2591        TO EMI-ERROR
  9925             MOVE AL-UABON       TO BMODEA
  9926             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9927
  9928     IF BPMTSL NOT = ZEROS
  9929         IF BPMTSI NUMERIC
  9930             MOVE AL-UNNON           TO BPMTSA
  9931             MOVE BPMTSI             TO PI-BPMTS
  9932         ELSE
  9933             MOVE -1                 TO BPMTSL
  9934             MOVE ER-2592            TO EMI-ERROR
  9935             MOVE AL-UNBON           TO BPMTSA
  9936             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9937
  9938     IF BPMTAMTL NOT = ZEROS
  9939
  9940* EXEC CICS BIF DEEDIT
  9941*            FIELD  (BPMTAMTI)
  9942*            LENGTH (9)
  9943*       END-EXEC
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 182
* EL6311.cbl
  9944     MOVE 9
  9945       TO DFHEIV11
  9946*    MOVE '@"L                   #   #00009840' TO DFHEIV0
  9947     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9948     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9949     MOVE X'2020233030303039383430' TO DFHEIV0(25:11)
  9950     CALL 'kxdfhei1' USING DFHEIV0,
  9951           BPMTAMTI,
  9952           DFHEIV11
  9953     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9954        MOVE BPMTAMTI           TO PI-BPMTAMT.
  9955*        MOVE BPMTAMTI           TO DEEDIT-FIELD-V2
  9956*        PERFORM 8600-DEEDIT
  9957*        MOVE DEEDIT-FIELD-V2    TO PI-BPMTAMT.
  9958
  9959*    IF BAPRL NOT = ZEROS
  9960*        EXEC CICS BIF DEEDIT
  9961*            FIELD  (BAPRI)
  9962*            LENGTH (7)
  9963*        END-EXEC
  9964*        MOVE BAPRI              TO WS-BAPR.
  9965
  9966     IF BAPRL > 0
  9967        MOVE +0                  TO  WS-BAPR
  9968        PERFORM VARYING WS-SUB FROM +1 BY +1 UNTIL
  9969           (WS-SUB > 7)
  9970           OR (BAPRI (WS-SUB:1) NUMERIC)
  9971           OR (BAPRI (WS-SUB:1) = '.')
  9972        END-PERFORM
  9973        IF WS-SUB > 7
  9974           MOVE ER-2471       TO EMI-ERROR
  9975           MOVE -1            TO BAPRL
  9976           MOVE AL-UNBON      TO BAPRA
  9977           PERFORM 9900-ERROR-FORMAT
  9978                                 THRU 9900-EXIT
  9979        ELSE
  9980           IF BAPRI (WS-SUB:1) NUMERIC
  9981              MOVE WS-SUB           TO WS-BEG
  9982              PERFORM VARYING WS-SUB FROM WS-SUB BY +1 UNTIL
  9983                 (WS-SUB > 7)
  9984                 OR (BAPRI (WS-SUB:1) NOT NUMERIC)
  9985              END-PERFORM
  9986              COMPUTE WS-END = WS-SUB - WS-BEG
  9987              MOVE BAPRI (WS-BEG:WS-END)
  9988                                 TO WS-APR-WHOLE-NUM
  9989           END-IF
  9990           IF BAPRI (WS-SUB:1) = '.'
  9991              COMPUTE WS-BEG = WS-SUB + 1
  9992              IF (WS-BEG < 8)
  9993                 AND (BAPRI (WS-BEG:1) NUMERIC)
  9994                 PERFORM VARYING WS-SUB FROM WS-BEG BY +1 UNTIL
  9995                    (WS-SUB > 7)
  9996                    OR (BAPRI (WS-SUB:1) NOT NUMERIC)
  9997                 END-PERFORM
  9998                 COMPUTE WS-END = WS-SUB - WS-BEG
  9999                 MOVE BAPRI (WS-BEG:WS-END)
 10000                                 TO WS-APR-DEC (1:WS-END)
 10001              END-IF
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 183
* EL6311.cbl
 10002           END-IF
 10003           MOVE AL-UNNON      TO BAPRA
 10004           MOVE WS-BAPR       TO BAPRO
 10005        END-IF
 10006     END-IF
 10007*     IF BAPRL NOT = ZEROS
 10008*        MOVE BAPRI              TO DEEDIT-FIELD-V4
 10009*        PERFORM 8600-DEEDIT
 10010*        MOVE DEEDIT-FIELD-V4    TO WS-BAPR.
 10011
 10012     IF BLIVESL NOT = ZEROS
 10013        MOVE BLIVESI             TO DEEDIT-FIELD
 10014        PERFORM 8600-DEEDIT
 10015        IF DEEDIT-FIELD-V0 NUMERIC
 10016           MOVE DEEDIT-FIELD-V0  TO WS-BLIVES
 10017           MOVE AL-UNNON         TO BLIVESA
 10018        ELSE
 10019           MOVE -1               TO BLIVESL
 10020           MOVE AL-UNBON         TO BLIVESA
 10021           MOVE ER-2223          TO EMI-ERROR
 10022           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10023
 10024*DMD CUSTOM CODING*************START
 10025*NOTE PI-I-NUM-BILLED IS A FIELD FOR 'DMD' ONLY
 10026     IF PI-COMPANY-ID NOT = 'DMD'
 10027         MOVE ZEROS               TO BBILLEDL
 10028         GO TO 1010-EDIT-CONT.
 10029
 10030     IF BBILLEDL NOT = ZEROS
 10031        MOVE BBILLEDI            TO WS-EDIT-CSO-FIELD
 10032        MOVE 'Y'                 TO WS-NUMERIC-SW
 10033        MOVE +1                  TO WS-CSO-SUB
 10034        PERFORM 1030-EDIT-FOR-NUMERICS THRU 1030-EDIT-EXIT
 10035        IF CSO-NUMERIC-FIELD
 10036
 10037* EXEC CICS BIF DEEDIT
 10038*              FIELD  (BBILLEDI)
 10039*              LENGTH (9)
 10040*          END-EXEC
 10041     MOVE 9
 10042       TO DFHEIV11
 10043*    MOVE '@"L                   #   #00009926' TO DFHEIV0
 10044     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10045     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10046     MOVE X'2020233030303039393236' TO DFHEIV0(25:11)
 10047     CALL 'kxdfhei1' USING DFHEIV0,
 10048           BBILLEDI,
 10049           DFHEIV11
 10050     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10051           MOVE BBILLEDI         TO WS-BILLED
 10052           MOVE AL-UNNON         TO BBILLEDA
 10053        ELSE
 10054           MOVE -1               TO BBILLEDL
 10055           MOVE AL-UNBON         TO BBILLEDA
 10056           MOVE ER-2547          TO EMI-ERROR
 10057           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10058     ELSE
 10059        IF BMAINTI EQUAL 'A'
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 184
* EL6311.cbl
 10060           MOVE -1               TO BBILLEDL
 10061           MOVE AL-UNBON         TO BBILLEDA
 10062           MOVE ER-8148          TO EMI-ERROR
 10063           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10064
 10065 1010-EDIT-CONT.
 10066
 10067     IF BFORCEL  NOT = ZEROS
 10068         IF FORCE-CAP
 10069            MOVE AL-UANON            TO BFORCEA
 10070         ELSE
 10071            MOVE ER-2945             TO EMI-ERROR
 10072            MOVE AL-UABON            TO BFORCEA
 10073            MOVE -1                  TO BFORCEL
 10074            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10075
 10076     if (bforcel not = zeros)
 10077        and (bforcei = 'L')
 10078        and (not csr-edit-session)
 10079        and (emi-error <> er-2945)
 10080        MOVE ER-2670             TO EMI-ERROR
 10081        MOVE AL-UABON            TO BFORCEA
 10082        MOVE -1                  TO BFORCEL
 10083        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10084     end-if
 10085     IF BENTRYL NOT = ZEROS
 10086        IF BENTRYI NOT = ' ' AND 'E' AND 'R' AND 'P' AND
 10087                 'C' and 'D' AND 'V' AND 'U' AND 'M'
 10088           MOVE ER-2224              TO EMI-ERROR
 10089           MOVE AL-UABON             TO BENTRYA
 10090           MOVE -1                   TO BENTRYL
 10091           MOVE  1                   TO SET-CURSOR-SW
 10092           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10093        ELSE
 10094           MOVE AL-UANON             TO BENTRYA.
 10095
 10096     IF BUNWRITL NOT = ZEROS
 10097        IF BUNWRITI NOT = ' ' AND 'A' AND 'D' AND 'U' AND 'N'
 10098           MOVE ER-7574              TO EMI-ERROR
 10099           MOVE AL-UABON             TO BUNWRITA
 10100           MOVE -1                   TO BUNWRITL
 10101           MOVE  1                   TO SET-CURSOR-SW
 10102           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10103        ELSE
 10104           MOVE AL-UANON             TO BUNWRITA.
 10105
 10106     IF BREINL  NOT = ZEROS
 10107         MOVE AL-UANON               TO BREINA.
 10108
 10109     IF BBILCDL NOT = ZEROS
 10110        IF BBILCDI NOT = ' ' AND 'H' AND 'R' AND 'L'
 10111                             AND 'A' AND 'B' AND 'E'
 10112           MOVE ER-2225              TO EMI-ERROR
 10113           MOVE AL-UABON             TO BBILCDA
 10114           MOVE -1                   TO BBILCDL
 10115           MOVE  1                   TO SET-CURSOR-SW
 10116           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10117        ELSE
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 185
* EL6311.cbl
 10118           MOVE AL-UANON             TO BBILCDA.
 10119
 10120     IF BSKPCDL NOT = ZEROS
 10121         MOVE AL-UANON               TO BSKPCDA.
 10122
 10123     IF BINDGRPL NOT = ZEROS
 10124         MOVE AL-UANON               TO BINDGRPA.
 10125
 10126     IF BSIGL   NOT = ZEROS
 10127         MOVE AL-UANON               TO BSIGA.
 10128
 10129     IF BRTCLSL NOT = ZEROS
 10130         MOVE AL-UANON               TO BRTCLSA.
 10131
 10132     IF BMEMBERL NOT = ZEROS
 10133         MOVE AL-UANON               TO BMEMBERA.
 10134
 10135     MOVE +0                         TO WS-SUB1.
 10136
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 186
* EL6311.cbl
 10138
 10139******************************************************************
 10140*                                                                *
 10141*           E D I T   I S S U E   C O V E R A G E S              *
 10142*                                                                *
 10143******************************************************************
 10144
 10145 1020-EDIT-COVERAGES.
 10146     ADD +1                      TO WS-SUB1.
 10147
 10148     IF WS-SUB1 GREATER +2
 10149        GO TO 1025-EDIT-CONTINUE
 10150     END-IF
 10151
 10152     IF PI-COMPANY-ID = CLIENT-CRI OR CLIENT-LGX
 10153       IF (BMODEL   GREATER ZERO  OR
 10154            BPMTSL   GREATER ZERO  OR
 10155            BPMTAMTL GREATER ZERO)
 10156          AND
 10157            BTYPE-LEN (WS-SUB1) GREATER THAN +0
 10158               GO TO 1021-CONT-EDIT.
 10159
 10160     IF BTYPE-LEN      (WS-SUB1) GREATER THAN ZEROS OR
 10161        BTERM-LEN      (WS-SUB1) GREATER THAN ZEROS OR
 10162        BBEN-LEN       (WS-SUB1) GREATER THAN ZEROS OR
 10163        BPREM-LEN      (WS-SUB1) GREATER THAN ZEROS OR
 10164        BCRIT-PERD-LEN (WS-SUB1) GREATER THAN ZEROS OR
 10165        BEXPIRE-LEN    (WS-SUB1) GREATER THAN ZEROS OR
 10166        BALT-PREM-LEN  (WS-SUB1) GREATER THAN ZEROS OR
 10167        BALT-BEN-LEN   (WS-SUB1) GREATER THAN ZEROS
 10168        NEXT SENTENCE
 10169         ELSE
 10170            GO TO 1020-EDIT-COVERAGES.
 10171
 10172 1021-CONT-EDIT.
 10173
 10174     IF BMAINTI = 'A'
 10175        IF BTYPE-LEN  (WS-SUB1) GREATER THAN ZEROS
 10176           MOVE AL-UANON         TO BTYPE-ATTRB       (WS-SUB1)
 10177        ELSE
 10178           MOVE  -1              TO BTYPE-LEN         (WS-SUB1)
 10179           MOVE ER-7404          TO EMI-ERROR
 10180           MOVE AL-SABON         TO BKIND-ATTRB       (WS-SUB1)
 10181           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10182     ELSE
 10183        IF BTYPE-LEN  (WS-SUB1) GREATER THAN ZEROS
 10184           MOVE AL-UANON         TO BTYPE-ATTRB       (WS-SUB1).
 10185
 10186     IF BTERM-LEN (WS-SUB1) NOT EQUAL +0
 10187        MOVE BTERMI (WS-SUB1)    TO DEEDIT-FIELD
 10188        PERFORM 8600-DEEDIT
 10189        IF DEEDIT-FIELD-V0 NUMERIC
 10190           MOVE DEEDIT-FIELD-V0  TO WS-BTERM (WS-SUB1)
 10191        ELSE
 10192           MOVE ZEROS            TO WS-BTERM (WS-SUB1).
 10193
 10194     IF PI-COMPANY-ID NOT = CLIENT-CRI AND CLIENT-LGX
 10195*      IF BTERM-LEN (WS-SUB1) NOT GREATER THAN +0
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 187
* EL6311.cbl
 10196        IF BMODEL  GREATER THAN ZEROS  AND
 10197           BPMTSL  GREATER THAN ZEROS
 10198           PERFORM 6100-TERM-CONVERSION THRU 6199-EXIT.
 10199
 10200     IF PI-COMPANY-ID = CLIENT-CRI OR CLIENT-LGX
 10201         IF BMODEL   GREATER THAN ZEROS  OR
 10202            BPMTSL   GREATER THAN ZEROS  OR
 10203            BPMTAMTL GREATER THAN ZEROS
 10204             PERFORM 6100-TERM-CONVERSION THRU 6199-EXIT.
 10205
 10206     IF BMAINTI = ('C' OR 'K')
 10207        IF BTERM-LEN (WS-SUB1)  = ZEROS
 10208           NEXT SENTENCE
 10209        ELSE
 10210           MOVE BTERMI    (WS-SUB1)   TO DEEDIT-FIELD
 10211           PERFORM 8600-DEEDIT
 10212           IF DEEDIT-FIELD-V0 NUMERIC
 10213              MOVE DEEDIT-FIELD-V0    TO WS-BTERM    (WS-SUB1)
 10214              IF WS-BTERM (WS-SUB1)  GREATER THAN ZERO
 10215                    MOVE AL-UNNON     TO BTERM-ATTRB (WS-SUB1)
 10216              ELSE
 10217                    MOVE ER-2241      TO EMI-ERROR
 10218                    MOVE -1           TO BTERM-LEN   (WS-SUB1)
 10219                    MOVE AL-UNBON     TO BTERM-ATTRB (WS-SUB1)
 10220                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10221           ELSE
 10222              MOVE ER-2223          TO EMI-ERROR
 10223              MOVE -1               TO BTERM-LEN     (WS-SUB1)
 10224              MOVE AL-UNBON         TO BTERM-ATTRB   (WS-SUB1)
 10225              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10226     ELSE
 10227        IF  BTERM-LEN      (WS-SUB1)   GREATER THAN ZEROS
 10228            MOVE BTERMI    (WS-SUB1)   TO DEEDIT-FIELD
 10229            PERFORM 8600-DEEDIT
 10230            IF DEEDIT-FIELD-V0      NUMERIC
 10231               IF DEEDIT-FIELD-V0     GREATER THAN ZERO
 10232                  MOVE DEEDIT-FIELD-V0 TO WS-BTERM    (WS-SUB1)
 10233                  MOVE AL-UNNON        TO BTERM-ATTRB (WS-SUB1)
 10234               ELSE
 10235                  MOVE ER-2241         TO EMI-ERROR
 10236                  MOVE -1              TO BTERM-LEN   (WS-SUB1)
 10237                  MOVE AL-UNBON        TO BTERM-ATTRB (WS-SUB1)
 10238                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10239            ELSE
 10240              MOVE ER-2223             TO EMI-ERROR
 10241              MOVE -1                  TO BTERM-LEN   (WS-SUB1)
 10242              MOVE AL-UNBON            TO BTERM-ATTRB (WS-SUB1)
 10243              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10244        ELSE
 10245            MOVE ER-2240               TO EMI-ERROR
 10246            MOVE -1                    TO BTERM-LEN   (WS-SUB1)
 10247            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10248*    IF PI-COMPANY-ID NOT = CLIENT-CRI AND CLIENT-LGX
 10249*        IF BMODEL  GREATER THAN ZEROS  AND
 10250*           BPMTSL  GREATER THAN ZEROS
 10251*            PERFORM 6100-TERM-CONVERSION THRU 6199-EXIT.
 10252
 10253     IF BBEN-LEN (WS-SUB1) = ZEROS
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 188
* EL6311.cbl
 10254        AND BMAINTI = ('C' OR 'K')
 10255           NEXT SENTENCE
 10256     ELSE
 10257        IF BBEN-LEN (WS-SUB1) GREATER THAN ZEROS
 10258           MOVE AL-UNNON           TO BBEN-ATTRB (WS-SUB1)
 10259
 10260* EXEC CICS BIF DEEDIT
 10261*              FIELD  (BBENI (WS-SUB1))
 10262*              LENGTH (12)
 10263*          END-EXEC
 10264     MOVE 12
 10265       TO DFHEIV11
 10266*    MOVE '@"L                   #   #00010138' TO DFHEIV0
 10267     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10268     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10269     MOVE X'2020233030303130313338' TO DFHEIV0(25:11)
 10270     CALL 'kxdfhei1' USING DFHEIV0,
 10271           BBENI(WS-SUB1),
 10272           DFHEIV11
 10273     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10274           IF BBENI (WS-SUB1)  NUMERIC
 10275              IF BBENI (WS-SUB1) GREATER THAN ZEROS
 10276                 MOVE BBENI (WS-SUB1) TO WS-BBEN    (WS-SUB1)
 10277*          MOVE BBENI (WS-SUB1)    TO DEEDIT-FIELD
 10278*          PERFORM 8600-DEEDIT
 10279*          IF DEEDIT-FIELD-V2  NUMERIC
 10280*             IF DEEDIT-FIELD-V2 GREATER THAN ZEROS
 10281*                MOVE DEEDIT-FIELD-V2 TO WS-BBEN    (WS-SUB1)
 10282              ELSE
 10283                 MOVE ER-7632    TO EMI-ERROR
 10284                 MOVE -1         TO BBEN-LEN   (WS-SUB1)
 10285                 MOVE AL-UNBON   TO BBEN-ATTRB (WS-SUB1)
 10286                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10287           ELSE
 10288              MOVE ER-2223         TO EMI-ERROR
 10289              MOVE -1              TO BBEN-LEN   (WS-SUB1)
 10290              MOVE AL-UNBON        TO BBEN-ATTRB (WS-SUB1)
 10291              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10292        ELSE
 10293           MOVE ER-7632    TO EMI-ERROR
 10294           MOVE -1         TO BBEN-LEN   (WS-SUB1)
 10295           MOVE AL-UNBON   TO BBEN-ATTRB (WS-SUB1)
 10296           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10297
 10298     IF (BPREM-LEN    (WS-SUB1) = ZEROS)
 10299        AND (BMAINTI = ('C' OR 'K'))
 10300        CONTINUE
 10301     ELSE
 10302        IF BPREM-LEN   (WS-SUB1) GREATER THAN ZEROS
 10303           MOVE AL-UNNON           TO BPREM-ATTRB (WS-SUB1)
 10304           INSPECT BPREM-ALPHA (WS-SUB1) TALLYING WS-TALLY
 10305              FOR ALL '.'
 10306           IF WS-TALLY > 1
 10307              PERFORM VARYING A1 FROM 1 BY 1 UNTIL
 10308                 BPREM-ALPHA (WS-SUB1) (A1:1) = '.'
 10309              END-PERFORM
 10310              IF A1 < 9
 10311                 ADD 3 TO A1
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 189
* EL6311.cbl
 10312                 MOVE SPACES TO BPREM-ALPHA (WS-SUB1) (A1:12 - A1)
 10313              END-IF
 10314           ELSE
 10315              PERFORM VARYING A1 FROM 1 BY 1 UNTIL
 10316                (A1 > 11)
 10317                OR (BPREM-ALPHA (WS-SUB1) (A1:1) =
 10318                  LOW-VALUES OR SPACES)
 10319              END-PERFORM
 10320              IF A1 > 1 AND < 12
 10321                 MOVE SPACES
 10322                           TO BPREM-ALPHA (WS-SUB1) (A1:12 - A1)
 10323              END-IF
 10324           END-IF
 10325
 10326* EXEC CICS BIF DEEDIT
 10327*              FIELD  (BPREMI (WS-SUB1))
 10328*              LENGTH (11)
 10329*          END-EXEC
 10330     MOVE 11
 10331       TO DFHEIV11
 10332*    MOVE '@"L                   #   #00010193' TO DFHEIV0
 10333     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10334     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10335     MOVE X'2020233030303130313933' TO DFHEIV0(25:11)
 10336     CALL 'kxdfhei1' USING DFHEIV0,
 10337           BPREMI(WS-SUB1),
 10338           DFHEIV11
 10339     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10340           IF BPREMI (WS-SUB1) NUMERIC
 10341              IF BPREMI (WS-SUB1) GREATER THAN ZEROS
 10342                 MOVE BPREMI (WS-SUB1) TO WS-BPREM   (WS-SUB1)
 10343*          MOVE BPREMI (WS-SUB1)   TO DEEDIT-FIELD
 10344*          PERFORM 8600-DEEDIT
 10345*          IF DEEDIT-FIELD-V2  NUMERIC
 10346*             IF DEEDIT-FIELD-V2 GREATER THAN ZEROS
 10347*                MOVE DEEDIT-FIELD-V2 TO WS-BPREM   (WS-SUB1)
 10348              ELSE
 10349                 IF PI-COMPANY-ID NOT = 'DCC' and 'VPP'
 10350                    MOVE ER-7633    TO EMI-ERROR
 10351                    MOVE -1         TO BPREM-LEN   (WS-SUB1)
 10352                    MOVE AL-UNBON   TO BPREM-ATTRB (WS-SUB1)
 10353                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10354                 END-IF
 10355              END-IF
 10356           ELSE
 10357              MOVE ER-2223         TO EMI-ERROR
 10358              MOVE -1              TO BPREM-LEN   (WS-SUB1)
 10359              MOVE AL-UNBON        TO BPREM-ATTRB (WS-SUB1)
 10360              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10361           END-IF
 10362        ELSE
 10363           IF PI-COMPANY-ID NOT = 'DCC' and 'VPP'
 10364              MOVE ER-7633         TO EMI-ERROR
 10365              MOVE -1              TO BPREM-LEN   (WS-SUB1)
 10366              MOVE AL-UNBON        TO BPREM-ATTRB (WS-SUB1)
 10367              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10368           END-IF
 10369        END-IF
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 190
* EL6311.cbl
 10370     END-IF
 10371
 10372     IF BCPREM-LEN   (WS-SUB1) = ZEROS
 10373        NEXT SENTENCE
 10374     ELSE
 10375        MOVE AL-UNNON           TO BCPREM-ATTRB (WS-SUB1)
 10376
 10377* EXEC CICS BIF DEEDIT
 10378*           FIELD  (BCPREMI (WS-SUB1))
 10379*           LENGTH (11)
 10380*       END-EXEC
 10381     MOVE 11
 10382       TO DFHEIV11
 10383*    MOVE '@"L                   #   #00010233' TO DFHEIV0
 10384     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10385     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10386     MOVE X'2020233030303130323333' TO DFHEIV0(25:11)
 10387     CALL 'kxdfhei1' USING DFHEIV0,
 10388           BCPREMI(WS-SUB1),
 10389           DFHEIV11
 10390     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10391        IF BCPREMI (WS-SUB1) NUMERIC
 10392           MOVE BCPREMI (WS-SUB1) TO WS-BCPREM  (WS-SUB1)
 10393*       MOVE BCPREMI (WS-SUB1)  TO DEEDIT-FIELD-X11
 10394*       PERFORM 8600-DEEDIT
 10395*       IF DEEDIT-FIELD-V2  NUMERIC
 10396*          MOVE DEEDIT-FIELD-V2 TO WS-BCPREM  (WS-SUB1)
 10397        ELSE
 10398           MOVE ER-2223         TO EMI-ERROR
 10399           MOVE -1              TO BCPREM-LEN   (WS-SUB1)
 10400           MOVE AL-UNBON        TO BCPREM-ATTRB (WS-SUB1)
 10401           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10402
 10403     IF BCRIT-PERD-LEN  (WS-SUB1)    GREATER THAN ZEROS
 10404        MOVE BCRIT-PERDI (WS-SUB1)   TO DEEDIT-FIELD
 10405        PERFORM 8600-DEEDIT
 10406        IF DEEDIT-FIELD-V0 NUMERIC
 10407           MOVE DEEDIT-FIELD-V0      TO WS-BCRIT-PERD    (WS-SUB1)
 10408           MOVE AL-UNNON             TO BCRIT-PERD-ATTRB (WS-SUB1)
 10409         ELSE
 10410           MOVE -1                   TO BCRIT-PERD-LEN   (WS-SUB1)
 10411           MOVE AL-UNBON             TO BCRIT-PERD-ATTRB (WS-SUB1)
 10412           MOVE ER-2223              TO EMI-ERROR
 10413           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10414
 10415     IF BEXPIRE-LEN  (WS-SUB1)    GREATER THAN ZEROS
 10416        IF BEXPIRE   (WS-SUB1) = SPACES
 10417           MOVE LOW-VALUES       TO WS-CONVERTED-EXPIRDT (WS-SUB1)
 10418        ELSE
 10419           MOVE BEXPIRE (WS-SUB1)   TO DEEDIT-FIELD
 10420           PERFORM 8600-DEEDIT
 10421           IF DEEDIT-FIELD-V0        NUMERIC
 10422              MOVE AL-UNNON         TO BEXPIRE-ATTRB (WS-SUB1)
 10423              MOVE 4                TO DC-OPTION-CODE
 10424              MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
 10425              PERFORM 9700-DATE-LINK
 10426              MOVE DC-BIN-DATE-1    TO WS-CONVERTED-EXPIRDT
 10427                                                        (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 191
* EL6311.cbl
 10428              IF NO-CONVERSION-ERROR
 10429                 NEXT SENTENCE
 10430              ELSE
 10431                 MOVE -1         TO BEXPIRE-LEN   (WS-SUB1)
 10432                 MOVE ER-2531    TO EMI-ERROR
 10433                 MOVE AL-UNBON   TO BEXPIRE-ATTRB (WS-SUB1)
 10434                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10435           ELSE
 10436             MOVE -1             TO BEXPIRE-LEN   (WS-SUB1)
 10437             MOVE ER-2532        TO EMI-ERROR
 10438             MOVE AL-UNBON       TO BEXPIRE-ATTRB (WS-SUB1)
 10439             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10440
 10441     IF BALT-BEN-LEN   (WS-SUB1)  = ZEROS
 10442        NEXT SENTENCE
 10443     ELSE
 10444
 10445* EXEC CICS BIF DEEDIT
 10446*           FIELD  (BALT-BENI (WS-SUB1))
 10447*           LENGTH (12)
 10448*       END-EXEC
 10449     MOVE 12
 10450       TO DFHEIV11
 10451*    MOVE '@"L                   #   #00010290' TO DFHEIV0
 10452     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10453     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10454     MOVE X'2020233030303130323930' TO DFHEIV0(25:11)
 10455     CALL 'kxdfhei1' USING DFHEIV0,
 10456           BALT-BENI(WS-SUB1),
 10457           DFHEIV11
 10458     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10459        IF BALT-BENI (WS-SUB1) NUMERIC
 10460           MOVE BALT-BENI (WS-SUB1) TO WS-BALT-BEN    (WS-SUB1)
 10461*       MOVE BALT-BENI (WS-SUB1) TO DEEDIT-FIELD
 10462*       PERFORM 8600-DEEDIT
 10463*       IF DEEDIT-FIELD-V0 NUMERIC
 10464*          MOVE DEEDIT-FIELD-V2 TO WS-BALT-BEN        (WS-SUB1)
 10465        ELSE
 10466           MOVE ER-2223         TO EMI-ERROR
 10467           MOVE -1              TO BALT-BEN-LEN       (WS-SUB1)
 10468           MOVE AL-UNBON        TO BALT-BEN-ATTRB     (WS-SUB1)
 10469           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10470
 10471     IF BALT-PREM-LEN (WS-SUB1)  = ZEROS
 10472        NEXT SENTENCE
 10473     ELSE
 10474
 10475* EXEC CICS BIF DEEDIT
 10476*           FIELD  (BALT-PREMI (WS-SUB1))
 10477*           LENGTH (11)
 10478*       END-EXEC
 10479     MOVE 11
 10480       TO DFHEIV11
 10481*    MOVE '@"L                   #   #00010309' TO DFHEIV0
 10482     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10483     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10484     MOVE X'2020233030303130333039' TO DFHEIV0(25:11)
 10485     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 192
* EL6311.cbl
 10486           BALT-PREMI(WS-SUB1),
 10487           DFHEIV11
 10488     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10489        IF BALT-PREMI (WS-SUB1) NUMERIC
 10490           MOVE BALT-PREMI (WS-SUB1) TO WS-BALT-PREM  (WS-SUB1)
 10491*       MOVE BALT-PREMI    (WS-SUB1)   TO DEEDIT-FIELD
 10492*       PERFORM 8600-DEEDIT
 10493*       IF DEEDIT-FIELD-V0 NUMERIC
 10494*          MOVE DEEDIT-FIELD-V2 TO WS-BALT-PREM       (WS-SUB1)
 10495        ELSE
 10496           MOVE ER-2223         TO EMI-ERROR
 10497           MOVE -1              TO BALT-PREM-LEN      (WS-SUB1)
 10498           MOVE AL-UNBON        TO BALT-PREM-ATTRB    (WS-SUB1)
 10499           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10500
 10501      GO TO 1020-EDIT-COVERAGES.
 10502     .
 10503 1025-edit-continue.
 10504     IF PI-COMPANY-ID  =  'DMD'
 10505        MOVE LOW-VALUES             TO BNCERTI
 10506                                       BNSTATI.
 10507
 10508     IF EMI-ERROR = ZEROS
 10509         NEXT SENTENCE
 10510     ELSE
 10511         GO TO 8200-SEND-DATAONLY.
 10512
 10513     IF BMAINTI = 'A'
 10514         GO TO 1200-ADD-ISSUE-ROUTINE.
 10515
 10516     IF BMAINTI = 'C'
 10517         GO TO 1300-CHANGE-ISSUE-ROUTINE.
 10518**  This must be a 'K' transaction A,C,S & D spoke for
 10519
 10520     GO TO 2800-REWRITE-ISSUE-CERT-KEY.
 10521
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 193
* EL6311.cbl
 10523
 10524 1030-EDIT-FOR-NUMERICS.
 10525     IF WS-CSO-SUB EQUAL 10
 10526        GO TO 1030-EDIT-EXIT.
 10527
 10528     IF (WS-EDIT-BYTE (WS-CSO-SUB) NUMERIC OR
 10529        WS-EDIT-BYTE (WS-CSO-SUB) EQUAL ',' OR
 10530        WS-EDIT-BYTE (WS-CSO-SUB) EQUAL LOW-VALUES)
 10531           ADD +1               TO WS-CSO-SUB
 10532           GO TO 1030-EDIT-FOR-NUMERICS.
 10533
 10534     MOVE 'N'                   TO WS-NUMERIC-SW.
 10535
 10536 1030-EDIT-EXIT.
 10537******************************************************************
 10538*                                                                *
 10539*                 C A L C U L A T E   A G E                      *
 10540*                                                                *
 10541******************************************************************
 10542
 10543
 10544 1095-CALC-AGE.
 10545
 10546     MOVE WS-CONVERTED-BIRTH TO DC-BIN-DATE-1.
 10547     MOVE WS-CURRENT-BIN-DT  TO DC-BIN-DATE-2.
 10548     MOVE 1                  TO DC-OPTION-CODE.
 10549     PERFORM 9700-DATE-LINK
 10550     IF NO-CONVERSION-ERROR
 10551         COMPUTE WS-BAGE = DC-ELAPSED-MONTHS / 12
 10552         MOVE WS-BAGE            TO BAGEI
 10553         MOVE +2                 TO BAGEL
 10554         MOVE AL-UNNON TO BAGEA.
 10555
 10556 1099-EXIT.
 10557     EXIT.
 10558
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 194
* EL6311.cbl
 10560
 10561******************************************************************
 10562*                                                                *
 10563*                   S H O W   I S S U E                          *
 10564*                                                                *
 10565******************************************************************
 10566
 10567 1100-SHOW-REQUEST.
 10568     MOVE 'S'                    TO PI-MAINT-FUNCTION.
 10569
 10570     IF BCERTNOL = ZEROS AND
 10571        BEFFDTL  = ZEROS
 10572        MOVE -1                  TO BMAINTL
 10573        GO TO 8200-SEND-DATAONLY.
 10574
 10575     MOVE BCERTNOI               TO WS-NEW-PRIME.
 10576
 10577     IF BSUFIXL NOT = ZEROS
 10578        MOVE BSUFIXI             TO WS-NEW-SUFFIX
 10579     ELSE
 10580        MOVE SPACE               TO WS-NEW-SUFFIX.
 10581
 10582     MOVE BEFFDTI                TO DEEDIT-FIELD.
 10583     PERFORM 8600-DEEDIT.
 10584     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 10585     MOVE '4'                    TO DC-OPTION-CODE.
 10586     PERFORM 9700-DATE-LINK.
 10587     IF DATE-CONVERSION-ERROR
 10588        MOVE ER-0348             TO EMI-ERROR
 10589        MOVE -1                  TO BEFFDTL
 10590        MOVE AL-UABON            TO BEFFDTA
 10591        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10592        GO TO 8200-SEND-DATAONLY
 10593     ELSE
 10594        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
 10595        MOVE AL-UANON            TO BEFFDTA
 10596        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 10597
 10598     MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
 10599
 10600     IF ERPNDB-CERT-NO     NOT = WS-NEW-CERT-NO   OR
 10601        ERPNDB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT
 10602          MOVE 'Y'                    TO WS-SHOW-SW
 10603          IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
 10604             GO TO 4100-BROWSE-PRIMARY-FORWARD
 10605           ELSE
 10606             IF PI-FILE-BROWSE
 10607                GO TO 4300-BROWSE-FILE-FORWARD
 10608              ELSE
 10609                IF PI-CSR-BROWSE
 10610                   GO TO 4200-BROWSE-CSR-FORWARD
 10611                ELSE
 10612                   GO TO 4000-BROWSE-DETAIL-FORWARD
 10613        ELSE
 10614           GO TO 3900-RE-DISPLAY-RECORD.
 10615
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 195
* EL6311.cbl
 10617
 10618******************************************************************
 10619*                                                                *
 10620*            A D D   I S S U E   R O U T I N E                   *
 10621*                                                                *
 10622******************************************************************
 10623
 10624***************************************************************
 10625*     1. GETMAIN FOR PENDING BUSINESS RECORDS.                *
 10626*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
 10627*     3. INITIALIZE RECORD WITH INITIAL DATA FROM SCREEN.     *
 10628*     4. LINK TO THE EDIT ROUTINE.                            *
 10629*     5. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
 10630*     6. WRITE THE NEW ISSUE RECORD.                          *
 10631*     7. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
 10632*     8. IF ANY ERRORS ARE DETECTED, THE ISSUE SCREEN IS      *
 10633*           DISPLAYED WITH ANY ASSOCIATED ERRORS,             *
 10634*        ELSE                                                 *
 10635*           A NEW INITIALIZED SCREEN WILL BE DISPLAYED.       *
 10636***************************************************************
 10637
 10638 1200-ADD-ISSUE-ROUTINE.
 10639     MOVE 'A'                    TO PI-MAINT-FUNCTION.
 10640
 10641
 10642* EXEC CICS GETMAIN
 10643*        SET     (ADDRESS OF PENDING-BUSINESS)
 10644*        LENGTH  (ERPNDB-RECORD-LENGTH)
 10645*    END-EXEC.
 10646*    MOVE '," L                  $   #00010465' TO DFHEIV0
 10647     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 10648     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10649     MOVE X'2020233030303130343635' TO DFHEIV0(25:11)
 10650     CALL 'kxdfhei1' USING DFHEIV0,
 10651           DFHEIV20,
 10652           ERPNDB-RECORD-LENGTH,
 10653           DFHEIV99
 10654     SET ADDRESS OF PENDING-BUSINESS TO
 10655         DFHEIV20
 10656     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10657
 10658
 10659
 10660* EXEC CICS HANDLE CONDITION
 10661*         NOTFND    (1280-BATCH-HDR-NOT-FOUND)
 10662*    END-EXEC.
 10663*    MOVE '"$I                   ! # #00010470' TO DFHEIV0
 10664     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10665     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10666     MOVE X'2320233030303130343730' TO DFHEIV0(25:11)
 10667     CALL 'kxdfhei1' USING DFHEIV0
 10668     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10669
 10670
 10671     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 10672     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 10673     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 10674
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 196
* EL6311.cbl
 10675
 10676* EXEC CICS READ
 10677*        INTO    (PENDING-BUSINESS)
 10678*        DATASET (FILE-ID-ERPNDB)
 10679*        RIDFLD  (ERPNDB-KEY)
 10680*    END-EXEC.
 10681     MOVE LENGTH OF
 10682      PENDING-BUSINESS
 10683       TO DFHEIV11
 10684*    MOVE '&"IL       E          (   #00010478' TO DFHEIV0
 10685     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10686     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10687     MOVE X'2020233030303130343738' TO DFHEIV0(25:11)
 10688     CALL 'kxdfhei1' USING DFHEIV0,
 10689           FILE-ID-ERPNDB,
 10690           PENDING-BUSINESS,
 10691           DFHEIV11,
 10692           ERPNDB-KEY,
 10693           DFHEIV99,
 10694           DFHEIV99,
 10695           DFHEIV99
 10696     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10697
 10698
 10699     MOVE PB-CSR-ID              TO WS-BATCH-CSR-ID.
 10700
 10701     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 10702     ADD +1                      TO WS-B-HIGHEST-SEQ-NO.
 10703     MOVE PB-CREDIT-SELECT-DT    TO WS-CREDIT-SELECT-DT.
 10704     MOVE SPACES                 TO PENDING-BUSINESS.
 10705     MOVE 'PB'                   TO PB-RECORD-ID.
 10706     MOVE PI-PREV-KEY            TO PB-CONTROL-PRIMARY.
 10707     MOVE PI-PREV-ALT-KEY        TO PB-CONTROL-BY-ACCOUNT.
 10708     MOVE SPACES                 TO PB-CERT-SFX.
 10709     MOVE WS-B-HIGHEST-SEQ-NO    TO PB-BATCH-SEQ-NO.
 10710     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
 10711                                    PB-ALT-CHG-SEQ-NO.
 10712
 10713     MOVE BCERTNOI               TO PB-CERT-PRIME.
 10714     MOVE '1'                    TO PB-RECORD-TYPE.
 10715
 10716     IF BSUFIXL NOT = ZEROS
 10717        MOVE BSUFIXI             TO PB-CERT-SFX.
 10718
 10719     MOVE WS-CONVERTED-EFFDT     TO PB-CERT-EFF-DT.
 10720
 10721     MOVE PI-COMPANY-CD          TO PB-COMPANY-CD.
 10722     MOVE PI-COMPANY-ID          TO PB-COMPANY-ID.
 10723
 10724     MOVE ZEROS                  TO PB-I-LOAN-TERM
 10725                                    PB-I-LF-PREM-CALC
 10726                                    PB-I-LF-ALT-PREM-CALC
 10727                                    PB-I-LF-RATE
 10728                                    PB-I-LF-ALT-RATE
 10729                                    PB-I-LF-REI-RATE
 10730                                    PB-I-LF-ALT-REI-RATE
 10731                                    PB-I-RATE-DEV-PCT-LF
 10732                                    PB-I-AH-PREM-CALC
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 197
* EL6311.cbl
 10733                                    PB-I-AH-RATE
 10734                                    PB-I-AH-REI-RATE
 10735                                    PB-I-AH-RATE-TRM
 10736                                    PB-I-RATE-DEV-PCT-AH
 10737                                    PB-I-BUSINESS-TYPE
 10738                                    PB-I-LIFE-COMMISSION
 10739                                    PB-I-JOINT-COMMISSION
 10740                                    PB-I-JOINT-AGE
 10741                                    PB-I-AH-COMMISSION
 10742                                    PB-I-CURR-SEQ
 10743                                    PB-CHG-COUNT
 10744                                    PB-LF-BILLED-AMTS
 10745                                    PB-AH-BILLED-AMTS
 10746                                    PB-CALC-TOLERANCE
 10747                                    PB-I-EXTENTION-DAYS
 10748*                                   PB-I-MICROFILM-NO
 10749                                    PB-I-TERM-IN-DAYS.
 10750
 10751     MOVE LOW-VALUES             TO PB-CREDIT-ACCEPT-DT
 10752                                    PB-I-LF-EXPIRE-DT
 10753                                    PB-I-AH-EXPIRE-DT
 10754                                    PB-BILLED-DT
 10755                                    PB-ACCT-EFF-DT
 10756                                    PB-ACCT-EXP-DT
 10757                                    PB-I-1ST-PMT-DT.
 10758
 10759     MOVE 'X'                    TO PB-FATAL-FLAG.
 10760
 10761     MOVE WS-CREDIT-SELECT-DT    TO PB-CREDIT-SELECT-DT.
 10762
 10763     IF BLSTNML GREATER THAN ZEROS
 10764         MOVE BLSTNMI            TO PB-I-INSURED-LAST-NAME.
 10765
 10766*    IF BMICRNOL  GREATER  ZEROS
 10767*        MOVE BMICRNOI           TO  PB-I-MICROFILM-NO
 10768*    ELSE
 10769*        MOVE ZEROS              TO  PB-I-MICROFILM-NO.
 10770     IF BVINL > ZEROS
 10771        MOVE BVINI               TO PB-I-VIN
 10772     END-IF
 10773     IF B1STNML GREATER THAN ZEROS
 10774         MOVE B1STNMI            TO PB-I-INSURED-FIRST-NAME.
 10775
 10776     IF BINITL  GREATER THAN ZEROS
 10777         MOVE BINITI             TO PB-I-INSURED-MIDDLE-INIT.
 10778
 10779     IF BBIRTHL GREATER THAN ZERO
 10780         MOVE WS-CONVERTED-BIRTH TO PB-I-BIRTHDAY
 10781     ELSE
 10782         MOVE LOW-VALUES         TO PB-I-BIRTHDAY.
 10783
 10784     IF B1STPMTL GREATER THAN ZERO
 10785         MOVE WS-CONVERTED-1ST-PMT-DT TO PB-I-1ST-PMT-DT
 10786     ELSE
 10787         MOVE LOW-VALUES              TO PB-I-1ST-PMT-DT.
 10788
 10789     IF BAGEL    GREATER THAN ZEROS
 10790         MOVE BAGEI              TO PB-I-AGE
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 198
* EL6311.cbl
 10791        ELSE
 10792         MOVE ZEROS              TO PB-I-AGE.
 10793
 10794     IF BSEXL    GREATER THAN ZEROS
 10795         MOVE BSEXI              TO PB-I-INSURED-SEX.
 10796
 10797     IF BTERM-LEN (1) GREATER THAN ZEROS
 10798        MOVE WS-BTERM (1)        TO PB-I-LF-TERM
 10799     ELSE
 10800        MOVE ZEROS               TO PB-I-LF-TERM.
 10801
 10802     IF BTERM-LEN (2) GREATER THAN ZEROS
 10803        MOVE WS-BTERM (2)        TO PB-I-AH-TERM
 10804     ELSE
 10805        MOVE ZEROS               TO PB-I-AH-TERM.
 10806
 10807     IF BLNTRML       GREATER THAN ZEROS
 10808         MOVE BLNTRMI            TO PB-I-LOAN-TERM
 10809        ELSE
 10810         MOVE ZEROS              TO PB-I-LOAN-TERM.
 10811
 10812     IF BFREQL        GREATER THAN ZEROS
 10813         MOVE BFREQI             TO PB-I-PAY-FREQUENCY
 10814        ELSE
 10815         MOVE ZEROS              TO PB-I-PAY-FREQUENCY.
 10816
 10817     IF BSKPCDL       GREATER THAN ZEROS
 10818         MOVE BSKPCDI            TO PB-I-SKIP-CODE.
 10819
 10820     IF BMODEL        GREATER THAN ZEROS
 10821         MOVE BMODEI             TO PB-I-TERM-TYPE
 10822                                    PI-BMODE.
 10823
 10824     IF BPMTSL        GREATER THAN ZEROS
 10825         MOVE BPMTSI             TO PB-I-NO-OF-PAYMENTS
 10826                                    PI-BPMTS
 10827        ELSE
 10828         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS
 10829                                    PI-BPMTS.
 10830
 10831     IF BPMTAMTL      GREATER THAN ZEROS
 10832         MOVE PI-BPMTAMT         TO PB-I-PAYMENT-AMOUNT
 10833        ELSE
 10834         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.
 10835
 10836     IF BTYPE-LEN (1)   GREATER THAN ZEROS
 10837        IF BTYPE  (1)   NOT = ZEROS
 10838           MOVE BTYPE (1)        TO PB-I-LF-INPUT-CD
 10839                                    PI-BTYPE (1)
 10840           MOVE ZEROS            TO PB-I-LF-BENEFIT-CD
 10841           MOVE SPACES           TO PB-I-LF-ABBR
 10842        ELSE
 10843           MOVE SPACES           TO PB-I-LF-INPUT-CD
 10844                                    PB-I-LF-ABBR
 10845           MOVE ZEROS            TO PB-I-LF-BENEFIT-CD
 10846     ELSE
 10847        MOVE SPACES              TO PB-I-LF-INPUT-CD
 10848                                    PB-I-LF-ABBR
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 199
* EL6311.cbl
 10849        MOVE ZEROS               TO PB-I-LF-BENEFIT-CD.
 10850
 10851     IF  BBEN-LEN      (1)  GREATER THAN ZEROS
 10852         MOVE WS-BBEN  (1)       TO PB-I-LF-BENEFIT-AMT
 10853     ELSE
 10854         MOVE ZEROS              TO PB-I-LF-BENEFIT-AMT.
 10855
 10856     IF  BALT-BEN-LEN     (1)  GREATER THAN ZEROS
 10857         MOVE WS-BALT-BEN (1)    TO PB-I-LF-ALT-BENEFIT-AMT
 10858     ELSE
 10859         MOVE ZEROS              TO PB-I-LF-ALT-BENEFIT-AMT.
 10860
 10861     IF  BPREM-LEN     (1)  GREATER THAN ZEROS
 10862         IF WS-BPREM   (1)  NOT = WS-ALL-NINES
 10863            ADD  WS-BPREM (1)    TO WS-B-LF-ISS-PRM-ENTERED
 10864            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 10865         ELSE
 10866            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 10867*           MOVE ZEROS           TO PB-I-LF-PREMIUM-AMT
 10868*           MOVE '?'             TO PB-I-LF-CALC-FLAG
 10869         END-IF
 10870     ELSE
 10871         MOVE ZEROS              TO PB-I-LF-PREMIUM-AMT.
 10872
 10873     IF  BCPREM-LEN     (1)  GREATER THAN ZEROS
 10874         MOVE WS-BCPREM (1)      TO PB-I-LF-PREM-CALC.
 10875
 10876     IF  BALT-PREM-LEN     (1)  GREATER THAN ZEROS
 10877         ADD  WS-BALT-PREM (1) TO WS-B-LF-ISS-PRM-ENTERED
 10878         MOVE WS-BALT-PREM (1) TO PB-I-LF-ALT-PREMIUM-AMT
 10879     ELSE
 10880         MOVE ZEROS            TO PB-I-LF-ALT-PREMIUM-AMT.
 10881
 10882     IF  BALT-PREM-LEN     (2) > ZEROS
 10883         MOVE WS-BALT-PREM (2) TO PB-I-TOT-FEES
 10884     ELSE
 10885         MOVE ZEROS            TO PB-I-TOT-FEES.
 10886
 10887     IF BTYPE-LEN     (2)   GREATER THAN ZEROS
 10888        IF BTYPE      (2)   NOT = ZEROS
 10889           MOVE BTYPE (2)      TO PB-I-AH-INPUT-CD
 10890                                  PI-BTYPE (2)
 10891           MOVE ZEROS          TO PB-I-AH-BENEFIT-CD
 10892           MOVE SPACES         TO PB-I-AH-ABBR
 10893        ELSE
 10894           MOVE SPACES         TO PB-I-AH-INPUT-CD
 10895                                  PB-I-AH-ABBR
 10896           MOVE ZEROS          TO PB-I-AH-BENEFIT-CD
 10897     ELSE
 10898        MOVE SPACES            TO PB-I-AH-INPUT-CD
 10899                                  PB-I-AH-ABBR
 10900        MOVE ZEROS             TO PB-I-AH-BENEFIT-CD.
 10901
 10902     IF  BBEN-LEN         (2)  GREATER THAN ZEROS
 10903         MOVE WS-BBEN     (2)  TO PB-I-AH-BENEFIT-AMT
 10904     ELSE
 10905         MOVE ZEROS            TO PB-I-AH-BENEFIT-AMT.
 10906
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 200
* EL6311.cbl
 10907     IF  BPREM-LEN     (2)  GREATER THAN ZEROS
 10908         IF WS-BPREM   (2)  NOT = WS-ALL-NINES
 10909            ADD  WS-BPREM (2)    TO WS-B-AH-ISS-PRM-ENTERED
 10910            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 10911         ELSE
 10912            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 10913*           MOVE ZEROS           TO PB-I-AH-PREMIUM-AMT
 10914*           MOVE '?'             TO PB-I-AH-CALC-FLAG
 10915         END-IF
 10916     ELSE
 10917         MOVE ZEROS              TO PB-I-AH-PREMIUM-AMT.
 10918
 10919     IF  BCPREM-LEN     (2)  GREATER THAN ZEROS
 10920         MOVE WS-BCPREM (2)      TO PB-I-AH-PREM-CALC.
 10921
 10922     IF BCRIT-PERD-LEN      (1)   GREATER THAN ZEROS
 10923        MOVE WS-BCRIT-PERD  (1)   TO PB-I-LF-CRIT-PER
 10924     ELSE
 10925        MOVE ZEROS                TO PB-I-LF-CRIT-PER.
 10926
 10927     IF BCRIT-PERD-LEN      (2)   GREATER THAN ZEROS
 10928        MOVE WS-BCRIT-PERD  (2)   TO PB-I-AH-CRIT-PER
 10929     ELSE
 10930        MOVE ZEROS                TO PB-I-AH-CRIT-PER.
 10931
 10932     IF BINDGRPL  GREATER THAN ZEROS
 10933         MOVE BINDGRPI           TO PB-I-INDV-GRP-OVRD.
 10934
 10935     IF BRTCLSL   GREATER THAN ZEROS
 10936         MOVE BRTCLSI            TO PB-I-RATE-CLASS-OVRD.
 10937
 10938     IF BSIGL     GREATER THAN ZEROS
 10939         MOVE BSIGI              TO PB-I-SIG-SW.
 10940     IF BAPRL > ZEROS
 10941         MOVE WS-BAPR            TO PB-I-LOAN-APR
 10942     ELSE
 10943        if pi-company-id = 'CID'
 10944           move +99.9999         to pb-i-loan-apr
 10945        else
 10946           MOVE ZEROS            TO PB-I-LOAN-APR
 10947        end-if
 10948     end-if
 10949     IF BMEMBERL  GREATER THAN ZEROS
 10950         MOVE BMEMBERI       TO PB-I-MEMBER-NO.
 10951
 10952     IF BLNOFCRL  GREATER THAN ZEROS
 10953         MOVE BLNOFCRI           TO PB-I-LOAN-OFFICER.
 10954
 10955     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 10956        MOVE WS-CONVERTED-EXPIRDT (1) TO PB-I-LF-EXPIRE-DT
 10957     ELSE
 10958        MOVE LOW-VALUES               TO PB-I-LF-EXPIRE-DT.
 10959
 10960     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 10961        MOVE WS-CONVERTED-EXPIRDT (2) TO PB-I-AH-EXPIRE-DT
 10962     ELSE
 10963        MOVE LOW-VALUES               TO PB-I-AH-EXPIRE-DT.
 10964
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 201
* EL6311.cbl
 10965     IF BDAYSL   GREATER THAN ZEROS
 10966        MOVE BDAYSI              TO PB-I-TERM-IN-DAYS
 10967                                    PB-I-EXTENTION-DAYS
 10968     ELSE
 10969        MOVE ZEROS               TO PB-I-TERM-IN-DAYS
 10970                                    PB-I-EXTENTION-DAYS.
 10971
 10972     IF BDAYSL GREATER THAN ZEROS
 10973        MOVE '2'                 TO PB-I-DATA-ENTRY-SW.
 10974
 10975     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 10976        IF WS-CONVERTED-EXPIRDT   (1) GREATER THAN LOW-VALUES
 10977           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 10978
 10979     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 10980        IF WS-CONVERTED-EXPIRDT   (2) GREATER THAN LOW-VALUES
 10981           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 10982
 10983     IF B1STPMTL GREATER THAN ZEROS
 10984        MOVE '4'                 TO PB-I-DATA-ENTRY-SW.
 10985
 10986     IF PB-EXT-DAYS-PROCESSING
 10987        IF PB-I-EXTENTION-DAYS = ZEROS
 10988           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 10989
 10990     IF PB-EXPIRE-DT-PROCESSING
 10991        IF PB-I-LF-EXPIRE-DT = LOW-VALUES AND
 10992           PB-I-AH-EXPIRE-DT = LOW-VALUES
 10993             MOVE '1'            TO PB-I-DATA-ENTRY-SW.
 10994
 10995     IF PB-1ST-PMT-DT-PROCESSING
 10996        IF PB-I-1ST-PMT-DT = LOW-VALUES
 10997           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 10998
 10999     IF BREINL GREATER THAN ZEROS
 11000        MOVE BREINI              TO PB-I-SPECIAL-REIN-CODE.
 11001
 11002     IF BENTRYL NOT = ZEROS
 11003        MOVE BENTRYI             TO PB-BATCH-ENTRY
 11004        IF PI-COMPANY-ID = 'CID'
 11005           AND (PB-BATCH-ENTRY = 'P')
 11006           AND (PB-STATE = 'VA')
 11007           PERFORM 1500-UPDATE-ERNOTE
 11008                                 THRU 1500-EXIT
 11009        END-IF
 11010     END-IF
 11011     IF BUNWRITL NOT = ZEROS
 11012        MOVE BUNWRITI            TO PB-I-UNDERWRITING-STATUS.
 11013
 11014     IF BFORCEL NOT = ZEROS
 11015        MOVE BFORCEI             TO PB-FORCE-CODE.
 11016
 11017     IF BBILCDL NOT = ZEROS
 11018        MOVE BBILCDI             TO PB-RECORD-BILL.
 11019
 11020     IF BLIVESL GREATER THAN ZEROS
 11021        MOVE WS-BLIVES           TO PB-I-LIVES
 11022     ELSE
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 202
* EL6311.cbl
 11023        MOVE ZEROS               TO PB-I-LIVES.
 11024
 11025     IF BBILLEDL GREATER THAN ZEROS
 11026        MOVE WS-BILLED           TO PB-I-NUM-BILLED
 11027     ELSE
 11028        MOVE ZEROS               TO PB-I-NUM-BILLED.
 11029
 11030*    MOVE WS-REFERENCE           TO PB-I-REFERENCE.
 11031
 11032 1260-WRITE-PB-RECORD.
 11033     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY
 11034                                    PB-INPUT-BY.
 11035     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 11036     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT
 11037                                    PB-INPUT-DT.
 11038
 11039     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 11040     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 11041                                    PB-CONTROL-BY-ORIG-BATCH.
 11042
 11043
 11044     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 11045     MOVE WS-BATCH-CSR-ID        TO PB-CSR-ID.
 11046     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 11047     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 11048     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 11049
 11050     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 11051
 11052     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 11053
 11054     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 11055     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 11056     MOVE PB-SV-STATE            TO PI-SV-STATE.
 11057
 11058     ADD PB-I-LF-PREM-CALC       TO WS-B-LF-ISS-PRM-COMPUTED.
 11059     ADD PB-I-AH-PREM-CALC       TO WS-B-AH-ISS-PRM-COMPUTED.
 11060
 11061 1275-WRITE-PENDING-BUSINESS.
 11062     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 11063     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 11064     MOVE 'A'                    TO JP-RECORD-TYPE.
 11065     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11066
 11067
 11068* EXEC CICS HANDLE CONDITION
 11069*        DUPREC (1290-DUPLICATE-ALT-INDEX)
 11070*    END-EXEC.
 11071*    MOVE '"$%                   ! $ #00010852' TO DFHEIV0
 11072     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 11073     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11074     MOVE X'2420233030303130383532' TO DFHEIV0(25:11)
 11075     CALL 'kxdfhei1' USING DFHEIV0
 11076     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11077
 11078
 11079
 11080* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 203
* EL6311.cbl
 11081*        DATASET (FILE-ID-ERPNDB)
 11082*        FROM    (PENDING-BUSINESS)
 11083*        RIDFLD  (PB-CONTROL-PRIMARY)
 11084*    END-EXEC.
 11085     MOVE LENGTH OF
 11086      PENDING-BUSINESS
 11087       TO DFHEIV11
 11088*    MOVE '&$ L                  ''   #00010856' TO DFHEIV0
 11089     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11090     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11091     MOVE X'2020233030303130383536' TO DFHEIV0(25:11)
 11092     CALL 'kxdfhei1' USING DFHEIV0,
 11093           FILE-ID-ERPNDB,
 11094           PENDING-BUSINESS,
 11095           DFHEIV11,
 11096           PB-CONTROL-PRIMARY,
 11097           DFHEIV99,
 11098           DFHEIV99
 11099     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11100
 11101
 11102     ADD +1                      TO  WS-B-ISSUE-CNT-ENTERED.
 11103
 11104     PERFORM 8400-LOG-JOURNAL-RECORD *> New Issue record
 11105
 11106******************************************************************
 11107*       A D D  O R I G I N A L  C E R T  I N F O                 *
 11108******************************************************************
 11109     MOVE ELCERT-KEY             TO ERMAIL-KEY
 11110     MOVE ' '                    TO WS-ERMAIL-SW
 11111
 11112* EXEC CICS READ
 11113*       DATASET   (FILE-ID-ERMAIL)
 11114*       SET       (ADDRESS OF MAILING-DATA)
 11115*       RIDFLD    (ERMAIL-KEY)
 11116*       RESP      (WS-RESPONSE)
 11117*    END-EXEC
 11118*    MOVE '&"S        E          (  N#00010872' TO DFHEIV0
 11119     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11120     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11121     MOVE X'204E233030303130383732' TO DFHEIV0(25:11)
 11122     CALL 'kxdfhei1' USING DFHEIV0,
 11123           FILE-ID-ERMAIL,
 11124           DFHEIV20,
 11125           DFHEIV99,
 11126           ERMAIL-KEY,
 11127           DFHEIV99,
 11128           DFHEIV99,
 11129           DFHEIV99
 11130     SET ADDRESS OF MAILING-DATA TO
 11131         DFHEIV20
 11132     MOVE EIBRESP  TO WS-RESPONSE
 11133     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11134     IF RESP-NORMAL
 11135        SET ERMAIL-FOUND TO TRUE
 11136     END-IF
 11137
 11138     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 204
* EL6311.cbl
 11139     MOVE SPACES                 TO ORIGINAL-CERTIFICATE
 11140     MOVE 'OC'                   TO OC-RECORD-ID
 11141     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 11142                                 TO OC-CONTROL-PRIMARY (1:33)
 11143     MOVE 'I'                    TO OC-RECORD-TYPE
 11144     MOVE +4096                  TO OC-KEY-SEQ-NO
 11145     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
 11146     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
 11147     MOVE WS-CURRENT-BIN-DT      TO OC-LAST-MAINT-DT
 11148     MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 11149     MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 11150     MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 11151     MOVE PB-I-AGE               TO OC-INS-AGE
 11152     MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 11153     MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 11154     MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 11155     MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 11156     MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 11157     MOVE PB-I-LF-TERM           TO OC-LF-TERM
 11158     MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 11159     MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 11160     MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 11161     MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 11162     MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 11163     IF PB-I-JOINT-COMMISSION > +0
 11164         MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 11165     ELSE
 11166         MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 11167     END-IF
 11168     MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
 11169     MOVE +0                     TO OC-LF-CANCEL-AMT
 11170                                    OC-LF-ITD-CANCEL-AMT
 11171     MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 11172     MOVE PB-I-AH-TERM           TO OC-AH-TERM
 11173     MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 11174     MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 11175     MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 11176     MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 11177     MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 11178     MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
 11179     MOVE +0                     TO OC-AH-CANCEL-AMT
 11180                                    OC-AH-ITD-CANCEL-AMT
 11181     MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 11182     MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 11183     MOVE 'N'                    TO OC-CANCEL-TRAN-IND
 11184     IF ERMAIL-FOUND
 11185        MOVE MA-CRED-BENE-NAME   TO OC-CRED-BENE-NAME
 11186     END-IF
 11187     IF NOT CERT-TRL-REC-NOT-FOUND
 11188        MOVE CS-INS-AGE-DEFAULT-FLAG TO
 11189                           OC-INS-AGE-DEFAULT-FLAG
 11190        MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 11191                           OC-JNT-AGE-DEFAULT-FLAG
 11192     END-IF
 11193     MOVE LOW-VALUES             TO OC-ENDORSEMENT-PROCESSED-DT
 11194     .
 11195 1275-WRITE-ELCRTO.
 11196
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 205
* EL6311.cbl
 11197* EXEC CICS WRITE
 11198*       DATASET   ('ELCRTO')
 11199*       FROM      (ORIGINAL-CERTIFICATE)
 11200*       RIDFLD    (OC-CONTROL-PRIMARY)
 11201*       RESP      (WS-RESPONSE)
 11202*    END-EXEC
 11203     MOVE LENGTH OF
 11204      ORIGINAL-CERTIFICATE
 11205       TO DFHEIV11
 11206     MOVE 'ELCRTO' TO DFHEIV1
 11207*    MOVE '&$ L                  ''  N#00010940' TO DFHEIV0
 11208     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11209     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11210     MOVE X'204E233030303130393430' TO DFHEIV0(25:11)
 11211     CALL 'kxdfhei1' USING DFHEIV0,
 11212           DFHEIV1,
 11213           ORIGINAL-CERTIFICATE,
 11214           DFHEIV11,
 11215           OC-CONTROL-PRIMARY,
 11216           DFHEIV99,
 11217           DFHEIV99
 11218     MOVE EIBRESP  TO WS-RESPONSE
 11219     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11220*    display ' just wrote 1275 ' ws-response
 11221     IF RESP-DUPKEY
 11222        SUBTRACT +1              FROM OC-KEY-SEQ-NO
 11223        GO TO 1275-WRITE-ELCRTO
 11224     ELSE
 11225        IF NOT RESP-NORMAL
 11226           MOVE -1               TO BMAINTL
 11227           MOVE ER-7450          TO EMI-ERROR
 11228           PERFORM 9900-ERROR-FORMAT
 11229                                 THRU 9900-EXIT
 11230           GO TO 8200-SEND-DATAONLY
 11231        END-IF
 11232     END-IF
 11233******************************************************************
 11234*       U P D A T E   T H E   B A T C H   H E A D E R            *
 11235******************************************************************
 11236
 11237
 11238* EXEC CICS READ
 11239*        INTO    (PENDING-BUSINESS)
 11240*        DATASET (FILE-ID-ERPNDB)
 11241*        RIDFLD  (ERPNDB-KEY)
 11242*        UPDATE
 11243*    END-EXEC.
 11244     MOVE LENGTH OF
 11245      PENDING-BUSINESS
 11246       TO DFHEIV11
 11247*    MOVE '&"IL       EU         (   #00010963' TO DFHEIV0
 11248     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11249     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11250     MOVE X'2020233030303130393633' TO DFHEIV0(25:11)
 11251     CALL 'kxdfhei1' USING DFHEIV0,
 11252           FILE-ID-ERPNDB,
 11253           PENDING-BUSINESS,
 11254           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 206
* EL6311.cbl
 11255           ERPNDB-KEY,
 11256           DFHEIV99,
 11257           DFHEIV99,
 11258           DFHEIV99
 11259     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11260
 11261
 11262     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 11263     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 11264     MOVE 'B'                    TO JP-RECORD-TYPE.
 11265     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11266
 11267     PERFORM 8400-LOG-JOURNAL-RECORD  *> Before BHDR Image
 11268
 11269     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 11270
 11271
 11272* EXEC CICS REWRITE
 11273*        DATASET (FILE-ID-ERPNDB)
 11274*        FROM    (PENDING-BUSINESS)
 11275*    END-EXEC.
 11276     MOVE LENGTH OF
 11277      PENDING-BUSINESS
 11278       TO DFHEIV11
 11279*    MOVE '&& L                  %   #00010979' TO DFHEIV0
 11280     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11281     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11282     MOVE X'2020233030303130393739' TO DFHEIV0(25:11)
 11283     CALL 'kxdfhei1' USING DFHEIV0,
 11284           FILE-ID-ERPNDB,
 11285           PENDING-BUSINESS,
 11286           DFHEIV11,
 11287           DFHEIV99
 11288     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11289
 11290
 11291     MOVE 'C'                    TO JP-RECORD-TYPE.
 11292     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11293
 11294     PERFORM 8400-LOG-JOURNAL-RECORD  *> After BHDR Image
 11295
 11296     IF WS-ERRORS-PRESENT
 11297         GO TO 3900-RE-DISPLAY-RECORD.
 11298
 11299     MOVE ZEROS                  TO EMI-ERROR.
 11300     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11301     MOVE LOW-VALUES             TO EL631BI.
 11302     MOVE  -1                    TO BMAINTL.
 11303     GO TO 8100-SEND-INITIAL-MAP.
 11304
 11305 1280-BATCH-HDR-NOT-FOUND.
 11306     MOVE -1                     TO BMAINTL.
 11307     MOVE ER-7450                TO EMI-ERROR.
 11308     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11309     GO TO 8200-SEND-DATAONLY.
 11310
 11311 1290-DUPLICATE-ALT-INDEX.
 11312
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 207
* EL6311.cbl
 11313******************************************************************
 11314*                                                                *
 11315*      IF THE PB-B-HIGHEST-SEQ-NO WAS NOT UPDATED IN THE DATA    *
 11316*         ENTRY SESSION, ADD +1 TO THE HIGHEST SEQUENCE NUMBER   *
 11317*         AND ATTEMPT TO WRITE THE RECORD AGAIN. REPEAT THIS     *
 11318*         50 TIMES.  IF DUPREC CONDITION IS STILL ENCOUNTERED    *
 11319*         AFTER 50 TIMES, ASSUME THE DUPLICATE RECORD WAS        *
 11320*         CAUSED BY A DUPLICATE ALTERNATE KEY.                   *
 11321*                                                                *
 11322******************************************************************
 11323
 11324     IF LCP-ONCTR-01 =  0
 11325         ADD 1 TO LCP-ONCTR-01
 11326        MOVE +0                  TO WS-SEQ-NO-COUNTER.
 11327
 11328     ADD +1                      TO WS-SEQ-NO-COUNTER.
 11329
 11330     IF  WS-SEQ-NO-COUNTER GREATER THAN +50
 11331         NEXT SENTENCE
 11332     ELSE
 11333         ADD +1 TO PB-BATCH-SEQ-NO
 11334                   PB-CSR-BATCH-SEQ-NO
 11335         MOVE PB-BATCH-SEQ-NO TO WS-B-HIGHEST-SEQ-NO
 11336         GO TO 1275-WRITE-PENDING-BUSINESS.
 11337
 11338     MOVE -1                     TO BCERTNOL.
 11339     MOVE AL-UABON               TO BCERTNOA.
 11340     MOVE AL-UNBON               TO BEFFDTA.
 11341
 11342     MOVE 1                      TO EMI-SUB
 11343                                    EMI-SWITCH1
 11344                                    EMI-SWITCH-AREA-1
 11345                                    EMI-SWITCH-AREA-2.
 11346
 11347     MOVE SPACES                 TO EMI-ERROR-LINES.
 11348
 11349
 11350* EXEC CICS SYNCPOINT ROLLBACK
 11351*    END-EXEC.
 11352*    MOVE '6"R                   !   #00011042' TO DFHEIV0
 11353     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 11354     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11355     MOVE X'2020233030303131303432' TO DFHEIV0(25:11)
 11356     CALL 'kxdfhei1' USING DFHEIV0
 11357     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11358
 11359
 11360     MOVE ER-2247                TO EMI-ERROR.
 11361     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11362     GO TO 8200-SEND-DATAONLY.
 11363
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 208
* EL6311.cbl
 11365
 11366
 11367 1295-READ-CERT-TRAILER.
 11368
 11369
 11370* EXEC CICS GETMAIN
 11371*        SET     (ADDRESS OF CERTIFICATE-TRAILERS)
 11372*        LENGTH  (ELCRTT-RECORD-LENGTH)
 11373*        INITIMG (GETMAIN-SPACE)
 11374*    END-EXEC
 11375*    MOVE ',"IL                  $   #00011054' TO DFHEIV0
 11376     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11377     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11378     MOVE X'2020233030303131303534' TO DFHEIV0(25:11)
 11379     CALL 'kxdfhei1' USING DFHEIV0,
 11380           DFHEIV20,
 11381           ELCRTT-RECORD-LENGTH,
 11382           GETMAIN-SPACE
 11383     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 11384         DFHEIV20
 11385     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11386
 11387     MOVE +0                     TO  WS-CERT-TRL-REC-NOT-FOUND.
 11388     MOVE ELCERT-KEY             TO  ELCRTT-PRIMARY.
 11389     MOVE 'C'                    TO  ELCRTT-REC-TYPE.
 11390
 11391
 11392* EXEC CICS HANDLE CONDITION
 11393*        NOTFND (1295-CERT-TRL-REC-NOTFND)
 11394*    END-EXEC.
 11395*    MOVE '"$I                   ! % #00011064' TO DFHEIV0
 11396     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11397     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11398     MOVE X'2520233030303131303634' TO DFHEIV0(25:11)
 11399     CALL 'kxdfhei1' USING DFHEIV0
 11400     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11401
 11402
 11403
 11404* EXEC CICS READ
 11405*        DATASET  (CRTT-ID)
 11406*        RIDFLD   (ELCRTT-KEY)
 11407*        INTO     (CERTIFICATE-TRAILERS)
 11408*    END-EXEC.
 11409     MOVE LENGTH OF
 11410      CERTIFICATE-TRAILERS
 11411       TO DFHEIV11
 11412*    MOVE '&"IL       E          (   #00011068' TO DFHEIV0
 11413     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11414     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11415     MOVE X'2020233030303131303638' TO DFHEIV0(25:11)
 11416     CALL 'kxdfhei1' USING DFHEIV0,
 11417           CRTT-ID,
 11418           CERTIFICATE-TRAILERS,
 11419           DFHEIV11,
 11420           ELCRTT-KEY,
 11421           DFHEIV99,
 11422           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 209
* EL6311.cbl
 11423           DFHEIV99
 11424     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11425
 11426
 11427     GO TO 1295-EXIT.
 11428
 11429 1295-CERT-TRL-REC-NOTFND.
 11430     MOVE +1                     TO WS-CERT-TRL-REC-NOT-FOUND.
 11431
 11432 1295-EXIT.
 11433     EXIT.
 11434
 11435******************************************************************
 11436*                                                                *
 11437*          C H A N G E   I S S U E   R O U T I N E               *
 11438*                                                                *
 11439******************************************************************
 11440
 11441***************************************************************
 11442*                                                             *
 11443*     1. GETMAIN FOR PENDING BUSINESS RECORD.                 *
 11444*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
 11445*     3. GET THE RECORD TO BE UPDATED AND SEE IF IT HAS BEEN  *
 11446*              BILLED.  IF IT HAS THEN SAVE A -COPY- OF THE   *
 11447*              ZERO RECORD FOR CREATING REVERSAL ENTRIES.     *
 11448*     4. UPDATE THE RECORD WITH THE SCREEN DATA               *
 11449*     5. LINK TO THE EDIT ROUTINE.                            *
 11450*     6. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
 11451*     7. REDISPLAY SCREEN DATA WITH NEW DATA RETURNED FROM    *
 11452*              THE EDIT ROUTINE.                              *
 11453*     7. REWRITE THE NEW ISSUE                                *
 11454*     8. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
 11455*                                                             *
 11456***************************************************************
 11457
 11458 1300-CHANGE-ISSUE-ROUTINE.
 11459     MOVE 'C'                    TO PI-MAINT-FUNCTION.
 11460
 11461     IF BCHGL NOT = ZEROS
 11462        MOVE ER-2196             TO EMI-ERROR
 11463        MOVE AL-UABON            TO BMAINTA
 11464        MOVE -1                  TO BMAINTL
 11465        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11466        GO TO 8200-SEND-DATAONLY.
 11467
 11468     MOVE BCERTNOI               TO WS-NEW-PRIME.
 11469
 11470     IF BSUFIXL NOT = ZEROS
 11471        MOVE BSUFIXI             TO WS-NEW-SUFFIX
 11472     ELSE
 11473        MOVE SPACE               TO WS-NEW-SUFFIX.
 11474
 11475     MOVE BEFFDTI                TO DEEDIT-FIELD.
 11476     PERFORM 8600-DEEDIT.
 11477     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 11478     MOVE '4'                    TO DC-OPTION-CODE.
 11479     PERFORM 9700-DATE-LINK.
 11480     IF DATE-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 210
* EL6311.cbl
 11481        MOVE ER-0348             TO EMI-ERROR
 11482        MOVE -1                  TO BEFFDTL
 11483        MOVE AL-UABON            TO BEFFDTA
 11484        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11485        GO TO 8200-SEND-DATAONLY
 11486     ELSE
 11487        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
 11488        MOVE AL-UANON            TO BEFFDTA
 11489        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 11490
 11491 1325-PROCESS-ISSUE-CHANGES.
 11492
 11493* EXEC CICS HANDLE CONDITION
 11494*         NOTFND    (1380-BATCH-HDR-NOT-FOUND)
 11495*    END-EXEC.
 11496*    MOVE '"$I                   ! & #00011139' TO DFHEIV0
 11497     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11498     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11499     MOVE X'2620233030303131313339' TO DFHEIV0(25:11)
 11500     CALL 'kxdfhei1' USING DFHEIV0
 11501     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11502
 11503
 11504     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 11505     MOVE +9999                   TO ERPNDB-BATCH-SEQ-NO.
 11506     MOVE ZEROS                   TO ERPNDB-BATCH-CHG-SEQ-NO.
 11507
 11508
 11509* EXEC CICS GETMAIN
 11510*        SET      (ADDRESS OF PENDING-BUSINESS)
 11511*        LENGTH   (ERPNDB-RECORD-LENGTH)
 11512*        INITIMG  (GETMAIN-SPACE)
 11513*     END-EXEC.
 11514*    MOVE ',"IL                  $   #00011147' TO DFHEIV0
 11515     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11516     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11517     MOVE X'2020233030303131313437' TO DFHEIV0(25:11)
 11518     CALL 'kxdfhei1' USING DFHEIV0,
 11519           DFHEIV20,
 11520           ERPNDB-RECORD-LENGTH,
 11521           GETMAIN-SPACE
 11522     SET ADDRESS OF PENDING-BUSINESS TO
 11523         DFHEIV20
 11524     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11525
 11526
 11527
 11528* EXEC CICS READ
 11529*        INTO    (PENDING-BUSINESS)
 11530*        DATASET (FILE-ID-ERPNDB)
 11531*        RIDFLD  (ERPNDB-KEY)
 11532*    END-EXEC.
 11533     MOVE LENGTH OF
 11534      PENDING-BUSINESS
 11535       TO DFHEIV11
 11536*    MOVE '&"IL       E          (   #00011153' TO DFHEIV0
 11537     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11538     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 211
* EL6311.cbl
 11539     MOVE X'2020233030303131313533' TO DFHEIV0(25:11)
 11540     CALL 'kxdfhei1' USING DFHEIV0,
 11541           FILE-ID-ERPNDB,
 11542           PENDING-BUSINESS,
 11543           DFHEIV11,
 11544           ERPNDB-KEY,
 11545           DFHEIV99,
 11546           DFHEIV99,
 11547           DFHEIV99
 11548     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11549
 11550
 11551     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 11552
 11553
 11554* EXEC CICS HANDLE CONDITION
 11555*         NOTFND     (1385-REC-NOT-FOUND)
 11556*    END-EXEC.
 11557*    MOVE '"$I                   ! '' #00011161' TO DFHEIV0
 11558     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11559     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11560     MOVE X'2720233030303131313631' TO DFHEIV0(25:11)
 11561     CALL 'kxdfhei1' USING DFHEIV0
 11562     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11563
 11564
 11565**********************************************************
 11566*      DONT READ THE RECORD FOR UPDATE UNTIL             *
 11567*      AFTER THE CHANGE RECORD HAS BEEN CREATED.         *
 11568**********************************************************
 11569
 11570
 11571* EXEC CICS READ
 11572*        DATASET (FILE-ID-ERPNDB)
 11573*        INTO    (PENDING-BUSINESS)
 11574*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 11575*    END-EXEC.
 11576     MOVE LENGTH OF
 11577      PENDING-BUSINESS
 11578       TO DFHEIV11
 11579*    MOVE '&"IL       E          (   #00011170' TO DFHEIV0
 11580     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11581     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11582     MOVE X'2020233030303131313730' TO DFHEIV0(25:11)
 11583     CALL 'kxdfhei1' USING DFHEIV0,
 11584           FILE-ID-ERPNDB,
 11585           PENDING-BUSINESS,
 11586           DFHEIV11,
 11587           PI-PREV-CONTROL-PRIMARY,
 11588           DFHEIV99,
 11589           DFHEIV99,
 11590           DFHEIV99
 11591     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11592
 11593
 11594********** DO NOT ALLOW CHANGES IF THRU A/R
 11595     IF BMAINTI = 'C'
 11596         IF PB-EL860-INTERNAL-PROCESS
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 212
* EL6311.cbl
 11597             MOVE ER-4005          TO EMI-ERROR
 11598             MOVE -1               TO BMAINTL
 11599             MOVE AL-UABON         TO BMAINTA
 11600             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11601             GO TO 8200-SEND-DATAONLY.
 11602**********
 11603     MOVE PB-ISSUE-RECORD TO WS-SAVE-PEND-ISSUE
 11604
 11605     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 11606        MOVE -1                 TO BMAINTL
 11607        MOVE ER-2197            TO EMI-ERROR
 11608        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11609        GO TO 8200-SEND-DATAONLY.
 11610
 11611     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 11612        MOVE ER-2196             TO EMI-ERROR
 11613        MOVE AL-UABON            TO BMAINTA
 11614        MOVE -1                  TO BMAINTL
 11615        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11616        GO TO 8200-SEND-DATAONLY.
 11617
 11618     MOVE ZEROS                  TO WS-SEQ-SAVE.
 11619
 11620     IF PB-BILLED-DT = LOW-VALUES AND
 11621        PB-CHG-COUNT = ZEROS
 11622        NEXT SENTENCE
 11623     ELSE
 11624        IF (BPREM-LEN (1) GREATER THAN ZEROS AND
 11625            WS-BPREM  (1) NOT = PB-I-LF-PREMIUM-AMT)
 11626           OR
 11627           (BPREM-LEN (2) GREATER THAN ZEROS AND
 11628            WS-BPREM  (2) NOT = PB-I-AH-PREMIUM-AMT)
 11629           PERFORM 2700-BUILD-CORRECTION-RECORD THRU 2799-EXIT.
 11630     move zeros                  to ws-check-amts
 11631     move ' '                    to ws-stop-sw
 11632                                    ws-check-sw
 11633                                    ws-proc-check-sw
 11634                                    ws-any-check-sw
 11635                                    ws-chek-browse-sw
 11636
 11637     perform 2500-browse-checks  thru 2500-exit
 11638
 11639     if i-have-processed-checks
 11640        or i-have-checks
 11641        continue
 11642     else
 11643        go to 1330-continue
 11644     end-if
 11645
 11646     compute ws-tot-orig-prem =
 11647        pb-i-lf-premium-amt + pb-i-ah-premium-amt +
 11648        pb-i-lf-alt-premium-amt
 11649
 11650     if bprem1l <> zeros
 11651        MOVE AL-UNNON            TO bprem1a
 11652        move ws-bprem (1)        to ws-new-iss-total
 11653     else
 11654        move pb-i-lf-premium-amt to ws-new-iss-total
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 213
* EL6311.cbl
 11655     end-if
 11656     display ' new iss totala ' ws-new-iss-total
 11657
 11658     if baltpr1l <> zeros
 11659        MOVE AL-UNNON            TO baltpr1a
 11660        compute ws-new-iss-total =
 11661           ws-new-iss-total + ws-balt-prem(1)
 11662     else
 11663        compute ws-new-iss-total =
 11664           ws-new-iss-total + pb-i-lf-alt-premium-amt
 11665     end-if
 11666
 11667     if bprem2l <> zeros
 11668        MOVE AL-UNNON            TO bprem2a
 11669        compute ws-new-iss-total = ws-new-iss-total +
 11670           ws-bprem (2)
 11671     else
 11672        compute ws-new-iss-total = ws-new-iss-total +
 11673           pb-i-ah-premium-amt
 11674     end-if
 11675
 11676     if (ws-new-iss-total + ws-check-amts) = ws-tot-orig-prem
 11677        if ((bprem1l <> zeros)
 11678           and (ws-bprem (1) <> pb-i-lf-premium-amt))
 11679                      or
 11680           ((bprem2l <> zeros)
 11681           and (ws-bprem (2) <> pb-i-ah-premium-amt))
 11682           move er-3456          to emi-error
 11683           perform 9900-error-format
 11684                                 thru 9900-exit
 11685           go to 1330-continue
 11686        end-if
 11687     end-if
 11688
 11689     if ws-new-iss-total > ws-tot-orig-prem
 11690        move er-3458             to emi-error
 11691        perform 9900-error-format thru 9900-exit
 11692        move al-uabon            to bmainta
 11693        move -1                  to bmaintl
 11694        go to 8200-send-dataonly
 11695     end-if
 11696
 11697     if ws-new-iss-total < ws-tot-orig-prem
 11698        move er-3457             to emi-error
 11699        move al-uabon            to bprem1a
 11700                                    bprem2a
 11701        move +0 to bprem1l bprem2l
 11702        perform 9900-error-format thru 9900-exit
 11703        move -1                  to bmaintl
 11704        go to 1330-continue
 11705     end-if
 11706
 11707     .
 11708 1330-continue.
 11709
 11710
 11711* EXEC CICS READ
 11712*        DATASET (FILE-ID-ERPNDB)
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 214
* EL6311.cbl
 11713*        INTO    (PENDING-BUSINESS)
 11714*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 11715*        UPDATE
 11716*    END-EXEC.
 11717     MOVE LENGTH OF
 11718      PENDING-BUSINESS
 11719       TO DFHEIV11
 11720*    MOVE '&"IL       EU         (   #00011292' TO DFHEIV0
 11721     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11722     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11723     MOVE X'2020233030303131323932' TO DFHEIV0(25:11)
 11724     CALL 'kxdfhei1' USING DFHEIV0,
 11725           FILE-ID-ERPNDB,
 11726           PENDING-BUSINESS,
 11727           DFHEIV11,
 11728           PI-PREV-CONTROL-PRIMARY,
 11729           DFHEIV99,
 11730           DFHEIV99,
 11731           DFHEIV99
 11732     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11733
 11734
 11735     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 11736     MOVE 'B'                    TO JP-RECORD-TYPE
 11737     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11738     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 11739
 11740*    PERFORM 8400-LOG-JOURNAL-RECORD. *> move closer to rewite
 11741
 11742     IF PB-BILLED-DT NOT = LOW-VALUES OR
 11743        PB-CHG-COUNT NOT = ZEROS
 11744        IF (BPREM-LEN (1) GREATER THAN ZEROS AND
 11745            WS-BPREM  (1) NOT = PB-I-LF-PREMIUM-AMT)
 11746           OR
 11747           (BPREM-LEN (2) GREATER THAN ZEROS AND
 11748            WS-BPREM  (2) NOT = PB-I-AH-PREMIUM-AMT)
 11749            MOVE LOW-VALUES             TO PB-BILLED-DT
 11750            ADD +1                      TO PB-CHG-COUNT.
 11751
 11752     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 11753     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 11754     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 11755     MOVE '5'                    TO DC-OPTION-CODE.
 11756     PERFORM 9700-DATE-LINK
 11757     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 11758
 11759*    IF BMICRNOL  GREATER  ZEROS
 11760*        MOVE BMICRNOI           TO  PB-I-MICROFILM-NO.
 11761
 11762     IF BVINL > ZEROS
 11763        MOVE BVINI               TO PB-I-VIN
 11764     END-IF
 11765     IF (BFORCEL NOT = ZEROS)
 11766        AND (PB-COMPANY-ID = 'DCC' or 'VPP')
 11767        AND (BFORCEI = ' ')
 11768        AND (PB-FORCE-CODE = 'O')
 11769        COMPUTE PB-I-AH-PREMIUM-AMT =
 11770           PB-I-DCC-OVER-CHG-AMT + PB-I-AH-PREM-CALC
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 215
* EL6311.cbl
 11771        PERFORM 1800-REMOVE-CERT-NOTES
 11772                                 THRU 1800-EXIT
 11773        PERFORM 1900-DELETE-ERPYAJ
 11774                                 THRU 1900-EXIT
 11775        MOVE +0                  TO PB-I-DCC-OVER-CHG-AMT
 11776     END-IF
 11777     IF (BFORCEL NOT = ZEROS)
 11778        AND (PB-COMPANY-ID = 'DCC' or 'VPP')
 11779        AND (BFORCEI = 'O')
 11780        AND (PB-FORCE-CODE NOT = 'O')
 11781        COMPUTE WS-OC-AMT = PB-I-AH-PREMIUM-AMT -
 11782           PB-I-AH-PREM-CALC
 11783        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1
 11784        MOVE SPACE               TO DC-OPTION-CODE
 11785        PERFORM 9700-DATE-LINK
 11786        MOVE DC-GREG-DATE-A-EDIT TO WS-OC-DATE
 11787        MOVE WS-OC-AMT           TO PB-I-DCC-OVER-CHG-AMT
 11788        MOVE PB-I-AH-PREM-CALC   TO PB-I-AH-PREMIUM-AMT
 11789        MOVE WS-OC-AMT           TO WS-OC-DIS-AMT
 11790        PERFORM 1500-UPDATE-ERNOTE
 11791                                 THRU 1500-EXIT
 11792        PERFORM 1600-UPDATE-ERPYAJ
 11793                                 THRU 1600-EXIT
 11794     END-IF
 11795     IF BLSTNML  GREATER THAN ZEROS
 11796         MOVE BLSTNMI            TO PB-I-INSURED-LAST-NAME.
 11797
 11798     IF B1STNML  GREATER THAN ZEROS
 11799         MOVE B1STNMI            TO PB-I-INSURED-FIRST-NAME.
 11800
 11801     IF BINITL   GREATER THAN ZEROS
 11802         MOVE BINITI             TO PB-I-INSURED-MIDDLE-INIT.
 11803
 11804     IF BBIRTHL  GREATER THAN ZERO
 11805         MOVE WS-CONVERTED-BIRTH TO PB-I-BIRTHDAY.
 11806
 11807     IF B1STPMTL GREATER THAN ZERO
 11808         MOVE WS-CONVERTED-1ST-PMT-DT TO PB-I-1ST-PMT-DT.
 11809
 11810     IF BAGEL    GREATER THAN ZEROS
 11811         MOVE BAGEI              TO PB-I-AGE.
 11812
 11813     MOVE 'N'                    TO WS-INS-AGE-SET
 11814                                    WS-JNT-AGE-SET.
 11815     IF BAGEL    GREATER THAN ZEROS
 11816        MOVE 'Y'                TO WS-INS-AGE-SET
 11817        IF BAGEI = ZERO AND
 11818             (PB-I-BIRTHDAY = LOW-VALUES OR SPACES)
 11819           MOVE 'Y'             TO WS-INS-AGE-DEFAULTED
 11820           MOVE 'AGE*'          TO BAGEDEFO
 11821        ELSE
 11822           MOVE 'N'             TO WS-INS-AGE-DEFAULTED
 11823           MOVE 'AGE '          TO BAGEDEFO
 11824        END-IF
 11825        PERFORM 1386-UPDATE-AGE-FLAGS THRU 1386-EXIT
 11826     END-IF.
 11827
 11828     IF BSEXL    GREATER THAN ZEROS
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 216
* EL6311.cbl
 11829         MOVE BSEXI              TO PB-I-INSURED-SEX.
 11830
 11831     IF LETRREQL   GREATER THAN ZEROS
 11832        MOVE LETRREQI TO PB-I-LETTER-REQD
 11833     END-IF.
 11834
 11835     IF BTERM-LEN (1)   GREATER THAN ZEROS
 11836        MOVE WS-BTERM (1)        TO PB-I-LF-TERM.
 11837
 11838     IF BTERM-LEN (2)   GREATER THAN ZEROS
 11839        MOVE WS-BTERM (2)        TO PB-I-AH-TERM.
 11840
 11841     IF BLNTRML  GREATER THAN ZEROS
 11842         MOVE BLNTRMI            TO PB-I-LOAN-TERM.
 11843
 11844     IF BFREQL   GREATER THAN ZEROS
 11845         MOVE BFREQI             TO PB-I-PAY-FREQUENCY.
 11846
 11847     IF BSKPCDL  GREATER THAN ZEROS
 11848         MOVE BSKPCDI            TO PB-I-SKIP-CODE.
 11849
 11850     IF BMODEL   GREATER THAN ZEROS
 11851         MOVE BMODEI             TO PB-I-TERM-TYPE
 11852                                    PI-BMODE.
 11853
 11854     IF BPMTSL   GREATER THAN ZEROS
 11855         MOVE BPMTSI             TO PB-I-NO-OF-PAYMENTS
 11856                                    PI-BPMTS.
 11857
 11858     IF BPMTAMTL GREATER THAN ZEROS
 11859         MOVE PI-BPMTAMT         TO PB-I-PAYMENT-AMOUNT.
 11860
 11861     IF  BBEN-LEN      (1)  GREATER THAN ZEROS
 11862         MOVE WS-BBEN  (1)       TO PB-I-LF-BENEFIT-AMT.
 11863
 11864     IF  BALT-BEN-LEN     (1)  GREATER THAN ZEROS
 11865         MOVE WS-BALT-BEN (1)    TO PB-I-LF-ALT-BENEFIT-AMT.
 11866
 11867     MOVE SPACE TO PB-I-LF-CALC-FLAG.
 11868
 11869     IF  BPREM-LEN     (1)  GREATER THAN ZEROS
 11870         IF WS-BPREM   (1)  NOT = WS-ALL-NINES
 11871            SUBTRACT PB-I-LF-PREMIUM-AMT
 11872                     FROM WS-B-LF-ISS-PRM-ENTERED
 11873            ADD  WS-BPREM (1)    TO WS-B-LF-ISS-PRM-ENTERED
 11874            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 11875            MOVE SPACE           TO PB-I-LF-CALC-FLAG
 11876         ELSE
 11877            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 11878*           MOVE ZEROS           TO PB-I-LF-PREMIUM-AMT
 11879*           MOVE '?'             TO PB-I-LF-CALC-FLAG.
 11880         END-IF
 11881     END-IF.
 11882
 11883     IF  BALT-PREM-LEN     (1)  GREATER THAN ZEROS
 11884            SUBTRACT PB-I-LF-ALT-PREMIUM-AMT
 11885                     FROM WS-B-LF-ISS-PRM-ENTERED
 11886         ADD  WS-BALT-PREM (1) TO WS-B-LF-ISS-PRM-ENTERED
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 217
* EL6311.cbl
 11887         MOVE WS-BALT-PREM (1) TO PB-I-LF-ALT-PREMIUM-AMT.
 11888
 11889     IF  BALT-PREM-LEN     (2)  > ZEROS
 11890         MOVE WS-BALT-PREM (2) TO PB-I-TOT-FEES.
 11891
 11892     IF  BBEN-LEN (2)  GREATER THAN ZEROS
 11893         MOVE WS-BBEN (2)  TO PB-I-AH-BENEFIT-AMT.
 11894
 11895     IF  BPREM-LEN     (2)  GREATER THAN ZEROS
 11896         IF WS-BPREM   (2)  NOT = WS-ALL-NINES
 11897            SUBTRACT PB-I-AH-PREMIUM-AMT
 11898                     FROM WS-B-AH-ISS-PRM-ENTERED
 11899            ADD  WS-BPREM (2)    TO WS-B-AH-ISS-PRM-ENTERED
 11900            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 11901            MOVE SPACE           TO PB-I-AH-CALC-FLAG
 11902         ELSE
 11903            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 11904*           MOVE ZEROS           TO PB-I-AH-PREMIUM-AMT
 11905*           MOVE '?'             TO PB-I-AH-CALC-FLAG.
 11906         END-IF
 11907     END-IF
 11908
 11909     IF BCRIT-PERD-LEN      (1)   GREATER THAN ZEROS
 11910        MOVE WS-BCRIT-PERD  (1)   TO PB-I-LF-CRIT-PER.
 11911
 11912     IF BCRIT-PERD-LEN      (2)   GREATER THAN ZEROS
 11913        MOVE WS-BCRIT-PERD  (2)   TO PB-I-AH-CRIT-PER.
 11914
 11915     IF BINDGRPL            GREATER THAN ZEROS
 11916         MOVE BINDGRPI           TO PB-I-INDV-GRP-OVRD.
 11917
 11918     IF BRTCLSL             GREATER THAN ZEROS
 11919         MOVE BRTCLSI            TO PB-I-RATE-CLASS-OVRD.
 11920
 11921     IF BSIGL               GREATER THAN ZEROS
 11922         MOVE BSIGI              TO PB-I-SIG-SW.
 11923
 11924     IF BAPRL               GREATER THAN ZEROS
 11925         MOVE WS-BAPR            TO PB-I-LOAN-APR.
 11926
 11927     IF BMEMBERL            GREATER THAN ZEROS
 11928         MOVE BMEMBERI       TO PB-I-MEMBER-NO.
 11929
 11930     IF BLNOFCRL            GREATER THAN ZEROS
 11931         MOVE BLNOFCRI           TO PB-I-LOAN-OFFICER.
 11932
 11933     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 11934        MOVE WS-CONVERTED-EXPIRDT (1) TO PB-I-LF-EXPIRE-DT.
 11935
 11936     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 11937        MOVE WS-CONVERTED-EXPIRDT (2) TO PB-I-AH-EXPIRE-DT.
 11938
 11939     IF BDAYSL              GREATER THAN ZEROS
 11940        MOVE BDAYSI              TO PB-I-TERM-IN-DAYS
 11941                                    PB-I-EXTENTION-DAYS.
 11942
 11943     IF BDAYSL GREATER THAN ZEROS
 11944        MOVE '2'                 TO PB-I-DATA-ENTRY-SW.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 218
* EL6311.cbl
 11945
 11946     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 11947        IF WS-CONVERTED-EXPIRDT   (1) GREATER THAN LOW-VALUES
 11948           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 11949
 11950     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 11951        IF WS-CONVERTED-EXPIRDT   (2) GREATER THAN LOW-VALUES
 11952           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 11953
 11954     IF B1STPMTL GREATER THAN ZEROS
 11955        MOVE '4'                 TO PB-I-DATA-ENTRY-SW.
 11956
 11957     IF PB-EXT-DAYS-PROCESSING
 11958        IF PB-I-EXTENTION-DAYS = ZEROS
 11959           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 11960
 11961     IF PB-EXPIRE-DT-PROCESSING
 11962        IF PB-I-LF-EXPIRE-DT = LOW-VALUES AND
 11963           PB-I-AH-EXPIRE-DT = LOW-VALUES
 11964             MOVE '1'            TO PB-I-DATA-ENTRY-SW.
 11965
 11966     IF PB-1ST-PMT-DT-PROCESSING
 11967        IF PB-I-1ST-PMT-DT = LOW-VALUES
 11968           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 11969
 11970     IF BREINL GREATER THAN ZEROS
 11971        MOVE BREINI              TO PB-I-SPECIAL-REIN-CODE.
 11972
 11973     IF BFORCEL NOT = ZEROS
 11974        MOVE BFORCEI             TO PB-FORCE-CODE.
 11975     IF (BENTRYL NOT = ZEROS)
 11976        AND (PB-COMPANY-ID = 'CID')
 11977        AND (PB-STATE = 'VA')
 11978        AND (BENTRYI NOT = 'P')
 11979        AND (PB-BATCH-ENTRY = 'P')
 11980        PERFORM 1800-REMOVE-CERT-NOTES
 11981                                 THRU 1800-EXIT
 11982     END-IF
 11983     IF BENTRYL NOT = ZEROS
 11984        MOVE BENTRYI             TO PB-BATCH-ENTRY
 11985        IF PI-COMPANY-ID = 'CID'
 11986           AND (PB-BATCH-ENTRY = 'P')
 11987           AND (PB-STATE = 'VA')
 11988           PERFORM 1500-UPDATE-ERNOTE
 11989                                 THRU 1500-EXIT
 11990        END-IF
 11991     END-IF
 11992
 11993     IF BUNWRITL NOT = ZEROS
 11994        MOVE BUNWRITI            TO PB-I-UNDERWRITING-STATUS.
 11995
 11996     IF BBILCDL NOT = ZEROS
 11997        MOVE BBILCDI             TO PB-RECORD-BILL.
 11998
 11999     IF BLIVESL GREATER THAN ZEROS
 12000        MOVE WS-BLIVES           TO PB-I-LIVES.
 12001
 12002
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 219
* EL6311.cbl
 12003*DMD CUSTOM CODING*************START
 12004     IF PI-COMPANY-ID NOT = 'DMD'
 12005         MOVE ZEROS               TO BBILLEDL.
 12006*DMD CUSTOM CODING*************END
 12007
 12008     IF BBILLEDL GREATER THAN ZEROS
 12009        MOVE WS-BILLED           TO PB-I-NUM-BILLED.
 12010
 12011
 12012*****************************************************************
 12013*        IF BTYPE = ZEROS OR SPACES DELETE COVERAGE             *
 12014*****************************************************************
 12015
 12016     IF BTYPE-LEN (1)   GREATER THAN ZEROS
 12017        IF BTYPE  (1)   = ZEROS OR SPACES
 12018           IF REMOVE-LF-COVERAGE
 12019               MOVE SPACES           TO PB-I-LF-INPUT-CD
 12020                                        PI-BTYPE (1)
 12021               SUBTRACT PB-I-LF-PREMIUM-AMT FROM
 12022                                        WS-B-LF-ISS-PRM-ENTERED
 12023               SUBTRACT PB-I-LF-ALT-PREMIUM-AMT FROM
 12024                                        WS-B-LF-ISS-PRM-ENTERED
 12025               SUBTRACT PB-I-LF-PREM-CALC FROM
 12026                                        WS-B-LF-ISS-PRM-COMPUTED
 12027               MOVE ZEROS            TO PB-I-LF-TERM
 12028                                        PB-I-LF-BENEFIT-AMT
 12029                                        PB-I-LF-PREMIUM-AMT
 12030                                        PB-I-LF-BENEFIT-CD
 12031                                        PB-I-LF-PREM-CALC
 12032                                        PB-I-LF-CRIT-PER
 12033                                        PB-I-LF-ALT-BENEFIT-AMT
 12034                                        PB-I-LF-ALT-PREMIUM-AMT
 12035               MOVE LOW-VALUES       TO PB-I-LF-EXPIRE-DT
 12036           ELSE
 12037               NEXT SENTENCE
 12038        ELSE
 12039           MOVE BTYPE (1)        TO PB-I-LF-INPUT-CD
 12040                                    PI-BTYPE (1).
 12041     IF BTYPE-LEN (2)   GREATER THAN ZEROS
 12042        IF BTYPE  (2)   = ZEROS OR SPACES
 12043           IF  REMOVE-AH-COVERAGE
 12044               MOVE SPACES           TO PB-I-AH-INPUT-CD
 12045                                        PI-BTYPE (2)
 12046               SUBTRACT PB-I-AH-PREMIUM-AMT FROM
 12047                                        WS-B-AH-ISS-PRM-ENTERED
 12048               SUBTRACT PB-I-AH-PREM-CALC FROM
 12049                                        WS-B-AH-ISS-PRM-COMPUTED
 12050               MOVE ZEROS            TO PB-I-AH-TERM
 12051                                        PB-I-AH-BENEFIT-AMT
 12052                                        PB-I-AH-PREMIUM-AMT
 12053                                        PB-I-AH-BENEFIT-CD
 12054                                        PB-I-AH-PREM-CALC
 12055                                        PB-I-AH-CRIT-PER
 12056               MOVE LOW-VALUES       TO PB-I-AH-EXPIRE-DT
 12057           ELSE
 12058               NEXT SENTENCE
 12059        ELSE
 12060           MOVE BTYPE (2)        TO PB-I-AH-INPUT-CD
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 220
* EL6311.cbl
 12061                                    PI-BTYPE (2).
 12062 1360-REWRITE-PB-RECORD.
 12063     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 12064
 12065     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 12066     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT.
 12067
 12068     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 12069
 12070     SUBTRACT PB-I-LF-PREM-CALC  FROM WS-B-LF-ISS-PRM-COMPUTED.
 12071     SUBTRACT PB-I-AH-PREM-CALC  FROM WS-B-AH-ISS-PRM-COMPUTED.
 12072
 12073     IF BCPREM-LEN (1)  GREATER THAN ZEROS
 12074         MOVE WS-BCPREM (1)      TO PB-I-LF-PREM-CALC.
 12075
 12076     IF BCPREM-LEN (2)  GREATER THAN ZEROS
 12077         MOVE WS-BCPREM (2)      TO PB-I-AH-PREM-CALC.
 12078
 12079     IF CSR-EDIT-SESSION
 12080        PERFORM 139A-SET-LETTER-REQD THRU 139A-EXIT
 12081     END-IF.
 12082
 12083     PERFORM 1390-UPDATE-ERPNDM THRU 1399-EXIT.
 12084
 12085     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 12086
 12087     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 12088
 12089     IF ARCHIVE-LETTER-RELEASED
 12090        MOVE 'C' TO PB-I-LETTER-REQD
 12091        PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT
 12092        PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT
 12093     END-IF
 12094
 12095     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 12096     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 12097     MOVE PB-SV-STATE            TO PI-SV-STATE.
 12098
 12099     ADD  PB-I-LF-PREM-CALC      TO WS-B-LF-ISS-PRM-COMPUTED.
 12100     ADD  PB-I-AH-PREM-CALC      TO WS-B-AH-ISS-PRM-COMPUTED.
 12101
 12102 1375-REWRITE-PB-RECORD.
 12103     PERFORM 8400-LOG-JOURNAL-RECORD  *> Before Issue image
 12104     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12105     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 12106     MOVE 'C'                    TO JP-RECORD-TYPE.
 12107     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 12108
 12109
 12110* EXEC CICS REWRITE
 12111*        DATASET (FILE-ID-ERPNDB)
 12112*        FROM    (PENDING-BUSINESS)
 12113*    END-EXEC.
 12114     MOVE LENGTH OF
 12115      PENDING-BUSINESS
 12116       TO DFHEIV11
 12117*    MOVE '&& L                  %   #00011673' TO DFHEIV0
 12118     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 221
* EL6311.cbl
 12119     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12120     MOVE X'2020233030303131363733' TO DFHEIV0(25:11)
 12121     CALL 'kxdfhei1' USING DFHEIV0,
 12122           FILE-ID-ERPNDB,
 12123           PENDING-BUSINESS,
 12124           DFHEIV11,
 12125           DFHEIV99
 12126     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12127
 12128
 12129     PERFORM 8400-LOG-JOURNAL-RECORD  *> After Issue Image
 12130******************************************************************
 12131*       U P D A T E   T H E   O R I G   C E R T   I N F O        *
 12132******************************************************************
 12133     MOVE ELCERT-KEY             TO ERMAIL-KEY
 12134     MOVE ' '                    TO WS-ERMAIL-SW
 12135
 12136* EXEC CICS READ
 12137*       DATASET   (FILE-ID-ERMAIL)
 12138*       SET       (ADDRESS OF MAILING-DATA)
 12139*       RIDFLD    (ERMAIL-KEY)
 12140*       RESP      (WS-RESPONSE)
 12141*    END-EXEC
 12142*    MOVE '&"S        E          (  N#00011684' TO DFHEIV0
 12143     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12144     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12145     MOVE X'204E233030303131363834' TO DFHEIV0(25:11)
 12146     CALL 'kxdfhei1' USING DFHEIV0,
 12147           FILE-ID-ERMAIL,
 12148           DFHEIV20,
 12149           DFHEIV99,
 12150           ERMAIL-KEY,
 12151           DFHEIV99,
 12152           DFHEIV99,
 12153           DFHEIV99
 12154     SET ADDRESS OF MAILING-DATA TO
 12155         DFHEIV20
 12156     MOVE EIBRESP  TO WS-RESPONSE
 12157     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12158     IF RESP-NORMAL
 12159        SET ERMAIL-FOUND TO TRUE
 12160     END-IF
 12161
 12162     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 12163     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 12164                                 TO ELCRTO-KEY
 12165     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 12166     MOVE +0                     TO ELCRTO-SEQ-NO
 12167
 12168* EXEC CICS READ
 12169*       DATASET   ('ELCRTO')
 12170*       INTO      (ORIGINAL-CERTIFICATE)
 12171*       RIDFLD    (ELCRTO-KEY)
 12172*       GTEQ
 12173*       RESP      (WS-RESPONSE)
 12174*    END-EXEC
 12175     MOVE LENGTH OF
 12176      ORIGINAL-CERTIFICATE
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 222
* EL6311.cbl
 12177       TO DFHEIV11
 12178     MOVE 'ELCRTO' TO DFHEIV1
 12179*    MOVE '&"IL       G          (  N#00011699' TO DFHEIV0
 12180     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 12181     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12182     MOVE X'204E233030303131363939' TO DFHEIV0(25:11)
 12183     CALL 'kxdfhei1' USING DFHEIV0,
 12184           DFHEIV1,
 12185           ORIGINAL-CERTIFICATE,
 12186           DFHEIV11,
 12187           ELCRTO-KEY,
 12188           DFHEIV99,
 12189           DFHEIV99,
 12190           DFHEIV99
 12191     MOVE EIBRESP  TO WS-RESPONSE
 12192     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12193*    display ' just read gteq ' ws-response
 12194     IF RESP-NORMAL
 12195        AND (OC-CONTROL-PRIMARY (1:33) =
 12196                 PB-CONTROL-BY-ACCOUNT (1:33))
 12197        AND (OC-RECORD-TYPE = 'I')
 12198        IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 12199           display ' csr edit session ' PI-CSR-SESSION-SW
 12200           IF NOT CSR-EDIT-SESSION
 12201
 12202* EXEC CICS READ
 12203*                DATASET   ('ELCRTO')
 12204*                INTO      (ORIGINAL-CERTIFICATE)
 12205*                RIDFLD    (OC-CONTROL-PRIMARY)
 12206*                UPDATE
 12207*                RESP      (WS-RESPONSE)
 12208*             END-EXEC
 12209     MOVE LENGTH OF
 12210      ORIGINAL-CERTIFICATE
 12211       TO DFHEIV11
 12212     MOVE 'ELCRTO' TO DFHEIV1
 12213*    MOVE '&"IL       EU         (  N#00011716' TO DFHEIV0
 12214     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12215     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12216     MOVE X'204E233030303131373136' TO DFHEIV0(25:11)
 12217     CALL 'kxdfhei1' USING DFHEIV0,
 12218           DFHEIV1,
 12219           ORIGINAL-CERTIFICATE,
 12220           DFHEIV11,
 12221           OC-CONTROL-PRIMARY,
 12222           DFHEIV99,
 12223           DFHEIV99,
 12224           DFHEIV99
 12225     MOVE EIBRESP  TO WS-RESPONSE
 12226     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12227              DISPLAY ' JUST DID READ UPD ' WS-RESPONSE
 12228              IF RESP-NORMAL
 12229                 display ' good read upd '
 12230                 MOVE PB-I-INSURED-LAST-NAME TO
 12231                         OC-INS-LAST-NAME
 12232                 MOVE PB-I-INSURED-FIRST-NAME TO
 12233                         OC-INS-FIRST-NAME
 12234                 MOVE PB-I-INSURED-MIDDLE-INIT TO
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 223
* EL6311.cbl
 12235                         OC-INS-MIDDLE-INIT
 12236                 MOVE PB-I-AGE         TO OC-INS-AGE
 12237                 MOVE PB-I-JOINT-LAST-NAME   TO
 12238                         OC-JNT-LAST-NAME
 12239                 MOVE PB-I-JOINT-FIRST-NAME  TO
 12240                         OC-JNT-FIRST-NAME
 12241                 MOVE PB-I-JOINT-MIDDLE-INIT TO
 12242                         OC-JNT-MIDDLE-INIT
 12243                 MOVE PB-I-JOINT-AGE   TO OC-JNT-AGE
 12244                 MOVE PB-I-LF-BENEFIT-CD TO OC-LF-BENCD
 12245                 MOVE PB-I-LF-TERM     TO OC-LF-TERM
 12246                 MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
 12247                 MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
 12248                 MOVE PB-I-LF-ALT-BENEFIT-AMT TO
 12249                         OC-LF-ALT-BEN-AMT
 12250                 MOVE PB-I-LF-ALT-PREMIUM-AMT TO
 12251                         OC-LF-ALT-PRM-AMT
 12252                 MOVE PB-I-LF-EXPIRE-DT TO OC-LF-EXP-DT
 12253                 MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
 12254                 MOVE PB-I-AH-BENEFIT-CD TO OC-AH-BENCD
 12255                 MOVE PB-I-AH-TERM     TO OC-AH-TERM
 12256                 MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
 12257                 MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
 12258                 MOVE PB-I-AH-EXPIRE-DT TO OC-AH-EXP-DT
 12259                 MOVE PB-I-AH-COMMISSION TO OC-AH-COMM-PCT
 12260                 MOVE PB-I-AH-CRIT-PER TO OC-AH-CP
 12261                 MOVE PB-I-1ST-PMT-DT  TO OC-1ST-PMT-DT
 12262                 IF OC-CANCEL-TRAN-IND = 'N'
 12263                    MOVE LOW-VALUES    TO OC-LF-CANCEL-DT
 12264                    MOVE +0            TO OC-LF-CANCEL-AMT
 12265                                          OC-LF-ITD-CANCEL-AMT
 12266                    MOVE LOW-VALUES    TO OC-AH-CANCEL-DT
 12267                    MOVE +0            TO OC-AH-CANCEL-AMT
 12268                                          OC-AH-ITD-CANCEL-AMT
 12269                 END-IF
 12270                 MOVE 'Y'              TO OC-ISSUE-TRAN-IND
 12271                 MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 12272                 MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 12273                 MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 12274                 IF ERMAIL-FOUND
 12275                    MOVE MA-CRED-BENE-NAME
 12276                                 TO OC-CRED-BENE-NAME
 12277                 END-IF
 12278                 IF NOT CERT-TRL-REC-NOT-FOUND
 12279                    MOVE CS-INS-AGE-DEFAULT-FLAG TO
 12280                           OC-INS-AGE-DEFAULT-FLAG
 12281                    MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 12282                           OC-JNT-AGE-DEFAULT-FLAG
 12283                 END-IF
 12284
 12285* EXEC CICS REWRITE
 12286*                   DATASET   ('ELCRTO')
 12287*                   FROM      (ORIGINAL-CERTIFICATE)
 12288*                   RESP      (WS-RESPONSE)
 12289*                END-EXEC
 12290     MOVE LENGTH OF
 12291      ORIGINAL-CERTIFICATE
 12292       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 224
* EL6311.cbl
 12293     MOVE 'ELCRTO' TO DFHEIV1
 12294*    MOVE '&& L                  %  N#00011780' TO DFHEIV0
 12295     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12296     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12297     MOVE X'204E233030303131373830' TO DFHEIV0(25:11)
 12298     CALL 'kxdfhei1' USING DFHEIV0,
 12299           DFHEIV1,
 12300           ORIGINAL-CERTIFICATE,
 12301           DFHEIV11,
 12302           DFHEIV99
 12303     MOVE EIBRESP  TO WS-RESPONSE
 12304     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12305                 display ' just rewrote ' ws-response
 12306              END-IF
 12307           END-IF
 12308        ELSE
 12309           SUBTRACT +1 FROM OC-KEY-SEQ-NO
 12310           MOVE 'OC'             TO OC-RECORD-ID
 12311           MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 12312           MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 12313           MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 12314           MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 12315           MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 12316           MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 12317           MOVE PB-I-AGE         TO OC-INS-AGE
 12318           MOVE PB-I-JOINT-LAST-NAME TO OC-JNT-LAST-NAME
 12319           MOVE PB-I-JOINT-FIRST-NAME TO OC-JNT-FIRST-NAME
 12320           MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 12321           MOVE PB-I-JOINT-AGE   TO OC-JNT-AGE
 12322           MOVE PB-I-LF-BENEFIT-CD TO OC-LF-BENCD
 12323           MOVE PB-I-LF-TERM     TO OC-LF-TERM
 12324           MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
 12325           MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
 12326           MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 12327           MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 12328           MOVE PB-I-LF-EXPIRE-DT TO OC-LF-EXP-DT
 12329           MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
 12330           MOVE LOW-VALUES       TO OC-LF-CANCEL-DT
 12331           MOVE +0               TO OC-LF-CANCEL-AMT
 12332                                    OC-LF-ITD-CANCEL-AMT
 12333           MOVE PB-I-AH-BENEFIT-CD TO OC-AH-BENCD
 12334           MOVE PB-I-AH-TERM     TO OC-AH-TERM
 12335           MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
 12336           MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
 12337           MOVE PB-I-AH-EXPIRE-DT TO OC-AH-EXP-DT
 12338           MOVE PB-I-AH-COMMISSION TO OC-AH-COMM-PCT
 12339           MOVE PB-I-AH-CRIT-PER TO OC-AH-CP
 12340           MOVE LOW-VALUES       TO OC-AH-CANCEL-DT
 12341           MOVE +0               TO OC-AH-CANCEL-AMT
 12342                                    OC-AH-ITD-CANCEL-AMT
 12343           MOVE PB-I-1ST-PMT-DT  TO OC-1ST-PMT-DT
 12344           MOVE 'Y'              TO OC-ISSUE-TRAN-IND
 12345           MOVE 'N'              TO OC-CANCEL-TRAN-IND
 12346           IF ERMAIL-FOUND
 12347              MOVE MA-CRED-BENE-NAME
 12348                                 TO OC-CRED-BENE-NAME
 12349           END-IF
 12350           IF NOT CERT-TRL-REC-NOT-FOUND
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 225
* EL6311.cbl
 12351              MOVE CS-INS-AGE-DEFAULT-FLAG TO
 12352                           OC-INS-AGE-DEFAULT-FLAG
 12353              MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 12354                           OC-JNT-AGE-DEFAULT-FLAG
 12355           END-IF
 12356           MOVE LOW-VALUES       TO OC-ENDORSEMENT-PROCESSED-DT
 12357
 12358* EXEC CICS WRITE
 12359*             DATASET   ('ELCRTO')
 12360*             FROM      (ORIGINAL-CERTIFICATE)
 12361*             RIDFLD    (OC-CONTROL-PRIMARY)
 12362*             RESP      (WS-RESPONSE)
 12363*          END-EXEC
 12364     MOVE LENGTH OF
 12365      ORIGINAL-CERTIFICATE
 12366       TO DFHEIV11
 12367     MOVE 'ELCRTO' TO DFHEIV1
 12368*    MOVE '&$ L                  ''  N#00011837' TO DFHEIV0
 12369     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12370     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12371     MOVE X'204E233030303131383337' TO DFHEIV0(25:11)
 12372     CALL 'kxdfhei1' USING DFHEIV0,
 12373           DFHEIV1,
 12374           ORIGINAL-CERTIFICATE,
 12375           DFHEIV11,
 12376           OC-CONTROL-PRIMARY,
 12377           DFHEIV99,
 12378           DFHEIV99
 12379     MOVE EIBRESP  TO WS-RESPONSE
 12380     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12381        END-IF
 12382     ELSE
 12383        MOVE SPACES              TO ORIGINAL-CERTIFICATE
 12384        MOVE 'OC'                TO OC-RECORD-ID
 12385        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 12386                                 TO OC-CONTROL-PRIMARY (1:33)
 12387        MOVE 'I'                 TO OC-RECORD-TYPE
 12388        MOVE +4096               TO OC-KEY-SEQ-NO
 12389        MOVE PI-PROCESSOR-ID     TO OC-LAST-MAINT-BY
 12390        MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 12391        MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 12392        MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 12393        MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 12394        MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 12395        MOVE PB-I-AGE            TO OC-INS-AGE
 12396        MOVE PB-I-JOINT-LAST-NAME TO OC-JNT-LAST-NAME
 12397        MOVE PB-I-JOINT-FIRST-NAME TO OC-JNT-FIRST-NAME
 12398        MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 12399        MOVE PB-I-JOINT-AGE      TO OC-JNT-AGE
 12400        MOVE PB-I-LF-BENEFIT-CD  TO OC-LF-BENCD
 12401        MOVE PB-I-LF-TERM        TO OC-LF-TERM
 12402        MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
 12403        MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
 12404        MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 12405        MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 12406        MOVE PB-I-LF-EXPIRE-DT   TO OC-LF-EXP-DT
 12407        MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
 12408        MOVE LOW-VALUES          TO OC-LF-CANCEL-DT
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 226
* EL6311.cbl
 12409        MOVE +0                  TO OC-LF-CANCEL-AMT
 12410                                    OC-LF-ITD-CANCEL-AMT
 12411        MOVE PB-I-AH-BENEFIT-CD  TO OC-AH-BENCD
 12412        MOVE PB-I-AH-TERM        TO OC-AH-TERM
 12413        MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
 12414        MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
 12415        MOVE PB-I-AH-EXPIRE-DT   TO OC-AH-EXP-DT
 12416        MOVE PB-I-AH-COMMISSION  TO OC-AH-COMM-PCT
 12417        MOVE PB-I-AH-CRIT-PER    TO OC-AH-CP
 12418        MOVE LOW-VALUES          TO OC-AH-CANCEL-DT
 12419        MOVE +0                  TO OC-AH-CANCEL-AMT
 12420                                    OC-AH-ITD-CANCEL-AMT
 12421        MOVE PB-I-1ST-PMT-DT     TO OC-1ST-PMT-DT
 12422        MOVE 'Y'                 TO OC-ISSUE-TRAN-IND
 12423        MOVE 'N'                 TO OC-CANCEL-TRAN-IND
 12424        IF ERMAIL-FOUND
 12425           MOVE MA-CRED-BENE-NAME
 12426                                 TO OC-CRED-BENE-NAME
 12427        END-IF
 12428        IF NOT CERT-TRL-REC-NOT-FOUND
 12429           MOVE CS-INS-AGE-DEFAULT-FLAG TO
 12430                           OC-INS-AGE-DEFAULT-FLAG
 12431           MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 12432                           OC-JNT-AGE-DEFAULT-FLAG
 12433        END-IF
 12434        MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 12435
 12436* EXEC CICS WRITE
 12437*          DATASET   ('ELCRTO')
 12438*          FROM      (ORIGINAL-CERTIFICATE)
 12439*          RIDFLD    (OC-CONTROL-PRIMARY)
 12440*          RESP      (WS-RESPONSE)
 12441*       END-EXEC
 12442     MOVE LENGTH OF
 12443      ORIGINAL-CERTIFICATE
 12444       TO DFHEIV11
 12445     MOVE 'ELCRTO' TO DFHEIV1
 12446*    MOVE '&$ L                  ''  N#00011897' TO DFHEIV0
 12447     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12448     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12449     MOVE X'204E233030303131383937' TO DFHEIV0(25:11)
 12450     CALL 'kxdfhei1' USING DFHEIV0,
 12451           DFHEIV1,
 12452           ORIGINAL-CERTIFICATE,
 12453           DFHEIV11,
 12454           OC-CONTROL-PRIMARY,
 12455           DFHEIV99,
 12456           DFHEIV99
 12457     MOVE EIBRESP  TO WS-RESPONSE
 12458     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12459     END-IF
 12460******************************************************************
 12461*       U P D A T E   T H E   B A T C H   H E A D E R            *
 12462******************************************************************
 12463
 12464     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 12465     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 12466
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 227
* EL6311.cbl
 12467
 12468* EXEC CICS READ
 12469*        INTO    (PENDING-BUSINESS)
 12470*        DATASET (FILE-ID-ERPNDB)
 12471*        RIDFLD  (ERPNDB-KEY)
 12472*        UPDATE
 12473*    END-EXEC.
 12474     MOVE LENGTH OF
 12475      PENDING-BUSINESS
 12476       TO DFHEIV11
 12477*    MOVE '&"IL       EU         (   #00011911' TO DFHEIV0
 12478     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12479     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12480     MOVE X'2020233030303131393131' TO DFHEIV0(25:11)
 12481     CALL 'kxdfhei1' USING DFHEIV0,
 12482           FILE-ID-ERPNDB,
 12483           PENDING-BUSINESS,
 12484           DFHEIV11,
 12485           ERPNDB-KEY,
 12486           DFHEIV99,
 12487           DFHEIV99,
 12488           DFHEIV99
 12489     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12490
 12491
 12492     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 12493     MOVE 'B'                    TO JP-RECORD-TYPE.
 12494     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 12495
 12496     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12497
 12498     PERFORM 8400-LOG-JOURNAL-RECORD  *> Before BHDR Image
 12499
 12500     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD
 12501
 12502     MOVE 'C'                    TO JP-RECORD-TYPE.
 12503     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 12504
 12505
 12506* EXEC CICS REWRITE
 12507*        DATASET    (FILE-ID-ERPNDB)
 12508*        FROM       (PENDING-BUSINESS)
 12509*    END-EXEC.
 12510     MOVE LENGTH OF
 12511      PENDING-BUSINESS
 12512       TO DFHEIV11
 12513*    MOVE '&& L                  %   #00011931' TO DFHEIV0
 12514     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12515     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12516     MOVE X'2020233030303131393331' TO DFHEIV0(25:11)
 12517     CALL 'kxdfhei1' USING DFHEIV0,
 12518           FILE-ID-ERPNDB,
 12519           PENDING-BUSINESS,
 12520           DFHEIV11,
 12521           DFHEIV99
 12522     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12523
 12524
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 228
* EL6311.cbl
 12525     PERFORM 8400-LOG-JOURNAL-RECORD  *> After BHDR Image
 12526
 12527     IF WS-ERRORS-PRESENT
 12528        GO TO 3900-RE-DISPLAY-RECORD.
 12529
 12530     MOVE ZEROS                  TO EMI-ERROR.
 12531     MOVE -1                     TO BMAINTL.
 12532     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12533     GO TO 3900-RE-DISPLAY-RECORD.
 12534
 12535 1380-BATCH-HDR-NOT-FOUND.
 12536     MOVE -1                     TO BMAINTL.
 12537     MOVE ER-7450                TO EMI-ERROR.
 12538     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12539     GO TO 8200-SEND-DATAONLY.
 12540
 12541 1385-REC-NOT-FOUND.
 12542     MOVE -1                     TO BMAINTL.
 12543     MOVE ER-7451                TO EMI-ERROR.
 12544     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12545     GO TO 8200-SEND-DATAONLY.
 12546
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 229
* EL6311.cbl
 12548
 12549 1386-UPDATE-AGE-FLAGS.
 12550
 12551
 12552* EXEC CICS GETMAIN
 12553*        SET     (ADDRESS OF CERTIFICATE-TRAILERS)
 12554*        LENGTH  (ELCRTT-RECORD-LENGTH)
 12555*        INITIMG (GETMAIN-SPACE)
 12556*    END-EXEC
 12557*    MOVE ',"IL                  $   #00011962' TO DFHEIV0
 12558     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12559     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12560     MOVE X'2020233030303131393632' TO DFHEIV0(25:11)
 12561     CALL 'kxdfhei1' USING DFHEIV0,
 12562           DFHEIV20,
 12563           ELCRTT-RECORD-LENGTH,
 12564           GETMAIN-SPACE
 12565     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 12566         DFHEIV20
 12567     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12568
 12569
 12570* EXEC CICS HANDLE CONDITION
 12571*        NOTFND   (1386-NOTFND)
 12572*    END-EXEC.
 12573*    MOVE '"$I                   ! ( #00011968' TO DFHEIV0
 12574     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12575     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12576     MOVE X'2820233030303131393638' TO DFHEIV0(25:11)
 12577     CALL 'kxdfhei1' USING DFHEIV0
 12578     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12579
 12580
 12581     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTT-PRIMARY
 12582     MOVE 'C'                TO ELCRTT-REC-TYPE
 12583
 12584
 12585* EXEC CICS READ
 12586*        UPDATE
 12587*        DATASET  (CRTT-ID)
 12588*        RIDFLD   (ELCRTT-KEY)
 12589*        INTO     (CERTIFICATE-TRAILERS)
 12590*    END-EXEC.
 12591     MOVE LENGTH OF
 12592      CERTIFICATE-TRAILERS
 12593       TO DFHEIV11
 12594*    MOVE '&"IL       EU         (   #00011975' TO DFHEIV0
 12595     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12596     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12597     MOVE X'2020233030303131393735' TO DFHEIV0(25:11)
 12598     CALL 'kxdfhei1' USING DFHEIV0,
 12599           CRTT-ID,
 12600           CERTIFICATE-TRAILERS,
 12601           DFHEIV11,
 12602           ELCRTT-KEY,
 12603           DFHEIV99,
 12604           DFHEIV99,
 12605           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 230
* EL6311.cbl
 12606     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12607
 12608
 12609     IF WS-INS-AGE-SET = 'Y'
 12610        MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG
 12611     END-IF
 12612     IF WS-JNT-AGE-SET = 'Y'
 12613        MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG
 12614     END-IF
 12615
 12616
 12617* EXEC CICS REWRITE
 12618*       DATASET  (CRTT-ID)
 12619*       FROM     (CERTIFICATE-TRAILERS)
 12620*    END-EXEC.
 12621     MOVE LENGTH OF
 12622      CERTIFICATE-TRAILERS
 12623       TO DFHEIV11
 12624*    MOVE '&& L                  %   #00011989' TO DFHEIV0
 12625     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12626     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12627     MOVE X'2020233030303131393839' TO DFHEIV0(25:11)
 12628     CALL 'kxdfhei1' USING DFHEIV0,
 12629           CRTT-ID,
 12630           CERTIFICATE-TRAILERS,
 12631           DFHEIV11,
 12632           DFHEIV99
 12633     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12634
 12635
 12636     GO TO 1386-EXIT.
 12637
 12638 1386-NOTFND.
 12639
 12640     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 12641     MOVE 'CS'         TO CS-RECORD-ID.
 12642     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTT-PRIMARY.
 12643     MOVE 'C'          TO ELCRTT-REC-TYPE.
 12644     MOVE ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 12645     MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG.
 12646     MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG.
 12647
 12648* EXEC CICS WRITE
 12649*       DATASET  (CRTT-ID)
 12650*       RIDFLD   (ELCRTT-KEY)
 12651*       FROM     (CERTIFICATE-TRAILERS)
 12652*    END-EXEC.
 12653     MOVE LENGTH OF
 12654      CERTIFICATE-TRAILERS
 12655       TO DFHEIV11
 12656*    MOVE '&$ L                  ''   #00012005' TO DFHEIV0
 12657     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12658     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12659     MOVE X'2020233030303132303035' TO DFHEIV0(25:11)
 12660     CALL 'kxdfhei1' USING DFHEIV0,
 12661           CRTT-ID,
 12662           CERTIFICATE-TRAILERS,
 12663           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 231
* EL6311.cbl
 12664           ELCRTT-KEY,
 12665           DFHEIV99,
 12666           DFHEIV99
 12667     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12668
 12669
 12670 1386-EXIT.
 12671     EXIT.
 12672
 12673 1390-UPDATE-ERPNDM.
 12674
 12675
 12676* EXEC CICS HANDLE CONDITION
 12677*        NOTFND (1399-EXIT)
 12678*    END-EXEC.
 12679*    MOVE '"$I                   ! ) #00012016' TO DFHEIV0
 12680     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12681     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12682     MOVE X'2920233030303132303136' TO DFHEIV0(25:11)
 12683     CALL 'kxdfhei1' USING DFHEIV0
 12684     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12685
 12686
 12687     MOVE PB-CONTROL-PRIMARY     TO  ERPNDM-KEY.
 12688
 12689
 12690* EXEC CICS READ
 12691*        SET     (ADDRESS OF PENDING-MAILING-DATA)
 12692*        DATASET (FILE-ID-ERPNDM)
 12693*        RIDFLD  (ERPNDM-KEY)
 12694*        UPDATE
 12695*    END-EXEC.
 12696*    MOVE '&"S        EU         (   #00012022' TO DFHEIV0
 12697     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12698     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12699     MOVE X'2020233030303132303232' TO DFHEIV0(25:11)
 12700     CALL 'kxdfhei1' USING DFHEIV0,
 12701           FILE-ID-ERPNDM,
 12702           DFHEIV20,
 12703           DFHEIV99,
 12704           ERPNDM-KEY,
 12705           DFHEIV99,
 12706           DFHEIV99,
 12707           DFHEIV99
 12708     SET ADDRESS OF PENDING-MAILING-DATA TO
 12709         DFHEIV20
 12710     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12711
 12712
 12713     MOVE PI-PROCESSOR-ID        TO PM-LAST-MAINT-BY.
 12714     MOVE EIBTIME                TO PM-LAST-MAINT-HHMMSS.
 12715     MOVE WS-CURRENT-BIN-DT      TO PM-LAST-MAINT-DT.
 12716
 12717     IF BLSTNML GREATER THAN ZEROS
 12718         MOVE BLSTNMI            TO PM-INSURED-LAST-NAME.
 12719
 12720     IF B1STNML GREATER  THAN ZEROS
 12721         MOVE B1STNMI            TO PM-INSURED-FIRST-NAME.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 232
* EL6311.cbl
 12722
 12723     IF BINITL GREATER THAN ZEROS
 12724         MOVE BINITI             TO PM-INSURED-MIDDLE-INIT.
 12725
 12726     IF BAGEL GREATER THAN ZEROS
 12727         MOVE WS-BAGE            TO PM-INSURED-ISSUE-AGE.
 12728
 12729     IF BBIRTHL GREATER THAN ZEROS
 12730         MOVE  WS-CONVERTED-BIRTH TO PM-INSURED-BIRTH-DT.
 12731
 12732     IF BSEXL GREATER THAN ZEROS
 12733         MOVE  BSEXI             TO PM-INSURED-SEX.
 12734
 12735
 12736* EXEC CICS REWRITE
 12737*        DATASET (FILE-ID-ERPNDM)
 12738*        FROM    (PENDING-MAILING-DATA)
 12739*    END-EXEC.
 12740     MOVE LENGTH OF
 12741      PENDING-MAILING-DATA
 12742       TO DFHEIV11
 12743*    MOVE '&& L                  %   #00012051' TO DFHEIV0
 12744     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12745     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12746     MOVE X'2020233030303132303531' TO DFHEIV0(25:11)
 12747     CALL 'kxdfhei1' USING DFHEIV0,
 12748           FILE-ID-ERPNDM,
 12749           PENDING-MAILING-DATA,
 12750           DFHEIV11,
 12751           DFHEIV99
 12752     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12753
 12754
 12755 1399-EXIT.
 12756     EXIT.
 12757 139A-SET-LETTER-REQD.
 12758*  COMPARE BEFORE AND AFTER CHANGE
 12759     IF PB-ISSUE-RECORD = WS-SAVE-PEND-ISSUE
 12760        GO TO 139A-EXIT
 12761     END-IF
 12762
 12763*  READ ELCRTO
 12764     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 12765                                 TO ELCRTO-KEY
 12766     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 12767     MOVE +0                     TO ELCRTO-SEQ-NO
 12768
 12769
 12770* EXEC CICS READ
 12771*       DATASET   ('ELCRTO')
 12772*       INTO      (ORIGINAL-CERTIFICATE)
 12773*       RIDFLD    (ELCRTO-KEY)
 12774*       GTEQ
 12775*       RESP      (WS-RESPONSE)
 12776*    END-EXEC
 12777     MOVE LENGTH OF
 12778      ORIGINAL-CERTIFICATE
 12779       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 233
* EL6311.cbl
 12780     MOVE 'ELCRTO' TO DFHEIV1
 12781*    MOVE '&"IL       G          (  N#00012070' TO DFHEIV0
 12782     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 12783     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12784     MOVE X'204E233030303132303730' TO DFHEIV0(25:11)
 12785     CALL 'kxdfhei1' USING DFHEIV0,
 12786           DFHEIV1,
 12787           ORIGINAL-CERTIFICATE,
 12788           DFHEIV11,
 12789           ELCRTO-KEY,
 12790           DFHEIV99,
 12791           DFHEIV99,
 12792           DFHEIV99
 12793     MOVE EIBRESP  TO WS-RESPONSE
 12794     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12795
 12796*    display ' just read gteq ' ws-response
 12797     IF RESP-NORMAL
 12798        AND (OC-CONTROL-PRIMARY (1:33) =
 12799                 PB-CONTROL-BY-ACCOUNT (1:33))
 12800        AND (OC-RECORD-TYPE = 'I')
 12801*      compare individual fields
 12802        IF LETRREQL   GREATER THAN ZEROS
 12803           CONTINUE
 12804        ELSE
 12805        IF OC-CERT-NO = PB-CERT-NO
 12806          AND OC-CERT-EFF-DT = PB-CERT-EFF-DT
 12807          AND OC-INS-LAST-NAME = PB-I-INSURED-LAST-NAME
 12808          AND OC-INS-FIRST-NAME = PB-I-INSURED-FIRST-NAME
 12809          AND OC-INS-MIDDLE-INIT =  PB-I-INSURED-MIDDLE-INIT
 12810          AND OC-INS-AGE = PB-I-AGE
 12811          AND OC-LF-BENCD = PB-I-LIFE-BENEFIT-CD
 12812          AND OC-LF-TERM = PB-I-LF-TERM
 12813          AND OC-LF-BEN-AMT = PB-I-LF-BENEFIT-AMT
 12814          AND OC-LF-PRM-AMT = PB-I-LF-PREMIUM-AMT
 12815          AND OC-LF-EXP-DT = PB-I-LF-EXPIRE-DT
 12816          AND OC-LF-ALT-BEN-AMT = PB-I-LF-ALT-BENEFIT-AMT
 12817          AND PB-I-LF-ALT-PREMIUM-AMT = OC-LF-ALT-PRM-AMT
 12818          AND PB-I-LF-EXPIRE-DT = OC-LF-EXP-DT
 12819          AND PB-I-AH-BENEFIT-CD     = OC-AH-BENCD
 12820          AND PB-I-AH-TERM           = OC-AH-TERM
 12821          AND PB-I-AH-BENEFIT-AMT    = OC-AH-BEN-AMT
 12822          AND PB-I-AH-PREMIUM-AMT    = OC-AH-PRM-AMT
 12823          AND PB-I-AH-EXPIRE-DT      = OC-AH-EXP-DT
 12824          AND PB-I-AH-COMMISSION     = OC-AH-COMM-PCT
 12825          AND PB-I-AH-CRIT-PER       = OC-AH-CP
 12826           MOVE SPACE TO PB-I-LETTER-REQD
 12827        ELSE
 12828           MOVE 'Y' TO PB-I-LETTER-REQD
 12829        END-IF
 12830     END-IF.
 12831
 12832 139A-EXIT.
 12833     EXIT.
 12834
 12835******************************************************************
 12836*                                                                *
 12837*          D E L E T E   I S S U E   R O U T I N E               *
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 234
* EL6311.cbl
 12838*                                                                *
 12839******************************************************************
 12840
 12841 1400-DELETE-ISSUE-ROUTINE.
 12842     MOVE 'D'                    TO PI-MAINT-FUNCTION.
 12843
 12844     IF BCHGL NOT = ZEROS
 12845        MOVE ER-2196             TO EMI-ERROR
 12846        MOVE AL-UABON            TO BMAINTA
 12847        MOVE -1                  TO BMAINTL
 12848        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12849        GO TO 8200-SEND-DATAONLY.
 12850
 12851
 12852* EXEC CICS HANDLE CONDITION
 12853*         NOTFND    (1480-BATCH-HDR-NOT-FOUND)
 12854*    END-EXEC.
 12855*    MOVE '"$I                   ! * #00012133' TO DFHEIV0
 12856     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12857     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12858     MOVE X'2A20233030303132313333' TO DFHEIV0(25:11)
 12859     CALL 'kxdfhei1' USING DFHEIV0
 12860     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12861
 12862
 12863     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 12864     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 12865     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 12866
 12867
 12868* EXEC CICS READ
 12869*        SET     (ADDRESS OF PENDING-BUSINESS)
 12870*        DATASET (FILE-ID-ERPNDB)
 12871*        RIDFLD  (ERPNDB-KEY)
 12872*    END-EXEC.
 12873*    MOVE '&"S        E          (   #00012141' TO DFHEIV0
 12874     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12875     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12876     MOVE X'2020233030303132313431' TO DFHEIV0(25:11)
 12877     CALL 'kxdfhei1' USING DFHEIV0,
 12878           FILE-ID-ERPNDB,
 12879           DFHEIV20,
 12880           DFHEIV99,
 12881           ERPNDB-KEY,
 12882           DFHEIV99,
 12883           DFHEIV99,
 12884           DFHEIV99
 12885     SET ADDRESS OF PENDING-BUSINESS TO
 12886         DFHEIV20
 12887     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12888
 12889
 12890     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 12891
 12892     MOVE BCERTNOI               TO WS-NEW-PRIME.
 12893
 12894     IF BSUFIXL NOT = ZEROS
 12895        MOVE BSUFIXI             TO WS-NEW-SUFFIX
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 235
* EL6311.cbl
 12896     ELSE
 12897        MOVE SPACE               TO WS-NEW-SUFFIX.
 12898
 12899     MOVE BEFFDTI                TO DEEDIT-FIELD.
 12900     PERFORM 8600-DEEDIT.
 12901     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 12902     MOVE '4'                    TO DC-OPTION-CODE.
 12903     PERFORM 9700-DATE-LINK.
 12904     IF DATE-CONVERSION-ERROR
 12905        MOVE ER-0348             TO EMI-ERROR
 12906        MOVE -1                  TO BEFFDTL
 12907        MOVE AL-UABON            TO BEFFDTA
 12908        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12909        GO TO 8200-SEND-DATAONLY
 12910     ELSE
 12911        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
 12912        MOVE AL-UANON            TO BEFFDTA
 12913        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 12914
 12915
 12916* EXEC CICS HANDLE CONDITION
 12917*         NOTFND    (1490-RECORD-NOT-FOUND)
 12918*    END-EXEC.
 12919*    MOVE '"$I                   ! + #00012172' TO DFHEIV0
 12920     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12921     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12922     MOVE X'2B20233030303132313732' TO DFHEIV0(25:11)
 12923     CALL 'kxdfhei1' USING DFHEIV0
 12924     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12925
 12926
 12927
 12928* EXEC CICS READ
 12929*        SET     (ADDRESS OF PENDING-BUSINESS)
 12930*        DATASET (FILE-ID-ERPNDB)
 12931*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 12932*        UPDATE
 12933*    END-EXEC.
 12934*    MOVE '&"S        EU         (   #00012176' TO DFHEIV0
 12935     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12936     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12937     MOVE X'2020233030303132313736' TO DFHEIV0(25:11)
 12938     CALL 'kxdfhei1' USING DFHEIV0,
 12939           FILE-ID-ERPNDB,
 12940           DFHEIV20,
 12941           DFHEIV99,
 12942           PI-PREV-CONTROL-PRIMARY,
 12943           DFHEIV99,
 12944           DFHEIV99,
 12945           DFHEIV99
 12946     SET ADDRESS OF PENDING-BUSINESS TO
 12947         DFHEIV20
 12948     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12949
 12950
 12951     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 12952        MOVE -1                 TO BMAINTL
 12953        MOVE ER-2197            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 236
* EL6311.cbl
 12954        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12955        GO TO 8200-SEND-DATAONLY.
 12956
 12957     IF PB-BILLED-DT NOT = LOW-VALUES
 12958        MOVE -1                 TO BMAINTL
 12959        MOVE ER-2129            TO EMI-ERROR
 12960        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12961        GO TO 8200-SEND-DATAONLY.
 12962
 12963     IF PB-CHG-COUNT NOT = ZEROS
 12964        MOVE ER-2336            TO EMI-ERROR
 12965        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12966        MOVE AL-UABON            TO BMAINTA
 12967        MOVE -1                  TO BMAINTL
 12968        GO TO 8200-SEND-DATAONLY.
 12969
 12970     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 12971        PB-CHG-COUNT NOT = ZEROS
 12972        MOVE ER-2196             TO EMI-ERROR
 12973        MOVE AL-UABON            TO BMAINTA
 12974        MOVE -1                  TO BMAINTL
 12975        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12976        GO TO 8200-SEND-DATAONLY.
 12977******************************************************************
 12978*                                                                *
 12979*       Determine if this is a dup and we should allow the       *
 12980*       user to delete the pending issue record only.            *
 12981*                                                                *
 12982******************************************************************
 12983     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 12984                                 TO ELCERT-KEY
 12985
 12986* EXEC CICS READ
 12987*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 12988*        DATASET (FILE-ID-ELCERT)
 12989*        RIDFLD  (ELCERT-KEY)
 12990*        RESP    (WS-RESPONSE)
 12991*    END-EXEC
 12992*    MOVE '&"S        E          (  N#00012217' TO DFHEIV0
 12993     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12994     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12995     MOVE X'204E233030303132323137' TO DFHEIV0(25:11)
 12996     CALL 'kxdfhei1' USING DFHEIV0,
 12997           FILE-ID-ELCERT,
 12998           DFHEIV20,
 12999           DFHEIV99,
 13000           ELCERT-KEY,
 13001           DFHEIV99,
 13002           DFHEIV99,
 13003           DFHEIV99
 13004     SET ADDRESS OF CERTIFICATE-MASTER TO
 13005         DFHEIV20
 13006     MOVE EIBRESP  TO WS-RESPONSE
 13007     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13008     if (resp-normal)
 13009        and (cert-added-batch)
 13010        and (valid-cm-id)
 13011        go to 1420-CONTINUE-DELETE
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 237
* EL6311.cbl
 13012     end-if
 13013******************************************************************
 13014*                                                                *
 13015*       Determine if there have been any checks created          *
 13016*                                                                *
 13017******************************************************************
 13018
 13019     perform 2500-browse-checks  thru 2500-exit
 13020
 13021     if i-have-processed-checks
 13022        or i-have-checks
 13023        or i-have-a-check-period
 13024        move er-3446             to emi-error
 13025        perform 9900-error-format thru 9900-exit
 13026        move al-uabon            to bmainta
 13027        move -1                  to bmaintl
 13028        go to 8200-send-dataonly
 13029     end-if
 13030******************************************************************
 13031*                                                                *
 13032*       DELETE ORIGINAL CERTIFICATE INFO                         *
 13033*                                                                *
 13034******************************************************************
 13035     MOVE PI-PREV-ALT-KEY (1:33) TO ELCRTO-KEY (1:33)
 13036     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 13037     MOVE +0                     TO ELCRTO-SEQ-NO
 13038
 13039* EXEC CICS READ
 13040*       DATASET   ('ELCRTO')
 13041*       INTO      (ORIGINAL-CERTIFICATE)
 13042*       RIDFLD    (ELCRTO-KEY)
 13043*       GTEQ
 13044*       RESP      (WS-RESPONSE)
 13045*    END-EXEC
 13046     MOVE LENGTH OF
 13047      ORIGINAL-CERTIFICATE
 13048       TO DFHEIV11
 13049     MOVE 'ELCRTO' TO DFHEIV1
 13050*    MOVE '&"IL       G          (  N#00012253' TO DFHEIV0
 13051     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 13052     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13053     MOVE X'204E233030303132323533' TO DFHEIV0(25:11)
 13054     CALL 'kxdfhei1' USING DFHEIV0,
 13055           DFHEIV1,
 13056           ORIGINAL-CERTIFICATE,
 13057           DFHEIV11,
 13058           ELCRTO-KEY,
 13059           DFHEIV99,
 13060           DFHEIV99,
 13061           DFHEIV99
 13062     MOVE EIBRESP  TO WS-RESPONSE
 13063     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13064     IF RESP-NORMAL
 13065        AND (OC-CONTROL-PRIMARY (1:33) =
 13066                 PB-CONTROL-BY-ACCOUNT (1:33))
 13067        AND (OC-RECORD-TYPE = 'I')
 13068
 13069* EXEC CICS READ
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 238
* EL6311.cbl
 13070*          DATASET   ('ELCRTO')
 13071*          INTO      (ORIGINAL-CERTIFICATE)
 13072*          RIDFLD    (ELCRTO-KEY)
 13073*          UPDATE
 13074*          RESP      (WS-RESPONSE)
 13075*       END-EXEC
 13076     MOVE LENGTH OF
 13077      ORIGINAL-CERTIFICATE
 13078       TO DFHEIV11
 13079     MOVE 'ELCRTO' TO DFHEIV1
 13080*    MOVE '&"IL       EU         (  N#00012264' TO DFHEIV0
 13081     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 13082     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13083     MOVE X'204E233030303132323634' TO DFHEIV0(25:11)
 13084     CALL 'kxdfhei1' USING DFHEIV0,
 13085           DFHEIV1,
 13086           ORIGINAL-CERTIFICATE,
 13087           DFHEIV11,
 13088           ELCRTO-KEY,
 13089           DFHEIV99,
 13090           DFHEIV99,
 13091           DFHEIV99
 13092     MOVE EIBRESP  TO WS-RESPONSE
 13093     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13094        IF RESP-NORMAL
 13095
 13096* EXEC CICS DELETE
 13097*             DATASET   ('ELCRTO')
 13098*          END-EXEC
 13099     MOVE 'ELCRTO' TO DFHEIV1
 13100*    MOVE '&(                    &   #00012272' TO DFHEIV0
 13101     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13102     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13103     MOVE X'2020233030303132323732' TO DFHEIV0(25:11)
 13104     CALL 'kxdfhei1' USING DFHEIV0,
 13105           DFHEIV1,
 13106           DFHEIV99,
 13107           DFHEIV99,
 13108           DFHEIV99,
 13109           DFHEIV99
 13110     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13111        END-IF
 13112     END-IF
 13113******************************************************************
 13114*                                                                *
 13115*       DELETE PENDING MAILING ADDRESS RECORDS                   *
 13116*                                                                *
 13117******************************************************************
 13118
 13119* EXEC CICS HANDLE CONDITION
 13120*        NOTFND    (1405-DELETE-CERTIFICATE)
 13121*    END-EXEC.
 13122*    MOVE '"$I                   ! , #00012282' TO DFHEIV0
 13123     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13124     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13125     MOVE X'2C20233030303132323832' TO DFHEIV0(25:11)
 13126     CALL 'kxdfhei1' USING DFHEIV0
 13127     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 239
* EL6311.cbl
 13128
 13129
 13130
 13131* EXEC CICS READ
 13132*        EQUAL
 13133*        DATASET   (FILE-ID-ERPNDM)
 13134*        SET       (ADDRESS OF PENDING-MAILING-DATA)
 13135*        RIDFLD    (PI-PREV-CONTROL-PRIMARY)
 13136*        UPDATE
 13137*    END-EXEC.
 13138*    MOVE '&"S        EU         (   #00012286' TO DFHEIV0
 13139     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13140     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13141     MOVE X'2020233030303132323836' TO DFHEIV0(25:11)
 13142     CALL 'kxdfhei1' USING DFHEIV0,
 13143           FILE-ID-ERPNDM,
 13144           DFHEIV20,
 13145           DFHEIV99,
 13146           PI-PREV-CONTROL-PRIMARY,
 13147           DFHEIV99,
 13148           DFHEIV99,
 13149           DFHEIV99
 13150     SET ADDRESS OF PENDING-MAILING-DATA TO
 13151         DFHEIV20
 13152     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13153
 13154
 13155     MOVE FILE-ID-ERPNDM         TO  JP-FILE-ID.
 13156     MOVE 'D'                    TO  JP-RECORD-TYPE.
 13157     MOVE PENDING-MAILING-DATA   TO  JP-RECORD-AREA.
 13158
 13159     MOVE ERPNDM-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 13160
 13161
 13162* EXEC CICS DELETE
 13163*        DATASET   (FILE-ID-ERPNDM)
 13164*    END-EXEC.
 13165*    MOVE '&(                    &   #00012300' TO DFHEIV0
 13166     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13167     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13168     MOVE X'2020233030303132333030' TO DFHEIV0(25:11)
 13169     CALL 'kxdfhei1' USING DFHEIV0,
 13170           FILE-ID-ERPNDM,
 13171           DFHEIV99,
 13172           DFHEIV99,
 13173           DFHEIV99,
 13174           DFHEIV99
 13175     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13176
 13177
 13178******************************************************************
 13179*                PROCESS   CERTIFICATE                           *
 13180******************************************************************
 13181
 13182 1405-DELETE-CERTIFICATE.
 13183
 13184* EXEC CICS HANDLE CONDITION
 13185*         NOTFND  (1420-CONTINUE-DELETE)
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 240
* EL6311.cbl
 13186*    END-EXEC.
 13187*    MOVE '"$I                   ! - #00012309' TO DFHEIV0
 13188     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13189     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13190     MOVE X'2D20233030303132333039' TO DFHEIV0(25:11)
 13191     CALL 'kxdfhei1' USING DFHEIV0
 13192     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13193
 13194
 13195     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 13196     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 13197     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 13198     MOVE PB-SV-STATE            TO ELCERT-STATE.
 13199
 13200
 13201* EXEC CICS READ
 13202*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 13203*        DATASET (FILE-ID-ELCERT)
 13204*        RIDFLD  (ELCERT-KEY)
 13205*        UPDATE
 13206*    END-EXEC.
 13207*    MOVE '&"S        EU         (   #00012318' TO DFHEIV0
 13208     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13209     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13210     MOVE X'2020233030303132333138' TO DFHEIV0(25:11)
 13211     CALL 'kxdfhei1' USING DFHEIV0,
 13212           FILE-ID-ELCERT,
 13213           DFHEIV20,
 13214           DFHEIV99,
 13215           ELCERT-KEY,
 13216           DFHEIV99,
 13217           DFHEIV99,
 13218           DFHEIV99
 13219     SET ADDRESS OF CERTIFICATE-MASTER TO
 13220         DFHEIV20
 13221     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13222
 13223
 13224     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 13225
 13226     MOVE FILE-ID-ELCERT         TO JP-FILE-ID.
 13227     MOVE 'B'                    TO JP-RECORD-TYPE
 13228     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 13229
 13230     PERFORM 8400-LOG-JOURNAL-RECORD.
 13231
 13232     IF CERT-NOTES-ARE-NOT-PRESENT
 13233        MOVE ' '                 TO WS-CERT-NOTE-SW
 13234     ELSE
 13235        MOVE 'Y'                 TO WS-CERT-NOTE-SW.
 13236
 13237     IF INSURED-ADDR-PRESENT
 13238        MOVE 'Y'                 TO WS-CERT-ADDRESS-SW.
 13239
 13240******************************************************************
 13241******* THIS CODE SHOULD BYPASS SETTING THE CLAIM-INTERFACE-SW  **
 13242******* IF THE CERTIFICATE HAS ALREADY GONE THROUGH A MONTH END **
 13243******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 241
* EL6311.cbl
 13244******************************************************************
 13245
 13246     IF CERT-ADDED-BATCH AND
 13247        (NOT NO-CLAIM-ATTACHED
 13248         OR
 13249         CM-CLAIM-ATTACHED-COUNT GREATER THAN +0)
 13250        GO TO 1410-REWRITE-CERT.
 13251
 13252******************************************************************
 13253******************************************************************
 13254
 13255     IF CERT-ADDED-BATCH  AND
 13256        (NO-CLAIM-ATTACHED OR CM-CLAIM-ATTACHED-COUNT = ZEROS)
 13257        GO TO 1410-REWRITE-CERT.
 13258
 13259     IF NO-CLAIM-ATTACHED
 13260        NEXT SENTENCE
 13261     ELSE
 13262        MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-1
 13263        MOVE '2'                    TO CM-CLAIM-INTERFACE-SW
 13264        GO TO 1410-REWRITE-CERT.
 13265
 13266     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 13267     MOVE 'D'                      TO JP-RECORD-TYPE.
 13268     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 13269
 13270
 13271* EXEC CICS DELETE
 13272*         DATASET    (FILE-ID-ELCERT)
 13273*    END-EXEC.
 13274*    MOVE '&(                    &   #00012371' TO DFHEIV0
 13275     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13276     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13277     MOVE X'2020233030303132333731' TO DFHEIV0(25:11)
 13278     CALL 'kxdfhei1' USING DFHEIV0,
 13279           FILE-ID-ELCERT,
 13280           DFHEIV99,
 13281           DFHEIV99,
 13282           DFHEIV99,
 13283           DFHEIV99
 13284     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13285
 13286
 13287     PERFORM 8400-LOG-JOURNAL-RECORD.
 13288
 13289******************************************************************
 13290*                                                                *
 13291*       DELETE CERTIFICATE NOTES FOR ALL DELETED CERTIFICATES    *
 13292*                                                                *
 13293******************************************************************
 13294
 13295     IF  CERT-NOTES-ARE-PRESENT
 13296         NEXT SENTENCE
 13297     ELSE
 13298         GO TO 1407-DELETE-MAILING.
 13299
 13300
 13301* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 242
* EL6311.cbl
 13302*         NOTFND  (1406-DELETE-ERNOTE)
 13303*    END-EXEC.
 13304*    MOVE '"$I                   ! . #00012388' TO DFHEIV0
 13305     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13306     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13307     MOVE X'2E20233030303132333838' TO DFHEIV0(25:11)
 13308     CALL 'kxdfhei1' USING DFHEIV0
 13309     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13310
 13311
 13312     MOVE ELCERT-KEY            TO ERCNOT-KEY.
 13313     MOVE '0'                   TO ERCNOT-REC-TYPE.
 13314     MOVE 0                     TO ERCNOT-SEQUENCE.
 13315
 13316 1406-DELETE-ERCNOT-LOOP.
 13317
 13318
 13319* EXEC CICS READ
 13320*        GTEQ
 13321*        DATASET   (FILE-ID-ERCNOT)
 13322*        SET       (ADDRESS OF CERT-NOTE-FILE)
 13323*        RIDFLD    (ERCNOT-KEY)
 13324*    END-EXEC.
 13325*    MOVE '&"S        G          (   #00012398' TO DFHEIV0
 13326     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 13327     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13328     MOVE X'2020233030303132333938' TO DFHEIV0(25:11)
 13329     CALL 'kxdfhei1' USING DFHEIV0,
 13330           FILE-ID-ERCNOT,
 13331           DFHEIV20,
 13332           DFHEIV99,
 13333           ERCNOT-KEY,
 13334           DFHEIV99,
 13335           DFHEIV99,
 13336           DFHEIV99
 13337     SET ADDRESS OF CERT-NOTE-FILE TO
 13338         DFHEIV20
 13339     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13340
 13341
 13342     MOVE CZ-CONTROL-PRIMARY      TO ERCNOT-KEY
 13343     IF ERCNOT-PART-KEY NOT EQUAL ELCERT-KEY
 13344         GO TO 1406-DELETE-ERNOTE
 13345     END-IF.
 13346
 13347     MOVE FILE-ID-ERCNOT         TO  JP-FILE-ID.
 13348     MOVE 'D'                    TO  JP-RECORD-TYPE.
 13349     MOVE CERT-NOTE-FILE         TO  JP-RECORD-AREA.
 13350
 13351     MOVE ERCNOT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 13352
 13353
 13354* EXEC CICS DELETE
 13355*        DATASET   (FILE-ID-ERCNOT)
 13356*        RIDFLD    (ERCNOT-KEY)
 13357*        END-EXEC.
 13358*    MOVE '&(  R                 &   #00012416' TO DFHEIV0
 13359     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 243
* EL6311.cbl
 13360     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13361     MOVE X'2020233030303132343136' TO DFHEIV0(25:11)
 13362     CALL 'kxdfhei1' USING DFHEIV0,
 13363           FILE-ID-ERCNOT,
 13364           ERCNOT-KEY,
 13365           DFHEIV99,
 13366           DFHEIV99,
 13367           DFHEIV99
 13368     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13369
 13370
 13371     PERFORM 8400-LOG-JOURNAL-RECORD.
 13372
 13373     GO TO 1406-DELETE-ERCNOT-LOOP.
 13374
 13375 1406-DELETE-ERNOTE.
 13376
 13377
 13378* EXEC CICS HANDLE CONDITION
 13379*         NOTFND  (1407-DELETE-MAILING)
 13380*    END-EXEC.
 13381*    MOVE '"$I                   ! / #00012427' TO DFHEIV0
 13382     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13383     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13384     MOVE X'2F20233030303132343237' TO DFHEIV0(25:11)
 13385     CALL 'kxdfhei1' USING DFHEIV0
 13386     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13387
 13388
 13389*    EXEC CICS READ
 13390*        EQUAL
 13391*        DATASET   (FILE-ID-ERNOTE)
 13392*        SET       (ADDRESS OF CERTIFICATE-NOTE)
 13393*        RIDFLD    (ELCERT-KEY)
 13394*        UPDATE
 13395*    END-EXEC.
 13396
 13397     MOVE FILE-ID-ERNOTE         TO  JP-FILE-ID.
 13398     MOVE 'D'                    TO  JP-RECORD-TYPE.
 13399     MOVE CERTIFICATE-NOTE       TO  JP-RECORD-AREA.
 13400
 13401     MOVE ERNOTE-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 13402
 13403
 13404* exec cics delete
 13405*       dataset       ('ERNOTE')
 13406*       keylength     (33)
 13407*       ridfld        (elcert-key)
 13408*       generic
 13409*    end-exec
 13410     MOVE 'ERNOTE' TO DFHEIV1
 13411     MOVE 33
 13412       TO DFHEIV11
 13413*    MOVE '&(  RKG               &   #00012445' TO DFHEIV0
 13414     MOVE X'26282020524B472020202020' TO DFHEIV0(1:12)
 13415     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13416     MOVE X'2020233030303132343435' TO DFHEIV0(25:11)
 13417     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 244
* EL6311.cbl
 13418           DFHEIV1,
 13419           elcert-key,
 13420           DFHEIV11,
 13421           DFHEIV99,
 13422           DFHEIV99
 13423     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13424*    EXEC CICS DELETE
 13425*        DATASET   (FILE-ID-ERNOTE)
 13426*        END-EXEC.
 13427
 13428     PERFORM 8400-LOG-JOURNAL-RECORD.
 13429
 13430******************************************************************
 13431*                                                                *
 13432*                DELETE MAILING ADDRESS RECORDS                  *
 13433*                                                                *
 13434******************************************************************
 13435
 13436 1407-DELETE-MAILING.
 13437     IF CERT-ADDRESS-PRESENT
 13438        NEXT SENTENCE
 13439     ELSE
 13440        GO TO 1420-CONTINUE-DELETE.
 13441
 13442
 13443* EXEC CICS HANDLE CONDITION
 13444*         NOTFND  (1420-CONTINUE-DELETE)
 13445*    END-EXEC.
 13446*    MOVE '"$I                   ! 0 #00012469' TO DFHEIV0
 13447     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13448     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13449     MOVE X'3020233030303132343639' TO DFHEIV0(25:11)
 13450     CALL 'kxdfhei1' USING DFHEIV0
 13451     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13452
 13453
 13454
 13455* EXEC CICS READ
 13456*        EQUAL
 13457*        DATASET   (FILE-ID-ERMAIL)
 13458*        SET       (ADDRESS OF MAILING-DATA)
 13459*        RIDFLD    (ELCERT-KEY)
 13460*        UPDATE
 13461*    END-EXEC.
 13462*    MOVE '&"S        EU         (   #00012473' TO DFHEIV0
 13463     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13464     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13465     MOVE X'2020233030303132343733' TO DFHEIV0(25:11)
 13466     CALL 'kxdfhei1' USING DFHEIV0,
 13467           FILE-ID-ERMAIL,
 13468           DFHEIV20,
 13469           DFHEIV99,
 13470           ELCERT-KEY,
 13471           DFHEIV99,
 13472           DFHEIV99,
 13473           DFHEIV99
 13474     SET ADDRESS OF MAILING-DATA TO
 13475         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 245
* EL6311.cbl
 13476     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13477
 13478
 13479     MOVE FILE-ID-ERMAIL         TO  JP-FILE-ID.
 13480     MOVE 'D'                    TO  JP-RECORD-TYPE.
 13481     MOVE MAILING-DATA           TO  JP-RECORD-AREA.
 13482
 13483     MOVE ERMAIL-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 13484
 13485
 13486* EXEC CICS DELETE
 13487*        DATASET   (FILE-ID-ERMAIL)
 13488*    END-EXEC.
 13489*    MOVE '&(                    &   #00012487' TO DFHEIV0
 13490     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13491     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13492     MOVE X'2020233030303132343837' TO DFHEIV0(25:11)
 13493     CALL 'kxdfhei1' USING DFHEIV0,
 13494           FILE-ID-ERMAIL,
 13495           DFHEIV99,
 13496           DFHEIV99,
 13497           DFHEIV99,
 13498           DFHEIV99
 13499     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13500
 13501
 13502     GO TO 1420-CONTINUE-DELETE.
 13503
 13504 1410-REWRITE-CERT.
 13505     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 13506     MOVE 'C'                      TO JP-RECORD-TYPE.
 13507     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 13508     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 13509
 13510
 13511* EXEC CICS REWRITE
 13512*         DATASET    (FILE-ID-ELCERT)
 13513*         FROM       (CERTIFICATE-MASTER)
 13514*         END-EXEC.
 13515     MOVE LENGTH OF
 13516      CERTIFICATE-MASTER
 13517       TO DFHEIV11
 13518*    MOVE '&& L                  %   #00012499' TO DFHEIV0
 13519     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13520     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13521     MOVE X'2020233030303132343939' TO DFHEIV0(25:11)
 13522     CALL 'kxdfhei1' USING DFHEIV0,
 13523           FILE-ID-ELCERT,
 13524           CERTIFICATE-MASTER,
 13525           DFHEIV11,
 13526           DFHEIV99
 13527     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13528
 13529
 13530     PERFORM 8400-LOG-JOURNAL-RECORD.
 13531
 13532 1420-CONTINUE-DELETE.
 13533     SUBTRACT PB-I-LF-PREMIUM-AMT FROM WS-B-LF-ISS-PRM-ENTERED.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 246
* EL6311.cbl
 13534     SUBTRACT PB-I-LF-PREM-CALC   FROM WS-B-LF-ISS-PRM-COMPUTED.
 13535
 13536     SUBTRACT PB-I-AH-PREMIUM-AMT FROM WS-B-AH-ISS-PRM-ENTERED.
 13537     SUBTRACT PB-I-AH-PREM-CALC   FROM WS-B-AH-ISS-PRM-COMPUTED.
 13538
 13539     SUBTRACT +1 FROM WS-B-ISSUE-CNT-ENTERED.
 13540
 13541 1450-DELETE-PB-RECORD.
 13542     MOVE FILE-ID-ERPNDB           TO JP-FILE-ID
 13543     MOVE 'D'                      TO JP-RECORD-TYPE
 13544     MOVE PENDING-BUSINESS         TO JP-RECORD-AREA.
 13545
 13546
 13547* EXEC CICS DELETE
 13548*        DATASET    (FILE-ID-ERPNDB)
 13549*    END-EXEC.
 13550*    MOVE '&(                    &   #00012520' TO DFHEIV0
 13551     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13552     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13553     MOVE X'2020233030303132353230' TO DFHEIV0(25:11)
 13554     CALL 'kxdfhei1' USING DFHEIV0,
 13555           FILE-ID-ERPNDB,
 13556           DFHEIV99,
 13557           DFHEIV99,
 13558           DFHEIV99,
 13559           DFHEIV99
 13560     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13561
 13562
 13563     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 13564
 13565     PERFORM 8400-LOG-JOURNAL-RECORD *> Journal Delete
 13566
 13567     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 13568     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 13569     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 13570
 13571
 13572* EXEC CICS HANDLE CONDITION
 13573*         NOTFND    (1480-BATCH-HDR-NOT-FOUND)
 13574*    END-EXEC.
 13575*    MOVE '"$I                   ! 1 #00012532' TO DFHEIV0
 13576     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13577     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13578     MOVE X'3120233030303132353332' TO DFHEIV0(25:11)
 13579     CALL 'kxdfhei1' USING DFHEIV0
 13580     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13581
 13582
 13583
 13584* EXEC CICS READ
 13585*        SET     (ADDRESS OF PENDING-BUSINESS)
 13586*        DATASET (FILE-ID-ERPNDB)
 13587*        RIDFLD  (ERPNDB-KEY)
 13588*        UPDATE
 13589*    END-EXEC.
 13590*    MOVE '&"S        EU         (   #00012536' TO DFHEIV0
 13591     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 247
* EL6311.cbl
 13592     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13593     MOVE X'2020233030303132353336' TO DFHEIV0(25:11)
 13594     CALL 'kxdfhei1' USING DFHEIV0,
 13595           FILE-ID-ERPNDB,
 13596           DFHEIV20,
 13597           DFHEIV99,
 13598           ERPNDB-KEY,
 13599           DFHEIV99,
 13600           DFHEIV99,
 13601           DFHEIV99
 13602     SET ADDRESS OF PENDING-BUSINESS TO
 13603         DFHEIV20
 13604     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13605
 13606
 13607     MOVE ERPNDB-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 13608
 13609     MOVE  FILE-ID-ERPNDB          TO JP-FILE-ID.
 13610
 13611     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 13612        WS-B-CANCEL-CNT-ENTERED = ZEROS
 13613        MOVE 'D'                   TO JP-RECORD-TYPE
 13614        MOVE PENDING-BUSINESS      TO JP-RECORD-AREA
 13615
 13616* EXEC CICS DELETE
 13617*            DATASET    (FILE-ID-ERPNDB)
 13618*       END-EXEC
 13619*    MOVE '&(                    &   #00012551' TO DFHEIV0
 13620     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13621     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13622     MOVE X'2020233030303132353531' TO DFHEIV0(25:11)
 13623     CALL 'kxdfhei1' USING DFHEIV0,
 13624           FILE-ID-ERPNDB,
 13625           DFHEIV99,
 13626           DFHEIV99,
 13627           DFHEIV99,
 13628           DFHEIV99
 13629     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13630        PERFORM 8400-LOG-JOURNAL-RECORD  *> Journal Delete
 13631     ELSE
 13632        MOVE 'B'                 TO JP-RECORD-TYPE
 13633        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 13634        PERFORM 8400-LOG-JOURNAL-RECORD  *> Before Image
 13635        MOVE WS-BATCH-RECORD     TO PB-BATCH-RECORD
 13636        MOVE 'C'                 TO JP-RECORD-TYPE
 13637        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 13638
 13639* EXEC CICS REWRITE
 13640*            DATASET    (FILE-ID-ERPNDB)
 13641*            FROM       (PENDING-BUSINESS)
 13642*       END-EXEC
 13643     MOVE LENGTH OF
 13644      PENDING-BUSINESS
 13645       TO DFHEIV11
 13646*    MOVE '&& L                  %   #00012562' TO DFHEIV0
 13647     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13648     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13649     MOVE X'2020233030303132353632' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 248
* EL6311.cbl
 13650     CALL 'kxdfhei1' USING DFHEIV0,
 13651           FILE-ID-ERPNDB,
 13652           PENDING-BUSINESS,
 13653           DFHEIV11,
 13654           DFHEIV99
 13655     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13656        PERFORM 8400-LOG-JOURNAL-RECORD  *> After Image
 13657     end-if
 13658******************************************************************
 13659*                                                                *
 13660*       DELETE THE A/R REQUEST RECORD IF THE COMPANY USES        *
 13661*       THE ACCOUNTS RECEIVABLE SYSTEM.                          *
 13662*                                                                *
 13663******************************************************************
 13664
 13665     IF NOT PI-AR-PROCESSING
 13666        GO TO 1475-DELETE-FINISHED.
 13667
 13668     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 13669        WS-B-CANCEL-CNT-ENTERED = ZEROS
 13670        NEXT SENTENCE
 13671     ELSE
 13672        GO TO 1475-DELETE-FINISHED.
 13673
 13674
 13675* EXEC CICS HANDLE CONDITION
 13676*         NOTFND    (1475-DELETE-FINISHED)
 13677*         END-EXEC.
 13678*    MOVE '"$I                   ! 2 #00012584' TO DFHEIV0
 13679     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13680     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13681     MOVE X'3220233030303132353834' TO DFHEIV0(25:11)
 13682     CALL 'kxdfhei1' USING DFHEIV0
 13683     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13684
 13685
 13686     MOVE ERPNDB-COMPANY-CD      TO ERRQST-COMPANY-CD.
 13687     MOVE ERPNDB-ENTRY-BATCH     TO ERRQST-ENTRY-BATCH.
 13688
 13689
 13690* EXEC CICS READ
 13691*        SET     (ADDRESS OF AR-REQUEST-RECORD)
 13692*        DATASET (FILE-ID-ERRQST)
 13693*        RIDFLD  (ERRQST-KEY)
 13694*        UPDATE
 13695*    END-EXEC.
 13696*    MOVE '&"S        EU         (   #00012591' TO DFHEIV0
 13697     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13698     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13699     MOVE X'2020233030303132353931' TO DFHEIV0(25:11)
 13700     CALL 'kxdfhei1' USING DFHEIV0,
 13701           FILE-ID-ERRQST,
 13702           DFHEIV20,
 13703           DFHEIV99,
 13704           ERRQST-KEY,
 13705           DFHEIV99,
 13706           DFHEIV99,
 13707           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 249
* EL6311.cbl
 13708     SET ADDRESS OF AR-REQUEST-RECORD TO
 13709         DFHEIV20
 13710     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13711
 13712
 13713     MOVE ERRQST-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 13714
 13715     MOVE  FILE-ID-ERRQST          TO JP-FILE-ID.
 13716
 13717     MOVE 'D'                      TO JP-RECORD-TYPE.
 13718     MOVE AR-REQUEST-RECORD        TO JP-RECORD-AREA.
 13719
 13720
 13721* EXEC CICS DELETE
 13722*         DATASET    (FILE-ID-ERRQST)
 13723*    END-EXEC.
 13724*    MOVE '&(                    &   #00012605' TO DFHEIV0
 13725     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13726     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13727     MOVE X'2020233030303132363035' TO DFHEIV0(25:11)
 13728     CALL 'kxdfhei1' USING DFHEIV0,
 13729           FILE-ID-ERRQST,
 13730           DFHEIV99,
 13731           DFHEIV99,
 13732           DFHEIV99,
 13733           DFHEIV99
 13734     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13735
 13736
 13737     PERFORM 8400-LOG-JOURNAL-RECORD.
 13738
 13739 1475-DELETE-FINISHED.
 13740     MOVE ZEROS                  TO EMI-ERROR.
 13741     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13742     MOVE LOW-VALUES             TO EL631BI.
 13743     MOVE -1                     TO BMAINTL.
 13744     GO TO 8100-SEND-INITIAL-MAP.
 13745
 13746 1480-BATCH-HDR-NOT-FOUND.
 13747     MOVE -1                     TO BMAINTL.
 13748     MOVE ER-7450                TO EMI-ERROR.
 13749     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13750     GO TO 8200-SEND-DATAONLY.
 13751
 13752 1490-RECORD-NOT-FOUND.
 13753     MOVE -1                     TO BMAINTL.
 13754     MOVE ER-7451                TO EMI-ERROR.
 13755     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13756     GO TO 8200-SEND-DATAONLY.
 13757
 13758******************************************************************
 13759*            O V E R   C H A R G E   P R O C E S S I N G         *
 13760******************************************************************
 13761 1500-UPDATE-ERNOTE.
 13762     PERFORM 1510-ADD-ERNOTE-REC THRU 1510-EXIT
 13763     MOVE 'A'                    TO WS-NOTE-SW
 13764     PERFORM 1520-UPDATE-ELCERT  THRU 1520-EXIT
 13765     .
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 250
* EL6311.cbl
 13766 1500-EXIT.
 13767     EXIT.
 13768 1510-ADD-ERNOTE-REC.
 13769
 13770* EXEC CICS GETMAIN
 13771*        SET     (ADDRESS OF CERTIFICATE-NOTE)
 13772*        LENGTH  (ERNOTE-RECORD-LENGTH)
 13773*        INITIMG (GETMAIN-SPACE)
 13774*    END-EXEC
 13775*    MOVE ',"IL                  $   #00012641' TO DFHEIV0
 13776     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13777     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13778     MOVE X'2020233030303132363431' TO DFHEIV0(25:11)
 13779     CALL 'kxdfhei1' USING DFHEIV0,
 13780           DFHEIV20,
 13781           ERNOTE-RECORD-LENGTH,
 13782           GETMAIN-SPACE
 13783     SET ADDRESS OF CERTIFICATE-NOTE TO
 13784         DFHEIV20
 13785     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13786     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13787                                 TO ERNOTE-KEY
 13788     move '1'                    to ernote-record-type
 13789
 13790* EXEC CICS READ
 13791*       DATASET    (FILE-ID-ERNOTE)
 13792*       RIDFLD     (ERNOTE-KEY)
 13793*       INTO       (CERTIFICATE-NOTE)
 13794*       RESP       (WS-RESPONSE)
 13795*       UPDATE
 13796*    END-EXEC
 13797     MOVE LENGTH OF
 13798      CERTIFICATE-NOTE
 13799       TO DFHEIV11
 13800*    MOVE '&"IL       EU         (  N#00012649' TO DFHEIV0
 13801     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 13802     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13803     MOVE X'204E233030303132363439' TO DFHEIV0(25:11)
 13804     CALL 'kxdfhei1' USING DFHEIV0,
 13805           FILE-ID-ERNOTE,
 13806           CERTIFICATE-NOTE,
 13807           DFHEIV11,
 13808           ERNOTE-KEY,
 13809           DFHEIV99,
 13810           DFHEIV99,
 13811           DFHEIV99
 13812     MOVE EIBRESP  TO WS-RESPONSE
 13813     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13814     IF RESP-NORMAL
 13815        IF CN-BILLING-START-LINE-NO NOT NUMERIC
 13816           MOVE ZEROS            TO CN-BILLING-START-LINE-NO
 13817        END-IF
 13818        IF CN-BILLING-END-LINE-NO NOT NUMERIC
 13819           MOVE ZEROS            TO CN-BILLING-END-LINE-NO
 13820        END-IF
 13821        PERFORM VARYING N1 FROM +1 BY +1 UNTIL
 13822           (N1 > +10)
 13823           OR (CN-LINE (N1) (1:10) = 'OVERCHARGE')
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 251
* EL6311.cbl
 13824           OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 13825        END-PERFORM
 13826        IF (CN-LINE (N1) (1:10) = 'OVERCHARGE')
 13827          OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 13828
 13829* EXEC CICS UNLOCK
 13830*            DATASET    (FILE-ID-ERNOTE)
 13831*          END-EXEC
 13832*    MOVE '&*                    #   #00012670' TO DFHEIV0
 13833     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 13834     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13835     MOVE X'2020233030303132363730' TO DFHEIV0(25:11)
 13836     CALL 'kxdfhei1' USING DFHEIV0,
 13837           FILE-ID-ERNOTE,
 13838           DFHEIV99
 13839     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13840        ELSE
 13841          PERFORM VARYING N1 FROM +1 BY +1
 13842           UNTIL (N1 > +10)
 13843           OR (CN-LINE (N1) = SPACES OR LOW-VALUES)
 13844          END-PERFORM
 13845          IF (N1 < +11)
 13846            IF N1 >= CN-BILLING-START-LINE-NO AND
 13847              N1 <= CN-BILLING-END-LINE-NO
 13848              IF PI-COMPANY-ID = 'DCC' or 'VPP'
 13849                 MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13850              ELSE
 13851                 MOVE WS-VA-NO-COMM-MESS
 13852                                    TO CN-LINE (N1)
 13853              END-IF
 13854            ELSE
 13855              IF (CN-BILLING-END-LINE-NO NOT = ZEROS) AND
 13856               (N1 = (CN-BILLING-END-LINE-NO + +1))
 13857                IF PI-COMPANY-ID = 'DCC' or 'VPP'
 13858                  MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13859                ELSE
 13860                  MOVE WS-VA-NO-COMM-MESS
 13861                                    TO CN-LINE (N1)
 13862                END-IF
 13863                MOVE N1             TO CN-BILLING-END-LINE-NO
 13864              ELSE
 13865                IF (CN-BILLING-END-LINE-NO = ZEROS)
 13866                  IF PI-COMPANY-ID = 'DCC' or 'VPP'
 13867                     MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13868                  ELSE
 13869                     MOVE WS-VA-NO-COMM-MESS
 13870                                    TO CN-LINE (N1)
 13871                  END-IF
 13872                  MOVE N1            TO CN-BILLING-END-LINE-NO
 13873                                      CN-BILLING-START-LINE-NO
 13874                ELSE
 13875                  IF (CN-BILLING-START-LINE-NO NOT = ZEROS) AND
 13876                    (N1 = (CN-BILLING-START-LINE-NO - +1))
 13877                     IF PI-COMPANY-ID = 'DCC' or 'VPP'
 13878                       MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13879                     ELSE
 13880                       MOVE WS-VA-NO-COMM-MESS
 13881                                    TO CN-LINE (N1)
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 252
* EL6311.cbl
 13882                     END-IF
 13883                     MOVE N1         TO CN-BILLING-START-LINE-NO
 13884                  ELSE
 13885                     PERFORM 1700-SQUEEZE-IT-IN
 13886                                 THRU 1700-EXIT
 13887                  END-IF
 13888                END-IF
 13889              END-IF
 13890            END-IF
 13891            MOVE 'E631'              TO CN-LAST-MAINT-USER
 13892            MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
 13893            MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
 13894
 13895* EXEC CICS REWRITE
 13896*              DATASET    (FILE-ID-ERNOTE)
 13897*              FROM       (CERTIFICATE-NOTE)
 13898*              RESP       (WS-RESPONSE)
 13899*           END-EXEC
 13900     MOVE LENGTH OF
 13901      CERTIFICATE-NOTE
 13902       TO DFHEIV11
 13903*    MOVE '&& L                  %  N#00012727' TO DFHEIV0
 13904     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13905     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13906     MOVE X'204E233030303132373237' TO DFHEIV0(25:11)
 13907     CALL 'kxdfhei1' USING DFHEIV0,
 13908           FILE-ID-ERNOTE,
 13909           CERTIFICATE-NOTE,
 13910           DFHEIV11,
 13911           DFHEIV99
 13912     MOVE EIBRESP  TO WS-RESPONSE
 13913     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13914          END-IF
 13915        END-IF
 13916     ELSE
 13917        MOVE SPACES              TO CERTIFICATE-NOTE
 13918        MOVE 'CN'                TO CN-RECORD-ID
 13919        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13920                                 TO CN-CONTROL-PRIMARY
 13921                                    ERNOTE-KEY
 13922        move '1'                 to cn-record-type
 13923                                    ernote-record-type
 13924        MOVE 01                  TO CN-BILLING-START-LINE-NO
 13925                                    CN-BILLING-END-LINE-NO
 13926        IF PI-COMPANY-ID = 'DCC' or 'VPP'
 13927           MOVE WS-OC-MESSAGE    TO CN-LINE (1)
 13928        ELSE
 13929           MOVE WS-VA-NO-COMM-MESS
 13930                                 TO CN-LINE (1)
 13931        END-IF
 13932        MOVE 'E631'              TO CN-LAST-MAINT-USER
 13933        MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
 13934        MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
 13935
 13936* EXEC CICS WRITE
 13937*          DATASET    (FILE-ID-ERNOTE)
 13938*          FROM       (CERTIFICATE-NOTE)
 13939*          RIDFLD     (ERNOTE-KEY)
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 253
* EL6311.cbl
 13940*          RESP       (WS-RESPONSE)
 13941*       END-EXEC
 13942     MOVE LENGTH OF
 13943      CERTIFICATE-NOTE
 13944       TO DFHEIV11
 13945*    MOVE '&$ L                  ''  N#00012753' TO DFHEIV0
 13946     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13947     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13948     MOVE X'204E233030303132373533' TO DFHEIV0(25:11)
 13949     CALL 'kxdfhei1' USING DFHEIV0,
 13950           FILE-ID-ERNOTE,
 13951           CERTIFICATE-NOTE,
 13952           DFHEIV11,
 13953           ERNOTE-KEY,
 13954           DFHEIV99,
 13955           DFHEIV99
 13956     MOVE EIBRESP  TO WS-RESPONSE
 13957     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13958     END-IF
 13959     .
 13960 1510-EXIT.
 13961     EXIT.
 13962 1520-UPDATE-ELCERT.
 13963     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13964                                 TO ELCERT-KEY
 13965
 13966* EXEC CICS READ
 13967*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 13968*        DATASET (FILE-ID-ELCERT)
 13969*        RIDFLD  (ELCERT-KEY)
 13970*        UPDATE
 13971*        RESP    (WS-RESPONSE)
 13972*    END-EXEC
 13973*    MOVE '&"S        EU         (  N#00012766' TO DFHEIV0
 13974     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13975     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13976     MOVE X'204E233030303132373636' TO DFHEIV0(25:11)
 13977     CALL 'kxdfhei1' USING DFHEIV0,
 13978           FILE-ID-ELCERT,
 13979           DFHEIV20,
 13980           DFHEIV99,
 13981           ELCERT-KEY,
 13982           DFHEIV99,
 13983           DFHEIV99,
 13984           DFHEIV99
 13985     SET ADDRESS OF CERTIFICATE-MASTER TO
 13986         DFHEIV20
 13987     MOVE EIBRESP  TO WS-RESPONSE
 13988     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13989     IF RESP-NORMAL
 13990        IF WS-NOTE-SW = 'A'
 13991           IF CM-NOTE-SW = ' '
 13992              MOVE '2'             TO CM-NOTE-SW
 13993           ELSE
 13994             IF CM-NOTE-SW = '1'
 13995                MOVE '3'           TO CM-NOTE-SW
 13996             ELSE
 13997               IF CM-NOTE-SW = '4'
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 254
* EL6311.cbl
 13998                  MOVE '6'         TO CM-NOTE-SW
 13999               ELSE
 14000                 IF CM-NOTE-SW = '5'
 14001                    MOVE '7'       TO CM-NOTE-SW
 14002                 END-IF
 14003               END-IF
 14004             END-IF
 14005           END-IF
 14006        ELSE
 14007           IF CM-NOTE-SW = '2'
 14008              MOVE ' '             TO CM-NOTE-SW
 14009           ELSE
 14010             IF CM-NOTE-SW = '3'
 14011                MOVE '1'           TO CM-NOTE-SW
 14012             ELSE
 14013               IF CM-NOTE-SW = '6'
 14014                  MOVE '4'         TO CM-NOTE-SW
 14015               ELSE
 14016                 IF CM-NOTE-SW = '7'
 14017                    MOVE '5'       TO CM-NOTE-SW
 14018                 END-IF
 14019               END-IF
 14020             END-IF
 14021           END-IF
 14022        END-IF
 14023
 14024* EXEC CICS REWRITE
 14025*          DATASET    (FILE-ID-ELCERT)
 14026*          FROM       (CERTIFICATE-MASTER)
 14027*          RESP       (WS-RESPONSE)
 14028*       END-EXEC
 14029     MOVE LENGTH OF
 14030      CERTIFICATE-MASTER
 14031       TO DFHEIV11
 14032*    MOVE '&& L                  %  N#00012807' TO DFHEIV0
 14033     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 14034     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 14035     MOVE X'204E233030303132383037' TO DFHEIV0(25:11)
 14036     CALL 'kxdfhei1' USING DFHEIV0,
 14037           FILE-ID-ELCERT,
 14038           CERTIFICATE-MASTER,
 14039           DFHEIV11,
 14040           DFHEIV99
 14041     MOVE EIBRESP  TO WS-RESPONSE
 14042     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14043        IF RESP-NORMAL
 14044           CONTINUE
 14045        ELSE
 14046           MOVE WS-RESPONSE TO EMI-ERROR
 14047           PERFORM 9900-ERROR-FORMAT
 14048                                 THRU 9900-EXIT
 14049           GO TO 8200-SEND-DATAONLY
 14050        END-IF
 14051     ELSE
 14052        MOVE -1                  TO BMAINTL
 14053        MOVE 0249                TO EMI-ERROR
 14054        PERFORM 9900-ERROR-FORMAT
 14055                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 255
* EL6311.cbl
 14056        GO TO 8200-SEND-DATAONLY
 14057     END-IF
 14058     .
 14059 1520-EXIT.
 14060     EXIT.
 14061 1600-UPDATE-ERPYAJ.
 14062     PERFORM 1610-ADD-ERPYAJ-BANK-REC
 14063                                 THRU 1610-EXIT
 14064     PERFORM 1620-ADD-ERPYAJ-DLR-REC
 14065                                 THRU 1620-EXIT
 14066     .
 14067 1600-EXIT.
 14068     EXIT.
 14069 1610-ADD-ERPYAJ-BANK-REC.
 14070
 14071* EXEC CICS GETMAIN
 14072*        SET     (ADDRESS OF PENDING-PAY-ADJ)
 14073*        LENGTH  (ERPYAJ-RECORD-LENGTH)
 14074*        INITIMG (GETMAIN-SPACE)
 14075*    END-EXEC
 14076*    MOVE ',"IL                  $   #00012839' TO DFHEIV0
 14077     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 14078     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14079     MOVE X'2020233030303132383339' TO DFHEIV0(25:11)
 14080     CALL 'kxdfhei1' USING DFHEIV0,
 14081           DFHEIV20,
 14082           ERPYAJ-RECORD-LENGTH,
 14083           GETMAIN-SPACE
 14084     SET ADDRESS OF PENDING-PAY-ADJ TO
 14085         DFHEIV20
 14086     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14087     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 14088     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 14089     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 14090     MOVE PB-I-BANK-NUMBER       TO ERPYAJ-FIN-RESP
 14091     MOVE LOW-VALUES             TO ERPYAJ-ACCOUNT
 14092     MOVE +10                    TO ERPYAJ-SEQ-NO
 14093     MOVE 'R'                    TO ERPYAJ-TYPE
 14094     IF REVERSAL
 14095        MOVE 'C'                 TO ERPYAJ-TYPE
 14096     END-IF
 14097     MOVE SPACES                 TO PENDING-PAY-ADJ
 14098     MOVE 'PY'                   TO PY-RECORD-ID
 14099     MOVE ERPYAJ-KEY             TO PY-CONTROL-PRIMARY
 14100     MOVE WS-OC-AMT              TO PY-ENTRY-AMT
 14101     IF REVERSAL
 14102        MOVE PB-I-DCC-OVER-CHG-AMT
 14103                                 TO PY-ENTRY-AMT
 14104     END-IF
 14105     MOVE WS-CURRENT-BIN-DT      TO PY-LAST-MAINT-DT
 14106                                    PY-INPUT-DT
 14107*    MOVE X'A15F'                TO PY-LAST-MAINT-DT
 14108*                                   PY-INPUT-DT
 14109     MOVE PI-PROCESSOR-ID        TO PY-LAST-MAINT-BY
 14110     MOVE PI-CR-MONTH-END-DT     TO PY-CREDIT-SELECT-DT
 14111     MOVE 'OVERCHARGE'           TO PY-GL-COMMENT
 14112     MOVE 'B'                    TO PY-ERCOMP-TYPE
 14113     IF PB-CARRIER = '2'
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 256
* EL6311.cbl
 14114        MOVE '2725040330'        TO PY-GL-ACCOUNT
 14115     ELSE
 14116        MOVE '2725040130'        TO PY-GL-ACCOUNT
 14117     END-IF
 14118     MOVE LOW-VALUES             TO PY-CREDIT-ACCEPT-DT
 14119                                    PY-BILLED-DATE
 14120                                    PY-AR-DATE
 14121                                    PY-REPORTED-DT
 14122                                    PY-CHECK-WRITTEN-DT
 14123     MOVE ZEROS                  TO PY-CHECK-QUE-CONTROL
 14124                                    PY-CHECK-QUE-SEQUENCE
 14125     MOVE EIBTIME                TO PY-LAST-MAINT-HHMMSS
 14126     PERFORM WITH TEST AFTER
 14127        UNTIL (NOT RESP-DUPKEY)
 14128           AND (NOT RESP-DUPREC)
 14129
 14130* EXEC CICS WRITE
 14131*          DATASET    (FILE-ID-ERPYAJ)
 14132*          FROM       (PENDING-PAY-ADJ)
 14133*          RIDFLD     (ERPYAJ-KEY)
 14134*          RESP       (WS-RESPONSE)
 14135*       END-EXEC
 14136     MOVE LENGTH OF
 14137      PENDING-PAY-ADJ
 14138       TO DFHEIV11
 14139*    MOVE '&$ L                  ''  N#00012886' TO DFHEIV0
 14140     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 14141     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14142     MOVE X'204E233030303132383836' TO DFHEIV0(25:11)
 14143     CALL 'kxdfhei1' USING DFHEIV0,
 14144           FILE-ID-ERPYAJ,
 14145           PENDING-PAY-ADJ,
 14146           DFHEIV11,
 14147           ERPYAJ-KEY,
 14148           DFHEIV99,
 14149           DFHEIV99
 14150     MOVE EIBRESP  TO WS-RESPONSE
 14151     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14152        IF RESP-DUPKEY OR RESP-DUPREC
 14153           ADD +1                TO ERPYAJ-SEQ-NO
 14154           MOVE ERPYAJ-SEQ-NO    TO PY-FILE-SEQ-NO
 14155        END-IF
 14156     END-PERFORM
 14157     .
 14158 1610-EXIT.
 14159     EXIT.
 14160 1620-ADD-ERPYAJ-DLR-REC.
 14161     MOVE 'C'                    TO ERPYAJ-TYPE
 14162     IF REVERSAL
 14163        MOVE 'R'                 TO ERPYAJ-TYPE
 14164     END-IF
 14165     MOVE PB-ACCOUNT             TO ERPYAJ-FIN-RESP
 14166                                    ERPYAJ-ACCOUNT
 14167     ADD +1                      TO ERPYAJ-SEQ-NO
 14168     MOVE ERPYAJ-KEY             TO PY-CONTROL-PRIMARY
 14169     MOVE 'A'                    TO PY-ERCOMP-TYPE
 14170     IF PB-CARRIER = '2'
 14171        MOVE '2725040330'        TO PY-GL-ACCOUNT
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 257
* EL6311.cbl
 14172     ELSE
 14173        MOVE '2725040130'        TO PY-GL-ACCOUNT
 14174     END-IF
 14175     PERFORM WITH TEST AFTER
 14176        UNTIL (NOT RESP-DUPKEY)
 14177           AND (NOT RESP-DUPREC)
 14178
 14179* EXEC CICS WRITE
 14180*          DATASET    (FILE-ID-ERPYAJ)
 14181*          FROM       (PENDING-PAY-ADJ)
 14182*          RIDFLD     (ERPYAJ-KEY)
 14183*          RESP       (WS-RESPONSE)
 14184*       END-EXEC
 14185     MOVE LENGTH OF
 14186      PENDING-PAY-ADJ
 14187       TO DFHEIV11
 14188*    MOVE '&$ L                  ''  N#00012918' TO DFHEIV0
 14189     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 14190     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14191     MOVE X'204E233030303132393138' TO DFHEIV0(25:11)
 14192     CALL 'kxdfhei1' USING DFHEIV0,
 14193           FILE-ID-ERPYAJ,
 14194           PENDING-PAY-ADJ,
 14195           DFHEIV11,
 14196           ERPYAJ-KEY,
 14197           DFHEIV99,
 14198           DFHEIV99
 14199     MOVE EIBRESP  TO WS-RESPONSE
 14200     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14201        IF RESP-DUPKEY OR RESP-DUPREC
 14202           ADD +1                TO ERPYAJ-SEQ-NO
 14203           MOVE ERPYAJ-SEQ-NO    TO PY-FILE-SEQ-NO
 14204        END-IF
 14205     END-PERFORM
 14206     .
 14207 1620-EXIT.
 14208     EXIT.
 14209 1700-SQUEEZE-IT-IN.
 14210     IF (N1 > CN-BILLING-END-LINE-NO)
 14211        PERFORM VARYING N1 FROM N1 BY -1 UNTIL
 14212           N1 = +1
 14213           MOVE CN-LINE (N1 - 1)    TO CN-LINE (N1)
 14214           IF (N1 - 1) = (CN-BILLING-END-LINE-NO + 1)
 14215              IF PI-COMPANY-ID = 'DCC' or 'VPP'
 14216                 MOVE WS-OC-MESSAGE TO CN-LINE (N1 - 1)
 14217              ELSE
 14218                 MOVE WS-VA-NO-COMM-MESS TO CN-LINE (N1 - 1)
 14219              END-IF
 14220              COMPUTE CN-BILLING-END-LINE-NO = N1 - 1
 14221              MOVE +2 TO N1
 14222           END-IF
 14223        END-PERFORM
 14224     ELSE
 14225        IF (N1 < CN-BILLING-START-LINE-NO)
 14226           PERFORM VARYING N1 FROM N1 BY +1 UNTIL
 14227              N1 = +10
 14228              MOVE CN-LINE (N1 + 1) TO CN-LINE (N1)
 14229              IF (N1 + 1) = (CN-BILLING-START-LINE-NO - 1)
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 258
* EL6311.cbl
 14230                 IF PI-COMPANY-ID = 'DCC' or 'VPP'
 14231                    MOVE WS-OC-MESSAGE TO CN-LINE (N1 + 1)
 14232                 ELSE
 14233                    MOVE WS-VA-NO-COMM-MESS TO CN-LINE (N1 + 1)
 14234                 END-IF
 14235                 COMPUTE CN-BILLING-START-LINE-NO = N1 + 1
 14236                 MOVE +9 TO N1
 14237              END-IF
 14238           END-PERFORM
 14239        END-IF
 14240     END-IF
 14241     .
 14242 1700-EXIT.
 14243     EXIT.
 14244 1800-REMOVE-CERT-NOTES.
 14245     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 14246                                 TO ERNOTE-KEY
 14247     move '1'                    to ernote-record-type
 14248
 14249* EXEC CICS READ
 14250*       SET        (ADDRESS OF CERTIFICATE-NOTE)
 14251*       DATASET    (FILE-ID-ERNOTE)
 14252*       RIDFLD     (ERNOTE-KEY)
 14253*       RESP       (WS-RESPONSE)
 14254*       UPDATE
 14255*    END-EXEC
 14256*    MOVE '&"S        EU         (  N#00012971' TO DFHEIV0
 14257     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14258     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14259     MOVE X'204E233030303132393731' TO DFHEIV0(25:11)
 14260     CALL 'kxdfhei1' USING DFHEIV0,
 14261           FILE-ID-ERNOTE,
 14262           DFHEIV20,
 14263           DFHEIV99,
 14264           ERNOTE-KEY,
 14265           DFHEIV99,
 14266           DFHEIV99,
 14267           DFHEIV99
 14268     SET ADDRESS OF CERTIFICATE-NOTE TO
 14269         DFHEIV20
 14270     MOVE EIBRESP  TO WS-RESPONSE
 14271     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14272     IF RESP-NORMAL
 14273        PERFORM VARYING N1 FROM +1 BY +1 UNTIL
 14274           (N1 > +10)
 14275           OR (CN-LINE (N1) (1:10) = 'OVERCHARGE')
 14276           OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 14277        END-PERFORM
 14278        IF N1 < +11
 14279           MOVE SPACES              TO CN-LINE (N1)
 14280           IF N1 >= CN-BILLING-START-LINE-NO  AND
 14281              N1 <= CN-BILLING-END-LINE-NO
 14282              SUBTRACT 1 FROM CN-BILLING-END-LINE-NO
 14283              IF CN-BILLING-END-LINE-NO <
 14284                               CN-BILLING-START-LINE-NO
 14285                 MOVE ZEROS         TO CN-BILLING-END-LINE-NO
 14286                                     CN-BILLING-START-LINE-NO
 14287              END-IF
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 259
* EL6311.cbl
 14288              PERFORM 1820-SQUEEZE-ERNOTE
 14289                                  THRU 1820-EXIT
 14290           END-IF
 14291           IF CN-LINES = SPACES
 14292
 14293* EXEC CICS DELETE
 14294*                DATASET    (FILE-ID-ERNOTE)
 14295*                RESP       (WS-RESPONSE)
 14296*             END-EXEC
 14297*    MOVE '&(                    &  N#00012998' TO DFHEIV0
 14298     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 14299     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14300     MOVE X'204E233030303132393938' TO DFHEIV0(25:11)
 14301     CALL 'kxdfhei1' USING DFHEIV0,
 14302           FILE-ID-ERNOTE,
 14303           DFHEIV99,
 14304           DFHEIV99,
 14305           DFHEIV99,
 14306           DFHEIV99
 14307     MOVE EIBRESP  TO WS-RESPONSE
 14308     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14309              IF RESP-NORMAL
 14310                 MOVE 'D'        TO WS-NOTE-SW
 14311                 PERFORM 1520-UPDATE-ELCERT
 14312                                 THRU 1520-EXIT
 14313              END-IF
 14314           ELSE
 14315
 14316* EXEC CICS REWRITE
 14317*                DATASET    (FILE-ID-ERNOTE)
 14318*                FROM       (CERTIFICATE-NOTE)
 14319*                RESP       (WS-RESPONSE)
 14320*             END-EXEC
 14321     MOVE LENGTH OF
 14322      CERTIFICATE-NOTE
 14323       TO DFHEIV11
 14324*    MOVE '&& L                  %  N#00013008' TO DFHEIV0
 14325     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 14326     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 14327     MOVE X'204E233030303133303038' TO DFHEIV0(25:11)
 14328     CALL 'kxdfhei1' USING DFHEIV0,
 14329           FILE-ID-ERNOTE,
 14330           CERTIFICATE-NOTE,
 14331           DFHEIV11,
 14332           DFHEIV99
 14333     MOVE EIBRESP  TO WS-RESPONSE
 14334     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14335           END-IF
 14336        END-IF
 14337     END-IF
 14338     .
 14339 1800-EXIT.
 14340     EXIT.
 14341 1820-SQUEEZE-ERNOTE.
 14342     MOVE CN-BILLING-START-LINE-NO TO N2
 14343     IF N2 = 0
 14344         MOVE +1                 TO N2
 14345     END-IF
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 260
* EL6311.cbl
 14346     PERFORM VARYING N1 FROM N2 BY +1 UNTIL
 14347        (N1 > +9)
 14348        IF CN-LINE (N1) = SPACES
 14349           MOVE CN-LINE (N1 + +1)
 14350                                 TO CN-LINE (N1)
 14351           MOVE SPACES           TO CN-LINE (N1 + +1)
 14352        END-IF
 14353     END-PERFORM
 14354     .
 14355 1820-EXIT.
 14356     EXIT.
 14357 1900-DELETE-ERPYAJ.
 14358     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 14359     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 14360     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 14361     MOVE PB-I-BANK-NUMBER       TO ERPYAJ-FIN-RESP
 14362     MOVE LOW-VALUES             TO ERPYAJ-ACCOUNT
 14363     MOVE +10                    TO ERPYAJ-SEQ-NO
 14364     MOVE 'R'                    TO ERPYAJ-TYPE
 14365     MOVE ERPYAJ-KEY             TO WS-SAVE-ERPYAJ-KEY
 14366
 14367* EXEC CICS STARTBR
 14368*       DATASET    (FILE-ID-ERPYAJ)
 14369*       RIDFLD     (ERPYAJ-KEY)
 14370*       RESP       (WS-RESPONSE)
 14371*    END-EXEC
 14372     MOVE 0
 14373       TO DFHEIV11
 14374*    MOVE '&,         G          &  N#00013044' TO DFHEIV0
 14375     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 14376     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14377     MOVE X'204E233030303133303434' TO DFHEIV0(25:11)
 14378     CALL 'kxdfhei1' USING DFHEIV0,
 14379           FILE-ID-ERPYAJ,
 14380           ERPYAJ-KEY,
 14381           DFHEIV99,
 14382           DFHEIV11,
 14383           DFHEIV99
 14384     MOVE EIBRESP  TO WS-RESPONSE
 14385     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14386     IF RESP-NORMAL
 14387        CONTINUE
 14388     ELSE
 14389        GO TO 1900-GET-DEALER
 14390     END-IF
 14391     .
 14392 1900-READNEXT-ERPYAJ-B.
 14393*  GET THE BANK ERPYAJ RECORD
 14394
 14395* EXEC CICS READNEXT
 14396*       DATASET    (FILE-ID-ERPYAJ)
 14397*       RIDFLD     (ERPYAJ-KEY)
 14398*       SET        (ADDRESS OF PENDING-PAY-ADJ)
 14399*       RESP       (WS-RESPONSE)
 14400*    END-EXEC
 14401     MOVE 0
 14402       TO DFHEIV11
 14403*    MOVE '&.S                   )  N#00013057' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 261
* EL6311.cbl
 14404     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 14405     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 14406     MOVE X'204E233030303133303537' TO DFHEIV0(25:11)
 14407     CALL 'kxdfhei1' USING DFHEIV0,
 14408           FILE-ID-ERPYAJ,
 14409           DFHEIV20,
 14410           DFHEIV99,
 14411           ERPYAJ-KEY,
 14412           DFHEIV99,
 14413           DFHEIV11,
 14414           DFHEIV99,
 14415           DFHEIV99
 14416     SET ADDRESS OF PENDING-PAY-ADJ TO
 14417         DFHEIV20
 14418     MOVE EIBRESP  TO WS-RESPONSE
 14419     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14420     IF RESP-NORMAL
 14421        IF PY-CONTROL-PRIMARY (1:28) = WS-SAVE-ERPYAJ-KEY (1:28)
 14422           IF (PB-I-DCC-OVER-CHG-AMT = PY-ENTRY-AMT)
 14423              IF (PY-INPUT-DT = WS-CURRENT-BIN-DT)
 14424                 AND (PY-LAST-MAINT-BY = PI-PROCESSOR-ID)
 14425
 14426* EXEC CICS READ
 14427*                   DATASET    (FILE-ID-ERPYAJ)
 14428*                   RIDFLD     (ERPYAJ-KEY)
 14429*                   SET        (ADDRESS OF PENDING-PAY-ADJ)
 14430*                   RESP       (WS-RESPONSE)
 14431*                   UPDATE
 14432*                END-EXEC
 14433*    MOVE '&"S        EU         (  N#00013068' TO DFHEIV0
 14434     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14435     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14436     MOVE X'204E233030303133303638' TO DFHEIV0(25:11)
 14437     CALL 'kxdfhei1' USING DFHEIV0,
 14438           FILE-ID-ERPYAJ,
 14439           DFHEIV20,
 14440           DFHEIV99,
 14441           ERPYAJ-KEY,
 14442           DFHEIV99,
 14443           DFHEIV99,
 14444           DFHEIV99
 14445     SET ADDRESS OF PENDING-PAY-ADJ TO
 14446         DFHEIV20
 14447     MOVE EIBRESP  TO WS-RESPONSE
 14448     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14449                 IF RESP-NORMAL
 14450
 14451* EXEC CICS DELETE
 14452*                      DATASET   (FILE-ID-ERPYAJ)
 14453*                      RESP      (WS-RESPONSE)
 14454*                   END-EXEC
 14455*    MOVE '&(                    &  N#00013076' TO DFHEIV0
 14456     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 14457     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14458     MOVE X'204E233030303133303736' TO DFHEIV0(25:11)
 14459     CALL 'kxdfhei1' USING DFHEIV0,
 14460           FILE-ID-ERPYAJ,
 14461           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 262
* EL6311.cbl
 14462           DFHEIV99,
 14463           DFHEIV99,
 14464           DFHEIV99
 14465     MOVE EIBRESP  TO WS-RESPONSE
 14466     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14467                 END-IF
 14468              ELSE
 14469                 SET REVERSAL    TO TRUE
 14470                 PERFORM 1600-UPDATE-ERPYAJ
 14471                                 THRU 1600-EXIT
 14472                 GO TO 1900-EXIT
 14473              END-IF
 14474           ELSE
 14475              GO TO 1900-READNEXT-ERPYAJ-B
 14476           END-IF
 14477        END-IF
 14478
 14479* EXEC CICS ENDBR
 14480*          DATASET   (FILE-ID-ERPYAJ)
 14481*       END-EXEC
 14482     MOVE 0
 14483       TO DFHEIV11
 14484*    MOVE '&2                    $   #00013091' TO DFHEIV0
 14485     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 14486     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14487     MOVE X'2020233030303133303931' TO DFHEIV0(25:11)
 14488     CALL 'kxdfhei1' USING DFHEIV0,
 14489           FILE-ID-ERPYAJ,
 14490           DFHEIV11,
 14491           DFHEIV99
 14492     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14493     END-IF
 14494     .
 14495 1900-GET-DEALER.
 14496     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 14497     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 14498     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 14499     MOVE PB-ACCOUNT             TO ERPYAJ-FIN-RESP
 14500     MOVE PB-ACCOUNT             TO ERPYAJ-ACCOUNT
 14501     MOVE +10                    TO ERPYAJ-SEQ-NO
 14502     MOVE 'C'                    TO ERPYAJ-TYPE
 14503     MOVE ERPYAJ-KEY             TO WS-SAVE-ERPYAJ-KEY
 14504
 14505* EXEC CICS STARTBR
 14506*       DATASET    (FILE-ID-ERPYAJ)
 14507*       RIDFLD     (ERPYAJ-KEY)
 14508*       RESP       (WS-RESPONSE)
 14509*    END-EXEC
 14510     MOVE 0
 14511       TO DFHEIV11
 14512*    MOVE '&,         G          &  N#00013105' TO DFHEIV0
 14513     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 14514     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14515     MOVE X'204E233030303133313035' TO DFHEIV0(25:11)
 14516     CALL 'kxdfhei1' USING DFHEIV0,
 14517           FILE-ID-ERPYAJ,
 14518           ERPYAJ-KEY,
 14519           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 263
* EL6311.cbl
 14520           DFHEIV11,
 14521           DFHEIV99
 14522     MOVE EIBRESP  TO WS-RESPONSE
 14523     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14524     IF RESP-NORMAL
 14525        CONTINUE
 14526     ELSE
 14527        GO TO 1900-EXIT
 14528     END-IF
 14529     .
 14530 1900-READNEXT-ERPYAJ-D.
 14531*  GET THE DEALER ERPYAJ RECORD
 14532
 14533* EXEC CICS READNEXT
 14534*       DATASET    (FILE-ID-ERPYAJ)
 14535*       RIDFLD     (ERPYAJ-KEY)
 14536*       SET        (ADDRESS OF PENDING-PAY-ADJ)
 14537*       RESP       (WS-RESPONSE)
 14538*    END-EXEC
 14539     MOVE 0
 14540       TO DFHEIV11
 14541*    MOVE '&.S                   )  N#00013118' TO DFHEIV0
 14542     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 14543     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 14544     MOVE X'204E233030303133313138' TO DFHEIV0(25:11)
 14545     CALL 'kxdfhei1' USING DFHEIV0,
 14546           FILE-ID-ERPYAJ,
 14547           DFHEIV20,
 14548           DFHEIV99,
 14549           ERPYAJ-KEY,
 14550           DFHEIV99,
 14551           DFHEIV11,
 14552           DFHEIV99,
 14553           DFHEIV99
 14554     SET ADDRESS OF PENDING-PAY-ADJ TO
 14555         DFHEIV20
 14556     MOVE EIBRESP  TO WS-RESPONSE
 14557     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14558     IF RESP-NORMAL
 14559        IF PY-CONTROL-PRIMARY (1:28) = WS-SAVE-ERPYAJ-KEY (1:28)
 14560           IF (PB-I-DCC-OVER-CHG-AMT = PY-ENTRY-AMT)
 14561              IF (PY-INPUT-DT = WS-CURRENT-BIN-DT)
 14562                 AND (PY-LAST-MAINT-BY = PI-PROCESSOR-ID)
 14563
 14564* EXEC CICS READ
 14565*                   DATASET    (FILE-ID-ERPYAJ)
 14566*                   RIDFLD     (ERPYAJ-KEY)
 14567*                   SET        (ADDRESS OF PENDING-PAY-ADJ)
 14568*                   RESP       (WS-RESPONSE)
 14569*                   UPDATE
 14570*                END-EXEC
 14571*    MOVE '&"S        EU         (  N#00013129' TO DFHEIV0
 14572     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14573     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14574     MOVE X'204E233030303133313239' TO DFHEIV0(25:11)
 14575     CALL 'kxdfhei1' USING DFHEIV0,
 14576           FILE-ID-ERPYAJ,
 14577           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 264
* EL6311.cbl
 14578           DFHEIV99,
 14579           ERPYAJ-KEY,
 14580           DFHEIV99,
 14581           DFHEIV99,
 14582           DFHEIV99
 14583     SET ADDRESS OF PENDING-PAY-ADJ TO
 14584         DFHEIV20
 14585     MOVE EIBRESP  TO WS-RESPONSE
 14586     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14587                 IF RESP-NORMAL
 14588
 14589* EXEC CICS DELETE
 14590*                      DATASET   (FILE-ID-ERPYAJ)
 14591*                      RESP      (WS-RESPONSE)
 14592*                   END-EXEC
 14593*    MOVE '&(                    &  N#00013137' TO DFHEIV0
 14594     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 14595     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14596     MOVE X'204E233030303133313337' TO DFHEIV0(25:11)
 14597     CALL 'kxdfhei1' USING DFHEIV0,
 14598           FILE-ID-ERPYAJ,
 14599           DFHEIV99,
 14600           DFHEIV99,
 14601           DFHEIV99,
 14602           DFHEIV99
 14603     MOVE EIBRESP  TO WS-RESPONSE
 14604     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14605                 END-IF
 14606              ELSE
 14607                 SET REVERSAL    TO TRUE
 14608              END-IF
 14609           ELSE
 14610              GO TO 1900-READNEXT-ERPYAJ-D
 14611           END-IF
 14612        END-IF
 14613
 14614* EXEC CICS ENDBR
 14615*          DATASET   (FILE-ID-ERPYAJ)
 14616*       END-EXEC
 14617     MOVE 0
 14618       TO DFHEIV11
 14619*    MOVE '&2                    $   #00013149' TO DFHEIV0
 14620     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 14621     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14622     MOVE X'2020233030303133313439' TO DFHEIV0(25:11)
 14623     CALL 'kxdfhei1' USING DFHEIV0,
 14624           FILE-ID-ERPYAJ,
 14625           DFHEIV11,
 14626           DFHEIV99
 14627     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14628     END-IF
 14629     .
 14630 1900-EXIT.
 14631     EXIT.
 14632******************************************************************
 14633*            C A N C E L   M A I N L I N E                       *
 14634******************************************************************
 14635
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 265
* EL6311.cbl
 14636 2000-CANCEL-MAINLINE.
 14637     IF PI-DISPLAY-ORIGINAL-BATCH
 14638        IF CMAINTI NOT = 'C' AND 'D' AND 'S' AND 'K'
 14639           MOVE ER-0023             TO EMI-ERROR
 14640           MOVE -1                  TO CMAINTL
 14641           MOVE AL-UABON            TO CMAINTA
 14642           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14643           GO TO 8200-SEND-DATAONLY
 14644        ELSE
 14645           NEXT SENTENCE
 14646     ELSE
 14647        IF CMAINTI NOT = 'A' AND 'C' AND 'D' AND 'S' AND 'K'
 14648           MOVE ER-0023             TO EMI-ERROR
 14649           MOVE -1                  TO CMAINTL
 14650           MOVE AL-UABON            TO CMAINTA
 14651           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14652           GO TO 8200-SEND-DATAONLY.
 14653
 14654     IF CMAINTI = 'S'
 14655        GO TO 2100-SHOW-REQUEST.
 14656
 14657     IF NOT MODIFY-CAP
 14658         MOVE 'UPDATE'       TO SM-READ
 14659         PERFORM 9995-SECURITY-VIOLATION
 14660         MOVE ER-0070        TO EMI-ERROR
 14661         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14662         GO TO 8100-SEND-INITIAL-MAP.
 14663
 14664     IF CMAINTL GREATER THAN ZEROS
 14665        IF PI-PF6-FUNCTION
 14666           IF CMAINTI NOT = 'A'
 14667              MOVE AL-UABON  TO CMAINTA
 14668              MOVE -1        TO CMAINTL
 14669              MOVE ER-2260   TO EMI-ERROR
 14670              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14671              GO TO 8200-SEND-DATAONLY.
 14672
 14673     IF CCERTNOL = ZEROS
 14674       AND (CMAINTI = 'C' OR 'K' OR 'D')
 14675         NEXT SENTENCE
 14676     ELSE
 14677         IF CCERTNOL NOT = ZEROS
 14678             MOVE AL-UANON       TO CCERTNOA
 14679         ELSE
 14680             MOVE -1             TO CCERTNOL
 14681             MOVE  1             TO SET-CURSOR-SW
 14682             MOVE ER-2218       TO EMI-ERROR
 14683             MOVE AL-UABON       TO CCERTNOA
 14684             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14685
 14686     IF CEFFDTL = ZEROS AND (CMAINTI = 'C' OR 'K' OR 'D')
 14687        NEXT SENTENCE
 14688     ELSE
 14689        IF CEFFDTL NOT = ZEROS
 14690           MOVE AL-UNNON         TO CEFFDTA
 14691           MOVE CEFFDTI TO DEEDIT-FIELD
 14692           PERFORM 8600-DEEDIT
 14693           MOVE 4                TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 266
* EL6311.cbl
 14694           MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 14695           PERFORM 9700-DATE-LINK
 14696           IF NO-CONVERSION-ERROR
 14697              MOVE DC-BIN-DATE-1 TO WS-CONVERTED-EFFDT
 14698              ELSE
 14699              MOVE -1            TO CEFFDTL
 14700              MOVE  1            TO SET-CURSOR-SW
 14701              MOVE ER-2226      TO EMI-ERROR
 14702              MOVE AL-UNBON      TO CEFFDTA
 14703              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14704          ELSE
 14705          MOVE -1                 TO CEFFDTL
 14706          MOVE  1                 TO SET-CURSOR-SW
 14707          MOVE ER-2220            TO EMI-ERROR
 14708          MOVE AL-UNBON           TO CEFFDTA
 14709          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14710
 14711     MOVE PI-PREV-ALT-KEY            TO WS-ERPNDB-ALT-KEY.
 14712
 14713     IF CCERTNOL NOT = ZEROS
 14714        MOVE CCERTNOI                TO WS-NEW-PRIME
 14715     ELSE
 14716        MOVE SPACES                  TO WS-NEW-PRIME.
 14717
 14718     IF CSUFIXL NOT = ZEROS
 14719        MOVE CSUFIXI                 TO WS-NEW-SUFFIX
 14720     ELSE
 14721        MOVE SPACE                   TO WS-NEW-SUFFIX.
 14722
 14723     IF CEFFDTL NOT = ZEROS
 14724        MOVE WS-CONVERTED-EFFDT      TO WS-NEW-CERT-EFF-DT
 14725     ELSE
 14726        MOVE LOW-VALUES              TO WS-NEW-CERT-EFF-DT.
 14727
 14728     IF CMAINTI = 'A' OR 'K' OR 'S'
 14729        NEXT SENTENCE
 14730     ELSE
 14731        MOVE PI-PREV-ALT-KEY     TO WS-ERPNDB-ALT-KEY
 14732        IF WS-PB-CERT-NO     NOT = WS-NEW-CERT-NO     OR
 14733           WS-PB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT OR
 14734           WS-PB-RECORD-TYPE NOT = '2'
 14735           IF CMAINTI = 'C'
 14736              MOVE ER-2287          TO EMI-ERROR
 14737              MOVE -1               TO CCERTNOL
 14738              MOVE AL-UABON         TO CCERTNOA CEFFDTA
 14739              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14740              GO TO 8200-SEND-DATAONLY
 14741             ELSE
 14742              MOVE ER-2260          TO EMI-ERROR
 14743              MOVE -1               TO CCERTNOL
 14744              MOVE AL-UABON         TO CCERTNOA
 14745              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14746              GO TO 8200-SEND-DATAONLY.
 14747
 14748     IF CMAINTI = 'D'
 14749        GO TO 2400-DELETE-CANCEL-ROUTINE.
 14750
 14751     IF CLSTNML GREATER THAN ZEROS
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 267
* EL6311.cbl
 14752         MOVE AL-UANON           TO CLSTNMA.
 14753
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 268
* EL6311.cbl
 14755
 14756******************************************************************
 14757*                                                                *
 14758*           E D I T   C A N C E L   C O V E R A G E S            *
 14759*                                                                *
 14760******************************************************************
 14761
 14762 2015-EDIT-COVERAGES.
 14763     IF CCANDT1L      GREATER THAN ZEROS OR
 14764        CREFND1L      GREATER THAN ZEROS OR
 14765        CCANDT2L      GREATER THAN ZEROS OR
 14766        CREFND2L      GREATER THAN ZEROS OR
 14767        CMTHD1L       GREATER THAN ZEROS OR
 14768        CMTHD2L       GREATER THAN ZEROS OR
 14769        CLIVESL       GREATER THAN ZEROS OR
 14770        CPAYEEL       GREATER THAN ZEROS OR
 14771        CFORCEL       GREATER THAN ZEROS OR
 14772        CBILCDL       GREATER THAN ZEROS OR
 14773        CCANREAL      GREATER THAN ZEROS
 14774            NEXT SENTENCE
 14775         ELSE
 14776            GO TO 2030-EDIT-COMPLETE.
 14777
 14778     IF CCANDT1L = ZEROS
 14779        AND (CMAINTI = 'C' OR 'K')
 14780        NEXT SENTENCE
 14781     ELSE
 14782        IF CCANDT1L      GREATER THAN ZEROS
 14783            MOVE AL-UNNON            TO CCANDT1A
 14784            IF CCANDT1I = SPACES
 14785               MOVE LOW-VALUES       TO WS-CONVERTED-CANDT1
 14786            ELSE
 14787               MOVE CCANDT1I            TO DEEDIT-FIELD
 14788               PERFORM 8600-DEEDIT
 14789               IF DEEDIT-FIELD-V0   NUMERIC
 14790                  MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 14791                  MOVE 4                TO DC-OPTION-CODE
 14792                  PERFORM 9700-DATE-LINK
 14793                  IF NO-CONVERSION-ERROR
 14794                     MOVE DC-BIN-DATE-1    TO WS-CONVERTED-CANDT1
 14795                  ELSE
 14796                      MOVE -1        TO CCANDT1L
 14797                      MOVE ER-2227   TO EMI-ERROR
 14798                      MOVE AL-UNBON  TO CCANDT1A
 14799                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14800               ELSE
 14801                  MOVE -1         TO CCANDT1L
 14802                  MOVE ER-2223    TO EMI-ERROR
 14803                  MOVE AL-UNBON   TO CCANDT1A
 14804                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14805        ELSE
 14806            IF CREFND1L GREATER THAN ZEROS
 14807               MOVE -1             TO CCANDT1L
 14808               MOVE ER-2222        TO EMI-ERROR
 14809               MOVE AL-UNBOF       TO CCANDT1A
 14810               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14811
 14812     IF CREFND1L = ZEROS
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 269
* EL6311.cbl
 14813        AND (CMAINTI = 'C' OR 'K')
 14814         NEXT SENTENCE
 14815     ELSE
 14816         IF CREFND1L NOT = ZEROS
 14817            MOVE AL-UNNON        TO CREFND1A
 14818
 14819* EXEC CICS BIF DEEDIT
 14820*               FIELD  (CREFND1I)
 14821*               LENGTH (11)
 14822*           END-EXEC
 14823     MOVE 11
 14824       TO DFHEIV11
 14825*    MOVE '@"L                   #   #00013342' TO DFHEIV0
 14826     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 14827     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14828     MOVE X'2020233030303133333432' TO DFHEIV0(25:11)
 14829     CALL 'kxdfhei1' USING DFHEIV0,
 14830           CREFND1I,
 14831           DFHEIV11
 14832     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14833            MOVE CREFND1I        TO WS-CREFND1
 14834*           MOVE CREFND1I        TO DEEDIT-FIELD-X11
 14835*           PERFORM 8600-DEEDIT
 14836*           MOVE DEEDIT-FIELD-V2 TO WS-CREFND1
 14837            IF WS-CREFND1  = ZEROS
 14838               AND CMAINTI = 'A'
 14839             MOVE ER-2437        TO EMI-ERROR
 14840             MOVE -1             TO CREFND1L
 14841             MOVE AL-UNBON       TO CREFND1A
 14842             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14843
 14844     IF CCANREAL > +0
 14845        MOVE AL-UANON            TO CCANREAA
 14846        IF CCANREAI = 'R' OR ' '
 14847           CONTINUE
 14848        ELSE
 14849           MOVE ER-9841        TO EMI-ERROR
 14850           MOVE -1             TO CCANREAL
 14851           MOVE AL-UABON       TO CCANREAA
 14852           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14853        END-IF
 14854     END-IF
 14855     IF CMTHD1L EQUAL +0
 14856        NEXT SENTENCE
 14857     ELSE
 14858        IF CMTHD1L NOT = +0
 14859           MOVE AL-UNNON        TO CMTHD1A
 14860           IF CMTHD1I EQUAL '1' OR '2' OR '3' OR '4'
 14861                         OR '5' OR '6' OR '8' OR '9'
 14862                         OR 'R' OR ' '
 14863              NEXT SENTENCE
 14864           ELSE
 14865              MOVE ER-0582        TO EMI-ERROR
 14866              MOVE -1             TO CMTHD1L
 14867              MOVE AL-UNBON       TO CMTHD1A
 14868              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14869
 14870     IF CCANDT2L = ZEROS
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 270
* EL6311.cbl
 14871        AND (CMAINTI = 'C' OR 'K')
 14872         NEXT SENTENCE
 14873     ELSE
 14874         IF CCANDT2L  GREATER THAN ZEROS
 14875             MOVE AL-UNNON       TO CCANDT2A
 14876             IF CCANDT2I = SPACES
 14877                MOVE LOW-VALUES  TO WS-CONVERTED-CANDT2
 14878             ELSE
 14879                MOVE CCANDT2I       TO DEEDIT-FIELD
 14880                PERFORM 8600-DEEDIT
 14881                IF DEEDIT-FIELD-V0   NUMERIC
 14882                   MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 14883                   MOVE 4                TO DC-OPTION-CODE
 14884                   PERFORM 9700-DATE-LINK
 14885                   IF NO-CONVERSION-ERROR
 14886                      MOVE DC-BIN-DATE-1    TO WS-CONVERTED-CANDT2
 14887                   ELSE
 14888                      MOVE -1       TO CCANDT2L
 14889                      MOVE ER-2227  TO EMI-ERROR
 14890                      MOVE AL-UNBON TO CCANDT2A
 14891                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14892                ELSE
 14893                   MOVE -1         TO CCANDT2L
 14894                   MOVE ER-2223    TO EMI-ERROR
 14895                   MOVE AL-UNBON   TO CCANDT2A
 14896                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14897         ELSE
 14898            IF CREFND2L GREATER THAN ZEROS
 14899               MOVE -1             TO CCANDT2L
 14900               MOVE ER-2222        TO EMI-ERROR
 14901               MOVE AL-UNBOF       TO CCANDT2A
 14902               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14903
 14904     IF CREFND2L = ZEROS
 14905        AND (CMAINTI = 'C' OR 'K')
 14906         NEXT SENTENCE
 14907     ELSE
 14908         IF CREFND2L NOT = ZEROS
 14909            MOVE AL-UNNON        TO CREFND2A
 14910
 14911* EXEC CICS BIF DEEDIT
 14912*               FIELD  (CREFND2I)
 14913*               LENGTH (11)
 14914*           END-EXEC
 14915     MOVE 11
 14916       TO DFHEIV11
 14917*    MOVE '@"L                   #   #00013423' TO DFHEIV0
 14918     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 14919     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14920     MOVE X'2020233030303133343233' TO DFHEIV0(25:11)
 14921     CALL 'kxdfhei1' USING DFHEIV0,
 14922           CREFND2I,
 14923           DFHEIV11
 14924     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14925            MOVE CREFND2I        TO WS-CREFND2
 14926*           MOVE CREFND2I        TO DEEDIT-FIELD-X11
 14927*           PERFORM 8600-DEEDIT
 14928*           MOVE DEEDIT-FIELD-V2 TO WS-CREFND2
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 271
* EL6311.cbl
 14929            IF WS-CREFND2  = ZEROS
 14930               AND CMAINTI = 'A'
 14931             MOVE ER-2437        TO EMI-ERROR
 14932             MOVE -1             TO CREFND2L
 14933             MOVE AL-UNBON       TO CREFND2A
 14934             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14935
 14936     IF CMTHD2L EQUAL +0
 14937        NEXT SENTENCE
 14938     ELSE
 14939        IF CMTHD2L NOT = +0
 14940           MOVE AL-UNNON        TO CMTHD2A
 14941           IF CMTHD2I EQUAL '1' OR '2' OR '3' OR '4'
 14942                         OR '5' OR '6' OR '8' OR '9'
 14943                         OR ' ' OR 'R'
 14944              NEXT SENTENCE
 14945           ELSE
 14946              MOVE ER-0582        TO EMI-ERROR
 14947              MOVE -1             TO CMTHD2L
 14948              MOVE AL-UNBON       TO CMTHD2A
 14949              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14950
 14951     IF CLIVESL GREATER THAN ZEROS
 14952         MOVE CLIVESI            TO DEEDIT-FIELD
 14953         PERFORM 8600-DEEDIT
 14954         IF DEEDIT-FIELD-V0 NUMERIC
 14955             MOVE DEEDIT-FIELD-V0 TO WS-CLIVES
 14956             MOVE AL-UNNON       TO CLIVESA
 14957         ELSE
 14958             MOVE -1             TO CLIVESL
 14959             MOVE AL-UNBON       TO CLIVESA
 14960             MOVE ER-2223        TO EMI-ERROR
 14961             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14962
 14963     IF CFORCEL  NOT = ZEROS
 14964         IF FORCE-CAP
 14965            MOVE AL-UANON            TO CFORCEA
 14966         ELSE
 14967            MOVE ER-2945             TO EMI-ERROR
 14968            MOVE AL-UABON            TO CFORCEA
 14969            MOVE -1                  TO CFORCEL
 14970            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14971
 14972     IF CPAYEEL GREATER THAN ZEROS
 14973        MOVE AL-UANON            TO CPAYEEA.
 14974
 14975     IF CBILCDL NOT = ZEROS
 14976        IF CBILCDI NOT = ' ' AND 'H' AND 'R' AND 'L'
 14977                             AND 'A' AND 'B' AND 'E'
 14978           MOVE ER-2225              TO EMI-ERROR
 14979           MOVE AL-UABON             TO CBILCDA
 14980           MOVE -1                   TO CBILCDL
 14981           MOVE  1                   TO SET-CURSOR-SW
 14982           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14983        ELSE
 14984           MOVE AL-UANON             TO CBILCDA.
 14985
 14986 2030-EDIT-COMPLETE.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 272
* EL6311.cbl
 14987     IF EMI-ERROR = ZEROS
 14988         NEXT SENTENCE
 14989     ELSE
 14990         GO TO 8200-SEND-DATAONLY.
 14991
 14992     IF CMAINTI = 'A'
 14993        GO TO 2200-ADD-CANCEL-ROUTINE.
 14994
 14995     IF CMAINTI = 'C'
 14996        GO TO 2300-CHANGE-CANCEL-ROUTINE.
 14997
 14998     GO TO 2900-REWRITE-CAN-CERT-KEY.
 14999
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 273
* EL6311.cbl
 15001
 15002******************************************************************
 15003*                                                                *
 15004*                   S H O W   C A N C E L                        *
 15005*                                                                *
 15006******************************************************************
 15007
 15008 2100-SHOW-REQUEST.
 15009     MOVE 'S'                    TO PI-MAINT-FUNCTION.
 15010
 15011     IF CCERTNOL = ZEROS AND CEFFDTL = ZEROS
 15012        MOVE -1                  TO CMAINTL
 15013        GO TO 8200-SEND-DATAONLY.
 15014
 15015     MOVE CCERTNOI            TO WS-NEW-PRIME.
 15016
 15017     IF CSUFIXL NOT = ZEROS
 15018        MOVE CSUFIXI          TO WS-NEW-SUFFIX
 15019       ELSE
 15020        MOVE SPACE            TO WS-NEW-SUFFIX.
 15021
 15022     MOVE CEFFDTI                TO DEEDIT-FIELD.
 15023     PERFORM 8600-DEEDIT.
 15024     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 15025     MOVE '4'                    TO DC-OPTION-CODE.
 15026     PERFORM 9700-DATE-LINK.
 15027     IF DATE-CONVERSION-ERROR
 15028        MOVE ER-0348             TO EMI-ERROR
 15029        MOVE -1                  TO CEFFDTL
 15030        MOVE AL-UABON            TO CEFFDTA
 15031        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15032        GO TO 8200-SEND-DATAONLY
 15033     ELSE
 15034        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 15035        MOVE AL-UANON            TO CEFFDTA
 15036        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 15037
 15038     MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
 15039
 15040     IF (ERPNDB-CERT-NO     NOT = WS-NEW-CERT-NO)      OR
 15041        (ERPNDB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT)
 15042        MOVE 'Y'                    TO WS-SHOW-SW
 15043        IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
 15044           GO TO 4100-BROWSE-PRIMARY-FORWARD
 15045        ELSE
 15046           IF PI-FILE-BROWSE
 15047              GO TO 4300-BROWSE-FILE-FORWARD
 15048           ELSE
 15049              IF PI-CSR-BROWSE
 15050                 GO TO 4200-BROWSE-CSR-FORWARD
 15051              ELSE
 15052                 GO TO 4000-BROWSE-DETAIL-FORWARD
 15053     ELSE
 15054        GO TO 3900-RE-DISPLAY-RECORD.
 15055
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 274
* EL6311.cbl
 15057
 15058
 15059******************************************************************
 15060*                                                                *
 15061*            A D D   C A N C E L   R O U T I N E                 *
 15062*                                                                *
 15063******************************************************************
 15064
 15065 2200-ADD-CANCEL-ROUTINE.
 15066     MOVE 'A'                    TO PI-MAINT-FUNCTION.
 15067
 15068
 15069* EXEC CICS GETMAIN
 15070*        SET     (ADDRESS OF PENDING-BUSINESS)
 15071*        LENGTH  (ERPNDB-RECORD-LENGTH)
 15072*    END-EXEC.
 15073*    MOVE '," L                  $   #00013570' TO DFHEIV0
 15074     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 15075     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15076     MOVE X'2020233030303133353730' TO DFHEIV0(25:11)
 15077     CALL 'kxdfhei1' USING DFHEIV0,
 15078           DFHEIV20,
 15079           ERPNDB-RECORD-LENGTH,
 15080           DFHEIV99
 15081     SET ADDRESS OF PENDING-BUSINESS TO
 15082         DFHEIV20
 15083     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15084
 15085
 15086
 15087* EXEC CICS HANDLE CONDITION
 15088*         NOTFND    (2280-BATCH-HDR-NOT-FOUND)
 15089*    END-EXEC.
 15090*    MOVE '"$I                   ! 3 #00013575' TO DFHEIV0
 15091     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15092     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15093     MOVE X'3320233030303133353735' TO DFHEIV0(25:11)
 15094     CALL 'kxdfhei1' USING DFHEIV0
 15095     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15096
 15097
 15098     MOVE PI-PREV-KEY            TO ERPNDB-KEY
 15099     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 15100     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 15101
 15102
 15103* EXEC CICS READ
 15104*        INTO    (PENDING-BUSINESS)
 15105*        DATASET (FILE-ID-ERPNDB)
 15106*        RIDFLD  (ERPNDB-KEY)
 15107*    END-EXEC.
 15108     MOVE LENGTH OF
 15109      PENDING-BUSINESS
 15110       TO DFHEIV11
 15111*    MOVE '&"IL       E          (   #00013583' TO DFHEIV0
 15112     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15113     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15114     MOVE X'2020233030303133353833' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 275
* EL6311.cbl
 15115     CALL 'kxdfhei1' USING DFHEIV0,
 15116           FILE-ID-ERPNDB,
 15117           PENDING-BUSINESS,
 15118           DFHEIV11,
 15119           ERPNDB-KEY,
 15120           DFHEIV99,
 15121           DFHEIV99,
 15122           DFHEIV99
 15123     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15124
 15125
 15126     MOVE PB-CSR-ID              TO WS-BATCH-CSR-ID.
 15127
 15128     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 15129     ADD +1                      TO WS-B-HIGHEST-SEQ-NO.
 15130     MOVE PB-CREDIT-SELECT-DT    TO WS-CREDIT-SELECT-DT.
 15131     MOVE SPACES                 TO PENDING-BUSINESS.
 15132     MOVE 'PB'                   TO PB-RECORD-ID.
 15133     MOVE PI-PREV-KEY            TO PB-CONTROL-PRIMARY.
 15134     MOVE PI-PREV-ALT-KEY        TO PB-CONTROL-BY-ACCOUNT.
 15135     MOVE SPACES                 TO PB-CERT-SFX.
 15136     MOVE WS-B-HIGHEST-SEQ-NO    TO PB-BATCH-SEQ-NO.
 15137     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
 15138                                    PB-ALT-CHG-SEQ-NO.
 15139
 15140     MOVE WS-CONVERTED-EFFDT     TO PB-CERT-EFF-DT.
 15141     MOVE CCERTNOI               TO PB-CERT-PRIME.
 15142     MOVE '2'                    TO PB-RECORD-TYPE.
 15143
 15144     MOVE PI-COMPANY-CD          TO PB-COMPANY-CD.
 15145     MOVE PI-COMPANY-ID          TO PB-COMPANY-ID.
 15146
 15147
 15148     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
 15149                                    PB-ALT-CHG-SEQ-NO
 15150                                    PB-C-LF-REF-CALC
 15151                                    PB-C-AH-REF-CALC
 15152                                    PB-C-LF-RFND-CLP
 15153                                    PB-C-AH-RFND-CLP
 15154                                    PB-CI-INSURED-AGE
 15155                                    PB-CI-LF-TERM
 15156                                    PB-CI-AH-TERM
 15157                                    PB-CI-LF-BENEFIT-CD
 15158                                    PB-CI-LF-BENEFIT-AMT
 15159                                    PB-CI-LF-ALT-BENEFIT-AMT
 15160                                    PB-CI-LF-PREMIUM-AMT
 15161                                    PB-CI-LF-ALT-PREMIUM-AMT
 15162                                    PB-CI-AH-BENEFIT-CD
 15163                                    PB-CI-AH-BENEFIT-AMT
 15164                                    PB-CI-AH-PREMIUM-AMT
 15165                                    PB-CI-PAY-FREQUENCY
 15166                                    PB-CI-LOAN-APR
 15167                                    PB-CI-LOAN-TERM
 15168                                    PB-CI-LIFE-COMMISSION
 15169                                    PB-CI-AH-COMMISSION
 15170                                    PB-CI-CURR-SEQ
 15171                                    PB-CI-AH-CANCEL-AMT
 15172                                    PB-CI-LF-CANCEL-AMT
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 276
* EL6311.cbl
 15173                                    PB-CI-RATE-DEV-PCT-LF
 15174                                    PB-CI-RATE-DEV-PCT-AH
 15175                                    PB-CI-EXTENTION-DAYS
 15176                                    PB-CI-TERM-IN-DAYS
 15177                                    PB-CI-LIVES
 15178                                    PB-CI-LF-CRIT-PER
 15179                                    PB-CI-AH-CRIT-PER
 15180                                    PB-C-LF-REM-TERM
 15181                                    PB-C-AH-REM-TERM
 15182                                    PB-CHG-COUNT
 15183                                    PB-LF-BILLED-AMTS
 15184                                    PB-AH-BILLED-AMTS
 15185                                    PB-C-INT-ON-REFS
 15186*                                   PB-C-MICROFILM-NO
 15187                                    PB-CALC-TOLERANCE.
 15188
 15189     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
 15190                                    PB-CI-AH-SETTLEMENT-DT
 15191                                    PB-CI-DEATH-DT
 15192                                    PB-CI-LF-PRIOR-CANCEL-DT
 15193                                    PB-CI-AH-PRIOR-CANCEL-DT
 15194                                    PB-CI-ENTRY-DT
 15195                                    PB-CI-LF-EXPIRE-DT
 15196                                    PB-CI-AH-EXPIRE-DT
 15197                                    PB-CI-LOAN-1ST-PMT-DT
 15198                                    PB-C-LF-CANCEL-DT
 15199                                    PB-C-AH-CANCEL-DT
 15200                                    PB-CREDIT-ACCEPT-DT
 15201                                    PB-BILLED-DT
 15202                                    PB-ACCT-EFF-DT
 15203                                    PB-ACCT-EXP-DT.
 15204
 15205     MOVE 'X'                    TO PB-FATAL-FLAG.
 15206
 15207     MOVE WS-CREDIT-SELECT-DT    TO PB-CREDIT-SELECT-DT.
 15208
 15209     IF CSUFIXL     GREATER THAN ZEROS
 15210        MOVE CSUFIXI             TO PB-CERT-SFX.
 15211
 15212*    IF CMICRNOL  GREATER  ZEROS
 15213*        IF CMICRNOI  NUMERIC
 15214*            MOVE CMICRNOI       TO  PB-C-MICROFILM-NO
 15215*            MOVE AL-UNNON       TO  CMICRNOA
 15216*        ELSE
 15217*            MOVE -1             TO  CMICRNOL
 15218*            MOVE AL-UNBON       TO  CMICRNOA
 15219*            MOVE ER-2701        TO  EMI-ERROR
 15220*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15221
 15222     IF CLSTNML     GREATER THAN ZEROS
 15223        MOVE CLSTNMI             TO PB-C-LAST-NAME.
 15224
 15225     IF CCANREAL > ZEROS
 15226        MOVE CCANREAI            TO PB-C-CANCEL-REASON
 15227     END-IF
 15228     IF CCANDT1L    GREATER THAN ZEROS
 15229        MOVE WS-CONVERTED-CANDT1 TO PB-C-LF-CANCEL-DT.
 15230
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 277
* EL6311.cbl
 15231     IF CCANDT2L    GREATER THAN ZEROS
 15232        MOVE WS-CONVERTED-CANDT2 TO PB-C-AH-CANCEL-DT.
 15233
 15234     IF CMTHD1L    GREATER THAN +0
 15235        MOVE CMTHD1I             TO PB-C-LF-REFUND-OVERRIDE.
 15236
 15237     IF CMTHD2L    GREATER THAN +0
 15238        MOVE CMTHD2I             TO PB-C-AH-REFUND-OVERRIDE.
 15239
 15240     IF CREFND1L    GREATER THAN ZEROS
 15241        ADD  WS-CREFND1          TO WS-B-LF-CAN-PRM-ENTERED
 15242        MOVE WS-CREFND1          TO PB-C-LF-CANCEL-AMT
 15243     ELSE
 15244        MOVE ZEROS               TO PB-C-LF-CANCEL-AMT.
 15245
 15246     IF CREFND2L    GREATER THAN ZEROS
 15247        ADD  WS-CREFND2          TO WS-B-AH-CAN-PRM-ENTERED
 15248        MOVE WS-CREFND2          TO PB-C-AH-CANCEL-AMT
 15249     ELSE
 15250        MOVE ZEROS               TO PB-C-AH-CANCEL-AMT.
 15251
 15252     IF CLIVESL     GREATER THAN ZEROS
 15253        MOVE WS-CLIVES           TO PB-C-LIVES
 15254     ELSE
 15255        MOVE ZEROS               TO PB-C-LIVES.
 15256
 15257     IF CPAYEEL     GREATER THAN ZEROS
 15258        MOVE CPAYEEI             TO PB-C-PAYEE-CODE.
 15259
 15260     IF CFORCEL     GREATER THAN ZEROS
 15261        MOVE CFORCEI             TO PB-FORCE-CODE.
 15262
 15263     IF CBILCDL     GREATER THAN ZEROS
 15264        MOVE CBILCDI             TO PB-RECORD-BILL.
 15265
 15266*    MOVE WS-REFERENCE           TO PB-C-REFERENCE.
 15267
 15268 2260-WRITE-PB-RECORD.
 15269     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY
 15270                                    PB-INPUT-BY.
 15271     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 15272     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT
 15273                                    PB-INPUT-DT.
 15274
 15275     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 15276     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 15277                                    PB-CONTROL-BY-ORIG-BATCH.
 15278
 15279     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 15280     MOVE WS-BATCH-CSR-ID        TO PB-CSR-ID.
 15281     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 15282     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 15283     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 15284
 15285     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 15286
 15287     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 15288
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 278
* EL6311.cbl
 15289     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 15290     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 15291     MOVE PB-SV-STATE            TO PI-SV-STATE.
 15292
 15293     ADD PB-C-LF-REF-CALC        TO WS-B-LF-CAN-PRM-COMPUTED.
 15294     ADD PB-C-AH-REF-CALC        TO WS-B-AH-CAN-PRM-COMPUTED.
 15295
 15296 2275-WRITE-PENDING-BUSINESS.
 15297     MOVE 'A'                    TO JP-RECORD-TYPE.
 15298     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15299     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15300     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15301
 15302
 15303* EXEC CICS HANDLE CONDITION
 15304*        DUPREC (2290-DUPLICATE-ALT-INDEX)
 15305*    END-EXEC.
 15306*    MOVE '"$%                   ! 4 #00013765' TO DFHEIV0
 15307     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 15308     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15309     MOVE X'3420233030303133373635' TO DFHEIV0(25:11)
 15310     CALL 'kxdfhei1' USING DFHEIV0
 15311     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15312
 15313
 15314
 15315* EXEC CICS WRITE
 15316*        DATASET (FILE-ID-ERPNDB)
 15317*        FROM    (PENDING-BUSINESS)
 15318*        RIDFLD  (PB-CONTROL-PRIMARY)
 15319*    END-EXEC.
 15320     MOVE LENGTH OF
 15321      PENDING-BUSINESS
 15322       TO DFHEIV11
 15323*    MOVE '&$ L                  ''   #00013769' TO DFHEIV0
 15324     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15325     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15326     MOVE X'2020233030303133373639' TO DFHEIV0(25:11)
 15327     CALL 'kxdfhei1' USING DFHEIV0,
 15328           FILE-ID-ERPNDB,
 15329           PENDING-BUSINESS,
 15330           DFHEIV11,
 15331           PB-CONTROL-PRIMARY,
 15332           DFHEIV99,
 15333           DFHEIV99
 15334     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15335
 15336
 15337     ADD +1                      TO WS-B-CANCEL-CNT-ENTERED.
 15338
 15339     PERFORM 8400-LOG-JOURNAL-RECORD  *> Journal Cancel Add
 15340
 15341******************************************************************
 15342*       A D D  O R I G I N A L  C E R T  I N F O                 *
 15343******************************************************************
 15344
 15345     display ' made it to add orig CANCEL cert '
 15346     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 279
* EL6311.cbl
 15347     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 15348     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 15349     MOVE PB-SV-STATE            TO ELCERT-STATE.
 15350
 15351
 15352* EXEC CICS READ
 15353*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 15354*        DATASET (FILE-ID-ELCERT)
 15355*        RIDFLD  (ELCERT-KEY)
 15356*        RESP    (WS-RESPONSE)
 15357*    END-EXEC.
 15358*    MOVE '&"S        E          (  N#00013789' TO DFHEIV0
 15359     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15360     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15361     MOVE X'204E233030303133373839' TO DFHEIV0(25:11)
 15362     CALL 'kxdfhei1' USING DFHEIV0,
 15363           FILE-ID-ELCERT,
 15364           DFHEIV20,
 15365           DFHEIV99,
 15366           ELCERT-KEY,
 15367           DFHEIV99,
 15368           DFHEIV99,
 15369           DFHEIV99
 15370     SET ADDRESS OF CERTIFICATE-MASTER TO
 15371         DFHEIV20
 15372     MOVE EIBRESP  TO WS-RESPONSE
 15373     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15374
 15375
 15376     IF NOT RESP-NORMAL
 15377        GO TO 2276-BYPASS-CRTO
 15378     END-IF
 15379
 15380     MOVE ELCERT-KEY             TO ERMAIL-KEY
 15381     MOVE ' '                    TO WS-ERMAIL-SW
 15382
 15383
 15384* EXEC CICS READ
 15385*       DATASET   (FILE-ID-ERMAIL)
 15386*       SET       (ADDRESS OF MAILING-DATA)
 15387*       RIDFLD    (ERMAIL-KEY)
 15388*       RESP      (WS-RESPONSE)
 15389*    END-EXEC
 15390*    MOVE '&"S        E          (  N#00013803' TO DFHEIV0
 15391     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15392     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15393     MOVE X'204E233030303133383033' TO DFHEIV0(25:11)
 15394     CALL 'kxdfhei1' USING DFHEIV0,
 15395           FILE-ID-ERMAIL,
 15396           DFHEIV20,
 15397           DFHEIV99,
 15398           ERMAIL-KEY,
 15399           DFHEIV99,
 15400           DFHEIV99,
 15401           DFHEIV99
 15402     SET ADDRESS OF MAILING-DATA TO
 15403         DFHEIV20
 15404     MOVE EIBRESP  TO WS-RESPONSE
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 280
* EL6311.cbl
 15405     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15406
 15407     IF RESP-NORMAL
 15408        SET ERMAIL-FOUND TO TRUE
 15409     END-IF
 15410
 15411     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 15412
 15413     MOVE SPACES                 TO ORIGINAL-CERTIFICATE
 15414     MOVE 'OC'                   TO OC-RECORD-ID
 15415     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 15416                                 TO OC-CONTROL-PRIMARY (1:33)
 15417     MOVE 'I'                    TO OC-RECORD-TYPE
 15418     MOVE +4096                  TO OC-KEY-SEQ-NO
 15419     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
 15420     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
 15421     MOVE WS-CURRENT-BIN-DT      TO OC-LAST-MAINT-DT
 15422
 15423     MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 15424     MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 15425     MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 15426     MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 15427     MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 15428     MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 15429     MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 15430     MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 15431     MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
 15432     MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
 15433     MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
 15434     MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
 15435     MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
 15436     MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
 15437     MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
 15438     MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
 15439     MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
 15440     MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
 15441     MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 15442     MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
 15443     MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
 15444     MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
 15445     MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
 15446     MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
 15447     MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
 15448     MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 15449     MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
 15450     MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
 15451     MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 15452     MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 15453     MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 15454     MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 15455
 15456     IF ERMAIL-FOUND
 15457        MOVE MA-CRED-BENE-NAME   TO OC-CRED-BENE-NAME
 15458     END-IF
 15459     IF NOT CERT-TRL-REC-NOT-FOUND
 15460        MOVE CS-INS-AGE-DEFAULT-FLAG TO
 15461                           OC-INS-AGE-DEFAULT-FLAG
 15462        MOVE CS-JNT-AGE-DEFAULT-FLAG TO
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 281
* EL6311.cbl
 15463                           OC-JNT-AGE-DEFAULT-FLAG
 15464     END-IF
 15465     MOVE LOW-VALUES             TO OC-ENDORSEMENT-PROCESSED-DT
 15466     .
 15467 2275-WRITE-ELCRTO.
 15468
 15469
 15470* EXEC CICS WRITE
 15471*       DATASET   ('ELCRTO')
 15472*       FROM      (ORIGINAL-CERTIFICATE)
 15473*       RIDFLD    (OC-CONTROL-PRIMARY)
 15474*       RESP      (WS-RESPONSE)
 15475*    END-EXEC
 15476     MOVE LENGTH OF
 15477      ORIGINAL-CERTIFICATE
 15478       TO DFHEIV11
 15479     MOVE 'ELCRTO' TO DFHEIV1
 15480*    MOVE '&$ L                  ''  N#00013872' TO DFHEIV0
 15481     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15482     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15483     MOVE X'204E233030303133383732' TO DFHEIV0(25:11)
 15484     CALL 'kxdfhei1' USING DFHEIV0,
 15485           DFHEIV1,
 15486           ORIGINAL-CERTIFICATE,
 15487           DFHEIV11,
 15488           OC-CONTROL-PRIMARY,
 15489           DFHEIV99,
 15490           DFHEIV99
 15491     MOVE EIBRESP  TO WS-RESPONSE
 15492     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15493
 15494     display ' just wrote 2275 ' ws-response
 15495     IF RESP-DUPKEY
 15496        SUBTRACT +1              FROM OC-KEY-SEQ-NO
 15497        GO TO 2275-WRITE-ELCRTO
 15498     ELSE
 15499        IF NOT RESP-NORMAL
 15500           MOVE -1               TO BMAINTL
 15501           MOVE ER-7450          TO EMI-ERROR
 15502           PERFORM 9900-ERROR-FORMAT
 15503                                 THRU 9900-EXIT
 15504           GO TO 8200-SEND-DATAONLY
 15505        END-IF
 15506     END-IF.
 15507
 15508 2276-BYPASS-CRTO.
 15509******************************************************************
 15510*       U P D A T E   T H E   B A T C H   H E A D E R            *
 15511******************************************************************
 15512
 15513
 15514* EXEC CICS READ
 15515*        INTO    (PENDING-BUSINESS)
 15516*        DATASET (FILE-ID-ERPNDB)
 15517*        RIDFLD  (ERPNDB-KEY)
 15518*        UPDATE
 15519*    END-EXEC.
 15520     MOVE LENGTH OF
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 282
* EL6311.cbl
 15521      PENDING-BUSINESS
 15522       TO DFHEIV11
 15523*    MOVE '&"IL       EU         (   #00013898' TO DFHEIV0
 15524     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15525     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15526     MOVE X'2020233030303133383938' TO DFHEIV0(25:11)
 15527     CALL 'kxdfhei1' USING DFHEIV0,
 15528           FILE-ID-ERPNDB,
 15529           PENDING-BUSINESS,
 15530           DFHEIV11,
 15531           ERPNDB-KEY,
 15532           DFHEIV99,
 15533           DFHEIV99,
 15534           DFHEIV99
 15535     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15536
 15537
 15538     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15539     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15540     MOVE 'B'                    TO JP-RECORD-TYPE.
 15541     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15542
 15543     PERFORM 8400-LOG-JOURNAL-RECORD  *> Before BHDR Image
 15544
 15545     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 15546
 15547
 15548* EXEC CICS REWRITE
 15549*        DATASET (FILE-ID-ERPNDB)
 15550*        FROM    (PENDING-BUSINESS)
 15551*    END-EXEC.
 15552     MOVE LENGTH OF
 15553      PENDING-BUSINESS
 15554       TO DFHEIV11
 15555*    MOVE '&& L                  %   #00013914' TO DFHEIV0
 15556     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15557     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15558     MOVE X'2020233030303133393134' TO DFHEIV0(25:11)
 15559     CALL 'kxdfhei1' USING DFHEIV0,
 15560           FILE-ID-ERPNDB,
 15561           PENDING-BUSINESS,
 15562           DFHEIV11,
 15563           DFHEIV99
 15564     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15565
 15566
 15567     MOVE 'C'                    TO JP-RECORD-TYPE.
 15568     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15569
 15570     PERFORM 8400-LOG-JOURNAL-RECORD  *> After BHDR Image
 15571
 15572     IF WS-ERRORS-PRESENT
 15573        GO TO 3900-RE-DISPLAY-RECORD.
 15574
 15575     MOVE ZEROS                  TO EMI-ERROR.
 15576     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15577     MOVE LOW-VALUES             TO EL631CI.
 15578     MOVE  -1                    TO CMAINTL.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 283
* EL6311.cbl
 15579     GO TO 8100-SEND-INITIAL-MAP.
 15580
 15581 2280-BATCH-HDR-NOT-FOUND.
 15582     MOVE -1                     TO BMAINTL.
 15583     MOVE ER-7450                TO EMI-ERROR.
 15584     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15585     GO TO 8200-SEND-DATAONLY.
 15586
 15587 2290-DUPLICATE-ALT-INDEX.
 15588
 15589******************************************************************
 15590*                                                                *
 15591*      IF THE PB-B-HIGHEST-SEQ-NO WAS NOT UPDATED IN THE DATA    *
 15592*         ENTRY SESSION, ADD +1 TO THE HIGHEST SEQUENCE NUMBER   *
 15593*         AND ATTEMPT TO WRITE THE RECORD AGAIN. REPEAT THIS     *
 15594*         50 TIMES.  IF DUPREC CONDITION IS STILL ENCOUNTERED    *
 15595*         AFTER 50 TIMES, ASSUME THE DUPLICATE RECORD WAS        *
 15596*         CAUSED BY A DUPLICATE ALTERNATE KEY.                   *
 15597*                                                                *
 15598******************************************************************
 15599
 15600     IF LCP-ONCTR-02 =  0
 15601         ADD 1 TO LCP-ONCTR-02
 15602        MOVE +0                  TO WS-SEQ-NO-COUNTER.
 15603
 15604     ADD +1                      TO WS-SEQ-NO-COUNTER.
 15605
 15606     IF  WS-SEQ-NO-COUNTER GREATER THAN +50
 15607         NEXT SENTENCE
 15608     ELSE
 15609         ADD +1 TO PB-BATCH-SEQ-NO
 15610                   PB-CSR-BATCH-SEQ-NO
 15611         MOVE PB-BATCH-SEQ-NO TO WS-B-HIGHEST-SEQ-NO
 15612         GO TO 2275-WRITE-PENDING-BUSINESS.
 15613
 15614     MOVE -1                     TO CCERTNOL.
 15615     MOVE AL-UABON               TO CCERTNOA.
 15616     MOVE AL-UNBON               TO CEFFDTA.
 15617
 15618     MOVE 1                      TO EMI-SUB
 15619                                    EMI-SWITCH1
 15620                                    EMI-SWITCH-AREA-1
 15621                                    EMI-SWITCH-AREA-2.
 15622
 15623     MOVE SPACES                 TO EMI-ERROR-LINES.
 15624
 15625
 15626* EXEC CICS SYNCPOINT ROLLBACK
 15627*    END-EXEC.
 15628*    MOVE '6"R                   !   #00013977' TO DFHEIV0
 15629     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 15630     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15631     MOVE X'2020233030303133393737' TO DFHEIV0(25:11)
 15632     CALL 'kxdfhei1' USING DFHEIV0
 15633     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15634
 15635
 15636     MOVE ER-2247                TO EMI-ERROR.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 284
* EL6311.cbl
 15637     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15638     GO TO 8200-SEND-DATAONLY.
 15639
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 285
* EL6311.cbl
 15641
 15642******************************************************************
 15643*                                                                *
 15644*          C H A N G E   C A N C E L   R O U T I N E             *
 15645*                                                                *
 15646******************************************************************
 15647
 15648***************************************************************
 15649*                                                             *
 15650*     1. GETMAIN FOR PENDING BUSINESS RECORD.                 *
 15651*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
 15652*     3. GET THE RECORD TO BE UPDATED AND SEE IF IT HAS BEEN  *
 15653*              BILLED.  IF IT HAS THEN SAVE A COPY OF THE     *
 15654*              ZERO RECORD FOR CREATING REVERSAL ENTRIES.     *
 15655*     4. UPDATE THE RECORD WITH THE SCREEN DATA               *
 15656*     5. LINK TO THE EDIT ROUTINE.                            *
 15657*     6. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
 15658*     7. REDISPLAY SCREEN DATA WITH NEW DATA RETURNED FROM    *
 15659*              THE EDIT ROUTINE.                              *
 15660*     7. REWRITE THE NEW ISSUE                                *
 15661*     8. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
 15662*                                                             *
 15663***************************************************************
 15664 2300-CHANGE-CANCEL-ROUTINE.
 15665     MOVE 'C'                    TO PI-MAINT-FUNCTION.
 15666
 15667     IF CCHGL NOT = ZEROS
 15668        MOVE ER-2196             TO EMI-ERROR
 15669        MOVE AL-UABON            TO CMAINTA
 15670        MOVE -1                  TO CMAINTL
 15671        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15672        GO TO 8200-SEND-DATAONLY.
 15673
 15674     MOVE CCERTNOI               TO WS-NEW-PRIME.
 15675
 15676     IF CSUFIXL NOT = ZEROS
 15677        MOVE CSUFIXI             TO WS-NEW-SUFFIX
 15678     ELSE
 15679        MOVE SPACE               TO WS-NEW-SUFFIX.
 15680
 15681     MOVE CEFFDTI                TO DEEDIT-FIELD.
 15682     PERFORM 8600-DEEDIT.
 15683     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 15684     MOVE '4'                    TO DC-OPTION-CODE.
 15685
 15686     PERFORM 9700-DATE-LINK.
 15687
 15688     IF DATE-CONVERSION-ERROR
 15689        MOVE ER-0348             TO EMI-ERROR
 15690        MOVE -1                  TO CEFFDTL
 15691        MOVE AL-UABON            TO CEFFDTA
 15692        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15693        GO TO 8200-SEND-DATAONLY
 15694     ELSE
 15695        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 15696        MOVE AL-UANON            TO CEFFDTA
 15697        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 15698
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 286
* EL6311.cbl
 15699 2325-PROCESS-CANCEL-CHANGES.
 15700
 15701* EXEC CICS HANDLE CONDITION
 15702*         NOTFND    (2380-BATCH-HDR-NOT-FOUND)
 15703*    END-EXEC.
 15704*    MOVE '"$I                   ! 5 #00014044' TO DFHEIV0
 15705     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15706     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15707     MOVE X'3520233030303134303434' TO DFHEIV0(25:11)
 15708     CALL 'kxdfhei1' USING DFHEIV0
 15709     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15710
 15711
 15712     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 15713     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 15714     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 15715
 15716
 15717* EXEC CICS GETMAIN
 15718*        SET      (ADDRESS OF PENDING-BUSINESS)
 15719*        LENGTH   (ERPNDB-RECORD-LENGTH)
 15720*        INITIMG  (GETMAIN-SPACE)
 15721*     END-EXEC.
 15722*    MOVE ',"IL                  $   #00014052' TO DFHEIV0
 15723     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 15724     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15725     MOVE X'2020233030303134303532' TO DFHEIV0(25:11)
 15726     CALL 'kxdfhei1' USING DFHEIV0,
 15727           DFHEIV20,
 15728           ERPNDB-RECORD-LENGTH,
 15729           GETMAIN-SPACE
 15730     SET ADDRESS OF PENDING-BUSINESS TO
 15731         DFHEIV20
 15732     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15733
 15734
 15735
 15736* EXEC CICS READ
 15737*        INTO    (PENDING-BUSINESS)
 15738*        DATASET (FILE-ID-ERPNDB)
 15739*        RIDFLD  (ERPNDB-KEY)
 15740*    END-EXEC.
 15741     MOVE LENGTH OF
 15742      PENDING-BUSINESS
 15743       TO DFHEIV11
 15744*    MOVE '&"IL       E          (   #00014058' TO DFHEIV0
 15745     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15746     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15747     MOVE X'2020233030303134303538' TO DFHEIV0(25:11)
 15748     CALL 'kxdfhei1' USING DFHEIV0,
 15749           FILE-ID-ERPNDB,
 15750           PENDING-BUSINESS,
 15751           DFHEIV11,
 15752           ERPNDB-KEY,
 15753           DFHEIV99,
 15754           DFHEIV99,
 15755           DFHEIV99
 15756     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 287
* EL6311.cbl
 15757
 15758
 15759     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 15760
 15761
 15762* EXEC CICS HANDLE CONDITION
 15763*         NOTFND     (2385-REC-NOT-FOUND)
 15764*    END-EXEC.
 15765*    MOVE '"$I                   ! 6 #00014066' TO DFHEIV0
 15766     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15767     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15768     MOVE X'3620233030303134303636' TO DFHEIV0(25:11)
 15769     CALL 'kxdfhei1' USING DFHEIV0
 15770     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15771
 15772
 15773**********************************************************
 15774*      DONT READ THE RECORD FOR UPDATE UNTIL             *
 15775*      AFTER THE CHANGE RECORD HAS BEEN CREATED.         *
 15776**********************************************************
 15777
 15778
 15779* EXEC CICS READ
 15780*        DATASET (FILE-ID-ERPNDB)
 15781*        INTO    (PENDING-BUSINESS)
 15782*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 15783*    END-EXEC.
 15784     MOVE LENGTH OF
 15785      PENDING-BUSINESS
 15786       TO DFHEIV11
 15787*    MOVE '&"IL       E          (   #00014075' TO DFHEIV0
 15788     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15789     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15790     MOVE X'2020233030303134303735' TO DFHEIV0(25:11)
 15791     CALL 'kxdfhei1' USING DFHEIV0,
 15792           FILE-ID-ERPNDB,
 15793           PENDING-BUSINESS,
 15794           DFHEIV11,
 15795           PI-PREV-CONTROL-PRIMARY,
 15796           DFHEIV99,
 15797           DFHEIV99,
 15798           DFHEIV99
 15799     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15800
 15801
 15802********** DO NOT ALLOW CHANGES IF THRU A/R
 15803     IF BMAINTI = 'C'
 15804         IF PB-EL860-INTERNAL-PROCESS
 15805             MOVE ER-4005          TO EMI-ERROR
 15806             MOVE -1               TO BMAINTL
 15807             MOVE AL-UABON         TO BMAINTA
 15808             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15809             GO TO 8200-SEND-DATAONLY.
 15810**********
 15811
 15812     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 15813        MOVE -1                 TO CMAINTL
 15814        MOVE ER-2197            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 288
* EL6311.cbl
 15815        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15816        GO TO 8200-SEND-DATAONLY.
 15817
 15818     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 15819        MOVE ER-2196             TO EMI-ERROR
 15820        MOVE AL-UABON            TO CMAINTA
 15821        MOVE -1                  TO CMAINTL
 15822        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15823        GO TO 8200-SEND-DATAONLY.
 15824     MOVE ZEROS                  TO WS-SEQ-SAVE.
 15825
 15826     IF PB-BILLED-DT = LOW-VALUES AND
 15827        PB-CHG-COUNT = ZEROS
 15828        NEXT SENTENCE
 15829     ELSE
 15830        IF (CREFND1L GREATER THAN ZEROS AND
 15831            WS-CREFND1 NOT = PB-C-LF-CANCEL-AMT)
 15832           OR
 15833           (CREFND2L GREATER THAN ZEROS AND
 15834            WS-CREFND2 NOT = PB-C-AH-CANCEL-AMT)
 15835           PERFORM 2700-BUILD-CORRECTION-RECORD THRU 2799-EXIT.
 15836     if ((crefnd1l <> zeros)
 15837        and (ws-crefnd1 <> pb-c-lf-cancel-amt))
 15838                      or
 15839        ((crefnd2l <> zeros)
 15840        and (ws-crefnd2 <> pb-c-ah-cancel-amt))
 15841        continue
 15842     else
 15843        go to 2330-continue-change
 15844     end-if
 15845
 15846     move zeros                  to ws-check-amts
 15847     move ' '                    to ws-stop-sw
 15848                                    ws-check-sw
 15849                                    ws-any-check-sw
 15850                                    ws-proc-check-sw
 15851                                    ws-chek-browse-sw
 15852
 15853     perform 2500-browse-checks  thru 2500-exit
 15854
 15855     if i-have-processed-checks
 15856        or i-have-checks
 15857        continue
 15858     else
 15859        go to 2330-continue-change
 15860     end-if
 15861
 15862     if crefnd1l <> zeros
 15863        compute ws-lf-diff = ws-crefnd1 - pb-c-lf-cancel-amt
 15864        move ws-crefnd1 to ws-new-ref-total
 15865     else
 15866        move pb-c-lf-cancel-amt  to ws-new-ref-total
 15867     end-if
 15868     if crefnd2l <> zeros
 15869        compute ws-ah-diff = ws-crefnd2 - pb-c-ah-cancel-amt
 15870        compute ws-new-ref-total = ws-new-ref-total +
 15871           ws-crefnd2
 15872     else
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 289
* EL6311.cbl
 15873        compute ws-new-ref-total = ws-new-ref-total +
 15874           pb-c-ah-cancel-amt
 15875     end-if
 15876
 15877     if zeros = (ws-lf-diff + ws-ah-diff)
 15878        move er-3449             to emi-error
 15879        perform 9900-error-format thru 9900-exit
 15880        go to 2330-continue-change
 15881     end-if
 15882
 15883     if (ws-new-ref-total < ws-check-amts)
 15884        and (pb-c-refund-sw = 'Y')
 15885        move er-3447             to emi-error
 15886        perform 9900-error-format thru 9900-exit
 15887        move al-uabon            to cmainta
 15888        move -1                  to cmaintl
 15889        go to 8200-send-dataonly
 15890     end-if
 15891
 15892     if (ws-new-ref-total > ws-check-amts)
 15893        and (ws-check-amts not = zeros)
 15894        move er-3448             to emi-error
 15895        move al-uabon            to crefnd1a
 15896                                    crefnd2a
 15897        perform 9900-error-format thru 9900-exit
 15898     end-if
 15899
 15900*     if (ws-lf-diff + ws-ah-diff) < zeros
 15901*        move er-3447             to emi-error
 15902*        perform 9900-error-format thru 9900-exit
 15903*        move al-uabon            to cmainta
 15904*        move -1                  to cmaintl
 15905*        go to 8200-send-dataonly
 15906*     end-if
 15907     .
 15908 2330-continue-change.
 15909
 15910
 15911* EXEC CICS READ
 15912*        DATASET (FILE-ID-ERPNDB)
 15913*        INTO    (PENDING-BUSINESS)
 15914*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 15915*        UPDATE
 15916*    END-EXEC.
 15917     MOVE LENGTH OF
 15918      PENDING-BUSINESS
 15919       TO DFHEIV11
 15920*    MOVE '&"IL       EU         (   #00014189' TO DFHEIV0
 15921     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15922     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15923     MOVE X'2020233030303134313839' TO DFHEIV0(25:11)
 15924     CALL 'kxdfhei1' USING DFHEIV0,
 15925           FILE-ID-ERPNDB,
 15926           PENDING-BUSINESS,
 15927           DFHEIV11,
 15928           PI-PREV-CONTROL-PRIMARY,
 15929           DFHEIV99,
 15930           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 290
* EL6311.cbl
 15931           DFHEIV99
 15932     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15933
 15934
 15935     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15936     MOVE 'B'                    TO JP-RECORD-TYPE
 15937     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15938     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15939
 15940*    PERFORM 8400-LOG-JOURNAL-RECORD  *>Move closer to rewrite
 15941
 15942     IF PB-BILLED-DT NOT = LOW-VALUES OR
 15943          PB-CHG-COUNT NOT = ZEROS
 15944        IF (CREFND1L GREATER THAN ZEROS AND
 15945            WS-CREFND1 NOT = PB-C-LF-CANCEL-AMT)
 15946           OR
 15947           (CREFND2L GREATER THAN ZEROS AND
 15948            WS-CREFND2 NOT = PB-C-AH-CANCEL-AMT)
 15949            ADD +1                      TO PB-CHG-COUNT
 15950            MOVE LOW-VALUES             TO PB-BILLED-DT.
 15951
 15952*    IF CMICRNOL  GREATER  ZEROS
 15953*        IF CMICRNOI  NUMERIC
 15954*            MOVE CMICRNOI       TO  PB-C-MICROFILM-NO
 15955*            MOVE AL-UNNON       TO  CMICRNOA
 15956*        ELSE
 15957*            MOVE -1             TO  CMICRNOL
 15958*            MOVE AL-UNBON       TO  CMICRNOA
 15959*            MOVE ER-2701        TO  EMI-ERROR
 15960*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15961
 15962     IF CSUFIXL GREATER THAN ZEROS
 15963        MOVE CSUFIXI             TO PB-CERT-SFX.
 15964
 15965     IF CLSTNML GREATER THAN ZEROS
 15966         MOVE CLSTNMI            TO PB-C-LAST-NAME.
 15967
 15968     IF CCANREAL > ZEROS
 15969        MOVE CCANREAI            TO PB-C-CANCEL-REASON
 15970     END-IF
 15971     IF CCANDT1L    GREATER THAN ZEROS
 15972        MOVE WS-CONVERTED-CANDT1 TO PB-C-LF-CANCEL-DT.
 15973
 15974     IF CCANDT2L    GREATER THAN ZEROS
 15975        MOVE WS-CONVERTED-CANDT2 TO PB-C-AH-CANCEL-DT.
 15976
 15977     IF CMTHD1L    GREATER THAN +0
 15978        MOVE CMTHD1I             TO PB-C-LF-REFUND-OVERRIDE.
 15979
 15980     IF CMTHD2L    GREATER THAN +0
 15981        MOVE CMTHD2I             TO PB-C-AH-REFUND-OVERRIDE.
 15982
 15983     IF CREFND1L    GREATER THAN ZEROS
 15984        SUBTRACT PB-C-LF-CANCEL-AMT FROM WS-B-LF-CAN-PRM-ENTERED
 15985        ADD  WS-CREFND1          TO WS-B-LF-CAN-PRM-ENTERED
 15986        MOVE WS-CREFND1          TO PB-C-LF-CANCEL-AMT
 15987        MOVE SPACE               TO PB-C-LF-CALC-REQ.
 15988
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 291
* EL6311.cbl
 15989     IF CREFND2L    GREATER THAN ZEROS
 15990        SUBTRACT PB-C-AH-CANCEL-AMT FROM WS-B-AH-CAN-PRM-ENTERED
 15991        ADD  WS-CREFND2          TO WS-B-AH-CAN-PRM-ENTERED
 15992        MOVE WS-CREFND2          TO PB-C-AH-CANCEL-AMT
 15993        MOVE SPACE               TO PB-C-AH-CALC-REQ.
 15994
 15995     IF CLIVESL     GREATER THAN ZEROS
 15996        MOVE WS-CLIVES           TO PB-C-LIVES.
 15997
 15998     IF CPAYEEL     GREATER THAN ZEROS
 15999        MOVE CPAYEEI             TO PB-C-PAYEE-CODE.
 16000
 16001     IF CFORCEL     GREATER THAN ZEROS
 16002        MOVE CFORCEI             TO PB-FORCE-CODE.
 16003
 16004     IF CBILCDL     GREATER THAN ZEROS
 16005        MOVE CBILCDI             TO PB-RECORD-BILL.
 16006
 16007 2360-REWRITE-PB-RECORD.
 16008     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 16009     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 16010     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT.
 16011*    MOVE 'C'                    TO JP-RECORD-TYPE.
 16012*    MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16013     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16014*    MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 16015
 16016     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 16017
 16018     SUBTRACT PB-C-LF-REF-CALC   FROM WS-B-LF-CAN-PRM-COMPUTED.
 16019     SUBTRACT PB-C-AH-REF-CALC   FROM WS-B-AH-CAN-PRM-COMPUTED.
 16020
 16021     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 16022
 16023     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 16024
 16025     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 16026     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 16027     MOVE PB-SV-STATE            TO PI-SV-STATE.
 16028
 16029     ADD PB-C-LF-REF-CALC        TO WS-B-LF-CAN-PRM-COMPUTED.
 16030     ADD PB-C-AH-REF-CALC        TO WS-B-AH-CAN-PRM-COMPUTED.
 16031
 16032 2375-REWRITE-PENDING-BUSINESS.
 16033     PERFORM 8400-LOG-JOURNAL-RECORD  *>Before Cancel Image
 16034     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16035     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 16036     MOVE 'C'                    TO JP-RECORD-TYPE.
 16037     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16038
 16039
 16040* EXEC CICS REWRITE
 16041*        DATASET (FILE-ID-ERPNDB)
 16042*        FROM    (PENDING-BUSINESS)
 16043*    END-EXEC.
 16044     MOVE LENGTH OF
 16045      PENDING-BUSINESS
 16046       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 292
* EL6311.cbl
 16047*    MOVE '&& L                  %   #00014300' TO DFHEIV0
 16048     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16049     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16050     MOVE X'2020233030303134333030' TO DFHEIV0(25:11)
 16051     CALL 'kxdfhei1' USING DFHEIV0,
 16052           FILE-ID-ERPNDB,
 16053           PENDING-BUSINESS,
 16054           DFHEIV11,
 16055           DFHEIV99
 16056     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16057
 16058
 16059     PERFORM 8400-LOG-JOURNAL-RECORD  *> After Cancel Image
 16060
 16061******************************************************************
 16062*       U P D A T E   T H E   O R I G   C E R T   I N F O        *
 16063******************************************************************
 16064
 16065     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 16066     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 16067     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 16068     MOVE PB-SV-STATE            TO ELCERT-STATE.
 16069
 16070
 16071* EXEC CICS READ
 16072*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 16073*        DATASET (FILE-ID-ELCERT)
 16074*        RIDFLD  (ELCERT-KEY)
 16075*        RESP    (WS-RESPONSE)
 16076*    END-EXEC.
 16077*    MOVE '&"S        E          (  N#00014316' TO DFHEIV0
 16078     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16079     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16080     MOVE X'204E233030303134333136' TO DFHEIV0(25:11)
 16081     CALL 'kxdfhei1' USING DFHEIV0,
 16082           FILE-ID-ELCERT,
 16083           DFHEIV20,
 16084           DFHEIV99,
 16085           ELCERT-KEY,
 16086           DFHEIV99,
 16087           DFHEIV99,
 16088           DFHEIV99
 16089     SET ADDRESS OF CERTIFICATE-MASTER TO
 16090         DFHEIV20
 16091     MOVE EIBRESP  TO WS-RESPONSE
 16092     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16093
 16094
 16095     IF NOT RESP-NORMAL
 16096        GO TO 2376-BYPASS-CRTO
 16097     END-IF
 16098
 16099
 16100     MOVE ELCERT-KEY             TO ERMAIL-KEY
 16101     MOVE ' '                    TO WS-ERMAIL-SW
 16102
 16103
 16104* EXEC CICS READ
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 293
* EL6311.cbl
 16105*       DATASET   (FILE-ID-ERMAIL)
 16106*       SET       (ADDRESS OF MAILING-DATA)
 16107*       RIDFLD    (ERMAIL-KEY)
 16108*       RESP      (WS-RESPONSE)
 16109*    END-EXEC
 16110*    MOVE '&"S        E          (  N#00014331' TO DFHEIV0
 16111     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16112     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16113     MOVE X'204E233030303134333331' TO DFHEIV0(25:11)
 16114     CALL 'kxdfhei1' USING DFHEIV0,
 16115           FILE-ID-ERMAIL,
 16116           DFHEIV20,
 16117           DFHEIV99,
 16118           ERMAIL-KEY,
 16119           DFHEIV99,
 16120           DFHEIV99,
 16121           DFHEIV99
 16122     SET ADDRESS OF MAILING-DATA TO
 16123         DFHEIV20
 16124     MOVE EIBRESP  TO WS-RESPONSE
 16125     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16126
 16127     IF RESP-NORMAL
 16128        SET ERMAIL-FOUND TO TRUE
 16129     END-IF
 16130
 16131     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 16132
 16133     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 16134                                 TO ELCRTO-KEY
 16135     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 16136     MOVE +0                     TO ELCRTO-SEQ-NO
 16137
 16138
 16139* EXEC CICS READ
 16140*       DATASET   ('ELCRTO')
 16141*       INTO      (ORIGINAL-CERTIFICATE)
 16142*       RIDFLD    (ELCRTO-KEY)
 16143*       GTEQ
 16144*       RESP      (WS-RESPONSE)
 16145*    END-EXEC
 16146     MOVE LENGTH OF
 16147      ORIGINAL-CERTIFICATE
 16148       TO DFHEIV11
 16149     MOVE 'ELCRTO' TO DFHEIV1
 16150*    MOVE '&"IL       G          (  N#00014349' TO DFHEIV0
 16151     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 16152     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16153     MOVE X'204E233030303134333439' TO DFHEIV0(25:11)
 16154     CALL 'kxdfhei1' USING DFHEIV0,
 16155           DFHEIV1,
 16156           ORIGINAL-CERTIFICATE,
 16157           DFHEIV11,
 16158           ELCRTO-KEY,
 16159           DFHEIV99,
 16160           DFHEIV99,
 16161           DFHEIV99
 16162     MOVE EIBRESP  TO WS-RESPONSE
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 294
* EL6311.cbl
 16163     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16164
 16165     IF RESP-NORMAL
 16166        AND (OC-CONTROL-PRIMARY (1:33) =
 16167                 PB-CONTROL-BY-ACCOUNT (1:33))
 16168        AND (OC-RECORD-TYPE = 'I')
 16169        display ' resp norm, key =, type i '
 16170        IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 16171           display ' end proc blank '
 16172           display ' csr edit session ' PI-CSR-SESSION-SW
 16173           IF NOT CSR-EDIT-SESSION
 16174
 16175* EXEC CICS READ
 16176*                DATASET   ('ELCRTO')
 16177*                INTO      (ORIGINAL-CERTIFICATE)
 16178*                RIDFLD    (OC-CONTROL-PRIMARY)
 16179*                UPDATE
 16180*                RESP      (WS-RESPONSE)
 16181*             END-EXEC
 16182     MOVE LENGTH OF
 16183      ORIGINAL-CERTIFICATE
 16184       TO DFHEIV11
 16185     MOVE 'ELCRTO' TO DFHEIV1
 16186*    MOVE '&"IL       EU         (  N#00014366' TO DFHEIV0
 16187     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 16188     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16189     MOVE X'204E233030303134333636' TO DFHEIV0(25:11)
 16190     CALL 'kxdfhei1' USING DFHEIV0,
 16191           DFHEIV1,
 16192           ORIGINAL-CERTIFICATE,
 16193           DFHEIV11,
 16194           OC-CONTROL-PRIMARY,
 16195           DFHEIV99,
 16196           DFHEIV99,
 16197           DFHEIV99
 16198     MOVE EIBRESP  TO WS-RESPONSE
 16199     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16200              DISPLAY ' JUST DID READ UPD ' WS-RESPONSE
 16201              IF RESP-NORMAL
 16202                 display ' good read upd '
 16203                 IF OC-ISSUE-TRAN-IND = 'N'
 16204                    MOVE CM-INSURED-LAST-NAME   TO
 16205                         OC-INS-LAST-NAME
 16206                    MOVE CM-INSURED-FIRST-NAME  TO
 16207                         OC-INS-FIRST-NAME
 16208                    MOVE CM-INSURED-INITIAL2    TO
 16209                         OC-INS-MIDDLE-INIT
 16210                    MOVE CM-INSURED-ISSUE-AGE   TO
 16211                         OC-INS-AGE
 16212                    MOVE CM-JT-LAST-NAME        TO
 16213                         OC-JNT-LAST-NAME
 16214                    MOVE CM-JT-FIRST-NAME       TO
 16215                         OC-JNT-FIRST-NAME
 16216                    MOVE CM-JT-INITIAL          TO
 16217                         OC-JNT-MIDDLE-INIT
 16218                    MOVE CM-INSURED-JOINT-AGE   TO
 16219                         OC-JNT-AGE
 16220                    MOVE CM-LF-BENEFIT-CD       TO
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 295
* EL6311.cbl
 16221                         OC-LF-BENCD
 16222                    MOVE CM-LF-ORIG-TERM        TO
 16223                         OC-LF-TERM
 16224                    MOVE CM-LF-BENEFIT-AMT      TO
 16225                         OC-LF-BEN-AMT
 16226                    MOVE CM-LF-PREMIUM-AMT      TO
 16227                         OC-LF-PRM-AMT
 16228                    MOVE CM-LF-ALT-BENEFIT-AMT  TO
 16229                         OC-LF-ALT-BEN-AMT
 16230                    MOVE CM-LF-ALT-PREMIUM-AMT  TO
 16231                         OC-LF-ALT-PRM-AMT
 16232                    MOVE CM-LF-LOAN-EXPIRE-DT   TO
 16233                         OC-LF-EXP-DT
 16234                    MOVE CM-LIFE-COMM-PCT       TO
 16235                         OC-LF-COMM-PCT
 16236                    MOVE CM-AH-BENEFIT-CD       TO
 16237                         OC-AH-BENCD
 16238                    MOVE CM-AH-ORIG-TERM        TO
 16239                         OC-AH-TERM
 16240                    MOVE CM-AH-BENEFIT-AMT      TO
 16241                         OC-AH-BEN-AMT
 16242                    MOVE CM-AH-PREMIUM-AMT      TO
 16243                         OC-AH-PRM-AMT
 16244                    MOVE CM-AH-LOAN-EXPIRE-DT   TO
 16245                         OC-AH-EXP-DT
 16246                    MOVE CM-AH-COMM-PCT         TO
 16247                         OC-AH-COMM-PCT
 16248                    MOVE CM-AH-CRITICAL-PERIOD  TO
 16249                         OC-AH-CP
 16250                    MOVE CM-LOAN-1ST-PMT-DT     TO
 16251                         OC-1ST-PMT-DT
 16252                 END-IF
 16253                 MOVE PB-C-LF-CANCEL-DT      TO
 16254                         OC-LF-CANCEL-DT
 16255                 MOVE PB-C-LF-CANCEL-AMT     TO
 16256                         OC-LF-CANCEL-AMT
 16257                 MOVE CM-LF-ITD-CANCEL-AMT   TO
 16258                         OC-LF-ITD-CANCEL-AMT
 16259                 MOVE PB-C-AH-CANCEL-DT      TO
 16260                         OC-AH-CANCEL-DT
 16261                 MOVE PB-C-AH-CANCEL-AMT     TO
 16262                         OC-AH-CANCEL-AMT
 16263                 MOVE CM-AH-ITD-CANCEL-AMT   TO
 16264                         OC-AH-ITD-CANCEL-AMT
 16265                 MOVE 'Y'                    TO
 16266                         OC-CANCEL-TRAN-IND
 16267                 MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 16268                 MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 16269                 MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 16270                 IF ERMAIL-FOUND
 16271                    MOVE MA-CRED-BENE-NAME
 16272                                 TO OC-CRED-BENE-NAME
 16273                 END-IF
 16274                 IF NOT CERT-TRL-REC-NOT-FOUND
 16275                    MOVE CS-INS-AGE-DEFAULT-FLAG TO
 16276                           OC-INS-AGE-DEFAULT-FLAG
 16277                    MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 16278                           OC-JNT-AGE-DEFAULT-FLAG
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 296
* EL6311.cbl
 16279                 END-IF
 16280
 16281* EXEC CICS REWRITE
 16282*                   DATASET   ('ELCRTO')
 16283*                   FROM      (ORIGINAL-CERTIFICATE)
 16284*                   RESP      (WS-RESPONSE)
 16285*                END-EXEC
 16286     MOVE LENGTH OF
 16287      ORIGINAL-CERTIFICATE
 16288       TO DFHEIV11
 16289     MOVE 'ELCRTO' TO DFHEIV1
 16290*    MOVE '&& L                  %  N#00014453' TO DFHEIV0
 16291     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16292     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16293     MOVE X'204E233030303134343533' TO DFHEIV0(25:11)
 16294     CALL 'kxdfhei1' USING DFHEIV0,
 16295           DFHEIV1,
 16296           ORIGINAL-CERTIFICATE,
 16297           DFHEIV11,
 16298           DFHEIV99
 16299     MOVE EIBRESP  TO WS-RESPONSE
 16300     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16301                 display ' just rewrote ' ws-response
 16302              END-IF
 16303           END-IF
 16304        ELSE
 16305           SUBTRACT +1 FROM OC-KEY-SEQ-NO
 16306           MOVE 'OC'             TO OC-RECORD-ID
 16307           MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 16308           MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 16309           MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 16310           MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 16311           MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 16312           MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 16313           MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 16314           MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 16315           MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 16316           MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 16317           MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 16318           MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
 16319           MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
 16320           MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
 16321           MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
 16322           MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
 16323           MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
 16324           MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
 16325           MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
 16326           MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
 16327           MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
 16328           MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 16329           MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
 16330           MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
 16331           MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
 16332           MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
 16333           MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
 16334           MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
 16335           MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 16336           MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 297
* EL6311.cbl
 16337           MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
 16338           MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 16339           MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 16340           MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 16341           MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 16342           IF ERMAIL-FOUND
 16343              MOVE MA-CRED-BENE-NAME
 16344                                 TO OC-CRED-BENE-NAME
 16345           END-IF
 16346           IF NOT CERT-TRL-REC-NOT-FOUND
 16347              MOVE CS-INS-AGE-DEFAULT-FLAG TO
 16348                           OC-INS-AGE-DEFAULT-FLAG
 16349              MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 16350                           OC-JNT-AGE-DEFAULT-FLAG
 16351           END-IF
 16352           MOVE LOW-VALUES       TO OC-ENDORSEMENT-PROCESSED-DT
 16353
 16354* EXEC CICS WRITE
 16355*             DATASET   ('ELCRTO')
 16356*             FROM      (ORIGINAL-CERTIFICATE)
 16357*             RIDFLD    (OC-CONTROL-PRIMARY)
 16358*             RESP      (WS-RESPONSE)
 16359*          END-EXEC
 16360     MOVE LENGTH OF
 16361      ORIGINAL-CERTIFICATE
 16362       TO DFHEIV11
 16363     MOVE 'ELCRTO' TO DFHEIV1
 16364*    MOVE '&$ L                  ''  N#00014510' TO DFHEIV0
 16365     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16366     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16367     MOVE X'204E233030303134353130' TO DFHEIV0(25:11)
 16368     CALL 'kxdfhei1' USING DFHEIV0,
 16369           DFHEIV1,
 16370           ORIGINAL-CERTIFICATE,
 16371           DFHEIV11,
 16372           OC-CONTROL-PRIMARY,
 16373           DFHEIV99,
 16374           DFHEIV99
 16375     MOVE EIBRESP  TO WS-RESPONSE
 16376     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16377        END-IF
 16378     ELSE
 16379        MOVE SPACES              TO ORIGINAL-CERTIFICATE
 16380        MOVE 'OC'                TO OC-RECORD-ID
 16381        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 16382                                 TO OC-CONTROL-PRIMARY (1:33)
 16383        MOVE 'I'                 TO OC-RECORD-TYPE
 16384        MOVE +4096               TO OC-KEY-SEQ-NO
 16385        MOVE PI-PROCESSOR-ID     TO OC-LAST-MAINT-BY
 16386        MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 16387        MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 16388        MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 16389        MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 16390        MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 16391        MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 16392        MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 16393        MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 16394        MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 298
* EL6311.cbl
 16395        MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 16396        MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
 16397        MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
 16398        MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
 16399        MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
 16400        MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
 16401        MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
 16402        MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
 16403        MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
 16404        MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
 16405        MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
 16406        MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 16407        MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
 16408        MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
 16409        MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
 16410        MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
 16411        MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
 16412        MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
 16413        MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 16414        MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
 16415        MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
 16416        MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 16417        MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 16418        MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 16419        MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 16420        IF ERMAIL-FOUND
 16421           MOVE MA-CRED-BENE-NAME
 16422                                 TO OC-CRED-BENE-NAME
 16423        END-IF
 16424        IF NOT CERT-TRL-REC-NOT-FOUND
 16425           MOVE CS-INS-AGE-DEFAULT-FLAG TO
 16426                           OC-INS-AGE-DEFAULT-FLAG
 16427           MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 16428                           OC-JNT-AGE-DEFAULT-FLAG
 16429        END-IF
 16430        MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 16431
 16432
 16433* EXEC CICS WRITE
 16434*          DATASET   ('ELCRTO')
 16435*          FROM      (ORIGINAL-CERTIFICATE)
 16436*          RIDFLD    (OC-CONTROL-PRIMARY)
 16437*          RESP      (WS-RESPONSE)
 16438*       END-EXEC
 16439     MOVE LENGTH OF
 16440      ORIGINAL-CERTIFICATE
 16441       TO DFHEIV11
 16442     MOVE 'ELCRTO' TO DFHEIV1
 16443*    MOVE '&$ L                  ''  N#00014571' TO DFHEIV0
 16444     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16445     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16446     MOVE X'204E233030303134353731' TO DFHEIV0(25:11)
 16447     CALL 'kxdfhei1' USING DFHEIV0,
 16448           DFHEIV1,
 16449           ORIGINAL-CERTIFICATE,
 16450           DFHEIV11,
 16451           OC-CONTROL-PRIMARY,
 16452           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 299
* EL6311.cbl
 16453           DFHEIV99
 16454     MOVE EIBRESP  TO WS-RESPONSE
 16455     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16456     END-IF.
 16457
 16458 2376-BYPASS-CRTO.
 16459******************************************************************
 16460*       U P D A T E   T H E   B A T C H   H E A D E R            *
 16461******************************************************************
 16462
 16463
 16464* EXEC CICS HANDLE CONDITION
 16465*         NOTFND    (2380-BATCH-HDR-NOT-FOUND)
 16466*    END-EXEC.
 16467*    MOVE '"$I                   ! 7 #00014584' TO DFHEIV0
 16468     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16469     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16470     MOVE X'3720233030303134353834' TO DFHEIV0(25:11)
 16471     CALL 'kxdfhei1' USING DFHEIV0
 16472     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16473
 16474
 16475
 16476* EXEC CICS READ
 16477*        INTO    (PENDING-BUSINESS)
 16478*        DATASET (FILE-ID-ERPNDB)
 16479*        RIDFLD  (ERPNDB-KEY)
 16480*        UPDATE
 16481*    END-EXEC.
 16482     MOVE LENGTH OF
 16483      PENDING-BUSINESS
 16484       TO DFHEIV11
 16485*    MOVE '&"IL       EU         (   #00014588' TO DFHEIV0
 16486     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 16487     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16488     MOVE X'2020233030303134353838' TO DFHEIV0(25:11)
 16489     CALL 'kxdfhei1' USING DFHEIV0,
 16490           FILE-ID-ERPNDB,
 16491           PENDING-BUSINESS,
 16492           DFHEIV11,
 16493           ERPNDB-KEY,
 16494           DFHEIV99,
 16495           DFHEIV99,
 16496           DFHEIV99
 16497     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16498
 16499
 16500     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16501     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 16502     MOVE 'B'                    TO JP-RECORD-TYPE.
 16503     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16504
 16505     PERFORM 8400-LOG-JOURNAL-RECORD  *> Before BHDR Image
 16506
 16507     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 16508
 16509
 16510* EXEC CICS REWRITE
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 300
* EL6311.cbl
 16511*        DATASET (FILE-ID-ERPNDB)
 16512*        FROM    (PENDING-BUSINESS)
 16513*    END-EXEC.
 16514     MOVE LENGTH OF
 16515      PENDING-BUSINESS
 16516       TO DFHEIV11
 16517*    MOVE '&& L                  %   #00014604' TO DFHEIV0
 16518     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16519     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16520     MOVE X'2020233030303134363034' TO DFHEIV0(25:11)
 16521     CALL 'kxdfhei1' USING DFHEIV0,
 16522           FILE-ID-ERPNDB,
 16523           PENDING-BUSINESS,
 16524           DFHEIV11,
 16525           DFHEIV99
 16526     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16527
 16528
 16529     MOVE 'C'                    TO JP-RECORD-TYPE.
 16530     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16531
 16532     PERFORM 8400-LOG-JOURNAL-RECORD  *> After BHDR Image
 16533
 16534     IF WS-ERRORS-PRESENT
 16535         GO TO 3900-RE-DISPLAY-RECORD.
 16536
 16537     MOVE ZEROS                  TO EMI-ERROR
 16538     MOVE -1                     TO CMAINTL
 16539     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16540     GO TO 3900-RE-DISPLAY-RECORD.
 16541
 16542 2380-BATCH-HDR-NOT-FOUND.
 16543     MOVE -1                     TO BMAINTL.
 16544     MOVE ER-7450                TO EMI-ERROR.
 16545     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16546     GO TO 8200-SEND-DATAONLY.
 16547
 16548 2385-REC-NOT-FOUND.
 16549     MOVE -1                     TO BMAINTL.
 16550     MOVE ER-7451                TO EMI-ERROR.
 16551     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16552     GO TO 8200-SEND-DATAONLY.
 16553
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 301
* EL6311.cbl
 16555
 16556******************************************************************
 16557*                                                                *
 16558*          D E L E T E   C A N C E L   R O U T I N E             *
 16559*                                                                *
 16560******************************************************************
 16561
 16562 2400-DELETE-CANCEL-ROUTINE.
 16563     MOVE 'D'                    TO PI-MAINT-FUNCTION.
 16564
 16565     IF CCHGL NOT = ZEROS
 16566        MOVE ER-2196             TO EMI-ERROR
 16567        MOVE AL-UABON            TO CMAINTA
 16568        MOVE -1                  TO CMAINTL
 16569        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16570        GO TO 8200-SEND-DATAONLY.
 16571
 16572
 16573* EXEC CICS HANDLE CONDITION
 16574*         NOTFND    (2485-BATCH-HDR-NOT-FOUND)
 16575*    END-EXEC.
 16576*    MOVE '"$I                   ! 8 #00014652' TO DFHEIV0
 16577     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16578     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16579     MOVE X'3820233030303134363532' TO DFHEIV0(25:11)
 16580     CALL 'kxdfhei1' USING DFHEIV0
 16581     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16582
 16583
 16584     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 16585     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 16586     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 16587
 16588
 16589* EXEC CICS READ
 16590*        SET     (ADDRESS OF PENDING-BUSINESS)
 16591*        DATASET (FILE-ID-ERPNDB)
 16592*        RIDFLD  (ERPNDB-KEY)
 16593*    END-EXEC.
 16594*    MOVE '&"S        E          (   #00014660' TO DFHEIV0
 16595     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16596     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16597     MOVE X'2020233030303134363630' TO DFHEIV0(25:11)
 16598     CALL 'kxdfhei1' USING DFHEIV0,
 16599           FILE-ID-ERPNDB,
 16600           DFHEIV20,
 16601           DFHEIV99,
 16602           ERPNDB-KEY,
 16603           DFHEIV99,
 16604           DFHEIV99,
 16605           DFHEIV99
 16606     SET ADDRESS OF PENDING-BUSINESS TO
 16607         DFHEIV20
 16608     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16609
 16610
 16611     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 16612
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 302
* EL6311.cbl
 16613     MOVE CCERTNOI               TO WS-NEW-PRIME.
 16614
 16615     IF CSUFIXL NOT = ZEROS
 16616        MOVE CSUFIXI             TO WS-NEW-SUFFIX
 16617     ELSE
 16618        MOVE SPACE               TO WS-NEW-SUFFIX.
 16619
 16620     MOVE CEFFDTI                TO DEEDIT-FIELD.
 16621
 16622     PERFORM 8600-DEEDIT.
 16623     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 16624     MOVE '4'                    TO DC-OPTION-CODE.
 16625     PERFORM 9700-DATE-LINK.
 16626
 16627     IF DATE-CONVERSION-ERROR
 16628        MOVE ER-0348             TO EMI-ERROR
 16629        MOVE -1                  TO CEFFDTL
 16630        MOVE AL-UABON            TO CEFFDTA
 16631        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16632        GO TO 8200-SEND-DATAONLY
 16633     ELSE
 16634        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 16635        MOVE AL-UANON            TO CEFFDTA
 16636        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 16637
 16638
 16639* EXEC CICS HANDLE CONDITION
 16640*         NOTFND    (2490-RECORD-NOT-FOUND)
 16641*    END-EXEC.
 16642*    MOVE '"$I                   ! 9 #00014693' TO DFHEIV0
 16643     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16644     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16645     MOVE X'3920233030303134363933' TO DFHEIV0(25:11)
 16646     CALL 'kxdfhei1' USING DFHEIV0
 16647     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16648
 16649
 16650
 16651* EXEC CICS READ
 16652*        SET     (ADDRESS OF PENDING-BUSINESS)
 16653*        DATASET (FILE-ID-ERPNDB)
 16654*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 16655*        UPDATE
 16656*    END-EXEC.
 16657*    MOVE '&"S        EU         (   #00014697' TO DFHEIV0
 16658     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16659     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16660     MOVE X'2020233030303134363937' TO DFHEIV0(25:11)
 16661     CALL 'kxdfhei1' USING DFHEIV0,
 16662           FILE-ID-ERPNDB,
 16663           DFHEIV20,
 16664           DFHEIV99,
 16665           PI-PREV-CONTROL-PRIMARY,
 16666           DFHEIV99,
 16667           DFHEIV99,
 16668           DFHEIV99
 16669     SET ADDRESS OF PENDING-BUSINESS TO
 16670         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 303
* EL6311.cbl
 16671     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16672
 16673
 16674     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 16675        MOVE -1                 TO CMAINTL
 16676        MOVE ER-2197            TO EMI-ERROR
 16677        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16678        GO TO 8200-SEND-DATAONLY.
 16679
 16680     IF PB-BILLED-DT NOT = LOW-VALUES
 16681        MOVE -1                 TO CMAINTL
 16682        MOVE ER-2129            TO EMI-ERROR
 16683        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16684        GO TO 8200-SEND-DATAONLY.
 16685
 16686     IF PB-CHG-COUNT NOT = ZEROS
 16687        MOVE ER-2336            TO EMI-ERROR
 16688        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16689        MOVE AL-UABON            TO CMAINTA
 16690        MOVE -1                  TO CMAINTL
 16691        GO TO 8200-SEND-DATAONLY.
 16692
 16693     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 16694        PB-CHG-COUNT NOT = ZEROS
 16695        MOVE ER-2196             TO EMI-ERROR
 16696        MOVE AL-UABON            TO CMAINTA
 16697        MOVE -1                  TO CMAINTL
 16698        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16699        GO TO 8200-SEND-DATAONLY.
 16700
 16701     IF PB-CONFIRMATION-REPT-DT NOT = SPACES AND LOW-VALUES
 16702        MOVE ER-2900 TO EMI-ERROR
 16703        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16704        MOVE AL-UABON         TO CMAINTA
 16705        MOVE -1               TO CMAINTL
 16706        GO TO 8200-SEND-DATAONLY.
 16707     move ' '                    to ws-stop-sw
 16708                                    ws-check-sw
 16709                                    ws-any-check-sw
 16710                                    ws-proc-check-sw
 16711                                    ws-chek-browse-sw
 16712
 16713     perform 2500-browse-checks  thru 2500-exit
 16714     if (i-have-processed-checks)
 16715        and (pb-c-refund-sw = 'Y')
 16716        move er-3446             to emi-error
 16717        perform 9900-error-format thru 9900-exit
 16718        move al-uabon            to cmainta
 16719        move -1                  to cmaintl
 16720        go to 8200-send-dataonly
 16721     end-if
 16722
 16723* EXEC CICS HANDLE CONDITION
 16724*         NOTFND  (2475-CONTINUE-DELETE)
 16725*    END-EXEC
 16726*    MOVE '"$I                   ! : #00014752' TO DFHEIV0
 16727     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16728     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 304
* EL6311.cbl
 16729     MOVE X'3A20233030303134373532' TO DFHEIV0(25:11)
 16730     CALL 'kxdfhei1' USING DFHEIV0
 16731     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16732
 16733     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 16734     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 16735     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 16736     MOVE PB-SV-STATE            TO ELCERT-STATE.
 16737
 16738
 16739* EXEC CICS READ
 16740*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 16741*        DATASET (FILE-ID-ELCERT)
 16742*        RIDFLD  (ELCERT-KEY)
 16743*        UPDATE
 16744*    END-EXEC.
 16745*    MOVE '&"S        EU         (   #00014761' TO DFHEIV0
 16746     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16747     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16748     MOVE X'2020233030303134373631' TO DFHEIV0(25:11)
 16749     CALL 'kxdfhei1' USING DFHEIV0,
 16750           FILE-ID-ELCERT,
 16751           DFHEIV20,
 16752           DFHEIV99,
 16753           ELCERT-KEY,
 16754           DFHEIV99,
 16755           DFHEIV99,
 16756           DFHEIV99
 16757     SET ADDRESS OF CERTIFICATE-MASTER TO
 16758         DFHEIV20
 16759     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16760
 16761
 16762     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16763
 16764     MOVE FILE-ID-ELCERT         TO JP-FILE-ID.
 16765     MOVE 'B'                    TO JP-RECORD-TYPE.
 16766     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 16767     PERFORM 8400-LOG-JOURNAL-RECORD.
 16768
 16769     IF PB-CI-LIVES NOT NUMERIC
 16770         MOVE ZERO                    TO PB-CI-LIVES.
 16771
 16772     IF PB-C-LF-CANCEL-DT GREATER THAN LOW-VALUES
 16773        IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 16774           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16775           MOVE ZERO                     TO CM-LF-ITD-CANCEL-AMT
 16776           MOVE LOW-VALUES               TO CM-LF-CANCEL-EXIT-DT
 16777                                            CM-LF-CANCEL-DT
 16778           MOVE SPACE                    TO CM-LF-EXIT-BATCH
 16779        ELSE
 16780           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16781           MOVE PB-CI-LF-CANCEL-AMT      TO CM-LF-ITD-CANCEL-AMT
 16782           MOVE PB-CI-LF-PRIOR-CANCEL-DT TO CM-LF-CANCEL-DT
 16783           MOVE PB-CI-LIVES              TO CM-LIVES.
 16784
 16785     IF PB-C-LF-CANCEL-DT GREATER THAN LOW-VALUES
 16786        IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 305
* EL6311.cbl
 16787           IF CM-LF-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 16788               MOVE CM-LF-STATUS-AT-CANCEL
 16789                                        TO CM-LF-CURRENT-STATUS
 16790               MOVE SPACE
 16791                                        TO CM-LF-STATUS-AT-CANCEL
 16792           ELSE
 16793               MOVE PB-CI-LF-POLICY-STATUS
 16794                                        TO CM-LF-CURRENT-STATUS
 16795        ELSE
 16796           MOVE PB-CI-LF-POLICY-STATUS  TO CM-LF-CURRENT-STATUS.
 16797
 16798
 16799     IF PB-C-AH-CANCEL-DT GREATER THAN LOW-VALUES
 16800        IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 16801           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16802           MOVE ZERO                     TO CM-AH-ITD-CANCEL-AMT
 16803           MOVE LOW-VALUES               TO CM-AH-CANCEL-EXIT-DT
 16804                                            CM-AH-CANCEL-DT
 16805           MOVE SPACE                    TO CM-AH-EXIT-BATCH
 16806        ELSE
 16807           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16808           MOVE PB-CI-AH-CANCEL-AMT      TO CM-AH-ITD-CANCEL-AMT
 16809           MOVE PB-CI-AH-PRIOR-CANCEL-DT TO CM-AH-CANCEL-DT
 16810           MOVE PB-CI-LIVES              TO CM-LIVES.
 16811
 16812     IF PB-C-AH-CANCEL-DT GREATER THAN LOW-VALUES
 16813        IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 16814           IF CM-AH-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 16815               MOVE CM-AH-STATUS-AT-CANCEL
 16816                                        TO CM-AH-CURRENT-STATUS
 16817               MOVE SPACE
 16818                                        TO CM-AH-STATUS-AT-CANCEL
 16819           ELSE
 16820               MOVE PB-CI-AH-POLICY-STATUS
 16821                                        TO CM-AH-CURRENT-STATUS
 16822        ELSE
 16823           MOVE PB-CI-AH-POLICY-STATUS  TO CM-AH-CURRENT-STATUS.
 16824
 16825 2450-REWRITE-CERT.
 16826     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 16827     MOVE 'C'                      TO JP-RECORD-TYPE.
 16828     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 16829
 16830
 16831* EXEC CICS REWRITE
 16832*        DATASET  (FILE-ID-ELCERT)
 16833*        FROM     (CERTIFICATE-MASTER)
 16834*    END-EXEC.
 16835     MOVE LENGTH OF
 16836      CERTIFICATE-MASTER
 16837       TO DFHEIV11
 16838*    MOVE '&& L                  %   #00014836' TO DFHEIV0
 16839     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16840     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16841     MOVE X'2020233030303134383336' TO DFHEIV0(25:11)
 16842     CALL 'kxdfhei1' USING DFHEIV0,
 16843           FILE-ID-ELCERT,
 16844           CERTIFICATE-MASTER,
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 306
* EL6311.cbl
 16845           DFHEIV11,
 16846           DFHEIV99
 16847     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16848
 16849
 16850     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 16851
 16852     PERFORM 8400-LOG-JOURNAL-RECORD.
 16853
 16854     move ' '                    to ws-stop-sw
 16855                                    ws-any-check-sw
 16856                                    ws-proc-check-sw
 16857                                    ws-chek-browse-sw
 16858
 16859     if i-have-checks
 16860        perform until i-say-stop
 16861           perform 2510-startbr-erchek
 16862                                 thru 2510-exit
 16863           if resp-normal
 16864              perform 2520-readnext-erchek
 16865                                 thru 2520-exit
 16866           end-if
 16867           if (not resp-normal)
 16868              or (pb-control-by-account (1:33) not =
 16869                 ch-control-primary (1:33))
 16870                 set i-say-stop to true
 16871           else
 16872              perform 2530-readupd-erchek
 16873                                 thru 2530-exit
 16874              if resp-normal
 16875                 perform 2540-delete-erchek
 16876                                 thru 2540-exit
 16877              end-if
 16878              if ws-chek-browse-sw = 'Y'
 16879                 perform 2525-endbr-erchek
 16880                                 thru 2525-exit
 16881                 move ' '        to ws-chek-browse-sw
 16882              end-if
 16883           end-if
 16884        end-perform
 16885     end-if
 16886
 16887     if ws-chek-browse-sw = 'Y'
 16888        perform 2525-endbr-erchek thru 2525-exit
 16889     end-if
 16890     .
 16891 2475-CONTINUE-DELETE.
 16892     SUBTRACT PB-C-LF-CANCEL-AMT  FROM WS-B-LF-CAN-PRM-ENTERED.
 16893     SUBTRACT PB-C-AH-CANCEL-AMT  FROM WS-B-AH-CAN-PRM-ENTERED.
 16894
 16895     SUBTRACT PB-C-LF-REF-CALC    FROM WS-B-LF-CAN-PRM-COMPUTED.
 16896     SUBTRACT PB-C-AH-REF-CALC    FROM WS-B-AH-CAN-PRM-COMPUTED.
 16897
 16898     SUBTRACT +1 FROM WS-B-CANCEL-CNT-ENTERED.
 16899
 16900     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID
 16901     MOVE 'D'                    TO JP-RECORD-TYPE
 16902     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 307
* EL6311.cbl
 16903
 16904
 16905* EXEC CICS DELETE
 16906*        DATASET    (FILE-ID-ERPNDB)
 16907*    END-EXEC.
 16908*    MOVE '&(                    &   #00014895' TO DFHEIV0
 16909     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16910     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16911     MOVE X'2020233030303134383935' TO DFHEIV0(25:11)
 16912     CALL 'kxdfhei1' USING DFHEIV0,
 16913           FILE-ID-ERPNDB,
 16914           DFHEIV99,
 16915           DFHEIV99,
 16916           DFHEIV99,
 16917           DFHEIV99
 16918     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16919
 16920
 16921     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16922
 16923     PERFORM 8400-LOG-JOURNAL-RECORD  *> Journal Cancel Delete
 16924
 16925     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 16926     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 16927
 16928
 16929* EXEC CICS HANDLE CONDITION
 16930*         NOTFND    (2485-BATCH-HDR-NOT-FOUND)
 16931*    END-EXEC.
 16932*    MOVE '"$I                   ! ; #00014906' TO DFHEIV0
 16933     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16934     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16935     MOVE X'3B20233030303134393036' TO DFHEIV0(25:11)
 16936     CALL 'kxdfhei1' USING DFHEIV0
 16937     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16938
 16939
 16940
 16941* EXEC CICS READ
 16942*        SET     (ADDRESS OF PENDING-BUSINESS)
 16943*        DATASET (FILE-ID-ERPNDB)
 16944*        RIDFLD  (ERPNDB-KEY)
 16945*        UPDATE
 16946*    END-EXEC.
 16947*    MOVE '&"S        EU         (   #00014910' TO DFHEIV0
 16948     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16949     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16950     MOVE X'2020233030303134393130' TO DFHEIV0(25:11)
 16951     CALL 'kxdfhei1' USING DFHEIV0,
 16952           FILE-ID-ERPNDB,
 16953           DFHEIV20,
 16954           DFHEIV99,
 16955           ERPNDB-KEY,
 16956           DFHEIV99,
 16957           DFHEIV99,
 16958           DFHEIV99
 16959     SET ADDRESS OF PENDING-BUSINESS TO
 16960         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 308
* EL6311.cbl
 16961     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16962
 16963
 16964     MOVE FILE-ID-ERPNDB           TO JP-FILE-ID.
 16965     MOVE ERPNDB-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 16966
 16967     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 16968        WS-B-CANCEL-CNT-ENTERED = ZEROS
 16969        MOVE 'D'                 TO JP-RECORD-TYPE
 16970        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 16971
 16972* EXEC CICS DELETE
 16973*            DATASET    (FILE-ID-ERPNDB)
 16974*       END-EXEC
 16975*    MOVE '&(                    &   #00014924' TO DFHEIV0
 16976     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16977     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16978     MOVE X'2020233030303134393234' TO DFHEIV0(25:11)
 16979     CALL 'kxdfhei1' USING DFHEIV0,
 16980           FILE-ID-ERPNDB,
 16981           DFHEIV99,
 16982           DFHEIV99,
 16983           DFHEIV99,
 16984           DFHEIV99
 16985     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16986        PERFORM 8400-LOG-JOURNAL-RECORD  *> Journal BHDR Delete
 16987     ELSE
 16988        MOVE 'B'                 TO JP-RECORD-TYPE
 16989        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 16990        PERFORM 8400-LOG-JOURNAL-RECORD  *> Before BHDR Image
 16991        MOVE WS-BATCH-RECORD     TO PB-BATCH-RECORD
 16992        MOVE 'C'                 TO JP-RECORD-TYPE
 16993        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 16994
 16995* EXEC CICS REWRITE
 16996*            DATASET    (FILE-ID-ERPNDB)
 16997*            FROM       (PENDING-BUSINESS)
 16998*       END-EXEC
 16999     MOVE LENGTH OF
 17000      PENDING-BUSINESS
 17001       TO DFHEIV11
 17002*    MOVE '&& L                  %   #00014935' TO DFHEIV0
 17003     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17004     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17005     MOVE X'2020233030303134393335' TO DFHEIV0(25:11)
 17006     CALL 'kxdfhei1' USING DFHEIV0,
 17007           FILE-ID-ERPNDB,
 17008           PENDING-BUSINESS,
 17009           DFHEIV11,
 17010           DFHEIV99
 17011     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17012        PERFORM 8400-LOG-JOURNAL-RECORD  *> After BHDR Image
 17013     end-if
 17014
 17015******************************************************************
 17016*                                                                *
 17017*       DELETE THE A/R REQUEST RECORD IF THE COMPANY USES        *
 17018*       THE ACCOUNTS RECEIVABLE SYSTEM.                          *
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 309
* EL6311.cbl
 17019*                                                                *
 17020******************************************************************
 17021
 17022     IF NOT PI-AR-PROCESSING
 17023        GO TO 2480-DELETE-FINISHED.
 17024
 17025     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 17026        WS-B-CANCEL-CNT-ENTERED = ZEROS
 17027        NEXT SENTENCE
 17028     ELSE
 17029        GO TO 2480-DELETE-FINISHED.
 17030
 17031
 17032* EXEC CICS HANDLE CONDITION
 17033*         NOTFND    (2480-DELETE-FINISHED)
 17034*    END-EXEC.
 17035*    MOVE '"$I                   ! < #00014958' TO DFHEIV0
 17036     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17037     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17038     MOVE X'3C20233030303134393538' TO DFHEIV0(25:11)
 17039     CALL 'kxdfhei1' USING DFHEIV0
 17040     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17041
 17042
 17043     MOVE ERPNDB-COMPANY-CD      TO ERRQST-COMPANY-CD.
 17044     MOVE ERPNDB-ENTRY-BATCH     TO ERRQST-ENTRY-BATCH.
 17045
 17046
 17047* EXEC CICS READ
 17048*        SET     (ADDRESS OF AR-REQUEST-RECORD)
 17049*        DATASET (FILE-ID-ERRQST)
 17050*        RIDFLD  (ERRQST-KEY)
 17051*        UPDATE
 17052*    END-EXEC.
 17053*    MOVE '&"S        EU         (   #00014965' TO DFHEIV0
 17054     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17055     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17056     MOVE X'2020233030303134393635' TO DFHEIV0(25:11)
 17057     CALL 'kxdfhei1' USING DFHEIV0,
 17058           FILE-ID-ERRQST,
 17059           DFHEIV20,
 17060           DFHEIV99,
 17061           ERRQST-KEY,
 17062           DFHEIV99,
 17063           DFHEIV99,
 17064           DFHEIV99
 17065     SET ADDRESS OF AR-REQUEST-RECORD TO
 17066         DFHEIV20
 17067     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17068
 17069
 17070     MOVE ERRQST-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 17071
 17072     MOVE  FILE-ID-ERRQST          TO JP-FILE-ID.
 17073
 17074     MOVE 'D'                      TO JP-RECORD-TYPE.
 17075     MOVE AR-REQUEST-RECORD        TO JP-RECORD-AREA.
 17076
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 310
* EL6311.cbl
 17077
 17078* EXEC CICS DELETE
 17079*         DATASET    (FILE-ID-ERRQST)
 17080*    END-EXEC.
 17081*    MOVE '&(                    &   #00014979' TO DFHEIV0
 17082     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17083     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17084     MOVE X'2020233030303134393739' TO DFHEIV0(25:11)
 17085     CALL 'kxdfhei1' USING DFHEIV0,
 17086           FILE-ID-ERRQST,
 17087           DFHEIV99,
 17088           DFHEIV99,
 17089           DFHEIV99,
 17090           DFHEIV99
 17091     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17092
 17093
 17094     PERFORM 8400-LOG-JOURNAL-RECORD.
 17095
 17096 2480-DELETE-FINISHED.
 17097     MOVE ZEROS                  TO EMI-ERROR.
 17098     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17099     MOVE LOW-VALUES             TO EL631CI.
 17100     MOVE -1                     TO CMAINTL.
 17101     GO TO 8100-SEND-INITIAL-MAP.
 17102
 17103 2485-BATCH-HDR-NOT-FOUND.
 17104     MOVE -1                     TO CMAINTL
 17105     MOVE AL-UABON               TO CMAINTA.
 17106     MOVE ER-7450                TO EMI-ERROR.
 17107     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17108     GO TO 8200-SEND-DATAONLY.
 17109
 17110 2490-RECORD-NOT-FOUND.
 17111     MOVE -1                     TO CMAINTL
 17112     MOVE AL-UABON               TO CMAINTA.
 17113     MOVE ER-7451                TO EMI-ERROR.
 17114     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17115     GO TO 8200-SEND-DATAONLY.
 17116***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
 17117***                                                            ***
 17118***     2500  B R O W S E   C H E C K S                        ***
 17119***  We perform this routine from 2 different places.          ***
 17120***  1. If the user changes the refund amount on a cancel, we  ***
 17121***    want to.........                                        ***
 17122***    a. determine if prior checks have been processed        ***
 17123***    b. If the amt is larger, display message instructing    ***
 17124***     them to create another check to make up the difference.***
 17125***    c. If the amt is less, do not allow the change and      ***
 17126***     display a FATAL error suggesting they deal with check  ***
 17127***     records befor continuing.                              ***
 17128***  2. If the user wants to delete a cancel record we......   ***
 17129***    a. browse through all the checks and if there is a      ***
 17130***     processed check, send FATAL message.                   ***
 17131***    b. If there is a non-released check, then delete that   ***
 17132***     check after you delete the pending cancel record.      ***
 17133***                                                            ***
 17134***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 311
* EL6311.cbl
 17135
 17136 2500-browse-checks.
 17137
 17138     perform 2510-startbr-erchek thru 2510-exit
 17139
 17140     if not resp-normal
 17141        go to 2500-exit
 17142     end-if
 17143
 17144     perform until i-say-stop
 17145        perform 2520-readnext-erchek
 17146                                 thru 2520-exit
 17147        if (not resp-normal)
 17148           or (pb-control-by-account (1:33) not =
 17149              ch-control-primary (1:33))
 17150              set i-say-stop to true
 17151        else
 17152           set i-have-a-check-period to true
 17153           if (ch-approval-status) = ' '
 17154              and (ch-void-dt = low-values)
 17155              and (ch-released-dt = low-values)
 17156              set i-have-checks to true
 17157           else
 17158              if ch-void-dt = low-values
 17159                 set i-have-processed-checks to true
 17160              end-if
 17161           end-if
 17162           if (ch-credit-accept-dt = low-values)
 17163              and (ch-void-dt = low-values)
 17164              and (ch-approval-status = ' ' OR 'P' OR 'A')
 17165              if (ch-check-origin-sw not = 'R')
 17166                 and (pb-record-type = '2')
 17167                 continue
 17168              else
 17169                 compute ws-check-amts =
 17170                    ws-check-amts + ch-amount-paid
 17171              end-if
 17172           end-if
 17173        end-if
 17174     end-perform
 17175
 17176     if ws-chek-browse-sw = 'Y'
 17177        perform 2525-endbr-erchek thru 2525-exit
 17178     end-if
 17179
 17180    .
 17181 2500-exit.
 17182     exit.
 17183
 17184 2510-startbr-erchek.
 17185
 17186     move pb-control-by-account  to erchek-key
 17187     move +0                     to chek-record-seq
 17188
 17189
 17190* exec cics startbr
 17191*       dataset   ('ERCHEK')
 17192*       ridfld    (erchek-key)
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 312
* EL6311.cbl
 17193*       gteq
 17194*       resp      (ws-response)
 17195*    end-exec
 17196     MOVE 'ERCHEK' TO DFHEIV1
 17197     MOVE 0
 17198       TO DFHEIV11
 17199*    MOVE '&,         G          &  N#00015078' TO DFHEIV0
 17200     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 17201     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17202     MOVE X'204E233030303135303738' TO DFHEIV0(25:11)
 17203     CALL 'kxdfhei1' USING DFHEIV0,
 17204           DFHEIV1,
 17205           erchek-key,
 17206           DFHEIV99,
 17207           DFHEIV11,
 17208           DFHEIV99
 17209     MOVE EIBRESP  TO ws-response
 17210     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17211
 17212     IF RESP-NORMAL
 17213        move 'Y'                 to ws-chek-browse-sw
 17214     end-if
 17215
 17216     .
 17217 2510-exit.
 17218     exit.
 17219
 17220 2520-readnext-erchek.
 17221
 17222
 17223* EXEC CICS READNEXT
 17224*       SET     (ADDRESS OF CHECK-RECORDS)
 17225*       DATASET ('ERCHEK')
 17226*       RIDFLD  (ERCHEK-KEY)
 17227*       RESP    (WS-RESPONSE)
 17228*    END-EXEC
 17229     MOVE 'ERCHEK' TO DFHEIV1
 17230     MOVE 0
 17231       TO DFHEIV11
 17232*    MOVE '&.S                   )  N#00015095' TO DFHEIV0
 17233     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 17234     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 17235     MOVE X'204E233030303135303935' TO DFHEIV0(25:11)
 17236     CALL 'kxdfhei1' USING DFHEIV0,
 17237           DFHEIV1,
 17238           DFHEIV20,
 17239           DFHEIV99,
 17240           ERCHEK-KEY,
 17241           DFHEIV99,
 17242           DFHEIV11,
 17243           DFHEIV99,
 17244           DFHEIV99
 17245     SET ADDRESS OF CHECK-RECORDS TO
 17246         DFHEIV20
 17247     MOVE EIBRESP  TO WS-RESPONSE
 17248     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17249
 17250     .
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 313
* EL6311.cbl
 17251 2520-exit.
 17252     exit.
 17253
 17254 2525-endbr-erchek.
 17255
 17256
 17257* exec cics endbr
 17258*       dataset  ('ERCHEK')
 17259*    end-exec
 17260     MOVE 'ERCHEK' TO DFHEIV1
 17261     MOVE 0
 17262       TO DFHEIV11
 17263*    MOVE '&2                    $   #00015108' TO DFHEIV0
 17264     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 17265     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17266     MOVE X'2020233030303135313038' TO DFHEIV0(25:11)
 17267     CALL 'kxdfhei1' USING DFHEIV0,
 17268           DFHEIV1,
 17269           DFHEIV11,
 17270           DFHEIV99
 17271     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17272
 17273     .
 17274 2525-exit.
 17275     exit.
 17276
 17277 2530-readupd-erchek.
 17278
 17279
 17280* EXEC CICS READ
 17281*       UPDATE
 17282*       SET     (ADDRESS OF CHECK-RECORDS)
 17283*       DATASET ('ERCHEK')
 17284*       RIDFLD  (ERCHEK-KEY)
 17285*       RESP    (WS-RESPONSE)
 17286*    END-EXEC
 17287     MOVE 'ERCHEK' TO DFHEIV1
 17288*    MOVE '&"S        EU         (  N#00015118' TO DFHEIV0
 17289     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17290     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17291     MOVE X'204E233030303135313138' TO DFHEIV0(25:11)
 17292     CALL 'kxdfhei1' USING DFHEIV0,
 17293           DFHEIV1,
 17294           DFHEIV20,
 17295           DFHEIV99,
 17296           ERCHEK-KEY,
 17297           DFHEIV99,
 17298           DFHEIV99,
 17299           DFHEIV99
 17300     SET ADDRESS OF CHECK-RECORDS TO
 17301         DFHEIV20
 17302     MOVE EIBRESP  TO WS-RESPONSE
 17303     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17304
 17305     .
 17306 2530-exit.
 17307     exit.
 17308
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 314
* EL6311.cbl
 17309 2540-delete-erchek.
 17310
 17311
 17312* EXEC CICS DELETE
 17313*       DATASET ('ERCHEK')
 17314*       RESP    (WS-RESPONSE)
 17315*    END-EXEC
 17316     MOVE 'ERCHEK' TO DFHEIV1
 17317*    MOVE '&(                    &  N#00015132' TO DFHEIV0
 17318     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17319     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17320     MOVE X'204E233030303135313332' TO DFHEIV0(25:11)
 17321     CALL 'kxdfhei1' USING DFHEIV0,
 17322           DFHEIV1,
 17323           DFHEIV99,
 17324           DFHEIV99,
 17325           DFHEIV99,
 17326           DFHEIV99
 17327     MOVE EIBRESP  TO WS-RESPONSE
 17328     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17329
 17330     .
 17331 2540-exit.
 17332     exit.
 17333***************************************************************
 17334*                                                             *
 17335*       B U I L D   C O R R E C T I O N   R E C O R D         *
 17336*                                                             *
 17337***************************************************************
 17338
 17339***************************************************************
 17340*     ROUTINE TO CREATE COPY OF ZERO RECORD WHEN CHANGING     *
 17341*     AN ALREADY BILLED RECORD.                               *
 17342***************************************************************
 17343
 17344 2700-BUILD-CORRECTION-RECORD.
 17345     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 17346     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 17347     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 17348     MOVE '5'                    TO DC-OPTION-CODE.
 17349     PERFORM 9700-DATE-LINK.
 17350     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 17351
 17352     IF PB-CHG-COUNT = ZEROS
 17353        MOVE +1                  TO WS-SEQ-SAVE
 17354     ELSE
 17355        ADD +1  PB-CHG-COUNT     TO WS-SEQ-SAVE.
 17356
 17357     COMPUTE PB-BATCH-CHG-SEQ-NO = 1000 - WS-SEQ-SAVE.
 17358     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-ALT-CHG-SEQ-NO.
 17359
 17360     MOVE PB-CONTROL-PRIMARY     TO PB-CONTROL-BY-ORIG-BATCH.
 17361
 17362     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 17363     MOVE 'A'                    TO JP-RECORD-TYPE.
 17364     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17365
 17366
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 315
* EL6311.cbl
 17367* EXEC CICS WRITE
 17368*        DATASET    (FILE-ID-ERPNDB)
 17369*        FROM       (PENDING-BUSINESS)
 17370*        RIDFLD     (PB-CONTROL-PRIMARY)
 17371*    END-EXEC.
 17372     MOVE LENGTH OF
 17373      PENDING-BUSINESS
 17374       TO DFHEIV11
 17375*    MOVE '&$ L                  ''   #00015173' TO DFHEIV0
 17376     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17377     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17378     MOVE X'2020233030303135313733' TO DFHEIV0(25:11)
 17379     CALL 'kxdfhei1' USING DFHEIV0,
 17380           FILE-ID-ERPNDB,
 17381           PENDING-BUSINESS,
 17382           DFHEIV11,
 17383           PB-CONTROL-PRIMARY,
 17384           DFHEIV99,
 17385           DFHEIV99
 17386     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17387
 17388
 17389     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17390
 17391     PERFORM 8400-LOG-JOURNAL-RECORD  *> Journal Add
 17392     .
 17393 2799-EXIT.
 17394      EXIT.
 17395
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 316
* EL6311.cbl
 17397
 17398******************************************************************
 17399*                                                                *
 17400*        R E W R I T E   I S S U E   C E R T.   K E Y            *
 17401*                 'K' transaction                                *
 17402******************************************************************
 17403
 17404 2800-REWRITE-ISSUE-CERT-KEY.
 17405     MOVE  PI-PREV-ALT-KEY       TO  ERPNDB-ALT-KEY.
 17406
 17407     IF  BCERTNOL GREATER THAN ZEROS
 17408         MOVE BCERTNOI           TO  ERPNDB-CERT-PRIME.
 17409
 17410     IF  BSUFIXL  GREATER THAN ZEROS
 17411         MOVE BSUFIXI            TO  ERPNDB-CERT-SFX.
 17412
 17413     IF  BEFFDTL  GREATER THAN ZEROS
 17414         MOVE WS-CONVERTED-EFFDT TO  ERPNDB-CERT-EFF-DT.
 17415     move pi-prev-control-primary to pa-current-key
 17416     move erpndb-alt-key          to pa-new-alt-key
 17417     move spaces                  to pa-return-area
 17418
 17419
 17420* EXEC CICS LINK
 17421*       PROGRAM   ('EL055')
 17422*       COMMAREA  (EL055-PASS-AREA)
 17423*       LENGTH    (256)
 17424*    END-EXEC
 17425     MOVE 'EL055' TO DFHEIV1
 17426     MOVE 256
 17427       TO DFHEIV11
 17428*    MOVE '."C                   (   #00015209' TO DFHEIV0
 17429     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17430     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17431     MOVE X'2020233030303135323039' TO DFHEIV0(25:11)
 17432     CALL 'kxdfhei1' USING DFHEIV0,
 17433           DFHEIV1,
 17434           EL055-PASS-AREA,
 17435           DFHEIV11,
 17436           DFHEIV99,
 17437           DFHEIV99,
 17438           DFHEIV99,
 17439           DFHEIV99
 17440     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17441     if ra-status-code = +99  *> found a claim
 17442        move -1                  to bmaintl
 17443        move al-uabon            to bmainta
 17444        move er-2878             to emi-error
 17445        perform 9900-error-format thru 9900-exit
 17446        go to 8200-send-dataonly
 17447     end-if
 17448
 17449     if ra-status-code = +88  *> found dup cert
 17450        move -1                  to bmaintl
 17451        move al-uabon            to bmainta
 17452        move er-0229             to emi-error
 17453        perform 9900-error-format thru 9900-exit
 17454        go to 8200-send-dataonly
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 317
* EL6311.cbl
 17455     end-if
 17456     GO TO 1325-PROCESS-ISSUE-CHANGES
 17457     .
 17458******************************************************************
 17459*                                                                *
 17460*         R E W R I T E   C A N C E L   C E R T.   K E Y         *
 17461*                                                                *
 17462******************************************************************
 17463
 17464 2900-REWRITE-CAN-CERT-KEY.
 17465     MOVE  PI-PREV-ALT-KEY       TO  ERPNDB-ALT-KEY.
 17466
 17467     IF  CCERTNOL GREATER THAN ZEROS
 17468         MOVE  CCERTNOI          TO  ERPNDB-CERT-PRIME.
 17469
 17470     IF  CSUFIXL  GREATER THAN ZEROS
 17471         MOVE  CSUFIXI           TO  ERPNDB-CERT-SFX.
 17472
 17473     IF  CEFFDTL  GREATER THAN ZEROS
 17474         MOVE WS-CONVERTED-EFFDT TO  ERPNDB-CERT-EFF-DT.
 17475
 17476 2910-READ-BY-ACCOUNT.
 17477
 17478* EXEC CICS HANDLE CONDITION
 17479*         NOTFND    (2920-PROCESS-REWRITE)
 17480*    END-EXEC.
 17481*    MOVE '"$I                   ! = #00015250' TO DFHEIV0
 17482     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17483     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17484     MOVE X'3D20233030303135323530' TO DFHEIV0(25:11)
 17485     CALL 'kxdfhei1' USING DFHEIV0
 17486     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17487
 17488
 17489
 17490* EXEC CICS READ
 17491*        SET     (ADDRESS OF PENDING-BUSINESS)
 17492*        DATASET (FILE-ID-ERPNDB2)
 17493*        RIDFLD  (ERPNDB-ALT-KEY)
 17494*    END-EXEC.
 17495*    MOVE '&"S        E          (   #00015254' TO DFHEIV0
 17496     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17497     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17498     MOVE X'2020233030303135323534' TO DFHEIV0(25:11)
 17499     CALL 'kxdfhei1' USING DFHEIV0,
 17500           FILE-ID-ERPNDB2,
 17501           DFHEIV20,
 17502           DFHEIV99,
 17503           ERPNDB-ALT-KEY,
 17504           DFHEIV99,
 17505           DFHEIV99,
 17506           DFHEIV99
 17507     SET ADDRESS OF PENDING-BUSINESS TO
 17508         DFHEIV20
 17509     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17510
 17511
 17512     GO TO 2990-DUPLICATE-RECORD.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 318
* EL6311.cbl
 17513
 17514  2920-PROCESS-REWRITE.
 17515
 17516* EXEC CICS HANDLE CONDITION
 17517*         NOTFND    (2985-RECORD-MISSING)
 17518*    END-EXEC.
 17519*    MOVE '"$I                   ! > #00015263' TO DFHEIV0
 17520     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17521     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17522     MOVE X'3E20233030303135323633' TO DFHEIV0(25:11)
 17523     CALL 'kxdfhei1' USING DFHEIV0
 17524     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17525
 17526
 17527     MOVE  PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 17528
 17529
 17530* EXEC CICS READ
 17531*        SET     (ADDRESS OF PENDING-BUSINESS)
 17532*        DATASET (FILE-ID-ERPNDB)
 17533*        RIDFLD  (ERPNDB-KEY)
 17534*        UPDATE
 17535*    END-EXEC.
 17536*    MOVE '&"S        EU         (   #00015269' TO DFHEIV0
 17537     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17538     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17539     MOVE X'2020233030303135323639' TO DFHEIV0(25:11)
 17540     CALL 'kxdfhei1' USING DFHEIV0,
 17541           FILE-ID-ERPNDB,
 17542           DFHEIV20,
 17543           DFHEIV99,
 17544           ERPNDB-KEY,
 17545           DFHEIV99,
 17546           DFHEIV99,
 17547           DFHEIV99
 17548     SET ADDRESS OF PENDING-BUSINESS TO
 17549         DFHEIV20
 17550     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17551
 17552
 17553     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 17554     MOVE 'D'                    TO JP-RECORD-TYPE.
 17555     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17556     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17557
 17558     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 17559
 17560     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 17561     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 17562     MOVE PB-SV-STATE            TO ELCERT-STATE.
 17563
 17564
 17565* EXEC CICS DELETE
 17566*        DATASET    (FILE-ID-ERPNDB)
 17567*    END-EXEC.
 17568*    MOVE '&(                    &   #00015287' TO DFHEIV0
 17569     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17570     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 319
* EL6311.cbl
 17571     MOVE X'2020233030303135323837' TO DFHEIV0(25:11)
 17572     CALL 'kxdfhei1' USING DFHEIV0,
 17573           FILE-ID-ERPNDB,
 17574           DFHEIV99,
 17575           DFHEIV99,
 17576           DFHEIV99,
 17577           DFHEIV99
 17578     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17579
 17580
 17581     PERFORM 8400-LOG-JOURNAL-RECORD  *> Journal Cancel Delete
 17582
 17583
 17584* EXEC CICS GETMAIN
 17585*        SET      (ADDRESS OF PENDING-BUSINESS)
 17586*        LENGTH   (ERPNDB-RECORD-LENGTH)
 17587*        INITIMG  (GETMAIN-SPACE)
 17588*    END-EXEC.
 17589*    MOVE ',"IL                  $   #00015293' TO DFHEIV0
 17590     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17591     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17592     MOVE X'2020233030303135323933' TO DFHEIV0(25:11)
 17593     CALL 'kxdfhei1' USING DFHEIV0,
 17594           DFHEIV20,
 17595           ERPNDB-RECORD-LENGTH,
 17596           GETMAIN-SPACE
 17597     SET ADDRESS OF PENDING-BUSINESS TO
 17598         DFHEIV20
 17599     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17600
 17601
 17602     MOVE JP-RECORD-AREA         TO PENDING-BUSINESS.
 17603
 17604 2950-PROCESS-CANCELS.
 17605
 17606
 17607* EXEC CICS HANDLE CONDITION
 17608*         NOTFND  (2960-BUILD-NEW-CANCEL-RECORD)
 17609*    END-EXEC.
 17610*    MOVE '"$I                   ! ? #00015303' TO DFHEIV0
 17611     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17612     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17613     MOVE X'3F20233030303135333033' TO DFHEIV0(25:11)
 17614     CALL 'kxdfhei1' USING DFHEIV0
 17615     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17616
 17617
 17618
 17619* EXEC CICS READ
 17620*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 17621*        DATASET (FILE-ID-ELCERT)
 17622*        RIDFLD  (ELCERT-KEY)
 17623*        UPDATE
 17624*    END-EXEC.
 17625*    MOVE '&"S        EU         (   #00015307' TO DFHEIV0
 17626     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17627     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17628     MOVE X'2020233030303135333037' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 320
* EL6311.cbl
 17629     CALL 'kxdfhei1' USING DFHEIV0,
 17630           FILE-ID-ELCERT,
 17631           DFHEIV20,
 17632           DFHEIV99,
 17633           ELCERT-KEY,
 17634           DFHEIV99,
 17635           DFHEIV99,
 17636           DFHEIV99
 17637     SET ADDRESS OF CERTIFICATE-MASTER TO
 17638         DFHEIV20
 17639     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17640
 17641
 17642     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 17643
 17644     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 17645     MOVE 'B'                      TO JP-RECORD-TYPE.
 17646     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 17647     PERFORM 8400-LOG-JOURNAL-RECORD.
 17648
 17649     IF PB-CI-LIVES NOT NUMERIC
 17650         MOVE ZERO                    TO PB-CI-LIVES.
 17651
 17652     IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 17653        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 17654        MOVE ZERO                     TO CM-LF-ITD-CANCEL-AMT
 17655        MOVE LOW-VALUES               TO CM-LF-CANCEL-EXIT-DT
 17656                                         CM-LF-CANCEL-DT
 17657     ELSE
 17658        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 17659        MOVE PB-CI-LF-CANCEL-AMT      TO CM-LF-ITD-CANCEL-AMT
 17660        MOVE PB-CI-LF-PRIOR-CANCEL-DT TO CM-LF-CANCEL-DT
 17661        MOVE PB-CI-LIVES              TO CM-LIVES.
 17662
 17663     IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 17664        IF CM-LF-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 17665            MOVE CM-LF-STATUS-AT-CANCEL
 17666                                     TO CM-LF-CURRENT-STATUS
 17667            MOVE SPACE
 17668                                     TO CM-LF-STATUS-AT-CANCEL
 17669        ELSE
 17670            MOVE PB-CI-LF-POLICY-STATUS
 17671                                     TO CM-LF-CURRENT-STATUS
 17672     ELSE
 17673        MOVE PB-CI-LF-POLICY-STATUS  TO CM-LF-CURRENT-STATUS.
 17674
 17675     IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 17676        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 17677        MOVE ZERO                     TO CM-AH-ITD-CANCEL-AMT
 17678        MOVE LOW-VALUES               TO CM-AH-CANCEL-EXIT-DT
 17679                                         CM-AH-CANCEL-DT
 17680     ELSE
 17681        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 17682        MOVE PB-CI-AH-CANCEL-AMT      TO CM-AH-ITD-CANCEL-AMT
 17683        MOVE PB-CI-AH-PRIOR-CANCEL-DT TO CM-AH-CANCEL-DT
 17684        MOVE PB-CI-LIVES              TO CM-LIVES.
 17685
 17686     IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 321
* EL6311.cbl
 17687        IF CM-AH-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 17688            MOVE CM-AH-STATUS-AT-CANCEL
 17689                                     TO CM-AH-CURRENT-STATUS
 17690            MOVE SPACE
 17691                                     TO CM-AH-STATUS-AT-CANCEL
 17692        ELSE
 17693            MOVE PB-CI-AH-POLICY-STATUS
 17694                                     TO CM-AH-CURRENT-STATUS
 17695     ELSE
 17696        MOVE PB-CI-AH-POLICY-STATUS  TO CM-AH-CURRENT-STATUS.
 17697
 17698 2975-REWRITE-CERT.
 17699     MOVE 'C'                      TO JP-RECORD-TYPE.
 17700     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 17701
 17702
 17703* EXEC CICS REWRITE
 17704*        DATASET    (FILE-ID-ELCERT)
 17705*        FROM       (CERTIFICATE-MASTER)
 17706*    END-EXEC.
 17707     MOVE LENGTH OF
 17708      CERTIFICATE-MASTER
 17709       TO DFHEIV11
 17710*    MOVE '&& L                  %   #00015374' TO DFHEIV0
 17711     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17712     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17713     MOVE X'2020233030303135333734' TO DFHEIV0(25:11)
 17714     CALL 'kxdfhei1' USING DFHEIV0,
 17715           FILE-ID-ELCERT,
 17716           CERTIFICATE-MASTER,
 17717           DFHEIV11,
 17718           DFHEIV99
 17719     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17720
 17721
 17722     PERFORM 8400-LOG-JOURNAL-RECORD.
 17723
 17724 2960-BUILD-NEW-CANCEL-RECORD.
 17725     IF  CCERTNOL GREATER THAN ZEROS
 17726         MOVE CCERTNOI            TO PB-CERT-PRIME.
 17727
 17728     IF  CSUFIXL  GREATER THAN ZEROS
 17729         MOVE CSUFIXI             TO PB-CERT-SFX.
 17730
 17731     IF  CEFFDTL  GREATER  THAN ZEROS
 17732         MOVE WS-CONVERTED-EFFDT  TO PB-CERT-EFF-DT.
 17733
 17734 2970-WRITE-PENDING-BUSINESS.
 17735     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 17736     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 17737     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 17738     MOVE '5'                    TO DC-OPTION-CODE.
 17739     PERFORM 9700-DATE-LINK.
 17740     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 17741
 17742     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 17743
 17744     MOVE SPACES                 TO PB-CI-INSURED-NAME
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 322
* EL6311.cbl
 17745                                    PB-CI-INSURED-SEX
 17746                                    PB-CI-LF-BENEFIT-CD
 17747                                    PB-CI-AH-BENEFIT-CD
 17748                                    PB-CI-RATE-CLASS
 17749                                    PB-CI-RATE-DEV-LF
 17750                                    PB-CI-RATE-DEV-AH
 17751                                    PB-CI-LF-ABBR
 17752                                    PB-CI-AH-ABBR
 17753                                    PB-CI-OB-FLAG
 17754                                    PB-CI-LF-POLICY-STATUS
 17755                                    PB-CI-AH-POLICY-STATUS
 17756                                    PB-CI-INDV-GRP-CD
 17757                                    PB-CI-BENEFICIARY-NAME
 17758                                    PB-CI-NOTE-SW
 17759                                    PB-CI-SOC-SEC-NO
 17760                                    PB-CI-MEMBER-NO
 17761                                    PB-CI-INT-CODE
 17762                                    PB-CI-COMP-EXCP-SW
 17763                                    PB-CI-ENTRY-STATUS
 17764                                    PB-CI-CREDIT-INTERFACE-SW-1
 17765                                    PB-CI-CREDIT-INTERFACE-SW-2
 17766                                    PB-CI-ENTRY-BATCH.
 17767
 17768     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
 17769                                    PB-CI-AH-SETTLEMENT-DT
 17770                                    PB-CI-DEATH-DT
 17771                                    PB-CI-LF-PRIOR-CANCEL-DT
 17772                                    PB-CI-AH-PRIOR-CANCEL-DT
 17773                                    PB-CI-LOAN-1ST-PMT-DT
 17774                                    PB-CI-ENTRY-DT
 17775                                    PB-CI-LF-EXPIRE-DT
 17776                                    PB-CI-AH-EXPIRE-DT.
 17777
 17778     MOVE ZEROS                  TO PB-CI-INSURED-AGE
 17779                                    PB-CI-LF-TERM
 17780                                    PB-CI-LF-BENEFIT-AMT
 17781                                    PB-CI-LF-ALT-BENEFIT-AMT
 17782                                    PB-CI-LF-PREMIUM-AMT
 17783                                    PB-CI-LF-ALT-PREMIUM-AMT
 17784                                    PB-CI-AH-TERM
 17785                                    PB-CI-AH-BENEFIT-AMT
 17786                                    PB-CI-AH-PREMIUM-AMT
 17787                                    PB-CI-RATE-DEV-PCT-LF
 17788                                    PB-CI-RATE-DEV-PCT-AH
 17789                                    PB-CI-LIFE-COMMISSION
 17790                                    PB-CI-AH-COMMISSION
 17791                                    PB-CI-PAY-FREQUENCY
 17792                                    PB-CI-LOAN-APR
 17793                                    PB-CI-LOAN-TERM
 17794                                    PB-CI-CURR-SEQ
 17795                                    PB-CI-AH-CANCEL-AMT
 17796                                    PB-CI-LF-CANCEL-AMT
 17797                                    PB-CI-EXTENTION-DAYS
 17798                                    PB-CI-TERM-IN-DAYS
 17799                                    PB-CI-LOAN-OFFICER
 17800                                    PB-CI-LIVES
 17801                                    PB-CI-LF-CRIT-PER
 17802                                    PB-CI-AH-CRIT-PER
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 323
* EL6311.cbl
 17803                                    PB-C-LF-REM-TERM
 17804                                    PB-C-AH-REM-TERM.
 17805
 17806     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 17807     MOVE 'A'                    TO JP-RECORD-TYPE.
 17808     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17809
 17810
 17811* EXEC CICS HANDLE CONDITION
 17812*        DUPREC   (2990-DUPLICATE-RECORD)
 17813*    END-EXEC.
 17814*    MOVE '"$%                   ! @ #00015467' TO DFHEIV0
 17815     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 17816     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17817     MOVE X'4020233030303135343637' TO DFHEIV0(25:11)
 17818     CALL 'kxdfhei1' USING DFHEIV0
 17819     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17820
 17821
 17822
 17823* EXEC CICS WRITE
 17824*        DATASET  (FILE-ID-ERPNDB)
 17825*        FROM     (PENDING-BUSINESS)
 17826*        RIDFLD   (PB-CONTROL-PRIMARY)
 17827*    END-EXEC.
 17828     MOVE LENGTH OF
 17829      PENDING-BUSINESS
 17830       TO DFHEIV11
 17831*    MOVE '&$ L                  ''   #00015471' TO DFHEIV0
 17832     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17833     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17834     MOVE X'2020233030303135343731' TO DFHEIV0(25:11)
 17835     CALL 'kxdfhei1' USING DFHEIV0,
 17836           FILE-ID-ERPNDB,
 17837           PENDING-BUSINESS,
 17838           DFHEIV11,
 17839           PB-CONTROL-PRIMARY,
 17840           DFHEIV99,
 17841           DFHEIV99
 17842     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17843
 17844
 17845     MOVE ERPNDB-RECORD-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 17846
 17847     PERFORM 8400-LOG-JOURNAL-RECORD  *> Journal Cancel Add
 17848
 17849     GO TO 2325-PROCESS-CANCEL-CHANGES.
 17850
 17851 2985-RECORD-MISSING.
 17852     MOVE -1                     TO CMAINTL
 17853     MOVE AL-UABON               TO CMAINTA.
 17854
 17855     MOVE ER-2902                TO EMI-ERROR.
 17856     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17857     GO TO 8200-SEND-DATAONLY.
 17858
 17859 2990-DUPLICATE-RECORD.
 17860     MOVE SPACE                  TO CMAINTI.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 324
* EL6311.cbl
 17861     MOVE -1                     TO CMAINTL.
 17862     MOVE AL-UABON               TO CCERTNOA.
 17863     MOVE AL-UNBON               TO CEFFDTA.
 17864
 17865     MOVE 1                      TO EMI-SUB
 17866                                    EMI-SWITCH1
 17867                                    EMI-SWITCH-AREA-1
 17868                                    EMI-SWITCH-AREA-2.
 17869     MOVE SPACES                 TO EMI-ERROR-LINES.
 17870
 17871
 17872* EXEC CICS SYNCPOINT ROLLBACK
 17873*    END-EXEC.
 17874*    MOVE '6"R                   !   #00015503' TO DFHEIV0
 17875     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17876     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17877     MOVE X'2020233030303135353033' TO DFHEIV0(25:11)
 17878     CALL 'kxdfhei1' USING DFHEIV0
 17879     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17880
 17881
 17882     MOVE ER-2247                TO EMI-ERROR.
 17883     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17884     GO TO 8200-SEND-DATAONLY.
 17885
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 325
* EL6311.cbl
 17887
 17888***************************************************************
 17889*     ROUTINE TO CALCULATE THE TOTAL OF ALL GOOD AND BAD      *
 17890*     PREMIUM FOR A SINGLE BATCH.                             *
 17891*         ACTIVATED VIA THE PF3 FROM THE BATCH TOTAL SCREEN.  *
 17892***************************************************************
 17893
 17894 3000-BATCH-MAINLINE.
 17895     IF PI-PREV-KEY NOT = SPACES
 17896         MOVE PI-PREV-KEY        TO ERPNDB-KEY
 17897     ELSE
 17898         MOVE PI-ERPNDB-KEY      TO ERPNDB-KEY.
 17899
 17900     MOVE +1                     TO ERPNDB-BATCH-SEQ-NO.
 17901
 17902 3010-READNEXT.
 17903
 17904* EXEC CICS READ
 17905*         DATASET    (FILE-ID-ERPNDB)
 17906*         SET        (ADDRESS OF PENDING-BUSINESS)
 17907*         RIDFLD     (ERPNDB-KEY)
 17908*         GTEQ
 17909*    END-EXEC.
 17910*    MOVE '&"S        G          (   #00015527' TO DFHEIV0
 17911     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 17912     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17913     MOVE X'2020233030303135353237' TO DFHEIV0(25:11)
 17914     CALL 'kxdfhei1' USING DFHEIV0,
 17915           FILE-ID-ERPNDB,
 17916           DFHEIV20,
 17917           DFHEIV99,
 17918           ERPNDB-KEY,
 17919           DFHEIV99,
 17920           DFHEIV99,
 17921           DFHEIV99
 17922     SET ADDRESS OF PENDING-BUSINESS TO
 17923         DFHEIV20
 17924     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17925
 17926
 17927     IF PB-COMPANY-CD  NOT = ERPNDB-COMPANY-CD OR
 17928        PB-ENTRY-BATCH NOT = ERPNDB-ENTRY-BATCH
 17929          GO TO 3030-END-BATCH.
 17930
 17931     MOVE PB-CONTROL-PRIMARY     TO ERPNDB-KEY.
 17932
 17933     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 17934        PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 17935          GO TO 3020-BUMP-SEQ.
 17936
 17937     IF PB-ISSUE
 17938        ADD +1                   TO WS-ISS-TOTAL-CNT
 17939        IF PB-FATAL-ERRORS
 17940           ADD +1                      TO WS-ISS-FATAL-CNT
 17941           PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 17942           GO TO 3020-BUMP-SEQ
 17943        ELSE
 17944           IF PB-UNFORCED-ERRORS
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 326
* EL6311.cbl
 17945              ADD +1                      TO WS-ISS-FORCE-CNT
 17946              PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 17947              GO TO 3020-BUMP-SEQ
 17948           ELSE
 17949              IF PB-RECORD-ON-HOLD OR PB-RECORD-RETURNED
 17950                 ADD +1                      TO WS-ISS-HOLD-CNT
 17951                 PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 17952                 GO TO 3020-BUMP-SEQ
 17953              ELSE
 17954                 PERFORM 3200-ADD-GOOD-ISSUE-PREM
 17955                     THRU  3299-EXIT
 17956                 GO TO 3020-BUMP-SEQ.
 17957
 17958     IF PB-CANCELLATION
 17959        ADD +1                   TO WS-CAN-TOTAL-CNT
 17960        IF PB-FATAL-ERRORS
 17961           ADD +1                 TO WS-CAN-FATAL-CNT
 17962           PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 17963           GO TO 3020-BUMP-SEQ
 17964        ELSE
 17965           IF PB-UNFORCED-ERRORS
 17966              ADD +1                 TO WS-CAN-FORCE-CNT
 17967              PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 17968              GO TO 3020-BUMP-SEQ
 17969           ELSE
 17970              IF PB-RECORD-ON-HOLD OR PB-RECORD-RETURNED
 17971                 ADD +1                 TO WS-CAN-HOLD-CNT
 17972                 PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 17973                 GO TO 3020-BUMP-SEQ
 17974              ELSE
 17975                 PERFORM 3400-ADD-GOOD-CANCEL-PREM
 17976                     THRU  3499-EXIT
 17977                 GO TO 3020-BUMP-SEQ.
 17978
 17979     IF PB-BATCH-TRAILER
 17980         GO TO 3030-END-BATCH.
 17981
 17982 3020-BUMP-SEQ.
 17983     ADD +1                      TO ERPNDB-BATCH-SEQ-NO.
 17984     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 17985     GO TO 3010-READNEXT.
 17986
 17987 3030-END-BATCH.
 17988     MOVE WS-ISS-TOTAL-CNT       TO DITOTALO.
 17989     MOVE WS-ISS-FATAL-CNT       TO DIFATALO.
 17990     MOVE WS-ISS-FORCE-CNT       TO DIFORCEO.
 17991     MOVE WS-ISS-HOLD-CNT        TO DIHOLDO.
 17992
 17993     COMPUTE DIAVAILO = (WS-ISS-TOTAL-CNT - WS-ISS-FATAL-CNT
 17994                                          - WS-ISS-FORCE-CNT
 17995                                          - WS-ISS-HOLD-CNT).
 17996
 17997     MOVE WS-ISS-GOOD-PREM       TO DIGPREMO.
 17998     MOVE WS-ISS-BAD-PREM        TO DIBPREMO.
 17999
 18000     MOVE WS-CAN-TOTAL-CNT       TO DCTOTALO.
 18001     MOVE WS-CAN-FATAL-CNT       TO DCFATALO.
 18002     MOVE WS-CAN-FORCE-CNT       TO DCFORCEO.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 327
* EL6311.cbl
 18003     MOVE WS-CAN-HOLD-CNT        TO DCHOLDO.
 18004     COMPUTE DCAVAILO = (WS-CAN-TOTAL-CNT - WS-CAN-FATAL-CNT
 18005                                          - WS-CAN-FORCE-CNT
 18006                                          - WS-CAN-HOLD-CNT).
 18007     MOVE WS-CAN-GOOD-PREM       TO DCGPREMO.
 18008     MOVE WS-CAN-BAD-PREM        TO DCBPREMO.
 18009
 18010     COMPUTE WS-NET-TOTAL-CNT
 18011         = WS-ISS-TOTAL-CNT - WS-CAN-TOTAL-CNT.
 18012     MOVE WS-NET-TOTAL-CNT       TO DNTOTALO.
 18013     COMPUTE WS-NET-FATAL-CNT
 18014         = WS-ISS-FATAL-CNT - WS-CAN-FATAL-CNT.
 18015     MOVE WS-NET-FATAL-CNT       TO DNFATALO.
 18016     COMPUTE WS-NET-FORCE-CNT
 18017         = WS-ISS-FORCE-CNT - WS-CAN-FORCE-CNT.
 18018     MOVE WS-NET-FORCE-CNT       TO DNFORCEO.
 18019     COMPUTE WS-NET-HOLD-CNT
 18020         = WS-ISS-HOLD-CNT - WS-CAN-HOLD-CNT.
 18021     MOVE WS-NET-HOLD-CNT        TO DNHOLDO.
 18022
 18023     COMPUTE WS-NET-AVAIL-CNT
 18024          = (WS-ISS-TOTAL-CNT - WS-ISS-FATAL-CNT
 18025                              - WS-ISS-FORCE-CNT
 18026                              - WS-ISS-HOLD-CNT)
 18027          - (WS-CAN-TOTAL-CNT - WS-CAN-FATAL-CNT
 18028                              - WS-CAN-FORCE-CNT
 18029                              - WS-CAN-HOLD-CNT).
 18030     MOVE WS-NET-AVAIL-CNT       TO DNAVAILO.
 18031
 18032     COMPUTE WS-NET-GOOD-PREM
 18033         = WS-ISS-GOOD-PREM - WS-CAN-GOOD-PREM.
 18034     MOVE WS-NET-GOOD-PREM       TO DNGPREMO.
 18035     COMPUTE WS-NET-BAD-PREM
 18036         = WS-ISS-BAD-PREM - WS-CAN-BAD-PREM.
 18037     MOVE WS-NET-BAD-PREM        TO DNBPREMO.
 18038
 18039     MOVE 0000                   TO EMI-ERROR.
 18040     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18041     MOVE -1                     TO DPFENTRL.
 18042     GO TO 8200-SEND-DATAONLY.
 18043
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 328
* EL6311.cbl
 18045
 18046******************************************************************
 18047*                                                                *
 18048*           A D D    B A D   I S S U E   P R E M I U M           *
 18049*                                                                *
 18050******************************************************************
 18051
 18052 3100-ADD-BAD-ISSUE-PREM.
 18053     IF PB-OVERRIDE-LIFE
 18054       OR PB-OVERRIDE-BOTH
 18055           ADD PB-I-LF-PREM-CALC       TO  WS-ISS-BAD-PREM
 18056           ADD PB-I-LF-ALT-PREM-CALC   TO  WS-ISS-BAD-PREM
 18057       ELSE
 18058           ADD PB-I-LF-PREMIUM-AMT     TO  WS-ISS-BAD-PREM
 18059           ADD PB-I-LF-ALT-PREMIUM-AMT TO  WS-ISS-BAD-PREM.
 18060
 18061     IF PB-OVERRIDE-AH
 18062       OR PB-OVERRIDE-BOTH
 18063           ADD PB-I-AH-PREM-CALC       TO  WS-ISS-BAD-PREM
 18064       ELSE
 18065           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-BAD-PREM.
 18066
 18067 3199-EXIT.
 18068     EXIT.
 18069
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 329
* EL6311.cbl
 18071
 18072******************************************************************
 18073*                                                                *
 18074*       A D D   G O O D   I S S U E   P R E M I U M              *
 18075*                                                                *
 18076******************************************************************
 18077
 18078 3200-ADD-GOOD-ISSUE-PREM.
 18079     IF PB-OVERRIDE-LIFE
 18080       OR PB-OVERRIDE-BOTH
 18081           ADD PB-I-LF-PREM-CALC       TO  WS-ISS-GOOD-PREM
 18082           ADD PB-I-LF-ALT-PREM-CALC   TO  WS-ISS-GOOD-PREM
 18083       ELSE
 18084           ADD PB-I-LF-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM
 18085           ADD PB-I-LF-ALT-PREMIUM-AMT TO  WS-ISS-GOOD-PREM.
 18086
 18087     IF PB-OVERRIDE-AH
 18088       OR PB-OVERRIDE-BOTH
 18089           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM
 18090       ELSE
 18091           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM.
 18092
 18093 3299-EXIT.
 18094     EXIT.
 18095
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 330
* EL6311.cbl
 18097
 18098
 18099******************************************************************
 18100*                                                                *
 18101*        A D D   B A D   C A N C E L   P R E M I U M             *
 18102*                                                                *
 18103******************************************************************
 18104
 18105 3300-ADD-BAD-CANCEL-PREM.
 18106     IF PB-OVERRIDE-LIFE
 18107       OR PB-OVERRIDE-BOTH
 18108           ADD PB-C-LF-REF-CALC   TO  WS-CAN-BAD-PREM
 18109       ELSE
 18110           ADD PB-C-LF-CANCEL-AMT TO  WS-CAN-BAD-PREM.
 18111
 18112     IF PB-OVERRIDE-AH
 18113       OR PB-OVERRIDE-BOTH
 18114           ADD PB-C-AH-REF-CALC   TO  WS-CAN-BAD-PREM
 18115       ELSE
 18116           ADD PB-C-AH-CANCEL-AMT TO  WS-CAN-BAD-PREM.
 18117
 18118 3399-EXIT.
 18119     EXIT.
 18120
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 331
* EL6311.cbl
 18122
 18123******************************************************************
 18124*                                                                *
 18125*       A D D   G O O D   C A N C E L   P R E M I U M            *
 18126*                                                                *
 18127******************************************************************
 18128
 18129 3400-ADD-GOOD-CANCEL-PREM.
 18130     IF PB-OVERRIDE-LIFE
 18131       OR PB-OVERRIDE-BOTH
 18132           ADD PB-C-LF-REF-CALC   TO  WS-CAN-GOOD-PREM
 18133       ELSE
 18134           ADD PB-C-LF-CANCEL-AMT TO  WS-CAN-GOOD-PREM.
 18135
 18136     IF PB-OVERRIDE-AH
 18137       OR PB-OVERRIDE-BOTH
 18138           ADD PB-C-AH-REF-CALC   TO  WS-CAN-GOOD-PREM
 18139       ELSE
 18140           ADD PB-C-AH-CANCEL-AMT TO  WS-CAN-GOOD-PREM.
 18141
 18142 3499-EXIT.
 18143     EXIT.
 18144
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 332
* EL6311.cbl
 18146
 18147******************************************************************
 18148*                                                                *
 18149*           E D I T   B A T C H   D A T A                        *
 18150*                                                                *
 18151******************************************************************
 18152
 18153 3500-EDIT-BATCH-DATA.
 18154     IF PI-PREV-KEY NOT = SPACES
 18155        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 18156     ELSE
 18157        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY.
 18158
 18159     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 18160     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 18161
 18162
 18163* EXEC CICS HANDLE CONDITION
 18164*         NOTFND      (3590-NOT-FOUND)
 18165*    END-EXEC.
 18166*    MOVE '"$I                   ! A #00015769' TO DFHEIV0
 18167     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18168     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18169     MOVE X'4120233030303135373639' TO DFHEIV0(25:11)
 18170     CALL 'kxdfhei1' USING DFHEIV0
 18171     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18172
 18173
 18174     IF DRISSL   GREATER THAN ZEROS OR
 18175        DRISSL   GREATER THAN ZEROS OR
 18176        DRLFPRML GREATER THAN ZEROS OR
 18177        DRAHPRML GREATER THAN ZEROS OR
 18178        DRCANCL  GREATER THAN ZEROS OR
 18179        DRLFRFDL GREATER THAN ZEROS OR
 18180        DRAHRFDL GREATER THAN ZEROS
 18181              NEXT SENTENCE
 18182          ELSE
 18183              MOVE ER-3224    TO EMI-ERROR
 18184              MOVE -1         TO DPFENTRL
 18185              MOVE AL-UNBON   TO DPFENTRA
 18186              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18187              GO TO 8200-SEND-DATAONLY.
 18188
 18189     IF NOT MODIFY-CAP
 18190         MOVE 'UPDATE'       TO SM-READ
 18191         PERFORM 9995-SECURITY-VIOLATION
 18192         MOVE ER-0070        TO EMI-ERROR
 18193         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18194         GO TO 8100-SEND-INITIAL-MAP.
 18195
 18196        IF DRISSL GREATER THAN ZEROS
 18197           MOVE AL-UNNON         TO DRISSA
 18198           MOVE DRISSI           TO DEEDIT-FIELD
 18199           PERFORM 8600-DEEDIT
 18200           IF DEEDIT-FIELD-V0  NUMERIC
 18201              MOVE DEEDIT-FIELD-V0 TO WS-DRISS
 18202           ELSE
 18203              MOVE ER-2223    TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 333
* EL6311.cbl
 18204              MOVE -1         TO DRISSL
 18205              MOVE AL-UNBON   TO DRISSA
 18206              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18207
 18208        IF DRLFPRML GREATER THAN ZEROS
 18209           MOVE AL-UNNON         TO DRLFPRMA
 18210
 18211* EXEC CICS BIF DEEDIT
 18212*              FIELD  (DRLFPRMI)
 18213*              LENGTH (11)
 18214*          END-EXEC
 18215     MOVE 11
 18216       TO DFHEIV11
 18217*    MOVE '@"L                   #   #00015809' TO DFHEIV0
 18218     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18219     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18220     MOVE X'2020233030303135383039' TO DFHEIV0(25:11)
 18221     CALL 'kxdfhei1' USING DFHEIV0,
 18222           DRLFPRMI,
 18223           DFHEIV11
 18224     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18225           IF DRLFPRMI NUMERIC
 18226              MOVE DRLFPRMI   TO WS-DRLFPRM
 18227*          MOVE DRLFPRMI         TO DEEDIT-FIELD
 18228*          PERFORM 8600-DEEDIT
 18229*          IF DEEDIT-FIELD-V2  NUMERIC
 18230*             MOVE DEEDIT-FIELD-V2 TO WS-DRLFPRM
 18231           ELSE
 18232              MOVE ER-2223    TO EMI-ERROR
 18233              MOVE -1         TO DRLFPRML
 18234              MOVE AL-UNBON   TO DRLFPRMA
 18235              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18236
 18237        IF DRAHPRML GREATER THAN ZEROS
 18238           MOVE AL-UNNON         TO DRAHPRMA
 18239
 18240* EXEC CICS BIF DEEDIT
 18241*              FIELD  (DRAHPRMI)
 18242*              LENGTH (11)
 18243*          END-EXEC
 18244     MOVE 11
 18245       TO DFHEIV11
 18246*    MOVE '@"L                   #   #00015827' TO DFHEIV0
 18247     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18248     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18249     MOVE X'2020233030303135383237' TO DFHEIV0(25:11)
 18250     CALL 'kxdfhei1' USING DFHEIV0,
 18251           DRAHPRMI,
 18252           DFHEIV11
 18253     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18254           IF DRAHPRMI NUMERIC
 18255              MOVE DRAHPRMI   TO WS-DRAHPRM
 18256*          MOVE DRAHPRMI         TO DEEDIT-FIELD
 18257*          PERFORM 8600-DEEDIT
 18258*          IF DEEDIT-FIELD-V2  NUMERIC
 18259*             MOVE DEEDIT-FIELD-V2 TO WS-DRAHPRM
 18260           ELSE
 18261              MOVE ER-2223    TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 334
* EL6311.cbl
 18262              MOVE -1         TO DRAHPRML
 18263              MOVE AL-UNBON   TO DRAHPRMA
 18264              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18265
 18266        IF DRCANCL GREATER THAN ZEROS
 18267           MOVE AL-UNNON         TO DRCANCA
 18268           MOVE DRCANCI          TO DEEDIT-FIELD
 18269           PERFORM 8600-DEEDIT
 18270           IF DEEDIT-FIELD-V0  NUMERIC
 18271              MOVE DEEDIT-FIELD-V0 TO WS-DRCANC
 18272           ELSE
 18273              MOVE ER-2223    TO EMI-ERROR
 18274              MOVE -1         TO DRCANCL
 18275              MOVE AL-UNBON   TO DRCANCL
 18276              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18277
 18278        IF DRLFRFDL GREATER THAN ZEROS
 18279           MOVE AL-UNNON         TO DRLFRFDA
 18280
 18281* EXEC CICS BIF DEEDIT
 18282*              FIELD  (DRLFRFDI)
 18283*              LENGTH (11)
 18284*          END-EXEC
 18285     MOVE 11
 18286       TO DFHEIV11
 18287*    MOVE '@"L                   #   #00015857' TO DFHEIV0
 18288     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18289     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18290     MOVE X'2020233030303135383537' TO DFHEIV0(25:11)
 18291     CALL 'kxdfhei1' USING DFHEIV0,
 18292           DRLFRFDI,
 18293           DFHEIV11
 18294     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18295           IF DRLFRFDI NUMERIC
 18296              MOVE DRLFRFDI   TO WS-DRLFRFD
 18297*          MOVE DRLFRFDI         TO DEEDIT-FIELD
 18298*          PERFORM 8600-DEEDIT
 18299*          IF DEEDIT-FIELD-V2  NUMERIC
 18300*             MOVE DEEDIT-FIELD-V2 TO WS-DRLFRFD
 18301           ELSE
 18302              MOVE ER-2223    TO EMI-ERROR
 18303              MOVE -1         TO DRLFRFDL
 18304              MOVE AL-UNBON   TO DRLFRFDA
 18305              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18306
 18307        IF DRAHRFDL GREATER THAN ZEROS
 18308           MOVE AL-UNNON         TO DRAHRFDA
 18309
 18310* EXEC CICS BIF DEEDIT
 18311*              FIELD  (DRAHRFDI)
 18312*              LENGTH (11)
 18313*          END-EXEC
 18314     MOVE 11
 18315       TO DFHEIV11
 18316*    MOVE '@"L                   #   #00015875' TO DFHEIV0
 18317     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18318     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18319     MOVE X'2020233030303135383735' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 335
* EL6311.cbl
 18320     CALL 'kxdfhei1' USING DFHEIV0,
 18321           DRAHRFDI,
 18322           DFHEIV11
 18323     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18324           IF DRAHRFDI NUMERIC
 18325              MOVE DRAHRFDI   TO WS-DRAHRFD
 18326*          MOVE DRAHRFDI         TO DEEDIT-FIELD
 18327*          PERFORM 8600-DEEDIT
 18328*          IF DEEDIT-FIELD-V2  NUMERIC
 18329*             MOVE DEEDIT-FIELD-V2 TO WS-DRAHRFD
 18330           ELSE
 18331              MOVE ER-2223    TO EMI-ERROR
 18332              MOVE -1         TO DRAHRFDL
 18333              MOVE AL-UNBON   TO DRAHRFDA
 18334              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18335
 18336     IF EMI-ERROR = ZEROS
 18337        GO 3600-UPDATE-BATCH-HEADER.
 18338
 18339     GO TO 8200-SEND-DATAONLY.
 18340
 18341 3590-NOT-FOUND.
 18342     MOVE ER-2192                TO EMI-ERROR.
 18343     MOVE -1                     TO DPFENTRL.
 18344     MOVE AL-UNBON               TO DPFENTRA.
 18345     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18346     GO TO 8200-SEND-DATAONLY.
 18347
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 336
* EL6311.cbl
 18349
 18350******************************************************************
 18351*                                                                *
 18352*           U P D A T E   B A T C H   H E A D E R                *
 18353*                                                                *
 18354******************************************************************
 18355
 18356 3600-UPDATE-BATCH-HEADER.
 18357
 18358* EXEC CICS HANDLE CONDITION
 18359*         NOTFND      (3690-NOT-FOUND)
 18360*    END-EXEC.
 18361*    MOVE '"$I                   ! B #00015912' TO DFHEIV0
 18362     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18363     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18364     MOVE X'4220233030303135393132' TO DFHEIV0(25:11)
 18365     CALL 'kxdfhei1' USING DFHEIV0
 18366     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18367
 18368
 18369
 18370* EXEC CICS READ
 18371*        DATASET (FILE-ID-ERPNDB)
 18372*        RIDFLD  (ERPNDB-KEY)
 18373*        SET     (ADDRESS OF PENDING-BUSINESS)
 18374*        UPDATE
 18375*    END-EXEC.
 18376*    MOVE '&"S        EU         (   #00015916' TO DFHEIV0
 18377     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18378     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 18379     MOVE X'2020233030303135393136' TO DFHEIV0(25:11)
 18380     CALL 'kxdfhei1' USING DFHEIV0,
 18381           FILE-ID-ERPNDB,
 18382           DFHEIV20,
 18383           DFHEIV99,
 18384           ERPNDB-KEY,
 18385           DFHEIV99,
 18386           DFHEIV99,
 18387           DFHEIV99
 18388     SET ADDRESS OF PENDING-BUSINESS TO
 18389         DFHEIV20
 18390     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18391
 18392
 18393     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 18394     MOVE 'B'                    TO JP-RECORD-TYPE.
 18395     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 18396
 18397     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 18398
 18399     PERFORM 8400-LOG-JOURNAL-RECORD  *> Before BHDR Image
 18400
 18401     IF DRISSL GREATER THAN ZEROS
 18402        MOVE WS-DRISS            TO PB-B-ISSUE-CNT-REMITTED.
 18403
 18404     IF DRCANCL GREATER THAN ZEROS
 18405        MOVE WS-DRCANC           TO PB-B-CANCEL-CNT-REMITTED.
 18406
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 337
* EL6311.cbl
 18407
 18408     IF DRLFPRML GREATER THAN ZEROS
 18409        MOVE WS-DRLFPRM       TO PB-B-LF-ISS-PRM-REMITTED.
 18410
 18411     IF DRAHPRML GREATER THAN ZEROS
 18412        MOVE WS-DRAHPRM       TO PB-B-AH-ISS-PRM-REMITTED.
 18413
 18414     IF DRLFRFDL GREATER THAN ZEROS
 18415        MOVE WS-DRLFRFD       TO PB-B-LF-CAN-PRM-REMITTED.
 18416
 18417     IF DRAHRFDL GREATER THAN ZEROS
 18418        MOVE WS-DRAHRFD       TO PB-B-AH-CAN-PRM-REMITTED.
 18419
 18420 3670-REWRITE-BATCH-HEADER.
 18421     IF PB-B-ISSUE-CNT-REMITTED  =  PB-B-ISSUE-CNT-ENTERED   AND
 18422        PB-B-LF-ISS-PRM-ENTERED  =  PB-B-LF-ISS-PRM-REMITTED AND
 18423        PB-B-AH-ISS-PRM-ENTERED  =  PB-B-AH-ISS-PRM-REMITTED AND
 18424        PB-B-CANCEL-CNT-REMITTED =  PB-B-CANCEL-CNT-ENTERED  AND
 18425        PB-B-LF-CAN-PRM-ENTERED  =  PB-B-LF-CAN-PRM-REMITTED AND
 18426        PB-B-AH-CAN-PRM-ENTERED  =  PB-B-AH-CAN-PRM-REMITTED
 18427        MOVE SPACE               TO PB-OUT-BAL-CD
 18428     ELSE
 18429        MOVE 'O'                 TO PB-OUT-BAL-CD.
 18430
 18431     MOVE 'C'                    TO JP-RECORD-TYPE.
 18432     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 18433
 18434
 18435* EXEC CICS REWRITE
 18436*         DATASET      (FILE-ID-ERPNDB)
 18437*         FROM         (PENDING-BUSINESS)
 18438*    END-EXEC.
 18439     MOVE LENGTH OF
 18440      PENDING-BUSINESS
 18441       TO DFHEIV11
 18442*    MOVE '&& L                  %   #00015964' TO DFHEIV0
 18443     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 18444     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 18445     MOVE X'2020233030303135393634' TO DFHEIV0(25:11)
 18446     CALL 'kxdfhei1' USING DFHEIV0,
 18447           FILE-ID-ERPNDB,
 18448           PENDING-BUSINESS,
 18449           DFHEIV11,
 18450           DFHEIV99
 18451     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18452
 18453
 18454     PERFORM 8400-LOG-JOURNAL-RECORD  *> After BHDR Image
 18455
 18456     GO TO 7200-DISPLAY-BATCHES.
 18457
 18458 3690-NOT-FOUND.
 18459     MOVE ER-2192                TO EMI-ERROR.
 18460     MOVE -1                     TO DPFENTRL.
 18461     MOVE AL-UNBON               TO DPFENTRA.
 18462     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18463     GO TO 8200-SEND-DATAONLY.
 18464
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 338
* EL6311.cbl
 18466
 18467******************************************************************
 18468*                                                                *
 18469*           R E - D I S P L A Y   R E C O R D                    *
 18470*                                                                *
 18471******************************************************************
 18472
 18473 3900-RE-DISPLAY-RECORD.
 18474
 18475* EXEC CICS HANDLE CONDITION
 18476*         NOTFND   (3990-NOT-FOUND)
 18477*    END-EXEC.
 18478*    MOVE '"$I                   ! C #00015989' TO DFHEIV0
 18479     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18480     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18481     MOVE X'4320233030303135393839' TO DFHEIV0(25:11)
 18482     CALL 'kxdfhei1' USING DFHEIV0
 18483     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18484
 18485
 18486     IF PI-DISPLAY-ORIGINAL-BATCH
 18487         MOVE FILE-ID-ERPNDB3     TO FILE-ID
 18488     ELSE
 18489         MOVE FILE-ID-ERPNDB      TO FILE-ID.
 18490
 18491
 18492* EXEC CICS READ
 18493*         DATASET   (FILE-ID)
 18494*         RIDFLD    (PI-PREV-KEY)
 18495*         SET       (ADDRESS OF PENDING-BUSINESS)
 18496*    END-EXEC.
 18497*    MOVE '&"S        E          (   #00015998' TO DFHEIV0
 18498     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18499     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18500     MOVE X'2020233030303135393938' TO DFHEIV0(25:11)
 18501     CALL 'kxdfhei1' USING DFHEIV0,
 18502           FILE-ID,
 18503           DFHEIV20,
 18504           DFHEIV99,
 18505           PI-PREV-KEY,
 18506           DFHEIV99,
 18507           DFHEIV99,
 18508           DFHEIV99
 18509     SET ADDRESS OF PENDING-BUSINESS TO
 18510         DFHEIV20
 18511     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18512
 18513
 18514     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 18515
 18516     IF PB-ISSUE
 18517         GO TO 7000-DISPLAY-ISSUES.
 18518
 18519     IF PB-CANCELLATION
 18520         GO TO 7100-DISPLAY-CANCELS.
 18521
 18522     IF PB-BATCH-TRAILER
 18523         GO TO 7200-DISPLAY-BATCHES.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 339
* EL6311.cbl
 18524
 18525 3990-NOT-FOUND.
 18526     MOVE LOW-VALUES             TO EL631BI.
 18527
 18528     IF PI-MAP-NAME = EL631B
 18529         MOVE -1                  TO BMAINTL
 18530     ELSE
 18531         MOVE -1                  TO CMAINTL.
 18532
 18533     GO TO 8100-SEND-INITIAL-MAP.
 18534
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 340
* EL6311.cbl
 18536
 18537***************************************************************
 18538*     FORWARD BROWSING ROUTINE   (BY ALTERNATE KEY)           *
 18539*                                                             *
 18540*      1. START BROWSE WITH                                   *
 18541*         A. FIRST RECORD SPECIFIED FROM FIRST SCREEN         *
 18542*         B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN       *
 18543*         C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.       *
 18544*                                                             *
 18545*      2. READ RECORDS AND DETERMINE IF THEY ARE TO BE        *
 18546*         DISPLAYED BY USING THE FOLLOWING CHECKS.            *
 18547*         A. IS IT WITHIN THE SAME KEY GROUP?                 *
 18548*         B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED. *
 18549*         C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM   *
 18550*               AND IS IT TO BE DISPLAYED.                    *
 18551*         D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE        *
 18552*               DISPLAYED.                                    *
 18553*         E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE       *
 18554*               DISPLAYED.                                    *
 18555*                                                             *
 18556*      3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE      *
 18557*               RECORD KEY AND GO TO THE DISPLAY ROUTINE.     *
 18558***************************************************************
 18559
 18560 4000-BROWSE-DETAIL-FORWARD.
 18561     IF FIRST-TIME
 18562        MOVE PI-ERPNDB-ALT-KEY      TO ERPNDB-ALT-KEY
 18563     ELSE
 18564        IF SHOW-RECORD
 18565           MOVE PI-ERPNDB-ALT-KEY   TO ERPNDB-ALT-KEY
 18566           MOVE WS-NEW-CERT-NO      TO ERPNDB-CERT-NO
 18567           MOVE WS-NEW-CERT-EFF-DT  TO ERPNDB-CERT-EFF-DT
 18568           MOVE LOW-VALUES          TO ERPNDB-RECORD-TYPE
 18569           MOVE ZEROS               TO ERPNDB-ALT-CHG-SEQ-NO
 18570        ELSE
 18571           MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY.
 18572
 18573
 18574* EXEC CICS HANDLE CONDITION
 18575*         NOTFND   (4050-END-RECORDS)
 18576*         ENDFILE  (4050-END-RECORDS)
 18577*    END-EXEC.
 18578*    MOVE '"$I''                  ! D #00016063' TO DFHEIV0
 18579     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18580     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18581     MOVE X'4420233030303136303633' TO DFHEIV0(25:11)
 18582     CALL 'kxdfhei1' USING DFHEIV0
 18583     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18584
 18585
 18586
 18587* EXEC CICS STARTBR
 18588*         DATASET   (FILE-ID-ERPNDB2)
 18589*         RIDFLD    (ERPNDB-ALT-KEY)
 18590*    END-EXEC.
 18591     MOVE 0
 18592       TO DFHEIV11
 18593*    MOVE '&,         G          &   #00016068' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 341
* EL6311.cbl
 18594     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18595     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18596     MOVE X'2020233030303136303638' TO DFHEIV0(25:11)
 18597     CALL 'kxdfhei1' USING DFHEIV0,
 18598           FILE-ID-ERPNDB2,
 18599           ERPNDB-ALT-KEY,
 18600           DFHEIV99,
 18601           DFHEIV11,
 18602           DFHEIV99
 18603     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18604
 18605
 18606     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 18607
 18608     IF FIRST-TIME OR SHOW-RECORD
 18609        MOVE SPACE               TO WS-FIRST-TIME-SW
 18610        GO TO 4005-READ-NEXT-RECORD.
 18611
 18612
 18613* EXEC CICS READNEXT
 18614*         DATASET    (FILE-ID-ERPNDB2)
 18615*         SET        (ADDRESS OF PENDING-BUSINESS)
 18616*         RIDFLD     (ERPNDB-ALT-KEY)
 18617*    END-EXEC.
 18618     MOVE 0
 18619       TO DFHEIV11
 18620*    MOVE '&.S                   )   #00016079' TO DFHEIV0
 18621     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18622     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18623     MOVE X'2020233030303136303739' TO DFHEIV0(25:11)
 18624     CALL 'kxdfhei1' USING DFHEIV0,
 18625           FILE-ID-ERPNDB2,
 18626           DFHEIV20,
 18627           DFHEIV99,
 18628           ERPNDB-ALT-KEY,
 18629           DFHEIV99,
 18630           DFHEIV11,
 18631           DFHEIV99,
 18632           DFHEIV99
 18633     SET ADDRESS OF PENDING-BUSINESS TO
 18634         DFHEIV20
 18635     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18636
 18637
 18638 4005-READ-NEXT-RECORD.
 18639
 18640* EXEC CICS READNEXT
 18641*         DATASET    (FILE-ID-ERPNDB2)
 18642*         SET        (ADDRESS OF PENDING-BUSINESS)
 18643*         RIDFLD     (ERPNDB-ALT-KEY)
 18644*    END-EXEC.
 18645     MOVE 0
 18646       TO DFHEIV11
 18647*    MOVE '&.S                   )   #00016086' TO DFHEIV0
 18648     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18649     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18650     MOVE X'2020233030303136303836' TO DFHEIV0(25:11)
 18651     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 342
* EL6311.cbl
 18652           FILE-ID-ERPNDB2,
 18653           DFHEIV20,
 18654           DFHEIV99,
 18655           ERPNDB-ALT-KEY,
 18656           DFHEIV99,
 18657           DFHEIV11,
 18658           DFHEIV99,
 18659           DFHEIV99
 18660     SET ADDRESS OF PENDING-BUSINESS TO
 18661         DFHEIV20
 18662     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18663
 18664
 18665     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 18666
 18667     IF WS-BATCH-PREFIX = '#CL'
 18668        GO TO 4005-READ-NEXT-RECORD.
 18669
 18670     IF SHOW-RECORD
 18671        IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD        OR
 18672           PB-CARRIER       NOT = PI-PB-CARRIER        OR
 18673           PB-GROUPING      NOT = PI-PB-GROUPING       OR
 18674           PB-STATE         NOT = PI-PB-STATE          OR
 18675           PB-ACCOUNT       NOT = PI-PB-ACCOUNT        OR
 18676           PB-CERT-EFF-DT   NOT = WS-NEW-CERT-EFF-DT   OR
 18677           PB-CERT-NO       NOT = WS-NEW-CERT-NO
 18678           GO TO 4050-END-RECORDS
 18679        ELSE
 18680           GO TO 4010-CHECK-REC-TYPE.
 18681
 18682     IF PB-COMPANY-CD-A1    NOT = PI-COMPANY-CD        OR
 18683        PB-CARRIER          NOT = PI-PB-CARRIER        OR
 18684        PB-GROUPING         NOT = PI-PB-GROUPING       OR
 18685        PB-STATE            NOT = PI-PB-STATE          OR
 18686        PB-ACCOUNT          NOT = PI-PB-ACCOUNT
 18687        GO TO 4050-END-RECORDS.
 18688
 18689     IF PB-BATCH-TRAILER
 18690        GO TO 4005-READ-NEXT-RECORD.
 18691
 18692     IF PI-PB-CERT-NO NOT = LOW-VALUES
 18693        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 18694           GO TO 4005-READ-NEXT-RECORD
 18695        ELSE
 18696           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 18697              GO TO 4010-CHECK-REC-TYPE
 18698           ELSE
 18699              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 18700                 GO TO 4010-CHECK-REC-TYPE
 18701              ELSE
 18702                 GO TO 4005-READ-NEXT-RECORD.
 18703
 18704     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 18705        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 18706           GO TO 4005-READ-NEXT-RECORD.
 18707
 18708 4010-CHECK-REC-TYPE.
 18709     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 343
* EL6311.cbl
 18710         IF  PB-CARRIER = PI-CARRIER-SECURITY
 18711             NEXT SENTENCE
 18712         ELSE
 18713             GO TO 4005-READ-NEXT-RECORD.
 18714
 18715     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 18716         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 18717             NEXT SENTENCE
 18718        ELSE
 18719             GO TO 4005-READ-NEXT-RECORD.
 18720
 18721     IF NOT DISPLAY-CHANGE-RECORDS AND
 18722            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 18723        GO TO 4005-READ-NEXT-RECORD.
 18724
 18725     IF DISPLAY-HOLD-RECORDS AND
 18726        NOT PB-RECORD-ON-HOLD
 18727          GO TO 4005-READ-NEXT-RECORD.
 18728
 18729     IF PB-ISSUE
 18730        IF DISPLAY-CHK-REQ-RECORDS
 18731            GO TO 4005-READ-NEXT-RECORD.
 18732
 18733     IF PB-ISSUE
 18734        IF ISSUE-WITH-WARNING
 18735           IF PB-WARNING-ERRORS
 18736              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18737                  GO TO 4005-READ-NEXT-RECORD
 18738              ELSE
 18739                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18740                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18741                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18742                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18743                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18744                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18745                 GO TO 7000-DISPLAY-ISSUES
 18746           ELSE
 18747              GO TO 4005-READ-NEXT-RECORD.
 18748
 18749     IF PB-ISSUE
 18750        IF (ISSUES-IN-ERROR AND
 18751            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18752            ALL-ISSUES
 18753            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18754            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18755            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18756            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18757            MOVE PB-SV-STATE            TO PI-SV-STATE
 18758            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18759            GO TO 7000-DISPLAY-ISSUES
 18760        ELSE
 18761            GO TO 4005-READ-NEXT-RECORD.
 18762
 18763     IF PB-CANCELLATION
 18764        IF DISPLAY-CHK-REQ-RECORDS
 18765           IF PB-C-REFUND-REQUESTED
 18766              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18767              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 344
* EL6311.cbl
 18768              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18769              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18770              MOVE PB-SV-STATE            TO PI-SV-STATE
 18771              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18772              GO TO 7100-DISPLAY-CANCELS
 18773           ELSE
 18774               GO TO 4005-READ-NEXT-RECORD.
 18775
 18776     IF PB-CANCELLATION
 18777        IF CANCEL-WITH-WARNING
 18778           IF PB-WARNING-ERRORS
 18779              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18780                  GO TO 4005-READ-NEXT-RECORD
 18781              ELSE
 18782                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18783                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18784                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18785                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18786                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18787                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18788                 GO TO 7100-DISPLAY-CANCELS
 18789           ELSE
 18790              GO TO 4005-READ-NEXT-RECORD.
 18791
 18792     IF PB-CANCELLATION
 18793        IF (CANCEL-IN-ERROR  AND
 18794            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18795            ALL-CANCELS
 18796            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18797            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18798            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18799            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18800            MOVE PB-SV-STATE            TO PI-SV-STATE
 18801            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18802            GO TO 7100-DISPLAY-CANCELS.
 18803
 18804     GO TO 4005-READ-NEXT-RECORD.
 18805
 18806 4050-END-RECORDS.
 18807******************************************************************
 18808*                                                                *
 18809*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 18810*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING
 18811*         PROGRAM.                                               *
 18812*                                                                *
 18813******************************************************************
 18814
 18815     IF BROWSE-STARTED
 18816        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 18817
 18818* EXEC CICS ENDBR
 18819*            DATASET  (FILE-ID-ERPNDB2)
 18820*       END-EXEC.
 18821     MOVE 0
 18822       TO DFHEIV11
 18823*    MOVE '&2                    $   #00016244' TO DFHEIV0
 18824     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18825     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 345
* EL6311.cbl
 18826     MOVE X'2020233030303136323434' TO DFHEIV0(25:11)
 18827     CALL 'kxdfhei1' USING DFHEIV0,
 18828           FILE-ID-ERPNDB2,
 18829           DFHEIV11,
 18830           DFHEIV99
 18831     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18832
 18833
 18834     IF  EIBTRNID NOT = TRANS-EXB1
 18835         IF PENDING-BUS-RECS-FOUND
 18836             NEXT SENTENCE
 18837           ELSE
 18838             MOVE '9'            TO PI-BROWSE-SW
 18839             GO TO 9400-CLEAR.
 18840
 18841     IF SHOW-RECORD
 18842        MOVE ER-2253            TO EMI-ERROR
 18843       ELSE
 18844        MOVE ER-2254            TO EMI-ERROR.
 18845
 18846     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18847
 18848     IF PI-MAP-NAME = SPACES
 18849        MOVE -1                  TO DPFENTRL
 18850        MOVE EL631D               TO PI-MAP-NAME
 18851        GO TO 8100-SEND-INITIAL-MAP.
 18852
 18853     IF PI-MAP-NAME = EL631B
 18854        MOVE -1                  TO BMAINTL
 18855     ELSE
 18856        IF PI-MAP-NAME = EL631C
 18857           MOVE -1               TO CMAINTL
 18858        ELSE
 18859           MOVE -1               TO DPFENTRL.
 18860
 18861     GO TO 8200-SEND-DATAONLY.
 18862
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 346
* EL6311.cbl
 18864
 18865***************************************************************
 18866*                                                             *
 18867*     FORWARD BROWSING ROUTINE   (BY BATCH)                   *
 18868*                                                             *
 18869*       1. READ RECORDS WITHIN THE BATCH BASED ON             *
 18870*          A. FIRST TIME INTO PROGRAM FROM FIRST SCREEN       *
 18871*          B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN      *
 18872*          C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.      *
 18873*                                                             *
 18874*       2. READ RECORDS AND DETERMINE IF THEY ARE TO BE       *
 18875*          DISPLAYED BY USING THE FOLLOWING CHECKS.           *
 18876*          A. IS IT WITHIN THE SAME KEY GROUP?                *
 18877*          B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED.*
 18878*          C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM  *
 18879*                AND IS IT TO BE DISPLAYED.                   *
 18880*          D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE       *
 18881*                DISPLAYED.                                   *
 18882*          E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE      *
 18883*                DISPLAYED.                                   *
 18884*                                                             *
 18885*       3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE     *
 18886*                RECORD KEY AND GO TO THE DISPLAY ROUTINE.    *
 18887*                                                             *
 18888*       4. WHEN READING ADDITION RECORDS ADJUSTMENTS MUST BE  *
 18889*                MADE TO BYPASS THE CORRECTION RECORDS IF     *
 18890*                THEY ARE NOT TO BE DISPLAYED.                *
 18891*                                                             *
 18892***************************************************************
 18893
 18894 4100-BROWSE-PRIMARY-FORWARD.
 18895     IF FIRST-TIME  OR SHOW-RECORD
 18896        MOVE PI-ERPNDB-KEY         TO ERPNDB-KEY
 18897        MOVE +1                    TO ERPNDB-BATCH-SEQ-NO
 18898        MOVE ZEROS                 TO ERPNDB-BATCH-CHG-SEQ-NO
 18899     ELSE
 18900        MOVE PI-PREV-KEY           TO ERPNDB-KEY
 18901        IF ERPNDB-BATCH-SEQ-NO = +9999
 18902           GO TO 4150-END-BATCH
 18903        ELSE
 18904           IF DISPLAY-CHANGE-RECORDS
 18905              ADD +1             TO ERPNDB-BATCH-CHG-SEQ-NO
 18906           ELSE
 18907              MOVE ZEROS         TO ERPNDB-BATCH-CHG-SEQ-NO
 18908              ADD +1             TO ERPNDB-BATCH-SEQ-NO.
 18909
 18910     IF FIRST-TIME
 18911         IF ERPNDB-BATCH-SEQ-NO = +1  AND
 18912            PI-PB-BATCH-SEQ-NO NOT = ZERO
 18913              MOVE PI-PB-BATCH-SEQ-NO TO ERPNDB-BATCH-SEQ-NO.
 18914
 18915
 18916* EXEC CICS HANDLE CONDITION
 18917*         ENDFILE  (4150-END-BATCH)
 18918*    END-EXEC.
 18919*    MOVE '"$''                   ! E #00016329' TO DFHEIV0
 18920     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 18921     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 347
* EL6311.cbl
 18922     MOVE X'4520233030303136333239' TO DFHEIV0(25:11)
 18923     CALL 'kxdfhei1' USING DFHEIV0
 18924     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18925
 18926
 18927 4105-READ-NEXT.
 18928
 18929* EXEC CICS HANDLE CONDITION
 18930*         NOTFND    (4150-END-BATCH)
 18931*    END-EXEC.
 18932*    MOVE '"$I                   ! F #00016334' TO DFHEIV0
 18933     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18934     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18935     MOVE X'4620233030303136333334' TO DFHEIV0(25:11)
 18936     CALL 'kxdfhei1' USING DFHEIV0
 18937     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18938
 18939
 18940     MOVE SPACES                 TO WS-REC-FOUND-SW.
 18941
 18942     IF PI-DISPLAY-ORIGINAL-BATCH
 18943        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 18944     ELSE
 18945        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 18946
 18947
 18948* EXEC CICS READ
 18949*         DATASET   (FILE-ID)
 18950*         SET       (ADDRESS OF PENDING-BUSINESS)
 18951*         RIDFLD    (ERPNDB-KEY)
 18952*         GTEQ
 18953*    END-EXEC.
 18954*    MOVE '&"S        G          (   #00016345' TO DFHEIV0
 18955     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 18956     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18957     MOVE X'2020233030303136333435' TO DFHEIV0(25:11)
 18958     CALL 'kxdfhei1' USING DFHEIV0,
 18959           FILE-ID,
 18960           DFHEIV20,
 18961           DFHEIV99,
 18962           ERPNDB-KEY,
 18963           DFHEIV99,
 18964           DFHEIV99,
 18965           DFHEIV99
 18966     SET ADDRESS OF PENDING-BUSINESS TO
 18967         DFHEIV20
 18968     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18969
 18970
 18971     IF PI-DISPLAY-ORIGINAL-BATCH
 18972        IF (PB-ORIGINAL-COMPANY-CD  NOT = PI-COMPANY-CD) OR
 18973           (PB-ORIGINAL-ENTRY-BATCH NOT = PI-PB-ENTRY-BATCH)
 18974           GO TO 4150-END-BATCH
 18975        ELSE
 18976           IF PB-BATCH-TRAILER
 18977              MOVE HIGH-VALUES   TO ERPNDB-BATCH-SEQ-ALPHA
 18978              GO TO 4105-READ-NEXT
 18979           ELSE
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 348
* EL6311.cbl
 18980              NEXT SENTENCE
 18981     ELSE
 18982        IF (PB-COMPANY-CD  NOT = PI-COMPANY-CD) OR
 18983           (PB-ENTRY-BATCH NOT = PI-PB-ENTRY-BATCH)
 18984           GO TO 4150-END-BATCH.
 18985
 18986     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 18987
 18988     IF WS-BATCH-PREFIX = '#CL'
 18989         MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 18990         GO TO 4105-READ-NEXT.
 18991
 18992     MOVE PB-CARRIER             TO PI-PB-CARRIER.
 18993     MOVE PB-GROUPING            TO PI-PB-GROUPING.
 18994     MOVE PB-STATE               TO PI-PB-STATE.
 18995     MOVE PB-ACCOUNT             TO PI-PB-ACCOUNT.
 18996
 18997     IF PB-BATCH-TRAILER
 18998        IF SHOW-RECORD
 18999           GO TO 4150-END-BATCH
 19000        ELSE
 19001           MOVE ER-2251         TO EMI-ERROR
 19002           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19003           MOVE 1               TO PI-BROWSE-TYPE
 19004           GO TO 7200-DISPLAY-BATCHES.
 19005
 19006     IF SHOW-RECORD
 19007           IF WS-NEW-CERT-NO NOT = PB-CERT-NO
 19008              GO TO 4110-BUMP-SEQ
 19009           ELSE
 19010              IF WS-NEW-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19011                 GO TO 4110-BUMP-SEQ
 19012              ELSE
 19013                 GO TO 4107-CHECK-REC-TYPE.
 19014
 19015     IF NOT  PI-PRIMARY-WITH-SELECT
 19016        GO TO 4107-CHECK-REC-TYPE.
 19017
 19018     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19019        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 19020           GO TO 4110-BUMP-SEQ
 19021        ELSE
 19022           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19023              GO TO 4107-CHECK-REC-TYPE
 19024           ELSE
 19025              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19026                 GO TO 4107-CHECK-REC-TYPE
 19027              ELSE
 19028                 GO TO 4110-BUMP-SEQ.
 19029
 19030     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19031        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19032           GO TO 4110-BUMP-SEQ.
 19033
 19034 4107-CHECK-REC-TYPE.
 19035     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19036         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19037             NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 349
* EL6311.cbl
 19038           ELSE
 19039             GO TO 4110-BUMP-SEQ.
 19040
 19041     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19042         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19043             NEXT SENTENCE
 19044           ELSE
 19045             GO TO 4110-BUMP-SEQ.
 19046
 19047     IF NOT DISPLAY-CHANGE-RECORDS AND
 19048        PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19049           GO TO 4110-BUMP-SEQ.
 19050
 19051     IF DISPLAY-HOLD-RECORDS AND
 19052        NOT PB-RECORD-ON-HOLD
 19053          GO TO 4110-BUMP-SEQ.
 19054
 19055     IF PB-ISSUE
 19056        IF DISPLAY-CHK-REQ-RECORDS
 19057            GO TO 4110-BUMP-SEQ.
 19058
 19059     IF PB-ISSUE
 19060        IF ISSUE-WITH-WARNING
 19061           IF PB-WARNING-ERRORS
 19062              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19063                  GO TO 4110-BUMP-SEQ
 19064              ELSE
 19065                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19066                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19067                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19068                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19069                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19070                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19071                 GO TO 7000-DISPLAY-ISSUES
 19072        ELSE
 19073            GO TO 4110-BUMP-SEQ.
 19074
 19075     IF PB-ISSUE
 19076        IF (ISSUES-IN-ERROR AND
 19077            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19078            ALL-ISSUES
 19079            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19080            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19081            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19082            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19083            MOVE PB-SV-STATE            TO PI-SV-STATE
 19084            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19085            GO TO 7000-DISPLAY-ISSUES
 19086        ELSE
 19087            GO TO 4110-BUMP-SEQ.
 19088
 19089     IF PB-CANCELLATION
 19090        IF DISPLAY-CHK-REQ-RECORDS
 19091           IF PB-C-REFUND-REQUESTED
 19092              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19093              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19094              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19095              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 350
* EL6311.cbl
 19096              MOVE PB-SV-STATE            TO PI-SV-STATE
 19097              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19098              GO TO 7100-DISPLAY-CANCELS
 19099           ELSE
 19100              GO TO 4110-BUMP-SEQ.
 19101
 19102     IF PB-CANCELLATION
 19103        IF CANCEL-WITH-WARNING
 19104           IF PB-WARNING-ERRORS
 19105              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19106                  GO TO 4110-BUMP-SEQ
 19107              ELSE
 19108                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19109                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19110                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19111                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19112                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19113                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19114                 GO TO 7100-DISPLAY-CANCELS
 19115           ELSE
 19116              GO TO 4110-BUMP-SEQ.
 19117
 19118     IF PB-CANCELLATION
 19119        IF (CANCEL-IN-ERROR  AND
 19120            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19121            ALL-CANCELS
 19122            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19123            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19124            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19125            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19126            MOVE PB-SV-STATE            TO PI-SV-STATE
 19127            MOVE 'Y'                    TO WS-PB-RECORDS-FOUND-SW
 19128            GO TO 7100-DISPLAY-CANCELS.
 19129
 19130 4110-BUMP-SEQ.
 19131     IF NOT DISPLAY-CHANGE-RECORDS
 19132        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 19133        ADD +1                   TO ERPNDB-BATCH-SEQ-NO
 19134     ELSE
 19135        IF PB-BATCH-SEQ-NO NOT = ERPNDB-BATCH-SEQ-NO
 19136           MOVE PB-BATCH-SEQ-NO  TO ERPNDB-BATCH-SEQ-NO
 19137           MOVE +999             TO ERPNDB-BATCH-CHG-SEQ-NO
 19138        ELSE
 19139           MOVE PB-BATCH-CHG-SEQ-NO  TO ERPNDB-BATCH-CHG-SEQ-NO
 19140           ADD +1                    TO ERPNDB-BATCH-CHG-SEQ-NO.
 19141
 19142     GO TO 4105-READ-NEXT.
 19143
 19144 4150-END-BATCH.
 19145******************************************************************
 19146*                                                                *
 19147*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 19148*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING     *
 19149*         PROGRAM.                                               *
 19150*                                                                *
 19151******************************************************************
 19152
 19153     IF  EIBTRNID NOT = TRANS-EXB1
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 351
* EL6311.cbl
 19154         IF PENDING-BUS-RECS-FOUND
 19155             NEXT SENTENCE
 19156           ELSE
 19157             MOVE '9'            TO PI-BROWSE-SW
 19158             GO TO 9400-CLEAR.
 19159
 19160     IF SHOW-RECORD
 19161        MOVE ER-2253             TO EMI-ERROR
 19162     ELSE
 19163        MOVE ER-2251             TO EMI-ERROR.
 19164
 19165     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19166
 19167     IF PI-MAP-NAME = SPACES
 19168        MOVE -1                  TO BMAINTL
 19169        MOVE EL631B              TO PI-MAP-NAME
 19170        GO TO 8100-SEND-INITIAL-MAP.
 19171
 19172     IF PI-MAP-NAME = EL631B
 19173        MOVE -1                  TO BMAINTL
 19174     ELSE
 19175        IF PI-MAP-NAME = EL631C
 19176           MOVE -1               TO CMAINTL
 19177        ELSE
 19178           MOVE -1               TO DPFENTRL.
 19179
 19180     GO TO 8200-SEND-DATAONLY.
 19181
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 352
* EL6311.cbl
 19183
 19184***************************************************************
 19185*     FORWARD BROWSING ROUTINE   (BY CSR)                     *
 19186*                                                             *
 19187*      1. START BROWSE WITH                                   *
 19188*         A. FIRST RECORD SPECIFIED FROM FIRST SCREEN         *
 19189*         B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN       *
 19190*         C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.       *
 19191*                                                             *
 19192*      2. READ RECORDS AND DETERMINE IF THEY ARE TO BE        *
 19193*         DISPLAYED BY USING THE FOLLOWING CHECKS.            *
 19194*         A. IS IT WITHIN THE SAME KEY GROUP?                 *
 19195*         B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED. *
 19196*         C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM   *
 19197*               AND IS IT TO BE DISPLAYED.                    *
 19198*         D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE        *
 19199*               DISPLAYED.                                    *
 19200*         E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE       *
 19201*               DISPLAYED.                                    *
 19202*                                                             *
 19203*      3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE      *
 19204*               RECORD KEY AND GO TO THE DISPLAY ROUTINE.     *
 19205***************************************************************
 19206
 19207 4200-BROWSE-CSR-FORWARD.
 19208
 19209     IF FIRST-TIME
 19210        MOVE PI-ERPNDB-CSR-KEY      TO ERPNDB-CSR-KEY
 19211     ELSE
 19212        MOVE PI-PREV-CSR-KEY        TO ERPNDB-CSR-KEY.
 19213
 19214
 19215* EXEC CICS HANDLE CONDITION
 19216*         NOTFND   (4250-END-RECORDS)
 19217*         ENDFILE  (4250-END-RECORDS)
 19218*    END-EXEC.
 19219*    MOVE '"$I''                  ! G #00016595' TO DFHEIV0
 19220     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19221     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19222     MOVE X'4720233030303136353935' TO DFHEIV0(25:11)
 19223     CALL 'kxdfhei1' USING DFHEIV0
 19224     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19225
 19226
 19227
 19228* EXEC CICS STARTBR
 19229*         DATASET   (FILE-ID-ERPNDB4)
 19230*         RIDFLD    (ERPNDB-CSR-KEY)
 19231*    END-EXEC.
 19232     MOVE 0
 19233       TO DFHEIV11
 19234*    MOVE '&,         G          &   #00016600' TO DFHEIV0
 19235     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19236     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19237     MOVE X'2020233030303136363030' TO DFHEIV0(25:11)
 19238     CALL 'kxdfhei1' USING DFHEIV0,
 19239           FILE-ID-ERPNDB4,
 19240           ERPNDB-CSR-KEY,
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 353
* EL6311.cbl
 19241           DFHEIV99,
 19242           DFHEIV11,
 19243           DFHEIV99
 19244     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19245
 19246
 19247     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 19248
 19249     IF FIRST-TIME
 19250        MOVE SPACE               TO WS-FIRST-TIME-SW
 19251        GO TO 4205-READ-NEXT-RECORD.
 19252
 19253
 19254* EXEC CICS READNEXT
 19255*         DATASET    (FILE-ID-ERPNDB4)
 19256*         SET        (ADDRESS OF PENDING-BUSINESS)
 19257*         RIDFLD     (ERPNDB-CSR-KEY)
 19258*    END-EXEC.
 19259     MOVE 0
 19260       TO DFHEIV11
 19261*    MOVE '&.S                   )   #00016611' TO DFHEIV0
 19262     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19263     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19264     MOVE X'2020233030303136363131' TO DFHEIV0(25:11)
 19265     CALL 'kxdfhei1' USING DFHEIV0,
 19266           FILE-ID-ERPNDB4,
 19267           DFHEIV20,
 19268           DFHEIV99,
 19269           ERPNDB-CSR-KEY,
 19270           DFHEIV99,
 19271           DFHEIV11,
 19272           DFHEIV99,
 19273           DFHEIV99
 19274     SET ADDRESS OF PENDING-BUSINESS TO
 19275         DFHEIV20
 19276     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19277
 19278
 19279 4205-READ-NEXT-RECORD.
 19280
 19281
 19282* EXEC CICS READNEXT
 19283*         DATASET    (FILE-ID-ERPNDB4)
 19284*         SET        (ADDRESS OF PENDING-BUSINESS)
 19285*         RIDFLD     (ERPNDB-CSR-KEY)
 19286*    END-EXEC.
 19287     MOVE 0
 19288       TO DFHEIV11
 19289*    MOVE '&.S                   )   #00016619' TO DFHEIV0
 19290     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19291     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19292     MOVE X'2020233030303136363139' TO DFHEIV0(25:11)
 19293     CALL 'kxdfhei1' USING DFHEIV0,
 19294           FILE-ID-ERPNDB4,
 19295           DFHEIV20,
 19296           DFHEIV99,
 19297           ERPNDB-CSR-KEY,
 19298           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 354
* EL6311.cbl
 19299           DFHEIV11,
 19300           DFHEIV99,
 19301           DFHEIV99
 19302     SET ADDRESS OF PENDING-BUSINESS TO
 19303         DFHEIV20
 19304     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19305
 19306
 19307     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19308
 19309     IF WS-BATCH-PREFIX = '#CL'
 19310        GO TO 4205-READ-NEXT-RECORD.
 19311
 19312     IF PB-CSR-COMPANY-CD   NOT = PI-COMPANY-CD OR
 19313        PB-CSR-ID           NOT = PI-PB-CSR-ID
 19314        GO TO 4250-END-RECORDS.
 19315
 19316     IF PB-BATCH-TRAILER
 19317        GO TO 4205-READ-NEXT-RECORD.
 19318
 19319     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19320        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 19321           GO TO 4205-READ-NEXT-RECORD
 19322        ELSE
 19323           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19324              GO TO 4210-CHECK-REC-TYPE
 19325           ELSE
 19326              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19327                 GO TO 4210-CHECK-REC-TYPE
 19328              ELSE
 19329                 GO TO 4205-READ-NEXT-RECORD.
 19330
 19331     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19332        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19333           GO TO 4205-READ-NEXT-RECORD.
 19334
 19335 4210-CHECK-REC-TYPE.
 19336     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19337         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19338             NEXT SENTENCE
 19339         ELSE
 19340             GO TO 4205-READ-NEXT-RECORD.
 19341
 19342     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19343         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19344             NEXT SENTENCE
 19345        ELSE
 19346             GO TO 4205-READ-NEXT-RECORD.
 19347
 19348     IF NOT DISPLAY-CHANGE-RECORDS AND
 19349            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19350        GO TO 4205-READ-NEXT-RECORD.
 19351
 19352     IF DISPLAY-HOLD-RECORDS AND
 19353        NOT PB-RECORD-ON-HOLD
 19354          GO TO 4205-READ-NEXT-RECORD.
 19355
 19356     IF PB-ISSUE
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 355
* EL6311.cbl
 19357        IF DISPLAY-CHK-REQ-RECORDS
 19358            GO TO 4205-READ-NEXT-RECORD.
 19359
 19360     IF PB-ISSUE
 19361        IF ISSUE-WITH-WARNING
 19362           IF PB-WARNING-ERRORS
 19363              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19364                  GO TO 4205-READ-NEXT-RECORD
 19365              ELSE
 19366                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19367                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19368                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19369                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19370                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19371                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19372                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19373                 GO TO 7000-DISPLAY-ISSUES
 19374           ELSE
 19375              GO TO 4205-READ-NEXT-RECORD.
 19376
 19377     IF PB-ISSUE
 19378        IF (ISSUES-IN-ERROR AND
 19379            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19380            ALL-ISSUES
 19381            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19382            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19383            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19384            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19385            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19386            MOVE PB-SV-STATE            TO PI-SV-STATE
 19387            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19388            GO TO 7000-DISPLAY-ISSUES
 19389        ELSE
 19390            GO TO 4205-READ-NEXT-RECORD.
 19391
 19392     IF PB-CANCELLATION
 19393        IF DISPLAY-CHK-REQ-RECORDS
 19394           IF PB-C-REFUND-REQUESTED
 19395              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19396              MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19397              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19398              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19399              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19400              MOVE PB-SV-STATE            TO PI-SV-STATE
 19401              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19402              GO TO 7100-DISPLAY-CANCELS
 19403           ELSE
 19404               GO TO 4205-READ-NEXT-RECORD.
 19405
 19406     IF PB-CANCELLATION
 19407        IF CANCEL-WITH-WARNING
 19408           IF PB-WARNING-ERRORS
 19409              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19410                  GO TO 4205-READ-NEXT-RECORD
 19411              ELSE
 19412                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19413                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19414                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 356
* EL6311.cbl
 19415                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19416                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19417                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19418                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19419                 GO TO 7100-DISPLAY-CANCELS
 19420           ELSE
 19421              GO TO 4205-READ-NEXT-RECORD.
 19422
 19423     IF PB-CANCELLATION
 19424        IF (CANCEL-IN-ERROR  AND
 19425            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19426            ALL-CANCELS
 19427            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19428            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19429            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19430            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19431            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19432            MOVE PB-SV-STATE            TO PI-SV-STATE
 19433            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19434            GO TO 7100-DISPLAY-CANCELS.
 19435
 19436     GO TO 4205-READ-NEXT-RECORD.
 19437
 19438 4250-END-RECORDS.
 19439******************************************************************
 19440*                                                                *
 19441*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 19442*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING
 19443*         PROGRAM.                                               *
 19444*                                                                *
 19445******************************************************************
 19446
 19447     IF BROWSE-STARTED
 19448        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 19449
 19450* EXEC CICS ENDBR
 19451*            DATASET  (FILE-ID-ERPNDB4)
 19452*       END-EXEC.
 19453     MOVE 0
 19454       TO DFHEIV11
 19455*    MOVE '&2                    $   #00016767' TO DFHEIV0
 19456     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19457     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19458     MOVE X'2020233030303136373637' TO DFHEIV0(25:11)
 19459     CALL 'kxdfhei1' USING DFHEIV0,
 19460           FILE-ID-ERPNDB4,
 19461           DFHEIV11,
 19462           DFHEIV99
 19463     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19464
 19465
 19466     IF  EIBTRNID NOT = TRANS-EXB1
 19467         IF PENDING-BUS-RECS-FOUND
 19468             NEXT SENTENCE
 19469           ELSE
 19470             MOVE '9'            TO PI-BROWSE-SW
 19471             GO TO 9400-CLEAR.
 19472
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 357
* EL6311.cbl
 19473     IF SHOW-RECORD
 19474        MOVE ER-2253            TO EMI-ERROR
 19475       ELSE
 19476        MOVE ER-2254            TO EMI-ERROR.
 19477
 19478     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19479
 19480     IF PI-MAP-NAME = SPACES
 19481        MOVE -1                  TO DPFENTRL
 19482        MOVE EL631D               TO PI-MAP-NAME
 19483        GO TO 8100-SEND-INITIAL-MAP.
 19484
 19485     IF PI-MAP-NAME = EL631B
 19486        MOVE -1                  TO BMAINTL
 19487     ELSE
 19488        IF PI-MAP-NAME = EL631C
 19489           MOVE -1               TO CMAINTL
 19490        ELSE
 19491           MOVE -1               TO DPFENTRL.
 19492
 19493     GO TO 8200-SEND-DATAONLY.
 19494
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 358
* EL6311.cbl
 19496
 19497***************************************************************
 19498*                                                             *
 19499*     FORWARD BROWSING ROUTINE   (BY FILE)                    *
 19500*                                                             *
 19501*       1. READ RECORDS WITHIN THE FILE BY COMPANY            *
 19502*          A. FIRST TIME INTO PROGRAM FROM FIRST SCREEN       *
 19503*          B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN      *
 19504*                                                             *
 19505*       2. READ RECORDS AND DETERMINE IF THEY ARE TO BE       *
 19506*          DISPLAYED BY USING THE FOLLOWING CHECKS.           *
 19507*          A. IS IT WITHIN THE SAME COMPANY                   *
 19508*          B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED.*
 19509*          C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM  *
 19510*                AND IS IT TO BE DISPLAYED.                   *
 19511*          D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE       *
 19512*                DISPLAYED.                                   *
 19513*          E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE      *
 19514*                DISPLAYED.                                   *
 19515*                                                             *
 19516*       3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE     *
 19517*                RECORD KEY AND GO TO THE DISPLAY ROUTINE.    *
 19518*                                                             *
 19519*       4. WHEN READING ADDITION RECORDS ADJUSTMENTS MUST BE  *
 19520*                MADE TO BYPASS THE CORRECTION RECORDS IF     *
 19521*                THEY ARE NOT TO BE DISPLAYED.                *
 19522*                                                             *
 19523***************************************************************
 19524
 19525 4300-BROWSE-FILE-FORWARD.
 19526     IF FIRST-TIME OR SHOW-RECORD
 19527        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY
 19528        MOVE +1                  TO ERPNDB-BATCH-SEQ-NO
 19529        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 19530     ELSE
 19531        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 19532        IF ERPNDB-BATCH-SEQ-NO = +9999
 19533           MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
 19534        ELSE
 19535           IF DISPLAY-CHANGE-RECORDS
 19536              ADD +1             TO ERPNDB-BATCH-CHG-SEQ-NO
 19537           ELSE
 19538              MOVE ZEROS         TO ERPNDB-BATCH-CHG-SEQ-NO
 19539              ADD +1             TO ERPNDB-BATCH-SEQ-NO.
 19540
 19541
 19542* EXEC CICS HANDLE CONDITION
 19543*         ENDFILE  (4350-END-BATCH)
 19544*         NOTFND   (4350-END-BATCH)
 19545*    END-EXEC.
 19546*    MOVE '"$''I                  ! H #00016846' TO DFHEIV0
 19547     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 19548     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19549     MOVE X'4820233030303136383436' TO DFHEIV0(25:11)
 19550     CALL 'kxdfhei1' USING DFHEIV0
 19551     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19552
 19553
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 359
* EL6311.cbl
 19554 4305-READ-NEXT.
 19555     IF PI-DISPLAY-ORIGINAL-BATCH
 19556        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 19557     ELSE
 19558        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 19559
 19560
 19561* EXEC CICS READ
 19562*         DATASET   (FILE-ID)
 19563*         SET       (ADDRESS OF PENDING-BUSINESS)
 19564*         RIDFLD    (ERPNDB-KEY)
 19565*         GTEQ
 19566*    END-EXEC.
 19567*    MOVE '&"S        G          (   #00016857' TO DFHEIV0
 19568     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 19569     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19570     MOVE X'2020233030303136383537' TO DFHEIV0(25:11)
 19571     CALL 'kxdfhei1' USING DFHEIV0,
 19572           FILE-ID,
 19573           DFHEIV20,
 19574           DFHEIV99,
 19575           ERPNDB-KEY,
 19576           DFHEIV99,
 19577           DFHEIV99,
 19578           DFHEIV99
 19579     SET ADDRESS OF PENDING-BUSINESS TO
 19580         DFHEIV20
 19581     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19582
 19583
 19584     IF PB-COMPANY-CD NOT = PI-COMPANY-CD
 19585        GO TO 4350-END-BATCH.
 19586
 19587     MOVE PB-ENTRY-BATCH         TO ERPNDB-ENTRY-BATCH
 19588                                    WS-BATCH-NO.
 19589
 19590     IF  WS-BATCH-PREFIX = '#CL'
 19591         MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 19592         GO TO 4305-READ-NEXT.
 19593
 19594     MOVE PB-CONTROL-PRIMARY     TO PI-ERPNDB-KEY.
 19595     MOVE PB-CARRIER             TO PI-PB-CARRIER.
 19596     MOVE PB-GROUPING            TO PI-PB-GROUPING.
 19597     MOVE PB-STATE               TO PI-PB-STATE.
 19598     MOVE PB-ACCOUNT             TO PI-PB-ACCOUNT.
 19599
 19600     IF PB-BATCH-TRAILER
 19601        MOVE HIGH-VALUES         TO ERPNDB-BATCH-SEQ-ALPHA
 19602        GO TO 4305-READ-NEXT.
 19603
 19604     IF SHOW-RECORD
 19605           IF WS-NEW-CERT-NO NOT = PB-CERT-NO
 19606              GO TO 4310-BUMP-SEQ
 19607           ELSE
 19608              IF WS-NEW-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19609                 GO TO 4310-BUMP-SEQ
 19610              ELSE
 19611                 GO TO 4307-CHECK-REC-TYPE.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 360
* EL6311.cbl
 19612
 19613     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19614        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 19615           GO TO 4310-BUMP-SEQ
 19616        ELSE
 19617           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19618              GO TO 4307-CHECK-REC-TYPE
 19619           ELSE
 19620              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19621                 GO TO 4307-CHECK-REC-TYPE
 19622              ELSE
 19623                 GO TO 4310-BUMP-SEQ.
 19624
 19625     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19626        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19627           GO TO 4310-BUMP-SEQ.
 19628
 19629 4307-CHECK-REC-TYPE.
 19630     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19631         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19632             NEXT SENTENCE
 19633         ELSE
 19634             GO TO 4310-BUMP-SEQ.
 19635
 19636     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19637         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19638             NEXT SENTENCE
 19639        ELSE
 19640             GO TO 4310-BUMP-SEQ.
 19641
 19642     IF NOT DISPLAY-CHANGE-RECORDS AND
 19643            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19644        GO TO 4310-BUMP-SEQ.
 19645
 19646     IF DISPLAY-HOLD-RECORDS AND
 19647        NOT PB-RECORD-ON-HOLD
 19648          GO TO 4310-BUMP-SEQ.
 19649
 19650     IF PB-ISSUE
 19651        IF DISPLAY-CHK-REQ-RECORDS
 19652           GO TO 4310-BUMP-SEQ.
 19653
 19654     IF PB-ISSUE
 19655        IF ISSUE-WITH-WARNING
 19656           IF PB-WARNING-ERRORS
 19657              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19658                  GO TO 4310-BUMP-SEQ
 19659              ELSE
 19660                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19661                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19662                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19663                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19664                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19665                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19666                 GO TO 7000-DISPLAY-ISSUES
 19667           ELSE
 19668              GO TO 4310-BUMP-SEQ.
 19669
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 361
* EL6311.cbl
 19670     IF PB-ISSUE
 19671        IF (ISSUES-IN-ERROR AND
 19672            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19673            ALL-ISSUES
 19674            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19675            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19676            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19677            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19678            MOVE PB-SV-STATE            TO PI-SV-STATE
 19679            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19680            GO TO 7000-DISPLAY-ISSUES
 19681        ELSE
 19682            GO TO 4310-BUMP-SEQ.
 19683
 19684     IF PB-CANCELLATION
 19685        IF DISPLAY-CHK-REQ-RECORDS
 19686           IF PB-C-REFUND-REQUESTED
 19687              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19688              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19689              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19690              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19691              MOVE PB-SV-STATE            TO PI-SV-STATE
 19692              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19693              GO TO 7100-DISPLAY-CANCELS
 19694           ELSE
 19695              GO TO 4310-BUMP-SEQ.
 19696
 19697     IF PB-CANCELLATION
 19698        IF CANCEL-WITH-WARNING
 19699           IF PB-WARNING-ERRORS
 19700              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19701                  GO TO 4310-BUMP-SEQ
 19702              ELSE
 19703                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19704                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19705                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19706                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19707                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19708                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19709                 GO TO 7100-DISPLAY-CANCELS
 19710           ELSE
 19711              GO TO 4310-BUMP-SEQ.
 19712
 19713     IF PB-CANCELLATION
 19714        IF (CANCEL-IN-ERROR  AND
 19715            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19716            ALL-CANCELS
 19717            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19718            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19719            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19720            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19721            MOVE PB-SV-STATE            TO PI-SV-STATE
 19722            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19723            GO TO 7100-DISPLAY-CANCELS.
 19724
 19725 4310-BUMP-SEQ.
 19726     IF NOT DISPLAY-CHANGE-RECORDS
 19727        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 362
* EL6311.cbl
 19728        ADD +1                   TO ERPNDB-BATCH-SEQ-NO
 19729     ELSE
 19730        IF PB-BATCH-SEQ-NO NOT = ERPNDB-BATCH-SEQ-NO
 19731           MOVE PB-BATCH-SEQ-NO  TO ERPNDB-BATCH-SEQ-NO
 19732           MOVE +999             TO ERPNDB-BATCH-CHG-SEQ-NO
 19733        ELSE
 19734           MOVE PB-BATCH-CHG-SEQ-NO  TO ERPNDB-BATCH-CHG-SEQ-NO
 19735           ADD +1                TO ERPNDB-BATCH-CHG-SEQ-NO.
 19736
 19737     GO TO 4305-READ-NEXT.
 19738
 19739 4350-END-BATCH.
 19740
 19741******************************************************************
 19742*                                                                *
 19743*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 19744*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING    *
 19745*         PROGRAM.                                               *
 19746*                                                                *
 19747******************************************************************
 19748
 19749     IF  EIBTRNID NOT = TRANS-EXB1
 19750         IF PENDING-BUS-RECS-FOUND
 19751             NEXT SENTENCE
 19752           ELSE
 19753             MOVE '9'            TO PI-BROWSE-SW
 19754             GO TO 9400-CLEAR.
 19755
 19756     IF SHOW-RECORD
 19757        MOVE ER-2253            TO EMI-ERROR
 19758     ELSE
 19759        MOVE ER-2251            TO EMI-ERROR.
 19760
 19761     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19762
 19763     IF PI-MAP-NAME = SPACES
 19764        MOVE -1                  TO BMAINTL
 19765        MOVE EL631B               TO PI-MAP-NAME
 19766        GO TO 8100-SEND-INITIAL-MAP.
 19767
 19768     IF PI-MAP-NAME = EL631B
 19769        MOVE -1                  TO BMAINTL
 19770     ELSE
 19771        IF PI-MAP-NAME = EL631C
 19772           MOVE -1               TO CMAINTL
 19773        ELSE
 19774           MOVE -1               TO DPFENTRL.
 19775
 19776     GO TO 8200-SEND-DATAONLY.
 19777
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 363
* EL6311.cbl
 19779
 19780******************************************************************
 19781*                                                                *
 19782*        B R O W S E   D E T A I L   B A C K W A R D             *
 19783*                                                                *
 19784******************************************************************
 19785
 19786 4500-BROWSE-DETAIL-BACKWARD.
 19787
 19788     MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY.
 19789
 19790
 19791* EXEC CICS HANDLE CONDITION
 19792*         NOTFND   (4570-NOT-FOUND)
 19793*         ENDFILE  (4550-END-RECORDS)
 19794*    END-EXEC
 19795*    MOVE '"$I''                  ! I #00017070' TO DFHEIV0
 19796     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19797     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19798     MOVE X'4920233030303137303730' TO DFHEIV0(25:11)
 19799     CALL 'kxdfhei1' USING DFHEIV0
 19800     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19801
 19802
 19803* EXEC CICS STARTBR
 19804*         DATASET   (FILE-ID-ERPNDB2)
 19805*         RIDFLD    (ERPNDB-ALT-KEY)
 19806*    END-EXEC.
 19807     MOVE 0
 19808       TO DFHEIV11
 19809*    MOVE '&,         G          &   #00017075' TO DFHEIV0
 19810     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19811     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19812     MOVE X'2020233030303137303735' TO DFHEIV0(25:11)
 19813     CALL 'kxdfhei1' USING DFHEIV0,
 19814           FILE-ID-ERPNDB2,
 19815           ERPNDB-ALT-KEY,
 19816           DFHEIV99,
 19817           DFHEIV11,
 19818           DFHEIV99
 19819     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19820
 19821
 19822     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW
 19823                                    WS-FIRST-TIME-SW.
 19824
 19825 4505-READ-PREV-RECORD.
 19826
 19827* EXEC CICS READPREV
 19828*         DATASET    (FILE-ID-ERPNDB2)
 19829*         SET        (ADDRESS OF PENDING-BUSINESS)
 19830*         RIDFLD     (ERPNDB-ALT-KEY)
 19831*    END-EXEC.
 19832     MOVE 0
 19833       TO DFHEIV11
 19834*    MOVE '&0S                   )   #00017084' TO DFHEIV0
 19835     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 19836     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 364
* EL6311.cbl
 19837     MOVE X'2020233030303137303834' TO DFHEIV0(25:11)
 19838     CALL 'kxdfhei1' USING DFHEIV0,
 19839           FILE-ID-ERPNDB2,
 19840           DFHEIV20,
 19841           DFHEIV99,
 19842           ERPNDB-ALT-KEY,
 19843           DFHEIV99,
 19844           DFHEIV11,
 19845           DFHEIV99,
 19846           DFHEIV99
 19847     SET ADDRESS OF PENDING-BUSINESS TO
 19848         DFHEIV20
 19849     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19850
 19851
 19852     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19853
 19854     IF WS-BATCH-PREFIX = '#CL'
 19855         GO TO 4505-READ-PREV-RECORD.
 19856
 19857     IF FIRST-TIME
 19858         MOVE SPACE               TO WS-FIRST-TIME-SW
 19859         GO TO 4505-READ-PREV-RECORD.
 19860
 19861     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD  OR
 19862        PB-CARRIER       NOT = PI-PB-CARRIER  OR
 19863        PB-GROUPING      NOT = PI-PB-GROUPING OR
 19864        PB-STATE         NOT = PI-PB-STATE    OR
 19865        PB-ACCOUNT       NOT = PI-PB-ACCOUNT
 19866          GO TO 4550-END-RECORDS.
 19867
 19868
 19869     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 19870
 19871     IF PB-BATCH-TRAILER
 19872        GO TO 4505-READ-PREV-RECORD.
 19873
 19874     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19875
 19876     IF  WS-BATCH-PREFIX = '#CL'
 19877         GO TO 4505-READ-PREV-RECORD.
 19878
 19879     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19880        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 19881           GO TO 4505-READ-PREV-RECORD
 19882        ELSE
 19883           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19884              GO TO 4510-CHECK-REC-TYPE
 19885           ELSE
 19886              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19887                 GO TO 4510-CHECK-REC-TYPE
 19888              ELSE
 19889                 GO TO 4505-READ-PREV-RECORD.
 19890
 19891     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19892        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19893           GO TO 4505-READ-PREV-RECORD.
 19894
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 365
* EL6311.cbl
 19895 4510-CHECK-REC-TYPE.
 19896     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19897         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19898             NEXT SENTENCE
 19899         ELSE
 19900             GO TO 4505-READ-PREV-RECORD.
 19901
 19902     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19903         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19904             NEXT SENTENCE
 19905        ELSE
 19906             GO TO 4505-READ-PREV-RECORD.
 19907
 19908     IF NOT DISPLAY-CHANGE-RECORDS AND
 19909            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19910        GO TO 4505-READ-PREV-RECORD.
 19911
 19912     IF DISPLAY-HOLD-RECORDS AND
 19913        NOT PB-RECORD-ON-HOLD
 19914          GO TO 4505-READ-PREV-RECORD.
 19915
 19916     IF PB-ISSUE
 19917        IF DISPLAY-CHK-REQ-RECORDS
 19918           GO TO 4505-READ-PREV-RECORD.
 19919
 19920     IF PB-ISSUE
 19921        IF ISSUE-WITH-WARNING
 19922           IF PB-WARNING-ERRORS
 19923              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19924                  GO TO 4505-READ-PREV-RECORD
 19925              ELSE
 19926                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19927                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19928                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19929                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19930                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19931                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19932                 GO TO 7000-DISPLAY-ISSUES
 19933           ELSE
 19934              GO TO 4505-READ-PREV-RECORD.
 19935
 19936     IF PB-ISSUE
 19937        IF (ISSUES-IN-ERROR AND
 19938            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19939            ALL-ISSUES
 19940            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19941            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19942            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19943            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19944            MOVE PB-SV-STATE            TO PI-SV-STATE
 19945            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19946            GO TO 7000-DISPLAY-ISSUES
 19947        ELSE
 19948            GO TO 4505-READ-PREV-RECORD.
 19949
 19950     IF PB-CANCELLATION
 19951        IF DISPLAY-CHK-REQ-RECORDS
 19952           IF PB-C-REFUND-REQUESTED
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 366
* EL6311.cbl
 19953              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19954              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19955              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19956              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19957              MOVE PB-SV-STATE            TO PI-SV-STATE
 19958              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19959              GO TO 7100-DISPLAY-CANCELS
 19960           ELSE
 19961              GO TO 4505-READ-PREV-RECORD.
 19962
 19963     IF PB-CANCELLATION
 19964        IF CANCEL-WITH-WARNING
 19965           IF PB-WARNING-ERRORS
 19966              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19967                  GO TO 4505-READ-PREV-RECORD
 19968              ELSE
 19969                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19970                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19971                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19972                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19973                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19974                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19975                 GO TO 7100-DISPLAY-CANCELS
 19976           ELSE
 19977              GO TO 4505-READ-PREV-RECORD.
 19978
 19979     IF PB-CANCELLATION
 19980        IF (CANCEL-IN-ERROR  AND
 19981            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19982            ALL-CANCELS
 19983            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19984            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19985            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19986            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19987            MOVE PB-SV-STATE            TO PI-SV-STATE
 19988            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19989            GO TO 7100-DISPLAY-CANCELS.
 19990
 19991     GO TO 4505-READ-PREV-RECORD.
 19992
 19993 4550-END-RECORDS.
 19994     IF PI-MAP-NAME = EL631B
 19995        MOVE -1                  TO BMAINTL
 19996     ELSE
 19997        IF PI-MAP-NAME = EL631C
 19998           MOVE -1               TO CMAINTL
 19999        ELSE
 20000           MOVE -1               TO DPFENTRL.
 20001
 20002     MOVE ER-2255               TO EMI-ERROR.
 20003     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20004     GO TO 8200-SEND-DATAONLY.
 20005
 20006 4570-NOT-FOUND.
 20007
 20008******************************************************************
 20009*      CONDITION MAY OCCUR IF PREV. RECORD HAS BEEN DELETED.     *
 20010******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 367
* EL6311.cbl
 20011
 20012
 20013* EXEC CICS RESETBR
 20014*         DATASET    (FILE-ID-ERPNDB2)
 20015*         RIDFLD     (ERPNDB-ALT-KEY)
 20016*    END-EXEC.
 20017     MOVE 0
 20018       TO DFHEIV11
 20019*    MOVE '&4         G          &   #00017250' TO DFHEIV0
 20020     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 20021     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20022     MOVE X'2020233030303137323530' TO DFHEIV0(25:11)
 20023     CALL 'kxdfhei1' USING DFHEIV0,
 20024           FILE-ID-ERPNDB2,
 20025           ERPNDB-ALT-KEY,
 20026           DFHEIV99,
 20027           DFHEIV11,
 20028           DFHEIV99
 20029     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20030
 20031
 20032
 20033* EXEC CICS READNEXT
 20034*         DATASET    (FILE-ID-ERPNDB2)
 20035*         SET        (ADDRESS OF PENDING-BUSINESS)
 20036*         RIDFLD     (ERPNDB-ALT-KEY)
 20037*    END-EXEC.
 20038     MOVE 0
 20039       TO DFHEIV11
 20040*    MOVE '&.S                   )   #00017255' TO DFHEIV0
 20041     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 20042     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20043     MOVE X'2020233030303137323535' TO DFHEIV0(25:11)
 20044     CALL 'kxdfhei1' USING DFHEIV0,
 20045           FILE-ID-ERPNDB2,
 20046           DFHEIV20,
 20047           DFHEIV99,
 20048           ERPNDB-ALT-KEY,
 20049           DFHEIV99,
 20050           DFHEIV11,
 20051           DFHEIV99,
 20052           DFHEIV99
 20053     SET ADDRESS OF PENDING-BUSINESS TO
 20054         DFHEIV20
 20055     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20056
 20057
 20058
 20059* EXEC CICS READPREV
 20060*         DATASET    (FILE-ID-ERPNDB2)
 20061*         SET        (ADDRESS OF PENDING-BUSINESS)
 20062*         RIDFLD     (ERPNDB-ALT-KEY)
 20063*    END-EXEC.
 20064     MOVE 0
 20065       TO DFHEIV11
 20066*    MOVE '&0S                   )   #00017261' TO DFHEIV0
 20067     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20068     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 368
* EL6311.cbl
 20069     MOVE X'2020233030303137323631' TO DFHEIV0(25:11)
 20070     CALL 'kxdfhei1' USING DFHEIV0,
 20071           FILE-ID-ERPNDB2,
 20072           DFHEIV20,
 20073           DFHEIV99,
 20074           ERPNDB-ALT-KEY,
 20075           DFHEIV99,
 20076           DFHEIV11,
 20077           DFHEIV99,
 20078           DFHEIV99
 20079     SET ADDRESS OF PENDING-BUSINESS TO
 20080         DFHEIV20
 20081     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20082
 20083
 20084 4580-READ-PREV-RECORD.
 20085
 20086* EXEC CICS READPREV
 20087*         DATASET    (FILE-ID-ERPNDB2)
 20088*         SET        (ADDRESS OF PENDING-BUSINESS)
 20089*         RIDFLD     (ERPNDB-ALT-KEY)
 20090*    END-EXEC.
 20091     MOVE 0
 20092       TO DFHEIV11
 20093*    MOVE '&0S                   )   #00017268' TO DFHEIV0
 20094     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20095     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20096     MOVE X'2020233030303137323638' TO DFHEIV0(25:11)
 20097     CALL 'kxdfhei1' USING DFHEIV0,
 20098           FILE-ID-ERPNDB2,
 20099           DFHEIV20,
 20100           DFHEIV99,
 20101           ERPNDB-ALT-KEY,
 20102           DFHEIV99,
 20103           DFHEIV11,
 20104           DFHEIV99,
 20105           DFHEIV99
 20106     SET ADDRESS OF PENDING-BUSINESS TO
 20107         DFHEIV20
 20108     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20109
 20110
 20111     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20112
 20113     IF WS-BATCH-PREFIX = '#CL'
 20114        GO TO 4580-READ-PREV-RECORD.
 20115
 20116     MOVE SPACE                  TO WS-FIRST-TIME-SW.
 20117     GO TO 4505-READ-PREV-RECORD.
 20118
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 369
* EL6311.cbl
 20120
 20121******************************************************************
 20122*                                                                *
 20123*        B R O W S E   P R I M A R Y   B A C K W A R D           *
 20124*                                                                *
 20125******************************************************************
 20126
 20127 4600-BROWSE-PRIMARY-BACKWARD.
 20128        MOVE PI-PREV-KEY         TO ERPNDB-KEY.
 20129
 20130     IF ERPNDB-BATCH-SEQ-NO = +9999
 20131        MOVE PI-HIGH-SEQ-NO      TO ERPNDB-BATCH-SEQ-NO.
 20132
 20133        IF ERPNDB-BATCH-SEQ-NO = +0000
 20134           GO TO 4650-END-BATCH
 20135        ELSE
 20136           IF PI-MAP-NAME NOT = EL631D
 20137              IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20138                 SUBTRACT +1      FROM ERPNDB-BATCH-CHG-SEQ-NO
 20139              ELSE
 20140                 SUBTRACT +1      FROM ERPNDB-BATCH-SEQ-NO
 20141                 IF DISPLAY-CHANGE-RECORDS
 20142                    MOVE +999     TO ERPNDB-BATCH-CHG-SEQ-NO
 20143                 ELSE
 20144                    MOVE ZEROS    TO ERPNDB-BATCH-CHG-SEQ-NO.
 20145
 20146
 20147* EXEC CICS HANDLE CONDITION
 20148*         NOTFND    (4680-NOT-FOUND)
 20149*         ENDFILE   (4680-NOT-FOUND)
 20150*    END-EXEC.
 20151*    MOVE '"$I''                  ! J #00017309' TO DFHEIV0
 20152     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20153     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20154     MOVE X'4A20233030303137333039' TO DFHEIV0(25:11)
 20155     CALL 'kxdfhei1' USING DFHEIV0
 20156     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20157
 20158
 20159 4605-READ-NEXT.
 20160     IF ERPNDB-BATCH-SEQ-NO = +0000
 20161        GO TO 4650-END-BATCH.
 20162
 20163     IF PI-DISPLAY-ORIGINAL-BATCH
 20164        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 20165     ELSE
 20166        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 20167
 20168
 20169* EXEC CICS READ
 20170*         DATASET   (FILE-ID)
 20171*         SET       (ADDRESS OF PENDING-BUSINESS)
 20172*         RIDFLD    (ERPNDB-KEY)
 20173*    END-EXEC.
 20174*    MOVE '&"S        E          (   #00017323' TO DFHEIV0
 20175     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 20176     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20177     MOVE X'2020233030303137333233' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 370
* EL6311.cbl
 20178     CALL 'kxdfhei1' USING DFHEIV0,
 20179           FILE-ID,
 20180           DFHEIV20,
 20181           DFHEIV99,
 20182           ERPNDB-KEY,
 20183           DFHEIV99,
 20184           DFHEIV99,
 20185           DFHEIV99
 20186     SET ADDRESS OF PENDING-BUSINESS TO
 20187         DFHEIV20
 20188     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20189
 20190
 20191     IF NOT  PI-PRIMARY-WITH-SELECT
 20192        GO TO 4607-CHECK-REC-TYPE.
 20193
 20194     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20195
 20196     IF  WS-BATCH-PREFIX = '#CL'
 20197         GO TO 4610-BUMP-SEQ.
 20198
 20199     IF PI-PB-CERT-NO NOT = LOW-VALUES
 20200        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 20201           GO TO 4610-BUMP-SEQ
 20202        ELSE
 20203           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 20204              GO TO 4607-CHECK-REC-TYPE
 20205           ELSE
 20206              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 20207                 GO TO 4607-CHECK-REC-TYPE
 20208              ELSE
 20209                 GO TO 4610-BUMP-SEQ.
 20210
 20211     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 20212        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 20213           GO TO 4610-BUMP-SEQ.
 20214
 20215 4607-CHECK-REC-TYPE.
 20216     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20217         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20218             NEXT SENTENCE
 20219         ELSE
 20220             GO TO 4610-BUMP-SEQ.
 20221
 20222     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20223         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20224             NEXT SENTENCE
 20225        ELSE
 20226             GO TO 4610-BUMP-SEQ.
 20227
 20228     IF NOT DISPLAY-CHANGE-RECORDS AND
 20229            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20230        GO TO 4610-BUMP-SEQ.
 20231
 20232     IF DISPLAY-HOLD-RECORDS AND
 20233        NOT PB-RECORD-ON-HOLD
 20234          GO TO 4610-BUMP-SEQ.
 20235
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 371
* EL6311.cbl
 20236     IF PB-ISSUE
 20237        IF DISPLAY-CHK-REQ-RECORDS
 20238           GO TO 4610-BUMP-SEQ.
 20239
 20240     IF PB-ISSUE
 20241        IF ISSUE-WITH-WARNING
 20242           IF PB-WARNING-ERRORS
 20243              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20244                  GO TO 4610-BUMP-SEQ
 20245              ELSE
 20246                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20247                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20248                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20249                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20250                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20251                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20252                 GO TO 7000-DISPLAY-ISSUES
 20253           ELSE
 20254              GO TO 4610-BUMP-SEQ.
 20255
 20256     IF PB-ISSUE
 20257        IF (ISSUES-IN-ERROR AND
 20258            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20259            ALL-ISSUES
 20260            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20261            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20262            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20263            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20264            MOVE PB-SV-STATE            TO PI-SV-STATE
 20265            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20266            GO TO 7000-DISPLAY-ISSUES
 20267        ELSE
 20268            GO TO 4610-BUMP-SEQ.
 20269
 20270     IF PB-CANCELLATION
 20271        IF DISPLAY-CHK-REQ-RECORDS
 20272           IF PB-C-REFUND-REQUESTED
 20273              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20274              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20275              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20276              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20277              MOVE PB-SV-STATE            TO PI-SV-STATE
 20278              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20279              GO TO 7100-DISPLAY-CANCELS
 20280           ELSE
 20281              GO TO 4610-BUMP-SEQ.
 20282
 20283     IF PB-CANCELLATION
 20284        IF CANCEL-WITH-WARNING
 20285           IF PB-WARNING-ERRORS
 20286              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20287                  GO TO 4610-BUMP-SEQ
 20288              ELSE
 20289                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20290                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20291                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20292                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20293                 MOVE PB-SV-STATE            TO PI-SV-STATE
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 372
* EL6311.cbl
 20294                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20295                 GO TO 7100-DISPLAY-CANCELS
 20296           ELSE
 20297              GO TO 4610-BUMP-SEQ.
 20298
 20299     IF PB-CANCELLATION
 20300        IF (CANCEL-IN-ERROR  AND
 20301            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20302            ALL-CANCELS
 20303            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20304            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20305            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20306            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20307            MOVE PB-SV-STATE            TO PI-SV-STATE
 20308            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20309            GO TO 7100-DISPLAY-CANCELS.
 20310
 20311 4610-BUMP-SEQ.
 20312     IF ERPNDB-BATCH-SEQ-NO = ZEROS
 20313        GO TO 4650-END-BATCH.
 20314
 20315     IF DISPLAY-CHANGE-RECORDS
 20316        IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20317           SUBTRACT +1           FROM ERPNDB-BATCH-CHG-SEQ-NO
 20318        ELSE
 20319           MOVE +999             TO   ERPNDB-BATCH-CHG-SEQ-NO
 20320           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO
 20321        ELSE
 20322           MOVE ZEROS            TO   ERPNDB-BATCH-CHG-SEQ-NO
 20323           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO.
 20324
 20325        GO TO 4605-READ-NEXT.
 20326
 20327 4650-END-BATCH.
 20328     IF PI-MAP-NAME = EL631B
 20329        MOVE -1                  TO BMAINTL
 20330     ELSE
 20331        IF PI-MAP-NAME = EL631C
 20332           MOVE -1               TO CMAINTL
 20333        ELSE
 20334           MOVE -1               TO DPFENTRL.
 20335
 20336     MOVE ER-2252               TO EMI-ERROR.
 20337     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20338     GO TO 8200-SEND-DATAONLY.
 20339
 20340 4680-NOT-FOUND.
 20341     IF DISPLAY-CHANGE-RECORDS
 20342        IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20343           MOVE ZEROS            TO   ERPNDB-BATCH-CHG-SEQ-NO
 20344        ELSE
 20345           MOVE +999             TO   ERPNDB-BATCH-CHG-SEQ-NO
 20346           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO
 20347     ELSE
 20348        SUBTRACT +1              FROM ERPNDB-BATCH-SEQ-NO.
 20349
 20350     GO TO 4605-READ-NEXT.
 20351
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 373
* EL6311.cbl
 20353
 20354******************************************************************
 20355*                                                                *
 20356*        B R O W S E   F I L E   B A C K W A R D S               *
 20357*                                                                *
 20358******************************************************************
 20359
 20360 4800-BROWSE-FILE-BACKWARD.
 20361
 20362* EXEC CICS HANDLE CONDITION
 20363*         NOTFND   (4860-NOT-FOUND)
 20364*         ENDFILE  (4850-END-RECORDS)
 20365*    END-EXEC.
 20366*    MOVE '"$I''                  ! K #00017499' TO DFHEIV0
 20367     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20368     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20369     MOVE X'4B20233030303137343939' TO DFHEIV0(25:11)
 20370     CALL 'kxdfhei1' USING DFHEIV0
 20371     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20372
 20373
 20374     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 20375
 20376     IF PI-DISPLAY-ORIGINAL-BATCH
 20377        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 20378     ELSE
 20379        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 20380
 20381
 20382* EXEC CICS STARTBR
 20383*         DATASET   (FILE-ID)
 20384*         RIDFLD    (ERPNDB-KEY)
 20385*    END-EXEC.
 20386     MOVE 0
 20387       TO DFHEIV11
 20388*    MOVE '&,         G          &   #00017511' TO DFHEIV0
 20389     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20390     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20391     MOVE X'2020233030303137353131' TO DFHEIV0(25:11)
 20392     CALL 'kxdfhei1' USING DFHEIV0,
 20393           FILE-ID,
 20394           ERPNDB-KEY,
 20395           DFHEIV99,
 20396           DFHEIV11,
 20397           DFHEIV99
 20398     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20399
 20400
 20401     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 20402
 20403
 20404* EXEC CICS READPREV
 20405*         DATASET    (FILE-ID-ERPNDB)
 20406*         SET        (ADDRESS OF PENDING-BUSINESS)
 20407*         RIDFLD     (ERPNDB-KEY)
 20408*    END-EXEC.
 20409     MOVE 0
 20410       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 374
* EL6311.cbl
 20411*    MOVE '&0S                   )   #00017518' TO DFHEIV0
 20412     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20413     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20414     MOVE X'2020233030303137353138' TO DFHEIV0(25:11)
 20415     CALL 'kxdfhei1' USING DFHEIV0,
 20416           FILE-ID-ERPNDB,
 20417           DFHEIV20,
 20418           DFHEIV99,
 20419           ERPNDB-KEY,
 20420           DFHEIV99,
 20421           DFHEIV11,
 20422           DFHEIV99,
 20423           DFHEIV99
 20424     SET ADDRESS OF PENDING-BUSINESS TO
 20425         DFHEIV20
 20426     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20427
 20428
 20429 4810-READ-PREV-RECORD.
 20430
 20431* EXEC CICS READPREV
 20432*         DATASET    (FILE-ID-ERPNDB)
 20433*         SET        (ADDRESS OF PENDING-BUSINESS)
 20434*         RIDFLD     (ERPNDB-KEY)
 20435*    END-EXEC.
 20436     MOVE 0
 20437       TO DFHEIV11
 20438*    MOVE '&0S                   )   #00017525' TO DFHEIV0
 20439     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20440     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20441     MOVE X'2020233030303137353235' TO DFHEIV0(25:11)
 20442     CALL 'kxdfhei1' USING DFHEIV0,
 20443           FILE-ID-ERPNDB,
 20444           DFHEIV20,
 20445           DFHEIV99,
 20446           ERPNDB-KEY,
 20447           DFHEIV99,
 20448           DFHEIV11,
 20449           DFHEIV99,
 20450           DFHEIV99
 20451     SET ADDRESS OF PENDING-BUSINESS TO
 20452         DFHEIV20
 20453     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20454
 20455
 20456     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD
 20457        GO TO 4850-END-RECORDS.
 20458
 20459     IF PB-BATCH-TRAILER
 20460        GO TO 4810-READ-PREV-RECORD.
 20461
 20462     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20463
 20464     IF  WS-BATCH-PREFIX = '#CL'
 20465         GO TO 4810-READ-PREV-RECORD.
 20466
 20467     IF PI-PB-CERT-NO NOT = LOW-VALUES
 20468        IF PI-PB-CERT-NO NOT = PB-CERT-NO
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 375
* EL6311.cbl
 20469           GO TO 4810-READ-PREV-RECORD
 20470        ELSE
 20471           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 20472              GO TO 4820-CHECK-REC-TYPE
 20473           ELSE
 20474              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 20475                 GO TO 4820-CHECK-REC-TYPE
 20476              ELSE
 20477                 GO TO 4810-READ-PREV-RECORD.
 20478
 20479     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 20480        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 20481           GO TO 4810-READ-PREV-RECORD.
 20482
 20483 4820-CHECK-REC-TYPE.
 20484     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20485         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20486             NEXT SENTENCE
 20487         ELSE
 20488             GO TO 4810-READ-PREV-RECORD.
 20489
 20490     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20491         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20492             NEXT SENTENCE
 20493        ELSE
 20494             GO TO 4810-READ-PREV-RECORD.
 20495
 20496     IF NOT DISPLAY-CHANGE-RECORDS AND
 20497            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20498        GO TO 4810-READ-PREV-RECORD.
 20499
 20500     IF DISPLAY-HOLD-RECORDS AND
 20501        NOT PB-RECORD-ON-HOLD
 20502          GO TO 4810-READ-PREV-RECORD.
 20503
 20504     IF PB-ISSUE
 20505        IF DISPLAY-CHK-REQ-RECORDS
 20506           GO TO 4810-READ-PREV-RECORD.
 20507
 20508     IF PB-ISSUE
 20509        IF ISSUE-WITH-WARNING
 20510           IF PB-WARNING-ERRORS
 20511              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20512                  GO TO 4810-READ-PREV-RECORD
 20513              ELSE
 20514                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20515                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20516                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20517                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20518                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20519                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20520                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20521                 GO TO 7000-DISPLAY-ISSUES
 20522           ELSE
 20523              GO TO 4810-READ-PREV-RECORD.
 20524
 20525     IF PB-ISSUE
 20526        IF (ISSUES-IN-ERROR AND
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 376
* EL6311.cbl
 20527            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20528            ALL-ISSUES
 20529            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20530            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20531            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20532            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20533            MOVE PB-SV-STATE            TO PI-SV-STATE
 20534            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20535            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20536            GO TO 7000-DISPLAY-ISSUES
 20537        ELSE
 20538            GO TO 4810-READ-PREV-RECORD.
 20539
 20540     IF PB-CANCELLATION
 20541        IF DISPLAY-CHK-REQ-RECORDS
 20542           IF PB-C-REFUND-REQUESTED
 20543              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20544              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20545              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20546              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20547              MOVE PB-SV-STATE            TO PI-SV-STATE
 20548              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20549              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20550              GO TO 7100-DISPLAY-CANCELS
 20551           ELSE
 20552              GO TO 4810-READ-PREV-RECORD.
 20553
 20554     IF PB-CANCELLATION
 20555        IF CANCEL-WITH-WARNING
 20556           IF PB-WARNING-ERRORS
 20557              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20558                  GO TO 4810-READ-PREV-RECORD
 20559              ELSE
 20560                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20561                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20562                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20563                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20564                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20565                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20566                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20567                 GO TO 7100-DISPLAY-CANCELS
 20568           ELSE
 20569              GO TO 4810-READ-PREV-RECORD.
 20570
 20571     IF PB-CANCELLATION
 20572        IF (CANCEL-IN-ERROR  AND
 20573            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20574            ALL-CANCELS
 20575            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20576            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20577            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20578            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20579            MOVE PB-SV-STATE            TO PI-SV-STATE
 20580            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20581            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20582            GO TO 7100-DISPLAY-CANCELS.
 20583
 20584     GO TO 4810-READ-PREV-RECORD.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 377
* EL6311.cbl
 20585
 20586 4850-END-RECORDS.
 20587     MOVE ER-2252                TO EMI-ERROR.
 20588     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20589
 20590     IF PI-MAP-NAME = EL631B
 20591        MOVE -1                  TO BPFENTRL
 20592     ELSE
 20593        MOVE -1                  TO CPFENTRL.
 20594
 20595     GO TO 8200-SEND-DATAONLY.
 20596
 20597 4860-NOT-FOUND.
 20598
 20599******************************************************************
 20600*       CONDITION MAY OCCUR IF PREV RECORD HAS BEEN DELETED.     *
 20601******************************************************************
 20602
 20603
 20604* EXEC CICS RESETBR
 20605*         DATASET    (FILE-ID-ERPNDB)
 20606*         RIDFLD     (ERPNDB-KEY)
 20607*     END-EXEC.
 20608     MOVE 0
 20609       TO DFHEIV11
 20610*    MOVE '&4         G          &   #00017678' TO DFHEIV0
 20611     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 20612     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20613     MOVE X'2020233030303137363738' TO DFHEIV0(25:11)
 20614     CALL 'kxdfhei1' USING DFHEIV0,
 20615           FILE-ID-ERPNDB,
 20616           ERPNDB-KEY,
 20617           DFHEIV99,
 20618           DFHEIV11,
 20619           DFHEIV99
 20620     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20621
 20622
 20623
 20624* EXEC CICS READNEXT
 20625*         DATASET    (FILE-ID-ERPNDB)
 20626*         SET        (ADDRESS OF PENDING-BUSINESS)
 20627*         RIDFLD     (ERPNDB-KEY)
 20628*    END-EXEC.
 20629     MOVE 0
 20630       TO DFHEIV11
 20631*    MOVE '&.S                   )   #00017683' TO DFHEIV0
 20632     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 20633     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20634     MOVE X'2020233030303137363833' TO DFHEIV0(25:11)
 20635     CALL 'kxdfhei1' USING DFHEIV0,
 20636           FILE-ID-ERPNDB,
 20637           DFHEIV20,
 20638           DFHEIV99,
 20639           ERPNDB-KEY,
 20640           DFHEIV99,
 20641           DFHEIV11,
 20642           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 378
* EL6311.cbl
 20643           DFHEIV99
 20644     SET ADDRESS OF PENDING-BUSINESS TO
 20645         DFHEIV20
 20646     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20647
 20648
 20649
 20650* EXEC CICS READPREV
 20651*         DATASET    (FILE-ID-ERPNDB)
 20652*         SET        (ADDRESS OF PENDING-BUSINESS)
 20653*         RIDFLD     (ERPNDB-KEY)
 20654*    END-EXEC.
 20655     MOVE 0
 20656       TO DFHEIV11
 20657*    MOVE '&0S                   )   #00017689' TO DFHEIV0
 20658     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20659     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20660     MOVE X'2020233030303137363839' TO DFHEIV0(25:11)
 20661     CALL 'kxdfhei1' USING DFHEIV0,
 20662           FILE-ID-ERPNDB,
 20663           DFHEIV20,
 20664           DFHEIV99,
 20665           ERPNDB-KEY,
 20666           DFHEIV99,
 20667           DFHEIV11,
 20668           DFHEIV99,
 20669           DFHEIV99
 20670     SET ADDRESS OF PENDING-BUSINESS TO
 20671         DFHEIV20
 20672     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20673
 20674
 20675     GO TO 4810-READ-PREV-RECORD.
 20676
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 379
* EL6311.cbl
 20678
 20679******************************************************************
 20680*                                                                *
 20681*           B R O W S E   C S R   B A C K W A R D                *
 20682*                                                                *
 20683******************************************************************
 20684
 20685 4900-BROWSE-CSR-BACKWARD.
 20686
 20687     MOVE PI-PREV-CSR-KEY        TO ERPNDB-CSR-KEY.
 20688
 20689
 20690* EXEC CICS HANDLE CONDITION
 20691*         NOTFND   (4970-NOT-FOUND)
 20692*         ENDFILE  (4950-END-RECORDS)
 20693*    END-EXEC
 20694*    MOVE '"$I''                  ! L #00017709' TO DFHEIV0
 20695     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20696     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20697     MOVE X'4C20233030303137373039' TO DFHEIV0(25:11)
 20698     CALL 'kxdfhei1' USING DFHEIV0
 20699     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20700
 20701
 20702* EXEC CICS STARTBR
 20703*         DATASET   (FILE-ID-ERPNDB4)
 20704*         RIDFLD    (ERPNDB-CSR-KEY)
 20705*    END-EXEC.
 20706     MOVE 0
 20707       TO DFHEIV11
 20708*    MOVE '&,         G          &   #00017714' TO DFHEIV0
 20709     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20710     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20711     MOVE X'2020233030303137373134' TO DFHEIV0(25:11)
 20712     CALL 'kxdfhei1' USING DFHEIV0,
 20713           FILE-ID-ERPNDB4,
 20714           ERPNDB-CSR-KEY,
 20715           DFHEIV99,
 20716           DFHEIV11,
 20717           DFHEIV99
 20718     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20719
 20720
 20721     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW
 20722                                    WS-FIRST-TIME-SW.
 20723
 20724 4905-READ-PREV-RECORD.
 20725
 20726* EXEC CICS READPREV
 20727*         DATASET    (FILE-ID-ERPNDB4)
 20728*         SET        (ADDRESS OF PENDING-BUSINESS)
 20729*         RIDFLD     (ERPNDB-CSR-KEY)
 20730*    END-EXEC.
 20731     MOVE 0
 20732       TO DFHEIV11
 20733*    MOVE '&0S                   )   #00017723' TO DFHEIV0
 20734     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20735     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 380
* EL6311.cbl
 20736     MOVE X'2020233030303137373233' TO DFHEIV0(25:11)
 20737     CALL 'kxdfhei1' USING DFHEIV0,
 20738           FILE-ID-ERPNDB4,
 20739           DFHEIV20,
 20740           DFHEIV99,
 20741           ERPNDB-CSR-KEY,
 20742           DFHEIV99,
 20743           DFHEIV11,
 20744           DFHEIV99,
 20745           DFHEIV99
 20746     SET ADDRESS OF PENDING-BUSINESS TO
 20747         DFHEIV20
 20748     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20749
 20750
 20751     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20752
 20753     IF WS-BATCH-PREFIX = '#CL'
 20754         GO TO 4905-READ-PREV-RECORD.
 20755
 20756     IF FIRST-TIME
 20757         MOVE SPACE               TO WS-FIRST-TIME-SW
 20758         GO TO 4905-READ-PREV-RECORD.
 20759
 20760     IF PB-CSR-COMPANY-CD   NOT = PI-COMPANY-CD OR
 20761        PB-CSR-ID           NOT = PI-PB-CSR-ID
 20762        GO TO 4950-END-RECORDS.
 20763
 20764     IF PB-BATCH-TRAILER
 20765        GO TO 4905-READ-PREV-RECORD.
 20766
 20767     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20768
 20769     IF  WS-BATCH-PREFIX = '#CL'
 20770         GO TO 4905-READ-PREV-RECORD.
 20771
 20772     IF PI-PB-CERT-NO NOT = LOW-VALUES
 20773        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 20774           GO TO 4905-READ-PREV-RECORD
 20775        ELSE
 20776           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 20777              GO TO 4910-CHECK-REC-TYPE
 20778           ELSE
 20779              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 20780                 GO TO 4910-CHECK-REC-TYPE
 20781              ELSE
 20782                 GO TO 4905-READ-PREV-RECORD.
 20783
 20784     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 20785        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 20786           GO TO 4905-READ-PREV-RECORD.
 20787
 20788 4910-CHECK-REC-TYPE.
 20789     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20790         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20791             NEXT SENTENCE
 20792         ELSE
 20793             GO TO 4905-READ-PREV-RECORD.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 381
* EL6311.cbl
 20794
 20795     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20796         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20797             NEXT SENTENCE
 20798        ELSE
 20799             GO TO 4905-READ-PREV-RECORD.
 20800
 20801     IF NOT DISPLAY-CHANGE-RECORDS AND
 20802            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20803        GO TO 4905-READ-PREV-RECORD.
 20804
 20805     IF DISPLAY-HOLD-RECORDS AND
 20806        NOT PB-RECORD-ON-HOLD
 20807          GO TO 4905-READ-PREV-RECORD.
 20808
 20809     IF PB-ISSUE
 20810        IF DISPLAY-CHK-REQ-RECORDS
 20811           GO TO 4905-READ-PREV-RECORD.
 20812
 20813     IF PB-ISSUE
 20814        IF ISSUE-WITH-WARNING
 20815           IF PB-WARNING-ERRORS
 20816              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20817                  GO TO 4505-READ-PREV-RECORD
 20818              ELSE
 20819                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20820                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20821                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20822                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20823                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20824                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20825                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20826                 GO TO 7000-DISPLAY-ISSUES
 20827           ELSE
 20828              GO TO 4905-READ-PREV-RECORD.
 20829
 20830     IF PB-ISSUE
 20831        IF (ISSUES-IN-ERROR AND
 20832            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20833            ALL-ISSUES
 20834            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20835            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20836            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20837            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20838            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20839            MOVE PB-SV-STATE            TO PI-SV-STATE
 20840            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20841            GO TO 7000-DISPLAY-ISSUES
 20842        ELSE
 20843            GO TO 4905-READ-PREV-RECORD.
 20844
 20845     IF PB-CANCELLATION
 20846        IF DISPLAY-CHK-REQ-RECORDS
 20847           IF PB-C-REFUND-REQUESTED
 20848              MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20849              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20850              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20851              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 382
* EL6311.cbl
 20852              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20853              MOVE PB-SV-STATE            TO PI-SV-STATE
 20854              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20855              GO TO 7100-DISPLAY-CANCELS
 20856           ELSE
 20857              GO TO 4905-READ-PREV-RECORD.
 20858
 20859     IF PB-CANCELLATION
 20860        IF CANCEL-WITH-WARNING
 20861           IF PB-WARNING-ERRORS
 20862              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20863                  GO TO 4505-READ-PREV-RECORD
 20864              ELSE
 20865                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20866                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20867                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20868                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20869                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20870                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20871                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20872                 GO TO 7100-DISPLAY-CANCELS
 20873           ELSE
 20874              GO TO 4905-READ-PREV-RECORD.
 20875
 20876     IF PB-CANCELLATION
 20877        IF (CANCEL-IN-ERROR  AND
 20878            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20879            ALL-CANCELS
 20880            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20881            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20882            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20883            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20884            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20885            MOVE PB-SV-STATE            TO PI-SV-STATE
 20886            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20887            GO TO 7100-DISPLAY-CANCELS.
 20888
 20889     GO TO 4905-READ-PREV-RECORD.
 20890
 20891 4950-END-RECORDS.
 20892     IF PI-MAP-NAME = EL631B
 20893        MOVE -1                  TO BMAINTL
 20894     ELSE
 20895        IF PI-MAP-NAME = EL631C
 20896           MOVE -1               TO CMAINTL
 20897        ELSE
 20898           MOVE -1               TO DPFENTRL.
 20899
 20900     MOVE ER-2255               TO EMI-ERROR.
 20901     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20902     GO TO 8200-SEND-DATAONLY.
 20903
 20904 4970-NOT-FOUND.
 20905
 20906******************************************************************
 20907*      CONDITION MAY OCCUR IF PREV. RECORD HAS BEEN DELETED.     *
 20908******************************************************************
 20909
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 383
* EL6311.cbl
 20910
 20911* EXEC CICS RESETBR
 20912*         DATASET    (FILE-ID-ERPNDB4)
 20913*         RIDFLD     (ERPNDB-CSR-KEY)
 20914*    END-EXEC.
 20915     MOVE 0
 20916       TO DFHEIV11
 20917*    MOVE '&4         G          &   #00017888' TO DFHEIV0
 20918     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 20919     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20920     MOVE X'2020233030303137383838' TO DFHEIV0(25:11)
 20921     CALL 'kxdfhei1' USING DFHEIV0,
 20922           FILE-ID-ERPNDB4,
 20923           ERPNDB-CSR-KEY,
 20924           DFHEIV99,
 20925           DFHEIV11,
 20926           DFHEIV99
 20927     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20928
 20929
 20930
 20931* EXEC CICS READNEXT
 20932*         DATASET    (FILE-ID-ERPNDB4)
 20933*         SET        (ADDRESS OF PENDING-BUSINESS)
 20934*         RIDFLD     (ERPNDB-CSR-KEY)
 20935*    END-EXEC.
 20936     MOVE 0
 20937       TO DFHEIV11
 20938*    MOVE '&.S                   )   #00017893' TO DFHEIV0
 20939     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 20940     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20941     MOVE X'2020233030303137383933' TO DFHEIV0(25:11)
 20942     CALL 'kxdfhei1' USING DFHEIV0,
 20943           FILE-ID-ERPNDB4,
 20944           DFHEIV20,
 20945           DFHEIV99,
 20946           ERPNDB-CSR-KEY,
 20947           DFHEIV99,
 20948           DFHEIV11,
 20949           DFHEIV99,
 20950           DFHEIV99
 20951     SET ADDRESS OF PENDING-BUSINESS TO
 20952         DFHEIV20
 20953     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20954
 20955
 20956
 20957* EXEC CICS READPREV
 20958*         DATASET    (FILE-ID-ERPNDB4)
 20959*         SET        (ADDRESS OF PENDING-BUSINESS)
 20960*         RIDFLD     (ERPNDB-CSR-KEY)
 20961*    END-EXEC.
 20962     MOVE 0
 20963       TO DFHEIV11
 20964*    MOVE '&0S                   )   #00017899' TO DFHEIV0
 20965     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20966     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20967     MOVE X'2020233030303137383939' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 384
* EL6311.cbl
 20968     CALL 'kxdfhei1' USING DFHEIV0,
 20969           FILE-ID-ERPNDB4,
 20970           DFHEIV20,
 20971           DFHEIV99,
 20972           ERPNDB-CSR-KEY,
 20973           DFHEIV99,
 20974           DFHEIV11,
 20975           DFHEIV99,
 20976           DFHEIV99
 20977     SET ADDRESS OF PENDING-BUSINESS TO
 20978         DFHEIV20
 20979     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20980
 20981
 20982 4980-READ-PREV-RECORD.
 20983
 20984* EXEC CICS READPREV
 20985*         DATASET    (FILE-ID-ERPNDB4)
 20986*         SET        (ADDRESS OF PENDING-BUSINESS)
 20987*         RIDFLD     (ERPNDB-CSR-KEY)
 20988*    END-EXEC.
 20989     MOVE 0
 20990       TO DFHEIV11
 20991*    MOVE '&0S                   )   #00017906' TO DFHEIV0
 20992     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20993     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20994     MOVE X'2020233030303137393036' TO DFHEIV0(25:11)
 20995     CALL 'kxdfhei1' USING DFHEIV0,
 20996           FILE-ID-ERPNDB4,
 20997           DFHEIV20,
 20998           DFHEIV99,
 20999           ERPNDB-CSR-KEY,
 21000           DFHEIV99,
 21001           DFHEIV11,
 21002           DFHEIV99,
 21003           DFHEIV99
 21004     SET ADDRESS OF PENDING-BUSINESS TO
 21005         DFHEIV20
 21006     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21007
 21008
 21009     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 21010
 21011     IF WS-BATCH-PREFIX = '#CL'
 21012        GO TO 4980-READ-PREV-RECORD.
 21013
 21014     MOVE SPACE                  TO WS-FIRST-TIME-SW.
 21015     GO TO 4905-READ-PREV-RECORD.
 21016
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 385
* EL6311.cbl
 21018
 21019
 21020******************************************************************
 21021*                                                                *
 21022*        B R O W S E   B A T C H   H E A D E R S                 *
 21023*                                                                *
 21024******************************************************************
 21025
 21026 5000-BROWSE-BATCH-HEADERS.
 21027
 21028     IF EIBTRNID NOT = TRANS-EXB1
 21029        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY
 21030        MOVE +9999               TO ERPNDB-BATCH-SEQ-NO
 21031        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 21032        GO TO 5010-READ-NEXT-RECORD.
 21033
 21034     IF EIBAID = DFHPF4
 21035        MOVE '0'                TO PI-EDIT-SW
 21036        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 21037        MOVE +9999               TO ERPNDB-BATCH-SEQ-NO
 21038        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 21039        GO TO 5010-READ-NEXT-RECORD.
 21040
 21041     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 21042     MOVE HIGH-VALUES            TO ERPNDB-BATCH-SEQ-ALPHA.
 21043     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 21044
 21045
 21046* EXEC CICS HANDLE CONDITION
 21047*         ENDFILE  (5050-NOT-FOUND)
 21048*    END-EXEC.
 21049*    MOVE '"$''                   ! M #00017948' TO DFHEIV0
 21050     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 21051     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21052     MOVE X'4D20233030303137393438' TO DFHEIV0(25:11)
 21053     CALL 'kxdfhei1' USING DFHEIV0
 21054     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21055
 21056
 21057 5010-READ-NEXT-RECORD.
 21058
 21059* EXEC CICS HANDLE CONDITION
 21060*         NOTFND    (5050-NOT-FOUND)
 21061*    END-EXEC.
 21062*    MOVE '"$I                   ! N #00017953' TO DFHEIV0
 21063     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21064     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21065     MOVE X'4E20233030303137393533' TO DFHEIV0(25:11)
 21066     CALL 'kxdfhei1' USING DFHEIV0
 21067     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21068
 21069
 21070
 21071* EXEC CICS READ
 21072*         DATASET   (FILE-ID-ERPNDB)
 21073*         SET       (ADDRESS OF PENDING-BUSINESS)
 21074*         RIDFLD    (ERPNDB-KEY)
 21075*         GTEQ
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 386
* EL6311.cbl
 21076*    END-EXEC.
 21077*    MOVE '&"S        G          (   #00017957' TO DFHEIV0
 21078     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 21079     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21080     MOVE X'2020233030303137393537' TO DFHEIV0(25:11)
 21081     CALL 'kxdfhei1' USING DFHEIV0,
 21082           FILE-ID-ERPNDB,
 21083           DFHEIV20,
 21084           DFHEIV99,
 21085           ERPNDB-KEY,
 21086           DFHEIV99,
 21087           DFHEIV99,
 21088           DFHEIV99
 21089     SET ADDRESS OF PENDING-BUSINESS TO
 21090         DFHEIV20
 21091     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21092
 21093
 21094     IF PB-COMPANY-CD NOT = PI-COMPANY-CD
 21095         GO TO 5050-NOT-FOUND.
 21096
 21097     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 21098
 21099     IF WS-BATCH-PREFIX = '#CL'
 21100         MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 21101         MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
 21102         GO TO 5010-READ-NEXT-RECORD.
 21103
 21104     IF NOT PB-BATCH-TRAILER
 21105         MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 21106         MOVE +9999            TO ERPNDB-BATCH-SEQ-NO
 21107         GO TO 5010-READ-NEXT-RECORD.
 21108
 21109     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 21110         IF  PB-CARRIER = PI-CARRIER-SECURITY
 21111             NEXT SENTENCE
 21112         ELSE
 21113             MOVE PB-ENTRY-BATCH     TO ERPNDB-ENTRY-BATCH
 21114             MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 21115             MOVE ZEROS              TO ERPNDB-BATCH-CHG-SEQ-NO
 21116             GO TO 5010-READ-NEXT-RECORD.
 21117
 21118     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 21119         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 21120             NEXT SENTENCE
 21121        ELSE
 21122             MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 21123             MOVE ZEROS              TO ERPNDB-BATCH-CHG-SEQ-NO
 21124             GO TO 5010-READ-NEXT-RECORD.
 21125
 21126     IF EIBAID = DFHPF4
 21127        MOVE '0'                TO PI-EDIT-SW
 21128        GO TO 7200-DISPLAY-BATCHES.
 21129
 21130     IF PI-CSR-BROWSE
 21131        IF PB-CSR-ID           NOT = PI-PB-CSR-ID
 21132           MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 21133           MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 387
* EL6311.cbl
 21134           GO TO 5010-READ-NEXT-RECORD.
 21135
 21136     IF ONLY-BATCH-HEADERS OR PB-OUT-OF-BAL
 21137       IF PI-PB-CARRIER    = SPACES AND
 21138          PI-PB-GROUPING   = SPACES AND
 21139          PI-PB-STATE      = SPACES AND
 21140          PI-PB-ACCOUNT    = SPACES
 21141            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 21142            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 21143            GO TO 7200-DISPLAY-BATCHES
 21144         ELSE
 21145           IF PI-PB-CARRIER    = PB-CARRIER  AND
 21146              PI-PB-GROUPING   = PB-GROUPING AND
 21147              PI-PB-STATE      = PB-STATE    AND
 21148              PI-PB-ACCOUNT    = PB-ACCOUNT
 21149              MOVE PB-CONTROL-PRIMARY  TO PI-PREV-KEY
 21150              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 21151              GO TO 7200-DISPLAY-BATCHES.
 21152
 21153     MOVE PB-CONTROL-PRIMARY        TO ERPNDB-KEY.
 21154     MOVE HIGH-VALUE                TO ERPNDB-BATCH-SEQ-ALPHA.
 21155
 21156
 21157* EXEC CICS HANDLE CONDITION
 21158*         NOTFND    (5050-NOT-FOUND)
 21159*    END-EXEC.
 21160*    MOVE '"$I                   ! O #00018026' TO DFHEIV0
 21161     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21162     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21163     MOVE X'4F20233030303138303236' TO DFHEIV0(25:11)
 21164     CALL 'kxdfhei1' USING DFHEIV0
 21165     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21166
 21167
 21168
 21169* EXEC CICS READ
 21170*         DATASET   (FILE-ID-ERPNDB)
 21171*         SET       (ADDRESS OF PENDING-BUSINESS)
 21172*         RIDFLD    (ERPNDB-KEY)
 21173*         GTEQ
 21174*    END-EXEC.
 21175*    MOVE '&"S        G          (   #00018030' TO DFHEIV0
 21176     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 21177     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21178     MOVE X'2020233030303138303330' TO DFHEIV0(25:11)
 21179     CALL 'kxdfhei1' USING DFHEIV0,
 21180           FILE-ID-ERPNDB,
 21181           DFHEIV20,
 21182           DFHEIV99,
 21183           ERPNDB-KEY,
 21184           DFHEIV99,
 21185           DFHEIV99,
 21186           DFHEIV99
 21187     SET ADDRESS OF PENDING-BUSINESS TO
 21188         DFHEIV20
 21189     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21190
 21191
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 388
* EL6311.cbl
 21192     GO TO 5010-READ-NEXT-RECORD.
 21193
 21194 5050-NOT-FOUND.
 21195
 21196******************************************************************
 21197*                                                                *
 21198*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 21199*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING     *
 21200*         PROGRAM.                                               *
 21201*                                                                *
 21202******************************************************************
 21203
 21204     IF EIBTRNID NOT = TRANS-EXB1
 21205        IF PENDING-BUS-RECS-FOUND
 21206            NEXT SENTENCE
 21207          ELSE
 21208            MOVE '9'            TO PI-BROWSE-SW
 21209            GO TO 9400-CLEAR.
 21210
 21211     MOVE ER-2256                TO EMI-ERROR.
 21212     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21213
 21214     IF PI-MAP-NAME = SPACES
 21215        MOVE EL631D              TO PI-MAP-NAME
 21216        MOVE -1                  TO DPFENTRL
 21217        GO TO 8100-SEND-INITIAL-MAP.
 21218
 21219     IF PI-MAP-NAME = EL631B
 21220        MOVE -1                  TO BMAINTL
 21221     ELSE
 21222        IF PI-MAP-NAME = EL631C
 21223           MOVE -1               TO CMAINTL
 21224        ELSE
 21225           MOVE -1               TO DPFENTRL
 21226           GO TO 8200-SEND-DATAONLY.
 21227
 21228     GO TO 8100-SEND-INITIAL-MAP.
 21229
 21230     .
 21231 5100-PROCESS-POL-RESC.
 21232     MOVE ZEROS                  TO CG-LF-BENCD
 21233                                    CG-AH-BENCD
 21234                                    CG-LF-CAN-AMT
 21235                                    CG-AH-CAN-AMT
 21236     MOVE LOW-VALUES             TO CG-LF-CAN-DT
 21237                                    CG-AH-CAN-DT
 21238     MOVE SPACES                 TO CG-BATCH-NO
 21239     MOVE '4'                    TO CG-OPTION-CODE
 21240     MOVE PI-COMPANY-ID          TO CG-COMPANY-ID
 21241     MOVE PI-PROCESSOR-ID        TO CG-PROC-ID
 21242     MOVE PI-CR-MONTH-END-DT     TO CG-MONTH-END-DT
 21243     MOVE PI-COMPANY-CD          TO CG-CERT-COMPANY-CD
 21244     MOVE PI-SV-CARRIER          TO CG-CERT-CARRIER
 21245     MOVE PI-SV-GROUPING         TO CG-CERT-GROUP
 21246     MOVE PI-SV-STATE            TO CG-CERT-STATE
 21247     MOVE PI-PB-ACCOUNT          TO CG-CERT-ACCOUNT
 21248     MOVE PI-PB-CERT-EFF-DT      TO CG-CERT-EFF-DT
 21249     MOVE PI-PB-CERT-NO          TO CG-CERT-CERT-NO
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 389
* EL6311.cbl
 21250     MOVE PI-PREV-ALT-KEY (1:33)
 21251                                 TO CG-CERT-KEY
 21252     MOVE WS-CURRENT-BIN-DT      TO CG-CURRENT-DT
 21253     MOVE ZEROS                  TO CG-LF-CAN-AMT
 21254                                    CG-AH-CAN-AMT
 21255     MOVE LOW-VALUES             TO CG-LF-CAN-DT
 21256                                    CG-AH-CAN-DT
 21257     MOVE PI-PREV-BATCH          TO CG-BATCH-NO
 21258     MOVE ZERO                   TO CG-BATCH-SEQ-NO
 21259      display 'about to cancel ' cg-cert-key
 21260
 21261* EXEC CICS LINK
 21262*        PROGRAM  ('ELCANC')
 21263*        COMMAREA (CANCEL-GEN-PASS-AREA)
 21264*    END-EXEC
 21265     MOVE LENGTH OF
 21266      CANCEL-GEN-PASS-AREA
 21267       TO DFHEIV11
 21268     MOVE 'ELCANC' TO DFHEIV1
 21269*    MOVE '."C                   (   #00018105' TO DFHEIV0
 21270     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 21271     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21272     MOVE X'2020233030303138313035' TO DFHEIV0(25:11)
 21273     CALL 'kxdfhei1' USING DFHEIV0,
 21274           DFHEIV1,
 21275           CANCEL-GEN-PASS-AREA,
 21276           DFHEIV11,
 21277           DFHEIV99,
 21278           DFHEIV99,
 21279           DFHEIV99,
 21280           DFHEIV99
 21281     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21282     IF CG-SUCCESS
 21283        CONTINUE
 21284     ELSE
 21285        MOVE SPACES              TO EMI-MESSAGE-AREA (1)
 21286        MOVE '3'                 TO EMI-SWITCH1
 21287        MOVE CG-ERROR-CODE TO EMI-TEXT-VARIABLE (1)
 21288        EVALUATE TRUE
 21289           WHEN CG-DATE-ERROR
 21290             MOVE WS-01-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21291           WHEN CG-CERT-NOT-FOUND
 21292             MOVE WS-02-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21293           WHEN CG-AMOUNT-ERROR
 21294             MOVE WS-04-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21295           WHEN CG-OPTION-ERROR
 21296             MOVE WS-05-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21297           WHEN CG-PREV-CAN
 21298             MOVE WS-06-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21299           WHEN CG-INVALID-DATA
 21300             MOVE WS-07-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21301           WHEN CG-NO-ACCT-MSTR
 21302             MOVE WS-08-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21303           WHEN CG-SFX-A-EXIST
 21304             MOVE WS-09-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21305           WHEN CG-MISC-ERROR
 21306             MOVE WS-99-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21307           WHEN OTHER
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 390
* EL6311.cbl
 21308             MOVE ' ERROR - ELCANC - RETURN '
 21309                                 TO EMI-ERROR-TEXT (1) (12:25)
 21310        END-EVALUATE
 21311        GO TO 8200-SEND-DATAONLY
 21312     END-IF
 21313
 21314* EXEC CICS GETMAIN
 21315*        SET     (ADDRESS OF CERTIFICATE-TRAILERS)
 21316*        LENGTH  (ELCRTT-RECORD-LENGTH)
 21317*        INITIMG (GETMAIN-SPACE)
 21318*    END-EXEC
 21319*    MOVE ',"IL                  $   #00018140' TO DFHEIV0
 21320     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 21321     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21322     MOVE X'2020233030303138313430' TO DFHEIV0(25:11)
 21323     CALL 'kxdfhei1' USING DFHEIV0,
 21324           DFHEIV20,
 21325           ELCRTT-RECORD-LENGTH,
 21326           GETMAIN-SPACE
 21327     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 21328         DFHEIV20
 21329     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21330
 21331     move ' '                    to ws-elcrtt-update-sw
 21332     MOVE PI-PREV-ALT-KEY (1:33) TO ELCRTT-PRIMARY
 21333     MOVE 'C'                    TO ELCRTT-REC-TYPE
 21334
 21335
 21336* EXEC CICS READ
 21337*        UPDATE
 21338*        DATASET  (CRTT-ID)
 21339*        RIDFLD   (ELCRTT-KEY)
 21340*        INTO     (CERTIFICATE-TRAILERS)
 21341*        resp     (ws-response)
 21342*    END-EXEC
 21343     MOVE LENGTH OF
 21344      CERTIFICATE-TRAILERS
 21345       TO DFHEIV11
 21346*    MOVE '&"IL       EU         (  N#00018150' TO DFHEIV0
 21347     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21348     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21349     MOVE X'204E233030303138313530' TO DFHEIV0(25:11)
 21350     CALL 'kxdfhei1' USING DFHEIV0,
 21351           CRTT-ID,
 21352           CERTIFICATE-TRAILERS,
 21353           DFHEIV11,
 21354           ELCRTT-KEY,
 21355           DFHEIV99,
 21356           DFHEIV99,
 21357           DFHEIV99
 21358     MOVE EIBRESP  TO ws-response
 21359     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21360
 21361     if resp-normal
 21362        if cs-claim-verification-status = 'B' or 'C' or 'D' or
 21363                  'E' or 'F' or 'G'
 21364           move 'J'              to cs-claim-verification-status
 21365           set update-elcrtt to true
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 391
* EL6311.cbl
 21366        end-if
 21367        if update-elcrtt
 21368
 21369* EXEC CICS REWRITE
 21370*             DATASET    (crtt-ID)
 21371*             FROM       (CERTIFICATE-TRAILERS)
 21372*          END-EXEC
 21373     MOVE LENGTH OF
 21374      CERTIFICATE-TRAILERS
 21375       TO DFHEIV11
 21376*    MOVE '&& L                  %   #00018165' TO DFHEIV0
 21377     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 21378     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21379     MOVE X'2020233030303138313635' TO DFHEIV0(25:11)
 21380     CALL 'kxdfhei1' USING DFHEIV0,
 21381           crtt-ID,
 21382           CERTIFICATE-TRAILERS,
 21383           DFHEIV11,
 21384           DFHEIV99
 21385     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21386        else
 21387
 21388* exec cics unlock
 21389*             dataset    (crtt-ID)
 21390*          end-exec
 21391*    MOVE '&*                    #   #00018170' TO DFHEIV0
 21392     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 21393     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 21394     MOVE X'2020233030303138313730' TO DFHEIV0(25:11)
 21395     CALL 'kxdfhei1' USING DFHEIV0,
 21396           crtt-ID,
 21397           DFHEIV99
 21398     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21399        end-if
 21400     end-if
 21401     .
 21402 5100-EXIT.
 21403     EXIT.
 21404
 21405******************************************************************
 21406*                                                                *
 21407*        B R O W S E   B A T C H   B A C K W A R D S             *
 21408*                                                                *
 21409******************************************************************
 21410
 21411 5500-BROWSE-BATCH-BACKWARD.
 21412
 21413* EXEC CICS HANDLE CONDITION
 21414*         NOTFND   (5550-END-RECORDS)
 21415*         ENDFILE  (5550-END-RECORDS)
 21416*    END-EXEC.
 21417*    MOVE '"$I''                  ! P #00018186' TO DFHEIV0
 21418     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21419     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21420     MOVE X'5020233030303138313836' TO DFHEIV0(25:11)
 21421     CALL 'kxdfhei1' USING DFHEIV0
 21422     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21423
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 392
* EL6311.cbl
 21424
 21425 5505-START-BROWSE.
 21426     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 21427     MOVE +1                     TO ERPNDB-BATCH-SEQ-NO.
 21428     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 21429
 21430
 21431* EXEC CICS STARTBR
 21432*         DATASET   (FILE-ID-ERPNDB)
 21433*         RIDFLD    (ERPNDB-ALT-KEY)
 21434*    END-EXEC.
 21435     MOVE 0
 21436       TO DFHEIV11
 21437*    MOVE '&,         G          &   #00018196' TO DFHEIV0
 21438     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21439     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21440     MOVE X'2020233030303138313936' TO DFHEIV0(25:11)
 21441     CALL 'kxdfhei1' USING DFHEIV0,
 21442           FILE-ID-ERPNDB,
 21443           ERPNDB-ALT-KEY,
 21444           DFHEIV99,
 21445           DFHEIV11,
 21446           DFHEIV99
 21447     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21448
 21449
 21450     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 21451
 21452
 21453* EXEC CICS READNEXT
 21454*         DATASET    (FILE-ID-ERPNDB)
 21455*         SET        (ADDRESS OF PENDING-BUSINESS)
 21456*         RIDFLD     (ERPNDB-KEY)
 21457*    END-EXEC.
 21458     MOVE 0
 21459       TO DFHEIV11
 21460*    MOVE '&.S                   )   #00018203' TO DFHEIV0
 21461     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 21462     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21463     MOVE X'2020233030303138323033' TO DFHEIV0(25:11)
 21464     CALL 'kxdfhei1' USING DFHEIV0,
 21465           FILE-ID-ERPNDB,
 21466           DFHEIV20,
 21467           DFHEIV99,
 21468           ERPNDB-KEY,
 21469           DFHEIV99,
 21470           DFHEIV11,
 21471           DFHEIV99,
 21472           DFHEIV99
 21473     SET ADDRESS OF PENDING-BUSINESS TO
 21474         DFHEIV20
 21475     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21476
 21477
 21478
 21479* EXEC CICS READPREV
 21480*         DATASET    (FILE-ID-ERPNDB)
 21481*         SET        (ADDRESS OF PENDING-BUSINESS)
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 393
* EL6311.cbl
 21482*         RIDFLD     (ERPNDB-KEY)
 21483*    END-EXEC.
 21484     MOVE 0
 21485       TO DFHEIV11
 21486*    MOVE '&0S                   )   #00018209' TO DFHEIV0
 21487     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 21488     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21489     MOVE X'2020233030303138323039' TO DFHEIV0(25:11)
 21490     CALL 'kxdfhei1' USING DFHEIV0,
 21491           FILE-ID-ERPNDB,
 21492           DFHEIV20,
 21493           DFHEIV99,
 21494           ERPNDB-KEY,
 21495           DFHEIV99,
 21496           DFHEIV11,
 21497           DFHEIV99,
 21498           DFHEIV99
 21499     SET ADDRESS OF PENDING-BUSINESS TO
 21500         DFHEIV20
 21501     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21502
 21503
 21504
 21505* EXEC CICS READPREV
 21506*         DATASET    (FILE-ID-ERPNDB)
 21507*         SET        (ADDRESS OF PENDING-BUSINESS)
 21508*         RIDFLD     (ERPNDB-KEY)
 21509*    END-EXEC.
 21510     MOVE 0
 21511       TO DFHEIV11
 21512*    MOVE '&0S                   )   #00018215' TO DFHEIV0
 21513     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 21514     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21515     MOVE X'2020233030303138323135' TO DFHEIV0(25:11)
 21516     CALL 'kxdfhei1' USING DFHEIV0,
 21517           FILE-ID-ERPNDB,
 21518           DFHEIV20,
 21519           DFHEIV99,
 21520           ERPNDB-KEY,
 21521           DFHEIV99,
 21522           DFHEIV11,
 21523           DFHEIV99,
 21524           DFHEIV99
 21525     SET ADDRESS OF PENDING-BUSINESS TO
 21526         DFHEIV20
 21527     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21528
 21529
 21530     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD
 21531        GO TO 5550-END-RECORDS.
 21532
 21533     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 21534
 21535     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 21536
 21537     IF  WS-BATCH-PREFIX = '#CL'
 21538             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 21539
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 394
* EL6311.cbl
 21540* EXEC CICS ENDBR
 21541*                 DATASET  (FILE-ID-ERPNDB)
 21542*            END-EXEC
 21543     MOVE 0
 21544       TO DFHEIV11
 21545*    MOVE '&2                    $   #00018230' TO DFHEIV0
 21546     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21547     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21548     MOVE X'2020233030303138323330' TO DFHEIV0(25:11)
 21549     CALL 'kxdfhei1' USING DFHEIV0,
 21550           FILE-ID-ERPNDB,
 21551           DFHEIV11,
 21552           DFHEIV99
 21553     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21554         GO TO 5505-START-BROWSE.
 21555
 21556     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 21557         IF  PB-CARRIER = PI-CARRIER-SECURITY
 21558             NEXT SENTENCE
 21559         ELSE
 21560             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 21561
 21562* EXEC CICS ENDBR
 21563*                 DATASET  (FILE-ID-ERPNDB)
 21564*            END-EXEC
 21565     MOVE 0
 21566       TO DFHEIV11
 21567*    MOVE '&2                    $   #00018240' TO DFHEIV0
 21568     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21569     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21570     MOVE X'2020233030303138323430' TO DFHEIV0(25:11)
 21571     CALL 'kxdfhei1' USING DFHEIV0,
 21572           FILE-ID-ERPNDB,
 21573           DFHEIV11,
 21574           DFHEIV99
 21575     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21576             GO TO 5505-START-BROWSE.
 21577
 21578
 21579     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 21580         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 21581             NEXT SENTENCE
 21582        ELSE
 21583             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 21584
 21585* EXEC CICS ENDBR
 21586*                 DATASET  (FILE-ID-ERPNDB)
 21587*            END-EXEC
 21588     MOVE 0
 21589       TO DFHEIV11
 21590*    MOVE '&2                    $   #00018251' TO DFHEIV0
 21591     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21592     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21593     MOVE X'2020233030303138323531' TO DFHEIV0(25:11)
 21594     CALL 'kxdfhei1' USING DFHEIV0,
 21595           FILE-ID-ERPNDB,
 21596           DFHEIV11,
 21597           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 395
* EL6311.cbl
 21598     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21599             GO TO 5505-START-BROWSE.
 21600
 21601     IF NOT PB-BATCH-TRAILER
 21602        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 21603
 21604* EXEC CICS ENDBR
 21605*            DATASET  (FILE-ID-ERPNDB)
 21606*       END-EXEC
 21607     MOVE 0
 21608       TO DFHEIV11
 21609*    MOVE '&2                    $   #00018258' TO DFHEIV0
 21610     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21611     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21612     MOVE X'2020233030303138323538' TO DFHEIV0(25:11)
 21613     CALL 'kxdfhei1' USING DFHEIV0,
 21614           FILE-ID-ERPNDB,
 21615           DFHEIV11,
 21616           DFHEIV99
 21617     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21618        GO TO 5505-START-BROWSE.
 21619
 21620     IF PI-CSR-BROWSE
 21621        IF PB-CSR-ID           NOT = PI-PB-CSR-ID
 21622           MOVE SPACE            TO WS-BROWSE-STARTED-SW
 21623
 21624* EXEC CICS ENDBR
 21625*               DATASET  (FILE-ID-ERPNDB)
 21626*          END-EXEC
 21627     MOVE 0
 21628       TO DFHEIV11
 21629*    MOVE '&2                    $   #00018266' TO DFHEIV0
 21630     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21631     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21632     MOVE X'2020233030303138323636' TO DFHEIV0(25:11)
 21633     CALL 'kxdfhei1' USING DFHEIV0,
 21634           FILE-ID-ERPNDB,
 21635           DFHEIV11,
 21636           DFHEIV99
 21637     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21638           GO TO 5505-START-BROWSE.
 21639
 21640     IF ONLY-BATCH-HEADERS OR PB-OUT-OF-BAL
 21641        IF PI-PB-CARRIER    = SPACES AND
 21642           PI-PB-GROUPING   = SPACES AND
 21643           PI-PB-STATE      = SPACES AND
 21644           PI-PB-ACCOUNT    = SPACES
 21645             GO TO 7200-DISPLAY-BATCHES
 21646          ELSE
 21647            IF PI-PB-CARRIER    = PB-CARRIER  AND
 21648               PI-PB-GROUPING   = PB-GROUPING AND
 21649               PI-PB-STATE      = PB-STATE    AND
 21650               PI-PB-ACCOUNT    = PB-ACCOUNT
 21651                 GO TO 7200-DISPLAY-BATCHES.
 21652
 21653     MOVE SPACE                  TO WS-BROWSE-STARTED-SW.
 21654
 21655
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 396
* EL6311.cbl
 21656* EXEC CICS ENDBR
 21657*         DATASET  (FILE-ID-ERPNDB)
 21658*    END-EXEC.
 21659     MOVE 0
 21660       TO DFHEIV11
 21661*    MOVE '&2                    $   #00018286' TO DFHEIV0
 21662     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21663     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21664     MOVE X'2020233030303138323836' TO DFHEIV0(25:11)
 21665     CALL 'kxdfhei1' USING DFHEIV0,
 21666           FILE-ID-ERPNDB,
 21667           DFHEIV11,
 21668           DFHEIV99
 21669     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21670
 21671
 21672     GO TO 5505-START-BROWSE.
 21673
 21674 5550-END-RECORDS.
 21675     MOVE ER-2257                TO EMI-ERROR.
 21676     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21677     MOVE -1                     TO DPFENTRL.
 21678
 21679     GO TO 8200-SEND-DATAONLY.
 21680
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 397
* EL6311.cbl
 21682
 21683******************************************************************
 21684*                                                                *
 21685*        C R E A T E   T E M P O R A R Y   S T O R A G E         *
 21686*                                                                *
 21687******************************************************************
 21688
 21689 6000-CREATE-TEMP-STORAGE.
 21690
 21691
 21692* EXEC CICS HANDLE CONDITION
 21693*        QIDERR  (6050-QID-ERROR)
 21694*    END-EXEC.
 21695*    MOVE '"$N                   ! Q #00018309' TO DFHEIV0
 21696     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 21697     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21698     MOVE X'5120233030303138333039' TO DFHEIV0(25:11)
 21699     CALL 'kxdfhei1' USING DFHEIV0
 21700     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21701
 21702
 21703
 21704* EXEC CICS WRITEQ TS
 21705*        QUEUE    (QID)
 21706*        FROM     (PROGRAM-INTERFACE-BLOCK)
 21707*        LENGTH   (WS-COMM-LENGTH)
 21708*        ITEM     (W-ONE)
 21709*    END-EXEC.
 21710*    MOVE '*" I   L              ''   #00018313' TO DFHEIV0
 21711     MOVE X'2A2220492020204C20202020' TO DFHEIV0(1:12)
 21712     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21713     MOVE X'2020233030303138333133' TO DFHEIV0(25:11)
 21714     CALL 'kxdfhei1' USING DFHEIV0,
 21715           QID,
 21716           PROGRAM-INTERFACE-BLOCK,
 21717           WS-COMM-LENGTH,
 21718           W-ONE,
 21719           DFHEIV99,
 21720           DFHEIV99
 21721     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21722
 21723
 21724 6000-EXIT.
 21725      EXIT.
 21726
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 398
* EL6311.cbl
 21728
 21729******************************************************************
 21730*                                                                *
 21731*        R E C O V E R   T E M P O R A R Y   S T O R A G E       *
 21732*                                                                *
 21733******************************************************************
 21734
 21735 6050-RECOVER-TEMP-STORAGE.
 21736     IF PGM-NAME = XCTL-EL6312
 21737        GO TO 6050-EXIT.
 21738
 21739     IF PGM-NAME = XCTL-EL6313
 21740        GO TO 6050-EXIT.
 21741
 21742     IF PGM-NAME = XCTL-EL6315
 21743         MOVE PI-PROGRAM-WORK-AREA TO WS-EL6315-PASS-AREA
 21744     END-IF
 21745
 21746     IF PGM-NAME = XCTL-EL6316
 21747         MOVE PI-PROGRAM-WORK-AREA TO WS-EL6316-PASS-AREA
 21748     END-IF
 21749
 21750
 21751* EXEC CICS HANDLE CONDITION
 21752*        QIDERR  (6050-QID-ERROR)
 21753*    END-EXEC.
 21754*    MOVE '"$N                   ! R #00018346' TO DFHEIV0
 21755     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 21756     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21757     MOVE X'5220233030303138333436' TO DFHEIV0(25:11)
 21758     CALL 'kxdfhei1' USING DFHEIV0
 21759     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21760
 21761
 21762
 21763* EXEC CICS READQ TS
 21764*         QUEUE   (QID)
 21765*         INTO    (PROGRAM-INTERFACE-BLOCK)
 21766*         LENGTH  (WS-COMM-LENGTH)
 21767*         ITEM    (W-ONE)
 21768*     END-EXEC.
 21769*    MOVE '*$II   L              ''   #00018350' TO DFHEIV0
 21770     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
 21771     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21772     MOVE X'2020233030303138333530' TO DFHEIV0(25:11)
 21773     CALL 'kxdfhei1' USING DFHEIV0,
 21774           QID,
 21775           PROGRAM-INTERFACE-BLOCK,
 21776           WS-COMM-LENGTH,
 21777           W-ONE,
 21778           DFHEIV99,
 21779           DFHEIV99
 21780     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21781
 21782
 21783 6050-DELETE-TEMP-STORAGE.
 21784
 21785
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 399
* EL6311.cbl
 21786* EXEC CICS DELETEQ TS
 21787*        QUEUE   (QID)
 21788*    END-EXEC.
 21789*    MOVE '*&                    #   #00018359' TO DFHEIV0
 21790     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
 21791     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 21792     MOVE X'2020233030303138333539' TO DFHEIV0(25:11)
 21793     CALL 'kxdfhei1' USING DFHEIV0,
 21794           QID,
 21795           DFHEIV99
 21796     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21797
 21798
 21799     GO TO 6050-EXIT.
 21800
 21801 6050-QID-ERROR.
 21802     MOVE ER-0033                TO EMI-ERROR
 21803     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21804
 21805 6050-EXIT.
 21806      EXIT.
 21807
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 400
* EL6311.cbl
 21809
 21810******************************************************************
 21811*                                                                *
 21812*            T E R M   C O N V E R S I O N                       *
 21813*                                                                *
 21814******************************************************************
 21815
 21816 6100-TERM-CONVERSION.
 21817
 21818     IF PI-BPMTS = ZERO
 21819         GO TO 6199-EXIT.
 21820
 21821     IF PI-BMODE = ' ' OR 'M'
 21822         MOVE PI-BPMTS      TO WS-CALC-TERM-WHOLE
 21823         GO TO 6105-ROUND-TERM.
 21824
 21825     IF PI-BMODE = 'S'
 21826         COMPUTE WS-CALC-TERM = PI-BPMTS / 2
 21827         GO TO 6105-ROUND-TERM.
 21828
 21829     IF PI-BMODE = 'W'
 21830         COMPUTE WS-CALC-TERM = PI-BPMTS / 4.33333
 21831         GO TO 6105-ROUND-TERM.
 21832
 21833     IF PI-BMODE = 'B'
 21834         COMPUTE WS-CALC-TERM = PI-BPMTS / 2.16667
 21835         GO TO 6105-ROUND-TERM.
 21836
 21837     IF PI-BMODE = 'T'
 21838         COMPUTE WS-CALC-TERM = PI-BPMTS / 1.08334.
 21839
 21840 6105-ROUND-TERM.
 21841
 21842     IF WS-CALC-TERM-REMAIN GREATER THAN .00000
 21843         ADD +1                  TO WS-CALC-TERM-WHOLE
 21844         MOVE ZEROS              TO WS-CALC-TERM-REMAIN.
 21845
 21846     IF PI-COMPANY-ID = CLIENT-CRI OR CLIENT-LGX
 21847         GO TO 6125-COMPUTE-TERM-BENEFIT.
 21848
 21849     IF BTERM-LEN (WS-SUB1) NOT GREATER THAN +0
 21850         MOVE WS-CALC-TERM-WHOLE   TO BTERMO      (WS-SUB1)
 21851                                      WS-BTERM    (WS-SUB1)
 21852         MOVE +3                   TO BTERM-LEN   (WS-SUB1).
 21853
 21854     IF BTERM-LEN (WS-SUB1) GREATER THAN +0
 21855         IF WS-BTERM (WS-SUB1)   NOT = WS-CALC-TERM-WHOLE
 21856             MOVE -1               TO BMODEL
 21857             MOVE ER-2593          TO EMI-ERROR
 21858             MOVE AL-UNBON         TO BTERM-ATTRB (WS-SUB1)
 21859             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21860
 21861 6124-CHECK-BENEFIT.
 21862
 21863     IF BBEN-LEN (WS-SUB1) NOT GREATER THAN +0
 21864        GO TO 6126-COMPUTE-BENEFIT.
 21865
 21866     GO TO 6199-EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 401
* EL6311.cbl
 21867
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 402
* EL6311.cbl
 21869******************************************************************
 21870**         COMPUTE TERM AND BENEFIT
 21871******************************************************************
 21872 6125-COMPUTE-TERM-BENEFIT.
 21873
 21874     IF PI-BTYPE (WS-SUB1) = SPACES  OR
 21875        PI-BPMTAMT = ZERO
 21876         GO TO 6199-EXIT.
 21877
 21878     MOVE WS-CALC-TERM-WHOLE     TO  BTERMI    (WS-SUB1)
 21879                                     WS-BTERM  (WS-SUB1).
 21880     MOVE +3                     TO  BTERM-LEN (WS-SUB1).
 21881
 21882 6126-COMPUTE-BENEFIT.
 21883
 21884     IF PI-BMODE = 'M' OR  ' '
 21885         MOVE PI-BPMTAMT        TO  WS-BBEN (WS-SUB1).
 21886
 21887     IF PI-BMODE = 'W'
 21888         COMPUTE WS-BBEN (WS-SUB1) ROUNDED = PI-BPMTAMT * 4.33333.
 21889
 21890     IF PI-BMODE = 'S'
 21891         COMPUTE WS-BBEN (WS-SUB1)  ROUNDED = PI-BPMTAMT * 2.
 21892
 21893     IF PI-BMODE = 'B'
 21894         COMPUTE WS-BBEN (WS-SUB1) ROUNDED = PI-BPMTAMT * 2.16667.
 21895
 21896     IF PI-BMODE = 'T'
 21897         COMPUTE WS-BBEN (WS-SUB1) ROUNDED = PI-BPMTAMT * 1.08334.
 21898
 21899     IF WS-SUB1 = +1
 21900        COMPUTE WS-BBEN (WS-SUB1) =
 21901                WS-BBEN (WS-SUB1) * WS-CALC-TERM.
 21902
 21903     MOVE WS-BBEN (WS-SUB1)           TO BBENO       (WS-SUB1).
 21904     MOVE +12                         TO BBEN-LEN    (WS-SUB1).
 21905     MOVE AL-UNNON                    TO BBEN-ATTRB  (WS-SUB1).
 21906
 21907 6199-EXIT.
 21908     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 403
* EL6311.cbl
 21910
 21911******************************************************************
 21912*                                                                *
 21913*             D I S P L A Y   I S S U E S                        *
 21914*                                                                *
 21915******************************************************************
 21916
 21917 6200-CREATE-VADS.
 21918     MOVE PI-PREV-KEY            TO PI-ERPNDB-KEY
 21919     MOVE  PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY
 21920     MOVE SPACES                 TO WS-PASS-VADS-REC
 21921
 21922* EXEC CICS GETMAIN
 21923*       SET      (ADDRESS OF PENDING-BUSINESS)
 21924*       LENGTH   (ERPNDB-RECORD-LENGTH)
 21925*       INITIMG  (GETMAIN-SPACE)
 21926*       RESP     (WS-RESPONSE)
 21927*    END-EXEC
 21928*    MOVE ',"IL                  $  N#00018485' TO DFHEIV0
 21929     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 21930     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21931     MOVE X'204E233030303138343835' TO DFHEIV0(25:11)
 21932     CALL 'kxdfhei1' USING DFHEIV0,
 21933           DFHEIV20,
 21934           ERPNDB-RECORD-LENGTH,
 21935           GETMAIN-SPACE
 21936     SET ADDRESS OF PENDING-BUSINESS TO
 21937         DFHEIV20
 21938     MOVE EIBRESP  TO WS-RESPONSE
 21939     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21940
 21941* EXEC CICS READ
 21942*       INTO    (PENDING-BUSINESS)
 21943*       DATASET (FILE-ID-ERPNDB)
 21944*       RIDFLD  (ERPNDB-KEY)
 21945*       RESP    (WS-RESPONSE)
 21946*    END-EXEC
 21947     MOVE LENGTH OF
 21948      PENDING-BUSINESS
 21949       TO DFHEIV11
 21950*    MOVE '&"IL       E          (  N#00018491' TO DFHEIV0
 21951     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21952     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21953     MOVE X'204E233030303138343931' TO DFHEIV0(25:11)
 21954     CALL 'kxdfhei1' USING DFHEIV0,
 21955           FILE-ID-ERPNDB,
 21956           PENDING-BUSINESS,
 21957           DFHEIV11,
 21958           ERPNDB-KEY,
 21959           DFHEIV99,
 21960           DFHEIV99,
 21961           DFHEIV99
 21962     MOVE EIBRESP  TO WS-RESPONSE
 21963     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21964     IF RESP-NORMAL
 21965        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
 21966        IF (RESP-NORMAL)
 21967           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 404
* EL6311.cbl
 21968              AM-CONTROL-PRIMARY (1:20))
 21969           MOVE AM-NAME          TO VD-ACCOUNT-NAME
 21970        ELSE
 21971           MOVE 'ACCOUNT NOT FOUND'
 21972                                 TO VD-ACCOUNT-NAME
 21973        END-IF
 21974        MOVE FUNCTION LENGTH(VD-ACCOUNT-NAME)
 21975                                    TO M1
 21976        MOVE VD-ACCOUNT-NAME        TO WS-WORK-FIELD
 21977        PERFORM VARYING A2 FROM +1 BY +1 UNTIL
 21978           (A2 > M1)
 21979           OR (WS-WORK-FIELD (A2:1) = '*')
 21980           OR (WS-WORK-FIELD (A2:4) = ' DBA' OR ' AKA')
 21981           OR (WS-WORK-FIELD (A2:4) = '(DBA' OR '(AKA')
 21982        END-PERFORM
 21983        IF A2 > M1
 21984           CONTINUE
 21985        ELSE
 21986           MOVE WS-WORK-FIELD (1:A2 - 1)
 21987                                    TO VD-ACCOUNT-NAME
 21988        END-IF
 21989        MOVE PB-COMPANY-CD       TO VD-COMPANY-CD
 21990        MOVE PB-CARRIER          TO VD-CARRIER
 21991        MOVE PB-GROUPING         TO VD-GROUPING
 21992        MOVE PB-STATE            TO VD-STATE
 21993        MOVE PB-ACCOUNT          TO VD-ACCOUNT
 21994        MOVE PB-CERT-EFF-DT      TO VD-CERT-EFF-DT
 21995        MOVE PB-CERT-NO          TO VD-CERT-NO
 21996        MOVE PB-I-INSURED-LAST-NAME TO VD-INSURED-LAST-NAME
 21997        MOVE PB-I-INSURED-FIRST-NAME TO VD-INSURED-FIRST-NAME
 21998        MOVE PB-I-INSURED-MIDDLE-INIT TO VD-INSURED-MIDDLE-INIT
 21999        MOVE PB-I-JOINT-LAST-NAME TO VD-JOINT-LAST-NAME
 22000        MOVE PB-I-JOINT-FIRST-NAME TO VD-JOINT-FIRST-NAME
 22001        MOVE PB-I-JOINT-MIDDLE-INIT TO VD-JOINT-MIDDLE-INIT
 22002        MOVE PB-I-BENEFICIARY-NAME TO VD-BENEFICIARY-NAME
 22003        MOVE PB-ENTRY-BATCH      TO VD-ENTRY-BATCH
 22004        MOVE PB-CSR-ID           TO VD-CSR-ID
 22005        MOVE PB-I-LF-BENEFIT-CD  TO VD-LF-BENEFIT-CD
 22006        MOVE PB-I-LF-PREMIUM-AMT TO VD-LF-PREMIUM-AMT
 22007        MOVE PB-I-LF-BENEFIT-AMT TO VD-LF-BENEFIT-AMT
 22008        MOVE PB-I-LF-TERM        TO VD-LF-TERM
 22009        MOVE PB-I-LF-RATE        TO VD-LF-RATE
 22010        MOVE PB-I-AH-BENEFIT-CD  TO VD-AH-BENEFIT-CD
 22011        MOVE PB-I-AH-PREMIUM-AMT TO VD-AH-PREMIUM-AMT
 22012        MOVE PB-I-AH-BENEFIT-AMT TO VD-AH-BENEFIT-AMT
 22013        MOVE PB-I-AH-TERM        TO VD-AH-TERM
 22014        MOVE PB-I-AH-RATE        TO VD-AH-RATE
 22015        MOVE PB-I-LOAN-TERM      TO VD-LOAN-TERM
 22016        MOVE PB-I-LOAN-APR       TO VD-LOAN-APR
 22017        MOVE PB-I-1ST-PMT-DT     TO VD-1ST-PMT-DT
 22018     END-IF
 22019     MOVE PB-CONTROL-PRIMARY     TO  ERPNDM-KEY.
 22020
 22021
 22022* EXEC CICS GETMAIN
 22023*       SET      (ADDRESS OF PENDING-MAILING-DATA)
 22024*       LENGTH   (ERPNDM-RECORD-LENGTH)
 22025*       INITIMG  (GETMAIN-SPACE)
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 405
* EL6311.cbl
 22026*       RESP     (WS-RESPONSE)
 22027*    END-EXEC
 22028*    MOVE ',"IL                  $  N#00018554' TO DFHEIV0
 22029     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 22030     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 22031     MOVE X'204E233030303138353534' TO DFHEIV0(25:11)
 22032     CALL 'kxdfhei1' USING DFHEIV0,
 22033           DFHEIV20,
 22034           ERPNDM-RECORD-LENGTH,
 22035           GETMAIN-SPACE
 22036     SET ADDRESS OF PENDING-MAILING-DATA TO
 22037         DFHEIV20
 22038     MOVE EIBRESP  TO WS-RESPONSE
 22039     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22040
 22041
 22042* EXEC CICS READ
 22043*       INTO    (PENDING-MAILING-DATA)
 22044*       DATASET (FILE-ID-ERPNDM)
 22045*       RIDFLD  (ERPNDM-KEY)
 22046*       RESP    (WS-RESPONSE)
 22047*    END-EXEC
 22048     MOVE LENGTH OF
 22049      PENDING-MAILING-DATA
 22050       TO DFHEIV11
 22051*    MOVE '&"IL       E          (  N#00018561' TO DFHEIV0
 22052     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22053     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22054     MOVE X'204E233030303138353631' TO DFHEIV0(25:11)
 22055     CALL 'kxdfhei1' USING DFHEIV0,
 22056           FILE-ID-ERPNDM,
 22057           PENDING-MAILING-DATA,
 22058           DFHEIV11,
 22059           ERPNDM-KEY,
 22060           DFHEIV99,
 22061           DFHEIV99,
 22062           DFHEIV99
 22063     MOVE EIBRESP  TO WS-RESPONSE
 22064     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22065
 22066     IF RESP-NORMAL
 22067        MOVE PM-ADDRESS-LINE-1    TO VD-INSURED-ADDRESS-1
 22068        MOVE PM-ADDRESS-LINE-2    TO VD-INSURED-ADDRESS-2
 22069        MOVE PM-CITY              TO VD-INSURED-CITY
 22070        MOVE PM-STATE             TO VD-INSURED-STATE
 22071        MOVE PM-ZIP               TO VD-INSURED-ZIP-CODE
 22072     END-IF
 22073
 22074     MOVE 'VAC1'                  TO VD-LETTER-ID
 22075     MOVE PI-PROCESSOR-ID         TO VD-PROC-ID
 22076     MOVE PI-COMPANY-ID           TO VD-COMP-ID
 22077     MOVE EIBTIME                 TO VD-CURRENT-TIME
 22078     MOVE WS-CURRENT-BIN-DT       TO VD-CURRENT-DATE
 22079     MOVE +0                      TO VD-ARCHIVE-NO
 22080     MOVE VIRGINIA-DISCLOSURE     TO WS-PASS-VADS-REC
 22081     .
 22082 6200-EXIT.
 22083     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 406
* EL6311.cbl
 22084 6210-READ-ERACCT.
 22085     MOVE PB-CONTROL-BY-ACCOUNT  TO ERACCT-KEY
 22086     MOVE LOW-VALUES             TO ERACCT-FILL
 22087
 22088* EXEC CICS READ
 22089*         DATASET   ('ERACCT')
 22090*         INTO      (ACCOUNT-MASTER)
 22091*         RIDFLD    (ERACCT-KEY)
 22092*         GTEQ
 22093*         RESP      (WS-RESPONSE)
 22094*    END-EXEC
 22095     MOVE LENGTH OF
 22096      ACCOUNT-MASTER
 22097       TO DFHEIV11
 22098     MOVE 'ERACCT' TO DFHEIV1
 22099*    MOVE '&"IL       G          (  N#00018589' TO DFHEIV0
 22100     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 22101     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22102     MOVE X'204E233030303138353839' TO DFHEIV0(25:11)
 22103     CALL 'kxdfhei1' USING DFHEIV0,
 22104           DFHEIV1,
 22105           ACCOUNT-MASTER,
 22106           DFHEIV11,
 22107           ERACCT-KEY,
 22108           DFHEIV99,
 22109           DFHEIV99,
 22110           DFHEIV99
 22111     MOVE EIBRESP  TO WS-RESPONSE
 22112     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22113     .
 22114 6210-EXIT.
 22115     EXIT.
 22116
 22117 6220-READ-ERMAIL.
 22118
 22119     MOVE ELCERT-KEY             TO ERMAIL-KEY
 22120     MOVE ' '                    TO WS-ERMAIL-SW
 22121
 22122
 22123* EXEC CICS READ
 22124*       DATASET   (FILE-ID-ERMAIL)
 22125*       SET       (ADDRESS OF MAILING-DATA)
 22126*       RIDFLD    (ERMAIL-KEY)
 22127*       RESP      (WS-RESPONSE)
 22128*    END-EXEC
 22129*    MOVE '&"S        E          (  N#00018605' TO DFHEIV0
 22130     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 22131     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22132     MOVE X'204E233030303138363035' TO DFHEIV0(25:11)
 22133     CALL 'kxdfhei1' USING DFHEIV0,
 22134           FILE-ID-ERMAIL,
 22135           DFHEIV20,
 22136           DFHEIV99,
 22137           ERMAIL-KEY,
 22138           DFHEIV99,
 22139           DFHEIV99,
 22140           DFHEIV99
 22141     SET ADDRESS OF MAILING-DATA TO
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 407
* EL6311.cbl
 22142         DFHEIV20
 22143     MOVE EIBRESP  TO WS-RESPONSE
 22144     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22145
 22146     IF RESP-NORMAL
 22147        SET ERMAIL-FOUND TO TRUE
 22148     END-IF
 22149     .
 22150 6220-EXIT.
 22151     EXIT.
 22152
 22153 6400-CHECK-FOR-RES-REF-CLAIM.
 22154     MOVE LOW-VALUES             TO PI-RES-REF-CLM-TYPE
 22155
 22156     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD
 22157                                    W-CL-COMP-CD.
 22158     MOVE PI-CERT-NO             TO MSTR-CERT-NO
 22159                                    W-CL-CERT-NO.
 22160     MOVE SPACES                 TO MSTR-CERT-SFX.
 22161
 22162
 22163* EXEC CICS HANDLE CONDITION
 22164*        NOTFND  (6400-CONTINUE)
 22165*        ENDFILE (6400-CONTINUE)
 22166*    END-EXEC.
 22167*    MOVE '"$I''                  ! S #00018628' TO DFHEIV0
 22168     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 22169     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22170     MOVE X'5320233030303138363238' TO DFHEIV0(25:11)
 22171     CALL 'kxdfhei1' USING DFHEIV0
 22172     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22173
 22174
 22175
 22176* EXEC CICS IGNORE CONDITION
 22177*        DUPKEY
 22178*    END-EXEC.
 22179*    MOVE '"*$                   !   #00018633' TO DFHEIV0
 22180     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 22181     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22182     MOVE X'2020233030303138363333' TO DFHEIV0(25:11)
 22183     CALL 'kxdfhei1' USING DFHEIV0
 22184     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22185
 22186
 22187
 22188* EXEC CICS STARTBR
 22189*        DATASET   (CLMS-ID)
 22190*        RIDFLD    (ELMSTR-KEY)
 22191*        GENERIC   EQUAL
 22192*        KEYLENGTH (ELMSTR-LENGTH)
 22193*    END-EXEC.
 22194     MOVE 0
 22195       TO DFHEIV11
 22196*    MOVE '&,   KG    E          &   #00018637' TO DFHEIV0
 22197     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 22198     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 22199     MOVE X'2020233030303138363337' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 408
* EL6311.cbl
 22200     CALL 'kxdfhei1' USING DFHEIV0,
 22201           CLMS-ID,
 22202           ELMSTR-KEY,
 22203           ELMSTR-LENGTH,
 22204           DFHEIV11,
 22205           DFHEIV99
 22206     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22207
 22208
 22209     display 'browse started'
 22210     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 22211
 22212 6400-NEXT-CLAIM.
 22213
 22214
 22215* EXEC CICS READNEXT
 22216*        DATASET   (CLMS-ID)
 22217*        RIDFLD    (ELMSTR-KEY)
 22218*        SET       (ADDRESS OF CLAIM-MASTER)
 22219*    END-EXEC.
 22220     MOVE 0
 22221       TO DFHEIV11
 22222*    MOVE '&.S                   )   #00018649' TO DFHEIV0
 22223     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 22224     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 22225     MOVE X'2020233030303138363439' TO DFHEIV0(25:11)
 22226     CALL 'kxdfhei1' USING DFHEIV0,
 22227           CLMS-ID,
 22228           DFHEIV20,
 22229           DFHEIV99,
 22230           ELMSTR-KEY,
 22231           DFHEIV99,
 22232           DFHEIV11,
 22233           DFHEIV99,
 22234           DFHEIV99
 22235     SET ADDRESS OF CLAIM-MASTER TO
 22236         DFHEIV20
 22237     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22238
 22239
 22240     display 'read claim for ' mstr-cert-no
 22241     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 22242        MSTR-CERT-PRIME NOT = W-CL-CERT-PRIME
 22243         GO TO 6400-CONTINUE
 22244     END-IF.
 22245
 22246     IF PI-CARRIER     NOT = CL-CARRIER        OR
 22247        PI-GROUPING    NOT = CL-CERT-GROUPING  OR
 22248        PI-STATE       NOT = CL-CERT-STATE     OR
 22249        PI-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 22250        PI-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 22251         GO TO 6400-NEXT-CLAIM
 22252     END-IF.
 22253
 22254     display 'found claim ' cl-claim-no
 22255        ' with denial type ' cl-denial-type
 22256     IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 22257         MOVE CL-DENIAL-TYPE TO PI-RES-REF-CLM-TYPE
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 409
* EL6311.cbl
 22258         GO TO 6400-CONTINUE
 22259     END-IF.
 22260
 22261     GO TO 6400-NEXT-CLAIM.
 22262
 22263 6400-CONTINUE.
 22264
 22265     IF WS-BROWSE-STARTED-SW = 'Y'
 22266
 22267* EXEC CICS ENDBR
 22268*            DATASET   (CLMS-ID)
 22269*        END-EXEC
 22270     MOVE 0
 22271       TO DFHEIV11
 22272*    MOVE '&2                    $   #00018681' TO DFHEIV0
 22273     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 22274     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 22275     MOVE X'2020233030303138363831' TO DFHEIV0(25:11)
 22276     CALL 'kxdfhei1' USING DFHEIV0,
 22277           CLMS-ID,
 22278           DFHEIV11,
 22279           DFHEIV99
 22280     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22281         MOVE 'N' TO WS-BROWSE-STARTED-SW
 22282     END-IF.
 22283
 22284 6400-EXIT.
 22285     EXIT.
 22286
 22287 7000-DISPLAY-ISSUES.
 22288
 22289     IF PI-DISPLAY-ORIGINAL-BATCH
 22290        MOVE PB-CONTROL-BY-ORIG-BATCH TO PI-PREV-KEY
 22291        MOVE ZEROS                    TO PI-PREV-CHG-SEQ-NO
 22292     ELSE
 22293        MOVE PB-CONTROL-PRIMARY      TO PI-PREV-KEY.
 22294
 22295     MOVE PB-CONTROL-PRIMARY         TO PI-PREV-CONTROL-PRIMARY.
 22296
 22297     MOVE 'Y'                        TO WS-DISPLAY-SW.
 22298     MOVE 'Y'                        TO PI-DISPLAY-SCREEN-SW.
 22299
 22300     MOVE LOW-VALUES                 TO EL631BI.
 22301     MOVE ZEROS                      TO PI-BPMTAMT
 22302                                        PI-BPMTS.
 22303     MOVE SPACE                      TO PI-BMODE
 22304                                        PI-BTYPE (1)
 22305                                        PI-BTYPE (2).
 22306     MOVE EL631B                     TO PI-MAP-NAME.
 22307     MOVE 'Y'                        TO PI-BROWSE-SW.
 22308     MOVE PB-BATCH-SEQ-NO            TO BSEQO
 22309                                        PI-HIGH-SEQ-NO.
 22310
 22311     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 22312        MOVE AL-SABOF                TO BCHGTA
 22313        SUBTRACT PB-BATCH-CHG-SEQ-NO FROM 1000 GIVING BCHGO
 22314        MOVE AL-SANON                TO BCHGA
 22315     ELSE
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 410
* EL6311.cbl
 22316        MOVE AL-SADOF                TO BCHGTA
 22317                                        BCHGA
 22318        MOVE PB-CHG-COUNT            TO BCHGO.
 22319
 22320     MOVE PB-LAST-MAINT-BY           TO BMANTBYO.
 22321     MOVE PB-LAST-MAINT-HHMMSS       TO WS-TIME.
 22322     MOVE WS-HR-MINS                 TO BMANTATO.
 22323
 22324     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 22325        MOVE PB-CREDIT-ACCEPT-DT     TO DC-BIN-DATE-1
 22326        MOVE SPACE                   TO DC-OPTION-CODE
 22327        PERFORM 9700-DATE-LINK
 22328        MOVE DC-GREG-DATE-1-EDIT     TO BMANTDTO
 22329        MOVE 'INACTIVE'              TO BMOENDTO
 22330     ELSE
 22331        MOVE PB-LAST-MAINT-DT        TO DC-BIN-DATE-1
 22332        MOVE SPACE                   TO DC-OPTION-CODE
 22333        PERFORM 9700-DATE-LINK
 22334        MOVE DC-GREG-DATE-1-EDIT     TO BMANTDTO
 22335        MOVE PB-CREDIT-SELECT-DT     TO DC-BIN-DATE-1
 22336        MOVE SPACE                   TO DC-OPTION-CODE
 22337        PERFORM 9700-DATE-LINK
 22338        MOVE DC-GREG-DATE-1-EDIT     TO BMOENDTO.
 22339
 22340*    MOVE PB-I-REFERENCE             TO BREFO.
 22341
 22342*    IF PI-COMPANY-ID EQUAL 'HER'
 22343*        MOVE PB-I-MEMBER-NO     TO  WS-MEMBER-NO
 22344*        IF WS-MEMBER-NO-1-8  IS NUMERIC
 22345*            IF WS-MEMBER-NO-1-8  GREATER  ZEROS
 22346*                MOVE WS-MEMBER-NO-1-8
 22347*                                TO  BMICRNOO.
 22348
 22349*    IF PB-I-MICROFILM-NO  IS NUMERIC
 22350*        IF PB-I-MICROFILM-NO  GREATER  ZEROS
 22351*            MOVE PB-I-MICROFILM-NO
 22352*                                TO  BMICRNOO.
 22353     IF PB-I-VIN NOT = SPACES
 22354        MOVE PB-I-VIN            TO BVINO
 22355     END-IF
 22356     MOVE PB-I-LETTER-REQD           TO LETRREQO
 22357
 22358
 22359     MOVE PB-CERT-PRIME              TO BCERTNOO.
 22360     MOVE PB-CERT-SFX                TO BSUFIXO.
 22361     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 22362     MOVE SPACE                      TO DC-OPTION-CODE.
 22363     PERFORM 9700-DATE-LINK.
 22364     MOVE DC-GREG-DATE-1-EDIT        TO BEFFDTO
 22365
 22366     MOVE PB-I-INSURED-LAST-NAME     TO BLSTNMO.
 22367     MOVE PB-I-INSURED-FIRST-NAME    TO B1STNMO.
 22368     MOVE PB-I-INSURED-MIDDLE-INIT   TO BINITO.
 22369     MOVE PB-I-INSURED-SEX           TO BSEXO
 22370
 22371     IF PB-I-AGE NOT = ZEROS
 22372         MOVE PB-I-AGE               TO BAGEO.
 22373
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 411
* EL6311.cbl
 22374     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 22375                                 TO ELCERT-KEY
 22376     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 22377     IF NOT CERT-TRL-REC-NOT-FOUND
 22378         IF CS-INS-AGE-DEFAULT-FLAG = 'Y'
 22379             MOVE 'AGE*'             TO BAGEDEFO
 22380         ELSE
 22381             MOVE 'AGE '             TO BAGEDEFO
 22382         END-IF
 22383     ELSE
 22384         MOVE 'AGE '             TO BAGEDEFO
 22385     END-IF
 22386
 22387     IF PB-I-BIRTHDAY NOT = LOW-VALUES
 22388         MOVE PB-I-BIRTHDAY          TO DC-BIN-DATE-1
 22389         MOVE SPACE                  TO DC-OPTION-CODE
 22390         PERFORM 9700-DATE-LINK
 22391         IF NO-CONVERSION-ERROR
 22392            MOVE DC-GREG-DATE-1-EDIT TO BBIRTHO.
 22393
 22394     IF PB-I-1ST-PMT-DT NOT = LOW-VALUES
 22395         MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-1
 22396         MOVE SPACE                  TO DC-OPTION-CODE
 22397         PERFORM 9700-DATE-LINK
 22398         IF NO-CONVERSION-ERROR
 22399            MOVE DC-GREG-DATE-1-EDIT TO B1STPMTO.
 22400
 22401     IF PB-I-EXTENTION-DAYS NUMERIC
 22402        IF PB-I-EXTENTION-DAYS GREATER THAN ZEROS
 22403           MOVE PB-I-EXTENTION-DAYS  TO BDAYSO
 22404        ELSE
 22405           IF PB-I-TERM-IN-DAYS NUMERIC
 22406              IF PB-I-TERM-IN-DAYS GREATER THAN ZEROS
 22407                 MOVE PB-I-TERM-IN-DAYS TO BDAYSO.
 22408
 22409     IF PB-I-LOAN-TERM GREATER THAN ZEROS
 22410        MOVE PB-I-LOAN-TERM          TO BLNTRMO.
 22411
 22412     MOVE PB-FORCE-CODE              TO BFORCEO.
 22413     MOVE PB-I-TERM-TYPE             TO BMODEO
 22414                                        PI-BMODE.
 22415
 22416     IF PB-I-PAY-FREQUENCY GREATER THAN ZEROS
 22417        MOVE PB-I-PAY-FREQUENCY      TO BFREQO.
 22418
 22419     IF PB-I-NO-OF-PAYMENTS GREATER THAN ZEROS
 22420         MOVE PB-I-NO-OF-PAYMENTS    TO BPMTSO
 22421                                        PI-BPMTS.
 22422
 22423     IF PB-I-PAYMENT-AMOUNT NUMERIC
 22424         IF PB-I-PAYMENT-AMOUNT GREATER THAN ZEROS
 22425           MOVE PB-I-PAYMENT-AMOUNT  TO BPMTAMTO
 22426                                        PI-BPMTAMT.
 22427
 22428     MOVE PB-I-LOAN-OFFICER          TO BLNOFCRO.
 22429     MOVE PB-BATCH-ENTRY             TO BENTRYO.
 22430     MOVE PB-I-UNDERWRITING-STATUS   TO BUNWRITO.
 22431     MOVE PB-I-SKIP-CODE             TO BSKPCDO.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 412
* EL6311.cbl
 22432     MOVE PB-I-INDV-GRP-CD           TO BINDGRPO.
 22433     MOVE PB-I-SIG-SW                TO BSIGO.
 22434     MOVE PB-I-RATE-CLASS-OVRD       TO BRTCLSO.
 22435     MOVE PB-I-SPECIAL-REIN-CODE     TO BREINO.
 22436     MOVE PB-RECORD-BILL             TO BBILCDO.
 22437     MOVE PB-FORCE-CODE              TO BFORCEO.
 22438
 22439     IF (PB-I-LIVES NUMERIC)
 22440        AND (PB-I-LIVES > ZEROS)
 22441        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
 22442        IF (RESP-NORMAL)
 22443           AND (AM-DCC-PRODUCT-CODE = 'DDF')
 22444           CONTINUE
 22445        ELSE
 22446           MOVE PB-I-LIVES       TO BLIVESO
 22447        END-IF
 22448     END-IF
 22449
 22450     IF PB-I-NUM-BILLED NUMERIC AND
 22451        PB-I-NUM-BILLED GREATER THAN ZEROS
 22452        MOVE PB-I-NUM-BILLED         TO BBILLEDO.
 22453*    ELSE
 22454*       MOVE ZEROS                   TO BBILLEDO.
 22455
 22456     MOVE PB-CHG-COUNT               TO BCHGCNTO.
 22457
 22458     IF PB-I-LOAN-APR NOT = +99.9999
 22459        MOVE PB-I-LOAN-APR           TO BAPRO.
 22460
 22461     IF PB-I-MEMBER-NO  GREATER THAN SPACES
 22462        MOVE PB-I-MEMBER-NO          TO BMEMBERO.
 22463
 22464     IF PB-ORIGINAL-ENTRY-BATCH NOT = SPACES
 22465        IF PB-ORIGINAL-ENTRY-BATCH NOT = PB-ENTRY-BATCH
 22466           MOVE AL-SANOF                TO BORIGHDA
 22467           MOVE PB-ORIGINAL-ENTRY-BATCH TO BORGNOO
 22468           MOVE PB-ORIGINAL-SEQ-NO      TO BORGSEQO.
 22469
 22470     MOVE PI-LIFE-OVERRIDE-L2        TO BKIND (1).
 22471
 22472     IF PB-I-LF-CRIT-PER GREATER THAN ZEROS
 22473        MOVE PB-I-LF-CRIT-PER        TO BCRIT-PERDO (1).
 22474
 22475     IF PB-I-LF-INPUT-CD GREATER THAN SPACES
 22476        MOVE PB-I-LF-INPUT-CD        TO BTYPE (1)
 22477                                        PI-BTYPE (1).
 22478
 22479     IF PB-I-LF-TERM     GREATER THAN ZEROS
 22480        MOVE PB-I-LF-TERM            TO BTERMO (1).
 22481
 22482     IF PB-I-LF-BENEFIT-AMT GREATER THAN ZEROS
 22483        MOVE PB-I-LF-BENEFIT-AMT     TO BBENO  (1).
 22484
 22485     IF PB-I-LF-ALT-BENEFIT-AMT GREATER THAN ZEROS
 22486        MOVE PB-I-LF-ALT-BENEFIT-AMT TO BALT-BENO   (1).
 22487
 22488     IF PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
 22489        MOVE PB-I-LF-PREMIUM-AMT     TO BPREMO      (1).
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 413
* EL6311.cbl
 22490
 22491     IF PB-I-LF-ALT-PREMIUM-AMT GREATER THAN ZEROS
 22492        MOVE PB-I-LF-ALT-PREMIUM-AMT TO BALT-PREMO  (1).
 22493
 22494     IF PB-I-LF-EXPIRE-DT NOT = LOW-VALUES
 22495         MOVE PB-I-LF-EXPIRE-DT      TO DC-BIN-DATE-1
 22496         MOVE SPACE                  TO DC-OPTION-CODE
 22497         PERFORM 9700-DATE-LINK
 22498         IF NO-CONVERSION-ERROR
 22499            MOVE DC-GREG-DATE-1-EDIT TO BEXPIRE   (1).
 22500
 22501     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22502        MOVE PB-I-LF-BENEFIT-CD      TO BBEN-CD     (1)
 22503        MOVE PB-I-LF-ABBR            TO BBEN-ABBR   (1)
 22504        MOVE PB-I-LF-PREM-CALC       TO BCPREMO     (1)
 22505        SUBTRACT PB-I-LF-PREMIUM-AMT FROM PB-I-LF-PREM-CALC
 22506                 GIVING BDIFFO (1)
 22507     ELSE
 22508        MOVE SPACES                  TO BBEN-CD     (1)
 22509                                        BBEN-ABBR   (1).
 22510
 22511     IF PB-I-LF-ALT-PREMIUM-AMT GREATER THAN ZEROS
 22512        MOVE PB-I-LF-ALT-PREM-CALC   TO BCALT-PREM  (1)
 22513        SUBTRACT PB-I-LF-ALT-PREMIUM-AMT FROM
 22514                 PB-I-LF-ALT-PREM-CALC   GIVING BDALT-PREM (1).
 22515
 22516     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22517       IF PB-RECORD-ON-HOLD
 22518          MOVE 'ON HOLD'           TO BBILL-LIT     (1).
 22519
 22520     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22521       IF PB-RECORD-RETURNED
 22522          MOVE 'RETURNED'          TO BBILL-LIT     (1).
 22523
 22524     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22525        AND (PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH)
 22526             MOVE 'OVERRIDE'          TO BBILL-LIT  (1).
 22527
 22528     MOVE PI-AH-OVERRIDE-L2          TO BKIND       (2).
 22529
 22530     IF PB-I-AH-CRIT-PER GREATER THAN ZEROS
 22531        MOVE PB-I-AH-CRIT-PER        TO BCRIT-PERDO (2).
 22532
 22533     IF PB-I-AH-INPUT-CD GREATER THAN SPACES
 22534        MOVE PB-I-AH-INPUT-CD        TO BTYPE       (2)
 22535                                        PI-BTYPE (2).
 22536
 22537     IF PB-I-AH-TERM     GREATER THAN ZEROS
 22538        MOVE PB-I-AH-TERM            TO BTERMO      (2).
 22539
 22540     IF PB-I-AH-BENEFIT-AMT GREATER THAN ZEROS
 22541        MOVE PB-I-AH-BENEFIT-AMT     TO BBENO       (2).
 22542
 22543     IF PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 22544        MOVE PB-I-AH-PREMIUM-AMT     TO BPREMO      (2).
 22545
 22546     IF PB-I-TOT-FEES NOT NUMERIC
 22547        MOVE ZEROS               TO PB-I-TOT-FEES
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 414
* EL6311.cbl
 22548     END-IF
 22549     IF PB-I-TOT-FEES > ZEROS
 22550        MOVE PB-I-TOT-FEES       TO BALT-PREMO  (2).
 22551
 22552     IF PB-I-AH-EXPIRE-DT NOT = LOW-VALUES
 22553         MOVE PB-I-AH-EXPIRE-DT      TO DC-BIN-DATE-1
 22554         MOVE SPACE                  TO DC-OPTION-CODE
 22555         PERFORM 9700-DATE-LINK
 22556         IF NO-CONVERSION-ERROR
 22557            MOVE DC-GREG-DATE-1-EDIT TO BEXPIRE       (2).
 22558
 22559     IF PB-I-TOT-FEES > ZEROS
 22560        MOVE PB-I-TOT-FEES-CALC      TO BCALT-PREM  (2)
 22561        SUBTRACT PB-I-TOT-FEES FROM
 22562                 PB-I-TOT-FEES-CALC GIVING BDALT-PREM (2).
 22563
 22564     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22565        MOVE PB-I-AH-BENEFIT-CD      TO BBEN-CD     (2)
 22566        MOVE PB-I-AH-ABBR            TO BBEN-ABBR   (2)
 22567        MOVE PB-I-AH-PREM-CALC       TO BCPREMO     (2)
 22568        SUBTRACT PB-I-AH-PREMIUM-AMT FROM PB-I-AH-PREM-CALC
 22569                 GIVING BDIFFO (2)
 22570     ELSE
 22571        MOVE SPACES                  TO BBEN-CD     (2)
 22572                                        BBEN-ABBR   (2).
 22573
 22574     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22575       IF PB-RECORD-ON-HOLD
 22576          MOVE 'ON HOLD'           TO BBILL-LIT     (2).
 22577
 22578     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22579       IF PB-RECORD-RETURNED
 22580          MOVE 'RETURNED'          TO BBILL-LIT     (2).
 22581
 22582     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22583        AND (PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH)
 22584             MOVE 'OVERRIDE'          TO BBILL-LIT  (2).
 22585
 22586     MOVE PB-CSR-ID                  TO BCSRO.
 22587
 22588     IF PI-COMPANY-ID  =  'DMD'
 22589        IF (EC-NEW-CERT = SPACES OR LOW-VALUES)
 22590            NEXT SENTENCE
 22591        ELSE
 22592            IF (PB-CERT-NO  NOT =  EC-NEW-CERT)
 22593               MOVE 'NEW CERT'       TO BNCERTLI
 22594               MOVE EC-NEW-CERT      TO BNCERTO.
 22595
 22596     IF PI-COMPANY-ID  =  'DMD'
 22597        IF (EC-NEW-STATE = LOW-VALUES OR SPACES)
 22598            NEXT SENTENCE
 22599        ELSE
 22600           IF (PB-SV-STATE  NOT =  EC-NEW-STATE)
 22601               MOVE 'NEW STATE'      TO BNSTATLI
 22602               MOVE EC-NEW-STATE     TO BNSTATO.
 22603
 22604 7000-CONTINUE.
 22605     MOVE 'C'                        TO BMAINTI.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 415
* EL6311.cbl
 22606     MOVE AL-UANON                   TO BMAINTA.
 22607
 22608     IF PB-BATCH-CHG-SEQ-NO = ZEROS
 22609        PERFORM 7300-FORMAT-ERRORS THRU 7399-EXIT.
 22610
 22611     IF ARCHIVE-LETTER-RELEASED
 22612        PERFORM 7050-UPDATE-PENDING THRU 7050-EXIT
 22613     END-IF
 22614     IF PI-6315-FINALIZED = 'Y'   AND
 22615        PB-UNFORCED-ERRORS
 22616          MOVE -1                TO BFORCEL
 22617          MOVE  1                TO SET-CURSOR-SW
 22618     END-IF
 22619
 22620     IF NO-CURSOR-SET
 22621        MOVE -1                      TO BMAINTL.
 22622
 22623     GO TO 8100-SEND-INITIAL-MAP.
 22624
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 416
* EL6311.cbl
 22626
 22627 7050-UPDATE-PENDING.
 22628
 22629* EXEC CICS READ
 22630*        DATASET (FILE-ID-ERPNDB)
 22631*        INTO    (PENDING-BUSINESS)
 22632*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 22633*        UPDATE
 22634*    END-EXEC.
 22635     MOVE LENGTH OF
 22636      PENDING-BUSINESS
 22637       TO DFHEIV11
 22638*    MOVE '&"IL       EU         (   #00019031' TO DFHEIV0
 22639     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22640     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 22641     MOVE X'2020233030303139303331' TO DFHEIV0(25:11)
 22642     CALL 'kxdfhei1' USING DFHEIV0,
 22643           FILE-ID-ERPNDB,
 22644           PENDING-BUSINESS,
 22645           DFHEIV11,
 22646           PI-PREV-CONTROL-PRIMARY,
 22647           DFHEIV99,
 22648           DFHEIV99,
 22649           DFHEIV99
 22650     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22651
 22652
 22653     MOVE 'C' TO PB-I-LETTER-REQD
 22654     MOVE PB-I-LETTER-REQD       TO LETRREQO
 22655     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 22656     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 22657     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 22658     MOVE '5'                    TO DC-OPTION-CODE.
 22659     PERFORM 9700-DATE-LINK
 22660     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 22661
 22662
 22663* EXEC CICS REWRITE
 22664*        DATASET (FILE-ID-ERPNDB)
 22665*        FROM    (PENDING-BUSINESS)
 22666*    END-EXEC.
 22667     MOVE LENGTH OF
 22668      PENDING-BUSINESS
 22669       TO DFHEIV11
 22670*    MOVE '&& L                  %   #00019047' TO DFHEIV0
 22671     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 22672     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 22673     MOVE X'2020233030303139303437' TO DFHEIV0(25:11)
 22674     CALL 'kxdfhei1' USING DFHEIV0,
 22675           FILE-ID-ERPNDB,
 22676           PENDING-BUSINESS,
 22677           DFHEIV11,
 22678           DFHEIV99
 22679     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22680
 22681
 22682 7050-EXIT.
 22683      EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 417
* EL6311.cbl
 22684
 22685******************************************************************
 22686*                                                                *
 22687*             D I S P L A Y   C A N C E L S                      *
 22688*                                                                *
 22689******************************************************************
 22690
 22691 7100-DISPLAY-CANCELS.
 22692     IF PI-DISPLAY-ORIGINAL-BATCH
 22693        MOVE PB-CONTROL-BY-ORIG-BATCH TO PI-PREV-KEY
 22694        MOVE ZEROS                    TO PI-PREV-CHG-SEQ-NO
 22695     ELSE
 22696        MOVE PB-CONTROL-PRIMARY      TO PI-PREV-KEY.
 22697
 22698     MOVE PB-CONTROL-PRIMARY         TO PI-PREV-CONTROL-PRIMARY.
 22699
 22700     MOVE 'Y'                        TO WS-DISPLAY-SW.
 22701     MOVE 'Y'                        TO PI-DISPLAY-SCREEN-SW.
 22702
 22703     MOVE LOW-VALUES                 TO EL631CI.
 22704     MOVE EL631C                     TO PI-MAP-NAME.
 22705     MOVE 'Y'                        TO PI-BROWSE-SW.
 22706     MOVE PB-BATCH-SEQ-NO            TO CSEQO
 22707                                        PI-HIGH-SEQ-NO.
 22708
 22709     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 22710        MOVE AL-SABOF                TO CCHGTA
 22711        SUBTRACT PB-BATCH-CHG-SEQ-NO FROM 1000 GIVING CCHGO
 22712        MOVE AL-SANON                TO CCHGA
 22713      ELSE
 22714        MOVE AL-SADOF                TO CCHGTA
 22715                                        CCHGA
 22716        MOVE PB-CHG-COUNT            TO CCHGCNTO.
 22717
 22718*    MOVE PB-C-REFERENCE             TO CREFO.
 22719
 22720*    IF PB-C-MICROFILM-NO IS NUMERIC
 22721*       IF PB-C-MICROFILM-NO  NOT = ZEROS
 22722*          MOVE PB-C-MICROFILM-NO
 22723*                                TO CMICRNOO
 22724*          MOVE AL-UNNON         TO CMICRNOA
 22725*       END-IF
 22726*    END-IF
 22727     IF PB-C-INT-ON-REFS NUMERIC
 22728        IF PB-C-INT-ON-REFS NOT = ZEROS
 22729           MOVE PB-C-INT-ON-REFS
 22730                                 TO CNHINTO
 22731           MOVE AL-SANOF         TO CNHINTA
 22732        END-IF
 22733     END-IF
 22734     MOVE PB-CERT-PRIME              TO CCERTNOO.
 22735     MOVE PB-CERT-SFX                TO CSUFIXO.
 22736     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 22737     MOVE SPACE                      TO DC-OPTION-CODE.
 22738     PERFORM 9700-DATE-LINK.
 22739     MOVE DC-GREG-DATE-1-EDIT        TO CEFFDTO.
 22740
 22741     IF PB-C-LF-CANCEL-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 418
* EL6311.cbl
 22742        MOVE PB-C-LF-CANCEL-DT       TO DC-BIN-DATE-1
 22743        MOVE SPACE                   TO DC-OPTION-CODE
 22744        PERFORM 9700-DATE-LINK
 22745        IF NO-CONVERSION-ERROR
 22746           MOVE DC-GREG-DATE-1-EDIT  TO CCANDT1O.
 22747
 22748     IF PB-C-LF-REFUND-OVERRIDE EQUAL SPACES
 22749        NEXT SENTENCE
 22750     ELSE
 22751        MOVE PB-C-LF-REFUND-OVERRIDE TO CMTHD1I.
 22752
 22753     IF PB-C-AH-REFUND-OVERRIDE EQUAL SPACES
 22754        NEXT SENTENCE
 22755     ELSE
 22756        MOVE PB-C-AH-REFUND-OVERRIDE TO CMTHD2I.
 22757
 22758     IF PB-C-AH-CANCEL-DT   NOT = LOW-VALUES
 22759        MOVE PB-C-AH-CANCEL-DT       TO DC-BIN-DATE-1
 22760        MOVE SPACE                   TO DC-OPTION-CODE
 22761        PERFORM 9700-DATE-LINK
 22762        IF NO-CONVERSION-ERROR
 22763           MOVE DC-GREG-DATE-1-EDIT  TO CCANDT2O.
 22764
 22765     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 22766         MOVE PB-C-LF-CANCEL-AMT     TO CREFND1O.
 22767
 22768     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 22769         MOVE PB-C-AH-CANCEL-AMT     TO CREFND2O.
 22770
 22771     IF PB-C-LF-CANCEL-DT NOT = LOW-VALUES
 22772        MOVE PB-C-LF-REF-CALC        TO CCRFND1O
 22773        SUBTRACT PB-C-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC
 22774                 GIVING CDRFND1O.
 22775
 22776     IF PB-C-AH-CANCEL-DT NOT = LOW-VALUES
 22777        MOVE PB-C-AH-REF-CALC        TO CCRFND2O
 22778        SUBTRACT PB-C-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC
 22779                 GIVING CDRFND2O.
 22780
 22781     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 22782       IF PB-RECORD-ON-HOLD
 22783          MOVE 'ON HOLD'             TO CBILIT1O.
 22784
 22785     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 22786       IF PB-RECORD-RETURNED
 22787          MOVE 'RETURNED'            TO CBILIT1O.
 22788
 22789     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 22790        AND (PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH)
 22791             MOVE 'OVERRIDE'         TO CBILIT1O.
 22792
 22793     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 22794       IF PB-RECORD-ON-HOLD
 22795          MOVE 'ON HOLD'             TO CBILIT2O.
 22796
 22797     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 22798       IF PB-RECORD-RETURNED
 22799          MOVE 'RETURNED'            TO CBILIT2O.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 419
* EL6311.cbl
 22800
 22801     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 22802        AND (PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH)
 22803             MOVE 'OVERRIDE'         TO CBILIT2O.
 22804
 22805     MOVE PB-C-LAST-NAME             TO CLSTNMO.
 22806     MOVE PB-C-CANCEL-REASON         TO CCANREAO
 22807     MOVE PB-FORCE-CODE              TO CFORCEO.
 22808     MOVE PB-RECORD-BILL             TO CBILCDO.
 22809     MOVE PB-CI-LAST-NAME            TO CINAMEO.
 22810     MOVE SPACES                     TO CINITSO.
 22811     IF PB-CI-FIRST-NAME GREATER THAN SPACES
 22812         MOVE PB-CI-FIRST-NAME       TO CINITSO
 22813     ELSE
 22814         MOVE PB-CI-INITIALS         TO CINITSO
 22815     END-IF.
 22816
 22817     IF PB-CI-CANCEL-FEE NUMERIC
 22818        MOVE PB-CI-CANCEL-FEE        TO W-CANCEL-FEE-LONG
 22819        MOVE W-CANCEL-FEE-LONG       TO W-CANCEL-FEE
 22820     ELSE
 22821        MOVE ZEROES                  TO W-CANCEL-FEE.
 22822
 22823     MOVE W-CANCEL-FEE               TO CCANFEEO.
 22824
 22825     IF PB-CI-LF-PREMIUM-AMT NOT = ZEROS
 22826        ADD PB-CI-LF-PREMIUM-AMT
 22827             PB-CI-LF-ALT-PREMIUM-AMT  GIVING  CPREM1O.
 22828
 22829     IF PB-CI-AH-PREMIUM-AMT NOT = ZEROS
 22830        MOVE PB-CI-AH-PREMIUM-AMT       TO CPREM2O.
 22831
 22832     MOVE PB-CI-LF-TERM              TO CTERM1O.
 22833     MOVE PB-C-LF-REM-TERM           TO CRTERM1O.
 22834     MOVE PB-CI-AH-TERM              TO CTERM2O.
 22835     MOVE PB-C-AH-REM-TERM           TO CRTERM2O.
 22836
 22837     IF PB-C-LIVES NUMERIC
 22838        MOVE PB-C-LIVES              TO CLIVESO.
 22839
 22840     IF PB-C-PAYEE-CODE GREATER THAN SPACES
 22841        MOVE PB-C-PAYEE-CODE         TO CPAYEEO.
 22842
 22843     IF PB-CI-ENTRY-DT NOT = LOW-VALUES
 22844        MOVE PB-CI-ENTRY-DT          TO DC-BIN-DATE-1
 22845        MOVE SPACE                   TO DC-OPTION-CODE
 22846        PERFORM 9700-DATE-LINK
 22847        IF NO-CONVERSION-ERROR
 22848           MOVE DC-GREG-DATE-1-EDIT  TO CENTRDTO.
 22849
 22850     IF  PB-C-REFUND-CREATED
 22851         MOVE 'YES'                  TO CRFNDSWO
 22852     ELSE
 22853         IF PB-C-REFUND-REQUESTED
 22854            MOVE 'REQ'               TO CRFNDSWO
 22855         ELSE
 22856            MOVE 'NO'                TO CRFNDSWO.
 22857
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 420
* EL6311.cbl
 22858     MOVE PB-INPUT-DT                TO DC-BIN-DATE-1.
 22859     MOVE SPACE                      TO DC-OPTION-CODE.
 22860     PERFORM 9700-DATE-LINK.
 22861     MOVE DC-GREG-DATE-1-EDIT        TO CENTDTO.
 22862     MOVE PB-INPUT-BY                TO CENTBYO.
 22863
 22864     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 22865        MOVE PB-CREDIT-ACCEPT-DT     TO DC-BIN-DATE-1
 22866        MOVE SPACE                   TO DC-OPTION-CODE
 22867        PERFORM 9700-DATE-LINK
 22868        MOVE DC-GREG-DATE-1-EDIT     TO CMANTDTO
 22869        MOVE 'INACTIVE'              TO CMOENDTO
 22870     ELSE
 22871        MOVE PB-LAST-MAINT-DT        TO DC-BIN-DATE-1
 22872        MOVE SPACE                   TO DC-OPTION-CODE
 22873        PERFORM 9700-DATE-LINK
 22874        MOVE DC-GREG-DATE-1-EDIT     TO CMANTDTO
 22875        MOVE PB-CREDIT-SELECT-DT     TO DC-BIN-DATE-1
 22876        MOVE SPACE                   TO DC-OPTION-CODE
 22877        PERFORM 9700-DATE-LINK
 22878        MOVE DC-GREG-DATE-1-EDIT     TO CMOENDTO.
 22879
 22880     MOVE PB-LAST-MAINT-BY           TO CMANTBYO.
 22881
 22882     MOVE PB-LAST-MAINT-HHMMSS       TO WS-TIME.
 22883     MOVE WS-HR-MINS                 TO CMANTATO.
 22884
 22885     EVALUATE PB-LF-REFUND-TYPE
 22886        WHEN '1'
 22887           MOVE 'RULE78'            TO CLFREFNO
 22888        WHEN '2'
 22889           MOVE 'PRORAT'            TO CLFREFNO
 22890        WHEN '3'
 22891           MOVE 'CALIF'             TO CLFREFNO
 22892        WHEN '4'
 22893           MOVE 'IRREG'             TO CLFREFNO
 22894        WHEN '5'
 22895           MOVE 'NETPAY'            TO CLFREFNO
 22896        WHEN '6'
 22897           MOVE 'ATCP'              TO CLFREFNO
 22898        WHEN '7'
 22899           MOVE 'UTAH'              TO CLFREFNO
 22900        WHEN '8'
 22901           MOVE 'MEAN'              TO CLFREFNO
 22902        WHEN '9'
 22903           MOVE 'SUM '              TO CLFREFNO
 22904        WHEN 'B'
 22905           MOVE 'BALN'              TO CLFREFNO
 22906     END-EVALUATE.
 22907
 22908     EVALUATE TRUE
 22909        WHEN PB-AH-REFUND-TYPE =  '1'
 22910           MOVE 'RULE78'            TO CAHREFNO
 22911        WHEN PB-AH-REFUND-TYPE =  '2'
 22912           MOVE 'PRORAT'            TO CAHREFNO
 22913        WHEN PB-AH-REFUND-TYPE =  ('3' OR 'S')
 22914           MOVE 'CALIF'             TO CAHREFNO
 22915        WHEN PB-AH-REFUND-TYPE =  '4'
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 421
* EL6311.cbl
 22916           MOVE 'IRREG'             TO CAHREFNO
 22917        WHEN PB-AH-REFUND-TYPE =  '5'
 22918           MOVE 'NETPAY'            TO CAHREFNO
 22919        WHEN PB-AH-REFUND-TYPE =  '6'
 22920           MOVE 'ATCP'              TO CAHREFNO
 22921        WHEN PB-AH-REFUND-TYPE =  '7'
 22922           MOVE 'UTAH'              TO CAHREFNO
 22923        WHEN PB-AH-REFUND-TYPE =  '8'
 22924           MOVE 'MEAN'              TO CAHREFNO
 22925        WHEN PB-AH-REFUND-TYPE =  '9'
 22926           MOVE 'SUM '              TO CAHREFNO
 22927        WHEN PB-AH-REFUND-TYPE =  'B'
 22928           MOVE 'BALN'              TO CAHREFNO
 22929     END-EVALUATE.
 22930
 22931     MOVE PB-REIN-CD                 TO CREINCDO.
 22932
 22933     IF PB-ACCT-EFF-DT NOT = LOW-VALUES AND SPACES
 22934        MOVE PB-ACCT-EFF-DT          TO DC-BIN-DATE-1
 22935        MOVE SPACE                   TO DC-OPTION-CODE
 22936        PERFORM 9700-DATE-LINK
 22937        IF NO-CONVERSION-ERROR
 22938           MOVE DC-GREG-DATE-1-EDIT  TO CAEFFDTO.
 22939
 22940     IF PB-ACCT-EXP-DT  = HIGH-VALUES
 22941        MOVE 999999                  TO WS-EXP-DT-EDIT
 22942        INSPECT WS-EXP-DT-EDIT CONVERTING SPACES TO '/'
 22943        MOVE WS-EXP-DT-EDIT          TO CAEXPDTO
 22944     ELSE
 22945        IF PB-ACCT-EXP-DT NOT = LOW-VALUES
 22946           MOVE PB-ACCT-EXP-DT          TO DC-BIN-DATE-1
 22947           MOVE SPACE                   TO DC-OPTION-CODE
 22948           PERFORM 9700-DATE-LINK
 22949           IF NO-CONVERSION-ERROR
 22950              MOVE DC-GREG-DATE-1-EDIT  TO CAEXPDTO.
 22951
 22952     IF PB-ORIGINAL-ENTRY-BATCH NOT = SPACES
 22953        IF PB-ORIGINAL-ENTRY-BATCH NOT = PB-ENTRY-BATCH
 22954           MOVE AL-SANOF                TO CORIGHDA
 22955           MOVE PB-ORIGINAL-ENTRY-BATCH TO CORGNOO
 22956           MOVE PB-ORIGINAL-SEQ-NO      TO CORGSEQO.
 22957
 22958     MOVE PB-CSR-ID              TO CCSRO.
 22959
 22960     MOVE PB-CI-LIFE-COMMISSION  TO COMMLFO.
 22961     MOVE PB-CI-AH-COMMISSION    TO COMMAHO.
 22962     MOVE 'N'                    TO ACTSPCO
 22963     MOVE PB-CONTROL-BY-ACCOUNT  TO ERACNT-KEY
 22964     MOVE '2'                    TO ERACNT-REC-TYPE
 22965     MOVE +3                     TO ERACNT-SEQ-NO
 22966
 22967
 22968* EXEC CICS READ
 22969*         DATASET   ('ERACNT')
 22970*         INTO      (NOTE-FILE)
 22971*         RIDFLD    (ERACNT-KEY)
 22972*         RESP      (WS-RESPONSE)
 22973*    END-EXEC
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 422
* EL6311.cbl
 22974     MOVE LENGTH OF
 22975      NOTE-FILE
 22976       TO DFHEIV11
 22977     MOVE 'ERACNT' TO DFHEIV1
 22978*    MOVE '&"IL       E          (  N#00019337' TO DFHEIV0
 22979     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22980     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22981     MOVE X'204E233030303139333337' TO DFHEIV0(25:11)
 22982     CALL 'kxdfhei1' USING DFHEIV0,
 22983           DFHEIV1,
 22984           NOTE-FILE,
 22985           DFHEIV11,
 22986           ERACNT-KEY,
 22987           DFHEIV99,
 22988           DFHEIV99,
 22989           DFHEIV99
 22990     MOVE EIBRESP  TO WS-RESPONSE
 22991     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22992
 22993     IF RESP-NORMAL
 22994        IF NT-account-special = 'Y'
 22995           MOVE 'Y'              TO actspcO
 22996           MOVE ER-1762          TO EMI-ERROR
 22997           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22998        END-IF
 22999     END-IF
 23000     MOVE 'C'                    TO CMAINTI.
 23001     MOVE AL-UANON               TO CMAINTA.
 23002
 23003     IF PI-6316-FINALIZED = 'Y'  AND
 23004        PB-UNFORCED-ERRORS
 23005          MOVE -1                TO CFORCEL
 23006          MOVE  1                TO SET-CURSOR-SW
 23007     END-IF
 23008
 23009     IF PB-BATCH-CHG-SEQ-NO = ZEROS
 23010        PERFORM 7300-FORMAT-ERRORS THRU 7399-EXIT.
 23011
 23012     IF NO-CURSOR-SET
 23013        MOVE -1                  TO CMAINTL.
 23014
 23015     GO TO 8100-SEND-INITIAL-MAP.
 23016
 23017
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 423
* EL6311.cbl
 23019***************************************************************
 23020*     ROUTINE THAT MOVES ALL DATA FROM THE BATCH TOTAL        *
 23021*     RECORD TO THE BATCH TOTAL SCREEN.                       *
 23022***************************************************************
 23023
 23024 7200-DISPLAY-BATCHES.
 23025     MOVE EL631D                 TO PI-MAP-NAME.
 23026     MOVE LOW-VALUES             TO EL631DI.
 23027
 23028     MOVE 'Y'                    TO WS-DISPLAY-SW.
 23029
 23030
 23031* EXEC CICS HANDLE CONDITION
 23032*         NOTFND   (3690-NOT-FOUND)
 23033*    END-EXEC.
 23034*    MOVE '"$I                   ! T #00019381' TO DFHEIV0
 23035     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 23036     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 23037     MOVE X'5420233030303139333831' TO DFHEIV0(25:11)
 23038     CALL 'kxdfhei1' USING DFHEIV0
 23039     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23040
 23041
 23042     IF PI-DISPLAY-SCREEN
 23043        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 23044     ELSE
 23045        MOVE PB-CONTROL-PRIMARY  TO ERPNDB-KEY.
 23046
 23047     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 23048     MOVE +0                     TO ERPNDB-BATCH-CHG-SEQ-NO.
 23049
 23050
 23051* EXEC CICS READ
 23052*         DATASET   (FILE-ID-ERPNDB)
 23053*         RIDFLD    (ERPNDB-KEY)
 23054*         SET       (ADDRESS OF PENDING-BUSINESS)
 23055*    END-EXEC.
 23056*    MOVE '&"S        E          (   #00019393' TO DFHEIV0
 23057     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 23058     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 23059     MOVE X'2020233030303139333933' TO DFHEIV0(25:11)
 23060     CALL 'kxdfhei1' USING DFHEIV0,
 23061           FILE-ID-ERPNDB,
 23062           DFHEIV20,
 23063           DFHEIV99,
 23064           ERPNDB-KEY,
 23065           DFHEIV99,
 23066           DFHEIV99,
 23067           DFHEIV99
 23068     SET ADDRESS OF PENDING-BUSINESS TO
 23069         DFHEIV20
 23070     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23071
 23072
 23073     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 23074     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 23075     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 23076     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 424
* EL6311.cbl
 23077     MOVE PB-SV-STATE            TO PI-SV-STATE.
 23078
 23079     MOVE EL631D                 TO PI-MAP-NAME.
 23080     MOVE LOW-VALUES             TO EL631DI.
 23081     MOVE PB-ENTRY-BATCH         TO DBATCHO.
 23082
 23083*    IF PI-AR-PROCESSING
 23084*       MOVE PB-REFERENCE        TO DREFO.
 23085
 23086     MOVE PB-CSR-ID              TO DCSRO.
 23087
 23088     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 23089        MOVE PB-CREDIT-ACCEPT-DT TO DC-BIN-DATE-1
 23090        MOVE SPACE               TO DC-OPTION-CODE
 23091        PERFORM 9700-DATE-LINK
 23092        MOVE DC-GREG-DATE-1-EDIT TO DMAINDTO
 23093        MOVE AL-SABOF            TO DLDATEA  DMAINDTA
 23094        MOVE 'INACTIVE'          TO DLDATEO
 23095     ELSE
 23096        MOVE PB-LAST-MAINT-DT    TO DC-BIN-DATE-1
 23097        MOVE SPACE               TO DC-OPTION-CODE
 23098        PERFORM 9700-DATE-LINK
 23099        MOVE DC-GREG-DATE-1-EDIT TO DMAINDTO.
 23100
 23101     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.
 23102     MOVE SPACE                  TO DC-OPTION-CODE.
 23103     PERFORM 9700-DATE-LINK.
 23104     MOVE DC-GREG-DATE-1-EDIT    TO DINPUTO.
 23105
 23106     IF PB-B-RECEIVED-DT = SPACES OR LOW-VALUES
 23107        MOVE DC-GREG-DATE-1-EDIT TO DRECVDTO
 23108     ELSE
 23109        MOVE PB-B-RECEIVED-DT    TO DC-BIN-DATE-1
 23110        MOVE SPACE               TO DC-OPTION-CODE
 23111        PERFORM 9700-DATE-LINK
 23112        MOVE DC-GREG-DATE-1-EDIT TO DRECVDTO.
 23113
 23114     MOVE PB-CREDIT-SELECT-DT    TO DC-BIN-DATE-1.
 23115     MOVE SPACE                  TO DC-OPTION-CODE.
 23116     PERFORM 9700-DATE-LINK.
 23117     MOVE DC-GREG-DATE-1-EDIT        TO DPROCDTO.
 23118
 23119     MOVE PB-B-ISSUE-CNT-REMITTED    TO DRISSO.
 23120     MOVE PB-B-ISSUE-CNT-ENTERED     TO DEISSO.
 23121
 23122     IF PB-B-ISSUE-CNT-REMITTED NOT = PB-B-ISSUE-CNT-ENTERED
 23123        SUBTRACT PB-B-ISSUE-CNT-ENTERED FROM
 23124                 PB-B-ISSUE-CNT-REMITTED GIVING DOISSO.
 23125
 23126     MOVE PB-B-LF-ISS-PRM-REMITTED   TO DRLFPRMO.
 23127     MOVE PB-B-LF-ISS-PRM-ENTERED    TO DELFPRMO.
 23128     MOVE PB-B-LF-ISS-PRM-COMPUTED   TO DCLFPRMO.
 23129
 23130     IF PB-B-LF-ISS-PRM-ENTERED NOT = PB-B-LF-ISS-PRM-REMITTED
 23131        SUBTRACT PB-B-LF-ISS-PRM-ENTERED FROM
 23132                 PB-B-LF-ISS-PRM-REMITTED  GIVING DOLFPRMO.
 23133
 23134     MOVE PB-B-AH-ISS-PRM-REMITTED   TO DRAHPRMO.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 425
* EL6311.cbl
 23135     MOVE PB-B-AH-ISS-PRM-ENTERED    TO DEAHPRMO.
 23136     MOVE PB-B-AH-ISS-PRM-COMPUTED   TO DCAHPRMO.
 23137
 23138     IF PB-B-AH-ISS-PRM-ENTERED NOT = PB-B-AH-ISS-PRM-REMITTED
 23139        SUBTRACT PB-B-AH-ISS-PRM-ENTERED FROM
 23140                 PB-B-AH-ISS-PRM-REMITTED  GIVING DOAHPRMO.
 23141
 23142     MOVE PB-B-CANCEL-CNT-REMITTED     TO DRCANCO.
 23143     MOVE PB-B-CANCEL-CNT-ENTERED      TO DECANCO.
 23144
 23145     IF PB-B-CANCEL-CNT-REMITTED NOT = PB-B-CANCEL-CNT-ENTERED
 23146        SUBTRACT PB-B-CANCEL-CNT-ENTERED FROM
 23147                 PB-B-CANCEL-CNT-REMITTED GIVING DOCANCO.
 23148
 23149     MOVE PB-B-LF-CAN-PRM-REMITTED   TO DRLFRFDO.
 23150     MOVE PB-B-LF-CAN-PRM-ENTERED    TO DELFRFDO.
 23151     MOVE PB-B-LF-CAN-PRM-COMPUTED   TO DCLFRFDO.
 23152
 23153     IF PB-B-LF-CAN-PRM-ENTERED NOT = PB-B-LF-CAN-PRM-REMITTED
 23154        SUBTRACT PB-B-LF-CAN-PRM-ENTERED FROM
 23155                 PB-B-LF-CAN-PRM-REMITTED  GIVING DOLFRFDO.
 23156
 23157     MOVE PB-B-AH-CAN-PRM-REMITTED   TO DRAHRFDO.
 23158     MOVE PB-B-AH-CAN-PRM-ENTERED    TO DEAHRFDO.
 23159     MOVE PB-B-AH-CAN-PRM-COMPUTED   TO DCAHRFDO.
 23160
 23161     IF PB-B-AH-CAN-PRM-ENTERED NOT = PB-B-AH-CAN-PRM-REMITTED
 23162        SUBTRACT PB-B-AH-CAN-PRM-ENTERED FROM
 23163                 PB-B-AH-CAN-PRM-REMITTED  GIVING DOAHRFDO.
 23164
 23165     MOVE -1                     TO DPFENTRL.
 23166     GO TO 8100-SEND-INITIAL-MAP.
 23167
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 426
* EL6311.cbl
 23169
 23170***************************************************************
 23171*     THIS ROUTINE DETERMINES IF EL050 ENCOUNTERED ANY        *
 23172*     ERRORS.  IF ERRORS WERE DETECTED, THE ONLINE ERROR      *
 23173*     PROCESSING ROUTINE IS CALLED TO FORMAT THE ERROR        *
 23174*     MESSAGES AND ACCUMULATE TOTALS FOR THE DIFFERENT        *
 23175*     SEVERITY LEVELS. THE SEVERITY FLAGS WITHIN THE RECORDS  *
 23176*     ARE THEN SET ACCORDINGLY.                               *
 23177*         ERROR NUMBERS FOR THE STANDARD ERRORS START AT 2600 *
 23178*         ERROR NUMBERS FOR ISSUE TRANSACTIONS  START AT 2625 *
 23179*         ERROR NUMBERS FOR CANCEL TRANSACTIONS START AT 2725 *
 23180***************************************************************
 23181
 23182******************************************************************
 23183*                                                                *
 23184*            E R R O R   A N A L Y S I S                         *
 23185*                                                                *
 23186******************************************************************
 23187
 23188******************************************************************
 23189*                                                                *
 23190*   THIS ROUTINE DETERMINES IF EL050 (EDIT PROGRAM) ENCOUNTERED  *
 23191*   ANY ERRORS.  IF ERRORS WERE DETECTED, THE ROUTINE READS THE  *
 23192*   ERROR FILE TO DETERMINE THE SEVERITY OF THE ERRORS.  ONCE    *
 23193*   THE SEVERITY OF ERRORS IS ESTABLISHED THE APPROPRIATE ERROR  *
 23194*   FLAGS ARE SET (FORCIBLE, UNFORCIBLE, WARNING, ETC.).         *
 23195*                                                                *
 23196*   IF ANY UNFORCED OR FATAL ERRORS, OR RECORD IS RETURNED       *
 23197*   OR PLACED ON HOLD UPDATE THE CERTIFICATE ACCORDINGLY.        *
 23198*                                                                *
 23199******************************************************************
 23200
 23201 7300-FORMAT-ERRORS.
 23202     MOVE ' '                    TO PI-ERRORS-SW
 23203     IF PB-COMMON-ERRORS = LOW-VALUES
 23204        IF PB-FATAL-ERRORS
 23205           MOVE ER-2695          TO EMI-ERROR
 23206           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 23207           GO TO 7399-EXIT.
 23208
 23209     MOVE +0                     TO WS-SUB4
 23210     move +0                     to pi-6311-fatal-ctr
 23211     .
 23212 7310-ERROR-LOOP.
 23213
 23214     ADD +1                      TO WS-SUB4.
 23215
 23216     IF WS-SUB4 GREATER THAN PB-NO-OF-ERRORS
 23217        GO TO 7350-SET-ERROR-FLAGS.
 23218
 23219     IF PI-COMPANY-ID = 'UCL'
 23220         IF PB-COMMON-ERROR (WS-SUB4) = ER-2799
 23221             MOVE WS-CERT-EFF-DT        TO DC-BIN-DATE-1
 23222             MOVE ' '                   TO DC-OPTION-CODE
 23223             PERFORM 9700-DATE-LINK
 23224             MOVE DC-GREG-DATE-1-MDY    TO EMI-AH-OVERRIDE-L6.
 23225
 23226     MOVE PB-COMMON-ERROR (WS-SUB4) TO EMI-ERROR.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 427
* EL6311.cbl
 23227     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 23228     if (emi-fatal)
 23229        and (emi-error not = 1753 and 1754 and 1757 and
 23230                             1758 and 1759 and 1760)
 23231        add +1                   to pi-6311-fatal-ctr
 23232     end-if
 23233     PERFORM 7400-SET-ATTRIBUTES THRU 7499-EXIT.
 23234
 23235     GO TO 7310-ERROR-LOOP.
 23236
 23237
 23238 7350-SET-ERROR-FLAGS.
 23239
 23240     IF EMI-FATAL-CTR NOT = ZEROS
 23241        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 23242        MOVE 'X'                 TO PB-FATAL-FLAG
 23243                                    PI-ERRORS-SW
 23244        GO TO 7355-SET-ERROR-FLAGS.
 23245
 23246     move ' ' to pi-unforced-sw
 23247     IF EMI-FORCABLE-CTR NOT = ZEROS
 23248        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 23249        IF PB-ISSUE
 23250           IF PB-ISSUE-FORCE
 23251              MOVE 'F'           TO PB-FORCE-ER-CD
 23252              MOVE ER-2600       TO EMI-ERROR
 23253              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 23254             ELSE
 23255              MOVE 'X'           TO PB-FORCE-ER-CD
 23256*                                   PI-ERRORS-SW
 23257          ELSE
 23258           IF PB-CANCEL-FORCE OR PB-ALL-CANCEL-FORCED-NO-FEE
 23259              MOVE 'F'           TO PB-FORCE-ER-CD
 23260                                    pi-unforced-sw
 23261              MOVE ER-2600       TO EMI-ERROR
 23262              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 23263             ELSE
 23264              MOVE 'X'           TO PB-FORCE-ER-CD
 23265                                    pi-unforced-sw.
 23266*                                   PI-ERRORS-SW.
 23267
 23268     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ERENDT-KEY (1:33)
 23269     IF PB-ISSUE
 23270         MOVE 'I'                TO ENDT-RECORD-TYPE
 23271     ELSE
 23272         MOVE 'C'                TO ENDT-RECORD-TYPE
 23273     END-IF
 23274     MOVE +0                     TO ENDT-SEQ-NO
 23275
 23276
 23277* EXEC CICS READ
 23278*        DATASET   (FILE-ID-ERENDT)
 23279*        SET       (ADDRESS OF ENDORSEMENT-RECORD)
 23280*        RIDFLD    (ERENDT-KEY)
 23281*        RESP      (WS-RESPONSE)
 23282*        GTEQ
 23283*    END-EXEC
 23284*    MOVE '&"S        G          (  N#00019602' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 428
* EL6311.cbl
 23285     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 23286     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 23287     MOVE X'204E233030303139363032' TO DFHEIV0(25:11)
 23288     CALL 'kxdfhei1' USING DFHEIV0,
 23289           FILE-ID-ERENDT,
 23290           DFHEIV20,
 23291           DFHEIV99,
 23292           ERENDT-KEY,
 23293           DFHEIV99,
 23294           DFHEIV99,
 23295           DFHEIV99
 23296     SET ADDRESS OF ENDORSEMENT-RECORD TO
 23297         DFHEIV20
 23298     MOVE EIBRESP  TO WS-RESPONSE
 23299     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 23300
 23301     IF RESP-NORMAL
 23302        AND (EN-CONTROL-PRIMARY (1:34) = ERENDT-KEY (1:34))
 23303        IF EN-BATCH-NUMBER = PB-ENTRY-BATCH
 23304            MOVE ER-0280          TO EMI-ERROR
 23305            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 23306            MOVE EN-ARCHIVE-NO    TO ARCH-SUPPRESS
 23307            IF CALLED-FROM-6315
 23308               MOVE 'Y' TO WS-ARCHIVE-LETTER-SW
 23309            END-IF
 23310            EVALUATE TRUE
 23311              WHEN EMI-ERROR-NUMBER (1) EQUAL ER-0280
 23312                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (1)
 23313              WHEN EMI-ERROR-NUMBER (2) EQUAL ER-0280
 23314                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (2)
 23315              WHEN EMI-ERROR-NUMBER (3) EQUAL ER-0280
 23316                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (3)
 23317            END-EVALUATE
 23318        END-IF
 23319     END-IF
 23320
 23321
 23322
 23323     IF FIRST-ENTRY OR
 23324        EIBAID = DFHPF1 OR DFHPF2
 23325        MOVE '0'                TO PI-EDIT-SW
 23326        GO TO 7399-EXIT.
 23327
 23328 7355-SET-ERROR-FLAGS.
 23329
 23330     IF EMI-WARNING-CTR NOT = ZEROS
 23331        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 23332        MOVE 'W'                 TO PB-WARN-ER-CD.
 23333
 23334     IF PB-UNFORCED-ERRORS OR
 23335        PB-FATAL-ERRORS    OR
 23336        PB-RECORD-ON-HOLD  OR
 23337        PB-RECORD-RETURNED OR
 23338        PB-CANCELLATION
 23339          NEXT SENTENCE
 23340        ELSE
 23341          GO TO 7399-EXIT.
 23342
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 429
* EL6311.cbl
 23343
 23344* EXEC CICS  HANDLE CONDITION
 23345*           NOTFND   (7399-EXIT)
 23346*    END-EXEC.
 23347*    MOVE '"$I                   ! U #00019652' TO DFHEIV0
 23348     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 23349     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 23350     MOVE X'5520233030303139363532' TO DFHEIV0(25:11)
 23351     CALL 'kxdfhei1' USING DFHEIV0
 23352     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23353
 23354
 23355     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 23356     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 23357     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 23358     MOVE PB-SV-STATE            TO ELCERT-STATE.
 23359
 23360
 23361* EXEC CICS READ
 23362*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 23363*        DATASET (FILE-ID-ELCERT)
 23364*        RIDFLD  (ELCERT-KEY)
 23365*        UPDATE
 23366*    END-EXEC.
 23367*    MOVE '&"S        EU         (   #00019661' TO DFHEIV0
 23368     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 23369     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 23370     MOVE X'2020233030303139363631' TO DFHEIV0(25:11)
 23371     CALL 'kxdfhei1' USING DFHEIV0,
 23372           FILE-ID-ELCERT,
 23373           DFHEIV20,
 23374           DFHEIV99,
 23375           ELCERT-KEY,
 23376           DFHEIV99,
 23377           DFHEIV99,
 23378           DFHEIV99
 23379     SET ADDRESS OF CERTIFICATE-MASTER TO
 23380         DFHEIV20
 23381     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23382
 23383
 23384
 23385     MOVE CM-CREDIT-INTERFACE-SW-1         TO WS-SW-1
 23386     MOVE CM-CREDIT-INTERFACE-SW-2         TO WS-SW-2
 23387
 23388     IF (CERT-ADDED-BATCH OR CERT-PURGED-OFFLINE) AND PB-ISSUE
 23389        GO TO 7360-REWRITE-CERT-MASTER.
 23390
 23391     IF PB-ISSUE
 23392        IF PB-RECORD-RETURNED
 23393            MOVE '4'  TO CM-CREDIT-INTERFACE-SW-1
 23394            GO TO 7360-REWRITE-CERT-MASTER
 23395        ELSE
 23396            MOVE '2' TO CM-CREDIT-INTERFACE-SW-1
 23397            GO TO 7360-REWRITE-CERT-MASTER.
 23398
 23399     IF PB-RECORD-RETURNED
 23400         MOVE '7'      TO CM-CREDIT-INTERFACE-SW-2
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 430
* EL6311.cbl
 23401         GO TO 7360-REWRITE-CERT-MASTER.
 23402
 23403     IF (PB-C-LF-CANCEL-VOIDED)
 23404        or (pb-c-ah-cancel-voided)
 23405        IF (PB-UNFORCED-ERRORS OR
 23406            PB-FATAL-ERRORS    OR
 23407            PB-RECORD-ON-HOLD)
 23408            MOVE '6'             TO CM-CREDIT-INTERFACE-SW-2
 23409            GO TO 7360-REWRITE-CERT-MASTER
 23410        ELSE
 23411            MOVE '5'             TO CM-CREDIT-INTERFACE-SW-2
 23412            GO TO 7360-REWRITE-CERT-MASTER.
 23413
 23414     IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS
 23415                            OR PB-RECORD-ON-HOLD)
 23416        MOVE '4'                 TO CM-CREDIT-INTERFACE-SW-2
 23417     ELSE
 23418        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.
 23419
 23420 7360-REWRITE-CERT-MASTER.
 23421
 23422     IF WS-SW-1 = CM-CREDIT-INTERFACE-SW-1 AND
 23423        WS-SW-2 = CM-CREDIT-INTERFACE-SW-2
 23424
 23425* EXEC CICS UNLOCK
 23426*            DATASET    (FILE-ID-ELCERT)
 23427*       END-EXEC
 23428*    MOVE '&*                    #   #00019708' TO DFHEIV0
 23429     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 23430     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 23431     MOVE X'2020233030303139373038' TO DFHEIV0(25:11)
 23432     CALL 'kxdfhei1' USING DFHEIV0,
 23433           FILE-ID-ELCERT,
 23434           DFHEIV99
 23435     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 23436        GO TO 7399-EXIT.
 23437
 23438
 23439* EXEC CICS REWRITE
 23440*         DATASET    (FILE-ID-ELCERT)
 23441*         FROM       (CERTIFICATE-MASTER)
 23442*    END-EXEC.
 23443     MOVE LENGTH OF
 23444      CERTIFICATE-MASTER
 23445       TO DFHEIV11
 23446*    MOVE '&& L                  %   #00019713' TO DFHEIV0
 23447     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 23448     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 23449     MOVE X'2020233030303139373133' TO DFHEIV0(25:11)
 23450     CALL 'kxdfhei1' USING DFHEIV0,
 23451           FILE-ID-ELCERT,
 23452           CERTIFICATE-MASTER,
 23453           DFHEIV11,
 23454           DFHEIV99
 23455     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23456
 23457
 23458 7399-EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 431
* EL6311.cbl
 23459      EXIT.
 23460
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 432
* EL6311.cbl
 23462
 23463*************************************************************
 23464*                                                           *
 23465*              S E T   A T T R I B U T E S                  *
 23466*                                                           *
 23467*************************************************************
 23468
 23469 7400-SET-ATTRIBUTES.
 23470
 23471     IF WS-SUB4 GREATER THAN PB-NO-OF-ERRORS
 23472        GO TO 7499-EXIT.
 23473
 23474**2601**
 23475
 23476     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2601
 23477        IF PB-ISSUE
 23478           MOVE AL-UABON         TO BEFFDTA
 23479           GO TO 7499-EXIT
 23480         ELSE
 23481           MOVE AL-UABON         TO CEFFDTA
 23482           GO TO 7499-EXIT.
 23483
 23484**2604**
 23485
 23486     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2604
 23487        IF PB-ISSUE
 23488           MOVE AL-UABON         TO BTYPE1A
 23489           MOVE -1               TO BTYPE1L
 23490           MOVE  1               TO SET-CURSOR-SW
 23491           GO TO 7499-EXIT.
 23492
 23493**2605**
 23494
 23495     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2605
 23496        IF PB-ISSUE
 23497           MOVE AL-UABON         TO BTYPE2A
 23498           MOVE -1               TO BTYPE2L
 23499           MOVE  1               TO SET-CURSOR-SW
 23500           GO TO 7499-EXIT.
 23501
 23502**2606**
 23503
 23504     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2606
 23505        IF PB-ISSUE
 23506           MOVE AL-UABON         TO BSIGA
 23507           MOVE -1               TO BSIGL
 23508           MOVE  1               TO SET-CURSOR-SW
 23509           GO TO 7499-EXIT.
 23510
 23511**2607**
 23512
 23513     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2607
 23514        IF PB-ISSUE
 23515           MOVE AL-UABON         TO BSIGA
 23516           MOVE -1               TO BSIGL
 23517           MOVE  1               TO SET-CURSOR-SW
 23518           GO TO 7499-EXIT.
 23519
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 433
* EL6311.cbl
 23520**2615**
 23521
 23522     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2607
 23523        IF PB-ISSUE
 23524           MOVE AL-UABOF         TO BREINA
 23525           MOVE -1               TO BREINL
 23526           GO TO 7499-EXIT.
 23527
 23528**2622**
 23529
 23530     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2622
 23531        IF PB-ISSUE
 23532           MOVE AL-UABON         TO BEFFDTA
 23533           GO TO 7499-EXIT
 23534        ELSE
 23535           MOVE AL-UABON         TO CEFFDTA
 23536           GO TO 7499-EXIT.
 23537
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 434
* EL6311.cbl
 23539
 23540*************************************************************
 23541*                                                           *
 23542*              I S S U E   E R R O R S                      *
 23543*                                                           *
 23544*************************************************************
 23545
 23546 7420-ISSUE-ERRORS.
 23547
 23548     IF PB-COMMON-ERROR    (WS-SUB4) = ER-1577
 23549        MOVE -1                  TO LETRREQL
 23550        MOVE AL-UABOF            TO LETRREQA
 23551        MOVE  1                  TO SET-CURSOR-SW
 23552        GO TO 7499-EXIT.
 23553
 23554     IF PB-COMMON-ERROR    (WS-SUB4) = ER-1584
 23555        MOVE AL-UABOF            TO LETRREQA
 23556        GO TO 7499-EXIT.
 23557
 23558**2626**
 23559
 23560     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2626
 23561        MOVE AL-UABON            TO BCERTNOA
 23562        GO TO 7499-EXIT.
 23563
 23564**2627**
 23565
 23566     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2627
 23567        MOVE AL-UNBON            TO BAGEA
 23568        MOVE -1                  TO BAGEL
 23569        MOVE  1                  TO SET-CURSOR-SW
 23570        GO TO 7499-EXIT.
 23571
 23572**2628**
 23573
 23574     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2628
 23575        MOVE AL-UNBON            TO BAGEA
 23576        MOVE -1                  TO BAGEL
 23577        MOVE  1                  TO SET-CURSOR-SW
 23578        GO TO 7499-EXIT.
 23579
 23580**2629**
 23581
 23582     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2629
 23583        MOVE AL-UABON            TO BSEXA
 23584        MOVE -1                  TO BSEXL
 23585        MOVE  1                  TO SET-CURSOR-SW
 23586        GO TO 7499-EXIT.
 23587
 23588**2630**
 23589
 23590     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2630
 23591        MOVE -1                  TO BTYPE1L
 23592        MOVE  1                  TO SET-CURSOR-SW
 23593        GO TO 7499-EXIT.
 23594
 23595**2631**
 23596
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 435
* EL6311.cbl
 23597     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2631
 23598        MOVE -1                  TO BTYPE1L
 23599        MOVE  1                  TO SET-CURSOR-SW
 23600        GO TO 7499-EXIT.
 23601
 23602**2632**
 23603
 23604     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2632
 23605        MOVE AL-UNBON            TO BBEN1A
 23606        MOVE -1                  TO BBEN1L
 23607        MOVE  1                  TO SET-CURSOR-SW
 23608        GO TO 7499-EXIT.
 23609
 23610**2633**
 23611
 23612     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2633
 23613        MOVE AL-UNBON            TO BPREM1A
 23614        MOVE -1                  TO BPREM1L
 23615        MOVE  1                  TO SET-CURSOR-SW
 23616        GO TO 7499-EXIT.
 23617
 23618**2634**
 23619
 23620     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2634
 23621        MOVE -1                  TO BTYPE2L
 23622        MOVE  1                  TO SET-CURSOR-SW
 23623        GO TO 7499-EXIT.
 23624
 23625**2635**
 23626
 23627     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2635
 23628        MOVE AL-UNBON            TO BBEN2A
 23629        MOVE -1                  TO BBEN2L
 23630        MOVE  1                  TO SET-CURSOR-SW
 23631        GO TO 7499-EXIT.
 23632
 23633**2636**
 23634
 23635     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2636
 23636        MOVE AL-UNBON            TO BPREM2A
 23637        MOVE -1                  TO BPREM2L
 23638        MOVE  1                  TO SET-CURSOR-SW
 23639        GO TO 7499-EXIT.
 23640
 23641**2639**
 23642
 23643     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2639
 23644        MOVE AL-UNBON            TO BBEN1A
 23645        MOVE -1                  TO BBEN1L
 23646        MOVE  1                  TO SET-CURSOR-SW
 23647        GO TO 7499-EXIT.
 23648
 23649**2640**
 23650
 23651     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2640
 23652        MOVE AL-UNBON            TO BBEN2A
 23653        MOVE -1                  TO BBEN2L
 23654        MOVE  1                  TO SET-CURSOR-SW
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 436
* EL6311.cbl
 23655        GO TO 7499-EXIT.
 23656
 23657**2647**
 23658
 23659     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2647
 23660        MOVE AL-UNBON            TO BTERM1A
 23661        MOVE -1                  TO BTERM1L
 23662        MOVE  1                  TO SET-CURSOR-SW
 23663        GO TO 7499-EXIT.
 23664
 23665**2648**
 23666
 23667     IF PB-COMMON-ERROR (WS-SUB4) = ER-2648 OR ER-1575
 23668              or er-3070
 23669        MOVE AL-UNBON            TO BLNTRMA
 23670        MOVE -1                  TO BLNTRML
 23671        MOVE  1                  TO SET-CURSOR-SW
 23672        GO TO 7499-EXIT.
 23673
 23674**2649**
 23675
 23676     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2649
 23677        AND PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
 23678            MOVE AL-UNBON            TO BPREM1A
 23679            MOVE -1                  TO BPREM1L
 23680            MOVE  1                  TO SET-CURSOR-SW
 23681            GO TO 7499-EXIT
 23682     ELSE
 23683        IF PB-COMMON-ERROR    (WS-SUB4) = ER-2649
 23684           AND PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 23685            MOVE AL-UNBON            TO BPREM2A
 23686            MOVE -1                  TO BPREM2L
 23687            MOVE  1                  TO SET-CURSOR-SW
 23688            GO TO 7499-EXIT.
 23689
 23690**2650**
 23691
 23692     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2650
 23693        IF  PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
 23694            MOVE AL-UNBON        TO BPREM1A
 23695            MOVE -1              TO BPREM1L
 23696            MOVE  1              TO SET-CURSOR-SW
 23697            IF  PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 23698                MOVE AL-UNBON        TO BPREM2A
 23699                MOVE -1              TO BPREM2L
 23700                MOVE  1              TO SET-CURSOR-SW
 23701                GO TO 7499-EXIT
 23702            ELSE
 23703                GO TO 7499-EXIT
 23704        ELSE
 23705            IF  PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 23706                MOVE AL-UNBON        TO BPREM2A
 23707                MOVE -1              TO BPREM2L
 23708                MOVE  1              TO SET-CURSOR-SW
 23709                GO TO 7499-EXIT
 23710            ELSE
 23711                GO TO 7499-EXIT.
 23712
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 437
* EL6311.cbl
 23713**2651**
 23714
 23715     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2651
 23716        MOVE AL-UABON            TO BSIGA
 23717        MOVE -1                  TO BSIGL
 23718        MOVE  1                  TO SET-CURSOR-SW
 23719        GO TO 7499-EXIT.
 23720
 23721**2653**
 23722
 23723     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2653
 23724        MOVE AL-UABON            TO BFREQA
 23725        MOVE -1                  TO BFREQL
 23726        MOVE  1                  TO SET-CURSOR-SW
 23727        GO TO 7499-EXIT.
 23728
 23729**2654**
 23730
 23731     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2654
 23732        MOVE AL-UABON            TO BFREQA
 23733        MOVE -1                  TO BFREQL
 23734        MOVE  1                  TO SET-CURSOR-SW
 23735        GO TO 7499-EXIT.
 23736
 23737**2655**
 23738
 23739     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2655
 23740        MOVE AL-UABON            TO BFREQA
 23741        MOVE -1                  TO BFREQL
 23742        MOVE  1                  TO SET-CURSOR-SW
 23743        GO TO 7499-EXIT.
 23744
 23745**2656**
 23746
 23747     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2656
 23748        MOVE AL-UNBON            TO BAPRA
 23749        MOVE -1                  TO BAPRL
 23750        MOVE  1                  TO SET-CURSOR-SW
 23751        GO TO 7499-EXIT.
 23752
 23753**2657**
 23754
 23755     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2657
 23756        MOVE AL-UNBON            TO BAPRA
 23757        MOVE -1                  TO BAPRL
 23758        MOVE  1                  TO SET-CURSOR-SW
 23759        GO TO 7499-EXIT.
 23760
 23761**2658**
 23762
 23763     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2657
 23764        MOVE AL-UNBON            TO BTERM2A
 23765        MOVE -1                  TO BTERM2L
 23766        MOVE  1                  TO SET-CURSOR-SW
 23767        GO TO 7499-EXIT.
 23768
 23769**2660**
 23770
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 438
* EL6311.cbl
 23771     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2660
 23772        MOVE AL-UABON            TO BLSTNMA B1STNMA BINITA
 23773        MOVE -1                  TO BLSTNML
 23774        MOVE  1                  TO SET-CURSOR-SW
 23775        GO TO 7499-EXIT.
 23776
 23777
 23778**2662**
 23779
 23780     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2662
 23781        MOVE AL-UNBON            TO BAGEA
 23782        MOVE -1                  TO BAGEL
 23783        MOVE  1                  TO SET-CURSOR-SW
 23784        GO TO 7499-EXIT.
 23785
 23786**2663**
 23787
 23788     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2663
 23789        MOVE AL-UNBON            TO BAGEA
 23790        MOVE -1                  TO BAGEL
 23791        MOVE  1                  TO SET-CURSOR-SW
 23792        GO TO 7499-EXIT.
 23793
 23794**2664**
 23795
 23796     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2664
 23797        MOVE AL-UABON            TO BREINA
 23798        MOVE -1                  TO BREINL
 23799        MOVE  1                  TO SET-CURSOR-SW
 23800        GO TO 7499-EXIT.
 23801
 23802**2667**
 23803
 23804     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2667
 23805        MOVE AL-UNBON            TO BBEN2A
 23806        MOVE -1                  TO BBEN2L
 23807        MOVE  1                  TO SET-CURSOR-SW
 23808        GO TO 7499-EXIT.
 23809
 23810**2668**
 23811
 23812     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2668
 23813        MOVE AL-UABON            TO BEFFDTA
 23814        GO TO 7499-EXIT.
 23815
 23816**2669**
 23817
 23818     IF PB-COMMON-ERROR (WS-SUB4) = ER-2669 OR ER-1570
 23819       OR ER-2077 OR ER-2628 OR ER-2661 OR ER-3054 OR ER-3504
 23820       OR ER-3513 OR ER-7144 OR ER-9063 OR ER-9076 OR ER-9618
 23821        MOVE AL-UNBON            TO BAGEA
 23822        MOVE -1                  TO BAGEL
 23823        MOVE  1                  TO SET-CURSOR-SW
 23824        GO TO 7499-EXIT.
 23825
 23826**2670**
 23827
 23828     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2670
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 439
* EL6311.cbl
 23829        MOVE AL-UABON            TO BFORCEA
 23830        MOVE -1                  TO BFORCEL
 23831        MOVE  1                  TO SET-CURSOR-SW
 23832        GO TO 7499-EXIT.
 23833
 23834**2671**
 23835
 23836     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2671
 23837        MOVE AL-UABON            TO BEFFDTA
 23838        GO TO 7499-EXIT.
 23839
 23840**2672**
 23841
 23842     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2672
 23843        MOVE AL-UABON            TO BEFFDTA
 23844        GO TO 7499-EXIT.
 23845
 23846**2673**
 23847
 23848     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2673
 23849        MOVE AL-UABON            TO BEFFDTA
 23850        GO TO 7499-EXIT.
 23851
 23852**2674**
 23853
 23854     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2673
 23855        MOVE AL-UABON            TO BTYPE1A BTYPE2A
 23856        MOVE -1                  TO BTYPE1L
 23857        MOVE  1                  TO SET-CURSOR-SW
 23858        GO TO 7499-EXIT.
 23859
 23860**2677**
 23861
 23862     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2677
 23863        MOVE AL-UNBON            TO BTERM1A
 23864        MOVE -1                  TO BTERM1L
 23865        MOVE  1                  TO SET-CURSOR-SW
 23866        GO TO 7499-EXIT.
 23867
 23868**2678**
 23869
 23870     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2678
 23871        MOVE AL-UNBON            TO BTERM2A
 23872        MOVE -1                  TO BTERM2L
 23873        MOVE  1                  TO SET-CURSOR-SW
 23874        GO TO 7499-EXIT.
 23875
 23876**2679**
 23877
 23878     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2679
 23879        MOVE AL-UABON            TO BTYPE1A
 23880        MOVE -1                  TO BTYPE1L
 23881        MOVE  1                  TO SET-CURSOR-SW
 23882        GO TO 7499-EXIT.
 23883
 23884**2680**
 23885
 23886     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2680
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 440
* EL6311.cbl
 23887        MOVE AL-UABOF            TO B1STPMTA
 23888        MOVE -1                  TO B1STPMTL
 23889        MOVE  1                  TO SET-CURSOR-SW
 23890        GO TO 7499-EXIT.
 23891
 23892**2681**
 23893
 23894     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2681
 23895        MOVE AL-UABON            TO BDAYSA
 23896        MOVE -1                  TO BDAYSL
 23897        MOVE  1                  TO SET-CURSOR-SW
 23898        GO TO 7499-EXIT.
 23899
 23900**2682**
 23901
 23902     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2682
 23903        MOVE AL-UABON            TO BTERM1A
 23904        MOVE -1                  TO BTERM1L
 23905        MOVE  1                  TO SET-CURSOR-SW
 23906        GO TO 7499-EXIT.
 23907
 23908**2683**
 23909
 23910     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2683
 23911        MOVE AL-UABON            TO BSKPCDA
 23912        MOVE -1                  TO BSKPCDL
 23913        MOVE  1                  TO SET-CURSOR-SW
 23914        GO TO 7499-EXIT.
 23915
 23916**2684**
 23917
 23918     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2684
 23919        MOVE AL-UABON            TO BTYPE2A
 23920        MOVE -1                  TO BTYPE2L
 23921        MOVE  1                  TO SET-CURSOR-SW
 23922        GO TO 7499-EXIT.
 23923
 23924**2686**
 23925
 23926     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2686
 23927        MOVE AL-UABON            TO BTYPE2A
 23928        MOVE -1                  TO BTYPE2L
 23929        MOVE  1                  TO SET-CURSOR-SW
 23930        GO TO 7499-EXIT.
 23931
 23932**2689**
 23933
 23934     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2689
 23935        MOVE AL-UABON            TO BSIGA
 23936        MOVE -1                  TO BSIGL
 23937        MOVE  1                  TO SET-CURSOR-SW
 23938        GO TO 7499-EXIT.
 23939
 23940**2690**
 23941
 23942     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2690
 23943        MOVE AL-UABOF            TO BLNOFCRA
 23944        MOVE -1                  TO BLNOFCRL
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 441
* EL6311.cbl
 23945        MOVE  1                  TO SET-CURSOR-SW
 23946        GO TO 7499-EXIT.
 23947
 23948**2693**
 23949
 23950     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2693
 23951        MOVE AL-UABOF            TO BLNOFCRA
 23952        MOVE AL-UNBON            TO BBEN1A
 23953        MOVE -1                  TO BBEN1L
 23954        MOVE  1                  TO SET-CURSOR-SW
 23955        GO TO 7499-EXIT.
 23956
 23957**2720**
 23958
 23959     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2720
 23960        MOVE AL-UNBON            TO BBEN1A
 23961        MOVE -1                  TO BBEN1L
 23962        MOVE  1                  TO SET-CURSOR-SW
 23963        GO TO 7499-EXIT.
 23964
 23965**2709**
 23966
 23967*    IF PB-COMMON-ERROR    (WS-SUB4) = ER-2709
 23968*       MOVE AL-UNBON            TO BBEN1A
 23969*       MOVE -1                  TO BBEN1L
 23970*       MOVE  1                  TO SET-CURSOR-SW
 23971*       GO TO 7499-EXIT.
 23972
 23973*************************************************************
 23974*                                                           *
 23975*            C A N C E L   E R R O R S                      *
 23976*                                                           *
 23977*************************************************************
 23978
 23979**2726**
 23980
 23981     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2726
 23982        MOVE AL-UABON            TO CCERTNOA
 23983        GO TO 7499-EXIT.
 23984
 23985**2728**
 23986
 23987     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2728
 23988        MOVE AL-UABON            TO CCERTNOA
 23989        GO TO 7499-EXIT.
 23990
 23991**2729**
 23992
 23993     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2729
 23994        MOVE AL-UABON            TO CCERTNOA
 23995        GO TO 7499-EXIT.
 23996
 23997**2730**
 23998
 23999     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2729
 24000        MOVE AL-UABON            TO CCERTNOA
 24001        GO TO 7499-EXIT.
 24002
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 442
* EL6311.cbl
 24003**2731**
 24004
 24005     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2731
 24006        MOVE AL-UABON            TO CCANDT1A
 24007        MOVE -1                  TO CCANDT1L
 24008        MOVE  1                  TO SET-CURSOR-SW
 24009        GO TO 7499-EXIT.
 24010
 24011**2732**
 24012
 24013     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2732
 24014        MOVE AL-UABON            TO CCANDT1A
 24015        MOVE -1                  TO CCANDT1L
 24016        MOVE  1                  TO SET-CURSOR-SW
 24017        GO TO 7499-EXIT.
 24018
 24019**2733**
 24020
 24021     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2733
 24022        MOVE AL-UABON            TO CCANDT1A
 24023        MOVE -1                  TO CCANDT1L
 24024        MOVE  1                  TO SET-CURSOR-SW
 24025        GO TO 7499-EXIT.
 24026
 24027**2734**
 24028
 24029     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2733
 24030        MOVE AL-UNBON            TO CREFND1A
 24031        MOVE -1                  TO CREFND1L
 24032        MOVE  1                  TO SET-CURSOR-SW
 24033        GO TO 7499-EXIT.
 24034
 24035**2735**
 24036
 24037     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2735
 24038        MOVE AL-UABON            TO CCANDT2A
 24039        MOVE -1                  TO CCANDT2L
 24040        MOVE  1                  TO SET-CURSOR-SW
 24041        GO TO 7499-EXIT.
 24042
 24043**2736**
 24044
 24045     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2735
 24046        IF  PB-C-LF-CANCEL-AMT GREATER THAN ZEROS
 24047            MOVE AL-UNBON        TO CREFND1A
 24048            MOVE -1              TO CREFND1L
 24049            MOVE  1              TO SET-CURSOR-SW
 24050            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 24051                MOVE AL-UNBON        TO CREFND2A
 24052                MOVE -1              TO CREFND2L
 24053                MOVE  1              TO SET-CURSOR-SW
 24054                GO TO 7499-EXIT
 24055            ELSE
 24056                GO TO 7499-EXIT
 24057        ELSE
 24058            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 24059                MOVE AL-UNBON        TO CREFND2A
 24060                MOVE -1              TO CREFND2L
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 443
* EL6311.cbl
 24061                MOVE  1              TO SET-CURSOR-SW
 24062                GO TO 7499-EXIT
 24063            ELSE
 24064                GO TO 7499-EXIT.
 24065
 24066**2738**
 24067
 24068     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 24069        MOVE -1                  TO CREFND2L
 24070        MOVE  1                  TO SET-CURSOR-SW
 24071        GO TO 7499-EXIT.
 24072
 24073**2739**
 24074
 24075     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 24076        MOVE -1                  TO CREFND1L
 24077        MOVE  1                  TO SET-CURSOR-SW
 24078        GO TO 7499-EXIT.
 24079
 24080**2741**
 24081
 24082     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 24083        MOVE -1                  TO CREFND1L
 24084        MOVE  1                  TO SET-CURSOR-SW
 24085        GO TO 7499-EXIT.
 24086
 24087**2743**
 24088
 24089     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2743
 24090        MOVE AL-UNBON            TO CCANDT1A
 24091        MOVE -1                  TO CCANDT1L
 24092        MOVE  1                  TO SET-CURSOR-SW
 24093        GO TO 7499-EXIT.
 24094
 24095**2744**
 24096
 24097     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2744
 24098        MOVE AL-UNBON            TO CCANDT2A
 24099        MOVE -1                  TO CCANDT2L
 24100        MOVE  1                  TO SET-CURSOR-SW
 24101        GO TO 7499-EXIT.
 24102
 24103**2747**
 24104
 24105     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2747
 24106        MOVE AL-UABON            TO CLSTNMA
 24107        MOVE -1                  TO CLSTNML
 24108        MOVE  1                  TO SET-CURSOR-SW
 24109        GO TO 7499-EXIT.
 24110
 24111**2749**
 24112
 24113     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2749
 24114        MOVE AL-UABON            TO CFORCEA
 24115        MOVE -1                  TO CFORCEL
 24116        MOVE  1                  TO SET-CURSOR-SW
 24117        GO TO 7499-EXIT.
 24118
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 444
* EL6311.cbl
 24119**2753**
 24120
 24121     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2753
 24122        MOVE AL-UNBON            TO CCANDT1A
 24123        MOVE -1                  TO CCANDT1L
 24124        MOVE  1                  TO SET-CURSOR-SW
 24125        GO TO 7499-EXIT.
 24126
 24127**2755**
 24128
 24129     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2755
 24130        IF  PB-C-LF-CANCEL-AMT GREATER THAN ZEROS
 24131            MOVE AL-UNBON        TO CREFND1A
 24132            MOVE -1              TO CREFND1L
 24133            MOVE  1              TO SET-CURSOR-SW
 24134            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 24135                MOVE AL-UNBON        TO CREFND2A
 24136                MOVE -1              TO CREFND2L
 24137                MOVE  1              TO SET-CURSOR-SW
 24138                GO TO 7499-EXIT
 24139            ELSE
 24140                GO TO 7499-EXIT
 24141        ELSE
 24142            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 24143                MOVE AL-UNBON        TO CREFND2A
 24144                MOVE -1              TO CREFND2L
 24145                MOVE  1              TO SET-CURSOR-SW
 24146            ELSE
 24147                GO TO 7499-EXIT.
 24148
 24149**2757**
 24150
 24151     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2757
 24152        MOVE AL-UNBON            TO CLIVESA
 24153        MOVE -1                  TO CLIVESL
 24154        MOVE  1                  TO SET-CURSOR-SW
 24155        GO TO 7499-EXIT.
 24156
 24157**2771**
 24158
 24159     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2771
 24160        MOVE AL-UABON            TO CCANDT2A
 24161        MOVE -1                  TO CCANDT2L
 24162        MOVE  1                  TO SET-CURSOR-SW
 24163        GO TO 7499-EXIT.
 24164
 24165**2774**
 24166
 24167     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2774
 24168        MOVE AL-UABON            TO CCANDT1A
 24169        MOVE -1                  TO CCANDT1L
 24170        MOVE  1                  TO SET-CURSOR-SW
 24171        GO TO 7499-EXIT.
 24172
 24173**2775**
 24174
 24175     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2775
 24176        MOVE AL-UABON            TO CCANDT2A
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 445
* EL6311.cbl
 24177        MOVE -1                  TO CCANDT2L
 24178        MOVE  1                  TO SET-CURSOR-SW
 24179        GO TO 7499-EXIT.
 24180
 24181**2776**
 24182
 24183     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2776
 24184        MOVE AL-UABON            TO CCANDT1A
 24185        MOVE -1                  TO CCANDT1L
 24186        MOVE  1                  TO SET-CURSOR-SW
 24187        GO TO 7499-EXIT.
 24188
 24189
 24190**2777**
 24191
 24192     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2777
 24193        MOVE AL-UABON            TO CCANDT2A
 24194        MOVE -1                  TO CCANDT2L
 24195        MOVE  1                  TO SET-CURSOR-SW
 24196        GO TO 7499-EXIT.
 24197
 24198**2794**
 24199
 24200     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2794
 24201        MOVE AL-UABON            TO CFORCEA
 24202        MOVE -1                  TO CFORCEL
 24203        MOVE  1                  TO SET-CURSOR-SW
 24204        GO TO 7499-EXIT.
 24205
 24206**2799**
 24207
 24208     IF PI-COMPANY-ID = 'UCL'
 24209         IF PB-COMMON-ERROR    (WS-SUB4) = ER-2799
 24210             MOVE AL-UNBON            TO BEFFDTA
 24211             MOVE -1                  TO BEFFDTL
 24212             MOVE  1                  TO SET-CURSOR-SW
 24213             GO TO 7499-EXIT.
 24214
 24215 7499-EXIT.
 24216      EXIT.
 24217
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 446
* EL6311.cbl
 24219
 24220 7500-READ-ERLOFC.
 24221     MOVE SPACES                 TO  WS-LOAN-OFFICER
 24222                                     ERLOFC-KEY.
 24223
 24224     MOVE PI-COMPANY-CD          TO  ERLOFC-COMPANY-CD.
 24225
 24226     IF ST-ACCNT-CNTL
 24227         MOVE PI-SV-STATE        TO  ERLOFC-STATE.
 24228
 24229     IF CARR-GROUP-ST-ACCNT-CNTL
 24230         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER
 24231         MOVE PI-SV-STATE        TO  ERLOFC-STATE
 24232         MOVE PI-SV-GROUPING     TO  ERLOFC-GROUPING.
 24233
 24234     IF CARR-ST-ACCNT-CNTL
 24235         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER
 24236         MOVE PI-SV-STATE        TO  ERLOFC-STATE.
 24237
 24238     IF CARR-ACCNT-CNTL
 24239         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER.
 24240
 24241     MOVE PI-PB-ACCOUNT          TO  ERLOFC-ACCOUNT.
 24242
 24243     MOVE BLNOFCRI               TO ERLOFC-OFFICER-CODE.
 24244
 24245
 24246* EXEC CICS HANDLE CONDITION
 24247*        NOTFND   (7550-OFFICER-NOTFND)
 24248*    END-EXEC.
 24249*    MOVE '"$I                   ! V #00020505' TO DFHEIV0
 24250     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 24251     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 24252     MOVE X'5620233030303230353035' TO DFHEIV0(25:11)
 24253     CALL 'kxdfhei1' USING DFHEIV0
 24254     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24255
 24256
 24257
 24258* EXEC CICS READ
 24259*        DATASET   (FILE-ID-ERLOFC)
 24260*        SET       (ADDRESS OF LOAN-OFFICER-MASTER)
 24261*        RIDFLD    (ERLOFC-KEY)
 24262*        EQUAL
 24263*    END-EXEC.
 24264*    MOVE '&"S        E          (   #00020509' TO DFHEIV0
 24265     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 24266     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24267     MOVE X'2020233030303230353039' TO DFHEIV0(25:11)
 24268     CALL 'kxdfhei1' USING DFHEIV0,
 24269           FILE-ID-ERLOFC,
 24270           DFHEIV20,
 24271           DFHEIV99,
 24272           ERLOFC-KEY,
 24273           DFHEIV99,
 24274           DFHEIV99,
 24275           DFHEIV99
 24276     SET ADDRESS OF LOAN-OFFICER-MASTER TO
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 447
* EL6311.cbl
 24277         DFHEIV20
 24278     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24279
 24280
 24281     GO TO 7599-EXIT.
 24282
 24283 7550-OFFICER-NOTFND.
 24284     MOVE 'X'                    TO WS-LOAN-OFFICER.
 24285
 24286 7599-EXIT.
 24287      EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 448
* EL6311.cbl
 24289******************************************************************
 24290*                                                                *
 24291*            S  E N D    I N I T I A L   M A P                   *
 24292*                                                                *
 24293******************************************************************
 24294
 24295 8100-SEND-INITIAL-MAP.
 24296     MOVE EIBTIME                TO TIME-IN.
 24297
 24298     IF EIBAID = DFHPF11
 24299        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 24300        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 24301
 24302
 24303     IF PI-COMPANY-ID = CLIENT-GIC
 24304        MOVE AL-UNNOF               TO BCPREM-ATTRB (1)
 24305                                       BCPREM-ATTRB (2).
 24306
 24307     IF PI-COMPANY-ID = (CLIENT-MIC OR
 24308                         CLIENT-PEM OR
 24309                         CLIENT-CSO)
 24310        AND PI-DISPLAY-ORIGINAL-BATCH
 24311          IF PI-MAP-NAME = EL631B
 24312             MOVE AL-SADOF               TO BPF5HDRA
 24313                                            BPF4HDRA
 24314          ELSE
 24315             IF PI-MAP-NAME = EL631C
 24316                MOVE AL-SADOF            TO CPF5HDRA
 24317                                            CPF4HDRA.
 24318
 24319     IF PI-MAP-NAME = EL631B
 24320        MOVE AL-SADOF               TO BPF5HDRA
 24321     ELSE
 24322        MOVE AL-SADOF               TO CPF5HDRA
 24323     END-IF
 24324
 24325*DMD CUSTOM CODING*************START    DO IT WHEN SCREEN=EL631B &
 24326     IF PI-MAP-NAME = EL631B
 24327          IF PI-COMPANY-ID NOT = 'DMD'
 24328             MOVE AL-SANOF            TO BBILLEDA
 24329             MOVE AL-SADOF            TO DMDBILA.
 24330*DMD CUSTOM CODING*************END
 24331
 24332     IF PI-PROCESSOR-ID = 'LGXX'
 24333        IF PI-MAP-NAME = EL631B
 24334           MOVE AL-SABOF                    TO BREFHDGA
 24335           MOVE AL-SANOF                    TO BREFA
 24336        ELSE
 24337           IF PI-MAP-NAME = EL631C
 24338              MOVE AL-SABOF                 TO CREFHDGA
 24339              MOVE AL-SANOF                 TO CREFA.
 24340
 24341     IF PI-COMPANY-ID = 'ACE' or 'LGX' or 'DCC' or 'VPP'
 24342        continue
 24343     ELSE
 24344        IF PI-MAP-NAME = EL631C
 24345           MOVE AL-SADOF         TO CCANTXTA
 24346                                    CCANFEEA
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 449
* EL6311.cbl
 24347        end-if
 24348     end-if
 24349     IF PI-MAP-NAME = EL631D
 24350        IF PI-AR-PROCESSING
 24351           MOVE AL-SANOF            TO DREFHDGA
 24352        ELSE
 24353           MOVE AL-SADOF            TO DREFHDGA.
 24354
 24355     IF (PI-COMPANY-ID NOT = 'DCC' and 'VPP' and 'CID')
 24356        AND (PI-MAP-NAME = EL631B)
 24357        MOVE AL-SADOF            TO BVINHA
 24358                                    BVINA
 24359     END-IF
 24360     IF PI-MAP-NAME = EL631B
 24361        MOVE PI-COMPANY-ID          TO BCOMPIDO
 24362        MOVE FUNCTION UPPER-CASE(WS-KIX-MYENV)
 24363                                 TO BREGIONO
 24364        MOVE PI-PROCESSOR-ID     TO BUSERO
 24365        IF CSR-EDIT-SESSION
 24366           MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
 24367                                 TO BHEADO
 24368           MOVE '4=B-HDR 6=RES'  TO BPF4HDRO
 24369        ELSE
 24370           MOVE AL-SADOF         TO BF15HDRA
 24371           MOVE '4=B-HDR      '  TO BPF4HDRO
 24372        END-IF
 24373        MOVE PI-MEMBER-CAPTION      TO BMEMCAPO
 24374        MOVE PI-LIFE-OVERRIDE-L2    TO BKIND1O
 24375        MOVE PI-AH-OVERRIDE-L2      TO BKIND2O
 24376        MOVE WS-CURRENT-DT          TO BDATEO
 24377        MOVE TIME-OUT               TO BTIMEO
 24378        MOVE EMI-MESSAGE-AREA (1)   TO BERMSG1O
 24379        MOVE EMI-MESSAGE-AREA (2)   TO BERMSG2O
 24380        MOVE EMI-MESSAGE-AREA (3)   TO BERMSG3O
 24381        IF   WS-DISPLAY-SCREEN
 24382             MOVE PB-ENTRY-BATCH    TO BBATCHO
 24383             MOVE PB-SV-CARRIER     TO BCARRO
 24384             MOVE PB-SV-GROUPING    TO BGROUPO
 24385             MOVE PB-SV-STATE       TO BSTATEO
 24386             MOVE PB-ACCOUNT        TO BACCTO
 24387        ELSE
 24388             MOVE PI-PB-ENTRY-BATCH TO BBATCHO
 24389     ELSE
 24390        IF PI-MAP-NAME = EL631C
 24391           MOVE '4=B-HDR      '     TO CPF4HDRO
 24392           IF CSR-EDIT-SESSION
 24393              MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
 24394                                 TO CHEADO
 24395           ELSE
 24396              MOVE AL-SADOF      TO CF15HDRA
 24397           END-IF
 24398           MOVE PI-PB-ENTRY-BATCH      TO CBATCHO
 24399           MOVE WS-CURRENT-DT          TO CDATEO
 24400           MOVE TIME-OUT               TO CTIMEO
 24401           MOVE PI-LIFE-OVERRIDE-L2    TO CKIND1O
 24402           MOVE PI-AH-OVERRIDE-L2      TO CKIND2O
 24403           MOVE PI-LIFE-OVERRIDE-L2    TO WS-REF-HDG-OVERRIDE
 24404           MOVE WS-C-HDG               TO CLFHDGO
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 450
* EL6311.cbl
 24405           MOVE PI-AH-OVERRIDE-L2      TO WS-REF-HDG-OVERRIDE
 24406           MOVE WS-C-HDG               TO CAHHDGO
 24407           MOVE EMI-MESSAGE-AREA (1)   TO CERMSG1O
 24408           MOVE EMI-MESSAGE-AREA (2)   TO CERMSG2O
 24409           MOVE EMI-MESSAGE-AREA (3)   TO CERMSG3O
 24410           IF   WS-DISPLAY-SCREEN
 24411                MOVE PB-ENTRY-BATCH    TO CBATCHO
 24412                MOVE PB-SV-CARRIER     TO CCARRO
 24413                MOVE PB-SV-GROUPING    TO CGROUPO
 24414                MOVE PB-SV-STATE       TO CSTATEO
 24415                MOVE PB-ACCOUNT        TO CACCTO
 24416           ELSE
 24417                MOVE PI-PB-ENTRY-BATCH TO CBATCHO
 24418        ELSE
 24419           MOVE WS-CURRENT-DT          TO DDATEO
 24420           MOVE TIME-OUT               TO DTIMEO
 24421           MOVE PI-LIFE-OVERRIDE-L2    TO WS-PREM-HDG-OVERRIDE
 24422                                          WS-REFUND-HDG-OVERRIDE
 24423           MOVE WS-D-PREM-HDG          TO DLFPHDGO
 24424           MOVE WS-D-REFUND-HDG        TO DLFRHDGO
 24425           MOVE PI-AH-OVERRIDE-L2      TO WS-PREM-HDG-OVERRIDE
 24426                                          WS-REFUND-HDG-OVERRIDE
 24427           MOVE WS-D-PREM-HDG          TO DAHPHDGO
 24428           MOVE WS-D-REFUND-HDG        TO DAHRHDGO
 24429           MOVE EMI-MESSAGE-AREA (1)   TO DERMSGO
 24430           IF CSR-EDIT-SESSION
 24431              MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
 24432                                 TO DHEADO
 24433           END-IF
 24434           IF  WS-DISPLAY-SCREEN
 24435               MOVE PB-ENTRY-BATCH     TO DBATCHO
 24436               MOVE PB-CARRIER         TO DCARRO
 24437               MOVE PB-GROUPING        TO DGROUPO
 24438               MOVE PB-STATE           TO DSTATEO
 24439               MOVE PB-ACCOUNT         TO DACCTO
 24440               MOVE PB-ACCOUNT-NAME    TO DACCTNMO
 24441           ELSE
 24442               MOVE EL631D             TO PI-MAP-NAME
 24443               MOVE PI-PB-ENTRY-BATCH  TO DBATCHO
 24444               MOVE PB-ACCOUNT-NAME TO DACCTNMO.
 24445
 24446     MOVE SPACE                        TO WS-DISPLAY-SW.
 24447
 24448
 24449* EXEC CICS SEND
 24450*        MAP      (PI-MAP-NAME)
 24451*        MAPSET   (MAPSET-EL6311S)
 24452*        FROM     (EL631BI)
 24453*        ERASE
 24454*        CURSOR
 24455*    END-EXEC.
 24456     MOVE LENGTH OF
 24457      EL631BI
 24458       TO DFHEIV12
 24459     MOVE -1
 24460       TO DFHEIV11
 24461*    MOVE '8$     CT  E    H L F ,   #00020683' TO DFHEIV0
 24462     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 451
* EL6311.cbl
 24463     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 24464     MOVE X'2020233030303230363833' TO DFHEIV0(25:11)
 24465     CALL 'kxdfhei1' USING DFHEIV0,
 24466           PI-MAP-NAME,
 24467           EL631BI,
 24468           DFHEIV12,
 24469           MAPSET-EL6311S,
 24470           DFHEIV99,
 24471           DFHEIV99,
 24472           DFHEIV99,
 24473           DFHEIV11,
 24474           DFHEIV99,
 24475           DFHEIV99,
 24476           DFHEIV99
 24477     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24478
 24479
 24480     GO TO 9100-RETURN-TRAN.
 24481
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 452
* EL6311.cbl
 24483
 24484******************************************************************
 24485*                                                                *
 24486*              S E N D    D A T A O N L Y                        *
 24487*                                                                *
 24488******************************************************************
 24489
 24490 8200-SEND-DATAONLY.
 24491     MOVE EIBTIME                TO TIME-IN.
 24492
 24493     IF PI-COMPANY-ID = CLIENT-GIC
 24494        MOVE AL-UNNOF               TO BCPREM-ATTRB (1)
 24495                                       BCPREM-ATTRB (2).
 24496
 24497     IF PI-MAP-NAME = EL631B
 24498        MOVE PI-MEMBER-CAPTION      TO BMEMCAPO
 24499        MOVE WS-CURRENT-DT          TO BDATEO
 24500        MOVE TIME-OUT               TO BTIMEO
 24501        MOVE EMI-MESSAGE-AREA (1)   TO BERMSG1O
 24502        MOVE EMI-MESSAGE-AREA (2)   TO BERMSG2O
 24503        MOVE EMI-MESSAGE-AREA (3)   TO BERMSG3O
 24504        MOVE SPACES                 TO BPFENTRO
 24505        MOVE AL-UANOF               TO BPFENTRA
 24506
 24507*DMD CUSTOM CODING*************START    DO IT WHEN SCREEN=EL631B &
 24508        IF PI-COMPANY-ID NOT = 'DMD'
 24509             MOVE AL-SANOF            TO BBILLEDA
 24510             MOVE AL-SADOF            TO DMDBILA
 24511         ELSE
 24512            NEXT SENTENCE
 24513*DMD CUSTOM CODING*************END
 24514     ELSE
 24515        IF PI-MAP-NAME = EL631C
 24516           MOVE WS-CURRENT-DT          TO CDATEO
 24517           MOVE TIME-OUT               TO CTIMEO
 24518           MOVE EMI-MESSAGE-AREA (1)   TO CERMSG1O
 24519           MOVE EMI-MESSAGE-AREA (2)   TO CERMSG2O
 24520           MOVE EMI-MESSAGE-AREA (3)   TO CERMSG3O
 24521           MOVE SPACES                 TO CPFENTRO
 24522           MOVE AL-UANOF               TO CPFENTRA
 24523        ELSE
 24524           MOVE WS-CURRENT-DT          TO DDATEO
 24525           MOVE TIME-OUT               TO DTIMEO
 24526           MOVE EMI-MESSAGE-AREA (1)   TO DERMSGO.
 24527
 24528
 24529* EXEC CICS SEND
 24530*        MAP      (PI-MAP-NAME)
 24531*        MAPSET   (MAPSET-EL6311S)
 24532*        FROM     (EL631BI)
 24533*        DATAONLY
 24534*        CURSOR
 24535*    END-EXEC.
 24536     MOVE LENGTH OF
 24537      EL631BI
 24538       TO DFHEIV12
 24539     MOVE -1
 24540       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 453
* EL6311.cbl
 24541*    MOVE '8$D    CT       H L F ,   #00020739' TO DFHEIV0
 24542     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 24543     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 24544     MOVE X'2020233030303230373339' TO DFHEIV0(25:11)
 24545     CALL 'kxdfhei1' USING DFHEIV0,
 24546           PI-MAP-NAME,
 24547           EL631BI,
 24548           DFHEIV12,
 24549           MAPSET-EL6311S,
 24550           DFHEIV99,
 24551           DFHEIV99,
 24552           DFHEIV99,
 24553           DFHEIV11,
 24554           DFHEIV99,
 24555           DFHEIV99,
 24556           DFHEIV99
 24557     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24558
 24559
 24560     GO TO 9100-RETURN-TRAN.
 24561
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 454
* EL6311.cbl
 24563
 24564******************************************************************
 24565*                                                                *
 24566*           U T I L I T Y   R O U T I N E S                      *
 24567*                                                                *
 24568******************************************************************
 24569
 24570 8300-SEND-TEXT.
 24571
 24572* EXEC CICS SEND TEXT
 24573*        FROM     (LOGOFF-TEXT)
 24574*        LENGTH   (LOGOFF-LENGTH)
 24575*        ERASE
 24576*        FREEKB
 24577*    END-EXEC.
 24578*    MOVE '8&      T  E F  H   F -   #00020758' TO DFHEIV0
 24579     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 24580     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 24581     MOVE X'2020233030303230373538' TO DFHEIV0(25:11)
 24582     CALL 'kxdfhei1' USING DFHEIV0,
 24583           LOGOFF-TEXT,
 24584           LOGOFF-LENGTH,
 24585           DFHEIV99,
 24586           DFHEIV99,
 24587           DFHEIV99,
 24588           DFHEIV99,
 24589           DFHEIV99,
 24590           DFHEIV99,
 24591           DFHEIV99,
 24592           DFHEIV99,
 24593           DFHEIV99,
 24594           DFHEIV99
 24595     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24596
 24597
 24598
 24599* EXEC CICS RETURN
 24600*    END-EXEC.
 24601*    MOVE '.(                    ''   #00020765' TO DFHEIV0
 24602     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 24603     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 24604     MOVE X'2020233030303230373635' TO DFHEIV0(25:11)
 24605     CALL 'kxdfhei1' USING DFHEIV0,
 24606           DFHEIV99,
 24607           DFHEIV99,
 24608           DFHEIV99,
 24609           DFHEIV99,
 24610           DFHEIV99,
 24611           DFHEIV99
 24612     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24613
 24614
 24615 8400-LOG-JOURNAL-RECORD.
 24616
 24617     if (pi-journal-file-id > 0)
 24618        and (jp-file-id = file-id-erpndb)
 24619        move eibdate             to jp-date
 24620        move eibtime             to jp-time
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 455
* EL6311.cbl
 24621*       move FILE-ID-ERPNDB      TO JP-FILE-ID
 24622        MOVE PI-PROCESSOR-ID     TO JP-USER-ID
 24623        MOVE 03                  TO PI-JOURNAL-FILE-ID
 24624        if csr-edit-session
 24625           move 'EL6311C'        to jp-program-id
 24626        else
 24627           MOVE THIS-PGM         TO JP-PROGRAM-ID
 24628        end-if
 24629
 24630**      length is 585 plus 30 extra for jrnl stuff
 24631**      system already accounts for the 34
 24632
 24633
 24634* EXEC CICS JOURNAL
 24635*          JFILEID   (PI-JOURNAL-FILE-ID)
 24636*          JTYPEID   ('EL')
 24637*          FROM      (JOURNAL-RECORD)
 24638*          LENGTH    (615)
 24639*          resp      (ws-response)
 24640*       END-EXEC
 24641     MOVE 'EL' TO DFHEIV7
 24642     MOVE 615
 24643       TO DFHEIV11
 24644*    MOVE '4"LF                  (  N#00020786' TO DFHEIV0
 24645     MOVE X'34224C462020202020202020' TO DFHEIV0(1:12)
 24646     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24647     MOVE X'204E233030303230373836' TO DFHEIV0(25:11)
 24648     CALL 'kxdfhei1' USING DFHEIV0,
 24649           PI-JOURNAL-FILE-ID,
 24650           DFHEIV7,
 24651           JOURNAL-RECORD,
 24652           DFHEIV11,
 24653           DFHEIV99,
 24654           DFHEIV99,
 24655           DFHEIV99
 24656     MOVE EIBRESP  TO ws-response
 24657     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 24658
 24659        if resp-normal
 24660           continue
 24661        else
 24662           display ' error-el6311-journal ' ws-response
 24663        end-if
 24664     end-if
 24665
 24666*    EXEC CICS JOURNAL
 24667*        JFILEID     (PI-JOURNAL-FILE-ID)
 24668*        JTYPEID     ('EL')
 24669*        FROM        (JOURNAL-RECORD)
 24670*        LENGTH      (WS-JOURNAL-RECORD-LENGTH)
 24671*    END-EXEC.
 24672     .
 24673 8400-exit.
 24674     exit.
 24675 8600-DEEDIT.
 24676
 24677* EXEC CICS BIF DEEDIT
 24678*         FIELD   (DEEDIT-FIELD)
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 456
* EL6311.cbl
 24679*         LENGTH  (15)
 24680*    END-EXEC.
 24681     MOVE 15
 24682       TO DFHEIV11
 24683*    MOVE '@"L                   #   #00020811' TO DFHEIV0
 24684     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 24685     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 24686     MOVE X'2020233030303230383131' TO DFHEIV0(25:11)
 24687     CALL 'kxdfhei1' USING DFHEIV0,
 24688           DEEDIT-FIELD,
 24689           DFHEIV11
 24690     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24691
 24692
 24693 8800-UNAUTHORIZED-ACCESS.
 24694     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 24695     GO TO 8300-SEND-TEXT.
 24696
 24697 8810-PF23.
 24698     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 24699     MOVE XCTL-EL005             TO PGM-NAME.
 24700     GO TO 9300-XCTL.
 24701
 24702 9100-RETURN-TRAN.
 24703     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 24704
 24705     IF  PI-MAP-NAME =  EL631B
 24706         MOVE '631B'             TO PI-CURRENT-SCREEN-NO.
 24707
 24708     IF  PI-MAP-NAME =  EL631C
 24709         MOVE '631C'             TO PI-CURRENT-SCREEN-NO.
 24710
 24711     IF  PI-MAP-NAME =  EL631D
 24712         MOVE '631D'             TO PI-CURRENT-SCREEN-NO.
 24713
 24714
 24715* EXEC CICS RETURN
 24716*        TRANSID    (TRANS-EXB1)
 24717*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 24718*        LENGTH     (1300)
 24719*    END-EXEC.
 24720     MOVE 1300
 24721       TO DFHEIV11
 24722*    MOVE '.(CT                  ''   #00020837' TO DFHEIV0
 24723     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 24724     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 24725     MOVE X'2020233030303230383337' TO DFHEIV0(25:11)
 24726     CALL 'kxdfhei1' USING DFHEIV0,
 24727           TRANS-EXB1,
 24728           PROGRAM-INTERFACE-BLOCK,
 24729           DFHEIV11,
 24730           DFHEIV99,
 24731           DFHEIV99,
 24732           DFHEIV99
 24733     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24734
 24735
 24736 9200-RETURN-MAIN-MENU.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 457
* EL6311.cbl
 24737     MOVE XCTL-EL626             TO PGM-NAME.
 24738     GO TO 9300-XCTL.
 24739
 24740 9300-XCTL.
 24741
 24742* EXEC CICS XCTL
 24743*        PROGRAM    (PGM-NAME)
 24744*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 24745*        LENGTH     (PI-COMM-LENGTH)
 24746*    END-EXEC.
 24747*    MOVE '.$C                   %   #00020848' TO DFHEIV0
 24748     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 24749     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 24750     MOVE X'2020233030303230383438' TO DFHEIV0(25:11)
 24751     CALL 'kxdfhei1' USING DFHEIV0,
 24752           PGM-NAME,
 24753           PROGRAM-INTERFACE-BLOCK,
 24754           PI-COMM-LENGTH,
 24755           DFHEIV99
 24756     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24757
 24758
 24759 9400-CLEAR.
 24760     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
 24761     GO TO 9300-XCTL.
 24762
 24763 9500-PF12.
 24764     MOVE XCTL-EL010             TO PGM-NAME.
 24765     GO TO 9300-XCTL.
 24766
 24767 9600-PGMID-ERROR.
 24768
 24769* EXEC CICS HANDLE CONDITION
 24770*        PGMIDERR    (8300-SEND-TEXT)
 24771*    END-EXEC.
 24772*    MOVE '"$L                   ! W #00020863' TO DFHEIV0
 24773     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 24774     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 24775     MOVE X'5720233030303230383633' TO DFHEIV0(25:11)
 24776     CALL 'kxdfhei1' USING DFHEIV0
 24777     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24778
 24779
 24780     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
 24781     MOVE ' '                    TO PI-ENTRY-CD-1.
 24782     MOVE XCTL-EL005             TO PGM-NAME.
 24783     MOVE PGM-NAME               TO LOGOFF-PGM.
 24784     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
 24785     GO TO 9300-XCTL.
 24786
 24787 9700-DATE-LINK.
 24788     MOVE LINK-ELDATCV           TO PGM-NAME.
 24789
 24790* EXEC CICS LINK
 24791*        PROGRAM    (PGM-NAME)
 24792*        COMMAREA   (DATE-CONVERSION-DATA)
 24793*        LENGTH     (DC-COMM-LENGTH)
 24794*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 458
* EL6311.cbl
 24795*    MOVE '."C                   (   #00020876' TO DFHEIV0
 24796     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24797     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24798     MOVE X'2020233030303230383736' TO DFHEIV0(25:11)
 24799     CALL 'kxdfhei1' USING DFHEIV0,
 24800           PGM-NAME,
 24801           DATE-CONVERSION-DATA,
 24802           DC-COMM-LENGTH,
 24803           DFHEIV99,
 24804           DFHEIV99,
 24805           DFHEIV99,
 24806           DFHEIV99
 24807     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24808
 24809
 24810 9800-LINK-PENDING-EDIT.
 24811     MOVE PI-LIFE-OVERRIDE-L1    TO PB-LIFE-OVERRIDE-L1.
 24812     MOVE PI-AH-OVERRIDE-L1      TO PB-AH-OVERRIDE-L1.
 24813
 24814     MOVE LINK-EL050             TO PGM-NAME
 24815     MOVE PENDING-BUSINESS       TO PASSED-RECORD
 24816     MOVE ZEROS                  TO WK-CO-MAX-CAP
 24817                                    WK-CO-TOL-CLAIM
 24818                                    WK-CO-TOL-PREM
 24819                                    WK-CO-TOL-REFUND
 24820                                    WK-CO-TOL-PREM-PCT
 24821                                    WK-CO-TOL-REFUND-PCT
 24822                                    WK-REFUND-OVS-AMT
 24823                                    WK-REFUND-OVS-PCT
 24824                                    WK-ACCT-ADDR
 24825                                    WK-LIFE-EDIT-ADDR
 24826                                    WK-AH-EDIT-ADDR
 24827                                    WK-LIFE-BEN-ADDR
 24828                                    WK-AH-BEN-ADDR
 24829                                    WK-STATE-ADDR
 24830                                    WK-PLAN-ADDR
 24831                                    WK-FORM-ADDR
 24832     MOVE PI-CSR-SESSION-SW      TO WK-CSR-SESSION-SW
 24833
 24834     MOVE '6'                    TO WK-ENTRY-SW.
 24835
 24836     MOVE SPACES                 TO EDIT-CRITERIA-DATA.
 24837
 24838     MOVE LOW-VALUES             TO EC-CO-MONTH-END-DT
 24839                                    EC-AM-EXPIRATION-DT
 24840                                    EC-AM-EFFECTIVE-DT
 24841                                    EC-CM-LF-CANCEL-DT
 24842                                    EC-CM-AH-CANCEL-DT
 24843                                    EC-CM-DEATH-DT.
 24844
 24845     MOVE ZEROS                  TO EC-CO-TOL-PREM
 24846                                    EC-CO-TOL-REFUND
 24847                                    EC-CO-MIN-AGE
 24848                                    EC-CO-MIN-PREMIUM
 24849                                    EC-CO-MIN-TERM
 24850                                    EC-CO-MAX-TERM
 24851                                    EC-ST-TOL-PREM
 24852                                    EC-ST-TOL-REFUND
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 459
* EL6311.cbl
 24853                                    EC-AM-LF-TOL-PREM
 24854                                    EC-AM-AH-TOL-PREM
 24855                                    EC-AM-LF-MAX-ATT-AGE
 24856                                    EC-AM-LF-MAX-AGE
 24857                                    EC-AM-LF-MAX-TERM
 24858                                    EC-AM-LF-MAX-TOT-BEN
 24859                                    EC-AM-AH-MAX-ATT-AGE
 24860                                    EC-AM-AH-MAX-AGE
 24861                                    EC-AM-AH-MAX-TERM
 24862                                    EC-AM-AH-MAX-TOT-BEN
 24863                                    EC-AM-AH-MAX-MON-BEN
 24864                                    EC-RT-LF-MAX-ATT-AGE
 24865                                    EC-RT-LF-MAX-AGE
 24866                                    EC-RT-LF-MAX-TERM
 24867                                    EC-RT-LF-MAX-TOT-BEN
 24868                                    EC-RT-AH-MAX-ATT-AGE
 24869                                    EC-RT-AH-MAX-AGE
 24870                                    EC-RT-AH-MAX-TERM
 24871                                    EC-RT-AH-MAX-TOT-BEN
 24872                                    EC-RT-AH-MAX-MON-BEN
 24873                                    EC-RT-AH-RATE
 24874                                    EC-RT-LF-RATE
 24875                                    EC-RT-LF-NSP-RATE
 24876                                    EC-RT-AH-NSP-RATE
 24877                                    EC-CM-LF-PRIOR-REFUND
 24878                                    EC-CM-AH-PRIOR-REFUND.
 24879
 24880     MOVE ZEROS                  TO EC-CO-TOL-PREM-PCT
 24881                                    EC-ST-TOL-PREM-PCT
 24882                                    EC-AM-LF-TOL-REFUND
 24883                                    EC-AM-LF-DEV-PERCENT
 24884                                    EC-CO-TOL-REFUND-PCT
 24885                                    EC-ST-TOL-REFUND-PCT
 24886                                    EC-AM-AH-TOL-REFUND
 24887                                    EC-AM-AH-DEV-PERCENT.
 24888
 24889
 24890* EXEC CICS LINK
 24891*         PROGRAM   (PGM-NAME)
 24892*         COMMAREA  (PASSED-RECORD)
 24893*         LENGTH    (WS-EDIT-PASS-LENGTH)
 24894*    END-EXEC.
 24895*    MOVE '."C                   (   #00020961' TO DFHEIV0
 24896     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24897     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24898     MOVE X'2020233030303230393631' TO DFHEIV0(25:11)
 24899     CALL 'kxdfhei1' USING DFHEIV0,
 24900           PGM-NAME,
 24901           PASSED-RECORD,
 24902           WS-EDIT-PASS-LENGTH,
 24903           DFHEIV99,
 24904           DFHEIV99,
 24905           DFHEIV99,
 24906           DFHEIV99
 24907     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24908
 24909
 24910     MOVE '1'                    TO PI-EDIT-SW.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 460
* EL6311.cbl
 24911     MOVE EDIT-CRITERIA-DATA     TO PI-CRITERIA-DATA.
 24912
 24913     MOVE PASSED-RECORD          TO PENDING-BUSINESS.
 24914
 24915     IF PI-COMPANY-ID = 'UCL'
 24916         MOVE EC-AM-EFFECTIVE-DT TO WS-CERT-EFF-DT.
 24917
 24918     IF VALID-PB-ID
 24919        GO TO 9800-EXIT.
 24920
 24921     MOVE PENDING-BUSINESS       TO EMI-LINE1.
 24922
 24923     IF PI-MAP-NAME = EL631B
 24924        MOVE -1                  TO BMAINTL
 24925       ELSE
 24926        MOVE -1                  TO CMAINTL.
 24927
 24928     GO TO 8200-SEND-DATAONLY.
 24929
 24930 9800-EXIT.
 24931      EXIT.
 24932
 24933 9900-ERROR-FORMAT.
 24934
 24935     MOVE PI-COMPANY-ID TO EMI-CLIENT-ID.
 24936
 24937     IF NOT EMI-ERRORS-COMPLETE
 24938         MOVE LINK-EL001         TO PGM-NAME
 24939
 24940* EXEC CICS LINK
 24941*            PROGRAM    (PGM-NAME)
 24942*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 24943*            LENGTH     (EMI-COMM-LENGTH)
 24944*        END-EXEC.
 24945*    MOVE '."C                   (   #00020996' TO DFHEIV0
 24946     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24947     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24948     MOVE X'2020233030303230393936' TO DFHEIV0(25:11)
 24949     CALL 'kxdfhei1' USING DFHEIV0,
 24950           PGM-NAME,
 24951           ERROR-MESSAGE-INTERFACE-BLOCK,
 24952           EMI-COMM-LENGTH,
 24953           DFHEIV99,
 24954           DFHEIV99,
 24955           DFHEIV99,
 24956           DFHEIV99
 24957     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24958
 24959
 24960 9900-EXIT.
 24961     EXIT.
 24962
 24963 9990-ABEND.
 24964     MOVE LINK-EL004             TO PGM-NAME.
 24965     MOVE DFHEIBLK               TO EMI-LINE1.
 24966
 24967* EXEC CICS LINK
 24968*        PROGRAM   (PGM-NAME)
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 461
* EL6311.cbl
 24969*        COMMAREA  (EMI-LINE1)
 24970*        LENGTH    (72)
 24971*    END-EXEC.
 24972     MOVE 72
 24973       TO DFHEIV11
 24974*    MOVE '."C                   (   #00021008' TO DFHEIV0
 24975     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24976     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24977     MOVE X'2020233030303231303038' TO DFHEIV0(25:11)
 24978     CALL 'kxdfhei1' USING DFHEIV0,
 24979           PGM-NAME,
 24980           EMI-LINE1,
 24981           DFHEIV11,
 24982           DFHEIV99,
 24983           DFHEIV99,
 24984           DFHEIV99,
 24985           DFHEIV99
 24986     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24987
 24988
 24989     IF PI-MAP-NAME = EL631B
 24990        MOVE -1                  TO BMAINTL
 24991       ELSE
 24992        MOVE -1                  TO CMAINTL.
 24993
 24994     IF EIBTRNID NOT = TRANS-EXB1
 24995        GO TO 8100-SEND-INITIAL-MAP
 24996       ELSE
 24997        GO TO 8200-SEND-DATAONLY.
 24998
 24999 9995-SECURITY-VIOLATION.
 25000*                            COPY ELCSCTP.
 25001******************************************************************
 25002*                                                                *
 25003*                            ELCSCTP                             *
 25004*                            VMOD=2.001                          *
 25005*                                                                *
 25006*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 25007******************************************************************
 25008
 25009
 25010     MOVE EIBDATE          TO SM-JUL-DATE.
 25011     MOVE EIBTRMID         TO SM-TERMID.
 25012     MOVE THIS-PGM         TO SM-PGM.
 25013     MOVE EIBTIME          TO TIME-IN.
 25014     MOVE TIME-OUT         TO SM-TIME.
 25015     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 25016
 25017
 25018* EXEC CICS LINK
 25019*         PROGRAM  ('EL003')
 25020*         COMMAREA (SECURITY-MESSAGE)
 25021*         LENGTH   (80)
 25022*    END-EXEC.
 25023     MOVE 'EL003' TO DFHEIV1
 25024     MOVE 80
 25025       TO DFHEIV11
 25026*    MOVE '."C                   (   #00021042' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 462
* EL6311.cbl
 25027     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 25028     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 25029     MOVE X'2020233030303231303432' TO DFHEIV0(25:11)
 25030     CALL 'kxdfhei1' USING DFHEIV0,
 25031           DFHEIV1,
 25032           SECURITY-MESSAGE,
 25033           DFHEIV11,
 25034           DFHEIV99,
 25035           DFHEIV99,
 25036           DFHEIV99,
 25037           DFHEIV99
 25038     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 25039
 25040
 25041******************************************************************
 25042
 25043
 25044 9999-DFHBACK SECTION.
 25045     MOVE '9%                    "   ' TO DFHEIV0
 25046     MOVE 'EL6311' TO DFHEIV1
 25047     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 25048     GOBACK.
 25049 9999-DFHEXIT.
 25050     IF DFHEIGDJ EQUAL 0001
 25051         NEXT SENTENCE
 25052     ELSE IF DFHEIGDJ EQUAL 2
 25053         GO TO 9600-PGMID-ERROR,
 25054               9990-ABEND,
 25055               9990-ABEND,
 25056               0010-MAIN-LOGIC
 25057         DEPENDING ON DFHEIGDI
 25058     ELSE IF DFHEIGDJ EQUAL 3
 25059         GO TO 1280-BATCH-HDR-NOT-FOUND
 25060         DEPENDING ON DFHEIGDI
 25061     ELSE IF DFHEIGDJ EQUAL 4
 25062         GO TO 1290-DUPLICATE-ALT-INDEX
 25063         DEPENDING ON DFHEIGDI
 25064     ELSE IF DFHEIGDJ EQUAL 5
 25065         GO TO 1295-CERT-TRL-REC-NOTFND
 25066         DEPENDING ON DFHEIGDI
 25067     ELSE IF DFHEIGDJ EQUAL 6
 25068         GO TO 1380-BATCH-HDR-NOT-FOUND
 25069         DEPENDING ON DFHEIGDI
 25070     ELSE IF DFHEIGDJ EQUAL 7
 25071         GO TO 1385-REC-NOT-FOUND
 25072         DEPENDING ON DFHEIGDI
 25073     ELSE IF DFHEIGDJ EQUAL 8
 25074         GO TO 1386-NOTFND
 25075         DEPENDING ON DFHEIGDI
 25076     ELSE IF DFHEIGDJ EQUAL 9
 25077         GO TO 1399-EXIT
 25078         DEPENDING ON DFHEIGDI
 25079     ELSE IF DFHEIGDJ EQUAL 10
 25080         GO TO 1480-BATCH-HDR-NOT-FOUND
 25081         DEPENDING ON DFHEIGDI
 25082     ELSE IF DFHEIGDJ EQUAL 11
 25083         GO TO 1490-RECORD-NOT-FOUND
 25084         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 463
* EL6311.cbl
 25085     ELSE IF DFHEIGDJ EQUAL 12
 25086         GO TO 1405-DELETE-CERTIFICATE
 25087         DEPENDING ON DFHEIGDI
 25088     ELSE IF DFHEIGDJ EQUAL 13
 25089         GO TO 1420-CONTINUE-DELETE
 25090         DEPENDING ON DFHEIGDI
 25091     ELSE IF DFHEIGDJ EQUAL 14
 25092         GO TO 1406-DELETE-ERNOTE
 25093         DEPENDING ON DFHEIGDI
 25094     ELSE IF DFHEIGDJ EQUAL 15
 25095         GO TO 1407-DELETE-MAILING
 25096         DEPENDING ON DFHEIGDI
 25097     ELSE IF DFHEIGDJ EQUAL 16
 25098         GO TO 1420-CONTINUE-DELETE
 25099         DEPENDING ON DFHEIGDI
 25100     ELSE IF DFHEIGDJ EQUAL 17
 25101         GO TO 1480-BATCH-HDR-NOT-FOUND
 25102         DEPENDING ON DFHEIGDI
 25103     ELSE IF DFHEIGDJ EQUAL 18
 25104         GO TO 1475-DELETE-FINISHED
 25105         DEPENDING ON DFHEIGDI
 25106     ELSE IF DFHEIGDJ EQUAL 19
 25107         GO TO 2280-BATCH-HDR-NOT-FOUND
 25108         DEPENDING ON DFHEIGDI
 25109     ELSE IF DFHEIGDJ EQUAL 20
 25110         GO TO 2290-DUPLICATE-ALT-INDEX
 25111         DEPENDING ON DFHEIGDI
 25112     ELSE IF DFHEIGDJ EQUAL 21
 25113         GO TO 2380-BATCH-HDR-NOT-FOUND
 25114         DEPENDING ON DFHEIGDI
 25115     ELSE IF DFHEIGDJ EQUAL 22
 25116         GO TO 2385-REC-NOT-FOUND
 25117         DEPENDING ON DFHEIGDI
 25118     ELSE IF DFHEIGDJ EQUAL 23
 25119         GO TO 2380-BATCH-HDR-NOT-FOUND
 25120         DEPENDING ON DFHEIGDI
 25121     ELSE IF DFHEIGDJ EQUAL 24
 25122         GO TO 2485-BATCH-HDR-NOT-FOUND
 25123         DEPENDING ON DFHEIGDI
 25124     ELSE IF DFHEIGDJ EQUAL 25
 25125         GO TO 2490-RECORD-NOT-FOUND
 25126         DEPENDING ON DFHEIGDI
 25127     ELSE IF DFHEIGDJ EQUAL 26
 25128         GO TO 2475-CONTINUE-DELETE
 25129         DEPENDING ON DFHEIGDI
 25130     ELSE IF DFHEIGDJ EQUAL 27
 25131         GO TO 2485-BATCH-HDR-NOT-FOUND
 25132         DEPENDING ON DFHEIGDI
 25133     ELSE IF DFHEIGDJ EQUAL 28
 25134         GO TO 2480-DELETE-FINISHED
 25135         DEPENDING ON DFHEIGDI
 25136     ELSE IF DFHEIGDJ EQUAL 29
 25137         GO TO 2920-PROCESS-REWRITE
 25138         DEPENDING ON DFHEIGDI
 25139     ELSE IF DFHEIGDJ EQUAL 30
 25140         GO TO 2985-RECORD-MISSING
 25141         DEPENDING ON DFHEIGDI
 25142     ELSE IF DFHEIGDJ EQUAL 31
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 464
* EL6311.cbl
 25143         GO TO 2960-BUILD-NEW-CANCEL-RECORD
 25144         DEPENDING ON DFHEIGDI
 25145     ELSE IF DFHEIGDJ EQUAL 32
 25146         GO TO 2990-DUPLICATE-RECORD
 25147         DEPENDING ON DFHEIGDI
 25148     ELSE IF DFHEIGDJ EQUAL 33
 25149         GO TO 3590-NOT-FOUND
 25150         DEPENDING ON DFHEIGDI
 25151     ELSE IF DFHEIGDJ EQUAL 34
 25152         GO TO 3690-NOT-FOUND
 25153         DEPENDING ON DFHEIGDI
 25154     ELSE IF DFHEIGDJ EQUAL 35
 25155         GO TO 3990-NOT-FOUND
 25156         DEPENDING ON DFHEIGDI
 25157     ELSE IF DFHEIGDJ EQUAL 36
 25158         GO TO 4050-END-RECORDS,
 25159               4050-END-RECORDS
 25160         DEPENDING ON DFHEIGDI
 25161     ELSE IF DFHEIGDJ EQUAL 37
 25162         GO TO 4150-END-BATCH
 25163         DEPENDING ON DFHEIGDI
 25164     ELSE IF DFHEIGDJ EQUAL 38
 25165         GO TO 4150-END-BATCH
 25166         DEPENDING ON DFHEIGDI
 25167     ELSE IF DFHEIGDJ EQUAL 39
 25168         GO TO 4250-END-RECORDS,
 25169               4250-END-RECORDS
 25170         DEPENDING ON DFHEIGDI
 25171     ELSE IF DFHEIGDJ EQUAL 40
 25172         GO TO 4350-END-BATCH,
 25173               4350-END-BATCH
 25174         DEPENDING ON DFHEIGDI
 25175     ELSE IF DFHEIGDJ EQUAL 41
 25176         GO TO 4570-NOT-FOUND,
 25177               4550-END-RECORDS
 25178         DEPENDING ON DFHEIGDI
 25179     ELSE IF DFHEIGDJ EQUAL 42
 25180         GO TO 4680-NOT-FOUND,
 25181               4680-NOT-FOUND
 25182         DEPENDING ON DFHEIGDI
 25183     ELSE IF DFHEIGDJ EQUAL 43
 25184         GO TO 4860-NOT-FOUND,
 25185               4850-END-RECORDS
 25186         DEPENDING ON DFHEIGDI
 25187     ELSE IF DFHEIGDJ EQUAL 44
 25188         GO TO 4970-NOT-FOUND,
 25189               4950-END-RECORDS
 25190         DEPENDING ON DFHEIGDI
 25191     ELSE IF DFHEIGDJ EQUAL 45
 25192         GO TO 5050-NOT-FOUND
 25193         DEPENDING ON DFHEIGDI
 25194     ELSE IF DFHEIGDJ EQUAL 46
 25195         GO TO 5050-NOT-FOUND
 25196         DEPENDING ON DFHEIGDI
 25197     ELSE IF DFHEIGDJ EQUAL 47
 25198         GO TO 5050-NOT-FOUND
 25199         DEPENDING ON DFHEIGDI
 25200     ELSE IF DFHEIGDJ EQUAL 48
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 465
* EL6311.cbl
 25201         GO TO 5550-END-RECORDS,
 25202               5550-END-RECORDS
 25203         DEPENDING ON DFHEIGDI
 25204     ELSE IF DFHEIGDJ EQUAL 49
 25205         GO TO 6050-QID-ERROR
 25206         DEPENDING ON DFHEIGDI
 25207     ELSE IF DFHEIGDJ EQUAL 50
 25208         GO TO 6050-QID-ERROR
 25209         DEPENDING ON DFHEIGDI
 25210     ELSE IF DFHEIGDJ EQUAL 51
 25211         GO TO 6400-CONTINUE,
 25212               6400-CONTINUE
 25213         DEPENDING ON DFHEIGDI
 25214     ELSE IF DFHEIGDJ EQUAL 52
 25215         GO TO 3690-NOT-FOUND
 25216         DEPENDING ON DFHEIGDI
 25217     ELSE IF DFHEIGDJ EQUAL 53
 25218         GO TO 7399-EXIT
 25219         DEPENDING ON DFHEIGDI
 25220     ELSE IF DFHEIGDJ EQUAL 54
 25221         GO TO 7550-OFFICER-NOTFND
 25222         DEPENDING ON DFHEIGDI
 25223     ELSE IF DFHEIGDJ EQUAL 55
 25224         GO TO 8300-SEND-TEXT
 25225         DEPENDING ON DFHEIGDI.
 25226     MOVE '9%                    "   ' TO DFHEIV0
 25227     MOVE 'EL6311' TO DFHEIV1
 25228     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 25229     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       16636     Code:       99373
