* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page   1
* EL6311.cbl
* Options: int("EL6311.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL6311.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL6311.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL6311.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 ID DIVISION.
     2
     3 PROGRAM-ID.                 EL6311.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/20/94 16:50:32.
     7*                            VMOD=2.089.
     8*
     9*AUTHOR.     LOGIC,INC.
    10*            DALLAS, TEXAS.
    11
    12*DATE-COMPILED.
    13
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page   2
* EL6311.cbl
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    20*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    21*            *                                                   *
    22*            *****************************************************
    23
    24*REMARKS.
    25*        TRANSACTION - EXB1 - NEW BUSINESS, REVIEW AND CORRECTION
    26*                             ISSUES, CANCELS, AND BATCH HEADERS
    27******************************************************************
    28*                   C H A N G E   L O G
    29*
    30* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    31*-----------------------------------------------------------------
    32*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    33* EFFECTIVE    NUMBER
    34*-----------------------------------------------------------------
    35* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
    36* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    37* 011904                   PEMA  ADD TOTAL FEE PROCESSING
    38* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
    39* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
    40* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
    41* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
    42* 090607  CR2007010300001  PEMA  ADD CO TYPE TO OVERCHARGE
    43* 030708  CR2007092500001  PEMA  ADD VA DISCLOSURE PROCESSING
    44* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
    45* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
    46* 102408  CR2008080500002  PEMA  ADD BILLING NOTE FOR EC OF P
    47* 072009  IR2009062300002  AJRA  RESET CALC FLAG ON CHANGE
    48* 072209  CR2008101500003  AJRA  PRINT BORROWER FIRST NAME
    49* 111109  CR2008100900003  AJRA  CHANGE PF8 TO NEW CERT NOTE SCRN
    50* 032210  IR2010022400001  PEMA  CORRECT PF5 LOGIC, ADD APR PROC
    51* 101110  CR2010091000002  PEMA  ENHANCE PREMIUM EDIT
    52* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
    53* 100111  CR2011022800001  AJRA  NAPERSOFT VA DISC
    54* 010412  CR2011022800001  AJRA  NAPERSOFT
    55* 032612  CR2011110200001  PEMA  AHL CHANGES
    56* 062712  CR2011022800001  AJRA  REDEFINE ORIG DATA
    57* 072312  CR2011022800001  AJRA  NAPERSOFT MISC
    58* 091112  IR2012091100002  AJRA  FIX AKA
    59* 091312  IR2012091100004  AJRA  FIX ADDRESS CHECK
    60* 091712  IR2012091400003  AJRA  CHANGE PF6 TO GO TO CANCEL TRANS
    61* 100412  IR2012100300002  AJRA  FIX VA DISC FOR DISAB ONLY CERT
    62* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
    63* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    64* 080713  CR2012032000002  AJRA  HIGHLIGHT AGE ERRORS
    65* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR
    66* 102813  IR2013102100001  PEMA  CORRECT CANCEL VOID STATUS
    67* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
    68* 100213  CR2013090300001  AJRA  NAPERSOFT PHASE 2
    69* 111513  CR2013053000001  PEMA  DAILY CHECK REQUEST CHANGES
    70* 120513  CR2013090300001  AJRA  CHG ALL NINES IN PREM PROCESS
    71* 030314  IR2014030300003  PEMA  ADD CHK FOR STARTBR
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page   3
* EL6311.cbl
    72* 031114  IR2014031100001  PEMA  CHECK FOR 0 CHECK AMOUNT
    73* 041514  CR2014032600001  PEMA  ALLOW DEL CNC IF VOID CHKS
    74* 051914  IR2014050500003  PEMA  ALLOW DEL CNC IF NO CHK ATTACHED
    75* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
    76* 091615  CR2015082000001  PEMA  add endorsement check processing
    77* 101615  CR2015080300002  PEMA  ALLOW VIN FOR CID
    78* 010517  CR2016021600005  PEMA  ADD NEW FORCE CD FOR AGG
    79* 022017  IR2017022000002  PEMA  PREVENT DEL OF ISS W/CHECK
    80* 101016  CR2015082500001  PEMA  ADD COMPANY VPP
    81* 062017  CR2015091000001  PEMA  ADD PROCESSING FOR TN REF INTERES
    82* 020218  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
    83* 052918  CR2018040600002  PEMA  ADD REFUND DIRECT INDICATOR
    84* 021519  CR2019021100001  PEMA  non-monthly al calcs
    85* 012220  CR2018092700002  TANA  Add letter reqd field
    86* 012820  CR2020012800001  PEMA  Addd minimum term edit for extd t
    87* 031620  CR2019092700001  PEMA  Remove post card indicator
    88* 041320  CR2020040200001  PEMA  PENDING BUSINESS JOURNALING
    89* 052020  CR2019111300001  PEMA  Include all files in "K" trans
    90* 072120  CR2020072100002  PEMA  Allow deletion of dup pend iss re
    91******************************************************************
    92
    93 ENVIRONMENT DIVISION.
    94
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page   4
* EL6311.cbl
    96 DATA DIVISION.
    97 WORKING-STORAGE SECTION.
    98 01  DFH-START PIC X(04).
    99 77  LCP-ONCTR-01                  PIC S9(8) COMP-3 VALUE ZERO.
   100 77  LCP-ONCTR-02                  PIC S9(8) COMP-3 VALUE ZERO.
   101 77  FILLER  PIC X(32)  VALUE '********************************'.
   102 77  FILLER  PIC X(32)  VALUE '*    EL6311 WORKING STORAGE    *'.
   103 77  FILLER  PIC X(32)  VALUE '************VMOD=2.089**********'.
   104 77  A1                          PIC S999 COMP-3 VALUE +0.
   105 77  N1                          PIC S999 COMP-3 VALUE +0.
   106 77  N2                          PIC S999 COMP-3 VALUE +0.
   107 77  N3                          PIC S999 COMP-3 VALUE +0.
   108 77  WS-OC-AMT                   PIC S9(9)V99 COMP-3 VALUE +0.
   109 77  WS-SAVE-ERPYAJ-KEY          PIC X(33) VALUE SPACES.
   110 77  WS-REVERSE-SW               PIC X VALUE 'N'.
   111     88  REVERSAL                    VALUE 'Y'.
   112 77  WS-NOTE-SW                  PIC X  VALUE ' '.
   113 77  WS-BEG                      PIC S999 COMP-3 VALUE +0.
   114 77  WS-END                      PIC S999 COMP-3 VALUE +0.
   115 77  WS-TALLY                    PIC 99  VALUE ZEROS.
   116 77  WS-ERMAIL-SW                PIC X  VALUE ' '.
   117     88  ERMAIL-FOUND                 VALUE 'Y'.
   118 77  A2                          PIC S9(5) COMP-3 VALUE +0.
   119 77  M1                          PIC S9(5) COMP-3 VALUE +0.
   120 77  WS-WORK-FIELD               PIC X(80)    VALUE SPACES.
   121 77  WS-CERT-TRL-REC-NOT-FOUND   PIC S9       VALUE +0.
   122     88  CERT-TRL-REC-NOT-FOUND     VALUE +1.
   123 77  ws-stop-sw                  pic x value ' '.
   124     88  i-say-stop                 value 'Y'.
   125 77  ws-check-sw                 pic x value ' '.
   126     88  i-have-checks              value 'Y'.
   127 77  ws-proc-check-sw            pic x value ' '.
   128     88  i-have-processed-checks    value 'Y'.
   129 77  ws-any-check-sw             pic x value ' '.
   130     88  i-have-a-check-period      value 'Y'.
   131 77  ws-chek-browse-sw           pic x value ' '.
   132 77  ws-lf-diff                  pic s9(7)v99 comp-3 value +0.
   133 77  ws-ah-diff                  pic s9(7)v99 comp-3 value +0.
   134 77  ws-new-ref-total            pic s9(7)v99 comp-3 value +0.
   135 77  ws-new-iss-total            pic s9(7)v99 comp-3 value +0.
   136 77  ws-check-amts               pic s9(7)v99 comp-3 value +0.
   137 77  ws-tot-orig-prem            pic s9(7)v99 comp-3 value +0.
   138 77  ws-elcrtt-update-sw         pic x value ' '.
   139     88  update-elcrtt              value 'Y'.
   140 01  P pointer.
   141 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
   142 01  var-ptr pointer.
   143 01  env-var-len                 pic 9(4)  binary.
   144 01  rc                          pic 9(9)  binary.
   145 01  WS-KIXSYS.
   146     05  WS-KIX-FIL1             PIC X(10).
   147     05  WS-KIX-APPS             PIC X(10).
   148     05  WS-KIX-ENV              PIC X(10).
   149     05  WS-KIX-MYENV            PIC X(10).
   150     05  WS-KIX-SYS              PIC X(10).
   151*    COPY ELCSCTM.
   152******************************************************************
   153*                                                                *
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page   5
* EL6311.cbl
   154*                                                                *
   155*                            ELCSCTM                             *
   156*                            VMOD=2.001                          *
   157*                                                                *
   158*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   159*                                                                *
   160******************************************************************
   161 01  SECURITY-MESSAGE.
   162     12  FILLER                          PIC X(30)
   163            VALUE '** LOGIC SECURITY VIOLATION -'.
   164     12  SM-READ                         PIC X(6).
   165     12  FILLER                          PIC X(5)
   166            VALUE ' PGM='.
   167     12  SM-PGM                          PIC X(6).
   168     12  FILLER                          PIC X(5)
   169            VALUE ' OPR='.
   170     12  SM-PROCESSOR-ID                 PIC X(4).
   171     12  FILLER                          PIC X(6)
   172            VALUE ' TERM='.
   173     12  SM-TERMID                       PIC X(4).
   174     12  FILLER                          PIC XX   VALUE SPACE.
   175     12  SM-JUL-DATE                     PIC 9(5).
   176     12  FILLER                          PIC X    VALUE SPACE.
   177     12  SM-TIME                         PIC 99.99.
   178
   179
   180*    COPY ELCSCRTY.
   181******************************************************************
   182*                                                                *
   183*                                                                *
   184*                            ELCSCRTY                            *
   185*                            VMOD=2.001                          *
   186*                                                                *
   187*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   188*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   189*        SAVED IN PI-SECURITY-ADDRESS.                           *
   190*                                                                *
   191******************************************************************
   192 01  SECURITY-CONTROL.
   193     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   194     12  FILLER                       PIC XX    VALUE 'SC'.
   195     12  SC-CREDIT-CODES.
   196         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   197             20  SC-CREDIT-DISPLAY    PIC X.
   198             20  SC-CREDIT-UPDATE     PIC X.
   199     12  SC-CLAIMS-CODES.
   200         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   201             20  SC-CLAIMS-DISPLAY    PIC X.
   202             20  SC-CLAIMS-UPDATE     PIC X.
   203
   204 01  WS-VA-NO-COMM-MESS.
   205     12  FILLER                  PIC X(41) VALUE
   206        'MAXIMUM AGE EXCEEDED - NO COMMISSION PAID'.
   207 01  WS-OC-MESSAGE.
   208     12  FILLER                  PIC X(43) VALUE
   209        'OVERCHARGE AUTO CORRECTED IN THE AMOUNT OF '.
   210     12  WS-OC-DIS-AMT           PIC -----9.99.
   211     12  FILLER                  PIC X(4) VALUE ' ON '.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page   6
* EL6311.cbl
   212     12  WS-OC-DATE              PIC X(10).
   213 01  WS-DATE-AREA.
   214     12  WS-TEMP-EFF-DT          PIC XX     VALUE LOW-VALUES.
   215     12  WS-CURRENT-DT.
   216         16  FILLER              PIC X(6)    VALUE SPACES.
   217         16  WS-CURRENT-YR       PIC XX      VALUE SPACES.
   218     12  WS-CURRENT-BIN-DT       PIC XX      VALUE SPACES.
   219     12  WS-CREDIT-SELECT-DT     PIC XX      VALUE SPACES.
   220     12  WS-MONTH-END-DT         PIC X(8)    VALUE SPACES.
   221
   222 01  STANDARD-AREAS.
   223     12  GETMAIN-SPACE           PIC X       VALUE SPACE.
   224     12  EL631B                  PIC X(8)    VALUE 'EL631B'.
   225     12  EL631C                  PIC X(8)    VALUE 'EL631C'.
   226     12  EL631D                  PIC X(8)    VALUE 'EL631D'.
   227     12  MAPSET-EL6311S          PIC X(8)    VALUE 'EL6311S'.
   228     12  SCREEN-NUMBER           PIC X(6)    VALUE 'EL631B'.
   229     12  TRANS-EXB1              PIC X(4)    VALUE 'EXB1'.
   230     12  THIS-PGM                PIC X(8)    VALUE 'EL6311'.
   231     12  PGM-NAME                PIC X(8).
   232     12  TIME-IN                 PIC S9(7).
   233     12  TIME-OUT-R  REDEFINES TIME-IN.
   234         16  FILLER              PIC X.
   235         16  TIME-OUT            PIC 99V99.
   236         16  FILLER              PIC XX.
   237     12  XCTL-EL001              PIC X(8)    VALUE 'EL001'.
   238     12  XCTL-EL005              PIC X(8)    VALUE 'EL005'.
   239     12  XCTL-EL010              PIC X(8)    VALUE 'EL010'.
   240     12  XCTL-EL127              PIC X(8)    VALUE 'EL127'.
   241     12  XCTL-EL1272             PIC X(8)    VALUE 'EL1272'.
   242     12  XCTL-EL1273             PIC X(8)    VALUE 'EL1273'.
   243     12  XCTL-EL1276             PIC X(8)    VALUE 'EL1276'.
   244     12  XCTL-EL1279             PIC X(8)    VALUE 'EL1279'.
   245     12  XCTL-EL401DMD           PIC X(8)    VALUE 'EL401DMD'.
   246     12  XCTL-EL626              PIC X(8)    VALUE 'EL626'.
   247     12  XCTL-EL631              PIC X(8)    VALUE 'EL631'.
   248     12  XCTL-EL6312             PIC X(8)    VALUE 'EL6312'.
   249     12  XCTL-EL6313             PIC X(8)    VALUE 'EL6313'.
   250     12  XCTL-EL6314             PIC X(8)    VALUE 'EL6314'.
   251     12  XCTL-EL6315             PIC X(8)    VALUE 'EL6315'.
   252     12  XCTL-EL6316             PIC X(8)    VALUE 'EL6316'.
   253     12  XCTL-EL640              PIC X(8)    VALUE 'EL640'.
   254     12  XCTL-EL650              PIC X(8)    VALUE 'EL650'.
   255     12  XCTL-EL677              PIC X(8)    VALUE 'EL677'.
   256     12  XCTL-EL680              PIC X(8)    VALUE 'EL680'.
   257     12  XCTL-EL689              PIC X(8)    VALUE 'EL689'.
   258     12  XCTL-EL690              PIC X(8)    VALUE 'EL690'.
   259     12  LINK-EL001              PIC X(8)    VALUE 'EL001'.
   260     12  LINK-EL004              PIC X(8)    VALUE 'EL004'.
   261     12  LINK-EL050              PIC X(8)    VALUE 'EL050'.
   262     12  LINK-ELDATCV            PIC X(8)    VALUE 'ELDATCV'.
   263     12  LINK-ELVADS             PIC X(8)    VALUE 'ELVADS'.
   264     12  FILE-ID                 PIC X(8).
   265     12  FILE-ID-ELCERT          PIC X(8)    VALUE 'ELCERT'.
   266     12  FILE-ID-ERPNDB          PIC X(8)    VALUE 'ERPNDB'.
   267     12  FILE-ID-ERPNDB2         PIC X(8)    VALUE 'ERPNDB2'.
   268     12  FILE-ID-ERPNDB3         PIC X(8)    VALUE 'ERPNDB3'.
   269     12  FILE-ID-ERPNDB4         PIC X(8)    VALUE 'ERPNDB4'.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page   7
* EL6311.cbl
   270     12  FILE-ID-ERPNDM          PIC X(8)    VALUE 'ERPNDM'.
   271     12  FILE-ID-ERNOTE          PIC X(8)    VALUE 'ERNOTE'.
   272     12  FILE-ID-ERCNOT          PIC X(8)    VALUE 'ERCNOT'.
   273     12  FILE-ID-ERPYAJ          PIC X(8)    VALUE 'ERPYAJ'.
   274     12  FILE-ID-ERMAIL          PIC X(8)    VALUE 'ERMAIL'.
   275     12  FILE-ID-ERRQST          PIC X(8)    VALUE 'ERRQST'.
   276     12  FILE-ID-ERLOFC          PIC X(8)    VALUE 'ERLOFC'.
   277     12  CLMS-ID                 PIC X(8)    VALUE 'ELMSTR5'.
   278     12  FILE-ID-ERENDT          PIC X(8)    VALUE 'ERENDT'.
   279     12  CRTT-ID                 PIC X(8)    VALUE 'ELCRTT'.
   280
   281 01  WS-PASS-AREA.
   282     05  WS-PASS-AREA-LENGTH PIC S9(4) COMP VALUE +352.
   283     05  WS-PASS-VADS-REC    PIC X(350).
   284*** Z CONTROL LAYOUT MOVED TO COPYBOOK ELCZREC
   285*                                COPY ELCZREC.
   286******************************************************************
   287*                                                                *
   288*                                                                *
   289*                            ELCZREC.                            *
   290*                                                                *
   291*   FILE DESCRIPTION = Z CONTROL RECORD LAYOUT                   *
   292*                                                                *
   293******************************************************************
   294*-----------------------------------------------------------------
   295*                   C H A N G E   L O G
   296*
   297* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   298*-----------------------------------------------------------------
   299*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   300* EFFECTIVE    NUMBER
   301*-----------------------------------------------------------------
   302* 122011    2011022800001  AJRA  NEW FILE
   303* 073112    2011022800001  AJRA  ADD ACCT SUMM, CSO SUMM
   304* 122712    2012101700002  AJRA  ADD REASON CODE REQUIRED FLAG
   305* 072313    2013062000003  AJRA  ADD IND FOR INSERTION BAR CODE
   306* 091913    2013090300001  AJRA  ADD SIGNATURE FLAG DEFAULT
   307*-----------------------------------------------------------------
   308 01  W-Z-CONTROL-DATA.
   309     05  W-NUMBER-OF-COPIES      PIC  9.
   310     05  FILLER                  PIC  X.
   311     05  W-DAYS-TO-FOLLOW-UP     PIC  999.
   312     05  FILLER                  PIC  X.
   313     05  W-DAYS-TO-RESEND        PIC  999.
   314     05  FILLER                  PIC  X.
   315     05  W-FORM-TO-RESEND        PIC  X(4).
   316     05  W-ADD-BAR-CODE          PIC  X.
   317     05  W-PROMPT-LETTER         PIC  X.
   318     05  W-HAS-RETURN-ENV        PIC  X.
   319     05  W-ENCLOSURE-CD          PIC  XXX.
   320     05  W-SIG-FLAG-DEFAULT      PIC  X.
   321     05  W-AUTO-CLOSE-IND        PIC  X.
   322     05  FILLER                  PIC  X.
   323     05  W-LETTER-TO-BENE        PIC  X.
   324     05  FILLER                  PIC  X.
   325     05  W-LETTER-TO-ACCT        PIC  X.
   326     05  FILLER                  PIC  X.
   327     05  W-LETTER-TYPE           PIC  X.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page   8
* EL6311.cbl
   328     05  FILLER                  PIC  X.
   329     05  W-PRINT-CERTIFICATE     PIC  X.
   330     05  FILLER                  PIC  X.
   331     05  W-REFUND-REQUIRED       PIC  X.
   332     05  FILLER                  PIC  X.
   333     05  W-ONBASE-CODE           PIC  XX.
   334     05  FILLER                  PIC  X.
   335     05  W-ACCT-SUMM             PIC  X.
   336     05  FILLER                  PIC  X.
   337     05  W-CSO-SUMM              PIC  X.
   338     05  FILLER                  PIC  X.
   339     05  W-REASONS-REQUIRED      PIC  X.
   340     05  FILLER                  PIC  X(29).
   341******************************************************************
   342*                                                                *
   343*              A C C E S S   K E Y S                             *
   344*                                                                *
   345******************************************************************
   346
   347 01  ACCESS-KEYS.
   348     12  ERPYAJ-KEY.
   349         16  ERPYAJ-COMPANY-CD       PIC X.
   350         16  ERPYAJ-CARRIER          PIC X.
   351         16  ERPYAJ-GROUPING         PIC X(6).
   352         16  ERPYAJ-FIN-RESP         PIC X(10).
   353         16  ERPYAJ-ACCOUNT          PIC X(10).
   354         16  ERPYAJ-SEQ-NO           PIC S9(8) COMP.
   355         16  ERPYAJ-TYPE             PIC X.
   356     12  ERPYAJ-RECORD-LENGTH        PIC S9(4) COMP VALUE +200.
   357     12  ELCERT-KEY.
   358         16  ELCERT-COMPANY-CD       PIC X.
   359         16  ELCERT-CARRIER          PIC X.
   360         16  ELCERT-GROUPING         PIC X(6).
   361         16  ELCERT-STATE            PIC XX.
   362         16  ELCERT-ACCOUNT          PIC X(10).
   363         16  ELCERT-CERT-EFF-DT      PIC XX.
   364         16  ELCERT-CERT-NO.
   365             20  ELCERT-CERT-PRIME   PIC X(10).
   366             20  ELCERT-CERT-SFX     PIC X.
   367
   368     12  ELCERT-RECORD-LENGTH        PIC S9(4) COMP VALUE +450.
   369     12  ELCERT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +473.
   370     12  ELCRTO-KEY.
   371         16  ELCRTO-COMPANY-CD       PIC X.
   372         16  ELCRTO-CARRIER          PIC X.
   373         16  ELCRTO-GROUPING         PIC X(6).
   374         16  ELCRTO-STATE            PIC XX.
   375         16  ELCRTO-ACCOUNT          PIC X(10).
   376         16  ELCRTO-CERT-EFF-DT      PIC XX.
   377         16  ELCRTO-CERT-NO.
   378             20  ELCRTO-CERT-PRIME   PIC X(10).
   379             20  ELCRTO-CERT-SFX     PIC X.
   380         16  ELCRTO-RECORD-TYPE      PIC X.
   381         16  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
   382
   383     12  ELCRTT-KEY.
   384         16  ELCRTT-PRIMARY          PIC X(33).
   385         16  ELCRTT-REC-TYPE         PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page   9
* EL6311.cbl
   386     12  ELCRTT-RECORD-LENGTH        PIC S9(4) COMP VALUE +552.
   387     12  ELCRTT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +575.
   388
   389     12  ERPNDB-KEY.
   390         16  ERPNDB-COMPANY-CD       PIC X        VALUE SPACE.
   391         16  ERPNDB-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
   392         16  ERPNDB-BATCH-SEQ-NO     PIC S9(4)    VALUE +0 COMP.
   393         16  ERPNDB-BATCH-SEQ-ALPHA  REDEFINES
   394             ERPNDB-BATCH-SEQ-NO     PIC XX.
   395         16  ERPNDB-BATCH-CHG-SEQ-NO PIC S9(4)    VALUE +0 COMP.
   396
   397     12  ERPNDB-RECORD-LENGTH        PIC S9(4) COMP VALUE +585.
   398     12  ERPNDB-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +608.
   399     12  ERCHEK-KEY.
   400         16  CHEK-COMPANY-CD         PIC X       VALUE SPACE.
   401         16  CHEK-CARRIER            PIC X       VALUE SPACE.
   402         16  CHEK-GROUPING           PIC X(6)    VALUE SPACES.
   403         16  CHEK-STATE              PIC XX      VALUE SPACES.
   404         16  CHEK-ACCOUNT            PIC X(10)   VALUE SPACES.
   405         16  CHEK-EFF-DT             PIC XX      VALUE SPACES.
   406         16  CHEK-CERT-NO            PIC X(10)   VALUE SPACES.
   407         16  CHEK-SUF-NO             PIC X       VALUE SPACES.
   408         16  CHEK-RECORD-SEQ         PIC S9(4)   VALUE ZEROS COMP.
   409     12  ELLETR-KEY.
   410         16  LETR-COMPANY-CD     PIC X.
   411         16  LETR-LETTER-ID      PIC X(4).
   412         16  LETR-FILLER         PIC X(8).
   413         16  LETR-SEQ-NO         PIC 9(4) BINARY.
   414     12  ERPNDM-KEY.
   415         16  ERPNDM-COMPANY-CD       PIC X        VALUE SPACE.
   416         16  ERPNDM-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
   417         16  ERPNDM-BATCH-SEQ        PIC S9(4)    VALUE +1 COMP.
   418         16  ERPNDM-BATCH-CHG-SEQ    PIC S9(4)    VALUE +0 COMP.
   419
   420*    12  ERPNDM-RECORD-LENGTH        PIC S9(4) COMP VALUE +250.
   421     12  ERPNDM-RECORD-LENGTH        PIC S9(4) COMP VALUE +374.
   422*    12  ERPNDM-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +273.
   423     12  ERPNDM-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +397.
   424
   425     12  ERPNDB-ALT-KEY.
   426         16  ERPNDB-COMPANY-CD-A1    PIC X        VALUE SPACE.
   427         16  ERPNDB-CARRIER          PIC X        VALUE SPACES.
   428         16  ERPNDB-GROUPING         PIC X(6)     VALUE SPACES.
   429         16  ERPNDB-STATE            PIC XX       VALUE SPACES.
   430         16  ERPNDB-ACCOUNT          PIC X(10)    VALUE SPACES.
   431         16  ERPNDB-CERT-EFF-DT      PIC XX       VALUE SPACES.
   432         16  ERPNDB-CERT-NO.
   433             20  ERPNDB-CERT-PRIME   PIC X(10)    VALUE SPACES.
   434             20  ERPNDB-CERT-SFX     PIC X        VALUE SPACE.
   435         16  ERPNDB-ALT-CHG-SEQ-NO   PIC S9(4)    VALUE +0 COMP.
   436         16  ERPNDB-RECORD-TYPE      PIC X.
   437
   438      12  ERPNDB-CSR-KEY.
   439          20  ERPNDB-CSR-COMPANY-CD-A2     PIC X.
   440          20  ERPNDB-CSR-ID                PIC X(4).
   441          20  ERPNDB-CSR-ENTRY-BATCH       PIC X(6).
   442          20  ERPNDB-CSR-BTCH-SEQ-NO       PIC S9(4)     COMP.
   443          20  ERPNDB-CSR-BTCH-CHG-SEQ      PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page  10
* EL6311.cbl
   444
   445     12  ERNOTE-KEY.
   446         16  ERNOTE-COMPANY-CD       PIC X        VALUE SPACE.
   447         16  ERNOTE-CARRIER          PIC X        VALUE SPACES.
   448         16  ERNOTE-GROUPING         PIC X(6)     VALUE SPACES.
   449         16  ERNOTE-STATE            PIC XX       VALUE SPACES.
   450         16  ERNOTE-ACCOUNT          PIC X(10)    VALUE SPACES.
   451         16  ERNOTE-CERT-EFF-DT      PIC XX       VALUE SPACES.
   452         16  ERNOTE-CERT-NO.
   453             20  ERNOTE-CERT-PRIME   PIC X(10)    VALUE SPACES.
   454             20  ERNOTE-CERT-SFX     PIC X        VALUE SPACES.
   455
   456     12  ERNOTE-RECORD-LENGTH        PIC S9(4) COMP VALUE +825.
   457     12  ERNOTE-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +848.
   458
   459     12  ERCNOT-KEY.
   460         16  ERCNOT-PART-KEY.
   461             20  ERCNOT-COMPANY-CD   PIC X        VALUE SPACE.
   462             20  ERCNOT-CARRIER      PIC X        VALUE SPACES.
   463             20  ERCNOT-GROUPING     PIC X(6)     VALUE SPACES.
   464             20  ERCNOT-STATE        PIC XX       VALUE SPACES.
   465             20  ERCNOT-ACCOUNT      PIC X(10)    VALUE SPACES.
   466             20  ERCNOT-CERT-EFF-DT  PIC XX       VALUE SPACES.
   467             20  ERCNOT-CERT-NO.
   468                 25  ERCNOT-CERT-PRIME PIC X(10)  VALUE SPACES.
   469                 25  ERCNOT-CERT-SFX PIC X        VALUE SPACES.
   470         16  ERCNOT-REC-TYPE         PIC X        VALUE SPACES.
   471         16  ERCNOT-SEQUENCE         PIC S9(4) COMP VALUE +0.
   472
   473     12  ERCNOT-RECORD-LENGTH        PIC S9(4) COMP VALUE +150.
   474     12  ERCNOT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +173.
   475
   476     12  ERMAIL-KEY.
   477         16  ERMAIL-COMPANY-CD       PIC X        VALUE SPACE.
   478         16  ERMAIL-CARRIER          PIC X        VALUE SPACES.
   479         16  ERMAIL-GROUPING         PIC X(6)     VALUE SPACES.
   480         16  ERMAIL-STATE            PIC XX       VALUE SPACES.
   481         16  ERMAIL-ACCOUNT          PIC X(10)    VALUE SPACES.
   482         16  ERMAIL-CERT-EFF-DT      PIC XX       VALUE SPACES.
   483         16  ERMAIL-CERT-NO.
   484             20  ERMAIL-CERT-PRIME   PIC X(10)    VALUE SPACES.
   485             20  ERMAIL-CERT-SFX     PIC X        VALUE SPACES.
   486
   487     12  ERMAIL-RECORD-LENGTH        PIC S9(4) COMP VALUE +374.
   488     12  ERMAIL-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +393.
   489
   490     12  ERRQST-KEY.
   491         16  ERRQST-COMPANY-CD       PIC X        VALUE SPACE.
   492         16  ERRQST-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
   493
   494     12  ERRQST-RECORD-LENGTH        PIC S9(4) COMP VALUE +200.
   495     12  ERRQST-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +223.
   496
   497     12  WS-JOURNAL-RECORD-LENGTH    PIC S9(4) COMP VALUE +0000.
   498
   499     12  ERLOFC-KEY.
   500         16  ERLOFC-COMPANY-CD          PIC  X.
   501         16  ERLOFC-CARRIER             PIC  X.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page  11
* EL6311.cbl
   502         16  ERLOFC-GROUPING            PIC  X(6).
   503         16  ERLOFC-STATE               PIC  XX.
   504         16  ERLOFC-ACCOUNT             PIC  X(10).
   505         16  ERLOFC-OFFICER-CODE        PIC  X(5).
   506*        16  ERLOFC-OFFICER-CODE        PIC  XXX.
   507
   508     12  ERACCT-KEY.
   509         16  ERACCT-COMPANY-CD          PIC  X.
   510         16  ERACCT-CARRIER             PIC  X.
   511         16  ERACCT-GROUPING            PIC  X(6).
   512         16  ERACCT-STATE               PIC  XX.
   513         16  ERACCT-ACCOUNT             PIC  X(10).
   514         16  ERACCT-EXP-DT.
   515             20  ERACCT-DT              PIC  XX.
   516             20  ERACCT-FILL            PIC  X(4).
   517     12  ERACNT-KEY.
   518         16  ERACNT-COMPANY-CD          PIC  X.
   519         16  ERACNT-CARRIER             PIC  X.
   520         16  ERACNT-GROUPING            PIC  X(6).
   521         16  ERACNT-STATE               PIC  XX.
   522         16  ERACNT-ACCOUNT             PIC  X(10).
   523         16  ERACNT-REC-TYPE            PIC  X.
   524         16  ERACNT-SEQ-NO              PIC  S9(4) COMP.
   525     12  ERENDT-KEY.
   526         16  ENDT-COMPANY-CD       PIC X.
   527         16  ENDT-CARRIER          PIC X.
   528         16  ENDT-GROUPING         PIC X(6).
   529         16  ENDT-STATE            PIC XX.
   530         16  ENDT-ACCOUNT          PIC X(10).
   531         16  ENDT-CERT-EFF-DT      PIC XX.
   532         16  ENDT-CERT-PRIME       PIC X(10).
   533         16  ENDT-CERT-SFX         PIC X.
   534         16  ENDT-RECORD-TYPE      PIC X.
   535         16  ENDT-SEQ-NO           PIC 9(4) BINARY.
   536
   537 01  WS-ELMSTR-WORK.
   538     12  ELMSTR-KEY.
   539         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
   540         16  MSTR-CERT-NO.
   541             20  MSTR-CERT-PRIME  PIC X(10)   VALUE SPACES.
   542             20  MSTR-CERT-SFX    PIC X(1)    VALUE SPACES.
   543     12  W-CLAIM-KEY.
   544         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
   545         16  W-CL-CERT-NO.
   546             20  W-CL-CERT-PRIME  PIC X(10)   VALUE SPACES.
   547             20  W-CL-CERT-SFX    PIC X(1)    VALUE SPACES.
   548      12  ELMSTR-LENGTH           PIC S9999 COMP  VALUE +11.
   549 01  EL055-PASS-AREA.
   550     05  PA-CURRENT-KEY          PIC X(11).
   551     05  PA-NEW-ALT-KEY          PIC X(36).
   552     05  PA-RETURN-AREA.
   553         10  ra-status-code      pic 9(4).
   554         10  ra-message          pic x(205).
   555 01  CANCEL-GEN-PASS-AREA.
   556     05  CG-OPTION-CODE          PIC X.
   557         88  CG-VALID-OPTION       VALUE '1' '2' '3' '4'.
   558         88  CG-FLAT-CANCEL        VALUE '1'.
   559         88  CG-CANCEL             VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page  12
* EL6311.cbl
   560         88  CG-CANCEL-REISSUE     VALUE '3'.
   561     05  CG-ERROR-CODE           PIC 99.
   562         88  CG-SUCCESS            VALUE 00.
   563         88  CG-DATE-ERROR         VALUE 01.
   564         88  CG-CERT-NOT-FOUND     VALUE 02.
   565         88  CG-AMOUNT-ERROR       VALUE 04.
   566         88  CG-OPTION-ERROR       VALUE 05.
   567         88  CG-PREV-CAN           VALUE 06.
   568         88  CG-INVALID-DATA       VALUE 07.
   569         88  CG-NO-ACCT-MSTR       VALUE 08.
   570         88  CG-SFX-A-EXIST        VALUE 09.
   571         88  CG-MISC-ERROR         VALUE 99.
   572     05  CG-COMPANY-ID           PIC XXX.
   573     05  CG-PROC-ID              PIC XXXX.
   574     05  CG-CURRENT-DT           PIC XX.
   575     05  CG-MONTH-END-DT         PIC XX.
   576     05  CG-CERT-KEY.
   577         10  CG-CERT-COMPANY-CD  PIC X.
   578         10  CG-CERT-CARRIER     PIC X.
   579         10  CG-CERT-GROUP       PIC X(6).
   580         10  CG-CERT-STATE       PIC XX.
   581         10  CG-CERT-ACCOUNT     PIC X(10).
   582         10  CG-CERT-EFF-DT      PIC XX.
   583         10  CG-CERT-CERT-NO     PIC X(11).
   584     05  CG-LF-CAN-DATA.
   585         10  CG-LF-CAN-DT        PIC XX.
   586         10  CG-LF-CAN-AMT       PIC S9(7)V99 COMP-3.
   587     05  CG-AH-CAN-DATA.
   588         10  CG-AH-CAN-DT        PIC XX.
   589         10  CG-AH-CAN-AMT       PIC S9(7)V99 COMP-3.
   590     05  CG-CERT-PROFILE-DATA.
   591         10  CG-INS-LNAME        PIC X(15).
   592         10  CG-INS-FNAME        PIC X(10).
   593         10  CG-INS-MID-INIT     PIC X.
   594         10  CG-INS-AGE          PIC 99.
   595         10  CG-JNT-LNAME        PIC X(15).
   596         10  CG-JNT-FNAME        PIC X(10).
   597         10  CG-JNT-MID-INIT     PIC X.
   598         10  CG-JNT-AGE          PIC 99.
   599     05  CG-LF-ISS-DATA.
   600         10  CG-LF-BENCD         PIC XX.
   601         10  CG-LF-PREM-AMT      PIC S9(7)V99 COMP-3.
   602         10  CG-LF-ALT-PREM-AMT  PIC S9(7)V99 COMP-3.
   603     05  CG-AH-ISS-DATA.
   604         10  CG-AH-BENCD         PIC XX.
   605         10  CG-AH-PREM-AMT      PIC S9(7)V99 COMP-3.
   606     05  CG-BATCH-NO             PIC X(6).
   607     05  CG-BATCH-SEQ-NO         PIC 9(4)  COMP.
   608     05  FILLER                  PIC X(306).
   609******************************************************************
   610*                                                                *
   611*            G E N E R A L   W O R K   A R E A                   *
   612*                                                                *
   613******************************************************************
   614
   615 01  WORK-AREA.
   616     12  WS-RESPONSE             PIC S9(8)   COMP.
   617         88  RESP-NORMAL           VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page  13
* EL6311.cbl
   618         88  resp-file-notfnd      value +12.
   619         88  RESP-NOTFND           VALUE +13.
   620         88  resp-duprec           value +14.
   621         88  resp-dupkey           value +15.
   622         88  resp-invreq           value +16.
   623         88  RESP-NOTOPEN          VALUE +19.
   624         88  RESP-ENDFILE          VALUE +20.
   625         88  resp-lengtherr        value +22.
   626     12  DEEDIT-FIELD            PIC X(15).
   627     12  FILLER          REDEFINES DEEDIT-FIELD.
   628         16  FILLER              PIC X(4).
   629         16  DEEDIT-FIELD-X11    PIC X(11).
   630     12  DEEDIT-FIELD-V0 REDEFINES DEEDIT-FIELD
   631                                 PIC S9(15).
   632     12  DEEDIT-FIELD-V2 REDEFINES DEEDIT-FIELD
   633                                 PIC S9(13)V99.
   634     12  DEEDIT-FIELD-V4 REDEFINES DEEDIT-FIELD
   635                                 PIC S9(11)V9999.
   636     12  W-ONE                   PIC S9(4) COMP VALUE +1.
   637     12  WS-CALC-TERM            PIC S999V9(5) VALUE ZEROS.
   638     12  WS-CALC-TERM-R REDEFINES WS-CALC-TERM.
   639         16  WS-CALC-TERM-WHOLE  PIC S999.
   640         16  WS-CALC-TERM-REMAIN PIC SV9(5).
   641
   642     12  WS-TIME                 PIC 9(6)   VALUE ZEROS.
   643     12  WS-HR-MINS-SECS REDEFINES WS-TIME.
   644         16  WS-HR-MINS          PIC 99V99.
   645         16  FILLER              PIC XX.
   646
   647     12  WS-EDIT-PASS-LENGTH     PIC S9(4)  VALUE +1036 COMP.
   648     12  WS-COMM-LENGTH          PIC S9(4)  VALUE +1306 COMP.
   649
   650     12  W-CANCEL-FEE-LONG       PIC S9(3)V9(2)  VALUE +0  COMP-3.
   651     12  W-CANCEL-FEE            PIC S99         VALUE +0  COMP-3.
   652
   653     12  WS-SUB                  PIC S9(4) VALUE +0  COMP-3.
   654     12  WS-SUB1                 PIC S9(4) VALUE +0  COMP.
   655     12  WS-SUB2                 PIC S9(4) VALUE +0  COMP.
   656     12  WS-SUB3                 PIC S9(4) VALUE +0  COMP.
   657     12  WS-SUB4                 PIC S9(4) VALUE +0  COMP.
   658     12  WS-COV-SUB              PIC S9(4) VALUE +0  COMP.
   659     12  WS-CSO-SUB              PIC S9(4) VALUE +0  COMP.
   660
   661     12  QID.
   662         16  QID-TERM            PIC X(4).
   663         16  FILLER              PIC X(4)    VALUE '607B'.
   664
   665     12  WS-DISPLAY-SW           PIC X     VALUE SPACE.
   666         88  WS-DISPLAY-SCREEN       VALUE 'Y'.
   667
   668     12  WS-LOAN-OFFICER         PIC X     VALUE SPACE.
   669         88  LOAN-OFFICER-FOUND      VALUE SPACE.
   670
   671     12  WS-MODE-CODE            PIC X     VALUE SPACE.
   672         88 WS-MODE-CODE-VALID     VALUE ' '
   673                                         'W'     *> Weekly
   674                                         'B'     *> Bi-weekly
   675                                         'S'     *> Semi-monthly
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page  14
* EL6311.cbl
   676                                         'M'     *> Monthly (Def)
   677                                         'Q'     *> Quarterly
   678                                         'N'     *> Bi-Monthly??
   679                                         'T'     *> Semi-annual
   680                                         'A'.    *> Annual Pay
   681
   682     12  WS-ALL-NINES            PIC S9(7)V99 VALUE +9999999.99.
   683
   684     12  WS-NUMERIC-SW           PIC X.
   685        88  CSO-NUMERIC-FIELD   VALUE 'Y'.
   686
   687     12  WS-EDIT-CSO-FIELD.
   688         16  WS-EDIT-BYTE  OCCURS 9 TIMES
   689                                 PIC X.
   690     12  WS-SAVE-PEND-ISSUE          PIC X(375).
   691     12  WS-ARCHIVE-LETTER-SW    PIC X    VALUE 'N'.
   692        88  ARCHIVE-LETTER-RELEASED   VALUE 'Y'.
   693        88  CALLED-FROM-6315          VALUE '5'.
   694
   695     12  WS-SAVE-INPUT-FIELDS.
   696         16  WS-BAGE             PIC 99       VALUE ZERO.
   697*        16  WS-BAPR             PIC S99V9(4) VALUE +0 COMP-3.
   698         16  WS-BAPR                 PIC 99V9(4) VALUE ZEROS.
   699         16  FILLER REDEFINES WS-BAPR.
   700             20  WS-APR-WHOLE-NUM    PIC 99.
   701             20  WS-APR-DEC          PIC 9999.
   702         16  WS-BLIVES           PIC S9(7)    VALUE +0 COMP-3.
   703         16  WS-BILLED           PIC S9(7)    VALUE +0 COMP-3.
   704
   705         16  WS-B-COVERAGE OCCURS 2 TIMES.
   706             20  WS-TERM-IN-DAYS-SW  PIC X.
   707                 88  WS-TERM-IN-DAYS-FOUND        VALUE 'Y'.
   708             20  WS-BTERM        PIC 999       COMP-3.
   709             20  WS-BALT-TERM    PIC 999       COMP-3.
   710             20  WS-BCRIT-PERD   PIC 99        COMP-3.
   711             20  WS-BBEN         PIC S9(10)V99 COMP-3.
   712             20  WS-BALT-BEN     PIC S9(10)V99 COMP-3.
   713             20  WS-BPREM        PIC S9(7)V99  COMP-3.
   714             20  WS-BALT-PREM    PIC S9(7)V99  COMP-3.
   715             20  WS-BCPREM       PIC S9(7)V99  COMP-3.
   716
   717         16  WS-C-FIELDS COMP-3.
   718             20  WS-CLIVES       PIC S9(3)     VALUE +0.
   719             20  WS-CREFND1      PIC S9(7)V99  VALUE +0.
   720             20  WS-CREFND2      PIC S9(7)V99  VALUE +0.
   721
   722         16  WS-D-FIELDS COMP-3.
   723             20  WS-DRISS        PIC S9(5)    VALUE +0.
   724             20  WS-DRLFPRM      PIC S9(7)V99 VALUE +0.
   725             20  WS-DRAHPRM      PIC S9(7)V99 VALUE +0.
   726             20  WS-DRCANC       PIC S9(5)    VALUE +0.
   727             20  WS-DRLFRFD      PIC S9(7)V99 VALUE +0.
   728             20  WS-DRAHRFD      PIC S9(7)V99 VALUE +0.
   729
   730     12  WS-SAVE-BIRTH-DATE.
   731         16  FILLER              PIC X(4)   VALUE SPACES.
   732         16  WS-SAVE-BIRTH-YR    PIC X(2)   VALUE SPACES.
   733
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page  15
* EL6311.cbl
   734     12  CENTURY-ADJ             PIC S9(08) VALUE +38400 COMP.
   735     12  WS-WORK-BIN-RED         PIC S9(08) VALUE +0 COMP.
   736     12  FILLER REDEFINES WS-WORK-BIN-RED.
   737         16  FILLER              PIC X(02).
   738         16  WS-WORK-BIN-DT      PIC X(02).
   739     12  WS-SW-1                 PIC X     VALUE SPACE.
   740     12  WS-SW-2                 PIC X     VALUE SPACE.
   741     12  WS-REMOVE-AH-SW         PIC X     VALUE SPACE.
   742         88  REMOVE-AH-COVERAGE  VALUE 'Y'.
   743     12  WS-REMOVE-LF-SW         PIC X     VALUE SPACE.
   744         88  REMOVE-LF-COVERAGE  VALUE 'Y'.
   745
   746     12  WS-CONVERTED-BIRTH      PIC XX    VALUE SPACE.
   747     12  WS-CONVERTED-1ST-PMT-DT PIC XX    VALUE SPACE.
   748     12  WS-CONVERTED-EFFDT      PIC XX    VALUE SPACES.
   749     12  WS-CONVERTED-EXPIRDT      OCCURS 2 TIMES PIC XX.
   750     12  WS-CONVERTED-CANCEL-DATES.
   751         16  WS-CONVERTED-CANDT1                  PIC XX.
   752         16  WS-CONVERTED-CANDT2                  PIC XX.
   753
   754     12  WS-EXP-DT-EDIT          PIC 99B99B99.
   755
   756     12  WS-REC-FOUND-SW         PIC X.
   757         88  RECORD-NOT-FOUND    VALUE 'N'.
   758
   759     12  WS-PB-RECORDS-FOUND-SW  PIC X     VALUE 'N'.
   760         88  PENDING-BUS-RECS-NOT-FOUND    VALUE 'N'.
   761         88  PENDING-BUS-RECS-FOUND        VALUE 'Y'.
   762
   763     12  WS-ERRORS-PRESENT-SW    PIC X     VALUE 'N'.
   764         88  WS-ERRORS-PRESENT             VALUE 'Y'.
   765         88  WS-ERRORS-NOT-PRESENT         VALUE 'N'.
   766
   767     12  WS-BROWSE-STARTED-SW    PIC X            VALUE ' '.
   768         88  BROWSE-STARTED      VALUE 'Y'.
   769
   770     12  WS-FIRST-TIME-SW        PIC X            VALUE ' '.
   771         88  FIRST-TIME          VALUE 'Y'.
   772
   773     12  WS-FIRST-ENTRY-SW       PIC X            VALUE ' '.
   774         88  FIRST-ENTRY         VALUE 'Y'.
   775
   776     12  WS-REC-BILLED-SW        PIC X            VALUE ' '.
   777         88  REC-BILLED          VALUE 'Y'.
   778
   779     12  SET-CURSOR-SW           PIC S9  COMP-3   VALUE +0.
   780         88  NO-CURSOR-SET       VALUE +0.
   781         88  CURSOR-SET          VALUE +1.
   782
   783     12  WS-ERR-SW               PIC X.
   784         88  STD-ERRORS          VALUE 'S'.
   785         88  TRN-ERRORS          VALUE 'T'.
   786
   787     12  WS-CERT-NOTE-SW         PIC X            VALUE ' '.
   788         88 CERT-NOTES-ARE-PRESENT   VALUE 'Y'.
   789
   790     12  WS-CERT-ADDRESS-SW      PIC X            VALUE ' '.
   791         88 CERT-ADDRESS-PRESENT VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page  16
* EL6311.cbl
   792
   793     12  WS-CANCEL-LETTER-SW     PIC X            VALUE ' '.
   794         88 CREATE-CANCEL-LETTER VALUE 'Y'.
   795
   796     12  WS-ERR-CODE.
   797         16  FILLER              PIC 99.
   798         16  WS-ERROR-SUB        PIC 99.
   799
   800     12  WS-DATE-WORK.
   801         16  WS-WORK-MM          PIC XX.
   802         16  WS-WORK-DD          PIC XX.
   803         16  WS-WORK-YY          PIC XX.
   804
   805     12  WS-MM-YY.
   806         16  WS-MM               PIC XX.
   807         16  FILLER              PIC X     VALUE '/'.
   808         16  WS-YY               PIC XX.
   809
   810     12  WS-CERT-EFF-DT          PIC XX.
   811
   812     12  WS-MEMBER-NO            PIC X(12).
   813     12  FILLER  REDEFINES  WS-MEMBER-NO.
   814         16  WS-MEMBER-NO-1-8    PIC 9(8).
   815         16  FILLER              PIC X(4).
   816
   817     12  WS-I-MICRO-NO           PIC S9(9)        COMP-3.
   818
   819     12  WS-ERPNDB-ALT-KEY.
   820         16  WS-PB-COMPANY-CD-A1         PIC X.
   821         16  WS-PB-CARRIER               PIC X.
   822         16  WS-PB-GROUPING              PIC X(6).
   823         16  WS-PB-STATE                 PIC XX.
   824         16  WS-PB-ACCOUNT               PIC X(10).
   825         16  WS-PB-CERT-EFF-DT           PIC XX.
   826         16  WS-PB-CERT-NO.
   827             20  WS-PB-CERT-PRIME        PIC X(10).
   828             20  WS-PB-CERT-SFX          PIC X.
   829         16  WS-PB-ALT-CHG-SEQ-NO        PIC S9(4)     COMP.
   830         16  WS-PB-RECORD-TYPE           PIC X.
   831
   832     12  WS-SHOW-SAVE-AREAS.
   833         16  WS-NEW-CERT-NO.
   834             20  WS-NEW-PRIME    PIC X(10).
   835             20  WS-NEW-SUFFIX   PIC X.
   836         16  WS-NEW-CERT-EFF-DT  PIC XX.
   837         16  WS-NEW-RECORD-TYPE  PIC X.
   838         16  WS-SHOW-SW          PIC X   VALUE 'N'.
   839             88   SHOW-RECORD            VALUE 'Y'.
   840
   841     12  WS-SEQ-SAVE             PIC S9(4) COMP.
   842
   843     12  WS-BATCH-NO.
   844         16  WS-BATCH-PREFIX     PIC XXX  VALUE SPACES.
   845         16  FILLER              PIC X(5) VALUE SPACES.
   846
   847     12  WS-FIRST-NAME.
   848         16  WS-1ST-INIT         PIC X.
   849         16  FILLER              PIC X(9).
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page  17
* EL6311.cbl
   850
   851     12  WS-INITIALS.
   852         16  WS-INITIAL-1        PIC X.
   853         16  WS-INITIAL-2        PIC X.
   854
   855     12  WS-C-HDG.
   856         16  WS-REF-HDG-OVERRIDE PIC XX   VALUE SPACES.
   857         16  FILLER              PIC X(4) VALUE '-REF'.
   858
   859     12  WS-D-PREM-HDG.
   860         16  WS-PREM-HDG-OVERRIDE    PIC XX   VALUE SPACES.
   861         16  FILLER                  PIC X(8) VALUE '-PREMIUM'.
   862
   863     12  WS-D-REFUND-HDG.
   864         16  WS-REFUND-HDG-OVERRIDE  PIC XX   VALUE SPACES.
   865         16  FILLER                  PIC X(7) VALUE '-REFUND'.
   866
   867     12  WS-BATCH-CSR-ID     PIC X(4)    VALUE SPACE.
   868
   869     12  CLIENT-ACE          PIC X(3)    VALUE 'ACE'.
   870     12  CLIENT-CRI          PIC X(3)    VALUE 'CRI'.
   871     12  CLIENT-CSO          PIC X(3)    VALUE 'CSO'.
   872     12  CLIENT-GIC          PIC X(3)    VALUE 'GIC'.
   873     12  CLIENT-LGX          PIC X(3)    VALUE 'LGX'.
   874     12  CLIENT-MIC          PIC X(3)    VALUE 'MIC'.
   875     12  CLIENT-PEM          PIC X(3)    VALUE 'PEM'.
   876
   877     12  WS-01-CANCEL-ERR        PIC X(25)
   878         VALUE 'CANCEL DATE ERROR'.
   879     12  WS-02-CANCEL-ERR        PIC X(25)
   880         VALUE 'CERT NOT FOUND'.
   881     12  WS-04-CANCEL-ERR        PIC X(25)
   882         VALUE 'CANCEL AMOUNT ERROR'.
   883     12  WS-05-CANCEL-ERR        PIC X(25)
   884         VALUE 'CANCEL OPTION ERROR'.
   885     12  WS-06-CANCEL-ERR        PIC X(25)
   886         VALUE 'PREVIOUSLY CANCELLED'.
   887     12  WS-07-CANCEL-ERR        PIC X(25)
   888         VALUE 'INVALID DATA'.
   889     12  WS-08-CANCEL-ERR        PIC X(25)
   890         VALUE 'NO ACCOUNT MASTER'.
   891     12  WS-09-CANCEL-ERR        PIC X(25)
   892         VALUE 'SUFFIX ALREADY EXISTS'.
   893     12  WS-99-CANCEL-ERR        PIC X(25)
   894         VALUE 'MISC CANCEL ERROR'.
   895
   896     12  ARCH-SUPPRESS           PIC ZZZZZZZZ99.
   897     12  ARCH-EDIT REDEFINES ARCH-SUPPRESS    PIC X(10).
   898
   899     12  WS-AGE-FIELDS.
   900         16  WS-INS-AGE-SET             PIC X VALUE 'N'.
   901         16  WS-JNT-AGE-SET             PIC X VALUE 'N'.
   902         16  WS-INS-AGE-DEFAULTED       PIC X VALUE 'N'.
   903         16  WS-JNT-AGE-DEFAULTED       PIC X VALUE 'N'.
   904
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page  18
* EL6311.cbl
   906
   907******************************************************************
   908*                                                                *
   909*                 B A T C H   T O T A L S                        *
   910*                                                                *
   911******************************************************************
   912
   913     12  WS-BATCH-RECORD.
   914         16  FILLER                       PIC X(10).
   915         16  WS-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   916         16  WS-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   917         16  WS-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   918         16  WS-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   919         16  WS-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   920         16  WS-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   921         16  WS-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   922         16  WS-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   923         16  WS-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   924         16  WS-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   925         16  WS-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   926         16  WS-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   927         16  WS-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
   928         16  WS-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
   929         16  WS-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
   930         16  WS-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
   931         16  WS-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
   932         16  WS-ACCOUNT-NAME              PIC X(30).
   933         16  FILLER                       PIC X.
   934         16  WS-REFERENCE                 PIC X(12).
   935         16  FILLER                       PIC X(197).
   936
   937     12  WS-BATCH-TOTALS.
   938         16  WS-ISS-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   939         16  WS-ISS-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   940         16  WS-ISS-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   941         16  WS-ISS-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   942         16  WS-ISS-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   943         16  WS-ISS-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   944         16  WS-CAN-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   945         16  WS-CAN-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   946         16  WS-CAN-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   947         16  WS-CAN-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   948         16  WS-CAN-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   949         16  WS-CAN-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   950         16  WS-NET-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   951         16  WS-NET-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   952         16  WS-NET-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   953         16  WS-NET-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   954         16  WS-NET-AVAIL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   955         16  WS-NET-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   956         16  WS-NET-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   957
   958     12  WS-SEQ-NO-COUNTER       PIC S9(3)     COMP-3 VALUE ZEROS.
   959
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page  19
* EL6311.cbl
   961
   962******************************************************************
   963*                                                                *
   964*                E R R O R   M E S S A G E S                     *
   965*                                                                *
   966******************************************************************
   967
   968 01  ERROR-MESSAGES.
   969     12  ER-0004                 PIC  9(4) VALUE 0004.
   970     12  ER-0008                 PIC  9(4) VALUE 0008.
   971     12  ER-0023                 PIC  9(4) VALUE 0023.
   972     12  ER-0029                 PIC  9(4) VALUE 0029.
   973     12  ER-0033                 PIC  9(4) VALUE 0033.
   974     12  ER-0070                 PIC  9(4) VALUE 0070.
   975     12  ER-0220                 PIC  9(4) VALUE 0220.
   976     12  er-0229                 pic  9(4) value 0229.
   977     12  ER-0248                 PIC  9(4) VALUE 0248.
   978     12  ER-0280                 PIC  9(4) VALUE 0280.
   979     12  ER-0348                 PIC  9(4) VALUE 0348.
   980     12  ER-0582                 PIC  9(4) VALUE 0582.
   981     12  ER-0877                 PIC  9(4) VALUE 0877.
   982     12  ER-1236                 PIC  9(4) VALUE 1236.
   983     12  ER-1570                 PIC  9(4) VALUE 1570.
   984     12  ER-1575                 PIC  9(4) VALUE 1575.
   985     12  ER-1577                 PIC  9(4) VALUE 1577.
   986     12  ER-1584                 PIC  9(4) VALUE 1584.
   987     12  ER-1585                 PIC  9(4) VALUE 1585.
   988     12  ER-1609                 PIC  9(4) VALUE 1609.
   989     12  er-1762                 pic  9(4) value 1762.
   990     12  ER-1819                 PIC  9(4) VALUE 1819.
   991     12  ER-2077                 PIC  9(4) VALUE 2077.
   992     12  ER-2129                 PIC  9(4) VALUE 2129.
   993     12  ER-2188                 PIC  9(4) VALUE 2188.
   994     12  ER-2192                 PIC  9(4) VALUE 2192.
   995     12  ER-2196                 PIC  9(4) VALUE 2196.
   996     12  ER-2197                 PIC  9(4) VALUE 2197.
   997     12  ER-2198                 PIC  9(4) VALUE 2198.
   998     12  ER-2200                 PIC  9(4) VALUE 2200.
   999     12  ER-2212                 PIC  9(4) VALUE 2212.
  1000     12  ER-2218                 PIC  9(4) VALUE 2218.
  1001     12  ER-2220                 PIC  9(4) VALUE 2220.
  1002     12  ER-2222                 PIC  9(4) VALUE 2222.
  1003     12  ER-2223                 PIC  9(4) VALUE 2223.
  1004     12  ER-2224                 PIC  9(4) VALUE 2224.
  1005     12  ER-2225                 PIC  9(4) VALUE 2225.
  1006     12  ER-2226                 PIC  9(4) VALUE 2226.
  1007     12  ER-2227                 PIC  9(4) VALUE 2227.
  1008     12  ER-2228                 PIC  9(4) VALUE 2228.
  1009     12  ER-2240                 PIC  9(4) VALUE 2240.
  1010     12  ER-2241                 PIC  9(4) VALUE 2241.
  1011     12  ER-2242                 PIC  9(4) VALUE 2242.
  1012     12  ER-2243                 PIC  9(4) VALUE 2243.
  1013     12  ER-2244                 PIC  9(4) VALUE 2244.
  1014     12  ER-2245                 PIC  9(4) VALUE 2245.
  1015     12  ER-2246                 PIC  9(4) VALUE 2246.
  1016     12  ER-2247                 PIC  9(4) VALUE 2247.
  1017     12  ER-2251                 PIC  9(4) VALUE 2251.
  1018     12  ER-2252                 PIC  9(4) VALUE 2252.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page  20
* EL6311.cbl
  1019     12  ER-2253                 PIC  9(4) VALUE 2253.
  1020     12  ER-2254                 PIC  9(4) VALUE 2254.
  1021     12  ER-2255                 PIC  9(4) VALUE 2255.
  1022     12  ER-2256                 PIC  9(4) VALUE 2256.
  1023     12  ER-2257                 PIC  9(4) VALUE 2257.
  1024     12  ER-2258                 PIC  9(4) VALUE 2258.
  1025     12  ER-2259                 PIC  9(4) VALUE 2259.
  1026     12  ER-2260                 PIC  9(4) VALUE 2260.
  1027     12  ER-2261                 PIC  9(4) VALUE 2261.
  1028     12  ER-2287                 PIC  9(4) VALUE 2287.
  1029     12  ER-2336                 PIC  9(4) VALUE 2336.
  1030     12  ER-2337                 PIC  9(4) VALUE 2337.
  1031     12  ER-2437                 PIC  9(4) VALUE 2437.
  1032     12  ER-2471                 PIC  9(4) VALUE 2471.
  1033     12  ER-2530                 PIC  9(4) VALUE 2530.
  1034     12  ER-2531                 PIC  9(4) VALUE 2531.
  1035     12  ER-2532                 PIC  9(4) VALUE 2532.
  1036     12  ER-2533                 PIC  9(4) VALUE 2533.
  1037     12  ER-2547                 PIC  9(4) VALUE 2547.
  1038     12  ER-2591                 PIC  9(4) VALUE 2591.
  1039     12  ER-2592                 PIC  9(4) VALUE 2592.
  1040     12  ER-2593                 PIC  9(4) VALUE 2593.
  1041     12  ER-2600                 PIC  9(4) VALUE 2600.
  1042     12  ER-2601                 PIC  9(4) VALUE 2601.
  1043     12  ER-2604                 PIC  9(4) VALUE 2604.
  1044     12  ER-2605                 PIC  9(4) VALUE 2605.
  1045     12  ER-2606                 PIC  9(4) VALUE 2606.
  1046     12  ER-2607                 PIC  9(4) VALUE 2607.
  1047     12  ER-2622                 PIC  9(4) VALUE 2622.
  1048     12  ER-2625                 PIC  9(4) VALUE 2625.
  1049     12  ER-2626                 PIC  9(4) VALUE 2626.
  1050     12  ER-2627                 PIC  9(4) VALUE 2627.
  1051     12  ER-2628                 PIC  9(4) VALUE 2628.
  1052     12  ER-2629                 PIC  9(4) VALUE 2629.
  1053     12  ER-2630                 PIC  9(4) VALUE 2630.
  1054     12  ER-2631                 PIC  9(4) VALUE 2631.
  1055     12  ER-2632                 PIC  9(4) VALUE 2632.
  1056     12  ER-2633                 PIC  9(4) VALUE 2633.
  1057     12  ER-2634                 PIC  9(4) VALUE 2634.
  1058     12  ER-2635                 PIC  9(4) VALUE 2635.
  1059     12  ER-2636                 PIC  9(4) VALUE 2636.
  1060     12  ER-2639                 PIC  9(4) VALUE 2639.
  1061     12  ER-2640                 PIC  9(4) VALUE 2640.
  1062     12  ER-2647                 PIC  9(4) VALUE 2647.
  1063     12  ER-2648                 PIC  9(4) VALUE 2648.
  1064     12  ER-2649                 PIC  9(4) VALUE 2649.
  1065     12  ER-2650                 PIC  9(4) VALUE 2650.
  1066     12  ER-2651                 PIC  9(4) VALUE 2651.
  1067     12  ER-2653                 PIC  9(4) VALUE 2653.
  1068     12  ER-2654                 PIC  9(4) VALUE 2654.
  1069     12  ER-2655                 PIC  9(4) VALUE 2655.
  1070     12  ER-2656                 PIC  9(4) VALUE 2656.
  1071     12  ER-2657                 PIC  9(4) VALUE 2657.
  1072     12  ER-2660                 PIC  9(4) VALUE 2660.
  1073     12  ER-2661                 PIC  9(4) VALUE 2661.
  1074     12  ER-2662                 PIC  9(4) VALUE 2662.
  1075     12  ER-2663                 PIC  9(4) VALUE 2663.
  1076     12  ER-2664                 PIC  9(4) VALUE 2664.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page  21
* EL6311.cbl
  1077     12  ER-2667                 PIC  9(4) VALUE 2667.
  1078     12  ER-2668                 PIC  9(4) VALUE 2668.
  1079     12  ER-2669                 PIC  9(4) VALUE 2669.
  1080     12  ER-2670                 PIC  9(4) VALUE 2670.
  1081     12  ER-2671                 PIC  9(4) VALUE 2671.
  1082     12  ER-2672                 PIC  9(4) VALUE 2672.
  1083     12  ER-2673                 PIC  9(4) VALUE 2673.
  1084     12  ER-2677                 PIC  9(4) VALUE 2677.
  1085     12  ER-2678                 PIC  9(4) VALUE 2678.
  1086     12  ER-2679                 PIC  9(4) VALUE 2679.
  1087     12  ER-2680                 PIC  9(4) VALUE 2680.
  1088     12  ER-2681                 PIC  9(4) VALUE 2681.
  1089     12  ER-2682                 PIC  9(4) VALUE 2682.
  1090     12  ER-2683                 PIC  9(4) VALUE 2683.
  1091     12  ER-2684                 PIC  9(4) VALUE 2684.
  1092     12  ER-2686                 PIC  9(4) VALUE 2686.
  1093     12  ER-2689                 PIC  9(4) VALUE 2689.
  1094     12  ER-2690                 PIC  9(4) VALUE 2690.
  1095     12  ER-2693                 PIC  9(4) VALUE 2693.
  1096     12  ER-2695                 PIC  9(4) VALUE 2695.
  1097     12  ER-2701                 PIC  9(4) VALUE 2701.
  1098     12  ER-2720                 PIC  9(4) VALUE 2720.
  1099     12  ER-2709                 PIC  9(4) VALUE 2709.
  1100     12  ER-2704                 PIC  9(4) VALUE 2704.
  1101     12  ER-2725                 PIC  9(4) VALUE 2725.
  1102     12  ER-2726                 PIC  9(4) VALUE 2726.
  1103     12  ER-2728                 PIC  9(4) VALUE 2728.
  1104     12  ER-2729                 PIC  9(4) VALUE 2729.
  1105     12  ER-2731                 PIC  9(4) VALUE 2731.
  1106     12  ER-2732                 PIC  9(4) VALUE 2732.
  1107     12  ER-2733                 PIC  9(4) VALUE 2733.
  1108     12  ER-2735                 PIC  9(4) VALUE 2735.
  1109     12  ER-2738                 PIC  9(4) VALUE 2738.
  1110     12  ER-2742                 PIC  9(4) VALUE 2742.
  1111     12  ER-2743                 PIC  9(4) VALUE 2743.
  1112     12  ER-2744                 PIC  9(4) VALUE 2744.
  1113     12  ER-2747                 PIC  9(4) VALUE 2747.
  1114     12  ER-2749                 PIC  9(4) VALUE 2749.
  1115     12  ER-2753                 PIC  9(4) VALUE 2753.
  1116     12  ER-2755                 PIC  9(4) VALUE 2755.
  1117     12  ER-2757                 PIC  9(4) VALUE 2757.
  1118     12  ER-2771                 PIC  9(4) VALUE 2771.
  1119     12  ER-2774                 PIC  9(4) VALUE 2774.
  1120     12  ER-2775                 PIC  9(4) VALUE 2775.
  1121     12  ER-2776                 PIC  9(4) VALUE 2776.
  1122     12  ER-2777                 PIC  9(4) VALUE 2777.
  1123     12  ER-2794                 PIC  9(4) VALUE 2794.
  1124     12  ER-2799                 PIC  9(4) VALUE 2799.
  1125     12  er-2878                 pic  9(4) value 2878.
  1126     12  ER-2900                 PIC  9(4) VALUE 2900.
  1127     12  ER-2902                 PIC  9(4) VALUE 2902.
  1128     12  ER-2945                 PIC  9(4) VALUE 2945.
  1129     12  ER-3000                 PIC  9(4) VALUE 3000.
  1130     12  ER-3006                 PIC  9(4) VALUE 3006.
  1131     12  ER-3054                 PIC  9(4) VALUE 3054.
  1132     12  er-3070                 pic  9(4) value 3070.
  1133     12  ER-3224                 PIC  9(4) VALUE 3224.
  1134     12  ER-3269                 PIC  9(4) VALUE 3269.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page  22
* EL6311.cbl
  1135     12  er-3444                 pic  9(4) value 3444.
  1136     12  er-3446                 pic  9(4) value 3446.
  1137     12  er-3447                 pic  9(4) value 3447.
  1138     12  er-3448                 pic  9(4) value 3448.
  1139     12  er-3449                 pic  9(4) value 3449.
  1140     12  ER-3456                 PIC  9(4) VALUE 3456.
  1141     12  ER-3457                 PIC  9(4) VALUE 3457.
  1142     12  ER-3458                 PIC  9(4) VALUE 3458.
  1143     12  ER-3504                 PIC  9(4) VALUE 3504.
  1144     12  ER-3513                 PIC  9(4) VALUE 3513.
  1145     12  ER-3831                 PIC  9(4) VALUE 3831.
  1146     12  ER-3834                 PIC  9(4) VALUE 3834.
  1147     12  ER-3835                 PIC  9(4) VALUE 3835.
  1148     12  ER-4005                 PIC  9(4) VALUE 4005.
  1149     12  ER-7144                 PIC  9(4) VALUE 7144.
  1150     12  ER-7401                 PIC  9(4) VALUE 7401.
  1151     12  ER-7402                 PIC  9(4) VALUE 7402.
  1152     12  ER-7403                 PIC  9(4) VALUE 7403.
  1153     12  ER-7404                 PIC  9(4) VALUE 7404.
  1154     12  ER-7423                 PIC  9(4) VALUE 7423.
  1155     12  ER-7424                 PIC  9(4) VALUE 7424.
  1156     12  ER-7433                 PIC  9(4) VALUE 7433.
  1157     12  ER-7450                 PIC  9(4) VALUE 7450.
  1158     12  ER-7451                 PIC  9(4) VALUE 7451.
  1159     12  ER-7530                 PIC  9(4) VALUE 7530.
  1160     12  ER-7573                 PIC  9(4) VALUE 7573.
  1161     12  ER-7631                 PIC  9(4) VALUE 7631.
  1162     12  ER-7632                 PIC  9(4) VALUE 7632.
  1163     12  ER-7633                 PIC  9(4) VALUE 7633.
  1164     12  ER-7537                 PIC  9(4) VALUE 7537.
  1165     12  ER-7538                 PIC  9(4) VALUE 7538.
  1166     12  ER-7574                 PIC  9(4) VALUE 7574.
  1167     12  ER-7997                 PIC  9(4) VALUE 7997.
  1168     12  ER-7998                 PIC  9(4) VALUE 7998.
  1169     12  ER-8148                 PIC  9(4) VALUE 8148.
  1170     12  ER-9063                 PIC  9(4) VALUE 9063.
  1171     12  ER-9076                 PIC  9(4) VALUE 9076.
  1172     12  ER-9618                 PIC  9(4) VALUE 9618.
  1173     12  ER-9841                 PIC  9(4) VALUE 9841.
  1174     12  er-9853                 pic  9(4) value 9853.
  1175
  1176*                                COPY ELCTEXT.
  1177******************************************************************
  1178*                                                                *
  1179*                                                                *
  1180*                            ELCTEXT.                            *
  1181*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1182*                            VMOD=2.008                          *
  1183*                                                                *
  1184*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
  1185*                                     FORM LETTERS,              *
  1186*                                     CERT FORM DISPLAY.
  1187*                                                                *
  1188*   FILE TYPE = VSAM,KSDS                                        *
  1189*   RECORD SIZE = 100   RECFORM = FIXED                          *
  1190*                                                                *
  1191*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
  1192*       ALTERNATE INDEX = NONE                                   *
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page  23
* EL6311.cbl
  1193*                                                                *
  1194*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
  1195*       ALTERNATE INDEX = NONE                                   *
  1196*                                                                *
  1197*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
  1198*       ALTERNATE INDEX = NONE                                   *
  1199*                                                                *
  1200*   LOG = NO                                                     *
  1201*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1202******************************************************************
  1203 01  TEXT-FILES.
  1204     12  TEXT-FILE-ID                PIC XX.
  1205         88  FORMS-FILE-TEXT            VALUE 'TF'.
  1206         88  LETTER-FILE-TEXT           VALUE 'TL'.
  1207         88  HELP-FILE-TEXT             VALUE 'TH'.
  1208
  1209     12  TX-CONTROL-PRIMARY.
  1210         16  TX-COMPANY-CD           PIC X.
  1211             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
  1212         16  TX-ACCESS-CD-GENL       PIC X(12).
  1213
  1214         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1215             20  TX-LETTER-NO        PIC X(4).
  1216             20  FILLER              PIC X(8).
  1217
  1218         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1219             20  TX-FORM-NO          PIC X(12).
  1220
  1221         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1222             20  TX-HELP-TYPE        PIC X.
  1223                 88  HELP-FOR-GENERAL   VALUE ' '.
  1224                 88  HELP-BY-SCREEN     VALUE 'S'.
  1225                 88  HELP-BY-ERROR      VALUE 'E'.
  1226             20  TX-SCREEN-OR-ERROR  PIC X(4).
  1227                 88  GENERAL-INFO-HELP  VALUE '0000'.
  1228             20  TX-HELP-FOR-COMPANY  PIC XXX.
  1229                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
  1230             20  FILLER              PIC X(4).
  1231
  1232         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
  1233
  1234     12  TX-PROCESS-CONTROL          PIC XX.
  1235         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
  1236
  1237     12  TX-TEXT-LINE                PIC X(70).
  1238
  1239     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
  1240         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
  1241         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
  1242         88  TX-VALID-FORM-SQUEEZE-VALUE
  1243                                        VALUE 'Y' ' '.
  1244
  1245     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
  1246         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
  1247         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
  1248         88  TX-DO-NOT-ADJUST           VALUE 'N'.
  1249         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
  1250         88  TX-NEW-PARAGRAPH           VALUE 'P'.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page  24
* EL6311.cbl
  1251         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
  1252         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
  1253                                              'K' 'N' ' '
  1254                                              'Z'.
  1255
  1256     12  TX-ARCHIVE-SW               PIC X.
  1257         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
  1258         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
  1259         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
  1260
  1261     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
  1262     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
  1263
  1264     12  TX-BSR-CODE                 PIC X.
  1265         88  TX-BSR-LETTER              VALUE 'B'.
  1266         88  TX-NON-BSR-LETTER          VALUE ' '.
  1267
  1268     12  FILLER                      PIC X.
  1269*****************************************************************
  1270*                                COPY ELCCRTO.
  1271******************************************************************
  1272*                                                                *
  1273*                            ELCCRTO.                            *
  1274*                                                                *
  1275*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  1276*                                                                *
  1277*   FILE TYPE = VSAM,KSDS                                        *
  1278*   RECORD SIZE = 524  RECFORM = FIXED                           *
  1279*                                                                *
  1280*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  1281*                                                                *
  1282*   LOG = YES                                                    *
  1283*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1284******************************************************************
  1285*                   C H A N G E   L O G
  1286*
  1287* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1288*-----------------------------------------------------------------
  1289*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1290* EFFECTIVE    NUMBER
  1291*-----------------------------------------------------------------
  1292* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  1293* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  1294* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  1295* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  1296* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  1297******************************************************************
  1298 01  ORIGINAL-CERTIFICATE.
  1299     12  OC-RECORD-ID                      PIC XX.
  1300         88  VALID-OC-ID                      VALUE 'OC'.
  1301     12  OC-CONTROL-PRIMARY.
  1302         16  OC-COMPANY-CD                 PIC X.
  1303         16  OC-CARRIER                    PIC X.
  1304         16  OC-GROUPING                   PIC X(6).
  1305         16  OC-STATE                      PIC XX.
  1306         16  OC-ACCOUNT                    PIC X(10).
  1307         16  OC-CERT-EFF-DT                PIC XX.
  1308         16  OC-CERT-NO.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page  25
* EL6311.cbl
  1309             20  OC-CERT-PRIME             PIC X(10).
  1310             20  OC-CERT-SFX               PIC X.
  1311         16  OC-RECORD-TYPE                PIC X.
  1312         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  1313     12  OC-LAST-MAINT-DT                  PIC XX.
  1314     12  OC-LAST-MAINT-BY                  PIC X(4).
  1315     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  1316     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  1317     12  FILLER                            PIC X(49).
  1318     12  OC-ORIG-REC.
  1319         16  OC-INS-LAST-NAME              PIC X(15).
  1320         16  OC-INS-FIRST-NAME             PIC X(10).
  1321         16  OC-INS-MIDDLE-INIT            PIC X.
  1322         16  OC-INS-AGE                    PIC S999     COMP-3.
  1323         16  OC-JNT-LAST-NAME              PIC X(15).
  1324         16  OC-JNT-FIRST-NAME             PIC X(10).
  1325         16  OC-JNT-MIDDLE-INIT            PIC X.
  1326         16  OC-JNT-AGE                    PIC S999     COMP-3.
  1327         16  OC-LF-BENCD                   PIC XX.
  1328         16  OC-LF-TERM                    PIC S999      COMP-3.
  1329         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  1330         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  1331         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  1332         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  1333         16  OC-LF-EXP-DT                  PIC XX.
  1334         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  1335         16  OC-LF-CANCEL-DT               PIC XX.
  1336         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  1337         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1338         16  OC-AH-BENCD                   PIC XX.
  1339         16  OC-AH-TERM                    PIC S999      COMP-3.
  1340         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  1341         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  1342         16  OC-AH-EXP-DT                  PIC XX.
  1343         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  1344         16  OC-AH-CP                      PIC 99.
  1345         16  OC-AH-CANCEL-DT               PIC XX.
  1346         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  1347         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1348         16  OC-CRED-BENE-NAME             PIC X(25).
  1349         16  OC-1ST-PMT-DT                 PIC XX.
  1350         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  1351         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  1352         16  OC-ISSUE-TRAN-IND             PIC X.
  1353         16  OC-CANCEL-TRAN-IND            PIC X.
  1354         16  FILLER                        PIC X(211).
  1355
  1356     12  FILLER                            PIC X(50).
  1357******************************************************************
  1358*                                COPY ERCACCT.
  1359******************************************************************
  1360*                                                                *
  1361*                                                                *
  1362*                            ERCACCT                             *
  1363*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1364*                            VMOD=2.031                          *
  1365*                                                                *
  1366*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page  26
* EL6311.cbl
  1367*                                                                *
  1368*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  1369*   VSAM ACCOUNT MASTER FILES.                                   *
  1370*                                                                *
  1371*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  1372*                                                                *
  1373*   FILE TYPE = VSAM,KSDS                                        *
  1374*   RECORD SIZE = 2000  RECFORM = FIX                            *
  1375*                                                                *
  1376*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  1377*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  1378*                                                                *
  1379*   LOG = NO                                                     *
  1380*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1381*                                                                *
  1382*                                                                *
  1383******************************************************************
  1384*                   C H A N G E   L O G
  1385*
  1386* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1387*-----------------------------------------------------------------
  1388*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1389* EFFECTIVE    NUMBER
  1390*-----------------------------------------------------------------
  1391* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  1392* 092705    2005050300006  PEMA  ADD SPP LEASES
  1393* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  1394* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1395* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  1396* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  1397* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  1398* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  1399******************************************************************
  1400
  1401 01  ACCOUNT-MASTER.
  1402     12  AM-RECORD-ID                      PIC XX.
  1403         88  VALID-AM-ID                      VALUE 'AM'.
  1404
  1405     12  AM-CONTROL-PRIMARY.
  1406         16  AM-COMPANY-CD                 PIC X.
  1407         16  AM-MSTR-CNTRL.
  1408             20  AM-CONTROL-A.
  1409                 24  AM-CARRIER            PIC X.
  1410                 24  AM-GROUPING.
  1411                     28 AM-GROUPING-PREFIX PIC XXX.
  1412                     28 AM-GROUPING-PRIME  PIC XXX.
  1413                 24  AM-STATE              PIC XX.
  1414                 24  AM-ACCOUNT.
  1415                     28  AM-ACCOUNT-PREFIX PIC X(4).
  1416                     28  AM-ACCOUNT-PRIME  PIC X(6).
  1417             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  1418                                           PIC X(19).
  1419             20  AM-CNTRL-B.
  1420                 24  AM-EXPIRATION-DT      PIC XX.
  1421                 24  FILLER                PIC X(4).
  1422             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  1423                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  1424
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page  27
* EL6311.cbl
  1425     12  AM-CONTROL-BY-VAR-GRP.
  1426         16  AM-COMPANY-CD-A1              PIC X.
  1427         16  AM-VG-CARRIER                 PIC X.
  1428         16  AM-VG-GROUPING                PIC X(6).
  1429         16  AM-VG-STATE                   PIC XX.
  1430         16  AM-VG-ACCOUNT                 PIC X(10).
  1431         16  AM-VG-DATE.
  1432             20  AM-VG-EXPIRATION-DT       PIC XX.
  1433             20  FILLER                    PIC X(4).
  1434         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  1435                                           PIC 9(11)      COMP-3.
  1436     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  1437         16  FILLER                        PIC X(10).
  1438         16  AM-VG-KEY3.
  1439             20  AM-VG3-ACCOUNT            PIC X(10).
  1440             20  AM-VG3-EXP-DT             PIC XX.
  1441         16  FILLER                        PIC X(4).
  1442     12  AM-MAINT-INFORMATION.
  1443         16  AM-LAST-MAINT-DT              PIC XX.
  1444         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1445         16  AM-LAST-MAINT-USER            PIC X(4).
  1446         16  FILLER                        PIC XX.
  1447
  1448     12  AM-EFFECTIVE-DT                   PIC XX.
  1449     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  1450
  1451     12  AM-PREV-DATES  COMP-3.
  1452         16  AM-PREV-EXP-DT                PIC 9(11).
  1453         16  AM-PREV-EFF-DT                PIC 9(11).
  1454
  1455     12  AM-REPORT-CODE-1                  PIC X(10).
  1456     12  AM-REPORT-CODE-2                  PIC X(10).
  1457
  1458     12  AM-CITY-CODE                      PIC X(4).
  1459     12  AM-COUNTY-PARISH                  PIC X(6).
  1460
  1461     12  AM-NAME                           PIC X(30).
  1462     12  AM-PERSON                         PIC X(30).
  1463     12  AM-ADDRS                          PIC X(30).
  1464     12  AM-CITY.
  1465         16  AM-ADDR-CITY                  PIC X(28).
  1466         16  AM-ADDR-STATE                 PIC XX.
  1467     12  AM-ZIP.
  1468         16  AM-ZIP-PRIME.
  1469             20  AM-ZIP-PRI-1ST            PIC X.
  1470                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  1471             20  FILLER                    PIC X(4).
  1472         16  AM-ZIP-PLUS4                  PIC X(4).
  1473     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  1474         16  AM-CAN-POSTAL-1               PIC XXX.
  1475         16  AM-CAN-POSTAL-2               PIC XXX.
  1476         16  FILLER                        PIC XXX.
  1477     12  AM-TEL-NO.
  1478         16  AM-AREA-CODE                  PIC 999.
  1479         16  AM-TEL-PRE                    PIC 999.
  1480         16  AM-TEL-NBR                    PIC 9(4).
  1481     12  AM-TEL-LOC                        PIC X.
  1482         88  AM-TEL-AT-HOME                   VALUE 'H'.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page  28
* EL6311.cbl
  1483         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  1484
  1485     12  AM-COMM-STRUCTURE.
  1486         16  AM-DEFN-1.
  1487             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  1488                 24  AM-AGT.
  1489                     28  AM-AGT-PREFIX     PIC X(4).
  1490                     28  AM-AGT-PRIME      PIC X(6).
  1491                 24  AM-COM-TYP            PIC X.
  1492                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  1493                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  1494                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  1495                 24  AM-RECALC-LV-INDIC    PIC X.
  1496                 24  AM-RETRO-LV-INDIC     PIC X.
  1497                 24  AM-GL-CODES           PIC X.
  1498                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  1499                 24  FILLER                PIC X(01).
  1500         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  1501             20  AM-COM-TBLS        OCCURS 10 TIMES.
  1502                 24  FILLER                PIC X(11).
  1503                 24  AM-L-COMA             PIC XXX.
  1504                 24  AM-J-COMA             PIC XXX.
  1505                 24  AM-A-COMA             PIC XXX.
  1506                 24  FILLER                PIC X(6).
  1507
  1508     12  AM-COMM-CHANGE-STATUS             PIC X.
  1509         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  1510
  1511     12  AM-CSR-CODE                       PIC X(4).
  1512
  1513     12  AM-BILLING-STATUS                 PIC X.
  1514         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  1515         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  1516     12  AM-AUTO-REFUND-SW                 PIC X.
  1517         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  1518         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  1519     12  AM-GPCD                           PIC 99.
  1520     12  AM-IG                             PIC X.
  1521         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  1522         88  AM-HAS-GROUP                     VALUE '2'.
  1523     12  AM-STATUS                         PIC X.
  1524         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  1525         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  1526         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  1527         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  1528         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  1529         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  1530         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  1531         88  AM-ACCOUNT-LAPSED                VALUE '7'.
  1532         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  1533         88  AM-ACCOUNT-PENDING               VALUE '9'.
  1534     12  AM-REMIT-TO                       PIC 99.
  1535     12  AM-ID-NO                          PIC X(11).
  1536
  1537     12  AM-CAL-TABLE                      PIC XX.
  1538     12  AM-LF-DEVIATION                   PIC XXX.
  1539     12  AM-AH-DEVIATION                   PIC XXX.
  1540     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page  29
* EL6311.cbl
  1541     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  1542     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  1543     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  1544     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1545     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1546
  1547     12  AM-USER-FIELDS.
  1548         16  AM-FLD-1                      PIC XX.
  1549         16  AM-FLD-2                      PIC XX.
  1550         16  AM-FLD-3                      PIC XX.
  1551         16  AM-FLD-4                      PIC XX.
  1552         16  AM-FLD-5                      PIC XX.
  1553
  1554     12  AM-1ST-PROD-DATE.
  1555         16  AM-1ST-PROD-YR                PIC XX.
  1556         16  AM-1ST-PROD-MO                PIC XX.
  1557         16  AM-1ST-PROD-DA                PIC XX.
  1558     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  1559     12  AM-CERTS-PURGED-DATE.
  1560         16  AM-PUR-YR                     PIC XX.
  1561         16  AM-PUR-MO                     PIC XX.
  1562         16  AM-PUR-DA                     PIC XX.
  1563     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  1564     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  1565     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  1566     12  AM-INACTIVE-DATE.
  1567         16  AM-INA-MO                     PIC 99.
  1568         16  AM-INA-DA                     PIC 99.
  1569         16  AM-INA-YR                     PIC 99.
  1570     12  AM-AR-HI-CERT-DATE                PIC XX.
  1571
  1572     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  1573     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  1574
  1575     12  AM-OB-PAYMENT-MODE                PIC X.
  1576         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  1577         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  1578         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  1579         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  1580
  1581     12  AM-AH-ONLY-INDICATOR              PIC X.
  1582         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  1583         88  AM-NO-AH-ONLY                    VALUE 'N'.
  1584
  1585     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  1586
  1587     12  AM-OVER-SHORT.
  1588         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  1589         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  1590
  1591     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  1592     12  AM-DCC-CLP-STATE                  PIC XX.
  1593
  1594     12  AM-RECALC-COMM                    PIC X.
  1595     12  AM-RECALC-REIN                    PIC X.
  1596
  1597     12  AM-REI-TABLE                      PIC XXX.
  1598     12  AM-REI-ET-LF                      PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page  30
* EL6311.cbl
  1599     12  AM-REI-ET-AH                      PIC X.
  1600     12  AM-REI-PE-LF                      PIC X.
  1601     12  AM-REI-PE-AH                      PIC X.
  1602     12  AM-REI-PRT-ST                     PIC X.
  1603     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  1604     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  1605     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  1606     12  AM-REI-GROUP-A                    PIC X(6).
  1607     12  AM-REI-MORT                       PIC X(4).
  1608     12  AM-REI-PRT-OW                     PIC X.
  1609     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  1610     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  1611     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  1612     12  AM-REI-GROUP-B                    PIC X(6).
  1613
  1614     12  AM-TRUST-TYPE                     PIC X(2).
  1615
  1616     12  AM-EMPLOYER-STMT-USED             PIC X.
  1617     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  1618
  1619     12  AM-STD-AH-TYPE                    PIC XX.
  1620     12  AM-EARN-METHODS.
  1621         16  AM-EARN-METHOD-R              PIC X.
  1622             88 AM-REF-RL-R78                 VALUE 'R'.
  1623             88 AM-REF-RL-PR                  VALUE 'P'.
  1624             88 AM-REF-RL-MEAN                VALUE 'M'.
  1625             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  1626         16  AM-EARN-METHOD-L              PIC X.
  1627             88 AM-REF-LL-R78                 VALUE 'R'.
  1628             88 AM-REF-LL-PR                  VALUE 'P'.
  1629             88 AM-REF-LL-MEAN                VALUE 'M'.
  1630             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  1631         16  AM-EARN-METHOD-A              PIC X.
  1632             88 AM-REF-AH-R78                 VALUE 'R'.
  1633             88 AM-REF-AH-PR                  VALUE 'P'.
  1634             88 AM-REF-AH-MEAN                VALUE 'M'.
  1635             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  1636             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  1637             88 AM-REF-AH-NET                 VALUE 'N'.
  1638
  1639     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  1640     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  1641     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  1642
  1643     12  AM-RET-Y-N                        PIC X.
  1644     12  AM-RET-P-E                        PIC X.
  1645     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  1646     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  1647     12  AM-RET-GRP                        PIC X(6).
  1648     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  1649         16  AM-POOL-PRIME                 PIC XXX.
  1650         16  AM-POOL-SUB                   PIC XXX.
  1651     12  AM-RETRO-EARNINGS.
  1652         16  AM-RET-EARN-R                 PIC X.
  1653         16  AM-RET-EARN-L                 PIC X.
  1654         16  AM-RET-EARN-A                 PIC X.
  1655     12  AM-RET-ST-TAX-USE                 PIC X.
  1656         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page  31
* EL6311.cbl
  1657         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  1658     12  AM-RETRO-BEG-EARNINGS.
  1659         16  AM-RET-BEG-EARN-R             PIC X.
  1660         16  AM-RET-BEG-EARN-L             PIC X.
  1661         16  AM-RET-BEG-EARN-A             PIC X.
  1662     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  1663     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  1664
  1665     12  AM-USER-SELECT-OPTIONS.
  1666         16  AM-USER-SELECT-1              PIC X(10).
  1667         16  AM-USER-SELECT-2              PIC X(10).
  1668         16  AM-USER-SELECT-3              PIC X(10).
  1669         16  AM-USER-SELECT-4              PIC X(10).
  1670         16  AM-USER-SELECT-5              PIC X(10).
  1671
  1672     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  1673
  1674     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  1675
  1676     12  AM-RPT045A-SWITCH                 PIC X.
  1677         88  RPT045A-OFF                   VALUE 'N'.
  1678
  1679     12  AM-INSURANCE-LIMITS.
  1680         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  1681         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  1682
  1683     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  1684         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  1685
  1686     12  AM-DISMBR-COVERAGE-SW             PIC X.
  1687         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  1688         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  1689
  1690     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  1691
  1692     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  1693     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  1694     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  1695     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  1696     12  AM-DCC-UEF-STATE                  PIC XX.
  1697     12  FILLER                            PIC XXX.
  1698     12  AM-REPORT-CODE-3                  PIC X(10).
  1699*    12  FILLER                            PIC X(22).
  1700
  1701     12  AM-RESERVE-DATE.
  1702         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  1703         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  1704         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  1705
  1706     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  1707     12  AM-NOTIFICATION-TYPES.
  1708         16  AM-NOTIF-OF-LETTERS           PIC X.
  1709         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  1710         16  AM-NOTIF-OF-REPORTS           PIC X.
  1711         16  AM-NOTIF-OF-STATUS            PIC X.
  1712
  1713     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  1714         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page  32
* EL6311.cbl
  1715         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  1716         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  1717         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  1718
  1719     12  AM-BENEFIT-CONTROLS.
  1720         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  1721             20  AM-BENEFIT-CODE           PIC XX.
  1722             20  AM-BENEFIT-TYPE           PIC X.
  1723             20  AM-BENEFIT-REVISION       PIC XXX.
  1724             20  AM-BENEFIT-REM-TERM       PIC X.
  1725             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  1726             20  FILLER                    PIC XX.
  1727         16  FILLER                        PIC X(80).
  1728
  1729     12  AM-TRANSFER-DATA.
  1730         16  AM-TRANSFERRED-FROM.
  1731             20  AM-TRNFROM-CARRIER        PIC X.
  1732             20  AM-TRNFROM-GROUPING.
  1733                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  1734                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  1735             20  AM-TRNFROM-STATE          PIC XX.
  1736             20  AM-TRNFROM-ACCOUNT.
  1737                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  1738                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  1739             20  AM-TRNFROM-DTE            PIC XX.
  1740         16  AM-TRANSFERRED-TO.
  1741             20  AM-TRNTO-CARRIER          PIC X.
  1742             20  AM-TRNTO-GROUPING.
  1743                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  1744                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  1745             20  AM-TRNTO-STATE            PIC XX.
  1746             20  AM-TRNTO-ACCOUNT.
  1747                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  1748                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  1749             20  AM-TRNTO-DTE              PIC XX.
  1750         16  FILLER                        PIC X(10).
  1751
  1752     12  AM-SAVED-REMIT-TO                 PIC 99.
  1753
  1754     12  AM-COMM-STRUCTURE-SAVED.
  1755         16  AM-DEFN-1-SAVED.
  1756             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  1757                 24  AM-AGT-SV             PIC X(10).
  1758                 24  AM-COM-TYP-SV         PIC X.
  1759                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  1760                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  1761                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  1762                 24  AM-RECALC-LV-INDIC-SV PIC X.
  1763                 24  FILLER                PIC X.
  1764                 24  AM-GL-CODES-SV        PIC X.
  1765                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  1766                 24  FILLER                PIC X.
  1767         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  1768             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  1769                 24  FILLER                PIC X(11).
  1770                 24  AM-L-COMA-SV          PIC XXX.
  1771                 24  AM-J-COMA-SV          PIC XXX.
  1772                 24  AM-A-COMA-SV          PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page  33
* EL6311.cbl
  1773                 24  FILLER                PIC X(6).
  1774
  1775     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  1776         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  1777            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  1778            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  1779            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  1780
  1781     12  AM-ORIG-DEALER-NO                 PIC X(10).
  1782     12  FILLER                            PIC X(120).
  1783
  1784     12  AM-ACCOUNT-EXECUTIVE-DATA.
  1785         16  AM-CONTROL-NAME               PIC X(30).
  1786         16  AM-EXECUTIVE-ONE.
  1787             20  AM-EXEC1-NAME             PIC X(15).
  1788             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  1789                                                          COMP-3.
  1790             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  1791                                                          COMP-3.
  1792         16  AM-EXECUTIVE-TWO.
  1793             20  AM-EXEC2-NAME             PIC X(15).
  1794             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  1795                                                          COMP-3.
  1796             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  1797                                                          COMP-3.
  1798
  1799     12  AM-RETRO-ADDITIONAL-DATA.
  1800         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  1801         16  AM-RETRO-PREM-P-E             PIC X.
  1802         16  AM-RETRO-CLMS-P-I             PIC X.
  1803         16  AM-RETRO-RET-BRACKET-LF.
  1804             20  AM-RETRO-RET-METHOD-LF    PIC X.
  1805                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  1806                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  1807             20  AM-RETRO-RET-BASIS-LF     PIC X.
  1808                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  1809                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  1810             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  1811                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  1812                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  1813         16  AM-RETRO-RET-BRACKET-AH.
  1814             20  AM-RETRO-RET-METHOD-AH    PIC X.
  1815                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  1816                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  1817                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  1818             20  AM-RETRO-RET-BASIS-AH     PIC X.
  1819                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  1820                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  1821             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  1822                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  1823                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  1824
  1825     12  AM-COMMENTS.
  1826         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  1827
  1828     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  1829         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  1830         16  AM-FLI-BILLING-CODE           PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page  34
* EL6311.cbl
  1831         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  1832         16  AM-FLI-UNITED-IDENT           PIC X.
  1833         16  AM-FLI-INTEREST-LOST-DATA.
  1834             20  AM-FLI-BANK-NO            PIC X(5).
  1835             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  1836             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  1837             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  1838         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  1839             20  AM-FLI-AGT                PIC X(9).
  1840             20  AM-FLI-AGT-COMM-ACC       PIC X.
  1841             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  1842         16  FILLER                        PIC X(102).
  1843
  1844     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  1845         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  1846             20  AM-BENEFIT-DMD-CODE         PIC XX.
  1847             20  AM-BENEFIT-DMD-TYPE         PIC X.
  1848             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  1849             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  1850             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  1851         16  FILLER                          PIC X(10).
  1852******************************************************************
  1853*                                copy ERCACNT.
  1854******************************************************************
  1855*                                                                *
  1856*                                                                *
  1857*                            ERCACNT.                            *
  1858*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1859*                            VMOD=2.002                          *
  1860*                                                                *
  1861*   FILE DESCRIPTION = NOTE FILE FOR RECORDING OF ACCOUNT NOTES  *
  1862*                                                                *
  1863*   FILE TYPE = VSAM,KSDS                                        *
  1864*   RECORD SIZE = 120   RECFORM = FIXED                          *
  1865*                                                                *
  1866*   BASE CLUSTER NAME = ERACNT             RKP=2,LEN=23          *
  1867*       ALTERNATE INDEX = NONE                                   *
  1868*                                                                *
  1869*                                                                *
  1870*   LOG = YES                                                    *
  1871*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1872******************************************************************
  1873*                   C H A N G E   L O G
  1874*
  1875* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1876*-----------------------------------------------------------------
  1877*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1878* EFFECTIVE    NUMBER
  1879*-----------------------------------------------------------------
  1880* 110706  CR2006071700004  PEMA  ADD BRANCH LOCATIONS
  1881*           AND SHIPPING ADDRESS TO ACCOUNT NOTES FILE
  1882******************************************************************
  1883 01  NOTE-FILE.
  1884     12  NT-FILE-ID                  PIC XX.
  1885         88  VALID-NOTE-ID              VALUE 'NT'.
  1886
  1887     12  NT-CONTROL-PRIMARY.
  1888         16  NT-COMPANY-CD           PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page  35
* EL6311.cbl
  1889         16  NT-ACCT-NOTE-KEY.
  1890             18  NT-CARRIER              PIC X.
  1891             18  NT-GROUPING             PIC X(06).
  1892             18  NT-STATE                PIC XX.
  1893             18  NT-ACCOUNT              PIC X(10).
  1894         16  NT-RECORD-TYPE          PIC X.
  1895              88  ACCT-NOTE          VALUE '1'.
  1896              88  ACCT-BRANCH-LOC    VALUE '2'.
  1897              88  ACCT-SHIPPING-ADDR VALUE '3'.
  1898         16  NT-LINE-SEQUENCE        PIC S9(4)     COMP.
  1899
  1900     12  NT-LAST-MAINT-DT            PIC XX.
  1901     12  NT-LAST-MAINT-BY            PIC X(4).
  1902     12  NT-LAST-MAINT-HHMMSS        PIC S9(7) COMP-3.
  1903
  1904*  ALL NOTE LINES ARE RECORD TYPE '1' WITH ALMOST UNLIMITED
  1905*     SEQUENCE NUMBERS
  1906     12  NT-NOTE-INFORMATION.
  1907         16  NT-NOTE-LINE            PIC X(60).
  1908         16  FILLER                  PIC X(25).
  1909*  BOTH BRANCH LOCATION LINES ARE RECORD TYPE '2' SEQ 1 AND 2
  1910     12  NT-LOCATION-INFORMATION REDEFINES
  1911                         NT-NOTE-INFORMATION.
  1912         16  NT-BRANCH-LOC-LINE      PIC X(60).
  1913         16  FILLER                  PIC X(25).
  1914* Account special indicator is record type '2', sequence 3
  1915     12  filler REDEFINES NT-NOTE-INFORMATION.
  1916         16  nt-account-special      PIC X.
  1917         16  FILLER                  PIC X(84).
  1918*  ALL SHIPPING ADDRESS LINES ARE RECORD TYPE '3'AND
  1919*     SEQUENCE NUMBER 1 IS NAME LINE 1
  1920*     SEQUENCE NUMBER 2 IS NAME LINE 2
  1921*     SEQUENCE NUMBER 3 IS ADDR LINE 1
  1922*     SEQUENCE NUMBER 4 IS ADDR LINE 2
  1923*     SEQUENCE NUMBER 5 IS ADDR LINE 3
  1924*     SEQUENCE NUMBER 6 IS CITY, ST AND ZIP
  1925     12  NT-SHIPPING-INFORMATION REDEFINES
  1926                         NT-NOTE-INFORMATION.
  1927         16  NT-SHIPPING-LINE        PIC X(60).
  1928         16  NT-SHIP-STATE           PIC XX.
  1929         16  NT-SHIP-ZIP             PIC X(10).
  1930         16  FILLER                  PIC X(13).
  1931*****************************************************************
  1932*                                COPY ELCVADS.
  1933******************************************************************
  1934*                                                                *
  1935*                                                                *
  1936*                            ELCVADS.                            *
  1937*                                                                *
  1938*   FILE DESCRIPTION = VIRGINIA DISLCOSURE FIELDS PASSED TO      *
  1939*   ELVADS                  LENGTH = 350                         *
  1940******************************************************************
  1941******************************************************************
  1942*                   C H A N G E   L O G
  1943*
  1944* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1945*-----------------------------------------------------------------
  1946*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page  36
* EL6311.cbl
  1947* EFFECTIVE    NUMBER
  1948*-----------------------------------------------------------------
  1949* 100111    2011022800001  AJRA  NAPERSOFT
  1950******************************************************************
  1951
  1952 01  VIRGINIA-DISCLOSURE.
  1953     12  VD-COMPANY-CD              PIC X.
  1954     12  VD-CARRIER                 PIC X.
  1955     12  VD-GROUPING.
  1956         20  VD-GROUPING-PREFIX     PIC XXX.
  1957         20  VD-GROUPING-PRIME      PIC XXX.
  1958     12  VD-STATE                   PIC XX.
  1959     12  VD-ACCOUNT.
  1960         20  VD-ACCOUNT-PREFIX      PIC X(4).
  1961         20  VD-ACCOUNT-PRIME       PIC X(6).
  1962     12  VD-CERT-EFF-DT             PIC XX.
  1963     12  VD-CERT-NO.
  1964         20  VD-CERT-PRIME          PIC X(10).
  1965         20  VD-CERT-SFX            PIC X.
  1966     12  VD-ENTRY-BATCH             PIC X(6).
  1967     12  VD-CSR-ID                  PIC X(4).
  1968     12  VD-NAME.
  1969         20  VD-INSURED-LAST-NAME   PIC X(15).
  1970         20  VD-INSURED-FIRST-NAME.
  1971             24  VD-INSURED-1ST-INIT PIC X.
  1972             24  FILLER             PIC X(9).
  1973         20  VD-INSURED-MIDDLE-INIT PIC X.
  1974     12  VD-JOINT-INSURED.
  1975         20 VD-JOINT-LAST-NAME      PIC X(15).
  1976         20 VD-JOINT-FIRST-NAME.
  1977            24  VD-JOINT-FIRST-INIT PIC X.
  1978            24  FILLER              PIC X(9).
  1979         20 VD-JOINT-MIDDLE-INIT    PIC X.
  1980     12  VD-INSURED-ADDRESS-1       PIC X(30).
  1981     12  VD-INSURED-ADDRESS-2       PIC X(30).
  1982     12  VD-INSURED-CITY-STATE.
  1983         20  VD-INSURED-CITY        PIC X(28).
  1984         20  VD-INSURED-STATE       PIC XX.
  1985     12  VD-INSURED-ZIP-CODE.
  1986         20  VD-INSURED-ZIP-PRIME.
  1987             24  VD-INSURED-ZIP-1   PIC X.
  1988                 88  VD-CANADIAN-POST-CODE
  1989                                       VALUE 'A' THRU 'Z'.
  1990             24  FILLER             PIC X(4).
  1991         20  VD-INSURED-ZIP-PLUS4   PIC X(4).
  1992     12  VD-BENEFICIARY-NAME        PIC X(30).
  1993     12  VD-ACCOUNT-NAME            PIC X(30).
  1994     12  VD-LOAN-TERM               PIC S999   COMP-3.
  1995     12  VD-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  1996     12  VD-1ST-PMT-DT              PIC XX.
  1997     12  VD-LIFE-BENEFIT-CD         PIC XX.
  1998         88  VD-VALID-LIFE             VALUE '01' THRU '89'.
  1999         88  VD-INVALID-LIFE           VALUE '  ' '00'
  2000                                             '90' THRU '99'.
  2001     12  VD-LF-BENEFIT-CD   REDEFINES VD-LIFE-BENEFIT-CD
  2002                                    PIC XX.
  2003     12  VD-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  2004     12  VD-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page  37
* EL6311.cbl
  2005     12  VD-LF-RATE                 PIC S99V9(5)   COMP-3.
  2006     12  VD-LF-TERM                 PIC S999   COMP-3.
  2007     12  VD-AH-BENEFIT-CD           PIC XX.
  2008         88  VD-VALID-AH               VALUE '01' THRU '89'.
  2009         88  VD-INVALID-AH             VALUE '  ' '00'
  2010                                             '90' THRU '99'.
  2011     12  VD-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  2012     12  VD-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  2013     12  VD-AH-RATE                 PIC S99V9(5)   COMP-3.
  2014     12  VD-AH-TERM                 PIC S999   COMP-3.
  2015     12  VD-LETTER-ID               PIC X(4).
  2016     12  VD-PROC-ID                 PIC X(4).
  2017     12  VD-COMP-ID                 PIC X(3).
  2018     12  VD-CURRENT-DATE            PIC XX.
  2019     12  VD-CURRENT-TIME            PIC S9(6) COMP-3.
  2020     12  VD-ARCHIVE-NO              PIC S9(08) COMP VALUE +0.
  2021     12  FILLER                     PIC X(32).
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page  38
* EL6311.cbl
  2023*    COPY ELCDATE.
  2024******************************************************************
  2025*                                                                *
  2026*                                                                *
  2027*                            ELCDATE.                            *
  2028*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2029*                            VMOD=2.003
  2030*                                                                *
  2031*                                                                *
  2032*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  2033*                 LENGTH = 200                                   *
  2034******************************************************************
  2035
  2036 01  DATE-CONVERSION-DATA.
  2037     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  2038     12  DC-OPTION-CODE                PIC X.
  2039         88  BIN-TO-GREG                VALUE ' '.
  2040         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  2041         88  EDIT-GREG-TO-BIN           VALUE '2'.
  2042         88  YMD-GREG-TO-BIN            VALUE '3'.
  2043         88  MDY-GREG-TO-BIN            VALUE '4'.
  2044         88  JULIAN-TO-BIN              VALUE '5'.
  2045         88  BIN-PLUS-ELAPSED           VALUE '6'.
  2046         88  FIND-CENTURY               VALUE '7'.
  2047         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  2048         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  2049         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  2050         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  2051         88  JULIAN-TO-BIN-3            VALUE 'C'.
  2052         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  2053         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  2054         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  2055         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  2056         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  2057         88  CHECK-LEAP-YEAR            VALUE 'H'.
  2058         88  BIN-3-TO-GREG              VALUE 'I'.
  2059         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  2060         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  2061         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  2062         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  2063         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  2064         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  2065         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  2066         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  2067         88  THREE-CHARACTER-BIN
  2068                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  2069         88  GREGORIAN-TO-BIN
  2070                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  2071         88  BIN-TO-GREGORIAN
  2072                  VALUES ' ' '1' 'I' '8' 'G'.
  2073         88  JULIAN-TO-BINARY
  2074                  VALUES '5' 'C' 'E' 'F'.
  2075     12  DC-ERROR-CODE                 PIC X.
  2076         88  NO-CONVERSION-ERROR        VALUE ' '.
  2077         88  DATE-CONVERSION-ERROR
  2078                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  2079         88  DATE-IS-ZERO               VALUE '1'.
  2080         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page  39
* EL6311.cbl
  2081         88  DATE-IS-INVALID            VALUE '3'.
  2082         88  DATE1-GREATER-DATE2        VALUE '4'.
  2083         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  2084         88  DATE-INVALID-OPTION        VALUE '9'.
  2085         88  INVALID-CENTURY            VALUE 'A'.
  2086         88  ONLY-CENTURY               VALUE 'B'.
  2087         88  ONLY-LEAP-YEAR             VALUE 'C'.
  2088         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  2089     12  DC-END-OF-MONTH               PIC X.
  2090         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  2091     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  2092         88  USE-NORMAL-PROCESS         VALUE ' '.
  2093         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  2094         88  ADJUST-UP-100-YRS          VALUE '2'.
  2095     12  FILLER                        PIC X.
  2096     12  DC-CONVERSION-DATES.
  2097         16  DC-BIN-DATE-1             PIC XX.
  2098         16  DC-BIN-DATE-2             PIC XX.
  2099         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  2100         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  2101                       DC-GREG-DATE-1-EDIT.
  2102             20  DC-EDIT1-MONTH        PIC 99.
  2103             20  SLASH1-1              PIC X.
  2104             20  DC-EDIT1-DAY          PIC 99.
  2105             20  SLASH1-2              PIC X.
  2106             20  DC-EDIT1-YEAR         PIC 99.
  2107         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  2108         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  2109                     DC-GREG-DATE-2-EDIT.
  2110             20  DC-EDIT2-MONTH        PIC 99.
  2111             20  SLASH2-1              PIC X.
  2112             20  DC-EDIT2-DAY          PIC 99.
  2113             20  SLASH2-2              PIC X.
  2114             20  DC-EDIT2-YEAR         PIC 99.
  2115         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  2116         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  2117                     DC-GREG-DATE-1-YMD.
  2118             20  DC-YMD-YEAR           PIC 99.
  2119             20  DC-YMD-MONTH          PIC 99.
  2120             20  DC-YMD-DAY            PIC 99.
  2121         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  2122         16  DC-GREG-DATE-1-MDY-R REDEFINES
  2123                      DC-GREG-DATE-1-MDY.
  2124             20  DC-MDY-MONTH          PIC 99.
  2125             20  DC-MDY-DAY            PIC 99.
  2126             20  DC-MDY-YEAR           PIC 99.
  2127         16  DC-GREG-DATE-1-ALPHA.
  2128             20  DC-ALPHA-MONTH        PIC X(10).
  2129             20  DC-ALPHA-DAY          PIC 99.
  2130             20  FILLER                PIC XX.
  2131             20  DC-ALPHA-CENTURY.
  2132                 24 DC-ALPHA-CEN-N     PIC 99.
  2133             20  DC-ALPHA-YEAR         PIC 99.
  2134         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  2135         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  2136         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  2137         16  DC-JULIAN-DATE            PIC 9(05).
  2138         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page  40
* EL6311.cbl
  2139                                       PIC 9(05).
  2140         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  2141             20  DC-JULIAN-YEAR        PIC 99.
  2142             20  DC-JULIAN-DAYS        PIC 999.
  2143         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  2144         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  2145         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  2146     12  DATE-CONVERSION-VARIBLES.
  2147         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  2148         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  2149             20  FILLER                PIC 9(3).
  2150             20  HOLD-CEN-1-CCYY.
  2151                 24  HOLD-CEN-1-CC     PIC 99.
  2152                 24  HOLD-CEN-1-YY     PIC 99.
  2153             20  HOLD-CEN-1-MO         PIC 99.
  2154             20  HOLD-CEN-1-DA         PIC 99.
  2155         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  2156             20  HOLD-CEN-1-R-MO       PIC 99.
  2157             20  HOLD-CEN-1-R-DA       PIC 99.
  2158             20  HOLD-CEN-1-R-CCYY.
  2159                 24  HOLD-CEN-1-R-CC   PIC 99.
  2160                 24  HOLD-CEN-1-R-YY   PIC 99.
  2161             20  FILLER                PIC 9(3).
  2162         16  HOLD-CENTURY-1-X.
  2163             20  FILLER                PIC X(3)  VALUE SPACES.
  2164             20  HOLD-CEN-1-X-CCYY.
  2165                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  2166                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  2167             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  2168             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  2169         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  2170             20  HOLD-CEN-1-R-X-MO     PIC XX.
  2171             20  HOLD-CEN-1-R-X-DA     PIC XX.
  2172             20  HOLD-CEN-1-R-X-CCYY.
  2173                 24  HOLD-CEN-1-R-X-CC PIC XX.
  2174                 24  HOLD-CEN-1-R-X-YY PIC XX.
  2175             20  FILLER                PIC XXX.
  2176         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  2177         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  2178         16  DC-JULIAN-DATE-1          PIC 9(07).
  2179         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  2180             20  DC-JULIAN-1-CCYY.
  2181                 24  DC-JULIAN-1-CC    PIC 99.
  2182                 24  DC-JULIAN-1-YR    PIC 99.
  2183             20  DC-JULIAN-DA-1        PIC 999.
  2184         16  DC-JULIAN-DATE-2          PIC 9(07).
  2185         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  2186             20  DC-JULIAN-2-CCYY.
  2187                 24  DC-JULIAN-2-CC    PIC 99.
  2188                 24  DC-JULIAN-2-YR    PIC 99.
  2189             20  DC-JULIAN-DA-2        PIC 999.
  2190         16  DC-GREG-DATE-A-EDIT.
  2191             20  DC-EDITA-MONTH        PIC 99.
  2192             20  SLASHA-1              PIC X VALUE '/'.
  2193             20  DC-EDITA-DAY          PIC 99.
  2194             20  SLASHA-2              PIC X VALUE '/'.
  2195             20  DC-EDITA-CCYY.
  2196                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page  41
* EL6311.cbl
  2197                 24  DC-EDITA-YEAR     PIC 99.
  2198         16  DC-GREG-DATE-B-EDIT.
  2199             20  DC-EDITB-MONTH        PIC 99.
  2200             20  SLASHB-1              PIC X VALUE '/'.
  2201             20  DC-EDITB-DAY          PIC 99.
  2202             20  SLASHB-2              PIC X VALUE '/'.
  2203             20  DC-EDITB-CCYY.
  2204                 24  DC-EDITB-CENT     PIC 99.
  2205                 24  DC-EDITB-YEAR     PIC 99.
  2206         16  DC-GREG-DATE-CYMD         PIC 9(08).
  2207         16  DC-GREG-DATE-CYMD-R REDEFINES
  2208                              DC-GREG-DATE-CYMD.
  2209             20  DC-CYMD-CEN           PIC 99.
  2210             20  DC-CYMD-YEAR          PIC 99.
  2211             20  DC-CYMD-MONTH         PIC 99.
  2212             20  DC-CYMD-DAY           PIC 99.
  2213         16  DC-GREG-DATE-MDCY         PIC 9(08).
  2214         16  DC-GREG-DATE-MDCY-R REDEFINES
  2215                              DC-GREG-DATE-MDCY.
  2216             20  DC-MDCY-MONTH         PIC 99.
  2217             20  DC-MDCY-DAY           PIC 99.
  2218             20  DC-MDCY-CEN           PIC 99.
  2219             20  DC-MDCY-YEAR          PIC 99.
  2220    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  2221        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  2222    12  DC-EL310-DATE                  PIC X(21).
  2223    12  FILLER                         PIC X(28).
  2224
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page  42
* EL6311.cbl
  2226*    COPY ELCLOGOF.
  2227******************************************************************
  2228*                                                                *
  2229*                                                                *
  2230*                            ELCLOGOF.                           *
  2231*                            VMOD=2.001                          *
  2232*                                                                *
  2233*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  2234*                                                                *
  2235******************************************************************
  2236 01  CLASIC-LOGOFF.
  2237     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  2238     12  LOGOFF-TEXT.
  2239         16  FILLER          PIC X(5)    VALUE SPACES.
  2240         16  LOGOFF-MSG.
  2241             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  2242             20  FILLER      PIC X       VALUE SPACES.
  2243             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  2244         16  FILLER          PIC X(80)
  2245           VALUE '* YOU ARE NOW LOGGED OFF'.
  2246         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  2247         16  FILLER          PIC X       VALUE QUOTE.
  2248         16  LOGOFF-SYS-MSG  PIC X(17)
  2249           VALUE 'S CLAS-IC SYSTEM '.
  2250     12  TEXT-MESSAGES.
  2251         16  UNACCESS-MSG    PIC X(29)
  2252             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  2253         16  PGMIDERR-MSG    PIC X(17)
  2254             VALUE 'PROGRAM NOT FOUND'.
  2255
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page  43
* EL6311.cbl
  2257*    COPY ELCATTR.
  2258******************************************************************
  2259*                                                                *
  2260*                            ELCATTR.                            *
  2261*                            VMOD=2.001                          *
  2262*                                                                *
  2263*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  2264*                                                                *
  2265*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  2266*                                                                *
  2267*                   POS 1   P=PROTECTED                          *
  2268*                           U=UNPROTECTED                        *
  2269*                           S=ASKIP                              *
  2270*                   POS 2   A=ALPHA/NUMERIC                      *
  2271*                           N=NUMERIC                            *
  2272*                   POS 3   N=NORMAL                             *
  2273*                           B=BRIGHT                             *
  2274*                           D=DARK                               *
  2275*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  2276*                           OF=MODIFIED DATA TAG OFF             *
  2277*                                                                *
  2278*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  2279******************************************************************
  2280 01  ATTRIBUTE-LIST.
  2281     12  AL-PABOF            PIC X       VALUE 'Y'.
  2282     12  AL-PABON            PIC X       VALUE 'Z'.
  2283     12  AL-PADOF            PIC X       VALUE '%'.
  2284     12  AL-PADON            PIC X       VALUE '_'.
  2285     12  AL-PANOF            PIC X       VALUE '-'.
  2286     12  AL-PANON            PIC X       VALUE '/'.
  2287     12  AL-SABOF            PIC X       VALUE '8'.
  2288     12  AL-SABON            PIC X       VALUE '9'.
  2289     12  AL-SADOF            PIC X       VALUE '@'.
  2290     12  AL-SADON            PIC X       VALUE QUOTE.
  2291     12  AL-SANOF            PIC X       VALUE '0'.
  2292     12  AL-SANON            PIC X       VALUE '1'.
  2293     12  AL-UABOF            PIC X       VALUE 'H'.
  2294     12  AL-UABON            PIC X       VALUE 'I'.
  2295     12  AL-UADOF            PIC X       VALUE '<'.
  2296     12  AL-UADON            PIC X       VALUE '('.
  2297     12  AL-UANOF            PIC X       VALUE ' '.
  2298     12  AL-UANON            PIC X       VALUE 'A'.
  2299     12  AL-UNBOF            PIC X       VALUE 'Q'.
  2300     12  AL-UNBON            PIC X       VALUE 'R'.
  2301     12  AL-UNDOF            PIC X       VALUE '*'.
  2302     12  AL-UNDON            PIC X       VALUE ')'.
  2303     12  AL-UNNOF            PIC X       VALUE '&'.
  2304     12  AL-UNNON            PIC X       VALUE 'J'.
  2305
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page  44
* EL6311.cbl
  2307*    COPY ELCEMIB.
  2308******************************************************************
  2309*                                                                *
  2310*                                                                *
  2311*                            ELCEMIB.                            *
  2312*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2313*                            VMOD=2.005                          *
  2314*                                                                *
  2315*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  2316*                                                                *
  2317******************************************************************
  2318 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  2319     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  2320     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  2321     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  2322     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  2323     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  2324     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  2325     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  2326     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  2327     12  EMI-SWITCH1             PIC X        VALUE '1'.
  2328         88  EMI-NO-ERRORS                    VALUE '1'.
  2329         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  2330         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  2331     12  EMI-SWITCH2             PIC X        VALUE '1'.
  2332         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  2333     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  2334         88  EMI-AREA1-EMPTY                  VALUE '1'.
  2335         88  EMI-AREA1-FULL                   VALUE '2'.
  2336     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  2337         88  EMI-AREA2-EMPTY                  VALUE '1'.
  2338         88  EMI-AREA2-FULL                   VALUE '2'.
  2339     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  2340         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  2341         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  2342         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  2343         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  2344         88  EMI-BYPASS-FATALS                VALUE 'X'.
  2345     12  EMI-ERROR-LINES.
  2346         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  2347         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  2348         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  2349         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  2350             20  EMI-ERR-CODES OCCURS 10 TIMES.
  2351                 24  EMI-ERR-NUM         PIC X(4).
  2352                 24  EMI-FILLER          PIC X.
  2353                 24  EMI-SEV             PIC X.
  2354                 24  FILLER              PIC X.
  2355             20  FILLER                  PIC X(02).
  2356     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  2357         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  2358             20  EMI-ERROR-NUMBER    PIC X(4).
  2359             20  EMI-FILL            PIC X.
  2360             20  EMI-SEVERITY        PIC X.
  2361             20  FILLER              PIC X.
  2362             20  EMI-ERROR-TEXT.
  2363                 24  EMI-TEXT-VARIABLE   PIC X(10).
  2364                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page  45
* EL6311.cbl
  2365     12  EMI-SEVERITY-SAVE           PIC X.
  2366         88  EMI-NOTE                    VALUE 'N'.
  2367         88  EMI-WARNING                 VALUE 'W'.
  2368         88  EMI-FORCABLE                VALUE 'F'.
  2369         88  EMI-FATAL                   VALUE 'X'.
  2370     12  EMI-MESSAGE-FLAG            PIC X.
  2371         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  2372         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  2373     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  2374     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  2375         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  2376         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  2377         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  2378     12  emi-claim-no                pic x(7).
  2379     12  emi-claim-type              pic x(6).
  2380     12  FILLER                      PIC X(124)  VALUE SPACES.
  2381     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  2382     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  2383     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  2384     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  2385
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page  46
* EL6311.cbl
  2387*    COPY ELCINTF.
  2388******************************************************************
  2389*                                                                *
  2390*                                                                *
  2391*                            ELCINTF.                            *
  2392*                            VMOD=2.017                          *
  2393*                                                                *
  2394*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  2395*                                                                *
  2396*       LENGTH = 1024                                            *
  2397*                                                                *
  2398******************************************************************
  2399*                   C H A N G E   L O G
  2400*
  2401* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2402*-----------------------------------------------------------------
  2403*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2404* EFFECTIVE    NUMBER
  2405*-----------------------------------------------------------------
  2406* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2407******************************************************************
  2408 01  PROGRAM-INTERFACE-BLOCK.
  2409     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  2410     12  PI-CALLING-PROGRAM              PIC X(8).
  2411     12  PI-SAVED-PROGRAM-1              PIC X(8).
  2412     12  PI-SAVED-PROGRAM-2              PIC X(8).
  2413     12  PI-SAVED-PROGRAM-3              PIC X(8).
  2414     12  PI-SAVED-PROGRAM-4              PIC X(8).
  2415     12  PI-SAVED-PROGRAM-5              PIC X(8).
  2416     12  PI-SAVED-PROGRAM-6              PIC X(8).
  2417     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  2418     12  PI-COMPANY-ID                   PIC XXX.
  2419     12  PI-COMPANY-CD                   PIC X.
  2420
  2421     12  PI-COMPANY-PASSWORD             PIC X(8).
  2422
  2423     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  2424
  2425     12  PI-CONTROL-IN-PROGRESS.
  2426         16  PI-CARRIER                  PIC X.
  2427         16  PI-GROUPING                 PIC X(6).
  2428         16  PI-STATE                    PIC XX.
  2429         16  PI-ACCOUNT                  PIC X(10).
  2430         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  2431                                         PIC X(10).
  2432         16  PI-CLAIM-CERT-GRP.
  2433             20  PI-CLAIM-NO             PIC X(7).
  2434             20  PI-CERT-NO.
  2435                 25  PI-CERT-PRIME       PIC X(10).
  2436                 25  PI-CERT-SFX         PIC X.
  2437             20  PI-CERT-EFF-DT          PIC XX.
  2438         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  2439             20  PI-PLAN-CODE            PIC X(2).
  2440             20  PI-REVISION-NUMBER      PIC X(3).
  2441             20  PI-PLAN-EFF-DT          PIC X(2).
  2442             20  PI-PLAN-EXP-DT          PIC X(2).
  2443             20  FILLER                  PIC X(11).
  2444         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page  47
* EL6311.cbl
  2445             20  PI-OE-REFERENCE-1.
  2446                 25  PI-OE-REF-1-PRIME   PIC X(18).
  2447                 25  PI-OE-REF-1-SUFF    PIC XX.
  2448
  2449     12  PI-SESSION-IN-PROGRESS          PIC X.
  2450         88  CLAIM-SESSION                   VALUE '1'.
  2451         88  CREDIT-SESSION                  VALUE '2'.
  2452         88  WARRANTY-SESSION                VALUE '3'.
  2453         88  MORTGAGE-SESSION                VALUE '4'.
  2454         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  2455
  2456
  2457*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  2458
  2459     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  2460     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  2461
  2462     12  PI-CREDIT-USER                  PIC X.
  2463         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  2464         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  2465
  2466     12  PI-CLAIM-USER                   PIC X.
  2467         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  2468         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  2469
  2470     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  2471         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  2472         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  2473         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  2474         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  2475         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  2476
  2477     12  PI-PROCESSOR-ID                 PIC X(4).
  2478
  2479     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  2480
  2481     12  PI-MEMBER-CAPTION               PIC X(10).
  2482
  2483     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  2484         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  2485
  2486     12  PI-LIFE-OVERRIDE-L1             PIC X.
  2487     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  2488     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  2489     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  2490
  2491     12  PI-AH-OVERRIDE-L1               PIC X.
  2492     12  PI-AH-OVERRIDE-L2               PIC XX.
  2493     12  PI-AH-OVERRIDE-L6               PIC X(6).
  2494     12  PI-AH-OVERRIDE-L12              PIC X(12).
  2495
  2496     12  PI-NEW-SYSTEM                   PIC X(2).
  2497
  2498     12  PI-PRIMARY-CERT-NO              PIC X(11).
  2499     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  2500         88  PI-USES-PAID-TO                 VALUE '1'.
  2501     12  PI-CRDTCRD-SYSTEM.
  2502         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page  48
* EL6311.cbl
  2503             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  2504             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  2505         16  PI-CC-MONTH-END-DT          PIC XX.
  2506     12  PI-PROCESSOR-PRINTER            PIC X(4).
  2507
  2508     12  PI-OE-REFERENCE-2.
  2509         16  PI-OE-REF-2-PRIME           PIC X(10).
  2510         16  PI-OE-REF-2-SUFF            PIC X.
  2511
  2512     12  PI-REM-TRM-CALC-OPTION          PIC X.
  2513
  2514     12  PI-LANGUAGE-TYPE                PIC X.
  2515             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  2516             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  2517             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  2518
  2519     12  PI-POLICY-LINKAGE-IND           PIC X.
  2520         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  2521         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  2522                                                   LOW-VALUES.
  2523
  2524     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  2525     12  PI-CLAIM-PW-SESSION             PIC X(1).
  2526         88  PI-CLAIM-CREDIT                 VALUE '1'.
  2527         88  PI-CLAIM-CONVEN                 VALUE '2'.
  2528
  2529     12  PI-PROCESSOR-CSR-IND            PIC X.
  2530         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  2531         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  2532
  2533     12  FILLER                          PIC X(3).
  2534
  2535     12  PI-SYSTEM-LEVEL                 PIC X(145).
  2536
  2537     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  2538         PI-SYSTEM-LEVEL.
  2539
  2540         16  PI-ENTRY-CODES.
  2541             20  PI-ENTRY-CD-1           PIC X.
  2542             20  PI-ENTRY-CD-2           PIC X.
  2543
  2544         16  PI-RETURN-CODES.
  2545             20  PI-RETURN-CD-1          PIC X.
  2546             20  PI-RETURN-CD-2          PIC X.
  2547
  2548         16  PI-UPDATE-STATUS-SAVE.
  2549             20  PI-UPDATE-BY            PIC X(4).
  2550             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  2551
  2552         16  PI-LOWER-CASE-LETTERS       PIC X.
  2553             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  2554
  2555*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  2556*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  2557*            88  CARRIER-CLM-CNTL            VALUE '2'.
  2558
  2559         16  PI-CERT-ACCESS-CONTROL      PIC X.
  2560             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page  49
* EL6311.cbl
  2561             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2562             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  2563             88  ACCNT-CNTL                  VALUE '3'.
  2564             88  CARR-ACCNT-CNTL             VALUE '4'.
  2565
  2566         16  PI-PROCESSOR-CAP-LIST.
  2567             20  PI-SYSTEM-CONTROLS.
  2568                24 PI-SYSTEM-DISPLAY     PIC X.
  2569                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  2570                24 PI-SYSTEM-MODIFY      PIC X.
  2571                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  2572             20  FILLER                  PIC XX.
  2573             20  PI-DISPLAY-CAP          PIC X.
  2574                 88  DISPLAY-CAP             VALUE 'Y'.
  2575             20  PI-MODIFY-CAP           PIC X.
  2576                 88  MODIFY-CAP              VALUE 'Y'.
  2577             20  PI-MSG-AT-LOGON-CAP     PIC X.
  2578                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  2579             20  PI-FORCE-CAP            PIC X.
  2580                 88  FORCE-CAP               VALUE 'Y'.
  2581
  2582         16  PI-PROGRAM-CONTROLS.
  2583             20  PI-PGM-PRINT-OPT        PIC X.
  2584             20  PI-PGM-FORMAT-OPT       PIC X.
  2585             20  PI-PGM-PROCESS-OPT      PIC X.
  2586             20  PI-PGM-TOTALS-OPT       PIC X.
  2587
  2588         16  PI-HELP-INTERFACE.
  2589             20  PI-LAST-ERROR-NO        PIC X(4).
  2590             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  2591
  2592         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  2593             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  2594
  2595         16  PI-CR-CONTROL-IN-PROGRESS.
  2596             20  PI-CR-CARRIER           PIC X.
  2597             20  PI-CR-GROUPING          PIC X(6).
  2598             20  PI-CR-STATE             PIC XX.
  2599             20  PI-CR-ACCOUNT           PIC X(10).
  2600             20  PI-CR-FIN-RESP          PIC X(10).
  2601             20  PI-CR-TYPE              PIC X.
  2602
  2603         16  PI-CR-BATCH-NUMBER          PIC X(6).
  2604
  2605         16  PI-CR-MONTH-END-DT          PIC XX.
  2606
  2607         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  2608             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  2609             88  PI-ZERO-CARRIER             VALUE '1'.
  2610             88  PI-ZERO-GROUPING            VALUE '2'.
  2611             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  2612
  2613         16  PI-CARRIER-SECURITY         PIC X.
  2614             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  2615
  2616         16  PI-ACCOUNT-SECURITY         PIC X(10).
  2617             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  2618             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page  50
* EL6311.cbl
  2619
  2620         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  2621             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  2622                                         INDEXED BY PI-ACCESS-NDX
  2623                                         PIC X.
  2624
  2625         16  PI-GA-BILLING-CONTROL       PIC X.
  2626             88  PI-GA-BILLING               VALUE '1'.
  2627
  2628         16  PI-MAIL-PROCESSING          PIC X.
  2629             88  PI-MAIL-YES                 VALUE 'Y'.
  2630
  2631         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  2632
  2633         16  PI-AR-SYSTEM.
  2634             20  PI-AR-PROCESSING-CNTL   PIC X.
  2635                 88  PI-AR-PROCESSING        VALUE 'Y'.
  2636             20  PI-AR-SUMMARY-CODE      PIC X(6).
  2637             20  PI-AR-MONTH-END-DT      PIC XX.
  2638
  2639         16  PI-MP-SYSTEM.
  2640             20  PI-MORTGAGE-USER            PIC X.
  2641                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  2642                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  2643             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  2644                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  2645                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  2646                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  2647                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  2648                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  2649             20  PI-MP-MONTH-END-DT          PIC XX.
  2650             20  PI-MP-REFERENCE-NO.
  2651                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  2652                 24  PI-MP-REFERENCE-SFX     PIC XX.
  2653
  2654         16  PI-LABEL-CONTROL            PIC X(01).
  2655             88  PI-CREATE-LABELS                    VALUE 'Y'.
  2656             88  PI-BYPASS-LABELS                    VALUE 'N'.
  2657
  2658         16  PI-BILL-GROUPING-CODE       PIC X(01).
  2659             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  2660
  2661         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  2662             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  2663             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  2664
  2665         16  FILLER                      PIC X(14).
  2666
  2667     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  2668******************************************************************
  2669
  2670     12  FILLER REDEFINES PI-PROGRAM-WORK-AREA.
  2671*    COPY ELC631PI.
  2672******************************************************************
  2673*                                                                *
  2674*                                                                *
  2675*                            ELC631PI                            *
  2676*                            VMOD=2.012                          *
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page  51
* EL6311.cbl
  2677*                                                                *
  2678*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
  2679*    REVIEW AND CORRRECTION SUB-SYSTEM.  ANY CHANGES WILL        *
  2680*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
  2681*                                                                *
  2682*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
  2683*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
  2684*    BETWEEN PROGRAMS.                                           *
  2685*                                                                *
  2686*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
  2687*                                                                *
  2688*               EL631 - EL6311 - EL6312 - EL6313                 *
  2689*                                                                *
  2690******************************************************************
  2691*                   C H A N G E   L O G
  2692*
  2693* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2694*-----------------------------------------------------------------
  2695*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2696* EFFECTIVE    NUMBER
  2697*-----------------------------------------------------------------
  2698* 021414    2003053000001  PEMA  changes for auto chk request
  2699******************************************************************
  2700
  2701         16  PI-631-DATA.
  2702             20  PI-ERPNDB-KEY.
  2703                 24  PI-PB-COMPANY-CD     PIC X.
  2704                 24  PI-PB-ENTRY-BATCH    PIC X(6).
  2705                 24  PI-PB-BATCH-SEQ-NO   PIC S9(4) COMP.
  2706                 24  PI-PB-BATCH-CHG-SEQ-NO PIC S9(4) COMP.
  2707
  2708             20  PI-ERPNDB-ALT-KEY.
  2709                 24  PI-PB-COMPANY-CD-A1  PIC X.
  2710                 24  PI-PB-CARRIER        PIC X.
  2711                 24  PI-PB-GROUPING       PIC X(6).
  2712                 24  PI-PB-STATE          PIC XX.
  2713                 24  PI-PB-ACCOUNT        PIC X(10).
  2714                 24  PI-PB-CERT-EFF-DT    PIC XX.
  2715                 24  PI-PB-CERT-NO.
  2716                     28  PI-PB-CERT-PRIME PIC X(10).
  2717                     28  PI-PB-CERT-SFX   PIC X.
  2718                 24  PI-PB-ALT-CHG-SEQ-NO PIC S9(4) COMP.
  2719                 24  PI-PB-RECORD-TYPE    PIC X.
  2720
  2721             20  PI-ERPNDB-CSR-KEY.
  2722                 24  PI-PB-CSR-COMPANY-CD-A2  PIC X.
  2723                 24  PI-PB-CSR-ID             PIC X(4).
  2724                 24  PI-PB-CSR-ENTRY-BATCH    PIC X(6).
  2725                 24  PI-PB-CSR-BTCH-SEQ-NO    PIC S9(4) COMP.
  2726                 24  PI-PB-CSR-BTCH-CHG-SEQ-NO PIC S9(4) COMP.
  2727
  2728             20  PI-BROWSE-TYPE               PIC X.
  2729                 88  PI-FILE-BROWSE             VALUE ' '.
  2730                 88  PI-PRIMARY-BROWSE          VALUE '1'.
  2731                 88  PI-ALTERNATE-BROWSE        VALUE '2'.
  2732                 88  PI-PRIMARY-WITH-SELECT     VALUE '3'.
  2733                 88  PI-CSR-BROWSE              VALUE '4'.
  2734
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page  52
* EL6311.cbl
  2735             20  PI-MAINT-FUNCTION            PIC X.
  2736                 88  PI-ADD-FUNCTION            VALUE 'A'.
  2737                 88  PI-BROWSE-FUNCTION         VALUE 'B'.
  2738                 88  PI-CHANGE-FUNCTION         VALUE 'C'.
  2739                 88  PI-DELETE-FUNCTION         VALUE 'D'.
  2740                 88  PI-SHOW-FUNCTION           VALUE 'S'.
  2741                 88  PI-PF5-FUNCTION            VALUE '5'.
  2742                 88  PI-PF6-FUNCTION            VALUE '6'.
  2743
  2744             20  PI-FILE-SWITCHES.
  2745                 24  PI-ALL-ISSUES-SW         PIC X.
  2746                     88  ALL-ISSUES             VALUE 'Y'.
  2747                 24  PI-ALL-CANCELS-SW        PIC X.
  2748                     88  ALL-CANCELS            VALUE 'Y'.
  2749                 24  PI-ISSUES-IN-ERROR-SW    PIC X.
  2750                     88  ISSUES-IN-ERROR        VALUE 'Y'.
  2751                 24  PI-CANCELS-IN-ERROR-SW   PIC X.
  2752                     88  CANCEL-IN-ERROR        VALUE 'Y'.
  2753                 24  PI-ONLY-BATCH-HEADERS-SW PIC X.
  2754                     88  ONLY-BATCH-HEADERS     VALUE 'Y'.
  2755                 24  PI-ALL-OUT-OF-BAL-SW     PIC X.
  2756                     88  ALL-OUT-OF-BAL         VALUE 'Y'.
  2757                 24  PI-HOLD-REC-SW           PIC X.
  2758                     88  DISPLAY-HOLD-RECORDS   VALUE 'Y'.
  2759                 24  PI-CHANGE-REC-SW         PIC X.
  2760                     88  DISPLAY-CHANGE-RECORDS VALUE 'Y'.
  2761                 24  PI-CHK-REQ-REC-SW        PIC X.
  2762                     88  DISPLAY-CHK-REQ-RECORDS VALUE 'Y'.
  2763                 24  PI-ISSUE-WARNING-SW      PIC X.
  2764                     88  ISSUE-WITH-WARNING     VALUE 'Y'.
  2765                 24  PI-CANCEL-WARNING-SW     PIC X.
  2766                     88  CANCEL-WITH-WARNING    VALUE 'Y'.
  2767             20  PI-DISPLAY-SCREEN-SW         PIC X.
  2768                     88  PI-DISPLAY-SCREEN      VALUE 'Y'.
  2769             20  PI-ORIGINAL-BATCH-SW         PIC X.
  2770                     88  PI-DISPLAY-ORIGINAL-BATCH VALUE 'Y'.
  2771
  2772             20  PI-MAP-NAME                  PIC X(8).
  2773
  2774             20  PI-CURSOR                    PIC S9(4) COMP.
  2775
  2776             20  PI-PREV-ALT-KEY              PIC X(36).
  2777             20  PI-PREV-CSR-KEY              PIC X(15).
  2778             20  PI-PREV-KEY.
  2779                 24  PI-PREV-COMPANY-CD       PIC X.
  2780                 24  PI-PREV-BATCH            PIC X(6).
  2781                 24  PI-PREV-SEQ-NO           PIC S9(4) COMP.
  2782                 24  PI-PREV-CHG-SEQ-NO       PIC S9(4) COMP.
  2783             20  PI-PREV-CONTROL-PRIMARY      PIC X(11).
  2784             20  PI-BROWSE-SW                 PIC X.
  2785                 88  PI-GOOD-BROWSE             VALUE 'Y'.
  2786                 88  PI-NO-PB-RECS-FOUND        VALUE '9'.
  2787             20  PI-SV-CARRIER                PIC X.
  2788             20  PI-SV-GROUPING               PIC X(6).
  2789             20  PI-SV-STATE                  PIC XX.
  2790             20  PI-EDIT-SW                   PIC X.
  2791             20  PI-DISPLAY-SW                PIC XX.
  2792                 88 PI-DISPLAY-LIFE        VALUE 'LF'.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page  53
* EL6311.cbl
  2793                 88 PI-DISPLAY-AH          VALUE 'AH'.
  2794             20  PI-CRITERIA-DATA             PIC X(350).
  2795             20  PI-BMODE                     PIC X.
  2796             20  PI-BPMTAMT                   PIC S9(7)V99 COMP-3.
  2797             20  PI-BPMTS                     PIC S999     COMP-3.
  2798             20  PI-BTYPE                     PIC XXX OCCURS 2.
  2799             20  PI-HIGH-SEQ-NO               PIC S9(4) COMP.
  2800             20  PI-CSR-SESSION-SW            PIC X.
  2801                 88  CSR-EDIT-SESSION           VALUE 'Y'.
  2802             20  PI-ERRORS-SW                 PIC X.
  2803                 88  FATAL-ERRORS               VALUE 'X'.
  2804*                88  FATAL-OR-UNFORCED          VALUE 'X'.
  2805             20  pi-unforced-sw               pic x.
  2806                 88  unforced-errors            value 'X'.
  2807             20  FILLER                       PIC X(4).
  2808
  2809        16  pi-6311-fatal-ctr    pic s999 comp-3.
  2810        16  FILLER             PIC X(92).
  2811
  2812 01  W-LETTER-COMMUNICATION-AREAS.
  2813*    COPY ELC1042.
  2814******************************************************************
  2815*                                                                *
  2816*                                                                *
  2817*                           ELC1042                              *
  2818*                            VMOD=2.002                          *
  2819*                                                                *
  2820*    NOTE                                                        *
  2821*        THE WORK AREA IS USED BY EL152, EL1522, EL1042, EL153,  *
  2822*        EM152, EM1522, EL689, EL6892, EL6311, AND EL690.        *
  2823*        THIS COPYBOOK SHOULD NOT BE CHANGED WITHOUT REFERENCE   *
  2824*        TO THESE PROGRAMS.                                      *
  2825*                                                                *
  2826*    NOTE                                                        *
  2827*        THE FILLER AREA AT THE BOTTOM ARE FOR FUTURE EL1042     *
  2828*        USE ONLY!                                               *
  2829*                                                                *
  2830******************************************************************
  2831
  2832         16  PI-1042-WA.
  2833             20  PI-ACTION       PIC  X(01).
  2834                 88 PI-SHOW-MODE           VALUE '1'.
  2835                 88 PI-CLEAR-MODE          VALUE '2'.
  2836                 88 PI-CREATE-MODE         VALUE '3'.
  2837             20  PI-COMM-CONTROL PIC  X(12).
  2838             20  PI-CURRENT-LINE PIC S9(03) COMP-3.
  2839             20  PI-EOF-SW       PIC  X(01).
  2840                 88  PI-FILE-EOF           VALUE 'Y'.
  2841             20  PI-FILETYP      PIC  X(01).
  2842             20  PI-FORM-SQUEEZE-CONTROL
  2843                                 PIC  X(01).
  2844                 88  PI-FORM-SQUEEZE-ON     VALUE 'Y'.
  2845                 88  PI-FORM-SQUEEZE-OFF    VALUE ' '.
  2846             20  PI-LAST-CONTROL PIC  X(12).
  2847             20  PI-TEMP-STOR-ITEMS
  2848                                 PIC S9(04) COMP.
  2849             20  PI-TOTAL-LINES  PIC S9(03) COMP-3.
  2850             20  PI-UPDATE-SW    PIC  9(01).
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page  54
* EL6311.cbl
  2851                 88 ANY-UPDATES            VALUE 1.
  2852             20  PI-104-SCREEN-SENT-IND
  2853                                 PIC  X(01).
  2854                 88  PI-104-SCREEN-SENT    VALUE 'Y'.
  2855                 88  PI-104-SCREEN-NOT-SENT VALUE 'N'.
  2856             20  PI-1042-SCREEN-SENT-IND
  2857                                 PIC  X(01).
  2858                 88  PI-1042-SCREEN-SENT    VALUE 'Y'.
  2859                 88  PI-1042-SCREEN-NOT-SENT VALUE 'N'.
  2860             20  PI-1042-ARCHIVE-IND
  2861                                 PIC  X(01).
  2862                 88  PI-1042-ARCHIVE-LETTER VALUE 'Y'.
  2863             20  FILLER          PIC  X(29).
  2864*    COPY ELC689PI.
  2865******************************************************************
  2866*                                                                *
  2867*                            ELC689PI                            *
  2868*                            VMOD=2.003                          *
  2869*                                                                *
  2870*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
  2871*    CREDIT CORRESPONDENCE SUB-SYSTEM.  ANY CHANGES WILL         *
  2872*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
  2873*                                                                *
  2874*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
  2875*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
  2876*    BETWEEN PROGRAMS.                                           *
  2877*                                                                *
  2878*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
  2879*                                                                *
  2880*               EL631 - EL689  - EL6891 - EL6892                 *
  2881*                                                                *
  2882******************************************************************
  2883*                   C H A N G E   L O G
  2884*
  2885* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2886*-----------------------------------------------------------------
  2887*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2888* EFFECTIVE    NUMBER
  2889*-----------------------------------------------------------------
  2890* 081004                   PEMA  CONVERT TO PSUEDO CONVERSATIONAL
  2891* 100705  CR2004072800004  PEMA  ADD LETTERS TO BE RESENT
  2892* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  2893******************************************************************
  2894
  2895
  2896         16  PI-689-WORK-AREA.
  2897             20  PI-689-ALT-PRINTER-ID
  2898                                 PIC  X(04).
  2899             20  PI-689-ARCHIVE-NUMBER
  2900                                 PIC  9(08).
  2901             20  PI-689-ARCHIVE-SW
  2902                                 PIC  X(01).
  2903                 88  PI-689-ARCHIVE-LETTER VALUE 'Y'.
  2904             20  PI-689-DATA-SOURCE
  2905                                 PIC  X(01).
  2906                 88  PI-689-SRC-ACCOUNT        VALUE '1'.
  2907                 88  PI-689-SRC-CERTIFICATE    VALUE '2'.
  2908                 88  PI-689-SRC-COMPENSATION   VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page  55
* EL6311.cbl
  2909                 88  PI-689-SRC-PEND-BUSINESS  VALUE '4'.
  2910                 88  PI-689-SRC-CHECKS         VALUE '5'.
  2911             20  PI-689-ERROR-IND
  2912                                 PIC  X(01).
  2913                 88  PI-689-ERR-DETECTED-PREV  VALUE 'Y'.
  2914             20  PI-689-ERROR    PIC  9(04).
  2915                 88  PI-689-NO-ERRORS-DETECTED VALUE 0000.
  2916                 88  PI-689-FATAL-ERROR
  2917                     VALUES 0004 0006 0008 0013 0023 0029 0033
  2918                            0042 0047 0051 0066 0067 0070
  2919                            0168 0169 0174 0175 0176 0177 0179
  2920                            0180 0181 0182 0184 0185 0189 0190
  2921                            0191
  2922                            0215 0279 0280
  2923                            0412 0413 0454
  2924                            0533 0537
  2925                            2055 2114 2208 2209 2216 2232 2369
  2926                            2398 2433 2908 2999
  2927                            3000 3770 3771 3775
  2928                            7250 7365 7367 7368 7369 7370 7371
  2929                            7272 7373 7374 7376 7377 7378 7379
  2930                            7381 7388 7390 7393 7395 7396 7398
  2931                            9095 9096 9281 9298 9299 9320 9327
  2932                            9426 9427.
  2933                 88  PI-689-STOP-ERROR
  2934                     VALUES 0004 0008 0013 0023 0029 0033
  2935                            0042 0047 0066 0067 0070
  2936                            0168 0169 0174 0175 0176 0177
  2937                            0181 0182 0184 0185 0189 0190
  2938                            0279 0280
  2939                            0412 0413 0454
  2940                            2055 2208 2209 2216 2232
  2941                            2398 2999
  2942                            3000 3770 3771 3775
  2943                            7250 7365 7369 7370 7371
  2944                            7272 7373 7374 7376 7377 7378 7379
  2945                            7381 7388 7390 7393 7396 7398
  2946                            9095 9096 9299 9320 9426.
  2947             20  PI-689-FOLLOW-UP-DATE
  2948                                 PIC  X(02).
  2949             20  PI-689-FORM-NUMBER
  2950                                 PIC  X(04).
  2951             20  PI-689-LABEL-SOURCE
  2952                                 PIC X(01).
  2953                 88  PI-689-SOURCE-ACCOUNT  VALUE '1'.
  2954                 88  PI-689-SOURCE-CARRIER  VALUE '2'.
  2955                 88  PI-689-SOURCE-COMPANY  VALUE '3'.
  2956                 88  PI-689-SOURCE-COMP     VALUE '4'.
  2957                 88  PI-689-SOURCE-MAIL     VALUE '5'.
  2958                 88  PI-689-SOURCE-CHECK    VALUE '6'.
  2959                 88  PI-689-SOURCE-VARIABLE VALUE '7'.
  2960             20  PI-689-NUMBER-COPIES
  2961                                 PIC  9(01).
  2962             20  PI-689-NUMBER-LABEL-LINES
  2963                                 PIC  9(01).
  2964             20  PI-689-NUMBER-TEXT-RECORDS
  2965                                 PIC  9(03).
  2966             20  PI-689-PRINT-ORDER-SW
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page  56
* EL6311.cbl
  2967                                 PIC  X(01).
  2968                 88  PI-689-PRINT-FIRST     VALUE '1'.
  2969                 88  PI-689-PRINT-SECOND    VALUE '2'.
  2970                 88  PI-689-PRINT-LATER     VALUE '3'.
  2971                 88  PI-689-PRINT-ONLY      VALUE '4'.
  2972             20  PI-689-PRINT-RESTRICTION
  2973                                 PIC  X(01).
  2974                 88  PI-689-VALID-RESTRICT     VALUE 'C' 'F'.
  2975                 88  PI-689-PRT-ONLY-WITH-CNTL VALUE 'C'.
  2976                 88  PI-689-PRT-ONLY-WITH-FORM VALUE 'F'.
  2977             20  PI-689-PRINT-SW PIC  X(01).
  2978                 88  PI-689-PRINT-PERFORMED VALUE '1'.
  2979             20  PI-689-RESEND-DATE-1
  2980                                 PIC  X(02).
  2981             20  PI-689-RESEND-LETR-1
  2982                                 PIC X(4).
  2983             20  PI-689-TEMP-STOR-ID
  2984                                 PIC  X(08).
  2985             20  PI-689-USE-SCREEN-IND
  2986                                 PIC  X(01).
  2987                 88  PI-689-CREATE-NO-SCREENS VALUE '1'.
  2988             20  PI-689-ARCH-POINTER
  2989                                 PIC S9(08) COMP.
  2990                 88  PI-689-GET-ARCH-MAIN     VALUE +0.
  2991             20  PI-689-ARCT-POINTER
  2992                                 PIC S9(08) COMP.
  2993                 88  PI-689-GET-ARCT-MAIN     VALUE +0.
  2994             20  PI-689-VARIABLE-DATA-GRP.
  2995                 24  PI-689-VARIABLE-DATA-1
  2996                                 PIC  X(30).
  2997                 24  PI-689-VARIABLE-DATA-2
  2998                                 PIC  X(30).
  2999                 24  PI-689-VARIABLE-DATA-3
  3000                                 PIC  X(30).
  3001                 24  PI-689-VARIABLE-DATA-4
  3002                                 PIC  X(30).
  3003
  3004         16  PI-689-KEY-DATA-FIELDS.
  3005             20  PI-689-ACCOUNT  PIC  X(10).
  3006             20  PI-689-CARRIER  PIC  X(01).
  3007             20  PI-689-CERT-NO.
  3008                 24  PI-689-CERT-PRIME
  3009                                 PIC  X(10).
  3010                 24  PI-689-CERT-SFX
  3011                                 PIC  X(01).
  3012             20  PI-689-CHG-SEQ-NO
  3013                                 PIC S9(04)    COMP.
  3014             20  PI-689-CHG-SEQ-NOX REDEFINES PI-689-CHG-SEQ-NO
  3015                                 PIC  X(02).
  3016             20  PI-689-ENTRY-BATCH
  3017                                 PIC  X(06).
  3018             20  PI-689-EFF-DATE PIC  X(02).
  3019             20  PI-689-EXP-DATE PIC  X(02).
  3020             20  PI-689-GROUPING PIC  X(06).
  3021             20  PI-689-RESP-PERSON
  3022                                 PIC  X(10).
  3023             20  PI-689-SEQ-NO   PIC S9(08)    COMP.
  3024             20  PI-689-SEQ-NOX REDEFINES PI-689-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page  57
* EL6311.cbl
  3025                                 PIC  X(04).
  3026             20  PI-689-STATE    PIC  X(02).
  3027             20  PI-689-TYPE     PIC  X(01).
  3028             20  PI-689-CONTROL  PIC S9(08)    COMP.
  3029             20  PI-689-ALT-SEQ-NO
  3030                                 PIC S9(04)    COMP.
  3031         16  PI-689-DATE-EDIT    PIC  X(08).
  3032         16  PI-689-FOLLOW-UP-EDIT
  3033                                 PIC  X(08).
  3034         16  PI-689-RESEND1-EDIT PIC  X(08).
  3035         16  PI-689-SEQ-EDIT     PIC  X(08).
  3036         16  PI-689-BCSEQ-EDIT   PIC  X(04).
  3037         16  PI-689-LBL-OVERRIDE PIC  X(01).
  3038             88  PI-689-LABELS-OVERRIDEN  VALUES 'N'.
  3039         16  PI-689-FATAL-CTR    PIC 999     COMP-3.
  3040         16  PI-689-FORCABLE-CTR PIC 999     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page  58
* EL6311.cbl
  3042
  3043 01  WS-EL6315-PASS-AREA.
  3044        16  PI-6315-ISS-CAN-SW      PIC X.
  3045        16  FILLER                  PIC X(120).
  3046        16  PI-RES-REF-CLM-TYPE     PIC X.
  3047        16  FILLER                  PIC X.
  3048        16  PI-6315-PASS-AREA.
  3049            20 FILLER               PIC X(236).
  3050            20 PI-6315-FINALIZED    PIC X.
  3051            20 FILLER               PIC X(280).
  3052
  3053 01  WS-EL6316-PASS-AREA.
  3054        16  PI-ISS-CAN-SW           PIC X.
  3055        16  FILLER                  PIC X(121).
  3056        16  PI-CLM-RESC-IND         PIC X.
  3057        16  PI-6316-PASS-AREA.
  3058            20 FILLER               PIC X(236).
  3059            20 PI-6316-FINALIZED    PIC X.
  3060            20 FILLER               PIC X(280).
  3061
  3062******************************************************************
  3063*                                                                *
  3064*         P A S S   A R E A   F O R   E D I T                    *
  3065*                                                                *
  3066******************************************************************
  3067
  3068 01  PASSED-RECORD.
  3069     12  RECORD-SAVE                  PIC X(585).
  3070* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
  3071*    COPY ELC50W1 REPLACING WK-CANCEL-EXIT-DT
  3072*                    BY  WK-CURRENT-DATE.
  3073******************************************************************
  3074*                                                                *
  3075*                                                                *
  3076*                             ELC50W1                            *
  3077*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3078*                            VMOD=2.004                          *
  3079*                                                                *
  3080*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *
  3081*                                                                *
  3082*                                                                *
  3083******************************************************************
  3084
  3085     12  WK-WORK-AREA.
  3086         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.
  3087         16  WK-LAST-CARRIER          PIC X   VALUE ' '.
  3088         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.
  3089         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.
  3090         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.
  3091         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.
  3092         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.
  3093         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.
  3094         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.
  3095         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.
  3096         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.
  3097         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.
  3098         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.
  3099         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page  59
* EL6311.cbl
  3100         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE.
  3101         16  WK-CREDIT-EDIT-CONTROLS.
  3102             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.
  3103             20  WK-MIN-AGE           PIC 99  VALUE 00.
  3104             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.
  3105             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  3106             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  3107             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.
  3108         16  WK-CURRENT-DATE        PIC XX VALUE LOW-VALUE.
  3109         16  WK-SAVE-REIN-DATA.
  3110             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.
  3111             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.
  3112             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.
  3113         16  WK-ENTRY-SW              PIC X    VALUE ' '.
  3114             88  ENTRY-FROM-EL6311       VALUE '6'.
  3115         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.
  3116         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.
  3117     12  WK-RECORD-ADDRESSES.
  3118         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS.
  3119         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS.
  3120         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS.
  3121         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS.
  3122         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS.
  3123         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS.
  3124         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS.
  3125         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS.
  3126     12  WK-OVER-SHORT-AREA.
  3127         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.
  3128         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.
  3129         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  3130             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  3131         16  FILLER                   PIC X(5) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page  60
* EL6311.cbl
  3133
  3134*    COPY ELCEDITC.
  3135******************************************************************
  3136*                                                                *
  3137*                                                                *
  3138*                            ELCEDITC                            *
  3139*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3140*                            VMOD=2.012                          *
  3141*                                                                *
  3142*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *
  3143*                     EL6313, EL050 AND EL517.                   *
  3144*                                                                *
  3145******************************************************************
  3146******************************************************************
  3147*                   C H A N G E   L O G
  3148*
  3149* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3150*-----------------------------------------------------------------
  3151*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3152* EFFECTIVE    NUMBER
  3153*-----------------------------------------------------------------
  3154* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3155******************************************************************
  3156
  3157     12  EDIT-CRITERIA-DATA.
  3158         16  EC-CO-MONTH-END-DT       PIC XX.
  3159         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.
  3160         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  3161         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.
  3162         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  3163         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.
  3164         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.
  3165         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.
  3166         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.
  3167         16  EC-CO-REM-TERM-CALC      PIC X.
  3168               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.
  3169               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.
  3170               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.
  3171               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.
  3172
  3173         16  EC-BR-LF-EARNINGS-CALC    PIC X.
  3174               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.
  3175               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.
  3176               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.
  3177               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.
  3178               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.
  3179               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.
  3180               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.
  3181               88  EC-BR-LF-EARN-MEAN               VALUE '8'.
  3182               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.
  3183               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.
  3184
  3185         16  EC-BR-AH-EARNINGS-CALC    PIC X.
  3186               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.
  3187               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.
  3188               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.
  3189               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.
  3190               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page  61
* EL6311.cbl
  3191               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.
  3192               88  EC-BR-AH-EARN-MEAN               VALUE '8'.
  3193               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.
  3194
  3195         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.
  3196                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.
  3197                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.
  3198
  3199         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.
  3200                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.
  3201                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.
  3202                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.
  3203                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.
  3204                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.
  3205                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.
  3206                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.
  3207                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.
  3208
  3209         16  EC-BR-LF-COVERAGE-TYPE    PIC X.
  3210               88  EC-BR-REDUCING                   VALUE 'R'.
  3211               88  EC-BR-LEVEL                      VALUE 'L' 'P'.
  3212
  3213         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).
  3214         16  EC-BR-LF-DESC             PIC X(10).
  3215         16  EC-BR-AH-DESC             PIC X(10).
  3216         16  EC-BR-LF-COMMENT          PIC X(10).
  3217         16  EC-BR-AH-COMMENT          PIC X(10).
  3218
  3219         16  EC-BR-LF-REM-TERM-CALC    PIC X.
  3220               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.
  3221               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.
  3222               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.
  3223               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.
  3224
  3225         16  EC-BR-AH-REM-TERM-CALC    PIC X.
  3226               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.
  3227               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.
  3228               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.
  3229               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.
  3230
  3231         16  EC-BR-LF-REFUND-CALC      PIC X.
  3232                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.
  3233                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.
  3234                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.
  3235                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.
  3236                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.
  3237                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.
  3238                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  3239
  3240         16  EC-BR-AH-REFUND-CALC      PIC X.
  3241                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.
  3242                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.
  3243                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.
  3244                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.
  3245                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.
  3246                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.
  3247                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.
  3248                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page  62
* EL6311.cbl
  3249
  3250         16  EC-BR-LF-BEN-I-G-CD       PIC X.
  3251                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.
  3252                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.
  3253                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.
  3254
  3255         16  EC-BR-AH-BEN-I-G-CD       PIC X.
  3256                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.
  3257                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.
  3258                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.
  3259
  3260         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.
  3261         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.
  3262         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  3263         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  3264
  3265         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.
  3266         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.
  3267                 88  EC-ST-EXT-NO-CHG               VALUE ' '.
  3268                 88  EC-ST-EXT-CHG-LF               VALUE '1'.
  3269                 88  EC-ST-EXT-CHG-AH               VALUE '2'.
  3270                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.
  3271
  3272         16  EC-ST-LF-REM-TERM-CALC    PIC X.
  3273               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.
  3274               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.
  3275               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.
  3276               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.
  3277               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.
  3278
  3279         16  EC-ST-AH-REM-TERM-CALC    PIC X.
  3280               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.
  3281               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.
  3282               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.
  3283               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.
  3284               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.
  3285
  3286         16  EC-ST-LF-REFUND-CALC      PIC X.
  3287                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.
  3288                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.
  3289                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.
  3290                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.
  3291                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.
  3292                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.
  3293                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.
  3294                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  3295
  3296         16  EC-ST-AH-REFUND-CALC      PIC X.
  3297                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.
  3298                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.
  3299                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.
  3300                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.
  3301                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.
  3302                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.
  3303                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.
  3304                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  3305
  3306         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page  63
* EL6311.cbl
  3307         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.
  3308         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.
  3309         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.
  3310         16  EC-AM-EXPIRATION-DT       PIC XX.
  3311         16  EC-AM-EFFECTIVE-DT        PIC XX.
  3312         16  EC-AM-CLASS-CD            PIC XX.
  3313         16  EC-AM-LF-DEVIATION        PIC XXX.
  3314         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  3315         16  EC-AM-AH-DEVIATION        PIC XXX.
  3316         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  3317         16  EC-AM-PHONE-NO            PIC X(10).
  3318
  3319         16  EC-AM-LF-REFUND-CALC      PIC X.
  3320                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.
  3321                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.
  3322                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.
  3323                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.
  3324                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.
  3325                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.
  3326                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  3327
  3328         16  EC-AM-AH-REFUND-CALC      PIC X.
  3329                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.
  3330                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.
  3331                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.
  3332                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.
  3333                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.
  3334                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.
  3335                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  3336
  3337         16  EC-AM-BEN-I-G-CD          PIC X.
  3338                 88  WK-AM-I-G-NOT-USED             VALUE ' '.
  3339                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.
  3340                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.
  3341
  3342         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3343         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.
  3344         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.
  3345         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3346         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3347         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.
  3348         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.
  3349         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  3350         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3351
  3352         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3353         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.
  3354         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.
  3355         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3356         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3357         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.
  3358         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.
  3359         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  3360         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3361         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.
  3362         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.
  3363         16  EC-RT-LF-NSP-ST           PIC XX.
  3364         16  EC-RT-AH-NSP-ST           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page  64
* EL6311.cbl
  3365         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  3366         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  3367
  3368         16  EC-CM-LF-PRIOR-STATUS     PIC X.
  3369             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  3370                                             'M' '5' '9' '2'.
  3371             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.
  3372             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.
  3373             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.
  3374             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.
  3375             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.
  3376             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.
  3377             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.
  3378             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.
  3379             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.
  3380             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.
  3381
  3382         16  EC-CM-AH-PRIOR-STATUS     PIC X.
  3383             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  3384                                             'M' '5' '9' '2'.
  3385             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.
  3386             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.
  3387             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.
  3388             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.
  3389             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.
  3390             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.
  3391             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.
  3392             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.
  3393             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.
  3394             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.
  3395
  3396         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  3397         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  3398         16  EC-CM-LF-CANCEL-DT        PIC XX.
  3399         16  EC-CM-AH-CANCEL-DT        PIC XX.
  3400         16  EC-CM-DEATH-DT            PIC XX.
  3401
  3402*DMD CUSTOM CODING FIELDS BELOW
  3403*POPULATED BY CF-RATING-SWITCH AT EL050 TIME
  3404         16  EC-BR-DMD-RATING-SW       PIC X.
  3405                 88  EC-DMD-AH-RATING            VALUE 'Y'.
  3406                 88  EC-DMD-LF-RATING            VALUE 'Y'.
  3407                 88  NO-DMD-RATING               VALUE 'N'.
  3408
  3409         16  EC-NEW-CERT               PIC X(11).
  3410         16  EC-NEW-STATE              PIC XX.
  3411         16  FILLER                    PIC X.
  3412*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.
  3413         16  OVER-SHORT-EDIT-FIELDS.
  3414             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.
  3415             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  3416             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.
  3417             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  3418             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.
  3419             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.
  3420             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  3421             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.
  3422             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page  65
* EL6311.cbl
  3423         16  FILLER                    PIC X(71).
  3424
  3425******************************************************************
  3426
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page  66
* EL6311.cbl
  3428
  3429*    COPY ELCJPFX.
  3430******************************************************************
  3431*                                                                *
  3432*                                                                *
  3433*                            ELCJPFX.                            *
  3434*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3435*                            VMOD=2.002                          *
  3436*                                                                *
  3437*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  3438*                                                                *
  3439*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  3440*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  3441*        ELCNTL - CONTROL FILE                                   *
  3442*        ELMSTR - CLAIM MASTERS                                  *
  3443*        ELTRLR - ACTIVITY TRAILERS                              *
  3444*        ELCHKQ - CHECK QUE                                      *
  3445******************************************************************
  3446 01  JOURNAL-RECORD.
  3447     12  jp-date                     pic s9(5) comp-3.
  3448     12  jp-time                     pic s9(7) comp-3.
  3449     12  JP-USER-ID                  PIC X(4).
  3450     12  JP-FILE-ID                  PIC X(8).
  3451     12  JP-PROGRAM-ID               PIC X(8).
  3452     12  JP-RECORD-TYPE              PIC X.
  3453         88 JP-ADD              VALUE 'A'.
  3454         88 JP-BEFORE-CHANGE    VALUE 'B'.
  3455         88 JP-AFTER-CHANGE     VALUE 'C'.
  3456         88 JP-DELETE           VALUE 'D'.
  3457         88 JP-GENERIC-DELETE   VALUE 'G'.
  3458         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  3459         88 JP-KEY-CHG-ADD      VALUE 'N'.
  3460     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  3461     12  JP-RECORD-AREA
  3462
  3463
  3464                             PIC X(825).
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page  67
* EL6311.cbl
  3466*    COPY ELCAID.
  3467******************************************************************
  3468*                                                                *
  3469*                            ELCAID.                             *
  3470*                            VMOD=2.001                          *
  3471*                                                                *
  3472*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  3473*                                                                *
  3474*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  3475*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  3476******************************************************************
  3477
  3478 01  DFHAID.
  3479   02  DFHNULL   PIC  X  VALUE  ' '.
  3480   02  DFHENTER  PIC  X  VALUE  QUOTE.
  3481   02  DFHCLEAR  PIC  X  VALUE  '_'.
  3482   02  DFHPEN    PIC  X  VALUE  '='.
  3483   02  DFHOPID   PIC  X  VALUE  'W'.
  3484   02  DFHPA1    PIC  X  VALUE  '%'.
  3485   02  DFHPA2    PIC  X  VALUE  '>'.
  3486   02  DFHPA3    PIC  X  VALUE  ','.
  3487   02  DFHPF1    PIC  X  VALUE  '1'.
  3488   02  DFHPF2    PIC  X  VALUE  '2'.
  3489   02  DFHPF3    PIC  X  VALUE  '3'.
  3490   02  DFHPF4    PIC  X  VALUE  '4'.
  3491   02  DFHPF5    PIC  X  VALUE  '5'.
  3492   02  DFHPF6    PIC  X  VALUE  '6'.
  3493   02  DFHPF7    PIC  X  VALUE  '7'.
  3494   02  DFHPF8    PIC  X  VALUE  '8'.
  3495   02  DFHPF9    PIC  X  VALUE  '9'.
  3496   02  DFHPF10   PIC  X  VALUE  ':'.
  3497   02  DFHPF11   PIC  X  VALUE  '#'.
  3498   02  DFHPF12   PIC  X  VALUE  '@'.
  3499   02  DFHPF13   PIC  X  VALUE  'A'.
  3500   02  DFHPF14   PIC  X  VALUE  'B'.
  3501   02  DFHPF15   PIC  X  VALUE  'C'.
  3502   02  DFHPF16   PIC  X  VALUE  'D'.
  3503   02  DFHPF17   PIC  X  VALUE  'E'.
  3504   02  DFHPF18   PIC  X  VALUE  'F'.
  3505   02  DFHPF19   PIC  X  VALUE  'G'.
  3506   02  DFHPF20   PIC  X  VALUE  'H'.
  3507   02  DFHPF21   PIC  X  VALUE  'I'.
  3508*00039    02  DFHPF22   PIC  X  VALUE  ''.
  3509   02  DFHPF22   PIC  X  VALUE  '['.
  3510   02  DFHPF23   PIC  X  VALUE  '.'.
  3511   02  DFHPF24   PIC  X  VALUE  '<'.
  3512   02  DFHMSRE   PIC  X  VALUE  'X'.
  3513   02  DFHSTRF   PIC  X  VALUE  'h'.
  3514   02  DFHTRIG   PIC  X  VALUE  '"'.
  3515
  3516 01  FILLER    REDEFINES DFHAID.
  3517     12  FILLER              PIC X(8).
  3518     12  PF-VALUES           PIC X       OCCURS 24 TIMES.
  3519
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page  68
* EL6311.cbl
  3521*    COPY EL6311S.
  3522 01  EL631BI.
  3523     05  FILLER            PIC  X(0012).
  3524*    -------------------------------
  3525     05  BDATEL PIC S9(0004) COMP.
  3526     05  BDATEF PIC  X(0001).
  3527     05  FILLER REDEFINES BDATEF.
  3528         10  BDATEA PIC  X(0001).
  3529     05  BDATEI PIC  X(0008).
  3530*    -------------------------------
  3531     05  BTIMEL PIC S9(0004) COMP.
  3532     05  BTIMEF PIC  X(0001).
  3533     05  FILLER REDEFINES BTIMEF.
  3534         10  BTIMEA PIC  X(0001).
  3535     05  BTIMEI PIC  X(0005).
  3536*    -------------------------------
  3537     05  BHEADL PIC S9(0004) COMP.
  3538     05  BHEADF PIC  X(0001).
  3539     05  FILLER REDEFINES BHEADF.
  3540         10  BHEADA PIC  X(0001).
  3541     05  BHEADI PIC  X(0038).
  3542*    -------------------------------
  3543     05  BNCERTLL PIC S9(0004) COMP.
  3544     05  BNCERTLF PIC  X(0001).
  3545     05  FILLER REDEFINES BNCERTLF.
  3546         10  BNCERTLA PIC  X(0001).
  3547     05  BNCERTLI PIC  X(0008).
  3548*    -------------------------------
  3549     05  BNCERTL PIC S9(0004) COMP.
  3550     05  BNCERTF PIC  X(0001).
  3551     05  FILLER REDEFINES BNCERTF.
  3552         10  BNCERTA PIC  X(0001).
  3553     05  BNCERTI PIC  X(0011).
  3554*    -------------------------------
  3555     05  BNSTATLL PIC S9(0004) COMP.
  3556     05  BNSTATLF PIC  X(0001).
  3557     05  FILLER REDEFINES BNSTATLF.
  3558         10  BNSTATLA PIC  X(0001).
  3559     05  BNSTATLI PIC  X(0009).
  3560*    -------------------------------
  3561     05  BNSTATL PIC S9(0004) COMP.
  3562     05  BNSTATF PIC  X(0001).
  3563     05  FILLER REDEFINES BNSTATF.
  3564         10  BNSTATA PIC  X(0001).
  3565     05  BNSTATI PIC  X(0002).
  3566*    -------------------------------
  3567     05  BCHGTL PIC S9(0004) COMP.
  3568     05  BCHGTF PIC  X(0001).
  3569     05  FILLER REDEFINES BCHGTF.
  3570         10  BCHGTA PIC  X(0001).
  3571     05  BCHGTI PIC  X(0004).
  3572*    -------------------------------
  3573     05  BCHGL PIC S9(0004) COMP.
  3574     05  BCHGF PIC  X(0001).
  3575     05  FILLER REDEFINES BCHGF.
  3576         10  BCHGA PIC  X(0001).
  3577     05  BCHGI PIC  X(0004).
  3578*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page  69
* EL6311.cbl
  3579     05  BCOMPIDL PIC S9(0004) COMP.
  3580     05  BCOMPIDF PIC  X(0001).
  3581     05  FILLER REDEFINES BCOMPIDF.
  3582         10  BCOMPIDA PIC  X(0001).
  3583     05  BCOMPIDI PIC  X(0003).
  3584*    -------------------------------
  3585     05  BREGIONL PIC S9(0004) COMP.
  3586     05  BREGIONF PIC  X(0001).
  3587     05  FILLER REDEFINES BREGIONF.
  3588         10  BREGIONA PIC  X(0001).
  3589     05  BREGIONI PIC  X(0006).
  3590*    -------------------------------
  3591     05  BUSERL PIC S9(0004) COMP.
  3592     05  BUSERF PIC  X(0001).
  3593     05  FILLER REDEFINES BUSERF.
  3594         10  BUSERA PIC  X(0001).
  3595     05  BUSERI PIC  X(0004).
  3596*    -------------------------------
  3597     05  BMAINTL PIC S9(0004) COMP.
  3598     05  BMAINTF PIC  X(0001).
  3599     05  FILLER REDEFINES BMAINTF.
  3600         10  BMAINTA PIC  X(0001).
  3601     05  BMAINTI PIC  X(0001).
  3602*    -------------------------------
  3603     05  BMANTBYL PIC S9(0004) COMP.
  3604     05  BMANTBYF PIC  X(0001).
  3605     05  FILLER REDEFINES BMANTBYF.
  3606         10  BMANTBYA PIC  X(0001).
  3607     05  BMANTBYI PIC  X(0004).
  3608*    -------------------------------
  3609     05  BCHGHDGL PIC S9(0004) COMP.
  3610     05  BCHGHDGF PIC  X(0001).
  3611     05  FILLER REDEFINES BCHGHDGF.
  3612         10  BCHGHDGA PIC  X(0001).
  3613     05  BCHGHDGI PIC  X(0003).
  3614*    -------------------------------
  3615     05  BMANTDTL PIC S9(0004) COMP.
  3616     05  BMANTDTF PIC  X(0001).
  3617     05  FILLER REDEFINES BMANTDTF.
  3618         10  BMANTDTA PIC  X(0001).
  3619     05  BMANTDTI PIC  X(0008).
  3620*    -------------------------------
  3621     05  BMANTATL PIC S9(0004) COMP.
  3622     05  BMANTATF PIC  X(0001).
  3623     05  FILLER REDEFINES BMANTATF.
  3624         10  BMANTATA PIC  X(0001).
  3625     05  BMANTATI PIC  X(0005).
  3626*    -------------------------------
  3627     05  BCSRL PIC S9(0004) COMP.
  3628     05  BCSRF PIC  X(0001).
  3629     05  FILLER REDEFINES BCSRF.
  3630         10  BCSRA PIC  X(0001).
  3631     05  BCSRI PIC  X(0004).
  3632*    -------------------------------
  3633     05  BBATCHL PIC S9(0004) COMP.
  3634     05  BBATCHF PIC  X(0001).
  3635     05  FILLER REDEFINES BBATCHF.
  3636         10  BBATCHA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page  70
* EL6311.cbl
  3637     05  BBATCHI PIC  X(0006).
  3638*    -------------------------------
  3639     05  BSEQL PIC S9(0004) COMP.
  3640     05  BSEQF PIC  X(0001).
  3641     05  FILLER REDEFINES BSEQF.
  3642         10  BSEQA PIC  X(0001).
  3643     05  BSEQI PIC  X(0004).
  3644*    -------------------------------
  3645     05  BMOENDTL PIC S9(0004) COMP.
  3646     05  BMOENDTF PIC  X(0001).
  3647     05  FILLER REDEFINES BMOENDTF.
  3648         10  BMOENDTA PIC  X(0001).
  3649     05  BMOENDTI PIC  X(0008).
  3650*    -------------------------------
  3651     05  BCARRL PIC S9(0004) COMP.
  3652     05  BCARRF PIC  X(0001).
  3653     05  FILLER REDEFINES BCARRF.
  3654         10  BCARRA PIC  X(0001).
  3655     05  BCARRI PIC  X(0001).
  3656*    -------------------------------
  3657     05  BGROUPL PIC S9(0004) COMP.
  3658     05  BGROUPF PIC  X(0001).
  3659     05  FILLER REDEFINES BGROUPF.
  3660         10  BGROUPA PIC  X(0001).
  3661     05  BGROUPI PIC  X(0006).
  3662*    -------------------------------
  3663     05  BSTATEL PIC S9(0004) COMP.
  3664     05  BSTATEF PIC  X(0001).
  3665     05  FILLER REDEFINES BSTATEF.
  3666         10  BSTATEA PIC  X(0001).
  3667     05  BSTATEI PIC  X(0002).
  3668*    -------------------------------
  3669     05  BACCTL PIC S9(0004) COMP.
  3670     05  BACCTF PIC  X(0001).
  3671     05  FILLER REDEFINES BACCTF.
  3672         10  BACCTA PIC  X(0001).
  3673     05  BACCTI PIC  X(0010).
  3674*    -------------------------------
  3675     05  BVINHL PIC S9(0004) COMP.
  3676     05  BVINHF PIC  X(0001).
  3677     05  FILLER REDEFINES BVINHF.
  3678         10  BVINHA PIC  X(0001).
  3679     05  BVINHI PIC  X(0004).
  3680*    -------------------------------
  3681     05  BVINL PIC S9(0004) COMP.
  3682     05  BVINF PIC  X(0001).
  3683     05  FILLER REDEFINES BVINF.
  3684         10  BVINA PIC  X(0001).
  3685     05  BVINI PIC  X(0017).
  3686*    -------------------------------
  3687     05  BREFHDGL PIC S9(0004) COMP.
  3688     05  BREFHDGF PIC  X(0001).
  3689     05  FILLER REDEFINES BREFHDGF.
  3690         10  BREFHDGA PIC  X(0001).
  3691     05  BREFHDGI PIC  X(0004).
  3692*    -------------------------------
  3693     05  BREFL PIC S9(0004) COMP.
  3694     05  BREFF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page  71
* EL6311.cbl
  3695     05  FILLER REDEFINES BREFF.
  3696         10  BREFA PIC  X(0001).
  3697     05  BREFI PIC  X(0012).
  3698*    -------------------------------
  3699     05  LETRREQL PIC S9(0004) COMP.
  3700     05  LETRREQF PIC  X(0001).
  3701     05  FILLER REDEFINES LETRREQF.
  3702         10  LETRREQA PIC  X(0001).
  3703     05  LETRREQI PIC  X(0001).
  3704*    -------------------------------
  3705     05  BAGEDEFL PIC S9(0004) COMP.
  3706     05  BAGEDEFF PIC  X(0001).
  3707     05  FILLER REDEFINES BAGEDEFF.
  3708         10  BAGEDEFA PIC  X(0001).
  3709     05  BAGEDEFI PIC  X(0004).
  3710*    -------------------------------
  3711     05  BCERTNOL PIC S9(0004) COMP.
  3712     05  BCERTNOF PIC  X(0001).
  3713     05  FILLER REDEFINES BCERTNOF.
  3714         10  BCERTNOA PIC  X(0001).
  3715     05  BCERTNOI PIC  X(0010).
  3716*    -------------------------------
  3717     05  BSUFIXL PIC S9(0004) COMP.
  3718     05  BSUFIXF PIC  X(0001).
  3719     05  FILLER REDEFINES BSUFIXF.
  3720         10  BSUFIXA PIC  X(0001).
  3721     05  BSUFIXI PIC  X(0001).
  3722*    -------------------------------
  3723     05  BEFFDTL PIC S9(0004) COMP.
  3724     05  BEFFDTF PIC  X(0001).
  3725     05  FILLER REDEFINES BEFFDTF.
  3726         10  BEFFDTA PIC  X(0001).
  3727     05  BEFFDTI PIC  X(0008).
  3728*    -------------------------------
  3729     05  BLSTNML PIC S9(0004) COMP.
  3730     05  BLSTNMF PIC  X(0001).
  3731     05  FILLER REDEFINES BLSTNMF.
  3732         10  BLSTNMA PIC  X(0001).
  3733     05  BLSTNMI PIC  X(0015).
  3734*    -------------------------------
  3735     05  B1STNML PIC S9(0004) COMP.
  3736     05  B1STNMF PIC  X(0001).
  3737     05  FILLER REDEFINES B1STNMF.
  3738         10  B1STNMA PIC  X(0001).
  3739     05  B1STNMI PIC  X(0010).
  3740*    -------------------------------
  3741     05  BINITL PIC S9(0004) COMP.
  3742     05  BINITF PIC  X(0001).
  3743     05  FILLER REDEFINES BINITF.
  3744         10  BINITA PIC  X(0001).
  3745     05  BINITI PIC  X(0001).
  3746*    -------------------------------
  3747     05  BSEXL PIC S9(0004) COMP.
  3748     05  BSEXF PIC  X(0001).
  3749     05  FILLER REDEFINES BSEXF.
  3750         10  BSEXA PIC  X(0001).
  3751     05  BSEXI PIC  X(0001).
  3752*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page  72
* EL6311.cbl
  3753     05  BAGEL PIC S9(0004) COMP.
  3754     05  BAGEF PIC  X(0001).
  3755     05  FILLER REDEFINES BAGEF.
  3756         10  BAGEA PIC  X(0001).
  3757     05  BAGEI PIC  X(0002).
  3758*    -------------------------------
  3759     05  BBIRTHL PIC S9(0004) COMP.
  3760     05  BBIRTHF PIC  X(0001).
  3761     05  FILLER REDEFINES BBIRTHF.
  3762         10  BBIRTHA PIC  X(0001).
  3763     05  BBIRTHI PIC  X(0008).
  3764*    -------------------------------
  3765     05  B1STPMTL PIC S9(0004) COMP.
  3766     05  B1STPMTF PIC  X(0001).
  3767     05  FILLER REDEFINES B1STPMTF.
  3768         10  B1STPMTA PIC  X(0001).
  3769     05  B1STPMTI PIC  X(0008).
  3770*    -------------------------------
  3771     05  BDAYSL PIC S9(0004) COMP.
  3772     05  BDAYSF PIC  X(0001).
  3773     05  FILLER REDEFINES BDAYSF.
  3774         10  BDAYSA PIC  X(0001).
  3775     05  BDAYSI PIC  X(0003).
  3776*    -------------------------------
  3777     05  BLNTRML PIC S9(0004) COMP.
  3778     05  BLNTRMF PIC  X(0001).
  3779     05  FILLER REDEFINES BLNTRMF.
  3780         10  BLNTRMA PIC  X(0001).
  3781     05  BLNTRMI PIC  X(0003).
  3782*    -------------------------------
  3783     05  BLNOFCRL PIC S9(0004) COMP.
  3784     05  BLNOFCRF PIC  X(0001).
  3785     05  FILLER REDEFINES BLNOFCRF.
  3786         10  BLNOFCRA PIC  X(0001).
  3787     05  BLNOFCRI PIC  X(0005).
  3788*    -------------------------------
  3789     05  BMODEL PIC S9(0004) COMP.
  3790     05  BMODEF PIC  X(0001).
  3791     05  FILLER REDEFINES BMODEF.
  3792         10  BMODEA PIC  X(0001).
  3793     05  BMODEI PIC  X(0001).
  3794*    -------------------------------
  3795     05  BFREQL PIC S9(0004) COMP.
  3796     05  BFREQF PIC  X(0001).
  3797     05  FILLER REDEFINES BFREQF.
  3798         10  BFREQA PIC  X(0001).
  3799     05  BFREQI PIC  X(0002).
  3800*    -------------------------------
  3801     05  BPMTSL PIC S9(0004) COMP.
  3802     05  BPMTSF PIC  X(0001).
  3803     05  FILLER REDEFINES BPMTSF.
  3804         10  BPMTSA PIC  X(0001).
  3805     05  BPMTSI PIC  999.
  3806*    -------------------------------
  3807     05  BPMTAMTL PIC S9(0004) COMP.
  3808     05  BPMTAMTF PIC  X(0001).
  3809     05  FILLER REDEFINES BPMTAMTF.
  3810         10  BPMTAMTA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page  73
* EL6311.cbl
  3811     05  BPMTAMTI PIC  9(7)V99.
  3812*    -------------------------------
  3813     05  BAPRL PIC S9(0004) COMP.
  3814     05  BAPRF PIC  X(0001).
  3815     05  FILLER REDEFINES BAPRF.
  3816         10  BAPRA PIC  X(0001).
  3817     05  BAPRI PIC  X(7).
  3818*    -------------------------------
  3819     05  BLIVESL PIC S9(0004) COMP.
  3820     05  BLIVESF PIC  X(0001).
  3821     05  FILLER REDEFINES BLIVESF.
  3822         10  BLIVESA PIC  X(0001).
  3823     05  BLIVESI PIC  X(0009).
  3824*    -------------------------------
  3825     05  BMEMCAPL PIC S9(0004) COMP.
  3826     05  BMEMCAPF PIC  X(0001).
  3827     05  FILLER REDEFINES BMEMCAPF.
  3828         10  BMEMCAPA PIC  X(0001).
  3829     05  BMEMCAPI PIC  X(0011).
  3830*    -------------------------------
  3831     05  BORIGHDL PIC S9(0004) COMP.
  3832     05  BORIGHDF PIC  X(0001).
  3833     05  FILLER REDEFINES BORIGHDF.
  3834         10  BORIGHDA PIC  X(0001).
  3835     05  BORIGHDI PIC  X(0009).
  3836*    -------------------------------
  3837     05  DMDBILL PIC S9(0004) COMP.
  3838     05  DMDBILF PIC  X(0001).
  3839     05  FILLER REDEFINES DMDBILF.
  3840         10  DMDBILA PIC  X(0001).
  3841     05  DMDBILI PIC  X(0006).
  3842*    -------------------------------
  3843     05  BFORCEL PIC S9(0004) COMP.
  3844     05  BFORCEF PIC  X(0001).
  3845     05  FILLER REDEFINES BFORCEF.
  3846         10  BFORCEA PIC  X(0001).
  3847     05  BFORCEI PIC  X(0001).
  3848*    -------------------------------
  3849     05  BENTRYL PIC S9(0004) COMP.
  3850     05  BENTRYF PIC  X(0001).
  3851     05  FILLER REDEFINES BENTRYF.
  3852         10  BENTRYA PIC  X(0001).
  3853     05  BENTRYI PIC  X(0001).
  3854*    -------------------------------
  3855     05  BREINL PIC S9(0004) COMP.
  3856     05  BREINF PIC  X(0001).
  3857     05  FILLER REDEFINES BREINF.
  3858         10  BREINA PIC  X(0001).
  3859     05  BREINI PIC  X(0001).
  3860*    -------------------------------
  3861     05  BBILCDL PIC S9(0004) COMP.
  3862     05  BBILCDF PIC  X(0001).
  3863     05  FILLER REDEFINES BBILCDF.
  3864         10  BBILCDA PIC  X(0001).
  3865     05  BBILCDI PIC  X(0001).
  3866*    -------------------------------
  3867     05  BUNWRITL PIC S9(0004) COMP.
  3868     05  BUNWRITF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page  74
* EL6311.cbl
  3869     05  FILLER REDEFINES BUNWRITF.
  3870         10  BUNWRITA PIC  X(0001).
  3871     05  BUNWRITI PIC  X(0001).
  3872*    -------------------------------
  3873     05  BSKPCDL PIC S9(0004) COMP.
  3874     05  BSKPCDF PIC  X(0001).
  3875     05  FILLER REDEFINES BSKPCDF.
  3876         10  BSKPCDA PIC  X(0001).
  3877     05  BSKPCDI PIC  X(0001).
  3878*    -------------------------------
  3879     05  BINDGRPL PIC S9(0004) COMP.
  3880     05  BINDGRPF PIC  X(0001).
  3881     05  FILLER REDEFINES BINDGRPF.
  3882         10  BINDGRPA PIC  X(0001).
  3883     05  BINDGRPI PIC  X(0001).
  3884*    -------------------------------
  3885     05  BSIGL PIC S9(0004) COMP.
  3886     05  BSIGF PIC  X(0001).
  3887     05  FILLER REDEFINES BSIGF.
  3888         10  BSIGA PIC  X(0001).
  3889     05  BSIGI PIC  X(0001).
  3890*    -------------------------------
  3891     05  BRTCLSL PIC S9(0004) COMP.
  3892     05  BRTCLSF PIC  X(0001).
  3893     05  FILLER REDEFINES BRTCLSF.
  3894         10  BRTCLSA PIC  X(0001).
  3895     05  BRTCLSI PIC  X(0002).
  3896*    -------------------------------
  3897     05  BCHGCNTL PIC S9(0004) COMP.
  3898     05  BCHGCNTF PIC  X(0001).
  3899     05  FILLER REDEFINES BCHGCNTF.
  3900         10  BCHGCNTA PIC  X(0001).
  3901     05  BCHGCNTI PIC  X(0003).
  3902*    -------------------------------
  3903     05  BMEMBERL PIC S9(0004) COMP.
  3904     05  BMEMBERF PIC  X(0001).
  3905     05  FILLER REDEFINES BMEMBERF.
  3906         10  BMEMBERA PIC  X(0001).
  3907     05  BMEMBERI PIC  X(0012).
  3908*    -------------------------------
  3909     05  BORGNOL PIC S9(0004) COMP.
  3910     05  BORGNOF PIC  X(0001).
  3911     05  FILLER REDEFINES BORGNOF.
  3912         10  BORGNOA PIC  X(0001).
  3913     05  BORGNOI PIC  X(0006).
  3914*    -------------------------------
  3915     05  BORGSEQL PIC S9(0004) COMP.
  3916     05  BORGSEQF PIC  X(0001).
  3917     05  FILLER REDEFINES BORGSEQF.
  3918         10  BORGSEQA PIC  X(0001).
  3919     05  BORGSEQI PIC  X(0004).
  3920*    -------------------------------
  3921     05  BBILLEDL PIC S9(0004) COMP.
  3922     05  BBILLEDF PIC  X(0001).
  3923     05  FILLER REDEFINES BBILLEDF.
  3924         10  BBILLEDA PIC  X(0001).
  3925     05  BBILLEDI PIC  9(9).
  3926*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page  75
* EL6311.cbl
  3927     05  BKIND1L PIC S9(0004) COMP.
  3928     05  BKIND1F PIC  X(0001).
  3929     05  FILLER REDEFINES BKIND1F.
  3930         10  BKIND1A PIC  X(0001).
  3931     05  BKIND1I PIC  X(0002).
  3932*    -------------------------------
  3933     05  BTYPE1L PIC S9(0004) COMP.
  3934     05  BTYPE1F PIC  X(0001).
  3935     05  FILLER REDEFINES BTYPE1F.
  3936         10  BTYPE1A PIC  X(0001).
  3937     05  BTYPE1I PIC  X(0003).
  3938*    -------------------------------
  3939     05  BTERM1L PIC S9(0004) COMP.
  3940     05  BTERM1F PIC  X(0001).
  3941     05  FILLER REDEFINES BTERM1F.
  3942         10  BTERM1A PIC  X(0001).
  3943     05  BTERM1I PIC  X(0003).
  3944*    -------------------------------
  3945     05  BBEN1L PIC S9(0004) COMP.
  3946     05  BBEN1F PIC  X(0001).
  3947     05  FILLER REDEFINES BBEN1F.
  3948         10  BBEN1A PIC  X(0001).
  3949     05  BBEN1I PIC  X(0012).
  3950*    -------------------------------
  3951     05  BPREM1L PIC S9(0004) COMP.
  3952     05  BPREM1F PIC  X(0001).
  3953     05  FILLER REDEFINES BPREM1F.
  3954         10  BPREM1A PIC  X(0001).
  3955     05  BPREM1I PIC  X(0011).
  3956*    -------------------------------
  3957     05  BEXPIR1L PIC S9(0004) COMP.
  3958     05  BEXPIR1F PIC  X(0001).
  3959     05  FILLER REDEFINES BEXPIR1F.
  3960         10  BEXPIR1A PIC  X(0001).
  3961     05  BEXPIR1I PIC  X(0008).
  3962*    -------------------------------
  3963     05  BCP1L PIC S9(0004) COMP.
  3964     05  BCP1F PIC  X(0001).
  3965     05  FILLER REDEFINES BCP1F.
  3966         10  BCP1A PIC  X(0001).
  3967     05  BCP1I PIC  X(0002).
  3968*    -------------------------------
  3969     05  BALTBN1L PIC S9(0004) COMP.
  3970     05  BALTBN1F PIC  X(0001).
  3971     05  FILLER REDEFINES BALTBN1F.
  3972         10  BALTBN1A PIC  X(0001).
  3973     05  BALTBN1I PIC  X(0012).
  3974*    -------------------------------
  3975     05  BALTPR1L PIC S9(0004) COMP.
  3976     05  BALTPR1F PIC  X(0001).
  3977     05  FILLER REDEFINES BALTPR1F.
  3978         10  BALTPR1A PIC  X(0001).
  3979     05  BALTPR1I PIC  X(0011).
  3980*    -------------------------------
  3981     05  BBNCD1L PIC S9(0004) COMP.
  3982     05  BBNCD1F PIC  X(0001).
  3983     05  FILLER REDEFINES BBNCD1F.
  3984         10  BBNCD1A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page  76
* EL6311.cbl
  3985     05  BBNCD1I PIC  X(0003).
  3986*    -------------------------------
  3987     05  BCPRM1L PIC S9(0004) COMP.
  3988     05  BCPRM1F PIC  X(0001).
  3989     05  FILLER REDEFINES BCPRM1F.
  3990         10  BCPRM1A PIC  X(0001).
  3991     05  BCPRM1I PIC  X(0011).
  3992*    -------------------------------
  3993     05  BCAPRM1L PIC S9(0004) COMP.
  3994     05  BCAPRM1F PIC  X(0001).
  3995     05  FILLER REDEFINES BCAPRM1F.
  3996         10  BCAPRM1A PIC  X(0001).
  3997     05  BCAPRM1I PIC  X(0011).
  3998*    -------------------------------
  3999     05  BENABR1L PIC S9(0004) COMP.
  4000     05  BENABR1F PIC  X(0001).
  4001     05  FILLER REDEFINES BENABR1F.
  4002         10  BENABR1A PIC  X(0001).
  4003     05  BENABR1I PIC  X(0005).
  4004*    -------------------------------
  4005     05  BDIFF1L PIC S9(0004) COMP.
  4006     05  BDIFF1F PIC  X(0001).
  4007     05  FILLER REDEFINES BDIFF1F.
  4008         10  BDIFF1A PIC  X(0001).
  4009     05  BDIFF1I PIC  X(0011).
  4010*    -------------------------------
  4011     05  BBILIT1L PIC S9(0004) COMP.
  4012     05  BBILIT1F PIC  X(0001).
  4013     05  FILLER REDEFINES BBILIT1F.
  4014         10  BBILIT1A PIC  X(0001).
  4015     05  BBILIT1I PIC  X(0008).
  4016*    -------------------------------
  4017     05  BADIFF1L PIC S9(0004) COMP.
  4018     05  BADIFF1F PIC  X(0001).
  4019     05  FILLER REDEFINES BADIFF1F.
  4020         10  BADIFF1A PIC  X(0001).
  4021     05  BADIFF1I PIC  X(0011).
  4022*    -------------------------------
  4023     05  BKIND2L PIC S9(0004) COMP.
  4024     05  BKIND2F PIC  X(0001).
  4025     05  FILLER REDEFINES BKIND2F.
  4026         10  BKIND2A PIC  X(0001).
  4027     05  BKIND2I PIC  X(0002).
  4028*    -------------------------------
  4029     05  BTYPE2L PIC S9(0004) COMP.
  4030     05  BTYPE2F PIC  X(0001).
  4031     05  FILLER REDEFINES BTYPE2F.
  4032         10  BTYPE2A PIC  X(0001).
  4033     05  BTYPE2I PIC  X(0003).
  4034*    -------------------------------
  4035     05  BTERM2L PIC S9(0004) COMP.
  4036     05  BTERM2F PIC  X(0001).
  4037     05  FILLER REDEFINES BTERM2F.
  4038         10  BTERM2A PIC  X(0001).
  4039     05  BTERM2I PIC  X(0003).
  4040*    -------------------------------
  4041     05  BBEN2L PIC S9(0004) COMP.
  4042     05  BBEN2F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page  77
* EL6311.cbl
  4043     05  FILLER REDEFINES BBEN2F.
  4044         10  BBEN2A PIC  X(0001).
  4045     05  BBEN2I PIC  X(0012).
  4046*    -------------------------------
  4047     05  BPREM2L PIC S9(0004) COMP.
  4048     05  BPREM2F PIC  X(0001).
  4049     05  FILLER REDEFINES BPREM2F.
  4050         10  BPREM2A PIC  X(0001).
  4051     05  BPREM2I PIC  X(0011).
  4052*    -------------------------------
  4053     05  BEXPIR2L PIC S9(0004) COMP.
  4054     05  BEXPIR2F PIC  X(0001).
  4055     05  FILLER REDEFINES BEXPIR2F.
  4056         10  BEXPIR2A PIC  X(0001).
  4057     05  BEXPIR2I PIC  X(0008).
  4058*    -------------------------------
  4059     05  BCP2L PIC S9(0004) COMP.
  4060     05  BCP2F PIC  X(0001).
  4061     05  FILLER REDEFINES BCP2F.
  4062         10  BCP2A PIC  X(0001).
  4063     05  BCP2I PIC  X(0002).
  4064*    -------------------------------
  4065     05  BALTBN2L PIC S9(0004) COMP.
  4066     05  BALTBN2F PIC  X(0001).
  4067     05  FILLER REDEFINES BALTBN2F.
  4068         10  BALTBN2A PIC  X(0001).
  4069     05  BALTBN2I PIC  X(0012).
  4070*    -------------------------------
  4071     05  BALTPR2L PIC S9(0004) COMP.
  4072     05  BALTPR2F PIC  X(0001).
  4073     05  FILLER REDEFINES BALTPR2F.
  4074         10  BALTPR2A PIC  X(0001).
  4075     05  BALTPR2I PIC  X(0011).
  4076*    -------------------------------
  4077     05  BBNCD2L PIC S9(0004) COMP.
  4078     05  BBNCD2F PIC  X(0001).
  4079     05  FILLER REDEFINES BBNCD2F.
  4080         10  BBNCD2A PIC  X(0001).
  4081     05  BBNCD2I PIC  X(0003).
  4082*    -------------------------------
  4083     05  BCPRM2L PIC S9(0004) COMP.
  4084     05  BCPRM2F PIC  X(0001).
  4085     05  FILLER REDEFINES BCPRM2F.
  4086         10  BCPRM2A PIC  X(0001).
  4087     05  BCPRM2I PIC  X(0011).
  4088*    -------------------------------
  4089     05  BCAPRM2L PIC S9(0004) COMP.
  4090     05  BCAPRM2F PIC  X(0001).
  4091     05  FILLER REDEFINES BCAPRM2F.
  4092         10  BCAPRM2A PIC  X(0001).
  4093     05  BCAPRM2I PIC  X(0011).
  4094*    -------------------------------
  4095     05  BENABR2L PIC S9(0004) COMP.
  4096     05  BENABR2F PIC  X(0001).
  4097     05  FILLER REDEFINES BENABR2F.
  4098         10  BENABR2A PIC  X(0001).
  4099     05  BENABR2I PIC  X(0005).
  4100*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page  78
* EL6311.cbl
  4101     05  BDIFF2L PIC S9(0004) COMP.
  4102     05  BDIFF2F PIC  X(0001).
  4103     05  FILLER REDEFINES BDIFF2F.
  4104         10  BDIFF2A PIC  X(0001).
  4105     05  BDIFF2I PIC  X(0011).
  4106*    -------------------------------
  4107     05  BBILIT2L PIC S9(0004) COMP.
  4108     05  BBILIT2F PIC  X(0001).
  4109     05  FILLER REDEFINES BBILIT2F.
  4110         10  BBILIT2A PIC  X(0001).
  4111     05  BBILIT2I PIC  X(0008).
  4112*    -------------------------------
  4113     05  BADIFF2L PIC S9(0004) COMP.
  4114     05  BADIFF2F PIC  X(0001).
  4115     05  FILLER REDEFINES BADIFF2F.
  4116         10  BADIFF2A PIC  X(0001).
  4117     05  BADIFF2I PIC  X(0011).
  4118*    -------------------------------
  4119     05  BERMSG1L PIC S9(0004) COMP.
  4120     05  BERMSG1F PIC  X(0001).
  4121     05  FILLER REDEFINES BERMSG1F.
  4122         10  BERMSG1A PIC  X(0001).
  4123     05  BERMSG1I PIC  X(0078).
  4124*    -------------------------------
  4125     05  BERMSG2L PIC S9(0004) COMP.
  4126     05  BERMSG2F PIC  X(0001).
  4127     05  FILLER REDEFINES BERMSG2F.
  4128         10  BERMSG2A PIC  X(0001).
  4129     05  BERMSG2I PIC  X(0078).
  4130*    -------------------------------
  4131     05  BERMSG3L PIC S9(0004) COMP.
  4132     05  BERMSG3F PIC  X(0001).
  4133     05  FILLER REDEFINES BERMSG3F.
  4134         10  BERMSG3A PIC  X(0001).
  4135     05  BERMSG3I PIC  X(0078).
  4136*    -------------------------------
  4137     05  BPFENTRL PIC S9(0004) COMP.
  4138     05  BPFENTRF PIC  X(0001).
  4139     05  FILLER REDEFINES BPFENTRF.
  4140         10  BPFENTRA PIC  X(0001).
  4141     05  BPFENTRI PIC  9(2).
  4142*    -------------------------------
  4143     05  BPF5HDRL PIC S9(0004) COMP.
  4144     05  BPF5HDRF PIC  X(0001).
  4145     05  FILLER REDEFINES BPF5HDRF.
  4146         10  BPF5HDRA PIC  X(0001).
  4147     05  BPF5HDRI PIC  X(0005).
  4148*    -------------------------------
  4149     05  BPF4HDRL PIC S9(0004) COMP.
  4150     05  BPF4HDRF PIC  X(0001).
  4151     05  FILLER REDEFINES BPF4HDRF.
  4152         10  BPF4HDRA PIC  X(0001).
  4153     05  BPF4HDRI PIC  X(0013).
  4154*    -------------------------------
  4155     05  BF15HDRL PIC S9(0004) COMP.
  4156     05  BF15HDRF PIC  X(0001).
  4157     05  FILLER REDEFINES BF15HDRF.
  4158         10  BF15HDRA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page  79
* EL6311.cbl
  4159     05  BF15HDRI PIC  X(0010).
  4160 01  EL631BO REDEFINES EL631BI.
  4161     05  FILLER            PIC  X(0012).
  4162*    -------------------------------
  4163     05  FILLER            PIC  X(0003).
  4164     05  BDATEO PIC  X(0008).
  4165*    -------------------------------
  4166     05  FILLER            PIC  X(0003).
  4167     05  BTIMEO PIC  99.99.
  4168*    -------------------------------
  4169     05  FILLER            PIC  X(0003).
  4170     05  BHEADO PIC  X(0038).
  4171*    -------------------------------
  4172     05  FILLER            PIC  X(0003).
  4173     05  BNCERTLO PIC  X(0008).
  4174*    -------------------------------
  4175     05  FILLER            PIC  X(0003).
  4176     05  BNCERTO PIC  X(0011).
  4177*    -------------------------------
  4178     05  FILLER            PIC  X(0003).
  4179     05  BNSTATLO PIC  X(0009).
  4180*    -------------------------------
  4181     05  FILLER            PIC  X(0003).
  4182     05  BNSTATO PIC  X(0002).
  4183*    -------------------------------
  4184     05  FILLER            PIC  X(0003).
  4185     05  BCHGTO PIC  X(0004).
  4186*    -------------------------------
  4187     05  FILLER            PIC  X(0003).
  4188     05  BCHGO PIC  ZZZ9.
  4189*    -------------------------------
  4190     05  FILLER            PIC  X(0003).
  4191     05  BCOMPIDO PIC  X(0003).
  4192*    -------------------------------
  4193     05  FILLER            PIC  X(0003).
  4194     05  BREGIONO PIC  X(0006).
  4195*    -------------------------------
  4196     05  FILLER            PIC  X(0003).
  4197     05  BUSERO PIC  X(0004).
  4198*    -------------------------------
  4199     05  FILLER            PIC  X(0003).
  4200     05  BMAINTO PIC  X(0001).
  4201*    -------------------------------
  4202     05  FILLER            PIC  X(0003).
  4203     05  BMANTBYO PIC  X(0004).
  4204*    -------------------------------
  4205     05  FILLER            PIC  X(0003).
  4206     05  BCHGHDGO PIC  X(0003).
  4207*    -------------------------------
  4208     05  FILLER            PIC  X(0003).
  4209     05  BMANTDTO PIC  X(0008).
  4210*    -------------------------------
  4211     05  FILLER            PIC  X(0003).
  4212     05  BMANTATO PIC  99.99.
  4213*    -------------------------------
  4214     05  FILLER            PIC  X(0003).
  4215     05  BCSRO PIC  X(0004).
  4216*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page  80
* EL6311.cbl
  4217     05  FILLER            PIC  X(0003).
  4218     05  BBATCHO PIC  X(0006).
  4219*    -------------------------------
  4220     05  FILLER            PIC  X(0003).
  4221     05  BSEQO PIC  X(0004).
  4222*    -------------------------------
  4223     05  FILLER            PIC  X(0003).
  4224     05  BMOENDTO PIC  X(0008).
  4225*    -------------------------------
  4226     05  FILLER            PIC  X(0003).
  4227     05  BCARRO PIC  X(0001).
  4228*    -------------------------------
  4229     05  FILLER            PIC  X(0003).
  4230     05  BGROUPO PIC  X(0006).
  4231*    -------------------------------
  4232     05  FILLER            PIC  X(0003).
  4233     05  BSTATEO PIC  X(0002).
  4234*    -------------------------------
  4235     05  FILLER            PIC  X(0003).
  4236     05  BACCTO PIC  X(0010).
  4237*    -------------------------------
  4238     05  FILLER            PIC  X(0003).
  4239     05  BVINHO PIC  X(0004).
  4240*    -------------------------------
  4241     05  FILLER            PIC  X(0003).
  4242     05  BVINO PIC  X(0017).
  4243*    -------------------------------
  4244     05  FILLER            PIC  X(0003).
  4245     05  BREFHDGO PIC  X(0004).
  4246*    -------------------------------
  4247     05  FILLER            PIC  X(0003).
  4248     05  BREFO PIC  X(0012).
  4249*    -------------------------------
  4250     05  FILLER            PIC  X(0003).
  4251     05  LETRREQO PIC  X(0001).
  4252*    -------------------------------
  4253     05  FILLER            PIC  X(0003).
  4254     05  BAGEDEFO PIC  X(0004).
  4255*    -------------------------------
  4256     05  FILLER            PIC  X(0003).
  4257     05  BCERTNOO PIC  X(0010).
  4258*    -------------------------------
  4259     05  FILLER            PIC  X(0003).
  4260     05  BSUFIXO PIC  X(0001).
  4261*    -------------------------------
  4262     05  FILLER            PIC  X(0003).
  4263     05  BEFFDTO PIC  X(0008).
  4264*    -------------------------------
  4265     05  FILLER            PIC  X(0003).
  4266     05  BLSTNMO PIC  X(0015).
  4267*    -------------------------------
  4268     05  FILLER            PIC  X(0003).
  4269     05  B1STNMO PIC  X(0010).
  4270*    -------------------------------
  4271     05  FILLER            PIC  X(0003).
  4272     05  BINITO PIC  X(0001).
  4273*    -------------------------------
  4274     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page  81
* EL6311.cbl
  4275     05  BSEXO PIC  X(0001).
  4276*    -------------------------------
  4277     05  FILLER            PIC  X(0003).
  4278     05  BAGEO PIC  X(0002).
  4279*    -------------------------------
  4280     05  FILLER            PIC  X(0003).
  4281     05  BBIRTHO PIC  X(0008).
  4282*    -------------------------------
  4283     05  FILLER            PIC  X(0003).
  4284     05  B1STPMTO PIC  X(0008).
  4285*    -------------------------------
  4286     05  FILLER            PIC  X(0003).
  4287     05  BDAYSO PIC  X(0003).
  4288*    -------------------------------
  4289     05  FILLER            PIC  X(0003).
  4290     05  BLNTRMO PIC  X(0003).
  4291*    -------------------------------
  4292     05  FILLER            PIC  X(0003).
  4293     05  BLNOFCRO PIC  X(0005).
  4294*    -------------------------------
  4295     05  FILLER            PIC  X(0003).
  4296     05  BMODEO PIC  X(0001).
  4297*    -------------------------------
  4298     05  FILLER            PIC  X(0003).
  4299     05  BFREQO PIC  X(0002).
  4300*    -------------------------------
  4301     05  FILLER            PIC  X(0003).
  4302     05  BPMTSO PIC  X(0003).
  4303*    -------------------------------
  4304     05  FILLER            PIC  X(0003).
  4305     05  BPMTAMTO PIC  ZZZZZ9.99.
  4306*    -------------------------------
  4307     05  FILLER            PIC  X(0003).
  4308     05  BAPRO PIC  99.9999.
  4309*    -------------------------------
  4310     05  FILLER            PIC  X(0003).
  4311     05  BLIVESO PIC  Z,ZZZ,ZZZ.
  4312*    -------------------------------
  4313     05  FILLER            PIC  X(0003).
  4314     05  BMEMCAPO PIC  X(0011).
  4315*    -------------------------------
  4316     05  FILLER            PIC  X(0003).
  4317     05  BORIGHDO PIC  X(0009).
  4318*    -------------------------------
  4319     05  FILLER            PIC  X(0003).
  4320     05  DMDBILO PIC  X(0006).
  4321*    -------------------------------
  4322     05  FILLER            PIC  X(0003).
  4323     05  BFORCEO PIC  X(0001).
  4324*    -------------------------------
  4325     05  FILLER            PIC  X(0003).
  4326     05  BENTRYO PIC  X(0001).
  4327*    -------------------------------
  4328     05  FILLER            PIC  X(0003).
  4329     05  BREINO PIC  X(0001).
  4330*    -------------------------------
  4331     05  FILLER            PIC  X(0003).
  4332     05  BBILCDO PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page  82
* EL6311.cbl
  4333*    -------------------------------
  4334     05  FILLER            PIC  X(0003).
  4335     05  BUNWRITO PIC  X(0001).
  4336*    -------------------------------
  4337     05  FILLER            PIC  X(0003).
  4338     05  BSKPCDO PIC  X(0001).
  4339*    -------------------------------
  4340     05  FILLER            PIC  X(0003).
  4341     05  BINDGRPO PIC  X(0001).
  4342*    -------------------------------
  4343     05  FILLER            PIC  X(0003).
  4344     05  BSIGO PIC  X(0001).
  4345*    -------------------------------
  4346     05  FILLER            PIC  X(0003).
  4347     05  BRTCLSO PIC  X(0002).
  4348*    -------------------------------
  4349     05  FILLER            PIC  X(0003).
  4350     05  BCHGCNTO PIC  X(0003).
  4351*    -------------------------------
  4352     05  FILLER            PIC  X(0003).
  4353     05  BMEMBERO PIC  X(0012).
  4354*    -------------------------------
  4355     05  FILLER            PIC  X(0003).
  4356     05  BORGNOO PIC  X(0006).
  4357*    -------------------------------
  4358     05  FILLER            PIC  X(0003).
  4359     05  BORGSEQO PIC  X(0004).
  4360*    -------------------------------
  4361     05  FILLER            PIC  X(0003).
  4362     05  BBILLEDO PIC  Z,ZZZ,ZZZ.
  4363*    -------------------------------
  4364     05  FILLER            PIC  X(0003).
  4365     05  BKIND1O PIC  X(0002).
  4366*    -------------------------------
  4367     05  FILLER            PIC  X(0003).
  4368     05  BTYPE1O PIC  X(0003).
  4369*    -------------------------------
  4370     05  FILLER            PIC  X(0003).
  4371     05  BTERM1O PIC  X(0003).
  4372*    -------------------------------
  4373     05  FILLER            PIC  X(0003).
  4374     05  BBEN1O PIC  X(0012).
  4375*    -------------------------------
  4376     05  FILLER            PIC  X(0003).
  4377     05  BPREM1O PIC  X(0011).
  4378*    -------------------------------
  4379     05  FILLER            PIC  X(0003).
  4380     05  BEXPIR1O PIC  X(0008).
  4381*    -------------------------------
  4382     05  FILLER            PIC  X(0003).
  4383     05  BCP1O PIC  X(0002).
  4384*    -------------------------------
  4385     05  FILLER            PIC  X(0003).
  4386     05  BALTBN1O PIC  X(0012).
  4387*    -------------------------------
  4388     05  FILLER            PIC  X(0003).
  4389     05  BALTPR1O PIC  X(0011).
  4390*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page  83
* EL6311.cbl
  4391     05  FILLER            PIC  X(0003).
  4392     05  BBNCD1O PIC  X(0003).
  4393*    -------------------------------
  4394     05  FILLER            PIC  X(0003).
  4395     05  BCPRM1O PIC  X(0011).
  4396*    -------------------------------
  4397     05  FILLER            PIC  X(0003).
  4398     05  BCAPRM1O PIC  X(0011).
  4399*    -------------------------------
  4400     05  FILLER            PIC  X(0003).
  4401     05  BENABR1O PIC  X(0005).
  4402*    -------------------------------
  4403     05  FILLER            PIC  X(0003).
  4404     05  BDIFF1O PIC  X(0011).
  4405*    -------------------------------
  4406     05  FILLER            PIC  X(0003).
  4407     05  BBILIT1O PIC  X(0008).
  4408*    -------------------------------
  4409     05  FILLER            PIC  X(0003).
  4410     05  BADIFF1O PIC  X(0011).
  4411*    -------------------------------
  4412     05  FILLER            PIC  X(0003).
  4413     05  BKIND2O PIC  X(0002).
  4414*    -------------------------------
  4415     05  FILLER            PIC  X(0003).
  4416     05  BTYPE2O PIC  X(0003).
  4417*    -------------------------------
  4418     05  FILLER            PIC  X(0003).
  4419     05  BTERM2O PIC  X(0003).
  4420*    -------------------------------
  4421     05  FILLER            PIC  X(0003).
  4422     05  BBEN2O PIC  X(0012).
  4423*    -------------------------------
  4424     05  FILLER            PIC  X(0003).
  4425     05  BPREM2O PIC  X(0011).
  4426*    -------------------------------
  4427     05  FILLER            PIC  X(0003).
  4428     05  BEXPIR2O PIC  X(0008).
  4429*    -------------------------------
  4430     05  FILLER            PIC  X(0003).
  4431     05  BCP2O PIC  X(0002).
  4432*    -------------------------------
  4433     05  FILLER            PIC  X(0003).
  4434     05  BALTBN2O PIC  X(0012).
  4435*    -------------------------------
  4436     05  FILLER            PIC  X(0003).
  4437     05  BALTPR2O PIC  X(0011).
  4438*    -------------------------------
  4439     05  FILLER            PIC  X(0003).
  4440     05  BBNCD2O PIC  X(0003).
  4441*    -------------------------------
  4442     05  FILLER            PIC  X(0003).
  4443     05  BCPRM2O PIC  X(0011).
  4444*    -------------------------------
  4445     05  FILLER            PIC  X(0003).
  4446     05  BCAPRM2O PIC  X(0011).
  4447*    -------------------------------
  4448     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page  84
* EL6311.cbl
  4449     05  BENABR2O PIC  X(0005).
  4450*    -------------------------------
  4451     05  FILLER            PIC  X(0003).
  4452     05  BDIFF2O PIC  X(0011).
  4453*    -------------------------------
  4454     05  FILLER            PIC  X(0003).
  4455     05  BBILIT2O PIC  X(0008).
  4456*    -------------------------------
  4457     05  FILLER            PIC  X(0003).
  4458     05  BADIFF2O PIC  X(0011).
  4459*    -------------------------------
  4460     05  FILLER            PIC  X(0003).
  4461     05  BERMSG1O PIC  X(0078).
  4462*    -------------------------------
  4463     05  FILLER            PIC  X(0003).
  4464     05  BERMSG2O PIC  X(0078).
  4465*    -------------------------------
  4466     05  FILLER            PIC  X(0003).
  4467     05  BERMSG3O PIC  X(0078).
  4468*    -------------------------------
  4469     05  FILLER            PIC  X(0003).
  4470     05  BPFENTRO PIC  X(0002).
  4471*    -------------------------------
  4472     05  FILLER            PIC  X(0003).
  4473     05  BPF5HDRO PIC  X(0005).
  4474*    -------------------------------
  4475     05  FILLER            PIC  X(0003).
  4476     05  BPF4HDRO PIC  X(0013).
  4477*    -------------------------------
  4478     05  FILLER            PIC  X(0003).
  4479     05  BF15HDRO PIC  X(0010).
  4480*    -------------------------------
  4481 01  EL631CI REDEFINES EL631BI.
  4482     05  FILLER            PIC  X(0012).
  4483*    -------------------------------
  4484     05  CDATEL PIC S9(0004) COMP.
  4485     05  CDATEF PIC  X(0001).
  4486     05  FILLER REDEFINES CDATEF.
  4487         10  CDATEA PIC  X(0001).
  4488     05  CDATEI PIC  X(0008).
  4489*    -------------------------------
  4490     05  CTIMEL PIC S9(0004) COMP.
  4491     05  CTIMEF PIC  X(0001).
  4492     05  FILLER REDEFINES CTIMEF.
  4493         10  CTIMEA PIC  X(0001).
  4494     05  CTIMEI PIC  X(0005).
  4495*    -------------------------------
  4496     05  CHEADL PIC S9(0004) COMP.
  4497     05  CHEADF PIC  X(0001).
  4498     05  FILLER REDEFINES CHEADF.
  4499         10  CHEADA PIC  X(0001).
  4500     05  CHEADI PIC  X(0038).
  4501*    -------------------------------
  4502     05  CCHGTL PIC S9(0004) COMP.
  4503     05  CCHGTF PIC  X(0001).
  4504     05  FILLER REDEFINES CCHGTF.
  4505         10  CCHGTA PIC  X(0001).
  4506     05  CCHGTI PIC  X(0004).
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page  85
* EL6311.cbl
  4507*    -------------------------------
  4508     05  CCHGL PIC S9(0004) COMP.
  4509     05  CCHGF PIC  X(0001).
  4510     05  FILLER REDEFINES CCHGF.
  4511         10  CCHGA PIC  X(0001).
  4512     05  CCHGI PIC  X(0004).
  4513*    -------------------------------
  4514     05  CMAINTL PIC S9(0004) COMP.
  4515     05  CMAINTF PIC  X(0001).
  4516     05  FILLER REDEFINES CMAINTF.
  4517         10  CMAINTA PIC  X(0001).
  4518     05  CMAINTI PIC  X(0001).
  4519*    -------------------------------
  4520     05  CMANTBYL PIC S9(0004) COMP.
  4521     05  CMANTBYF PIC  X(0001).
  4522     05  FILLER REDEFINES CMANTBYF.
  4523         10  CMANTBYA PIC  X(0001).
  4524     05  CMANTBYI PIC  X(0004).
  4525*    -------------------------------
  4526     05  CCHGHDGL PIC S9(0004) COMP.
  4527     05  CCHGHDGF PIC  X(0001).
  4528     05  FILLER REDEFINES CCHGHDGF.
  4529         10  CCHGHDGA PIC  X(0001).
  4530     05  CCHGHDGI PIC  X(0003).
  4531*    -------------------------------
  4532     05  CMANTDTL PIC S9(0004) COMP.
  4533     05  CMANTDTF PIC  X(0001).
  4534     05  FILLER REDEFINES CMANTDTF.
  4535         10  CMANTDTA PIC  X(0001).
  4536     05  CMANTDTI PIC  X(0008).
  4537*    -------------------------------
  4538     05  CMANTATL PIC S9(0004) COMP.
  4539     05  CMANTATF PIC  X(0001).
  4540     05  FILLER REDEFINES CMANTATF.
  4541         10  CMANTATA PIC  X(0001).
  4542     05  CMANTATI PIC  X(0005).
  4543*    -------------------------------
  4544     05  CCSRL PIC S9(0004) COMP.
  4545     05  CCSRF PIC  X(0001).
  4546     05  FILLER REDEFINES CCSRF.
  4547         10  CCSRA PIC  X(0001).
  4548     05  CCSRI PIC  X(0004).
  4549*    -------------------------------
  4550     05  CBATCHL PIC S9(0004) COMP.
  4551     05  CBATCHF PIC  X(0001).
  4552     05  FILLER REDEFINES CBATCHF.
  4553         10  CBATCHA PIC  X(0001).
  4554     05  CBATCHI PIC  X(0006).
  4555*    -------------------------------
  4556     05  CSEQL PIC S9(0004) COMP.
  4557     05  CSEQF PIC  X(0001).
  4558     05  FILLER REDEFINES CSEQF.
  4559         10  CSEQA PIC  X(0001).
  4560     05  CSEQI PIC  X(0004).
  4561*    -------------------------------
  4562     05  CMOENDTL PIC S9(0004) COMP.
  4563     05  CMOENDTF PIC  X(0001).
  4564     05  FILLER REDEFINES CMOENDTF.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page  86
* EL6311.cbl
  4565         10  CMOENDTA PIC  X(0001).
  4566     05  CMOENDTI PIC  X(0008).
  4567*    -------------------------------
  4568     05  CCARRL PIC S9(0004) COMP.
  4569     05  CCARRF PIC  X(0001).
  4570     05  FILLER REDEFINES CCARRF.
  4571         10  CCARRA PIC  X(0001).
  4572     05  CCARRI PIC  X(0001).
  4573*    -------------------------------
  4574     05  CGROUPL PIC S9(0004) COMP.
  4575     05  CGROUPF PIC  X(0001).
  4576     05  FILLER REDEFINES CGROUPF.
  4577         10  CGROUPA PIC  X(0001).
  4578     05  CGROUPI PIC  X(0006).
  4579*    -------------------------------
  4580     05  CSTATEL PIC S9(0004) COMP.
  4581     05  CSTATEF PIC  X(0001).
  4582     05  FILLER REDEFINES CSTATEF.
  4583         10  CSTATEA PIC  X(0001).
  4584     05  CSTATEI PIC  X(0002).
  4585*    -------------------------------
  4586     05  CACCTL PIC S9(0004) COMP.
  4587     05  CACCTF PIC  X(0001).
  4588     05  FILLER REDEFINES CACCTF.
  4589         10  CACCTA PIC  X(0001).
  4590     05  CACCTI PIC  X(0010).
  4591*    -------------------------------
  4592     05  CORIGHDL PIC S9(0004) COMP.
  4593     05  CORIGHDF PIC  X(0001).
  4594     05  FILLER REDEFINES CORIGHDF.
  4595         10  CORIGHDA PIC  X(0001).
  4596     05  CORIGHDI PIC  X(0011).
  4597*    -------------------------------
  4598     05  CORGNOL PIC S9(0004) COMP.
  4599     05  CORGNOF PIC  X(0001).
  4600     05  FILLER REDEFINES CORGNOF.
  4601         10  CORGNOA PIC  X(0001).
  4602     05  CORGNOI PIC  X(0006).
  4603*    -------------------------------
  4604     05  CORGSEQL PIC S9(0004) COMP.
  4605     05  CORGSEQF PIC  X(0001).
  4606     05  FILLER REDEFINES CORGSEQF.
  4607         10  CORGSEQA PIC  X(0001).
  4608     05  CORGSEQI PIC  X(0004).
  4609*    -------------------------------
  4610     05  CREFHDGL PIC S9(0004) COMP.
  4611     05  CREFHDGF PIC  X(0001).
  4612     05  FILLER REDEFINES CREFHDGF.
  4613         10  CREFHDGA PIC  X(0001).
  4614     05  CREFHDGI PIC  X(0010).
  4615*    -------------------------------
  4616     05  CREFL PIC S9(0004) COMP.
  4617     05  CREFF PIC  X(0001).
  4618     05  FILLER REDEFINES CREFF.
  4619         10  CREFA PIC  X(0001).
  4620     05  CREFI PIC  X(0012).
  4621*    -------------------------------
  4622     05  CNHINTL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page  87
* EL6311.cbl
  4623     05  CNHINTF PIC  X(0001).
  4624     05  FILLER REDEFINES CNHINTF.
  4625         10  CNHINTA PIC  X(0001).
  4626     05  CNHINTI PIC  9(7)V99.
  4627*    -------------------------------
  4628     05  CCERTNOL PIC S9(0004) COMP.
  4629     05  CCERTNOF PIC  X(0001).
  4630     05  FILLER REDEFINES CCERTNOF.
  4631         10  CCERTNOA PIC  X(0001).
  4632     05  CCERTNOI PIC  X(0010).
  4633*    -------------------------------
  4634     05  CSUFIXL PIC S9(0004) COMP.
  4635     05  CSUFIXF PIC  X(0001).
  4636     05  FILLER REDEFINES CSUFIXF.
  4637         10  CSUFIXA PIC  X(0001).
  4638     05  CSUFIXI PIC  X(0001).
  4639*    -------------------------------
  4640     05  CEFFDTL PIC S9(0004) COMP.
  4641     05  CEFFDTF PIC  X(0001).
  4642     05  FILLER REDEFINES CEFFDTF.
  4643         10  CEFFDTA PIC  X(0001).
  4644     05  CEFFDTI PIC  X(0008).
  4645*    -------------------------------
  4646     05  CLSTNML PIC S9(0004) COMP.
  4647     05  CLSTNMF PIC  X(0001).
  4648     05  FILLER REDEFINES CLSTNMF.
  4649         10  CLSTNMA PIC  X(0001).
  4650     05  CLSTNMI PIC  X(0015).
  4651*    -------------------------------
  4652     05  CINAMEL PIC S9(0004) COMP.
  4653     05  CINAMEF PIC  X(0001).
  4654     05  FILLER REDEFINES CINAMEF.
  4655         10  CINAMEA PIC  X(0001).
  4656     05  CINAMEI PIC  X(0015).
  4657*    -------------------------------
  4658     05  CINITSL PIC S9(0004) COMP.
  4659     05  CINITSF PIC  X(0001).
  4660     05  FILLER REDEFINES CINITSF.
  4661         10  CINITSA PIC  X(0001).
  4662     05  CINITSI PIC  X(0010).
  4663*    -------------------------------
  4664     05  CCANREAL PIC S9(0004) COMP.
  4665     05  CCANREAF PIC  X(0001).
  4666     05  FILLER REDEFINES CCANREAF.
  4667         10  CCANREAA PIC  X(0001).
  4668     05  CCANREAI PIC  X(0001).
  4669*    -------------------------------
  4670     05  ACTSPCL PIC S9(0004) COMP.
  4671     05  ACTSPCF PIC  X(0001).
  4672     05  FILLER REDEFINES ACTSPCF.
  4673         10  ACTSPCA PIC  X(0001).
  4674     05  ACTSPCI PIC  X(0001).
  4675*    -------------------------------
  4676     05  CKIND1L PIC S9(0004) COMP.
  4677     05  CKIND1F PIC  X(0001).
  4678     05  FILLER REDEFINES CKIND1F.
  4679         10  CKIND1A PIC  X(0001).
  4680     05  CKIND1I PIC  X(0002).
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page  88
* EL6311.cbl
  4681*    -------------------------------
  4682     05  CCANDT1L PIC S9(0004) COMP.
  4683     05  CCANDT1F PIC  X(0001).
  4684     05  FILLER REDEFINES CCANDT1F.
  4685         10  CCANDT1A PIC  X(0001).
  4686     05  CCANDT1I PIC  X(0008).
  4687*    -------------------------------
  4688     05  CREFND1L PIC S9(0004) COMP.
  4689     05  CREFND1F PIC  X(0001).
  4690     05  FILLER REDEFINES CREFND1F.
  4691         10  CREFND1A PIC  X(0001).
  4692     05  CREFND1I PIC  S9(9)V99.
  4693*    -------------------------------
  4694     05  CMTHD1L PIC S9(0004) COMP.
  4695     05  CMTHD1F PIC  X(0001).
  4696     05  FILLER REDEFINES CMTHD1F.
  4697         10  CMTHD1A PIC  X(0001).
  4698     05  CMTHD1I PIC  X(0001).
  4699*    -------------------------------
  4700     05  CKIND2L PIC S9(0004) COMP.
  4701     05  CKIND2F PIC  X(0001).
  4702     05  FILLER REDEFINES CKIND2F.
  4703         10  CKIND2A PIC  X(0001).
  4704     05  CKIND2I PIC  X(0002).
  4705*    -------------------------------
  4706     05  CCANDT2L PIC S9(0004) COMP.
  4707     05  CCANDT2F PIC  X(0001).
  4708     05  FILLER REDEFINES CCANDT2F.
  4709         10  CCANDT2A PIC  X(0001).
  4710     05  CCANDT2I PIC  X(0008).
  4711*    -------------------------------
  4712     05  CREFND2L PIC S9(0004) COMP.
  4713     05  CREFND2F PIC  X(0001).
  4714     05  FILLER REDEFINES CREFND2F.
  4715         10  CREFND2A PIC  X(0001).
  4716     05  CREFND2I PIC  S9(9)V99.
  4717*    -------------------------------
  4718     05  CMTHD2L PIC S9(0004) COMP.
  4719     05  CMTHD2F PIC  X(0001).
  4720     05  FILLER REDEFINES CMTHD2F.
  4721         10  CMTHD2A PIC  X(0001).
  4722     05  CMTHD2I PIC  X(0001).
  4723*    -------------------------------
  4724     05  CLIVESL PIC S9(0004) COMP.
  4725     05  CLIVESF PIC  X(0001).
  4726     05  FILLER REDEFINES CLIVESF.
  4727         10  CLIVESA PIC  X(0001).
  4728     05  CLIVESI PIC  X(0003).
  4729*    -------------------------------
  4730     05  CFORCEL PIC S9(0004) COMP.
  4731     05  CFORCEF PIC  X(0001).
  4732     05  FILLER REDEFINES CFORCEF.
  4733         10  CFORCEA PIC  X(0001).
  4734     05  CFORCEI PIC  X(0001).
  4735*    -------------------------------
  4736     05  CBILCDL PIC S9(0004) COMP.
  4737     05  CBILCDF PIC  X(0001).
  4738     05  FILLER REDEFINES CBILCDF.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page  89
* EL6311.cbl
  4739         10  CBILCDA PIC  X(0001).
  4740     05  CBILCDI PIC  X(0001).
  4741*    -------------------------------
  4742     05  CCRFND1L PIC S9(0004) COMP.
  4743     05  CCRFND1F PIC  X(0001).
  4744     05  FILLER REDEFINES CCRFND1F.
  4745         10  CCRFND1A PIC  X(0001).
  4746     05  CCRFND1I PIC  X(0011).
  4747*    -------------------------------
  4748     05  CCRFND2L PIC S9(0004) COMP.
  4749     05  CCRFND2F PIC  X(0001).
  4750     05  FILLER REDEFINES CCRFND2F.
  4751         10  CCRFND2A PIC  X(0001).
  4752     05  CCRFND2I PIC  X(0011).
  4753*    -------------------------------
  4754     05  CBILIT1L PIC S9(0004) COMP.
  4755     05  CBILIT1F PIC  X(0001).
  4756     05  FILLER REDEFINES CBILIT1F.
  4757         10  CBILIT1A PIC  X(0001).
  4758     05  CBILIT1I PIC  X(0008).
  4759*    -------------------------------
  4760     05  CDRFND1L PIC S9(0004) COMP.
  4761     05  CDRFND1F PIC  X(0001).
  4762     05  FILLER REDEFINES CDRFND1F.
  4763         10  CDRFND1A PIC  X(0001).
  4764     05  CDRFND1I PIC  X(0011).
  4765*    -------------------------------
  4766     05  CBILIT2L PIC S9(0004) COMP.
  4767     05  CBILIT2F PIC  X(0001).
  4768     05  FILLER REDEFINES CBILIT2F.
  4769         10  CBILIT2A PIC  X(0001).
  4770     05  CBILIT2I PIC  X(0008).
  4771*    -------------------------------
  4772     05  CDRFND2L PIC S9(0004) COMP.
  4773     05  CDRFND2F PIC  X(0001).
  4774     05  FILLER REDEFINES CDRFND2F.
  4775         10  CDRFND2A PIC  X(0001).
  4776     05  CDRFND2I PIC  X(0011).
  4777*    -------------------------------
  4778     05  CCANTXTL PIC S9(0004) COMP.
  4779     05  CCANTXTF PIC  X(0001).
  4780     05  FILLER REDEFINES CCANTXTF.
  4781         10  CCANTXTA PIC  X(0001).
  4782     05  CCANTXTI PIC  X(0005).
  4783*    -------------------------------
  4784     05  CCANFEEL PIC S9(0004) COMP.
  4785     05  CCANFEEF PIC  X(0001).
  4786     05  FILLER REDEFINES CCANFEEF.
  4787         10  CCANFEEA PIC  X(0001).
  4788     05  CCANFEEI PIC  X(0002).
  4789*    -------------------------------
  4790     05  CTERM1L PIC S9(0004) COMP.
  4791     05  CTERM1F PIC  X(0001).
  4792     05  FILLER REDEFINES CTERM1F.
  4793         10  CTERM1A PIC  X(0001).
  4794     05  CTERM1I PIC  X(0003).
  4795*    -------------------------------
  4796     05  CRTERM1L PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page  90
* EL6311.cbl
  4797     05  CRTERM1F PIC  X(0001).
  4798     05  FILLER REDEFINES CRTERM1F.
  4799         10  CRTERM1A PIC  X(0001).
  4800     05  CRTERM1I PIC  X(0003).
  4801*    -------------------------------
  4802     05  CPREM1L PIC S9(0004) COMP.
  4803     05  CPREM1F PIC  X(0001).
  4804     05  FILLER REDEFINES CPREM1F.
  4805         10  CPREM1A PIC  X(0001).
  4806     05  CPREM1I PIC  X(0011).
  4807*    -------------------------------
  4808     05  CTERM2L PIC S9(0004) COMP.
  4809     05  CTERM2F PIC  X(0001).
  4810     05  FILLER REDEFINES CTERM2F.
  4811         10  CTERM2A PIC  X(0001).
  4812     05  CTERM2I PIC  X(0003).
  4813*    -------------------------------
  4814     05  CRTERM2L PIC S9(0004) COMP.
  4815     05  CRTERM2F PIC  X(0001).
  4816     05  FILLER REDEFINES CRTERM2F.
  4817         10  CRTERM2A PIC  X(0001).
  4818     05  CRTERM2I PIC  X(0003).
  4819*    -------------------------------
  4820     05  CPREM2L PIC S9(0004) COMP.
  4821     05  CPREM2F PIC  X(0001).
  4822     05  FILLER REDEFINES CPREM2F.
  4823         10  CPREM2A PIC  X(0001).
  4824     05  CPREM2I PIC  X(0011).
  4825*    -------------------------------
  4826     05  CENTRDTL PIC S9(0004) COMP.
  4827     05  CENTRDTF PIC  X(0001).
  4828     05  FILLER REDEFINES CENTRDTF.
  4829         10  CENTRDTA PIC  X(0001).
  4830     05  CENTRDTI PIC  X(0008).
  4831*    -------------------------------
  4832     05  CPAYEEL PIC S9(0004) COMP.
  4833     05  CPAYEEF PIC  X(0001).
  4834     05  FILLER REDEFINES CPAYEEF.
  4835         10  CPAYEEA PIC  X(0001).
  4836     05  CPAYEEI PIC  X(0006).
  4837*    -------------------------------
  4838     05  CRFNDSWL PIC S9(0004) COMP.
  4839     05  CRFNDSWF PIC  X(0001).
  4840     05  FILLER REDEFINES CRFNDSWF.
  4841         10  CRFNDSWA PIC  X(0001).
  4842     05  CRFNDSWI PIC  X(0003).
  4843*    -------------------------------
  4844     05  CLFHDGL PIC S9(0004) COMP.
  4845     05  CLFHDGF PIC  X(0001).
  4846     05  FILLER REDEFINES CLFHDGF.
  4847         10  CLFHDGA PIC  X(0001).
  4848     05  CLFHDGI PIC  X(0006).
  4849*    -------------------------------
  4850     05  CAHHDGL PIC S9(0004) COMP.
  4851     05  CAHHDGF PIC  X(0001).
  4852     05  FILLER REDEFINES CAHHDGF.
  4853         10  CAHHDGA PIC  X(0001).
  4854     05  CAHHDGI PIC  X(0006).
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page  91
* EL6311.cbl
  4855*    -------------------------------
  4856     05  CENTDTL PIC S9(0004) COMP.
  4857     05  CENTDTF PIC  X(0001).
  4858     05  FILLER REDEFINES CENTDTF.
  4859         10  CENTDTA PIC  X(0001).
  4860     05  CENTDTI PIC  X(0008).
  4861*    -------------------------------
  4862     05  CENTBYL PIC S9(0004) COMP.
  4863     05  CENTBYF PIC  X(0001).
  4864     05  FILLER REDEFINES CENTBYF.
  4865         10  CENTBYA PIC  X(0001).
  4866     05  CENTBYI PIC  X(0004).
  4867*    -------------------------------
  4868     05  CCHGCNTL PIC S9(0004) COMP.
  4869     05  CCHGCNTF PIC  X(0001).
  4870     05  FILLER REDEFINES CCHGCNTF.
  4871         10  CCHGCNTA PIC  X(0001).
  4872     05  CCHGCNTI PIC  X(0003).
  4873*    -------------------------------
  4874     05  CLFREFNL PIC S9(0004) COMP.
  4875     05  CLFREFNF PIC  X(0001).
  4876     05  FILLER REDEFINES CLFREFNF.
  4877         10  CLFREFNA PIC  X(0001).
  4878     05  CLFREFNI PIC  X(0006).
  4879*    -------------------------------
  4880     05  CAHREFNL PIC S9(0004) COMP.
  4881     05  CAHREFNF PIC  X(0001).
  4882     05  FILLER REDEFINES CAHREFNF.
  4883         10  CAHREFNA PIC  X(0001).
  4884     05  CAHREFNI PIC  X(0006).
  4885*    -------------------------------
  4886     05  CREINCDL PIC S9(0004) COMP.
  4887     05  CREINCDF PIC  X(0001).
  4888     05  FILLER REDEFINES CREINCDF.
  4889         10  CREINCDA PIC  X(0001).
  4890     05  CREINCDI PIC  X(0003).
  4891*    -------------------------------
  4892     05  CAEFFDTL PIC S9(0004) COMP.
  4893     05  CAEFFDTF PIC  X(0001).
  4894     05  FILLER REDEFINES CAEFFDTF.
  4895         10  CAEFFDTA PIC  X(0001).
  4896     05  CAEFFDTI PIC  X(0008).
  4897*    -------------------------------
  4898     05  CAEXPDTL PIC S9(0004) COMP.
  4899     05  CAEXPDTF PIC  X(0001).
  4900     05  FILLER REDEFINES CAEXPDTF.
  4901         10  CAEXPDTA PIC  X(0001).
  4902     05  CAEXPDTI PIC  X(0008).
  4903*    -------------------------------
  4904     05  COMMLFL PIC S9(0004) COMP.
  4905     05  COMMLFF PIC  X(0001).
  4906     05  FILLER REDEFINES COMMLFF.
  4907         10  COMMLFA PIC  X(0001).
  4908     05  COMMLFI PIC  X(0006).
  4909*    -------------------------------
  4910     05  COMMAHL PIC S9(0004) COMP.
  4911     05  COMMAHF PIC  X(0001).
  4912     05  FILLER REDEFINES COMMAHF.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page  92
* EL6311.cbl
  4913         10  COMMAHA PIC  X(0001).
  4914     05  COMMAHI PIC  X(0006).
  4915*    -------------------------------
  4916     05  CERMSG1L PIC S9(0004) COMP.
  4917     05  CERMSG1F PIC  X(0001).
  4918     05  FILLER REDEFINES CERMSG1F.
  4919         10  CERMSG1A PIC  X(0001).
  4920     05  CERMSG1I PIC  X(0078).
  4921*    -------------------------------
  4922     05  CERMSG2L PIC S9(0004) COMP.
  4923     05  CERMSG2F PIC  X(0001).
  4924     05  FILLER REDEFINES CERMSG2F.
  4925         10  CERMSG2A PIC  X(0001).
  4926     05  CERMSG2I PIC  X(0078).
  4927*    -------------------------------
  4928     05  CERMSG3L PIC S9(0004) COMP.
  4929     05  CERMSG3F PIC  X(0001).
  4930     05  FILLER REDEFINES CERMSG3F.
  4931         10  CERMSG3A PIC  X(0001).
  4932     05  CERMSG3I PIC  X(0078).
  4933*    -------------------------------
  4934     05  CPFENTRL PIC S9(0004) COMP.
  4935     05  CPFENTRF PIC  X(0001).
  4936     05  FILLER REDEFINES CPFENTRF.
  4937         10  CPFENTRA PIC  X(0001).
  4938     05  CPFENTRI PIC  9(2).
  4939*    -------------------------------
  4940     05  CPF5HDRL PIC S9(0004) COMP.
  4941     05  CPF5HDRF PIC  X(0001).
  4942     05  FILLER REDEFINES CPF5HDRF.
  4943         10  CPF5HDRA PIC  X(0001).
  4944     05  CPF5HDRI PIC  X(0005).
  4945*    -------------------------------
  4946     05  CPF4HDRL PIC S9(0004) COMP.
  4947     05  CPF4HDRF PIC  X(0001).
  4948     05  FILLER REDEFINES CPF4HDRF.
  4949         10  CPF4HDRA PIC  X(0001).
  4950     05  CPF4HDRI PIC  X(0013).
  4951*    -------------------------------
  4952     05  CF15HDRL PIC S9(0004) COMP.
  4953     05  CF15HDRF PIC  X(0001).
  4954     05  FILLER REDEFINES CF15HDRF.
  4955         10  CF15HDRA PIC  X(0001).
  4956     05  CF15HDRI PIC  X(0022).
  4957 01  EL631CO REDEFINES EL631BI.
  4958     05  FILLER            PIC  X(0012).
  4959*    -------------------------------
  4960     05  FILLER            PIC  X(0003).
  4961     05  CDATEO PIC  X(0008).
  4962*    -------------------------------
  4963     05  FILLER            PIC  X(0003).
  4964     05  CTIMEO PIC  99.99.
  4965*    -------------------------------
  4966     05  FILLER            PIC  X(0003).
  4967     05  CHEADO PIC  X(0038).
  4968*    -------------------------------
  4969     05  FILLER            PIC  X(0003).
  4970     05  CCHGTO PIC  X(0004).
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page  93
* EL6311.cbl
  4971*    -------------------------------
  4972     05  FILLER            PIC  X(0003).
  4973     05  CCHGO PIC  ZZZ9.
  4974*    -------------------------------
  4975     05  FILLER            PIC  X(0003).
  4976     05  CMAINTO PIC  X(0001).
  4977*    -------------------------------
  4978     05  FILLER            PIC  X(0003).
  4979     05  CMANTBYO PIC  X(0004).
  4980*    -------------------------------
  4981     05  FILLER            PIC  X(0003).
  4982     05  CCHGHDGO PIC  X(0003).
  4983*    -------------------------------
  4984     05  FILLER            PIC  X(0003).
  4985     05  CMANTDTO PIC  X(0008).
  4986*    -------------------------------
  4987     05  FILLER            PIC  X(0003).
  4988     05  CMANTATO PIC  99.99.
  4989*    -------------------------------
  4990     05  FILLER            PIC  X(0003).
  4991     05  CCSRO PIC  X(0004).
  4992*    -------------------------------
  4993     05  FILLER            PIC  X(0003).
  4994     05  CBATCHO PIC  X(0006).
  4995*    -------------------------------
  4996     05  FILLER            PIC  X(0003).
  4997     05  CSEQO PIC  X(0004).
  4998*    -------------------------------
  4999     05  FILLER            PIC  X(0003).
  5000     05  CMOENDTO PIC  X(0008).
  5001*    -------------------------------
  5002     05  FILLER            PIC  X(0003).
  5003     05  CCARRO PIC  X(0001).
  5004*    -------------------------------
  5005     05  FILLER            PIC  X(0003).
  5006     05  CGROUPO PIC  X(0006).
  5007*    -------------------------------
  5008     05  FILLER            PIC  X(0003).
  5009     05  CSTATEO PIC  X(0002).
  5010*    -------------------------------
  5011     05  FILLER            PIC  X(0003).
  5012     05  CACCTO PIC  X(0010).
  5013*    -------------------------------
  5014     05  FILLER            PIC  X(0003).
  5015     05  CORIGHDO PIC  X(0011).
  5016*    -------------------------------
  5017     05  FILLER            PIC  X(0003).
  5018     05  CORGNOO PIC  X(0006).
  5019*    -------------------------------
  5020     05  FILLER            PIC  X(0003).
  5021     05  CORGSEQO PIC  X(0004).
  5022*    -------------------------------
  5023     05  FILLER            PIC  X(0003).
  5024     05  CREFHDGO PIC  X(0010).
  5025*    -------------------------------
  5026     05  FILLER            PIC  X(0003).
  5027     05  CREFO PIC  X(0012).
  5028*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page  94
* EL6311.cbl
  5029     05  FILLER            PIC  X(0003).
  5030     05  CNHINTO PIC  ZZZZZ9.99.
  5031*    -------------------------------
  5032     05  FILLER            PIC  X(0003).
  5033     05  CCERTNOO PIC  X(0010).
  5034*    -------------------------------
  5035     05  FILLER            PIC  X(0003).
  5036     05  CSUFIXO PIC  X(0001).
  5037*    -------------------------------
  5038     05  FILLER            PIC  X(0003).
  5039     05  CEFFDTO PIC  X(0008).
  5040*    -------------------------------
  5041     05  FILLER            PIC  X(0003).
  5042     05  CLSTNMO PIC  X(0015).
  5043*    -------------------------------
  5044     05  FILLER            PIC  X(0003).
  5045     05  CINAMEO PIC  X(0015).
  5046*    -------------------------------
  5047     05  FILLER            PIC  X(0003).
  5048     05  CINITSO PIC  X(0010).
  5049*    -------------------------------
  5050     05  FILLER            PIC  X(0003).
  5051     05  CCANREAO PIC  X(0001).
  5052*    -------------------------------
  5053     05  FILLER            PIC  X(0003).
  5054     05  ACTSPCO PIC  X(0001).
  5055*    -------------------------------
  5056     05  FILLER            PIC  X(0003).
  5057     05  CKIND1O PIC  X(0002).
  5058*    -------------------------------
  5059     05  FILLER            PIC  X(0003).
  5060     05  CCANDT1O PIC  X(0008).
  5061*    -------------------------------
  5062     05  FILLER            PIC  X(0003).
  5063     05  CREFND1O PIC  Z(7).99-.
  5064*    -------------------------------
  5065     05  FILLER            PIC  X(0003).
  5066     05  CMTHD1O PIC  X(0001).
  5067*    -------------------------------
  5068     05  FILLER            PIC  X(0003).
  5069     05  CKIND2O PIC  X(0002).
  5070*    -------------------------------
  5071     05  FILLER            PIC  X(0003).
  5072     05  CCANDT2O PIC  X(0008).
  5073*    -------------------------------
  5074     05  FILLER            PIC  X(0003).
  5075     05  CREFND2O PIC  Z(7).99-.
  5076*    -------------------------------
  5077     05  FILLER            PIC  X(0003).
  5078     05  CMTHD2O PIC  X(0001).
  5079*    -------------------------------
  5080     05  FILLER            PIC  X(0003).
  5081     05  CLIVESO PIC  X(0003).
  5082*    -------------------------------
  5083     05  FILLER            PIC  X(0003).
  5084     05  CFORCEO PIC  X(0001).
  5085*    -------------------------------
  5086     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page  95
* EL6311.cbl
  5087     05  CBILCDO PIC  X(0001).
  5088*    -------------------------------
  5089     05  FILLER            PIC  X(0003).
  5090     05  CCRFND1O PIC  Z(7).99-.
  5091*    -------------------------------
  5092     05  FILLER            PIC  X(0003).
  5093     05  CCRFND2O PIC  Z(7).99-.
  5094*    -------------------------------
  5095     05  FILLER            PIC  X(0003).
  5096     05  CBILIT1O PIC  X(0008).
  5097*    -------------------------------
  5098     05  FILLER            PIC  X(0003).
  5099     05  CDRFND1O PIC  Z(7).99-.
  5100*    -------------------------------
  5101     05  FILLER            PIC  X(0003).
  5102     05  CBILIT2O PIC  X(0008).
  5103*    -------------------------------
  5104     05  FILLER            PIC  X(0003).
  5105     05  CDRFND2O PIC  Z(7).99-.
  5106*    -------------------------------
  5107     05  FILLER            PIC  X(0003).
  5108     05  CCANTXTO PIC  X(0005).
  5109*    -------------------------------
  5110     05  FILLER            PIC  X(0003).
  5111     05  CCANFEEO PIC  Z9.
  5112*    -------------------------------
  5113     05  FILLER            PIC  X(0003).
  5114     05  CTERM1O PIC  ZZ9.
  5115*    -------------------------------
  5116     05  FILLER            PIC  X(0003).
  5117     05  CRTERM1O PIC  ZZ9.
  5118*    -------------------------------
  5119     05  FILLER            PIC  X(0003).
  5120     05  CPREM1O PIC  ZZZZZZ9.99-.
  5121*    -------------------------------
  5122     05  FILLER            PIC  X(0003).
  5123     05  CTERM2O PIC  ZZ9.
  5124*    -------------------------------
  5125     05  FILLER            PIC  X(0003).
  5126     05  CRTERM2O PIC  ZZ9.
  5127*    -------------------------------
  5128     05  FILLER            PIC  X(0003).
  5129     05  CPREM2O PIC  ZZZZZZ9.99-.
  5130*    -------------------------------
  5131     05  FILLER            PIC  X(0003).
  5132     05  CENTRDTO PIC  X(0008).
  5133*    -------------------------------
  5134     05  FILLER            PIC  X(0003).
  5135     05  CPAYEEO PIC  X(0006).
  5136*    -------------------------------
  5137     05  FILLER            PIC  X(0003).
  5138     05  CRFNDSWO PIC  X(0003).
  5139*    -------------------------------
  5140     05  FILLER            PIC  X(0003).
  5141     05  CLFHDGO PIC  X(0006).
  5142*    -------------------------------
  5143     05  FILLER            PIC  X(0003).
  5144     05  CAHHDGO PIC  X(0006).
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page  96
* EL6311.cbl
  5145*    -------------------------------
  5146     05  FILLER            PIC  X(0003).
  5147     05  CENTDTO PIC  X(0008).
  5148*    -------------------------------
  5149     05  FILLER            PIC  X(0003).
  5150     05  CENTBYO PIC  X(0004).
  5151*    -------------------------------
  5152     05  FILLER            PIC  X(0003).
  5153     05  CCHGCNTO PIC  X(0003).
  5154*    -------------------------------
  5155     05  FILLER            PIC  X(0003).
  5156     05  CLFREFNO PIC  X(0006).
  5157*    -------------------------------
  5158     05  FILLER            PIC  X(0003).
  5159     05  CAHREFNO PIC  X(0006).
  5160*    -------------------------------
  5161     05  FILLER            PIC  X(0003).
  5162     05  CREINCDO PIC  X(0003).
  5163*    -------------------------------
  5164     05  FILLER            PIC  X(0003).
  5165     05  CAEFFDTO PIC  X(0008).
  5166*    -------------------------------
  5167     05  FILLER            PIC  X(0003).
  5168     05  CAEXPDTO PIC  X(0008).
  5169*    -------------------------------
  5170     05  FILLER            PIC  X(0003).
  5171     05  COMMLFO PIC  .99999.
  5172*    -------------------------------
  5173     05  FILLER            PIC  X(0003).
  5174     05  COMMAHO PIC  .99999.
  5175*    -------------------------------
  5176     05  FILLER            PIC  X(0003).
  5177     05  CERMSG1O PIC  X(0078).
  5178*    -------------------------------
  5179     05  FILLER            PIC  X(0003).
  5180     05  CERMSG2O PIC  X(0078).
  5181*    -------------------------------
  5182     05  FILLER            PIC  X(0003).
  5183     05  CERMSG3O PIC  X(0078).
  5184*    -------------------------------
  5185     05  FILLER            PIC  X(0003).
  5186     05  CPFENTRO PIC  X(0002).
  5187*    -------------------------------
  5188     05  FILLER            PIC  X(0003).
  5189     05  CPF5HDRO PIC  X(0005).
  5190*    -------------------------------
  5191     05  FILLER            PIC  X(0003).
  5192     05  CPF4HDRO PIC  X(0013).
  5193*    -------------------------------
  5194     05  FILLER            PIC  X(0003).
  5195     05  CF15HDRO PIC  X(0022).
  5196*    -------------------------------
  5197 01  EL631DI REDEFINES EL631BI.
  5198     05  FILLER            PIC  X(0012).
  5199*    -------------------------------
  5200     05  DDATEL PIC S9(0004) COMP.
  5201     05  DDATEF PIC  X(0001).
  5202     05  FILLER REDEFINES DDATEF.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page  97
* EL6311.cbl
  5203         10  DDATEA PIC  X(0001).
  5204     05  DDATEI PIC  X(0008).
  5205*    -------------------------------
  5206     05  DTIMEL PIC S9(0004) COMP.
  5207     05  DTIMEF PIC  X(0001).
  5208     05  FILLER REDEFINES DTIMEF.
  5209         10  DTIMEA PIC  X(0001).
  5210     05  DTIMEI PIC  X(0005).
  5211*    -------------------------------
  5212     05  DHEADL PIC S9(0004) COMP.
  5213     05  DHEADF PIC  X(0001).
  5214     05  FILLER REDEFINES DHEADF.
  5215         10  DHEADA PIC  X(0001).
  5216     05  DHEADI PIC  X(0038).
  5217*    -------------------------------
  5218     05  DLDATEL PIC S9(0004) COMP.
  5219     05  DLDATEF PIC  X(0001).
  5220     05  FILLER REDEFINES DLDATEF.
  5221         10  DLDATEA PIC  X(0001).
  5222     05  DLDATEI PIC  X(0010).
  5223*    -------------------------------
  5224     05  DBATCHL PIC S9(0004) COMP.
  5225     05  DBATCHF PIC  X(0001).
  5226     05  FILLER REDEFINES DBATCHF.
  5227         10  DBATCHA PIC  X(0001).
  5228     05  DBATCHI PIC  X(0011).
  5229*    -------------------------------
  5230     05  DACCTNML PIC S9(0004) COMP.
  5231     05  DACCTNMF PIC  X(0001).
  5232     05  FILLER REDEFINES DACCTNMF.
  5233         10  DACCTNMA PIC  X(0001).
  5234     05  DACCTNMI PIC  X(0030).
  5235*    -------------------------------
  5236     05  DPROCDTL PIC S9(0004) COMP.
  5237     05  DPROCDTF PIC  X(0001).
  5238     05  FILLER REDEFINES DPROCDTF.
  5239         10  DPROCDTA PIC  X(0001).
  5240     05  DPROCDTI PIC  X(0008).
  5241*    -------------------------------
  5242     05  DINPUTL PIC S9(0004) COMP.
  5243     05  DINPUTF PIC  X(0001).
  5244     05  FILLER REDEFINES DINPUTF.
  5245         10  DINPUTA PIC  X(0001).
  5246     05  DINPUTI PIC  X(0008).
  5247*    -------------------------------
  5248     05  DMAINDTL PIC S9(0004) COMP.
  5249     05  DMAINDTF PIC  X(0001).
  5250     05  FILLER REDEFINES DMAINDTF.
  5251         10  DMAINDTA PIC  X(0001).
  5252     05  DMAINDTI PIC  X(0008).
  5253*    -------------------------------
  5254     05  DCARRL PIC S9(0004) COMP.
  5255     05  DCARRF PIC  X(0001).
  5256     05  FILLER REDEFINES DCARRF.
  5257         10  DCARRA PIC  X(0001).
  5258     05  DCARRI PIC  X(0001).
  5259*    -------------------------------
  5260     05  DGROUPL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page  98
* EL6311.cbl
  5261     05  DGROUPF PIC  X(0001).
  5262     05  FILLER REDEFINES DGROUPF.
  5263         10  DGROUPA PIC  X(0001).
  5264     05  DGROUPI PIC  X(0006).
  5265*    -------------------------------
  5266     05  DSTATEL PIC S9(0004) COMP.
  5267     05  DSTATEF PIC  X(0001).
  5268     05  FILLER REDEFINES DSTATEF.
  5269         10  DSTATEA PIC  X(0001).
  5270     05  DSTATEI PIC  X(0002).
  5271*    -------------------------------
  5272     05  DACCTL PIC S9(0004) COMP.
  5273     05  DACCTF PIC  X(0001).
  5274     05  FILLER REDEFINES DACCTF.
  5275         10  DACCTA PIC  X(0001).
  5276     05  DACCTI PIC  X(0010).
  5277*    -------------------------------
  5278     05  DRECVDTL PIC S9(0004) COMP.
  5279     05  DRECVDTF PIC  X(0001).
  5280     05  FILLER REDEFINES DRECVDTF.
  5281         10  DRECVDTA PIC  X(0001).
  5282     05  DRECVDTI PIC  X(0008).
  5283*    -------------------------------
  5284     05  DCSRL PIC S9(0004) COMP.
  5285     05  DCSRF PIC  X(0001).
  5286     05  FILLER REDEFINES DCSRF.
  5287         10  DCSRA PIC  X(0001).
  5288     05  DCSRI PIC  X(0004).
  5289*    -------------------------------
  5290     05  DREFHDGL PIC S9(0004) COMP.
  5291     05  DREFHDGF PIC  X(0001).
  5292     05  FILLER REDEFINES DREFHDGF.
  5293         10  DREFHDGA PIC  X(0001).
  5294     05  DREFHDGI PIC  X(0010).
  5295*    -------------------------------
  5296     05  DREFL PIC S9(0004) COMP.
  5297     05  DREFF PIC  X(0001).
  5298     05  FILLER REDEFINES DREFF.
  5299         10  DREFA PIC  X(0001).
  5300     05  DREFI PIC  X(0012).
  5301*    -------------------------------
  5302     05  DLFPHDGL PIC S9(0004) COMP.
  5303     05  DLFPHDGF PIC  X(0001).
  5304     05  FILLER REDEFINES DLFPHDGF.
  5305         10  DLFPHDGA PIC  X(0001).
  5306     05  DLFPHDGI PIC  X(0010).
  5307*    -------------------------------
  5308     05  DAHPHDGL PIC S9(0004) COMP.
  5309     05  DAHPHDGF PIC  X(0001).
  5310     05  FILLER REDEFINES DAHPHDGF.
  5311         10  DAHPHDGA PIC  X(0001).
  5312     05  DAHPHDGI PIC  X(0010).
  5313*    -------------------------------
  5314     05  DLFRHDGL PIC S9(0004) COMP.
  5315     05  DLFRHDGF PIC  X(0001).
  5316     05  FILLER REDEFINES DLFRHDGF.
  5317         10  DLFRHDGA PIC  X(0001).
  5318     05  DLFRHDGI PIC  X(0009).
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page  99
* EL6311.cbl
  5319*    -------------------------------
  5320     05  DAHRHDGL PIC S9(0004) COMP.
  5321     05  DAHRHDGF PIC  X(0001).
  5322     05  FILLER REDEFINES DAHRHDGF.
  5323         10  DAHRHDGA PIC  X(0001).
  5324     05  DAHRHDGI PIC  X(0009).
  5325*    -------------------------------
  5326     05  DRISSL PIC S9(0004) COMP.
  5327     05  DRISSF PIC  X(0001).
  5328     05  FILLER REDEFINES DRISSF.
  5329         10  DRISSA PIC  X(0001).
  5330     05  DRISSI PIC  X(0005).
  5331*    -------------------------------
  5332     05  DRLFPRML PIC S9(0004) COMP.
  5333     05  DRLFPRMF PIC  X(0001).
  5334     05  FILLER REDEFINES DRLFPRMF.
  5335         10  DRLFPRMA PIC  X(0001).
  5336     05  DRLFPRMI PIC  S9(9)V99.
  5337*    -------------------------------
  5338     05  DRAHPRML PIC S9(0004) COMP.
  5339     05  DRAHPRMF PIC  X(0001).
  5340     05  FILLER REDEFINES DRAHPRMF.
  5341         10  DRAHPRMA PIC  X(0001).
  5342     05  DRAHPRMI PIC  S9(9)V99.
  5343*    -------------------------------
  5344     05  DRCANCL PIC S9(0004) COMP.
  5345     05  DRCANCF PIC  X(0001).
  5346     05  FILLER REDEFINES DRCANCF.
  5347         10  DRCANCA PIC  X(0001).
  5348     05  DRCANCI PIC  X(0005).
  5349*    -------------------------------
  5350     05  DRLFRFDL PIC S9(0004) COMP.
  5351     05  DRLFRFDF PIC  X(0001).
  5352     05  FILLER REDEFINES DRLFRFDF.
  5353         10  DRLFRFDA PIC  X(0001).
  5354     05  DRLFRFDI PIC  S9(9)V99.
  5355*    -------------------------------
  5356     05  DRAHRFDL PIC S9(0004) COMP.
  5357     05  DRAHRFDF PIC  X(0001).
  5358     05  FILLER REDEFINES DRAHRFDF.
  5359         10  DRAHRFDA PIC  X(0001).
  5360     05  DRAHRFDI PIC  S9(9)V99.
  5361*    -------------------------------
  5362     05  DEISSL PIC S9(0004) COMP.
  5363     05  DEISSF PIC  X(0001).
  5364     05  FILLER REDEFINES DEISSF.
  5365         10  DEISSA PIC  X(0001).
  5366     05  DEISSI PIC  X(0005).
  5367*    -------------------------------
  5368     05  DELFPRML PIC S9(0004) COMP.
  5369     05  DELFPRMF PIC  X(0001).
  5370     05  FILLER REDEFINES DELFPRMF.
  5371         10  DELFPRMA PIC  X(0001).
  5372     05  DELFPRMI PIC  X(0011).
  5373*    -------------------------------
  5374     05  DEAHPRML PIC S9(0004) COMP.
  5375     05  DEAHPRMF PIC  X(0001).
  5376     05  FILLER REDEFINES DEAHPRMF.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 100
* EL6311.cbl
  5377         10  DEAHPRMA PIC  X(0001).
  5378     05  DEAHPRMI PIC  X(0011).
  5379*    -------------------------------
  5380     05  DECANCL PIC S9(0004) COMP.
  5381     05  DECANCF PIC  X(0001).
  5382     05  FILLER REDEFINES DECANCF.
  5383         10  DECANCA PIC  X(0001).
  5384     05  DECANCI PIC  X(0005).
  5385*    -------------------------------
  5386     05  DELFRFDL PIC S9(0004) COMP.
  5387     05  DELFRFDF PIC  X(0001).
  5388     05  FILLER REDEFINES DELFRFDF.
  5389         10  DELFRFDA PIC  X(0001).
  5390     05  DELFRFDI PIC  X(0011).
  5391*    -------------------------------
  5392     05  DEAHRFDL PIC S9(0004) COMP.
  5393     05  DEAHRFDF PIC  X(0001).
  5394     05  FILLER REDEFINES DEAHRFDF.
  5395         10  DEAHRFDA PIC  X(0001).
  5396     05  DEAHRFDI PIC  X(0011).
  5397*    -------------------------------
  5398     05  DCISSL PIC S9(0004) COMP.
  5399     05  DCISSF PIC  X(0001).
  5400     05  FILLER REDEFINES DCISSF.
  5401         10  DCISSA PIC  X(0001).
  5402     05  DCISSI PIC  X(0005).
  5403*    -------------------------------
  5404     05  DCLFPRML PIC S9(0004) COMP.
  5405     05  DCLFPRMF PIC  X(0001).
  5406     05  FILLER REDEFINES DCLFPRMF.
  5407         10  DCLFPRMA PIC  X(0001).
  5408     05  DCLFPRMI PIC  X(0011).
  5409*    -------------------------------
  5410     05  DCAHPRML PIC S9(0004) COMP.
  5411     05  DCAHPRMF PIC  X(0001).
  5412     05  FILLER REDEFINES DCAHPRMF.
  5413         10  DCAHPRMA PIC  X(0001).
  5414     05  DCAHPRMI PIC  X(0011).
  5415*    -------------------------------
  5416     05  DCCANCL PIC S9(0004) COMP.
  5417     05  DCCANCF PIC  X(0001).
  5418     05  FILLER REDEFINES DCCANCF.
  5419         10  DCCANCA PIC  X(0001).
  5420     05  DCCANCI PIC  X(0005).
  5421*    -------------------------------
  5422     05  DCLFRFDL PIC S9(0004) COMP.
  5423     05  DCLFRFDF PIC  X(0001).
  5424     05  FILLER REDEFINES DCLFRFDF.
  5425         10  DCLFRFDA PIC  X(0001).
  5426     05  DCLFRFDI PIC  X(0011).
  5427*    -------------------------------
  5428     05  DCAHRFDL PIC S9(0004) COMP.
  5429     05  DCAHRFDF PIC  X(0001).
  5430     05  FILLER REDEFINES DCAHRFDF.
  5431         10  DCAHRFDA PIC  X(0001).
  5432     05  DCAHRFDI PIC  X(0011).
  5433*    -------------------------------
  5434     05  DOISSL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 101
* EL6311.cbl
  5435     05  DOISSF PIC  X(0001).
  5436     05  FILLER REDEFINES DOISSF.
  5437         10  DOISSA PIC  X(0001).
  5438     05  DOISSI PIC  X(0005).
  5439*    -------------------------------
  5440     05  DOLFPRML PIC S9(0004) COMP.
  5441     05  DOLFPRMF PIC  X(0001).
  5442     05  FILLER REDEFINES DOLFPRMF.
  5443         10  DOLFPRMA PIC  X(0001).
  5444     05  DOLFPRMI PIC  X(0011).
  5445*    -------------------------------
  5446     05  DOAHPRML PIC S9(0004) COMP.
  5447     05  DOAHPRMF PIC  X(0001).
  5448     05  FILLER REDEFINES DOAHPRMF.
  5449         10  DOAHPRMA PIC  X(0001).
  5450     05  DOAHPRMI PIC  X(0011).
  5451*    -------------------------------
  5452     05  DOCANCL PIC S9(0004) COMP.
  5453     05  DOCANCF PIC  X(0001).
  5454     05  FILLER REDEFINES DOCANCF.
  5455         10  DOCANCA PIC  X(0001).
  5456     05  DOCANCI PIC  X(0005).
  5457*    -------------------------------
  5458     05  DOLFRFDL PIC S9(0004) COMP.
  5459     05  DOLFRFDF PIC  X(0001).
  5460     05  FILLER REDEFINES DOLFRFDF.
  5461         10  DOLFRFDA PIC  X(0001).
  5462     05  DOLFRFDI PIC  X(0011).
  5463*    -------------------------------
  5464     05  DOAHRFDL PIC S9(0004) COMP.
  5465     05  DOAHRFDF PIC  X(0001).
  5466     05  FILLER REDEFINES DOAHRFDF.
  5467         10  DOAHRFDA PIC  X(0001).
  5468     05  DOAHRFDI PIC  X(0011).
  5469*    -------------------------------
  5470     05  DITOTALL PIC S9(0004) COMP.
  5471     05  DITOTALF PIC  X(0001).
  5472     05  FILLER REDEFINES DITOTALF.
  5473         10  DITOTALA PIC  X(0001).
  5474     05  DITOTALI PIC  X(0005).
  5475*    -------------------------------
  5476     05  DIFATALL PIC S9(0004) COMP.
  5477     05  DIFATALF PIC  X(0001).
  5478     05  FILLER REDEFINES DIFATALF.
  5479         10  DIFATALA PIC  X(0001).
  5480     05  DIFATALI PIC  X(0005).
  5481*    -------------------------------
  5482     05  DIFORCEL PIC S9(0004) COMP.
  5483     05  DIFORCEF PIC  X(0001).
  5484     05  FILLER REDEFINES DIFORCEF.
  5485         10  DIFORCEA PIC  X(0001).
  5486     05  DIFORCEI PIC  X(0005).
  5487*    -------------------------------
  5488     05  DIHOLDL PIC S9(0004) COMP.
  5489     05  DIHOLDF PIC  X(0001).
  5490     05  FILLER REDEFINES DIHOLDF.
  5491         10  DIHOLDA PIC  X(0001).
  5492     05  DIHOLDI PIC  X(0005).
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 102
* EL6311.cbl
  5493*    -------------------------------
  5494     05  DIAVAILL PIC S9(0004) COMP.
  5495     05  DIAVAILF PIC  X(0001).
  5496     05  FILLER REDEFINES DIAVAILF.
  5497         10  DIAVAILA PIC  X(0001).
  5498     05  DIAVAILI PIC  X(0005).
  5499*    -------------------------------
  5500     05  DIGPREML PIC S9(0004) COMP.
  5501     05  DIGPREMF PIC  X(0001).
  5502     05  FILLER REDEFINES DIGPREMF.
  5503         10  DIGPREMA PIC  X(0001).
  5504     05  DIGPREMI PIC  X(0011).
  5505*    -------------------------------
  5506     05  DIBPREML PIC S9(0004) COMP.
  5507     05  DIBPREMF PIC  X(0001).
  5508     05  FILLER REDEFINES DIBPREMF.
  5509         10  DIBPREMA PIC  X(0001).
  5510     05  DIBPREMI PIC  X(0011).
  5511*    -------------------------------
  5512     05  DCTOTALL PIC S9(0004) COMP.
  5513     05  DCTOTALF PIC  X(0001).
  5514     05  FILLER REDEFINES DCTOTALF.
  5515         10  DCTOTALA PIC  X(0001).
  5516     05  DCTOTALI PIC  X(0005).
  5517*    -------------------------------
  5518     05  DCFATALL PIC S9(0004) COMP.
  5519     05  DCFATALF PIC  X(0001).
  5520     05  FILLER REDEFINES DCFATALF.
  5521         10  DCFATALA PIC  X(0001).
  5522     05  DCFATALI PIC  X(0005).
  5523*    -------------------------------
  5524     05  DCFORCEL PIC S9(0004) COMP.
  5525     05  DCFORCEF PIC  X(0001).
  5526     05  FILLER REDEFINES DCFORCEF.
  5527         10  DCFORCEA PIC  X(0001).
  5528     05  DCFORCEI PIC  X(0005).
  5529*    -------------------------------
  5530     05  DCHOLDL PIC S9(0004) COMP.
  5531     05  DCHOLDF PIC  X(0001).
  5532     05  FILLER REDEFINES DCHOLDF.
  5533         10  DCHOLDA PIC  X(0001).
  5534     05  DCHOLDI PIC  X(0005).
  5535*    -------------------------------
  5536     05  DCAVAILL PIC S9(0004) COMP.
  5537     05  DCAVAILF PIC  X(0001).
  5538     05  FILLER REDEFINES DCAVAILF.
  5539         10  DCAVAILA PIC  X(0001).
  5540     05  DCAVAILI PIC  X(0005).
  5541*    -------------------------------
  5542     05  DCGPREML PIC S9(0004) COMP.
  5543     05  DCGPREMF PIC  X(0001).
  5544     05  FILLER REDEFINES DCGPREMF.
  5545         10  DCGPREMA PIC  X(0001).
  5546     05  DCGPREMI PIC  X(0011).
  5547*    -------------------------------
  5548     05  DCBPREML PIC S9(0004) COMP.
  5549     05  DCBPREMF PIC  X(0001).
  5550     05  FILLER REDEFINES DCBPREMF.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 103
* EL6311.cbl
  5551         10  DCBPREMA PIC  X(0001).
  5552     05  DCBPREMI PIC  X(0011).
  5553*    -------------------------------
  5554     05  DNTOTALL PIC S9(0004) COMP.
  5555     05  DNTOTALF PIC  X(0001).
  5556     05  FILLER REDEFINES DNTOTALF.
  5557         10  DNTOTALA PIC  X(0001).
  5558     05  DNTOTALI PIC  X(0005).
  5559*    -------------------------------
  5560     05  DNFATALL PIC S9(0004) COMP.
  5561     05  DNFATALF PIC  X(0001).
  5562     05  FILLER REDEFINES DNFATALF.
  5563         10  DNFATALA PIC  X(0001).
  5564     05  DNFATALI PIC  X(0005).
  5565*    -------------------------------
  5566     05  DNFORCEL PIC S9(0004) COMP.
  5567     05  DNFORCEF PIC  X(0001).
  5568     05  FILLER REDEFINES DNFORCEF.
  5569         10  DNFORCEA PIC  X(0001).
  5570     05  DNFORCEI PIC  X(0005).
  5571*    -------------------------------
  5572     05  DNHOLDL PIC S9(0004) COMP.
  5573     05  DNHOLDF PIC  X(0001).
  5574     05  FILLER REDEFINES DNHOLDF.
  5575         10  DNHOLDA PIC  X(0001).
  5576     05  DNHOLDI PIC  X(0005).
  5577*    -------------------------------
  5578     05  DNAVAILL PIC S9(0004) COMP.
  5579     05  DNAVAILF PIC  X(0001).
  5580     05  FILLER REDEFINES DNAVAILF.
  5581         10  DNAVAILA PIC  X(0001).
  5582     05  DNAVAILI PIC  X(0005).
  5583*    -------------------------------
  5584     05  DNGPREML PIC S9(0004) COMP.
  5585     05  DNGPREMF PIC  X(0001).
  5586     05  FILLER REDEFINES DNGPREMF.
  5587         10  DNGPREMA PIC  X(0001).
  5588     05  DNGPREMI PIC  X(0011).
  5589*    -------------------------------
  5590     05  DNBPREML PIC S9(0004) COMP.
  5591     05  DNBPREMF PIC  X(0001).
  5592     05  FILLER REDEFINES DNBPREMF.
  5593         10  DNBPREMA PIC  X(0001).
  5594     05  DNBPREMI PIC  X(0011).
  5595*    -------------------------------
  5596     05  DERMSGL PIC S9(0004) COMP.
  5597     05  DERMSGF PIC  X(0001).
  5598     05  FILLER REDEFINES DERMSGF.
  5599         10  DERMSGA PIC  X(0001).
  5600     05  DERMSGI PIC  X(0075).
  5601*    -------------------------------
  5602     05  DPFENTRL PIC S9(0004) COMP.
  5603     05  DPFENTRF PIC  X(0001).
  5604     05  FILLER REDEFINES DPFENTRF.
  5605         10  DPFENTRA PIC  X(0001).
  5606     05  DPFENTRI PIC  9(2).
  5607 01  EL631DO REDEFINES EL631BI.
  5608     05  FILLER            PIC  X(0012).
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 104
* EL6311.cbl
  5609*    -------------------------------
  5610     05  FILLER            PIC  X(0003).
  5611     05  DDATEO PIC  X(0008).
  5612*    -------------------------------
  5613     05  FILLER            PIC  X(0003).
  5614     05  DTIMEO PIC  99.99.
  5615*    -------------------------------
  5616     05  FILLER            PIC  X(0003).
  5617     05  DHEADO PIC  X(0038).
  5618*    -------------------------------
  5619     05  FILLER            PIC  X(0003).
  5620     05  DLDATEO PIC  X(0010).
  5621*    -------------------------------
  5622     05  FILLER            PIC  X(0003).
  5623     05  DBATCHO PIC  X(0011).
  5624*    -------------------------------
  5625     05  FILLER            PIC  X(0003).
  5626     05  DACCTNMO PIC  X(0030).
  5627*    -------------------------------
  5628     05  FILLER            PIC  X(0003).
  5629     05  DPROCDTO PIC  X(0008).
  5630*    -------------------------------
  5631     05  FILLER            PIC  X(0003).
  5632     05  DINPUTO PIC  X(0008).
  5633*    -------------------------------
  5634     05  FILLER            PIC  X(0003).
  5635     05  DMAINDTO PIC  X(0008).
  5636*    -------------------------------
  5637     05  FILLER            PIC  X(0003).
  5638     05  DCARRO PIC  X(0001).
  5639*    -------------------------------
  5640     05  FILLER            PIC  X(0003).
  5641     05  DGROUPO PIC  X(0006).
  5642*    -------------------------------
  5643     05  FILLER            PIC  X(0003).
  5644     05  DSTATEO PIC  X(0002).
  5645*    -------------------------------
  5646     05  FILLER            PIC  X(0003).
  5647     05  DACCTO PIC  X(0010).
  5648*    -------------------------------
  5649     05  FILLER            PIC  X(0003).
  5650     05  DRECVDTO PIC  X(0008).
  5651*    -------------------------------
  5652     05  FILLER            PIC  X(0003).
  5653     05  DCSRO PIC  X(0004).
  5654*    -------------------------------
  5655     05  FILLER            PIC  X(0003).
  5656     05  DREFHDGO PIC  X(0010).
  5657*    -------------------------------
  5658     05  FILLER            PIC  X(0003).
  5659     05  DREFO PIC  X(0012).
  5660*    -------------------------------
  5661     05  FILLER            PIC  X(0003).
  5662     05  DLFPHDGO PIC  X(0010).
  5663*    -------------------------------
  5664     05  FILLER            PIC  X(0003).
  5665     05  DAHPHDGO PIC  X(0010).
  5666*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 105
* EL6311.cbl
  5667     05  FILLER            PIC  X(0003).
  5668     05  DLFRHDGO PIC  X(0009).
  5669*    -------------------------------
  5670     05  FILLER            PIC  X(0003).
  5671     05  DAHRHDGO PIC  X(0009).
  5672*    -------------------------------
  5673     05  FILLER            PIC  X(0003).
  5674     05  DRISSO PIC  ZZ99-.
  5675*    -------------------------------
  5676     05  FILLER            PIC  X(0003).
  5677     05  DRLFPRMO PIC  ZZZZZZ9.99-.
  5678*    -------------------------------
  5679     05  FILLER            PIC  X(0003).
  5680     05  DRAHPRMO PIC  ZZZZZZ9.99-.
  5681*    -------------------------------
  5682     05  FILLER            PIC  X(0003).
  5683     05  DRCANCO PIC  ZZ99-.
  5684*    -------------------------------
  5685     05  FILLER            PIC  X(0003).
  5686     05  DRLFRFDO PIC  ZZZZZZ9.99-.
  5687*    -------------------------------
  5688     05  FILLER            PIC  X(0003).
  5689     05  DRAHRFDO PIC  ZZZZZZ9.99-.
  5690*    -------------------------------
  5691     05  FILLER            PIC  X(0003).
  5692     05  DEISSO PIC  ZZ99-.
  5693*    -------------------------------
  5694     05  FILLER            PIC  X(0003).
  5695     05  DELFPRMO PIC  ZZZZZZ9.99-.
  5696*    -------------------------------
  5697     05  FILLER            PIC  X(0003).
  5698     05  DEAHPRMO PIC  ZZZZZZ9.99-.
  5699*    -------------------------------
  5700     05  FILLER            PIC  X(0003).
  5701     05  DECANCO PIC  ZZ99-.
  5702*    -------------------------------
  5703     05  FILLER            PIC  X(0003).
  5704     05  DELFRFDO PIC  ZZZZZZ9.99-.
  5705*    -------------------------------
  5706     05  FILLER            PIC  X(0003).
  5707     05  DEAHRFDO PIC  ZZZZZZ9.99-.
  5708*    -------------------------------
  5709     05  FILLER            PIC  X(0003).
  5710     05  DCISSO PIC  ZZ99-.
  5711*    -------------------------------
  5712     05  FILLER            PIC  X(0003).
  5713     05  DCLFPRMO PIC  ZZZZZZ9.99-.
  5714*    -------------------------------
  5715     05  FILLER            PIC  X(0003).
  5716     05  DCAHPRMO PIC  ZZZZZZ9.99-.
  5717*    -------------------------------
  5718     05  FILLER            PIC  X(0003).
  5719     05  DCCANCO PIC  ZZ99-.
  5720*    -------------------------------
  5721     05  FILLER            PIC  X(0003).
  5722     05  DCLFRFDO PIC  ZZZZZZ9.99-.
  5723*    -------------------------------
  5724     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 106
* EL6311.cbl
  5725     05  DCAHRFDO PIC  ZZZZZZ9.99-.
  5726*    -------------------------------
  5727     05  FILLER            PIC  X(0003).
  5728     05  DOISSO PIC  ZZ99-.
  5729*    -------------------------------
  5730     05  FILLER            PIC  X(0003).
  5731     05  DOLFPRMO PIC  ZZZZZZ9.99-.
  5732*    -------------------------------
  5733     05  FILLER            PIC  X(0003).
  5734     05  DOAHPRMO PIC  ZZZZZZ9.99-.
  5735*    -------------------------------
  5736     05  FILLER            PIC  X(0003).
  5737     05  DOCANCO PIC  ZZ99-.
  5738*    -------------------------------
  5739     05  FILLER            PIC  X(0003).
  5740     05  DOLFRFDO PIC  ZZZZZZ9.99-.
  5741*    -------------------------------
  5742     05  FILLER            PIC  X(0003).
  5743     05  DOAHRFDO PIC  ZZZZZZ9.99-.
  5744*    -------------------------------
  5745     05  FILLER            PIC  X(0003).
  5746     05  DITOTALO PIC  ZZZ99.
  5747*    -------------------------------
  5748     05  FILLER            PIC  X(0003).
  5749     05  DIFATALO PIC  ZZZ99.
  5750*    -------------------------------
  5751     05  FILLER            PIC  X(0003).
  5752     05  DIFORCEO PIC  ZZZ99.
  5753*    -------------------------------
  5754     05  FILLER            PIC  X(0003).
  5755     05  DIHOLDO PIC  ZZZ99.
  5756*    -------------------------------
  5757     05  FILLER            PIC  X(0003).
  5758     05  DIAVAILO PIC  ZZZ99.
  5759*    -------------------------------
  5760     05  FILLER            PIC  X(0003).
  5761     05  DIGPREMO PIC  ZZZZZZZ9.99.
  5762*    -------------------------------
  5763     05  FILLER            PIC  X(0003).
  5764     05  DIBPREMO PIC  ZZZZZZZ9.99.
  5765*    -------------------------------
  5766     05  FILLER            PIC  X(0003).
  5767     05  DCTOTALO PIC  ZZZ99.
  5768*    -------------------------------
  5769     05  FILLER            PIC  X(0003).
  5770     05  DCFATALO PIC  ZZZ99.
  5771*    -------------------------------
  5772     05  FILLER            PIC  X(0003).
  5773     05  DCFORCEO PIC  ZZZ99.
  5774*    -------------------------------
  5775     05  FILLER            PIC  X(0003).
  5776     05  DCHOLDO PIC  ZZZ99.
  5777*    -------------------------------
  5778     05  FILLER            PIC  X(0003).
  5779     05  DCAVAILO PIC  ZZZ99.
  5780*    -------------------------------
  5781     05  FILLER            PIC  X(0003).
  5782     05  DCGPREMO PIC  ZZZZZZZ9.99.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 107
* EL6311.cbl
  5783*    -------------------------------
  5784     05  FILLER            PIC  X(0003).
  5785     05  DCBPREMO PIC  ZZZZZZZ9.99.
  5786*    -------------------------------
  5787     05  FILLER            PIC  X(0003).
  5788     05  DNTOTALO PIC  ---99.
  5789*    -------------------------------
  5790     05  FILLER            PIC  X(0003).
  5791     05  DNFATALO PIC  ---99.
  5792*    -------------------------------
  5793     05  FILLER            PIC  X(0003).
  5794     05  DNFORCEO PIC  ---99.
  5795*    -------------------------------
  5796     05  FILLER            PIC  X(0003).
  5797     05  DNHOLDO PIC  ---99.
  5798*    -------------------------------
  5799     05  FILLER            PIC  X(0003).
  5800     05  DNAVAILO PIC  ---99.
  5801*    -------------------------------
  5802     05  FILLER            PIC  X(0003).
  5803     05  DNGPREMO PIC  -------9.99.
  5804*    -------------------------------
  5805     05  FILLER            PIC  X(0003).
  5806     05  DNBPREMO PIC  -------9.99.
  5807*    -------------------------------
  5808     05  FILLER            PIC  X(0003).
  5809     05  DERMSGO PIC  X(0075).
  5810*    -------------------------------
  5811     05  FILLER            PIC  X(0003).
  5812     05  DPFENTRO PIC  X(0002).
  5813*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 108
* EL6311.cbl
  5815 01  MAP-B REDEFINES EL631BI.
  5816     12  FILLER                  PIC X(595).
  5817*    12  FILLER                  PIC X(591).
  5818*    12  FILLER                  PIC X(512).
  5819*    12  FILLER                  PIC X(510).
  5820     12  MAP-B-COVERAGE OCCURS 2 TIMES.
  5821         16  BKIND-LEN               PIC S9(4)  COMP.
  5822         16  BKIND-ATTRB             PIC X.
  5823         16  BKIND                   PIC XX.
  5824         16  BTYPE-LEN               PIC S9(4)  COMP.
  5825         16  BTYPE-ATTRB             PIC X.
  5826         16  BTYPE                   PIC X(3).
  5827         16  BTERM-LEN               PIC S9(4)  COMP.
  5828         16  BTERM-ATTRB             PIC X.
  5829         16  BTERMI                  PIC 999.
  5830         16  BTERMO REDEFINES BTERMI PIC ZZZ.
  5831         16  BBEN-LEN                PIC S9(4)  COMP.
  5832         16  BBEN-ATTRB              PIC X.
  5833         16  BBENI                   PIC 9(10)V99.
  5834*        16  BBENI                   PIC 9(12).
  5835         16  BBENO REDEFINES BBENI   PIC Z(9).99.
  5836         16  BPREM-LEN               PIC S9(4)  COMP.
  5837         16  BPREM-ATTRB             PIC X.
  5838         16  BPREMI                  PIC S9(9)V99.
  5839*        16  BPREMI                  PIC 9(11).
  5840         16  BPREMO REDEFINES BPREMI PIC Z(7).99-.
  5841         16  BPREM-ALPHA REDEFINES BPREMI PIC X(11).
  5842         16  BEXPIRE-LEN             PIC S9(4)  COMP.
  5843         16  BEXPIRE-ATTRB           PIC X.
  5844         16  BEXPIRE                 PIC X(8).
  5845         16  BCRIT-PERD-LEN          PIC S9(4)  COMP.
  5846         16  BCRIT-PERD-ATTRB        PIC X.
  5847         16  BCRIT-PERDI             PIC 99.
  5848         16  BCRIT-PERDO REDEFINES
  5849                         BCRIT-PERDI PIC ZZ.
  5850         16  BALT-BEN-LEN            PIC S9(4)  COMP.
  5851         16  BALT-BEN-ATTRB          PIC X.
  5852         16  BALT-BENI               PIC 9(10)V99.
  5853*        16  BALT-BENI               PIC 9(12).
  5854         16  BALT-BENO REDEFINES
  5855                           BALT-BENI PIC Z(9).ZZ.
  5856         16  BALT-PREM-LEN           PIC S9(4)  COMP.
  5857         16  BALT-PREM-ATTRB         PIC X.
  5858         16  BALT-PREMI              PIC 9(9)V99.
  5859*        16  BALT-PREMI              PIC 9(11).
  5860         16  BALT-PREMO REDEFINES
  5861                          BALT-PREMI PIC Z(7).ZZ-.
  5862         16  BBEN-CD-LEN             PIC S9(4)  COMP.
  5863         16  BBEN-CD-ATTRB           PIC X.
  5864         16  BBEN-CD                 PIC XXX.
  5865         16  BCPREM-LEN              PIC S9(4)  COMP.
  5866         16  BCPREM-ATTRB            PIC X.
  5867         16  BCPREMI                 PIC S9(9)V99.
  5868*        16  BCPREMI                 PIC X(11).
  5869         16  BCPREMO REDEFINES BCPREMI
  5870                                     PIC Z(7).99-.
  5871         16  BCALT-PREM-LEN          PIC S9(4)  COMP.
  5872         16  BCALT-PREM-ATTRB        PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 109
* EL6311.cbl
  5873         16  BCALT-PREM              PIC Z(7).99-.
  5874         16  BBEN-ABBR-LEN           PIC S9(4)  COMP.
  5875         16  BBEN-ABBR-ATTRB         PIC X.
  5876         16  BBEN-ABBR               PIC X(5).
  5877         16  BDIFF-LEN               PIC S9(4)  COMP.
  5878         16  BDIFF-ATTRB             PIC X.
  5879         16  BDIFFO                  PIC Z(7).99-.
  5880         16  BBILL-LIT-LEN           PIC S9(4)  COMP.
  5881         16  BBILL-LIT-ATTRB         PIC X.
  5882         16  BBILL-LIT               PIC X(8).
  5883         16  BDALT-PREM-LEN          PIC S9(4)  COMP.
  5884         16  BDALT-PREM-ATTRB        PIC X.
  5885         16  BDALT-PREM              PIC Z(7).99-.
  5886
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 110
* EL6311.cbl
  5888
  5889****************************************************************
  5890*
  5891* Copyright (c) 2007-2013 Dell Inc.
  5892* All rights reserved.
  5893*
  5894****************************************************************
  5895 01  DFHEIV.
  5896   02  DFHEIV0               PIC X(35).
  5897   02  DFHEIV1               PIC X(08).
  5898   02  DFHEIV2               PIC X(08).
  5899   02  DFHEIV3               PIC X(08).
  5900   02  DFHEIV4               PIC X(06).
  5901   02  DFHEIV5               PIC X(04).
  5902   02  DFHEIV6               PIC X(04).
  5903   02  DFHEIV7               PIC X(02).
  5904   02  DFHEIV8               PIC X(02).
  5905   02  DFHEIV9               PIC X(01).
  5906   02  DFHEIV10              PIC S9(7) COMP-3.
  5907   02  DFHEIV11              PIC S9(4) COMP SYNC.
  5908   02  DFHEIV12              PIC S9(4) COMP SYNC.
  5909   02  DFHEIV13              PIC S9(4) COMP SYNC.
  5910   02  DFHEIV14              PIC S9(4) COMP SYNC.
  5911   02  DFHEIV15              PIC S9(4) COMP SYNC.
  5912   02  DFHEIV16              PIC S9(9) COMP SYNC.
  5913   02  DFHEIV17              PIC X(04).
  5914   02  DFHEIV18              PIC X(04).
  5915   02  DFHEIV19              PIC X(04).
  5916   02  DFHEIV20              USAGE IS POINTER.
  5917   02  DFHEIV21              USAGE IS POINTER.
  5918   02  DFHEIV22              USAGE IS POINTER.
  5919   02  DFHEIV23              USAGE IS POINTER.
  5920   02  DFHEIV24              USAGE IS POINTER.
  5921   02  DFHEIV25              PIC S9(9) COMP SYNC.
  5922   02  DFHEIV26              PIC S9(9) COMP SYNC.
  5923   02  DFHEIV27              PIC S9(9) COMP SYNC.
  5924   02  DFHEIV28              PIC S9(9) COMP SYNC.
  5925   02  DFHEIV29              PIC S9(9) COMP SYNC.
  5926   02  DFHEIV30              PIC S9(9) COMP SYNC.
  5927   02  DFHEIV31              PIC S9(9) COMP SYNC.
  5928   02  DFHEIV32              PIC S9(4) COMP SYNC.
  5929   02  DFHEIV33              PIC S9(4) COMP SYNC.
  5930   02  DFHEIV34              PIC S9(4) COMP SYNC.
  5931   02  DFHEIV35              PIC S9(4) COMP SYNC.
  5932   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  5933   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  5934   02  FILLER                PIC X(02).
  5935   02  DFHEIV99              PIC X(08) VALUE SPACE.
  5936   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  5937   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  5938   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  5939   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  5940   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  5941   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  5942 LINKAGE  SECTION.
  5943*****************************************************************
  5944*                                                               *
  5945* Copyright (c) 2007-2013 Dell Inc.                             *
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 111
* EL6311.cbl
  5946* All rights reserved.                                          *
  5947*                                                               *
  5948*****************************************************************
  5949 01  dfheiblk.
  5950     02  eibtime          pic s9(7) comp-3.
  5951     02  eibdate          pic s9(7) comp-3.
  5952     02  eibtrnid         pic x(4).
  5953     02  eibtaskn         pic s9(7) comp-3.
  5954     02  eibtrmid         pic x(4).
  5955     02  dfheigdi         pic s9(4) comp.
  5956     02  eibcposn         pic s9(4) comp.
  5957     02  eibcalen         pic s9(4) comp.
  5958     02  eibaid           pic x(1).
  5959     02  eibfiller1       pic x(1).
  5960     02  eibfn            pic x(2).
  5961     02  eibfiller2       pic x(2).
  5962     02  eibrcode         pic x(6).
  5963     02  eibfiller3       pic x(2).
  5964     02  eibds            pic x(8).
  5965     02  eibreqid         pic x(8).
  5966     02  eibrsrce         pic x(8).
  5967     02  eibsync          pic x(1).
  5968     02  eibfree          pic x(1).
  5969     02  eibrecv          pic x(1).
  5970     02  eibsend          pic x(1).
  5971     02  eibatt           pic x(1).
  5972     02  eibeoc           pic x(1).
  5973     02  eibfmh           pic x(1).
  5974     02  eibcompl         pic x(1).
  5975     02  eibsig           pic x(1).
  5976     02  eibconf          pic x(1).
  5977     02  eiberr           pic x(1).
  5978     02  eibrldbk         pic x(1).
  5979     02  eiberrcd         pic x(4).
  5980     02  eibsynrb         pic x(1).
  5981     02  eibnodat         pic x(1).
  5982     02  eibfiller5       pic x(2).
  5983     02  eibresp          pic s9(8) comp.
  5984     02  eibresp2         pic s9(8) comp.
  5985     02  dfheigdj         pic s9(4) comp.
  5986     02  dfheigdk         pic s9(4) comp.
  5987 01  DFHCOMMAREA                 PIC X(1300).
  5988*                                COPY ERCPNDB.
  5989******************************************************************
  5990*                                                                *
  5991*                                                                *
  5992*                            ERCPNDB.                            *
  5993*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5994*                            VMOD=2.025                          *
  5995*                                                                *
  5996*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  5997*                                                                *
  5998******************************************************************
  5999*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  6000*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  6001******************************************************************
  6002*                                                                *
  6003*                                                                *
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 112
* EL6311.cbl
  6004*   FILE TYPE = VSAM,KSDS                                        *
  6005*   RECORD SIZE = 585  RECFORM = FIXED                           *
  6006*                                                                *
  6007*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  6008*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  6009*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  6010*                                                 RKP=13,LEN=36  *
  6011*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  6012*                                      AND CHG-SEQ.)             *
  6013*                                                RKP=49,LEN=11   *
  6014*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  6015*                                      AND CHG-SEQ.)             *
  6016*                                                RKP=60,LEN=15   *
  6017*                                                                *
  6018*   LOG = NO                                                     *
  6019*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6020******************************************************************
  6021******************************************************************
  6022*                   C H A N G E   L O G
  6023*
  6024* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6025*-----------------------------------------------------------------
  6026*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6027* EFFECTIVE    NUMBER
  6028*-----------------------------------------------------------------
  6029* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  6030* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  6031* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  6032* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  6033* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  6034* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  6035* 032306                   PEMA  ADD BOW LOAN NUMBER
  6036* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  6037* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  6038* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  6039* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  6040* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  6041* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  6042* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6043* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  6044* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
  6045* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  6046* 010517  CR2016021600005  PEMA ADD NEW FORCE CODE FOR AGG
  6047* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
  6048* 012220  CR2018092700002  TANA ADD LETTER REQUIRED FIELD
  6049******************************************************************
  6050
  6051 01  PENDING-BUSINESS.
  6052     12  PB-RECORD-ID                     PIC XX.
  6053         88  VALID-PB-ID                        VALUE 'PB'.
  6054
  6055     12  PB-CONTROL-PRIMARY.
  6056         16  PB-COMPANY-CD                PIC X.
  6057         16  PB-ENTRY-BATCH               PIC X(6).
  6058         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  6059         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  6060
  6061     12  PB-CONTROL-BY-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 113
* EL6311.cbl
  6062         16  PB-COMPANY-CD-A1             PIC X.
  6063         16  PB-CARRIER                   PIC X.
  6064         16  PB-GROUPING.
  6065             20  PB-GROUPING-PREFIX       PIC XXX.
  6066             20  PB-GROUPING-PRIME        PIC XXX.
  6067         16  PB-STATE                     PIC XX.
  6068         16  PB-ACCOUNT.
  6069             20  PB-ACCOUNT-PREFIX        PIC X(4).
  6070             20  PB-ACCOUNT-PRIME         PIC X(6).
  6071         16  PB-CERT-EFF-DT               PIC XX.
  6072         16  PB-CERT-NO.
  6073             20  PB-CERT-PRIME            PIC X(10).
  6074             20  PB-CERT-SFX              PIC X.
  6075         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  6076
  6077         16  PB-RECORD-TYPE               PIC X.
  6078             88  PB-MAILING-DATA                VALUE '0'.
  6079             88  PB-ISSUE                       VALUE '1'.
  6080             88  PB-CANCELLATION                VALUE '2'.
  6081             88  PB-BATCH-TRAILER               VALUE '9'.
  6082
  6083     12  PB-CONTROL-BY-ORIG-BATCH.
  6084         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  6085         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  6086         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  6087         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  6088
  6089     12  PB-CONTROL-BY-CSR.
  6090         16  PB-CSR-COMPANY-CD            PIC X.
  6091         16  PB-CSR-ID                    PIC X(4).
  6092         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  6093         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  6094         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  6095******************************************************************
  6096*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  6097******************************************************************
  6098
  6099     12  PB-LAST-MAINT-DT                 PIC XX.
  6100     12  PB-LAST-MAINT-BY                 PIC X(4).
  6101     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  6102
  6103     12  PB-RECORD-BODY                   PIC X(375).
  6104
  6105     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  6106         16  PB-CERT-ORIGIN               PIC X.
  6107             88  CLASIC-CREATED-CERT         VALUE '1'.
  6108         16  PB-I-NAME.
  6109             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  6110             20  PB-I-INSURED-FIRST-NAME.
  6111                 24  PB-I-INSURED-1ST-INIT PIC X.
  6112                 24  FILLER                PIC X(9).
  6113             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  6114         16  PB-I-AGE                     PIC S99   COMP-3.
  6115         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  6116         16  PB-I-BIRTHDAY                PIC XX.
  6117         16  PB-I-INSURED-SEX             PIC X.
  6118             88  PB-SEX-MALE     VALUE 'M'.
  6119             88  PB-SEX-FEMALE   VALUE 'F'.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 114
* EL6311.cbl
  6120
  6121         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  6122         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  6123         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  6124         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  6125         16  PB-I-SKIP-CODE               PIC X.
  6126             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  6127             88  PB-SKIP-JULY              VALUE '1'.
  6128             88  PB-SKIP-AUGUST            VALUE '2'.
  6129             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  6130             88  PB-SKIP-JULY-AUG          VALUE '4'.
  6131             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  6132             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  6133             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  6134             88  PB-SKIP-JUNE              VALUE '8'.
  6135             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  6136             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  6137             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  6138         16  PB-I-TERM-TYPE               PIC X.
  6139             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  6140             88  PB-PAID-WEEKLY            VALUE 'W'.
  6141             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  6142             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  6143             88  PB-PAID-13-YEARLY         VALUE 'T'.
  6144         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  6145         16  PB-I-POLICY-FORM-NO          PIC X(12).
  6146         16  PB-I-DATA-ENTRY-SW           PIC X.
  6147             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  6148             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  6149             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  6150             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  6151         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  6152         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  6153*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  6154         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  6155         16  PB-I-LETTER-REQD             PIC X.
  6156
  6157         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  6158             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  6159             88  PB-INVALID-LIFE             VALUE '  ' '00'
  6160                                                   '90' THRU '99'.
  6161         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  6162                                          PIC XX.
  6163         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  6164         16  PB-I-AMOUNT-FINANCED REDEFINES
  6165                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  6166         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  6167         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  6168                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  6169         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  6170         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  6171         16  PB-I-CLP-AMOUNT REDEFINES
  6172                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  6173         16  PB-I-LF-CALC-FLAG            PIC X.
  6174             88 PB-COMP-LF-PREM               VALUE '?'.
  6175         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  6176         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  6177         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 115
* EL6311.cbl
  6178         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  6179         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  6180         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  6181         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  6182         16  PB-I-LF-ABBR                 PIC XXX.
  6183         16  PB-I-LF-INPUT-CD             PIC XX.
  6184
  6185         16  PB-I-AH-BENEFIT-CD           PIC XX.
  6186             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  6187             88  PB-INVALID-AH               VALUE '  ' '00'
  6188                                                   '90' THRU '99'.
  6189         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  6190         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  6191         16  PB-I-AH-CALC-FLAG            PIC X.
  6192             88 PB-COMP-AH-PREM                  VALUE '?'.
  6193         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  6194         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  6195         16  PB-I-CANCEL-FEE              PIC S9(3)V99   COMP-3.
  6196         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  6197         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  6198         16  PB-I-AH-ABBR                 PIC XXX.
  6199         16  PB-I-AH-INPUT-CD             PIC XXX.
  6200
  6201         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  6202         16  PB-I-REIN-TABLE              PIC XXX.
  6203         16  PB-I-BUSINESS-TYPE           PIC 99.
  6204         16  PB-I-INDV-GRP-CD             PIC X.
  6205         16  PB-I-MORT-CODE.
  6206             20  PB-I-TABLE               PIC X.
  6207             20  PB-I-INTEREST            PIC XX.
  6208             20  PB-I-MORT-TYP            PIC X.
  6209         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  6210         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  6211         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  6212         16  PB-I-INDV-GRP-OVRD           PIC X.
  6213         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  6214         16  PB-I-SIG-SW                  PIC X.
  6215             88  PB-POLICY-SIGNED             VALUE 'Y'.
  6216         16  PB-I-RATE-CLASS              PIC XX.
  6217         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  6218         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  6219         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  6220         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  6221         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  6222         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  6223         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  6224         16  PB-I-BENEFIT-TYPE            PIC XXX.
  6225         16  PB-I-OB-FLAG                 PIC X.
  6226             88  PB-I-OB                      VALUE 'B'.
  6227             88  PB-I-SUMMARY                 VALUE 'Z'.
  6228         16  PB-I-ENTRY-STATUS            PIC X.
  6229             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  6230                                              'M' '5' '9' '2'.
  6231             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  6232             88  PB-I-POLICY-PENDING          VALUE '2'.
  6233             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  6234             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  6235             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 116
* EL6311.cbl
  6236             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  6237             88  PB-I-REIN-ONLY               VALUE '9'.
  6238             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  6239             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  6240             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  6241             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  6242         16  PB-I-INT-CODE                PIC X.
  6243             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  6244             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  6245         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  6246         16  PB-I-SOC-SEC-NO              PIC X(11).
  6247         16  PB-I-MEMBER-NO               PIC X(12).
  6248         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  6249*        16  PB-I-LOAN-OFFICER            PIC XXX.
  6250         16  PB-I-OLD-LOF                 PIC XXX.
  6251         16  PB-I-LF-EXPIRE-DT            PIC XX.
  6252         16  PB-I-AH-EXPIRE-DT            PIC XX.
  6253         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  6254         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  6255         16  PB-I-LIFE-INDICATOR          PIC X.
  6256             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  6257         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  6258         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  6259                                          PIC S9(5)V99    COMP-3.
  6260         16  PB-I-MAIL-ADDRS-SW           PIC X.
  6261             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  6262             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  6263         16  PB-I-1ST-PMT-DT              PIC XX.
  6264         16  PB-I-JOINT-INSURED.
  6265             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  6266             20 PB-I-JOINT-FIRST-NAME.
  6267                24  PB-I-JOINT-FIRST-INIT PIC X.
  6268                24  FILLER                PIC X(9).
  6269             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  6270*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  6271         16  PB-I-BENEFICIARY-NAME.
  6272             20  PB-I-BANK-NUMBER         PIC X(10).
  6273             20  FILLER                   PIC X(15).
  6274         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  6275         16  PB-I-REFERENCE               PIC X(12).
  6276         16  FILLER REDEFINES PB-I-REFERENCE.
  6277             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  6278             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  6279             20  PB-I-CLP-STATE           PIC XX.
  6280         16  PB-I-UNDERWRITING-STATUS     PIC X.
  6281             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  6282             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  6283             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  6284         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  6285         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  6286         16  PB-I-RESIDENT-STATE          PIC XX.
  6287         16  PB-I-RATE-CODE               PIC X(4).
  6288         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  6289         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  6290         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  6291         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  6292         16  PB-I-BANK-NOCHRGB            PIC 99.
  6293         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 117
* EL6311.cbl
  6294         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  6295
  6296     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  6297         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  6298             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  6299         16  PB-C-CANCEL-ORIGIN           PIC X.
  6300             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  6301         16  PB-C-LF-CANCEL-DT            PIC XX.
  6302         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  6303         16  PB-C-LF-CALC-REQ             PIC X.
  6304             88 PB-COMP-LF-CANCEL            VALUE '?'.
  6305         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  6306         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  6307         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  6308             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  6309         16  PB-C-AH-CANCEL-DT            PIC XX.
  6310         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  6311         16  PB-C-AH-CALC-REQ             PIC X.
  6312             88 PB-COMP-AH-CANCEL            VALUE '?'.
  6313         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  6314         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  6315         16  PB-C-LAST-NAME               PIC X(15).
  6316         16  PB-C-REFUND-SW               PIC X.
  6317             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  6318             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  6319         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  6320         16  PB-C-PAYEE-CODE              PIC X(6).
  6321         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  6322         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  6323         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  6324         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  6325         16  PB-C-REFERENCE               PIC X(12).
  6326         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  6327         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  6328         16  PB-C-POST-CARD-IND           PIC X.
  6329         16  PB-C-CANCEL-REASON           PIC X.
  6330         16  PB-C-REF-INTERFACE-SW        PIC X.
  6331         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  6332         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  6333         16  FILLER                       PIC X(01).
  6334*        16  FILLER                       PIC X(18).
  6335         16  PB-C-POLICY-FORM-NO          PIC X(12).
  6336*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  6337         16  PB-C-INT-ON-REFS             PIC S9(7)V99   COMP-3.
  6338         16  PB-CANCELED-CERT-DATA.
  6339             20  PB-CI-INSURED-NAME.
  6340                 24  PB-CI-LAST-NAME      PIC X(15).
  6341                 24  PB-CI-INITIALS       PIC XX.
  6342             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  6343             20  PB-CI-INSURED-SEX        PIC X.
  6344             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  6345             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  6346             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  6347             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  6348             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  6349             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  6350             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  6351             20  PB-CI-AH-BENEFIT-CD      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 118
* EL6311.cbl
  6352             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  6353             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  6354             20  PB-CI-RATE-CLASS         PIC XX.
  6355             20  PB-CI-RATE-DEV-LF        PIC XXX.
  6356             20  PB-CI-RATE-DEV-AH        PIC XXX.
  6357             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  6358             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  6359             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  6360             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  6361             20  PB-CI-LF-ABBR            PIC X(3).
  6362             20  PB-CI-AH-ABBR            PIC X(3).
  6363             20  PB-CI-OB-FLAG            PIC X.
  6364                 88  PB-CI-OB                VALUE 'B'.
  6365             20  PB-CI-LF-POLICY-STATUS   PIC X.
  6366                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  6367                                           'M' '4' '5' '9' '2'.
  6368                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  6369                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  6370                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  6371                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  6372                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  6373                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  6374                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  6375                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  6376                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  6377                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  6378                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  6379                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  6380                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  6381             20  PB-CI-AH-POLICY-STATUS   PIC X.
  6382                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  6383                                           'M' '4' '5' '9' '2'.
  6384                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  6385                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  6386                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  6387                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  6388                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  6389                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  6390                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  6391                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  6392                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  6393                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  6394                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  6395                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  6396                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  6397             20  PB-CI-PAY-FREQUENCY      PIC 99.
  6398             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  6399             20  PB-CI-SOC-SEC-NO         PIC X(11).
  6400             20  PB-CI-MEMBER-NO          PIC X(12).
  6401             20  PB-CI-INT-CODE           PIC X.
  6402                 88  PB-CI-ADD-ON                  VALUE 'A'.
  6403                 88  PB-CI-SIMPLE                  VALUE 'S'.
  6404             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  6405             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  6406             20  PB-CI-COMP-EXCP-SW       PIC X.
  6407                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  6408                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  6409             20  PB-CI-ENTRY-STATUS       PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 119
* EL6311.cbl
  6410             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  6411             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  6412             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  6413             20  PB-CI-DEATH-DT           PIC XX.
  6414             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  6415             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  6416             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  6417             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  6418             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  6419             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  6420             20  PB-CI-ENTRY-DT              PIC XX.
  6421             20  PB-CI-ENTRY-BATCH           PIC X(6).
  6422             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  6423             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  6424             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  6425             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  6426             20  PB-CI-OLD-LOF               PIC XXX.
  6427*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  6428             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  6429             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  6430             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  6431             20  PB-CI-INDV-GRP-CD           PIC X.
  6432             20  PB-CI-BENEFICIARY-NAME.
  6433                 24  PB-CI-BANK-NUMBER       PIC X(10).
  6434                 24  FILLER                  PIC X(15).
  6435             20  PB-CI-NOTE-SW               PIC X.
  6436             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  6437             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  6438             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  6439             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  6440             20  PB-CI-LOAN-OFFICER          PIC X(5).
  6441             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  6442             20  PB-CI-FIRST-NAME            PIC X(10).
  6443             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  6444
  6445         16  FILLER                       PIC X(13).
  6446*032306  16  FILLER                       PIC X(27).
  6447*        16  FILLER                       PIC X(46).
  6448
  6449     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  6450         16  FILLER                       PIC X(10).
  6451         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  6452         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  6453         16  PB-M-INSURED-MID-INIT        PIC X.
  6454         16  PB-M-INSURED-AGE             PIC 99.
  6455         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  6456         16  PB-M-INSURED-SEX             PIC X.
  6457         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  6458         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  6459         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  6460         16  PB-M-INSURED-CITY-STATE.
  6461             20  PB-M-INSURED-CITY        PIC X(28).
  6462             20  PB-M-INSURED-STATE       PIC XX.
  6463         16  PB-M-INSURED-ZIP-CODE.
  6464             20  PB-M-INSURED-ZIP-PRIME.
  6465                 24  PB-M-INSURED-ZIP-1   PIC X.
  6466                     88  PB-M-CANADIAN-POST-CODE
  6467                                             VALUE 'A' THRU 'Z'.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 120
* EL6311.cbl
  6468                 24  FILLER               PIC X(4).
  6469             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  6470         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  6471                                        PB-M-INSURED-ZIP-CODE.
  6472             20  PM-M-INS-CAN-POST1       PIC XXX.
  6473             20  PM-M-INS-CAN-POST2       PIC XXX.
  6474             20  FILLER                   PIC XXX.
  6475         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  6476         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  6477         16  PB-M-CRED-BENE-NAME          PIC X(30).
  6478         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  6479         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  6480         16  PB-M-CRED-BENE-CITYST.
  6481             20  PB-M-CRED-BENE-CITY      PIC X(28).
  6482             20  PB-M-CRED-BENE-STATE     PIC XX.
  6483         16  FILLER                       PIC X(92).
  6484
  6485     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  6486         16  FILLER                       PIC X(10).
  6487         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6488         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6489         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6490         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6491         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6492         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6493         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6494         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6495         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6496         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6497         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6498         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6499         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  6500         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  6501         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  6502         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  6503         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  6504         16  PB-ACCOUNT-NAME              PIC X(30).
  6505         16  PB-PREM-REF-RPT-FLAG         PIC X.
  6506         16  PB-REFERENCE                 PIC X(12).
  6507         16  PB-B-RECEIVED-DT             PIC XX.
  6508         16  FILLER                       PIC X(234).
  6509
  6510     12  PB-RECORD-STATUS.
  6511         16  PB-CREDIT-SELECT-DT          PIC XX.
  6512         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  6513         16  PB-BILLED-DT                 PIC XX.
  6514         16  PB-BILLING-STATUS            PIC X.
  6515             88  PB-ENTRY-REVERSED            VALUE 'R'.
  6516             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  6517             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  6518         16  PB-RECORD-BILL               PIC X.
  6519             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  6520             88  PB-RECORD-RETURNED           VALUE 'R'.
  6521             88  PB-RECORD-ENDORSED           VALUE 'E'.
  6522             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  6523             88  PB-OVERRIDE-AH               VALUE 'A'.
  6524             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  6525         16  PB-BATCH-ENTRY               PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 121
* EL6311.cbl
  6526             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  6527             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  6528             88  PB-REISSUED-CERT             VALUE 'E'.
  6529             88  PB-CASH-CERT                 VALUE 'C'.
  6530             88  PB-MONTHLY-CERT              VALUE 'M'.
  6531             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  6532             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  6533             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  6534         16  PB-FORCE-CODE                PIC X.
  6535             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  6536             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  6537             88  PB-CANCEL-FORCE              VALUE '8'.
  6538             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  6539             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  6540             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  6541             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  6542             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  6543             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  6544             88  PB-EXCEEDED-LIMIT-FORCED     VALUE 'L'.
  6545             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  6546         16  PB-FATAL-FLAG                PIC X.
  6547             88  PB-FATAL-ERRORS              VALUE 'X'.
  6548         16  PB-FORCE-ER-CD               PIC X.
  6549             88  PB-FORCE-ERRORS              VALUE 'F'.
  6550             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  6551         16  PB-WARN-ER-CD                PIC X.
  6552             88  PB-WARNING-ERRORS            VALUE 'W'.
  6553         16  FILLER                       PIC X.
  6554         16  PB-OUT-BAL-CD                PIC X.
  6555             88  PB-OUT-OF-BAL                VALUE 'O'.
  6556         16  PB-LIFE-OVERRIDE-L1          PIC X.
  6557         16  PB-AH-OVERRIDE-L1            PIC X.
  6558         16  PB-INPUT-DT                  PIC XX.
  6559         16  PB-INPUT-BY                  PIC X(4).
  6560         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  6561         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  6562         16  PB-TOLERANCE-REJECT-SW       PIC X.
  6563         16  PB-LF-EARNING-METHOD         PIC X.
  6564         16  PB-AH-EARNING-METHOD         PIC X.
  6565         16  PB-LF-TERM-CALC-METHOD       PIC X.
  6566         16  PB-AH-TERM-CALC-METHOD       PIC X.
  6567         16  PB-REIN-CD                   PIC XXX.
  6568         16  PB-LF-REFUND-TYPE            PIC X.
  6569         16  PB-AH-REFUND-TYPE            PIC X.
  6570         16  PB-ACCT-EFF-DT               PIC XX.
  6571         16  PB-ACCT-EXP-DT               PIC XX.
  6572         16  PB-COMPANY-ID                PIC X(3).
  6573         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  6574         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  6575         16  PB-SV-CARRIER                PIC X.
  6576         16  PB-SV-GROUPING               PIC X(6).
  6577         16  PB-SV-STATE                  PIC XX.
  6578         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  6579         16  PB-GA-BILLING-INFO.
  6580             20  PB-GA-BILL-DT OCCURS 5 TIMES
  6581                                          PIC XX.
  6582         16  PB-SV-REMIT-TO  REDEFINES
  6583             PB-GA-BILLING-INFO           PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 122
* EL6311.cbl
  6584         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  6585         16  PB-I-LOAN-OFFICER            PIC X(5).
  6586         16  PB-I-VIN                     PIC X(17).
  6587
  6588         16  FILLER                       PIC X(04).
  6589         16  IMNET-BYPASS-SW              PIC X.
  6590
  6591******************************************************************
  6592*                COMMON EDIT ERRORS                              *
  6593******************************************************************
  6594
  6595     12  PB-COMMON-ERRORS.
  6596         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  6597                                           PIC S9(4)     COMP.
  6598
  6599******************************************************************
  6600*                                COPY ELCCERT.
  6601******************************************************************
  6602*                                                                *
  6603*                            ELCCERT.                            *
  6604*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6605*                            VMOD=2.013                          *
  6606*                                                                *
  6607*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  6608*                                                                *
  6609*   FILE TYPE = VSAM,KSDS                                        *
  6610*   RECORD SIZE = 450  RECFORM = FIXED                           *
  6611*                                                                *
  6612*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  6613*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  6614*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  6615*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  6616*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  6617*                                                                *
  6618*   LOG = YES                                                    *
  6619*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6620******************************************************************
  6621*                   C H A N G E   L O G
  6622*
  6623* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6624*-----------------------------------------------------------------
  6625*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6626* EFFECTIVE    NUMBER
  6627*-----------------------------------------------------------------
  6628* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  6629* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  6630* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  6631* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  6632* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  6633* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  6634* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6635* 032612  CR2011110200001  PEMA  AHL CHANGES
  6636* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  6637* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  6638* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
  6639******************************************************************
  6640
  6641 01  CERTIFICATE-MASTER.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 123
* EL6311.cbl
  6642     12  CM-RECORD-ID                      PIC XX.
  6643         88  VALID-CM-ID                      VALUE 'CM'.
  6644
  6645     12  CM-CONTROL-PRIMARY.
  6646         16  CM-COMPANY-CD                 PIC X.
  6647         16  CM-CARRIER                    PIC X.
  6648         16  CM-GROUPING.
  6649             20  CM-GROUPING-PREFIX        PIC X(3).
  6650             20  CM-GROUPING-PRIME         PIC X(3).
  6651         16  CM-STATE                      PIC XX.
  6652         16  CM-ACCOUNT.
  6653             20  CM-ACCOUNT-PREFIX         PIC X(4).
  6654             20  CM-ACCOUNT-PRIME          PIC X(6).
  6655         16  CM-CERT-EFF-DT                PIC XX.
  6656         16  CM-CERT-NO.
  6657             20  CM-CERT-PRIME             PIC X(10).
  6658             20  CM-CERT-SFX               PIC X.
  6659
  6660     12  CM-CONTROL-BY-NAME.
  6661         16  CM-COMPANY-CD-A1              PIC X.
  6662         16  CM-INSURED-LAST-NAME          PIC X(15).
  6663         16  CM-INSURED-INITIALS.
  6664             20  CM-INSURED-INITIAL1       PIC X.
  6665             20  CM-INSURED-INITIAL2       PIC X.
  6666
  6667     12  CM-CONTROL-BY-SSN.
  6668         16  CM-COMPANY-CD-A2              PIC X.
  6669         16  CM-SOC-SEC-NO.
  6670             20  CM-SSN-STATE              PIC XX.
  6671             20  CM-SSN-ACCOUNT            PIC X(6).
  6672             20  CM-SSN-LN3.
  6673                 25  CM-INSURED-INITIALS-A2.
  6674                     30 CM-INSURED-INITIAL1-A2   PIC X.
  6675                     30 CM-INSURED-INITIAL2-A2   PIC X.
  6676                 25 CM-PART-LAST-NAME-A2         PIC X.
  6677
  6678     12  CM-CONTROL-BY-CERT-NO.
  6679         16  CM-COMPANY-CD-A4              PIC X.
  6680         16  CM-CERT-NO-A4                 PIC X(11).
  6681
  6682     12  CM-CONTROL-BY-MEMB.
  6683         16  CM-COMPANY-CD-A5              PIC X.
  6684         16  CM-MEMBER-NO.
  6685             20  CM-MEMB-STATE             PIC XX.
  6686             20  CM-MEMB-ACCOUNT           PIC X(6).
  6687             20  CM-MEMB-LN4.
  6688                 25  CM-INSURED-INITIALS-A5.
  6689                     30 CM-INSURED-INITIAL1-A5   PIC X.
  6690                     30 CM-INSURED-INITIAL2-A5   PIC X.
  6691                 25 CM-PART-LAST-NAME-A5         PIC XX.
  6692
  6693     12  CM-INSURED-PROFILE-DATA.
  6694         16  CM-INSURED-FIRST-NAME.
  6695             20  CM-INSURED-1ST-INIT       PIC X.
  6696             20  FILLER                    PIC X(9).
  6697         16  CM-INSURED-ISSUE-AGE          PIC 99.
  6698         16  CM-INSURED-SEX                PIC X.
  6699             88  CM-SEX-MALE                  VALUE 'M'.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 124
* EL6311.cbl
  6700             88  CM-SEX-FEMAL                 VALUE 'F'.
  6701         16  CM-INSURED-JOINT-AGE          PIC 99.
  6702         16  CM-JOINT-INSURED-NAME.
  6703             20  CM-JT-LAST-NAME           PIC X(15).
  6704             20  CM-JT-FIRST-NAME.
  6705                 24  CM-JT-1ST-INIT        PIC X.
  6706                 24  FILLER                PIC X(9).
  6707             20  CM-JT-INITIAL             PIC X.
  6708
  6709     12  CM-LIFE-DATA.
  6710         16  CM-LF-BENEFIT-CD              PIC XX.
  6711         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  6712         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  6713         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  6714         16  CM-LF-DEV-CODE                PIC XXX.
  6715         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  6716         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  6717         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  6718         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  6719         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  6720         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  6721         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  6722         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  6723         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  6724         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  6725         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  6726         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  6727         16  cm-temp-epiq                  pic xx.
  6728             88  EPIQ-CLASS                  value 'EQ'.
  6729*        16  FILLER                        PIC XX.
  6730
  6731     12  CM-AH-DATA.
  6732         16  CM-AH-BENEFIT-CD              PIC XX.
  6733         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  6734         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  6735         16  CM-AH-DEV-CODE                PIC XXX.
  6736         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  6737         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  6738         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  6739         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  6740         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  6741         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  6742         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  6743         16  CM-AH-PAID-THRU-DT            PIC XX.
  6744             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  6745         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  6746         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  6747         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  6748         16  FILLER                        PIC X.
  6749
  6750     12  CM-LOAN-INFORMATION.
  6751         16  CM-LIVES                      PIC S9(7)     COMP-3.
  6752         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  6753                                           PIC S9(5)V99  COMP-3.
  6754         16  CM-BILLED                     PIC S9(7)     COMP-3.
  6755         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  6756         16  CM-PAY-FREQUENCY              PIC S99.
  6757         16  CM-LOAN-TERM                  PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 125
* EL6311.cbl
  6758         16  CM-RATE-CLASS                 PIC XX.
  6759         16  CM-BENEFICIARY                PIC X(25).
  6760         16  CM-POLICY-FORM-NO             PIC X(12).
  6761         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  6762         16  CM-LAST-ADD-ON-DT             PIC XX.
  6763         16  CM-DEDUCTIBLE-AMOUNTS.
  6764             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  6765             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  6766         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  6767             20  CM-RESIDENT-STATE         PIC XX.
  6768             20  CM-RATE-CODE              PIC X(4).
  6769             20  FILLER                    PIC XX.
  6770         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  6771             20  CM-LOAN-OFFICER           PIC X(5).
  6772             20  FILLER                    PIC XXX.
  6773         16  CM-CSR-CODE                   PIC XXX.
  6774         16  CM-UNDERWRITING-CODE          PIC X.
  6775             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  6776         16  CM-POST-CARD-IND              PIC X.
  6777         16  CM-REF-INTERFACE-SW           PIC X.
  6778         16  CM-PREMIUM-TYPE               PIC X.
  6779             88  CM-SING-PRM                  VALUE '1'.
  6780             88  CM-O-B-COVERAGE              VALUE '2'.
  6781             88  CM-OPEN-END                  VALUE '3'.
  6782         16  CM-IND-GRP-TYPE               PIC X.
  6783             88  CM-INDIVIDUAL                VALUE 'I'.
  6784             88  CM-GROUP                     VALUE 'G'.
  6785         16  CM-SKIP-CODE                  PIC X.
  6786             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  6787             88  SKIP-JULY                    VALUE '1'.
  6788             88  SKIP-AUGUST                  VALUE '2'.
  6789             88  SKIP-SEPTEMBER               VALUE '3'.
  6790             88  SKIP-JULY-AUG                VALUE '4'.
  6791             88  SKIP-AUG-SEPT                VALUE '5'.
  6792             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  6793             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  6794             88  SKIP-JUNE                    VALUE '8'.
  6795             88  SKIP-JUNE-JULY               VALUE '9'.
  6796             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  6797             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  6798         16  CM-PAYMENT-MODE               PIC X.
  6799             88  PAY-MONTHLY                  VALUE SPACE.
  6800             88  PAY-WEEKLY                   VALUE '1'.
  6801             88  PAY-SEMI-MONTHLY             VALUE '2'.
  6802             88  PAY-BI-WEEKLY                VALUE '3'.
  6803             88  PAY-SEMI-ANUALLY             VALUE '4'.
  6804         16  CM-LOAN-NUMBER                PIC X(8).
  6805         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  6806         16  CM-OLD-LOF                    PIC XXX.
  6807*        16  CM-LOAN-OFFICER               PIC XXX.
  6808         16  CM-REIN-TABLE                 PIC XXX.
  6809         16  CM-SPECIAL-REIN-CODE          PIC X.
  6810         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  6811         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  6812         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  6813
  6814     12  CM-STATUS-DATA.
  6815         16  CM-ENTRY-STATUS               PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 126
* EL6311.cbl
  6816         16  CM-ENTRY-DT                   PIC XX.
  6817
  6818         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  6819         16  CM-LF-CANCEL-DT               PIC XX.
  6820         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  6821
  6822         16  CM-LF-STATUS-AT-DEATH         PIC X.
  6823         16  CM-LF-DEATH-DT                PIC XX.
  6824         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  6825
  6826         16  CM-LF-CURRENT-STATUS          PIC X.
  6827             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  6828                                                'M' '4' '5' '9'.
  6829             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  6830             88  CM-LF-POLICY-PENDING         VALUE '2'.
  6831             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  6832             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  6833             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  6834             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  6835             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  6836             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  6837             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  6838             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  6839             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  6840             88  CM-LF-DECLINED               VALUE 'D'.
  6841             88  CM-LF-VOIDED                 VALUE 'V'.
  6842
  6843         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  6844         16  CM-AH-CANCEL-DT               PIC XX.
  6845         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  6846
  6847         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  6848         16  CM-AH-SETTLEMENT-DT           PIC XX.
  6849         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  6850
  6851         16  CM-AH-CURRENT-STATUS          PIC X.
  6852             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  6853                                                'M' '4' '5' '9'.
  6854             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  6855             88  CM-AH-POLICY-PENDING         VALUE '2'.
  6856             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  6857             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  6858             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  6859             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  6860             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  6861             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  6862             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  6863             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  6864             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  6865             88  CM-AH-DECLINED               VALUE 'D'.
  6866             88  CM-AH-VOIDED                 VALUE 'V'.
  6867
  6868         16  CM-CLAIM-INTERFACE-SW         PIC X.
  6869             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  6870             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  6871             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  6872         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  6873
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 127
* EL6311.cbl
  6874         16  CM-ENTRY-BATCH                PIC X(6).
  6875         16  CM-LF-EXIT-BATCH              PIC X(6).
  6876         16  CM-AH-EXIT-BATCH              PIC X(6).
  6877         16  CM-LAST-MONTH-END             PIC XX.
  6878
  6879     12  CM-NOTE-SW                        PIC X.
  6880         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  6881         88  CERT-NOTES-PRESENT               VALUE '1'.
  6882         88  BILLING-NOTES-PRESENT            VALUE '2'.
  6883         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  6884         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  6885         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  6886         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  6887         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  6888     12  CM-COMP-EXCP-SW                   PIC X.
  6889         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  6890         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  6891     12  CM-INSURED-ADDRESS-SW             PIC X.
  6892         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  6893         88  INSURED-ADDR-PRESENT             VALUE '1'.
  6894
  6895*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  6896     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  6897     12  FILLER                            PIC X.
  6898
  6899*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  6900     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  6901     12  FILLER                            PIC X.
  6902*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  6903     12  CM-INT-ON-REFS                    PIC S9(7)V99   COMP-3.
  6904
  6905     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  6906         88  CERT-ADDED-BATCH                 VALUE ' '.
  6907         88  CERT-ADDED-ONLINE                VALUE '1'.
  6908         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  6909         88  CERT-PURGED-OFFLINE              VALUE '3'.
  6910         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  6911     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  6912         88  CERT-AS-LOADED                   VALUE ' '.
  6913         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  6914         88  CERT-CLAIM-ONLINE                VALUE '2'.
  6915         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  6916         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  6917         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  6918         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  6919         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  6920
  6921     12  CM-ACCOUNT-COMM-PCTS.
  6922         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  6923         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  6924
  6925     12  CM-USER-FIELD                     PIC X.
  6926     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  6927     12  CM-CLP-STATE                      PIC XX.
  6928     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  6929     12  CM-USER-RESERVED                  PIC XXX.
  6930     12  FILLER REDEFINES CM-USER-RESERVED.
  6931         16  CM-AH-CLASS-CD                PIC XX.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 128
* EL6311.cbl
  6932         16  F                             PIC X.
  6933******************************************************************
  6934*                                COPY ERCNOTE.
  6935******************************************************************
  6936*                                                                *
  6937*                                                                *
  6938*                            ERCNOTE                             *
  6939*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6940*                            VMOD=2.003                          *
  6941*                                                                *
  6942*        FILE DESCRIPTION = CERTIFICATE AND BILLING NOTES        *
  6943*                                                                *
  6944*        FILE TYPE= VSAM,KSDS                                    *
  6945*        RECORD SIZE = 825    RECFORM = FIXED                    *
  6946*                                                                *
  6947*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  6948*                                                                *
  6949*        LOG = YES                                               *
  6950*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  6951*                                                                *
  6952******************************************************************
  6953*                   C H A N G E   L O G
  6954*
  6955* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6956*-----------------------------------------------------------------
  6957*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6958* EFFECTIVE    NUMBER
  6959*-----------------------------------------------------------------
  6960* 091509  CR2008100900003  AJRA  CERT NOTES MOVED TO NEW FILE. THI
  6961*                                FILE WILL CONTAIN BILLING NOTES O
  6962******************************************************************
  6963
  6964 01  CERTIFICATE-NOTE.
  6965     12  CN-RECORD-ID                PIC  XX.
  6966         88  VALID-CN-ID                  VALUE 'CN'.
  6967
  6968     12  CN-CONTROL-PRIMARY.
  6969         16  CN-COMPANY-CD           PIC X.
  6970         16  CN-CARRIER              PIC X.
  6971         16  CN-GROUPING.
  6972             20 CN-GROUPING-PREFIX   PIC XXX.
  6973             20 CN-GROUPING-PRIME    PIC XXX.
  6974         16  CN-STATE                PIC XX.
  6975         16  CN-ACCOUNT.
  6976             20 CN-ACCOUNT-PREFIX    PIC X(4).
  6977             20 CN-ACCOUNT-PRIME     PIC X(6).
  6978         16  CN-CERT-EFF-DT          PIC XX.
  6979         16  CN-CERT-NO.
  6980             20  CN-CERT-PRIME       PIC X(10).
  6981             20  CN-CERT-SFX         PIC X.
  6982
  6983     12  CN-BILLING-START-LINE-NO    PIC 99.
  6984     12  CN-BILLING-END-LINE-NO      PIC 99.
  6985
  6986     12  CN-LINES.
  6987         16  CN-LINE OCCURS 10       PIC X(77).
  6988
  6989     12  CN-LAST-MAINT-DT            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 129
* EL6311.cbl
  6990     12  CN-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  6991     12  CN-LAST-MAINT-USER          PIC X(4).
  6992     12  FILLER                      PIC X(6).
  6993******************************************************************
  6994*                                COPY ERCPNDM.
  6995******************************************************************
  6996*                                                                *
  6997*                                                                *
  6998*                            ERCPNDM                             *
  6999*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7000*                            VMOD=2.003                          *
  7001*                                                                *
  7002*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  7003*                                                                *
  7004*   FILE TYPE = VSAM,KSDS                                        *
  7005*   RECORD SIZE = 374   RECFORM = FIX                            *
  7006*                                                                *
  7007*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  7008*   ALTERNATE PATH    = NOT USED                                 *
  7009*                                                                *
  7010*   LOG = YES                                                    *
  7011*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7012******************************************************************
  7013*                   C H A N G E   L O G
  7014*
  7015* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7016*-----------------------------------------------------------------
  7017*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7018* EFFECTIVE    NUMBER
  7019*-----------------------------------------------------------------
  7020* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  7021* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  7022* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  7023* 100217  CR2016091600001  PEMA  ADD EDIT FOR ZIP CODE
  7024******************************************************************
  7025
  7026 01  PENDING-MAILING-DATA.
  7027     12  PM-RECORD-ID                      PIC XX.
  7028         88  VALID-MA-ID                       VALUE 'PM'.
  7029
  7030     12  PM-CONTROL-PRIMARY.
  7031         16  PM-COMPANY-CD                 PIC X.
  7032         16  PM-ENTRY-BATCH                PIC X(6).
  7033         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  7034         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  7035
  7036     12  FILLER                            PIC X(14).
  7037
  7038     12  PM-ACCESS-CONTROL.
  7039         16  PM-SOURCE-SYSTEM              PIC XX.
  7040             88  PM-FROM-CREDIT                VALUE 'CR'.
  7041             88  PM-FROM-VSI                   VALUE 'VS'.
  7042             88  PM-FROM-WARRANTY              VALUE 'WA'.
  7043             88  PM-FROM-OTHER                 VALUE 'OT'.
  7044         16  PM-RECORD-ADD-DT              PIC XX.
  7045         16  PM-RECORD-ADDED-BY            PIC XXXX.
  7046         16  PM-LAST-MAINT-DT              PIC XX.
  7047         16  PM-LAST-MAINT-BY              PIC XXXX.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 130
* EL6311.cbl
  7048         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  7049
  7050     12  PM-PROFILE-INFO.
  7051         16  PM-QUALIFY-CODE-1             PIC XX.
  7052         16  PM-QUALIFY-CODE-2             PIC XX.
  7053         16  PM-QUALIFY-CODE-3             PIC XX.
  7054         16  PM-QUALIFY-CODE-4             PIC XX.
  7055         16  PM-QUALIFY-CODE-5             PIC XX.
  7056
  7057         16  PM-INSURED-LAST-NAME          PIC X(15).
  7058         16  PM-INSURED-FIRST-NAME         PIC X(10).
  7059         16  PM-INSURED-MIDDLE-INIT        PIC X.
  7060         16  PM-INSURED-ISSUE-AGE          PIC 99.
  7061         16  PM-INSURED-BIRTH-DT           PIC XX.
  7062         16  PM-INSURED-SEX                PIC X.
  7063             88  PM-SEX-MALE                   VALUE 'M'.
  7064             88  PM-SEX-FEMALE                 VALUE 'F'.
  7065         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  7066
  7067         16  PM-ADDRESS-CORRECTED          PIC X.
  7068         16  PM-JOINT-BIRTH-DT             PIC XX.
  7069*        16  FILLER                        PIC X(12).
  7070
  7071         16  PM-ADDRESS-LINE-1             PIC X(30).
  7072         16  PM-ADDRESS-LINE-2             PIC X(30).
  7073         16  PM-CITY-STATE.
  7074             20  PM-CITY                   PIC X(28).
  7075             20  PM-STATE                  PIC XX.
  7076         16  PM-ZIP.
  7077             20  PM-ZIP-CODE.
  7078                 24  PM-ZIP-1              PIC X.
  7079                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  7080                 24  FILLER                PIC X(4).
  7081             20  PM-ZIP-PLUS4              PIC X(4).
  7082         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  7083             20  PM-CAN-POST1              PIC XXX.
  7084             20  PM-CAN-POST2              PIC XXX.
  7085             20  FILLER                    PIC XXX.
  7086
  7087         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  7088         16  pm-city-st-zip-verified       pic x.
  7089         16  FILLER                        PIC XX.
  7090
  7091     12  PM-CRED-BENE-INFO.
  7092         16  PM-CRED-BENE-NAME             PIC X(25).
  7093         16  PM-CRED-BENE-ADDR             PIC X(30).
  7094         16  PM-CRED-BENE-ADDR2            PIC X(30).
  7095         16  PM-CRED-BENE-CTYST.
  7096             20  PM-CRED-BENE-CITY         PIC X(28).
  7097             20  PM-CRED-BENE-STATE        PIC XX.
  7098         16  PM-CRED-BENE-ZIP.
  7099             20  PM-CB-ZIP-CODE.
  7100                 24  PM-CB-ZIP-1           PIC X.
  7101                     88  PM-CB-CANADIAN-POST-CODE
  7102                                  VALUE 'A' THRU 'Z'.
  7103                 24  FILLER                PIC X(4).
  7104             20  PM-CB-ZIP-PLUS4           PIC X(4).
  7105         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 131
* EL6311.cbl
  7106             20  PM-CB-CAN-POST1           PIC XXX.
  7107             20  PM-CB-CAN-POST2           PIC XXX.
  7108             20  FILLER                    PIC XXX.
  7109     12  PM-POST-CARD-MAIL-DATA.
  7110         16  PM-MAIL-DATA OCCURS 7.
  7111             20  PM-MAIL-TYPE              PIC X.
  7112                 88  PM-12MO-MAILING           VALUE '1'.
  7113                 88  PM-EXP-MAILING            VALUE '2'.
  7114             20  PM-MAIL-STATUS            PIC X.
  7115                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  7116                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  7117                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  7118             20  PM-MAIL-DATE              PIC XX.
  7119     12  FILLER                            PIC XX.
  7120     12  FILLER                            PIC X(12).
  7121*    12  FILLER                            PIC X(30).
  7122
  7123******************************************************************
  7124*                                COPY ERCMAIL.
  7125******************************************************************
  7126*                                                                *
  7127*                                                                *
  7128*                            ERCMAIL                             *
  7129*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7130*                            VMOD=2.003                          *
  7131*                                                                *
  7132*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  7133*                                                                *
  7134*   FILE TYPE = VSAM,KSDS                                        *
  7135*   RECORD SIZE = 374   RECFORM = FIX                            *
  7136*                                                                *
  7137*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  7138*   ALTERNATE PATH    = NOT USED                                 *
  7139*                                                                *
  7140*   LOG = YES                                                    *
  7141*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7142******************************************************************
  7143*                   C H A N G E   L O G
  7144*
  7145* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7146*-----------------------------------------------------------------
  7147*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7148* EFFECTIVE    NUMBER
  7149*-----------------------------------------------------------------
  7150* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  7151* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  7152* 111108                   PEMA  ADD CRED BENE ADDR2
  7153******************************************************************
  7154
  7155 01  MAILING-DATA.
  7156     12  MA-RECORD-ID                      PIC XX.
  7157         88  VALID-MA-ID                       VALUE 'MA'.
  7158
  7159     12  MA-CONTROL-PRIMARY.
  7160         16  MA-COMPANY-CD                 PIC X.
  7161         16  MA-CARRIER                    PIC X.
  7162         16  MA-GROUPING.
  7163             20  MA-GROUPING-PREFIX        PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 132
* EL6311.cbl
  7164             20  MA-GROUPING-PRIME         PIC XXX.
  7165         16  MA-STATE                      PIC XX.
  7166         16  MA-ACCOUNT.
  7167             20  MA-ACCOUNT-PREFIX         PIC X(4).
  7168             20  MA-ACCOUNT-PRIME          PIC X(6).
  7169         16  MA-CERT-EFF-DT                PIC XX.
  7170         16  MA-CERT-NO.
  7171             20  MA-CERT-PRIME             PIC X(10).
  7172             20  MA-CERT-SFX               PIC X.
  7173
  7174     12  FILLER                            PIC XX.
  7175
  7176     12  MA-ACCESS-CONTROL.
  7177         16  MA-SOURCE-SYSTEM              PIC XX.
  7178             88  MA-FROM-CREDIT                VALUE 'CR'.
  7179             88  MA-FROM-VSI                   VALUE 'VS'.
  7180             88  MA-FROM-WARRANTY              VALUE 'WA'.
  7181             88  MA-FROM-OTHER                 VALUE 'OT'.
  7182         16  MA-RECORD-ADD-DT              PIC XX.
  7183         16  MA-RECORD-ADDED-BY            PIC XXXX.
  7184         16  MA-LAST-MAINT-DT              PIC XX.
  7185         16  MA-LAST-MAINT-BY              PIC XXXX.
  7186         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  7187
  7188     12  MA-PROFILE-INFO.
  7189         16  MA-QUALIFY-CODE-1             PIC XX.
  7190         16  MA-QUALIFY-CODE-2             PIC XX.
  7191         16  MA-QUALIFY-CODE-3             PIC XX.
  7192         16  MA-QUALIFY-CODE-4             PIC XX.
  7193         16  MA-QUALIFY-CODE-5             PIC XX.
  7194
  7195         16  MA-INSURED-LAST-NAME          PIC X(15).
  7196         16  MA-INSURED-FIRST-NAME         PIC X(10).
  7197         16  MA-INSURED-MIDDLE-INIT        PIC X.
  7198         16  MA-INSURED-ISSUE-AGE          PIC 99.
  7199         16  MA-INSURED-BIRTH-DT           PIC XX.
  7200         16  MA-INSURED-SEX                PIC X.
  7201             88  MA-SEX-MALE                   VALUE 'M'.
  7202             88  MA-SEX-FEMALE                 VALUE 'F'.
  7203         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  7204
  7205         16  MA-ADDRESS-CORRECTED          PIC X.
  7206         16  MA-JOINT-BIRTH-DT             PIC XX.
  7207*        16  FILLER                        PIC X(12).
  7208
  7209         16  MA-ADDRESS-LINE-1             PIC X(30).
  7210         16  MA-ADDRESS-LINE-2             PIC X(30).
  7211         16  MA-CITY-STATE.
  7212             20  MA-CITY                   PIC X(28).
  7213             20  MA-ADDR-STATE             PIC XX.
  7214         16  MA-ZIP.
  7215             20  MA-ZIP-CODE.
  7216                 24  MA-ZIP-CODE-1ST       PIC X(1).
  7217                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  7218                 24  FILLER                PIC X(4).
  7219             20  MA-ZIP-PLUS4              PIC X(4).
  7220         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  7221             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 133
* EL6311.cbl
  7222             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  7223             20  FILLER                    PIC X(3).
  7224
  7225         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  7226
  7227         16  FILLER                        PIC XXX.
  7228*        16  FILLER                        PIC X(10).
  7229
  7230     12  MA-CRED-BENE-INFO.
  7231         16  MA-CRED-BENE-NAME                 PIC X(25).
  7232         16  MA-CRED-BENE-ADDR                 PIC X(30).
  7233         16  MA-CRED-BENE-ADDR2                PIC X(30).
  7234         16  MA-CRED-BENE-CTYST.
  7235             20  MA-CRED-BENE-CITY             PIC X(28).
  7236             20  MA-CRED-BENE-STATE            PIC XX.
  7237         16  MA-CRED-BENE-ZIP.
  7238             20  MA-CB-ZIP-CODE.
  7239                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  7240                     88  MA-CB-CANADIAN-POST-CODE
  7241                                           VALUE 'A' THRU 'Z'.
  7242                 24  FILLER                    PIC X(4).
  7243             20  MA-CB-ZIP-PLUS4               PIC X(4).
  7244         16  MA-CB-CANADIAN-POSTAL-CODE
  7245                            REDEFINES MA-CRED-BENE-ZIP.
  7246             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  7247             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  7248             20  FILLER                        PIC X(3).
  7249     12  MA-POST-CARD-MAIL-DATA.
  7250         16  MA-MAIL-DATA OCCURS 7.
  7251             20  MA-MAIL-TYPE              PIC X.
  7252                 88  MA-12MO-MAILING           VALUE '1'.
  7253                 88  MA-EXP-MAILING            VALUE '2'.
  7254             20  MA-MAIL-STATUS            PIC X.
  7255                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  7256                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  7257                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  7258             20  MA-MAIL-DATE              PIC XX.
  7259     12  FILLER                            PIC XX.
  7260     12  FILLER                            PIC XX.
  7261*    12  FILLER                            PIC X(30).
  7262******************************************************************
  7263*                                COPY ERCRQST.
  7264******************************************************************
  7265*                                                                *
  7266*                                                                *
  7267*                            ERCRQST.                            *
  7268*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7269*                            VMOD=2.002                          *
  7270*                                                                *
  7271*   FILE DESCRIPTION = ACCOUNTS RECEIVABLE REQUEST RECORD        *
  7272*                                                                *
  7273*   FILE TYPE = VSAM,KSDS                                        *
  7274*   RECORD SIZE = 200  RECFORM = FIXED                           *
  7275*                                                                *
  7276*   BASE CLUSTER = ERRQST                         RKP=2,LEN=7    *
  7277*       ALTERNATE PATH1 = ERRQST2  (BY CO, CAR, GROUP, ST,       *
  7278*                                   ACCOUNT, REF, BATCH)         *
  7279*                                                RKP=9, LEN=38   *
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 134
* EL6311.cbl
  7280*       ALTERNATE PATH2 = ERRQST3  (BY CO, CAR, GROUP, FIN  RESP *
  7281*                                   ACCOUNT, REF, BATCH)         *
  7282*                                                RKP=47, LEN=46  *
  7283*       ALTERNATE PATH3 = ERRQST4  (BY CO, CAR, GROUP, AGENT,    *
  7284*                                   BATCH)                       *
  7285*                                                RKP=93, LEN=24  *
  7286*       ALTERNATE PATH4 = ERRQST5  (BY CO, SUMMARY CODE, ACCT,   *
  7287*                                   REF, BATCH)                  *
  7288*                                                RKP=117, LEN=35 *
  7289*   LOG = NO                                                     *
  7290*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7291******************************************************************
  7292
  7293 01  AR-REQUEST-RECORD.
  7294     12  RQ-RECORD-ID                     PIC XX.
  7295         88  VALID-RQ-ID                        VALUE 'RQ'.
  7296
  7297     12  RQ-CONTROL-PRIMARY.
  7298         16  RQ-COMPANY-CD                PIC X.
  7299         16  RQ-ENTRY-BATCH               PIC X(6).
  7300
  7301     12  RQ-CONTROL-BY-ACCT-REF.
  7302         16  RQ-COMPANY-CD-A1             PIC X.
  7303         16  RQ-CARRIER-A1                PIC X.
  7304         16  RQ-GROUPING-A1               PIC X(6).
  7305         16  RQ-STATE-A1                  PIC XX.
  7306         16  RQ-ACCOUNT-A1                PIC X(10).
  7307         16  RQ-REFERENCE-A1              PIC X(12).
  7308         16  RQ-BATCH-A1                  PIC X(6).
  7309
  7310     12  RQ-CONTROL-BY-FIN-RESP.
  7311         16  RQ-COMPANY-CD-A2             PIC X.
  7312         16  RQ-CARRIER-A2                PIC X.
  7313         16  RQ-GROUPING-A2               PIC X(6).
  7314         16  RQ-FIN-RESP-A2               PIC X(10).
  7315         16  RQ-ACCT-AGENT-A2             PIC X(10).
  7316         16  RQ-REFERENCE-A2              PIC X(12).
  7317         16  RQ-BATCH-A2                  PIC X(6).
  7318
  7319     12  RQ-CONTROL-BY-ACCT-AGENT.
  7320         16  RQ-COMPANY-CD-A3             PIC X.
  7321         16  RQ-CARRIER-A3                PIC X.
  7322         16  RQ-GROUPING-A3               PIC X(6).
  7323         16  RQ-ACCT-AGENT-A3             PIC X(10).
  7324         16  RQ-BATCH-A3                  PIC X(6).
  7325
  7326     12  RQ-CONTROL-BY-SUMMARY.
  7327         16  RQ-COMPANY-CD-A4             PIC X.
  7328         16  RQ-SUMMARY-CODE              PIC X(6).
  7329         16  RQ-ACCOUNT-A4                PIC X(10).
  7330         16  RQ-REFERENCE-A4              PIC X(12).
  7331         16  RQ-BATCH-A4                  PIC X(6).
  7332
  7333     12  RQ-REQUEST-METHOD                PIC X.
  7334         88 RQ-FIN-RESP-REQUEST               VALUE 'F'.
  7335         88 RQ-ACCT-AGENT-REQUEST             VALUE 'A'.
  7336         88 RQ-SUMMARY-REQUEST                VALUE 'S'.
  7337         88 RQ-BATCH-REQUEST                  VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 135
* EL6311.cbl
  7338     12  FILLER                           PIC X.
  7339     12  RQ-STATUS                        PIC X.
  7340         88  RQ-REQUEST-ERROR                 VALUE 'E'.
  7341         88  RQ-RESUBMIT                      VALUE 'R'.
  7342     12  RQ-PROCESSOR-ID                  PIC X(4).
  7343     12  RQ-ENTRY-DT                      PIC XX.
  7344     12  RQ-MO-END-DT                     PIC XX.
  7345     12  RQ-REQUEST-DT                    PIC XX.
  7346     12  RQ-STMT-DT                       PIC XX.
  7347     12  RQ-REVERSAL-DT                   PIC XX.
  7348     12  RQ-CREDIT-SELECT-DT              PIC XX.
  7349     12  RQ-CREDIT-ACCEPT-DT              PIC XX.
  7350
  7351     12  FILLER                           PIC X(27).
  7352
  7353******************************************************************
  7354
  7355*                                COPY ERCLOFC.
  7356******************************************************************
  7357*                                                                *
  7358*                                                                *
  7359*                            ERCLOFC                             *
  7360*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7361*                            VMOD=2.003                          *
  7362*                                                                *
  7363*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *
  7364*                                                                *
  7365*   FILE TYPE = VSAM,KSDS                                        *
  7366*   RECORD SIZE = 670   RECFORM = FIX                            *
  7367*                                                                *
  7368*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *
  7369*                                                                *
  7370*   LOG = YES                                                    *
  7371*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7372*                                                                *
  7373******************************************************************
  7374
  7375 01  LOAN-OFFICER-MASTER.
  7376     12  LO-RECORD-ID                PIC XX.
  7377         88  VALID-LO-ID                VALUE 'LO'.
  7378
  7379     12  LO-CONTROL-PRIMARY.
  7380         16  LO-COMPANY-CD           PIC X.
  7381         16  LO-CARRIER              PIC X.
  7382         16  LO-GROUPING.
  7383             20  LO-GROUPING-PREFIX  PIC XXX.
  7384             20  LO-GROUPING-PRIME   PIC XXX.
  7385         16  LO-STATE                PIC XX.
  7386         16  LO-ACCOUNT.
  7387             20  LO-ACCOUNT-PREFIX   PIC X(4).
  7388             20  LO-ACCOUNT-PRIME    PIC X(6).
  7389         16  LO-OFFICER-CODE         PIC X(5).
  7390
  7391     12  LO-OFFICER-NAME             PIC X(30).
  7392
  7393     12  LO-LAST-MAINT-DT            PIC XX.
  7394     12  LO-LAST-USER                PIC X(4).
  7395     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 136
* EL6311.cbl
  7396
  7397     12  LO-COMP-CONTROL             PIC X.
  7398             88  LO-SHOW-COMP           VALUE 'Y'.
  7399             88  LO-SUPPRESS-COMP       VALUE 'N'.
  7400     12  LO-DETAIL-CONTROL           PIC X.
  7401             88  LO-PRINT-DETAIL        VALUE 'D'.
  7402             88  LO-PRINT-SUMMARY       VALUE 'S'.
  7403
  7404     12  LO-SV-CARRIER               PIC X.
  7405     12  LO-SV-GROUPING              PIC X(6).
  7406     12  LO-SV-STATE                 PIC XX.
  7407
  7408     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.
  7409     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.
  7410
  7411     12  LO-OFFICER-INFO.
  7412         16  FILLER OCCURS 12 TIMES.
  7413             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.
  7414             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.
  7415             20  LO-LF-COUNT         PIC S9(5) COMP-3.
  7416             20  LO-LF-PREM          PIC S9(7) COMP-3.
  7417             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.
  7418             20  LO-AH-COUNT         PIC S9(5) COMP-3.
  7419             20  LO-AH-PREM          PIC S9(7) COMP-3.
  7420             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.
  7421     12  FILLER                      PIC X(198).
  7422******************************************************************
  7423*                                COPY ERCPYAJ.
  7424******************************************************************
  7425*                                                                *
  7426*                            ERCPYAJ                             *
  7427*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7428*                            VMOD=2.015                          *
  7429*                                                                *
  7430*   FILE DESCRIPTION = PENDING PAYMENT AND ADJUSTMENTS           *
  7431*                                                                *
  7432*                                                                *
  7433*   FILE TYPE = VSAM,KSDS                                        *
  7434*   RECORD SIZE = 200  RECFORM = FIXED                           *
  7435*                                                                *
  7436*   BASE CLUSTER = ERPYAJ                         RKP=2,LEN=33   *
  7437*       ALTERNATE PATHS = NONE                                   *
  7438*                                                                *
  7439*   LOG = YES                                                    *
  7440*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7441******************************************************************
  7442******************************************************************
  7443*                   C H A N G E   L O G
  7444*
  7445* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7446*-----------------------------------------------------------------
  7447*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7448* EFFECTIVE    NUMBER
  7449*-----------------------------------------------------------------
  7450* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
  7451* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
  7452******************************************************************
  7453
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 137
* EL6311.cbl
  7454 01  PENDING-PAY-ADJ.
  7455     12  PY-RECORD-ID                     PIC XX.
  7456         88  VALID-PY-ID                        VALUE 'PY'.
  7457
  7458     12  PY-CONTROL-PRIMARY.
  7459         16  PY-COMPANY-CD                PIC X.
  7460         16  PY-CARRIER                   PIC X.
  7461         16  PY-GROUPING                  PIC X(6).
  7462         16  PY-FIN-RESP                  PIC X(10).
  7463         16  PY-ACCOUNT                   PIC X(10).
  7464         16  PY-PRODUCER REDEFINES PY-ACCOUNT
  7465                                          PIC X(10).
  7466         16  PY-FILE-SEQ-NO               PIC S9(8)     COMP.
  7467         16  PY-RECORD-TYPE               PIC X.
  7468             88  PY-REMIT-RECEIVED            VALUE 'R'.
  7469             88  PY-DEPOSIT                   VALUE 'D'.
  7470             88  PY-CHARGE-TO-AGENT           VALUE 'C'.
  7471             88  PY-ADJ-REM-RECEIVED          VALUE 'S'.
  7472             88  PY-ADJ-DEPOSIT               VALUE 'T'.
  7473             88  PY-ADJ-CHG-TO-AGT            VALUE 'U'.
  7474             88  PY-ADD-TO-YTD-COMP           VALUE 'X'.
  7475             88  PY-SUBTRACT-YTD-COMP         VALUE 'Y'.
  7476             88  PY-ADD-TO-BALANCE            VALUE 'Z'.
  7477             88  PY-FICA-ENTRY                VALUE 'F'.
  7478             88  PY-REMIT-IND-GROUPING        VALUE 'G'.
  7479             88  PY-POLICY-FEE                VALUE 'W'.
  7480             88  PY-DUE-PREM-ADJ              VALUE 'P'.
  7481
  7482     12  PY-PYMT-TYPE                     PIC X.
  7483             88  PY-NEW-BUS-PYMT              VALUE 'B'.
  7484             88  PY-REINS-PYMT                VALUE 'R'.
  7485             88  PY-EXP-PYMT                  VALUE 'E'.
  7486
  7487     12  PY-BIL-INV                       PIC X(6).
  7488     12  PY-REF-NO                        PIC X(12).
  7489
  7490     12  PY-LAST-MAINT-DT                 PIC XX.
  7491     12  PY-LAST-MAINT-BY                 PIC X(4).
  7492     12  PY-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  7493
  7494     12  PY-PYADJ-RECORD.
  7495         16  PY-ENTRY-AMT                 PIC S9(7)V99  COMP-3.
  7496         16  PY-ENTRY-COMMENT             PIC X(30).
  7497         16  PY-GL-DATA      REDEFINES PY-ENTRY-COMMENT.
  7498             20  PY-GL-ACCOUNT            PIC X(10).
  7499             20  PY-GL-STATE              PIC X(02).
  7500             20  PY-GL-CANC-SW            PIC X(01).
  7501                 88  PY-GL-CANC-SW-ON     VALUE 'Y'.
  7502                 88  PY-GL-CANC-SW-OFF    VALUE 'N'.
  7503             20  PY-GL-COMMENT            PIC X(10).
  7504             20  FILLER      REDEFINES PY-GL-COMMENT.
  7505                 24  PY-GL-CHECK-NO       PIC 9(06).
  7506                 24  FILLER               PIC X(04).
  7507             20  FILLER                   PIC X(07).
  7508         16  PY-SAVE-ACCOUNT              PIC X(10).
  7509         16  PY-SAVE-TYPE                 PIC X(01).
  7510
  7511         16  PY-LETTERS.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 138
* EL6311.cbl
  7512             20  PY-LETTER OCCURS 3 TIMES
  7513                           INDEXED BY PY-LET-NDX
  7514                                          PIC X(04).
  7515
  7516         16  PY-ERCOMP-TYPE               PIC X.
  7517             88  PY-ACCOUNT-TYPE              VALUE 'A'.
  7518             88  PY-GA-TYPE                   VALUE 'G'.
  7519             88  PY-BANK-TYPE                 VALUE 'B'.
  7520         16  FILLER                       PIC X(05).
  7521
  7522     12  PY-RECORD-STATUS.
  7523         16  PY-CREDIT-SELECT-DT          PIC XX.
  7524         16  PY-CREDIT-ACCEPT-DT          PIC XX.
  7525         16  PY-BILLED-DATE               PIC XX.
  7526         16  PY-REPORTED-DT               PIC XX.
  7527         16  PY-PMT-APPLIED               PIC X.
  7528             88  PY-ACCOUNT-PMT               VALUE 'A'.
  7529             88  PY-GA-PMT                    VALUE 'G'.
  7530             88  PY-OVWRITE-PMT               VALUE 'O'.
  7531             88  PY-NON-AR-PMT                VALUE 'N'.
  7532         16  FILLER                       PIC X(5).
  7533         16  PY-INPUT-DT                  PIC XX.
  7534         16  PY-CHECK-NUMBER              PIC X(6).
  7535         16  PY-VOID-SW                   PIC X.
  7536             88  PY-CHECK-VOIDED              VALUE 'V'.
  7537         16  PY-CHECK-ORIGIN-SW           PIC X.
  7538             88  PY-BILLING-CHECK             VALUE 'B'.
  7539             88  PY-REFUND-CHECK              VALUE 'R'.
  7540             88  PY-GA-CHECK                  VALUE 'G'.
  7541             88  PY-CHECK-WRITTEN             VALUE 'W'.
  7542             88  PY-CHECK-REVERSAL            VALUE 'V'.
  7543         16  PY-CHECK-WRITTEN-DT          PIC XX.
  7544         16  PY-CHECK-QUE-CONTROL         PIC S9(8) COMP.
  7545         16  PY-CHECK-QUE-SEQUENCE        PIC S9(4) COMP.
  7546         16  PY-BILL-FLAG                 PIC X.
  7547             88  PY-BILLED                    VALUE 'B'.
  7548         16  PY-AR-FLAG                   PIC X.
  7549             88  PY-AR-CYCLE                  VALUE 'C'.
  7550             88  PY-AR-MONTH-END              VALUE 'M'.
  7551         16  PY-AR-DATE                   PIC XX.
  7552
  7553     12  PY-GL-CODES.
  7554         16  PY-GL-DB                     PIC X(14).
  7555         16  PY-GL-CR                     PIC X(14).
  7556         16  PY-GL-FLAG                   PIC X.
  7557         16  PY-GL-DATE                   PIC XX.
  7558
  7559     12  PY-CANCEL-FEE-FLAG               PIC X(2).
  7560     12  FILLER                           PIC X(3).
  7561******************************************************************
  7562*                                COPY ERCCNOT.
  7563******************************************************************
  7564*                                                                *
  7565*                            ERCCNOT                             *
  7566*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7567*                            VMOD=2.003                          *
  7568*                                                                *
  7569*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 139
* EL6311.cbl
  7570*                                                                *
  7571*        FILE TYPE= VSAM,KSDS                                    *
  7572*        RECORD SIZE = 150    RECFORM = FIXED                    *
  7573*                                                                *
  7574*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  7575*                                                                *
  7576*        LOG = YES                                               *
  7577*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7578*                                                                *
  7579******************************************************************
  7580*                   C H A N G E   L O G
  7581*
  7582* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7583*-----------------------------------------------------------------
  7584*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7585* EFFECTIVE    NUMBER
  7586*-----------------------------------------------------------------
  7587* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  7588******************************************************************
  7589
  7590 01  CERT-NOTE-FILE.
  7591     12  CZ-RECORD-ID                PIC  XX.
  7592         88  VALID-CZ-ID                  VALUE 'CZ'.
  7593
  7594     12  CZ-CONTROL-PRIMARY.
  7595         16  CZ-COMPANY-CD           PIC X.
  7596         16  CZ-CARRIER              PIC X.
  7597         16  CZ-GROUPING.
  7598             20 CZ-GROUPING-PREFIX   PIC XXX.
  7599             20 CZ-GROUPING-PRIME    PIC XXX.
  7600         16  CZ-STATE                PIC XX.
  7601         16  CZ-ACCOUNT.
  7602             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  7603             20 CZ-ACCOUNT-PRIME     PIC X(6).
  7604         16  CZ-CERT-EFF-DT          PIC XX.
  7605         16  CZ-CERT-NO.
  7606             20  CZ-CERT-PRIME       PIC X(10).
  7607             20  CZ-CERT-SFX         PIC X.
  7608         16  CZ-RECORD-TYPE          PIC X.
  7609             88  CERT-NOTE           VALUE '1'.
  7610             88  CLAIM-CERT-NOTE     VALUE '2'.
  7611         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  7612
  7613     12  CZ-LAST-MAINT-DT            PIC XX.
  7614     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  7615     12  CZ-LAST-MAINT-USER          PIC X(4).
  7616
  7617     12  CZ-NOTE-INFORMATION.
  7618         16  CZ-NOTE                 PIC X(63).
  7619         16  FILLER                  PIC X(39).
  7620******************************************************************
  7621*                                COPY ELCMSTR.
  7622******************************************************************
  7623*                                                                *
  7624*                            ELCMSTR.                            *
  7625*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7626*                            VMOD=2.012                          *
  7627*                                                                *
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 140
* EL6311.cbl
  7628*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  7629*                                                                *
  7630*   FILE TYPE = VSAM,KSDS                                        *
  7631*   RECORD SIZE = 350  RECFORM = FIXED                           *
  7632*                                                                *
  7633*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  7634*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  7635*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  7636*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  7637*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  7638*                                                 RKP=75,LEN=21  *
  7639*                                                                *
  7640*   **** NOTE ****                                               *
  7641*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  7642*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  7643*                                                                *
  7644*   LOG = YES                                                    *
  7645*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7646******************************************************************
  7647*                   C H A N G E   L O G
  7648*
  7649* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7650*-----------------------------------------------------------------
  7651*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7652* EFFECTIVE    NUMBER
  7653*-----------------------------------------------------------------
  7654* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  7655* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  7656* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  7657* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7658* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  7659* 081817    2016100700001  TANA  ADD NBR OF EXTENSIONS
  7660* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  7661******************************************************************
  7662 01  CLAIM-MASTER.
  7663     12  CL-RECORD-ID                PIC XX.
  7664         88  VALID-CL-ID         VALUE 'CL'.
  7665
  7666     12  CL-CONTROL-PRIMARY.
  7667         16  CL-COMPANY-CD           PIC X.
  7668         16  CL-CARRIER              PIC X.
  7669         16  CL-CLAIM-NO             PIC X(7).
  7670         16  CL-CERT-NO.
  7671             20  CL-CERT-PRIME       PIC X(10).
  7672             20  CL-CERT-SFX         PIC X.
  7673
  7674     12  CL-CONTROL-BY-NAME.
  7675         16  CL-COMPANY-CD-A1        PIC X.
  7676         16  CL-INSURED-LAST-NAME    PIC X(15).
  7677         16  CL-INSURED-NAME.
  7678             20  CL-INSURED-1ST-NAME PIC X(12).
  7679             20  CL-INSURED-MID-INIT PIC X.
  7680
  7681     12  CL-CONTROL-BY-SSN.
  7682         16  CL-COMPANY-CD-A2        PIC X.
  7683         16  CL-SOC-SEC-NO.
  7684             20  CL-SSN-STATE        PIC XX.
  7685             20  CL-SSN-ACCOUNT      PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 141
* EL6311.cbl
  7686             20  CL-SSN-LN3          PIC X(3).
  7687
  7688     12  CL-CONTROL-BY-CERT-NO.
  7689         16  CL-COMPANY-CD-A4        PIC X.
  7690         16  CL-CERT-NO-A4.
  7691             20  CL-CERT-A4-PRIME    PIC X(10).
  7692             20  CL-CERT-A4-SFX      PIC X.
  7693
  7694     12  CL-CONTROL-BY-CCN.
  7695         16  CL-COMPANY-CD-A5        PIC X.
  7696         16  CL-CCN-A5.
  7697             20  CL-CCN.
  7698                 24  CL-CCN-PREFIX-A5 PIC X(4).
  7699                 24  CL-CCN-PRIME-A5 PIC X(12).
  7700             20  CL-CCN-FILLER-A5    PIC X(4).
  7701
  7702     12  CL-INSURED-PROFILE-DATA.
  7703         16  CL-INSURED-BIRTH-DT     PIC XX.
  7704         16  CL-INSURED-SEX-CD       PIC X.
  7705             88  INSURED-IS-MALE        VALUE 'M'.
  7706             88  INSURED-IS-FEMALE      VALUE 'F'.
  7707             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  7708         16  CL-INSURED-OCC-CD       PIC X(6).
  7709         16  FILLER                  PIC X(5).
  7710
  7711     12  CL-PROCESSING-INFO.
  7712         16  CL-PROCESSOR-ID         PIC X(4).
  7713         16  CL-CLAIM-STATUS         PIC X.
  7714             88  CLAIM-IS-OPEN          VALUE 'O'.
  7715             88  CLAIM-IS-CLOSED        VALUE 'C'.
  7716         16  CL-CLAIM-TYPE           PIC X.
  7717*            88  AH-CLAIM               VALUE 'A'.
  7718*            88  LIFE-CLAIM             VALUE 'L'.
  7719*            88  PROPERTY-CLAIM         VALUE 'P'.
  7720*            88  IUI-CLAIM              VALUE 'I'.
  7721*            88  GAP-CLAIM              VALUE 'G'.
  7722*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  7723*            88  OTHER-CLAIM            VALUE 'O'.
  7724         16  CL-CLAIM-PREM-TYPE      PIC X.
  7725             88  SINGLE-PREMIUM         VALUE '1'.
  7726             88  O-B-COVERAGE           VALUE '2'.
  7727             88  OPEN-END-COVERAGE      VALUE '3'.
  7728         16  CL-INCURRED-DT          PIC XX.
  7729         16  CL-REPORTED-DT          PIC XX.
  7730         16  CL-FILE-ESTABLISH-DT    PIC XX.
  7731         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  7732         16  CL-LAST-PMT-DT          PIC XX.
  7733         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  7734         16  CL-PAID-THRU-DT         PIC XX.
  7735         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  7736         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  7737         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  7738         16  CL-PMT-CALC-METHOD      PIC X.
  7739             88  CL-360-DAY-YR          VALUE '1'.
  7740             88  CL-365-DAY-YR          VALUE '2'.
  7741             88  CL-FULL-MONTHS         VALUE '3'.
  7742         16  CL-CAUSE-CD             PIC X(6).
  7743
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 142
* EL6311.cbl
  7744         16  CL-PRIME-CERT-NO.
  7745             20  CL-PRIME-CERT-PRIME PIC X(10).
  7746             20  CL-PRIME-CERT-SFX   PIC X.
  7747
  7748         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  7749             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  7750             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  7751
  7752         16  CL-MICROFILM-NO         PIC X(10).
  7753         16  FILLER REDEFINES CL-MICROFILM-NO.
  7754             20  CL-BENEFIT-PERIOD   PIC 99.
  7755             20  FILLER              PIC X(8).
  7756         16  CL-PROG-FORM-TYPE       PIC X.
  7757         16  CL-LAST-ADD-ON-DT       PIC XX.
  7758
  7759         16  CL-LAST-REOPEN-DT       PIC XX.
  7760         16  CL-LAST-CLOSE-DT        PIC XX.
  7761         16  CL-LAST-CLOSE-REASON    PIC X(01).
  7762             88  FINAL-PAID             VALUE '1'.
  7763             88  CLAIM-DENIED           VALUE '2'.
  7764             88  AUTO-CLOSE             VALUE '3'.
  7765             88  MANUAL-CLOSE           VALUE '4'.
  7766             88  BENEFITS-CHANGED       VALUE 'C'.
  7767             88  SETUP-ERRORS           VALUE 'E'.
  7768         16  CL-ASSOC-CERT-SEQU      PIC S99.
  7769         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  7770         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  7771             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  7772         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  7773         16  FILLER                  PIC X.
  7774
  7775     12  CL-CERTIFICATE-DATA.
  7776         16  CL-CERT-ORIGIN          PIC X.
  7777             88  CERT-WAS-ONLINE        VALUE '1'.
  7778             88  CERT-WAS-CREATED       VALUE '2'.
  7779             88  COVERAGE-WAS-ADDED     VALUE '3'.
  7780         16  CL-CERT-KEY-DATA.
  7781             20  CL-CERT-CARRIER     PIC X.
  7782             20  CL-CERT-GROUPING    PIC X(6).
  7783             20  CL-CERT-STATE       PIC XX.
  7784             20  CL-CERT-ACCOUNT.
  7785                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  7786                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  7787             20  CL-CERT-EFF-DT      PIC XX.
  7788
  7789     12  CL-STATUS-CONTROLS.
  7790         16  CL-PRIORITY-CD          PIC X.
  7791             88  CONFIDENTIAL-DATA      VALUE '8'.
  7792             88  HIGHEST-PRIORITY       VALUE '9'.
  7793         16  CL-SUPV-ATTN-CD         PIC X.
  7794             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  7795             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  7796         16  CL-PURGED-DT            PIC XX.
  7797         16  CL-RESTORED-DT          PIC XX.
  7798         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  7799         16  CL-NEXT-RESEND-DT       PIC XX.
  7800         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  7801         16  CL-CRITICAL-PERIOD      PIC 99.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 143
* EL6311.cbl
  7802*        16  FILLER                  PIC XX.
  7803         16  CL-LAST-MAINT-DT        PIC XX.
  7804         16  CL-LAST-MAINT-USER      PIC X(4).
  7805         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  7806         16  CL-LAST-MAINT-TYPE      PIC X.
  7807             88  CLAIM-SET-UP           VALUE ' '.
  7808             88  PAYMENT-MADE           VALUE '1'.
  7809             88  LETTER-SENT            VALUE '2'.
  7810             88  MASTER-WAS-ALTERED     VALUE '3'.
  7811             88  MASTER-WAS-RESTORED    VALUE '4'.
  7812             88  INCURRED-DATE-CHANGED  VALUE '5'.
  7813             88  FILE-CONVERTED         VALUE '6'.
  7814             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  7815             88  ERROR-CORRECTION       VALUE 'E'.
  7816         16  CL-RELATED-CLAIM-NO     PIC X(7).
  7817         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  7818         16  CL-BENEFICIARY          PIC X(10).
  7819         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  7820         16  CL-DENIAL-TYPE          PIC X.
  7821             88  CL-TYPE-DENIAL          VALUE '1'.
  7822             88  CL-TYPE-RESCISSION      VALUE '2'.
  7823             88  CL-TYPE-REFORMATION     VALUE '3'.
  7824             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  7825             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  7826         16  CL-NO-OF-EXTENSIONS     PIC 99.
  7827         16  filler                  pic x(3).
  7828*        16  CL-CRIT-PER-RECURRENT   PIC X.
  7829*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  7830*        16  CL-RTW-DT               PIC XX.
  7831
  7832     12  CL-TRAILER-CONTROLS.
  7833         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  7834             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  7835             88  CL-LAST-TRL-AVAIL      VALUE +100.
  7836             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  7837         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  7838         16  FILLER                  PIC XX.
  7839         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  7840         16  CL-ADDRESS-TRAILER-CNT.
  7841             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  7842                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  7843             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  7844                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  7845             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  7846                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  7847             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  7848                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  7849             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  7850                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  7851             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  7852                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  7853             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  7854                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  7855
  7856     12  CL-CV-REFERENCE-NO.
  7857         16  CL-CV-REFNO-PRIME       PIC X(18).
  7858         16  CL-CV-REFNO-SFX         PIC XX.
  7859
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 144
* EL6311.cbl
  7860     12  CL-FILE-LOCATION            PIC X(4).
  7861
  7862     12  CL-PROCESS-ERRORS.
  7863         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  7864             88  NO-FATAL-ERRORS        VALUE ZERO.
  7865         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  7866             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  7867
  7868     12  CL-PRODUCT-CD               PIC X.
  7869
  7870     12  CL-CURRENT-KEY-DATA.
  7871         16  CL-CURRENT-CARRIER      PIC X.
  7872         16  CL-CURRENT-GROUPING     PIC X(6).
  7873         16  CL-CURRENT-STATE        PIC XX.
  7874         16  CL-CURRENT-ACCOUNT      PIC X(10).
  7875
  7876     12  CL-ASSOCIATES               PIC X.
  7877         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  7878         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  7879         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  7880         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  7881
  7882     12  CL-ACTIVITY-CODE            PIC 99.
  7883     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  7884     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  7885
  7886     12  CL-LAPSE-REPORT-CODE        PIC 9.
  7887     12  CL-LAG-REPORT-CODE          PIC 9.
  7888     12  CL-LOAN-TYPE                PIC XX.
  7889     12  CL-LEGAL-STATE              PIC XX.
  7890
  7891     12  CL-YESNOSW                  PIC X.
  7892     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  7893         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  7894         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  7895         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  7896     12  cl-insured-type             pic x.
  7897         88  cl-claim-on-primary         value 'P'.
  7898         88  cl-claim-on-co-borrower     value 'C'.
  7899     12  cl-benefit-expiration-dt    PIC XX.
  7900*                                COPY ERCENDT.
  7901******************************************************************
  7902*                                                                *
  7903*                                                                *
  7904*                            ERCENDT.                            *
  7905*                            VMOD=2.001                          *
  7906*                                                                *
  7907*   FILE DESCRIPTION = ENDORSEMENT FILE                          *
  7908*                                                                *
  7909*   FILE TYPE = VSAM,KSDS                                        *
  7910*   RECORD SIZE = 579  RECFORM = FIXED                           *
  7911*                                                                *
  7912*   BASE CLUSTER = ERENDT                         RKP=02,LEN=36  *
  7913*       ALTERNATE PATH1 = ERENDT2 (BY ARCH NO)    RKP=38,LEN=05  *
  7914*                                                                *
  7915*   LOG = NO                                                     *
  7916*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7917******************************************************************
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 145
* EL6311.cbl
  7918*-----------------------------------------------------------------
  7919*                   C H A N G E   L O G
  7920*
  7921* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7922*-----------------------------------------------------------------
  7923*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7924* EFFECTIVE    NUMBER
  7925*-----------------------------------------------------------------
  7926* 052307    2006052600001  AJRA  ADDED FLAG FOR CANCELS ON CERTS
  7927*                                WITH OPEN CLAIMS
  7928* 072312    2011022800001  AJRA  ADDED BATCH NUMBER
  7929* 110612    2012101700002  AJRA  ADD NEW FIELDS
  7930* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7931* 010616  CR2015082000001  PEMA  ADD ENDORSEMENT CHECK PROCESSING
  7932*-----------------------------------------------------------------
  7933 01  ENDORSEMENT-RECORD.
  7934     12  EN-RECORD-ID                PIC XX.
  7935         88  VALID-EN-ID                VALUE 'EN'.
  7936     12  EN-CONTROL-PRIMARY.
  7937         16  EN-COMPANY-CD           PIC X.
  7938         16  EN-CARRIER              PIC X.
  7939         16  EN-GROUPING             PIC X(6).
  7940         16  EN-STATE                PIC XX.
  7941         16  EN-ACCOUNT              PIC X(10).
  7942         16  EN-CERT-EFF-DT          PIC XX.
  7943         16  EN-CERT-NO.
  7944             20  EN-CERT-PRIME       PIC X(10).
  7945             20  EN-CERT-SFX         PIC X.
  7946         16  EN-REC-TYPE             PIC X.
  7947             88  EN-ISSUE               VALUE 'I'.
  7948             88  EN-CANCELLATION        VALUE 'C'.
  7949         16  EN-SEQ-NO               PIC 9(04) BINARY.
  7950     12  EN-CONTROL-BY-ARCH-NO.
  7951         16  EN-COMPANY-CD-A1              PIC X.
  7952         16  EN-ARCHIVE-NO                 PIC 9(8) BINARY.
  7953     12  EN-LAST-MAINT-DT            PIC XX.
  7954     12  EN-LAST-MAINT-BY            PIC X(4).
  7955     12  EN-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  7956     12  EN-ENDORSEMENT-RECORD       PIC X(329).
  7957     12  EN-ISSUE-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  7958         16  EN-INS-ORIG-LAST-NAME   PIC X(15).
  7959         16  EN-INS-ORIG-FIRST-NAME  PIC X(10).
  7960         16  EN-INS-ORIG-MIDDLE-INIT PIC X.
  7961         16  EN-INS-ORIG-AGE         PIC S999     COMP-3.
  7962         16  EN-JNT-ORIG-LAST-NAME   PIC X(15).
  7963         16  EN-JNT-ORIG-FIRST-NAME  PIC X(10).
  7964         16  EN-JNT-ORIG-MIDDLE-INIT PIC X.
  7965         16  EN-JNT-ORIG-AGE         PIC S999     COMP-3.
  7966         16  EN-LF-ORIG-BENCD        PIC XX.
  7967         16  EN-LF-ORIG-TERM         PIC S999      COMP-3.
  7968         16  EN-LF-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  7969         16  EN-LF-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  7970         16  EN-LF-ORIG-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
  7971         16  EN-LF-ORIG-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
  7972         16  EN-LF-ORIG-EXP-DT       PIC XX.
  7973*        16  EN-LF-ORIG-COV-TYPE     PIC X(10).
  7974         16  EN-ORIG-CRED-BENE       PIC X(25).
  7975         16  EN-LF-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 146
* EL6311.cbl
  7976         16  FILLER                  PIC X.
  7977         16  EN-AH-ORIG-BENCD        PIC XX.
  7978         16  EN-AH-ORIG-TERM         PIC S999      COMP-3.
  7979         16  EN-AH-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  7980         16  EN-AH-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  7981         16  EN-AH-ORIG-EXP-DT       PIC XX.
  7982*        16  EN-AH-ORIG-COV-TYPE     PIC X(10).
  7983*        16  EN-AH-ORIG-WAIT-PER     PIC 99.
  7984         16  EN-AH-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  7985         16  F                       PIC X(09).
  7986         16  EN-AH-ORIG-CP           PIC 99.
  7987         16  EN-INS-NEW-LAST-NAME    PIC X(15).
  7988         16  EN-INS-NEW-FIRST-NAME   PIC X(10).
  7989         16  EN-INS-NEW-MIDDLE-INIT  PIC X.
  7990         16  EN-INS-NEW-AGE          PIC S999     COMP-3.
  7991         16  EN-JNT-NEW-LAST-NAME    PIC X(15).
  7992         16  EN-JNT-NEW-FIRST-NAME   PIC X(10).
  7993         16  EN-JNT-NEW-MIDDLE-INIT  PIC X.
  7994         16  EN-JNT-NEW-AGE          PIC S999     COMP-3.
  7995         16  EN-LF-NEW-BENCD         PIC XX.
  7996         16  EN-LF-NEW-TERM          PIC S999      COMP-3.
  7997         16  EN-LF-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  7998         16  EN-LF-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  7999         16  EN-LF-NEW-ALT-BEN-AMT   PIC S9(9)V99  COMP-3.
  8000         16  EN-LF-NEW-ALT-PRM-AMT   PIC S9(7)V99  COMP-3.
  8001         16  EN-LF-NEW-EXP-DT        PIC XX.
  8002         16  EN-NEW-CRED-BENE        PIC X(25).
  8003         16  EN-LF-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  8004         16  FILLER                  PIC X.
  8005         16  EN-AH-NEW-BENCD         PIC XX.
  8006         16  EN-AH-NEW-TERM          PIC S999      COMP-3.
  8007         16  EN-AH-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  8008         16  EN-AH-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  8009         16  EN-AH-NEW-EXP-DT        PIC XX.
  8010*        16  EN-AH-NEW-COV-TYPE      PIC X(10).
  8011*        16  EN-AH-NEW-WAIT-PER      PIC 99.
  8012*        16  F                       PIC X(12).
  8013         16  EN-AH-NEW-CP            PIC 99.
  8014         16  EN-SIG-SW               PIC X.
  8015         16  EN-AH-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  8016         16  EN-INS-ORIG-AGE-DEF-FLAG PIC X.
  8017         16  EN-JNT-ORIG-AGE-DEF-FLAG PIC X.
  8018         16  EN-INS-NEW-AGE-DEF-FLAG PIC X.
  8019         16  EN-JNT-NEW-AGE-DEF-FLAG PIC X.
  8020         16  FILLER                  PIC X(33).
  8021     12  EN-CANCEL-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  8022         16  EN-LF-ORIG-REF-DT       PIC XX.
  8023         16  EN-LF-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  8024         16  EN-AH-ORIG-REF-DT       PIC XX.
  8025         16  EN-AH-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  8026         16  EN-LF-NEW-REF-DT        PIC XX.
  8027         16  EN-LF-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  8028         16  EN-AH-NEW-REF-DT        PIC XX.
  8029         16  EN-AH-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  8030         16  EN-FLAG-CERT            PIC X.
  8031         16  EN-INS-LAST-NAME        PIC X(15).
  8032         16  EN-INS-FIRST-NAME       PIC X(10).
  8033         16  EN-INS-MIDDLE-INIT      PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 147
* EL6311.cbl
  8034         16  EN-LF-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  8035         16  EN-AH-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  8036         16  EN-LF-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  8037         16  EN-AH-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  8038         16  FILLER                  PIC X(262).
  8039     12  EN-MONEY-SW             PIC X.
  8040     12  EN-HEALTH-APP           PIC X.
  8041     12  EN-VOUCHER-SW           PIC X.
  8042     12  EN-PAYEE                PIC X(14).
  8043     12  EN-INPUT-DT             PIC XX.
  8044     12  EN-PROCESS-DT           PIC XX.
  8045     12  EN-LF-COMMISSION        PIC SV9(5)    COMP-3.
  8046     12  EN-AH-COMMISSION        PIC SV9(5)    COMP-3.
  8047     12  EN-REASON-CODES.
  8048         16  F OCCURS 12.
  8049             20  EN-REASON-CODE  PIC X(4).
  8050     12  EN-TEMPLATE-USED        PIC X(8).
  8051     12  EN-DOCU-TYPE            PIC X.
  8052         88  EN-VERI-DOCU          VALUE 'V'.
  8053         88  EN-GCE-DOCU           VALUE 'G'.
  8054         88  EN-CANC-DOCU          VALUE 'C'.
  8055     12  EN-COMMENTS1            PIC X(13).
  8056     12  EN-COMMENTS2            PIC X(70).
  8057     12  EN-COMM-CHGBK           PIC X.
  8058         88  EN-DO-NOT-CHG-ACCT    VALUE 'N'.
  8059         88  EN-CHG-ACCT           VALUE 'Y'.
  8060     12  EN-CSO-PORTION          PIC S9(5)V99  COMP-3.
  8061     12  EN-ACCT-PORTION         PIC S9(5)V99  COMP-3.
  8062     12  EN-BATCH-NUMBER         PIC X(6).
  8063     12  EN-ACCT-SUMM            PIC X.
  8064     12  EN-CSO-SUMM             PIC X.
  8065     12  en-check-type           pic x.
  8066     12  FILLER                  PIC X(12).
  8067******************************************************************
  8068*                                COPY ELCCRTT.
  8069******************************************************************
  8070*                                                                *
  8071*                            ELCCRTT.                            *
  8072*                                                                *
  8073*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  8074*                                                                *
  8075*   FILE TYPE = VSAM,KSDS                                        *
  8076*   RECORD SIZE = 552  RECFORM = FIXED                           *
  8077*                                                                *
  8078*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  8079*                                                                *
  8080*   LOG = YES                                                    *
  8081*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  8082******************************************************************
  8083*                   C H A N G E   L O G
  8084*
  8085* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  8086*-----------------------------------------------------------------
  8087*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  8088* EFFECTIVE    NUMBER
  8089*-----------------------------------------------------------------
  8090* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  8091* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 148
* EL6311.cbl
  8092* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  8093* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  8094* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  8095* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  8096* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  8097* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  8098* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  8099* 012918  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
  8100* 091318  CR2018073000001  PEMA  ADD Refund methods
  8101* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  8102******************************************************************
  8103
  8104 01  CERTIFICATE-TRAILERS.
  8105     12  CS-RECORD-ID                      PIC XX.
  8106         88  VALID-CS-ID                      VALUE 'CS'.
  8107
  8108     12  CS-CONTROL-PRIMARY.
  8109         16  CS-COMPANY-CD                 PIC X.
  8110         16  CS-CARRIER                    PIC X.
  8111         16  CS-GROUPING                   PIC X(6).
  8112         16  CS-STATE                      PIC XX.
  8113         16  CS-ACCOUNT                    PIC X(10).
  8114         16  CS-CERT-EFF-DT                PIC XX.
  8115         16  CS-CERT-NO.
  8116             20  CS-CERT-PRIME             PIC X(10).
  8117             20  CS-CERT-SFX               PIC X.
  8118         16  CS-TRAILER-TYPE               PIC X.
  8119             88  COMM-TRLR           VALUE 'A'.
  8120             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  8121             88  CERT-DATA-TRLR      VALUE 'C'.
  8122
  8123     12  CS-DATA-AREA                      PIC X(516).
  8124
  8125     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  8126         16  CS-BANK-COMMISSION-AREA.
  8127             20  CS-BANK-COMMS       OCCURS 10.
  8128                 24  CS-AGT                PIC X(10).
  8129                 24  CS-COM-TYP            PIC X.
  8130                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  8131                 24  CS-RECALC-LV-INDIC    PIC X.
  8132                 24  FILLER                PIC X(10).
  8133         16  FILLER                        PIC X(256).
  8134
  8135     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  8136****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  8137         16  CS-MB-CLAIM-DATA OCCURS 24.
  8138             20  CS-CLAIM-NO               PIC X(7).
  8139             20  CS-CLAIM-TYPE             PIC X.
  8140                 88  CS-AH-CLM               VALUE 'A'.
  8141                 88  CS-IU-CLM               VALUE 'I'.
  8142                 88  CS-GP-CLM               VALUE 'G'.
  8143                 88  CS-LF-CLM               VALUE 'L'.
  8144                 88  CS-PR-CLM               VALUE 'P'.
  8145                 88  CS-FL-CLM               VALUE 'F'.
  8146                 88  CS-OT-CLM               VALUE 'O'.
  8147             20  CS-INSURED-TYPE           PIC X.
  8148                 88  CS-PRIM-INSURED          VALUE 'P'.
  8149                 88  CS-CO-BORROWER           VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 149
* EL6311.cbl
  8150             20  CS-BENEFIT-PERIOD         PIC 99.
  8151             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  8152             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  8153             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  8154         16  FILLER                        PIC X(12).
  8155     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  8156         16  CS-VIN-NUMBER                 PIC X(17).
  8157         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  8158         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  8159         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  8160         16  cs-agent-name.
  8161             20  cs-agent-fname            pic x(20).
  8162             20  cs-agent-mi               pic x.
  8163             20  cs-agent-lname            pic x(25).
  8164         16  cs-license-no                 pic x(15).
  8165         16  cs-npn-number                 pic x(10).
  8166         16  cs-agent-edit-status          pic x.
  8167             88  cs-ae-refer-to-manager      value 'M'.
  8168             88  cs-ae-cover-sheet           value 'C'.
  8169             88  cs-ae-sig-form              value 'S'.
  8170             88  cs-ae-verified              value 'V'.
  8171             88  cs-unidentified-signature   value 'U'.
  8172             88  cs-cert-returned            value 'R'.
  8173             88  cs-accept-no-commission     value 'N'.
  8174         16  cs-year                       pic 9999.
  8175         16  cs-make                       pic x(20).
  8176         16  cs-model                      pic x(20).
  8177         16  cs-future                     pic x(20).
  8178         16  cs-vehicle-odometer           pic s9(7) comp-3.
  8179         16  cs-claim-verification-status  pic x.
  8180             88  cs-clm-ver-eligible         value 'A'.
  8181             88  cs-clm-ver-partial-elig     value 'B'.
  8182             88  cs-clm-ver-not-eligible     value 'C'.
  8183             88  cs-clm-ver-not-elig-opn-clm value 'D'.
  8184             88  cs-clm-ver-not-part-elig-rw value 'E'.
  8185             88  cs-clm-ver-ND-CERT          value 'F'.
  8186             88  cs-clm-ver-spec-other       value 'G'.
  8187             88  cs-clam-ver-pratial-corrected
  8188                                             value 'H'.
  8189             88  cs-clm-ver-no-matches       value 'I'.
  8190             88  cs-clm-ver-not-elig-corrected
  8191                                             value 'J'.
  8192             88  cs-clm-ver-needs-review     value 'R'.
  8193             88  cs-clm-ver-sent-to-claims   value 'W'.
  8194         16  CS-LF-REFUND-METHOD           PIC X.
  8195         16  CS-AH-REFUND-METHOD           PIC X.
  8196         16  FILLER                        PIC X(353). *> was 420
  8197*        16  FILLER                        PIC X(496).
  8198*                                COPY ERCCHEK.
  8199******************************************************************
  8200*                                                                *
  8201*                                                                *
  8202*                            ERCCHEK                             *
  8203*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  8204*                            VMOD=2.008                          *
  8205*                                                                *
  8206*   FILE DESCRIPTION = CHECK RECORDS                             *
  8207*                                                                *
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 150
* EL6311.cbl
  8208*   FILE TYPE = VSAM,KSDS                                        *
  8209*   RECORD SIZE = 600    RECFORM = FIXED                         *
  8210*                                                                *
  8211*   BASE CLUSTER NAME = ERCHEK             RKP=2,LEN=35          *
  8212*       ALTERNATE INDEX = NONE                                   *
  8213*                                                                *
  8214*   LOG = YES                                                    *
  8215*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  8216******************************************************************
  8217*                   C H A N G E   L O G
  8218*
  8219* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  8220*-----------------------------------------------------------------
  8221*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  8222* EFFECTIVE    NUMBER
  8223*-----------------------------------------------------------------
  8224* 021414    2003053000001  PEMA  changes for auto chk request
  8225******************************************************************
  8226 01  CHECK-RECORDS.
  8227     12  CH-RECORD-ID                      PIC XX.
  8228         88  VALID-CH-ID                      VALUE 'CH'.
  8229
  8230     12  CH-CONTROL-PRIMARY.
  8231         16  CH-COMPANY-CD                 PIC X.
  8232         16  CH-CARRIER                    PIC X.
  8233         16  CH-GROUPING                   PIC X(6).
  8234         16  CH-STATE                      PIC XX.
  8235         16  CH-ACCOUNT                    PIC X(10).
  8236         16  CH-CERT-EFF-DT                PIC XX.
  8237         16  CH-CERT-NO.
  8238             20  CH-CERT-PRIME             PIC X(10).
  8239             20  CH-CERT-SFX               PIC X.
  8240         16  CH-SEQUENCE-NO                PIC S9(4)     COMP.
  8241
  8242     12  CH-RECORDED-DT                    PIC XX.
  8243     12  CH-RECORDED-BY                    PIC X(4).
  8244     12  CH-LAST-MAINT-HHMMSS              PIC S9(6)     COMP-3.
  8245
  8246     12  CH-AMOUNT-PAID                    PIC S9(7)V99  COMP-3.
  8247     12  CH-CHECK-NO                       PIC X(7).
  8248     12  CH-REASON-FOR-CHECK               PIC X(25).
  8249     12  CH-CHECK-WRITTEN-DT               PIC XX.
  8250     12  FILLER                            PIC X.
  8251
  8252     12  CH-PAYEE-INFO.
  8253         16  CH-PAYEE-NAME-1               PIC X(30).
  8254         16  CH-PAYEE-NAME-2               PIC X(30).
  8255         16  CH-PAYEE-ADDRESS-1            PIC X(30).
  8256         16  CH-PAYEE-ADDRESS-2            PIC X(30).
  8257         16  CH-PAYEE-CITY-ST.
  8258             20  CH-PAYEE-CITY             PIC X(28).
  8259             20  CH-PAYEE-STATE            PIC XX.
  8260         16  CH-PAYEE-ZIP-CODE.
  8261             20  CH-PAYEE-ZIP.
  8262                 24  CH-ZIP-PRI-1ST        PIC X.
  8263                     88  CH-CANADIAN-POST-CODE
  8264                                           VALUES 'A' THRU 'Z'.
  8265                 24  FILLER                PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 151
* EL6311.cbl
  8266             20  CH-PAYEE-ZIP-EXT          PIC X(4).
  8267         16  CH-CANADIAN-POSTAL-CODE REDEFINES CH-PAYEE-ZIP-CODE.
  8268             20  CH-CAN-POSTAL-1           PIC XXX.
  8269             20  CH-CAN-POSTAL-2           PIC XXX.
  8270             20  FILLER                    PIC XXX.
  8271
  8272     12  CH-CHECK-STUB-TEXT.
  8273         16  CH-STUB-LINE-1                PIC X(30).
  8274         16  CH-TEXT-LINE-1                PIC X(50).
  8275         16  CH-TEXT-LINE-2                PIC X(50).
  8276         16  CH-TEXT-LINE-3                PIC X(40).
  8277     12  CH-RETURN-TO                      PIC X(30).
  8278
  8279     12  CH-COMPENSATION-CONTROL.
  8280         16  CH-COMP-CARRIER               PIC X.
  8281         16  CH-COMP-GROUPING              PIC X(6).
  8282         16  CH-COMP-FIN-RESP              PIC X(10).
  8283         16  CH-COMP-ACCOUNT               PIC X(10).
  8284
  8285     12  CH-CREDIT-SELECT-DT               PIC XX.
  8286     12  CH-CREDIT-ACCEPT-DT               PIC XX.
  8287     12  CH-PAYEE-CODE                     PIC X(6).
  8288
  8289     12  CH-VOID-DATA.
  8290         20  CH-VOID-DT                    PIC XX.
  8291         20  CH-VOID-BY                    PIC X(4).
  8292         20  CH-VOID-REASON                PIC X(25).
  8293
  8294     12  CH-APPROVAL-DATA.
  8295         20  CH-APPROVAL-DT                PIC XX.
  8296         20  CH-APPROVAL-STATUS            PIC X.
  8297             88  CH-IN-LIMBO                  VALUE ' '.
  8298             88  CH-APPROV-PENDING            VALUE 'P' '2'.
  8299             88  CH-APPROVED                  VALUE 'A'.
  8300             88  CH-DENIED                    VALUE 'D'.
  8301         20  CH-APPROVED-BY                PIC XXXX.
  8302     12  CH-CHECK-QUE-CONTROL              PIC S9(8)     COMP.
  8303             88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  8304     12  CH-CHECK-QUE-SEQUENCE             PIC S9(4)     COMP.
  8305
  8306     12  ch-released-dt                    pic xx.
  8307     12  ch-check-cashed-dt                pic xx.
  8308     12  FILLER                            PIC X.
  8309*    12  CH-CHECK-REFERENCE                PIC X(12).
  8310     12  CH-CHECK-ORIGIN-SW                PIC X.
  8311             88  CH-REFUND-CHECK              VALUE 'R'.
  8312             88  CH-MAINT-CHECK               VALUE 'M'.
  8313
  8314     12  CH-CANC-DT                        PIC XX.
  8315     12  CH-LF-REFUND                      PIC S9(7)V99  COMP-3.
  8316     12  CH-AH-REFUND                      PIC S9(7)V99  COMP-3.
  8317
  8318     12  CH-INSURED-NAME                   PIC X(28).
  8319
  8320     12  ch-released-by                    pic x(4).
  8321     12  ch-csr                            pic x(4).
  8322     12  ch-deduct-commission              pic x.
  8323         88  ch-deduct-comm                  value 'Y'.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 152
* EL6311.cbl
  8324         88  ch-do-not-deduct-comm           value 'N'.
  8325
  8326     12  FILLER                            PIC X(11).
  8327*    12  CH-LETTER-TABLE.
  8328*        16  CH-LETTERS OCCURS 3 TIMES
  8329*                       INDEXED BY CH-LT-NDX
  8330*                                          PIC X(04).
  8331
  8332     12  FILLER                            PIC X(07).
  8333
  8334 01  var                         pic x(30).
  8335 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA PENDING-BUSINESS
  8336                          CERTIFICATE-MASTER CERTIFICATE-NOTE
  8337                          PENDING-MAILING-DATA MAILING-DATA
  8338                          AR-REQUEST-RECORD LOAN-OFFICER-MASTER
  8339                          PENDING-PAY-ADJ CERT-NOTE-FILE
  8340                          CLAIM-MASTER ENDORSEMENT-RECORD
  8341                          CERTIFICATE-TRAILERS CHECK-RECORDS
  8342                          VAR.
  8343 0000-DFHEXIT SECTION.
  8344     MOVE '9#                    $   ' TO DFHEIV0.
  8345     MOVE 'EL6311' TO DFHEIV1.
  8346     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  8347
  8348     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  8349     MOVE EIBTRMID               TO QID-TERM.
  8350     MOVE 3                      TO EMI-NUMBER-OF-LINES.
  8351     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  8352     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  8353     MOVE 2                      TO EMI-SWITCH2.
  8354
  8355     move spaces to ws-kix-myenv
  8356     set P to address of KIXSYS
  8357     CALL "getenv" using by value P returning var-ptr
  8358     if var-ptr = null then
  8359        display ' kixsys not set '
  8360     else
  8361        set address of var to var-ptr
  8362        move 0 to env-var-len
  8363        inspect var tallying env-var-len
  8364          for characters before X'00'
  8365        unstring var (1:env-var-len) delimited by '/'
  8366           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  8367              WS-KIX-SYS
  8368        end-unstring
  8369     end-if
  8370     perform varying a1 from +1 by +1 until a1 > +10
  8371        if ws-kix-myenv (a1:1) = low-values or high-values
  8372           display ' found low or hi val '
  8373           move spaces to ws-kix-myenv (a1:1)
  8374        end-if
  8375     end-perform
  8376*    display ' env *' ws-kix-myenv '*'
  8377     IF EIBCALEN = 0
  8378         GO TO 8800-UNAUTHORIZED-ACCESS.
  8379
  8380     MOVE EIBDATE               TO DC-JULIAN-YYDDD.
  8381     MOVE '5'                   TO DC-OPTION-CODE.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 153
* EL6311.cbl
  8382     PERFORM 9700-DATE-LINK.
  8383     MOVE DC-GREG-DATE-1-EDIT   TO  WS-CURRENT-DT.
  8384     MOVE DC-BIN-DATE-1         TO  WS-CURRENT-BIN-DT.
  8385
  8386     MOVE PI-CR-MONTH-END-DT     TO DC-BIN-DATE-1.
  8387     MOVE SPACE                  TO DC-OPTION-CODE.
  8388     PERFORM 9700-DATE-LINK.
  8389     MOVE DC-GREG-DATE-1-EDIT    TO WS-MONTH-END-DT.
  8390     MOVE LOW-VALUES             TO EL631BI.
  8391
  8392
  8393* EXEC CICS HANDLE CONDITION
  8394*        PGMIDERR  (9600-PGMID-ERROR)
  8395*        ERROR     (9990-ABEND)
  8396*        INVREQ    (9990-ABEND)
  8397*        QIDERR    (0010-MAIN-LOGIC)
  8398*    END-EXEC.
  8399*    MOVE '"$L.8N                ! " #00008388' TO DFHEIV0
  8400     MOVE X'22244C2E384E202020202020' TO DFHEIV0(1:12)
  8401     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8402     MOVE X'2220233030303038333838' TO DFHEIV0(25:11)
  8403     CALL 'kxdfhei1' USING DFHEIV0
  8404     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8405
  8406
  8407     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  8408         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  8409             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  8410             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  8411             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  8412             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  8413             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  8414             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  8415             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  8416             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  8417
  8418             IF  PI-RETURN-TO-PROGRAM EQUAL 'EL631'
  8419                 PERFORM 6050-DELETE-TEMP-STORAGE THRU 6050-EXIT
  8420
  8421             ELSE
  8422                 NEXT SENTENCE
  8423
  8424         ELSE
  8425             IF PI-CALLING-PROGRAM = 'EL6315'
  8426                SET CALLED-FROM-6315 TO TRUE
  8427             END-IF
  8428             MOVE PI-CALLING-PROGRAM   TO PGM-NAME
  8429             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  8430             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  8431             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  8432             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  8433             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  8434             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  8435             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  8436             MOVE SPACES               TO PI-SAVED-PROGRAM-6
  8437             PERFORM 6050-RECOVER-TEMP-STORAGE THRU 6050-EXIT
  8438             MOVE LOW-VALUES TO EC-NEW-CERT EC-NEW-STATE
  8439             GO TO 3900-RE-DISPLAY-RECORD
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 154
* EL6311.cbl
  8440     ELSE
  8441         GO TO 0020-MAIN-LOGIC.
  8442
  8443 0010-MAIN-LOGIC.
  8444     MOVE 'Y'                    TO WS-FIRST-TIME-SW
  8445                                    WS-FIRST-ENTRY-SW.
  8446
  8447     MOVE ' '                    TO WS-CANCEL-LETTER-SW.
  8448
  8449     MOVE LOW-VALUES             TO EC-NEW-CERT
  8450                                    EC-NEW-STATE.
  8451
  8452     IF PI-DISPLAY-ORIGINAL-BATCH
  8453         NEXT SENTENCE
  8454     ELSE
  8455         IF ALL-OUT-OF-BAL   OR  ONLY-BATCH-HEADERS
  8456             GO TO 5000-BROWSE-BATCH-HEADERS.
  8457
  8458     IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  8459         GO TO 4100-BROWSE-PRIMARY-FORWARD.
  8460
  8461     IF PI-CSR-BROWSE
  8462        GO TO 4200-BROWSE-CSR-FORWARD.
  8463
  8464     IF PI-FILE-BROWSE
  8465         GO TO 4300-BROWSE-FILE-FORWARD.
  8466
  8467     GO TO 4000-BROWSE-DETAIL-FORWARD.
  8468
  8469 0020-MAIN-LOGIC.
  8470     IF EIBAID = DFHCLEAR
  8471         GO TO 9400-CLEAR.
  8472
  8473     MOVE LOW-VALUES             TO EC-NEW-CERT
  8474                                    EC-NEW-STATE.
  8475
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 155
* EL6311.cbl
  8477
  8478******************************************************************
  8479*                                                                *
  8480*              R E C E I V E   M A P                             *
  8481*                                                                *
  8482******************************************************************
  8483
  8484 0200-RECEIVE.
  8485     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  8486         MOVE ER-0008            TO EMI-ERROR
  8487         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8488         IF PI-MAP-NAME = EL631B
  8489             MOVE -1                 TO BMAINTL
  8490             GO TO 8200-SEND-DATAONLY
  8491         ELSE
  8492             IF PI-MAP-NAME = EL631C
  8493                 MOVE -1                 TO CMAINTL
  8494                 GO TO 8200-SEND-DATAONLY
  8495             ELSE
  8496                 IF PI-MAP-NAME = EL631D
  8497                     MOVE -1                 TO DPFENTRL
  8498                     GO TO 8200-SEND-DATAONLY.
  8499
  8500
  8501* EXEC CICS RECEIVE
  8502*        MAP      (PI-MAP-NAME)
  8503*        MAPSET   (MAPSET-EL6311S)
  8504*        INTO     (EL631BI)
  8505*    END-EXEC.
  8506     MOVE LENGTH OF
  8507      EL631BI
  8508       TO DFHEIV11
  8509*    MOVE '8"T I  L              ''   #00008488' TO DFHEIV0
  8510     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  8511     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8512     MOVE X'2020233030303038343838' TO DFHEIV0(25:11)
  8513     CALL 'kxdfhei1' USING DFHEIV0,
  8514           PI-MAP-NAME,
  8515           EL631BI,
  8516           DFHEIV11,
  8517           MAPSET-EL6311S,
  8518           DFHEIV99,
  8519           DFHEIV99
  8520     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8521
  8522
  8523******************************************************************
  8524*        TRANSFORM  UNDERLINE CHARACTERS TO SPACES               *
  8525******************************************************************
  8526
  8527     IF BTYPE-LEN (1) EQUAL +3
  8528        IF BTYPE (1) EQUAL ALL ' '
  8529            MOVE 'Y' TO WS-REMOVE-LF-SW.
  8530
  8531     IF BTYPE-LEN (2) EQUAL +3
  8532        IF BTYPE (2) EQUAL ALL ' '
  8533            MOVE 'Y' TO WS-REMOVE-AH-SW.
  8534
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 156
* EL6311.cbl
  8535     INSPECT EL631BI CONVERTING '_' TO ' '.
  8536
  8537     IF PI-MAP-NAME = EL631B
  8538         IF BPFENTRL GREATER THAN ZEROS
  8539             IF EIBAID NOT = DFHENTER
  8540                 MOVE ER-0004       TO EMI-ERROR
  8541                 MOVE -1            TO BPFENTRL
  8542                 MOVE AL-UNBOF      TO BPFENTRA
  8543                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8544                 GO TO 8200-SEND-DATAONLY
  8545             ELSE
  8546                 IF BPFENTRI NUMERIC AND
  8547                   (BPFENTRI GREATER 0 AND LESS 25)
  8548                     MOVE PF-VALUES (BPFENTRI) TO EIBAID
  8549                 ELSE
  8550                     MOVE ER-0029  TO EMI-ERROR
  8551                     MOVE AL-UNBON TO BPFENTRA
  8552                     MOVE -1       TO BPFENTRL
  8553                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8554                     GO TO 8200-SEND-DATAONLY
  8555         ELSE
  8556             NEXT SENTENCE
  8557     ELSE
  8558         IF PI-MAP-NAME = EL631C
  8559            IF CPFENTRL GREATER THAN ZEROS
  8560                IF EIBAID NOT = DFHENTER
  8561                 MOVE ER-0004         TO EMI-ERROR
  8562                 MOVE -1              TO CPFENTRL
  8563                 MOVE AL-UNBOF        TO CPFENTRA
  8564                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8565                 GO TO 8200-SEND-DATAONLY
  8566             ELSE
  8567                 IF CPFENTRI NUMERIC AND
  8568                   (CPFENTRI GREATER 0 AND LESS 25)
  8569                     MOVE PF-VALUES (CPFENTRI) TO EIBAID
  8570                 ELSE
  8571                     MOVE ER-0029      TO EMI-ERROR
  8572                     MOVE AL-UNBON     TO CPFENTRA
  8573                     MOVE -1           TO CPFENTRL
  8574                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8575                     GO TO 8200-SEND-DATAONLY
  8576         ELSE
  8577             NEXT SENTENCE
  8578     ELSE
  8579     IF PI-MAP-NAME = EL631D
  8580         IF DPFENTRL GREATER THAN ZEROS
  8581             IF EIBAID NOT = DFHENTER
  8582                 MOVE ER-0004         TO EMI-ERROR
  8583                 MOVE -1              TO DPFENTRL
  8584                 MOVE AL-UNBOF        TO DPFENTRA
  8585                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8586                 GO TO 8200-SEND-DATAONLY
  8587             ELSE
  8588                 IF DPFENTRI NUMERIC AND
  8589                   (DPFENTRI GREATER 0 AND LESS 25)
  8590                     MOVE PF-VALUES (DPFENTRI) TO EIBAID
  8591                 ELSE
  8592                     MOVE ER-0029      TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 157
* EL6311.cbl
  8593                     MOVE AL-UNBON     TO DPFENTRA
  8594                     MOVE -1           TO DPFENTRL
  8595                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8596                     GO TO 8200-SEND-DATAONLY.
  8597
  8598     IF EIBAID = DFHPF23
  8599         GO TO 8810-PF23.
  8600
  8601     IF EIBAID = DFHPF24
  8602         GO TO 9200-RETURN-MAIN-MENU.
  8603
  8604     IF EIBAID = DFHPF12
  8605         GO TO 9500-PF12.
  8606
  8607     IF PI-MAP-NAME = EL631B
  8608        GO TO 0300-CHECK-ISSUE-PF-KEYS.
  8609
  8610     IF PI-MAP-NAME = EL631C
  8611        GO TO 0400-CHECK-CANCEL-PF-KEYS.
  8612
  8613     IF PI-MAP-NAME = EL631D
  8614        GO TO 0500-CHECK-BATCH-PF-KEYS.
  8615
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 158
* EL6311.cbl
  8617
  8618******************************************************************
  8619*                                                                *
  8620*      ISSUE SCREEN PF KEY CHECKING                              *
  8621*                                                                *
  8622******************************************************************
  8623
  8624******************************************************************
  8625*                                                                *
  8626*      PF KEY FUNCTIONS:                                         *
  8627*                                                                *
  8628*      PF1  = BROWSE FORWARD                                     *
  8629*      PF2  = BROWSE BACKWARD                                    *
  8630*      PF3  = CERTIFICATE LOOKUP                                 *
  8631*      PF4  = DISPLAY BATCH HEADER                               *
  8632*      PF5  = ADD ISSUE  SCREEN                                  *
  8633*      PF6  = ADD CANCEL SCREEN                                  *
  8634*      PF7  = CERTIFICATE DISPLAY                                *
  8635*      PF8  = CERTIFICATE NOTES                                  *
  8636*      PF9  = EDIT CONTROL                                       *
  8637*      PF10 = DISPLAY LETTER SCREEN                              *
  8638*      PF11 = DISPLAY EXPANDED LIST OF ERRORS                    *
  8639*      PF12 = HELP SCREEN                                        *
  8640*      PF13 = CONTINUE ISSUE DISPLAY (SECOND SCREEN)             *
  8641*      PF14 = ACCOUNT MASTER                                     *
  8642*      PF15 = PROCESS CERT VERIFICATION OR GENERAL CHG ENDORSEMNT*
  8643*      PF16 = DISPLAY LETTER REVIEW                              *
  8644*                                                                *
  8645******************************************************************
  8646
  8647 0300-CHECK-ISSUE-PF-KEYS.
  8648     IF EIBAID = DFHPF9 AND PI-EDIT-SW NOT = '1'
  8649        MOVE ER-2337            TO EMI-ERROR
  8650        MOVE -1                  TO BMAINTL
  8651        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8652        GO TO 8200-SEND-DATAONLY.
  8653
  8654     IF EIBAID = DFHPF1
  8655        MOVE '0'                TO PI-EDIT-SW
  8656        IF PI-PRIMARY-BROWSE
  8657           GO TO 4100-BROWSE-PRIMARY-FORWARD
  8658        ELSE
  8659           IF PI-PRIMARY-WITH-SELECT
  8660              GO TO 4100-BROWSE-PRIMARY-FORWARD
  8661           ELSE
  8662              IF PI-FILE-BROWSE
  8663                 GO TO 4300-BROWSE-FILE-FORWARD
  8664              ELSE
  8665                 IF PI-CSR-BROWSE
  8666                    GO TO 4200-BROWSE-CSR-FORWARD
  8667                 ELSE
  8668                    GO TO 4000-BROWSE-DETAIL-FORWARD.
  8669
  8670     IF EIBAID = DFHPF2
  8671        MOVE '0'                TO PI-EDIT-SW
  8672        IF PI-PRIMARY-BROWSE
  8673           GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8674        ELSE
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 159
* EL6311.cbl
  8675           IF PI-PRIMARY-WITH-SELECT
  8676              GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8677           ELSE
  8678              IF PI-FILE-BROWSE
  8679                 GO TO 4800-BROWSE-FILE-BACKWARD
  8680              ELSE
  8681                 IF PI-CSR-BROWSE
  8682                    GO TO 4900-BROWSE-CSR-BACKWARD
  8683                 ELSE
  8684                    GO TO 4500-BROWSE-DETAIL-BACKWARD.
  8685
  8686     IF EIBAID = DFHPF3
  8687        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8688        MOVE XCTL-EL127         TO PGM-NAME
  8689        GO TO 9300-XCTL.
  8690
  8691     IF (EIBAID = DFHPF15 OR DFHPF6)
  8692        AND (CSR-EDIT-SESSION)
  8693*       AND (FATAL-OR-UNFORCED)
  8694*       AND (FATAL-ERRORS)
  8695        and (pi-6311-fatal-ctr <> +0)
  8696        MOVE ER-1819             TO EMI-ERROR
  8697        MOVE -1                  TO BMAINTL
  8698        MOVE AL-UANON            TO BMAINTA
  8699        PERFORM 9900-ERROR-FORMAT
  8700                                 THRU 9900-EXIT
  8701        GO TO 8200-SEND-DATAONLY
  8702     END-IF
  8703     IF (EIBAID = DFHPF15 AND CSR-EDIT-SESSION)
  8704      OR (EIBAID = DFHPF10)
  8705        MOVE PI-PREV-ALT-KEY     TO PB-CONTROL-BY-ACCOUNT
  8706        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
  8707        IF (RESP-NORMAL)
  8708           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
  8709              AM-CONTROL-PRIMARY (1:20))
  8710            IF AM-NAME NOT GREATER THAN SPACES OR
  8711               AM-ADDRS NOT GREATER THAN SPACES  OR
  8712               AM-ADDR-CITY NOT GREATER THAN SPACES OR
  8713               AM-ADDR-STATE NOT GREATER THAN SPACES OR
  8714               AM-ZIP NOT GREATER THAN SPACES
  8715               MOVE ER-3834             TO EMI-ERROR
  8716               MOVE -1                  TO BMAINTL
  8717               MOVE AL-UANON            TO BMAINTA
  8718               PERFORM 9900-ERROR-FORMAT
  8719                                 THRU 9900-EXIT
  8720               GO TO 8200-SEND-DATAONLY
  8721            END-IF
  8722        ELSE
  8723           MOVE ER-1609             TO EMI-ERROR
  8724           MOVE -1                  TO BMAINTL
  8725           MOVE AL-UANON            TO BMAINTA
  8726           PERFORM 9900-ERROR-FORMAT
  8727                                THRU 9900-EXIT
  8728           GO TO 8200-SEND-DATAONLY
  8729        END-IF
  8730
  8731        MOVE PI-PREV-ALT-KEY (1:33) TO ELCERT-KEY
  8732        PERFORM 6220-READ-ERMAIL THRU 6220-EXIT
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 160
* EL6311.cbl
  8733        IF (ERMAIL-FOUND)
  8734            IF (MA-ADDRESS-LINE-1 NOT GREATER THAN SPACES AND
  8735               MA-ADDRESS-LINE-2 NOT GREATER THAN SPACES)  OR
  8736               MA-CITY NOT GREATER THAN SPACES OR
  8737               MA-ADDR-STATE NOT GREATER THAN SPACES OR
  8738               MA-ZIP-CODE NOT GREATER THAN SPACES
  8739               MOVE ER-3835             TO EMI-ERROR
  8740               MOVE -1                  TO BMAINTL
  8741               MOVE AL-UANON            TO BMAINTA
  8742               PERFORM 9900-ERROR-FORMAT
  8743                                 THRU 9900-EXIT
  8744               GO TO 8200-SEND-DATAONLY
  8745            END-IF
  8746        ELSE
  8747           MOVE ER-3000             TO EMI-ERROR
  8748           MOVE -1                  TO BMAINTL
  8749           MOVE AL-UANON            TO BMAINTA
  8750           PERFORM 9900-ERROR-FORMAT
  8751                                THRU 9900-EXIT
  8752           GO TO 8200-SEND-DATAONLY
  8753        END-IF
  8754
  8755     END-IF
  8756     IF (EIBAID = DFHPF15)
  8757        AND (CSR-EDIT-SESSION)
  8758        MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
  8759        MOVE PI-SV-CARRIER       TO PI-CARRIER
  8760        MOVE PI-SV-GROUPING      TO PI-GROUPING
  8761        MOVE PI-SV-STATE         TO PI-STATE
  8762        MOVE ERPNDB-ACCOUNT      TO PI-ACCOUNT
  8763        MOVE BCERTNOI            TO PI-CERT-PRIME
  8764        MOVE BSUFIXI             TO PI-CERT-SFX
  8765        MOVE BEFFDTI             TO DEEDIT-FIELD
  8766        PERFORM 8600-DEEDIT
  8767        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  8768        MOVE '4'                 TO DC-OPTION-CODE
  8769        PERFORM 9700-DATE-LINK
  8770        IF DATE-CONVERSION-ERROR
  8771           MOVE ER-0348          TO EMI-ERROR
  8772           MOVE -1               TO BEFFDTL
  8773           MOVE AL-UABON         TO BEFFDTA
  8774           PERFORM 9900-ERROR-FORMAT
  8775                                 THRU 9900-EXIT
  8776           GO TO 8200-SEND-DATAONLY
  8777        ELSE
  8778           MOVE DC-BIN-DATE-1    TO PI-CERT-EFF-DT
  8779           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8780           MOVE XCTL-EL6315      TO PGM-NAME
  8781           MOVE '1'              TO PI-6315-ISS-CAN-SW
  8782           MOVE LOW-VALUES       TO PI-6315-PASS-AREA
  8783           PERFORM 6400-CHECK-FOR-RES-REF-CLAIM THRU 6400-EXIT
  8784           MOVE WS-EL6315-PASS-AREA TO PI-PROGRAM-WORK-AREA
  8785           GO TO 9300-XCTL
  8786        END-IF
  8787     END-IF
  8788
  8789     IF EIBAID = DFHPF4
  8790        MOVE '0'                TO PI-EDIT-SW
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 161
* EL6311.cbl
  8791        IF PI-DISPLAY-ORIGINAL-BATCH
  8792           NEXT SENTENCE
  8793        ELSE
  8794           GO TO 7200-DISPLAY-BATCHES.
  8795
  8796     IF EIBAID = DFHPF5
  8797        MOVE ER-0029                TO EMI-ERROR
  8798        MOVE -1                     TO BPFENTRL
  8799        MOVE AL-UNBON               TO BPFENTRA
  8800        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8801        GO TO 8200-SEND-DATAONLY.
  8802*        MOVE '0'                TO PI-EDIT-SW
  8803*        IF PI-DISPLAY-ORIGINAL-BATCH
  8804*           NEXT SENTENCE
  8805*        ELSE
  8806*           MOVE EL631B              TO PI-MAP-NAME
  8807*           MOVE LOW-VALUES          TO EL631BI
  8808*           MOVE 'A'                 TO BMAINTO
  8809*           MOVE AL-UANON            TO BMAINTA
  8810*           MOVE -1                  TO BMAINTL
  8811*           MOVE '5'                 TO PI-MAINT-FUNCTION
  8812*           GO TO 8100-SEND-INITIAL-MAP.
  8813
  8814     IF EIBAID = DFHPF6
  8815        IF NOT CSR-EDIT-SESSION
  8816           MOVE ER-0029                TO EMI-ERROR
  8817           MOVE -1                     TO BPFENTRL
  8818           MOVE AL-UNBON               TO BPFENTRA
  8819           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8820           GO TO 8200-SEND-DATAONLY
  8821*           MOVE '0'              TO PI-EDIT-SW
  8822*           IF PI-DISPLAY-ORIGINAL-BATCH
  8823*              NEXT SENTENCE
  8824*           ELSE
  8825*              MOVE EL631C        TO PI-MAP-NAME
  8826*              MOVE LOW-VALUES    TO EL631CI
  8827*              MOVE 'A'           TO CMAINTO
  8828*              MOVE AL-UANON      TO CMAINTA
  8829*              MOVE -1            TO CMAINTL
  8830*              MOVE '6'           TO PI-MAINT-FUNCTION
  8831*              GO TO 8100-SEND-INITIAL-MAP
  8832*           END-IF
  8833        ELSE
  8834           PERFORM 5100-PROCESS-POL-RESC
  8835                                 THRU 5100-EXIT
  8836           MOVE  PI-PREV-CONTROL-PRIMARY
  8837                                 TO ERPNDB-KEY
  8838
  8839* EXEC CICS READ
  8840*              SET     (ADDRESS OF PENDING-BUSINESS)
  8841*              DATASET (FILE-ID-ERPNDB)
  8842*              RIDFLD  (ERPNDB-KEY)
  8843*          END-EXEC
  8844*    MOVE '&"S        E          (   #00008809' TO DFHEIV0
  8845     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8846     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8847     MOVE X'2020233030303038383039' TO DFHEIV0(25:11)
  8848     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 162
* EL6311.cbl
  8849           FILE-ID-ERPNDB,
  8850           DFHEIV20,
  8851           DFHEIV99,
  8852           ERPNDB-KEY,
  8853           DFHEIV99,
  8854           DFHEIV99,
  8855           DFHEIV99
  8856     SET ADDRESS OF PENDING-BUSINESS TO
  8857         DFHEIV20
  8858     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8859           PERFORM 9800-LINK-PENDING-EDIT
  8860                                 THRU 9800-EXIT
  8861           MOVE CG-BATCH-NO      TO PI-PB-ENTRY-BATCH
  8862           MOVE CG-BATCH-SEQ-NO  TO PI-PB-BATCH-SEQ-NO
  8863                                    PI-PREV-SEQ-NO
  8864           MOVE 'Y'              TO WS-FIRST-TIME-SW
  8865*                                    WS-CANCEL-LETTER-SW
  8866                                    PI-ALL-ISSUES-SW
  8867                                    PI-ALL-CANCELS-SW
  8868           GO TO 4100-BROWSE-PRIMARY-FORWARD
  8869        END-IF
  8870     END-IF
  8871     IF EIBAID = DFHPF7
  8872        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8873        MOVE PI-SV-CARRIER          TO PI-CARRIER
  8874        MOVE PI-SV-GROUPING         TO PI-GROUPING
  8875        MOVE PI-SV-STATE            TO PI-STATE
  8876        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  8877        MOVE BCERTNOI               TO PI-CERT-PRIME
  8878        MOVE BSUFIXI                TO PI-CERT-SFX
  8879        MOVE BEFFDTI                TO DEEDIT-FIELD
  8880        PERFORM 8600-DEEDIT
  8881        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  8882        MOVE '4'                    TO DC-OPTION-CODE
  8883        PERFORM 9700-DATE-LINK
  8884        IF DATE-CONVERSION-ERROR
  8885           MOVE ER-0348            TO EMI-ERROR
  8886           MOVE -1                  TO BEFFDTL
  8887           MOVE AL-UABON            TO BEFFDTA
  8888           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8889           GO TO 8200-SEND-DATAONLY
  8890        ELSE
  8891           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  8892           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8893           MOVE XCTL-EL1273        TO PGM-NAME
  8894           GO TO 9300-XCTL.
  8895
  8896     IF EIBAID = DFHPF8
  8897        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8898        MOVE PI-SV-CARRIER          TO PI-CARRIER
  8899        MOVE PI-SV-GROUPING         TO PI-GROUPING
  8900        MOVE PI-SV-STATE            TO PI-STATE
  8901        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  8902        MOVE BCERTNOI               TO PI-CERT-PRIME
  8903        MOVE BSUFIXI                TO PI-CERT-SFX
  8904        MOVE BEFFDTI                TO DEEDIT-FIELD
  8905        PERFORM 8600-DEEDIT
  8906        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 163
* EL6311.cbl
  8907        MOVE '4'                    TO DC-OPTION-CODE
  8908        PERFORM 9700-DATE-LINK
  8909        IF DATE-CONVERSION-ERROR
  8910           MOVE ER-0348            TO EMI-ERROR
  8911           MOVE -1                  TO BEFFDTL
  8912           MOVE AL-UABON            TO BEFFDTA
  8913           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8914           GO TO 8200-SEND-DATAONLY
  8915        ELSE
  8916           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  8917           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8918           IF PI-COMPANY-ID = 'DMD'
  8919               MOVE XCTL-EL401DMD      TO PGM-NAME
  8920             ELSE
  8921               MOVE XCTL-EL1279        TO PGM-NAME
  8922           END-IF
  8923           GO TO 9300-XCTL.
  8924
  8925     IF EIBAID = DFHPF9 AND PI-EDIT-SW = '1'
  8926        MOVE XCTL-EL6312         TO PGM-NAME
  8927
  8928* EXEC CICS XCTL
  8929*           PROGRAM   (PGM-NAME)
  8930*           COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  8931*           LENGTH    (WS-COMM-LENGTH)
  8932*       END-EXEC
  8933*    MOVE '.$C                   %   #00008882' TO DFHEIV0
  8934     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  8935     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8936     MOVE X'2020233030303038383832' TO DFHEIV0(25:11)
  8937     CALL 'kxdfhei1' USING DFHEIV0,
  8938           PGM-NAME,
  8939           PROGRAM-INTERFACE-BLOCK,
  8940           WS-COMM-LENGTH,
  8941           DFHEIV99
  8942     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8943     ELSE
  8944        MOVE '0'                 TO  PI-EDIT-SW.
  8945
  8946     IF  EIBAID = DFHPF10
  8947         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8948         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  8949         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  8950                                    PI-1042-WA
  8951         MOVE 4                  TO PI-689-DATA-SOURCE
  8952         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  8953         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  8954         MOVE PI-SV-STATE        TO PI-689-STATE
  8955         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  8956         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  8957         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  8958         MOVE PI-PB-ALT-CHG-SEQ-NO
  8959                                 TO PI-689-ALT-SEQ-NO
  8960         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  8961         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  8962         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  8963         MOVE +0                 TO PI-689-CONTROL
  8964         MOVE LOW-VALUES         TO PI-689-DATE-EDIT
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 164
* EL6311.cbl
  8965                                    PI-689-EXP-DATE
  8966                                    PI-689-RESP-PERSON
  8967                                    PI-689-TYPE
  8968                                    PI-689-FOLLOW-UP-EDIT
  8969                                    PI-689-RESEND1-EDIT
  8970                                    PI-689-SEQ-EDIT
  8971                                    PI-689-BCSEQ-EDIT
  8972                                    PI-689-LBL-OVERRIDE
  8973         MOVE W-LETTER-COMMUNICATION-AREAS
  8974                                 TO PI-PROGRAM-WORK-AREA
  8975         MOVE XCTL-EL689         TO PGM-NAME
  8976         GO TO 9300-XCTL.
  8977
  8978     IF  EIBAID = DFHPF16
  8979         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8980         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  8981         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  8982                                    PI-1042-WA
  8983         MOVE 4                  TO PI-689-DATA-SOURCE
  8984         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  8985         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  8986         MOVE PI-SV-STATE        TO PI-689-STATE
  8987         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  8988         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  8989         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  8990         MOVE PI-PB-ALT-CHG-SEQ-NO
  8991                                 TO PI-689-ALT-SEQ-NO
  8992         MOVE PI-PB-RECORD-TYPE  TO PI-689-CHG-SEQ-NO
  8993         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  8994         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  8995         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  8996         MOVE W-LETTER-COMMUNICATION-AREAS
  8997                                 TO PI-PROGRAM-WORK-AREA
  8998         MOVE XCTL-EL690         TO PGM-NAME
  8999         GO TO 9300-XCTL.
  9000
  9001     IF EIBAID = DFHPF13
  9002         MOVE XCTL-EL6313        TO PGM-NAME
  9003         GO TO 9300-XCTL.
  9004
  9005     IF EIBAID = DFHPF17
  9006        PERFORM 6200-CREATE-VADS THRU 6200-EXIT
  9007        IF (PB-I-LOAN-APR numeric)
  9008           and (pb-i-loan-apr < 99.9999)
  9009           AND (PB-I-BENEFICIARY-NAME NOT
  9010              = SPACES AND LOW-VALUES)
  9011
  9012           MOVE LINK-ELVADS          TO PGM-NAME
  9013
  9014* EXEC CICS LINK
  9015*              PROGRAM    (PGM-NAME)
  9016*              COMMAREA   (WS-PASS-AREA)
  9017*              LENGTH     (WS-PASS-AREA-LENGTH)
  9018*          END-EXEC
  9019*    MOVE '."C                   (   #00008957' TO DFHEIV0
  9020     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9021     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9022     MOVE X'2020233030303038393537' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 165
* EL6311.cbl
  9023     CALL 'kxdfhei1' USING DFHEIV0,
  9024           PGM-NAME,
  9025           WS-PASS-AREA,
  9026           WS-PASS-AREA-LENGTH,
  9027           DFHEIV99,
  9028           DFHEIV99,
  9029           DFHEIV99,
  9030           DFHEIV99
  9031     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9032
  9033           MOVE 0000             TO EMI-ERROR
  9034           MOVE -1               TO BMAINTL
  9035           PERFORM 9900-ERROR-FORMAT
  9036                                 THRU 9900-EXIT
  9037           GO TO 8200-SEND-DATAONLY
  9038        ELSE
  9039           MOVE ER-0877            TO EMI-ERROR
  9040           MOVE -1                  TO BEFFDTL
  9041           MOVE AL-UABON            TO BEFFDTA
  9042           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9043           GO TO 8200-SEND-DATAONLY
  9044        END-IF
  9045     END-IF
  9046     IF EIBAID = DFHPF14
  9047        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9048        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
  9049        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
  9050        MOVE PI-SV-STATE            TO PI-CR-STATE
  9051        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  9052        MOVE SPACE                  TO PI-EDIT-SW
  9053        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9054        MOVE XCTL-EL650             TO PGM-NAME
  9055        GO TO 9300-XCTL.
  9056
  9057     IF EIBAID = DFHPF15
  9058        IF PI-COMPANY-ID  =  'HER'
  9059            PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9060            MOVE XCTL-EL680         TO PGM-NAME
  9061            GO TO 9300-XCTL.
  9062
  9063     IF EIBAID = DFHENTER OR DFHPF11
  9064        GO TO 1000-ISSUE-MAINLINE.
  9065
  9066     MOVE ER-0029                TO EMI-ERROR
  9067     MOVE -1                     TO BPFENTRL
  9068     MOVE AL-UNBON               TO BPFENTRA
  9069     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9070     GO TO 8200-SEND-DATAONLY.
  9071
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 166
* EL6311.cbl
  9073
  9074******************************************************************
  9075*                                                                *
  9076*      CANCEL SCREEN PF KEY CHECKING                             *
  9077*                                                                *
  9078******************************************************************
  9079
  9080******************************************************************
  9081*                                                                *
  9082*      PF KEY FUNCTIONS:                                         *
  9083*                                                                *
  9084*      PF1  = BROWSE FORWARD                                     *
  9085*      PF2  = BROWSE BACKWARD                                    *
  9086*      PF3  = CERTIFICATE LOOKUP                                 *
  9087*      PF4  = DISPLAY BATCH HEADER                               *
  9088*      PF5  = ADD ISSUE SCREEN                                   *
  9089*      PF6  = ADD CANCEL SCREEN                                  *
  9090*      PF7  = CERTIFICATE DISPLAY                                *
  9091*      PF8  = CERTIFICATE NOTES                                  *
  9092*      PF9  = EDIT CONTROL                                       *
  9093*      PF10 = DISPLAY LETTER SCREEN                              *
  9094*      PF11 = DISPLAY EXPANDED LIST OF ERRORS                    *
  9095*      PF12 = DISPLAY HELP SCREEN                                *
  9096*      PF13 = CHECK WRITER FOR CANCEL SETTLEMENTS                *
  9097*      PF14 = ACCOUNT MASTER                                     *
  9098*      PF16 = LETTER REVIEW                                      *
  9099*                                                                *
  9100******************************************************************
  9101
  9102 0400-CHECK-CANCEL-PF-KEYS.
  9103     IF EIBAID = DFHPF9 AND PI-EDIT-SW NOT = '1'
  9104        MOVE ER-2337             TO EMI-ERROR
  9105        MOVE -1                  TO CMAINTL
  9106        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9107        GO TO 8200-SEND-DATAONLY.
  9108
  9109     IF EIBAID = DFHPF1
  9110        MOVE '0'                TO PI-EDIT-SW
  9111        IF PI-PRIMARY-BROWSE
  9112           GO TO 4100-BROWSE-PRIMARY-FORWARD
  9113        ELSE
  9114           IF PI-PRIMARY-WITH-SELECT
  9115              GO TO 4100-BROWSE-PRIMARY-FORWARD
  9116           ELSE
  9117              IF PI-FILE-BROWSE
  9118                 GO TO 4300-BROWSE-FILE-FORWARD
  9119              ELSE
  9120                 IF PI-CSR-BROWSE
  9121                    GO TO 4200-BROWSE-CSR-FORWARD
  9122                 ELSE
  9123                    GO TO 4000-BROWSE-DETAIL-FORWARD.
  9124
  9125     IF EIBAID = DFHPF2
  9126        MOVE '0'                TO PI-EDIT-SW
  9127        IF PI-PRIMARY-BROWSE
  9128           GO TO 4600-BROWSE-PRIMARY-BACKWARD
  9129        ELSE
  9130           IF PI-PRIMARY-WITH-SELECT
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 167
* EL6311.cbl
  9131              GO TO 4600-BROWSE-PRIMARY-BACKWARD
  9132           ELSE
  9133              IF PI-FILE-BROWSE
  9134                 GO TO 4800-BROWSE-FILE-BACKWARD
  9135              ELSE
  9136                 IF PI-CSR-BROWSE
  9137                    GO TO 4900-BROWSE-CSR-BACKWARD
  9138                 ELSE
  9139                    GO TO 4500-BROWSE-DETAIL-BACKWARD.
  9140
  9141     IF EIBAID = DFHPF3
  9142        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9143        MOVE XCTL-EL127         TO PGM-NAME
  9144        GO TO 9300-XCTL.
  9145
  9146     IF (EIBAID = DFHPF15 OR DFHPF17)
  9147        AND (CSR-EDIT-SESSION)
  9148*       AND (FATAL-OR-UNFORCED)
  9149        AND (FATAL-ERRORS)
  9150        MOVE ER-1819             TO EMI-ERROR
  9151        MOVE -1                  TO CMAINTL
  9152        MOVE AL-UANON            TO CMAINTA
  9153        PERFORM 9900-ERROR-FORMAT
  9154                                 THRU 9900-EXIT
  9155        GO TO 8200-SEND-DATAONLY
  9156     END-IF
  9157     IF (EIBAID = DFHPF15 OR DFHPF17 OR DFHPF10)
  9158       AND (CSR-EDIT-SESSION)
  9159        MOVE PI-PREV-ALT-KEY     TO PB-CONTROL-BY-ACCOUNT
  9160        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
  9161        IF (RESP-NORMAL)
  9162           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
  9163              AM-CONTROL-PRIMARY (1:20))
  9164            IF AM-NAME NOT GREATER THAN SPACES OR
  9165               AM-ADDRS NOT GREATER THAN SPACES  OR
  9166               AM-ADDR-CITY NOT GREATER THAN SPACES OR
  9167               AM-ADDR-STATE NOT GREATER THAN SPACES OR
  9168               AM-ZIP NOT GREATER THAN SPACES
  9169               MOVE ER-3834             TO EMI-ERROR
  9170               MOVE -1                  TO BMAINTL
  9171               MOVE AL-UANON            TO BMAINTA
  9172               PERFORM 9900-ERROR-FORMAT
  9173                                 THRU 9900-EXIT
  9174               GO TO 8200-SEND-DATAONLY
  9175            END-IF
  9176        ELSE
  9177           MOVE ER-1609             TO EMI-ERROR
  9178           MOVE -1                  TO BMAINTL
  9179           MOVE AL-UANON            TO BMAINTA
  9180           PERFORM 9900-ERROR-FORMAT
  9181                                THRU 9900-EXIT
  9182           GO TO 8200-SEND-DATAONLY
  9183        END-IF
  9184
  9185        MOVE PI-PREV-ALT-KEY (1:33) TO ELCERT-KEY
  9186        PERFORM 6220-READ-ERMAIL THRU 6220-EXIT
  9187        IF (ERMAIL-FOUND)
  9188            IF (MA-ADDRESS-LINE-1 NOT GREATER THAN SPACES AND
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 168
* EL6311.cbl
  9189               MA-ADDRESS-LINE-2 NOT GREATER THAN SPACES)  OR
  9190               MA-CITY NOT GREATER THAN SPACES OR
  9191               MA-ADDR-STATE NOT GREATER THAN SPACES OR
  9192               MA-ZIP-CODE NOT GREATER THAN SPACES
  9193               MOVE ER-3835             TO EMI-ERROR
  9194               MOVE -1                  TO BMAINTL
  9195               MOVE AL-UANON            TO BMAINTA
  9196               PERFORM 9900-ERROR-FORMAT
  9197                                 THRU 9900-EXIT
  9198               GO TO 8200-SEND-DATAONLY
  9199            END-IF
  9200        ELSE
  9201           MOVE ER-3000             TO EMI-ERROR
  9202           MOVE -1                  TO BMAINTL
  9203           MOVE AL-UANON            TO BMAINTA
  9204           PERFORM 9900-ERROR-FORMAT
  9205                                THRU 9900-EXIT
  9206           GO TO 8200-SEND-DATAONLY
  9207        END-IF
  9208
  9209     END-IF
  9210     IF (EIBAID = DFHPF15 OR DFHPF17)
  9211        AND (CSR-EDIT-SESSION)
  9212        MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
  9213        MOVE PI-SV-CARRIER       TO PI-CARRIER
  9214        MOVE PI-SV-GROUPING      TO PI-GROUPING
  9215        MOVE PI-SV-STATE         TO PI-STATE
  9216        MOVE ERPNDB-ACCOUNT      TO PI-ACCOUNT
  9217        MOVE CCERTNOI            TO PI-CERT-PRIME
  9218        MOVE CSUFIXI             TO PI-CERT-SFX
  9219        MOVE CEFFDTI             TO DEEDIT-FIELD
  9220        PERFORM 8600-DEEDIT
  9221        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  9222        MOVE '4'                 TO DC-OPTION-CODE
  9223        PERFORM 9700-DATE-LINK
  9224        IF DATE-CONVERSION-ERROR
  9225           MOVE ER-0348          TO EMI-ERROR
  9226           MOVE -1               TO CEFFDTL
  9227           MOVE AL-UABON         TO CEFFDTA
  9228           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9229           GO TO 8200-SEND-DATAONLY
  9230        ELSE
  9231           MOVE DC-BIN-DATE-1    TO PI-CERT-EFF-DT
  9232           PERFORM 6000-CREATE-TEMP-STORAGE
  9233                                 THRU 6000-EXIT
  9234           IF EIBAID = DFHPF17
  9235               PERFORM 6400-CHECK-FOR-RES-REF-CLAIM
  9236                                  THRU 6400-EXIT
  9237               IF PI-RES-REF-CLM-TYPE NOT EQUAL
  9238                                 '2' AND '3' AND '4'
  9239                  MOVE ER-3831     TO  EMI-ERROR
  9240                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9241                  GO TO 8200-SEND-DATAONLY
  9242               END-IF
  9243               MOVE 'Y'          TO PI-CLM-RESC-IND
  9244           ELSE
  9245               MOVE 'N'          TO PI-CLM-RESC-IND
  9246           END-IF
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 169
* EL6311.cbl
  9247           MOVE XCTL-EL6316      TO PGM-NAME
  9248           MOVE '2'              TO PI-ISS-CAN-SW
  9249           MOVE LOW-VALUES       TO PI-6316-PASS-AREA
  9250           MOVE WS-EL6316-PASS-AREA TO PI-PROGRAM-WORK-AREA
  9251           GO TO 9300-XCTL
  9252        END-IF
  9253     END-IF
  9254
  9255     IF EIBAID = DFHPF4
  9256        MOVE '0'                TO PI-EDIT-SW
  9257        IF PI-DISPLAY-ORIGINAL-BATCH
  9258           NEXT SENTENCE
  9259        ELSE
  9260           GO TO 7200-DISPLAY-BATCHES.
  9261
  9262     IF EIBAID = DFHPF5
  9263        MOVE ER-0029                TO EMI-ERROR
  9264        MOVE -1                     TO BPFENTRL
  9265        MOVE AL-UNBON               TO BPFENTRA
  9266        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9267        GO TO 8200-SEND-DATAONLY.
  9268*        MOVE '0'                TO PI-EDIT-SW
  9269*        IF PI-DISPLAY-ORIGINAL-BATCH
  9270*           NEXT SENTENCE
  9271*        ELSE
  9272*           MOVE EL631B              TO PI-MAP-NAME
  9273*           MOVE LOW-VALUES          TO EL631BI
  9274*           MOVE 'A'                 TO BMAINTO
  9275*           MOVE AL-UANON            TO BMAINTA
  9276*           MOVE -1                  TO BMAINTL
  9277*           MOVE '5'                 TO PI-MAINT-FUNCTION
  9278*           GO TO 8100-SEND-INITIAL-MAP.
  9279
  9280     IF EIBAID = DFHPF6
  9281        MOVE ER-0029                TO EMI-ERROR
  9282        MOVE -1                     TO BPFENTRL
  9283        MOVE AL-UNBON               TO BPFENTRA
  9284        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9285        GO TO 8200-SEND-DATAONLY.
  9286*        MOVE '0'                TO PI-EDIT-SW
  9287*        IF PI-DISPLAY-ORIGINAL-BATCH
  9288*           NEXT SENTENCE
  9289*        ELSE
  9290*           MOVE EL631C              TO PI-MAP-NAME
  9291*           MOVE LOW-VALUES          TO EL631CI
  9292*           MOVE 'A'                 TO CMAINTO
  9293*           MOVE AL-UANON            TO CMAINTA
  9294*           MOVE -1                  TO CMAINTL
  9295*           MOVE '6'                 TO PI-MAINT-FUNCTION
  9296*           GO TO 8100-SEND-INITIAL-MAP.
  9297
  9298     IF EIBAID = DFHPF7
  9299        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9300        MOVE PI-SV-CARRIER          TO PI-CARRIER
  9301        MOVE PI-SV-GROUPING         TO PI-GROUPING
  9302        MOVE PI-SV-STATE            TO PI-STATE
  9303        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  9304        MOVE CCERTNOI               TO PI-CERT-PRIME
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 170
* EL6311.cbl
  9305        MOVE CSUFIXI                TO PI-CERT-SFX
  9306        MOVE CEFFDTI                TO DEEDIT-FIELD
  9307        PERFORM 8600-DEEDIT
  9308        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  9309        MOVE '4'                    TO DC-OPTION-CODE
  9310        PERFORM 9700-DATE-LINK
  9311        IF DATE-CONVERSION-ERROR
  9312           MOVE ER-0348            TO EMI-ERROR
  9313           MOVE -1                  TO BEFFDTL
  9314           MOVE AL-UABON            TO BEFFDTA
  9315           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9316           GO TO 8200-SEND-DATAONLY
  9317        ELSE
  9318           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  9319           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9320           MOVE XCTL-EL1273        TO PGM-NAME
  9321           GO TO 9300-XCTL.
  9322
  9323     IF EIBAID = DFHPF8
  9324        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9325        MOVE PI-SV-CARRIER          TO PI-CARRIER
  9326        MOVE PI-SV-GROUPING         TO PI-GROUPING
  9327        MOVE PI-SV-STATE            TO PI-STATE
  9328        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  9329        MOVE CCERTNOI               TO PI-CERT-PRIME
  9330        MOVE CSUFIXI                TO PI-CERT-SFX
  9331        MOVE CEFFDTI                TO DEEDIT-FIELD
  9332        PERFORM 8600-DEEDIT
  9333        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  9334        MOVE '4'                    TO DC-OPTION-CODE
  9335        PERFORM 9700-DATE-LINK
  9336        IF DATE-CONVERSION-ERROR
  9337           MOVE ER-0348             TO EMI-ERROR
  9338           MOVE -1                  TO BEFFDTL
  9339           MOVE AL-UABON            TO BEFFDTA
  9340           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9341           GO TO 8200-SEND-DATAONLY
  9342        ELSE
  9343           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  9344           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9345           IF PI-COMPANY-ID = 'DMD'
  9346               MOVE XCTL-EL401DMD      TO PGM-NAME
  9347             ELSE
  9348               MOVE XCTL-EL1279        TO PGM-NAME
  9349           END-IF
  9350           GO TO 9300-XCTL.
  9351
  9352     IF EIBAID = DFHPF9 AND PI-EDIT-SW = '1'
  9353        MOVE XCTL-EL6312     TO PGM-NAME
  9354
  9355* EXEC CICS XCTL
  9356*           PROGRAM  (PGM-NAME)
  9357*           COMMAREA (PROGRAM-INTERFACE-BLOCK)
  9358*           LENGTH   (WS-COMM-LENGTH)
  9359*       END-EXEC
  9360*    MOVE '.$C                   %   #00009284' TO DFHEIV0
  9361     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  9362     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 171
* EL6311.cbl
  9363     MOVE X'2020233030303039323834' TO DFHEIV0(25:11)
  9364     CALL 'kxdfhei1' USING DFHEIV0,
  9365           PGM-NAME,
  9366           PROGRAM-INTERFACE-BLOCK,
  9367           WS-COMM-LENGTH,
  9368           DFHEIV99
  9369     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9370     ELSE
  9371        MOVE '0'                 TO  PI-EDIT-SW.
  9372
  9373     IF EIBAID = DFHPF10
  9374         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9375         MOVE PI-PREV-KEY        TO PI-ERPNDB-KEY
  9376         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  9377         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  9378                                    PI-1042-WA
  9379         MOVE 4                  TO PI-689-DATA-SOURCE
  9380         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  9381         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  9382         MOVE PI-SV-STATE        TO PI-689-STATE
  9383         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  9384         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  9385         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  9386         MOVE PI-PB-ALT-CHG-SEQ-NO
  9387                                 TO PI-689-ALT-SEQ-NO
  9388         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  9389         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  9390         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  9391         MOVE +0                 TO PI-689-CONTROL
  9392         MOVE LOW-VALUES         TO PI-689-DATE-EDIT
  9393                                    PI-689-EXP-DATE
  9394                                    PI-689-RESP-PERSON
  9395                                    PI-689-TYPE
  9396                                    PI-689-FOLLOW-UP-EDIT
  9397                                    PI-689-RESEND1-EDIT
  9398                                    PI-689-SEQ-EDIT
  9399                                    PI-689-BCSEQ-EDIT
  9400                                    PI-689-LBL-OVERRIDE
  9401         MOVE W-LETTER-COMMUNICATION-AREAS
  9402                                 TO PI-PROGRAM-WORK-AREA
  9403         MOVE XCTL-EL689         TO PGM-NAME
  9404         GO TO 9300-XCTL.
  9405
  9406     IF  EIBAID = DFHPF16
  9407         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9408         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  9409         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  9410                                    PI-1042-WA
  9411         MOVE 4                  TO PI-689-DATA-SOURCE
  9412         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  9413         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  9414         MOVE PI-SV-STATE        TO PI-689-STATE
  9415         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  9416         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  9417         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  9418         MOVE PI-PB-ALT-CHG-SEQ-NO
  9419                                 TO PI-689-ALT-SEQ-NO
  9420         MOVE PI-PB-RECORD-TYPE  TO PI-689-CHG-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 172
* EL6311.cbl
  9421         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  9422         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  9423         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  9424         MOVE W-LETTER-COMMUNICATION-AREAS
  9425                                 TO PI-PROGRAM-WORK-AREA
  9426         MOVE XCTL-EL690         TO PGM-NAME
  9427         GO TO 9300-XCTL.
  9428     IF (EIBAID = DFHPF13)
  9429        if (not fatal-errors)
  9430           and (not unforced-errors)
  9431           MOVE PI-PREV-ALT-KEY  TO ERPNDB-ALT-KEY
  9432           MOVE PI-SV-CARRIER    TO PI-CARRIER
  9433           MOVE PI-SV-GROUPING   TO PI-GROUPING
  9434           MOVE PI-SV-STATE      TO PI-STATE
  9435           MOVE ERPNDB-ACCOUNT   TO PI-ACCOUNT
  9436           MOVE CCERTNOI         TO PI-CERT-PRIME
  9437           MOVE CSUFIXI          TO PI-CERT-SFX
  9438           MOVE CEFFDTI          TO DEEDIT-FIELD
  9439           PERFORM 8600-DEEDIT
  9440           MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
  9441           MOVE '4'              TO DC-OPTION-CODE
  9442           PERFORM 9700-DATE-LINK
  9443           IF DATE-CONVERSION-ERROR
  9444              MOVE ER-0348       TO EMI-ERROR
  9445              MOVE -1            TO CEFFDTL
  9446              MOVE AL-UABON      TO CEFFDTA
  9447              PERFORM 9900-ERROR-FORMAT
  9448                                 THRU 9900-EXIT
  9449              GO TO 8200-SEND-DATAONLY
  9450           ELSE
  9451              MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
  9452              MOVE AL-UANON      TO CEFFDTA
  9453              MOVE DC-BIN-DATE-1 TO PI-CERT-EFF-DT
  9454              PERFORM 6000-CREATE-TEMP-STORAGE
  9455                                 THRU 6000-EXIT
  9456              MOVE XCTL-EL677    TO PGM-NAME
  9457              GO TO 9300-XCTL
  9458           end-if
  9459        else
  9460           MOVE ER-3444          TO EMI-ERROR
  9461           MOVE -1               TO CPFENTRL
  9462           MOVE AL-UNBON         TO CPFENTRA
  9463           PERFORM 9900-ERROR-FORMAT
  9464                                 THRU 9900-EXIT
  9465           GO TO 8200-SEND-DATAONLY
  9466        end-if
  9467     end-if
  9468
  9469     IF EIBAID = DFHPF14
  9470        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9471        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
  9472        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
  9473        MOVE PI-SV-STATE            TO PI-CR-STATE
  9474        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  9475        MOVE SPACE                  TO PI-EDIT-SW
  9476        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9477        MOVE XCTL-EL650             TO PGM-NAME
  9478        GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 173
* EL6311.cbl
  9479
  9480     IF EIBAID = DFHENTER OR DFHPF11
  9481        GO TO 2000-CANCEL-MAINLINE.
  9482
  9483     MOVE ER-0029                TO EMI-ERROR.
  9484     MOVE -1                     TO CPFENTRL.
  9485     MOVE AL-UNBON               TO CPFENTRA.
  9486     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9487     GO TO 8200-SEND-DATAONLY.
  9488
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 174
* EL6311.cbl
  9490
  9491******************************************************************
  9492*                                                                *
  9493*      BATCH SCREEN PF KEY CHECKING                              *
  9494*                                                                *
  9495******************************************************************
  9496
  9497******************************************************************
  9498*                                                                *
  9499*      PF KEY FUNCTIONS:                                         *
  9500*                                                                *
  9501*      PF1 = BROWSE FORWARD                                      *
  9502*      PF2 = BROWSE BACKWARD                                     *
  9503*      PF3 = DISPLAY PREMIUM TOTALS                              *
  9504*      PF4 = TRANSFER TO ACCOUNT BILLING                         *
  9505*                                                                *
  9506*                                                                *
  9507******************************************************************
  9508
  9509 0500-CHECK-BATCH-PF-KEYS.
  9510     IF EIBAID = DFHPF1
  9511        MOVE '0'                TO PI-EDIT-SW
  9512        IF ONLY-BATCH-HEADERS  OR ALL-OUT-OF-BAL
  9513           GO TO 5000-BROWSE-BATCH-HEADERS
  9514        ELSE
  9515           IF PI-GOOD-BROWSE
  9516              IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  9517                 GO TO 4100-BROWSE-PRIMARY-FORWARD
  9518              ELSE
  9519                 IF PI-FILE-BROWSE
  9520                    GO TO 4300-BROWSE-FILE-FORWARD
  9521                 ELSE
  9522                    IF PI-CSR-BROWSE
  9523                       GO TO 4200-BROWSE-CSR-FORWARD
  9524                    ELSE
  9525                       GO TO 4000-BROWSE-DETAIL-FORWARD
  9526           ELSE
  9527              GO TO 0800-BROWSE-ERROR.
  9528
  9529     IF EIBAID = DFHPF2
  9530        MOVE '0'                TO PI-EDIT-SW
  9531        IF ONLY-BATCH-HEADERS  OR ALL-OUT-OF-BAL
  9532           GO TO 5500-BROWSE-BATCH-BACKWARD
  9533        ELSE
  9534           IF PI-GOOD-BROWSE
  9535              IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  9536                 GO TO 4600-BROWSE-PRIMARY-BACKWARD
  9537              ELSE
  9538                 IF PI-FILE-BROWSE
  9539                    GO TO 4800-BROWSE-FILE-BACKWARD
  9540                 ELSE
  9541                    IF PI-CSR-BROWSE
  9542                       GO TO 4900-BROWSE-CSR-BACKWARD
  9543                    ELSE
  9544                       GO TO 4500-BROWSE-DETAIL-BACKWARD
  9545           ELSE
  9546              GO TO 0800-BROWSE-ERROR.
  9547
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 175
* EL6311.cbl
  9548     IF EIBAID = DFHPF3
  9549        GO TO 3000-BATCH-MAINLINE.
  9550
  9551     IF  EIBAID = DFHPF4
  9552        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9553        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
  9554        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
  9555        MOVE PI-SV-STATE            TO PI-CR-STATE
  9556        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  9557                                       PI-CR-FIN-RESP
  9558        MOVE 'A'                    TO PI-CR-TYPE
  9559        MOVE SPACE                  TO PI-EDIT-SW
  9560        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9561        MOVE XCTL-EL640             TO PGM-NAME
  9562        GO TO 9300-XCTL.
  9563
  9564     IF (ONLY-BATCH-HEADERS OR ALL-OUT-OF-BAL)
  9565       AND
  9566        (EIBAID = DFHENTER)
  9567           GO TO 3500-EDIT-BATCH-DATA.
  9568
  9569     IF EIBAID = DFHENTER
  9570        GO TO 3500-EDIT-BATCH-DATA.
  9571
  9572     MOVE ER-0029             TO EMI-ERROR.
  9573     MOVE -1                  TO DPFENTRL.
  9574     MOVE AL-UNBON            TO DPFENTRA.
  9575     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9576     GO TO 8200-SEND-DATAONLY.
  9577
  9578 0800-BROWSE-ERROR.
  9579     MOVE ER-2258                TO EMI-ERROR.
  9580     MOVE -1                     TO DPFENTRL.
  9581     MOVE AL-UNBON               TO DPFENTRA.
  9582     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9583     GO TO 8200-SEND-DATAONLY.
  9584
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 176
* EL6311.cbl
  9586
  9587******************************************************************
  9588*                                                                *
  9589*                I S S U E   M A I N L I N E                     *
  9590*                                                                *
  9591******************************************************************
  9592
  9593 1000-ISSUE-MAINLINE.
  9594     IF PI-DISPLAY-ORIGINAL-BATCH
  9595        IF BMAINTI NOT = 'C' AND 'D' AND 'S' AND 'K'
  9596           MOVE ER-0023             TO EMI-ERROR
  9597           MOVE -1                  TO BMAINTL
  9598           MOVE AL-UABON            TO BMAINTA
  9599           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9600           GO TO 8200-SEND-DATAONLY
  9601        ELSE
  9602           NEXT SENTENCE
  9603     ELSE
  9604        IF BMAINTI NOT = 'A' AND 'C' AND 'D' AND 'S' AND 'K'
  9605           MOVE ER-0023             TO EMI-ERROR
  9606           MOVE -1                  TO BMAINTL
  9607           MOVE AL-UABON            TO BMAINTA
  9608           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9609           GO TO 8200-SEND-DATAONLY.
  9610
  9611     IF BMAINTI = 'S'
  9612        GO TO 1100-SHOW-REQUEST.
  9613
  9614     IF NOT MODIFY-CAP
  9615         MOVE 'UPDATE'       TO SM-READ
  9616         PERFORM 9995-SECURITY-VIOLATION
  9617         MOVE ER-0070        TO EMI-ERROR
  9618         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9619         GO TO 8100-SEND-INITIAL-MAP.
  9620
  9621     IF BMAINTL GREATER THAN ZEROS
  9622        IF PI-PF5-FUNCTION
  9623           IF BMAINTI NOT = 'A'
  9624              MOVE AL-UABON  TO BMAINTA
  9625              MOVE -1        TO BMAINTL
  9626              MOVE ER-2260   TO EMI-ERROR
  9627              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9628              GO TO 8200-SEND-DATAONLY.
  9629
  9630     IF BCERTNOL = ZEROS
  9631       AND (BMAINTI = 'C' OR 'K' OR 'D')
  9632         NEXT SENTENCE
  9633     ELSE
  9634         IF BCERTNOL NOT = ZEROS
  9635             MOVE AL-UANON       TO BCERTNOA
  9636         ELSE
  9637             MOVE -1             TO BCERTNOL
  9638             MOVE  1             TO SET-CURSOR-SW
  9639             MOVE ER-2218        TO EMI-ERROR
  9640             MOVE AL-UABON       TO BCERTNOA
  9641             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9642
  9643     IF BSUFIXL NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 177
* EL6311.cbl
  9644         MOVE AL-UANON       TO BSUFIXA
  9645     ELSE
  9646         MOVE AL-SANOF       TO BSUFIXA.
  9647
  9648
  9649* EXEC CICS READ
  9650*        DATASET (FILE-ID-ERPNDB)
  9651*        INTO    (PENDING-BUSINESS)
  9652*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
  9653*    END-EXEC.
  9654     MOVE LENGTH OF
  9655      PENDING-BUSINESS
  9656       TO DFHEIV11
  9657*    MOVE '&"IL       E          (   #00009567' TO DFHEIV0
  9658     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  9659     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9660     MOVE X'2020233030303039353637' TO DFHEIV0(25:11)
  9661     CALL 'kxdfhei1' USING DFHEIV0,
  9662           FILE-ID-ERPNDB,
  9663           PENDING-BUSINESS,
  9664           DFHEIV11,
  9665           PI-PREV-CONTROL-PRIMARY,
  9666           DFHEIV99,
  9667           DFHEIV99,
  9668           DFHEIV99
  9669     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9670
  9671
  9672     IF BEFFDTL = ZEROS AND (BMAINTI = 'C' OR 'K' OR 'D')
  9673        NEXT SENTENCE
  9674     ELSE
  9675        IF BEFFDTL NOT = ZEROS
  9676           MOVE AL-UNNON             TO BEFFDTA
  9677           MOVE BEFFDTI              TO DEEDIT-FIELD
  9678           PERFORM 8600-DEEDIT
  9679           MOVE DEEDIT-FIELD-V0      TO DC-GREG-DATE-1-MDY
  9680           MOVE 4                    TO DC-OPTION-CODE
  9681           PERFORM 9700-DATE-LINK
  9682           IF NO-CONVERSION-ERROR
  9683              MOVE DC-BIN-DATE-1     TO WS-CONVERTED-EFFDT
  9684              ELSE
  9685              MOVE -1                TO BEFFDTL
  9686              MOVE  1                TO SET-CURSOR-SW
  9687              MOVE ER-2226           TO EMI-ERROR
  9688              MOVE AL-UNBON          TO BEFFDTA
  9689              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9690           ELSE
  9691              MOVE -1                TO BEFFDTL
  9692              MOVE  1                TO SET-CURSOR-SW
  9693              MOVE ER-2220           TO EMI-ERROR
  9694              MOVE AL-UNBON          TO BEFFDTA
  9695              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9696
  9697     MOVE PI-PREV-ALT-KEY            TO WS-ERPNDB-ALT-KEY.
  9698
  9699     IF BCERTNOL NOT = ZEROS
  9700        MOVE BCERTNOI                TO WS-NEW-PRIME
  9701     ELSE
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 178
* EL6311.cbl
  9702        MOVE SPACES                  TO WS-NEW-PRIME.
  9703
  9704     IF BSUFIXL NOT = ZEROS
  9705        MOVE BSUFIXI                 TO WS-NEW-SUFFIX
  9706     ELSE
  9707        MOVE SPACE                   TO WS-NEW-SUFFIX.
  9708
  9709     IF BEFFDTL NOT = ZEROS
  9710        MOVE WS-CONVERTED-EFFDT      TO WS-NEW-CERT-EFF-DT
  9711     ELSE
  9712        MOVE LOW-VALUES              TO WS-NEW-CERT-EFF-DT.
  9713
  9714     IF BMAINTI = 'A' OR 'K' OR 'S'
  9715        NEXT SENTENCE
  9716     ELSE
  9717        MOVE PI-PREV-ALT-KEY     TO WS-ERPNDB-ALT-KEY
  9718        IF WS-PB-CERT-NO     NOT = WS-NEW-CERT-NO      OR
  9719           WS-PB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT  OR
  9720           WS-PB-RECORD-TYPE NOT = '1'
  9721           IF BMAINTI = 'C'
  9722               MOVE ER-2287          TO EMI-ERROR
  9723               MOVE -1               TO BCERTNOL
  9724               MOVE AL-UABON         TO BCERTNOA BEFFDTA
  9725               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9726               GO TO 8200-SEND-DATAONLY
  9727             ELSE
  9728               MOVE ER-2260          TO EMI-ERROR
  9729               MOVE -1               TO BCERTNOL
  9730               MOVE AL-UABON         TO BCERTNOA
  9731               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9732               GO TO 8200-SEND-DATAONLY.
  9733
  9734     IF BMAINTI = 'D'
  9735         GO TO 1400-DELETE-ISSUE-ROUTINE.
  9736
  9737*    IF BMICRNOL  NOT =  ZEROS
  9738*        IF BMICRNOI  NUMERIC
  9739*            MOVE AL-UNNON       TO  BMICRNOA
  9740*        ELSE
  9741*            MOVE -1             TO  BMICRNOL
  9742*            MOVE 1              TO  SET-CURSOR-SW
  9743*            MOVE AL-UNBON       TO  BMICRNOA
  9744*            MOVE ER-2701        TO  EMI-ERROR
  9745*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9746     IF BVINL NOT = ZEROS
  9747        MOVE AL-UANON            TO BVINA
  9748     END-IF
  9749
  9750     IF LETRREQL   GREATER THAN ZEROS
  9751        IF LETRREQI = 'Y'
  9752          AND (PB-I-LETTER-REQD = 'Y' OR 'N')
  9753           CONTINUE
  9754        ELSE
  9755        IF LETRREQI = 'N'
  9756          AND (PB-I-LETTER-REQD = 'Y' OR 'N')
  9757           CONTINUE
  9758        ELSE
  9759           MOVE -1               TO LETRREQL
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 179
* EL6311.cbl
  9760           MOVE ER-1585          TO EMI-ERROR
  9761           MOVE AL-UABON         TO LETRREQA
  9762           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9763        END-IF
  9764     END-IF.
  9765     IF B1STNML NOT = ZEROS
  9766         MOVE AL-UANON                TO B1STNMA.
  9767
  9768     IF BINITL  NOT = ZEROS
  9769        MOVE AL-UANON                TO BINITA.
  9770
  9771     IF BSEXL NOT = ZEROS
  9772        IF BSEXI = 'M' OR 'F'
  9773           MOVE AL-UANON             TO BSEXA
  9774        ELSE
  9775           MOVE -1               TO BSEXL
  9776           MOVE ER-2629          TO EMI-ERROR
  9777           MOVE AL-UABON         TO BSEXA
  9778           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9779
  9780     IF BAGEL NOT = ZEROS
  9781         IF BAGEI NUMERIC
  9782             MOVE BAGEI              TO WS-BAGE
  9783             MOVE AL-UNNON           TO BAGEA
  9784         ELSE
  9785             MOVE -1                 TO BAGEL
  9786             MOVE  1                 TO SET-CURSOR-SW
  9787             MOVE ER-2223            TO EMI-ERROR
  9788             MOVE AL-UNBON           TO BAGEA
  9789             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9790
  9791     IF BLSTNML NOT = ZERO  OR
  9792        B1STNML NOT = ZERO  OR
  9793        BINITL NOT = ZERO
  9794         IF BAGEL = ZEROS
  9795             MOVE -1                 TO BAGEL
  9796             MOVE  1                 TO SET-CURSOR-SW
  9797             MOVE ER-3269            TO EMI-ERROR
  9798             MOVE AL-UNBON           TO BAGEA
  9799             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9800         END-IF
  9801     END-IF.
  9802
  9803     MOVE LOW-VALUES             TO WS-CONVERTED-BIRTH
  9804
  9805     IF (BBIRTHL GREATER THAN +0) AND
  9806        (BBIRTHI NOT EQUAL SPACES)
  9807        NEXT SENTENCE
  9808     ELSE
  9809        GO TO 1010-CHECK-AGE.
  9810
  9811     MOVE BBIRTHI                TO DEEDIT-FIELD.
  9812     PERFORM 8600-DEEDIT.
  9813     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
  9814     MOVE DC-GREG-DATE-1-MDY     TO WS-SAVE-BIRTH-DATE
  9815     MOVE AL-UNNON               TO BBIRTHA.
  9816     MOVE '4'                    TO DC-OPTION-CODE.
  9817     PERFORM 9700-DATE-LINK.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 180
* EL6311.cbl
  9818     IF DATE-CONVERSION-ERROR
  9819        MOVE -1                  TO BBIRTHL
  9820        MOVE  1                  TO SET-CURSOR-SW
  9821        MOVE ER-2228             TO EMI-ERROR
  9822        MOVE AL-UNBON            TO BBIRTHA
  9823        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9824        GO TO 1010-CHECK-AGE.
  9825
  9826     IF (NO-CONVERSION-ERROR) AND
  9827        (DC-BIN-DATE-1 GREATER THAN WS-CONVERTED-EFFDT)
  9828        MOVE DC-BIN-DATE-1       TO WS-WORK-BIN-DT
  9829        SUBTRACT CENTURY-ADJ FROM WS-WORK-BIN-RED
  9830        MOVE WS-WORK-BIN-DT      TO DC-BIN-DATE-1
  9831                                    WS-CONVERTED-BIRTH
  9832        MOVE AL-UANON            TO BBIRTHA
  9833     ELSE
  9834        MOVE DC-BIN-DATE-1       TO WS-CONVERTED-BIRTH
  9835        MOVE AL-UANON            TO BBIRTHA.
  9836
  9837 1010-CHECK-AGE.
  9838
  9839*    IF BAGEL = ZERO
  9840*       IF BBIRTHL GREATER THAN ZERO
  9841*          PERFORM 1095-CALC-AGE THRU 1099-EXIT.
  9842
  9843     IF B1STPMTL NOT = ZEROS
  9844        IF B1STPMTI = SPACES
  9845           MOVE LOW-VALUES           TO WS-CONVERTED-1ST-PMT-DT
  9846        ELSE
  9847           MOVE B1STPMTI             TO DEEDIT-FIELD
  9848           PERFORM 8600-DEEDIT
  9849           MOVE DEEDIT-FIELD-V0      TO DC-GREG-DATE-1-MDY
  9850           MOVE AL-UNNON             TO B1STPMTA
  9851           MOVE 4                    TO DC-OPTION-CODE
  9852           PERFORM 9700-DATE-LINK
  9853           IF NO-CONVERSION-ERROR
  9854              MOVE DC-BIN-DATE-1     TO WS-CONVERTED-1ST-PMT-DT
  9855              MOVE AL-UANON          TO B1STPMTA
  9856           ELSE
  9857              MOVE -1                TO B1STPMTL
  9858              MOVE  1                TO SET-CURSOR-SW
  9859              MOVE ER-2200           TO EMI-ERROR
  9860              MOVE AL-UNBON          TO B1STPMTA
  9861              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9862
  9863     IF BDAYSL NOT = ZEROS
  9864         IF BDAYSI NUMERIC
  9865             MOVE AL-UNNON           TO BDAYSA
  9866         ELSE
  9867             MOVE -1                 TO BDAYSL
  9868             MOVE ER-2530            TO EMI-ERROR
  9869             MOVE AL-UNBON           TO BDAYSA
  9870             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9871
  9872     IF BLNTRML NOT = ZEROS
  9873         IF BLNTRMI NUMERIC
  9874             MOVE AL-UNNON       TO BLNTRMA
  9875         ELSE
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 181
* EL6311.cbl
  9876             MOVE -1             TO BLNTRML
  9877             MOVE ER-2533        TO EMI-ERROR
  9878             MOVE AL-UNBON       TO BLNTRMA
  9879             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9880
  9881**   IF PI-COMPANY-ID = 'DMD'
  9882     IF PI-COMPANY-ID = 'DMD' OR 'CID' or 'AHL'
  9883        NEXT SENTENCE
  9884     ELSE
  9885         IF BLNOFCRL NOT = ZEROS
  9886            PERFORM 7500-READ-ERLOFC THRU 7599-EXIT
  9887            IF LOAN-OFFICER-FOUND
  9888                MOVE AL-UANON        TO BLNOFCRA
  9889             ELSE
  9890                 MOVE SPACE          TO WS-LOAN-OFFICER
  9891                 MOVE -1             TO BLNOFCRL
  9892                 MOVE  1             TO SET-CURSOR-SW
  9893                 MOVE ER-3006        TO EMI-ERROR
  9894                 MOVE AL-UNBON       TO BLNOFCRA
  9895                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9896
  9897     IF BFREQL NOT = ZEROS
  9898         IF BFREQI NUMERIC
  9899             MOVE AL-UNNON       TO BFREQA
  9900         ELSE
  9901             MOVE -1             TO BFREQL
  9902             MOVE  1             TO SET-CURSOR-SW
  9903             MOVE ER-2223        TO EMI-ERROR
  9904             MOVE AL-UNBON       TO BFREQA
  9905             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9906
  9907     IF BMODEL NOT = ZEROS
  9908         MOVE BMODEI             TO WS-MODE-CODE
  9909                                    PI-BMODE
  9910         IF WS-MODE-CODE-VALID
  9911             MOVE AL-UANON       TO BMODEA
  9912         ELSE
  9913             MOVE -1             TO BMODEL
  9914             MOVE ER-2591        TO EMI-ERROR
  9915             MOVE AL-UABON       TO BMODEA
  9916             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9917
  9918     IF BPMTSL NOT = ZEROS
  9919         IF BPMTSI NUMERIC
  9920             MOVE AL-UNNON           TO BPMTSA
  9921             MOVE BPMTSI             TO PI-BPMTS
  9922         ELSE
  9923             MOVE -1                 TO BPMTSL
  9924             MOVE ER-2592            TO EMI-ERROR
  9925             MOVE AL-UNBON           TO BPMTSA
  9926             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9927
  9928     IF BPMTAMTL NOT = ZEROS
  9929
  9930* EXEC CICS BIF DEEDIT
  9931*            FIELD  (BPMTAMTI)
  9932*            LENGTH (9)
  9933*       END-EXEC
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 182
* EL6311.cbl
  9934     MOVE 9
  9935       TO DFHEIV11
  9936*    MOVE '@"L                   #   #00009830' TO DFHEIV0
  9937     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9938     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9939     MOVE X'2020233030303039383330' TO DFHEIV0(25:11)
  9940     CALL 'kxdfhei1' USING DFHEIV0,
  9941           BPMTAMTI,
  9942           DFHEIV11
  9943     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9944        MOVE BPMTAMTI           TO PI-BPMTAMT.
  9945*        MOVE BPMTAMTI           TO DEEDIT-FIELD-V2
  9946*        PERFORM 8600-DEEDIT
  9947*        MOVE DEEDIT-FIELD-V2    TO PI-BPMTAMT.
  9948
  9949*    IF BAPRL NOT = ZEROS
  9950*        EXEC CICS BIF DEEDIT
  9951*            FIELD  (BAPRI)
  9952*            LENGTH (7)
  9953*        END-EXEC
  9954*        MOVE BAPRI              TO WS-BAPR.
  9955
  9956     IF BAPRL > 0
  9957        MOVE +0                  TO  WS-BAPR
  9958        PERFORM VARYING WS-SUB FROM +1 BY +1 UNTIL
  9959           (WS-SUB > 7)
  9960           OR (BAPRI (WS-SUB:1) NUMERIC)
  9961           OR (BAPRI (WS-SUB:1) = '.')
  9962        END-PERFORM
  9963        IF WS-SUB > 7
  9964           MOVE ER-2471       TO EMI-ERROR
  9965           MOVE -1            TO BAPRL
  9966           MOVE AL-UNBON      TO BAPRA
  9967           PERFORM 9900-ERROR-FORMAT
  9968                                 THRU 9900-EXIT
  9969        ELSE
  9970           IF BAPRI (WS-SUB:1) NUMERIC
  9971              MOVE WS-SUB           TO WS-BEG
  9972              PERFORM VARYING WS-SUB FROM WS-SUB BY +1 UNTIL
  9973                 (WS-SUB > 7)
  9974                 OR (BAPRI (WS-SUB:1) NOT NUMERIC)
  9975              END-PERFORM
  9976              COMPUTE WS-END = WS-SUB - WS-BEG
  9977              MOVE BAPRI (WS-BEG:WS-END)
  9978                                 TO WS-APR-WHOLE-NUM
  9979           END-IF
  9980           IF BAPRI (WS-SUB:1) = '.'
  9981              COMPUTE WS-BEG = WS-SUB + 1
  9982              IF (WS-BEG < 8)
  9983                 AND (BAPRI (WS-BEG:1) NUMERIC)
  9984                 PERFORM VARYING WS-SUB FROM WS-BEG BY +1 UNTIL
  9985                    (WS-SUB > 7)
  9986                    OR (BAPRI (WS-SUB:1) NOT NUMERIC)
  9987                 END-PERFORM
  9988                 COMPUTE WS-END = WS-SUB - WS-BEG
  9989                 MOVE BAPRI (WS-BEG:WS-END)
  9990                                 TO WS-APR-DEC (1:WS-END)
  9991              END-IF
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 183
* EL6311.cbl
  9992           END-IF
  9993           MOVE AL-UNNON      TO BAPRA
  9994           MOVE WS-BAPR       TO BAPRO
  9995        END-IF
  9996     END-IF
  9997*     IF BAPRL NOT = ZEROS
  9998*        MOVE BAPRI              TO DEEDIT-FIELD-V4
  9999*        PERFORM 8600-DEEDIT
 10000*        MOVE DEEDIT-FIELD-V4    TO WS-BAPR.
 10001
 10002     IF BLIVESL NOT = ZEROS
 10003        MOVE BLIVESI             TO DEEDIT-FIELD
 10004        PERFORM 8600-DEEDIT
 10005        IF DEEDIT-FIELD-V0 NUMERIC
 10006           MOVE DEEDIT-FIELD-V0  TO WS-BLIVES
 10007           MOVE AL-UNNON         TO BLIVESA
 10008        ELSE
 10009           MOVE -1               TO BLIVESL
 10010           MOVE AL-UNBON         TO BLIVESA
 10011           MOVE ER-2223          TO EMI-ERROR
 10012           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10013
 10014*DMD CUSTOM CODING*************START
 10015*NOTE PI-I-NUM-BILLED IS A FIELD FOR 'DMD' ONLY
 10016     IF PI-COMPANY-ID NOT = 'DMD'
 10017         MOVE ZEROS               TO BBILLEDL
 10018         GO TO 1010-EDIT-CONT.
 10019
 10020     IF BBILLEDL NOT = ZEROS
 10021        MOVE BBILLEDI            TO WS-EDIT-CSO-FIELD
 10022        MOVE 'Y'                 TO WS-NUMERIC-SW
 10023        MOVE +1                  TO WS-CSO-SUB
 10024        PERFORM 1030-EDIT-FOR-NUMERICS THRU 1030-EDIT-EXIT
 10025        IF CSO-NUMERIC-FIELD
 10026
 10027* EXEC CICS BIF DEEDIT
 10028*              FIELD  (BBILLEDI)
 10029*              LENGTH (9)
 10030*          END-EXEC
 10031     MOVE 9
 10032       TO DFHEIV11
 10033*    MOVE '@"L                   #   #00009916' TO DFHEIV0
 10034     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10035     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10036     MOVE X'2020233030303039393136' TO DFHEIV0(25:11)
 10037     CALL 'kxdfhei1' USING DFHEIV0,
 10038           BBILLEDI,
 10039           DFHEIV11
 10040     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10041           MOVE BBILLEDI         TO WS-BILLED
 10042           MOVE AL-UNNON         TO BBILLEDA
 10043        ELSE
 10044           MOVE -1               TO BBILLEDL
 10045           MOVE AL-UNBON         TO BBILLEDA
 10046           MOVE ER-2547          TO EMI-ERROR
 10047           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10048     ELSE
 10049        IF BMAINTI EQUAL 'A'
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 184
* EL6311.cbl
 10050           MOVE -1               TO BBILLEDL
 10051           MOVE AL-UNBON         TO BBILLEDA
 10052           MOVE ER-8148          TO EMI-ERROR
 10053           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10054
 10055 1010-EDIT-CONT.
 10056
 10057     IF BFORCEL  NOT = ZEROS
 10058         IF FORCE-CAP
 10059            MOVE AL-UANON            TO BFORCEA
 10060         ELSE
 10061            MOVE ER-2945             TO EMI-ERROR
 10062            MOVE AL-UABON            TO BFORCEA
 10063            MOVE -1                  TO BFORCEL
 10064            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10065
 10066     if (bforcel not = zeros)
 10067        and (bforcei = 'L')
 10068        and (not csr-edit-session)
 10069        and (emi-error <> er-2945)
 10070        MOVE ER-2670             TO EMI-ERROR
 10071        MOVE AL-UABON            TO BFORCEA
 10072        MOVE -1                  TO BFORCEL
 10073        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10074     end-if
 10075     IF BENTRYL NOT = ZEROS
 10076        IF BENTRYI NOT = ' ' AND 'E' AND 'R' AND 'P' AND
 10077                 'C' and 'D' AND 'V' AND 'U' AND 'M'
 10078           MOVE ER-2224              TO EMI-ERROR
 10079           MOVE AL-UABON             TO BENTRYA
 10080           MOVE -1                   TO BENTRYL
 10081           MOVE  1                   TO SET-CURSOR-SW
 10082           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10083        ELSE
 10084           MOVE AL-UANON             TO BENTRYA.
 10085
 10086     IF BUNWRITL NOT = ZEROS
 10087        IF BUNWRITI NOT = ' ' AND 'A' AND 'D' AND 'U' AND 'N'
 10088           MOVE ER-7574              TO EMI-ERROR
 10089           MOVE AL-UABON             TO BUNWRITA
 10090           MOVE -1                   TO BUNWRITL
 10091           MOVE  1                   TO SET-CURSOR-SW
 10092           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10093        ELSE
 10094           MOVE AL-UANON             TO BUNWRITA.
 10095
 10096     IF BREINL  NOT = ZEROS
 10097         MOVE AL-UANON               TO BREINA.
 10098
 10099     IF BBILCDL NOT = ZEROS
 10100        IF BBILCDI NOT = ' ' AND 'H' AND 'R' AND 'L'
 10101                             AND 'A' AND 'B' AND 'E'
 10102           MOVE ER-2225              TO EMI-ERROR
 10103           MOVE AL-UABON             TO BBILCDA
 10104           MOVE -1                   TO BBILCDL
 10105           MOVE  1                   TO SET-CURSOR-SW
 10106           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10107        ELSE
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 185
* EL6311.cbl
 10108           MOVE AL-UANON             TO BBILCDA.
 10109
 10110     IF BSKPCDL NOT = ZEROS
 10111         MOVE AL-UANON               TO BSKPCDA.
 10112
 10113     IF BINDGRPL NOT = ZEROS
 10114         MOVE AL-UANON               TO BINDGRPA.
 10115
 10116     IF BSIGL   NOT = ZEROS
 10117         MOVE AL-UANON               TO BSIGA.
 10118
 10119     IF BRTCLSL NOT = ZEROS
 10120         MOVE AL-UANON               TO BRTCLSA.
 10121
 10122     IF BMEMBERL NOT = ZEROS
 10123         MOVE AL-UANON               TO BMEMBERA.
 10124
 10125     MOVE +0                         TO WS-SUB1.
 10126
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 186
* EL6311.cbl
 10128
 10129******************************************************************
 10130*                                                                *
 10131*           E D I T   I S S U E   C O V E R A G E S              *
 10132*                                                                *
 10133******************************************************************
 10134
 10135 1020-EDIT-COVERAGES.
 10136     ADD +1                      TO WS-SUB1.
 10137
 10138     IF WS-SUB1 GREATER +2
 10139        GO TO 1025-EDIT-CONTINUE
 10140     END-IF
 10141
 10142     IF PI-COMPANY-ID = CLIENT-CRI OR CLIENT-LGX
 10143       IF (BMODEL   GREATER ZERO  OR
 10144            BPMTSL   GREATER ZERO  OR
 10145            BPMTAMTL GREATER ZERO)
 10146          AND
 10147            BTYPE-LEN (WS-SUB1) GREATER THAN +0
 10148               GO TO 1021-CONT-EDIT.
 10149
 10150     IF BTYPE-LEN      (WS-SUB1) GREATER THAN ZEROS OR
 10151        BTERM-LEN      (WS-SUB1) GREATER THAN ZEROS OR
 10152        BBEN-LEN       (WS-SUB1) GREATER THAN ZEROS OR
 10153        BPREM-LEN      (WS-SUB1) GREATER THAN ZEROS OR
 10154        BCRIT-PERD-LEN (WS-SUB1) GREATER THAN ZEROS OR
 10155        BEXPIRE-LEN    (WS-SUB1) GREATER THAN ZEROS OR
 10156        BALT-PREM-LEN  (WS-SUB1) GREATER THAN ZEROS OR
 10157        BALT-BEN-LEN   (WS-SUB1) GREATER THAN ZEROS
 10158        NEXT SENTENCE
 10159         ELSE
 10160            GO TO 1020-EDIT-COVERAGES.
 10161
 10162 1021-CONT-EDIT.
 10163
 10164     IF BMAINTI = 'A'
 10165        IF BTYPE-LEN  (WS-SUB1) GREATER THAN ZEROS
 10166           MOVE AL-UANON         TO BTYPE-ATTRB       (WS-SUB1)
 10167        ELSE
 10168           MOVE  -1              TO BTYPE-LEN         (WS-SUB1)
 10169           MOVE ER-7404          TO EMI-ERROR
 10170           MOVE AL-SABON         TO BKIND-ATTRB       (WS-SUB1)
 10171           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10172     ELSE
 10173        IF BTYPE-LEN  (WS-SUB1) GREATER THAN ZEROS
 10174           MOVE AL-UANON         TO BTYPE-ATTRB       (WS-SUB1).
 10175
 10176     IF BTERM-LEN (WS-SUB1) NOT EQUAL +0
 10177        MOVE BTERMI (WS-SUB1)    TO DEEDIT-FIELD
 10178        PERFORM 8600-DEEDIT
 10179        IF DEEDIT-FIELD-V0 NUMERIC
 10180           MOVE DEEDIT-FIELD-V0  TO WS-BTERM (WS-SUB1)
 10181        ELSE
 10182           MOVE ZEROS            TO WS-BTERM (WS-SUB1).
 10183
 10184     IF PI-COMPANY-ID NOT = CLIENT-CRI AND CLIENT-LGX
 10185*      IF BTERM-LEN (WS-SUB1) NOT GREATER THAN +0
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 187
* EL6311.cbl
 10186        IF BMODEL  GREATER THAN ZEROS  AND
 10187           BPMTSL  GREATER THAN ZEROS
 10188           PERFORM 6100-TERM-CONVERSION THRU 6199-EXIT.
 10189
 10190     IF PI-COMPANY-ID = CLIENT-CRI OR CLIENT-LGX
 10191         IF BMODEL   GREATER THAN ZEROS  OR
 10192            BPMTSL   GREATER THAN ZEROS  OR
 10193            BPMTAMTL GREATER THAN ZEROS
 10194             PERFORM 6100-TERM-CONVERSION THRU 6199-EXIT.
 10195
 10196     IF BMAINTI = ('C' OR 'K')
 10197        IF BTERM-LEN (WS-SUB1)  = ZEROS
 10198           NEXT SENTENCE
 10199        ELSE
 10200           MOVE BTERMI    (WS-SUB1)   TO DEEDIT-FIELD
 10201           PERFORM 8600-DEEDIT
 10202           IF DEEDIT-FIELD-V0 NUMERIC
 10203              MOVE DEEDIT-FIELD-V0    TO WS-BTERM    (WS-SUB1)
 10204              IF WS-BTERM (WS-SUB1)  GREATER THAN ZERO
 10205                    MOVE AL-UNNON     TO BTERM-ATTRB (WS-SUB1)
 10206              ELSE
 10207                    MOVE ER-2241      TO EMI-ERROR
 10208                    MOVE -1           TO BTERM-LEN   (WS-SUB1)
 10209                    MOVE AL-UNBON     TO BTERM-ATTRB (WS-SUB1)
 10210                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10211           ELSE
 10212              MOVE ER-2223          TO EMI-ERROR
 10213              MOVE -1               TO BTERM-LEN     (WS-SUB1)
 10214              MOVE AL-UNBON         TO BTERM-ATTRB   (WS-SUB1)
 10215              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10216     ELSE
 10217        IF  BTERM-LEN      (WS-SUB1)   GREATER THAN ZEROS
 10218            MOVE BTERMI    (WS-SUB1)   TO DEEDIT-FIELD
 10219            PERFORM 8600-DEEDIT
 10220            IF DEEDIT-FIELD-V0      NUMERIC
 10221               IF DEEDIT-FIELD-V0     GREATER THAN ZERO
 10222                  MOVE DEEDIT-FIELD-V0 TO WS-BTERM    (WS-SUB1)
 10223                  MOVE AL-UNNON        TO BTERM-ATTRB (WS-SUB1)
 10224               ELSE
 10225                  MOVE ER-2241         TO EMI-ERROR
 10226                  MOVE -1              TO BTERM-LEN   (WS-SUB1)
 10227                  MOVE AL-UNBON        TO BTERM-ATTRB (WS-SUB1)
 10228                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10229            ELSE
 10230              MOVE ER-2223             TO EMI-ERROR
 10231              MOVE -1                  TO BTERM-LEN   (WS-SUB1)
 10232              MOVE AL-UNBON            TO BTERM-ATTRB (WS-SUB1)
 10233              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10234        ELSE
 10235            MOVE ER-2240               TO EMI-ERROR
 10236            MOVE -1                    TO BTERM-LEN   (WS-SUB1)
 10237            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10238*    IF PI-COMPANY-ID NOT = CLIENT-CRI AND CLIENT-LGX
 10239*        IF BMODEL  GREATER THAN ZEROS  AND
 10240*           BPMTSL  GREATER THAN ZEROS
 10241*            PERFORM 6100-TERM-CONVERSION THRU 6199-EXIT.
 10242
 10243     IF BBEN-LEN (WS-SUB1) = ZEROS
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 188
* EL6311.cbl
 10244        AND BMAINTI = ('C' OR 'K')
 10245           NEXT SENTENCE
 10246     ELSE
 10247        IF BBEN-LEN (WS-SUB1) GREATER THAN ZEROS
 10248           MOVE AL-UNNON           TO BBEN-ATTRB (WS-SUB1)
 10249
 10250* EXEC CICS BIF DEEDIT
 10251*              FIELD  (BBENI (WS-SUB1))
 10252*              LENGTH (12)
 10253*          END-EXEC
 10254     MOVE 12
 10255       TO DFHEIV11
 10256*    MOVE '@"L                   #   #00010128' TO DFHEIV0
 10257     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10258     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10259     MOVE X'2020233030303130313238' TO DFHEIV0(25:11)
 10260     CALL 'kxdfhei1' USING DFHEIV0,
 10261           BBENI(WS-SUB1),
 10262           DFHEIV11
 10263     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10264           IF BBENI (WS-SUB1)  NUMERIC
 10265              IF BBENI (WS-SUB1) GREATER THAN ZEROS
 10266                 MOVE BBENI (WS-SUB1) TO WS-BBEN    (WS-SUB1)
 10267*          MOVE BBENI (WS-SUB1)    TO DEEDIT-FIELD
 10268*          PERFORM 8600-DEEDIT
 10269*          IF DEEDIT-FIELD-V2  NUMERIC
 10270*             IF DEEDIT-FIELD-V2 GREATER THAN ZEROS
 10271*                MOVE DEEDIT-FIELD-V2 TO WS-BBEN    (WS-SUB1)
 10272              ELSE
 10273                 MOVE ER-7632    TO EMI-ERROR
 10274                 MOVE -1         TO BBEN-LEN   (WS-SUB1)
 10275                 MOVE AL-UNBON   TO BBEN-ATTRB (WS-SUB1)
 10276                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10277           ELSE
 10278              MOVE ER-2223         TO EMI-ERROR
 10279              MOVE -1              TO BBEN-LEN   (WS-SUB1)
 10280              MOVE AL-UNBON        TO BBEN-ATTRB (WS-SUB1)
 10281              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10282        ELSE
 10283           MOVE ER-7632    TO EMI-ERROR
 10284           MOVE -1         TO BBEN-LEN   (WS-SUB1)
 10285           MOVE AL-UNBON   TO BBEN-ATTRB (WS-SUB1)
 10286           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10287
 10288     IF (BPREM-LEN    (WS-SUB1) = ZEROS)
 10289        AND (BMAINTI = ('C' OR 'K'))
 10290        CONTINUE
 10291     ELSE
 10292        IF BPREM-LEN   (WS-SUB1) GREATER THAN ZEROS
 10293           MOVE AL-UNNON           TO BPREM-ATTRB (WS-SUB1)
 10294           INSPECT BPREM-ALPHA (WS-SUB1) TALLYING WS-TALLY
 10295              FOR ALL '.'
 10296           IF WS-TALLY > 1
 10297              PERFORM VARYING A1 FROM 1 BY 1 UNTIL
 10298                 BPREM-ALPHA (WS-SUB1) (A1:1) = '.'
 10299              END-PERFORM
 10300              IF A1 < 9
 10301                 ADD 3 TO A1
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 189
* EL6311.cbl
 10302                 MOVE SPACES TO BPREM-ALPHA (WS-SUB1) (A1:12 - A1)
 10303              END-IF
 10304           ELSE
 10305              PERFORM VARYING A1 FROM 1 BY 1 UNTIL
 10306                (A1 > 11)
 10307                OR (BPREM-ALPHA (WS-SUB1) (A1:1) =
 10308                  LOW-VALUES OR SPACES)
 10309              END-PERFORM
 10310              IF A1 > 1 AND < 12
 10311                 MOVE SPACES
 10312                           TO BPREM-ALPHA (WS-SUB1) (A1:12 - A1)
 10313              END-IF
 10314           END-IF
 10315
 10316* EXEC CICS BIF DEEDIT
 10317*              FIELD  (BPREMI (WS-SUB1))
 10318*              LENGTH (11)
 10319*          END-EXEC
 10320     MOVE 11
 10321       TO DFHEIV11
 10322*    MOVE '@"L                   #   #00010183' TO DFHEIV0
 10323     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10324     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10325     MOVE X'2020233030303130313833' TO DFHEIV0(25:11)
 10326     CALL 'kxdfhei1' USING DFHEIV0,
 10327           BPREMI(WS-SUB1),
 10328           DFHEIV11
 10329     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10330           IF BPREMI (WS-SUB1) NUMERIC
 10331              IF BPREMI (WS-SUB1) GREATER THAN ZEROS
 10332                 MOVE BPREMI (WS-SUB1) TO WS-BPREM   (WS-SUB1)
 10333*          MOVE BPREMI (WS-SUB1)   TO DEEDIT-FIELD
 10334*          PERFORM 8600-DEEDIT
 10335*          IF DEEDIT-FIELD-V2  NUMERIC
 10336*             IF DEEDIT-FIELD-V2 GREATER THAN ZEROS
 10337*                MOVE DEEDIT-FIELD-V2 TO WS-BPREM   (WS-SUB1)
 10338              ELSE
 10339                 IF PI-COMPANY-ID NOT = 'DCC' and 'VPP'
 10340                    MOVE ER-7633    TO EMI-ERROR
 10341                    MOVE -1         TO BPREM-LEN   (WS-SUB1)
 10342                    MOVE AL-UNBON   TO BPREM-ATTRB (WS-SUB1)
 10343                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10344                 END-IF
 10345              END-IF
 10346           ELSE
 10347              MOVE ER-2223         TO EMI-ERROR
 10348              MOVE -1              TO BPREM-LEN   (WS-SUB1)
 10349              MOVE AL-UNBON        TO BPREM-ATTRB (WS-SUB1)
 10350              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10351           END-IF
 10352        ELSE
 10353           IF PI-COMPANY-ID NOT = 'DCC' and 'VPP'
 10354              MOVE ER-7633         TO EMI-ERROR
 10355              MOVE -1              TO BPREM-LEN   (WS-SUB1)
 10356              MOVE AL-UNBON        TO BPREM-ATTRB (WS-SUB1)
 10357              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10358           END-IF
 10359        END-IF
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 190
* EL6311.cbl
 10360     END-IF
 10361
 10362     IF BCPREM-LEN   (WS-SUB1) = ZEROS
 10363        NEXT SENTENCE
 10364     ELSE
 10365        MOVE AL-UNNON           TO BCPREM-ATTRB (WS-SUB1)
 10366
 10367* EXEC CICS BIF DEEDIT
 10368*           FIELD  (BCPREMI (WS-SUB1))
 10369*           LENGTH (11)
 10370*       END-EXEC
 10371     MOVE 11
 10372       TO DFHEIV11
 10373*    MOVE '@"L                   #   #00010223' TO DFHEIV0
 10374     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10375     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10376     MOVE X'2020233030303130323233' TO DFHEIV0(25:11)
 10377     CALL 'kxdfhei1' USING DFHEIV0,
 10378           BCPREMI(WS-SUB1),
 10379           DFHEIV11
 10380     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10381        IF BCPREMI (WS-SUB1) NUMERIC
 10382           MOVE BCPREMI (WS-SUB1) TO WS-BCPREM  (WS-SUB1)
 10383*       MOVE BCPREMI (WS-SUB1)  TO DEEDIT-FIELD-X11
 10384*       PERFORM 8600-DEEDIT
 10385*       IF DEEDIT-FIELD-V2  NUMERIC
 10386*          MOVE DEEDIT-FIELD-V2 TO WS-BCPREM  (WS-SUB1)
 10387        ELSE
 10388           MOVE ER-2223         TO EMI-ERROR
 10389           MOVE -1              TO BCPREM-LEN   (WS-SUB1)
 10390           MOVE AL-UNBON        TO BCPREM-ATTRB (WS-SUB1)
 10391           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10392
 10393     IF BCRIT-PERD-LEN  (WS-SUB1)    GREATER THAN ZEROS
 10394        MOVE BCRIT-PERDI (WS-SUB1)   TO DEEDIT-FIELD
 10395        PERFORM 8600-DEEDIT
 10396        IF DEEDIT-FIELD-V0 NUMERIC
 10397           MOVE DEEDIT-FIELD-V0      TO WS-BCRIT-PERD    (WS-SUB1)
 10398           MOVE AL-UNNON             TO BCRIT-PERD-ATTRB (WS-SUB1)
 10399         ELSE
 10400           MOVE -1                   TO BCRIT-PERD-LEN   (WS-SUB1)
 10401           MOVE AL-UNBON             TO BCRIT-PERD-ATTRB (WS-SUB1)
 10402           MOVE ER-2223              TO EMI-ERROR
 10403           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10404
 10405     IF BEXPIRE-LEN  (WS-SUB1)    GREATER THAN ZEROS
 10406        IF BEXPIRE   (WS-SUB1) = SPACES
 10407           MOVE LOW-VALUES       TO WS-CONVERTED-EXPIRDT (WS-SUB1)
 10408        ELSE
 10409           MOVE BEXPIRE (WS-SUB1)   TO DEEDIT-FIELD
 10410           PERFORM 8600-DEEDIT
 10411           IF DEEDIT-FIELD-V0        NUMERIC
 10412              MOVE AL-UNNON         TO BEXPIRE-ATTRB (WS-SUB1)
 10413              MOVE 4                TO DC-OPTION-CODE
 10414              MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
 10415              PERFORM 9700-DATE-LINK
 10416              MOVE DC-BIN-DATE-1    TO WS-CONVERTED-EXPIRDT
 10417                                                        (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 191
* EL6311.cbl
 10418              IF NO-CONVERSION-ERROR
 10419                 NEXT SENTENCE
 10420              ELSE
 10421                 MOVE -1         TO BEXPIRE-LEN   (WS-SUB1)
 10422                 MOVE ER-2531    TO EMI-ERROR
 10423                 MOVE AL-UNBON   TO BEXPIRE-ATTRB (WS-SUB1)
 10424                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10425           ELSE
 10426             MOVE -1             TO BEXPIRE-LEN   (WS-SUB1)
 10427             MOVE ER-2532        TO EMI-ERROR
 10428             MOVE AL-UNBON       TO BEXPIRE-ATTRB (WS-SUB1)
 10429             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10430
 10431     IF BALT-BEN-LEN   (WS-SUB1)  = ZEROS
 10432        NEXT SENTENCE
 10433     ELSE
 10434
 10435* EXEC CICS BIF DEEDIT
 10436*           FIELD  (BALT-BENI (WS-SUB1))
 10437*           LENGTH (12)
 10438*       END-EXEC
 10439     MOVE 12
 10440       TO DFHEIV11
 10441*    MOVE '@"L                   #   #00010280' TO DFHEIV0
 10442     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10443     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10444     MOVE X'2020233030303130323830' TO DFHEIV0(25:11)
 10445     CALL 'kxdfhei1' USING DFHEIV0,
 10446           BALT-BENI(WS-SUB1),
 10447           DFHEIV11
 10448     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10449        IF BALT-BENI (WS-SUB1) NUMERIC
 10450           MOVE BALT-BENI (WS-SUB1) TO WS-BALT-BEN    (WS-SUB1)
 10451*       MOVE BALT-BENI (WS-SUB1) TO DEEDIT-FIELD
 10452*       PERFORM 8600-DEEDIT
 10453*       IF DEEDIT-FIELD-V0 NUMERIC
 10454*          MOVE DEEDIT-FIELD-V2 TO WS-BALT-BEN        (WS-SUB1)
 10455        ELSE
 10456           MOVE ER-2223         TO EMI-ERROR
 10457           MOVE -1              TO BALT-BEN-LEN       (WS-SUB1)
 10458           MOVE AL-UNBON        TO BALT-BEN-ATTRB     (WS-SUB1)
 10459           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10460
 10461     IF BALT-PREM-LEN (WS-SUB1)  = ZEROS
 10462        NEXT SENTENCE
 10463     ELSE
 10464
 10465* EXEC CICS BIF DEEDIT
 10466*           FIELD  (BALT-PREMI (WS-SUB1))
 10467*           LENGTH (11)
 10468*       END-EXEC
 10469     MOVE 11
 10470       TO DFHEIV11
 10471*    MOVE '@"L                   #   #00010299' TO DFHEIV0
 10472     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10473     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10474     MOVE X'2020233030303130323939' TO DFHEIV0(25:11)
 10475     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 192
* EL6311.cbl
 10476           BALT-PREMI(WS-SUB1),
 10477           DFHEIV11
 10478     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10479        IF BALT-PREMI (WS-SUB1) NUMERIC
 10480           MOVE BALT-PREMI (WS-SUB1) TO WS-BALT-PREM  (WS-SUB1)
 10481*       MOVE BALT-PREMI    (WS-SUB1)   TO DEEDIT-FIELD
 10482*       PERFORM 8600-DEEDIT
 10483*       IF DEEDIT-FIELD-V0 NUMERIC
 10484*          MOVE DEEDIT-FIELD-V2 TO WS-BALT-PREM       (WS-SUB1)
 10485        ELSE
 10486           MOVE ER-2223         TO EMI-ERROR
 10487           MOVE -1              TO BALT-PREM-LEN      (WS-SUB1)
 10488           MOVE AL-UNBON        TO BALT-PREM-ATTRB    (WS-SUB1)
 10489           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10490
 10491      GO TO 1020-EDIT-COVERAGES.
 10492     .
 10493 1025-edit-continue.
 10494     IF PI-COMPANY-ID  =  'DMD'
 10495        MOVE LOW-VALUES             TO BNCERTI
 10496                                       BNSTATI.
 10497
 10498     IF EMI-ERROR = ZEROS
 10499         NEXT SENTENCE
 10500     ELSE
 10501         GO TO 8200-SEND-DATAONLY.
 10502
 10503     IF BMAINTI = 'A'
 10504         GO TO 1200-ADD-ISSUE-ROUTINE.
 10505
 10506     IF BMAINTI = 'C'
 10507         GO TO 1300-CHANGE-ISSUE-ROUTINE.
 10508**  This must be a 'K' transaction A,C,S & D spoke for
 10509
 10510     GO TO 2800-REWRITE-ISSUE-CERT-KEY.
 10511
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 193
* EL6311.cbl
 10513
 10514 1030-EDIT-FOR-NUMERICS.
 10515     IF WS-CSO-SUB EQUAL 10
 10516        GO TO 1030-EDIT-EXIT.
 10517
 10518     IF (WS-EDIT-BYTE (WS-CSO-SUB) NUMERIC OR
 10519        WS-EDIT-BYTE (WS-CSO-SUB) EQUAL ',' OR
 10520        WS-EDIT-BYTE (WS-CSO-SUB) EQUAL LOW-VALUES)
 10521           ADD +1               TO WS-CSO-SUB
 10522           GO TO 1030-EDIT-FOR-NUMERICS.
 10523
 10524     MOVE 'N'                   TO WS-NUMERIC-SW.
 10525
 10526 1030-EDIT-EXIT.
 10527******************************************************************
 10528*                                                                *
 10529*                 C A L C U L A T E   A G E                      *
 10530*                                                                *
 10531******************************************************************
 10532
 10533
 10534 1095-CALC-AGE.
 10535
 10536     MOVE WS-CONVERTED-BIRTH TO DC-BIN-DATE-1.
 10537     MOVE WS-CURRENT-BIN-DT  TO DC-BIN-DATE-2.
 10538     MOVE 1                  TO DC-OPTION-CODE.
 10539     PERFORM 9700-DATE-LINK
 10540     IF NO-CONVERSION-ERROR
 10541         COMPUTE WS-BAGE = DC-ELAPSED-MONTHS / 12
 10542         MOVE WS-BAGE            TO BAGEI
 10543         MOVE +2                 TO BAGEL
 10544         MOVE AL-UNNON TO BAGEA.
 10545
 10546 1099-EXIT.
 10547     EXIT.
 10548
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 194
* EL6311.cbl
 10550
 10551******************************************************************
 10552*                                                                *
 10553*                   S H O W   I S S U E                          *
 10554*                                                                *
 10555******************************************************************
 10556
 10557 1100-SHOW-REQUEST.
 10558     MOVE 'S'                    TO PI-MAINT-FUNCTION.
 10559
 10560     IF BCERTNOL = ZEROS AND
 10561        BEFFDTL  = ZEROS
 10562        MOVE -1                  TO BMAINTL
 10563        GO TO 8200-SEND-DATAONLY.
 10564
 10565     MOVE BCERTNOI               TO WS-NEW-PRIME.
 10566
 10567     IF BSUFIXL NOT = ZEROS
 10568        MOVE BSUFIXI             TO WS-NEW-SUFFIX
 10569     ELSE
 10570        MOVE SPACE               TO WS-NEW-SUFFIX.
 10571
 10572     MOVE BEFFDTI                TO DEEDIT-FIELD.
 10573     PERFORM 8600-DEEDIT.
 10574     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 10575     MOVE '4'                    TO DC-OPTION-CODE.
 10576     PERFORM 9700-DATE-LINK.
 10577     IF DATE-CONVERSION-ERROR
 10578        MOVE ER-0348             TO EMI-ERROR
 10579        MOVE -1                  TO BEFFDTL
 10580        MOVE AL-UABON            TO BEFFDTA
 10581        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10582        GO TO 8200-SEND-DATAONLY
 10583     ELSE
 10584        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
 10585        MOVE AL-UANON            TO BEFFDTA
 10586        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 10587
 10588     MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
 10589
 10590     IF ERPNDB-CERT-NO     NOT = WS-NEW-CERT-NO   OR
 10591        ERPNDB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT
 10592          MOVE 'Y'                    TO WS-SHOW-SW
 10593          IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
 10594             GO TO 4100-BROWSE-PRIMARY-FORWARD
 10595           ELSE
 10596             IF PI-FILE-BROWSE
 10597                GO TO 4300-BROWSE-FILE-FORWARD
 10598              ELSE
 10599                IF PI-CSR-BROWSE
 10600                   GO TO 4200-BROWSE-CSR-FORWARD
 10601                ELSE
 10602                   GO TO 4000-BROWSE-DETAIL-FORWARD
 10603        ELSE
 10604           GO TO 3900-RE-DISPLAY-RECORD.
 10605
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 195
* EL6311.cbl
 10607
 10608******************************************************************
 10609*                                                                *
 10610*            A D D   I S S U E   R O U T I N E                   *
 10611*                                                                *
 10612******************************************************************
 10613
 10614***************************************************************
 10615*     1. GETMAIN FOR PENDING BUSINESS RECORDS.                *
 10616*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
 10617*     3. INITIALIZE RECORD WITH INITIAL DATA FROM SCREEN.     *
 10618*     4. LINK TO THE EDIT ROUTINE.                            *
 10619*     5. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
 10620*     6. WRITE THE NEW ISSUE RECORD.                          *
 10621*     7. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
 10622*     8. IF ANY ERRORS ARE DETECTED, THE ISSUE SCREEN IS      *
 10623*           DISPLAYED WITH ANY ASSOCIATED ERRORS,             *
 10624*        ELSE                                                 *
 10625*           A NEW INITIALIZED SCREEN WILL BE DISPLAYED.       *
 10626***************************************************************
 10627
 10628 1200-ADD-ISSUE-ROUTINE.
 10629     MOVE 'A'                    TO PI-MAINT-FUNCTION.
 10630
 10631
 10632* EXEC CICS GETMAIN
 10633*        SET     (ADDRESS OF PENDING-BUSINESS)
 10634*        LENGTH  (ERPNDB-RECORD-LENGTH)
 10635*    END-EXEC.
 10636*    MOVE '," L                  $   #00010455' TO DFHEIV0
 10637     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 10638     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10639     MOVE X'2020233030303130343535' TO DFHEIV0(25:11)
 10640     CALL 'kxdfhei1' USING DFHEIV0,
 10641           DFHEIV20,
 10642           ERPNDB-RECORD-LENGTH,
 10643           DFHEIV99
 10644     SET ADDRESS OF PENDING-BUSINESS TO
 10645         DFHEIV20
 10646     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10647
 10648
 10649
 10650* EXEC CICS HANDLE CONDITION
 10651*         NOTFND    (1280-BATCH-HDR-NOT-FOUND)
 10652*    END-EXEC.
 10653*    MOVE '"$I                   ! # #00010460' TO DFHEIV0
 10654     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10655     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10656     MOVE X'2320233030303130343630' TO DFHEIV0(25:11)
 10657     CALL 'kxdfhei1' USING DFHEIV0
 10658     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10659
 10660
 10661     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 10662     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 10663     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 10664
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 196
* EL6311.cbl
 10665
 10666* EXEC CICS READ
 10667*        INTO    (PENDING-BUSINESS)
 10668*        DATASET (FILE-ID-ERPNDB)
 10669*        RIDFLD  (ERPNDB-KEY)
 10670*    END-EXEC.
 10671     MOVE LENGTH OF
 10672      PENDING-BUSINESS
 10673       TO DFHEIV11
 10674*    MOVE '&"IL       E          (   #00010468' TO DFHEIV0
 10675     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10676     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10677     MOVE X'2020233030303130343638' TO DFHEIV0(25:11)
 10678     CALL 'kxdfhei1' USING DFHEIV0,
 10679           FILE-ID-ERPNDB,
 10680           PENDING-BUSINESS,
 10681           DFHEIV11,
 10682           ERPNDB-KEY,
 10683           DFHEIV99,
 10684           DFHEIV99,
 10685           DFHEIV99
 10686     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10687
 10688
 10689     MOVE PB-CSR-ID              TO WS-BATCH-CSR-ID.
 10690
 10691     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 10692     ADD +1                      TO WS-B-HIGHEST-SEQ-NO.
 10693     MOVE PB-CREDIT-SELECT-DT    TO WS-CREDIT-SELECT-DT.
 10694     MOVE SPACES                 TO PENDING-BUSINESS.
 10695     MOVE 'PB'                   TO PB-RECORD-ID.
 10696     MOVE PI-PREV-KEY            TO PB-CONTROL-PRIMARY.
 10697     MOVE PI-PREV-ALT-KEY        TO PB-CONTROL-BY-ACCOUNT.
 10698     MOVE SPACES                 TO PB-CERT-SFX.
 10699     MOVE WS-B-HIGHEST-SEQ-NO    TO PB-BATCH-SEQ-NO.
 10700     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
 10701                                    PB-ALT-CHG-SEQ-NO.
 10702
 10703     MOVE BCERTNOI               TO PB-CERT-PRIME.
 10704     MOVE '1'                    TO PB-RECORD-TYPE.
 10705
 10706     IF BSUFIXL NOT = ZEROS
 10707        MOVE BSUFIXI             TO PB-CERT-SFX.
 10708
 10709     MOVE WS-CONVERTED-EFFDT     TO PB-CERT-EFF-DT.
 10710
 10711     MOVE PI-COMPANY-CD          TO PB-COMPANY-CD.
 10712     MOVE PI-COMPANY-ID          TO PB-COMPANY-ID.
 10713
 10714     MOVE ZEROS                  TO PB-I-LOAN-TERM
 10715                                    PB-I-LF-PREM-CALC
 10716                                    PB-I-LF-ALT-PREM-CALC
 10717                                    PB-I-LF-RATE
 10718                                    PB-I-LF-ALT-RATE
 10719                                    PB-I-LF-REI-RATE
 10720                                    PB-I-LF-ALT-REI-RATE
 10721                                    PB-I-RATE-DEV-PCT-LF
 10722                                    PB-I-AH-PREM-CALC
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 197
* EL6311.cbl
 10723                                    PB-I-AH-RATE
 10724                                    PB-I-AH-REI-RATE
 10725                                    PB-I-AH-RATE-TRM
 10726                                    PB-I-RATE-DEV-PCT-AH
 10727                                    PB-I-BUSINESS-TYPE
 10728                                    PB-I-LIFE-COMMISSION
 10729                                    PB-I-JOINT-COMMISSION
 10730                                    PB-I-JOINT-AGE
 10731                                    PB-I-AH-COMMISSION
 10732                                    PB-I-CURR-SEQ
 10733                                    PB-CHG-COUNT
 10734                                    PB-LF-BILLED-AMTS
 10735                                    PB-AH-BILLED-AMTS
 10736                                    PB-CALC-TOLERANCE
 10737                                    PB-I-EXTENTION-DAYS
 10738*                                   PB-I-MICROFILM-NO
 10739                                    PB-I-TERM-IN-DAYS.
 10740
 10741     MOVE LOW-VALUES             TO PB-CREDIT-ACCEPT-DT
 10742                                    PB-I-LF-EXPIRE-DT
 10743                                    PB-I-AH-EXPIRE-DT
 10744                                    PB-BILLED-DT
 10745                                    PB-ACCT-EFF-DT
 10746                                    PB-ACCT-EXP-DT
 10747                                    PB-I-1ST-PMT-DT.
 10748
 10749     MOVE 'X'                    TO PB-FATAL-FLAG.
 10750
 10751     MOVE WS-CREDIT-SELECT-DT    TO PB-CREDIT-SELECT-DT.
 10752
 10753     IF BLSTNML GREATER THAN ZEROS
 10754         MOVE BLSTNMI            TO PB-I-INSURED-LAST-NAME.
 10755
 10756*    IF BMICRNOL  GREATER  ZEROS
 10757*        MOVE BMICRNOI           TO  PB-I-MICROFILM-NO
 10758*    ELSE
 10759*        MOVE ZEROS              TO  PB-I-MICROFILM-NO.
 10760     IF BVINL > ZEROS
 10761        MOVE BVINI               TO PB-I-VIN
 10762     END-IF
 10763     IF B1STNML GREATER THAN ZEROS
 10764         MOVE B1STNMI            TO PB-I-INSURED-FIRST-NAME.
 10765
 10766     IF BINITL  GREATER THAN ZEROS
 10767         MOVE BINITI             TO PB-I-INSURED-MIDDLE-INIT.
 10768
 10769     IF BBIRTHL GREATER THAN ZERO
 10770         MOVE WS-CONVERTED-BIRTH TO PB-I-BIRTHDAY
 10771     ELSE
 10772         MOVE LOW-VALUES         TO PB-I-BIRTHDAY.
 10773
 10774     IF B1STPMTL GREATER THAN ZERO
 10775         MOVE WS-CONVERTED-1ST-PMT-DT TO PB-I-1ST-PMT-DT
 10776     ELSE
 10777         MOVE LOW-VALUES              TO PB-I-1ST-PMT-DT.
 10778
 10779     IF BAGEL    GREATER THAN ZEROS
 10780         MOVE BAGEI              TO PB-I-AGE
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 198
* EL6311.cbl
 10781        ELSE
 10782         MOVE ZEROS              TO PB-I-AGE.
 10783
 10784     IF BSEXL    GREATER THAN ZEROS
 10785         MOVE BSEXI              TO PB-I-INSURED-SEX.
 10786
 10787     IF BTERM-LEN (1) GREATER THAN ZEROS
 10788        MOVE WS-BTERM (1)        TO PB-I-LF-TERM
 10789     ELSE
 10790        MOVE ZEROS               TO PB-I-LF-TERM.
 10791
 10792     IF BTERM-LEN (2) GREATER THAN ZEROS
 10793        MOVE WS-BTERM (2)        TO PB-I-AH-TERM
 10794     ELSE
 10795        MOVE ZEROS               TO PB-I-AH-TERM.
 10796
 10797     IF BLNTRML       GREATER THAN ZEROS
 10798         MOVE BLNTRMI            TO PB-I-LOAN-TERM
 10799        ELSE
 10800         MOVE ZEROS              TO PB-I-LOAN-TERM.
 10801
 10802     IF BFREQL        GREATER THAN ZEROS
 10803         MOVE BFREQI             TO PB-I-PAY-FREQUENCY
 10804        ELSE
 10805         MOVE ZEROS              TO PB-I-PAY-FREQUENCY.
 10806
 10807     IF BSKPCDL       GREATER THAN ZEROS
 10808         MOVE BSKPCDI            TO PB-I-SKIP-CODE.
 10809
 10810     IF BMODEL        GREATER THAN ZEROS
 10811         MOVE BMODEI             TO PB-I-TERM-TYPE
 10812                                    PI-BMODE.
 10813
 10814     IF BPMTSL        GREATER THAN ZEROS
 10815         MOVE BPMTSI             TO PB-I-NO-OF-PAYMENTS
 10816                                    PI-BPMTS
 10817        ELSE
 10818         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS
 10819                                    PI-BPMTS.
 10820
 10821     IF BPMTAMTL      GREATER THAN ZEROS
 10822         MOVE PI-BPMTAMT         TO PB-I-PAYMENT-AMOUNT
 10823        ELSE
 10824         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.
 10825
 10826     IF BTYPE-LEN (1)   GREATER THAN ZEROS
 10827        IF BTYPE  (1)   NOT = ZEROS
 10828           MOVE BTYPE (1)        TO PB-I-LF-INPUT-CD
 10829                                    PI-BTYPE (1)
 10830           MOVE ZEROS            TO PB-I-LF-BENEFIT-CD
 10831           MOVE SPACES           TO PB-I-LF-ABBR
 10832        ELSE
 10833           MOVE SPACES           TO PB-I-LF-INPUT-CD
 10834                                    PB-I-LF-ABBR
 10835           MOVE ZEROS            TO PB-I-LF-BENEFIT-CD
 10836     ELSE
 10837        MOVE SPACES              TO PB-I-LF-INPUT-CD
 10838                                    PB-I-LF-ABBR
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 199
* EL6311.cbl
 10839        MOVE ZEROS               TO PB-I-LF-BENEFIT-CD.
 10840
 10841     IF  BBEN-LEN      (1)  GREATER THAN ZEROS
 10842         MOVE WS-BBEN  (1)       TO PB-I-LF-BENEFIT-AMT
 10843     ELSE
 10844         MOVE ZEROS              TO PB-I-LF-BENEFIT-AMT.
 10845
 10846     IF  BALT-BEN-LEN     (1)  GREATER THAN ZEROS
 10847         MOVE WS-BALT-BEN (1)    TO PB-I-LF-ALT-BENEFIT-AMT
 10848     ELSE
 10849         MOVE ZEROS              TO PB-I-LF-ALT-BENEFIT-AMT.
 10850
 10851     IF  BPREM-LEN     (1)  GREATER THAN ZEROS
 10852         IF WS-BPREM   (1)  NOT = WS-ALL-NINES
 10853            ADD  WS-BPREM (1)    TO WS-B-LF-ISS-PRM-ENTERED
 10854            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 10855         ELSE
 10856            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 10857*           MOVE ZEROS           TO PB-I-LF-PREMIUM-AMT
 10858*           MOVE '?'             TO PB-I-LF-CALC-FLAG
 10859         END-IF
 10860     ELSE
 10861         MOVE ZEROS              TO PB-I-LF-PREMIUM-AMT.
 10862
 10863     IF  BCPREM-LEN     (1)  GREATER THAN ZEROS
 10864         MOVE WS-BCPREM (1)      TO PB-I-LF-PREM-CALC.
 10865
 10866     IF  BALT-PREM-LEN     (1)  GREATER THAN ZEROS
 10867         ADD  WS-BALT-PREM (1) TO WS-B-LF-ISS-PRM-ENTERED
 10868         MOVE WS-BALT-PREM (1) TO PB-I-LF-ALT-PREMIUM-AMT
 10869     ELSE
 10870         MOVE ZEROS            TO PB-I-LF-ALT-PREMIUM-AMT.
 10871
 10872     IF  BALT-PREM-LEN     (2) > ZEROS
 10873         MOVE WS-BALT-PREM (2) TO PB-I-TOT-FEES
 10874     ELSE
 10875         MOVE ZEROS            TO PB-I-TOT-FEES.
 10876
 10877     IF BTYPE-LEN     (2)   GREATER THAN ZEROS
 10878        IF BTYPE      (2)   NOT = ZEROS
 10879           MOVE BTYPE (2)      TO PB-I-AH-INPUT-CD
 10880                                  PI-BTYPE (2)
 10881           MOVE ZEROS          TO PB-I-AH-BENEFIT-CD
 10882           MOVE SPACES         TO PB-I-AH-ABBR
 10883        ELSE
 10884           MOVE SPACES         TO PB-I-AH-INPUT-CD
 10885                                  PB-I-AH-ABBR
 10886           MOVE ZEROS          TO PB-I-AH-BENEFIT-CD
 10887     ELSE
 10888        MOVE SPACES            TO PB-I-AH-INPUT-CD
 10889                                  PB-I-AH-ABBR
 10890        MOVE ZEROS             TO PB-I-AH-BENEFIT-CD.
 10891
 10892     IF  BBEN-LEN         (2)  GREATER THAN ZEROS
 10893         MOVE WS-BBEN     (2)  TO PB-I-AH-BENEFIT-AMT
 10894     ELSE
 10895         MOVE ZEROS            TO PB-I-AH-BENEFIT-AMT.
 10896
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 200
* EL6311.cbl
 10897     IF  BPREM-LEN     (2)  GREATER THAN ZEROS
 10898         IF WS-BPREM   (2)  NOT = WS-ALL-NINES
 10899            ADD  WS-BPREM (2)    TO WS-B-AH-ISS-PRM-ENTERED
 10900            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 10901         ELSE
 10902            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 10903*           MOVE ZEROS           TO PB-I-AH-PREMIUM-AMT
 10904*           MOVE '?'             TO PB-I-AH-CALC-FLAG
 10905         END-IF
 10906     ELSE
 10907         MOVE ZEROS              TO PB-I-AH-PREMIUM-AMT.
 10908
 10909     IF  BCPREM-LEN     (2)  GREATER THAN ZEROS
 10910         MOVE WS-BCPREM (2)      TO PB-I-AH-PREM-CALC.
 10911
 10912     IF BCRIT-PERD-LEN      (1)   GREATER THAN ZEROS
 10913        MOVE WS-BCRIT-PERD  (1)   TO PB-I-LF-CRIT-PER
 10914     ELSE
 10915        MOVE ZEROS                TO PB-I-LF-CRIT-PER.
 10916
 10917     IF BCRIT-PERD-LEN      (2)   GREATER THAN ZEROS
 10918        MOVE WS-BCRIT-PERD  (2)   TO PB-I-AH-CRIT-PER
 10919     ELSE
 10920        MOVE ZEROS                TO PB-I-AH-CRIT-PER.
 10921
 10922     IF BINDGRPL  GREATER THAN ZEROS
 10923         MOVE BINDGRPI           TO PB-I-INDV-GRP-OVRD.
 10924
 10925     IF BRTCLSL   GREATER THAN ZEROS
 10926         MOVE BRTCLSI            TO PB-I-RATE-CLASS-OVRD.
 10927
 10928     IF BSIGL     GREATER THAN ZEROS
 10929         MOVE BSIGI              TO PB-I-SIG-SW.
 10930     IF BAPRL > ZEROS
 10931         MOVE WS-BAPR            TO PB-I-LOAN-APR
 10932     ELSE
 10933        if pi-company-id = 'CID'
 10934           move +99.9999         to pb-i-loan-apr
 10935        else
 10936           MOVE ZEROS            TO PB-I-LOAN-APR
 10937        end-if
 10938     end-if
 10939     IF BMEMBERL  GREATER THAN ZEROS
 10940         MOVE BMEMBERI       TO PB-I-MEMBER-NO.
 10941
 10942     IF BLNOFCRL  GREATER THAN ZEROS
 10943         MOVE BLNOFCRI           TO PB-I-LOAN-OFFICER.
 10944
 10945     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 10946        MOVE WS-CONVERTED-EXPIRDT (1) TO PB-I-LF-EXPIRE-DT
 10947     ELSE
 10948        MOVE LOW-VALUES               TO PB-I-LF-EXPIRE-DT.
 10949
 10950     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 10951        MOVE WS-CONVERTED-EXPIRDT (2) TO PB-I-AH-EXPIRE-DT
 10952     ELSE
 10953        MOVE LOW-VALUES               TO PB-I-AH-EXPIRE-DT.
 10954
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 201
* EL6311.cbl
 10955     IF BDAYSL   GREATER THAN ZEROS
 10956        MOVE BDAYSI              TO PB-I-TERM-IN-DAYS
 10957                                    PB-I-EXTENTION-DAYS
 10958     ELSE
 10959        MOVE ZEROS               TO PB-I-TERM-IN-DAYS
 10960                                    PB-I-EXTENTION-DAYS.
 10961
 10962     IF BDAYSL GREATER THAN ZEROS
 10963        MOVE '2'                 TO PB-I-DATA-ENTRY-SW.
 10964
 10965     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 10966        IF WS-CONVERTED-EXPIRDT   (1) GREATER THAN LOW-VALUES
 10967           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 10968
 10969     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 10970        IF WS-CONVERTED-EXPIRDT   (2) GREATER THAN LOW-VALUES
 10971           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 10972
 10973     IF B1STPMTL GREATER THAN ZEROS
 10974        MOVE '4'                 TO PB-I-DATA-ENTRY-SW.
 10975
 10976     IF PB-EXT-DAYS-PROCESSING
 10977        IF PB-I-EXTENTION-DAYS = ZEROS
 10978           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 10979
 10980     IF PB-EXPIRE-DT-PROCESSING
 10981        IF PB-I-LF-EXPIRE-DT = LOW-VALUES AND
 10982           PB-I-AH-EXPIRE-DT = LOW-VALUES
 10983             MOVE '1'            TO PB-I-DATA-ENTRY-SW.
 10984
 10985     IF PB-1ST-PMT-DT-PROCESSING
 10986        IF PB-I-1ST-PMT-DT = LOW-VALUES
 10987           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 10988
 10989     IF BREINL GREATER THAN ZEROS
 10990        MOVE BREINI              TO PB-I-SPECIAL-REIN-CODE.
 10991
 10992     IF BENTRYL NOT = ZEROS
 10993        MOVE BENTRYI             TO PB-BATCH-ENTRY
 10994        IF PI-COMPANY-ID = 'CID'
 10995           AND (PB-BATCH-ENTRY = 'P')
 10996           AND (PB-STATE = 'VA')
 10997           PERFORM 1500-UPDATE-ERNOTE
 10998                                 THRU 1500-EXIT
 10999        END-IF
 11000     END-IF
 11001     IF BUNWRITL NOT = ZEROS
 11002        MOVE BUNWRITI            TO PB-I-UNDERWRITING-STATUS.
 11003
 11004     IF BFORCEL NOT = ZEROS
 11005        MOVE BFORCEI             TO PB-FORCE-CODE.
 11006
 11007     IF BBILCDL NOT = ZEROS
 11008        MOVE BBILCDI             TO PB-RECORD-BILL.
 11009
 11010     IF BLIVESL GREATER THAN ZEROS
 11011        MOVE WS-BLIVES           TO PB-I-LIVES
 11012     ELSE
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 202
* EL6311.cbl
 11013        MOVE ZEROS               TO PB-I-LIVES.
 11014
 11015     IF BBILLEDL GREATER THAN ZEROS
 11016        MOVE WS-BILLED           TO PB-I-NUM-BILLED
 11017     ELSE
 11018        MOVE ZEROS               TO PB-I-NUM-BILLED.
 11019
 11020*    MOVE WS-REFERENCE           TO PB-I-REFERENCE.
 11021
 11022 1260-WRITE-PB-RECORD.
 11023     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY
 11024                                    PB-INPUT-BY.
 11025     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 11026     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT
 11027                                    PB-INPUT-DT.
 11028
 11029     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 11030     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 11031                                    PB-CONTROL-BY-ORIG-BATCH.
 11032
 11033
 11034     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 11035     MOVE WS-BATCH-CSR-ID        TO PB-CSR-ID.
 11036     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 11037     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 11038     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 11039
 11040     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 11041
 11042     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 11043
 11044     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 11045     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 11046     MOVE PB-SV-STATE            TO PI-SV-STATE.
 11047
 11048     ADD PB-I-LF-PREM-CALC       TO WS-B-LF-ISS-PRM-COMPUTED.
 11049     ADD PB-I-AH-PREM-CALC       TO WS-B-AH-ISS-PRM-COMPUTED.
 11050
 11051 1275-WRITE-PENDING-BUSINESS.
 11052     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 11053     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 11054     MOVE 'A'                    TO JP-RECORD-TYPE.
 11055     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11056
 11057
 11058* EXEC CICS HANDLE CONDITION
 11059*        DUPREC (1290-DUPLICATE-ALT-INDEX)
 11060*    END-EXEC.
 11061*    MOVE '"$%                   ! $ #00010842' TO DFHEIV0
 11062     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 11063     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11064     MOVE X'2420233030303130383432' TO DFHEIV0(25:11)
 11065     CALL 'kxdfhei1' USING DFHEIV0
 11066     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11067
 11068
 11069
 11070* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 203
* EL6311.cbl
 11071*        DATASET (FILE-ID-ERPNDB)
 11072*        FROM    (PENDING-BUSINESS)
 11073*        RIDFLD  (PB-CONTROL-PRIMARY)
 11074*    END-EXEC.
 11075     MOVE LENGTH OF
 11076      PENDING-BUSINESS
 11077       TO DFHEIV11
 11078*    MOVE '&$ L                  ''   #00010846' TO DFHEIV0
 11079     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11080     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11081     MOVE X'2020233030303130383436' TO DFHEIV0(25:11)
 11082     CALL 'kxdfhei1' USING DFHEIV0,
 11083           FILE-ID-ERPNDB,
 11084           PENDING-BUSINESS,
 11085           DFHEIV11,
 11086           PB-CONTROL-PRIMARY,
 11087           DFHEIV99,
 11088           DFHEIV99
 11089     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11090
 11091
 11092     ADD +1                      TO  WS-B-ISSUE-CNT-ENTERED.
 11093
 11094     PERFORM 8400-LOG-JOURNAL-RECORD *> New Issue record
 11095
 11096******************************************************************
 11097*       A D D  O R I G I N A L  C E R T  I N F O                 *
 11098******************************************************************
 11099     MOVE ELCERT-KEY             TO ERMAIL-KEY
 11100     MOVE ' '                    TO WS-ERMAIL-SW
 11101
 11102* EXEC CICS READ
 11103*       DATASET   (FILE-ID-ERMAIL)
 11104*       SET       (ADDRESS OF MAILING-DATA)
 11105*       RIDFLD    (ERMAIL-KEY)
 11106*       RESP      (WS-RESPONSE)
 11107*    END-EXEC
 11108*    MOVE '&"S        E          (  N#00010862' TO DFHEIV0
 11109     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11110     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11111     MOVE X'204E233030303130383632' TO DFHEIV0(25:11)
 11112     CALL 'kxdfhei1' USING DFHEIV0,
 11113           FILE-ID-ERMAIL,
 11114           DFHEIV20,
 11115           DFHEIV99,
 11116           ERMAIL-KEY,
 11117           DFHEIV99,
 11118           DFHEIV99,
 11119           DFHEIV99
 11120     SET ADDRESS OF MAILING-DATA TO
 11121         DFHEIV20
 11122     MOVE EIBRESP  TO WS-RESPONSE
 11123     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11124     IF RESP-NORMAL
 11125        SET ERMAIL-FOUND TO TRUE
 11126     END-IF
 11127
 11128     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 204
* EL6311.cbl
 11129     MOVE SPACES                 TO ORIGINAL-CERTIFICATE
 11130     MOVE 'OC'                   TO OC-RECORD-ID
 11131     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 11132                                 TO OC-CONTROL-PRIMARY (1:33)
 11133     MOVE 'I'                    TO OC-RECORD-TYPE
 11134     MOVE +4096                  TO OC-KEY-SEQ-NO
 11135     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
 11136     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
 11137     MOVE WS-CURRENT-BIN-DT      TO OC-LAST-MAINT-DT
 11138     MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 11139     MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 11140     MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 11141     MOVE PB-I-AGE               TO OC-INS-AGE
 11142     MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 11143     MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 11144     MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 11145     MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 11146     MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 11147     MOVE PB-I-LF-TERM           TO OC-LF-TERM
 11148     MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 11149     MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 11150     MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 11151     MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 11152     MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 11153     IF PB-I-JOINT-COMMISSION > +0
 11154         MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 11155     ELSE
 11156         MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 11157     END-IF
 11158     MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
 11159     MOVE +0                     TO OC-LF-CANCEL-AMT
 11160                                    OC-LF-ITD-CANCEL-AMT
 11161     MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 11162     MOVE PB-I-AH-TERM           TO OC-AH-TERM
 11163     MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 11164     MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 11165     MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 11166     MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 11167     MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 11168     MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
 11169     MOVE +0                     TO OC-AH-CANCEL-AMT
 11170                                    OC-AH-ITD-CANCEL-AMT
 11171     MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 11172     MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 11173     MOVE 'N'                    TO OC-CANCEL-TRAN-IND
 11174     IF ERMAIL-FOUND
 11175        MOVE MA-CRED-BENE-NAME   TO OC-CRED-BENE-NAME
 11176     END-IF
 11177     IF NOT CERT-TRL-REC-NOT-FOUND
 11178        MOVE CS-INS-AGE-DEFAULT-FLAG TO
 11179                           OC-INS-AGE-DEFAULT-FLAG
 11180        MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 11181                           OC-JNT-AGE-DEFAULT-FLAG
 11182     END-IF
 11183     MOVE LOW-VALUES             TO OC-ENDORSEMENT-PROCESSED-DT
 11184     .
 11185 1275-WRITE-ELCRTO.
 11186
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 205
* EL6311.cbl
 11187* EXEC CICS WRITE
 11188*       DATASET   ('ELCRTO')
 11189*       FROM      (ORIGINAL-CERTIFICATE)
 11190*       RIDFLD    (OC-CONTROL-PRIMARY)
 11191*       RESP      (WS-RESPONSE)
 11192*    END-EXEC
 11193     MOVE LENGTH OF
 11194      ORIGINAL-CERTIFICATE
 11195       TO DFHEIV11
 11196     MOVE 'ELCRTO' TO DFHEIV1
 11197*    MOVE '&$ L                  ''  N#00010930' TO DFHEIV0
 11198     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11199     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11200     MOVE X'204E233030303130393330' TO DFHEIV0(25:11)
 11201     CALL 'kxdfhei1' USING DFHEIV0,
 11202           DFHEIV1,
 11203           ORIGINAL-CERTIFICATE,
 11204           DFHEIV11,
 11205           OC-CONTROL-PRIMARY,
 11206           DFHEIV99,
 11207           DFHEIV99
 11208     MOVE EIBRESP  TO WS-RESPONSE
 11209     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11210*    display ' just wrote 1275 ' ws-response
 11211     IF RESP-DUPKEY
 11212        SUBTRACT +1              FROM OC-KEY-SEQ-NO
 11213        GO TO 1275-WRITE-ELCRTO
 11214     ELSE
 11215        IF NOT RESP-NORMAL
 11216           MOVE -1               TO BMAINTL
 11217           MOVE ER-7450          TO EMI-ERROR
 11218           PERFORM 9900-ERROR-FORMAT
 11219                                 THRU 9900-EXIT
 11220           GO TO 8200-SEND-DATAONLY
 11221        END-IF
 11222     END-IF
 11223******************************************************************
 11224*       U P D A T E   T H E   B A T C H   H E A D E R            *
 11225******************************************************************
 11226
 11227
 11228* EXEC CICS READ
 11229*        INTO    (PENDING-BUSINESS)
 11230*        DATASET (FILE-ID-ERPNDB)
 11231*        RIDFLD  (ERPNDB-KEY)
 11232*        UPDATE
 11233*    END-EXEC.
 11234     MOVE LENGTH OF
 11235      PENDING-BUSINESS
 11236       TO DFHEIV11
 11237*    MOVE '&"IL       EU         (   #00010953' TO DFHEIV0
 11238     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11239     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11240     MOVE X'2020233030303130393533' TO DFHEIV0(25:11)
 11241     CALL 'kxdfhei1' USING DFHEIV0,
 11242           FILE-ID-ERPNDB,
 11243           PENDING-BUSINESS,
 11244           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 206
* EL6311.cbl
 11245           ERPNDB-KEY,
 11246           DFHEIV99,
 11247           DFHEIV99,
 11248           DFHEIV99
 11249     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11250
 11251
 11252     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 11253     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 11254     MOVE 'B'                    TO JP-RECORD-TYPE.
 11255     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11256
 11257     PERFORM 8400-LOG-JOURNAL-RECORD  *> Before BHDR Image
 11258
 11259     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 11260
 11261
 11262* EXEC CICS REWRITE
 11263*        DATASET (FILE-ID-ERPNDB)
 11264*        FROM    (PENDING-BUSINESS)
 11265*    END-EXEC.
 11266     MOVE LENGTH OF
 11267      PENDING-BUSINESS
 11268       TO DFHEIV11
 11269*    MOVE '&& L                  %   #00010969' TO DFHEIV0
 11270     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11271     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11272     MOVE X'2020233030303130393639' TO DFHEIV0(25:11)
 11273     CALL 'kxdfhei1' USING DFHEIV0,
 11274           FILE-ID-ERPNDB,
 11275           PENDING-BUSINESS,
 11276           DFHEIV11,
 11277           DFHEIV99
 11278     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11279
 11280
 11281     MOVE 'C'                    TO JP-RECORD-TYPE.
 11282     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11283
 11284     PERFORM 8400-LOG-JOURNAL-RECORD  *> After BHDR Image
 11285
 11286     IF WS-ERRORS-PRESENT
 11287         GO TO 3900-RE-DISPLAY-RECORD.
 11288
 11289     MOVE ZEROS                  TO EMI-ERROR.
 11290     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11291     MOVE LOW-VALUES             TO EL631BI.
 11292     MOVE  -1                    TO BMAINTL.
 11293     GO TO 8100-SEND-INITIAL-MAP.
 11294
 11295 1280-BATCH-HDR-NOT-FOUND.
 11296     MOVE -1                     TO BMAINTL.
 11297     MOVE ER-7450                TO EMI-ERROR.
 11298     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11299     GO TO 8200-SEND-DATAONLY.
 11300
 11301 1290-DUPLICATE-ALT-INDEX.
 11302
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 207
* EL6311.cbl
 11303******************************************************************
 11304*                                                                *
 11305*      IF THE PB-B-HIGHEST-SEQ-NO WAS NOT UPDATED IN THE DATA    *
 11306*         ENTRY SESSION, ADD +1 TO THE HIGHEST SEQUENCE NUMBER   *
 11307*         AND ATTEMPT TO WRITE THE RECORD AGAIN. REPEAT THIS     *
 11308*         50 TIMES.  IF DUPREC CONDITION IS STILL ENCOUNTERED    *
 11309*         AFTER 50 TIMES, ASSUME THE DUPLICATE RECORD WAS        *
 11310*         CAUSED BY A DUPLICATE ALTERNATE KEY.                   *
 11311*                                                                *
 11312******************************************************************
 11313
 11314     IF LCP-ONCTR-01 =  0
 11315         ADD 1 TO LCP-ONCTR-01
 11316        MOVE +0                  TO WS-SEQ-NO-COUNTER.
 11317
 11318     ADD +1                      TO WS-SEQ-NO-COUNTER.
 11319
 11320     IF  WS-SEQ-NO-COUNTER GREATER THAN +50
 11321         NEXT SENTENCE
 11322     ELSE
 11323         ADD +1 TO PB-BATCH-SEQ-NO
 11324                   PB-CSR-BATCH-SEQ-NO
 11325         MOVE PB-BATCH-SEQ-NO TO WS-B-HIGHEST-SEQ-NO
 11326         GO TO 1275-WRITE-PENDING-BUSINESS.
 11327
 11328     MOVE -1                     TO BCERTNOL.
 11329     MOVE AL-UABON               TO BCERTNOA.
 11330     MOVE AL-UNBON               TO BEFFDTA.
 11331
 11332     MOVE 1                      TO EMI-SUB
 11333                                    EMI-SWITCH1
 11334                                    EMI-SWITCH-AREA-1
 11335                                    EMI-SWITCH-AREA-2.
 11336
 11337     MOVE SPACES                 TO EMI-ERROR-LINES.
 11338
 11339
 11340* EXEC CICS SYNCPOINT ROLLBACK
 11341*    END-EXEC.
 11342*    MOVE '6"R                   !   #00011032' TO DFHEIV0
 11343     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 11344     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11345     MOVE X'2020233030303131303332' TO DFHEIV0(25:11)
 11346     CALL 'kxdfhei1' USING DFHEIV0
 11347     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11348
 11349
 11350     MOVE ER-2247                TO EMI-ERROR.
 11351     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11352     GO TO 8200-SEND-DATAONLY.
 11353
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 208
* EL6311.cbl
 11355
 11356
 11357 1295-READ-CERT-TRAILER.
 11358
 11359
 11360* EXEC CICS GETMAIN
 11361*        SET     (ADDRESS OF CERTIFICATE-TRAILERS)
 11362*        LENGTH  (ELCRTT-RECORD-LENGTH)
 11363*        INITIMG (GETMAIN-SPACE)
 11364*    END-EXEC
 11365*    MOVE ',"IL                  $   #00011044' TO DFHEIV0
 11366     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11367     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11368     MOVE X'2020233030303131303434' TO DFHEIV0(25:11)
 11369     CALL 'kxdfhei1' USING DFHEIV0,
 11370           DFHEIV20,
 11371           ELCRTT-RECORD-LENGTH,
 11372           GETMAIN-SPACE
 11373     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 11374         DFHEIV20
 11375     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11376
 11377     MOVE +0                     TO  WS-CERT-TRL-REC-NOT-FOUND.
 11378     MOVE ELCERT-KEY             TO  ELCRTT-PRIMARY.
 11379     MOVE 'C'                    TO  ELCRTT-REC-TYPE.
 11380
 11381
 11382* EXEC CICS HANDLE CONDITION
 11383*        NOTFND (1295-CERT-TRL-REC-NOTFND)
 11384*    END-EXEC.
 11385*    MOVE '"$I                   ! % #00011054' TO DFHEIV0
 11386     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11387     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11388     MOVE X'2520233030303131303534' TO DFHEIV0(25:11)
 11389     CALL 'kxdfhei1' USING DFHEIV0
 11390     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11391
 11392
 11393
 11394* EXEC CICS READ
 11395*        DATASET  (CRTT-ID)
 11396*        RIDFLD   (ELCRTT-KEY)
 11397*        INTO     (CERTIFICATE-TRAILERS)
 11398*    END-EXEC.
 11399     MOVE LENGTH OF
 11400      CERTIFICATE-TRAILERS
 11401       TO DFHEIV11
 11402*    MOVE '&"IL       E          (   #00011058' TO DFHEIV0
 11403     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11404     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11405     MOVE X'2020233030303131303538' TO DFHEIV0(25:11)
 11406     CALL 'kxdfhei1' USING DFHEIV0,
 11407           CRTT-ID,
 11408           CERTIFICATE-TRAILERS,
 11409           DFHEIV11,
 11410           ELCRTT-KEY,
 11411           DFHEIV99,
 11412           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 209
* EL6311.cbl
 11413           DFHEIV99
 11414     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11415
 11416
 11417     GO TO 1295-EXIT.
 11418
 11419 1295-CERT-TRL-REC-NOTFND.
 11420     MOVE +1                     TO WS-CERT-TRL-REC-NOT-FOUND.
 11421
 11422 1295-EXIT.
 11423     EXIT.
 11424
 11425******************************************************************
 11426*                                                                *
 11427*          C H A N G E   I S S U E   R O U T I N E               *
 11428*                                                                *
 11429******************************************************************
 11430
 11431***************************************************************
 11432*                                                             *
 11433*     1. GETMAIN FOR PENDING BUSINESS RECORD.                 *
 11434*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
 11435*     3. GET THE RECORD TO BE UPDATED AND SEE IF IT HAS BEEN  *
 11436*              BILLED.  IF IT HAS THEN SAVE A -COPY- OF THE   *
 11437*              ZERO RECORD FOR CREATING REVERSAL ENTRIES.     *
 11438*     4. UPDATE THE RECORD WITH THE SCREEN DATA               *
 11439*     5. LINK TO THE EDIT ROUTINE.                            *
 11440*     6. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
 11441*     7. REDISPLAY SCREEN DATA WITH NEW DATA RETURNED FROM    *
 11442*              THE EDIT ROUTINE.                              *
 11443*     7. REWRITE THE NEW ISSUE                                *
 11444*     8. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
 11445*                                                             *
 11446***************************************************************
 11447
 11448 1300-CHANGE-ISSUE-ROUTINE.
 11449     MOVE 'C'                    TO PI-MAINT-FUNCTION.
 11450
 11451     IF BCHGL NOT = ZEROS
 11452        MOVE ER-2196             TO EMI-ERROR
 11453        MOVE AL-UABON            TO BMAINTA
 11454        MOVE -1                  TO BMAINTL
 11455        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11456        GO TO 8200-SEND-DATAONLY.
 11457
 11458     MOVE BCERTNOI               TO WS-NEW-PRIME.
 11459
 11460     IF BSUFIXL NOT = ZEROS
 11461        MOVE BSUFIXI             TO WS-NEW-SUFFIX
 11462     ELSE
 11463        MOVE SPACE               TO WS-NEW-SUFFIX.
 11464
 11465     MOVE BEFFDTI                TO DEEDIT-FIELD.
 11466     PERFORM 8600-DEEDIT.
 11467     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 11468     MOVE '4'                    TO DC-OPTION-CODE.
 11469     PERFORM 9700-DATE-LINK.
 11470     IF DATE-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 210
* EL6311.cbl
 11471        MOVE ER-0348             TO EMI-ERROR
 11472        MOVE -1                  TO BEFFDTL
 11473        MOVE AL-UABON            TO BEFFDTA
 11474        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11475        GO TO 8200-SEND-DATAONLY
 11476     ELSE
 11477        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
 11478        MOVE AL-UANON            TO BEFFDTA
 11479        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 11480
 11481 1325-PROCESS-ISSUE-CHANGES.
 11482
 11483* EXEC CICS HANDLE CONDITION
 11484*         NOTFND    (1380-BATCH-HDR-NOT-FOUND)
 11485*    END-EXEC.
 11486*    MOVE '"$I                   ! & #00011129' TO DFHEIV0
 11487     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11488     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11489     MOVE X'2620233030303131313239' TO DFHEIV0(25:11)
 11490     CALL 'kxdfhei1' USING DFHEIV0
 11491     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11492
 11493
 11494     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 11495     MOVE +9999                   TO ERPNDB-BATCH-SEQ-NO.
 11496     MOVE ZEROS                   TO ERPNDB-BATCH-CHG-SEQ-NO.
 11497
 11498
 11499* EXEC CICS GETMAIN
 11500*        SET      (ADDRESS OF PENDING-BUSINESS)
 11501*        LENGTH   (ERPNDB-RECORD-LENGTH)
 11502*        INITIMG  (GETMAIN-SPACE)
 11503*     END-EXEC.
 11504*    MOVE ',"IL                  $   #00011137' TO DFHEIV0
 11505     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11506     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11507     MOVE X'2020233030303131313337' TO DFHEIV0(25:11)
 11508     CALL 'kxdfhei1' USING DFHEIV0,
 11509           DFHEIV20,
 11510           ERPNDB-RECORD-LENGTH,
 11511           GETMAIN-SPACE
 11512     SET ADDRESS OF PENDING-BUSINESS TO
 11513         DFHEIV20
 11514     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11515
 11516
 11517
 11518* EXEC CICS READ
 11519*        INTO    (PENDING-BUSINESS)
 11520*        DATASET (FILE-ID-ERPNDB)
 11521*        RIDFLD  (ERPNDB-KEY)
 11522*    END-EXEC.
 11523     MOVE LENGTH OF
 11524      PENDING-BUSINESS
 11525       TO DFHEIV11
 11526*    MOVE '&"IL       E          (   #00011143' TO DFHEIV0
 11527     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11528     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 211
* EL6311.cbl
 11529     MOVE X'2020233030303131313433' TO DFHEIV0(25:11)
 11530     CALL 'kxdfhei1' USING DFHEIV0,
 11531           FILE-ID-ERPNDB,
 11532           PENDING-BUSINESS,
 11533           DFHEIV11,
 11534           ERPNDB-KEY,
 11535           DFHEIV99,
 11536           DFHEIV99,
 11537           DFHEIV99
 11538     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11539
 11540
 11541     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 11542
 11543
 11544* EXEC CICS HANDLE CONDITION
 11545*         NOTFND     (1385-REC-NOT-FOUND)
 11546*    END-EXEC.
 11547*    MOVE '"$I                   ! '' #00011151' TO DFHEIV0
 11548     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11549     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11550     MOVE X'2720233030303131313531' TO DFHEIV0(25:11)
 11551     CALL 'kxdfhei1' USING DFHEIV0
 11552     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11553
 11554
 11555**********************************************************
 11556*      DONT READ THE RECORD FOR UPDATE UNTIL             *
 11557*      AFTER THE CHANGE RECORD HAS BEEN CREATED.         *
 11558**********************************************************
 11559
 11560
 11561* EXEC CICS READ
 11562*        DATASET (FILE-ID-ERPNDB)
 11563*        INTO    (PENDING-BUSINESS)
 11564*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 11565*    END-EXEC.
 11566     MOVE LENGTH OF
 11567      PENDING-BUSINESS
 11568       TO DFHEIV11
 11569*    MOVE '&"IL       E          (   #00011160' TO DFHEIV0
 11570     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11571     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11572     MOVE X'2020233030303131313630' TO DFHEIV0(25:11)
 11573     CALL 'kxdfhei1' USING DFHEIV0,
 11574           FILE-ID-ERPNDB,
 11575           PENDING-BUSINESS,
 11576           DFHEIV11,
 11577           PI-PREV-CONTROL-PRIMARY,
 11578           DFHEIV99,
 11579           DFHEIV99,
 11580           DFHEIV99
 11581     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11582
 11583
 11584********** DO NOT ALLOW CHANGES IF THRU A/R
 11585     IF BMAINTI = 'C'
 11586         IF PB-EL860-INTERNAL-PROCESS
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 212
* EL6311.cbl
 11587             MOVE ER-4005          TO EMI-ERROR
 11588             MOVE -1               TO BMAINTL
 11589             MOVE AL-UABON         TO BMAINTA
 11590             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11591             GO TO 8200-SEND-DATAONLY.
 11592**********
 11593     MOVE PB-ISSUE-RECORD TO WS-SAVE-PEND-ISSUE
 11594
 11595     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 11596        MOVE -1                 TO BMAINTL
 11597        MOVE ER-2197            TO EMI-ERROR
 11598        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11599        GO TO 8200-SEND-DATAONLY.
 11600
 11601     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 11602        MOVE ER-2196             TO EMI-ERROR
 11603        MOVE AL-UABON            TO BMAINTA
 11604        MOVE -1                  TO BMAINTL
 11605        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11606        GO TO 8200-SEND-DATAONLY.
 11607
 11608     MOVE ZEROS                  TO WS-SEQ-SAVE.
 11609
 11610     IF PB-BILLED-DT = LOW-VALUES AND
 11611        PB-CHG-COUNT = ZEROS
 11612        NEXT SENTENCE
 11613     ELSE
 11614        IF (BPREM-LEN (1) GREATER THAN ZEROS AND
 11615            WS-BPREM  (1) NOT = PB-I-LF-PREMIUM-AMT)
 11616           OR
 11617           (BPREM-LEN (2) GREATER THAN ZEROS AND
 11618            WS-BPREM  (2) NOT = PB-I-AH-PREMIUM-AMT)
 11619           PERFORM 2700-BUILD-CORRECTION-RECORD THRU 2799-EXIT.
 11620     move zeros                  to ws-check-amts
 11621     move ' '                    to ws-stop-sw
 11622                                    ws-check-sw
 11623                                    ws-proc-check-sw
 11624                                    ws-any-check-sw
 11625                                    ws-chek-browse-sw
 11626
 11627     perform 2500-browse-checks  thru 2500-exit
 11628
 11629     if i-have-processed-checks
 11630        or i-have-checks
 11631        continue
 11632     else
 11633        go to 1330-continue
 11634     end-if
 11635
 11636     compute ws-tot-orig-prem =
 11637        pb-i-lf-premium-amt + pb-i-ah-premium-amt +
 11638        pb-i-lf-alt-premium-amt
 11639
 11640     if bprem1l <> zeros
 11641        MOVE AL-UNNON            TO bprem1a
 11642        move ws-bprem (1)        to ws-new-iss-total
 11643     else
 11644        move pb-i-lf-premium-amt to ws-new-iss-total
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 213
* EL6311.cbl
 11645     end-if
 11646     display ' new iss totala ' ws-new-iss-total
 11647
 11648     if baltpr1l <> zeros
 11649        MOVE AL-UNNON            TO baltpr1a
 11650        compute ws-new-iss-total =
 11651           ws-new-iss-total + ws-balt-prem(1)
 11652     else
 11653        compute ws-new-iss-total =
 11654           ws-new-iss-total + pb-i-lf-alt-premium-amt
 11655     end-if
 11656
 11657     if bprem2l <> zeros
 11658        MOVE AL-UNNON            TO bprem2a
 11659        compute ws-new-iss-total = ws-new-iss-total +
 11660           ws-bprem (2)
 11661     else
 11662        compute ws-new-iss-total = ws-new-iss-total +
 11663           pb-i-ah-premium-amt
 11664     end-if
 11665
 11666     if (ws-new-iss-total + ws-check-amts) = ws-tot-orig-prem
 11667        if ((bprem1l <> zeros)
 11668           and (ws-bprem (1) <> pb-i-lf-premium-amt))
 11669                      or
 11670           ((bprem2l <> zeros)
 11671           and (ws-bprem (2) <> pb-i-ah-premium-amt))
 11672           move er-3456          to emi-error
 11673           perform 9900-error-format
 11674                                 thru 9900-exit
 11675           go to 1330-continue
 11676        end-if
 11677     end-if
 11678
 11679     if ws-new-iss-total > ws-tot-orig-prem
 11680        move er-3458             to emi-error
 11681        perform 9900-error-format thru 9900-exit
 11682        move al-uabon            to bmainta
 11683        move -1                  to bmaintl
 11684        go to 8200-send-dataonly
 11685     end-if
 11686
 11687     if ws-new-iss-total < ws-tot-orig-prem
 11688        move er-3457             to emi-error
 11689        move al-uabon            to bprem1a
 11690                                    bprem2a
 11691        move +0 to bprem1l bprem2l
 11692        perform 9900-error-format thru 9900-exit
 11693        move -1                  to bmaintl
 11694        go to 1330-continue
 11695     end-if
 11696
 11697     .
 11698 1330-continue.
 11699
 11700
 11701* EXEC CICS READ
 11702*        DATASET (FILE-ID-ERPNDB)
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 214
* EL6311.cbl
 11703*        INTO    (PENDING-BUSINESS)
 11704*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 11705*        UPDATE
 11706*    END-EXEC.
 11707     MOVE LENGTH OF
 11708      PENDING-BUSINESS
 11709       TO DFHEIV11
 11710*    MOVE '&"IL       EU         (   #00011282' TO DFHEIV0
 11711     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11712     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11713     MOVE X'2020233030303131323832' TO DFHEIV0(25:11)
 11714     CALL 'kxdfhei1' USING DFHEIV0,
 11715           FILE-ID-ERPNDB,
 11716           PENDING-BUSINESS,
 11717           DFHEIV11,
 11718           PI-PREV-CONTROL-PRIMARY,
 11719           DFHEIV99,
 11720           DFHEIV99,
 11721           DFHEIV99
 11722     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11723
 11724
 11725     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 11726     MOVE 'B'                    TO JP-RECORD-TYPE
 11727     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11728     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 11729
 11730*    PERFORM 8400-LOG-JOURNAL-RECORD. *> move closer to rewite
 11731
 11732     IF PB-BILLED-DT NOT = LOW-VALUES OR
 11733        PB-CHG-COUNT NOT = ZEROS
 11734        IF (BPREM-LEN (1) GREATER THAN ZEROS AND
 11735            WS-BPREM  (1) NOT = PB-I-LF-PREMIUM-AMT)
 11736           OR
 11737           (BPREM-LEN (2) GREATER THAN ZEROS AND
 11738            WS-BPREM  (2) NOT = PB-I-AH-PREMIUM-AMT)
 11739            MOVE LOW-VALUES             TO PB-BILLED-DT
 11740            ADD +1                      TO PB-CHG-COUNT.
 11741
 11742     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 11743     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 11744     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 11745     MOVE '5'                    TO DC-OPTION-CODE.
 11746     PERFORM 9700-DATE-LINK
 11747     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 11748
 11749*    IF BMICRNOL  GREATER  ZEROS
 11750*        MOVE BMICRNOI           TO  PB-I-MICROFILM-NO.
 11751
 11752     IF BVINL > ZEROS
 11753        MOVE BVINI               TO PB-I-VIN
 11754     END-IF
 11755     IF (BFORCEL NOT = ZEROS)
 11756        AND (PB-COMPANY-ID = 'DCC' or 'VPP')
 11757        AND (BFORCEI = ' ')
 11758        AND (PB-FORCE-CODE = 'O')
 11759        COMPUTE PB-I-AH-PREMIUM-AMT =
 11760           PB-I-DCC-OVER-CHG-AMT + PB-I-AH-PREM-CALC
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 215
* EL6311.cbl
 11761        PERFORM 1800-REMOVE-CERT-NOTES
 11762                                 THRU 1800-EXIT
 11763        PERFORM 1900-DELETE-ERPYAJ
 11764                                 THRU 1900-EXIT
 11765        MOVE +0                  TO PB-I-DCC-OVER-CHG-AMT
 11766     END-IF
 11767     IF (BFORCEL NOT = ZEROS)
 11768        AND (PB-COMPANY-ID = 'DCC' or 'VPP')
 11769        AND (BFORCEI = 'O')
 11770        AND (PB-FORCE-CODE NOT = 'O')
 11771        COMPUTE WS-OC-AMT = PB-I-AH-PREMIUM-AMT -
 11772           PB-I-AH-PREM-CALC
 11773        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1
 11774        MOVE SPACE               TO DC-OPTION-CODE
 11775        PERFORM 9700-DATE-LINK
 11776        MOVE DC-GREG-DATE-A-EDIT TO WS-OC-DATE
 11777        MOVE WS-OC-AMT           TO PB-I-DCC-OVER-CHG-AMT
 11778        MOVE PB-I-AH-PREM-CALC   TO PB-I-AH-PREMIUM-AMT
 11779        MOVE WS-OC-AMT           TO WS-OC-DIS-AMT
 11780        PERFORM 1500-UPDATE-ERNOTE
 11781                                 THRU 1500-EXIT
 11782        PERFORM 1600-UPDATE-ERPYAJ
 11783                                 THRU 1600-EXIT
 11784     END-IF
 11785     IF BLSTNML  GREATER THAN ZEROS
 11786         MOVE BLSTNMI            TO PB-I-INSURED-LAST-NAME.
 11787
 11788     IF B1STNML  GREATER THAN ZEROS
 11789         MOVE B1STNMI            TO PB-I-INSURED-FIRST-NAME.
 11790
 11791     IF BINITL   GREATER THAN ZEROS
 11792         MOVE BINITI             TO PB-I-INSURED-MIDDLE-INIT.
 11793
 11794     IF BBIRTHL  GREATER THAN ZERO
 11795         MOVE WS-CONVERTED-BIRTH TO PB-I-BIRTHDAY.
 11796
 11797     IF B1STPMTL GREATER THAN ZERO
 11798         MOVE WS-CONVERTED-1ST-PMT-DT TO PB-I-1ST-PMT-DT.
 11799
 11800     IF BAGEL    GREATER THAN ZEROS
 11801         MOVE BAGEI              TO PB-I-AGE.
 11802
 11803     MOVE 'N'                    TO WS-INS-AGE-SET
 11804                                    WS-JNT-AGE-SET.
 11805     IF BAGEL    GREATER THAN ZEROS
 11806        MOVE 'Y'                TO WS-INS-AGE-SET
 11807        IF BAGEI = ZERO AND
 11808             (PB-I-BIRTHDAY = LOW-VALUES OR SPACES)
 11809           MOVE 'Y'             TO WS-INS-AGE-DEFAULTED
 11810           MOVE 'AGE*'          TO BAGEDEFO
 11811        ELSE
 11812           MOVE 'N'             TO WS-INS-AGE-DEFAULTED
 11813           MOVE 'AGE '          TO BAGEDEFO
 11814        END-IF
 11815        PERFORM 1386-UPDATE-AGE-FLAGS THRU 1386-EXIT
 11816     END-IF.
 11817
 11818     IF BSEXL    GREATER THAN ZEROS
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 216
* EL6311.cbl
 11819         MOVE BSEXI              TO PB-I-INSURED-SEX.
 11820
 11821     IF LETRREQL   GREATER THAN ZEROS
 11822        MOVE LETRREQI TO PB-I-LETTER-REQD
 11823     END-IF.
 11824
 11825     IF BTERM-LEN (1)   GREATER THAN ZEROS
 11826        MOVE WS-BTERM (1)        TO PB-I-LF-TERM.
 11827
 11828     IF BTERM-LEN (2)   GREATER THAN ZEROS
 11829        MOVE WS-BTERM (2)        TO PB-I-AH-TERM.
 11830
 11831     IF BLNTRML  GREATER THAN ZEROS
 11832         MOVE BLNTRMI            TO PB-I-LOAN-TERM.
 11833
 11834     IF BFREQL   GREATER THAN ZEROS
 11835         MOVE BFREQI             TO PB-I-PAY-FREQUENCY.
 11836
 11837     IF BSKPCDL  GREATER THAN ZEROS
 11838         MOVE BSKPCDI            TO PB-I-SKIP-CODE.
 11839
 11840     IF BMODEL   GREATER THAN ZEROS
 11841         MOVE BMODEI             TO PB-I-TERM-TYPE
 11842                                    PI-BMODE.
 11843
 11844     IF BPMTSL   GREATER THAN ZEROS
 11845         MOVE BPMTSI             TO PB-I-NO-OF-PAYMENTS
 11846                                    PI-BPMTS.
 11847
 11848     IF BPMTAMTL GREATER THAN ZEROS
 11849         MOVE PI-BPMTAMT         TO PB-I-PAYMENT-AMOUNT.
 11850
 11851     IF  BBEN-LEN      (1)  GREATER THAN ZEROS
 11852         MOVE WS-BBEN  (1)       TO PB-I-LF-BENEFIT-AMT.
 11853
 11854     IF  BALT-BEN-LEN     (1)  GREATER THAN ZEROS
 11855         MOVE WS-BALT-BEN (1)    TO PB-I-LF-ALT-BENEFIT-AMT.
 11856
 11857     MOVE SPACE TO PB-I-LF-CALC-FLAG.
 11858
 11859     IF  BPREM-LEN     (1)  GREATER THAN ZEROS
 11860         IF WS-BPREM   (1)  NOT = WS-ALL-NINES
 11861            SUBTRACT PB-I-LF-PREMIUM-AMT
 11862                     FROM WS-B-LF-ISS-PRM-ENTERED
 11863            ADD  WS-BPREM (1)    TO WS-B-LF-ISS-PRM-ENTERED
 11864            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 11865            MOVE SPACE           TO PB-I-LF-CALC-FLAG
 11866         ELSE
 11867            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 11868*           MOVE ZEROS           TO PB-I-LF-PREMIUM-AMT
 11869*           MOVE '?'             TO PB-I-LF-CALC-FLAG.
 11870         END-IF
 11871     END-IF.
 11872
 11873     IF  BALT-PREM-LEN     (1)  GREATER THAN ZEROS
 11874            SUBTRACT PB-I-LF-ALT-PREMIUM-AMT
 11875                     FROM WS-B-LF-ISS-PRM-ENTERED
 11876         ADD  WS-BALT-PREM (1) TO WS-B-LF-ISS-PRM-ENTERED
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 217
* EL6311.cbl
 11877         MOVE WS-BALT-PREM (1) TO PB-I-LF-ALT-PREMIUM-AMT.
 11878
 11879     IF  BALT-PREM-LEN     (2)  > ZEROS
 11880         MOVE WS-BALT-PREM (2) TO PB-I-TOT-FEES.
 11881
 11882     IF  BBEN-LEN (2)  GREATER THAN ZEROS
 11883         MOVE WS-BBEN (2)  TO PB-I-AH-BENEFIT-AMT.
 11884
 11885     IF  BPREM-LEN     (2)  GREATER THAN ZEROS
 11886         IF WS-BPREM   (2)  NOT = WS-ALL-NINES
 11887            SUBTRACT PB-I-AH-PREMIUM-AMT
 11888                     FROM WS-B-AH-ISS-PRM-ENTERED
 11889            ADD  WS-BPREM (2)    TO WS-B-AH-ISS-PRM-ENTERED
 11890            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 11891            MOVE SPACE           TO PB-I-AH-CALC-FLAG
 11892         ELSE
 11893            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 11894*           MOVE ZEROS           TO PB-I-AH-PREMIUM-AMT
 11895*           MOVE '?'             TO PB-I-AH-CALC-FLAG.
 11896         END-IF
 11897     END-IF
 11898
 11899     IF BCRIT-PERD-LEN      (1)   GREATER THAN ZEROS
 11900        MOVE WS-BCRIT-PERD  (1)   TO PB-I-LF-CRIT-PER.
 11901
 11902     IF BCRIT-PERD-LEN      (2)   GREATER THAN ZEROS
 11903        MOVE WS-BCRIT-PERD  (2)   TO PB-I-AH-CRIT-PER.
 11904
 11905     IF BINDGRPL            GREATER THAN ZEROS
 11906         MOVE BINDGRPI           TO PB-I-INDV-GRP-OVRD.
 11907
 11908     IF BRTCLSL             GREATER THAN ZEROS
 11909         MOVE BRTCLSI            TO PB-I-RATE-CLASS-OVRD.
 11910
 11911     IF BSIGL               GREATER THAN ZEROS
 11912         MOVE BSIGI              TO PB-I-SIG-SW.
 11913
 11914     IF BAPRL               GREATER THAN ZEROS
 11915         MOVE WS-BAPR            TO PB-I-LOAN-APR.
 11916
 11917     IF BMEMBERL            GREATER THAN ZEROS
 11918         MOVE BMEMBERI       TO PB-I-MEMBER-NO.
 11919
 11920     IF BLNOFCRL            GREATER THAN ZEROS
 11921         MOVE BLNOFCRI           TO PB-I-LOAN-OFFICER.
 11922
 11923     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 11924        MOVE WS-CONVERTED-EXPIRDT (1) TO PB-I-LF-EXPIRE-DT.
 11925
 11926     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 11927        MOVE WS-CONVERTED-EXPIRDT (2) TO PB-I-AH-EXPIRE-DT.
 11928
 11929     IF BDAYSL              GREATER THAN ZEROS
 11930        MOVE BDAYSI              TO PB-I-TERM-IN-DAYS
 11931                                    PB-I-EXTENTION-DAYS.
 11932
 11933     IF BDAYSL GREATER THAN ZEROS
 11934        MOVE '2'                 TO PB-I-DATA-ENTRY-SW.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 218
* EL6311.cbl
 11935
 11936     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 11937        IF WS-CONVERTED-EXPIRDT   (1) GREATER THAN LOW-VALUES
 11938           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 11939
 11940     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 11941        IF WS-CONVERTED-EXPIRDT   (2) GREATER THAN LOW-VALUES
 11942           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 11943
 11944     IF B1STPMTL GREATER THAN ZEROS
 11945        MOVE '4'                 TO PB-I-DATA-ENTRY-SW.
 11946
 11947     IF PB-EXT-DAYS-PROCESSING
 11948        IF PB-I-EXTENTION-DAYS = ZEROS
 11949           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 11950
 11951     IF PB-EXPIRE-DT-PROCESSING
 11952        IF PB-I-LF-EXPIRE-DT = LOW-VALUES AND
 11953           PB-I-AH-EXPIRE-DT = LOW-VALUES
 11954             MOVE '1'            TO PB-I-DATA-ENTRY-SW.
 11955
 11956     IF PB-1ST-PMT-DT-PROCESSING
 11957        IF PB-I-1ST-PMT-DT = LOW-VALUES
 11958           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 11959
 11960     IF BREINL GREATER THAN ZEROS
 11961        MOVE BREINI              TO PB-I-SPECIAL-REIN-CODE.
 11962
 11963     IF BFORCEL NOT = ZEROS
 11964        MOVE BFORCEI             TO PB-FORCE-CODE.
 11965     IF (BENTRYL NOT = ZEROS)
 11966        AND (PB-COMPANY-ID = 'CID')
 11967        AND (PB-STATE = 'VA')
 11968        AND (BENTRYI NOT = 'P')
 11969        AND (PB-BATCH-ENTRY = 'P')
 11970        PERFORM 1800-REMOVE-CERT-NOTES
 11971                                 THRU 1800-EXIT
 11972     END-IF
 11973     IF BENTRYL NOT = ZEROS
 11974        MOVE BENTRYI             TO PB-BATCH-ENTRY
 11975        IF PI-COMPANY-ID = 'CID'
 11976           AND (PB-BATCH-ENTRY = 'P')
 11977           AND (PB-STATE = 'VA')
 11978           PERFORM 1500-UPDATE-ERNOTE
 11979                                 THRU 1500-EXIT
 11980        END-IF
 11981     END-IF
 11982
 11983     IF BUNWRITL NOT = ZEROS
 11984        MOVE BUNWRITI            TO PB-I-UNDERWRITING-STATUS.
 11985
 11986     IF BBILCDL NOT = ZEROS
 11987        MOVE BBILCDI             TO PB-RECORD-BILL.
 11988
 11989     IF BLIVESL GREATER THAN ZEROS
 11990        MOVE WS-BLIVES           TO PB-I-LIVES.
 11991
 11992
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 219
* EL6311.cbl
 11993*DMD CUSTOM CODING*************START
 11994     IF PI-COMPANY-ID NOT = 'DMD'
 11995         MOVE ZEROS               TO BBILLEDL.
 11996*DMD CUSTOM CODING*************END
 11997
 11998     IF BBILLEDL GREATER THAN ZEROS
 11999        MOVE WS-BILLED           TO PB-I-NUM-BILLED.
 12000
 12001
 12002*****************************************************************
 12003*        IF BTYPE = ZEROS OR SPACES DELETE COVERAGE             *
 12004*****************************************************************
 12005
 12006     IF BTYPE-LEN (1)   GREATER THAN ZEROS
 12007        IF BTYPE  (1)   = ZEROS OR SPACES
 12008           IF REMOVE-LF-COVERAGE
 12009               MOVE SPACES           TO PB-I-LF-INPUT-CD
 12010                                        PI-BTYPE (1)
 12011               SUBTRACT PB-I-LF-PREMIUM-AMT FROM
 12012                                        WS-B-LF-ISS-PRM-ENTERED
 12013               SUBTRACT PB-I-LF-ALT-PREMIUM-AMT FROM
 12014                                        WS-B-LF-ISS-PRM-ENTERED
 12015               SUBTRACT PB-I-LF-PREM-CALC FROM
 12016                                        WS-B-LF-ISS-PRM-COMPUTED
 12017               MOVE ZEROS            TO PB-I-LF-TERM
 12018                                        PB-I-LF-BENEFIT-AMT
 12019                                        PB-I-LF-PREMIUM-AMT
 12020                                        PB-I-LF-BENEFIT-CD
 12021                                        PB-I-LF-PREM-CALC
 12022                                        PB-I-LF-CRIT-PER
 12023                                        PB-I-LF-ALT-BENEFIT-AMT
 12024                                        PB-I-LF-ALT-PREMIUM-AMT
 12025               MOVE LOW-VALUES       TO PB-I-LF-EXPIRE-DT
 12026           ELSE
 12027               NEXT SENTENCE
 12028        ELSE
 12029           MOVE BTYPE (1)        TO PB-I-LF-INPUT-CD
 12030                                    PI-BTYPE (1).
 12031     IF BTYPE-LEN (2)   GREATER THAN ZEROS
 12032        IF BTYPE  (2)   = ZEROS OR SPACES
 12033           IF  REMOVE-AH-COVERAGE
 12034               MOVE SPACES           TO PB-I-AH-INPUT-CD
 12035                                        PI-BTYPE (2)
 12036               SUBTRACT PB-I-AH-PREMIUM-AMT FROM
 12037                                        WS-B-AH-ISS-PRM-ENTERED
 12038               SUBTRACT PB-I-AH-PREM-CALC FROM
 12039                                        WS-B-AH-ISS-PRM-COMPUTED
 12040               MOVE ZEROS            TO PB-I-AH-TERM
 12041                                        PB-I-AH-BENEFIT-AMT
 12042                                        PB-I-AH-PREMIUM-AMT
 12043                                        PB-I-AH-BENEFIT-CD
 12044                                        PB-I-AH-PREM-CALC
 12045                                        PB-I-AH-CRIT-PER
 12046               MOVE LOW-VALUES       TO PB-I-AH-EXPIRE-DT
 12047           ELSE
 12048               NEXT SENTENCE
 12049        ELSE
 12050           MOVE BTYPE (2)        TO PB-I-AH-INPUT-CD
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 220
* EL6311.cbl
 12051                                    PI-BTYPE (2).
 12052 1360-REWRITE-PB-RECORD.
 12053     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 12054
 12055     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 12056     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT.
 12057
 12058     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 12059
 12060     SUBTRACT PB-I-LF-PREM-CALC  FROM WS-B-LF-ISS-PRM-COMPUTED.
 12061     SUBTRACT PB-I-AH-PREM-CALC  FROM WS-B-AH-ISS-PRM-COMPUTED.
 12062
 12063     IF BCPREM-LEN (1)  GREATER THAN ZEROS
 12064         MOVE WS-BCPREM (1)      TO PB-I-LF-PREM-CALC.
 12065
 12066     IF BCPREM-LEN (2)  GREATER THAN ZEROS
 12067         MOVE WS-BCPREM (2)      TO PB-I-AH-PREM-CALC.
 12068
 12069     IF CSR-EDIT-SESSION
 12070        PERFORM 139A-SET-LETTER-REQD THRU 139A-EXIT
 12071     END-IF.
 12072
 12073     PERFORM 1390-UPDATE-ERPNDM THRU 1399-EXIT.
 12074
 12075     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 12076
 12077     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 12078
 12079     IF ARCHIVE-LETTER-RELEASED
 12080        MOVE 'C' TO PB-I-LETTER-REQD
 12081        PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT
 12082        PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT
 12083     END-IF
 12084
 12085     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 12086     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 12087     MOVE PB-SV-STATE            TO PI-SV-STATE.
 12088
 12089     ADD  PB-I-LF-PREM-CALC      TO WS-B-LF-ISS-PRM-COMPUTED.
 12090     ADD  PB-I-AH-PREM-CALC      TO WS-B-AH-ISS-PRM-COMPUTED.
 12091
 12092 1375-REWRITE-PB-RECORD.
 12093     PERFORM 8400-LOG-JOURNAL-RECORD  *> Before Issue image
 12094     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12095     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 12096     MOVE 'C'                    TO JP-RECORD-TYPE.
 12097     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 12098
 12099
 12100* EXEC CICS REWRITE
 12101*        DATASET (FILE-ID-ERPNDB)
 12102*        FROM    (PENDING-BUSINESS)
 12103*    END-EXEC.
 12104     MOVE LENGTH OF
 12105      PENDING-BUSINESS
 12106       TO DFHEIV11
 12107*    MOVE '&& L                  %   #00011663' TO DFHEIV0
 12108     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 221
* EL6311.cbl
 12109     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12110     MOVE X'2020233030303131363633' TO DFHEIV0(25:11)
 12111     CALL 'kxdfhei1' USING DFHEIV0,
 12112           FILE-ID-ERPNDB,
 12113           PENDING-BUSINESS,
 12114           DFHEIV11,
 12115           DFHEIV99
 12116     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12117
 12118
 12119     PERFORM 8400-LOG-JOURNAL-RECORD  *> After Issue Image
 12120******************************************************************
 12121*       U P D A T E   T H E   O R I G   C E R T   I N F O        *
 12122******************************************************************
 12123     MOVE ELCERT-KEY             TO ERMAIL-KEY
 12124     MOVE ' '                    TO WS-ERMAIL-SW
 12125
 12126* EXEC CICS READ
 12127*       DATASET   (FILE-ID-ERMAIL)
 12128*       SET       (ADDRESS OF MAILING-DATA)
 12129*       RIDFLD    (ERMAIL-KEY)
 12130*       RESP      (WS-RESPONSE)
 12131*    END-EXEC
 12132*    MOVE '&"S        E          (  N#00011674' TO DFHEIV0
 12133     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12134     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12135     MOVE X'204E233030303131363734' TO DFHEIV0(25:11)
 12136     CALL 'kxdfhei1' USING DFHEIV0,
 12137           FILE-ID-ERMAIL,
 12138           DFHEIV20,
 12139           DFHEIV99,
 12140           ERMAIL-KEY,
 12141           DFHEIV99,
 12142           DFHEIV99,
 12143           DFHEIV99
 12144     SET ADDRESS OF MAILING-DATA TO
 12145         DFHEIV20
 12146     MOVE EIBRESP  TO WS-RESPONSE
 12147     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12148     IF RESP-NORMAL
 12149        SET ERMAIL-FOUND TO TRUE
 12150     END-IF
 12151
 12152     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 12153     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 12154                                 TO ELCRTO-KEY
 12155     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 12156     MOVE +0                     TO ELCRTO-SEQ-NO
 12157
 12158* EXEC CICS READ
 12159*       DATASET   ('ELCRTO')
 12160*       INTO      (ORIGINAL-CERTIFICATE)
 12161*       RIDFLD    (ELCRTO-KEY)
 12162*       GTEQ
 12163*       RESP      (WS-RESPONSE)
 12164*    END-EXEC
 12165     MOVE LENGTH OF
 12166      ORIGINAL-CERTIFICATE
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 222
* EL6311.cbl
 12167       TO DFHEIV11
 12168     MOVE 'ELCRTO' TO DFHEIV1
 12169*    MOVE '&"IL       G          (  N#00011689' TO DFHEIV0
 12170     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 12171     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12172     MOVE X'204E233030303131363839' TO DFHEIV0(25:11)
 12173     CALL 'kxdfhei1' USING DFHEIV0,
 12174           DFHEIV1,
 12175           ORIGINAL-CERTIFICATE,
 12176           DFHEIV11,
 12177           ELCRTO-KEY,
 12178           DFHEIV99,
 12179           DFHEIV99,
 12180           DFHEIV99
 12181     MOVE EIBRESP  TO WS-RESPONSE
 12182     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12183*    display ' just read gteq ' ws-response
 12184     IF RESP-NORMAL
 12185        AND (OC-CONTROL-PRIMARY (1:33) =
 12186                 PB-CONTROL-BY-ACCOUNT (1:33))
 12187        AND (OC-RECORD-TYPE = 'I')
 12188        IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 12189           display ' csr edit session ' PI-CSR-SESSION-SW
 12190           IF NOT CSR-EDIT-SESSION
 12191
 12192* EXEC CICS READ
 12193*                DATASET   ('ELCRTO')
 12194*                INTO      (ORIGINAL-CERTIFICATE)
 12195*                RIDFLD    (OC-CONTROL-PRIMARY)
 12196*                UPDATE
 12197*                RESP      (WS-RESPONSE)
 12198*             END-EXEC
 12199     MOVE LENGTH OF
 12200      ORIGINAL-CERTIFICATE
 12201       TO DFHEIV11
 12202     MOVE 'ELCRTO' TO DFHEIV1
 12203*    MOVE '&"IL       EU         (  N#00011706' TO DFHEIV0
 12204     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12205     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12206     MOVE X'204E233030303131373036' TO DFHEIV0(25:11)
 12207     CALL 'kxdfhei1' USING DFHEIV0,
 12208           DFHEIV1,
 12209           ORIGINAL-CERTIFICATE,
 12210           DFHEIV11,
 12211           OC-CONTROL-PRIMARY,
 12212           DFHEIV99,
 12213           DFHEIV99,
 12214           DFHEIV99
 12215     MOVE EIBRESP  TO WS-RESPONSE
 12216     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12217              DISPLAY ' JUST DID READ UPD ' WS-RESPONSE
 12218              IF RESP-NORMAL
 12219                 display ' good read upd '
 12220                 MOVE PB-I-INSURED-LAST-NAME TO
 12221                         OC-INS-LAST-NAME
 12222                 MOVE PB-I-INSURED-FIRST-NAME TO
 12223                         OC-INS-FIRST-NAME
 12224                 MOVE PB-I-INSURED-MIDDLE-INIT TO
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 223
* EL6311.cbl
 12225                         OC-INS-MIDDLE-INIT
 12226                 MOVE PB-I-AGE         TO OC-INS-AGE
 12227                 MOVE PB-I-JOINT-LAST-NAME   TO
 12228                         OC-JNT-LAST-NAME
 12229                 MOVE PB-I-JOINT-FIRST-NAME  TO
 12230                         OC-JNT-FIRST-NAME
 12231                 MOVE PB-I-JOINT-MIDDLE-INIT TO
 12232                         OC-JNT-MIDDLE-INIT
 12233                 MOVE PB-I-JOINT-AGE   TO OC-JNT-AGE
 12234                 MOVE PB-I-LF-BENEFIT-CD TO OC-LF-BENCD
 12235                 MOVE PB-I-LF-TERM     TO OC-LF-TERM
 12236                 MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
 12237                 MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
 12238                 MOVE PB-I-LF-ALT-BENEFIT-AMT TO
 12239                         OC-LF-ALT-BEN-AMT
 12240                 MOVE PB-I-LF-ALT-PREMIUM-AMT TO
 12241                         OC-LF-ALT-PRM-AMT
 12242                 MOVE PB-I-LF-EXPIRE-DT TO OC-LF-EXP-DT
 12243                 MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
 12244                 MOVE PB-I-AH-BENEFIT-CD TO OC-AH-BENCD
 12245                 MOVE PB-I-AH-TERM     TO OC-AH-TERM
 12246                 MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
 12247                 MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
 12248                 MOVE PB-I-AH-EXPIRE-DT TO OC-AH-EXP-DT
 12249                 MOVE PB-I-AH-COMMISSION TO OC-AH-COMM-PCT
 12250                 MOVE PB-I-AH-CRIT-PER TO OC-AH-CP
 12251                 MOVE PB-I-1ST-PMT-DT  TO OC-1ST-PMT-DT
 12252                 IF OC-CANCEL-TRAN-IND = 'N'
 12253                    MOVE LOW-VALUES    TO OC-LF-CANCEL-DT
 12254                    MOVE +0            TO OC-LF-CANCEL-AMT
 12255                                          OC-LF-ITD-CANCEL-AMT
 12256                    MOVE LOW-VALUES    TO OC-AH-CANCEL-DT
 12257                    MOVE +0            TO OC-AH-CANCEL-AMT
 12258                                          OC-AH-ITD-CANCEL-AMT
 12259                 END-IF
 12260                 MOVE 'Y'              TO OC-ISSUE-TRAN-IND
 12261                 MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 12262                 MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 12263                 MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 12264                 IF ERMAIL-FOUND
 12265                    MOVE MA-CRED-BENE-NAME
 12266                                 TO OC-CRED-BENE-NAME
 12267                 END-IF
 12268                 IF NOT CERT-TRL-REC-NOT-FOUND
 12269                    MOVE CS-INS-AGE-DEFAULT-FLAG TO
 12270                           OC-INS-AGE-DEFAULT-FLAG
 12271                    MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 12272                           OC-JNT-AGE-DEFAULT-FLAG
 12273                 END-IF
 12274
 12275* EXEC CICS REWRITE
 12276*                   DATASET   ('ELCRTO')
 12277*                   FROM      (ORIGINAL-CERTIFICATE)
 12278*                   RESP      (WS-RESPONSE)
 12279*                END-EXEC
 12280     MOVE LENGTH OF
 12281      ORIGINAL-CERTIFICATE
 12282       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 224
* EL6311.cbl
 12283     MOVE 'ELCRTO' TO DFHEIV1
 12284*    MOVE '&& L                  %  N#00011770' TO DFHEIV0
 12285     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12286     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12287     MOVE X'204E233030303131373730' TO DFHEIV0(25:11)
 12288     CALL 'kxdfhei1' USING DFHEIV0,
 12289           DFHEIV1,
 12290           ORIGINAL-CERTIFICATE,
 12291           DFHEIV11,
 12292           DFHEIV99
 12293     MOVE EIBRESP  TO WS-RESPONSE
 12294     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12295                 display ' just rewrote ' ws-response
 12296              END-IF
 12297           END-IF
 12298        ELSE
 12299           SUBTRACT +1 FROM OC-KEY-SEQ-NO
 12300           MOVE 'OC'             TO OC-RECORD-ID
 12301           MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 12302           MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 12303           MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 12304           MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 12305           MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 12306           MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 12307           MOVE PB-I-AGE         TO OC-INS-AGE
 12308           MOVE PB-I-JOINT-LAST-NAME TO OC-JNT-LAST-NAME
 12309           MOVE PB-I-JOINT-FIRST-NAME TO OC-JNT-FIRST-NAME
 12310           MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 12311           MOVE PB-I-JOINT-AGE   TO OC-JNT-AGE
 12312           MOVE PB-I-LF-BENEFIT-CD TO OC-LF-BENCD
 12313           MOVE PB-I-LF-TERM     TO OC-LF-TERM
 12314           MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
 12315           MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
 12316           MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 12317           MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 12318           MOVE PB-I-LF-EXPIRE-DT TO OC-LF-EXP-DT
 12319           MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
 12320           MOVE LOW-VALUES       TO OC-LF-CANCEL-DT
 12321           MOVE +0               TO OC-LF-CANCEL-AMT
 12322                                    OC-LF-ITD-CANCEL-AMT
 12323           MOVE PB-I-AH-BENEFIT-CD TO OC-AH-BENCD
 12324           MOVE PB-I-AH-TERM     TO OC-AH-TERM
 12325           MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
 12326           MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
 12327           MOVE PB-I-AH-EXPIRE-DT TO OC-AH-EXP-DT
 12328           MOVE PB-I-AH-COMMISSION TO OC-AH-COMM-PCT
 12329           MOVE PB-I-AH-CRIT-PER TO OC-AH-CP
 12330           MOVE LOW-VALUES       TO OC-AH-CANCEL-DT
 12331           MOVE +0               TO OC-AH-CANCEL-AMT
 12332                                    OC-AH-ITD-CANCEL-AMT
 12333           MOVE PB-I-1ST-PMT-DT  TO OC-1ST-PMT-DT
 12334           MOVE 'Y'              TO OC-ISSUE-TRAN-IND
 12335           MOVE 'N'              TO OC-CANCEL-TRAN-IND
 12336           IF ERMAIL-FOUND
 12337              MOVE MA-CRED-BENE-NAME
 12338                                 TO OC-CRED-BENE-NAME
 12339           END-IF
 12340           IF NOT CERT-TRL-REC-NOT-FOUND
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 225
* EL6311.cbl
 12341              MOVE CS-INS-AGE-DEFAULT-FLAG TO
 12342                           OC-INS-AGE-DEFAULT-FLAG
 12343              MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 12344                           OC-JNT-AGE-DEFAULT-FLAG
 12345           END-IF
 12346           MOVE LOW-VALUES       TO OC-ENDORSEMENT-PROCESSED-DT
 12347
 12348* EXEC CICS WRITE
 12349*             DATASET   ('ELCRTO')
 12350*             FROM      (ORIGINAL-CERTIFICATE)
 12351*             RIDFLD    (OC-CONTROL-PRIMARY)
 12352*             RESP      (WS-RESPONSE)
 12353*          END-EXEC
 12354     MOVE LENGTH OF
 12355      ORIGINAL-CERTIFICATE
 12356       TO DFHEIV11
 12357     MOVE 'ELCRTO' TO DFHEIV1
 12358*    MOVE '&$ L                  ''  N#00011827' TO DFHEIV0
 12359     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12360     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12361     MOVE X'204E233030303131383237' TO DFHEIV0(25:11)
 12362     CALL 'kxdfhei1' USING DFHEIV0,
 12363           DFHEIV1,
 12364           ORIGINAL-CERTIFICATE,
 12365           DFHEIV11,
 12366           OC-CONTROL-PRIMARY,
 12367           DFHEIV99,
 12368           DFHEIV99
 12369     MOVE EIBRESP  TO WS-RESPONSE
 12370     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12371        END-IF
 12372     ELSE
 12373        MOVE SPACES              TO ORIGINAL-CERTIFICATE
 12374        MOVE 'OC'                TO OC-RECORD-ID
 12375        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 12376                                 TO OC-CONTROL-PRIMARY (1:33)
 12377        MOVE 'I'                 TO OC-RECORD-TYPE
 12378        MOVE +4096               TO OC-KEY-SEQ-NO
 12379        MOVE PI-PROCESSOR-ID     TO OC-LAST-MAINT-BY
 12380        MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 12381        MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 12382        MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 12383        MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 12384        MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 12385        MOVE PB-I-AGE            TO OC-INS-AGE
 12386        MOVE PB-I-JOINT-LAST-NAME TO OC-JNT-LAST-NAME
 12387        MOVE PB-I-JOINT-FIRST-NAME TO OC-JNT-FIRST-NAME
 12388        MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 12389        MOVE PB-I-JOINT-AGE      TO OC-JNT-AGE
 12390        MOVE PB-I-LF-BENEFIT-CD  TO OC-LF-BENCD
 12391        MOVE PB-I-LF-TERM        TO OC-LF-TERM
 12392        MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
 12393        MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
 12394        MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 12395        MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 12396        MOVE PB-I-LF-EXPIRE-DT   TO OC-LF-EXP-DT
 12397        MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
 12398        MOVE LOW-VALUES          TO OC-LF-CANCEL-DT
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 226
* EL6311.cbl
 12399        MOVE +0                  TO OC-LF-CANCEL-AMT
 12400                                    OC-LF-ITD-CANCEL-AMT
 12401        MOVE PB-I-AH-BENEFIT-CD  TO OC-AH-BENCD
 12402        MOVE PB-I-AH-TERM        TO OC-AH-TERM
 12403        MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
 12404        MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
 12405        MOVE PB-I-AH-EXPIRE-DT   TO OC-AH-EXP-DT
 12406        MOVE PB-I-AH-COMMISSION  TO OC-AH-COMM-PCT
 12407        MOVE PB-I-AH-CRIT-PER    TO OC-AH-CP
 12408        MOVE LOW-VALUES          TO OC-AH-CANCEL-DT
 12409        MOVE +0                  TO OC-AH-CANCEL-AMT
 12410                                    OC-AH-ITD-CANCEL-AMT
 12411        MOVE PB-I-1ST-PMT-DT     TO OC-1ST-PMT-DT
 12412        MOVE 'Y'                 TO OC-ISSUE-TRAN-IND
 12413        MOVE 'N'                 TO OC-CANCEL-TRAN-IND
 12414        IF ERMAIL-FOUND
 12415           MOVE MA-CRED-BENE-NAME
 12416                                 TO OC-CRED-BENE-NAME
 12417        END-IF
 12418        IF NOT CERT-TRL-REC-NOT-FOUND
 12419           MOVE CS-INS-AGE-DEFAULT-FLAG TO
 12420                           OC-INS-AGE-DEFAULT-FLAG
 12421           MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 12422                           OC-JNT-AGE-DEFAULT-FLAG
 12423        END-IF
 12424        MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 12425
 12426* EXEC CICS WRITE
 12427*          DATASET   ('ELCRTO')
 12428*          FROM      (ORIGINAL-CERTIFICATE)
 12429*          RIDFLD    (OC-CONTROL-PRIMARY)
 12430*          RESP      (WS-RESPONSE)
 12431*       END-EXEC
 12432     MOVE LENGTH OF
 12433      ORIGINAL-CERTIFICATE
 12434       TO DFHEIV11
 12435     MOVE 'ELCRTO' TO DFHEIV1
 12436*    MOVE '&$ L                  ''  N#00011887' TO DFHEIV0
 12437     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12438     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12439     MOVE X'204E233030303131383837' TO DFHEIV0(25:11)
 12440     CALL 'kxdfhei1' USING DFHEIV0,
 12441           DFHEIV1,
 12442           ORIGINAL-CERTIFICATE,
 12443           DFHEIV11,
 12444           OC-CONTROL-PRIMARY,
 12445           DFHEIV99,
 12446           DFHEIV99
 12447     MOVE EIBRESP  TO WS-RESPONSE
 12448     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12449     END-IF
 12450******************************************************************
 12451*       U P D A T E   T H E   B A T C H   H E A D E R            *
 12452******************************************************************
 12453
 12454     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 12455     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 12456
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 227
* EL6311.cbl
 12457
 12458* EXEC CICS READ
 12459*        INTO    (PENDING-BUSINESS)
 12460*        DATASET (FILE-ID-ERPNDB)
 12461*        RIDFLD  (ERPNDB-KEY)
 12462*        UPDATE
 12463*    END-EXEC.
 12464     MOVE LENGTH OF
 12465      PENDING-BUSINESS
 12466       TO DFHEIV11
 12467*    MOVE '&"IL       EU         (   #00011901' TO DFHEIV0
 12468     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12469     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12470     MOVE X'2020233030303131393031' TO DFHEIV0(25:11)
 12471     CALL 'kxdfhei1' USING DFHEIV0,
 12472           FILE-ID-ERPNDB,
 12473           PENDING-BUSINESS,
 12474           DFHEIV11,
 12475           ERPNDB-KEY,
 12476           DFHEIV99,
 12477           DFHEIV99,
 12478           DFHEIV99
 12479     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12480
 12481
 12482     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 12483     MOVE 'B'                    TO JP-RECORD-TYPE.
 12484     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 12485
 12486     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12487
 12488     PERFORM 8400-LOG-JOURNAL-RECORD  *> Before BHDR Image
 12489
 12490     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD
 12491
 12492     MOVE 'C'                    TO JP-RECORD-TYPE.
 12493     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 12494
 12495
 12496* EXEC CICS REWRITE
 12497*        DATASET    (FILE-ID-ERPNDB)
 12498*        FROM       (PENDING-BUSINESS)
 12499*    END-EXEC.
 12500     MOVE LENGTH OF
 12501      PENDING-BUSINESS
 12502       TO DFHEIV11
 12503*    MOVE '&& L                  %   #00011921' TO DFHEIV0
 12504     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12505     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12506     MOVE X'2020233030303131393231' TO DFHEIV0(25:11)
 12507     CALL 'kxdfhei1' USING DFHEIV0,
 12508           FILE-ID-ERPNDB,
 12509           PENDING-BUSINESS,
 12510           DFHEIV11,
 12511           DFHEIV99
 12512     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12513
 12514
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 228
* EL6311.cbl
 12515     PERFORM 8400-LOG-JOURNAL-RECORD  *> After BHDR Image
 12516
 12517     IF WS-ERRORS-PRESENT
 12518        GO TO 3900-RE-DISPLAY-RECORD.
 12519
 12520     MOVE ZEROS                  TO EMI-ERROR.
 12521     MOVE -1                     TO BMAINTL.
 12522     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12523     GO TO 3900-RE-DISPLAY-RECORD.
 12524
 12525 1380-BATCH-HDR-NOT-FOUND.
 12526     MOVE -1                     TO BMAINTL.
 12527     MOVE ER-7450                TO EMI-ERROR.
 12528     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12529     GO TO 8200-SEND-DATAONLY.
 12530
 12531 1385-REC-NOT-FOUND.
 12532     MOVE -1                     TO BMAINTL.
 12533     MOVE ER-7451                TO EMI-ERROR.
 12534     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12535     GO TO 8200-SEND-DATAONLY.
 12536
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 229
* EL6311.cbl
 12538
 12539 1386-UPDATE-AGE-FLAGS.
 12540
 12541
 12542* EXEC CICS GETMAIN
 12543*        SET     (ADDRESS OF CERTIFICATE-TRAILERS)
 12544*        LENGTH  (ELCRTT-RECORD-LENGTH)
 12545*        INITIMG (GETMAIN-SPACE)
 12546*    END-EXEC
 12547*    MOVE ',"IL                  $   #00011952' TO DFHEIV0
 12548     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12549     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12550     MOVE X'2020233030303131393532' TO DFHEIV0(25:11)
 12551     CALL 'kxdfhei1' USING DFHEIV0,
 12552           DFHEIV20,
 12553           ELCRTT-RECORD-LENGTH,
 12554           GETMAIN-SPACE
 12555     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 12556         DFHEIV20
 12557     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12558
 12559
 12560* EXEC CICS HANDLE CONDITION
 12561*        NOTFND   (1386-NOTFND)
 12562*    END-EXEC.
 12563*    MOVE '"$I                   ! ( #00011958' TO DFHEIV0
 12564     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12565     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12566     MOVE X'2820233030303131393538' TO DFHEIV0(25:11)
 12567     CALL 'kxdfhei1' USING DFHEIV0
 12568     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12569
 12570
 12571     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTT-PRIMARY
 12572     MOVE 'C'                TO ELCRTT-REC-TYPE
 12573
 12574
 12575* EXEC CICS READ
 12576*        UPDATE
 12577*        DATASET  (CRTT-ID)
 12578*        RIDFLD   (ELCRTT-KEY)
 12579*        INTO     (CERTIFICATE-TRAILERS)
 12580*    END-EXEC.
 12581     MOVE LENGTH OF
 12582      CERTIFICATE-TRAILERS
 12583       TO DFHEIV11
 12584*    MOVE '&"IL       EU         (   #00011965' TO DFHEIV0
 12585     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12586     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12587     MOVE X'2020233030303131393635' TO DFHEIV0(25:11)
 12588     CALL 'kxdfhei1' USING DFHEIV0,
 12589           CRTT-ID,
 12590           CERTIFICATE-TRAILERS,
 12591           DFHEIV11,
 12592           ELCRTT-KEY,
 12593           DFHEIV99,
 12594           DFHEIV99,
 12595           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 230
* EL6311.cbl
 12596     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12597
 12598
 12599     IF WS-INS-AGE-SET = 'Y'
 12600        MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG
 12601     END-IF
 12602     IF WS-JNT-AGE-SET = 'Y'
 12603        MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG
 12604     END-IF
 12605
 12606
 12607* EXEC CICS REWRITE
 12608*       DATASET  (CRTT-ID)
 12609*       FROM     (CERTIFICATE-TRAILERS)
 12610*    END-EXEC.
 12611     MOVE LENGTH OF
 12612      CERTIFICATE-TRAILERS
 12613       TO DFHEIV11
 12614*    MOVE '&& L                  %   #00011979' TO DFHEIV0
 12615     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12616     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12617     MOVE X'2020233030303131393739' TO DFHEIV0(25:11)
 12618     CALL 'kxdfhei1' USING DFHEIV0,
 12619           CRTT-ID,
 12620           CERTIFICATE-TRAILERS,
 12621           DFHEIV11,
 12622           DFHEIV99
 12623     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12624
 12625
 12626     GO TO 1386-EXIT.
 12627
 12628 1386-NOTFND.
 12629
 12630     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 12631     MOVE 'CS'         TO CS-RECORD-ID.
 12632     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTT-PRIMARY.
 12633     MOVE 'C'          TO ELCRTT-REC-TYPE.
 12634     MOVE ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 12635     MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG.
 12636     MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG.
 12637
 12638* EXEC CICS WRITE
 12639*       DATASET  (CRTT-ID)
 12640*       RIDFLD   (ELCRTT-KEY)
 12641*       FROM     (CERTIFICATE-TRAILERS)
 12642*    END-EXEC.
 12643     MOVE LENGTH OF
 12644      CERTIFICATE-TRAILERS
 12645       TO DFHEIV11
 12646*    MOVE '&$ L                  ''   #00011995' TO DFHEIV0
 12647     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12648     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12649     MOVE X'2020233030303131393935' TO DFHEIV0(25:11)
 12650     CALL 'kxdfhei1' USING DFHEIV0,
 12651           CRTT-ID,
 12652           CERTIFICATE-TRAILERS,
 12653           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 231
* EL6311.cbl
 12654           ELCRTT-KEY,
 12655           DFHEIV99,
 12656           DFHEIV99
 12657     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12658
 12659
 12660 1386-EXIT.
 12661     EXIT.
 12662
 12663 1390-UPDATE-ERPNDM.
 12664
 12665
 12666* EXEC CICS HANDLE CONDITION
 12667*        NOTFND (1399-EXIT)
 12668*    END-EXEC.
 12669*    MOVE '"$I                   ! ) #00012006' TO DFHEIV0
 12670     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12671     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12672     MOVE X'2920233030303132303036' TO DFHEIV0(25:11)
 12673     CALL 'kxdfhei1' USING DFHEIV0
 12674     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12675
 12676
 12677     MOVE PB-CONTROL-PRIMARY     TO  ERPNDM-KEY.
 12678
 12679
 12680* EXEC CICS READ
 12681*        SET     (ADDRESS OF PENDING-MAILING-DATA)
 12682*        DATASET (FILE-ID-ERPNDM)
 12683*        RIDFLD  (ERPNDM-KEY)
 12684*        UPDATE
 12685*    END-EXEC.
 12686*    MOVE '&"S        EU         (   #00012012' TO DFHEIV0
 12687     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12688     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12689     MOVE X'2020233030303132303132' TO DFHEIV0(25:11)
 12690     CALL 'kxdfhei1' USING DFHEIV0,
 12691           FILE-ID-ERPNDM,
 12692           DFHEIV20,
 12693           DFHEIV99,
 12694           ERPNDM-KEY,
 12695           DFHEIV99,
 12696           DFHEIV99,
 12697           DFHEIV99
 12698     SET ADDRESS OF PENDING-MAILING-DATA TO
 12699         DFHEIV20
 12700     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12701
 12702
 12703     MOVE PI-PROCESSOR-ID        TO PM-LAST-MAINT-BY.
 12704     MOVE EIBTIME                TO PM-LAST-MAINT-HHMMSS.
 12705     MOVE WS-CURRENT-BIN-DT      TO PM-LAST-MAINT-DT.
 12706
 12707     IF BLSTNML GREATER THAN ZEROS
 12708         MOVE BLSTNMI            TO PM-INSURED-LAST-NAME.
 12709
 12710     IF B1STNML GREATER  THAN ZEROS
 12711         MOVE B1STNMI            TO PM-INSURED-FIRST-NAME.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 232
* EL6311.cbl
 12712
 12713     IF BINITL GREATER THAN ZEROS
 12714         MOVE BINITI             TO PM-INSURED-MIDDLE-INIT.
 12715
 12716     IF BAGEL GREATER THAN ZEROS
 12717         MOVE WS-BAGE            TO PM-INSURED-ISSUE-AGE.
 12718
 12719     IF BBIRTHL GREATER THAN ZEROS
 12720         MOVE  WS-CONVERTED-BIRTH TO PM-INSURED-BIRTH-DT.
 12721
 12722     IF BSEXL GREATER THAN ZEROS
 12723         MOVE  BSEXI             TO PM-INSURED-SEX.
 12724
 12725
 12726* EXEC CICS REWRITE
 12727*        DATASET (FILE-ID-ERPNDM)
 12728*        FROM    (PENDING-MAILING-DATA)
 12729*    END-EXEC.
 12730     MOVE LENGTH OF
 12731      PENDING-MAILING-DATA
 12732       TO DFHEIV11
 12733*    MOVE '&& L                  %   #00012041' TO DFHEIV0
 12734     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12735     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12736     MOVE X'2020233030303132303431' TO DFHEIV0(25:11)
 12737     CALL 'kxdfhei1' USING DFHEIV0,
 12738           FILE-ID-ERPNDM,
 12739           PENDING-MAILING-DATA,
 12740           DFHEIV11,
 12741           DFHEIV99
 12742     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12743
 12744
 12745 1399-EXIT.
 12746     EXIT.
 12747 139A-SET-LETTER-REQD.
 12748*  COMPARE BEFORE AND AFTER CHANGE
 12749     IF PB-ISSUE-RECORD = WS-SAVE-PEND-ISSUE
 12750        GO TO 139A-EXIT
 12751     END-IF
 12752
 12753*  READ ELCRTO
 12754     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 12755                                 TO ELCRTO-KEY
 12756     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 12757     MOVE +0                     TO ELCRTO-SEQ-NO
 12758
 12759
 12760* EXEC CICS READ
 12761*       DATASET   ('ELCRTO')
 12762*       INTO      (ORIGINAL-CERTIFICATE)
 12763*       RIDFLD    (ELCRTO-KEY)
 12764*       GTEQ
 12765*       RESP      (WS-RESPONSE)
 12766*    END-EXEC
 12767     MOVE LENGTH OF
 12768      ORIGINAL-CERTIFICATE
 12769       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 233
* EL6311.cbl
 12770     MOVE 'ELCRTO' TO DFHEIV1
 12771*    MOVE '&"IL       G          (  N#00012060' TO DFHEIV0
 12772     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 12773     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12774     MOVE X'204E233030303132303630' TO DFHEIV0(25:11)
 12775     CALL 'kxdfhei1' USING DFHEIV0,
 12776           DFHEIV1,
 12777           ORIGINAL-CERTIFICATE,
 12778           DFHEIV11,
 12779           ELCRTO-KEY,
 12780           DFHEIV99,
 12781           DFHEIV99,
 12782           DFHEIV99
 12783     MOVE EIBRESP  TO WS-RESPONSE
 12784     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12785
 12786*    display ' just read gteq ' ws-response
 12787     IF RESP-NORMAL
 12788        AND (OC-CONTROL-PRIMARY (1:33) =
 12789                 PB-CONTROL-BY-ACCOUNT (1:33))
 12790        AND (OC-RECORD-TYPE = 'I')
 12791*      compare individual fields
 12792        IF LETRREQL   GREATER THAN ZEROS
 12793           CONTINUE
 12794        ELSE
 12795        IF OC-CERT-NO = PB-CERT-NO
 12796          AND OC-CERT-EFF-DT = PB-CERT-EFF-DT
 12797          AND OC-INS-LAST-NAME = PB-I-INSURED-LAST-NAME
 12798          AND OC-INS-FIRST-NAME = PB-I-INSURED-FIRST-NAME
 12799          AND OC-INS-MIDDLE-INIT =  PB-I-INSURED-MIDDLE-INIT
 12800          AND OC-INS-AGE = PB-I-AGE
 12801          AND OC-LF-BENCD = PB-I-LIFE-BENEFIT-CD
 12802          AND OC-LF-TERM = PB-I-LF-TERM
 12803          AND OC-LF-BEN-AMT = PB-I-LF-BENEFIT-AMT
 12804          AND OC-LF-PRM-AMT = PB-I-LF-PREMIUM-AMT
 12805          AND OC-LF-EXP-DT = PB-I-LF-EXPIRE-DT
 12806          AND OC-LF-ALT-BEN-AMT = PB-I-LF-ALT-BENEFIT-AMT
 12807          AND PB-I-LF-ALT-PREMIUM-AMT = OC-LF-ALT-PRM-AMT
 12808          AND PB-I-LF-EXPIRE-DT = OC-LF-EXP-DT
 12809          AND PB-I-AH-BENEFIT-CD     = OC-AH-BENCD
 12810          AND PB-I-AH-TERM           = OC-AH-TERM
 12811          AND PB-I-AH-BENEFIT-AMT    = OC-AH-BEN-AMT
 12812          AND PB-I-AH-PREMIUM-AMT    = OC-AH-PRM-AMT
 12813          AND PB-I-AH-EXPIRE-DT      = OC-AH-EXP-DT
 12814          AND PB-I-AH-COMMISSION     = OC-AH-COMM-PCT
 12815          AND PB-I-AH-CRIT-PER       = OC-AH-CP
 12816           MOVE SPACE TO PB-I-LETTER-REQD
 12817        ELSE
 12818           MOVE 'Y' TO PB-I-LETTER-REQD
 12819        END-IF
 12820     END-IF.
 12821
 12822 139A-EXIT.
 12823     EXIT.
 12824
 12825******************************************************************
 12826*                                                                *
 12827*          D E L E T E   I S S U E   R O U T I N E               *
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 234
* EL6311.cbl
 12828*                                                                *
 12829******************************************************************
 12830
 12831 1400-DELETE-ISSUE-ROUTINE.
 12832     MOVE 'D'                    TO PI-MAINT-FUNCTION.
 12833
 12834     IF BCHGL NOT = ZEROS
 12835        MOVE ER-2196             TO EMI-ERROR
 12836        MOVE AL-UABON            TO BMAINTA
 12837        MOVE -1                  TO BMAINTL
 12838        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12839        GO TO 8200-SEND-DATAONLY.
 12840
 12841
 12842* EXEC CICS HANDLE CONDITION
 12843*         NOTFND    (1480-BATCH-HDR-NOT-FOUND)
 12844*    END-EXEC.
 12845*    MOVE '"$I                   ! * #00012123' TO DFHEIV0
 12846     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12847     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12848     MOVE X'2A20233030303132313233' TO DFHEIV0(25:11)
 12849     CALL 'kxdfhei1' USING DFHEIV0
 12850     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12851
 12852
 12853     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 12854     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 12855     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 12856
 12857
 12858* EXEC CICS READ
 12859*        SET     (ADDRESS OF PENDING-BUSINESS)
 12860*        DATASET (FILE-ID-ERPNDB)
 12861*        RIDFLD  (ERPNDB-KEY)
 12862*    END-EXEC.
 12863*    MOVE '&"S        E          (   #00012131' TO DFHEIV0
 12864     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12865     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12866     MOVE X'2020233030303132313331' TO DFHEIV0(25:11)
 12867     CALL 'kxdfhei1' USING DFHEIV0,
 12868           FILE-ID-ERPNDB,
 12869           DFHEIV20,
 12870           DFHEIV99,
 12871           ERPNDB-KEY,
 12872           DFHEIV99,
 12873           DFHEIV99,
 12874           DFHEIV99
 12875     SET ADDRESS OF PENDING-BUSINESS TO
 12876         DFHEIV20
 12877     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12878
 12879
 12880     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 12881
 12882     MOVE BCERTNOI               TO WS-NEW-PRIME.
 12883
 12884     IF BSUFIXL NOT = ZEROS
 12885        MOVE BSUFIXI             TO WS-NEW-SUFFIX
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 235
* EL6311.cbl
 12886     ELSE
 12887        MOVE SPACE               TO WS-NEW-SUFFIX.
 12888
 12889     MOVE BEFFDTI                TO DEEDIT-FIELD.
 12890     PERFORM 8600-DEEDIT.
 12891     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 12892     MOVE '4'                    TO DC-OPTION-CODE.
 12893     PERFORM 9700-DATE-LINK.
 12894     IF DATE-CONVERSION-ERROR
 12895        MOVE ER-0348             TO EMI-ERROR
 12896        MOVE -1                  TO BEFFDTL
 12897        MOVE AL-UABON            TO BEFFDTA
 12898        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12899        GO TO 8200-SEND-DATAONLY
 12900     ELSE
 12901        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
 12902        MOVE AL-UANON            TO BEFFDTA
 12903        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 12904
 12905
 12906* EXEC CICS HANDLE CONDITION
 12907*         NOTFND    (1490-RECORD-NOT-FOUND)
 12908*    END-EXEC.
 12909*    MOVE '"$I                   ! + #00012162' TO DFHEIV0
 12910     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12911     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12912     MOVE X'2B20233030303132313632' TO DFHEIV0(25:11)
 12913     CALL 'kxdfhei1' USING DFHEIV0
 12914     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12915
 12916
 12917
 12918* EXEC CICS READ
 12919*        SET     (ADDRESS OF PENDING-BUSINESS)
 12920*        DATASET (FILE-ID-ERPNDB)
 12921*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 12922*        UPDATE
 12923*    END-EXEC.
 12924*    MOVE '&"S        EU         (   #00012166' TO DFHEIV0
 12925     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12926     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12927     MOVE X'2020233030303132313636' TO DFHEIV0(25:11)
 12928     CALL 'kxdfhei1' USING DFHEIV0,
 12929           FILE-ID-ERPNDB,
 12930           DFHEIV20,
 12931           DFHEIV99,
 12932           PI-PREV-CONTROL-PRIMARY,
 12933           DFHEIV99,
 12934           DFHEIV99,
 12935           DFHEIV99
 12936     SET ADDRESS OF PENDING-BUSINESS TO
 12937         DFHEIV20
 12938     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12939
 12940
 12941     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 12942        MOVE -1                 TO BMAINTL
 12943        MOVE ER-2197            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 236
* EL6311.cbl
 12944        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12945        GO TO 8200-SEND-DATAONLY.
 12946
 12947     IF PB-BILLED-DT NOT = LOW-VALUES
 12948        MOVE -1                 TO BMAINTL
 12949        MOVE ER-2129            TO EMI-ERROR
 12950        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12951        GO TO 8200-SEND-DATAONLY.
 12952
 12953     IF PB-CHG-COUNT NOT = ZEROS
 12954        MOVE ER-2336            TO EMI-ERROR
 12955        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12956        MOVE AL-UABON            TO BMAINTA
 12957        MOVE -1                  TO BMAINTL
 12958        GO TO 8200-SEND-DATAONLY.
 12959
 12960     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 12961        PB-CHG-COUNT NOT = ZEROS
 12962        MOVE ER-2196             TO EMI-ERROR
 12963        MOVE AL-UABON            TO BMAINTA
 12964        MOVE -1                  TO BMAINTL
 12965        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12966        GO TO 8200-SEND-DATAONLY.
 12967******************************************************************
 12968*                                                                *
 12969*       Determine if this is a dup and we should allow the       *
 12970*       user to delete the pending issue record only.            *
 12971*                                                                *
 12972******************************************************************
 12973     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 12974                                 TO ELCERT-KEY
 12975
 12976* EXEC CICS READ
 12977*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 12978*        DATASET (FILE-ID-ELCERT)
 12979*        RIDFLD  (ELCERT-KEY)
 12980*        RESP    (WS-RESPONSE)
 12981*    END-EXEC
 12982*    MOVE '&"S        E          (  N#00012207' TO DFHEIV0
 12983     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12984     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12985     MOVE X'204E233030303132323037' TO DFHEIV0(25:11)
 12986     CALL 'kxdfhei1' USING DFHEIV0,
 12987           FILE-ID-ELCERT,
 12988           DFHEIV20,
 12989           DFHEIV99,
 12990           ELCERT-KEY,
 12991           DFHEIV99,
 12992           DFHEIV99,
 12993           DFHEIV99
 12994     SET ADDRESS OF CERTIFICATE-MASTER TO
 12995         DFHEIV20
 12996     MOVE EIBRESP  TO WS-RESPONSE
 12997     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12998     if (resp-normal)
 12999        and (cert-added-batch)
 13000        and (valid-cm-id)
 13001        go to 1420-CONTINUE-DELETE
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 237
* EL6311.cbl
 13002     end-if
 13003******************************************************************
 13004*                                                                *
 13005*       Determine if there have been any checks created          *
 13006*                                                                *
 13007******************************************************************
 13008
 13009     perform 2500-browse-checks  thru 2500-exit
 13010
 13011     if i-have-processed-checks
 13012        or i-have-checks
 13013        or i-have-a-check-period
 13014        move er-3446             to emi-error
 13015        perform 9900-error-format thru 9900-exit
 13016        move al-uabon            to bmainta
 13017        move -1                  to bmaintl
 13018        go to 8200-send-dataonly
 13019     end-if
 13020******************************************************************
 13021*                                                                *
 13022*       DELETE ORIGINAL CERTIFICATE INFO                         *
 13023*                                                                *
 13024******************************************************************
 13025     MOVE PI-PREV-ALT-KEY (1:33) TO ELCRTO-KEY (1:33)
 13026     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 13027     MOVE +0                     TO ELCRTO-SEQ-NO
 13028
 13029* EXEC CICS READ
 13030*       DATASET   ('ELCRTO')
 13031*       INTO      (ORIGINAL-CERTIFICATE)
 13032*       RIDFLD    (ELCRTO-KEY)
 13033*       GTEQ
 13034*       RESP      (WS-RESPONSE)
 13035*    END-EXEC
 13036     MOVE LENGTH OF
 13037      ORIGINAL-CERTIFICATE
 13038       TO DFHEIV11
 13039     MOVE 'ELCRTO' TO DFHEIV1
 13040*    MOVE '&"IL       G          (  N#00012243' TO DFHEIV0
 13041     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 13042     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13043     MOVE X'204E233030303132323433' TO DFHEIV0(25:11)
 13044     CALL 'kxdfhei1' USING DFHEIV0,
 13045           DFHEIV1,
 13046           ORIGINAL-CERTIFICATE,
 13047           DFHEIV11,
 13048           ELCRTO-KEY,
 13049           DFHEIV99,
 13050           DFHEIV99,
 13051           DFHEIV99
 13052     MOVE EIBRESP  TO WS-RESPONSE
 13053     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13054     IF RESP-NORMAL
 13055        AND (OC-CONTROL-PRIMARY (1:33) =
 13056                 PB-CONTROL-BY-ACCOUNT (1:33))
 13057        AND (OC-RECORD-TYPE = 'I')
 13058
 13059* EXEC CICS READ
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 238
* EL6311.cbl
 13060*          DATASET   ('ELCRTO')
 13061*          INTO      (ORIGINAL-CERTIFICATE)
 13062*          RIDFLD    (ELCRTO-KEY)
 13063*          UPDATE
 13064*          RESP      (WS-RESPONSE)
 13065*       END-EXEC
 13066     MOVE LENGTH OF
 13067      ORIGINAL-CERTIFICATE
 13068       TO DFHEIV11
 13069     MOVE 'ELCRTO' TO DFHEIV1
 13070*    MOVE '&"IL       EU         (  N#00012254' TO DFHEIV0
 13071     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 13072     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13073     MOVE X'204E233030303132323534' TO DFHEIV0(25:11)
 13074     CALL 'kxdfhei1' USING DFHEIV0,
 13075           DFHEIV1,
 13076           ORIGINAL-CERTIFICATE,
 13077           DFHEIV11,
 13078           ELCRTO-KEY,
 13079           DFHEIV99,
 13080           DFHEIV99,
 13081           DFHEIV99
 13082     MOVE EIBRESP  TO WS-RESPONSE
 13083     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13084        IF RESP-NORMAL
 13085
 13086* EXEC CICS DELETE
 13087*             DATASET   ('ELCRTO')
 13088*          END-EXEC
 13089     MOVE 'ELCRTO' TO DFHEIV1
 13090*    MOVE '&(                    &   #00012262' TO DFHEIV0
 13091     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13092     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13093     MOVE X'2020233030303132323632' TO DFHEIV0(25:11)
 13094     CALL 'kxdfhei1' USING DFHEIV0,
 13095           DFHEIV1,
 13096           DFHEIV99,
 13097           DFHEIV99,
 13098           DFHEIV99,
 13099           DFHEIV99
 13100     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13101        END-IF
 13102     END-IF
 13103******************************************************************
 13104*                                                                *
 13105*       DELETE PENDING MAILING ADDRESS RECORDS                   *
 13106*                                                                *
 13107******************************************************************
 13108
 13109* EXEC CICS HANDLE CONDITION
 13110*        NOTFND    (1405-DELETE-CERTIFICATE)
 13111*    END-EXEC.
 13112*    MOVE '"$I                   ! , #00012272' TO DFHEIV0
 13113     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13114     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13115     MOVE X'2C20233030303132323732' TO DFHEIV0(25:11)
 13116     CALL 'kxdfhei1' USING DFHEIV0
 13117     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 239
* EL6311.cbl
 13118
 13119
 13120
 13121* EXEC CICS READ
 13122*        EQUAL
 13123*        DATASET   (FILE-ID-ERPNDM)
 13124*        SET       (ADDRESS OF PENDING-MAILING-DATA)
 13125*        RIDFLD    (PI-PREV-CONTROL-PRIMARY)
 13126*        UPDATE
 13127*    END-EXEC.
 13128*    MOVE '&"S        EU         (   #00012276' TO DFHEIV0
 13129     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13130     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13131     MOVE X'2020233030303132323736' TO DFHEIV0(25:11)
 13132     CALL 'kxdfhei1' USING DFHEIV0,
 13133           FILE-ID-ERPNDM,
 13134           DFHEIV20,
 13135           DFHEIV99,
 13136           PI-PREV-CONTROL-PRIMARY,
 13137           DFHEIV99,
 13138           DFHEIV99,
 13139           DFHEIV99
 13140     SET ADDRESS OF PENDING-MAILING-DATA TO
 13141         DFHEIV20
 13142     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13143
 13144
 13145     MOVE FILE-ID-ERPNDM         TO  JP-FILE-ID.
 13146     MOVE 'D'                    TO  JP-RECORD-TYPE.
 13147     MOVE PENDING-MAILING-DATA   TO  JP-RECORD-AREA.
 13148
 13149     MOVE ERPNDM-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 13150
 13151
 13152* EXEC CICS DELETE
 13153*        DATASET   (FILE-ID-ERPNDM)
 13154*    END-EXEC.
 13155*    MOVE '&(                    &   #00012290' TO DFHEIV0
 13156     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13157     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13158     MOVE X'2020233030303132323930' TO DFHEIV0(25:11)
 13159     CALL 'kxdfhei1' USING DFHEIV0,
 13160           FILE-ID-ERPNDM,
 13161           DFHEIV99,
 13162           DFHEIV99,
 13163           DFHEIV99,
 13164           DFHEIV99
 13165     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13166
 13167
 13168******************************************************************
 13169*                PROCESS   CERTIFICATE                           *
 13170******************************************************************
 13171
 13172 1405-DELETE-CERTIFICATE.
 13173
 13174* EXEC CICS HANDLE CONDITION
 13175*         NOTFND  (1420-CONTINUE-DELETE)
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 240
* EL6311.cbl
 13176*    END-EXEC.
 13177*    MOVE '"$I                   ! - #00012299' TO DFHEIV0
 13178     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13179     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13180     MOVE X'2D20233030303132323939' TO DFHEIV0(25:11)
 13181     CALL 'kxdfhei1' USING DFHEIV0
 13182     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13183
 13184
 13185     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 13186     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 13187     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 13188     MOVE PB-SV-STATE            TO ELCERT-STATE.
 13189
 13190
 13191* EXEC CICS READ
 13192*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 13193*        DATASET (FILE-ID-ELCERT)
 13194*        RIDFLD  (ELCERT-KEY)
 13195*        UPDATE
 13196*    END-EXEC.
 13197*    MOVE '&"S        EU         (   #00012308' TO DFHEIV0
 13198     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13199     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13200     MOVE X'2020233030303132333038' TO DFHEIV0(25:11)
 13201     CALL 'kxdfhei1' USING DFHEIV0,
 13202           FILE-ID-ELCERT,
 13203           DFHEIV20,
 13204           DFHEIV99,
 13205           ELCERT-KEY,
 13206           DFHEIV99,
 13207           DFHEIV99,
 13208           DFHEIV99
 13209     SET ADDRESS OF CERTIFICATE-MASTER TO
 13210         DFHEIV20
 13211     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13212
 13213
 13214     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 13215
 13216     MOVE FILE-ID-ELCERT         TO JP-FILE-ID.
 13217     MOVE 'B'                    TO JP-RECORD-TYPE
 13218     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 13219
 13220     PERFORM 8400-LOG-JOURNAL-RECORD.
 13221
 13222     IF CERT-NOTES-ARE-NOT-PRESENT
 13223        MOVE ' '                 TO WS-CERT-NOTE-SW
 13224     ELSE
 13225        MOVE 'Y'                 TO WS-CERT-NOTE-SW.
 13226
 13227     IF INSURED-ADDR-PRESENT
 13228        MOVE 'Y'                 TO WS-CERT-ADDRESS-SW.
 13229
 13230******************************************************************
 13231******* THIS CODE SHOULD BYPASS SETTING THE CLAIM-INTERFACE-SW  **
 13232******* IF THE CERTIFICATE HAS ALREADY GONE THROUGH A MONTH END **
 13233******************************************************************
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 241
* EL6311.cbl
 13234******************************************************************
 13235
 13236     IF CERT-ADDED-BATCH AND
 13237        (NOT NO-CLAIM-ATTACHED
 13238         OR
 13239         CM-CLAIM-ATTACHED-COUNT GREATER THAN +0)
 13240        GO TO 1410-REWRITE-CERT.
 13241
 13242******************************************************************
 13243******************************************************************
 13244
 13245     IF CERT-ADDED-BATCH  AND
 13246        (NO-CLAIM-ATTACHED OR CM-CLAIM-ATTACHED-COUNT = ZEROS)
 13247        GO TO 1410-REWRITE-CERT.
 13248
 13249     IF NO-CLAIM-ATTACHED
 13250        NEXT SENTENCE
 13251     ELSE
 13252        MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-1
 13253        MOVE '2'                    TO CM-CLAIM-INTERFACE-SW
 13254        GO TO 1410-REWRITE-CERT.
 13255
 13256     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 13257     MOVE 'D'                      TO JP-RECORD-TYPE.
 13258     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 13259
 13260
 13261* EXEC CICS DELETE
 13262*         DATASET    (FILE-ID-ELCERT)
 13263*    END-EXEC.
 13264*    MOVE '&(                    &   #00012361' TO DFHEIV0
 13265     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13266     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13267     MOVE X'2020233030303132333631' TO DFHEIV0(25:11)
 13268     CALL 'kxdfhei1' USING DFHEIV0,
 13269           FILE-ID-ELCERT,
 13270           DFHEIV99,
 13271           DFHEIV99,
 13272           DFHEIV99,
 13273           DFHEIV99
 13274     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13275
 13276
 13277     PERFORM 8400-LOG-JOURNAL-RECORD.
 13278
 13279******************************************************************
 13280*                                                                *
 13281*       DELETE CERTIFICATE NOTES FOR ALL DELETED CERTIFICATES    *
 13282*                                                                *
 13283******************************************************************
 13284
 13285     IF  CERT-NOTES-ARE-PRESENT
 13286         NEXT SENTENCE
 13287     ELSE
 13288         GO TO 1407-DELETE-MAILING.
 13289
 13290
 13291* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 242
* EL6311.cbl
 13292*         NOTFND  (1406-DELETE-ERNOTE)
 13293*    END-EXEC.
 13294*    MOVE '"$I                   ! . #00012378' TO DFHEIV0
 13295     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13296     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13297     MOVE X'2E20233030303132333738' TO DFHEIV0(25:11)
 13298     CALL 'kxdfhei1' USING DFHEIV0
 13299     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13300
 13301
 13302     MOVE ELCERT-KEY            TO ERCNOT-KEY.
 13303     MOVE '0'                   TO ERCNOT-REC-TYPE.
 13304     MOVE 0                     TO ERCNOT-SEQUENCE.
 13305
 13306 1406-DELETE-ERCNOT-LOOP.
 13307
 13308
 13309* EXEC CICS READ
 13310*        GTEQ
 13311*        DATASET   (FILE-ID-ERCNOT)
 13312*        SET       (ADDRESS OF CERT-NOTE-FILE)
 13313*        RIDFLD    (ERCNOT-KEY)
 13314*    END-EXEC.
 13315*    MOVE '&"S        G          (   #00012388' TO DFHEIV0
 13316     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 13317     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13318     MOVE X'2020233030303132333838' TO DFHEIV0(25:11)
 13319     CALL 'kxdfhei1' USING DFHEIV0,
 13320           FILE-ID-ERCNOT,
 13321           DFHEIV20,
 13322           DFHEIV99,
 13323           ERCNOT-KEY,
 13324           DFHEIV99,
 13325           DFHEIV99,
 13326           DFHEIV99
 13327     SET ADDRESS OF CERT-NOTE-FILE TO
 13328         DFHEIV20
 13329     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13330
 13331
 13332     MOVE CZ-CONTROL-PRIMARY      TO ERCNOT-KEY
 13333     IF ERCNOT-PART-KEY NOT EQUAL ELCERT-KEY
 13334         GO TO 1406-DELETE-ERNOTE
 13335     END-IF.
 13336
 13337     MOVE FILE-ID-ERCNOT         TO  JP-FILE-ID.
 13338     MOVE 'D'                    TO  JP-RECORD-TYPE.
 13339     MOVE CERT-NOTE-FILE         TO  JP-RECORD-AREA.
 13340
 13341     MOVE ERCNOT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 13342
 13343
 13344* EXEC CICS DELETE
 13345*        DATASET   (FILE-ID-ERCNOT)
 13346*        RIDFLD    (ERCNOT-KEY)
 13347*        END-EXEC.
 13348*    MOVE '&(  R                 &   #00012406' TO DFHEIV0
 13349     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 243
* EL6311.cbl
 13350     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13351     MOVE X'2020233030303132343036' TO DFHEIV0(25:11)
 13352     CALL 'kxdfhei1' USING DFHEIV0,
 13353           FILE-ID-ERCNOT,
 13354           ERCNOT-KEY,
 13355           DFHEIV99,
 13356           DFHEIV99,
 13357           DFHEIV99
 13358     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13359
 13360
 13361     PERFORM 8400-LOG-JOURNAL-RECORD.
 13362
 13363     GO TO 1406-DELETE-ERCNOT-LOOP.
 13364
 13365 1406-DELETE-ERNOTE.
 13366
 13367
 13368* EXEC CICS HANDLE CONDITION
 13369*         NOTFND  (1407-DELETE-MAILING)
 13370*    END-EXEC.
 13371*    MOVE '"$I                   ! / #00012417' TO DFHEIV0
 13372     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13373     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13374     MOVE X'2F20233030303132343137' TO DFHEIV0(25:11)
 13375     CALL 'kxdfhei1' USING DFHEIV0
 13376     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13377
 13378
 13379
 13380* EXEC CICS READ
 13381*        EQUAL
 13382*        DATASET   (FILE-ID-ERNOTE)
 13383*        SET       (ADDRESS OF CERTIFICATE-NOTE)
 13384*        RIDFLD    (ELCERT-KEY)
 13385*        UPDATE
 13386*    END-EXEC.
 13387*    MOVE '&"S        EU         (   #00012421' TO DFHEIV0
 13388     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13389     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13390     MOVE X'2020233030303132343231' TO DFHEIV0(25:11)
 13391     CALL 'kxdfhei1' USING DFHEIV0,
 13392           FILE-ID-ERNOTE,
 13393           DFHEIV20,
 13394           DFHEIV99,
 13395           ELCERT-KEY,
 13396           DFHEIV99,
 13397           DFHEIV99,
 13398           DFHEIV99
 13399     SET ADDRESS OF CERTIFICATE-NOTE TO
 13400         DFHEIV20
 13401     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13402
 13403
 13404     MOVE FILE-ID-ERNOTE         TO  JP-FILE-ID.
 13405     MOVE 'D'                    TO  JP-RECORD-TYPE.
 13406     MOVE CERTIFICATE-NOTE       TO  JP-RECORD-AREA.
 13407
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 244
* EL6311.cbl
 13408     MOVE ERNOTE-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 13409
 13410
 13411* EXEC CICS DELETE
 13412*        DATASET   (FILE-ID-ERNOTE)
 13413*        END-EXEC.
 13414*    MOVE '&(                    &   #00012435' TO DFHEIV0
 13415     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13416     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13417     MOVE X'2020233030303132343335' TO DFHEIV0(25:11)
 13418     CALL 'kxdfhei1' USING DFHEIV0,
 13419           FILE-ID-ERNOTE,
 13420           DFHEIV99,
 13421           DFHEIV99,
 13422           DFHEIV99,
 13423           DFHEIV99
 13424     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13425
 13426
 13427     PERFORM 8400-LOG-JOURNAL-RECORD.
 13428
 13429******************************************************************
 13430*                                                                *
 13431*                DELETE MAILING ADDRESS RECORDS                  *
 13432*                                                                *
 13433******************************************************************
 13434
 13435 1407-DELETE-MAILING.
 13436     IF CERT-ADDRESS-PRESENT
 13437        NEXT SENTENCE
 13438     ELSE
 13439        GO TO 1420-CONTINUE-DELETE.
 13440
 13441
 13442* EXEC CICS HANDLE CONDITION
 13443*         NOTFND  (1420-CONTINUE-DELETE)
 13444*    END-EXEC.
 13445*    MOVE '"$I                   ! 0 #00012453' TO DFHEIV0
 13446     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13447     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13448     MOVE X'3020233030303132343533' TO DFHEIV0(25:11)
 13449     CALL 'kxdfhei1' USING DFHEIV0
 13450     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13451
 13452
 13453
 13454* EXEC CICS READ
 13455*        EQUAL
 13456*        DATASET   (FILE-ID-ERMAIL)
 13457*        SET       (ADDRESS OF MAILING-DATA)
 13458*        RIDFLD    (ELCERT-KEY)
 13459*        UPDATE
 13460*    END-EXEC.
 13461*    MOVE '&"S        EU         (   #00012457' TO DFHEIV0
 13462     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13463     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13464     MOVE X'2020233030303132343537' TO DFHEIV0(25:11)
 13465     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 245
* EL6311.cbl
 13466           FILE-ID-ERMAIL,
 13467           DFHEIV20,
 13468           DFHEIV99,
 13469           ELCERT-KEY,
 13470           DFHEIV99,
 13471           DFHEIV99,
 13472           DFHEIV99
 13473     SET ADDRESS OF MAILING-DATA TO
 13474         DFHEIV20
 13475     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13476
 13477
 13478     MOVE FILE-ID-ERMAIL         TO  JP-FILE-ID.
 13479     MOVE 'D'                    TO  JP-RECORD-TYPE.
 13480     MOVE MAILING-DATA           TO  JP-RECORD-AREA.
 13481
 13482     MOVE ERMAIL-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 13483
 13484
 13485* EXEC CICS DELETE
 13486*        DATASET   (FILE-ID-ERMAIL)
 13487*    END-EXEC.
 13488*    MOVE '&(                    &   #00012471' TO DFHEIV0
 13489     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13490     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13491     MOVE X'2020233030303132343731' TO DFHEIV0(25:11)
 13492     CALL 'kxdfhei1' USING DFHEIV0,
 13493           FILE-ID-ERMAIL,
 13494           DFHEIV99,
 13495           DFHEIV99,
 13496           DFHEIV99,
 13497           DFHEIV99
 13498     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13499
 13500
 13501     GO TO 1420-CONTINUE-DELETE.
 13502
 13503 1410-REWRITE-CERT.
 13504     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 13505     MOVE 'C'                      TO JP-RECORD-TYPE.
 13506     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 13507     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 13508
 13509
 13510* EXEC CICS REWRITE
 13511*         DATASET    (FILE-ID-ELCERT)
 13512*         FROM       (CERTIFICATE-MASTER)
 13513*         END-EXEC.
 13514     MOVE LENGTH OF
 13515      CERTIFICATE-MASTER
 13516       TO DFHEIV11
 13517*    MOVE '&& L                  %   #00012483' TO DFHEIV0
 13518     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13519     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13520     MOVE X'2020233030303132343833' TO DFHEIV0(25:11)
 13521     CALL 'kxdfhei1' USING DFHEIV0,
 13522           FILE-ID-ELCERT,
 13523           CERTIFICATE-MASTER,
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 246
* EL6311.cbl
 13524           DFHEIV11,
 13525           DFHEIV99
 13526     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13527
 13528
 13529     PERFORM 8400-LOG-JOURNAL-RECORD.
 13530
 13531 1420-CONTINUE-DELETE.
 13532     SUBTRACT PB-I-LF-PREMIUM-AMT FROM WS-B-LF-ISS-PRM-ENTERED.
 13533     SUBTRACT PB-I-LF-PREM-CALC   FROM WS-B-LF-ISS-PRM-COMPUTED.
 13534
 13535     SUBTRACT PB-I-AH-PREMIUM-AMT FROM WS-B-AH-ISS-PRM-ENTERED.
 13536     SUBTRACT PB-I-AH-PREM-CALC   FROM WS-B-AH-ISS-PRM-COMPUTED.
 13537
 13538     SUBTRACT +1 FROM WS-B-ISSUE-CNT-ENTERED.
 13539
 13540 1450-DELETE-PB-RECORD.
 13541     MOVE FILE-ID-ERPNDB           TO JP-FILE-ID
 13542     MOVE 'D'                      TO JP-RECORD-TYPE
 13543     MOVE PENDING-BUSINESS         TO JP-RECORD-AREA.
 13544
 13545
 13546* EXEC CICS DELETE
 13547*        DATASET    (FILE-ID-ERPNDB)
 13548*    END-EXEC.
 13549*    MOVE '&(                    &   #00012504' TO DFHEIV0
 13550     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13551     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13552     MOVE X'2020233030303132353034' TO DFHEIV0(25:11)
 13553     CALL 'kxdfhei1' USING DFHEIV0,
 13554           FILE-ID-ERPNDB,
 13555           DFHEIV99,
 13556           DFHEIV99,
 13557           DFHEIV99,
 13558           DFHEIV99
 13559     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13560
 13561
 13562     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 13563
 13564     PERFORM 8400-LOG-JOURNAL-RECORD *> Journal Delete
 13565
 13566     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 13567     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 13568     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 13569
 13570
 13571* EXEC CICS HANDLE CONDITION
 13572*         NOTFND    (1480-BATCH-HDR-NOT-FOUND)
 13573*    END-EXEC.
 13574*    MOVE '"$I                   ! 1 #00012516' TO DFHEIV0
 13575     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13576     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13577     MOVE X'3120233030303132353136' TO DFHEIV0(25:11)
 13578     CALL 'kxdfhei1' USING DFHEIV0
 13579     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13580
 13581
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 247
* EL6311.cbl
 13582
 13583* EXEC CICS READ
 13584*        SET     (ADDRESS OF PENDING-BUSINESS)
 13585*        DATASET (FILE-ID-ERPNDB)
 13586*        RIDFLD  (ERPNDB-KEY)
 13587*        UPDATE
 13588*    END-EXEC.
 13589*    MOVE '&"S        EU         (   #00012520' TO DFHEIV0
 13590     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13591     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13592     MOVE X'2020233030303132353230' TO DFHEIV0(25:11)
 13593     CALL 'kxdfhei1' USING DFHEIV0,
 13594           FILE-ID-ERPNDB,
 13595           DFHEIV20,
 13596           DFHEIV99,
 13597           ERPNDB-KEY,
 13598           DFHEIV99,
 13599           DFHEIV99,
 13600           DFHEIV99
 13601     SET ADDRESS OF PENDING-BUSINESS TO
 13602         DFHEIV20
 13603     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13604
 13605
 13606     MOVE ERPNDB-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 13607
 13608     MOVE  FILE-ID-ERPNDB          TO JP-FILE-ID.
 13609
 13610     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 13611        WS-B-CANCEL-CNT-ENTERED = ZEROS
 13612        MOVE 'D'                   TO JP-RECORD-TYPE
 13613        MOVE PENDING-BUSINESS      TO JP-RECORD-AREA
 13614
 13615* EXEC CICS DELETE
 13616*            DATASET    (FILE-ID-ERPNDB)
 13617*       END-EXEC
 13618*    MOVE '&(                    &   #00012535' TO DFHEIV0
 13619     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13620     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13621     MOVE X'2020233030303132353335' TO DFHEIV0(25:11)
 13622     CALL 'kxdfhei1' USING DFHEIV0,
 13623           FILE-ID-ERPNDB,
 13624           DFHEIV99,
 13625           DFHEIV99,
 13626           DFHEIV99,
 13627           DFHEIV99
 13628     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13629        PERFORM 8400-LOG-JOURNAL-RECORD  *> Journal Delete
 13630     ELSE
 13631        MOVE 'B'                 TO JP-RECORD-TYPE
 13632        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 13633        PERFORM 8400-LOG-JOURNAL-RECORD  *> Before Image
 13634        MOVE WS-BATCH-RECORD     TO PB-BATCH-RECORD
 13635        MOVE 'C'                 TO JP-RECORD-TYPE
 13636        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 13637
 13638* EXEC CICS REWRITE
 13639*            DATASET    (FILE-ID-ERPNDB)
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 248
* EL6311.cbl
 13640*            FROM       (PENDING-BUSINESS)
 13641*       END-EXEC
 13642     MOVE LENGTH OF
 13643      PENDING-BUSINESS
 13644       TO DFHEIV11
 13645*    MOVE '&& L                  %   #00012546' TO DFHEIV0
 13646     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13647     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13648     MOVE X'2020233030303132353436' TO DFHEIV0(25:11)
 13649     CALL 'kxdfhei1' USING DFHEIV0,
 13650           FILE-ID-ERPNDB,
 13651           PENDING-BUSINESS,
 13652           DFHEIV11,
 13653           DFHEIV99
 13654     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13655        PERFORM 8400-LOG-JOURNAL-RECORD  *> After Image
 13656     end-if
 13657******************************************************************
 13658*                                                                *
 13659*       DELETE THE A/R REQUEST RECORD IF THE COMPANY USES        *
 13660*       THE ACCOUNTS RECEIVABLE SYSTEM.                          *
 13661*                                                                *
 13662******************************************************************
 13663
 13664     IF NOT PI-AR-PROCESSING
 13665        GO TO 1475-DELETE-FINISHED.
 13666
 13667     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 13668        WS-B-CANCEL-CNT-ENTERED = ZEROS
 13669        NEXT SENTENCE
 13670     ELSE
 13671        GO TO 1475-DELETE-FINISHED.
 13672
 13673
 13674* EXEC CICS HANDLE CONDITION
 13675*         NOTFND    (1475-DELETE-FINISHED)
 13676*         END-EXEC.
 13677*    MOVE '"$I                   ! 2 #00012568' TO DFHEIV0
 13678     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13679     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13680     MOVE X'3220233030303132353638' TO DFHEIV0(25:11)
 13681     CALL 'kxdfhei1' USING DFHEIV0
 13682     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13683
 13684
 13685     MOVE ERPNDB-COMPANY-CD      TO ERRQST-COMPANY-CD.
 13686     MOVE ERPNDB-ENTRY-BATCH     TO ERRQST-ENTRY-BATCH.
 13687
 13688
 13689* EXEC CICS READ
 13690*        SET     (ADDRESS OF AR-REQUEST-RECORD)
 13691*        DATASET (FILE-ID-ERRQST)
 13692*        RIDFLD  (ERRQST-KEY)
 13693*        UPDATE
 13694*    END-EXEC.
 13695*    MOVE '&"S        EU         (   #00012575' TO DFHEIV0
 13696     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13697     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 249
* EL6311.cbl
 13698     MOVE X'2020233030303132353735' TO DFHEIV0(25:11)
 13699     CALL 'kxdfhei1' USING DFHEIV0,
 13700           FILE-ID-ERRQST,
 13701           DFHEIV20,
 13702           DFHEIV99,
 13703           ERRQST-KEY,
 13704           DFHEIV99,
 13705           DFHEIV99,
 13706           DFHEIV99
 13707     SET ADDRESS OF AR-REQUEST-RECORD TO
 13708         DFHEIV20
 13709     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13710
 13711
 13712     MOVE ERRQST-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 13713
 13714     MOVE  FILE-ID-ERRQST          TO JP-FILE-ID.
 13715
 13716     MOVE 'D'                      TO JP-RECORD-TYPE.
 13717     MOVE AR-REQUEST-RECORD        TO JP-RECORD-AREA.
 13718
 13719
 13720* EXEC CICS DELETE
 13721*         DATASET    (FILE-ID-ERRQST)
 13722*    END-EXEC.
 13723*    MOVE '&(                    &   #00012589' TO DFHEIV0
 13724     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13725     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13726     MOVE X'2020233030303132353839' TO DFHEIV0(25:11)
 13727     CALL 'kxdfhei1' USING DFHEIV0,
 13728           FILE-ID-ERRQST,
 13729           DFHEIV99,
 13730           DFHEIV99,
 13731           DFHEIV99,
 13732           DFHEIV99
 13733     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13734
 13735
 13736     PERFORM 8400-LOG-JOURNAL-RECORD.
 13737
 13738 1475-DELETE-FINISHED.
 13739     MOVE ZEROS                  TO EMI-ERROR.
 13740     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13741     MOVE LOW-VALUES             TO EL631BI.
 13742     MOVE -1                     TO BMAINTL.
 13743     GO TO 8100-SEND-INITIAL-MAP.
 13744
 13745 1480-BATCH-HDR-NOT-FOUND.
 13746     MOVE -1                     TO BMAINTL.
 13747     MOVE ER-7450                TO EMI-ERROR.
 13748     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13749     GO TO 8200-SEND-DATAONLY.
 13750
 13751 1490-RECORD-NOT-FOUND.
 13752     MOVE -1                     TO BMAINTL.
 13753     MOVE ER-7451                TO EMI-ERROR.
 13754     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13755     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 250
* EL6311.cbl
 13756
 13757******************************************************************
 13758*            O V E R   C H A R G E   P R O C E S S I N G         *
 13759******************************************************************
 13760 1500-UPDATE-ERNOTE.
 13761     PERFORM 1510-ADD-ERNOTE-REC THRU 1510-EXIT
 13762     MOVE 'A'                    TO WS-NOTE-SW
 13763     PERFORM 1520-UPDATE-ELCERT  THRU 1520-EXIT
 13764     .
 13765 1500-EXIT.
 13766     EXIT.
 13767 1510-ADD-ERNOTE-REC.
 13768
 13769* EXEC CICS GETMAIN
 13770*        SET     (ADDRESS OF CERTIFICATE-NOTE)
 13771*        LENGTH  (ERNOTE-RECORD-LENGTH)
 13772*        INITIMG (GETMAIN-SPACE)
 13773*    END-EXEC
 13774*    MOVE ',"IL                  $   #00012625' TO DFHEIV0
 13775     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13776     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13777     MOVE X'2020233030303132363235' TO DFHEIV0(25:11)
 13778     CALL 'kxdfhei1' USING DFHEIV0,
 13779           DFHEIV20,
 13780           ERNOTE-RECORD-LENGTH,
 13781           GETMAIN-SPACE
 13782     SET ADDRESS OF CERTIFICATE-NOTE TO
 13783         DFHEIV20
 13784     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13785     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13786                                 TO ERNOTE-KEY
 13787
 13788* EXEC CICS READ
 13789*       DATASET    (FILE-ID-ERNOTE)
 13790*       RIDFLD     (ERNOTE-KEY)
 13791*       INTO       (CERTIFICATE-NOTE)
 13792*       RESP       (WS-RESPONSE)
 13793*       UPDATE
 13794*    END-EXEC
 13795     MOVE LENGTH OF
 13796      CERTIFICATE-NOTE
 13797       TO DFHEIV11
 13798*    MOVE '&"IL       EU         (  N#00012632' TO DFHEIV0
 13799     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 13800     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13801     MOVE X'204E233030303132363332' TO DFHEIV0(25:11)
 13802     CALL 'kxdfhei1' USING DFHEIV0,
 13803           FILE-ID-ERNOTE,
 13804           CERTIFICATE-NOTE,
 13805           DFHEIV11,
 13806           ERNOTE-KEY,
 13807           DFHEIV99,
 13808           DFHEIV99,
 13809           DFHEIV99
 13810     MOVE EIBRESP  TO WS-RESPONSE
 13811     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13812     IF RESP-NORMAL
 13813        IF CN-BILLING-START-LINE-NO NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 251
* EL6311.cbl
 13814           MOVE ZEROS            TO CN-BILLING-START-LINE-NO
 13815        END-IF
 13816        IF CN-BILLING-END-LINE-NO NOT NUMERIC
 13817           MOVE ZEROS            TO CN-BILLING-END-LINE-NO
 13818        END-IF
 13819        PERFORM VARYING N1 FROM +1 BY +1 UNTIL
 13820           (N1 > +10)
 13821           OR (CN-LINE (N1) (1:10) = 'OVERCHARGE')
 13822           OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 13823        END-PERFORM
 13824        IF (CN-LINE (N1) (1:10) = 'OVERCHARGE')
 13825          OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 13826
 13827* EXEC CICS UNLOCK
 13828*            DATASET    (FILE-ID-ERNOTE)
 13829*          END-EXEC
 13830*    MOVE '&*                    #   #00012653' TO DFHEIV0
 13831     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 13832     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13833     MOVE X'2020233030303132363533' TO DFHEIV0(25:11)
 13834     CALL 'kxdfhei1' USING DFHEIV0,
 13835           FILE-ID-ERNOTE,
 13836           DFHEIV99
 13837     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13838        ELSE
 13839          PERFORM VARYING N1 FROM +1 BY +1
 13840           UNTIL (N1 > +10)
 13841           OR (CN-LINE (N1) = SPACES OR LOW-VALUES)
 13842          END-PERFORM
 13843          IF (N1 < +11)
 13844            IF N1 >= CN-BILLING-START-LINE-NO AND
 13845              N1 <= CN-BILLING-END-LINE-NO
 13846              IF PI-COMPANY-ID = 'DCC' or 'VPP'
 13847                 MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13848              ELSE
 13849                 MOVE WS-VA-NO-COMM-MESS
 13850                                    TO CN-LINE (N1)
 13851              END-IF
 13852            ELSE
 13853              IF (CN-BILLING-END-LINE-NO NOT = ZEROS) AND
 13854               (N1 = (CN-BILLING-END-LINE-NO + +1))
 13855                IF PI-COMPANY-ID = 'DCC' or 'VPP'
 13856                  MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13857                ELSE
 13858                  MOVE WS-VA-NO-COMM-MESS
 13859                                    TO CN-LINE (N1)
 13860                END-IF
 13861                MOVE N1             TO CN-BILLING-END-LINE-NO
 13862              ELSE
 13863                IF (CN-BILLING-END-LINE-NO = ZEROS)
 13864                  IF PI-COMPANY-ID = 'DCC' or 'VPP'
 13865                     MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13866                  ELSE
 13867                     MOVE WS-VA-NO-COMM-MESS
 13868                                    TO CN-LINE (N1)
 13869                  END-IF
 13870                  MOVE N1            TO CN-BILLING-END-LINE-NO
 13871                                      CN-BILLING-START-LINE-NO
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 252
* EL6311.cbl
 13872                ELSE
 13873                  IF (CN-BILLING-START-LINE-NO NOT = ZEROS) AND
 13874                    (N1 = (CN-BILLING-START-LINE-NO - +1))
 13875                     IF PI-COMPANY-ID = 'DCC' or 'VPP'
 13876                       MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13877                     ELSE
 13878                       MOVE WS-VA-NO-COMM-MESS
 13879                                    TO CN-LINE (N1)
 13880                     END-IF
 13881                     MOVE N1         TO CN-BILLING-START-LINE-NO
 13882                  ELSE
 13883                     PERFORM 1700-SQUEEZE-IT-IN
 13884                                 THRU 1700-EXIT
 13885                  END-IF
 13886                END-IF
 13887              END-IF
 13888            END-IF
 13889            MOVE 'E631'              TO CN-LAST-MAINT-USER
 13890            MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
 13891            MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
 13892
 13893* EXEC CICS REWRITE
 13894*              DATASET    (FILE-ID-ERNOTE)
 13895*              FROM       (CERTIFICATE-NOTE)
 13896*              RESP       (WS-RESPONSE)
 13897*           END-EXEC
 13898     MOVE LENGTH OF
 13899      CERTIFICATE-NOTE
 13900       TO DFHEIV11
 13901*    MOVE '&& L                  %  N#00012710' TO DFHEIV0
 13902     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13903     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13904     MOVE X'204E233030303132373130' TO DFHEIV0(25:11)
 13905     CALL 'kxdfhei1' USING DFHEIV0,
 13906           FILE-ID-ERNOTE,
 13907           CERTIFICATE-NOTE,
 13908           DFHEIV11,
 13909           DFHEIV99
 13910     MOVE EIBRESP  TO WS-RESPONSE
 13911     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13912          END-IF
 13913        END-IF
 13914     ELSE
 13915        MOVE SPACES              TO CERTIFICATE-NOTE
 13916        MOVE 'CN'                TO CN-RECORD-ID
 13917        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13918                                 TO CN-CONTROL-PRIMARY
 13919                                    ERNOTE-KEY
 13920        MOVE 01                  TO CN-BILLING-START-LINE-NO
 13921                                    CN-BILLING-END-LINE-NO
 13922        IF PI-COMPANY-ID = 'DCC' or 'VPP'
 13923           MOVE WS-OC-MESSAGE    TO CN-LINE (1)
 13924        ELSE
 13925           MOVE WS-VA-NO-COMM-MESS
 13926                                 TO CN-LINE (1)
 13927        END-IF
 13928        MOVE 'E631'              TO CN-LAST-MAINT-USER
 13929        MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 253
* EL6311.cbl
 13930        MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
 13931
 13932* EXEC CICS WRITE
 13933*          DATASET    (FILE-ID-ERNOTE)
 13934*          FROM       (CERTIFICATE-NOTE)
 13935*          RIDFLD     (ERNOTE-KEY)
 13936*          RESP       (WS-RESPONSE)
 13937*       END-EXEC
 13938     MOVE LENGTH OF
 13939      CERTIFICATE-NOTE
 13940       TO DFHEIV11
 13941*    MOVE '&$ L                  ''  N#00012734' TO DFHEIV0
 13942     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13943     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13944     MOVE X'204E233030303132373334' TO DFHEIV0(25:11)
 13945     CALL 'kxdfhei1' USING DFHEIV0,
 13946           FILE-ID-ERNOTE,
 13947           CERTIFICATE-NOTE,
 13948           DFHEIV11,
 13949           ERNOTE-KEY,
 13950           DFHEIV99,
 13951           DFHEIV99
 13952     MOVE EIBRESP  TO WS-RESPONSE
 13953     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13954     END-IF
 13955     .
 13956 1510-EXIT.
 13957     EXIT.
 13958 1520-UPDATE-ELCERT.
 13959     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13960                                 TO ELCERT-KEY
 13961
 13962* EXEC CICS READ
 13963*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 13964*        DATASET (FILE-ID-ELCERT)
 13965*        RIDFLD  (ELCERT-KEY)
 13966*        UPDATE
 13967*        RESP    (WS-RESPONSE)
 13968*    END-EXEC
 13969*    MOVE '&"S        EU         (  N#00012747' TO DFHEIV0
 13970     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13971     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13972     MOVE X'204E233030303132373437' TO DFHEIV0(25:11)
 13973     CALL 'kxdfhei1' USING DFHEIV0,
 13974           FILE-ID-ELCERT,
 13975           DFHEIV20,
 13976           DFHEIV99,
 13977           ELCERT-KEY,
 13978           DFHEIV99,
 13979           DFHEIV99,
 13980           DFHEIV99
 13981     SET ADDRESS OF CERTIFICATE-MASTER TO
 13982         DFHEIV20
 13983     MOVE EIBRESP  TO WS-RESPONSE
 13984     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13985     IF RESP-NORMAL
 13986        IF WS-NOTE-SW = 'A'
 13987           IF CM-NOTE-SW = ' '
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 254
* EL6311.cbl
 13988              MOVE '2'             TO CM-NOTE-SW
 13989           ELSE
 13990             IF CM-NOTE-SW = '1'
 13991                MOVE '3'           TO CM-NOTE-SW
 13992             ELSE
 13993               IF CM-NOTE-SW = '4'
 13994                  MOVE '6'         TO CM-NOTE-SW
 13995               ELSE
 13996                 IF CM-NOTE-SW = '5'
 13997                    MOVE '7'       TO CM-NOTE-SW
 13998                 END-IF
 13999               END-IF
 14000             END-IF
 14001           END-IF
 14002        ELSE
 14003           IF CM-NOTE-SW = '2'
 14004              MOVE ' '             TO CM-NOTE-SW
 14005           ELSE
 14006             IF CM-NOTE-SW = '3'
 14007                MOVE '1'           TO CM-NOTE-SW
 14008             ELSE
 14009               IF CM-NOTE-SW = '6'
 14010                  MOVE '4'         TO CM-NOTE-SW
 14011               ELSE
 14012                 IF CM-NOTE-SW = '7'
 14013                    MOVE '5'       TO CM-NOTE-SW
 14014                 END-IF
 14015               END-IF
 14016             END-IF
 14017           END-IF
 14018        END-IF
 14019
 14020* EXEC CICS REWRITE
 14021*          DATASET    (FILE-ID-ELCERT)
 14022*          FROM       (CERTIFICATE-MASTER)
 14023*          RESP       (WS-RESPONSE)
 14024*       END-EXEC
 14025     MOVE LENGTH OF
 14026      CERTIFICATE-MASTER
 14027       TO DFHEIV11
 14028*    MOVE '&& L                  %  N#00012788' TO DFHEIV0
 14029     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 14030     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 14031     MOVE X'204E233030303132373838' TO DFHEIV0(25:11)
 14032     CALL 'kxdfhei1' USING DFHEIV0,
 14033           FILE-ID-ELCERT,
 14034           CERTIFICATE-MASTER,
 14035           DFHEIV11,
 14036           DFHEIV99
 14037     MOVE EIBRESP  TO WS-RESPONSE
 14038     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14039        IF RESP-NORMAL
 14040           CONTINUE
 14041        ELSE
 14042           MOVE WS-RESPONSE TO EMI-ERROR
 14043           PERFORM 9900-ERROR-FORMAT
 14044                                 THRU 9900-EXIT
 14045           GO TO 8200-SEND-DATAONLY
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 255
* EL6311.cbl
 14046        END-IF
 14047     ELSE
 14048        MOVE -1                  TO BMAINTL
 14049        MOVE 0249                TO EMI-ERROR
 14050        PERFORM 9900-ERROR-FORMAT
 14051                                 THRU 9900-EXIT
 14052        GO TO 8200-SEND-DATAONLY
 14053     END-IF
 14054     .
 14055 1520-EXIT.
 14056     EXIT.
 14057 1600-UPDATE-ERPYAJ.
 14058     PERFORM 1610-ADD-ERPYAJ-BANK-REC
 14059                                 THRU 1610-EXIT
 14060     PERFORM 1620-ADD-ERPYAJ-DLR-REC
 14061                                 THRU 1620-EXIT
 14062     .
 14063 1600-EXIT.
 14064     EXIT.
 14065 1610-ADD-ERPYAJ-BANK-REC.
 14066
 14067* EXEC CICS GETMAIN
 14068*        SET     (ADDRESS OF PENDING-PAY-ADJ)
 14069*        LENGTH  (ERPYAJ-RECORD-LENGTH)
 14070*        INITIMG (GETMAIN-SPACE)
 14071*    END-EXEC
 14072*    MOVE ',"IL                  $   #00012820' TO DFHEIV0
 14073     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 14074     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14075     MOVE X'2020233030303132383230' TO DFHEIV0(25:11)
 14076     CALL 'kxdfhei1' USING DFHEIV0,
 14077           DFHEIV20,
 14078           ERPYAJ-RECORD-LENGTH,
 14079           GETMAIN-SPACE
 14080     SET ADDRESS OF PENDING-PAY-ADJ TO
 14081         DFHEIV20
 14082     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14083     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 14084     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 14085     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 14086     MOVE PB-I-BANK-NUMBER       TO ERPYAJ-FIN-RESP
 14087     MOVE LOW-VALUES             TO ERPYAJ-ACCOUNT
 14088     MOVE +10                    TO ERPYAJ-SEQ-NO
 14089     MOVE 'R'                    TO ERPYAJ-TYPE
 14090     IF REVERSAL
 14091        MOVE 'C'                 TO ERPYAJ-TYPE
 14092     END-IF
 14093     MOVE SPACES                 TO PENDING-PAY-ADJ
 14094     MOVE 'PY'                   TO PY-RECORD-ID
 14095     MOVE ERPYAJ-KEY             TO PY-CONTROL-PRIMARY
 14096     MOVE WS-OC-AMT              TO PY-ENTRY-AMT
 14097     IF REVERSAL
 14098        MOVE PB-I-DCC-OVER-CHG-AMT
 14099                                 TO PY-ENTRY-AMT
 14100     END-IF
 14101     MOVE WS-CURRENT-BIN-DT      TO PY-LAST-MAINT-DT
 14102                                    PY-INPUT-DT
 14103*    MOVE X'A15F'                TO PY-LAST-MAINT-DT
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 256
* EL6311.cbl
 14104*                                   PY-INPUT-DT
 14105     MOVE PI-PROCESSOR-ID        TO PY-LAST-MAINT-BY
 14106     MOVE PI-CR-MONTH-END-DT     TO PY-CREDIT-SELECT-DT
 14107     MOVE 'OVERCHARGE'           TO PY-GL-COMMENT
 14108     MOVE 'B'                    TO PY-ERCOMP-TYPE
 14109     IF PB-CARRIER = '2'
 14110        MOVE '2725040330'        TO PY-GL-ACCOUNT
 14111     ELSE
 14112        MOVE '2725040130'        TO PY-GL-ACCOUNT
 14113     END-IF
 14114     MOVE LOW-VALUES             TO PY-CREDIT-ACCEPT-DT
 14115                                    PY-BILLED-DATE
 14116                                    PY-AR-DATE
 14117                                    PY-REPORTED-DT
 14118                                    PY-CHECK-WRITTEN-DT
 14119     MOVE ZEROS                  TO PY-CHECK-QUE-CONTROL
 14120                                    PY-CHECK-QUE-SEQUENCE
 14121     MOVE EIBTIME                TO PY-LAST-MAINT-HHMMSS
 14122     PERFORM WITH TEST AFTER
 14123        UNTIL (NOT RESP-DUPKEY)
 14124           AND (NOT RESP-DUPREC)
 14125
 14126* EXEC CICS WRITE
 14127*          DATASET    (FILE-ID-ERPYAJ)
 14128*          FROM       (PENDING-PAY-ADJ)
 14129*          RIDFLD     (ERPYAJ-KEY)
 14130*          RESP       (WS-RESPONSE)
 14131*       END-EXEC
 14132     MOVE LENGTH OF
 14133      PENDING-PAY-ADJ
 14134       TO DFHEIV11
 14135*    MOVE '&$ L                  ''  N#00012867' TO DFHEIV0
 14136     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 14137     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14138     MOVE X'204E233030303132383637' TO DFHEIV0(25:11)
 14139     CALL 'kxdfhei1' USING DFHEIV0,
 14140           FILE-ID-ERPYAJ,
 14141           PENDING-PAY-ADJ,
 14142           DFHEIV11,
 14143           ERPYAJ-KEY,
 14144           DFHEIV99,
 14145           DFHEIV99
 14146     MOVE EIBRESP  TO WS-RESPONSE
 14147     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14148        IF RESP-DUPKEY OR RESP-DUPREC
 14149           ADD +1                TO ERPYAJ-SEQ-NO
 14150           MOVE ERPYAJ-SEQ-NO    TO PY-FILE-SEQ-NO
 14151        END-IF
 14152     END-PERFORM
 14153     .
 14154 1610-EXIT.
 14155     EXIT.
 14156 1620-ADD-ERPYAJ-DLR-REC.
 14157     MOVE 'C'                    TO ERPYAJ-TYPE
 14158     IF REVERSAL
 14159        MOVE 'R'                 TO ERPYAJ-TYPE
 14160     END-IF
 14161     MOVE PB-ACCOUNT             TO ERPYAJ-FIN-RESP
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 257
* EL6311.cbl
 14162                                    ERPYAJ-ACCOUNT
 14163     ADD +1                      TO ERPYAJ-SEQ-NO
 14164     MOVE ERPYAJ-KEY             TO PY-CONTROL-PRIMARY
 14165     MOVE 'A'                    TO PY-ERCOMP-TYPE
 14166     IF PB-CARRIER = '2'
 14167        MOVE '2725040330'        TO PY-GL-ACCOUNT
 14168     ELSE
 14169        MOVE '2725040130'        TO PY-GL-ACCOUNT
 14170     END-IF
 14171     PERFORM WITH TEST AFTER
 14172        UNTIL (NOT RESP-DUPKEY)
 14173           AND (NOT RESP-DUPREC)
 14174
 14175* EXEC CICS WRITE
 14176*          DATASET    (FILE-ID-ERPYAJ)
 14177*          FROM       (PENDING-PAY-ADJ)
 14178*          RIDFLD     (ERPYAJ-KEY)
 14179*          RESP       (WS-RESPONSE)
 14180*       END-EXEC
 14181     MOVE LENGTH OF
 14182      PENDING-PAY-ADJ
 14183       TO DFHEIV11
 14184*    MOVE '&$ L                  ''  N#00012899' TO DFHEIV0
 14185     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 14186     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14187     MOVE X'204E233030303132383939' TO DFHEIV0(25:11)
 14188     CALL 'kxdfhei1' USING DFHEIV0,
 14189           FILE-ID-ERPYAJ,
 14190           PENDING-PAY-ADJ,
 14191           DFHEIV11,
 14192           ERPYAJ-KEY,
 14193           DFHEIV99,
 14194           DFHEIV99
 14195     MOVE EIBRESP  TO WS-RESPONSE
 14196     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14197        IF RESP-DUPKEY OR RESP-DUPREC
 14198           ADD +1                TO ERPYAJ-SEQ-NO
 14199           MOVE ERPYAJ-SEQ-NO    TO PY-FILE-SEQ-NO
 14200        END-IF
 14201     END-PERFORM
 14202     .
 14203 1620-EXIT.
 14204     EXIT.
 14205 1700-SQUEEZE-IT-IN.
 14206     IF (N1 > CN-BILLING-END-LINE-NO)
 14207        PERFORM VARYING N1 FROM N1 BY -1 UNTIL
 14208           N1 = +1
 14209           MOVE CN-LINE (N1 - 1)    TO CN-LINE (N1)
 14210           IF (N1 - 1) = (CN-BILLING-END-LINE-NO + 1)
 14211              IF PI-COMPANY-ID = 'DCC' or 'VPP'
 14212                 MOVE WS-OC-MESSAGE TO CN-LINE (N1 - 1)
 14213              ELSE
 14214                 MOVE WS-VA-NO-COMM-MESS TO CN-LINE (N1 - 1)
 14215              END-IF
 14216              COMPUTE CN-BILLING-END-LINE-NO = N1 - 1
 14217              MOVE +2 TO N1
 14218           END-IF
 14219        END-PERFORM
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 258
* EL6311.cbl
 14220     ELSE
 14221        IF (N1 < CN-BILLING-START-LINE-NO)
 14222           PERFORM VARYING N1 FROM N1 BY +1 UNTIL
 14223              N1 = +10
 14224              MOVE CN-LINE (N1 + 1) TO CN-LINE (N1)
 14225              IF (N1 + 1) = (CN-BILLING-START-LINE-NO - 1)
 14226                 IF PI-COMPANY-ID = 'DCC' or 'VPP'
 14227                    MOVE WS-OC-MESSAGE TO CN-LINE (N1 + 1)
 14228                 ELSE
 14229                    MOVE WS-VA-NO-COMM-MESS TO CN-LINE (N1 + 1)
 14230                 END-IF
 14231                 COMPUTE CN-BILLING-START-LINE-NO = N1 + 1
 14232                 MOVE +9 TO N1
 14233              END-IF
 14234           END-PERFORM
 14235        END-IF
 14236     END-IF
 14237     .
 14238 1700-EXIT.
 14239     EXIT.
 14240 1800-REMOVE-CERT-NOTES.
 14241     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 14242                                 TO ERNOTE-KEY
 14243
 14244* EXEC CICS READ
 14245*       SET        (ADDRESS OF CERTIFICATE-NOTE)
 14246*       DATASET    (FILE-ID-ERNOTE)
 14247*       RIDFLD     (ERNOTE-KEY)
 14248*       RESP       (WS-RESPONSE)
 14249*       UPDATE
 14250*    END-EXEC
 14251*    MOVE '&"S        EU         (  N#00012951' TO DFHEIV0
 14252     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14253     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14254     MOVE X'204E233030303132393531' TO DFHEIV0(25:11)
 14255     CALL 'kxdfhei1' USING DFHEIV0,
 14256           FILE-ID-ERNOTE,
 14257           DFHEIV20,
 14258           DFHEIV99,
 14259           ERNOTE-KEY,
 14260           DFHEIV99,
 14261           DFHEIV99,
 14262           DFHEIV99
 14263     SET ADDRESS OF CERTIFICATE-NOTE TO
 14264         DFHEIV20
 14265     MOVE EIBRESP  TO WS-RESPONSE
 14266     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14267     IF RESP-NORMAL
 14268        PERFORM VARYING N1 FROM +1 BY +1 UNTIL
 14269           (N1 > +10)
 14270           OR (CN-LINE (N1) (1:10) = 'OVERCHARGE')
 14271           OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 14272        END-PERFORM
 14273        IF N1 < +11
 14274           MOVE SPACES              TO CN-LINE (N1)
 14275           IF N1 >= CN-BILLING-START-LINE-NO  AND
 14276              N1 <= CN-BILLING-END-LINE-NO
 14277              SUBTRACT 1 FROM CN-BILLING-END-LINE-NO
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 259
* EL6311.cbl
 14278              IF CN-BILLING-END-LINE-NO <
 14279                               CN-BILLING-START-LINE-NO
 14280                 MOVE ZEROS         TO CN-BILLING-END-LINE-NO
 14281                                     CN-BILLING-START-LINE-NO
 14282              END-IF
 14283              PERFORM 1820-SQUEEZE-ERNOTE
 14284                                  THRU 1820-EXIT
 14285           END-IF
 14286           IF CN-LINES = SPACES
 14287
 14288* EXEC CICS DELETE
 14289*                DATASET    (FILE-ID-ERNOTE)
 14290*                RESP       (WS-RESPONSE)
 14291*             END-EXEC
 14292*    MOVE '&(                    &  N#00012978' TO DFHEIV0
 14293     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 14294     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14295     MOVE X'204E233030303132393738' TO DFHEIV0(25:11)
 14296     CALL 'kxdfhei1' USING DFHEIV0,
 14297           FILE-ID-ERNOTE,
 14298           DFHEIV99,
 14299           DFHEIV99,
 14300           DFHEIV99,
 14301           DFHEIV99
 14302     MOVE EIBRESP  TO WS-RESPONSE
 14303     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14304              IF RESP-NORMAL
 14305                 MOVE 'D'        TO WS-NOTE-SW
 14306                 PERFORM 1520-UPDATE-ELCERT
 14307                                 THRU 1520-EXIT
 14308              END-IF
 14309           ELSE
 14310
 14311* EXEC CICS REWRITE
 14312*                DATASET    (FILE-ID-ERNOTE)
 14313*                FROM       (CERTIFICATE-NOTE)
 14314*                RESP       (WS-RESPONSE)
 14315*             END-EXEC
 14316     MOVE LENGTH OF
 14317      CERTIFICATE-NOTE
 14318       TO DFHEIV11
 14319*    MOVE '&& L                  %  N#00012988' TO DFHEIV0
 14320     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 14321     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 14322     MOVE X'204E233030303132393838' TO DFHEIV0(25:11)
 14323     CALL 'kxdfhei1' USING DFHEIV0,
 14324           FILE-ID-ERNOTE,
 14325           CERTIFICATE-NOTE,
 14326           DFHEIV11,
 14327           DFHEIV99
 14328     MOVE EIBRESP  TO WS-RESPONSE
 14329     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14330           END-IF
 14331        END-IF
 14332     END-IF
 14333     .
 14334 1800-EXIT.
 14335     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 260
* EL6311.cbl
 14336 1820-SQUEEZE-ERNOTE.
 14337     MOVE CN-BILLING-START-LINE-NO TO N2
 14338     IF N2 = 0
 14339         MOVE +1                 TO N2
 14340     END-IF
 14341     PERFORM VARYING N1 FROM N2 BY +1 UNTIL
 14342        (N1 > +9)
 14343        IF CN-LINE (N1) = SPACES
 14344           MOVE CN-LINE (N1 + +1)
 14345                                 TO CN-LINE (N1)
 14346           MOVE SPACES           TO CN-LINE (N1 + +1)
 14347        END-IF
 14348     END-PERFORM
 14349     .
 14350 1820-EXIT.
 14351     EXIT.
 14352 1900-DELETE-ERPYAJ.
 14353     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 14354     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 14355     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 14356     MOVE PB-I-BANK-NUMBER       TO ERPYAJ-FIN-RESP
 14357     MOVE LOW-VALUES             TO ERPYAJ-ACCOUNT
 14358     MOVE +10                    TO ERPYAJ-SEQ-NO
 14359     MOVE 'R'                    TO ERPYAJ-TYPE
 14360     MOVE ERPYAJ-KEY             TO WS-SAVE-ERPYAJ-KEY
 14361
 14362* EXEC CICS STARTBR
 14363*       DATASET    (FILE-ID-ERPYAJ)
 14364*       RIDFLD     (ERPYAJ-KEY)
 14365*       RESP       (WS-RESPONSE)
 14366*    END-EXEC
 14367     MOVE 0
 14368       TO DFHEIV11
 14369*    MOVE '&,         G          &  N#00013024' TO DFHEIV0
 14370     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 14371     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14372     MOVE X'204E233030303133303234' TO DFHEIV0(25:11)
 14373     CALL 'kxdfhei1' USING DFHEIV0,
 14374           FILE-ID-ERPYAJ,
 14375           ERPYAJ-KEY,
 14376           DFHEIV99,
 14377           DFHEIV11,
 14378           DFHEIV99
 14379     MOVE EIBRESP  TO WS-RESPONSE
 14380     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14381     IF RESP-NORMAL
 14382        CONTINUE
 14383     ELSE
 14384        GO TO 1900-GET-DEALER
 14385     END-IF
 14386     .
 14387 1900-READNEXT-ERPYAJ-B.
 14388*  GET THE BANK ERPYAJ RECORD
 14389
 14390* EXEC CICS READNEXT
 14391*       DATASET    (FILE-ID-ERPYAJ)
 14392*       RIDFLD     (ERPYAJ-KEY)
 14393*       SET        (ADDRESS OF PENDING-PAY-ADJ)
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 261
* EL6311.cbl
 14394*       RESP       (WS-RESPONSE)
 14395*    END-EXEC
 14396     MOVE 0
 14397       TO DFHEIV11
 14398*    MOVE '&.S                   )  N#00013037' TO DFHEIV0
 14399     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 14400     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 14401     MOVE X'204E233030303133303337' TO DFHEIV0(25:11)
 14402     CALL 'kxdfhei1' USING DFHEIV0,
 14403           FILE-ID-ERPYAJ,
 14404           DFHEIV20,
 14405           DFHEIV99,
 14406           ERPYAJ-KEY,
 14407           DFHEIV99,
 14408           DFHEIV11,
 14409           DFHEIV99,
 14410           DFHEIV99
 14411     SET ADDRESS OF PENDING-PAY-ADJ TO
 14412         DFHEIV20
 14413     MOVE EIBRESP  TO WS-RESPONSE
 14414     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14415     IF RESP-NORMAL
 14416        IF PY-CONTROL-PRIMARY (1:28) = WS-SAVE-ERPYAJ-KEY (1:28)
 14417           IF (PB-I-DCC-OVER-CHG-AMT = PY-ENTRY-AMT)
 14418              IF (PY-INPUT-DT = WS-CURRENT-BIN-DT)
 14419                 AND (PY-LAST-MAINT-BY = PI-PROCESSOR-ID)
 14420
 14421* EXEC CICS READ
 14422*                   DATASET    (FILE-ID-ERPYAJ)
 14423*                   RIDFLD     (ERPYAJ-KEY)
 14424*                   SET        (ADDRESS OF PENDING-PAY-ADJ)
 14425*                   RESP       (WS-RESPONSE)
 14426*                   UPDATE
 14427*                END-EXEC
 14428*    MOVE '&"S        EU         (  N#00013048' TO DFHEIV0
 14429     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14430     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14431     MOVE X'204E233030303133303438' TO DFHEIV0(25:11)
 14432     CALL 'kxdfhei1' USING DFHEIV0,
 14433           FILE-ID-ERPYAJ,
 14434           DFHEIV20,
 14435           DFHEIV99,
 14436           ERPYAJ-KEY,
 14437           DFHEIV99,
 14438           DFHEIV99,
 14439           DFHEIV99
 14440     SET ADDRESS OF PENDING-PAY-ADJ TO
 14441         DFHEIV20
 14442     MOVE EIBRESP  TO WS-RESPONSE
 14443     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14444                 IF RESP-NORMAL
 14445
 14446* EXEC CICS DELETE
 14447*                      DATASET   (FILE-ID-ERPYAJ)
 14448*                      RESP      (WS-RESPONSE)
 14449*                   END-EXEC
 14450*    MOVE '&(                    &  N#00013056' TO DFHEIV0
 14451     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 262
* EL6311.cbl
 14452     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14453     MOVE X'204E233030303133303536' TO DFHEIV0(25:11)
 14454     CALL 'kxdfhei1' USING DFHEIV0,
 14455           FILE-ID-ERPYAJ,
 14456           DFHEIV99,
 14457           DFHEIV99,
 14458           DFHEIV99,
 14459           DFHEIV99
 14460     MOVE EIBRESP  TO WS-RESPONSE
 14461     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14462                 END-IF
 14463              ELSE
 14464                 SET REVERSAL    TO TRUE
 14465                 PERFORM 1600-UPDATE-ERPYAJ
 14466                                 THRU 1600-EXIT
 14467                 GO TO 1900-EXIT
 14468              END-IF
 14469           ELSE
 14470              GO TO 1900-READNEXT-ERPYAJ-B
 14471           END-IF
 14472        END-IF
 14473
 14474* EXEC CICS ENDBR
 14475*          DATASET   (FILE-ID-ERPYAJ)
 14476*       END-EXEC
 14477     MOVE 0
 14478       TO DFHEIV11
 14479*    MOVE '&2                    $   #00013071' TO DFHEIV0
 14480     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 14481     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14482     MOVE X'2020233030303133303731' TO DFHEIV0(25:11)
 14483     CALL 'kxdfhei1' USING DFHEIV0,
 14484           FILE-ID-ERPYAJ,
 14485           DFHEIV11,
 14486           DFHEIV99
 14487     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14488     END-IF
 14489     .
 14490 1900-GET-DEALER.
 14491     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 14492     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 14493     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 14494     MOVE PB-ACCOUNT             TO ERPYAJ-FIN-RESP
 14495     MOVE PB-ACCOUNT             TO ERPYAJ-ACCOUNT
 14496     MOVE +10                    TO ERPYAJ-SEQ-NO
 14497     MOVE 'C'                    TO ERPYAJ-TYPE
 14498     MOVE ERPYAJ-KEY             TO WS-SAVE-ERPYAJ-KEY
 14499
 14500* EXEC CICS STARTBR
 14501*       DATASET    (FILE-ID-ERPYAJ)
 14502*       RIDFLD     (ERPYAJ-KEY)
 14503*       RESP       (WS-RESPONSE)
 14504*    END-EXEC
 14505     MOVE 0
 14506       TO DFHEIV11
 14507*    MOVE '&,         G          &  N#00013085' TO DFHEIV0
 14508     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 14509     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 263
* EL6311.cbl
 14510     MOVE X'204E233030303133303835' TO DFHEIV0(25:11)
 14511     CALL 'kxdfhei1' USING DFHEIV0,
 14512           FILE-ID-ERPYAJ,
 14513           ERPYAJ-KEY,
 14514           DFHEIV99,
 14515           DFHEIV11,
 14516           DFHEIV99
 14517     MOVE EIBRESP  TO WS-RESPONSE
 14518     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14519     IF RESP-NORMAL
 14520        CONTINUE
 14521     ELSE
 14522        GO TO 1900-EXIT
 14523     END-IF
 14524     .
 14525 1900-READNEXT-ERPYAJ-D.
 14526*  GET THE DEALER ERPYAJ RECORD
 14527
 14528* EXEC CICS READNEXT
 14529*       DATASET    (FILE-ID-ERPYAJ)
 14530*       RIDFLD     (ERPYAJ-KEY)
 14531*       SET        (ADDRESS OF PENDING-PAY-ADJ)
 14532*       RESP       (WS-RESPONSE)
 14533*    END-EXEC
 14534     MOVE 0
 14535       TO DFHEIV11
 14536*    MOVE '&.S                   )  N#00013098' TO DFHEIV0
 14537     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 14538     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 14539     MOVE X'204E233030303133303938' TO DFHEIV0(25:11)
 14540     CALL 'kxdfhei1' USING DFHEIV0,
 14541           FILE-ID-ERPYAJ,
 14542           DFHEIV20,
 14543           DFHEIV99,
 14544           ERPYAJ-KEY,
 14545           DFHEIV99,
 14546           DFHEIV11,
 14547           DFHEIV99,
 14548           DFHEIV99
 14549     SET ADDRESS OF PENDING-PAY-ADJ TO
 14550         DFHEIV20
 14551     MOVE EIBRESP  TO WS-RESPONSE
 14552     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14553     IF RESP-NORMAL
 14554        IF PY-CONTROL-PRIMARY (1:28) = WS-SAVE-ERPYAJ-KEY (1:28)
 14555           IF (PB-I-DCC-OVER-CHG-AMT = PY-ENTRY-AMT)
 14556              IF (PY-INPUT-DT = WS-CURRENT-BIN-DT)
 14557                 AND (PY-LAST-MAINT-BY = PI-PROCESSOR-ID)
 14558
 14559* EXEC CICS READ
 14560*                   DATASET    (FILE-ID-ERPYAJ)
 14561*                   RIDFLD     (ERPYAJ-KEY)
 14562*                   SET        (ADDRESS OF PENDING-PAY-ADJ)
 14563*                   RESP       (WS-RESPONSE)
 14564*                   UPDATE
 14565*                END-EXEC
 14566*    MOVE '&"S        EU         (  N#00013109' TO DFHEIV0
 14567     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 264
* EL6311.cbl
 14568     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14569     MOVE X'204E233030303133313039' TO DFHEIV0(25:11)
 14570     CALL 'kxdfhei1' USING DFHEIV0,
 14571           FILE-ID-ERPYAJ,
 14572           DFHEIV20,
 14573           DFHEIV99,
 14574           ERPYAJ-KEY,
 14575           DFHEIV99,
 14576           DFHEIV99,
 14577           DFHEIV99
 14578     SET ADDRESS OF PENDING-PAY-ADJ TO
 14579         DFHEIV20
 14580     MOVE EIBRESP  TO WS-RESPONSE
 14581     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14582                 IF RESP-NORMAL
 14583
 14584* EXEC CICS DELETE
 14585*                      DATASET   (FILE-ID-ERPYAJ)
 14586*                      RESP      (WS-RESPONSE)
 14587*                   END-EXEC
 14588*    MOVE '&(                    &  N#00013117' TO DFHEIV0
 14589     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 14590     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14591     MOVE X'204E233030303133313137' TO DFHEIV0(25:11)
 14592     CALL 'kxdfhei1' USING DFHEIV0,
 14593           FILE-ID-ERPYAJ,
 14594           DFHEIV99,
 14595           DFHEIV99,
 14596           DFHEIV99,
 14597           DFHEIV99
 14598     MOVE EIBRESP  TO WS-RESPONSE
 14599     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14600                 END-IF
 14601              ELSE
 14602                 SET REVERSAL    TO TRUE
 14603              END-IF
 14604           ELSE
 14605              GO TO 1900-READNEXT-ERPYAJ-D
 14606           END-IF
 14607        END-IF
 14608
 14609* EXEC CICS ENDBR
 14610*          DATASET   (FILE-ID-ERPYAJ)
 14611*       END-EXEC
 14612     MOVE 0
 14613       TO DFHEIV11
 14614*    MOVE '&2                    $   #00013129' TO DFHEIV0
 14615     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 14616     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14617     MOVE X'2020233030303133313239' TO DFHEIV0(25:11)
 14618     CALL 'kxdfhei1' USING DFHEIV0,
 14619           FILE-ID-ERPYAJ,
 14620           DFHEIV11,
 14621           DFHEIV99
 14622     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14623     END-IF
 14624     .
 14625 1900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 265
* EL6311.cbl
 14626     EXIT.
 14627******************************************************************
 14628*            C A N C E L   M A I N L I N E                       *
 14629******************************************************************
 14630
 14631 2000-CANCEL-MAINLINE.
 14632     IF PI-DISPLAY-ORIGINAL-BATCH
 14633        IF CMAINTI NOT = 'C' AND 'D' AND 'S' AND 'K'
 14634           MOVE ER-0023             TO EMI-ERROR
 14635           MOVE -1                  TO CMAINTL
 14636           MOVE AL-UABON            TO CMAINTA
 14637           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14638           GO TO 8200-SEND-DATAONLY
 14639        ELSE
 14640           NEXT SENTENCE
 14641     ELSE
 14642        IF CMAINTI NOT = 'A' AND 'C' AND 'D' AND 'S' AND 'K'
 14643           MOVE ER-0023             TO EMI-ERROR
 14644           MOVE -1                  TO CMAINTL
 14645           MOVE AL-UABON            TO CMAINTA
 14646           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14647           GO TO 8200-SEND-DATAONLY.
 14648
 14649     IF CMAINTI = 'S'
 14650        GO TO 2100-SHOW-REQUEST.
 14651
 14652     IF NOT MODIFY-CAP
 14653         MOVE 'UPDATE'       TO SM-READ
 14654         PERFORM 9995-SECURITY-VIOLATION
 14655         MOVE ER-0070        TO EMI-ERROR
 14656         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14657         GO TO 8100-SEND-INITIAL-MAP.
 14658
 14659     IF CMAINTL GREATER THAN ZEROS
 14660        IF PI-PF6-FUNCTION
 14661           IF CMAINTI NOT = 'A'
 14662              MOVE AL-UABON  TO CMAINTA
 14663              MOVE -1        TO CMAINTL
 14664              MOVE ER-2260   TO EMI-ERROR
 14665              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14666              GO TO 8200-SEND-DATAONLY.
 14667
 14668     IF CCERTNOL = ZEROS
 14669       AND (CMAINTI = 'C' OR 'K' OR 'D')
 14670         NEXT SENTENCE
 14671     ELSE
 14672         IF CCERTNOL NOT = ZEROS
 14673             MOVE AL-UANON       TO CCERTNOA
 14674         ELSE
 14675             MOVE -1             TO CCERTNOL
 14676             MOVE  1             TO SET-CURSOR-SW
 14677             MOVE ER-2218       TO EMI-ERROR
 14678             MOVE AL-UABON       TO CCERTNOA
 14679             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14680
 14681     IF CEFFDTL = ZEROS AND (CMAINTI = 'C' OR 'K' OR 'D')
 14682        NEXT SENTENCE
 14683     ELSE
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 266
* EL6311.cbl
 14684        IF CEFFDTL NOT = ZEROS
 14685           MOVE AL-UNNON         TO CEFFDTA
 14686           MOVE CEFFDTI TO DEEDIT-FIELD
 14687           PERFORM 8600-DEEDIT
 14688           MOVE 4                TO DC-OPTION-CODE
 14689           MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 14690           PERFORM 9700-DATE-LINK
 14691           IF NO-CONVERSION-ERROR
 14692              MOVE DC-BIN-DATE-1 TO WS-CONVERTED-EFFDT
 14693              ELSE
 14694              MOVE -1            TO CEFFDTL
 14695              MOVE  1            TO SET-CURSOR-SW
 14696              MOVE ER-2226      TO EMI-ERROR
 14697              MOVE AL-UNBON      TO CEFFDTA
 14698              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14699          ELSE
 14700          MOVE -1                 TO CEFFDTL
 14701          MOVE  1                 TO SET-CURSOR-SW
 14702          MOVE ER-2220            TO EMI-ERROR
 14703          MOVE AL-UNBON           TO CEFFDTA
 14704          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14705
 14706     MOVE PI-PREV-ALT-KEY            TO WS-ERPNDB-ALT-KEY.
 14707
 14708     IF CCERTNOL NOT = ZEROS
 14709        MOVE CCERTNOI                TO WS-NEW-PRIME
 14710     ELSE
 14711        MOVE SPACES                  TO WS-NEW-PRIME.
 14712
 14713     IF CSUFIXL NOT = ZEROS
 14714        MOVE CSUFIXI                 TO WS-NEW-SUFFIX
 14715     ELSE
 14716        MOVE SPACE                   TO WS-NEW-SUFFIX.
 14717
 14718     IF CEFFDTL NOT = ZEROS
 14719        MOVE WS-CONVERTED-EFFDT      TO WS-NEW-CERT-EFF-DT
 14720     ELSE
 14721        MOVE LOW-VALUES              TO WS-NEW-CERT-EFF-DT.
 14722
 14723     IF CMAINTI = 'A' OR 'K' OR 'S'
 14724        NEXT SENTENCE
 14725     ELSE
 14726        MOVE PI-PREV-ALT-KEY     TO WS-ERPNDB-ALT-KEY
 14727        IF WS-PB-CERT-NO     NOT = WS-NEW-CERT-NO     OR
 14728           WS-PB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT OR
 14729           WS-PB-RECORD-TYPE NOT = '2'
 14730           IF CMAINTI = 'C'
 14731              MOVE ER-2287          TO EMI-ERROR
 14732              MOVE -1               TO CCERTNOL
 14733              MOVE AL-UABON         TO CCERTNOA CEFFDTA
 14734              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14735              GO TO 8200-SEND-DATAONLY
 14736             ELSE
 14737              MOVE ER-2260          TO EMI-ERROR
 14738              MOVE -1               TO CCERTNOL
 14739              MOVE AL-UABON         TO CCERTNOA
 14740              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14741              GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 267
* EL6311.cbl
 14742
 14743     IF CMAINTI = 'D'
 14744        GO TO 2400-DELETE-CANCEL-ROUTINE.
 14745
 14746     IF CLSTNML GREATER THAN ZEROS
 14747         MOVE AL-UANON           TO CLSTNMA.
 14748
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 268
* EL6311.cbl
 14750
 14751******************************************************************
 14752*                                                                *
 14753*           E D I T   C A N C E L   C O V E R A G E S            *
 14754*                                                                *
 14755******************************************************************
 14756
 14757 2015-EDIT-COVERAGES.
 14758     IF CCANDT1L      GREATER THAN ZEROS OR
 14759        CREFND1L      GREATER THAN ZEROS OR
 14760        CCANDT2L      GREATER THAN ZEROS OR
 14761        CREFND2L      GREATER THAN ZEROS OR
 14762        CMTHD1L       GREATER THAN ZEROS OR
 14763        CMTHD2L       GREATER THAN ZEROS OR
 14764        CLIVESL       GREATER THAN ZEROS OR
 14765        CPAYEEL       GREATER THAN ZEROS OR
 14766        CFORCEL       GREATER THAN ZEROS OR
 14767        CBILCDL       GREATER THAN ZEROS OR
 14768        CCANREAL      GREATER THAN ZEROS
 14769            NEXT SENTENCE
 14770         ELSE
 14771            GO TO 2030-EDIT-COMPLETE.
 14772
 14773     IF CCANDT1L = ZEROS
 14774        AND (CMAINTI = 'C' OR 'K')
 14775        NEXT SENTENCE
 14776     ELSE
 14777        IF CCANDT1L      GREATER THAN ZEROS
 14778            MOVE AL-UNNON            TO CCANDT1A
 14779            IF CCANDT1I = SPACES
 14780               MOVE LOW-VALUES       TO WS-CONVERTED-CANDT1
 14781            ELSE
 14782               MOVE CCANDT1I            TO DEEDIT-FIELD
 14783               PERFORM 8600-DEEDIT
 14784               IF DEEDIT-FIELD-V0   NUMERIC
 14785                  MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 14786                  MOVE 4                TO DC-OPTION-CODE
 14787                  PERFORM 9700-DATE-LINK
 14788                  IF NO-CONVERSION-ERROR
 14789                     MOVE DC-BIN-DATE-1    TO WS-CONVERTED-CANDT1
 14790                  ELSE
 14791                      MOVE -1        TO CCANDT1L
 14792                      MOVE ER-2227   TO EMI-ERROR
 14793                      MOVE AL-UNBON  TO CCANDT1A
 14794                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14795               ELSE
 14796                  MOVE -1         TO CCANDT1L
 14797                  MOVE ER-2223    TO EMI-ERROR
 14798                  MOVE AL-UNBON   TO CCANDT1A
 14799                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14800        ELSE
 14801            IF CREFND1L GREATER THAN ZEROS
 14802               MOVE -1             TO CCANDT1L
 14803               MOVE ER-2222        TO EMI-ERROR
 14804               MOVE AL-UNBOF       TO CCANDT1A
 14805               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14806
 14807     IF CREFND1L = ZEROS
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 269
* EL6311.cbl
 14808        AND (CMAINTI = 'C' OR 'K')
 14809         NEXT SENTENCE
 14810     ELSE
 14811         IF CREFND1L NOT = ZEROS
 14812            MOVE AL-UNNON        TO CREFND1A
 14813
 14814* EXEC CICS BIF DEEDIT
 14815*               FIELD  (CREFND1I)
 14816*               LENGTH (11)
 14817*           END-EXEC
 14818     MOVE 11
 14819       TO DFHEIV11
 14820*    MOVE '@"L                   #   #00013322' TO DFHEIV0
 14821     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 14822     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14823     MOVE X'2020233030303133333232' TO DFHEIV0(25:11)
 14824     CALL 'kxdfhei1' USING DFHEIV0,
 14825           CREFND1I,
 14826           DFHEIV11
 14827     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14828            MOVE CREFND1I        TO WS-CREFND1
 14829*           MOVE CREFND1I        TO DEEDIT-FIELD-X11
 14830*           PERFORM 8600-DEEDIT
 14831*           MOVE DEEDIT-FIELD-V2 TO WS-CREFND1
 14832            IF WS-CREFND1  = ZEROS
 14833               AND CMAINTI = 'A'
 14834             MOVE ER-2437        TO EMI-ERROR
 14835             MOVE -1             TO CREFND1L
 14836             MOVE AL-UNBON       TO CREFND1A
 14837             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14838
 14839     IF CCANREAL > +0
 14840        MOVE AL-UANON            TO CCANREAA
 14841        IF CCANREAI = 'R' OR ' '
 14842           CONTINUE
 14843        ELSE
 14844           MOVE ER-9841        TO EMI-ERROR
 14845           MOVE -1             TO CCANREAL
 14846           MOVE AL-UABON       TO CCANREAA
 14847           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14848        END-IF
 14849     END-IF
 14850     IF CMTHD1L EQUAL +0
 14851        NEXT SENTENCE
 14852     ELSE
 14853        IF CMTHD1L NOT = +0
 14854           MOVE AL-UNNON        TO CMTHD1A
 14855           IF CMTHD1I EQUAL '1' OR '2' OR '3' OR '4'
 14856                         OR '5' OR '6' OR '8' OR '9'
 14857                         OR 'R' OR ' '
 14858              NEXT SENTENCE
 14859           ELSE
 14860              MOVE ER-0582        TO EMI-ERROR
 14861              MOVE -1             TO CMTHD1L
 14862              MOVE AL-UNBON       TO CMTHD1A
 14863              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14864
 14865     IF CCANDT2L = ZEROS
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 270
* EL6311.cbl
 14866        AND (CMAINTI = 'C' OR 'K')
 14867         NEXT SENTENCE
 14868     ELSE
 14869         IF CCANDT2L  GREATER THAN ZEROS
 14870             MOVE AL-UNNON       TO CCANDT2A
 14871             IF CCANDT2I = SPACES
 14872                MOVE LOW-VALUES  TO WS-CONVERTED-CANDT2
 14873             ELSE
 14874                MOVE CCANDT2I       TO DEEDIT-FIELD
 14875                PERFORM 8600-DEEDIT
 14876                IF DEEDIT-FIELD-V0   NUMERIC
 14877                   MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 14878                   MOVE 4                TO DC-OPTION-CODE
 14879                   PERFORM 9700-DATE-LINK
 14880                   IF NO-CONVERSION-ERROR
 14881                      MOVE DC-BIN-DATE-1    TO WS-CONVERTED-CANDT2
 14882                   ELSE
 14883                      MOVE -1       TO CCANDT2L
 14884                      MOVE ER-2227  TO EMI-ERROR
 14885                      MOVE AL-UNBON TO CCANDT2A
 14886                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14887                ELSE
 14888                   MOVE -1         TO CCANDT2L
 14889                   MOVE ER-2223    TO EMI-ERROR
 14890                   MOVE AL-UNBON   TO CCANDT2A
 14891                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14892         ELSE
 14893            IF CREFND2L GREATER THAN ZEROS
 14894               MOVE -1             TO CCANDT2L
 14895               MOVE ER-2222        TO EMI-ERROR
 14896               MOVE AL-UNBOF       TO CCANDT2A
 14897               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14898
 14899     IF CREFND2L = ZEROS
 14900        AND (CMAINTI = 'C' OR 'K')
 14901         NEXT SENTENCE
 14902     ELSE
 14903         IF CREFND2L NOT = ZEROS
 14904            MOVE AL-UNNON        TO CREFND2A
 14905
 14906* EXEC CICS BIF DEEDIT
 14907*               FIELD  (CREFND2I)
 14908*               LENGTH (11)
 14909*           END-EXEC
 14910     MOVE 11
 14911       TO DFHEIV11
 14912*    MOVE '@"L                   #   #00013403' TO DFHEIV0
 14913     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 14914     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14915     MOVE X'2020233030303133343033' TO DFHEIV0(25:11)
 14916     CALL 'kxdfhei1' USING DFHEIV0,
 14917           CREFND2I,
 14918           DFHEIV11
 14919     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14920            MOVE CREFND2I        TO WS-CREFND2
 14921*           MOVE CREFND2I        TO DEEDIT-FIELD-X11
 14922*           PERFORM 8600-DEEDIT
 14923*           MOVE DEEDIT-FIELD-V2 TO WS-CREFND2
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 271
* EL6311.cbl
 14924            IF WS-CREFND2  = ZEROS
 14925               AND CMAINTI = 'A'
 14926             MOVE ER-2437        TO EMI-ERROR
 14927             MOVE -1             TO CREFND2L
 14928             MOVE AL-UNBON       TO CREFND2A
 14929             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14930
 14931     IF CMTHD2L EQUAL +0
 14932        NEXT SENTENCE
 14933     ELSE
 14934        IF CMTHD2L NOT = +0
 14935           MOVE AL-UNNON        TO CMTHD2A
 14936           IF CMTHD2I EQUAL '1' OR '2' OR '3' OR '4'
 14937                         OR '5' OR '6' OR '8' OR '9'
 14938                         OR ' ' OR 'R'
 14939              NEXT SENTENCE
 14940           ELSE
 14941              MOVE ER-0582        TO EMI-ERROR
 14942              MOVE -1             TO CMTHD2L
 14943              MOVE AL-UNBON       TO CMTHD2A
 14944              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14945
 14946     IF CLIVESL GREATER THAN ZEROS
 14947         MOVE CLIVESI            TO DEEDIT-FIELD
 14948         PERFORM 8600-DEEDIT
 14949         IF DEEDIT-FIELD-V0 NUMERIC
 14950             MOVE DEEDIT-FIELD-V0 TO WS-CLIVES
 14951             MOVE AL-UNNON       TO CLIVESA
 14952         ELSE
 14953             MOVE -1             TO CLIVESL
 14954             MOVE AL-UNBON       TO CLIVESA
 14955             MOVE ER-2223        TO EMI-ERROR
 14956             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14957
 14958     IF CFORCEL  NOT = ZEROS
 14959         IF FORCE-CAP
 14960            MOVE AL-UANON            TO CFORCEA
 14961         ELSE
 14962            MOVE ER-2945             TO EMI-ERROR
 14963            MOVE AL-UABON            TO CFORCEA
 14964            MOVE -1                  TO CFORCEL
 14965            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14966
 14967     IF CPAYEEL GREATER THAN ZEROS
 14968        MOVE AL-UANON            TO CPAYEEA.
 14969
 14970     IF CBILCDL NOT = ZEROS
 14971        IF CBILCDI NOT = ' ' AND 'H' AND 'R' AND 'L'
 14972                             AND 'A' AND 'B' AND 'E'
 14973           MOVE ER-2225              TO EMI-ERROR
 14974           MOVE AL-UABON             TO CBILCDA
 14975           MOVE -1                   TO CBILCDL
 14976           MOVE  1                   TO SET-CURSOR-SW
 14977           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14978        ELSE
 14979           MOVE AL-UANON             TO CBILCDA.
 14980
 14981 2030-EDIT-COMPLETE.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 272
* EL6311.cbl
 14982     IF EMI-ERROR = ZEROS
 14983         NEXT SENTENCE
 14984     ELSE
 14985         GO TO 8200-SEND-DATAONLY.
 14986
 14987     IF CMAINTI = 'A'
 14988        GO TO 2200-ADD-CANCEL-ROUTINE.
 14989
 14990     IF CMAINTI = 'C'
 14991        GO TO 2300-CHANGE-CANCEL-ROUTINE.
 14992
 14993     GO TO 2900-REWRITE-CAN-CERT-KEY.
 14994
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 273
* EL6311.cbl
 14996
 14997******************************************************************
 14998*                                                                *
 14999*                   S H O W   C A N C E L                        *
 15000*                                                                *
 15001******************************************************************
 15002
 15003 2100-SHOW-REQUEST.
 15004     MOVE 'S'                    TO PI-MAINT-FUNCTION.
 15005
 15006     IF CCERTNOL = ZEROS AND CEFFDTL = ZEROS
 15007        MOVE -1                  TO CMAINTL
 15008        GO TO 8200-SEND-DATAONLY.
 15009
 15010     MOVE CCERTNOI            TO WS-NEW-PRIME.
 15011
 15012     IF CSUFIXL NOT = ZEROS
 15013        MOVE CSUFIXI          TO WS-NEW-SUFFIX
 15014       ELSE
 15015        MOVE SPACE            TO WS-NEW-SUFFIX.
 15016
 15017     MOVE CEFFDTI                TO DEEDIT-FIELD.
 15018     PERFORM 8600-DEEDIT.
 15019     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 15020     MOVE '4'                    TO DC-OPTION-CODE.
 15021     PERFORM 9700-DATE-LINK.
 15022     IF DATE-CONVERSION-ERROR
 15023        MOVE ER-0348             TO EMI-ERROR
 15024        MOVE -1                  TO CEFFDTL
 15025        MOVE AL-UABON            TO CEFFDTA
 15026        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15027        GO TO 8200-SEND-DATAONLY
 15028     ELSE
 15029        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 15030        MOVE AL-UANON            TO CEFFDTA
 15031        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 15032
 15033     MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
 15034
 15035     IF (ERPNDB-CERT-NO     NOT = WS-NEW-CERT-NO)      OR
 15036        (ERPNDB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT)
 15037        MOVE 'Y'                    TO WS-SHOW-SW
 15038        IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
 15039           GO TO 4100-BROWSE-PRIMARY-FORWARD
 15040        ELSE
 15041           IF PI-FILE-BROWSE
 15042              GO TO 4300-BROWSE-FILE-FORWARD
 15043           ELSE
 15044              IF PI-CSR-BROWSE
 15045                 GO TO 4200-BROWSE-CSR-FORWARD
 15046              ELSE
 15047                 GO TO 4000-BROWSE-DETAIL-FORWARD
 15048     ELSE
 15049        GO TO 3900-RE-DISPLAY-RECORD.
 15050
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 274
* EL6311.cbl
 15052
 15053
 15054******************************************************************
 15055*                                                                *
 15056*            A D D   C A N C E L   R O U T I N E                 *
 15057*                                                                *
 15058******************************************************************
 15059
 15060 2200-ADD-CANCEL-ROUTINE.
 15061     MOVE 'A'                    TO PI-MAINT-FUNCTION.
 15062
 15063
 15064* EXEC CICS GETMAIN
 15065*        SET     (ADDRESS OF PENDING-BUSINESS)
 15066*        LENGTH  (ERPNDB-RECORD-LENGTH)
 15067*    END-EXEC.
 15068*    MOVE '," L                  $   #00013550' TO DFHEIV0
 15069     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 15070     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15071     MOVE X'2020233030303133353530' TO DFHEIV0(25:11)
 15072     CALL 'kxdfhei1' USING DFHEIV0,
 15073           DFHEIV20,
 15074           ERPNDB-RECORD-LENGTH,
 15075           DFHEIV99
 15076     SET ADDRESS OF PENDING-BUSINESS TO
 15077         DFHEIV20
 15078     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15079
 15080
 15081
 15082* EXEC CICS HANDLE CONDITION
 15083*         NOTFND    (2280-BATCH-HDR-NOT-FOUND)
 15084*    END-EXEC.
 15085*    MOVE '"$I                   ! 3 #00013555' TO DFHEIV0
 15086     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15087     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15088     MOVE X'3320233030303133353535' TO DFHEIV0(25:11)
 15089     CALL 'kxdfhei1' USING DFHEIV0
 15090     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15091
 15092
 15093     MOVE PI-PREV-KEY            TO ERPNDB-KEY
 15094     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 15095     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 15096
 15097
 15098* EXEC CICS READ
 15099*        INTO    (PENDING-BUSINESS)
 15100*        DATASET (FILE-ID-ERPNDB)
 15101*        RIDFLD  (ERPNDB-KEY)
 15102*    END-EXEC.
 15103     MOVE LENGTH OF
 15104      PENDING-BUSINESS
 15105       TO DFHEIV11
 15106*    MOVE '&"IL       E          (   #00013563' TO DFHEIV0
 15107     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15108     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15109     MOVE X'2020233030303133353633' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 275
* EL6311.cbl
 15110     CALL 'kxdfhei1' USING DFHEIV0,
 15111           FILE-ID-ERPNDB,
 15112           PENDING-BUSINESS,
 15113           DFHEIV11,
 15114           ERPNDB-KEY,
 15115           DFHEIV99,
 15116           DFHEIV99,
 15117           DFHEIV99
 15118     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15119
 15120
 15121     MOVE PB-CSR-ID              TO WS-BATCH-CSR-ID.
 15122
 15123     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 15124     ADD +1                      TO WS-B-HIGHEST-SEQ-NO.
 15125     MOVE PB-CREDIT-SELECT-DT    TO WS-CREDIT-SELECT-DT.
 15126     MOVE SPACES                 TO PENDING-BUSINESS.
 15127     MOVE 'PB'                   TO PB-RECORD-ID.
 15128     MOVE PI-PREV-KEY            TO PB-CONTROL-PRIMARY.
 15129     MOVE PI-PREV-ALT-KEY        TO PB-CONTROL-BY-ACCOUNT.
 15130     MOVE SPACES                 TO PB-CERT-SFX.
 15131     MOVE WS-B-HIGHEST-SEQ-NO    TO PB-BATCH-SEQ-NO.
 15132     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
 15133                                    PB-ALT-CHG-SEQ-NO.
 15134
 15135     MOVE WS-CONVERTED-EFFDT     TO PB-CERT-EFF-DT.
 15136     MOVE CCERTNOI               TO PB-CERT-PRIME.
 15137     MOVE '2'                    TO PB-RECORD-TYPE.
 15138
 15139     MOVE PI-COMPANY-CD          TO PB-COMPANY-CD.
 15140     MOVE PI-COMPANY-ID          TO PB-COMPANY-ID.
 15141
 15142
 15143     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
 15144                                    PB-ALT-CHG-SEQ-NO
 15145                                    PB-C-LF-REF-CALC
 15146                                    PB-C-AH-REF-CALC
 15147                                    PB-C-LF-RFND-CLP
 15148                                    PB-C-AH-RFND-CLP
 15149                                    PB-CI-INSURED-AGE
 15150                                    PB-CI-LF-TERM
 15151                                    PB-CI-AH-TERM
 15152                                    PB-CI-LF-BENEFIT-CD
 15153                                    PB-CI-LF-BENEFIT-AMT
 15154                                    PB-CI-LF-ALT-BENEFIT-AMT
 15155                                    PB-CI-LF-PREMIUM-AMT
 15156                                    PB-CI-LF-ALT-PREMIUM-AMT
 15157                                    PB-CI-AH-BENEFIT-CD
 15158                                    PB-CI-AH-BENEFIT-AMT
 15159                                    PB-CI-AH-PREMIUM-AMT
 15160                                    PB-CI-PAY-FREQUENCY
 15161                                    PB-CI-LOAN-APR
 15162                                    PB-CI-LOAN-TERM
 15163                                    PB-CI-LIFE-COMMISSION
 15164                                    PB-CI-AH-COMMISSION
 15165                                    PB-CI-CURR-SEQ
 15166                                    PB-CI-AH-CANCEL-AMT
 15167                                    PB-CI-LF-CANCEL-AMT
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 276
* EL6311.cbl
 15168                                    PB-CI-RATE-DEV-PCT-LF
 15169                                    PB-CI-RATE-DEV-PCT-AH
 15170                                    PB-CI-EXTENTION-DAYS
 15171                                    PB-CI-TERM-IN-DAYS
 15172                                    PB-CI-LIVES
 15173                                    PB-CI-LF-CRIT-PER
 15174                                    PB-CI-AH-CRIT-PER
 15175                                    PB-C-LF-REM-TERM
 15176                                    PB-C-AH-REM-TERM
 15177                                    PB-CHG-COUNT
 15178                                    PB-LF-BILLED-AMTS
 15179                                    PB-AH-BILLED-AMTS
 15180                                    PB-C-INT-ON-REFS
 15181*                                   PB-C-MICROFILM-NO
 15182                                    PB-CALC-TOLERANCE.
 15183
 15184     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
 15185                                    PB-CI-AH-SETTLEMENT-DT
 15186                                    PB-CI-DEATH-DT
 15187                                    PB-CI-LF-PRIOR-CANCEL-DT
 15188                                    PB-CI-AH-PRIOR-CANCEL-DT
 15189                                    PB-CI-ENTRY-DT
 15190                                    PB-CI-LF-EXPIRE-DT
 15191                                    PB-CI-AH-EXPIRE-DT
 15192                                    PB-CI-LOAN-1ST-PMT-DT
 15193                                    PB-C-LF-CANCEL-DT
 15194                                    PB-C-AH-CANCEL-DT
 15195                                    PB-CREDIT-ACCEPT-DT
 15196                                    PB-BILLED-DT
 15197                                    PB-ACCT-EFF-DT
 15198                                    PB-ACCT-EXP-DT.
 15199
 15200     MOVE 'X'                    TO PB-FATAL-FLAG.
 15201
 15202     MOVE WS-CREDIT-SELECT-DT    TO PB-CREDIT-SELECT-DT.
 15203
 15204     IF CSUFIXL     GREATER THAN ZEROS
 15205        MOVE CSUFIXI             TO PB-CERT-SFX.
 15206
 15207*    IF CMICRNOL  GREATER  ZEROS
 15208*        IF CMICRNOI  NUMERIC
 15209*            MOVE CMICRNOI       TO  PB-C-MICROFILM-NO
 15210*            MOVE AL-UNNON       TO  CMICRNOA
 15211*        ELSE
 15212*            MOVE -1             TO  CMICRNOL
 15213*            MOVE AL-UNBON       TO  CMICRNOA
 15214*            MOVE ER-2701        TO  EMI-ERROR
 15215*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15216
 15217     IF CLSTNML     GREATER THAN ZEROS
 15218        MOVE CLSTNMI             TO PB-C-LAST-NAME.
 15219
 15220     IF CCANREAL > ZEROS
 15221        MOVE CCANREAI            TO PB-C-CANCEL-REASON
 15222     END-IF
 15223     IF CCANDT1L    GREATER THAN ZEROS
 15224        MOVE WS-CONVERTED-CANDT1 TO PB-C-LF-CANCEL-DT.
 15225
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 277
* EL6311.cbl
 15226     IF CCANDT2L    GREATER THAN ZEROS
 15227        MOVE WS-CONVERTED-CANDT2 TO PB-C-AH-CANCEL-DT.
 15228
 15229     IF CMTHD1L    GREATER THAN +0
 15230        MOVE CMTHD1I             TO PB-C-LF-REFUND-OVERRIDE.
 15231
 15232     IF CMTHD2L    GREATER THAN +0
 15233        MOVE CMTHD2I             TO PB-C-AH-REFUND-OVERRIDE.
 15234
 15235     IF CREFND1L    GREATER THAN ZEROS
 15236        ADD  WS-CREFND1          TO WS-B-LF-CAN-PRM-ENTERED
 15237        MOVE WS-CREFND1          TO PB-C-LF-CANCEL-AMT
 15238     ELSE
 15239        MOVE ZEROS               TO PB-C-LF-CANCEL-AMT.
 15240
 15241     IF CREFND2L    GREATER THAN ZEROS
 15242        ADD  WS-CREFND2          TO WS-B-AH-CAN-PRM-ENTERED
 15243        MOVE WS-CREFND2          TO PB-C-AH-CANCEL-AMT
 15244     ELSE
 15245        MOVE ZEROS               TO PB-C-AH-CANCEL-AMT.
 15246
 15247     IF CLIVESL     GREATER THAN ZEROS
 15248        MOVE WS-CLIVES           TO PB-C-LIVES
 15249     ELSE
 15250        MOVE ZEROS               TO PB-C-LIVES.
 15251
 15252     IF CPAYEEL     GREATER THAN ZEROS
 15253        MOVE CPAYEEI             TO PB-C-PAYEE-CODE.
 15254
 15255     IF CFORCEL     GREATER THAN ZEROS
 15256        MOVE CFORCEI             TO PB-FORCE-CODE.
 15257
 15258     IF CBILCDL     GREATER THAN ZEROS
 15259        MOVE CBILCDI             TO PB-RECORD-BILL.
 15260
 15261*    MOVE WS-REFERENCE           TO PB-C-REFERENCE.
 15262
 15263 2260-WRITE-PB-RECORD.
 15264     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY
 15265                                    PB-INPUT-BY.
 15266     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 15267     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT
 15268                                    PB-INPUT-DT.
 15269
 15270     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 15271     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 15272                                    PB-CONTROL-BY-ORIG-BATCH.
 15273
 15274     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 15275     MOVE WS-BATCH-CSR-ID        TO PB-CSR-ID.
 15276     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 15277     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 15278     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 15279
 15280     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 15281
 15282     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 15283
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 278
* EL6311.cbl
 15284     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 15285     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 15286     MOVE PB-SV-STATE            TO PI-SV-STATE.
 15287
 15288     ADD PB-C-LF-REF-CALC        TO WS-B-LF-CAN-PRM-COMPUTED.
 15289     ADD PB-C-AH-REF-CALC        TO WS-B-AH-CAN-PRM-COMPUTED.
 15290
 15291 2275-WRITE-PENDING-BUSINESS.
 15292     MOVE 'A'                    TO JP-RECORD-TYPE.
 15293     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15294     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15295     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15296
 15297
 15298* EXEC CICS HANDLE CONDITION
 15299*        DUPREC (2290-DUPLICATE-ALT-INDEX)
 15300*    END-EXEC.
 15301*    MOVE '"$%                   ! 4 #00013745' TO DFHEIV0
 15302     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 15303     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15304     MOVE X'3420233030303133373435' TO DFHEIV0(25:11)
 15305     CALL 'kxdfhei1' USING DFHEIV0
 15306     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15307
 15308
 15309
 15310* EXEC CICS WRITE
 15311*        DATASET (FILE-ID-ERPNDB)
 15312*        FROM    (PENDING-BUSINESS)
 15313*        RIDFLD  (PB-CONTROL-PRIMARY)
 15314*    END-EXEC.
 15315     MOVE LENGTH OF
 15316      PENDING-BUSINESS
 15317       TO DFHEIV11
 15318*    MOVE '&$ L                  ''   #00013749' TO DFHEIV0
 15319     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15320     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15321     MOVE X'2020233030303133373439' TO DFHEIV0(25:11)
 15322     CALL 'kxdfhei1' USING DFHEIV0,
 15323           FILE-ID-ERPNDB,
 15324           PENDING-BUSINESS,
 15325           DFHEIV11,
 15326           PB-CONTROL-PRIMARY,
 15327           DFHEIV99,
 15328           DFHEIV99
 15329     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15330
 15331
 15332     ADD +1                      TO WS-B-CANCEL-CNT-ENTERED.
 15333
 15334     PERFORM 8400-LOG-JOURNAL-RECORD  *> Journal Cancel Add
 15335
 15336******************************************************************
 15337*       A D D  O R I G I N A L  C E R T  I N F O                 *
 15338******************************************************************
 15339
 15340     display ' made it to add orig CANCEL cert '
 15341     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 279
* EL6311.cbl
 15342     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 15343     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 15344     MOVE PB-SV-STATE            TO ELCERT-STATE.
 15345
 15346
 15347* EXEC CICS READ
 15348*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 15349*        DATASET (FILE-ID-ELCERT)
 15350*        RIDFLD  (ELCERT-KEY)
 15351*        RESP    (WS-RESPONSE)
 15352*    END-EXEC.
 15353*    MOVE '&"S        E          (  N#00013769' TO DFHEIV0
 15354     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15355     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15356     MOVE X'204E233030303133373639' TO DFHEIV0(25:11)
 15357     CALL 'kxdfhei1' USING DFHEIV0,
 15358           FILE-ID-ELCERT,
 15359           DFHEIV20,
 15360           DFHEIV99,
 15361           ELCERT-KEY,
 15362           DFHEIV99,
 15363           DFHEIV99,
 15364           DFHEIV99
 15365     SET ADDRESS OF CERTIFICATE-MASTER TO
 15366         DFHEIV20
 15367     MOVE EIBRESP  TO WS-RESPONSE
 15368     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15369
 15370
 15371     IF NOT RESP-NORMAL
 15372        GO TO 2276-BYPASS-CRTO
 15373     END-IF
 15374
 15375     MOVE ELCERT-KEY             TO ERMAIL-KEY
 15376     MOVE ' '                    TO WS-ERMAIL-SW
 15377
 15378
 15379* EXEC CICS READ
 15380*       DATASET   (FILE-ID-ERMAIL)
 15381*       SET       (ADDRESS OF MAILING-DATA)
 15382*       RIDFLD    (ERMAIL-KEY)
 15383*       RESP      (WS-RESPONSE)
 15384*    END-EXEC
 15385*    MOVE '&"S        E          (  N#00013783' TO DFHEIV0
 15386     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15387     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15388     MOVE X'204E233030303133373833' TO DFHEIV0(25:11)
 15389     CALL 'kxdfhei1' USING DFHEIV0,
 15390           FILE-ID-ERMAIL,
 15391           DFHEIV20,
 15392           DFHEIV99,
 15393           ERMAIL-KEY,
 15394           DFHEIV99,
 15395           DFHEIV99,
 15396           DFHEIV99
 15397     SET ADDRESS OF MAILING-DATA TO
 15398         DFHEIV20
 15399     MOVE EIBRESP  TO WS-RESPONSE
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 280
* EL6311.cbl
 15400     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15401
 15402     IF RESP-NORMAL
 15403        SET ERMAIL-FOUND TO TRUE
 15404     END-IF
 15405
 15406     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 15407
 15408     MOVE SPACES                 TO ORIGINAL-CERTIFICATE
 15409     MOVE 'OC'                   TO OC-RECORD-ID
 15410     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 15411                                 TO OC-CONTROL-PRIMARY (1:33)
 15412     MOVE 'I'                    TO OC-RECORD-TYPE
 15413     MOVE +4096                  TO OC-KEY-SEQ-NO
 15414     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
 15415     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
 15416     MOVE WS-CURRENT-BIN-DT      TO OC-LAST-MAINT-DT
 15417
 15418     MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 15419     MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 15420     MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 15421     MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 15422     MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 15423     MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 15424     MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 15425     MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 15426     MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
 15427     MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
 15428     MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
 15429     MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
 15430     MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
 15431     MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
 15432     MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
 15433     MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
 15434     MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
 15435     MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
 15436     MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 15437     MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
 15438     MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
 15439     MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
 15440     MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
 15441     MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
 15442     MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
 15443     MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 15444     MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
 15445     MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
 15446     MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 15447     MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 15448     MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 15449     MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 15450
 15451     IF ERMAIL-FOUND
 15452        MOVE MA-CRED-BENE-NAME   TO OC-CRED-BENE-NAME
 15453     END-IF
 15454     IF NOT CERT-TRL-REC-NOT-FOUND
 15455        MOVE CS-INS-AGE-DEFAULT-FLAG TO
 15456                           OC-INS-AGE-DEFAULT-FLAG
 15457        MOVE CS-JNT-AGE-DEFAULT-FLAG TO
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 281
* EL6311.cbl
 15458                           OC-JNT-AGE-DEFAULT-FLAG
 15459     END-IF
 15460     MOVE LOW-VALUES             TO OC-ENDORSEMENT-PROCESSED-DT
 15461     .
 15462 2275-WRITE-ELCRTO.
 15463
 15464
 15465* EXEC CICS WRITE
 15466*       DATASET   ('ELCRTO')
 15467*       FROM      (ORIGINAL-CERTIFICATE)
 15468*       RIDFLD    (OC-CONTROL-PRIMARY)
 15469*       RESP      (WS-RESPONSE)
 15470*    END-EXEC
 15471     MOVE LENGTH OF
 15472      ORIGINAL-CERTIFICATE
 15473       TO DFHEIV11
 15474     MOVE 'ELCRTO' TO DFHEIV1
 15475*    MOVE '&$ L                  ''  N#00013852' TO DFHEIV0
 15476     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15477     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15478     MOVE X'204E233030303133383532' TO DFHEIV0(25:11)
 15479     CALL 'kxdfhei1' USING DFHEIV0,
 15480           DFHEIV1,
 15481           ORIGINAL-CERTIFICATE,
 15482           DFHEIV11,
 15483           OC-CONTROL-PRIMARY,
 15484           DFHEIV99,
 15485           DFHEIV99
 15486     MOVE EIBRESP  TO WS-RESPONSE
 15487     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15488
 15489     display ' just wrote 2275 ' ws-response
 15490     IF RESP-DUPKEY
 15491        SUBTRACT +1              FROM OC-KEY-SEQ-NO
 15492        GO TO 2275-WRITE-ELCRTO
 15493     ELSE
 15494        IF NOT RESP-NORMAL
 15495           MOVE -1               TO BMAINTL
 15496           MOVE ER-7450          TO EMI-ERROR
 15497           PERFORM 9900-ERROR-FORMAT
 15498                                 THRU 9900-EXIT
 15499           GO TO 8200-SEND-DATAONLY
 15500        END-IF
 15501     END-IF.
 15502
 15503 2276-BYPASS-CRTO.
 15504******************************************************************
 15505*       U P D A T E   T H E   B A T C H   H E A D E R            *
 15506******************************************************************
 15507
 15508
 15509* EXEC CICS READ
 15510*        INTO    (PENDING-BUSINESS)
 15511*        DATASET (FILE-ID-ERPNDB)
 15512*        RIDFLD  (ERPNDB-KEY)
 15513*        UPDATE
 15514*    END-EXEC.
 15515     MOVE LENGTH OF
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 282
* EL6311.cbl
 15516      PENDING-BUSINESS
 15517       TO DFHEIV11
 15518*    MOVE '&"IL       EU         (   #00013878' TO DFHEIV0
 15519     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15520     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15521     MOVE X'2020233030303133383738' TO DFHEIV0(25:11)
 15522     CALL 'kxdfhei1' USING DFHEIV0,
 15523           FILE-ID-ERPNDB,
 15524           PENDING-BUSINESS,
 15525           DFHEIV11,
 15526           ERPNDB-KEY,
 15527           DFHEIV99,
 15528           DFHEIV99,
 15529           DFHEIV99
 15530     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15531
 15532
 15533     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15534     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15535     MOVE 'B'                    TO JP-RECORD-TYPE.
 15536     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15537
 15538     PERFORM 8400-LOG-JOURNAL-RECORD  *> Before BHDR Image
 15539
 15540     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 15541
 15542
 15543* EXEC CICS REWRITE
 15544*        DATASET (FILE-ID-ERPNDB)
 15545*        FROM    (PENDING-BUSINESS)
 15546*    END-EXEC.
 15547     MOVE LENGTH OF
 15548      PENDING-BUSINESS
 15549       TO DFHEIV11
 15550*    MOVE '&& L                  %   #00013894' TO DFHEIV0
 15551     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15552     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15553     MOVE X'2020233030303133383934' TO DFHEIV0(25:11)
 15554     CALL 'kxdfhei1' USING DFHEIV0,
 15555           FILE-ID-ERPNDB,
 15556           PENDING-BUSINESS,
 15557           DFHEIV11,
 15558           DFHEIV99
 15559     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15560
 15561
 15562     MOVE 'C'                    TO JP-RECORD-TYPE.
 15563     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15564
 15565     PERFORM 8400-LOG-JOURNAL-RECORD  *> After BHDR Image
 15566
 15567     IF WS-ERRORS-PRESENT
 15568        GO TO 3900-RE-DISPLAY-RECORD.
 15569
 15570     MOVE ZEROS                  TO EMI-ERROR.
 15571     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15572     MOVE LOW-VALUES             TO EL631CI.
 15573     MOVE  -1                    TO CMAINTL.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 283
* EL6311.cbl
 15574     GO TO 8100-SEND-INITIAL-MAP.
 15575
 15576 2280-BATCH-HDR-NOT-FOUND.
 15577     MOVE -1                     TO BMAINTL.
 15578     MOVE ER-7450                TO EMI-ERROR.
 15579     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15580     GO TO 8200-SEND-DATAONLY.
 15581
 15582 2290-DUPLICATE-ALT-INDEX.
 15583
 15584******************************************************************
 15585*                                                                *
 15586*      IF THE PB-B-HIGHEST-SEQ-NO WAS NOT UPDATED IN THE DATA    *
 15587*         ENTRY SESSION, ADD +1 TO THE HIGHEST SEQUENCE NUMBER   *
 15588*         AND ATTEMPT TO WRITE THE RECORD AGAIN. REPEAT THIS     *
 15589*         50 TIMES.  IF DUPREC CONDITION IS STILL ENCOUNTERED    *
 15590*         AFTER 50 TIMES, ASSUME THE DUPLICATE RECORD WAS        *
 15591*         CAUSED BY A DUPLICATE ALTERNATE KEY.                   *
 15592*                                                                *
 15593******************************************************************
 15594
 15595     IF LCP-ONCTR-02 =  0
 15596         ADD 1 TO LCP-ONCTR-02
 15597        MOVE +0                  TO WS-SEQ-NO-COUNTER.
 15598
 15599     ADD +1                      TO WS-SEQ-NO-COUNTER.
 15600
 15601     IF  WS-SEQ-NO-COUNTER GREATER THAN +50
 15602         NEXT SENTENCE
 15603     ELSE
 15604         ADD +1 TO PB-BATCH-SEQ-NO
 15605                   PB-CSR-BATCH-SEQ-NO
 15606         MOVE PB-BATCH-SEQ-NO TO WS-B-HIGHEST-SEQ-NO
 15607         GO TO 2275-WRITE-PENDING-BUSINESS.
 15608
 15609     MOVE -1                     TO CCERTNOL.
 15610     MOVE AL-UABON               TO CCERTNOA.
 15611     MOVE AL-UNBON               TO CEFFDTA.
 15612
 15613     MOVE 1                      TO EMI-SUB
 15614                                    EMI-SWITCH1
 15615                                    EMI-SWITCH-AREA-1
 15616                                    EMI-SWITCH-AREA-2.
 15617
 15618     MOVE SPACES                 TO EMI-ERROR-LINES.
 15619
 15620
 15621* EXEC CICS SYNCPOINT ROLLBACK
 15622*    END-EXEC.
 15623*    MOVE '6"R                   !   #00013957' TO DFHEIV0
 15624     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 15625     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15626     MOVE X'2020233030303133393537' TO DFHEIV0(25:11)
 15627     CALL 'kxdfhei1' USING DFHEIV0
 15628     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15629
 15630
 15631     MOVE ER-2247                TO EMI-ERROR.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 284
* EL6311.cbl
 15632     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15633     GO TO 8200-SEND-DATAONLY.
 15634
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 285
* EL6311.cbl
 15636
 15637******************************************************************
 15638*                                                                *
 15639*          C H A N G E   C A N C E L   R O U T I N E             *
 15640*                                                                *
 15641******************************************************************
 15642
 15643***************************************************************
 15644*                                                             *
 15645*     1. GETMAIN FOR PENDING BUSINESS RECORD.                 *
 15646*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
 15647*     3. GET THE RECORD TO BE UPDATED AND SEE IF IT HAS BEEN  *
 15648*              BILLED.  IF IT HAS THEN SAVE A COPY OF THE     *
 15649*              ZERO RECORD FOR CREATING REVERSAL ENTRIES.     *
 15650*     4. UPDATE THE RECORD WITH THE SCREEN DATA               *
 15651*     5. LINK TO THE EDIT ROUTINE.                            *
 15652*     6. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
 15653*     7. REDISPLAY SCREEN DATA WITH NEW DATA RETURNED FROM    *
 15654*              THE EDIT ROUTINE.                              *
 15655*     7. REWRITE THE NEW ISSUE                                *
 15656*     8. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
 15657*                                                             *
 15658***************************************************************
 15659 2300-CHANGE-CANCEL-ROUTINE.
 15660     MOVE 'C'                    TO PI-MAINT-FUNCTION.
 15661
 15662     IF CCHGL NOT = ZEROS
 15663        MOVE ER-2196             TO EMI-ERROR
 15664        MOVE AL-UABON            TO CMAINTA
 15665        MOVE -1                  TO CMAINTL
 15666        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15667        GO TO 8200-SEND-DATAONLY.
 15668
 15669     MOVE CCERTNOI               TO WS-NEW-PRIME.
 15670
 15671     IF CSUFIXL NOT = ZEROS
 15672        MOVE CSUFIXI             TO WS-NEW-SUFFIX
 15673     ELSE
 15674        MOVE SPACE               TO WS-NEW-SUFFIX.
 15675
 15676     MOVE CEFFDTI                TO DEEDIT-FIELD.
 15677     PERFORM 8600-DEEDIT.
 15678     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 15679     MOVE '4'                    TO DC-OPTION-CODE.
 15680
 15681     PERFORM 9700-DATE-LINK.
 15682
 15683     IF DATE-CONVERSION-ERROR
 15684        MOVE ER-0348             TO EMI-ERROR
 15685        MOVE -1                  TO CEFFDTL
 15686        MOVE AL-UABON            TO CEFFDTA
 15687        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15688        GO TO 8200-SEND-DATAONLY
 15689     ELSE
 15690        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 15691        MOVE AL-UANON            TO CEFFDTA
 15692        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 15693
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 286
* EL6311.cbl
 15694 2325-PROCESS-CANCEL-CHANGES.
 15695
 15696* EXEC CICS HANDLE CONDITION
 15697*         NOTFND    (2380-BATCH-HDR-NOT-FOUND)
 15698*    END-EXEC.
 15699*    MOVE '"$I                   ! 5 #00014024' TO DFHEIV0
 15700     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15701     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15702     MOVE X'3520233030303134303234' TO DFHEIV0(25:11)
 15703     CALL 'kxdfhei1' USING DFHEIV0
 15704     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15705
 15706
 15707     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 15708     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 15709     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 15710
 15711
 15712* EXEC CICS GETMAIN
 15713*        SET      (ADDRESS OF PENDING-BUSINESS)
 15714*        LENGTH   (ERPNDB-RECORD-LENGTH)
 15715*        INITIMG  (GETMAIN-SPACE)
 15716*     END-EXEC.
 15717*    MOVE ',"IL                  $   #00014032' TO DFHEIV0
 15718     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 15719     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15720     MOVE X'2020233030303134303332' TO DFHEIV0(25:11)
 15721     CALL 'kxdfhei1' USING DFHEIV0,
 15722           DFHEIV20,
 15723           ERPNDB-RECORD-LENGTH,
 15724           GETMAIN-SPACE
 15725     SET ADDRESS OF PENDING-BUSINESS TO
 15726         DFHEIV20
 15727     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15728
 15729
 15730
 15731* EXEC CICS READ
 15732*        INTO    (PENDING-BUSINESS)
 15733*        DATASET (FILE-ID-ERPNDB)
 15734*        RIDFLD  (ERPNDB-KEY)
 15735*    END-EXEC.
 15736     MOVE LENGTH OF
 15737      PENDING-BUSINESS
 15738       TO DFHEIV11
 15739*    MOVE '&"IL       E          (   #00014038' TO DFHEIV0
 15740     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15741     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15742     MOVE X'2020233030303134303338' TO DFHEIV0(25:11)
 15743     CALL 'kxdfhei1' USING DFHEIV0,
 15744           FILE-ID-ERPNDB,
 15745           PENDING-BUSINESS,
 15746           DFHEIV11,
 15747           ERPNDB-KEY,
 15748           DFHEIV99,
 15749           DFHEIV99,
 15750           DFHEIV99
 15751     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 287
* EL6311.cbl
 15752
 15753
 15754     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 15755
 15756
 15757* EXEC CICS HANDLE CONDITION
 15758*         NOTFND     (2385-REC-NOT-FOUND)
 15759*    END-EXEC.
 15760*    MOVE '"$I                   ! 6 #00014046' TO DFHEIV0
 15761     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15762     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15763     MOVE X'3620233030303134303436' TO DFHEIV0(25:11)
 15764     CALL 'kxdfhei1' USING DFHEIV0
 15765     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15766
 15767
 15768**********************************************************
 15769*      DONT READ THE RECORD FOR UPDATE UNTIL             *
 15770*      AFTER THE CHANGE RECORD HAS BEEN CREATED.         *
 15771**********************************************************
 15772
 15773
 15774* EXEC CICS READ
 15775*        DATASET (FILE-ID-ERPNDB)
 15776*        INTO    (PENDING-BUSINESS)
 15777*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 15778*    END-EXEC.
 15779     MOVE LENGTH OF
 15780      PENDING-BUSINESS
 15781       TO DFHEIV11
 15782*    MOVE '&"IL       E          (   #00014055' TO DFHEIV0
 15783     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15784     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15785     MOVE X'2020233030303134303535' TO DFHEIV0(25:11)
 15786     CALL 'kxdfhei1' USING DFHEIV0,
 15787           FILE-ID-ERPNDB,
 15788           PENDING-BUSINESS,
 15789           DFHEIV11,
 15790           PI-PREV-CONTROL-PRIMARY,
 15791           DFHEIV99,
 15792           DFHEIV99,
 15793           DFHEIV99
 15794     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15795
 15796
 15797********** DO NOT ALLOW CHANGES IF THRU A/R
 15798     IF BMAINTI = 'C'
 15799         IF PB-EL860-INTERNAL-PROCESS
 15800             MOVE ER-4005          TO EMI-ERROR
 15801             MOVE -1               TO BMAINTL
 15802             MOVE AL-UABON         TO BMAINTA
 15803             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15804             GO TO 8200-SEND-DATAONLY.
 15805**********
 15806
 15807     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 15808        MOVE -1                 TO CMAINTL
 15809        MOVE ER-2197            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 288
* EL6311.cbl
 15810        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15811        GO TO 8200-SEND-DATAONLY.
 15812
 15813     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 15814        MOVE ER-2196             TO EMI-ERROR
 15815        MOVE AL-UABON            TO CMAINTA
 15816        MOVE -1                  TO CMAINTL
 15817        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15818        GO TO 8200-SEND-DATAONLY.
 15819     MOVE ZEROS                  TO WS-SEQ-SAVE.
 15820
 15821     IF PB-BILLED-DT = LOW-VALUES AND
 15822        PB-CHG-COUNT = ZEROS
 15823        NEXT SENTENCE
 15824     ELSE
 15825        IF (CREFND1L GREATER THAN ZEROS AND
 15826            WS-CREFND1 NOT = PB-C-LF-CANCEL-AMT)
 15827           OR
 15828           (CREFND2L GREATER THAN ZEROS AND
 15829            WS-CREFND2 NOT = PB-C-AH-CANCEL-AMT)
 15830           PERFORM 2700-BUILD-CORRECTION-RECORD THRU 2799-EXIT.
 15831     if ((crefnd1l <> zeros)
 15832        and (ws-crefnd1 <> pb-c-lf-cancel-amt))
 15833                      or
 15834        ((crefnd2l <> zeros)
 15835        and (ws-crefnd2 <> pb-c-ah-cancel-amt))
 15836        continue
 15837     else
 15838        go to 2330-continue-change
 15839     end-if
 15840
 15841     move zeros                  to ws-check-amts
 15842     move ' '                    to ws-stop-sw
 15843                                    ws-check-sw
 15844                                    ws-any-check-sw
 15845                                    ws-proc-check-sw
 15846                                    ws-chek-browse-sw
 15847
 15848     perform 2500-browse-checks  thru 2500-exit
 15849
 15850     if i-have-processed-checks
 15851        or i-have-checks
 15852        continue
 15853     else
 15854        go to 2330-continue-change
 15855     end-if
 15856
 15857     if crefnd1l <> zeros
 15858        compute ws-lf-diff = ws-crefnd1 - pb-c-lf-cancel-amt
 15859        move ws-crefnd1 to ws-new-ref-total
 15860     else
 15861        move pb-c-lf-cancel-amt  to ws-new-ref-total
 15862     end-if
 15863     if crefnd2l <> zeros
 15864        compute ws-ah-diff = ws-crefnd2 - pb-c-ah-cancel-amt
 15865        compute ws-new-ref-total = ws-new-ref-total +
 15866           ws-crefnd2
 15867     else
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 289
* EL6311.cbl
 15868        compute ws-new-ref-total = ws-new-ref-total +
 15869           pb-c-ah-cancel-amt
 15870     end-if
 15871
 15872     if zeros = (ws-lf-diff + ws-ah-diff)
 15873        move er-3449             to emi-error
 15874        perform 9900-error-format thru 9900-exit
 15875        go to 2330-continue-change
 15876     end-if
 15877
 15878     if (ws-new-ref-total < ws-check-amts)
 15879        and (pb-c-refund-sw = 'Y')
 15880        move er-3447             to emi-error
 15881        perform 9900-error-format thru 9900-exit
 15882        move al-uabon            to cmainta
 15883        move -1                  to cmaintl
 15884        go to 8200-send-dataonly
 15885     end-if
 15886
 15887     if (ws-new-ref-total > ws-check-amts)
 15888        and (ws-check-amts not = zeros)
 15889        move er-3448             to emi-error
 15890        move al-uabon            to crefnd1a
 15891                                    crefnd2a
 15892        perform 9900-error-format thru 9900-exit
 15893     end-if
 15894
 15895*     if (ws-lf-diff + ws-ah-diff) < zeros
 15896*        move er-3447             to emi-error
 15897*        perform 9900-error-format thru 9900-exit
 15898*        move al-uabon            to cmainta
 15899*        move -1                  to cmaintl
 15900*        go to 8200-send-dataonly
 15901*     end-if
 15902     .
 15903 2330-continue-change.
 15904
 15905
 15906* EXEC CICS READ
 15907*        DATASET (FILE-ID-ERPNDB)
 15908*        INTO    (PENDING-BUSINESS)
 15909*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 15910*        UPDATE
 15911*    END-EXEC.
 15912     MOVE LENGTH OF
 15913      PENDING-BUSINESS
 15914       TO DFHEIV11
 15915*    MOVE '&"IL       EU         (   #00014169' TO DFHEIV0
 15916     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15917     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15918     MOVE X'2020233030303134313639' TO DFHEIV0(25:11)
 15919     CALL 'kxdfhei1' USING DFHEIV0,
 15920           FILE-ID-ERPNDB,
 15921           PENDING-BUSINESS,
 15922           DFHEIV11,
 15923           PI-PREV-CONTROL-PRIMARY,
 15924           DFHEIV99,
 15925           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 290
* EL6311.cbl
 15926           DFHEIV99
 15927     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15928
 15929
 15930     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15931     MOVE 'B'                    TO JP-RECORD-TYPE
 15932     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15933     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15934
 15935*    PERFORM 8400-LOG-JOURNAL-RECORD  *>Move closer to rewrite
 15936
 15937     IF PB-BILLED-DT NOT = LOW-VALUES OR
 15938          PB-CHG-COUNT NOT = ZEROS
 15939        IF (CREFND1L GREATER THAN ZEROS AND
 15940            WS-CREFND1 NOT = PB-C-LF-CANCEL-AMT)
 15941           OR
 15942           (CREFND2L GREATER THAN ZEROS AND
 15943            WS-CREFND2 NOT = PB-C-AH-CANCEL-AMT)
 15944            ADD +1                      TO PB-CHG-COUNT
 15945            MOVE LOW-VALUES             TO PB-BILLED-DT.
 15946
 15947*    IF CMICRNOL  GREATER  ZEROS
 15948*        IF CMICRNOI  NUMERIC
 15949*            MOVE CMICRNOI       TO  PB-C-MICROFILM-NO
 15950*            MOVE AL-UNNON       TO  CMICRNOA
 15951*        ELSE
 15952*            MOVE -1             TO  CMICRNOL
 15953*            MOVE AL-UNBON       TO  CMICRNOA
 15954*            MOVE ER-2701        TO  EMI-ERROR
 15955*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15956
 15957     IF CSUFIXL GREATER THAN ZEROS
 15958        MOVE CSUFIXI             TO PB-CERT-SFX.
 15959
 15960     IF CLSTNML GREATER THAN ZEROS
 15961         MOVE CLSTNMI            TO PB-C-LAST-NAME.
 15962
 15963     IF CCANREAL > ZEROS
 15964        MOVE CCANREAI            TO PB-C-CANCEL-REASON
 15965     END-IF
 15966     IF CCANDT1L    GREATER THAN ZEROS
 15967        MOVE WS-CONVERTED-CANDT1 TO PB-C-LF-CANCEL-DT.
 15968
 15969     IF CCANDT2L    GREATER THAN ZEROS
 15970        MOVE WS-CONVERTED-CANDT2 TO PB-C-AH-CANCEL-DT.
 15971
 15972     IF CMTHD1L    GREATER THAN +0
 15973        MOVE CMTHD1I             TO PB-C-LF-REFUND-OVERRIDE.
 15974
 15975     IF CMTHD2L    GREATER THAN +0
 15976        MOVE CMTHD2I             TO PB-C-AH-REFUND-OVERRIDE.
 15977
 15978     IF CREFND1L    GREATER THAN ZEROS
 15979        SUBTRACT PB-C-LF-CANCEL-AMT FROM WS-B-LF-CAN-PRM-ENTERED
 15980        ADD  WS-CREFND1          TO WS-B-LF-CAN-PRM-ENTERED
 15981        MOVE WS-CREFND1          TO PB-C-LF-CANCEL-AMT
 15982        MOVE SPACE               TO PB-C-LF-CALC-REQ.
 15983
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 291
* EL6311.cbl
 15984     IF CREFND2L    GREATER THAN ZEROS
 15985        SUBTRACT PB-C-AH-CANCEL-AMT FROM WS-B-AH-CAN-PRM-ENTERED
 15986        ADD  WS-CREFND2          TO WS-B-AH-CAN-PRM-ENTERED
 15987        MOVE WS-CREFND2          TO PB-C-AH-CANCEL-AMT
 15988        MOVE SPACE               TO PB-C-AH-CALC-REQ.
 15989
 15990     IF CLIVESL     GREATER THAN ZEROS
 15991        MOVE WS-CLIVES           TO PB-C-LIVES.
 15992
 15993     IF CPAYEEL     GREATER THAN ZEROS
 15994        MOVE CPAYEEI             TO PB-C-PAYEE-CODE.
 15995
 15996     IF CFORCEL     GREATER THAN ZEROS
 15997        MOVE CFORCEI             TO PB-FORCE-CODE.
 15998
 15999     IF CBILCDL     GREATER THAN ZEROS
 16000        MOVE CBILCDI             TO PB-RECORD-BILL.
 16001
 16002 2360-REWRITE-PB-RECORD.
 16003     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 16004     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 16005     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT.
 16006*    MOVE 'C'                    TO JP-RECORD-TYPE.
 16007*    MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16008     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16009*    MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 16010
 16011     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 16012
 16013     SUBTRACT PB-C-LF-REF-CALC   FROM WS-B-LF-CAN-PRM-COMPUTED.
 16014     SUBTRACT PB-C-AH-REF-CALC   FROM WS-B-AH-CAN-PRM-COMPUTED.
 16015
 16016     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 16017
 16018     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 16019
 16020     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 16021     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 16022     MOVE PB-SV-STATE            TO PI-SV-STATE.
 16023
 16024     ADD PB-C-LF-REF-CALC        TO WS-B-LF-CAN-PRM-COMPUTED.
 16025     ADD PB-C-AH-REF-CALC        TO WS-B-AH-CAN-PRM-COMPUTED.
 16026
 16027 2375-REWRITE-PENDING-BUSINESS.
 16028     PERFORM 8400-LOG-JOURNAL-RECORD  *>Before Cancel Image
 16029     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16030     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 16031     MOVE 'C'                    TO JP-RECORD-TYPE.
 16032     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16033
 16034
 16035* EXEC CICS REWRITE
 16036*        DATASET (FILE-ID-ERPNDB)
 16037*        FROM    (PENDING-BUSINESS)
 16038*    END-EXEC.
 16039     MOVE LENGTH OF
 16040      PENDING-BUSINESS
 16041       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 292
* EL6311.cbl
 16042*    MOVE '&& L                  %   #00014280' TO DFHEIV0
 16043     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16044     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16045     MOVE X'2020233030303134323830' TO DFHEIV0(25:11)
 16046     CALL 'kxdfhei1' USING DFHEIV0,
 16047           FILE-ID-ERPNDB,
 16048           PENDING-BUSINESS,
 16049           DFHEIV11,
 16050           DFHEIV99
 16051     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16052
 16053
 16054     PERFORM 8400-LOG-JOURNAL-RECORD  *> After Cancel Image
 16055
 16056******************************************************************
 16057*       U P D A T E   T H E   O R I G   C E R T   I N F O        *
 16058******************************************************************
 16059
 16060     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 16061     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 16062     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 16063     MOVE PB-SV-STATE            TO ELCERT-STATE.
 16064
 16065
 16066* EXEC CICS READ
 16067*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 16068*        DATASET (FILE-ID-ELCERT)
 16069*        RIDFLD  (ELCERT-KEY)
 16070*        RESP    (WS-RESPONSE)
 16071*    END-EXEC.
 16072*    MOVE '&"S        E          (  N#00014296' TO DFHEIV0
 16073     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16074     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16075     MOVE X'204E233030303134323936' TO DFHEIV0(25:11)
 16076     CALL 'kxdfhei1' USING DFHEIV0,
 16077           FILE-ID-ELCERT,
 16078           DFHEIV20,
 16079           DFHEIV99,
 16080           ELCERT-KEY,
 16081           DFHEIV99,
 16082           DFHEIV99,
 16083           DFHEIV99
 16084     SET ADDRESS OF CERTIFICATE-MASTER TO
 16085         DFHEIV20
 16086     MOVE EIBRESP  TO WS-RESPONSE
 16087     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16088
 16089
 16090     IF NOT RESP-NORMAL
 16091        GO TO 2376-BYPASS-CRTO
 16092     END-IF
 16093
 16094
 16095     MOVE ELCERT-KEY             TO ERMAIL-KEY
 16096     MOVE ' '                    TO WS-ERMAIL-SW
 16097
 16098
 16099* EXEC CICS READ
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 293
* EL6311.cbl
 16100*       DATASET   (FILE-ID-ERMAIL)
 16101*       SET       (ADDRESS OF MAILING-DATA)
 16102*       RIDFLD    (ERMAIL-KEY)
 16103*       RESP      (WS-RESPONSE)
 16104*    END-EXEC
 16105*    MOVE '&"S        E          (  N#00014311' TO DFHEIV0
 16106     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16107     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16108     MOVE X'204E233030303134333131' TO DFHEIV0(25:11)
 16109     CALL 'kxdfhei1' USING DFHEIV0,
 16110           FILE-ID-ERMAIL,
 16111           DFHEIV20,
 16112           DFHEIV99,
 16113           ERMAIL-KEY,
 16114           DFHEIV99,
 16115           DFHEIV99,
 16116           DFHEIV99
 16117     SET ADDRESS OF MAILING-DATA TO
 16118         DFHEIV20
 16119     MOVE EIBRESP  TO WS-RESPONSE
 16120     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16121
 16122     IF RESP-NORMAL
 16123        SET ERMAIL-FOUND TO TRUE
 16124     END-IF
 16125
 16126     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 16127
 16128     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 16129                                 TO ELCRTO-KEY
 16130     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 16131     MOVE +0                     TO ELCRTO-SEQ-NO
 16132
 16133
 16134* EXEC CICS READ
 16135*       DATASET   ('ELCRTO')
 16136*       INTO      (ORIGINAL-CERTIFICATE)
 16137*       RIDFLD    (ELCRTO-KEY)
 16138*       GTEQ
 16139*       RESP      (WS-RESPONSE)
 16140*    END-EXEC
 16141     MOVE LENGTH OF
 16142      ORIGINAL-CERTIFICATE
 16143       TO DFHEIV11
 16144     MOVE 'ELCRTO' TO DFHEIV1
 16145*    MOVE '&"IL       G          (  N#00014329' TO DFHEIV0
 16146     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 16147     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16148     MOVE X'204E233030303134333239' TO DFHEIV0(25:11)
 16149     CALL 'kxdfhei1' USING DFHEIV0,
 16150           DFHEIV1,
 16151           ORIGINAL-CERTIFICATE,
 16152           DFHEIV11,
 16153           ELCRTO-KEY,
 16154           DFHEIV99,
 16155           DFHEIV99,
 16156           DFHEIV99
 16157     MOVE EIBRESP  TO WS-RESPONSE
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 294
* EL6311.cbl
 16158     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16159
 16160     IF RESP-NORMAL
 16161        AND (OC-CONTROL-PRIMARY (1:33) =
 16162                 PB-CONTROL-BY-ACCOUNT (1:33))
 16163        AND (OC-RECORD-TYPE = 'I')
 16164        display ' resp norm, key =, type i '
 16165        IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 16166           display ' end proc blank '
 16167           display ' csr edit session ' PI-CSR-SESSION-SW
 16168           IF NOT CSR-EDIT-SESSION
 16169
 16170* EXEC CICS READ
 16171*                DATASET   ('ELCRTO')
 16172*                INTO      (ORIGINAL-CERTIFICATE)
 16173*                RIDFLD    (OC-CONTROL-PRIMARY)
 16174*                UPDATE
 16175*                RESP      (WS-RESPONSE)
 16176*             END-EXEC
 16177     MOVE LENGTH OF
 16178      ORIGINAL-CERTIFICATE
 16179       TO DFHEIV11
 16180     MOVE 'ELCRTO' TO DFHEIV1
 16181*    MOVE '&"IL       EU         (  N#00014346' TO DFHEIV0
 16182     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 16183     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16184     MOVE X'204E233030303134333436' TO DFHEIV0(25:11)
 16185     CALL 'kxdfhei1' USING DFHEIV0,
 16186           DFHEIV1,
 16187           ORIGINAL-CERTIFICATE,
 16188           DFHEIV11,
 16189           OC-CONTROL-PRIMARY,
 16190           DFHEIV99,
 16191           DFHEIV99,
 16192           DFHEIV99
 16193     MOVE EIBRESP  TO WS-RESPONSE
 16194     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16195              DISPLAY ' JUST DID READ UPD ' WS-RESPONSE
 16196              IF RESP-NORMAL
 16197                 display ' good read upd '
 16198                 IF OC-ISSUE-TRAN-IND = 'N'
 16199                    MOVE CM-INSURED-LAST-NAME   TO
 16200                         OC-INS-LAST-NAME
 16201                    MOVE CM-INSURED-FIRST-NAME  TO
 16202                         OC-INS-FIRST-NAME
 16203                    MOVE CM-INSURED-INITIAL2    TO
 16204                         OC-INS-MIDDLE-INIT
 16205                    MOVE CM-INSURED-ISSUE-AGE   TO
 16206                         OC-INS-AGE
 16207                    MOVE CM-JT-LAST-NAME        TO
 16208                         OC-JNT-LAST-NAME
 16209                    MOVE CM-JT-FIRST-NAME       TO
 16210                         OC-JNT-FIRST-NAME
 16211                    MOVE CM-JT-INITIAL          TO
 16212                         OC-JNT-MIDDLE-INIT
 16213                    MOVE CM-INSURED-JOINT-AGE   TO
 16214                         OC-JNT-AGE
 16215                    MOVE CM-LF-BENEFIT-CD       TO
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 295
* EL6311.cbl
 16216                         OC-LF-BENCD
 16217                    MOVE CM-LF-ORIG-TERM        TO
 16218                         OC-LF-TERM
 16219                    MOVE CM-LF-BENEFIT-AMT      TO
 16220                         OC-LF-BEN-AMT
 16221                    MOVE CM-LF-PREMIUM-AMT      TO
 16222                         OC-LF-PRM-AMT
 16223                    MOVE CM-LF-ALT-BENEFIT-AMT  TO
 16224                         OC-LF-ALT-BEN-AMT
 16225                    MOVE CM-LF-ALT-PREMIUM-AMT  TO
 16226                         OC-LF-ALT-PRM-AMT
 16227                    MOVE CM-LF-LOAN-EXPIRE-DT   TO
 16228                         OC-LF-EXP-DT
 16229                    MOVE CM-LIFE-COMM-PCT       TO
 16230                         OC-LF-COMM-PCT
 16231                    MOVE CM-AH-BENEFIT-CD       TO
 16232                         OC-AH-BENCD
 16233                    MOVE CM-AH-ORIG-TERM        TO
 16234                         OC-AH-TERM
 16235                    MOVE CM-AH-BENEFIT-AMT      TO
 16236                         OC-AH-BEN-AMT
 16237                    MOVE CM-AH-PREMIUM-AMT      TO
 16238                         OC-AH-PRM-AMT
 16239                    MOVE CM-AH-LOAN-EXPIRE-DT   TO
 16240                         OC-AH-EXP-DT
 16241                    MOVE CM-AH-COMM-PCT         TO
 16242                         OC-AH-COMM-PCT
 16243                    MOVE CM-AH-CRITICAL-PERIOD  TO
 16244                         OC-AH-CP
 16245                    MOVE CM-LOAN-1ST-PMT-DT     TO
 16246                         OC-1ST-PMT-DT
 16247                 END-IF
 16248                 MOVE PB-C-LF-CANCEL-DT      TO
 16249                         OC-LF-CANCEL-DT
 16250                 MOVE PB-C-LF-CANCEL-AMT     TO
 16251                         OC-LF-CANCEL-AMT
 16252                 MOVE CM-LF-ITD-CANCEL-AMT   TO
 16253                         OC-LF-ITD-CANCEL-AMT
 16254                 MOVE PB-C-AH-CANCEL-DT      TO
 16255                         OC-AH-CANCEL-DT
 16256                 MOVE PB-C-AH-CANCEL-AMT     TO
 16257                         OC-AH-CANCEL-AMT
 16258                 MOVE CM-AH-ITD-CANCEL-AMT   TO
 16259                         OC-AH-ITD-CANCEL-AMT
 16260                 MOVE 'Y'                    TO
 16261                         OC-CANCEL-TRAN-IND
 16262                 MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 16263                 MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 16264                 MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 16265                 IF ERMAIL-FOUND
 16266                    MOVE MA-CRED-BENE-NAME
 16267                                 TO OC-CRED-BENE-NAME
 16268                 END-IF
 16269                 IF NOT CERT-TRL-REC-NOT-FOUND
 16270                    MOVE CS-INS-AGE-DEFAULT-FLAG TO
 16271                           OC-INS-AGE-DEFAULT-FLAG
 16272                    MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 16273                           OC-JNT-AGE-DEFAULT-FLAG
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 296
* EL6311.cbl
 16274                 END-IF
 16275
 16276* EXEC CICS REWRITE
 16277*                   DATASET   ('ELCRTO')
 16278*                   FROM      (ORIGINAL-CERTIFICATE)
 16279*                   RESP      (WS-RESPONSE)
 16280*                END-EXEC
 16281     MOVE LENGTH OF
 16282      ORIGINAL-CERTIFICATE
 16283       TO DFHEIV11
 16284     MOVE 'ELCRTO' TO DFHEIV1
 16285*    MOVE '&& L                  %  N#00014433' TO DFHEIV0
 16286     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16287     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16288     MOVE X'204E233030303134343333' TO DFHEIV0(25:11)
 16289     CALL 'kxdfhei1' USING DFHEIV0,
 16290           DFHEIV1,
 16291           ORIGINAL-CERTIFICATE,
 16292           DFHEIV11,
 16293           DFHEIV99
 16294     MOVE EIBRESP  TO WS-RESPONSE
 16295     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16296                 display ' just rewrote ' ws-response
 16297              END-IF
 16298           END-IF
 16299        ELSE
 16300           SUBTRACT +1 FROM OC-KEY-SEQ-NO
 16301           MOVE 'OC'             TO OC-RECORD-ID
 16302           MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 16303           MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 16304           MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 16305           MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 16306           MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 16307           MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 16308           MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 16309           MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 16310           MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 16311           MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 16312           MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 16313           MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
 16314           MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
 16315           MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
 16316           MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
 16317           MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
 16318           MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
 16319           MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
 16320           MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
 16321           MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
 16322           MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
 16323           MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 16324           MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
 16325           MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
 16326           MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
 16327           MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
 16328           MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
 16329           MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
 16330           MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 16331           MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 297
* EL6311.cbl
 16332           MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
 16333           MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 16334           MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 16335           MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 16336           MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 16337           IF ERMAIL-FOUND
 16338              MOVE MA-CRED-BENE-NAME
 16339                                 TO OC-CRED-BENE-NAME
 16340           END-IF
 16341           IF NOT CERT-TRL-REC-NOT-FOUND
 16342              MOVE CS-INS-AGE-DEFAULT-FLAG TO
 16343                           OC-INS-AGE-DEFAULT-FLAG
 16344              MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 16345                           OC-JNT-AGE-DEFAULT-FLAG
 16346           END-IF
 16347           MOVE LOW-VALUES       TO OC-ENDORSEMENT-PROCESSED-DT
 16348
 16349* EXEC CICS WRITE
 16350*             DATASET   ('ELCRTO')
 16351*             FROM      (ORIGINAL-CERTIFICATE)
 16352*             RIDFLD    (OC-CONTROL-PRIMARY)
 16353*             RESP      (WS-RESPONSE)
 16354*          END-EXEC
 16355     MOVE LENGTH OF
 16356      ORIGINAL-CERTIFICATE
 16357       TO DFHEIV11
 16358     MOVE 'ELCRTO' TO DFHEIV1
 16359*    MOVE '&$ L                  ''  N#00014490' TO DFHEIV0
 16360     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16361     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16362     MOVE X'204E233030303134343930' TO DFHEIV0(25:11)
 16363     CALL 'kxdfhei1' USING DFHEIV0,
 16364           DFHEIV1,
 16365           ORIGINAL-CERTIFICATE,
 16366           DFHEIV11,
 16367           OC-CONTROL-PRIMARY,
 16368           DFHEIV99,
 16369           DFHEIV99
 16370     MOVE EIBRESP  TO WS-RESPONSE
 16371     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16372        END-IF
 16373     ELSE
 16374        MOVE SPACES              TO ORIGINAL-CERTIFICATE
 16375        MOVE 'OC'                TO OC-RECORD-ID
 16376        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 16377                                 TO OC-CONTROL-PRIMARY (1:33)
 16378        MOVE 'I'                 TO OC-RECORD-TYPE
 16379        MOVE +4096               TO OC-KEY-SEQ-NO
 16380        MOVE PI-PROCESSOR-ID     TO OC-LAST-MAINT-BY
 16381        MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 16382        MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 16383        MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 16384        MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 16385        MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 16386        MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 16387        MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 16388        MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 16389        MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 298
* EL6311.cbl
 16390        MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 16391        MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
 16392        MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
 16393        MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
 16394        MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
 16395        MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
 16396        MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
 16397        MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
 16398        MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
 16399        MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
 16400        MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
 16401        MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 16402        MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
 16403        MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
 16404        MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
 16405        MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
 16406        MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
 16407        MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
 16408        MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 16409        MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
 16410        MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
 16411        MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 16412        MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 16413        MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 16414        MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 16415        IF ERMAIL-FOUND
 16416           MOVE MA-CRED-BENE-NAME
 16417                                 TO OC-CRED-BENE-NAME
 16418        END-IF
 16419        IF NOT CERT-TRL-REC-NOT-FOUND
 16420           MOVE CS-INS-AGE-DEFAULT-FLAG TO
 16421                           OC-INS-AGE-DEFAULT-FLAG
 16422           MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 16423                           OC-JNT-AGE-DEFAULT-FLAG
 16424        END-IF
 16425        MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 16426
 16427
 16428* EXEC CICS WRITE
 16429*          DATASET   ('ELCRTO')
 16430*          FROM      (ORIGINAL-CERTIFICATE)
 16431*          RIDFLD    (OC-CONTROL-PRIMARY)
 16432*          RESP      (WS-RESPONSE)
 16433*       END-EXEC
 16434     MOVE LENGTH OF
 16435      ORIGINAL-CERTIFICATE
 16436       TO DFHEIV11
 16437     MOVE 'ELCRTO' TO DFHEIV1
 16438*    MOVE '&$ L                  ''  N#00014551' TO DFHEIV0
 16439     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16440     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16441     MOVE X'204E233030303134353531' TO DFHEIV0(25:11)
 16442     CALL 'kxdfhei1' USING DFHEIV0,
 16443           DFHEIV1,
 16444           ORIGINAL-CERTIFICATE,
 16445           DFHEIV11,
 16446           OC-CONTROL-PRIMARY,
 16447           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 299
* EL6311.cbl
 16448           DFHEIV99
 16449     MOVE EIBRESP  TO WS-RESPONSE
 16450     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16451     END-IF.
 16452
 16453 2376-BYPASS-CRTO.
 16454******************************************************************
 16455*       U P D A T E   T H E   B A T C H   H E A D E R            *
 16456******************************************************************
 16457
 16458
 16459* EXEC CICS HANDLE CONDITION
 16460*         NOTFND    (2380-BATCH-HDR-NOT-FOUND)
 16461*    END-EXEC.
 16462*    MOVE '"$I                   ! 7 #00014564' TO DFHEIV0
 16463     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16464     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16465     MOVE X'3720233030303134353634' TO DFHEIV0(25:11)
 16466     CALL 'kxdfhei1' USING DFHEIV0
 16467     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16468
 16469
 16470
 16471* EXEC CICS READ
 16472*        INTO    (PENDING-BUSINESS)
 16473*        DATASET (FILE-ID-ERPNDB)
 16474*        RIDFLD  (ERPNDB-KEY)
 16475*        UPDATE
 16476*    END-EXEC.
 16477     MOVE LENGTH OF
 16478      PENDING-BUSINESS
 16479       TO DFHEIV11
 16480*    MOVE '&"IL       EU         (   #00014568' TO DFHEIV0
 16481     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 16482     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16483     MOVE X'2020233030303134353638' TO DFHEIV0(25:11)
 16484     CALL 'kxdfhei1' USING DFHEIV0,
 16485           FILE-ID-ERPNDB,
 16486           PENDING-BUSINESS,
 16487           DFHEIV11,
 16488           ERPNDB-KEY,
 16489           DFHEIV99,
 16490           DFHEIV99,
 16491           DFHEIV99
 16492     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16493
 16494
 16495     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16496     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 16497     MOVE 'B'                    TO JP-RECORD-TYPE.
 16498     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16499
 16500     PERFORM 8400-LOG-JOURNAL-RECORD  *> Before BHDR Image
 16501
 16502     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 16503
 16504
 16505* EXEC CICS REWRITE
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 300
* EL6311.cbl
 16506*        DATASET (FILE-ID-ERPNDB)
 16507*        FROM    (PENDING-BUSINESS)
 16508*    END-EXEC.
 16509     MOVE LENGTH OF
 16510      PENDING-BUSINESS
 16511       TO DFHEIV11
 16512*    MOVE '&& L                  %   #00014584' TO DFHEIV0
 16513     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16514     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16515     MOVE X'2020233030303134353834' TO DFHEIV0(25:11)
 16516     CALL 'kxdfhei1' USING DFHEIV0,
 16517           FILE-ID-ERPNDB,
 16518           PENDING-BUSINESS,
 16519           DFHEIV11,
 16520           DFHEIV99
 16521     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16522
 16523
 16524     MOVE 'C'                    TO JP-RECORD-TYPE.
 16525     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16526
 16527     PERFORM 8400-LOG-JOURNAL-RECORD  *> After BHDR Image
 16528
 16529     IF WS-ERRORS-PRESENT
 16530         GO TO 3900-RE-DISPLAY-RECORD.
 16531
 16532     MOVE ZEROS                  TO EMI-ERROR
 16533     MOVE -1                     TO CMAINTL
 16534     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16535     GO TO 3900-RE-DISPLAY-RECORD.
 16536
 16537 2380-BATCH-HDR-NOT-FOUND.
 16538     MOVE -1                     TO BMAINTL.
 16539     MOVE ER-7450                TO EMI-ERROR.
 16540     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16541     GO TO 8200-SEND-DATAONLY.
 16542
 16543 2385-REC-NOT-FOUND.
 16544     MOVE -1                     TO BMAINTL.
 16545     MOVE ER-7451                TO EMI-ERROR.
 16546     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16547     GO TO 8200-SEND-DATAONLY.
 16548
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 301
* EL6311.cbl
 16550
 16551******************************************************************
 16552*                                                                *
 16553*          D E L E T E   C A N C E L   R O U T I N E             *
 16554*                                                                *
 16555******************************************************************
 16556
 16557 2400-DELETE-CANCEL-ROUTINE.
 16558     MOVE 'D'                    TO PI-MAINT-FUNCTION.
 16559
 16560     IF CCHGL NOT = ZEROS
 16561        MOVE ER-2196             TO EMI-ERROR
 16562        MOVE AL-UABON            TO CMAINTA
 16563        MOVE -1                  TO CMAINTL
 16564        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16565        GO TO 8200-SEND-DATAONLY.
 16566
 16567
 16568* EXEC CICS HANDLE CONDITION
 16569*         NOTFND    (2485-BATCH-HDR-NOT-FOUND)
 16570*    END-EXEC.
 16571*    MOVE '"$I                   ! 8 #00014632' TO DFHEIV0
 16572     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16573     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16574     MOVE X'3820233030303134363332' TO DFHEIV0(25:11)
 16575     CALL 'kxdfhei1' USING DFHEIV0
 16576     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16577
 16578
 16579     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 16580     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 16581     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 16582
 16583
 16584* EXEC CICS READ
 16585*        SET     (ADDRESS OF PENDING-BUSINESS)
 16586*        DATASET (FILE-ID-ERPNDB)
 16587*        RIDFLD  (ERPNDB-KEY)
 16588*    END-EXEC.
 16589*    MOVE '&"S        E          (   #00014640' TO DFHEIV0
 16590     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16591     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16592     MOVE X'2020233030303134363430' TO DFHEIV0(25:11)
 16593     CALL 'kxdfhei1' USING DFHEIV0,
 16594           FILE-ID-ERPNDB,
 16595           DFHEIV20,
 16596           DFHEIV99,
 16597           ERPNDB-KEY,
 16598           DFHEIV99,
 16599           DFHEIV99,
 16600           DFHEIV99
 16601     SET ADDRESS OF PENDING-BUSINESS TO
 16602         DFHEIV20
 16603     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16604
 16605
 16606     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 16607
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 302
* EL6311.cbl
 16608     MOVE CCERTNOI               TO WS-NEW-PRIME.
 16609
 16610     IF CSUFIXL NOT = ZEROS
 16611        MOVE CSUFIXI             TO WS-NEW-SUFFIX
 16612     ELSE
 16613        MOVE SPACE               TO WS-NEW-SUFFIX.
 16614
 16615     MOVE CEFFDTI                TO DEEDIT-FIELD.
 16616
 16617     PERFORM 8600-DEEDIT.
 16618     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 16619     MOVE '4'                    TO DC-OPTION-CODE.
 16620     PERFORM 9700-DATE-LINK.
 16621
 16622     IF DATE-CONVERSION-ERROR
 16623        MOVE ER-0348             TO EMI-ERROR
 16624        MOVE -1                  TO CEFFDTL
 16625        MOVE AL-UABON            TO CEFFDTA
 16626        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16627        GO TO 8200-SEND-DATAONLY
 16628     ELSE
 16629        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 16630        MOVE AL-UANON            TO CEFFDTA
 16631        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 16632
 16633
 16634* EXEC CICS HANDLE CONDITION
 16635*         NOTFND    (2490-RECORD-NOT-FOUND)
 16636*    END-EXEC.
 16637*    MOVE '"$I                   ! 9 #00014673' TO DFHEIV0
 16638     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16639     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16640     MOVE X'3920233030303134363733' TO DFHEIV0(25:11)
 16641     CALL 'kxdfhei1' USING DFHEIV0
 16642     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16643
 16644
 16645
 16646* EXEC CICS READ
 16647*        SET     (ADDRESS OF PENDING-BUSINESS)
 16648*        DATASET (FILE-ID-ERPNDB)
 16649*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 16650*        UPDATE
 16651*    END-EXEC.
 16652*    MOVE '&"S        EU         (   #00014677' TO DFHEIV0
 16653     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16654     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16655     MOVE X'2020233030303134363737' TO DFHEIV0(25:11)
 16656     CALL 'kxdfhei1' USING DFHEIV0,
 16657           FILE-ID-ERPNDB,
 16658           DFHEIV20,
 16659           DFHEIV99,
 16660           PI-PREV-CONTROL-PRIMARY,
 16661           DFHEIV99,
 16662           DFHEIV99,
 16663           DFHEIV99
 16664     SET ADDRESS OF PENDING-BUSINESS TO
 16665         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 303
* EL6311.cbl
 16666     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16667
 16668
 16669     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 16670        MOVE -1                 TO CMAINTL
 16671        MOVE ER-2197            TO EMI-ERROR
 16672        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16673        GO TO 8200-SEND-DATAONLY.
 16674
 16675     IF PB-BILLED-DT NOT = LOW-VALUES
 16676        MOVE -1                 TO CMAINTL
 16677        MOVE ER-2129            TO EMI-ERROR
 16678        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16679        GO TO 8200-SEND-DATAONLY.
 16680
 16681     IF PB-CHG-COUNT NOT = ZEROS
 16682        MOVE ER-2336            TO EMI-ERROR
 16683        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16684        MOVE AL-UABON            TO CMAINTA
 16685        MOVE -1                  TO CMAINTL
 16686        GO TO 8200-SEND-DATAONLY.
 16687
 16688     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 16689        PB-CHG-COUNT NOT = ZEROS
 16690        MOVE ER-2196             TO EMI-ERROR
 16691        MOVE AL-UABON            TO CMAINTA
 16692        MOVE -1                  TO CMAINTL
 16693        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16694        GO TO 8200-SEND-DATAONLY.
 16695
 16696     IF PB-CONFIRMATION-REPT-DT NOT = SPACES AND LOW-VALUES
 16697        MOVE ER-2900 TO EMI-ERROR
 16698        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16699        MOVE AL-UABON         TO CMAINTA
 16700        MOVE -1               TO CMAINTL
 16701        GO TO 8200-SEND-DATAONLY.
 16702     move ' '                    to ws-stop-sw
 16703                                    ws-check-sw
 16704                                    ws-any-check-sw
 16705                                    ws-proc-check-sw
 16706                                    ws-chek-browse-sw
 16707
 16708     perform 2500-browse-checks  thru 2500-exit
 16709     if (i-have-processed-checks)
 16710        and (pb-c-refund-sw = 'Y')
 16711        move er-3446             to emi-error
 16712        perform 9900-error-format thru 9900-exit
 16713        move al-uabon            to cmainta
 16714        move -1                  to cmaintl
 16715        go to 8200-send-dataonly
 16716     end-if
 16717
 16718* EXEC CICS HANDLE CONDITION
 16719*         NOTFND  (2475-CONTINUE-DELETE)
 16720*    END-EXEC
 16721*    MOVE '"$I                   ! : #00014732' TO DFHEIV0
 16722     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16723     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 304
* EL6311.cbl
 16724     MOVE X'3A20233030303134373332' TO DFHEIV0(25:11)
 16725     CALL 'kxdfhei1' USING DFHEIV0
 16726     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16727
 16728     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 16729     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 16730     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 16731     MOVE PB-SV-STATE            TO ELCERT-STATE.
 16732
 16733
 16734* EXEC CICS READ
 16735*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 16736*        DATASET (FILE-ID-ELCERT)
 16737*        RIDFLD  (ELCERT-KEY)
 16738*        UPDATE
 16739*    END-EXEC.
 16740*    MOVE '&"S        EU         (   #00014741' TO DFHEIV0
 16741     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16742     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16743     MOVE X'2020233030303134373431' TO DFHEIV0(25:11)
 16744     CALL 'kxdfhei1' USING DFHEIV0,
 16745           FILE-ID-ELCERT,
 16746           DFHEIV20,
 16747           DFHEIV99,
 16748           ELCERT-KEY,
 16749           DFHEIV99,
 16750           DFHEIV99,
 16751           DFHEIV99
 16752     SET ADDRESS OF CERTIFICATE-MASTER TO
 16753         DFHEIV20
 16754     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16755
 16756
 16757     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16758
 16759     MOVE FILE-ID-ELCERT         TO JP-FILE-ID.
 16760     MOVE 'B'                    TO JP-RECORD-TYPE.
 16761     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 16762     PERFORM 8400-LOG-JOURNAL-RECORD.
 16763
 16764     IF PB-CI-LIVES NOT NUMERIC
 16765         MOVE ZERO                    TO PB-CI-LIVES.
 16766
 16767     IF PB-C-LF-CANCEL-DT GREATER THAN LOW-VALUES
 16768        IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 16769           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16770           MOVE ZERO                     TO CM-LF-ITD-CANCEL-AMT
 16771           MOVE LOW-VALUES               TO CM-LF-CANCEL-EXIT-DT
 16772                                            CM-LF-CANCEL-DT
 16773           MOVE SPACE                    TO CM-LF-EXIT-BATCH
 16774        ELSE
 16775           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16776           MOVE PB-CI-LF-CANCEL-AMT      TO CM-LF-ITD-CANCEL-AMT
 16777           MOVE PB-CI-LF-PRIOR-CANCEL-DT TO CM-LF-CANCEL-DT
 16778           MOVE PB-CI-LIVES              TO CM-LIVES.
 16779
 16780     IF PB-C-LF-CANCEL-DT GREATER THAN LOW-VALUES
 16781        IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 305
* EL6311.cbl
 16782           IF CM-LF-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 16783               MOVE CM-LF-STATUS-AT-CANCEL
 16784                                        TO CM-LF-CURRENT-STATUS
 16785               MOVE SPACE
 16786                                        TO CM-LF-STATUS-AT-CANCEL
 16787           ELSE
 16788               MOVE PB-CI-LF-POLICY-STATUS
 16789                                        TO CM-LF-CURRENT-STATUS
 16790        ELSE
 16791           MOVE PB-CI-LF-POLICY-STATUS  TO CM-LF-CURRENT-STATUS.
 16792
 16793
 16794     IF PB-C-AH-CANCEL-DT GREATER THAN LOW-VALUES
 16795        IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 16796           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16797           MOVE ZERO                     TO CM-AH-ITD-CANCEL-AMT
 16798           MOVE LOW-VALUES               TO CM-AH-CANCEL-EXIT-DT
 16799                                            CM-AH-CANCEL-DT
 16800           MOVE SPACE                    TO CM-AH-EXIT-BATCH
 16801        ELSE
 16802           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16803           MOVE PB-CI-AH-CANCEL-AMT      TO CM-AH-ITD-CANCEL-AMT
 16804           MOVE PB-CI-AH-PRIOR-CANCEL-DT TO CM-AH-CANCEL-DT
 16805           MOVE PB-CI-LIVES              TO CM-LIVES.
 16806
 16807     IF PB-C-AH-CANCEL-DT GREATER THAN LOW-VALUES
 16808        IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 16809           IF CM-AH-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 16810               MOVE CM-AH-STATUS-AT-CANCEL
 16811                                        TO CM-AH-CURRENT-STATUS
 16812               MOVE SPACE
 16813                                        TO CM-AH-STATUS-AT-CANCEL
 16814           ELSE
 16815               MOVE PB-CI-AH-POLICY-STATUS
 16816                                        TO CM-AH-CURRENT-STATUS
 16817        ELSE
 16818           MOVE PB-CI-AH-POLICY-STATUS  TO CM-AH-CURRENT-STATUS.
 16819
 16820 2450-REWRITE-CERT.
 16821     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 16822     MOVE 'C'                      TO JP-RECORD-TYPE.
 16823     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 16824
 16825
 16826* EXEC CICS REWRITE
 16827*        DATASET  (FILE-ID-ELCERT)
 16828*        FROM     (CERTIFICATE-MASTER)
 16829*    END-EXEC.
 16830     MOVE LENGTH OF
 16831      CERTIFICATE-MASTER
 16832       TO DFHEIV11
 16833*    MOVE '&& L                  %   #00014816' TO DFHEIV0
 16834     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16835     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16836     MOVE X'2020233030303134383136' TO DFHEIV0(25:11)
 16837     CALL 'kxdfhei1' USING DFHEIV0,
 16838           FILE-ID-ELCERT,
 16839           CERTIFICATE-MASTER,
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 306
* EL6311.cbl
 16840           DFHEIV11,
 16841           DFHEIV99
 16842     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16843
 16844
 16845     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 16846
 16847     PERFORM 8400-LOG-JOURNAL-RECORD.
 16848
 16849     move ' '                    to ws-stop-sw
 16850                                    ws-any-check-sw
 16851                                    ws-proc-check-sw
 16852                                    ws-chek-browse-sw
 16853
 16854     if i-have-checks
 16855        perform until i-say-stop
 16856           perform 2510-startbr-erchek
 16857                                 thru 2510-exit
 16858           if resp-normal
 16859              perform 2520-readnext-erchek
 16860                                 thru 2520-exit
 16861           end-if
 16862           if (not resp-normal)
 16863              or (pb-control-by-account (1:33) not =
 16864                 ch-control-primary (1:33))
 16865                 set i-say-stop to true
 16866           else
 16867              perform 2530-readupd-erchek
 16868                                 thru 2530-exit
 16869              if resp-normal
 16870                 perform 2540-delete-erchek
 16871                                 thru 2540-exit
 16872              end-if
 16873              if ws-chek-browse-sw = 'Y'
 16874                 perform 2525-endbr-erchek
 16875                                 thru 2525-exit
 16876                 move ' '        to ws-chek-browse-sw
 16877              end-if
 16878           end-if
 16879        end-perform
 16880     end-if
 16881
 16882     if ws-chek-browse-sw = 'Y'
 16883        perform 2525-endbr-erchek thru 2525-exit
 16884     end-if
 16885     .
 16886 2475-CONTINUE-DELETE.
 16887     SUBTRACT PB-C-LF-CANCEL-AMT  FROM WS-B-LF-CAN-PRM-ENTERED.
 16888     SUBTRACT PB-C-AH-CANCEL-AMT  FROM WS-B-AH-CAN-PRM-ENTERED.
 16889
 16890     SUBTRACT PB-C-LF-REF-CALC    FROM WS-B-LF-CAN-PRM-COMPUTED.
 16891     SUBTRACT PB-C-AH-REF-CALC    FROM WS-B-AH-CAN-PRM-COMPUTED.
 16892
 16893     SUBTRACT +1 FROM WS-B-CANCEL-CNT-ENTERED.
 16894
 16895     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID
 16896     MOVE 'D'                    TO JP-RECORD-TYPE
 16897     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 307
* EL6311.cbl
 16898
 16899
 16900* EXEC CICS DELETE
 16901*        DATASET    (FILE-ID-ERPNDB)
 16902*    END-EXEC.
 16903*    MOVE '&(                    &   #00014875' TO DFHEIV0
 16904     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16905     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16906     MOVE X'2020233030303134383735' TO DFHEIV0(25:11)
 16907     CALL 'kxdfhei1' USING DFHEIV0,
 16908           FILE-ID-ERPNDB,
 16909           DFHEIV99,
 16910           DFHEIV99,
 16911           DFHEIV99,
 16912           DFHEIV99
 16913     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16914
 16915
 16916     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16917
 16918     PERFORM 8400-LOG-JOURNAL-RECORD  *> Journal Cancel Delete
 16919
 16920     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 16921     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 16922
 16923
 16924* EXEC CICS HANDLE CONDITION
 16925*         NOTFND    (2485-BATCH-HDR-NOT-FOUND)
 16926*    END-EXEC.
 16927*    MOVE '"$I                   ! ; #00014886' TO DFHEIV0
 16928     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16929     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16930     MOVE X'3B20233030303134383836' TO DFHEIV0(25:11)
 16931     CALL 'kxdfhei1' USING DFHEIV0
 16932     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16933
 16934
 16935
 16936* EXEC CICS READ
 16937*        SET     (ADDRESS OF PENDING-BUSINESS)
 16938*        DATASET (FILE-ID-ERPNDB)
 16939*        RIDFLD  (ERPNDB-KEY)
 16940*        UPDATE
 16941*    END-EXEC.
 16942*    MOVE '&"S        EU         (   #00014890' TO DFHEIV0
 16943     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16944     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16945     MOVE X'2020233030303134383930' TO DFHEIV0(25:11)
 16946     CALL 'kxdfhei1' USING DFHEIV0,
 16947           FILE-ID-ERPNDB,
 16948           DFHEIV20,
 16949           DFHEIV99,
 16950           ERPNDB-KEY,
 16951           DFHEIV99,
 16952           DFHEIV99,
 16953           DFHEIV99
 16954     SET ADDRESS OF PENDING-BUSINESS TO
 16955         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 308
* EL6311.cbl
 16956     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16957
 16958
 16959     MOVE FILE-ID-ERPNDB           TO JP-FILE-ID.
 16960     MOVE ERPNDB-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 16961
 16962     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 16963        WS-B-CANCEL-CNT-ENTERED = ZEROS
 16964        MOVE 'D'                 TO JP-RECORD-TYPE
 16965        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 16966
 16967* EXEC CICS DELETE
 16968*            DATASET    (FILE-ID-ERPNDB)
 16969*       END-EXEC
 16970*    MOVE '&(                    &   #00014904' TO DFHEIV0
 16971     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16972     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16973     MOVE X'2020233030303134393034' TO DFHEIV0(25:11)
 16974     CALL 'kxdfhei1' USING DFHEIV0,
 16975           FILE-ID-ERPNDB,
 16976           DFHEIV99,
 16977           DFHEIV99,
 16978           DFHEIV99,
 16979           DFHEIV99
 16980     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16981        PERFORM 8400-LOG-JOURNAL-RECORD  *> Journal BHDR Delete
 16982     ELSE
 16983        MOVE 'B'                 TO JP-RECORD-TYPE
 16984        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 16985        PERFORM 8400-LOG-JOURNAL-RECORD  *> Before BHDR Image
 16986        MOVE WS-BATCH-RECORD     TO PB-BATCH-RECORD
 16987        MOVE 'C'                 TO JP-RECORD-TYPE
 16988        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 16989
 16990* EXEC CICS REWRITE
 16991*            DATASET    (FILE-ID-ERPNDB)
 16992*            FROM       (PENDING-BUSINESS)
 16993*       END-EXEC
 16994     MOVE LENGTH OF
 16995      PENDING-BUSINESS
 16996       TO DFHEIV11
 16997*    MOVE '&& L                  %   #00014915' TO DFHEIV0
 16998     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16999     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17000     MOVE X'2020233030303134393135' TO DFHEIV0(25:11)
 17001     CALL 'kxdfhei1' USING DFHEIV0,
 17002           FILE-ID-ERPNDB,
 17003           PENDING-BUSINESS,
 17004           DFHEIV11,
 17005           DFHEIV99
 17006     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17007        PERFORM 8400-LOG-JOURNAL-RECORD  *> After BHDR Image
 17008     end-if
 17009
 17010******************************************************************
 17011*                                                                *
 17012*       DELETE THE A/R REQUEST RECORD IF THE COMPANY USES        *
 17013*       THE ACCOUNTS RECEIVABLE SYSTEM.                          *
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 309
* EL6311.cbl
 17014*                                                                *
 17015******************************************************************
 17016
 17017     IF NOT PI-AR-PROCESSING
 17018        GO TO 2480-DELETE-FINISHED.
 17019
 17020     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 17021        WS-B-CANCEL-CNT-ENTERED = ZEROS
 17022        NEXT SENTENCE
 17023     ELSE
 17024        GO TO 2480-DELETE-FINISHED.
 17025
 17026
 17027* EXEC CICS HANDLE CONDITION
 17028*         NOTFND    (2480-DELETE-FINISHED)
 17029*    END-EXEC.
 17030*    MOVE '"$I                   ! < #00014938' TO DFHEIV0
 17031     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17032     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17033     MOVE X'3C20233030303134393338' TO DFHEIV0(25:11)
 17034     CALL 'kxdfhei1' USING DFHEIV0
 17035     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17036
 17037
 17038     MOVE ERPNDB-COMPANY-CD      TO ERRQST-COMPANY-CD.
 17039     MOVE ERPNDB-ENTRY-BATCH     TO ERRQST-ENTRY-BATCH.
 17040
 17041
 17042* EXEC CICS READ
 17043*        SET     (ADDRESS OF AR-REQUEST-RECORD)
 17044*        DATASET (FILE-ID-ERRQST)
 17045*        RIDFLD  (ERRQST-KEY)
 17046*        UPDATE
 17047*    END-EXEC.
 17048*    MOVE '&"S        EU         (   #00014945' TO DFHEIV0
 17049     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17050     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17051     MOVE X'2020233030303134393435' TO DFHEIV0(25:11)
 17052     CALL 'kxdfhei1' USING DFHEIV0,
 17053           FILE-ID-ERRQST,
 17054           DFHEIV20,
 17055           DFHEIV99,
 17056           ERRQST-KEY,
 17057           DFHEIV99,
 17058           DFHEIV99,
 17059           DFHEIV99
 17060     SET ADDRESS OF AR-REQUEST-RECORD TO
 17061         DFHEIV20
 17062     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17063
 17064
 17065     MOVE ERRQST-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 17066
 17067     MOVE  FILE-ID-ERRQST          TO JP-FILE-ID.
 17068
 17069     MOVE 'D'                      TO JP-RECORD-TYPE.
 17070     MOVE AR-REQUEST-RECORD        TO JP-RECORD-AREA.
 17071
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 310
* EL6311.cbl
 17072
 17073* EXEC CICS DELETE
 17074*         DATASET    (FILE-ID-ERRQST)
 17075*    END-EXEC.
 17076*    MOVE '&(                    &   #00014959' TO DFHEIV0
 17077     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17078     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17079     MOVE X'2020233030303134393539' TO DFHEIV0(25:11)
 17080     CALL 'kxdfhei1' USING DFHEIV0,
 17081           FILE-ID-ERRQST,
 17082           DFHEIV99,
 17083           DFHEIV99,
 17084           DFHEIV99,
 17085           DFHEIV99
 17086     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17087
 17088
 17089     PERFORM 8400-LOG-JOURNAL-RECORD.
 17090
 17091 2480-DELETE-FINISHED.
 17092     MOVE ZEROS                  TO EMI-ERROR.
 17093     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17094     MOVE LOW-VALUES             TO EL631CI.
 17095     MOVE -1                     TO CMAINTL.
 17096     GO TO 8100-SEND-INITIAL-MAP.
 17097
 17098 2485-BATCH-HDR-NOT-FOUND.
 17099     MOVE -1                     TO CMAINTL
 17100     MOVE AL-UABON               TO CMAINTA.
 17101     MOVE ER-7450                TO EMI-ERROR.
 17102     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17103     GO TO 8200-SEND-DATAONLY.
 17104
 17105 2490-RECORD-NOT-FOUND.
 17106     MOVE -1                     TO CMAINTL
 17107     MOVE AL-UABON               TO CMAINTA.
 17108     MOVE ER-7451                TO EMI-ERROR.
 17109     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17110     GO TO 8200-SEND-DATAONLY.
 17111***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
 17112***                                                            ***
 17113***     2500  B R O W S E   C H E C K S                        ***
 17114***  We perform this routine from 2 different places.          ***
 17115***  1. If the user changes the refund amount on a cancel, we  ***
 17116***    want to.........                                        ***
 17117***    a. determine if prior checks have been processed        ***
 17118***    b. If the amt is larger, display message instructing    ***
 17119***     them to create another check to make up the difference.***
 17120***    c. If the amt is less, do not allow the change and      ***
 17121***     display a FATAL error suggesting they deal with check  ***
 17122***     records befor continuing.                              ***
 17123***  2. If the user wants to delete a cancel record we......   ***
 17124***    a. browse through all the checks and if there is a      ***
 17125***     processed check, send FATAL message.                   ***
 17126***    b. If there is a non-released check, then delete that   ***
 17127***     check after you delete the pending cancel record.      ***
 17128***                                                            ***
 17129***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 311
* EL6311.cbl
 17130
 17131 2500-browse-checks.
 17132
 17133     perform 2510-startbr-erchek thru 2510-exit
 17134
 17135     if not resp-normal
 17136        go to 2500-exit
 17137     end-if
 17138
 17139     perform until i-say-stop
 17140        perform 2520-readnext-erchek
 17141                                 thru 2520-exit
 17142        if (not resp-normal)
 17143           or (pb-control-by-account (1:33) not =
 17144              ch-control-primary (1:33))
 17145              set i-say-stop to true
 17146        else
 17147           set i-have-a-check-period to true
 17148           if (ch-approval-status) = ' '
 17149              and (ch-void-dt = low-values)
 17150              and (ch-released-dt = low-values)
 17151              set i-have-checks to true
 17152           else
 17153              if ch-void-dt = low-values
 17154                 set i-have-processed-checks to true
 17155              end-if
 17156           end-if
 17157           if (ch-credit-accept-dt = low-values)
 17158              and (ch-void-dt = low-values)
 17159              and (ch-approval-status = ' ' OR 'P' OR 'A')
 17160              if (ch-check-origin-sw not = 'R')
 17161                 and (pb-record-type = '2')
 17162                 continue
 17163              else
 17164                 compute ws-check-amts =
 17165                    ws-check-amts + ch-amount-paid
 17166              end-if
 17167           end-if
 17168        end-if
 17169     end-perform
 17170
 17171     if ws-chek-browse-sw = 'Y'
 17172        perform 2525-endbr-erchek thru 2525-exit
 17173     end-if
 17174
 17175    .
 17176 2500-exit.
 17177     exit.
 17178
 17179 2510-startbr-erchek.
 17180
 17181     move pb-control-by-account  to erchek-key
 17182     move +0                     to chek-record-seq
 17183
 17184
 17185* exec cics startbr
 17186*       dataset   ('ERCHEK')
 17187*       ridfld    (erchek-key)
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 312
* EL6311.cbl
 17188*       gteq
 17189*       resp      (ws-response)
 17190*    end-exec
 17191     MOVE 'ERCHEK' TO DFHEIV1
 17192     MOVE 0
 17193       TO DFHEIV11
 17194*    MOVE '&,         G          &  N#00015058' TO DFHEIV0
 17195     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 17196     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17197     MOVE X'204E233030303135303538' TO DFHEIV0(25:11)
 17198     CALL 'kxdfhei1' USING DFHEIV0,
 17199           DFHEIV1,
 17200           erchek-key,
 17201           DFHEIV99,
 17202           DFHEIV11,
 17203           DFHEIV99
 17204     MOVE EIBRESP  TO ws-response
 17205     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17206
 17207     IF RESP-NORMAL
 17208        move 'Y'                 to ws-chek-browse-sw
 17209     end-if
 17210
 17211     .
 17212 2510-exit.
 17213     exit.
 17214
 17215 2520-readnext-erchek.
 17216
 17217
 17218* EXEC CICS READNEXT
 17219*       SET     (ADDRESS OF CHECK-RECORDS)
 17220*       DATASET ('ERCHEK')
 17221*       RIDFLD  (ERCHEK-KEY)
 17222*       RESP    (WS-RESPONSE)
 17223*    END-EXEC
 17224     MOVE 'ERCHEK' TO DFHEIV1
 17225     MOVE 0
 17226       TO DFHEIV11
 17227*    MOVE '&.S                   )  N#00015075' TO DFHEIV0
 17228     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 17229     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 17230     MOVE X'204E233030303135303735' TO DFHEIV0(25:11)
 17231     CALL 'kxdfhei1' USING DFHEIV0,
 17232           DFHEIV1,
 17233           DFHEIV20,
 17234           DFHEIV99,
 17235           ERCHEK-KEY,
 17236           DFHEIV99,
 17237           DFHEIV11,
 17238           DFHEIV99,
 17239           DFHEIV99
 17240     SET ADDRESS OF CHECK-RECORDS TO
 17241         DFHEIV20
 17242     MOVE EIBRESP  TO WS-RESPONSE
 17243     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17244
 17245     .
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 313
* EL6311.cbl
 17246 2520-exit.
 17247     exit.
 17248
 17249 2525-endbr-erchek.
 17250
 17251
 17252* exec cics endbr
 17253*       dataset  ('ERCHEK')
 17254*    end-exec
 17255     MOVE 'ERCHEK' TO DFHEIV1
 17256     MOVE 0
 17257       TO DFHEIV11
 17258*    MOVE '&2                    $   #00015088' TO DFHEIV0
 17259     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 17260     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17261     MOVE X'2020233030303135303838' TO DFHEIV0(25:11)
 17262     CALL 'kxdfhei1' USING DFHEIV0,
 17263           DFHEIV1,
 17264           DFHEIV11,
 17265           DFHEIV99
 17266     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17267
 17268     .
 17269 2525-exit.
 17270     exit.
 17271
 17272 2530-readupd-erchek.
 17273
 17274
 17275* EXEC CICS READ
 17276*       UPDATE
 17277*       SET     (ADDRESS OF CHECK-RECORDS)
 17278*       DATASET ('ERCHEK')
 17279*       RIDFLD  (ERCHEK-KEY)
 17280*       RESP    (WS-RESPONSE)
 17281*    END-EXEC
 17282     MOVE 'ERCHEK' TO DFHEIV1
 17283*    MOVE '&"S        EU         (  N#00015098' TO DFHEIV0
 17284     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17285     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17286     MOVE X'204E233030303135303938' TO DFHEIV0(25:11)
 17287     CALL 'kxdfhei1' USING DFHEIV0,
 17288           DFHEIV1,
 17289           DFHEIV20,
 17290           DFHEIV99,
 17291           ERCHEK-KEY,
 17292           DFHEIV99,
 17293           DFHEIV99,
 17294           DFHEIV99
 17295     SET ADDRESS OF CHECK-RECORDS TO
 17296         DFHEIV20
 17297     MOVE EIBRESP  TO WS-RESPONSE
 17298     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17299
 17300     .
 17301 2530-exit.
 17302     exit.
 17303
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 314
* EL6311.cbl
 17304 2540-delete-erchek.
 17305
 17306
 17307* EXEC CICS DELETE
 17308*       DATASET ('ERCHEK')
 17309*       RESP    (WS-RESPONSE)
 17310*    END-EXEC
 17311     MOVE 'ERCHEK' TO DFHEIV1
 17312*    MOVE '&(                    &  N#00015112' TO DFHEIV0
 17313     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17314     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17315     MOVE X'204E233030303135313132' TO DFHEIV0(25:11)
 17316     CALL 'kxdfhei1' USING DFHEIV0,
 17317           DFHEIV1,
 17318           DFHEIV99,
 17319           DFHEIV99,
 17320           DFHEIV99,
 17321           DFHEIV99
 17322     MOVE EIBRESP  TO WS-RESPONSE
 17323     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17324
 17325     .
 17326 2540-exit.
 17327     exit.
 17328***************************************************************
 17329*                                                             *
 17330*       B U I L D   C O R R E C T I O N   R E C O R D         *
 17331*                                                             *
 17332***************************************************************
 17333
 17334***************************************************************
 17335*     ROUTINE TO CREATE COPY OF ZERO RECORD WHEN CHANGING     *
 17336*     AN ALREADY BILLED RECORD.                               *
 17337***************************************************************
 17338
 17339 2700-BUILD-CORRECTION-RECORD.
 17340     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 17341     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 17342     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 17343     MOVE '5'                    TO DC-OPTION-CODE.
 17344     PERFORM 9700-DATE-LINK.
 17345     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 17346
 17347     IF PB-CHG-COUNT = ZEROS
 17348        MOVE +1                  TO WS-SEQ-SAVE
 17349     ELSE
 17350        ADD +1  PB-CHG-COUNT     TO WS-SEQ-SAVE.
 17351
 17352     COMPUTE PB-BATCH-CHG-SEQ-NO = 1000 - WS-SEQ-SAVE.
 17353     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-ALT-CHG-SEQ-NO.
 17354
 17355     MOVE PB-CONTROL-PRIMARY     TO PB-CONTROL-BY-ORIG-BATCH.
 17356
 17357     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 17358     MOVE 'A'                    TO JP-RECORD-TYPE.
 17359     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17360
 17361
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 315
* EL6311.cbl
 17362* EXEC CICS WRITE
 17363*        DATASET    (FILE-ID-ERPNDB)
 17364*        FROM       (PENDING-BUSINESS)
 17365*        RIDFLD     (PB-CONTROL-PRIMARY)
 17366*    END-EXEC.
 17367     MOVE LENGTH OF
 17368      PENDING-BUSINESS
 17369       TO DFHEIV11
 17370*    MOVE '&$ L                  ''   #00015153' TO DFHEIV0
 17371     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17372     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17373     MOVE X'2020233030303135313533' TO DFHEIV0(25:11)
 17374     CALL 'kxdfhei1' USING DFHEIV0,
 17375           FILE-ID-ERPNDB,
 17376           PENDING-BUSINESS,
 17377           DFHEIV11,
 17378           PB-CONTROL-PRIMARY,
 17379           DFHEIV99,
 17380           DFHEIV99
 17381     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17382
 17383
 17384     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17385
 17386     PERFORM 8400-LOG-JOURNAL-RECORD  *> Journal Add
 17387     .
 17388 2799-EXIT.
 17389      EXIT.
 17390
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 316
* EL6311.cbl
 17392
 17393******************************************************************
 17394*                                                                *
 17395*        R E W R I T E   I S S U E   C E R T.   K E Y            *
 17396*                 'K' transaction                                *
 17397******************************************************************
 17398
 17399 2800-REWRITE-ISSUE-CERT-KEY.
 17400     MOVE  PI-PREV-ALT-KEY       TO  ERPNDB-ALT-KEY.
 17401
 17402     IF  BCERTNOL GREATER THAN ZEROS
 17403         MOVE BCERTNOI           TO  ERPNDB-CERT-PRIME.
 17404
 17405     IF  BSUFIXL  GREATER THAN ZEROS
 17406         MOVE BSUFIXI            TO  ERPNDB-CERT-SFX.
 17407
 17408     IF  BEFFDTL  GREATER THAN ZEROS
 17409         MOVE WS-CONVERTED-EFFDT TO  ERPNDB-CERT-EFF-DT.
 17410     move pi-prev-control-primary to pa-current-key
 17411     move erpndb-alt-key          to pa-new-alt-key
 17412     move spaces                  to pa-return-area
 17413
 17414
 17415* EXEC CICS LINK
 17416*       PROGRAM   ('EL055')
 17417*       COMMAREA  (EL055-PASS-AREA)
 17418*       LENGTH    (256)
 17419*    END-EXEC
 17420     MOVE 'EL055' TO DFHEIV1
 17421     MOVE 256
 17422       TO DFHEIV11
 17423*    MOVE '."C                   (   #00015189' TO DFHEIV0
 17424     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17425     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17426     MOVE X'2020233030303135313839' TO DFHEIV0(25:11)
 17427     CALL 'kxdfhei1' USING DFHEIV0,
 17428           DFHEIV1,
 17429           EL055-PASS-AREA,
 17430           DFHEIV11,
 17431           DFHEIV99,
 17432           DFHEIV99,
 17433           DFHEIV99,
 17434           DFHEIV99
 17435     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17436     if ra-status-code = +99  *> found a claim
 17437        move -1                  to bmaintl
 17438        move al-uabon            to bmainta
 17439        move er-2878             to emi-error
 17440        perform 9900-error-format thru 9900-exit
 17441        go to 8200-send-dataonly
 17442     end-if
 17443
 17444     if ra-status-code = +88  *> found dup cert
 17445        move -1                  to bmaintl
 17446        move al-uabon            to bmainta
 17447        move er-0229             to emi-error
 17448        perform 9900-error-format thru 9900-exit
 17449        go to 8200-send-dataonly
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 317
* EL6311.cbl
 17450     end-if
 17451     GO TO 1325-PROCESS-ISSUE-CHANGES
 17452     .
 17453******************************************************************
 17454*                                                                *
 17455*         R E W R I T E   C A N C E L   C E R T.   K E Y         *
 17456*                                                                *
 17457******************************************************************
 17458
 17459 2900-REWRITE-CAN-CERT-KEY.
 17460     MOVE  PI-PREV-ALT-KEY       TO  ERPNDB-ALT-KEY.
 17461
 17462     IF  CCERTNOL GREATER THAN ZEROS
 17463         MOVE  CCERTNOI          TO  ERPNDB-CERT-PRIME.
 17464
 17465     IF  CSUFIXL  GREATER THAN ZEROS
 17466         MOVE  CSUFIXI           TO  ERPNDB-CERT-SFX.
 17467
 17468     IF  CEFFDTL  GREATER THAN ZEROS
 17469         MOVE WS-CONVERTED-EFFDT TO  ERPNDB-CERT-EFF-DT.
 17470
 17471 2910-READ-BY-ACCOUNT.
 17472
 17473* EXEC CICS HANDLE CONDITION
 17474*         NOTFND    (2920-PROCESS-REWRITE)
 17475*    END-EXEC.
 17476*    MOVE '"$I                   ! = #00015230' TO DFHEIV0
 17477     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17478     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17479     MOVE X'3D20233030303135323330' TO DFHEIV0(25:11)
 17480     CALL 'kxdfhei1' USING DFHEIV0
 17481     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17482
 17483
 17484
 17485* EXEC CICS READ
 17486*        SET     (ADDRESS OF PENDING-BUSINESS)
 17487*        DATASET (FILE-ID-ERPNDB2)
 17488*        RIDFLD  (ERPNDB-ALT-KEY)
 17489*    END-EXEC.
 17490*    MOVE '&"S        E          (   #00015234' TO DFHEIV0
 17491     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17492     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17493     MOVE X'2020233030303135323334' TO DFHEIV0(25:11)
 17494     CALL 'kxdfhei1' USING DFHEIV0,
 17495           FILE-ID-ERPNDB2,
 17496           DFHEIV20,
 17497           DFHEIV99,
 17498           ERPNDB-ALT-KEY,
 17499           DFHEIV99,
 17500           DFHEIV99,
 17501           DFHEIV99
 17502     SET ADDRESS OF PENDING-BUSINESS TO
 17503         DFHEIV20
 17504     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17505
 17506
 17507     GO TO 2990-DUPLICATE-RECORD.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 318
* EL6311.cbl
 17508
 17509  2920-PROCESS-REWRITE.
 17510
 17511* EXEC CICS HANDLE CONDITION
 17512*         NOTFND    (2985-RECORD-MISSING)
 17513*    END-EXEC.
 17514*    MOVE '"$I                   ! > #00015243' TO DFHEIV0
 17515     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17516     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17517     MOVE X'3E20233030303135323433' TO DFHEIV0(25:11)
 17518     CALL 'kxdfhei1' USING DFHEIV0
 17519     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17520
 17521
 17522     MOVE  PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 17523
 17524
 17525* EXEC CICS READ
 17526*        SET     (ADDRESS OF PENDING-BUSINESS)
 17527*        DATASET (FILE-ID-ERPNDB)
 17528*        RIDFLD  (ERPNDB-KEY)
 17529*        UPDATE
 17530*    END-EXEC.
 17531*    MOVE '&"S        EU         (   #00015249' TO DFHEIV0
 17532     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17533     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17534     MOVE X'2020233030303135323439' TO DFHEIV0(25:11)
 17535     CALL 'kxdfhei1' USING DFHEIV0,
 17536           FILE-ID-ERPNDB,
 17537           DFHEIV20,
 17538           DFHEIV99,
 17539           ERPNDB-KEY,
 17540           DFHEIV99,
 17541           DFHEIV99,
 17542           DFHEIV99
 17543     SET ADDRESS OF PENDING-BUSINESS TO
 17544         DFHEIV20
 17545     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17546
 17547
 17548     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 17549     MOVE 'D'                    TO JP-RECORD-TYPE.
 17550     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17551     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17552
 17553     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 17554
 17555     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 17556     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 17557     MOVE PB-SV-STATE            TO ELCERT-STATE.
 17558
 17559
 17560* EXEC CICS DELETE
 17561*        DATASET    (FILE-ID-ERPNDB)
 17562*    END-EXEC.
 17563*    MOVE '&(                    &   #00015267' TO DFHEIV0
 17564     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17565     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 319
* EL6311.cbl
 17566     MOVE X'2020233030303135323637' TO DFHEIV0(25:11)
 17567     CALL 'kxdfhei1' USING DFHEIV0,
 17568           FILE-ID-ERPNDB,
 17569           DFHEIV99,
 17570           DFHEIV99,
 17571           DFHEIV99,
 17572           DFHEIV99
 17573     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17574
 17575
 17576     PERFORM 8400-LOG-JOURNAL-RECORD  *> Journal Cancel Delete
 17577
 17578
 17579* EXEC CICS GETMAIN
 17580*        SET      (ADDRESS OF PENDING-BUSINESS)
 17581*        LENGTH   (ERPNDB-RECORD-LENGTH)
 17582*        INITIMG  (GETMAIN-SPACE)
 17583*    END-EXEC.
 17584*    MOVE ',"IL                  $   #00015273' TO DFHEIV0
 17585     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17586     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17587     MOVE X'2020233030303135323733' TO DFHEIV0(25:11)
 17588     CALL 'kxdfhei1' USING DFHEIV0,
 17589           DFHEIV20,
 17590           ERPNDB-RECORD-LENGTH,
 17591           GETMAIN-SPACE
 17592     SET ADDRESS OF PENDING-BUSINESS TO
 17593         DFHEIV20
 17594     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17595
 17596
 17597     MOVE JP-RECORD-AREA         TO PENDING-BUSINESS.
 17598
 17599 2950-PROCESS-CANCELS.
 17600
 17601
 17602* EXEC CICS HANDLE CONDITION
 17603*         NOTFND  (2960-BUILD-NEW-CANCEL-RECORD)
 17604*    END-EXEC.
 17605*    MOVE '"$I                   ! ? #00015283' TO DFHEIV0
 17606     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17607     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17608     MOVE X'3F20233030303135323833' TO DFHEIV0(25:11)
 17609     CALL 'kxdfhei1' USING DFHEIV0
 17610     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17611
 17612
 17613
 17614* EXEC CICS READ
 17615*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 17616*        DATASET (FILE-ID-ELCERT)
 17617*        RIDFLD  (ELCERT-KEY)
 17618*        UPDATE
 17619*    END-EXEC.
 17620*    MOVE '&"S        EU         (   #00015287' TO DFHEIV0
 17621     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17622     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17623     MOVE X'2020233030303135323837' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 320
* EL6311.cbl
 17624     CALL 'kxdfhei1' USING DFHEIV0,
 17625           FILE-ID-ELCERT,
 17626           DFHEIV20,
 17627           DFHEIV99,
 17628           ELCERT-KEY,
 17629           DFHEIV99,
 17630           DFHEIV99,
 17631           DFHEIV99
 17632     SET ADDRESS OF CERTIFICATE-MASTER TO
 17633         DFHEIV20
 17634     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17635
 17636
 17637     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 17638
 17639     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 17640     MOVE 'B'                      TO JP-RECORD-TYPE.
 17641     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 17642     PERFORM 8400-LOG-JOURNAL-RECORD.
 17643
 17644     IF PB-CI-LIVES NOT NUMERIC
 17645         MOVE ZERO                    TO PB-CI-LIVES.
 17646
 17647     IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 17648        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 17649        MOVE ZERO                     TO CM-LF-ITD-CANCEL-AMT
 17650        MOVE LOW-VALUES               TO CM-LF-CANCEL-EXIT-DT
 17651                                         CM-LF-CANCEL-DT
 17652     ELSE
 17653        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 17654        MOVE PB-CI-LF-CANCEL-AMT      TO CM-LF-ITD-CANCEL-AMT
 17655        MOVE PB-CI-LF-PRIOR-CANCEL-DT TO CM-LF-CANCEL-DT
 17656        MOVE PB-CI-LIVES              TO CM-LIVES.
 17657
 17658     IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 17659        IF CM-LF-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 17660            MOVE CM-LF-STATUS-AT-CANCEL
 17661                                     TO CM-LF-CURRENT-STATUS
 17662            MOVE SPACE
 17663                                     TO CM-LF-STATUS-AT-CANCEL
 17664        ELSE
 17665            MOVE PB-CI-LF-POLICY-STATUS
 17666                                     TO CM-LF-CURRENT-STATUS
 17667     ELSE
 17668        MOVE PB-CI-LF-POLICY-STATUS  TO CM-LF-CURRENT-STATUS.
 17669
 17670     IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 17671        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 17672        MOVE ZERO                     TO CM-AH-ITD-CANCEL-AMT
 17673        MOVE LOW-VALUES               TO CM-AH-CANCEL-EXIT-DT
 17674                                         CM-AH-CANCEL-DT
 17675     ELSE
 17676        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 17677        MOVE PB-CI-AH-CANCEL-AMT      TO CM-AH-ITD-CANCEL-AMT
 17678        MOVE PB-CI-AH-PRIOR-CANCEL-DT TO CM-AH-CANCEL-DT
 17679        MOVE PB-CI-LIVES              TO CM-LIVES.
 17680
 17681     IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 321
* EL6311.cbl
 17682        IF CM-AH-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 17683            MOVE CM-AH-STATUS-AT-CANCEL
 17684                                     TO CM-AH-CURRENT-STATUS
 17685            MOVE SPACE
 17686                                     TO CM-AH-STATUS-AT-CANCEL
 17687        ELSE
 17688            MOVE PB-CI-AH-POLICY-STATUS
 17689                                     TO CM-AH-CURRENT-STATUS
 17690     ELSE
 17691        MOVE PB-CI-AH-POLICY-STATUS  TO CM-AH-CURRENT-STATUS.
 17692
 17693 2975-REWRITE-CERT.
 17694     MOVE 'C'                      TO JP-RECORD-TYPE.
 17695     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 17696
 17697
 17698* EXEC CICS REWRITE
 17699*        DATASET    (FILE-ID-ELCERT)
 17700*        FROM       (CERTIFICATE-MASTER)
 17701*    END-EXEC.
 17702     MOVE LENGTH OF
 17703      CERTIFICATE-MASTER
 17704       TO DFHEIV11
 17705*    MOVE '&& L                  %   #00015354' TO DFHEIV0
 17706     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17707     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17708     MOVE X'2020233030303135333534' TO DFHEIV0(25:11)
 17709     CALL 'kxdfhei1' USING DFHEIV0,
 17710           FILE-ID-ELCERT,
 17711           CERTIFICATE-MASTER,
 17712           DFHEIV11,
 17713           DFHEIV99
 17714     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17715
 17716
 17717     PERFORM 8400-LOG-JOURNAL-RECORD.
 17718
 17719 2960-BUILD-NEW-CANCEL-RECORD.
 17720     IF  CCERTNOL GREATER THAN ZEROS
 17721         MOVE CCERTNOI            TO PB-CERT-PRIME.
 17722
 17723     IF  CSUFIXL  GREATER THAN ZEROS
 17724         MOVE CSUFIXI             TO PB-CERT-SFX.
 17725
 17726     IF  CEFFDTL  GREATER  THAN ZEROS
 17727         MOVE WS-CONVERTED-EFFDT  TO PB-CERT-EFF-DT.
 17728
 17729 2970-WRITE-PENDING-BUSINESS.
 17730     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 17731     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 17732     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 17733     MOVE '5'                    TO DC-OPTION-CODE.
 17734     PERFORM 9700-DATE-LINK.
 17735     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 17736
 17737     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 17738
 17739     MOVE SPACES                 TO PB-CI-INSURED-NAME
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 322
* EL6311.cbl
 17740                                    PB-CI-INSURED-SEX
 17741                                    PB-CI-LF-BENEFIT-CD
 17742                                    PB-CI-AH-BENEFIT-CD
 17743                                    PB-CI-RATE-CLASS
 17744                                    PB-CI-RATE-DEV-LF
 17745                                    PB-CI-RATE-DEV-AH
 17746                                    PB-CI-LF-ABBR
 17747                                    PB-CI-AH-ABBR
 17748                                    PB-CI-OB-FLAG
 17749                                    PB-CI-LF-POLICY-STATUS
 17750                                    PB-CI-AH-POLICY-STATUS
 17751                                    PB-CI-INDV-GRP-CD
 17752                                    PB-CI-BENEFICIARY-NAME
 17753                                    PB-CI-NOTE-SW
 17754                                    PB-CI-SOC-SEC-NO
 17755                                    PB-CI-MEMBER-NO
 17756                                    PB-CI-INT-CODE
 17757                                    PB-CI-COMP-EXCP-SW
 17758                                    PB-CI-ENTRY-STATUS
 17759                                    PB-CI-CREDIT-INTERFACE-SW-1
 17760                                    PB-CI-CREDIT-INTERFACE-SW-2
 17761                                    PB-CI-ENTRY-BATCH.
 17762
 17763     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
 17764                                    PB-CI-AH-SETTLEMENT-DT
 17765                                    PB-CI-DEATH-DT
 17766                                    PB-CI-LF-PRIOR-CANCEL-DT
 17767                                    PB-CI-AH-PRIOR-CANCEL-DT
 17768                                    PB-CI-LOAN-1ST-PMT-DT
 17769                                    PB-CI-ENTRY-DT
 17770                                    PB-CI-LF-EXPIRE-DT
 17771                                    PB-CI-AH-EXPIRE-DT.
 17772
 17773     MOVE ZEROS                  TO PB-CI-INSURED-AGE
 17774                                    PB-CI-LF-TERM
 17775                                    PB-CI-LF-BENEFIT-AMT
 17776                                    PB-CI-LF-ALT-BENEFIT-AMT
 17777                                    PB-CI-LF-PREMIUM-AMT
 17778                                    PB-CI-LF-ALT-PREMIUM-AMT
 17779                                    PB-CI-AH-TERM
 17780                                    PB-CI-AH-BENEFIT-AMT
 17781                                    PB-CI-AH-PREMIUM-AMT
 17782                                    PB-CI-RATE-DEV-PCT-LF
 17783                                    PB-CI-RATE-DEV-PCT-AH
 17784                                    PB-CI-LIFE-COMMISSION
 17785                                    PB-CI-AH-COMMISSION
 17786                                    PB-CI-PAY-FREQUENCY
 17787                                    PB-CI-LOAN-APR
 17788                                    PB-CI-LOAN-TERM
 17789                                    PB-CI-CURR-SEQ
 17790                                    PB-CI-AH-CANCEL-AMT
 17791                                    PB-CI-LF-CANCEL-AMT
 17792                                    PB-CI-EXTENTION-DAYS
 17793                                    PB-CI-TERM-IN-DAYS
 17794                                    PB-CI-LOAN-OFFICER
 17795                                    PB-CI-LIVES
 17796                                    PB-CI-LF-CRIT-PER
 17797                                    PB-CI-AH-CRIT-PER
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 323
* EL6311.cbl
 17798                                    PB-C-LF-REM-TERM
 17799                                    PB-C-AH-REM-TERM.
 17800
 17801     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 17802     MOVE 'A'                    TO JP-RECORD-TYPE.
 17803     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17804
 17805
 17806* EXEC CICS HANDLE CONDITION
 17807*        DUPREC   (2990-DUPLICATE-RECORD)
 17808*    END-EXEC.
 17809*    MOVE '"$%                   ! @ #00015447' TO DFHEIV0
 17810     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 17811     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17812     MOVE X'4020233030303135343437' TO DFHEIV0(25:11)
 17813     CALL 'kxdfhei1' USING DFHEIV0
 17814     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17815
 17816
 17817
 17818* EXEC CICS WRITE
 17819*        DATASET  (FILE-ID-ERPNDB)
 17820*        FROM     (PENDING-BUSINESS)
 17821*        RIDFLD   (PB-CONTROL-PRIMARY)
 17822*    END-EXEC.
 17823     MOVE LENGTH OF
 17824      PENDING-BUSINESS
 17825       TO DFHEIV11
 17826*    MOVE '&$ L                  ''   #00015451' TO DFHEIV0
 17827     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17828     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17829     MOVE X'2020233030303135343531' TO DFHEIV0(25:11)
 17830     CALL 'kxdfhei1' USING DFHEIV0,
 17831           FILE-ID-ERPNDB,
 17832           PENDING-BUSINESS,
 17833           DFHEIV11,
 17834           PB-CONTROL-PRIMARY,
 17835           DFHEIV99,
 17836           DFHEIV99
 17837     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17838
 17839
 17840     MOVE ERPNDB-RECORD-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 17841
 17842     PERFORM 8400-LOG-JOURNAL-RECORD  *> Journal Cancel Add
 17843
 17844     GO TO 2325-PROCESS-CANCEL-CHANGES.
 17845
 17846 2985-RECORD-MISSING.
 17847     MOVE -1                     TO CMAINTL
 17848     MOVE AL-UABON               TO CMAINTA.
 17849
 17850     MOVE ER-2902                TO EMI-ERROR.
 17851     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17852     GO TO 8200-SEND-DATAONLY.
 17853
 17854 2990-DUPLICATE-RECORD.
 17855     MOVE SPACE                  TO CMAINTI.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 324
* EL6311.cbl
 17856     MOVE -1                     TO CMAINTL.
 17857     MOVE AL-UABON               TO CCERTNOA.
 17858     MOVE AL-UNBON               TO CEFFDTA.
 17859
 17860     MOVE 1                      TO EMI-SUB
 17861                                    EMI-SWITCH1
 17862                                    EMI-SWITCH-AREA-1
 17863                                    EMI-SWITCH-AREA-2.
 17864     MOVE SPACES                 TO EMI-ERROR-LINES.
 17865
 17866
 17867* EXEC CICS SYNCPOINT ROLLBACK
 17868*    END-EXEC.
 17869*    MOVE '6"R                   !   #00015483' TO DFHEIV0
 17870     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17871     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17872     MOVE X'2020233030303135343833' TO DFHEIV0(25:11)
 17873     CALL 'kxdfhei1' USING DFHEIV0
 17874     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17875
 17876
 17877     MOVE ER-2247                TO EMI-ERROR.
 17878     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17879     GO TO 8200-SEND-DATAONLY.
 17880
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 325
* EL6311.cbl
 17882
 17883***************************************************************
 17884*     ROUTINE TO CALCULATE THE TOTAL OF ALL GOOD AND BAD      *
 17885*     PREMIUM FOR A SINGLE BATCH.                             *
 17886*         ACTIVATED VIA THE PF3 FROM THE BATCH TOTAL SCREEN.  *
 17887***************************************************************
 17888
 17889 3000-BATCH-MAINLINE.
 17890     IF PI-PREV-KEY NOT = SPACES
 17891         MOVE PI-PREV-KEY        TO ERPNDB-KEY
 17892     ELSE
 17893         MOVE PI-ERPNDB-KEY      TO ERPNDB-KEY.
 17894
 17895     MOVE +1                     TO ERPNDB-BATCH-SEQ-NO.
 17896
 17897 3010-READNEXT.
 17898
 17899* EXEC CICS READ
 17900*         DATASET    (FILE-ID-ERPNDB)
 17901*         SET        (ADDRESS OF PENDING-BUSINESS)
 17902*         RIDFLD     (ERPNDB-KEY)
 17903*         GTEQ
 17904*    END-EXEC.
 17905*    MOVE '&"S        G          (   #00015507' TO DFHEIV0
 17906     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 17907     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17908     MOVE X'2020233030303135353037' TO DFHEIV0(25:11)
 17909     CALL 'kxdfhei1' USING DFHEIV0,
 17910           FILE-ID-ERPNDB,
 17911           DFHEIV20,
 17912           DFHEIV99,
 17913           ERPNDB-KEY,
 17914           DFHEIV99,
 17915           DFHEIV99,
 17916           DFHEIV99
 17917     SET ADDRESS OF PENDING-BUSINESS TO
 17918         DFHEIV20
 17919     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17920
 17921
 17922     IF PB-COMPANY-CD  NOT = ERPNDB-COMPANY-CD OR
 17923        PB-ENTRY-BATCH NOT = ERPNDB-ENTRY-BATCH
 17924          GO TO 3030-END-BATCH.
 17925
 17926     MOVE PB-CONTROL-PRIMARY     TO ERPNDB-KEY.
 17927
 17928     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 17929        PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 17930          GO TO 3020-BUMP-SEQ.
 17931
 17932     IF PB-ISSUE
 17933        ADD +1                   TO WS-ISS-TOTAL-CNT
 17934        IF PB-FATAL-ERRORS
 17935           ADD +1                      TO WS-ISS-FATAL-CNT
 17936           PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 17937           GO TO 3020-BUMP-SEQ
 17938        ELSE
 17939           IF PB-UNFORCED-ERRORS
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 326
* EL6311.cbl
 17940              ADD +1                      TO WS-ISS-FORCE-CNT
 17941              PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 17942              GO TO 3020-BUMP-SEQ
 17943           ELSE
 17944              IF PB-RECORD-ON-HOLD OR PB-RECORD-RETURNED
 17945                 ADD +1                      TO WS-ISS-HOLD-CNT
 17946                 PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 17947                 GO TO 3020-BUMP-SEQ
 17948              ELSE
 17949                 PERFORM 3200-ADD-GOOD-ISSUE-PREM
 17950                     THRU  3299-EXIT
 17951                 GO TO 3020-BUMP-SEQ.
 17952
 17953     IF PB-CANCELLATION
 17954        ADD +1                   TO WS-CAN-TOTAL-CNT
 17955        IF PB-FATAL-ERRORS
 17956           ADD +1                 TO WS-CAN-FATAL-CNT
 17957           PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 17958           GO TO 3020-BUMP-SEQ
 17959        ELSE
 17960           IF PB-UNFORCED-ERRORS
 17961              ADD +1                 TO WS-CAN-FORCE-CNT
 17962              PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 17963              GO TO 3020-BUMP-SEQ
 17964           ELSE
 17965              IF PB-RECORD-ON-HOLD OR PB-RECORD-RETURNED
 17966                 ADD +1                 TO WS-CAN-HOLD-CNT
 17967                 PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 17968                 GO TO 3020-BUMP-SEQ
 17969              ELSE
 17970                 PERFORM 3400-ADD-GOOD-CANCEL-PREM
 17971                     THRU  3499-EXIT
 17972                 GO TO 3020-BUMP-SEQ.
 17973
 17974     IF PB-BATCH-TRAILER
 17975         GO TO 3030-END-BATCH.
 17976
 17977 3020-BUMP-SEQ.
 17978     ADD +1                      TO ERPNDB-BATCH-SEQ-NO.
 17979     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 17980     GO TO 3010-READNEXT.
 17981
 17982 3030-END-BATCH.
 17983     MOVE WS-ISS-TOTAL-CNT       TO DITOTALO.
 17984     MOVE WS-ISS-FATAL-CNT       TO DIFATALO.
 17985     MOVE WS-ISS-FORCE-CNT       TO DIFORCEO.
 17986     MOVE WS-ISS-HOLD-CNT        TO DIHOLDO.
 17987
 17988     COMPUTE DIAVAILO = (WS-ISS-TOTAL-CNT - WS-ISS-FATAL-CNT
 17989                                          - WS-ISS-FORCE-CNT
 17990                                          - WS-ISS-HOLD-CNT).
 17991
 17992     MOVE WS-ISS-GOOD-PREM       TO DIGPREMO.
 17993     MOVE WS-ISS-BAD-PREM        TO DIBPREMO.
 17994
 17995     MOVE WS-CAN-TOTAL-CNT       TO DCTOTALO.
 17996     MOVE WS-CAN-FATAL-CNT       TO DCFATALO.
 17997     MOVE WS-CAN-FORCE-CNT       TO DCFORCEO.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 327
* EL6311.cbl
 17998     MOVE WS-CAN-HOLD-CNT        TO DCHOLDO.
 17999     COMPUTE DCAVAILO = (WS-CAN-TOTAL-CNT - WS-CAN-FATAL-CNT
 18000                                          - WS-CAN-FORCE-CNT
 18001                                          - WS-CAN-HOLD-CNT).
 18002     MOVE WS-CAN-GOOD-PREM       TO DCGPREMO.
 18003     MOVE WS-CAN-BAD-PREM        TO DCBPREMO.
 18004
 18005     COMPUTE WS-NET-TOTAL-CNT
 18006         = WS-ISS-TOTAL-CNT - WS-CAN-TOTAL-CNT.
 18007     MOVE WS-NET-TOTAL-CNT       TO DNTOTALO.
 18008     COMPUTE WS-NET-FATAL-CNT
 18009         = WS-ISS-FATAL-CNT - WS-CAN-FATAL-CNT.
 18010     MOVE WS-NET-FATAL-CNT       TO DNFATALO.
 18011     COMPUTE WS-NET-FORCE-CNT
 18012         = WS-ISS-FORCE-CNT - WS-CAN-FORCE-CNT.
 18013     MOVE WS-NET-FORCE-CNT       TO DNFORCEO.
 18014     COMPUTE WS-NET-HOLD-CNT
 18015         = WS-ISS-HOLD-CNT - WS-CAN-HOLD-CNT.
 18016     MOVE WS-NET-HOLD-CNT        TO DNHOLDO.
 18017
 18018     COMPUTE WS-NET-AVAIL-CNT
 18019          = (WS-ISS-TOTAL-CNT - WS-ISS-FATAL-CNT
 18020                              - WS-ISS-FORCE-CNT
 18021                              - WS-ISS-HOLD-CNT)
 18022          - (WS-CAN-TOTAL-CNT - WS-CAN-FATAL-CNT
 18023                              - WS-CAN-FORCE-CNT
 18024                              - WS-CAN-HOLD-CNT).
 18025     MOVE WS-NET-AVAIL-CNT       TO DNAVAILO.
 18026
 18027     COMPUTE WS-NET-GOOD-PREM
 18028         = WS-ISS-GOOD-PREM - WS-CAN-GOOD-PREM.
 18029     MOVE WS-NET-GOOD-PREM       TO DNGPREMO.
 18030     COMPUTE WS-NET-BAD-PREM
 18031         = WS-ISS-BAD-PREM - WS-CAN-BAD-PREM.
 18032     MOVE WS-NET-BAD-PREM        TO DNBPREMO.
 18033
 18034     MOVE 0000                   TO EMI-ERROR.
 18035     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18036     MOVE -1                     TO DPFENTRL.
 18037     GO TO 8200-SEND-DATAONLY.
 18038
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 328
* EL6311.cbl
 18040
 18041******************************************************************
 18042*                                                                *
 18043*           A D D    B A D   I S S U E   P R E M I U M           *
 18044*                                                                *
 18045******************************************************************
 18046
 18047 3100-ADD-BAD-ISSUE-PREM.
 18048     IF PB-OVERRIDE-LIFE
 18049       OR PB-OVERRIDE-BOTH
 18050           ADD PB-I-LF-PREM-CALC       TO  WS-ISS-BAD-PREM
 18051           ADD PB-I-LF-ALT-PREM-CALC   TO  WS-ISS-BAD-PREM
 18052       ELSE
 18053           ADD PB-I-LF-PREMIUM-AMT     TO  WS-ISS-BAD-PREM
 18054           ADD PB-I-LF-ALT-PREMIUM-AMT TO  WS-ISS-BAD-PREM.
 18055
 18056     IF PB-OVERRIDE-AH
 18057       OR PB-OVERRIDE-BOTH
 18058           ADD PB-I-AH-PREM-CALC       TO  WS-ISS-BAD-PREM
 18059       ELSE
 18060           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-BAD-PREM.
 18061
 18062 3199-EXIT.
 18063     EXIT.
 18064
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 329
* EL6311.cbl
 18066
 18067******************************************************************
 18068*                                                                *
 18069*       A D D   G O O D   I S S U E   P R E M I U M              *
 18070*                                                                *
 18071******************************************************************
 18072
 18073 3200-ADD-GOOD-ISSUE-PREM.
 18074     IF PB-OVERRIDE-LIFE
 18075       OR PB-OVERRIDE-BOTH
 18076           ADD PB-I-LF-PREM-CALC       TO  WS-ISS-GOOD-PREM
 18077           ADD PB-I-LF-ALT-PREM-CALC   TO  WS-ISS-GOOD-PREM
 18078       ELSE
 18079           ADD PB-I-LF-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM
 18080           ADD PB-I-LF-ALT-PREMIUM-AMT TO  WS-ISS-GOOD-PREM.
 18081
 18082     IF PB-OVERRIDE-AH
 18083       OR PB-OVERRIDE-BOTH
 18084           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM
 18085       ELSE
 18086           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM.
 18087
 18088 3299-EXIT.
 18089     EXIT.
 18090
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 330
* EL6311.cbl
 18092
 18093
 18094******************************************************************
 18095*                                                                *
 18096*        A D D   B A D   C A N C E L   P R E M I U M             *
 18097*                                                                *
 18098******************************************************************
 18099
 18100 3300-ADD-BAD-CANCEL-PREM.
 18101     IF PB-OVERRIDE-LIFE
 18102       OR PB-OVERRIDE-BOTH
 18103           ADD PB-C-LF-REF-CALC   TO  WS-CAN-BAD-PREM
 18104       ELSE
 18105           ADD PB-C-LF-CANCEL-AMT TO  WS-CAN-BAD-PREM.
 18106
 18107     IF PB-OVERRIDE-AH
 18108       OR PB-OVERRIDE-BOTH
 18109           ADD PB-C-AH-REF-CALC   TO  WS-CAN-BAD-PREM
 18110       ELSE
 18111           ADD PB-C-AH-CANCEL-AMT TO  WS-CAN-BAD-PREM.
 18112
 18113 3399-EXIT.
 18114     EXIT.
 18115
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 331
* EL6311.cbl
 18117
 18118******************************************************************
 18119*                                                                *
 18120*       A D D   G O O D   C A N C E L   P R E M I U M            *
 18121*                                                                *
 18122******************************************************************
 18123
 18124 3400-ADD-GOOD-CANCEL-PREM.
 18125     IF PB-OVERRIDE-LIFE
 18126       OR PB-OVERRIDE-BOTH
 18127           ADD PB-C-LF-REF-CALC   TO  WS-CAN-GOOD-PREM
 18128       ELSE
 18129           ADD PB-C-LF-CANCEL-AMT TO  WS-CAN-GOOD-PREM.
 18130
 18131     IF PB-OVERRIDE-AH
 18132       OR PB-OVERRIDE-BOTH
 18133           ADD PB-C-AH-REF-CALC   TO  WS-CAN-GOOD-PREM
 18134       ELSE
 18135           ADD PB-C-AH-CANCEL-AMT TO  WS-CAN-GOOD-PREM.
 18136
 18137 3499-EXIT.
 18138     EXIT.
 18139
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 332
* EL6311.cbl
 18141
 18142******************************************************************
 18143*                                                                *
 18144*           E D I T   B A T C H   D A T A                        *
 18145*                                                                *
 18146******************************************************************
 18147
 18148 3500-EDIT-BATCH-DATA.
 18149     IF PI-PREV-KEY NOT = SPACES
 18150        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 18151     ELSE
 18152        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY.
 18153
 18154     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 18155     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 18156
 18157
 18158* EXEC CICS HANDLE CONDITION
 18159*         NOTFND      (3590-NOT-FOUND)
 18160*    END-EXEC.
 18161*    MOVE '"$I                   ! A #00015749' TO DFHEIV0
 18162     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18163     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18164     MOVE X'4120233030303135373439' TO DFHEIV0(25:11)
 18165     CALL 'kxdfhei1' USING DFHEIV0
 18166     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18167
 18168
 18169     IF DRISSL   GREATER THAN ZEROS OR
 18170        DRISSL   GREATER THAN ZEROS OR
 18171        DRLFPRML GREATER THAN ZEROS OR
 18172        DRAHPRML GREATER THAN ZEROS OR
 18173        DRCANCL  GREATER THAN ZEROS OR
 18174        DRLFRFDL GREATER THAN ZEROS OR
 18175        DRAHRFDL GREATER THAN ZEROS
 18176              NEXT SENTENCE
 18177          ELSE
 18178              MOVE ER-3224    TO EMI-ERROR
 18179              MOVE -1         TO DPFENTRL
 18180              MOVE AL-UNBON   TO DPFENTRA
 18181              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18182              GO TO 8200-SEND-DATAONLY.
 18183
 18184     IF NOT MODIFY-CAP
 18185         MOVE 'UPDATE'       TO SM-READ
 18186         PERFORM 9995-SECURITY-VIOLATION
 18187         MOVE ER-0070        TO EMI-ERROR
 18188         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18189         GO TO 8100-SEND-INITIAL-MAP.
 18190
 18191        IF DRISSL GREATER THAN ZEROS
 18192           MOVE AL-UNNON         TO DRISSA
 18193           MOVE DRISSI           TO DEEDIT-FIELD
 18194           PERFORM 8600-DEEDIT
 18195           IF DEEDIT-FIELD-V0  NUMERIC
 18196              MOVE DEEDIT-FIELD-V0 TO WS-DRISS
 18197           ELSE
 18198              MOVE ER-2223    TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 333
* EL6311.cbl
 18199              MOVE -1         TO DRISSL
 18200              MOVE AL-UNBON   TO DRISSA
 18201              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18202
 18203        IF DRLFPRML GREATER THAN ZEROS
 18204           MOVE AL-UNNON         TO DRLFPRMA
 18205
 18206* EXEC CICS BIF DEEDIT
 18207*              FIELD  (DRLFPRMI)
 18208*              LENGTH (11)
 18209*          END-EXEC
 18210     MOVE 11
 18211       TO DFHEIV11
 18212*    MOVE '@"L                   #   #00015789' TO DFHEIV0
 18213     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18214     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18215     MOVE X'2020233030303135373839' TO DFHEIV0(25:11)
 18216     CALL 'kxdfhei1' USING DFHEIV0,
 18217           DRLFPRMI,
 18218           DFHEIV11
 18219     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18220           IF DRLFPRMI NUMERIC
 18221              MOVE DRLFPRMI   TO WS-DRLFPRM
 18222*          MOVE DRLFPRMI         TO DEEDIT-FIELD
 18223*          PERFORM 8600-DEEDIT
 18224*          IF DEEDIT-FIELD-V2  NUMERIC
 18225*             MOVE DEEDIT-FIELD-V2 TO WS-DRLFPRM
 18226           ELSE
 18227              MOVE ER-2223    TO EMI-ERROR
 18228              MOVE -1         TO DRLFPRML
 18229              MOVE AL-UNBON   TO DRLFPRMA
 18230              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18231
 18232        IF DRAHPRML GREATER THAN ZEROS
 18233           MOVE AL-UNNON         TO DRAHPRMA
 18234
 18235* EXEC CICS BIF DEEDIT
 18236*              FIELD  (DRAHPRMI)
 18237*              LENGTH (11)
 18238*          END-EXEC
 18239     MOVE 11
 18240       TO DFHEIV11
 18241*    MOVE '@"L                   #   #00015807' TO DFHEIV0
 18242     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18243     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18244     MOVE X'2020233030303135383037' TO DFHEIV0(25:11)
 18245     CALL 'kxdfhei1' USING DFHEIV0,
 18246           DRAHPRMI,
 18247           DFHEIV11
 18248     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18249           IF DRAHPRMI NUMERIC
 18250              MOVE DRAHPRMI   TO WS-DRAHPRM
 18251*          MOVE DRAHPRMI         TO DEEDIT-FIELD
 18252*          PERFORM 8600-DEEDIT
 18253*          IF DEEDIT-FIELD-V2  NUMERIC
 18254*             MOVE DEEDIT-FIELD-V2 TO WS-DRAHPRM
 18255           ELSE
 18256              MOVE ER-2223    TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 334
* EL6311.cbl
 18257              MOVE -1         TO DRAHPRML
 18258              MOVE AL-UNBON   TO DRAHPRMA
 18259              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18260
 18261        IF DRCANCL GREATER THAN ZEROS
 18262           MOVE AL-UNNON         TO DRCANCA
 18263           MOVE DRCANCI          TO DEEDIT-FIELD
 18264           PERFORM 8600-DEEDIT
 18265           IF DEEDIT-FIELD-V0  NUMERIC
 18266              MOVE DEEDIT-FIELD-V0 TO WS-DRCANC
 18267           ELSE
 18268              MOVE ER-2223    TO EMI-ERROR
 18269              MOVE -1         TO DRCANCL
 18270              MOVE AL-UNBON   TO DRCANCL
 18271              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18272
 18273        IF DRLFRFDL GREATER THAN ZEROS
 18274           MOVE AL-UNNON         TO DRLFRFDA
 18275
 18276* EXEC CICS BIF DEEDIT
 18277*              FIELD  (DRLFRFDI)
 18278*              LENGTH (11)
 18279*          END-EXEC
 18280     MOVE 11
 18281       TO DFHEIV11
 18282*    MOVE '@"L                   #   #00015837' TO DFHEIV0
 18283     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18284     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18285     MOVE X'2020233030303135383337' TO DFHEIV0(25:11)
 18286     CALL 'kxdfhei1' USING DFHEIV0,
 18287           DRLFRFDI,
 18288           DFHEIV11
 18289     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18290           IF DRLFRFDI NUMERIC
 18291              MOVE DRLFRFDI   TO WS-DRLFRFD
 18292*          MOVE DRLFRFDI         TO DEEDIT-FIELD
 18293*          PERFORM 8600-DEEDIT
 18294*          IF DEEDIT-FIELD-V2  NUMERIC
 18295*             MOVE DEEDIT-FIELD-V2 TO WS-DRLFRFD
 18296           ELSE
 18297              MOVE ER-2223    TO EMI-ERROR
 18298              MOVE -1         TO DRLFRFDL
 18299              MOVE AL-UNBON   TO DRLFRFDA
 18300              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18301
 18302        IF DRAHRFDL GREATER THAN ZEROS
 18303           MOVE AL-UNNON         TO DRAHRFDA
 18304
 18305* EXEC CICS BIF DEEDIT
 18306*              FIELD  (DRAHRFDI)
 18307*              LENGTH (11)
 18308*          END-EXEC
 18309     MOVE 11
 18310       TO DFHEIV11
 18311*    MOVE '@"L                   #   #00015855' TO DFHEIV0
 18312     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18313     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18314     MOVE X'2020233030303135383535' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 335
* EL6311.cbl
 18315     CALL 'kxdfhei1' USING DFHEIV0,
 18316           DRAHRFDI,
 18317           DFHEIV11
 18318     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18319           IF DRAHRFDI NUMERIC
 18320              MOVE DRAHRFDI   TO WS-DRAHRFD
 18321*          MOVE DRAHRFDI         TO DEEDIT-FIELD
 18322*          PERFORM 8600-DEEDIT
 18323*          IF DEEDIT-FIELD-V2  NUMERIC
 18324*             MOVE DEEDIT-FIELD-V2 TO WS-DRAHRFD
 18325           ELSE
 18326              MOVE ER-2223    TO EMI-ERROR
 18327              MOVE -1         TO DRAHRFDL
 18328              MOVE AL-UNBON   TO DRAHRFDA
 18329              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18330
 18331     IF EMI-ERROR = ZEROS
 18332        GO 3600-UPDATE-BATCH-HEADER.
 18333
 18334     GO TO 8200-SEND-DATAONLY.
 18335
 18336 3590-NOT-FOUND.
 18337     MOVE ER-2192                TO EMI-ERROR.
 18338     MOVE -1                     TO DPFENTRL.
 18339     MOVE AL-UNBON               TO DPFENTRA.
 18340     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18341     GO TO 8200-SEND-DATAONLY.
 18342
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 336
* EL6311.cbl
 18344
 18345******************************************************************
 18346*                                                                *
 18347*           U P D A T E   B A T C H   H E A D E R                *
 18348*                                                                *
 18349******************************************************************
 18350
 18351 3600-UPDATE-BATCH-HEADER.
 18352
 18353* EXEC CICS HANDLE CONDITION
 18354*         NOTFND      (3690-NOT-FOUND)
 18355*    END-EXEC.
 18356*    MOVE '"$I                   ! B #00015892' TO DFHEIV0
 18357     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18358     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18359     MOVE X'4220233030303135383932' TO DFHEIV0(25:11)
 18360     CALL 'kxdfhei1' USING DFHEIV0
 18361     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18362
 18363
 18364
 18365* EXEC CICS READ
 18366*        DATASET (FILE-ID-ERPNDB)
 18367*        RIDFLD  (ERPNDB-KEY)
 18368*        SET     (ADDRESS OF PENDING-BUSINESS)
 18369*        UPDATE
 18370*    END-EXEC.
 18371*    MOVE '&"S        EU         (   #00015896' TO DFHEIV0
 18372     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18373     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 18374     MOVE X'2020233030303135383936' TO DFHEIV0(25:11)
 18375     CALL 'kxdfhei1' USING DFHEIV0,
 18376           FILE-ID-ERPNDB,
 18377           DFHEIV20,
 18378           DFHEIV99,
 18379           ERPNDB-KEY,
 18380           DFHEIV99,
 18381           DFHEIV99,
 18382           DFHEIV99
 18383     SET ADDRESS OF PENDING-BUSINESS TO
 18384         DFHEIV20
 18385     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18386
 18387
 18388     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 18389     MOVE 'B'                    TO JP-RECORD-TYPE.
 18390     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 18391
 18392     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 18393
 18394     PERFORM 8400-LOG-JOURNAL-RECORD  *> Before BHDR Image
 18395
 18396     IF DRISSL GREATER THAN ZEROS
 18397        MOVE WS-DRISS            TO PB-B-ISSUE-CNT-REMITTED.
 18398
 18399     IF DRCANCL GREATER THAN ZEROS
 18400        MOVE WS-DRCANC           TO PB-B-CANCEL-CNT-REMITTED.
 18401
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 337
* EL6311.cbl
 18402
 18403     IF DRLFPRML GREATER THAN ZEROS
 18404        MOVE WS-DRLFPRM       TO PB-B-LF-ISS-PRM-REMITTED.
 18405
 18406     IF DRAHPRML GREATER THAN ZEROS
 18407        MOVE WS-DRAHPRM       TO PB-B-AH-ISS-PRM-REMITTED.
 18408
 18409     IF DRLFRFDL GREATER THAN ZEROS
 18410        MOVE WS-DRLFRFD       TO PB-B-LF-CAN-PRM-REMITTED.
 18411
 18412     IF DRAHRFDL GREATER THAN ZEROS
 18413        MOVE WS-DRAHRFD       TO PB-B-AH-CAN-PRM-REMITTED.
 18414
 18415 3670-REWRITE-BATCH-HEADER.
 18416     IF PB-B-ISSUE-CNT-REMITTED  =  PB-B-ISSUE-CNT-ENTERED   AND
 18417        PB-B-LF-ISS-PRM-ENTERED  =  PB-B-LF-ISS-PRM-REMITTED AND
 18418        PB-B-AH-ISS-PRM-ENTERED  =  PB-B-AH-ISS-PRM-REMITTED AND
 18419        PB-B-CANCEL-CNT-REMITTED =  PB-B-CANCEL-CNT-ENTERED  AND
 18420        PB-B-LF-CAN-PRM-ENTERED  =  PB-B-LF-CAN-PRM-REMITTED AND
 18421        PB-B-AH-CAN-PRM-ENTERED  =  PB-B-AH-CAN-PRM-REMITTED
 18422        MOVE SPACE               TO PB-OUT-BAL-CD
 18423     ELSE
 18424        MOVE 'O'                 TO PB-OUT-BAL-CD.
 18425
 18426     MOVE 'C'                    TO JP-RECORD-TYPE.
 18427     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 18428
 18429
 18430* EXEC CICS REWRITE
 18431*         DATASET      (FILE-ID-ERPNDB)
 18432*         FROM         (PENDING-BUSINESS)
 18433*    END-EXEC.
 18434     MOVE LENGTH OF
 18435      PENDING-BUSINESS
 18436       TO DFHEIV11
 18437*    MOVE '&& L                  %   #00015944' TO DFHEIV0
 18438     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 18439     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 18440     MOVE X'2020233030303135393434' TO DFHEIV0(25:11)
 18441     CALL 'kxdfhei1' USING DFHEIV0,
 18442           FILE-ID-ERPNDB,
 18443           PENDING-BUSINESS,
 18444           DFHEIV11,
 18445           DFHEIV99
 18446     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18447
 18448
 18449     PERFORM 8400-LOG-JOURNAL-RECORD  *> After BHDR Image
 18450
 18451     GO TO 7200-DISPLAY-BATCHES.
 18452
 18453 3690-NOT-FOUND.
 18454     MOVE ER-2192                TO EMI-ERROR.
 18455     MOVE -1                     TO DPFENTRL.
 18456     MOVE AL-UNBON               TO DPFENTRA.
 18457     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18458     GO TO 8200-SEND-DATAONLY.
 18459
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 338
* EL6311.cbl
 18461
 18462******************************************************************
 18463*                                                                *
 18464*           R E - D I S P L A Y   R E C O R D                    *
 18465*                                                                *
 18466******************************************************************
 18467
 18468 3900-RE-DISPLAY-RECORD.
 18469
 18470* EXEC CICS HANDLE CONDITION
 18471*         NOTFND   (3990-NOT-FOUND)
 18472*    END-EXEC.
 18473*    MOVE '"$I                   ! C #00015969' TO DFHEIV0
 18474     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18475     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18476     MOVE X'4320233030303135393639' TO DFHEIV0(25:11)
 18477     CALL 'kxdfhei1' USING DFHEIV0
 18478     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18479
 18480
 18481     IF PI-DISPLAY-ORIGINAL-BATCH
 18482         MOVE FILE-ID-ERPNDB3     TO FILE-ID
 18483     ELSE
 18484         MOVE FILE-ID-ERPNDB      TO FILE-ID.
 18485
 18486
 18487* EXEC CICS READ
 18488*         DATASET   (FILE-ID)
 18489*         RIDFLD    (PI-PREV-KEY)
 18490*         SET       (ADDRESS OF PENDING-BUSINESS)
 18491*    END-EXEC.
 18492*    MOVE '&"S        E          (   #00015978' TO DFHEIV0
 18493     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18494     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18495     MOVE X'2020233030303135393738' TO DFHEIV0(25:11)
 18496     CALL 'kxdfhei1' USING DFHEIV0,
 18497           FILE-ID,
 18498           DFHEIV20,
 18499           DFHEIV99,
 18500           PI-PREV-KEY,
 18501           DFHEIV99,
 18502           DFHEIV99,
 18503           DFHEIV99
 18504     SET ADDRESS OF PENDING-BUSINESS TO
 18505         DFHEIV20
 18506     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18507
 18508
 18509     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 18510
 18511     IF PB-ISSUE
 18512         GO TO 7000-DISPLAY-ISSUES.
 18513
 18514     IF PB-CANCELLATION
 18515         GO TO 7100-DISPLAY-CANCELS.
 18516
 18517     IF PB-BATCH-TRAILER
 18518         GO TO 7200-DISPLAY-BATCHES.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 339
* EL6311.cbl
 18519
 18520 3990-NOT-FOUND.
 18521     MOVE LOW-VALUES             TO EL631BI.
 18522
 18523     IF PI-MAP-NAME = EL631B
 18524         MOVE -1                  TO BMAINTL
 18525     ELSE
 18526         MOVE -1                  TO CMAINTL.
 18527
 18528     GO TO 8100-SEND-INITIAL-MAP.
 18529
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 340
* EL6311.cbl
 18531
 18532***************************************************************
 18533*     FORWARD BROWSING ROUTINE   (BY ALTERNATE KEY)           *
 18534*                                                             *
 18535*      1. START BROWSE WITH                                   *
 18536*         A. FIRST RECORD SPECIFIED FROM FIRST SCREEN         *
 18537*         B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN       *
 18538*         C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.       *
 18539*                                                             *
 18540*      2. READ RECORDS AND DETERMINE IF THEY ARE TO BE        *
 18541*         DISPLAYED BY USING THE FOLLOWING CHECKS.            *
 18542*         A. IS IT WITHIN THE SAME KEY GROUP?                 *
 18543*         B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED. *
 18544*         C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM   *
 18545*               AND IS IT TO BE DISPLAYED.                    *
 18546*         D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE        *
 18547*               DISPLAYED.                                    *
 18548*         E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE       *
 18549*               DISPLAYED.                                    *
 18550*                                                             *
 18551*      3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE      *
 18552*               RECORD KEY AND GO TO THE DISPLAY ROUTINE.     *
 18553***************************************************************
 18554
 18555 4000-BROWSE-DETAIL-FORWARD.
 18556     IF FIRST-TIME
 18557        MOVE PI-ERPNDB-ALT-KEY      TO ERPNDB-ALT-KEY
 18558     ELSE
 18559        IF SHOW-RECORD
 18560           MOVE PI-ERPNDB-ALT-KEY   TO ERPNDB-ALT-KEY
 18561           MOVE WS-NEW-CERT-NO      TO ERPNDB-CERT-NO
 18562           MOVE WS-NEW-CERT-EFF-DT  TO ERPNDB-CERT-EFF-DT
 18563           MOVE LOW-VALUES          TO ERPNDB-RECORD-TYPE
 18564           MOVE ZEROS               TO ERPNDB-ALT-CHG-SEQ-NO
 18565        ELSE
 18566           MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY.
 18567
 18568
 18569* EXEC CICS HANDLE CONDITION
 18570*         NOTFND   (4050-END-RECORDS)
 18571*         ENDFILE  (4050-END-RECORDS)
 18572*    END-EXEC.
 18573*    MOVE '"$I''                  ! D #00016043' TO DFHEIV0
 18574     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18575     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18576     MOVE X'4420233030303136303433' TO DFHEIV0(25:11)
 18577     CALL 'kxdfhei1' USING DFHEIV0
 18578     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18579
 18580
 18581
 18582* EXEC CICS STARTBR
 18583*         DATASET   (FILE-ID-ERPNDB2)
 18584*         RIDFLD    (ERPNDB-ALT-KEY)
 18585*    END-EXEC.
 18586     MOVE 0
 18587       TO DFHEIV11
 18588*    MOVE '&,         G          &   #00016048' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 341
* EL6311.cbl
 18589     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18590     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18591     MOVE X'2020233030303136303438' TO DFHEIV0(25:11)
 18592     CALL 'kxdfhei1' USING DFHEIV0,
 18593           FILE-ID-ERPNDB2,
 18594           ERPNDB-ALT-KEY,
 18595           DFHEIV99,
 18596           DFHEIV11,
 18597           DFHEIV99
 18598     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18599
 18600
 18601     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 18602
 18603     IF FIRST-TIME OR SHOW-RECORD
 18604        MOVE SPACE               TO WS-FIRST-TIME-SW
 18605        GO TO 4005-READ-NEXT-RECORD.
 18606
 18607
 18608* EXEC CICS READNEXT
 18609*         DATASET    (FILE-ID-ERPNDB2)
 18610*         SET        (ADDRESS OF PENDING-BUSINESS)
 18611*         RIDFLD     (ERPNDB-ALT-KEY)
 18612*    END-EXEC.
 18613     MOVE 0
 18614       TO DFHEIV11
 18615*    MOVE '&.S                   )   #00016059' TO DFHEIV0
 18616     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18617     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18618     MOVE X'2020233030303136303539' TO DFHEIV0(25:11)
 18619     CALL 'kxdfhei1' USING DFHEIV0,
 18620           FILE-ID-ERPNDB2,
 18621           DFHEIV20,
 18622           DFHEIV99,
 18623           ERPNDB-ALT-KEY,
 18624           DFHEIV99,
 18625           DFHEIV11,
 18626           DFHEIV99,
 18627           DFHEIV99
 18628     SET ADDRESS OF PENDING-BUSINESS TO
 18629         DFHEIV20
 18630     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18631
 18632
 18633 4005-READ-NEXT-RECORD.
 18634
 18635* EXEC CICS READNEXT
 18636*         DATASET    (FILE-ID-ERPNDB2)
 18637*         SET        (ADDRESS OF PENDING-BUSINESS)
 18638*         RIDFLD     (ERPNDB-ALT-KEY)
 18639*    END-EXEC.
 18640     MOVE 0
 18641       TO DFHEIV11
 18642*    MOVE '&.S                   )   #00016066' TO DFHEIV0
 18643     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18644     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18645     MOVE X'2020233030303136303636' TO DFHEIV0(25:11)
 18646     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 342
* EL6311.cbl
 18647           FILE-ID-ERPNDB2,
 18648           DFHEIV20,
 18649           DFHEIV99,
 18650           ERPNDB-ALT-KEY,
 18651           DFHEIV99,
 18652           DFHEIV11,
 18653           DFHEIV99,
 18654           DFHEIV99
 18655     SET ADDRESS OF PENDING-BUSINESS TO
 18656         DFHEIV20
 18657     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18658
 18659
 18660     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 18661
 18662     IF WS-BATCH-PREFIX = '#CL'
 18663        GO TO 4005-READ-NEXT-RECORD.
 18664
 18665     IF SHOW-RECORD
 18666        IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD        OR
 18667           PB-CARRIER       NOT = PI-PB-CARRIER        OR
 18668           PB-GROUPING      NOT = PI-PB-GROUPING       OR
 18669           PB-STATE         NOT = PI-PB-STATE          OR
 18670           PB-ACCOUNT       NOT = PI-PB-ACCOUNT        OR
 18671           PB-CERT-EFF-DT   NOT = WS-NEW-CERT-EFF-DT   OR
 18672           PB-CERT-NO       NOT = WS-NEW-CERT-NO
 18673           GO TO 4050-END-RECORDS
 18674        ELSE
 18675           GO TO 4010-CHECK-REC-TYPE.
 18676
 18677     IF PB-COMPANY-CD-A1    NOT = PI-COMPANY-CD        OR
 18678        PB-CARRIER          NOT = PI-PB-CARRIER        OR
 18679        PB-GROUPING         NOT = PI-PB-GROUPING       OR
 18680        PB-STATE            NOT = PI-PB-STATE          OR
 18681        PB-ACCOUNT          NOT = PI-PB-ACCOUNT
 18682        GO TO 4050-END-RECORDS.
 18683
 18684     IF PB-BATCH-TRAILER
 18685        GO TO 4005-READ-NEXT-RECORD.
 18686
 18687     IF PI-PB-CERT-NO NOT = LOW-VALUES
 18688        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 18689           GO TO 4005-READ-NEXT-RECORD
 18690        ELSE
 18691           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 18692              GO TO 4010-CHECK-REC-TYPE
 18693           ELSE
 18694              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 18695                 GO TO 4010-CHECK-REC-TYPE
 18696              ELSE
 18697                 GO TO 4005-READ-NEXT-RECORD.
 18698
 18699     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 18700        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 18701           GO TO 4005-READ-NEXT-RECORD.
 18702
 18703 4010-CHECK-REC-TYPE.
 18704     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 343
* EL6311.cbl
 18705         IF  PB-CARRIER = PI-CARRIER-SECURITY
 18706             NEXT SENTENCE
 18707         ELSE
 18708             GO TO 4005-READ-NEXT-RECORD.
 18709
 18710     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 18711         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 18712             NEXT SENTENCE
 18713        ELSE
 18714             GO TO 4005-READ-NEXT-RECORD.
 18715
 18716     IF NOT DISPLAY-CHANGE-RECORDS AND
 18717            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 18718        GO TO 4005-READ-NEXT-RECORD.
 18719
 18720     IF DISPLAY-HOLD-RECORDS AND
 18721        NOT PB-RECORD-ON-HOLD
 18722          GO TO 4005-READ-NEXT-RECORD.
 18723
 18724     IF PB-ISSUE
 18725        IF DISPLAY-CHK-REQ-RECORDS
 18726            GO TO 4005-READ-NEXT-RECORD.
 18727
 18728     IF PB-ISSUE
 18729        IF ISSUE-WITH-WARNING
 18730           IF PB-WARNING-ERRORS
 18731              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18732                  GO TO 4005-READ-NEXT-RECORD
 18733              ELSE
 18734                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18735                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18736                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18737                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18738                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18739                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18740                 GO TO 7000-DISPLAY-ISSUES
 18741           ELSE
 18742              GO TO 4005-READ-NEXT-RECORD.
 18743
 18744     IF PB-ISSUE
 18745        IF (ISSUES-IN-ERROR AND
 18746            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18747            ALL-ISSUES
 18748            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18749            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18750            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18751            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18752            MOVE PB-SV-STATE            TO PI-SV-STATE
 18753            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18754            GO TO 7000-DISPLAY-ISSUES
 18755        ELSE
 18756            GO TO 4005-READ-NEXT-RECORD.
 18757
 18758     IF PB-CANCELLATION
 18759        IF DISPLAY-CHK-REQ-RECORDS
 18760           IF PB-C-REFUND-REQUESTED
 18761              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18762              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 344
* EL6311.cbl
 18763              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18764              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18765              MOVE PB-SV-STATE            TO PI-SV-STATE
 18766              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18767              GO TO 7100-DISPLAY-CANCELS
 18768           ELSE
 18769               GO TO 4005-READ-NEXT-RECORD.
 18770
 18771     IF PB-CANCELLATION
 18772        IF CANCEL-WITH-WARNING
 18773           IF PB-WARNING-ERRORS
 18774              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18775                  GO TO 4005-READ-NEXT-RECORD
 18776              ELSE
 18777                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18778                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18779                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18780                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18781                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18782                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18783                 GO TO 7100-DISPLAY-CANCELS
 18784           ELSE
 18785              GO TO 4005-READ-NEXT-RECORD.
 18786
 18787     IF PB-CANCELLATION
 18788        IF (CANCEL-IN-ERROR  AND
 18789            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18790            ALL-CANCELS
 18791            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18792            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18793            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18794            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18795            MOVE PB-SV-STATE            TO PI-SV-STATE
 18796            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18797            GO TO 7100-DISPLAY-CANCELS.
 18798
 18799     GO TO 4005-READ-NEXT-RECORD.
 18800
 18801 4050-END-RECORDS.
 18802******************************************************************
 18803*                                                                *
 18804*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 18805*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING
 18806*         PROGRAM.                                               *
 18807*                                                                *
 18808******************************************************************
 18809
 18810     IF BROWSE-STARTED
 18811        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 18812
 18813* EXEC CICS ENDBR
 18814*            DATASET  (FILE-ID-ERPNDB2)
 18815*       END-EXEC.
 18816     MOVE 0
 18817       TO DFHEIV11
 18818*    MOVE '&2                    $   #00016224' TO DFHEIV0
 18819     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18820     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 345
* EL6311.cbl
 18821     MOVE X'2020233030303136323234' TO DFHEIV0(25:11)
 18822     CALL 'kxdfhei1' USING DFHEIV0,
 18823           FILE-ID-ERPNDB2,
 18824           DFHEIV11,
 18825           DFHEIV99
 18826     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18827
 18828
 18829     IF  EIBTRNID NOT = TRANS-EXB1
 18830         IF PENDING-BUS-RECS-FOUND
 18831             NEXT SENTENCE
 18832           ELSE
 18833             MOVE '9'            TO PI-BROWSE-SW
 18834             GO TO 9400-CLEAR.
 18835
 18836     IF SHOW-RECORD
 18837        MOVE ER-2253            TO EMI-ERROR
 18838       ELSE
 18839        MOVE ER-2254            TO EMI-ERROR.
 18840
 18841     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18842
 18843     IF PI-MAP-NAME = SPACES
 18844        MOVE -1                  TO DPFENTRL
 18845        MOVE EL631D               TO PI-MAP-NAME
 18846        GO TO 8100-SEND-INITIAL-MAP.
 18847
 18848     IF PI-MAP-NAME = EL631B
 18849        MOVE -1                  TO BMAINTL
 18850     ELSE
 18851        IF PI-MAP-NAME = EL631C
 18852           MOVE -1               TO CMAINTL
 18853        ELSE
 18854           MOVE -1               TO DPFENTRL.
 18855
 18856     GO TO 8200-SEND-DATAONLY.
 18857
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 346
* EL6311.cbl
 18859
 18860***************************************************************
 18861*                                                             *
 18862*     FORWARD BROWSING ROUTINE   (BY BATCH)                   *
 18863*                                                             *
 18864*       1. READ RECORDS WITHIN THE BATCH BASED ON             *
 18865*          A. FIRST TIME INTO PROGRAM FROM FIRST SCREEN       *
 18866*          B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN      *
 18867*          C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.      *
 18868*                                                             *
 18869*       2. READ RECORDS AND DETERMINE IF THEY ARE TO BE       *
 18870*          DISPLAYED BY USING THE FOLLOWING CHECKS.           *
 18871*          A. IS IT WITHIN THE SAME KEY GROUP?                *
 18872*          B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED.*
 18873*          C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM  *
 18874*                AND IS IT TO BE DISPLAYED.                   *
 18875*          D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE       *
 18876*                DISPLAYED.                                   *
 18877*          E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE      *
 18878*                DISPLAYED.                                   *
 18879*                                                             *
 18880*       3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE     *
 18881*                RECORD KEY AND GO TO THE DISPLAY ROUTINE.    *
 18882*                                                             *
 18883*       4. WHEN READING ADDITION RECORDS ADJUSTMENTS MUST BE  *
 18884*                MADE TO BYPASS THE CORRECTION RECORDS IF     *
 18885*                THEY ARE NOT TO BE DISPLAYED.                *
 18886*                                                             *
 18887***************************************************************
 18888
 18889 4100-BROWSE-PRIMARY-FORWARD.
 18890     IF FIRST-TIME  OR SHOW-RECORD
 18891        MOVE PI-ERPNDB-KEY         TO ERPNDB-KEY
 18892        MOVE +1                    TO ERPNDB-BATCH-SEQ-NO
 18893        MOVE ZEROS                 TO ERPNDB-BATCH-CHG-SEQ-NO
 18894     ELSE
 18895        MOVE PI-PREV-KEY           TO ERPNDB-KEY
 18896        IF ERPNDB-BATCH-SEQ-NO = +9999
 18897           GO TO 4150-END-BATCH
 18898        ELSE
 18899           IF DISPLAY-CHANGE-RECORDS
 18900              ADD +1             TO ERPNDB-BATCH-CHG-SEQ-NO
 18901           ELSE
 18902              MOVE ZEROS         TO ERPNDB-BATCH-CHG-SEQ-NO
 18903              ADD +1             TO ERPNDB-BATCH-SEQ-NO.
 18904
 18905     IF FIRST-TIME
 18906         IF ERPNDB-BATCH-SEQ-NO = +1  AND
 18907            PI-PB-BATCH-SEQ-NO NOT = ZERO
 18908              MOVE PI-PB-BATCH-SEQ-NO TO ERPNDB-BATCH-SEQ-NO.
 18909
 18910
 18911* EXEC CICS HANDLE CONDITION
 18912*         ENDFILE  (4150-END-BATCH)
 18913*    END-EXEC.
 18914*    MOVE '"$''                   ! E #00016309' TO DFHEIV0
 18915     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 18916     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 347
* EL6311.cbl
 18917     MOVE X'4520233030303136333039' TO DFHEIV0(25:11)
 18918     CALL 'kxdfhei1' USING DFHEIV0
 18919     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18920
 18921
 18922 4105-READ-NEXT.
 18923
 18924* EXEC CICS HANDLE CONDITION
 18925*         NOTFND    (4150-END-BATCH)
 18926*    END-EXEC.
 18927*    MOVE '"$I                   ! F #00016314' TO DFHEIV0
 18928     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18929     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18930     MOVE X'4620233030303136333134' TO DFHEIV0(25:11)
 18931     CALL 'kxdfhei1' USING DFHEIV0
 18932     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18933
 18934
 18935     MOVE SPACES                 TO WS-REC-FOUND-SW.
 18936
 18937     IF PI-DISPLAY-ORIGINAL-BATCH
 18938        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 18939     ELSE
 18940        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 18941
 18942
 18943* EXEC CICS READ
 18944*         DATASET   (FILE-ID)
 18945*         SET       (ADDRESS OF PENDING-BUSINESS)
 18946*         RIDFLD    (ERPNDB-KEY)
 18947*         GTEQ
 18948*    END-EXEC.
 18949*    MOVE '&"S        G          (   #00016325' TO DFHEIV0
 18950     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 18951     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18952     MOVE X'2020233030303136333235' TO DFHEIV0(25:11)
 18953     CALL 'kxdfhei1' USING DFHEIV0,
 18954           FILE-ID,
 18955           DFHEIV20,
 18956           DFHEIV99,
 18957           ERPNDB-KEY,
 18958           DFHEIV99,
 18959           DFHEIV99,
 18960           DFHEIV99
 18961     SET ADDRESS OF PENDING-BUSINESS TO
 18962         DFHEIV20
 18963     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18964
 18965
 18966     IF PI-DISPLAY-ORIGINAL-BATCH
 18967        IF (PB-ORIGINAL-COMPANY-CD  NOT = PI-COMPANY-CD) OR
 18968           (PB-ORIGINAL-ENTRY-BATCH NOT = PI-PB-ENTRY-BATCH)
 18969           GO TO 4150-END-BATCH
 18970        ELSE
 18971           IF PB-BATCH-TRAILER
 18972              MOVE HIGH-VALUES   TO ERPNDB-BATCH-SEQ-ALPHA
 18973              GO TO 4105-READ-NEXT
 18974           ELSE
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 348
* EL6311.cbl
 18975              NEXT SENTENCE
 18976     ELSE
 18977        IF (PB-COMPANY-CD  NOT = PI-COMPANY-CD) OR
 18978           (PB-ENTRY-BATCH NOT = PI-PB-ENTRY-BATCH)
 18979           GO TO 4150-END-BATCH.
 18980
 18981     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 18982
 18983     IF WS-BATCH-PREFIX = '#CL'
 18984         MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 18985         GO TO 4105-READ-NEXT.
 18986
 18987     MOVE PB-CARRIER             TO PI-PB-CARRIER.
 18988     MOVE PB-GROUPING            TO PI-PB-GROUPING.
 18989     MOVE PB-STATE               TO PI-PB-STATE.
 18990     MOVE PB-ACCOUNT             TO PI-PB-ACCOUNT.
 18991
 18992     IF PB-BATCH-TRAILER
 18993        IF SHOW-RECORD
 18994           GO TO 4150-END-BATCH
 18995        ELSE
 18996           MOVE ER-2251         TO EMI-ERROR
 18997           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18998           MOVE 1               TO PI-BROWSE-TYPE
 18999           GO TO 7200-DISPLAY-BATCHES.
 19000
 19001     IF SHOW-RECORD
 19002           IF WS-NEW-CERT-NO NOT = PB-CERT-NO
 19003              GO TO 4110-BUMP-SEQ
 19004           ELSE
 19005              IF WS-NEW-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19006                 GO TO 4110-BUMP-SEQ
 19007              ELSE
 19008                 GO TO 4107-CHECK-REC-TYPE.
 19009
 19010     IF NOT  PI-PRIMARY-WITH-SELECT
 19011        GO TO 4107-CHECK-REC-TYPE.
 19012
 19013     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19014        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 19015           GO TO 4110-BUMP-SEQ
 19016        ELSE
 19017           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19018              GO TO 4107-CHECK-REC-TYPE
 19019           ELSE
 19020              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19021                 GO TO 4107-CHECK-REC-TYPE
 19022              ELSE
 19023                 GO TO 4110-BUMP-SEQ.
 19024
 19025     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19026        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19027           GO TO 4110-BUMP-SEQ.
 19028
 19029 4107-CHECK-REC-TYPE.
 19030     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19031         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19032             NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 349
* EL6311.cbl
 19033           ELSE
 19034             GO TO 4110-BUMP-SEQ.
 19035
 19036     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19037         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19038             NEXT SENTENCE
 19039           ELSE
 19040             GO TO 4110-BUMP-SEQ.
 19041
 19042     IF NOT DISPLAY-CHANGE-RECORDS AND
 19043        PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19044           GO TO 4110-BUMP-SEQ.
 19045
 19046     IF DISPLAY-HOLD-RECORDS AND
 19047        NOT PB-RECORD-ON-HOLD
 19048          GO TO 4110-BUMP-SEQ.
 19049
 19050     IF PB-ISSUE
 19051        IF DISPLAY-CHK-REQ-RECORDS
 19052            GO TO 4110-BUMP-SEQ.
 19053
 19054     IF PB-ISSUE
 19055        IF ISSUE-WITH-WARNING
 19056           IF PB-WARNING-ERRORS
 19057              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19058                  GO TO 4110-BUMP-SEQ
 19059              ELSE
 19060                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19061                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19062                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19063                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19064                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19065                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19066                 GO TO 7000-DISPLAY-ISSUES
 19067        ELSE
 19068            GO TO 4110-BUMP-SEQ.
 19069
 19070     IF PB-ISSUE
 19071        IF (ISSUES-IN-ERROR AND
 19072            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19073            ALL-ISSUES
 19074            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19075            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19076            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19077            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19078            MOVE PB-SV-STATE            TO PI-SV-STATE
 19079            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19080            GO TO 7000-DISPLAY-ISSUES
 19081        ELSE
 19082            GO TO 4110-BUMP-SEQ.
 19083
 19084     IF PB-CANCELLATION
 19085        IF DISPLAY-CHK-REQ-RECORDS
 19086           IF PB-C-REFUND-REQUESTED
 19087              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19088              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19089              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19090              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 350
* EL6311.cbl
 19091              MOVE PB-SV-STATE            TO PI-SV-STATE
 19092              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19093              GO TO 7100-DISPLAY-CANCELS
 19094           ELSE
 19095              GO TO 4110-BUMP-SEQ.
 19096
 19097     IF PB-CANCELLATION
 19098        IF CANCEL-WITH-WARNING
 19099           IF PB-WARNING-ERRORS
 19100              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19101                  GO TO 4110-BUMP-SEQ
 19102              ELSE
 19103                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19104                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19105                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19106                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19107                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19108                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19109                 GO TO 7100-DISPLAY-CANCELS
 19110           ELSE
 19111              GO TO 4110-BUMP-SEQ.
 19112
 19113     IF PB-CANCELLATION
 19114        IF (CANCEL-IN-ERROR  AND
 19115            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19116            ALL-CANCELS
 19117            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19118            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19119            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19120            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19121            MOVE PB-SV-STATE            TO PI-SV-STATE
 19122            MOVE 'Y'                    TO WS-PB-RECORDS-FOUND-SW
 19123            GO TO 7100-DISPLAY-CANCELS.
 19124
 19125 4110-BUMP-SEQ.
 19126     IF NOT DISPLAY-CHANGE-RECORDS
 19127        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 19128        ADD +1                   TO ERPNDB-BATCH-SEQ-NO
 19129     ELSE
 19130        IF PB-BATCH-SEQ-NO NOT = ERPNDB-BATCH-SEQ-NO
 19131           MOVE PB-BATCH-SEQ-NO  TO ERPNDB-BATCH-SEQ-NO
 19132           MOVE +999             TO ERPNDB-BATCH-CHG-SEQ-NO
 19133        ELSE
 19134           MOVE PB-BATCH-CHG-SEQ-NO  TO ERPNDB-BATCH-CHG-SEQ-NO
 19135           ADD +1                    TO ERPNDB-BATCH-CHG-SEQ-NO.
 19136
 19137     GO TO 4105-READ-NEXT.
 19138
 19139 4150-END-BATCH.
 19140******************************************************************
 19141*                                                                *
 19142*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 19143*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING     *
 19144*         PROGRAM.                                               *
 19145*                                                                *
 19146******************************************************************
 19147
 19148     IF  EIBTRNID NOT = TRANS-EXB1
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 351
* EL6311.cbl
 19149         IF PENDING-BUS-RECS-FOUND
 19150             NEXT SENTENCE
 19151           ELSE
 19152             MOVE '9'            TO PI-BROWSE-SW
 19153             GO TO 9400-CLEAR.
 19154
 19155     IF SHOW-RECORD
 19156        MOVE ER-2253             TO EMI-ERROR
 19157     ELSE
 19158        MOVE ER-2251             TO EMI-ERROR.
 19159
 19160     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19161
 19162     IF PI-MAP-NAME = SPACES
 19163        MOVE -1                  TO BMAINTL
 19164        MOVE EL631B              TO PI-MAP-NAME
 19165        GO TO 8100-SEND-INITIAL-MAP.
 19166
 19167     IF PI-MAP-NAME = EL631B
 19168        MOVE -1                  TO BMAINTL
 19169     ELSE
 19170        IF PI-MAP-NAME = EL631C
 19171           MOVE -1               TO CMAINTL
 19172        ELSE
 19173           MOVE -1               TO DPFENTRL.
 19174
 19175     GO TO 8200-SEND-DATAONLY.
 19176
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 352
* EL6311.cbl
 19178
 19179***************************************************************
 19180*     FORWARD BROWSING ROUTINE   (BY CSR)                     *
 19181*                                                             *
 19182*      1. START BROWSE WITH                                   *
 19183*         A. FIRST RECORD SPECIFIED FROM FIRST SCREEN         *
 19184*         B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN       *
 19185*         C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.       *
 19186*                                                             *
 19187*      2. READ RECORDS AND DETERMINE IF THEY ARE TO BE        *
 19188*         DISPLAYED BY USING THE FOLLOWING CHECKS.            *
 19189*         A. IS IT WITHIN THE SAME KEY GROUP?                 *
 19190*         B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED. *
 19191*         C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM   *
 19192*               AND IS IT TO BE DISPLAYED.                    *
 19193*         D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE        *
 19194*               DISPLAYED.                                    *
 19195*         E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE       *
 19196*               DISPLAYED.                                    *
 19197*                                                             *
 19198*      3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE      *
 19199*               RECORD KEY AND GO TO THE DISPLAY ROUTINE.     *
 19200***************************************************************
 19201
 19202 4200-BROWSE-CSR-FORWARD.
 19203
 19204     IF FIRST-TIME
 19205        MOVE PI-ERPNDB-CSR-KEY      TO ERPNDB-CSR-KEY
 19206     ELSE
 19207        MOVE PI-PREV-CSR-KEY        TO ERPNDB-CSR-KEY.
 19208
 19209
 19210* EXEC CICS HANDLE CONDITION
 19211*         NOTFND   (4250-END-RECORDS)
 19212*         ENDFILE  (4250-END-RECORDS)
 19213*    END-EXEC.
 19214*    MOVE '"$I''                  ! G #00016575' TO DFHEIV0
 19215     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19216     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19217     MOVE X'4720233030303136353735' TO DFHEIV0(25:11)
 19218     CALL 'kxdfhei1' USING DFHEIV0
 19219     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19220
 19221
 19222
 19223* EXEC CICS STARTBR
 19224*         DATASET   (FILE-ID-ERPNDB4)
 19225*         RIDFLD    (ERPNDB-CSR-KEY)
 19226*    END-EXEC.
 19227     MOVE 0
 19228       TO DFHEIV11
 19229*    MOVE '&,         G          &   #00016580' TO DFHEIV0
 19230     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19231     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19232     MOVE X'2020233030303136353830' TO DFHEIV0(25:11)
 19233     CALL 'kxdfhei1' USING DFHEIV0,
 19234           FILE-ID-ERPNDB4,
 19235           ERPNDB-CSR-KEY,
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 353
* EL6311.cbl
 19236           DFHEIV99,
 19237           DFHEIV11,
 19238           DFHEIV99
 19239     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19240
 19241
 19242     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 19243
 19244     IF FIRST-TIME
 19245        MOVE SPACE               TO WS-FIRST-TIME-SW
 19246        GO TO 4205-READ-NEXT-RECORD.
 19247
 19248
 19249* EXEC CICS READNEXT
 19250*         DATASET    (FILE-ID-ERPNDB4)
 19251*         SET        (ADDRESS OF PENDING-BUSINESS)
 19252*         RIDFLD     (ERPNDB-CSR-KEY)
 19253*    END-EXEC.
 19254     MOVE 0
 19255       TO DFHEIV11
 19256*    MOVE '&.S                   )   #00016591' TO DFHEIV0
 19257     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19258     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19259     MOVE X'2020233030303136353931' TO DFHEIV0(25:11)
 19260     CALL 'kxdfhei1' USING DFHEIV0,
 19261           FILE-ID-ERPNDB4,
 19262           DFHEIV20,
 19263           DFHEIV99,
 19264           ERPNDB-CSR-KEY,
 19265           DFHEIV99,
 19266           DFHEIV11,
 19267           DFHEIV99,
 19268           DFHEIV99
 19269     SET ADDRESS OF PENDING-BUSINESS TO
 19270         DFHEIV20
 19271     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19272
 19273
 19274 4205-READ-NEXT-RECORD.
 19275
 19276
 19277* EXEC CICS READNEXT
 19278*         DATASET    (FILE-ID-ERPNDB4)
 19279*         SET        (ADDRESS OF PENDING-BUSINESS)
 19280*         RIDFLD     (ERPNDB-CSR-KEY)
 19281*    END-EXEC.
 19282     MOVE 0
 19283       TO DFHEIV11
 19284*    MOVE '&.S                   )   #00016599' TO DFHEIV0
 19285     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19286     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19287     MOVE X'2020233030303136353939' TO DFHEIV0(25:11)
 19288     CALL 'kxdfhei1' USING DFHEIV0,
 19289           FILE-ID-ERPNDB4,
 19290           DFHEIV20,
 19291           DFHEIV99,
 19292           ERPNDB-CSR-KEY,
 19293           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 354
* EL6311.cbl
 19294           DFHEIV11,
 19295           DFHEIV99,
 19296           DFHEIV99
 19297     SET ADDRESS OF PENDING-BUSINESS TO
 19298         DFHEIV20
 19299     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19300
 19301
 19302     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19303
 19304     IF WS-BATCH-PREFIX = '#CL'
 19305        GO TO 4205-READ-NEXT-RECORD.
 19306
 19307     IF PB-CSR-COMPANY-CD   NOT = PI-COMPANY-CD OR
 19308        PB-CSR-ID           NOT = PI-PB-CSR-ID
 19309        GO TO 4250-END-RECORDS.
 19310
 19311     IF PB-BATCH-TRAILER
 19312        GO TO 4205-READ-NEXT-RECORD.
 19313
 19314     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19315        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 19316           GO TO 4205-READ-NEXT-RECORD
 19317        ELSE
 19318           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19319              GO TO 4210-CHECK-REC-TYPE
 19320           ELSE
 19321              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19322                 GO TO 4210-CHECK-REC-TYPE
 19323              ELSE
 19324                 GO TO 4205-READ-NEXT-RECORD.
 19325
 19326     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19327        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19328           GO TO 4205-READ-NEXT-RECORD.
 19329
 19330 4210-CHECK-REC-TYPE.
 19331     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19332         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19333             NEXT SENTENCE
 19334         ELSE
 19335             GO TO 4205-READ-NEXT-RECORD.
 19336
 19337     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19338         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19339             NEXT SENTENCE
 19340        ELSE
 19341             GO TO 4205-READ-NEXT-RECORD.
 19342
 19343     IF NOT DISPLAY-CHANGE-RECORDS AND
 19344            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19345        GO TO 4205-READ-NEXT-RECORD.
 19346
 19347     IF DISPLAY-HOLD-RECORDS AND
 19348        NOT PB-RECORD-ON-HOLD
 19349          GO TO 4205-READ-NEXT-RECORD.
 19350
 19351     IF PB-ISSUE
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 355
* EL6311.cbl
 19352        IF DISPLAY-CHK-REQ-RECORDS
 19353            GO TO 4205-READ-NEXT-RECORD.
 19354
 19355     IF PB-ISSUE
 19356        IF ISSUE-WITH-WARNING
 19357           IF PB-WARNING-ERRORS
 19358              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19359                  GO TO 4205-READ-NEXT-RECORD
 19360              ELSE
 19361                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19362                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19363                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19364                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19365                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19366                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19367                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19368                 GO TO 7000-DISPLAY-ISSUES
 19369           ELSE
 19370              GO TO 4205-READ-NEXT-RECORD.
 19371
 19372     IF PB-ISSUE
 19373        IF (ISSUES-IN-ERROR AND
 19374            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19375            ALL-ISSUES
 19376            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19377            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19378            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19379            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19380            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19381            MOVE PB-SV-STATE            TO PI-SV-STATE
 19382            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19383            GO TO 7000-DISPLAY-ISSUES
 19384        ELSE
 19385            GO TO 4205-READ-NEXT-RECORD.
 19386
 19387     IF PB-CANCELLATION
 19388        IF DISPLAY-CHK-REQ-RECORDS
 19389           IF PB-C-REFUND-REQUESTED
 19390              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19391              MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19392              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19393              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19394              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19395              MOVE PB-SV-STATE            TO PI-SV-STATE
 19396              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19397              GO TO 7100-DISPLAY-CANCELS
 19398           ELSE
 19399               GO TO 4205-READ-NEXT-RECORD.
 19400
 19401     IF PB-CANCELLATION
 19402        IF CANCEL-WITH-WARNING
 19403           IF PB-WARNING-ERRORS
 19404              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19405                  GO TO 4205-READ-NEXT-RECORD
 19406              ELSE
 19407                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19408                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19409                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 356
* EL6311.cbl
 19410                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19411                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19412                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19413                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19414                 GO TO 7100-DISPLAY-CANCELS
 19415           ELSE
 19416              GO TO 4205-READ-NEXT-RECORD.
 19417
 19418     IF PB-CANCELLATION
 19419        IF (CANCEL-IN-ERROR  AND
 19420            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19421            ALL-CANCELS
 19422            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19423            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19424            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19425            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19426            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19427            MOVE PB-SV-STATE            TO PI-SV-STATE
 19428            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19429            GO TO 7100-DISPLAY-CANCELS.
 19430
 19431     GO TO 4205-READ-NEXT-RECORD.
 19432
 19433 4250-END-RECORDS.
 19434******************************************************************
 19435*                                                                *
 19436*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 19437*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING
 19438*         PROGRAM.                                               *
 19439*                                                                *
 19440******************************************************************
 19441
 19442     IF BROWSE-STARTED
 19443        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 19444
 19445* EXEC CICS ENDBR
 19446*            DATASET  (FILE-ID-ERPNDB4)
 19447*       END-EXEC.
 19448     MOVE 0
 19449       TO DFHEIV11
 19450*    MOVE '&2                    $   #00016747' TO DFHEIV0
 19451     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19452     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19453     MOVE X'2020233030303136373437' TO DFHEIV0(25:11)
 19454     CALL 'kxdfhei1' USING DFHEIV0,
 19455           FILE-ID-ERPNDB4,
 19456           DFHEIV11,
 19457           DFHEIV99
 19458     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19459
 19460
 19461     IF  EIBTRNID NOT = TRANS-EXB1
 19462         IF PENDING-BUS-RECS-FOUND
 19463             NEXT SENTENCE
 19464           ELSE
 19465             MOVE '9'            TO PI-BROWSE-SW
 19466             GO TO 9400-CLEAR.
 19467
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 357
* EL6311.cbl
 19468     IF SHOW-RECORD
 19469        MOVE ER-2253            TO EMI-ERROR
 19470       ELSE
 19471        MOVE ER-2254            TO EMI-ERROR.
 19472
 19473     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19474
 19475     IF PI-MAP-NAME = SPACES
 19476        MOVE -1                  TO DPFENTRL
 19477        MOVE EL631D               TO PI-MAP-NAME
 19478        GO TO 8100-SEND-INITIAL-MAP.
 19479
 19480     IF PI-MAP-NAME = EL631B
 19481        MOVE -1                  TO BMAINTL
 19482     ELSE
 19483        IF PI-MAP-NAME = EL631C
 19484           MOVE -1               TO CMAINTL
 19485        ELSE
 19486           MOVE -1               TO DPFENTRL.
 19487
 19488     GO TO 8200-SEND-DATAONLY.
 19489
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 358
* EL6311.cbl
 19491
 19492***************************************************************
 19493*                                                             *
 19494*     FORWARD BROWSING ROUTINE   (BY FILE)                    *
 19495*                                                             *
 19496*       1. READ RECORDS WITHIN THE FILE BY COMPANY            *
 19497*          A. FIRST TIME INTO PROGRAM FROM FIRST SCREEN       *
 19498*          B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN      *
 19499*                                                             *
 19500*       2. READ RECORDS AND DETERMINE IF THEY ARE TO BE       *
 19501*          DISPLAYED BY USING THE FOLLOWING CHECKS.           *
 19502*          A. IS IT WITHIN THE SAME COMPANY                   *
 19503*          B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED.*
 19504*          C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM  *
 19505*                AND IS IT TO BE DISPLAYED.                   *
 19506*          D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE       *
 19507*                DISPLAYED.                                   *
 19508*          E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE      *
 19509*                DISPLAYED.                                   *
 19510*                                                             *
 19511*       3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE     *
 19512*                RECORD KEY AND GO TO THE DISPLAY ROUTINE.    *
 19513*                                                             *
 19514*       4. WHEN READING ADDITION RECORDS ADJUSTMENTS MUST BE  *
 19515*                MADE TO BYPASS THE CORRECTION RECORDS IF     *
 19516*                THEY ARE NOT TO BE DISPLAYED.                *
 19517*                                                             *
 19518***************************************************************
 19519
 19520 4300-BROWSE-FILE-FORWARD.
 19521     IF FIRST-TIME OR SHOW-RECORD
 19522        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY
 19523        MOVE +1                  TO ERPNDB-BATCH-SEQ-NO
 19524        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 19525     ELSE
 19526        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 19527        IF ERPNDB-BATCH-SEQ-NO = +9999
 19528           MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
 19529        ELSE
 19530           IF DISPLAY-CHANGE-RECORDS
 19531              ADD +1             TO ERPNDB-BATCH-CHG-SEQ-NO
 19532           ELSE
 19533              MOVE ZEROS         TO ERPNDB-BATCH-CHG-SEQ-NO
 19534              ADD +1             TO ERPNDB-BATCH-SEQ-NO.
 19535
 19536
 19537* EXEC CICS HANDLE CONDITION
 19538*         ENDFILE  (4350-END-BATCH)
 19539*         NOTFND   (4350-END-BATCH)
 19540*    END-EXEC.
 19541*    MOVE '"$''I                  ! H #00016826' TO DFHEIV0
 19542     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 19543     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19544     MOVE X'4820233030303136383236' TO DFHEIV0(25:11)
 19545     CALL 'kxdfhei1' USING DFHEIV0
 19546     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19547
 19548
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 359
* EL6311.cbl
 19549 4305-READ-NEXT.
 19550     IF PI-DISPLAY-ORIGINAL-BATCH
 19551        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 19552     ELSE
 19553        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 19554
 19555
 19556* EXEC CICS READ
 19557*         DATASET   (FILE-ID)
 19558*         SET       (ADDRESS OF PENDING-BUSINESS)
 19559*         RIDFLD    (ERPNDB-KEY)
 19560*         GTEQ
 19561*    END-EXEC.
 19562*    MOVE '&"S        G          (   #00016837' TO DFHEIV0
 19563     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 19564     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19565     MOVE X'2020233030303136383337' TO DFHEIV0(25:11)
 19566     CALL 'kxdfhei1' USING DFHEIV0,
 19567           FILE-ID,
 19568           DFHEIV20,
 19569           DFHEIV99,
 19570           ERPNDB-KEY,
 19571           DFHEIV99,
 19572           DFHEIV99,
 19573           DFHEIV99
 19574     SET ADDRESS OF PENDING-BUSINESS TO
 19575         DFHEIV20
 19576     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19577
 19578
 19579     IF PB-COMPANY-CD NOT = PI-COMPANY-CD
 19580        GO TO 4350-END-BATCH.
 19581
 19582     MOVE PB-ENTRY-BATCH         TO ERPNDB-ENTRY-BATCH
 19583                                    WS-BATCH-NO.
 19584
 19585     IF  WS-BATCH-PREFIX = '#CL'
 19586         MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 19587         GO TO 4305-READ-NEXT.
 19588
 19589     MOVE PB-CONTROL-PRIMARY     TO PI-ERPNDB-KEY.
 19590     MOVE PB-CARRIER             TO PI-PB-CARRIER.
 19591     MOVE PB-GROUPING            TO PI-PB-GROUPING.
 19592     MOVE PB-STATE               TO PI-PB-STATE.
 19593     MOVE PB-ACCOUNT             TO PI-PB-ACCOUNT.
 19594
 19595     IF PB-BATCH-TRAILER
 19596        MOVE HIGH-VALUES         TO ERPNDB-BATCH-SEQ-ALPHA
 19597        GO TO 4305-READ-NEXT.
 19598
 19599     IF SHOW-RECORD
 19600           IF WS-NEW-CERT-NO NOT = PB-CERT-NO
 19601              GO TO 4310-BUMP-SEQ
 19602           ELSE
 19603              IF WS-NEW-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19604                 GO TO 4310-BUMP-SEQ
 19605              ELSE
 19606                 GO TO 4307-CHECK-REC-TYPE.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 360
* EL6311.cbl
 19607
 19608     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19609        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 19610           GO TO 4310-BUMP-SEQ
 19611        ELSE
 19612           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19613              GO TO 4307-CHECK-REC-TYPE
 19614           ELSE
 19615              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19616                 GO TO 4307-CHECK-REC-TYPE
 19617              ELSE
 19618                 GO TO 4310-BUMP-SEQ.
 19619
 19620     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19621        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19622           GO TO 4310-BUMP-SEQ.
 19623
 19624 4307-CHECK-REC-TYPE.
 19625     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19626         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19627             NEXT SENTENCE
 19628         ELSE
 19629             GO TO 4310-BUMP-SEQ.
 19630
 19631     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19632         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19633             NEXT SENTENCE
 19634        ELSE
 19635             GO TO 4310-BUMP-SEQ.
 19636
 19637     IF NOT DISPLAY-CHANGE-RECORDS AND
 19638            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19639        GO TO 4310-BUMP-SEQ.
 19640
 19641     IF DISPLAY-HOLD-RECORDS AND
 19642        NOT PB-RECORD-ON-HOLD
 19643          GO TO 4310-BUMP-SEQ.
 19644
 19645     IF PB-ISSUE
 19646        IF DISPLAY-CHK-REQ-RECORDS
 19647           GO TO 4310-BUMP-SEQ.
 19648
 19649     IF PB-ISSUE
 19650        IF ISSUE-WITH-WARNING
 19651           IF PB-WARNING-ERRORS
 19652              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19653                  GO TO 4310-BUMP-SEQ
 19654              ELSE
 19655                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19656                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19657                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19658                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19659                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19660                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19661                 GO TO 7000-DISPLAY-ISSUES
 19662           ELSE
 19663              GO TO 4310-BUMP-SEQ.
 19664
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 361
* EL6311.cbl
 19665     IF PB-ISSUE
 19666        IF (ISSUES-IN-ERROR AND
 19667            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19668            ALL-ISSUES
 19669            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19670            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19671            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19672            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19673            MOVE PB-SV-STATE            TO PI-SV-STATE
 19674            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19675            GO TO 7000-DISPLAY-ISSUES
 19676        ELSE
 19677            GO TO 4310-BUMP-SEQ.
 19678
 19679     IF PB-CANCELLATION
 19680        IF DISPLAY-CHK-REQ-RECORDS
 19681           IF PB-C-REFUND-REQUESTED
 19682              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19683              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19684              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19685              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19686              MOVE PB-SV-STATE            TO PI-SV-STATE
 19687              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19688              GO TO 7100-DISPLAY-CANCELS
 19689           ELSE
 19690              GO TO 4310-BUMP-SEQ.
 19691
 19692     IF PB-CANCELLATION
 19693        IF CANCEL-WITH-WARNING
 19694           IF PB-WARNING-ERRORS
 19695              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19696                  GO TO 4310-BUMP-SEQ
 19697              ELSE
 19698                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19699                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19700                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19701                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19702                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19703                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19704                 GO TO 7100-DISPLAY-CANCELS
 19705           ELSE
 19706              GO TO 4310-BUMP-SEQ.
 19707
 19708     IF PB-CANCELLATION
 19709        IF (CANCEL-IN-ERROR  AND
 19710            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19711            ALL-CANCELS
 19712            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19713            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19714            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19715            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19716            MOVE PB-SV-STATE            TO PI-SV-STATE
 19717            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19718            GO TO 7100-DISPLAY-CANCELS.
 19719
 19720 4310-BUMP-SEQ.
 19721     IF NOT DISPLAY-CHANGE-RECORDS
 19722        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 362
* EL6311.cbl
 19723        ADD +1                   TO ERPNDB-BATCH-SEQ-NO
 19724     ELSE
 19725        IF PB-BATCH-SEQ-NO NOT = ERPNDB-BATCH-SEQ-NO
 19726           MOVE PB-BATCH-SEQ-NO  TO ERPNDB-BATCH-SEQ-NO
 19727           MOVE +999             TO ERPNDB-BATCH-CHG-SEQ-NO
 19728        ELSE
 19729           MOVE PB-BATCH-CHG-SEQ-NO  TO ERPNDB-BATCH-CHG-SEQ-NO
 19730           ADD +1                TO ERPNDB-BATCH-CHG-SEQ-NO.
 19731
 19732     GO TO 4305-READ-NEXT.
 19733
 19734 4350-END-BATCH.
 19735
 19736******************************************************************
 19737*                                                                *
 19738*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 19739*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING    *
 19740*         PROGRAM.                                               *
 19741*                                                                *
 19742******************************************************************
 19743
 19744     IF  EIBTRNID NOT = TRANS-EXB1
 19745         IF PENDING-BUS-RECS-FOUND
 19746             NEXT SENTENCE
 19747           ELSE
 19748             MOVE '9'            TO PI-BROWSE-SW
 19749             GO TO 9400-CLEAR.
 19750
 19751     IF SHOW-RECORD
 19752        MOVE ER-2253            TO EMI-ERROR
 19753     ELSE
 19754        MOVE ER-2251            TO EMI-ERROR.
 19755
 19756     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19757
 19758     IF PI-MAP-NAME = SPACES
 19759        MOVE -1                  TO BMAINTL
 19760        MOVE EL631B               TO PI-MAP-NAME
 19761        GO TO 8100-SEND-INITIAL-MAP.
 19762
 19763     IF PI-MAP-NAME = EL631B
 19764        MOVE -1                  TO BMAINTL
 19765     ELSE
 19766        IF PI-MAP-NAME = EL631C
 19767           MOVE -1               TO CMAINTL
 19768        ELSE
 19769           MOVE -1               TO DPFENTRL.
 19770
 19771     GO TO 8200-SEND-DATAONLY.
 19772
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 363
* EL6311.cbl
 19774
 19775******************************************************************
 19776*                                                                *
 19777*        B R O W S E   D E T A I L   B A C K W A R D             *
 19778*                                                                *
 19779******************************************************************
 19780
 19781 4500-BROWSE-DETAIL-BACKWARD.
 19782
 19783     MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY.
 19784
 19785
 19786* EXEC CICS HANDLE CONDITION
 19787*         NOTFND   (4570-NOT-FOUND)
 19788*         ENDFILE  (4550-END-RECORDS)
 19789*    END-EXEC
 19790*    MOVE '"$I''                  ! I #00017050' TO DFHEIV0
 19791     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19792     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19793     MOVE X'4920233030303137303530' TO DFHEIV0(25:11)
 19794     CALL 'kxdfhei1' USING DFHEIV0
 19795     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19796
 19797
 19798* EXEC CICS STARTBR
 19799*         DATASET   (FILE-ID-ERPNDB2)
 19800*         RIDFLD    (ERPNDB-ALT-KEY)
 19801*    END-EXEC.
 19802     MOVE 0
 19803       TO DFHEIV11
 19804*    MOVE '&,         G          &   #00017055' TO DFHEIV0
 19805     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19806     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19807     MOVE X'2020233030303137303535' TO DFHEIV0(25:11)
 19808     CALL 'kxdfhei1' USING DFHEIV0,
 19809           FILE-ID-ERPNDB2,
 19810           ERPNDB-ALT-KEY,
 19811           DFHEIV99,
 19812           DFHEIV11,
 19813           DFHEIV99
 19814     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19815
 19816
 19817     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW
 19818                                    WS-FIRST-TIME-SW.
 19819
 19820 4505-READ-PREV-RECORD.
 19821
 19822* EXEC CICS READPREV
 19823*         DATASET    (FILE-ID-ERPNDB2)
 19824*         SET        (ADDRESS OF PENDING-BUSINESS)
 19825*         RIDFLD     (ERPNDB-ALT-KEY)
 19826*    END-EXEC.
 19827     MOVE 0
 19828       TO DFHEIV11
 19829*    MOVE '&0S                   )   #00017064' TO DFHEIV0
 19830     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 19831     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 364
* EL6311.cbl
 19832     MOVE X'2020233030303137303634' TO DFHEIV0(25:11)
 19833     CALL 'kxdfhei1' USING DFHEIV0,
 19834           FILE-ID-ERPNDB2,
 19835           DFHEIV20,
 19836           DFHEIV99,
 19837           ERPNDB-ALT-KEY,
 19838           DFHEIV99,
 19839           DFHEIV11,
 19840           DFHEIV99,
 19841           DFHEIV99
 19842     SET ADDRESS OF PENDING-BUSINESS TO
 19843         DFHEIV20
 19844     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19845
 19846
 19847     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19848
 19849     IF WS-BATCH-PREFIX = '#CL'
 19850         GO TO 4505-READ-PREV-RECORD.
 19851
 19852     IF FIRST-TIME
 19853         MOVE SPACE               TO WS-FIRST-TIME-SW
 19854         GO TO 4505-READ-PREV-RECORD.
 19855
 19856     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD  OR
 19857        PB-CARRIER       NOT = PI-PB-CARRIER  OR
 19858        PB-GROUPING      NOT = PI-PB-GROUPING OR
 19859        PB-STATE         NOT = PI-PB-STATE    OR
 19860        PB-ACCOUNT       NOT = PI-PB-ACCOUNT
 19861          GO TO 4550-END-RECORDS.
 19862
 19863
 19864     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 19865
 19866     IF PB-BATCH-TRAILER
 19867        GO TO 4505-READ-PREV-RECORD.
 19868
 19869     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19870
 19871     IF  WS-BATCH-PREFIX = '#CL'
 19872         GO TO 4505-READ-PREV-RECORD.
 19873
 19874     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19875        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 19876           GO TO 4505-READ-PREV-RECORD
 19877        ELSE
 19878           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19879              GO TO 4510-CHECK-REC-TYPE
 19880           ELSE
 19881              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19882                 GO TO 4510-CHECK-REC-TYPE
 19883              ELSE
 19884                 GO TO 4505-READ-PREV-RECORD.
 19885
 19886     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19887        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19888           GO TO 4505-READ-PREV-RECORD.
 19889
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 365
* EL6311.cbl
 19890 4510-CHECK-REC-TYPE.
 19891     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19892         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19893             NEXT SENTENCE
 19894         ELSE
 19895             GO TO 4505-READ-PREV-RECORD.
 19896
 19897     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19898         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19899             NEXT SENTENCE
 19900        ELSE
 19901             GO TO 4505-READ-PREV-RECORD.
 19902
 19903     IF NOT DISPLAY-CHANGE-RECORDS AND
 19904            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19905        GO TO 4505-READ-PREV-RECORD.
 19906
 19907     IF DISPLAY-HOLD-RECORDS AND
 19908        NOT PB-RECORD-ON-HOLD
 19909          GO TO 4505-READ-PREV-RECORD.
 19910
 19911     IF PB-ISSUE
 19912        IF DISPLAY-CHK-REQ-RECORDS
 19913           GO TO 4505-READ-PREV-RECORD.
 19914
 19915     IF PB-ISSUE
 19916        IF ISSUE-WITH-WARNING
 19917           IF PB-WARNING-ERRORS
 19918              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19919                  GO TO 4505-READ-PREV-RECORD
 19920              ELSE
 19921                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19922                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19923                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19924                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19925                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19926                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19927                 GO TO 7000-DISPLAY-ISSUES
 19928           ELSE
 19929              GO TO 4505-READ-PREV-RECORD.
 19930
 19931     IF PB-ISSUE
 19932        IF (ISSUES-IN-ERROR AND
 19933            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19934            ALL-ISSUES
 19935            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19936            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19937            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19938            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19939            MOVE PB-SV-STATE            TO PI-SV-STATE
 19940            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19941            GO TO 7000-DISPLAY-ISSUES
 19942        ELSE
 19943            GO TO 4505-READ-PREV-RECORD.
 19944
 19945     IF PB-CANCELLATION
 19946        IF DISPLAY-CHK-REQ-RECORDS
 19947           IF PB-C-REFUND-REQUESTED
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 366
* EL6311.cbl
 19948              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19949              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19950              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19951              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19952              MOVE PB-SV-STATE            TO PI-SV-STATE
 19953              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19954              GO TO 7100-DISPLAY-CANCELS
 19955           ELSE
 19956              GO TO 4505-READ-PREV-RECORD.
 19957
 19958     IF PB-CANCELLATION
 19959        IF CANCEL-WITH-WARNING
 19960           IF PB-WARNING-ERRORS
 19961              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19962                  GO TO 4505-READ-PREV-RECORD
 19963              ELSE
 19964                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19965                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19966                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19967                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19968                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19969                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19970                 GO TO 7100-DISPLAY-CANCELS
 19971           ELSE
 19972              GO TO 4505-READ-PREV-RECORD.
 19973
 19974     IF PB-CANCELLATION
 19975        IF (CANCEL-IN-ERROR  AND
 19976            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19977            ALL-CANCELS
 19978            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19979            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19980            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19981            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19982            MOVE PB-SV-STATE            TO PI-SV-STATE
 19983            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19984            GO TO 7100-DISPLAY-CANCELS.
 19985
 19986     GO TO 4505-READ-PREV-RECORD.
 19987
 19988 4550-END-RECORDS.
 19989     IF PI-MAP-NAME = EL631B
 19990        MOVE -1                  TO BMAINTL
 19991     ELSE
 19992        IF PI-MAP-NAME = EL631C
 19993           MOVE -1               TO CMAINTL
 19994        ELSE
 19995           MOVE -1               TO DPFENTRL.
 19996
 19997     MOVE ER-2255               TO EMI-ERROR.
 19998     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19999     GO TO 8200-SEND-DATAONLY.
 20000
 20001 4570-NOT-FOUND.
 20002
 20003******************************************************************
 20004*      CONDITION MAY OCCUR IF PREV. RECORD HAS BEEN DELETED.     *
 20005******************************************************************
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 367
* EL6311.cbl
 20006
 20007
 20008* EXEC CICS RESETBR
 20009*         DATASET    (FILE-ID-ERPNDB2)
 20010*         RIDFLD     (ERPNDB-ALT-KEY)
 20011*    END-EXEC.
 20012     MOVE 0
 20013       TO DFHEIV11
 20014*    MOVE '&4         G          &   #00017230' TO DFHEIV0
 20015     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 20016     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20017     MOVE X'2020233030303137323330' TO DFHEIV0(25:11)
 20018     CALL 'kxdfhei1' USING DFHEIV0,
 20019           FILE-ID-ERPNDB2,
 20020           ERPNDB-ALT-KEY,
 20021           DFHEIV99,
 20022           DFHEIV11,
 20023           DFHEIV99
 20024     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20025
 20026
 20027
 20028* EXEC CICS READNEXT
 20029*         DATASET    (FILE-ID-ERPNDB2)
 20030*         SET        (ADDRESS OF PENDING-BUSINESS)
 20031*         RIDFLD     (ERPNDB-ALT-KEY)
 20032*    END-EXEC.
 20033     MOVE 0
 20034       TO DFHEIV11
 20035*    MOVE '&.S                   )   #00017235' TO DFHEIV0
 20036     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 20037     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20038     MOVE X'2020233030303137323335' TO DFHEIV0(25:11)
 20039     CALL 'kxdfhei1' USING DFHEIV0,
 20040           FILE-ID-ERPNDB2,
 20041           DFHEIV20,
 20042           DFHEIV99,
 20043           ERPNDB-ALT-KEY,
 20044           DFHEIV99,
 20045           DFHEIV11,
 20046           DFHEIV99,
 20047           DFHEIV99
 20048     SET ADDRESS OF PENDING-BUSINESS TO
 20049         DFHEIV20
 20050     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20051
 20052
 20053
 20054* EXEC CICS READPREV
 20055*         DATASET    (FILE-ID-ERPNDB2)
 20056*         SET        (ADDRESS OF PENDING-BUSINESS)
 20057*         RIDFLD     (ERPNDB-ALT-KEY)
 20058*    END-EXEC.
 20059     MOVE 0
 20060       TO DFHEIV11
 20061*    MOVE '&0S                   )   #00017241' TO DFHEIV0
 20062     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20063     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 368
* EL6311.cbl
 20064     MOVE X'2020233030303137323431' TO DFHEIV0(25:11)
 20065     CALL 'kxdfhei1' USING DFHEIV0,
 20066           FILE-ID-ERPNDB2,
 20067           DFHEIV20,
 20068           DFHEIV99,
 20069           ERPNDB-ALT-KEY,
 20070           DFHEIV99,
 20071           DFHEIV11,
 20072           DFHEIV99,
 20073           DFHEIV99
 20074     SET ADDRESS OF PENDING-BUSINESS TO
 20075         DFHEIV20
 20076     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20077
 20078
 20079 4580-READ-PREV-RECORD.
 20080
 20081* EXEC CICS READPREV
 20082*         DATASET    (FILE-ID-ERPNDB2)
 20083*         SET        (ADDRESS OF PENDING-BUSINESS)
 20084*         RIDFLD     (ERPNDB-ALT-KEY)
 20085*    END-EXEC.
 20086     MOVE 0
 20087       TO DFHEIV11
 20088*    MOVE '&0S                   )   #00017248' TO DFHEIV0
 20089     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20090     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20091     MOVE X'2020233030303137323438' TO DFHEIV0(25:11)
 20092     CALL 'kxdfhei1' USING DFHEIV0,
 20093           FILE-ID-ERPNDB2,
 20094           DFHEIV20,
 20095           DFHEIV99,
 20096           ERPNDB-ALT-KEY,
 20097           DFHEIV99,
 20098           DFHEIV11,
 20099           DFHEIV99,
 20100           DFHEIV99
 20101     SET ADDRESS OF PENDING-BUSINESS TO
 20102         DFHEIV20
 20103     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20104
 20105
 20106     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20107
 20108     IF WS-BATCH-PREFIX = '#CL'
 20109        GO TO 4580-READ-PREV-RECORD.
 20110
 20111     MOVE SPACE                  TO WS-FIRST-TIME-SW.
 20112     GO TO 4505-READ-PREV-RECORD.
 20113
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 369
* EL6311.cbl
 20115
 20116******************************************************************
 20117*                                                                *
 20118*        B R O W S E   P R I M A R Y   B A C K W A R D           *
 20119*                                                                *
 20120******************************************************************
 20121
 20122 4600-BROWSE-PRIMARY-BACKWARD.
 20123        MOVE PI-PREV-KEY         TO ERPNDB-KEY.
 20124
 20125     IF ERPNDB-BATCH-SEQ-NO = +9999
 20126        MOVE PI-HIGH-SEQ-NO      TO ERPNDB-BATCH-SEQ-NO.
 20127
 20128        IF ERPNDB-BATCH-SEQ-NO = +0000
 20129           GO TO 4650-END-BATCH
 20130        ELSE
 20131           IF PI-MAP-NAME NOT = EL631D
 20132              IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20133                 SUBTRACT +1      FROM ERPNDB-BATCH-CHG-SEQ-NO
 20134              ELSE
 20135                 SUBTRACT +1      FROM ERPNDB-BATCH-SEQ-NO
 20136                 IF DISPLAY-CHANGE-RECORDS
 20137                    MOVE +999     TO ERPNDB-BATCH-CHG-SEQ-NO
 20138                 ELSE
 20139                    MOVE ZEROS    TO ERPNDB-BATCH-CHG-SEQ-NO.
 20140
 20141
 20142* EXEC CICS HANDLE CONDITION
 20143*         NOTFND    (4680-NOT-FOUND)
 20144*         ENDFILE   (4680-NOT-FOUND)
 20145*    END-EXEC.
 20146*    MOVE '"$I''                  ! J #00017289' TO DFHEIV0
 20147     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20148     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20149     MOVE X'4A20233030303137323839' TO DFHEIV0(25:11)
 20150     CALL 'kxdfhei1' USING DFHEIV0
 20151     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20152
 20153
 20154 4605-READ-NEXT.
 20155     IF ERPNDB-BATCH-SEQ-NO = +0000
 20156        GO TO 4650-END-BATCH.
 20157
 20158     IF PI-DISPLAY-ORIGINAL-BATCH
 20159        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 20160     ELSE
 20161        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 20162
 20163
 20164* EXEC CICS READ
 20165*         DATASET   (FILE-ID)
 20166*         SET       (ADDRESS OF PENDING-BUSINESS)
 20167*         RIDFLD    (ERPNDB-KEY)
 20168*    END-EXEC.
 20169*    MOVE '&"S        E          (   #00017303' TO DFHEIV0
 20170     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 20171     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20172     MOVE X'2020233030303137333033' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 370
* EL6311.cbl
 20173     CALL 'kxdfhei1' USING DFHEIV0,
 20174           FILE-ID,
 20175           DFHEIV20,
 20176           DFHEIV99,
 20177           ERPNDB-KEY,
 20178           DFHEIV99,
 20179           DFHEIV99,
 20180           DFHEIV99
 20181     SET ADDRESS OF PENDING-BUSINESS TO
 20182         DFHEIV20
 20183     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20184
 20185
 20186     IF NOT  PI-PRIMARY-WITH-SELECT
 20187        GO TO 4607-CHECK-REC-TYPE.
 20188
 20189     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20190
 20191     IF  WS-BATCH-PREFIX = '#CL'
 20192         GO TO 4610-BUMP-SEQ.
 20193
 20194     IF PI-PB-CERT-NO NOT = LOW-VALUES
 20195        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 20196           GO TO 4610-BUMP-SEQ
 20197        ELSE
 20198           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 20199              GO TO 4607-CHECK-REC-TYPE
 20200           ELSE
 20201              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 20202                 GO TO 4607-CHECK-REC-TYPE
 20203              ELSE
 20204                 GO TO 4610-BUMP-SEQ.
 20205
 20206     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 20207        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 20208           GO TO 4610-BUMP-SEQ.
 20209
 20210 4607-CHECK-REC-TYPE.
 20211     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20212         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20213             NEXT SENTENCE
 20214         ELSE
 20215             GO TO 4610-BUMP-SEQ.
 20216
 20217     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20218         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20219             NEXT SENTENCE
 20220        ELSE
 20221             GO TO 4610-BUMP-SEQ.
 20222
 20223     IF NOT DISPLAY-CHANGE-RECORDS AND
 20224            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20225        GO TO 4610-BUMP-SEQ.
 20226
 20227     IF DISPLAY-HOLD-RECORDS AND
 20228        NOT PB-RECORD-ON-HOLD
 20229          GO TO 4610-BUMP-SEQ.
 20230
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 371
* EL6311.cbl
 20231     IF PB-ISSUE
 20232        IF DISPLAY-CHK-REQ-RECORDS
 20233           GO TO 4610-BUMP-SEQ.
 20234
 20235     IF PB-ISSUE
 20236        IF ISSUE-WITH-WARNING
 20237           IF PB-WARNING-ERRORS
 20238              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20239                  GO TO 4610-BUMP-SEQ
 20240              ELSE
 20241                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20242                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20243                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20244                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20245                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20246                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20247                 GO TO 7000-DISPLAY-ISSUES
 20248           ELSE
 20249              GO TO 4610-BUMP-SEQ.
 20250
 20251     IF PB-ISSUE
 20252        IF (ISSUES-IN-ERROR AND
 20253            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20254            ALL-ISSUES
 20255            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20256            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20257            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20258            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20259            MOVE PB-SV-STATE            TO PI-SV-STATE
 20260            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20261            GO TO 7000-DISPLAY-ISSUES
 20262        ELSE
 20263            GO TO 4610-BUMP-SEQ.
 20264
 20265     IF PB-CANCELLATION
 20266        IF DISPLAY-CHK-REQ-RECORDS
 20267           IF PB-C-REFUND-REQUESTED
 20268              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20269              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20270              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20271              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20272              MOVE PB-SV-STATE            TO PI-SV-STATE
 20273              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20274              GO TO 7100-DISPLAY-CANCELS
 20275           ELSE
 20276              GO TO 4610-BUMP-SEQ.
 20277
 20278     IF PB-CANCELLATION
 20279        IF CANCEL-WITH-WARNING
 20280           IF PB-WARNING-ERRORS
 20281              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20282                  GO TO 4610-BUMP-SEQ
 20283              ELSE
 20284                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20285                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20286                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20287                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20288                 MOVE PB-SV-STATE            TO PI-SV-STATE
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 372
* EL6311.cbl
 20289                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20290                 GO TO 7100-DISPLAY-CANCELS
 20291           ELSE
 20292              GO TO 4610-BUMP-SEQ.
 20293
 20294     IF PB-CANCELLATION
 20295        IF (CANCEL-IN-ERROR  AND
 20296            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20297            ALL-CANCELS
 20298            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20299            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20300            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20301            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20302            MOVE PB-SV-STATE            TO PI-SV-STATE
 20303            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20304            GO TO 7100-DISPLAY-CANCELS.
 20305
 20306 4610-BUMP-SEQ.
 20307     IF ERPNDB-BATCH-SEQ-NO = ZEROS
 20308        GO TO 4650-END-BATCH.
 20309
 20310     IF DISPLAY-CHANGE-RECORDS
 20311        IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20312           SUBTRACT +1           FROM ERPNDB-BATCH-CHG-SEQ-NO
 20313        ELSE
 20314           MOVE +999             TO   ERPNDB-BATCH-CHG-SEQ-NO
 20315           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO
 20316        ELSE
 20317           MOVE ZEROS            TO   ERPNDB-BATCH-CHG-SEQ-NO
 20318           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO.
 20319
 20320        GO TO 4605-READ-NEXT.
 20321
 20322 4650-END-BATCH.
 20323     IF PI-MAP-NAME = EL631B
 20324        MOVE -1                  TO BMAINTL
 20325     ELSE
 20326        IF PI-MAP-NAME = EL631C
 20327           MOVE -1               TO CMAINTL
 20328        ELSE
 20329           MOVE -1               TO DPFENTRL.
 20330
 20331     MOVE ER-2252               TO EMI-ERROR.
 20332     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20333     GO TO 8200-SEND-DATAONLY.
 20334
 20335 4680-NOT-FOUND.
 20336     IF DISPLAY-CHANGE-RECORDS
 20337        IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20338           MOVE ZEROS            TO   ERPNDB-BATCH-CHG-SEQ-NO
 20339        ELSE
 20340           MOVE +999             TO   ERPNDB-BATCH-CHG-SEQ-NO
 20341           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO
 20342     ELSE
 20343        SUBTRACT +1              FROM ERPNDB-BATCH-SEQ-NO.
 20344
 20345     GO TO 4605-READ-NEXT.
 20346
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 373
* EL6311.cbl
 20348
 20349******************************************************************
 20350*                                                                *
 20351*        B R O W S E   F I L E   B A C K W A R D S               *
 20352*                                                                *
 20353******************************************************************
 20354
 20355 4800-BROWSE-FILE-BACKWARD.
 20356
 20357* EXEC CICS HANDLE CONDITION
 20358*         NOTFND   (4860-NOT-FOUND)
 20359*         ENDFILE  (4850-END-RECORDS)
 20360*    END-EXEC.
 20361*    MOVE '"$I''                  ! K #00017479' TO DFHEIV0
 20362     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20363     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20364     MOVE X'4B20233030303137343739' TO DFHEIV0(25:11)
 20365     CALL 'kxdfhei1' USING DFHEIV0
 20366     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20367
 20368
 20369     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 20370
 20371     IF PI-DISPLAY-ORIGINAL-BATCH
 20372        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 20373     ELSE
 20374        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 20375
 20376
 20377* EXEC CICS STARTBR
 20378*         DATASET   (FILE-ID)
 20379*         RIDFLD    (ERPNDB-KEY)
 20380*    END-EXEC.
 20381     MOVE 0
 20382       TO DFHEIV11
 20383*    MOVE '&,         G          &   #00017491' TO DFHEIV0
 20384     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20385     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20386     MOVE X'2020233030303137343931' TO DFHEIV0(25:11)
 20387     CALL 'kxdfhei1' USING DFHEIV0,
 20388           FILE-ID,
 20389           ERPNDB-KEY,
 20390           DFHEIV99,
 20391           DFHEIV11,
 20392           DFHEIV99
 20393     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20394
 20395
 20396     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 20397
 20398
 20399* EXEC CICS READPREV
 20400*         DATASET    (FILE-ID-ERPNDB)
 20401*         SET        (ADDRESS OF PENDING-BUSINESS)
 20402*         RIDFLD     (ERPNDB-KEY)
 20403*    END-EXEC.
 20404     MOVE 0
 20405       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 374
* EL6311.cbl
 20406*    MOVE '&0S                   )   #00017498' TO DFHEIV0
 20407     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20408     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20409     MOVE X'2020233030303137343938' TO DFHEIV0(25:11)
 20410     CALL 'kxdfhei1' USING DFHEIV0,
 20411           FILE-ID-ERPNDB,
 20412           DFHEIV20,
 20413           DFHEIV99,
 20414           ERPNDB-KEY,
 20415           DFHEIV99,
 20416           DFHEIV11,
 20417           DFHEIV99,
 20418           DFHEIV99
 20419     SET ADDRESS OF PENDING-BUSINESS TO
 20420         DFHEIV20
 20421     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20422
 20423
 20424 4810-READ-PREV-RECORD.
 20425
 20426* EXEC CICS READPREV
 20427*         DATASET    (FILE-ID-ERPNDB)
 20428*         SET        (ADDRESS OF PENDING-BUSINESS)
 20429*         RIDFLD     (ERPNDB-KEY)
 20430*    END-EXEC.
 20431     MOVE 0
 20432       TO DFHEIV11
 20433*    MOVE '&0S                   )   #00017505' TO DFHEIV0
 20434     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20435     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20436     MOVE X'2020233030303137353035' TO DFHEIV0(25:11)
 20437     CALL 'kxdfhei1' USING DFHEIV0,
 20438           FILE-ID-ERPNDB,
 20439           DFHEIV20,
 20440           DFHEIV99,
 20441           ERPNDB-KEY,
 20442           DFHEIV99,
 20443           DFHEIV11,
 20444           DFHEIV99,
 20445           DFHEIV99
 20446     SET ADDRESS OF PENDING-BUSINESS TO
 20447         DFHEIV20
 20448     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20449
 20450
 20451     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD
 20452        GO TO 4850-END-RECORDS.
 20453
 20454     IF PB-BATCH-TRAILER
 20455        GO TO 4810-READ-PREV-RECORD.
 20456
 20457     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20458
 20459     IF  WS-BATCH-PREFIX = '#CL'
 20460         GO TO 4810-READ-PREV-RECORD.
 20461
 20462     IF PI-PB-CERT-NO NOT = LOW-VALUES
 20463        IF PI-PB-CERT-NO NOT = PB-CERT-NO
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 375
* EL6311.cbl
 20464           GO TO 4810-READ-PREV-RECORD
 20465        ELSE
 20466           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 20467              GO TO 4820-CHECK-REC-TYPE
 20468           ELSE
 20469              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 20470                 GO TO 4820-CHECK-REC-TYPE
 20471              ELSE
 20472                 GO TO 4810-READ-PREV-RECORD.
 20473
 20474     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 20475        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 20476           GO TO 4810-READ-PREV-RECORD.
 20477
 20478 4820-CHECK-REC-TYPE.
 20479     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20480         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20481             NEXT SENTENCE
 20482         ELSE
 20483             GO TO 4810-READ-PREV-RECORD.
 20484
 20485     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20486         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20487             NEXT SENTENCE
 20488        ELSE
 20489             GO TO 4810-READ-PREV-RECORD.
 20490
 20491     IF NOT DISPLAY-CHANGE-RECORDS AND
 20492            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20493        GO TO 4810-READ-PREV-RECORD.
 20494
 20495     IF DISPLAY-HOLD-RECORDS AND
 20496        NOT PB-RECORD-ON-HOLD
 20497          GO TO 4810-READ-PREV-RECORD.
 20498
 20499     IF PB-ISSUE
 20500        IF DISPLAY-CHK-REQ-RECORDS
 20501           GO TO 4810-READ-PREV-RECORD.
 20502
 20503     IF PB-ISSUE
 20504        IF ISSUE-WITH-WARNING
 20505           IF PB-WARNING-ERRORS
 20506              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20507                  GO TO 4810-READ-PREV-RECORD
 20508              ELSE
 20509                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20510                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20511                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20512                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20513                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20514                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20515                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20516                 GO TO 7000-DISPLAY-ISSUES
 20517           ELSE
 20518              GO TO 4810-READ-PREV-RECORD.
 20519
 20520     IF PB-ISSUE
 20521        IF (ISSUES-IN-ERROR AND
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 376
* EL6311.cbl
 20522            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20523            ALL-ISSUES
 20524            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20525            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20526            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20527            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20528            MOVE PB-SV-STATE            TO PI-SV-STATE
 20529            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20530            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20531            GO TO 7000-DISPLAY-ISSUES
 20532        ELSE
 20533            GO TO 4810-READ-PREV-RECORD.
 20534
 20535     IF PB-CANCELLATION
 20536        IF DISPLAY-CHK-REQ-RECORDS
 20537           IF PB-C-REFUND-REQUESTED
 20538              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20539              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20540              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20541              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20542              MOVE PB-SV-STATE            TO PI-SV-STATE
 20543              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20544              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20545              GO TO 7100-DISPLAY-CANCELS
 20546           ELSE
 20547              GO TO 4810-READ-PREV-RECORD.
 20548
 20549     IF PB-CANCELLATION
 20550        IF CANCEL-WITH-WARNING
 20551           IF PB-WARNING-ERRORS
 20552              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20553                  GO TO 4810-READ-PREV-RECORD
 20554              ELSE
 20555                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20556                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20557                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20558                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20559                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20560                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20561                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20562                 GO TO 7100-DISPLAY-CANCELS
 20563           ELSE
 20564              GO TO 4810-READ-PREV-RECORD.
 20565
 20566     IF PB-CANCELLATION
 20567        IF (CANCEL-IN-ERROR  AND
 20568            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20569            ALL-CANCELS
 20570            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20571            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20572            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20573            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20574            MOVE PB-SV-STATE            TO PI-SV-STATE
 20575            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20576            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20577            GO TO 7100-DISPLAY-CANCELS.
 20578
 20579     GO TO 4810-READ-PREV-RECORD.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 377
* EL6311.cbl
 20580
 20581 4850-END-RECORDS.
 20582     MOVE ER-2252                TO EMI-ERROR.
 20583     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20584
 20585     IF PI-MAP-NAME = EL631B
 20586        MOVE -1                  TO BPFENTRL
 20587     ELSE
 20588        MOVE -1                  TO CPFENTRL.
 20589
 20590     GO TO 8200-SEND-DATAONLY.
 20591
 20592 4860-NOT-FOUND.
 20593
 20594******************************************************************
 20595*       CONDITION MAY OCCUR IF PREV RECORD HAS BEEN DELETED.     *
 20596******************************************************************
 20597
 20598
 20599* EXEC CICS RESETBR
 20600*         DATASET    (FILE-ID-ERPNDB)
 20601*         RIDFLD     (ERPNDB-KEY)
 20602*     END-EXEC.
 20603     MOVE 0
 20604       TO DFHEIV11
 20605*    MOVE '&4         G          &   #00017658' TO DFHEIV0
 20606     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 20607     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20608     MOVE X'2020233030303137363538' TO DFHEIV0(25:11)
 20609     CALL 'kxdfhei1' USING DFHEIV0,
 20610           FILE-ID-ERPNDB,
 20611           ERPNDB-KEY,
 20612           DFHEIV99,
 20613           DFHEIV11,
 20614           DFHEIV99
 20615     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20616
 20617
 20618
 20619* EXEC CICS READNEXT
 20620*         DATASET    (FILE-ID-ERPNDB)
 20621*         SET        (ADDRESS OF PENDING-BUSINESS)
 20622*         RIDFLD     (ERPNDB-KEY)
 20623*    END-EXEC.
 20624     MOVE 0
 20625       TO DFHEIV11
 20626*    MOVE '&.S                   )   #00017663' TO DFHEIV0
 20627     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 20628     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20629     MOVE X'2020233030303137363633' TO DFHEIV0(25:11)
 20630     CALL 'kxdfhei1' USING DFHEIV0,
 20631           FILE-ID-ERPNDB,
 20632           DFHEIV20,
 20633           DFHEIV99,
 20634           ERPNDB-KEY,
 20635           DFHEIV99,
 20636           DFHEIV11,
 20637           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 378
* EL6311.cbl
 20638           DFHEIV99
 20639     SET ADDRESS OF PENDING-BUSINESS TO
 20640         DFHEIV20
 20641     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20642
 20643
 20644
 20645* EXEC CICS READPREV
 20646*         DATASET    (FILE-ID-ERPNDB)
 20647*         SET        (ADDRESS OF PENDING-BUSINESS)
 20648*         RIDFLD     (ERPNDB-KEY)
 20649*    END-EXEC.
 20650     MOVE 0
 20651       TO DFHEIV11
 20652*    MOVE '&0S                   )   #00017669' TO DFHEIV0
 20653     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20654     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20655     MOVE X'2020233030303137363639' TO DFHEIV0(25:11)
 20656     CALL 'kxdfhei1' USING DFHEIV0,
 20657           FILE-ID-ERPNDB,
 20658           DFHEIV20,
 20659           DFHEIV99,
 20660           ERPNDB-KEY,
 20661           DFHEIV99,
 20662           DFHEIV11,
 20663           DFHEIV99,
 20664           DFHEIV99
 20665     SET ADDRESS OF PENDING-BUSINESS TO
 20666         DFHEIV20
 20667     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20668
 20669
 20670     GO TO 4810-READ-PREV-RECORD.
 20671
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 379
* EL6311.cbl
 20673
 20674******************************************************************
 20675*                                                                *
 20676*           B R O W S E   C S R   B A C K W A R D                *
 20677*                                                                *
 20678******************************************************************
 20679
 20680 4900-BROWSE-CSR-BACKWARD.
 20681
 20682     MOVE PI-PREV-CSR-KEY        TO ERPNDB-CSR-KEY.
 20683
 20684
 20685* EXEC CICS HANDLE CONDITION
 20686*         NOTFND   (4970-NOT-FOUND)
 20687*         ENDFILE  (4950-END-RECORDS)
 20688*    END-EXEC
 20689*    MOVE '"$I''                  ! L #00017689' TO DFHEIV0
 20690     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20691     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20692     MOVE X'4C20233030303137363839' TO DFHEIV0(25:11)
 20693     CALL 'kxdfhei1' USING DFHEIV0
 20694     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20695
 20696
 20697* EXEC CICS STARTBR
 20698*         DATASET   (FILE-ID-ERPNDB4)
 20699*         RIDFLD    (ERPNDB-CSR-KEY)
 20700*    END-EXEC.
 20701     MOVE 0
 20702       TO DFHEIV11
 20703*    MOVE '&,         G          &   #00017694' TO DFHEIV0
 20704     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20705     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20706     MOVE X'2020233030303137363934' TO DFHEIV0(25:11)
 20707     CALL 'kxdfhei1' USING DFHEIV0,
 20708           FILE-ID-ERPNDB4,
 20709           ERPNDB-CSR-KEY,
 20710           DFHEIV99,
 20711           DFHEIV11,
 20712           DFHEIV99
 20713     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20714
 20715
 20716     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW
 20717                                    WS-FIRST-TIME-SW.
 20718
 20719 4905-READ-PREV-RECORD.
 20720
 20721* EXEC CICS READPREV
 20722*         DATASET    (FILE-ID-ERPNDB4)
 20723*         SET        (ADDRESS OF PENDING-BUSINESS)
 20724*         RIDFLD     (ERPNDB-CSR-KEY)
 20725*    END-EXEC.
 20726     MOVE 0
 20727       TO DFHEIV11
 20728*    MOVE '&0S                   )   #00017703' TO DFHEIV0
 20729     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20730     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 380
* EL6311.cbl
 20731     MOVE X'2020233030303137373033' TO DFHEIV0(25:11)
 20732     CALL 'kxdfhei1' USING DFHEIV0,
 20733           FILE-ID-ERPNDB4,
 20734           DFHEIV20,
 20735           DFHEIV99,
 20736           ERPNDB-CSR-KEY,
 20737           DFHEIV99,
 20738           DFHEIV11,
 20739           DFHEIV99,
 20740           DFHEIV99
 20741     SET ADDRESS OF PENDING-BUSINESS TO
 20742         DFHEIV20
 20743     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20744
 20745
 20746     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20747
 20748     IF WS-BATCH-PREFIX = '#CL'
 20749         GO TO 4905-READ-PREV-RECORD.
 20750
 20751     IF FIRST-TIME
 20752         MOVE SPACE               TO WS-FIRST-TIME-SW
 20753         GO TO 4905-READ-PREV-RECORD.
 20754
 20755     IF PB-CSR-COMPANY-CD   NOT = PI-COMPANY-CD OR
 20756        PB-CSR-ID           NOT = PI-PB-CSR-ID
 20757        GO TO 4950-END-RECORDS.
 20758
 20759     IF PB-BATCH-TRAILER
 20760        GO TO 4905-READ-PREV-RECORD.
 20761
 20762     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20763
 20764     IF  WS-BATCH-PREFIX = '#CL'
 20765         GO TO 4905-READ-PREV-RECORD.
 20766
 20767     IF PI-PB-CERT-NO NOT = LOW-VALUES
 20768        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 20769           GO TO 4905-READ-PREV-RECORD
 20770        ELSE
 20771           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 20772              GO TO 4910-CHECK-REC-TYPE
 20773           ELSE
 20774              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 20775                 GO TO 4910-CHECK-REC-TYPE
 20776              ELSE
 20777                 GO TO 4905-READ-PREV-RECORD.
 20778
 20779     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 20780        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 20781           GO TO 4905-READ-PREV-RECORD.
 20782
 20783 4910-CHECK-REC-TYPE.
 20784     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20785         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20786             NEXT SENTENCE
 20787         ELSE
 20788             GO TO 4905-READ-PREV-RECORD.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 381
* EL6311.cbl
 20789
 20790     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20791         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20792             NEXT SENTENCE
 20793        ELSE
 20794             GO TO 4905-READ-PREV-RECORD.
 20795
 20796     IF NOT DISPLAY-CHANGE-RECORDS AND
 20797            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20798        GO TO 4905-READ-PREV-RECORD.
 20799
 20800     IF DISPLAY-HOLD-RECORDS AND
 20801        NOT PB-RECORD-ON-HOLD
 20802          GO TO 4905-READ-PREV-RECORD.
 20803
 20804     IF PB-ISSUE
 20805        IF DISPLAY-CHK-REQ-RECORDS
 20806           GO TO 4905-READ-PREV-RECORD.
 20807
 20808     IF PB-ISSUE
 20809        IF ISSUE-WITH-WARNING
 20810           IF PB-WARNING-ERRORS
 20811              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20812                  GO TO 4505-READ-PREV-RECORD
 20813              ELSE
 20814                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20815                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20816                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20817                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20818                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20819                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20820                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20821                 GO TO 7000-DISPLAY-ISSUES
 20822           ELSE
 20823              GO TO 4905-READ-PREV-RECORD.
 20824
 20825     IF PB-ISSUE
 20826        IF (ISSUES-IN-ERROR AND
 20827            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20828            ALL-ISSUES
 20829            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20830            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20831            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20832            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20833            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20834            MOVE PB-SV-STATE            TO PI-SV-STATE
 20835            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20836            GO TO 7000-DISPLAY-ISSUES
 20837        ELSE
 20838            GO TO 4905-READ-PREV-RECORD.
 20839
 20840     IF PB-CANCELLATION
 20841        IF DISPLAY-CHK-REQ-RECORDS
 20842           IF PB-C-REFUND-REQUESTED
 20843              MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20844              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20845              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20846              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 382
* EL6311.cbl
 20847              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20848              MOVE PB-SV-STATE            TO PI-SV-STATE
 20849              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20850              GO TO 7100-DISPLAY-CANCELS
 20851           ELSE
 20852              GO TO 4905-READ-PREV-RECORD.
 20853
 20854     IF PB-CANCELLATION
 20855        IF CANCEL-WITH-WARNING
 20856           IF PB-WARNING-ERRORS
 20857              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20858                  GO TO 4505-READ-PREV-RECORD
 20859              ELSE
 20860                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20861                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20862                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20863                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20864                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20865                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20866                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20867                 GO TO 7100-DISPLAY-CANCELS
 20868           ELSE
 20869              GO TO 4905-READ-PREV-RECORD.
 20870
 20871     IF PB-CANCELLATION
 20872        IF (CANCEL-IN-ERROR  AND
 20873            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20874            ALL-CANCELS
 20875            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20876            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20877            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20878            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20879            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20880            MOVE PB-SV-STATE            TO PI-SV-STATE
 20881            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20882            GO TO 7100-DISPLAY-CANCELS.
 20883
 20884     GO TO 4905-READ-PREV-RECORD.
 20885
 20886 4950-END-RECORDS.
 20887     IF PI-MAP-NAME = EL631B
 20888        MOVE -1                  TO BMAINTL
 20889     ELSE
 20890        IF PI-MAP-NAME = EL631C
 20891           MOVE -1               TO CMAINTL
 20892        ELSE
 20893           MOVE -1               TO DPFENTRL.
 20894
 20895     MOVE ER-2255               TO EMI-ERROR.
 20896     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20897     GO TO 8200-SEND-DATAONLY.
 20898
 20899 4970-NOT-FOUND.
 20900
 20901******************************************************************
 20902*      CONDITION MAY OCCUR IF PREV. RECORD HAS BEEN DELETED.     *
 20903******************************************************************
 20904
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 383
* EL6311.cbl
 20905
 20906* EXEC CICS RESETBR
 20907*         DATASET    (FILE-ID-ERPNDB4)
 20908*         RIDFLD     (ERPNDB-CSR-KEY)
 20909*    END-EXEC.
 20910     MOVE 0
 20911       TO DFHEIV11
 20912*    MOVE '&4         G          &   #00017868' TO DFHEIV0
 20913     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 20914     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20915     MOVE X'2020233030303137383638' TO DFHEIV0(25:11)
 20916     CALL 'kxdfhei1' USING DFHEIV0,
 20917           FILE-ID-ERPNDB4,
 20918           ERPNDB-CSR-KEY,
 20919           DFHEIV99,
 20920           DFHEIV11,
 20921           DFHEIV99
 20922     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20923
 20924
 20925
 20926* EXEC CICS READNEXT
 20927*         DATASET    (FILE-ID-ERPNDB4)
 20928*         SET        (ADDRESS OF PENDING-BUSINESS)
 20929*         RIDFLD     (ERPNDB-CSR-KEY)
 20930*    END-EXEC.
 20931     MOVE 0
 20932       TO DFHEIV11
 20933*    MOVE '&.S                   )   #00017873' TO DFHEIV0
 20934     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 20935     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20936     MOVE X'2020233030303137383733' TO DFHEIV0(25:11)
 20937     CALL 'kxdfhei1' USING DFHEIV0,
 20938           FILE-ID-ERPNDB4,
 20939           DFHEIV20,
 20940           DFHEIV99,
 20941           ERPNDB-CSR-KEY,
 20942           DFHEIV99,
 20943           DFHEIV11,
 20944           DFHEIV99,
 20945           DFHEIV99
 20946     SET ADDRESS OF PENDING-BUSINESS TO
 20947         DFHEIV20
 20948     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20949
 20950
 20951
 20952* EXEC CICS READPREV
 20953*         DATASET    (FILE-ID-ERPNDB4)
 20954*         SET        (ADDRESS OF PENDING-BUSINESS)
 20955*         RIDFLD     (ERPNDB-CSR-KEY)
 20956*    END-EXEC.
 20957     MOVE 0
 20958       TO DFHEIV11
 20959*    MOVE '&0S                   )   #00017879' TO DFHEIV0
 20960     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20961     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20962     MOVE X'2020233030303137383739' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 384
* EL6311.cbl
 20963     CALL 'kxdfhei1' USING DFHEIV0,
 20964           FILE-ID-ERPNDB4,
 20965           DFHEIV20,
 20966           DFHEIV99,
 20967           ERPNDB-CSR-KEY,
 20968           DFHEIV99,
 20969           DFHEIV11,
 20970           DFHEIV99,
 20971           DFHEIV99
 20972     SET ADDRESS OF PENDING-BUSINESS TO
 20973         DFHEIV20
 20974     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20975
 20976
 20977 4980-READ-PREV-RECORD.
 20978
 20979* EXEC CICS READPREV
 20980*         DATASET    (FILE-ID-ERPNDB4)
 20981*         SET        (ADDRESS OF PENDING-BUSINESS)
 20982*         RIDFLD     (ERPNDB-CSR-KEY)
 20983*    END-EXEC.
 20984     MOVE 0
 20985       TO DFHEIV11
 20986*    MOVE '&0S                   )   #00017886' TO DFHEIV0
 20987     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20988     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20989     MOVE X'2020233030303137383836' TO DFHEIV0(25:11)
 20990     CALL 'kxdfhei1' USING DFHEIV0,
 20991           FILE-ID-ERPNDB4,
 20992           DFHEIV20,
 20993           DFHEIV99,
 20994           ERPNDB-CSR-KEY,
 20995           DFHEIV99,
 20996           DFHEIV11,
 20997           DFHEIV99,
 20998           DFHEIV99
 20999     SET ADDRESS OF PENDING-BUSINESS TO
 21000         DFHEIV20
 21001     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21002
 21003
 21004     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 21005
 21006     IF WS-BATCH-PREFIX = '#CL'
 21007        GO TO 4980-READ-PREV-RECORD.
 21008
 21009     MOVE SPACE                  TO WS-FIRST-TIME-SW.
 21010     GO TO 4905-READ-PREV-RECORD.
 21011
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 385
* EL6311.cbl
 21013
 21014
 21015******************************************************************
 21016*                                                                *
 21017*        B R O W S E   B A T C H   H E A D E R S                 *
 21018*                                                                *
 21019******************************************************************
 21020
 21021 5000-BROWSE-BATCH-HEADERS.
 21022
 21023     IF EIBTRNID NOT = TRANS-EXB1
 21024        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY
 21025        MOVE +9999               TO ERPNDB-BATCH-SEQ-NO
 21026        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 21027        GO TO 5010-READ-NEXT-RECORD.
 21028
 21029     IF EIBAID = DFHPF4
 21030        MOVE '0'                TO PI-EDIT-SW
 21031        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 21032        MOVE +9999               TO ERPNDB-BATCH-SEQ-NO
 21033        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 21034        GO TO 5010-READ-NEXT-RECORD.
 21035
 21036     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 21037     MOVE HIGH-VALUES            TO ERPNDB-BATCH-SEQ-ALPHA.
 21038     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 21039
 21040
 21041* EXEC CICS HANDLE CONDITION
 21042*         ENDFILE  (5050-NOT-FOUND)
 21043*    END-EXEC.
 21044*    MOVE '"$''                   ! M #00017928' TO DFHEIV0
 21045     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 21046     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21047     MOVE X'4D20233030303137393238' TO DFHEIV0(25:11)
 21048     CALL 'kxdfhei1' USING DFHEIV0
 21049     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21050
 21051
 21052 5010-READ-NEXT-RECORD.
 21053
 21054* EXEC CICS HANDLE CONDITION
 21055*         NOTFND    (5050-NOT-FOUND)
 21056*    END-EXEC.
 21057*    MOVE '"$I                   ! N #00017933' TO DFHEIV0
 21058     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21059     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21060     MOVE X'4E20233030303137393333' TO DFHEIV0(25:11)
 21061     CALL 'kxdfhei1' USING DFHEIV0
 21062     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21063
 21064
 21065
 21066* EXEC CICS READ
 21067*         DATASET   (FILE-ID-ERPNDB)
 21068*         SET       (ADDRESS OF PENDING-BUSINESS)
 21069*         RIDFLD    (ERPNDB-KEY)
 21070*         GTEQ
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 386
* EL6311.cbl
 21071*    END-EXEC.
 21072*    MOVE '&"S        G          (   #00017937' TO DFHEIV0
 21073     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 21074     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21075     MOVE X'2020233030303137393337' TO DFHEIV0(25:11)
 21076     CALL 'kxdfhei1' USING DFHEIV0,
 21077           FILE-ID-ERPNDB,
 21078           DFHEIV20,
 21079           DFHEIV99,
 21080           ERPNDB-KEY,
 21081           DFHEIV99,
 21082           DFHEIV99,
 21083           DFHEIV99
 21084     SET ADDRESS OF PENDING-BUSINESS TO
 21085         DFHEIV20
 21086     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21087
 21088
 21089     IF PB-COMPANY-CD NOT = PI-COMPANY-CD
 21090         GO TO 5050-NOT-FOUND.
 21091
 21092     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 21093
 21094     IF WS-BATCH-PREFIX = '#CL'
 21095         MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 21096         MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
 21097         GO TO 5010-READ-NEXT-RECORD.
 21098
 21099     IF NOT PB-BATCH-TRAILER
 21100         MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 21101         MOVE +9999            TO ERPNDB-BATCH-SEQ-NO
 21102         GO TO 5010-READ-NEXT-RECORD.
 21103
 21104     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 21105         IF  PB-CARRIER = PI-CARRIER-SECURITY
 21106             NEXT SENTENCE
 21107         ELSE
 21108             MOVE PB-ENTRY-BATCH     TO ERPNDB-ENTRY-BATCH
 21109             MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 21110             MOVE ZEROS              TO ERPNDB-BATCH-CHG-SEQ-NO
 21111             GO TO 5010-READ-NEXT-RECORD.
 21112
 21113     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 21114         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 21115             NEXT SENTENCE
 21116        ELSE
 21117             MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 21118             MOVE ZEROS              TO ERPNDB-BATCH-CHG-SEQ-NO
 21119             GO TO 5010-READ-NEXT-RECORD.
 21120
 21121     IF EIBAID = DFHPF4
 21122        MOVE '0'                TO PI-EDIT-SW
 21123        GO TO 7200-DISPLAY-BATCHES.
 21124
 21125     IF PI-CSR-BROWSE
 21126        IF PB-CSR-ID           NOT = PI-PB-CSR-ID
 21127           MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 21128           MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 387
* EL6311.cbl
 21129           GO TO 5010-READ-NEXT-RECORD.
 21130
 21131     IF ONLY-BATCH-HEADERS OR PB-OUT-OF-BAL
 21132       IF PI-PB-CARRIER    = SPACES AND
 21133          PI-PB-GROUPING   = SPACES AND
 21134          PI-PB-STATE      = SPACES AND
 21135          PI-PB-ACCOUNT    = SPACES
 21136            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 21137            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 21138            GO TO 7200-DISPLAY-BATCHES
 21139         ELSE
 21140           IF PI-PB-CARRIER    = PB-CARRIER  AND
 21141              PI-PB-GROUPING   = PB-GROUPING AND
 21142              PI-PB-STATE      = PB-STATE    AND
 21143              PI-PB-ACCOUNT    = PB-ACCOUNT
 21144              MOVE PB-CONTROL-PRIMARY  TO PI-PREV-KEY
 21145              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 21146              GO TO 7200-DISPLAY-BATCHES.
 21147
 21148     MOVE PB-CONTROL-PRIMARY        TO ERPNDB-KEY.
 21149     MOVE HIGH-VALUE                TO ERPNDB-BATCH-SEQ-ALPHA.
 21150
 21151
 21152* EXEC CICS HANDLE CONDITION
 21153*         NOTFND    (5050-NOT-FOUND)
 21154*    END-EXEC.
 21155*    MOVE '"$I                   ! O #00018006' TO DFHEIV0
 21156     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21157     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21158     MOVE X'4F20233030303138303036' TO DFHEIV0(25:11)
 21159     CALL 'kxdfhei1' USING DFHEIV0
 21160     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21161
 21162
 21163
 21164* EXEC CICS READ
 21165*         DATASET   (FILE-ID-ERPNDB)
 21166*         SET       (ADDRESS OF PENDING-BUSINESS)
 21167*         RIDFLD    (ERPNDB-KEY)
 21168*         GTEQ
 21169*    END-EXEC.
 21170*    MOVE '&"S        G          (   #00018010' TO DFHEIV0
 21171     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 21172     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21173     MOVE X'2020233030303138303130' TO DFHEIV0(25:11)
 21174     CALL 'kxdfhei1' USING DFHEIV0,
 21175           FILE-ID-ERPNDB,
 21176           DFHEIV20,
 21177           DFHEIV99,
 21178           ERPNDB-KEY,
 21179           DFHEIV99,
 21180           DFHEIV99,
 21181           DFHEIV99
 21182     SET ADDRESS OF PENDING-BUSINESS TO
 21183         DFHEIV20
 21184     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21185
 21186
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 388
* EL6311.cbl
 21187     GO TO 5010-READ-NEXT-RECORD.
 21188
 21189 5050-NOT-FOUND.
 21190
 21191******************************************************************
 21192*                                                                *
 21193*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 21194*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING     *
 21195*         PROGRAM.                                               *
 21196*                                                                *
 21197******************************************************************
 21198
 21199     IF EIBTRNID NOT = TRANS-EXB1
 21200        IF PENDING-BUS-RECS-FOUND
 21201            NEXT SENTENCE
 21202          ELSE
 21203            MOVE '9'            TO PI-BROWSE-SW
 21204            GO TO 9400-CLEAR.
 21205
 21206     MOVE ER-2256                TO EMI-ERROR.
 21207     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21208
 21209     IF PI-MAP-NAME = SPACES
 21210        MOVE EL631D              TO PI-MAP-NAME
 21211        MOVE -1                  TO DPFENTRL
 21212        GO TO 8100-SEND-INITIAL-MAP.
 21213
 21214     IF PI-MAP-NAME = EL631B
 21215        MOVE -1                  TO BMAINTL
 21216     ELSE
 21217        IF PI-MAP-NAME = EL631C
 21218           MOVE -1               TO CMAINTL
 21219        ELSE
 21220           MOVE -1               TO DPFENTRL
 21221           GO TO 8200-SEND-DATAONLY.
 21222
 21223     GO TO 8100-SEND-INITIAL-MAP.
 21224
 21225     .
 21226 5100-PROCESS-POL-RESC.
 21227     MOVE ZEROS                  TO CG-LF-BENCD
 21228                                    CG-AH-BENCD
 21229                                    CG-LF-CAN-AMT
 21230                                    CG-AH-CAN-AMT
 21231     MOVE LOW-VALUES             TO CG-LF-CAN-DT
 21232                                    CG-AH-CAN-DT
 21233     MOVE SPACES                 TO CG-BATCH-NO
 21234     MOVE '4'                    TO CG-OPTION-CODE
 21235     MOVE PI-COMPANY-ID          TO CG-COMPANY-ID
 21236     MOVE PI-PROCESSOR-ID        TO CG-PROC-ID
 21237     MOVE PI-CR-MONTH-END-DT     TO CG-MONTH-END-DT
 21238     MOVE PI-COMPANY-CD          TO CG-CERT-COMPANY-CD
 21239     MOVE PI-SV-CARRIER          TO CG-CERT-CARRIER
 21240     MOVE PI-SV-GROUPING         TO CG-CERT-GROUP
 21241     MOVE PI-SV-STATE            TO CG-CERT-STATE
 21242     MOVE PI-PB-ACCOUNT          TO CG-CERT-ACCOUNT
 21243     MOVE PI-PB-CERT-EFF-DT      TO CG-CERT-EFF-DT
 21244     MOVE PI-PB-CERT-NO          TO CG-CERT-CERT-NO
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 389
* EL6311.cbl
 21245     MOVE PI-PREV-ALT-KEY (1:33)
 21246                                 TO CG-CERT-KEY
 21247     MOVE WS-CURRENT-BIN-DT      TO CG-CURRENT-DT
 21248     MOVE ZEROS                  TO CG-LF-CAN-AMT
 21249                                    CG-AH-CAN-AMT
 21250     MOVE LOW-VALUES             TO CG-LF-CAN-DT
 21251                                    CG-AH-CAN-DT
 21252     MOVE PI-PREV-BATCH          TO CG-BATCH-NO
 21253     MOVE ZERO                   TO CG-BATCH-SEQ-NO
 21254      display 'about to cancel ' cg-cert-key
 21255
 21256* EXEC CICS LINK
 21257*        PROGRAM  ('ELCANC')
 21258*        COMMAREA (CANCEL-GEN-PASS-AREA)
 21259*    END-EXEC
 21260     MOVE LENGTH OF
 21261      CANCEL-GEN-PASS-AREA
 21262       TO DFHEIV11
 21263     MOVE 'ELCANC' TO DFHEIV1
 21264*    MOVE '."C                   (   #00018085' TO DFHEIV0
 21265     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 21266     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21267     MOVE X'2020233030303138303835' TO DFHEIV0(25:11)
 21268     CALL 'kxdfhei1' USING DFHEIV0,
 21269           DFHEIV1,
 21270           CANCEL-GEN-PASS-AREA,
 21271           DFHEIV11,
 21272           DFHEIV99,
 21273           DFHEIV99,
 21274           DFHEIV99,
 21275           DFHEIV99
 21276     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21277     IF CG-SUCCESS
 21278        CONTINUE
 21279     ELSE
 21280        MOVE SPACES              TO EMI-MESSAGE-AREA (1)
 21281        MOVE '3'                 TO EMI-SWITCH1
 21282        MOVE CG-ERROR-CODE TO EMI-TEXT-VARIABLE (1)
 21283        EVALUATE TRUE
 21284           WHEN CG-DATE-ERROR
 21285             MOVE WS-01-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21286           WHEN CG-CERT-NOT-FOUND
 21287             MOVE WS-02-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21288           WHEN CG-AMOUNT-ERROR
 21289             MOVE WS-04-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21290           WHEN CG-OPTION-ERROR
 21291             MOVE WS-05-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21292           WHEN CG-PREV-CAN
 21293             MOVE WS-06-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21294           WHEN CG-INVALID-DATA
 21295             MOVE WS-07-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21296           WHEN CG-NO-ACCT-MSTR
 21297             MOVE WS-08-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21298           WHEN CG-SFX-A-EXIST
 21299             MOVE WS-09-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21300           WHEN CG-MISC-ERROR
 21301             MOVE WS-99-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21302           WHEN OTHER
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 390
* EL6311.cbl
 21303             MOVE ' ERROR - ELCANC - RETURN '
 21304                                 TO EMI-ERROR-TEXT (1) (12:25)
 21305        END-EVALUATE
 21306        GO TO 8200-SEND-DATAONLY
 21307     END-IF
 21308
 21309* EXEC CICS GETMAIN
 21310*        SET     (ADDRESS OF CERTIFICATE-TRAILERS)
 21311*        LENGTH  (ELCRTT-RECORD-LENGTH)
 21312*        INITIMG (GETMAIN-SPACE)
 21313*    END-EXEC
 21314*    MOVE ',"IL                  $   #00018120' TO DFHEIV0
 21315     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 21316     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21317     MOVE X'2020233030303138313230' TO DFHEIV0(25:11)
 21318     CALL 'kxdfhei1' USING DFHEIV0,
 21319           DFHEIV20,
 21320           ELCRTT-RECORD-LENGTH,
 21321           GETMAIN-SPACE
 21322     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 21323         DFHEIV20
 21324     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21325
 21326     move ' '                    to ws-elcrtt-update-sw
 21327     MOVE PI-PREV-ALT-KEY (1:33) TO ELCRTT-PRIMARY
 21328     MOVE 'C'                    TO ELCRTT-REC-TYPE
 21329
 21330
 21331* EXEC CICS READ
 21332*        UPDATE
 21333*        DATASET  (CRTT-ID)
 21334*        RIDFLD   (ELCRTT-KEY)
 21335*        INTO     (CERTIFICATE-TRAILERS)
 21336*        resp     (ws-response)
 21337*    END-EXEC
 21338     MOVE LENGTH OF
 21339      CERTIFICATE-TRAILERS
 21340       TO DFHEIV11
 21341*    MOVE '&"IL       EU         (  N#00018130' TO DFHEIV0
 21342     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21343     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21344     MOVE X'204E233030303138313330' TO DFHEIV0(25:11)
 21345     CALL 'kxdfhei1' USING DFHEIV0,
 21346           CRTT-ID,
 21347           CERTIFICATE-TRAILERS,
 21348           DFHEIV11,
 21349           ELCRTT-KEY,
 21350           DFHEIV99,
 21351           DFHEIV99,
 21352           DFHEIV99
 21353     MOVE EIBRESP  TO ws-response
 21354     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21355
 21356     if resp-normal
 21357        if cs-claim-verification-status = 'B' or 'C' or 'D' or
 21358                  'E' or 'F' or 'G'
 21359           move 'J'              to cs-claim-verification-status
 21360           set update-elcrtt to true
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 391
* EL6311.cbl
 21361        end-if
 21362        if update-elcrtt
 21363
 21364* EXEC CICS REWRITE
 21365*             DATASET    (crtt-ID)
 21366*             FROM       (CERTIFICATE-TRAILERS)
 21367*          END-EXEC
 21368     MOVE LENGTH OF
 21369      CERTIFICATE-TRAILERS
 21370       TO DFHEIV11
 21371*    MOVE '&& L                  %   #00018145' TO DFHEIV0
 21372     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 21373     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21374     MOVE X'2020233030303138313435' TO DFHEIV0(25:11)
 21375     CALL 'kxdfhei1' USING DFHEIV0,
 21376           crtt-ID,
 21377           CERTIFICATE-TRAILERS,
 21378           DFHEIV11,
 21379           DFHEIV99
 21380     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21381        else
 21382
 21383* exec cics unlock
 21384*             dataset    (crtt-ID)
 21385*          end-exec
 21386*    MOVE '&*                    #   #00018150' TO DFHEIV0
 21387     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 21388     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 21389     MOVE X'2020233030303138313530' TO DFHEIV0(25:11)
 21390     CALL 'kxdfhei1' USING DFHEIV0,
 21391           crtt-ID,
 21392           DFHEIV99
 21393     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21394        end-if
 21395     end-if
 21396     .
 21397 5100-EXIT.
 21398     EXIT.
 21399
 21400******************************************************************
 21401*                                                                *
 21402*        B R O W S E   B A T C H   B A C K W A R D S             *
 21403*                                                                *
 21404******************************************************************
 21405
 21406 5500-BROWSE-BATCH-BACKWARD.
 21407
 21408* EXEC CICS HANDLE CONDITION
 21409*         NOTFND   (5550-END-RECORDS)
 21410*         ENDFILE  (5550-END-RECORDS)
 21411*    END-EXEC.
 21412*    MOVE '"$I''                  ! P #00018166' TO DFHEIV0
 21413     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21414     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21415     MOVE X'5020233030303138313636' TO DFHEIV0(25:11)
 21416     CALL 'kxdfhei1' USING DFHEIV0
 21417     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21418
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 392
* EL6311.cbl
 21419
 21420 5505-START-BROWSE.
 21421     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 21422     MOVE +1                     TO ERPNDB-BATCH-SEQ-NO.
 21423     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 21424
 21425
 21426* EXEC CICS STARTBR
 21427*         DATASET   (FILE-ID-ERPNDB)
 21428*         RIDFLD    (ERPNDB-ALT-KEY)
 21429*    END-EXEC.
 21430     MOVE 0
 21431       TO DFHEIV11
 21432*    MOVE '&,         G          &   #00018176' TO DFHEIV0
 21433     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21434     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21435     MOVE X'2020233030303138313736' TO DFHEIV0(25:11)
 21436     CALL 'kxdfhei1' USING DFHEIV0,
 21437           FILE-ID-ERPNDB,
 21438           ERPNDB-ALT-KEY,
 21439           DFHEIV99,
 21440           DFHEIV11,
 21441           DFHEIV99
 21442     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21443
 21444
 21445     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 21446
 21447
 21448* EXEC CICS READNEXT
 21449*         DATASET    (FILE-ID-ERPNDB)
 21450*         SET        (ADDRESS OF PENDING-BUSINESS)
 21451*         RIDFLD     (ERPNDB-KEY)
 21452*    END-EXEC.
 21453     MOVE 0
 21454       TO DFHEIV11
 21455*    MOVE '&.S                   )   #00018183' TO DFHEIV0
 21456     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 21457     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21458     MOVE X'2020233030303138313833' TO DFHEIV0(25:11)
 21459     CALL 'kxdfhei1' USING DFHEIV0,
 21460           FILE-ID-ERPNDB,
 21461           DFHEIV20,
 21462           DFHEIV99,
 21463           ERPNDB-KEY,
 21464           DFHEIV99,
 21465           DFHEIV11,
 21466           DFHEIV99,
 21467           DFHEIV99
 21468     SET ADDRESS OF PENDING-BUSINESS TO
 21469         DFHEIV20
 21470     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21471
 21472
 21473
 21474* EXEC CICS READPREV
 21475*         DATASET    (FILE-ID-ERPNDB)
 21476*         SET        (ADDRESS OF PENDING-BUSINESS)
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 393
* EL6311.cbl
 21477*         RIDFLD     (ERPNDB-KEY)
 21478*    END-EXEC.
 21479     MOVE 0
 21480       TO DFHEIV11
 21481*    MOVE '&0S                   )   #00018189' TO DFHEIV0
 21482     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 21483     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21484     MOVE X'2020233030303138313839' TO DFHEIV0(25:11)
 21485     CALL 'kxdfhei1' USING DFHEIV0,
 21486           FILE-ID-ERPNDB,
 21487           DFHEIV20,
 21488           DFHEIV99,
 21489           ERPNDB-KEY,
 21490           DFHEIV99,
 21491           DFHEIV11,
 21492           DFHEIV99,
 21493           DFHEIV99
 21494     SET ADDRESS OF PENDING-BUSINESS TO
 21495         DFHEIV20
 21496     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21497
 21498
 21499
 21500* EXEC CICS READPREV
 21501*         DATASET    (FILE-ID-ERPNDB)
 21502*         SET        (ADDRESS OF PENDING-BUSINESS)
 21503*         RIDFLD     (ERPNDB-KEY)
 21504*    END-EXEC.
 21505     MOVE 0
 21506       TO DFHEIV11
 21507*    MOVE '&0S                   )   #00018195' TO DFHEIV0
 21508     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 21509     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21510     MOVE X'2020233030303138313935' TO DFHEIV0(25:11)
 21511     CALL 'kxdfhei1' USING DFHEIV0,
 21512           FILE-ID-ERPNDB,
 21513           DFHEIV20,
 21514           DFHEIV99,
 21515           ERPNDB-KEY,
 21516           DFHEIV99,
 21517           DFHEIV11,
 21518           DFHEIV99,
 21519           DFHEIV99
 21520     SET ADDRESS OF PENDING-BUSINESS TO
 21521         DFHEIV20
 21522     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21523
 21524
 21525     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD
 21526        GO TO 5550-END-RECORDS.
 21527
 21528     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 21529
 21530     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 21531
 21532     IF  WS-BATCH-PREFIX = '#CL'
 21533             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 21534
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 394
* EL6311.cbl
 21535* EXEC CICS ENDBR
 21536*                 DATASET  (FILE-ID-ERPNDB)
 21537*            END-EXEC
 21538     MOVE 0
 21539       TO DFHEIV11
 21540*    MOVE '&2                    $   #00018210' TO DFHEIV0
 21541     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21542     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21543     MOVE X'2020233030303138323130' TO DFHEIV0(25:11)
 21544     CALL 'kxdfhei1' USING DFHEIV0,
 21545           FILE-ID-ERPNDB,
 21546           DFHEIV11,
 21547           DFHEIV99
 21548     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21549         GO TO 5505-START-BROWSE.
 21550
 21551     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 21552         IF  PB-CARRIER = PI-CARRIER-SECURITY
 21553             NEXT SENTENCE
 21554         ELSE
 21555             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 21556
 21557* EXEC CICS ENDBR
 21558*                 DATASET  (FILE-ID-ERPNDB)
 21559*            END-EXEC
 21560     MOVE 0
 21561       TO DFHEIV11
 21562*    MOVE '&2                    $   #00018220' TO DFHEIV0
 21563     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21564     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21565     MOVE X'2020233030303138323230' TO DFHEIV0(25:11)
 21566     CALL 'kxdfhei1' USING DFHEIV0,
 21567           FILE-ID-ERPNDB,
 21568           DFHEIV11,
 21569           DFHEIV99
 21570     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21571             GO TO 5505-START-BROWSE.
 21572
 21573
 21574     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 21575         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 21576             NEXT SENTENCE
 21577        ELSE
 21578             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 21579
 21580* EXEC CICS ENDBR
 21581*                 DATASET  (FILE-ID-ERPNDB)
 21582*            END-EXEC
 21583     MOVE 0
 21584       TO DFHEIV11
 21585*    MOVE '&2                    $   #00018231' TO DFHEIV0
 21586     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21587     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21588     MOVE X'2020233030303138323331' TO DFHEIV0(25:11)
 21589     CALL 'kxdfhei1' USING DFHEIV0,
 21590           FILE-ID-ERPNDB,
 21591           DFHEIV11,
 21592           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 395
* EL6311.cbl
 21593     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21594             GO TO 5505-START-BROWSE.
 21595
 21596     IF NOT PB-BATCH-TRAILER
 21597        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 21598
 21599* EXEC CICS ENDBR
 21600*            DATASET  (FILE-ID-ERPNDB)
 21601*       END-EXEC
 21602     MOVE 0
 21603       TO DFHEIV11
 21604*    MOVE '&2                    $   #00018238' TO DFHEIV0
 21605     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21606     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21607     MOVE X'2020233030303138323338' TO DFHEIV0(25:11)
 21608     CALL 'kxdfhei1' USING DFHEIV0,
 21609           FILE-ID-ERPNDB,
 21610           DFHEIV11,
 21611           DFHEIV99
 21612     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21613        GO TO 5505-START-BROWSE.
 21614
 21615     IF PI-CSR-BROWSE
 21616        IF PB-CSR-ID           NOT = PI-PB-CSR-ID
 21617           MOVE SPACE            TO WS-BROWSE-STARTED-SW
 21618
 21619* EXEC CICS ENDBR
 21620*               DATASET  (FILE-ID-ERPNDB)
 21621*          END-EXEC
 21622     MOVE 0
 21623       TO DFHEIV11
 21624*    MOVE '&2                    $   #00018246' TO DFHEIV0
 21625     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21626     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21627     MOVE X'2020233030303138323436' TO DFHEIV0(25:11)
 21628     CALL 'kxdfhei1' USING DFHEIV0,
 21629           FILE-ID-ERPNDB,
 21630           DFHEIV11,
 21631           DFHEIV99
 21632     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21633           GO TO 5505-START-BROWSE.
 21634
 21635     IF ONLY-BATCH-HEADERS OR PB-OUT-OF-BAL
 21636        IF PI-PB-CARRIER    = SPACES AND
 21637           PI-PB-GROUPING   = SPACES AND
 21638           PI-PB-STATE      = SPACES AND
 21639           PI-PB-ACCOUNT    = SPACES
 21640             GO TO 7200-DISPLAY-BATCHES
 21641          ELSE
 21642            IF PI-PB-CARRIER    = PB-CARRIER  AND
 21643               PI-PB-GROUPING   = PB-GROUPING AND
 21644               PI-PB-STATE      = PB-STATE    AND
 21645               PI-PB-ACCOUNT    = PB-ACCOUNT
 21646                 GO TO 7200-DISPLAY-BATCHES.
 21647
 21648     MOVE SPACE                  TO WS-BROWSE-STARTED-SW.
 21649
 21650
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 396
* EL6311.cbl
 21651* EXEC CICS ENDBR
 21652*         DATASET  (FILE-ID-ERPNDB)
 21653*    END-EXEC.
 21654     MOVE 0
 21655       TO DFHEIV11
 21656*    MOVE '&2                    $   #00018266' TO DFHEIV0
 21657     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21658     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21659     MOVE X'2020233030303138323636' TO DFHEIV0(25:11)
 21660     CALL 'kxdfhei1' USING DFHEIV0,
 21661           FILE-ID-ERPNDB,
 21662           DFHEIV11,
 21663           DFHEIV99
 21664     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21665
 21666
 21667     GO TO 5505-START-BROWSE.
 21668
 21669 5550-END-RECORDS.
 21670     MOVE ER-2257                TO EMI-ERROR.
 21671     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21672     MOVE -1                     TO DPFENTRL.
 21673
 21674     GO TO 8200-SEND-DATAONLY.
 21675
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 397
* EL6311.cbl
 21677
 21678******************************************************************
 21679*                                                                *
 21680*        C R E A T E   T E M P O R A R Y   S T O R A G E         *
 21681*                                                                *
 21682******************************************************************
 21683
 21684 6000-CREATE-TEMP-STORAGE.
 21685
 21686
 21687* EXEC CICS HANDLE CONDITION
 21688*        QIDERR  (6050-QID-ERROR)
 21689*    END-EXEC.
 21690*    MOVE '"$N                   ! Q #00018289' TO DFHEIV0
 21691     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 21692     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21693     MOVE X'5120233030303138323839' TO DFHEIV0(25:11)
 21694     CALL 'kxdfhei1' USING DFHEIV0
 21695     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21696
 21697
 21698
 21699* EXEC CICS WRITEQ TS
 21700*        QUEUE    (QID)
 21701*        FROM     (PROGRAM-INTERFACE-BLOCK)
 21702*        LENGTH   (WS-COMM-LENGTH)
 21703*        ITEM     (W-ONE)
 21704*    END-EXEC.
 21705*    MOVE '*" I   L              ''   #00018293' TO DFHEIV0
 21706     MOVE X'2A2220492020204C20202020' TO DFHEIV0(1:12)
 21707     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21708     MOVE X'2020233030303138323933' TO DFHEIV0(25:11)
 21709     CALL 'kxdfhei1' USING DFHEIV0,
 21710           QID,
 21711           PROGRAM-INTERFACE-BLOCK,
 21712           WS-COMM-LENGTH,
 21713           W-ONE,
 21714           DFHEIV99,
 21715           DFHEIV99
 21716     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21717
 21718
 21719 6000-EXIT.
 21720      EXIT.
 21721
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 398
* EL6311.cbl
 21723
 21724******************************************************************
 21725*                                                                *
 21726*        R E C O V E R   T E M P O R A R Y   S T O R A G E       *
 21727*                                                                *
 21728******************************************************************
 21729
 21730 6050-RECOVER-TEMP-STORAGE.
 21731     IF PGM-NAME = XCTL-EL6312
 21732        GO TO 6050-EXIT.
 21733
 21734     IF PGM-NAME = XCTL-EL6313
 21735        GO TO 6050-EXIT.
 21736
 21737     IF PGM-NAME = XCTL-EL6315
 21738         MOVE PI-PROGRAM-WORK-AREA TO WS-EL6315-PASS-AREA
 21739     END-IF
 21740
 21741     IF PGM-NAME = XCTL-EL6316
 21742         MOVE PI-PROGRAM-WORK-AREA TO WS-EL6316-PASS-AREA
 21743     END-IF
 21744
 21745
 21746* EXEC CICS HANDLE CONDITION
 21747*        QIDERR  (6050-QID-ERROR)
 21748*    END-EXEC.
 21749*    MOVE '"$N                   ! R #00018326' TO DFHEIV0
 21750     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 21751     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21752     MOVE X'5220233030303138333236' TO DFHEIV0(25:11)
 21753     CALL 'kxdfhei1' USING DFHEIV0
 21754     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21755
 21756
 21757
 21758* EXEC CICS READQ TS
 21759*         QUEUE   (QID)
 21760*         INTO    (PROGRAM-INTERFACE-BLOCK)
 21761*         LENGTH  (WS-COMM-LENGTH)
 21762*         ITEM    (W-ONE)
 21763*     END-EXEC.
 21764*    MOVE '*$II   L              ''   #00018330' TO DFHEIV0
 21765     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
 21766     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21767     MOVE X'2020233030303138333330' TO DFHEIV0(25:11)
 21768     CALL 'kxdfhei1' USING DFHEIV0,
 21769           QID,
 21770           PROGRAM-INTERFACE-BLOCK,
 21771           WS-COMM-LENGTH,
 21772           W-ONE,
 21773           DFHEIV99,
 21774           DFHEIV99
 21775     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21776
 21777
 21778 6050-DELETE-TEMP-STORAGE.
 21779
 21780
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 399
* EL6311.cbl
 21781* EXEC CICS DELETEQ TS
 21782*        QUEUE   (QID)
 21783*    END-EXEC.
 21784*    MOVE '*&                    #   #00018339' TO DFHEIV0
 21785     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
 21786     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 21787     MOVE X'2020233030303138333339' TO DFHEIV0(25:11)
 21788     CALL 'kxdfhei1' USING DFHEIV0,
 21789           QID,
 21790           DFHEIV99
 21791     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21792
 21793
 21794     GO TO 6050-EXIT.
 21795
 21796 6050-QID-ERROR.
 21797     MOVE ER-0033                TO EMI-ERROR
 21798     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21799
 21800 6050-EXIT.
 21801      EXIT.
 21802
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 400
* EL6311.cbl
 21804
 21805******************************************************************
 21806*                                                                *
 21807*            T E R M   C O N V E R S I O N                       *
 21808*                                                                *
 21809******************************************************************
 21810
 21811 6100-TERM-CONVERSION.
 21812
 21813     IF PI-BPMTS = ZERO
 21814         GO TO 6199-EXIT.
 21815
 21816     IF PI-BMODE = ' ' OR 'M'
 21817         MOVE PI-BPMTS      TO WS-CALC-TERM-WHOLE
 21818         GO TO 6105-ROUND-TERM.
 21819
 21820     IF PI-BMODE = 'S'
 21821         COMPUTE WS-CALC-TERM = PI-BPMTS / 2
 21822         GO TO 6105-ROUND-TERM.
 21823
 21824     IF PI-BMODE = 'W'
 21825         COMPUTE WS-CALC-TERM = PI-BPMTS / 4.33333
 21826         GO TO 6105-ROUND-TERM.
 21827
 21828     IF PI-BMODE = 'B'
 21829         COMPUTE WS-CALC-TERM = PI-BPMTS / 2.16667
 21830         GO TO 6105-ROUND-TERM.
 21831
 21832     IF PI-BMODE = 'T'
 21833         COMPUTE WS-CALC-TERM = PI-BPMTS / 1.08334.
 21834
 21835 6105-ROUND-TERM.
 21836
 21837     IF WS-CALC-TERM-REMAIN GREATER THAN .00000
 21838         ADD +1                  TO WS-CALC-TERM-WHOLE
 21839         MOVE ZEROS              TO WS-CALC-TERM-REMAIN.
 21840
 21841     IF PI-COMPANY-ID = CLIENT-CRI OR CLIENT-LGX
 21842         GO TO 6125-COMPUTE-TERM-BENEFIT.
 21843
 21844     IF BTERM-LEN (WS-SUB1) NOT GREATER THAN +0
 21845         MOVE WS-CALC-TERM-WHOLE   TO BTERMO      (WS-SUB1)
 21846                                      WS-BTERM    (WS-SUB1)
 21847         MOVE +3                   TO BTERM-LEN   (WS-SUB1).
 21848
 21849     IF BTERM-LEN (WS-SUB1) GREATER THAN +0
 21850         IF WS-BTERM (WS-SUB1)   NOT = WS-CALC-TERM-WHOLE
 21851             MOVE -1               TO BMODEL
 21852             MOVE ER-2593          TO EMI-ERROR
 21853             MOVE AL-UNBON         TO BTERM-ATTRB (WS-SUB1)
 21854             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21855
 21856 6124-CHECK-BENEFIT.
 21857
 21858     IF BBEN-LEN (WS-SUB1) NOT GREATER THAN +0
 21859        GO TO 6126-COMPUTE-BENEFIT.
 21860
 21861     GO TO 6199-EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 401
* EL6311.cbl
 21862
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 402
* EL6311.cbl
 21864******************************************************************
 21865**         COMPUTE TERM AND BENEFIT
 21866******************************************************************
 21867 6125-COMPUTE-TERM-BENEFIT.
 21868
 21869     IF PI-BTYPE (WS-SUB1) = SPACES  OR
 21870        PI-BPMTAMT = ZERO
 21871         GO TO 6199-EXIT.
 21872
 21873     MOVE WS-CALC-TERM-WHOLE     TO  BTERMI    (WS-SUB1)
 21874                                     WS-BTERM  (WS-SUB1).
 21875     MOVE +3                     TO  BTERM-LEN (WS-SUB1).
 21876
 21877 6126-COMPUTE-BENEFIT.
 21878
 21879     IF PI-BMODE = 'M' OR  ' '
 21880         MOVE PI-BPMTAMT        TO  WS-BBEN (WS-SUB1).
 21881
 21882     IF PI-BMODE = 'W'
 21883         COMPUTE WS-BBEN (WS-SUB1) ROUNDED = PI-BPMTAMT * 4.33333.
 21884
 21885     IF PI-BMODE = 'S'
 21886         COMPUTE WS-BBEN (WS-SUB1)  ROUNDED = PI-BPMTAMT * 2.
 21887
 21888     IF PI-BMODE = 'B'
 21889         COMPUTE WS-BBEN (WS-SUB1) ROUNDED = PI-BPMTAMT * 2.16667.
 21890
 21891     IF PI-BMODE = 'T'
 21892         COMPUTE WS-BBEN (WS-SUB1) ROUNDED = PI-BPMTAMT * 1.08334.
 21893
 21894     IF WS-SUB1 = +1
 21895        COMPUTE WS-BBEN (WS-SUB1) =
 21896                WS-BBEN (WS-SUB1) * WS-CALC-TERM.
 21897
 21898     MOVE WS-BBEN (WS-SUB1)           TO BBENO       (WS-SUB1).
 21899     MOVE +12                         TO BBEN-LEN    (WS-SUB1).
 21900     MOVE AL-UNNON                    TO BBEN-ATTRB  (WS-SUB1).
 21901
 21902 6199-EXIT.
 21903     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 403
* EL6311.cbl
 21905
 21906******************************************************************
 21907*                                                                *
 21908*             D I S P L A Y   I S S U E S                        *
 21909*                                                                *
 21910******************************************************************
 21911
 21912 6200-CREATE-VADS.
 21913     MOVE PI-PREV-KEY            TO PI-ERPNDB-KEY
 21914     MOVE  PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY
 21915     MOVE SPACES                 TO WS-PASS-VADS-REC
 21916
 21917* EXEC CICS GETMAIN
 21918*       SET      (ADDRESS OF PENDING-BUSINESS)
 21919*       LENGTH   (ERPNDB-RECORD-LENGTH)
 21920*       INITIMG  (GETMAIN-SPACE)
 21921*       RESP     (WS-RESPONSE)
 21922*    END-EXEC
 21923*    MOVE ',"IL                  $  N#00018465' TO DFHEIV0
 21924     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 21925     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21926     MOVE X'204E233030303138343635' TO DFHEIV0(25:11)
 21927     CALL 'kxdfhei1' USING DFHEIV0,
 21928           DFHEIV20,
 21929           ERPNDB-RECORD-LENGTH,
 21930           GETMAIN-SPACE
 21931     SET ADDRESS OF PENDING-BUSINESS TO
 21932         DFHEIV20
 21933     MOVE EIBRESP  TO WS-RESPONSE
 21934     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21935
 21936* EXEC CICS READ
 21937*       INTO    (PENDING-BUSINESS)
 21938*       DATASET (FILE-ID-ERPNDB)
 21939*       RIDFLD  (ERPNDB-KEY)
 21940*       RESP    (WS-RESPONSE)
 21941*    END-EXEC
 21942     MOVE LENGTH OF
 21943      PENDING-BUSINESS
 21944       TO DFHEIV11
 21945*    MOVE '&"IL       E          (  N#00018471' TO DFHEIV0
 21946     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21947     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21948     MOVE X'204E233030303138343731' TO DFHEIV0(25:11)
 21949     CALL 'kxdfhei1' USING DFHEIV0,
 21950           FILE-ID-ERPNDB,
 21951           PENDING-BUSINESS,
 21952           DFHEIV11,
 21953           ERPNDB-KEY,
 21954           DFHEIV99,
 21955           DFHEIV99,
 21956           DFHEIV99
 21957     MOVE EIBRESP  TO WS-RESPONSE
 21958     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21959     IF RESP-NORMAL
 21960        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
 21961        IF (RESP-NORMAL)
 21962           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 404
* EL6311.cbl
 21963              AM-CONTROL-PRIMARY (1:20))
 21964           MOVE AM-NAME          TO VD-ACCOUNT-NAME
 21965        ELSE
 21966           MOVE 'ACCOUNT NOT FOUND'
 21967                                 TO VD-ACCOUNT-NAME
 21968        END-IF
 21969        MOVE FUNCTION LENGTH(VD-ACCOUNT-NAME)
 21970                                    TO M1
 21971        MOVE VD-ACCOUNT-NAME        TO WS-WORK-FIELD
 21972        PERFORM VARYING A2 FROM +1 BY +1 UNTIL
 21973           (A2 > M1)
 21974           OR (WS-WORK-FIELD (A2:1) = '*')
 21975           OR (WS-WORK-FIELD (A2:4) = ' DBA' OR ' AKA')
 21976           OR (WS-WORK-FIELD (A2:4) = '(DBA' OR '(AKA')
 21977        END-PERFORM
 21978        IF A2 > M1
 21979           CONTINUE
 21980        ELSE
 21981           MOVE WS-WORK-FIELD (1:A2 - 1)
 21982                                    TO VD-ACCOUNT-NAME
 21983        END-IF
 21984        MOVE PB-COMPANY-CD       TO VD-COMPANY-CD
 21985        MOVE PB-CARRIER          TO VD-CARRIER
 21986        MOVE PB-GROUPING         TO VD-GROUPING
 21987        MOVE PB-STATE            TO VD-STATE
 21988        MOVE PB-ACCOUNT          TO VD-ACCOUNT
 21989        MOVE PB-CERT-EFF-DT      TO VD-CERT-EFF-DT
 21990        MOVE PB-CERT-NO          TO VD-CERT-NO
 21991        MOVE PB-I-INSURED-LAST-NAME TO VD-INSURED-LAST-NAME
 21992        MOVE PB-I-INSURED-FIRST-NAME TO VD-INSURED-FIRST-NAME
 21993        MOVE PB-I-INSURED-MIDDLE-INIT TO VD-INSURED-MIDDLE-INIT
 21994        MOVE PB-I-JOINT-LAST-NAME TO VD-JOINT-LAST-NAME
 21995        MOVE PB-I-JOINT-FIRST-NAME TO VD-JOINT-FIRST-NAME
 21996        MOVE PB-I-JOINT-MIDDLE-INIT TO VD-JOINT-MIDDLE-INIT
 21997        MOVE PB-I-BENEFICIARY-NAME TO VD-BENEFICIARY-NAME
 21998        MOVE PB-ENTRY-BATCH      TO VD-ENTRY-BATCH
 21999        MOVE PB-CSR-ID           TO VD-CSR-ID
 22000        MOVE PB-I-LF-BENEFIT-CD  TO VD-LF-BENEFIT-CD
 22001        MOVE PB-I-LF-PREMIUM-AMT TO VD-LF-PREMIUM-AMT
 22002        MOVE PB-I-LF-BENEFIT-AMT TO VD-LF-BENEFIT-AMT
 22003        MOVE PB-I-LF-TERM        TO VD-LF-TERM
 22004        MOVE PB-I-LF-RATE        TO VD-LF-RATE
 22005        MOVE PB-I-AH-BENEFIT-CD  TO VD-AH-BENEFIT-CD
 22006        MOVE PB-I-AH-PREMIUM-AMT TO VD-AH-PREMIUM-AMT
 22007        MOVE PB-I-AH-BENEFIT-AMT TO VD-AH-BENEFIT-AMT
 22008        MOVE PB-I-AH-TERM        TO VD-AH-TERM
 22009        MOVE PB-I-AH-RATE        TO VD-AH-RATE
 22010        MOVE PB-I-LOAN-TERM      TO VD-LOAN-TERM
 22011        MOVE PB-I-LOAN-APR       TO VD-LOAN-APR
 22012        MOVE PB-I-1ST-PMT-DT     TO VD-1ST-PMT-DT
 22013     END-IF
 22014     MOVE PB-CONTROL-PRIMARY     TO  ERPNDM-KEY.
 22015
 22016
 22017* EXEC CICS GETMAIN
 22018*       SET      (ADDRESS OF PENDING-MAILING-DATA)
 22019*       LENGTH   (ERPNDM-RECORD-LENGTH)
 22020*       INITIMG  (GETMAIN-SPACE)
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 405
* EL6311.cbl
 22021*       RESP     (WS-RESPONSE)
 22022*    END-EXEC
 22023*    MOVE ',"IL                  $  N#00018534' TO DFHEIV0
 22024     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 22025     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 22026     MOVE X'204E233030303138353334' TO DFHEIV0(25:11)
 22027     CALL 'kxdfhei1' USING DFHEIV0,
 22028           DFHEIV20,
 22029           ERPNDM-RECORD-LENGTH,
 22030           GETMAIN-SPACE
 22031     SET ADDRESS OF PENDING-MAILING-DATA TO
 22032         DFHEIV20
 22033     MOVE EIBRESP  TO WS-RESPONSE
 22034     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22035
 22036
 22037* EXEC CICS READ
 22038*       INTO    (PENDING-MAILING-DATA)
 22039*       DATASET (FILE-ID-ERPNDM)
 22040*       RIDFLD  (ERPNDM-KEY)
 22041*       RESP    (WS-RESPONSE)
 22042*    END-EXEC
 22043     MOVE LENGTH OF
 22044      PENDING-MAILING-DATA
 22045       TO DFHEIV11
 22046*    MOVE '&"IL       E          (  N#00018541' TO DFHEIV0
 22047     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22048     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22049     MOVE X'204E233030303138353431' TO DFHEIV0(25:11)
 22050     CALL 'kxdfhei1' USING DFHEIV0,
 22051           FILE-ID-ERPNDM,
 22052           PENDING-MAILING-DATA,
 22053           DFHEIV11,
 22054           ERPNDM-KEY,
 22055           DFHEIV99,
 22056           DFHEIV99,
 22057           DFHEIV99
 22058     MOVE EIBRESP  TO WS-RESPONSE
 22059     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22060
 22061     IF RESP-NORMAL
 22062        MOVE PM-ADDRESS-LINE-1    TO VD-INSURED-ADDRESS-1
 22063        MOVE PM-ADDRESS-LINE-2    TO VD-INSURED-ADDRESS-2
 22064        MOVE PM-CITY              TO VD-INSURED-CITY
 22065        MOVE PM-STATE             TO VD-INSURED-STATE
 22066        MOVE PM-ZIP               TO VD-INSURED-ZIP-CODE
 22067     END-IF
 22068
 22069     MOVE 'VAC1'                  TO VD-LETTER-ID
 22070     MOVE PI-PROCESSOR-ID         TO VD-PROC-ID
 22071     MOVE PI-COMPANY-ID           TO VD-COMP-ID
 22072     MOVE EIBTIME                 TO VD-CURRENT-TIME
 22073     MOVE WS-CURRENT-BIN-DT       TO VD-CURRENT-DATE
 22074     MOVE +0                      TO VD-ARCHIVE-NO
 22075     MOVE VIRGINIA-DISCLOSURE     TO WS-PASS-VADS-REC
 22076     .
 22077 6200-EXIT.
 22078     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 406
* EL6311.cbl
 22079 6210-READ-ERACCT.
 22080     MOVE PB-CONTROL-BY-ACCOUNT  TO ERACCT-KEY
 22081     MOVE LOW-VALUES             TO ERACCT-FILL
 22082
 22083* EXEC CICS READ
 22084*         DATASET   ('ERACCT')
 22085*         INTO      (ACCOUNT-MASTER)
 22086*         RIDFLD    (ERACCT-KEY)
 22087*         GTEQ
 22088*         RESP      (WS-RESPONSE)
 22089*    END-EXEC
 22090     MOVE LENGTH OF
 22091      ACCOUNT-MASTER
 22092       TO DFHEIV11
 22093     MOVE 'ERACCT' TO DFHEIV1
 22094*    MOVE '&"IL       G          (  N#00018569' TO DFHEIV0
 22095     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 22096     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22097     MOVE X'204E233030303138353639' TO DFHEIV0(25:11)
 22098     CALL 'kxdfhei1' USING DFHEIV0,
 22099           DFHEIV1,
 22100           ACCOUNT-MASTER,
 22101           DFHEIV11,
 22102           ERACCT-KEY,
 22103           DFHEIV99,
 22104           DFHEIV99,
 22105           DFHEIV99
 22106     MOVE EIBRESP  TO WS-RESPONSE
 22107     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22108     .
 22109 6210-EXIT.
 22110     EXIT.
 22111
 22112 6220-READ-ERMAIL.
 22113
 22114     MOVE ELCERT-KEY             TO ERMAIL-KEY
 22115     MOVE ' '                    TO WS-ERMAIL-SW
 22116
 22117
 22118* EXEC CICS READ
 22119*       DATASET   (FILE-ID-ERMAIL)
 22120*       SET       (ADDRESS OF MAILING-DATA)
 22121*       RIDFLD    (ERMAIL-KEY)
 22122*       RESP      (WS-RESPONSE)
 22123*    END-EXEC
 22124*    MOVE '&"S        E          (  N#00018585' TO DFHEIV0
 22125     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 22126     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22127     MOVE X'204E233030303138353835' TO DFHEIV0(25:11)
 22128     CALL 'kxdfhei1' USING DFHEIV0,
 22129           FILE-ID-ERMAIL,
 22130           DFHEIV20,
 22131           DFHEIV99,
 22132           ERMAIL-KEY,
 22133           DFHEIV99,
 22134           DFHEIV99,
 22135           DFHEIV99
 22136     SET ADDRESS OF MAILING-DATA TO
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 407
* EL6311.cbl
 22137         DFHEIV20
 22138     MOVE EIBRESP  TO WS-RESPONSE
 22139     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22140
 22141     IF RESP-NORMAL
 22142        SET ERMAIL-FOUND TO TRUE
 22143     END-IF
 22144     .
 22145 6220-EXIT.
 22146     EXIT.
 22147
 22148 6400-CHECK-FOR-RES-REF-CLAIM.
 22149     display 'made it to 6400- for ' pi-cert-no
 22150     MOVE LOW-VALUES             TO PI-RES-REF-CLM-TYPE
 22151
 22152     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD
 22153                                    W-CL-COMP-CD.
 22154     MOVE PI-CERT-NO             TO MSTR-CERT-NO
 22155                                    W-CL-CERT-NO.
 22156     MOVE SPACES                 TO MSTR-CERT-SFX.
 22157
 22158
 22159* EXEC CICS HANDLE CONDITION
 22160*        NOTFND  (6400-CONTINUE)
 22161*        ENDFILE (6400-CONTINUE)
 22162*    END-EXEC.
 22163*    MOVE '"$I''                  ! S #00018609' TO DFHEIV0
 22164     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 22165     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22166     MOVE X'5320233030303138363039' TO DFHEIV0(25:11)
 22167     CALL 'kxdfhei1' USING DFHEIV0
 22168     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22169
 22170
 22171
 22172* EXEC CICS IGNORE CONDITION
 22173*        DUPKEY
 22174*    END-EXEC.
 22175*    MOVE '"*$                   !   #00018614' TO DFHEIV0
 22176     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 22177     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22178     MOVE X'2020233030303138363134' TO DFHEIV0(25:11)
 22179     CALL 'kxdfhei1' USING DFHEIV0
 22180     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22181
 22182
 22183
 22184* EXEC CICS STARTBR
 22185*        DATASET   (CLMS-ID)
 22186*        RIDFLD    (ELMSTR-KEY)
 22187*        GENERIC   EQUAL
 22188*        KEYLENGTH (ELMSTR-LENGTH)
 22189*    END-EXEC.
 22190     MOVE 0
 22191       TO DFHEIV11
 22192*    MOVE '&,   KG    E          &   #00018618' TO DFHEIV0
 22193     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 22194     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 408
* EL6311.cbl
 22195     MOVE X'2020233030303138363138' TO DFHEIV0(25:11)
 22196     CALL 'kxdfhei1' USING DFHEIV0,
 22197           CLMS-ID,
 22198           ELMSTR-KEY,
 22199           ELMSTR-LENGTH,
 22200           DFHEIV11,
 22201           DFHEIV99
 22202     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22203
 22204
 22205     display 'browse started'
 22206     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 22207
 22208 6400-NEXT-CLAIM.
 22209
 22210
 22211* EXEC CICS READNEXT
 22212*        DATASET   (CLMS-ID)
 22213*        RIDFLD    (ELMSTR-KEY)
 22214*        SET       (ADDRESS OF CLAIM-MASTER)
 22215*    END-EXEC.
 22216     MOVE 0
 22217       TO DFHEIV11
 22218*    MOVE '&.S                   )   #00018630' TO DFHEIV0
 22219     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 22220     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 22221     MOVE X'2020233030303138363330' TO DFHEIV0(25:11)
 22222     CALL 'kxdfhei1' USING DFHEIV0,
 22223           CLMS-ID,
 22224           DFHEIV20,
 22225           DFHEIV99,
 22226           ELMSTR-KEY,
 22227           DFHEIV99,
 22228           DFHEIV11,
 22229           DFHEIV99,
 22230           DFHEIV99
 22231     SET ADDRESS OF CLAIM-MASTER TO
 22232         DFHEIV20
 22233     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22234
 22235
 22236     display 'read claim for ' mstr-cert-no
 22237     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 22238        MSTR-CERT-PRIME NOT = W-CL-CERT-PRIME
 22239         GO TO 6400-CONTINUE
 22240     END-IF.
 22241
 22242     IF PI-CARRIER     NOT = CL-CARRIER        OR
 22243        PI-GROUPING    NOT = CL-CERT-GROUPING  OR
 22244        PI-STATE       NOT = CL-CERT-STATE     OR
 22245        PI-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 22246        PI-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 22247         GO TO 6400-NEXT-CLAIM
 22248     END-IF.
 22249
 22250     display 'found claim ' cl-claim-no
 22251        ' with denial type ' cl-denial-type
 22252     IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 409
* EL6311.cbl
 22253         MOVE CL-DENIAL-TYPE TO PI-RES-REF-CLM-TYPE
 22254         GO TO 6400-CONTINUE
 22255     END-IF.
 22256
 22257     GO TO 6400-NEXT-CLAIM.
 22258
 22259 6400-CONTINUE.
 22260
 22261     IF WS-BROWSE-STARTED-SW = 'Y'
 22262
 22263* EXEC CICS ENDBR
 22264*            DATASET   (CLMS-ID)
 22265*        END-EXEC
 22266     MOVE 0
 22267       TO DFHEIV11
 22268*    MOVE '&2                    $   #00018662' TO DFHEIV0
 22269     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 22270     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 22271     MOVE X'2020233030303138363632' TO DFHEIV0(25:11)
 22272     CALL 'kxdfhei1' USING DFHEIV0,
 22273           CLMS-ID,
 22274           DFHEIV11,
 22275           DFHEIV99
 22276     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22277         MOVE 'N' TO WS-BROWSE-STARTED-SW
 22278     END-IF.
 22279
 22280 6400-EXIT.
 22281     EXIT.
 22282
 22283 7000-DISPLAY-ISSUES.
 22284
 22285     IF PI-DISPLAY-ORIGINAL-BATCH
 22286        MOVE PB-CONTROL-BY-ORIG-BATCH TO PI-PREV-KEY
 22287        MOVE ZEROS                    TO PI-PREV-CHG-SEQ-NO
 22288     ELSE
 22289        MOVE PB-CONTROL-PRIMARY      TO PI-PREV-KEY.
 22290
 22291     MOVE PB-CONTROL-PRIMARY         TO PI-PREV-CONTROL-PRIMARY.
 22292
 22293     MOVE 'Y'                        TO WS-DISPLAY-SW.
 22294     MOVE 'Y'                        TO PI-DISPLAY-SCREEN-SW.
 22295
 22296     MOVE LOW-VALUES                 TO EL631BI.
 22297     MOVE ZEROS                      TO PI-BPMTAMT
 22298                                        PI-BPMTS.
 22299     MOVE SPACE                      TO PI-BMODE
 22300                                        PI-BTYPE (1)
 22301                                        PI-BTYPE (2).
 22302     MOVE EL631B                     TO PI-MAP-NAME.
 22303     MOVE 'Y'                        TO PI-BROWSE-SW.
 22304     MOVE PB-BATCH-SEQ-NO            TO BSEQO
 22305                                        PI-HIGH-SEQ-NO.
 22306
 22307     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 22308        MOVE AL-SABOF                TO BCHGTA
 22309        SUBTRACT PB-BATCH-CHG-SEQ-NO FROM 1000 GIVING BCHGO
 22310        MOVE AL-SANON                TO BCHGA
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 410
* EL6311.cbl
 22311     ELSE
 22312        MOVE AL-SADOF                TO BCHGTA
 22313                                        BCHGA
 22314        MOVE PB-CHG-COUNT            TO BCHGO.
 22315
 22316     MOVE PB-LAST-MAINT-BY           TO BMANTBYO.
 22317     MOVE PB-LAST-MAINT-HHMMSS       TO WS-TIME.
 22318     MOVE WS-HR-MINS                 TO BMANTATO.
 22319
 22320     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 22321        MOVE PB-CREDIT-ACCEPT-DT     TO DC-BIN-DATE-1
 22322        MOVE SPACE                   TO DC-OPTION-CODE
 22323        PERFORM 9700-DATE-LINK
 22324        MOVE DC-GREG-DATE-1-EDIT     TO BMANTDTO
 22325        MOVE 'INACTIVE'              TO BMOENDTO
 22326     ELSE
 22327        MOVE PB-LAST-MAINT-DT        TO DC-BIN-DATE-1
 22328        MOVE SPACE                   TO DC-OPTION-CODE
 22329        PERFORM 9700-DATE-LINK
 22330        MOVE DC-GREG-DATE-1-EDIT     TO BMANTDTO
 22331        MOVE PB-CREDIT-SELECT-DT     TO DC-BIN-DATE-1
 22332        MOVE SPACE                   TO DC-OPTION-CODE
 22333        PERFORM 9700-DATE-LINK
 22334        MOVE DC-GREG-DATE-1-EDIT     TO BMOENDTO.
 22335
 22336*    MOVE PB-I-REFERENCE             TO BREFO.
 22337
 22338*    IF PI-COMPANY-ID EQUAL 'HER'
 22339*        MOVE PB-I-MEMBER-NO     TO  WS-MEMBER-NO
 22340*        IF WS-MEMBER-NO-1-8  IS NUMERIC
 22341*            IF WS-MEMBER-NO-1-8  GREATER  ZEROS
 22342*                MOVE WS-MEMBER-NO-1-8
 22343*                                TO  BMICRNOO.
 22344
 22345*    IF PB-I-MICROFILM-NO  IS NUMERIC
 22346*        IF PB-I-MICROFILM-NO  GREATER  ZEROS
 22347*            MOVE PB-I-MICROFILM-NO
 22348*                                TO  BMICRNOO.
 22349     IF PB-I-VIN NOT = SPACES
 22350        MOVE PB-I-VIN            TO BVINO
 22351     END-IF
 22352     MOVE PB-I-LETTER-REQD           TO LETRREQO
 22353
 22354
 22355     MOVE PB-CERT-PRIME              TO BCERTNOO.
 22356     MOVE PB-CERT-SFX                TO BSUFIXO.
 22357     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 22358     MOVE SPACE                      TO DC-OPTION-CODE.
 22359     PERFORM 9700-DATE-LINK.
 22360     MOVE DC-GREG-DATE-1-EDIT        TO BEFFDTO
 22361
 22362     MOVE PB-I-INSURED-LAST-NAME     TO BLSTNMO.
 22363     MOVE PB-I-INSURED-FIRST-NAME    TO B1STNMO.
 22364     MOVE PB-I-INSURED-MIDDLE-INIT   TO BINITO.
 22365     MOVE PB-I-INSURED-SEX           TO BSEXO
 22366
 22367     IF PB-I-AGE NOT = ZEROS
 22368         MOVE PB-I-AGE               TO BAGEO.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 411
* EL6311.cbl
 22369
 22370     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 22371                                 TO ELCERT-KEY
 22372     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 22373     IF NOT CERT-TRL-REC-NOT-FOUND
 22374         IF CS-INS-AGE-DEFAULT-FLAG = 'Y'
 22375             MOVE 'AGE*'             TO BAGEDEFO
 22376         ELSE
 22377             MOVE 'AGE '             TO BAGEDEFO
 22378         END-IF
 22379     ELSE
 22380         MOVE 'AGE '             TO BAGEDEFO
 22381     END-IF
 22382
 22383     IF PB-I-BIRTHDAY NOT = LOW-VALUES
 22384         MOVE PB-I-BIRTHDAY          TO DC-BIN-DATE-1
 22385         MOVE SPACE                  TO DC-OPTION-CODE
 22386         PERFORM 9700-DATE-LINK
 22387         IF NO-CONVERSION-ERROR
 22388            MOVE DC-GREG-DATE-1-EDIT TO BBIRTHO.
 22389
 22390     IF PB-I-1ST-PMT-DT NOT = LOW-VALUES
 22391         MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-1
 22392         MOVE SPACE                  TO DC-OPTION-CODE
 22393         PERFORM 9700-DATE-LINK
 22394         IF NO-CONVERSION-ERROR
 22395            MOVE DC-GREG-DATE-1-EDIT TO B1STPMTO.
 22396
 22397     IF PB-I-EXTENTION-DAYS NUMERIC
 22398        IF PB-I-EXTENTION-DAYS GREATER THAN ZEROS
 22399           MOVE PB-I-EXTENTION-DAYS  TO BDAYSO
 22400        ELSE
 22401           IF PB-I-TERM-IN-DAYS NUMERIC
 22402              IF PB-I-TERM-IN-DAYS GREATER THAN ZEROS
 22403                 MOVE PB-I-TERM-IN-DAYS TO BDAYSO.
 22404
 22405     IF PB-I-LOAN-TERM GREATER THAN ZEROS
 22406        MOVE PB-I-LOAN-TERM          TO BLNTRMO.
 22407
 22408     MOVE PB-FORCE-CODE              TO BFORCEO.
 22409     MOVE PB-I-TERM-TYPE             TO BMODEO
 22410                                        PI-BMODE.
 22411
 22412     IF PB-I-PAY-FREQUENCY GREATER THAN ZEROS
 22413        MOVE PB-I-PAY-FREQUENCY      TO BFREQO.
 22414
 22415     IF PB-I-NO-OF-PAYMENTS GREATER THAN ZEROS
 22416         MOVE PB-I-NO-OF-PAYMENTS    TO BPMTSO
 22417                                        PI-BPMTS.
 22418
 22419     IF PB-I-PAYMENT-AMOUNT NUMERIC
 22420         IF PB-I-PAYMENT-AMOUNT GREATER THAN ZEROS
 22421           MOVE PB-I-PAYMENT-AMOUNT  TO BPMTAMTO
 22422                                        PI-BPMTAMT.
 22423
 22424     MOVE PB-I-LOAN-OFFICER          TO BLNOFCRO.
 22425     MOVE PB-BATCH-ENTRY             TO BENTRYO.
 22426     MOVE PB-I-UNDERWRITING-STATUS   TO BUNWRITO.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 412
* EL6311.cbl
 22427     MOVE PB-I-SKIP-CODE             TO BSKPCDO.
 22428     MOVE PB-I-INDV-GRP-CD           TO BINDGRPO.
 22429     MOVE PB-I-SIG-SW                TO BSIGO.
 22430     MOVE PB-I-RATE-CLASS-OVRD       TO BRTCLSO.
 22431     MOVE PB-I-SPECIAL-REIN-CODE     TO BREINO.
 22432     MOVE PB-RECORD-BILL             TO BBILCDO.
 22433     MOVE PB-FORCE-CODE              TO BFORCEO.
 22434
 22435     IF (PB-I-LIVES NUMERIC)
 22436        AND (PB-I-LIVES > ZEROS)
 22437        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
 22438        IF (RESP-NORMAL)
 22439           AND (AM-DCC-PRODUCT-CODE = 'DDF')
 22440           CONTINUE
 22441        ELSE
 22442           MOVE PB-I-LIVES       TO BLIVESO
 22443        END-IF
 22444     END-IF
 22445
 22446     IF PB-I-NUM-BILLED NUMERIC AND
 22447        PB-I-NUM-BILLED GREATER THAN ZEROS
 22448        MOVE PB-I-NUM-BILLED         TO BBILLEDO.
 22449*    ELSE
 22450*       MOVE ZEROS                   TO BBILLEDO.
 22451
 22452     MOVE PB-CHG-COUNT               TO BCHGCNTO.
 22453
 22454     IF PB-I-LOAN-APR NOT = +99.9999
 22455        MOVE PB-I-LOAN-APR           TO BAPRO.
 22456
 22457     IF PB-I-MEMBER-NO  GREATER THAN SPACES
 22458        MOVE PB-I-MEMBER-NO          TO BMEMBERO.
 22459
 22460     IF PB-ORIGINAL-ENTRY-BATCH NOT = SPACES
 22461        IF PB-ORIGINAL-ENTRY-BATCH NOT = PB-ENTRY-BATCH
 22462           MOVE AL-SANOF                TO BORIGHDA
 22463           MOVE PB-ORIGINAL-ENTRY-BATCH TO BORGNOO
 22464           MOVE PB-ORIGINAL-SEQ-NO      TO BORGSEQO.
 22465
 22466     MOVE PI-LIFE-OVERRIDE-L2        TO BKIND (1).
 22467
 22468     IF PB-I-LF-CRIT-PER GREATER THAN ZEROS
 22469        MOVE PB-I-LF-CRIT-PER        TO BCRIT-PERDO (1).
 22470
 22471     IF PB-I-LF-INPUT-CD GREATER THAN SPACES
 22472        MOVE PB-I-LF-INPUT-CD        TO BTYPE (1)
 22473                                        PI-BTYPE (1).
 22474
 22475     IF PB-I-LF-TERM     GREATER THAN ZEROS
 22476        MOVE PB-I-LF-TERM            TO BTERMO (1).
 22477
 22478     IF PB-I-LF-BENEFIT-AMT GREATER THAN ZEROS
 22479        MOVE PB-I-LF-BENEFIT-AMT     TO BBENO  (1).
 22480
 22481     IF PB-I-LF-ALT-BENEFIT-AMT GREATER THAN ZEROS
 22482        MOVE PB-I-LF-ALT-BENEFIT-AMT TO BALT-BENO   (1).
 22483
 22484     IF PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 413
* EL6311.cbl
 22485        MOVE PB-I-LF-PREMIUM-AMT     TO BPREMO      (1).
 22486
 22487     IF PB-I-LF-ALT-PREMIUM-AMT GREATER THAN ZEROS
 22488        MOVE PB-I-LF-ALT-PREMIUM-AMT TO BALT-PREMO  (1).
 22489
 22490     IF PB-I-LF-EXPIRE-DT NOT = LOW-VALUES
 22491         MOVE PB-I-LF-EXPIRE-DT      TO DC-BIN-DATE-1
 22492         MOVE SPACE                  TO DC-OPTION-CODE
 22493         PERFORM 9700-DATE-LINK
 22494         IF NO-CONVERSION-ERROR
 22495            MOVE DC-GREG-DATE-1-EDIT TO BEXPIRE   (1).
 22496
 22497     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22498        MOVE PB-I-LF-BENEFIT-CD      TO BBEN-CD     (1)
 22499        MOVE PB-I-LF-ABBR            TO BBEN-ABBR   (1)
 22500        MOVE PB-I-LF-PREM-CALC       TO BCPREMO     (1)
 22501        SUBTRACT PB-I-LF-PREMIUM-AMT FROM PB-I-LF-PREM-CALC
 22502                 GIVING BDIFFO (1)
 22503     ELSE
 22504        MOVE SPACES                  TO BBEN-CD     (1)
 22505                                        BBEN-ABBR   (1).
 22506
 22507     IF PB-I-LF-ALT-PREMIUM-AMT GREATER THAN ZEROS
 22508        MOVE PB-I-LF-ALT-PREM-CALC   TO BCALT-PREM  (1)
 22509        SUBTRACT PB-I-LF-ALT-PREMIUM-AMT FROM
 22510                 PB-I-LF-ALT-PREM-CALC   GIVING BDALT-PREM (1).
 22511
 22512     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22513       IF PB-RECORD-ON-HOLD
 22514          MOVE 'ON HOLD'           TO BBILL-LIT     (1).
 22515
 22516     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22517       IF PB-RECORD-RETURNED
 22518          MOVE 'RETURNED'          TO BBILL-LIT     (1).
 22519
 22520     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22521        AND (PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH)
 22522             MOVE 'OVERRIDE'          TO BBILL-LIT  (1).
 22523
 22524     MOVE PI-AH-OVERRIDE-L2          TO BKIND       (2).
 22525
 22526     IF PB-I-AH-CRIT-PER GREATER THAN ZEROS
 22527        MOVE PB-I-AH-CRIT-PER        TO BCRIT-PERDO (2).
 22528
 22529     IF PB-I-AH-INPUT-CD GREATER THAN SPACES
 22530        MOVE PB-I-AH-INPUT-CD        TO BTYPE       (2)
 22531                                        PI-BTYPE (2).
 22532
 22533     IF PB-I-AH-TERM     GREATER THAN ZEROS
 22534        MOVE PB-I-AH-TERM            TO BTERMO      (2).
 22535
 22536     IF PB-I-AH-BENEFIT-AMT GREATER THAN ZEROS
 22537        MOVE PB-I-AH-BENEFIT-AMT     TO BBENO       (2).
 22538
 22539     IF PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 22540        MOVE PB-I-AH-PREMIUM-AMT     TO BPREMO      (2).
 22541
 22542     IF PB-I-TOT-FEES NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 414
* EL6311.cbl
 22543        MOVE ZEROS               TO PB-I-TOT-FEES
 22544     END-IF
 22545     IF PB-I-TOT-FEES > ZEROS
 22546        MOVE PB-I-TOT-FEES       TO BALT-PREMO  (2).
 22547
 22548     IF PB-I-AH-EXPIRE-DT NOT = LOW-VALUES
 22549         MOVE PB-I-AH-EXPIRE-DT      TO DC-BIN-DATE-1
 22550         MOVE SPACE                  TO DC-OPTION-CODE
 22551         PERFORM 9700-DATE-LINK
 22552         IF NO-CONVERSION-ERROR
 22553            MOVE DC-GREG-DATE-1-EDIT TO BEXPIRE       (2).
 22554
 22555     IF PB-I-TOT-FEES > ZEROS
 22556        MOVE PB-I-TOT-FEES-CALC      TO BCALT-PREM  (2)
 22557        SUBTRACT PB-I-TOT-FEES FROM
 22558                 PB-I-TOT-FEES-CALC GIVING BDALT-PREM (2).
 22559
 22560     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22561        MOVE PB-I-AH-BENEFIT-CD      TO BBEN-CD     (2)
 22562        MOVE PB-I-AH-ABBR            TO BBEN-ABBR   (2)
 22563        MOVE PB-I-AH-PREM-CALC       TO BCPREMO     (2)
 22564        SUBTRACT PB-I-AH-PREMIUM-AMT FROM PB-I-AH-PREM-CALC
 22565                 GIVING BDIFFO (2)
 22566     ELSE
 22567        MOVE SPACES                  TO BBEN-CD     (2)
 22568                                        BBEN-ABBR   (2).
 22569
 22570     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22571       IF PB-RECORD-ON-HOLD
 22572          MOVE 'ON HOLD'           TO BBILL-LIT     (2).
 22573
 22574     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22575       IF PB-RECORD-RETURNED
 22576          MOVE 'RETURNED'          TO BBILL-LIT     (2).
 22577
 22578     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22579        AND (PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH)
 22580             MOVE 'OVERRIDE'          TO BBILL-LIT  (2).
 22581
 22582     MOVE PB-CSR-ID                  TO BCSRO.
 22583
 22584     IF PI-COMPANY-ID  =  'DMD'
 22585        IF (EC-NEW-CERT = SPACES OR LOW-VALUES)
 22586            NEXT SENTENCE
 22587        ELSE
 22588            IF (PB-CERT-NO  NOT =  EC-NEW-CERT)
 22589               MOVE 'NEW CERT'       TO BNCERTLI
 22590               MOVE EC-NEW-CERT      TO BNCERTO.
 22591
 22592     IF PI-COMPANY-ID  =  'DMD'
 22593        IF (EC-NEW-STATE = LOW-VALUES OR SPACES)
 22594            NEXT SENTENCE
 22595        ELSE
 22596           IF (PB-SV-STATE  NOT =  EC-NEW-STATE)
 22597               MOVE 'NEW STATE'      TO BNSTATLI
 22598               MOVE EC-NEW-STATE     TO BNSTATO.
 22599
 22600 7000-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 415
* EL6311.cbl
 22601     MOVE 'C'                        TO BMAINTI.
 22602     MOVE AL-UANON                   TO BMAINTA.
 22603
 22604     IF PB-BATCH-CHG-SEQ-NO = ZEROS
 22605        PERFORM 7300-FORMAT-ERRORS THRU 7399-EXIT.
 22606
 22607     IF ARCHIVE-LETTER-RELEASED
 22608        PERFORM 7050-UPDATE-PENDING THRU 7050-EXIT
 22609     END-IF
 22610     IF PI-6315-FINALIZED = 'Y'   AND
 22611        PB-UNFORCED-ERRORS
 22612          MOVE -1                TO BFORCEL
 22613          MOVE  1                TO SET-CURSOR-SW
 22614     END-IF
 22615
 22616     IF NO-CURSOR-SET
 22617        MOVE -1                      TO BMAINTL.
 22618
 22619     GO TO 8100-SEND-INITIAL-MAP.
 22620
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 416
* EL6311.cbl
 22622
 22623 7050-UPDATE-PENDING.
 22624
 22625* EXEC CICS READ
 22626*        DATASET (FILE-ID-ERPNDB)
 22627*        INTO    (PENDING-BUSINESS)
 22628*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 22629*        UPDATE
 22630*    END-EXEC.
 22631     MOVE LENGTH OF
 22632      PENDING-BUSINESS
 22633       TO DFHEIV11
 22634*    MOVE '&"IL       EU         (   #00019012' TO DFHEIV0
 22635     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22636     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 22637     MOVE X'2020233030303139303132' TO DFHEIV0(25:11)
 22638     CALL 'kxdfhei1' USING DFHEIV0,
 22639           FILE-ID-ERPNDB,
 22640           PENDING-BUSINESS,
 22641           DFHEIV11,
 22642           PI-PREV-CONTROL-PRIMARY,
 22643           DFHEIV99,
 22644           DFHEIV99,
 22645           DFHEIV99
 22646     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22647
 22648
 22649     MOVE 'C' TO PB-I-LETTER-REQD
 22650     MOVE PB-I-LETTER-REQD       TO LETRREQO
 22651     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 22652     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 22653     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 22654     MOVE '5'                    TO DC-OPTION-CODE.
 22655     PERFORM 9700-DATE-LINK
 22656     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 22657
 22658
 22659* EXEC CICS REWRITE
 22660*        DATASET (FILE-ID-ERPNDB)
 22661*        FROM    (PENDING-BUSINESS)
 22662*    END-EXEC.
 22663     MOVE LENGTH OF
 22664      PENDING-BUSINESS
 22665       TO DFHEIV11
 22666*    MOVE '&& L                  %   #00019028' TO DFHEIV0
 22667     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 22668     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 22669     MOVE X'2020233030303139303238' TO DFHEIV0(25:11)
 22670     CALL 'kxdfhei1' USING DFHEIV0,
 22671           FILE-ID-ERPNDB,
 22672           PENDING-BUSINESS,
 22673           DFHEIV11,
 22674           DFHEIV99
 22675     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22676
 22677
 22678 7050-EXIT.
 22679      EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 417
* EL6311.cbl
 22680
 22681******************************************************************
 22682*                                                                *
 22683*             D I S P L A Y   C A N C E L S                      *
 22684*                                                                *
 22685******************************************************************
 22686
 22687 7100-DISPLAY-CANCELS.
 22688     IF PI-DISPLAY-ORIGINAL-BATCH
 22689        MOVE PB-CONTROL-BY-ORIG-BATCH TO PI-PREV-KEY
 22690        MOVE ZEROS                    TO PI-PREV-CHG-SEQ-NO
 22691     ELSE
 22692        MOVE PB-CONTROL-PRIMARY      TO PI-PREV-KEY.
 22693
 22694     MOVE PB-CONTROL-PRIMARY         TO PI-PREV-CONTROL-PRIMARY.
 22695
 22696     MOVE 'Y'                        TO WS-DISPLAY-SW.
 22697     MOVE 'Y'                        TO PI-DISPLAY-SCREEN-SW.
 22698
 22699     MOVE LOW-VALUES                 TO EL631CI.
 22700     MOVE EL631C                     TO PI-MAP-NAME.
 22701     MOVE 'Y'                        TO PI-BROWSE-SW.
 22702     MOVE PB-BATCH-SEQ-NO            TO CSEQO
 22703                                        PI-HIGH-SEQ-NO.
 22704
 22705     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 22706        MOVE AL-SABOF                TO CCHGTA
 22707        SUBTRACT PB-BATCH-CHG-SEQ-NO FROM 1000 GIVING CCHGO
 22708        MOVE AL-SANON                TO CCHGA
 22709      ELSE
 22710        MOVE AL-SADOF                TO CCHGTA
 22711                                        CCHGA
 22712        MOVE PB-CHG-COUNT            TO CCHGCNTO.
 22713
 22714*    MOVE PB-C-REFERENCE             TO CREFO.
 22715
 22716*    IF PB-C-MICROFILM-NO IS NUMERIC
 22717*       IF PB-C-MICROFILM-NO  NOT = ZEROS
 22718*          MOVE PB-C-MICROFILM-NO
 22719*                                TO CMICRNOO
 22720*          MOVE AL-UNNON         TO CMICRNOA
 22721*       END-IF
 22722*    END-IF
 22723     IF PB-C-INT-ON-REFS NUMERIC
 22724        IF PB-C-INT-ON-REFS NOT = ZEROS
 22725           MOVE PB-C-INT-ON-REFS
 22726                                 TO CNHINTO
 22727           MOVE AL-SANOF         TO CNHINTA
 22728        END-IF
 22729     END-IF
 22730     MOVE PB-CERT-PRIME              TO CCERTNOO.
 22731     MOVE PB-CERT-SFX                TO CSUFIXO.
 22732     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 22733     MOVE SPACE                      TO DC-OPTION-CODE.
 22734     PERFORM 9700-DATE-LINK.
 22735     MOVE DC-GREG-DATE-1-EDIT        TO CEFFDTO.
 22736
 22737     IF PB-C-LF-CANCEL-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 418
* EL6311.cbl
 22738        MOVE PB-C-LF-CANCEL-DT       TO DC-BIN-DATE-1
 22739        MOVE SPACE                   TO DC-OPTION-CODE
 22740        PERFORM 9700-DATE-LINK
 22741        IF NO-CONVERSION-ERROR
 22742           MOVE DC-GREG-DATE-1-EDIT  TO CCANDT1O.
 22743
 22744     IF PB-C-LF-REFUND-OVERRIDE EQUAL SPACES
 22745        NEXT SENTENCE
 22746     ELSE
 22747        MOVE PB-C-LF-REFUND-OVERRIDE TO CMTHD1I.
 22748
 22749     IF PB-C-AH-REFUND-OVERRIDE EQUAL SPACES
 22750        NEXT SENTENCE
 22751     ELSE
 22752        MOVE PB-C-AH-REFUND-OVERRIDE TO CMTHD2I.
 22753
 22754     IF PB-C-AH-CANCEL-DT   NOT = LOW-VALUES
 22755        MOVE PB-C-AH-CANCEL-DT       TO DC-BIN-DATE-1
 22756        MOVE SPACE                   TO DC-OPTION-CODE
 22757        PERFORM 9700-DATE-LINK
 22758        IF NO-CONVERSION-ERROR
 22759           MOVE DC-GREG-DATE-1-EDIT  TO CCANDT2O.
 22760
 22761     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 22762         MOVE PB-C-LF-CANCEL-AMT     TO CREFND1O.
 22763
 22764     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 22765         MOVE PB-C-AH-CANCEL-AMT     TO CREFND2O.
 22766
 22767     IF PB-C-LF-CANCEL-DT NOT = LOW-VALUES
 22768        MOVE PB-C-LF-REF-CALC        TO CCRFND1O
 22769        SUBTRACT PB-C-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC
 22770                 GIVING CDRFND1O.
 22771
 22772     IF PB-C-AH-CANCEL-DT NOT = LOW-VALUES
 22773        MOVE PB-C-AH-REF-CALC        TO CCRFND2O
 22774        SUBTRACT PB-C-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC
 22775                 GIVING CDRFND2O.
 22776
 22777     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 22778       IF PB-RECORD-ON-HOLD
 22779          MOVE 'ON HOLD'             TO CBILIT1O.
 22780
 22781     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 22782       IF PB-RECORD-RETURNED
 22783          MOVE 'RETURNED'            TO CBILIT1O.
 22784
 22785     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 22786        AND (PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH)
 22787             MOVE 'OVERRIDE'         TO CBILIT1O.
 22788
 22789     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 22790       IF PB-RECORD-ON-HOLD
 22791          MOVE 'ON HOLD'             TO CBILIT2O.
 22792
 22793     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 22794       IF PB-RECORD-RETURNED
 22795          MOVE 'RETURNED'            TO CBILIT2O.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 419
* EL6311.cbl
 22796
 22797     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 22798        AND (PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH)
 22799             MOVE 'OVERRIDE'         TO CBILIT2O.
 22800
 22801     MOVE PB-C-LAST-NAME             TO CLSTNMO.
 22802     MOVE PB-C-CANCEL-REASON         TO CCANREAO
 22803     MOVE PB-FORCE-CODE              TO CFORCEO.
 22804     MOVE PB-RECORD-BILL             TO CBILCDO.
 22805     MOVE PB-CI-LAST-NAME            TO CINAMEO.
 22806     MOVE SPACES                     TO CINITSO.
 22807     IF PB-CI-FIRST-NAME GREATER THAN SPACES
 22808         MOVE PB-CI-FIRST-NAME       TO CINITSO
 22809     ELSE
 22810         MOVE PB-CI-INITIALS         TO CINITSO
 22811     END-IF.
 22812
 22813     IF PB-CI-CANCEL-FEE NUMERIC
 22814        MOVE PB-CI-CANCEL-FEE        TO W-CANCEL-FEE-LONG
 22815        MOVE W-CANCEL-FEE-LONG       TO W-CANCEL-FEE
 22816     ELSE
 22817        MOVE ZEROES                  TO W-CANCEL-FEE.
 22818
 22819     MOVE W-CANCEL-FEE               TO CCANFEEO.
 22820
 22821     IF PB-CI-LF-PREMIUM-AMT NOT = ZEROS
 22822        ADD PB-CI-LF-PREMIUM-AMT
 22823             PB-CI-LF-ALT-PREMIUM-AMT  GIVING  CPREM1O.
 22824
 22825     IF PB-CI-AH-PREMIUM-AMT NOT = ZEROS
 22826        MOVE PB-CI-AH-PREMIUM-AMT       TO CPREM2O.
 22827
 22828     MOVE PB-CI-LF-TERM              TO CTERM1O.
 22829     MOVE PB-C-LF-REM-TERM           TO CRTERM1O.
 22830     MOVE PB-CI-AH-TERM              TO CTERM2O.
 22831     MOVE PB-C-AH-REM-TERM           TO CRTERM2O.
 22832
 22833     IF PB-C-LIVES NUMERIC
 22834        MOVE PB-C-LIVES              TO CLIVESO.
 22835
 22836     IF PB-C-PAYEE-CODE GREATER THAN SPACES
 22837        MOVE PB-C-PAYEE-CODE         TO CPAYEEO.
 22838
 22839     IF PB-CI-ENTRY-DT NOT = LOW-VALUES
 22840        MOVE PB-CI-ENTRY-DT          TO DC-BIN-DATE-1
 22841        MOVE SPACE                   TO DC-OPTION-CODE
 22842        PERFORM 9700-DATE-LINK
 22843        IF NO-CONVERSION-ERROR
 22844           MOVE DC-GREG-DATE-1-EDIT  TO CENTRDTO.
 22845
 22846     IF  PB-C-REFUND-CREATED
 22847         MOVE 'YES'                  TO CRFNDSWO
 22848     ELSE
 22849         IF PB-C-REFUND-REQUESTED
 22850            MOVE 'REQ'               TO CRFNDSWO
 22851         ELSE
 22852            MOVE 'NO'                TO CRFNDSWO.
 22853
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 420
* EL6311.cbl
 22854     MOVE PB-INPUT-DT                TO DC-BIN-DATE-1.
 22855     MOVE SPACE                      TO DC-OPTION-CODE.
 22856     PERFORM 9700-DATE-LINK.
 22857     MOVE DC-GREG-DATE-1-EDIT        TO CENTDTO.
 22858     MOVE PB-INPUT-BY                TO CENTBYO.
 22859
 22860     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 22861        MOVE PB-CREDIT-ACCEPT-DT     TO DC-BIN-DATE-1
 22862        MOVE SPACE                   TO DC-OPTION-CODE
 22863        PERFORM 9700-DATE-LINK
 22864        MOVE DC-GREG-DATE-1-EDIT     TO CMANTDTO
 22865        MOVE 'INACTIVE'              TO CMOENDTO
 22866     ELSE
 22867        MOVE PB-LAST-MAINT-DT        TO DC-BIN-DATE-1
 22868        MOVE SPACE                   TO DC-OPTION-CODE
 22869        PERFORM 9700-DATE-LINK
 22870        MOVE DC-GREG-DATE-1-EDIT     TO CMANTDTO
 22871        MOVE PB-CREDIT-SELECT-DT     TO DC-BIN-DATE-1
 22872        MOVE SPACE                   TO DC-OPTION-CODE
 22873        PERFORM 9700-DATE-LINK
 22874        MOVE DC-GREG-DATE-1-EDIT     TO CMOENDTO.
 22875
 22876     MOVE PB-LAST-MAINT-BY           TO CMANTBYO.
 22877
 22878     MOVE PB-LAST-MAINT-HHMMSS       TO WS-TIME.
 22879     MOVE WS-HR-MINS                 TO CMANTATO.
 22880
 22881     EVALUATE PB-LF-REFUND-TYPE
 22882        WHEN '1'
 22883           MOVE 'RULE78'            TO CLFREFNO
 22884        WHEN '2'
 22885           MOVE 'PRORAT'            TO CLFREFNO
 22886        WHEN '3'
 22887           MOVE 'CALIF'             TO CLFREFNO
 22888        WHEN '4'
 22889           MOVE 'IRREG'             TO CLFREFNO
 22890        WHEN '5'
 22891           MOVE 'NETPAY'            TO CLFREFNO
 22892        WHEN '6'
 22893           MOVE 'ATCP'              TO CLFREFNO
 22894        WHEN '7'
 22895           MOVE 'UTAH'              TO CLFREFNO
 22896        WHEN '8'
 22897           MOVE 'MEAN'              TO CLFREFNO
 22898        WHEN '9'
 22899           MOVE 'SUM '              TO CLFREFNO
 22900        WHEN 'B'
 22901           MOVE 'BALN'              TO CLFREFNO
 22902     END-EVALUATE.
 22903
 22904     EVALUATE TRUE
 22905        WHEN PB-AH-REFUND-TYPE =  '1'
 22906           MOVE 'RULE78'            TO CAHREFNO
 22907        WHEN PB-AH-REFUND-TYPE =  '2'
 22908           MOVE 'PRORAT'            TO CAHREFNO
 22909        WHEN PB-AH-REFUND-TYPE =  ('3' OR 'S')
 22910           MOVE 'CALIF'             TO CAHREFNO
 22911        WHEN PB-AH-REFUND-TYPE =  '4'
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 421
* EL6311.cbl
 22912           MOVE 'IRREG'             TO CAHREFNO
 22913        WHEN PB-AH-REFUND-TYPE =  '5'
 22914           MOVE 'NETPAY'            TO CAHREFNO
 22915        WHEN PB-AH-REFUND-TYPE =  '6'
 22916           MOVE 'ATCP'              TO CAHREFNO
 22917        WHEN PB-AH-REFUND-TYPE =  '7'
 22918           MOVE 'UTAH'              TO CAHREFNO
 22919        WHEN PB-AH-REFUND-TYPE =  '8'
 22920           MOVE 'MEAN'              TO CAHREFNO
 22921        WHEN PB-AH-REFUND-TYPE =  '9'
 22922           MOVE 'SUM '              TO CAHREFNO
 22923        WHEN PB-AH-REFUND-TYPE =  'B'
 22924           MOVE 'BALN'              TO CAHREFNO
 22925     END-EVALUATE.
 22926
 22927     MOVE PB-REIN-CD                 TO CREINCDO.
 22928
 22929     IF PB-ACCT-EFF-DT NOT = LOW-VALUES AND SPACES
 22930        MOVE PB-ACCT-EFF-DT          TO DC-BIN-DATE-1
 22931        MOVE SPACE                   TO DC-OPTION-CODE
 22932        PERFORM 9700-DATE-LINK
 22933        IF NO-CONVERSION-ERROR
 22934           MOVE DC-GREG-DATE-1-EDIT  TO CAEFFDTO.
 22935
 22936     IF PB-ACCT-EXP-DT  = HIGH-VALUES
 22937        MOVE 999999                  TO WS-EXP-DT-EDIT
 22938        INSPECT WS-EXP-DT-EDIT CONVERTING SPACES TO '/'
 22939        MOVE WS-EXP-DT-EDIT          TO CAEXPDTO
 22940     ELSE
 22941        IF PB-ACCT-EXP-DT NOT = LOW-VALUES
 22942           MOVE PB-ACCT-EXP-DT          TO DC-BIN-DATE-1
 22943           MOVE SPACE                   TO DC-OPTION-CODE
 22944           PERFORM 9700-DATE-LINK
 22945           IF NO-CONVERSION-ERROR
 22946              MOVE DC-GREG-DATE-1-EDIT  TO CAEXPDTO.
 22947
 22948     IF PB-ORIGINAL-ENTRY-BATCH NOT = SPACES
 22949        IF PB-ORIGINAL-ENTRY-BATCH NOT = PB-ENTRY-BATCH
 22950           MOVE AL-SANOF                TO CORIGHDA
 22951           MOVE PB-ORIGINAL-ENTRY-BATCH TO CORGNOO
 22952           MOVE PB-ORIGINAL-SEQ-NO      TO CORGSEQO.
 22953
 22954     MOVE PB-CSR-ID              TO CCSRO.
 22955
 22956     MOVE PB-CI-LIFE-COMMISSION  TO COMMLFO.
 22957     MOVE PB-CI-AH-COMMISSION    TO COMMAHO.
 22958     MOVE 'N'                    TO ACTSPCO
 22959     MOVE PB-CONTROL-BY-ACCOUNT  TO ERACNT-KEY
 22960     MOVE '2'                    TO ERACNT-REC-TYPE
 22961     MOVE +3                     TO ERACNT-SEQ-NO
 22962
 22963
 22964* EXEC CICS READ
 22965*         DATASET   ('ERACNT')
 22966*         INTO      (NOTE-FILE)
 22967*         RIDFLD    (ERACNT-KEY)
 22968*         RESP      (WS-RESPONSE)
 22969*    END-EXEC
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 422
* EL6311.cbl
 22970     MOVE LENGTH OF
 22971      NOTE-FILE
 22972       TO DFHEIV11
 22973     MOVE 'ERACNT' TO DFHEIV1
 22974*    MOVE '&"IL       E          (  N#00019318' TO DFHEIV0
 22975     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22976     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22977     MOVE X'204E233030303139333138' TO DFHEIV0(25:11)
 22978     CALL 'kxdfhei1' USING DFHEIV0,
 22979           DFHEIV1,
 22980           NOTE-FILE,
 22981           DFHEIV11,
 22982           ERACNT-KEY,
 22983           DFHEIV99,
 22984           DFHEIV99,
 22985           DFHEIV99
 22986     MOVE EIBRESP  TO WS-RESPONSE
 22987     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22988
 22989     IF RESP-NORMAL
 22990        IF NT-account-special = 'Y'
 22991           MOVE 'Y'              TO actspcO
 22992           MOVE ER-1762          TO EMI-ERROR
 22993           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22994        END-IF
 22995     END-IF
 22996     MOVE 'C'                    TO CMAINTI.
 22997     MOVE AL-UANON               TO CMAINTA.
 22998
 22999     IF PI-6316-FINALIZED = 'Y'  AND
 23000        PB-UNFORCED-ERRORS
 23001          MOVE -1                TO CFORCEL
 23002          MOVE  1                TO SET-CURSOR-SW
 23003     END-IF
 23004
 23005     IF PB-BATCH-CHG-SEQ-NO = ZEROS
 23006        PERFORM 7300-FORMAT-ERRORS THRU 7399-EXIT.
 23007
 23008     IF NO-CURSOR-SET
 23009        MOVE -1                  TO CMAINTL.
 23010
 23011     GO TO 8100-SEND-INITIAL-MAP.
 23012
 23013
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 423
* EL6311.cbl
 23015***************************************************************
 23016*     ROUTINE THAT MOVES ALL DATA FROM THE BATCH TOTAL        *
 23017*     RECORD TO THE BATCH TOTAL SCREEN.                       *
 23018***************************************************************
 23019
 23020 7200-DISPLAY-BATCHES.
 23021     MOVE EL631D                 TO PI-MAP-NAME.
 23022     MOVE LOW-VALUES             TO EL631DI.
 23023
 23024     MOVE 'Y'                    TO WS-DISPLAY-SW.
 23025
 23026
 23027* EXEC CICS HANDLE CONDITION
 23028*         NOTFND   (3690-NOT-FOUND)
 23029*    END-EXEC.
 23030*    MOVE '"$I                   ! T #00019362' TO DFHEIV0
 23031     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 23032     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 23033     MOVE X'5420233030303139333632' TO DFHEIV0(25:11)
 23034     CALL 'kxdfhei1' USING DFHEIV0
 23035     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23036
 23037
 23038     IF PI-DISPLAY-SCREEN
 23039        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 23040     ELSE
 23041        MOVE PB-CONTROL-PRIMARY  TO ERPNDB-KEY.
 23042
 23043     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 23044     MOVE +0                     TO ERPNDB-BATCH-CHG-SEQ-NO.
 23045
 23046
 23047* EXEC CICS READ
 23048*         DATASET   (FILE-ID-ERPNDB)
 23049*         RIDFLD    (ERPNDB-KEY)
 23050*         SET       (ADDRESS OF PENDING-BUSINESS)
 23051*    END-EXEC.
 23052*    MOVE '&"S        E          (   #00019374' TO DFHEIV0
 23053     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 23054     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 23055     MOVE X'2020233030303139333734' TO DFHEIV0(25:11)
 23056     CALL 'kxdfhei1' USING DFHEIV0,
 23057           FILE-ID-ERPNDB,
 23058           DFHEIV20,
 23059           DFHEIV99,
 23060           ERPNDB-KEY,
 23061           DFHEIV99,
 23062           DFHEIV99,
 23063           DFHEIV99
 23064     SET ADDRESS OF PENDING-BUSINESS TO
 23065         DFHEIV20
 23066     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23067
 23068
 23069     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 23070     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 23071     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 23072     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 424
* EL6311.cbl
 23073     MOVE PB-SV-STATE            TO PI-SV-STATE.
 23074
 23075     MOVE EL631D                 TO PI-MAP-NAME.
 23076     MOVE LOW-VALUES             TO EL631DI.
 23077     MOVE PB-ENTRY-BATCH         TO DBATCHO.
 23078
 23079*    IF PI-AR-PROCESSING
 23080*       MOVE PB-REFERENCE        TO DREFO.
 23081
 23082     MOVE PB-CSR-ID              TO DCSRO.
 23083
 23084     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 23085        MOVE PB-CREDIT-ACCEPT-DT TO DC-BIN-DATE-1
 23086        MOVE SPACE               TO DC-OPTION-CODE
 23087        PERFORM 9700-DATE-LINK
 23088        MOVE DC-GREG-DATE-1-EDIT TO DMAINDTO
 23089        MOVE AL-SABOF            TO DLDATEA  DMAINDTA
 23090        MOVE 'INACTIVE'          TO DLDATEO
 23091     ELSE
 23092        MOVE PB-LAST-MAINT-DT    TO DC-BIN-DATE-1
 23093        MOVE SPACE               TO DC-OPTION-CODE
 23094        PERFORM 9700-DATE-LINK
 23095        MOVE DC-GREG-DATE-1-EDIT TO DMAINDTO.
 23096
 23097     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.
 23098     MOVE SPACE                  TO DC-OPTION-CODE.
 23099     PERFORM 9700-DATE-LINK.
 23100     MOVE DC-GREG-DATE-1-EDIT    TO DINPUTO.
 23101
 23102     IF PB-B-RECEIVED-DT = SPACES OR LOW-VALUES
 23103        MOVE DC-GREG-DATE-1-EDIT TO DRECVDTO
 23104     ELSE
 23105        MOVE PB-B-RECEIVED-DT    TO DC-BIN-DATE-1
 23106        MOVE SPACE               TO DC-OPTION-CODE
 23107        PERFORM 9700-DATE-LINK
 23108        MOVE DC-GREG-DATE-1-EDIT TO DRECVDTO.
 23109
 23110     MOVE PB-CREDIT-SELECT-DT    TO DC-BIN-DATE-1.
 23111     MOVE SPACE                  TO DC-OPTION-CODE.
 23112     PERFORM 9700-DATE-LINK.
 23113     MOVE DC-GREG-DATE-1-EDIT        TO DPROCDTO.
 23114
 23115     MOVE PB-B-ISSUE-CNT-REMITTED    TO DRISSO.
 23116     MOVE PB-B-ISSUE-CNT-ENTERED     TO DEISSO.
 23117
 23118     IF PB-B-ISSUE-CNT-REMITTED NOT = PB-B-ISSUE-CNT-ENTERED
 23119        SUBTRACT PB-B-ISSUE-CNT-ENTERED FROM
 23120                 PB-B-ISSUE-CNT-REMITTED GIVING DOISSO.
 23121
 23122     MOVE PB-B-LF-ISS-PRM-REMITTED   TO DRLFPRMO.
 23123     MOVE PB-B-LF-ISS-PRM-ENTERED    TO DELFPRMO.
 23124     MOVE PB-B-LF-ISS-PRM-COMPUTED   TO DCLFPRMO.
 23125
 23126     IF PB-B-LF-ISS-PRM-ENTERED NOT = PB-B-LF-ISS-PRM-REMITTED
 23127        SUBTRACT PB-B-LF-ISS-PRM-ENTERED FROM
 23128                 PB-B-LF-ISS-PRM-REMITTED  GIVING DOLFPRMO.
 23129
 23130     MOVE PB-B-AH-ISS-PRM-REMITTED   TO DRAHPRMO.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 425
* EL6311.cbl
 23131     MOVE PB-B-AH-ISS-PRM-ENTERED    TO DEAHPRMO.
 23132     MOVE PB-B-AH-ISS-PRM-COMPUTED   TO DCAHPRMO.
 23133
 23134     IF PB-B-AH-ISS-PRM-ENTERED NOT = PB-B-AH-ISS-PRM-REMITTED
 23135        SUBTRACT PB-B-AH-ISS-PRM-ENTERED FROM
 23136                 PB-B-AH-ISS-PRM-REMITTED  GIVING DOAHPRMO.
 23137
 23138     MOVE PB-B-CANCEL-CNT-REMITTED     TO DRCANCO.
 23139     MOVE PB-B-CANCEL-CNT-ENTERED      TO DECANCO.
 23140
 23141     IF PB-B-CANCEL-CNT-REMITTED NOT = PB-B-CANCEL-CNT-ENTERED
 23142        SUBTRACT PB-B-CANCEL-CNT-ENTERED FROM
 23143                 PB-B-CANCEL-CNT-REMITTED GIVING DOCANCO.
 23144
 23145     MOVE PB-B-LF-CAN-PRM-REMITTED   TO DRLFRFDO.
 23146     MOVE PB-B-LF-CAN-PRM-ENTERED    TO DELFRFDO.
 23147     MOVE PB-B-LF-CAN-PRM-COMPUTED   TO DCLFRFDO.
 23148
 23149     IF PB-B-LF-CAN-PRM-ENTERED NOT = PB-B-LF-CAN-PRM-REMITTED
 23150        SUBTRACT PB-B-LF-CAN-PRM-ENTERED FROM
 23151                 PB-B-LF-CAN-PRM-REMITTED  GIVING DOLFRFDO.
 23152
 23153     MOVE PB-B-AH-CAN-PRM-REMITTED   TO DRAHRFDO.
 23154     MOVE PB-B-AH-CAN-PRM-ENTERED    TO DEAHRFDO.
 23155     MOVE PB-B-AH-CAN-PRM-COMPUTED   TO DCAHRFDO.
 23156
 23157     IF PB-B-AH-CAN-PRM-ENTERED NOT = PB-B-AH-CAN-PRM-REMITTED
 23158        SUBTRACT PB-B-AH-CAN-PRM-ENTERED FROM
 23159                 PB-B-AH-CAN-PRM-REMITTED  GIVING DOAHRFDO.
 23160
 23161     MOVE -1                     TO DPFENTRL.
 23162     GO TO 8100-SEND-INITIAL-MAP.
 23163
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 426
* EL6311.cbl
 23165
 23166***************************************************************
 23167*     THIS ROUTINE DETERMINES IF EL050 ENCOUNTERED ANY        *
 23168*     ERRORS.  IF ERRORS WERE DETECTED, THE ONLINE ERROR      *
 23169*     PROCESSING ROUTINE IS CALLED TO FORMAT THE ERROR        *
 23170*     MESSAGES AND ACCUMULATE TOTALS FOR THE DIFFERENT        *
 23171*     SEVERITY LEVELS. THE SEVERITY FLAGS WITHIN THE RECORDS  *
 23172*     ARE THEN SET ACCORDINGLY.                               *
 23173*         ERROR NUMBERS FOR THE STANDARD ERRORS START AT 2600 *
 23174*         ERROR NUMBERS FOR ISSUE TRANSACTIONS  START AT 2625 *
 23175*         ERROR NUMBERS FOR CANCEL TRANSACTIONS START AT 2725 *
 23176***************************************************************
 23177
 23178******************************************************************
 23179*                                                                *
 23180*            E R R O R   A N A L Y S I S                         *
 23181*                                                                *
 23182******************************************************************
 23183
 23184******************************************************************
 23185*                                                                *
 23186*   THIS ROUTINE DETERMINES IF EL050 (EDIT PROGRAM) ENCOUNTERED  *
 23187*   ANY ERRORS.  IF ERRORS WERE DETECTED, THE ROUTINE READS THE  *
 23188*   ERROR FILE TO DETERMINE THE SEVERITY OF THE ERRORS.  ONCE    *
 23189*   THE SEVERITY OF ERRORS IS ESTABLISHED THE APPROPRIATE ERROR  *
 23190*   FLAGS ARE SET (FORCIBLE, UNFORCIBLE, WARNING, ETC.).         *
 23191*                                                                *
 23192*   IF ANY UNFORCED OR FATAL ERRORS, OR RECORD IS RETURNED       *
 23193*   OR PLACED ON HOLD UPDATE THE CERTIFICATE ACCORDINGLY.        *
 23194*                                                                *
 23195******************************************************************
 23196
 23197 7300-FORMAT-ERRORS.
 23198     MOVE ' '                    TO PI-ERRORS-SW
 23199     IF PB-COMMON-ERRORS = LOW-VALUES
 23200        IF PB-FATAL-ERRORS
 23201           MOVE ER-2695          TO EMI-ERROR
 23202           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 23203           GO TO 7399-EXIT.
 23204
 23205     MOVE +0                     TO WS-SUB4
 23206     move +0                     to pi-6311-fatal-ctr
 23207     .
 23208 7310-ERROR-LOOP.
 23209
 23210     ADD +1                      TO WS-SUB4.
 23211
 23212     IF WS-SUB4 GREATER THAN PB-NO-OF-ERRORS
 23213        GO TO 7350-SET-ERROR-FLAGS.
 23214
 23215     IF PI-COMPANY-ID = 'UCL'
 23216         IF PB-COMMON-ERROR (WS-SUB4) = ER-2799
 23217             MOVE WS-CERT-EFF-DT        TO DC-BIN-DATE-1
 23218             MOVE ' '                   TO DC-OPTION-CODE
 23219             PERFORM 9700-DATE-LINK
 23220             MOVE DC-GREG-DATE-1-MDY    TO EMI-AH-OVERRIDE-L6.
 23221
 23222     MOVE PB-COMMON-ERROR (WS-SUB4) TO EMI-ERROR.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 427
* EL6311.cbl
 23223     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 23224     if (emi-fatal)
 23225        and (emi-error not = 1753 and 1754 and 1757 and
 23226                             1758 and 1759 and 1760)
 23227        add +1                   to pi-6311-fatal-ctr
 23228     end-if
 23229     PERFORM 7400-SET-ATTRIBUTES THRU 7499-EXIT.
 23230
 23231     GO TO 7310-ERROR-LOOP.
 23232
 23233
 23234 7350-SET-ERROR-FLAGS.
 23235
 23236     IF EMI-FATAL-CTR NOT = ZEROS
 23237        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 23238        MOVE 'X'                 TO PB-FATAL-FLAG
 23239                                    PI-ERRORS-SW
 23240        GO TO 7355-SET-ERROR-FLAGS.
 23241
 23242     move ' ' to pi-unforced-sw
 23243     IF EMI-FORCABLE-CTR NOT = ZEROS
 23244        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 23245        IF PB-ISSUE
 23246           IF PB-ISSUE-FORCE
 23247              MOVE 'F'           TO PB-FORCE-ER-CD
 23248              MOVE ER-2600       TO EMI-ERROR
 23249              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 23250             ELSE
 23251              MOVE 'X'           TO PB-FORCE-ER-CD
 23252*                                   PI-ERRORS-SW
 23253          ELSE
 23254           IF PB-CANCEL-FORCE OR PB-ALL-CANCEL-FORCED-NO-FEE
 23255              MOVE 'F'           TO PB-FORCE-ER-CD
 23256                                    pi-unforced-sw
 23257              MOVE ER-2600       TO EMI-ERROR
 23258              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 23259             ELSE
 23260              MOVE 'X'           TO PB-FORCE-ER-CD
 23261                                    pi-unforced-sw.
 23262*                                   PI-ERRORS-SW.
 23263
 23264     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ERENDT-KEY (1:33)
 23265     IF PB-ISSUE
 23266         MOVE 'I'                TO ENDT-RECORD-TYPE
 23267     ELSE
 23268         MOVE 'C'                TO ENDT-RECORD-TYPE
 23269     END-IF
 23270     MOVE +0                     TO ENDT-SEQ-NO
 23271
 23272
 23273* EXEC CICS READ
 23274*        DATASET   (FILE-ID-ERENDT)
 23275*        SET       (ADDRESS OF ENDORSEMENT-RECORD)
 23276*        RIDFLD    (ERENDT-KEY)
 23277*        RESP      (WS-RESPONSE)
 23278*        GTEQ
 23279*    END-EXEC
 23280*    MOVE '&"S        G          (  N#00019583' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 428
* EL6311.cbl
 23281     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 23282     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 23283     MOVE X'204E233030303139353833' TO DFHEIV0(25:11)
 23284     CALL 'kxdfhei1' USING DFHEIV0,
 23285           FILE-ID-ERENDT,
 23286           DFHEIV20,
 23287           DFHEIV99,
 23288           ERENDT-KEY,
 23289           DFHEIV99,
 23290           DFHEIV99,
 23291           DFHEIV99
 23292     SET ADDRESS OF ENDORSEMENT-RECORD TO
 23293         DFHEIV20
 23294     MOVE EIBRESP  TO WS-RESPONSE
 23295     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 23296
 23297     IF RESP-NORMAL
 23298        AND (EN-CONTROL-PRIMARY (1:34) = ERENDT-KEY (1:34))
 23299        IF EN-BATCH-NUMBER = PB-ENTRY-BATCH
 23300            MOVE ER-0280          TO EMI-ERROR
 23301            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 23302            MOVE EN-ARCHIVE-NO    TO ARCH-SUPPRESS
 23303            IF CALLED-FROM-6315
 23304               MOVE 'Y' TO WS-ARCHIVE-LETTER-SW
 23305            END-IF
 23306            EVALUATE TRUE
 23307              WHEN EMI-ERROR-NUMBER (1) EQUAL ER-0280
 23308                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (1)
 23309              WHEN EMI-ERROR-NUMBER (2) EQUAL ER-0280
 23310                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (2)
 23311              WHEN EMI-ERROR-NUMBER (3) EQUAL ER-0280
 23312                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (3)
 23313            END-EVALUATE
 23314        END-IF
 23315     END-IF
 23316
 23317
 23318
 23319     IF FIRST-ENTRY OR
 23320        EIBAID = DFHPF1 OR DFHPF2
 23321        MOVE '0'                TO PI-EDIT-SW
 23322        GO TO 7399-EXIT.
 23323
 23324 7355-SET-ERROR-FLAGS.
 23325
 23326     IF EMI-WARNING-CTR NOT = ZEROS
 23327        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 23328        MOVE 'W'                 TO PB-WARN-ER-CD.
 23329
 23330     IF PB-UNFORCED-ERRORS OR
 23331        PB-FATAL-ERRORS    OR
 23332        PB-RECORD-ON-HOLD  OR
 23333        PB-RECORD-RETURNED OR
 23334        PB-CANCELLATION
 23335          NEXT SENTENCE
 23336        ELSE
 23337          GO TO 7399-EXIT.
 23338
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 429
* EL6311.cbl
 23339
 23340* EXEC CICS  HANDLE CONDITION
 23341*           NOTFND   (7399-EXIT)
 23342*    END-EXEC.
 23343*    MOVE '"$I                   ! U #00019633' TO DFHEIV0
 23344     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 23345     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 23346     MOVE X'5520233030303139363333' TO DFHEIV0(25:11)
 23347     CALL 'kxdfhei1' USING DFHEIV0
 23348     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23349
 23350
 23351     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 23352     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 23353     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 23354     MOVE PB-SV-STATE            TO ELCERT-STATE.
 23355
 23356
 23357* EXEC CICS READ
 23358*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 23359*        DATASET (FILE-ID-ELCERT)
 23360*        RIDFLD  (ELCERT-KEY)
 23361*        UPDATE
 23362*    END-EXEC.
 23363*    MOVE '&"S        EU         (   #00019642' TO DFHEIV0
 23364     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 23365     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 23366     MOVE X'2020233030303139363432' TO DFHEIV0(25:11)
 23367     CALL 'kxdfhei1' USING DFHEIV0,
 23368           FILE-ID-ELCERT,
 23369           DFHEIV20,
 23370           DFHEIV99,
 23371           ELCERT-KEY,
 23372           DFHEIV99,
 23373           DFHEIV99,
 23374           DFHEIV99
 23375     SET ADDRESS OF CERTIFICATE-MASTER TO
 23376         DFHEIV20
 23377     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23378
 23379
 23380
 23381     MOVE CM-CREDIT-INTERFACE-SW-1         TO WS-SW-1
 23382     MOVE CM-CREDIT-INTERFACE-SW-2         TO WS-SW-2
 23383
 23384     IF (CERT-ADDED-BATCH OR CERT-PURGED-OFFLINE) AND PB-ISSUE
 23385        GO TO 7360-REWRITE-CERT-MASTER.
 23386
 23387     IF PB-ISSUE
 23388        IF PB-RECORD-RETURNED
 23389            MOVE '4'  TO CM-CREDIT-INTERFACE-SW-1
 23390            GO TO 7360-REWRITE-CERT-MASTER
 23391        ELSE
 23392            MOVE '2' TO CM-CREDIT-INTERFACE-SW-1
 23393            GO TO 7360-REWRITE-CERT-MASTER.
 23394
 23395     IF PB-RECORD-RETURNED
 23396         MOVE '7'      TO CM-CREDIT-INTERFACE-SW-2
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 430
* EL6311.cbl
 23397         GO TO 7360-REWRITE-CERT-MASTER.
 23398
 23399     IF (PB-C-LF-CANCEL-VOIDED)
 23400        or (pb-c-ah-cancel-voided)
 23401        IF (PB-UNFORCED-ERRORS OR
 23402            PB-FATAL-ERRORS    OR
 23403            PB-RECORD-ON-HOLD)
 23404            MOVE '6'             TO CM-CREDIT-INTERFACE-SW-2
 23405            GO TO 7360-REWRITE-CERT-MASTER
 23406        ELSE
 23407            MOVE '5'             TO CM-CREDIT-INTERFACE-SW-2
 23408            GO TO 7360-REWRITE-CERT-MASTER.
 23409
 23410     IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS
 23411                            OR PB-RECORD-ON-HOLD)
 23412        MOVE '4'                 TO CM-CREDIT-INTERFACE-SW-2
 23413     ELSE
 23414        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.
 23415
 23416 7360-REWRITE-CERT-MASTER.
 23417
 23418     IF WS-SW-1 = CM-CREDIT-INTERFACE-SW-1 AND
 23419        WS-SW-2 = CM-CREDIT-INTERFACE-SW-2
 23420
 23421* EXEC CICS UNLOCK
 23422*            DATASET    (FILE-ID-ELCERT)
 23423*       END-EXEC
 23424*    MOVE '&*                    #   #00019689' TO DFHEIV0
 23425     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 23426     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 23427     MOVE X'2020233030303139363839' TO DFHEIV0(25:11)
 23428     CALL 'kxdfhei1' USING DFHEIV0,
 23429           FILE-ID-ELCERT,
 23430           DFHEIV99
 23431     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 23432        GO TO 7399-EXIT.
 23433
 23434
 23435* EXEC CICS REWRITE
 23436*         DATASET    (FILE-ID-ELCERT)
 23437*         FROM       (CERTIFICATE-MASTER)
 23438*    END-EXEC.
 23439     MOVE LENGTH OF
 23440      CERTIFICATE-MASTER
 23441       TO DFHEIV11
 23442*    MOVE '&& L                  %   #00019694' TO DFHEIV0
 23443     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 23444     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 23445     MOVE X'2020233030303139363934' TO DFHEIV0(25:11)
 23446     CALL 'kxdfhei1' USING DFHEIV0,
 23447           FILE-ID-ELCERT,
 23448           CERTIFICATE-MASTER,
 23449           DFHEIV11,
 23450           DFHEIV99
 23451     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23452
 23453
 23454 7399-EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 431
* EL6311.cbl
 23455      EXIT.
 23456
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 432
* EL6311.cbl
 23458
 23459*************************************************************
 23460*                                                           *
 23461*              S E T   A T T R I B U T E S                  *
 23462*                                                           *
 23463*************************************************************
 23464
 23465 7400-SET-ATTRIBUTES.
 23466
 23467     IF WS-SUB4 GREATER THAN PB-NO-OF-ERRORS
 23468        GO TO 7499-EXIT.
 23469
 23470**2601**
 23471
 23472     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2601
 23473        IF PB-ISSUE
 23474           MOVE AL-UABON         TO BEFFDTA
 23475           GO TO 7499-EXIT
 23476         ELSE
 23477           MOVE AL-UABON         TO CEFFDTA
 23478           GO TO 7499-EXIT.
 23479
 23480**2604**
 23481
 23482     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2604
 23483        IF PB-ISSUE
 23484           MOVE AL-UABON         TO BTYPE1A
 23485           MOVE -1               TO BTYPE1L
 23486           MOVE  1               TO SET-CURSOR-SW
 23487           GO TO 7499-EXIT.
 23488
 23489**2605**
 23490
 23491     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2605
 23492        IF PB-ISSUE
 23493           MOVE AL-UABON         TO BTYPE2A
 23494           MOVE -1               TO BTYPE2L
 23495           MOVE  1               TO SET-CURSOR-SW
 23496           GO TO 7499-EXIT.
 23497
 23498**2606**
 23499
 23500     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2606
 23501        IF PB-ISSUE
 23502           MOVE AL-UABON         TO BSIGA
 23503           MOVE -1               TO BSIGL
 23504           MOVE  1               TO SET-CURSOR-SW
 23505           GO TO 7499-EXIT.
 23506
 23507**2607**
 23508
 23509     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2607
 23510        IF PB-ISSUE
 23511           MOVE AL-UABON         TO BSIGA
 23512           MOVE -1               TO BSIGL
 23513           MOVE  1               TO SET-CURSOR-SW
 23514           GO TO 7499-EXIT.
 23515
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 433
* EL6311.cbl
 23516**2615**
 23517
 23518     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2607
 23519        IF PB-ISSUE
 23520           MOVE AL-UABOF         TO BREINA
 23521           MOVE -1               TO BREINL
 23522           GO TO 7499-EXIT.
 23523
 23524**2622**
 23525
 23526     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2622
 23527        IF PB-ISSUE
 23528           MOVE AL-UABON         TO BEFFDTA
 23529           GO TO 7499-EXIT
 23530        ELSE
 23531           MOVE AL-UABON         TO CEFFDTA
 23532           GO TO 7499-EXIT.
 23533
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 434
* EL6311.cbl
 23535
 23536*************************************************************
 23537*                                                           *
 23538*              I S S U E   E R R O R S                      *
 23539*                                                           *
 23540*************************************************************
 23541
 23542 7420-ISSUE-ERRORS.
 23543
 23544     IF PB-COMMON-ERROR    (WS-SUB4) = ER-1577
 23545        MOVE -1                  TO LETRREQL
 23546        MOVE AL-UABOF            TO LETRREQA
 23547        MOVE  1                  TO SET-CURSOR-SW
 23548        GO TO 7499-EXIT.
 23549
 23550     IF PB-COMMON-ERROR    (WS-SUB4) = ER-1584
 23551        MOVE AL-UABOF            TO LETRREQA
 23552        GO TO 7499-EXIT.
 23553
 23554**2626**
 23555
 23556     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2626
 23557        MOVE AL-UABON            TO BCERTNOA
 23558        GO TO 7499-EXIT.
 23559
 23560**2627**
 23561
 23562     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2627
 23563        MOVE AL-UNBON            TO BAGEA
 23564        MOVE -1                  TO BAGEL
 23565        MOVE  1                  TO SET-CURSOR-SW
 23566        GO TO 7499-EXIT.
 23567
 23568**2628**
 23569
 23570     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2628
 23571        MOVE AL-UNBON            TO BAGEA
 23572        MOVE -1                  TO BAGEL
 23573        MOVE  1                  TO SET-CURSOR-SW
 23574        GO TO 7499-EXIT.
 23575
 23576**2629**
 23577
 23578     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2629
 23579        MOVE AL-UABON            TO BSEXA
 23580        MOVE -1                  TO BSEXL
 23581        MOVE  1                  TO SET-CURSOR-SW
 23582        GO TO 7499-EXIT.
 23583
 23584**2630**
 23585
 23586     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2630
 23587        MOVE -1                  TO BTYPE1L
 23588        MOVE  1                  TO SET-CURSOR-SW
 23589        GO TO 7499-EXIT.
 23590
 23591**2631**
 23592
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 435
* EL6311.cbl
 23593     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2631
 23594        MOVE -1                  TO BTYPE1L
 23595        MOVE  1                  TO SET-CURSOR-SW
 23596        GO TO 7499-EXIT.
 23597
 23598**2632**
 23599
 23600     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2632
 23601        MOVE AL-UNBON            TO BBEN1A
 23602        MOVE -1                  TO BBEN1L
 23603        MOVE  1                  TO SET-CURSOR-SW
 23604        GO TO 7499-EXIT.
 23605
 23606**2633**
 23607
 23608     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2633
 23609        MOVE AL-UNBON            TO BPREM1A
 23610        MOVE -1                  TO BPREM1L
 23611        MOVE  1                  TO SET-CURSOR-SW
 23612        GO TO 7499-EXIT.
 23613
 23614**2634**
 23615
 23616     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2634
 23617        MOVE -1                  TO BTYPE2L
 23618        MOVE  1                  TO SET-CURSOR-SW
 23619        GO TO 7499-EXIT.
 23620
 23621**2635**
 23622
 23623     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2635
 23624        MOVE AL-UNBON            TO BBEN2A
 23625        MOVE -1                  TO BBEN2L
 23626        MOVE  1                  TO SET-CURSOR-SW
 23627        GO TO 7499-EXIT.
 23628
 23629**2636**
 23630
 23631     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2636
 23632        MOVE AL-UNBON            TO BPREM2A
 23633        MOVE -1                  TO BPREM2L
 23634        MOVE  1                  TO SET-CURSOR-SW
 23635        GO TO 7499-EXIT.
 23636
 23637**2639**
 23638
 23639     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2639
 23640        MOVE AL-UNBON            TO BBEN1A
 23641        MOVE -1                  TO BBEN1L
 23642        MOVE  1                  TO SET-CURSOR-SW
 23643        GO TO 7499-EXIT.
 23644
 23645**2640**
 23646
 23647     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2640
 23648        MOVE AL-UNBON            TO BBEN2A
 23649        MOVE -1                  TO BBEN2L
 23650        MOVE  1                  TO SET-CURSOR-SW
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 436
* EL6311.cbl
 23651        GO TO 7499-EXIT.
 23652
 23653**2647**
 23654
 23655     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2647
 23656        MOVE AL-UNBON            TO BTERM1A
 23657        MOVE -1                  TO BTERM1L
 23658        MOVE  1                  TO SET-CURSOR-SW
 23659        GO TO 7499-EXIT.
 23660
 23661**2648**
 23662
 23663     IF PB-COMMON-ERROR (WS-SUB4) = ER-2648 OR ER-1575
 23664              or er-3070
 23665        MOVE AL-UNBON            TO BLNTRMA
 23666        MOVE -1                  TO BLNTRML
 23667        MOVE  1                  TO SET-CURSOR-SW
 23668        GO TO 7499-EXIT.
 23669
 23670**2649**
 23671
 23672     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2649
 23673        AND PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
 23674            MOVE AL-UNBON            TO BPREM1A
 23675            MOVE -1                  TO BPREM1L
 23676            MOVE  1                  TO SET-CURSOR-SW
 23677            GO TO 7499-EXIT
 23678     ELSE
 23679        IF PB-COMMON-ERROR    (WS-SUB4) = ER-2649
 23680           AND PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 23681            MOVE AL-UNBON            TO BPREM2A
 23682            MOVE -1                  TO BPREM2L
 23683            MOVE  1                  TO SET-CURSOR-SW
 23684            GO TO 7499-EXIT.
 23685
 23686**2650**
 23687
 23688     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2650
 23689        IF  PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
 23690            MOVE AL-UNBON        TO BPREM1A
 23691            MOVE -1              TO BPREM1L
 23692            MOVE  1              TO SET-CURSOR-SW
 23693            IF  PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 23694                MOVE AL-UNBON        TO BPREM2A
 23695                MOVE -1              TO BPREM2L
 23696                MOVE  1              TO SET-CURSOR-SW
 23697                GO TO 7499-EXIT
 23698            ELSE
 23699                GO TO 7499-EXIT
 23700        ELSE
 23701            IF  PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 23702                MOVE AL-UNBON        TO BPREM2A
 23703                MOVE -1              TO BPREM2L
 23704                MOVE  1              TO SET-CURSOR-SW
 23705                GO TO 7499-EXIT
 23706            ELSE
 23707                GO TO 7499-EXIT.
 23708
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 437
* EL6311.cbl
 23709**2651**
 23710
 23711     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2651
 23712        MOVE AL-UABON            TO BSIGA
 23713        MOVE -1                  TO BSIGL
 23714        MOVE  1                  TO SET-CURSOR-SW
 23715        GO TO 7499-EXIT.
 23716
 23717**2653**
 23718
 23719     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2653
 23720        MOVE AL-UABON            TO BFREQA
 23721        MOVE -1                  TO BFREQL
 23722        MOVE  1                  TO SET-CURSOR-SW
 23723        GO TO 7499-EXIT.
 23724
 23725**2654**
 23726
 23727     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2654
 23728        MOVE AL-UABON            TO BFREQA
 23729        MOVE -1                  TO BFREQL
 23730        MOVE  1                  TO SET-CURSOR-SW
 23731        GO TO 7499-EXIT.
 23732
 23733**2655**
 23734
 23735     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2655
 23736        MOVE AL-UABON            TO BFREQA
 23737        MOVE -1                  TO BFREQL
 23738        MOVE  1                  TO SET-CURSOR-SW
 23739        GO TO 7499-EXIT.
 23740
 23741**2656**
 23742
 23743     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2656
 23744        MOVE AL-UNBON            TO BAPRA
 23745        MOVE -1                  TO BAPRL
 23746        MOVE  1                  TO SET-CURSOR-SW
 23747        GO TO 7499-EXIT.
 23748
 23749**2657**
 23750
 23751     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2657
 23752        MOVE AL-UNBON            TO BAPRA
 23753        MOVE -1                  TO BAPRL
 23754        MOVE  1                  TO SET-CURSOR-SW
 23755        GO TO 7499-EXIT.
 23756
 23757**2658**
 23758
 23759     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2657
 23760        MOVE AL-UNBON            TO BTERM2A
 23761        MOVE -1                  TO BTERM2L
 23762        MOVE  1                  TO SET-CURSOR-SW
 23763        GO TO 7499-EXIT.
 23764
 23765**2660**
 23766
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 438
* EL6311.cbl
 23767     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2660
 23768        MOVE AL-UABON            TO BLSTNMA B1STNMA BINITA
 23769        MOVE -1                  TO BLSTNML
 23770        MOVE  1                  TO SET-CURSOR-SW
 23771        GO TO 7499-EXIT.
 23772
 23773
 23774**2662**
 23775
 23776     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2662
 23777        MOVE AL-UNBON            TO BAGEA
 23778        MOVE -1                  TO BAGEL
 23779        MOVE  1                  TO SET-CURSOR-SW
 23780        GO TO 7499-EXIT.
 23781
 23782**2663**
 23783
 23784     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2663
 23785        MOVE AL-UNBON            TO BAGEA
 23786        MOVE -1                  TO BAGEL
 23787        MOVE  1                  TO SET-CURSOR-SW
 23788        GO TO 7499-EXIT.
 23789
 23790**2664**
 23791
 23792     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2664
 23793        MOVE AL-UABON            TO BREINA
 23794        MOVE -1                  TO BREINL
 23795        MOVE  1                  TO SET-CURSOR-SW
 23796        GO TO 7499-EXIT.
 23797
 23798**2667**
 23799
 23800     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2667
 23801        MOVE AL-UNBON            TO BBEN2A
 23802        MOVE -1                  TO BBEN2L
 23803        MOVE  1                  TO SET-CURSOR-SW
 23804        GO TO 7499-EXIT.
 23805
 23806**2668**
 23807
 23808     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2668
 23809        MOVE AL-UABON            TO BEFFDTA
 23810        GO TO 7499-EXIT.
 23811
 23812**2669**
 23813
 23814     IF PB-COMMON-ERROR (WS-SUB4) = ER-2669 OR ER-1570
 23815       OR ER-2077 OR ER-2628 OR ER-2661 OR ER-3054 OR ER-3504
 23816       OR ER-3513 OR ER-7144 OR ER-9063 OR ER-9076 OR ER-9618
 23817        MOVE AL-UNBON            TO BAGEA
 23818        MOVE -1                  TO BAGEL
 23819        MOVE  1                  TO SET-CURSOR-SW
 23820        GO TO 7499-EXIT.
 23821
 23822**2670**
 23823
 23824     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2670
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 439
* EL6311.cbl
 23825        MOVE AL-UABON            TO BFORCEA
 23826        MOVE -1                  TO BFORCEL
 23827        MOVE  1                  TO SET-CURSOR-SW
 23828        GO TO 7499-EXIT.
 23829
 23830**2671**
 23831
 23832     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2671
 23833        MOVE AL-UABON            TO BEFFDTA
 23834        GO TO 7499-EXIT.
 23835
 23836**2672**
 23837
 23838     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2672
 23839        MOVE AL-UABON            TO BEFFDTA
 23840        GO TO 7499-EXIT.
 23841
 23842**2673**
 23843
 23844     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2673
 23845        MOVE AL-UABON            TO BEFFDTA
 23846        GO TO 7499-EXIT.
 23847
 23848**2674**
 23849
 23850     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2673
 23851        MOVE AL-UABON            TO BTYPE1A BTYPE2A
 23852        MOVE -1                  TO BTYPE1L
 23853        MOVE  1                  TO SET-CURSOR-SW
 23854        GO TO 7499-EXIT.
 23855
 23856**2677**
 23857
 23858     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2677
 23859        MOVE AL-UNBON            TO BTERM1A
 23860        MOVE -1                  TO BTERM1L
 23861        MOVE  1                  TO SET-CURSOR-SW
 23862        GO TO 7499-EXIT.
 23863
 23864**2678**
 23865
 23866     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2678
 23867        MOVE AL-UNBON            TO BTERM2A
 23868        MOVE -1                  TO BTERM2L
 23869        MOVE  1                  TO SET-CURSOR-SW
 23870        GO TO 7499-EXIT.
 23871
 23872**2679**
 23873
 23874     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2679
 23875        MOVE AL-UABON            TO BTYPE1A
 23876        MOVE -1                  TO BTYPE1L
 23877        MOVE  1                  TO SET-CURSOR-SW
 23878        GO TO 7499-EXIT.
 23879
 23880**2680**
 23881
 23882     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2680
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 440
* EL6311.cbl
 23883        MOVE AL-UABOF            TO B1STPMTA
 23884        MOVE -1                  TO B1STPMTL
 23885        MOVE  1                  TO SET-CURSOR-SW
 23886        GO TO 7499-EXIT.
 23887
 23888**2681**
 23889
 23890     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2681
 23891        MOVE AL-UABON            TO BDAYSA
 23892        MOVE -1                  TO BDAYSL
 23893        MOVE  1                  TO SET-CURSOR-SW
 23894        GO TO 7499-EXIT.
 23895
 23896**2682**
 23897
 23898     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2682
 23899        MOVE AL-UABON            TO BTERM1A
 23900        MOVE -1                  TO BTERM1L
 23901        MOVE  1                  TO SET-CURSOR-SW
 23902        GO TO 7499-EXIT.
 23903
 23904**2683**
 23905
 23906     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2683
 23907        MOVE AL-UABON            TO BSKPCDA
 23908        MOVE -1                  TO BSKPCDL
 23909        MOVE  1                  TO SET-CURSOR-SW
 23910        GO TO 7499-EXIT.
 23911
 23912**2684**
 23913
 23914     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2684
 23915        MOVE AL-UABON            TO BTYPE2A
 23916        MOVE -1                  TO BTYPE2L
 23917        MOVE  1                  TO SET-CURSOR-SW
 23918        GO TO 7499-EXIT.
 23919
 23920**2686**
 23921
 23922     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2686
 23923        MOVE AL-UABON            TO BTYPE2A
 23924        MOVE -1                  TO BTYPE2L
 23925        MOVE  1                  TO SET-CURSOR-SW
 23926        GO TO 7499-EXIT.
 23927
 23928**2689**
 23929
 23930     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2689
 23931        MOVE AL-UABON            TO BSIGA
 23932        MOVE -1                  TO BSIGL
 23933        MOVE  1                  TO SET-CURSOR-SW
 23934        GO TO 7499-EXIT.
 23935
 23936**2690**
 23937
 23938     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2690
 23939        MOVE AL-UABOF            TO BLNOFCRA
 23940        MOVE -1                  TO BLNOFCRL
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 441
* EL6311.cbl
 23941        MOVE  1                  TO SET-CURSOR-SW
 23942        GO TO 7499-EXIT.
 23943
 23944**2693**
 23945
 23946     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2693
 23947        MOVE AL-UABOF            TO BLNOFCRA
 23948        MOVE AL-UNBON            TO BBEN1A
 23949        MOVE -1                  TO BBEN1L
 23950        MOVE  1                  TO SET-CURSOR-SW
 23951        GO TO 7499-EXIT.
 23952
 23953**2720**
 23954
 23955     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2720
 23956        MOVE AL-UNBON            TO BBEN1A
 23957        MOVE -1                  TO BBEN1L
 23958        MOVE  1                  TO SET-CURSOR-SW
 23959        GO TO 7499-EXIT.
 23960
 23961**2709**
 23962
 23963*    IF PB-COMMON-ERROR    (WS-SUB4) = ER-2709
 23964*       MOVE AL-UNBON            TO BBEN1A
 23965*       MOVE -1                  TO BBEN1L
 23966*       MOVE  1                  TO SET-CURSOR-SW
 23967*       GO TO 7499-EXIT.
 23968
 23969*************************************************************
 23970*                                                           *
 23971*            C A N C E L   E R R O R S                      *
 23972*                                                           *
 23973*************************************************************
 23974
 23975**2726**
 23976
 23977     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2726
 23978        MOVE AL-UABON            TO CCERTNOA
 23979        GO TO 7499-EXIT.
 23980
 23981**2728**
 23982
 23983     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2728
 23984        MOVE AL-UABON            TO CCERTNOA
 23985        GO TO 7499-EXIT.
 23986
 23987**2729**
 23988
 23989     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2729
 23990        MOVE AL-UABON            TO CCERTNOA
 23991        GO TO 7499-EXIT.
 23992
 23993**2730**
 23994
 23995     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2729
 23996        MOVE AL-UABON            TO CCERTNOA
 23997        GO TO 7499-EXIT.
 23998
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 442
* EL6311.cbl
 23999**2731**
 24000
 24001     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2731
 24002        MOVE AL-UABON            TO CCANDT1A
 24003        MOVE -1                  TO CCANDT1L
 24004        MOVE  1                  TO SET-CURSOR-SW
 24005        GO TO 7499-EXIT.
 24006
 24007**2732**
 24008
 24009     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2732
 24010        MOVE AL-UABON            TO CCANDT1A
 24011        MOVE -1                  TO CCANDT1L
 24012        MOVE  1                  TO SET-CURSOR-SW
 24013        GO TO 7499-EXIT.
 24014
 24015**2733**
 24016
 24017     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2733
 24018        MOVE AL-UABON            TO CCANDT1A
 24019        MOVE -1                  TO CCANDT1L
 24020        MOVE  1                  TO SET-CURSOR-SW
 24021        GO TO 7499-EXIT.
 24022
 24023**2734**
 24024
 24025     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2733
 24026        MOVE AL-UNBON            TO CREFND1A
 24027        MOVE -1                  TO CREFND1L
 24028        MOVE  1                  TO SET-CURSOR-SW
 24029        GO TO 7499-EXIT.
 24030
 24031**2735**
 24032
 24033     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2735
 24034        MOVE AL-UABON            TO CCANDT2A
 24035        MOVE -1                  TO CCANDT2L
 24036        MOVE  1                  TO SET-CURSOR-SW
 24037        GO TO 7499-EXIT.
 24038
 24039**2736**
 24040
 24041     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2735
 24042        IF  PB-C-LF-CANCEL-AMT GREATER THAN ZEROS
 24043            MOVE AL-UNBON        TO CREFND1A
 24044            MOVE -1              TO CREFND1L
 24045            MOVE  1              TO SET-CURSOR-SW
 24046            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 24047                MOVE AL-UNBON        TO CREFND2A
 24048                MOVE -1              TO CREFND2L
 24049                MOVE  1              TO SET-CURSOR-SW
 24050                GO TO 7499-EXIT
 24051            ELSE
 24052                GO TO 7499-EXIT
 24053        ELSE
 24054            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 24055                MOVE AL-UNBON        TO CREFND2A
 24056                MOVE -1              TO CREFND2L
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 443
* EL6311.cbl
 24057                MOVE  1              TO SET-CURSOR-SW
 24058                GO TO 7499-EXIT
 24059            ELSE
 24060                GO TO 7499-EXIT.
 24061
 24062**2738**
 24063
 24064     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 24065        MOVE -1                  TO CREFND2L
 24066        MOVE  1                  TO SET-CURSOR-SW
 24067        GO TO 7499-EXIT.
 24068
 24069**2739**
 24070
 24071     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 24072        MOVE -1                  TO CREFND1L
 24073        MOVE  1                  TO SET-CURSOR-SW
 24074        GO TO 7499-EXIT.
 24075
 24076**2741**
 24077
 24078     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 24079        MOVE -1                  TO CREFND1L
 24080        MOVE  1                  TO SET-CURSOR-SW
 24081        GO TO 7499-EXIT.
 24082
 24083**2743**
 24084
 24085     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2743
 24086        MOVE AL-UNBON            TO CCANDT1A
 24087        MOVE -1                  TO CCANDT1L
 24088        MOVE  1                  TO SET-CURSOR-SW
 24089        GO TO 7499-EXIT.
 24090
 24091**2744**
 24092
 24093     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2744
 24094        MOVE AL-UNBON            TO CCANDT2A
 24095        MOVE -1                  TO CCANDT2L
 24096        MOVE  1                  TO SET-CURSOR-SW
 24097        GO TO 7499-EXIT.
 24098
 24099**2747**
 24100
 24101     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2747
 24102        MOVE AL-UABON            TO CLSTNMA
 24103        MOVE -1                  TO CLSTNML
 24104        MOVE  1                  TO SET-CURSOR-SW
 24105        GO TO 7499-EXIT.
 24106
 24107**2749**
 24108
 24109     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2749
 24110        MOVE AL-UABON            TO CFORCEA
 24111        MOVE -1                  TO CFORCEL
 24112        MOVE  1                  TO SET-CURSOR-SW
 24113        GO TO 7499-EXIT.
 24114
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 444
* EL6311.cbl
 24115**2753**
 24116
 24117     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2753
 24118        MOVE AL-UNBON            TO CCANDT1A
 24119        MOVE -1                  TO CCANDT1L
 24120        MOVE  1                  TO SET-CURSOR-SW
 24121        GO TO 7499-EXIT.
 24122
 24123**2755**
 24124
 24125     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2755
 24126        IF  PB-C-LF-CANCEL-AMT GREATER THAN ZEROS
 24127            MOVE AL-UNBON        TO CREFND1A
 24128            MOVE -1              TO CREFND1L
 24129            MOVE  1              TO SET-CURSOR-SW
 24130            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 24131                MOVE AL-UNBON        TO CREFND2A
 24132                MOVE -1              TO CREFND2L
 24133                MOVE  1              TO SET-CURSOR-SW
 24134                GO TO 7499-EXIT
 24135            ELSE
 24136                GO TO 7499-EXIT
 24137        ELSE
 24138            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 24139                MOVE AL-UNBON        TO CREFND2A
 24140                MOVE -1              TO CREFND2L
 24141                MOVE  1              TO SET-CURSOR-SW
 24142            ELSE
 24143                GO TO 7499-EXIT.
 24144
 24145**2757**
 24146
 24147     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2757
 24148        MOVE AL-UNBON            TO CLIVESA
 24149        MOVE -1                  TO CLIVESL
 24150        MOVE  1                  TO SET-CURSOR-SW
 24151        GO TO 7499-EXIT.
 24152
 24153**2771**
 24154
 24155     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2771
 24156        MOVE AL-UABON            TO CCANDT2A
 24157        MOVE -1                  TO CCANDT2L
 24158        MOVE  1                  TO SET-CURSOR-SW
 24159        GO TO 7499-EXIT.
 24160
 24161**2774**
 24162
 24163     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2774
 24164        MOVE AL-UABON            TO CCANDT1A
 24165        MOVE -1                  TO CCANDT1L
 24166        MOVE  1                  TO SET-CURSOR-SW
 24167        GO TO 7499-EXIT.
 24168
 24169**2775**
 24170
 24171     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2775
 24172        MOVE AL-UABON            TO CCANDT2A
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 445
* EL6311.cbl
 24173        MOVE -1                  TO CCANDT2L
 24174        MOVE  1                  TO SET-CURSOR-SW
 24175        GO TO 7499-EXIT.
 24176
 24177**2776**
 24178
 24179     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2776
 24180        MOVE AL-UABON            TO CCANDT1A
 24181        MOVE -1                  TO CCANDT1L
 24182        MOVE  1                  TO SET-CURSOR-SW
 24183        GO TO 7499-EXIT.
 24184
 24185
 24186**2777**
 24187
 24188     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2777
 24189        MOVE AL-UABON            TO CCANDT2A
 24190        MOVE -1                  TO CCANDT2L
 24191        MOVE  1                  TO SET-CURSOR-SW
 24192        GO TO 7499-EXIT.
 24193
 24194**2794**
 24195
 24196     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2794
 24197        MOVE AL-UABON            TO CFORCEA
 24198        MOVE -1                  TO CFORCEL
 24199        MOVE  1                  TO SET-CURSOR-SW
 24200        GO TO 7499-EXIT.
 24201
 24202**2799**
 24203
 24204     IF PI-COMPANY-ID = 'UCL'
 24205         IF PB-COMMON-ERROR    (WS-SUB4) = ER-2799
 24206             MOVE AL-UNBON            TO BEFFDTA
 24207             MOVE -1                  TO BEFFDTL
 24208             MOVE  1                  TO SET-CURSOR-SW
 24209             GO TO 7499-EXIT.
 24210
 24211 7499-EXIT.
 24212      EXIT.
 24213
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 446
* EL6311.cbl
 24215
 24216 7500-READ-ERLOFC.
 24217     MOVE SPACES                 TO  WS-LOAN-OFFICER
 24218                                     ERLOFC-KEY.
 24219
 24220     MOVE PI-COMPANY-CD          TO  ERLOFC-COMPANY-CD.
 24221
 24222     IF ST-ACCNT-CNTL
 24223         MOVE PI-SV-STATE        TO  ERLOFC-STATE.
 24224
 24225     IF CARR-GROUP-ST-ACCNT-CNTL
 24226         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER
 24227         MOVE PI-SV-STATE        TO  ERLOFC-STATE
 24228         MOVE PI-SV-GROUPING     TO  ERLOFC-GROUPING.
 24229
 24230     IF CARR-ST-ACCNT-CNTL
 24231         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER
 24232         MOVE PI-SV-STATE        TO  ERLOFC-STATE.
 24233
 24234     IF CARR-ACCNT-CNTL
 24235         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER.
 24236
 24237     MOVE PI-PB-ACCOUNT          TO  ERLOFC-ACCOUNT.
 24238
 24239     MOVE BLNOFCRI               TO ERLOFC-OFFICER-CODE.
 24240
 24241
 24242* EXEC CICS HANDLE CONDITION
 24243*        NOTFND   (7550-OFFICER-NOTFND)
 24244*    END-EXEC.
 24245*    MOVE '"$I                   ! V #00020486' TO DFHEIV0
 24246     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 24247     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 24248     MOVE X'5620233030303230343836' TO DFHEIV0(25:11)
 24249     CALL 'kxdfhei1' USING DFHEIV0
 24250     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24251
 24252
 24253
 24254* EXEC CICS READ
 24255*        DATASET   (FILE-ID-ERLOFC)
 24256*        SET       (ADDRESS OF LOAN-OFFICER-MASTER)
 24257*        RIDFLD    (ERLOFC-KEY)
 24258*        EQUAL
 24259*    END-EXEC.
 24260*    MOVE '&"S        E          (   #00020490' TO DFHEIV0
 24261     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 24262     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24263     MOVE X'2020233030303230343930' TO DFHEIV0(25:11)
 24264     CALL 'kxdfhei1' USING DFHEIV0,
 24265           FILE-ID-ERLOFC,
 24266           DFHEIV20,
 24267           DFHEIV99,
 24268           ERLOFC-KEY,
 24269           DFHEIV99,
 24270           DFHEIV99,
 24271           DFHEIV99
 24272     SET ADDRESS OF LOAN-OFFICER-MASTER TO
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 447
* EL6311.cbl
 24273         DFHEIV20
 24274     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24275
 24276
 24277     GO TO 7599-EXIT.
 24278
 24279 7550-OFFICER-NOTFND.
 24280     MOVE 'X'                    TO WS-LOAN-OFFICER.
 24281
 24282 7599-EXIT.
 24283      EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 448
* EL6311.cbl
 24285******************************************************************
 24286*                                                                *
 24287*            S  E N D    I N I T I A L   M A P                   *
 24288*                                                                *
 24289******************************************************************
 24290
 24291 8100-SEND-INITIAL-MAP.
 24292     MOVE EIBTIME                TO TIME-IN.
 24293
 24294     IF EIBAID = DFHPF11
 24295        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 24296        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 24297
 24298
 24299     IF PI-COMPANY-ID = CLIENT-GIC
 24300        MOVE AL-UNNOF               TO BCPREM-ATTRB (1)
 24301                                       BCPREM-ATTRB (2).
 24302
 24303     IF PI-COMPANY-ID = (CLIENT-MIC OR
 24304                         CLIENT-PEM OR
 24305                         CLIENT-CSO)
 24306        AND PI-DISPLAY-ORIGINAL-BATCH
 24307          IF PI-MAP-NAME = EL631B
 24308             MOVE AL-SADOF               TO BPF5HDRA
 24309                                            BPF4HDRA
 24310          ELSE
 24311             IF PI-MAP-NAME = EL631C
 24312                MOVE AL-SADOF            TO CPF5HDRA
 24313                                            CPF4HDRA.
 24314
 24315     IF PI-MAP-NAME = EL631B
 24316        MOVE AL-SADOF               TO BPF5HDRA
 24317     ELSE
 24318        MOVE AL-SADOF               TO CPF5HDRA
 24319     END-IF
 24320
 24321*DMD CUSTOM CODING*************START    DO IT WHEN SCREEN=EL631B &
 24322     IF PI-MAP-NAME = EL631B
 24323          IF PI-COMPANY-ID NOT = 'DMD'
 24324             MOVE AL-SANOF            TO BBILLEDA
 24325             MOVE AL-SADOF            TO DMDBILA.
 24326*DMD CUSTOM CODING*************END
 24327
 24328     IF PI-PROCESSOR-ID = 'LGXX'
 24329        IF PI-MAP-NAME = EL631B
 24330           MOVE AL-SABOF                    TO BREFHDGA
 24331           MOVE AL-SANOF                    TO BREFA
 24332        ELSE
 24333           IF PI-MAP-NAME = EL631C
 24334              MOVE AL-SABOF                 TO CREFHDGA
 24335              MOVE AL-SANOF                 TO CREFA.
 24336
 24337     IF PI-COMPANY-ID = 'ACE' or 'LGX' or 'DCC' or 'VPP'
 24338        continue
 24339     ELSE
 24340        IF PI-MAP-NAME = EL631C
 24341           MOVE AL-SADOF         TO CCANTXTA
 24342                                    CCANFEEA
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 449
* EL6311.cbl
 24343        end-if
 24344     end-if
 24345     IF PI-MAP-NAME = EL631D
 24346        IF PI-AR-PROCESSING
 24347           MOVE AL-SANOF            TO DREFHDGA
 24348        ELSE
 24349           MOVE AL-SADOF            TO DREFHDGA.
 24350
 24351     IF (PI-COMPANY-ID NOT = 'DCC' and 'VPP' and 'CID')
 24352        AND (PI-MAP-NAME = EL631B)
 24353        MOVE AL-SADOF            TO BVINHA
 24354                                    BVINA
 24355     END-IF
 24356     IF PI-MAP-NAME = EL631B
 24357        MOVE PI-COMPANY-ID          TO BCOMPIDO
 24358        MOVE FUNCTION UPPER-CASE(WS-KIX-MYENV)
 24359                                 TO BREGIONO
 24360        MOVE PI-PROCESSOR-ID     TO BUSERO
 24361        IF CSR-EDIT-SESSION
 24362           MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
 24363                                 TO BHEADO
 24364           MOVE '4=B-HDR 6=RES'  TO BPF4HDRO
 24365        ELSE
 24366           MOVE AL-SADOF         TO BF15HDRA
 24367           MOVE '4=B-HDR      '  TO BPF4HDRO
 24368        END-IF
 24369        MOVE PI-MEMBER-CAPTION      TO BMEMCAPO
 24370        MOVE PI-LIFE-OVERRIDE-L2    TO BKIND1O
 24371        MOVE PI-AH-OVERRIDE-L2      TO BKIND2O
 24372        MOVE WS-CURRENT-DT          TO BDATEO
 24373        MOVE TIME-OUT               TO BTIMEO
 24374        MOVE EMI-MESSAGE-AREA (1)   TO BERMSG1O
 24375        MOVE EMI-MESSAGE-AREA (2)   TO BERMSG2O
 24376        MOVE EMI-MESSAGE-AREA (3)   TO BERMSG3O
 24377        IF   WS-DISPLAY-SCREEN
 24378             MOVE PB-ENTRY-BATCH    TO BBATCHO
 24379             MOVE PB-SV-CARRIER     TO BCARRO
 24380             MOVE PB-SV-GROUPING    TO BGROUPO
 24381             MOVE PB-SV-STATE       TO BSTATEO
 24382             MOVE PB-ACCOUNT        TO BACCTO
 24383        ELSE
 24384             MOVE PI-PB-ENTRY-BATCH TO BBATCHO
 24385     ELSE
 24386        IF PI-MAP-NAME = EL631C
 24387           MOVE '4=B-HDR      '     TO CPF4HDRO
 24388           IF CSR-EDIT-SESSION
 24389              MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
 24390                                 TO CHEADO
 24391           ELSE
 24392              MOVE AL-SADOF      TO CF15HDRA
 24393           END-IF
 24394           MOVE PI-PB-ENTRY-BATCH      TO CBATCHO
 24395           MOVE WS-CURRENT-DT          TO CDATEO
 24396           MOVE TIME-OUT               TO CTIMEO
 24397           MOVE PI-LIFE-OVERRIDE-L2    TO CKIND1O
 24398           MOVE PI-AH-OVERRIDE-L2      TO CKIND2O
 24399           MOVE PI-LIFE-OVERRIDE-L2    TO WS-REF-HDG-OVERRIDE
 24400           MOVE WS-C-HDG               TO CLFHDGO
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 450
* EL6311.cbl
 24401           MOVE PI-AH-OVERRIDE-L2      TO WS-REF-HDG-OVERRIDE
 24402           MOVE WS-C-HDG               TO CAHHDGO
 24403           MOVE EMI-MESSAGE-AREA (1)   TO CERMSG1O
 24404           MOVE EMI-MESSAGE-AREA (2)   TO CERMSG2O
 24405           MOVE EMI-MESSAGE-AREA (3)   TO CERMSG3O
 24406           IF   WS-DISPLAY-SCREEN
 24407                MOVE PB-ENTRY-BATCH    TO CBATCHO
 24408                MOVE PB-SV-CARRIER     TO CCARRO
 24409                MOVE PB-SV-GROUPING    TO CGROUPO
 24410                MOVE PB-SV-STATE       TO CSTATEO
 24411                MOVE PB-ACCOUNT        TO CACCTO
 24412           ELSE
 24413                MOVE PI-PB-ENTRY-BATCH TO CBATCHO
 24414        ELSE
 24415           MOVE WS-CURRENT-DT          TO DDATEO
 24416           MOVE TIME-OUT               TO DTIMEO
 24417           MOVE PI-LIFE-OVERRIDE-L2    TO WS-PREM-HDG-OVERRIDE
 24418                                          WS-REFUND-HDG-OVERRIDE
 24419           MOVE WS-D-PREM-HDG          TO DLFPHDGO
 24420           MOVE WS-D-REFUND-HDG        TO DLFRHDGO
 24421           MOVE PI-AH-OVERRIDE-L2      TO WS-PREM-HDG-OVERRIDE
 24422                                          WS-REFUND-HDG-OVERRIDE
 24423           MOVE WS-D-PREM-HDG          TO DAHPHDGO
 24424           MOVE WS-D-REFUND-HDG        TO DAHRHDGO
 24425           MOVE EMI-MESSAGE-AREA (1)   TO DERMSGO
 24426           IF CSR-EDIT-SESSION
 24427              MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
 24428                                 TO DHEADO
 24429           END-IF
 24430           IF  WS-DISPLAY-SCREEN
 24431               MOVE PB-ENTRY-BATCH     TO DBATCHO
 24432               MOVE PB-CARRIER         TO DCARRO
 24433               MOVE PB-GROUPING        TO DGROUPO
 24434               MOVE PB-STATE           TO DSTATEO
 24435               MOVE PB-ACCOUNT         TO DACCTO
 24436               MOVE PB-ACCOUNT-NAME    TO DACCTNMO
 24437           ELSE
 24438               MOVE EL631D             TO PI-MAP-NAME
 24439               MOVE PI-PB-ENTRY-BATCH  TO DBATCHO
 24440               MOVE PB-ACCOUNT-NAME TO DACCTNMO.
 24441
 24442     MOVE SPACE                        TO WS-DISPLAY-SW.
 24443
 24444
 24445* EXEC CICS SEND
 24446*        MAP      (PI-MAP-NAME)
 24447*        MAPSET   (MAPSET-EL6311S)
 24448*        FROM     (EL631BI)
 24449*        ERASE
 24450*        CURSOR
 24451*    END-EXEC.
 24452     MOVE LENGTH OF
 24453      EL631BI
 24454       TO DFHEIV12
 24455     MOVE -1
 24456       TO DFHEIV11
 24457*    MOVE '8$     CT  E    H L F ,   #00020664' TO DFHEIV0
 24458     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 451
* EL6311.cbl
 24459     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 24460     MOVE X'2020233030303230363634' TO DFHEIV0(25:11)
 24461     CALL 'kxdfhei1' USING DFHEIV0,
 24462           PI-MAP-NAME,
 24463           EL631BI,
 24464           DFHEIV12,
 24465           MAPSET-EL6311S,
 24466           DFHEIV99,
 24467           DFHEIV99,
 24468           DFHEIV99,
 24469           DFHEIV11,
 24470           DFHEIV99,
 24471           DFHEIV99,
 24472           DFHEIV99
 24473     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24474
 24475
 24476     GO TO 9100-RETURN-TRAN.
 24477
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 452
* EL6311.cbl
 24479
 24480******************************************************************
 24481*                                                                *
 24482*              S E N D    D A T A O N L Y                        *
 24483*                                                                *
 24484******************************************************************
 24485
 24486 8200-SEND-DATAONLY.
 24487     MOVE EIBTIME                TO TIME-IN.
 24488
 24489     IF PI-COMPANY-ID = CLIENT-GIC
 24490        MOVE AL-UNNOF               TO BCPREM-ATTRB (1)
 24491                                       BCPREM-ATTRB (2).
 24492
 24493     IF PI-MAP-NAME = EL631B
 24494        MOVE PI-MEMBER-CAPTION      TO BMEMCAPO
 24495        MOVE WS-CURRENT-DT          TO BDATEO
 24496        MOVE TIME-OUT               TO BTIMEO
 24497        MOVE EMI-MESSAGE-AREA (1)   TO BERMSG1O
 24498        MOVE EMI-MESSAGE-AREA (2)   TO BERMSG2O
 24499        MOVE EMI-MESSAGE-AREA (3)   TO BERMSG3O
 24500        MOVE SPACES                 TO BPFENTRO
 24501        MOVE AL-UANOF               TO BPFENTRA
 24502
 24503*DMD CUSTOM CODING*************START    DO IT WHEN SCREEN=EL631B &
 24504        IF PI-COMPANY-ID NOT = 'DMD'
 24505             MOVE AL-SANOF            TO BBILLEDA
 24506             MOVE AL-SADOF            TO DMDBILA
 24507         ELSE
 24508            NEXT SENTENCE
 24509*DMD CUSTOM CODING*************END
 24510     ELSE
 24511        IF PI-MAP-NAME = EL631C
 24512           MOVE WS-CURRENT-DT          TO CDATEO
 24513           MOVE TIME-OUT               TO CTIMEO
 24514           MOVE EMI-MESSAGE-AREA (1)   TO CERMSG1O
 24515           MOVE EMI-MESSAGE-AREA (2)   TO CERMSG2O
 24516           MOVE EMI-MESSAGE-AREA (3)   TO CERMSG3O
 24517           MOVE SPACES                 TO CPFENTRO
 24518           MOVE AL-UANOF               TO CPFENTRA
 24519        ELSE
 24520           MOVE WS-CURRENT-DT          TO DDATEO
 24521           MOVE TIME-OUT               TO DTIMEO
 24522           MOVE EMI-MESSAGE-AREA (1)   TO DERMSGO.
 24523
 24524
 24525* EXEC CICS SEND
 24526*        MAP      (PI-MAP-NAME)
 24527*        MAPSET   (MAPSET-EL6311S)
 24528*        FROM     (EL631BI)
 24529*        DATAONLY
 24530*        CURSOR
 24531*    END-EXEC.
 24532     MOVE LENGTH OF
 24533      EL631BI
 24534       TO DFHEIV12
 24535     MOVE -1
 24536       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 453
* EL6311.cbl
 24537*    MOVE '8$D    CT       H L F ,   #00020720' TO DFHEIV0
 24538     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 24539     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 24540     MOVE X'2020233030303230373230' TO DFHEIV0(25:11)
 24541     CALL 'kxdfhei1' USING DFHEIV0,
 24542           PI-MAP-NAME,
 24543           EL631BI,
 24544           DFHEIV12,
 24545           MAPSET-EL6311S,
 24546           DFHEIV99,
 24547           DFHEIV99,
 24548           DFHEIV99,
 24549           DFHEIV11,
 24550           DFHEIV99,
 24551           DFHEIV99,
 24552           DFHEIV99
 24553     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24554
 24555
 24556     GO TO 9100-RETURN-TRAN.
 24557
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 454
* EL6311.cbl
 24559
 24560******************************************************************
 24561*                                                                *
 24562*           U T I L I T Y   R O U T I N E S                      *
 24563*                                                                *
 24564******************************************************************
 24565
 24566 8300-SEND-TEXT.
 24567
 24568* EXEC CICS SEND TEXT
 24569*        FROM     (LOGOFF-TEXT)
 24570*        LENGTH   (LOGOFF-LENGTH)
 24571*        ERASE
 24572*        FREEKB
 24573*    END-EXEC.
 24574*    MOVE '8&      T  E F  H   F -   #00020739' TO DFHEIV0
 24575     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 24576     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 24577     MOVE X'2020233030303230373339' TO DFHEIV0(25:11)
 24578     CALL 'kxdfhei1' USING DFHEIV0,
 24579           LOGOFF-TEXT,
 24580           LOGOFF-LENGTH,
 24581           DFHEIV99,
 24582           DFHEIV99,
 24583           DFHEIV99,
 24584           DFHEIV99,
 24585           DFHEIV99,
 24586           DFHEIV99,
 24587           DFHEIV99,
 24588           DFHEIV99,
 24589           DFHEIV99,
 24590           DFHEIV99
 24591     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24592
 24593
 24594
 24595* EXEC CICS RETURN
 24596*    END-EXEC.
 24597*    MOVE '.(                    ''   #00020746' TO DFHEIV0
 24598     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 24599     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 24600     MOVE X'2020233030303230373436' TO DFHEIV0(25:11)
 24601     CALL 'kxdfhei1' USING DFHEIV0,
 24602           DFHEIV99,
 24603           DFHEIV99,
 24604           DFHEIV99,
 24605           DFHEIV99,
 24606           DFHEIV99,
 24607           DFHEIV99
 24608     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24609
 24610
 24611 8400-LOG-JOURNAL-RECORD.
 24612
 24613     if (pi-journal-file-id > 0)
 24614        and (jp-file-id = file-id-erpndb)
 24615        move eibdate             to jp-date
 24616        move eibtime             to jp-time
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 455
* EL6311.cbl
 24617*       move FILE-ID-ERPNDB      TO JP-FILE-ID
 24618        MOVE PI-PROCESSOR-ID     TO JP-USER-ID
 24619        MOVE 03                  TO PI-JOURNAL-FILE-ID
 24620        if csr-edit-session
 24621           move 'EL6311C'        to jp-program-id
 24622        else
 24623           MOVE THIS-PGM         TO JP-PROGRAM-ID
 24624        end-if
 24625
 24626**      length is 585 plus 30 extra for jrnl stuff
 24627**      system already accounts for the 34
 24628
 24629
 24630* EXEC CICS JOURNAL
 24631*          JFILEID   (PI-JOURNAL-FILE-ID)
 24632*          JTYPEID   ('EL')
 24633*          FROM      (JOURNAL-RECORD)
 24634*          LENGTH    (615)
 24635*          resp      (ws-response)
 24636*       END-EXEC
 24637     MOVE 'EL' TO DFHEIV7
 24638     MOVE 615
 24639       TO DFHEIV11
 24640*    MOVE '4"LF                  (  N#00020767' TO DFHEIV0
 24641     MOVE X'34224C462020202020202020' TO DFHEIV0(1:12)
 24642     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24643     MOVE X'204E233030303230373637' TO DFHEIV0(25:11)
 24644     CALL 'kxdfhei1' USING DFHEIV0,
 24645           PI-JOURNAL-FILE-ID,
 24646           DFHEIV7,
 24647           JOURNAL-RECORD,
 24648           DFHEIV11,
 24649           DFHEIV99,
 24650           DFHEIV99,
 24651           DFHEIV99
 24652     MOVE EIBRESP  TO ws-response
 24653     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 24654
 24655        if resp-normal
 24656           continue
 24657        else
 24658           display ' error-el6311-journal ' ws-response
 24659        end-if
 24660     end-if
 24661
 24662*    EXEC CICS JOURNAL
 24663*        JFILEID     (PI-JOURNAL-FILE-ID)
 24664*        JTYPEID     ('EL')
 24665*        FROM        (JOURNAL-RECORD)
 24666*        LENGTH      (WS-JOURNAL-RECORD-LENGTH)
 24667*    END-EXEC.
 24668     .
 24669 8400-exit.
 24670     exit.
 24671 8600-DEEDIT.
 24672
 24673* EXEC CICS BIF DEEDIT
 24674*         FIELD   (DEEDIT-FIELD)
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 456
* EL6311.cbl
 24675*         LENGTH  (15)
 24676*    END-EXEC.
 24677     MOVE 15
 24678       TO DFHEIV11
 24679*    MOVE '@"L                   #   #00020792' TO DFHEIV0
 24680     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 24681     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 24682     MOVE X'2020233030303230373932' TO DFHEIV0(25:11)
 24683     CALL 'kxdfhei1' USING DFHEIV0,
 24684           DEEDIT-FIELD,
 24685           DFHEIV11
 24686     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24687
 24688
 24689 8800-UNAUTHORIZED-ACCESS.
 24690     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 24691     GO TO 8300-SEND-TEXT.
 24692
 24693 8810-PF23.
 24694     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 24695     MOVE XCTL-EL005             TO PGM-NAME.
 24696     GO TO 9300-XCTL.
 24697
 24698 9100-RETURN-TRAN.
 24699     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 24700
 24701     IF  PI-MAP-NAME =  EL631B
 24702         MOVE '631B'             TO PI-CURRENT-SCREEN-NO.
 24703
 24704     IF  PI-MAP-NAME =  EL631C
 24705         MOVE '631C'             TO PI-CURRENT-SCREEN-NO.
 24706
 24707     IF  PI-MAP-NAME =  EL631D
 24708         MOVE '631D'             TO PI-CURRENT-SCREEN-NO.
 24709
 24710
 24711* EXEC CICS RETURN
 24712*        TRANSID    (TRANS-EXB1)
 24713*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 24714*        LENGTH     (1300)
 24715*    END-EXEC.
 24716     MOVE 1300
 24717       TO DFHEIV11
 24718*    MOVE '.(CT                  ''   #00020818' TO DFHEIV0
 24719     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 24720     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 24721     MOVE X'2020233030303230383138' TO DFHEIV0(25:11)
 24722     CALL 'kxdfhei1' USING DFHEIV0,
 24723           TRANS-EXB1,
 24724           PROGRAM-INTERFACE-BLOCK,
 24725           DFHEIV11,
 24726           DFHEIV99,
 24727           DFHEIV99,
 24728           DFHEIV99
 24729     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24730
 24731
 24732 9200-RETURN-MAIN-MENU.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 457
* EL6311.cbl
 24733     MOVE XCTL-EL626             TO PGM-NAME.
 24734     GO TO 9300-XCTL.
 24735
 24736 9300-XCTL.
 24737
 24738* EXEC CICS XCTL
 24739*        PROGRAM    (PGM-NAME)
 24740*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 24741*        LENGTH     (PI-COMM-LENGTH)
 24742*    END-EXEC.
 24743*    MOVE '.$C                   %   #00020829' TO DFHEIV0
 24744     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 24745     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 24746     MOVE X'2020233030303230383239' TO DFHEIV0(25:11)
 24747     CALL 'kxdfhei1' USING DFHEIV0,
 24748           PGM-NAME,
 24749           PROGRAM-INTERFACE-BLOCK,
 24750           PI-COMM-LENGTH,
 24751           DFHEIV99
 24752     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24753
 24754
 24755 9400-CLEAR.
 24756     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
 24757     GO TO 9300-XCTL.
 24758
 24759 9500-PF12.
 24760     MOVE XCTL-EL010             TO PGM-NAME.
 24761     GO TO 9300-XCTL.
 24762
 24763 9600-PGMID-ERROR.
 24764
 24765* EXEC CICS HANDLE CONDITION
 24766*        PGMIDERR    (8300-SEND-TEXT)
 24767*    END-EXEC.
 24768*    MOVE '"$L                   ! W #00020844' TO DFHEIV0
 24769     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 24770     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 24771     MOVE X'5720233030303230383434' TO DFHEIV0(25:11)
 24772     CALL 'kxdfhei1' USING DFHEIV0
 24773     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24774
 24775
 24776     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
 24777     MOVE ' '                    TO PI-ENTRY-CD-1.
 24778     MOVE XCTL-EL005             TO PGM-NAME.
 24779     MOVE PGM-NAME               TO LOGOFF-PGM.
 24780     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
 24781     GO TO 9300-XCTL.
 24782
 24783 9700-DATE-LINK.
 24784     MOVE LINK-ELDATCV           TO PGM-NAME.
 24785
 24786* EXEC CICS LINK
 24787*        PROGRAM    (PGM-NAME)
 24788*        COMMAREA   (DATE-CONVERSION-DATA)
 24789*        LENGTH     (DC-COMM-LENGTH)
 24790*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 458
* EL6311.cbl
 24791*    MOVE '."C                   (   #00020857' TO DFHEIV0
 24792     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24793     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24794     MOVE X'2020233030303230383537' TO DFHEIV0(25:11)
 24795     CALL 'kxdfhei1' USING DFHEIV0,
 24796           PGM-NAME,
 24797           DATE-CONVERSION-DATA,
 24798           DC-COMM-LENGTH,
 24799           DFHEIV99,
 24800           DFHEIV99,
 24801           DFHEIV99,
 24802           DFHEIV99
 24803     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24804
 24805
 24806 9800-LINK-PENDING-EDIT.
 24807     MOVE PI-LIFE-OVERRIDE-L1    TO PB-LIFE-OVERRIDE-L1.
 24808     MOVE PI-AH-OVERRIDE-L1      TO PB-AH-OVERRIDE-L1.
 24809
 24810     MOVE LINK-EL050             TO PGM-NAME
 24811     MOVE PENDING-BUSINESS       TO PASSED-RECORD
 24812     MOVE ZEROS                  TO WK-CO-MAX-CAP
 24813                                    WK-CO-TOL-CLAIM
 24814                                    WK-CO-TOL-PREM
 24815                                    WK-CO-TOL-REFUND
 24816                                    WK-CO-TOL-PREM-PCT
 24817                                    WK-CO-TOL-REFUND-PCT
 24818                                    WK-REFUND-OVS-AMT
 24819                                    WK-REFUND-OVS-PCT
 24820                                    WK-ACCT-ADDR
 24821                                    WK-LIFE-EDIT-ADDR
 24822                                    WK-AH-EDIT-ADDR
 24823                                    WK-LIFE-BEN-ADDR
 24824                                    WK-AH-BEN-ADDR
 24825                                    WK-STATE-ADDR
 24826                                    WK-PLAN-ADDR
 24827                                    WK-FORM-ADDR
 24828     MOVE PI-CSR-SESSION-SW      TO WK-CSR-SESSION-SW
 24829
 24830     MOVE '6'                    TO WK-ENTRY-SW.
 24831
 24832     MOVE SPACES                 TO EDIT-CRITERIA-DATA.
 24833
 24834     MOVE LOW-VALUES             TO EC-CO-MONTH-END-DT
 24835                                    EC-AM-EXPIRATION-DT
 24836                                    EC-AM-EFFECTIVE-DT
 24837                                    EC-CM-LF-CANCEL-DT
 24838                                    EC-CM-AH-CANCEL-DT
 24839                                    EC-CM-DEATH-DT.
 24840
 24841     MOVE ZEROS                  TO EC-CO-TOL-PREM
 24842                                    EC-CO-TOL-REFUND
 24843                                    EC-CO-MIN-AGE
 24844                                    EC-CO-MIN-PREMIUM
 24845                                    EC-CO-MIN-TERM
 24846                                    EC-CO-MAX-TERM
 24847                                    EC-ST-TOL-PREM
 24848                                    EC-ST-TOL-REFUND
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 459
* EL6311.cbl
 24849                                    EC-AM-LF-TOL-PREM
 24850                                    EC-AM-AH-TOL-PREM
 24851                                    EC-AM-LF-MAX-ATT-AGE
 24852                                    EC-AM-LF-MAX-AGE
 24853                                    EC-AM-LF-MAX-TERM
 24854                                    EC-AM-LF-MAX-TOT-BEN
 24855                                    EC-AM-AH-MAX-ATT-AGE
 24856                                    EC-AM-AH-MAX-AGE
 24857                                    EC-AM-AH-MAX-TERM
 24858                                    EC-AM-AH-MAX-TOT-BEN
 24859                                    EC-AM-AH-MAX-MON-BEN
 24860                                    EC-RT-LF-MAX-ATT-AGE
 24861                                    EC-RT-LF-MAX-AGE
 24862                                    EC-RT-LF-MAX-TERM
 24863                                    EC-RT-LF-MAX-TOT-BEN
 24864                                    EC-RT-AH-MAX-ATT-AGE
 24865                                    EC-RT-AH-MAX-AGE
 24866                                    EC-RT-AH-MAX-TERM
 24867                                    EC-RT-AH-MAX-TOT-BEN
 24868                                    EC-RT-AH-MAX-MON-BEN
 24869                                    EC-RT-AH-RATE
 24870                                    EC-RT-LF-RATE
 24871                                    EC-RT-LF-NSP-RATE
 24872                                    EC-RT-AH-NSP-RATE
 24873                                    EC-CM-LF-PRIOR-REFUND
 24874                                    EC-CM-AH-PRIOR-REFUND.
 24875
 24876     MOVE ZEROS                  TO EC-CO-TOL-PREM-PCT
 24877                                    EC-ST-TOL-PREM-PCT
 24878                                    EC-AM-LF-TOL-REFUND
 24879                                    EC-AM-LF-DEV-PERCENT
 24880                                    EC-CO-TOL-REFUND-PCT
 24881                                    EC-ST-TOL-REFUND-PCT
 24882                                    EC-AM-AH-TOL-REFUND
 24883                                    EC-AM-AH-DEV-PERCENT.
 24884
 24885
 24886* EXEC CICS LINK
 24887*         PROGRAM   (PGM-NAME)
 24888*         COMMAREA  (PASSED-RECORD)
 24889*         LENGTH    (WS-EDIT-PASS-LENGTH)
 24890*    END-EXEC.
 24891*    MOVE '."C                   (   #00020942' TO DFHEIV0
 24892     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24893     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24894     MOVE X'2020233030303230393432' TO DFHEIV0(25:11)
 24895     CALL 'kxdfhei1' USING DFHEIV0,
 24896           PGM-NAME,
 24897           PASSED-RECORD,
 24898           WS-EDIT-PASS-LENGTH,
 24899           DFHEIV99,
 24900           DFHEIV99,
 24901           DFHEIV99,
 24902           DFHEIV99
 24903     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24904
 24905
 24906     MOVE '1'                    TO PI-EDIT-SW.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 460
* EL6311.cbl
 24907     MOVE EDIT-CRITERIA-DATA     TO PI-CRITERIA-DATA.
 24908
 24909     MOVE PASSED-RECORD          TO PENDING-BUSINESS.
 24910
 24911     IF PI-COMPANY-ID = 'UCL'
 24912         MOVE EC-AM-EFFECTIVE-DT TO WS-CERT-EFF-DT.
 24913
 24914     IF VALID-PB-ID
 24915        GO TO 9800-EXIT.
 24916
 24917     MOVE PENDING-BUSINESS       TO EMI-LINE1.
 24918
 24919     IF PI-MAP-NAME = EL631B
 24920        MOVE -1                  TO BMAINTL
 24921       ELSE
 24922        MOVE -1                  TO CMAINTL.
 24923
 24924     GO TO 8200-SEND-DATAONLY.
 24925
 24926 9800-EXIT.
 24927      EXIT.
 24928
 24929 9900-ERROR-FORMAT.
 24930
 24931     MOVE PI-COMPANY-ID TO EMI-CLIENT-ID.
 24932
 24933     IF NOT EMI-ERRORS-COMPLETE
 24934         MOVE LINK-EL001         TO PGM-NAME
 24935
 24936* EXEC CICS LINK
 24937*            PROGRAM    (PGM-NAME)
 24938*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 24939*            LENGTH     (EMI-COMM-LENGTH)
 24940*        END-EXEC.
 24941*    MOVE '."C                   (   #00020977' TO DFHEIV0
 24942     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24943     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24944     MOVE X'2020233030303230393737' TO DFHEIV0(25:11)
 24945     CALL 'kxdfhei1' USING DFHEIV0,
 24946           PGM-NAME,
 24947           ERROR-MESSAGE-INTERFACE-BLOCK,
 24948           EMI-COMM-LENGTH,
 24949           DFHEIV99,
 24950           DFHEIV99,
 24951           DFHEIV99,
 24952           DFHEIV99
 24953     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24954
 24955
 24956 9900-EXIT.
 24957     EXIT.
 24958
 24959 9990-ABEND.
 24960     MOVE LINK-EL004             TO PGM-NAME.
 24961     MOVE DFHEIBLK               TO EMI-LINE1.
 24962
 24963* EXEC CICS LINK
 24964*        PROGRAM   (PGM-NAME)
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 461
* EL6311.cbl
 24965*        COMMAREA  (EMI-LINE1)
 24966*        LENGTH    (72)
 24967*    END-EXEC.
 24968     MOVE 72
 24969       TO DFHEIV11
 24970*    MOVE '."C                   (   #00020989' TO DFHEIV0
 24971     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24972     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24973     MOVE X'2020233030303230393839' TO DFHEIV0(25:11)
 24974     CALL 'kxdfhei1' USING DFHEIV0,
 24975           PGM-NAME,
 24976           EMI-LINE1,
 24977           DFHEIV11,
 24978           DFHEIV99,
 24979           DFHEIV99,
 24980           DFHEIV99,
 24981           DFHEIV99
 24982     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24983
 24984
 24985     IF PI-MAP-NAME = EL631B
 24986        MOVE -1                  TO BMAINTL
 24987       ELSE
 24988        MOVE -1                  TO CMAINTL.
 24989
 24990     IF EIBTRNID NOT = TRANS-EXB1
 24991        GO TO 8100-SEND-INITIAL-MAP
 24992       ELSE
 24993        GO TO 8200-SEND-DATAONLY.
 24994
 24995 9995-SECURITY-VIOLATION.
 24996*                            COPY ELCSCTP.
 24997******************************************************************
 24998*                                                                *
 24999*                            ELCSCTP                             *
 25000*                            VMOD=2.001                          *
 25001*                                                                *
 25002*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 25003******************************************************************
 25004
 25005
 25006     MOVE EIBDATE          TO SM-JUL-DATE.
 25007     MOVE EIBTRMID         TO SM-TERMID.
 25008     MOVE THIS-PGM         TO SM-PGM.
 25009     MOVE EIBTIME          TO TIME-IN.
 25010     MOVE TIME-OUT         TO SM-TIME.
 25011     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 25012
 25013
 25014* EXEC CICS LINK
 25015*         PROGRAM  ('EL003')
 25016*         COMMAREA (SECURITY-MESSAGE)
 25017*         LENGTH   (80)
 25018*    END-EXEC.
 25019     MOVE 'EL003' TO DFHEIV1
 25020     MOVE 80
 25021       TO DFHEIV11
 25022*    MOVE '."C                   (   #00021023' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 462
* EL6311.cbl
 25023     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 25024     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 25025     MOVE X'2020233030303231303233' TO DFHEIV0(25:11)
 25026     CALL 'kxdfhei1' USING DFHEIV0,
 25027           DFHEIV1,
 25028           SECURITY-MESSAGE,
 25029           DFHEIV11,
 25030           DFHEIV99,
 25031           DFHEIV99,
 25032           DFHEIV99,
 25033           DFHEIV99
 25034     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 25035
 25036
 25037******************************************************************
 25038
 25039
 25040 9999-DFHBACK SECTION.
 25041     MOVE '9%                    "   ' TO DFHEIV0
 25042     MOVE 'EL6311' TO DFHEIV1
 25043     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 25044     GOBACK.
 25045 9999-DFHEXIT.
 25046     IF DFHEIGDJ EQUAL 0001
 25047         NEXT SENTENCE
 25048     ELSE IF DFHEIGDJ EQUAL 2
 25049         GO TO 9600-PGMID-ERROR,
 25050               9990-ABEND,
 25051               9990-ABEND,
 25052               0010-MAIN-LOGIC
 25053         DEPENDING ON DFHEIGDI
 25054     ELSE IF DFHEIGDJ EQUAL 3
 25055         GO TO 1280-BATCH-HDR-NOT-FOUND
 25056         DEPENDING ON DFHEIGDI
 25057     ELSE IF DFHEIGDJ EQUAL 4
 25058         GO TO 1290-DUPLICATE-ALT-INDEX
 25059         DEPENDING ON DFHEIGDI
 25060     ELSE IF DFHEIGDJ EQUAL 5
 25061         GO TO 1295-CERT-TRL-REC-NOTFND
 25062         DEPENDING ON DFHEIGDI
 25063     ELSE IF DFHEIGDJ EQUAL 6
 25064         GO TO 1380-BATCH-HDR-NOT-FOUND
 25065         DEPENDING ON DFHEIGDI
 25066     ELSE IF DFHEIGDJ EQUAL 7
 25067         GO TO 1385-REC-NOT-FOUND
 25068         DEPENDING ON DFHEIGDI
 25069     ELSE IF DFHEIGDJ EQUAL 8
 25070         GO TO 1386-NOTFND
 25071         DEPENDING ON DFHEIGDI
 25072     ELSE IF DFHEIGDJ EQUAL 9
 25073         GO TO 1399-EXIT
 25074         DEPENDING ON DFHEIGDI
 25075     ELSE IF DFHEIGDJ EQUAL 10
 25076         GO TO 1480-BATCH-HDR-NOT-FOUND
 25077         DEPENDING ON DFHEIGDI
 25078     ELSE IF DFHEIGDJ EQUAL 11
 25079         GO TO 1490-RECORD-NOT-FOUND
 25080         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 463
* EL6311.cbl
 25081     ELSE IF DFHEIGDJ EQUAL 12
 25082         GO TO 1405-DELETE-CERTIFICATE
 25083         DEPENDING ON DFHEIGDI
 25084     ELSE IF DFHEIGDJ EQUAL 13
 25085         GO TO 1420-CONTINUE-DELETE
 25086         DEPENDING ON DFHEIGDI
 25087     ELSE IF DFHEIGDJ EQUAL 14
 25088         GO TO 1406-DELETE-ERNOTE
 25089         DEPENDING ON DFHEIGDI
 25090     ELSE IF DFHEIGDJ EQUAL 15
 25091         GO TO 1407-DELETE-MAILING
 25092         DEPENDING ON DFHEIGDI
 25093     ELSE IF DFHEIGDJ EQUAL 16
 25094         GO TO 1420-CONTINUE-DELETE
 25095         DEPENDING ON DFHEIGDI
 25096     ELSE IF DFHEIGDJ EQUAL 17
 25097         GO TO 1480-BATCH-HDR-NOT-FOUND
 25098         DEPENDING ON DFHEIGDI
 25099     ELSE IF DFHEIGDJ EQUAL 18
 25100         GO TO 1475-DELETE-FINISHED
 25101         DEPENDING ON DFHEIGDI
 25102     ELSE IF DFHEIGDJ EQUAL 19
 25103         GO TO 2280-BATCH-HDR-NOT-FOUND
 25104         DEPENDING ON DFHEIGDI
 25105     ELSE IF DFHEIGDJ EQUAL 20
 25106         GO TO 2290-DUPLICATE-ALT-INDEX
 25107         DEPENDING ON DFHEIGDI
 25108     ELSE IF DFHEIGDJ EQUAL 21
 25109         GO TO 2380-BATCH-HDR-NOT-FOUND
 25110         DEPENDING ON DFHEIGDI
 25111     ELSE IF DFHEIGDJ EQUAL 22
 25112         GO TO 2385-REC-NOT-FOUND
 25113         DEPENDING ON DFHEIGDI
 25114     ELSE IF DFHEIGDJ EQUAL 23
 25115         GO TO 2380-BATCH-HDR-NOT-FOUND
 25116         DEPENDING ON DFHEIGDI
 25117     ELSE IF DFHEIGDJ EQUAL 24
 25118         GO TO 2485-BATCH-HDR-NOT-FOUND
 25119         DEPENDING ON DFHEIGDI
 25120     ELSE IF DFHEIGDJ EQUAL 25
 25121         GO TO 2490-RECORD-NOT-FOUND
 25122         DEPENDING ON DFHEIGDI
 25123     ELSE IF DFHEIGDJ EQUAL 26
 25124         GO TO 2475-CONTINUE-DELETE
 25125         DEPENDING ON DFHEIGDI
 25126     ELSE IF DFHEIGDJ EQUAL 27
 25127         GO TO 2485-BATCH-HDR-NOT-FOUND
 25128         DEPENDING ON DFHEIGDI
 25129     ELSE IF DFHEIGDJ EQUAL 28
 25130         GO TO 2480-DELETE-FINISHED
 25131         DEPENDING ON DFHEIGDI
 25132     ELSE IF DFHEIGDJ EQUAL 29
 25133         GO TO 2920-PROCESS-REWRITE
 25134         DEPENDING ON DFHEIGDI
 25135     ELSE IF DFHEIGDJ EQUAL 30
 25136         GO TO 2985-RECORD-MISSING
 25137         DEPENDING ON DFHEIGDI
 25138     ELSE IF DFHEIGDJ EQUAL 31
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 464
* EL6311.cbl
 25139         GO TO 2960-BUILD-NEW-CANCEL-RECORD
 25140         DEPENDING ON DFHEIGDI
 25141     ELSE IF DFHEIGDJ EQUAL 32
 25142         GO TO 2990-DUPLICATE-RECORD
 25143         DEPENDING ON DFHEIGDI
 25144     ELSE IF DFHEIGDJ EQUAL 33
 25145         GO TO 3590-NOT-FOUND
 25146         DEPENDING ON DFHEIGDI
 25147     ELSE IF DFHEIGDJ EQUAL 34
 25148         GO TO 3690-NOT-FOUND
 25149         DEPENDING ON DFHEIGDI
 25150     ELSE IF DFHEIGDJ EQUAL 35
 25151         GO TO 3990-NOT-FOUND
 25152         DEPENDING ON DFHEIGDI
 25153     ELSE IF DFHEIGDJ EQUAL 36
 25154         GO TO 4050-END-RECORDS,
 25155               4050-END-RECORDS
 25156         DEPENDING ON DFHEIGDI
 25157     ELSE IF DFHEIGDJ EQUAL 37
 25158         GO TO 4150-END-BATCH
 25159         DEPENDING ON DFHEIGDI
 25160     ELSE IF DFHEIGDJ EQUAL 38
 25161         GO TO 4150-END-BATCH
 25162         DEPENDING ON DFHEIGDI
 25163     ELSE IF DFHEIGDJ EQUAL 39
 25164         GO TO 4250-END-RECORDS,
 25165               4250-END-RECORDS
 25166         DEPENDING ON DFHEIGDI
 25167     ELSE IF DFHEIGDJ EQUAL 40
 25168         GO TO 4350-END-BATCH,
 25169               4350-END-BATCH
 25170         DEPENDING ON DFHEIGDI
 25171     ELSE IF DFHEIGDJ EQUAL 41
 25172         GO TO 4570-NOT-FOUND,
 25173               4550-END-RECORDS
 25174         DEPENDING ON DFHEIGDI
 25175     ELSE IF DFHEIGDJ EQUAL 42
 25176         GO TO 4680-NOT-FOUND,
 25177               4680-NOT-FOUND
 25178         DEPENDING ON DFHEIGDI
 25179     ELSE IF DFHEIGDJ EQUAL 43
 25180         GO TO 4860-NOT-FOUND,
 25181               4850-END-RECORDS
 25182         DEPENDING ON DFHEIGDI
 25183     ELSE IF DFHEIGDJ EQUAL 44
 25184         GO TO 4970-NOT-FOUND,
 25185               4950-END-RECORDS
 25186         DEPENDING ON DFHEIGDI
 25187     ELSE IF DFHEIGDJ EQUAL 45
 25188         GO TO 5050-NOT-FOUND
 25189         DEPENDING ON DFHEIGDI
 25190     ELSE IF DFHEIGDJ EQUAL 46
 25191         GO TO 5050-NOT-FOUND
 25192         DEPENDING ON DFHEIGDI
 25193     ELSE IF DFHEIGDJ EQUAL 47
 25194         GO TO 5050-NOT-FOUND
 25195         DEPENDING ON DFHEIGDI
 25196     ELSE IF DFHEIGDJ EQUAL 48
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:52 Page 465
* EL6311.cbl
 25197         GO TO 5550-END-RECORDS,
 25198               5550-END-RECORDS
 25199         DEPENDING ON DFHEIGDI
 25200     ELSE IF DFHEIGDJ EQUAL 49
 25201         GO TO 6050-QID-ERROR
 25202         DEPENDING ON DFHEIGDI
 25203     ELSE IF DFHEIGDJ EQUAL 50
 25204         GO TO 6050-QID-ERROR
 25205         DEPENDING ON DFHEIGDI
 25206     ELSE IF DFHEIGDJ EQUAL 51
 25207         GO TO 6400-CONTINUE,
 25208               6400-CONTINUE
 25209         DEPENDING ON DFHEIGDI
 25210     ELSE IF DFHEIGDJ EQUAL 52
 25211         GO TO 3690-NOT-FOUND
 25212         DEPENDING ON DFHEIGDI
 25213     ELSE IF DFHEIGDJ EQUAL 53
 25214         GO TO 7399-EXIT
 25215         DEPENDING ON DFHEIGDI
 25216     ELSE IF DFHEIGDJ EQUAL 54
 25217         GO TO 7550-OFFICER-NOTFND
 25218         DEPENDING ON DFHEIGDI
 25219     ELSE IF DFHEIGDJ EQUAL 55
 25220         GO TO 8300-SEND-TEXT
 25221         DEPENDING ON DFHEIGDI.
 25222     MOVE '9%                    "   ' TO DFHEIV0
 25223     MOVE 'EL6311' TO DFHEIV1
 25224     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 25225     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       16636     Code:       99465
