* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page   1
* NSRLTRBL.cbl
* Options: int("NSRLTRBL.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("NSRLTRBL.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"NSRLTRBL.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST
*          "NSRLTRBL.lst" LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0"
*          NOMAPNAME NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT
*          NOMOVELENCHECK NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT
*          NONCHAR NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.   NSRLTRBL.
     3*AUTHOR.     PABLO
     4*            COLLEYVILLE, TEXAS.
     5*REMARKS.    EXECUTED FROM NSREQLTR
     6******************************************************************
     7*                   C H A N G E   L O G
     8*
     9* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    10*-----------------------------------------------------------------
    11*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    12* EFFECTIVE    NUMBER
    13*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page   2
* NSRLTRBL.cbl
    14* 121802    2009122800001  PEMA  NEW PROGRAM
    15* 022212    2011120900003  AJRA  ADD AHL
    16* 031912    2011120900003  AJRA  ADD AHL CLAIM NO TO EXTRACT
    17* 020513    2011090100001  PEMA  CORRECT ISS WITH MULT &
    18* 020613    2012110800002  AJRA  ADD BUS TYPE (GPCD) TO NAPERSOFT
    19* 031116    2015110400001  TANA  ADD EL150D FIELDS
    20* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
    21* 031319  IR2019031100002  TANA  Correct iss w/ letters with ???
    22* 071719    2019011600010  TANA  ADD VERIFICATION CODE
    23******************************************************************
    24 ENVIRONMENT DIVISION.
    25 DATA DIVISION.
    26 working-storage section.
    27 01  DFH-START PIC X(04).
    28 77  SAVE-DATE                   PIC X(8)    VALUE SPACES.
    29 77  WS-SAVE-EDIT-A-DATE         PIC X(10)   VALUE SPACES.
    30 77  SAVE-BIN-DATE               PIC XX      VALUE SPACES.
    31 77  S1                          PIC S999 COMP-3 VALUE +0.
    32 77  S2                          PIC S999 COMP-3 VALUE +0.
    33 77  S3                          PIC S999 COMP-3 VALUE +0.
    34 77  E1                          PIC S999 COMP-3 VALUE +0.
    35 77  A1                          PIC S9(5) COMP-3 VALUE +0.
    36 77  M1                          PIC S999 COMP-3 VALUE +0.
    37 77  P1                          PIC S999 COMP-3 VALUE +0.
    38 77  WS-HOLD-KEY                 PIC X(20).
    39 77  WS-HOLD-S1                  PIC S999 COMP-3 VALUE +0.
    40 77  WS-WORK-FIELD               PIC X(80)    VALUE SPACES.
    41 77  WS-ARCHIVE-NO               PIC S9(8)  COMP VALUE +0.
    42 77  WS-FOLLOW-UP-DT             PIC XX  VALUE LOW-VALUES.
    43 77  WS-RESEND-DT                PIC XX  VALUE LOW-VALUES.
    44 77  WS-AUTO-LAST-SCHED-DT       PIC XX  VALUE LOW-VALUES.
    45 77  WS-LAST-ACT-DT              PIC XX  VALUE LOW-VALUES.
    46 77  WS-ACTIVITY-DT              PIC XX  VALUE LOW-VALUES.
    47 77  WS-FORM                     PIC XXXX  VALUE SPACES.
    48 77  WS-LAST-ACT-TYPE            PIC X   VALUE ' '.
    49 77  WS-FOUND-BENE-SW            PIC X   VALUE ' '.
    50     88  FOUND-BENE                  VALUE 'Y'.
    51 77  WS-TALLY                    PIC S999 COMP-3 VALUE +0.
    52 77  WS-TALLY1                   PIC S999 COMP-3 VALUE +0.
    53 77  NS-LEN                      PIC S9(5) COMP-3 VALUE +0.
    54 77  WS-CNTR                     pic s999 comp-3 value +0.
    55 77  WS-MONTHS-BETWEEN           PIC S999 COMP-3 VALUE +0.
    56 77  WS-ACCUM-DAYS               PIC S9(5) COMP-3 VALUE +0.
    57 77  WS-ACCUM-AMT                PIC S9(9)V99 COMP-3 VALUE +0.
    58 77  WS-ACCUM-PD-BENS            PIC S999 COMP-3 VALUE +0.
    59 77  WS-PREV-CLM-TYPE            PIC X   VALUE ' '.
    60 77  WS-PREV-INS-TYPE            PIC X   VALUE ' '.
    61 77  WS-PREV-BEN-PER             PIC 99 VALUE ZEROS.
    62 77  WS-PDEF-RECORD-SW           PIC X  VALUE ' '.
    63     88  PDEF-FOUND                   VALUE 'Y'.
    64 77  wk1                         pic 999 value zeros.
    65 77  wk2                         pic 999 value zeros.
    66 77  WS-WORK-BEN-PCT             PIC S9V999 COMP-3 VALUE +0.
    67 77  WS-MAX-SUB                  PIC 9(4)    VALUE ZEROS.
    68 01  OUTPUT-SCREEN-WORK-AREA.
    69     05  OS-PREV-KEY.
    70         10  OS-PREV-CLM-TYPE        PIC X.
    71         10  OS-PREV-INS-TYPE        PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page   3
* NSRLTRBL.cbl
    72     05  WS-PD-BENS                  PIC 999 VALUE ZEROS.
    73     05  WS-COV-REM-BENS             PIC S999 VALUE ZEROS.
    74 01  WS-XML-WORK                 PIC X(2500)  VALUE SPACES.
    75 01 response-code         pic s9(8) comp.
    76 01 display-response      pic 9(8).
    77 01 bl-index              pic 9(8) comp.
    78 01 max-last-name         pic x(18).
    79 01 first-initial         pic x.
    80 01 name-in-range-flag    pic 9.
    81 01 max-entries           pic s9(8) comp value 100.
    82 01 lower-case    pic x(26) value
    83            "abcdefghijklmnopqrstuvwxyz".
    84 01 upper-case    pic x(26) value
    85            "ABCDEFGHIJKLMNOPQRSTUVWXYZ".
    86 01  W-Z-CONTROL-DATA.
    87     05  W-NUMBER-OF-COPIES  PIC  9(01).
    88     05  FILLER              PIC  X(01).
    89     05  W-DAYS-TO-FOLLOW-UP PIC  9(03).
    90     05  FILLER              PIC  X(01).
    91     05  W-DAYS-TO-RESEND-1  PIC  9(03).
    92     05  FILLER              PIC  X(01).
    93     05  W-FORM-TO-RESEND    PIC  X(04).
    94     05  FILLER              PIC  X(01).
    95     05  W-PROMPT-LETTER     PIC  X(01).
    96     05  FILLER              PIC  X(01).
    97     05  W-ENCLOSURE-CD      PIC  X(03).
    98     05  FILLER              PIC  X(1).
    99     05  W-AUTO-CLOSE-IND    PIC  X(1).
   100     05  FILLER              PIC  X(1).
   101     05  W-LETTER-TO-BENE    PIC  X(1).
   102 01  MISC.
   103     12  WS-RESPONSE             PIC S9(8)   COMP.
   104         88  RESP-NORMAL                  VALUE +00.
   105         88  RESP-NOTFND                  VALUE +13.
   106         88  RESP-DUPREC                  VALUE +14.
   107         88  RESP-DUPKEY                  VALUE +15.
   108         88  RESP-NOTOPEN                 VALUE +19.
   109         88  RESP-ENDFILE                 VALUE +20.
   110 01  WS-ELENCC-KEY.
   111     05  WS-ELENCC-COMPANY-CD    PIC X.
   112     05  WS-ELENCC-REC-TYPE      PIC X.
   113     05  WS-ELENCC-ENC-CODE      PIC X(5).
   114     05  F                       PIC X(09).
   115 01  WS-ELMSTR-KEY.
   116     05  WS-ELMSTR-COMPANY-CD    PIC X.
   117     05  WS-ELMSTR-CARRIER       PIC X.
   118     05  WS-ELMSTR-CLAIM-NO      PIC X(7).
   119     05  WS-ELMSTR-CERT-NO       PIC X(11).
   120 01  WS-ELTRLR-KEY.
   121     05  WS-ELTRLR-COMPANY-CD    PIC X.
   122     05  WS-ELTRLR-CARRIER       PIC X.
   123     05  WS-ELTRLR-CLAIM-NO      PIC X(7).
   124     05  WS-ELTRLR-CERT-NO       PIC X(11).
   125     05  WS-ELTRLR-SEQ-NO        PIC S9(4) COMP VALUE +0.
   126 01  WS-ELCERT-KEY.
   127     05  WS-ELCERT-COMPANY-CD    PIC X.
   128     05  WS-ELCERT-CARRIER       PIC X.
   129     05  WS-ELCERT-GROUP         PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page   4
* NSRLTRBL.cbl
   130     05  WS-ELCERT-STATE         PIC XX.
   131     05  WS-ELCERT-ACCOUNT       PIC X(10).
   132     05  WS-ELCERT-EFF-DT        PIC XX.
   133     05  WS-ELCERT-CERT-NO       PIC X(11).
   134 01  WS-ERACCT-KEY.
   135     05  WS-ERACCT-COMPANY-CD    PIC X.
   136     05  WS-ERACCT-CARRIER       PIC X.
   137     05  WS-ERACCT-GROUP         PIC X(6).
   138     05  WS-ERACCT-STATE         PIC XX.
   139     05  WS-ERACCT-ACCOUNT       PIC X(10).
   140     05  WS-ERACCT-EXP-DT        PIC XX.
   141     05  FILLER                  PIC XXXX.
   142 01  WS-ELBENE-KEY.
   143     05  WS-ELBENE-COMPANY-CD    PIC X.
   144     05  WS-ELBENE-REC-TYPE      PIC X.
   145     05  WS-ELBENE-BENE          PIC X(10).
   146 01  WS-ELLETR-KEY.
   147     05  WS-ELLETR-COMPANY-CD    PIC X.
   148     05  WS-ELLETR-LETTER-ID     PIC X(12).
   149     05  WS-ELLETR-SEQ-NO        PIC S9(4) COMP VALUE +0.
   150 01  WS-ELCNTL-KEY.
   151     05  WS-ELCNTL-COMPANY-ID    PIC XXX.
   152     05  WS-ELCNTL-REC-TYPE      PIC X.
   153     05  WS-ELCNTL-GENL.
   154         10  FILLER              PIC XX  VALUE SPACES.
   155         10  WS-ELCNTL-BEN-CD    PIC XX.
   156     05  WS-ELCNTL-SEQ-NO        PIC S9(4) COMP.
   157 01  ACCESS-KEYS.
   158     12  ELCRTT-KEY.
   159         16  CRTT-COMP-CD            PIC X.
   160         16  CRTT-CARRIER            PIC X.
   161         16  CRTT-GROUPING           PIC X(6).
   162         16  CRTT-STATE              PIC XX.
   163         16  CRTT-ACCOUNT            PIC X(10).
   164         16  CRTT-EFF-DT             PIC XX.
   165         16  CRTT-CERT-NO            PIC X(11).
   166         16  CRTT-REC-TYPE           PIC X.
   167
   168 01  ERPDEF-KEY-SAVE             PIC X(18).
   169 01  ERPDEF-KEY.
   170     12  ERPDEF-COMPANY-CD       PIC X.
   171     12  ERPDEF-STATE            PIC XX.
   172     12  ERPDEF-PROD-CD          PIC XXX.
   173     12  F                       PIC X(7).
   174     12  ERPDEF-BEN-TYPE         PIC X.
   175     12  ERPDEF-BEN-CODE         PIC XX.
   176     12  ERPDEF-EXP-DT           PIC XX.
   177 01  TEXT-WORK-AREAS.
   178     05  WS-COV-TYPE             PIC X(4) VALUE SPACES.
   179 01  WS-UNSORTED-TABLE.
   180     12  WS-UNSRTD-TABLE   OCCURS 25 TIMES.
   181         16  WS-KEY.
   182             20  WS-CLM-TYPE     PIC X.
   183             20  WS-INS-TYPE     PIC X.
   184             20  WS-BEN-PER      PIC 99.
   185             20  WS-INC-DT       PIC XX.
   186         16  WS-EXCL-PER         PIC 999.
   187         16  WS-COV-ENDS         PIC 999.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page   5
* NSRLTRBL.cbl
   188         16  WS-ACC-PER          PIC 999.
   189         16  WS-MAX-BENS         PIC 999.
   190         16  WS-REC-MOS          PIC 99.
   191         16  WS-MAX-EXTEN        PIC 99.
   192         16  WS-STATUS           PIC X.
   193         16  WS-PD-THRU-DT       PIC XX.
   194         16  WS-CLAIM-NO         PIC X(7).
   195         16  WS-MAX-MOBEN        PIC S9(7)V99 COMP-3.
   196         16  WS-TOTAL-PAID       PIC S9(7)V99 COMP-3.
   197         16  WS-REM-BENS         PIC 999.
   198         16  WS-SORTED-SW        PIC X.
   199 01  WS-SORTED-TABLE.
   200     12  WS-SRTD-TABLE OCCURS 25 TIMES.
   201         16  WS-SRTD-KEY.
   202             20  WS-SRTD-CLM-TYPE PIC X.
   203             20  WS-SRTD-INS-TYPE PIC X.
   204             20  WS-SRTD-BEN-PER PIC 99.
   205             20  WS-SRTD-INC-DT  PIC XX.
   206         16  WS-SRTD-EXCL-PER    PIC 999.
   207         16  WS-SRTD-COV-ENDS    PIC 999.
   208         16  WS-SRTD-ACC-PER     PIC 999.
   209         16  WS-SRTD-MAX-BENS    PIC 999.
   210         16  WS-SRTD-REC-MOS     PIC 99.
   211         16  WS-SRTD-MAX-EXTEN   PIC 99.
   212         16  WS-SRTD-STATUS      PIC X.
   213         16  WS-SRTD-PD-THRU-DT  PIC XX.
   214         16  WS-SRTD-CLAIM-NO    PIC X(7).
   215         16  WS-SRTD-MAX-MOBEN   PIC S9(7)V99 COMP-3.
   216         16  WS-SRTD-TOTAL-PAID  PIC S9(7)V99 COMP-3.
   217         16  WS-SRTD-REM-BENS    PIC 999.
   218         16  WS-SRTD-SW          PIC X.
   219 01  SAVE-ACCOUNT-MASTER         PIC X(2000) VALUE SPACES.
   220*                                COPY ELCDATE.
   221******************************************************************
   222*                                                                *
   223*                                                                *
   224*                            ELCDATE.                            *
   225*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   226*                            VMOD=2.003
   227*                                                                *
   228*                                                                *
   229*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   230*                 LENGTH = 200                                   *
   231******************************************************************
   232
   233 01  DATE-CONVERSION-DATA.
   234     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   235     12  DC-OPTION-CODE                PIC X.
   236         88  BIN-TO-GREG                VALUE ' '.
   237         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   238         88  EDIT-GREG-TO-BIN           VALUE '2'.
   239         88  YMD-GREG-TO-BIN            VALUE '3'.
   240         88  MDY-GREG-TO-BIN            VALUE '4'.
   241         88  JULIAN-TO-BIN              VALUE '5'.
   242         88  BIN-PLUS-ELAPSED           VALUE '6'.
   243         88  FIND-CENTURY               VALUE '7'.
   244         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   245         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page   6
* NSRLTRBL.cbl
   246         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   247         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   248         88  JULIAN-TO-BIN-3            VALUE 'C'.
   249         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   250         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   251         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   252         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   253         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   254         88  CHECK-LEAP-YEAR            VALUE 'H'.
   255         88  BIN-3-TO-GREG              VALUE 'I'.
   256         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   257         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   258         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   259         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   260         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   261         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   262         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   263         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   264         88  THREE-CHARACTER-BIN
   265                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   266         88  GREGORIAN-TO-BIN
   267                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   268         88  BIN-TO-GREGORIAN
   269                  VALUES ' ' '1' 'I' '8' 'G'.
   270         88  JULIAN-TO-BINARY
   271                  VALUES '5' 'C' 'E' 'F'.
   272     12  DC-ERROR-CODE                 PIC X.
   273         88  NO-CONVERSION-ERROR        VALUE ' '.
   274         88  DATE-CONVERSION-ERROR
   275                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   276         88  DATE-IS-ZERO               VALUE '1'.
   277         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   278         88  DATE-IS-INVALID            VALUE '3'.
   279         88  DATE1-GREATER-DATE2        VALUE '4'.
   280         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   281         88  DATE-INVALID-OPTION        VALUE '9'.
   282         88  INVALID-CENTURY            VALUE 'A'.
   283         88  ONLY-CENTURY               VALUE 'B'.
   284         88  ONLY-LEAP-YEAR             VALUE 'C'.
   285         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   286     12  DC-END-OF-MONTH               PIC X.
   287         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   288     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   289         88  USE-NORMAL-PROCESS         VALUE ' '.
   290         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   291         88  ADJUST-UP-100-YRS          VALUE '2'.
   292     12  FILLER                        PIC X.
   293     12  DC-CONVERSION-DATES.
   294         16  DC-BIN-DATE-1             PIC XX.
   295         16  DC-BIN-DATE-2             PIC XX.
   296         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   297         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   298                       DC-GREG-DATE-1-EDIT.
   299             20  DC-EDIT1-MONTH        PIC 99.
   300             20  SLASH1-1              PIC X.
   301             20  DC-EDIT1-DAY          PIC 99.
   302             20  SLASH1-2              PIC X.
   303             20  DC-EDIT1-YEAR         PIC 99.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page   7
* NSRLTRBL.cbl
   304         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   305         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   306                     DC-GREG-DATE-2-EDIT.
   307             20  DC-EDIT2-MONTH        PIC 99.
   308             20  SLASH2-1              PIC X.
   309             20  DC-EDIT2-DAY          PIC 99.
   310             20  SLASH2-2              PIC X.
   311             20  DC-EDIT2-YEAR         PIC 99.
   312         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   313         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   314                     DC-GREG-DATE-1-YMD.
   315             20  DC-YMD-YEAR           PIC 99.
   316             20  DC-YMD-MONTH          PIC 99.
   317             20  DC-YMD-DAY            PIC 99.
   318         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   319         16  DC-GREG-DATE-1-MDY-R REDEFINES
   320                      DC-GREG-DATE-1-MDY.
   321             20  DC-MDY-MONTH          PIC 99.
   322             20  DC-MDY-DAY            PIC 99.
   323             20  DC-MDY-YEAR           PIC 99.
   324         16  DC-GREG-DATE-1-ALPHA.
   325             20  DC-ALPHA-MONTH        PIC X(10).
   326             20  DC-ALPHA-DAY          PIC 99.
   327             20  FILLER                PIC XX.
   328             20  DC-ALPHA-CENTURY.
   329                 24 DC-ALPHA-CEN-N     PIC 99.
   330             20  DC-ALPHA-YEAR         PIC 99.
   331         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   332         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   333         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   334         16  DC-JULIAN-DATE            PIC 9(05).
   335         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   336                                       PIC 9(05).
   337         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   338             20  DC-JULIAN-YEAR        PIC 99.
   339             20  DC-JULIAN-DAYS        PIC 999.
   340         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   341         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   342         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   343     12  DATE-CONVERSION-VARIBLES.
   344         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   345         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   346             20  FILLER                PIC 9(3).
   347             20  HOLD-CEN-1-CCYY.
   348                 24  HOLD-CEN-1-CC     PIC 99.
   349                 24  HOLD-CEN-1-YY     PIC 99.
   350             20  HOLD-CEN-1-MO         PIC 99.
   351             20  HOLD-CEN-1-DA         PIC 99.
   352         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   353             20  HOLD-CEN-1-R-MO       PIC 99.
   354             20  HOLD-CEN-1-R-DA       PIC 99.
   355             20  HOLD-CEN-1-R-CCYY.
   356                 24  HOLD-CEN-1-R-CC   PIC 99.
   357                 24  HOLD-CEN-1-R-YY   PIC 99.
   358             20  FILLER                PIC 9(3).
   359         16  HOLD-CENTURY-1-X.
   360             20  FILLER                PIC X(3)  VALUE SPACES.
   361             20  HOLD-CEN-1-X-CCYY.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page   8
* NSRLTRBL.cbl
   362                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   363                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   364             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   365             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   366         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   367             20  HOLD-CEN-1-R-X-MO     PIC XX.
   368             20  HOLD-CEN-1-R-X-DA     PIC XX.
   369             20  HOLD-CEN-1-R-X-CCYY.
   370                 24  HOLD-CEN-1-R-X-CC PIC XX.
   371                 24  HOLD-CEN-1-R-X-YY PIC XX.
   372             20  FILLER                PIC XXX.
   373         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   374         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   375         16  DC-JULIAN-DATE-1          PIC 9(07).
   376         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   377             20  DC-JULIAN-1-CCYY.
   378                 24  DC-JULIAN-1-CC    PIC 99.
   379                 24  DC-JULIAN-1-YR    PIC 99.
   380             20  DC-JULIAN-DA-1        PIC 999.
   381         16  DC-JULIAN-DATE-2          PIC 9(07).
   382         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   383             20  DC-JULIAN-2-CCYY.
   384                 24  DC-JULIAN-2-CC    PIC 99.
   385                 24  DC-JULIAN-2-YR    PIC 99.
   386             20  DC-JULIAN-DA-2        PIC 999.
   387         16  DC-GREG-DATE-A-EDIT.
   388             20  DC-EDITA-MONTH        PIC 99.
   389             20  SLASHA-1              PIC X VALUE '/'.
   390             20  DC-EDITA-DAY          PIC 99.
   391             20  SLASHA-2              PIC X VALUE '/'.
   392             20  DC-EDITA-CCYY.
   393                 24  DC-EDITA-CENT     PIC 99.
   394                 24  DC-EDITA-YEAR     PIC 99.
   395         16  DC-GREG-DATE-B-EDIT.
   396             20  DC-EDITB-MONTH        PIC 99.
   397             20  SLASHB-1              PIC X VALUE '/'.
   398             20  DC-EDITB-DAY          PIC 99.
   399             20  SLASHB-2              PIC X VALUE '/'.
   400             20  DC-EDITB-CCYY.
   401                 24  DC-EDITB-CENT     PIC 99.
   402                 24  DC-EDITB-YEAR     PIC 99.
   403         16  DC-GREG-DATE-CYMD         PIC 9(08).
   404         16  DC-GREG-DATE-CYMD-R REDEFINES
   405                              DC-GREG-DATE-CYMD.
   406             20  DC-CYMD-CEN           PIC 99.
   407             20  DC-CYMD-YEAR          PIC 99.
   408             20  DC-CYMD-MONTH         PIC 99.
   409             20  DC-CYMD-DAY           PIC 99.
   410         16  DC-GREG-DATE-MDCY         PIC 9(08).
   411         16  DC-GREG-DATE-MDCY-R REDEFINES
   412                              DC-GREG-DATE-MDCY.
   413             20  DC-MDCY-MONTH         PIC 99.
   414             20  DC-MDCY-DAY           PIC 99.
   415             20  DC-MDCY-CEN           PIC 99.
   416             20  DC-MDCY-YEAR          PIC 99.
   417    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   418        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   419    12  DC-EL310-DATE                  PIC X(21).
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page   9
* NSRLTRBL.cbl
   420    12  FILLER                         PIC X(28).
   421*                                COPY ELCMSTR.
   422******************************************************************
   423*                                                                *
   424*                            ELCMSTR.                            *
   425*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   426*                            VMOD=2.012                          *
   427*                                                                *
   428*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
   429*                                                                *
   430*   FILE TYPE = VSAM,KSDS                                        *
   431*   RECORD SIZE = 350  RECFORM = FIXED                           *
   432*                                                                *
   433*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
   434*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
   435*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
   436*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
   437*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
   438*                                                 RKP=75,LEN=21  *
   439*                                                                *
   440*   **** NOTE ****                                               *
   441*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
   442*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
   443*                                                                *
   444*   LOG = YES                                                    *
   445*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   446******************************************************************
   447*                   C H A N G E   L O G
   448*
   449* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   450*-----------------------------------------------------------------
   451*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   452* EFFECTIVE    NUMBER
   453*-----------------------------------------------------------------
   454* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
   455* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
   456* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
   457* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
   458* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
   459* 081817    2016100700001  TANA  ADD NBR OF EXTENSIONS
   460* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
   461******************************************************************
   462 01  CLAIM-MASTER.
   463     12  CL-RECORD-ID                PIC XX.
   464         88  VALID-CL-ID         VALUE 'CL'.
   465
   466     12  CL-CONTROL-PRIMARY.
   467         16  CL-COMPANY-CD           PIC X.
   468         16  CL-CARRIER              PIC X.
   469         16  CL-CLAIM-NO             PIC X(7).
   470         16  CL-CERT-NO.
   471             20  CL-CERT-PRIME       PIC X(10).
   472             20  CL-CERT-SFX         PIC X.
   473
   474     12  CL-CONTROL-BY-NAME.
   475         16  CL-COMPANY-CD-A1        PIC X.
   476         16  CL-INSURED-LAST-NAME    PIC X(15).
   477         16  CL-INSURED-NAME.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  10
* NSRLTRBL.cbl
   478             20  CL-INSURED-1ST-NAME PIC X(12).
   479             20  CL-INSURED-MID-INIT PIC X.
   480
   481     12  CL-CONTROL-BY-SSN.
   482         16  CL-COMPANY-CD-A2        PIC X.
   483         16  CL-SOC-SEC-NO.
   484             20  CL-SSN-STATE        PIC XX.
   485             20  CL-SSN-ACCOUNT      PIC X(6).
   486             20  CL-SSN-LN3          PIC X(3).
   487
   488     12  CL-CONTROL-BY-CERT-NO.
   489         16  CL-COMPANY-CD-A4        PIC X.
   490         16  CL-CERT-NO-A4.
   491             20  CL-CERT-A4-PRIME    PIC X(10).
   492             20  CL-CERT-A4-SFX      PIC X.
   493
   494     12  CL-CONTROL-BY-CCN.
   495         16  CL-COMPANY-CD-A5        PIC X.
   496         16  CL-CCN-A5.
   497             20  CL-CCN.
   498                 24  CL-CCN-PREFIX-A5 PIC X(4).
   499                 24  CL-CCN-PRIME-A5 PIC X(12).
   500             20  CL-CCN-FILLER-A5    PIC X(4).
   501
   502     12  CL-INSURED-PROFILE-DATA.
   503         16  CL-INSURED-BIRTH-DT     PIC XX.
   504         16  CL-INSURED-SEX-CD       PIC X.
   505             88  INSURED-IS-MALE        VALUE 'M'.
   506             88  INSURED-IS-FEMALE      VALUE 'F'.
   507             88  INSURED-SEX-UNKNOWN    VALUE ' '.
   508         16  CL-INSURED-OCC-CD       PIC X(6).
   509         16  FILLER                  PIC X(5).
   510
   511     12  CL-PROCESSING-INFO.
   512         16  CL-PROCESSOR-ID         PIC X(4).
   513         16  CL-CLAIM-STATUS         PIC X.
   514             88  CLAIM-IS-OPEN          VALUE 'O'.
   515             88  CLAIM-IS-CLOSED        VALUE 'C'.
   516         16  CL-CLAIM-TYPE           PIC X.
   517*            88  AH-CLAIM               VALUE 'A'.
   518*            88  LIFE-CLAIM             VALUE 'L'.
   519*            88  PROPERTY-CLAIM         VALUE 'P'.
   520*            88  IUI-CLAIM              VALUE 'I'.
   521*            88  GAP-CLAIM              VALUE 'G'.
   522*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
   523*            88  OTHER-CLAIM            VALUE 'O'.
   524         16  CL-CLAIM-PREM-TYPE      PIC X.
   525             88  SINGLE-PREMIUM         VALUE '1'.
   526             88  O-B-COVERAGE           VALUE '2'.
   527             88  OPEN-END-COVERAGE      VALUE '3'.
   528         16  CL-INCURRED-DT          PIC XX.
   529         16  CL-REPORTED-DT          PIC XX.
   530         16  CL-FILE-ESTABLISH-DT    PIC XX.
   531         16  CL-EST-END-OF-DISAB-DT  PIC XX.
   532         16  CL-LAST-PMT-DT          PIC XX.
   533         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
   534         16  CL-PAID-THRU-DT         PIC XX.
   535         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  11
* NSRLTRBL.cbl
   536         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
   537         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
   538         16  CL-PMT-CALC-METHOD      PIC X.
   539             88  CL-360-DAY-YR          VALUE '1'.
   540             88  CL-365-DAY-YR          VALUE '2'.
   541             88  CL-FULL-MONTHS         VALUE '3'.
   542         16  CL-CAUSE-CD             PIC X(6).
   543
   544         16  CL-PRIME-CERT-NO.
   545             20  CL-PRIME-CERT-PRIME PIC X(10).
   546             20  CL-PRIME-CERT-SFX   PIC X.
   547
   548         16  CL-SYSTEM-IDENTIFIER    PIC XX.
   549             88  CL-CREDIT-CLAIM        VALUE 'CR'.
   550             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
   551
   552         16  CL-MICROFILM-NO         PIC X(10).
   553         16  FILLER REDEFINES CL-MICROFILM-NO.
   554             20  CL-BENEFIT-PERIOD   PIC 99.
   555             20  FILLER              PIC X(8).
   556         16  CL-PROG-FORM-TYPE       PIC X.
   557         16  CL-LAST-ADD-ON-DT       PIC XX.
   558
   559         16  CL-LAST-REOPEN-DT       PIC XX.
   560         16  CL-LAST-CLOSE-DT        PIC XX.
   561         16  CL-LAST-CLOSE-REASON    PIC X(01).
   562             88  FINAL-PAID             VALUE '1'.
   563             88  CLAIM-DENIED           VALUE '2'.
   564             88  AUTO-CLOSE             VALUE '3'.
   565             88  MANUAL-CLOSE           VALUE '4'.
   566             88  BENEFITS-CHANGED       VALUE 'C'.
   567             88  SETUP-ERRORS           VALUE 'E'.
   568         16  CL-ASSOC-CERT-SEQU      PIC S99.
   569         16  CL-ASSOC-CERT-TOTAL     PIC S99.
   570         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
   571             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
   572         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
   573         16  FILLER                  PIC X.
   574
   575     12  CL-CERTIFICATE-DATA.
   576         16  CL-CERT-ORIGIN          PIC X.
   577             88  CERT-WAS-ONLINE        VALUE '1'.
   578             88  CERT-WAS-CREATED       VALUE '2'.
   579             88  COVERAGE-WAS-ADDED     VALUE '3'.
   580         16  CL-CERT-KEY-DATA.
   581             20  CL-CERT-CARRIER     PIC X.
   582             20  CL-CERT-GROUPING    PIC X(6).
   583             20  CL-CERT-STATE       PIC XX.
   584             20  CL-CERT-ACCOUNT.
   585                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
   586                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
   587             20  CL-CERT-EFF-DT      PIC XX.
   588
   589     12  CL-STATUS-CONTROLS.
   590         16  CL-PRIORITY-CD          PIC X.
   591             88  CONFIDENTIAL-DATA      VALUE '8'.
   592             88  HIGHEST-PRIORITY       VALUE '9'.
   593         16  CL-SUPV-ATTN-CD         PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  12
* NSRLTRBL.cbl
   594             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
   595             88  SUPV-IS-REQUIRED       VALUE 'Y'.
   596         16  CL-PURGED-DT            PIC XX.
   597         16  CL-RESTORED-DT          PIC XX.
   598         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
   599         16  CL-NEXT-RESEND-DT       PIC XX.
   600         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
   601         16  CL-CRITICAL-PERIOD      PIC 99.
   602*        16  FILLER                  PIC XX.
   603         16  CL-LAST-MAINT-DT        PIC XX.
   604         16  CL-LAST-MAINT-USER      PIC X(4).
   605         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
   606         16  CL-LAST-MAINT-TYPE      PIC X.
   607             88  CLAIM-SET-UP           VALUE ' '.
   608             88  PAYMENT-MADE           VALUE '1'.
   609             88  LETTER-SENT            VALUE '2'.
   610             88  MASTER-WAS-ALTERED     VALUE '3'.
   611             88  MASTER-WAS-RESTORED    VALUE '4'.
   612             88  INCURRED-DATE-CHANGED  VALUE '5'.
   613             88  FILE-CONVERTED         VALUE '6'.
   614             88  CHANGE-OF-BENEFITS     VALUE 'C'.
   615             88  ERROR-CORRECTION       VALUE 'E'.
   616         16  CL-RELATED-CLAIM-NO     PIC X(7).
   617         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
   618         16  CL-BENEFICIARY          PIC X(10).
   619         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
   620         16  CL-DENIAL-TYPE          PIC X.
   621             88  CL-TYPE-DENIAL          VALUE '1'.
   622             88  CL-TYPE-RESCISSION      VALUE '2'.
   623             88  CL-TYPE-REFORMATION     VALUE '3'.
   624             88  CL-TYPE-REF-TO-RES      VALUE '4'.
   625             88  CL-TYPE-RECONSIDERED    VALUE '5'.
   626         16  CL-NO-OF-EXTENSIONS     PIC 99.
   627         16  filler                  pic x(3).
   628*        16  CL-CRIT-PER-RECURRENT   PIC X.
   629*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
   630*        16  CL-RTW-DT               PIC XX.
   631
   632     12  CL-TRAILER-CONTROLS.
   633         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
   634             88  CL-1ST-TRL-AVAIL       VALUE +4095.
   635             88  CL-LAST-TRL-AVAIL      VALUE +100.
   636             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
   637         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
   638         16  FILLER                  PIC XX.
   639         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
   640         16  CL-ADDRESS-TRAILER-CNT.
   641             20  CL-INSURED-ADDR-CNT  PIC S9(1).
   642                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
   643             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
   644                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
   645             20  CL-BENIF-ADDR-CNT    PIC S9(1).
   646                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
   647             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
   648                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
   649             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
   650                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
   651             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  13
* NSRLTRBL.cbl
   652                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
   653             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
   654                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
   655
   656     12  CL-CV-REFERENCE-NO.
   657         16  CL-CV-REFNO-PRIME       PIC X(18).
   658         16  CL-CV-REFNO-SFX         PIC XX.
   659
   660     12  CL-FILE-LOCATION            PIC X(4).
   661
   662     12  CL-PROCESS-ERRORS.
   663         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
   664             88  NO-FATAL-ERRORS        VALUE ZERO.
   665         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
   666             88  NO-FORCABLE-ERRORS     VALUE ZERO.
   667
   668     12  CL-PRODUCT-CD               PIC X.
   669
   670     12  CL-CURRENT-KEY-DATA.
   671         16  CL-CURRENT-CARRIER      PIC X.
   672         16  CL-CURRENT-GROUPING     PIC X(6).
   673         16  CL-CURRENT-STATE        PIC XX.
   674         16  CL-CURRENT-ACCOUNT      PIC X(10).
   675
   676     12  CL-ASSOCIATES               PIC X.
   677         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
   678         88  CL-ASSOC-INTERFACE         VALUE 'I'.
   679         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
   680         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
   681
   682     12  CL-ACTIVITY-CODE            PIC 99.
   683     12  CL-ACTIVITY-MAINT-DT        PIC XX.
   684     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
   685
   686     12  CL-LAPSE-REPORT-CODE        PIC 9.
   687     12  CL-LAG-REPORT-CODE          PIC 9.
   688     12  CL-LOAN-TYPE                PIC XX.
   689     12  CL-LEGAL-STATE              PIC XX.
   690
   691     12  CL-YESNOSW                  PIC X.
   692     12  CL-ACCIDENT-CLAIM-SW        PIC X.
   693         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
   694         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
   695         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
   696     12  cl-insured-type             pic x.
   697         88  cl-claim-on-primary         value 'P'.
   698         88  cl-claim-on-co-borrower     value 'C'.
   699     12  cl-benefit-expiration-dt    PIC XX.
   700*                                COPY ELCTRLR.
   701******************************************************************
   702*                                                                *
   703*                            ELCTRLR.                            *
   704*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   705*                            VMOD=2.014                          *
   706*                                                                *
   707*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
   708*                                                                *
   709*   FILE TYPE = VSAM,KSDS                                        *
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  14
* NSRLTRBL.cbl
   710*   RECORD SIZE = 200    RECFORM = FIXED                         *
   711*                                                                *
   712*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
   713*       ALTERNATE INDEX = NONE                                   *
   714*                                                                *
   715*   LOG = YES                                                    *
   716*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   717******************************************************************
   718*                   C H A N G E   L O G
   719*
   720* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   721*-----------------------------------------------------------------
   722*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   723* EFFECTIVE    NUMBER
   724*-----------------------------------------------------------------
   725* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
   726* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
   727* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
   728* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
   729* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
   730* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
   731* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
   732* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
   733* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
   734* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
   735* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
   736* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
   737* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAIL
   738* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
   739* 021213    2012092400007  AJRA  CAUSAL STATE SEQUENCE NO
   740* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
   741* 102413  CR2013100800001  AJRA  ADD SPECIAL RELEASE IND
   742* 022614    2013050100003  AJRA  ADD CERT CANCELLED NOTE TYPE - T
   743* 040814    2014030500002  AJRA  ADD ICD CODES
   744* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
   745* 013017  CR2016053100001  PEMA  ACH PROCESSING
   746* 062217  CR2017050300002  TANA  ADD AUTH RCVD
   747* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
   748* 102418  CR2018083000001  TANA  ADD ADD NEW CALL TYPE
   749******************************************************************
   750 01  ACTIVITY-TRAILERS.
   751     12  AT-RECORD-ID                    PIC XX.
   752         88  VALID-AT-ID                       VALUE 'AT'.
   753
   754     12  AT-CONTROL-PRIMARY.
   755         16  AT-COMPANY-CD               PIC X.
   756         16  AT-CARRIER                  PIC X.
   757         16  AT-CLAIM-NO                 PIC X(7).
   758         16  AT-CERT-NO.
   759             20  AT-CERT-PRIME           PIC X(10).
   760             20  AT-CERT-SFX             PIC X.
   761         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
   762             88  AT-1ST-TRL-AVAIL             VALUE +4095.
   763             88  AT-LAST-TRL-AVAIL            VALUE +100.
   764             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
   765             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
   766             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
   767             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  15
* NSRLTRBL.cbl
   768             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
   769             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
   770             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
   771             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
   772             88  AT-DIAGNOSIS-TRL             VALUE +90.
   773             88  AT-BENEFICIARY-TRL           VALUE +91.
   774             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
   775             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
   776             88  AT-VFY-CAUSAL-STATE          VALUE +94.
   777             88  AT-ERROR-MSGS-TRL            VALUE +95.
   778
   779     12  AT-TRAILER-TYPE                 PIC X.
   780         88  RESERVE-EXPENSE-TR               VALUE '1'.
   781         88  PAYMENT-TR                       VALUE '2'.
   782         88  AUTO-PAY-TR                      VALUE '3'.
   783         88  CORRESPONDENCE-TR                VALUE '4'.
   784         88  ADDRESS-TR                       VALUE '5'.
   785         88  GENERAL-INFO-TR                  VALUE '6'.
   786         88  AUTO-PROMPT-TR                   VALUE '7'.
   787         88  DENIAL-TR                        VALUE '8'.
   788         88  INCURRED-CHG-TR                  VALUE '9'.
   789         88  FORM-CONTROL-TR                  VALUE 'A'.
   790
   791     12  AT-RECORDED-DT                  PIC XX.
   792     12  AT-RECORDED-BY                  PIC X(4).
   793     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
   794
   795     12  AT-TRAILER-BODY                 PIC X(165).
   796
   797     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
   798         16  AT-RESERVE-CONTROLS.
   799             20  AT-MANUAL-SW            PIC X.
   800                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
   801             20  AT-FUTURE-SW            PIC X.
   802                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
   803             20  AT-PTC-SW               PIC X.
   804                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
   805             20  AT-IBNR-SW              PIC X.
   806                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
   807             20  AT-PTC-LF-SW            PIC X.
   808                 88  AT-LF-PTC-USED          VALUE '1'.
   809             20  AT-CDT-ACCESS-METHOD    PIC X.
   810                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
   811                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
   812                 88  AT-CDT-INTERPOLATED     VALUE '3'.
   813             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
   814         16  AT-LAST-COMPUTED-DT         PIC XX.
   815         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
   816         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
   817         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
   818         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
   819         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
   820         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
   821         16  AT-EXPENSE-CONTROLS.
   822             20  AT-EXPENSE-METHOD       PIC X.
   823                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
   824                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
   825                 88  PERCENT-OF-PMT           VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  16
* NSRLTRBL.cbl
   826                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
   827             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
   828             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
   829         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
   830         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
   831
   832         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
   833         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
   834
   835*        16  FILLER                      PIC X(53).
   836         16  FILLER                      PIC X(47).
   837
   838         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
   839         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
   840
   841         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
   842             20  AT-OPEN-CLOSE-DATE      PIC XX.
   843             20  AT-OPEN-CLOSE-TYPE      PIC X.
   844*                    C = CLOSED
   845*                    O = OPEN
   846             20  AT-OPEN-CLOSE-REASON    PIC X(5).
   847*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
   848
   849     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
   850         16  AT-PAYMENT-TYPE             PIC X.
   851             88  PARTIAL-PAYMENT                VALUE '1'.
   852             88  FINAL-PAYMENT                  VALUE '2'.
   853             88  LUMP-SUM-PAYMENT               VALUE '3'.
   854             88  ADDITIONAL-PAYMENT             VALUE '4'.
   855             88  CHARGEABLE-EXPENSE             VALUE '5'.
   856             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
   857             88  VOIDED-PAYMENT                 VALUE '9'.
   858             88  TRANSFER                       VALUE 'T'.
   859             88  LIFE-INTEREST                  VALUE 'I'.
   860
   861         16  AT-CLAIM-TYPE               PIC X.
   862             88  PAID-FOR-AH                    VALUE 'A'.
   863             88  PAID-FOR-LIFE                  VALUE 'L'.
   864             88  PAID-FOR-IUI                   VALUE 'I'.
   865             88  PAID-FOR-GAP                   VALUE 'G'.
   866             88  PAID-FOR-FAM                   VALUE 'F'.
   867             88  PAID-FOR-OTH                   VALUE 'O'.
   868         16  AT-CLAIM-PREM-TYPE          PIC X.
   869             88  AT-SINGLE-PREMIUM              VALUE '1'.
   870             88  AT-O-B-COVERAGE                VALUE '2'.
   871             88  AT-OPEN-END-COVERAGE           VALUE '3'.
   872         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
   873         16  AT-CHECK-NO                 PIC X(7).
   874         16  AT-PAID-FROM-DT             PIC XX.
   875         16  AT-PAID-THRU-DT             PIC XX.
   876         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
   877         16  AT-ACH-PAYMENT              PIC X.
   878*        16  FILLER                      PIC X.
   879         16  AT-PAYEES-NAME              PIC X(30).
   880         16  AT-PAYMENT-ORIGIN           PIC X.
   881             88  ONLINE-MANUAL-PMT              VALUE '1'.
   882             88  ONLINE-AUTO-PMT                VALUE '2'.
   883             88  OFFLINE-PMT                    VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  17
* NSRLTRBL.cbl
   884         16  AT-CHECK-WRITTEN-DT         PIC XX.
   885         16  AT-TO-BE-WRITTEN-DT         PIC XX.
   886         16  AT-VOID-DATA.
   887             20  AT-VOID-DT              PIC XX.
   888*00144       20  AT-VOID-REASON          PIC X(30).
   889             20  AT-VOID-REASON          PIC X(26).
   890         16  AT-PMT-APPROVED-BY          PIC X(04).
   891         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
   892         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
   893         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
   894                                         PIC S99V9(5)  COMP-3.
   895         16  AT-CREDIT-INTERFACE.
   896             20  AT-PMT-SELECT-DT        PIC XX.
   897                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
   898             20  AT-PMT-ACCEPT-DT        PIC XX.
   899                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
   900             20  AT-VOID-SELECT-DT       PIC XX.
   901                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
   902             20  AT-VOID-ACCEPT-DT       PIC XX.
   903                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
   904
   905         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
   906                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
   907                 88  CONVERSION-PAYMENT           VALUE +99999999.
   908         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
   909
   910         16  AT-FORCE-CONTROL            PIC X.
   911             88  PAYMENT-WAS-FORCED           VALUE '1'.
   912         16  AT-PREV-LAST-PMT-DT         PIC XX.
   913         16  AT-PREV-PAID-THRU-DT        PIC XX.
   914         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
   915         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
   916         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
   917         16  AT-BENEFIT-TYPE             PIC X.
   918
   919         16  AT-EXPENSE-TYPE             PIC X.
   920         16  AT-PAYMENT-APPROVAL-SW      PIC X.
   921
   922         16  AT-PAYEE-TYPE-CD.
   923             20  AT-PAYEE-TYPE           PIC X.
   924                 88  INSURED-PAID           VALUE 'I'.
   925                 88  BENEFICIARY-PAID       VALUE 'B'.
   926                 88  ACCOUNT-PAID           VALUE 'A'.
   927                 88  OTHER-1-PAID           VALUE 'O'.
   928                 88  OTHER-2-PAID           VALUE 'Q'.
   929                 88  DOCTOR-PAID            VALUE 'P'.
   930                 88  EMPLOYER-PAID          VALUE 'E'.
   931             20  AT-PAYEE-SEQ            PIC X.
   932
   933         16  AT-CASH-PAYMENT             PIC X.
   934         16  AT-GROUPED-PAYMENT          PIC X.
   935         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
   936         16  AT-APPROVAL-LEVEL-REQD      PIC X.
   937         16  AT-APPROVED-LEVEL           PIC X.
   938         16  AT-VOID-TYPE                PIC X.
   939             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
   940             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
   941         16  AT-AIG-UNEMP-IND            PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  18
* NSRLTRBL.cbl
   942             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
   943         16  AT-ASSOCIATES               PIC X.
   944             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
   945             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
   946
   947         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
   948         16  AT-CV-PMT-CODE              PIC X.
   949             88  FULL-DEATH-PAYMENT         VALUE '1'.
   950             88  HALF-DEATH-PAYMENT         VALUE '2'.
   951             88  FULL-ADD-PAYMENT           VALUE '3'.
   952             88  HALF-ADD-PAYMENT           VALUE '4'.
   953             88  FULL-RIDER-PAYMENT         VALUE '5'.
   954             88  HALF-RIDER-PAYMENT         VALUE '6'.
   955             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
   956             88  ADDL-PAYMENT               VALUE '8'.
   957
   958         16  AT-EOB-CODE1                PIC XXX.
   959         16  AT-EOB-CODE2                PIC XXX.
   960         16  AT-EOB-CODE3                PIC XXX.
   961         16  FILLER REDEFINES AT-EOB-CODE3.
   962             20  AT-PRINT-CLM-FORM       PIC X.
   963             20  AT-PRINT-SURVEY         PIC X.
   964             20  AT-SPECIAL-RELEASE      PIC X.
   965         16  AT-EOB-CODE4                PIC XXX.
   966         16  FILLER REDEFINES AT-EOB-CODE4.
   967             20  AT-INT-PMT-SELECT-DT    PIC XX.
   968             20  FILLER                  PIC X.
   969         16  AT-EOB-CODE5                PIC XXX.
   970         16  FILLER REDEFINES AT-EOB-CODE5.
   971             20  AT-PMT-PROOF-DT         PIC XX.
   972             20  FILLER                  PIC X.
   973
   974         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
   975             88  AT-PRINT-EOB            VALUE 'Y'.
   976
   977         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
   978         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
   979
   980     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
   981         16  AT-SCHEDULE-START-DT        PIC XX.
   982         16  AT-SCHEDULE-END-DT          PIC XX.
   983         16  AT-TERMINATED-DT            PIC XX.
   984         16  AT-LAST-PMT-TYPE            PIC X.
   985             88  LAST-PMT-IS-FINAL              VALUE 'F'.
   986             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
   987         16  AT-FIRST-PMT-DATA.
   988             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
   989             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
   990             20  AT-1ST-PAY-THRU-DT      PIC XX.
   991         16  AT-REGULAR-PMT-DATA.
   992             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
   993             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
   994             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
   995         16  AT-AUTO-PAYEE-CD.
   996             20  AT-AUTO-PAYEE-TYPE      PIC X.
   997                 88  INSURED-PAID-AUTO      VALUE 'I'.
   998                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
   999                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  19
* NSRLTRBL.cbl
  1000                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
  1001                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  1002             20  AT-AUTO-PAYEE-SEQ       PIC X.
  1003         16  AT-AUTO-PAY-DAY             PIC 99.
  1004         16  AT-AUTO-CASH                PIC X.
  1005             88  AT-CASH                      VALUE 'Y'.
  1006             88  AT-NON-CASH                  VALUE 'N'.
  1007*        16  FILLER                      PIC X(129).
  1008         16  AT-AUTO-END-LETTER          PIC X(4).
  1009         16  FILLER                      PIC X(125).
  1010
  1011         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
  1012         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  1013
  1014     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  1015         16  AT-LETTER-SENT-DT           PIC XX.
  1016         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  1017         16  AT-AUTO-RE-SEND-DT          PIC XX.
  1018         16  AT-LETTER-ANSWERED-DT       PIC XX.
  1019         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  1020         16  AT-LETTER-ORIGIN            PIC X.
  1021             88  ONLINE-CREATION              VALUE '1' '3'.
  1022             88  OFFLINE-CREATION             VALUE '2' '4'.
  1023             88  NAPER-ONLINE-CREATION        VALUE '3'.
  1024             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  1025         16  AT-STD-LETTER-FORM          PIC X(4).
  1026         16  AT-REASON-TEXT              PIC X(70).
  1027         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  1028         16  AT-ADDRESEE-TYPE            PIC X.
  1029              88  INSURED-ADDRESEE            VALUE 'I'.
  1030              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  1031              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  1032              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  1033              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  1034              88  OTHER-ADDRESEE-1            VALUE 'O'.
  1035              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  1036         16  AT-ADDRESSEE-NAME           PIC X(30).
  1037         16  AT-INITIAL-PRINT-DATE       PIC XX.
  1038         16  AT-RESEND-PRINT-DATE        PIC XX.
  1039         16  AT-CORR-SOL-UNSOL           PIC X.
  1040         16  AT-LETTER-PURGED-DT         PIC XX.
  1041*
  1042*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  1043*
  1044         16  AT-CSO-REDEFINITION.
  1045             20  AT-RESEND-LETTER-FORM   PIC X(4).
  1046             20  AT-AUTO-CLOSE-IND       PIC X(1).
  1047             20  AT-LETTER-TO-BENE       PIC X(1).
  1048             20  AT-STOP-LETTER-DT       PIC X(2).
  1049             20  AT-AUTH-RCVD            PIC X(1).
  1050             20  FILLER                  PIC X(18).
  1051*             20  FILLER                  PIC X(27).
  1052             20  AT-CSO-LETTER-STATUS    PIC X.
  1053                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  1054                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
  1055                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  1056             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
  1057             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  20
* NSRLTRBL.cbl
  1058*
  1059*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  1060*
  1061*        16  FILLER                      PIC X(26).
  1062*
  1063*        16  AT-DMD-BSR-CODE             PIC X.
  1064*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  1065*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  1066*
  1067*        16  AT-DMD-LETTER-STATUS        PIC X.
  1068*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
  1069*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  1070*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
  1071*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  1072*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  1073
  1074         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  1075         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  1076
  1077     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  1078         16  AT-ADDRESS-TYPE             PIC X.
  1079             88  INSURED-ADDRESS               VALUE 'I'.
  1080             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  1081             88  ACCOUNT-ADDRESS               VALUE 'A'.
  1082             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  1083             88  EMPLOYER-ADDRESS              VALUE 'E'.
  1084             88  OTHER-ADDRESS-1               VALUE 'O'.
  1085             88  OTHER-ADDRESS-2               VALUE 'Q'.
  1086         16  AT-MAIL-TO-NAME             PIC X(30).
  1087         16  AT-ADDRESS-LINE-1           PIC X(30).
  1088         16  AT-ADDRESS-LINE-2           PIC X(30).
  1089         16  AT-CITY-STATE.
  1090             20  AT-CITY                 PIC X(28).
  1091             20  AT-STATE                PIC XX.
  1092         16  AT-ZIP.
  1093             20  AT-ZIP-CODE.
  1094                 24  AT-ZIP-1ST          PIC X.
  1095                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  1096                 24  FILLER              PIC X(4).
  1097             20  AT-ZIP-PLUS4            PIC X(4).
  1098         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  1099             20  AT-CAN-POSTAL-1         PIC XXX.
  1100             20  AT-CAN-POSTAL-2         PIC XXX.
  1101             20  FILLER                  PIC XXX.
  1102         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  1103*         16  FILLER                      PIC X(23).
  1104         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
  1105         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
  1106         16  FILLER                      PIC X(13).
  1107         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  1108         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
  1109
  1110     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  1111         16  AT-INFO-LINE-1              PIC X(60).
  1112         16  FILLER REDEFINES AT-INFO-LINE-1.
  1113             20  AT-NOTE-ERROR-NO OCCURS 15
  1114                                         PIC X(4).
  1115         16  AT-INFO-LINE-2              PIC X(60).
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  21
* NSRLTRBL.cbl
  1116         16  FILLER REDEFINES AT-INFO-LINE-2.
  1117             20  AT-ICD-CODE-1           PIC X(8).
  1118             20  AT-ICD-CODE-2           PIC X(8).
  1119             20  FILLER                  PIC X(44).
  1120         16  AT-INFO-TRAILER-TYPE        PIC X.
  1121             88  AT-ERRORS-NOTE          VALUE 'E'.
  1122             88  AT-PAYMENT-NOTE         VALUE 'P'.
  1123             88  AT-CALL-NOTE            VALUE 'C'.
  1124             88  AT-MAINT-NOTE           VALUE 'M'.
  1125             88  AT-CERT-CHANGE          VALUE 'X'.
  1126             88  AT-APPROVAL-NOTE        VALUE 'R'.
  1127             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  1128             88  AT-CERT-CANCELLED       VALUE 'T'.
  1129         16  AT-CALL-TYPE                PIC X.
  1130             88  AT-PHONE-CALL-IN        VALUE 'I'.
  1131             88  AT-PHONE-CALL-NEW       VALUE 'N'.
  1132             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  1133         16  AT-NOTE-CONTINUATION        PIC X.
  1134             88  AT-CONTINUED-NOTE       VALUE 'X'.
  1135         16  AT-EOB-CODES-EXIST          PIC X.
  1136             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
  1137         16  FILLER                      PIC X(35).
  1138         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  1139         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  1140
  1141     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
  1142         16  AT-PROMPT-LINE-1            PIC X(60).
  1143         16  AT-PROMPT-LINE-2            PIC X(60).
  1144         16  AT-PROMPT-START-DT          PIC XX.
  1145         16  AT-PROMPT-END-DT            PIC XX.
  1146         16  FILLER                      PIC X(35).
  1147         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  1148         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  1149
  1150     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  1151         16  AT-DENIAL-INFO-1            PIC X(60).
  1152         16  AT-DENIAL-INFO-2            PIC X(60).
  1153         16  AT-DENIAL-DT                PIC XX.
  1154         16  AT-RETRACTION-DT            PIC XX.
  1155         16  AT-DENIAL-REASON-CODE       PIC X(4).
  1156*         16  FILLER                      PIC X(31).
  1157         16  AT-DENIAL-PROOF-DT          PIC XX.
  1158         16  FILLER                      PIC X(29).
  1159         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  1160         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  1161
  1162     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  1163         16  AT-OLD-INCURRED-DT          PIC XX.
  1164         16  AT-OLD-REPORTED-DT          PIC XX.
  1165         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  1166         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  1167         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
  1168         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  1169         16  AT-OLD-PAID-THRU-DT         PIC XX.
  1170         16  AT-LAST-PMT-MADE-DT         PIC XX.
  1171         16  FILLER                      PIC X(26).
  1172         16  AT-OLD-DIAG-CODE            PIC X(6).
  1173         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  22
* NSRLTRBL.cbl
  1174         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  1175         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  1176         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  1177         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  1178         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  1179         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  1180         16  AT-OLD-ICD-CODE-1           PIC X(8).
  1181         16  AT-OLD-ICD-CODE-2           PIC X(8).
  1182         16  FILLER                      PIC X(9).
  1183         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  1184
  1185     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  1186         16  AT-FORM-SEND-ON-DT          PIC XX.
  1187         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  1188         16  AT-FORM-RE-SEND-DT          PIC XX.
  1189         16  AT-FORM-ANSWERED-DT         PIC XX.
  1190         16  AT-FORM-PRINTED-DT          PIC XX.
  1191         16  AT-FORM-REPRINT-DT          PIC XX.
  1192         16  AT-FORM-TYPE                PIC X.
  1193             88  INITIAL-FORM                  VALUE '1'.
  1194             88  PROGRESS-FORM                 VALUE '2'.
  1195         16  AT-INSTRUCT-LN-1            PIC X(28).
  1196         16  AT-INSTRUCT-LN-2            PIC X(28).
  1197         16  AT-INSTRUCT-LN-3            PIC X(28).
  1198         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  1199         16  AT-FORM-ADDRESS             PIC X.
  1200             88  FORM-TO-INSURED              VALUE 'I'.
  1201             88  FORM-TO-ACCOUNT              VALUE 'A'.
  1202             88  FORM-TO-OTHER-1              VALUE 'O'.
  1203             88  FORM-TO-OTHER-2              VALUE 'Q'.
  1204         16  AT-RELATED-1.
  1205             20 AT-REL-CARR-1            PIC X.
  1206             20 AT-REL-CLAIM-1           PIC X(7).
  1207             20 AT-REL-CERT-1            PIC X(11).
  1208         16  AT-RELATED-2.
  1209             20 AT-REL-CARR-2            PIC X.
  1210             20 AT-REL-CLAIM-2           PIC X(7).
  1211             20 AT-REL-CERT-2            PIC X(11).
  1212         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  1213         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  1214         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  1215         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  1216         16  AT-FORM-REM-PRINT-DT        PIC XX.
  1217         16  AT-STOP-FORM-DT             PIC X(2).
  1218
  1219         16  FILLER                      PIC X(09).
  1220         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  1221         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
  1222******************************************************************
  1223*                                COPY ELCCERT.
  1224******************************************************************
  1225*                                                                *
  1226*                            ELCCERT.                            *
  1227*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1228*                            VMOD=2.013                          *
  1229*                                                                *
  1230*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  1231*                                                                *
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  23
* NSRLTRBL.cbl
  1232*   FILE TYPE = VSAM,KSDS                                        *
  1233*   RECORD SIZE = 450  RECFORM = FIXED                           *
  1234*                                                                *
  1235*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  1236*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  1237*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  1238*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  1239*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  1240*                                                                *
  1241*   LOG = YES                                                    *
  1242*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1243******************************************************************
  1244*                   C H A N G E   L O G
  1245*
  1246* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1247*-----------------------------------------------------------------
  1248*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1249* EFFECTIVE    NUMBER
  1250*-----------------------------------------------------------------
  1251* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  1252* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  1253* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  1254* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  1255* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  1256* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  1257* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1258* 032612  CR2011110200001  PEMA  AHL CHANGES
  1259* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  1260* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  1261* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
  1262******************************************************************
  1263
  1264 01  CERTIFICATE-MASTER.
  1265     12  CM-RECORD-ID                      PIC XX.
  1266         88  VALID-CM-ID                      VALUE 'CM'.
  1267
  1268     12  CM-CONTROL-PRIMARY.
  1269         16  CM-COMPANY-CD                 PIC X.
  1270         16  CM-CARRIER                    PIC X.
  1271         16  CM-GROUPING.
  1272             20  CM-GROUPING-PREFIX        PIC X(3).
  1273             20  CM-GROUPING-PRIME         PIC X(3).
  1274         16  CM-STATE                      PIC XX.
  1275         16  CM-ACCOUNT.
  1276             20  CM-ACCOUNT-PREFIX         PIC X(4).
  1277             20  CM-ACCOUNT-PRIME          PIC X(6).
  1278         16  CM-CERT-EFF-DT                PIC XX.
  1279         16  CM-CERT-NO.
  1280             20  CM-CERT-PRIME             PIC X(10).
  1281             20  CM-CERT-SFX               PIC X.
  1282
  1283     12  CM-CONTROL-BY-NAME.
  1284         16  CM-COMPANY-CD-A1              PIC X.
  1285         16  CM-INSURED-LAST-NAME          PIC X(15).
  1286         16  CM-INSURED-INITIALS.
  1287             20  CM-INSURED-INITIAL1       PIC X.
  1288             20  CM-INSURED-INITIAL2       PIC X.
  1289
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  24
* NSRLTRBL.cbl
  1290     12  CM-CONTROL-BY-SSN.
  1291         16  CM-COMPANY-CD-A2              PIC X.
  1292         16  CM-SOC-SEC-NO.
  1293             20  CM-SSN-STATE              PIC XX.
  1294             20  CM-SSN-ACCOUNT            PIC X(6).
  1295             20  CM-SSN-LN3.
  1296                 25  CM-INSURED-INITIALS-A2.
  1297                     30 CM-INSURED-INITIAL1-A2   PIC X.
  1298                     30 CM-INSURED-INITIAL2-A2   PIC X.
  1299                 25 CM-PART-LAST-NAME-A2         PIC X.
  1300
  1301     12  CM-CONTROL-BY-CERT-NO.
  1302         16  CM-COMPANY-CD-A4              PIC X.
  1303         16  CM-CERT-NO-A4                 PIC X(11).
  1304
  1305     12  CM-CONTROL-BY-MEMB.
  1306         16  CM-COMPANY-CD-A5              PIC X.
  1307         16  CM-MEMBER-NO.
  1308             20  CM-MEMB-STATE             PIC XX.
  1309             20  CM-MEMB-ACCOUNT           PIC X(6).
  1310             20  CM-MEMB-LN4.
  1311                 25  CM-INSURED-INITIALS-A5.
  1312                     30 CM-INSURED-INITIAL1-A5   PIC X.
  1313                     30 CM-INSURED-INITIAL2-A5   PIC X.
  1314                 25 CM-PART-LAST-NAME-A5         PIC XX.
  1315
  1316     12  CM-INSURED-PROFILE-DATA.
  1317         16  CM-INSURED-FIRST-NAME.
  1318             20  CM-INSURED-1ST-INIT       PIC X.
  1319             20  FILLER                    PIC X(9).
  1320         16  CM-INSURED-ISSUE-AGE          PIC 99.
  1321         16  CM-INSURED-SEX                PIC X.
  1322             88  CM-SEX-MALE                  VALUE 'M'.
  1323             88  CM-SEX-FEMAL                 VALUE 'F'.
  1324         16  CM-INSURED-JOINT-AGE          PIC 99.
  1325         16  CM-JOINT-INSURED-NAME.
  1326             20  CM-JT-LAST-NAME           PIC X(15).
  1327             20  CM-JT-FIRST-NAME.
  1328                 24  CM-JT-1ST-INIT        PIC X.
  1329                 24  FILLER                PIC X(9).
  1330             20  CM-JT-INITIAL             PIC X.
  1331
  1332     12  CM-LIFE-DATA.
  1333         16  CM-LF-BENEFIT-CD              PIC XX.
  1334         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  1335         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  1336         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  1337         16  CM-LF-DEV-CODE                PIC XXX.
  1338         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  1339         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  1340         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  1341         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  1342         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  1343         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  1344         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  1345         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1346         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  1347         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  25
* NSRLTRBL.cbl
  1348         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  1349         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  1350         16  cm-temp-epiq                  pic xx.
  1351             88  EPIQ-CLASS                  value 'EQ'.
  1352*        16  FILLER                        PIC XX.
  1353
  1354     12  CM-AH-DATA.
  1355         16  CM-AH-BENEFIT-CD              PIC XX.
  1356         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  1357         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  1358         16  CM-AH-DEV-CODE                PIC XXX.
  1359         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  1360         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  1361         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  1362         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  1363         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1364         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  1365         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  1366         16  CM-AH-PAID-THRU-DT            PIC XX.
  1367             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  1368         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  1369         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  1370         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  1371         16  FILLER                        PIC X.
  1372
  1373     12  CM-LOAN-INFORMATION.
  1374         16  CM-LIVES                      PIC S9(7)     COMP-3.
  1375         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  1376                                           PIC S9(5)V99  COMP-3.
  1377         16  CM-BILLED                     PIC S9(7)     COMP-3.
  1378         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  1379         16  CM-PAY-FREQUENCY              PIC S99.
  1380         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  1381         16  CM-RATE-CLASS                 PIC XX.
  1382         16  CM-BENEFICIARY                PIC X(25).
  1383         16  CM-POLICY-FORM-NO             PIC X(12).
  1384         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  1385         16  CM-LAST-ADD-ON-DT             PIC XX.
  1386         16  CM-DEDUCTIBLE-AMOUNTS.
  1387             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  1388             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  1389         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  1390             20  CM-RESIDENT-STATE         PIC XX.
  1391             20  CM-RATE-CODE              PIC X(4).
  1392             20  FILLER                    PIC XX.
  1393         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  1394             20  CM-LOAN-OFFICER           PIC X(5).
  1395             20  FILLER                    PIC XXX.
  1396         16  CM-CSR-CODE                   PIC XXX.
  1397         16  CM-UNDERWRITING-CODE          PIC X.
  1398             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  1399         16  CM-POST-CARD-IND              PIC X.
  1400         16  CM-REF-INTERFACE-SW           PIC X.
  1401         16  CM-PREMIUM-TYPE               PIC X.
  1402             88  CM-SING-PRM                  VALUE '1'.
  1403             88  CM-O-B-COVERAGE              VALUE '2'.
  1404             88  CM-OPEN-END                  VALUE '3'.
  1405         16  CM-IND-GRP-TYPE               PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  26
* NSRLTRBL.cbl
  1406             88  CM-INDIVIDUAL                VALUE 'I'.
  1407             88  CM-GROUP                     VALUE 'G'.
  1408         16  CM-SKIP-CODE                  PIC X.
  1409             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  1410             88  SKIP-JULY                    VALUE '1'.
  1411             88  SKIP-AUGUST                  VALUE '2'.
  1412             88  SKIP-SEPTEMBER               VALUE '3'.
  1413             88  SKIP-JULY-AUG                VALUE '4'.
  1414             88  SKIP-AUG-SEPT                VALUE '5'.
  1415             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  1416             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  1417             88  SKIP-JUNE                    VALUE '8'.
  1418             88  SKIP-JUNE-JULY               VALUE '9'.
  1419             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  1420             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  1421         16  CM-PAYMENT-MODE               PIC X.
  1422             88  PAY-MONTHLY                  VALUE SPACE.
  1423             88  PAY-WEEKLY                   VALUE '1'.
  1424             88  PAY-SEMI-MONTHLY             VALUE '2'.
  1425             88  PAY-BI-WEEKLY                VALUE '3'.
  1426             88  PAY-SEMI-ANUALLY             VALUE '4'.
  1427         16  CM-LOAN-NUMBER                PIC X(8).
  1428         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  1429         16  CM-OLD-LOF                    PIC XXX.
  1430*        16  CM-LOAN-OFFICER               PIC XXX.
  1431         16  CM-REIN-TABLE                 PIC XXX.
  1432         16  CM-SPECIAL-REIN-CODE          PIC X.
  1433         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  1434         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  1435         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  1436
  1437     12  CM-STATUS-DATA.
  1438         16  CM-ENTRY-STATUS               PIC X.
  1439         16  CM-ENTRY-DT                   PIC XX.
  1440
  1441         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  1442         16  CM-LF-CANCEL-DT               PIC XX.
  1443         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  1444
  1445         16  CM-LF-STATUS-AT-DEATH         PIC X.
  1446         16  CM-LF-DEATH-DT                PIC XX.
  1447         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  1448
  1449         16  CM-LF-CURRENT-STATUS          PIC X.
  1450             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  1451                                                'M' '4' '5' '9'.
  1452             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  1453             88  CM-LF-POLICY-PENDING         VALUE '2'.
  1454             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  1455             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  1456             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  1457             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  1458             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  1459             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  1460             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  1461             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  1462             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  1463             88  CM-LF-DECLINED               VALUE 'D'.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  27
* NSRLTRBL.cbl
  1464             88  CM-LF-VOIDED                 VALUE 'V'.
  1465
  1466         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  1467         16  CM-AH-CANCEL-DT               PIC XX.
  1468         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  1469
  1470         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  1471         16  CM-AH-SETTLEMENT-DT           PIC XX.
  1472         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  1473
  1474         16  CM-AH-CURRENT-STATUS          PIC X.
  1475             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  1476                                                'M' '4' '5' '9'.
  1477             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  1478             88  CM-AH-POLICY-PENDING         VALUE '2'.
  1479             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  1480             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  1481             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  1482             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  1483             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  1484             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  1485             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  1486             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  1487             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  1488             88  CM-AH-DECLINED               VALUE 'D'.
  1489             88  CM-AH-VOIDED                 VALUE 'V'.
  1490
  1491         16  CM-CLAIM-INTERFACE-SW         PIC X.
  1492             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  1493             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  1494             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  1495         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  1496
  1497         16  CM-ENTRY-BATCH                PIC X(6).
  1498         16  CM-LF-EXIT-BATCH              PIC X(6).
  1499         16  CM-AH-EXIT-BATCH              PIC X(6).
  1500         16  CM-LAST-MONTH-END             PIC XX.
  1501
  1502     12  CM-NOTE-SW                        PIC X.
  1503         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  1504         88  CERT-NOTES-PRESENT               VALUE '1'.
  1505         88  BILLING-NOTES-PRESENT            VALUE '2'.
  1506         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  1507         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  1508         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  1509         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  1510         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  1511     12  CM-COMP-EXCP-SW                   PIC X.
  1512         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  1513         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  1514     12  CM-INSURED-ADDRESS-SW             PIC X.
  1515         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  1516         88  INSURED-ADDR-PRESENT             VALUE '1'.
  1517
  1518*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  1519     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  1520     12  FILLER                            PIC X.
  1521
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  28
* NSRLTRBL.cbl
  1522*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  1523     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  1524     12  FILLER                            PIC X.
  1525*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  1526     12  CM-INT-ON-REFS                    PIC S9(7)V99   COMP-3.
  1527
  1528     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  1529         88  CERT-ADDED-BATCH                 VALUE ' '.
  1530         88  CERT-ADDED-ONLINE                VALUE '1'.
  1531         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  1532         88  CERT-PURGED-OFFLINE              VALUE '3'.
  1533         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  1534     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  1535         88  CERT-AS-LOADED                   VALUE ' '.
  1536         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  1537         88  CERT-CLAIM-ONLINE                VALUE '2'.
  1538         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  1539         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  1540         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  1541         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  1542         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  1543
  1544     12  CM-ACCOUNT-COMM-PCTS.
  1545         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  1546         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  1547
  1548     12  CM-USER-FIELD                     PIC X.
  1549     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  1550     12  CM-CLP-STATE                      PIC XX.
  1551     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  1552     12  CM-USER-RESERVED                  PIC XXX.
  1553     12  FILLER REDEFINES CM-USER-RESERVED.
  1554         16  CM-AH-CLASS-CD                PIC XX.
  1555         16  F                             PIC X.
  1556******************************************************************
  1557*                                COPY ERCACCT.
  1558******************************************************************
  1559*                                                                *
  1560*                                                                *
  1561*                            ERCACCT                             *
  1562*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1563*                            VMOD=2.031                          *
  1564*                                                                *
  1565*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  1566*                                                                *
  1567*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  1568*   VSAM ACCOUNT MASTER FILES.                                   *
  1569*                                                                *
  1570*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  1571*                                                                *
  1572*   FILE TYPE = VSAM,KSDS                                        *
  1573*   RECORD SIZE = 2000  RECFORM = FIX                            *
  1574*                                                                *
  1575*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  1576*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  1577*                                                                *
  1578*   LOG = NO                                                     *
  1579*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  29
* NSRLTRBL.cbl
  1580*                                                                *
  1581*                                                                *
  1582******************************************************************
  1583*                   C H A N G E   L O G
  1584*
  1585* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1586*-----------------------------------------------------------------
  1587*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1588* EFFECTIVE    NUMBER
  1589*-----------------------------------------------------------------
  1590* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  1591* 092705    2005050300006  PEMA  ADD SPP LEASES
  1592* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  1593* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1594* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  1595* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  1596* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  1597* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  1598******************************************************************
  1599
  1600 01  ACCOUNT-MASTER.
  1601     12  AM-RECORD-ID                      PIC XX.
  1602         88  VALID-AM-ID                      VALUE 'AM'.
  1603
  1604     12  AM-CONTROL-PRIMARY.
  1605         16  AM-COMPANY-CD                 PIC X.
  1606         16  AM-MSTR-CNTRL.
  1607             20  AM-CONTROL-A.
  1608                 24  AM-CARRIER            PIC X.
  1609                 24  AM-GROUPING.
  1610                     28 AM-GROUPING-PREFIX PIC XXX.
  1611                     28 AM-GROUPING-PRIME  PIC XXX.
  1612                 24  AM-STATE              PIC XX.
  1613                 24  AM-ACCOUNT.
  1614                     28  AM-ACCOUNT-PREFIX PIC X(4).
  1615                     28  AM-ACCOUNT-PRIME  PIC X(6).
  1616             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  1617                                           PIC X(19).
  1618             20  AM-CNTRL-B.
  1619                 24  AM-EXPIRATION-DT      PIC XX.
  1620                 24  FILLER                PIC X(4).
  1621             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  1622                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  1623
  1624     12  AM-CONTROL-BY-VAR-GRP.
  1625         16  AM-COMPANY-CD-A1              PIC X.
  1626         16  AM-VG-CARRIER                 PIC X.
  1627         16  AM-VG-GROUPING                PIC X(6).
  1628         16  AM-VG-STATE                   PIC XX.
  1629         16  AM-VG-ACCOUNT                 PIC X(10).
  1630         16  AM-VG-DATE.
  1631             20  AM-VG-EXPIRATION-DT       PIC XX.
  1632             20  FILLER                    PIC X(4).
  1633         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  1634                                           PIC 9(11)      COMP-3.
  1635     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  1636         16  FILLER                        PIC X(10).
  1637         16  AM-VG-KEY3.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  30
* NSRLTRBL.cbl
  1638             20  AM-VG3-ACCOUNT            PIC X(10).
  1639             20  AM-VG3-EXP-DT             PIC XX.
  1640         16  FILLER                        PIC X(4).
  1641     12  AM-MAINT-INFORMATION.
  1642         16  AM-LAST-MAINT-DT              PIC XX.
  1643         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1644         16  AM-LAST-MAINT-USER            PIC X(4).
  1645         16  FILLER                        PIC XX.
  1646
  1647     12  AM-EFFECTIVE-DT                   PIC XX.
  1648     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  1649
  1650     12  AM-PREV-DATES  COMP-3.
  1651         16  AM-PREV-EXP-DT                PIC 9(11).
  1652         16  AM-PREV-EFF-DT                PIC 9(11).
  1653
  1654     12  AM-REPORT-CODE-1                  PIC X(10).
  1655     12  AM-REPORT-CODE-2                  PIC X(10).
  1656
  1657     12  AM-CITY-CODE                      PIC X(4).
  1658     12  AM-COUNTY-PARISH                  PIC X(6).
  1659
  1660     12  AM-NAME                           PIC X(30).
  1661     12  AM-PERSON                         PIC X(30).
  1662     12  AM-ADDRS                          PIC X(30).
  1663     12  AM-CITY.
  1664         16  AM-ADDR-CITY                  PIC X(28).
  1665         16  AM-ADDR-STATE                 PIC XX.
  1666     12  AM-ZIP.
  1667         16  AM-ZIP-PRIME.
  1668             20  AM-ZIP-PRI-1ST            PIC X.
  1669                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  1670             20  FILLER                    PIC X(4).
  1671         16  AM-ZIP-PLUS4                  PIC X(4).
  1672     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  1673         16  AM-CAN-POSTAL-1               PIC XXX.
  1674         16  AM-CAN-POSTAL-2               PIC XXX.
  1675         16  FILLER                        PIC XXX.
  1676     12  AM-TEL-NO.
  1677         16  AM-AREA-CODE                  PIC 999.
  1678         16  AM-TEL-PRE                    PIC 999.
  1679         16  AM-TEL-NBR                    PIC 9(4).
  1680     12  AM-TEL-LOC                        PIC X.
  1681         88  AM-TEL-AT-HOME                   VALUE 'H'.
  1682         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  1683
  1684     12  AM-COMM-STRUCTURE.
  1685         16  AM-DEFN-1.
  1686             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  1687                 24  AM-AGT.
  1688                     28  AM-AGT-PREFIX     PIC X(4).
  1689                     28  AM-AGT-PRIME      PIC X(6).
  1690                 24  AM-COM-TYP            PIC X.
  1691                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  1692                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  1693                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  1694                 24  AM-RECALC-LV-INDIC    PIC X.
  1695                 24  AM-RETRO-LV-INDIC     PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  31
* NSRLTRBL.cbl
  1696                 24  AM-GL-CODES           PIC X.
  1697                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  1698                 24  FILLER                PIC X(01).
  1699         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  1700             20  AM-COM-TBLS        OCCURS 10 TIMES.
  1701                 24  FILLER                PIC X(11).
  1702                 24  AM-L-COMA             PIC XXX.
  1703                 24  AM-J-COMA             PIC XXX.
  1704                 24  AM-A-COMA             PIC XXX.
  1705                 24  FILLER                PIC X(6).
  1706
  1707     12  AM-COMM-CHANGE-STATUS             PIC X.
  1708         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  1709
  1710     12  AM-CSR-CODE                       PIC X(4).
  1711
  1712     12  AM-BILLING-STATUS                 PIC X.
  1713         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  1714         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  1715     12  AM-AUTO-REFUND-SW                 PIC X.
  1716         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  1717         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  1718     12  AM-GPCD                           PIC 99.
  1719     12  AM-IG                             PIC X.
  1720         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  1721         88  AM-HAS-GROUP                     VALUE '2'.
  1722     12  AM-STATUS                         PIC X.
  1723         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  1724         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  1725         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  1726         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  1727         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  1728         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  1729         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  1730         88  AM-ACCOUNT-LAPSED                VALUE '7'.
  1731         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  1732         88  AM-ACCOUNT-PENDING               VALUE '9'.
  1733     12  AM-REMIT-TO                       PIC 99.
  1734     12  AM-ID-NO                          PIC X(11).
  1735
  1736     12  AM-CAL-TABLE                      PIC XX.
  1737     12  AM-LF-DEVIATION                   PIC XXX.
  1738     12  AM-AH-DEVIATION                   PIC XXX.
  1739     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  1740     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  1741     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  1742     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  1743     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1744     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1745
  1746     12  AM-USER-FIELDS.
  1747         16  AM-FLD-1                      PIC XX.
  1748         16  AM-FLD-2                      PIC XX.
  1749         16  AM-FLD-3                      PIC XX.
  1750         16  AM-FLD-4                      PIC XX.
  1751         16  AM-FLD-5                      PIC XX.
  1752
  1753     12  AM-1ST-PROD-DATE.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  32
* NSRLTRBL.cbl
  1754         16  AM-1ST-PROD-YR                PIC XX.
  1755         16  AM-1ST-PROD-MO                PIC XX.
  1756         16  AM-1ST-PROD-DA                PIC XX.
  1757     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  1758     12  AM-CERTS-PURGED-DATE.
  1759         16  AM-PUR-YR                     PIC XX.
  1760         16  AM-PUR-MO                     PIC XX.
  1761         16  AM-PUR-DA                     PIC XX.
  1762     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  1763     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  1764     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  1765     12  AM-INACTIVE-DATE.
  1766         16  AM-INA-MO                     PIC 99.
  1767         16  AM-INA-DA                     PIC 99.
  1768         16  AM-INA-YR                     PIC 99.
  1769     12  AM-AR-HI-CERT-DATE                PIC XX.
  1770
  1771     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  1772     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  1773
  1774     12  AM-OB-PAYMENT-MODE                PIC X.
  1775         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  1776         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  1777         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  1778         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  1779
  1780     12  AM-AH-ONLY-INDICATOR              PIC X.
  1781         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  1782         88  AM-NO-AH-ONLY                    VALUE 'N'.
  1783
  1784     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  1785
  1786     12  AM-OVER-SHORT.
  1787         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  1788         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  1789
  1790     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  1791     12  AM-DCC-CLP-STATE                  PIC XX.
  1792
  1793     12  AM-RECALC-COMM                    PIC X.
  1794     12  AM-RECALC-REIN                    PIC X.
  1795
  1796     12  AM-REI-TABLE                      PIC XXX.
  1797     12  AM-REI-ET-LF                      PIC X.
  1798     12  AM-REI-ET-AH                      PIC X.
  1799     12  AM-REI-PE-LF                      PIC X.
  1800     12  AM-REI-PE-AH                      PIC X.
  1801     12  AM-REI-PRT-ST                     PIC X.
  1802     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  1803     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  1804     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  1805     12  AM-REI-GROUP-A                    PIC X(6).
  1806     12  AM-REI-MORT                       PIC X(4).
  1807     12  AM-REI-PRT-OW                     PIC X.
  1808     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  1809     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  1810     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  1811     12  AM-REI-GROUP-B                    PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  33
* NSRLTRBL.cbl
  1812
  1813     12  AM-TRUST-TYPE                     PIC X(2).
  1814
  1815     12  AM-EMPLOYER-STMT-USED             PIC X.
  1816     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  1817
  1818     12  AM-STD-AH-TYPE                    PIC XX.
  1819     12  AM-EARN-METHODS.
  1820         16  AM-EARN-METHOD-R              PIC X.
  1821             88 AM-REF-RL-R78                 VALUE 'R'.
  1822             88 AM-REF-RL-PR                  VALUE 'P'.
  1823             88 AM-REF-RL-MEAN                VALUE 'M'.
  1824             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  1825         16  AM-EARN-METHOD-L              PIC X.
  1826             88 AM-REF-LL-R78                 VALUE 'R'.
  1827             88 AM-REF-LL-PR                  VALUE 'P'.
  1828             88 AM-REF-LL-MEAN                VALUE 'M'.
  1829             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  1830         16  AM-EARN-METHOD-A              PIC X.
  1831             88 AM-REF-AH-R78                 VALUE 'R'.
  1832             88 AM-REF-AH-PR                  VALUE 'P'.
  1833             88 AM-REF-AH-MEAN                VALUE 'M'.
  1834             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  1835             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  1836             88 AM-REF-AH-NET                 VALUE 'N'.
  1837
  1838     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  1839     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  1840     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  1841
  1842     12  AM-RET-Y-N                        PIC X.
  1843     12  AM-RET-P-E                        PIC X.
  1844     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  1845     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  1846     12  AM-RET-GRP                        PIC X(6).
  1847     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  1848         16  AM-POOL-PRIME                 PIC XXX.
  1849         16  AM-POOL-SUB                   PIC XXX.
  1850     12  AM-RETRO-EARNINGS.
  1851         16  AM-RET-EARN-R                 PIC X.
  1852         16  AM-RET-EARN-L                 PIC X.
  1853         16  AM-RET-EARN-A                 PIC X.
  1854     12  AM-RET-ST-TAX-USE                 PIC X.
  1855         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  1856         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  1857     12  AM-RETRO-BEG-EARNINGS.
  1858         16  AM-RET-BEG-EARN-R             PIC X.
  1859         16  AM-RET-BEG-EARN-L             PIC X.
  1860         16  AM-RET-BEG-EARN-A             PIC X.
  1861     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  1862     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  1863
  1864     12  AM-USER-SELECT-OPTIONS.
  1865         16  AM-USER-SELECT-1              PIC X(10).
  1866         16  AM-USER-SELECT-2              PIC X(10).
  1867         16  AM-USER-SELECT-3              PIC X(10).
  1868         16  AM-USER-SELECT-4              PIC X(10).
  1869         16  AM-USER-SELECT-5              PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  34
* NSRLTRBL.cbl
  1870
  1871     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  1872
  1873     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  1874
  1875     12  AM-RPT045A-SWITCH                 PIC X.
  1876         88  RPT045A-OFF                   VALUE 'N'.
  1877
  1878     12  AM-INSURANCE-LIMITS.
  1879         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  1880         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  1881
  1882     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  1883         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  1884
  1885     12  AM-DISMBR-COVERAGE-SW             PIC X.
  1886         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  1887         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  1888
  1889     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  1890
  1891     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  1892     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  1893     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  1894     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  1895     12  AM-DCC-UEF-STATE                  PIC XX.
  1896     12  FILLER                            PIC XXX.
  1897     12  AM-REPORT-CODE-3                  PIC X(10).
  1898*    12  FILLER                            PIC X(22).
  1899
  1900     12  AM-RESERVE-DATE.
  1901         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  1902         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  1903         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  1904
  1905     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  1906     12  AM-NOTIFICATION-TYPES.
  1907         16  AM-NOTIF-OF-LETTERS           PIC X.
  1908         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  1909         16  AM-NOTIF-OF-REPORTS           PIC X.
  1910         16  AM-NOTIF-OF-STATUS            PIC X.
  1911
  1912     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  1913         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  1914         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  1915         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  1916         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  1917
  1918     12  AM-BENEFIT-CONTROLS.
  1919         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  1920             20  AM-BENEFIT-CODE           PIC XX.
  1921             20  AM-BENEFIT-TYPE           PIC X.
  1922             20  AM-BENEFIT-REVISION       PIC XXX.
  1923             20  AM-BENEFIT-REM-TERM       PIC X.
  1924             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  1925             20  FILLER                    PIC XX.
  1926         16  FILLER                        PIC X(80).
  1927
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  35
* NSRLTRBL.cbl
  1928     12  AM-TRANSFER-DATA.
  1929         16  AM-TRANSFERRED-FROM.
  1930             20  AM-TRNFROM-CARRIER        PIC X.
  1931             20  AM-TRNFROM-GROUPING.
  1932                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  1933                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  1934             20  AM-TRNFROM-STATE          PIC XX.
  1935             20  AM-TRNFROM-ACCOUNT.
  1936                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  1937                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  1938             20  AM-TRNFROM-DTE            PIC XX.
  1939         16  AM-TRANSFERRED-TO.
  1940             20  AM-TRNTO-CARRIER          PIC X.
  1941             20  AM-TRNTO-GROUPING.
  1942                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  1943                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  1944             20  AM-TRNTO-STATE            PIC XX.
  1945             20  AM-TRNTO-ACCOUNT.
  1946                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  1947                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  1948             20  AM-TRNTO-DTE              PIC XX.
  1949         16  FILLER                        PIC X(10).
  1950
  1951     12  AM-SAVED-REMIT-TO                 PIC 99.
  1952
  1953     12  AM-COMM-STRUCTURE-SAVED.
  1954         16  AM-DEFN-1-SAVED.
  1955             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  1956                 24  AM-AGT-SV             PIC X(10).
  1957                 24  AM-COM-TYP-SV         PIC X.
  1958                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  1959                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  1960                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  1961                 24  AM-RECALC-LV-INDIC-SV PIC X.
  1962                 24  FILLER                PIC X.
  1963                 24  AM-GL-CODES-SV        PIC X.
  1964                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  1965                 24  FILLER                PIC X.
  1966         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  1967             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  1968                 24  FILLER                PIC X(11).
  1969                 24  AM-L-COMA-SV          PIC XXX.
  1970                 24  AM-J-COMA-SV          PIC XXX.
  1971                 24  AM-A-COMA-SV          PIC XXX.
  1972                 24  FILLER                PIC X(6).
  1973
  1974     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  1975         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  1976            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  1977            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  1978            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  1979
  1980     12  AM-ORIG-DEALER-NO                 PIC X(10).
  1981     12  FILLER                            PIC X(120).
  1982
  1983     12  AM-ACCOUNT-EXECUTIVE-DATA.
  1984         16  AM-CONTROL-NAME               PIC X(30).
  1985         16  AM-EXECUTIVE-ONE.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  36
* NSRLTRBL.cbl
  1986             20  AM-EXEC1-NAME             PIC X(15).
  1987             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  1988                                                          COMP-3.
  1989             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  1990                                                          COMP-3.
  1991         16  AM-EXECUTIVE-TWO.
  1992             20  AM-EXEC2-NAME             PIC X(15).
  1993             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  1994                                                          COMP-3.
  1995             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  1996                                                          COMP-3.
  1997
  1998     12  AM-RETRO-ADDITIONAL-DATA.
  1999         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  2000         16  AM-RETRO-PREM-P-E             PIC X.
  2001         16  AM-RETRO-CLMS-P-I             PIC X.
  2002         16  AM-RETRO-RET-BRACKET-LF.
  2003             20  AM-RETRO-RET-METHOD-LF    PIC X.
  2004                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  2005                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  2006             20  AM-RETRO-RET-BASIS-LF     PIC X.
  2007                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  2008                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  2009             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  2010                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  2011                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  2012         16  AM-RETRO-RET-BRACKET-AH.
  2013             20  AM-RETRO-RET-METHOD-AH    PIC X.
  2014                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  2015                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  2016                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  2017             20  AM-RETRO-RET-BASIS-AH     PIC X.
  2018                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  2019                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  2020             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  2021                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  2022                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  2023
  2024     12  AM-COMMENTS.
  2025         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  2026
  2027     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  2028         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  2029         16  AM-FLI-BILLING-CODE           PIC X.
  2030         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  2031         16  AM-FLI-UNITED-IDENT           PIC X.
  2032         16  AM-FLI-INTEREST-LOST-DATA.
  2033             20  AM-FLI-BANK-NO            PIC X(5).
  2034             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  2035             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  2036             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  2037         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  2038             20  AM-FLI-AGT                PIC X(9).
  2039             20  AM-FLI-AGT-COMM-ACC       PIC X.
  2040             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  2041         16  FILLER                        PIC X(102).
  2042
  2043     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  37
* NSRLTRBL.cbl
  2044         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  2045             20  AM-BENEFIT-DMD-CODE         PIC XX.
  2046             20  AM-BENEFIT-DMD-TYPE         PIC X.
  2047             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  2048             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  2049             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  2050         16  FILLER                          PIC X(10).
  2051******************************************************************
  2052*                                COPY ELCBENE.
  2053******************************************************************
  2054*                                                                *
  2055*                            ELCBENE.                            *
  2056*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2057*                            VMOD=2.006                          *
  2058*                                                                *
  2059*   FILE DESCRIPTION = BENEFICIARY FILE                          *
  2060*                                                                *
  2061*   FILE TYPE = VSAM,KSDS                                        *
  2062*   RECORD SIZE = 500   RECFORM = FIX                            *
  2063*                                                                *
  2064*   BASE CLUSTER NAME = ELBENE                   RKP=2,LEN=12    *
  2065*     ALTERNATE PATH1 = ELBENE2 (ALT BY NAME)    RKP=14,LEN=42   *
  2066*                                                                *
  2067*   LOG = YES                                                    *
  2068*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2069*                                                                *
  2070*  NO  CID  MODS  TO  COPYBOOK  ELCBENE                          *
  2071******************************************************************
  2072*                   C H A N G E   L O G
  2073*
  2074* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2075*-----------------------------------------------------------------
  2076*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2077* EFFECTIVE    NUMBER
  2078*-----------------------------------------------------------------
  2079* 013017  CR2016053100001  PEMA  ACH PROCESSING
  2080* 082317  CR2017082100003  PEMA  Add sub type
  2081* 032019  CR2019011400002  PEMA  Add email address for ach report
  2082******************************************************************
  2083
  2084 01  BENEFICIARY-MASTER.
  2085     12  BE-RECORD-ID                PIC XX.
  2086         88  VALID-BE-ID                VALUE 'BE'.
  2087
  2088     12  BE-CONTROL-PRIMARY.
  2089         16  BE-COMPANY-CD           PIC X.
  2090         16  BE-RECORD-TYPE          PIC X.
  2091             88  BENEFICIARY-RECORD  VALUE 'B'.
  2092             88  ADJUSTOR-RECORD     VALUE 'A'.
  2093         16  BE-BENEFICIARY          PIC X(10).
  2094     12  BE-CONTROL-BY-NAME.
  2095         16  BE-COMPANY-CD-A1        PIC X.
  2096         16  BE-RECORD-TYPE-A1       PIC X.
  2097         16  BE-MAIL-TO-NAME-A1      PIC X(30).
  2098         16  BE-ALTERNATE-PRIME-A1   PIC X(10).
  2099
  2100     12  BE-LAST-MAINT-DT            PIC XX.
  2101     12  BE-LAST-MAINT-BY            PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  38
* NSRLTRBL.cbl
  2102     12  BE-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  2103
  2104     12  BE-ADDRESS-DATA.
  2105         16  BE-MAIL-TO-NAME         PIC X(30).
  2106         16  BE-ADDRESS-LINE-1       PIC X(30).
  2107         16  BE-ADDRESS-LINE-2       PIC X(30).
  2108         16  BE-ADDRESS-LINE-3       PIC X(30).
  2109         16  BE-CITY-STATE.
  2110             20  BE-CITY             PIC X(28).
  2111             20  BE-STATE            PIC XX.
  2112         16  BE-ZIP-CODE.
  2113             20  BE-ZIP-PRIME.
  2114                 24  BE-ZIP-1ST      PIC X.
  2115                     88  BE-CANADIAN-POST-CODE
  2116                                         VALUE 'A' THRU 'Z'.
  2117                 24  FILLER          PIC X(4).
  2118             20  BE-ZIP-PLUS4        PIC X(4).
  2119         16  BE-CANADIAN-POSTAL-CODE  REDEFINES  BE-ZIP-CODE.
  2120             20  BE-CAN-POSTAL-1     PIC XXX.
  2121             20  BE-CAN-POSTAL-2     PIC XXX.
  2122             20  FILLER              PIC XXX.
  2123         16  BE-PHONE-NO             PIC 9(11)     COMP-3.
  2124         16  BE-GROUP-CHECKS-Y-N     PIC X.
  2125
  2126******************************************************************
  2127*    THE BE-CARRIER FIELD IS USED BY 'AIG' TO DETERMINE HOW TO   *
  2128*    SET THE CARRIER CODE IN THE PENDING CLAIM FILE.             *
  2129******************************************************************
  2130     12  BE-CARRIER                  PIC X.
  2131
  2132     12  BE-ADDRESS-DATA2.
  2133         16  BE-MAIL-TO-NAME2        PIC X(30).
  2134         16  BE-ADDRESS-LINE-12      PIC X(30).
  2135         16  BE-ADDRESS-LINE-22      PIC X(30).
  2136         16  BE-ADDRESS-LINE-32      PIC X(30).
  2137         16  BE-CITY-STATE2.
  2138             20  BE-CITY2            PIC X(28).
  2139             20  BE-STATE2           PIC XX.
  2140         16  BE-ZIP-CODE2.
  2141             20  BE-ZIP-PRIME2.
  2142                 24  BE-ZIP-1ST2     PIC X.
  2143                     88  BE-CANADIAN-POST-CODE2
  2144                                         VALUE 'A' THRU 'Z'.
  2145                 24  FILLER          PIC X(4).
  2146             20  BE-ZIP-PLUS42       PIC X(4).
  2147         16  BE-CANADIAN-POSTAL-CODE2 REDEFINES  BE-ZIP-CODE2.
  2148             20  BE-CAN-POSTAL-12    PIC XXX.
  2149             20  BE-CAN-POSTAL-22    PIC XXX.
  2150             20  FILLER              PIC XXX.
  2151         16  BE-PHONE-NO2            PIC 9(11)     COMP-3.
  2152         16  BE-ACH-DATA.
  2153             20  BE-ACH-YES-OR-NO    PIC X.
  2154                 88  BE-ON-ACH       VALUE 'Y'.
  2155                 88  BE-NOT-ON-ACH   VALUE 'N' ' '.
  2156             20  BE-ACH-ABA-ROUTING-NUMBER
  2157                                     PIC X(15).
  2158             20  BE-ACH-BANK-ACCOUNT-NUMBER
  2159                                     PIC X(20).
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  39
* NSRLTRBL.cbl
  2160             20  BE-ACH-SUB-TYPE     PIC XX.
  2161             20  BE-ACH-EMAIL-YN     PIC X.
  2162                 88  BE-EMAIL-ACH-RPT  VALUE 'Y'.
  2163             20  be-ach-email-addr   PIC X(40).
  2164         16  BE-BILLING-STMT-DATA.
  2165*            20  BE-BSR-PHONE-NUM    PIC 9(11)     COMP-3.
  2166             20  BE-BSR-FAX-NUM      PIC 9(11)     COMP-3.
  2167             20  BE-OUTPUT-TYPE      PIC X.
  2168                 88  BE-FAX-OUTPUT         VALUE 'F'.
  2169                 88  BE-PRINT-OUTPUT       VALUE 'P' ' '.
  2170
  2171     12  filler                      PIC X(16).
  2172******************************************************************
  2173*                                COPY ELCTEXT.
  2174******************************************************************
  2175*                                                                *
  2176*                                                                *
  2177*                            ELCTEXT.                            *
  2178*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2179*                            VMOD=2.008                          *
  2180*                                                                *
  2181*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
  2182*                                     FORM LETTERS,              *
  2183*                                     CERT FORM DISPLAY.
  2184*                                                                *
  2185*   FILE TYPE = VSAM,KSDS                                        *
  2186*   RECORD SIZE = 100   RECFORM = FIXED                          *
  2187*                                                                *
  2188*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
  2189*       ALTERNATE INDEX = NONE                                   *
  2190*                                                                *
  2191*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
  2192*       ALTERNATE INDEX = NONE                                   *
  2193*                                                                *
  2194*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
  2195*       ALTERNATE INDEX = NONE                                   *
  2196*                                                                *
  2197*   LOG = NO                                                     *
  2198*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2199******************************************************************
  2200 01  TEXT-FILES.
  2201     12  TEXT-FILE-ID                PIC XX.
  2202         88  FORMS-FILE-TEXT            VALUE 'TF'.
  2203         88  LETTER-FILE-TEXT           VALUE 'TL'.
  2204         88  HELP-FILE-TEXT             VALUE 'TH'.
  2205
  2206     12  TX-CONTROL-PRIMARY.
  2207         16  TX-COMPANY-CD           PIC X.
  2208             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
  2209         16  TX-ACCESS-CD-GENL       PIC X(12).
  2210
  2211         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  2212             20  TX-LETTER-NO        PIC X(4).
  2213             20  FILLER              PIC X(8).
  2214
  2215         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  2216             20  TX-FORM-NO          PIC X(12).
  2217
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  40
* NSRLTRBL.cbl
  2218         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  2219             20  TX-HELP-TYPE        PIC X.
  2220                 88  HELP-FOR-GENERAL   VALUE ' '.
  2221                 88  HELP-BY-SCREEN     VALUE 'S'.
  2222                 88  HELP-BY-ERROR      VALUE 'E'.
  2223             20  TX-SCREEN-OR-ERROR  PIC X(4).
  2224                 88  GENERAL-INFO-HELP  VALUE '0000'.
  2225             20  TX-HELP-FOR-COMPANY  PIC XXX.
  2226                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
  2227             20  FILLER              PIC X(4).
  2228
  2229         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
  2230
  2231     12  TX-PROCESS-CONTROL          PIC XX.
  2232         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
  2233
  2234     12  TX-TEXT-LINE                PIC X(70).
  2235
  2236     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
  2237         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
  2238         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
  2239         88  TX-VALID-FORM-SQUEEZE-VALUE
  2240                                        VALUE 'Y' ' '.
  2241
  2242     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
  2243         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
  2244         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
  2245         88  TX-DO-NOT-ADJUST           VALUE 'N'.
  2246         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
  2247         88  TX-NEW-PARAGRAPH           VALUE 'P'.
  2248         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
  2249         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
  2250                                              'K' 'N' ' '
  2251                                              'Z'.
  2252
  2253     12  TX-ARCHIVE-SW               PIC X.
  2254         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
  2255         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
  2256         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
  2257
  2258     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
  2259     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
  2260
  2261     12  TX-BSR-CODE                 PIC X.
  2262         88  TX-BSR-LETTER              VALUE 'B'.
  2263         88  TX-NON-BSR-LETTER          VALUE ' '.
  2264
  2265     12  FILLER                      PIC X.
  2266*****************************************************************
  2267*                                COPY ELCCNTL.
  2268******************************************************************
  2269*                                                                *
  2270*                                                                *
  2271*                            ELCCNTL.                            *
  2272*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2273*                            VMOD=2.059                          *
  2274*                                                                *
  2275*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  41
* NSRLTRBL.cbl
  2276*                                                                *
  2277*   FILE TYPE = VSAM,KSDS                                        *
  2278*   RECORD SIZE = 750  RECFORM = FIXED                           *
  2279*                                                                *
  2280*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  2281*       ALTERNATE INDEX = NONE                                   *
  2282*                                                                *
  2283*   LOG = YES                                                    *
  2284*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2285******************************************************************
  2286*                   C H A N G E   L O G
  2287*
  2288* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2289*-----------------------------------------------------------------
  2290*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2291* EFFECTIVE    NUMBER
  2292*-----------------------------------------------------------------
  2293* 082503                   PEMA  ADD BENEFIT GROUP
  2294* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2295* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2296* 092705    2005050300006  PEMA  ADD SPP LEASES
  2297* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  2298* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  2299* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  2300* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  2301* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  2302* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2303* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  2304* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  2305* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  2306* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2307* 102717  CR2017062000003  PEMA  COMM CAP CHANGES
  2308******************************************************************
  2309*
  2310 01  CONTROL-FILE.
  2311     12  CF-RECORD-ID                       PIC XX.
  2312         88  VALID-CF-ID                        VALUE 'CF'.
  2313
  2314     12  CF-CONTROL-PRIMARY.
  2315         16  CF-COMPANY-ID                  PIC XXX.
  2316         16  CF-RECORD-TYPE                 PIC X.
  2317             88  CF-COMPANY-MASTER              VALUE '1'.
  2318             88  CF-PROCESSOR-MASTER            VALUE '2'.
  2319             88  CF-STATE-MASTER                VALUE '3'.
  2320             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  2321             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  2322             88  CF-CARRIER-MASTER              VALUE '6'.
  2323             88  CF-MORTALITY-MASTER            VALUE '7'.
  2324             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  2325             88  CF-TERMINAL-MASTER             VALUE '9'.
  2326             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  2327             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  2328             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  2329             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  2330             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  2331             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  2332             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  2333             88  CF-REMINDERS-MASTER            VALUE 'R'.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  42
* NSRLTRBL.cbl
  2334             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  2335         16  CF-ACCESS-CD-GENL              PIC X(4).
  2336         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  2337             20  CF-PROCESSOR               PIC X(4).
  2338         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  2339             20  CF-STATE-CODE              PIC XX.
  2340             20  FILLER                     PIC XX.
  2341         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  2342             20  FILLER                     PIC XX.
  2343             20  CF-HI-BEN-IN-REC           PIC XX.
  2344         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  2345             20  FILLER                     PIC XXX.
  2346             20  CF-CARRIER-CNTL            PIC X.
  2347         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  2348             20  FILLER                     PIC XX.
  2349             20  CF-HI-TYPE-IN-REC          PIC 99.
  2350         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  2351             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  2352                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  2353             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  2354             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  2355         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  2356             20  FILLER                     PIC X.
  2357             20  CF-CUSTOM-REPORT-NO        PIC 999.
  2358         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  2359             20  FILLER                     PIC XX.
  2360             20  CF-MORTGAGE-PLAN           PIC XX.
  2361         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  2362
  2363     12  CF-LAST-MAINT-DT                   PIC XX.
  2364     12  CF-LAST-MAINT-BY                   PIC X(4).
  2365     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2366
  2367     12  CF-RECORD-BODY                     PIC X(728).
  2368
  2369
  2370****************************************************************
  2371*             COMPANY MASTER RECORD                            *
  2372****************************************************************
  2373
  2374     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2375         16  CF-COMPANY-ADDRESS.
  2376             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  2377             20  CF-CL-IN-CARE-OF           PIC X(30).
  2378             20  CF-CL-ADDR-LINE-1          PIC X(30).
  2379             20  CF-CL-ADDR-LINE-2          PIC X(30).
  2380             20  CF-CL-CITY-STATE           PIC X(30).
  2381             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  2382             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  2383         16  CF-COMPANY-CD                  PIC X.
  2384         16  CF-COMPANY-PASSWORD            PIC X(8).
  2385         16  CF-SECURITY-OPTION             PIC X.
  2386             88  ALL-SECURITY                   VALUE '1'.
  2387             88  COMPANY-VERIFY                 VALUE '2'.
  2388             88  PROCESSOR-VERIFY               VALUE '3'.
  2389             88  NO-SECURITY                    VALUE '4'.
  2390             88  ALL-BUT-TERM                   VALUE '5'.
  2391         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  43
* NSRLTRBL.cbl
  2392             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  2393         16  CF-LGX-INTERFACE-CNTL          PIC X.
  2394             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  2395         16  CF-INFORCE-LOCATION            PIC X.
  2396             88  CERTS-ARE-ONLINE               VALUE '1'.
  2397             88  CERTS-ARE-OFFLINE              VALUE '2'.
  2398             88  NO-CERTS-AVAILABLE             VALUE '3'.
  2399         16  CF-LOWER-CASE-LETTERS          PIC X.
  2400         16  CF-CERT-ACCESS-CONTROL         PIC X.
  2401             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  2402             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2403             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  2404             88  CF-ACCNT-CNTL                  VALUE '3'.
  2405             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  2406
  2407         16  CF-FORMS-PRINTER-ID            PIC X(4).
  2408         16  CF-CHECK-PRINTER-ID            PIC X(4).
  2409
  2410         16  CF-LGX-CREDIT-USER             PIC X.
  2411             88  CO-IS-NOT-USER                 VALUE 'N'.
  2412             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  2413
  2414         16 CF-CREDIT-CALC-CODES.
  2415             20  CF-CR-REM-TERM-CALC PIC X.
  2416               88  CR-EARN-AFTER-15TH           VALUE '1'.
  2417               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  2418               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  2419               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  2420               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  2421               88  CR-EARN-AFTER-14TH           VALUE '6'.
  2422               88  CR-EARN-AFTER-16TH           VALUE '7'.
  2423             20  CF-CR-R78-METHOD           PIC X.
  2424               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  2425               88  DONT-USE-PLUS-ONE            VALUE '1'.
  2426
  2427         16  CF-CLAIM-CONTROL-COUNTS.
  2428             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  2429                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  2430
  2431             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  2432                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  2433
  2434             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  2435                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  2436
  2437             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  2438                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  2439
  2440         16  CF-CURRENT-MONTH-END           PIC XX.
  2441
  2442         16  CF-CO-CALC-QUOTE-TOLERANCE.
  2443             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  2444             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  2445             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  2446             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  2447                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2448                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2449             20  CF-CO-PREM-REJECT-SW       PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  44
* NSRLTRBL.cbl
  2450                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  2451                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  2452             20  CF-CO-REF-REJECT-SW        PIC X.
  2453                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  2454                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  2455
  2456         16  CF-CO-REPORTING-DT             PIC XX.
  2457         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  2458         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  2459           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  2460           88  CF-CO-MONTH-END                  VALUE '1'.
  2461
  2462         16  CF-LGX-CLAIM-USER              PIC X.
  2463             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  2464             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  2465
  2466         16  CF-CREDIT-EDIT-CONTROLS.
  2467             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  2468             20  CF-MIN-AGE                 PIC 99.
  2469             20  CF-DEFAULT-AGE             PIC 99.
  2470             20  CF-MIN-TERM                PIC S999      COMP-3.
  2471             20  CF-MAX-TERM                PIC S999      COMP-3.
  2472             20  CF-DEFAULT-SEX             PIC X.
  2473             20  CF-JOINT-AGE-INPUT         PIC X.
  2474                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  2475             20  CF-BIRTH-DATE-INPUT        PIC X.
  2476                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  2477             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  2478                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  2479                 88  CF-ZERO-CARRIER            VALUE '1'.
  2480                 88  CF-ZERO-GROUPING           VALUE '2'.
  2481                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  2482             20  CF-EDIT-SW                 PIC X.
  2483                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  2484             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  2485             20  CF-CR-PR-METHOD            PIC X.
  2486               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  2487               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  2488             20  FILLER                     PIC X.
  2489
  2490         16  CF-CREDIT-MISC-CONTROLS.
  2491             20  CF-REIN-TABLE-SW           PIC X.
  2492                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  2493             20  CF-COMP-TABLE-SW           PIC X.
  2494                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  2495             20  CF-EXPERIENCE-RETENTION-AGE
  2496                                            PIC S9        COMP-3.
  2497             20  CF-CONVERSION-DT           PIC XX.
  2498             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  2499             20  CF-RUN-FREQUENCY-SW        PIC X.
  2500                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  2501                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  2502
  2503             20  CF-CR-CHECK-NO-CONTROL.
  2504                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  2505                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  2506                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  2507                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  45
* NSRLTRBL.cbl
  2508                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  2509                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  2510
  2511                 24  CF-CR-CHECK-COUNT       REDEFINES
  2512                     CF-CR-CHECK-COUNTER      PIC X(4).
  2513
  2514                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  2515                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  2516
  2517                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  2518                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  2519                 24  CF-MAIL-PROCESSING       PIC X.
  2520                     88  MAIL-PROCESSING          VALUE 'Y'.
  2521
  2522         16  CF-MISC-SYSTEM-CONTROL.
  2523             20  CF-SYSTEM-C                 PIC X.
  2524                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  2525             20  CF-SYSTEM-D                 PIC X.
  2526                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  2527             20  CF-SOC-SEC-NO-SW            PIC X.
  2528                 88  SOC-SEC-NO-USED             VALUE '1'.
  2529             20  CF-MEMBER-NO-SW             PIC X.
  2530                 88  MEMBER-NO-USED              VALUE '1'.
  2531             20  CF-TAX-ID-NUMBER            PIC X(11).
  2532             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  2533             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  2534                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  2535                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  2536                 88  CF-ALL-APPROVED             VALUE 'Y'.
  2537                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  2538             20  CF-SYSTEM-E                 PIC X.
  2539                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  2540
  2541         16  CF-LGX-LIFE-USER               PIC X.
  2542             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  2543             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  2544
  2545         16  CF-CR-MONTH-END-DT             PIC XX.
  2546
  2547         16  CF-FILE-MAINT-DATES.
  2548             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  2549                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  2550             20  CF-LAST-BATCH       REDEFINES
  2551                 CF-LAST-BATCH-NO               PIC X(4).
  2552             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  2553             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  2554             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  2555             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  2556             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  2557             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  2558             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  2559             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  2560             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  2561             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  2562
  2563         16  CF-NEXT-COMPANY-ID             PIC XXX.
  2564         16  FILLER                         PIC X.
  2565
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  46
* NSRLTRBL.cbl
  2566         16  CF-ALT-MORT-CODE               PIC X(4).
  2567         16  CF-MEMBER-CAPTION              PIC X(10).
  2568
  2569         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  2570             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  2571             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  2572             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  2573             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  2574             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  2575
  2576         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  2577
  2578         16  CF-LIFE-OVERRIDE-L1            PIC X.
  2579         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  2580         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  2581         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  2582
  2583         16  CF-AH-OVERRIDE-L1              PIC X.
  2584         16  CF-AH-OVERRIDE-L2              PIC XX.
  2585         16  CF-AH-OVERRIDE-L6              PIC X(6).
  2586         16  CF-AH-OVERRIDE-L12             PIC X(12).
  2587
  2588         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  2589         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  2590
  2591         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  2592         16  CF-AR-LAST-EL860-DT            PIC XX.
  2593         16  CF-MP-MONTH-END-DT             PIC XX.
  2594
  2595         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  2596         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  2597             88  CF-CLAIM-PAID-TO               VALUE '1'.
  2598
  2599         16  CF-AR-MONTH-END-DT             PIC XX.
  2600
  2601         16  CF-CRDTCRD-USER                PIC X.
  2602             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  2603             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  2604
  2605         16  CF-CC-MONTH-END-DT             PIC XX.
  2606
  2607         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  2608
  2609         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  2610             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  2611             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  2612             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  2613         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  2614         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  2615         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  2616         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  2617             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  2618             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  2619         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  2620         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  2621         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  2622             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  2623         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  47
* NSRLTRBL.cbl
  2624
  2625         16  CF-CL-ZIP-CODE.
  2626             20  CF-CL-ZIP-PRIME.
  2627                 24  CF-CL-ZIP-1ST          PIC X.
  2628                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  2629                 24  FILLER                 PIC X(4).
  2630             20  CF-CL-ZIP-PLUS4            PIC X(4).
  2631         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  2632             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  2633             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  2634             20  FILLER                     PIC XXX.
  2635
  2636         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  2637         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  2638         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  2639         16  CF-CO-OPTION-START-DATE        PIC XX.
  2640         16  CF-REM-TRM-CALC-OPTION         PIC X.
  2641           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  2642                                                      '3' '4'.
  2643           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  2644           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  2645           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  2646           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  2647           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  2648           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  2649
  2650         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  2651
  2652         16  CF-PAYMENT-APPROVAL-LEVELS.
  2653             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  2654             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  2655             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  2656             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  2657             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  2658             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  2659
  2660         16  CF-END-USER-REPORTING-USER     PIC X.
  2661             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  2662             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  2663
  2664         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  2665             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  2666             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  2667
  2668         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  2669
  2670         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  2671         16  FILLER                         PIC X.
  2672
  2673         16  CF-CREDIT-ARCHIVE-CNTL.
  2674             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  2675             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  2676             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  2677
  2678         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  2679
  2680         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  2681             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  48
* NSRLTRBL.cbl
  2682             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  2683
  2684         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  2685             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  2686             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  2687
  2688         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  2689
  2690         16  CF-CO-ACH-ID-CODE              PIC  X.
  2691             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  2692             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  2693             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  2694         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  2695         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  2696         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  2697         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  2698         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  2699         16  CF-CO-ACH-RECV-NO              PIC X(08).
  2700         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  2701         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  2702         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  2703                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  2704         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  2705                 CF-CO-ACH-TRACE-NO         PIC X(4).
  2706
  2707         16  CF-CO-OVER-SHORT.
  2708             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2709             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2710
  2711*         16  FILLER                         PIC X(102).
  2712         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  2713             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  2714             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  2715
  2716         16  CF-AH-APPROVAL-DAYS.
  2717             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  2718             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  2719             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  2720             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  2721
  2722         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  2723
  2724         16  CF-APPROV-LEV-5.
  2725             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  2726             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  2727             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  2728
  2729         16  FILLER                         PIC X(68).
  2730****************************************************************
  2731*             PROCESSOR/USER RECORD                            *
  2732****************************************************************
  2733
  2734     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2735         16  CF-PROCESSOR-NAME              PIC X(30).
  2736         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  2737         16  CF-PROCESSOR-TITLE             PIC X(26).
  2738         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  2739                 88  MESSAGE-YES                VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  49
* NSRLTRBL.cbl
  2740                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  2741
  2742*****************************************************
  2743****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  2744****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  2745****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  2746****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  2747*****************************************************
  2748
  2749         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  2750             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  2751             20  CF-APPLICATION-FORCE       PIC X.
  2752             20  CF-INDIVIDUAL-APP.
  2753                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  2754                     28  CF-BROWSE-APP      PIC X.
  2755                     28  CF-UPDATE-APP      PIC X.
  2756
  2757         16  CF-CURRENT-TERM-ON             PIC X(4).
  2758         16  CF-PROCESSOR-LIMITS-CLAIMS.
  2759             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  2760             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  2761             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  2762             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  2763             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  2764             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  2765             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  2766         16  CF-PROCESSOR-CARRIER           PIC X.
  2767             88  NO-CARRIER-SECURITY            VALUE ' '.
  2768         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  2769             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  2770         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  2771             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  2772         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  2773             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  2774
  2775         16  CF-PROC-SYS-ACCESS-SW.
  2776             20  CF-PROC-CREDIT-CLAIMS-SW.
  2777                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  2778                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  2779                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  2780                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  2781             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  2782                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  2783                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  2784             20  CF-PROC-LIFE-GNRLDGR-SW.
  2785                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  2786                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  2787                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  2788                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  2789             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  2790                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  2791                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  2792         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  2793             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  2794             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  2795         16  CF-PROCESSOR-PRINTER               PIC X(4).
  2796
  2797         16  CF-APPROVAL-LEVEL                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  50
* NSRLTRBL.cbl
  2798             88  APPROVAL-LEVEL-1                   VALUE '1'.
  2799             88  APPROVAL-LEVEL-2                   VALUE '2'.
  2800             88  APPROVAL-LEVEL-3                   VALUE '3'.
  2801             88  APPROVAL-LEVEL-4                   VALUE '4'.
  2802             88  APPROVAL-LEVEL-5                   VALUE '5'.
  2803
  2804         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  2805
  2806         16  CF-LANGUAGE-TYPE                   PIC X.
  2807             88  CF-LANG-IS-ENG                     VALUE 'E'.
  2808             88  CF-LANG-IS-FR                      VALUE 'F'.
  2809
  2810         16  CF-CSR-IND                         PIC X.
  2811         16  FILLER                             PIC X(239).
  2812
  2813****************************************************************
  2814*             PROCESSOR/REMINDERS RECORD                       *
  2815****************************************************************
  2816
  2817     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  2818         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  2819             20  CF-START-REMIND-DT         PIC XX.
  2820             20  CF-END-REMIND-DT           PIC XX.
  2821             20  CF-REMINDER-TEXT           PIC X(50).
  2822         16  FILLER                         PIC X(296).
  2823
  2824
  2825****************************************************************
  2826*             STATE MASTER RECORD                              *
  2827****************************************************************
  2828
  2829     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2830         16  CF-STATE-ABBREVIATION          PIC XX.
  2831         16  CF-STATE-NAME                  PIC X(25).
  2832         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  2833         16  CF-ST-CALC-QUOTE-TOLERANCE.
  2834             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  2835             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  2836             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  2837             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  2838                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2839                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2840             20  CF-ST-PREM-REJECT-SW       PIC X.
  2841                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  2842                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  2843             20  CF-ST-REF-REJECT-SW        PIC X.
  2844                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  2845                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  2846         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  2847         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  2848         16  CF-ST-REFUND-RULES.
  2849             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  2850             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  2851             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  2852         16  CF-ST-FST-PMT-EXTENSION.
  2853             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  2854             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  2855                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  51
* NSRLTRBL.cbl
  2856                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  2857                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  2858                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  2859         16  CF-ST-STATE-CALL.
  2860             20  CF-ST-CALL-UNEARNED        PIC X.
  2861             20  CF-ST-CALL-RPT-CNTL        PIC X.
  2862             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  2863         16  CF-REPLACEMENT-LAW-SW          PIC X.
  2864             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  2865             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  2866         16  CF-REPLACEMENT-LETTER          PIC X(4).
  2867         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  2868         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  2869         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  2870         16  CF-ST-SPLIT-PAYMENT            PIC X.
  2871         16  FILLER                         PIC X.
  2872         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  2873             20  CF-ST-BENEFIT-CD           PIC XX.
  2874             20  CF-ST-BENEFIT-KIND         PIC X.
  2875                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  2876                 88  CF-ST-AH-KIND              VALUE 'A'.
  2877             20  CF-ST-REM-TERM-CALC        PIC X.
  2878                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  2879                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  2880                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  2881                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  2882                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  2883                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  2884                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  2885                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  2886
  2887             20  CF-ST-REFUND-CALC          PIC X.
  2888                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  2889                 88  ST-REFD-BY-R78             VALUE '1'.
  2890                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  2891                 88  ST-REFD-AS-CALIF           VALUE '3'.
  2892                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  2893                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  2894                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  2895                 88  ST-REFD-UTAH               VALUE '7'.
  2896                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  2897                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  2898                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  2899
  2900             20  CF-ST-EARNING-CALC         PIC X.
  2901                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  2902                 88  ST-EARN-BY-R78             VALUE '1'.
  2903                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  2904                 88  ST-EARN-AS-CALIF           VALUE '3'.
  2905                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  2906                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  2907                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  2908                 88  ST-EARN-MEAN               VALUE '8'.
  2909                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  2910
  2911             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  2912                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  2913                 88  ST-OVRD-BY-R78             VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  52
* NSRLTRBL.cbl
  2914                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  2915                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  2916                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  2917                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  2918                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  2919                 88  ST-OVRD-MEAN               VALUE '8'.
  2920                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  2921             20  cf-st-extra-periods        pic 9.
  2922*            20  FILLER                     PIC X.
  2923
  2924         16  CF-ST-COMMISSION-CAPS.
  2925             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  2926             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  2927             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  2928             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  2929         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  2930                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  2931                 88  ST-LIMIT-TO-GA             VALUE 'G'.
  2932                 88  ST-LIMIT-TO-BOTH           VALUE 'B'.
  2933
  2934         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  2935
  2936         16  CF-ST-STATUTORY-INTEREST.
  2937             20  CF-ST-STAT-DATE-FROM       PIC X.
  2938                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  2939                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  2940             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  2941             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  2942             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  2943             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  2944             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  2945
  2946         16  CF-ST-OVER-SHORT.
  2947             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  2948             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  2949
  2950         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  2951
  2952         16  CF-ST-RT-CALC                  PIC X.
  2953
  2954         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2955         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2956         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2957         16  CF-ST-RF-LR-CALC               PIC X.
  2958         16  CF-ST-RF-LL-CALC               PIC X.
  2959         16  CF-ST-RF-LN-CALC               PIC X.
  2960         16  CF-ST-RF-AH-CALC               PIC X.
  2961         16  CF-ST-RF-CP-CALC               PIC X.
  2962*        16  FILLER                         PIC X(206).
  2963*CIDMOD         16  FILLER                         PIC X(192).
  2964         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  2965             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  2966         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  2967         16  CF-ST-VFY-2ND-BENE             PIC X.
  2968         16  CF-ST-CAUSAL-STATE             PIC X.
  2969         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  2970         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  2971         16  CF-ST-AGENT-SIG-EDIT           PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  53
* NSRLTRBL.cbl
  2972             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  2973         16  CF-ST-NET-ONLY-STATE           PIC X.
  2974             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  2975         16  cf-commission-cap-required     pic x.
  2976         16  CF-ST-GA-COMMISSION-CAPS.
  2977             20  CF-ST-GA-COMM-CAP-SL       PIC S9V9(4) COMP-3.
  2978             20  CF-ST-GA-COMM-CAP-JL       PIC S9V9(4) COMP-3.
  2979             20  CF-ST-GA-COMM-CAP-SA       PIC S9V9(4) COMP-3.
  2980             20  CF-ST-GA-COMM-CAP-JA       PIC S9V9(4) COMP-3.
  2981         16  CF-ST-TOT-COMMISSION-CAPS.
  2982             20  CF-ST-TOT-COMM-CAP-SL      PIC S9V9(4) COMP-3.
  2983             20  CF-ST-TOT-COMM-CAP-JL      PIC S9V9(4) COMP-3.
  2984             20  CF-ST-TOT-COMM-CAP-SA      PIC S9V9(4) COMP-3.
  2985             20  CF-ST-TOT-COMM-CAP-JA      PIC S9V9(4) COMP-3.
  2986         16  FILLER                         PIC X(156).
  2987
  2988****************************************************************
  2989*             BENEFIT MASTER RECORD                            *
  2990****************************************************************
  2991
  2992     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2993         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  2994             20  CF-BENEFIT-CODE            PIC XX.
  2995             20  CF-BENEFIT-NUMERIC  REDEFINES
  2996                 CF-BENEFIT-CODE            PIC XX.
  2997             20  CF-BENEFIT-ALPHA           PIC XXX.
  2998             20  CF-BENEFIT-DESCRIP         PIC X(10).
  2999             20  CF-BENEFIT-COMMENT         PIC X(10).
  3000
  3001             20  CF-LF-COVERAGE-TYPE        PIC X.
  3002                 88  CF-REDUCING                VALUE 'R'.
  3003                 88  CF-LEVEL                   VALUE 'L' 'P'.
  3004
  3005             20  CF-SPECIAL-CALC-CD         PIC X.
  3006                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  3007                 88  CF-NP-0-MO-INT             VALUE 'A'.
  3008                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  3009                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  3010                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  3011                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  3012                 88  CF-FARM-PLAN               VALUE 'F'.
  3013                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  3014                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  3015                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  3016                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  3017                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  3018                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  3019                 88  CF-PRUDENTIAL              VALUE 'P'.
  3020                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  3021                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  3022                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  3023                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  3024                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  3025                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  3026
  3027             20  CF-JOINT-INDICATOR         PIC X.
  3028                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  3029
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  54
* NSRLTRBL.cbl
  3030*            20  FILLER                     PIC X(12).
  3031             20  cf-maximum-benefits        pic s999 comp-3.
  3032             20  FILLER                     PIC X(09).
  3033             20  CF-BENEFIT-CATEGORY        PIC X.
  3034             20  CF-LOAN-TYPE               PIC X(8).
  3035
  3036             20  CF-CO-REM-TERM-CALC        PIC X.
  3037                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  3038                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  3039                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  3040                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  3041                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  3042
  3043             20  CF-CO-EARNINGS-CALC        PIC X.
  3044                 88  CO-EARN-BY-R78             VALUE '1'.
  3045                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  3046                 88  CO-EARN-AS-CALIF           VALUE '3'.
  3047                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  3048                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  3049                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  3050                 88  CO-EARN-AS-MEAN            VALUE '8'.
  3051                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  3052
  3053             20  CF-CO-REFUND-CALC          PIC X.
  3054                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  3055                 88  CO-REFD-BY-R78             VALUE '1'.
  3056                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  3057                 88  CO-REFD-AS-CALIF           VALUE '3'.
  3058                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  3059                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  3060                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  3061                 88  CO-REFD-MEAN               VALUE '8'.
  3062                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  3063                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  3064                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  3065
  3066             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  3067                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  3068                 88  CO-OVRD-BY-R78             VALUE '1'.
  3069                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  3070                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  3071                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  3072                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  3073                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  3074                 88  CO-OVRD-MEAN               VALUE '8'.
  3075                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  3076
  3077             20  CF-CO-BEN-I-G-CD           PIC X.
  3078                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  3079                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  3080                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  3081
  3082         16  FILLER                         PIC X(304).
  3083
  3084
  3085****************************************************************
  3086*             CARRIER MASTER RECORD                            *
  3087****************************************************************
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  55
* NSRLTRBL.cbl
  3088
  3089     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3090         16  CF-ADDRESS-DATA.
  3091             20  CF-MAIL-TO-NAME            PIC X(30).
  3092             20  CF-IN-CARE-OF              PIC X(30).
  3093             20  CF-ADDRESS-LINE-1          PIC X(30).
  3094             20  CF-ADDRESS-LINE-2          PIC X(30).
  3095             20  CF-CITY-STATE              PIC X(30).
  3096             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  3097             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  3098
  3099         16  CF-CLAIM-NO-CONTROL.
  3100             20  CF-CLAIM-NO-METHOD         PIC X.
  3101                 88  CLAIM-NO-MANUAL            VALUE '1'.
  3102                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  3103                 88  CLAIM-NO-SEQ               VALUE '3'.
  3104                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  3105             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  3106                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  3107                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  3108                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  3109
  3110         16  CF-CHECK-NO-CONTROL.
  3111             20  CF-CHECK-NO-METHOD         PIC X.
  3112                 88  CHECK-NO-MANUAL            VALUE '1'.
  3113                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  3114                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  3115                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  3116             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  3117                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  3118
  3119         16  CF-DOMICILE-STATE              PIC XX.
  3120
  3121         16  CF-EXPENSE-CONTROLS.
  3122             20  CF-EXPENSE-METHOD          PIC X.
  3123                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  3124                 88  DOLLARS-PER-PMT            VALUE '2'.
  3125                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  3126                 88  DOLLARS-PER-MONTH          VALUE '4'.
  3127             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  3128             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  3129
  3130         16  CF-CORRESPONDENCE-CONTROL.
  3131             20  CF-LETTER-RESEND-OPT       PIC X.
  3132                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  3133                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  3134             20  FILLER                     PIC X(4).
  3135
  3136         16  CF-RESERVE-CONTROLS.
  3137             20  CF-MANUAL-SW               PIC X.
  3138                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  3139             20  CF-FUTURE-SW               PIC X.
  3140                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  3141             20  CF-PTC-SW                  PIC X.
  3142                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  3143             20  CF-IBNR-SW                 PIC X.
  3144                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  3145             20  CF-PTC-LF-SW               PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  56
* NSRLTRBL.cbl
  3146                 88  CF-LF-PTC-USED             VALUE '1'.
  3147             20  CF-CDT-ACCESS-METHOD       PIC X.
  3148                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  3149                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  3150                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  3151             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  3152
  3153         16  CF-CLAIM-CALC-METHOD           PIC X.
  3154             88  360-PLUS-MONTHS                VALUE '1'.
  3155             88  365-PLUS-MONTHS                VALUE '2'.
  3156             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  3157             88  360-DAILY                      VALUE '4'.
  3158             88  365-DAILY                      VALUE '5'.
  3159
  3160         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  3161         16  FILLER                         PIC X(11).
  3162
  3163         16  CF-LIMIT-AMOUNTS.
  3164             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  3165             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  3166             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  3167             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  3168             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  3169             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  3170             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  3171             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  3172             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  3173             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  3174
  3175         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  3176         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  3177         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  3178
  3179         16  CF-ZIP-CODE.
  3180             20  CF-ZIP-PRIME.
  3181                 24  CF-ZIP-1ST             PIC X.
  3182                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3183                 24  FILLER                 PIC X(4).
  3184             20  CF-ZIP-PLUS4               PIC X(4).
  3185         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  3186             20  CF-CAN-POSTAL-1            PIC XXX.
  3187             20  CF-CAN-POSTAL-2            PIC XXX.
  3188             20  FILLER                     PIC XXX.
  3189
  3190         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  3191         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  3192         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  3193
  3194         16  CF-RATING-SWITCH               PIC X.
  3195             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  3196             88  CF-NO-RATING                   VALUE 'N'.
  3197
  3198         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  3199
  3200         16  CF-CARRIER-OVER-SHORT.
  3201             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3202             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3203
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  57
* NSRLTRBL.cbl
  3204         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  3205         16  CF-SECPAY-SWITCH               PIC X.
  3206             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  3207             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  3208         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  3209         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  3210         16  FILLER                         PIC X(444).
  3211*        16  FILLER                         PIC X(452).
  3212
  3213
  3214****************************************************************
  3215*             MORTALITY MASTER RECORD                          *
  3216****************************************************************
  3217
  3218     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3219         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  3220                                INDEXED BY CF-MORT-NDX.
  3221             20  CF-MORT-TABLE              PIC X(5).
  3222             20  CF-MORT-TABLE-TYPE         PIC X.
  3223                 88  CF-MORT-JOINT              VALUE 'J'.
  3224                 88  CF-MORT-SINGLE             VALUE 'S'.
  3225                 88  CF-MORT-COMBINED           VALUE 'C'.
  3226                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  3227                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  3228             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  3229             20  CF-MORT-AGE-METHOD         PIC XX.
  3230                 88  CF-AGE-LAST                VALUE 'AL'.
  3231                 88  CF-AGE-NEAR                VALUE 'AN'.
  3232             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  3233             20  CF-MORT-ADJUSTMENT-DIRECTION
  3234                                            PIC X.
  3235                 88  CF-MINUS                   VALUE '-'.
  3236                 88  CF-PLUS                    VALUE '+'.
  3237             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  3238             20  CF-MORT-JOINT-CODE         PIC X.
  3239                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  3240             20  CF-MORT-PC-Q               PIC X.
  3241                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  3242             20  CF-MORT-TABLE-CODE         PIC X(4).
  3243             20  CF-MORT-COMMENTS           PIC X(15).
  3244             20  FILLER                     PIC X(14).
  3245
  3246         16  FILLER                         PIC X(251).
  3247
  3248
  3249****************************************************************
  3250*             BUSSINESS TYPE MASTER RECORD                     *
  3251****************************************************************
  3252
  3253     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3254* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  3255* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  3256* AND RECORD 05 IS TYPES 81-99
  3257         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  3258             20  CF-BUSINESS-TITLE          PIC  X(19).
  3259             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  3260                                            PIC S9V9(4) COMP-3.
  3261             20  CF-BUS-EXCL-ST-CALL        PIC  X.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  58
* NSRLTRBL.cbl
  3262             20  FILLER                     PIC  X.
  3263         16  FILLER                         PIC  X(248).
  3264
  3265
  3266****************************************************************
  3267*             TERMINAL MASTER RECORD                           *
  3268****************************************************************
  3269
  3270     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3271
  3272         16  CF-COMPANY-TERMINALS.
  3273             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  3274                                  PIC X(4).
  3275         16  FILLER               PIC X(248).
  3276
  3277
  3278****************************************************************
  3279*             LIFE EDIT MASTER RECORD                          *
  3280****************************************************************
  3281
  3282     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3283         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  3284             20  CF-LIFE-CODE-IN            PIC XX.
  3285             20  CF-LIFE-CODE-OUT           PIC XX.
  3286         16  FILLER                         PIC X(248).
  3287
  3288
  3289****************************************************************
  3290*             AH EDIT MASTER RECORD                            *
  3291****************************************************************
  3292
  3293     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3294         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  3295             20  CF-AH-CODE-IN              PIC XXX.
  3296             20  CF-AH-CODE-OUT             PIC XX.
  3297         16  FILLER                         PIC X(248).
  3298
  3299
  3300****************************************************************
  3301*             CREDIBILITY TABLES                               *
  3302****************************************************************
  3303
  3304     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3305         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  3306                             INDEXED BY CF-CRDB-NDX.
  3307             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  3308             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  3309             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  3310         16  FILLER                         PIC  X(332).
  3311
  3312
  3313****************************************************************
  3314*             REPORT CUSTOMIZATION RECORD                      *
  3315****************************************************************
  3316
  3317     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  3318         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  3319             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  59
* NSRLTRBL.cbl
  3320             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  3321             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  3322**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  3323****       A T-TRANSFER.                                   ****
  3324             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  3325
  3326         16  FILLER                         PIC XX.
  3327
  3328         16  CF-CARRIER-CNTL-OPT.
  3329             20  CF-CARRIER-OPT-SEQ         PIC 9.
  3330                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  3331                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  3332             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  3333                                            PIC X.
  3334         16  CF-GROUP-CNTL-OPT.
  3335             20  CF-GROUP-OPT-SEQ           PIC 9.
  3336                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  3337                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  3338             20  CF-GROUP-SELECT OCCURS 3 TIMES
  3339                                            PIC X(6).
  3340         16  CF-STATE-CNTL-OPT.
  3341             20  CF-STATE-OPT-SEQ           PIC 9.
  3342                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  3343                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  3344             20  CF-STATE-SELECT OCCURS 3 TIMES
  3345                                            PIC XX.
  3346         16  CF-ACCOUNT-CNTL-OPT.
  3347             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  3348                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  3349                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  3350             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  3351                                            PIC X(10).
  3352         16  CF-BUS-TYP-CNTL-OPT.
  3353             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  3354                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  3355                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  3356             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  3357                                            PIC XX.
  3358         16  CF-LF-TYP-CNTL-OPT.
  3359             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  3360                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  3361                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  3362             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  3363                                            PIC XX.
  3364         16  CF-AH-TYP-CNTL-OPT.
  3365             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  3366                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  3367                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  3368             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  3369                                            PIC XX.
  3370         16  CF-REPTCD1-CNTL-OPT.
  3371             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  3372                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  3373                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  3374             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  3375                                            PIC X(10).
  3376         16  CF-REPTCD2-CNTL-OPT.
  3377             20  CF-REPTCD2-OPT-SEQ         PIC 9.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  60
* NSRLTRBL.cbl
  3378                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  3379                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  3380             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  3381                                            PIC X(10).
  3382         16  CF-USER1-CNTL-OPT.
  3383             20  CF-USER1-OPT-SEQ           PIC 9.
  3384                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  3385                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  3386             20  CF-USER1-SELECT OCCURS 3 TIMES
  3387                                            PIC X(10).
  3388         16  CF-USER2-CNTL-OPT.
  3389             20  CF-USER2-OPT-SEQ           PIC 9.
  3390                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  3391                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  3392             20  CF-USER2-SELECT OCCURS 3 TIMES
  3393                                            PIC X(10).
  3394         16  CF-USER3-CNTL-OPT.
  3395             20  CF-USER3-OPT-SEQ           PIC 9.
  3396                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  3397                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  3398             20  CF-USER3-SELECT OCCURS 3 TIMES
  3399                                            PIC X(10).
  3400         16  CF-USER4-CNTL-OPT.
  3401             20  CF-USER4-OPT-SEQ           PIC 9.
  3402                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  3403                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  3404             20  CF-USER4-SELECT OCCURS 3 TIMES
  3405                                            PIC X(10).
  3406         16  CF-USER5-CNTL-OPT.
  3407             20  CF-USER5-OPT-SEQ           PIC 9.
  3408                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  3409                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  3410             20  CF-USER5-SELECT OCCURS 3 TIMES
  3411                                            PIC X(10).
  3412         16  CF-REINS-CNTL-OPT.
  3413             20  CF-REINS-OPT-SEQ           PIC 9.
  3414                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  3415                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  3416             20  CF-REINS-SELECT OCCURS 3 TIMES.
  3417                 24  CF-REINS-PRIME         PIC XXX.
  3418                 24  CF-REINS-SUB           PIC XXX.
  3419
  3420         16  CF-AGENT-CNTL-OPT.
  3421             20  CF-AGENT-OPT-SEQ           PIC 9.
  3422                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  3423                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  3424             20  CF-AGENT-SELECT OCCURS 3 TIMES
  3425                                            PIC X(10).
  3426
  3427         16  FILLER                         PIC X(43).
  3428
  3429         16  CF-LOSS-RATIO-SELECT.
  3430             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  3431             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  3432         16  CF-ENTRY-DATE-SELECT.
  3433             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  3434             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  3435         16  CF-EFFECTIVE-DATE-SELECT.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  61
* NSRLTRBL.cbl
  3436             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  3437             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  3438
  3439         16  CF-EXCEPTION-LIST-IND          PIC X.
  3440             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  3441
  3442         16  FILLER                         PIC X(318).
  3443
  3444****************************************************************
  3445*                  EXCEPTION REPORTING RECORD                  *
  3446****************************************************************
  3447
  3448     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  3449         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  3450             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  3451
  3452         16  CF-COMBINED-LIFE-AH-OPT.
  3453             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  3454             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  3455             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  3456             20  CF-CANCELLATION-RATIO      PIC S9(02).
  3457
  3458         16  CF-LIFE-OPT.
  3459             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3460             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3461             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3462             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3463             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3464             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3465             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3466             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3467             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3468             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  3469
  3470         16  CF-AH-OPT.
  3471             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3472             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3473             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3474             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3475             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3476             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3477             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3478             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3479             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3480             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  3481
  3482         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  3483             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  3484             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  3485             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  3486
  3487         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  3488
  3489         16  FILLER                         PIC X(673).
  3490
  3491
  3492****************************************************************
  3493*             MORTGAGE SYSTEM PLAN RECORD                      *
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  62
* NSRLTRBL.cbl
  3494****************************************************************
  3495
  3496     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  3497         16  CF-PLAN-TYPE                   PIC X.
  3498             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  3499             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  3500             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  3501         16  CF-PLAN-ABBREV                 PIC XXX.
  3502         16  CF-PLAN-DESCRIPT               PIC X(10).
  3503         16  CF-PLAN-NOTES                  PIC X(20).
  3504         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  3505         16  CF-PLAN-UNDERWRITING.
  3506             20  CF-PLAN-TERM-DATA.
  3507                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  3508                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  3509             20  CF-PLAN-AGE-DATA.
  3510                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  3511                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  3512                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  3513             20  CF-PLAN-BENEFIT-DATA.
  3514                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3515                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3516                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  3517                                            PIC S9(7)V99  COMP-3.
  3518         16  CF-PLAN-POLICY-FORMS.
  3519             20  CF-POLICY-FORM             PIC X(12).
  3520             20  CF-MASTER-APPLICATION      PIC X(12).
  3521             20  CF-MASTER-POLICY           PIC X(12).
  3522         16  CF-PLAN-RATING.
  3523             20  CF-RATE-CODE               PIC X(5).
  3524             20  CF-SEX-RATING              PIC X.
  3525                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  3526                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  3527             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  3528             20  CF-SUB-STD-TYPE            PIC X.
  3529                 88  CF-PCT-OF-PREM            VALUE '1'.
  3530                 88  CF-PCT-OF-BENE            VALUE '2'.
  3531         16  CF-PLAN-PREM-TOLERANCES.
  3532             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  3533             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  3534         16  CF-PLAN-PYMT-TOLERANCES.
  3535             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  3536             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  3537         16  CF-PLAN-MISC-DATA.
  3538             20  FILLER                     PIC X.
  3539             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  3540             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  3541         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  3542         16  CF-PLAN-IND-GRP                PIC X.
  3543             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  3544                                                     '1'.
  3545             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  3546                                                     '2'.
  3547         16  CF-MIB-SEARCH-SW               PIC X.
  3548             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  3549             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  3550             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  3551             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  63
* NSRLTRBL.cbl
  3552         16  CF-ALPHA-SEARCH-SW             PIC X.
  3553             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  3554             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  3555             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  3556             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  3557             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  3558             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  3559             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  3560             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  3561             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  3562             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  3563                                                     'A' 'B' 'C'
  3564                                                     'X' 'Y' 'Z'.
  3565         16  CF-EFF-DT-RULE-SW              PIC X.
  3566             88  CF-EFF-DT-ENTER               VALUE 'E'.
  3567             88  CF-EFF-DT-MONTH               VALUE 'M'.
  3568             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  3569             88  CF-EFF-DT-SEMI                VALUE 'S'.
  3570             88  CF-EFF-DT-ANN                 VALUE 'A'.
  3571         16  FILLER                         PIC X(4).
  3572         16  CF-HEALTH-QUESTIONS            PIC X.
  3573             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  3574         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  3575         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  3576         16  CF-PLAN-SNGL-JNT               PIC X.
  3577             88  CF-COMBINED-PLAN              VALUE 'C'.
  3578             88  CF-JNT-PLAN                   VALUE 'J'.
  3579             88  CF-SNGL-PLAN                  VALUE 'S'.
  3580         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  3581         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  3582         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  3583         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  3584         16  CF-RERATE-CNTL                 PIC  X.
  3585             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  3586             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  3587             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  3588             88  CF-AUTO-RECALC                 VALUE '4'.
  3589         16  CF-BENEFIT-TYPE                PIC  X.
  3590             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  3591             88  CF-BENEFIT-REDUCES             VALUE '2'.
  3592         16  CF-POLICY-FEE                  PIC S999V99
  3593                                                    COMP-3.
  3594         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  3595         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  3596         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  3597         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  3598         16  FILLER                         PIC  X(32).
  3599         16  CF-TERMINATION-FORM            PIC  X(04).
  3600         16  FILLER                         PIC  X(08).
  3601         16  CF-CLAIM-CAP                   PIC S9(7)V99
  3602                                                       COMP-3.
  3603         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  3604         16  CF-ISSUE-LETTER                PIC  X(4).
  3605         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  3606         16  CF-DEPENDENT-COVERAGE          PIC  X.
  3607             88  CF-YES-DEP-COV                 VALUE 'Y'.
  3608             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  3609         16  CF-MP-REFUND-CALC              PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  64
* NSRLTRBL.cbl
  3610             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  3611             88  CF-MP-REFD-BY-R78              VALUE '1'.
  3612             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  3613             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  3614             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  3615             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  3616             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  3617             88  CF-MP-REFD-MEAN                VALUE '8'.
  3618         16  CF-ALT-RATE-CODE               PIC  X(5).
  3619
  3620
  3621         16  FILLER                         PIC X(498).
  3622****************************************************************
  3623*             MORTGAGE COMPANY MASTER RECORD                   *
  3624****************************************************************
  3625
  3626     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3627         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  3628         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  3629             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  3630             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  3631             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  3632             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  3633             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  3634
  3635         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  3636         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  3637         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  3638         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  3639         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  3640
  3641         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  3642             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  3643         16  CF-MP-RECON-USE-IND            PIC X(1).
  3644             88  CF-MP-USE-RECON             VALUE 'Y'.
  3645         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  3646             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  3647         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  3648             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  3649             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  3650         16  FILLER                         PIC X(1).
  3651         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  3652             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  3653         16  CF-MORTG-MIB-VERSION           PIC X.
  3654             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  3655             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  3656             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  3657         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  3658             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  3659                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  3660             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  3661                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  3662             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  3663                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  3664             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  3665                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  3666             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  3667                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  65
* NSRLTRBL.cbl
  3668             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  3669                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  3670         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  3671         16  FILLER                         PIC X(7).
  3672         16  CF-MORTG-DESTINATION-SYMBOL.
  3673             20  CF-MORTG-MIB-COMM          PIC X(5).
  3674             20  CF-MORTG-MIB-TERM          PIC X(5).
  3675         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  3676             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  3677         16  FILLER                         PIC X(03).
  3678         16  CF-MP-CHECK-NO-CONTROL.
  3679             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  3680                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  3681                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  3682                                                ' ' LOW-VALUES.
  3683                 88  CF-MP-CHECK-NO-PRE-PRINTED
  3684                                               VALUE '3'.
  3685         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  3686         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  3687         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  3688             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  3689                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  3690             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  3691                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  3692             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  3693                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  3694             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  3695                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  3696             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  3697                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  3698             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  3699                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  3700         16  CF-MORTG-BILLING-AREA.
  3701             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  3702                                            PIC X.
  3703         16  CF-MORTG-MONTH-END-DT          PIC XX.
  3704         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  3705         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  3706         16  CF-MORTG-MIB-DEST-SW           PIC X.
  3707             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  3708             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  3709         16  FILLER                         PIC X.
  3710         16  CF-MORTG-LABEL-CONTROL         PIC X.
  3711             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  3712             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  3713         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  3714         16  FILLER                         PIC X(8).
  3715         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  3716         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  3717         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  3718         16  CF-ACH-COMPANY-ID.
  3719             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  3720                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  3721                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  3722                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  3723             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  3724         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  3725             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  66
* NSRLTRBL.cbl
  3726         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  3727             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  3728             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  3729         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  3730         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  3731         16  FILLER                         PIC X(536).
  3732
  3733****************************************************************
  3734*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  3735****************************************************************
  3736
  3737     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  3738         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  3739             20  CF-FEMALE-HEIGHT.
  3740                 24  CF-FEMALE-FT           PIC 99.
  3741                 24  CF-FEMALE-IN           PIC 99.
  3742             20  CF-FEMALE-MIN-WT           PIC 999.
  3743             20  CF-FEMALE-MAX-WT           PIC 999.
  3744         16  FILLER                         PIC X(428).
  3745
  3746     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  3747         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  3748             20  CF-MALE-HEIGHT.
  3749                 24  CF-MALE-FT             PIC 99.
  3750                 24  CF-MALE-IN             PIC 99.
  3751             20  CF-MALE-MIN-WT             PIC 999.
  3752             20  CF-MALE-MAX-WT             PIC 999.
  3753         16  FILLER                         PIC X(428).
  3754******************************************************************
  3755*             AUTOMATIC ACTIVITY RECORD                          *
  3756******************************************************************
  3757     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  3758         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  3759             20  CF-SYS-ACTIVE-SW           PIC X(01).
  3760             20  CF-SYS-LETTER-ID           PIC X(04).
  3761             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  3762             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  3763             20  CF-SYS-RESET-SW            PIC X(01).
  3764             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  3765             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  3766
  3767         16  FILLER                         PIC X(50).
  3768
  3769         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  3770             20  CF-USER-ACTIVE-SW          PIC X(01).
  3771             20  CF-USER-LETTER-ID          PIC X(04).
  3772             20  CF-USER-RESEND-DAYS        PIC 9(03).
  3773             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  3774             20  CF-USER-RESET-SW           PIC X(01).
  3775             20  CF-USER-REPORT-DAYS        PIC 9(03).
  3776             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  3777             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  3778
  3779         16  FILLER                         PIC X(246).
  3780*                                COPY NSCVARS.
  3781******************************************************************
  3782*                   C H A N G E   L O G
  3783*
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  67
* NSRLTRBL.cbl
  3784* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3785*-----------------------------------------------------------------
  3786*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3787* EFFECTIVE    NUMBER
  3788*-----------------------------------------------------------------
  3789* 031912    2011110200002  AJRA  AHL CLAIM NUM
  3790* 013013    2012110080002  AJRA  ADD ACCOUNT GPCD
  3791* 031116    2015110400001  TANA  ADD EL150D FIELDS
  3792* 061217    2017060900001  TANA  INCREASE ATTACHMENTS FIELD SIZE
  3793* 071719    2019011600010  TANA  ADD VERIF CODE
  3794******************************************************************
  3795 01 NAPER-OUTPUT-DATA.
  3796    05 FILLER              PIC X(6) VALUE "TEMPL=".
  3797    05 OUT-TEMP            PIC X(4).
  3798    05 FILLER              PIC X(8) VALUE "&LETTER=".
  3799    05 OUT-LETTER          PIC X(4).
  3800    05 FILLER              PIC X(6) VALUE "&CARR=".
  3801    05 OUT-CARR            PIC X.
  3802    05 FILLER              PIC X(7) VALUE "&CLMNO=".
  3803    05 OUT-CLMNO           PIC X(7).
  3804    05 FILLER              PIC X(7) VALUE "&CRTNO=".
  3805    05 OUT-CRTNO           PIC X(11).
  3806    05 FILLER              PIC X(7) VALUE "&ACTNO=".
  3807    05 OUT-ACTNO           PIC X(10).
  3808    05 FILLER              PIC X(8) VALUE "&ILNAME=".
  3809    05 OUT-ILNAME          PIC X(15).
  3810    05 FILLER              PIC X(8) VALUE "&IFNAME=".
  3811    05 OUT-IFNAME          PIC X(10).
  3812    05 FILLER              PIC X(7) VALUE "&SEXCD=".
  3813    05 OUT-SEX-CD          PIC X.
  3814    05 FILLER              PIC X(5) VALUE "&SSN=".
  3815    05 OUT-SSN             PIC X(11).
  3816    05 FILLER              PIC X(9) VALUE "&CLMSTAT=".
  3817    05 OUT-CLMSTAT         PIC X.
  3818    05 FILLER              PIC X(8) VALUE "&CLMTYP=".
  3819    05 OUT-CLMTYPE         PIC X.
  3820    05 FILLER              PIC X(7) VALUE "&ESTDT=".
  3821    05 OUT-EST-DT          PIC X(21).
  3822    05 FILLER              PIC X(7) VALUE "&INCDT=".
  3823    05 OUT-INC-DT          PIC X(21).
  3824    05 FILLER              PIC X(7) VALUE "&RPTDT=".
  3825    05 OUT-RPT-DT          PIC X(21).
  3826    05 FILLER              PIC X(10) VALUE "&PDTHRUDT=".
  3827    05 OUT-PD-THRU-DT      PIC X(21).
  3828    05 FILLER              PIC X(11) VALUE "&FORMDUEDT=".
  3829    05 OUT-FORM-DUE-DT     PIC X(21).
  3830    05 FILLER              PIC X(8) VALUE "&LPMTDT=".
  3831    05 OUT-LST-PMT-DT      PIC X(21).
  3832    05 FILLER              PIC X(8) VALUE "&NOPMTS=".
  3833    05 OUT-NO-OF-PMTS      PIC X(10).
  3834    05 FILLER              PIC X(9) VALUE "&TOTPAID=".
  3835    05 OUT-TOT-PAID        PIC 9999999.99.
  3836    05 FILLER              PIC X(8) VALUE "&LPDAMT=".
  3837    05 OUT-LST-PD-AMT      PIC 9999999.99.
  3838    05 FILLER              PIC X(9) VALUE "&ADDRCNT=".
  3839    05 OUT-ADDR-CNT        PIC 9.
  3840    05 FILLER              PIC X(7) VALUE "&CRTST=".
  3841    05 OUT-CRT-ST          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  68
* NSRLTRBL.cbl
  3842    05 FILLER              PIC X(10) VALUE "&CERTACCT=".
  3843    05 OUT-CERTACCT        PIC X(10).
  3844    05 FILLER              PIC X(7) VALUE "&EFFDT=".
  3845    05 OUT-EFF-DT          PIC X(21).
  3846    05 FILLER              PIC X(8) VALUE "&LMNTDT=".
  3847    05 OUT-LST-MAINT-DT    PIC X(21).
  3848    05 FILLER              PIC X(10) VALUE "&LMNTUSER=".
  3849    05 OUT-LST-MAINT-USER  PIC X(10).
  3850    05 FILLER              PIC X(10) VALUE "&LMNTTYPE=".
  3851    05 OUT-LST-MAINT-TYPE  PIC X(10).
  3852    05 FILLER              PIC X(6) VALUE "&DIAG=".
  3853    05 OUT-DIAG            PIC X(66).
  3854    05 FILLER              PIC X(7) VALUE "&EXPDT=".
  3855    05 OUT-EXP-DT          PIC X(21).
  3856    05 FILLER              PIC X(12) VALUE "&LCLSREASON=".
  3857    05 OUT-LST-CLS-REA     PIC X(10).
  3858    05 FILLER              PIC X(8) VALUE "&BRTHDT=".
  3859    05 OUT-BIRTH-DT        PIC X(21).
  3860    05 FILLER              PIC X(6) VALUE "&TERM=".
  3861    05 OUT-TERM            PIC 999.
  3862    05 FILLER              PIC X(7) VALUE "&BENCD=".
  3863    05 OUT-BEN-CD          PIC XX.
  3864    05 FILLER              PIC X(8) VALUE "&BENAMT=".
  3865    05 OUT-BENAMT          PIC 9999999.99.
  3866    05 FILLER              PIC X(9) VALUE "&CRITPER=".
  3867    05 OUT-CRIT-PER        PIC 999.
  3868    05 FILLER              PIC X(9) VALUE "&WAITPER=".
  3869    05 OUT-WAIT-PER        PIC XX.
  3870    05 FILLER              PIC X(11)  VALUE "&LFINTRATE=".
  3871    05 OUT-LF-INT-RATE     PIC 99.99999.
  3872    05 FILLER              PIC X(10) VALUE "&AUTOPYDT=".
  3873    05 OUT-AUTO-PY-DT      PIC X(21).
  3874    05 FILLER              PIC X(12) VALUE "&AUTOSCHEND=".
  3875    05 OUT-AUTO-SCHD-END   PIC X(21).
  3876    05 FILLER              PIC X(8) VALUE "&LOANNO=".
  3877    05 OUT-LOAN-NO         PIC X(25).
  3878    05 FILLER              PIC X(5) VALUE "&APR=".
  3879    05 OUT-APR             PIC 99.99999.
  3880    05 FILLER              PIC X(8) VALUE "&LACTDT=".
  3881    05 OUT-LST-ACT-DT      PIC X(21).
  3882    05 FILLER              PIC X(7) VALUE "&ACTDT=".
  3883    05 OUT-ACT-DT          PIC X(21).
  3884    05 FILLER              PIC X(10) VALUE "&LACTTYPE=".
  3885    05 OUT-LST-ACT-TYPE    PIC X(15).
  3886    05 FILLER              PIC X(9) VALUE "&ACTTYPE=".
  3887    05 OUT-ACT-TYPE        PIC X(15).
  3888    05 FILLER              PIC X(6) VALUE "&FORM=".
  3889    05 OUT-FORM            PIC X(4).
  3890    05 FILLER              PIC X(9) VALUE "&INSNAME=".
  3891    05 OUT-INS-NAME        PIC X(36).
  3892    05 FILLER              PIC X(10) VALUE "&INSADDR1=".
  3893    05 OUT-INS-ADDR1       PIC X(36).
  3894    05 FILLER              PIC X(10) VALUE "&INSADDR2=".
  3895    05 OUT-INS-ADDR2       PIC X(36).
  3896    05 FILLER              PIC X(9) VALUE "&INSCITY=".
  3897    05 OUT-INS-CITY        PIC X(28).
  3898    05 FILLER              PIC X(10) VALUE "&INSSTATE=".
  3899    05 OUT-INS-STATE       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  69
* NSRLTRBL.cbl
  3900    05 FILLER              PIC X(8) VALUE "&INSZIP=".
  3901    05 OUT-INS-ZIP         PIC X(10).
  3902    05 FILLER              PIC X(10) VALUE "&INSPHONE=".
  3903    05 OUT-INS-PHONE       PIC X(13).
  3904    05 FILLER              PIC X(10) VALUE "&BENENAME=".
  3905    05 OUT-BEN-NAME        PIC X(32).
  3906    05 FILLER              PIC X(11) VALUE "&BENEADDR1=".
  3907    05 OUT-BEN-ADDR1       PIC X(36).
  3908    05 FILLER              PIC X(11) VALUE "&BENEADDR2=".
  3909    05 OUT-BEN-ADDR2       PIC X(32).
  3910    05 FILLER              PIC X(10) VALUE "&BENECITY=".
  3911    05 OUT-BEN-CITY        PIC X(28).
  3912    05 FILLER              PIC X(11) VALUE "&BENESTATE=".
  3913    05 OUT-BEN-STATE       PIC XX.
  3914    05 FILLER              PIC X(9) VALUE "&BENEZIP=".
  3915    05 OUT-BEN-ZIP         PIC X(10).
  3916    05 FILLER              PIC X(11) VALUE "&BENEPHONE=".
  3917    05 OUT-BEN-PHONE       PIC X(13).
  3918    05 FILLER              PIC X(8) VALUE "&OANAME=".
  3919    05 OUT-ORIG-NAME       PIC X(32).
  3920    05 FILLER              PIC X(10) VALUE "&ACCTNAME=".
  3921    05 OUT-ACCT-NAME       PIC X(32).
  3922    05 FILLER              PIC X(11) VALUE "&ACCTADDR1=".
  3923    05 OUT-ACCT-ADDR1      PIC X(36).
  3924    05 FILLER              PIC X(11) VALUE "&ACCTADDR2=".
  3925    05 OUT-ACCT-ADDR2      PIC X(32).
  3926    05 FILLER              PIC X(10) VALUE "&ACCTCITY=".
  3927    05 OUT-ACCT-CITY       PIC X(30).
  3928    05 FILLER              PIC X(11) VALUE "&ACCTSTATE=".
  3929    05 OUT-ACCT-STATE      PIC XX.
  3930    05 FILLER              PIC X(9)  VALUE "&ACCTZIP=".
  3931    05 OUT-ACCT-ZIP        PIC X(10).
  3932    05 FILLER              PIC X(11) VALUE "&ACCTPHONE=".
  3933    05 OUT-ACCT-PHONE      PIC X(13).
  3934    05 FILLER              PIC X(7) VALUE "&ENCCD=".
  3935    05 OUT-ENC-CODE        PIC XXX.
  3936    05 FILLER              PIC X(7) VALUE "&ENCST=".
  3937    05 OUT-ENC-ST          PIC XX.
  3938    05 FILLER              PIC X(8) VALUE "&ARCHNO=".
  3939    05 OUT-ARCHNO          PIC 999999999.
  3940    05 FILLER              PIC X(11) VALUE "&FLTRPRTDT=".
  3941    05 OUT-1ST-LTR-PRT-DT  PIC X(21).
  3942    05 FILLER              PIC X(11) VALUE "&NEXTDUEDT=".
  3943    05 OUT-NEXT-DUE-DT     PIC X(21).
  3944    05 FILLER              PIC X(8) VALUE "&JLNAME=".
  3945    05 OUT-JLNAME          PIC X(15).
  3946    05 FILLER              PIC X(8) VALUE "&JFNAME=".
  3947    05 OUT-JFNAME          PIC X(10).
  3948    05 FILLER              PIC X(9)  VALUE "&ENCLINE=".
  3949    05 OUT-ENCLINE         PIC X(100).
  3950    05 FILLER              PIC X(9) VALUE "&ENCATTS=".
  3951    05 OUT-ENCATTS         PIC X(255).
  3952    05 FILLER              PIC X(10) VALUE "&OUTSTACK=".
  3953    05 OUT-OUTSTACK        PIC X.
  3954    05 FILLER              PIC X(8) VALUE "&PROCID=".
  3955    05 OUT-PROCID          PIC XXXX.
  3956    05 FILLER              PIC X(8) VALUE "&COMPID=".
  3957    05 OUT-COMPID          PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  70
* NSRLTRBL.cbl
  3958    05 FILLER              PIC X(8) VALUE "&PRTNOW=".
  3959    05 OUT-PRINT-NOW-SW    PIC X.
  3960    05 FILLER              PIC X(11) VALUE "&CYCLEDATE=".
  3961    05 OUT-CYCLE-DATE      PIC X(8).
  3962    05 FILLER              PIC X(11) VALUE "&ENCSTNAME=".
  3963    05 OUT-ENC-ST-NAME     PIC XX.
  3964    05 FILLER              PIC X(10) VALUE "&CARRIDLU=".
  3965    05 OUT-CARR-LU         PIC X.
  3966    05 FILLER              PIC X(5)  VALUE "&CCN=".
  3967    05 OUT-AHL-CLAIM-NO    PIC X(9).
  3968    05 FILLER              PIC X(4) VALUE "&GP=".
  3969    05 OUT-ACCT-GPCD       PIC 99.
  3970    05 FILLER              PIC X(9) VALUE "&MAXBENS=".
  3971    05 OUT-MAX-BENS        PIC 9(3).
  3972    05 FILLER              PIC X(10) VALUE "&PAIDBENS=".
  3973    05 OUT-PAID-BENS       PIC 9(3).
  3974    05 FILLER              PIC X(9) VALUE "&REMBENS=".
  3975    05 OUT-REM-BENS        PIC 9(3).
  3976    05 FILLER              PIC X(9) VALUE "&EXCLPER=".
  3977    05 OUT-EXCL-PER        PIC 9(3).
  3978    05 FILLER              PIC X(8) VALUE "&RECMOS=".
  3979    05 OUT-REC-MOS         PIC 9(2).
  3980    05 FILLER              PIC X(8) VALUE "&INSTYP=".
  3981    05 OUT-INS-TYP         PIC X(4).
  3982    05 FILLER              PIC X(8) VALUE "&BENPER=".
  3983    05 OUT-BEN-PER         PIC 9(2).
  3984    05 FILLER              PIC X(7) VALUE "&ACCSW=".
  3985    05 OUT-ACC-SW          PIC X.
  3986    05 FILLER              PIC X(7) VALUE "&VERCD=".
  3987    05 OUT-VER-CD          PIC X(5).
  3988 01  FILLER                      PIC X(500)  VALUE SPACES.
  3989*                                COPY ELCNAPS.
  3990******************************************************************
  3991*                                                                *
  3992*                            ELCNAPS                             *
  3993*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3994*                            VMOD=2.003                          *
  3995*                                                                *
  3996*        FILE DESCRIPTION = NAPERSOFT LETTER FILE                *
  3997*                                                                *
  3998*        FILE TYPE= VSAM,KSDS                                    *
  3999*        RECORD SIZE = 150    RECFORM = FIXED                    *
  4000*                                                                *
  4001*        BASE CLUSTER = ELNAPS        RKP=2,LEN=28               *
  4002*                                                                *
  4003*        LOG = YES                                               *
  4004*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  4005*                                                                *
  4006******************************************************************
  4007*                   C H A N G E   L O G
  4008*
  4009* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4010*-----------------------------------------------------------------
  4011*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4012* EFFECTIVE    NUMBER
  4013*-----------------------------------------------------------------
  4014* 033110  CR2009122800001  AJRA  NEW FILE FOR NAPERSOFT.
  4015******************************************************************
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  71
* NSRLTRBL.cbl
  4016
  4017 01  NAPERSOFT-FILE.
  4018     12  NA-RECORD-ID                PIC  XX.
  4019         88  VALID-NA-ID                  VALUE 'NA'.
  4020
  4021     12  NA-CONTROL-PRIMARY.
  4022         16  NA-COMPANY-CD           PIC X.
  4023         16  NA-CARRIER              PIC X.
  4024         16  NA-CLAIM-NO             PIC X(7).
  4025         16  NA-CERT-NO.
  4026             20  NA-CERT-PRIME       PIC X(10).
  4027             20  NA-CERT-SFX         PIC X.
  4028         16  NA-ARCHIVE-NO           PIC 9(8).
  4029
  4030     12  NA-LETTER-INFORMATION.
  4031         16  NA-LETTER-ID            PIC X(4).
  4032         16  NA-PROCESSOR-ID         PIC X(4).
  4033         16  NA-CREATION-DT          PIC X(2).
  4034         16  NA-INITIAL-PRINT-DT     PIC X(2).
  4035         16  NA-FOLLOW-UP-DT         PIC X(2).
  4036         16  NA-RESEND-DT            PIC X(2).
  4037         16  NA-RESEND-LETTER-ID     PIC X(4).
  4038         16  NA-NO-OF-COPIES         PIC 9(2).
  4039         16  NA-ADDRESS-TYPE         PIC X(2).
  4040         16  NA-CORR-TRLR-SEQ        PIC 9(4).
  4041         16  NA-RESEND-PRINT-DT      PIC X(2).
  4042         16  NA-1ST-LTR-PRINT-DT     PIC X(2).
  4043         16  NA-NEXT-DUE-DT          PIC X(2).
  4044         16  NA-AUTOPYDT             PIC X(2).
  4045         16  NA-ENCLOSURE-CD         PIC X(3).
  4046         16  NA-CREATED-IN-NAPERSOFT PIC X(1).
  4047         16  NA-ORIG-ARCHIVE-NO      PIC 9(9).
  4048         16  NA-RESEND-PROMPT-IND    PIC X(1).
  4049         16  NA-ORIG-ENCLOSURE-CD    PIC X(3).
  4050         16  FILLER                  PIC X(67).
  4051******************************************************************
  4052*                                COPY ELCENCC.
  4053******************************************************************
  4054*                                                                *
  4055*                                                                *
  4056*                            ELCENCC                             *
  4057*                            VMOD=2.001                          *
  4058*                                                                *
  4059*   CLAIM SYSTEM ENCLOSURE CODE TABLE                            *
  4060*                                                                *
  4061*   THIS COPYBOOK IS USED FOR THE ONLINE PROCESS OF CREATING     *
  4062*   A NAPERSOFT DOCUMENT                                         *
  4063*                                                                *
  4064*   FILE DESCRIPTION = ENCLOSURE CODE TABLE                      *
  4065*                                                                *
  4066*   FILE TYPE = VSAM,KSDS                                        *
  4067*   RECORD SIZE = 400   RECFORM = FIX                            *
  4068*                                                                *
  4069*   BASE CLUSTER NAME = ELENCC                    RKP=2,LEN=16   *
  4070*                                                                *
  4071*   LOG = NO                                                     *
  4072*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4073*                                                                *
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  72
* NSRLTRBL.cbl
  4074*                                                                *
  4075******************************************************************
  4076*                   C H A N G E   L O G
  4077*
  4078* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4079*-----------------------------------------------------------------
  4080*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4081* EFFECTIVE    NUMBER
  4082*-----------------------------------------------------------------
  4083* 082010    2008100900001  PEMA  NEW COPYBOOK/FILE
  4084* 061217    2017060900001  TANA  INCREASE ATTACHMENTS FIELD SIZE
  4085******************************************************************
  4086 01  ENCLOSURE-CODES.
  4087     12  NC-RECORD-ID                      PIC XX.
  4088         88  VALID-NC-ID                      VALUE 'NC'.
  4089     12  NC-CONTROL-PRIMARY.
  4090         16  NC-COMPANY-CD                 PIC X.
  4091         16  NC-REC-TYPE                   PIC X.
  4092             88  NC-CLAIMS                   VALUE '1'.
  4093             88  NC-ADMIN                    VALUE '2'.
  4094         16  NC-ENC-CODE                   PIC X(5).
  4095         16  FILLER                        PIC X(09).
  4096     12  NC-MAINT-INFORMATION.
  4097         16  NC-LAST-MAINT-DT              PIC XX.
  4098         16  NC-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  4099         16  NC-LAST-MAINT-USER            PIC X(4).
  4100         16  FILLER                        PIC XX.
  4101     12  NC-OUTPUT-STACK                   PIC XXX.
  4102     12  NC-ENCLOSURE-LINE                 PIC X(100).
  4103     12  NC-ATTACHMENTS                    PIC X(255).
  4104     12  NC-FUTURE                         PIC X(12).
  4105******************************************************************
  4106*                                COPY ELCCRTT.
  4107******************************************************************
  4108*                                                                *
  4109*                            ELCCRTT.                            *
  4110*                                                                *
  4111*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  4112*                                                                *
  4113*   FILE TYPE = VSAM,KSDS                                        *
  4114*   RECORD SIZE = 552  RECFORM = FIXED                           *
  4115*                                                                *
  4116*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  4117*                                                                *
  4118*   LOG = YES                                                    *
  4119*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4120******************************************************************
  4121*                   C H A N G E   L O G
  4122*
  4123* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4124*-----------------------------------------------------------------
  4125*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4126* EFFECTIVE    NUMBER
  4127*-----------------------------------------------------------------
  4128* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  4129* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  4130* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  4131* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  73
* NSRLTRBL.cbl
  4132* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  4133* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  4134* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  4135* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  4136* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  4137* 012918  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
  4138* 091318  CR2018073000001  PEMA  ADD Refund methods
  4139* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  4140******************************************************************
  4141
  4142 01  CERTIFICATE-TRAILERS.
  4143     12  CS-RECORD-ID                      PIC XX.
  4144         88  VALID-CS-ID                      VALUE 'CS'.
  4145
  4146     12  CS-CONTROL-PRIMARY.
  4147         16  CS-COMPANY-CD                 PIC X.
  4148         16  CS-CARRIER                    PIC X.
  4149         16  CS-GROUPING                   PIC X(6).
  4150         16  CS-STATE                      PIC XX.
  4151         16  CS-ACCOUNT                    PIC X(10).
  4152         16  CS-CERT-EFF-DT                PIC XX.
  4153         16  CS-CERT-NO.
  4154             20  CS-CERT-PRIME             PIC X(10).
  4155             20  CS-CERT-SFX               PIC X.
  4156         16  CS-TRAILER-TYPE               PIC X.
  4157             88  COMM-TRLR           VALUE 'A'.
  4158             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  4159             88  CERT-DATA-TRLR      VALUE 'C'.
  4160
  4161     12  CS-DATA-AREA                      PIC X(516).
  4162
  4163     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  4164         16  CS-BANK-COMMISSION-AREA.
  4165             20  CS-BANK-COMMS       OCCURS 10.
  4166                 24  CS-AGT                PIC X(10).
  4167                 24  CS-COM-TYP            PIC X.
  4168                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  4169                 24  CS-RECALC-LV-INDIC    PIC X.
  4170                 24  FILLER                PIC X(10).
  4171         16  FILLER                        PIC X(256).
  4172
  4173     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  4174****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  4175         16  CS-MB-CLAIM-DATA OCCURS 24.
  4176             20  CS-CLAIM-NO               PIC X(7).
  4177             20  CS-CLAIM-TYPE             PIC X.
  4178                 88  CS-AH-CLM               VALUE 'A'.
  4179                 88  CS-IU-CLM               VALUE 'I'.
  4180                 88  CS-GP-CLM               VALUE 'G'.
  4181                 88  CS-LF-CLM               VALUE 'L'.
  4182                 88  CS-PR-CLM               VALUE 'P'.
  4183                 88  CS-FL-CLM               VALUE 'F'.
  4184                 88  CS-OT-CLM               VALUE 'O'.
  4185             20  CS-INSURED-TYPE           PIC X.
  4186                 88  CS-PRIM-INSURED          VALUE 'P'.
  4187                 88  CS-CO-BORROWER           VALUE 'C'.
  4188             20  CS-BENEFIT-PERIOD         PIC 99.
  4189             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  74
* NSRLTRBL.cbl
  4190             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  4191             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  4192         16  FILLER                        PIC X(12).
  4193     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  4194         16  CS-VIN-NUMBER                 PIC X(17).
  4195         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  4196         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  4197         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  4198         16  cs-agent-name.
  4199             20  cs-agent-fname            pic x(20).
  4200             20  cs-agent-mi               pic x.
  4201             20  cs-agent-lname            pic x(25).
  4202         16  cs-license-no                 pic x(15).
  4203         16  cs-npn-number                 pic x(10).
  4204         16  cs-agent-edit-status          pic x.
  4205             88  cs-ae-refer-to-manager      value 'M'.
  4206             88  cs-ae-cover-sheet           value 'C'.
  4207             88  cs-ae-sig-form              value 'S'.
  4208             88  cs-ae-verified              value 'V'.
  4209             88  cs-unidentified-signature   value 'U'.
  4210             88  cs-cert-returned            value 'R'.
  4211             88  cs-accept-no-commission     value 'N'.
  4212         16  cs-year                       pic 9999.
  4213         16  cs-make                       pic x(20).
  4214         16  cs-model                      pic x(20).
  4215         16  cs-future                     pic x(20).
  4216         16  cs-vehicle-odometer           pic s9(7) comp-3.
  4217         16  cs-claim-verification-status  pic x.
  4218             88  cs-clm-ver-eligible         value 'A'.
  4219             88  cs-clm-ver-partial-elig     value 'B'.
  4220             88  cs-clm-ver-not-eligible     value 'C'.
  4221             88  cs-clm-ver-not-elig-opn-clm value 'D'.
  4222             88  cs-clm-ver-not-part-elig-rw value 'E'.
  4223             88  cs-clm-ver-ND-CERT          value 'F'.
  4224             88  cs-clm-ver-spec-other       value 'G'.
  4225             88  cs-clam-ver-pratial-corrected
  4226                                             value 'H'.
  4227             88  cs-clm-ver-no-matches       value 'I'.
  4228             88  cs-clm-ver-not-elig-corrected
  4229                                             value 'J'.
  4230             88  cs-clm-ver-needs-review     value 'R'.
  4231             88  cs-clm-ver-sent-to-claims   value 'W'.
  4232         16  CS-LF-REFUND-METHOD           PIC X.
  4233         16  CS-AH-REFUND-METHOD           PIC X.
  4234         16  FILLER                        PIC X(353). *> was 420
  4235*        16  FILLER                        PIC X(496).
  4236*                                COPY ERCPDEF.
  4237******************************************************************
  4238*                                                                *
  4239*                                                                *
  4240*                            ERCPDEF.                            *
  4241*                                                                *
  4242*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  4243*                                                                *
  4244*    FILE TYPE = VSAM,KSDS                                       *
  4245*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  4246*                                                                *
  4247*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  75
* NSRLTRBL.cbl
  4248*                                                                *
  4249*    LOG = YES                                                   *
  4250*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4251******************************************************************
  4252*                   C H A N G E   L O G
  4253*
  4254* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4255*-----------------------------------------------------------------
  4256*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4257* EFFECTIVE    NUMBER
  4258*-----------------------------------------------------------------
  4259* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  4260* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  4261* 100314  CR2014061900001  PEMA  ADD PCT OF BENEFIT
  4262* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  4263******************************************************************
  4264 01  PRODUCT-MASTER.
  4265    12  PD-RECORD-ID                 PIC X(02).
  4266        88  VALID-PD-ID                  VALUE 'PD'.
  4267    12  PD-CONTROL-PRIMARY.
  4268        16  PD-COMPANY-CD            PIC X.
  4269        16  PD-STATE                 PIC XX.
  4270        16  PD-PRODUCT-CD            PIC XXX.
  4271        16  PD-FILLER                PIC X(7).
  4272        16  PD-BEN-TYPE              PIC X.
  4273        16  PD-BEN-CODE              PIC XX.
  4274        16  PD-PROD-EXP-DT           PIC XX.
  4275    12  FILLER                       PIC X(50).
  4276    12  PD-PRODUCT-DATA OCCURS 8.
  4277        16  PD-PROD-CODE             PIC X.
  4278            88  PD-PROD-LIFE           VALUE 'L'.
  4279            88  PD-PROD-PROP           VALUE 'P'.
  4280            88  PD-PROD-AH             VALUE 'A'.
  4281            88  PD-PROD-IU             VALUE 'I'.
  4282            88  PD-PROD-GAP            VALUE 'G'.
  4283            88  PD-PROD-FAML           VALUE 'F'.
  4284            88  PD-PROD-OTH            VALUE 'O'.
  4285        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  4286        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  4287        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  4288        16  PD-MAX-TERM              PIC S999        COMP-3.
  4289        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  4290        16  FILLER                   PIC X.
  4291        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  4292        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  4293        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  4294        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  4295        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  4296        16  PD-REC-CRIT-PERIOD       PIC 99.
  4297        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  4298            20  PD-RECURRING-YN      PIC X.
  4299            20  FILLER               PIC X.
  4300        16  PD-RTW-MOS               PIC 99.
  4301        16  PD-MAX-EXTENSION         PIC 99.
  4302        16  pd-ben-pct               pic sv999 comp-3.
  4303*       16  FILLER                   PIC XX.
  4304    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  4305    12  PD-TERM-LIMITS OCCURS 15.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  76
* NSRLTRBL.cbl
  4306        16  PD-LOW-TERM              PIC S999        COMP-3.
  4307        16  PD-HI-TERM               PIC S999        COMP-3.
  4308*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  4309    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  4310        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  4311        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  4312    12  PD-EARN-FACTORS.
  4313        16  FILLER OCCURS 15.
  4314            20  FILLER OCCURS 15.
  4315                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  4316    12  PD-PRODUCT-DESC              PIC X(80).
  4317    12  PD-TRUNCATED                 PIC X.
  4318    12  FILLER                       PIC X(59).
  4319    12  PD-MAINT-INFORMATION.
  4320        16  PD-LAST-MAINT-DT         PIC X(02).
  4321        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  4322        16  PD-LAST-MAINT-BY         PIC X(04).
  4323****************************************************************
  4324*
  4325* Copyright (c) 2007-2013 Dell Inc.
  4326* All rights reserved.
  4327*
  4328****************************************************************
  4329 01  DFHEIV.
  4330   02  DFHEIV0               PIC X(35).
  4331   02  DFHEIV1               PIC X(08).
  4332   02  DFHEIV2               PIC X(08).
  4333   02  DFHEIV3               PIC X(08).
  4334   02  DFHEIV4               PIC X(06).
  4335   02  DFHEIV5               PIC X(04).
  4336   02  DFHEIV6               PIC X(04).
  4337   02  DFHEIV7               PIC X(02).
  4338   02  DFHEIV8               PIC X(02).
  4339   02  DFHEIV9               PIC X(01).
  4340   02  DFHEIV10              PIC S9(7) COMP-3.
  4341   02  DFHEIV11              PIC S9(4) COMP SYNC.
  4342   02  DFHEIV12              PIC S9(4) COMP SYNC.
  4343   02  DFHEIV13              PIC S9(4) COMP SYNC.
  4344   02  DFHEIV14              PIC S9(4) COMP SYNC.
  4345   02  DFHEIV15              PIC S9(4) COMP SYNC.
  4346   02  DFHEIV16              PIC S9(9) COMP SYNC.
  4347   02  DFHEIV17              PIC X(04).
  4348   02  DFHEIV18              PIC X(04).
  4349   02  DFHEIV19              PIC X(04).
  4350   02  DFHEIV20              USAGE IS POINTER.
  4351   02  DFHEIV21              USAGE IS POINTER.
  4352   02  DFHEIV22              USAGE IS POINTER.
  4353   02  DFHEIV23              USAGE IS POINTER.
  4354   02  DFHEIV24              USAGE IS POINTER.
  4355   02  DFHEIV25              PIC S9(9) COMP SYNC.
  4356   02  DFHEIV26              PIC S9(9) COMP SYNC.
  4357   02  DFHEIV27              PIC S9(9) COMP SYNC.
  4358   02  DFHEIV28              PIC S9(9) COMP SYNC.
  4359   02  DFHEIV29              PIC S9(9) COMP SYNC.
  4360   02  DFHEIV30              PIC S9(9) COMP SYNC.
  4361   02  DFHEIV31              PIC S9(9) COMP SYNC.
  4362   02  DFHEIV32              PIC S9(4) COMP SYNC.
  4363   02  DFHEIV33              PIC S9(4) COMP SYNC.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  77
* NSRLTRBL.cbl
  4364   02  DFHEIV34              PIC S9(4) COMP SYNC.
  4365   02  DFHEIV35              PIC S9(4) COMP SYNC.
  4366   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  4367   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  4368   02  FILLER                PIC X(02).
  4369   02  DFHEIV99              PIC X(08) VALUE SPACE.
  4370   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  4371   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  4372   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  4373   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  4374   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  4375   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  4376 LINKAGE  SECTION.
  4377*****************************************************************
  4378*                                                               *
  4379* Copyright (c) 2007-2013 Dell Inc.                             *
  4380* All rights reserved.                                          *
  4381*                                                               *
  4382*****************************************************************
  4383 01  dfheiblk.
  4384     02  eibtime          pic s9(7) comp-3.
  4385     02  eibdate          pic s9(7) comp-3.
  4386     02  eibtrnid         pic x(4).
  4387     02  eibtaskn         pic s9(7) comp-3.
  4388     02  eibtrmid         pic x(4).
  4389     02  dfheigdi         pic s9(4) comp.
  4390     02  eibcposn         pic s9(4) comp.
  4391     02  eibcalen         pic s9(4) comp.
  4392     02  eibaid           pic x(1).
  4393     02  eibfiller1       pic x(1).
  4394     02  eibfn            pic x(2).
  4395     02  eibfiller2       pic x(2).
  4396     02  eibrcode         pic x(6).
  4397     02  eibfiller3       pic x(2).
  4398     02  eibds            pic x(8).
  4399     02  eibreqid         pic x(8).
  4400     02  eibrsrce         pic x(8).
  4401     02  eibsync          pic x(1).
  4402     02  eibfree          pic x(1).
  4403     02  eibrecv          pic x(1).
  4404     02  eibsend          pic x(1).
  4405     02  eibatt           pic x(1).
  4406     02  eibeoc           pic x(1).
  4407     02  eibfmh           pic x(1).
  4408     02  eibcompl         pic x(1).
  4409     02  eibsig           pic x(1).
  4410     02  eibconf          pic x(1).
  4411     02  eiberr           pic x(1).
  4412     02  eibrldbk         pic x(1).
  4413     02  eiberrcd         pic x(4).
  4414     02  eibsynrb         pic x(1).
  4415     02  eibnodat         pic x(1).
  4416     02  eibfiller5       pic x(2).
  4417     02  eibresp          pic s9(8) comp.
  4418     02  eibresp2         pic s9(8) comp.
  4419     02  dfheigdj         pic s9(4) comp.
  4420     02  dfheigdk         pic s9(4) comp.
  4421 01 dfhcommarea.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  78
* NSRLTRBL.cbl
  4422*                                copy ELCLTRSPI.
  4423******************************************************************
  4424*                   C H A N G E   L O G
  4425*
  4426* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4427*-----------------------------------------------------------------
  4428*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4429* EFFECTIVE    NUMBER
  4430*-----------------------------------------------------------------
  4431* 121802    2009122800001  PEMA  NEW COPYBOOK
  4432******************************************************************
  4433****************************************
  4434*  commarea for NaperSoft On Demand Claim letters
  4435*  (business logic input & output)
  4436****************************************
  4437     03  BL-INPUT.
  4438         05  BL-CARRIER          PIC X.
  4439         05  BL-CLAIM-NO         PIC X(7).
  4440         05  BL-CERT-NO          PIC X(11).
  4441         05  BL-LETTER-ID        PIC XXXX.
  4442         05  BL-FOLLOW-UP-DT     PIC X(10).
  4443         05  BL-RESEND-DT        PIC X(10).
  4444         05  BL-NO-OF-COPIES     PIC 99.
  4445         05  BL-PROC-ID          PIC XXXX.
  4446         05  BL-COMP-ID          PIC XXX.
  4447         05  BL-PRINT-NOW-SW     PIC X.
  4448         05  BL-ENC-CD           PIC XXX.
  4449         05  BL-ARCHIVE-NO       PIC 9(8).
  4450         05  BL-REGARDING        PIC X(70).
  4451     03  BL-OUTPUT.
  4452         05  BL-STATUS                   PIC X.
  4453             88  BL-OK                      VALUE "P".
  4454             88  BL-FAIL                  VALUE "F".
  4455         05  BL-MESSAGE          PIC X(50).
  4456     03  BL-RECORD-PASSED-DATA   PIC X(2500).
  4457 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA.
  4458 0000-DFHEXIT SECTION.
  4459     MOVE '9#                    $   ' TO DFHEIV0.
  4460     MOVE 'NSRLTRBL' TO DFHEIV1.
  4461     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  4462     MOVE EIBDATE                TO DC-JULIAN-YYDDD
  4463     MOVE '5'                    TO DC-OPTION-CODE
  4464     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  4465     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE
  4466     MOVE DC-GREG-DATE-A-EDIT    TO WS-SAVE-EDIT-A-DATE
  4467     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE
  4468*****************************************************
  4469* The full claim key has been established and passed
  4470* to this program via NSREQLTR
  4471*****************************************************
  4472     INITIALIZE NAPER-OUTPUT-DATA
  4473     IF BL-COMP-ID = 'DCC'
  4474        MOVE X'05'               TO WS-ELMSTR-COMPANY-CD
  4475     ELSE
  4476       IF BL-COMP-ID = 'AHL'
  4477        MOVE X'06'               TO WS-ELMSTR-COMPANY-CD
  4478       ELSE
  4479        MOVE X'04'               TO WS-ELMSTR-COMPANY-CD
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  79
* NSRLTRBL.cbl
  4480       END-IF
  4481     END-IF
  4482     MOVE BL-CARRIER             TO WS-ELMSTR-CARRIER
  4483     MOVE BL-CLAIM-NO            TO WS-ELMSTR-CLAIM-NO
  4484     MOVE BL-CERT-NO             TO WS-ELMSTR-CERT-NO
  4485     SET BL-FAIL TO TRUE
  4486
  4487* EXEC CICS READ
  4488*         DATASET    ('ELMSTR')
  4489*         INTO       (CLAIM-MASTER)
  4490*         RIDFLD     (WS-ELMSTR-KEY)
  4491*         RESP       (WS-RESPONSE)
  4492*    END-EXEC.
  4493     MOVE LENGTH OF
  4494      CLAIM-MASTER
  4495       TO DFHEIV11
  4496     MOVE 'ELMSTR' TO DFHEIV1
  4497*    MOVE '&"IL       E          (  N#00004482' TO DFHEIV0
  4498     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  4499     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4500     MOVE X'204E233030303034343832' TO DFHEIV0(25:11)
  4501     CALL 'kxdfhei1' USING DFHEIV0,
  4502           DFHEIV1,
  4503           CLAIM-MASTER,
  4504           DFHEIV11,
  4505           WS-ELMSTR-KEY,
  4506           DFHEIV99,
  4507           DFHEIV99,
  4508           DFHEIV99
  4509     MOVE EIBRESP  TO WS-RESPONSE
  4510     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4511
  4512     IF RESP-NORMAL
  4513        MOVE BL-LETTER-ID        TO OUT-TEMP
  4514                                    OUT-LETTER
  4515        MOVE BL-PROC-ID          TO OUT-PROCID
  4516        MOVE BL-COMP-ID          TO OUT-COMPID
  4517        MOVE BL-PRINT-NOW-SW     TO OUT-PRINT-NOW-SW
  4518        MOVE CL-CARRIER          TO OUT-CARR
  4519                                    OUT-CARR-LU
  4520        MOVE CL-INSURED-LAST-NAME
  4521                                 TO OUT-ILNAME
  4522        MOVE CL-INSURED-1ST-NAME TO OUT-IFNAME
  4523        MOVE CL-CLAIM-NO         TO OUT-CLMNO
  4524        MOVE CL-CERT-NO          TO OUT-CRTNO
  4525        MOVE CL-CERT-ACCOUNT     TO OUT-ACTNO
  4526        MOVE CL-SOC-SEC-NO       TO OUT-SSN
  4527        MOVE CL-CLAIM-STATUS     TO OUT-CLMSTAT
  4528        MOVE CL-CCN (1:9)        TO OUT-AHL-CLAIM-NO
  4529        MOVE WS-SAVE-EDIT-A-DATE TO DC-GREG-DATE-A-EDIT
  4530        STRING DC-EDITA-CCYY  DC-EDITA-MONTH DC-EDITA-DAY
  4531          DELIMITED BY SIZE INTO OUT-CYCLE-DATE
  4532        END-STRING
  4533*       IF CLAIM-IS-CLOSED
  4534*          MOVE 'CLOSED'         TO OUT-CLMSTAT
  4535*       ELSE
  4536*          MOVE 'OPEN'           TO OUT-CLMSTAT
  4537*       END-IF
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  80
* NSRLTRBL.cbl
  4538        MOVE CL-CLAIM-TYPE       TO OUT-CLMTYPE
  4539        MOVE CL-FILE-ESTABLISH-DT
  4540                                 TO DC-BIN-DATE-1
  4541        MOVE ' '                 TO DC-OPTION-CODE
  4542        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  4543        IF NO-CONVERSION-ERROR
  4544           STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  4545              DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  4546              INTO OUT-EST-DT
  4547           END-STRING
  4548        ELSE
  4549           MOVE SPACES           TO OUT-EST-DT
  4550        END-IF
  4551        MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
  4552        MOVE ' '                 TO DC-OPTION-CODE
  4553        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  4554        IF NO-CONVERSION-ERROR
  4555           STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  4556              DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  4557              INTO OUT-PD-THRU-DT
  4558           END-STRING
  4559        ELSE
  4560           MOVE SPACES           TO OUT-PD-THRU-DT
  4561        END-IF
  4562        MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
  4563        MOVE +0                  TO DC-ELAPSED-MONTHS
  4564        MOVE +30                 TO DC-ELAPSED-DAYS
  4565        MOVE '6'                 TO DC-OPTION-CODE
  4566        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  4567        IF NO-CONVERSION-ERROR
  4568           STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  4569              DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  4570              INTO OUT-FORM-DUE-DT
  4571           END-STRING
  4572        ELSE
  4573           MOVE SPACES           TO OUT-FORM-DUE-DT
  4574        END-IF
  4575        MOVE CL-TOTAL-PAID-AMT   TO OUT-TOT-PAID
  4576        MOVE CL-INSURED-SEX-CD   TO OUT-SEX-CD
  4577        MOVE CL-CERT-STATE       TO OUT-CRT-ST
  4578                                    OUT-ENC-ST
  4579                                    OUT-ENC-ST-NAME
  4580        MOVE CL-CERT-EFF-DT      TO DC-BIN-DATE-1
  4581        MOVE ' '                 TO DC-OPTION-CODE
  4582        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  4583        IF NO-CONVERSION-ERROR
  4584           STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  4585              DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  4586              INTO OUT-EFF-DT
  4587           END-STRING
  4588        ELSE
  4589           MOVE SPACES           TO OUT-EFF-DT
  4590        END-IF
  4591        MOVE CL-INCURRED-DT      TO DC-BIN-DATE-1
  4592        MOVE ' '                 TO DC-OPTION-CODE
  4593        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  4594        IF NO-CONVERSION-ERROR
  4595           STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  81
* NSRLTRBL.cbl
  4596              DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  4597              INTO OUT-INC-DT
  4598           END-STRING
  4599        ELSE
  4600           MOVE SPACES           TO OUT-INC-DT
  4601        END-IF
  4602        MOVE CL-REPORTED-DT      TO DC-BIN-DATE-1
  4603        MOVE ' '                 TO DC-OPTION-CODE
  4604        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  4605        IF NO-CONVERSION-ERROR
  4606           STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  4607              DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  4608              INTO OUT-RPT-DT
  4609           END-STRING
  4610        ELSE
  4611           MOVE SPACES           TO OUT-RPT-DT
  4612        END-IF
  4613        MOVE CL-LAST-PMT-DT      TO DC-BIN-DATE-1
  4614        MOVE ' '                 TO DC-OPTION-CODE
  4615        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  4616        IF NO-CONVERSION-ERROR
  4617           STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  4618              DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  4619              INTO OUT-LST-PMT-DT
  4620           END-STRING
  4621        ELSE
  4622           MOVE SPACES           TO OUT-LST-PMT-DT
  4623        END-IF
  4624        MOVE CL-INSURED-BIRTH-DT TO DC-BIN-DATE-1
  4625        MOVE ' '                 TO DC-OPTION-CODE
  4626        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  4627        IF NO-CONVERSION-ERROR
  4628           STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  4629              DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  4630              INTO OUT-BIRTH-DT
  4631           END-STRING
  4632        ELSE
  4633           MOVE SPACES           TO OUT-BIRTH-DT
  4634        END-IF
  4635        MOVE CL-LAST-MAINT-DT    TO DC-BIN-DATE-1
  4636        MOVE ' '                 TO DC-OPTION-CODE
  4637        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  4638        IF NO-CONVERSION-ERROR
  4639           STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  4640              DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  4641              INTO OUT-LST-MAINT-DT
  4642           END-STRING
  4643        ELSE
  4644           MOVE SPACES           TO OUT-LST-MAINT-DT
  4645        END-IF
  4646        MOVE CL-LAST-MAINT-USER  TO OUT-LST-MAINT-USER
  4647        MOVE CL-LAST-MAINT-TYPE  TO OUT-LST-MAINT-TYPE
  4648        MOVE CL-NO-OF-PMTS-MADE  TO OUT-NO-OF-PMTS
  4649        MOVE CL-LAST-PMT-AMT     TO OUT-LST-PD-AMT
  4650        MOVE CL-ACCOUNT-ADDR-CNT TO OUT-ADDR-CNT
  4651        MOVE CL-LAST-CLOSE-REASON TO OUT-LST-CLS-REA
  4652        MOVE BL-ENC-CD           TO OUT-ENC-CODE
  4653        PERFORM 1000-GET-FILES   THRU 1000-EXIT
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  82
* NSRLTRBL.cbl
  4654        PERFORM 1800-SET-EL150D-FIELDS THRU 1800-EXIT
  4655        MOVE FUNCTION REVERSE(CL-CLAIM-NO(3:5)) TO OUT-VER-CD
  4656        SET BL-OK TO TRUE
  4657     END-IF
  4658     IF BL-OK
  4659        PERFORM 1500-GET-ARCH-NO THRU 1500-EXIT
  4660        MOVE WS-ARCHIVE-NO       TO OUT-ARCHNO
  4661        PERFORM 0500-SCRUB-DATA  THRU 0500-EXIT
  4662        MOVE NAPER-OUTPUT-DATA   TO BL-RECORD-PASSED-DATA
  4663*       PERFORM 1600-ADD-CORR-TRLR
  4664*                                THRU 1600-EXIT
  4665     END-IF
  4666
  4667* exec cics return end-exec.
  4668*    MOVE '.(                    ''   #00004642' TO DFHEIV0
  4669     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  4670     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4671     MOVE X'2020233030303034363432' TO DFHEIV0(25:11)
  4672     CALL 'kxdfhei1' USING DFHEIV0,
  4673           DFHEIV99,
  4674           DFHEIV99,
  4675           DFHEIV99,
  4676           DFHEIV99,
  4677           DFHEIV99,
  4678           DFHEIV99
  4679     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4680
  4681 0500-SCRUB-DATA.
  4682*   THE DECODER DOES NOT LIKE & AND I TRIED TO USE
  4683*   A DIFFERENT DELIMITER IN PROGRAM NSREQLTR BUT
  4684*   COULD NOT GET IT TO WORK SO I AM CONVERTING IT
  4685*   TO A HEX 26 TO GET BY THE DECODER
  4686     MOVE FUNCTION LENGTH(OUT-ILNAME)
  4687                                 TO M1
  4688     MOVE SPACES                 TO WS-WORK-FIELD
  4689     perform varying a1 from +1 by +1 until a1 > m1
  4690        if out-ilname (a1:1) = '&'
  4691           MOVE OUT-ILNAME (1:A1 - 1)
  4692                                 TO WS-WORK-FIELD (1:A1 - 1)
  4693           MOVE '%26'            TO WS-WORK-FIELD (A1:3)
  4694           MOVE OUT-ILNAME (A1 + 1:M1 - A1)
  4695                                 TO WS-WORK-FIELD (A1 + 3:M1 - A1)
  4696           MOVE WS-WORK-FIELD    TO OUT-ILNAME
  4697           add +2 to a1
  4698        end-if
  4699     end-perform
  4700     MOVE FUNCTION LENGTH(OUT-ACCT-ADDR1)
  4701                                 TO M1
  4702     MOVE SPACES                 TO WS-WORK-FIELD
  4703     perform varying a1 from +1 by +1 until a1 > m1
  4704        if out-acct-addr1 (a1:1) = '&'
  4705           MOVE out-acct-addr1 (1:A1 - 1)
  4706                                 TO WS-WORK-FIELD (1:A1 - 1)
  4707           MOVE '%26'            TO WS-WORK-FIELD (A1:3)
  4708           MOVE out-acct-addr1 (A1 + 1:M1 - A1)
  4709                                 TO WS-WORK-FIELD (A1 + 3:M1 - A1)
  4710           MOVE WS-WORK-FIELD    TO out-acct-addr1
  4711           add +2 to a1
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  83
* NSRLTRBL.cbl
  4712        end-if
  4713     end-perform
  4714     MOVE FUNCTION LENGTH(OUT-ACCT-ADDR2)
  4715                                 TO M1
  4716     MOVE SPACES                 TO WS-WORK-FIELD
  4717     perform varying a1 from +1 by +1 until a1 > m1
  4718        if out-acct-addr2 (a1:1) = '&'
  4719           MOVE out-acct-addr2 (1:A1 - 1)
  4720                                 TO WS-WORK-FIELD (1:A1 - 1)
  4721           MOVE '%26'            TO WS-WORK-FIELD (A1:3)
  4722           MOVE out-acct-addr2 (A1 + 1:M1 - A1)
  4723                                 TO WS-WORK-FIELD (A1 + 3:M1 - A1)
  4724           MOVE WS-WORK-FIELD    TO out-acct-addr2
  4725           add +2 to a1
  4726        end-if
  4727     end-perform
  4728     MOVE FUNCTION LENGTH(OUT-ACCT-CITY)
  4729                                 TO M1
  4730     MOVE SPACES                 TO WS-WORK-FIELD
  4731     perform varying a1 from +1 by +1 until a1 > m1
  4732        if out-acct-city (a1:1) = '&'
  4733           MOVE out-acct-city (1:A1 - 1)
  4734                                 TO WS-WORK-FIELD (1:A1 - 1)
  4735           MOVE '%26'            TO WS-WORK-FIELD (A1:3)
  4736           MOVE out-acct-city (A1 + 1:M1 - A1)
  4737                                 TO WS-WORK-FIELD (A1 + 3:M1 - A1)
  4738           MOVE WS-WORK-FIELD    TO out-acct-city
  4739           add +2 to a1
  4740        end-if
  4741     end-perform
  4742     MOVE FUNCTION LENGTH(OUT-ACCT-NAME)
  4743                                 TO M1
  4744     MOVE SPACES                 TO WS-WORK-FIELD
  4745     perform varying a1 from +1 by +1 until a1 > m1
  4746        if out-acct-name (a1:1) = '&'
  4747           MOVE out-acct-name (1:A1 - 1)
  4748                                 TO WS-WORK-FIELD (1:A1 - 1)
  4749           MOVE '%26'            TO WS-WORK-FIELD (A1:3)
  4750           MOVE out-acct-name (A1 + 1:M1 - A1)
  4751                                 TO WS-WORK-FIELD (A1 + 3:M1 - A1)
  4752           MOVE WS-WORK-FIELD    TO out-acct-name
  4753           add +2 to a1
  4754        end-if
  4755     end-perform
  4756     MOVE FUNCTION LENGTH(OUT-ORIG-NAME)
  4757                                 TO M1
  4758     MOVE SPACES                 TO WS-WORK-FIELD
  4759     perform varying a1 from +1 by +1 until a1 > m1
  4760        if out-orig-name (a1:1) = '&'
  4761           MOVE out-orig-name (1:A1 - 1)
  4762                                 TO WS-WORK-FIELD (1:A1 - 1)
  4763           MOVE '%26'            TO WS-WORK-FIELD (A1:3)
  4764           MOVE out-orig-name (A1 + 1:M1 - A1)
  4765                                 TO WS-WORK-FIELD (A1 + 3:M1 - A1)
  4766           MOVE WS-WORK-FIELD    TO out-orig-name
  4767           add +2 to a1
  4768        end-if
  4769     end-perform
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  84
* NSRLTRBL.cbl
  4770     MOVE FUNCTION LENGTH(OUT-INS-NAME)
  4771                                 TO M1
  4772     MOVE SPACES                 TO WS-WORK-FIELD
  4773     perform varying a1 from +1 by +1 until a1 > m1
  4774        if out-ins-name (a1:1) = '&'
  4775           MOVE out-ins-name (1:A1 - 1)
  4776                                 TO WS-WORK-FIELD (1:A1 - 1)
  4777           MOVE '%26'            TO WS-WORK-FIELD (A1:3)
  4778           MOVE out-ins-name (A1 + 1:M1 - A1)
  4779                                 TO WS-WORK-FIELD (A1 + 3:M1 - A1)
  4780           MOVE WS-WORK-FIELD    TO out-ins-name
  4781           add +2 to a1
  4782        end-if
  4783     end-perform
  4784     MOVE FUNCTION LENGTH(OUT-INS-ADDR1)
  4785                                 TO M1
  4786     MOVE SPACES                 TO WS-WORK-FIELD
  4787     perform varying a1 from +1 by +1 until a1 > m1
  4788        if out-ins-addr1 (a1:1) = '&'
  4789           MOVE out-ins-addr1 (1:A1 - 1)
  4790                                 TO WS-WORK-FIELD (1:A1 - 1)
  4791           MOVE '%26'            TO WS-WORK-FIELD (A1:3)
  4792           MOVE out-ins-addr1 (A1 + 1:M1 - A1)
  4793                                 TO WS-WORK-FIELD (A1 + 3:M1 - A1)
  4794           MOVE WS-WORK-FIELD    TO out-ins-addr1
  4795           add +2 to a1
  4796        end-if
  4797     end-perform
  4798     MOVE FUNCTION LENGTH(OUT-INS-ADDR2)
  4799                                 TO M1
  4800     MOVE SPACES                 TO WS-WORK-FIELD
  4801     perform varying a1 from +1 by +1 until a1 > m1
  4802        if out-ins-addr2 (a1:1) = '&'
  4803           MOVE out-ins-addr2 (1:A1 - 1)
  4804                                 TO WS-WORK-FIELD (1:A1 - 1)
  4805           MOVE '%26'            TO WS-WORK-FIELD (A1:3)
  4806           MOVE out-ins-addr2 (A1 + 1:M1 - A1)
  4807                                 TO WS-WORK-FIELD (A1 + 3:M1 - A1)
  4808           MOVE WS-WORK-FIELD    TO out-ins-addr2
  4809           add +2 to a1
  4810        end-if
  4811     end-perform
  4812     MOVE FUNCTION LENGTH(OUT-BEN-NAME)   TO M1
  4813     MOVE SPACES                 TO WS-WORK-FIELD
  4814     perform varying a1 from +1 by +1 until a1 > m1
  4815        if out-ben-name (a1:1) = '&'
  4816           MOVE out-ben-name (1:A1 - 1)
  4817                                 TO WS-WORK-FIELD (1:A1 - 1)
  4818           MOVE '%26'            TO WS-WORK-FIELD (A1:3)
  4819           MOVE out-ben-name (A1 + 1:M1 - A1)
  4820                                 TO WS-WORK-FIELD (A1 + 3:M1 - A1)
  4821           MOVE WS-WORK-FIELD    TO out-ben-name
  4822           add +2 to a1
  4823        end-if
  4824     end-perform
  4825     MOVE FUNCTION LENGTH(OUT-BEN-ADDR1)
  4826                                 TO M1
  4827     MOVE SPACES                 TO WS-WORK-FIELD
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  85
* NSRLTRBL.cbl
  4828     perform varying a1 from +1 by +1 until a1 > m1
  4829        if out-ben-addr1 (a1:1) = '&'
  4830           MOVE out-ben-addr1 (1:A1 - 1)
  4831                                 TO WS-WORK-FIELD (1:A1 - 1)
  4832           MOVE '%26'            TO WS-WORK-FIELD (A1:3)
  4833           MOVE out-ben-addr1 (A1 + 1:M1 - A1)
  4834                                 TO WS-WORK-FIELD (A1 + 3:M1 - A1)
  4835           MOVE WS-WORK-FIELD    TO out-ben-addr1
  4836           add +2 to a1
  4837        end-if
  4838     end-perform
  4839     MOVE FUNCTION LENGTH(OUT-BEN-ADDR2)
  4840                                 TO M1
  4841     MOVE SPACES                 TO WS-WORK-FIELD
  4842     perform varying a1 from +1 by +1 until a1 > m1
  4843        if out-ben-addr2 (a1:1) = '&'
  4844           MOVE out-ben-addr2 (1:A1 - 1)
  4845                                 TO WS-WORK-FIELD (1:A1 - 1)
  4846           MOVE '%26'            TO WS-WORK-FIELD (A1:3)
  4847           MOVE out-ben-addr2 (A1 + 1:M1 - A1)
  4848                                 TO WS-WORK-FIELD (A1 + 3:M1 - A1)
  4849           MOVE WS-WORK-FIELD    TO out-ben-addr2
  4850           add +2 to a1
  4851        end-if
  4852     end-perform
  4853     MOVE FUNCTION LENGTH(OUT-DIAG)       TO M1
  4854     MOVE SPACES                 TO WS-WORK-FIELD
  4855     perform varying a1 from +1 by +1 until a1 > m1
  4856        if out-diag (a1:1) = '&'
  4857           MOVE out-diag (1:A1 - 1)
  4858                                 TO WS-WORK-FIELD (1:A1 - 1)
  4859           MOVE '%26'            TO WS-WORK-FIELD (A1:3)
  4860           MOVE out-diag (A1 + 1:M1 - A1)
  4861                                 TO WS-WORK-FIELD (A1 + 3:M1 - A1)
  4862           MOVE WS-WORK-FIELD    TO out-diag
  4863           add +2 to a1
  4864        end-if
  4865     end-perform
  4866     MOVE ZEROS TO WS-TALLY WS-TALLY1
  4867     INSPECT NAPER-OUTPUT-DATA TALLYING WS-TALLY
  4868        FOR ALL '%'
  4869     INSPECT NAPER-OUTPUT-DATA TALLYING WS-TALLY1
  4870        FOR ALL '%26'
  4871     IF (WS-TALLY > 0)
  4872        AND (WS-TALLY NOT = WS-TALLY1)
  4873        MOVE +1                  TO A1
  4874        MOVE FUNCTION LENGTH(NAPER-OUTPUT-DATA)
  4875                                 TO NS-LEN
  4876        PERFORM WS-TALLY TIMES
  4877           PERFORM VARYING A1 FROM A1 BY +1 UNTIL
  4878              (A1 > NS-LEN)
  4879              OR (NAPER-OUTPUT-DATA (A1:1) = '%')
  4880           END-PERFORM
  4881           IF A1 > NS-LEN
  4882              CONTINUE
  4883           ELSE
  4884              IF NAPER-OUTPUT-DATA (A1:3) = '%26'
  4885                 ADD +1 TO A1
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  86
* NSRLTRBL.cbl
  4886              ELSE
  4887                 MOVE NAPER-OUTPUT-DATA (1:A1 - 1)
  4888                                 TO WS-XML-WORK
  4889                 MOVE '%25'      TO WS-XML-WORK (A1:3)
  4890                 MOVE NAPER-OUTPUT-DATA (A1 + 1:NS-LEN - A1)
  4891                              TO WS-XML-WORK (A1 + 3:NS-LEN - A1)
  4892                 MOVE WS-XML-WORK TO NAPER-OUTPUT-DATA
  4893                 ADD +3 TO A1
  4894              END-IF
  4895           END-IF
  4896        END-PERFORM
  4897     END-IF
  4898     .
  4899 0500-EXIT.
  4900     EXIT.
  4901 1000-GET-FILES.
  4902     PERFORM 1100-GET-ELCERT     THRU 1100-EXIT
  4903     PERFORM 1200-GET-ERACCT     THRU 1200-EXIT
  4904     MOVE ' '                    TO WS-FOUND-BENE-SW
  4905     PERFORM 1250-GET-ELLETR     THRU 1250-EXIT
  4906     PERFORM 1300-GET-ELTRLRS    THRU 1300-EXIT
  4907     PERFORM 1700-GET-ELENCC     THRU 1700-EXIT
  4908     IF CL-CLAIM-TYPE NOT = 'L' AND 'P' AND 'O'
  4909        PERFORM 1400-GET-WAIT-PER THRU 1400-EXIT
  4910     END-IF
  4911     IF NOT FOUND-BENE
  4912        MOVE CL-COMPANY-CD       TO WS-ELBENE-COMPANY-CD
  4913        MOVE 'B'                 TO WS-ELBENE-REC-TYPE
  4914        MOVE CL-BENEFICIARY      TO WS-ELBENE-BENE
  4915
  4916* EXEC CICS READ
  4917*            DATASET    ('ELBENE')
  4918*            INTO       (BENEFICIARY-MASTER)
  4919*            RIDFLD     (WS-ELBENE-KEY)
  4920*            RESP       (WS-RESPONSE)
  4921*       END-EXEC
  4922     MOVE LENGTH OF
  4923      BENEFICIARY-MASTER
  4924       TO DFHEIV11
  4925     MOVE 'ELBENE' TO DFHEIV1
  4926*    MOVE '&"IL       E          (  N#00004877' TO DFHEIV0
  4927     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  4928     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4929     MOVE X'204E233030303034383737' TO DFHEIV0(25:11)
  4930     CALL 'kxdfhei1' USING DFHEIV0,
  4931           DFHEIV1,
  4932           BENEFICIARY-MASTER,
  4933           DFHEIV11,
  4934           WS-ELBENE-KEY,
  4935           DFHEIV99,
  4936           DFHEIV99,
  4937           DFHEIV99
  4938     MOVE EIBRESP  TO WS-RESPONSE
  4939     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4940        IF RESP-NORMAL
  4941           MOVE BE-MAIL-TO-NAME   TO OUT-BEN-NAME
  4942           MOVE BE-ADDRESS-LINE-1 TO OUT-BEN-ADDR1
  4943           MOVE BE-ADDRESS-LINE-2 TO OUT-BEN-ADDR2
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  87
* NSRLTRBL.cbl
  4944           MOVE BE-CITY           TO OUT-BEN-CITY
  4945           MOVE BE-STATE          TO OUT-BEN-STATE
  4946           MOVE BE-ZIP-PRIME      TO OUT-BEN-ZIP
  4947           IF BE-ZIP-PLUS4 NOT = SPACES AND ZEROS
  4948              STRING '-' BE-ZIP-PLUS4 DELIMITED BY SIZE
  4949                 INTO OUT-BEN-ZIP (6:5)
  4950              END-STRING
  4951           END-IF
  4952           MOVE BE-PHONE-NO       TO OUT-BEN-PHONE
  4953        END-IF
  4954     END-IF
  4955     .
  4956 1000-EXIT.
  4957     EXIT.
  4958 1100-GET-ELCERT.
  4959     MOVE CL-COMPANY-CD          TO WS-ELCERT-COMPANY-CD
  4960     MOVE CL-CERT-KEY-DATA       TO WS-ELCERT-KEY (2:21)
  4961     MOVE CL-CERT-NO             TO WS-ELCERT-CERT-NO
  4962
  4963* EXEC CICS READ
  4964*         DATASET    ('ELCERT')
  4965*         INTO       (CERTIFICATE-MASTER)
  4966*         RIDFLD     (WS-ELCERT-KEY)
  4967*         RESP       (WS-RESPONSE)
  4968*    END-EXEC.
  4969     MOVE LENGTH OF
  4970      CERTIFICATE-MASTER
  4971       TO DFHEIV11
  4972     MOVE 'ELCERT' TO DFHEIV1
  4973*    MOVE '&"IL       E          (  N#00004905' TO DFHEIV0
  4974     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  4975     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4976     MOVE X'204E233030303034393035' TO DFHEIV0(25:11)
  4977     CALL 'kxdfhei1' USING DFHEIV0,
  4978           DFHEIV1,
  4979           CERTIFICATE-MASTER,
  4980           DFHEIV11,
  4981           WS-ELCERT-KEY,
  4982           DFHEIV99,
  4983           DFHEIV99,
  4984           DFHEIV99
  4985     MOVE EIBRESP  TO WS-RESPONSE
  4986     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4987
  4988     IF RESP-NORMAL
  4989        IF CL-CLAIM-TYPE = 'L' OR 'P' OR 'O'
  4990           MOVE CM-LF-BENEFIT-AMT TO OUT-BENAMT
  4991           MOVE CM-LF-ORIG-TERM  TO OUT-TERM
  4992           MOVE CM-LF-BENEFIT-CD TO OUT-BEN-CD
  4993           MOVE CM-LF-CRITICAL-PERIOD
  4994                                 TO OUT-CRIT-PER
  4995           MOVE CM-LF-LOAN-EXPIRE-DT
  4996                                 TO DC-BIN-DATE-1
  4997           MOVE ' '              TO DC-OPTION-CODE
  4998           PERFORM 9700-DATE-LINK
  4999                                 THRU 9700-EXIT
  5000           IF NO-CONVERSION-ERROR
  5001              STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  88
* NSRLTRBL.cbl
  5002                 DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  5003                 INTO OUT-EXP-DT
  5004              END-STRING
  5005           ELSE
  5006              MOVE SPACES        TO OUT-EXP-DT
  5007           END-IF
  5008        ELSE
  5009           MOVE CM-AH-BENEFIT-AMT TO OUT-BENAMT
  5010           MOVE CM-AH-ORIG-TERM  TO OUT-TERM
  5011           MOVE CM-AH-BENEFIT-CD TO OUT-BEN-CD
  5012           MOVE CM-AH-CRITICAL-PERIOD
  5013                                 TO OUT-CRIT-PER
  5014           MOVE CM-AH-LOAN-EXPIRE-DT
  5015                                 TO DC-BIN-DATE-1
  5016           MOVE ' '              TO DC-OPTION-CODE
  5017           PERFORM 9700-DATE-LINK
  5018                                 THRU 9700-EXIT
  5019           IF NO-CONVERSION-ERROR
  5020              STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  5021                 DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  5022                 INTO OUT-EXP-DT
  5023              END-STRING
  5024           ELSE
  5025              MOVE SPACES        TO OUT-EXP-DT
  5026           END-IF
  5027        END-IF
  5028        MOVE CM-ACCOUNT          TO OUT-CERTACCT
  5029        IF CL-INSURED-1ST-NAME = CM-INSURED-FIRST-NAME
  5030            MOVE CM-JT-FIRST-NAME TO OUT-JFNAME
  5031            MOVE CM-JT-LAST-NAME  TO OUT-JLNAME
  5032        ELSE
  5033            MOVE CM-INSURED-FIRST-NAME TO OUT-JFNAME
  5034            MOVE CM-INSURED-LAST-NAME TO OUT-JLNAME
  5035        END-IF
  5036        MOVE CM-LOAN-APR         TO OUT-APR
  5037     END-IF
  5038     .
  5039 1100-EXIT.
  5040     EXIT.
  5041 1200-GET-ERACCT.
  5042    MOVE LOW-VALUES              TO WS-ERACCT-KEY
  5043    MOVE WS-ELCERT-KEY (1:22)    TO WS-ERACCT-KEY (1:22)
  5044
  5045* EXEC CICS STARTBR
  5046*        DATASET   ('ERACCT')
  5047*        RIDFLD    (WS-ERACCT-KEY)
  5048*        GTEQ
  5049*        RESP      (WS-RESPONSE)
  5050*    END-EXEC
  5051     MOVE 'ERACCT' TO DFHEIV1
  5052     MOVE 0
  5053       TO DFHEIV11
  5054*    MOVE '&,         G          &  N#00004967' TO DFHEIV0
  5055     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  5056     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5057     MOVE X'204E233030303034393637' TO DFHEIV0(25:11)
  5058     CALL 'kxdfhei1' USING DFHEIV0,
  5059           DFHEIV1,
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  89
* NSRLTRBL.cbl
  5060           WS-ERACCT-KEY,
  5061           DFHEIV99,
  5062           DFHEIV11,
  5063           DFHEIV99
  5064     MOVE EIBRESP  TO WS-RESPONSE
  5065     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5066     IF RESP-NORMAL
  5067
  5068* EXEC CICS READNEXT
  5069*          INTO    (ACCOUNT-MASTER)
  5070*          DATASET ('ERACCT')
  5071*          RIDFLD  (WS-ERACCT-KEY)
  5072*          RESP    (WS-RESPONSE)
  5073*       END-EXEC
  5074     MOVE LENGTH OF
  5075      ACCOUNT-MASTER
  5076       TO DFHEIV12
  5077     MOVE 'ERACCT' TO DFHEIV1
  5078     MOVE 0
  5079       TO DFHEIV11
  5080*    MOVE '&.IL                  )  N#00004974' TO DFHEIV0
  5081     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  5082     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5083     MOVE X'204E233030303034393734' TO DFHEIV0(25:11)
  5084     CALL 'kxdfhei1' USING DFHEIV0,
  5085           DFHEIV1,
  5086           ACCOUNT-MASTER,
  5087           DFHEIV12,
  5088           WS-ERACCT-KEY,
  5089           DFHEIV99,
  5090           DFHEIV11,
  5091           DFHEIV99,
  5092           DFHEIV99
  5093     MOVE EIBRESP  TO WS-RESPONSE
  5094     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5095     END-IF
  5096     IF RESP-NORMAL
  5097        PERFORM WITH TEST AFTER UNTIL
  5098           NOT (RESP-NORMAL)
  5099           OR (CM-CONTROL-PRIMARY (1:20) NOT =
  5100                        AM-CONTROL-PRIMARY (1:20))
  5101           IF (CM-CONTROL-PRIMARY (1:20)
  5102              = AM-CONTROL-PRIMARY (1:20))
  5103              IF (CL-CERT-EFF-DT >= AM-EFFECTIVE-DT)
  5104                 AND (CM-CERT-EFF-DT < AM-EXPIRATION-DT)
  5105                 MOVE AM-NAME    TO OUT-ORIG-NAME
  5106                 MOVE ACCOUNT-MASTER TO SAVE-ACCOUNT-MASTER
  5107              END-IF
  5108              MOVE AM-NAME       TO OUT-ACCT-NAME
  5109              MOVE AM-ADDRS      TO OUT-ACCT-ADDR1
  5110              MOVE SPACES        TO OUT-ACCT-ADDR2
  5111              MOVE AM-ADDR-CITY  TO OUT-ACCT-CITY
  5112              MOVE AM-ADDR-STATE TO OUT-ACCT-STATE
  5113              MOVE AM-ZIP-PRIME  TO OUT-ACCT-ZIP
  5114              IF AM-ZIP-PLUS4 NOT = SPACES AND ZEROS
  5115                 STRING '-' AM-ZIP-PLUS4 DELIMITED BY SIZE
  5116                    INTO OUT-ACCT-ZIP (6:5)
  5117                 END-STRING
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  90
* NSRLTRBL.cbl
  5118              END-IF
  5119              MOVE AM-TEL-NO     TO OUT-ACCT-PHONE
  5120              MOVE AM-GPCD       TO OUT-ACCT-GPCD
  5121
  5122* EXEC CICS READNEXT
  5123*                INTO    (ACCOUNT-MASTER)
  5124*                DATASET ('ERACCT')
  5125*                RIDFLD  (WS-ERACCT-KEY)
  5126*                RESP    (WS-RESPONSE)
  5127*             END-EXEC
  5128     MOVE LENGTH OF
  5129      ACCOUNT-MASTER
  5130       TO DFHEIV12
  5131     MOVE 'ERACCT' TO DFHEIV1
  5132     MOVE 0
  5133       TO DFHEIV11
  5134*    MOVE '&.IL                  )  N#00005006' TO DFHEIV0
  5135     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  5136     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5137     MOVE X'204E233030303035303036' TO DFHEIV0(25:11)
  5138     CALL 'kxdfhei1' USING DFHEIV0,
  5139           DFHEIV1,
  5140           ACCOUNT-MASTER,
  5141           DFHEIV12,
  5142           WS-ERACCT-KEY,
  5143           DFHEIV99,
  5144           DFHEIV11,
  5145           DFHEIV99,
  5146           DFHEIV99
  5147     MOVE EIBRESP  TO WS-RESPONSE
  5148     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5149           END-IF
  5150        END-PERFORM
  5151     END-IF
  5152     MOVE SAVE-ACCOUNT-MASTER  TO ACCOUNT-MASTER
  5153    .
  5154 1200-EXIT.
  5155     EXIT.
  5156 1250-GET-ELLETR.
  5157     MOVE CL-COMPANY-CD          TO WS-ELLETR-COMPANY-CD
  5158     MOVE BL-LETTER-ID           TO WS-ELLETR-LETTER-ID
  5159     MOVE +0                     TO WS-ELLETR-SEQ-NO
  5160
  5161* EXEC CICS READ
  5162*         DATASET    ('ELLETR')
  5163*         INTO       (TEXT-FILES)
  5164*         RIDFLD     (WS-ELLETR-KEY)
  5165*         RESP       (WS-RESPONSE)
  5166*         GTEQ
  5167*    END-EXEC
  5168     MOVE LENGTH OF
  5169      TEXT-FILES
  5170       TO DFHEIV11
  5171     MOVE 'ELLETR' TO DFHEIV1
  5172*    MOVE '&"IL       G          (  N#00005023' TO DFHEIV0
  5173     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  5174     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5175     MOVE X'204E233030303035303233' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  91
* NSRLTRBL.cbl
  5176     CALL 'kxdfhei1' USING DFHEIV0,
  5177           DFHEIV1,
  5178           TEXT-FILES,
  5179           DFHEIV11,
  5180           WS-ELLETR-KEY,
  5181           DFHEIV99,
  5182           DFHEIV99,
  5183           DFHEIV99
  5184     MOVE EIBRESP  TO WS-RESPONSE
  5185     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5186     IF RESP-NORMAL
  5187        IF (LETTER-FILE-TEXT)
  5188           AND (BL-LETTER-ID = TX-LETTER-NO)
  5189           AND (TX-LINE-SQUEEZE-CONTROL = 'Z')
  5190           PERFORM 1280-PROCESS-Z-CONTROLS
  5191                                 THRU 1280-EXIT
  5192        END-IF
  5193     END-IF
  5194     .
  5195 1250-EXIT.
  5196     EXIT.
  5197 1280-PROCESS-Z-CONTROLS.
  5198     MOVE TX-TEXT-LINE           TO W-Z-CONTROL-DATA
  5199     IF W-FORM-TO-RESEND > SPACES
  5200        MOVE W-FORM-TO-RESEND    TO OUT-FORM
  5201     ELSE
  5202        MOVE SPACES              TO OUT-FORM
  5203     END-IF.
  5204*    MOVE W-ENCLOSURE-CD         TO OUT-ENC-CODE
  5205     .
  5206 1280-EXIT.
  5207     EXIT.
  5208 1300-GET-ELTRLRS.
  5209     MOVE CL-CONTROL-PRIMARY     TO WS-ELTRLR-KEY
  5210     MOVE +0                     TO WS-ELTRLR-SEQ-NO
  5211
  5212* EXEC CICS STARTBR
  5213*        DATASET   ('ELTRLR')
  5214*        RIDFLD    (WS-ELTRLR-KEY)
  5215*        GTEQ
  5216*        RESP      (WS-RESPONSE)
  5217*    END-EXEC
  5218     MOVE 'ELTRLR' TO DFHEIV1
  5219     MOVE 0
  5220       TO DFHEIV11
  5221*    MOVE '&,         G          &  N#00005055' TO DFHEIV0
  5222     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  5223     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5224     MOVE X'204E233030303035303535' TO DFHEIV0(25:11)
  5225     CALL 'kxdfhei1' USING DFHEIV0,
  5226           DFHEIV1,
  5227           WS-ELTRLR-KEY,
  5228           DFHEIV99,
  5229           DFHEIV11,
  5230           DFHEIV99
  5231     MOVE EIBRESP  TO WS-RESPONSE
  5232     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5233    IF RESP-NORMAL
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  92
* NSRLTRBL.cbl
  5234
  5235* EXEC CICS READNEXT
  5236*         INTO    (ACTIVITY-TRAILERS)
  5237*         DATASET ('ELTRLR')
  5238*         RIDFLD  (WS-ELTRLR-KEY)
  5239*         RESP    (WS-RESPONSE)
  5240*      END-EXEC
  5241     MOVE LENGTH OF
  5242      ACTIVITY-TRAILERS
  5243       TO DFHEIV12
  5244     MOVE 'ELTRLR' TO DFHEIV1
  5245     MOVE 0
  5246       TO DFHEIV11
  5247*    MOVE '&.IL                  )  N#00005062' TO DFHEIV0
  5248     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  5249     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5250     MOVE X'204E233030303035303632' TO DFHEIV0(25:11)
  5251     CALL 'kxdfhei1' USING DFHEIV0,
  5252           DFHEIV1,
  5253           ACTIVITY-TRAILERS,
  5254           DFHEIV12,
  5255           WS-ELTRLR-KEY,
  5256           DFHEIV99,
  5257           DFHEIV11,
  5258           DFHEIV99,
  5259           DFHEIV99
  5260     MOVE EIBRESP  TO WS-RESPONSE
  5261     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5262       PERFORM 1310-GET-ELTRLRS THRU 1310-EXIT
  5263    END-IF
  5264     .
  5265 1300-EXIT.
  5266     EXIT.
  5267 1310-GET-ELTRLRS.
  5268     IF RESP-NORMAL
  5269     IF CL-CONTROL-PRIMARY = AT-CONTROL-PRIMARY (1:20)
  5270        EVALUATE TRUE
  5271           WHEN AT-INSURED-ADDR-TRL
  5272              MOVE AT-MAIL-TO-NAME   TO OUT-INS-NAME
  5273              MOVE AT-ADDRESS-LINE-1 TO OUT-INS-ADDR1
  5274              MOVE AT-ADDRESS-LINE-2 TO OUT-INS-ADDR2
  5275              MOVE AT-CITY           TO OUT-INS-CITY
  5276              MOVE AT-STATE          TO OUT-INS-STATE
  5277              MOVE AT-ZIP-CODE       TO OUT-INS-ZIP
  5278              IF AT-ZIP-PLUS4 NOT = SPACES AND ZEROS
  5279                 STRING '-' AT-ZIP-PLUS4 DELIMITED BY SIZE
  5280                    INTO OUT-INS-ZIP (6:5)
  5281                 END-STRING
  5282              END-IF
  5283              MOVE AT-PHONE-NO       TO OUT-INS-PHONE
  5284           WHEN AT-BENEFICIARY-ADDR-TRL
  5285              SET FOUND-BENE TO TRUE
  5286              MOVE AT-MAIL-TO-NAME   TO OUT-BEN-NAME
  5287              MOVE AT-ADDRESS-LINE-1 TO OUT-BEN-ADDR1
  5288              MOVE AT-ADDRESS-LINE-2 TO OUT-BEN-ADDR2
  5289              MOVE AT-CITY           TO OUT-BEN-CITY
  5290              MOVE AT-STATE          TO OUT-BEN-STATE
  5291              MOVE AT-ZIP-CODE       TO OUT-BEN-ZIP
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  93
* NSRLTRBL.cbl
  5292              IF AT-ZIP-PLUS4 NOT = SPACES AND ZEROS
  5293                 STRING '-' AT-ZIP-PLUS4 DELIMITED BY SIZE
  5294                    INTO OUT-BEN-ZIP (6:5)
  5295                 END-STRING
  5296              END-IF
  5297              MOVE AT-PHONE-NO       TO OUT-BEN-PHONE
  5298           WHEN AT-ACCOUNT-ADDR-TRL
  5299              MOVE AT-MAIL-TO-NAME   TO OUT-ACCT-NAME
  5300              MOVE AT-ADDRESS-LINE-1 TO OUT-ACCT-ADDR1
  5301              MOVE AT-ADDRESS-LINE-2 TO OUT-ACCT-ADDR2
  5302              MOVE AT-CITY           TO OUT-ACCT-CITY
  5303              MOVE AT-STATE          TO OUT-ACCT-STATE
  5304              MOVE AT-ZIP-CODE       TO OUT-ACCT-ZIP
  5305              IF AT-ZIP-PLUS4 NOT = SPACES AND ZEROS
  5306                 STRING '-' AT-ZIP-PLUS4 DELIMITED BY SIZE
  5307                    INTO OUT-ACCT-ZIP (6:5)
  5308                 END-STRING
  5309              END-IF
  5310              MOVE AT-PHONE-NO       TO OUT-ACCT-PHONE
  5311           WHEN AT-SEQUENCE-NO = +90
  5312              MOVE AT-INFO-LINE-1   TO OUT-DIAG
  5313           WHEN AT-SEQUENCE-NO = +91
  5314              MOVE AT-INFO-LINE-1 TO OUT-LOAN-NO
  5315           WHEN AT-TRAILER-TYPE = '2' AND AT-PAYMENT-TYPE = 'I'
  5316              IF AT-INT-RATE NUMERIC AND
  5317                 AT-INT-RATE NOT EQUAL ZEROS
  5318                    COMPUTE OUT-LF-INT-RATE = AT-INT-RATE * 100
  5319              END-IF
  5320           WHEN AT-TRAILER-TYPE = '3'
  5321              IF (SAVE-BIN-DATE >= AT-SCHEDULE-START-DT)
  5322                 AND (SAVE-BIN-DATE <= AT-SCHEDULE-END-DT)
  5323                 AND (AT-TERMINATED-DT = LOW-VALUES OR SPACES)
  5324                 MOVE AT-SCHEDULE-END-DT TO WS-AUTO-LAST-SCHED-DT
  5325              END-IF
  5326           WHEN AT-TRAILER-TYPE = '8'
  5327              IF AT-RECORDED-DT > WS-LAST-ACT-DT
  5328                 MOVE AT-RECORDED-DT
  5329                              TO WS-LAST-ACT-DT
  5330                 MOVE 'DENIAL'
  5331                              TO WS-LAST-ACT-TYPE
  5332              END-IF
  5333           WHEN AT-TRAILER-TYPE = 'A'
  5334              IF AT-RECORDED-DT > WS-LAST-ACT-DT
  5335                 MOVE AT-RECORDED-DT
  5336                              TO WS-LAST-ACT-DT
  5337                 MOVE 'FORMS' TO WS-LAST-ACT-TYPE
  5338                 IF INITIAL-FORM
  5339                    MOVE 'INIT'
  5340                              TO WS-FORM
  5341                 END-IF
  5342                 IF PROGRESS-FORM
  5343                    MOVE 'PROG'
  5344                              TO WS-FORM
  5345                 END-IF
  5346              END-IF
  5347              IF AT-FORM-SEND-ON-DT > WS-ACTIVITY-DT
  5348                 MOVE AT-FORM-SEND-ON-DT
  5349                              TO WS-ACTIVITY-DT
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  94
* NSRLTRBL.cbl
  5350              END-IF
  5351              IF AT-FORM-REPRINT-DT > WS-ACTIVITY-DT
  5352                 MOVE AT-FORM-REPRINT-DT
  5353                              TO WS-ACTIVITY-DT
  5354              END-IF
  5355              IF AT-FORM-ANSWERED-DT > WS-ACTIVITY-DT
  5356                 MOVE AT-FORM-ANSWERED-DT
  5357                              TO WS-ACTIVITY-DT
  5358              END-IF
  5359        END-EVALUATE
  5360
  5361* EXEC CICS READNEXT
  5362*         INTO    (ACTIVITY-TRAILERS)
  5363*         DATASET ('ELTRLR')
  5364*         RIDFLD  (WS-ELTRLR-KEY)
  5365*         RESP    (WS-RESPONSE)
  5366*       END-EXEC
  5367     MOVE LENGTH OF
  5368      ACTIVITY-TRAILERS
  5369       TO DFHEIV12
  5370     MOVE 'ELTRLR' TO DFHEIV1
  5371     MOVE 0
  5372       TO DFHEIV11
  5373*    MOVE '&.IL                  )  N#00005166' TO DFHEIV0
  5374     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  5375     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5376     MOVE X'204E233030303035313636' TO DFHEIV0(25:11)
  5377     CALL 'kxdfhei1' USING DFHEIV0,
  5378           DFHEIV1,
  5379           ACTIVITY-TRAILERS,
  5380           DFHEIV12,
  5381           WS-ELTRLR-KEY,
  5382           DFHEIV99,
  5383           DFHEIV11,
  5384           DFHEIV99,
  5385           DFHEIV99
  5386     MOVE EIBRESP  TO WS-RESPONSE
  5387     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5388        GO TO 1310-GET-ELTRLRS
  5389     END-IF
  5390     END-IF
  5391     .
  5392 1310-EXIT.
  5393     EXIT.
  5394 1400-GET-WAIT-PER.
  5395     MOVE BL-COMP-ID             TO WS-ELCNTL-COMPANY-ID
  5396     MOVE CM-AH-BENEFIT-CD       TO WS-ELCNTL-BEN-CD
  5397     MOVE '5'                    TO WS-ELCNTL-REC-TYPE
  5398     MOVE +0                     TO WS-ELCNTL-SEQ-NO
  5399
  5400* EXEC CICS READ
  5401*       INTO    (CONTROL-FILE)
  5402*       DATASET ('ELCNTL')
  5403*       RIDFLD  (WS-ELCNTL-KEY)
  5404*       GTEQ
  5405*       RESP    (WS-RESPONSE)
  5406*    END-EXEC
  5407     MOVE LENGTH OF
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  95
* NSRLTRBL.cbl
  5408      CONTROL-FILE
  5409       TO DFHEIV11
  5410     MOVE 'ELCNTL' TO DFHEIV1
  5411*    MOVE '&"IL       G          (  N#00005183' TO DFHEIV0
  5412     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  5413     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5414     MOVE X'204E233030303035313833' TO DFHEIV0(25:11)
  5415     CALL 'kxdfhei1' USING DFHEIV0,
  5416           DFHEIV1,
  5417           CONTROL-FILE,
  5418           DFHEIV11,
  5419           WS-ELCNTL-KEY,
  5420           DFHEIV99,
  5421           DFHEIV99,
  5422           DFHEIV99
  5423     MOVE EIBRESP  TO WS-RESPONSE
  5424     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5425     IF RESP-NORMAL
  5426        AND (CF-COMPANY-ID  = BL-COMP-ID)
  5427        AND (CF-RECORD-TYPE = '5')
  5428        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  5429           (S1 > +8)
  5430           OR (CM-AH-BENEFIT-CD = CF-BENEFIT-CODE (S1))
  5431        END-PERFORM
  5432        IF S1 > +8
  5433           MOVE '**'             TO OUT-WAIT-PER
  5434        ELSE
  5435           MOVE CF-BENEFIT-ALPHA (S1) (1:2)
  5436                                 TO OUT-WAIT-PER
  5437        END-IF
  5438     ELSE
  5439        MOVE '**'                TO OUT-WAIT-PER
  5440     END-IF
  5441    .
  5442 1400-EXIT.
  5443     EXIT.
  5444 1500-GET-ARCH-NO.
  5445     MOVE BL-COMP-ID             TO WS-ELCNTL-COMPANY-ID
  5446     MOVE '1'                    TO WS-ELCNTL-REC-TYPE
  5447     MOVE SPACES                 TO WS-ELCNTL-GENL
  5448     MOVE +0                     TO WS-ELCNTL-SEQ-NO
  5449
  5450* EXEC CICS READ
  5451*       INTO    (CONTROL-FILE)
  5452*       DATASET ('ELCNTL')
  5453*       RIDFLD  (WS-ELCNTL-KEY)
  5454*       UPDATE
  5455*       RESP    (WS-RESPONSE)
  5456*    END-EXEC
  5457     MOVE LENGTH OF
  5458      CONTROL-FILE
  5459       TO DFHEIV11
  5460     MOVE 'ELCNTL' TO DFHEIV1
  5461*    MOVE '&"IL       EU         (  N#00005215' TO DFHEIV0
  5462     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  5463     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  5464     MOVE X'204E233030303035323135' TO DFHEIV0(25:11)
  5465     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  96
* NSRLTRBL.cbl
  5466           DFHEIV1,
  5467           CONTROL-FILE,
  5468           DFHEIV11,
  5469           WS-ELCNTL-KEY,
  5470           DFHEIV99,
  5471           DFHEIV99,
  5472           DFHEIV99
  5473     MOVE EIBRESP  TO WS-RESPONSE
  5474     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5475     IF RESP-NORMAL
  5476        AND (CF-COMPANY-ID  = BL-COMP-ID)
  5477        AND (CF-RECORD-TYPE = '1')
  5478        ADD +1                   TO CF-CO-ARCHIVE-COUNTER
  5479        MOVE CF-CO-ARCHIVE-COUNTER TO WS-ARCHIVE-NO
  5480        MOVE WS-ARCHIVE-NO       TO BL-ARCHIVE-NO
  5481
  5482* EXEC CICS REWRITE
  5483*          FROM    (CONTROL-FILE)
  5484*          DATASET ('ELCNTL')
  5485*       END-EXEC
  5486     MOVE LENGTH OF
  5487      CONTROL-FILE
  5488       TO DFHEIV11
  5489     MOVE 'ELCNTL' TO DFHEIV1
  5490*    MOVE '&& L                  %   #00005228' TO DFHEIV0
  5491     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  5492     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  5493     MOVE X'2020233030303035323238' TO DFHEIV0(25:11)
  5494     CALL 'kxdfhei1' USING DFHEIV0,
  5495           DFHEIV1,
  5496           CONTROL-FILE,
  5497           DFHEIV11,
  5498           DFHEIV99
  5499     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5500     ELSE
  5501        MOVE +0                  TO WS-ARCHIVE-NO
  5502     END-IF
  5503    .
  5504 1500-EXIT.
  5505     EXIT.
  5506 1600-ADD-CORR-TRLR.
  5507
  5508* EXEC CICS READ
  5509*         DATASET    ('ELMSTR')
  5510*         INTO       (CLAIM-MASTER)
  5511*         RIDFLD     (WS-ELMSTR-KEY)
  5512*         UPDATE
  5513*         RESP       (WS-RESPONSE)
  5514*    END-EXEC
  5515     MOVE LENGTH OF
  5516      CLAIM-MASTER
  5517       TO DFHEIV11
  5518     MOVE 'ELMSTR' TO DFHEIV1
  5519*    MOVE '&"IL       EU         (  N#00005239' TO DFHEIV0
  5520     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  5521     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  5522     MOVE X'204E233030303035323339' TO DFHEIV0(25:11)
  5523     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  97
* NSRLTRBL.cbl
  5524           DFHEIV1,
  5525           CLAIM-MASTER,
  5526           DFHEIV11,
  5527           WS-ELMSTR-KEY,
  5528           DFHEIV99,
  5529           DFHEIV99,
  5530           DFHEIV99
  5531     MOVE EIBRESP  TO WS-RESPONSE
  5532     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5533     IF NOT RESP-NORMAL
  5534        DISPLAY ' 1600 READ UPD MSTR ' WS-RESPONSE
  5535        GO TO 1600-EXIT
  5536     END-IF
  5537     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT
  5538     PERFORM 2000-BUILD-ELNAPS   THRU 2000-EXIT
  5539     IF WS-FOLLOW-UP-DT > CL-NEXT-FOLLOWUP-DT
  5540        MOVE WS-FOLLOW-UP-DT     TO CL-NEXT-FOLLOWUP-DT
  5541     END-IF
  5542     IF WS-RESEND-DT > CL-NEXT-FOLLOWUP-DT
  5543        MOVE WS-RESEND-DT        TO CL-NEXT-FOLLOWUP-DT
  5544     END-IF
  5545     MOVE '2'                    TO CL-LAST-MAINT-TYPE
  5546     MOVE 'AT'                   TO ACTIVITY-TRAILERS
  5547     MOVE CL-CONTROL-PRIMARY     TO AT-CONTROL-PRIMARY
  5548     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO
  5549     MOVE  4                     TO AT-TRAILER-TYPE
  5550     MOVE SAVE-BIN-DATE          TO AT-RECORDED-DT
  5551                                    CL-LAST-MAINT-DT
  5552                                    AT-CORR-LAST-MAINT-DT
  5553     MOVE BL-PROC-ID             TO AT-RECORDED-BY
  5554                                    CL-LAST-MAINT-USER
  5555                                    AT-CORR-LAST-UPDATED-BY
  5556     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS
  5557                                    CL-LAST-MAINT-HHMMSS.
  5558     MOVE SAVE-BIN-DATE          TO AT-LETTER-SENT-DT.
  5559     MOVE WS-FOLLOW-UP-DT        TO AT-RECEIPT-FOLLOW-UP.
  5560     MOVE WS-RESEND-DT           TO AT-AUTO-RE-SEND-DT.
  5561     MOVE LOW-VALUES             TO AT-LETTER-ANSWERED-DT
  5562                                    AT-LETTER-PURGED-DT.
  5563     MOVE WS-ARCHIVE-NO          TO AT-LETTER-ARCHIVE-NO.
  5564     MOVE '3'                    TO AT-LETTER-ORIGIN
  5565     MOVE BL-LETTER-ID           TO AT-STD-LETTER-FORM
  5566     MOVE SAVE-BIN-DATE          TO AT-INITIAL-PRINT-DATE
  5567     MOVE LOW-VALUES             TO AT-RESEND-PRINT-DATE
  5568
  5569* EXEC CICS WRITE
  5570*         DATASET    ('ELTRLR')
  5571*         FROM       (ACTIVITY-TRAILERS)
  5572*         RIDFLD     (AT-CONTROL-PRIMARY)
  5573*         RESP       (WS-RESPONSE)
  5574*    END-EXEC
  5575     MOVE LENGTH OF
  5576      ACTIVITY-TRAILERS
  5577       TO DFHEIV11
  5578     MOVE 'ELTRLR' TO DFHEIV1
  5579*    MOVE '&$ L                  ''  N#00005281' TO DFHEIV0
  5580     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  5581     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  98
* NSRLTRBL.cbl
  5582     MOVE X'204E233030303035323831' TO DFHEIV0(25:11)
  5583     CALL 'kxdfhei1' USING DFHEIV0,
  5584           DFHEIV1,
  5585           ACTIVITY-TRAILERS,
  5586           DFHEIV11,
  5587           AT-CONTROL-PRIMARY,
  5588           DFHEIV99,
  5589           DFHEIV99
  5590     MOVE EIBRESP  TO WS-RESPONSE
  5591     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5592     IF NOT RESP-NORMAL
  5593        DISPLAY ' 1600 WRITE TRLR ' WS-RESPONSE
  5594        GO TO 1600-EXIT
  5595     END-IF
  5596
  5597* EXEC CICS REWRITE
  5598*         DATASET    ('ELMSTR')
  5599*         FROM       (CLAIM-MASTER)
  5600*         RESP       (WS-RESPONSE)
  5601*    END-EXEC
  5602     MOVE LENGTH OF
  5603      CLAIM-MASTER
  5604       TO DFHEIV11
  5605     MOVE 'ELMSTR' TO DFHEIV1
  5606*    MOVE '&& L                  %  N#00005291' TO DFHEIV0
  5607     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  5608     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  5609     MOVE X'204E233030303035323931' TO DFHEIV0(25:11)
  5610     CALL 'kxdfhei1' USING DFHEIV0,
  5611           DFHEIV1,
  5612           CLAIM-MASTER,
  5613           DFHEIV11,
  5614           DFHEIV99
  5615     MOVE EIBRESP  TO WS-RESPONSE
  5616     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5617     IF NOT RESP-NORMAL
  5618        DISPLAY ' 1600 REWRITE MSTR ' WS-RESPONSE
  5619     END-IF
  5620     .
  5621 1600-EXIT.
  5622     EXIT.
  5623 1700-GET-ELENCC.
  5624     MOVE CL-COMPANY-CD          TO WS-ELENCC-KEY
  5625     MOVE '1'                    TO WS-ELENCC-REC-TYPE
  5626     MOVE BL-ENC-CD              TO WS-ELENCC-ENC-CODE
  5627     PERFORM VARYING E1 FROM +1 BY +1 UNTIL
  5628        (WS-ELENCC-ENC-CODE (E1:1) = ' ')
  5629        OR (E1 > +5)
  5630     END-PERFORM
  5631     IF E1 < +5
  5632        MOVE CL-CERT-STATE       TO WS-ELENCC-ENC-CODE (E1:2)
  5633     END-IF
  5634
  5635* EXEC CICS READ
  5636*        DATASET   ('ELENCC')
  5637*        INTO      (ENCLOSURE-CODES)
  5638*        RIDFLD    (WS-ELENCC-KEY)
  5639*        RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  99
* NSRLTRBL.cbl
  5640*    END-EXEC
  5641     MOVE LENGTH OF
  5642      ENCLOSURE-CODES
  5643       TO DFHEIV11
  5644     MOVE 'ELENCC' TO DFHEIV1
  5645*    MOVE '&"IL       E          (  N#00005313' TO DFHEIV0
  5646     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  5647     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5648     MOVE X'204E233030303035333133' TO DFHEIV0(25:11)
  5649     CALL 'kxdfhei1' USING DFHEIV0,
  5650           DFHEIV1,
  5651           ENCLOSURE-CODES,
  5652           DFHEIV11,
  5653           WS-ELENCC-KEY,
  5654           DFHEIV99,
  5655           DFHEIV99,
  5656           DFHEIV99
  5657     MOVE EIBRESP  TO WS-RESPONSE
  5658     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5659     IF NOT RESP-NORMAL
  5660        MOVE BL-ENC-CD           TO WS-ELENCC-ENC-CODE
  5661
  5662* EXEC CICS READ
  5663*           DATASET   ('ELENCC')
  5664*           INTO      (ENCLOSURE-CODES)
  5665*           RIDFLD    (WS-ELENCC-KEY)
  5666*           RESP      (WS-RESPONSE)
  5667*       END-EXEC
  5668     MOVE LENGTH OF
  5669      ENCLOSURE-CODES
  5670       TO DFHEIV11
  5671     MOVE 'ELENCC' TO DFHEIV1
  5672*    MOVE '&"IL       E          (  N#00005321' TO DFHEIV0
  5673     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  5674     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5675     MOVE X'204E233030303035333231' TO DFHEIV0(25:11)
  5676     CALL 'kxdfhei1' USING DFHEIV0,
  5677           DFHEIV1,
  5678           ENCLOSURE-CODES,
  5679           DFHEIV11,
  5680           WS-ELENCC-KEY,
  5681           DFHEIV99,
  5682           DFHEIV99,
  5683           DFHEIV99
  5684     MOVE EIBRESP  TO WS-RESPONSE
  5685     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5686     END-IF
  5687     IF RESP-NORMAL
  5688        MOVE NC-OUTPUT-STACK     TO OUT-OUTSTACK
  5689        MOVE NC-ENCLOSURE-LINE   TO OUT-ENCLINE
  5690        MOVE NC-ATTACHMENTS      TO OUT-ENCATTS
  5691     END-IF
  5692     .
  5693 1700-EXIT.
  5694     EXIT.
  5695 1800-SET-EL150D-FIELDS.
  5696     MOVE SPACES TO WS-UNSORTED-TABLE
  5697                    WS-SORTED-TABLE
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 100
* NSRLTRBL.cbl
  5698
  5699     MOVE ' '                    TO WS-PDEF-RECORD-SW
  5700
  5701     MOVE CM-CONTROL-PRIMARY     TO ELCRTT-KEY
  5702     MOVE 'B'                    TO CRTT-REC-TYPE
  5703
  5704
  5705* EXEC CICS READ
  5706*       DATASET   ('ELCRTT')
  5707*       INTO      (CERTIFICATE-TRAILERS)
  5708*       RIDFLD    (ELCRTT-KEY)
  5709*       RESP      (WS-RESPONSE)
  5710*    END-EXEC
  5711     MOVE LENGTH OF
  5712      CERTIFICATE-TRAILERS
  5713       TO DFHEIV11
  5714     MOVE 'ELCRTT' TO DFHEIV1
  5715*    MOVE '&"IL       E          (  N#00005345' TO DFHEIV0
  5716     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  5717     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5718     MOVE X'204E233030303035333435' TO DFHEIV0(25:11)
  5719     CALL 'kxdfhei1' USING DFHEIV0,
  5720           DFHEIV1,
  5721           CERTIFICATE-TRAILERS,
  5722           DFHEIV11,
  5723           ELCRTT-KEY,
  5724           DFHEIV99,
  5725           DFHEIV99,
  5726           DFHEIV99
  5727     MOVE EIBRESP  TO WS-RESPONSE
  5728     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5729
  5730     IF NOT RESP-NORMAL
  5731        DISPLAY ' NSRLTRBL- NO TRLRS ' CL-CERT-NO
  5732        GO TO 1800-EXIT
  5733     END-IF
  5734
  5735     DISPLAY ' NSRLTRBL- GOOD READ ON ELCRTT '
  5736     PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  5737       (S1 > +24)
  5738       OR (CS-CLAIM-NO (S1) = SPACES)
  5739        MOVE CS-CLAIM-NO (S1)    TO WS-CLAIM-NO (S1)
  5740        MOVE CS-CLAIM-TYPE (S1)  TO WS-CLM-TYPE (S1)
  5741        IF CS-INSURED-TYPE (S1) = 'C'
  5742           MOVE '2'              TO WS-INS-TYPE (S1)
  5743        ELSE
  5744           MOVE '1'              TO WS-INS-TYPE (S1)
  5745        END-IF
  5746        MOVE CS-BENEFIT-PERIOD (S1)
  5747                                 TO WS-BEN-PER (S1)
  5748*       MOVE CS-DAYS-PAID (S1)   TO WS-DAYS-PAID (S1)
  5749        MOVE CS-TOTAL-PAID (S1)  TO WS-TOTAL-PAID (S1)
  5750        MOVE ' '                 TO WS-SORTED-SW (S1)
  5751
  5752        MOVE CS-COMPANY-CD          TO WS-ELMSTR-COMPANY-CD
  5753        MOVE CS-CARRIER             TO WS-ELMSTR-CARRIER
  5754        MOVE CS-CLAIM-NO (S1)       TO WS-ELMSTR-CLAIM-NO
  5755        MOVE CS-CERT-NO             TO WS-ELMSTR-CERT-NO
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 101
* NSRLTRBL.cbl
  5756
  5757
  5758* EXEC CICS READ
  5759*          DATASET        ('ELMSTR')
  5760*          RIDFLD         (WS-ELMSTR-KEY)
  5761*          INTO           (CLAIM-MASTER)
  5762*          RESP           (WS-RESPONSE)
  5763*       END-EXEC
  5764     MOVE LENGTH OF
  5765      CLAIM-MASTER
  5766       TO DFHEIV11
  5767     MOVE 'ELMSTR' TO DFHEIV1
  5768*    MOVE '&"IL       E          (  N#00005379' TO DFHEIV0
  5769     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  5770     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5771     MOVE X'204E233030303035333739' TO DFHEIV0(25:11)
  5772     CALL 'kxdfhei1' USING DFHEIV0,
  5773           DFHEIV1,
  5774           CLAIM-MASTER,
  5775           DFHEIV11,
  5776           WS-ELMSTR-KEY,
  5777           DFHEIV99,
  5778           DFHEIV99,
  5779           DFHEIV99
  5780     MOVE EIBRESP  TO WS-RESPONSE
  5781     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5782        IF RESP-NORMAL
  5783           MOVE CL-INCURRED-DT   TO WS-INC-DT (S1)
  5784           MOVE CL-PAID-THRU-DT  TO WS-PD-THRU-DT (S1)
  5785           MOVE CL-CLAIM-STATUS  TO WS-STATUS (S1)
  5786           IF CL-CRITICAL-PERIOD NOT NUMERIC
  5787              MOVE ZEROS TO CL-CRITICAL-PERIOD
  5788           END-IF
  5789           MOVE CL-CRITICAL-PERIOD
  5790                                 TO WS-MAX-BENS (S1)
  5791           IF CL-CRITICAL-PERIOD = ZEROS
  5792              IF CL-CLAIM-TYPE = 'L' OR 'P' OR 'O'
  5793                 MOVE 01         TO WS-MAX-BENS (S1)
  5794              ELSE
  5795                 MOVE CM-AH-ORIG-TERM
  5796                                 TO WS-MAX-BENS (S1)
  5797              END-IF
  5798           END-IF
  5799           IF CL-DENIAL-TYPE = '1' OR '2' OR '3' OR '4'
  5800              MOVE 'D'           TO WS-STATUS (S1)
  5801           END-IF
  5802           IF CS-CLAIM-NO (S1) = BL-CLAIM-NO
  5803              MOVE CL-ACCIDENT-CLAIM-SW TO OUT-ACC-SW
  5804           END-IF
  5805
  5806           MOVE ' '                    TO WS-PDEF-RECORD-SW
  5807           IF (AM-DCC-PRODUCT-CODE NOT = SPACES)
  5808              PERFORM 1850-GET-DDF-LIMITS
  5809                                 THRU 1850-EXIT
  5810           END-IF
  5811           IF PDEF-FOUND
  5812              PERFORM VARYING P1 FROM +1 BY +1 UNTIL
  5813                 (PD-PROD-CODE (P1) = CL-CLAIM-TYPE)
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 102
* NSRLTRBL.cbl
  5814                 OR (P1 > +8)
  5815              END-PERFORM
  5816              IF P1 < +9
  5817                 IF CL-CLAIM-TYPE = 'L' OR 'P' OR 'O'
  5818                    IF (PD-MAX-AMT (P1) NOT = ZEROS)
  5819                       AND (PD-MAX-AMT (P1) < CM-LF-BENEFIT-AMT)
  5820                       MOVE PD-MAX-AMT (P1)
  5821                                 TO WS-MAX-MOBEN (S1)
  5822                    ELSE
  5823                       MOVE CM-LF-BENEFIT-AMT
  5824                                 TO WS-MAX-MOBEN (S1)
  5825                    END-IF
  5826                 ELSE
  5827                    IF PD-BEN-PCT (P1) NOT NUMERIC
  5828                       MOVE ZEROS   TO PD-BEN-PCT (P1)
  5829                    END-IF
  5830                    IF PD-BEN-PCT (P1) = ZEROS
  5831                       MOVE +1      TO WS-WORK-BEN-PCT
  5832                    ELSE
  5833                       MOVE PD-BEN-PCT (P1)
  5834                                    TO WS-WORK-BEN-PCT
  5835                    END-IF
  5836                    COMPUTE WS-MAX-MOBEN (S1) =
  5837                       CM-AH-BENEFIT-AMT * WS-WORK-BEN-PCT
  5838                    IF (PD-MAX-AMT (P1) NOT = ZEROS)
  5839                       AND (PD-MAX-AMT (P1) < WS-MAX-MOBEN (S1))
  5840                       MOVE PD-MAX-AMT (P1)
  5841                                 TO WS-MAX-MOBEN (S1)
  5842                    END-IF
  5843                 END-IF
  5844*                IF (PD-MAX-AMT (P1) NOT = ZEROS)
  5845*                   AND (PD-MAX-AMT (P1) < CM-AH-BENEFIT-AMT)
  5846*                   MOVE PD-MAX-AMT (P1) TO WS-MAX-MOBEN (S1)
  5847*                ELSE
  5848*                   MOVE CM-AH-BENEFIT-AMT TO WS-MAX-MOBEN (S1)
  5849*                END-IF
  5850                 MOVE PD-EXCLUSION-PERIOD-DAYS (P1)
  5851                                 TO WS-EXCL-PER (S1)
  5852                 MOVE PD-COVERAGE-ENDS-MOS (P1)
  5853                                 TO WS-COV-ENDS (S1)
  5854                 MOVE PD-ACCIDENT-ONLY-MOS (P1)
  5855                                 TO WS-ACC-PER (S1)
  5856                 MOVE PD-MAX-EXTENSION (P1)
  5857                                 TO WS-MAX-EXTEN (S1)
  5858                 EVALUATE TRUE
  5859                    WHEN PD-RECURRING-YN (P1) = 'N'
  5860                       MOVE 00   TO WS-REC-MOS (S1)
  5861                    WHEN PD-RECURRING-YN (P1) = 'Y'
  5862                       MOVE 99   TO WS-REC-MOS (S1)
  5863                    WHEN PD-REC-CRIT-PERIOD (P1) NUMERIC
  5864                       MOVE PD-REC-CRIT-PERIOD (P1)
  5865                                 TO WS-REC-MOS (S1)
  5866                    WHEN OTHER
  5867                       MOVE ZEROS TO WS-REC-MOS (S1)
  5868                 END-EVALUATE
  5869                 IF WS-REC-MOS (S1) = ZEROS
  5870                    MOVE 01      TO WS-REC-MOS (S1)
  5871                 END-IF
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 103
* NSRLTRBL.cbl
  5872                 DISPLAY ' NSRLTRBL- PDEF FOUND ' WS-EXCL-PER (S1)
  5873              END-IF
  5874           ELSE
  5875              IF CL-CLAIM-TYPE NOT = 'L' AND 'P' AND 'O'
  5876                 MOVE CM-AH-BENEFIT-AMT
  5877                                 TO WS-MAX-MOBEN (S1)
  5878              ELSE
  5879                 MOVE ZEROS      TO WS-MAX-MOBEN (S1)
  5880              END-IF
  5881              MOVE ZEROS         TO WS-EXCL-PER (S1)
  5882                                    WS-MAX-EXTEN (S1)
  5883                                    WS-ACC-PER  (S1)
  5884              MOVE 999           TO WS-COV-ENDS (S1)
  5885              MOVE 01            TO WS-REC-MOS  (S1)
  5886           END-IF
  5887        END-IF
  5888     END-PERFORM
  5889
  5890*      SORT THE TABLE
  5891     MOVE HIGH-VALUES            TO WS-KEY (S1)
  5892     COMPUTE WS-MAX-SUB = S1 - +1
  5893     DISPLAY ' NSRLTRBL- JUST BUILT TABLE '   WS-MAX-SUB
  5894
  5895     MOVE WS-MAX-SUB             TO WS-CNTR
  5896
  5897     MOVE +1                     TO S2
  5898     MOVE +0                     TO S3
  5899     PERFORM UNTIL (WS-CNTR = ZERO) OR (S3 > 700)
  5900        MOVE +0 TO WS-HOLD-S1
  5901        MOVE HIGH-VALUES TO WS-HOLD-KEY
  5902        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  5903           (S1 > WS-MAX-SUB)
  5904           IF (WS-SORTED-SW (S1) NOT = 'Y')
  5905              AND (WS-KEY (S1) <= WS-HOLD-KEY)
  5906              MOVE WS-KEY (S1)   TO WS-HOLD-KEY
  5907              MOVE S1            TO WS-HOLD-S1
  5908           END-IF
  5909        END-PERFORM
  5910        IF WS-HOLD-S1 NOT = ZEROS
  5911           MOVE WS-HOLD-S1         TO S1
  5912           MOVE WS-KEY        (S1) TO WS-SRTD-KEY        (S2)
  5913           MOVE WS-STATUS     (S1) TO WS-SRTD-STATUS     (S2)
  5914           MOVE WS-MAX-BENS   (S1) TO WS-SRTD-MAX-BENS   (S2)
  5915           MOVE WS-EXCL-PER   (S1) TO WS-SRTD-EXCL-PER   (S2)
  5916           MOVE WS-COV-ENDS   (S1) TO WS-SRTD-COV-ENDS   (S2)
  5917           MOVE WS-ACC-PER    (S1) TO WS-SRTD-ACC-PER    (S2)
  5918           MOVE WS-REC-MOS    (S1) TO WS-SRTD-REC-MOS    (S2)
  5919           MOVE WS-MAX-EXTEN  (S1) TO WS-SRTD-MAX-EXTEN  (S2)
  5920           MOVE WS-PD-THRU-DT (S1) TO WS-SRTD-PD-THRU-DT (S2)
  5921           MOVE WS-CLAIM-NO   (S1) TO WS-SRTD-CLAIM-NO   (S2)
  5922           MOVE WS-MAX-MOBEN  (S1) TO WS-SRTD-MAX-MOBEN  (S2)
  5923           MOVE WS-TOTAL-PAID (S1) TO WS-SRTD-TOTAL-PAID (S2)
  5924*          MOVE WS-REM-BENS   (S1) TO WS-SRTD-REM-BENS   (S2)
  5925           MOVE 'Y'                TO WS-SORTED-SW       (S1)
  5926           SUBTRACT 1 FROM WS-CNTR
  5927           ADD +1 TO S2
  5928        END-IF
  5929        ADD 1 TO S3
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 104
* NSRLTRBL.cbl
  5930     END-PERFORM
  5931
  5932     DISPLAY ' NSRLTRBL- JUST SORTED TABLE '
  5933
  5934***  -----------------------
  5935     IF BL-COMP-ID NOT = 'DCC' AND 'VPP'
  5936        PERFORM 1900-BUILD-NON-DCC
  5937        GO TO 1800-EXIT
  5938     END-IF
  5939
  5940     MOVE SPACES                 TO WS-PREV-CLM-TYPE
  5941                                    WS-PREV-INS-TYPE
  5942     MOVE ZEROS                  TO WS-PREV-BEN-PER
  5943                                    WS-ACCUM-DAYS
  5944                                    WS-ACCUM-AMT
  5945                                    WS-ACCUM-PD-BENS
  5946
  5947     MOVE +1                     TO M1
  5948     PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  5949        S1 > WS-MAX-SUB
  5950        IF (WS-SRTD-CLM-TYPE (S1) = WS-PREV-CLM-TYPE)
  5951           AND (WS-SRTD-BEN-PER (S1) = WS-PREV-BEN-PER)
  5952           AND (WS-SRTD-INS-TYPE (S1) NOT = WS-PREV-INS-TYPE)
  5953           MOVE ZEROS            TO WS-ACCUM-DAYS
  5954                                    WS-ACCUM-AMT
  5955                                    WS-ACCUM-PD-BENS
  5956        END-IF
  5957        MOVE WS-SRTD-INS-TYPE (S1) TO WS-PREV-INS-TYPE
  5958        IF (WS-SRTD-CLM-TYPE (S1) = WS-PREV-CLM-TYPE)
  5959           AND (WS-SRTD-BEN-PER (S1) NOT = WS-PREV-BEN-PER)
  5960           MOVE ZEROS            TO WS-ACCUM-DAYS
  5961                                    WS-ACCUM-AMT
  5962                                    WS-ACCUM-PD-BENS
  5963        END-IF
  5964        MOVE WS-SRTD-BEN-PER (S1) TO WS-PREV-BEN-PER
  5965        IF WS-SRTD-CLM-TYPE (S1) NOT = WS-PREV-CLM-TYPE
  5966           PERFORM 1810-SET-NEW-HEAD
  5967                                 THRU 1810-EXIT
  5968           MOVE WS-SRTD-CLM-TYPE (S1)
  5969                                 TO WS-PREV-CLM-TYPE
  5970           ADD +1                TO M1
  5971        END-IF
  5972
  5973        MOVE WS-SRTD-BEN-PER (S1)  TO OUT-BEN-PER
  5974        IF WS-SRTD-INS-TYPE (S1) = '1'
  5975           MOVE 'PRIM'             TO OUT-INS-TYP
  5976        ELSE
  5977           MOVE 'COBO'             TO OUT-INS-TYP
  5978        END-IF
  5979*       EVALUATE WS-SRTD-STATUS (S1)
  5980*          WHEN 'C'
  5981*             MOVE 'CLOSED'        TO WSM-STATUS (M1)
  5982*          WHEN 'D'
  5983*             MOVE 'DENIED'        TO WSM-STATUS (M1)
  5984*          WHEN 'O'
  5985*             MOVE 'OPEN'          TO WSM-STATUS (M1)
  5986*          WHEN OTHER
  5987*             MOVE 'OTHER'         TO WSM-STATUS (M1)
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 105
* NSRLTRBL.cbl
  5988*       END-EVALUATE
  5989*       MOVE WS-SRTD-CLAIM-NO (S1) TO WSM-CLAIM-NO (M1)
  5990*                                     PI-WSM-CLAIM-NOS (S1)
  5991*       MOVE WS-SRTD-TOTAL-PAID (S1) TO WSM-TOTAL-PAID (M1)
  5992
  5993        COMPUTE OUT-MAX-BENS =
  5994           WS-SRTD-MAX-BENS (S1) - WS-ACCUM-PD-BENS
  5995
  5996        DISPLAY ' NSRLTRBL- MAX BENS 1 ' OUT-MAX-BENS ' '
  5997           WS-SRTD-MAX-BENS (S1) ' ' WS-ACCUM-PD-BENS
  5998
  5999        MOVE ZEROS TO WK1 WK2
  6000        IF WS-SRTD-MAX-MOBEN (S1) NOT = ZEROS
  6001           COMPUTE WS-PD-BENS ROUNDED =
  6002              WS-SRTD-TOTAL-PAID (S1) / WS-SRTD-MAX-MOBEN (S1)
  6003           IF WS-SRTD-CLM-TYPE (S1) NOT = 'L' AND 'P'
  6004              DIVIDE WS-SRTD-TOTAL-PAID (S1) BY
  6005                 WS-SRTD-MAX-MOBEN(S1) GIVING WK1
  6006                 REMAINDER WK2
  6007           END-IF
  6008        ELSE
  6009           MOVE ZEROS            TO WS-PD-BENS
  6010        END-IF
  6011        IF (WS-PD-BENS = ZEROS)
  6012           AND (WS-SRTD-CLM-TYPE (S1) = 'L' OR 'P')
  6013           AND (WS-SRTD-TOTAL-PAID (S1) > ZEROS)
  6014           MOVE 1                TO WS-PD-BENS
  6015        END-IF
  6016        MOVE WS-PD-BENS          TO OUT-PAID-BENS
  6017*       if wk2 not = zeros
  6018*          move '*'              to wsm-part (m1)
  6019*       end-if
  6020*       compute ws-accum-days =
  6021*          ws-accum-days + ws-srtd-days-paid (s1)
  6022        COMPUTE WS-ACCUM-AMT =
  6023           WS-ACCUM-AMT + WS-SRTD-TOTAL-PAID (S1)
  6024        DISPLAY ' NSRLTRBL- COMPUTE A PD BENS ' M1 ' '
  6025           WS-ACCUM-AMT ' ' WS-SRTD-MAX-MOBEN (S1)
  6026        IF WS-SRTD-MAX-MOBEN (S1) NOT = ZEROS
  6027           COMPUTE WS-ACCUM-PD-BENS ROUNDED =
  6028              WS-ACCUM-AMT / WS-SRTD-MAX-MOBEN (S1)
  6029        ELSE
  6030           MOVE ZEROS            TO WS-ACCUM-PD-BENS
  6031        END-IF
  6032        IF (WS-ACCUM-PD-BENS = ZEROS)
  6033           AND (WS-SRTD-CLM-TYPE (S1) = 'L' OR 'P')
  6034           AND (WS-SRTD-TOTAL-PAID (S1) > ZEROS)
  6035           MOVE 1                TO WS-ACCUM-PD-BENS
  6036        END-IF
  6037        DISPLAY ' NSRLTRBL- COMPUTE REM BENS ' M1 ' '
  6038           WS-SRTD-MAX-BENS (S1) ' ' WS-ACCUM-PD-BENS
  6039        COMPUTE OUT-REM-BENS =
  6040           WS-SRTD-MAX-BENS (S1) - WS-ACCUM-PD-BENS
  6041        PERFORM 1820-FIND-QUALIFY THRU 1820-EXIT
  6042
  6043*       MOVE ws-srtd-inc-dt (s1)    TO DC-BIN-DATE-1
  6044*       MOVE ' '                    TO DC-OPTION-CODE
  6045*       PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 106
* NSRLTRBL.cbl
  6046*       IF NO-CONVERSION-ERROR
  6047*          MOVE DC-GREG-DATE-A-EDIT TO wsm-inc-date (m1)
  6048*       ELSE
  6049*          MOVE SPACES              TO wsm-inc-date (m1)
  6050*       END-IF
  6051*       MOVE ws-srtd-pd-thru-dt (s1) TO DC-BIN-DATE-1
  6052*       MOVE ' '                     TO DC-OPTION-CODE
  6053*       PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  6054*       IF NO-CONVERSION-ERROR
  6055*          MOVE DC-GREG-DATE-A-EDIT TO wsm-pd-thru-dt (m1)
  6056*       ELSE
  6057*          MOVE SPACES              TO wsm-pd-thru-dt (m1)
  6058*       END-IF
  6059        ADD +1                   TO M1
  6060        IF WS-SRTD-CLAIM-NO (S1) = BL-CLAIM-NO
  6061           MOVE WS-SRTD-EXCL-PER (S1) TO OUT-EXCL-PER
  6062           MOVE 26 TO S1
  6063        END-IF
  6064
  6065     END-PERFORM
  6066
  6067    DISPLAY ' NSRLTRBL- 1800 end MAX BENS '  OUT-MAX-BENS
  6068    display  ' PAID BENS ' OUT-PAID-BENS ' REM BENS ' OUT-REM-BENS
  6069    display  ' EXCL PER ' OUT-EXCL-PER ' REC MOS ' OUT-REC-MOS
  6070    display  ' INS TYP ' OUT-INS-TYP ' BEN PER ' OUT-BEN-PER
  6071    display  ' ACC SW ' OUT-ACC-SW
  6072
  6073     .
  6074 1800-EXIT.
  6075     EXIT.
  6076
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 107
* NSRLTRBL.cbl
  6078
  6079 1810-SET-NEW-HEAD.
  6080     MOVE ZEROS                  TO WS-ACCUM-DAYS
  6081                                    WS-ACCUM-AMT
  6082                                    WS-ACCUM-PD-BENS
  6083     EVALUATE WS-SRTD-CLM-TYPE (S1)
  6084        WHEN 'A'
  6085           MOVE 'A&H'            TO WS-COV-TYPE
  6086        WHEN 'F'
  6087           MOVE 'FAM '           TO WS-COV-TYPE
  6088        WHEN 'I'
  6089           MOVE ' IU '           TO WS-COV-TYPE
  6090        WHEN 'L'
  6091           MOVE 'LIFE'           TO WS-COV-TYPE
  6092        WHEN OTHER
  6093           MOVE WS-SRTD-CLM-TYPE (S1)
  6094                                 TO WS-COV-TYPE
  6095     END-EVALUATE
  6096
  6097     MOVE WS-SRTD-REC-MOS (S1) TO OUT-REC-MOS
  6098     MOVE WS-SRTD-EXCL-PER (S1) TO OUT-EXCL-PER
  6099
  6100*    string '  ' ws-cov-type ' ExPer ' OUT-EXCL-PER
  6101*       ' CovEnd ' ws-srtd-cov-ends (s1)
  6102*       ' MaxBens ' ws-srtd-max-bens (s1)
  6103*       ' Recurring ' OUT-REC-MOS
  6104*       delimited by size into ws-map-output (m1)
  6105*    end-string
  6106
  6107     .
  6108 1810-EXIT.
  6109     EXIT.
  6110
  6111 1820-FIND-QUALIFY.
  6112     IF NOT PDEF-FOUND
  6113        GO TO 1820-EXIT
  6114     END-IF
  6115
  6116     DISPLAY ' NSRLTRBL- MAX BENS 2 ' OUT-MAX-BENS ' '
  6117        WS-SRTD-MAX-BENS (S1) ' ' WS-ACCUM-PD-BENS
  6118
  6119     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1
  6120     MOVE ws-srtd-inc-dt (s1)    TO DC-BIN-DATE-2
  6121     MOVE '1'                    TO DC-OPTION-CODE
  6122     MOVE +0                     TO DC-ELAPSED-MONTHS
  6123                                    DC-ELAPSED-DAYS
  6124     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  6125
  6126     IF NO-CONVERSION-ERROR
  6127        DISPLAY ' NSRLTRBL- GOOD DATE CONVERT '
  6128        MOVE DC-ELAPSED-MONTHS   TO WS-MONTHS-BETWEEN
  6129        IF DC-ELAPSED-DAYS > 1
  6130           ADD 1 TO WS-MONTHS-BETWEEN
  6131        END-IF
  6132     ELSE
  6133        MOVE ZEROS               TO WS-MONTHS-BETWEEN
  6134     END-IF
  6135
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 108
* NSRLTRBL.cbl
  6136     DISPLAY ' NSRLTRBL- DISPLAY 3 ' OUT-EXCL-PER
  6137        ' ' WS-SRTD-COV-ENDS (S1) ' ' WS-MONTHS-BETWEEN
  6138
  6139     EVALUATE TRUE
  6140        WHEN (OUT-EXCL-PER NOT = ZEROS)
  6141           AND (WS-MONTHS-BETWEEN <= OUT-EXCL-PER)
  6142           DISPLAY ' NSRLTRBL- ZERO 1 '
  6143           MOVE ZEROS TO OUT-MAX-BENS
  6144                         OUT-REM-BENS
  6145        WHEN (WS-SRTD-COV-ENDS (S1) NOT = ZEROS)
  6146           AND (WS-MONTHS-BETWEEN > WS-SRTD-COV-ENDS (S1))
  6147           DISPLAY ' NSRLTRBL- ZERO 2 '
  6148           MOVE ZEROS TO OUT-MAX-BENS
  6149     END-EVALUATE
  6150     IF OUT-REC-MOS < WS-SRTD-BEN-PER (S1)
  6151        MOVE ZEROS               TO OUT-REM-BENS
  6152     END-IF
  6153
  6154     .
  6155 1820-EXIT.
  6156     EXIT.
  6157
  6158 1850-GET-DDF-LIMITS.
  6159
  6160     IF CM-CLP-STATE = SPACES OR LOW-VALUES OR ZEROS
  6161        MOVE CM-STATE            TO CM-CLP-STATE
  6162     END-IF
  6163
  6164     MOVE CL-COMPANY-CD          TO ERPDEF-KEY
  6165     MOVE CM-CLP-STATE           TO ERPDEF-STATE
  6166     MOVE AM-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  6167
  6168     IF (CL-CLAIM-TYPE = 'L' OR 'P' OR 'O')
  6169        AND (CM-LF-BENEFIT-CD NOT = '00' AND '  ' AND 'DD')
  6170        MOVE 'L'                 TO ERPDEF-BEN-TYPE
  6171        MOVE CM-LF-BENEFIT-CD    TO ERPDEF-BEN-CODE
  6172     ELSE
  6173        MOVE 'A'                 TO ERPDEF-BEN-TYPE
  6174        MOVE CM-AH-BENEFIT-CD    TO ERPDEF-BEN-CODE
  6175     END-IF
  6176
  6177     MOVE CM-CERT-EFF-DT         TO ERPDEF-EXP-DT
  6178
  6179     DISPLAY ' NSRLTRBL- MADE 1850 ' ERPDEF-KEY (2:15)
  6180     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  6181
  6182
  6183* EXEC CICS STARTBR
  6184*        DATASET  ('ERPDEF')
  6185*        RIDFLD   (ERPDEF-KEY)
  6186*        GTEQ
  6187*        RESP     (WS-RESPONSE)
  6188*    END-EXEC
  6189     MOVE 'ERPDEF' TO DFHEIV1
  6190     MOVE 0
  6191       TO DFHEIV11
  6192*    MOVE '&,         G          &  N#00005785' TO DFHEIV0
  6193     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 109
* NSRLTRBL.cbl
  6194     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6195     MOVE X'204E233030303035373835' TO DFHEIV0(25:11)
  6196     CALL 'kxdfhei1' USING DFHEIV0,
  6197           DFHEIV1,
  6198           ERPDEF-KEY,
  6199           DFHEIV99,
  6200           DFHEIV11,
  6201           DFHEIV99
  6202     MOVE EIBRESP  TO WS-RESPONSE
  6203     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6204
  6205     IF NOT RESP-NORMAL
  6206        GO TO 1850-EXIT
  6207     END-IF
  6208
  6209     .
  6210 1850-READNEXT.
  6211
  6212
  6213* EXEC CICS READNEXT
  6214*       DATASET  ('ERPDEF')
  6215*       INTO     (PRODUCT-MASTER)
  6216*       RIDFLD   (ERPDEF-KEY)
  6217*       RESP     (WS-RESPONSE)
  6218*    END-EXEC
  6219     MOVE LENGTH OF
  6220      PRODUCT-MASTER
  6221       TO DFHEIV12
  6222     MOVE 'ERPDEF' TO DFHEIV1
  6223     MOVE 0
  6224       TO DFHEIV11
  6225*    MOVE '&.IL                  )  N#00005799' TO DFHEIV0
  6226     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  6227     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6228     MOVE X'204E233030303035373939' TO DFHEIV0(25:11)
  6229     CALL 'kxdfhei1' USING DFHEIV0,
  6230           DFHEIV1,
  6231           PRODUCT-MASTER,
  6232           DFHEIV12,
  6233           ERPDEF-KEY,
  6234           DFHEIV99,
  6235           DFHEIV11,
  6236           DFHEIV99,
  6237           DFHEIV99
  6238     MOVE EIBRESP  TO WS-RESPONSE
  6239     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6240
  6241     IF NOT RESP-NORMAL
  6242        GO TO 1850-ENDBR
  6243     END-IF
  6244
  6245     IF (ERPDEF-KEY-SAVE (1:16) = PD-CONTROL-PRIMARY (1:16))
  6246        IF (CM-CERT-EFF-DT < PD-PROD-EXP-DT)
  6247           MOVE 'Y'              TO WS-PDEF-RECORD-SW
  6248           DISPLAY ' NSRLTRBL- SETTING PDEF FOUND TO TRUE '
  6249        ELSE
  6250           GO TO 1850-READNEXT
  6251        END-IF
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 110
* NSRLTRBL.cbl
  6252     ELSE
  6253        GO TO 1850-ENDBR
  6254     END-IF
  6255
  6256     .
  6257 1850-ENDBR.
  6258
  6259
  6260* EXEC CICS ENDBR
  6261*       DATASET  ('ERPDEF')
  6262*    END-EXEC
  6263     MOVE 'ERPDEF' TO DFHEIV1
  6264     MOVE 0
  6265       TO DFHEIV11
  6266*    MOVE '&2                    $   #00005824' TO DFHEIV0
  6267     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6268     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6269     MOVE X'2020233030303035383234' TO DFHEIV0(25:11)
  6270     CALL 'kxdfhei1' USING DFHEIV0,
  6271           DFHEIV1,
  6272           DFHEIV11,
  6273           DFHEIV99
  6274     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6275
  6276     .
  6277 1850-EXIT.
  6278     EXIT.
  6279
  6280 1900-BUILD-NON-DCC.
  6281
  6282     MOVE SPACES                 TO WS-PREV-CLM-TYPE
  6283                                    WS-PREV-INS-TYPE
  6284     MOVE ZEROS                  TO WS-PREV-BEN-PER
  6285                                    WS-ACCUM-DAYS
  6286                                    WS-ACCUM-AMT
  6287                                    WS-ACCUM-PD-BENS
  6288
  6289     MOVE +1                     TO M1
  6290     PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  6291        S1 > WS-MAX-SUB
  6292        IF WS-SRTD-CLM-TYPE (S1) NOT = WS-PREV-CLM-TYPE
  6293           PERFORM 1810-SET-NEW-HEAD
  6294                                 THRU 1810-EXIT
  6295           MOVE WS-SRTD-CLM-TYPE (S1)
  6296                                 TO WS-PREV-CLM-TYPE
  6297           ADD +1                TO M1
  6298        END-IF
  6299        MOVE WS-SRTD-BEN-PER (S1)  TO OUT-BEN-PER
  6300        IF WS-SRTD-INS-TYPE (S1) = '1'
  6301           MOVE 'PRIM'             TO OUT-INS-TYP
  6302        ELSE
  6303           MOVE 'COBO'             TO OUT-INS-TYP
  6304        END-IF
  6305*       evaluate ws-srtd-status (s1)
  6306*          when 'C'
  6307*             MOVE 'CLOSED'        TO WSM-STATUS (M1)
  6308*          WHEN 'D'
  6309*             MOVE 'DENIED'        TO WSM-STATUS (M1)
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 111
* NSRLTRBL.cbl
  6310*          WHEN 'O'
  6311*             MOVE 'OPEN'          TO WSM-STATUS (M1)
  6312*          WHEN OTHER
  6313*             MOVE 'OTHER'         TO WSM-STATUS (M1)
  6314*       END-EVALUATE
  6315*       move ws-srtd-claim-no (s1) to wsm-claim-no (m1)
  6316*                                     pi-wsm-claim-nos (s1)
  6317*       move ws-srtd-total-paid (s1) to wsm-total-paid (m1)
  6318
  6319        COMPUTE OUT-MAX-BENS =
  6320           WS-SRTD-MAX-BENS (S1) - WS-ACCUM-PD-BENS
  6321
  6322        DISPLAY ' NSRLTRBL- MAX BENS 1 ' OUT-MAX-BENS ' '
  6323           WS-SRTD-MAX-BENS (S1) ' ' WS-ACCUM-PD-BENS
  6324
  6325        MOVE ZEROS TO WK1 WK2
  6326        IF WS-SRTD-MAX-MOBEN (S1) NOT = ZEROS
  6327           COMPUTE WS-PD-BENS ROUNDED =
  6328              WS-SRTD-TOTAL-PAID (S1) / WS-SRTD-MAX-MOBEN (S1)
  6329           IF WS-SRTD-CLM-TYPE (S1) NOT = 'L' AND 'P'
  6330              DIVIDE WS-SRTD-TOTAL-PAID (S1) BY
  6331                 WS-SRTD-MAX-MOBEN(S1) GIVING WK1
  6332                 REMAINDER WK2
  6333           END-IF
  6334        ELSE
  6335           MOVE ZEROS            TO WS-PD-BENS
  6336        END-IF
  6337        IF (WS-PD-BENS = ZEROS)
  6338           AND (WS-SRTD-CLM-TYPE (S1) = 'L' OR 'P')
  6339           AND (WS-SRTD-TOTAL-PAID (S1) > ZEROS)
  6340           MOVE 1                TO WS-PD-BENS
  6341        END-IF
  6342        MOVE WS-PD-BENS          TO OUT-PAID-BENS
  6343*       IF WK2 NOT = ZEROS
  6344*          MOVE '*'              TO WSM-PART (M1)
  6345*       END-IF
  6346        COMPUTE WS-ACCUM-AMT =
  6347           WS-ACCUM-AMT + WS-SRTD-TOTAL-PAID (S1)
  6348        DISPLAY ' NSRLTRBL- COMPUTE A PD BENS ' M1 ' '
  6349           WS-ACCUM-AMT ' ' WS-SRTD-MAX-MOBEN (S1)
  6350        IF WS-SRTD-MAX-MOBEN (S1) NOT = ZEROS
  6351           COMPUTE WS-ACCUM-PD-BENS ROUNDED =
  6352              WS-ACCUM-AMT / WS-SRTD-MAX-MOBEN (S1)
  6353        ELSE
  6354           MOVE ZEROS            TO WS-ACCUM-PD-BENS
  6355        END-IF
  6356        IF (WS-ACCUM-PD-BENS = ZEROS)
  6357           AND (WS-SRTD-CLM-TYPE (S1) = 'L' OR 'P')
  6358           AND (WS-SRTD-TOTAL-PAID (S1) > ZEROS)
  6359           MOVE 1                TO WS-ACCUM-PD-BENS
  6360        END-IF
  6361        DISPLAY ' NSRLTRBL- COMPUTE REM BENS ' M1 ' '
  6362           WS-SRTD-MAX-BENS (S1) ' ' WS-ACCUM-PD-BENS
  6363        COMPUTE OUT-REM-BENS =
  6364           WS-SRTD-MAX-BENS (S1) - WS-ACCUM-PD-BENS
  6365
  6366*       MOVE ws-srtd-inc-dt (s1)    TO DC-BIN-DATE-1
  6367*       MOVE ' '                    TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 112
* NSRLTRBL.cbl
  6368*       PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  6369*       IF NO-CONVERSION-ERROR
  6370*          MOVE DC-GREG-DATE-A-EDIT TO wsm-inc-date (m1)
  6371*       ELSE
  6372*          MOVE SPACES              TO wsm-inc-date (m1)
  6373*       END-IF
  6374*       MOVE ws-srtd-pd-thru-dt (s1) TO DC-BIN-DATE-1
  6375*       MOVE ' '                     TO DC-OPTION-CODE
  6376*       PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  6377*       IF NO-CONVERSION-ERROR
  6378*          MOVE DC-GREG-DATE-A-EDIT TO wsm-pd-thru-dt (m1)
  6379*       ELSE
  6380*          MOVE SPACES              TO wsm-pd-thru-dt (m1)
  6381*       END-IF
  6382*       move WS-MAP-OUTPUT (m1)  to replineo (m1)
  6383        IF WS-SRTD-CLAIM-NO (S1) = BL-CLAIM-NO
  6384           MOVE WS-SRTD-EXCL-PER (S1) TO OUT-EXCL-PER
  6385           MOVE 26 TO S1
  6386        END-IF
  6387
  6388        ADD +1                   TO M1
  6389     END-PERFORM
  6390     DISPLAY ' NSRLTRBL- 1900 end MAX BENS '  OUT-MAX-BENS
  6391     display ' PAID BENS ' OUT-PAID-BENS ' REM BENS ' OUT-REM-BENS
  6392     display ' EXCL PER ' OUT-EXCL-PER ' REC MOS ' OUT-REC-MOS
  6393     display ' INS TYP ' OUT-INS-TYP ' BEN PER ' OUT-BEN-PER
  6394     display ' ACC SW ' OUT-ACC-SW
  6395     .
  6396 2000-BUILD-ELNAPS.
  6397     PERFORM 1500-GET-ARCH-NO    THRU 1500-EXIT
  6398     MOVE 'NA'                   TO NAPERSOFT-FILE
  6399     MOVE CL-COMPANY-CD          TO NA-COMPANY-CD
  6400     MOVE BL-CARRIER             TO NA-CARRIER
  6401     MOVE BL-CLAIM-NO            TO NA-CLAIM-NO
  6402     MOVE BL-CERT-NO             TO NA-CERT-NO
  6403     MOVE WS-ARCHIVE-NO          TO NA-ARCHIVE-NO
  6404                                    BL-ARCHIVE-NO
  6405     MOVE BL-LETTER-ID           TO NA-LETTER-ID
  6406     MOVE BL-NO-OF-COPIES        TO NA-NO-OF-COPIES
  6407     MOVE SAVE-BIN-DATE          TO NA-CREATION-DT
  6408                                    NA-INITIAL-PRINT-DT
  6409     MOVE LOW-VALUES             TO NA-FOLLOW-UP-DT
  6410                                    NA-RESEND-DT
  6411                                    NA-RESEND-PRINT-DT
  6412                                    NA-1ST-LTR-PRINT-DT
  6413                                    NA-NEXT-DUE-DT
  6414                                    NA-AUTOPYDT
  6415     MOVE CL-TRAILER-SEQ-CNT     TO NA-CORR-TRLR-SEQ
  6416     IF BL-FOLLOW-UP-DT NOT = SPACES AND LOW-VALUES
  6417        STRING BL-FOLLOW-UP-DT (7:2) BL-FOLLOW-UP-DT (1:2)
  6418           BL-FOLLOW-UP-DT (4:2) DELIMITED BY SIZE
  6419             INTO DC-GREG-DATE-1-YMD-R
  6420        END-STRING
  6421        MOVE '3'                 TO DC-OPTION-CODE
  6422        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  6423        IF NO-CONVERSION-ERROR
  6424           MOVE DC-BIN-DATE-1    TO NA-FOLLOW-UP-DT
  6425                                    WS-FOLLOW-UP-DT
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 113
* NSRLTRBL.cbl
  6426        ELSE
  6427           MOVE LOW-VALUES       TO NA-FOLLOW-UP-DT
  6428                                    WS-FOLLOW-UP-DT
  6429        END-IF
  6430     END-IF
  6431     IF BL-RESEND-DT NOT = SPACES AND LOW-VALUES
  6432        STRING BL-RESEND-DT (7:2) BL-RESEND-DT (1:2)
  6433           BL-RESEND-DT (4:2) DELIMITED BY SIZE
  6434             INTO DC-GREG-DATE-1-YMD-R
  6435        END-STRING
  6436        MOVE '3'                 TO DC-OPTION-CODE
  6437        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  6438        IF NO-CONVERSION-ERROR
  6439           MOVE DC-BIN-DATE-1    TO NA-RESEND-DT
  6440                                    WS-RESEND-DT
  6441        ELSE
  6442           MOVE LOW-VALUES       TO NA-RESEND-DT
  6443                                    WS-RESEND-DT
  6444        END-IF
  6445     END-IF
  6446     PERFORM WITH TEST AFTER UNTIL RESP-NORMAL
  6447
  6448* EXEC CICS WRITE
  6449*          DATASET   ('ELNAPS')
  6450*          FROM      (NAPERSOFT-FILE)
  6451*          RIDFLD    (NA-CONTROL-PRIMARY)
  6452*          RESP      (WS-RESPONSE)
  6453*       END-EXEC
  6454     MOVE LENGTH OF
  6455      NAPERSOFT-FILE
  6456       TO DFHEIV11
  6457     MOVE 'ELNAPS' TO DFHEIV1
  6458*    MOVE '&$ L                  ''  N#00005999' TO DFHEIV0
  6459     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6460     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6461     MOVE X'204E233030303035393939' TO DFHEIV0(25:11)
  6462     CALL 'kxdfhei1' USING DFHEIV0,
  6463           DFHEIV1,
  6464           NAPERSOFT-FILE,
  6465           DFHEIV11,
  6466           NA-CONTROL-PRIMARY,
  6467           DFHEIV99,
  6468           DFHEIV99
  6469     MOVE EIBRESP  TO WS-RESPONSE
  6470     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6471        IF RESP-NORMAL
  6472           CONTINUE
  6473        ELSE
  6474           IF RESP-DUPREC OR RESP-DUPKEY
  6475              ADD +1 TO NA-ARCHIVE-NO
  6476           ELSE
  6477              DISPLAY ' BAD WRITE ELNAPS ' WS-RESPONSE
  6478                 ' ' NA-CONTROL-PRIMARY (2:19)
  6479              SET RESP-NORMAL TO TRUE
  6480           END-IF
  6481        END-IF
  6482     END-PERFORM
  6483    .
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 114
* NSRLTRBL.cbl
  6484 2000-EXIT.
  6485     EXIT.
  6486 9700-DATE-LINK.
  6487
  6488* EXEC CICS LINK
  6489*        PROGRAM   ('ELDATCV')
  6490*        COMMAREA  (DATE-CONVERSION-DATA)
  6491*        LENGTH    (DC-COMM-LENGTH)
  6492*    END-EXEC.
  6493     MOVE 'ELDATCV' TO DFHEIV1
  6494*    MOVE '."C                   (   #00006021' TO DFHEIV0
  6495     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  6496     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6497     MOVE X'2020233030303036303231' TO DFHEIV0(25:11)
  6498     CALL 'kxdfhei1' USING DFHEIV0,
  6499           DFHEIV1,
  6500           DATE-CONVERSION-DATA,
  6501           DC-COMM-LENGTH,
  6502           DFHEIV99,
  6503           DFHEIV99,
  6504           DFHEIV99,
  6505           DFHEIV99
  6506     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6507
  6508 9700-EXIT.
  6509      EXIT.
  6510
  6511 9999-DFHBACK SECTION.
  6512     MOVE '9%                    "   ' TO DFHEIV0
  6513     MOVE 'NSRLTRBL' TO DFHEIV1
  6514     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  6515     GOBACK.
  6516 9999-DFHEXIT.
  6517     IF DFHEIGDJ EQUAL 0001
  6518         NEXT SENTENCE.
  6519     MOVE '9%                    "   ' TO DFHEIV0
  6520     MOVE 'NSRLTRBL' TO DFHEIV1
  6521     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  6522     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       19096     Code:       16901
