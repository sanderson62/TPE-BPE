* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page   1
* EL6501.cbl
* Options: int("EL6501.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL6501.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL6501.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL6501.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL6501.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 05/11/94 14:25:07.
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.060.
     9
    10*AUTHOR.        LOGIC,INC.
    11*               DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page   2
* EL6501.cbl
    14
    15*SECURITY.   *****************************************************
    16*            *                                                   *
    17*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    18*            *                                                   *
    19*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    22*            *                                                   *
    23*            *****************************************************
    24*
    25*REMARKS.
    26*        TRANSACTION - EXC5 - ACCOUNT MAINT (GENERAL)
    27******************************************************************
    28*                   C H A N G E   L O G
    29*
    30* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    31*-----------------------------------------------------------------
    32*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    33* EFFECTIVE    NUMBER
    34*-----------------------------------------------------------------
    35* 101101    2001100100006  SMVA  ADD USERID & COMPANY ID(CMPNYID)
    36*                                ADJUSTED MAP-R REDEFINES FILLER
    37* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    38*                          SMVA  ADD CLP TOL PCT CODE
    39* 102004                   PEMA  ADD STATUS OF CANCEL
    40* 092705  CR2005050300006  PEMA  ADD SPP LEASES
    41* 021506  CR2006021400002  PEMA  DARKEN DCC FIELDS FOR CID
    42* 052306  CR2006050800002  PEMA  ADD COMM TYPE J
    43* 111606  CR2002061800017  PEMA  FIX ERCOMP UPDATE ROUTINE
    44* 110706  CR2006071700002  PEMA  FIX NAME LOOK UP
    45* 031607                   PEMA  PER TRWA AND KLSC DEFAULT TO P
    46* 062707  CR2007010300002  PEMA  REMOVE LEV 5 RESTRICTION FOR DCC
    47* 071207                   PEMA  ADD NEW TYPE 'M'
    48* 080807  CR2006062900001  PEMA  AUTOMATE STEPS TO CANCEL ACCT
    49* 022808  CR2007083100002  PEMA  ADD 'F' ACCT STATUS
    50* 042809    2007070200004  PEMA  ADD EDIT FOR KY ACCOUNTS
    51* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
    52* 020210  CR2020010400006  PEMA  REMOVE CHANGES MADE ON 09/09
    53* 031811  CR2011012700001  PEMA  ADD 'S' ACCT STATUS
    54* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
    55* 080612  CR2012042700005  PEMA  ADD OVER 120 DAYS FOR AHL
    56* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
    57* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
    58* 070714    2014052800001  PEMA  correct read on erpdef for DCC
    59******************************************************************
    60
    61 ENVIRONMENT DIVISION.
    62 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page   3
* EL6501.cbl
    64 WORKING-STORAGE SECTION.
    65 01  DFH-START PIC X(04).
    66 77  LCP-WS-ADDR-COMP              PIC S9(8) COMP.
    67 77  LCP-WS-ADDR-PNTR              REDEFINES LCP-WS-ADDR-COMP
    68                                   USAGE POINTER.
    69 77  FILLER  PIC X(32)  VALUE '********************************'.
    70 77  FILLER  PIC X(32)  VALUE '*    EL6501 WORKING STORAGE    *'.
    71 77  FILLER  PIC X(32)  VALUE '********* VMOD=2.060 ***********'.
    72 77  WS-LAST-DATE-RANGE-SW       PIC X    VALUE SPACES.
    73     88  ON-LAST-DATE-RANGE             VALUE 'Y'.
    74 77  WS-AUTO-CANCEL-SW           PIC X  VALUE ' '.
    75     88  AUTO-CANCEL-ACCOUNT            VALUE 'Y'.
    76 77  WS-DELAY-INT                PIC S9(7) VALUE +2.
    77 77  WS-CHANGE-ALL-CNT           PIC S999  VALUE +0.
    78 01  WS-DEGUG-AREA.
    79     05  FILLER PIC X(20) VALUE '&&&&&& DEBUG &&&&&&&'.
    80     05  FILLER PIC X(20) VALUE '  PAGE NUMBER HERE  '.
    81     05  WS-PAGE-NUMBER PIC 99 VALUE ZEROS.
    82     05  FILLER PIC X(20) VALUE '  TOTAL LINES HERE  '.
    83     05  WS-TOTAL-LINES PIC 99 VALUE ZEROS.
    84     05  FILLER PIC X(20) VALUE ' LINE SELECTED HERE '.
    85     05  WS-LINE-SELECTED PIC 99 VALUE ZEROS.
    86     05  FILLER PIC X(20) VALUE '&&&&&& DEBUG &&&&&&&'.
    87 01  S1                          PIC S999   VALUE +0    COMP.
    88 01  WS-WORK-FIELD.
    89     12  WS-WORK-NUM                 PIC 9(5)    VALUE ZEROS.
    90 01  WS-COMM-LENGTH              PIC S9(4) COMP VALUE +1500.
    91 01  WS-DATE-AREA.
    92     12  SAVE-DATE               PIC X(8)    VALUE SPACES.
    93     12  SAVE-BIN-DATE           PIC XX      VALUE SPACES.
    94
    95***DMD CUSTOM CODE *****START
    96     12  WS-DMD-EXPR-DATE        PIC 9(8) COMP-3.
    97     12  WS-DMD-AGENT            PIC X(10).
    98     12  WS-YYYYMMDD             PIC X(8).
    99     12  WS-COMP-DATE REDEFINES WS-YYYYMMDD
   100                                 PIC 9(8).
   101***DMD CUSTOM CODE *****END
   102
   103 01  WS-ACCOUNT-NUM-AREA.
   104     12  WS-ACCOUNT-FILLER       PIC X(06).
   105     12  WS-ACCT-BRANCH-CD       PIC X(04).
   106
   107 01  WS-NAME-AREA.
   108     12  WS-NAME-1-4             PIC X(04).
   109     12  WS-NAME-FILLER          PIC X(26).
   110
   111 01  STANDARD-AREAS.
   112     12  WS-STATE-MAX-SW         PIC X       VALUE ' '.
   113         88  EXCEEDS-STATE-MAX      VALUE 'Y'.
   114     12  WS-RESPONSE             PIC S9(8)   COMP.
   115         88  RESP-NORMAL                  VALUE +00.
   116         88  RESP-NOTFND                  VALUE +13.
   117         88  RESP-DUPREC                  VALUE +14.
   118         88  RESP-DUPKEY                  VALUE +15.
   119         88  RESP-NOTOPEN                 VALUE +19.
   120         88  RESP-ENDFILE                 VALUE +20.
   121
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page   4
* EL6501.cbl
   122     12  GETMAIN-SPACE           PIC X       VALUE SPACE.
   123     12  MAP-NAME                PIC X(8)    VALUE 'EL6501A'.
   124     12  MAPSET-NAME             PIC X(8)    VALUE 'EL6501S'.
   125     12  SCREEN-NUMBER           PIC X(4)    VALUE '650B'.
   126     12  TRANS-ID                PIC X(4)    VALUE 'EXC5'.
   127     12  THIS-PGM                PIC X(8)    VALUE 'EL6501'.
   128     12  PGM-NAME                PIC X(8).
   129     12  TIME-IN                 PIC S9(7).
   130     12  TIME-OUT-R REDEFINES TIME-IN.
   131         16  FILLER              PIC X.
   132         16  TIME-OUT            PIC 99V99.
   133         16  FILLER              PIC XX.
   134     12  XCTL-005                PIC X(8)    VALUE 'EL005'.
   135     12  XCTL-010                PIC X(8)    VALUE 'EL010'.
   136     12  XCTL-126                PIC X(8)    VALUE 'EL126'.
   137     12  XCTL-601                PIC X(8)    VALUE 'EL601'.
   138     12  XCTL-608                PIC X(8)    VALUE 'EL608'.
   139     12  XCTL-626                PIC X(8)    VALUE 'EL626'.
   140     12  XCTL-650                PIC X(8)    VALUE 'EL650'.
   141     12  XCTL-6502               PIC X(8)    VALUE 'EL6502'.
   142     12  XCTL-6503               PIC X(8)    VALUE 'EL6503'.
   143     12  XCTL-6504               PIC X(8)    VALUE 'EL6504'.
   144     12  XCTL-6505               PIC X(8)    VALUE 'EL6505'.
   145     12  XCTL-6506               PIC X(8)    VALUE 'EL6506'.
   146     12  XCTL-652                PIC X(8)    VALUE 'EL652'.
   147     12  XCTL-689                PIC X(8)    VALUE 'EL689'.
   148     12  XCTL-690                PIC X(8)    VALUE 'EL690'.
   149     12  XCTL-653                PIC X(8)    VALUE 'EL653'.
   150     12  LINK-001                PIC X(8)    VALUE 'EL001'.
   151     12  LINK-004                PIC X(8)    VALUE 'EL004'.
   152     12  LINK-ELDATCV            PIC X(8)    VALUE 'ELDATCV'.
   153     12  FILE-ID                 PIC X(8).
   154     12  CNTL-FILE-ID            PIC X(8)    VALUE 'ELCNTL'.
   155     12  ACCT-FILE-ID            PIC X(8)    VALUE 'ERACCT'.
   156     12  ERACNT-FILE-ID          PIC X(8)    VALUE 'ERACNT'.
   157     12  REIN-FILE-ID            PIC X(8)    VALUE 'ERREIN'.
   158     12  COMM-FILE-ID            PIC X(8)    VALUE 'ERCTBL'.
   159     12  COMP-FILE-ID            PIC X(8)    VALUE 'ERCOMP'.
   160     12  NAME-FILE-ID            PIC X(8)    VALUE 'ERNAME'.
   161     12  RQST-FILE-ID            PIC X(8)    VALUE 'ERRQST'.
   162     12  RQST3-FILE-ID           PIC X(8)    VALUE 'ERRQST3'.
   163     12  ERGXRF-FILE-ID          PIC X(8)    VALUE 'ERGXRF'.
   164     12  ACCT-REC-LEN            PIC S9(4)   VALUE +2000  COMP.
   165     12  ERACNT-REC-LEN          PIC S9(4)   VALUE +120   COMP.
   166     12  SC-ITEM                 PIC S9(4)   VALUE +1     COMP.
   167     12  COMP-REC-LEN            PIC S9(4)   VALUE +700   COMP.
   168     12  NAME-REC-LEN            PIC S9(4)   VALUE +160   COMP.
   169     12  ERGXRF-REC-LEN          PIC S9(4)   VALUE +0     COMP.
   170     12  ERGXRF-INC-LEN          PIC S9(4)   VALUE +31    COMP.
   171     12  ERGXRF-MIN-LEN          PIC S9(4)   VALUE +109   COMP.
   172     12  ERGXRF-MAX-LEN          PIC S9(8)   VALUE +31264 COMP.
   173     12  CNTL-REC-LEN            PIC S9(4)   VALUE +750   COMP.
   174     12  JRNL-REC-LEN            PIC S9(4)   VALUE ZERO   COMP.
   175*                                copy ERCGXRF.
   176******************************************************************
   177*                                                                *
   178*                                                                *
   179*                            ERCGXRF                             *
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page   5
* EL6501.cbl
   180*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   181*                            VMOD=2.002                          *
   182*                                                                *
   183*   ONLINE CREDIT SYSTEM                                         *
   184*                                                                *
   185*   FILE DESCRIPTION = GENERAL AGENT CROSS REFERENCE             *
   186*                                                                *
   187*   FILE TYPE = VSAM,KSDS                                        *
   188*   RECORD SIZE = 62 - 32,062   RECFORM = VARIABLE
   189*                                                                *
   190*   BASE CLUSTER NAME = ERGXRF                   RKP=2,LEN=18    *
   191*       ALTERNATE PATH = NONE                                    *
   192*                                                                *
   193*   LOG = NO                                                     *
   194*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   195*                                                                *
   196******************************************************************
   197
   198 01  AGENT-CROSS-REFERENCE.
   199     12  GX-RECORD-ID                PIC XX.
   200         88  VALID-GX-ID             VALUE 'GX'.
   201
   202     12  GX-CONTROL-PRIMARY.
   203         16  GX-COMPANY-CD           PIC X.
   204         16  GX-CARRIER              PIC X.
   205         16  GX-GROUPING             PIC X(6).
   206         16  GX-AGENT-NO             PIC X(10).
   207
   208     12  GX-MAINT-INFORMATION.
   209         16  GX-LAST-MAINT-DT        PIC XX.
   210         16  GX-LAST-MAINT-HHMMSS    PIC S9(7)  COMP-3.
   211         16  GX-LAST-MAINT-USER      PIC X(4).
   212         16  FILLER                  PIC X(9).
   213
   214     12  FILLER                      PIC X(37).
   215
   216     12  GX-AGENT-POINTER-CNT        PIC S9(4)  COMP.
   217
   218     12  GX-AGENT-POINTER   OCCURS 1 TO 1006 TIMES
   219                            DEPENDING ON GX-AGENT-POINTER-CNT.
   220         16  GX-AM-CARRIER           PIC X.
   221         16  GX-AM-GROUPING          PIC X(6).
   222         16  GX-AM-STATE             PIC XX.
   223         16  GX-AM-ACCOUNT           PIC X(10).
   224         16  GX-AM-EXPIRATION-DT     PIC XX.
   225         16  GX-AM-LEVEL-NO          PIC S9(4)     COMP.
   226         16  GX-LAST-BILL-DT         PIC XX.
   227         16  GX-AM-EFF-DT            PIC XX.
   228         16  FILLER                  PIC X(4).
   229
   230******************************************************************
   231 01  ERPDEF-KEY-SAVE             PIC X(18).
   232 01  ERPDEF-KEY.
   233     12  ERPDEF-COMPANY-CD       PIC X.
   234     12  ERPDEF-STATE            PIC XX.
   235     12  ERPDEF-PROD-CD          PIC XXX.
   236     12  F                       PIC X(7).
   237     12  ERPDEF-BEN-TYPE         PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page   6
* EL6501.cbl
   238     12  ERPDEF-BEN-CODE         PIC XX.
   239     12  ERPDEF-EXP-DT           PIC XX.
   240 01  WORK-AREAS-AND-SWITCHES.
   241     12  ws-comp-cd-dis          pic s9(4) comp value +0.
   242     12  filler redefines ws-comp-cd-dis.
   243         16  filler              pic x.
   244         16  ws-comp-cd          pic x.
   245     12  W-ONE                   PIC S9(04)  COMP   VALUE +1.
   246     12  WS-TABLE-MAX            PIC S9V9(4) COMP-3 VALUE +0.
   247     12  WS-ST-COMMISSION-CAPS.
   248         16  WS-ST-COMM-CAP-SL   PIC S9V9(4) COMP-3 VALUE +0.
   249         16  WS-ST-COMM-CAP-JL   PIC S9V9(4) COMP-3 VALUE +0.
   250         16  WS-ST-COMM-CAP-SA   PIC S9V9(4) COMP-3 VALUE +0.
   251         16  WS-ST-COMM-CAP-JA   PIC S9V9(4) COMP-3 VALUE +0.
   252     12  WS-DCC-MAX-MARKET-FEE   PIC S9(5)   COMP-3 VALUE +100.
   253     12  WS-COMM-CAP-LIMIT-TO    PIC X.
   254         88  WS-LIMIT-TO-ACCOUNT             VALUE 'A'.
   255
   256     12  COMMISSION-ACCUMS.
   257         16  COMM-SL-ACCUM       PIC S9V9(4) COMP-3 VALUE ZERO.
   258         16  COMM-JL-ACCUM       PIC S9V9(4) COMP-3 VALUE ZERO.
   259         16  COMM-AH-ACCUM       PIC S9V9(4) COMP-3 VALUE ZERO.
   260         16  COMM-MFEE-ACCUM     PIC S9(5)   COMP-3 VALUE ZERO.
   261
   262     12  SAVE-FIN-RESP           PIC X(10)   VALUE SPACES.
   263     12  SAVE-ACCT-AGENT         PIC X(10)   VALUE SPACES.
   264     12  SAVE-NEW-ACCT-AGENT     PIC X(10)   VALUE SPACES.
   265     12  SUB1                    PIC S9(4)   VALUE +0 COMP.
   266     12  WS-NDX                  PIC S9(5)   VALUE +0 COMP-3.
   267     12  CURRENT-SAVE            PIC 9(8).
   268     12  BIN-CURRENT-SAVE        PIC XX.
   269     12  CYMD-CURRENT-SAVE       PIC 9(8).
   270     12  SUB                     PIC 99.
   271     12  AGT-SUB                 PIC 99      VALUE ZEROS.
   272     12  VALID-AGT-SW            PIC X       VALUE 'N'.
   273     12  CHANGE-WAS-MADE-SW      PIC X       VALUE 'N'.
   274         88  CHANGE-WAS-MADE                 VALUE 'Y'.
   275
   276     12  WS-EDIT-BEN-CODE        PIC XX.
   277         88  INVALID-BENEFIT-CODE   VALUE '  ' '00'
   278                                          '90' THRU '99'.
   279
   280     12  WS-KEY-SAVE.
   281           18  WS-ACCT-CCGSA-KEY.
   282             20  WS-ACCT-CO             PIC X.
   283             20  WS-ACCT-CARRIER        PIC X.
   284             20  WS-ACCT-GROUPING       PIC X(6).
   285             20  WS-ACCT-STATE          PIC XX.
   286             20  WS-ACCT-ACCOUNT        PIC X(10).
   287           18  WS-ACCT-EXP-DT           PIC XX.
   288           18  WS-ACCT-REST-OF-EXP      PIC X(4).
   289
   290     12  DEEDIT-FIELD                   PIC X(15).
   291     12  DEEDIT-FIELD-V0 REDEFINES DEEDIT-FIELD   PIC S9(15).
   292     12  DEEDIT-FIELD-V1 REDEFINES DEEDIT-FIELD   PIC S9(14)V9.
   293     12  DEEDIT-FIELD-V2 REDEFINES DEEDIT-FIELD   PIC S9(13)V99.
   294     12  DEEDIT-FIELD-V5 REDEFINES DEEDIT-FIELD   PIC S9(10)V9(5).
   295     12  DEEDIT-FIELD-V6 REDEFINES DEEDIT-FIELD   PIC S9(9)V9(6).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page   7
* EL6501.cbl
   296
   297     12  ELCNTL-KEY.
   298         16  CNTL-COMP-ID        PIC XXX.
   299         16  CNTL-REC-TYPE       PIC X.
   300         16  CNTL-ACCESS.
   301             20  FILLER          PIC X(4).
   302         16  CNTL-BUS REDEFINES CNTL-ACCESS.
   303             20  FILLER          PIC XX.
   304             20  CNTL-BUS-TYPE   PIC XX.
   305         16  CNTL-BEN REDEFINES CNTL-ACCESS.
   306             20  FILLER          PIC XX.
   307             20  CNTL-BEN-TYPE   PIC XX.
   308         16  CNTL-SEQ-NO     PIC S9(4)    COMP.
   309
   310     12  REIN-KEY.
   311         16  REIN-COMP-CD        PIC X.
   312         16  REIN-CODE           PIC X.
   313         16  REIN-TABLE          PIC X(3).
   314         16  FILLER              PIC X(3).
   315
   316     12  WS-HOLD-COMM-KEY        PIC X(7) VALUE LOW-VALUES.
   317     12  COMM-KEY.
   318         16  COMM-COMP-CD        PIC X.
   319         16  COMM-TABLE          PIC XXX.
   320         16  COMM-LF-AH          PIC X.
   321         16  COMM-FILLER         PIC XX    VALUE LOW-VALUES.
   322
   323     12  RQST-KEY.
   324         16  RQST-COMPANY-CD     PIC X     VALUE SPACES.
   325         16  RQST-ENTRY-BATCH    PIC X(6)  VALUE SPACES.
   326
   327     12  RQST3-KEY.
   328         16  RQST3-COMPANY-CD    PIC X     VALUE SPACES.
   329         16  RQST3-CARRIER       PIC X     VALUE SPACES.
   330         16  RQST3-GROUPING      PIC X(6)  VALUE SPACES.
   331         16  RQST3-FIN-RESP      PIC X(10) VALUE SPACES.
   332         16  RQST3-ACCT-AGENT    PIC X(10) VALUE SPACES.
   333         16  RQST3-REFERENCE     PIC X(12) VALUE SPACES.
   334         16  RQST3-BATCH         PIC X(6)  VALUE SPACES.
   335
   336     12  SAVE-RQST3-KEY.
   337         16  FILLER              PIC X     VALUE SPACES.
   338         16  FILLER              PIC X     VALUE SPACES.
   339         16  FILLER              PIC X(6)  VALUE SPACES.
   340         16  FILLER              PIC X(10) VALUE SPACES.
   341         16  FILLER              PIC X(10) VALUE SPACES.
   342         16  FILLER              PIC X(12) VALUE SPACES.
   343         16  FILLER              PIC X(6)  VALUE SPACES.
   344
   345     12  COMP-KEY.
   346         16  COMP-COMPANY-CD     PIC X.
   347         16  COMP-CARRIER        PIC X.
   348         16  COMP-GROUPING       PIC X(6).
   349         16  COMP-RESP-NO        PIC X(10).
   350         16  COMP-ACCOUNT        PIC X(10).
   351         16  COMP-TYPE           PIC X.
   352
   353     12  WS-AXRF-KEY.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page   8
* EL6501.cbl
   354         16  WS-AXRF-COMPANY-CD  PIC X.
   355         16  WS-AXRF-CARRIER     PIC X.
   356         16  WS-AXRF-GROUPING    PIC X(6).
   357         16  WS-AXRF-AGENT-NO    PIC X(10).
   358
   359     12  GX-AM-CONTROL-PRIMARY.
   360         16  GX-AM-COMPANY-CD    PIC X.
   361         16  GX-REST-OF-KEY      PIC X(20).
   362
   363     12  QID.
   364         16  QID-TERM            PIC X(4).
   365         16  FILLER              PIC X(4)    VALUE '6501'.
   366
   367     12  BROWSE-STARTED-SW       PIC X       VALUE ' '.
   368         88  BROWSE-STARTED         VALUE 'Y'.
   369     12  FIRST-TIME-SW           PIC X       VALUE ' '.
   370         88  FIRST-TIME             VALUE 'Y'.
   371
   372     12  AXRF-SUB                PIC S9(4)  COMP VALUE ZEROS.
   373     12  GX-AGENT-SUB            PIC S9(4)  COMP VALUE ZEROS.
   374     12  COMM-WORK-SUB           PIC S9(4)  COMP VALUE ZEROS.
   375     12  FIND-AGENT-SUB1         PIC S9(4)  COMP VALUE ZEROS.
   376     12  FIND-AGENT-SUB2         PIC S9(4)  COMP VALUE ZEROS.
   377     12  FIND-AGENT-SUB3         PIC S9(4)  COMP VALUE ZEROS.
   378     12  GETMAIN-SW              PIC X       VALUE SPACES.
   379     12  COMMISSION-GETMAIN-SW   PIC X       VALUE SPACES.
   380         88  GETMAIN-ACQUIRED                VALUE 'X'.
   381
   382     12  ER-0000                 PIC X(4)    VALUE '0000'.
   383     12  ER-0002                 PIC X(4)    VALUE '0002'.
   384     12  ER-0004                 PIC X(4)    VALUE '0004'.
   385     12  ER-0008                 PIC X(4)    VALUE '0008'.
   386     12  ER-0023                 PIC X(4)    VALUE '0023'.
   387     12  ER-0029                 PIC X(4)    VALUE '0029'.
   388     12  ER-0033                 PIC X(4)    VALUE '0033'.
   389     12  ER-0144                 PIC X(4)    VALUE '0144'.
   390     12  ER-0070                 PIC X(4)    VALUE '0070'.
   391     12  ER-0250                 PIC X(4)    VALUE '0250'.
   392     12  ER-0348                 PIC X(4)    VALUE '0348'.
   393     12  ER-0454                 PIC X(4)    VALUE '0454'.
   394     12  ER-0625                 PIC X(4)    VALUE '0625'.
   395     12  ER-0759                 PIC X(4)    VALUE '0759'.
   396     12  ER-0788                 PIC X(4)    VALUE '0788'.
   397     12  ER-0852                 PIC X(4)    VALUE '0852'.
   398     12  ER-0899                 PIC X(4)    VALUE '0899'.
   399     12  ER-1778                 PIC X(4)    VALUE '1778'.
   400     12  ER-1817                 PIC X(4)    VALUE '1817'.
   401     12  ER-1883                 PIC X(4)    VALUE '1883'.
   402     12  ER-1884                 PIC X(4)    VALUE '1884'.
   403     12  ER-1885                 PIC X(4)    VALUE '1885'.
   404     12  ER-1886                 PIC X(4)    VALUE '1886'.
   405     12  ER-1887                 PIC X(4)    VALUE '1887'.
   406     12  ER-2045                 PIC X(4)    VALUE '2045'.
   407     12  ER-2071                 PIC X(4)    VALUE '2071'.
   408     12  ER-2131                 PIC X(4)    VALUE '2131'.
   409*    12  ER-3057                 PIC X(4)    VALUE '3057'.
   410     12  ER-2151                 PIC X(4)    VALUE '2151'.
   411     12  ER-2152                 PIC X(4)    VALUE '2152'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page   9
* EL6501.cbl
   412     12  ER-2153                 PIC X(4)    VALUE '2153'.
   413     12  ER-2154                 PIC X(4)    VALUE '2154'.
   414     12  ER-2155                 PIC X(4)    VALUE '2155'.
   415     12  ER-2156                 PIC X(4)    VALUE '2156'.
   416     12  ER-2157                 PIC X(4)    VALUE '2157'.
   417     12  ER-2158                 PIC X(4)    VALUE '2158'.
   418     12  ER-2159                 PIC X(4)    VALUE '2159'.
   419     12  ER-2160                 PIC X(4)    VALUE '2160'.
   420     12  ER-2165                 PIC X(4)    VALUE '2165'.
   421     12  ER-2168                 PIC X(4)    VALUE '2168'.
   422     12  ER-2169                 PIC X(4)    VALUE '2169'.
   423     12  ER-2170                 PIC X(4)    VALUE '2170'.
   424     12  ER-2172                 PIC X(4)    VALUE '2172'.
   425     12  ER-2173                 PIC X(4)    VALUE '2173'.
   426     12  ER-2174                 PIC X(4)    VALUE '2174'.
   427     12  ER-2175                 PIC X(4)    VALUE '2175'.
   428     12  ER-2176                 PIC X(4)    VALUE '2176'.
   429     12  ER-2177                 PIC X(4)    VALUE '2177'.
   430     12  ER-2178                 PIC X(4)    VALUE '2178'.
   431     12  ER-2179                 PIC X(4)    VALUE '2179'.
   432     12  ER-2180                 PIC X(4)    VALUE '2180'.
   433     12  ER-2181                 PIC X(4)    VALUE '2181'.
   434     12  ER-2182                 PIC X(4)    VALUE '2182'.
   435     12  ER-2183                 PIC X(4)    VALUE '2183'.
   436     12  ER-2189                 PIC X(4)    VALUE '2189'.
   437     12  ER-2572                 PIC X(4)    VALUE '2572'.
   438     12  ER-2615                 PIC X(4)    VALUE '2615'.
   439     12  ER-2949                 PIC X(4)    VALUE '2949'.
   440     12  ER-2970                 PIC X(4)    VALUE '2970'.
   441     12  ER-4009                 PIC X(4)    VALUE '4009'.
   442     12  ER-4010                 PIC X(4)    VALUE '4010'.
   443     12  ER-4011                 PIC X(4)    VALUE '4011'.
   444     12  ER-4012                 PIC X(4)    VALUE '4012'.
   445     12  ER-7717                 PIC X(4)    VALUE '7717'.
   446     12  er-8156                 pic x(4)    value '8156'.
   447     12  ER-9999                 PIC X(4)    VALUE '9999'.
   448     12  ER-XXXX                 PIC X(4)    VALUE 'XXXX'.
   449
   450     12  WSS-LINE-LIAB-LIMITS.
   451         16  WSS-LF-LIMITS.
   452             20  WSS-L-TYPE          PIC  XX    VALUE SPACES.
   453             20  WSS-LF-ATT-AGE      PIC S99    VALUE +0 COMP-3.
   454             20  WSS-L-LIMITS        OCCURS 4 TIMES.
   455                 24  WSS-LF-LM-AGE   PIC S99     COMP-3.
   456                 24  WSS-LF-LM-DUR   PIC S999    COMP-3.
   457                 24  WSS-LF-LM-AMT   PIC S9(6)   COMP-3.
   458         16  WSS-AH-LIMITS.
   459             20  WSS-A-TYPE          PIC  XX    VALUE SPACES.
   460             20  WSS-AH-ATT-AGE      PIC S99    VALUE +0 COMP-3.
   461             20  WSS-A-LIMITS        OCCURS 4 TIMES.
   462                 24  WSS-AH-LM-AGE   PIC S99     COMP-3.
   463                 24  WSS-AH-LM-DUR   PIC S999    COMP-3.
   464                 24  WSS-AH-LM-MOA   PIC S9(4)   COMP-3.
   465                 24  WSS-AH-LM-AMT   PIC S9(6)   COMP-3.
   466
   467     12  WSS-COMM-STRUCTURE.
   468         16  WSS-DEFN-1.
   469             20  WSS-AGT-COMMS.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  10
* EL6501.cbl
   470                 24  WSS-AGT     PIC  X(10)   VALUE SPACES.
   471                 24  WSS-COM-TYP PIC  X       VALUE SPACES.
   472                 24  WSS-L-COM   PIC SV9(5)   VALUE ZEROS COMP-3.
   473                 24  WSS-J-COM   PIC SV9(5)   VALUE ZEROS COMP-3.
   474                 24  WSS-A-COM   PIC SV9(5)   VALUE ZEROS COMP-3.
   475                 24  FILLER      PIC X(6)     VALUE SPACES.
   476
   477     12  WS-PHONE.
   478         16  WS-PH1              PIC XXX.
   479         16  WS-PH2              PIC XXX.
   480         16  WS-PH3              PIC XXXX.
   481     12  WS-PHONE-NUM REDEFINES WS-PHONE PIC 9(10).
   482
   483     12  WS-LIFE-PSI             PIC S9V9(6)  VALUE +0    COMP-3.
   484     12  WS-AH-PSI               PIC S9V9(6)  VALUE +0    COMP-3.
   485     12  WS-ACCOUNT-CTR-C        PIC 99       VALUE ZEROS COMP-3.
   486     12  WS-ACCOUNT-CTR-R        PIC 99       VALUE ZEROS COMP-3.
   487     12  WS-ACCOUNT-CTR-D        PIC 99       VALUE ZEROS COMP-3.
   488     12  WS-BUS-TYPE             PIC 99.
   489     12  WS-BUS-ENTRY            PIC 99.
   490     12  WS-ANVR-DT              PIC 9(11)    VALUE ZEROS.
   491     12  WS-PEFF-DT              PIC 9(11)    VALUE ZEROS.
   492     12  WS-PEXP-DT              PIC 9(11)    VALUE ZEROS.
   493     12  WS-TOL-PREM             PIC S999V99  VALUE ZEROS.
   494     12  WS-TOL-REF              PIC S999V99  VALUE ZEROS.
   495     12  WS-TOL-CLM              PIC S999V99  VALUE ZEROS.
   496     12  WS-COMM-ERROR-SW        PIC 9   COMP-3.
   497         88  COMMISSION-ERROR    VALUE 1.
   498     12  WS-JTYPEID              PIC XX       VALUE SPACES.
   499     12  AGENT-FIND              PIC X        VALUE SPACES.
   500         88  AGENT-RECORD-NOT-FOUND           VALUE 'X'.
   501         88  ACCT-RECORD-NOT-FOUND            VALUE 'Y'.
   502         88  ACCT-LEVEL-DIFFERENT             VALUE 'Z'.
   503
   504     12  WS-ZIP-CODE.
   505         16  WS-ZIP-1            PIC X.
   506             88  WS-CANADIAN-ZIP    VALUE 'A' THRU 'Z'.
   507         16  WS-ZIP-2-3          PIC XX.
   508         16  WS-ZIP-4            PIC X.
   509         16  WS-ZIP-5            PIC X.
   510         16  WS-ZIP-6            PIC X.
   511         16  FILLER              PIC X(4).
   512     12  WS-ZIP-AM-1  REDEFINES  WS-ZIP-CODE.
   513         16  WS-ZIP-AM-1-CODE    PIC X(5).
   514         16  WS-ZIP-AM-1-PLUS4   PIC X(4).
   515         16  FILLER              PIC X.
   516     12  WS-ZIP-AM-2  REDEFINES  WS-ZIP-CODE.
   517         16  WS-ZIP-AM-2-CODE    PIC X(5).
   518         16  WS-ZIP-AM-2-DASH    PIC X.
   519         16  WS-ZIP-AM-2-PLUS4   PIC X(4).
   520     12  WS-ZIP-CAN-1  REDEFINES  WS-ZIP-CODE.
   521         16  WS-ZIP-CAN-1-POST1  PIC XXX.
   522         16  WS-ZIP-CAN-1-POST2  PIC XXX.
   523         16  FILLER              PIC X(4).
   524     12  WS-ZIP-CAN-2  REDEFINES  WS-ZIP-CODE.
   525         16  WS-ZIP-CAN-2-POST1  PIC XXX.
   526         16  FILLER              PIC X.
   527         16  WS-ZIP-CAN-2-POST2  PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  11
* EL6501.cbl
   528         16  FILLER              PIC XXX.
   529     12  WS-SOC-SEC-WORK.
   530         16  WS-SS-TYPE          PIC X.
   531         16  WS-SOC-SEC          PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  12
* EL6501.cbl
   533*    COPY ELCSCTM.
   534******************************************************************
   535*                                                                *
   536*                                                                *
   537*                            ELCSCTM                             *
   538*                            VMOD=2.001                          *
   539*                                                                *
   540*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   541*                                                                *
   542******************************************************************
   543 01  SECURITY-MESSAGE.
   544     12  FILLER                          PIC X(30)
   545            VALUE '** LOGIC SECURITY VIOLATION -'.
   546     12  SM-READ                         PIC X(6).
   547     12  FILLER                          PIC X(5)
   548            VALUE ' PGM='.
   549     12  SM-PGM                          PIC X(6).
   550     12  FILLER                          PIC X(5)
   551            VALUE ' OPR='.
   552     12  SM-PROCESSOR-ID                 PIC X(4).
   553     12  FILLER                          PIC X(6)
   554            VALUE ' TERM='.
   555     12  SM-TERMID                       PIC X(4).
   556     12  FILLER                          PIC XX   VALUE SPACE.
   557     12  SM-JUL-DATE                     PIC 9(5).
   558     12  FILLER                          PIC X    VALUE SPACE.
   559     12  SM-TIME                         PIC 99.99.
   560
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  13
* EL6501.cbl
   562*    COPY ELCSCRTY.
   563******************************************************************
   564*                                                                *
   565*                                                                *
   566*                            ELCSCRTY                            *
   567*                            VMOD=2.001                          *
   568*                                                                *
   569*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   570*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   571*        SAVED IN PI-SECURITY-ADDRESS.                           *
   572*                                                                *
   573******************************************************************
   574 01  SECURITY-CONTROL.
   575     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   576     12  FILLER                       PIC XX    VALUE 'SC'.
   577     12  SC-CREDIT-CODES.
   578         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   579             20  SC-CREDIT-DISPLAY    PIC X.
   580             20  SC-CREDIT-UPDATE     PIC X.
   581     12  SC-CLAIMS-CODES.
   582         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   583             20  SC-CLAIMS-DISPLAY    PIC X.
   584             20  SC-CLAIMS-UPDATE     PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  14
* EL6501.cbl
   586*    COPY ELCLOGOF.
   587******************************************************************
   588*                                                                *
   589*                                                                *
   590*                            ELCLOGOF.                           *
   591*                            VMOD=2.001                          *
   592*                                                                *
   593*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   594*                                                                *
   595******************************************************************
   596 01  CLASIC-LOGOFF.
   597     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   598     12  LOGOFF-TEXT.
   599         16  FILLER          PIC X(5)    VALUE SPACES.
   600         16  LOGOFF-MSG.
   601             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   602             20  FILLER      PIC X       VALUE SPACES.
   603             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   604         16  FILLER          PIC X(80)
   605           VALUE '* YOU ARE NOW LOGGED OFF'.
   606         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   607         16  FILLER          PIC X       VALUE QUOTE.
   608         16  LOGOFF-SYS-MSG  PIC X(17)
   609           VALUE 'S CLAS-IC SYSTEM '.
   610     12  TEXT-MESSAGES.
   611         16  UNACCESS-MSG    PIC X(29)
   612             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   613         16  PGMIDERR-MSG    PIC X(17)
   614             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  15
* EL6501.cbl
   616*    COPY ELCDATE.
   617******************************************************************
   618*                                                                *
   619*                                                                *
   620*                            ELCDATE.                            *
   621*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   622*                            VMOD=2.003
   623*                                                                *
   624*                                                                *
   625*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   626*                 LENGTH = 200                                   *
   627******************************************************************
   628
   629 01  DATE-CONVERSION-DATA.
   630     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   631     12  DC-OPTION-CODE                PIC X.
   632         88  BIN-TO-GREG                VALUE ' '.
   633         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   634         88  EDIT-GREG-TO-BIN           VALUE '2'.
   635         88  YMD-GREG-TO-BIN            VALUE '3'.
   636         88  MDY-GREG-TO-BIN            VALUE '4'.
   637         88  JULIAN-TO-BIN              VALUE '5'.
   638         88  BIN-PLUS-ELAPSED           VALUE '6'.
   639         88  FIND-CENTURY               VALUE '7'.
   640         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   641         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   642         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   643         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   644         88  JULIAN-TO-BIN-3            VALUE 'C'.
   645         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   646         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   647         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   648         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   649         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   650         88  CHECK-LEAP-YEAR            VALUE 'H'.
   651         88  BIN-3-TO-GREG              VALUE 'I'.
   652         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   653         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   654         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   655         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   656         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   657         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   658         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   659         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   660         88  THREE-CHARACTER-BIN
   661                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   662         88  GREGORIAN-TO-BIN
   663                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   664         88  BIN-TO-GREGORIAN
   665                  VALUES ' ' '1' 'I' '8' 'G'.
   666         88  JULIAN-TO-BINARY
   667                  VALUES '5' 'C' 'E' 'F'.
   668     12  DC-ERROR-CODE                 PIC X.
   669         88  NO-CONVERSION-ERROR        VALUE ' '.
   670         88  DATE-CONVERSION-ERROR
   671                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   672         88  DATE-IS-ZERO               VALUE '1'.
   673         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  16
* EL6501.cbl
   674         88  DATE-IS-INVALID            VALUE '3'.
   675         88  DATE1-GREATER-DATE2        VALUE '4'.
   676         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   677         88  DATE-INVALID-OPTION        VALUE '9'.
   678         88  INVALID-CENTURY            VALUE 'A'.
   679         88  ONLY-CENTURY               VALUE 'B'.
   680         88  ONLY-LEAP-YEAR             VALUE 'C'.
   681         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   682     12  DC-END-OF-MONTH               PIC X.
   683         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   684     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   685         88  USE-NORMAL-PROCESS         VALUE ' '.
   686         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   687         88  ADJUST-UP-100-YRS          VALUE '2'.
   688     12  FILLER                        PIC X.
   689     12  DC-CONVERSION-DATES.
   690         16  DC-BIN-DATE-1             PIC XX.
   691         16  DC-BIN-DATE-2             PIC XX.
   692         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   693         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   694                       DC-GREG-DATE-1-EDIT.
   695             20  DC-EDIT1-MONTH        PIC 99.
   696             20  SLASH1-1              PIC X.
   697             20  DC-EDIT1-DAY          PIC 99.
   698             20  SLASH1-2              PIC X.
   699             20  DC-EDIT1-YEAR         PIC 99.
   700         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   701         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   702                     DC-GREG-DATE-2-EDIT.
   703             20  DC-EDIT2-MONTH        PIC 99.
   704             20  SLASH2-1              PIC X.
   705             20  DC-EDIT2-DAY          PIC 99.
   706             20  SLASH2-2              PIC X.
   707             20  DC-EDIT2-YEAR         PIC 99.
   708         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   709         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   710                     DC-GREG-DATE-1-YMD.
   711             20  DC-YMD-YEAR           PIC 99.
   712             20  DC-YMD-MONTH          PIC 99.
   713             20  DC-YMD-DAY            PIC 99.
   714         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   715         16  DC-GREG-DATE-1-MDY-R REDEFINES
   716                      DC-GREG-DATE-1-MDY.
   717             20  DC-MDY-MONTH          PIC 99.
   718             20  DC-MDY-DAY            PIC 99.
   719             20  DC-MDY-YEAR           PIC 99.
   720         16  DC-GREG-DATE-1-ALPHA.
   721             20  DC-ALPHA-MONTH        PIC X(10).
   722             20  DC-ALPHA-DAY          PIC 99.
   723             20  FILLER                PIC XX.
   724             20  DC-ALPHA-CENTURY.
   725                 24 DC-ALPHA-CEN-N     PIC 99.
   726             20  DC-ALPHA-YEAR         PIC 99.
   727         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   728         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   729         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   730         16  DC-JULIAN-DATE            PIC 9(05).
   731         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  17
* EL6501.cbl
   732                                       PIC 9(05).
   733         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   734             20  DC-JULIAN-YEAR        PIC 99.
   735             20  DC-JULIAN-DAYS        PIC 999.
   736         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   737         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   738         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   739     12  DATE-CONVERSION-VARIBLES.
   740         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   741         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   742             20  FILLER                PIC 9(3).
   743             20  HOLD-CEN-1-CCYY.
   744                 24  HOLD-CEN-1-CC     PIC 99.
   745                 24  HOLD-CEN-1-YY     PIC 99.
   746             20  HOLD-CEN-1-MO         PIC 99.
   747             20  HOLD-CEN-1-DA         PIC 99.
   748         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   749             20  HOLD-CEN-1-R-MO       PIC 99.
   750             20  HOLD-CEN-1-R-DA       PIC 99.
   751             20  HOLD-CEN-1-R-CCYY.
   752                 24  HOLD-CEN-1-R-CC   PIC 99.
   753                 24  HOLD-CEN-1-R-YY   PIC 99.
   754             20  FILLER                PIC 9(3).
   755         16  HOLD-CENTURY-1-X.
   756             20  FILLER                PIC X(3)  VALUE SPACES.
   757             20  HOLD-CEN-1-X-CCYY.
   758                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   759                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   760             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   761             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   762         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   763             20  HOLD-CEN-1-R-X-MO     PIC XX.
   764             20  HOLD-CEN-1-R-X-DA     PIC XX.
   765             20  HOLD-CEN-1-R-X-CCYY.
   766                 24  HOLD-CEN-1-R-X-CC PIC XX.
   767                 24  HOLD-CEN-1-R-X-YY PIC XX.
   768             20  FILLER                PIC XXX.
   769         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   770         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   771         16  DC-JULIAN-DATE-1          PIC 9(07).
   772         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   773             20  DC-JULIAN-1-CCYY.
   774                 24  DC-JULIAN-1-CC    PIC 99.
   775                 24  DC-JULIAN-1-YR    PIC 99.
   776             20  DC-JULIAN-DA-1        PIC 999.
   777         16  DC-JULIAN-DATE-2          PIC 9(07).
   778         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   779             20  DC-JULIAN-2-CCYY.
   780                 24  DC-JULIAN-2-CC    PIC 99.
   781                 24  DC-JULIAN-2-YR    PIC 99.
   782             20  DC-JULIAN-DA-2        PIC 999.
   783         16  DC-GREG-DATE-A-EDIT.
   784             20  DC-EDITA-MONTH        PIC 99.
   785             20  SLASHA-1              PIC X VALUE '/'.
   786             20  DC-EDITA-DAY          PIC 99.
   787             20  SLASHA-2              PIC X VALUE '/'.
   788             20  DC-EDITA-CCYY.
   789                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  18
* EL6501.cbl
   790                 24  DC-EDITA-YEAR     PIC 99.
   791         16  DC-GREG-DATE-B-EDIT.
   792             20  DC-EDITB-MONTH        PIC 99.
   793             20  SLASHB-1              PIC X VALUE '/'.
   794             20  DC-EDITB-DAY          PIC 99.
   795             20  SLASHB-2              PIC X VALUE '/'.
   796             20  DC-EDITB-CCYY.
   797                 24  DC-EDITB-CENT     PIC 99.
   798                 24  DC-EDITB-YEAR     PIC 99.
   799         16  DC-GREG-DATE-CYMD         PIC 9(08).
   800         16  DC-GREG-DATE-CYMD-R REDEFINES
   801                              DC-GREG-DATE-CYMD.
   802             20  DC-CYMD-CEN           PIC 99.
   803             20  DC-CYMD-YEAR          PIC 99.
   804             20  DC-CYMD-MONTH         PIC 99.
   805             20  DC-CYMD-DAY           PIC 99.
   806         16  DC-GREG-DATE-MDCY         PIC 9(08).
   807         16  DC-GREG-DATE-MDCY-R REDEFINES
   808                              DC-GREG-DATE-MDCY.
   809             20  DC-MDCY-MONTH         PIC 99.
   810             20  DC-MDCY-DAY           PIC 99.
   811             20  DC-MDCY-CEN           PIC 99.
   812             20  DC-MDCY-YEAR          PIC 99.
   813    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   814        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   815    12  DC-EL310-DATE                  PIC X(21).
   816    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  19
* EL6501.cbl
   818*    COPY ELCATTR.
   819******************************************************************
   820*                                                                *
   821*                            ELCATTR.                            *
   822*                            VMOD=2.001                          *
   823*                                                                *
   824*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   825*                                                                *
   826*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   827*                                                                *
   828*                   POS 1   P=PROTECTED                          *
   829*                           U=UNPROTECTED                        *
   830*                           S=ASKIP                              *
   831*                   POS 2   A=ALPHA/NUMERIC                      *
   832*                           N=NUMERIC                            *
   833*                   POS 3   N=NORMAL                             *
   834*                           B=BRIGHT                             *
   835*                           D=DARK                               *
   836*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   837*                           OF=MODIFIED DATA TAG OFF             *
   838*                                                                *
   839*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   840******************************************************************
   841 01  ATTRIBUTE-LIST.
   842     12  AL-PABOF            PIC X       VALUE 'Y'.
   843     12  AL-PABON            PIC X       VALUE 'Z'.
   844     12  AL-PADOF            PIC X       VALUE '%'.
   845     12  AL-PADON            PIC X       VALUE '_'.
   846     12  AL-PANOF            PIC X       VALUE '-'.
   847     12  AL-PANON            PIC X       VALUE '/'.
   848     12  AL-SABOF            PIC X       VALUE '8'.
   849     12  AL-SABON            PIC X       VALUE '9'.
   850     12  AL-SADOF            PIC X       VALUE '@'.
   851     12  AL-SADON            PIC X       VALUE QUOTE.
   852     12  AL-SANOF            PIC X       VALUE '0'.
   853     12  AL-SANON            PIC X       VALUE '1'.
   854     12  AL-UABOF            PIC X       VALUE 'H'.
   855     12  AL-UABON            PIC X       VALUE 'I'.
   856     12  AL-UADOF            PIC X       VALUE '<'.
   857     12  AL-UADON            PIC X       VALUE '('.
   858     12  AL-UANOF            PIC X       VALUE ' '.
   859     12  AL-UANON            PIC X       VALUE 'A'.
   860     12  AL-UNBOF            PIC X       VALUE 'Q'.
   861     12  AL-UNBON            PIC X       VALUE 'R'.
   862     12  AL-UNDOF            PIC X       VALUE '*'.
   863     12  AL-UNDON            PIC X       VALUE ')'.
   864     12  AL-UNNOF            PIC X       VALUE '&'.
   865     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  20
* EL6501.cbl
   867*    COPY ELCEMIB.
   868******************************************************************
   869*                                                                *
   870*                                                                *
   871*                            ELCEMIB.                            *
   872*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   873*                            VMOD=2.005                          *
   874*                                                                *
   875*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   876*                                                                *
   877******************************************************************
   878 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   879     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   880     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   881     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   882     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   883     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   884     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   885     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   886     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   887     12  EMI-SWITCH1             PIC X        VALUE '1'.
   888         88  EMI-NO-ERRORS                    VALUE '1'.
   889         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   890         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   891     12  EMI-SWITCH2             PIC X        VALUE '1'.
   892         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   893     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   894         88  EMI-AREA1-EMPTY                  VALUE '1'.
   895         88  EMI-AREA1-FULL                   VALUE '2'.
   896     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   897         88  EMI-AREA2-EMPTY                  VALUE '1'.
   898         88  EMI-AREA2-FULL                   VALUE '2'.
   899     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   900         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   901         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   902         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   903         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   904         88  EMI-BYPASS-FATALS                VALUE 'X'.
   905     12  EMI-ERROR-LINES.
   906         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   907         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   908         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   909         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   910             20  EMI-ERR-CODES OCCURS 10 TIMES.
   911                 24  EMI-ERR-NUM         PIC X(4).
   912                 24  EMI-FILLER          PIC X.
   913                 24  EMI-SEV             PIC X.
   914                 24  FILLER              PIC X.
   915             20  FILLER                  PIC X(02).
   916     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   917         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   918             20  EMI-ERROR-NUMBER    PIC X(4).
   919             20  EMI-FILL            PIC X.
   920             20  EMI-SEVERITY        PIC X.
   921             20  FILLER              PIC X.
   922             20  EMI-ERROR-TEXT.
   923                 24  EMI-TEXT-VARIABLE   PIC X(10).
   924                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  21
* EL6501.cbl
   925     12  EMI-SEVERITY-SAVE           PIC X.
   926         88  EMI-NOTE                    VALUE 'N'.
   927         88  EMI-WARNING                 VALUE 'W'.
   928         88  EMI-FORCABLE                VALUE 'F'.
   929         88  EMI-FATAL                   VALUE 'X'.
   930     12  EMI-MESSAGE-FLAG            PIC X.
   931         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   932         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   933     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   934     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   935         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   936         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   937         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   938     12  emi-claim-no                pic x(7).
   939     12  emi-claim-type              pic x(6).
   940     12  FILLER                      PIC X(124)  VALUE SPACES.
   941     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   942     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   943     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   944     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  22
* EL6501.cbl
   946*    COPY ELCINTF.
   947******************************************************************
   948*                                                                *
   949*                                                                *
   950*                            ELCINTF.                            *
   951*                            VMOD=2.017                          *
   952*                                                                *
   953*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   954*                                                                *
   955*       LENGTH = 1024                                            *
   956*                                                                *
   957******************************************************************
   958*                   C H A N G E   L O G
   959*
   960* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   961*-----------------------------------------------------------------
   962*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   963* EFFECTIVE    NUMBER
   964*-----------------------------------------------------------------
   965* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   966******************************************************************
   967 01  PROGRAM-INTERFACE-BLOCK.
   968     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   969     12  PI-CALLING-PROGRAM              PIC X(8).
   970     12  PI-SAVED-PROGRAM-1              PIC X(8).
   971     12  PI-SAVED-PROGRAM-2              PIC X(8).
   972     12  PI-SAVED-PROGRAM-3              PIC X(8).
   973     12  PI-SAVED-PROGRAM-4              PIC X(8).
   974     12  PI-SAVED-PROGRAM-5              PIC X(8).
   975     12  PI-SAVED-PROGRAM-6              PIC X(8).
   976     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   977     12  PI-COMPANY-ID                   PIC XXX.
   978     12  PI-COMPANY-CD                   PIC X.
   979
   980     12  PI-COMPANY-PASSWORD             PIC X(8).
   981
   982     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   983
   984     12  PI-CONTROL-IN-PROGRESS.
   985         16  PI-CARRIER                  PIC X.
   986         16  PI-GROUPING                 PIC X(6).
   987         16  PI-STATE                    PIC XX.
   988         16  PI-ACCOUNT                  PIC X(10).
   989         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   990                                         PIC X(10).
   991         16  PI-CLAIM-CERT-GRP.
   992             20  PI-CLAIM-NO             PIC X(7).
   993             20  PI-CERT-NO.
   994                 25  PI-CERT-PRIME       PIC X(10).
   995                 25  PI-CERT-SFX         PIC X.
   996             20  PI-CERT-EFF-DT          PIC XX.
   997         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   998             20  PI-PLAN-CODE            PIC X(2).
   999             20  PI-REVISION-NUMBER      PIC X(3).
  1000             20  PI-PLAN-EFF-DT          PIC X(2).
  1001             20  PI-PLAN-EXP-DT          PIC X(2).
  1002             20  FILLER                  PIC X(11).
  1003         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  23
* EL6501.cbl
  1004             20  PI-OE-REFERENCE-1.
  1005                 25  PI-OE-REF-1-PRIME   PIC X(18).
  1006                 25  PI-OE-REF-1-SUFF    PIC XX.
  1007
  1008     12  PI-SESSION-IN-PROGRESS          PIC X.
  1009         88  CLAIM-SESSION                   VALUE '1'.
  1010         88  CREDIT-SESSION                  VALUE '2'.
  1011         88  WARRANTY-SESSION                VALUE '3'.
  1012         88  MORTGAGE-SESSION                VALUE '4'.
  1013         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  1014
  1015
  1016*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  1017
  1018     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  1019     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  1020
  1021     12  PI-CREDIT-USER                  PIC X.
  1022         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  1023         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  1024
  1025     12  PI-CLAIM-USER                   PIC X.
  1026         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  1027         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  1028
  1029     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  1030         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  1031         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  1032         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  1033         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  1034         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  1035
  1036     12  PI-PROCESSOR-ID                 PIC X(4).
  1037
  1038     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  1039
  1040     12  PI-MEMBER-CAPTION               PIC X(10).
  1041
  1042     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1043         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  1044
  1045     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1046     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1047     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1048     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1049
  1050     12  PI-AH-OVERRIDE-L1               PIC X.
  1051     12  PI-AH-OVERRIDE-L2               PIC XX.
  1052     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1053     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1054
  1055     12  PI-NEW-SYSTEM                   PIC X(2).
  1056
  1057     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1058     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1059         88  PI-USES-PAID-TO                 VALUE '1'.
  1060     12  PI-CRDTCRD-SYSTEM.
  1061         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  24
* EL6501.cbl
  1062             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1063             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1064         16  PI-CC-MONTH-END-DT          PIC XX.
  1065     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1066
  1067     12  PI-OE-REFERENCE-2.
  1068         16  PI-OE-REF-2-PRIME           PIC X(10).
  1069         16  PI-OE-REF-2-SUFF            PIC X.
  1070
  1071     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1072
  1073     12  PI-LANGUAGE-TYPE                PIC X.
  1074             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1075             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1076             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1077
  1078     12  PI-POLICY-LINKAGE-IND           PIC X.
  1079         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1080         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1081                                                   LOW-VALUES.
  1082
  1083     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1084     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1085         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1086         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1087
  1088     12  PI-PROCESSOR-CSR-IND            PIC X.
  1089         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1090         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  1091
  1092     12  FILLER                          PIC X(3).
  1093
  1094     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1095
  1096     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1097         PI-SYSTEM-LEVEL.
  1098
  1099         16  PI-ENTRY-CODES.
  1100             20  PI-ENTRY-CD-1           PIC X.
  1101             20  PI-ENTRY-CD-2           PIC X.
  1102
  1103         16  PI-RETURN-CODES.
  1104             20  PI-RETURN-CD-1          PIC X.
  1105             20  PI-RETURN-CD-2          PIC X.
  1106
  1107         16  PI-UPDATE-STATUS-SAVE.
  1108             20  PI-UPDATE-BY            PIC X(4).
  1109             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1110
  1111         16  PI-LOWER-CASE-LETTERS       PIC X.
  1112             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1113
  1114*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1115*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1116*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1117
  1118         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1119             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  25
* EL6501.cbl
  1120             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1121             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1122             88  ACCNT-CNTL                  VALUE '3'.
  1123             88  CARR-ACCNT-CNTL             VALUE '4'.
  1124
  1125         16  PI-PROCESSOR-CAP-LIST.
  1126             20  PI-SYSTEM-CONTROLS.
  1127                24 PI-SYSTEM-DISPLAY     PIC X.
  1128                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1129                24 PI-SYSTEM-MODIFY      PIC X.
  1130                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1131             20  FILLER                  PIC XX.
  1132             20  PI-DISPLAY-CAP          PIC X.
  1133                 88  DISPLAY-CAP             VALUE 'Y'.
  1134             20  PI-MODIFY-CAP           PIC X.
  1135                 88  MODIFY-CAP              VALUE 'Y'.
  1136             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1137                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1138             20  PI-FORCE-CAP            PIC X.
  1139                 88  FORCE-CAP               VALUE 'Y'.
  1140
  1141         16  PI-PROGRAM-CONTROLS.
  1142             20  PI-PGM-PRINT-OPT        PIC X.
  1143             20  PI-PGM-FORMAT-OPT       PIC X.
  1144             20  PI-PGM-PROCESS-OPT      PIC X.
  1145             20  PI-PGM-TOTALS-OPT       PIC X.
  1146
  1147         16  PI-HELP-INTERFACE.
  1148             20  PI-LAST-ERROR-NO        PIC X(4).
  1149             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1150
  1151         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1152             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1153
  1154         16  PI-CR-CONTROL-IN-PROGRESS.
  1155             20  PI-CR-CARRIER           PIC X.
  1156             20  PI-CR-GROUPING          PIC X(6).
  1157             20  PI-CR-STATE             PIC XX.
  1158             20  PI-CR-ACCOUNT           PIC X(10).
  1159             20  PI-CR-FIN-RESP          PIC X(10).
  1160             20  PI-CR-TYPE              PIC X.
  1161
  1162         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1163
  1164         16  PI-CR-MONTH-END-DT          PIC XX.
  1165
  1166         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1167             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1168             88  PI-ZERO-CARRIER             VALUE '1'.
  1169             88  PI-ZERO-GROUPING            VALUE '2'.
  1170             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1171
  1172         16  PI-CARRIER-SECURITY         PIC X.
  1173             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1174
  1175         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1176             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1177             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  26
* EL6501.cbl
  1178
  1179         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1180             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1181                                         INDEXED BY PI-ACCESS-NDX
  1182                                         PIC X.
  1183
  1184         16  PI-GA-BILLING-CONTROL       PIC X.
  1185             88  PI-GA-BILLING               VALUE '1'.
  1186
  1187         16  PI-MAIL-PROCESSING          PIC X.
  1188             88  PI-MAIL-YES                 VALUE 'Y'.
  1189
  1190         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1191
  1192         16  PI-AR-SYSTEM.
  1193             20  PI-AR-PROCESSING-CNTL   PIC X.
  1194                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1195             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1196             20  PI-AR-MONTH-END-DT      PIC XX.
  1197
  1198         16  PI-MP-SYSTEM.
  1199             20  PI-MORTGAGE-USER            PIC X.
  1200                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1201                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1202             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1203                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1204                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1205                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1206                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1207                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1208             20  PI-MP-MONTH-END-DT          PIC XX.
  1209             20  PI-MP-REFERENCE-NO.
  1210                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1211                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1212
  1213         16  PI-LABEL-CONTROL            PIC X(01).
  1214             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1215             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1216
  1217         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1218             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1219
  1220         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1221             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1222             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1223
  1224         16  FILLER                      PIC X(14).
  1225
  1226     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1227******************************************************************
  1228*    COPY ELC650PI.
  1229******************************************************************
  1230*
  1231*                            ELC650PI.
  1232*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1233*                            VMOD=2.007
  1234*  ***  NOTE  ***   IF ANY CHANGES ARE MADE TO THIS COPYBOOK
  1235*   YOU MUST CONSIDER ALL PROGRAMS THAT USE THIS COPYBOOK AND
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  27
* EL6501.cbl
  1236* PROGRAM EL6565.  ALSO, CONSIDER EL106 AND EL1061
  1237*
  1238******************************************************************
  1239
  1240     12  FILLER    REDEFINES PI-PROGRAM-WORK-AREA.
  1241         16  PI-MAINT                   PIC X.
  1242         16  PI-PREV-ACCOUNT            PIC X(20).
  1243         16  PI-PREV-VG-ACCOUNT         PIC X(20).
  1244         16  PI-ACCT-KEY.
  1245             20  PI-ACCT-CCGSA-KEY.
  1246                 24  PI-ACCT-CO             PIC X.
  1247                 24  PI-ACCT-CARRIER        PIC X.
  1248                 24  PI-ACCT-GROUPING       PIC X(6).
  1249                 24  PI-ACCT-STATE          PIC XX.
  1250                 24  PI-ACCT-ACCOUNT        PIC X(10).
  1251             20  PI-ACCT-EXP-DT           PIC XX.
  1252             20  PI-ACCT-REST-OF-EXP      PIC X(4).
  1253         16  PI-ACCT-ID                 PIC X(8).
  1254         16  PI-PLAN-KEY.
  1255             20  PI-PLAN-ACCT-KEY.
  1256                 24  PI-PLAN-COMPANY-CD PIC X.
  1257                 24  PI-PLAN-CARRIER    PIC X.
  1258                 24  PI-PLAN-GROUP      PIC X(6).
  1259                 24  PI-PLAN-STATE      PIC X(2).
  1260                 24  PI-PLAN-ACCOUNT    PIC X(10).
  1261             20  PI-PLAN-BEN-TYPE       PIC X.
  1262             20  PI-PLAN-BEN            PIC XX.
  1263             20  PI-PLAN-REVISION       PIC X(3).
  1264         16  PI-WS-STATE                PIC XX.
  1265         16  PI-WS-CLASS                PIC XX.
  1266         16  PI-WS-DEV                  PIC X(3).
  1267         16  PI-WS-TYPE                 PIC X.
  1268         16  PI-WS-PLAN                 PIC XX.
  1269
  1270         16  PI-ERPNDB-ALT-KEY.
  1271             20  PI-PB-COMPANY-CD-A1    PIC X.
  1272             20  PI-PB-CARRIER          PIC X.
  1273             20  PI-PB-GROUPING         PIC X(6).
  1274             20  PI-PB-STATE            PIC XX.
  1275             20  PI-PB-ACCOUNT          PIC X(10).
  1276             20  PI-PB-CERT-EFF-DT      PIC XX.
  1277             20  PI-PB-CERT-NO          PIC X(10).
  1278             20  PI-PB-ALT-CHG-SEQ-NO   PIC S9(4)      COMP.
  1279             20  PI-PB-RECORD-TYPE      PIC X.
  1280
  1281         16  PI-DATE-RANGE-TABLE.
  1282             20  PI-TABLE-ENT OCCURS 32 TIMES
  1283                            INDEXED BY T-INDEX.
  1284                 24  PI-BIN-EFF-DT          PIC XX.
  1285                 24  PI-BIN-EXP-DT          PIC XX.
  1286                 24  PI-BIN-MAINT-DT        PIC XX.
  1287                 24  PI-BIN-LO-CERT         PIC XX.
  1288                 24  PI-BIN-AR-HI-CERT      PIC XX.
  1289                 24  PI-BIN-HI-CERT         PIC XX.
  1290         16  PI-PAGE-NUMBER             PIC S9.
  1291             88  PI-FST-PAGE               VALUE +1.
  1292             88  PI-2ND-PAGE               VALUE +2.
  1293             88  PI-3RD-PAGE               VALUE +3.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  28
* EL6501.cbl
  1294             88  PI-LST-PAGE               VALUE +4.
  1295         16  PI-TOTAL-LINES             PIC S99.
  1296         16  PI-LINE-SELECTED    PIC S9.
  1297***  Y2K PROJ 7744
  1298         16  EFFCHG-SAVE         PIC 9(11)   COMP-3.
  1299         16  BIN-EFFCHG-SAVE     PIC XX.
  1300         16  EXPCHG-SAVE         PIC 9(11)   COMP-3.
  1301***  Y2K PROJ 7744
  1302         16  BIN-EXPCHG-SAVE     PIC XX.
  1303         16  PI-RECORD-ADDED-SW  PIC X.
  1304             88  PI-RECORD-ADDED            VALUE '1'.
  1305             88  PI-RECORD-NOT-CREATED      VALUE SPACE.
  1306         16  PI-ACCNAME          PIC X(30).
  1307         16  PI-COMM-POINTER     PIC S9(8)   COMP.
  1308         16  PI-SV-MAINT         PIC X.
  1309         16  PI-CURRENT-LINE     PIC S9(3)   COMP-3.
  1310         16  PI-TEMP-STOR-ITEMS  PIC S9(4)   COMP.
  1311         16  PI-UPDATE-SW        PIC X.
  1312             88  PI-CHANGES-MADE             VALUE '1'.
  1313         16  PI-NOTE-TYPE        PIC X.
  1314             88  PI-ACCT-NOTE                VALUE '1'.
  1315         16  PI-DMD-FILE-SW      PIC X.
  1316             88  END-OF-FILE                 VALUE 'E'.
  1317             88  INTO-NEXT-BENEFITS          VALUE 'I'.
  1318             88  FIRST-OCCURS                VALUE 'F'.
  1319         16  PI-DMD-OCCURS       PIC S999.
  1320         16  PI-DMD-SCREEN       PIC X.
  1321             88  SCREEN-1-DISPLAYED  VALUE '1'.
  1322             88  SCREEN-2-DISPLAYED  VALUE '2'.
  1323             88  SCREEN-3-DISPLAYED  VALUE '3'.
  1324         16  PI-NAMEFLG          PIC X.
  1325         16  PI-EL650-DEL-SW     PIC X.
  1326         16  PI-MAX-MFEE         PIC S9(5) COMP-3.
  1327         16  PI-DCC-PROD-CODE    PIC XXX.
  1328         16  FILLER              PIC X(35).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  29
* EL6501.cbl
  1330
  1331*    COPY ELCJPFX.
  1332******************************************************************
  1333*                                                                *
  1334*                                                                *
  1335*                            ELCJPFX.                            *
  1336*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1337*                            VMOD=2.002                          *
  1338*                                                                *
  1339*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  1340*                                                                *
  1341*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  1342*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  1343*        ELCNTL - CONTROL FILE                                   *
  1344*        ELMSTR - CLAIM MASTERS                                  *
  1345*        ELTRLR - ACTIVITY TRAILERS                              *
  1346*        ELCHKQ - CHECK QUE                                      *
  1347******************************************************************
  1348 01  JOURNAL-RECORD.
  1349     12  jp-date                     pic s9(5) comp-3.
  1350     12  jp-time                     pic s9(7) comp-3.
  1351     12  JP-USER-ID                  PIC X(4).
  1352     12  JP-FILE-ID                  PIC X(8).
  1353     12  JP-PROGRAM-ID               PIC X(8).
  1354     12  JP-RECORD-TYPE              PIC X.
  1355         88 JP-ADD              VALUE 'A'.
  1356         88 JP-BEFORE-CHANGE    VALUE 'B'.
  1357         88 JP-AFTER-CHANGE     VALUE 'C'.
  1358         88 JP-DELETE           VALUE 'D'.
  1359         88 JP-GENERIC-DELETE   VALUE 'G'.
  1360         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  1361         88 JP-KEY-CHG-ADD      VALUE 'N'.
  1362     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  1363     12  JP-RECORD-AREA
  1364
  1365
  1366         PIC X(2000).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  30
* EL6501.cbl
  1368*    COPY ELCAID.
  1369******************************************************************
  1370*                                                                *
  1371*                            ELCAID.                             *
  1372*                            VMOD=2.001                          *
  1373*                                                                *
  1374*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1375*                                                                *
  1376*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1377*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1378******************************************************************
  1379
  1380 01  DFHAID.
  1381   02  DFHNULL   PIC  X  VALUE  ' '.
  1382   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1383   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1384   02  DFHPEN    PIC  X  VALUE  '='.
  1385   02  DFHOPID   PIC  X  VALUE  'W'.
  1386   02  DFHPA1    PIC  X  VALUE  '%'.
  1387   02  DFHPA2    PIC  X  VALUE  '>'.
  1388   02  DFHPA3    PIC  X  VALUE  ','.
  1389   02  DFHPF1    PIC  X  VALUE  '1'.
  1390   02  DFHPF2    PIC  X  VALUE  '2'.
  1391   02  DFHPF3    PIC  X  VALUE  '3'.
  1392   02  DFHPF4    PIC  X  VALUE  '4'.
  1393   02  DFHPF5    PIC  X  VALUE  '5'.
  1394   02  DFHPF6    PIC  X  VALUE  '6'.
  1395   02  DFHPF7    PIC  X  VALUE  '7'.
  1396   02  DFHPF8    PIC  X  VALUE  '8'.
  1397   02  DFHPF9    PIC  X  VALUE  '9'.
  1398   02  DFHPF10   PIC  X  VALUE  ':'.
  1399   02  DFHPF11   PIC  X  VALUE  '#'.
  1400   02  DFHPF12   PIC  X  VALUE  '@'.
  1401   02  DFHPF13   PIC  X  VALUE  'A'.
  1402   02  DFHPF14   PIC  X  VALUE  'B'.
  1403   02  DFHPF15   PIC  X  VALUE  'C'.
  1404   02  DFHPF16   PIC  X  VALUE  'D'.
  1405   02  DFHPF17   PIC  X  VALUE  'E'.
  1406   02  DFHPF18   PIC  X  VALUE  'F'.
  1407   02  DFHPF19   PIC  X  VALUE  'G'.
  1408   02  DFHPF20   PIC  X  VALUE  'H'.
  1409   02  DFHPF21   PIC  X  VALUE  'I'.
  1410*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1411   02  DFHPF22   PIC  X  VALUE  '['.
  1412   02  DFHPF23   PIC  X  VALUE  '.'.
  1413   02  DFHPF24   PIC  X  VALUE  '<'.
  1414   02  DFHMSRE   PIC  X  VALUE  'X'.
  1415   02  DFHSTRF   PIC  X  VALUE  'h'.
  1416   02  DFHTRIG   PIC  X  VALUE  '"'.
  1417 01  FILLER    REDEFINES DFHAID.
  1418     12  FILLER                  PIC X(8).
  1419     12  PF-VALUES               PIC X       OCCURS 24 TIMES.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  31
* EL6501.cbl
  1421*    COPY EL6501S.
  1422 01  EL6501AI.
  1423     05  FILLER            PIC  X(0012).
  1424*    -------------------------------
  1425     05  DATEL PIC S9(0004) COMP.
  1426     05  DATEF PIC  X(0001).
  1427     05  FILLER REDEFINES DATEF.
  1428         10  DATEA PIC  X(0001).
  1429     05  DATEI PIC  X(0008).
  1430*    -------------------------------
  1431     05  TIMEL PIC S9(0004) COMP.
  1432     05  TIMEF PIC  X(0001).
  1433     05  FILLER REDEFINES TIMEF.
  1434         10  TIMEA PIC  X(0001).
  1435     05  TIMEI PIC  X(0005).
  1436*    -------------------------------
  1437     05  CMPNYIDL PIC S9(0004) COMP.
  1438     05  CMPNYIDF PIC  X(0001).
  1439     05  FILLER REDEFINES CMPNYIDF.
  1440         10  CMPNYIDA PIC  X(0001).
  1441     05  CMPNYIDI PIC  X(0003).
  1442*    -------------------------------
  1443     05  USERIDL PIC S9(0004) COMP.
  1444     05  USERIDF PIC  X(0001).
  1445     05  FILLER REDEFINES USERIDF.
  1446         10  USERIDA PIC  X(0001).
  1447     05  USERIDI PIC  X(0004).
  1448*    -------------------------------
  1449     05  MAINTL PIC S9(0004) COMP.
  1450     05  MAINTF PIC  X(0001).
  1451     05  FILLER REDEFINES MAINTF.
  1452         10  MAINTA PIC  X(0001).
  1453     05  MAINTI PIC  X(0001).
  1454*    -------------------------------
  1455     05  CARRL PIC S9(0004) COMP.
  1456     05  CARRF PIC  X(0001).
  1457     05  FILLER REDEFINES CARRF.
  1458         10  CARRA PIC  X(0001).
  1459     05  CARRI PIC  X(0001).
  1460*    -------------------------------
  1461     05  GROUPINL PIC S9(0004) COMP.
  1462     05  GROUPINF PIC  X(0001).
  1463     05  FILLER REDEFINES GROUPINF.
  1464         10  GROUPINA PIC  X(0001).
  1465     05  GROUPINI PIC  X(0006).
  1466*    -------------------------------
  1467     05  STATEL PIC S9(0004) COMP.
  1468     05  STATEF PIC  X(0001).
  1469     05  FILLER REDEFINES STATEF.
  1470         10  STATEA PIC  X(0001).
  1471     05  STATEI PIC  X(0002).
  1472*    -------------------------------
  1473     05  ACCOUNTL PIC S9(0004) COMP.
  1474     05  ACCOUNTF PIC  X(0001).
  1475     05  FILLER REDEFINES ACCOUNTF.
  1476         10  ACCOUNTA PIC  X(0001).
  1477     05  ACCOUNTI PIC  X(0010).
  1478*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  32
* EL6501.cbl
  1479     05  EFFDTEL PIC S9(0004) COMP.
  1480     05  EFFDTEF PIC  X(0001).
  1481     05  FILLER REDEFINES EFFDTEF.
  1482         10  EFFDTEA PIC  X(0001).
  1483     05  EFFDTEI PIC  X(0008).
  1484*    -------------------------------
  1485     05  EXPDTEL PIC S9(0004) COMP.
  1486     05  EXPDTEF PIC  X(0001).
  1487     05  FILLER REDEFINES EXPDTEF.
  1488         10  EXPDTEA PIC  X(0001).
  1489     05  EXPDTEI PIC  X(0008).
  1490*    -------------------------------
  1491     05  MAINTBYL PIC S9(0004) COMP.
  1492     05  MAINTBYF PIC  X(0001).
  1493     05  FILLER REDEFINES MAINTBYF.
  1494         10  MAINTBYA PIC  X(0001).
  1495     05  MAINTBYI PIC  X(0004).
  1496*    -------------------------------
  1497     05  PCONTL PIC S9(0004) COMP.
  1498     05  PCONTF PIC  X(0001).
  1499     05  FILLER REDEFINES PCONTF.
  1500         10  PCONTA PIC  X(0001).
  1501     05  PCONTI PIC  X(0030).
  1502*    -------------------------------
  1503     05  CSRL PIC S9(0004) COMP.
  1504     05  CSRF PIC  X(0001).
  1505     05  FILLER REDEFINES CSRF.
  1506         10  CSRA PIC  X(0001).
  1507     05  CSRI PIC  X(0004).
  1508*    -------------------------------
  1509     05  PDSPLYL PIC S9(0004) COMP.
  1510     05  PDSPLYF PIC  X(0001).
  1511     05  FILLER REDEFINES PDSPLYF.
  1512         10  PDSPLYA PIC  X(0001).
  1513     05  PDSPLYI PIC  X(0006).
  1514*    -------------------------------
  1515     05  PEFFDTEL PIC S9(0004) COMP.
  1516     05  PEFFDTEF PIC  X(0001).
  1517     05  FILLER REDEFINES PEFFDTEF.
  1518         10  PEFFDTEA PIC  X(0001).
  1519     05  PEFFDTEI PIC  X(0008).
  1520*    -------------------------------
  1521     05  PEXPDTEL PIC S9(0004) COMP.
  1522     05  PEXPDTEF PIC  X(0001).
  1523     05  FILLER REDEFINES PEXPDTEF.
  1524         10  PEXPDTEA PIC  X(0001).
  1525     05  PEXPDTEI PIC  X(0008).
  1526*    -------------------------------
  1527     05  NAMEL PIC S9(0004) COMP.
  1528     05  NAMEF PIC  X(0001).
  1529     05  FILLER REDEFINES NAMEF.
  1530         10  NAMEA PIC  X(0001).
  1531     05  NAMEI PIC  X(0030).
  1532*    -------------------------------
  1533     05  TAXNOL PIC S9(0004) COMP.
  1534     05  TAXNOF PIC  X(0001).
  1535     05  FILLER REDEFINES TAXNOF.
  1536         10  TAXNOA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  33
* EL6501.cbl
  1537     05  TAXNOI PIC  X(0011).
  1538*    -------------------------------
  1539     05  STATUSL PIC S9(0004) COMP.
  1540     05  STATUSF PIC  X(0001).
  1541     05  FILLER REDEFINES STATUSF.
  1542         10  STATUSA PIC  X(0001).
  1543     05  STATUSI PIC  X(0001).
  1544*    -------------------------------
  1545     05  INCAREL PIC S9(0004) COMP.
  1546     05  INCAREF PIC  X(0001).
  1547     05  FILLER REDEFINES INCAREF.
  1548         10  INCAREA PIC  X(0001).
  1549     05  INCAREI PIC  X(0030).
  1550*    -------------------------------
  1551     05  PHONEL PIC S9(0004) COMP.
  1552     05  PHONEF PIC  X(0001).
  1553     05  FILLER REDEFINES PHONEF.
  1554         10  PHONEA PIC  X(0001).
  1555     05  PHONEI PIC  X(0012).
  1556*    -------------------------------
  1557     05  INDGRPL PIC S9(0004) COMP.
  1558     05  INDGRPF PIC  X(0001).
  1559     05  FILLER REDEFINES INDGRPF.
  1560         10  INDGRPA PIC  X(0001).
  1561     05  INDGRPI PIC  X(0001).
  1562*    -------------------------------
  1563     05  ADDR1L PIC S9(0004) COMP.
  1564     05  ADDR1F PIC  X(0001).
  1565     05  FILLER REDEFINES ADDR1F.
  1566         10  ADDR1A PIC  X(0001).
  1567     05  ADDR1I PIC  X(0030).
  1568*    -------------------------------
  1569     05  CONTRL PIC S9(0004) COMP.
  1570     05  CONTRF PIC  X(0001).
  1571     05  FILLER REDEFINES CONTRF.
  1572         10  CONTRA PIC  X(0001).
  1573     05  CONTRI PIC  X(0008).
  1574*    -------------------------------
  1575     05  TYPEL PIC S9(0004) COMP.
  1576     05  TYPEF PIC  X(0001).
  1577     05  FILLER REDEFINES TYPEF.
  1578         10  TYPEA PIC  X(0001).
  1579     05  TYPEI PIC  99.
  1580*    -------------------------------
  1581     05  ACITYL PIC S9(0004) COMP.
  1582     05  ACITYF PIC  X(0001).
  1583     05  FILLER REDEFINES ACITYF.
  1584         10  ACITYA PIC  X(0001).
  1585     05  ACITYI PIC  X(0028).
  1586*    -------------------------------
  1587     05  ASTATEL PIC S9(0004) COMP.
  1588     05  ASTATEF PIC  X(0001).
  1589     05  FILLER REDEFINES ASTATEF.
  1590         10  ASTATEA PIC  X(0001).
  1591     05  ASTATEI PIC  X(0002).
  1592*    -------------------------------
  1593     05  PRODATEL PIC S9(0004) COMP.
  1594     05  PRODATEF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  34
* EL6501.cbl
  1595     05  FILLER REDEFINES PRODATEF.
  1596         10  PRODATEA PIC  X(0001).
  1597     05  PRODATEI PIC  X(0008).
  1598*    -------------------------------
  1599     05  STDBENL PIC S9(0004) COMP.
  1600     05  STDBENF PIC  X(0001).
  1601     05  FILLER REDEFINES STDBENF.
  1602         10  STDBENA PIC  X(0001).
  1603     05  STDBENI PIC  X(0002).
  1604*    -------------------------------
  1605     05  ZIPL PIC S9(0004) COMP.
  1606     05  ZIPF PIC  X(0001).
  1607     05  FILLER REDEFINES ZIPF.
  1608         10  ZIPA PIC  X(0001).
  1609     05  ZIPI PIC  X(0010).
  1610*    -------------------------------
  1611     05  CTPLABLL PIC S9(0004) COMP.
  1612     05  CTPLABLF PIC  X(0001).
  1613     05  FILLER REDEFINES CTPLABLF.
  1614         10  CTPLABLA PIC  X(0001).
  1615     05  CTPLABLI PIC  X(0010).
  1616*    -------------------------------
  1617     05  CLPTOLPL PIC S9(0004) COMP.
  1618     05  CLPTOLPF PIC  X(0001).
  1619     05  FILLER REDEFINES CLPTOLPF.
  1620         10  CLPTOLPA PIC  X(0001).
  1621     05  CLPTOLPI PIC  S9(02)V9999.
  1622*    -------------------------------
  1623     05  RETROCDL PIC S9(0004) COMP.
  1624     05  RETROCDF PIC  X(0001).
  1625     05  FILLER REDEFINES RETROCDF.
  1626         10  RETROCDA PIC  X(0001).
  1627     05  RETROCDI PIC  X(0003).
  1628*    -------------------------------
  1629     05  BILLCDL PIC S9(0004) COMP.
  1630     05  BILLCDF PIC  X(0001).
  1631     05  FILLER REDEFINES BILLCDF.
  1632         10  BILLCDA PIC  X(0001).
  1633     05  BILLCDI PIC  X(0003).
  1634*    -------------------------------
  1635     05  LCLABLL PIC S9(0004) COMP.
  1636     05  LCLABLF PIC  X(0001).
  1637     05  FILLER REDEFINES LCLABLF.
  1638         10  LCLABLA PIC  X(0001).
  1639     05  LCLABLI PIC  X(0011).
  1640*    -------------------------------
  1641     05  LCOMML PIC S9(0004) COMP.
  1642     05  LCOMMF PIC  X(0001).
  1643     05  FILLER REDEFINES LCOMMF.
  1644         10  LCOMMA PIC  X(0001).
  1645     05  LCOMMI PIC  S9(6)V9(2).
  1646*    -------------------------------
  1647     05  MAXFEEHL PIC S9(0004) COMP.
  1648     05  MAXFEEHF PIC  X(0001).
  1649     05  FILLER REDEFINES MAXFEEHF.
  1650         10  MAXFEEHA PIC  X(0001).
  1651     05  MAXFEEHI PIC  X(0013).
  1652*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  35
* EL6501.cbl
  1653     05  MAXMFEEL PIC S9(0004) COMP.
  1654     05  MAXMFEEF PIC  X(0001).
  1655     05  FILLER REDEFINES MAXMFEEF.
  1656         10  MAXMFEEA PIC  X(0001).
  1657     05  MAXMFEEI PIC  X(0005).
  1658*    -------------------------------
  1659     05  CLPSTHL PIC S9(0004) COMP.
  1660     05  CLPSTHF PIC  X(0001).
  1661     05  FILLER REDEFINES CLPSTHF.
  1662         10  CLPSTHA PIC  X(0001).
  1663     05  CLPSTHI PIC  X(0010).
  1664*    -------------------------------
  1665     05  CLPSTL PIC S9(0004) COMP.
  1666     05  CLPSTF PIC  X(0001).
  1667     05  FILLER REDEFINES CLPSTF.
  1668         10  CLPSTA PIC  X(0001).
  1669     05  CLPSTI PIC  X(0002).
  1670*    -------------------------------
  1671     05  PRODCDHL PIC S9(0004) COMP.
  1672     05  PRODCDHF PIC  X(0001).
  1673     05  FILLER REDEFINES PRODCDHF.
  1674         10  PRODCDHA PIC  X(0001).
  1675     05  PRODCDHI PIC  X(0012).
  1676*    -------------------------------
  1677     05  PRODCDL PIC S9(0004) COMP.
  1678     05  PRODCDF PIC  X(0001).
  1679     05  FILLER REDEFINES PRODCDF.
  1680         10  PRODCDA PIC  X(0001).
  1681     05  PRODCDI PIC  X(0003).
  1682*    -------------------------------
  1683     05  REMITL PIC S9(0004) COMP.
  1684     05  REMITF PIC  X(0001).
  1685     05  FILLER REDEFINES REMITF.
  1686         10  REMITA PIC  X(0001).
  1687     05  REMITI PIC  99.
  1688*    -------------------------------
  1689     05  COMMCALL PIC S9(0004) COMP.
  1690     05  COMMCALF PIC  X(0001).
  1691     05  FILLER REDEFINES COMMCALF.
  1692         10  COMMCALA PIC  X(0001).
  1693     05  COMMCALI PIC  X(0001).
  1694*    -------------------------------
  1695     05  REINTABL PIC S9(0004) COMP.
  1696     05  REINTABF PIC  X(0001).
  1697     05  FILLER REDEFINES REINTABF.
  1698         10  REINTABA PIC  X(0001).
  1699     05  REINTABI PIC  X(0003).
  1700*    -------------------------------
  1701     05  REINCALL PIC S9(0004) COMP.
  1702     05  REINCALF PIC  X(0001).
  1703     05  FILLER REDEFINES REINCALF.
  1704         10  REINCALA PIC  X(0001).
  1705     05  REINCALI PIC  X(0001).
  1706*    -------------------------------
  1707     05  AHHEADL PIC S9(0004) COMP.
  1708     05  AHHEADF PIC  X(0001).
  1709     05  FILLER REDEFINES AHHEADF.
  1710         10  AHHEADA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  36
* EL6501.cbl
  1711     05  AHHEADI PIC  X(0006).
  1712*    -------------------------------
  1713     05  AGNT1L PIC S9(0004) COMP.
  1714     05  AGNT1F PIC  X(0001).
  1715     05  FILLER REDEFINES AGNT1F.
  1716         10  AGNT1A PIC  X(0001).
  1717     05  AGNT1I PIC  X(0010).
  1718*    -------------------------------
  1719     05  TYPE1L PIC S9(0004) COMP.
  1720     05  TYPE1F PIC  X(0001).
  1721     05  FILLER REDEFINES TYPE1F.
  1722         10  TYPE1A PIC  X(0001).
  1723     05  TYPE1I PIC  X(0001).
  1724*    -------------------------------
  1725     05  SINRT1L PIC S9(0004) COMP.
  1726     05  SINRT1F PIC  X(0001).
  1727     05  FILLER REDEFINES SINRT1F.
  1728         10  SINRT1A PIC  X(0001).
  1729     05  SINRT1I PIC  X(0006).
  1730*    -------------------------------
  1731     05  JNTRT1L PIC S9(0004) COMP.
  1732     05  JNTRT1F PIC  X(0001).
  1733     05  FILLER REDEFINES JNTRT1F.
  1734         10  JNTRT1A PIC  X(0001).
  1735     05  JNTRT1I PIC  X(0006).
  1736*    -------------------------------
  1737     05  AHRT1L PIC S9(0004) COMP.
  1738     05  AHRT1F PIC  X(0001).
  1739     05  FILLER REDEFINES AHRT1F.
  1740         10  AHRT1A PIC  X(0001).
  1741     05  AHRT1I PIC  X(0006).
  1742*    -------------------------------
  1743     05  RECAL1L PIC S9(0004) COMP.
  1744     05  RECAL1F PIC  X(0001).
  1745     05  FILLER REDEFINES RECAL1F.
  1746         10  RECAL1A PIC  X(0001).
  1747     05  RECAL1I PIC  X(0001).
  1748*    -------------------------------
  1749     05  COMM1L PIC S9(0004) COMP.
  1750     05  COMM1F PIC  X(0001).
  1751     05  FILLER REDEFINES COMM1F.
  1752         10  COMM1A PIC  X(0001).
  1753     05  COMM1I PIC  X(0001).
  1754*    -------------------------------
  1755     05  CHGBK1L PIC S9(0004) COMP.
  1756     05  CHGBK1F PIC  X(0001).
  1757     05  FILLER REDEFINES CHGBK1F.
  1758         10  CHGBK1A PIC  X(0001).
  1759     05  CHGBK1I PIC  X(0002).
  1760*    -------------------------------
  1761     05  GLCDE1L PIC S9(0004) COMP.
  1762     05  GLCDE1F PIC  X(0001).
  1763     05  FILLER REDEFINES GLCDE1F.
  1764         10  GLCDE1A PIC  X(0001).
  1765     05  GLCDE1I PIC  X(0001).
  1766*    -------------------------------
  1767     05  AGNT2L PIC S9(0004) COMP.
  1768     05  AGNT2F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  37
* EL6501.cbl
  1769     05  FILLER REDEFINES AGNT2F.
  1770         10  AGNT2A PIC  X(0001).
  1771     05  AGNT2I PIC  X(0010).
  1772*    -------------------------------
  1773     05  TYPE2L PIC S9(0004) COMP.
  1774     05  TYPE2F PIC  X(0001).
  1775     05  FILLER REDEFINES TYPE2F.
  1776         10  TYPE2A PIC  X(0001).
  1777     05  TYPE2I PIC  X(0001).
  1778*    -------------------------------
  1779     05  SINRT2L PIC S9(0004) COMP.
  1780     05  SINRT2F PIC  X(0001).
  1781     05  FILLER REDEFINES SINRT2F.
  1782         10  SINRT2A PIC  X(0001).
  1783     05  SINRT2I PIC  X(0006).
  1784*    -------------------------------
  1785     05  JNTRT2L PIC S9(0004) COMP.
  1786     05  JNTRT2F PIC  X(0001).
  1787     05  FILLER REDEFINES JNTRT2F.
  1788         10  JNTRT2A PIC  X(0001).
  1789     05  JNTRT2I PIC  X(0006).
  1790*    -------------------------------
  1791     05  AHRT2L PIC S9(0004) COMP.
  1792     05  AHRT2F PIC  X(0001).
  1793     05  FILLER REDEFINES AHRT2F.
  1794         10  AHRT2A PIC  X(0001).
  1795     05  AHRT2I PIC  X(0006).
  1796*    -------------------------------
  1797     05  RECAL2L PIC S9(0004) COMP.
  1798     05  RECAL2F PIC  X(0001).
  1799     05  FILLER REDEFINES RECAL2F.
  1800         10  RECAL2A PIC  X(0001).
  1801     05  RECAL2I PIC  X(0001).
  1802*    -------------------------------
  1803     05  COMM2L PIC S9(0004) COMP.
  1804     05  COMM2F PIC  X(0001).
  1805     05  FILLER REDEFINES COMM2F.
  1806         10  COMM2A PIC  X(0001).
  1807     05  COMM2I PIC  X(0001).
  1808*    -------------------------------
  1809     05  CHGBK2L PIC S9(0004) COMP.
  1810     05  CHGBK2F PIC  X(0001).
  1811     05  FILLER REDEFINES CHGBK2F.
  1812         10  CHGBK2A PIC  X(0001).
  1813     05  CHGBK2I PIC  X(0002).
  1814*    -------------------------------
  1815     05  GLCDE2L PIC S9(0004) COMP.
  1816     05  GLCDE2F PIC  X(0001).
  1817     05  FILLER REDEFINES GLCDE2F.
  1818         10  GLCDE2A PIC  X(0001).
  1819     05  GLCDE2I PIC  X(0001).
  1820*    -------------------------------
  1821     05  AGNT3L PIC S9(0004) COMP.
  1822     05  AGNT3F PIC  X(0001).
  1823     05  FILLER REDEFINES AGNT3F.
  1824         10  AGNT3A PIC  X(0001).
  1825     05  AGNT3I PIC  X(0010).
  1826*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  38
* EL6501.cbl
  1827     05  TYPE3L PIC S9(0004) COMP.
  1828     05  TYPE3F PIC  X(0001).
  1829     05  FILLER REDEFINES TYPE3F.
  1830         10  TYPE3A PIC  X(0001).
  1831     05  TYPE3I PIC  X(0001).
  1832*    -------------------------------
  1833     05  SINRT3L PIC S9(0004) COMP.
  1834     05  SINRT3F PIC  X(0001).
  1835     05  FILLER REDEFINES SINRT3F.
  1836         10  SINRT3A PIC  X(0001).
  1837     05  SINRT3I PIC  X(0006).
  1838*    -------------------------------
  1839     05  JNTRT3L PIC S9(0004) COMP.
  1840     05  JNTRT3F PIC  X(0001).
  1841     05  FILLER REDEFINES JNTRT3F.
  1842         10  JNTRT3A PIC  X(0001).
  1843     05  JNTRT3I PIC  X(0006).
  1844*    -------------------------------
  1845     05  AHRT3L PIC S9(0004) COMP.
  1846     05  AHRT3F PIC  X(0001).
  1847     05  FILLER REDEFINES AHRT3F.
  1848         10  AHRT3A PIC  X(0001).
  1849     05  AHRT3I PIC  X(0006).
  1850*    -------------------------------
  1851     05  RECAL3L PIC S9(0004) COMP.
  1852     05  RECAL3F PIC  X(0001).
  1853     05  FILLER REDEFINES RECAL3F.
  1854         10  RECAL3A PIC  X(0001).
  1855     05  RECAL3I PIC  X(0001).
  1856*    -------------------------------
  1857     05  COMM3L PIC S9(0004) COMP.
  1858     05  COMM3F PIC  X(0001).
  1859     05  FILLER REDEFINES COMM3F.
  1860         10  COMM3A PIC  X(0001).
  1861     05  COMM3I PIC  X(0001).
  1862*    -------------------------------
  1863     05  CHGBK3L PIC S9(0004) COMP.
  1864     05  CHGBK3F PIC  X(0001).
  1865     05  FILLER REDEFINES CHGBK3F.
  1866         10  CHGBK3A PIC  X(0001).
  1867     05  CHGBK3I PIC  X(0002).
  1868*    -------------------------------
  1869     05  GLCDE3L PIC S9(0004) COMP.
  1870     05  GLCDE3F PIC  X(0001).
  1871     05  FILLER REDEFINES GLCDE3F.
  1872         10  GLCDE3A PIC  X(0001).
  1873     05  GLCDE3I PIC  X(0001).
  1874*    -------------------------------
  1875     05  AGNT4L PIC S9(0004) COMP.
  1876     05  AGNT4F PIC  X(0001).
  1877     05  FILLER REDEFINES AGNT4F.
  1878         10  AGNT4A PIC  X(0001).
  1879     05  AGNT4I PIC  X(0010).
  1880*    -------------------------------
  1881     05  TYPE4L PIC S9(0004) COMP.
  1882     05  TYPE4F PIC  X(0001).
  1883     05  FILLER REDEFINES TYPE4F.
  1884         10  TYPE4A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  39
* EL6501.cbl
  1885     05  TYPE4I PIC  X(0001).
  1886*    -------------------------------
  1887     05  SINRT4L PIC S9(0004) COMP.
  1888     05  SINRT4F PIC  X(0001).
  1889     05  FILLER REDEFINES SINRT4F.
  1890         10  SINRT4A PIC  X(0001).
  1891     05  SINRT4I PIC  X(0006).
  1892*    -------------------------------
  1893     05  JNTRT4L PIC S9(0004) COMP.
  1894     05  JNTRT4F PIC  X(0001).
  1895     05  FILLER REDEFINES JNTRT4F.
  1896         10  JNTRT4A PIC  X(0001).
  1897     05  JNTRT4I PIC  X(0006).
  1898*    -------------------------------
  1899     05  AHRT4L PIC S9(0004) COMP.
  1900     05  AHRT4F PIC  X(0001).
  1901     05  FILLER REDEFINES AHRT4F.
  1902         10  AHRT4A PIC  X(0001).
  1903     05  AHRT4I PIC  X(0006).
  1904*    -------------------------------
  1905     05  RECAL4L PIC S9(0004) COMP.
  1906     05  RECAL4F PIC  X(0001).
  1907     05  FILLER REDEFINES RECAL4F.
  1908         10  RECAL4A PIC  X(0001).
  1909     05  RECAL4I PIC  X(0001).
  1910*    -------------------------------
  1911     05  COMM4L PIC S9(0004) COMP.
  1912     05  COMM4F PIC  X(0001).
  1913     05  FILLER REDEFINES COMM4F.
  1914         10  COMM4A PIC  X(0001).
  1915     05  COMM4I PIC  X(0001).
  1916*    -------------------------------
  1917     05  CHGBK4L PIC S9(0004) COMP.
  1918     05  CHGBK4F PIC  X(0001).
  1919     05  FILLER REDEFINES CHGBK4F.
  1920         10  CHGBK4A PIC  X(0001).
  1921     05  CHGBK4I PIC  X(0002).
  1922*    -------------------------------
  1923     05  GLCDE4L PIC S9(0004) COMP.
  1924     05  GLCDE4F PIC  X(0001).
  1925     05  FILLER REDEFINES GLCDE4F.
  1926         10  GLCDE4A PIC  X(0001).
  1927     05  GLCDE4I PIC  X(0001).
  1928*    -------------------------------
  1929     05  AGNT5L PIC S9(0004) COMP.
  1930     05  AGNT5F PIC  X(0001).
  1931     05  FILLER REDEFINES AGNT5F.
  1932         10  AGNT5A PIC  X(0001).
  1933     05  AGNT5I PIC  X(0010).
  1934*    -------------------------------
  1935     05  TYPE5L PIC S9(0004) COMP.
  1936     05  TYPE5F PIC  X(0001).
  1937     05  FILLER REDEFINES TYPE5F.
  1938         10  TYPE5A PIC  X(0001).
  1939     05  TYPE5I PIC  X(0001).
  1940*    -------------------------------
  1941     05  SINRT5L PIC S9(0004) COMP.
  1942     05  SINRT5F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  40
* EL6501.cbl
  1943     05  FILLER REDEFINES SINRT5F.
  1944         10  SINRT5A PIC  X(0001).
  1945     05  SINRT5I PIC  X(0006).
  1946*    -------------------------------
  1947     05  JNTRT5L PIC S9(0004) COMP.
  1948     05  JNTRT5F PIC  X(0001).
  1949     05  FILLER REDEFINES JNTRT5F.
  1950         10  JNTRT5A PIC  X(0001).
  1951     05  JNTRT5I PIC  X(0006).
  1952*    -------------------------------
  1953     05  AHRT5L PIC S9(0004) COMP.
  1954     05  AHRT5F PIC  X(0001).
  1955     05  FILLER REDEFINES AHRT5F.
  1956         10  AHRT5A PIC  X(0001).
  1957     05  AHRT5I PIC  X(0006).
  1958*    -------------------------------
  1959     05  RECAL5L PIC S9(0004) COMP.
  1960     05  RECAL5F PIC  X(0001).
  1961     05  FILLER REDEFINES RECAL5F.
  1962         10  RECAL5A PIC  X(0001).
  1963     05  RECAL5I PIC  X(0001).
  1964*    -------------------------------
  1965     05  COMM5L PIC S9(0004) COMP.
  1966     05  COMM5F PIC  X(0001).
  1967     05  FILLER REDEFINES COMM5F.
  1968         10  COMM5A PIC  X(0001).
  1969     05  COMM5I PIC  X(0001).
  1970*    -------------------------------
  1971     05  CHGBK5L PIC S9(0004) COMP.
  1972     05  CHGBK5F PIC  X(0001).
  1973     05  FILLER REDEFINES CHGBK5F.
  1974         10  CHGBK5A PIC  X(0001).
  1975     05  CHGBK5I PIC  X(0002).
  1976*    -------------------------------
  1977     05  GLCDE5L PIC S9(0004) COMP.
  1978     05  GLCDE5F PIC  X(0001).
  1979     05  FILLER REDEFINES GLCDE5F.
  1980         10  GLCDE5A PIC  X(0001).
  1981     05  GLCDE5I PIC  X(0001).
  1982*    -------------------------------
  1983     05  AGNT6L PIC S9(0004) COMP.
  1984     05  AGNT6F PIC  X(0001).
  1985     05  FILLER REDEFINES AGNT6F.
  1986         10  AGNT6A PIC  X(0001).
  1987     05  AGNT6I PIC  X(0010).
  1988*    -------------------------------
  1989     05  TYPE6L PIC S9(0004) COMP.
  1990     05  TYPE6F PIC  X(0001).
  1991     05  FILLER REDEFINES TYPE6F.
  1992         10  TYPE6A PIC  X(0001).
  1993     05  TYPE6I PIC  X(0001).
  1994*    -------------------------------
  1995     05  SINRT6L PIC S9(0004) COMP.
  1996     05  SINRT6F PIC  X(0001).
  1997     05  FILLER REDEFINES SINRT6F.
  1998         10  SINRT6A PIC  X(0001).
  1999     05  SINRT6I PIC  X(0006).
  2000*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  41
* EL6501.cbl
  2001     05  JNTRT6L PIC S9(0004) COMP.
  2002     05  JNTRT6F PIC  X(0001).
  2003     05  FILLER REDEFINES JNTRT6F.
  2004         10  JNTRT6A PIC  X(0001).
  2005     05  JNTRT6I PIC  X(0006).
  2006*    -------------------------------
  2007     05  AHRT6L PIC S9(0004) COMP.
  2008     05  AHRT6F PIC  X(0001).
  2009     05  FILLER REDEFINES AHRT6F.
  2010         10  AHRT6A PIC  X(0001).
  2011     05  AHRT6I PIC  X(0006).
  2012*    -------------------------------
  2013     05  RECAL6L PIC S9(0004) COMP.
  2014     05  RECAL6F PIC  X(0001).
  2015     05  FILLER REDEFINES RECAL6F.
  2016         10  RECAL6A PIC  X(0001).
  2017     05  RECAL6I PIC  X(0001).
  2018*    -------------------------------
  2019     05  COMM6L PIC S9(0004) COMP.
  2020     05  COMM6F PIC  X(0001).
  2021     05  FILLER REDEFINES COMM6F.
  2022         10  COMM6A PIC  X(0001).
  2023     05  COMM6I PIC  X(0001).
  2024*    -------------------------------
  2025     05  CHGBK6L PIC S9(0004) COMP.
  2026     05  CHGBK6F PIC  X(0001).
  2027     05  FILLER REDEFINES CHGBK6F.
  2028         10  CHGBK6A PIC  X(0001).
  2029     05  CHGBK6I PIC  X(0002).
  2030*    -------------------------------
  2031     05  GLCDE6L PIC S9(0004) COMP.
  2032     05  GLCDE6F PIC  X(0001).
  2033     05  FILLER REDEFINES GLCDE6F.
  2034         10  GLCDE6A PIC  X(0001).
  2035     05  GLCDE6I PIC  X(0001).
  2036*    -------------------------------
  2037     05  AGNT7L PIC S9(0004) COMP.
  2038     05  AGNT7F PIC  X(0001).
  2039     05  FILLER REDEFINES AGNT7F.
  2040         10  AGNT7A PIC  X(0001).
  2041     05  AGNT7I PIC  X(0010).
  2042*    -------------------------------
  2043     05  TYPE7L PIC S9(0004) COMP.
  2044     05  TYPE7F PIC  X(0001).
  2045     05  FILLER REDEFINES TYPE7F.
  2046         10  TYPE7A PIC  X(0001).
  2047     05  TYPE7I PIC  X(0001).
  2048*    -------------------------------
  2049     05  SINRT7L PIC S9(0004) COMP.
  2050     05  SINRT7F PIC  X(0001).
  2051     05  FILLER REDEFINES SINRT7F.
  2052         10  SINRT7A PIC  X(0001).
  2053     05  SINRT7I PIC  X(0006).
  2054*    -------------------------------
  2055     05  JNTRT7L PIC S9(0004) COMP.
  2056     05  JNTRT7F PIC  X(0001).
  2057     05  FILLER REDEFINES JNTRT7F.
  2058         10  JNTRT7A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  42
* EL6501.cbl
  2059     05  JNTRT7I PIC  X(0006).
  2060*    -------------------------------
  2061     05  AHRT7L PIC S9(0004) COMP.
  2062     05  AHRT7F PIC  X(0001).
  2063     05  FILLER REDEFINES AHRT7F.
  2064         10  AHRT7A PIC  X(0001).
  2065     05  AHRT7I PIC  X(0006).
  2066*    -------------------------------
  2067     05  RECAL7L PIC S9(0004) COMP.
  2068     05  RECAL7F PIC  X(0001).
  2069     05  FILLER REDEFINES RECAL7F.
  2070         10  RECAL7A PIC  X(0001).
  2071     05  RECAL7I PIC  X(0001).
  2072*    -------------------------------
  2073     05  COMM7L PIC S9(0004) COMP.
  2074     05  COMM7F PIC  X(0001).
  2075     05  FILLER REDEFINES COMM7F.
  2076         10  COMM7A PIC  X(0001).
  2077     05  COMM7I PIC  X(0001).
  2078*    -------------------------------
  2079     05  CHGBK7L PIC S9(0004) COMP.
  2080     05  CHGBK7F PIC  X(0001).
  2081     05  FILLER REDEFINES CHGBK7F.
  2082         10  CHGBK7A PIC  X(0001).
  2083     05  CHGBK7I PIC  X(0002).
  2084*    -------------------------------
  2085     05  GLCDE7L PIC S9(0004) COMP.
  2086     05  GLCDE7F PIC  X(0001).
  2087     05  FILLER REDEFINES GLCDE7F.
  2088         10  GLCDE7A PIC  X(0001).
  2089     05  GLCDE7I PIC  X(0001).
  2090*    -------------------------------
  2091     05  AGNT8L PIC S9(0004) COMP.
  2092     05  AGNT8F PIC  X(0001).
  2093     05  FILLER REDEFINES AGNT8F.
  2094         10  AGNT8A PIC  X(0001).
  2095     05  AGNT8I PIC  X(0010).
  2096*    -------------------------------
  2097     05  TYPE8L PIC S9(0004) COMP.
  2098     05  TYPE8F PIC  X(0001).
  2099     05  FILLER REDEFINES TYPE8F.
  2100         10  TYPE8A PIC  X(0001).
  2101     05  TYPE8I PIC  X(0001).
  2102*    -------------------------------
  2103     05  SINRT8L PIC S9(0004) COMP.
  2104     05  SINRT8F PIC  X(0001).
  2105     05  FILLER REDEFINES SINRT8F.
  2106         10  SINRT8A PIC  X(0001).
  2107     05  SINRT8I PIC  X(0006).
  2108*    -------------------------------
  2109     05  JNTRT8L PIC S9(0004) COMP.
  2110     05  JNTRT8F PIC  X(0001).
  2111     05  FILLER REDEFINES JNTRT8F.
  2112         10  JNTRT8A PIC  X(0001).
  2113     05  JNTRT8I PIC  X(0006).
  2114*    -------------------------------
  2115     05  AHRT8L PIC S9(0004) COMP.
  2116     05  AHRT8F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  43
* EL6501.cbl
  2117     05  FILLER REDEFINES AHRT8F.
  2118         10  AHRT8A PIC  X(0001).
  2119     05  AHRT8I PIC  X(0006).
  2120*    -------------------------------
  2121     05  RECAL8L PIC S9(0004) COMP.
  2122     05  RECAL8F PIC  X(0001).
  2123     05  FILLER REDEFINES RECAL8F.
  2124         10  RECAL8A PIC  X(0001).
  2125     05  RECAL8I PIC  X(0001).
  2126*    -------------------------------
  2127     05  COMM8L PIC S9(0004) COMP.
  2128     05  COMM8F PIC  X(0001).
  2129     05  FILLER REDEFINES COMM8F.
  2130         10  COMM8A PIC  X(0001).
  2131     05  COMM8I PIC  X(0001).
  2132*    -------------------------------
  2133     05  CHGBK8L PIC S9(0004) COMP.
  2134     05  CHGBK8F PIC  X(0001).
  2135     05  FILLER REDEFINES CHGBK8F.
  2136         10  CHGBK8A PIC  X(0001).
  2137     05  CHGBK8I PIC  X(0002).
  2138*    -------------------------------
  2139     05  GLCDE8L PIC S9(0004) COMP.
  2140     05  GLCDE8F PIC  X(0001).
  2141     05  FILLER REDEFINES GLCDE8F.
  2142         10  GLCDE8A PIC  X(0001).
  2143     05  GLCDE8I PIC  X(0001).
  2144*    -------------------------------
  2145     05  AGNT9L PIC S9(0004) COMP.
  2146     05  AGNT9F PIC  X(0001).
  2147     05  FILLER REDEFINES AGNT9F.
  2148         10  AGNT9A PIC  X(0001).
  2149     05  AGNT9I PIC  X(0010).
  2150*    -------------------------------
  2151     05  TYPE9L PIC S9(0004) COMP.
  2152     05  TYPE9F PIC  X(0001).
  2153     05  FILLER REDEFINES TYPE9F.
  2154         10  TYPE9A PIC  X(0001).
  2155     05  TYPE9I PIC  X(0001).
  2156*    -------------------------------
  2157     05  SINRT9L PIC S9(0004) COMP.
  2158     05  SINRT9F PIC  X(0001).
  2159     05  FILLER REDEFINES SINRT9F.
  2160         10  SINRT9A PIC  X(0001).
  2161     05  SINRT9I PIC  X(0006).
  2162*    -------------------------------
  2163     05  JNTRT9L PIC S9(0004) COMP.
  2164     05  JNTRT9F PIC  X(0001).
  2165     05  FILLER REDEFINES JNTRT9F.
  2166         10  JNTRT9A PIC  X(0001).
  2167     05  JNTRT9I PIC  X(0006).
  2168*    -------------------------------
  2169     05  AHRT9L PIC S9(0004) COMP.
  2170     05  AHRT9F PIC  X(0001).
  2171     05  FILLER REDEFINES AHRT9F.
  2172         10  AHRT9A PIC  X(0001).
  2173     05  AHRT9I PIC  X(0006).
  2174*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  44
* EL6501.cbl
  2175     05  RECAL9L PIC S9(0004) COMP.
  2176     05  RECAL9F PIC  X(0001).
  2177     05  FILLER REDEFINES RECAL9F.
  2178         10  RECAL9A PIC  X(0001).
  2179     05  RECAL9I PIC  X(0001).
  2180*    -------------------------------
  2181     05  COMM9L PIC S9(0004) COMP.
  2182     05  COMM9F PIC  X(0001).
  2183     05  FILLER REDEFINES COMM9F.
  2184         10  COMM9A PIC  X(0001).
  2185     05  COMM9I PIC  X(0001).
  2186*    -------------------------------
  2187     05  CHGBK9L PIC S9(0004) COMP.
  2188     05  CHGBK9F PIC  X(0001).
  2189     05  FILLER REDEFINES CHGBK9F.
  2190         10  CHGBK9A PIC  X(0001).
  2191     05  CHGBK9I PIC  X(0002).
  2192*    -------------------------------
  2193     05  GLCDE9L PIC S9(0004) COMP.
  2194     05  GLCDE9F PIC  X(0001).
  2195     05  FILLER REDEFINES GLCDE9F.
  2196         10  GLCDE9A PIC  X(0001).
  2197     05  GLCDE9I PIC  X(0001).
  2198*    -------------------------------
  2199     05  AGNT10L PIC S9(0004) COMP.
  2200     05  AGNT10F PIC  X(0001).
  2201     05  FILLER REDEFINES AGNT10F.
  2202         10  AGNT10A PIC  X(0001).
  2203     05  AGNT10I PIC  X(0010).
  2204*    -------------------------------
  2205     05  TYPE10L PIC S9(0004) COMP.
  2206     05  TYPE10F PIC  X(0001).
  2207     05  FILLER REDEFINES TYPE10F.
  2208         10  TYPE10A PIC  X(0001).
  2209     05  TYPE10I PIC  X(0001).
  2210*    -------------------------------
  2211     05  SINRT10L PIC S9(0004) COMP.
  2212     05  SINRT10F PIC  X(0001).
  2213     05  FILLER REDEFINES SINRT10F.
  2214         10  SINRT10A PIC  X(0001).
  2215     05  SINRT10I PIC  X(0006).
  2216*    -------------------------------
  2217     05  JNTRT10L PIC S9(0004) COMP.
  2218     05  JNTRT10F PIC  X(0001).
  2219     05  FILLER REDEFINES JNTRT10F.
  2220         10  JNTRT10A PIC  X(0001).
  2221     05  JNTRT10I PIC  X(0006).
  2222*    -------------------------------
  2223     05  AHRT10L PIC S9(0004) COMP.
  2224     05  AHRT10F PIC  X(0001).
  2225     05  FILLER REDEFINES AHRT10F.
  2226         10  AHRT10A PIC  X(0001).
  2227     05  AHRT10I PIC  X(0006).
  2228*    -------------------------------
  2229     05  RECAL10L PIC S9(0004) COMP.
  2230     05  RECAL10F PIC  X(0001).
  2231     05  FILLER REDEFINES RECAL10F.
  2232         10  RECAL10A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  45
* EL6501.cbl
  2233     05  RECAL10I PIC  X(0001).
  2234*    -------------------------------
  2235     05  COMM10L PIC S9(0004) COMP.
  2236     05  COMM10F PIC  X(0001).
  2237     05  FILLER REDEFINES COMM10F.
  2238         10  COMM10A PIC  X(0001).
  2239     05  COMM10I PIC  X(0001).
  2240*    -------------------------------
  2241     05  CHGBK10L PIC S9(0004) COMP.
  2242     05  CHGBK10F PIC  X(0001).
  2243     05  FILLER REDEFINES CHGBK10F.
  2244         10  CHGBK10A PIC  X(0001).
  2245     05  CHGBK10I PIC  X(0002).
  2246*    -------------------------------
  2247     05  GLCDE10L PIC S9(0004) COMP.
  2248     05  GLCDE10F PIC  X(0001).
  2249     05  FILLER REDEFINES GLCDE10F.
  2250         10  GLCDE10A PIC  X(0001).
  2251     05  GLCDE10I PIC  X(0001).
  2252*    -------------------------------
  2253     05  ERRMSG1L PIC S9(0004) COMP.
  2254     05  ERRMSG1F PIC  X(0001).
  2255     05  FILLER REDEFINES ERRMSG1F.
  2256         10  ERRMSG1A PIC  X(0001).
  2257     05  ERRMSG1I PIC  X(0075).
  2258*    -------------------------------
  2259     05  PFENTERL PIC S9(0004) COMP.
  2260     05  PFENTERF PIC  X(0001).
  2261     05  FILLER REDEFINES PFENTERF.
  2262         10  PFENTERA PIC  X(0001).
  2263     05  PFENTERI PIC  9(2).
  2264*    -------------------------------
  2265     05  PF1PF2L PIC S9(0004) COMP.
  2266     05  PF1PF2F PIC  X(0001).
  2267     05  FILLER REDEFINES PF1PF2F.
  2268         10  PF1PF2A PIC  X(0001).
  2269     05  PF1PF2I PIC  X(0035).
  2270 01  EL6501AO REDEFINES EL6501AI.
  2271     05  FILLER            PIC  X(0012).
  2272*    -------------------------------
  2273     05  FILLER            PIC  X(0003).
  2274     05  DATEO PIC  X(0008).
  2275*    -------------------------------
  2276     05  FILLER            PIC  X(0003).
  2277     05  TIMEO PIC  99.99.
  2278*    -------------------------------
  2279     05  FILLER            PIC  X(0003).
  2280     05  CMPNYIDO PIC  X(0003).
  2281*    -------------------------------
  2282     05  FILLER            PIC  X(0003).
  2283     05  USERIDO PIC  X(0004).
  2284*    -------------------------------
  2285     05  FILLER            PIC  X(0003).
  2286     05  MAINTO PIC  X(0001).
  2287*    -------------------------------
  2288     05  FILLER            PIC  X(0003).
  2289     05  CARRO PIC  X(0001).
  2290*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  46
* EL6501.cbl
  2291     05  FILLER            PIC  X(0003).
  2292     05  GROUPINO PIC  X(0006).
  2293*    -------------------------------
  2294     05  FILLER            PIC  X(0003).
  2295     05  STATEO PIC  X(0002).
  2296*    -------------------------------
  2297     05  FILLER            PIC  X(0003).
  2298     05  ACCOUNTO PIC  X(0010).
  2299*    -------------------------------
  2300     05  FILLER            PIC  X(0003).
  2301     05  EFFDTEO PIC  X(0008).
  2302*    -------------------------------
  2303     05  FILLER            PIC  X(0003).
  2304     05  EXPDTEO PIC  99B99B99.
  2305*    -------------------------------
  2306     05  FILLER            PIC  X(0003).
  2307     05  MAINTBYO PIC  X(0004).
  2308*    -------------------------------
  2309     05  FILLER            PIC  X(0003).
  2310     05  PCONTO PIC  X(0030).
  2311*    -------------------------------
  2312     05  FILLER            PIC  X(0003).
  2313     05  CSRO PIC  X(0004).
  2314*    -------------------------------
  2315     05  FILLER            PIC  X(0003).
  2316     05  PDSPLYO PIC  X(0006).
  2317*    -------------------------------
  2318     05  FILLER            PIC  X(0003).
  2319     05  PEFFDTEO PIC  X(0008).
  2320*    -------------------------------
  2321     05  FILLER            PIC  X(0003).
  2322     05  PEXPDTEO PIC  X(0008).
  2323*    -------------------------------
  2324     05  FILLER            PIC  X(0003).
  2325     05  NAMEO PIC  X(0030).
  2326*    -------------------------------
  2327     05  FILLER            PIC  X(0003).
  2328     05  TAXNOO PIC  X(0011).
  2329*    -------------------------------
  2330     05  FILLER            PIC  X(0003).
  2331     05  STATUSO PIC  X(0001).
  2332*    -------------------------------
  2333     05  FILLER            PIC  X(0003).
  2334     05  INCAREO PIC  X(0030).
  2335*    -------------------------------
  2336     05  FILLER            PIC  X(0003).
  2337     05  PHONEO PIC  999B999B9999.
  2338*    -------------------------------
  2339     05  FILLER            PIC  X(0003).
  2340     05  INDGRPO PIC  X(0001).
  2341*    -------------------------------
  2342     05  FILLER            PIC  X(0003).
  2343     05  ADDR1O PIC  X(0030).
  2344*    -------------------------------
  2345     05  FILLER            PIC  X(0003).
  2346     05  CONTRO PIC  X(0008).
  2347*    -------------------------------
  2348     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  47
* EL6501.cbl
  2349     05  TYPEO PIC  X(0002).
  2350*    -------------------------------
  2351     05  FILLER            PIC  X(0003).
  2352     05  ACITYO PIC  X(0028).
  2353*    -------------------------------
  2354     05  FILLER            PIC  X(0003).
  2355     05  ASTATEO PIC  X(0002).
  2356*    -------------------------------
  2357     05  FILLER            PIC  X(0003).
  2358     05  PRODATEO PIC  X(0008).
  2359*    -------------------------------
  2360     05  FILLER            PIC  X(0003).
  2361     05  STDBENO PIC  X(0002).
  2362*    -------------------------------
  2363     05  FILLER            PIC  X(0003).
  2364     05  ZIPO PIC  X(0010).
  2365*    -------------------------------
  2366     05  FILLER            PIC  X(0003).
  2367     05  CTPLABLO PIC  X(0010).
  2368*    -------------------------------
  2369     05  FILLER            PIC  X(0003).
  2370     05  CLPTOLPO PIC  Z.9999.
  2371*    -------------------------------
  2372     05  FILLER            PIC  X(0003).
  2373     05  RETROCDO PIC  X(0003).
  2374*    -------------------------------
  2375     05  FILLER            PIC  X(0003).
  2376     05  BILLCDO PIC  X(0003).
  2377*    -------------------------------
  2378     05  FILLER            PIC  X(0003).
  2379     05  LCLABLO PIC  X(0011).
  2380*    -------------------------------
  2381     05  FILLER            PIC  X(0003).
  2382     05  LCOMMO PIC  ZZ99.99-.
  2383*    -------------------------------
  2384     05  FILLER            PIC  X(0003).
  2385     05  MAXFEEHO PIC  X(0013).
  2386*    -------------------------------
  2387     05  FILLER            PIC  X(0003).
  2388     05  MAXMFEEO PIC  Z,Z99.
  2389*    -------------------------------
  2390     05  FILLER            PIC  X(0003).
  2391     05  CLPSTHO PIC  X(0010).
  2392*    -------------------------------
  2393     05  FILLER            PIC  X(0003).
  2394     05  CLPSTO PIC  X(0002).
  2395*    -------------------------------
  2396     05  FILLER            PIC  X(0003).
  2397     05  PRODCDHO PIC  X(0012).
  2398*    -------------------------------
  2399     05  FILLER            PIC  X(0003).
  2400     05  PRODCDO PIC  X(0003).
  2401*    -------------------------------
  2402     05  FILLER            PIC  X(0003).
  2403     05  REMITO PIC  X(0002).
  2404*    -------------------------------
  2405     05  FILLER            PIC  X(0003).
  2406     05  COMMCALO PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  48
* EL6501.cbl
  2407*    -------------------------------
  2408     05  FILLER            PIC  X(0003).
  2409     05  REINTABO PIC  X(0003).
  2410*    -------------------------------
  2411     05  FILLER            PIC  X(0003).
  2412     05  REINCALO PIC  X(0001).
  2413*    -------------------------------
  2414     05  FILLER            PIC  X(0003).
  2415     05  AHHEADO PIC  X(0006).
  2416*    -------------------------------
  2417     05  FILLER            PIC  X(0003).
  2418     05  AGNT1O PIC  X(0010).
  2419*    -------------------------------
  2420     05  FILLER            PIC  X(0003).
  2421     05  TYPE1O PIC  X(0001).
  2422*    -------------------------------
  2423     05  FILLER            PIC  X(0003).
  2424     05  SINRT1O PIC  X(0006).
  2425*    -------------------------------
  2426     05  FILLER            PIC  X(0003).
  2427     05  JNTRT1O PIC  X(0006).
  2428*    -------------------------------
  2429     05  FILLER            PIC  X(0003).
  2430     05  AHRT1O PIC  X(0006).
  2431*    -------------------------------
  2432     05  FILLER            PIC  X(0003).
  2433     05  RECAL1O PIC  X(0001).
  2434*    -------------------------------
  2435     05  FILLER            PIC  X(0003).
  2436     05  COMM1O PIC  X(0001).
  2437*    -------------------------------
  2438     05  FILLER            PIC  X(0003).
  2439     05  CHGBK1O PIC  X(0002).
  2440*    -------------------------------
  2441     05  FILLER            PIC  X(0003).
  2442     05  GLCDE1O PIC  X(0001).
  2443*    -------------------------------
  2444     05  FILLER            PIC  X(0003).
  2445     05  AGNT2O PIC  X(0010).
  2446*    -------------------------------
  2447     05  FILLER            PIC  X(0003).
  2448     05  TYPE2O PIC  X(0001).
  2449*    -------------------------------
  2450     05  FILLER            PIC  X(0003).
  2451     05  SINRT2O PIC  X(0006).
  2452*    -------------------------------
  2453     05  FILLER            PIC  X(0003).
  2454     05  JNTRT2O PIC  X(0006).
  2455*    -------------------------------
  2456     05  FILLER            PIC  X(0003).
  2457     05  AHRT2O PIC  X(0006).
  2458*    -------------------------------
  2459     05  FILLER            PIC  X(0003).
  2460     05  RECAL2O PIC  X(0001).
  2461*    -------------------------------
  2462     05  FILLER            PIC  X(0003).
  2463     05  COMM2O PIC  X(0001).
  2464*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  49
* EL6501.cbl
  2465     05  FILLER            PIC  X(0003).
  2466     05  CHGBK2O PIC  X(0002).
  2467*    -------------------------------
  2468     05  FILLER            PIC  X(0003).
  2469     05  GLCDE2O PIC  X(0001).
  2470*    -------------------------------
  2471     05  FILLER            PIC  X(0003).
  2472     05  AGNT3O PIC  X(0010).
  2473*    -------------------------------
  2474     05  FILLER            PIC  X(0003).
  2475     05  TYPE3O PIC  X(0001).
  2476*    -------------------------------
  2477     05  FILLER            PIC  X(0003).
  2478     05  SINRT3O PIC  X(0006).
  2479*    -------------------------------
  2480     05  FILLER            PIC  X(0003).
  2481     05  JNTRT3O PIC  X(0006).
  2482*    -------------------------------
  2483     05  FILLER            PIC  X(0003).
  2484     05  AHRT3O PIC  X(0006).
  2485*    -------------------------------
  2486     05  FILLER            PIC  X(0003).
  2487     05  RECAL3O PIC  X(0001).
  2488*    -------------------------------
  2489     05  FILLER            PIC  X(0003).
  2490     05  COMM3O PIC  X(0001).
  2491*    -------------------------------
  2492     05  FILLER            PIC  X(0003).
  2493     05  CHGBK3O PIC  X(0002).
  2494*    -------------------------------
  2495     05  FILLER            PIC  X(0003).
  2496     05  GLCDE3O PIC  X(0001).
  2497*    -------------------------------
  2498     05  FILLER            PIC  X(0003).
  2499     05  AGNT4O PIC  X(0010).
  2500*    -------------------------------
  2501     05  FILLER            PIC  X(0003).
  2502     05  TYPE4O PIC  X(0001).
  2503*    -------------------------------
  2504     05  FILLER            PIC  X(0003).
  2505     05  SINRT4O PIC  X(0006).
  2506*    -------------------------------
  2507     05  FILLER            PIC  X(0003).
  2508     05  JNTRT4O PIC  X(0006).
  2509*    -------------------------------
  2510     05  FILLER            PIC  X(0003).
  2511     05  AHRT4O PIC  X(0006).
  2512*    -------------------------------
  2513     05  FILLER            PIC  X(0003).
  2514     05  RECAL4O PIC  X(0001).
  2515*    -------------------------------
  2516     05  FILLER            PIC  X(0003).
  2517     05  COMM4O PIC  X(0001).
  2518*    -------------------------------
  2519     05  FILLER            PIC  X(0003).
  2520     05  CHGBK4O PIC  X(0002).
  2521*    -------------------------------
  2522     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  50
* EL6501.cbl
  2523     05  GLCDE4O PIC  X(0001).
  2524*    -------------------------------
  2525     05  FILLER            PIC  X(0003).
  2526     05  AGNT5O PIC  X(0010).
  2527*    -------------------------------
  2528     05  FILLER            PIC  X(0003).
  2529     05  TYPE5O PIC  X(0001).
  2530*    -------------------------------
  2531     05  FILLER            PIC  X(0003).
  2532     05  SINRT5O PIC  X(0006).
  2533*    -------------------------------
  2534     05  FILLER            PIC  X(0003).
  2535     05  JNTRT5O PIC  X(0006).
  2536*    -------------------------------
  2537     05  FILLER            PIC  X(0003).
  2538     05  AHRT5O PIC  X(0006).
  2539*    -------------------------------
  2540     05  FILLER            PIC  X(0003).
  2541     05  RECAL5O PIC  X(0001).
  2542*    -------------------------------
  2543     05  FILLER            PIC  X(0003).
  2544     05  COMM5O PIC  X(0001).
  2545*    -------------------------------
  2546     05  FILLER            PIC  X(0003).
  2547     05  CHGBK5O PIC  X(0002).
  2548*    -------------------------------
  2549     05  FILLER            PIC  X(0003).
  2550     05  GLCDE5O PIC  X(0001).
  2551*    -------------------------------
  2552     05  FILLER            PIC  X(0003).
  2553     05  AGNT6O PIC  X(0010).
  2554*    -------------------------------
  2555     05  FILLER            PIC  X(0003).
  2556     05  TYPE6O PIC  X(0001).
  2557*    -------------------------------
  2558     05  FILLER            PIC  X(0003).
  2559     05  SINRT6O PIC  X(0006).
  2560*    -------------------------------
  2561     05  FILLER            PIC  X(0003).
  2562     05  JNTRT6O PIC  X(0006).
  2563*    -------------------------------
  2564     05  FILLER            PIC  X(0003).
  2565     05  AHRT6O PIC  X(0006).
  2566*    -------------------------------
  2567     05  FILLER            PIC  X(0003).
  2568     05  RECAL6O PIC  X(0001).
  2569*    -------------------------------
  2570     05  FILLER            PIC  X(0003).
  2571     05  COMM6O PIC  X(0001).
  2572*    -------------------------------
  2573     05  FILLER            PIC  X(0003).
  2574     05  CHGBK6O PIC  X(0002).
  2575*    -------------------------------
  2576     05  FILLER            PIC  X(0003).
  2577     05  GLCDE6O PIC  X(0001).
  2578*    -------------------------------
  2579     05  FILLER            PIC  X(0003).
  2580     05  AGNT7O PIC  X(0010).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  51
* EL6501.cbl
  2581*    -------------------------------
  2582     05  FILLER            PIC  X(0003).
  2583     05  TYPE7O PIC  X(0001).
  2584*    -------------------------------
  2585     05  FILLER            PIC  X(0003).
  2586     05  SINRT7O PIC  X(0006).
  2587*    -------------------------------
  2588     05  FILLER            PIC  X(0003).
  2589     05  JNTRT7O PIC  X(0006).
  2590*    -------------------------------
  2591     05  FILLER            PIC  X(0003).
  2592     05  AHRT7O PIC  X(0006).
  2593*    -------------------------------
  2594     05  FILLER            PIC  X(0003).
  2595     05  RECAL7O PIC  X(0001).
  2596*    -------------------------------
  2597     05  FILLER            PIC  X(0003).
  2598     05  COMM7O PIC  X(0001).
  2599*    -------------------------------
  2600     05  FILLER            PIC  X(0003).
  2601     05  CHGBK7O PIC  X(0002).
  2602*    -------------------------------
  2603     05  FILLER            PIC  X(0003).
  2604     05  GLCDE7O PIC  X(0001).
  2605*    -------------------------------
  2606     05  FILLER            PIC  X(0003).
  2607     05  AGNT8O PIC  X(0010).
  2608*    -------------------------------
  2609     05  FILLER            PIC  X(0003).
  2610     05  TYPE8O PIC  X(0001).
  2611*    -------------------------------
  2612     05  FILLER            PIC  X(0003).
  2613     05  SINRT8O PIC  X(0006).
  2614*    -------------------------------
  2615     05  FILLER            PIC  X(0003).
  2616     05  JNTRT8O PIC  X(0006).
  2617*    -------------------------------
  2618     05  FILLER            PIC  X(0003).
  2619     05  AHRT8O PIC  X(0006).
  2620*    -------------------------------
  2621     05  FILLER            PIC  X(0003).
  2622     05  RECAL8O PIC  X(0001).
  2623*    -------------------------------
  2624     05  FILLER            PIC  X(0003).
  2625     05  COMM8O PIC  X(0001).
  2626*    -------------------------------
  2627     05  FILLER            PIC  X(0003).
  2628     05  CHGBK8O PIC  X(0002).
  2629*    -------------------------------
  2630     05  FILLER            PIC  X(0003).
  2631     05  GLCDE8O PIC  X(0001).
  2632*    -------------------------------
  2633     05  FILLER            PIC  X(0003).
  2634     05  AGNT9O PIC  X(0010).
  2635*    -------------------------------
  2636     05  FILLER            PIC  X(0003).
  2637     05  TYPE9O PIC  X(0001).
  2638*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  52
* EL6501.cbl
  2639     05  FILLER            PIC  X(0003).
  2640     05  SINRT9O PIC  X(0006).
  2641*    -------------------------------
  2642     05  FILLER            PIC  X(0003).
  2643     05  JNTRT9O PIC  X(0006).
  2644*    -------------------------------
  2645     05  FILLER            PIC  X(0003).
  2646     05  AHRT9O PIC  X(0006).
  2647*    -------------------------------
  2648     05  FILLER            PIC  X(0003).
  2649     05  RECAL9O PIC  X(0001).
  2650*    -------------------------------
  2651     05  FILLER            PIC  X(0003).
  2652     05  COMM9O PIC  X(0001).
  2653*    -------------------------------
  2654     05  FILLER            PIC  X(0003).
  2655     05  CHGBK9O PIC  X(0002).
  2656*    -------------------------------
  2657     05  FILLER            PIC  X(0003).
  2658     05  GLCDE9O PIC  X(0001).
  2659*    -------------------------------
  2660     05  FILLER            PIC  X(0003).
  2661     05  AGNT10O PIC  X(0010).
  2662*    -------------------------------
  2663     05  FILLER            PIC  X(0003).
  2664     05  TYPE10O PIC  X(0001).
  2665*    -------------------------------
  2666     05  FILLER            PIC  X(0003).
  2667     05  SINRT10O PIC  X(0006).
  2668*    -------------------------------
  2669     05  FILLER            PIC  X(0003).
  2670     05  JNTRT10O PIC  X(0006).
  2671*    -------------------------------
  2672     05  FILLER            PIC  X(0003).
  2673     05  AHRT10O PIC  X(0006).
  2674*    -------------------------------
  2675     05  FILLER            PIC  X(0003).
  2676     05  RECAL10O PIC  X(0001).
  2677*    -------------------------------
  2678     05  FILLER            PIC  X(0003).
  2679     05  COMM10O PIC  X(0001).
  2680*    -------------------------------
  2681     05  FILLER            PIC  X(0003).
  2682     05  CHGBK10O PIC  X(0002).
  2683*    -------------------------------
  2684     05  FILLER            PIC  X(0003).
  2685     05  GLCDE10O PIC  X(0001).
  2686*    -------------------------------
  2687     05  FILLER            PIC  X(0003).
  2688     05  ERRMSG1O PIC  X(0075).
  2689*    -------------------------------
  2690     05  FILLER            PIC  X(0003).
  2691     05  PFENTERO PIC  X(0002).
  2692*    -------------------------------
  2693     05  FILLER            PIC  X(0003).
  2694     05  PF1PF2O PIC  X(0035).
  2695*    -------------------------------
  2696 01  MAP-R REDEFINES EL6501AI.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  53
* EL6501.cbl
  2697*    12  FILLER                  PIC X(518).
  2698*    12  FILLER                  PIC X(543).
  2699     12  FILLER                  PIC X(546).
  2700     12  MAP-AGENT-AREA.
  2701         16  AGENT-AREA OCCURS 10 TIMES INDEXED BY M-INDEX.
  2702             20  AGENTL          PIC S9(4) COMP.
  2703             20  AGENTA          PIC X.
  2704             20  AGENT           PIC X(10).
  2705             20  ATYPEL          PIC S9(4) COMP.
  2706             20  ATYPEA          PIC X.
  2707             20  ATYPE           PIC X.
  2708             20  SINGLEL         PIC S9(4) COMP.
  2709             20  SINGLEA         PIC X.
  2710             20  SINGLE-COMM-T   PIC X(6).
  2711             20  SINGLE-COMM-N REDEFINES SINGLE-COMM-T.
  2712                 24  SINGLE-COMM-R PIC V9(5).
  2713                 24  SINGLE-DASH   PIC X.
  2714             20  SINGLE-COMM-O REDEFINES SINGLE-COMM-T
  2715                                 PIC V9(5)-.
  2716             20  JOINTL          PIC S9(4) COMP.
  2717             20  JOINTA          PIC X.
  2718             20  JOINT-COMM-T    PIC X(6).
  2719             20  JOINT-COMM-N REDEFINES JOINT-COMM-T.
  2720                 24  JOINT-COMM-R PIC V9(5).
  2721                 24  JOINT-DASH   PIC X.
  2722             20  JOINT-COMM-O REDEFINES JOINT-COMM-T
  2723                                 PIC V9(5)-.
  2724             20  A-HL            PIC S9(4) COMP.
  2725             20  A-HA            PIC X.
  2726             20  A-H-COMM-T      PIC X(6).
  2727             20  A-H-COMM-N  REDEFINES A-H-COMM-T.
  2728                 24  A-H-COMM-R  PIC V9(5).
  2729                 24  A-H-DASH    PIC X.
  2730             20  A-H-COMM-O  REDEFINES A-H-COMM-T
  2731                                 PIC V9(5)-.
  2732             20  RECALL          PIC S9(4) COMP.
  2733             20  RECALA          PIC X.
  2734             20  RECAL           PIC X.
  2735             20  RCOMML          PIC S9(4) COMP.
  2736             20  RCOMMA          PIC X.
  2737             20  RCOMM           PIC X.
  2738             20  CHGBCKL         PIC S9(4) COMP.
  2739             20  CHGBCKA         PIC X.
  2740             20  CHGBCK          PIC X(02).
  2741             20  GLCODEL         PIC S9(4) COMP.
  2742             20  GLCODEA         PIC X.
  2743             20  GLCODE          PIC X.
  2744****************************************************************
  2745*
  2746* Copyright (c) 2007 by Clerity Solutions, Inc.
  2747* All rights reserved.
  2748*
  2749****************************************************************
  2750 01  DFHEIV.
  2751   02  DFHEIV0               PIC X(35).
  2752   02  DFHEIV1               PIC X(08).
  2753   02  DFHEIV2               PIC X(08).
  2754   02  DFHEIV3               PIC X(08).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  54
* EL6501.cbl
  2755   02  DFHEIV4               PIC X(06).
  2756   02  DFHEIV5               PIC X(04).
  2757   02  DFHEIV6               PIC X(04).
  2758   02  DFHEIV7               PIC X(02).
  2759   02  DFHEIV8               PIC X(02).
  2760   02  DFHEIV9               PIC X(01).
  2761   02  DFHEIV10              PIC S9(7) COMP-3.
  2762   02  DFHEIV11              PIC S9(4) COMP SYNC.
  2763   02  DFHEIV12              PIC S9(4) COMP SYNC.
  2764   02  DFHEIV13              PIC S9(4) COMP SYNC.
  2765   02  DFHEIV14              PIC S9(4) COMP SYNC.
  2766   02  DFHEIV15              PIC S9(4) COMP SYNC.
  2767   02  DFHEIV16              PIC S9(9) COMP SYNC.
  2768   02  DFHEIV17              PIC X(04).
  2769   02  DFHEIV18              PIC X(04).
  2770   02  DFHEIV19              PIC X(04).
  2771   02  DFHEIV20              USAGE IS POINTER.
  2772   02  DFHEIV21              USAGE IS POINTER.
  2773   02  DFHEIV22              USAGE IS POINTER.
  2774   02  DFHEIV23              USAGE IS POINTER.
  2775   02  DFHEIV24              USAGE IS POINTER.
  2776   02  DFHEIV25              PIC S9(9) COMP SYNC.
  2777   02  DFHEIV26              PIC S9(9) COMP SYNC.
  2778   02  DFHEIV27              PIC S9(9) COMP SYNC.
  2779   02  DFHEIV28              PIC S9(9) COMP SYNC.
  2780   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  2781   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  2782   02  FILLER                PIC X(02).
  2783   02  DFHEIV99              PIC X(08) VALUE SPACE.
  2784   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  2785   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  2786   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  2787   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  2788 LINKAGE  SECTION.
  2789*****************************************************************
  2790*                                                               *
  2791* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  2792* All rights reserved.                                          *
  2793*                                                               *
  2794*****************************************************************
  2795 01  dfheiblk.
  2796     02  eibtime          pic s9(7) comp-3.
  2797     02  eibdate          pic s9(7) comp-3.
  2798     02  eibtrnid         pic x(4).
  2799     02  eibtaskn         pic s9(7) comp-3.
  2800     02  eibtrmid         pic x(4).
  2801     02  dfheigdi         pic s9(4) comp.
  2802     02  eibcposn         pic s9(4) comp.
  2803     02  eibcalen         pic s9(4) comp.
  2804     02  eibaid           pic x(1).
  2805     02  eibfiller1       pic x(1).
  2806     02  eibfn            pic x(2).
  2807     02  eibfiller2       pic x(2).
  2808     02  eibrcode         pic x(6).
  2809     02  eibfiller3       pic x(2).
  2810     02  eibds            pic x(8).
  2811     02  eibreqid         pic x(8).
  2812     02  eibrsrce         pic x(8).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  55
* EL6501.cbl
  2813     02  eibsync          pic x(1).
  2814     02  eibfree          pic x(1).
  2815     02  eibrecv          pic x(1).
  2816     02  eibsend          pic x(1).
  2817     02  eibatt           pic x(1).
  2818     02  eibeoc           pic x(1).
  2819     02  eibfmh           pic x(1).
  2820     02  eibcompl         pic x(1).
  2821     02  eibsig           pic x(1).
  2822     02  eibconf          pic x(1).
  2823     02  eiberr           pic x(1).
  2824     02  eibrldbk         pic x(1).
  2825     02  eiberrcd         pic x(4).
  2826     02  eibsynrb         pic x(1).
  2827     02  eibnodat         pic x(1).
  2828     02  eibfiller5       pic x(2).
  2829     02  eibresp          pic 9(09) comp.
  2830     02  eibresp2         pic 9(09) comp.
  2831     02  dfheigdj         pic s9(4) comp.
  2832     02  dfheigdk         pic s9(4) comp.
  2833 01  DFHCOMMAREA                 PIC X(1500).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  56
* EL6501.cbl
  2835*01 PARMLIST .
  2836*    02  FILLER                  PIC S9(8)   COMP.
  2837*    02  ERACCT-POINTER          PIC S9(8)   COMP.
  2838*    02  ELCNTL-POINTER          PIC S9(8)   COMP.
  2839*    02  REIN-POINTER            PIC S9(8)   COMP.
  2840*    02  CTBL-POINTER            PIC S9(8)   COMP.
  2841*    02  COMM-POINTER            PIC S9(8)   COMP.
  2842*    02  COMP-POINTER            PIC S9(8)   COMP.
  2843*    02  NAME-POINTER            PIC S9(8)   COMP.
  2844*    02  RQST-POINTER            PIC S9(8)   COMP.
  2845*    02  AXRF-POINTER            PIC S9(8)   COMP.
  2846*    02  AXRF2-POINTER           PIC S9(8)   COMP.
  2847*    02  AXRF3-POINTER           PIC S9(8)   COMP.
  2848*    02  AXRF4-POINTER           PIC S9(8)   COMP.
  2849*    02  AXRF5-POINTER           PIC S9(8)   COMP.
  2850*    02  AXRF6-POINTER           PIC S9(8)   COMP.
  2851*    02  AXRF7-POINTER           PIC S9(8)   COMP.
  2852*    02  AXRF8-POINTER           PIC S9(8)   COMP.
  2853*    COPY ERCACCT.
  2854******************************************************************
  2855*                                                                *
  2856*                                                                *
  2857*                            ERCACCT                             *
  2858*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2859*                            VMOD=2.031                          *
  2860*                                                                *
  2861*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  2862*                                                                *
  2863*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  2864*   VSAM ACCOUNT MASTER FILES.                                   *
  2865*                                                                *
  2866*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  2867*                                                                *
  2868*   FILE TYPE = VSAM,KSDS                                        *
  2869*   RECORD SIZE = 2000  RECFORM = FIX                            *
  2870*                                                                *
  2871*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  2872*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  2873*                                                                *
  2874*   LOG = NO                                                     *
  2875*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2876*                                                                *
  2877*                                                                *
  2878******************************************************************
  2879*                   C H A N G E   L O G
  2880*
  2881* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2882*-----------------------------------------------------------------
  2883*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2884* EFFECTIVE    NUMBER
  2885*-----------------------------------------------------------------
  2886* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  2887* 092705    2005050300006  PEMA  ADD SPP LEASES
  2888* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  2889* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2890* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  2891* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  2892* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  57
* EL6501.cbl
  2893******************************************************************
  2894
  2895 01  ACCOUNT-MASTER.
  2896     12  AM-RECORD-ID                      PIC XX.
  2897         88  VALID-AM-ID                      VALUE 'AM'.
  2898
  2899     12  AM-CONTROL-PRIMARY.
  2900         16  AM-COMPANY-CD                 PIC X.
  2901         16  AM-MSTR-CNTRL.
  2902             20  AM-CONTROL-A.
  2903                 24  AM-CARRIER            PIC X.
  2904                 24  AM-GROUPING.
  2905                     28 AM-GROUPING-PREFIX PIC XXX.
  2906                     28 AM-GROUPING-PRIME  PIC XXX.
  2907                 24  AM-STATE              PIC XX.
  2908                 24  AM-ACCOUNT.
  2909                     28  AM-ACCOUNT-PREFIX PIC X(4).
  2910                     28  AM-ACCOUNT-PRIME  PIC X(6).
  2911             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  2912                                           PIC X(19).
  2913             20  AM-CNTRL-B.
  2914                 24  AM-EXPIRATION-DT      PIC XX.
  2915                 24  FILLER                PIC X(4).
  2916             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  2917                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  2918
  2919     12  AM-CONTROL-BY-VAR-GRP.
  2920         16  AM-COMPANY-CD-A1              PIC X.
  2921         16  AM-VG-CARRIER                 PIC X.
  2922         16  AM-VG-GROUPING                PIC X(6).
  2923         16  AM-VG-STATE                   PIC XX.
  2924         16  AM-VG-ACCOUNT                 PIC X(10).
  2925         16  AM-VG-DATE.
  2926             20  AM-VG-EXPIRATION-DT       PIC XX.
  2927             20  FILLER                    PIC X(4).
  2928         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  2929                                           PIC 9(11)      COMP-3.
  2930     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  2931         16  FILLER                        PIC X(10).
  2932         16  AM-VG-KEY3.
  2933             20  AM-VG3-ACCOUNT            PIC X(10).
  2934             20  AM-VG3-EXP-DT             PIC XX.
  2935         16  FILLER                        PIC X(4).
  2936     12  AM-MAINT-INFORMATION.
  2937         16  AM-LAST-MAINT-DT              PIC XX.
  2938         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2939         16  AM-LAST-MAINT-USER            PIC X(4).
  2940         16  FILLER                        PIC XX.
  2941
  2942     12  AM-EFFECTIVE-DT                   PIC XX.
  2943     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  2944
  2945     12  AM-PREV-DATES  COMP-3.
  2946         16  AM-PREV-EXP-DT                PIC 9(11).
  2947         16  AM-PREV-EFF-DT                PIC 9(11).
  2948
  2949     12  AM-REPORT-CODE-1                  PIC X(10).
  2950     12  AM-REPORT-CODE-2                  PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  58
* EL6501.cbl
  2951
  2952     12  AM-CITY-CODE                      PIC X(4).
  2953     12  AM-COUNTY-PARISH                  PIC X(6).
  2954
  2955     12  AM-NAME                           PIC X(30).
  2956     12  AM-PERSON                         PIC X(30).
  2957     12  AM-ADDRS                          PIC X(30).
  2958     12  AM-CITY.
  2959         16  AM-ADDR-CITY                  PIC X(28).
  2960         16  AM-ADDR-STATE                 PIC XX.
  2961     12  AM-ZIP.
  2962         16  AM-ZIP-PRIME.
  2963             20  AM-ZIP-PRI-1ST            PIC X.
  2964                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  2965             20  FILLER                    PIC X(4).
  2966         16  AM-ZIP-PLUS4                  PIC X(4).
  2967     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  2968         16  AM-CAN-POSTAL-1               PIC XXX.
  2969         16  AM-CAN-POSTAL-2               PIC XXX.
  2970         16  FILLER                        PIC XXX.
  2971     12  AM-TEL-NO.
  2972         16  AM-AREA-CODE                  PIC 999.
  2973         16  AM-TEL-PRE                    PIC 999.
  2974         16  AM-TEL-NBR                    PIC 9(4).
  2975     12  AM-TEL-LOC                        PIC X.
  2976         88  AM-TEL-AT-HOME                   VALUE 'H'.
  2977         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  2978
  2979     12  AM-COMM-STRUCTURE.
  2980         16  AM-DEFN-1.
  2981             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  2982                 24  AM-AGT.
  2983                     28  AM-AGT-PREFIX     PIC X(4).
  2984                     28  AM-AGT-PRIME      PIC X(6).
  2985                 24  AM-COM-TYP            PIC X.
  2986                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  2987                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  2988                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  2989                 24  AM-RECALC-LV-INDIC    PIC X.
  2990                 24  AM-RETRO-LV-INDIC     PIC X.
  2991                 24  AM-GL-CODES           PIC X.
  2992                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  2993                 24  FILLER                PIC X(01).
  2994         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  2995             20  AM-COM-TBLS        OCCURS 10 TIMES.
  2996                 24  FILLER                PIC X(11).
  2997                 24  AM-L-COMA             PIC XXX.
  2998                 24  AM-J-COMA             PIC XXX.
  2999                 24  AM-A-COMA             PIC XXX.
  3000                 24  FILLER                PIC X(6).
  3001
  3002     12  AM-COMM-CHANGE-STATUS             PIC X.
  3003         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  3004
  3005     12  AM-CSR-CODE                       PIC X(4).
  3006
  3007     12  AM-BILLING-STATUS                 PIC X.
  3008         88  AM-ACCOUNT-BILLED                VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  59
* EL6501.cbl
  3009         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  3010     12  AM-AUTO-REFUND-SW                 PIC X.
  3011         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  3012         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  3013     12  AM-GPCD                           PIC 99.
  3014     12  AM-IG                             PIC X.
  3015         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  3016         88  AM-HAS-GROUP                     VALUE '2'.
  3017     12  AM-STATUS                         PIC X.
  3018         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  3019         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  3020         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  3021         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  3022         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  3023         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  3024     12  AM-REMIT-TO                       PIC 99.
  3025     12  AM-ID-NO                          PIC X(11).
  3026
  3027     12  AM-CAL-TABLE                      PIC XX.
  3028     12  AM-LF-DEVIATION                   PIC XXX.
  3029     12  AM-AH-DEVIATION                   PIC XXX.
  3030     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  3031     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  3032     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  3033     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  3034     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  3035     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  3036
  3037     12  AM-USER-FIELDS.
  3038         16  AM-FLD-1                      PIC XX.
  3039         16  AM-FLD-2                      PIC XX.
  3040         16  AM-FLD-3                      PIC XX.
  3041         16  AM-FLD-4                      PIC XX.
  3042         16  AM-FLD-5                      PIC XX.
  3043
  3044     12  AM-1ST-PROD-DATE.
  3045         16  AM-1ST-PROD-YR                PIC XX.
  3046         16  AM-1ST-PROD-MO                PIC XX.
  3047         16  AM-1ST-PROD-DA                PIC XX.
  3048     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  3049     12  AM-CERTS-PURGED-DATE.
  3050         16  AM-PUR-YR                     PIC XX.
  3051         16  AM-PUR-MO                     PIC XX.
  3052         16  AM-PUR-DA                     PIC XX.
  3053     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  3054     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  3055     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  3056     12  AM-INACTIVE-DATE.
  3057         16  AM-INA-MO                     PIC 99.
  3058         16  AM-INA-DA                     PIC 99.
  3059         16  AM-INA-YR                     PIC 99.
  3060     12  AM-AR-HI-CERT-DATE                PIC XX.
  3061
  3062     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  3063     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  3064
  3065     12  AM-OB-PAYMENT-MODE                PIC X.
  3066         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  60
* EL6501.cbl
  3067         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  3068         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  3069         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  3070
  3071     12  AM-AH-ONLY-INDICATOR              PIC X.
  3072         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  3073         88  AM-NO-AH-ONLY                    VALUE 'N'.
  3074
  3075     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  3076
  3077     12  AM-OVER-SHORT.
  3078         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  3079         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  3080
  3081     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  3082     12  AM-DCC-CLP-STATE                  PIC XX.
  3083
  3084     12  AM-RECALC-COMM                    PIC X.
  3085     12  AM-RECALC-REIN                    PIC X.
  3086
  3087     12  AM-REI-TABLE                      PIC XXX.
  3088     12  AM-REI-ET-LF                      PIC X.
  3089     12  AM-REI-ET-AH                      PIC X.
  3090     12  AM-REI-PE-LF                      PIC X.
  3091     12  AM-REI-PE-AH                      PIC X.
  3092     12  AM-REI-PRT-ST                     PIC X.
  3093     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  3094     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  3095     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  3096     12  AM-REI-GROUP-A                    PIC X(6).
  3097     12  AM-REI-MORT                       PIC X(4).
  3098     12  AM-REI-PRT-OW                     PIC X.
  3099     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  3100     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  3101     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  3102     12  AM-REI-GROUP-B                    PIC X(6).
  3103
  3104     12  AM-TRUST-TYPE                     PIC X(2).
  3105
  3106     12  AM-EMPLOYER-STMT-USED             PIC X.
  3107     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  3108
  3109     12  AM-STD-AH-TYPE                    PIC XX.
  3110     12  AM-EARN-METHODS.
  3111         16  AM-EARN-METHOD-R              PIC X.
  3112             88 AM-REF-RL-R78                 VALUE 'R'.
  3113             88 AM-REF-RL-PR                  VALUE 'P'.
  3114             88 AM-REF-RL-MEAN                VALUE 'M'.
  3115             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  3116         16  AM-EARN-METHOD-L              PIC X.
  3117             88 AM-REF-LL-R78                 VALUE 'R'.
  3118             88 AM-REF-LL-PR                  VALUE 'P'.
  3119             88 AM-REF-LL-MEAN                VALUE 'M'.
  3120             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  3121         16  AM-EARN-METHOD-A              PIC X.
  3122             88 AM-REF-AH-R78                 VALUE 'R'.
  3123             88 AM-REF-AH-PR                  VALUE 'P'.
  3124             88 AM-REF-AH-MEAN                VALUE 'M'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  61
* EL6501.cbl
  3125             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  3126             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  3127             88 AM-REF-AH-NET                 VALUE 'N'.
  3128
  3129     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  3130     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  3131     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  3132
  3133     12  AM-RET-Y-N                        PIC X.
  3134     12  AM-RET-P-E                        PIC X.
  3135     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  3136     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  3137     12  AM-RET-GRP                        PIC X(6).
  3138     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  3139         16  AM-POOL-PRIME                 PIC XXX.
  3140         16  AM-POOL-SUB                   PIC XXX.
  3141     12  AM-RETRO-EARNINGS.
  3142         16  AM-RET-EARN-R                 PIC X.
  3143         16  AM-RET-EARN-L                 PIC X.
  3144         16  AM-RET-EARN-A                 PIC X.
  3145     12  AM-RET-ST-TAX-USE                 PIC X.
  3146         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  3147         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  3148     12  AM-RETRO-BEG-EARNINGS.
  3149         16  AM-RET-BEG-EARN-R             PIC X.
  3150         16  AM-RET-BEG-EARN-L             PIC X.
  3151         16  AM-RET-BEG-EARN-A             PIC X.
  3152     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  3153     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  3154
  3155     12  AM-USER-SELECT-OPTIONS.
  3156         16  AM-USER-SELECT-1              PIC X(10).
  3157         16  AM-USER-SELECT-2              PIC X(10).
  3158         16  AM-USER-SELECT-3              PIC X(10).
  3159         16  AM-USER-SELECT-4              PIC X(10).
  3160         16  AM-USER-SELECT-5              PIC X(10).
  3161
  3162     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  3163
  3164     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  3165
  3166     12  AM-RPT045A-SWITCH                 PIC X.
  3167         88  RPT045A-OFF                   VALUE 'N'.
  3168
  3169     12  AM-INSURANCE-LIMITS.
  3170         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  3171         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  3172
  3173     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  3174         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  3175
  3176     12  AM-DISMBR-COVERAGE-SW             PIC X.
  3177         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  3178         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  3179
  3180     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  3181
  3182     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  62
* EL6501.cbl
  3183     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  3184     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  3185     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  3186     12  AM-DCC-UEF-STATE                  PIC XX.
  3187     12  FILLER                            PIC XXX.
  3188     12  AM-REPORT-CODE-3                  PIC X(10).
  3189*    12  FILLER                            PIC X(22).
  3190
  3191     12  AM-RESERVE-DATE.
  3192         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  3193         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  3194         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  3195
  3196     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  3197     12  AM-NOTIFICATION-TYPES.
  3198         16  AM-NOTIF-OF-LETTERS           PIC X.
  3199         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  3200         16  AM-NOTIF-OF-REPORTS           PIC X.
  3201         16  AM-NOTIF-OF-STATUS            PIC X.
  3202
  3203     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  3204         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  3205         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  3206         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  3207         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  3208
  3209     12  AM-BENEFIT-CONTROLS.
  3210         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  3211             20  AM-BENEFIT-CODE           PIC XX.
  3212             20  AM-BENEFIT-TYPE           PIC X.
  3213             20  AM-BENEFIT-REVISION       PIC XXX.
  3214             20  AM-BENEFIT-REM-TERM       PIC X.
  3215             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  3216             20  FILLER                    PIC XX.
  3217         16  FILLER                        PIC X(80).
  3218
  3219     12  AM-TRANSFER-DATA.
  3220         16  AM-TRANSFERRED-FROM.
  3221             20  AM-TRNFROM-CARRIER        PIC X.
  3222             20  AM-TRNFROM-GROUPING.
  3223                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  3224                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  3225             20  AM-TRNFROM-STATE          PIC XX.
  3226             20  AM-TRNFROM-ACCOUNT.
  3227                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  3228                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  3229             20  AM-TRNFROM-DTE            PIC XX.
  3230         16  AM-TRANSFERRED-TO.
  3231             20  AM-TRNTO-CARRIER          PIC X.
  3232             20  AM-TRNTO-GROUPING.
  3233                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  3234                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  3235             20  AM-TRNTO-STATE            PIC XX.
  3236             20  AM-TRNTO-ACCOUNT.
  3237                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  3238                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  3239             20  AM-TRNTO-DTE              PIC XX.
  3240         16  FILLER                        PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  63
* EL6501.cbl
  3241
  3242     12  AM-SAVED-REMIT-TO                 PIC 99.
  3243
  3244     12  AM-COMM-STRUCTURE-SAVED.
  3245         16  AM-DEFN-1-SAVED.
  3246             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  3247                 24  AM-AGT-SV             PIC X(10).
  3248                 24  AM-COM-TYP-SV         PIC X.
  3249                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  3250                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  3251                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  3252                 24  AM-RECALC-LV-INDIC-SV PIC X.
  3253                 24  FILLER                PIC X.
  3254                 24  AM-GL-CODES-SV        PIC X.
  3255                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  3256                 24  FILLER                PIC X.
  3257         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  3258             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  3259                 24  FILLER                PIC X(11).
  3260                 24  AM-L-COMA-SV          PIC XXX.
  3261                 24  AM-J-COMA-SV          PIC XXX.
  3262                 24  AM-A-COMA-SV          PIC XXX.
  3263                 24  FILLER                PIC X(6).
  3264
  3265     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  3266         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  3267            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  3268            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  3269            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  3270
  3271     12  AM-ORIG-DEALER-NO                 PIC X(10).
  3272     12  FILLER                            PIC X(120).
  3273
  3274     12  AM-ACCOUNT-EXECUTIVE-DATA.
  3275         16  AM-CONTROL-NAME               PIC X(30).
  3276         16  AM-EXECUTIVE-ONE.
  3277             20  AM-EXEC1-NAME             PIC X(15).
  3278             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  3279                                                          COMP-3.
  3280             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  3281                                                          COMP-3.
  3282         16  AM-EXECUTIVE-TWO.
  3283             20  AM-EXEC2-NAME             PIC X(15).
  3284             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  3285                                                          COMP-3.
  3286             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  3287                                                          COMP-3.
  3288
  3289     12  AM-RETRO-ADDITIONAL-DATA.
  3290         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  3291         16  AM-RETRO-PREM-P-E             PIC X.
  3292         16  AM-RETRO-CLMS-P-I             PIC X.
  3293         16  AM-RETRO-RET-BRACKET-LF.
  3294             20  AM-RETRO-RET-METHOD-LF    PIC X.
  3295                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  3296                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  3297             20  AM-RETRO-RET-BASIS-LF     PIC X.
  3298                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  64
* EL6501.cbl
  3299                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  3300             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  3301                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  3302                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  3303         16  AM-RETRO-RET-BRACKET-AH.
  3304             20  AM-RETRO-RET-METHOD-AH    PIC X.
  3305                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  3306                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  3307                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  3308             20  AM-RETRO-RET-BASIS-AH     PIC X.
  3309                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  3310                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  3311             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  3312                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  3313                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  3314
  3315     12  AM-COMMENTS.
  3316         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  3317
  3318     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  3319         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  3320         16  AM-FLI-BILLING-CODE           PIC X.
  3321         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  3322         16  AM-FLI-UNITED-IDENT           PIC X.
  3323         16  AM-FLI-INTEREST-LOST-DATA.
  3324             20  AM-FLI-BANK-NO            PIC X(5).
  3325             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  3326             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  3327             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  3328         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  3329             20  AM-FLI-AGT                PIC X(9).
  3330             20  AM-FLI-AGT-COMM-ACC       PIC X.
  3331             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  3332         16  FILLER                        PIC X(102).
  3333
  3334     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  3335         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  3336             20  AM-BENEFIT-DMD-CODE         PIC XX.
  3337             20  AM-BENEFIT-DMD-TYPE         PIC X.
  3338             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  3339             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  3340             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  3341         16  FILLER                          PIC X(10).
  3342******************************************************************
  3343*    copy ERCPDEF.
  3344******************************************************************
  3345*                                                                *
  3346*                                                                *
  3347*                            ERCPDEF.                            *
  3348*                                                                *
  3349*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  3350*                                                                *
  3351*    FILE TYPE = VSAM,KSDS                                       *
  3352*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  3353*                                                                *
  3354*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  3355*                                                                *
  3356*    LOG = YES                                                   *
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  65
* EL6501.cbl
  3357*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3358******************************************************************
  3359*                   C H A N G E   L O G
  3360*
  3361* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3362*-----------------------------------------------------------------
  3363*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3364* EFFECTIVE    NUMBER
  3365*-----------------------------------------------------------------
  3366* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3367* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  3368******************************************************************
  3369 01  PRODUCT-MASTER.
  3370    12  PD-RECORD-ID                 PIC X(02).
  3371        88  VALID-PD-ID                  VALUE 'PD'.
  3372    12  PD-CONTROL-PRIMARY.
  3373        16  PD-COMPANY-CD            PIC X.
  3374        16  PD-STATE                 PIC XX.
  3375        16  PD-PRODUCT-CD            PIC XXX.
  3376        16  PD-FILLER                PIC X(7).
  3377        16  PD-BEN-TYPE              PIC X.
  3378        16  PD-BEN-CODE              PIC XX.
  3379        16  PD-PROD-EXP-DT           PIC XX.
  3380    12  FILLER                       PIC X(50).
  3381    12  PD-PRODUCT-DATA OCCURS 8.
  3382        16  PD-PROD-CODE             PIC X.
  3383            88  PD-PROD-LIFE           VALUE 'L'.
  3384            88  PD-PROD-PROP           VALUE 'P'.
  3385            88  PD-PROD-AH             VALUE 'A'.
  3386            88  PD-PROD-IU             VALUE 'I'.
  3387            88  PD-PROD-GAP            VALUE 'G'.
  3388            88  PD-PROD-FAML           VALUE 'F'.
  3389        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  3390        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  3391        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  3392        16  PD-MAX-TERM              PIC S999        COMP-3.
  3393        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  3394        16  FILLER                   PIC X.
  3395        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  3396        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  3397        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  3398        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  3399        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  3400        16  PD-REC-CRIT-PERIOD       PIC 99.
  3401        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  3402            20  PD-RECURRING-YN      PIC X.
  3403            20  FILLER               PIC X.
  3404        16  PD-RTW-MOS               PIC 99.
  3405        16  PD-MAX-EXTENSION         PIC 99.
  3406        16  FILLER                   PIC XX.
  3407    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  3408    12  PD-TERM-LIMITS OCCURS 15.
  3409        16  PD-LOW-TERM              PIC S999        COMP-3.
  3410        16  PD-HI-TERM               PIC S999        COMP-3.
  3411*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  3412    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  3413        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  3414        16  PD-HI-AMT                PIC S9(7)       COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  66
* EL6501.cbl
  3415    12  PD-EARN-FACTORS.
  3416        16  FILLER OCCURS 15.
  3417            20  FILLER OCCURS 15.
  3418                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  3419    12  PD-PRODUCT-DESC              PIC X(80).
  3420    12  PD-TRUNCATED                 PIC X.
  3421    12  FILLER                       PIC X(59).
  3422    12  PD-MAINT-INFORMATION.
  3423        16  PD-LAST-MAINT-DT         PIC X(02).
  3424        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  3425        16  PD-LAST-MAINT-BY         PIC X(04).
  3426*    COPY ELCCNTL.
  3427******************************************************************
  3428*                                                                *
  3429*                                                                *
  3430*                            ELCCNTL.                            *
  3431*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3432*                            VMOD=2.059                          *
  3433*                                                                *
  3434*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  3435*                                                                *
  3436*   FILE TYPE = VSAM,KSDS                                        *
  3437*   RECORD SIZE = 750  RECFORM = FIXED                           *
  3438*                                                                *
  3439*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  3440*       ALTERNATE INDEX = NONE                                   *
  3441*                                                                *
  3442*   LOG = YES                                                    *
  3443*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3444******************************************************************
  3445*                   C H A N G E   L O G
  3446*
  3447* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3448*-----------------------------------------------------------------
  3449*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3450* EFFECTIVE    NUMBER
  3451*-----------------------------------------------------------------
  3452* 082503                   PEMA  ADD BENEFIT GROUP
  3453* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3454* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3455* 092705    2005050300006  PEMA  ADD SPP LEASES
  3456* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  3457* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  3458* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  3459* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  3460* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  3461* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  3462* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  3463* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  3464* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  3465* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3466******************************************************************
  3467*
  3468 01  CONTROL-FILE.
  3469     12  CF-RECORD-ID                       PIC XX.
  3470         88  VALID-CF-ID                        VALUE 'CF'.
  3471
  3472     12  CF-CONTROL-PRIMARY.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  67
* EL6501.cbl
  3473         16  CF-COMPANY-ID                  PIC XXX.
  3474         16  CF-RECORD-TYPE                 PIC X.
  3475             88  CF-COMPANY-MASTER              VALUE '1'.
  3476             88  CF-PROCESSOR-MASTER            VALUE '2'.
  3477             88  CF-STATE-MASTER                VALUE '3'.
  3478             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  3479             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  3480             88  CF-CARRIER-MASTER              VALUE '6'.
  3481             88  CF-MORTALITY-MASTER            VALUE '7'.
  3482             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  3483             88  CF-TERMINAL-MASTER             VALUE '9'.
  3484             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  3485             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  3486             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  3487             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  3488             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  3489             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  3490             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  3491             88  CF-REMINDERS-MASTER            VALUE 'R'.
  3492             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  3493         16  CF-ACCESS-CD-GENL              PIC X(4).
  3494         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  3495             20  CF-PROCESSOR               PIC X(4).
  3496         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  3497             20  CF-STATE-CODE              PIC XX.
  3498             20  FILLER                     PIC XX.
  3499         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  3500             20  FILLER                     PIC XX.
  3501             20  CF-HI-BEN-IN-REC           PIC XX.
  3502         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  3503             20  FILLER                     PIC XXX.
  3504             20  CF-CARRIER-CNTL            PIC X.
  3505         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  3506             20  FILLER                     PIC XX.
  3507             20  CF-HI-TYPE-IN-REC          PIC 99.
  3508         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  3509             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  3510                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  3511             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  3512             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  3513         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  3514             20  FILLER                     PIC X.
  3515             20  CF-CUSTOM-REPORT-NO        PIC 999.
  3516         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  3517             20  FILLER                     PIC XX.
  3518             20  CF-MORTGAGE-PLAN           PIC XX.
  3519         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  3520
  3521     12  CF-LAST-MAINT-DT                   PIC XX.
  3522     12  CF-LAST-MAINT-BY                   PIC X(4).
  3523     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  3524
  3525     12  CF-RECORD-BODY                     PIC X(728).
  3526
  3527
  3528****************************************************************
  3529*             COMPANY MASTER RECORD                            *
  3530****************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  68
* EL6501.cbl
  3531
  3532     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3533         16  CF-COMPANY-ADDRESS.
  3534             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  3535             20  CF-CL-IN-CARE-OF           PIC X(30).
  3536             20  CF-CL-ADDR-LINE-1          PIC X(30).
  3537             20  CF-CL-ADDR-LINE-2          PIC X(30).
  3538             20  CF-CL-CITY-STATE           PIC X(30).
  3539             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  3540             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  3541         16  CF-COMPANY-CD                  PIC X.
  3542         16  CF-COMPANY-PASSWORD            PIC X(8).
  3543         16  CF-SECURITY-OPTION             PIC X.
  3544             88  ALL-SECURITY                   VALUE '1'.
  3545             88  COMPANY-VERIFY                 VALUE '2'.
  3546             88  PROCESSOR-VERIFY               VALUE '3'.
  3547             88  NO-SECURITY                    VALUE '4'.
  3548             88  ALL-BUT-TERM                   VALUE '5'.
  3549         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  3550             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  3551         16  CF-LGX-INTERFACE-CNTL          PIC X.
  3552             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  3553         16  CF-INFORCE-LOCATION            PIC X.
  3554             88  CERTS-ARE-ONLINE               VALUE '1'.
  3555             88  CERTS-ARE-OFFLINE              VALUE '2'.
  3556             88  NO-CERTS-AVAILABLE             VALUE '3'.
  3557         16  CF-LOWER-CASE-LETTERS          PIC X.
  3558         16  CF-CERT-ACCESS-CONTROL         PIC X.
  3559             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  3560             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  3561             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  3562             88  CF-ACCNT-CNTL                  VALUE '3'.
  3563             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  3564
  3565         16  CF-FORMS-PRINTER-ID            PIC X(4).
  3566         16  CF-CHECK-PRINTER-ID            PIC X(4).
  3567
  3568         16  CF-LGX-CREDIT-USER             PIC X.
  3569             88  CO-IS-NOT-USER                 VALUE 'N'.
  3570             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  3571
  3572         16 CF-CREDIT-CALC-CODES.
  3573             20  CF-CR-REM-TERM-CALC PIC X.
  3574               88  CR-EARN-AFTER-15TH           VALUE '1'.
  3575               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  3576               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  3577               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  3578               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  3579               88  CR-EARN-AFTER-14TH           VALUE '6'.
  3580               88  CR-EARN-AFTER-16TH           VALUE '7'.
  3581             20  CF-CR-R78-METHOD           PIC X.
  3582               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  3583               88  DONT-USE-PLUS-ONE            VALUE '1'.
  3584
  3585         16  CF-CLAIM-CONTROL-COUNTS.
  3586             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  3587                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  3588
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  69
* EL6501.cbl
  3589             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  3590                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  3591
  3592             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  3593                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  3594
  3595             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  3596                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  3597
  3598         16  CF-CURRENT-MONTH-END           PIC XX.
  3599
  3600         16  CF-CO-CALC-QUOTE-TOLERANCE.
  3601             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  3602             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  3603             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  3604             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  3605                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3606                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3607             20  CF-CO-PREM-REJECT-SW       PIC X.
  3608                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  3609                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  3610             20  CF-CO-REF-REJECT-SW        PIC X.
  3611                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  3612                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  3613
  3614         16  CF-CO-REPORTING-DT             PIC XX.
  3615         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  3616         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  3617           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  3618           88  CF-CO-MONTH-END                  VALUE '1'.
  3619
  3620         16  CF-LGX-CLAIM-USER              PIC X.
  3621             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  3622             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  3623
  3624         16  CF-CREDIT-EDIT-CONTROLS.
  3625             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  3626             20  CF-MIN-AGE                 PIC 99.
  3627             20  CF-DEFAULT-AGE             PIC 99.
  3628             20  CF-MIN-TERM                PIC S999      COMP-3.
  3629             20  CF-MAX-TERM                PIC S999      COMP-3.
  3630             20  CF-DEFAULT-SEX             PIC X.
  3631             20  CF-JOINT-AGE-INPUT         PIC X.
  3632                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  3633             20  CF-BIRTH-DATE-INPUT        PIC X.
  3634                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  3635             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  3636                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  3637                 88  CF-ZERO-CARRIER            VALUE '1'.
  3638                 88  CF-ZERO-GROUPING           VALUE '2'.
  3639                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  3640             20  CF-EDIT-SW                 PIC X.
  3641                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  3642             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  3643             20  CF-CR-PR-METHOD            PIC X.
  3644               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  3645               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  3646             20  FILLER                     PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  70
* EL6501.cbl
  3647
  3648         16  CF-CREDIT-MISC-CONTROLS.
  3649             20  CF-REIN-TABLE-SW           PIC X.
  3650                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  3651             20  CF-COMP-TABLE-SW           PIC X.
  3652                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  3653             20  CF-EXPERIENCE-RETENTION-AGE
  3654                                            PIC S9        COMP-3.
  3655             20  CF-CONVERSION-DT           PIC XX.
  3656             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  3657             20  CF-RUN-FREQUENCY-SW        PIC X.
  3658                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  3659                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  3660
  3661             20  CF-CR-CHECK-NO-CONTROL.
  3662                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  3663                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  3664                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  3665                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  3666                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  3667                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  3668
  3669                 24  CF-CR-CHECK-COUNT       REDEFINES
  3670                     CF-CR-CHECK-COUNTER      PIC X(4).
  3671
  3672                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  3673                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  3674
  3675                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  3676                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  3677                 24  CF-MAIL-PROCESSING       PIC X.
  3678                     88  MAIL-PROCESSING          VALUE 'Y'.
  3679
  3680         16  CF-MISC-SYSTEM-CONTROL.
  3681             20  CF-SYSTEM-C                 PIC X.
  3682                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  3683             20  CF-SYSTEM-D                 PIC X.
  3684                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  3685             20  CF-SOC-SEC-NO-SW            PIC X.
  3686                 88  SOC-SEC-NO-USED             VALUE '1'.
  3687             20  CF-MEMBER-NO-SW             PIC X.
  3688                 88  MEMBER-NO-USED              VALUE '1'.
  3689             20  CF-TAX-ID-NUMBER            PIC X(11).
  3690             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  3691             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  3692                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  3693                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  3694                 88  CF-ALL-APPROVED             VALUE 'Y'.
  3695                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  3696             20  CF-SYSTEM-E                 PIC X.
  3697                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  3698
  3699         16  CF-LGX-LIFE-USER               PIC X.
  3700             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  3701             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  3702
  3703         16  CF-CR-MONTH-END-DT             PIC XX.
  3704
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  71
* EL6501.cbl
  3705         16  CF-FILE-MAINT-DATES.
  3706             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  3707                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  3708             20  CF-LAST-BATCH       REDEFINES
  3709                 CF-LAST-BATCH-NO               PIC X(4).
  3710             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  3711             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  3712             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  3713             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  3714             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  3715             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  3716             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  3717             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  3718             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  3719             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  3720
  3721         16  CF-NEXT-COMPANY-ID             PIC XXX.
  3722         16  FILLER                         PIC X.
  3723
  3724         16  CF-ALT-MORT-CODE               PIC X(4).
  3725         16  CF-MEMBER-CAPTION              PIC X(10).
  3726
  3727         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  3728             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  3729             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  3730             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  3731             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  3732             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  3733
  3734         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  3735
  3736         16  CF-LIFE-OVERRIDE-L1            PIC X.
  3737         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  3738         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  3739         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  3740
  3741         16  CF-AH-OVERRIDE-L1              PIC X.
  3742         16  CF-AH-OVERRIDE-L2              PIC XX.
  3743         16  CF-AH-OVERRIDE-L6              PIC X(6).
  3744         16  CF-AH-OVERRIDE-L12             PIC X(12).
  3745
  3746         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  3747         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  3748
  3749         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  3750         16  CF-AR-LAST-EL860-DT            PIC XX.
  3751         16  CF-MP-MONTH-END-DT             PIC XX.
  3752
  3753         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  3754         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  3755             88  CF-CLAIM-PAID-TO               VALUE '1'.
  3756
  3757         16  CF-AR-MONTH-END-DT             PIC XX.
  3758
  3759         16  CF-CRDTCRD-USER                PIC X.
  3760             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  3761             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  3762
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  72
* EL6501.cbl
  3763         16  CF-CC-MONTH-END-DT             PIC XX.
  3764
  3765         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  3766
  3767         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  3768             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  3769             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  3770             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  3771         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  3772         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  3773         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  3774         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  3775             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  3776             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  3777         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  3778         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  3779         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  3780             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  3781         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  3782
  3783         16  CF-CL-ZIP-CODE.
  3784             20  CF-CL-ZIP-PRIME.
  3785                 24  CF-CL-ZIP-1ST          PIC X.
  3786                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  3787                 24  FILLER                 PIC X(4).
  3788             20  CF-CL-ZIP-PLUS4            PIC X(4).
  3789         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  3790             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  3791             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  3792             20  FILLER                     PIC XXX.
  3793
  3794         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  3795         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  3796         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  3797         16  CF-CO-OPTION-START-DATE        PIC XX.
  3798         16  CF-REM-TRM-CALC-OPTION         PIC X.
  3799           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  3800                                                      '3' '4'.
  3801           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  3802           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  3803           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  3804           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  3805           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  3806           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  3807
  3808         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  3809
  3810         16  CF-PAYMENT-APPROVAL-LEVELS.
  3811             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  3812             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  3813             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  3814             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  3815             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  3816             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  3817
  3818         16  CF-END-USER-REPORTING-USER     PIC X.
  3819             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  3820             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  73
* EL6501.cbl
  3821
  3822         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  3823             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  3824             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  3825
  3826         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  3827
  3828         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  3829         16  FILLER                         PIC X.
  3830
  3831         16  CF-CREDIT-ARCHIVE-CNTL.
  3832             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  3833             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  3834             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  3835
  3836         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  3837
  3838         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  3839             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  3840             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  3841
  3842         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  3843             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  3844             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  3845
  3846         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  3847
  3848         16  CF-CO-ACH-ID-CODE              PIC  X.
  3849             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  3850             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  3851             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  3852         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  3853         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  3854         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  3855         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  3856         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  3857         16  CF-CO-ACH-RECV-NO              PIC X(08).
  3858         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  3859         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  3860         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  3861                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  3862         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  3863                 CF-CO-ACH-TRACE-NO         PIC X(4).
  3864
  3865         16  CF-CO-OVER-SHORT.
  3866             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3867             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3868
  3869*         16  FILLER                         PIC X(102).
  3870         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  3871             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  3872             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  3873
  3874         16  CF-AH-APPROVAL-DAYS.
  3875             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  3876             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  3877             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  3878             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  74
* EL6501.cbl
  3879
  3880         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  3881
  3882         16  CF-APPROV-LEV-5.
  3883             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  3884             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  3885             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  3886
  3887         16  FILLER                         PIC X(68).
  3888****************************************************************
  3889*             PROCESSOR/USER RECORD                            *
  3890****************************************************************
  3891
  3892     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3893         16  CF-PROCESSOR-NAME              PIC X(30).
  3894         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  3895         16  CF-PROCESSOR-TITLE             PIC X(26).
  3896         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  3897                 88  MESSAGE-YES                VALUE 'Y'.
  3898                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  3899
  3900*****************************************************
  3901****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  3902****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  3903****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  3904****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  3905*****************************************************
  3906
  3907         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  3908             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  3909             20  CF-APPLICATION-FORCE       PIC X.
  3910             20  CF-INDIVIDUAL-APP.
  3911                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  3912                     28  CF-BROWSE-APP      PIC X.
  3913                     28  CF-UPDATE-APP      PIC X.
  3914
  3915         16  CF-CURRENT-TERM-ON             PIC X(4).
  3916         16  CF-PROCESSOR-LIMITS-CLAIMS.
  3917             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  3918             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  3919             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  3920             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  3921             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  3922             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  3923             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  3924         16  CF-PROCESSOR-CARRIER           PIC X.
  3925             88  NO-CARRIER-SECURITY            VALUE ' '.
  3926         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  3927             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  3928         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  3929             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  3930         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  3931             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  3932
  3933         16  CF-PROC-SYS-ACCESS-SW.
  3934             20  CF-PROC-CREDIT-CLAIMS-SW.
  3935                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  3936                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  75
* EL6501.cbl
  3937                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  3938                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  3939             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  3940                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  3941                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  3942             20  CF-PROC-LIFE-GNRLDGR-SW.
  3943                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  3944                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  3945                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  3946                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  3947             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  3948                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  3949                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  3950         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  3951             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  3952             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  3953         16  CF-PROCESSOR-PRINTER               PIC X(4).
  3954
  3955         16  CF-APPROVAL-LEVEL                  PIC X.
  3956             88  APPROVAL-LEVEL-1                   VALUE '1'.
  3957             88  APPROVAL-LEVEL-2                   VALUE '2'.
  3958             88  APPROVAL-LEVEL-3                   VALUE '3'.
  3959             88  APPROVAL-LEVEL-4                   VALUE '4'.
  3960             88  APPROVAL-LEVEL-5                   VALUE '5'.
  3961
  3962         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  3963
  3964         16  CF-LANGUAGE-TYPE                   PIC X.
  3965             88  CF-LANG-IS-ENG                     VALUE 'E'.
  3966             88  CF-LANG-IS-FR                      VALUE 'F'.
  3967
  3968         16  CF-CSR-IND                         PIC X.
  3969         16  FILLER                             PIC X(239).
  3970
  3971****************************************************************
  3972*             PROCESSOR/REMINDERS RECORD                       *
  3973****************************************************************
  3974
  3975     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  3976         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  3977             20  CF-START-REMIND-DT         PIC XX.
  3978             20  CF-END-REMIND-DT           PIC XX.
  3979             20  CF-REMINDER-TEXT           PIC X(50).
  3980         16  FILLER                         PIC X(296).
  3981
  3982
  3983****************************************************************
  3984*             STATE MASTER RECORD                              *
  3985****************************************************************
  3986
  3987     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3988         16  CF-STATE-ABBREVIATION          PIC XX.
  3989         16  CF-STATE-NAME                  PIC X(25).
  3990         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  3991         16  CF-ST-CALC-QUOTE-TOLERANCE.
  3992             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  3993             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  3994             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  76
* EL6501.cbl
  3995             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  3996                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3997                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3998             20  CF-ST-PREM-REJECT-SW       PIC X.
  3999                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  4000                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  4001             20  CF-ST-REF-REJECT-SW        PIC X.
  4002                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  4003                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  4004         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  4005         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  4006         16  CF-ST-REFUND-RULES.
  4007             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  4008             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  4009             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  4010         16  CF-ST-FST-PMT-EXTENSION.
  4011             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  4012             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  4013                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  4014                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  4015                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  4016                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  4017         16  CF-ST-STATE-CALL.
  4018             20  CF-ST-CALL-UNEARNED        PIC X.
  4019             20  CF-ST-CALL-RPT-CNTL        PIC X.
  4020             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  4021         16  CF-REPLACEMENT-LAW-SW          PIC X.
  4022             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  4023             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  4024         16  CF-REPLACEMENT-LETTER          PIC X(4).
  4025         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  4026         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  4027         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  4028         16  CF-ST-SPLIT-PAYMENT            PIC X.
  4029         16  FILLER                         PIC X.
  4030         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  4031             20  CF-ST-BENEFIT-CD           PIC XX.
  4032             20  CF-ST-BENEFIT-KIND         PIC X.
  4033                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  4034                 88  CF-ST-AH-KIND              VALUE 'A'.
  4035             20  CF-ST-REM-TERM-CALC        PIC X.
  4036                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  4037                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  4038                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  4039                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  4040                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  4041                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  4042                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  4043                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  4044
  4045             20  CF-ST-REFUND-CALC          PIC X.
  4046                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  4047                 88  ST-REFD-BY-R78             VALUE '1'.
  4048                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  4049                 88  ST-REFD-AS-CALIF           VALUE '3'.
  4050                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  4051                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  4052                 88  ST-REFD-ANTICIPATION       VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  77
* EL6501.cbl
  4053                 88  ST-REFD-UTAH               VALUE '7'.
  4054                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  4055                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  4056                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  4057
  4058             20  CF-ST-EARNING-CALC         PIC X.
  4059                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  4060                 88  ST-EARN-BY-R78             VALUE '1'.
  4061                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  4062                 88  ST-EARN-AS-CALIF           VALUE '3'.
  4063                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  4064                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  4065                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  4066                 88  ST-EARN-MEAN               VALUE '8'.
  4067                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  4068
  4069             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  4070                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  4071                 88  ST-OVRD-BY-R78             VALUE '1'.
  4072                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  4073                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  4074                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  4075                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  4076                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  4077                 88  ST-OVRD-MEAN               VALUE '8'.
  4078                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  4079             20  FILLER                     PIC X.
  4080
  4081         16  CF-ST-COMMISSION-CAPS.
  4082             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  4083             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  4084             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  4085             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  4086         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  4087                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  4088
  4089         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  4090
  4091         16  CF-ST-STATUTORY-INTEREST.
  4092             20  CF-ST-STAT-DATE-FROM       PIC X.
  4093                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  4094                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  4095             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  4096             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  4097             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  4098             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  4099             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  4100
  4101         16  CF-ST-OVER-SHORT.
  4102             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  4103             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  4104
  4105         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  4106
  4107         16  CF-ST-RT-CALC                  PIC X.
  4108
  4109         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  4110         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  78
* EL6501.cbl
  4111         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  4112         16  CF-ST-RF-LR-CALC               PIC X.
  4113         16  CF-ST-RF-LL-CALC               PIC X.
  4114         16  CF-ST-RF-LN-CALC               PIC X.
  4115         16  CF-ST-RF-AH-CALC               PIC X.
  4116         16  CF-ST-RF-CP-CALC               PIC X.
  4117*        16  FILLER                         PIC X(206).
  4118*CIDMOD         16  FILLER                         PIC X(192).
  4119         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  4120             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  4121         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  4122         16  CF-ST-VFY-2ND-BENE             PIC X.
  4123         16  CF-ST-CAUSAL-STATE             PIC X.
  4124         16  FILLER                         PIC X(185).
  4125
  4126****************************************************************
  4127*             BENEFIT MASTER RECORD                            *
  4128****************************************************************
  4129
  4130     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4131         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  4132             20  CF-BENEFIT-CODE            PIC XX.
  4133             20  CF-BENEFIT-NUMERIC  REDEFINES
  4134                 CF-BENEFIT-CODE            PIC XX.
  4135             20  CF-BENEFIT-ALPHA           PIC XXX.
  4136             20  CF-BENEFIT-DESCRIP         PIC X(10).
  4137             20  CF-BENEFIT-COMMENT         PIC X(10).
  4138
  4139             20  CF-LF-COVERAGE-TYPE        PIC X.
  4140                 88  CF-REDUCING                VALUE 'R'.
  4141                 88  CF-LEVEL                   VALUE 'L' 'P'.
  4142
  4143             20  CF-SPECIAL-CALC-CD         PIC X.
  4144                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  4145                 88  CF-NP-0-MO-INT             VALUE 'A'.
  4146                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  4147                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  4148                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  4149                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  4150                 88  CF-FARM-PLAN               VALUE 'F'.
  4151                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  4152                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  4153                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  4154                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  4155                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  4156                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  4157                 88  CF-PRUDENTIAL              VALUE 'P'.
  4158                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  4159                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  4160                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  4161                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  4162                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  4163                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  4164
  4165             20  CF-JOINT-INDICATOR         PIC X.
  4166                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  4167
  4168*            20  FILLER                     PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  79
* EL6501.cbl
  4169             20  cf-maximum-benefits        pic s999 comp-3.
  4170             20  FILLER                     PIC X(09).
  4171             20  CF-BENEFIT-CATEGORY        PIC X.
  4172             20  CF-LOAN-TYPE               PIC X(8).
  4173
  4174             20  CF-CO-REM-TERM-CALC        PIC X.
  4175                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  4176                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  4177                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  4178                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  4179                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  4180
  4181             20  CF-CO-EARNINGS-CALC        PIC X.
  4182                 88  CO-EARN-BY-R78             VALUE '1'.
  4183                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  4184                 88  CO-EARN-AS-CALIF           VALUE '3'.
  4185                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  4186                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  4187                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  4188                 88  CO-EARN-AS-MEAN            VALUE '8'.
  4189                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  4190
  4191             20  CF-CO-REFUND-CALC          PIC X.
  4192                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  4193                 88  CO-REFD-BY-R78             VALUE '1'.
  4194                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  4195                 88  CO-REFD-AS-CALIF           VALUE '3'.
  4196                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  4197                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  4198                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  4199                 88  CO-REFD-MEAN               VALUE '8'.
  4200                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  4201                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  4202                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  4203
  4204             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  4205                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  4206                 88  CO-OVRD-BY-R78             VALUE '1'.
  4207                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  4208                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  4209                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  4210                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  4211                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  4212                 88  CO-OVRD-MEAN               VALUE '8'.
  4213                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  4214
  4215             20  CF-CO-BEN-I-G-CD           PIC X.
  4216                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  4217                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  4218                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  4219
  4220         16  FILLER                         PIC X(304).
  4221
  4222
  4223****************************************************************
  4224*             CARRIER MASTER RECORD                            *
  4225****************************************************************
  4226
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  80
* EL6501.cbl
  4227     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4228         16  CF-ADDRESS-DATA.
  4229             20  CF-MAIL-TO-NAME            PIC X(30).
  4230             20  CF-IN-CARE-OF              PIC X(30).
  4231             20  CF-ADDRESS-LINE-1          PIC X(30).
  4232             20  CF-ADDRESS-LINE-2          PIC X(30).
  4233             20  CF-CITY-STATE              PIC X(30).
  4234             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  4235             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  4236
  4237         16  CF-CLAIM-NO-CONTROL.
  4238             20  CF-CLAIM-NO-METHOD         PIC X.
  4239                 88  CLAIM-NO-MANUAL            VALUE '1'.
  4240                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  4241                 88  CLAIM-NO-SEQ               VALUE '3'.
  4242                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  4243             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  4244                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  4245                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  4246                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  4247
  4248         16  CF-CHECK-NO-CONTROL.
  4249             20  CF-CHECK-NO-METHOD         PIC X.
  4250                 88  CHECK-NO-MANUAL            VALUE '1'.
  4251                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  4252                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  4253                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  4254             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  4255                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  4256
  4257         16  CF-DOMICILE-STATE              PIC XX.
  4258
  4259         16  CF-EXPENSE-CONTROLS.
  4260             20  CF-EXPENSE-METHOD          PIC X.
  4261                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  4262                 88  DOLLARS-PER-PMT            VALUE '2'.
  4263                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  4264                 88  DOLLARS-PER-MONTH          VALUE '4'.
  4265             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  4266             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  4267
  4268         16  CF-CORRESPONDENCE-CONTROL.
  4269             20  CF-LETTER-RESEND-OPT       PIC X.
  4270                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  4271                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  4272             20  FILLER                     PIC X(4).
  4273
  4274         16  CF-RESERVE-CONTROLS.
  4275             20  CF-MANUAL-SW               PIC X.
  4276                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  4277             20  CF-FUTURE-SW               PIC X.
  4278                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  4279             20  CF-PTC-SW                  PIC X.
  4280                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  4281             20  CF-IBNR-SW                 PIC X.
  4282                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  4283             20  CF-PTC-LF-SW               PIC X.
  4284                 88  CF-LF-PTC-USED             VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  81
* EL6501.cbl
  4285             20  CF-CDT-ACCESS-METHOD       PIC X.
  4286                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  4287                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  4288                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  4289             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  4290
  4291         16  CF-CLAIM-CALC-METHOD           PIC X.
  4292             88  360-PLUS-MONTHS                VALUE '1'.
  4293             88  365-PLUS-MONTHS                VALUE '2'.
  4294             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  4295             88  360-DAILY                      VALUE '4'.
  4296             88  365-DAILY                      VALUE '5'.
  4297
  4298         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  4299         16  FILLER                         PIC X(11).
  4300
  4301         16  CF-LIMIT-AMOUNTS.
  4302             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  4303             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  4304             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  4305             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  4306             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  4307             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  4308             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  4309             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  4310             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  4311             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  4312
  4313         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  4314         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  4315         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  4316
  4317         16  CF-ZIP-CODE.
  4318             20  CF-ZIP-PRIME.
  4319                 24  CF-ZIP-1ST             PIC X.
  4320                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4321                 24  FILLER                 PIC X(4).
  4322             20  CF-ZIP-PLUS4               PIC X(4).
  4323         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  4324             20  CF-CAN-POSTAL-1            PIC XXX.
  4325             20  CF-CAN-POSTAL-2            PIC XXX.
  4326             20  FILLER                     PIC XXX.
  4327
  4328         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  4329         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  4330         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  4331
  4332         16  CF-RATING-SWITCH               PIC X.
  4333             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  4334             88  CF-NO-RATING                   VALUE 'N'.
  4335
  4336         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  4337
  4338         16  CF-CARRIER-OVER-SHORT.
  4339             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  4340             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  4341
  4342         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  82
* EL6501.cbl
  4343         16  CF-SECPAY-SWITCH               PIC X.
  4344             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  4345             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  4346         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  4347         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  4348         16  FILLER                         PIC X(444).
  4349*        16  FILLER                         PIC X(452).
  4350
  4351
  4352****************************************************************
  4353*             MORTALITY MASTER RECORD                          *
  4354****************************************************************
  4355
  4356     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4357         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  4358                                INDEXED BY CF-MORT-NDX.
  4359             20  CF-MORT-TABLE              PIC X(5).
  4360             20  CF-MORT-TABLE-TYPE         PIC X.
  4361                 88  CF-MORT-JOINT              VALUE 'J'.
  4362                 88  CF-MORT-SINGLE             VALUE 'S'.
  4363                 88  CF-MORT-COMBINED           VALUE 'C'.
  4364                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  4365                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  4366             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  4367             20  CF-MORT-AGE-METHOD         PIC XX.
  4368                 88  CF-AGE-LAST                VALUE 'AL'.
  4369                 88  CF-AGE-NEAR                VALUE 'AN'.
  4370             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  4371             20  CF-MORT-ADJUSTMENT-DIRECTION
  4372                                            PIC X.
  4373                 88  CF-MINUS                   VALUE '-'.
  4374                 88  CF-PLUS                    VALUE '+'.
  4375             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  4376             20  CF-MORT-JOINT-CODE         PIC X.
  4377                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  4378             20  CF-MORT-PC-Q               PIC X.
  4379                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  4380             20  CF-MORT-TABLE-CODE         PIC X(4).
  4381             20  CF-MORT-COMMENTS           PIC X(15).
  4382             20  FILLER                     PIC X(14).
  4383
  4384         16  FILLER                         PIC X(251).
  4385
  4386
  4387****************************************************************
  4388*             BUSSINESS TYPE MASTER RECORD                     *
  4389****************************************************************
  4390
  4391     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4392* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  4393* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  4394* AND RECORD 05 IS TYPES 81-99
  4395         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  4396             20  CF-BUSINESS-TITLE          PIC  X(19).
  4397             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  4398                                            PIC S9V9(4) COMP-3.
  4399             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  4400             20  FILLER                     PIC  X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  83
* EL6501.cbl
  4401         16  FILLER                         PIC  X(248).
  4402
  4403
  4404****************************************************************
  4405*             TERMINAL MASTER RECORD                           *
  4406****************************************************************
  4407
  4408     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4409
  4410         16  CF-COMPANY-TERMINALS.
  4411             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  4412                                  PIC X(4).
  4413         16  FILLER               PIC X(248).
  4414
  4415
  4416****************************************************************
  4417*             LIFE EDIT MASTER RECORD                          *
  4418****************************************************************
  4419
  4420     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4421         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  4422             20  CF-LIFE-CODE-IN            PIC XX.
  4423             20  CF-LIFE-CODE-OUT           PIC XX.
  4424         16  FILLER                         PIC X(248).
  4425
  4426
  4427****************************************************************
  4428*             AH EDIT MASTER RECORD                            *
  4429****************************************************************
  4430
  4431     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4432         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  4433             20  CF-AH-CODE-IN              PIC XXX.
  4434             20  CF-AH-CODE-OUT             PIC XX.
  4435         16  FILLER                         PIC X(248).
  4436
  4437
  4438****************************************************************
  4439*             CREDIBILITY TABLES                               *
  4440****************************************************************
  4441
  4442     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4443         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  4444                             INDEXED BY CF-CRDB-NDX.
  4445             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  4446             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  4447             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  4448         16  FILLER                         PIC  X(332).
  4449
  4450
  4451****************************************************************
  4452*             REPORT CUSTOMIZATION RECORD                      *
  4453****************************************************************
  4454
  4455     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  4456         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  4457             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  4458             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  84
* EL6501.cbl
  4459             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  4460**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  4461****       A T-TRANSFER.                                   ****
  4462             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  4463
  4464         16  FILLER                         PIC XX.
  4465
  4466         16  CF-CARRIER-CNTL-OPT.
  4467             20  CF-CARRIER-OPT-SEQ         PIC 9.
  4468                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  4469                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  4470             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  4471                                            PIC X.
  4472         16  CF-GROUP-CNTL-OPT.
  4473             20  CF-GROUP-OPT-SEQ           PIC 9.
  4474                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  4475                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  4476             20  CF-GROUP-SELECT OCCURS 3 TIMES
  4477                                            PIC X(6).
  4478         16  CF-STATE-CNTL-OPT.
  4479             20  CF-STATE-OPT-SEQ           PIC 9.
  4480                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  4481                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  4482             20  CF-STATE-SELECT OCCURS 3 TIMES
  4483                                            PIC XX.
  4484         16  CF-ACCOUNT-CNTL-OPT.
  4485             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  4486                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  4487                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  4488             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  4489                                            PIC X(10).
  4490         16  CF-BUS-TYP-CNTL-OPT.
  4491             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  4492                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  4493                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  4494             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  4495                                            PIC XX.
  4496         16  CF-LF-TYP-CNTL-OPT.
  4497             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  4498                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  4499                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  4500             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  4501                                            PIC XX.
  4502         16  CF-AH-TYP-CNTL-OPT.
  4503             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  4504                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  4505                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  4506             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  4507                                            PIC XX.
  4508         16  CF-REPTCD1-CNTL-OPT.
  4509             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  4510                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  4511                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  4512             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  4513                                            PIC X(10).
  4514         16  CF-REPTCD2-CNTL-OPT.
  4515             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  4516                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  85
* EL6501.cbl
  4517                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  4518             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  4519                                            PIC X(10).
  4520         16  CF-USER1-CNTL-OPT.
  4521             20  CF-USER1-OPT-SEQ           PIC 9.
  4522                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  4523                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  4524             20  CF-USER1-SELECT OCCURS 3 TIMES
  4525                                            PIC X(10).
  4526         16  CF-USER2-CNTL-OPT.
  4527             20  CF-USER2-OPT-SEQ           PIC 9.
  4528                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  4529                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  4530             20  CF-USER2-SELECT OCCURS 3 TIMES
  4531                                            PIC X(10).
  4532         16  CF-USER3-CNTL-OPT.
  4533             20  CF-USER3-OPT-SEQ           PIC 9.
  4534                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  4535                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  4536             20  CF-USER3-SELECT OCCURS 3 TIMES
  4537                                            PIC X(10).
  4538         16  CF-USER4-CNTL-OPT.
  4539             20  CF-USER4-OPT-SEQ           PIC 9.
  4540                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  4541                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  4542             20  CF-USER4-SELECT OCCURS 3 TIMES
  4543                                            PIC X(10).
  4544         16  CF-USER5-CNTL-OPT.
  4545             20  CF-USER5-OPT-SEQ           PIC 9.
  4546                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  4547                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  4548             20  CF-USER5-SELECT OCCURS 3 TIMES
  4549                                            PIC X(10).
  4550         16  CF-REINS-CNTL-OPT.
  4551             20  CF-REINS-OPT-SEQ           PIC 9.
  4552                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  4553                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  4554             20  CF-REINS-SELECT OCCURS 3 TIMES.
  4555                 24  CF-REINS-PRIME         PIC XXX.
  4556                 24  CF-REINS-SUB           PIC XXX.
  4557
  4558         16  CF-AGENT-CNTL-OPT.
  4559             20  CF-AGENT-OPT-SEQ           PIC 9.
  4560                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  4561                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  4562             20  CF-AGENT-SELECT OCCURS 3 TIMES
  4563                                            PIC X(10).
  4564
  4565         16  FILLER                         PIC X(43).
  4566
  4567         16  CF-LOSS-RATIO-SELECT.
  4568             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  4569             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  4570         16  CF-ENTRY-DATE-SELECT.
  4571             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  4572             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  4573         16  CF-EFFECTIVE-DATE-SELECT.
  4574             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  86
* EL6501.cbl
  4575             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  4576
  4577         16  CF-EXCEPTION-LIST-IND          PIC X.
  4578             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  4579
  4580         16  FILLER                         PIC X(318).
  4581
  4582****************************************************************
  4583*                  EXCEPTION REPORTING RECORD                  *
  4584****************************************************************
  4585
  4586     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  4587         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  4588             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  4589
  4590         16  CF-COMBINED-LIFE-AH-OPT.
  4591             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  4592             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  4593             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  4594             20  CF-CANCELLATION-RATIO      PIC S9(02).
  4595
  4596         16  CF-LIFE-OPT.
  4597             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4598             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4599             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4600             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4601             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4602             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4603             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4604             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4605             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4606             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  4607
  4608         16  CF-AH-OPT.
  4609             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4610             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4611             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4612             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4613             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4614             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4615             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4616             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4617             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4618             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  4619
  4620         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  4621             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  4622             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  4623             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  4624
  4625         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  4626
  4627         16  FILLER                         PIC X(673).
  4628
  4629
  4630****************************************************************
  4631*             MORTGAGE SYSTEM PLAN RECORD                      *
  4632****************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  87
* EL6501.cbl
  4633
  4634     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  4635         16  CF-PLAN-TYPE                   PIC X.
  4636             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  4637             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  4638             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  4639         16  CF-PLAN-ABBREV                 PIC XXX.
  4640         16  CF-PLAN-DESCRIPT               PIC X(10).
  4641         16  CF-PLAN-NOTES                  PIC X(20).
  4642         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  4643         16  CF-PLAN-UNDERWRITING.
  4644             20  CF-PLAN-TERM-DATA.
  4645                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  4646                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  4647             20  CF-PLAN-AGE-DATA.
  4648                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  4649                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  4650                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  4651             20  CF-PLAN-BENEFIT-DATA.
  4652                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4653                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4654                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  4655                                            PIC S9(7)V99  COMP-3.
  4656         16  CF-PLAN-POLICY-FORMS.
  4657             20  CF-POLICY-FORM             PIC X(12).
  4658             20  CF-MASTER-APPLICATION      PIC X(12).
  4659             20  CF-MASTER-POLICY           PIC X(12).
  4660         16  CF-PLAN-RATING.
  4661             20  CF-RATE-CODE               PIC X(5).
  4662             20  CF-SEX-RATING              PIC X.
  4663                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  4664                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  4665             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  4666             20  CF-SUB-STD-TYPE            PIC X.
  4667                 88  CF-PCT-OF-PREM            VALUE '1'.
  4668                 88  CF-PCT-OF-BENE            VALUE '2'.
  4669         16  CF-PLAN-PREM-TOLERANCES.
  4670             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  4671             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  4672         16  CF-PLAN-PYMT-TOLERANCES.
  4673             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  4674             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  4675         16  CF-PLAN-MISC-DATA.
  4676             20  FILLER                     PIC X.
  4677             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  4678             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  4679         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  4680         16  CF-PLAN-IND-GRP                PIC X.
  4681             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  4682                                                     '1'.
  4683             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  4684                                                     '2'.
  4685         16  CF-MIB-SEARCH-SW               PIC X.
  4686             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  4687             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  4688             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  4689             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  4690         16  CF-ALPHA-SEARCH-SW             PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  88
* EL6501.cbl
  4691             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  4692             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  4693             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  4694             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  4695             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  4696             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  4697             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  4698             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  4699             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  4700             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  4701                                                     'A' 'B' 'C'
  4702                                                     'X' 'Y' 'Z'.
  4703         16  CF-EFF-DT-RULE-SW              PIC X.
  4704             88  CF-EFF-DT-ENTER               VALUE 'E'.
  4705             88  CF-EFF-DT-MONTH               VALUE 'M'.
  4706             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  4707             88  CF-EFF-DT-SEMI                VALUE 'S'.
  4708             88  CF-EFF-DT-ANN                 VALUE 'A'.
  4709         16  FILLER                         PIC X(4).
  4710         16  CF-HEALTH-QUESTIONS            PIC X.
  4711             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  4712         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  4713         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  4714         16  CF-PLAN-SNGL-JNT               PIC X.
  4715             88  CF-COMBINED-PLAN              VALUE 'C'.
  4716             88  CF-JNT-PLAN                   VALUE 'J'.
  4717             88  CF-SNGL-PLAN                  VALUE 'S'.
  4718         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  4719         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  4720         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  4721         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  4722         16  CF-RERATE-CNTL                 PIC  X.
  4723             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  4724             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  4725             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  4726             88  CF-AUTO-RECALC                 VALUE '4'.
  4727         16  CF-BENEFIT-TYPE                PIC  X.
  4728             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  4729             88  CF-BENEFIT-REDUCES             VALUE '2'.
  4730         16  CF-POLICY-FEE                  PIC S999V99
  4731                                                    COMP-3.
  4732         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  4733         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  4734         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  4735         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  4736         16  FILLER                         PIC  X(32).
  4737         16  CF-TERMINATION-FORM            PIC  X(04).
  4738         16  FILLER                         PIC  X(08).
  4739         16  CF-CLAIM-CAP                   PIC S9(7)V99
  4740                                                       COMP-3.
  4741         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  4742         16  CF-ISSUE-LETTER                PIC  X(4).
  4743         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  4744         16  CF-DEPENDENT-COVERAGE          PIC  X.
  4745             88  CF-YES-DEP-COV                 VALUE 'Y'.
  4746             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  4747         16  CF-MP-REFUND-CALC              PIC X.
  4748             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  89
* EL6501.cbl
  4749             88  CF-MP-REFD-BY-R78              VALUE '1'.
  4750             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  4751             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  4752             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  4753             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  4754             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  4755             88  CF-MP-REFD-MEAN                VALUE '8'.
  4756         16  CF-ALT-RATE-CODE               PIC  X(5).
  4757
  4758
  4759         16  FILLER                         PIC X(498).
  4760****************************************************************
  4761*             MORTGAGE COMPANY MASTER RECORD                   *
  4762****************************************************************
  4763
  4764     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4765         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  4766         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  4767             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  4768             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  4769             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  4770             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  4771             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  4772
  4773         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  4774         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  4775         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  4776         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  4777         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  4778
  4779         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  4780             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  4781         16  CF-MP-RECON-USE-IND            PIC X(1).
  4782             88  CF-MP-USE-RECON             VALUE 'Y'.
  4783         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  4784             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  4785         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  4786             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  4787             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  4788         16  FILLER                         PIC X(1).
  4789         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  4790             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  4791         16  CF-MORTG-MIB-VERSION           PIC X.
  4792             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  4793             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  4794             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  4795         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  4796             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  4797                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  4798             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  4799                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  4800             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  4801                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  4802             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  4803                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  4804             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  4805                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  4806             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  90
* EL6501.cbl
  4807                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  4808         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  4809         16  FILLER                         PIC X(7).
  4810         16  CF-MORTG-DESTINATION-SYMBOL.
  4811             20  CF-MORTG-MIB-COMM          PIC X(5).
  4812             20  CF-MORTG-MIB-TERM          PIC X(5).
  4813         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  4814             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  4815         16  FILLER                         PIC X(03).
  4816         16  CF-MP-CHECK-NO-CONTROL.
  4817             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  4818                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  4819                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  4820                                                ' ' LOW-VALUES.
  4821                 88  CF-MP-CHECK-NO-PRE-PRINTED
  4822                                               VALUE '3'.
  4823         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  4824         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  4825         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  4826             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  4827                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  4828             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  4829                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  4830             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  4831                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  4832             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  4833                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  4834             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  4835                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  4836             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  4837                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  4838         16  CF-MORTG-BILLING-AREA.
  4839             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  4840                                            PIC X.
  4841         16  CF-MORTG-MONTH-END-DT          PIC XX.
  4842         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  4843         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  4844         16  CF-MORTG-MIB-DEST-SW           PIC X.
  4845             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  4846             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  4847         16  FILLER                         PIC X.
  4848         16  CF-MORTG-LABEL-CONTROL         PIC X.
  4849             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  4850             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  4851         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  4852         16  FILLER                         PIC X(8).
  4853         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  4854         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  4855         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  4856         16  CF-ACH-COMPANY-ID.
  4857             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  4858                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  4859                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  4860                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  4861             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  4862         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  4863             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  4864         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  91
* EL6501.cbl
  4865             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  4866             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  4867         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  4868         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  4869         16  FILLER                         PIC X(536).
  4870
  4871****************************************************************
  4872*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  4873****************************************************************
  4874
  4875     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  4876         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  4877             20  CF-FEMALE-HEIGHT.
  4878                 24  CF-FEMALE-FT           PIC 99.
  4879                 24  CF-FEMALE-IN           PIC 99.
  4880             20  CF-FEMALE-MIN-WT           PIC 999.
  4881             20  CF-FEMALE-MAX-WT           PIC 999.
  4882         16  FILLER                         PIC X(428).
  4883
  4884     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  4885         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  4886             20  CF-MALE-HEIGHT.
  4887                 24  CF-MALE-FT             PIC 99.
  4888                 24  CF-MALE-IN             PIC 99.
  4889             20  CF-MALE-MIN-WT             PIC 999.
  4890             20  CF-MALE-MAX-WT             PIC 999.
  4891         16  FILLER                         PIC X(428).
  4892******************************************************************
  4893*             AUTOMATIC ACTIVITY RECORD                          *
  4894******************************************************************
  4895     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  4896         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  4897             20  CF-SYS-ACTIVE-SW           PIC X(01).
  4898             20  CF-SYS-LETTER-ID           PIC X(04).
  4899             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  4900             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  4901             20  CF-SYS-RESET-SW            PIC X(01).
  4902             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  4903             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  4904
  4905         16  FILLER                         PIC X(50).
  4906
  4907         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  4908             20  CF-USER-ACTIVE-SW          PIC X(01).
  4909             20  CF-USER-LETTER-ID          PIC X(04).
  4910             20  CF-USER-RESEND-DAYS        PIC 9(03).
  4911             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  4912             20  CF-USER-RESET-SW           PIC X(01).
  4913             20  CF-USER-REPORT-DAYS        PIC 9(03).
  4914             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  4915             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  4916
  4917         16  FILLER                         PIC X(246).
  4918*    COPY ERCREIN.
  4919******************************************************************
  4920*                                                                *
  4921*                            ERCREIN                             *
  4922*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  92
* EL6501.cbl
  4923*                            VMOD=2.010                          *
  4924*                                                                *
  4925*   ONLINE CREDIT SYSTEM                                         *
  4926*                                                                *
  4927*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *
  4928*                                                                *
  4929*   FILE TYPE = VSAM,KSDS                                        *
  4930*   RECORD SIZE = 4000  RECFORM = FIXED                          *
  4931*                                                                *
  4932*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *
  4933*       ALTERNATE PATH = NONE                                    *
  4934*                                                                *
  4935*   LOG = NO                                                     *
  4936*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4937*                                                                *
  4938******************************************************************
  4939*                   C H A N G E   L O G
  4940*
  4941* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4942*-----------------------------------------------------------------
  4943*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4944* EFFECTIVE    NUMBER
  4945*-----------------------------------------------------------------
  4946* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
  4947* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
  4948******************************************************************
  4949 01  REINSURANCE-RECORD.
  4950     12  RE-RECORD-ID                      PIC XX.
  4951         88  VALID-RE-ID                      VALUE 'RE'.
  4952
  4953     12  RE-CONTROL-PRIMARY.
  4954         16  RE-COMPANY-CD                 PIC X.
  4955         16  RE-KEY.
  4956             20  RE-CODE                   PIC X.
  4957                 88  RE-TABLE-RECORD          VALUE 'A'.
  4958                 88  RE-COMPANY-RECORD        VALUE 'B'.
  4959             20  RE-TABLE                  PIC XXX.
  4960             20  FILLER                    PIC XXX.
  4961         16  RE-COMPANY-KEY REDEFINES RE-KEY.
  4962             20  FILLER                    PIC X.
  4963             20  RE-COMPANY.
  4964                 24  RE-COMP-PRIME         PIC XXX.
  4965                 24  RE-COMP-SUB           PIC XXX.
  4966
  4967     12  RE-MAINT-INFORMATION.
  4968         16  RE-LAST-MAINT-DT              PIC XX.
  4969         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  4970         16  RE-LAST-MAINT-USER            PIC X(4).
  4971         16  FILLER                        PIC X(10).
  4972
  4973     12  RE-TABLE-DATA.
  4974         16  RE-100-COMP                   PIC 99.
  4975
  4976         16  RE-COMP-INFO    OCCURS 30 TIMES.
  4977             20  RE-REI-COMP-NO.
  4978                 24  RE-REI-COMP           PIC XXX.
  4979                 24  RE-REI-COMP-SUB       PIC XXX.
  4980             20  RE-LF-QC                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  93
* EL6501.cbl
  4981             20  RE-AH-QC                  PIC X.
  4982             20  RE-LO-DATE                PIC 9(11)     COMP-3.
  4983             20  RE-HI-DATE                PIC 9(11)     COMP-3.
  4984             20  RE-LFAGE-LO               PIC 99.
  4985             20  RE-LFAGE-HI               PIC 99.
  4986             20  RE-AHAGE-LO               PIC 99.
  4987             20  RE-AHAGE-HI               PIC 99.
  4988             20  RE-LFTRM-LO               PIC S999       COMP-3.
  4989             20  RE-LFTRM-HI               PIC S999       COMP-3.
  4990             20  RE-AHTRM-LO               PIC S999       COMP-3.
  4991             20  RE-AHTRM-HI               PIC S999       COMP-3.
  4992             20  RE-LF-PCT                 PIC S9V9999    COMP-3.
  4993             20  RE-AH-PCT                 PIC S9V9999    COMP-3.
  4994             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3.
  4995             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3.
  4996             20  RE-LF-LO                  PIC S9(9)V99   COMP-3.
  4997             20  RE-LF-HI                  PIC S9(9)V99   COMP-3.
  4998             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3.
  4999             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3.
  5000             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3.
  5001             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3.
  5002             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3.
  5003             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3.
  5004             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3.
  5005             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3.
  5006             20  RE-LF-BEN-CODE            PIC X.
  5007             20  RE-AH-BEN-CODE            PIC X.
  5008             20  RE-INTERACTIVE            PIC X.
  5009             20  RE-REMAINING              PIC X.
  5010             20  RE-LF-RUNOFF-SW           PIC X.
  5011             20  RE-AH-RUNOFF-SW           PIC X.
  5012             20  FILLER                    PIC X(19).
  5013
  5014         16  RE-COMP-INFO-END              PIC X(6).
  5015         16  RE-NSP-ST-CD-LF               PIC XX.
  5016         16  RE-NSP-ST-CD-AH               PIC XX.
  5017         16  RE-TABLE-CARRIER-SECURITY     PIC X.
  5018             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.
  5019
  5020         16  FILLER                        PIC X(27).
  5021
  5022     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.
  5023         16  RE-NAME                       PIC X(30).
  5024         16  RE-LF-PE                      PIC X.
  5025         16  RE-AH-PE                      PIC X.
  5026         16  RE-LF-FEE                     PIC S9V9999    COMP-3.
  5027         16  RE-AH-FEE                     PIC S9V9999    COMP-3.
  5028         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3.
  5029         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3.
  5030         16  RE-PRT-ST                     PIC X.
  5031         16  RE-PRT-OW                     PIC X.
  5032         16  RE-MORT-CODE                  PIC X(4).
  5033         16  RE-CLAIM-CODE                 PIC X.
  5034         16  RE-ZERO-LF-FEE                PIC X.
  5035         16  RE-ZERO-AH-FEE                PIC X.
  5036         16  RE-CEDE-NAME                  PIC X(30).
  5037         16  RE-LF-COMM                    PIC X.
  5038         16  RE-AH-COMM                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  94
* EL6501.cbl
  5039         16  RE-LF-TAX                     PIC X.
  5040         16  RE-AH-TAX                     PIC X.
  5041         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.
  5042         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3.
  5043         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3.
  5044
  5045         16  RE-COMP-CARRIER-SECURITY      PIC X.
  5046             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.
  5047
  5048         16  RE-LF-CEDING-FEE-BRACKETS.
  5049             20  RE-LF-FEE-METHOD          PIC X.
  5050                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.
  5051                 88  RE-LF-FEE-METHOD-1          VALUE '1'.
  5052                 88  RE-LF-FEE-METHOD-2          VALUE '2'.
  5053                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.
  5054             20  RE-LF-FEE-BASIS           PIC X.
  5055                 88  RE-LF-GROSS-CEDED             VALUE '1'.
  5056                 88  RE-LF-NET-CEDED               VALUE '2'.
  5057                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.
  5058                 88  RE-LF-NET-WRITTEN             VALUE '4'.
  5059                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.
  5060                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.
  5061                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.
  5062                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.
  5063             20  FILLER                    PIC XXX.
  5064             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.
  5065                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  5066                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  5067
  5068         16  RE-AH-CEDING-FEE-BRACKETS.
  5069             20  RE-AH-FEE-METHOD          PIC X.
  5070                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.
  5071                 88  RE-AH-FEE-METHOD-1          VALUE '1'.
  5072                 88  RE-AH-FEE-METHOD-2          VALUE '2'.
  5073                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.
  5074             20  RE-AH-FEE-BASIS           PIC X.
  5075                 88  RE-AH-GROSS-CEDED             VALUE '1'.
  5076                 88  RE-AH-NET-CEDED               VALUE '2'.
  5077                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.
  5078                 88  RE-AH-NET-WRITTEN             VALUE '4'.
  5079                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.
  5080                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.
  5081                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.
  5082                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.
  5083             20  FILLER                    PIC XXX.
  5084             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.
  5085                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  5086                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  5087
  5088         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.
  5089
  5090         16  RE-OLD-CEDING-STMT            PIC X.
  5091
  5092         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3.
  5093         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3.
  5094         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3.
  5095         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3.
  5096         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  95
* EL6501.cbl
  5097         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3.
  5098         16  RE-REINS-GROUPING-CODE        PIC X(6).
  5099         16  RE-MORT-SW                    PIC X.
  5100         16  RE-CEDING-TYPE-FLAG           PIC X.
  5101             88  RE-NO-CESSION-TYPE                VALUE ' '.
  5102             88  RE-CEDED                          VALUE 'C'.
  5103             88  RE-ASSUMED                        VALUE 'A'.
  5104             88  RE-PHANTOM                        VALUE 'P'.
  5105
  5106         16  RE-CEDING-STMT-OPT-A          PIC X.
  5107             88  REPORT-A-WANTED    VALUE ' ' 'Y'.
  5108         16  RE-CEDING-STMT-OPT-B          PIC X.
  5109             88  REPORT-B-WANTED    VALUE ' ' 'Y'.
  5110         16  RE-CEDING-STMT-OPT-C          PIC X.
  5111             88  REPORT-C-WANTED    VALUE ' ' 'Y'.
  5112         16  RE-CEDING-STMT-OPT-D          PIC X.
  5113             88  REPORT-D-WANTED    VALUE ' ' 'Y'.
  5114         16  RE-CEDING-STMT-OPT-E          PIC X.
  5115             88  REPORT-E-WANTED    VALUE ' ' 'Y'.
  5116
  5117         16  RE-PRT-CRSV                   PIC X.
  5118
  5119         16  RE-GL-CENTER                  PIC X(4).
  5120
  5121         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.
  5122
  5123         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.
  5124
  5125         16  RE-EARN-STOP-CODE             PIC X.
  5126             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.
  5127             88  STOP-AH-EARNING    VALUE 'A' 'B'.
  5128
  5129         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  5130             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  5131
  5132         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  5133         16  FILLER                        PIC X(2281).
  5134
  5135         16  RE-DESC OCCURS 18 TIMES       PIC X(79).
  5136
  5137******************************************************************
  5138*    COPY ERCCTBL.
  5139******************************************************************
  5140*                                                                *
  5141*                                                                *
  5142*                            ERCCTBL                             *
  5143*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5144*                            VMOD=2.003
  5145*                                                                *
  5146*   ONLINE CREDIT SYSTEM                                         *
  5147*                                                                *
  5148*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  5149*                                                                *
  5150*   FILE TYPE = VSAM,KSDS                                        *
  5151*   RECORD SIZE = 200   RECFORM = FIXED                          *
  5152*                                                                *
  5153*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  5154*       ALTERNATE PATH = NONE                                    *
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  96
* EL6501.cbl
  5155*                                                                *
  5156*   LOG = NO                                                     *
  5157*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5158*                                                                *
  5159*                                                                *
  5160******************************************************************
  5161
  5162 01  COMM-TABLE-RECORD.
  5163     12  CT-RECORD-ID                      PIC XX.
  5164         88  VALID-CT-ID                      VALUE 'CT'.
  5165
  5166     12  CT-CONTROL-PRIMARY.
  5167         16  CT-COMPANY-CD                 PIC X.
  5168         16  CT-TABLE                      PIC XXX.
  5169         16  CT-CNTRL-2.
  5170             20  CT-BEN-TYPE               PIC X.
  5171             20  CT-BEN-CODE               PIC XX.
  5172
  5173     12  CT-MAINT-INFORMATION.
  5174         16  CT-LAST-MAINT-DT              PIC XX.
  5175         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  5176         16  CT-LAST-MAINT-USER            PIC X(4).
  5177         16  FILLER                        PIC X(31).
  5178
  5179     12  CT-LIMITS.
  5180         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  5181
  5182         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  5183
  5184         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  5185
  5186     12  CT-RATES.
  5187         16  CT-RTX          OCCURS 27 TIMES.
  5188             20  CT-RT                     PIC SV9(5)     COMP-3.
  5189             20  CT-RT-R   REDEFINES
  5190                 CT-RT                     PIC XXX.
  5191
  5192     12  FILLER                            PIC  X(42).
  5193
  5194******************************************************************
  5195*                                COPY ERCACNT.
  5196******************************************************************
  5197*                                                                *
  5198*                                                                *
  5199*                            ERCACNT.                            *
  5200*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5201*                            VMOD=2.002                          *
  5202*                                                                *
  5203*   FILE DESCRIPTION = NOTE FILE FOR RECORDING OF ACCOUNT NOTES  *
  5204*                                                                *
  5205*   FILE TYPE = VSAM,KSDS                                        *
  5206*   RECORD SIZE = 120   RECFORM = FIXED                          *
  5207*                                                                *
  5208*   BASE CLUSTER NAME = ERACNT             RKP=2,LEN=23          *
  5209*       ALTERNATE INDEX = NONE                                   *
  5210*                                                                *
  5211*                                                                *
  5212*   LOG = YES                                                    *
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  97
* EL6501.cbl
  5213*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5214******************************************************************
  5215*                   C H A N G E   L O G
  5216*
  5217* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5218*-----------------------------------------------------------------
  5219*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5220* EFFECTIVE    NUMBER
  5221*-----------------------------------------------------------------
  5222* 110706  CR2006071700004  PEMA  ADD BRANCH LOCATIONS
  5223*           AND SHIPPING ADDRESS TO ACCOUNT NOTES FILE
  5224******************************************************************
  5225 01  NOTE-FILE.
  5226     12  NT-FILE-ID                  PIC XX.
  5227         88  VALID-NOTE-ID              VALUE 'NT'.
  5228
  5229     12  NT-CONTROL-PRIMARY.
  5230         16  NT-COMPANY-CD           PIC X.
  5231         16  NT-ACCT-NOTE-KEY.
  5232             18  NT-CARRIER              PIC X.
  5233             18  NT-GROUPING             PIC X(06).
  5234             18  NT-STATE                PIC XX.
  5235             18  NT-ACCOUNT              PIC X(10).
  5236         16  NT-RECORD-TYPE          PIC X.
  5237              88  ACCT-NOTE          VALUE '1'.
  5238              88  ACCT-BRANCH-LOC    VALUE '2'.
  5239              88  ACCT-SHIPPING-ADDR VALUE '3'.
  5240         16  NT-LINE-SEQUENCE        PIC S9(4)     COMP.
  5241
  5242     12  NT-LAST-MAINT-DT            PIC XX.
  5243     12  NT-LAST-MAINT-BY            PIC X(4).
  5244     12  NT-LAST-MAINT-HHMMSS        PIC S9(7) COMP-3.
  5245
  5246*  ALL NOTE LINES ARE RECORD TYPE '1' WITH ALMOST UNLIMITED
  5247*     SEQUENCE NUMBERS
  5248     12  NT-NOTE-INFORMATION.
  5249         16  NT-NOTE-LINE            PIC X(60).
  5250         16  FILLER                  PIC X(25).
  5251*  BOTH BRANCH LOCATION LINES ARE RECORD TYPE '2' SEQ 1 AND 2
  5252     12  NT-LOCATION-INFORMATION REDEFINES
  5253                         NT-NOTE-INFORMATION.
  5254         16  NT-BRANCH-LOC-LINE      PIC X(60).
  5255         16  FILLER                  PIC X(25).
  5256*  ALL SHIPPING ADDRESS LINES ARE RECORD TYPE '3'AND
  5257*     SEQUENCE NUMBER 1 IS NAME LINE 1
  5258*     SEQUENCE NUMBER 2 IS NAME LINE 2
  5259*     SEQUENCE NUMBER 3 IS ADDR LINE 1
  5260*     SEQUENCE NUMBER 4 IS ADDR LINE 2
  5261*     SEQUENCE NUMBER 5 IS ADDR LINE 3
  5262*     SEQUENCE NUMBER 6 IS CITY, ST AND ZIP
  5263     12  NT-SHIPPING-INFORMATION REDEFINES
  5264                         NT-NOTE-INFORMATION.
  5265         16  NT-SHIPPING-LINE        PIC X(60).
  5266         16  NT-SHIP-STATE           PIC XX.
  5267         16  NT-SHIP-ZIP             PIC X(10).
  5268         16  FILLER                  PIC X(13).
  5269*****************************************************************
  5270
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  98
* EL6501.cbl
  5271 01  COMMISSION-WORK-AREA.
  5272     05  WK-AGT-COMMS   OCCURS 10 TIMES.
  5273         10  WK-AM-AGT           PIC X(10).
  5274         10  WK-AM-TYPE          PIC X.
  5275         10  WK-FILLER           PIC X(13).
  5276         10  WK-GA-BILL-DT       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  99
* EL6501.cbl
  5278*    COPY ERCCOMP.
  5279******************************************************************
  5280*                                                                *
  5281*                                                                *
  5282*                            ERCCOMP                             *
  5283*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5284*                            VMOD=2.019                          *
  5285*                                                                *
  5286*   ONLINE CREDIT SYSTEM                                         *
  5287*                                                                *
  5288*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  5289*                                                                *
  5290*   FILE TYPE = VSAM,KSDS                                        *
  5291*   RECORD SIZE = 700   RECFORM = FIXED                          *
  5292*                                                                *
  5293*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  5294*       ALTERNATE PATH = NONE                                    *
  5295*                                                                *
  5296*   LOG = NO                                                     *
  5297*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5298*                                                                *
  5299******************************************************************
  5300*                   C H A N G E   L O G
  5301*
  5302* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5303*-----------------------------------------------------------------
  5304*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5305* EFFECTIVE    NUMBER
  5306*-----------------------------------------------------------------
  5307* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  5308* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  5309* 092205    2005050300006  PEMA  ADD LEASE FEE
  5310* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  5311* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  5312* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  5313* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5314* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  5315* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  5316******************************************************************
  5317
  5318 01  COMPENSATION-MASTER.
  5319     12  CO-RECORD-ID                          PIC XX.
  5320         88  VALID-CO-ID                          VALUE 'CO'.
  5321
  5322     12  CO-CONTROL-PRIMARY.
  5323         16  CO-COMPANY-CD                     PIC X.
  5324         16  CO-CONTROL.
  5325             20  CO-CTL-1.
  5326                 24  CO-CARR-GROUP.
  5327                     28  CO-CARRIER            PIC X.
  5328                     28  CO-GROUPING.
  5329                         32  CO-GROUP-PREFIX   PIC XXX.
  5330                         32  CO-GROUP-PRIME    PIC XXX.
  5331                 24  CO-RESP-NO.
  5332                     28  CO-RESP-PREFIX        PIC X(4).
  5333                     28  CO-RESP-PRIME         PIC X(6).
  5334             20  CO-CTL-2.
  5335                 24  CO-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 100
* EL6501.cbl
  5336                     28  CO-ACCT-PREFIX        PIC X(4).
  5337                     28  CO-ACCT-PRIME         PIC X(6).
  5338         16  CO-TYPE                           PIC X.
  5339             88  CO-COMPANY-TYPE                  VALUE 'C'.
  5340             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  5341             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  5342
  5343     12  CO-MAINT-INFORMATION.
  5344         16  CO-LAST-MAINT-DT                  PIC XX.
  5345         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  5346         16  CO-LAST-MAINT-USER                PIC X(4).
  5347     12  FILLER                                PIC XX.
  5348     12  CO-STMT-TYPE                          PIC XXX.
  5349     12  CO-COMP-TYPE                          PIC X.
  5350         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  5351     12  CO-STMT-OWNER                         PIC X(4).
  5352     12  CO-BALANCE-CONTROL                    PIC X.
  5353         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  5354         88  CO-NO-BALANCE                        VALUE 'N'.
  5355
  5356     12  CO-INTERNAL-CONTROL-1                 PIC X.
  5357         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  5358         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  5359         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  5360
  5361     12  CO-INTERNAL-CONTROL-2                 PIC X.
  5362         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  5363         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  5364
  5365     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  5366     12  CO-GA-DIRECT-DEP                      PIC X.
  5367     12  CO-FUTURE-SPACE                       PIC X.
  5368         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  5369
  5370     12  CO-ACCT-NAME                          PIC X(30).
  5371     12  CO-MAIL-NAME                          PIC X(30).
  5372     12  CO-ADDR-1                             PIC X(30).
  5373     12  CO-ADDR-2                             PIC X(30).
  5374     12  CO-ADDR-3.
  5375         16  CO-ADDR-CITY                      PIC X(27).
  5376         16  CO-ADDR-STATE                     PIC XX.
  5377     12  CO-CSO-1099                           PIC X.
  5378     12  CO-ZIP.
  5379         16  CO-ZIP-PRIME.
  5380             20  CO-ZIP-PRI-1ST                PIC X.
  5381                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  5382             20  FILLER                        PIC X(4).
  5383         16  CO-ZIP-PLUS4                      PIC X(4).
  5384     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  5385         16  CO-CAN-POSTAL-1                   PIC XXX.
  5386         16  CO-CAN-POSTAL-2                   PIC XXX.
  5387         16  FILLER                            PIC XXX.
  5388     12  CO-SOC-SEC                            PIC X(13).
  5389     12  CO-TELEPHONE.
  5390         16  CO-AREA-CODE                      PIC XXX.
  5391         16  CO-PREFIX                         PIC XXX.
  5392         16  CO-PHONE                          PIC X(4).
  5393
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 101
* EL6501.cbl
  5394     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  5395
  5396     12  CO-AR-BAL-LEVEL                       PIC X.
  5397         88  CO-AR-REF-LVL                        VALUE '1'.
  5398         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  5399         88  CO-AR-BILL-LVL                       VALUE '2'.
  5400         88  CO-AR-AGT-LVL                        VALUE '3'.
  5401         88  CO-AR-FR-LVL                         VALUE '4'.
  5402
  5403     12  CO-AR-NORMAL-PRINT                    PIC X.
  5404         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  5405         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  5406
  5407     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  5408
  5409     12  CO-AR-REPORTING                       PIC X.
  5410         88  CO-AR-NET-REPORT                     VALUE 'N'.
  5411         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  5412
  5413     12  CO-AR-PULL-CHECK                      PIC X.
  5414         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  5415         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  5416
  5417     12  CO-AR-BALANCE-PRINT                   PIC X.
  5418         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  5419
  5420     12  CO-AR-LAST-RUN-CODE                   PIC X.
  5421         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  5422         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  5423         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  5424
  5425     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  5426
  5427     12  CO-USER-CODE                          PIC X.
  5428     12  CO-REPORT-GROUP-ID                    PIC X(12).
  5429
  5430******************************************************************
  5431*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  5432*    THE LAST MONTH END RUN.
  5433******************************************************************
  5434
  5435     12  CO-LAST-ACTIVITY-DATE.
  5436         16  CO-ACT-YEAR                       PIC 99.
  5437         16  CO-ACT-MONTH                      PIC 99.
  5438         16  CO-ACT-DAY                        PIC 99.
  5439
  5440     12  CO-LAST-STMT-DT.
  5441         16  CO-LAST-STMT-YEAR                 PIC 99.
  5442         16  CO-LAST-STMT-MONTH                PIC 99.
  5443         16  CO-LAST-STMT-DAY                  PIC 99.
  5444
  5445     12  CO-MO-END-TOTALS.
  5446         16  CO-MONTHLY-TOTALS.
  5447             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  5448             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  5449             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  5450             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  5451             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 102
* EL6501.cbl
  5452
  5453         16  CO-AGING-TOTALS.
  5454             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  5455             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  5456             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  5457             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  5458
  5459         16  CO-YTD-TOTALS.
  5460             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  5461             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  5462
  5463         16  CO-OVER-UNDER-TOTALS.
  5464             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  5465             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  5466
  5467     12  CO-MISCELLANEOUS-TOTALS.
  5468         16  CO-FICA-TOTALS.
  5469             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  5470             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  5471
  5472         16  CO-CLAIM-TOTALS.
  5473             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  5474             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  5475
  5476******************************************************************
  5477*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  5478*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  5479******************************************************************
  5480
  5481     12  CO-CURRENT-TOTALS.
  5482         16  CO-CURRENT-LAST-STMT-DT.
  5483             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  5484             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  5485             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  5486
  5487         16  CO-CURRENT-MONTHLY-TOTALS.
  5488             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  5489             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  5490             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  5491             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  5492             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  5493
  5494         16  CO-CURRENT-AGING-TOTALS.
  5495             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  5496             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  5497             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  5498             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  5499
  5500         16  CO-CURRENT-YTD-TOTALS.
  5501             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  5502             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  5503
  5504     12  CO-PAID-COMM-TOTALS.
  5505         16  CO-YTD-PAID-COMMS.
  5506             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  5507             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  5508
  5509     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 103
* EL6501.cbl
  5510         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  5511         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  5512
  5513     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  5514         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  5515         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  5516         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  5517         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  5518         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  5519         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  5520         88  CO-FINAL-LETTER                  VALUE 'F'.
  5521         88  CO-RECONCILING                   VALUE 'R'.
  5522         88  CO-PHONE-CALL                    VALUE 'P'.
  5523         88  CO-LEGAL                         VALUE 'L'.
  5524         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  5525         88  CO-WRITE-OFF                     VALUE 'W'.
  5526         88  CO-NO-ACTION                     VALUE 'N' ' '.
  5527
  5528     12  CO-CSR-CODE                       PIC X(4).
  5529
  5530     12  CO-GA-STATUS-INFO.
  5531         16  CO-GA-EFFECTIVE-DT            PIC XX.
  5532         16  CO-GA-TERMINATION-DT          PIC XX.
  5533         16  CO-GA-STATUS-CODE             PIC X.
  5534             88  CO-GA-ACTIVE                 VALUE 'A'.
  5535             88  CO-GA-INACTIVE               VALUE 'I'.
  5536             88  CO-GA-PENDING                VALUE 'P'.
  5537         16  CO-GA-COMMENTS.
  5538             20  CO-GA-COMMENT-1           PIC X(40).
  5539             20  CO-GA-COMMENT-2           PIC X(40).
  5540             20  CO-GA-COMMENT-3           PIC X(40).
  5541             20  CO-GA-COMMENT-4           PIC X(40).
  5542
  5543     12  CO-RPTCD2                         PIC X(10).
  5544     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  5545         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  5546         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  5547
  5548     12  CO-TYPE-AGENT                     PIC X(01).
  5549         88  CO-CORPORATION                   VALUE 'C'.
  5550         88  CO-PARTNERSHIP                   VALUE 'P'.
  5551         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  5552         88  CO-TRUST                         VALUE 'T'.
  5553         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  5554
  5555     12  CO-FAXNO.
  5556         16  CO-FAX-AREA-CODE                  PIC XXX.
  5557         16  CO-FAX-PREFIX                     PIC XXX.
  5558         16  CO-FAX-PHONE                      PIC X(4).
  5559
  5560     12  CO-BANK-INFORMATION.
  5561         16  CO-BANK-TRANSIT-NO                PIC X(8).
  5562         16  CO-BANK-TRANSIT-NON REDEFINES
  5563             CO-BANK-TRANSIT-NO                PIC 9(8).
  5564
  5565         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  5566     12  CO-MISC-DEDUCT-INFO REDEFINES
  5567                  CO-BANK-INFORMATION.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 104
* EL6501.cbl
  5568         16  CO-MD-GL-ACCT                     PIC X(10).
  5569         16  CO-MD-DIV                         PIC XX.
  5570         16  CO-MD-CENTER                      PIC X(4).
  5571         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  5572         16  CO-CREATE-AP-CHECK                PIC X.
  5573         16  CO-DELIVER-CK-TO-MEL              PIC X.
  5574         16  FILLER                            PIC XXX.
  5575     12  CO-ACH-STATUS                         PIC X.
  5576         88  CO-ACH-ACTIVE                         VALUE 'A'.
  5577         88  CO-ACH-PENDING                        VALUE 'P'.
  5578
  5579     12  CO-BILL-SW                            PIC X.
  5580     12  CO-CONTROL-NAME                       PIC X(30).
  5581     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  5582     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  5583     12  CO-CLP-STATE                          PIC XX.
  5584     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  5585     12  CO-SPP-REFUND-EDIT                    PIC X.
  5586
  5587******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 105
* EL6501.cbl
  5589*    COPY ERCNAME.
  5590******************************************************************
  5591*                                                                *
  5592*                                                                *
  5593*                            ERCNAME                             *
  5594*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5595*                            VMOD=2.003                          *
  5596*                                                                *
  5597*   CREDIT SYSTEM ACCOUNT MASTER NAME, COMPENSATION MASTER       *
  5598*       NAME, REINSURANCE COMPANY NAME LOOKUP FILE.              *
  5599*                                                                *
  5600*   FILE DESCRIPTION = NAME LOOKUP FILE                          *
  5601*                                                                *
  5602*   FILE TYPE = VSAM,KSDS                                        *
  5603*   RECORD SIZE = 160   RECFORM = FIX                            *
  5604*                                                                *
  5605*   BASE CLUSTER NAME = ERNAME                    RKP=2,LEN=61   *
  5606*                                                                *
  5607*   LOG = NO                                                     *
  5608*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5609*                                                                *
  5610*                                                                *
  5611******************************************************************
  5612
  5613 01  NAME-LOOKUP-MASTER.
  5614     12  NL-RECORD-ID                PIC  X(02).
  5615         88  VALID-NL-ID                         VALUE 'NL'.
  5616
  5617     12  NL-RECORD-KEY.
  5618         16  NL-CONTROL-PRIMARY.
  5619             20  NL-COMPANY-CD       PIC  X(01).
  5620             20  NL-NAME             PIC  X(30).
  5621             20  NL-RECORD-TYPE      PIC  X(01).
  5622                 88  NL-ACCOUNT-TYPE             VALUE 'A'.
  5623                 88  NL-COMPENSATION-TYPE        VALUE 'C'.
  5624                 88  NL-REINSURANCE-TYPE         VALUE 'R'.
  5625
  5626         16  NL-ACCOUNT-MASTER.
  5627             20  NL-AM-COMPANY-CD    PIC  X(01).
  5628             20  NL-AM-CARRIER       PIC  X(01).
  5629             20  NL-AM-GROUPING      PIC  X(06).
  5630             20  NL-AM-STATE         PIC  X(02).
  5631             20  NL-AM-ACCOUNT       PIC  X(10).
  5632             20  FILLER              PIC  X(09).
  5633
  5634         16  NL-COMPENSATION-MASTER
  5635                                 REDEFINES  NL-ACCOUNT-MASTER.
  5636             20  NL-CO-COMPANY-CD    PIC  X(01).
  5637             20  NL-CO-CARRIER       PIC  X(01).
  5638             20  NL-CO-GROUPING      PIC  X(06).
  5639             20  NL-CO-RESP-NO       PIC  X(10).
  5640             20  NL-CO-ACCOUNT       PIC  X(10).
  5641             20  NL-CO-TYPE          PIC  X(01).
  5642
  5643         16  NL-REINSURANCE-RECORD
  5644                                 REDEFINES  NL-ACCOUNT-MASTER.
  5645             20  NL-RE-COMPANY-CD    PIC  X(01).
  5646             20  NL-RE-CODE          PIC  X(01).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 106
* EL6501.cbl
  5647             20  NL-RE-COMPANY.
  5648                 24  NL-RE-COMP      PIC  X(03).
  5649                 24  NL-RE-CO-SUB    PIC  X(03).
  5650             20  NL-RE-TABLE         PIC  X(03).
  5651             20  FILLER              PIC  X(18).
  5652
  5653     12  NL-MAINT-INFORMATION.
  5654         16  NL-LAST-MAINT-DT        PIC  X(02).
  5655         16  NL-LAST-MAINT-HHMMSS    PIC S9(07)  COMP-3.
  5656         16  NL-LAST-MAINT-USER      PIC  X(04).
  5657         16  FILLER                  PIC  X(10).
  5658
  5659     12  NL-RE-LEVELS  OCCURS  30  TIMES.
  5660         16  NL-RE-LEVEL             PIC  9(02).
  5661
  5662     12  NL-CITY                     PIC  X(15).
  5663     12  NL-ST                       PIC  XX.
  5664
  5665******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 107
* EL6501.cbl
  5667*    COPY ERCRQST.
  5668******************************************************************
  5669*                                                                *
  5670*                                                                *
  5671*                            ERCRQST.                            *
  5672*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5673*                            VMOD=2.002                          *
  5674*                                                                *
  5675*   FILE DESCRIPTION = ACCOUNTS RECEIVABLE REQUEST RECORD        *
  5676*                                                                *
  5677*   FILE TYPE = VSAM,KSDS                                        *
  5678*   RECORD SIZE = 200  RECFORM = FIXED                           *
  5679*                                                                *
  5680*   BASE CLUSTER = ERRQST                         RKP=2,LEN=7    *
  5681*       ALTERNATE PATH1 = ERRQST2  (BY CO, CAR, GROUP, ST,       *
  5682*                                   ACCOUNT, REF, BATCH)         *
  5683*                                                RKP=9, LEN=38   *
  5684*       ALTERNATE PATH2 = ERRQST3  (BY CO, CAR, GROUP, FIN  RESP *
  5685*                                   ACCOUNT, REF, BATCH)         *
  5686*                                                RKP=47, LEN=46  *
  5687*       ALTERNATE PATH3 = ERRQST4  (BY CO, CAR, GROUP, AGENT,    *
  5688*                                   BATCH)                       *
  5689*                                                RKP=93, LEN=24  *
  5690*       ALTERNATE PATH4 = ERRQST5  (BY CO, SUMMARY CODE, ACCT,   *
  5691*                                   REF, BATCH)                  *
  5692*                                                RKP=117, LEN=35 *
  5693*   LOG = NO                                                     *
  5694*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5695******************************************************************
  5696
  5697 01  AR-REQUEST-RECORD.
  5698     12  RQ-RECORD-ID                     PIC XX.
  5699         88  VALID-RQ-ID                        VALUE 'RQ'.
  5700
  5701     12  RQ-CONTROL-PRIMARY.
  5702         16  RQ-COMPANY-CD                PIC X.
  5703         16  RQ-ENTRY-BATCH               PIC X(6).
  5704
  5705     12  RQ-CONTROL-BY-ACCT-REF.
  5706         16  RQ-COMPANY-CD-A1             PIC X.
  5707         16  RQ-CARRIER-A1                PIC X.
  5708         16  RQ-GROUPING-A1               PIC X(6).
  5709         16  RQ-STATE-A1                  PIC XX.
  5710         16  RQ-ACCOUNT-A1                PIC X(10).
  5711         16  RQ-REFERENCE-A1              PIC X(12).
  5712         16  RQ-BATCH-A1                  PIC X(6).
  5713
  5714     12  RQ-CONTROL-BY-FIN-RESP.
  5715         16  RQ-COMPANY-CD-A2             PIC X.
  5716         16  RQ-CARRIER-A2                PIC X.
  5717         16  RQ-GROUPING-A2               PIC X(6).
  5718         16  RQ-FIN-RESP-A2               PIC X(10).
  5719         16  RQ-ACCT-AGENT-A2             PIC X(10).
  5720         16  RQ-REFERENCE-A2              PIC X(12).
  5721         16  RQ-BATCH-A2                  PIC X(6).
  5722
  5723     12  RQ-CONTROL-BY-ACCT-AGENT.
  5724         16  RQ-COMPANY-CD-A3             PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 108
* EL6501.cbl
  5725         16  RQ-CARRIER-A3                PIC X.
  5726         16  RQ-GROUPING-A3               PIC X(6).
  5727         16  RQ-ACCT-AGENT-A3             PIC X(10).
  5728         16  RQ-BATCH-A3                  PIC X(6).
  5729
  5730     12  RQ-CONTROL-BY-SUMMARY.
  5731         16  RQ-COMPANY-CD-A4             PIC X.
  5732         16  RQ-SUMMARY-CODE              PIC X(6).
  5733         16  RQ-ACCOUNT-A4                PIC X(10).
  5734         16  RQ-REFERENCE-A4              PIC X(12).
  5735         16  RQ-BATCH-A4                  PIC X(6).
  5736
  5737     12  RQ-REQUEST-METHOD                PIC X.
  5738         88 RQ-FIN-RESP-REQUEST               VALUE 'F'.
  5739         88 RQ-ACCT-AGENT-REQUEST             VALUE 'A'.
  5740         88 RQ-SUMMARY-REQUEST                VALUE 'S'.
  5741         88 RQ-BATCH-REQUEST                  VALUE 'B'.
  5742     12  FILLER                           PIC X.
  5743     12  RQ-STATUS                        PIC X.
  5744         88  RQ-REQUEST-ERROR                 VALUE 'E'.
  5745         88  RQ-RESUBMIT                      VALUE 'R'.
  5746     12  RQ-PROCESSOR-ID                  PIC X(4).
  5747     12  RQ-ENTRY-DT                      PIC XX.
  5748     12  RQ-MO-END-DT                     PIC XX.
  5749     12  RQ-REQUEST-DT                    PIC XX.
  5750     12  RQ-STMT-DT                       PIC XX.
  5751     12  RQ-REVERSAL-DT                   PIC XX.
  5752     12  RQ-CREDIT-SELECT-DT              PIC XX.
  5753     12  RQ-CREDIT-ACCEPT-DT              PIC XX.
  5754
  5755     12  FILLER                           PIC X(27).
  5756
  5757******************************************************************
  5758
  5759*EJECT
  5760*    COPY ERCGXRF.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 109
* EL6501.cbl
  5762 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA ACCOUNT-MASTER
  5763                          PRODUCT-MASTER CONTROL-FILE
  5764                          REINSURANCE-RECORD COMM-TABLE-RECORD
  5765                          NOTE-FILE COMMISSION-WORK-AREA
  5766                          COMPENSATION-MASTER
  5767                          NAME-LOOKUP-MASTER AR-REQUEST-RECORD.
  5768 0000-DFHEXIT SECTION.
  5769     MOVE '9#                    $   ' TO DFHEIV0.
  5770     MOVE 'EL6501' TO DFHEIV1.
  5771     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  5772     MOVE EIBTRMID              TO QID-TERM.
  5773
  5774     MOVE EIBDATE               TO DC-JULIAN-YYDDD.
  5775     MOVE '5'                   TO DC-OPTION-CODE.
  5776     PERFORM 9700-DATE-LINK.
  5777     MOVE DC-GREG-DATE-1-EDIT   TO  SAVE-DATE.
  5778     MOVE DC-BIN-DATE-1         TO  SAVE-BIN-DATE.
  5779
  5780***  Y2K PROJ 7744
  5781     MOVE DC-GREG-DATE-1-YMD    TO  CYMD-CURRENT-SAVE
  5782                                    CURRENT-SAVE
  5783     MOVE DC-ALPHA-CENTURY      TO  CYMD-CURRENT-SAVE(1:2)
  5784                                    CURRENT-SAVE(1:2)
  5785***  Y2K PROJ 7744
  5786
  5787     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  5788     IF EIBCALEN = 0
  5789         GO TO 8800-UNAUTHORIZED-ACCESS.
  5790
  5791     MOVE ERGXRF-MAX-LEN         TO ERGXRF-REC-LEN.
  5792     MOVE LOW-VALUES             TO EL6501AI.
  5793
  5794
  5795* EXEC CICS HANDLE CONDITION
  5796*        PGMIDERR  (9600-PGMID-ERROR)
  5797*        ERROR     (9990-ABEND)
  5798*        QIDERR    (0500-CHECK-MAINT-TYPE)
  5799*    END-EXEC.
  5800*    MOVE '"$L.N                 ! " #00005790' TO DFHEIV0
  5801     MOVE X'22244C2E4E20202020202020' TO DFHEIV0(1:12)
  5802     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5803     MOVE X'2220233030303035373930' TO DFHEIV0(25:11)
  5804     CALL 'kxdfhei1' USING DFHEIV0
  5805     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5806
  5807
  5808     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  5809         IF PI-CALLING-PROGRAM = XCTL-650
  5810             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  5811             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  5812             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  5813             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  5814             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  5815             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  5816             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  5817             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  5818             PERFORM 5200-DELETE-TS THRU 5299-EXIT
  5819             GO TO 0500-CHECK-MAINT-TYPE
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 110
* EL6501.cbl
  5820         ELSE
  5821             PERFORM 5200-RECOVER-TS  THRU  5299-EXIT
  5822             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  5823             GO TO 0600-DISPLAY-RECORD.
  5824
  5825     IF EIBAID = DFHCLEAR
  5826         GO TO 9400-CLEAR.
  5827
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 111
* EL6501.cbl
  5829 0200-RECEIVE.
  5830     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  5831         MOVE ER-0008            TO EMI-ERROR
  5832         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5833         MOVE -1                 TO PFENTERL
  5834         GO TO 8200-SEND-DATAONLY.
  5835
  5836
  5837* EXEC CICS RECEIVE
  5838*        MAP      (MAP-NAME)
  5839*        MAPSET   (MAPSET-NAME)
  5840*        INTO     (EL6501AI)
  5841*    END-EXEC.
  5842     MOVE LENGTH OF
  5843      EL6501AI
  5844       TO DFHEIV11
  5845*    MOVE '8"T I  L              ''   #00005824' TO DFHEIV0
  5846     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  5847     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5848     MOVE X'2020233030303035383234' TO DFHEIV0(25:11)
  5849     CALL 'kxdfhei1' USING DFHEIV0,
  5850           MAP-NAME,
  5851           EL6501AI,
  5852           DFHEIV11,
  5853           MAPSET-NAME,
  5854           DFHEIV99,
  5855           DFHEIV99
  5856     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5857
  5858
  5859     IF PFENTERL = 0
  5860         GO TO 0300-CHECK-PFKEYS.
  5861     IF EIBAID NOT = DFHENTER
  5862         MOVE ER-0004            TO EMI-ERROR
  5863         GO TO 0320-INPUT-ERROR.
  5864     IF (PFENTERI NUMERIC) AND (PFENTERI > 0 AND < 25)
  5865         MOVE PF-VALUES (PFENTERI) TO EIBAID
  5866     ELSE
  5867         MOVE ER-0029            TO EMI-ERROR
  5868         GO TO 0320-INPUT-ERROR.
  5869
  5870 0300-CHECK-PFKEYS.
  5871     IF EIBAID = DFHPF23
  5872         GO TO 8810-PF23.
  5873     IF EIBAID = DFHPF24
  5874         GO TO 9200-RETURN-MAIN-MENU.
  5875     IF EIBAID = DFHPF12
  5876         GO TO 9500-PF12.
  5877
  5878* CHECK PF10 KEY FOR A CALL TO EL608 TO BROWSE RESIDENT STATE TAX
  5879*             MASTER(ERRESC)
  5880*
  5881*    IF  EIBAID = DFHPF10
  5882*        IF PI-COMPANY-ID = 'DMD'
  5883*           PERFORM 0700-FORMAT-KEYDATA  THRU 0700-EXIT
  5884*           MOVE LOW-VALUES TO WS-DMD-AGENT
  5885*           PERFORM 6500-READ-ACCT       THRU 6599-EXIT
  5886*           PERFORM 6700-BUILD-COMM-WORK THRU 6799-EXIT
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 112
* EL6501.cbl
  5887*           PERFORM 6000-MOVE-TO-SCREEN  THRU 6099-EXIT
  5888*           MOVE EIBAID       TO PI-ENTRY-CD-1
  5889*           MOVE WS-COMP-DATE TO PI-PREV-VG-ACCOUNT (11:5)
  5890*           MOVE WS-DMD-AGENT TO PI-PREV-VG-ACCOUNT (1:10)
  5891*           MOVE XCTL-608           TO PGM-NAME
  5892*                                      PI-RETURN-TO-PROGRAM
  5893*                                      PI-CALLING-PROGRAM
  5894*           MOVE '106E'             TO PI-CURRENT-SCREEN-NO
  5895*           GO TO 9300-XCTL.
  5896
  5897     IF (EIBAID = DFHPF1  OR  DFHPF2  OR DFHPF3 OR
  5898                  DFHPF4  OR  DFHPF5  OR DFHPF7 OR
  5899                  DFHPF8  OR  DFHPF9 OR DFHPF10)
  5900         IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  5901             MOVE ER-0029        TO  EMI-ERROR
  5902             GO TO 0320-INPUT-ERROR
  5903         ELSE
  5904             GO TO 0800-CHECK-MAINT.
  5905
  5906     IF EIBAID = DFHENTER
  5907         GO TO 0330-EDIT-DATA.
  5908
  5909     MOVE ER-0029                TO EMI-ERROR.
  5910
  5911 0320-INPUT-ERROR.
  5912     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5913     MOVE AL-UNBON               TO PFENTERA.
  5914     MOVE -1                     TO PFENTERL.
  5915     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 113
* EL6501.cbl
  5917 0330-EDIT-DATA.
  5918     IF MAINTI  = 'S'
  5919        PERFORM 0700-FORMAT-KEYDATA  THRU 0700-EXIT
  5920        PERFORM 6500-READ-ACCT       THRU 6599-EXIT
  5921        PERFORM 6700-BUILD-COMM-WORK THRU 6799-EXIT
  5922        PERFORM 6000-MOVE-TO-SCREEN  THRU 6099-EXIT
  5923        MOVE -1                  TO MAINTL
  5924        GO TO 8100-SEND-INITIAL-MAP.
  5925
  5926     PERFORM 8000-STATE-REC-READ   THRU 8010-EXIT.
  5927     PERFORM 6800-COMPANY-REC-READ THRU 6899-EXIT.
  5928
  5929     IF EMI-ERROR NOT = ZEROS
  5930         MOVE -1                 TO MAINTL
  5931         GO TO 8200-SEND-DATAONLY.
  5932
  5933     IF NOT MODIFY-CAP
  5934         MOVE 'UPDATE'           TO SM-READ
  5935         PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  5936         MOVE ER-0070            TO EMI-ERROR
  5937         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5938         GO TO 8100-SEND-INITIAL-MAP.
  5939
  5940     MOVE SAVE-BIN-DATE          TO BIN-CURRENT-SAVE.
  5941
  5942     IF MAINTI = 'A'
  5943        GO TO 1000-ADD-A-RECORD.
  5944
  5945     IF MAINTI = 'C'
  5946        IF PI-SV-MAINT  =  'L'
  5947            MOVE -1             TO MAINTL
  5948            MOVE AL-UABON       TO MAINTA
  5949            MOVE ER-0899        TO EMI-ERROR
  5950            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5951            GO TO 8200-SEND-DATAONLY
  5952        ELSE
  5953            GO TO 2000-CHANGE-A-RECORD.
  5954
  5955     IF MAINTI = 'L'
  5956        MOVE 'L'                TO PI-SV-MAINT
  5957        GO TO 3000-CHANGE-ALL-RECORDS.
  5958
  5959     MOVE ER-0023                TO EMI-ERROR.
  5960     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5961     MOVE -1                     TO MAINTL.
  5962     MOVE AL-UABON               TO MAINTA.
  5963     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 114
* EL6501.cbl
  5965 0500-CHECK-MAINT-TYPE.
  5966     IF PI-MAINT = 'A'
  5967        PERFORM 6700-BUILD-COMM-WORK THRU 6799-EXIT
  5968        PERFORM 0700-FORMAT-KEYDATA THRU 0700-EXIT
  5969        MOVE -1                  TO NAMEL
  5970        GO TO 8100-SEND-INITIAL-MAP.
  5971
  5972 0600-DISPLAY-RECORD.
  5973     PERFORM 0700-FORMAT-KEYDATA  THRU 0700-EXIT.
  5974     PERFORM 6500-READ-ACCT       THRU 6599-EXIT.
  5975     PERFORM 6700-BUILD-COMM-WORK THRU 6799-EXIT.
  5976     PERFORM 6000-MOVE-TO-SCREEN  THRU 6099-EXIT.
  5977
  5978     IF PI-MAINT = 'A'
  5979        MOVE -1                  TO NAMEL
  5980     ELSE
  5981        MOVE -1                  TO MAINTL.
  5982
  5983     GO TO 8100-SEND-INITIAL-MAP.
  5984
  5985 0700-FORMAT-KEYDATA.
  5986     MOVE PI-MAINT               TO MAINTI.
  5987
  5988     IF PI-MAINT = 'A'
  5989        MOVE AL-PANON            TO MAINTA
  5990        SET T-INDEX TO 1
  5991     ELSE
  5992        SET T-INDEX              TO PI-LINE-SELECTED
  5993        MOVE AL-UANON            TO MAINTA.
  5994
  5995     IF PI-2ND-PAGE
  5996         SET T-INDEX UP BY 8
  5997     ELSE
  5998     IF PI-3RD-PAGE
  5999         SET T-INDEX UP BY 16
  6000     ELSE
  6001     IF PI-LST-PAGE
  6002         SET T-INDEX UP BY 24.
  6003
  6004     MOVE PI-ACCT-CARRIER        TO CARRI.
  6005     MOVE PI-ACCT-GROUPING       TO GROUPINI.
  6006     MOVE PI-ACCT-STATE          TO STATEI.
  6007     MOVE PI-ACCT-ACCOUNT        TO ACCOUNTI.
  6008
  6009     IF PI-ACCT-EXP-DT = LOW-VALUES
  6010        MOVE SPACES              TO EXPDTEI
  6011     ELSE
  6012        IF PI-ACCT-EXP-DT NOT = HIGH-VALUES
  6013           MOVE PI-ACCT-EXP-DT      TO DC-BIN-DATE-1
  6014           MOVE SPACE               TO DC-OPTION-CODE
  6015           PERFORM 9700-DATE-LINK
  6016           MOVE DC-GREG-DATE-1-EDIT TO EXPDTEI
  6017        ELSE
  6018           MOVE 999999              TO EXPDTEO
  6019           INSPECT EXPDTEI CONVERTING SPACES TO '/'.
  6020
  6021***DMD CUSTOM CODE *****START
  6022     MOVE EXPDTEI (1:2)             TO WS-YYYYMMDD (5:2).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 115
* EL6501.cbl
  6023     MOVE EXPDTEI (4:2)             TO WS-YYYYMMDD (7:2).
  6024     MOVE EXPDTEI (6:2)             TO WS-YYYYMMDD (3:2).
  6025     IF EXPDTEI (7:1) IS NOT EQUAL TO '9'
  6026        MOVE '20'                 TO WS-YYYYMMDD (1:2)
  6027     ELSE
  6028        MOVE '19'                 TO WS-YYYYMMDD (1:2).
  6029***DMD CUSTOM CODE *****END
  6030
  6031     MOVE PI-BIN-EFF-DT (T-INDEX) TO DC-BIN-DATE-1.
  6032     MOVE SPACE                   TO DC-OPTION-CODE.
  6033     PERFORM 9700-DATE-LINK.
  6034     MOVE DC-GREG-DATE-1-EDIT     TO EFFDTEI.
  6035
  6036 0700-EXIT.
  6037      EXIT.
  6038
  6039 0800-CHECK-MAINT.
  6040     IF PI-MAINT = 'A'
  6041        IF PI-RECORD-NOT-CREATED
  6042           MOVE ER-2071          TO EMI-ERROR
  6043           MOVE  -1              TO NAMEL
  6044           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6045           GO TO 8200-SEND-DATAONLY.
  6046
  6047     IF  EIBAID = DFHPF1
  6048             AND
  6049         CREDIT-SESSION
  6050         PERFORM 5100-WRITE-TS THRU 5199-EXIT
  6051         MOVE PI-ACCT-CARRIER    TO PI-CARRIER
  6052         MOVE PI-ACCT-GROUPING   TO PI-GROUPING
  6053         MOVE PI-ACCT-STATE      TO PI-STATE
  6054         MOVE PI-ACCT-ACCOUNT    TO PI-ACCOUNT
  6055         MOVE PI-ACCT-EXP-DT     TO PI-CERT-EFF-DT
  6056         MOVE LOW-VALUES         TO PI-PROGRAM-WORK-AREA
  6057         MOVE XCTL-689           TO PGM-NAME
  6058         GO TO 9300-XCTL.
  6059
  6060     IF  EIBAID = DFHPF2 AND CREDIT-SESSION
  6061         PERFORM 5100-WRITE-TS THRU 5199-EXIT
  6062         MOVE PI-ACCT-CARRIER    TO PI-CARRIER
  6063         MOVE PI-ACCT-GROUPING   TO PI-GROUPING
  6064         MOVE PI-ACCT-STATE      TO PI-STATE
  6065         MOVE PI-ACCT-ACCOUNT    TO PI-ACCOUNT
  6066         MOVE LOW-VALUES         TO PI-CERT-EFF-DT
  6067         MOVE LOW-VALUES         TO PI-PROGRAM-WORK-AREA
  6068         MOVE XCTL-690           TO PGM-NAME
  6069         GO TO 9300-XCTL
  6070     END-IF.
  6071
  6072     IF EIBAID = DFHPF3
  6073             AND
  6074         CREDIT-SESSION
  6075         PERFORM 5100-WRITE-TS THRU 5199-EXIT
  6076         MOVE PI-ACCT-CARRIER    TO PI-CARRIER
  6077         MOVE PI-ACCT-GROUPING   TO PI-GROUPING
  6078         MOVE PI-ACCT-STATE      TO PI-STATE
  6079         MOVE PI-ACCT-ACCOUNT    TO PI-ACCOUNT
  6080         MOVE LOW-VALUES         TO PI-CERT-EFF-DT
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 116
* EL6501.cbl
  6081         MOVE XCTL-653           TO PGM-NAME
  6082         GO TO 9300-XCTL.
  6083
  6084     IF EIBAID = DFHPF4
  6085         PERFORM 5100-WRITE-TS  THRU  5199-EXIT
  6086         MOVE XCTL-652           TO PGM-NAME
  6087         GO TO 9300-XCTL.
  6088
  6089     IF EIBAID = DFHPF5
  6090         MOVE XCTL-6502          TO PGM-NAME
  6091         GO TO 9300-XCTL.
  6092
  6093     IF EIBAID = DFHPF7
  6094         MOVE XCTL-6504          TO PGM-NAME
  6095         GO TO 9300-XCTL.
  6096
  6097     IF EIBAID = DFHPF8
  6098         MOVE XCTL-6506          TO PGM-NAME
  6099         GO TO 9300-XCTL.
  6100
  6101     IF EIBAID = DFHPF9
  6102        MOVE XCTL-6505           TO PGM-NAME
  6103        GO TO 9300-XCTL.
  6104
  6105     IF EIBAID = DFHPF10
  6106        IF PI-COMPANY-ID = 'DMD'
  6107           PERFORM 5100-WRITE-TS THRU 5199-EXIT
  6108           MOVE XCTL-608         TO PGM-NAME
  6109           GO TO 9300-XCTL.
  6110
  6111     MOVE ER-0029                TO EMI-ERROR.
  6112     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6113     MOVE AL-UNBON               TO PFENTERA.
  6114     MOVE -1                     TO PFENTERL.
  6115     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 117
* EL6501.cbl
  6117 1000-ADD-A-RECORD.
  6118     IF PI-MAINT = 'A'
  6119        PERFORM 4000-EDITS THRU 4900-EXIT
  6120     ELSE
  6121        MOVE ER-2180             TO EMI-ERROR
  6122        MOVE -1                  TO MAINTL
  6123        MOVE AL-UABON            TO MAINTA
  6124        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6125
  6126     IF EMI-FORCABLE-CTR GREATER ZERO  OR
  6127        EMI-FATAL-CTR    GREATER ZERO
  6128         GO TO 8200-SEND-DATAONLY.
  6129
  6130
  6131* EXEC CICS GETMAIN
  6132*         LENGTH   (ACCT-REC-LEN)
  6133*         SET      (ADDRESS OF ACCOUNT-MASTER)
  6134*         INITIMG  (GETMAIN-SPACE)
  6135*    END-EXEC.
  6136*    MOVE ',"IL                  $   #00006101' TO DFHEIV0
  6137     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6138     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6139     MOVE X'2020233030303036313031' TO DFHEIV0(25:11)
  6140     CALL 'kxdfhei1' USING DFHEIV0,
  6141           DFHEIV20,
  6142           ACCT-REC-LEN,
  6143           GETMAIN-SPACE
  6144     SET ADDRESS OF ACCOUNT-MASTER TO
  6145         DFHEIV20
  6146     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6147
  6148
  6149     MOVE ZEROS          TO WSS-LF-LM-AGE (1) WSS-LF-LM-AGE (2)
  6150                            WSS-LF-LM-AGE (3) WSS-LF-LM-AGE (4)
  6151                            WSS-LF-LM-DUR (1) WSS-LF-LM-DUR (2)
  6152                            WSS-LF-LM-DUR (3) WSS-LF-LM-DUR (4)
  6153                            WSS-LF-LM-AMT (1) WSS-LF-LM-AMT (2)
  6154                            WSS-LF-LM-AMT (3) WSS-LF-LM-AMT (4).
  6155
  6156     MOVE ZEROS          TO WSS-AH-LM-AGE (1) WSS-LF-LM-AGE (2)
  6157                            WSS-AH-LM-AGE (3) WSS-LF-LM-AGE (4)
  6158                            WSS-AH-LM-DUR (1) WSS-LF-LM-DUR (2)
  6159                            WSS-AH-LM-DUR (3) WSS-LF-LM-DUR (4)
  6160                            WSS-AH-LM-AMT (1) WSS-LF-LM-AMT (2)
  6161                            WSS-AH-LM-AMT (3) WSS-LF-LM-AMT (4)
  6162                            WSS-AH-LM-MOA (1) WSS-AH-LM-MOA (2)
  6163                            WSS-AH-LM-MOA (3) WSS-AH-LM-MOA (4).
  6164
  6165     MOVE WSS-AGT-COMMS          TO AM-AGT-COMMS (1)
  6166                                    AM-AGT-COMMS (2)
  6167                                    AM-AGT-COMMS (3)
  6168                                    AM-AGT-COMMS (4)
  6169                                    AM-AGT-COMMS (5)
  6170                                    AM-AGT-COMMS (6)
  6171                                    AM-AGT-COMMS (7)
  6172                                    AM-AGT-COMMS (8)
  6173                                    AM-AGT-COMMS (9)
  6174                                    AM-AGT-COMMS (10).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 118
* EL6501.cbl
  6175
  6176     IF PI-COMPANY-ID = 'FLI'
  6177         MOVE ZEROS              TO AM-FLI-BANK-BALANCE
  6178                                    AM-FLI-BANK-1ST-6-PREM
  6179                                    AM-FLI-BANK-CAP-AMT
  6180                                    AM-FLI-AGT-SHARE-PCT (1)
  6181                                    AM-FLI-AGT-SHARE-PCT (2)
  6182                                    AM-FLI-AGT-SHARE-PCT (3)
  6183                                    AM-FLI-AGT-SHARE-PCT (4)
  6184                                    AM-FLI-AGT-SHARE-PCT (5)
  6185                                    AM-FLI-AGT-SHARE-PCT (6)
  6186                                    AM-FLI-AGT-SHARE-PCT (7)
  6187                                    AM-FLI-AGT-SHARE-PCT (8)
  6188                                    AM-FLI-AGT-SHARE-PCT (9)
  6189                                    AM-FLI-AGT-SHARE-PCT (10).
  6190
  6191     MOVE ZEROS                  TO AM-GPCD
  6192                                    AM-LF-RET
  6193                                    AM-AH-RET
  6194                                    AM-LF-OB-RATE
  6195                                    AM-LF-OB-RATE-JNT
  6196                                    AM-AH-OB-RATE
  6197                                    AM-AH-OB-RATE-JNT
  6198                                    AM-REI-FEE-LF
  6199                                    AM-REI-FEE-AH
  6200                                    AM-REI-LF-TAX
  6201                                    AM-REI-PR-PCT
  6202                                    AM-REI-78-PCT
  6203                                    AM-REI-AH-TAX
  6204                                    AM-TOL-PREM
  6205                                    AM-TOL-REF
  6206                                    AM-CLP-TOL-PCT
  6207                                    AM-TOL-CLM
  6208                                    AM-CERTS-PURGED-DATE
  6209                                    AM-HI-CERT-DATE
  6210                                    AM-LO-CERT-DATE
  6211                                    AM-1ST-PROD-DATE
  6212                                    AM-GPCD
  6213                                    AM-CAL-TABLE
  6214                                    AM-LF-DEVIATION
  6215                                    AM-LF-DEVIATION-PCT
  6216                                    AM-AH-DEVIATION
  6217                                    AM-AH-DEVIATION-PCT
  6218                                    AM-ANNIVERSARY-DATE
  6219                                    AM-TEL-NO
  6220                                    AM-ENTRY-DATE
  6221                                    AM-INACTIVE-DATE
  6222                                    AM-RET-MIN-LOSS-L
  6223                                    AM-RET-MIN-LOSS-A
  6224                                    AM-LF-RPT021-EXP-PCT
  6225                                    AM-AH-RPT021-EXP-PCT
  6226                                    AM-MAX-MON-BEN
  6227                                    AM-MAX-TOT-BEN
  6228                                    AM-DCC-MAX-MARKETING-FEE
  6229                                    AM-SPP-LEASE-COMM
  6230                                    AM-RETRO-QUALIFY-LIMIT
  6231                                    AM-RETRO-RET-PCT-LF (1)
  6232                                    AM-RETRO-RET-PCT-LF (2)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 119
* EL6501.cbl
  6233                                    AM-RETRO-RET-PCT-LF (3)
  6234                                    AM-RETRO-RET-THRU-LF (1)
  6235                                    AM-RETRO-RET-THRU-LF (2)
  6236                                    AM-RETRO-RET-THRU-LF (3)
  6237                                    AM-RETRO-RET-PCT-AH (1)
  6238                                    AM-RETRO-RET-PCT-AH (2)
  6239                                    AM-RETRO-RET-PCT-AH (3)
  6240                                    AM-RETRO-RET-THRU-AH (1)
  6241                                    AM-RETRO-RET-THRU-AH (2)
  6242                                    AM-RETRO-RET-THRU-AH (3).
  6243
  6244     IF PI-COMPANY-ID = 'DCC'
  6245        MOVE +100                TO AM-DCC-MAX-MARKETING-FEE
  6246     END-IF
  6247     MOVE LOW-VALUES             TO PI-ACCT-REST-OF-EXP
  6248                                    AM-AR-HI-CERT-DATE.
  6249
  6250     MOVE 'AM'                   TO AM-RECORD-ID.
  6251     MOVE PI-ACCT-KEY            TO AM-CONTROL-PRIMARY
  6252                                    AM-CONTROL-BY-VAR-GRP.
  6253
  6254     IF ST-ACCNT-CNTL
  6255        MOVE SPACES              TO AM-VG-CARRIER
  6256                                    AM-VG-GROUPING.
  6257     IF CARR-ST-ACCNT-CNTL
  6258        MOVE SPACES              TO AM-VG-GROUPING.
  6259
  6260     IF ACCNT-CNTL
  6261        MOVE SPACES              TO AM-VG-CARRIER
  6262                                    AM-VG-STATE
  6263                                    AM-VG-GROUPING.
  6264
  6265     IF CARR-ACCNT-CNTL
  6266        MOVE SPACES              TO AM-VG-STATE
  6267                                    AM-VG-GROUPING.
  6268
  6269     MOVE CURRENT-SAVE           TO AM-ENTRY-DATE.
  6270     MOVE BIN-EXPCHG-SAVE        TO AM-VG-EXPIRATION-DT.
  6271     MOVE PI-BIN-EFF-DT (1)      TO AM-EFFECTIVE-DT.
  6272
  6273     MOVE BIN-CURRENT-SAVE       TO AM-LAST-MAINT-DT.
  6274     MOVE PI-PROCESSOR-ID        TO AM-LAST-MAINT-USER.
  6275     MOVE EIBTIME                TO AM-LAST-MAINT-HHMMSS.
  6276
  6277     PERFORM 5000-MOVE-TO-RECORD THRU 5000-EXIT.
  6278
  6279     IF PI-COMPANY-ID = 'NCL'
  6280         MOVE 'N'                TO AM-AH-ONLY-INDICATOR.
  6281
  6282     IF EMI-FORCABLE-CTR GREATER ZERO  OR
  6283        EMI-FATAL-CTR    GREATER ZERO
  6284         GO TO 8200-SEND-DATAONLY.
  6285
  6286     IF PI-COMPANY-ID = 'DCC'
  6287        IF CLPSTL <= ZEROS
  6288           MOVE ER-0144          TO  EMI-ERROR
  6289           MOVE -1               TO  CLPSTL
  6290           MOVE AL-UABON         TO  CLPSTA
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 120
* EL6501.cbl
  6291           PERFORM 9900-ERROR-FORMAT
  6292                                 THRU  9900-EXIT
  6293           GO TO 8200-SEND-DATAONLY
  6294        END-IF
  6295     END-IF
  6296     MOVE AM-COMM-STRUCTURE      TO AM-COMM-STRUCTURE-SAVED.
  6297     MOVE SPACE                  TO AM-COMM-CHANGE-STATUS.
  6298
  6299     MOVE +1 TO AXRF-SUB
  6300                COMM-WORK-SUB.
  6301
  6302     PERFORM 6700-BUILD-COMM-WORK     THRU 6799-EXIT.
  6303     PERFORM 6900-READ-AND-CHECK-AXRF THRU 6999-EXIT.
  6304
  6305     PERFORM 2100-ADD-ACCOUNT-NAME THRU 2100-EXIT.
  6306
  6307     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  6308         NEXT SENTENCE
  6309     ELSE
  6310         PERFORM 1500-ADD-COMP     THRU 1500-EXIT.
  6311
  6312
  6313* EXEC CICS WRITE
  6314*        FROM      (ACCOUNT-MASTER)
  6315*        RIDFLD    (AM-CONTROL-PRIMARY)
  6316*        DATASET   (ACCT-FILE-ID)
  6317*    END-EXEC.
  6318     MOVE LENGTH OF
  6319      ACCOUNT-MASTER
  6320       TO DFHEIV11
  6321*    MOVE '&$ L                  ''   #00006270' TO DFHEIV0
  6322     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6323     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6324     MOVE X'2020233030303036323730' TO DFHEIV0(25:11)
  6325     CALL 'kxdfhei1' USING DFHEIV0,
  6326           ACCT-FILE-ID,
  6327           ACCOUNT-MASTER,
  6328           DFHEIV11,
  6329           AM-CONTROL-PRIMARY,
  6330           DFHEIV99,
  6331           DFHEIV99
  6332     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6333
  6334
  6335     PERFORM 6600-UPDATE-MAINT-DT THRU 6699-EXIT.
  6336
  6337     MOVE PI-MAINT               TO PI-SV-MAINT.
  6338     MOVE 'C'                    TO PI-MAINT.
  6339     MOVE LOW-VALUES             TO EL6501AI.
  6340
  6341     PERFORM 0700-FORMAT-KEYDATA THRU 0700-EXIT.
  6342     PERFORM 6500-READ-ACCT      THRU 6599-EXIT.
  6343     PERFORM 6000-MOVE-TO-SCREEN THRU 6099-EXIT.
  6344
  6345     IF PI-COMPANY-ID = 'NCL'
  6346         MOVE ER-4011            TO EMI-ERROR
  6347      ELSE
  6348         MOVE ER-0000            TO EMI-ERROR.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 121
* EL6501.cbl
  6349
  6350     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6351
  6352     MOVE -1                     TO MAINTL.
  6353     MOVE AL-UANON               TO MAINTA.
  6354     MOVE '1'                    TO PI-RECORD-ADDED-SW.
  6355     GO TO 8100-SEND-INITIAL-MAP.
  6356
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 122
* EL6501.cbl
  6358 1500-ADD-COMP.
  6359
  6360* EXEC CICS GETMAIN
  6361*         LENGTH   (COMP-REC-LEN)
  6362*         SET      (ADDRESS OF COMPENSATION-MASTER)
  6363*         INITIMG  (GETMAIN-SPACE)
  6364*    END-EXEC.
  6365*    MOVE ',"IL                  $   #00006300' TO DFHEIV0
  6366     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6367     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6368     MOVE X'2020233030303036333030' TO DFHEIV0(25:11)
  6369     CALL 'kxdfhei1' USING DFHEIV0,
  6370           DFHEIV20,
  6371           COMP-REC-LEN,
  6372           GETMAIN-SPACE
  6373     SET ADDRESS OF COMPENSATION-MASTER TO
  6374         DFHEIV20
  6375     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6376
  6377
  6378     MOVE SPACES                 TO COMPENSATION-MASTER.
  6379     MOVE ZEROS TO CO-BAL-FWD      CO-CUR-COM   CO-CUR-CHG
  6380                   CO-CUR-PMT      CO-END-BAL   CO-CUR
  6381                   CO-OV30         CO-OV60      CO-OV90
  6382                   CO-YTD-COM      CO-YTD-OV    CO-CUR-OVR-UNDR
  6383                   CO-YTD-OVR-UNDR CO-CUR-FICA CO-YTD-FICA
  6384                   CO-LF-CLM-AMT   CO-AH-CLM-AMT
  6385                   CO-CURRENT-BAL-FWD CO-CURRENT-CUR-COM
  6386                   CO-CURRENT-CUR-CHG CO-CURRENT-END-BAL
  6387                   CO-CURRENT-CUR     CO-CURRENT-OV30
  6388                   CO-CURRENT-OV60    CO-CURRENT-OV90
  6389                   CO-CURRENT-CUR-PMT
  6390                   CO-CURRENT-YTD-COM CO-CURRENT-YTD-OV
  6391                   CO-ACT-YEAR        CO-ACT-MONTH
  6392                   CO-ACT-DAY         CO-LAST-STMT-YEAR
  6393                   CO-LAST-STMT-MONTH CO-LAST-STMT-DAY
  6394                   CO-CURRENT-LAST-STMT-YEAR
  6395                   CO-CURRENT-LAST-STMT-MONTH
  6396                   CO-CURRENT-LAST-STMT-DAY
  6397                   CO-YTD-PAID-COM
  6398                   CO-YTD-PAID-OV
  6399                   co-ov120 co-current-ov120
  6400
  6401     MOVE BIN-CURRENT-SAVE       TO CO-LAST-MAINT-DT.
  6402     MOVE PI-PROCESSOR-ID        TO CO-LAST-MAINT-USER.
  6403     MOVE EIBTIME                TO CO-LAST-MAINT-HHMMSS.
  6404     MOVE PI-CR-MONTH-END-DT     TO CO-ROLADEX-PRINT-DT.
  6405     MOVE PI-COMPANY-CD          TO CO-COMPANY-CD.
  6406
  6407     IF PI-ZERO-CARRIER OR PI-ZERO-CAR-GROUP
  6408         MOVE ZEROS              TO CO-CARRIER
  6409     ELSE
  6410         MOVE AM-CARRIER         TO CO-CARRIER.
  6411
  6412     IF PI-ZERO-GROUPING OR PI-ZERO-CAR-GROUP
  6413         MOVE ZEROS              TO CO-GROUPING
  6414     ELSE
  6415         MOVE AM-GROUPING        TO CO-GROUPING.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 123
* EL6501.cbl
  6416
  6417     MOVE 'CO'                   TO CO-RECORD-ID
  6418     MOVE 'A'                    TO CO-TYPE.
  6419     MOVE AM-NAME                TO CO-ACCT-NAME.
  6420     MOVE AM-PERSON              TO CO-MAIL-NAME.
  6421     MOVE AM-ADDRS               TO CO-ADDR-1.
  6422*    MOVE AM-CITY                TO CO-ADDR-3.
  6423     MOVE AM-ADDR-CITY           TO CO-ADDR-CITY
  6424     MOVE AM-ADDR-STATE          TO CO-ADDR-STATE
  6425     MOVE AM-ZIP                 TO CO-ZIP.
  6426     MOVE AM-CSR-CODE            TO CO-CSR-CODE.
  6427     MOVE AM-TEL-NO              TO CO-TELEPHONE.
  6428
  6429     IF PI-COMPANY-ID = 'NCL'
  6430         MOVE AM-ID-NO           TO  WS-SOC-SEC-WORK
  6431         IF WS-SS-TYPE = 'C' OR 'P' OR 'S' OR 'T' OR
  6432                         'X' OR 'I'
  6433             MOVE WS-SS-TYPE     TO  CO-TYPE-AGENT
  6434             MOVE WS-SOC-SEC     TO  CO-SOC-SEC
  6435         ELSE
  6436             MOVE SPACE          TO  CO-TYPE-AGENT
  6437             MOVE AM-ID-NO       TO  CO-SOC-SEC
  6438     ELSE
  6439         MOVE AM-ID-NO           TO CO-SOC-SEC.
  6440
  6441     IF AM-REMIT-TO NOT = ZERO
  6442         MOVE AM-AGT (AM-REMIT-TO) TO CO-RESP-NO
  6443       ELSE
  6444         MOVE AM-ACCOUNT           TO CO-RESP-NO.
  6445
  6446     MOVE +0                      TO AGT-SUB.
  6447
  6448     PERFORM 1600-FIND-C-AGT THRU 1600-EXIT.
  6449
  6450     IF VALID-AGT-SW = 'Y'
  6451         NEXT SENTENCE
  6452     ELSE
  6453         GO TO 1500-EXIT.
  6454
  6455     IF CO-RESP-NO = CO-ACCOUNT
  6456         MOVE 'Y'                  TO CO-BALANCE-CONTROL
  6457     ELSE
  6458         MOVE 'N'                  TO CO-BALANCE-CONTROL.
  6459
  6460     IF PI-AR-PROCESSING
  6461        MOVE 'G'                   TO CO-AR-REPORTING
  6462        MOVE '1'                   TO CO-AR-BAL-LEVEL
  6463        MOVE 'Y'                   TO CO-AR-PULL-CHECK
  6464        MOVE 'Y'                   TO CO-AR-NORMAL-PRINT.
  6465
  6466     IF PI-COMPANY-ID = 'CRI' OR 'HER' OR 'HSL'
  6467        MOVE 'N'                   TO CO-AR-REPORTING.
  6468
  6469     IF PI-COMPANY-ID = 'HER' OR 'HSL'
  6470        MOVE '999999'              TO CO-AR-SUMMARY-CODE.
  6471
  6472     PERFORM 2200-ADD-COMPENSATION-NAME THRU 2200-EXIT.
  6473
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 124
* EL6501.cbl
  6474
  6475* EXEC CICS HANDLE CONDITION
  6476*         DUPREC   (1500-EXIT)
  6477*    END-EXEC.
  6478*    MOVE '"$%                   ! # #00006402' TO DFHEIV0
  6479     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
  6480     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6481     MOVE X'2320233030303036343032' TO DFHEIV0(25:11)
  6482     CALL 'kxdfhei1' USING DFHEIV0
  6483     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6484
  6485
  6486
  6487* EXEC CICS WRITE
  6488*        FROM      (COMPENSATION-MASTER)
  6489*        RIDFLD    (CO-CONTROL-PRIMARY)
  6490*        DATASET   (COMP-FILE-ID)
  6491*    END-EXEC.
  6492     MOVE LENGTH OF
  6493      COMPENSATION-MASTER
  6494       TO DFHEIV11
  6495*    MOVE '&$ L                  ''   #00006406' TO DFHEIV0
  6496     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6497     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6498     MOVE X'2020233030303036343036' TO DFHEIV0(25:11)
  6499     CALL 'kxdfhei1' USING DFHEIV0,
  6500           COMP-FILE-ID,
  6501           COMPENSATION-MASTER,
  6502           DFHEIV11,
  6503           CO-CONTROL-PRIMARY,
  6504           DFHEIV99,
  6505           DFHEIV99
  6506     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6507
  6508
  6509 1500-EXIT.
  6510      EXIT.
  6511
  6512 1600-FIND-C-AGT.
  6513     ADD 1 TO  AGT-SUB.
  6514     IF AGT-SUB GREATER 10
  6515         MOVE 'N'                TO  VALID-AGT-SW
  6516         GO TO 1600-EXIT.
  6517
  6518************************************************************
  6519**  MODIFICATION MADE TO ADD SERVICE FEES                 **
  6520************************************************************
  6521
  6522     IF AM-COM-TYP (AGT-SUB) = 'C' OR 'D' OR 'F'
  6523         MOVE AM-AGT (AGT-SUB)   TO  CO-ACCOUNT
  6524         MOVE 'Y'                TO  VALID-AGT-SW
  6525         GO TO 1600-EXIT
  6526     ELSE
  6527         GO TO 1600-FIND-C-AGT.
  6528
  6529 1600-EXIT.
  6530     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 125
* EL6501.cbl
  6532 1700-CHANGE-COMP.
  6533     MOVE 'N'                    TO CHANGE-WAS-MADE-SW.
  6534     MOVE PI-COMPANY-CD          TO COMP-COMPANY-CD.
  6535
  6536     IF PI-ZERO-CARRIER
  6537       OR PI-ZERO-CAR-GROUP
  6538         MOVE ZEROS              TO COMP-CARRIER
  6539     ELSE
  6540         MOVE AM-CARRIER         TO COMP-CARRIER.
  6541
  6542     IF PI-ZERO-GROUPING
  6543       OR PI-ZERO-CAR-GROUP
  6544         MOVE ZEROS              TO COMP-GROUPING
  6545     ELSE
  6546         MOVE AM-GROUPING        TO COMP-GROUPING.
  6547
  6548     IF AM-REMIT-TO NOT = ZERO
  6549         MOVE AM-AGT (AM-REMIT-TO)
  6550                                 TO COMP-RESP-NO
  6551     ELSE
  6552         MOVE AM-ACCOUNT         TO COMP-RESP-NO.
  6553
  6554     MOVE ZERO                   TO AGT-SUB.
  6555
  6556     PERFORM 1800-FIND-C-AGT THRU 1899-EXIT.
  6557
  6558     IF VALID-AGT-SW = 'Y'
  6559         NEXT SENTENCE
  6560     ELSE
  6561         GO TO 1799-EXIT.
  6562
  6563     MOVE 'A'                    TO COMP-TYPE.
  6564
  6565
  6566* EXEC CICS HANDLE CONDITION
  6567*         ENDFILE     (1799-EXIT)
  6568*         NOTFND      (1799-EXIT)
  6569*    END-EXEC.
  6570*    MOVE '"$''I                  ! $ #00006468' TO DFHEIV0
  6571     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  6572     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6573     MOVE X'2420233030303036343638' TO DFHEIV0(25:11)
  6574     CALL 'kxdfhei1' USING DFHEIV0
  6575     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6576
  6577
  6578
  6579* EXEC CICS READ
  6580*        UPDATE
  6581*        DATASET   (COMP-FILE-ID)
  6582*        SET       (ADDRESS OF COMPENSATION-MASTER)
  6583*        RIDFLD    (COMP-KEY)
  6584*    END-EXEC.
  6585*    MOVE '&"S        EU         (   #00006473' TO DFHEIV0
  6586     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6587     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  6588     MOVE X'2020233030303036343733' TO DFHEIV0(25:11)
  6589     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 126
* EL6501.cbl
  6590           COMP-FILE-ID,
  6591           DFHEIV20,
  6592           DFHEIV99,
  6593           COMP-KEY,
  6594           DFHEIV99,
  6595           DFHEIV99,
  6596           DFHEIV99
  6597     SET ADDRESS OF COMPENSATION-MASTER TO
  6598         DFHEIV20
  6599     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6600
  6601
  6602     IF (ON-LAST-DATE-RANGE)
  6603        IF NAMEL GREATER ZEROS
  6604           MOVE 'Y'              TO CHANGE-WAS-MADE-SW
  6605           MOVE AM-NAME          TO CO-ACCT-NAME
  6606        END-IF
  6607        IF INCAREL GREATER ZEROS
  6608           MOVE 'Y'              TO CHANGE-WAS-MADE-SW
  6609           MOVE AM-PERSON        TO CO-MAIL-NAME
  6610        END-IF
  6611        IF ADDR1L GREATER ZEROS
  6612           MOVE 'Y'              TO CHANGE-WAS-MADE-SW
  6613           MOVE AM-ADDRS         TO CO-ADDR-1
  6614        END-IF
  6615        IF ACITYL  GREATER ZEROS
  6616           MOVE 'Y'              TO CHANGE-WAS-MADE-SW
  6617           MOVE AM-ADDR-CITY     TO CO-ADDR-CITY
  6618        END-IF
  6619        IF ASTATEL  GREATER ZEROS
  6620           MOVE 'Y'              TO CHANGE-WAS-MADE-SW
  6621           MOVE AM-ADDR-STATE    TO CO-ADDR-STATE
  6622        END-IF
  6623        IF ZIPL GREATER ZEROS
  6624           MOVE 'Y'              TO CHANGE-WAS-MADE-SW
  6625           MOVE AM-ZIP           TO CO-ZIP
  6626        END-IF
  6627        IF CSRL GREATER ZEROS
  6628           MOVE 'Y'              TO CHANGE-WAS-MADE-SW
  6629           MOVE AM-CSR-CODE      TO CO-CSR-CODE
  6630        END-IF
  6631        IF PHONEL GREATER ZEROS
  6632           MOVE 'Y'              TO CHANGE-WAS-MADE-SW
  6633           MOVE AM-TEL-NO        TO CO-TELEPHONE
  6634        END-IF
  6635        IF TAXNOL GREATER ZEROS
  6636           MOVE 'Y'              TO CHANGE-WAS-MADE-SW
  6637           MOVE AM-ID-NO         TO CO-SOC-SEC
  6638        END-IF
  6639        IF AUTO-CANCEL-ACCOUNT
  6640           IF CO-BILL-SW = ' '
  6641              MOVE 'B'           TO CO-BILL-SW
  6642              MOVE 'Y'           TO CHANGE-WAS-MADE-SW
  6643           END-IF
  6644        END-IF
  6645     END-IF
  6646
  6647     IF PCONTL > 0
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 127
* EL6501.cbl
  6648         MOVE 'Y'                TO CHANGE-WAS-MADE-SW
  6649         MOVE AM-CONTROL-NAME    TO CO-CONTROL-NAME
  6650     END-IF
  6651
  6652     IF CHANGE-WAS-MADE
  6653         MOVE BIN-CURRENT-SAVE   TO CO-LAST-MAINT-DT
  6654         MOVE PI-PROCESSOR-ID    TO CO-LAST-MAINT-USER
  6655         MOVE EIBTIME            TO CO-LAST-MAINT-HHMMSS.
  6656
  6657     IF NAMEL GREATER THAN ZERO
  6658         PERFORM 2200-ADD-COMPENSATION-NAME THRU 2200-EXIT.
  6659
  6660
  6661* EXEC CICS REWRITE
  6662*        FROM      (COMPENSATION-MASTER)
  6663*        DATASET   (COMP-FILE-ID)
  6664*    END-EXEC.
  6665     MOVE LENGTH OF
  6666      COMPENSATION-MASTER
  6667       TO DFHEIV11
  6668*    MOVE '&& L                  %   #00006538' TO DFHEIV0
  6669     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  6670     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  6671     MOVE X'2020233030303036353338' TO DFHEIV0(25:11)
  6672     CALL 'kxdfhei1' USING DFHEIV0,
  6673           COMP-FILE-ID,
  6674           COMPENSATION-MASTER,
  6675           DFHEIV11,
  6676           DFHEIV99
  6677     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6678
  6679
  6680 1799-EXIT.
  6681     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 128
* EL6501.cbl
  6683 1800-FIND-C-AGT.
  6684     ADD 1                       TO  AGT-SUB.
  6685
  6686     IF AGT-SUB GREATER 10
  6687         MOVE 'N'                TO  VALID-AGT-SW
  6688         GO TO 1899-EXIT.
  6689
  6690************************************************************
  6691**  MODIFICATION MADE TO ADD SERVICE FEES                 **
  6692************************************************************
  6693
  6694     IF AM-COM-TYP (AGT-SUB) = 'C' OR 'D' OR 'F'
  6695         MOVE AM-AGT (AGT-SUB)   TO  COMP-ACCOUNT
  6696         MOVE 'Y'                TO  VALID-AGT-SW
  6697         GO TO 1899-EXIT
  6698     ELSE
  6699         GO TO 1800-FIND-C-AGT.
  6700
  6701 1899-EXIT.
  6702     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 129
* EL6501.cbl
  6704 2000-CHANGE-A-RECORD.
  6705     PERFORM 4000-EDITS THRU 4900-EXIT.
  6706
  6707     IF EMI-FORCABLE-CTR GREATER ZERO  OR
  6708        EMI-FATAL-CTR    GREATER ZERO
  6709         GO TO 8200-SEND-DATAONLY.
  6710
  6711
  6712* EXEC CICS READ
  6713*        UPDATE
  6714*        DATASET   (ACCT-FILE-ID)
  6715*        SET       (ADDRESS OF ACCOUNT-MASTER)
  6716*        RIDFLD    (PI-ACCT-KEY)
  6717*    END-EXEC.
  6718*    MOVE '&"S        EU         (   #00006574' TO DFHEIV0
  6719     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6720     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  6721     MOVE X'2020233030303036353734' TO DFHEIV0(25:11)
  6722     CALL 'kxdfhei1' USING DFHEIV0,
  6723           ACCT-FILE-ID,
  6724           DFHEIV20,
  6725           DFHEIV99,
  6726           PI-ACCT-KEY,
  6727           DFHEIV99,
  6728           DFHEIV99,
  6729           DFHEIV99
  6730     SET ADDRESS OF ACCOUNT-MASTER TO
  6731         DFHEIV20
  6732     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6733
  6734
  6735     PERFORM 6700-BUILD-COMM-WORK THRU 6799-EXIT.
  6736
  6737     IF NOT PI-AR-PROCESSING
  6738        GO TO 2075-PROCESS-CHANGE.
  6739
  6740     MOVE AM-AGT (AM-REMIT-TO)   TO SAVE-FIN-RESP.
  6741     MOVE +0                     TO SUB1.
  6742
  6743 2075-PROCESS-CHANGE.
  6744     PERFORM 5000-MOVE-TO-RECORD THRU 5000-EXIT.
  6745
  6746     IF PI-AR-PROCESSING
  6747        PERFORM 5300-UPDATE-REQUEST-FILE THRU 5399-EXIT.
  6748
  6749     IF PI-COMPANY-ID = 'DMD'
  6750     IF AM-ANNIVERSARY-DATE = ZEROS
  6751           MOVE ER-0852             TO EMI-ERROR
  6752           MOVE -1                  TO CONTRL
  6753           MOVE AL-UABON            TO CONTRA
  6754           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6755
  6756     IF EMI-FORCABLE-CTR GREATER ZERO  OR
  6757        EMI-FATAL-CTR    GREATER ZERO
  6758         GO TO 8200-SEND-DATAONLY.
  6759
  6760     MOVE +1                     TO AXRF-SUB
  6761                                    COMM-WORK-SUB.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 130
* EL6501.cbl
  6762     PERFORM 6900-READ-AND-CHECK-AXRF THRU 6999-EXIT.
  6763
  6764     MOVE BIN-CURRENT-SAVE       TO AM-LAST-MAINT-DT.
  6765     MOVE PI-PROCESSOR-ID        TO AM-LAST-MAINT-USER.
  6766     MOVE EIBTIME                TO AM-LAST-MAINT-HHMMSS.
  6767
  6768     IF ((PI-FST-PAGE)
  6769        AND (PI-TOTAL-LINES = PI-LINE-SELECTED))
  6770                      OR
  6771        ((PI-2ND-PAGE)
  6772        AND (PI-TOTAL-LINES = PI-LINE-SELECTED + 8))
  6773                      OR
  6774        ((PI-3RD-PAGE)
  6775        AND (PI-TOTAL-LINES = PI-LINE-SELECTED + 16))
  6776                      OR
  6777        ((PI-LST-PAGE)
  6778        AND (PI-TOTAL-LINES = PI-LINE-SELECTED + 24))
  6779        SET ON-LAST-DATE-RANGE   TO TRUE
  6780     END-IF
  6781     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  6782         NEXT SENTENCE
  6783     ELSE
  6784         IF (ON-LAST-DATE-RANGE)
  6785                          OR
  6786            ((PI-COMPANY-ID = 'CID' OR 'AHL') AND
  6787             (PCONTL > ZERO))
  6788             PERFORM 1700-CHANGE-COMP THRU 1799-EXIT.
  6789
  6790     IF NAMEL GREATER THAN ZERO
  6791         PERFORM 2100-ADD-ACCOUNT-NAME THRU 2100-EXIT.
  6792
  6793
  6794* EXEC CICS REWRITE
  6795*        FROM      (ACCOUNT-MASTER)
  6796*        DATASET   (ACCT-FILE-ID)
  6797*    END-EXEC.
  6798     MOVE LENGTH OF
  6799      ACCOUNT-MASTER
  6800       TO DFHEIV11
  6801*    MOVE '&& L                  %   #00006639' TO DFHEIV0
  6802     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  6803     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  6804     MOVE X'2020233030303036363339' TO DFHEIV0(25:11)
  6805     CALL 'kxdfhei1' USING DFHEIV0,
  6806           ACCT-FILE-ID,
  6807           ACCOUNT-MASTER,
  6808           DFHEIV11,
  6809           DFHEIV99
  6810     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6811
  6812
  6813     PERFORM 6600-UPDATE-MAINT-DT THRU 6699-EXIT.
  6814
  6815     IF CSRL GREATER ZEROS
  6816         GO TO 3500-CHANGE-ALL-CSR.
  6817
  6818     MOVE ER-0000                TO EMI-ERROR.
  6819     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 131
* EL6501.cbl
  6820     MOVE LOW-VALUES             TO EL6501AI.
  6821
  6822     PERFORM 0700-FORMAT-KEYDATA THRU 0700-EXIT.
  6823     PERFORM 6500-READ-ACCT      THRU 6599-EXIT.
  6824     PERFORM 6000-MOVE-TO-SCREEN THRU 6099-EXIT.
  6825
  6826     MOVE ER-0000                TO EMI-ERROR.
  6827     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6828
  6829     MOVE -1                     TO MAINTL.
  6830     MOVE AL-UANON               TO MAINTA.
  6831     GO TO 8100-SEND-INITIAL-MAP.
  6832
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 132
* EL6501.cbl
  6834 2100-ADD-ACCOUNT-NAME.
  6835
  6836* EXEC CICS HANDLE CONDITION
  6837*         DUPREC   (2100-EXIT)
  6838*    END-EXEC.
  6839*    MOVE '"$%                   ! % #00006666' TO DFHEIV0
  6840     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
  6841     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6842     MOVE X'2520233030303036363636' TO DFHEIV0(25:11)
  6843     CALL 'kxdfhei1' USING DFHEIV0
  6844     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6845
  6846
  6847
  6848* EXEC CICS GETMAIN
  6849*         LENGTH   (NAME-REC-LEN)
  6850*         SET      (ADDRESS OF NAME-LOOKUP-MASTER)
  6851*         INITIMG  (GETMAIN-SPACE)
  6852*    END-EXEC.
  6853*    MOVE ',"IL                  $   #00006670' TO DFHEIV0
  6854     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6855     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6856     MOVE X'2020233030303036363730' TO DFHEIV0(25:11)
  6857     CALL 'kxdfhei1' USING DFHEIV0,
  6858           DFHEIV20,
  6859           NAME-REC-LEN,
  6860           GETMAIN-SPACE
  6861     SET ADDRESS OF NAME-LOOKUP-MASTER TO
  6862         DFHEIV20
  6863     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6864
  6865
  6866     MOVE SPACES                 TO  NAME-LOOKUP-MASTER.
  6867     MOVE BIN-CURRENT-SAVE       TO  NL-LAST-MAINT-DT.
  6868     MOVE PI-PROCESSOR-ID        TO  NL-LAST-MAINT-USER.
  6869     MOVE EIBTIME                TO  NL-LAST-MAINT-HHMMSS.
  6870     MOVE PI-COMPANY-CD          TO  NL-COMPANY-CD.
  6871     MOVE AM-NAME                TO  NL-NAME.
  6872     IF NL-NAME (1:4) = 'THE ' OR 'The ' OR 'the '
  6873        MOVE NL-NAME (5:26)      TO NL-NAME
  6874     END-IF
  6875     MOVE AM-ADDR-CITY           TO  NL-CITY.
  6876     MOVE AM-ADDR-STATE          TO  NL-ST.
  6877     MOVE 'A'                    TO  NL-RECORD-TYPE.
  6878     MOVE PI-COMPANY-CD          TO  NL-AM-COMPANY-CD.
  6879     MOVE AM-CARRIER             TO  NL-AM-CARRIER.
  6880     MOVE AM-GROUPING            TO  NL-AM-GROUPING.
  6881     MOVE AM-STATE               TO  NL-AM-STATE.
  6882     MOVE AM-ACCOUNT             TO  NL-AM-ACCOUNT.
  6883
  6884
  6885* EXEC CICS WRITE
  6886*        FROM      (NAME-LOOKUP-MASTER)
  6887*        RIDFLD    (NL-CONTROL-PRIMARY)
  6888*        DATASET   (NAME-FILE-ID)
  6889*    END-EXEC.
  6890     MOVE LENGTH OF
  6891      NAME-LOOKUP-MASTER
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 133
* EL6501.cbl
  6892       TO DFHEIV11
  6893*    MOVE '&$ L                  ''   #00006694' TO DFHEIV0
  6894     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6895     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6896     MOVE X'2020233030303036363934' TO DFHEIV0(25:11)
  6897     CALL 'kxdfhei1' USING DFHEIV0,
  6898           NAME-FILE-ID,
  6899           NAME-LOOKUP-MASTER,
  6900           DFHEIV11,
  6901           NL-CONTROL-PRIMARY,
  6902           DFHEIV99,
  6903           DFHEIV99
  6904     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6905
  6906
  6907 2100-EXIT.
  6908     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 134
* EL6501.cbl
  6910 2200-ADD-COMPENSATION-NAME.
  6911
  6912* EXEC CICS HANDLE CONDITION
  6913*         DUPREC   (2200-EXIT)
  6914*    END-EXEC.
  6915*    MOVE '"$%                   ! & #00006704' TO DFHEIV0
  6916     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
  6917     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6918     MOVE X'2620233030303036373034' TO DFHEIV0(25:11)
  6919     CALL 'kxdfhei1' USING DFHEIV0
  6920     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6921
  6922
  6923
  6924* EXEC CICS GETMAIN
  6925*         LENGTH   (NAME-REC-LEN)
  6926*         SET      (ADDRESS OF NAME-LOOKUP-MASTER)
  6927*         INITIMG  (GETMAIN-SPACE)
  6928*    END-EXEC.
  6929*    MOVE ',"IL                  $   #00006708' TO DFHEIV0
  6930     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6931     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6932     MOVE X'2020233030303036373038' TO DFHEIV0(25:11)
  6933     CALL 'kxdfhei1' USING DFHEIV0,
  6934           DFHEIV20,
  6935           NAME-REC-LEN,
  6936           GETMAIN-SPACE
  6937     SET ADDRESS OF NAME-LOOKUP-MASTER TO
  6938         DFHEIV20
  6939     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6940
  6941
  6942     MOVE SPACES                 TO  NAME-LOOKUP-MASTER.
  6943     MOVE BIN-CURRENT-SAVE       TO  NL-LAST-MAINT-DT.
  6944     MOVE PI-PROCESSOR-ID        TO  NL-LAST-MAINT-USER.
  6945     MOVE EIBTIME                TO  NL-LAST-MAINT-HHMMSS.
  6946     MOVE PI-COMPANY-CD          TO  NL-COMPANY-CD.
  6947     MOVE CO-ACCT-NAME           TO  NL-NAME.
  6948     IF NL-NAME (1:4) = 'THE ' OR 'The ' OR 'the '
  6949        MOVE NL-NAME (5:26)      TO NL-NAME
  6950     END-IF
  6951     MOVE CO-ADDR-CITY           TO  NL-CITY.
  6952     MOVE CO-ADDR-STATE          TO  NL-ST
  6953     MOVE 'C'                    TO  NL-RECORD-TYPE.
  6954     MOVE PI-COMPANY-CD          TO  NL-CO-COMPANY-CD.
  6955     MOVE CO-CARRIER             TO  NL-CO-CARRIER.
  6956     MOVE CO-GROUPING            TO  NL-CO-GROUPING.
  6957     MOVE CO-RESP-NO             TO  NL-CO-RESP-NO.
  6958     MOVE CO-ACCOUNT             TO  NL-CO-ACCOUNT.
  6959     MOVE CO-TYPE                TO  NL-CO-TYPE.
  6960
  6961
  6962* EXEC CICS WRITE
  6963*        FROM      (NAME-LOOKUP-MASTER)
  6964*        RIDFLD    (NL-CONTROL-PRIMARY)
  6965*        DATASET   (NAME-FILE-ID)
  6966*    END-EXEC.
  6967     MOVE LENGTH OF
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 135
* EL6501.cbl
  6968      NAME-LOOKUP-MASTER
  6969       TO DFHEIV11
  6970*    MOVE '&$ L                  ''   #00006733' TO DFHEIV0
  6971     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6972     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6973     MOVE X'2020233030303036373333' TO DFHEIV0(25:11)
  6974     CALL 'kxdfhei1' USING DFHEIV0,
  6975           NAME-FILE-ID,
  6976           NAME-LOOKUP-MASTER,
  6977           DFHEIV11,
  6978           NL-CONTROL-PRIMARY,
  6979           DFHEIV99,
  6980           DFHEIV99
  6981     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6982
  6983
  6984 2200-EXIT.
  6985     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 136
* EL6501.cbl
  6987 3000-CHANGE-ALL-RECORDS.
  6988     MOVE LOW-VALUES             TO PI-ACCT-REST-OF-EXP.
  6989     MOVE PI-ACCT-KEY            TO WS-KEY-SAVE.
  6990
  6991
  6992* EXEC CICS HANDLE CONDITION
  6993*         ENDFILE     (3030-END-FILE)
  6994*    END-EXEC.
  6995*    MOVE '"$''                   ! '' #00006746' TO DFHEIV0
  6996     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
  6997     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6998     MOVE X'2720233030303036373436' TO DFHEIV0(25:11)
  6999     CALL 'kxdfhei1' USING DFHEIV0
  7000     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7001
  7002
  7003     PERFORM 6300-STARTBR THRU 6300-EXIT.
  7004
  7005 3010-READ-NEXT.
  7006     PERFORM 6310-READNEXT THRU 6310-EXIT.
  7007
  7008     IF PI-ACCT-CCGSA-KEY NOT = WS-ACCT-CCGSA-KEY
  7009        GO TO 3030-END-FILE.
  7010
  7011
  7012* EXEC CICS ENDBR
  7013*        DATASET   (ACCT-FILE-ID)
  7014*    END-EXEC.
  7015     MOVE 0
  7016       TO DFHEIV11
  7017*    MOVE '&2                    $   #00006758' TO DFHEIV0
  7018     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  7019     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7020     MOVE X'2020233030303036373538' TO DFHEIV0(25:11)
  7021     CALL 'kxdfhei1' USING DFHEIV0,
  7022           ACCT-FILE-ID,
  7023           DFHEIV11,
  7024           DFHEIV99
  7025     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7026
  7027     ADD +1                      TO WS-CHANGE-ALL-CNT
  7028
  7029* EXEC CICS READ
  7030*        UPDATE
  7031*        DATASET   (ACCT-FILE-ID)
  7032*        SET       (ADDRESS OF ACCOUNT-MASTER)
  7033*        RIDFLD    (WS-KEY-SAVE)
  7034*    END-EXEC.
  7035*    MOVE '&"S        EU         (   #00006762' TO DFHEIV0
  7036     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7037     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7038     MOVE X'2020233030303036373632' TO DFHEIV0(25:11)
  7039     CALL 'kxdfhei1' USING DFHEIV0,
  7040           ACCT-FILE-ID,
  7041           DFHEIV20,
  7042           DFHEIV99,
  7043           WS-KEY-SAVE,
  7044           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 137
* EL6501.cbl
  7045           DFHEIV99,
  7046           DFHEIV99
  7047     SET ADDRESS OF ACCOUNT-MASTER TO
  7048         DFHEIV20
  7049     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7050
  7051
  7052     IF NAMEL    GREATER THAN ZERO  OR
  7053        INCAREL  GREATER THAN ZERO  OR
  7054        ADDR1L   GREATER THAN ZERO  OR
  7055        ACITYL   GREATER THAN ZERO  OR
  7056        ASTATEL  GREATER THAN ZERO  OR
  7057        ZIPL     GREATER THAN ZERO  OR
  7058        CLPTOLPL GREATER THAN ZERO  OR
  7059        PHONEL   GREATER THAN ZERO
  7060         MOVE '*'                TO AM-PROFILE-CHANGE-SWITCH.
  7061
  7062     IF STATUSL > ZERO
  7063        EVALUATE TRUE
  7064           WHEN STATUSI = 'A'
  7065              MOVE '0'           TO AM-STATUS
  7066           WHEN STATUSI = 'I'
  7067              MOVE '1'           TO AM-STATUS
  7068           WHEN (STATUSI = 'C')
  7069              AND (AM-STATUS NOT = '3' AND 'C')
  7070              MOVE '3'           TO AM-STATUS
  7071              SET AUTO-CANCEL-ACCOUNT
  7072                                 TO TRUE
  7073           WHEN (STATUSI = 'C')
  7074              MOVE '3'           TO AM-STATUS
  7075           WHEN STATUSI = 'F'
  7076              MOVE '4'           TO AM-STATUS
  7077           WHEN STATUSI = 'S'
  7078              MOVE '5'           TO AM-STATUS
  7079           WHEN OTHER
  7080              MOVE -1            TO STATUSL
  7081              MOVE AL-UABON      TO STATUSA
  7082              MOVE ER-2153       TO EMI-ERROR
  7083              PERFORM 9900-ERROR-FORMAT
  7084                                 THRU 9900-EXIT
  7085        END-EVALUATE
  7086     END-IF
  7087*    IF STATUSL > ZERO
  7088*       IF STATUSI = 'A'
  7089*          MOVE '0'              TO AM-STATUS
  7090*       ELSE
  7091*          IF STATUSI = 'I'
  7092*             MOVE '1'           TO AM-STATUS
  7093*          ELSE
  7094*             IF STATUSI = 'C'
  7095*                IF AM-STATUS NOT = '3' AND 'C'
  7096*                   SET AUTO-CANCEL-ACCOUNT
  7097*                                TO TRUE
  7098*                END-IF
  7099*                MOVE '3'        TO AM-STATUS
  7100*             ELSE
  7101*                IF STATUSI = 'F'
  7102*                   MOVE '4'     TO AM-STATUS
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 138
* EL6501.cbl
  7103*                ELSE
  7104*                   MOVE -1         TO STATUSL
  7105*                   MOVE AL-UABON   TO STATUSA
  7106*                   MOVE ER-2153    TO EMI-ERROR
  7107*                   PERFORM 9900-ERROR-FORMAT
  7108*                                THRU 9900-EXIT
  7109*                END-IF
  7110*             END-IF
  7111*          END-IF
  7112*       END-IF
  7113*    END-IF
  7114
  7115     IF CSRL GREATER ZERO
  7116        MOVE CSRI                TO AM-CSR-CODE.
  7117     IF NAMEL GREATER THAN ZERO
  7118        MOVE NAMEI               TO AM-NAME.
  7119     IF PCONTL GREATER THAN ZERO
  7120        MOVE PCONTI              TO AM-CONTROL-NAME
  7121     END-IF
  7122     IF INCAREL GREATER ZEROS
  7123        MOVE INCAREI             TO AM-PERSON.
  7124     IF ADDR1L GREATER ZEROS
  7125        MOVE ADDR1I              TO AM-ADDRS.
  7126     IF ACITYL GREATER ZEROS
  7127        MOVE ACITYI             TO AM-ADDR-CITY.
  7128     IF ASTATEL GREATER ZEROS
  7129        MOVE ASTATEI            TO AM-ADDR-STATE.
  7130     IF ZIPL NOT GREATER ZEROS
  7131         GO TO 3015-CONT-CHANGING.
  7132
  7133     MOVE ZIPI                   TO WS-ZIP-CODE.
  7134
  7135     IF WS-CANADIAN-ZIP
  7136         IF WS-ZIP-4 = SPACE  OR  '-'
  7137             MOVE WS-ZIP-CAN-2-POST1  TO AM-CAN-POSTAL-1
  7138             MOVE WS-ZIP-CAN-2-POST2  TO AM-CAN-POSTAL-2
  7139         ELSE
  7140             MOVE WS-ZIP-CAN-1-POST1  TO AM-CAN-POSTAL-1
  7141             MOVE WS-ZIP-CAN-1-POST2  TO AM-CAN-POSTAL-2
  7142     ELSE
  7143         IF WS-ZIP-6 = SPACE  OR  '-'
  7144             MOVE WS-ZIP-AM-2-CODE    TO AM-ZIP-PRIME
  7145             MOVE WS-ZIP-AM-2-PLUS4   TO AM-ZIP-PLUS4
  7146         ELSE
  7147             MOVE WS-ZIP-AM-1-CODE    TO AM-ZIP-PRIME
  7148             MOVE WS-ZIP-AM-1-PLUS4   TO AM-ZIP-PLUS4.
  7149
  7150 3015-CONT-CHANGING.
  7151
  7152     IF CLPTOLPL GREATER ZEROS
  7153
  7154* EXEC CICS BIF
  7155*            DEEDIT
  7156*            FIELD    (CLPTOLPI)
  7157*            LENGTH   (6)
  7158*        END-EXEC
  7159     MOVE 6
  7160       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 139
* EL6501.cbl
  7161*    MOVE '@"L                   #   #00006870' TO DFHEIV0
  7162     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  7163     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7164     MOVE X'2020233030303036383730' TO DFHEIV0(25:11)
  7165     CALL 'kxdfhei1' USING DFHEIV0,
  7166           CLPTOLPI,
  7167           DFHEIV11
  7168     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7169         IF CLPTOLPI NUMERIC
  7170             MOVE CLPTOLPI            TO AM-CLP-TOL-PCT
  7171         ELSE
  7172             MOVE -1                  TO CLPTOLPL
  7173             MOVE AL-UNBON            TO CLPTOLPA
  7174             MOVE ER-1778             TO EMI-ERROR
  7175             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7176         END-IF
  7177     END-IF
  7178
  7179     IF LCOMML > ZEROS
  7180
  7181* EXEC CICS BIF
  7182*            DEEDIT
  7183*            FIELD    (LCOMMI)
  7184*            LENGTH   (8)
  7185*        END-EXEC
  7186     MOVE 8
  7187       TO DFHEIV11
  7188*    MOVE '@"L                   #   #00006886' TO DFHEIV0
  7189     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  7190     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7191     MOVE X'2020233030303036383836' TO DFHEIV0(25:11)
  7192     CALL 'kxdfhei1' USING DFHEIV0,
  7193           LCOMMI,
  7194           DFHEIV11
  7195     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7196         IF LCOMMI NUMERIC
  7197            MOVE LCOMMI          TO AM-SPP-LEASE-COMM
  7198         ELSE
  7199            MOVE -1              TO LCOMML
  7200            MOVE AL-UNBON        TO LCOMMA
  7201            MOVE ER-1778         TO EMI-ERROR
  7202            PERFORM 9900-ERROR-FORMAT
  7203                                 THRU 9900-EXIT
  7204         END-IF
  7205     END-IF
  7206
  7207     IF PHONEL GREATER ZEROS
  7208        MOVE PHONEI              TO DEEDIT-FIELD
  7209        PERFORM 8600-DEEDIT
  7210        MOVE DEEDIT-FIELD-V0     TO WS-PHONE-NUM
  7211        MOVE WS-PH1              TO AM-AREA-CODE
  7212        MOVE WS-PH2              TO AM-TEL-PRE
  7213        MOVE WS-PH3              TO AM-TEL-NBR.
  7214
  7215*    IF PSILFFL GREATER +0
  7216*       MOVE PSILFFI             TO DEEDIT-FIELD
  7217*       PERFORM 8600-DEEDIT
  7218*       IF DEEDIT-FIELD NUMERIC
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 140
* EL6501.cbl
  7219*          MOVE DEEDIT-FIELD-V5  TO AM-LF-PSI-FACTOR.
  7220*
  7221*    IF PSIAHFL GREATER +0
  7222*       MOVE PSIAHFI             TO DEEDIT-FIELD
  7223*       PERFORM 8600-DEEDIT
  7224*       IF DEEDIT-FIELD NUMERIC
  7225*          MOVE DEEDIT-FIELD-V5  TO AM-AH-PSI-FACTOR.
  7226
  7227     MOVE BIN-CURRENT-SAVE       TO AM-LAST-MAINT-DT.
  7228     MOVE PI-PROCESSOR-ID        TO AM-LAST-MAINT-USER.
  7229     MOVE EIBTIME                TO AM-LAST-MAINT-HHMMSS.
  7230
  7231     IF ((PI-FST-PAGE)
  7232        AND (PI-TOTAL-LINES = WS-CHANGE-ALL-CNT))
  7233                      OR
  7234        ((PI-2ND-PAGE)
  7235        AND (PI-TOTAL-LINES = WS-CHANGE-ALL-CNT + 8))
  7236                      OR
  7237        ((PI-3RD-PAGE)
  7238        AND (PI-TOTAL-LINES = WS-CHANGE-ALL-CNT + 16))
  7239                      OR
  7240        ((PI-LST-PAGE)
  7241        AND (PI-TOTAL-LINES = WS-CHANGE-ALL-CNT + 24))
  7242        SET ON-LAST-DATE-RANGE   TO TRUE
  7243     END-IF
  7244*    IF ((PI-FST-PAGE)
  7245*       AND (PI-TOTAL-LINES = PI-LINE-SELECTED))
  7246*                     OR
  7247*       ((PI-2ND-PAGE)
  7248*       AND (PI-TOTAL-LINES = PI-LINE-SELECTED + 8))
  7249*                     OR
  7250*       ((PI-3RD-PAGE)
  7251*       AND (PI-TOTAL-LINES = PI-LINE-SELECTED + 16))
  7252*                     OR
  7253*       ((PI-LST-PAGE)
  7254*       AND (PI-TOTAL-LINES = PI-LINE-SELECTED + 24))
  7255*       SET ON-LAST-DATE-RANGE   TO TRUE
  7256*    END-IF
  7257     MOVE PI-PAGE-NUMBER TO WS-PAGE-NUMBER
  7258     MOVE PI-TOTAL-LINES TO WS-TOTAL-LINES
  7259     MOVE PI-LINE-SELECTED TO WS-LINE-SELECTED
  7260*    EXEC CICS DELAY
  7261*       INTERVAL (WS-DELAY-INT)
  7262*    END-EXEC
  7263     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  7264        CONTINUE
  7265     ELSE
  7266        IF (ON-LAST-DATE-RANGE)
  7267                   OR
  7268           ((PI-COMPANY-ID = 'CID' OR 'AHL') AND
  7269           (PCONTL > ZERO))
  7270           PERFORM 1700-CHANGE-COMP
  7271                                 THRU 1799-EXIT
  7272        END-IF
  7273     END-IF
  7274
  7275     IF NAMEL GREATER THAN ZERO
  7276         PERFORM 2100-ADD-ACCOUNT-NAME THRU 2100-EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 141
* EL6501.cbl
  7277
  7278
  7279* EXEC CICS REWRITE
  7280*        FROM      (ACCOUNT-MASTER)
  7281*        DATASET   (ACCT-FILE-ID)
  7282*    END-EXEC.
  7283     MOVE LENGTH OF
  7284      ACCOUNT-MASTER
  7285       TO DFHEIV11
  7286*    MOVE '&& L                  %   #00006973' TO DFHEIV0
  7287     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7288     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7289     MOVE X'2020233030303036393733' TO DFHEIV0(25:11)
  7290     CALL 'kxdfhei1' USING DFHEIV0,
  7291           ACCT-FILE-ID,
  7292           ACCOUNT-MASTER,
  7293           DFHEIV11,
  7294           DFHEIV99
  7295     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7296
  7297
  7298     PERFORM 6300-STARTBR  THRU 6300-EXIT.
  7299     PERFORM 6310-READNEXT THRU 6310-EXIT.
  7300
  7301     GO TO 3010-READ-NEXT.
  7302
  7303 3030-END-FILE.
  7304     IF BROWSE-STARTED
  7305        PERFORM 6320-ENDBR THRU 6320-EXIT.
  7306
  7307     PERFORM 6600-UPDATE-MAINT-DT THRU 6699-EXIT.
  7308
  7309     IF AUTO-CANCEL-ACCOUNT
  7310
  7311* EXEC CICS GETMAIN
  7312*          LENGTH   (ERACNT-REC-LEN)
  7313*          SET      (ADDRESS OF NOTE-FILE)
  7314*          INITIMG  (GETMAIN-SPACE)
  7315*          RESP     (WS-RESPONSE)
  7316*       END-EXEC
  7317*    MOVE ',"IL                  $  N#00006990' TO DFHEIV0
  7318     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7319     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7320     MOVE X'204E233030303036393930' TO DFHEIV0(25:11)
  7321     CALL 'kxdfhei1' USING DFHEIV0,
  7322           DFHEIV20,
  7323           ERACNT-REC-LEN,
  7324           GETMAIN-SPACE
  7325     SET ADDRESS OF NOTE-FILE TO
  7326         DFHEIV20
  7327     MOVE EIBRESP  TO WS-RESPONSE
  7328     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7329        MOVE PI-ACCT-CCGSA-KEY   TO NT-CONTROL-PRIMARY
  7330        MOVE '1'                 TO NT-RECORD-TYPE
  7331        MOVE +1                  TO NT-LINE-SEQUENCE
  7332        MOVE SAVE-BIN-DATE       TO NT-LAST-MAINT-DT
  7333        MOVE PI-PROCESSOR-ID     TO NT-LAST-MAINT-BY
  7334        MOVE EIBTIME             TO NT-LAST-MAINT-HHMMSS
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 142
* EL6501.cbl
  7335        MOVE 'CANCELLED DUE TO LOW PRODUCTION'
  7336                                 TO NT-NOTE-LINE
  7337        PERFORM WITH TEST AFTER UNTIL
  7338           (NOT RESP-DUPKEY)
  7339           AND (NOT RESP-DUPREC)
  7340
  7341* EXEC CICS WRITE
  7342*             FROM      (NOTE-FILE)
  7343*             RIDFLD    (NT-CONTROL-PRIMARY)
  7344*             DATASET   (ERACNT-FILE-ID)
  7345*             RESP      (WS-RESPONSE)
  7346*          END-EXEC
  7347     MOVE LENGTH OF
  7348      NOTE-FILE
  7349       TO DFHEIV11
  7350*    MOVE '&$ L                  ''  N#00007007' TO DFHEIV0
  7351     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7352     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7353     MOVE X'204E233030303037303037' TO DFHEIV0(25:11)
  7354     CALL 'kxdfhei1' USING DFHEIV0,
  7355           ERACNT-FILE-ID,
  7356           NOTE-FILE,
  7357           DFHEIV11,
  7358           NT-CONTROL-PRIMARY,
  7359           DFHEIV99,
  7360           DFHEIV99
  7361     MOVE EIBRESP  TO WS-RESPONSE
  7362     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7363           IF RESP-DUPKEY OR RESP-DUPREC
  7364              ADD +1             TO NT-LINE-SEQUENCE
  7365           END-IF
  7366        END-PERFORM
  7367     END-IF
  7368     IF NOT EMI-NO-ERRORS
  7369         GO TO 8200-SEND-DATAONLY.
  7370
  7371     MOVE -1                     TO NAMEL.
  7372     MOVE ER-0000                TO EMI-ERROR.
  7373     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7374     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 143
* EL6501.cbl
  7376 3500-CHANGE-ALL-CSR.
  7377     MOVE PI-ACCT-KEY            TO WS-KEY-SAVE.
  7378     MOVE LOW-VALUES             TO WS-ACCT-EXP-DT
  7379                                    WS-ACCT-REST-OF-EXP.
  7380
  7381
  7382* EXEC CICS HANDLE CONDITION
  7383*         ENDFILE     (3530-END-FILE)
  7384*    END-EXEC.
  7385*    MOVE '"$''                   ! ( #00007031' TO DFHEIV0
  7386     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
  7387     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7388     MOVE X'2820233030303037303331' TO DFHEIV0(25:11)
  7389     CALL 'kxdfhei1' USING DFHEIV0
  7390     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7391
  7392
  7393     PERFORM 6300-STARTBR THRU 6300-EXIT.
  7394
  7395 3510-READ-NEXT.
  7396     PERFORM 6310-READNEXT THRU 6310-EXIT.
  7397
  7398     IF PI-ACCT-CCGSA-KEY NOT = WS-ACCT-CCGSA-KEY
  7399        GO TO 3530-END-FILE.
  7400
  7401
  7402* EXEC CICS ENDBR
  7403*        DATASET   (ACCT-FILE-ID)
  7404*    END-EXEC.
  7405     MOVE 0
  7406       TO DFHEIV11
  7407*    MOVE '&2                    $   #00007043' TO DFHEIV0
  7408     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  7409     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7410     MOVE X'2020233030303037303433' TO DFHEIV0(25:11)
  7411     CALL 'kxdfhei1' USING DFHEIV0,
  7412           ACCT-FILE-ID,
  7413           DFHEIV11,
  7414           DFHEIV99
  7415     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7416
  7417
  7418
  7419* EXEC CICS READ
  7420*        UPDATE
  7421*        DATASET   (ACCT-FILE-ID)
  7422*        SET       (ADDRESS OF ACCOUNT-MASTER)
  7423*        RIDFLD    (WS-KEY-SAVE)
  7424*    END-EXEC.
  7425*    MOVE '&"S        EU         (   #00007047' TO DFHEIV0
  7426     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7427     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7428     MOVE X'2020233030303037303437' TO DFHEIV0(25:11)
  7429     CALL 'kxdfhei1' USING DFHEIV0,
  7430           ACCT-FILE-ID,
  7431           DFHEIV20,
  7432           DFHEIV99,
  7433           WS-KEY-SAVE,
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 144
* EL6501.cbl
  7434           DFHEIV99,
  7435           DFHEIV99,
  7436           DFHEIV99
  7437     SET ADDRESS OF ACCOUNT-MASTER TO
  7438         DFHEIV20
  7439     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7440
  7441
  7442     MOVE BIN-CURRENT-SAVE       TO AM-LAST-MAINT-DT.
  7443     MOVE PI-PROCESSOR-ID        TO AM-LAST-MAINT-USER.
  7444     MOVE EIBTIME                TO AM-LAST-MAINT-HHMMSS.
  7445
  7446     MOVE CSRI                   TO AM-CSR-CODE.
  7447
  7448
  7449* EXEC CICS REWRITE
  7450*        FROM      (ACCOUNT-MASTER)
  7451*        DATASET   (ACCT-FILE-ID)
  7452*    END-EXEC.
  7453     MOVE LENGTH OF
  7454      ACCOUNT-MASTER
  7455       TO DFHEIV11
  7456*    MOVE '&& L                  %   #00007060' TO DFHEIV0
  7457     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7458     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7459     MOVE X'2020233030303037303630' TO DFHEIV0(25:11)
  7460     CALL 'kxdfhei1' USING DFHEIV0,
  7461           ACCT-FILE-ID,
  7462           ACCOUNT-MASTER,
  7463           DFHEIV11,
  7464           DFHEIV99
  7465     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7466
  7467
  7468     PERFORM 6300-STARTBR  THRU 6300-EXIT.
  7469     PERFORM 6310-READNEXT THRU 6310-EXIT.
  7470
  7471     GO TO 3510-READ-NEXT.
  7472
  7473 3530-END-FILE.
  7474     IF BROWSE-STARTED
  7475        PERFORM 6320-ENDBR THRU 6320-EXIT.
  7476
  7477     MOVE ER-4009                TO EMI-ERROR.
  7478     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7479     MOVE LOW-VALUES             TO EL6501AI.
  7480
  7481     PERFORM 0700-FORMAT-KEYDATA THRU 0700-EXIT.
  7482     PERFORM 6500-READ-ACCT      THRU 6599-EXIT.
  7483     PERFORM 6000-MOVE-TO-SCREEN THRU 6099-EXIT.
  7484
  7485     PERFORM 6600-UPDATE-MAINT-DT THRU 6699-EXIT.
  7486
  7487     MOVE -1                     TO MAINTL.
  7488     MOVE AL-UANON               TO MAINTA.
  7489     GO TO 8100-SEND-INITIAL-MAP.
  7490
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 145
* EL6501.cbl
  7492 4000-EDITS.
  7493     IF PI-COMPANY-ID = 'NCL'
  7494      IF MAINTI = 'A' OR 'C'
  7495        IF CSRL GREATER ZEROS
  7496            PERFORM 8050-USER-REC-READ THRU 8060-EXIT
  7497          ELSE
  7498            IF MAINTI = 'A'
  7499                MOVE ER-1883         TO EMI-ERROR
  7500                MOVE -1              TO CSRL
  7501                MOVE AL-UABON        TO CSRA
  7502                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7503
  7504     IF PI-COMPANY-ID  =  'AIG' OR 'AUK'
  7505        IF NAMEL NOT GREATER ZEROS
  7506           IF MAINTI = 'C'
  7507              GO TO 4070-CHECK-STATUS
  7508           ELSE
  7509              MOVE -1               TO  NAMEL
  7510              MOVE AL-UABON         TO  NAMEA
  7511              MOVE ER-2045          TO  EMI-ERROR
  7512              PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
  7513        ELSE
  7514            GO TO 4065-CHECK-ASSOCIATES.
  7515
  7516     IF TYPEL NOT GREATER ZEROS
  7517        IF MAINTI = 'C'
  7518           GO TO 4050-CONTINUE
  7519        ELSE
  7520           GO TO 4020-BUS-TYPE-ERROR.
  7521
  7522     IF TYPEI NOT NUMERIC
  7523        GO TO 4020-BUS-TYPE-ERROR
  7524     ELSE
  7525        IF TYPEI LESS 1 OR GREATER 99
  7526           GO TO 4020-BUS-TYPE-ERROR.
  7527
  7528     MOVE SPACES                 TO ELCNTL-KEY.
  7529
  7530     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
  7531     MOVE TYPEI                  TO CNTL-BUS-TYPE.
  7532     MOVE '8'                    TO CNTL-REC-TYPE.
  7533     MOVE +0                     TO CNTL-SEQ-NO.
  7534
  7535
  7536* EXEC CICS HANDLE CONDITION
  7537*        NOTFND   (4020-BUS-TYPE-ERROR)
  7538*    END-EXEC.
  7539*    MOVE '"$I                   ! ) #00007132' TO DFHEIV0
  7540     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7541     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7542     MOVE X'2920233030303037313332' TO DFHEIV0(25:11)
  7543     CALL 'kxdfhei1' USING DFHEIV0
  7544     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7545
  7546
  7547
  7548* EXEC CICS READ
  7549*        GTEQ
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 146
* EL6501.cbl
  7550*        DATASET   (CNTL-FILE-ID)
  7551*        SET       (ADDRESS OF CONTROL-FILE)
  7552*        RIDFLD    (ELCNTL-KEY)
  7553*    END-EXEC.
  7554*    MOVE '&"S        G          (   #00007136' TO DFHEIV0
  7555     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  7556     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7557     MOVE X'2020233030303037313336' TO DFHEIV0(25:11)
  7558     CALL 'kxdfhei1' USING DFHEIV0,
  7559           CNTL-FILE-ID,
  7560           DFHEIV20,
  7561           DFHEIV99,
  7562           ELCNTL-KEY,
  7563           DFHEIV99,
  7564           DFHEIV99,
  7565           DFHEIV99
  7566     SET ADDRESS OF CONTROL-FILE TO
  7567         DFHEIV20
  7568     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7569
  7570
  7571     IF TYPEI LESS 21
  7572        MOVE TYPEI               TO WS-BUS-ENTRY
  7573     ELSE
  7574        DIVIDE TYPEI BY 20
  7575            GIVING WS-BUS-TYPE REMAINDER WS-BUS-ENTRY
  7576        IF WS-BUS-ENTRY = ZEROS
  7577           MOVE 20               TO WS-BUS-ENTRY.
  7578
  7579     IF CF-BUSINESS-TITLE (WS-BUS-ENTRY) NOT = SPACES
  7580        GO TO 4050-CONTINUE.
  7581
  7582 4020-BUS-TYPE-ERROR.
  7583     MOVE -1                     TO TYPEL.
  7584     MOVE AL-UNBON               TO TYPEA.
  7585     MOVE ER-2178                TO EMI-ERROR.
  7586     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7587
  7588 4050-CONTINUE.
  7589     IF ASTATEL > 0
  7590        MOVE SPACES                 TO  ELCNTL-KEY
  7591        MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID
  7592        MOVE '3'                    TO  CNTL-REC-TYPE
  7593        MOVE ASTATEI                TO  CNTL-ACCESS (1:2)
  7594        MOVE +0                     TO  CNTL-SEQ-NO
  7595
  7596* EXEC CICS  READ
  7597*           DATASET  ('ELCNTL')
  7598*           SET      (ADDRESS OF CONTROL-FILE)
  7599*           RIDFLD   (ELCNTL-KEY)
  7600*           RESP     (WS-RESPONSE)
  7601*       END-EXEC
  7602     MOVE 'ELCNTL' TO DFHEIV1
  7603*    MOVE '&"S        E          (  N#00007167' TO DFHEIV0
  7604     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7605     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7606     MOVE X'204E233030303037313637' TO DFHEIV0(25:11)
  7607     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 147
* EL6501.cbl
  7608           DFHEIV1,
  7609           DFHEIV20,
  7610           DFHEIV99,
  7611           ELCNTL-KEY,
  7612           DFHEIV99,
  7613           DFHEIV99,
  7614           DFHEIV99
  7615     SET ADDRESS OF CONTROL-FILE TO
  7616         DFHEIV20
  7617     MOVE EIBRESP  TO WS-RESPONSE
  7618     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7619        IF NOT RESP-NORMAL
  7620           MOVE ER-0144                TO  EMI-ERROR
  7621           MOVE -1                     TO  ASTATEL
  7622           MOVE AL-UABON               TO  ASTATEA
  7623           PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7624        END-IF
  7625     ELSE
  7626        IF MAINTI = 'A'
  7627           MOVE ER-0144                TO  EMI-ERROR
  7628           MOVE -1                     TO  ASTATEL
  7629           MOVE AL-UABON               TO  ASTATEA
  7630           PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7631        END-IF
  7632     END-IF
  7633     IF INDGRPL NOT GREATER ZEROS
  7634        IF MAINTI = 'C'
  7635           GO TO 4070-CHECK-STATUS
  7636        ELSE
  7637           GO TO 4060-IG-ERROR.
  7638
  7639     IF INDGRPI = 'I' OR 'G'
  7640        GO TO 4070-CHECK-STATUS.
  7641
  7642 4060-IG-ERROR.
  7643     MOVE -1                     TO INDGRPL.
  7644     MOVE AL-UABON               TO INDGRPA.
  7645     MOVE ER-2152                TO EMI-ERROR.
  7646     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7647
  7648 4065-CHECK-ASSOCIATES.
  7649     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  7650        MOVE  PI-ACCT-ACCOUNT    TO  WS-ACCOUNT-NUM-AREA
  7651        MOVE  NAMEI              TO  WS-NAME-AREA
  7652     ELSE
  7653        GO TO 4070-CHECK-STATUS.
  7654
  7655     IF WS-NAME-1-4  =  WS-ACCT-BRANCH-CD
  7656        NEXT SENTENCE
  7657     ELSE
  7658        MOVE -1                  TO  NAMEL
  7659        MOVE AL-UABON            TO  NAMEA
  7660        MOVE ER-0788             TO  EMI-ERROR
  7661        PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  7662
  7663 4070-CHECK-STATUS.
  7664     IF STATUSL NOT GREATER ZEROS
  7665        IF MAINTI = 'C'
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 148
* EL6501.cbl
  7666           GO TO 4090-CHECK-STD-AH-TYPE
  7667        ELSE
  7668           MOVE 'A'              TO STATUSI
  7669           MOVE AL-UANON         TO STATUSA
  7670           GO TO 4090-CHECK-STD-AH-TYPE.
  7671
  7672     IF STATUSI = 'A' OR 'I' OR 'C' OR 'F' OR 'S'
  7673        GO TO 4090-CHECK-STD-AH-TYPE.
  7674
  7675 4080-STATUS-ERROR.
  7676     MOVE -1                     TO STATUSL.
  7677     MOVE AL-UABON               TO STATUSA.
  7678     MOVE ER-2153                TO EMI-ERROR.
  7679     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7680
  7681 4090-CHECK-STD-AH-TYPE.
  7682
  7683     IF PI-COMPANY-ID  = 'AIG' OR 'AUK'
  7684         GO TO 4900-EXIT.
  7685
  7686     IF STDBENL NOT GREATER ZEROS
  7687        IF MAINTI = 'C'
  7688*          GO TO 4110-CHECK-REMIT
  7689           GO TO 4100-CHECK-CLPTOLP
  7690        ELSE
  7691           MOVE ZEROS            TO STDBENI
  7692           MOVE AL-UANON         TO STDBENA
  7693*          GO TO 4110-CHECK-REMIT.
  7694           GO TO 4100-CHECK-CLPTOLP.
  7695
  7696     IF STDBENI = SPACES
  7697         MOVE ZEROS               TO STDBENI.
  7698     IF STDBENI = ZEROS
  7699*        GO TO 4110-CHECK-REMIT.
  7700         GO TO 4100-CHECK-CLPTOLP.
  7701
  7702     MOVE STDBENI                TO WS-EDIT-BEN-CODE.
  7703     IF INVALID-BENEFIT-CODE
  7704        GO TO 4099-STD-BEN-ERROR.
  7705
  7706     MOVE SPACES                 TO ELCNTL-KEY.
  7707
  7708     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
  7709     MOVE STDBENI                TO CNTL-BEN-TYPE.
  7710     MOVE '5'                    TO CNTL-REC-TYPE.
  7711     MOVE +0                     TO CNTL-SEQ-NO.
  7712
  7713
  7714* EXEC CICS HANDLE CONDITION
  7715*        NOTFND   (4099-STD-BEN-ERROR)
  7716*    END-EXEC.
  7717*    MOVE '"$I                   ! * #00007267' TO DFHEIV0
  7718     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7719     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7720     MOVE X'2A20233030303037323637' TO DFHEIV0(25:11)
  7721     CALL 'kxdfhei1' USING DFHEIV0
  7722     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7723
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 149
* EL6501.cbl
  7724
  7725
  7726* EXEC CICS READ
  7727*        GTEQ
  7728*        DATASET   (CNTL-FILE-ID)
  7729*        SET       (ADDRESS OF CONTROL-FILE)
  7730*        RIDFLD    (ELCNTL-KEY)
  7731*    END-EXEC.
  7732*    MOVE '&"S        G          (   #00007271' TO DFHEIV0
  7733     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  7734     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7735     MOVE X'2020233030303037323731' TO DFHEIV0(25:11)
  7736     CALL 'kxdfhei1' USING DFHEIV0,
  7737           CNTL-FILE-ID,
  7738           DFHEIV20,
  7739           DFHEIV99,
  7740           ELCNTL-KEY,
  7741           DFHEIV99,
  7742           DFHEIV99,
  7743           DFHEIV99
  7744     SET ADDRESS OF CONTROL-FILE TO
  7745         DFHEIV20
  7746     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7747
  7748
  7749     IF CNTL-COMP-ID  = CF-COMPANY-ID  AND
  7750        CNTL-REC-TYPE = CF-RECORD-TYPE
  7751         MOVE 1                  TO SUB
  7752     ELSE
  7753         GO TO 4099-STD-BEN-ERROR.
  7754
  7755 4095-CHECK-BEN-TYPE.
  7756     IF STDBENI = CF-BENEFIT-CODE (SUB)
  7757*       GO TO 4110-CHECK-REMIT.
  7758        GO TO 4100-CHECK-CLPTOLP.
  7759
  7760     IF SUB LESS 8
  7761         ADD 1 TO SUB
  7762         GO TO 4095-CHECK-BEN-TYPE.
  7763
  7764 4099-STD-BEN-ERROR.
  7765     MOVE -1                     TO STDBENL.
  7766     MOVE AL-UABON               TO STDBENA.
  7767     MOVE ER-0250                TO EMI-ERROR.
  7768     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7769
  7770 4100-CHECK-CLPTOLP.
  7771
  7772     IF CLPTOLPL > ZERO
  7773
  7774* EXEC CICS BIF
  7775*            DEEDIT
  7776*            FIELD    (CLPTOLPI)
  7777*            LENGTH   (6)
  7778*        END-EXEC
  7779     MOVE 6
  7780       TO DFHEIV11
  7781*    MOVE '@"L                   #   #00007302' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 150
* EL6501.cbl
  7782     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  7783     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7784     MOVE X'2020233030303037333032' TO DFHEIV0(25:11)
  7785     CALL 'kxdfhei1' USING DFHEIV0,
  7786           CLPTOLPI,
  7787           DFHEIV11
  7788     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7789         IF CLPTOLPI NOT NUMERIC
  7790             MOVE ER-1778        TO EMI-ERROR
  7791             MOVE -1             TO CLPTOLPL
  7792             MOVE AL-UNBON       TO CLPTOLPA
  7793             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7794         END-IF
  7795     END-IF.
  7796     IF LCOMML > ZERO
  7797
  7798* EXEC CICS BIF
  7799*            DEEDIT
  7800*            FIELD    (LCOMMI)
  7801*            LENGTH   (8)
  7802*        END-EXEC
  7803     MOVE 8
  7804       TO DFHEIV11
  7805*    MOVE '@"L                   #   #00007315' TO DFHEIV0
  7806     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  7807     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7808     MOVE X'2020233030303037333135' TO DFHEIV0(25:11)
  7809     CALL 'kxdfhei1' USING DFHEIV0,
  7810           LCOMMI,
  7811           DFHEIV11
  7812     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7813         IF LCOMMI NOT NUMERIC
  7814             MOVE ER-1778        TO EMI-ERROR
  7815             MOVE -1             TO LCOMML
  7816             MOVE AL-UNBON       TO LCOMMA
  7817             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7818         END-IF
  7819     END-IF
  7820     IF MAXMFEEL > ZEROS
  7821
  7822* EXEC CICS BIF DEEDIT
  7823*          FIELD   (MAXMFEEI)
  7824*          LENGTH  (5)
  7825*       END-EXEC
  7826     MOVE 5
  7827       TO DFHEIV11
  7828*    MOVE '@"L                   #   #00007328' TO DFHEIV0
  7829     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  7830     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7831     MOVE X'2020233030303037333238' TO DFHEIV0(25:11)
  7832     CALL 'kxdfhei1' USING DFHEIV0,
  7833           MAXMFEEI,
  7834           DFHEIV11
  7835     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7836        IF MAXMFEEI NUMERIC
  7837           MOVE MAXMFEEI         TO WS-WORK-FIELD
  7838           MOVE WS-WORK-NUM      TO MAXMFEEO
  7839        ELSE
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 151
* EL6501.cbl
  7840           MOVE -1               TO MAXMFEEL
  7841           MOVE AL-UABON         TO MAXMFEEA
  7842           MOVE ER-7717          TO EMI-ERROR
  7843           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7844        END-IF
  7845     END-IF
  7846     IF (CLPSTL > 0)
  7847         MOVE AL-UANON           TO CLPSTA
  7848        IF (CLPSTI NOT = SPACES)
  7849           MOVE SPACES           TO ELCNTL-KEY
  7850           MOVE PI-COMPANY-ID    TO CNTL-COMP-ID
  7851           MOVE '3'              TO CNTL-REC-TYPE
  7852           MOVE CLPSTI           TO CNTL-ACCESS (1:2)
  7853           MOVE +0               TO CNTL-SEQ-NO
  7854
  7855* EXEC CICS  READ
  7856*              DATASET  ('ELCNTL')
  7857*              SET      (ADDRESS OF CONTROL-FILE)
  7858*              RIDFLD   (ELCNTL-KEY)
  7859*              RESP     (WS-RESPONSE)
  7860*          END-EXEC
  7861     MOVE 'ELCNTL' TO DFHEIV1
  7862*    MOVE '&"S        E          (  N#00007350' TO DFHEIV0
  7863     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7864     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7865     MOVE X'204E233030303037333530' TO DFHEIV0(25:11)
  7866     CALL 'kxdfhei1' USING DFHEIV0,
  7867           DFHEIV1,
  7868           DFHEIV20,
  7869           DFHEIV99,
  7870           ELCNTL-KEY,
  7871           DFHEIV99,
  7872           DFHEIV99,
  7873           DFHEIV99
  7874     SET ADDRESS OF CONTROL-FILE TO
  7875         DFHEIV20
  7876     MOVE EIBRESP  TO WS-RESPONSE
  7877     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7878           IF NOT RESP-NORMAL
  7879              MOVE ER-0144       TO EMI-ERROR
  7880              MOVE -1            TO CLPSTL
  7881              MOVE AL-UABON      TO CLPSTA
  7882              PERFORM 9900-ERROR-FORMAT
  7883                                 THRU  9900-EXIT
  7884           END-IF
  7885        ELSE
  7886           MOVE ER-0144          TO EMI-ERROR
  7887           MOVE -1               TO CLPSTL
  7888           MOVE AL-UABON         TO CLPSTA
  7889           PERFORM 9900-ERROR-FORMAT
  7890                                 THRU  9900-EXIT
  7891        END-IF
  7892     END-IF
  7893     IF (PRODCDL > ZEROS)
  7894        and (emi-error not = er-0144)
  7895        if prodcdi = spaces
  7896           continue
  7897        else
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 152
* EL6501.cbl
  7898           move low-values       to erpdef-key
  7899           move pi-company-cd    to erpdef-company-cd
  7900           move clpsti           to erpdef-state
  7901           move prodcdi          to erpdef-prod-cd
  7902           move erpdef-key       to erpdef-key-save
  7903
  7904* exec cics read
  7905*             dataset ('ERPDEF')
  7906*             set     (address of product-master)
  7907*             ridfld  (erpdef-key)
  7908*             length  (6)
  7909*             gteq
  7910*             resp    (ws-response)
  7911*          end-exec
  7912     MOVE 'ERPDEF' TO DFHEIV1
  7913*    MOVE '&"S        G          (  N#00007381' TO DFHEIV0
  7914     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  7915     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7916     MOVE X'204E233030303037333831' TO DFHEIV0(25:11)
  7917     CALL 'kxdfhei1' USING DFHEIV0,
  7918           DFHEIV1,
  7919           DFHEIV20,
  7920           DFHEIV99,
  7921           erpdef-key,
  7922           DFHEIV99,
  7923           DFHEIV99,
  7924           DFHEIV99
  7925     SET ADDRESS OF product-master TO
  7926         DFHEIV20
  7927     MOVE EIBRESP  TO ws-response
  7928     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7929           if (resp-normal)
  7930              and (pd-control-primary (1:6) =
  7931                           erpdef-key-save (1:6))
  7932              continue
  7933           else
  7934              move er-8156       to emi-error
  7935              MOVE -1            TO PRODCDL
  7936              MOVE AL-UABON      TO PRODCDA
  7937              PERFORM 9900-ERROR-FORMAT
  7938                                 THRU  9900-EXIT
  7939           end-if
  7940        end-if
  7941     end-if
  7942     .
  7943 4110-CHECK-REMIT.
  7944     IF REMITL NOT GREATER ZEROS
  7945        MOVE 1                   TO REMITI
  7946        MOVE AL-UNNON            TO REMITA
  7947        GO TO 4120-REMIT-ERROR.
  7948
  7949     IF (REMITI NOT NUMERIC)  OR
  7950        (REMITI LESS 1 OR GREATER 10)
  7951           GO TO 4120-REMIT-ERROR.
  7952
  7953 4115-CHECK-AGENT.
  7954     SET M-INDEX                 TO REMITI.
  7955
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 153
* EL6501.cbl
  7956     IF AGENTL (M-INDEX)  NOT GREATER ZEROS
  7957        MOVE ER-2156             TO EMI-ERROR
  7958        GO TO 4120-R-ERROR.
  7959
  7960     GO TO 4130-CHECK-CONTRACT.
  7961
  7962 4120-REMIT-ERROR.
  7963     MOVE ER-2155                TO EMI-ERROR.
  7964
  7965 4120-R-ERROR.
  7966     MOVE -1                     TO REMITL.
  7967     MOVE AL-UABON               TO REMITA.
  7968     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7969
  7970 4130-CHECK-CONTRACT.
  7971     IF CONTRL NOT = ZEROS AND CONTRI NOT = SPACES
  7972        MOVE CONTRI                TO DEEDIT-FIELD
  7973        PERFORM 8600-DEEDIT
  7974        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  7975        MOVE '4'                    TO DC-OPTION-CODE
  7976        PERFORM 9700-DATE-LINK
  7977        IF DATE-CONVERSION-ERROR
  7978           MOVE ER-2157             TO EMI-ERROR
  7979           MOVE -1                  TO CONTRL
  7980           MOVE AL-UABON            TO CONTRA
  7981           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7982        ELSE
  7983***  Y2K PROJ 7744
  7984           MOVE DC-GREG-DATE-1-EDIT TO CONTRI
  7985           MOVE AL-UANON            TO CONTRA
  7986           MOVE DC-GREG-DATE-1-YMD  TO WS-ANVR-DT
  7987           MOVE DC-ALPHA-CENTURY    TO WS-ANVR-DT(4:2)
  7988        END-IF
  7989     END-IF.
  7990***  Y2K PROJ 7744
  7991
  7992     IF PI-COMPANY-ID = 'DMD'
  7993       IF PI-MAINT = 'A'
  7994        IF CONTRL = ZERO
  7995           MOVE ER-0852             TO EMI-ERROR
  7996           MOVE -1                  TO CONTRL
  7997           MOVE AL-UABON            TO CONTRA
  7998           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7999
  8000*4131-CHECK-PSI-FACTOR.
  8001*    IF PSILFFL GREATER +0
  8002*       MOVE PSILFFI             TO DEEDIT-FIELD
  8003*       PERFORM 8600-DEEDIT
  8004*       IF DEEDIT-FIELD NUMERIC
  8005*          MOVE DEEDIT-FIELD-V5  TO WS-LIFE-PSI
  8006*                                   PSILFFO
  8007*       ELSE
  8008*          MOVE ER-9999          TO EMI-ERROR
  8009*          MOVE -1               TO PSILFFL
  8010*          MOVE AL-UABON         TO PSILFFA
  8011*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8012*
  8013*    IF PSIAHFL GREATER +0
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 154
* EL6501.cbl
  8014*       MOVE PSIAHFI             TO DEEDIT-FIELD
  8015*       PERFORM 8600-DEEDIT
  8016*       IF DEEDIT-FIELD NUMERIC
  8017*          MOVE DEEDIT-FIELD-V5  TO WS-AH-PSI
  8018*                                   PSIAHFO
  8019*       ELSE
  8020*          MOVE ER-9999          TO EMI-ERROR
  8021*          MOVE -1               TO PSIAHFL
  8022*          MOVE AL-UABON         TO PSIAHFA
  8023*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8024
  8025 4135-CHECK-PREVIOUS-DATES.
  8026     IF PEFFDTEL NOT = ZEROS AND PEFFDTEI NOT = SPACES
  8027        MOVE PEFFDTEI              TO DEEDIT-FIELD
  8028        PERFORM 8600-DEEDIT
  8029        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  8030        MOVE '4'                    TO DC-OPTION-CODE
  8031        PERFORM 9700-DATE-LINK
  8032        IF DATE-CONVERSION-ERROR
  8033           MOVE ER-0348             TO EMI-ERROR
  8034           MOVE -1                  TO PEFFDTEL
  8035           MOVE AL-UABON            TO PEFFDTEA
  8036           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8037        ELSE
  8038***  Y2K PROJ 7744
  8039           MOVE DC-GREG-DATE-1-EDIT TO PEFFDTEI
  8040           MOVE AL-UANON            TO PEFFDTEA
  8041           MOVE DC-GREG-DATE-1-YMD  TO WS-PEFF-DT
  8042           MOVE DC-ALPHA-CENTURY    TO WS-PEFF-DT(4:2)
  8043        END-IF
  8044     END-IF.
  8045
  8046     IF PEXPDTEL NOT = ZEROS AND PEXPDTEI NOT = SPACES
  8047        MOVE PEXPDTEI              TO DEEDIT-FIELD
  8048        PERFORM 8600-DEEDIT
  8049        IF DEEDIT-FIELD-V0 NOT LESS 999999
  8050           MOVE '99/99/99'             TO PEXPDTEO
  8051           MOVE 99999999999            TO WS-PEXP-DT
  8052           MOVE AL-UANON               TO PEXPDTEA
  8053        ELSE
  8054           MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  8055           MOVE '4'                    TO DC-OPTION-CODE
  8056           PERFORM 9700-DATE-LINK
  8057           IF DATE-CONVERSION-ERROR
  8058              MOVE ER-0454             TO EMI-ERROR
  8059              MOVE -1                  TO PEXPDTEL
  8060              MOVE AL-UABON            TO PEXPDTEA
  8061              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8062           ELSE
  8063              MOVE DC-GREG-DATE-1-EDIT TO PEXPDTEI
  8064              MOVE AL-UANON            TO PEXPDTEA
  8065              MOVE DC-GREG-DATE-1-YMD  TO WS-PEXP-DT
  8066              MOVE DC-ALPHA-CENTURY    TO WS-PEXP-DT(4:2)
  8067           END-IF
  8068        END-IF
  8069     END-IF.
  8070***  Y2K PROJ 7744
  8071
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 155
* EL6501.cbl
  8072     IF COMMCALL NOT GREATER ZEROS
  8073         GO TO 4150-CHECK-REINCAL.
  8074
  8075     IF (PI-COMPANY-ID = 'ADL' OR 'DEF') AND
  8076         (EFFCHG-SAVE LESS 841101)       AND
  8077         (COMMCALI = 'Y' OR '1')         AND
  8078         (NOT MODIFY-CAP)
  8079           MOVE -1               TO COMMCALL
  8080           MOVE AL-UABON         TO COMMCALA
  8081           MOVE ER-2189          TO EMI-ERROR
  8082           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8083
  8084     IF COMMCALI = 'Y' OR 'N' OR '1' OR ' '
  8085         GO TO 4150-CHECK-REINCAL.
  8086
  8087 4140-COMMCAL-ERROR.
  8088     MOVE -1                     TO COMMCALL.
  8089     MOVE AL-UABON               TO COMMCALA.
  8090     MOVE ER-2158                TO EMI-ERROR.
  8091     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8092
  8093 4150-CHECK-REINCAL.
  8094     IF REINCALL NOT GREATER ZEROS
  8095         GO TO 4170-CHECK-REINTAB.
  8096
  8097     IF REINCALI = 'Y' OR 'N'
  8098        GO TO 4170-CHECK-REINTAB.
  8099
  8100 4160-REINCAL-ERROR.
  8101     MOVE -1                     TO REINCALL.
  8102     MOVE AL-UABON               TO REINCALA.
  8103     MOVE ER-2179                TO EMI-ERROR.
  8104     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8105
  8106 4170-CHECK-REINTAB.
  8107     IF REINTABL NOT GREATER ZEROS
  8108        IF PI-COMPANY-ID = 'NCL' AND
  8109           MAINTI = 'A'
  8110                MOVE ER-4010         TO EMI-ERROR
  8111                MOVE -1              TO REINTABL
  8112                MOVE AL-UABON        TO REINTABA
  8113                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8114
  8115     IF REINTABL NOT GREATER ZEROS OR REINTABI = SPACES
  8116         GO TO 4410-CHECK-AGENTS.
  8117     IF PI-COMPANY-ID = 'CID'
  8118        IF PI-ACCT-STATE = 'KY'
  8119           IF REINTABI NOT = 'K98' AND 'K99' AND 'KYA'
  8120              MOVE -1            TO REINTABL
  8121              MOVE AL-UABON      TO REINTABA
  8122              MOVE ER-2159       TO EMI-ERROR
  8123              PERFORM 9900-ERROR-FORMAT
  8124                                 THRU 9900-EXIT
  8125           END-IF
  8126        END-IF
  8127     END-IF
  8128     MOVE LOW-VALUES             TO REIN-KEY.
  8129
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 156
* EL6501.cbl
  8130     MOVE PI-COMPANY-CD          TO REIN-COMP-CD.
  8131     MOVE 'A'                    TO REIN-CODE.
  8132     MOVE REINTABI               TO REIN-TABLE.
  8133
  8134
  8135* EXEC CICS HANDLE CONDITION
  8136*        NOTFND   (4180-REIN-ERROR)
  8137*    END-EXEC.
  8138*    MOVE '"$I                   ! + #00007594' TO DFHEIV0
  8139     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8140     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8141     MOVE X'2B20233030303037353934' TO DFHEIV0(25:11)
  8142     CALL 'kxdfhei1' USING DFHEIV0
  8143     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8144
  8145
  8146
  8147* EXEC CICS READ
  8148*        DATASET   (REIN-FILE-ID)
  8149*        SET       (ADDRESS OF REINSURANCE-RECORD)
  8150*        RIDFLD    (REIN-KEY)
  8151*    END-EXEC.
  8152*    MOVE '&"S        E          (   #00007598' TO DFHEIV0
  8153     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8154     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8155     MOVE X'2020233030303037353938' TO DFHEIV0(25:11)
  8156     CALL 'kxdfhei1' USING DFHEIV0,
  8157           REIN-FILE-ID,
  8158           DFHEIV20,
  8159           DFHEIV99,
  8160           REIN-KEY,
  8161           DFHEIV99,
  8162           DFHEIV99,
  8163           DFHEIV99
  8164     SET ADDRESS OF REINSURANCE-RECORD TO
  8165         DFHEIV20
  8166     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8167
  8168
  8169     GO TO 4410-CHECK-AGENTS.
  8170
  8171 4180-REIN-ERROR.
  8172     MOVE -1                     TO REINTABL.
  8173     MOVE AL-UABON               TO REINTABA.
  8174     MOVE ER-2615                TO EMI-ERROR.
  8175     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8176
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 157
* EL6501.cbl
  8178 4410-CHECK-AGENTS.
  8179     MOVE PI-COMPANY-CD          TO COMM-COMP-CD.
  8180     SET M-INDEX TO 1.
  8181
  8182     IF PI-COMPANY-ID = 'NCL'
  8183       IF AGENTL (M-INDEX) GREATER ZEROS
  8184         MOVE PI-ACCT-ACCOUNT    TO AGENT  (M-INDEX).
  8185
  8186 4420-LOOP.
  8187     IF AGENTL (M-INDEX) NOT GREATER ZEROS
  8188        IF (ATYPEL (M-INDEX)  GREATER ZEROS AND
  8189            ATYPE  (M-INDEX) NOT = SPACES)  OR
  8190           SINGLEL (M-INDEX) GREATER ZEROS  OR
  8191           JOINTL  (M-INDEX) GREATER ZEROS  OR
  8192           A-HL    (M-INDEX) GREATER ZEROS  OR
  8193           RECALL  (M-INDEX) GREATER ZEROS  OR
  8194           RCOMML  (M-INDEX) GREATER ZEROS  OR
  8195           CHGBCKL (M-INDEX) GREATER ZEROS  OR
  8196           GLCODEL (M-INDEX) GREATER ZEROS
  8197           MOVE ER-2172          TO EMI-ERROR
  8198           MOVE -1               TO AGENTL (M-INDEX)
  8199           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8200           GO TO 4450-BUMP-INDEX
  8201        ELSE
  8202           GO TO 4450-BUMP-INDEX.
  8203
  8204     IF AGENT (M-INDEX) = ZEROS
  8205         MOVE ER-2970            TO  EMI-ERROR
  8206         MOVE -1                 TO  AGENTL (M-INDEX)
  8207         MOVE AL-UABON           TO  AGENTA (M-INDEX)
  8208         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8209         GO TO 4450-BUMP-INDEX.
  8210
  8211     IF ATYPEL (M-INDEX) = ZEROS
  8212        MOVE -1                  TO ATYPEL (M-INDEX)
  8213        MOVE ER-2173             TO EMI-ERROR
  8214        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8215        GO TO 4430-CHECK-SINGLE.
  8216
  8217     IF ATYPE (M-INDEX) = 'C'
  8218        ADD 1                    TO WS-ACCOUNT-CTR-C
  8219       ELSE
  8220        IF ATYPE (M-INDEX) = 'R'
  8221           ADD 1                 TO WS-ACCOUNT-CTR-R
  8222          ELSE
  8223           IF ATYPE (M-INDEX) = 'D'
  8224              ADD 1                 TO WS-ACCOUNT-CTR-D
  8225             ELSE
  8226              IF ATYPE (M-INDEX) = 'O' OR 'P' OR 'T' OR 'W'
  8227                                OR 'B' OR 'I' OR 'K' OR 'L'
  8228                                OR 'J' OR 'M' OR 'A' OR 'N'
  8229                                OR 'S'
  8230                 NEXT SENTENCE
  8231                ELSE
  8232                 IF ATYPE (M-INDEX) = SPACES
  8233                    NEXT SENTENCE
  8234                   ELSE
  8235                    MOVE ER-2175       TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 158
* EL6501.cbl
  8236                    MOVE -1            TO ATYPEL (M-INDEX)
  8237                    MOVE AL-UABON      TO ATYPEA (M-INDEX)
  8238                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8239
  8240 4430-CHECK-SINGLE.
  8241     IF SINGLEL (M-INDEX) GREATER ZEROS
  8242        IF SINGLE-COMM-R (M-INDEX) NOT NUMERIC
  8243           MOVE SINGLE-COMM-T (M-INDEX)    TO COMM-TABLE
  8244           MOVE PI-LIFE-OVERRIDE-L1        TO COMM-LF-AH
  8245           MOVE LOW-VALUES                 TO COMM-FILLER
  8246           PERFORM 6400-READ-COMMISSION THRU 6459-EXIT
  8247           IF COMMISSION-ERROR
  8248              MOVE AL-UABON      TO SINGLEA (M-INDEX)
  8249              MOVE -1            TO SINGLEL (M-INDEX)
  8250           ELSE
  8251            IF WS-TABLE-MAX > WS-ST-COMM-CAP-SL
  8252              MOVE -1            TO MAINTL
  8253              MOVE ER-1884       TO EMI-ERROR
  8254              PERFORM 9900-ERROR-FORMAT
  8255                                 THRU 9900-EXIT
  8256            END-IF
  8257           END-IF
  8258        END-IF
  8259     END-IF
  8260
  8261     IF JOINTL (M-INDEX) GREATER ZEROS
  8262        IF JOINT-COMM-R (M-INDEX) NOT NUMERIC
  8263           MOVE JOINT-COMM-T (M-INDEX)     TO COMM-TABLE
  8264           MOVE PI-LIFE-OVERRIDE-L1        TO COMM-LF-AH
  8265           MOVE LOW-VALUES                 TO COMM-FILLER
  8266           PERFORM 6400-READ-COMMISSION THRU 6459-EXIT
  8267           IF COMMISSION-ERROR
  8268              MOVE AL-UABON      TO JOINTA (M-INDEX)
  8269              MOVE -1            TO JOINTL (M-INDEX)
  8270           ELSE
  8271            IF WS-TABLE-MAX > WS-ST-COMM-CAP-JL
  8272              MOVE -1            TO MAINTL
  8273              MOVE ER-1885       TO EMI-ERROR
  8274              PERFORM 9900-ERROR-FORMAT
  8275                                 THRU 9900-EXIT
  8276            END-IF
  8277           END-IF
  8278        END-IF
  8279     END-IF
  8280
  8281     IF A-HL (M-INDEX) GREATER ZEROS
  8282        IF A-H-COMM-R (M-INDEX)  NOT NUMERIC
  8283           MOVE A-H-COMM-T (M-INDEX)      TO COMM-TABLE
  8284           MOVE PI-AH-OVERRIDE-L1         TO COMM-LF-AH
  8285           MOVE LOW-VALUES                 TO COMM-FILLER
  8286           PERFORM 6400-READ-COMMISSION THRU 6459-EXIT
  8287           IF COMMISSION-ERROR
  8288              MOVE AL-UABON      TO A-HA (M-INDEX)
  8289              MOVE -1            TO A-HL (M-INDEX)
  8290           ELSE
  8291            IF WS-TABLE-MAX > WS-ST-COMM-CAP-SA
  8292              MOVE -1            TO MAINTL
  8293              MOVE ER-1886       TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 159
* EL6501.cbl
  8294              PERFORM 9900-ERROR-FORMAT
  8295                                 THRU 9900-EXIT
  8296            END-IF
  8297           END-IF
  8298        END-IF
  8299     END-IF
  8300
  8301     IF RECALL (M-INDEX) GREATER ZEROS
  8302         IF RECAL (M-INDEX) = 'Y' OR 'N' OR '1' OR SPACE
  8303             MOVE AL-UANON       TO RECALA (M-INDEX)
  8304         ELSE
  8305             MOVE -1             TO RECALL (M-INDEX)
  8306             MOVE AL-UABON       TO RECALA (M-INDEX)
  8307             MOVE ER-2158        TO EMI-ERROR
  8308             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8309
  8310     IF RCOMML (M-INDEX) GREATER ZEROS
  8311         IF RCOMM (M-INDEX) = 'Y' OR 'N' OR 'A' OR SPACE
  8312             MOVE AL-UANON       TO RCOMMA (M-INDEX)
  8313         ELSE
  8314             MOVE -1             TO RCOMML (M-INDEX)
  8315             MOVE AL-UABON       TO RCOMMA (M-INDEX)
  8316             MOVE ER-0625        TO EMI-ERROR
  8317             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8318
  8319     IF  CHGBCKL (M-INDEX)  GREATER THAN  ZEROS
  8320         IF  CHGBCK (M-INDEX)    NUMERIC
  8321             MOVE  AL-UNNON        TO  CHGBCKA (M-INDEX)
  8322         ELSE
  8323             MOVE  -1              TO  CHGBCKL (M-INDEX)
  8324             MOVE  AL-UNBON        TO  CHGBCKA (M-INDEX)
  8325             MOVE  ER-0759         TO  EMI-ERROR
  8326             PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
  8327
  8328     IF  GLCODEL (M-INDEX)  GREATER THAN  ZEROS
  8329         IF  GLCODE (M-INDEX)    NUMERIC
  8330             MOVE  AL-UNNON        TO  GLCODEA (M-INDEX)
  8331         ELSE
  8332             MOVE  -1              TO  GLCODEL (M-INDEX)
  8333             MOVE  AL-UNBON        TO  GLCODEA (M-INDEX)
  8334             MOVE  ER-0759         TO  EMI-ERROR
  8335             PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
  8336
  8337     IF ATYPE (M-INDEX) NOT = 'C' AND 'D' AND 'O' AND 'P'
  8338        AND 'J'
  8339         GO TO 4450-BUMP-INDEX.
  8340
  8341     IF SINGLE-COMM-R (M-INDEX) NUMERIC
  8342         ADD SINGLE-COMM-R (M-INDEX) TO COMM-SL-ACCUM.
  8343
  8344     IF JOINT-COMM-R (M-INDEX) NUMERIC
  8345         ADD JOINT-COMM-R (M-INDEX)  TO COMM-JL-ACCUM.
  8346
  8347     IF A-H-COMM-R (M-INDEX) NUMERIC
  8348        ADD A-H-COMM-R (M-INDEX)    TO COMM-AH-ACCUM
  8349     END-IF
  8350     .
  8351 4450-BUMP-INDEX.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 160
* EL6501.cbl
  8352     SET M-INDEX UP BY 1.
  8353
  8354     IF M-INDEX NOT = 11
  8355        GO TO 4420-LOOP.
  8356
  8357     IF WS-ACCOUNT-CTR-C = ZEROS AND
  8358        WS-ACCOUNT-CTR-D = ZEROS AND
  8359        WS-ACCOUNT-CTR-R = ZEROS
  8360          MOVE ER-2177             TO EMI-ERROR
  8361          MOVE -1                  TO AGENTL (1)
  8362          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8363          GO TO 4900-EXIT.
  8364
  8365     IF (WS-ACCOUNT-CTR-C  GREATER 0 AND
  8366         WS-ACCOUNT-CTR-D  GREATER 0) OR
  8367        (WS-ACCOUNT-CTR-R  GREATER 0 AND
  8368         WS-ACCOUNT-CTR-D  GREATER 0)
  8369           MOVE ER-2174             TO EMI-ERROR
  8370           MOVE -1                  TO AGENTL (1)
  8371           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8372           GO TO 4900-EXIT.
  8373
  8374     IF WS-ACCOUNT-CTR-C GREATER 1 OR
  8375        WS-ACCOUNT-CTR-R GREATER 1 OR
  8376        WS-ACCOUNT-CTR-D GREATER 1
  8377          MOVE ER-2182             TO EMI-ERROR
  8378          MOVE -1                  TO AGENTL (1)
  8379          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8380          GO TO 4900-EXIT.
  8381
  8382
  8383     IF WS-ST-COMM-CAP-SL NOT NUMERIC
  8384         MOVE ZEROS        TO WS-ST-COMM-CAP-SL.
  8385
  8386     IF WS-ST-COMM-CAP-SL = ZEROS
  8387        CONTINUE
  8388     ELSE
  8389      IF SINGLE-COMM-R (1) NUMERIC
  8390        IF (WS-LIMIT-TO-ACCOUNT AND
  8391           SINGLE-COMM-R (1) > WS-ST-COMM-CAP-SL)
  8392                       OR
  8393           (NOT WS-LIMIT-TO-ACCOUNT AND
  8394           COMM-SL-ACCUM > WS-ST-COMM-CAP-SL)
  8395           MOVE -1               TO MAINTL
  8396           MOVE ER-1884          TO EMI-ERROR
  8397           PERFORM 9900-ERROR-FORMAT
  8398                                 THRU 9900-EXIT
  8399        END-IF
  8400*     ELSE
  8401*       MOVE PI-COMPANY-CD       TO COMM-COMP-CD
  8402*       MOVE SINGLE-COMM-T (1)   TO COMM-TABLE
  8403*       MOVE PI-LIFE-OVERRIDE-L1 TO COMM-LF-AH
  8404*       MOVE LOW-VALUES          TO COMM-FILLER
  8405*       PERFORM 6400-READ-COMMISSION
  8406*                                THRU 6459-EXIT
  8407*       IF WS-TABLE-MAX > WS-ST-COMM-CAP-SL
  8408*          MOVE -1               TO MAINTL
  8409*          MOVE ER-1884          TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 161
* EL6501.cbl
  8410*          PERFORM 9900-ERROR-FORMAT
  8411*                                THRU 9900-EXIT
  8412*       END-IF
  8413      END-IF
  8414     END-IF
  8415
  8416     IF WS-ST-COMM-CAP-JL NOT NUMERIC
  8417        MOVE ZEROS               TO WS-ST-COMM-CAP-JL
  8418     END-IF
  8419
  8420     IF WS-ST-COMM-CAP-JL = ZEROS
  8421        CONTINUE
  8422     ELSE
  8423        IF JOINT-COMM-R (1) NUMERIC
  8424           IF (WS-LIMIT-TO-ACCOUNT AND
  8425              JOINT-COMM-R (1) > WS-ST-COMM-CAP-JL)
  8426                       OR
  8427              (NOT WS-LIMIT-TO-ACCOUNT AND
  8428               COMM-JL-ACCUM > WS-ST-COMM-CAP-JL)
  8429               MOVE -1           TO MAINTL
  8430               MOVE ER-1885      TO EMI-ERROR
  8431               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8432           END-IF
  8433*       ELSE
  8434*          MOVE PI-COMPANY-CD    TO COMM-COMP-CD
  8435*          MOVE JOINT-COMM-T (1) TO COMM-TABLE
  8436*          MOVE PI-LIFE-OVERRIDE-L1
  8437*                                TO COMM-LF-AH
  8438*          MOVE LOW-VALUES       TO COMM-FILLER
  8439*          PERFORM 6400-READ-COMMISSION
  8440*                                THRU 6459-EXIT
  8441*          IF EXCEEDS-STATE-MAX
  8442*             MOVE ER-1885       TO EMI-ERROR
  8443*             PERFORM 9900-ERROR-FORMAT
  8444*                                THRU 9900-EXIT
  8445*          END-IF
  8446        END-IF
  8447     END-IF
  8448
  8449     IF WS-ST-COMM-CAP-SA NOT NUMERIC
  8450        MOVE ZEROS               TO WS-ST-COMM-CAP-SA
  8451     END-IF
  8452
  8453     IF WS-ST-COMM-CAP-SA = ZEROS
  8454        CONTINUE
  8455     ELSE
  8456        IF A-H-COMM-R (1) NUMERIC
  8457           IF (WS-LIMIT-TO-ACCOUNT AND
  8458              A-H-COMM-R (1) > WS-ST-COMM-CAP-SA)
  8459                           OR
  8460              (NOT WS-LIMIT-TO-ACCOUNT AND
  8461              COMM-AH-ACCUM > WS-ST-COMM-CAP-SA)
  8462              MOVE -1            TO MAINTL
  8463              MOVE ER-1886       TO EMI-ERROR
  8464              PERFORM 9900-ERROR-FORMAT
  8465                                 THRU 9900-EXIT
  8466           END-IF
  8467*       ELSE
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 162
* EL6501.cbl
  8468*          MOVE PI-COMPANY-CD    TO COMM-COMP-CD
  8469*          MOVE A-H-COMM-T (1)   TO COMM-TABLE
  8470*          MOVE PI-AH-OVERRIDE-L1
  8471*                                TO COMM-LF-AH
  8472*          MOVE LOW-VALUES       TO COMM-FILLER
  8473*          PERFORM 6400-READ-COMMISSION
  8474*                                THRU 6459-EXIT
  8475*          IF EXCEEDS-STATE-MAX
  8476*             MOVE ER-1886       TO EMI-ERROR
  8477*             PERFORM 9900-ERROR-FORMAT
  8478*                                THRU 9900-EXIT
  8479*          END-IF
  8480        END-IF
  8481     END-IF
  8482
  8483     IF MAINTI NOT = 'C'
  8484        GO TO 4900-EXIT.
  8485
  8486     IF NOT PI-GA-BILLING
  8487        GO TO 4900-EXIT.
  8488
  8489 4460-CHECK-IF-GA-BILLED.
  8490     PERFORM 6700-BUILD-COMM-WORK THRU 6799-EXIT.
  8491
  8492     MOVE PI-COMM-POINTER        TO LCP-WS-ADDR-COMP
  8493     SET ADDRESS OF COMMISSION-WORK-AREA TO LCP-WS-ADDR-PNTR.
  8494     SET M-INDEX TO +1.
  8495     MOVE +1 TO AXRF-SUB.
  8496
  8497 4470-GA-LOOP.
  8498     IF ((AGENT (M-INDEX) NOT = WK-AM-AGT (AXRF-SUB)  OR
  8499        ATYPE  (M-INDEX) NOT = WK-AM-TYPE (AXRF-SUB)) OR
  8500        SINGLEL (M-INDEX) GREATER ZERO                OR
  8501        JOINTL  (M-INDEX) GREATER ZERO                OR
  8502        A-HL    (M-INDEX) GREATER ZERO                OR
  8503        RCOMML  (M-INDEX) GREATER ZERO                OR
  8504        CHGBCKL (M-INDEX) GREATER ZERO                OR
  8505        GLCODEL (M-INDEX) GREATER ZERO)               AND
  8506        (WK-GA-BILL-DT (AXRF-SUB) NOT = LOW-VALUES AND SPACES)
  8507           MOVE ER-2131   TO EMI-ERROR
  8508           MOVE -1        TO AGENTL (M-INDEX)
  8509           MOVE AL-UABON  TO AGENTA (M-INDEX)
  8510           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8511
  8512     ADD +1 TO AXRF-SUB.
  8513     SET M-INDEX UP BY +1.
  8514
  8515     IF AXRF-SUB NOT = +11
  8516        GO TO 4470-GA-LOOP.
  8517
  8518 4900-EXIT.
  8519      EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 163
* EL6501.cbl
  8521 5000-MOVE-TO-RECORD.
  8522
  8523     IF NAMEL   GREATER THAN ZERO  OR
  8524        INCAREL GREATER THAN ZERO  OR
  8525        ADDR1L  GREATER THAN ZERO  OR
  8526        ACITYL  GREATER THAN ZERO  OR
  8527        ASTATEL GREATER THAN ZERO  OR
  8528        ZIPL    GREATER THAN ZERO  OR
  8529        PHONEL  GREATER THAN ZERO  OR
  8530        TAXNOL  GREATER THAN ZERO
  8531         MOVE '*'                TO AM-PROFILE-CHANGE-SWITCH.
  8532
  8533     IF CSRL GREATER ZEROS
  8534        MOVE CSRI                TO AM-CSR-CODE.
  8535     IF NAMEL GREATER ZEROS
  8536        MOVE NAMEI               TO AM-NAME.
  8537     IF PCONTL GREATER ZEROS
  8538        MOVE PCONTI              TO AM-CONTROL-NAME
  8539     END-IF
  8540     IF INCAREL GREATER ZEROS
  8541        MOVE INCAREI             TO AM-PERSON.
  8542     IF ADDR1L GREATER ZEROS
  8543        MOVE ADDR1I              TO AM-ADDRS.
  8544     IF TAXNOL GREATER ZEROS
  8545        MOVE TAXNOI              TO AM-ID-NO.
  8546     IF PHONEL GREATER ZEROS
  8547        MOVE PHONEI              TO DEEDIT-FIELD
  8548        PERFORM 8600-DEEDIT
  8549        MOVE DEEDIT-FIELD-V0     TO WS-PHONE-NUM
  8550        MOVE WS-PH1              TO AM-AREA-CODE
  8551        MOVE WS-PH2              TO AM-TEL-PRE
  8552        MOVE WS-PH3              TO AM-TEL-NBR.
  8553
  8554     IF ACITYL GREATER ZEROS
  8555        MOVE ACITYI             TO AM-ADDR-CITY.
  8556     IF ASTATEL GREATER ZEROS
  8557        MOVE ASTATEI            TO AM-ADDR-STATE.
  8558
  8559     IF ZIPL NOT GREATER ZEROS
  8560         GO TO 5010-CONT-MOVING.
  8561
  8562     MOVE ZIPI                   TO WS-ZIP-CODE.
  8563
  8564     IF WS-CANADIAN-ZIP
  8565         IF WS-ZIP-4 = SPACE  OR  '-'
  8566             MOVE WS-ZIP-CAN-2-POST1  TO AM-CAN-POSTAL-1
  8567             MOVE WS-ZIP-CAN-2-POST2  TO AM-CAN-POSTAL-2
  8568         ELSE
  8569             MOVE WS-ZIP-CAN-1-POST1  TO AM-CAN-POSTAL-1
  8570             MOVE WS-ZIP-CAN-1-POST2  TO AM-CAN-POSTAL-2
  8571     ELSE
  8572         IF WS-ZIP-6 = SPACE  OR  '-'
  8573             MOVE WS-ZIP-AM-2-CODE    TO AM-ZIP-PRIME
  8574             MOVE WS-ZIP-AM-2-PLUS4   TO AM-ZIP-PLUS4
  8575         ELSE
  8576             MOVE WS-ZIP-AM-1-CODE    TO AM-ZIP-PRIME
  8577             MOVE WS-ZIP-AM-1-PLUS4   TO AM-ZIP-PLUS4.
  8578
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 164
* EL6501.cbl
  8579 5010-CONT-MOVING.
  8580     IF TYPEL GREATER ZEROS
  8581        MOVE TYPEI               TO AM-GPCD.
  8582
  8583     IF STDBENL GREATER ZEROS
  8584        MOVE STDBENI             TO AM-STD-AH-TYPE.
  8585
  8586     IF INDGRPL GREATER ZEROS
  8587        MOVE INDGRPI             TO AM-IG
  8588        INSPECT AM-IG CONVERTING 'IG' TO '12'.
  8589
  8590     IF STATUSL GREATER ZEROS
  8591        MOVE STATUSI             TO AM-STATUS
  8592        INSPECT AM-STATUS CONVERTING 'SFCTIA' TO '543210'
  8593     END-IF
  8594
  8595     IF CLPTOLPL GREATER ZEROS
  8596        MOVE CLPTOLPI            TO AM-CLP-TOL-PCT
  8597     END-IF.
  8598
  8599     IF PRODCDL > 0
  8600        MOVE PRODCDI             TO AM-DCC-PRODUCT-CODE
  8601     END-IF
  8602     IF CLPSTL > 0
  8603        MOVE CLPSTI              TO AM-DCC-CLP-STATE
  8604     END-IF
  8605     IF MAXMFEEL > ZEROS
  8606        MOVE WS-WORK-NUM         TO AM-DCC-MAX-MARKETING-FEE
  8607     END-IF
  8608     IF LCOMML > ZEROS
  8609        MOVE LCOMMI              TO AM-SPP-LEASE-COMM
  8610     END-IF
  8611
  8612     IF REMITL GREATER ZEROS
  8613        MOVE REMITI              TO AM-REMIT-TO.
  8614     IF CONTRL GREATER ZEROS
  8615        MOVE WS-ANVR-DT          TO AM-ANNIVERSARY-DATE.
  8616*    IF PSILFFL GREATER +0
  8617*       MOVE WS-LIFE-PSI         TO AM-LF-PSI-FACTOR.
  8618*    IF PSIAHFL GREATER +0
  8619*       MOVE WS-AH-PSI           TO AM-AH-PSI-FACTOR.
  8620     IF PEFFDTEL GREATER ZEROS
  8621        MOVE WS-PEFF-DT          TO AM-PREV-EFF-DT.
  8622     IF PEXPDTEL GREATER ZEROS
  8623        MOVE WS-PEXP-DT          TO AM-PREV-EXP-DT.
  8624     IF COMMCALL GREATER ZEROS
  8625        MOVE COMMCALI            TO AM-RECALC-COMM
  8626        MOVE '*'                 TO AM-COMM-CHANGE-STATUS
  8627     ELSE
  8628         IF MAINTI = 'A'
  8629             MOVE 'N'            TO AM-RECALC-COMM.
  8630
  8631     IF REINCALL GREATER ZEROS
  8632        MOVE REINCALI            TO AM-RECALC-REIN
  8633     ELSE
  8634         IF MAINTI = 'A'
  8635             MOVE 'N'            TO AM-RECALC-REIN.
  8636
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 165
* EL6501.cbl
  8637     IF REINTABL GREATER ZEROS
  8638        MOVE REINTABI            TO AM-REI-TABLE.
  8639
  8640     IF PI-MAINT = 'A'
  8641        MOVE 'P'                 TO AM-RET-ST-TAX-USE
  8642     END-IF
  8643
  8644     MOVE 1                      TO SUB.
  8645     SET M-INDEX                 TO 1.
  8646
  8647
  8648* EXEC CICS
  8649*         ASKTIME
  8650*    END-EXEC.
  8651*    MOVE '0"                    "   #00008082' TO DFHEIV0
  8652     MOVE X'302220202020202020202020' TO DFHEIV0(1:12)
  8653     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
  8654     MOVE X'2020233030303038303832' TO DFHEIV0(25:11)
  8655     CALL 'kxdfhei1' USING DFHEIV0,
  8656           DFHEIV99
  8657     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8658
  8659
  8660 5000-LOOP.
  8661*    IF PI-COMPANY-ID = 'DCC'
  8662*       IF (M-INDEX = +5)
  8663*          AND ((AGENTL (5) > ZEROS)
  8664*              OR (ATYPEL (5) > ZEROS))
  8665*             MOVE ER-3057         TO EMI-ERROR
  8666*             MOVE -1              TO AGENTL (5)
  8667*             MOVE AL-UABON        TO AGENTA (5)
  8668*             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8669*             GO TO 5000-EXIT
  8670*       END-IF
  8671*    END-IF
  8672     IF MAINTI = 'C'
  8673        IF ((AM-AGT (SUB) NOT = ZEROS AND AGENT (M-INDEX)) AND
  8674           (COMMCALI NOT = 'Y' AND '1')                    AND
  8675            AM-HI-CERT-DATE NOT = ZEROS)                    OR
  8676           ((AM-AGT (SUB) = ZEROS AND
  8677             (AGENT (M-INDEX)) NOT = LOW-VALUES AND SPACES AND
  8678                                     ZEROS) AND
  8679           (COMMCALI NOT = 'Y' AND '1')  AND
  8680            AM-HI-CERT-DATE NOT = ZEROS)
  8681              MOVE ER-2181         TO EMI-ERROR
  8682              MOVE -1              TO COMMCALL
  8683              MOVE AL-UABON        TO COMMCALA
  8684              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8685              GO TO 5000-EXIT.
  8686
  8687     IF MAINTI = 'C'
  8688        IF ((AM-COM-TYP (SUB) NOT = SPACES AND
  8689             ATYPE (M-INDEX)) AND
  8690           (COMMCALI NOT = 'Y' AND '1') AND
  8691            AM-HI-CERT-DATE NOT = ZEROS)
  8692            OR
  8693           ((AM-COM-TYP (SUB) = SPACES AND
  8694             (ATYPE (M-INDEX)) NOT = LOW-VALUES AND SPACES) AND
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 166
* EL6501.cbl
  8695           (COMMCALI NOT = 'Y' AND '1')  AND
  8696            AM-HI-CERT-DATE NOT = ZEROS)
  8697              MOVE ER-2181         TO EMI-ERROR
  8698              MOVE -1              TO COMMCALL
  8699              MOVE AL-UABON        TO COMMCALA
  8700              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8701              GO TO 5000-EXIT.
  8702
  8703     IF AM-ACCOUNT-BILLED
  8704        IF COMMCALI = 'Y' OR '1'
  8705            MOVE ER-2183         TO EMI-ERROR
  8706            MOVE -1              TO COMMCALL
  8707            MOVE AL-UABON        TO COMMCALA
  8708            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8709            GO TO 5000-EXIT.
  8710
  8711     IF (AGENTL (M-INDEX) NOT GREATER ZEROS AND
  8712        ATYPEL  (M-INDEX) NOT GREATER ZEROS)
  8713        OR
  8714        ((AGENT (M-INDEX) = ZEROS OR SPACES) AND
  8715         ATYPE  (M-INDEX) = SPACES)
  8716           MOVE ZEROS              TO AM-AGT   (SUB)
  8717                                      AM-L-COM (SUB)
  8718                                      AM-J-COM (SUB)
  8719                                      AM-A-COM (SUB)
  8720           MOVE SPACE TO AM-COM-TYP (SUB)
  8721           SET M-INDEX UP BY 1
  8722           ADD 1 TO SUB
  8723           IF SUB = 11
  8724              GO TO 5000-CHECK-MAX-FEES
  8725            ELSE
  8726              GO TO 5000-LOOP.
  8727
  8728     MOVE AGENT (M-INDEX)        TO AM-AGT (SUB).
  8729     MOVE ATYPE (M-INDEX)        TO AM-COM-TYP (SUB).
  8730
  8731     IF SINGLEL (M-INDEX) GREATER ZEROS
  8732        MOVE '*'                 TO AM-COMM-CHANGE-STATUS
  8733        IF SINGLE-COMM-R (M-INDEX) NOT NUMERIC
  8734           MOVE SINGLE-COMM-T (M-INDEX) TO AM-L-COMA (SUB)
  8735          ELSE
  8736           MOVE SINGLE-COMM-R (M-INDEX) TO AM-L-COM  (SUB)
  8737           IF SINGLE-DASH (M-INDEX) = '-'
  8738               MULTIPLY AM-L-COM (SUB) BY -1
  8739                     GIVING AM-L-COM (SUB).
  8740
  8741     IF JOINTL (M-INDEX) GREATER ZEROS
  8742        MOVE '*'                 TO AM-COMM-CHANGE-STATUS
  8743        IF JOINT-COMM-R (M-INDEX) NOT NUMERIC
  8744           MOVE JOINT-COMM-T (M-INDEX)  TO AM-J-COMA (SUB)
  8745          ELSE
  8746           MOVE JOINT-COMM-R (M-INDEX)  TO AM-J-COM (SUB)
  8747           IF JOINT-DASH (M-INDEX) = '-'
  8748               MULTIPLY AM-J-COM (SUB) BY -1
  8749                     GIVING AM-J-COM (SUB).
  8750
  8751     IF A-HL (M-INDEX) GREATER ZEROS
  8752        MOVE '*'                 TO AM-COMM-CHANGE-STATUS
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 167
* EL6501.cbl
  8753        IF A-H-COMM-R (M-INDEX) NOT NUMERIC
  8754           MOVE A-H-COMM-T (M-INDEX)  TO AM-A-COMA (SUB)
  8755          ELSE
  8756           MOVE A-H-COMM-R (M-INDEX)  TO AM-A-COM (SUB)
  8757           IF A-H-DASH (M-INDEX) = '-'
  8758               MULTIPLY AM-A-COM (SUB) BY -1
  8759                     GIVING AM-A-COM (SUB).
  8760
  8761     IF RECALL (M-INDEX) GREATER ZEROS
  8762         MOVE RECAL  (M-INDEX)   TO AM-RECALC-LV-INDIC (SUB).
  8763
  8764     IF RCOMML (M-INDEX) GREATER ZEROS
  8765         MOVE RCOMM  (M-INDEX)   TO AM-RETRO-LV-INDIC (SUB).
  8766
  8767     IF CHGBCKL (M-INDEX) GREATER ZEROS
  8768         MOVE CHGBCK (M-INDEX)   TO AM-COMM-CHARGEBACK (SUB).
  8769
  8770     IF GLCODEL (M-INDEX) GREATER ZEROS
  8771         MOVE GLCODE (M-INDEX)   TO AM-GL-CODES (SUB).
  8772
  8773     SET M-INDEX UP BY 1.
  8774     ADD 1 TO SUB.
  8775     IF M-INDEX NOT = 11
  8776        GO TO 5000-LOOP.
  8777
  8778 5000-CHECK-MAX-FEES.
  8779     IF (AM-DCC-PRODUCT-CODE = 'DDF')
  8780        MOVE +1                     TO S1
  8781        PERFORM UNTIL S1 > +10
  8782           IF (AM-A-COM (S1) NUMERIC)
  8783              AND (AM-A-COMA (S1) (3:1) NOT = 'L' AND 'M'
  8784                     AND 'O')
  8785              AND (AM-COM-TYP (S1) = 'J')
  8786                 COMPUTE COMM-MFEE-ACCUM = COMM-MFEE-ACCUM
  8787                    + (AM-A-COM (S1) * +1000)
  8788           END-IF
  8789           ADD +1             TO S1
  8790        END-PERFORM
  8791        IF COMM-MFEE-ACCUM > AM-DCC-MAX-MARKETING-FEE
  8792           MOVE -1               TO MAXMFEEL
  8793           MOVE AL-UABON         TO MAXMFEEA
  8794           MOVE ER-1817          TO EMI-ERROR
  8795           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8796        END-IF
  8797     END-IF
  8798     .
  8799 5000-EXIT.
  8800      EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 168
* EL6501.cbl
  8802
  8803 5100-WRITE-TS.
  8804     PERFORM 6500-READ-ACCT THRU 6599-EXIT.
  8805
  8806     IF PI-ZERO-CARRIER OR PI-ZERO-CAR-GROUP
  8807         MOVE ZEROS              TO PI-CR-CARRIER
  8808     ELSE
  8809         MOVE AM-CARRIER         TO PI-CR-CARRIER.
  8810
  8811     IF PI-ZERO-GROUPING OR PI-ZERO-CAR-GROUP
  8812         MOVE ZEROS              TO PI-CR-GROUPING
  8813     ELSE
  8814         MOVE AM-GROUPING        TO PI-CR-GROUPING.
  8815
  8816     IF AM-REMIT-TO NOT = ZERO
  8817         MOVE AM-AGT (AM-REMIT-TO)
  8818                                 TO PI-CR-FIN-RESP
  8819       ELSE
  8820         MOVE AM-ACCOUNT         TO PI-CR-FIN-RESP.
  8821
  8822     MOVE 'A'                    TO PI-CR-TYPE.
  8823 5110-AGT-LOOP.
  8824     ADD 1                       TO  AGT-SUB.
  8825     IF AGT-SUB GREATER 10
  8826         MOVE LOW-VALUES         TO PI-CR-CONTROL-IN-PROGRESS
  8827         GO TO 5120-WRITE.
  8828
  8829************************************************************
  8830**  MODIFICATION MADE TO ADD SERVICE FEES                 **
  8831************************************************************
  8832
  8833     IF AM-COM-TYP (AGT-SUB) = 'C' OR 'D' OR 'R'
  8834                  OR 'F' OR 'U'
  8835         MOVE AM-AGT (AGT-SUB)   TO  PI-CR-ACCOUNT
  8836         GO TO 5120-WRITE
  8837     ELSE
  8838         GO TO 5110-AGT-LOOP.
  8839
  8840 5120-WRITE.
  8841
  8842* EXEC CICS WRITEQ TS
  8843*         QUEUE    (QID)
  8844*         FROM     (PROGRAM-INTERFACE-BLOCK)
  8845*         LENGTH   (WS-COMM-LENGTH)
  8846*         ITEM     (W-ONE)
  8847*    END-EXEC.
  8848*    MOVE '*" I                  ''   #00008267' TO DFHEIV0
  8849     MOVE X'2A2220492020202020202020' TO DFHEIV0(1:12)
  8850     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8851     MOVE X'2020233030303038323637' TO DFHEIV0(25:11)
  8852     CALL 'kxdfhei1' USING DFHEIV0,
  8853           QID,
  8854           PROGRAM-INTERFACE-BLOCK,
  8855           WS-COMM-LENGTH,
  8856           W-ONE,
  8857           DFHEIV99,
  8858           DFHEIV99
  8859     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 169
* EL6501.cbl
  8860
  8861
  8862 5199-EXIT.
  8863     EXIT.
  8864
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 170
* EL6501.cbl
  8866
  8867 5200-RECOVER-TS.
  8868
  8869     IF PI-CALLING-PROGRAM NOT = XCTL-652 AND
  8870                                 XCTL-653 AND
  8871                                 XCTL-689 AND
  8872                                 XCTL-608 AND
  8873                                 XCTL-690
  8874         GO TO 5299-EXIT.
  8875
  8876
  8877* EXEC CICS HANDLE CONDITION
  8878*        QIDERR  (5250-QID-ERROR)
  8879*    END-EXEC.
  8880*    MOVE '"$N                   ! , #00008288' TO DFHEIV0
  8881     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  8882     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8883     MOVE X'2C20233030303038323838' TO DFHEIV0(25:11)
  8884     CALL 'kxdfhei1' USING DFHEIV0
  8885     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8886
  8887
  8888
  8889* EXEC CICS READQ TS
  8890*        QUEUE    (QID)
  8891*        INTO     (PROGRAM-INTERFACE-BLOCK)
  8892*        LENGTH   (WS-COMM-LENGTH)
  8893*        ITEM     (W-ONE)
  8894*    END-EXEC.
  8895*    MOVE '*$II   L              ''   #00008292' TO DFHEIV0
  8896     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  8897     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8898     MOVE X'2020233030303038323932' TO DFHEIV0(25:11)
  8899     CALL 'kxdfhei1' USING DFHEIV0,
  8900           QID,
  8901           PROGRAM-INTERFACE-BLOCK,
  8902           WS-COMM-LENGTH,
  8903           W-ONE,
  8904           DFHEIV99,
  8905           DFHEIV99
  8906     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8907
  8908
  8909 5200-DELETE-TS.
  8910
  8911
  8912* EXEC CICS DELETEQ TS
  8913*        QUEUE    (QID)
  8914*    END-EXEC.
  8915*    MOVE '*&                    #   #00008301' TO DFHEIV0
  8916     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  8917     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8918     MOVE X'2020233030303038333031' TO DFHEIV0(25:11)
  8919     CALL 'kxdfhei1' USING DFHEIV0,
  8920           QID,
  8921           DFHEIV99
  8922     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8923
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 171
* EL6501.cbl
  8924
  8925     GO TO 5299-EXIT.
  8926
  8927 5250-QID-ERROR.
  8928     MOVE ER-0033                TO  EMI-ERROR.
  8929     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  8930
  8931 5299-EXIT.
  8932     EXIT.
  8933
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 172
* EL6501.cbl
  8935
  8936 5300-UPDATE-REQUEST-FILE.
  8937     MOVE +0                     TO SUB1.
  8938
  8939 5300-FIND-ACCOUNT-AGENT.
  8940     ADD +1                      TO SUB1.
  8941
  8942     IF SUB1 GREATER THAN +10
  8943        MOVE ER-2949             TO EMI-ERROR
  8944        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8945        MOVE -1                  TO AGENTL (1)
  8946
  8947* EXEC CICS SYNCPOINT ROLLBACK
  8948*       END-EXEC
  8949*    MOVE '6"R                   !   #00008326' TO DFHEIV0
  8950     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
  8951     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8952     MOVE X'2020233030303038333236' TO DFHEIV0(25:11)
  8953     CALL 'kxdfhei1' USING DFHEIV0
  8954     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8955        GO TO 8200-SEND-DATAONLY.
  8956
  8957     MOVE SAVE-ACCT-AGENT      TO SAVE-NEW-ACCT-AGENT.
  8958
  8959************************************************************
  8960**  MODIFICATION MADE TO ADD SERVICE FEES                 **
  8961************************************************************
  8962
  8963     IF AM-COM-TYP  (SUB1) = 'C' OR 'D' OR 'F'
  8964        IF AM-AGT   (SUB1) NOT = SAVE-ACCT-AGENT
  8965           MOVE AM-AGT (SUB1)  TO SAVE-NEW-ACCT-AGENT.
  8966
  8967     IF AM-AGT (AM-REMIT-TO) NOT = SAVE-FIN-RESP
  8968        GO TO 5325-PROCESS-RQST-FILE.
  8969
  8970     IF SAVE-ACCT-AGENT NOT = SAVE-NEW-ACCT-AGENT
  8971        GO TO 5325-PROCESS-RQST-FILE.
  8972
  8973     GO TO 5399-EXIT.
  8974
  8975 5325-PROCESS-RQST-FILE.
  8976     MOVE LOW-VALUES             TO RQST3-KEY.
  8977     MOVE AM-COMPANY-CD          TO RQST3-COMPANY-CD.
  8978     MOVE AM-CARRIER             TO RQST3-CARRIER.
  8979     MOVE AM-GROUPING            TO RQST3-GROUPING.
  8980     MOVE SAVE-FIN-RESP          TO RQST3-FIN-RESP.
  8981     MOVE SAVE-ACCT-AGENT        TO RQST3-ACCT-AGENT.
  8982
  8983
  8984* EXEC CICS HANDLE CONDITION
  8985*        NOTFND(5399-EXIT)
  8986*        ENDFILE(5399-EXIT)
  8987*    END-EXEC.
  8988*    MOVE '"$I''                  ! - #00008356' TO DFHEIV0
  8989     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8990     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8991     MOVE X'2D20233030303038333536' TO DFHEIV0(25:11)
  8992     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 173
* EL6501.cbl
  8993     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8994
  8995
  8996 5325-PROCESS-REQUEST-FILE.
  8997
  8998* EXEC CICS STARTBR
  8999*         DATASET   (RQST3-FILE-ID)
  9000*         RIDFLD    (RQST3-KEY)
  9001*    END-EXEC.
  9002     MOVE 0
  9003       TO DFHEIV11
  9004*    MOVE '&,         G          &   #00008362' TO DFHEIV0
  9005     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9006     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9007     MOVE X'2020233030303038333632' TO DFHEIV0(25:11)
  9008     CALL 'kxdfhei1' USING DFHEIV0,
  9009           RQST3-FILE-ID,
  9010           RQST3-KEY,
  9011           DFHEIV99,
  9012           DFHEIV11,
  9013           DFHEIV99
  9014     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9015
  9016
  9017 5330-READNEXT-REQUEST.
  9018
  9019* EXEC CICS READNEXT
  9020*        SET    (ADDRESS OF AR-REQUEST-RECORD)
  9021*        DATASET(RQST3-FILE-ID)
  9022*        RIDFLD (RQST3-KEY)
  9023*    END-EXEC.
  9024     MOVE 0
  9025       TO DFHEIV11
  9026*    MOVE '&.S                   )   #00008368' TO DFHEIV0
  9027     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9028     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  9029     MOVE X'2020233030303038333638' TO DFHEIV0(25:11)
  9030     CALL 'kxdfhei1' USING DFHEIV0,
  9031           RQST3-FILE-ID,
  9032           DFHEIV20,
  9033           DFHEIV99,
  9034           RQST3-KEY,
  9035           DFHEIV99,
  9036           DFHEIV11,
  9037           DFHEIV99,
  9038           DFHEIV99
  9039     SET ADDRESS OF AR-REQUEST-RECORD TO
  9040         DFHEIV20
  9041     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9042
  9043
  9044     IF RQST3-KEY = SAVE-RQST3-KEY
  9045        GO TO 5330-READNEXT-REQUEST.
  9046
  9047     MOVE RQST3-KEY              TO SAVE-RQST3-KEY.
  9048
  9049     IF RQ-COMPANY-CD-A2 NOT = PI-COMPANY-CD
  9050        GO TO 5350-REQUESTS-FINISHED.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 174
* EL6501.cbl
  9051
  9052     IF RQ-FIN-RESP-A2 NOT = SAVE-FIN-RESP
  9053        GO TO 5350-REQUESTS-FINISHED.
  9054
  9055     IF RQ-ACCT-AGENT-A2 NOT = SAVE-ACCT-AGENT
  9056        GO TO 5350-REQUESTS-FINISHED.
  9057
  9058     MOVE RQ-CONTROL-PRIMARY     TO RQST-KEY.
  9059
  9060
  9061* EXEC CICS ENDBR
  9062*        DATASET(RQST3-FILE-ID)
  9063*    END-EXEC.
  9064     MOVE 0
  9065       TO DFHEIV11
  9066*    MOVE '&2                    $   #00008390' TO DFHEIV0
  9067     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9068     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9069     MOVE X'2020233030303038333930' TO DFHEIV0(25:11)
  9070     CALL 'kxdfhei1' USING DFHEIV0,
  9071           RQST3-FILE-ID,
  9072           DFHEIV11,
  9073           DFHEIV99
  9074     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9075
  9076
  9077
  9078* EXEC CICS READ
  9079*        SET    (ADDRESS OF AR-REQUEST-RECORD)
  9080*        DATASET(RQST-FILE-ID)
  9081*        RIDFLD (RQST-KEY)
  9082*        UPDATE
  9083*    END-EXEC.
  9084*    MOVE '&"S        EU         (   #00008394' TO DFHEIV0
  9085     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9086     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9087     MOVE X'2020233030303038333934' TO DFHEIV0(25:11)
  9088     CALL 'kxdfhei1' USING DFHEIV0,
  9089           RQST-FILE-ID,
  9090           DFHEIV20,
  9091           DFHEIV99,
  9092           RQST-KEY,
  9093           DFHEIV99,
  9094           DFHEIV99,
  9095           DFHEIV99
  9096     SET ADDRESS OF AR-REQUEST-RECORD TO
  9097         DFHEIV20
  9098     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9099
  9100
  9101     MOVE AM-AGT (AM-REMIT-TO)   TO RQ-FIN-RESP-A2.
  9102     MOVE SAVE-NEW-ACCT-AGENT    TO RQ-ACCT-AGENT-A2.
  9103
  9104
  9105* EXEC CICS REWRITE
  9106*        DATASET   (RQST-FILE-ID)
  9107*        FROM      (AR-REQUEST-RECORD)
  9108*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 175
* EL6501.cbl
  9109     MOVE LENGTH OF
  9110      AR-REQUEST-RECORD
  9111       TO DFHEIV11
  9112*    MOVE '&& L                  %   #00008404' TO DFHEIV0
  9113     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9114     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9115     MOVE X'2020233030303038343034' TO DFHEIV0(25:11)
  9116     CALL 'kxdfhei1' USING DFHEIV0,
  9117           RQST-FILE-ID,
  9118           AR-REQUEST-RECORD,
  9119           DFHEIV11,
  9120           DFHEIV99
  9121     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9122
  9123
  9124     GO TO  5325-PROCESS-REQUEST-FILE.
  9125
  9126 5350-REQUESTS-FINISHED.
  9127
  9128* EXEC CICS ENDBR
  9129*        DATASET(RQST3-FILE-ID)
  9130*    END-EXEC.
  9131     MOVE 0
  9132       TO DFHEIV11
  9133*    MOVE '&2                    $   #00008412' TO DFHEIV0
  9134     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9135     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9136     MOVE X'2020233030303038343132' TO DFHEIV0(25:11)
  9137     CALL 'kxdfhei1' USING DFHEIV0,
  9138           RQST3-FILE-ID,
  9139           DFHEIV11,
  9140           DFHEIV99
  9141     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9142
  9143
  9144 5399-EXIT.
  9145     EXIT.
  9146
  9147
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 176
* EL6501.cbl
  9149
  9150 6000-MOVE-TO-SCREEN.
  9151     PERFORM 8000-STATE-REC-READ   THRU 8010-EXIT.
  9152
  9153     MOVE AM-LAST-MAINT-USER     TO MAINTBYO.
  9154     MOVE AM-NAME                TO NAMEO.
  9155     MOVE AM-CONTROL-NAME        TO PCONTO.
  9156     MOVE AM-CSR-CODE            TO CSRO.
  9157     MOVE AM-PERSON              TO INCAREO.
  9158     MOVE AM-ADDRS               TO ADDR1O.
  9159     MOVE AM-ID-NO               TO TAXNOO.
  9160     MOVE AM-TEL-NO              TO WS-PHONE.
  9161     MOVE WS-PHONE-NUM           TO PHONEO.
  9162     INSPECT PHONEI CONVERTING SPACES TO '-'.
  9163     MOVE AM-ADDR-CITY           TO ACITYO
  9164     MOVE AM-ADDR-STATE          TO ASTATEO
  9165
  9166     MOVE SPACES                 TO WS-ZIP-CODE.
  9167     IF AM-CANADIAN-POST-CODE
  9168         MOVE AM-CAN-POSTAL-1    TO WS-ZIP-CAN-2-POST1
  9169         MOVE AM-CAN-POSTAL-2    TO WS-ZIP-CAN-2-POST2
  9170     ELSE
  9171         MOVE AM-ZIP-PRIME       TO WS-ZIP-AM-2-CODE
  9172         IF AM-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
  9173             MOVE '-'            TO WS-ZIP-AM-2-DASH
  9174             MOVE AM-ZIP-PLUS4   TO WS-ZIP-AM-2-PLUS4.
  9175
  9176     MOVE WS-ZIP-CODE            TO ZIPO.
  9177
  9178     MOVE AM-GPCD                TO TYPEO.
  9179     MOVE AM-STD-AH-TYPE         TO STDBENO.
  9180
  9181     MOVE AM-IG                  TO INDGRPO.
  9182     INSPECT INDGRPO CONVERTING '12' TO 'IG'.
  9183
  9184     MOVE AM-STATUS              TO STATUSO.
  9185     INSPECT STATUSO CONVERTING '543210' TO 'SFCTIA'
  9186
  9187     MOVE AM-REMIT-TO            TO REMITO.
  9188
  9189     IF PI-AR-PROCESSING
  9190        IF AM-AR-HI-CERT-DATE = LOW-VALUES
  9191           MOVE AL-UNNON         TO REMITA
  9192        ELSE
  9193           MOVE AL-SANON         TO REMITA
  9194     ELSE
  9195        MOVE AL-UNNON            TO REMITA.
  9196
  9197***  Y2K PROJ 7744
  9198     MOVE AM-ANNIVERSARY-DATE    TO DC-GREG-DATE-1-YMD.
  9199     MOVE '3'                    TO DC-OPTION-CODE.
  9200     PERFORM 9700-DATE-LINK.
  9201     IF DATE-CONVERSION-ERROR
  9202        MOVE SPACES              TO CONTRO
  9203     ELSE
  9204        MOVE DC-GREG-DATE-1-EDIT TO CONTRO
  9205     END-IF.
  9206***  Y2K PROJ 7744
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 177
* EL6501.cbl
  9207
  9208*    MOVE PI-LIFE-OVERRIDE-L6    TO PSILFTO
  9209*    MOVE PI-AH-OVERRIDE-L6      TO PSIAHTO.
  9210
  9211*    IF AM-LF-PSI-FACTOR NUMERIC
  9212*       MOVE AM-LF-PSI-FACTOR    TO PSILFFO.
  9213*
  9214*    IF AM-AH-PSI-FACTOR NUMERIC
  9215*       MOVE AM-AH-PSI-FACTOR    TO PSIAHFO.
  9216
  9217     MOVE AM-RECALC-COMM         TO COMMCALO.
  9218     MOVE AL-UANON               TO COMMCALA.
  9219     MOVE AM-RECALC-REIN         TO REINCALO.
  9220     MOVE AM-REI-TABLE           TO REINTABO.
  9221     MOVE AM-1ST-PROD-DATE       TO DC-GREG-DATE-1-YMD.
  9222     MOVE '3'                    TO DC-OPTION-CODE.
  9223     PERFORM 9700-DATE-LINK.
  9224     IF DATE-CONVERSION-ERROR
  9225        MOVE SPACES              TO PRODATEO
  9226     ELSE
  9227        MOVE DC-GREG-DATE-1-EDIT TO PRODATEO.
  9228
  9229     IF PI-COMPANY-ID = 'DCC'
  9230        IF AM-CLP-TOL-PCT NOT NUMERIC
  9231           MOVE ZEROS            TO AM-CLP-TOL-PCT
  9232        END-IF
  9233        IF AM-SPP-LEASE-COMM NOT NUMERIC
  9234           MOVE ZEROS            TO AM-SPP-LEASE-COMM
  9235        END-IF
  9236        MOVE AM-CLP-TOL-PCT      TO CLPTOLPO
  9237        MOVE AM-SPP-LEASE-COMM   TO LCOMMO
  9238        MOVE AM-DCC-PRODUCT-CODE TO PRODCDO
  9239        MOVE AM-DCC-CLP-STATE    TO CLPSTO
  9240        MOVE AL-UANON            TO CLPSTA
  9241        IF AM-DCC-MAX-MARKETING-FEE NOT NUMERIC
  9242           MOVE ZEROS            TO AM-DCC-MAX-MARKETING-FEE
  9243        END-IF
  9244        MOVE AM-DCC-MAX-MARKETING-FEE
  9245                                 TO MAXMFEEO
  9246     ELSE
  9247        MOVE AL-SADOF            TO CTPLABLA
  9248                                    CLPTOLPA
  9249                                    LCLABLA
  9250                                    LCOMMA
  9251     END-IF
  9252
  9253     IF AM-RET-Y-N = ' '  OR  'N'
  9254         MOVE 'NO '              TO RETROCDO
  9255     ELSE
  9256         MOVE 'YES'              TO RETROCDO.
  9257
  9258     IF AM-ACCOUNT-BILLED
  9259         MOVE 'YES'              TO BILLCDO
  9260     ELSE
  9261         MOVE 'NO '              TO BILLCDO.
  9262
  9263     MOVE AL-UANON               TO RETROCDA.
  9264     MOVE AL-SANON               TO PRODATEA
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 178
* EL6501.cbl
  9265                                    BILLCDA.
  9266     MOVE AM-PREV-EFF-DT TO DC-GREG-DATE-1-YMD.
  9267     MOVE '3' TO DC-OPTION-CODE.
  9268     PERFORM 9700-DATE-LINK.
  9269     IF DATE-CONVERSION-ERROR
  9270        MOVE SPACES TO PEFFDTEO
  9271     ELSE
  9272        MOVE DC-GREG-DATE-1-EDIT TO PEFFDTEO.
  9273
  9274     IF AM-PREV-EXP-DT NOT = 99999999999
  9275        MOVE AM-PREV-EXP-DT TO DC-GREG-DATE-1-YMD
  9276        MOVE '3' TO DC-OPTION-CODE
  9277        PERFORM 9700-DATE-LINK
  9278        IF DATE-CONVERSION-ERROR
  9279           MOVE SPACES TO PEXPDTEO
  9280        ELSE
  9281           MOVE DC-GREG-DATE-1-EDIT TO PEXPDTEO
  9282     ELSE
  9283        MOVE '99/99/99' TO PEXPDTEO.
  9284
  9285     IF PI-PROCESSOR-ID = 'LGXX' OR 'PEMA'
  9286        MOVE AL-UANON            TO PEXPDTEA
  9287                                    PEFFDTEA
  9288        MOVE AL-SANOF TO            PDSPLYA.
  9289
  9290     MOVE LOW-VALUES             TO MAP-AGENT-AREA.
  9291     MOVE PI-COMM-POINTER        TO LCP-WS-ADDR-COMP
  9292     SET ADDRESS OF COMMISSION-WORK-AREA TO LCP-WS-ADDR-PNTR.
  9293
  9294     MOVE 1  TO SUB.
  9295     SET M-INDEX TO 1.
  9296
  9297 6005-LOOP.
  9298     IF AM-AGT (SUB) = SPACES  OR ZEROS
  9299        IF PI-AR-PROCESSING
  9300           IF AM-AR-HI-CERT-DATE GREATER THAN LOW-VALUES
  9301              MOVE AL-SANOF     TO AGENTA  (M-INDEX)
  9302                                   ATYPEA (M-INDEX)
  9303                                   SINGLEA (M-INDEX)
  9304                                   JOINTA (M-INDEX)
  9305                                   A-HA    (M-INDEX)
  9306              GO TO 6010-BUMP-SUB
  9307           ELSE
  9308              GO TO 6010-BUMP-SUB
  9309        ELSE
  9310           GO TO 6010-BUMP-SUB.
  9311
  9312     MOVE AM-AGT (SUB)           TO AGENT (M-INDEX).
  9313
  9314***DMD CUSTOM CODE - CAPTURE THE FIRST AGENT TO BE DISPLAYED
  9315     IF WS-DMD-AGENT = LOW-VALUES
  9316        MOVE AM-AGT (SUB)        TO WS-DMD-AGENT.
  9317***DMD ******************************************************
  9318
  9319     IF PI-GA-BILLING
  9320        MOVE AM-AGT (SUB)        TO WK-AM-AGT (SUB).
  9321     MOVE AL-UANON               TO AGENTA (M-INDEX).
  9322
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 179
* EL6501.cbl
  9323     MOVE AM-COM-TYP (SUB)       TO ATYPE (M-INDEX).
  9324     IF PI-GA-BILLING
  9325        MOVE AM-COM-TYP (SUB)    TO WK-AM-TYPE (SUB).
  9326     MOVE AL-UANON               TO ATYPEA (M-INDEX).
  9327
  9328     IF (AM-L-COM (SUB) NOT NUMERIC)
  9329        OR (AM-L-COMA (SUB) (3:1) = 'L' OR 'M' OR 'O')
  9330        MOVE AM-L-COMA (SUB)     TO SINGLE-COMM-T (M-INDEX)
  9331     ELSE
  9332        IF AM-L-COM (SUB) NOT = ZEROS
  9333           MOVE AM-L-COM  (SUB)  TO SINGLE-COMM-O (M-INDEX).
  9334
  9335     IF (AM-J-COM (SUB) NOT NUMERIC)
  9336        OR (AM-J-COMA (SUB) (3:1) = 'L' OR 'M' OR 'O')
  9337        MOVE AM-J-COMA (SUB)     TO JOINT-COMM-T (M-INDEX)
  9338     ELSE
  9339        IF AM-J-COM (SUB) NOT = ZEROS
  9340           MOVE AM-J-COM  (SUB)  TO JOINT-COMM-O (M-INDEX).
  9341
  9342     IF (AM-A-COM (SUB) NOT NUMERIC)
  9343        OR (AM-A-COMA (SUB) (3:1) = 'L' OR 'M' OR 'O')
  9344        MOVE AM-A-COMA (SUB)     TO A-H-COMM-T (M-INDEX)
  9345     ELSE
  9346        IF AM-A-COM (SUB) NOT = ZEROS
  9347           MOVE AM-A-COM  (SUB)  TO A-H-COMM-O (M-INDEX).
  9348
  9349************************************************************
  9350**  MODIFICATION MADE TO ADD SERVICE FEES                 **
  9351************************************************************
  9352
  9353     IF (AM-COM-TYP (SUB) NOT = 'C' AND 'D' AND 'O' AND 'P'
  9354            AND 'F' AND 'S' AND 'G' AND 'B' AND 'I'
  9355            AND 'K' AND 'L' AND 'J' AND 'M' AND 'A' AND 'N')
  9356         GO TO 6006-CONTINUE.
  9357
  9358     IF (AM-L-COM (SUB) NUMERIC)
  9359        AND (AM-L-COMA (SUB) (3:1) NOT = 'L' AND 'M' AND 'O')
  9360         ADD AM-L-COM (SUB) TO COMM-SL-ACCUM.
  9361
  9362     IF (AM-J-COM (SUB) NUMERIC)
  9363        AND (AM-J-COMA (SUB) (3:1) NOT = 'L' AND 'M' AND 'O')
  9364         ADD AM-J-COM (SUB) TO COMM-JL-ACCUM.
  9365
  9366     IF (AM-A-COM (SUB) NUMERIC)
  9367        AND (AM-A-COMA (SUB) (3:1) NOT = 'L' AND 'M' AND 'O')
  9368        ADD AM-A-COM (SUB) TO COMM-AH-ACCUM
  9369     END-IF
  9370     .
  9371 6006-CONTINUE.
  9372     IF WS-ST-COMM-CAP-SL NOT NUMERIC
  9373         MOVE ZEROS        TO WS-ST-COMM-CAP-SL.
  9374
  9375     IF WS-ST-COMM-CAP-SL = ZEROS
  9376        CONTINUE
  9377     ELSE
  9378        IF (AM-L-COM (SUB) NUMERIC)
  9379           AND (AM-L-COMA (SUB) (3:1) NOT = 'L' AND 'M' AND 'O')
  9380           IF (WS-LIMIT-TO-ACCOUNT AND
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 180
* EL6501.cbl
  9381              AM-L-COM (SUB) > WS-ST-COMM-CAP-SL)
  9382                       OR
  9383              (NOT WS-LIMIT-TO-ACCOUNT AND
  9384              COMM-SL-ACCUM > WS-ST-COMM-CAP-SL)
  9385              MOVE -1            TO MAINTL
  9386              MOVE ER-1884       TO EMI-ERROR
  9387              PERFORM 9900-ERROR-FORMAT
  9388                                 THRU 9900-EXIT
  9389           END-IF
  9390        ELSE
  9391           MOVE PI-COMPANY-CD    TO COMM-COMP-CD
  9392           MOVE AM-L-COMA (SUB)  TO COMM-TABLE
  9393           MOVE PI-LIFE-OVERRIDE-L1
  9394                                 TO COMM-LF-AH
  9395           MOVE LOW-VALUES       TO COMM-FILLER
  9396           PERFORM 6400-READ-COMMISSION
  9397                                 THRU 6459-EXIT
  9398           IF WS-TABLE-MAX > WS-ST-COMM-CAP-SL
  9399              MOVE -1            TO MAINTL
  9400              MOVE ER-1884       TO EMI-ERROR
  9401              PERFORM 9900-ERROR-FORMAT
  9402                                 THRU 9900-EXIT
  9403           END-IF
  9404        END-IF
  9405     END-IF
  9406
  9407     IF WS-ST-COMM-CAP-JL NOT NUMERIC
  9408         MOVE ZEROS        TO WS-ST-COMM-CAP-JL.
  9409
  9410     IF WS-ST-COMM-CAP-JL = ZEROS
  9411        CONTINUE
  9412     ELSE
  9413        IF (AM-J-COM (SUB) NUMERIC)
  9414           AND (AM-J-COMA (SUB) (3:1) NOT = 'L' AND 'M' AND 'O')
  9415           IF (WS-LIMIT-TO-ACCOUNT AND
  9416              AM-J-COM (SUB) > WS-ST-COMM-CAP-JL)
  9417                       OR
  9418              (NOT WS-LIMIT-TO-ACCOUNT AND
  9419              COMM-JL-ACCUM > WS-ST-COMM-CAP-JL)
  9420              MOVE -1            TO MAINTL
  9421              MOVE ER-1885       TO EMI-ERROR
  9422              PERFORM 9900-ERROR-FORMAT
  9423                                 THRU 9900-EXIT
  9424           END-IF
  9425        ELSE
  9426           MOVE PI-COMPANY-CD    TO COMM-COMP-CD
  9427           MOVE AM-J-COMA (SUB)  TO COMM-TABLE
  9428           MOVE PI-LIFE-OVERRIDE-L1
  9429                                 TO COMM-LF-AH
  9430           MOVE LOW-VALUES       TO COMM-FILLER
  9431           PERFORM 6400-READ-COMMISSION
  9432                                 THRU 6459-EXIT
  9433           IF WS-TABLE-MAX > WS-ST-COMM-CAP-JL
  9434              MOVE -1            TO MAINTL
  9435              MOVE ER-1885       TO EMI-ERROR
  9436              PERFORM 9900-ERROR-FORMAT
  9437                                 THRU 9900-EXIT
  9438           END-IF
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 181
* EL6501.cbl
  9439        END-IF
  9440     END-IF
  9441
  9442     IF WS-ST-COMM-CAP-SA NOT NUMERIC
  9443         MOVE ZEROS        TO WS-ST-COMM-CAP-SA.
  9444
  9445     IF WS-ST-COMM-CAP-SA = ZEROS
  9446        CONTINUE
  9447     ELSE
  9448        IF (AM-A-COM (SUB) NUMERIC)
  9449           AND (AM-A-COMA (SUB) (3:1) NOT = 'L' AND 'M' AND 'O')
  9450           IF (WS-LIMIT-TO-ACCOUNT AND
  9451              AM-A-COM (SUB) > WS-ST-COMM-CAP-SA)
  9452                       OR
  9453              (NOT WS-LIMIT-TO-ACCOUNT AND
  9454              COMM-AH-ACCUM > WS-ST-COMM-CAP-SA)
  9455              MOVE -1            TO MAINTL
  9456              MOVE ER-1886       TO EMI-ERROR
  9457              PERFORM 9900-ERROR-FORMAT
  9458                                 THRU 9900-EXIT
  9459           END-IF
  9460        ELSE
  9461           MOVE PI-COMPANY-CD    TO COMM-COMP-CD
  9462           MOVE AM-A-COMA (SUB)  TO COMM-TABLE
  9463           MOVE PI-AH-OVERRIDE-L1
  9464                                 TO COMM-LF-AH
  9465           MOVE LOW-VALUES       TO COMM-FILLER
  9466           PERFORM 6400-READ-COMMISSION
  9467                                 THRU 6459-EXIT
  9468           IF WS-TABLE-MAX > WS-ST-COMM-CAP-SA
  9469              MOVE -1            TO MAINTL
  9470              MOVE ER-1886       TO EMI-ERROR
  9471              PERFORM 9900-ERROR-FORMAT
  9472                                 THRU 9900-EXIT
  9473           END-IF
  9474        END-IF
  9475     END-IF
  9476
  9477     IF AM-RECALC-LV-INDIC (SUB) NOT = SPACE
  9478         MOVE AM-RECALC-LV-INDIC (SUB) TO RECAL (M-INDEX).
  9479
  9480     IF AM-RETRO-LV-INDIC (SUB) NOT = SPACE
  9481         MOVE AM-RETRO-LV-INDIC (SUB) TO RCOMM (M-INDEX).
  9482
  9483     IF AM-COMM-CHARGEBACK (SUB)  NUMERIC
  9484        NEXT SENTENCE
  9485     ELSE
  9486        MOVE ZEROS              TO  AM-COMM-CHARGEBACK (SUB).
  9487
  9488     IF AM-COMM-CHARGEBACK (SUB)   NOT  =    ZEROS
  9489         MOVE AM-COMM-CHARGEBACK (SUB) TO CHGBCK (M-INDEX).
  9490
  9491     IF AM-GL-CODES (SUB)   NOT  =    ZEROS
  9492         MOVE AM-GL-CODES (SUB)  TO  GLCODE (M-INDEX).
  9493
  9494     IF NOT PI-AR-PROCESSING
  9495        GO TO 6010-BUMP-SUB.
  9496
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 182
* EL6501.cbl
  9497     IF AM-AR-HI-CERT-DATE = LOW-VALUES
  9498        GO TO 6010-BUMP-SUB.
  9499
  9500     MOVE AL-SANON              TO AGENTA  (M-INDEX)
  9501                                   ATYPEA  (M-INDEX)
  9502                                   SINGLEA (M-INDEX)
  9503                                   JOINTA  (M-INDEX)
  9504                                   A-HA    (M-INDEX).
  9505
  9506 6010-BUMP-SUB.
  9507     ADD 1  TO SUB.
  9508     SET M-INDEX UP BY 1.
  9509     IF SUB LESS 11
  9510        GO TO 6005-LOOP.
  9511
  9512 6099-EXIT.
  9513      EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 183
* EL6501.cbl
  9515 6300-STARTBR.
  9516
  9517* EXEC CICS STARTBR
  9518*         DATASET   (ACCT-FILE-ID)
  9519*         RIDFLD    (WS-KEY-SAVE)
  9520*    END-EXEC.
  9521     MOVE 0
  9522       TO DFHEIV11
  9523*    MOVE '&,         G          &   #00008788' TO DFHEIV0
  9524     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9525     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9526     MOVE X'2020233030303038373838' TO DFHEIV0(25:11)
  9527     CALL 'kxdfhei1' USING DFHEIV0,
  9528           ACCT-FILE-ID,
  9529           WS-KEY-SAVE,
  9530           DFHEIV99,
  9531           DFHEIV11,
  9532           DFHEIV99
  9533     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9534
  9535
  9536     MOVE 'Y'                    TO BROWSE-STARTED-SW.
  9537
  9538 6300-EXIT.
  9539      EXIT.
  9540
  9541 6310-READNEXT.
  9542
  9543* EXEC CICS READNEXT
  9544*         DATASET    (ACCT-FILE-ID)
  9545*         SET        (ADDRESS OF ACCOUNT-MASTER)
  9546*         RIDFLD     (WS-KEY-SAVE)
  9547*    END-EXEC.
  9548     MOVE 0
  9549       TO DFHEIV11
  9550*    MOVE '&.S                   )   #00008799' TO DFHEIV0
  9551     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9552     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  9553     MOVE X'2020233030303038373939' TO DFHEIV0(25:11)
  9554     CALL 'kxdfhei1' USING DFHEIV0,
  9555           ACCT-FILE-ID,
  9556           DFHEIV20,
  9557           DFHEIV99,
  9558           WS-KEY-SAVE,
  9559           DFHEIV99,
  9560           DFHEIV11,
  9561           DFHEIV99,
  9562           DFHEIV99
  9563     SET ADDRESS OF ACCOUNT-MASTER TO
  9564         DFHEIV20
  9565     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9566
  9567
  9568 6310-EXIT.
  9569      EXIT.
  9570
  9571 6320-ENDBR.
  9572     MOVE SPACE               TO BROWSE-STARTED-SW.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 184
* EL6501.cbl
  9573
  9574* EXEC CICS ENDBR
  9575*        DATASET(ACCT-FILE-ID)
  9576*    END-EXEC.
  9577     MOVE 0
  9578       TO DFHEIV11
  9579*    MOVE '&2                    $   #00008810' TO DFHEIV0
  9580     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9581     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9582     MOVE X'2020233030303038383130' TO DFHEIV0(25:11)
  9583     CALL 'kxdfhei1' USING DFHEIV0,
  9584           ACCT-FILE-ID,
  9585           DFHEIV11,
  9586           DFHEIV99
  9587     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9588
  9589
  9590 6320-EXIT.
  9591      EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 185
* EL6501.cbl
  9593 6400-READ-COMMISSION.
  9594     MOVE ZEROS                  TO WS-COMM-ERROR-SW
  9595
  9596* EXEC CICS HANDLE CONDITION
  9597*         NOTFND   (6450-NOT-FOUND)
  9598*    END-EXEC
  9599*    MOVE '"$I                   ! . #00008819' TO DFHEIV0
  9600     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9601     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9602     MOVE X'2E20233030303038383139' TO DFHEIV0(25:11)
  9603     CALL 'kxdfhei1' USING DFHEIV0
  9604     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9605
  9606
  9607* EXEC CICS READ
  9608*        GTEQ
  9609*        DATASET   (COMM-FILE-ID)
  9610*        SET       (ADDRESS OF COMM-TABLE-RECORD)
  9611*        RIDFLD    (COMM-KEY)
  9612*    END-EXEC
  9613*    MOVE '&"S        G          (   #00008823' TO DFHEIV0
  9614     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  9615     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9616     MOVE X'2020233030303038383233' TO DFHEIV0(25:11)
  9617     CALL 'kxdfhei1' USING DFHEIV0,
  9618           COMM-FILE-ID,
  9619           DFHEIV20,
  9620           DFHEIV99,
  9621           COMM-KEY,
  9622           DFHEIV99,
  9623           DFHEIV99,
  9624           DFHEIV99
  9625     SET ADDRESS OF COMM-TABLE-RECORD TO
  9626         DFHEIV20
  9627     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9628
  9629     IF CT-COMPANY-CD = PI-COMPANY-CD AND
  9630        CT-TABLE      = COMM-TABLE    AND
  9631        CT-BEN-TYPE   = COMM-LF-AH
  9632        PERFORM 6460-CHECK-MAX THRU 6460-EXIT
  9633        GO TO 6459-EXIT
  9634     END-IF
  9635     .
  9636 6450-NOT-FOUND.
  9637     MOVE ER-2176                TO EMI-ERROR.
  9638     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9639     MOVE 1  TO WS-COMM-ERROR-SW.
  9640
  9641 6459-EXIT.
  9642      EXIT.
  9643
  9644 6460-CHECK-MAX.
  9645
  9646
  9647* EXEC CICS STARTBR
  9648*         DATASET   (COMM-FILE-ID)
  9649*         RIDFLD    (COMM-KEY)
  9650*         RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 186
* EL6501.cbl
  9651*    END-EXEC
  9652     MOVE 0
  9653       TO DFHEIV11
  9654*    MOVE '&,         G          &  N#00008847' TO DFHEIV0
  9655     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9656     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9657     MOVE X'204E233030303038383437' TO DFHEIV0(25:11)
  9658     CALL 'kxdfhei1' USING DFHEIV0,
  9659           COMM-FILE-ID,
  9660           COMM-KEY,
  9661           DFHEIV99,
  9662           DFHEIV11,
  9663           DFHEIV99
  9664     MOVE EIBRESP  TO WS-RESPONSE
  9665     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9666
  9667     MOVE SPACES          TO WS-STATE-MAX-SW
  9668
  9669     IF RESP-NORMAL
  9670        MOVE LOW-VALUES          TO COMM-FILLER
  9671        MOVE COMM-KEY            TO WS-HOLD-COMM-KEY
  9672        MOVE ZEROS               TO WS-TABLE-MAX
  9673        PERFORM UNTIL
  9674              (NOT RESP-NORMAL) OR
  9675              (COMM-KEY (1:5) NOT = WS-HOLD-COMM-KEY (1:5))
  9676
  9677* EXEC CICS READNEXT
  9678*             DATASET   (COMM-FILE-ID)
  9679*             SET       (ADDRESS OF COMM-TABLE-RECORD)
  9680*             RIDFLD    (COMM-KEY)
  9681*             RESP      (WS-RESPONSE)
  9682*           END-EXEC
  9683     MOVE 0
  9684       TO DFHEIV11
  9685*    MOVE '&.S                   )  N#00008862' TO DFHEIV0
  9686     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9687     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  9688     MOVE X'204E233030303038383632' TO DFHEIV0(25:11)
  9689     CALL 'kxdfhei1' USING DFHEIV0,
  9690           COMM-FILE-ID,
  9691           DFHEIV20,
  9692           DFHEIV99,
  9693           COMM-KEY,
  9694           DFHEIV99,
  9695           DFHEIV11,
  9696           DFHEIV99,
  9697           DFHEIV99
  9698     SET ADDRESS OF COMM-TABLE-RECORD TO
  9699         DFHEIV20
  9700     MOVE EIBRESP  TO WS-RESPONSE
  9701     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9702            IF (RESP-NORMAL) AND
  9703               (COMM-KEY (1:5) = WS-HOLD-COMM-KEY (1:5))
  9704               PERFORM VARYING WS-NDX FROM +1 BY +1 UNTIL
  9705                   (WS-NDX > +27)
  9706                   IF CT-RT (WS-NDX) > WS-TABLE-MAX
  9707                      MOVE CT-RT (WS-NDX)
  9708                                 TO WS-TABLE-MAX
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 187
* EL6501.cbl
  9709                   END-IF
  9710               END-PERFORM
  9711            END-IF
  9712        END-PERFORM
  9713
  9714* EXEC CICS ENDBR
  9715*            DATASET   (COMM-FILE-ID)
  9716*       END-EXEC
  9717     MOVE 0
  9718       TO DFHEIV11
  9719*    MOVE '&2                    $   #00008879' TO DFHEIV0
  9720     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9721     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9722     MOVE X'2020233030303038383739' TO DFHEIV0(25:11)
  9723     CALL 'kxdfhei1' USING DFHEIV0,
  9724           COMM-FILE-ID,
  9725           DFHEIV11,
  9726           DFHEIV99
  9727     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9728     END-IF
  9729
  9730     .
  9731 6460-EXIT.
  9732      EXIT.
  9733
  9734
  9735 6500-READ-ACCT.
  9736
  9737* EXEC CICS READ
  9738*        GTEQ
  9739*        DATASET   (ACCT-FILE-ID)
  9740*        SET       (ADDRESS OF ACCOUNT-MASTER)
  9741*        RIDFLD    (PI-ACCT-KEY)
  9742*    END-EXEC.
  9743*    MOVE '&"S        G          (   #00008890' TO DFHEIV0
  9744     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  9745     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9746     MOVE X'2020233030303038383930' TO DFHEIV0(25:11)
  9747     CALL 'kxdfhei1' USING DFHEIV0,
  9748           ACCT-FILE-ID,
  9749           DFHEIV20,
  9750           DFHEIV99,
  9751           PI-ACCT-KEY,
  9752           DFHEIV99,
  9753           DFHEIV99,
  9754           DFHEIV99
  9755     SET ADDRESS OF ACCOUNT-MASTER TO
  9756         DFHEIV20
  9757     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9758
  9759
  9760 6599-EXIT.
  9761      EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 188
* EL6501.cbl
  9763 6600-UPDATE-MAINT-DT.
  9764     MOVE SPACES                 TO ELCNTL-KEY.
  9765
  9766     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
  9767     MOVE '1'                    TO CNTL-REC-TYPE.
  9768     MOVE +0                     TO CNTL-SEQ-NO.
  9769
  9770
  9771* EXEC CICS HANDLE CONDITION
  9772*        NOTFND   (6699-EXIT)
  9773*    END-EXEC.
  9774*    MOVE '"$I                   ! / #00008907' TO DFHEIV0
  9775     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9776     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9777     MOVE X'2F20233030303038393037' TO DFHEIV0(25:11)
  9778     CALL 'kxdfhei1' USING DFHEIV0
  9779     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9780
  9781
  9782
  9783* EXEC CICS READ
  9784*        UPDATE
  9785*        DATASET   (CNTL-FILE-ID)
  9786*        SET       (ADDRESS OF CONTROL-FILE)
  9787*        RIDFLD    (ELCNTL-KEY)
  9788*    END-EXEC.
  9789*    MOVE '&"S        EU         (   #00008911' TO DFHEIV0
  9790     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9791     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9792     MOVE X'2020233030303038393131' TO DFHEIV0(25:11)
  9793     CALL 'kxdfhei1' USING DFHEIV0,
  9794           CNTL-FILE-ID,
  9795           DFHEIV20,
  9796           DFHEIV99,
  9797           ELCNTL-KEY,
  9798           DFHEIV99,
  9799           DFHEIV99,
  9800           DFHEIV99
  9801     SET ADDRESS OF CONTROL-FILE TO
  9802         DFHEIV20
  9803     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9804
  9805
  9806     MOVE BIN-CURRENT-SAVE       TO CF-ACCOUNT-MSTR-MAINT-DT.
  9807
  9808
  9809* EXEC CICS REWRITE
  9810*        DATASET   (CNTL-FILE-ID)
  9811*        FROM      (CONTROL-FILE)
  9812*    END-EXEC.
  9813     MOVE LENGTH OF
  9814      CONTROL-FILE
  9815       TO DFHEIV11
  9816*    MOVE '&& L                  %   #00008920' TO DFHEIV0
  9817     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9818     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9819     MOVE X'2020233030303038393230' TO DFHEIV0(25:11)
  9820     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 189
* EL6501.cbl
  9821           CNTL-FILE-ID,
  9822           CONTROL-FILE,
  9823           DFHEIV11,
  9824           DFHEIV99
  9825     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9826
  9827
  9828 6699-EXIT.
  9829      EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 190
* EL6501.cbl
  9831 6700-BUILD-COMM-WORK.
  9832     IF NOT PI-GA-BILLING
  9833         GO TO 6799-EXIT.
  9834
  9835
  9836* EXEC CICS GETMAIN
  9837*         LENGTH   (260)
  9838*         SET      (ADDRESS OF COMMISSION-WORK-AREA)
  9839*         INITIMG  (GETMAIN-SPACE)
  9840*     END-EXEC.
  9841     MOVE 260
  9842       TO DFHEIV11
  9843*    MOVE ',"IL                  $   #00008932' TO DFHEIV0
  9844     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  9845     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9846     MOVE X'2020233030303038393332' TO DFHEIV0(25:11)
  9847     CALL 'kxdfhei1' USING DFHEIV0,
  9848           DFHEIV20,
  9849           DFHEIV11,
  9850           GETMAIN-SPACE
  9851     SET ADDRESS OF COMMISSION-WORK-AREA TO
  9852         DFHEIV20
  9853     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9854
  9855     SET LCP-WS-ADDR-PNTR TO ADDRESS OF COMMISSION-WORK-AREA
  9856
  9857     MOVE LCP-WS-ADDR-COMP TO PI-COMM-POINTER.
  9858     MOVE SPACES             TO COMMISSION-WORK-AREA.
  9859     MOVE 'X'                TO COMMISSION-GETMAIN-SW.
  9860
  9861     IF PI-MAINT = 'A'
  9862         GO TO 6799-EXIT.
  9863
  9864     MOVE AM-COMM-STRUCTURE TO COMMISSION-WORK-AREA.
  9865     MOVE +1                TO AXRF-SUB.
  9866
  9867 6710-AXRF-LOOP.
  9868     MOVE SPACES         TO AGENT-FIND.
  9869     MOVE ERGXRF-MAX-LEN TO ERGXRF-REC-LEN.
  9870
  9871     PERFORM 6920-READ-AXRF-FILE THRU 6929-EXIT.
  9872
  9873     IF AGENT-FIND = SPACES
  9874        MOVE GX-LAST-BILL-DT (GX-AGENT-SUB) TO
  9875             WK-GA-BILL-DT (AXRF-SUB)
  9876     ELSE
  9877        MOVE LOW-VALUES TO WK-GA-BILL-DT (AXRF-SUB).
  9878
  9879     ADD +1 TO AXRF-SUB.
  9880
  9881     IF AXRF-SUB NOT = +11
  9882        GO TO 6710-AXRF-LOOP.
  9883
  9884 6799-EXIT.
  9885     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 191
* EL6501.cbl
  9887 6800-COMPANY-REC-READ.
  9888     MOVE SPACES                 TO ELCNTL-KEY.
  9889     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
  9890     MOVE '1'                    TO CNTL-REC-TYPE.
  9891     MOVE +0                     TO CNTL-SEQ-NO.
  9892
  9893* EXEC CICS HANDLE CONDITION
  9894*        NOTFND   (6880-NO-COMP)
  9895*    END-EXEC.
  9896*    MOVE '"$I                   ! 0 #00008974' TO DFHEIV0
  9897     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9898     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9899     MOVE X'3020233030303038393734' TO DFHEIV0(25:11)
  9900     CALL 'kxdfhei1' USING DFHEIV0
  9901     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9902
  9903
  9904
  9905* EXEC CICS READ
  9906*        DATASET   (CNTL-FILE-ID)
  9907*        SET       (ADDRESS OF CONTROL-FILE)
  9908*        RIDFLD    (ELCNTL-KEY)
  9909*    END-EXEC.
  9910*    MOVE '&"S        E          (   #00008978' TO DFHEIV0
  9911     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9912     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9913     MOVE X'2020233030303038393738' TO DFHEIV0(25:11)
  9914     CALL 'kxdfhei1' USING DFHEIV0,
  9915           CNTL-FILE-ID,
  9916           DFHEIV20,
  9917           DFHEIV99,
  9918           ELCNTL-KEY,
  9919           DFHEIV99,
  9920           DFHEIV99,
  9921           DFHEIV99
  9922     SET ADDRESS OF CONTROL-FILE TO
  9923         DFHEIV20
  9924     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9925
  9926
  9927     IF CF-ACCOUNT-MSTR-MAINT-DT = LOW-VALUES
  9928         MOVE ER-2572               TO EMI-ERROR
  9929         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9930
  9931     GO TO 6899-EXIT.
  9932
  9933 6880-NO-COMP.
  9934     MOVE ER-0002                TO EMI-ERROR.
  9935     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9936
  9937 6899-EXIT.
  9938     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 192
* EL6501.cbl
  9940 6900-READ-AND-CHECK-AXRF.
  9941     IF NOT PI-GA-BILLING
  9942        GO TO 6999-EXIT.
  9943
  9944     MOVE PI-COMM-POINTER TO LCP-WS-ADDR-COMP
  9945     SET ADDRESS OF COMMISSION-WORK-AREA TO LCP-WS-ADDR-PNTR.
  9946
  9947 6905-AGENT-LEVEL-LOOP.
  9948     MOVE ERGXRF-MAX-LEN         TO ERGXRF-REC-LEN.
  9949     MOVE SPACES TO AGENT-FIND.
  9950     IF ((AM-AGT (AXRF-SUB) NOT = WK-AM-AGT (AXRF-SUB))
  9951      OR
  9952        (AM-COM-TYP (AXRF-SUB) NOT = WK-AM-TYPE (AXRF-SUB)))
  9953      AND
  9954        ((AM-COM-TYP (AXRF-SUB) = 'O' OR 'P' OR 'G'
  9955                             OR 'B' OR 'I'
  9956                             OR 'K' OR 'L' OR 'J' OR 'M'
  9957                             OR 'S' OR 'A' OR 'N')
  9958                            OR
  9959        (WK-AM-TYPE (AXRF-SUB) = 'O' OR 'P' OR 'G' OR
  9960                'B' OR 'I' OR 'K' OR 'L' OR 'J' OR 'M'
  9961                                  OR 'S' OR 'A' OR 'N'))
  9962            PERFORM 6920-READ-AXRF-FILE THRU 6929-EXIT
  9963            IF AGENT-RECORD-NOT-FOUND
  9964               PERFORM 6950-ADD-AGENT-RECORD THRU 6959-EXIT
  9965           ELSE
  9966            IF ACCT-RECORD-NOT-FOUND OR ACCT-LEVEL-DIFFERENT
  9967               PERFORM 6970-REWRITE-AGENT-RECORD THRU 6979-EXIT
  9968           ELSE
  9969        IF (AM-COM-TYP (AXRF-SUB) NOT = 'O' AND 'P' AND 'G'
  9970              AND 'B' AND 'I' AND 'S'
  9971              AND 'K' AND 'L' AND 'J' AND 'M' AND 'A' AND 'N') OR
  9972           (AM-AGT (AXRF-SUB) NOT =
  9973                   WK-AM-AGT (AXRF-SUB))
  9974           PERFORM 7000-DELETE-AXRF-REC THRU 7999-EXIT
  9975           GO TO 6910-INC-SUB.
  9976
  9977     MOVE SPACES TO AGENT-FIND.
  9978     IF (AM-AGT (AXRF-SUB) NOT = WK-AM-AGT (AXRF-SUB)) AND
  9979        (WK-AM-AGT (AXRF-SUB) NOT = LOW-VALUES AND
  9980                               SPACES AND ZEROS)
  9981          MOVE WK-AM-AGT (AXRF-SUB)   TO WS-AXRF-AGENT-NO
  9982          MOVE ERGXRF-MAX-LEN         TO ERGXRF-REC-LEN
  9983          PERFORM 6921-READ-AXRF THRU 6929-EXIT
  9984          IF AGENT-FIND = SPACES
  9985              PERFORM 7000-DELETE-AXRF-REC THRU 7999-EXIT.
  9986
  9987 6910-INC-SUB.
  9988     ADD +1                      TO AXRF-SUB.
  9989     IF AXRF-SUB NOT = +11
  9990        GO TO 6905-AGENT-LEVEL-LOOP.
  9991
  9992     GO TO 6999-EXIT.
  9993
  9994 6920-READ-AXRF-FILE.
  9995*    IF GETMAIN-SW = 'X'
  9996*       GO TO 6920-BUILD-KEY.
  9997*
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 193
* EL6501.cbl
  9998*    EXEC CICS GETMAIN
  9999*         LENGTH   (ERGXRF-REC-LEN)
 10000*         SET      (ADDRESS OF AGENT-CROSS-REFERENCE)
 10001*         INITIMG  (GETMAIN-SPACE)
 10002*    END-EXEC.
 10003*
 10004*    MOVE 'X' TO GETMAIN-SW.
 10005
 10006 6920-BUILD-KEY.
 10007     MOVE PI-COMPANY-CD          TO WS-AXRF-COMPANY-CD.
 10008
 10009     IF PI-ZERO-CARRIER
 10010       OR PI-ZERO-CAR-GROUP
 10011         MOVE ZERO               TO WS-AXRF-CARRIER
 10012     ELSE
 10013         MOVE AM-CARRIER         TO WS-AXRF-CARRIER.
 10014
 10015     IF PI-ZERO-GROUPING
 10016       OR PI-ZERO-CAR-GROUP
 10017         MOVE ZEROS              TO WS-AXRF-GROUPING
 10018     ELSE
 10019         MOVE AM-GROUPING        TO WS-AXRF-GROUPING.
 10020
 10021     IF AM-AGT (AXRF-SUB) NOT = SPACES AND ZEROS AND
 10022                                              LOW-VALUES
 10023        MOVE AM-AGT (AXRF-SUB) TO WS-AXRF-AGENT-NO
 10024     ELSE
 10025     IF WK-AM-AGT (AXRF-SUB) NOT = SPACES AND ZEROS AND
 10026                                              LOW-VALUES
 10027        MOVE WK-AM-AGT (AXRF-SUB) TO WS-AXRF-AGENT-NO
 10028     ELSE
 10029        MOVE 'X' TO AGENT-FIND
 10030        GO TO 6929-EXIT.
 10031
 10032     MOVE +1 TO GX-AGENT-SUB.
 10033
 10034 6921-READ-AXRF.
 10035
 10036* EXEC CICS HANDLE CONDITION
 10037*         ENDFILE     (6925-NOT-FIND)
 10038*         NOTFND      (6925-NOT-FIND)
 10039*    END-EXEC.
 10040*    MOVE '"$''I                  ! 1 #00009092' TO DFHEIV0
 10041     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 10042     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10043     MOVE X'3120233030303039303932' TO DFHEIV0(25:11)
 10044     CALL 'kxdfhei1' USING DFHEIV0
 10045     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10046
 10047
 10048
 10049* EXEC CICS READ
 10050*        DATASET   (ERGXRF-FILE-ID)
 10051*        LENGTH    (ERGXRF-REC-LEN)
 10052*        INTO      (AGENT-CROSS-REFERENCE)
 10053*        RIDFLD    (WS-AXRF-KEY)
 10054*        EQUAL
 10055*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 194
* EL6501.cbl
 10056*    MOVE '&"IL       E          (   #00009097' TO DFHEIV0
 10057     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10058     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10059     MOVE X'2020233030303039303937' TO DFHEIV0(25:11)
 10060     CALL 'kxdfhei1' USING DFHEIV0,
 10061           ERGXRF-FILE-ID,
 10062           AGENT-CROSS-REFERENCE,
 10063           ERGXRF-REC-LEN,
 10064           WS-AXRF-KEY,
 10065           DFHEIV99,
 10066           DFHEIV99,
 10067           DFHEIV99
 10068     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10069
 10070
 10071     MOVE GX-AGENT-POINTER-CNT TO GX-AGENT-POINTER-CNT.
 10072
 10073     PERFORM 6921-FIND-ACCT-LOOP VARYING GX-AGENT-SUB
 10074             FROM +1 BY +1 UNTIL
 10075         (GX-AGENT-SUB GREATER THAN GX-AGENT-POINTER-CNT) OR
 10076         (GX-AM-ACCOUNT (GX-AGENT-SUB) = AM-ACCOUNT      AND
 10077         GX-AM-EXPIRATION-DT (GX-AGENT-SUB) = AM-EXPIRATION-DT
 10078         AND
 10079         GX-AM-EFF-DT (GX-AGENT-SUB)   = AM-EFFECTIVE-DT AND
 10080         GX-AM-CARRIER (GX-AGENT-SUB)  = AM-CARRIER      AND
 10081         GX-AM-GROUPING (GX-AGENT-SUB) = AM-GROUPING     AND
 10082         GX-AM-STATE (GX-AGENT-SUB)    = AM-STATE).
 10083
 10084     IF GX-AGENT-SUB GREATER GX-AGENT-POINTER-CNT
 10085        MOVE 'Y' TO AGENT-FIND
 10086        GO TO 6929-EXIT.
 10087
 10088     IF GX-AM-LEVEL-NO (GX-AGENT-SUB) NOT = AXRF-SUB
 10089        MOVE 'Z' TO AGENT-FIND.
 10090
 10091     GO TO 6929-EXIT.
 10092
 10093 6921-FIND-ACCT-LOOP.
 10094***  DUMMY PARAGRAPH  ***
 10095
 10096 6925-NOT-FIND.
 10097     MOVE 'X' TO AGENT-FIND.
 10098
 10099 6929-EXIT.
 10100     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 195
* EL6501.cbl
 10102 6950-ADD-AGENT-RECORD.
 10103     IF AM-AGT (AXRF-SUB) = SPACES OR ZEROS
 10104        GO TO 6959-EXIT.
 10105
 10106     MOVE +109                   TO ERGXRF-REC-LEN.
 10107
 10108     MOVE +1                     TO GX-AGENT-POINTER-CNT.
 10109     MOVE 'GX'                   TO GX-RECORD-ID.
 10110     MOVE AM-COMPANY-CD          TO GX-COMPANY-CD.
 10111
 10112     IF PI-ZERO-CARRIER
 10113       OR PI-ZERO-CAR-GROUP
 10114         MOVE ZERO               TO GX-CARRIER
 10115     ELSE
 10116         MOVE AM-CARRIER         TO GX-CARRIER.
 10117
 10118     IF PI-ZERO-GROUPING
 10119       OR PI-ZERO-CAR-GROUP
 10120         MOVE ZERO               TO GX-GROUPING
 10121     ELSE
 10122         MOVE AM-GROUPING        TO GX-GROUPING.
 10123
 10124     MOVE AM-AGT (AXRF-SUB)      TO GX-AGENT-NO.
 10125
 10126     MOVE AM-CARRIER             TO GX-AM-CARRIER (1).
 10127     MOVE AM-GROUPING            TO GX-AM-GROUPING (1).
 10128     MOVE AM-STATE               TO GX-AM-STATE (1).
 10129     MOVE AM-ACCOUNT             TO GX-AM-ACCOUNT (1).
 10130     MOVE AM-EXPIRATION-DT       TO GX-AM-EXPIRATION-DT (1).
 10131     MOVE AM-EFFECTIVE-DT        TO GX-AM-EFF-DT (1).
 10132     MOVE AXRF-SUB               TO GX-AM-LEVEL-NO (1).
 10133     MOVE LOW-VALUES             TO GX-LAST-BILL-DT (1).
 10134
 10135     MOVE BIN-CURRENT-SAVE       TO GX-LAST-MAINT-DT.
 10136     MOVE EIBTIME                TO GX-LAST-MAINT-HHMMSS.
 10137     MOVE PI-PROCESSOR-ID        TO GX-LAST-MAINT-USER.
 10138
 10139
 10140* EXEC CICS WRITE
 10141*        FROM      (AGENT-CROSS-REFERENCE)
 10142*        LENGTH    (ERGXRF-REC-LEN)
 10143*        RIDFLD    (GX-CONTROL-PRIMARY)
 10144*        DATASET   (ERGXRF-FILE-ID)
 10145*    END-EXEC.
 10146*    MOVE '&$ L                  ''   #00009173' TO DFHEIV0
 10147     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10148     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10149     MOVE X'2020233030303039313733' TO DFHEIV0(25:11)
 10150     CALL 'kxdfhei1' USING DFHEIV0,
 10151           ERGXRF-FILE-ID,
 10152           AGENT-CROSS-REFERENCE,
 10153           ERGXRF-REC-LEN,
 10154           GX-CONTROL-PRIMARY,
 10155           DFHEIV99,
 10156           DFHEIV99
 10157     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10158
 10159
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 196
* EL6501.cbl
 10160 6959-EXIT.
 10161      EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 197
* EL6501.cbl
 10163 6970-REWRITE-AGENT-RECORD.
 10164     MOVE ERGXRF-MAX-LEN         TO ERGXRF-REC-LEN.
 10165
 10166
 10167* EXEC CICS READ
 10168*        DATASET   (ERGXRF-FILE-ID)
 10169*        INTO      (AGENT-CROSS-REFERENCE)
 10170*        LENGTH    (ERGXRF-REC-LEN)
 10171*        RIDFLD    (WS-AXRF-KEY)
 10172*        EQUAL
 10173*        UPDATE
 10174*    END-EXEC.
 10175*    MOVE '&"IL       EU         (   #00009186' TO DFHEIV0
 10176     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10177     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10178     MOVE X'2020233030303039313836' TO DFHEIV0(25:11)
 10179     CALL 'kxdfhei1' USING DFHEIV0,
 10180           ERGXRF-FILE-ID,
 10181           AGENT-CROSS-REFERENCE,
 10182           ERGXRF-REC-LEN,
 10183           WS-AXRF-KEY,
 10184           DFHEIV99,
 10185           DFHEIV99,
 10186           DFHEIV99
 10187     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10188
 10189
 10190     MOVE GX-AGENT-POINTER-CNT TO GX-AGENT-POINTER-CNT.
 10191
 10192     IF ACCT-LEVEL-DIFFERENT
 10193        GO TO 6975-UPDATE-LEVEL-NO.
 10194
 10195     IF GX-AGENT-POINTER-CNT = +1006
 10196         GO TO 6979-EXIT.
 10197
 10198     MOVE +1 TO FIND-AGENT-SUB1.
 10199
 10200 6972-FIND-REC-LOCATION.
 10201     MOVE GX-AGENT-POINTER (FIND-AGENT-SUB1) TO GX-REST-OF-KEY.
 10202     MOVE AM-COMPANY-CD TO GX-AM-COMPANY-CD.
 10203
 10204     IF (GX-AM-CONTROL-PRIMARY GREATER AM-CONTROL-PRIMARY)  OR
 10205        (FIND-AGENT-SUB1 GREATER GX-AGENT-POINTER-CNT)
 10206        NEXT SENTENCE
 10207     ELSE
 10208        ADD +1 TO FIND-AGENT-SUB1
 10209        GO TO 6972-FIND-REC-LOCATION.
 10210
 10211     MOVE GX-AGENT-POINTER-CNT TO FIND-AGENT-SUB2
 10212                                  FIND-AGENT-SUB3.
 10213     ADD +1 TO FIND-AGENT-SUB3.
 10214
 10215     IF FIND-AGENT-SUB1 GREATER GX-AGENT-POINTER-CNT
 10216        NEXT SENTENCE
 10217     ELSE
 10218        PERFORM 6977-BUMP-AXRF-REC VARYING FIND-AGENT-SUB2
 10219        FROM FIND-AGENT-SUB2 BY -1 UNTIL
 10220        FIND-AGENT-SUB3 = FIND-AGENT-SUB1.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 198
* EL6501.cbl
 10221
 10222     ADD ERGXRF-INC-LEN          TO ERGXRF-REC-LEN.
 10223     ADD  +1                     TO GX-AGENT-POINTER-CNT.
 10224
 10225     MOVE AM-CARRIER  TO GX-AM-CARRIER (FIND-AGENT-SUB3).
 10226     MOVE AM-GROUPING TO GX-AM-GROUPING (FIND-AGENT-SUB3).
 10227
 10228     MOVE AM-STATE    TO GX-AM-STATE (FIND-AGENT-SUB3).
 10229     MOVE AM-ACCOUNT  TO GX-AM-ACCOUNT (FIND-AGENT-SUB3).
 10230     MOVE AM-EXPIRATION-DT TO
 10231                  GX-AM-EXPIRATION-DT (FIND-AGENT-SUB3).
 10232     MOVE AM-EFFECTIVE-DT  TO
 10233                  GX-AM-EFF-DT (FIND-AGENT-SUB3).
 10234     MOVE AXRF-SUB    TO GX-AM-LEVEL-NO (FIND-AGENT-SUB3).
 10235     MOVE LOW-VALUES  TO GX-LAST-BILL-DT (FIND-AGENT-SUB3).
 10236
 10237 6975-UPDATE-LEVEL-NO.
 10238     MOVE AXRF-SUB TO GX-AM-LEVEL-NO (GX-AGENT-SUB).
 10239     MOVE BIN-CURRENT-SAVE       TO GX-LAST-MAINT-DT.
 10240     MOVE EIBTIME                TO GX-LAST-MAINT-HHMMSS.
 10241     MOVE PI-PROCESSOR-ID        TO GX-LAST-MAINT-USER.
 10242     compute ergxrf-rec-len = (gx-agent-pointer-cnt * +31) + +78
 10243     if ergxrf-rec-len > +31264
 10244        move +31264               to ergxrf-rec-len
 10245        move +1006                to gx-agent-pointer-cnt
 10246     end-if
 10247
 10248
 10249* EXEC CICS REWRITE
 10250*        FROM      (AGENT-CROSS-REFERENCE)
 10251*        LENGTH    (ERGXRF-REC-LEN)
 10252*        DATASET   (ERGXRF-FILE-ID)
 10253*    END-EXEC.
 10254*    MOVE '&& L                  %   #00009253' TO DFHEIV0
 10255     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10256     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10257     MOVE X'2020233030303039323533' TO DFHEIV0(25:11)
 10258     CALL 'kxdfhei1' USING DFHEIV0,
 10259           ERGXRF-FILE-ID,
 10260           AGENT-CROSS-REFERENCE,
 10261           ERGXRF-REC-LEN,
 10262           DFHEIV99
 10263     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10264
 10265
 10266     GO TO 6979-EXIT.
 10267
 10268 6977-BUMP-AXRF-REC.
 10269     MOVE GX-AGENT-POINTER (FIND-AGENT-SUB2) TO
 10270          GX-AGENT-POINTER (FIND-AGENT-SUB3).
 10271
 10272     SUBTRACT +1 FROM FIND-AGENT-SUB3.
 10273
 10274 6979-EXIT.
 10275     EXIT.
 10276
 10277 6999-EXIT.
 10278     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 199
* EL6501.cbl
 10280 7000-DELETE-AXRF-REC.
 10281     MOVE ERGXRF-MAX-LEN         TO ERGXRF-REC-LEN.
 10282
 10283
 10284* EXEC CICS HANDLE CONDITION
 10285*         ENDFILE     (7999-EXIT)
 10286*         NOTFND      (7999-EXIT)
 10287*    END-EXEC.
 10288*    MOVE '"$''I                  ! 2 #00009276' TO DFHEIV0
 10289     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 10290     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10291     MOVE X'3220233030303039323736' TO DFHEIV0(25:11)
 10292     CALL 'kxdfhei1' USING DFHEIV0
 10293     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10294
 10295
 10296
 10297* EXEC CICS READ
 10298*        DATASET   (ERGXRF-FILE-ID)
 10299*        INTO      (AGENT-CROSS-REFERENCE)
 10300*        LENGTH    (ERGXRF-REC-LEN)
 10301*        RIDFLD    (WS-AXRF-KEY)
 10302*        EQUAL
 10303*        UPDATE
 10304*    END-EXEC.
 10305*    MOVE '&"IL       EU         (   #00009281' TO DFHEIV0
 10306     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10307     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10308     MOVE X'2020233030303039323831' TO DFHEIV0(25:11)
 10309     CALL 'kxdfhei1' USING DFHEIV0,
 10310           ERGXRF-FILE-ID,
 10311           AGENT-CROSS-REFERENCE,
 10312           ERGXRF-REC-LEN,
 10313           WS-AXRF-KEY,
 10314           DFHEIV99,
 10315           DFHEIV99,
 10316           DFHEIV99
 10317     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10318
 10319
 10320     MOVE GX-AGENT-POINTER-CNT TO GX-AGENT-POINTER-CNT.
 10321
 10322     IF GX-AGENT-SUB = +0
 10323        PERFORM 6921-FIND-ACCT-LOOP VARYING GX-AGENT-SUB
 10324        FROM +1 BY +1 UNTIL
 10325         (GX-AGENT-SUB GREATER GX-AGENT-POINTER-CNT) OR
 10326         (GX-AM-ACCOUNT (GX-AGENT-SUB) = AM-ACCOUNT  AND
 10327         GX-AM-EXPIRATION-DT (GX-AGENT-SUB) = AM-EXPIRATION-DT
 10328         AND
 10329         GX-AM-EFF-DT (GX-AGENT-SUB)   = AM-EFFECTIVE-DT AND
 10330         GX-AM-CARRIER (GX-AGENT-SUB)  = AM-CARRIER      AND
 10331         GX-AM-GROUPING (GX-AGENT-SUB) = AM-GROUPING     AND
 10332         GX-AM-STATE (GX-AGENT-SUB)    = AM-STATE).
 10333
 10334     IF GX-AGENT-SUB GREATER GX-AGENT-POINTER-CNT
 10335        GO TO 7999-EXIT.
 10336
 10337     MOVE GX-AGENT-SUB TO FIND-AGENT-SUB1.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 200
* EL6501.cbl
 10338     PERFORM 7010-BUMP-RECORDS VARYING GX-AGENT-SUB
 10339                                  FROM GX-AGENT-SUB BY +1 UNTIL
 10340                            GX-AGENT-SUB = GX-AGENT-POINTER-CNT.
 10341     SUBTRACT ERGXRF-INC-LEN FROM ERGXRF-REC-LEN.
 10342     SUBTRACT +1             FROM GX-AGENT-POINTER-CNT.
 10343     GO TO 7020-REWRITE-AXRF-RECORD.
 10344
 10345 7010-BUMP-RECORDS.
 10346     ADD +1 TO FIND-AGENT-SUB1.
 10347     MOVE GX-AGENT-POINTER (FIND-AGENT-SUB1) TO
 10348          GX-AGENT-POINTER (GX-AGENT-SUB).
 10349
 10350 7020-REWRITE-AXRF-RECORD.
 10351     IF GX-AGENT-POINTER-CNT = +0
 10352
 10353* EXEC CICS DELETE
 10354*            DATASET   (ERGXRF-FILE-ID)
 10355*       END-EXEC
 10356*    MOVE '&(                    &   #00009322' TO DFHEIV0
 10357     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 10358     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10359     MOVE X'2020233030303039333232' TO DFHEIV0(25:11)
 10360     CALL 'kxdfhei1' USING DFHEIV0,
 10361           ERGXRF-FILE-ID,
 10362           DFHEIV99,
 10363           DFHEIV99,
 10364           DFHEIV99,
 10365           DFHEIV99
 10366     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10367     ELSE
 10368        MOVE BIN-CURRENT-SAVE       TO GX-LAST-MAINT-DT
 10369        MOVE EIBTIME                TO GX-LAST-MAINT-HHMMSS
 10370        MOVE PI-PROCESSOR-ID        TO GX-LAST-MAINT-USER
 10371        compute ergxrf-rec-len =
 10372            (gx-agent-pointer-cnt * +31) + +78
 10373        if ergxrf-rec-len > +31264
 10374           move +31264               to ergxrf-rec-len
 10375           move +1006                to gx-agent-pointer-cnt
 10376        end-if
 10377
 10378* EXEC CICS REWRITE
 10379*            FROM      (AGENT-CROSS-REFERENCE)
 10380*            LENGTH    (ERGXRF-REC-LEN)
 10381*            DATASET   (ERGXRF-FILE-ID)
 10382*       END-EXEC.
 10383*    MOVE '&& L                  %   #00009335' TO DFHEIV0
 10384     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10385     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10386     MOVE X'2020233030303039333335' TO DFHEIV0(25:11)
 10387     CALL 'kxdfhei1' USING DFHEIV0,
 10388           ERGXRF-FILE-ID,
 10389           AGENT-CROSS-REFERENCE,
 10390           ERGXRF-REC-LEN,
 10391           DFHEIV99
 10392     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10393
 10394
 10395 7999-EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 201
* EL6501.cbl
 10396     EXIT.
 10397
 10398*************************************
 10399 8000-STATE-REC-READ.
 10400     MOVE SPACES                 TO ELCNTL-KEY.
 10401     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10402     MOVE '3'                    TO CNTL-REC-TYPE.
 10403     MOVE PI-ACCT-STATE          TO CNTL-ACCESS.
 10404     MOVE +0                     TO CNTL-SEQ-NO.
 10405
 10406* EXEC CICS HANDLE CONDITION
 10407*        NOTFND  (8010-EXIT)
 10408*    END-EXEC.
 10409*    MOVE '"$I                   ! 3 #00009351' TO DFHEIV0
 10410     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10411     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10412     MOVE X'3320233030303039333531' TO DFHEIV0(25:11)
 10413     CALL 'kxdfhei1' USING DFHEIV0
 10414     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10415
 10416
 10417
 10418* EXEC CICS READ
 10419*        DATASET   (CNTL-FILE-ID)
 10420*        SET       (ADDRESS OF CONTROL-FILE)
 10421*        RIDFLD    (ELCNTL-KEY)
 10422*    END-EXEC.
 10423*    MOVE '&"S        E          (   #00009355' TO DFHEIV0
 10424     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10425     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10426     MOVE X'2020233030303039333535' TO DFHEIV0(25:11)
 10427     CALL 'kxdfhei1' USING DFHEIV0,
 10428           CNTL-FILE-ID,
 10429           DFHEIV20,
 10430           DFHEIV99,
 10431           ELCNTL-KEY,
 10432           DFHEIV99,
 10433           DFHEIV99,
 10434           DFHEIV99
 10435     SET ADDRESS OF CONTROL-FILE TO
 10436         DFHEIV20
 10437     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10438
 10439
 10440     MOVE CF-ST-COMMISSION-CAPS   TO WS-ST-COMMISSION-CAPS.
 10441     MOVE CF-COMM-CAP-LIMIT-TO    TO WS-COMM-CAP-LIMIT-TO.
 10442
 10443 8010-EXIT.
 10444      EXIT.
 10445
 10446 8050-USER-REC-READ.
 10447     MOVE SPACES                 TO ELCNTL-KEY.
 10448     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10449     MOVE '2'                    TO CNTL-REC-TYPE.
 10450     MOVE CSRI                   TO CNTL-ACCESS.
 10451     MOVE +0                     TO CNTL-SEQ-NO.
 10452
 10453* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 202
* EL6501.cbl
 10454*        NOTFND  (8055-NOTFND)
 10455*    END-EXEC.
 10456*    MOVE '"$I                   ! 4 #00009373' TO DFHEIV0
 10457     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10458     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10459     MOVE X'3420233030303039333733' TO DFHEIV0(25:11)
 10460     CALL 'kxdfhei1' USING DFHEIV0
 10461     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10462
 10463
 10464
 10465* EXEC CICS READ
 10466*        DATASET   (CNTL-FILE-ID)
 10467*        SET       (ADDRESS OF CONTROL-FILE)
 10468*        RIDFLD    (ELCNTL-KEY)
 10469*    END-EXEC.
 10470*    MOVE '&"S        E          (   #00009377' TO DFHEIV0
 10471     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10472     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10473     MOVE X'2020233030303039333737' TO DFHEIV0(25:11)
 10474     CALL 'kxdfhei1' USING DFHEIV0,
 10475           CNTL-FILE-ID,
 10476           DFHEIV20,
 10477           DFHEIV99,
 10478           ELCNTL-KEY,
 10479           DFHEIV99,
 10480           DFHEIV99,
 10481           DFHEIV99
 10482     SET ADDRESS OF CONTROL-FILE TO
 10483         DFHEIV20
 10484     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10485
 10486
 10487     GO TO 8060-EXIT.
 10488
 10489 8055-NOTFND.
 10490     MOVE ER-1883             TO EMI-ERROR.
 10491     MOVE -1                  TO CSRL.
 10492     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10493
 10494 8060-EXIT.
 10495      EXIT.
 10496
 10497*************************************
 10498
 10499 8100-SEND-INITIAL-MAP.
 10500     MOVE SAVE-DATE              TO DATEO.
 10501     MOVE EIBTIME                TO TIME-IN.
 10502     MOVE TIME-OUT               TO TIMEO.
 10503     MOVE PI-COMPANY-ID          TO CMPNYIDO.
 10504     MOVE PI-PROCESSOR-ID        TO USERIDO.
 10505     MOVE -1                     TO PFENTERL.
 10506     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O.
 10507
 10508     MOVE PI-AH-OVERRIDE-L6      TO AHHEADO.
 10509
 10510*    IF PI-COMPANY-ID = 'HAN' OR 'LGX' OR 'BNE'
 10511*       NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 203
* EL6501.cbl
 10512*    ELSE
 10513*       MOVE AL-SADOF            TO PSIHEADA
 10514*                                   PSILFTA
 10515*                                   PSILFCA
 10516*                                   PSIAHTA
 10517*                                   PSIAHCA
 10518*                                   PSILFFA
 10519*                                   PSIAHFA.
 10520
 10521*    IF PI-COMPANY-ID = 'DMD'
 10522*         MOVE AL-SANOF          TO KEY10A.
 10523
 10524     IF PI-COMPANY-ID = 'DCC'
 10525        CONTINUE
 10526     ELSE
 10527        MOVE AL-SADOF            TO CTPLABLA
 10528                                    CLPTOLPA
 10529                                    LCLABLA
 10530                                    LCOMMA
 10531                                    MAXFEEHA
 10532                                    CLPSTHA
 10533                                    PRODCDHA
 10534     END-IF
 10535     IF PI-COMPANY-ID = 'NCL' OR 'LGX'
 10536        MOVE -1                  TO CSRL.
 10537
 10538     IF  CLAIM-SESSION
 10539         MOVE SPACES             TO PF1PF2O
 10540         MOVE AL-SANOF           TO PF1PF2A.
 10541
 10542
 10543* EXEC CICS SEND
 10544*        MAP      (MAP-NAME)
 10545*        MAPSET   (MAPSET-NAME)
 10546*        FROM     (EL6501AO)
 10547*        ERASE
 10548*        CURSOR
 10549*    END-EXEC.
 10550     MOVE LENGTH OF
 10551      EL6501AO
 10552       TO DFHEIV12
 10553     MOVE -1
 10554       TO DFHEIV11
 10555*    MOVE '8$     CT  E    H L F ,   #00009438' TO DFHEIV0
 10556     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 10557     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 10558     MOVE X'2020233030303039343338' TO DFHEIV0(25:11)
 10559     CALL 'kxdfhei1' USING DFHEIV0,
 10560           MAP-NAME,
 10561           EL6501AO,
 10562           DFHEIV12,
 10563           MAPSET-NAME,
 10564           DFHEIV99,
 10565           DFHEIV99,
 10566           DFHEIV99,
 10567           DFHEIV11,
 10568           DFHEIV99,
 10569           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 204
* EL6501.cbl
 10570           DFHEIV99
 10571     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10572
 10573
 10574     GO TO 9100-RETURN-TRAN.
 10575
 10576 8200-SEND-DATAONLY.
 10577     MOVE SAVE-DATE              TO DATEO.
 10578     MOVE EIBTIME                TO TIME-IN.
 10579     MOVE TIME-OUT               TO TIMEO.
 10580     MOVE PI-COMPANY-ID          TO CMPNYIDO.
 10581     MOVE PI-PROCESSOR-ID        TO USERIDO.
 10582     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O.
 10583
 10584     MOVE PI-AH-OVERRIDE-L6      TO AHHEADO.
 10585
 10586     IF PI-COMPANY-ID = 'DCC'
 10587        CONTINUE
 10588     ELSE
 10589        MOVE AL-SADOF            TO CTPLABLA
 10590                                    CLPTOLPA
 10591                                    LCLABLA
 10592                                    LCOMMA
 10593                                    MAXFEEHA
 10594                                    CLPSTHA
 10595                                    PRODCDHA
 10596     END-IF
 10597     IF  CLAIM-SESSION
 10598         MOVE SPACES             TO PF1PF2O
 10599         MOVE AL-SANOF           TO PF1PF2A.
 10600
 10601
 10602* EXEC CICS SEND
 10603*        MAP      (MAP-NAME)
 10604*        MAPSET   (MAPSET-NAME)
 10605*        FROM     (EL6501AO)
 10606*        DATAONLY
 10607*        CURSOR
 10608*    END-EXEC.
 10609     MOVE LENGTH OF
 10610      EL6501AO
 10611       TO DFHEIV12
 10612     MOVE -1
 10613       TO DFHEIV11
 10614*    MOVE '8$D    CT       H L F ,   #00009473' TO DFHEIV0
 10615     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 10616     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 10617     MOVE X'2020233030303039343733' TO DFHEIV0(25:11)
 10618     CALL 'kxdfhei1' USING DFHEIV0,
 10619           MAP-NAME,
 10620           EL6501AO,
 10621           DFHEIV12,
 10622           MAPSET-NAME,
 10623           DFHEIV99,
 10624           DFHEIV99,
 10625           DFHEIV99,
 10626           DFHEIV11,
 10627           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 205
* EL6501.cbl
 10628           DFHEIV99,
 10629           DFHEIV99
 10630     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10631
 10632
 10633     GO TO 9100-RETURN-TRAN.
 10634
 10635 8300-SEND-TEXT.
 10636
 10637* EXEC CICS SEND TEXT
 10638*        FROM     (LOGOFF-TEXT)
 10639*        LENGTH   (LOGOFF-LENGTH)
 10640*        ERASE
 10641*        FREEKB
 10642*    END-EXEC.
 10643*    MOVE '8&      T  E F  H   F -   #00009484' TO DFHEIV0
 10644     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 10645     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 10646     MOVE X'2020233030303039343834' TO DFHEIV0(25:11)
 10647     CALL 'kxdfhei1' USING DFHEIV0,
 10648           LOGOFF-TEXT,
 10649           LOGOFF-LENGTH,
 10650           DFHEIV99,
 10651           DFHEIV99,
 10652           DFHEIV99,
 10653           DFHEIV99,
 10654           DFHEIV99,
 10655           DFHEIV99,
 10656           DFHEIV99,
 10657           DFHEIV99,
 10658           DFHEIV99,
 10659           DFHEIV99
 10660     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10661
 10662
 10663
 10664* EXEC CICS RETURN
 10665*    END-EXEC.
 10666*    MOVE '.(                    ''   #00009491' TO DFHEIV0
 10667     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 10668     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10669     MOVE X'2020233030303039343931' TO DFHEIV0(25:11)
 10670     CALL 'kxdfhei1' USING DFHEIV0,
 10671           DFHEIV99,
 10672           DFHEIV99,
 10673           DFHEIV99,
 10674           DFHEIV99,
 10675           DFHEIV99,
 10676           DFHEIV99
 10677     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10678
 10679
 10680 8600-DEEDIT.
 10681
 10682* EXEC CICS BIF DEEDIT
 10683*         FIELD(DEEDIT-FIELD)
 10684*         LENGTH(15)
 10685*     END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 206
* EL6501.cbl
 10686     MOVE 15
 10687       TO DFHEIV11
 10688*    MOVE '@"L                   #   #00009495' TO DFHEIV0
 10689     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10690     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10691     MOVE X'2020233030303039343935' TO DFHEIV0(25:11)
 10692     CALL 'kxdfhei1' USING DFHEIV0,
 10693           DEEDIT-FIELD,
 10694           DFHEIV11
 10695     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10696
 10697
 10698 8800-UNAUTHORIZED-ACCESS.
 10699     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 10700     GO TO 8300-SEND-TEXT.
 10701
 10702 8810-PF23.
 10703     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 10704     MOVE XCTL-005               TO PGM-NAME.
 10705     GO TO 9300-XCTL.
 10706
 10707 9100-RETURN-TRAN.
 10708     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 10709     MOVE SCREEN-NUMBER          TO PI-CURRENT-SCREEN-NO.
 10710
 10711* EXEC CICS RETURN
 10712*        TRANSID    (TRANS-ID)
 10713*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 10714*        LENGTH     (WS-COMM-LENGTH)
 10715*    END-EXEC.
 10716*    MOVE '.(CT                  ''   #00009512' TO DFHEIV0
 10717     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 10718     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10719     MOVE X'2020233030303039353132' TO DFHEIV0(25:11)
 10720     CALL 'kxdfhei1' USING DFHEIV0,
 10721           TRANS-ID,
 10722           PROGRAM-INTERFACE-BLOCK,
 10723           WS-COMM-LENGTH,
 10724           DFHEIV99,
 10725           DFHEIV99,
 10726           DFHEIV99
 10727     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10728
 10729
 10730 9200-RETURN-MAIN-MENU.
 10731     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10732         MOVE XCTL-126           TO  PGM-NAME
 10733     ELSE
 10734         MOVE XCTL-626           TO  PGM-NAME.
 10735
 10736     GO TO 9300-XCTL.
 10737
 10738 9300-XCTL.
 10739
 10740* EXEC CICS XCTL
 10741*        PROGRAM    (PGM-NAME)
 10742*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 10743*        LENGTH     (WS-COMM-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 207
* EL6501.cbl
 10744*    END-EXEC.
 10745*    MOVE '.$C                   %   #00009527' TO DFHEIV0
 10746     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 10747     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10748     MOVE X'2020233030303039353237' TO DFHEIV0(25:11)
 10749     CALL 'kxdfhei1' USING DFHEIV0,
 10750           PGM-NAME,
 10751           PROGRAM-INTERFACE-BLOCK,
 10752           WS-COMM-LENGTH,
 10753           DFHEIV99
 10754     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10755
 10756
 10757 9400-CLEAR.
 10758     IF PI-GA-BILLING
 10759        IF GETMAIN-ACQUIRED
 10760           MOVE PI-COMM-POINTER TO LCP-WS-ADDR-COMP
 10761           SET ADDRESS OF COMMISSION-WORK-AREA TO LCP-WS-ADDR-PNTR
 10762
 10763* EXEC CICS FREEMAIN
 10764*               DATA     (COMMISSION-WORK-AREA)
 10765*          END-EXEC.
 10766*    MOVE ',$D                   "   #00009538' TO DFHEIV0
 10767     MOVE X'2C2444202020202020202020' TO DFHEIV0(1:12)
 10768     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 10769     MOVE X'2020233030303039353338' TO DFHEIV0(25:11)
 10770     CALL 'kxdfhei1' USING DFHEIV0,
 10771           COMMISSION-WORK-AREA
 10772     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10773
 10774
 10775     MOVE SPACES                 TO PI-SV-MAINT.
 10776     MOVE XCTL-650               TO PGM-NAME.
 10777     MOVE XCTL-650               TO PI-RETURN-TO-PROGRAM.
 10778     GO TO 9300-XCTL.
 10779
 10780 9500-PF12.
 10781     MOVE XCTL-010               TO PGM-NAME.
 10782     GO TO 9300-XCTL.
 10783
 10784 9600-PGMID-ERROR.
 10785
 10786* EXEC CICS HANDLE CONDITION
 10787*        PGMIDERR    (8300-SEND-TEXT)
 10788*    END-EXEC.
 10789*    MOVE '"$L                   ! 5 #00009552' TO DFHEIV0
 10790     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 10791     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10792     MOVE X'3520233030303039353532' TO DFHEIV0(25:11)
 10793     CALL 'kxdfhei1' USING DFHEIV0
 10794     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10795
 10796
 10797     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
 10798     MOVE ' '                    TO PI-ENTRY-CD-1.
 10799     MOVE XCTL-005               TO PGM-NAME.
 10800     MOVE PGM-NAME               TO LOGOFF-PGM.
 10801     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 208
* EL6501.cbl
 10802     GO TO 9300-XCTL.
 10803
 10804 9700-DATE-LINK.
 10805     MOVE LINK-ELDATCV           TO PGM-NAME.
 10806
 10807* EXEC CICS LINK
 10808*        PROGRAM    (PGM-NAME)
 10809*        COMMAREA   (DATE-CONVERSION-DATA)
 10810*        LENGTH     (DC-COMM-LENGTH)
 10811*    END-EXEC.
 10812*    MOVE '."C                   (   #00009565' TO DFHEIV0
 10813     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10814     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10815     MOVE X'2020233030303039353635' TO DFHEIV0(25:11)
 10816     CALL 'kxdfhei1' USING DFHEIV0,
 10817           PGM-NAME,
 10818           DATE-CONVERSION-DATA,
 10819           DC-COMM-LENGTH,
 10820           DFHEIV99,
 10821           DFHEIV99,
 10822           DFHEIV99,
 10823           DFHEIV99
 10824     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10825
 10826
 10827 9900-ERROR-FORMAT.
 10828     IF NOT EMI-ERRORS-COMPLETE
 10829         MOVE LINK-001           TO PGM-NAME
 10830
 10831* EXEC CICS LINK
 10832*            PROGRAM    (PGM-NAME)
 10833*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 10834*            LENGTH     (EMI-COMM-LENGTH)
 10835*        END-EXEC.
 10836*    MOVE '."C                   (   #00009574' TO DFHEIV0
 10837     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10838     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10839     MOVE X'2020233030303039353734' TO DFHEIV0(25:11)
 10840     CALL 'kxdfhei1' USING DFHEIV0,
 10841           PGM-NAME,
 10842           ERROR-MESSAGE-INTERFACE-BLOCK,
 10843           EMI-COMM-LENGTH,
 10844           DFHEIV99,
 10845           DFHEIV99,
 10846           DFHEIV99,
 10847           DFHEIV99
 10848     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10849
 10850
 10851 9900-EXIT.
 10852     EXIT.
 10853
 10854 9990-ABEND.
 10855     MOVE LINK-004               TO PGM-NAME.
 10856     MOVE DFHEIBLK               TO EMI-LINE1.
 10857
 10858* EXEC CICS LINK
 10859*        PROGRAM   (PGM-NAME)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 209
* EL6501.cbl
 10860*        COMMAREA  (EMI-LINE1)
 10861*        LENGTH    (72)
 10862*    END-EXEC.
 10863     MOVE 72
 10864       TO DFHEIV11
 10865*    MOVE '."C                   (   #00009586' TO DFHEIV0
 10866     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10867     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10868     MOVE X'2020233030303039353836' TO DFHEIV0(25:11)
 10869     CALL 'kxdfhei1' USING DFHEIV0,
 10870           PGM-NAME,
 10871           EMI-LINE1,
 10872           DFHEIV11,
 10873           DFHEIV99,
 10874           DFHEIV99,
 10875           DFHEIV99,
 10876           DFHEIV99
 10877     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10878
 10879
 10880     MOVE -1                     TO PFENTERL.
 10881     GO TO 8200-SEND-DATAONLY.
 10882
 10883
 10884* GOBACK.
 10885     MOVE '9%                    "   ' TO DFHEIV0
 10886     MOVE 'EL6501' TO DFHEIV1
 10887     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10888     GOBACK.
 10889
 10890 9995-SECURITY-VIOLATION.
 10891*                            COPY ELCSCTP.
 10892******************************************************************
 10893*                                                                *
 10894*                            ELCSCTP                             *
 10895*                            VMOD=2.001                          *
 10896*                                                                *
 10897*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 10898******************************************************************
 10899
 10900
 10901     MOVE EIBDATE          TO SM-JUL-DATE.
 10902     MOVE EIBTRMID         TO SM-TERMID.
 10903     MOVE THIS-PGM         TO SM-PGM.
 10904     MOVE EIBTIME          TO TIME-IN.
 10905     MOVE TIME-OUT         TO SM-TIME.
 10906     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 10907
 10908
 10909* EXEC CICS LINK
 10910*         PROGRAM  ('EL003')
 10911*         COMMAREA (SECURITY-MESSAGE)
 10912*         LENGTH   (80)
 10913*    END-EXEC.
 10914     MOVE 'EL003' TO DFHEIV1
 10915     MOVE 80
 10916       TO DFHEIV11
 10917*    MOVE '."C                   (   #00009615' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 210
* EL6501.cbl
 10918     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10919     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10920     MOVE X'2020233030303039363135' TO DFHEIV0(25:11)
 10921     CALL 'kxdfhei1' USING DFHEIV0,
 10922           DFHEIV1,
 10923           SECURITY-MESSAGE,
 10924           DFHEIV11,
 10925           DFHEIV99,
 10926           DFHEIV99,
 10927           DFHEIV99,
 10928           DFHEIV99
 10929     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10930
 10931
 10932******************************************************************
 10933
 10934
 10935 9995-EXIT.
 10936     EXIT.
 10937
 10938 9999-DFHBACK SECTION.
 10939     MOVE '9%                    "   ' TO DFHEIV0
 10940     MOVE 'EL6501' TO DFHEIV1
 10941     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10942     GOBACK.
 10943 9999-DFHEXIT.
 10944     IF DFHEIGDJ EQUAL 0001
 10945         NEXT SENTENCE
 10946     ELSE IF DFHEIGDJ EQUAL 2
 10947         GO TO 9600-PGMID-ERROR,
 10948               9990-ABEND,
 10949               0500-CHECK-MAINT-TYPE
 10950         DEPENDING ON DFHEIGDI
 10951     ELSE IF DFHEIGDJ EQUAL 3
 10952         GO TO 1500-EXIT
 10953         DEPENDING ON DFHEIGDI
 10954     ELSE IF DFHEIGDJ EQUAL 4
 10955         GO TO 1799-EXIT,
 10956               1799-EXIT
 10957         DEPENDING ON DFHEIGDI
 10958     ELSE IF DFHEIGDJ EQUAL 5
 10959         GO TO 2100-EXIT
 10960         DEPENDING ON DFHEIGDI
 10961     ELSE IF DFHEIGDJ EQUAL 6
 10962         GO TO 2200-EXIT
 10963         DEPENDING ON DFHEIGDI
 10964     ELSE IF DFHEIGDJ EQUAL 7
 10965         GO TO 3030-END-FILE
 10966         DEPENDING ON DFHEIGDI
 10967     ELSE IF DFHEIGDJ EQUAL 8
 10968         GO TO 3530-END-FILE
 10969         DEPENDING ON DFHEIGDI
 10970     ELSE IF DFHEIGDJ EQUAL 9
 10971         GO TO 4020-BUS-TYPE-ERROR
 10972         DEPENDING ON DFHEIGDI
 10973     ELSE IF DFHEIGDJ EQUAL 10
 10974         GO TO 4099-STD-BEN-ERROR
 10975         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 211
* EL6501.cbl
 10976     ELSE IF DFHEIGDJ EQUAL 11
 10977         GO TO 4180-REIN-ERROR
 10978         DEPENDING ON DFHEIGDI
 10979     ELSE IF DFHEIGDJ EQUAL 12
 10980         GO TO 5250-QID-ERROR
 10981         DEPENDING ON DFHEIGDI
 10982     ELSE IF DFHEIGDJ EQUAL 13
 10983         GO TO 5399-EXIT,
 10984               5399-EXIT
 10985         DEPENDING ON DFHEIGDI
 10986     ELSE IF DFHEIGDJ EQUAL 14
 10987         GO TO 6450-NOT-FOUND
 10988         DEPENDING ON DFHEIGDI
 10989     ELSE IF DFHEIGDJ EQUAL 15
 10990         GO TO 6699-EXIT
 10991         DEPENDING ON DFHEIGDI
 10992     ELSE IF DFHEIGDJ EQUAL 16
 10993         GO TO 6880-NO-COMP
 10994         DEPENDING ON DFHEIGDI
 10995     ELSE IF DFHEIGDJ EQUAL 17
 10996         GO TO 6925-NOT-FIND,
 10997               6925-NOT-FIND
 10998         DEPENDING ON DFHEIGDI
 10999     ELSE IF DFHEIGDJ EQUAL 18
 11000         GO TO 7999-EXIT,
 11001               7999-EXIT
 11002         DEPENDING ON DFHEIGDI
 11003     ELSE IF DFHEIGDJ EQUAL 19
 11004         GO TO 8010-EXIT
 11005         DEPENDING ON DFHEIGDI
 11006     ELSE IF DFHEIGDJ EQUAL 20
 11007         GO TO 8055-NOTFND
 11008         DEPENDING ON DFHEIGDI
 11009     ELSE IF DFHEIGDJ EQUAL 21
 11010         GO TO 8300-SEND-TEXT
 11011         DEPENDING ON DFHEIGDI.
 11012     MOVE '9%                    "   ' TO DFHEIV0
 11013     MOVE 'EL6501' TO DFHEIV1
 11014     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 11015     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       39340     Code:       34961
