* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page   1
* EL6311.cbl
* Options: int("EL6311.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL6311.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL6311.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL6311.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 ID DIVISION.
     2
     3 PROGRAM-ID.                 EL6311.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/20/94 16:50:32.
     7*                            VMOD=2.089.
     8*
     9*AUTHOR.     LOGIC,INC.
    10*            DALLAS, TEXAS.
    11
    12*DATE-COMPILED.
    13
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page   2
* EL6311.cbl
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    20*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    21*            *                                                   *
    22*            *****************************************************
    23
    24*REMARKS.
    25*        TRANSACTION - EXB1 - NEW BUSINESS, REVIEW AND CORRECTION
    26*                             ISSUES, CANCELS, AND BATCH HEADERS
    27******************************************************************
    28*                   C H A N G E   L O G
    29*
    30* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    31*-----------------------------------------------------------------
    32*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    33* EFFECTIVE    NUMBER
    34*-----------------------------------------------------------------
    35* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
    36* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    37* 011904                   PEMA  ADD TOTAL FEE PROCESSING
    38* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
    39* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
    40* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
    41* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
    42* 090607  CR2007010300001  PEMA  ADD CO TYPE TO OVERCHARGE
    43* 030708  CR2007092500001  PEMA  ADD VA DISCLOSURE PROCESSING
    44* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
    45* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
    46* 102408  CR2008080500002  PEMA  ADD BILLING NOTE FOR EC OF P
    47* 072009  IR2009062300002  AJRA  RESET CALC FLAG ON CHANGE
    48* 072209  CR2008101500003  AJRA  PRINT BORROWER FIRST NAME
    49* 111109  CR2008100900003  AJRA  CHANGE PF8 TO NEW CERT NOTE SCRN
    50* 032210  IR2010022400001  PEMA  CORRECT PF5 LOGIC, ADD APR PROC
    51* 101110  CR2010091000002  PEMA  ENHANCE PREMIUM EDIT
    52* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
    53* 100111  CR2011022800001  AJRA  NAPERSOFT VA DISC
    54* 010412  CR2011022800001  AJRA  NAPERSOFT
    55* 032612  CR2011110200001  PEMA  AHL CHANGES
    56* 062712  CR2011022800001  AJRA  REDEFINE ORIG DATA
    57* 072312  CR2011022800001  AJRA  NAPERSOFT MISC
    58* 091112  IR2012091100002  AJRA  FIX AKA
    59* 091312  IR2012091100004  AJRA  FIX ADDRESS CHECK
    60* 091712  IR2012091400003  AJRA  CHANGE PF6 TO GO TO CANCEL TRANS
    61* 100412  IR2012100300002  AJRA  FIX VA DISC FOR DISAB ONLY CERT
    62* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
    63* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    64* 080713  CR2012032000002  AJRA  HIGHLIGHT AGE ERRORS
    65******************************************************************
    66
    67 ENVIRONMENT DIVISION.
    68
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page   3
* EL6311.cbl
    70 DATA DIVISION.
    71 WORKING-STORAGE SECTION.
    72 01  DFH-START PIC X(04).
    73 77  LCP-ONCTR-01                  PIC S9(8) COMP-3 VALUE ZERO.
    74 77  LCP-ONCTR-02                  PIC S9(8) COMP-3 VALUE ZERO.
    75 77  FILLER  PIC X(32)  VALUE '********************************'.
    76 77  FILLER  PIC X(32)  VALUE '*    EL6311 WORKING STORAGE    *'.
    77 77  FILLER  PIC X(32)  VALUE '************VMOD=2.089**********'.
    78 77  A1                          PIC S999 COMP-3 VALUE +0.
    79 77  N1                          PIC S999 COMP-3 VALUE +0.
    80 77  N2                          PIC S999 COMP-3 VALUE +0.
    81 77  N3                          PIC S999 COMP-3 VALUE +0.
    82 77  WS-OC-AMT                   PIC S9(9)V99 COMP-3 VALUE +0.
    83 77  WS-SAVE-ERPYAJ-KEY          PIC X(33) VALUE SPACES.
    84 77  WS-REVERSE-SW               PIC X VALUE 'N'.
    85     88  REVERSAL                    VALUE 'Y'.
    86 77  WS-NOTE-SW                  PIC X  VALUE ' '.
    87 77  WS-BEG                      PIC S999 COMP-3 VALUE +0.
    88 77  WS-END                      PIC S999 COMP-3 VALUE +0.
    89 77  WS-TALLY                    PIC 99  VALUE ZEROS.
    90 77  WS-ERMAIL-SW                PIC X  VALUE ' '.
    91     88  ERMAIL-FOUND                 VALUE 'Y'.
    92 77  A2                          PIC S9(5) COMP-3 VALUE +0.
    93 77  M1                          PIC S9(5) COMP-3 VALUE +0.
    94 77  WS-WORK-FIELD               PIC X(80)    VALUE SPACES.
    95 77  WS-CERT-TRL-REC-NOT-FOUND   PIC S9       VALUE +0.
    96     88  CERT-TRL-REC-NOT-FOUND     VALUE +1.
    97
    98*    COPY ELCSCTM.
    99******************************************************************
   100*                                                                *
   101*                                                                *
   102*                            ELCSCTM                             *
   103*                            VMOD=2.001                          *
   104*                                                                *
   105*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   106*                                                                *
   107******************************************************************
   108 01  SECURITY-MESSAGE.
   109     12  FILLER                          PIC X(30)
   110            VALUE '** LOGIC SECURITY VIOLATION -'.
   111     12  SM-READ                         PIC X(6).
   112     12  FILLER                          PIC X(5)
   113            VALUE ' PGM='.
   114     12  SM-PGM                          PIC X(6).
   115     12  FILLER                          PIC X(5)
   116            VALUE ' OPR='.
   117     12  SM-PROCESSOR-ID                 PIC X(4).
   118     12  FILLER                          PIC X(6)
   119            VALUE ' TERM='.
   120     12  SM-TERMID                       PIC X(4).
   121     12  FILLER                          PIC XX   VALUE SPACE.
   122     12  SM-JUL-DATE                     PIC 9(5).
   123     12  FILLER                          PIC X    VALUE SPACE.
   124     12  SM-TIME                         PIC 99.99.
   125
   126
   127*    COPY ELCSCRTY.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page   4
* EL6311.cbl
   128******************************************************************
   129*                                                                *
   130*                                                                *
   131*                            ELCSCRTY                            *
   132*                            VMOD=2.001                          *
   133*                                                                *
   134*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   135*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   136*        SAVED IN PI-SECURITY-ADDRESS.                           *
   137*                                                                *
   138******************************************************************
   139 01  SECURITY-CONTROL.
   140     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   141     12  FILLER                       PIC XX    VALUE 'SC'.
   142     12  SC-CREDIT-CODES.
   143         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   144             20  SC-CREDIT-DISPLAY    PIC X.
   145             20  SC-CREDIT-UPDATE     PIC X.
   146     12  SC-CLAIMS-CODES.
   147         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   148             20  SC-CLAIMS-DISPLAY    PIC X.
   149             20  SC-CLAIMS-UPDATE     PIC X.
   150
   151 01  WS-VA-NO-COMM-MESS.
   152     12  FILLER                  PIC X(41) VALUE
   153        'MAXIMUM AGE EXCEEDED - NO COMMISSION PAID'.
   154 01  WS-OC-MESSAGE.
   155     12  FILLER                  PIC X(43) VALUE
   156        'OVERCHARGE AUTO CORRECTED IN THE AMOUNT OF '.
   157     12  WS-OC-DIS-AMT           PIC -----9.99.
   158     12  FILLER                  PIC X(4) VALUE ' ON '.
   159     12  WS-OC-DATE              PIC X(10).
   160 01  WS-DATE-AREA.
   161     12  WS-TEMP-EFF-DT          PIC XX     VALUE LOW-VALUES.
   162     12  WS-CURRENT-DT.
   163         16  FILLER              PIC X(6)    VALUE SPACES.
   164         16  WS-CURRENT-YR       PIC XX      VALUE SPACES.
   165     12  WS-CURRENT-BIN-DT       PIC XX      VALUE SPACES.
   166     12  WS-CREDIT-SELECT-DT     PIC XX      VALUE SPACES.
   167     12  WS-MONTH-END-DT         PIC X(8)    VALUE SPACES.
   168
   169 01  STANDARD-AREAS.
   170     12  GETMAIN-SPACE           PIC X       VALUE SPACE.
   171     12  EL631B                  PIC X(8)    VALUE 'EL631B'.
   172     12  EL631C                  PIC X(8)    VALUE 'EL631C'.
   173     12  EL631D                  PIC X(8)    VALUE 'EL631D'.
   174     12  MAPSET-EL6311S          PIC X(8)    VALUE 'EL6311S'.
   175     12  SCREEN-NUMBER           PIC X(6)    VALUE 'EL631B'.
   176     12  TRANS-EXB1              PIC X(4)    VALUE 'EXB1'.
   177     12  THIS-PGM                PIC X(8)    VALUE 'EL6311'.
   178     12  PGM-NAME                PIC X(8).
   179     12  TIME-IN                 PIC S9(7).
   180     12  TIME-OUT-R  REDEFINES TIME-IN.
   181         16  FILLER              PIC X.
   182         16  TIME-OUT            PIC 99V99.
   183         16  FILLER              PIC XX.
   184     12  XCTL-EL001              PIC X(8)    VALUE 'EL001'.
   185     12  XCTL-EL005              PIC X(8)    VALUE 'EL005'.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page   5
* EL6311.cbl
   186     12  XCTL-EL010              PIC X(8)    VALUE 'EL010'.
   187     12  XCTL-EL127              PIC X(8)    VALUE 'EL127'.
   188     12  XCTL-EL1272             PIC X(8)    VALUE 'EL1272'.
   189     12  XCTL-EL1273             PIC X(8)    VALUE 'EL1273'.
   190     12  XCTL-EL1276             PIC X(8)    VALUE 'EL1276'.
   191     12  XCTL-EL1279             PIC X(8)    VALUE 'EL1279'.
   192     12  XCTL-EL401DMD           PIC X(8)    VALUE 'EL401DMD'.
   193     12  XCTL-EL626              PIC X(8)    VALUE 'EL626'.
   194     12  XCTL-EL631              PIC X(8)    VALUE 'EL631'.
   195     12  XCTL-EL6312             PIC X(8)    VALUE 'EL6312'.
   196     12  XCTL-EL6313             PIC X(8)    VALUE 'EL6313'.
   197     12  XCTL-EL6314             PIC X(8)    VALUE 'EL6314'.
   198     12  XCTL-EL6315             PIC X(8)    VALUE 'EL6315'.
   199     12  XCTL-EL6316             PIC X(8)    VALUE 'EL6316'.
   200     12  XCTL-EL640              PIC X(8)    VALUE 'EL640'.
   201     12  XCTL-EL650              PIC X(8)    VALUE 'EL650'.
   202     12  XCTL-EL677              PIC X(8)    VALUE 'EL677'.
   203     12  XCTL-EL680              PIC X(8)    VALUE 'EL680'.
   204     12  XCTL-EL689              PIC X(8)    VALUE 'EL689'.
   205     12  XCTL-EL690              PIC X(8)    VALUE 'EL690'.
   206     12  LINK-EL001              PIC X(8)    VALUE 'EL001'.
   207     12  LINK-EL004              PIC X(8)    VALUE 'EL004'.
   208     12  LINK-EL050              PIC X(8)    VALUE 'EL050'.
   209     12  LINK-ELDATCV            PIC X(8)    VALUE 'ELDATCV'.
   210     12  LINK-ELVADS             PIC X(8)    VALUE 'ELVADS'.
   211     12  FILE-ID                 PIC X(8).
   212     12  FILE-ID-ELCERT          PIC X(8)    VALUE 'ELCERT'.
   213     12  FILE-ID-ERPNDB          PIC X(8)    VALUE 'ERPNDB'.
   214     12  FILE-ID-ERPNDB2         PIC X(8)    VALUE 'ERPNDB2'.
   215     12  FILE-ID-ERPNDB3         PIC X(8)    VALUE 'ERPNDB3'.
   216     12  FILE-ID-ERPNDB4         PIC X(8)    VALUE 'ERPNDB4'.
   217     12  FILE-ID-ERPNDM          PIC X(8)    VALUE 'ERPNDM'.
   218     12  FILE-ID-ERNOTE          PIC X(8)    VALUE 'ERNOTE'.
   219     12  FILE-ID-ERCNOT          PIC X(8)    VALUE 'ERCNOT'.
   220     12  FILE-ID-ERPYAJ          PIC X(8)    VALUE 'ERPYAJ'.
   221     12  FILE-ID-ERMAIL          PIC X(8)    VALUE 'ERMAIL'.
   222     12  FILE-ID-ERRQST          PIC X(8)    VALUE 'ERRQST'.
   223     12  FILE-ID-ERLOFC          PIC X(8)    VALUE 'ERLOFC'.
   224     12  CLMS-ID                 PIC X(8)    VALUE 'ELMSTR5'.
   225     12  FILE-ID-ERENDT          PIC X(8)    VALUE 'ERENDT'.
   226     12  CRTT-ID                 PIC X(8)    VALUE 'ELCRTT'.
   227
   228 01  WS-PASS-AREA.
   229     05  WS-PASS-AREA-LENGTH PIC S9(4) COMP VALUE +352.
   230     05  WS-PASS-VADS-REC    PIC X(350).
   231*** Z CONTROL LAYOUT MOVED TO COPYBOOK ELCZREC
   232*                                COPY ELCZREC.
   233******************************************************************
   234*                                                                *
   235*                                                                *
   236*                            ELCZREC.                            *
   237*                                                                *
   238*   FILE DESCRIPTION = Z CONTROL RECORD LAYOUT                   *
   239*                                                                *
   240******************************************************************
   241*-----------------------------------------------------------------
   242*                   C H A N G E   L O G
   243*
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page   6
* EL6311.cbl
   244* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   245*-----------------------------------------------------------------
   246*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   247* EFFECTIVE    NUMBER
   248*-----------------------------------------------------------------
   249* 122011    2011022800001  AJRA  NEW FILE
   250* 073112    2011022800001  AJRA  ADD ACCT SUMM, CSO SUMM
   251* 122712    2012101700002  AJRA  ADD REASON CODE REQUIRED FLAG
   252*-----------------------------------------------------------------
   253 01  W-Z-CONTROL-DATA.
   254     05  W-NUMBER-OF-COPIES      PIC  9.
   255     05  FILLER                  PIC  X.
   256     05  W-DAYS-TO-FOLLOW-UP     PIC  999.
   257     05  FILLER                  PIC  X.
   258     05  W-DAYS-TO-RESEND        PIC  999.
   259     05  FILLER                  PIC  X.
   260     05  W-FORM-TO-RESEND        PIC  X(4).
   261     05  FILLER                  PIC  X.
   262     05  W-PROMPT-LETTER         PIC  X.
   263     05  FILLER                  PIC  X.
   264     05  W-ENCLOSURE-CD          PIC  XXX.
   265     05  FILLER                  PIC  X.
   266     05  W-AUTO-CLOSE-IND        PIC  X.
   267     05  FILLER                  PIC  X.
   268     05  W-LETTER-TO-BENE        PIC  X.
   269     05  FILLER                  PIC  X.
   270     05  W-LETTER-TO-ACCT        PIC  X.
   271     05  FILLER                  PIC  X.
   272     05  W-LETTER-TYPE           PIC  X.
   273     05  FILLER                  PIC  X.
   274     05  W-PRINT-CERTIFICATE     PIC  X.
   275     05  FILLER                  PIC  X.
   276     05  W-REFUND-REQUIRED       PIC  X.
   277     05  FILLER                  PIC  X.
   278     05  W-ONBASE-CODE           PIC  XX.
   279     05  FILLER                  PIC  X.
   280     05  W-ACCT-SUMM             PIC  X.
   281     05  FILLER                  PIC  X.
   282     05  W-CSO-SUMM              PIC  X.
   283     05  FILLER                  PIC  X.
   284     05  W-REASONS-REQUIRED      PIC  X.
   285     05  FILLER                  PIC  X(29).
   286******************************************************************
   287*                                                                *
   288*              A C C E S S   K E Y S                             *
   289*                                                                *
   290******************************************************************
   291
   292 01  ACCESS-KEYS.
   293     12  ERPYAJ-KEY.
   294         16  ERPYAJ-COMPANY-CD       PIC X.
   295         16  ERPYAJ-CARRIER          PIC X.
   296         16  ERPYAJ-GROUPING         PIC X(6).
   297         16  ERPYAJ-FIN-RESP         PIC X(10).
   298         16  ERPYAJ-ACCOUNT          PIC X(10).
   299         16  ERPYAJ-SEQ-NO           PIC S9(8) COMP.
   300         16  ERPYAJ-TYPE             PIC X.
   301     12  ERPYAJ-RECORD-LENGTH        PIC S9(4) COMP VALUE +200.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page   7
* EL6311.cbl
   302     12  ELCERT-KEY.
   303         16  ELCERT-COMPANY-CD       PIC X.
   304         16  ELCERT-CARRIER          PIC X.
   305         16  ELCERT-GROUPING         PIC X(6).
   306         16  ELCERT-STATE            PIC XX.
   307         16  ELCERT-ACCOUNT          PIC X(10).
   308         16  ELCERT-CERT-EFF-DT      PIC XX.
   309         16  ELCERT-CERT-NO.
   310             20  ELCERT-CERT-PRIME   PIC X(10).
   311             20  ELCERT-CERT-SFX     PIC X.
   312
   313     12  ELCERT-RECORD-LENGTH        PIC S9(4) COMP VALUE +450.
   314     12  ELCERT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +473.
   315     12  ELCRTO-KEY.
   316         16  ELCRTO-COMPANY-CD       PIC X.
   317         16  ELCRTO-CARRIER          PIC X.
   318         16  ELCRTO-GROUPING         PIC X(6).
   319         16  ELCRTO-STATE            PIC XX.
   320         16  ELCRTO-ACCOUNT          PIC X(10).
   321         16  ELCRTO-CERT-EFF-DT      PIC XX.
   322         16  ELCRTO-CERT-NO.
   323             20  ELCRTO-CERT-PRIME   PIC X(10).
   324             20  ELCRTO-CERT-SFX     PIC X.
   325         16  ELCRTO-RECORD-TYPE      PIC X.
   326         16  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
   327
   328     12  ELCRTT-KEY.
   329         16  ELCRTT-PRIMARY          PIC X(33).
   330         16  ELCRTT-REC-TYPE         PIC X(1).
   331     12  ELCRTT-RECORD-LENGTH        PIC S9(4) COMP VALUE +552.
   332     12  ELCRTT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +575.
   333
   334     12  ERPNDB-KEY.
   335         16  ERPNDB-COMPANY-CD       PIC X        VALUE SPACE.
   336         16  ERPNDB-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
   337         16  ERPNDB-BATCH-SEQ-NO     PIC S9(4)    VALUE +0 COMP.
   338         16  ERPNDB-BATCH-SEQ-ALPHA  REDEFINES
   339             ERPNDB-BATCH-SEQ-NO     PIC XX.
   340         16  ERPNDB-BATCH-CHG-SEQ-NO PIC S9(4)    VALUE +0 COMP.
   341
   342     12  ERPNDB-RECORD-LENGTH        PIC S9(4) COMP VALUE +585.
   343     12  ERPNDB-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +608.
   344     12  ELLETR-KEY.
   345         16  LETR-COMPANY-CD     PIC X.
   346         16  LETR-LETTER-ID      PIC X(4).
   347         16  LETR-FILLER         PIC X(8).
   348         16  LETR-SEQ-NO         PIC 9(4) BINARY.
   349     12  ERPNDM-KEY.
   350         16  ERPNDM-COMPANY-CD       PIC X        VALUE SPACE.
   351         16  ERPNDM-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
   352         16  ERPNDM-BATCH-SEQ        PIC S9(4)    VALUE +1 COMP.
   353         16  ERPNDM-BATCH-CHG-SEQ    PIC S9(4)    VALUE +0 COMP.
   354
   355*    12  ERPNDM-RECORD-LENGTH        PIC S9(4) COMP VALUE +250.
   356     12  ERPNDM-RECORD-LENGTH        PIC S9(4) COMP VALUE +374.
   357*    12  ERPNDM-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +273.
   358     12  ERPNDM-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +397.
   359
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page   8
* EL6311.cbl
   360     12  ERPNDB-ALT-KEY.
   361         16  ERPNDB-COMPANY-CD-A1    PIC X        VALUE SPACE.
   362         16  ERPNDB-CARRIER          PIC X        VALUE SPACES.
   363         16  ERPNDB-GROUPING         PIC X(6)     VALUE SPACES.
   364         16  ERPNDB-STATE            PIC XX       VALUE SPACES.
   365         16  ERPNDB-ACCOUNT          PIC X(10)    VALUE SPACES.
   366         16  ERPNDB-CERT-EFF-DT      PIC XX       VALUE SPACES.
   367         16  ERPNDB-CERT-NO.
   368             20  ERPNDB-CERT-PRIME   PIC X(10)    VALUE SPACES.
   369             20  ERPNDB-CERT-SFX     PIC X        VALUE SPACE.
   370         16  ERPNDB-ALT-CHG-SEQ-NO   PIC S9(4)    VALUE +0 COMP.
   371         16  ERPNDB-RECORD-TYPE      PIC X.
   372
   373      12  ERPNDB-CSR-KEY.
   374          20  ERPNDB-CSR-COMPANY-CD-A2     PIC X.
   375          20  ERPNDB-CSR-ID                PIC X(4).
   376          20  ERPNDB-CSR-ENTRY-BATCH       PIC X(6).
   377          20  ERPNDB-CSR-BTCH-SEQ-NO       PIC S9(4)     COMP.
   378          20  ERPNDB-CSR-BTCH-CHG-SEQ      PIC S9(4)     COMP.
   379
   380     12  ERNOTE-KEY.
   381         16  ERNOTE-COMPANY-CD       PIC X        VALUE SPACE.
   382         16  ERNOTE-CARRIER          PIC X        VALUE SPACES.
   383         16  ERNOTE-GROUPING         PIC X(6)     VALUE SPACES.
   384         16  ERNOTE-STATE            PIC XX       VALUE SPACES.
   385         16  ERNOTE-ACCOUNT          PIC X(10)    VALUE SPACES.
   386         16  ERNOTE-CERT-EFF-DT      PIC XX       VALUE SPACES.
   387         16  ERNOTE-CERT-NO.
   388             20  ERNOTE-CERT-PRIME   PIC X(10)    VALUE SPACES.
   389             20  ERNOTE-CERT-SFX     PIC X        VALUE SPACES.
   390
   391     12  ERNOTE-RECORD-LENGTH        PIC S9(4) COMP VALUE +825.
   392     12  ERNOTE-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +848.
   393
   394     12  ERCNOT-KEY.
   395         16  ERCNOT-PART-KEY.
   396             20  ERCNOT-COMPANY-CD   PIC X        VALUE SPACE.
   397             20  ERCNOT-CARRIER      PIC X        VALUE SPACES.
   398             20  ERCNOT-GROUPING     PIC X(6)     VALUE SPACES.
   399             20  ERCNOT-STATE        PIC XX       VALUE SPACES.
   400             20  ERCNOT-ACCOUNT      PIC X(10)    VALUE SPACES.
   401             20  ERCNOT-CERT-EFF-DT  PIC XX       VALUE SPACES.
   402             20  ERCNOT-CERT-NO.
   403                 25  ERCNOT-CERT-PRIME PIC X(10)  VALUE SPACES.
   404                 25  ERCNOT-CERT-SFX PIC X        VALUE SPACES.
   405         16  ERCNOT-REC-TYPE         PIC X        VALUE SPACES.
   406         16  ERCNOT-SEQUENCE         PIC S9(4) COMP VALUE +0.
   407
   408     12  ERCNOT-RECORD-LENGTH        PIC S9(4) COMP VALUE +150.
   409     12  ERCNOT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +173.
   410
   411     12  ERMAIL-KEY.
   412         16  ERMAIL-COMPANY-CD       PIC X        VALUE SPACE.
   413         16  ERMAIL-CARRIER          PIC X        VALUE SPACES.
   414         16  ERMAIL-GROUPING         PIC X(6)     VALUE SPACES.
   415         16  ERMAIL-STATE            PIC XX       VALUE SPACES.
   416         16  ERMAIL-ACCOUNT          PIC X(10)    VALUE SPACES.
   417         16  ERMAIL-CERT-EFF-DT      PIC XX       VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page   9
* EL6311.cbl
   418         16  ERMAIL-CERT-NO.
   419             20  ERMAIL-CERT-PRIME   PIC X(10)    VALUE SPACES.
   420             20  ERMAIL-CERT-SFX     PIC X        VALUE SPACES.
   421
   422     12  ERMAIL-RECORD-LENGTH        PIC S9(4) COMP VALUE +374.
   423     12  ERMAIL-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +393.
   424
   425     12  ERRQST-KEY.
   426         16  ERRQST-COMPANY-CD       PIC X        VALUE SPACE.
   427         16  ERRQST-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
   428
   429     12  ERRQST-RECORD-LENGTH        PIC S9(4) COMP VALUE +200.
   430     12  ERRQST-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +223.
   431
   432     12  WS-JOURNAL-RECORD-LENGTH    PIC S9(4) COMP VALUE +0000.
   433
   434     12  ERLOFC-KEY.
   435         16  ERLOFC-COMPANY-CD          PIC  X.
   436         16  ERLOFC-CARRIER             PIC  X.
   437         16  ERLOFC-GROUPING            PIC  X(6).
   438         16  ERLOFC-STATE               PIC  XX.
   439         16  ERLOFC-ACCOUNT             PIC  X(10).
   440         16  ERLOFC-OFFICER-CODE        PIC  X(5).
   441*        16  ERLOFC-OFFICER-CODE        PIC  XXX.
   442
   443     12  ERACCT-KEY.
   444         16  ERACCT-COMPANY-CD          PIC  X.
   445         16  ERACCT-CARRIER             PIC  X.
   446         16  ERACCT-GROUPING            PIC  X(6).
   447         16  ERACCT-STATE               PIC  XX.
   448         16  ERACCT-ACCOUNT             PIC  X(10).
   449         16  ERACCT-EXP-DT.
   450             20  ERACCT-DT              PIC  XX.
   451             20  ERACCT-FILL            PIC  X(4).
   452
   453     12  ERENDT-KEY.
   454         16  ENDT-COMPANY-CD       PIC X.
   455         16  ENDT-CARRIER          PIC X.
   456         16  ENDT-GROUPING         PIC X(6).
   457         16  ENDT-STATE            PIC XX.
   458         16  ENDT-ACCOUNT          PIC X(10).
   459         16  ENDT-CERT-EFF-DT      PIC XX.
   460         16  ENDT-CERT-PRIME       PIC X(10).
   461         16  ENDT-CERT-SFX         PIC X.
   462         16  ENDT-RECORD-TYPE      PIC X.
   463         16  ENDT-SEQ-NO           PIC 9(4) BINARY.
   464
   465 01  WS-ELMSTR-WORK.
   466     12  ELMSTR-KEY.
   467         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
   468         16  MSTR-CERT-NO.
   469             20  MSTR-CERT-PRIME  PIC X(10)   VALUE SPACES.
   470             20  MSTR-CERT-SFX    PIC X(1)    VALUE SPACES.
   471     12  W-CLAIM-KEY.
   472         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
   473         16  W-CL-CERT-NO.
   474             20  W-CL-CERT-PRIME  PIC X(10)   VALUE SPACES.
   475             20  W-CL-CERT-SFX    PIC X(1)    VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page  10
* EL6311.cbl
   476      12  ELMSTR-LENGTH           PIC S9999 COMP  VALUE +11.
   477 01  CANCEL-GEN-PASS-AREA.
   478     05  CG-OPTION-CODE          PIC X.
   479         88  CG-VALID-OPTION       VALUE '1' '2' '3' '4'.
   480         88  CG-FLAT-CANCEL        VALUE '1'.
   481         88  CG-CANCEL             VALUE '2'.
   482         88  CG-CANCEL-REISSUE     VALUE '3'.
   483     05  CG-ERROR-CODE           PIC 99.
   484         88  CG-SUCCESS            VALUE 00.
   485         88  CG-DATE-ERROR         VALUE 01.
   486         88  CG-CERT-NOT-FOUND     VALUE 02.
   487         88  CG-AMOUNT-ERROR       VALUE 04.
   488         88  CG-OPTION-ERROR       VALUE 05.
   489         88  CG-PREV-CAN           VALUE 06.
   490         88  CG-INVALID-DATA       VALUE 07.
   491         88  CG-NO-ACCT-MSTR       VALUE 08.
   492         88  CG-SFX-A-EXIST        VALUE 09.
   493         88  CG-MISC-ERROR         VALUE 99.
   494     05  CG-COMPANY-ID           PIC XXX.
   495     05  CG-PROC-ID              PIC XXXX.
   496     05  CG-CURRENT-DT           PIC XX.
   497     05  CG-MONTH-END-DT         PIC XX.
   498     05  CG-CERT-KEY.
   499         10  CG-CERT-COMPANY-CD  PIC X.
   500         10  CG-CERT-CARRIER     PIC X.
   501         10  CG-CERT-GROUP       PIC X(6).
   502         10  CG-CERT-STATE       PIC XX.
   503         10  CG-CERT-ACCOUNT     PIC X(10).
   504         10  CG-CERT-EFF-DT      PIC XX.
   505         10  CG-CERT-CERT-NO     PIC X(11).
   506     05  CG-LF-CAN-DATA.
   507         10  CG-LF-CAN-DT        PIC XX.
   508         10  CG-LF-CAN-AMT       PIC S9(7)V99 COMP-3.
   509     05  CG-AH-CAN-DATA.
   510         10  CG-AH-CAN-DT        PIC XX.
   511         10  CG-AH-CAN-AMT       PIC S9(7)V99 COMP-3.
   512     05  CG-CERT-PROFILE-DATA.
   513         10  CG-INS-LNAME        PIC X(15).
   514         10  CG-INS-FNAME        PIC X(10).
   515         10  CG-INS-MID-INIT     PIC X.
   516         10  CG-INS-AGE          PIC 99.
   517         10  CG-JNT-LNAME        PIC X(15).
   518         10  CG-JNT-FNAME        PIC X(10).
   519         10  CG-JNT-MID-INIT     PIC X.
   520         10  CG-JNT-AGE          PIC 99.
   521     05  CG-LF-ISS-DATA.
   522         10  CG-LF-BENCD         PIC XX.
   523         10  CG-LF-PREM-AMT      PIC S9(7)V99 COMP-3.
   524         10  CG-LF-ALT-PREM-AMT  PIC S9(7)V99 COMP-3.
   525     05  CG-AH-ISS-DATA.
   526         10  CG-AH-BENCD         PIC XX.
   527         10  CG-AH-PREM-AMT      PIC S9(7)V99 COMP-3.
   528     05  CG-BATCH-NO             PIC X(6).
   529     05  CG-BATCH-SEQ-NO         PIC 9(4)  COMP.
   530     05  FILLER                  PIC X(306).
   531******************************************************************
   532*                                                                *
   533*            G E N E R A L   W O R K   A R E A                   *
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page  11
* EL6311.cbl
   534*                                                                *
   535******************************************************************
   536
   537 01  WORK-AREA.
   538     12  WS-RESPONSE             PIC S9(8)   COMP.
   539         88  RESP-NORMAL                  VALUE +00.
   540         88  RESP-NOTFND                  VALUE +13.
   541         88  RESP-DUPREC                  VALUE +14.
   542         88  RESP-DUPKEY                  VALUE +15.
   543         88  RESP-NOTOPEN                 VALUE +19.
   544         88  RESP-ENDFILE                 VALUE +20.
   545     12  DEEDIT-FIELD            PIC X(15).
   546     12  FILLER          REDEFINES DEEDIT-FIELD.
   547         16  FILLER              PIC X(4).
   548         16  DEEDIT-FIELD-X11    PIC X(11).
   549     12  DEEDIT-FIELD-V0 REDEFINES DEEDIT-FIELD
   550                                 PIC S9(15).
   551     12  DEEDIT-FIELD-V2 REDEFINES DEEDIT-FIELD
   552                                 PIC S9(13)V99.
   553     12  DEEDIT-FIELD-V4 REDEFINES DEEDIT-FIELD
   554                                 PIC S9(11)V9999.
   555     12  W-ONE                   PIC S9(4) COMP VALUE +1.
   556     12  WS-CALC-TERM            PIC S999V9(5) VALUE ZEROS.
   557     12  WS-CALC-TERM-R REDEFINES WS-CALC-TERM.
   558         16  WS-CALC-TERM-WHOLE  PIC S999.
   559         16  WS-CALC-TERM-REMAIN PIC SV9(5).
   560
   561     12  WS-TIME                 PIC 9(6)   VALUE ZEROS.
   562     12  WS-HR-MINS-SECS REDEFINES WS-TIME.
   563         16  WS-HR-MINS          PIC 99V99.
   564         16  FILLER              PIC XX.
   565
   566     12  WS-EDIT-PASS-LENGTH     PIC S9(4)  VALUE +1036 COMP.
   567     12  WS-COMM-LENGTH          PIC S9(4)  VALUE +1306 COMP.
   568
   569     12  W-CANCEL-FEE-LONG       PIC S9(3)V9(2)  VALUE +0  COMP-3.
   570     12  W-CANCEL-FEE            PIC S99         VALUE +0  COMP-3.
   571
   572     12  WS-SUB                  PIC S9(4) VALUE +0  COMP-3.
   573     12  WS-SUB1                 PIC S9(4) VALUE +0  COMP.
   574     12  WS-SUB2                 PIC S9(4) VALUE +0  COMP.
   575     12  WS-SUB3                 PIC S9(4) VALUE +0  COMP.
   576     12  WS-SUB4                 PIC S9(4) VALUE +0  COMP.
   577     12  WS-COV-SUB              PIC S9(4) VALUE +0  COMP.
   578     12  WS-CSO-SUB              PIC S9(4) VALUE +0  COMP.
   579
   580     12  QID.
   581         16  QID-TERM            PIC X(4).
   582         16  FILLER              PIC X(4)    VALUE '607B'.
   583
   584     12  WS-DISPLAY-SW           PIC X     VALUE SPACE.
   585         88  WS-DISPLAY-SCREEN       VALUE 'Y'.
   586
   587     12  WS-LOAN-OFFICER         PIC X     VALUE SPACE.
   588         88  LOAN-OFFICER-FOUND      VALUE SPACE.
   589
   590     12  WS-MODE-CODE            PIC X     VALUE SPACE.
   591         88 WS-MODE-CODE-VALID     VALUE ' ' 'M' 'W' 'S' 'B' 'T'.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page  12
* EL6311.cbl
   592
   593     12  WS-ALL-NINES            PIC S9(7)V99 VALUE +9999999.99.
   594
   595     12  WS-NUMERIC-SW           PIC X.
   596        88  CSO-NUMERIC-FIELD   VALUE 'Y'.
   597
   598     12  WS-EDIT-CSO-FIELD.
   599         16  WS-EDIT-BYTE  OCCURS 9 TIMES
   600                                 PIC X.
   601
   602     12  WS-SAVE-INPUT-FIELDS.
   603         16  WS-BAGE             PIC 99       VALUE ZERO.
   604*        16  WS-BAPR             PIC S99V9(4) VALUE +0 COMP-3.
   605         16  WS-BAPR                 PIC 99V9(4) VALUE ZEROS.
   606         16  FILLER REDEFINES WS-BAPR.
   607             20  WS-APR-WHOLE-NUM    PIC 99.
   608             20  WS-APR-DEC          PIC 9999.
   609         16  WS-BLIVES           PIC S9(7)    VALUE +0 COMP-3.
   610         16  WS-BILLED           PIC S9(7)    VALUE +0 COMP-3.
   611
   612         16  WS-B-COVERAGE OCCURS 2 TIMES.
   613             20  WS-TERM-IN-DAYS-SW  PIC X.
   614                 88  WS-TERM-IN-DAYS-FOUND        VALUE 'Y'.
   615             20  WS-BTERM        PIC 999       COMP-3.
   616             20  WS-BALT-TERM    PIC 999       COMP-3.
   617             20  WS-BCRIT-PERD   PIC 99        COMP-3.
   618             20  WS-BBEN         PIC S9(10)V99 COMP-3.
   619             20  WS-BALT-BEN     PIC S9(10)V99 COMP-3.
   620             20  WS-BPREM        PIC S9(7)V99  COMP-3.
   621             20  WS-BALT-PREM    PIC S9(7)V99  COMP-3.
   622             20  WS-BCPREM       PIC S9(7)V99  COMP-3.
   623
   624         16  WS-C-FIELDS COMP-3.
   625             20  WS-CLIVES       PIC S9(3)     VALUE +0.
   626             20  WS-CREFND1      PIC S9(7)V99  VALUE +0.
   627             20  WS-CREFND2      PIC S9(7)V99  VALUE +0.
   628
   629         16  WS-D-FIELDS COMP-3.
   630             20  WS-DRISS        PIC S9(5)    VALUE +0.
   631             20  WS-DRLFPRM      PIC S9(7)V99 VALUE +0.
   632             20  WS-DRAHPRM      PIC S9(7)V99 VALUE +0.
   633             20  WS-DRCANC       PIC S9(5)    VALUE +0.
   634             20  WS-DRLFRFD      PIC S9(7)V99 VALUE +0.
   635             20  WS-DRAHRFD      PIC S9(7)V99 VALUE +0.
   636
   637     12  WS-SAVE-BIRTH-DATE.
   638         16  FILLER              PIC X(4)   VALUE SPACES.
   639         16  WS-SAVE-BIRTH-YR    PIC X(2)   VALUE SPACES.
   640
   641     12  CENTURY-ADJ             PIC S9(08) VALUE +38400 COMP.
   642     12  WS-WORK-BIN-RED         PIC S9(08) VALUE +0 COMP.
   643     12  FILLER REDEFINES WS-WORK-BIN-RED.
   644         16  FILLER              PIC X(02).
   645         16  WS-WORK-BIN-DT      PIC X(02).
   646     12  WS-SW-1                 PIC X     VALUE SPACE.
   647     12  WS-SW-2                 PIC X     VALUE SPACE.
   648     12  WS-REMOVE-AH-SW         PIC X     VALUE SPACE.
   649         88  REMOVE-AH-COVERAGE  VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page  13
* EL6311.cbl
   650     12  WS-REMOVE-LF-SW         PIC X     VALUE SPACE.
   651         88  REMOVE-LF-COVERAGE  VALUE 'Y'.
   652
   653     12  WS-CONVERTED-BIRTH      PIC XX    VALUE SPACE.
   654     12  WS-CONVERTED-1ST-PMT-DT PIC XX    VALUE SPACE.
   655     12  WS-CONVERTED-EFFDT      PIC XX    VALUE SPACES.
   656     12  WS-CONVERTED-EXPIRDT      OCCURS 2 TIMES PIC XX.
   657     12  WS-CONVERTED-CANCEL-DATES.
   658         16  WS-CONVERTED-CANDT1                  PIC XX.
   659         16  WS-CONVERTED-CANDT2                  PIC XX.
   660
   661     12  WS-EXP-DT-EDIT          PIC 99B99B99.
   662
   663     12  WS-REC-FOUND-SW         PIC X.
   664         88  RECORD-NOT-FOUND    VALUE 'N'.
   665
   666     12  WS-PB-RECORDS-FOUND-SW  PIC X     VALUE 'N'.
   667         88  PENDING-BUS-RECS-NOT-FOUND    VALUE 'N'.
   668         88  PENDING-BUS-RECS-FOUND        VALUE 'Y'.
   669
   670     12  WS-ERRORS-PRESENT-SW    PIC X     VALUE 'N'.
   671         88  WS-ERRORS-PRESENT             VALUE 'Y'.
   672         88  WS-ERRORS-NOT-PRESENT         VALUE 'N'.
   673
   674     12  WS-BROWSE-STARTED-SW    PIC X            VALUE ' '.
   675         88  BROWSE-STARTED      VALUE 'Y'.
   676
   677     12  WS-FIRST-TIME-SW        PIC X            VALUE ' '.
   678         88  FIRST-TIME          VALUE 'Y'.
   679
   680     12  WS-FIRST-ENTRY-SW       PIC X            VALUE ' '.
   681         88  FIRST-ENTRY         VALUE 'Y'.
   682
   683     12  WS-REC-BILLED-SW        PIC X            VALUE ' '.
   684         88  REC-BILLED          VALUE 'Y'.
   685
   686     12  SET-CURSOR-SW           PIC S9  COMP-3   VALUE +0.
   687         88  NO-CURSOR-SET       VALUE +0.
   688         88  CURSOR-SET          VALUE +1.
   689
   690     12  WS-ERR-SW               PIC X.
   691         88  STD-ERRORS          VALUE 'S'.
   692         88  TRN-ERRORS          VALUE 'T'.
   693
   694     12  WS-CERT-NOTE-SW         PIC X            VALUE ' '.
   695         88 CERT-NOTES-ARE-PRESENT   VALUE 'Y'.
   696
   697     12  WS-CERT-ADDRESS-SW      PIC X            VALUE ' '.
   698         88 CERT-ADDRESS-PRESENT VALUE 'Y'.
   699
   700     12  WS-CANCEL-LETTER-SW     PIC X            VALUE ' '.
   701         88 CREATE-CANCEL-LETTER VALUE 'Y'.
   702
   703     12  WS-ERR-CODE.
   704         16  FILLER              PIC 99.
   705         16  WS-ERROR-SUB        PIC 99.
   706
   707     12  WS-DATE-WORK.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page  14
* EL6311.cbl
   708         16  WS-WORK-MM          PIC XX.
   709         16  WS-WORK-DD          PIC XX.
   710         16  WS-WORK-YY          PIC XX.
   711
   712     12  WS-MM-YY.
   713         16  WS-MM               PIC XX.
   714         16  FILLER              PIC X     VALUE '/'.
   715         16  WS-YY               PIC XX.
   716
   717     12  WS-CERT-EFF-DT          PIC XX.
   718
   719     12  WS-MEMBER-NO            PIC X(12).
   720     12  FILLER  REDEFINES  WS-MEMBER-NO.
   721         16  WS-MEMBER-NO-1-8    PIC 9(8).
   722         16  FILLER              PIC X(4).
   723
   724     12  WS-I-MICRO-NO           PIC S9(9)        COMP-3.
   725
   726     12  WS-ERPNDB-ALT-KEY.
   727         16  WS-PB-COMPANY-CD-A1         PIC X.
   728         16  WS-PB-CARRIER               PIC X.
   729         16  WS-PB-GROUPING              PIC X(6).
   730         16  WS-PB-STATE                 PIC XX.
   731         16  WS-PB-ACCOUNT               PIC X(10).
   732         16  WS-PB-CERT-EFF-DT           PIC XX.
   733         16  WS-PB-CERT-NO.
   734             20  WS-PB-CERT-PRIME        PIC X(10).
   735             20  WS-PB-CERT-SFX          PIC X.
   736         16  WS-PB-ALT-CHG-SEQ-NO        PIC S9(4)     COMP.
   737         16  WS-PB-RECORD-TYPE           PIC X.
   738
   739     12  WS-SHOW-SAVE-AREAS.
   740         16  WS-NEW-CERT-NO.
   741             20  WS-NEW-PRIME    PIC X(10).
   742             20  WS-NEW-SUFFIX   PIC X.
   743         16  WS-NEW-CERT-EFF-DT  PIC XX.
   744         16  WS-NEW-RECORD-TYPE  PIC X.
   745         16  WS-SHOW-SW          PIC X   VALUE 'N'.
   746             88   SHOW-RECORD            VALUE 'Y'.
   747
   748     12  WS-SEQ-SAVE             PIC S9(4) COMP.
   749
   750     12  WS-BATCH-NO.
   751         16  WS-BATCH-PREFIX     PIC XXX  VALUE SPACES.
   752         16  FILLER              PIC X(5) VALUE SPACES.
   753
   754     12  WS-FIRST-NAME.
   755         16  WS-1ST-INIT         PIC X.
   756         16  FILLER              PIC X(9).
   757
   758     12  WS-INITIALS.
   759         16  WS-INITIAL-1        PIC X.
   760         16  WS-INITIAL-2        PIC X.
   761
   762     12  WS-C-HDG.
   763         16  WS-REF-HDG-OVERRIDE PIC XX   VALUE SPACES.
   764         16  FILLER              PIC X(4) VALUE '-REF'.
   765
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page  15
* EL6311.cbl
   766     12  WS-D-PREM-HDG.
   767         16  WS-PREM-HDG-OVERRIDE    PIC XX   VALUE SPACES.
   768         16  FILLER                  PIC X(8) VALUE '-PREMIUM'.
   769
   770     12  WS-D-REFUND-HDG.
   771         16  WS-REFUND-HDG-OVERRIDE  PIC XX   VALUE SPACES.
   772         16  FILLER                  PIC X(7) VALUE '-REFUND'.
   773
   774     12  WS-BATCH-CSR-ID     PIC X(4)    VALUE SPACE.
   775
   776     12  CLIENT-ACE          PIC X(3)    VALUE 'ACE'.
   777     12  CLIENT-CRI          PIC X(3)    VALUE 'CRI'.
   778     12  CLIENT-CSO          PIC X(3)    VALUE 'CSO'.
   779     12  CLIENT-GIC          PIC X(3)    VALUE 'GIC'.
   780     12  CLIENT-LGX          PIC X(3)    VALUE 'LGX'.
   781     12  CLIENT-MIC          PIC X(3)    VALUE 'MIC'.
   782     12  CLIENT-PEM          PIC X(3)    VALUE 'PEM'.
   783
   784     12  WS-01-CANCEL-ERR        PIC X(25)
   785         VALUE 'CANCEL DATE ERROR'.
   786     12  WS-02-CANCEL-ERR        PIC X(25)
   787         VALUE 'CERT NOT FOUND'.
   788     12  WS-04-CANCEL-ERR        PIC X(25)
   789         VALUE 'CANCEL AMOUNT ERROR'.
   790     12  WS-05-CANCEL-ERR        PIC X(25)
   791         VALUE 'CANCEL OPTION ERROR'.
   792     12  WS-06-CANCEL-ERR        PIC X(25)
   793         VALUE 'PREVIOUSLY CANCELLED'.
   794     12  WS-07-CANCEL-ERR        PIC X(25)
   795         VALUE 'INVALID DATA'.
   796     12  WS-08-CANCEL-ERR        PIC X(25)
   797         VALUE 'NO ACCOUNT MASTER'.
   798     12  WS-09-CANCEL-ERR        PIC X(25)
   799         VALUE 'SUFFIX ALREADY EXISTS'.
   800     12  WS-99-CANCEL-ERR        PIC X(25)
   801         VALUE 'MISC CANCEL ERROR'.
   802
   803     12  ARCH-SUPPRESS           PIC ZZZZZZZZ99.
   804     12  ARCH-EDIT REDEFINES ARCH-SUPPRESS    PIC X(10).
   805
   806     12  WS-AGE-FIELDS.
   807         16  WS-INS-AGE-SET             PIC X VALUE 'N'.
   808         16  WS-JNT-AGE-SET             PIC X VALUE 'N'.
   809         16  WS-INS-AGE-DEFAULTED       PIC X VALUE 'N'.
   810         16  WS-JNT-AGE-DEFAULTED       PIC X VALUE 'N'.
   811
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page  16
* EL6311.cbl
   813
   814******************************************************************
   815*                                                                *
   816*                 B A T C H   T O T A L S                        *
   817*                                                                *
   818******************************************************************
   819
   820     12  WS-BATCH-RECORD.
   821         16  FILLER                       PIC X(10).
   822         16  WS-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   823         16  WS-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   824         16  WS-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   825         16  WS-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   826         16  WS-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   827         16  WS-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   828         16  WS-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   829         16  WS-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   830         16  WS-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   831         16  WS-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   832         16  WS-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   833         16  WS-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   834         16  WS-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
   835         16  WS-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
   836         16  WS-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
   837         16  WS-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
   838         16  WS-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
   839         16  WS-ACCOUNT-NAME              PIC X(30).
   840         16  FILLER                       PIC X.
   841         16  WS-REFERENCE                 PIC X(12).
   842         16  FILLER                       PIC X(197).
   843
   844     12  WS-BATCH-TOTALS.
   845         16  WS-ISS-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   846         16  WS-ISS-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   847         16  WS-ISS-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   848         16  WS-ISS-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   849         16  WS-ISS-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   850         16  WS-ISS-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   851         16  WS-CAN-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   852         16  WS-CAN-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   853         16  WS-CAN-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   854         16  WS-CAN-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   855         16  WS-CAN-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   856         16  WS-CAN-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   857         16  WS-NET-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   858         16  WS-NET-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   859         16  WS-NET-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   860         16  WS-NET-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   861         16  WS-NET-AVAIL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   862         16  WS-NET-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   863         16  WS-NET-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   864
   865     12  WS-SEQ-NO-COUNTER       PIC S9(3)     COMP-3 VALUE ZEROS.
   866
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page  17
* EL6311.cbl
   868
   869******************************************************************
   870*                                                                *
   871*                E R R O R   M E S S A G E S                     *
   872*                                                                *
   873******************************************************************
   874
   875 01  ERROR-MESSAGES.
   876     12  ER-0004                 PIC  9(4) VALUE 0004.
   877     12  ER-0008                 PIC  9(4) VALUE 0008.
   878     12  ER-0023                 PIC  9(4) VALUE 0023.
   879     12  ER-0029                 PIC  9(4) VALUE 0029.
   880     12  ER-0033                 PIC  9(4) VALUE 0033.
   881     12  ER-0070                 PIC  9(4) VALUE 0070.
   882     12  ER-0220                 PIC  9(4) VALUE 0220.
   883     12  ER-0248                 PIC  9(4) VALUE 0248.
   884     12  ER-0280                 PIC  9(4) VALUE 0280.
   885     12  ER-0348                 PIC  9(4) VALUE 0348.
   886     12  ER-0582                 PIC  9(4) VALUE 0582.
   887     12  ER-0877                 PIC  9(4) VALUE 0877.
   888     12  ER-1236                 PIC  9(4) VALUE 1236.
   889     12  ER-1570                 PIC  9(4) VALUE 1570.
   890     12  ER-1575                 PIC  9(4) VALUE 1575.
   891     12  ER-1609                 PIC  9(4) VALUE 1609.
   892     12  ER-1819                 PIC  9(4) VALUE 1819.
   893     12  ER-2077                 PIC  9(4) VALUE 2077.
   894     12  ER-2129                 PIC  9(4) VALUE 2129.
   895     12  ER-2188                 PIC  9(4) VALUE 2188.
   896     12  ER-2192                 PIC  9(4) VALUE 2192.
   897     12  ER-2196                 PIC  9(4) VALUE 2196.
   898     12  ER-2197                 PIC  9(4) VALUE 2197.
   899     12  ER-2198                 PIC  9(4) VALUE 2198.
   900     12  ER-2200                 PIC  9(4) VALUE 2200.
   901     12  ER-2212                 PIC  9(4) VALUE 2212.
   902     12  ER-2218                 PIC  9(4) VALUE 2218.
   903     12  ER-2220                 PIC  9(4) VALUE 2220.
   904     12  ER-2222                 PIC  9(4) VALUE 2222.
   905     12  ER-2223                 PIC  9(4) VALUE 2223.
   906     12  ER-2224                 PIC  9(4) VALUE 2224.
   907     12  ER-2225                 PIC  9(4) VALUE 2225.
   908     12  ER-2226                 PIC  9(4) VALUE 2226.
   909     12  ER-2227                 PIC  9(4) VALUE 2227.
   910     12  ER-2228                 PIC  9(4) VALUE 2228.
   911     12  ER-2240                 PIC  9(4) VALUE 2240.
   912     12  ER-2241                 PIC  9(4) VALUE 2241.
   913     12  ER-2242                 PIC  9(4) VALUE 2242.
   914     12  ER-2243                 PIC  9(4) VALUE 2243.
   915     12  ER-2244                 PIC  9(4) VALUE 2244.
   916     12  ER-2245                 PIC  9(4) VALUE 2245.
   917     12  ER-2246                 PIC  9(4) VALUE 2246.
   918     12  ER-2247                 PIC  9(4) VALUE 2247.
   919     12  ER-2251                 PIC  9(4) VALUE 2251.
   920     12  ER-2252                 PIC  9(4) VALUE 2252.
   921     12  ER-2253                 PIC  9(4) VALUE 2253.
   922     12  ER-2254                 PIC  9(4) VALUE 2254.
   923     12  ER-2255                 PIC  9(4) VALUE 2255.
   924     12  ER-2256                 PIC  9(4) VALUE 2256.
   925     12  ER-2257                 PIC  9(4) VALUE 2257.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page  18
* EL6311.cbl
   926     12  ER-2258                 PIC  9(4) VALUE 2258.
   927     12  ER-2259                 PIC  9(4) VALUE 2259.
   928     12  ER-2260                 PIC  9(4) VALUE 2260.
   929     12  ER-2261                 PIC  9(4) VALUE 2261.
   930     12  ER-2287                 PIC  9(4) VALUE 2287.
   931     12  ER-2336                 PIC  9(4) VALUE 2336.
   932     12  ER-2337                 PIC  9(4) VALUE 2337.
   933     12  ER-2437                 PIC  9(4) VALUE 2437.
   934     12  ER-2471                 PIC  9(4) VALUE 2471.
   935     12  ER-2530                 PIC  9(4) VALUE 2530.
   936     12  ER-2531                 PIC  9(4) VALUE 2531.
   937     12  ER-2532                 PIC  9(4) VALUE 2532.
   938     12  ER-2533                 PIC  9(4) VALUE 2533.
   939     12  ER-2547                 PIC  9(4) VALUE 2547.
   940     12  ER-2591                 PIC  9(4) VALUE 2591.
   941     12  ER-2592                 PIC  9(4) VALUE 2592.
   942     12  ER-2593                 PIC  9(4) VALUE 2593.
   943     12  ER-2600                 PIC  9(4) VALUE 2600.
   944     12  ER-2601                 PIC  9(4) VALUE 2601.
   945     12  ER-2604                 PIC  9(4) VALUE 2604.
   946     12  ER-2605                 PIC  9(4) VALUE 2605.
   947     12  ER-2606                 PIC  9(4) VALUE 2606.
   948     12  ER-2607                 PIC  9(4) VALUE 2607.
   949     12  ER-2622                 PIC  9(4) VALUE 2622.
   950     12  ER-2625                 PIC  9(4) VALUE 2625.
   951     12  ER-2626                 PIC  9(4) VALUE 2626.
   952     12  ER-2627                 PIC  9(4) VALUE 2627.
   953     12  ER-2628                 PIC  9(4) VALUE 2628.
   954     12  ER-2629                 PIC  9(4) VALUE 2629.
   955     12  ER-2630                 PIC  9(4) VALUE 2630.
   956     12  ER-2631                 PIC  9(4) VALUE 2631.
   957     12  ER-2632                 PIC  9(4) VALUE 2632.
   958     12  ER-2633                 PIC  9(4) VALUE 2633.
   959     12  ER-2634                 PIC  9(4) VALUE 2634.
   960     12  ER-2635                 PIC  9(4) VALUE 2635.
   961     12  ER-2636                 PIC  9(4) VALUE 2636.
   962     12  ER-2639                 PIC  9(4) VALUE 2639.
   963     12  ER-2640                 PIC  9(4) VALUE 2640.
   964     12  ER-2647                 PIC  9(4) VALUE 2647.
   965     12  ER-2648                 PIC  9(4) VALUE 2648.
   966     12  ER-2649                 PIC  9(4) VALUE 2649.
   967     12  ER-2650                 PIC  9(4) VALUE 2650.
   968     12  ER-2653                 PIC  9(4) VALUE 2653.
   969     12  ER-2654                 PIC  9(4) VALUE 2654.
   970     12  ER-2655                 PIC  9(4) VALUE 2655.
   971     12  ER-2656                 PIC  9(4) VALUE 2656.
   972     12  ER-2657                 PIC  9(4) VALUE 2657.
   973     12  ER-2660                 PIC  9(4) VALUE 2660.
   974     12  ER-2661                 PIC  9(4) VALUE 2661.
   975     12  ER-2662                 PIC  9(4) VALUE 2662.
   976     12  ER-2663                 PIC  9(4) VALUE 2663.
   977     12  ER-2664                 PIC  9(4) VALUE 2664.
   978     12  ER-2667                 PIC  9(4) VALUE 2667.
   979     12  ER-2668                 PIC  9(4) VALUE 2668.
   980     12  ER-2669                 PIC  9(4) VALUE 2669.
   981     12  ER-2670                 PIC  9(4) VALUE 2670.
   982     12  ER-2671                 PIC  9(4) VALUE 2671.
   983     12  ER-2672                 PIC  9(4) VALUE 2672.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page  19
* EL6311.cbl
   984     12  ER-2673                 PIC  9(4) VALUE 2673.
   985     12  ER-2677                 PIC  9(4) VALUE 2677.
   986     12  ER-2678                 PIC  9(4) VALUE 2678.
   987     12  ER-2679                 PIC  9(4) VALUE 2679.
   988     12  ER-2680                 PIC  9(4) VALUE 2680.
   989     12  ER-2681                 PIC  9(4) VALUE 2681.
   990     12  ER-2682                 PIC  9(4) VALUE 2682.
   991     12  ER-2683                 PIC  9(4) VALUE 2683.
   992     12  ER-2684                 PIC  9(4) VALUE 2684.
   993     12  ER-2686                 PIC  9(4) VALUE 2686.
   994     12  ER-2689                 PIC  9(4) VALUE 2689.
   995     12  ER-2690                 PIC  9(4) VALUE 2690.
   996     12  ER-2693                 PIC  9(4) VALUE 2693.
   997     12  ER-2695                 PIC  9(4) VALUE 2695.
   998     12  ER-2701                 PIC  9(4) VALUE 2701.
   999     12  ER-2720                 PIC  9(4) VALUE 2720.
  1000     12  ER-2709                 PIC  9(4) VALUE 2709.
  1001     12  ER-2704                 PIC  9(4) VALUE 2704.
  1002     12  ER-2725                 PIC  9(4) VALUE 2725.
  1003     12  ER-2726                 PIC  9(4) VALUE 2726.
  1004     12  ER-2728                 PIC  9(4) VALUE 2728.
  1005     12  ER-2729                 PIC  9(4) VALUE 2729.
  1006     12  ER-2731                 PIC  9(4) VALUE 2731.
  1007     12  ER-2732                 PIC  9(4) VALUE 2732.
  1008     12  ER-2733                 PIC  9(4) VALUE 2733.
  1009     12  ER-2735                 PIC  9(4) VALUE 2735.
  1010     12  ER-2738                 PIC  9(4) VALUE 2738.
  1011     12  ER-2742                 PIC  9(4) VALUE 2742.
  1012     12  ER-2743                 PIC  9(4) VALUE 2743.
  1013     12  ER-2744                 PIC  9(4) VALUE 2744.
  1014     12  ER-2747                 PIC  9(4) VALUE 2747.
  1015     12  ER-2749                 PIC  9(4) VALUE 2749.
  1016     12  ER-2753                 PIC  9(4) VALUE 2753.
  1017     12  ER-2755                 PIC  9(4) VALUE 2755.
  1018     12  ER-2757                 PIC  9(4) VALUE 2757.
  1019     12  ER-2771                 PIC  9(4) VALUE 2771.
  1020     12  ER-2774                 PIC  9(4) VALUE 2774.
  1021     12  ER-2775                 PIC  9(4) VALUE 2775.
  1022     12  ER-2776                 PIC  9(4) VALUE 2776.
  1023     12  ER-2777                 PIC  9(4) VALUE 2777.
  1024     12  ER-2794                 PIC  9(4) VALUE 2794.
  1025     12  ER-2799                 PIC  9(4) VALUE 2799.
  1026     12  ER-2900                 PIC  9(4) VALUE 2900.
  1027     12  ER-2902                 PIC  9(4) VALUE 2902.
  1028     12  ER-2945                 PIC  9(4) VALUE 2945.
  1029     12  ER-3000                 PIC  9(4) VALUE 3000.
  1030     12  ER-3006                 PIC  9(4) VALUE 3006.
  1031     12  ER-3054                 PIC  9(4) VALUE 3054.
  1032     12  ER-3224                 PIC  9(4) VALUE 3224.
  1033     12  ER-3504                 PIC  9(4) VALUE 3504.
  1034     12  ER-3513                 PIC  9(4) VALUE 3513.
  1035     12  ER-3831                 PIC  9(4) VALUE 3831.
  1036     12  ER-3834                 PIC  9(4) VALUE 3834.
  1037     12  ER-3835                 PIC  9(4) VALUE 3835.
  1038     12  ER-4005                 PIC  9(4) VALUE 4005.
  1039     12  ER-7144                 PIC  9(4) VALUE 7144.
  1040     12  ER-7401                 PIC  9(4) VALUE 7401.
  1041     12  ER-7402                 PIC  9(4) VALUE 7402.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page  20
* EL6311.cbl
  1042     12  ER-7403                 PIC  9(4) VALUE 7403.
  1043     12  ER-7404                 PIC  9(4) VALUE 7404.
  1044     12  ER-7423                 PIC  9(4) VALUE 7423.
  1045     12  ER-7424                 PIC  9(4) VALUE 7424.
  1046     12  ER-7433                 PIC  9(4) VALUE 7433.
  1047     12  ER-7450                 PIC  9(4) VALUE 7450.
  1048     12  ER-7451                 PIC  9(4) VALUE 7451.
  1049     12  ER-7530                 PIC  9(4) VALUE 7530.
  1050     12  ER-7573                 PIC  9(4) VALUE 7573.
  1051     12  ER-7631                 PIC  9(4) VALUE 7631.
  1052     12  ER-7632                 PIC  9(4) VALUE 7632.
  1053     12  ER-7633                 PIC  9(4) VALUE 7633.
  1054     12  ER-7537                 PIC  9(4) VALUE 7537.
  1055     12  ER-7538                 PIC  9(4) VALUE 7538.
  1056     12  ER-7574                 PIC  9(4) VALUE 7574.
  1057     12  ER-7997                 PIC  9(4) VALUE 7997.
  1058     12  ER-7998                 PIC  9(4) VALUE 7998.
  1059     12  ER-8148                 PIC  9(4) VALUE 8148.
  1060     12  ER-9063                 PIC  9(4) VALUE 9063.
  1061     12  ER-9076                 PIC  9(4) VALUE 9076.
  1062     12  ER-9618                 PIC  9(4) VALUE 9618.
  1063     12  ER-9841                 PIC  9(4) VALUE 9841.
  1064
  1065*                                COPY ELCTEXT.
  1066******************************************************************
  1067*                                                                *
  1068*                                                                *
  1069*                            ELCTEXT.                            *
  1070*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1071*                            VMOD=2.008                          *
  1072*                                                                *
  1073*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
  1074*                                     FORM LETTERS,              *
  1075*                                     CERT FORM DISPLAY.
  1076*                                                                *
  1077*   FILE TYPE = VSAM,KSDS                                        *
  1078*   RECORD SIZE = 100   RECFORM = FIXED                          *
  1079*                                                                *
  1080*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
  1081*       ALTERNATE INDEX = NONE                                   *
  1082*                                                                *
  1083*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
  1084*       ALTERNATE INDEX = NONE                                   *
  1085*                                                                *
  1086*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
  1087*       ALTERNATE INDEX = NONE                                   *
  1088*                                                                *
  1089*   LOG = NO                                                     *
  1090*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1091******************************************************************
  1092 01  TEXT-FILES.
  1093     12  TEXT-FILE-ID                PIC XX.
  1094         88  FORMS-FILE-TEXT            VALUE 'TF'.
  1095         88  LETTER-FILE-TEXT           VALUE 'TL'.
  1096         88  HELP-FILE-TEXT             VALUE 'TH'.
  1097
  1098     12  TX-CONTROL-PRIMARY.
  1099         16  TX-COMPANY-CD           PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page  21
* EL6311.cbl
  1100             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
  1101         16  TX-ACCESS-CD-GENL       PIC X(12).
  1102
  1103         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1104             20  TX-LETTER-NO        PIC X(4).
  1105             20  FILLER              PIC X(8).
  1106
  1107         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1108             20  TX-FORM-NO          PIC X(12).
  1109
  1110         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1111             20  TX-HELP-TYPE        PIC X.
  1112                 88  HELP-FOR-GENERAL   VALUE ' '.
  1113                 88  HELP-BY-SCREEN     VALUE 'S'.
  1114                 88  HELP-BY-ERROR      VALUE 'E'.
  1115             20  TX-SCREEN-OR-ERROR  PIC X(4).
  1116                 88  GENERAL-INFO-HELP  VALUE '0000'.
  1117             20  TX-HELP-FOR-COMPANY  PIC XXX.
  1118                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
  1119             20  FILLER              PIC X(4).
  1120
  1121         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
  1122
  1123     12  TX-PROCESS-CONTROL          PIC XX.
  1124         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
  1125
  1126     12  TX-TEXT-LINE                PIC X(70).
  1127
  1128     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
  1129         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
  1130         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
  1131         88  TX-VALID-FORM-SQUEEZE-VALUE
  1132                                        VALUE 'Y' ' '.
  1133
  1134     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
  1135         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
  1136         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
  1137         88  TX-DO-NOT-ADJUST           VALUE 'N'.
  1138         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
  1139         88  TX-NEW-PARAGRAPH           VALUE 'P'.
  1140         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
  1141         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
  1142                                              'K' 'N' ' '
  1143                                              'Z'.
  1144
  1145     12  TX-ARCHIVE-SW               PIC X.
  1146         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
  1147         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
  1148         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
  1149
  1150     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
  1151     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
  1152
  1153     12  TX-BSR-CODE                 PIC X.
  1154         88  TX-BSR-LETTER              VALUE 'B'.
  1155         88  TX-NON-BSR-LETTER          VALUE ' '.
  1156
  1157     12  FILLER                      PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page  22
* EL6311.cbl
  1158*****************************************************************
  1159*                                COPY ELCCRTO.
  1160******************************************************************
  1161*                                                                *
  1162*                            ELCCRTO.                            *
  1163*                                                                *
  1164*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  1165*                                                                *
  1166*   FILE TYPE = VSAM,KSDS                                        *
  1167*   RECORD SIZE = 524  RECFORM = FIXED                           *
  1168*                                                                *
  1169*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  1170*                                                                *
  1171*   LOG = YES                                                    *
  1172*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1173******************************************************************
  1174*                   C H A N G E   L O G
  1175*
  1176* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1177*-----------------------------------------------------------------
  1178*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1179* EFFECTIVE    NUMBER
  1180*-----------------------------------------------------------------
  1181* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  1182* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  1183* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  1184* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  1185* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  1186******************************************************************
  1187 01  ORIGINAL-CERTIFICATE.
  1188     12  OC-RECORD-ID                      PIC XX.
  1189         88  VALID-OC-ID                      VALUE 'OC'.
  1190     12  OC-CONTROL-PRIMARY.
  1191         16  OC-COMPANY-CD                 PIC X.
  1192         16  OC-CARRIER                    PIC X.
  1193         16  OC-GROUPING                   PIC X(6).
  1194         16  OC-STATE                      PIC XX.
  1195         16  OC-ACCOUNT                    PIC X(10).
  1196         16  OC-CERT-EFF-DT                PIC XX.
  1197         16  OC-CERT-NO.
  1198             20  OC-CERT-PRIME             PIC X(10).
  1199             20  OC-CERT-SFX               PIC X.
  1200         16  OC-RECORD-TYPE                PIC X.
  1201         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  1202     12  OC-LAST-MAINT-DT                  PIC XX.
  1203     12  OC-LAST-MAINT-BY                  PIC X(4).
  1204     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  1205     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  1206     12  FILLER                            PIC X(49).
  1207     12  OC-ORIG-REC.
  1208         16  OC-INS-LAST-NAME              PIC X(15).
  1209         16  OC-INS-FIRST-NAME             PIC X(10).
  1210         16  OC-INS-MIDDLE-INIT            PIC X.
  1211         16  OC-INS-AGE                    PIC S999     COMP-3.
  1212         16  OC-JNT-LAST-NAME              PIC X(15).
  1213         16  OC-JNT-FIRST-NAME             PIC X(10).
  1214         16  OC-JNT-MIDDLE-INIT            PIC X.
  1215         16  OC-JNT-AGE                    PIC S999     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page  23
* EL6311.cbl
  1216         16  OC-LF-BENCD                   PIC XX.
  1217         16  OC-LF-TERM                    PIC S999      COMP-3.
  1218         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  1219         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  1220         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  1221         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  1222         16  OC-LF-EXP-DT                  PIC XX.
  1223         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  1224         16  OC-LF-CANCEL-DT               PIC XX.
  1225         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  1226         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1227         16  OC-AH-BENCD                   PIC XX.
  1228         16  OC-AH-TERM                    PIC S999      COMP-3.
  1229         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  1230         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  1231         16  OC-AH-EXP-DT                  PIC XX.
  1232         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  1233         16  OC-AH-CP                      PIC 99.
  1234         16  OC-AH-CANCEL-DT               PIC XX.
  1235         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  1236         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1237         16  OC-CRED-BENE-NAME             PIC X(25).
  1238         16  OC-1ST-PMT-DT                 PIC XX.
  1239         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  1240         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  1241         16  OC-ISSUE-TRAN-IND             PIC X.
  1242         16  OC-CANCEL-TRAN-IND            PIC X.
  1243         16  FILLER                        PIC X(211).
  1244
  1245     12  FILLER                            PIC X(50).
  1246******************************************************************
  1247*                                COPY ERCACCT.
  1248******************************************************************
  1249*                                                                *
  1250*                                                                *
  1251*                            ERCACCT                             *
  1252*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1253*                            VMOD=2.031                          *
  1254*                                                                *
  1255*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  1256*                                                                *
  1257*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  1258*   VSAM ACCOUNT MASTER FILES.                                   *
  1259*                                                                *
  1260*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  1261*                                                                *
  1262*   FILE TYPE = VSAM,KSDS                                        *
  1263*   RECORD SIZE = 2000  RECFORM = FIX                            *
  1264*                                                                *
  1265*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  1266*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  1267*                                                                *
  1268*   LOG = NO                                                     *
  1269*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1270*                                                                *
  1271*                                                                *
  1272******************************************************************
  1273*                   C H A N G E   L O G
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page  24
* EL6311.cbl
  1274*
  1275* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1276*-----------------------------------------------------------------
  1277*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1278* EFFECTIVE    NUMBER
  1279*-----------------------------------------------------------------
  1280* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  1281* 092705    2005050300006  PEMA  ADD SPP LEASES
  1282* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  1283* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1284* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  1285* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  1286* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  1287******************************************************************
  1288
  1289 01  ACCOUNT-MASTER.
  1290     12  AM-RECORD-ID                      PIC XX.
  1291         88  VALID-AM-ID                      VALUE 'AM'.
  1292
  1293     12  AM-CONTROL-PRIMARY.
  1294         16  AM-COMPANY-CD                 PIC X.
  1295         16  AM-MSTR-CNTRL.
  1296             20  AM-CONTROL-A.
  1297                 24  AM-CARRIER            PIC X.
  1298                 24  AM-GROUPING.
  1299                     28 AM-GROUPING-PREFIX PIC XXX.
  1300                     28 AM-GROUPING-PRIME  PIC XXX.
  1301                 24  AM-STATE              PIC XX.
  1302                 24  AM-ACCOUNT.
  1303                     28  AM-ACCOUNT-PREFIX PIC X(4).
  1304                     28  AM-ACCOUNT-PRIME  PIC X(6).
  1305             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  1306                                           PIC X(19).
  1307             20  AM-CNTRL-B.
  1308                 24  AM-EXPIRATION-DT      PIC XX.
  1309                 24  FILLER                PIC X(4).
  1310             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  1311                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  1312
  1313     12  AM-CONTROL-BY-VAR-GRP.
  1314         16  AM-COMPANY-CD-A1              PIC X.
  1315         16  AM-VG-CARRIER                 PIC X.
  1316         16  AM-VG-GROUPING                PIC X(6).
  1317         16  AM-VG-STATE                   PIC XX.
  1318         16  AM-VG-ACCOUNT                 PIC X(10).
  1319         16  AM-VG-DATE.
  1320             20  AM-VG-EXPIRATION-DT       PIC XX.
  1321             20  FILLER                    PIC X(4).
  1322         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  1323                                           PIC 9(11)      COMP-3.
  1324     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  1325         16  FILLER                        PIC X(10).
  1326         16  AM-VG-KEY3.
  1327             20  AM-VG3-ACCOUNT            PIC X(10).
  1328             20  AM-VG3-EXP-DT             PIC XX.
  1329         16  FILLER                        PIC X(4).
  1330     12  AM-MAINT-INFORMATION.
  1331         16  AM-LAST-MAINT-DT              PIC XX.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page  25
* EL6311.cbl
  1332         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1333         16  AM-LAST-MAINT-USER            PIC X(4).
  1334         16  FILLER                        PIC XX.
  1335
  1336     12  AM-EFFECTIVE-DT                   PIC XX.
  1337     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  1338
  1339     12  AM-PREV-DATES  COMP-3.
  1340         16  AM-PREV-EXP-DT                PIC 9(11).
  1341         16  AM-PREV-EFF-DT                PIC 9(11).
  1342
  1343     12  AM-REPORT-CODE-1                  PIC X(10).
  1344     12  AM-REPORT-CODE-2                  PIC X(10).
  1345
  1346     12  AM-CITY-CODE                      PIC X(4).
  1347     12  AM-COUNTY-PARISH                  PIC X(6).
  1348
  1349     12  AM-NAME                           PIC X(30).
  1350     12  AM-PERSON                         PIC X(30).
  1351     12  AM-ADDRS                          PIC X(30).
  1352     12  AM-CITY.
  1353         16  AM-ADDR-CITY                  PIC X(28).
  1354         16  AM-ADDR-STATE                 PIC XX.
  1355     12  AM-ZIP.
  1356         16  AM-ZIP-PRIME.
  1357             20  AM-ZIP-PRI-1ST            PIC X.
  1358                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  1359             20  FILLER                    PIC X(4).
  1360         16  AM-ZIP-PLUS4                  PIC X(4).
  1361     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  1362         16  AM-CAN-POSTAL-1               PIC XXX.
  1363         16  AM-CAN-POSTAL-2               PIC XXX.
  1364         16  FILLER                        PIC XXX.
  1365     12  AM-TEL-NO.
  1366         16  AM-AREA-CODE                  PIC 999.
  1367         16  AM-TEL-PRE                    PIC 999.
  1368         16  AM-TEL-NBR                    PIC 9(4).
  1369     12  AM-TEL-LOC                        PIC X.
  1370         88  AM-TEL-AT-HOME                   VALUE 'H'.
  1371         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  1372
  1373     12  AM-COMM-STRUCTURE.
  1374         16  AM-DEFN-1.
  1375             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  1376                 24  AM-AGT.
  1377                     28  AM-AGT-PREFIX     PIC X(4).
  1378                     28  AM-AGT-PRIME      PIC X(6).
  1379                 24  AM-COM-TYP            PIC X.
  1380                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  1381                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  1382                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  1383                 24  AM-RECALC-LV-INDIC    PIC X.
  1384                 24  AM-RETRO-LV-INDIC     PIC X.
  1385                 24  AM-GL-CODES           PIC X.
  1386                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  1387                 24  FILLER                PIC X(01).
  1388         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  1389             20  AM-COM-TBLS        OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page  26
* EL6311.cbl
  1390                 24  FILLER                PIC X(11).
  1391                 24  AM-L-COMA             PIC XXX.
  1392                 24  AM-J-COMA             PIC XXX.
  1393                 24  AM-A-COMA             PIC XXX.
  1394                 24  FILLER                PIC X(6).
  1395
  1396     12  AM-COMM-CHANGE-STATUS             PIC X.
  1397         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  1398
  1399     12  AM-CSR-CODE                       PIC X(4).
  1400
  1401     12  AM-BILLING-STATUS                 PIC X.
  1402         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  1403         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  1404     12  AM-AUTO-REFUND-SW                 PIC X.
  1405         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  1406         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  1407     12  AM-GPCD                           PIC 99.
  1408     12  AM-IG                             PIC X.
  1409         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  1410         88  AM-HAS-GROUP                     VALUE '2'.
  1411     12  AM-STATUS                         PIC X.
  1412         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  1413         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  1414         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  1415         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  1416         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  1417         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  1418     12  AM-REMIT-TO                       PIC 99.
  1419     12  AM-ID-NO                          PIC X(11).
  1420
  1421     12  AM-CAL-TABLE                      PIC XX.
  1422     12  AM-LF-DEVIATION                   PIC XXX.
  1423     12  AM-AH-DEVIATION                   PIC XXX.
  1424     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  1425     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  1426     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  1427     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  1428     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1429     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1430
  1431     12  AM-USER-FIELDS.
  1432         16  AM-FLD-1                      PIC XX.
  1433         16  AM-FLD-2                      PIC XX.
  1434         16  AM-FLD-3                      PIC XX.
  1435         16  AM-FLD-4                      PIC XX.
  1436         16  AM-FLD-5                      PIC XX.
  1437
  1438     12  AM-1ST-PROD-DATE.
  1439         16  AM-1ST-PROD-YR                PIC XX.
  1440         16  AM-1ST-PROD-MO                PIC XX.
  1441         16  AM-1ST-PROD-DA                PIC XX.
  1442     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  1443     12  AM-CERTS-PURGED-DATE.
  1444         16  AM-PUR-YR                     PIC XX.
  1445         16  AM-PUR-MO                     PIC XX.
  1446         16  AM-PUR-DA                     PIC XX.
  1447     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page  27
* EL6311.cbl
  1448     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  1449     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  1450     12  AM-INACTIVE-DATE.
  1451         16  AM-INA-MO                     PIC 99.
  1452         16  AM-INA-DA                     PIC 99.
  1453         16  AM-INA-YR                     PIC 99.
  1454     12  AM-AR-HI-CERT-DATE                PIC XX.
  1455
  1456     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  1457     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  1458
  1459     12  AM-OB-PAYMENT-MODE                PIC X.
  1460         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  1461         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  1462         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  1463         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  1464
  1465     12  AM-AH-ONLY-INDICATOR              PIC X.
  1466         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  1467         88  AM-NO-AH-ONLY                    VALUE 'N'.
  1468
  1469     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  1470
  1471     12  AM-OVER-SHORT.
  1472         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  1473         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  1474
  1475     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  1476     12  AM-DCC-CLP-STATE                  PIC XX.
  1477
  1478     12  AM-RECALC-COMM                    PIC X.
  1479     12  AM-RECALC-REIN                    PIC X.
  1480
  1481     12  AM-REI-TABLE                      PIC XXX.
  1482     12  AM-REI-ET-LF                      PIC X.
  1483     12  AM-REI-ET-AH                      PIC X.
  1484     12  AM-REI-PE-LF                      PIC X.
  1485     12  AM-REI-PE-AH                      PIC X.
  1486     12  AM-REI-PRT-ST                     PIC X.
  1487     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  1488     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  1489     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  1490     12  AM-REI-GROUP-A                    PIC X(6).
  1491     12  AM-REI-MORT                       PIC X(4).
  1492     12  AM-REI-PRT-OW                     PIC X.
  1493     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  1494     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  1495     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  1496     12  AM-REI-GROUP-B                    PIC X(6).
  1497
  1498     12  AM-TRUST-TYPE                     PIC X(2).
  1499
  1500     12  AM-EMPLOYER-STMT-USED             PIC X.
  1501     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  1502
  1503     12  AM-STD-AH-TYPE                    PIC XX.
  1504     12  AM-EARN-METHODS.
  1505         16  AM-EARN-METHOD-R              PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page  28
* EL6311.cbl
  1506             88 AM-REF-RL-R78                 VALUE 'R'.
  1507             88 AM-REF-RL-PR                  VALUE 'P'.
  1508             88 AM-REF-RL-MEAN                VALUE 'M'.
  1509             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  1510         16  AM-EARN-METHOD-L              PIC X.
  1511             88 AM-REF-LL-R78                 VALUE 'R'.
  1512             88 AM-REF-LL-PR                  VALUE 'P'.
  1513             88 AM-REF-LL-MEAN                VALUE 'M'.
  1514             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  1515         16  AM-EARN-METHOD-A              PIC X.
  1516             88 AM-REF-AH-R78                 VALUE 'R'.
  1517             88 AM-REF-AH-PR                  VALUE 'P'.
  1518             88 AM-REF-AH-MEAN                VALUE 'M'.
  1519             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  1520             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  1521             88 AM-REF-AH-NET                 VALUE 'N'.
  1522
  1523     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  1524     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  1525     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  1526
  1527     12  AM-RET-Y-N                        PIC X.
  1528     12  AM-RET-P-E                        PIC X.
  1529     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  1530     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  1531     12  AM-RET-GRP                        PIC X(6).
  1532     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  1533         16  AM-POOL-PRIME                 PIC XXX.
  1534         16  AM-POOL-SUB                   PIC XXX.
  1535     12  AM-RETRO-EARNINGS.
  1536         16  AM-RET-EARN-R                 PIC X.
  1537         16  AM-RET-EARN-L                 PIC X.
  1538         16  AM-RET-EARN-A                 PIC X.
  1539     12  AM-RET-ST-TAX-USE                 PIC X.
  1540         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  1541         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  1542     12  AM-RETRO-BEG-EARNINGS.
  1543         16  AM-RET-BEG-EARN-R             PIC X.
  1544         16  AM-RET-BEG-EARN-L             PIC X.
  1545         16  AM-RET-BEG-EARN-A             PIC X.
  1546     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  1547     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  1548
  1549     12  AM-USER-SELECT-OPTIONS.
  1550         16  AM-USER-SELECT-1              PIC X(10).
  1551         16  AM-USER-SELECT-2              PIC X(10).
  1552         16  AM-USER-SELECT-3              PIC X(10).
  1553         16  AM-USER-SELECT-4              PIC X(10).
  1554         16  AM-USER-SELECT-5              PIC X(10).
  1555
  1556     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  1557
  1558     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  1559
  1560     12  AM-RPT045A-SWITCH                 PIC X.
  1561         88  RPT045A-OFF                   VALUE 'N'.
  1562
  1563     12  AM-INSURANCE-LIMITS.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page  29
* EL6311.cbl
  1564         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  1565         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  1566
  1567     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  1568         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  1569
  1570     12  AM-DISMBR-COVERAGE-SW             PIC X.
  1571         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  1572         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  1573
  1574     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  1575
  1576     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  1577     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  1578     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  1579     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  1580     12  AM-DCC-UEF-STATE                  PIC XX.
  1581     12  FILLER                            PIC XXX.
  1582     12  AM-REPORT-CODE-3                  PIC X(10).
  1583*    12  FILLER                            PIC X(22).
  1584
  1585     12  AM-RESERVE-DATE.
  1586         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  1587         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  1588         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  1589
  1590     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  1591     12  AM-NOTIFICATION-TYPES.
  1592         16  AM-NOTIF-OF-LETTERS           PIC X.
  1593         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  1594         16  AM-NOTIF-OF-REPORTS           PIC X.
  1595         16  AM-NOTIF-OF-STATUS            PIC X.
  1596
  1597     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  1598         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  1599         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  1600         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  1601         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  1602
  1603     12  AM-BENEFIT-CONTROLS.
  1604         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  1605             20  AM-BENEFIT-CODE           PIC XX.
  1606             20  AM-BENEFIT-TYPE           PIC X.
  1607             20  AM-BENEFIT-REVISION       PIC XXX.
  1608             20  AM-BENEFIT-REM-TERM       PIC X.
  1609             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  1610             20  FILLER                    PIC XX.
  1611         16  FILLER                        PIC X(80).
  1612
  1613     12  AM-TRANSFER-DATA.
  1614         16  AM-TRANSFERRED-FROM.
  1615             20  AM-TRNFROM-CARRIER        PIC X.
  1616             20  AM-TRNFROM-GROUPING.
  1617                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  1618                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  1619             20  AM-TRNFROM-STATE          PIC XX.
  1620             20  AM-TRNFROM-ACCOUNT.
  1621                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page  30
* EL6311.cbl
  1622                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  1623             20  AM-TRNFROM-DTE            PIC XX.
  1624         16  AM-TRANSFERRED-TO.
  1625             20  AM-TRNTO-CARRIER          PIC X.
  1626             20  AM-TRNTO-GROUPING.
  1627                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  1628                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  1629             20  AM-TRNTO-STATE            PIC XX.
  1630             20  AM-TRNTO-ACCOUNT.
  1631                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  1632                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  1633             20  AM-TRNTO-DTE              PIC XX.
  1634         16  FILLER                        PIC X(10).
  1635
  1636     12  AM-SAVED-REMIT-TO                 PIC 99.
  1637
  1638     12  AM-COMM-STRUCTURE-SAVED.
  1639         16  AM-DEFN-1-SAVED.
  1640             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  1641                 24  AM-AGT-SV             PIC X(10).
  1642                 24  AM-COM-TYP-SV         PIC X.
  1643                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  1644                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  1645                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  1646                 24  AM-RECALC-LV-INDIC-SV PIC X.
  1647                 24  FILLER                PIC X.
  1648                 24  AM-GL-CODES-SV        PIC X.
  1649                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  1650                 24  FILLER                PIC X.
  1651         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  1652             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  1653                 24  FILLER                PIC X(11).
  1654                 24  AM-L-COMA-SV          PIC XXX.
  1655                 24  AM-J-COMA-SV          PIC XXX.
  1656                 24  AM-A-COMA-SV          PIC XXX.
  1657                 24  FILLER                PIC X(6).
  1658
  1659     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  1660         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  1661            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  1662            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  1663            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  1664
  1665     12  AM-ORIG-DEALER-NO                 PIC X(10).
  1666     12  FILLER                            PIC X(120).
  1667
  1668     12  AM-ACCOUNT-EXECUTIVE-DATA.
  1669         16  AM-CONTROL-NAME               PIC X(30).
  1670         16  AM-EXECUTIVE-ONE.
  1671             20  AM-EXEC1-NAME             PIC X(15).
  1672             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  1673                                                          COMP-3.
  1674             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  1675                                                          COMP-3.
  1676         16  AM-EXECUTIVE-TWO.
  1677             20  AM-EXEC2-NAME             PIC X(15).
  1678             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  1679                                                          COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page  31
* EL6311.cbl
  1680             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  1681                                                          COMP-3.
  1682
  1683     12  AM-RETRO-ADDITIONAL-DATA.
  1684         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  1685         16  AM-RETRO-PREM-P-E             PIC X.
  1686         16  AM-RETRO-CLMS-P-I             PIC X.
  1687         16  AM-RETRO-RET-BRACKET-LF.
  1688             20  AM-RETRO-RET-METHOD-LF    PIC X.
  1689                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  1690                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  1691             20  AM-RETRO-RET-BASIS-LF     PIC X.
  1692                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  1693                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  1694             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  1695                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  1696                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  1697         16  AM-RETRO-RET-BRACKET-AH.
  1698             20  AM-RETRO-RET-METHOD-AH    PIC X.
  1699                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  1700                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  1701                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  1702             20  AM-RETRO-RET-BASIS-AH     PIC X.
  1703                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  1704                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  1705             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  1706                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  1707                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  1708
  1709     12  AM-COMMENTS.
  1710         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  1711
  1712     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  1713         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  1714         16  AM-FLI-BILLING-CODE           PIC X.
  1715         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  1716         16  AM-FLI-UNITED-IDENT           PIC X.
  1717         16  AM-FLI-INTEREST-LOST-DATA.
  1718             20  AM-FLI-BANK-NO            PIC X(5).
  1719             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  1720             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  1721             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  1722         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  1723             20  AM-FLI-AGT                PIC X(9).
  1724             20  AM-FLI-AGT-COMM-ACC       PIC X.
  1725             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  1726         16  FILLER                        PIC X(102).
  1727
  1728     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  1729         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  1730             20  AM-BENEFIT-DMD-CODE         PIC XX.
  1731             20  AM-BENEFIT-DMD-TYPE         PIC X.
  1732             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  1733             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  1734             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  1735         16  FILLER                          PIC X(10).
  1736******************************************************************
  1737*                                COPY ELCVADS.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page  32
* EL6311.cbl
  1738******************************************************************
  1739*                                                                *
  1740*                                                                *
  1741*                            ELCVADS.                            *
  1742*                                                                *
  1743*   FILE DESCRIPTION = VIRGINIA DISLCOSURE FIELDS PASSED TO      *
  1744*   ELVADS                  LENGTH = 350                         *
  1745******************************************************************
  1746******************************************************************
  1747*                   C H A N G E   L O G
  1748*
  1749* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1750*-----------------------------------------------------------------
  1751*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1752* EFFECTIVE    NUMBER
  1753*-----------------------------------------------------------------
  1754* 100111    2011022800001  AJRA  NAPERSOFT
  1755******************************************************************
  1756
  1757 01  VIRGINIA-DISCLOSURE.
  1758     12  VD-COMPANY-CD              PIC X.
  1759     12  VD-CARRIER                 PIC X.
  1760     12  VD-GROUPING.
  1761         20  VD-GROUPING-PREFIX     PIC XXX.
  1762         20  VD-GROUPING-PRIME      PIC XXX.
  1763     12  VD-STATE                   PIC XX.
  1764     12  VD-ACCOUNT.
  1765         20  VD-ACCOUNT-PREFIX      PIC X(4).
  1766         20  VD-ACCOUNT-PRIME       PIC X(6).
  1767     12  VD-CERT-EFF-DT             PIC XX.
  1768     12  VD-CERT-NO.
  1769         20  VD-CERT-PRIME          PIC X(10).
  1770         20  VD-CERT-SFX            PIC X.
  1771     12  VD-ENTRY-BATCH             PIC X(6).
  1772     12  VD-CSR-ID                  PIC X(4).
  1773     12  VD-NAME.
  1774         20  VD-INSURED-LAST-NAME   PIC X(15).
  1775         20  VD-INSURED-FIRST-NAME.
  1776             24  VD-INSURED-1ST-INIT PIC X.
  1777             24  FILLER             PIC X(9).
  1778         20  VD-INSURED-MIDDLE-INIT PIC X.
  1779     12  VD-JOINT-INSURED.
  1780         20 VD-JOINT-LAST-NAME      PIC X(15).
  1781         20 VD-JOINT-FIRST-NAME.
  1782            24  VD-JOINT-FIRST-INIT PIC X.
  1783            24  FILLER              PIC X(9).
  1784         20 VD-JOINT-MIDDLE-INIT    PIC X.
  1785     12  VD-INSURED-ADDRESS-1       PIC X(30).
  1786     12  VD-INSURED-ADDRESS-2       PIC X(30).
  1787     12  VD-INSURED-CITY-STATE.
  1788         20  VD-INSURED-CITY        PIC X(28).
  1789         20  VD-INSURED-STATE       PIC XX.
  1790     12  VD-INSURED-ZIP-CODE.
  1791         20  VD-INSURED-ZIP-PRIME.
  1792             24  VD-INSURED-ZIP-1   PIC X.
  1793                 88  VD-CANADIAN-POST-CODE
  1794                                       VALUE 'A' THRU 'Z'.
  1795             24  FILLER             PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page  33
* EL6311.cbl
  1796         20  VD-INSURED-ZIP-PLUS4   PIC X(4).
  1797     12  VD-BENEFICIARY-NAME        PIC X(30).
  1798     12  VD-ACCOUNT-NAME            PIC X(30).
  1799     12  VD-LOAN-TERM               PIC S999   COMP-3.
  1800     12  VD-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  1801     12  VD-1ST-PMT-DT              PIC XX.
  1802     12  VD-LIFE-BENEFIT-CD         PIC XX.
  1803         88  VD-VALID-LIFE             VALUE '01' THRU '89'.
  1804         88  VD-INVALID-LIFE           VALUE '  ' '00'
  1805                                             '90' THRU '99'.
  1806     12  VD-LF-BENEFIT-CD   REDEFINES VD-LIFE-BENEFIT-CD
  1807                                    PIC XX.
  1808     12  VD-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  1809     12  VD-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  1810     12  VD-LF-RATE                 PIC S99V9(5)   COMP-3.
  1811     12  VD-LF-TERM                 PIC S999   COMP-3.
  1812     12  VD-AH-BENEFIT-CD           PIC XX.
  1813         88  VD-VALID-AH               VALUE '01' THRU '89'.
  1814         88  VD-INVALID-AH             VALUE '  ' '00'
  1815                                             '90' THRU '99'.
  1816     12  VD-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  1817     12  VD-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  1818     12  VD-AH-RATE                 PIC S99V9(5)   COMP-3.
  1819     12  VD-AH-TERM                 PIC S999   COMP-3.
  1820     12  VD-LETTER-ID               PIC X(4).
  1821     12  VD-PROC-ID                 PIC X(4).
  1822     12  VD-COMP-ID                 PIC X(3).
  1823     12  VD-CURRENT-DATE            PIC XX.
  1824     12  VD-CURRENT-TIME            PIC S9(6) COMP-3.
  1825     12  VD-ARCHIVE-NO              PIC S9(08) COMP VALUE +0.
  1826     12  FILLER                     PIC X(32).
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page  34
* EL6311.cbl
  1828*    COPY ELCDATE.
  1829******************************************************************
  1830*                                                                *
  1831*                                                                *
  1832*                            ELCDATE.                            *
  1833*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1834*                            VMOD=2.003
  1835*                                                                *
  1836*                                                                *
  1837*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  1838*                 LENGTH = 200                                   *
  1839******************************************************************
  1840
  1841 01  DATE-CONVERSION-DATA.
  1842     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  1843     12  DC-OPTION-CODE                PIC X.
  1844         88  BIN-TO-GREG                VALUE ' '.
  1845         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  1846         88  EDIT-GREG-TO-BIN           VALUE '2'.
  1847         88  YMD-GREG-TO-BIN            VALUE '3'.
  1848         88  MDY-GREG-TO-BIN            VALUE '4'.
  1849         88  JULIAN-TO-BIN              VALUE '5'.
  1850         88  BIN-PLUS-ELAPSED           VALUE '6'.
  1851         88  FIND-CENTURY               VALUE '7'.
  1852         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  1853         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  1854         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  1855         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  1856         88  JULIAN-TO-BIN-3            VALUE 'C'.
  1857         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  1858         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  1859         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  1860         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  1861         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  1862         88  CHECK-LEAP-YEAR            VALUE 'H'.
  1863         88  BIN-3-TO-GREG              VALUE 'I'.
  1864         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  1865         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  1866         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  1867         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  1868         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  1869         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  1870         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  1871         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  1872         88  THREE-CHARACTER-BIN
  1873                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  1874         88  GREGORIAN-TO-BIN
  1875                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  1876         88  BIN-TO-GREGORIAN
  1877                  VALUES ' ' '1' 'I' '8' 'G'.
  1878         88  JULIAN-TO-BINARY
  1879                  VALUES '5' 'C' 'E' 'F'.
  1880     12  DC-ERROR-CODE                 PIC X.
  1881         88  NO-CONVERSION-ERROR        VALUE ' '.
  1882         88  DATE-CONVERSION-ERROR
  1883                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  1884         88  DATE-IS-ZERO               VALUE '1'.
  1885         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page  35
* EL6311.cbl
  1886         88  DATE-IS-INVALID            VALUE '3'.
  1887         88  DATE1-GREATER-DATE2        VALUE '4'.
  1888         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  1889         88  DATE-INVALID-OPTION        VALUE '9'.
  1890         88  INVALID-CENTURY            VALUE 'A'.
  1891         88  ONLY-CENTURY               VALUE 'B'.
  1892         88  ONLY-LEAP-YEAR             VALUE 'C'.
  1893         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  1894     12  DC-END-OF-MONTH               PIC X.
  1895         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  1896     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  1897         88  USE-NORMAL-PROCESS         VALUE ' '.
  1898         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  1899         88  ADJUST-UP-100-YRS          VALUE '2'.
  1900     12  FILLER                        PIC X.
  1901     12  DC-CONVERSION-DATES.
  1902         16  DC-BIN-DATE-1             PIC XX.
  1903         16  DC-BIN-DATE-2             PIC XX.
  1904         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  1905         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  1906                       DC-GREG-DATE-1-EDIT.
  1907             20  DC-EDIT1-MONTH        PIC 99.
  1908             20  SLASH1-1              PIC X.
  1909             20  DC-EDIT1-DAY          PIC 99.
  1910             20  SLASH1-2              PIC X.
  1911             20  DC-EDIT1-YEAR         PIC 99.
  1912         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  1913         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  1914                     DC-GREG-DATE-2-EDIT.
  1915             20  DC-EDIT2-MONTH        PIC 99.
  1916             20  SLASH2-1              PIC X.
  1917             20  DC-EDIT2-DAY          PIC 99.
  1918             20  SLASH2-2              PIC X.
  1919             20  DC-EDIT2-YEAR         PIC 99.
  1920         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  1921         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  1922                     DC-GREG-DATE-1-YMD.
  1923             20  DC-YMD-YEAR           PIC 99.
  1924             20  DC-YMD-MONTH          PIC 99.
  1925             20  DC-YMD-DAY            PIC 99.
  1926         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  1927         16  DC-GREG-DATE-1-MDY-R REDEFINES
  1928                      DC-GREG-DATE-1-MDY.
  1929             20  DC-MDY-MONTH          PIC 99.
  1930             20  DC-MDY-DAY            PIC 99.
  1931             20  DC-MDY-YEAR           PIC 99.
  1932         16  DC-GREG-DATE-1-ALPHA.
  1933             20  DC-ALPHA-MONTH        PIC X(10).
  1934             20  DC-ALPHA-DAY          PIC 99.
  1935             20  FILLER                PIC XX.
  1936             20  DC-ALPHA-CENTURY.
  1937                 24 DC-ALPHA-CEN-N     PIC 99.
  1938             20  DC-ALPHA-YEAR         PIC 99.
  1939         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  1940         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  1941         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  1942         16  DC-JULIAN-DATE            PIC 9(05).
  1943         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page  36
* EL6311.cbl
  1944                                       PIC 9(05).
  1945         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  1946             20  DC-JULIAN-YEAR        PIC 99.
  1947             20  DC-JULIAN-DAYS        PIC 999.
  1948         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  1949         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  1950         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  1951     12  DATE-CONVERSION-VARIBLES.
  1952         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  1953         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  1954             20  FILLER                PIC 9(3).
  1955             20  HOLD-CEN-1-CCYY.
  1956                 24  HOLD-CEN-1-CC     PIC 99.
  1957                 24  HOLD-CEN-1-YY     PIC 99.
  1958             20  HOLD-CEN-1-MO         PIC 99.
  1959             20  HOLD-CEN-1-DA         PIC 99.
  1960         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  1961             20  HOLD-CEN-1-R-MO       PIC 99.
  1962             20  HOLD-CEN-1-R-DA       PIC 99.
  1963             20  HOLD-CEN-1-R-CCYY.
  1964                 24  HOLD-CEN-1-R-CC   PIC 99.
  1965                 24  HOLD-CEN-1-R-YY   PIC 99.
  1966             20  FILLER                PIC 9(3).
  1967         16  HOLD-CENTURY-1-X.
  1968             20  FILLER                PIC X(3)  VALUE SPACES.
  1969             20  HOLD-CEN-1-X-CCYY.
  1970                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  1971                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  1972             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  1973             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  1974         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  1975             20  HOLD-CEN-1-R-X-MO     PIC XX.
  1976             20  HOLD-CEN-1-R-X-DA     PIC XX.
  1977             20  HOLD-CEN-1-R-X-CCYY.
  1978                 24  HOLD-CEN-1-R-X-CC PIC XX.
  1979                 24  HOLD-CEN-1-R-X-YY PIC XX.
  1980             20  FILLER                PIC XXX.
  1981         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  1982         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  1983         16  DC-JULIAN-DATE-1          PIC 9(07).
  1984         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  1985             20  DC-JULIAN-1-CCYY.
  1986                 24  DC-JULIAN-1-CC    PIC 99.
  1987                 24  DC-JULIAN-1-YR    PIC 99.
  1988             20  DC-JULIAN-DA-1        PIC 999.
  1989         16  DC-JULIAN-DATE-2          PIC 9(07).
  1990         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  1991             20  DC-JULIAN-2-CCYY.
  1992                 24  DC-JULIAN-2-CC    PIC 99.
  1993                 24  DC-JULIAN-2-YR    PIC 99.
  1994             20  DC-JULIAN-DA-2        PIC 999.
  1995         16  DC-GREG-DATE-A-EDIT.
  1996             20  DC-EDITA-MONTH        PIC 99.
  1997             20  SLASHA-1              PIC X VALUE '/'.
  1998             20  DC-EDITA-DAY          PIC 99.
  1999             20  SLASHA-2              PIC X VALUE '/'.
  2000             20  DC-EDITA-CCYY.
  2001                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page  37
* EL6311.cbl
  2002                 24  DC-EDITA-YEAR     PIC 99.
  2003         16  DC-GREG-DATE-B-EDIT.
  2004             20  DC-EDITB-MONTH        PIC 99.
  2005             20  SLASHB-1              PIC X VALUE '/'.
  2006             20  DC-EDITB-DAY          PIC 99.
  2007             20  SLASHB-2              PIC X VALUE '/'.
  2008             20  DC-EDITB-CCYY.
  2009                 24  DC-EDITB-CENT     PIC 99.
  2010                 24  DC-EDITB-YEAR     PIC 99.
  2011         16  DC-GREG-DATE-CYMD         PIC 9(08).
  2012         16  DC-GREG-DATE-CYMD-R REDEFINES
  2013                              DC-GREG-DATE-CYMD.
  2014             20  DC-CYMD-CEN           PIC 99.
  2015             20  DC-CYMD-YEAR          PIC 99.
  2016             20  DC-CYMD-MONTH         PIC 99.
  2017             20  DC-CYMD-DAY           PIC 99.
  2018         16  DC-GREG-DATE-MDCY         PIC 9(08).
  2019         16  DC-GREG-DATE-MDCY-R REDEFINES
  2020                              DC-GREG-DATE-MDCY.
  2021             20  DC-MDCY-MONTH         PIC 99.
  2022             20  DC-MDCY-DAY           PIC 99.
  2023             20  DC-MDCY-CEN           PIC 99.
  2024             20  DC-MDCY-YEAR          PIC 99.
  2025    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  2026        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  2027    12  DC-EL310-DATE                  PIC X(21).
  2028    12  FILLER                         PIC X(28).
  2029
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page  38
* EL6311.cbl
  2031*    COPY ELCLOGOF.
  2032******************************************************************
  2033*                                                                *
  2034*                                                                *
  2035*                            ELCLOGOF.                           *
  2036*                            VMOD=2.001                          *
  2037*                                                                *
  2038*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  2039*                                                                *
  2040******************************************************************
  2041 01  CLASIC-LOGOFF.
  2042     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  2043     12  LOGOFF-TEXT.
  2044         16  FILLER          PIC X(5)    VALUE SPACES.
  2045         16  LOGOFF-MSG.
  2046             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  2047             20  FILLER      PIC X       VALUE SPACES.
  2048             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  2049         16  FILLER          PIC X(80)
  2050           VALUE '* YOU ARE NOW LOGGED OFF'.
  2051         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  2052         16  FILLER          PIC X       VALUE QUOTE.
  2053         16  LOGOFF-SYS-MSG  PIC X(17)
  2054           VALUE 'S CLAS-IC SYSTEM '.
  2055     12  TEXT-MESSAGES.
  2056         16  UNACCESS-MSG    PIC X(29)
  2057             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  2058         16  PGMIDERR-MSG    PIC X(17)
  2059             VALUE 'PROGRAM NOT FOUND'.
  2060
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page  39
* EL6311.cbl
  2062*    COPY ELCATTR.
  2063******************************************************************
  2064*                                                                *
  2065*                            ELCATTR.                            *
  2066*                            VMOD=2.001                          *
  2067*                                                                *
  2068*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  2069*                                                                *
  2070*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  2071*                                                                *
  2072*                   POS 1   P=PROTECTED                          *
  2073*                           U=UNPROTECTED                        *
  2074*                           S=ASKIP                              *
  2075*                   POS 2   A=ALPHA/NUMERIC                      *
  2076*                           N=NUMERIC                            *
  2077*                   POS 3   N=NORMAL                             *
  2078*                           B=BRIGHT                             *
  2079*                           D=DARK                               *
  2080*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  2081*                           OF=MODIFIED DATA TAG OFF             *
  2082*                                                                *
  2083*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  2084******************************************************************
  2085 01  ATTRIBUTE-LIST.
  2086     12  AL-PABOF            PIC X       VALUE 'Y'.
  2087     12  AL-PABON            PIC X       VALUE 'Z'.
  2088     12  AL-PADOF            PIC X       VALUE '%'.
  2089     12  AL-PADON            PIC X       VALUE '_'.
  2090     12  AL-PANOF            PIC X       VALUE '-'.
  2091     12  AL-PANON            PIC X       VALUE '/'.
  2092     12  AL-SABOF            PIC X       VALUE '8'.
  2093     12  AL-SABON            PIC X       VALUE '9'.
  2094     12  AL-SADOF            PIC X       VALUE '@'.
  2095     12  AL-SADON            PIC X       VALUE QUOTE.
  2096     12  AL-SANOF            PIC X       VALUE '0'.
  2097     12  AL-SANON            PIC X       VALUE '1'.
  2098     12  AL-UABOF            PIC X       VALUE 'H'.
  2099     12  AL-UABON            PIC X       VALUE 'I'.
  2100     12  AL-UADOF            PIC X       VALUE '<'.
  2101     12  AL-UADON            PIC X       VALUE '('.
  2102     12  AL-UANOF            PIC X       VALUE ' '.
  2103     12  AL-UANON            PIC X       VALUE 'A'.
  2104     12  AL-UNBOF            PIC X       VALUE 'Q'.
  2105     12  AL-UNBON            PIC X       VALUE 'R'.
  2106     12  AL-UNDOF            PIC X       VALUE '*'.
  2107     12  AL-UNDON            PIC X       VALUE ')'.
  2108     12  AL-UNNOF            PIC X       VALUE '&'.
  2109     12  AL-UNNON            PIC X       VALUE 'J'.
  2110
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page  40
* EL6311.cbl
  2112*    COPY ELCEMIB.
  2113******************************************************************
  2114*                                                                *
  2115*                                                                *
  2116*                            ELCEMIB.                            *
  2117*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2118*                            VMOD=2.005                          *
  2119*                                                                *
  2120*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  2121*                                                                *
  2122******************************************************************
  2123 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  2124     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  2125     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  2126     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  2127     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  2128     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  2129     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  2130     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  2131     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  2132     12  EMI-SWITCH1             PIC X        VALUE '1'.
  2133         88  EMI-NO-ERRORS                    VALUE '1'.
  2134         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  2135         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  2136     12  EMI-SWITCH2             PIC X        VALUE '1'.
  2137         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  2138     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  2139         88  EMI-AREA1-EMPTY                  VALUE '1'.
  2140         88  EMI-AREA1-FULL                   VALUE '2'.
  2141     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  2142         88  EMI-AREA2-EMPTY                  VALUE '1'.
  2143         88  EMI-AREA2-FULL                   VALUE '2'.
  2144     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  2145         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  2146         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  2147         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  2148         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  2149         88  EMI-BYPASS-FATALS                VALUE 'X'.
  2150     12  EMI-ERROR-LINES.
  2151         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  2152         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  2153         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  2154         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  2155             20  EMI-ERR-CODES OCCURS 10 TIMES.
  2156                 24  EMI-ERR-NUM         PIC X(4).
  2157                 24  EMI-FILLER          PIC X.
  2158                 24  EMI-SEV             PIC X.
  2159                 24  FILLER              PIC X.
  2160             20  FILLER                  PIC X(02).
  2161     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  2162         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  2163             20  EMI-ERROR-NUMBER    PIC X(4).
  2164             20  EMI-FILL            PIC X.
  2165             20  EMI-SEVERITY        PIC X.
  2166             20  FILLER              PIC X.
  2167             20  EMI-ERROR-TEXT.
  2168                 24  EMI-TEXT-VARIABLE   PIC X(10).
  2169                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page  41
* EL6311.cbl
  2170     12  EMI-SEVERITY-SAVE           PIC X.
  2171         88  EMI-NOTE                    VALUE 'N'.
  2172         88  EMI-WARNING                 VALUE 'W'.
  2173         88  EMI-FORCABLE                VALUE 'F'.
  2174         88  EMI-FATAL                   VALUE 'X'.
  2175     12  EMI-MESSAGE-FLAG            PIC X.
  2176         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  2177         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  2178     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  2179     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  2180         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  2181         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  2182         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  2183     12  emi-claim-no                pic x(7).
  2184     12  emi-claim-type              pic x(6).
  2185     12  FILLER                      PIC X(124)  VALUE SPACES.
  2186     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  2187     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  2188     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  2189     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  2190
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page  42
* EL6311.cbl
  2192*    COPY ELCINTF.
  2193******************************************************************
  2194*                                                                *
  2195*                                                                *
  2196*                            ELCINTF.                            *
  2197*                            VMOD=2.017                          *
  2198*                                                                *
  2199*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  2200*                                                                *
  2201*       LENGTH = 1024                                            *
  2202*                                                                *
  2203******************************************************************
  2204*                   C H A N G E   L O G
  2205*
  2206* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2207*-----------------------------------------------------------------
  2208*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2209* EFFECTIVE    NUMBER
  2210*-----------------------------------------------------------------
  2211* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2212******************************************************************
  2213 01  PROGRAM-INTERFACE-BLOCK.
  2214     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  2215     12  PI-CALLING-PROGRAM              PIC X(8).
  2216     12  PI-SAVED-PROGRAM-1              PIC X(8).
  2217     12  PI-SAVED-PROGRAM-2              PIC X(8).
  2218     12  PI-SAVED-PROGRAM-3              PIC X(8).
  2219     12  PI-SAVED-PROGRAM-4              PIC X(8).
  2220     12  PI-SAVED-PROGRAM-5              PIC X(8).
  2221     12  PI-SAVED-PROGRAM-6              PIC X(8).
  2222     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  2223     12  PI-COMPANY-ID                   PIC XXX.
  2224     12  PI-COMPANY-CD                   PIC X.
  2225
  2226     12  PI-COMPANY-PASSWORD             PIC X(8).
  2227
  2228     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  2229
  2230     12  PI-CONTROL-IN-PROGRESS.
  2231         16  PI-CARRIER                  PIC X.
  2232         16  PI-GROUPING                 PIC X(6).
  2233         16  PI-STATE                    PIC XX.
  2234         16  PI-ACCOUNT                  PIC X(10).
  2235         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  2236                                         PIC X(10).
  2237         16  PI-CLAIM-CERT-GRP.
  2238             20  PI-CLAIM-NO             PIC X(7).
  2239             20  PI-CERT-NO.
  2240                 25  PI-CERT-PRIME       PIC X(10).
  2241                 25  PI-CERT-SFX         PIC X.
  2242             20  PI-CERT-EFF-DT          PIC XX.
  2243         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  2244             20  PI-PLAN-CODE            PIC X(2).
  2245             20  PI-REVISION-NUMBER      PIC X(3).
  2246             20  PI-PLAN-EFF-DT          PIC X(2).
  2247             20  PI-PLAN-EXP-DT          PIC X(2).
  2248             20  FILLER                  PIC X(11).
  2249         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page  43
* EL6311.cbl
  2250             20  PI-OE-REFERENCE-1.
  2251                 25  PI-OE-REF-1-PRIME   PIC X(18).
  2252                 25  PI-OE-REF-1-SUFF    PIC XX.
  2253
  2254     12  PI-SESSION-IN-PROGRESS          PIC X.
  2255         88  CLAIM-SESSION                   VALUE '1'.
  2256         88  CREDIT-SESSION                  VALUE '2'.
  2257         88  WARRANTY-SESSION                VALUE '3'.
  2258         88  MORTGAGE-SESSION                VALUE '4'.
  2259         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  2260
  2261
  2262*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  2263
  2264     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  2265     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  2266
  2267     12  PI-CREDIT-USER                  PIC X.
  2268         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  2269         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  2270
  2271     12  PI-CLAIM-USER                   PIC X.
  2272         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  2273         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  2274
  2275     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  2276         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  2277         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  2278         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  2279         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  2280         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  2281
  2282     12  PI-PROCESSOR-ID                 PIC X(4).
  2283
  2284     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  2285
  2286     12  PI-MEMBER-CAPTION               PIC X(10).
  2287
  2288     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  2289         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  2290
  2291     12  PI-LIFE-OVERRIDE-L1             PIC X.
  2292     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  2293     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  2294     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  2295
  2296     12  PI-AH-OVERRIDE-L1               PIC X.
  2297     12  PI-AH-OVERRIDE-L2               PIC XX.
  2298     12  PI-AH-OVERRIDE-L6               PIC X(6).
  2299     12  PI-AH-OVERRIDE-L12              PIC X(12).
  2300
  2301     12  PI-NEW-SYSTEM                   PIC X(2).
  2302
  2303     12  PI-PRIMARY-CERT-NO              PIC X(11).
  2304     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  2305         88  PI-USES-PAID-TO                 VALUE '1'.
  2306     12  PI-CRDTCRD-SYSTEM.
  2307         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page  44
* EL6311.cbl
  2308             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  2309             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  2310         16  PI-CC-MONTH-END-DT          PIC XX.
  2311     12  PI-PROCESSOR-PRINTER            PIC X(4).
  2312
  2313     12  PI-OE-REFERENCE-2.
  2314         16  PI-OE-REF-2-PRIME           PIC X(10).
  2315         16  PI-OE-REF-2-SUFF            PIC X.
  2316
  2317     12  PI-REM-TRM-CALC-OPTION          PIC X.
  2318
  2319     12  PI-LANGUAGE-TYPE                PIC X.
  2320             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  2321             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  2322             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  2323
  2324     12  PI-POLICY-LINKAGE-IND           PIC X.
  2325         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  2326         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  2327                                                   LOW-VALUES.
  2328
  2329     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  2330     12  PI-CLAIM-PW-SESSION             PIC X(1).
  2331         88  PI-CLAIM-CREDIT                 VALUE '1'.
  2332         88  PI-CLAIM-CONVEN                 VALUE '2'.
  2333
  2334     12  PI-PROCESSOR-CSR-IND            PIC X.
  2335         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  2336         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  2337
  2338     12  FILLER                          PIC X(3).
  2339
  2340     12  PI-SYSTEM-LEVEL                 PIC X(145).
  2341
  2342     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  2343         PI-SYSTEM-LEVEL.
  2344
  2345         16  PI-ENTRY-CODES.
  2346             20  PI-ENTRY-CD-1           PIC X.
  2347             20  PI-ENTRY-CD-2           PIC X.
  2348
  2349         16  PI-RETURN-CODES.
  2350             20  PI-RETURN-CD-1          PIC X.
  2351             20  PI-RETURN-CD-2          PIC X.
  2352
  2353         16  PI-UPDATE-STATUS-SAVE.
  2354             20  PI-UPDATE-BY            PIC X(4).
  2355             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  2356
  2357         16  PI-LOWER-CASE-LETTERS       PIC X.
  2358             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  2359
  2360*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  2361*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  2362*            88  CARRIER-CLM-CNTL            VALUE '2'.
  2363
  2364         16  PI-CERT-ACCESS-CONTROL      PIC X.
  2365             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page  45
* EL6311.cbl
  2366             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2367             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  2368             88  ACCNT-CNTL                  VALUE '3'.
  2369             88  CARR-ACCNT-CNTL             VALUE '4'.
  2370
  2371         16  PI-PROCESSOR-CAP-LIST.
  2372             20  PI-SYSTEM-CONTROLS.
  2373                24 PI-SYSTEM-DISPLAY     PIC X.
  2374                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  2375                24 PI-SYSTEM-MODIFY      PIC X.
  2376                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  2377             20  FILLER                  PIC XX.
  2378             20  PI-DISPLAY-CAP          PIC X.
  2379                 88  DISPLAY-CAP             VALUE 'Y'.
  2380             20  PI-MODIFY-CAP           PIC X.
  2381                 88  MODIFY-CAP              VALUE 'Y'.
  2382             20  PI-MSG-AT-LOGON-CAP     PIC X.
  2383                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  2384             20  PI-FORCE-CAP            PIC X.
  2385                 88  FORCE-CAP               VALUE 'Y'.
  2386
  2387         16  PI-PROGRAM-CONTROLS.
  2388             20  PI-PGM-PRINT-OPT        PIC X.
  2389             20  PI-PGM-FORMAT-OPT       PIC X.
  2390             20  PI-PGM-PROCESS-OPT      PIC X.
  2391             20  PI-PGM-TOTALS-OPT       PIC X.
  2392
  2393         16  PI-HELP-INTERFACE.
  2394             20  PI-LAST-ERROR-NO        PIC X(4).
  2395             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  2396
  2397         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  2398             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  2399
  2400         16  PI-CR-CONTROL-IN-PROGRESS.
  2401             20  PI-CR-CARRIER           PIC X.
  2402             20  PI-CR-GROUPING          PIC X(6).
  2403             20  PI-CR-STATE             PIC XX.
  2404             20  PI-CR-ACCOUNT           PIC X(10).
  2405             20  PI-CR-FIN-RESP          PIC X(10).
  2406             20  PI-CR-TYPE              PIC X.
  2407
  2408         16  PI-CR-BATCH-NUMBER          PIC X(6).
  2409
  2410         16  PI-CR-MONTH-END-DT          PIC XX.
  2411
  2412         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  2413             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  2414             88  PI-ZERO-CARRIER             VALUE '1'.
  2415             88  PI-ZERO-GROUPING            VALUE '2'.
  2416             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  2417
  2418         16  PI-CARRIER-SECURITY         PIC X.
  2419             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  2420
  2421         16  PI-ACCOUNT-SECURITY         PIC X(10).
  2422             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  2423             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page  46
* EL6311.cbl
  2424
  2425         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  2426             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  2427                                         INDEXED BY PI-ACCESS-NDX
  2428                                         PIC X.
  2429
  2430         16  PI-GA-BILLING-CONTROL       PIC X.
  2431             88  PI-GA-BILLING               VALUE '1'.
  2432
  2433         16  PI-MAIL-PROCESSING          PIC X.
  2434             88  PI-MAIL-YES                 VALUE 'Y'.
  2435
  2436         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  2437
  2438         16  PI-AR-SYSTEM.
  2439             20  PI-AR-PROCESSING-CNTL   PIC X.
  2440                 88  PI-AR-PROCESSING        VALUE 'Y'.
  2441             20  PI-AR-SUMMARY-CODE      PIC X(6).
  2442             20  PI-AR-MONTH-END-DT      PIC XX.
  2443
  2444         16  PI-MP-SYSTEM.
  2445             20  PI-MORTGAGE-USER            PIC X.
  2446                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  2447                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  2448             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  2449                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  2450                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  2451                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  2452                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  2453                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  2454             20  PI-MP-MONTH-END-DT          PIC XX.
  2455             20  PI-MP-REFERENCE-NO.
  2456                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  2457                 24  PI-MP-REFERENCE-SFX     PIC XX.
  2458
  2459         16  PI-LABEL-CONTROL            PIC X(01).
  2460             88  PI-CREATE-LABELS                    VALUE 'Y'.
  2461             88  PI-BYPASS-LABELS                    VALUE 'N'.
  2462
  2463         16  PI-BILL-GROUPING-CODE       PIC X(01).
  2464             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  2465
  2466         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  2467             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  2468             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  2469
  2470         16  FILLER                      PIC X(14).
  2471
  2472     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  2473******************************************************************
  2474
  2475     12  FILLER REDEFINES PI-PROGRAM-WORK-AREA.
  2476*    COPY ELC631PI.
  2477******************************************************************
  2478*                                                                *
  2479*                                                                *
  2480*                            ELC631PI                            *
  2481*                            VMOD=2.012                          *
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page  47
* EL6311.cbl
  2482*                                                                *
  2483*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
  2484*    REVIEW AND CORRRECTION SUB-SYSTEM.  ANY CHANGES WILL        *
  2485*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
  2486*                                                                *
  2487*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
  2488*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
  2489*    BETWEEN PROGRAMS.                                           *
  2490*                                                                *
  2491*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
  2492*                                                                *
  2493*               EL631 - EL6311 - EL6312 - EL6313                 *
  2494*                                                                *
  2495******************************************************************
  2496
  2497         16  PI-631-DATA.
  2498             20  PI-ERPNDB-KEY.
  2499                 24  PI-PB-COMPANY-CD     PIC X.
  2500                 24  PI-PB-ENTRY-BATCH    PIC X(6).
  2501                 24  PI-PB-BATCH-SEQ-NO   PIC S9(4) COMP.
  2502                 24  PI-PB-BATCH-CHG-SEQ-NO PIC S9(4) COMP.
  2503
  2504             20  PI-ERPNDB-ALT-KEY.
  2505                 24  PI-PB-COMPANY-CD-A1  PIC X.
  2506                 24  PI-PB-CARRIER        PIC X.
  2507                 24  PI-PB-GROUPING       PIC X(6).
  2508                 24  PI-PB-STATE          PIC XX.
  2509                 24  PI-PB-ACCOUNT        PIC X(10).
  2510                 24  PI-PB-CERT-EFF-DT    PIC XX.
  2511                 24  PI-PB-CERT-NO.
  2512                     28  PI-PB-CERT-PRIME PIC X(10).
  2513                     28  PI-PB-CERT-SFX   PIC X.
  2514                 24  PI-PB-ALT-CHG-SEQ-NO PIC S9(4) COMP.
  2515                 24  PI-PB-RECORD-TYPE    PIC X.
  2516
  2517             20  PI-ERPNDB-CSR-KEY.
  2518                 24  PI-PB-CSR-COMPANY-CD-A2  PIC X.
  2519                 24  PI-PB-CSR-ID             PIC X(4).
  2520                 24  PI-PB-CSR-ENTRY-BATCH    PIC X(6).
  2521                 24  PI-PB-CSR-BTCH-SEQ-NO    PIC S9(4) COMP.
  2522                 24  PI-PB-CSR-BTCH-CHG-SEQ-NO PIC S9(4) COMP.
  2523
  2524             20  PI-BROWSE-TYPE               PIC X.
  2525                 88  PI-FILE-BROWSE             VALUE ' '.
  2526                 88  PI-PRIMARY-BROWSE          VALUE '1'.
  2527                 88  PI-ALTERNATE-BROWSE        VALUE '2'.
  2528                 88  PI-PRIMARY-WITH-SELECT     VALUE '3'.
  2529                 88  PI-CSR-BROWSE              VALUE '4'.
  2530
  2531             20  PI-MAINT-FUNCTION            PIC X.
  2532                 88  PI-ADD-FUNCTION            VALUE 'A'.
  2533                 88  PI-BROWSE-FUNCTION         VALUE 'B'.
  2534                 88  PI-CHANGE-FUNCTION         VALUE 'C'.
  2535                 88  PI-DELETE-FUNCTION         VALUE 'D'.
  2536                 88  PI-SHOW-FUNCTION           VALUE 'S'.
  2537                 88  PI-PF5-FUNCTION            VALUE '5'.
  2538                 88  PI-PF6-FUNCTION            VALUE '6'.
  2539
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page  48
* EL6311.cbl
  2540             20  PI-FILE-SWITCHES.
  2541                 24  PI-ALL-ISSUES-SW         PIC X.
  2542                     88  ALL-ISSUES             VALUE 'Y'.
  2543                 24  PI-ALL-CANCELS-SW        PIC X.
  2544                     88  ALL-CANCELS            VALUE 'Y'.
  2545                 24  PI-ISSUES-IN-ERROR-SW    PIC X.
  2546                     88  ISSUES-IN-ERROR        VALUE 'Y'.
  2547                 24  PI-CANCELS-IN-ERROR-SW   PIC X.
  2548                     88  CANCEL-IN-ERROR        VALUE 'Y'.
  2549                 24  PI-ONLY-BATCH-HEADERS-SW PIC X.
  2550                     88  ONLY-BATCH-HEADERS     VALUE 'Y'.
  2551                 24  PI-ALL-OUT-OF-BAL-SW     PIC X.
  2552                     88  ALL-OUT-OF-BAL         VALUE 'Y'.
  2553                 24  PI-HOLD-REC-SW           PIC X.
  2554                     88  DISPLAY-HOLD-RECORDS   VALUE 'Y'.
  2555                 24  PI-CHANGE-REC-SW         PIC X.
  2556                     88  DISPLAY-CHANGE-RECORDS VALUE 'Y'.
  2557                 24  PI-CHK-REQ-REC-SW        PIC X.
  2558                     88  DISPLAY-CHK-REQ-RECORDS VALUE 'Y'.
  2559                 24  PI-ISSUE-WARNING-SW      PIC X.
  2560                     88  ISSUE-WITH-WARNING     VALUE 'Y'.
  2561                 24  PI-CANCEL-WARNING-SW     PIC X.
  2562                     88  CANCEL-WITH-WARNING    VALUE 'Y'.
  2563             20  PI-DISPLAY-SCREEN-SW         PIC X.
  2564                     88  PI-DISPLAY-SCREEN      VALUE 'Y'.
  2565             20  PI-ORIGINAL-BATCH-SW         PIC X.
  2566                     88  PI-DISPLAY-ORIGINAL-BATCH VALUE 'Y'.
  2567
  2568             20  PI-MAP-NAME                  PIC X(8).
  2569
  2570             20  PI-CURSOR                    PIC S9(4) COMP.
  2571
  2572             20  PI-PREV-ALT-KEY              PIC X(36).
  2573             20  PI-PREV-CSR-KEY              PIC X(15).
  2574             20  PI-PREV-KEY.
  2575                 24  PI-PREV-COMPANY-CD       PIC X.
  2576                 24  PI-PREV-BATCH            PIC X(6).
  2577                 24  PI-PREV-SEQ-NO           PIC S9(4) COMP.
  2578                 24  PI-PREV-CHG-SEQ-NO       PIC S9(4) COMP.
  2579             20  PI-PREV-CONTROL-PRIMARY      PIC X(11).
  2580             20  PI-BROWSE-SW                 PIC X.
  2581                 88  PI-GOOD-BROWSE             VALUE 'Y'.
  2582                 88  PI-NO-PB-RECS-FOUND        VALUE '9'.
  2583             20  PI-SV-CARRIER                PIC X.
  2584             20  PI-SV-GROUPING               PIC X(6).
  2585             20  PI-SV-STATE                  PIC XX.
  2586             20  PI-EDIT-SW                   PIC X.
  2587             20  PI-DISPLAY-SW                PIC XX.
  2588                 88 PI-DISPLAY-LIFE        VALUE 'LF'.
  2589                 88 PI-DISPLAY-AH          VALUE 'AH'.
  2590             20  PI-CRITERIA-DATA             PIC X(350).
  2591             20  PI-BMODE                     PIC X.
  2592             20  PI-BPMTAMT                   PIC S9(7)V99 COMP-3.
  2593             20  PI-BPMTS                     PIC S999     COMP-3.
  2594             20  PI-BTYPE                     PIC XXX OCCURS 2.
  2595             20  PI-HIGH-SEQ-NO               PIC S9(4) COMP.
  2596             20  PI-CSR-SESSION-SW            PIC X.
  2597                 88  CSR-EDIT-SESSION           VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page  49
* EL6311.cbl
  2598             20  PI-ERRORS-SW                 PIC X.
  2599                 88  FATAL-ERRORS               VALUE 'X'.
  2600*                88  FATAL-OR-UNFORCED          VALUE 'X'.
  2601             20  FILLER                       PIC X(5).
  2602
  2603        16  FILLER             PIC X(94).
  2604
  2605 01  W-LETTER-COMMUNICATION-AREAS.
  2606*    COPY ELC1042.
  2607******************************************************************
  2608*                                                                *
  2609*                                                                *
  2610*                           ELC1042                              *
  2611*                            VMOD=2.002                          *
  2612*                                                                *
  2613*    NOTE                                                        *
  2614*        THE WORK AREA IS USED BY EL152, EL1522, EL1042, EL153,  *
  2615*        EM152, EM1522, EL689, EL6892, EL6311, AND EL690.        *
  2616*        THIS COPYBOOK SHOULD NOT BE CHANGED WITHOUT REFERENCE   *
  2617*        TO THESE PROGRAMS.                                      *
  2618*                                                                *
  2619*    NOTE                                                        *
  2620*        THE FILLER AREA AT THE BOTTOM ARE FOR FUTURE EL1042     *
  2621*        USE ONLY!                                               *
  2622*                                                                *
  2623******************************************************************
  2624
  2625         16  PI-1042-WA.
  2626             20  PI-ACTION       PIC  X(01).
  2627                 88 PI-SHOW-MODE           VALUE '1'.
  2628                 88 PI-CLEAR-MODE          VALUE '2'.
  2629                 88 PI-CREATE-MODE         VALUE '3'.
  2630             20  PI-COMM-CONTROL PIC  X(12).
  2631             20  PI-CURRENT-LINE PIC S9(03) COMP-3.
  2632             20  PI-EOF-SW       PIC  X(01).
  2633                 88  PI-FILE-EOF           VALUE 'Y'.
  2634             20  PI-FILETYP      PIC  X(01).
  2635             20  PI-FORM-SQUEEZE-CONTROL
  2636                                 PIC  X(01).
  2637                 88  PI-FORM-SQUEEZE-ON     VALUE 'Y'.
  2638                 88  PI-FORM-SQUEEZE-OFF    VALUE ' '.
  2639             20  PI-LAST-CONTROL PIC  X(12).
  2640             20  PI-TEMP-STOR-ITEMS
  2641                                 PIC S9(04) COMP.
  2642             20  PI-TOTAL-LINES  PIC S9(03) COMP-3.
  2643             20  PI-UPDATE-SW    PIC  9(01).
  2644                 88 ANY-UPDATES            VALUE 1.
  2645             20  PI-104-SCREEN-SENT-IND
  2646                                 PIC  X(01).
  2647                 88  PI-104-SCREEN-SENT    VALUE 'Y'.
  2648                 88  PI-104-SCREEN-NOT-SENT VALUE 'N'.
  2649             20  PI-1042-SCREEN-SENT-IND
  2650                                 PIC  X(01).
  2651                 88  PI-1042-SCREEN-SENT    VALUE 'Y'.
  2652                 88  PI-1042-SCREEN-NOT-SENT VALUE 'N'.
  2653             20  PI-1042-ARCHIVE-IND
  2654                                 PIC  X(01).
  2655                 88  PI-1042-ARCHIVE-LETTER VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page  50
* EL6311.cbl
  2656             20  FILLER          PIC  X(29).
  2657*    COPY ELC689PI.
  2658******************************************************************
  2659*                                                                *
  2660*                            ELC689PI                            *
  2661*                            VMOD=2.003                          *
  2662*                                                                *
  2663*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
  2664*    CREDIT CORRESPONDENCE SUB-SYSTEM.  ANY CHANGES WILL         *
  2665*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
  2666*                                                                *
  2667*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
  2668*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
  2669*    BETWEEN PROGRAMS.                                           *
  2670*                                                                *
  2671*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
  2672*                                                                *
  2673*               EL631 - EL689  - EL6891 - EL6892                 *
  2674*                                                                *
  2675******************************************************************
  2676*                   C H A N G E   L O G
  2677*
  2678* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2679*-----------------------------------------------------------------
  2680*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2681* EFFECTIVE    NUMBER
  2682*-----------------------------------------------------------------
  2683* 081004                   PEMA  CONVERT TO PSUEDO CONVERSATIONAL
  2684* 100705  CR2004072800004  PEMA  ADD LETTERS TO BE RESENT
  2685* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  2686******************************************************************
  2687
  2688
  2689         16  PI-689-WORK-AREA.
  2690             20  PI-689-ALT-PRINTER-ID
  2691                                 PIC  X(04).
  2692             20  PI-689-ARCHIVE-NUMBER
  2693                                 PIC  9(08).
  2694             20  PI-689-ARCHIVE-SW
  2695                                 PIC  X(01).
  2696                 88  PI-689-ARCHIVE-LETTER VALUE 'Y'.
  2697             20  PI-689-DATA-SOURCE
  2698                                 PIC  X(01).
  2699                 88  PI-689-SRC-ACCOUNT        VALUE '1'.
  2700                 88  PI-689-SRC-CERTIFICATE    VALUE '2'.
  2701                 88  PI-689-SRC-COMPENSATION   VALUE '3'.
  2702                 88  PI-689-SRC-PEND-BUSINESS  VALUE '4'.
  2703                 88  PI-689-SRC-CHECKS         VALUE '5'.
  2704             20  PI-689-ERROR-IND
  2705                                 PIC  X(01).
  2706                 88  PI-689-ERR-DETECTED-PREV  VALUE 'Y'.
  2707             20  PI-689-ERROR    PIC  9(04).
  2708                 88  PI-689-NO-ERRORS-DETECTED VALUE 0000.
  2709                 88  PI-689-FATAL-ERROR
  2710                     VALUES 0004 0006 0008 0013 0023 0029 0033
  2711                            0042 0047 0051 0066 0067 0070
  2712                            0168 0169 0174 0175 0176 0177 0179
  2713                            0180 0181 0182 0184 0185 0189 0190
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page  51
* EL6311.cbl
  2714                            0191
  2715                            0215 0279 0280
  2716                            0412 0413 0454
  2717                            0533 0537
  2718                            2055 2114 2208 2209 2216 2232 2369
  2719                            2398 2433 2908 2999
  2720                            3000 3770 3771 3775
  2721                            7250 7365 7367 7368 7369 7370 7371
  2722                            7272 7373 7374 7376 7377 7378 7379
  2723                            7381 7388 7390 7393 7395 7396 7398
  2724                            9095 9096 9281 9298 9299 9320 9327
  2725                            9426 9427.
  2726                 88  PI-689-STOP-ERROR
  2727                     VALUES 0004 0008 0013 0023 0029 0033
  2728                            0042 0047 0066 0067 0070
  2729                            0168 0169 0174 0175 0176 0177
  2730                            0181 0182 0184 0185 0189 0190
  2731                            0279 0280
  2732                            0412 0413 0454
  2733                            2055 2208 2209 2216 2232
  2734                            2398 2999
  2735                            3000 3770 3771 3775
  2736                            7250 7365 7369 7370 7371
  2737                            7272 7373 7374 7376 7377 7378 7379
  2738                            7381 7388 7390 7393 7396 7398
  2739                            9095 9096 9299 9320 9426.
  2740             20  PI-689-FOLLOW-UP-DATE
  2741                                 PIC  X(02).
  2742             20  PI-689-FORM-NUMBER
  2743                                 PIC  X(04).
  2744             20  PI-689-LABEL-SOURCE
  2745                                 PIC X(01).
  2746                 88  PI-689-SOURCE-ACCOUNT  VALUE '1'.
  2747                 88  PI-689-SOURCE-CARRIER  VALUE '2'.
  2748                 88  PI-689-SOURCE-COMPANY  VALUE '3'.
  2749                 88  PI-689-SOURCE-COMP     VALUE '4'.
  2750                 88  PI-689-SOURCE-MAIL     VALUE '5'.
  2751                 88  PI-689-SOURCE-CHECK    VALUE '6'.
  2752                 88  PI-689-SOURCE-VARIABLE VALUE '7'.
  2753             20  PI-689-NUMBER-COPIES
  2754                                 PIC  9(01).
  2755             20  PI-689-NUMBER-LABEL-LINES
  2756                                 PIC  9(01).
  2757             20  PI-689-NUMBER-TEXT-RECORDS
  2758                                 PIC  9(03).
  2759             20  PI-689-PRINT-ORDER-SW
  2760                                 PIC  X(01).
  2761                 88  PI-689-PRINT-FIRST     VALUE '1'.
  2762                 88  PI-689-PRINT-SECOND    VALUE '2'.
  2763                 88  PI-689-PRINT-LATER     VALUE '3'.
  2764                 88  PI-689-PRINT-ONLY      VALUE '4'.
  2765             20  PI-689-PRINT-RESTRICTION
  2766                                 PIC  X(01).
  2767                 88  PI-689-VALID-RESTRICT     VALUE 'C' 'F'.
  2768                 88  PI-689-PRT-ONLY-WITH-CNTL VALUE 'C'.
  2769                 88  PI-689-PRT-ONLY-WITH-FORM VALUE 'F'.
  2770             20  PI-689-PRINT-SW PIC  X(01).
  2771                 88  PI-689-PRINT-PERFORMED VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page  52
* EL6311.cbl
  2772             20  PI-689-RESEND-DATE-1
  2773                                 PIC  X(02).
  2774             20  PI-689-RESEND-LETR-1
  2775                                 PIC X(4).
  2776             20  PI-689-TEMP-STOR-ID
  2777                                 PIC  X(08).
  2778             20  PI-689-USE-SCREEN-IND
  2779                                 PIC  X(01).
  2780                 88  PI-689-CREATE-NO-SCREENS VALUE '1'.
  2781             20  PI-689-ARCH-POINTER
  2782                                 PIC S9(08) COMP.
  2783                 88  PI-689-GET-ARCH-MAIN     VALUE +0.
  2784             20  PI-689-ARCT-POINTER
  2785                                 PIC S9(08) COMP.
  2786                 88  PI-689-GET-ARCT-MAIN     VALUE +0.
  2787             20  PI-689-VARIABLE-DATA-GRP.
  2788                 24  PI-689-VARIABLE-DATA-1
  2789                                 PIC  X(30).
  2790                 24  PI-689-VARIABLE-DATA-2
  2791                                 PIC  X(30).
  2792                 24  PI-689-VARIABLE-DATA-3
  2793                                 PIC  X(30).
  2794                 24  PI-689-VARIABLE-DATA-4
  2795                                 PIC  X(30).
  2796
  2797         16  PI-689-KEY-DATA-FIELDS.
  2798             20  PI-689-ACCOUNT  PIC  X(10).
  2799             20  PI-689-CARRIER  PIC  X(01).
  2800             20  PI-689-CERT-NO.
  2801                 24  PI-689-CERT-PRIME
  2802                                 PIC  X(10).
  2803                 24  PI-689-CERT-SFX
  2804                                 PIC  X(01).
  2805             20  PI-689-CHG-SEQ-NO
  2806                                 PIC S9(04)    COMP.
  2807             20  PI-689-CHG-SEQ-NOX REDEFINES PI-689-CHG-SEQ-NO
  2808                                 PIC  X(02).
  2809             20  PI-689-ENTRY-BATCH
  2810                                 PIC  X(06).
  2811             20  PI-689-EFF-DATE PIC  X(02).
  2812             20  PI-689-EXP-DATE PIC  X(02).
  2813             20  PI-689-GROUPING PIC  X(06).
  2814             20  PI-689-RESP-PERSON
  2815                                 PIC  X(10).
  2816             20  PI-689-SEQ-NO   PIC S9(08)    COMP.
  2817             20  PI-689-SEQ-NOX REDEFINES PI-689-SEQ-NO
  2818                                 PIC  X(04).
  2819             20  PI-689-STATE    PIC  X(02).
  2820             20  PI-689-TYPE     PIC  X(01).
  2821             20  PI-689-CONTROL  PIC S9(08)    COMP.
  2822             20  PI-689-ALT-SEQ-NO
  2823                                 PIC S9(04)    COMP.
  2824         16  PI-689-DATE-EDIT    PIC  X(08).
  2825         16  PI-689-FOLLOW-UP-EDIT
  2826                                 PIC  X(08).
  2827         16  PI-689-RESEND1-EDIT PIC  X(08).
  2828         16  PI-689-SEQ-EDIT     PIC  X(08).
  2829         16  PI-689-BCSEQ-EDIT   PIC  X(04).
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page  53
* EL6311.cbl
  2830         16  PI-689-LBL-OVERRIDE PIC  X(01).
  2831             88  PI-689-LABELS-OVERRIDEN  VALUES 'N'.
  2832         16  PI-689-FATAL-CTR    PIC 999     COMP-3.
  2833         16  PI-689-FORCABLE-CTR PIC 999     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page  54
* EL6311.cbl
  2835
  2836 01  WS-EL6315-PASS-AREA.
  2837        16  PI-6315-ISS-CAN-SW      PIC X.
  2838        16  FILLER                  PIC X(120).
  2839        16  PI-RES-REF-CLM-TYPE     PIC X.
  2840        16  FILLER                  PIC X.
  2841        16  PI-6315-PASS-AREA.
  2842            20 FILLER               PIC X(236).
  2843            20 PI-6315-FINALIZED    PIC X.
  2844            20 FILLER               PIC X(280).
  2845
  2846 01  WS-EL6316-PASS-AREA.
  2847        16  PI-ISS-CAN-SW           PIC X.
  2848        16  FILLER                  PIC X(121).
  2849        16  PI-CLM-RESC-IND         PIC X.
  2850        16  PI-6316-PASS-AREA.
  2851            20 FILLER               PIC X(236).
  2852            20 PI-6316-FINALIZED    PIC X.
  2853            20 FILLER               PIC X(280).
  2854
  2855******************************************************************
  2856*                                                                *
  2857*         P A S S   A R E A   F O R   E D I T                    *
  2858*                                                                *
  2859******************************************************************
  2860
  2861 01  PASSED-RECORD.
  2862     12  RECORD-SAVE                  PIC X(585).
  2863* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
  2864*    COPY ELC50W1 REPLACING WK-CANCEL-EXIT-DT
  2865*                    BY  WK-CURRENT-DATE.
  2866******************************************************************
  2867*                                                                *
  2868*                                                                *
  2869*                             ELC50W1                            *
  2870*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2871*                            VMOD=2.004                          *
  2872*                                                                *
  2873*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *
  2874*                                                                *
  2875*                                                                *
  2876******************************************************************
  2877
  2878     12  WK-WORK-AREA.
  2879         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.
  2880         16  WK-LAST-CARRIER          PIC X   VALUE ' '.
  2881         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.
  2882         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.
  2883         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.
  2884         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.
  2885         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.
  2886         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.
  2887         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.
  2888         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.
  2889         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.
  2890         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.
  2891         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.
  2892         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page  55
* EL6311.cbl
  2893         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE.
  2894         16  WK-CREDIT-EDIT-CONTROLS.
  2895             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.
  2896             20  WK-MIN-AGE           PIC 99  VALUE 00.
  2897             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.
  2898             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  2899             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  2900             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.
  2901         16  WK-CURRENT-DATE        PIC XX VALUE LOW-VALUE.
  2902         16  WK-SAVE-REIN-DATA.
  2903             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.
  2904             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.
  2905             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.
  2906         16  WK-ENTRY-SW              PIC X    VALUE ' '.
  2907             88  ENTRY-FROM-EL6311       VALUE '6'.
  2908         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.
  2909         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.
  2910     12  WK-RECORD-ADDRESSES.
  2911         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS.
  2912         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS.
  2913         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS.
  2914         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS.
  2915         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS.
  2916         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS.
  2917         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS.
  2918         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS.
  2919     12  WK-OVER-SHORT-AREA.
  2920         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.
  2921         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.
  2922         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  2923             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  2924         16  FILLER                   PIC X(5) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page  56
* EL6311.cbl
  2926
  2927*    COPY ELCEDITC.
  2928******************************************************************
  2929*                                                                *
  2930*                                                                *
  2931*                            ELCEDITC                            *
  2932*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2933*                            VMOD=2.012                          *
  2934*                                                                *
  2935*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *
  2936*                     EL6313, EL050 AND EL517.                   *
  2937*                                                                *
  2938******************************************************************
  2939******************************************************************
  2940*                   C H A N G E   L O G
  2941*
  2942* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2943*-----------------------------------------------------------------
  2944*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2945* EFFECTIVE    NUMBER
  2946*-----------------------------------------------------------------
  2947* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2948******************************************************************
  2949
  2950     12  EDIT-CRITERIA-DATA.
  2951         16  EC-CO-MONTH-END-DT       PIC XX.
  2952         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.
  2953         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  2954         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.
  2955         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  2956         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.
  2957         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.
  2958         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.
  2959         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.
  2960         16  EC-CO-REM-TERM-CALC      PIC X.
  2961               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.
  2962               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.
  2963               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.
  2964               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.
  2965
  2966         16  EC-BR-LF-EARNINGS-CALC    PIC X.
  2967               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.
  2968               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.
  2969               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.
  2970               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.
  2971               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.
  2972               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.
  2973               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.
  2974               88  EC-BR-LF-EARN-MEAN               VALUE '8'.
  2975               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.
  2976               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.
  2977
  2978         16  EC-BR-AH-EARNINGS-CALC    PIC X.
  2979               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.
  2980               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.
  2981               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.
  2982               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.
  2983               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page  57
* EL6311.cbl
  2984               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.
  2985               88  EC-BR-AH-EARN-MEAN               VALUE '8'.
  2986               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.
  2987
  2988         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.
  2989                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.
  2990                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.
  2991
  2992         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.
  2993                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.
  2994                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.
  2995                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.
  2996                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.
  2997                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.
  2998                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.
  2999                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.
  3000                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.
  3001
  3002         16  EC-BR-LF-COVERAGE-TYPE    PIC X.
  3003               88  EC-BR-REDUCING                   VALUE 'R'.
  3004               88  EC-BR-LEVEL                      VALUE 'L' 'P'.
  3005
  3006         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).
  3007         16  EC-BR-LF-DESC             PIC X(10).
  3008         16  EC-BR-AH-DESC             PIC X(10).
  3009         16  EC-BR-LF-COMMENT          PIC X(10).
  3010         16  EC-BR-AH-COMMENT          PIC X(10).
  3011
  3012         16  EC-BR-LF-REM-TERM-CALC    PIC X.
  3013               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.
  3014               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.
  3015               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.
  3016               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.
  3017
  3018         16  EC-BR-AH-REM-TERM-CALC    PIC X.
  3019               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.
  3020               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.
  3021               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.
  3022               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.
  3023
  3024         16  EC-BR-LF-REFUND-CALC      PIC X.
  3025                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.
  3026                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.
  3027                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.
  3028                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.
  3029                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.
  3030                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.
  3031                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  3032
  3033         16  EC-BR-AH-REFUND-CALC      PIC X.
  3034                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.
  3035                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.
  3036                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.
  3037                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.
  3038                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.
  3039                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.
  3040                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.
  3041                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page  58
* EL6311.cbl
  3042
  3043         16  EC-BR-LF-BEN-I-G-CD       PIC X.
  3044                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.
  3045                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.
  3046                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.
  3047
  3048         16  EC-BR-AH-BEN-I-G-CD       PIC X.
  3049                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.
  3050                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.
  3051                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.
  3052
  3053         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.
  3054         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.
  3055         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  3056         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  3057
  3058         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.
  3059         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.
  3060                 88  EC-ST-EXT-NO-CHG               VALUE ' '.
  3061                 88  EC-ST-EXT-CHG-LF               VALUE '1'.
  3062                 88  EC-ST-EXT-CHG-AH               VALUE '2'.
  3063                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.
  3064
  3065         16  EC-ST-LF-REM-TERM-CALC    PIC X.
  3066               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.
  3067               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.
  3068               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.
  3069               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.
  3070               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.
  3071
  3072         16  EC-ST-AH-REM-TERM-CALC    PIC X.
  3073               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.
  3074               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.
  3075               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.
  3076               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.
  3077               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.
  3078
  3079         16  EC-ST-LF-REFUND-CALC      PIC X.
  3080                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.
  3081                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.
  3082                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.
  3083                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.
  3084                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.
  3085                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.
  3086                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.
  3087                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  3088
  3089         16  EC-ST-AH-REFUND-CALC      PIC X.
  3090                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.
  3091                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.
  3092                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.
  3093                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.
  3094                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.
  3095                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.
  3096                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.
  3097                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  3098
  3099         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page  59
* EL6311.cbl
  3100         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.
  3101         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.
  3102         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.
  3103         16  EC-AM-EXPIRATION-DT       PIC XX.
  3104         16  EC-AM-EFFECTIVE-DT        PIC XX.
  3105         16  EC-AM-CLASS-CD            PIC XX.
  3106         16  EC-AM-LF-DEVIATION        PIC XXX.
  3107         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  3108         16  EC-AM-AH-DEVIATION        PIC XXX.
  3109         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  3110         16  EC-AM-PHONE-NO            PIC X(10).
  3111
  3112         16  EC-AM-LF-REFUND-CALC      PIC X.
  3113                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.
  3114                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.
  3115                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.
  3116                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.
  3117                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.
  3118                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.
  3119                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  3120
  3121         16  EC-AM-AH-REFUND-CALC      PIC X.
  3122                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.
  3123                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.
  3124                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.
  3125                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.
  3126                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.
  3127                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.
  3128                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  3129
  3130         16  EC-AM-BEN-I-G-CD          PIC X.
  3131                 88  WK-AM-I-G-NOT-USED             VALUE ' '.
  3132                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.
  3133                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.
  3134
  3135         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3136         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.
  3137         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.
  3138         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3139         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3140         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.
  3141         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.
  3142         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  3143         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3144
  3145         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3146         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.
  3147         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.
  3148         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3149         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3150         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.
  3151         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.
  3152         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  3153         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3154         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.
  3155         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.
  3156         16  EC-RT-LF-NSP-ST           PIC XX.
  3157         16  EC-RT-AH-NSP-ST           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page  60
* EL6311.cbl
  3158         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  3159         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  3160
  3161         16  EC-CM-LF-PRIOR-STATUS     PIC X.
  3162             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  3163                                             'M' '5' '9' '2'.
  3164             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.
  3165             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.
  3166             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.
  3167             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.
  3168             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.
  3169             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.
  3170             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.
  3171             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.
  3172             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.
  3173             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.
  3174
  3175         16  EC-CM-AH-PRIOR-STATUS     PIC X.
  3176             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  3177                                             'M' '5' '9' '2'.
  3178             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.
  3179             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.
  3180             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.
  3181             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.
  3182             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.
  3183             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.
  3184             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.
  3185             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.
  3186             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.
  3187             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.
  3188
  3189         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  3190         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  3191         16  EC-CM-LF-CANCEL-DT        PIC XX.
  3192         16  EC-CM-AH-CANCEL-DT        PIC XX.
  3193         16  EC-CM-DEATH-DT            PIC XX.
  3194
  3195*DMD CUSTOM CODING FIELDS BELOW
  3196*POPULATED BY CF-RATING-SWITCH AT EL050 TIME
  3197         16  EC-BR-DMD-RATING-SW       PIC X.
  3198                 88  EC-DMD-AH-RATING            VALUE 'Y'.
  3199                 88  EC-DMD-LF-RATING            VALUE 'Y'.
  3200                 88  NO-DMD-RATING               VALUE 'N'.
  3201
  3202         16  EC-NEW-CERT               PIC X(11).
  3203         16  EC-NEW-STATE              PIC XX.
  3204         16  FILLER                    PIC X.
  3205*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.
  3206         16  OVER-SHORT-EDIT-FIELDS.
  3207             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.
  3208             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  3209             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.
  3210             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  3211             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.
  3212             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.
  3213             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  3214             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.
  3215             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page  61
* EL6311.cbl
  3216         16  FILLER                    PIC X(71).
  3217
  3218******************************************************************
  3219
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page  62
* EL6311.cbl
  3221
  3222*    COPY ELCJPFX.
  3223******************************************************************
  3224*                                                                *
  3225*                                                                *
  3226*                            ELCJPFX.                            *
  3227*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3228*                            VMOD=2.002                          *
  3229*                                                                *
  3230*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  3231*                                                                *
  3232*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  3233*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  3234*        ELCNTL - CONTROL FILE                                   *
  3235*        ELMSTR - CLAIM MASTERS                                  *
  3236*        ELTRLR - ACTIVITY TRAILERS                              *
  3237*        ELCHKQ - CHECK QUE                                      *
  3238******************************************************************
  3239 01  JOURNAL-RECORD.
  3240     12  JP-USER-ID                  PIC X(4).
  3241     12  JP-FILE-ID                  PIC X(8).
  3242     12  JP-PROGRAM-ID               PIC X(8).
  3243     12  JP-RECORD-TYPE              PIC X.
  3244         88 JP-ADD              VALUE 'A'.
  3245         88 JP-BEFORE-CHANGE    VALUE 'B'.
  3246         88 JP-AFTER-CHANGE     VALUE 'C'.
  3247         88 JP-DELETE           VALUE 'D'.
  3248         88 JP-GENERIC-DELETE   VALUE 'G'.
  3249         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  3250         88 JP-KEY-CHG-ADD      VALUE 'N'.
  3251     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  3252     12  JP-RECORD-AREA
  3253
  3254
  3255                             PIC X(608).
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page  63
* EL6311.cbl
  3257*    COPY ELCAID.
  3258******************************************************************
  3259*                                                                *
  3260*                            ELCAID.                             *
  3261*                            VMOD=2.001                          *
  3262*                                                                *
  3263*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  3264*                                                                *
  3265*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  3266*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  3267******************************************************************
  3268
  3269 01  DFHAID.
  3270   02  DFHNULL   PIC  X  VALUE  ' '.
  3271   02  DFHENTER  PIC  X  VALUE  QUOTE.
  3272   02  DFHCLEAR  PIC  X  VALUE  '_'.
  3273   02  DFHPEN    PIC  X  VALUE  '='.
  3274   02  DFHOPID   PIC  X  VALUE  'W'.
  3275   02  DFHPA1    PIC  X  VALUE  '%'.
  3276   02  DFHPA2    PIC  X  VALUE  '>'.
  3277   02  DFHPA3    PIC  X  VALUE  ','.
  3278   02  DFHPF1    PIC  X  VALUE  '1'.
  3279   02  DFHPF2    PIC  X  VALUE  '2'.
  3280   02  DFHPF3    PIC  X  VALUE  '3'.
  3281   02  DFHPF4    PIC  X  VALUE  '4'.
  3282   02  DFHPF5    PIC  X  VALUE  '5'.
  3283   02  DFHPF6    PIC  X  VALUE  '6'.
  3284   02  DFHPF7    PIC  X  VALUE  '7'.
  3285   02  DFHPF8    PIC  X  VALUE  '8'.
  3286   02  DFHPF9    PIC  X  VALUE  '9'.
  3287   02  DFHPF10   PIC  X  VALUE  ':'.
  3288   02  DFHPF11   PIC  X  VALUE  '#'.
  3289   02  DFHPF12   PIC  X  VALUE  '@'.
  3290   02  DFHPF13   PIC  X  VALUE  'A'.
  3291   02  DFHPF14   PIC  X  VALUE  'B'.
  3292   02  DFHPF15   PIC  X  VALUE  'C'.
  3293   02  DFHPF16   PIC  X  VALUE  'D'.
  3294   02  DFHPF17   PIC  X  VALUE  'E'.
  3295   02  DFHPF18   PIC  X  VALUE  'F'.
  3296   02  DFHPF19   PIC  X  VALUE  'G'.
  3297   02  DFHPF20   PIC  X  VALUE  'H'.
  3298   02  DFHPF21   PIC  X  VALUE  'I'.
  3299*00039    02  DFHPF22   PIC  X  VALUE  ''.
  3300   02  DFHPF22   PIC  X  VALUE  '['.
  3301   02  DFHPF23   PIC  X  VALUE  '.'.
  3302   02  DFHPF24   PIC  X  VALUE  '<'.
  3303   02  DFHMSRE   PIC  X  VALUE  'X'.
  3304   02  DFHSTRF   PIC  X  VALUE  'h'.
  3305   02  DFHTRIG   PIC  X  VALUE  '"'.
  3306
  3307 01  FILLER    REDEFINES DFHAID.
  3308     12  FILLER              PIC X(8).
  3309     12  PF-VALUES           PIC X       OCCURS 24 TIMES.
  3310
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page  64
* EL6311.cbl
  3312*    COPY EL6311S.
  3313 01  EL631BI.
  3314     05  FILLER            PIC  X(0012).
  3315*    -------------------------------
  3316     05  BDATEL PIC S9(0004) COMP.
  3317     05  BDATEF PIC  X(0001).
  3318     05  FILLER REDEFINES BDATEF.
  3319         10  BDATEA PIC  X(0001).
  3320     05  BDATEI PIC  X(0008).
  3321*    -------------------------------
  3322     05  BTIMEL PIC S9(0004) COMP.
  3323     05  BTIMEF PIC  X(0001).
  3324     05  FILLER REDEFINES BTIMEF.
  3325         10  BTIMEA PIC  X(0001).
  3326     05  BTIMEI PIC  X(0005).
  3327*    -------------------------------
  3328     05  BHEADL PIC S9(0004) COMP.
  3329     05  BHEADF PIC  X(0001).
  3330     05  FILLER REDEFINES BHEADF.
  3331         10  BHEADA PIC  X(0001).
  3332     05  BHEADI PIC  X(0038).
  3333*    -------------------------------
  3334     05  BNCERTLL PIC S9(0004) COMP.
  3335     05  BNCERTLF PIC  X(0001).
  3336     05  FILLER REDEFINES BNCERTLF.
  3337         10  BNCERTLA PIC  X(0001).
  3338     05  BNCERTLI PIC  X(0008).
  3339*    -------------------------------
  3340     05  BNCERTL PIC S9(0004) COMP.
  3341     05  BNCERTF PIC  X(0001).
  3342     05  FILLER REDEFINES BNCERTF.
  3343         10  BNCERTA PIC  X(0001).
  3344     05  BNCERTI PIC  X(0011).
  3345*    -------------------------------
  3346     05  BNSTATLL PIC S9(0004) COMP.
  3347     05  BNSTATLF PIC  X(0001).
  3348     05  FILLER REDEFINES BNSTATLF.
  3349         10  BNSTATLA PIC  X(0001).
  3350     05  BNSTATLI PIC  X(0009).
  3351*    -------------------------------
  3352     05  BNSTATL PIC S9(0004) COMP.
  3353     05  BNSTATF PIC  X(0001).
  3354     05  FILLER REDEFINES BNSTATF.
  3355         10  BNSTATA PIC  X(0001).
  3356     05  BNSTATI PIC  X(0002).
  3357*    -------------------------------
  3358     05  BCHGTL PIC S9(0004) COMP.
  3359     05  BCHGTF PIC  X(0001).
  3360     05  FILLER REDEFINES BCHGTF.
  3361         10  BCHGTA PIC  X(0001).
  3362     05  BCHGTI PIC  X(0004).
  3363*    -------------------------------
  3364     05  BCHGL PIC S9(0004) COMP.
  3365     05  BCHGF PIC  X(0001).
  3366     05  FILLER REDEFINES BCHGF.
  3367         10  BCHGA PIC  X(0001).
  3368     05  BCHGI PIC  X(0004).
  3369*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page  65
* EL6311.cbl
  3370     05  BMAINTL PIC S9(0004) COMP.
  3371     05  BMAINTF PIC  X(0001).
  3372     05  FILLER REDEFINES BMAINTF.
  3373         10  BMAINTA PIC  X(0001).
  3374     05  BMAINTI PIC  X(0001).
  3375*    -------------------------------
  3376     05  BMANTBYL PIC S9(0004) COMP.
  3377     05  BMANTBYF PIC  X(0001).
  3378     05  FILLER REDEFINES BMANTBYF.
  3379         10  BMANTBYA PIC  X(0001).
  3380     05  BMANTBYI PIC  X(0004).
  3381*    -------------------------------
  3382     05  BCHGHDGL PIC S9(0004) COMP.
  3383     05  BCHGHDGF PIC  X(0001).
  3384     05  FILLER REDEFINES BCHGHDGF.
  3385         10  BCHGHDGA PIC  X(0001).
  3386     05  BCHGHDGI PIC  X(0003).
  3387*    -------------------------------
  3388     05  BMANTDTL PIC S9(0004) COMP.
  3389     05  BMANTDTF PIC  X(0001).
  3390     05  FILLER REDEFINES BMANTDTF.
  3391         10  BMANTDTA PIC  X(0001).
  3392     05  BMANTDTI PIC  X(0008).
  3393*    -------------------------------
  3394     05  BMANTATL PIC S9(0004) COMP.
  3395     05  BMANTATF PIC  X(0001).
  3396     05  FILLER REDEFINES BMANTATF.
  3397         10  BMANTATA PIC  X(0001).
  3398     05  BMANTATI PIC  X(0005).
  3399*    -------------------------------
  3400     05  BCSRL PIC S9(0004) COMP.
  3401     05  BCSRF PIC  X(0001).
  3402     05  FILLER REDEFINES BCSRF.
  3403         10  BCSRA PIC  X(0001).
  3404     05  BCSRI PIC  X(0004).
  3405*    -------------------------------
  3406     05  BBATCHL PIC S9(0004) COMP.
  3407     05  BBATCHF PIC  X(0001).
  3408     05  FILLER REDEFINES BBATCHF.
  3409         10  BBATCHA PIC  X(0001).
  3410     05  BBATCHI PIC  X(0006).
  3411*    -------------------------------
  3412     05  BSEQL PIC S9(0004) COMP.
  3413     05  BSEQF PIC  X(0001).
  3414     05  FILLER REDEFINES BSEQF.
  3415         10  BSEQA PIC  X(0001).
  3416     05  BSEQI PIC  X(0004).
  3417*    -------------------------------
  3418     05  BMOENDTL PIC S9(0004) COMP.
  3419     05  BMOENDTF PIC  X(0001).
  3420     05  FILLER REDEFINES BMOENDTF.
  3421         10  BMOENDTA PIC  X(0001).
  3422     05  BMOENDTI PIC  X(0008).
  3423*    -------------------------------
  3424     05  BCARRL PIC S9(0004) COMP.
  3425     05  BCARRF PIC  X(0001).
  3426     05  FILLER REDEFINES BCARRF.
  3427         10  BCARRA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page  66
* EL6311.cbl
  3428     05  BCARRI PIC  X(0001).
  3429*    -------------------------------
  3430     05  BGROUPL PIC S9(0004) COMP.
  3431     05  BGROUPF PIC  X(0001).
  3432     05  FILLER REDEFINES BGROUPF.
  3433         10  BGROUPA PIC  X(0001).
  3434     05  BGROUPI PIC  X(0006).
  3435*    -------------------------------
  3436     05  BSTATEL PIC S9(0004) COMP.
  3437     05  BSTATEF PIC  X(0001).
  3438     05  FILLER REDEFINES BSTATEF.
  3439         10  BSTATEA PIC  X(0001).
  3440     05  BSTATEI PIC  X(0002).
  3441*    -------------------------------
  3442     05  BACCTL PIC S9(0004) COMP.
  3443     05  BACCTF PIC  X(0001).
  3444     05  FILLER REDEFINES BACCTF.
  3445         10  BACCTA PIC  X(0001).
  3446     05  BACCTI PIC  X(0010).
  3447*    -------------------------------
  3448     05  BVINHL PIC S9(0004) COMP.
  3449     05  BVINHF PIC  X(0001).
  3450     05  FILLER REDEFINES BVINHF.
  3451         10  BVINHA PIC  X(0001).
  3452     05  BVINHI PIC  X(0004).
  3453*    -------------------------------
  3454     05  BVINL PIC S9(0004) COMP.
  3455     05  BVINF PIC  X(0001).
  3456     05  FILLER REDEFINES BVINF.
  3457         10  BVINA PIC  X(0001).
  3458     05  BVINI PIC  X(0017).
  3459*    -------------------------------
  3460     05  BREFHDGL PIC S9(0004) COMP.
  3461     05  BREFHDGF PIC  X(0001).
  3462     05  FILLER REDEFINES BREFHDGF.
  3463         10  BREFHDGA PIC  X(0001).
  3464     05  BREFHDGI PIC  X(0004).
  3465*    -------------------------------
  3466     05  BREFL PIC S9(0004) COMP.
  3467     05  BREFF PIC  X(0001).
  3468     05  FILLER REDEFINES BREFF.
  3469         10  BREFA PIC  X(0001).
  3470     05  BREFI PIC  X(0012).
  3471*    -------------------------------
  3472     05  BAGEDEFL PIC S9(0004) COMP.
  3473     05  BAGEDEFF PIC  X(0001).
  3474     05  FILLER REDEFINES BAGEDEFF.
  3475         10  BAGEDEFA PIC  X(0001).
  3476     05  BAGEDEFI PIC  X(0004).
  3477*    -------------------------------
  3478     05  BCERTNOL PIC S9(0004) COMP.
  3479     05  BCERTNOF PIC  X(0001).
  3480     05  FILLER REDEFINES BCERTNOF.
  3481         10  BCERTNOA PIC  X(0001).
  3482     05  BCERTNOI PIC  X(0010).
  3483*    -------------------------------
  3484     05  BSUFIXL PIC S9(0004) COMP.
  3485     05  BSUFIXF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page  67
* EL6311.cbl
  3486     05  FILLER REDEFINES BSUFIXF.
  3487         10  BSUFIXA PIC  X(0001).
  3488     05  BSUFIXI PIC  X(0001).
  3489*    -------------------------------
  3490     05  BEFFDTL PIC S9(0004) COMP.
  3491     05  BEFFDTF PIC  X(0001).
  3492     05  FILLER REDEFINES BEFFDTF.
  3493         10  BEFFDTA PIC  X(0001).
  3494     05  BEFFDTI PIC  X(0008).
  3495*    -------------------------------
  3496     05  BLSTNML PIC S9(0004) COMP.
  3497     05  BLSTNMF PIC  X(0001).
  3498     05  FILLER REDEFINES BLSTNMF.
  3499         10  BLSTNMA PIC  X(0001).
  3500     05  BLSTNMI PIC  X(0015).
  3501*    -------------------------------
  3502     05  B1STNML PIC S9(0004) COMP.
  3503     05  B1STNMF PIC  X(0001).
  3504     05  FILLER REDEFINES B1STNMF.
  3505         10  B1STNMA PIC  X(0001).
  3506     05  B1STNMI PIC  X(0010).
  3507*    -------------------------------
  3508     05  BINITL PIC S9(0004) COMP.
  3509     05  BINITF PIC  X(0001).
  3510     05  FILLER REDEFINES BINITF.
  3511         10  BINITA PIC  X(0001).
  3512     05  BINITI PIC  X(0001).
  3513*    -------------------------------
  3514     05  BSEXL PIC S9(0004) COMP.
  3515     05  BSEXF PIC  X(0001).
  3516     05  FILLER REDEFINES BSEXF.
  3517         10  BSEXA PIC  X(0001).
  3518     05  BSEXI PIC  X(0001).
  3519*    -------------------------------
  3520     05  BAGEL PIC S9(0004) COMP.
  3521     05  BAGEF PIC  X(0001).
  3522     05  FILLER REDEFINES BAGEF.
  3523         10  BAGEA PIC  X(0001).
  3524     05  BAGEI PIC  X(0002).
  3525*    -------------------------------
  3526     05  BBIRTHL PIC S9(0004) COMP.
  3527     05  BBIRTHF PIC  X(0001).
  3528     05  FILLER REDEFINES BBIRTHF.
  3529         10  BBIRTHA PIC  X(0001).
  3530     05  BBIRTHI PIC  X(0008).
  3531*    -------------------------------
  3532     05  B1STPMTL PIC S9(0004) COMP.
  3533     05  B1STPMTF PIC  X(0001).
  3534     05  FILLER REDEFINES B1STPMTF.
  3535         10  B1STPMTA PIC  X(0001).
  3536     05  B1STPMTI PIC  X(0008).
  3537*    -------------------------------
  3538     05  BDAYSL PIC S9(0004) COMP.
  3539     05  BDAYSF PIC  X(0001).
  3540     05  FILLER REDEFINES BDAYSF.
  3541         10  BDAYSA PIC  X(0001).
  3542     05  BDAYSI PIC  X(0003).
  3543*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page  68
* EL6311.cbl
  3544     05  BLNTRML PIC S9(0004) COMP.
  3545     05  BLNTRMF PIC  X(0001).
  3546     05  FILLER REDEFINES BLNTRMF.
  3547         10  BLNTRMA PIC  X(0001).
  3548     05  BLNTRMI PIC  X(0003).
  3549*    -------------------------------
  3550     05  BLNOFCRL PIC S9(0004) COMP.
  3551     05  BLNOFCRF PIC  X(0001).
  3552     05  FILLER REDEFINES BLNOFCRF.
  3553         10  BLNOFCRA PIC  X(0001).
  3554     05  BLNOFCRI PIC  X(0005).
  3555*    -------------------------------
  3556     05  BMODEL PIC S9(0004) COMP.
  3557     05  BMODEF PIC  X(0001).
  3558     05  FILLER REDEFINES BMODEF.
  3559         10  BMODEA PIC  X(0001).
  3560     05  BMODEI PIC  X(0001).
  3561*    -------------------------------
  3562     05  BFREQL PIC S9(0004) COMP.
  3563     05  BFREQF PIC  X(0001).
  3564     05  FILLER REDEFINES BFREQF.
  3565         10  BFREQA PIC  X(0001).
  3566     05  BFREQI PIC  X(0002).
  3567*    -------------------------------
  3568     05  BPMTSL PIC S9(0004) COMP.
  3569     05  BPMTSF PIC  X(0001).
  3570     05  FILLER REDEFINES BPMTSF.
  3571         10  BPMTSA PIC  X(0001).
  3572     05  BPMTSI PIC  999.
  3573*    -------------------------------
  3574     05  BPMTAMTL PIC S9(0004) COMP.
  3575     05  BPMTAMTF PIC  X(0001).
  3576     05  FILLER REDEFINES BPMTAMTF.
  3577         10  BPMTAMTA PIC  X(0001).
  3578     05  BPMTAMTI PIC  9(7)V99.
  3579*    -------------------------------
  3580     05  BAPRL PIC S9(0004) COMP.
  3581     05  BAPRF PIC  X(0001).
  3582     05  FILLER REDEFINES BAPRF.
  3583         10  BAPRA PIC  X(0001).
  3584     05  BAPRI PIC  X(7).
  3585*    -------------------------------
  3586     05  BLIVESL PIC S9(0004) COMP.
  3587     05  BLIVESF PIC  X(0001).
  3588     05  FILLER REDEFINES BLIVESF.
  3589         10  BLIVESA PIC  X(0001).
  3590     05  BLIVESI PIC  X(0009).
  3591*    -------------------------------
  3592     05  BMEMCAPL PIC S9(0004) COMP.
  3593     05  BMEMCAPF PIC  X(0001).
  3594     05  FILLER REDEFINES BMEMCAPF.
  3595         10  BMEMCAPA PIC  X(0001).
  3596     05  BMEMCAPI PIC  X(0011).
  3597*    -------------------------------
  3598     05  BORIGHDL PIC S9(0004) COMP.
  3599     05  BORIGHDF PIC  X(0001).
  3600     05  FILLER REDEFINES BORIGHDF.
  3601         10  BORIGHDA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page  69
* EL6311.cbl
  3602     05  BORIGHDI PIC  X(0009).
  3603*    -------------------------------
  3604     05  DMDBILL PIC S9(0004) COMP.
  3605     05  DMDBILF PIC  X(0001).
  3606     05  FILLER REDEFINES DMDBILF.
  3607         10  DMDBILA PIC  X(0001).
  3608     05  DMDBILI PIC  X(0006).
  3609*    -------------------------------
  3610     05  BFORCEL PIC S9(0004) COMP.
  3611     05  BFORCEF PIC  X(0001).
  3612     05  FILLER REDEFINES BFORCEF.
  3613         10  BFORCEA PIC  X(0001).
  3614     05  BFORCEI PIC  X(0001).
  3615*    -------------------------------
  3616     05  BENTRYL PIC S9(0004) COMP.
  3617     05  BENTRYF PIC  X(0001).
  3618     05  FILLER REDEFINES BENTRYF.
  3619         10  BENTRYA PIC  X(0001).
  3620     05  BENTRYI PIC  X(0001).
  3621*    -------------------------------
  3622     05  BREINL PIC S9(0004) COMP.
  3623     05  BREINF PIC  X(0001).
  3624     05  FILLER REDEFINES BREINF.
  3625         10  BREINA PIC  X(0001).
  3626     05  BREINI PIC  X(0001).
  3627*    -------------------------------
  3628     05  BBILCDL PIC S9(0004) COMP.
  3629     05  BBILCDF PIC  X(0001).
  3630     05  FILLER REDEFINES BBILCDF.
  3631         10  BBILCDA PIC  X(0001).
  3632     05  BBILCDI PIC  X(0001).
  3633*    -------------------------------
  3634     05  BUNWRITL PIC S9(0004) COMP.
  3635     05  BUNWRITF PIC  X(0001).
  3636     05  FILLER REDEFINES BUNWRITF.
  3637         10  BUNWRITA PIC  X(0001).
  3638     05  BUNWRITI PIC  X(0001).
  3639*    -------------------------------
  3640     05  BSKPCDL PIC S9(0004) COMP.
  3641     05  BSKPCDF PIC  X(0001).
  3642     05  FILLER REDEFINES BSKPCDF.
  3643         10  BSKPCDA PIC  X(0001).
  3644     05  BSKPCDI PIC  X(0001).
  3645*    -------------------------------
  3646     05  BINDGRPL PIC S9(0004) COMP.
  3647     05  BINDGRPF PIC  X(0001).
  3648     05  FILLER REDEFINES BINDGRPF.
  3649         10  BINDGRPA PIC  X(0001).
  3650     05  BINDGRPI PIC  X(0001).
  3651*    -------------------------------
  3652     05  BSIGL PIC S9(0004) COMP.
  3653     05  BSIGF PIC  X(0001).
  3654     05  FILLER REDEFINES BSIGF.
  3655         10  BSIGA PIC  X(0001).
  3656     05  BSIGI PIC  X(0001).
  3657*    -------------------------------
  3658     05  BRTCLSL PIC S9(0004) COMP.
  3659     05  BRTCLSF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page  70
* EL6311.cbl
  3660     05  FILLER REDEFINES BRTCLSF.
  3661         10  BRTCLSA PIC  X(0001).
  3662     05  BRTCLSI PIC  X(0002).
  3663*    -------------------------------
  3664     05  BCHGCNTL PIC S9(0004) COMP.
  3665     05  BCHGCNTF PIC  X(0001).
  3666     05  FILLER REDEFINES BCHGCNTF.
  3667         10  BCHGCNTA PIC  X(0001).
  3668     05  BCHGCNTI PIC  X(0003).
  3669*    -------------------------------
  3670     05  BMEMBERL PIC S9(0004) COMP.
  3671     05  BMEMBERF PIC  X(0001).
  3672     05  FILLER REDEFINES BMEMBERF.
  3673         10  BMEMBERA PIC  X(0001).
  3674     05  BMEMBERI PIC  X(0012).
  3675*    -------------------------------
  3676     05  BORGNOL PIC S9(0004) COMP.
  3677     05  BORGNOF PIC  X(0001).
  3678     05  FILLER REDEFINES BORGNOF.
  3679         10  BORGNOA PIC  X(0001).
  3680     05  BORGNOI PIC  X(0006).
  3681*    -------------------------------
  3682     05  BORGSEQL PIC S9(0004) COMP.
  3683     05  BORGSEQF PIC  X(0001).
  3684     05  FILLER REDEFINES BORGSEQF.
  3685         10  BORGSEQA PIC  X(0001).
  3686     05  BORGSEQI PIC  X(0004).
  3687*    -------------------------------
  3688     05  BBILLEDL PIC S9(0004) COMP.
  3689     05  BBILLEDF PIC  X(0001).
  3690     05  FILLER REDEFINES BBILLEDF.
  3691         10  BBILLEDA PIC  X(0001).
  3692     05  BBILLEDI PIC  9(9).
  3693*    -------------------------------
  3694     05  BKIND1L PIC S9(0004) COMP.
  3695     05  BKIND1F PIC  X(0001).
  3696     05  FILLER REDEFINES BKIND1F.
  3697         10  BKIND1A PIC  X(0001).
  3698     05  BKIND1I PIC  X(0002).
  3699*    -------------------------------
  3700     05  BTYPE1L PIC S9(0004) COMP.
  3701     05  BTYPE1F PIC  X(0001).
  3702     05  FILLER REDEFINES BTYPE1F.
  3703         10  BTYPE1A PIC  X(0001).
  3704     05  BTYPE1I PIC  X(0003).
  3705*    -------------------------------
  3706     05  BTERM1L PIC S9(0004) COMP.
  3707     05  BTERM1F PIC  X(0001).
  3708     05  FILLER REDEFINES BTERM1F.
  3709         10  BTERM1A PIC  X(0001).
  3710     05  BTERM1I PIC  X(0003).
  3711*    -------------------------------
  3712     05  BBEN1L PIC S9(0004) COMP.
  3713     05  BBEN1F PIC  X(0001).
  3714     05  FILLER REDEFINES BBEN1F.
  3715         10  BBEN1A PIC  X(0001).
  3716     05  BBEN1I PIC  X(0012).
  3717*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page  71
* EL6311.cbl
  3718     05  BPREM1L PIC S9(0004) COMP.
  3719     05  BPREM1F PIC  X(0001).
  3720     05  FILLER REDEFINES BPREM1F.
  3721         10  BPREM1A PIC  X(0001).
  3722     05  BPREM1I PIC  X(0011).
  3723*    -------------------------------
  3724     05  BEXPIR1L PIC S9(0004) COMP.
  3725     05  BEXPIR1F PIC  X(0001).
  3726     05  FILLER REDEFINES BEXPIR1F.
  3727         10  BEXPIR1A PIC  X(0001).
  3728     05  BEXPIR1I PIC  X(0008).
  3729*    -------------------------------
  3730     05  BCP1L PIC S9(0004) COMP.
  3731     05  BCP1F PIC  X(0001).
  3732     05  FILLER REDEFINES BCP1F.
  3733         10  BCP1A PIC  X(0001).
  3734     05  BCP1I PIC  X(0002).
  3735*    -------------------------------
  3736     05  BALTBN1L PIC S9(0004) COMP.
  3737     05  BALTBN1F PIC  X(0001).
  3738     05  FILLER REDEFINES BALTBN1F.
  3739         10  BALTBN1A PIC  X(0001).
  3740     05  BALTBN1I PIC  X(0012).
  3741*    -------------------------------
  3742     05  BALTPR1L PIC S9(0004) COMP.
  3743     05  BALTPR1F PIC  X(0001).
  3744     05  FILLER REDEFINES BALTPR1F.
  3745         10  BALTPR1A PIC  X(0001).
  3746     05  BALTPR1I PIC  X(0011).
  3747*    -------------------------------
  3748     05  BBNCD1L PIC S9(0004) COMP.
  3749     05  BBNCD1F PIC  X(0001).
  3750     05  FILLER REDEFINES BBNCD1F.
  3751         10  BBNCD1A PIC  X(0001).
  3752     05  BBNCD1I PIC  X(0003).
  3753*    -------------------------------
  3754     05  BCPRM1L PIC S9(0004) COMP.
  3755     05  BCPRM1F PIC  X(0001).
  3756     05  FILLER REDEFINES BCPRM1F.
  3757         10  BCPRM1A PIC  X(0001).
  3758     05  BCPRM1I PIC  X(0011).
  3759*    -------------------------------
  3760     05  BCAPRM1L PIC S9(0004) COMP.
  3761     05  BCAPRM1F PIC  X(0001).
  3762     05  FILLER REDEFINES BCAPRM1F.
  3763         10  BCAPRM1A PIC  X(0001).
  3764     05  BCAPRM1I PIC  X(0011).
  3765*    -------------------------------
  3766     05  BENABR1L PIC S9(0004) COMP.
  3767     05  BENABR1F PIC  X(0001).
  3768     05  FILLER REDEFINES BENABR1F.
  3769         10  BENABR1A PIC  X(0001).
  3770     05  BENABR1I PIC  X(0005).
  3771*    -------------------------------
  3772     05  BDIFF1L PIC S9(0004) COMP.
  3773     05  BDIFF1F PIC  X(0001).
  3774     05  FILLER REDEFINES BDIFF1F.
  3775         10  BDIFF1A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page  72
* EL6311.cbl
  3776     05  BDIFF1I PIC  X(0011).
  3777*    -------------------------------
  3778     05  BBILIT1L PIC S9(0004) COMP.
  3779     05  BBILIT1F PIC  X(0001).
  3780     05  FILLER REDEFINES BBILIT1F.
  3781         10  BBILIT1A PIC  X(0001).
  3782     05  BBILIT1I PIC  X(0008).
  3783*    -------------------------------
  3784     05  BADIFF1L PIC S9(0004) COMP.
  3785     05  BADIFF1F PIC  X(0001).
  3786     05  FILLER REDEFINES BADIFF1F.
  3787         10  BADIFF1A PIC  X(0001).
  3788     05  BADIFF1I PIC  X(0011).
  3789*    -------------------------------
  3790     05  BKIND2L PIC S9(0004) COMP.
  3791     05  BKIND2F PIC  X(0001).
  3792     05  FILLER REDEFINES BKIND2F.
  3793         10  BKIND2A PIC  X(0001).
  3794     05  BKIND2I PIC  X(0002).
  3795*    -------------------------------
  3796     05  BTYPE2L PIC S9(0004) COMP.
  3797     05  BTYPE2F PIC  X(0001).
  3798     05  FILLER REDEFINES BTYPE2F.
  3799         10  BTYPE2A PIC  X(0001).
  3800     05  BTYPE2I PIC  X(0003).
  3801*    -------------------------------
  3802     05  BTERM2L PIC S9(0004) COMP.
  3803     05  BTERM2F PIC  X(0001).
  3804     05  FILLER REDEFINES BTERM2F.
  3805         10  BTERM2A PIC  X(0001).
  3806     05  BTERM2I PIC  X(0003).
  3807*    -------------------------------
  3808     05  BBEN2L PIC S9(0004) COMP.
  3809     05  BBEN2F PIC  X(0001).
  3810     05  FILLER REDEFINES BBEN2F.
  3811         10  BBEN2A PIC  X(0001).
  3812     05  BBEN2I PIC  X(0012).
  3813*    -------------------------------
  3814     05  BPREM2L PIC S9(0004) COMP.
  3815     05  BPREM2F PIC  X(0001).
  3816     05  FILLER REDEFINES BPREM2F.
  3817         10  BPREM2A PIC  X(0001).
  3818     05  BPREM2I PIC  X(0011).
  3819*    -------------------------------
  3820     05  BEXPIR2L PIC S9(0004) COMP.
  3821     05  BEXPIR2F PIC  X(0001).
  3822     05  FILLER REDEFINES BEXPIR2F.
  3823         10  BEXPIR2A PIC  X(0001).
  3824     05  BEXPIR2I PIC  X(0008).
  3825*    -------------------------------
  3826     05  BCP2L PIC S9(0004) COMP.
  3827     05  BCP2F PIC  X(0001).
  3828     05  FILLER REDEFINES BCP2F.
  3829         10  BCP2A PIC  X(0001).
  3830     05  BCP2I PIC  X(0002).
  3831*    -------------------------------
  3832     05  BALTBN2L PIC S9(0004) COMP.
  3833     05  BALTBN2F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page  73
* EL6311.cbl
  3834     05  FILLER REDEFINES BALTBN2F.
  3835         10  BALTBN2A PIC  X(0001).
  3836     05  BALTBN2I PIC  X(0012).
  3837*    -------------------------------
  3838     05  BALTPR2L PIC S9(0004) COMP.
  3839     05  BALTPR2F PIC  X(0001).
  3840     05  FILLER REDEFINES BALTPR2F.
  3841         10  BALTPR2A PIC  X(0001).
  3842     05  BALTPR2I PIC  X(0011).
  3843*    -------------------------------
  3844     05  BBNCD2L PIC S9(0004) COMP.
  3845     05  BBNCD2F PIC  X(0001).
  3846     05  FILLER REDEFINES BBNCD2F.
  3847         10  BBNCD2A PIC  X(0001).
  3848     05  BBNCD2I PIC  X(0003).
  3849*    -------------------------------
  3850     05  BCPRM2L PIC S9(0004) COMP.
  3851     05  BCPRM2F PIC  X(0001).
  3852     05  FILLER REDEFINES BCPRM2F.
  3853         10  BCPRM2A PIC  X(0001).
  3854     05  BCPRM2I PIC  X(0011).
  3855*    -------------------------------
  3856     05  BCAPRM2L PIC S9(0004) COMP.
  3857     05  BCAPRM2F PIC  X(0001).
  3858     05  FILLER REDEFINES BCAPRM2F.
  3859         10  BCAPRM2A PIC  X(0001).
  3860     05  BCAPRM2I PIC  X(0011).
  3861*    -------------------------------
  3862     05  BENABR2L PIC S9(0004) COMP.
  3863     05  BENABR2F PIC  X(0001).
  3864     05  FILLER REDEFINES BENABR2F.
  3865         10  BENABR2A PIC  X(0001).
  3866     05  BENABR2I PIC  X(0005).
  3867*    -------------------------------
  3868     05  BDIFF2L PIC S9(0004) COMP.
  3869     05  BDIFF2F PIC  X(0001).
  3870     05  FILLER REDEFINES BDIFF2F.
  3871         10  BDIFF2A PIC  X(0001).
  3872     05  BDIFF2I PIC  X(0011).
  3873*    -------------------------------
  3874     05  BBILIT2L PIC S9(0004) COMP.
  3875     05  BBILIT2F PIC  X(0001).
  3876     05  FILLER REDEFINES BBILIT2F.
  3877         10  BBILIT2A PIC  X(0001).
  3878     05  BBILIT2I PIC  X(0008).
  3879*    -------------------------------
  3880     05  BADIFF2L PIC S9(0004) COMP.
  3881     05  BADIFF2F PIC  X(0001).
  3882     05  FILLER REDEFINES BADIFF2F.
  3883         10  BADIFF2A PIC  X(0001).
  3884     05  BADIFF2I PIC  X(0011).
  3885*    -------------------------------
  3886     05  BERMSG1L PIC S9(0004) COMP.
  3887     05  BERMSG1F PIC  X(0001).
  3888     05  FILLER REDEFINES BERMSG1F.
  3889         10  BERMSG1A PIC  X(0001).
  3890     05  BERMSG1I PIC  X(0078).
  3891*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page  74
* EL6311.cbl
  3892     05  BERMSG2L PIC S9(0004) COMP.
  3893     05  BERMSG2F PIC  X(0001).
  3894     05  FILLER REDEFINES BERMSG2F.
  3895         10  BERMSG2A PIC  X(0001).
  3896     05  BERMSG2I PIC  X(0078).
  3897*    -------------------------------
  3898     05  BERMSG3L PIC S9(0004) COMP.
  3899     05  BERMSG3F PIC  X(0001).
  3900     05  FILLER REDEFINES BERMSG3F.
  3901         10  BERMSG3A PIC  X(0001).
  3902     05  BERMSG3I PIC  X(0078).
  3903*    -------------------------------
  3904     05  BPFENTRL PIC S9(0004) COMP.
  3905     05  BPFENTRF PIC  X(0001).
  3906     05  FILLER REDEFINES BPFENTRF.
  3907         10  BPFENTRA PIC  X(0001).
  3908     05  BPFENTRI PIC  9(2).
  3909*    -------------------------------
  3910     05  BPF5HDRL PIC S9(0004) COMP.
  3911     05  BPF5HDRF PIC  X(0001).
  3912     05  FILLER REDEFINES BPF5HDRF.
  3913         10  BPF5HDRA PIC  X(0001).
  3914     05  BPF5HDRI PIC  X(0005).
  3915*    -------------------------------
  3916     05  BPF4HDRL PIC S9(0004) COMP.
  3917     05  BPF4HDRF PIC  X(0001).
  3918     05  FILLER REDEFINES BPF4HDRF.
  3919         10  BPF4HDRA PIC  X(0001).
  3920     05  BPF4HDRI PIC  X(0013).
  3921*    -------------------------------
  3922     05  BF15HDRL PIC S9(0004) COMP.
  3923     05  BF15HDRF PIC  X(0001).
  3924     05  FILLER REDEFINES BF15HDRF.
  3925         10  BF15HDRA PIC  X(0001).
  3926     05  BF15HDRI PIC  X(0010).
  3927 01  EL631BO REDEFINES EL631BI.
  3928     05  FILLER            PIC  X(0012).
  3929*    -------------------------------
  3930     05  FILLER            PIC  X(0003).
  3931     05  BDATEO PIC  X(0008).
  3932*    -------------------------------
  3933     05  FILLER            PIC  X(0003).
  3934     05  BTIMEO PIC  99.99.
  3935*    -------------------------------
  3936     05  FILLER            PIC  X(0003).
  3937     05  BHEADO PIC  X(0038).
  3938*    -------------------------------
  3939     05  FILLER            PIC  X(0003).
  3940     05  BNCERTLO PIC  X(0008).
  3941*    -------------------------------
  3942     05  FILLER            PIC  X(0003).
  3943     05  BNCERTO PIC  X(0011).
  3944*    -------------------------------
  3945     05  FILLER            PIC  X(0003).
  3946     05  BNSTATLO PIC  X(0009).
  3947*    -------------------------------
  3948     05  FILLER            PIC  X(0003).
  3949     05  BNSTATO PIC  X(0002).
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page  75
* EL6311.cbl
  3950*    -------------------------------
  3951     05  FILLER            PIC  X(0003).
  3952     05  BCHGTO PIC  X(0004).
  3953*    -------------------------------
  3954     05  FILLER            PIC  X(0003).
  3955     05  BCHGO PIC  ZZZ9.
  3956*    -------------------------------
  3957     05  FILLER            PIC  X(0003).
  3958     05  BMAINTO PIC  X(0001).
  3959*    -------------------------------
  3960     05  FILLER            PIC  X(0003).
  3961     05  BMANTBYO PIC  X(0004).
  3962*    -------------------------------
  3963     05  FILLER            PIC  X(0003).
  3964     05  BCHGHDGO PIC  X(0003).
  3965*    -------------------------------
  3966     05  FILLER            PIC  X(0003).
  3967     05  BMANTDTO PIC  X(0008).
  3968*    -------------------------------
  3969     05  FILLER            PIC  X(0003).
  3970     05  BMANTATO PIC  99.99.
  3971*    -------------------------------
  3972     05  FILLER            PIC  X(0003).
  3973     05  BCSRO PIC  X(0004).
  3974*    -------------------------------
  3975     05  FILLER            PIC  X(0003).
  3976     05  BBATCHO PIC  X(0006).
  3977*    -------------------------------
  3978     05  FILLER            PIC  X(0003).
  3979     05  BSEQO PIC  X(0004).
  3980*    -------------------------------
  3981     05  FILLER            PIC  X(0003).
  3982     05  BMOENDTO PIC  X(0008).
  3983*    -------------------------------
  3984     05  FILLER            PIC  X(0003).
  3985     05  BCARRO PIC  X(0001).
  3986*    -------------------------------
  3987     05  FILLER            PIC  X(0003).
  3988     05  BGROUPO PIC  X(0006).
  3989*    -------------------------------
  3990     05  FILLER            PIC  X(0003).
  3991     05  BSTATEO PIC  X(0002).
  3992*    -------------------------------
  3993     05  FILLER            PIC  X(0003).
  3994     05  BACCTO PIC  X(0010).
  3995*    -------------------------------
  3996     05  FILLER            PIC  X(0003).
  3997     05  BVINHO PIC  X(0004).
  3998*    -------------------------------
  3999     05  FILLER            PIC  X(0003).
  4000     05  BVINO PIC  X(0017).
  4001*    -------------------------------
  4002     05  FILLER            PIC  X(0003).
  4003     05  BREFHDGO PIC  X(0004).
  4004*    -------------------------------
  4005     05  FILLER            PIC  X(0003).
  4006     05  BREFO PIC  X(0012).
  4007*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page  76
* EL6311.cbl
  4008     05  FILLER            PIC  X(0003).
  4009     05  BAGEDEFO PIC  X(0004).
  4010*    -------------------------------
  4011     05  FILLER            PIC  X(0003).
  4012     05  BCERTNOO PIC  X(0010).
  4013*    -------------------------------
  4014     05  FILLER            PIC  X(0003).
  4015     05  BSUFIXO PIC  X(0001).
  4016*    -------------------------------
  4017     05  FILLER            PIC  X(0003).
  4018     05  BEFFDTO PIC  X(0008).
  4019*    -------------------------------
  4020     05  FILLER            PIC  X(0003).
  4021     05  BLSTNMO PIC  X(0015).
  4022*    -------------------------------
  4023     05  FILLER            PIC  X(0003).
  4024     05  B1STNMO PIC  X(0010).
  4025*    -------------------------------
  4026     05  FILLER            PIC  X(0003).
  4027     05  BINITO PIC  X(0001).
  4028*    -------------------------------
  4029     05  FILLER            PIC  X(0003).
  4030     05  BSEXO PIC  X(0001).
  4031*    -------------------------------
  4032     05  FILLER            PIC  X(0003).
  4033     05  BAGEO PIC  X(0002).
  4034*    -------------------------------
  4035     05  FILLER            PIC  X(0003).
  4036     05  BBIRTHO PIC  X(0008).
  4037*    -------------------------------
  4038     05  FILLER            PIC  X(0003).
  4039     05  B1STPMTO PIC  X(0008).
  4040*    -------------------------------
  4041     05  FILLER            PIC  X(0003).
  4042     05  BDAYSO PIC  X(0003).
  4043*    -------------------------------
  4044     05  FILLER            PIC  X(0003).
  4045     05  BLNTRMO PIC  X(0003).
  4046*    -------------------------------
  4047     05  FILLER            PIC  X(0003).
  4048     05  BLNOFCRO PIC  X(0005).
  4049*    -------------------------------
  4050     05  FILLER            PIC  X(0003).
  4051     05  BMODEO PIC  X(0001).
  4052*    -------------------------------
  4053     05  FILLER            PIC  X(0003).
  4054     05  BFREQO PIC  X(0002).
  4055*    -------------------------------
  4056     05  FILLER            PIC  X(0003).
  4057     05  BPMTSO PIC  X(0003).
  4058*    -------------------------------
  4059     05  FILLER            PIC  X(0003).
  4060     05  BPMTAMTO PIC  ZZZZZ9.99.
  4061*    -------------------------------
  4062     05  FILLER            PIC  X(0003).
  4063     05  BAPRO PIC  99.9999.
  4064*    -------------------------------
  4065     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page  77
* EL6311.cbl
  4066     05  BLIVESO PIC  Z,ZZZ,ZZZ.
  4067*    -------------------------------
  4068     05  FILLER            PIC  X(0003).
  4069     05  BMEMCAPO PIC  X(0011).
  4070*    -------------------------------
  4071     05  FILLER            PIC  X(0003).
  4072     05  BORIGHDO PIC  X(0009).
  4073*    -------------------------------
  4074     05  FILLER            PIC  X(0003).
  4075     05  DMDBILO PIC  X(0006).
  4076*    -------------------------------
  4077     05  FILLER            PIC  X(0003).
  4078     05  BFORCEO PIC  X(0001).
  4079*    -------------------------------
  4080     05  FILLER            PIC  X(0003).
  4081     05  BENTRYO PIC  X(0001).
  4082*    -------------------------------
  4083     05  FILLER            PIC  X(0003).
  4084     05  BREINO PIC  X(0001).
  4085*    -------------------------------
  4086     05  FILLER            PIC  X(0003).
  4087     05  BBILCDO PIC  X(0001).
  4088*    -------------------------------
  4089     05  FILLER            PIC  X(0003).
  4090     05  BUNWRITO PIC  X(0001).
  4091*    -------------------------------
  4092     05  FILLER            PIC  X(0003).
  4093     05  BSKPCDO PIC  X(0001).
  4094*    -------------------------------
  4095     05  FILLER            PIC  X(0003).
  4096     05  BINDGRPO PIC  X(0001).
  4097*    -------------------------------
  4098     05  FILLER            PIC  X(0003).
  4099     05  BSIGO PIC  X(0001).
  4100*    -------------------------------
  4101     05  FILLER            PIC  X(0003).
  4102     05  BRTCLSO PIC  X(0002).
  4103*    -------------------------------
  4104     05  FILLER            PIC  X(0003).
  4105     05  BCHGCNTO PIC  X(0003).
  4106*    -------------------------------
  4107     05  FILLER            PIC  X(0003).
  4108     05  BMEMBERO PIC  X(0012).
  4109*    -------------------------------
  4110     05  FILLER            PIC  X(0003).
  4111     05  BORGNOO PIC  X(0006).
  4112*    -------------------------------
  4113     05  FILLER            PIC  X(0003).
  4114     05  BORGSEQO PIC  X(0004).
  4115*    -------------------------------
  4116     05  FILLER            PIC  X(0003).
  4117     05  BBILLEDO PIC  Z,ZZZ,ZZZ.
  4118*    -------------------------------
  4119     05  FILLER            PIC  X(0003).
  4120     05  BKIND1O PIC  X(0002).
  4121*    -------------------------------
  4122     05  FILLER            PIC  X(0003).
  4123     05  BTYPE1O PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page  78
* EL6311.cbl
  4124*    -------------------------------
  4125     05  FILLER            PIC  X(0003).
  4126     05  BTERM1O PIC  X(0003).
  4127*    -------------------------------
  4128     05  FILLER            PIC  X(0003).
  4129     05  BBEN1O PIC  X(0012).
  4130*    -------------------------------
  4131     05  FILLER            PIC  X(0003).
  4132     05  BPREM1O PIC  X(0011).
  4133*    -------------------------------
  4134     05  FILLER            PIC  X(0003).
  4135     05  BEXPIR1O PIC  X(0008).
  4136*    -------------------------------
  4137     05  FILLER            PIC  X(0003).
  4138     05  BCP1O PIC  X(0002).
  4139*    -------------------------------
  4140     05  FILLER            PIC  X(0003).
  4141     05  BALTBN1O PIC  X(0012).
  4142*    -------------------------------
  4143     05  FILLER            PIC  X(0003).
  4144     05  BALTPR1O PIC  X(0011).
  4145*    -------------------------------
  4146     05  FILLER            PIC  X(0003).
  4147     05  BBNCD1O PIC  X(0003).
  4148*    -------------------------------
  4149     05  FILLER            PIC  X(0003).
  4150     05  BCPRM1O PIC  X(0011).
  4151*    -------------------------------
  4152     05  FILLER            PIC  X(0003).
  4153     05  BCAPRM1O PIC  X(0011).
  4154*    -------------------------------
  4155     05  FILLER            PIC  X(0003).
  4156     05  BENABR1O PIC  X(0005).
  4157*    -------------------------------
  4158     05  FILLER            PIC  X(0003).
  4159     05  BDIFF1O PIC  X(0011).
  4160*    -------------------------------
  4161     05  FILLER            PIC  X(0003).
  4162     05  BBILIT1O PIC  X(0008).
  4163*    -------------------------------
  4164     05  FILLER            PIC  X(0003).
  4165     05  BADIFF1O PIC  X(0011).
  4166*    -------------------------------
  4167     05  FILLER            PIC  X(0003).
  4168     05  BKIND2O PIC  X(0002).
  4169*    -------------------------------
  4170     05  FILLER            PIC  X(0003).
  4171     05  BTYPE2O PIC  X(0003).
  4172*    -------------------------------
  4173     05  FILLER            PIC  X(0003).
  4174     05  BTERM2O PIC  X(0003).
  4175*    -------------------------------
  4176     05  FILLER            PIC  X(0003).
  4177     05  BBEN2O PIC  X(0012).
  4178*    -------------------------------
  4179     05  FILLER            PIC  X(0003).
  4180     05  BPREM2O PIC  X(0011).
  4181*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page  79
* EL6311.cbl
  4182     05  FILLER            PIC  X(0003).
  4183     05  BEXPIR2O PIC  X(0008).
  4184*    -------------------------------
  4185     05  FILLER            PIC  X(0003).
  4186     05  BCP2O PIC  X(0002).
  4187*    -------------------------------
  4188     05  FILLER            PIC  X(0003).
  4189     05  BALTBN2O PIC  X(0012).
  4190*    -------------------------------
  4191     05  FILLER            PIC  X(0003).
  4192     05  BALTPR2O PIC  X(0011).
  4193*    -------------------------------
  4194     05  FILLER            PIC  X(0003).
  4195     05  BBNCD2O PIC  X(0003).
  4196*    -------------------------------
  4197     05  FILLER            PIC  X(0003).
  4198     05  BCPRM2O PIC  X(0011).
  4199*    -------------------------------
  4200     05  FILLER            PIC  X(0003).
  4201     05  BCAPRM2O PIC  X(0011).
  4202*    -------------------------------
  4203     05  FILLER            PIC  X(0003).
  4204     05  BENABR2O PIC  X(0005).
  4205*    -------------------------------
  4206     05  FILLER            PIC  X(0003).
  4207     05  BDIFF2O PIC  X(0011).
  4208*    -------------------------------
  4209     05  FILLER            PIC  X(0003).
  4210     05  BBILIT2O PIC  X(0008).
  4211*    -------------------------------
  4212     05  FILLER            PIC  X(0003).
  4213     05  BADIFF2O PIC  X(0011).
  4214*    -------------------------------
  4215     05  FILLER            PIC  X(0003).
  4216     05  BERMSG1O PIC  X(0078).
  4217*    -------------------------------
  4218     05  FILLER            PIC  X(0003).
  4219     05  BERMSG2O PIC  X(0078).
  4220*    -------------------------------
  4221     05  FILLER            PIC  X(0003).
  4222     05  BERMSG3O PIC  X(0078).
  4223*    -------------------------------
  4224     05  FILLER            PIC  X(0003).
  4225     05  BPFENTRO PIC  X(0002).
  4226*    -------------------------------
  4227     05  FILLER            PIC  X(0003).
  4228     05  BPF5HDRO PIC  X(0005).
  4229*    -------------------------------
  4230     05  FILLER            PIC  X(0003).
  4231     05  BPF4HDRO PIC  X(0013).
  4232*    -------------------------------
  4233     05  FILLER            PIC  X(0003).
  4234     05  BF15HDRO PIC  X(0010).
  4235*    -------------------------------
  4236 01  EL631CI REDEFINES EL631BI.
  4237     05  FILLER            PIC  X(0012).
  4238*    -------------------------------
  4239     05  CDATEL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page  80
* EL6311.cbl
  4240     05  CDATEF PIC  X(0001).
  4241     05  FILLER REDEFINES CDATEF.
  4242         10  CDATEA PIC  X(0001).
  4243     05  CDATEI PIC  X(0008).
  4244*    -------------------------------
  4245     05  CTIMEL PIC S9(0004) COMP.
  4246     05  CTIMEF PIC  X(0001).
  4247     05  FILLER REDEFINES CTIMEF.
  4248         10  CTIMEA PIC  X(0001).
  4249     05  CTIMEI PIC  X(0005).
  4250*    -------------------------------
  4251     05  CHEADL PIC S9(0004) COMP.
  4252     05  CHEADF PIC  X(0001).
  4253     05  FILLER REDEFINES CHEADF.
  4254         10  CHEADA PIC  X(0001).
  4255     05  CHEADI PIC  X(0038).
  4256*    -------------------------------
  4257     05  CCHGTL PIC S9(0004) COMP.
  4258     05  CCHGTF PIC  X(0001).
  4259     05  FILLER REDEFINES CCHGTF.
  4260         10  CCHGTA PIC  X(0001).
  4261     05  CCHGTI PIC  X(0004).
  4262*    -------------------------------
  4263     05  CCHGL PIC S9(0004) COMP.
  4264     05  CCHGF PIC  X(0001).
  4265     05  FILLER REDEFINES CCHGF.
  4266         10  CCHGA PIC  X(0001).
  4267     05  CCHGI PIC  X(0004).
  4268*    -------------------------------
  4269     05  CMAINTL PIC S9(0004) COMP.
  4270     05  CMAINTF PIC  X(0001).
  4271     05  FILLER REDEFINES CMAINTF.
  4272         10  CMAINTA PIC  X(0001).
  4273     05  CMAINTI PIC  X(0001).
  4274*    -------------------------------
  4275     05  CMANTBYL PIC S9(0004) COMP.
  4276     05  CMANTBYF PIC  X(0001).
  4277     05  FILLER REDEFINES CMANTBYF.
  4278         10  CMANTBYA PIC  X(0001).
  4279     05  CMANTBYI PIC  X(0004).
  4280*    -------------------------------
  4281     05  CCHGHDGL PIC S9(0004) COMP.
  4282     05  CCHGHDGF PIC  X(0001).
  4283     05  FILLER REDEFINES CCHGHDGF.
  4284         10  CCHGHDGA PIC  X(0001).
  4285     05  CCHGHDGI PIC  X(0003).
  4286*    -------------------------------
  4287     05  CMANTDTL PIC S9(0004) COMP.
  4288     05  CMANTDTF PIC  X(0001).
  4289     05  FILLER REDEFINES CMANTDTF.
  4290         10  CMANTDTA PIC  X(0001).
  4291     05  CMANTDTI PIC  X(0008).
  4292*    -------------------------------
  4293     05  CMANTATL PIC S9(0004) COMP.
  4294     05  CMANTATF PIC  X(0001).
  4295     05  FILLER REDEFINES CMANTATF.
  4296         10  CMANTATA PIC  X(0001).
  4297     05  CMANTATI PIC  X(0005).
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page  81
* EL6311.cbl
  4298*    -------------------------------
  4299     05  CCSRL PIC S9(0004) COMP.
  4300     05  CCSRF PIC  X(0001).
  4301     05  FILLER REDEFINES CCSRF.
  4302         10  CCSRA PIC  X(0001).
  4303     05  CCSRI PIC  X(0004).
  4304*    -------------------------------
  4305     05  CBATCHL PIC S9(0004) COMP.
  4306     05  CBATCHF PIC  X(0001).
  4307     05  FILLER REDEFINES CBATCHF.
  4308         10  CBATCHA PIC  X(0001).
  4309     05  CBATCHI PIC  X(0006).
  4310*    -------------------------------
  4311     05  CSEQL PIC S9(0004) COMP.
  4312     05  CSEQF PIC  X(0001).
  4313     05  FILLER REDEFINES CSEQF.
  4314         10  CSEQA PIC  X(0001).
  4315     05  CSEQI PIC  X(0004).
  4316*    -------------------------------
  4317     05  CMOENDTL PIC S9(0004) COMP.
  4318     05  CMOENDTF PIC  X(0001).
  4319     05  FILLER REDEFINES CMOENDTF.
  4320         10  CMOENDTA PIC  X(0001).
  4321     05  CMOENDTI PIC  X(0008).
  4322*    -------------------------------
  4323     05  CCARRL PIC S9(0004) COMP.
  4324     05  CCARRF PIC  X(0001).
  4325     05  FILLER REDEFINES CCARRF.
  4326         10  CCARRA PIC  X(0001).
  4327     05  CCARRI PIC  X(0001).
  4328*    -------------------------------
  4329     05  CGROUPL PIC S9(0004) COMP.
  4330     05  CGROUPF PIC  X(0001).
  4331     05  FILLER REDEFINES CGROUPF.
  4332         10  CGROUPA PIC  X(0001).
  4333     05  CGROUPI PIC  X(0006).
  4334*    -------------------------------
  4335     05  CSTATEL PIC S9(0004) COMP.
  4336     05  CSTATEF PIC  X(0001).
  4337     05  FILLER REDEFINES CSTATEF.
  4338         10  CSTATEA PIC  X(0001).
  4339     05  CSTATEI PIC  X(0002).
  4340*    -------------------------------
  4341     05  CACCTL PIC S9(0004) COMP.
  4342     05  CACCTF PIC  X(0001).
  4343     05  FILLER REDEFINES CACCTF.
  4344         10  CACCTA PIC  X(0001).
  4345     05  CACCTI PIC  X(0010).
  4346*    -------------------------------
  4347     05  CORIGHDL PIC S9(0004) COMP.
  4348     05  CORIGHDF PIC  X(0001).
  4349     05  FILLER REDEFINES CORIGHDF.
  4350         10  CORIGHDA PIC  X(0001).
  4351     05  CORIGHDI PIC  X(0011).
  4352*    -------------------------------
  4353     05  CORGNOL PIC S9(0004) COMP.
  4354     05  CORGNOF PIC  X(0001).
  4355     05  FILLER REDEFINES CORGNOF.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page  82
* EL6311.cbl
  4356         10  CORGNOA PIC  X(0001).
  4357     05  CORGNOI PIC  X(0006).
  4358*    -------------------------------
  4359     05  CORGSEQL PIC S9(0004) COMP.
  4360     05  CORGSEQF PIC  X(0001).
  4361     05  FILLER REDEFINES CORGSEQF.
  4362         10  CORGSEQA PIC  X(0001).
  4363     05  CORGSEQI PIC  X(0004).
  4364*    -------------------------------
  4365     05  CREFHDGL PIC S9(0004) COMP.
  4366     05  CREFHDGF PIC  X(0001).
  4367     05  FILLER REDEFINES CREFHDGF.
  4368         10  CREFHDGA PIC  X(0001).
  4369     05  CREFHDGI PIC  X(0010).
  4370*    -------------------------------
  4371     05  CREFL PIC S9(0004) COMP.
  4372     05  CREFF PIC  X(0001).
  4373     05  FILLER REDEFINES CREFF.
  4374         10  CREFA PIC  X(0001).
  4375     05  CREFI PIC  X(0012).
  4376*    -------------------------------
  4377     05  CNHINTL PIC S9(0004) COMP.
  4378     05  CNHINTF PIC  X(0001).
  4379     05  FILLER REDEFINES CNHINTF.
  4380         10  CNHINTA PIC  X(0001).
  4381     05  CNHINTI PIC  9(7)V99.
  4382*    -------------------------------
  4383     05  CCERTNOL PIC S9(0004) COMP.
  4384     05  CCERTNOF PIC  X(0001).
  4385     05  FILLER REDEFINES CCERTNOF.
  4386         10  CCERTNOA PIC  X(0001).
  4387     05  CCERTNOI PIC  X(0010).
  4388*    -------------------------------
  4389     05  CSUFIXL PIC S9(0004) COMP.
  4390     05  CSUFIXF PIC  X(0001).
  4391     05  FILLER REDEFINES CSUFIXF.
  4392         10  CSUFIXA PIC  X(0001).
  4393     05  CSUFIXI PIC  X(0001).
  4394*    -------------------------------
  4395     05  CEFFDTL PIC S9(0004) COMP.
  4396     05  CEFFDTF PIC  X(0001).
  4397     05  FILLER REDEFINES CEFFDTF.
  4398         10  CEFFDTA PIC  X(0001).
  4399     05  CEFFDTI PIC  X(0008).
  4400*    -------------------------------
  4401     05  CLSTNML PIC S9(0004) COMP.
  4402     05  CLSTNMF PIC  X(0001).
  4403     05  FILLER REDEFINES CLSTNMF.
  4404         10  CLSTNMA PIC  X(0001).
  4405     05  CLSTNMI PIC  X(0015).
  4406*    -------------------------------
  4407     05  CPCYNL PIC S9(0004) COMP.
  4408     05  CPCYNF PIC  X(0001).
  4409     05  FILLER REDEFINES CPCYNF.
  4410         10  CPCYNA PIC  X(0001).
  4411     05  CPCYNI PIC  X(0001).
  4412*    -------------------------------
  4413     05  CINAMEL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page  83
* EL6311.cbl
  4414     05  CINAMEF PIC  X(0001).
  4415     05  FILLER REDEFINES CINAMEF.
  4416         10  CINAMEA PIC  X(0001).
  4417     05  CINAMEI PIC  X(0015).
  4418*    -------------------------------
  4419     05  CINITSL PIC S9(0004) COMP.
  4420     05  CINITSF PIC  X(0001).
  4421     05  FILLER REDEFINES CINITSF.
  4422         10  CINITSA PIC  X(0001).
  4423     05  CINITSI PIC  X(0010).
  4424*    -------------------------------
  4425     05  CCANREAL PIC S9(0004) COMP.
  4426     05  CCANREAF PIC  X(0001).
  4427     05  FILLER REDEFINES CCANREAF.
  4428         10  CCANREAA PIC  X(0001).
  4429     05  CCANREAI PIC  X(0001).
  4430*    -------------------------------
  4431     05  CKIND1L PIC S9(0004) COMP.
  4432     05  CKIND1F PIC  X(0001).
  4433     05  FILLER REDEFINES CKIND1F.
  4434         10  CKIND1A PIC  X(0001).
  4435     05  CKIND1I PIC  X(0002).
  4436*    -------------------------------
  4437     05  CCANDT1L PIC S9(0004) COMP.
  4438     05  CCANDT1F PIC  X(0001).
  4439     05  FILLER REDEFINES CCANDT1F.
  4440         10  CCANDT1A PIC  X(0001).
  4441     05  CCANDT1I PIC  X(0008).
  4442*    -------------------------------
  4443     05  CREFND1L PIC S9(0004) COMP.
  4444     05  CREFND1F PIC  X(0001).
  4445     05  FILLER REDEFINES CREFND1F.
  4446         10  CREFND1A PIC  X(0001).
  4447     05  CREFND1I PIC  S9(9)V99.
  4448*    -------------------------------
  4449     05  CMTHD1L PIC S9(0004) COMP.
  4450     05  CMTHD1F PIC  X(0001).
  4451     05  FILLER REDEFINES CMTHD1F.
  4452         10  CMTHD1A PIC  X(0001).
  4453     05  CMTHD1I PIC  X(0001).
  4454*    -------------------------------
  4455     05  CKIND2L PIC S9(0004) COMP.
  4456     05  CKIND2F PIC  X(0001).
  4457     05  FILLER REDEFINES CKIND2F.
  4458         10  CKIND2A PIC  X(0001).
  4459     05  CKIND2I PIC  X(0002).
  4460*    -------------------------------
  4461     05  CCANDT2L PIC S9(0004) COMP.
  4462     05  CCANDT2F PIC  X(0001).
  4463     05  FILLER REDEFINES CCANDT2F.
  4464         10  CCANDT2A PIC  X(0001).
  4465     05  CCANDT2I PIC  X(0008).
  4466*    -------------------------------
  4467     05  CREFND2L PIC S9(0004) COMP.
  4468     05  CREFND2F PIC  X(0001).
  4469     05  FILLER REDEFINES CREFND2F.
  4470         10  CREFND2A PIC  X(0001).
  4471     05  CREFND2I PIC  S9(9)V99.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page  84
* EL6311.cbl
  4472*    -------------------------------
  4473     05  CMTHD2L PIC S9(0004) COMP.
  4474     05  CMTHD2F PIC  X(0001).
  4475     05  FILLER REDEFINES CMTHD2F.
  4476         10  CMTHD2A PIC  X(0001).
  4477     05  CMTHD2I PIC  X(0001).
  4478*    -------------------------------
  4479     05  CLIVESL PIC S9(0004) COMP.
  4480     05  CLIVESF PIC  X(0001).
  4481     05  FILLER REDEFINES CLIVESF.
  4482         10  CLIVESA PIC  X(0001).
  4483     05  CLIVESI PIC  X(0003).
  4484*    -------------------------------
  4485     05  CFORCEL PIC S9(0004) COMP.
  4486     05  CFORCEF PIC  X(0001).
  4487     05  FILLER REDEFINES CFORCEF.
  4488         10  CFORCEA PIC  X(0001).
  4489     05  CFORCEI PIC  X(0001).
  4490*    -------------------------------
  4491     05  CBILCDL PIC S9(0004) COMP.
  4492     05  CBILCDF PIC  X(0001).
  4493     05  FILLER REDEFINES CBILCDF.
  4494         10  CBILCDA PIC  X(0001).
  4495     05  CBILCDI PIC  X(0001).
  4496*    -------------------------------
  4497     05  CCRFND1L PIC S9(0004) COMP.
  4498     05  CCRFND1F PIC  X(0001).
  4499     05  FILLER REDEFINES CCRFND1F.
  4500         10  CCRFND1A PIC  X(0001).
  4501     05  CCRFND1I PIC  X(0011).
  4502*    -------------------------------
  4503     05  CCRFND2L PIC S9(0004) COMP.
  4504     05  CCRFND2F PIC  X(0001).
  4505     05  FILLER REDEFINES CCRFND2F.
  4506         10  CCRFND2A PIC  X(0001).
  4507     05  CCRFND2I PIC  X(0011).
  4508*    -------------------------------
  4509     05  CBILIT1L PIC S9(0004) COMP.
  4510     05  CBILIT1F PIC  X(0001).
  4511     05  FILLER REDEFINES CBILIT1F.
  4512         10  CBILIT1A PIC  X(0001).
  4513     05  CBILIT1I PIC  X(0008).
  4514*    -------------------------------
  4515     05  CDRFND1L PIC S9(0004) COMP.
  4516     05  CDRFND1F PIC  X(0001).
  4517     05  FILLER REDEFINES CDRFND1F.
  4518         10  CDRFND1A PIC  X(0001).
  4519     05  CDRFND1I PIC  X(0011).
  4520*    -------------------------------
  4521     05  CBILIT2L PIC S9(0004) COMP.
  4522     05  CBILIT2F PIC  X(0001).
  4523     05  FILLER REDEFINES CBILIT2F.
  4524         10  CBILIT2A PIC  X(0001).
  4525     05  CBILIT2I PIC  X(0008).
  4526*    -------------------------------
  4527     05  CDRFND2L PIC S9(0004) COMP.
  4528     05  CDRFND2F PIC  X(0001).
  4529     05  FILLER REDEFINES CDRFND2F.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page  85
* EL6311.cbl
  4530         10  CDRFND2A PIC  X(0001).
  4531     05  CDRFND2I PIC  X(0011).
  4532*    -------------------------------
  4533     05  CCANTXTL PIC S9(0004) COMP.
  4534     05  CCANTXTF PIC  X(0001).
  4535     05  FILLER REDEFINES CCANTXTF.
  4536         10  CCANTXTA PIC  X(0001).
  4537     05  CCANTXTI PIC  X(0005).
  4538*    -------------------------------
  4539     05  CCANFEEL PIC S9(0004) COMP.
  4540     05  CCANFEEF PIC  X(0001).
  4541     05  FILLER REDEFINES CCANFEEF.
  4542         10  CCANFEEA PIC  X(0001).
  4543     05  CCANFEEI PIC  X(0002).
  4544*    -------------------------------
  4545     05  CTERM1L PIC S9(0004) COMP.
  4546     05  CTERM1F PIC  X(0001).
  4547     05  FILLER REDEFINES CTERM1F.
  4548         10  CTERM1A PIC  X(0001).
  4549     05  CTERM1I PIC  X(0003).
  4550*    -------------------------------
  4551     05  CRTERM1L PIC S9(0004) COMP.
  4552     05  CRTERM1F PIC  X(0001).
  4553     05  FILLER REDEFINES CRTERM1F.
  4554         10  CRTERM1A PIC  X(0001).
  4555     05  CRTERM1I PIC  X(0003).
  4556*    -------------------------------
  4557     05  CPREM1L PIC S9(0004) COMP.
  4558     05  CPREM1F PIC  X(0001).
  4559     05  FILLER REDEFINES CPREM1F.
  4560         10  CPREM1A PIC  X(0001).
  4561     05  CPREM1I PIC  X(0011).
  4562*    -------------------------------
  4563     05  CTERM2L PIC S9(0004) COMP.
  4564     05  CTERM2F PIC  X(0001).
  4565     05  FILLER REDEFINES CTERM2F.
  4566         10  CTERM2A PIC  X(0001).
  4567     05  CTERM2I PIC  X(0003).
  4568*    -------------------------------
  4569     05  CRTERM2L PIC S9(0004) COMP.
  4570     05  CRTERM2F PIC  X(0001).
  4571     05  FILLER REDEFINES CRTERM2F.
  4572         10  CRTERM2A PIC  X(0001).
  4573     05  CRTERM2I PIC  X(0003).
  4574*    -------------------------------
  4575     05  CPREM2L PIC S9(0004) COMP.
  4576     05  CPREM2F PIC  X(0001).
  4577     05  FILLER REDEFINES CPREM2F.
  4578         10  CPREM2A PIC  X(0001).
  4579     05  CPREM2I PIC  X(0011).
  4580*    -------------------------------
  4581     05  CENTRDTL PIC S9(0004) COMP.
  4582     05  CENTRDTF PIC  X(0001).
  4583     05  FILLER REDEFINES CENTRDTF.
  4584         10  CENTRDTA PIC  X(0001).
  4585     05  CENTRDTI PIC  X(0008).
  4586*    -------------------------------
  4587     05  CPAYEEL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page  86
* EL6311.cbl
  4588     05  CPAYEEF PIC  X(0001).
  4589     05  FILLER REDEFINES CPAYEEF.
  4590         10  CPAYEEA PIC  X(0001).
  4591     05  CPAYEEI PIC  X(0006).
  4592*    -------------------------------
  4593     05  CRFNDSWL PIC S9(0004) COMP.
  4594     05  CRFNDSWF PIC  X(0001).
  4595     05  FILLER REDEFINES CRFNDSWF.
  4596         10  CRFNDSWA PIC  X(0001).
  4597     05  CRFNDSWI PIC  X(0003).
  4598*    -------------------------------
  4599     05  CLFHDGL PIC S9(0004) COMP.
  4600     05  CLFHDGF PIC  X(0001).
  4601     05  FILLER REDEFINES CLFHDGF.
  4602         10  CLFHDGA PIC  X(0001).
  4603     05  CLFHDGI PIC  X(0006).
  4604*    -------------------------------
  4605     05  CAHHDGL PIC S9(0004) COMP.
  4606     05  CAHHDGF PIC  X(0001).
  4607     05  FILLER REDEFINES CAHHDGF.
  4608         10  CAHHDGA PIC  X(0001).
  4609     05  CAHHDGI PIC  X(0006).
  4610*    -------------------------------
  4611     05  CENTDTL PIC S9(0004) COMP.
  4612     05  CENTDTF PIC  X(0001).
  4613     05  FILLER REDEFINES CENTDTF.
  4614         10  CENTDTA PIC  X(0001).
  4615     05  CENTDTI PIC  X(0008).
  4616*    -------------------------------
  4617     05  CENTBYL PIC S9(0004) COMP.
  4618     05  CENTBYF PIC  X(0001).
  4619     05  FILLER REDEFINES CENTBYF.
  4620         10  CENTBYA PIC  X(0001).
  4621     05  CENTBYI PIC  X(0004).
  4622*    -------------------------------
  4623     05  CCHGCNTL PIC S9(0004) COMP.
  4624     05  CCHGCNTF PIC  X(0001).
  4625     05  FILLER REDEFINES CCHGCNTF.
  4626         10  CCHGCNTA PIC  X(0001).
  4627     05  CCHGCNTI PIC  X(0003).
  4628*    -------------------------------
  4629     05  CLFREFNL PIC S9(0004) COMP.
  4630     05  CLFREFNF PIC  X(0001).
  4631     05  FILLER REDEFINES CLFREFNF.
  4632         10  CLFREFNA PIC  X(0001).
  4633     05  CLFREFNI PIC  X(0006).
  4634*    -------------------------------
  4635     05  CAHREFNL PIC S9(0004) COMP.
  4636     05  CAHREFNF PIC  X(0001).
  4637     05  FILLER REDEFINES CAHREFNF.
  4638         10  CAHREFNA PIC  X(0001).
  4639     05  CAHREFNI PIC  X(0006).
  4640*    -------------------------------
  4641     05  CREINCDL PIC S9(0004) COMP.
  4642     05  CREINCDF PIC  X(0001).
  4643     05  FILLER REDEFINES CREINCDF.
  4644         10  CREINCDA PIC  X(0001).
  4645     05  CREINCDI PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page  87
* EL6311.cbl
  4646*    -------------------------------
  4647     05  CAEFFDTL PIC S9(0004) COMP.
  4648     05  CAEFFDTF PIC  X(0001).
  4649     05  FILLER REDEFINES CAEFFDTF.
  4650         10  CAEFFDTA PIC  X(0001).
  4651     05  CAEFFDTI PIC  X(0008).
  4652*    -------------------------------
  4653     05  CAEXPDTL PIC S9(0004) COMP.
  4654     05  CAEXPDTF PIC  X(0001).
  4655     05  FILLER REDEFINES CAEXPDTF.
  4656         10  CAEXPDTA PIC  X(0001).
  4657     05  CAEXPDTI PIC  X(0008).
  4658*    -------------------------------
  4659     05  COMMLFL PIC S9(0004) COMP.
  4660     05  COMMLFF PIC  X(0001).
  4661     05  FILLER REDEFINES COMMLFF.
  4662         10  COMMLFA PIC  X(0001).
  4663     05  COMMLFI PIC  X(0006).
  4664*    -------------------------------
  4665     05  COMMAHL PIC S9(0004) COMP.
  4666     05  COMMAHF PIC  X(0001).
  4667     05  FILLER REDEFINES COMMAHF.
  4668         10  COMMAHA PIC  X(0001).
  4669     05  COMMAHI PIC  X(0006).
  4670*    -------------------------------
  4671     05  CERMSG1L PIC S9(0004) COMP.
  4672     05  CERMSG1F PIC  X(0001).
  4673     05  FILLER REDEFINES CERMSG1F.
  4674         10  CERMSG1A PIC  X(0001).
  4675     05  CERMSG1I PIC  X(0078).
  4676*    -------------------------------
  4677     05  CERMSG2L PIC S9(0004) COMP.
  4678     05  CERMSG2F PIC  X(0001).
  4679     05  FILLER REDEFINES CERMSG2F.
  4680         10  CERMSG2A PIC  X(0001).
  4681     05  CERMSG2I PIC  X(0078).
  4682*    -------------------------------
  4683     05  CERMSG3L PIC S9(0004) COMP.
  4684     05  CERMSG3F PIC  X(0001).
  4685     05  FILLER REDEFINES CERMSG3F.
  4686         10  CERMSG3A PIC  X(0001).
  4687     05  CERMSG3I PIC  X(0078).
  4688*    -------------------------------
  4689     05  CPFENTRL PIC S9(0004) COMP.
  4690     05  CPFENTRF PIC  X(0001).
  4691     05  FILLER REDEFINES CPFENTRF.
  4692         10  CPFENTRA PIC  X(0001).
  4693     05  CPFENTRI PIC  9(2).
  4694*    -------------------------------
  4695     05  CPF5HDRL PIC S9(0004) COMP.
  4696     05  CPF5HDRF PIC  X(0001).
  4697     05  FILLER REDEFINES CPF5HDRF.
  4698         10  CPF5HDRA PIC  X(0001).
  4699     05  CPF5HDRI PIC  X(0005).
  4700*    -------------------------------
  4701     05  CPF4HDRL PIC S9(0004) COMP.
  4702     05  CPF4HDRF PIC  X(0001).
  4703     05  FILLER REDEFINES CPF4HDRF.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page  88
* EL6311.cbl
  4704         10  CPF4HDRA PIC  X(0001).
  4705     05  CPF4HDRI PIC  X(0013).
  4706*    -------------------------------
  4707     05  CF15HDRL PIC S9(0004) COMP.
  4708     05  CF15HDRF PIC  X(0001).
  4709     05  FILLER REDEFINES CF15HDRF.
  4710         10  CF15HDRA PIC  X(0001).
  4711     05  CF15HDRI PIC  X(0022).
  4712 01  EL631CO REDEFINES EL631BI.
  4713     05  FILLER            PIC  X(0012).
  4714*    -------------------------------
  4715     05  FILLER            PIC  X(0003).
  4716     05  CDATEO PIC  X(0008).
  4717*    -------------------------------
  4718     05  FILLER            PIC  X(0003).
  4719     05  CTIMEO PIC  99.99.
  4720*    -------------------------------
  4721     05  FILLER            PIC  X(0003).
  4722     05  CHEADO PIC  X(0038).
  4723*    -------------------------------
  4724     05  FILLER            PIC  X(0003).
  4725     05  CCHGTO PIC  X(0004).
  4726*    -------------------------------
  4727     05  FILLER            PIC  X(0003).
  4728     05  CCHGO PIC  ZZZ9.
  4729*    -------------------------------
  4730     05  FILLER            PIC  X(0003).
  4731     05  CMAINTO PIC  X(0001).
  4732*    -------------------------------
  4733     05  FILLER            PIC  X(0003).
  4734     05  CMANTBYO PIC  X(0004).
  4735*    -------------------------------
  4736     05  FILLER            PIC  X(0003).
  4737     05  CCHGHDGO PIC  X(0003).
  4738*    -------------------------------
  4739     05  FILLER            PIC  X(0003).
  4740     05  CMANTDTO PIC  X(0008).
  4741*    -------------------------------
  4742     05  FILLER            PIC  X(0003).
  4743     05  CMANTATO PIC  99.99.
  4744*    -------------------------------
  4745     05  FILLER            PIC  X(0003).
  4746     05  CCSRO PIC  X(0004).
  4747*    -------------------------------
  4748     05  FILLER            PIC  X(0003).
  4749     05  CBATCHO PIC  X(0006).
  4750*    -------------------------------
  4751     05  FILLER            PIC  X(0003).
  4752     05  CSEQO PIC  X(0004).
  4753*    -------------------------------
  4754     05  FILLER            PIC  X(0003).
  4755     05  CMOENDTO PIC  X(0008).
  4756*    -------------------------------
  4757     05  FILLER            PIC  X(0003).
  4758     05  CCARRO PIC  X(0001).
  4759*    -------------------------------
  4760     05  FILLER            PIC  X(0003).
  4761     05  CGROUPO PIC  X(0006).
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page  89
* EL6311.cbl
  4762*    -------------------------------
  4763     05  FILLER            PIC  X(0003).
  4764     05  CSTATEO PIC  X(0002).
  4765*    -------------------------------
  4766     05  FILLER            PIC  X(0003).
  4767     05  CACCTO PIC  X(0010).
  4768*    -------------------------------
  4769     05  FILLER            PIC  X(0003).
  4770     05  CORIGHDO PIC  X(0011).
  4771*    -------------------------------
  4772     05  FILLER            PIC  X(0003).
  4773     05  CORGNOO PIC  X(0006).
  4774*    -------------------------------
  4775     05  FILLER            PIC  X(0003).
  4776     05  CORGSEQO PIC  X(0004).
  4777*    -------------------------------
  4778     05  FILLER            PIC  X(0003).
  4779     05  CREFHDGO PIC  X(0010).
  4780*    -------------------------------
  4781     05  FILLER            PIC  X(0003).
  4782     05  CREFO PIC  X(0012).
  4783*    -------------------------------
  4784     05  FILLER            PIC  X(0003).
  4785     05  CNHINTO PIC  999999.99.
  4786*    -------------------------------
  4787     05  FILLER            PIC  X(0003).
  4788     05  CCERTNOO PIC  X(0010).
  4789*    -------------------------------
  4790     05  FILLER            PIC  X(0003).
  4791     05  CSUFIXO PIC  X(0001).
  4792*    -------------------------------
  4793     05  FILLER            PIC  X(0003).
  4794     05  CEFFDTO PIC  X(0008).
  4795*    -------------------------------
  4796     05  FILLER            PIC  X(0003).
  4797     05  CLSTNMO PIC  X(0015).
  4798*    -------------------------------
  4799     05  FILLER            PIC  X(0003).
  4800     05  CPCYNO PIC  X(0001).
  4801*    -------------------------------
  4802     05  FILLER            PIC  X(0003).
  4803     05  CINAMEO PIC  X(0015).
  4804*    -------------------------------
  4805     05  FILLER            PIC  X(0003).
  4806     05  CINITSO PIC  X(0010).
  4807*    -------------------------------
  4808     05  FILLER            PIC  X(0003).
  4809     05  CCANREAO PIC  X(0001).
  4810*    -------------------------------
  4811     05  FILLER            PIC  X(0003).
  4812     05  CKIND1O PIC  X(0002).
  4813*    -------------------------------
  4814     05  FILLER            PIC  X(0003).
  4815     05  CCANDT1O PIC  X(0008).
  4816*    -------------------------------
  4817     05  FILLER            PIC  X(0003).
  4818     05  CREFND1O PIC  Z(7).99-.
  4819*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page  90
* EL6311.cbl
  4820     05  FILLER            PIC  X(0003).
  4821     05  CMTHD1O PIC  X(0001).
  4822*    -------------------------------
  4823     05  FILLER            PIC  X(0003).
  4824     05  CKIND2O PIC  X(0002).
  4825*    -------------------------------
  4826     05  FILLER            PIC  X(0003).
  4827     05  CCANDT2O PIC  X(0008).
  4828*    -------------------------------
  4829     05  FILLER            PIC  X(0003).
  4830     05  CREFND2O PIC  Z(7).99-.
  4831*    -------------------------------
  4832     05  FILLER            PIC  X(0003).
  4833     05  CMTHD2O PIC  X(0001).
  4834*    -------------------------------
  4835     05  FILLER            PIC  X(0003).
  4836     05  CLIVESO PIC  X(0003).
  4837*    -------------------------------
  4838     05  FILLER            PIC  X(0003).
  4839     05  CFORCEO PIC  X(0001).
  4840*    -------------------------------
  4841     05  FILLER            PIC  X(0003).
  4842     05  CBILCDO PIC  X(0001).
  4843*    -------------------------------
  4844     05  FILLER            PIC  X(0003).
  4845     05  CCRFND1O PIC  Z(7).99-.
  4846*    -------------------------------
  4847     05  FILLER            PIC  X(0003).
  4848     05  CCRFND2O PIC  Z(7).99-.
  4849*    -------------------------------
  4850     05  FILLER            PIC  X(0003).
  4851     05  CBILIT1O PIC  X(0008).
  4852*    -------------------------------
  4853     05  FILLER            PIC  X(0003).
  4854     05  CDRFND1O PIC  Z(7).99-.
  4855*    -------------------------------
  4856     05  FILLER            PIC  X(0003).
  4857     05  CBILIT2O PIC  X(0008).
  4858*    -------------------------------
  4859     05  FILLER            PIC  X(0003).
  4860     05  CDRFND2O PIC  Z(7).99-.
  4861*    -------------------------------
  4862     05  FILLER            PIC  X(0003).
  4863     05  CCANTXTO PIC  X(0005).
  4864*    -------------------------------
  4865     05  FILLER            PIC  X(0003).
  4866     05  CCANFEEO PIC  Z9.
  4867*    -------------------------------
  4868     05  FILLER            PIC  X(0003).
  4869     05  CTERM1O PIC  ZZ9.
  4870*    -------------------------------
  4871     05  FILLER            PIC  X(0003).
  4872     05  CRTERM1O PIC  ZZ9.
  4873*    -------------------------------
  4874     05  FILLER            PIC  X(0003).
  4875     05  CPREM1O PIC  ZZZZZZ9.99-.
  4876*    -------------------------------
  4877     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page  91
* EL6311.cbl
  4878     05  CTERM2O PIC  ZZ9.
  4879*    -------------------------------
  4880     05  FILLER            PIC  X(0003).
  4881     05  CRTERM2O PIC  ZZ9.
  4882*    -------------------------------
  4883     05  FILLER            PIC  X(0003).
  4884     05  CPREM2O PIC  ZZZZZZ9.99-.
  4885*    -------------------------------
  4886     05  FILLER            PIC  X(0003).
  4887     05  CENTRDTO PIC  X(0008).
  4888*    -------------------------------
  4889     05  FILLER            PIC  X(0003).
  4890     05  CPAYEEO PIC  X(0006).
  4891*    -------------------------------
  4892     05  FILLER            PIC  X(0003).
  4893     05  CRFNDSWO PIC  X(0003).
  4894*    -------------------------------
  4895     05  FILLER            PIC  X(0003).
  4896     05  CLFHDGO PIC  X(0006).
  4897*    -------------------------------
  4898     05  FILLER            PIC  X(0003).
  4899     05  CAHHDGO PIC  X(0006).
  4900*    -------------------------------
  4901     05  FILLER            PIC  X(0003).
  4902     05  CENTDTO PIC  X(0008).
  4903*    -------------------------------
  4904     05  FILLER            PIC  X(0003).
  4905     05  CENTBYO PIC  X(0004).
  4906*    -------------------------------
  4907     05  FILLER            PIC  X(0003).
  4908     05  CCHGCNTO PIC  X(0003).
  4909*    -------------------------------
  4910     05  FILLER            PIC  X(0003).
  4911     05  CLFREFNO PIC  X(0006).
  4912*    -------------------------------
  4913     05  FILLER            PIC  X(0003).
  4914     05  CAHREFNO PIC  X(0006).
  4915*    -------------------------------
  4916     05  FILLER            PIC  X(0003).
  4917     05  CREINCDO PIC  X(0003).
  4918*    -------------------------------
  4919     05  FILLER            PIC  X(0003).
  4920     05  CAEFFDTO PIC  X(0008).
  4921*    -------------------------------
  4922     05  FILLER            PIC  X(0003).
  4923     05  CAEXPDTO PIC  X(0008).
  4924*    -------------------------------
  4925     05  FILLER            PIC  X(0003).
  4926     05  COMMLFO PIC  .99999.
  4927*    -------------------------------
  4928     05  FILLER            PIC  X(0003).
  4929     05  COMMAHO PIC  .99999.
  4930*    -------------------------------
  4931     05  FILLER            PIC  X(0003).
  4932     05  CERMSG1O PIC  X(0078).
  4933*    -------------------------------
  4934     05  FILLER            PIC  X(0003).
  4935     05  CERMSG2O PIC  X(0078).
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page  92
* EL6311.cbl
  4936*    -------------------------------
  4937     05  FILLER            PIC  X(0003).
  4938     05  CERMSG3O PIC  X(0078).
  4939*    -------------------------------
  4940     05  FILLER            PIC  X(0003).
  4941     05  CPFENTRO PIC  X(0002).
  4942*    -------------------------------
  4943     05  FILLER            PIC  X(0003).
  4944     05  CPF5HDRO PIC  X(0005).
  4945*    -------------------------------
  4946     05  FILLER            PIC  X(0003).
  4947     05  CPF4HDRO PIC  X(0013).
  4948*    -------------------------------
  4949     05  FILLER            PIC  X(0003).
  4950     05  CF15HDRO PIC  X(0022).
  4951*    -------------------------------
  4952 01  EL631DI REDEFINES EL631BI.
  4953     05  FILLER            PIC  X(0012).
  4954*    -------------------------------
  4955     05  DDATEL PIC S9(0004) COMP.
  4956     05  DDATEF PIC  X(0001).
  4957     05  FILLER REDEFINES DDATEF.
  4958         10  DDATEA PIC  X(0001).
  4959     05  DDATEI PIC  X(0008).
  4960*    -------------------------------
  4961     05  DTIMEL PIC S9(0004) COMP.
  4962     05  DTIMEF PIC  X(0001).
  4963     05  FILLER REDEFINES DTIMEF.
  4964         10  DTIMEA PIC  X(0001).
  4965     05  DTIMEI PIC  X(0005).
  4966*    -------------------------------
  4967     05  DHEADL PIC S9(0004) COMP.
  4968     05  DHEADF PIC  X(0001).
  4969     05  FILLER REDEFINES DHEADF.
  4970         10  DHEADA PIC  X(0001).
  4971     05  DHEADI PIC  X(0038).
  4972*    -------------------------------
  4973     05  DLDATEL PIC S9(0004) COMP.
  4974     05  DLDATEF PIC  X(0001).
  4975     05  FILLER REDEFINES DLDATEF.
  4976         10  DLDATEA PIC  X(0001).
  4977     05  DLDATEI PIC  X(0010).
  4978*    -------------------------------
  4979     05  DBATCHL PIC S9(0004) COMP.
  4980     05  DBATCHF PIC  X(0001).
  4981     05  FILLER REDEFINES DBATCHF.
  4982         10  DBATCHA PIC  X(0001).
  4983     05  DBATCHI PIC  X(0011).
  4984*    -------------------------------
  4985     05  DACCTNML PIC S9(0004) COMP.
  4986     05  DACCTNMF PIC  X(0001).
  4987     05  FILLER REDEFINES DACCTNMF.
  4988         10  DACCTNMA PIC  X(0001).
  4989     05  DACCTNMI PIC  X(0030).
  4990*    -------------------------------
  4991     05  DPROCDTL PIC S9(0004) COMP.
  4992     05  DPROCDTF PIC  X(0001).
  4993     05  FILLER REDEFINES DPROCDTF.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page  93
* EL6311.cbl
  4994         10  DPROCDTA PIC  X(0001).
  4995     05  DPROCDTI PIC  X(0008).
  4996*    -------------------------------
  4997     05  DINPUTL PIC S9(0004) COMP.
  4998     05  DINPUTF PIC  X(0001).
  4999     05  FILLER REDEFINES DINPUTF.
  5000         10  DINPUTA PIC  X(0001).
  5001     05  DINPUTI PIC  X(0008).
  5002*    -------------------------------
  5003     05  DMAINDTL PIC S9(0004) COMP.
  5004     05  DMAINDTF PIC  X(0001).
  5005     05  FILLER REDEFINES DMAINDTF.
  5006         10  DMAINDTA PIC  X(0001).
  5007     05  DMAINDTI PIC  X(0008).
  5008*    -------------------------------
  5009     05  DCARRL PIC S9(0004) COMP.
  5010     05  DCARRF PIC  X(0001).
  5011     05  FILLER REDEFINES DCARRF.
  5012         10  DCARRA PIC  X(0001).
  5013     05  DCARRI PIC  X(0001).
  5014*    -------------------------------
  5015     05  DGROUPL PIC S9(0004) COMP.
  5016     05  DGROUPF PIC  X(0001).
  5017     05  FILLER REDEFINES DGROUPF.
  5018         10  DGROUPA PIC  X(0001).
  5019     05  DGROUPI PIC  X(0006).
  5020*    -------------------------------
  5021     05  DSTATEL PIC S9(0004) COMP.
  5022     05  DSTATEF PIC  X(0001).
  5023     05  FILLER REDEFINES DSTATEF.
  5024         10  DSTATEA PIC  X(0001).
  5025     05  DSTATEI PIC  X(0002).
  5026*    -------------------------------
  5027     05  DACCTL PIC S9(0004) COMP.
  5028     05  DACCTF PIC  X(0001).
  5029     05  FILLER REDEFINES DACCTF.
  5030         10  DACCTA PIC  X(0001).
  5031     05  DACCTI PIC  X(0010).
  5032*    -------------------------------
  5033     05  DRECVDTL PIC S9(0004) COMP.
  5034     05  DRECVDTF PIC  X(0001).
  5035     05  FILLER REDEFINES DRECVDTF.
  5036         10  DRECVDTA PIC  X(0001).
  5037     05  DRECVDTI PIC  X(0008).
  5038*    -------------------------------
  5039     05  DCSRL PIC S9(0004) COMP.
  5040     05  DCSRF PIC  X(0001).
  5041     05  FILLER REDEFINES DCSRF.
  5042         10  DCSRA PIC  X(0001).
  5043     05  DCSRI PIC  X(0004).
  5044*    -------------------------------
  5045     05  DREFHDGL PIC S9(0004) COMP.
  5046     05  DREFHDGF PIC  X(0001).
  5047     05  FILLER REDEFINES DREFHDGF.
  5048         10  DREFHDGA PIC  X(0001).
  5049     05  DREFHDGI PIC  X(0010).
  5050*    -------------------------------
  5051     05  DREFL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page  94
* EL6311.cbl
  5052     05  DREFF PIC  X(0001).
  5053     05  FILLER REDEFINES DREFF.
  5054         10  DREFA PIC  X(0001).
  5055     05  DREFI PIC  X(0012).
  5056*    -------------------------------
  5057     05  DLFPHDGL PIC S9(0004) COMP.
  5058     05  DLFPHDGF PIC  X(0001).
  5059     05  FILLER REDEFINES DLFPHDGF.
  5060         10  DLFPHDGA PIC  X(0001).
  5061     05  DLFPHDGI PIC  X(0010).
  5062*    -------------------------------
  5063     05  DAHPHDGL PIC S9(0004) COMP.
  5064     05  DAHPHDGF PIC  X(0001).
  5065     05  FILLER REDEFINES DAHPHDGF.
  5066         10  DAHPHDGA PIC  X(0001).
  5067     05  DAHPHDGI PIC  X(0010).
  5068*    -------------------------------
  5069     05  DLFRHDGL PIC S9(0004) COMP.
  5070     05  DLFRHDGF PIC  X(0001).
  5071     05  FILLER REDEFINES DLFRHDGF.
  5072         10  DLFRHDGA PIC  X(0001).
  5073     05  DLFRHDGI PIC  X(0009).
  5074*    -------------------------------
  5075     05  DAHRHDGL PIC S9(0004) COMP.
  5076     05  DAHRHDGF PIC  X(0001).
  5077     05  FILLER REDEFINES DAHRHDGF.
  5078         10  DAHRHDGA PIC  X(0001).
  5079     05  DAHRHDGI PIC  X(0009).
  5080*    -------------------------------
  5081     05  DRISSL PIC S9(0004) COMP.
  5082     05  DRISSF PIC  X(0001).
  5083     05  FILLER REDEFINES DRISSF.
  5084         10  DRISSA PIC  X(0001).
  5085     05  DRISSI PIC  X(0005).
  5086*    -------------------------------
  5087     05  DRLFPRML PIC S9(0004) COMP.
  5088     05  DRLFPRMF PIC  X(0001).
  5089     05  FILLER REDEFINES DRLFPRMF.
  5090         10  DRLFPRMA PIC  X(0001).
  5091     05  DRLFPRMI PIC  S9(9)V99.
  5092*    -------------------------------
  5093     05  DRAHPRML PIC S9(0004) COMP.
  5094     05  DRAHPRMF PIC  X(0001).
  5095     05  FILLER REDEFINES DRAHPRMF.
  5096         10  DRAHPRMA PIC  X(0001).
  5097     05  DRAHPRMI PIC  S9(9)V99.
  5098*    -------------------------------
  5099     05  DRCANCL PIC S9(0004) COMP.
  5100     05  DRCANCF PIC  X(0001).
  5101     05  FILLER REDEFINES DRCANCF.
  5102         10  DRCANCA PIC  X(0001).
  5103     05  DRCANCI PIC  X(0005).
  5104*    -------------------------------
  5105     05  DRLFRFDL PIC S9(0004) COMP.
  5106     05  DRLFRFDF PIC  X(0001).
  5107     05  FILLER REDEFINES DRLFRFDF.
  5108         10  DRLFRFDA PIC  X(0001).
  5109     05  DRLFRFDI PIC  S9(9)V99.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page  95
* EL6311.cbl
  5110*    -------------------------------
  5111     05  DRAHRFDL PIC S9(0004) COMP.
  5112     05  DRAHRFDF PIC  X(0001).
  5113     05  FILLER REDEFINES DRAHRFDF.
  5114         10  DRAHRFDA PIC  X(0001).
  5115     05  DRAHRFDI PIC  S9(9)V99.
  5116*    -------------------------------
  5117     05  DEISSL PIC S9(0004) COMP.
  5118     05  DEISSF PIC  X(0001).
  5119     05  FILLER REDEFINES DEISSF.
  5120         10  DEISSA PIC  X(0001).
  5121     05  DEISSI PIC  X(0005).
  5122*    -------------------------------
  5123     05  DELFPRML PIC S9(0004) COMP.
  5124     05  DELFPRMF PIC  X(0001).
  5125     05  FILLER REDEFINES DELFPRMF.
  5126         10  DELFPRMA PIC  X(0001).
  5127     05  DELFPRMI PIC  X(0011).
  5128*    -------------------------------
  5129     05  DEAHPRML PIC S9(0004) COMP.
  5130     05  DEAHPRMF PIC  X(0001).
  5131     05  FILLER REDEFINES DEAHPRMF.
  5132         10  DEAHPRMA PIC  X(0001).
  5133     05  DEAHPRMI PIC  X(0011).
  5134*    -------------------------------
  5135     05  DECANCL PIC S9(0004) COMP.
  5136     05  DECANCF PIC  X(0001).
  5137     05  FILLER REDEFINES DECANCF.
  5138         10  DECANCA PIC  X(0001).
  5139     05  DECANCI PIC  X(0005).
  5140*    -------------------------------
  5141     05  DELFRFDL PIC S9(0004) COMP.
  5142     05  DELFRFDF PIC  X(0001).
  5143     05  FILLER REDEFINES DELFRFDF.
  5144         10  DELFRFDA PIC  X(0001).
  5145     05  DELFRFDI PIC  X(0011).
  5146*    -------------------------------
  5147     05  DEAHRFDL PIC S9(0004) COMP.
  5148     05  DEAHRFDF PIC  X(0001).
  5149     05  FILLER REDEFINES DEAHRFDF.
  5150         10  DEAHRFDA PIC  X(0001).
  5151     05  DEAHRFDI PIC  X(0011).
  5152*    -------------------------------
  5153     05  DCISSL PIC S9(0004) COMP.
  5154     05  DCISSF PIC  X(0001).
  5155     05  FILLER REDEFINES DCISSF.
  5156         10  DCISSA PIC  X(0001).
  5157     05  DCISSI PIC  X(0005).
  5158*    -------------------------------
  5159     05  DCLFPRML PIC S9(0004) COMP.
  5160     05  DCLFPRMF PIC  X(0001).
  5161     05  FILLER REDEFINES DCLFPRMF.
  5162         10  DCLFPRMA PIC  X(0001).
  5163     05  DCLFPRMI PIC  X(0011).
  5164*    -------------------------------
  5165     05  DCAHPRML PIC S9(0004) COMP.
  5166     05  DCAHPRMF PIC  X(0001).
  5167     05  FILLER REDEFINES DCAHPRMF.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page  96
* EL6311.cbl
  5168         10  DCAHPRMA PIC  X(0001).
  5169     05  DCAHPRMI PIC  X(0011).
  5170*    -------------------------------
  5171     05  DCCANCL PIC S9(0004) COMP.
  5172     05  DCCANCF PIC  X(0001).
  5173     05  FILLER REDEFINES DCCANCF.
  5174         10  DCCANCA PIC  X(0001).
  5175     05  DCCANCI PIC  X(0005).
  5176*    -------------------------------
  5177     05  DCLFRFDL PIC S9(0004) COMP.
  5178     05  DCLFRFDF PIC  X(0001).
  5179     05  FILLER REDEFINES DCLFRFDF.
  5180         10  DCLFRFDA PIC  X(0001).
  5181     05  DCLFRFDI PIC  X(0011).
  5182*    -------------------------------
  5183     05  DCAHRFDL PIC S9(0004) COMP.
  5184     05  DCAHRFDF PIC  X(0001).
  5185     05  FILLER REDEFINES DCAHRFDF.
  5186         10  DCAHRFDA PIC  X(0001).
  5187     05  DCAHRFDI PIC  X(0011).
  5188*    -------------------------------
  5189     05  DOISSL PIC S9(0004) COMP.
  5190     05  DOISSF PIC  X(0001).
  5191     05  FILLER REDEFINES DOISSF.
  5192         10  DOISSA PIC  X(0001).
  5193     05  DOISSI PIC  X(0005).
  5194*    -------------------------------
  5195     05  DOLFPRML PIC S9(0004) COMP.
  5196     05  DOLFPRMF PIC  X(0001).
  5197     05  FILLER REDEFINES DOLFPRMF.
  5198         10  DOLFPRMA PIC  X(0001).
  5199     05  DOLFPRMI PIC  X(0011).
  5200*    -------------------------------
  5201     05  DOAHPRML PIC S9(0004) COMP.
  5202     05  DOAHPRMF PIC  X(0001).
  5203     05  FILLER REDEFINES DOAHPRMF.
  5204         10  DOAHPRMA PIC  X(0001).
  5205     05  DOAHPRMI PIC  X(0011).
  5206*    -------------------------------
  5207     05  DOCANCL PIC S9(0004) COMP.
  5208     05  DOCANCF PIC  X(0001).
  5209     05  FILLER REDEFINES DOCANCF.
  5210         10  DOCANCA PIC  X(0001).
  5211     05  DOCANCI PIC  X(0005).
  5212*    -------------------------------
  5213     05  DOLFRFDL PIC S9(0004) COMP.
  5214     05  DOLFRFDF PIC  X(0001).
  5215     05  FILLER REDEFINES DOLFRFDF.
  5216         10  DOLFRFDA PIC  X(0001).
  5217     05  DOLFRFDI PIC  X(0011).
  5218*    -------------------------------
  5219     05  DOAHRFDL PIC S9(0004) COMP.
  5220     05  DOAHRFDF PIC  X(0001).
  5221     05  FILLER REDEFINES DOAHRFDF.
  5222         10  DOAHRFDA PIC  X(0001).
  5223     05  DOAHRFDI PIC  X(0011).
  5224*    -------------------------------
  5225     05  DITOTALL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page  97
* EL6311.cbl
  5226     05  DITOTALF PIC  X(0001).
  5227     05  FILLER REDEFINES DITOTALF.
  5228         10  DITOTALA PIC  X(0001).
  5229     05  DITOTALI PIC  X(0005).
  5230*    -------------------------------
  5231     05  DIFATALL PIC S9(0004) COMP.
  5232     05  DIFATALF PIC  X(0001).
  5233     05  FILLER REDEFINES DIFATALF.
  5234         10  DIFATALA PIC  X(0001).
  5235     05  DIFATALI PIC  X(0005).
  5236*    -------------------------------
  5237     05  DIFORCEL PIC S9(0004) COMP.
  5238     05  DIFORCEF PIC  X(0001).
  5239     05  FILLER REDEFINES DIFORCEF.
  5240         10  DIFORCEA PIC  X(0001).
  5241     05  DIFORCEI PIC  X(0005).
  5242*    -------------------------------
  5243     05  DIHOLDL PIC S9(0004) COMP.
  5244     05  DIHOLDF PIC  X(0001).
  5245     05  FILLER REDEFINES DIHOLDF.
  5246         10  DIHOLDA PIC  X(0001).
  5247     05  DIHOLDI PIC  X(0005).
  5248*    -------------------------------
  5249     05  DIAVAILL PIC S9(0004) COMP.
  5250     05  DIAVAILF PIC  X(0001).
  5251     05  FILLER REDEFINES DIAVAILF.
  5252         10  DIAVAILA PIC  X(0001).
  5253     05  DIAVAILI PIC  X(0005).
  5254*    -------------------------------
  5255     05  DIGPREML PIC S9(0004) COMP.
  5256     05  DIGPREMF PIC  X(0001).
  5257     05  FILLER REDEFINES DIGPREMF.
  5258         10  DIGPREMA PIC  X(0001).
  5259     05  DIGPREMI PIC  X(0011).
  5260*    -------------------------------
  5261     05  DIBPREML PIC S9(0004) COMP.
  5262     05  DIBPREMF PIC  X(0001).
  5263     05  FILLER REDEFINES DIBPREMF.
  5264         10  DIBPREMA PIC  X(0001).
  5265     05  DIBPREMI PIC  X(0011).
  5266*    -------------------------------
  5267     05  DCTOTALL PIC S9(0004) COMP.
  5268     05  DCTOTALF PIC  X(0001).
  5269     05  FILLER REDEFINES DCTOTALF.
  5270         10  DCTOTALA PIC  X(0001).
  5271     05  DCTOTALI PIC  X(0005).
  5272*    -------------------------------
  5273     05  DCFATALL PIC S9(0004) COMP.
  5274     05  DCFATALF PIC  X(0001).
  5275     05  FILLER REDEFINES DCFATALF.
  5276         10  DCFATALA PIC  X(0001).
  5277     05  DCFATALI PIC  X(0005).
  5278*    -------------------------------
  5279     05  DCFORCEL PIC S9(0004) COMP.
  5280     05  DCFORCEF PIC  X(0001).
  5281     05  FILLER REDEFINES DCFORCEF.
  5282         10  DCFORCEA PIC  X(0001).
  5283     05  DCFORCEI PIC  X(0005).
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page  98
* EL6311.cbl
  5284*    -------------------------------
  5285     05  DCHOLDL PIC S9(0004) COMP.
  5286     05  DCHOLDF PIC  X(0001).
  5287     05  FILLER REDEFINES DCHOLDF.
  5288         10  DCHOLDA PIC  X(0001).
  5289     05  DCHOLDI PIC  X(0005).
  5290*    -------------------------------
  5291     05  DCAVAILL PIC S9(0004) COMP.
  5292     05  DCAVAILF PIC  X(0001).
  5293     05  FILLER REDEFINES DCAVAILF.
  5294         10  DCAVAILA PIC  X(0001).
  5295     05  DCAVAILI PIC  X(0005).
  5296*    -------------------------------
  5297     05  DCGPREML PIC S9(0004) COMP.
  5298     05  DCGPREMF PIC  X(0001).
  5299     05  FILLER REDEFINES DCGPREMF.
  5300         10  DCGPREMA PIC  X(0001).
  5301     05  DCGPREMI PIC  X(0011).
  5302*    -------------------------------
  5303     05  DCBPREML PIC S9(0004) COMP.
  5304     05  DCBPREMF PIC  X(0001).
  5305     05  FILLER REDEFINES DCBPREMF.
  5306         10  DCBPREMA PIC  X(0001).
  5307     05  DCBPREMI PIC  X(0011).
  5308*    -------------------------------
  5309     05  DNTOTALL PIC S9(0004) COMP.
  5310     05  DNTOTALF PIC  X(0001).
  5311     05  FILLER REDEFINES DNTOTALF.
  5312         10  DNTOTALA PIC  X(0001).
  5313     05  DNTOTALI PIC  X(0005).
  5314*    -------------------------------
  5315     05  DNFATALL PIC S9(0004) COMP.
  5316     05  DNFATALF PIC  X(0001).
  5317     05  FILLER REDEFINES DNFATALF.
  5318         10  DNFATALA PIC  X(0001).
  5319     05  DNFATALI PIC  X(0005).
  5320*    -------------------------------
  5321     05  DNFORCEL PIC S9(0004) COMP.
  5322     05  DNFORCEF PIC  X(0001).
  5323     05  FILLER REDEFINES DNFORCEF.
  5324         10  DNFORCEA PIC  X(0001).
  5325     05  DNFORCEI PIC  X(0005).
  5326*    -------------------------------
  5327     05  DNHOLDL PIC S9(0004) COMP.
  5328     05  DNHOLDF PIC  X(0001).
  5329     05  FILLER REDEFINES DNHOLDF.
  5330         10  DNHOLDA PIC  X(0001).
  5331     05  DNHOLDI PIC  X(0005).
  5332*    -------------------------------
  5333     05  DNAVAILL PIC S9(0004) COMP.
  5334     05  DNAVAILF PIC  X(0001).
  5335     05  FILLER REDEFINES DNAVAILF.
  5336         10  DNAVAILA PIC  X(0001).
  5337     05  DNAVAILI PIC  X(0005).
  5338*    -------------------------------
  5339     05  DNGPREML PIC S9(0004) COMP.
  5340     05  DNGPREMF PIC  X(0001).
  5341     05  FILLER REDEFINES DNGPREMF.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page  99
* EL6311.cbl
  5342         10  DNGPREMA PIC  X(0001).
  5343     05  DNGPREMI PIC  X(0011).
  5344*    -------------------------------
  5345     05  DNBPREML PIC S9(0004) COMP.
  5346     05  DNBPREMF PIC  X(0001).
  5347     05  FILLER REDEFINES DNBPREMF.
  5348         10  DNBPREMA PIC  X(0001).
  5349     05  DNBPREMI PIC  X(0011).
  5350*    -------------------------------
  5351     05  DERMSGL PIC S9(0004) COMP.
  5352     05  DERMSGF PIC  X(0001).
  5353     05  FILLER REDEFINES DERMSGF.
  5354         10  DERMSGA PIC  X(0001).
  5355     05  DERMSGI PIC  X(0075).
  5356*    -------------------------------
  5357     05  DPFENTRL PIC S9(0004) COMP.
  5358     05  DPFENTRF PIC  X(0001).
  5359     05  FILLER REDEFINES DPFENTRF.
  5360         10  DPFENTRA PIC  X(0001).
  5361     05  DPFENTRI PIC  9(2).
  5362 01  EL631DO REDEFINES EL631BI.
  5363     05  FILLER            PIC  X(0012).
  5364*    -------------------------------
  5365     05  FILLER            PIC  X(0003).
  5366     05  DDATEO PIC  X(0008).
  5367*    -------------------------------
  5368     05  FILLER            PIC  X(0003).
  5369     05  DTIMEO PIC  99.99.
  5370*    -------------------------------
  5371     05  FILLER            PIC  X(0003).
  5372     05  DHEADO PIC  X(0038).
  5373*    -------------------------------
  5374     05  FILLER            PIC  X(0003).
  5375     05  DLDATEO PIC  X(0010).
  5376*    -------------------------------
  5377     05  FILLER            PIC  X(0003).
  5378     05  DBATCHO PIC  X(0011).
  5379*    -------------------------------
  5380     05  FILLER            PIC  X(0003).
  5381     05  DACCTNMO PIC  X(0030).
  5382*    -------------------------------
  5383     05  FILLER            PIC  X(0003).
  5384     05  DPROCDTO PIC  X(0008).
  5385*    -------------------------------
  5386     05  FILLER            PIC  X(0003).
  5387     05  DINPUTO PIC  X(0008).
  5388*    -------------------------------
  5389     05  FILLER            PIC  X(0003).
  5390     05  DMAINDTO PIC  X(0008).
  5391*    -------------------------------
  5392     05  FILLER            PIC  X(0003).
  5393     05  DCARRO PIC  X(0001).
  5394*    -------------------------------
  5395     05  FILLER            PIC  X(0003).
  5396     05  DGROUPO PIC  X(0006).
  5397*    -------------------------------
  5398     05  FILLER            PIC  X(0003).
  5399     05  DSTATEO PIC  X(0002).
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 100
* EL6311.cbl
  5400*    -------------------------------
  5401     05  FILLER            PIC  X(0003).
  5402     05  DACCTO PIC  X(0010).
  5403*    -------------------------------
  5404     05  FILLER            PIC  X(0003).
  5405     05  DRECVDTO PIC  X(0008).
  5406*    -------------------------------
  5407     05  FILLER            PIC  X(0003).
  5408     05  DCSRO PIC  X(0004).
  5409*    -------------------------------
  5410     05  FILLER            PIC  X(0003).
  5411     05  DREFHDGO PIC  X(0010).
  5412*    -------------------------------
  5413     05  FILLER            PIC  X(0003).
  5414     05  DREFO PIC  X(0012).
  5415*    -------------------------------
  5416     05  FILLER            PIC  X(0003).
  5417     05  DLFPHDGO PIC  X(0010).
  5418*    -------------------------------
  5419     05  FILLER            PIC  X(0003).
  5420     05  DAHPHDGO PIC  X(0010).
  5421*    -------------------------------
  5422     05  FILLER            PIC  X(0003).
  5423     05  DLFRHDGO PIC  X(0009).
  5424*    -------------------------------
  5425     05  FILLER            PIC  X(0003).
  5426     05  DAHRHDGO PIC  X(0009).
  5427*    -------------------------------
  5428     05  FILLER            PIC  X(0003).
  5429     05  DRISSO PIC  ZZ99-.
  5430*    -------------------------------
  5431     05  FILLER            PIC  X(0003).
  5432     05  DRLFPRMO PIC  ZZZZZZ9.99-.
  5433*    -------------------------------
  5434     05  FILLER            PIC  X(0003).
  5435     05  DRAHPRMO PIC  ZZZZZZ9.99-.
  5436*    -------------------------------
  5437     05  FILLER            PIC  X(0003).
  5438     05  DRCANCO PIC  ZZ99-.
  5439*    -------------------------------
  5440     05  FILLER            PIC  X(0003).
  5441     05  DRLFRFDO PIC  ZZZZZZ9.99-.
  5442*    -------------------------------
  5443     05  FILLER            PIC  X(0003).
  5444     05  DRAHRFDO PIC  ZZZZZZ9.99-.
  5445*    -------------------------------
  5446     05  FILLER            PIC  X(0003).
  5447     05  DEISSO PIC  ZZ99-.
  5448*    -------------------------------
  5449     05  FILLER            PIC  X(0003).
  5450     05  DELFPRMO PIC  ZZZZZZ9.99-.
  5451*    -------------------------------
  5452     05  FILLER            PIC  X(0003).
  5453     05  DEAHPRMO PIC  ZZZZZZ9.99-.
  5454*    -------------------------------
  5455     05  FILLER            PIC  X(0003).
  5456     05  DECANCO PIC  ZZ99-.
  5457*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 101
* EL6311.cbl
  5458     05  FILLER            PIC  X(0003).
  5459     05  DELFRFDO PIC  ZZZZZZ9.99-.
  5460*    -------------------------------
  5461     05  FILLER            PIC  X(0003).
  5462     05  DEAHRFDO PIC  ZZZZZZ9.99-.
  5463*    -------------------------------
  5464     05  FILLER            PIC  X(0003).
  5465     05  DCISSO PIC  ZZ99-.
  5466*    -------------------------------
  5467     05  FILLER            PIC  X(0003).
  5468     05  DCLFPRMO PIC  ZZZZZZ9.99-.
  5469*    -------------------------------
  5470     05  FILLER            PIC  X(0003).
  5471     05  DCAHPRMO PIC  ZZZZZZ9.99-.
  5472*    -------------------------------
  5473     05  FILLER            PIC  X(0003).
  5474     05  DCCANCO PIC  ZZ99-.
  5475*    -------------------------------
  5476     05  FILLER            PIC  X(0003).
  5477     05  DCLFRFDO PIC  ZZZZZZ9.99-.
  5478*    -------------------------------
  5479     05  FILLER            PIC  X(0003).
  5480     05  DCAHRFDO PIC  ZZZZZZ9.99-.
  5481*    -------------------------------
  5482     05  FILLER            PIC  X(0003).
  5483     05  DOISSO PIC  ZZ99-.
  5484*    -------------------------------
  5485     05  FILLER            PIC  X(0003).
  5486     05  DOLFPRMO PIC  ZZZZZZ9.99-.
  5487*    -------------------------------
  5488     05  FILLER            PIC  X(0003).
  5489     05  DOAHPRMO PIC  ZZZZZZ9.99-.
  5490*    -------------------------------
  5491     05  FILLER            PIC  X(0003).
  5492     05  DOCANCO PIC  ZZ99-.
  5493*    -------------------------------
  5494     05  FILLER            PIC  X(0003).
  5495     05  DOLFRFDO PIC  ZZZZZZ9.99-.
  5496*    -------------------------------
  5497     05  FILLER            PIC  X(0003).
  5498     05  DOAHRFDO PIC  ZZZZZZ9.99-.
  5499*    -------------------------------
  5500     05  FILLER            PIC  X(0003).
  5501     05  DITOTALO PIC  ZZZ99.
  5502*    -------------------------------
  5503     05  FILLER            PIC  X(0003).
  5504     05  DIFATALO PIC  ZZZ99.
  5505*    -------------------------------
  5506     05  FILLER            PIC  X(0003).
  5507     05  DIFORCEO PIC  ZZZ99.
  5508*    -------------------------------
  5509     05  FILLER            PIC  X(0003).
  5510     05  DIHOLDO PIC  ZZZ99.
  5511*    -------------------------------
  5512     05  FILLER            PIC  X(0003).
  5513     05  DIAVAILO PIC  ZZZ99.
  5514*    -------------------------------
  5515     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 102
* EL6311.cbl
  5516     05  DIGPREMO PIC  ZZZZZZZ9.99.
  5517*    -------------------------------
  5518     05  FILLER            PIC  X(0003).
  5519     05  DIBPREMO PIC  ZZZZZZZ9.99.
  5520*    -------------------------------
  5521     05  FILLER            PIC  X(0003).
  5522     05  DCTOTALO PIC  ZZZ99.
  5523*    -------------------------------
  5524     05  FILLER            PIC  X(0003).
  5525     05  DCFATALO PIC  ZZZ99.
  5526*    -------------------------------
  5527     05  FILLER            PIC  X(0003).
  5528     05  DCFORCEO PIC  ZZZ99.
  5529*    -------------------------------
  5530     05  FILLER            PIC  X(0003).
  5531     05  DCHOLDO PIC  ZZZ99.
  5532*    -------------------------------
  5533     05  FILLER            PIC  X(0003).
  5534     05  DCAVAILO PIC  ZZZ99.
  5535*    -------------------------------
  5536     05  FILLER            PIC  X(0003).
  5537     05  DCGPREMO PIC  ZZZZZZZ9.99.
  5538*    -------------------------------
  5539     05  FILLER            PIC  X(0003).
  5540     05  DCBPREMO PIC  ZZZZZZZ9.99.
  5541*    -------------------------------
  5542     05  FILLER            PIC  X(0003).
  5543     05  DNTOTALO PIC  ---99.
  5544*    -------------------------------
  5545     05  FILLER            PIC  X(0003).
  5546     05  DNFATALO PIC  ---99.
  5547*    -------------------------------
  5548     05  FILLER            PIC  X(0003).
  5549     05  DNFORCEO PIC  ---99.
  5550*    -------------------------------
  5551     05  FILLER            PIC  X(0003).
  5552     05  DNHOLDO PIC  ---99.
  5553*    -------------------------------
  5554     05  FILLER            PIC  X(0003).
  5555     05  DNAVAILO PIC  ---99.
  5556*    -------------------------------
  5557     05  FILLER            PIC  X(0003).
  5558     05  DNGPREMO PIC  -------9.99.
  5559*    -------------------------------
  5560     05  FILLER            PIC  X(0003).
  5561     05  DNBPREMO PIC  -------9.99.
  5562*    -------------------------------
  5563     05  FILLER            PIC  X(0003).
  5564     05  DERMSGO PIC  X(0075).
  5565*    -------------------------------
  5566     05  FILLER            PIC  X(0003).
  5567     05  DPFENTRO PIC  X(0002).
  5568*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 103
* EL6311.cbl
  5570 01  MAP-B REDEFINES EL631BI.
  5571     12  FILLER                  PIC X(569).
  5572*    12  FILLER                  PIC X(512).
  5573*    12  FILLER                  PIC X(510).
  5574     12  MAP-B-COVERAGE OCCURS 2 TIMES.
  5575         16  BKIND-LEN               PIC S9(4)  COMP.
  5576         16  BKIND-ATTRB             PIC X.
  5577         16  BKIND                   PIC XX.
  5578         16  BTYPE-LEN               PIC S9(4)  COMP.
  5579         16  BTYPE-ATTRB             PIC X.
  5580         16  BTYPE                   PIC X(3).
  5581         16  BTERM-LEN               PIC S9(4)  COMP.
  5582         16  BTERM-ATTRB             PIC X.
  5583         16  BTERMI                  PIC 999.
  5584         16  BTERMO REDEFINES BTERMI PIC ZZZ.
  5585         16  BBEN-LEN                PIC S9(4)  COMP.
  5586         16  BBEN-ATTRB              PIC X.
  5587         16  BBENI                   PIC 9(10)V99.
  5588*        16  BBENI                   PIC 9(12).
  5589         16  BBENO REDEFINES BBENI   PIC Z(9).99.
  5590         16  BPREM-LEN               PIC S9(4)  COMP.
  5591         16  BPREM-ATTRB             PIC X.
  5592         16  BPREMI                  PIC S9(9)V99.
  5593*        16  BPREMI                  PIC 9(11).
  5594         16  BPREMO REDEFINES BPREMI PIC Z(7).99-.
  5595         16  BPREM-ALPHA REDEFINES BPREMI PIC X(11).
  5596         16  BEXPIRE-LEN             PIC S9(4)  COMP.
  5597         16  BEXPIRE-ATTRB           PIC X.
  5598         16  BEXPIRE                 PIC X(8).
  5599         16  BCRIT-PERD-LEN          PIC S9(4)  COMP.
  5600         16  BCRIT-PERD-ATTRB        PIC X.
  5601         16  BCRIT-PERDI             PIC 99.
  5602         16  BCRIT-PERDO REDEFINES
  5603                         BCRIT-PERDI PIC ZZ.
  5604         16  BALT-BEN-LEN            PIC S9(4)  COMP.
  5605         16  BALT-BEN-ATTRB          PIC X.
  5606         16  BALT-BENI               PIC 9(10)V99.
  5607*        16  BALT-BENI               PIC 9(12).
  5608         16  BALT-BENO REDEFINES
  5609                           BALT-BENI PIC Z(9).ZZ.
  5610         16  BALT-PREM-LEN           PIC S9(4)  COMP.
  5611         16  BALT-PREM-ATTRB         PIC X.
  5612         16  BALT-PREMI              PIC 9(9)V99.
  5613*        16  BALT-PREMI              PIC 9(11).
  5614         16  BALT-PREMO REDEFINES
  5615                          BALT-PREMI PIC Z(7).ZZ-.
  5616         16  BBEN-CD-LEN             PIC S9(4)  COMP.
  5617         16  BBEN-CD-ATTRB           PIC X.
  5618         16  BBEN-CD                 PIC XXX.
  5619         16  BCPREM-LEN              PIC S9(4)  COMP.
  5620         16  BCPREM-ATTRB            PIC X.
  5621         16  BCPREMI                 PIC S9(9)V99.
  5622*        16  BCPREMI                 PIC X(11).
  5623         16  BCPREMO REDEFINES BCPREMI
  5624                                     PIC Z(7).99-.
  5625         16  BCALT-PREM-LEN          PIC S9(4)  COMP.
  5626         16  BCALT-PREM-ATTRB        PIC X.
  5627         16  BCALT-PREM              PIC Z(7).99-.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 104
* EL6311.cbl
  5628         16  BBEN-ABBR-LEN           PIC S9(4)  COMP.
  5629         16  BBEN-ABBR-ATTRB         PIC X.
  5630         16  BBEN-ABBR               PIC X(5).
  5631         16  BDIFF-LEN               PIC S9(4)  COMP.
  5632         16  BDIFF-ATTRB             PIC X.
  5633         16  BDIFFO                  PIC Z(7).99-.
  5634         16  BBILL-LIT-LEN           PIC S9(4)  COMP.
  5635         16  BBILL-LIT-ATTRB         PIC X.
  5636         16  BBILL-LIT               PIC X(8).
  5637         16  BDALT-PREM-LEN          PIC S9(4)  COMP.
  5638         16  BDALT-PREM-ATTRB        PIC X.
  5639         16  BDALT-PREM              PIC Z(7).99-.
  5640
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 105
* EL6311.cbl
  5642
  5643****************************************************************
  5644*
  5645* Copyright (c) 2007 by Clerity Solutions, Inc.
  5646* All rights reserved.
  5647*
  5648****************************************************************
  5649 01  DFHEIV.
  5650   02  DFHEIV0               PIC X(35).
  5651   02  DFHEIV1               PIC X(08).
  5652   02  DFHEIV2               PIC X(08).
  5653   02  DFHEIV3               PIC X(08).
  5654   02  DFHEIV4               PIC X(06).
  5655   02  DFHEIV5               PIC X(04).
  5656   02  DFHEIV6               PIC X(04).
  5657   02  DFHEIV7               PIC X(02).
  5658   02  DFHEIV8               PIC X(02).
  5659   02  DFHEIV9               PIC X(01).
  5660   02  DFHEIV10              PIC S9(7) COMP-3.
  5661   02  DFHEIV11              PIC S9(4) COMP SYNC.
  5662   02  DFHEIV12              PIC S9(4) COMP SYNC.
  5663   02  DFHEIV13              PIC S9(4) COMP SYNC.
  5664   02  DFHEIV14              PIC S9(4) COMP SYNC.
  5665   02  DFHEIV15              PIC S9(4) COMP SYNC.
  5666   02  DFHEIV16              PIC S9(9) COMP SYNC.
  5667   02  DFHEIV17              PIC X(04).
  5668   02  DFHEIV18              PIC X(04).
  5669   02  DFHEIV19              PIC X(04).
  5670   02  DFHEIV20              USAGE IS POINTER.
  5671   02  DFHEIV21              USAGE IS POINTER.
  5672   02  DFHEIV22              USAGE IS POINTER.
  5673   02  DFHEIV23              USAGE IS POINTER.
  5674   02  DFHEIV24              USAGE IS POINTER.
  5675   02  DFHEIV25              PIC S9(9) COMP SYNC.
  5676   02  DFHEIV26              PIC S9(9) COMP SYNC.
  5677   02  DFHEIV27              PIC S9(9) COMP SYNC.
  5678   02  DFHEIV28              PIC S9(9) COMP SYNC.
  5679   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  5680   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  5681   02  FILLER                PIC X(02).
  5682   02  DFHEIV99              PIC X(08) VALUE SPACE.
  5683   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  5684   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  5685   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  5686   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  5687 LINKAGE  SECTION.
  5688*****************************************************************
  5689*                                                               *
  5690* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  5691* All rights reserved.                                          *
  5692*                                                               *
  5693*****************************************************************
  5694 01  dfheiblk.
  5695     02  eibtime          pic s9(7) comp-3.
  5696     02  eibdate          pic s9(7) comp-3.
  5697     02  eibtrnid         pic x(4).
  5698     02  eibtaskn         pic s9(7) comp-3.
  5699     02  eibtrmid         pic x(4).
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 106
* EL6311.cbl
  5700     02  dfheigdi         pic s9(4) comp.
  5701     02  eibcposn         pic s9(4) comp.
  5702     02  eibcalen         pic s9(4) comp.
  5703     02  eibaid           pic x(1).
  5704     02  eibfiller1       pic x(1).
  5705     02  eibfn            pic x(2).
  5706     02  eibfiller2       pic x(2).
  5707     02  eibrcode         pic x(6).
  5708     02  eibfiller3       pic x(2).
  5709     02  eibds            pic x(8).
  5710     02  eibreqid         pic x(8).
  5711     02  eibrsrce         pic x(8).
  5712     02  eibsync          pic x(1).
  5713     02  eibfree          pic x(1).
  5714     02  eibrecv          pic x(1).
  5715     02  eibsend          pic x(1).
  5716     02  eibatt           pic x(1).
  5717     02  eibeoc           pic x(1).
  5718     02  eibfmh           pic x(1).
  5719     02  eibcompl         pic x(1).
  5720     02  eibsig           pic x(1).
  5721     02  eibconf          pic x(1).
  5722     02  eiberr           pic x(1).
  5723     02  eibrldbk         pic x(1).
  5724     02  eiberrcd         pic x(4).
  5725     02  eibsynrb         pic x(1).
  5726     02  eibnodat         pic x(1).
  5727     02  eibfiller5       pic x(2).
  5728     02  eibresp          pic 9(09) comp.
  5729     02  eibresp2         pic 9(09) comp.
  5730     02  dfheigdj         pic s9(4) comp.
  5731     02  dfheigdk         pic s9(4) comp.
  5732 01  DFHCOMMAREA                 PIC X(1300).
  5733
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 107
* EL6311.cbl
  5735*    COPY ERCPNDB.
  5736******************************************************************
  5737*                                                                *
  5738*                                                                *
  5739*                            ERCPNDB.                            *
  5740*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5741*                            VMOD=2.025                          *
  5742*                                                                *
  5743*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  5744*                                                                *
  5745******************************************************************
  5746*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  5747*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  5748******************************************************************
  5749*                                                                *
  5750*                                                                *
  5751*   FILE TYPE = VSAM,KSDS                                        *
  5752*   RECORD SIZE = 585  RECFORM = FIXED                           *
  5753*                                                                *
  5754*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  5755*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  5756*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  5757*                                                 RKP=13,LEN=36  *
  5758*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  5759*                                      AND CHG-SEQ.)             *
  5760*                                                RKP=49,LEN=11   *
  5761*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  5762*                                      AND CHG-SEQ.)             *
  5763*                                                RKP=60,LEN=15   *
  5764*                                                                *
  5765*   LOG = NO                                                     *
  5766*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5767******************************************************************
  5768******************************************************************
  5769*                   C H A N G E   L O G
  5770*
  5771* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5772*-----------------------------------------------------------------
  5773*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5774* EFFECTIVE    NUMBER
  5775*-----------------------------------------------------------------
  5776* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  5777* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  5778* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  5779* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  5780* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  5781* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  5782* 032306                   PEMA  ADD BOW LOAN NUMBER
  5783* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  5784* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  5785* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  5786* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  5787* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  5788* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  5789* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5790* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  5791******************************************************************
  5792
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 108
* EL6311.cbl
  5793 01  PENDING-BUSINESS.
  5794     12  PB-RECORD-ID                     PIC XX.
  5795         88  VALID-PB-ID                        VALUE 'PB'.
  5796
  5797     12  PB-CONTROL-PRIMARY.
  5798         16  PB-COMPANY-CD                PIC X.
  5799         16  PB-ENTRY-BATCH               PIC X(6).
  5800         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  5801         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  5802
  5803     12  PB-CONTROL-BY-ACCOUNT.
  5804         16  PB-COMPANY-CD-A1             PIC X.
  5805         16  PB-CARRIER                   PIC X.
  5806         16  PB-GROUPING.
  5807             20  PB-GROUPING-PREFIX       PIC XXX.
  5808             20  PB-GROUPING-PRIME        PIC XXX.
  5809         16  PB-STATE                     PIC XX.
  5810         16  PB-ACCOUNT.
  5811             20  PB-ACCOUNT-PREFIX        PIC X(4).
  5812             20  PB-ACCOUNT-PRIME         PIC X(6).
  5813         16  PB-CERT-EFF-DT               PIC XX.
  5814         16  PB-CERT-NO.
  5815             20  PB-CERT-PRIME            PIC X(10).
  5816             20  PB-CERT-SFX              PIC X.
  5817         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  5818
  5819         16  PB-RECORD-TYPE               PIC X.
  5820             88  PB-MAILING-DATA                VALUE '0'.
  5821             88  PB-ISSUE                       VALUE '1'.
  5822             88  PB-CANCELLATION                VALUE '2'.
  5823             88  PB-BATCH-TRAILER               VALUE '9'.
  5824
  5825     12  PB-CONTROL-BY-ORIG-BATCH.
  5826         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  5827         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  5828         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  5829         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  5830
  5831     12  PB-CONTROL-BY-CSR.
  5832         16  PB-CSR-COMPANY-CD            PIC X.
  5833         16  PB-CSR-ID                    PIC X(4).
  5834         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  5835         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  5836         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  5837******************************************************************
  5838*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  5839******************************************************************
  5840
  5841     12  PB-LAST-MAINT-DT                 PIC XX.
  5842     12  PB-LAST-MAINT-BY                 PIC X(4).
  5843     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  5844
  5845     12  PB-RECORD-BODY                   PIC X(375).
  5846
  5847     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  5848         16  PB-CERT-ORIGIN               PIC X.
  5849             88  CLASIC-CREATED-CERT         VALUE '1'.
  5850         16  PB-I-NAME.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 109
* EL6311.cbl
  5851             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  5852             20  PB-I-INSURED-FIRST-NAME.
  5853                 24  PB-I-INSURED-1ST-INIT PIC X.
  5854                 24  FILLER                PIC X(9).
  5855             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  5856         16  PB-I-AGE                     PIC S99   COMP-3.
  5857         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  5858         16  PB-I-BIRTHDAY                PIC XX.
  5859         16  PB-I-INSURED-SEX             PIC X.
  5860             88  PB-SEX-MALE     VALUE 'M'.
  5861             88  PB-SEX-FEMALE   VALUE 'F'.
  5862
  5863         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  5864         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  5865         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  5866         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  5867         16  PB-I-SKIP-CODE               PIC X.
  5868             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  5869             88  PB-SKIP-JULY              VALUE '1'.
  5870             88  PB-SKIP-AUGUST            VALUE '2'.
  5871             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  5872             88  PB-SKIP-JULY-AUG          VALUE '4'.
  5873             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  5874             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  5875             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  5876             88  PB-SKIP-JUNE              VALUE '8'.
  5877             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  5878             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  5879             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  5880         16  PB-I-TERM-TYPE               PIC X.
  5881             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  5882             88  PB-PAID-WEEKLY            VALUE 'W'.
  5883             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  5884             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  5885             88  PB-PAID-13-YEARLY         VALUE 'T'.
  5886         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  5887         16  PB-I-POLICY-FORM-NO          PIC X(12).
  5888         16  PB-I-DATA-ENTRY-SW           PIC X.
  5889             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  5890             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  5891             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  5892             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  5893         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  5894         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  5895*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  5896         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  5897         16  FILLER                       PIC X.
  5898
  5899         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  5900             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  5901             88  PB-INVALID-LIFE             VALUE '  ' '00'
  5902                                                   '90' THRU '99'.
  5903         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  5904                                          PIC XX.
  5905         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  5906         16  PB-I-AMOUNT-FINANCED REDEFINES
  5907                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  5908         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 110
* EL6311.cbl
  5909         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  5910                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  5911         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  5912         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  5913         16  PB-I-CLP-AMOUNT REDEFINES
  5914                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  5915         16  PB-I-LF-CALC-FLAG            PIC X.
  5916             88 PB-COMP-LF-PREM               VALUE '?'.
  5917         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  5918         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  5919         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  5920         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  5921         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  5922         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  5923         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  5924         16  PB-I-LF-ABBR                 PIC XXX.
  5925         16  PB-I-LF-INPUT-CD             PIC XX.
  5926
  5927         16  PB-I-AH-BENEFIT-CD           PIC XX.
  5928             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  5929             88  PB-INVALID-AH               VALUE '  ' '00'
  5930                                                   '90' THRU '99'.
  5931         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  5932         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  5933         16  PB-I-AH-CALC-FLAG            PIC X.
  5934             88 PB-COMP-AH-PREM                  VALUE '?'.
  5935         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  5936         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  5937         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  5938         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  5939         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  5940         16  PB-I-AH-ABBR                 PIC XXX.
  5941         16  PB-I-AH-INPUT-CD             PIC XXX.
  5942
  5943         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  5944         16  PB-I-REIN-TABLE              PIC XXX.
  5945         16  PB-I-BUSINESS-TYPE           PIC 99.
  5946         16  PB-I-INDV-GRP-CD             PIC X.
  5947         16  PB-I-MORT-CODE.
  5948             20  PB-I-TABLE               PIC X.
  5949             20  PB-I-INTEREST            PIC XX.
  5950             20  PB-I-MORT-TYP            PIC X.
  5951         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  5952         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  5953         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  5954         16  PB-I-INDV-GRP-OVRD           PIC X.
  5955         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  5956         16  PB-I-SIG-SW                  PIC X.
  5957             88  PB-POLICY-SIGNED             VALUE 'Y'.
  5958         16  PB-I-RATE-CLASS              PIC XX.
  5959         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  5960         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  5961         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  5962         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  5963         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  5964         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  5965         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  5966         16  PB-I-BENEFIT-TYPE            PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 111
* EL6311.cbl
  5967         16  PB-I-OB-FLAG                 PIC X.
  5968             88  PB-I-OB                      VALUE 'B'.
  5969             88  PB-I-SUMMARY                 VALUE 'Z'.
  5970         16  PB-I-ENTRY-STATUS            PIC X.
  5971             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  5972                                              'M' '5' '9' '2'.
  5973             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  5974             88  PB-I-POLICY-PENDING          VALUE '2'.
  5975             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  5976             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  5977             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  5978             88  PB-I-REIN-ONLY               VALUE '9'.
  5979             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  5980             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  5981             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  5982             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  5983         16  PB-I-INT-CODE                PIC X.
  5984             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  5985             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  5986         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  5987         16  PB-I-SOC-SEC-NO              PIC X(11).
  5988         16  PB-I-MEMBER-NO               PIC X(12).
  5989         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  5990*        16  PB-I-LOAN-OFFICER            PIC XXX.
  5991         16  PB-I-OLD-LOF                 PIC XXX.
  5992         16  PB-I-LF-EXPIRE-DT            PIC XX.
  5993         16  PB-I-AH-EXPIRE-DT            PIC XX.
  5994         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  5995         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  5996         16  PB-I-LIFE-INDICATOR          PIC X.
  5997             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  5998         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  5999         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  6000                                          PIC S9(5)V99    COMP-3.
  6001         16  PB-I-MAIL-ADDRS-SW           PIC X.
  6002             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  6003             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  6004         16  PB-I-1ST-PMT-DT              PIC XX.
  6005         16  PB-I-JOINT-INSURED.
  6006             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  6007             20 PB-I-JOINT-FIRST-NAME.
  6008                24  PB-I-JOINT-FIRST-INIT PIC X.
  6009                24  FILLER                PIC X(9).
  6010             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  6011*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  6012         16  PB-I-BENEFICIARY-NAME.
  6013             20  PB-I-BANK-NUMBER         PIC X(10).
  6014             20  FILLER                   PIC X(15).
  6015         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  6016         16  PB-I-REFERENCE               PIC X(12).
  6017         16  FILLER REDEFINES PB-I-REFERENCE.
  6018             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  6019             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  6020             20  PB-I-CLP-STATE           PIC XX.
  6021         16  PB-I-UNDERWRITING-STATUS     PIC X.
  6022             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  6023             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  6024             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 112
* EL6311.cbl
  6025         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  6026         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  6027         16  PB-I-RESIDENT-STATE          PIC XX.
  6028         16  PB-I-RATE-CODE               PIC X(4).
  6029         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  6030         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  6031         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  6032         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  6033         16  PB-I-BANK-NOCHRGB            PIC 99.
  6034         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  6035         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  6036
  6037     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  6038         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  6039             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  6040         16  PB-C-CANCEL-ORIGIN           PIC X.
  6041             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  6042         16  PB-C-LF-CANCEL-DT            PIC XX.
  6043         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  6044         16  PB-C-LF-CALC-REQ             PIC X.
  6045             88 PB-COMP-LF-CANCEL            VALUE '?'.
  6046         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  6047         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  6048         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  6049             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  6050         16  PB-C-AH-CANCEL-DT            PIC XX.
  6051         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  6052         16  PB-C-AH-CALC-REQ             PIC X.
  6053             88 PB-COMP-AH-CANCEL            VALUE '?'.
  6054         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  6055         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  6056         16  PB-C-LAST-NAME               PIC X(15).
  6057         16  PB-C-REFUND-SW               PIC X.
  6058             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  6059             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  6060         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  6061         16  PB-C-PAYEE-CODE              PIC X(6).
  6062         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  6063         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  6064         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  6065         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  6066         16  PB-C-REFERENCE               PIC X(12).
  6067         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  6068         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  6069         16  PB-C-POST-CARD-IND           PIC X.
  6070         16  PB-C-CANCEL-REASON           PIC X.
  6071         16  PB-C-REF-INTERFACE-SW        PIC X.
  6072         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  6073         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  6074         16  FILLER                       PIC X(01).
  6075*        16  FILLER                       PIC X(18).
  6076         16  PB-C-POLICY-FORM-NO          PIC X(12).
  6077*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  6078         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  6079         16  PB-CANCELED-CERT-DATA.
  6080             20  PB-CI-INSURED-NAME.
  6081                 24  PB-CI-LAST-NAME      PIC X(15).
  6082                 24  PB-CI-INITIALS       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 113
* EL6311.cbl
  6083             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  6084             20  PB-CI-INSURED-SEX        PIC X.
  6085             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  6086             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  6087             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  6088             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  6089             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  6090             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  6091             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  6092             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  6093             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  6094             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  6095             20  PB-CI-RATE-CLASS         PIC XX.
  6096             20  PB-CI-RATE-DEV-LF        PIC XXX.
  6097             20  PB-CI-RATE-DEV-AH        PIC XXX.
  6098             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  6099             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  6100             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  6101             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  6102             20  PB-CI-LF-ABBR            PIC X(3).
  6103             20  PB-CI-AH-ABBR            PIC X(3).
  6104             20  PB-CI-OB-FLAG            PIC X.
  6105                 88  PB-CI-OB                VALUE 'B'.
  6106             20  PB-CI-LF-POLICY-STATUS   PIC X.
  6107                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  6108                                           'M' '4' '5' '9' '2'.
  6109                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  6110                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  6111                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  6112                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  6113                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  6114                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  6115                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  6116                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  6117                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  6118                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  6119                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  6120                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  6121             20  PB-CI-AH-POLICY-STATUS   PIC X.
  6122                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  6123                                           'M' '4' '5' '9' '2'.
  6124                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  6125                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  6126                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  6127                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  6128                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  6129                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  6130                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  6131                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  6132                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  6133                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  6134                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  6135                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  6136             20  PB-CI-PAY-FREQUENCY      PIC 99.
  6137             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  6138             20  PB-CI-SOC-SEC-NO         PIC X(11).
  6139             20  PB-CI-MEMBER-NO          PIC X(12).
  6140             20  PB-CI-INT-CODE           PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 114
* EL6311.cbl
  6141                 88  PB-CI-ADD-ON                  VALUE 'A'.
  6142                 88  PB-CI-SIMPLE                  VALUE 'S'.
  6143             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  6144             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  6145             20  PB-CI-COMP-EXCP-SW       PIC X.
  6146                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  6147                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  6148             20  PB-CI-ENTRY-STATUS       PIC X.
  6149             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  6150             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  6151             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  6152             20  PB-CI-DEATH-DT           PIC XX.
  6153             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  6154             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  6155             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  6156             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  6157             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  6158             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  6159             20  PB-CI-ENTRY-DT              PIC XX.
  6160             20  PB-CI-ENTRY-BATCH           PIC X(6).
  6161             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  6162             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  6163             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  6164             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  6165             20  PB-CI-OLD-LOF               PIC XXX.
  6166*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  6167             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  6168             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  6169             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  6170             20  PB-CI-INDV-GRP-CD           PIC X.
  6171             20  PB-CI-BENEFICIARY-NAME.
  6172                 24  PB-CI-BANK-NUMBER       PIC X(10).
  6173                 24  FILLER                  PIC X(15).
  6174             20  PB-CI-NOTE-SW               PIC X.
  6175             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  6176             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  6177             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  6178             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  6179             20  PB-CI-LOAN-OFFICER          PIC X(5).
  6180             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  6181             20  PB-CI-FIRST-NAME            PIC X(10).
  6182             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  6183
  6184         16  FILLER                       PIC X(13).
  6185*032306  16  FILLER                       PIC X(27).
  6186*        16  FILLER                       PIC X(46).
  6187
  6188     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  6189         16  FILLER                       PIC X(10).
  6190         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  6191         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  6192         16  PB-M-INSURED-MID-INIT        PIC X.
  6193         16  PB-M-INSURED-AGE             PIC 99.
  6194         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  6195         16  PB-M-INSURED-SEX             PIC X.
  6196         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  6197         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  6198         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 115
* EL6311.cbl
  6199         16  PB-M-INSURED-CITY-STATE.
  6200             20  PB-M-INSURED-CITY        PIC X(28).
  6201             20  PB-M-INSURED-STATE       PIC XX.
  6202         16  PB-M-INSURED-ZIP-CODE.
  6203             20  PB-M-INSURED-ZIP-PRIME.
  6204                 24  PB-M-INSURED-ZIP-1   PIC X.
  6205                     88  PB-M-CANADIAN-POST-CODE
  6206                                             VALUE 'A' THRU 'Z'.
  6207                 24  FILLER               PIC X(4).
  6208             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  6209         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  6210                                        PB-M-INSURED-ZIP-CODE.
  6211             20  PM-M-INS-CAN-POST1       PIC XXX.
  6212             20  PM-M-INS-CAN-POST2       PIC XXX.
  6213             20  FILLER                   PIC XXX.
  6214         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  6215         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  6216         16  PB-M-CRED-BENE-NAME          PIC X(30).
  6217         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  6218         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  6219         16  PB-M-CRED-BENE-CITYST.
  6220             20  PB-M-CRED-BENE-CITY      PIC X(28).
  6221             20  PB-M-CRED-BENE-STATE     PIC XX.
  6222         16  FILLER                       PIC X(92).
  6223
  6224     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  6225         16  FILLER                       PIC X(10).
  6226         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6227         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6228         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6229         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6230         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6231         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6232         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6233         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6234         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6235         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6236         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6237         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6238         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  6239         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  6240         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  6241         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  6242         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  6243         16  PB-ACCOUNT-NAME              PIC X(30).
  6244         16  PB-PREM-REF-RPT-FLAG         PIC X.
  6245         16  PB-REFERENCE                 PIC X(12).
  6246         16  PB-B-RECEIVED-DT             PIC XX.
  6247         16  FILLER                       PIC X(234).
  6248
  6249     12  PB-RECORD-STATUS.
  6250         16  PB-CREDIT-SELECT-DT          PIC XX.
  6251         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  6252         16  PB-BILLED-DT                 PIC XX.
  6253         16  PB-BILLING-STATUS            PIC X.
  6254             88  PB-ENTRY-REVERSED            VALUE 'R'.
  6255             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  6256             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 116
* EL6311.cbl
  6257         16  PB-RECORD-BILL               PIC X.
  6258             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  6259             88  PB-RECORD-RETURNED           VALUE 'R'.
  6260             88  PB-RECORD-ENDORSED           VALUE 'E'.
  6261             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  6262             88  PB-OVERRIDE-AH               VALUE 'A'.
  6263             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  6264         16  PB-BATCH-ENTRY               PIC X.
  6265             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  6266             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  6267             88  PB-REISSUED-CERT             VALUE 'E'.
  6268             88  PB-MONTHLY-CERT              VALUE 'M'.
  6269             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  6270             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  6271             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  6272         16  PB-FORCE-CODE                PIC X.
  6273             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  6274             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  6275             88  PB-CANCEL-FORCE              VALUE '8'.
  6276             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  6277             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  6278             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  6279             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  6280             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  6281             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  6282             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  6283         16  PB-FATAL-FLAG                PIC X.
  6284             88  PB-FATAL-ERRORS              VALUE 'X'.
  6285         16  PB-FORCE-ER-CD               PIC X.
  6286             88  PB-FORCE-ERRORS              VALUE 'F'.
  6287             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  6288         16  PB-WARN-ER-CD                PIC X.
  6289             88  PB-WARNING-ERRORS            VALUE 'W'.
  6290         16  FILLER                       PIC X.
  6291         16  PB-OUT-BAL-CD                PIC X.
  6292             88  PB-OUT-OF-BAL                VALUE 'O'.
  6293         16  PB-LIFE-OVERRIDE-L1          PIC X.
  6294         16  PB-AH-OVERRIDE-L1            PIC X.
  6295         16  PB-INPUT-DT                  PIC XX.
  6296         16  PB-INPUT-BY                  PIC X(4).
  6297         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  6298         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  6299         16  PB-TOLERANCE-REJECT-SW       PIC X.
  6300         16  PB-LF-EARNING-METHOD         PIC X.
  6301         16  PB-AH-EARNING-METHOD         PIC X.
  6302         16  PB-LF-TERM-CALC-METHOD       PIC X.
  6303         16  PB-AH-TERM-CALC-METHOD       PIC X.
  6304         16  PB-REIN-CD                   PIC XXX.
  6305         16  PB-LF-REFUND-TYPE            PIC X.
  6306         16  PB-AH-REFUND-TYPE            PIC X.
  6307         16  PB-ACCT-EFF-DT               PIC XX.
  6308         16  PB-ACCT-EXP-DT               PIC XX.
  6309         16  PB-COMPANY-ID                PIC X(3).
  6310         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  6311         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  6312         16  PB-SV-CARRIER                PIC X.
  6313         16  PB-SV-GROUPING               PIC X(6).
  6314         16  PB-SV-STATE                  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 117
* EL6311.cbl
  6315         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  6316         16  PB-GA-BILLING-INFO.
  6317             20  PB-GA-BILL-DT OCCURS 5 TIMES
  6318                                          PIC XX.
  6319         16  PB-SV-REMIT-TO  REDEFINES
  6320             PB-GA-BILLING-INFO           PIC X(10).
  6321         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  6322         16  PB-I-LOAN-OFFICER            PIC X(5).
  6323         16  PB-I-VIN                     PIC X(17).
  6324
  6325         16  FILLER                       PIC X(04).
  6326         16  IMNET-BYPASS-SW              PIC X.
  6327
  6328******************************************************************
  6329*                COMMON EDIT ERRORS                              *
  6330******************************************************************
  6331
  6332     12  PB-COMMON-ERRORS.
  6333         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  6334                                           PIC S9(4)     COMP.
  6335
  6336******************************************************************
  6337
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 118
* EL6311.cbl
  6339*    COPY ELCCERT.
  6340******************************************************************
  6341*                                                                *
  6342*                            ELCCERT.                            *
  6343*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6344*                            VMOD=2.013                          *
  6345*                                                                *
  6346*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  6347*                                                                *
  6348*   FILE TYPE = VSAM,KSDS                                        *
  6349*   RECORD SIZE = 450  RECFORM = FIXED                           *
  6350*                                                                *
  6351*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  6352*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  6353*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  6354*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  6355*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  6356*                                                                *
  6357*   LOG = YES                                                    *
  6358*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6359******************************************************************
  6360*                   C H A N G E   L O G
  6361*
  6362* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6363*-----------------------------------------------------------------
  6364*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6365* EFFECTIVE    NUMBER
  6366*-----------------------------------------------------------------
  6367* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  6368* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  6369* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  6370* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  6371* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  6372* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  6373* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6374* 032612  CR2011110200001  PEMA  AHL CHANGES
  6375******************************************************************
  6376
  6377 01  CERTIFICATE-MASTER.
  6378     12  CM-RECORD-ID                      PIC XX.
  6379         88  VALID-CM-ID                      VALUE 'CM'.
  6380
  6381     12  CM-CONTROL-PRIMARY.
  6382         16  CM-COMPANY-CD                 PIC X.
  6383         16  CM-CARRIER                    PIC X.
  6384         16  CM-GROUPING.
  6385             20  CM-GROUPING-PREFIX        PIC X(3).
  6386             20  CM-GROUPING-PRIME         PIC X(3).
  6387         16  CM-STATE                      PIC XX.
  6388         16  CM-ACCOUNT.
  6389             20  CM-ACCOUNT-PREFIX         PIC X(4).
  6390             20  CM-ACCOUNT-PRIME          PIC X(6).
  6391         16  CM-CERT-EFF-DT                PIC XX.
  6392         16  CM-CERT-NO.
  6393             20  CM-CERT-PRIME             PIC X(10).
  6394             20  CM-CERT-SFX               PIC X.
  6395
  6396     12  CM-CONTROL-BY-NAME.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 119
* EL6311.cbl
  6397         16  CM-COMPANY-CD-A1              PIC X.
  6398         16  CM-INSURED-LAST-NAME          PIC X(15).
  6399         16  CM-INSURED-INITIALS.
  6400             20  CM-INSURED-INITIAL1       PIC X.
  6401             20  CM-INSURED-INITIAL2       PIC X.
  6402
  6403     12  CM-CONTROL-BY-SSN.
  6404         16  CM-COMPANY-CD-A2              PIC X.
  6405         16  CM-SOC-SEC-NO.
  6406             20  CM-SSN-STATE              PIC XX.
  6407             20  CM-SSN-ACCOUNT            PIC X(6).
  6408             20  CM-SSN-LN3.
  6409                 25  CM-INSURED-INITIALS-A2.
  6410                     30 CM-INSURED-INITIAL1-A2   PIC X.
  6411                     30 CM-INSURED-INITIAL2-A2   PIC X.
  6412                 25 CM-PART-LAST-NAME-A2         PIC X.
  6413
  6414     12  CM-CONTROL-BY-CERT-NO.
  6415         16  CM-COMPANY-CD-A4              PIC X.
  6416         16  CM-CERT-NO-A4                 PIC X(11).
  6417
  6418     12  CM-CONTROL-BY-MEMB.
  6419         16  CM-COMPANY-CD-A5              PIC X.
  6420         16  CM-MEMBER-NO.
  6421             20  CM-MEMB-STATE             PIC XX.
  6422             20  CM-MEMB-ACCOUNT           PIC X(6).
  6423             20  CM-MEMB-LN4.
  6424                 25  CM-INSURED-INITIALS-A5.
  6425                     30 CM-INSURED-INITIAL1-A5   PIC X.
  6426                     30 CM-INSURED-INITIAL2-A5   PIC X.
  6427                 25 CM-PART-LAST-NAME-A5         PIC XX.
  6428
  6429     12  CM-INSURED-PROFILE-DATA.
  6430         16  CM-INSURED-FIRST-NAME.
  6431             20  CM-INSURED-1ST-INIT       PIC X.
  6432             20  FILLER                    PIC X(9).
  6433         16  CM-INSURED-ISSUE-AGE          PIC 99.
  6434         16  CM-INSURED-SEX                PIC X.
  6435             88  CM-SEX-MALE                  VALUE 'M'.
  6436             88  CM-SEX-FEMAL                 VALUE 'F'.
  6437         16  CM-INSURED-JOINT-AGE          PIC 99.
  6438         16  CM-JOINT-INSURED-NAME.
  6439             20  CM-JT-LAST-NAME           PIC X(15).
  6440             20  CM-JT-FIRST-NAME.
  6441                 24  CM-JT-1ST-INIT        PIC X.
  6442                 24  FILLER                PIC X(9).
  6443             20  CM-JT-INITIAL             PIC X.
  6444
  6445     12  CM-LIFE-DATA.
  6446         16  CM-LF-BENEFIT-CD              PIC XX.
  6447         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  6448         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  6449         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  6450         16  CM-LF-DEV-CODE                PIC XXX.
  6451         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  6452         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  6453         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  6454         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 120
* EL6311.cbl
  6455         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  6456         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  6457         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  6458         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  6459         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  6460         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  6461         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  6462         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  6463         16  FILLER                        PIC XX.
  6464
  6465     12  CM-AH-DATA.
  6466         16  CM-AH-BENEFIT-CD              PIC XX.
  6467         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  6468         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  6469         16  CM-AH-DEV-CODE                PIC XXX.
  6470         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  6471         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  6472         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  6473         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  6474         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  6475         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  6476         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  6477         16  CM-AH-PAID-THRU-DT            PIC XX.
  6478             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  6479         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  6480         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  6481         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  6482         16  FILLER                        PIC X.
  6483
  6484     12  CM-LOAN-INFORMATION.
  6485         16  CM-LIVES                      PIC S9(7)     COMP-3.
  6486         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  6487                                           PIC S9(5)V99  COMP-3.
  6488         16  CM-BILLED                     PIC S9(7)     COMP-3.
  6489         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  6490         16  CM-PAY-FREQUENCY              PIC S99.
  6491         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  6492         16  CM-RATE-CLASS                 PIC XX.
  6493         16  CM-BENEFICIARY                PIC X(25).
  6494         16  CM-POLICY-FORM-NO             PIC X(12).
  6495         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  6496         16  CM-LAST-ADD-ON-DT             PIC XX.
  6497         16  CM-DEDUCTIBLE-AMOUNTS.
  6498             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  6499             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  6500         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  6501             20  CM-RESIDENT-STATE         PIC XX.
  6502             20  CM-RATE-CODE              PIC X(4).
  6503             20  FILLER                    PIC XX.
  6504         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  6505             20  CM-LOAN-OFFICER           PIC X(5).
  6506             20  FILLER                    PIC XXX.
  6507         16  CM-CSR-CODE                   PIC XXX.
  6508         16  CM-UNDERWRITING-CODE          PIC X.
  6509             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  6510         16  CM-POST-CARD-IND              PIC X.
  6511         16  CM-NH-INTERFACE-SW            PIC X.
  6512         16  CM-PREMIUM-TYPE               PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 121
* EL6311.cbl
  6513             88  CM-SING-PRM                  VALUE '1'.
  6514             88  CM-O-B-COVERAGE              VALUE '2'.
  6515             88  CM-OPEN-END                  VALUE '3'.
  6516         16  CM-IND-GRP-TYPE               PIC X.
  6517             88  CM-INDIVIDUAL                VALUE 'I'.
  6518             88  CM-GROUP                     VALUE 'G'.
  6519         16  CM-SKIP-CODE                  PIC X.
  6520             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  6521             88  SKIP-JULY                    VALUE '1'.
  6522             88  SKIP-AUGUST                  VALUE '2'.
  6523             88  SKIP-SEPTEMBER               VALUE '3'.
  6524             88  SKIP-JULY-AUG                VALUE '4'.
  6525             88  SKIP-AUG-SEPT                VALUE '5'.
  6526             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  6527             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  6528             88  SKIP-JUNE                    VALUE '8'.
  6529             88  SKIP-JUNE-JULY               VALUE '9'.
  6530             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  6531             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  6532         16  CM-PAYMENT-MODE               PIC X.
  6533             88  PAY-MONTHLY                  VALUE SPACE.
  6534             88  PAY-WEEKLY                   VALUE '1'.
  6535             88  PAY-SEMI-MONTHLY             VALUE '2'.
  6536             88  PAY-BI-WEEKLY                VALUE '3'.
  6537             88  PAY-SEMI-ANUALLY             VALUE '4'.
  6538         16  CM-LOAN-NUMBER                PIC X(8).
  6539         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  6540         16  CM-OLD-LOF                    PIC XXX.
  6541*        16  CM-LOAN-OFFICER               PIC XXX.
  6542         16  CM-REIN-TABLE                 PIC XXX.
  6543         16  CM-SPECIAL-REIN-CODE          PIC X.
  6544         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  6545         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  6546         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  6547
  6548     12  CM-STATUS-DATA.
  6549         16  CM-ENTRY-STATUS               PIC X.
  6550         16  CM-ENTRY-DT                   PIC XX.
  6551
  6552         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  6553         16  CM-LF-CANCEL-DT               PIC XX.
  6554         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  6555
  6556         16  CM-LF-STATUS-AT-DEATH         PIC X.
  6557         16  CM-LF-DEATH-DT                PIC XX.
  6558         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  6559
  6560         16  CM-LF-CURRENT-STATUS          PIC X.
  6561             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  6562                                                'M' '4' '5' '9'.
  6563             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  6564             88  CM-LF-POLICY-PENDING         VALUE '2'.
  6565             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  6566             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  6567             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  6568             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  6569             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  6570             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 122
* EL6311.cbl
  6571             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  6572             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  6573             88  CM-LF-DECLINED               VALUE 'D'.
  6574             88  CM-LF-VOIDED                 VALUE 'V'.
  6575
  6576         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  6577         16  CM-AH-CANCEL-DT               PIC XX.
  6578         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  6579
  6580         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  6581         16  CM-AH-SETTLEMENT-DT           PIC XX.
  6582         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  6583
  6584         16  CM-AH-CURRENT-STATUS          PIC X.
  6585             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  6586                                                'M' '4' '5' '9'.
  6587             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  6588             88  CM-AH-POLICY-PENDING         VALUE '2'.
  6589             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  6590             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  6591             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  6592             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  6593             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  6594             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  6595             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  6596             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  6597             88  CM-AH-DECLINED               VALUE 'D'.
  6598             88  CM-AH-VOIDED                 VALUE 'V'.
  6599
  6600         16  CM-CLAIM-INTERFACE-SW         PIC X.
  6601             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  6602             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  6603             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  6604         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  6605
  6606         16  CM-ENTRY-BATCH                PIC X(6).
  6607         16  CM-LF-EXIT-BATCH              PIC X(6).
  6608         16  CM-AH-EXIT-BATCH              PIC X(6).
  6609         16  CM-LAST-MONTH-END             PIC XX.
  6610
  6611     12  CM-NOTE-SW                        PIC X.
  6612         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  6613         88  CERT-NOTES-PRESENT               VALUE '1'.
  6614         88  BILLING-NOTES-PRESENT            VALUE '2'.
  6615         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  6616         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  6617         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  6618         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  6619         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  6620     12  CM-COMP-EXCP-SW                   PIC X.
  6621         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  6622         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  6623     12  CM-INSURED-ADDRESS-SW             PIC X.
  6624         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  6625         88  INSURED-ADDR-PRESENT             VALUE '1'.
  6626
  6627*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  6628     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 123
* EL6311.cbl
  6629     12  FILLER                            PIC X.
  6630
  6631*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  6632     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  6633     12  FILLER                            PIC X.
  6634*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  6635     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  6636
  6637     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  6638         88  CERT-ADDED-BATCH                 VALUE ' '.
  6639         88  CERT-ADDED-ONLINE                VALUE '1'.
  6640         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  6641         88  CERT-PURGED-OFFLINE              VALUE '3'.
  6642         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  6643     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  6644         88  CERT-AS-LOADED                   VALUE ' '.
  6645         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  6646         88  CERT-CLAIM-ONLINE                VALUE '2'.
  6647         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  6648         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  6649         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  6650         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  6651         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  6652
  6653     12  CM-ACCOUNT-COMM-PCTS.
  6654         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  6655         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  6656
  6657     12  CM-USER-FIELD                     PIC X.
  6658     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  6659     12  CM-CLP-STATE                      PIC XX.
  6660     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  6661     12  CM-USER-RESERVED                  PIC XXX.
  6662     12  FILLER REDEFINES CM-USER-RESERVED.
  6663         16  CM-AH-CLASS-CD                PIC XX.
  6664         16  F                             PIC X.
  6665******************************************************************
  6666
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 124
* EL6311.cbl
  6668*    COPY ERCNOTE.
  6669******************************************************************
  6670*                                                                *
  6671*                                                                *
  6672*                            ERCNOTE                             *
  6673*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6674*                            VMOD=2.003                          *
  6675*                                                                *
  6676*        FILE DESCRIPTION = CERTIFICATE AND BILLING NOTES        *
  6677*                                                                *
  6678*        FILE TYPE= VSAM,KSDS                                    *
  6679*        RECORD SIZE = 825    RECFORM = FIXED                    *
  6680*                                                                *
  6681*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  6682*                                                                *
  6683*        LOG = YES                                               *
  6684*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  6685*                                                                *
  6686******************************************************************
  6687*                   C H A N G E   L O G
  6688*
  6689* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6690*-----------------------------------------------------------------
  6691*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6692* EFFECTIVE    NUMBER
  6693*-----------------------------------------------------------------
  6694* 091509  CR2008100900003  AJRA  CERT NOTES MOVED TO NEW FILE. THI
  6695*                                FILE WILL CONTAIN BILLING NOTES O
  6696******************************************************************
  6697
  6698 01  CERTIFICATE-NOTE.
  6699     12  CN-RECORD-ID                PIC  XX.
  6700         88  VALID-CN-ID                  VALUE 'CN'.
  6701
  6702     12  CN-CONTROL-PRIMARY.
  6703         16  CN-COMPANY-CD           PIC X.
  6704         16  CN-CARRIER              PIC X.
  6705         16  CN-GROUPING.
  6706             20 CN-GROUPING-PREFIX   PIC XXX.
  6707             20 CN-GROUPING-PRIME    PIC XXX.
  6708         16  CN-STATE                PIC XX.
  6709         16  CN-ACCOUNT.
  6710             20 CN-ACCOUNT-PREFIX    PIC X(4).
  6711             20 CN-ACCOUNT-PRIME     PIC X(6).
  6712         16  CN-CERT-EFF-DT          PIC XX.
  6713         16  CN-CERT-NO.
  6714             20  CN-CERT-PRIME       PIC X(10).
  6715             20  CN-CERT-SFX         PIC X.
  6716
  6717     12  CN-BILLING-START-LINE-NO    PIC 99.
  6718     12  CN-BILLING-END-LINE-NO      PIC 99.
  6719
  6720     12  CN-LINES.
  6721         16  CN-LINE OCCURS 10       PIC X(77).
  6722
  6723     12  CN-LAST-MAINT-DT            PIC XX.
  6724     12  CN-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  6725     12  CN-LAST-MAINT-USER          PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 125
* EL6311.cbl
  6726     12  FILLER                      PIC X(6).
  6727******************************************************************
  6728
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 126
* EL6311.cbl
  6730*    COPY ERCPNDM.
  6731******************************************************************
  6732*                                                                *
  6733*                                                                *
  6734*                            ERCPNDM                             *
  6735*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6736*                            VMOD=2.003                          *
  6737*                                                                *
  6738*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  6739*                                                                *
  6740*   FILE TYPE = VSAM,KSDS                                        *
  6741*   RECORD SIZE = 374   RECFORM = FIX                            *
  6742*                                                                *
  6743*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  6744*   ALTERNATE PATH    = NOT USED                                 *
  6745*                                                                *
  6746*   LOG = YES                                                    *
  6747*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6748******************************************************************
  6749*                   C H A N G E   L O G
  6750*
  6751* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6752*-----------------------------------------------------------------
  6753*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6754* EFFECTIVE    NUMBER
  6755*-----------------------------------------------------------------
  6756* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  6757* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  6758* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  6759******************************************************************
  6760
  6761 01  PENDING-MAILING-DATA.
  6762     12  PM-RECORD-ID                      PIC XX.
  6763         88  VALID-MA-ID                       VALUE 'PM'.
  6764
  6765     12  PM-CONTROL-PRIMARY.
  6766         16  PM-COMPANY-CD                 PIC X.
  6767         16  PM-ENTRY-BATCH                PIC X(6).
  6768         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  6769         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  6770
  6771     12  FILLER                            PIC X(14).
  6772
  6773     12  PM-ACCESS-CONTROL.
  6774         16  PM-SOURCE-SYSTEM              PIC XX.
  6775             88  PM-FROM-CREDIT                VALUE 'CR'.
  6776             88  PM-FROM-VSI                   VALUE 'VS'.
  6777             88  PM-FROM-WARRANTY              VALUE 'WA'.
  6778             88  PM-FROM-OTHER                 VALUE 'OT'.
  6779         16  PM-RECORD-ADD-DT              PIC XX.
  6780         16  PM-RECORD-ADDED-BY            PIC XXXX.
  6781         16  PM-LAST-MAINT-DT              PIC XX.
  6782         16  PM-LAST-MAINT-BY              PIC XXXX.
  6783         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  6784
  6785     12  PM-PROFILE-INFO.
  6786         16  PM-QUALIFY-CODE-1             PIC XX.
  6787         16  PM-QUALIFY-CODE-2             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 127
* EL6311.cbl
  6788         16  PM-QUALIFY-CODE-3             PIC XX.
  6789         16  PM-QUALIFY-CODE-4             PIC XX.
  6790         16  PM-QUALIFY-CODE-5             PIC XX.
  6791
  6792         16  PM-INSURED-LAST-NAME          PIC X(15).
  6793         16  PM-INSURED-FIRST-NAME         PIC X(10).
  6794         16  PM-INSURED-MIDDLE-INIT        PIC X.
  6795         16  PM-INSURED-ISSUE-AGE          PIC 99.
  6796         16  PM-INSURED-BIRTH-DT           PIC XX.
  6797         16  PM-INSURED-SEX                PIC X.
  6798             88  PM-SEX-MALE                   VALUE 'M'.
  6799             88  PM-SEX-FEMALE                 VALUE 'F'.
  6800         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  6801
  6802         16  PM-ADDRESS-CORRECTED          PIC X.
  6803         16  PM-JOINT-BIRTH-DT             PIC XX.
  6804*        16  FILLER                        PIC X(12).
  6805
  6806         16  PM-ADDRESS-LINE-1             PIC X(30).
  6807         16  PM-ADDRESS-LINE-2             PIC X(30).
  6808         16  PM-CITY-STATE.
  6809             20  PM-CITY                   PIC X(28).
  6810             20  PM-STATE                  PIC XX.
  6811         16  PM-ZIP.
  6812             20  PM-ZIP-CODE.
  6813                 24  PM-ZIP-1              PIC X.
  6814                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6815                 24  FILLER                PIC X(4).
  6816             20  PM-ZIP-PLUS4              PIC X(4).
  6817         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  6818             20  PM-CAN-POST1              PIC XXX.
  6819             20  PM-CAN-POST2              PIC XXX.
  6820             20  FILLER                    PIC XXX.
  6821
  6822         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  6823
  6824         16  FILLER                        PIC X(03).
  6825
  6826     12  PM-CRED-BENE-INFO.
  6827         16  PM-CRED-BENE-NAME             PIC X(25).
  6828         16  PM-CRED-BENE-ADDR             PIC X(30).
  6829         16  PM-CRED-BENE-ADDR2            PIC X(30).
  6830         16  PM-CRED-BENE-CTYST.
  6831             20  PM-CRED-BENE-CITY         PIC X(28).
  6832             20  PM-CRED-BENE-STATE        PIC XX.
  6833         16  PM-CRED-BENE-ZIP.
  6834             20  PM-CB-ZIP-CODE.
  6835                 24  PM-CB-ZIP-1           PIC X.
  6836                     88  PM-CB-CANADIAN-POST-CODE
  6837                                  VALUE 'A' THRU 'Z'.
  6838                 24  FILLER                PIC X(4).
  6839             20  PM-CB-ZIP-PLUS4           PIC X(4).
  6840         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  6841             20  PM-CB-CAN-POST1           PIC XXX.
  6842             20  PM-CB-CAN-POST2           PIC XXX.
  6843             20  FILLER                    PIC XXX.
  6844     12  PM-POST-CARD-MAIL-DATA.
  6845         16  PM-MAIL-DATA OCCURS 7.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 128
* EL6311.cbl
  6846             20  PM-MAIL-TYPE              PIC X.
  6847                 88  PM-12MO-MAILING           VALUE '1'.
  6848                 88  PM-EXP-MAILING            VALUE '2'.
  6849             20  PM-MAIL-STATUS            PIC X.
  6850                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  6851                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  6852                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  6853             20  PM-MAIL-DATE              PIC XX.
  6854     12  FILLER                            PIC XX.
  6855     12  FILLER                            PIC X(12).
  6856*    12  FILLER                            PIC X(30).
  6857
  6858******************************************************************
  6859
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 129
* EL6311.cbl
  6861*    COPY ERCMAIL.
  6862******************************************************************
  6863*                                                                *
  6864*                                                                *
  6865*                            ERCMAIL                             *
  6866*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6867*                            VMOD=2.003                          *
  6868*                                                                *
  6869*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  6870*                                                                *
  6871*   FILE TYPE = VSAM,KSDS                                        *
  6872*   RECORD SIZE = 374   RECFORM = FIX                            *
  6873*                                                                *
  6874*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  6875*   ALTERNATE PATH    = NOT USED                                 *
  6876*                                                                *
  6877*   LOG = YES                                                    *
  6878*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6879******************************************************************
  6880*                   C H A N G E   L O G
  6881*
  6882* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6883*-----------------------------------------------------------------
  6884*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6885* EFFECTIVE    NUMBER
  6886*-----------------------------------------------------------------
  6887* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  6888* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  6889* 111108                   PEMA  ADD CRED BENE ADDR2
  6890******************************************************************
  6891
  6892 01  MAILING-DATA.
  6893     12  MA-RECORD-ID                      PIC XX.
  6894         88  VALID-MA-ID                       VALUE 'MA'.
  6895
  6896     12  MA-CONTROL-PRIMARY.
  6897         16  MA-COMPANY-CD                 PIC X.
  6898         16  MA-CARRIER                    PIC X.
  6899         16  MA-GROUPING.
  6900             20  MA-GROUPING-PREFIX        PIC XXX.
  6901             20  MA-GROUPING-PRIME         PIC XXX.
  6902         16  MA-STATE                      PIC XX.
  6903         16  MA-ACCOUNT.
  6904             20  MA-ACCOUNT-PREFIX         PIC X(4).
  6905             20  MA-ACCOUNT-PRIME          PIC X(6).
  6906         16  MA-CERT-EFF-DT                PIC XX.
  6907         16  MA-CERT-NO.
  6908             20  MA-CERT-PRIME             PIC X(10).
  6909             20  MA-CERT-SFX               PIC X.
  6910
  6911     12  FILLER                            PIC XX.
  6912
  6913     12  MA-ACCESS-CONTROL.
  6914         16  MA-SOURCE-SYSTEM              PIC XX.
  6915             88  MA-FROM-CREDIT                VALUE 'CR'.
  6916             88  MA-FROM-VSI                   VALUE 'VS'.
  6917             88  MA-FROM-WARRANTY              VALUE 'WA'.
  6918             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 130
* EL6311.cbl
  6919         16  MA-RECORD-ADD-DT              PIC XX.
  6920         16  MA-RECORD-ADDED-BY            PIC XXXX.
  6921         16  MA-LAST-MAINT-DT              PIC XX.
  6922         16  MA-LAST-MAINT-BY              PIC XXXX.
  6923         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  6924
  6925     12  MA-PROFILE-INFO.
  6926         16  MA-QUALIFY-CODE-1             PIC XX.
  6927         16  MA-QUALIFY-CODE-2             PIC XX.
  6928         16  MA-QUALIFY-CODE-3             PIC XX.
  6929         16  MA-QUALIFY-CODE-4             PIC XX.
  6930         16  MA-QUALIFY-CODE-5             PIC XX.
  6931
  6932         16  MA-INSURED-LAST-NAME          PIC X(15).
  6933         16  MA-INSURED-FIRST-NAME         PIC X(10).
  6934         16  MA-INSURED-MIDDLE-INIT        PIC X.
  6935         16  MA-INSURED-ISSUE-AGE          PIC 99.
  6936         16  MA-INSURED-BIRTH-DT           PIC XX.
  6937         16  MA-INSURED-SEX                PIC X.
  6938             88  MA-SEX-MALE                   VALUE 'M'.
  6939             88  MA-SEX-FEMALE                 VALUE 'F'.
  6940         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  6941
  6942         16  MA-ADDRESS-CORRECTED          PIC X.
  6943         16  MA-JOINT-BIRTH-DT             PIC XX.
  6944*        16  FILLER                        PIC X(12).
  6945
  6946         16  MA-ADDRESS-LINE-1             PIC X(30).
  6947         16  MA-ADDRESS-LINE-2             PIC X(30).
  6948         16  MA-CITY-STATE.
  6949             20  MA-CITY                   PIC X(28).
  6950             20  MA-ADDR-STATE             PIC XX.
  6951         16  MA-ZIP.
  6952             20  MA-ZIP-CODE.
  6953                 24  MA-ZIP-CODE-1ST       PIC X(1).
  6954                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6955                 24  FILLER                PIC X(4).
  6956             20  MA-ZIP-PLUS4              PIC X(4).
  6957         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  6958             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  6959             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  6960             20  FILLER                    PIC X(3).
  6961
  6962         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  6963
  6964         16  FILLER                        PIC XXX.
  6965*        16  FILLER                        PIC X(10).
  6966
  6967     12  MA-CRED-BENE-INFO.
  6968         16  MA-CRED-BENE-NAME                 PIC X(25).
  6969         16  MA-CRED-BENE-ADDR                 PIC X(30).
  6970         16  MA-CRED-BENE-ADDR2                PIC X(30).
  6971         16  MA-CRED-BENE-CTYST.
  6972             20  MA-CRED-BENE-CITY             PIC X(28).
  6973             20  MA-CRED-BENE-STATE            PIC XX.
  6974         16  MA-CRED-BENE-ZIP.
  6975             20  MA-CB-ZIP-CODE.
  6976                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 131
* EL6311.cbl
  6977                     88  MA-CB-CANADIAN-POST-CODE
  6978                                           VALUE 'A' THRU 'Z'.
  6979                 24  FILLER                    PIC X(4).
  6980             20  MA-CB-ZIP-PLUS4               PIC X(4).
  6981         16  MA-CB-CANADIAN-POSTAL-CODE
  6982                            REDEFINES MA-CRED-BENE-ZIP.
  6983             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  6984             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  6985             20  FILLER                        PIC X(3).
  6986     12  MA-POST-CARD-MAIL-DATA.
  6987         16  MA-MAIL-DATA OCCURS 7.
  6988             20  MA-MAIL-TYPE              PIC X.
  6989                 88  MA-12MO-MAILING           VALUE '1'.
  6990                 88  MA-EXP-MAILING            VALUE '2'.
  6991             20  MA-MAIL-STATUS            PIC X.
  6992                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  6993                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  6994                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  6995             20  MA-MAIL-DATE              PIC XX.
  6996     12  FILLER                            PIC XX.
  6997     12  FILLER                            PIC XX.
  6998*    12  FILLER                            PIC X(30).
  6999******************************************************************
  7000
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 132
* EL6311.cbl
  7002*    COPY ERCRQST.
  7003******************************************************************
  7004*                                                                *
  7005*                                                                *
  7006*                            ERCRQST.                            *
  7007*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7008*                            VMOD=2.002                          *
  7009*                                                                *
  7010*   FILE DESCRIPTION = ACCOUNTS RECEIVABLE REQUEST RECORD        *
  7011*                                                                *
  7012*   FILE TYPE = VSAM,KSDS                                        *
  7013*   RECORD SIZE = 200  RECFORM = FIXED                           *
  7014*                                                                *
  7015*   BASE CLUSTER = ERRQST                         RKP=2,LEN=7    *
  7016*       ALTERNATE PATH1 = ERRQST2  (BY CO, CAR, GROUP, ST,       *
  7017*                                   ACCOUNT, REF, BATCH)         *
  7018*                                                RKP=9, LEN=38   *
  7019*       ALTERNATE PATH2 = ERRQST3  (BY CO, CAR, GROUP, FIN  RESP *
  7020*                                   ACCOUNT, REF, BATCH)         *
  7021*                                                RKP=47, LEN=46  *
  7022*       ALTERNATE PATH3 = ERRQST4  (BY CO, CAR, GROUP, AGENT,    *
  7023*                                   BATCH)                       *
  7024*                                                RKP=93, LEN=24  *
  7025*       ALTERNATE PATH4 = ERRQST5  (BY CO, SUMMARY CODE, ACCT,   *
  7026*                                   REF, BATCH)                  *
  7027*                                                RKP=117, LEN=35 *
  7028*   LOG = NO                                                     *
  7029*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7030******************************************************************
  7031
  7032 01  AR-REQUEST-RECORD.
  7033     12  RQ-RECORD-ID                     PIC XX.
  7034         88  VALID-RQ-ID                        VALUE 'RQ'.
  7035
  7036     12  RQ-CONTROL-PRIMARY.
  7037         16  RQ-COMPANY-CD                PIC X.
  7038         16  RQ-ENTRY-BATCH               PIC X(6).
  7039
  7040     12  RQ-CONTROL-BY-ACCT-REF.
  7041         16  RQ-COMPANY-CD-A1             PIC X.
  7042         16  RQ-CARRIER-A1                PIC X.
  7043         16  RQ-GROUPING-A1               PIC X(6).
  7044         16  RQ-STATE-A1                  PIC XX.
  7045         16  RQ-ACCOUNT-A1                PIC X(10).
  7046         16  RQ-REFERENCE-A1              PIC X(12).
  7047         16  RQ-BATCH-A1                  PIC X(6).
  7048
  7049     12  RQ-CONTROL-BY-FIN-RESP.
  7050         16  RQ-COMPANY-CD-A2             PIC X.
  7051         16  RQ-CARRIER-A2                PIC X.
  7052         16  RQ-GROUPING-A2               PIC X(6).
  7053         16  RQ-FIN-RESP-A2               PIC X(10).
  7054         16  RQ-ACCT-AGENT-A2             PIC X(10).
  7055         16  RQ-REFERENCE-A2              PIC X(12).
  7056         16  RQ-BATCH-A2                  PIC X(6).
  7057
  7058     12  RQ-CONTROL-BY-ACCT-AGENT.
  7059         16  RQ-COMPANY-CD-A3             PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 133
* EL6311.cbl
  7060         16  RQ-CARRIER-A3                PIC X.
  7061         16  RQ-GROUPING-A3               PIC X(6).
  7062         16  RQ-ACCT-AGENT-A3             PIC X(10).
  7063         16  RQ-BATCH-A3                  PIC X(6).
  7064
  7065     12  RQ-CONTROL-BY-SUMMARY.
  7066         16  RQ-COMPANY-CD-A4             PIC X.
  7067         16  RQ-SUMMARY-CODE              PIC X(6).
  7068         16  RQ-ACCOUNT-A4                PIC X(10).
  7069         16  RQ-REFERENCE-A4              PIC X(12).
  7070         16  RQ-BATCH-A4                  PIC X(6).
  7071
  7072     12  RQ-REQUEST-METHOD                PIC X.
  7073         88 RQ-FIN-RESP-REQUEST               VALUE 'F'.
  7074         88 RQ-ACCT-AGENT-REQUEST             VALUE 'A'.
  7075         88 RQ-SUMMARY-REQUEST                VALUE 'S'.
  7076         88 RQ-BATCH-REQUEST                  VALUE 'B'.
  7077     12  FILLER                           PIC X.
  7078     12  RQ-STATUS                        PIC X.
  7079         88  RQ-REQUEST-ERROR                 VALUE 'E'.
  7080         88  RQ-RESUBMIT                      VALUE 'R'.
  7081     12  RQ-PROCESSOR-ID                  PIC X(4).
  7082     12  RQ-ENTRY-DT                      PIC XX.
  7083     12  RQ-MO-END-DT                     PIC XX.
  7084     12  RQ-REQUEST-DT                    PIC XX.
  7085     12  RQ-STMT-DT                       PIC XX.
  7086     12  RQ-REVERSAL-DT                   PIC XX.
  7087     12  RQ-CREDIT-SELECT-DT              PIC XX.
  7088     12  RQ-CREDIT-ACCEPT-DT              PIC XX.
  7089
  7090     12  FILLER                           PIC X(27).
  7091
  7092******************************************************************
  7093
  7094
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 134
* EL6311.cbl
  7096*    COPY ERCLOFC.
  7097******************************************************************
  7098*                                                                *
  7099*                                                                *
  7100*                            ERCLOFC                             *
  7101*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7102*                            VMOD=2.003                          *
  7103*                                                                *
  7104*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *
  7105*                                                                *
  7106*   FILE TYPE = VSAM,KSDS                                        *
  7107*   RECORD SIZE = 670   RECFORM = FIX                            *
  7108*                                                                *
  7109*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *
  7110*                                                                *
  7111*   LOG = YES                                                    *
  7112*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7113*                                                                *
  7114******************************************************************
  7115
  7116 01  LOAN-OFFICER-MASTER.
  7117     12  LO-RECORD-ID                PIC XX.
  7118         88  VALID-LO-ID                VALUE 'LO'.
  7119
  7120     12  LO-CONTROL-PRIMARY.
  7121         16  LO-COMPANY-CD           PIC X.
  7122         16  LO-CARRIER              PIC X.
  7123         16  LO-GROUPING.
  7124             20  LO-GROUPING-PREFIX  PIC XXX.
  7125             20  LO-GROUPING-PRIME   PIC XXX.
  7126         16  LO-STATE                PIC XX.
  7127         16  LO-ACCOUNT.
  7128             20  LO-ACCOUNT-PREFIX   PIC X(4).
  7129             20  LO-ACCOUNT-PRIME    PIC X(6).
  7130         16  LO-OFFICER-CODE         PIC X(5).
  7131
  7132     12  LO-OFFICER-NAME             PIC X(30).
  7133
  7134     12  LO-LAST-MAINT-DT            PIC XX.
  7135     12  LO-LAST-USER                PIC X(4).
  7136     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.
  7137
  7138     12  LO-COMP-CONTROL             PIC X.
  7139             88  LO-SHOW-COMP           VALUE 'Y'.
  7140             88  LO-SUPPRESS-COMP       VALUE 'N'.
  7141     12  LO-DETAIL-CONTROL           PIC X.
  7142             88  LO-PRINT-DETAIL        VALUE 'D'.
  7143             88  LO-PRINT-SUMMARY       VALUE 'S'.
  7144
  7145     12  LO-SV-CARRIER               PIC X.
  7146     12  LO-SV-GROUPING              PIC X(6).
  7147     12  LO-SV-STATE                 PIC XX.
  7148
  7149     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.
  7150     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.
  7151
  7152     12  LO-OFFICER-INFO.
  7153         16  FILLER OCCURS 12 TIMES.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 135
* EL6311.cbl
  7154             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.
  7155             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.
  7156             20  LO-LF-COUNT         PIC S9(5) COMP-3.
  7157             20  LO-LF-PREM          PIC S9(7) COMP-3.
  7158             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.
  7159             20  LO-AH-COUNT         PIC S9(5) COMP-3.
  7160             20  LO-AH-PREM          PIC S9(7) COMP-3.
  7161             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.
  7162     12  FILLER                      PIC X(198).
  7163******************************************************************
  7164
  7165*    COPY ERCPYAJ.
  7166******************************************************************
  7167*                                                                *
  7168*                            ERCPYAJ                             *
  7169*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7170*                            VMOD=2.015                          *
  7171*                                                                *
  7172*   FILE DESCRIPTION = PENDING PAYMENT AND ADJUSTMENTS           *
  7173*                                                                *
  7174*                                                                *
  7175*   FILE TYPE = VSAM,KSDS                                        *
  7176*   RECORD SIZE = 200  RECFORM = FIXED                           *
  7177*                                                                *
  7178*   BASE CLUSTER = ERPYAJ                         RKP=2,LEN=33   *
  7179*       ALTERNATE PATHS = NONE                                   *
  7180*                                                                *
  7181*   LOG = YES                                                    *
  7182*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7183******************************************************************
  7184******************************************************************
  7185*                   C H A N G E   L O G
  7186*
  7187* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7188*-----------------------------------------------------------------
  7189*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7190* EFFECTIVE    NUMBER
  7191*-----------------------------------------------------------------
  7192* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
  7193* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
  7194******************************************************************
  7195
  7196 01  PENDING-PAY-ADJ.
  7197     12  PY-RECORD-ID                     PIC XX.
  7198         88  VALID-PY-ID                        VALUE 'PY'.
  7199
  7200     12  PY-CONTROL-PRIMARY.
  7201         16  PY-COMPANY-CD                PIC X.
  7202         16  PY-CARRIER                   PIC X.
  7203         16  PY-GROUPING                  PIC X(6).
  7204         16  PY-FIN-RESP                  PIC X(10).
  7205         16  PY-ACCOUNT                   PIC X(10).
  7206         16  PY-PRODUCER REDEFINES PY-ACCOUNT
  7207                                          PIC X(10).
  7208         16  PY-FILE-SEQ-NO               PIC S9(8)     COMP.
  7209         16  PY-RECORD-TYPE               PIC X.
  7210             88  PY-REMIT-RECEIVED            VALUE 'R'.
  7211             88  PY-DEPOSIT                   VALUE 'D'.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 136
* EL6311.cbl
  7212             88  PY-CHARGE-TO-AGENT           VALUE 'C'.
  7213             88  PY-ADJ-REM-RECEIVED          VALUE 'S'.
  7214             88  PY-ADJ-DEPOSIT               VALUE 'T'.
  7215             88  PY-ADJ-CHG-TO-AGT            VALUE 'U'.
  7216             88  PY-ADD-TO-YTD-COMP           VALUE 'X'.
  7217             88  PY-SUBTRACT-YTD-COMP         VALUE 'Y'.
  7218             88  PY-ADD-TO-BALANCE            VALUE 'Z'.
  7219             88  PY-FICA-ENTRY                VALUE 'F'.
  7220             88  PY-REMIT-IND-GROUPING        VALUE 'G'.
  7221             88  PY-POLICY-FEE                VALUE 'W'.
  7222             88  PY-DUE-PREM-ADJ              VALUE 'P'.
  7223
  7224     12  PY-PYMT-TYPE                     PIC X.
  7225             88  PY-NEW-BUS-PYMT              VALUE 'B'.
  7226             88  PY-REINS-PYMT                VALUE 'R'.
  7227             88  PY-EXP-PYMT                  VALUE 'E'.
  7228
  7229     12  PY-BIL-INV                       PIC X(6).
  7230     12  PY-REF-NO                        PIC X(12).
  7231
  7232     12  PY-LAST-MAINT-DT                 PIC XX.
  7233     12  PY-LAST-MAINT-BY                 PIC X(4).
  7234     12  PY-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  7235
  7236     12  PY-PYADJ-RECORD.
  7237         16  PY-ENTRY-AMT                 PIC S9(7)V99  COMP-3.
  7238         16  PY-ENTRY-COMMENT             PIC X(30).
  7239         16  PY-GL-DATA      REDEFINES PY-ENTRY-COMMENT.
  7240             20  PY-GL-ACCOUNT            PIC X(10).
  7241             20  PY-GL-STATE              PIC X(02).
  7242             20  PY-GL-CANC-SW            PIC X(01).
  7243                 88  PY-GL-CANC-SW-ON     VALUE 'Y'.
  7244                 88  PY-GL-CANC-SW-OFF    VALUE 'N'.
  7245             20  PY-GL-COMMENT            PIC X(10).
  7246             20  FILLER      REDEFINES PY-GL-COMMENT.
  7247                 24  PY-GL-CHECK-NO       PIC 9(06).
  7248                 24  FILLER               PIC X(04).
  7249             20  FILLER                   PIC X(07).
  7250         16  PY-SAVE-ACCOUNT              PIC X(10).
  7251         16  PY-SAVE-TYPE                 PIC X(01).
  7252
  7253         16  PY-LETTERS.
  7254             20  PY-LETTER OCCURS 3 TIMES
  7255                           INDEXED BY PY-LET-NDX
  7256                                          PIC X(04).
  7257
  7258         16  PY-ERCOMP-TYPE               PIC X.
  7259             88  PY-ACCOUNT-TYPE              VALUE 'A'.
  7260             88  PY-GA-TYPE                   VALUE 'G'.
  7261             88  PY-BANK-TYPE                 VALUE 'B'.
  7262         16  FILLER                       PIC X(05).
  7263
  7264     12  PY-RECORD-STATUS.
  7265         16  PY-CREDIT-SELECT-DT          PIC XX.
  7266         16  PY-CREDIT-ACCEPT-DT          PIC XX.
  7267         16  PY-BILLED-DATE               PIC XX.
  7268         16  PY-REPORTED-DT               PIC XX.
  7269         16  PY-PMT-APPLIED               PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 137
* EL6311.cbl
  7270             88  PY-ACCOUNT-PMT               VALUE 'A'.
  7271             88  PY-GA-PMT                    VALUE 'G'.
  7272             88  PY-OVWRITE-PMT               VALUE 'O'.
  7273             88  PY-NON-AR-PMT                VALUE 'N'.
  7274         16  FILLER                       PIC X(5).
  7275         16  PY-INPUT-DT                  PIC XX.
  7276         16  PY-CHECK-NUMBER              PIC X(6).
  7277         16  PY-VOID-SW                   PIC X.
  7278             88  PY-CHECK-VOIDED              VALUE 'V'.
  7279         16  PY-CHECK-ORIGIN-SW           PIC X.
  7280             88  PY-BILLING-CHECK             VALUE 'B'.
  7281             88  PY-REFUND-CHECK              VALUE 'R'.
  7282             88  PY-GA-CHECK                  VALUE 'G'.
  7283             88  PY-CHECK-WRITTEN             VALUE 'W'.
  7284             88  PY-CHECK-REVERSAL            VALUE 'V'.
  7285         16  PY-CHECK-WRITTEN-DT          PIC XX.
  7286         16  PY-CHECK-QUE-CONTROL         PIC S9(8) COMP.
  7287         16  PY-CHECK-QUE-SEQUENCE        PIC S9(4) COMP.
  7288         16  PY-BILL-FLAG                 PIC X.
  7289             88  PY-BILLED                    VALUE 'B'.
  7290         16  PY-AR-FLAG                   PIC X.
  7291             88  PY-AR-CYCLE                  VALUE 'C'.
  7292             88  PY-AR-MONTH-END              VALUE 'M'.
  7293         16  PY-AR-DATE                   PIC XX.
  7294
  7295     12  PY-GL-CODES.
  7296         16  PY-GL-DB                     PIC X(14).
  7297         16  PY-GL-CR                     PIC X(14).
  7298         16  PY-GL-FLAG                   PIC X.
  7299         16  PY-GL-DATE                   PIC XX.
  7300
  7301     12  PY-CANCEL-FEE-FLAG               PIC X(2).
  7302     12  FILLER                           PIC X(3).
  7303******************************************************************
  7304
  7305*    COPY ERCCNOT.
  7306******************************************************************
  7307*                                                                *
  7308*                            ERCCNOT                             *
  7309*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7310*                            VMOD=2.003                          *
  7311*                                                                *
  7312*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  7313*                                                                *
  7314*        FILE TYPE= VSAM,KSDS                                    *
  7315*        RECORD SIZE = 150    RECFORM = FIXED                    *
  7316*                                                                *
  7317*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  7318*                                                                *
  7319*        LOG = YES                                               *
  7320*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7321*                                                                *
  7322******************************************************************
  7323*                   C H A N G E   L O G
  7324*
  7325* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7326*-----------------------------------------------------------------
  7327*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 138
* EL6311.cbl
  7328* EFFECTIVE    NUMBER
  7329*-----------------------------------------------------------------
  7330* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  7331******************************************************************
  7332
  7333 01  CERT-NOTE-FILE.
  7334     12  CZ-RECORD-ID                PIC  XX.
  7335         88  VALID-CZ-ID                  VALUE 'CZ'.
  7336
  7337     12  CZ-CONTROL-PRIMARY.
  7338         16  CZ-COMPANY-CD           PIC X.
  7339         16  CZ-CARRIER              PIC X.
  7340         16  CZ-GROUPING.
  7341             20 CZ-GROUPING-PREFIX   PIC XXX.
  7342             20 CZ-GROUPING-PRIME    PIC XXX.
  7343         16  CZ-STATE                PIC XX.
  7344         16  CZ-ACCOUNT.
  7345             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  7346             20 CZ-ACCOUNT-PRIME     PIC X(6).
  7347         16  CZ-CERT-EFF-DT          PIC XX.
  7348         16  CZ-CERT-NO.
  7349             20  CZ-CERT-PRIME       PIC X(10).
  7350             20  CZ-CERT-SFX         PIC X.
  7351         16  CZ-RECORD-TYPE          PIC X.
  7352             88  CERT-NOTE           VALUE '1'.
  7353             88  CLAIM-CERT-NOTE     VALUE '2'.
  7354         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  7355
  7356     12  CZ-LAST-MAINT-DT            PIC XX.
  7357     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  7358     12  CZ-LAST-MAINT-USER          PIC X(4).
  7359
  7360     12  CZ-NOTE-INFORMATION.
  7361         16  CZ-NOTE                 PIC X(63).
  7362         16  FILLER                  PIC X(39).
  7363******************************************************************
  7364
  7365*    COPY ELCMSTR.
  7366******************************************************************
  7367*                                                                *
  7368*                            ELCMSTR.                            *
  7369*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7370*                            VMOD=2.012                          *
  7371*                                                                *
  7372*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  7373*                                                                *
  7374*   FILE TYPE = VSAM,KSDS                                        *
  7375*   RECORD SIZE = 350  RECFORM = FIXED                           *
  7376*                                                                *
  7377*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  7378*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  7379*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  7380*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  7381*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  7382*                                                 RKP=75,LEN=21  *
  7383*                                                                *
  7384*   **** NOTE ****                                               *
  7385*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 139
* EL6311.cbl
  7386*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  7387*                                                                *
  7388*   LOG = YES                                                    *
  7389*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7390******************************************************************
  7391*                   C H A N G E   L O G
  7392*
  7393* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7394*-----------------------------------------------------------------
  7395*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7396* EFFECTIVE    NUMBER
  7397*-----------------------------------------------------------------
  7398* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  7399* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  7400* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  7401******************************************************************
  7402 01  CLAIM-MASTER.
  7403     12  CL-RECORD-ID                PIC XX.
  7404         88  VALID-CL-ID         VALUE 'CL'.
  7405
  7406     12  CL-CONTROL-PRIMARY.
  7407         16  CL-COMPANY-CD           PIC X.
  7408         16  CL-CARRIER              PIC X.
  7409         16  CL-CLAIM-NO             PIC X(7).
  7410         16  CL-CERT-NO.
  7411             20  CL-CERT-PRIME       PIC X(10).
  7412             20  CL-CERT-SFX         PIC X.
  7413
  7414     12  CL-CONTROL-BY-NAME.
  7415         16  CL-COMPANY-CD-A1        PIC X.
  7416         16  CL-INSURED-LAST-NAME    PIC X(15).
  7417         16  CL-INSURED-NAME.
  7418             20  CL-INSURED-1ST-NAME PIC X(12).
  7419             20  CL-INSURED-MID-INIT PIC X.
  7420
  7421     12  CL-CONTROL-BY-SSN.
  7422         16  CL-COMPANY-CD-A2        PIC X.
  7423         16  CL-SOC-SEC-NO.
  7424             20  CL-SSN-STATE        PIC XX.
  7425             20  CL-SSN-ACCOUNT      PIC X(6).
  7426             20  CL-SSN-LN3          PIC X(3).
  7427
  7428     12  CL-CONTROL-BY-CERT-NO.
  7429         16  CL-COMPANY-CD-A4        PIC X.
  7430         16  CL-CERT-NO-A4.
  7431             20  CL-CERT-A4-PRIME    PIC X(10).
  7432             20  CL-CERT-A4-SFX      PIC X.
  7433
  7434     12  CL-CONTROL-BY-CCN.
  7435         16  CL-COMPANY-CD-A5        PIC X.
  7436         16  CL-CCN-A5.
  7437             20  CL-CCN.
  7438                 24  CL-CCN-PREFIX-A5 PIC X(4).
  7439                 24  CL-CCN-PRIME-A5 PIC X(12).
  7440             20  CL-CCN-FILLER-A5    PIC X(4).
  7441
  7442     12  CL-INSURED-PROFILE-DATA.
  7443         16  CL-INSURED-BIRTH-DT     PIC XX.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 140
* EL6311.cbl
  7444         16  CL-INSURED-SEX-CD       PIC X.
  7445             88  INSURED-IS-MALE        VALUE 'M'.
  7446             88  INSURED-IS-FEMALE      VALUE 'F'.
  7447             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  7448         16  CL-INSURED-OCC-CD       PIC X(6).
  7449         16  FILLER                  PIC X(5).
  7450
  7451     12  CL-PROCESSING-INFO.
  7452         16  CL-PROCESSOR-ID         PIC X(4).
  7453         16  CL-CLAIM-STATUS         PIC X.
  7454             88  CLAIM-IS-OPEN          VALUE 'O'.
  7455             88  CLAIM-IS-CLOSED        VALUE 'C'.
  7456         16  CL-CLAIM-TYPE           PIC X.
  7457*            88  AH-CLAIM               VALUE 'A'.
  7458*            88  LIFE-CLAIM             VALUE 'L'.
  7459*            88  PROPERTY-CLAIM         VALUE 'P'.
  7460*            88  IUI-CLAIM              VALUE 'I'.
  7461*            88  GAP-CLAIM              VALUE 'G'.
  7462         16  CL-CLAIM-PREM-TYPE      PIC X.
  7463             88  SINGLE-PREMIUM         VALUE '1'.
  7464             88  O-B-COVERAGE           VALUE '2'.
  7465             88  OPEN-END-COVERAGE      VALUE '3'.
  7466         16  CL-INCURRED-DT          PIC XX.
  7467         16  CL-REPORTED-DT          PIC XX.
  7468         16  CL-FILE-ESTABLISH-DT    PIC XX.
  7469         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  7470         16  CL-LAST-PMT-DT          PIC XX.
  7471         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  7472         16  CL-PAID-THRU-DT         PIC XX.
  7473         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  7474         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  7475         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  7476         16  CL-PMT-CALC-METHOD      PIC X.
  7477             88  CL-360-DAY-YR          VALUE '1'.
  7478             88  CL-365-DAY-YR          VALUE '2'.
  7479             88  CL-FULL-MONTHS         VALUE '3'.
  7480         16  CL-CAUSE-CD             PIC X(6).
  7481
  7482         16  CL-PRIME-CERT-NO.
  7483             20  CL-PRIME-CERT-PRIME PIC X(10).
  7484             20  CL-PRIME-CERT-SFX   PIC X.
  7485
  7486         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  7487             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  7488             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  7489
  7490         16  CL-MICROFILM-NO         PIC X(10).
  7491         16  CL-PROG-FORM-TYPE       PIC X.
  7492         16  CL-LAST-ADD-ON-DT       PIC XX.
  7493
  7494         16  CL-LAST-REOPEN-DT       PIC XX.
  7495         16  CL-LAST-CLOSE-DT        PIC XX.
  7496         16  CL-LAST-CLOSE-REASON    PIC X(01).
  7497             88  FINAL-PAID             VALUE '1'.
  7498             88  CLAIM-DENIED           VALUE '2'.
  7499             88  AUTO-CLOSE             VALUE '3'.
  7500             88  MANUAL-CLOSE           VALUE '4'.
  7501             88  BENEFITS-CHANGED       VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 141
* EL6311.cbl
  7502             88  SETUP-ERRORS           VALUE 'E'.
  7503         16  CL-ASSOC-CERT-SEQU      PIC S99.
  7504         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  7505         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  7506             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  7507         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  7508         16  FILLER                  PIC X.
  7509
  7510     12  CL-CERTIFICATE-DATA.
  7511         16  CL-CERT-ORIGIN          PIC X.
  7512             88  CERT-WAS-ONLINE        VALUE '1'.
  7513             88  CERT-WAS-CREATED       VALUE '2'.
  7514             88  COVERAGE-WAS-ADDED     VALUE '3'.
  7515         16  CL-CERT-KEY-DATA.
  7516             20  CL-CERT-CARRIER     PIC X.
  7517             20  CL-CERT-GROUPING    PIC X(6).
  7518             20  CL-CERT-STATE       PIC XX.
  7519             20  CL-CERT-ACCOUNT.
  7520                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  7521                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  7522             20  CL-CERT-EFF-DT      PIC XX.
  7523
  7524     12  CL-STATUS-CONTROLS.
  7525         16  CL-PRIORITY-CD          PIC X.
  7526             88  CONFIDENTIAL-DATA      VALUE '8'.
  7527             88  HIGHEST-PRIORITY       VALUE '9'.
  7528         16  CL-SUPV-ATTN-CD         PIC X.
  7529             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  7530             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  7531         16  CL-PURGED-DT            PIC XX.
  7532         16  CL-RESTORED-DT          PIC XX.
  7533         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  7534         16  CL-NEXT-RESEND-DT       PIC XX.
  7535         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  7536         16  CL-CRITICAL-PERIOD      PIC 99.
  7537*        16  FILLER                  PIC XX.
  7538         16  CL-LAST-MAINT-DT        PIC XX.
  7539         16  CL-LAST-MAINT-USER      PIC X(4).
  7540         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  7541         16  CL-LAST-MAINT-TYPE      PIC X.
  7542             88  CLAIM-SET-UP           VALUE ' '.
  7543             88  PAYMENT-MADE           VALUE '1'.
  7544             88  LETTER-SENT            VALUE '2'.
  7545             88  MASTER-WAS-ALTERED     VALUE '3'.
  7546             88  MASTER-WAS-RESTORED    VALUE '4'.
  7547             88  INCURRED-DATE-CHANGED  VALUE '5'.
  7548             88  FILE-CONVERTED         VALUE '6'.
  7549             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  7550             88  ERROR-CORRECTION       VALUE 'E'.
  7551         16  CL-RELATED-CLAIM-NO     PIC X(7).
  7552         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  7553         16  CL-BENEFICIARY          PIC X(10).
  7554         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  7555         16  CL-DENIAL-TYPE          PIC X.
  7556             88  CL-TYPE-DENIAL          VALUE '1'.
  7557             88  CL-TYPE-RESCISSION      VALUE '2'.
  7558             88  CL-TYPE-REFORMATION     VALUE '3'.
  7559             88  CL-TYPE-REF-TO-RES      VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 142
* EL6311.cbl
  7560             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  7561         16  CL-CRIT-PER-RECURRENT   PIC X.
  7562         16  CL-CRIT-PER-RTW-MOS     PIC 99.
  7563         16  CL-RTW-DT               PIC XX.
  7564
  7565     12  CL-TRAILER-CONTROLS.
  7566         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  7567             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  7568             88  CL-LAST-TRL-AVAIL      VALUE +100.
  7569             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  7570         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  7571         16  FILLER                  PIC XX.
  7572         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  7573         16  CL-ADDRESS-TRAILER-CNT.
  7574             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  7575                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  7576             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  7577                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  7578             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  7579                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  7580             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  7581                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  7582             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  7583                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  7584             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  7585                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  7586             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  7587                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  7588
  7589     12  CL-CV-REFERENCE-NO.
  7590         16  CL-CV-REFNO-PRIME       PIC X(18).
  7591         16  CL-CV-REFNO-SFX         PIC XX.
  7592
  7593     12  CL-FILE-LOCATION            PIC X(4).
  7594
  7595     12  CL-PROCESS-ERRORS.
  7596         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  7597             88  NO-FATAL-ERRORS        VALUE ZERO.
  7598         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  7599             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  7600
  7601     12  CL-PRODUCT-CD               PIC X.
  7602
  7603     12  CL-CURRENT-KEY-DATA.
  7604         16  CL-CURRENT-CARRIER      PIC X.
  7605         16  CL-CURRENT-GROUPING     PIC X(6).
  7606         16  CL-CURRENT-STATE        PIC XX.
  7607         16  CL-CURRENT-ACCOUNT      PIC X(10).
  7608
  7609     12  CL-ASSOCIATES               PIC X.
  7610         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  7611         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  7612         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  7613         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  7614
  7615     12  CL-ACTIVITY-CODE            PIC 99.
  7616     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  7617     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 143
* EL6311.cbl
  7618
  7619     12  CL-LAPSE-REPORT-CODE        PIC 9.
  7620     12  CL-LAG-REPORT-CODE          PIC 9.
  7621     12  CL-LOAN-TYPE                PIC XX.
  7622     12  CL-LEGAL-STATE              PIC XX.
  7623
  7624     12  CL-YESNOSW                  PIC X.
  7625     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  7626         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  7627         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  7628         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  7629     12  cl-insured-claim            pic x.
  7630         88  cl-claim-on-primary         value 'P'.
  7631         88  cl-claim-on-secondary       value 'S'.
  7632     12  cl-benefit-expiration-dt    PIC XX.
  7633
  7634*    COPY ERCENDT.
  7635******************************************************************
  7636*                                                                *
  7637*                                                                *
  7638*                            ERCENDT.                            *
  7639*                            VMOD=2.001                          *
  7640*                                                                *
  7641*   FILE DESCRIPTION = ENDORSEMENT FILE                          *
  7642*                                                                *
  7643*   FILE TYPE = VSAM,KSDS                                        *
  7644*   RECORD SIZE = 579  RECFORM = FIXED                           *
  7645*                                                                *
  7646*   BASE CLUSTER = ERENDT                         RKP=02,LEN=36  *
  7647*       ALTERNATE PATH1 = ERENDT2 (BY ARCH NO)    RKP=38,LEN=05  *
  7648*                                                                *
  7649*   LOG = NO                                                     *
  7650*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7651******************************************************************
  7652*-----------------------------------------------------------------
  7653*                   C H A N G E   L O G
  7654*
  7655* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7656*-----------------------------------------------------------------
  7657*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7658* EFFECTIVE    NUMBER
  7659*-----------------------------------------------------------------
  7660* 052307    2006052600001  AJRA  ADDED FLAG FOR CANCELS ON CERTS
  7661*                                WITH OPEN CLAIMS
  7662* 072312    2011022800001  AJRA  ADDED BATCH NUMBER
  7663* 110612    2012101700002  AJRA  ADD NEW FIELDS
  7664* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7665*-----------------------------------------------------------------
  7666 01  ENDORSEMENT-RECORD.
  7667     12  EN-RECORD-ID                PIC XX.
  7668         88  VALID-EN-ID                VALUE 'EN'.
  7669     12  EN-CONTROL-PRIMARY.
  7670         16  EN-COMPANY-CD           PIC X.
  7671         16  EN-CARRIER              PIC X.
  7672         16  EN-GROUPING             PIC X(6).
  7673         16  EN-STATE                PIC XX.
  7674         16  EN-ACCOUNT              PIC X(10).
  7675         16  EN-CERT-EFF-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 144
* EL6311.cbl
  7676         16  EN-CERT-NO.
  7677             20  EN-CERT-PRIME       PIC X(10).
  7678             20  EN-CERT-SFX         PIC X.
  7679         16  EN-REC-TYPE             PIC X.
  7680             88  EN-ISSUE               VALUE 'I'.
  7681             88  EN-CANCELLATION        VALUE 'C'.
  7682         16  EN-SEQ-NO               PIC 9(04) BINARY.
  7683     12  EN-CONTROL-BY-ARCH-NO.
  7684         16  EN-COMPANY-CD-A1              PIC X.
  7685         16  EN-ARCHIVE-NO                 PIC 9(8) BINARY.
  7686     12  EN-LAST-MAINT-DT            PIC XX.
  7687     12  EN-LAST-MAINT-BY            PIC X(4).
  7688     12  EN-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  7689     12  EN-ENDORSEMENT-RECORD       PIC X(329).
  7690     12  EN-ISSUE-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  7691         16  EN-INS-ORIG-LAST-NAME   PIC X(15).
  7692         16  EN-INS-ORIG-FIRST-NAME  PIC X(10).
  7693         16  EN-INS-ORIG-MIDDLE-INIT PIC X.
  7694         16  EN-INS-ORIG-AGE         PIC S999     COMP-3.
  7695         16  EN-JNT-ORIG-LAST-NAME   PIC X(15).
  7696         16  EN-JNT-ORIG-FIRST-NAME  PIC X(10).
  7697         16  EN-JNT-ORIG-MIDDLE-INIT PIC X.
  7698         16  EN-JNT-ORIG-AGE         PIC S999     COMP-3.
  7699         16  EN-LF-ORIG-BENCD        PIC XX.
  7700         16  EN-LF-ORIG-TERM         PIC S999      COMP-3.
  7701         16  EN-LF-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  7702         16  EN-LF-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  7703         16  EN-LF-ORIG-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
  7704         16  EN-LF-ORIG-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
  7705         16  EN-LF-ORIG-EXP-DT       PIC XX.
  7706*        16  EN-LF-ORIG-COV-TYPE     PIC X(10).
  7707         16  EN-ORIG-CRED-BENE       PIC X(25).
  7708         16  EN-LF-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  7709         16  FILLER                  PIC X.
  7710         16  EN-AH-ORIG-BENCD        PIC XX.
  7711         16  EN-AH-ORIG-TERM         PIC S999      COMP-3.
  7712         16  EN-AH-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  7713         16  EN-AH-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  7714         16  EN-AH-ORIG-EXP-DT       PIC XX.
  7715*        16  EN-AH-ORIG-COV-TYPE     PIC X(10).
  7716*        16  EN-AH-ORIG-WAIT-PER     PIC 99.
  7717         16  EN-AH-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  7718         16  F                       PIC X(09).
  7719         16  EN-AH-ORIG-CP           PIC 99.
  7720         16  EN-INS-NEW-LAST-NAME    PIC X(15).
  7721         16  EN-INS-NEW-FIRST-NAME   PIC X(10).
  7722         16  EN-INS-NEW-MIDDLE-INIT  PIC X.
  7723         16  EN-INS-NEW-AGE          PIC S999     COMP-3.
  7724         16  EN-JNT-NEW-LAST-NAME    PIC X(15).
  7725         16  EN-JNT-NEW-FIRST-NAME   PIC X(10).
  7726         16  EN-JNT-NEW-MIDDLE-INIT  PIC X.
  7727         16  EN-JNT-NEW-AGE          PIC S999     COMP-3.
  7728         16  EN-LF-NEW-BENCD         PIC XX.
  7729         16  EN-LF-NEW-TERM          PIC S999      COMP-3.
  7730         16  EN-LF-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  7731         16  EN-LF-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  7732         16  EN-LF-NEW-ALT-BEN-AMT   PIC S9(9)V99  COMP-3.
  7733         16  EN-LF-NEW-ALT-PRM-AMT   PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 145
* EL6311.cbl
  7734         16  EN-LF-NEW-EXP-DT        PIC XX.
  7735         16  EN-NEW-CRED-BENE        PIC X(25).
  7736         16  EN-LF-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  7737         16  FILLER                  PIC X.
  7738         16  EN-AH-NEW-BENCD         PIC XX.
  7739         16  EN-AH-NEW-TERM          PIC S999      COMP-3.
  7740         16  EN-AH-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  7741         16  EN-AH-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  7742         16  EN-AH-NEW-EXP-DT        PIC XX.
  7743*        16  EN-AH-NEW-COV-TYPE      PIC X(10).
  7744*        16  EN-AH-NEW-WAIT-PER      PIC 99.
  7745*        16  F                       PIC X(12).
  7746         16  EN-AH-NEW-CP            PIC 99.
  7747         16  EN-SIG-SW               PIC X.
  7748         16  EN-AH-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  7749         16  EN-INS-ORIG-AGE-DEF-FLAG PIC X.
  7750         16  EN-JNT-ORIG-AGE-DEF-FLAG PIC X.
  7751         16  EN-INS-NEW-AGE-DEF-FLAG PIC X.
  7752         16  EN-JNT-NEW-AGE-DEF-FLAG PIC X.
  7753         16  FILLER                  PIC X(33).
  7754     12  EN-CANCEL-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  7755         16  EN-LF-ORIG-REF-DT       PIC XX.
  7756         16  EN-LF-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  7757         16  EN-AH-ORIG-REF-DT       PIC XX.
  7758         16  EN-AH-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  7759         16  EN-LF-NEW-REF-DT        PIC XX.
  7760         16  EN-LF-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  7761         16  EN-AH-NEW-REF-DT        PIC XX.
  7762         16  EN-AH-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  7763         16  EN-FLAG-CERT            PIC X.
  7764         16  EN-INS-LAST-NAME        PIC X(15).
  7765         16  EN-INS-FIRST-NAME       PIC X(10).
  7766         16  EN-INS-MIDDLE-INIT      PIC X.
  7767         16  EN-LF-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  7768         16  EN-AH-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  7769         16  EN-LF-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  7770         16  EN-AH-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  7771         16  FILLER                  PIC X(262).
  7772     12  EN-MONEY-SW             PIC X.
  7773     12  EN-HEALTH-APP           PIC X.
  7774     12  EN-VOUCHER-SW           PIC X.
  7775     12  EN-PAYEE                PIC X(14).
  7776     12  EN-INPUT-DT             PIC XX.
  7777     12  EN-PROCESS-DT           PIC XX.
  7778     12  EN-LF-COMMISSION        PIC SV9(5)    COMP-3.
  7779     12  EN-AH-COMMISSION        PIC SV9(5)    COMP-3.
  7780     12  EN-REASON-CODES.
  7781         16  F OCCURS 12.
  7782             20  EN-REASON-CODE  PIC X(4).
  7783     12  EN-TEMPLATE-USED        PIC X(8).
  7784     12  EN-DOCU-TYPE            PIC X.
  7785         88  EN-VERI-DOCU          VALUE 'V'.
  7786         88  EN-GCE-DOCU           VALUE 'G'.
  7787         88  EN-CANC-DOCU          VALUE 'C'.
  7788     12  EN-COMMENTS1            PIC X(13).
  7789     12  EN-COMMENTS2            PIC X(70).
  7790     12  EN-COMM-CHGBK           PIC X.
  7791         88  EN-DO-NOT-CHG-ACCT    VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 146
* EL6311.cbl
  7792         88  EN-CHG-ACCT           VALUE 'Y'.
  7793     12  EN-CSO-PORTION          PIC S9(5)V99  COMP-3.
  7794     12  EN-ACCT-PORTION         PIC S9(5)V99  COMP-3.
  7795     12  EN-BATCH-NUMBER         PIC X(6).
  7796     12  EN-ACCT-SUMM            PIC X.
  7797     12  EN-CSO-SUMM             PIC X.
  7798     12  FILLER                  PIC X(13).
  7799******************************************************************
  7800
  7801*    COPY ELCCRTT.
  7802******************************************************************
  7803*                                                                *
  7804*                            ELCCRTT.                            *
  7805*                                                                *
  7806*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  7807*                                                                *
  7808*   FILE TYPE = VSAM,KSDS                                        *
  7809*   RECORD SIZE = 552  RECFORM = FIXED                           *
  7810*                                                                *
  7811*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  7812*                                                                *
  7813*   LOG = YES                                                    *
  7814*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7815******************************************************************
  7816*                   C H A N G E   L O G
  7817*
  7818* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7819*-----------------------------------------------------------------
  7820*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7821* EFFECTIVE    NUMBER
  7822*-----------------------------------------------------------------
  7823* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  7824* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  7825* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  7826* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7827* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  7828******************************************************************
  7829
  7830 01  CERTIFICATE-TRAILERS.
  7831     12  CS-RECORD-ID                      PIC XX.
  7832         88  VALID-CS-ID                      VALUE 'CS'.
  7833
  7834     12  CS-CONTROL-PRIMARY.
  7835         16  CS-COMPANY-CD                 PIC X.
  7836         16  CS-CARRIER                    PIC X.
  7837         16  CS-GROUPING                   PIC X(6).
  7838         16  CS-STATE                      PIC XX.
  7839         16  CS-ACCOUNT                    PIC X(10).
  7840         16  CS-CERT-EFF-DT                PIC XX.
  7841         16  CS-CERT-NO.
  7842             20  CS-CERT-PRIME             PIC X(10).
  7843             20  CS-CERT-SFX               PIC X.
  7844         16  CS-TRAILER-TYPE               PIC X.
  7845             88  COMM-TRLR           VALUE 'A'.
  7846             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  7847             88  CERT-DATA-TRLR      VALUE 'C'.
  7848
  7849     12  CS-DATA-AREA                      PIC X(516).
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 147
* EL6311.cbl
  7850
  7851     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  7852         16  CS-BANK-COMMISSION-AREA.
  7853             20  CS-BANK-COMMS       OCCURS 10.
  7854                 24  CS-AGT                PIC X(10).
  7855                 24  CS-COM-TYP            PIC X.
  7856                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  7857                 24  CS-RECALC-LV-INDIC    PIC X.
  7858                 24  FILLER                PIC X(10).
  7859         16  FILLER                        PIC X(256).
  7860
  7861     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  7862****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  7863****  1ST OCCURANCE IS PRIMARY, 2ND IS SECONDARY INSURED
  7864         16  CS-MB-CLAIM-DATA OCCURS 2.
  7865             20  FILLER OCCURS 10.
  7866                 24  CS-CLAIM-TYPE         PIC X.
  7867                     88  CS-AH-CLM           VALUE 'A'.
  7868                     88  CS-IU-CLM           VALUE 'I'.
  7869                     88  CS-GP-CLM           VALUE 'G'.
  7870                     88  CS-LF-CLM           VALUE 'L'.
  7871                     88  CS-PR-CLM           VALUE 'P'.
  7872                 24  CS-BANK               PIC S999 COMP-3.
  7873                 24  CS-NO-OF-CLAIMS       PIC S999 COMP-3.
  7874                 24  CS-DAYS-PAID          PIC S9(7) COMP-3.
  7875                 24  CS-TOTAL-PAID         PIC S9(9)V99 COMP-3.
  7876         16  FILLER                        PIC X(216).
  7877     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  7878         16  CS-VIN-NUMBER                 PIC X(17).
  7879         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  7880         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  7881         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  7882         16  FILLER                        PIC X(496).
  7883******************************************************************
  7884
  7885 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA PENDING-BUSINESS
  7886                          CERTIFICATE-MASTER CERTIFICATE-NOTE
  7887                          PENDING-MAILING-DATA MAILING-DATA
  7888                          AR-REQUEST-RECORD LOAN-OFFICER-MASTER
  7889                          PENDING-PAY-ADJ CERT-NOTE-FILE
  7890                          CLAIM-MASTER ENDORSEMENT-RECORD
  7891                          CERTIFICATE-TRAILERS.
  7892 0000-DFHEXIT SECTION.
  7893     MOVE '9#                    $   ' TO DFHEIV0.
  7894     MOVE 'EL6311' TO DFHEIV1.
  7895     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7896
  7897     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  7898     MOVE EIBTRMID               TO QID-TERM.
  7899     MOVE 3                      TO EMI-NUMBER-OF-LINES.
  7900     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  7901     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  7902     MOVE 2                      TO EMI-SWITCH2.
  7903
  7904     IF EIBCALEN = 0
  7905         GO TO 8800-UNAUTHORIZED-ACCESS.
  7906
  7907     MOVE EIBDATE               TO DC-JULIAN-YYDDD.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 148
* EL6311.cbl
  7908     MOVE '5'                   TO DC-OPTION-CODE.
  7909     PERFORM 9700-DATE-LINK.
  7910     MOVE DC-GREG-DATE-1-EDIT   TO  WS-CURRENT-DT.
  7911     MOVE DC-BIN-DATE-1         TO  WS-CURRENT-BIN-DT.
  7912
  7913     MOVE PI-CR-MONTH-END-DT     TO DC-BIN-DATE-1.
  7914     MOVE SPACE                  TO DC-OPTION-CODE.
  7915     PERFORM 9700-DATE-LINK.
  7916     MOVE DC-GREG-DATE-1-EDIT    TO WS-MONTH-END-DT.
  7917     MOVE LOW-VALUES             TO EL631BI.
  7918
  7919
  7920* EXEC CICS HANDLE CONDITION
  7921*        PGMIDERR  (9600-PGMID-ERROR)
  7922*        ERROR     (9990-ABEND)
  7923*        INVREQ    (9990-ABEND)
  7924*        QIDERR    (0010-MAIN-LOGIC)
  7925*    END-EXEC.
  7926*    MOVE '"$L.8N                ! " #00007915' TO DFHEIV0
  7927     MOVE X'22244C2E384E202020202020' TO DFHEIV0(1:12)
  7928     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7929     MOVE X'2220233030303037393135' TO DFHEIV0(25:11)
  7930     CALL 'kxdfhei1' USING DFHEIV0
  7931     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7932
  7933
  7934     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  7935         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  7936             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  7937             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  7938             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  7939             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  7940             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  7941             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  7942             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  7943             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  7944
  7945             IF  PI-RETURN-TO-PROGRAM EQUAL 'EL631'
  7946                 PERFORM 6050-DELETE-TEMP-STORAGE THRU 6050-EXIT
  7947
  7948             ELSE
  7949                 NEXT SENTENCE
  7950
  7951         ELSE
  7952             MOVE PI-CALLING-PROGRAM   TO PGM-NAME
  7953             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  7954             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  7955             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  7956             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  7957             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  7958             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  7959             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  7960             MOVE SPACES               TO PI-SAVED-PROGRAM-6
  7961             PERFORM 6050-RECOVER-TEMP-STORAGE THRU 6050-EXIT
  7962             MOVE LOW-VALUES TO EC-NEW-CERT EC-NEW-STATE
  7963             GO TO 3900-RE-DISPLAY-RECORD
  7964     ELSE
  7965         GO TO 0020-MAIN-LOGIC.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 149
* EL6311.cbl
  7966
  7967 0010-MAIN-LOGIC.
  7968     MOVE 'Y'                    TO WS-FIRST-TIME-SW
  7969                                    WS-FIRST-ENTRY-SW.
  7970
  7971     MOVE ' '                    TO WS-CANCEL-LETTER-SW.
  7972
  7973     MOVE LOW-VALUES             TO EC-NEW-CERT
  7974                                    EC-NEW-STATE.
  7975
  7976     IF PI-DISPLAY-ORIGINAL-BATCH
  7977         NEXT SENTENCE
  7978     ELSE
  7979         IF ALL-OUT-OF-BAL   OR  ONLY-BATCH-HEADERS
  7980             GO TO 5000-BROWSE-BATCH-HEADERS.
  7981
  7982     IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  7983         GO TO 4100-BROWSE-PRIMARY-FORWARD.
  7984
  7985     IF PI-CSR-BROWSE
  7986        GO TO 4200-BROWSE-CSR-FORWARD.
  7987
  7988     IF PI-FILE-BROWSE
  7989         GO TO 4300-BROWSE-FILE-FORWARD.
  7990
  7991     GO TO 4000-BROWSE-DETAIL-FORWARD.
  7992
  7993 0020-MAIN-LOGIC.
  7994     IF EIBAID = DFHCLEAR
  7995         GO TO 9400-CLEAR.
  7996
  7997     MOVE LOW-VALUES             TO EC-NEW-CERT
  7998                                    EC-NEW-STATE.
  7999
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 150
* EL6311.cbl
  8001
  8002******************************************************************
  8003*                                                                *
  8004*              R E C E I V E   M A P                             *
  8005*                                                                *
  8006******************************************************************
  8007
  8008 0200-RECEIVE.
  8009     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  8010         MOVE ER-0008            TO EMI-ERROR
  8011         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8012         IF PI-MAP-NAME = EL631B
  8013             MOVE -1                 TO BMAINTL
  8014             GO TO 8200-SEND-DATAONLY
  8015         ELSE
  8016             IF PI-MAP-NAME = EL631C
  8017                 MOVE -1                 TO CMAINTL
  8018                 GO TO 8200-SEND-DATAONLY
  8019             ELSE
  8020                 IF PI-MAP-NAME = EL631D
  8021                     MOVE -1                 TO DPFENTRL
  8022                     GO TO 8200-SEND-DATAONLY.
  8023
  8024
  8025* EXEC CICS RECEIVE
  8026*        MAP      (PI-MAP-NAME)
  8027*        MAPSET   (MAPSET-EL6311S)
  8028*        INTO     (EL631BI)
  8029*    END-EXEC.
  8030     MOVE LENGTH OF
  8031      EL631BI
  8032       TO DFHEIV11
  8033*    MOVE '8"T I  L              ''   #00008012' TO DFHEIV0
  8034     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  8035     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8036     MOVE X'2020233030303038303132' TO DFHEIV0(25:11)
  8037     CALL 'kxdfhei1' USING DFHEIV0,
  8038           PI-MAP-NAME,
  8039           EL631BI,
  8040           DFHEIV11,
  8041           MAPSET-EL6311S,
  8042           DFHEIV99,
  8043           DFHEIV99
  8044     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8045
  8046
  8047******************************************************************
  8048*        TRANSFORM  UNDERLINE CHARACTERS TO SPACES               *
  8049******************************************************************
  8050
  8051     IF BTYPE-LEN (1) EQUAL +3
  8052        IF BTYPE (1) EQUAL ALL ' '
  8053            MOVE 'Y' TO WS-REMOVE-LF-SW.
  8054
  8055     IF BTYPE-LEN (2) EQUAL +3
  8056        IF BTYPE (2) EQUAL ALL ' '
  8057            MOVE 'Y' TO WS-REMOVE-AH-SW.
  8058
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 151
* EL6311.cbl
  8059     INSPECT EL631BI CONVERTING '_' TO ' '.
  8060
  8061     IF PI-MAP-NAME = EL631B
  8062         IF BPFENTRL GREATER THAN ZEROS
  8063             IF EIBAID NOT = DFHENTER
  8064                 MOVE ER-0004       TO EMI-ERROR
  8065                 MOVE -1            TO BPFENTRL
  8066                 MOVE AL-UNBOF      TO BPFENTRA
  8067                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8068                 GO TO 8200-SEND-DATAONLY
  8069             ELSE
  8070                 IF BPFENTRI NUMERIC AND
  8071                   (BPFENTRI GREATER 0 AND LESS 25)
  8072                     MOVE PF-VALUES (BPFENTRI) TO EIBAID
  8073                 ELSE
  8074                     MOVE ER-0029  TO EMI-ERROR
  8075                     MOVE AL-UNBON TO BPFENTRA
  8076                     MOVE -1       TO BPFENTRL
  8077                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8078                     GO TO 8200-SEND-DATAONLY
  8079         ELSE
  8080             NEXT SENTENCE
  8081     ELSE
  8082         IF PI-MAP-NAME = EL631C
  8083            IF CPFENTRL GREATER THAN ZEROS
  8084                IF EIBAID NOT = DFHENTER
  8085                 MOVE ER-0004         TO EMI-ERROR
  8086                 MOVE -1              TO CPFENTRL
  8087                 MOVE AL-UNBOF        TO CPFENTRA
  8088                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8089                 GO TO 8200-SEND-DATAONLY
  8090             ELSE
  8091                 IF CPFENTRI NUMERIC AND
  8092                   (CPFENTRI GREATER 0 AND LESS 25)
  8093                     MOVE PF-VALUES (CPFENTRI) TO EIBAID
  8094                 ELSE
  8095                     MOVE ER-0029      TO EMI-ERROR
  8096                     MOVE AL-UNBON     TO CPFENTRA
  8097                     MOVE -1           TO CPFENTRL
  8098                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8099                     GO TO 8200-SEND-DATAONLY
  8100         ELSE
  8101             NEXT SENTENCE
  8102     ELSE
  8103     IF PI-MAP-NAME = EL631D
  8104         IF DPFENTRL GREATER THAN ZEROS
  8105             IF EIBAID NOT = DFHENTER
  8106                 MOVE ER-0004         TO EMI-ERROR
  8107                 MOVE -1              TO DPFENTRL
  8108                 MOVE AL-UNBOF        TO DPFENTRA
  8109                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8110                 GO TO 8200-SEND-DATAONLY
  8111             ELSE
  8112                 IF DPFENTRI NUMERIC AND
  8113                   (DPFENTRI GREATER 0 AND LESS 25)
  8114                     MOVE PF-VALUES (DPFENTRI) TO EIBAID
  8115                 ELSE
  8116                     MOVE ER-0029      TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 152
* EL6311.cbl
  8117                     MOVE AL-UNBON     TO DPFENTRA
  8118                     MOVE -1           TO DPFENTRL
  8119                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8120                     GO TO 8200-SEND-DATAONLY.
  8121
  8122     IF EIBAID = DFHPF23
  8123         GO TO 8810-PF23.
  8124
  8125     IF EIBAID = DFHPF24
  8126         GO TO 9200-RETURN-MAIN-MENU.
  8127
  8128     IF EIBAID = DFHPF12
  8129         GO TO 9500-PF12.
  8130
  8131     IF PI-MAP-NAME = EL631B
  8132        GO TO 0300-CHECK-ISSUE-PF-KEYS.
  8133
  8134     IF PI-MAP-NAME = EL631C
  8135        GO TO 0400-CHECK-CANCEL-PF-KEYS.
  8136
  8137     IF PI-MAP-NAME = EL631D
  8138        GO TO 0500-CHECK-BATCH-PF-KEYS.
  8139
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 153
* EL6311.cbl
  8141
  8142******************************************************************
  8143*                                                                *
  8144*      ISSUE SCREEN PF KEY CHECKING                              *
  8145*                                                                *
  8146******************************************************************
  8147
  8148******************************************************************
  8149*                                                                *
  8150*      PF KEY FUNCTIONS:                                         *
  8151*                                                                *
  8152*      PF1  = BROWSE FORWARD                                     *
  8153*      PF2  = BROWSE BACKWARD                                    *
  8154*      PF3  = CERTIFICATE LOOKUP                                 *
  8155*      PF4  = DISPLAY BATCH HEADER                               *
  8156*      PF5  = ADD ISSUE  SCREEN                                  *
  8157*      PF6  = ADD CANCEL SCREEN                                  *
  8158*      PF7  = CERTIFICATE DISPLAY                                *
  8159*      PF8  = CERTIFICATE NOTES                                  *
  8160*      PF9  = EDIT CONTROL                                       *
  8161*      PF10 = DISPLAY LETTER SCREEN                              *
  8162*      PF11 = DISPLAY EXPANDED LIST OF ERRORS                    *
  8163*      PF12 = HELP SCREEN                                        *
  8164*      PF13 = CONTINUE ISSUE DISPLAY (SECOND SCREEN)             *
  8165*      PF14 = ACCOUNT MASTER                                     *
  8166*      PF15 = PROCESS CERT VERIFICATION OR GENERAL CHG ENDORSEMNT*
  8167*      PF16 = DISPLAY LETTER REVIEW                              *
  8168*                                                                *
  8169******************************************************************
  8170
  8171 0300-CHECK-ISSUE-PF-KEYS.
  8172     IF EIBAID = DFHPF9 AND PI-EDIT-SW NOT = '1'
  8173        MOVE ER-2337            TO EMI-ERROR
  8174        MOVE -1                  TO BMAINTL
  8175        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8176        GO TO 8200-SEND-DATAONLY.
  8177
  8178     IF EIBAID = DFHPF1
  8179        MOVE '0'                TO PI-EDIT-SW
  8180        IF PI-PRIMARY-BROWSE
  8181           GO TO 4100-BROWSE-PRIMARY-FORWARD
  8182        ELSE
  8183           IF PI-PRIMARY-WITH-SELECT
  8184              GO TO 4100-BROWSE-PRIMARY-FORWARD
  8185           ELSE
  8186              IF PI-FILE-BROWSE
  8187                 GO TO 4300-BROWSE-FILE-FORWARD
  8188              ELSE
  8189                 IF PI-CSR-BROWSE
  8190                    GO TO 4200-BROWSE-CSR-FORWARD
  8191                 ELSE
  8192                    GO TO 4000-BROWSE-DETAIL-FORWARD.
  8193
  8194     IF EIBAID = DFHPF2
  8195        MOVE '0'                TO PI-EDIT-SW
  8196        IF PI-PRIMARY-BROWSE
  8197           GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8198        ELSE
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 154
* EL6311.cbl
  8199           IF PI-PRIMARY-WITH-SELECT
  8200              GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8201           ELSE
  8202              IF PI-FILE-BROWSE
  8203                 GO TO 4800-BROWSE-FILE-BACKWARD
  8204              ELSE
  8205                 IF PI-CSR-BROWSE
  8206                    GO TO 4900-BROWSE-CSR-BACKWARD
  8207                 ELSE
  8208                    GO TO 4500-BROWSE-DETAIL-BACKWARD.
  8209
  8210     IF EIBAID = DFHPF3
  8211        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8212        MOVE XCTL-EL127         TO PGM-NAME
  8213        GO TO 9300-XCTL.
  8214
  8215     IF (EIBAID = DFHPF15 OR DFHPF6)
  8216        AND (CSR-EDIT-SESSION)
  8217*       AND (FATAL-OR-UNFORCED)
  8218        AND (FATAL-ERRORS)
  8219        MOVE ER-1819             TO EMI-ERROR
  8220        MOVE -1                  TO BMAINTL
  8221        MOVE AL-UANON            TO BMAINTA
  8222        PERFORM 9900-ERROR-FORMAT
  8223                                 THRU 9900-EXIT
  8224        GO TO 8200-SEND-DATAONLY
  8225     END-IF
  8226     IF (EIBAID = DFHPF15 AND CSR-EDIT-SESSION)
  8227      OR (EIBAID = DFHPF10)
  8228        MOVE PI-PREV-ALT-KEY     TO PB-CONTROL-BY-ACCOUNT
  8229        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
  8230        IF (RESP-NORMAL)
  8231           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
  8232              AM-CONTROL-PRIMARY (1:20))
  8233            IF AM-NAME NOT GREATER THAN SPACES OR
  8234               AM-ADDRS NOT GREATER THAN SPACES  OR
  8235               AM-ADDR-CITY NOT GREATER THAN SPACES OR
  8236               AM-ADDR-STATE NOT GREATER THAN SPACES OR
  8237               AM-ZIP NOT GREATER THAN SPACES
  8238               MOVE ER-3834             TO EMI-ERROR
  8239               MOVE -1                  TO BMAINTL
  8240               MOVE AL-UANON            TO BMAINTA
  8241               PERFORM 9900-ERROR-FORMAT
  8242                                 THRU 9900-EXIT
  8243               GO TO 8200-SEND-DATAONLY
  8244            END-IF
  8245        ELSE
  8246           MOVE ER-1609             TO EMI-ERROR
  8247           MOVE -1                  TO BMAINTL
  8248           MOVE AL-UANON            TO BMAINTA
  8249           PERFORM 9900-ERROR-FORMAT
  8250                                THRU 9900-EXIT
  8251           GO TO 8200-SEND-DATAONLY
  8252        END-IF
  8253
  8254        MOVE PI-PREV-ALT-KEY (1:33) TO ELCERT-KEY
  8255        PERFORM 6220-READ-ERMAIL THRU 6220-EXIT
  8256        IF (ERMAIL-FOUND)
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 155
* EL6311.cbl
  8257            IF (MA-ADDRESS-LINE-1 NOT GREATER THAN SPACES AND
  8258               MA-ADDRESS-LINE-2 NOT GREATER THAN SPACES)  OR
  8259               MA-CITY NOT GREATER THAN SPACES OR
  8260               MA-ADDR-STATE NOT GREATER THAN SPACES OR
  8261               MA-ZIP-CODE NOT GREATER THAN SPACES
  8262               MOVE ER-3835             TO EMI-ERROR
  8263               MOVE -1                  TO BMAINTL
  8264               MOVE AL-UANON            TO BMAINTA
  8265               PERFORM 9900-ERROR-FORMAT
  8266                                 THRU 9900-EXIT
  8267               GO TO 8200-SEND-DATAONLY
  8268            END-IF
  8269        ELSE
  8270           MOVE ER-3000             TO EMI-ERROR
  8271           MOVE -1                  TO BMAINTL
  8272           MOVE AL-UANON            TO BMAINTA
  8273           PERFORM 9900-ERROR-FORMAT
  8274                                THRU 9900-EXIT
  8275           GO TO 8200-SEND-DATAONLY
  8276        END-IF
  8277
  8278     END-IF
  8279     IF (EIBAID = DFHPF15)
  8280        AND (CSR-EDIT-SESSION)
  8281        MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
  8282        MOVE PI-SV-CARRIER       TO PI-CARRIER
  8283        MOVE PI-SV-GROUPING      TO PI-GROUPING
  8284        MOVE PI-SV-STATE         TO PI-STATE
  8285        MOVE ERPNDB-ACCOUNT      TO PI-ACCOUNT
  8286        MOVE BCERTNOI            TO PI-CERT-PRIME
  8287        MOVE BSUFIXI             TO PI-CERT-SFX
  8288        MOVE BEFFDTI             TO DEEDIT-FIELD
  8289        PERFORM 8600-DEEDIT
  8290        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  8291        MOVE '4'                 TO DC-OPTION-CODE
  8292        PERFORM 9700-DATE-LINK
  8293        IF DATE-CONVERSION-ERROR
  8294           MOVE ER-0348          TO EMI-ERROR
  8295           MOVE -1               TO BEFFDTL
  8296           MOVE AL-UABON         TO BEFFDTA
  8297           PERFORM 9900-ERROR-FORMAT
  8298                                 THRU 9900-EXIT
  8299           GO TO 8200-SEND-DATAONLY
  8300        ELSE
  8301           MOVE DC-BIN-DATE-1    TO PI-CERT-EFF-DT
  8302           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8303           MOVE XCTL-EL6315      TO PGM-NAME
  8304           MOVE '1'              TO PI-6315-ISS-CAN-SW
  8305           MOVE LOW-VALUES       TO PI-6315-PASS-AREA
  8306           PERFORM 6400-CHECK-FOR-RES-REF-CLAIM THRU 6400-EXIT
  8307           MOVE WS-EL6315-PASS-AREA TO PI-PROGRAM-WORK-AREA
  8308           GO TO 9300-XCTL
  8309        END-IF
  8310     END-IF
  8311
  8312     IF EIBAID = DFHPF4
  8313        MOVE '0'                TO PI-EDIT-SW
  8314        IF PI-DISPLAY-ORIGINAL-BATCH
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 156
* EL6311.cbl
  8315           NEXT SENTENCE
  8316        ELSE
  8317           GO TO 7200-DISPLAY-BATCHES.
  8318
  8319     IF EIBAID = DFHPF5
  8320        MOVE ER-0029                TO EMI-ERROR
  8321        MOVE -1                     TO BPFENTRL
  8322        MOVE AL-UNBON               TO BPFENTRA
  8323        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8324        GO TO 8200-SEND-DATAONLY.
  8325*        MOVE '0'                TO PI-EDIT-SW
  8326*        IF PI-DISPLAY-ORIGINAL-BATCH
  8327*           NEXT SENTENCE
  8328*        ELSE
  8329*           MOVE EL631B              TO PI-MAP-NAME
  8330*           MOVE LOW-VALUES          TO EL631BI
  8331*           MOVE 'A'                 TO BMAINTO
  8332*           MOVE AL-UANON            TO BMAINTA
  8333*           MOVE -1                  TO BMAINTL
  8334*           MOVE '5'                 TO PI-MAINT-FUNCTION
  8335*           GO TO 8100-SEND-INITIAL-MAP.
  8336
  8337     IF EIBAID = DFHPF6
  8338        IF NOT CSR-EDIT-SESSION
  8339           MOVE ER-0029                TO EMI-ERROR
  8340           MOVE -1                     TO BPFENTRL
  8341           MOVE AL-UNBON               TO BPFENTRA
  8342           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8343           GO TO 8200-SEND-DATAONLY
  8344*           MOVE '0'              TO PI-EDIT-SW
  8345*           IF PI-DISPLAY-ORIGINAL-BATCH
  8346*              NEXT SENTENCE
  8347*           ELSE
  8348*              MOVE EL631C        TO PI-MAP-NAME
  8349*              MOVE LOW-VALUES    TO EL631CI
  8350*              MOVE 'A'           TO CMAINTO
  8351*              MOVE AL-UANON      TO CMAINTA
  8352*              MOVE -1            TO CMAINTL
  8353*              MOVE '6'           TO PI-MAINT-FUNCTION
  8354*              GO TO 8100-SEND-INITIAL-MAP
  8355*           END-IF
  8356        ELSE
  8357           PERFORM 5100-PROCESS-POL-RESC
  8358                                 THRU 5100-EXIT
  8359           MOVE CG-BATCH-NO      TO PI-PB-ENTRY-BATCH
  8360           MOVE CG-BATCH-SEQ-NO  TO PI-PB-BATCH-SEQ-NO
  8361                                    PI-PREV-SEQ-NO
  8362           MOVE 'Y'              TO WS-FIRST-TIME-SW
  8363*                                    WS-CANCEL-LETTER-SW
  8364                                    PI-ALL-ISSUES-SW
  8365                                    PI-ALL-CANCELS-SW
  8366           GO TO 4100-BROWSE-PRIMARY-FORWARD
  8367        END-IF
  8368     END-IF
  8369     IF EIBAID = DFHPF7
  8370        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8371        MOVE PI-SV-CARRIER          TO PI-CARRIER
  8372        MOVE PI-SV-GROUPING         TO PI-GROUPING
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 157
* EL6311.cbl
  8373        MOVE PI-SV-STATE            TO PI-STATE
  8374        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  8375        MOVE BCERTNOI               TO PI-CERT-PRIME
  8376        MOVE BSUFIXI                TO PI-CERT-SFX
  8377        MOVE BEFFDTI                TO DEEDIT-FIELD
  8378        PERFORM 8600-DEEDIT
  8379        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  8380        MOVE '4'                    TO DC-OPTION-CODE
  8381        PERFORM 9700-DATE-LINK
  8382        IF DATE-CONVERSION-ERROR
  8383           MOVE ER-0348            TO EMI-ERROR
  8384           MOVE -1                  TO BEFFDTL
  8385           MOVE AL-UABON            TO BEFFDTA
  8386           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8387           GO TO 8200-SEND-DATAONLY
  8388        ELSE
  8389           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  8390           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8391           MOVE XCTL-EL1273        TO PGM-NAME
  8392           GO TO 9300-XCTL.
  8393
  8394     IF EIBAID = DFHPF8
  8395        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8396        MOVE PI-SV-CARRIER          TO PI-CARRIER
  8397        MOVE PI-SV-GROUPING         TO PI-GROUPING
  8398        MOVE PI-SV-STATE            TO PI-STATE
  8399        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  8400        MOVE BCERTNOI               TO PI-CERT-PRIME
  8401        MOVE BSUFIXI                TO PI-CERT-SFX
  8402        MOVE BEFFDTI                TO DEEDIT-FIELD
  8403        PERFORM 8600-DEEDIT
  8404        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  8405        MOVE '4'                    TO DC-OPTION-CODE
  8406        PERFORM 9700-DATE-LINK
  8407        IF DATE-CONVERSION-ERROR
  8408           MOVE ER-0348            TO EMI-ERROR
  8409           MOVE -1                  TO BEFFDTL
  8410           MOVE AL-UABON            TO BEFFDTA
  8411           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8412           GO TO 8200-SEND-DATAONLY
  8413        ELSE
  8414           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  8415           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8416           IF PI-COMPANY-ID = 'DMD'
  8417               MOVE XCTL-EL401DMD      TO PGM-NAME
  8418             ELSE
  8419               MOVE XCTL-EL1279        TO PGM-NAME
  8420           END-IF
  8421           GO TO 9300-XCTL.
  8422
  8423     IF EIBAID = DFHPF9 AND PI-EDIT-SW = '1'
  8424        MOVE XCTL-EL6312         TO PGM-NAME
  8425
  8426* EXEC CICS XCTL
  8427*           PROGRAM   (PGM-NAME)
  8428*           COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  8429*           LENGTH    (WS-COMM-LENGTH)
  8430*       END-EXEC
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 158
* EL6311.cbl
  8431*    MOVE '.$C                   %   #00008396' TO DFHEIV0
  8432     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  8433     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8434     MOVE X'2020233030303038333936' TO DFHEIV0(25:11)
  8435     CALL 'kxdfhei1' USING DFHEIV0,
  8436           PGM-NAME,
  8437           PROGRAM-INTERFACE-BLOCK,
  8438           WS-COMM-LENGTH,
  8439           DFHEIV99
  8440     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8441     ELSE
  8442        MOVE '0'                 TO  PI-EDIT-SW.
  8443
  8444     IF  EIBAID = DFHPF10
  8445         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8446         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  8447         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  8448                                    PI-1042-WA
  8449         MOVE 4                  TO PI-689-DATA-SOURCE
  8450         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  8451         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  8452         MOVE PI-SV-STATE        TO PI-689-STATE
  8453         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  8454         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  8455         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  8456         MOVE PI-PB-ALT-CHG-SEQ-NO
  8457                                 TO PI-689-ALT-SEQ-NO
  8458         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  8459         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  8460         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  8461         MOVE +0                 TO PI-689-CONTROL
  8462         MOVE LOW-VALUES         TO PI-689-DATE-EDIT
  8463                                    PI-689-EXP-DATE
  8464                                    PI-689-RESP-PERSON
  8465                                    PI-689-TYPE
  8466                                    PI-689-FOLLOW-UP-EDIT
  8467                                    PI-689-RESEND1-EDIT
  8468                                    PI-689-SEQ-EDIT
  8469                                    PI-689-BCSEQ-EDIT
  8470                                    PI-689-LBL-OVERRIDE
  8471         MOVE W-LETTER-COMMUNICATION-AREAS
  8472                                 TO PI-PROGRAM-WORK-AREA
  8473         MOVE XCTL-EL689         TO PGM-NAME
  8474         GO TO 9300-XCTL.
  8475
  8476     IF  EIBAID = DFHPF16
  8477         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8478         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  8479         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  8480                                    PI-1042-WA
  8481         MOVE 4                  TO PI-689-DATA-SOURCE
  8482         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  8483         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  8484         MOVE PI-SV-STATE        TO PI-689-STATE
  8485         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  8486         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  8487         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  8488         MOVE PI-PB-ALT-CHG-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 159
* EL6311.cbl
  8489                                 TO PI-689-ALT-SEQ-NO
  8490         MOVE PI-PB-RECORD-TYPE  TO PI-689-CHG-SEQ-NO
  8491         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  8492         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  8493         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  8494         MOVE W-LETTER-COMMUNICATION-AREAS
  8495                                 TO PI-PROGRAM-WORK-AREA
  8496         MOVE XCTL-EL690         TO PGM-NAME
  8497         GO TO 9300-XCTL.
  8498
  8499     IF EIBAID = DFHPF13
  8500         MOVE XCTL-EL6313        TO PGM-NAME
  8501         GO TO 9300-XCTL.
  8502
  8503     IF EIBAID = DFHPF17
  8504        PERFORM 6200-CREATE-VADS THRU 6200-EXIT
  8505        IF (PB-I-LOAN-APR > ZEROS)
  8506           AND (PB-I-BENEFICIARY-NAME NOT
  8507              = SPACES AND LOW-VALUES)
  8508
  8509           MOVE LINK-ELVADS          TO PGM-NAME
  8510
  8511* EXEC CICS LINK
  8512*              PROGRAM    (PGM-NAME)
  8513*              COMMAREA   (WS-PASS-AREA)
  8514*              LENGTH     (WS-PASS-AREA-LENGTH)
  8515*          END-EXEC
  8516*    MOVE '."C                   (   #00008470' TO DFHEIV0
  8517     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8518     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8519     MOVE X'2020233030303038343730' TO DFHEIV0(25:11)
  8520     CALL 'kxdfhei1' USING DFHEIV0,
  8521           PGM-NAME,
  8522           WS-PASS-AREA,
  8523           WS-PASS-AREA-LENGTH,
  8524           DFHEIV99,
  8525           DFHEIV99,
  8526           DFHEIV99,
  8527           DFHEIV99
  8528     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8529
  8530           MOVE 0000             TO EMI-ERROR
  8531           MOVE -1               TO BMAINTL
  8532           PERFORM 9900-ERROR-FORMAT
  8533                                 THRU 9900-EXIT
  8534           GO TO 8200-SEND-DATAONLY
  8535        ELSE
  8536           MOVE ER-0877            TO EMI-ERROR
  8537           MOVE -1                  TO BEFFDTL
  8538           MOVE AL-UABON            TO BEFFDTA
  8539           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8540           GO TO 8200-SEND-DATAONLY
  8541        END-IF
  8542     END-IF
  8543     IF EIBAID = DFHPF14
  8544        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8545        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
  8546        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 160
* EL6311.cbl
  8547        MOVE PI-SV-STATE            TO PI-CR-STATE
  8548        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  8549        MOVE SPACE                  TO PI-EDIT-SW
  8550        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8551        MOVE XCTL-EL650             TO PGM-NAME
  8552        GO TO 9300-XCTL.
  8553
  8554     IF EIBAID = DFHPF15
  8555        IF PI-COMPANY-ID  =  'HER'
  8556            PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8557            MOVE XCTL-EL680         TO PGM-NAME
  8558            GO TO 9300-XCTL.
  8559
  8560     IF EIBAID = DFHENTER OR DFHPF11
  8561        GO TO 1000-ISSUE-MAINLINE.
  8562
  8563     MOVE ER-0029                TO EMI-ERROR
  8564     MOVE -1                     TO BPFENTRL
  8565     MOVE AL-UNBON               TO BPFENTRA
  8566     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8567     GO TO 8200-SEND-DATAONLY.
  8568
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 161
* EL6311.cbl
  8570
  8571******************************************************************
  8572*                                                                *
  8573*      CANCEL SCREEN PF KEY CHECKING                             *
  8574*                                                                *
  8575******************************************************************
  8576
  8577******************************************************************
  8578*                                                                *
  8579*      PF KEY FUNCTIONS:                                         *
  8580*                                                                *
  8581*      PF1  = BROWSE FORWARD                                     *
  8582*      PF2  = BROWSE BACKWARD                                    *
  8583*      PF3  = CERTIFICATE LOOKUP                                 *
  8584*      PF4  = DISPLAY BATCH HEADER                               *
  8585*      PF5  = ADD ISSUE SCREEN                                   *
  8586*      PF6  = ADD CANCEL SCREEN                                  *
  8587*      PF7  = CERTIFICATE DISPLAY                                *
  8588*      PF8  = CERTIFICATE NOTES                                  *
  8589*      PF9  = EDIT CONTROL                                       *
  8590*      PF10 = DISPLAY LETTER SCREEN                              *
  8591*      PF11 = DISPLAY EXPANDED LIST OF ERRORS                    *
  8592*      PF12 = DISPLAY HELP SCREEN                                *
  8593*      PF13 = CHECK WRITER FOR CANCEL SETTLEMENTS                *
  8594*      PF14 = ACCOUNT MASTER                                     *
  8595*      PF16 = LETTER REVIEW                                      *
  8596*                                                                *
  8597******************************************************************
  8598
  8599 0400-CHECK-CANCEL-PF-KEYS.
  8600     IF EIBAID = DFHPF9 AND PI-EDIT-SW NOT = '1'
  8601        MOVE ER-2337             TO EMI-ERROR
  8602        MOVE -1                  TO CMAINTL
  8603        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8604        GO TO 8200-SEND-DATAONLY.
  8605
  8606     IF EIBAID = DFHPF1
  8607        MOVE '0'                TO PI-EDIT-SW
  8608        IF PI-PRIMARY-BROWSE
  8609           GO TO 4100-BROWSE-PRIMARY-FORWARD
  8610        ELSE
  8611           IF PI-PRIMARY-WITH-SELECT
  8612              GO TO 4100-BROWSE-PRIMARY-FORWARD
  8613           ELSE
  8614              IF PI-FILE-BROWSE
  8615                 GO TO 4300-BROWSE-FILE-FORWARD
  8616              ELSE
  8617                 IF PI-CSR-BROWSE
  8618                    GO TO 4200-BROWSE-CSR-FORWARD
  8619                 ELSE
  8620                    GO TO 4000-BROWSE-DETAIL-FORWARD.
  8621
  8622     IF EIBAID = DFHPF2
  8623        MOVE '0'                TO PI-EDIT-SW
  8624        IF PI-PRIMARY-BROWSE
  8625           GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8626        ELSE
  8627           IF PI-PRIMARY-WITH-SELECT
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 162
* EL6311.cbl
  8628              GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8629           ELSE
  8630              IF PI-FILE-BROWSE
  8631                 GO TO 4800-BROWSE-FILE-BACKWARD
  8632              ELSE
  8633                 IF PI-CSR-BROWSE
  8634                    GO TO 4900-BROWSE-CSR-BACKWARD
  8635                 ELSE
  8636                    GO TO 4500-BROWSE-DETAIL-BACKWARD.
  8637
  8638     IF EIBAID = DFHPF3
  8639        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8640        MOVE XCTL-EL127         TO PGM-NAME
  8641        GO TO 9300-XCTL.
  8642
  8643     IF (EIBAID = DFHPF15 OR DFHPF17)
  8644        AND (CSR-EDIT-SESSION)
  8645*       AND (FATAL-OR-UNFORCED)
  8646        AND (FATAL-ERRORS)
  8647        MOVE ER-1819             TO EMI-ERROR
  8648        MOVE -1                  TO CMAINTL
  8649        MOVE AL-UANON            TO CMAINTA
  8650        PERFORM 9900-ERROR-FORMAT
  8651                                 THRU 9900-EXIT
  8652        GO TO 8200-SEND-DATAONLY
  8653     END-IF
  8654     IF (EIBAID = DFHPF15 OR DFHPF17 OR DFHPF10)
  8655       AND (CSR-EDIT-SESSION)
  8656        MOVE PI-PREV-ALT-KEY     TO PB-CONTROL-BY-ACCOUNT
  8657        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
  8658        IF (RESP-NORMAL)
  8659           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
  8660              AM-CONTROL-PRIMARY (1:20))
  8661            IF AM-NAME NOT GREATER THAN SPACES OR
  8662               AM-ADDRS NOT GREATER THAN SPACES  OR
  8663               AM-ADDR-CITY NOT GREATER THAN SPACES OR
  8664               AM-ADDR-STATE NOT GREATER THAN SPACES OR
  8665               AM-ZIP NOT GREATER THAN SPACES
  8666               MOVE ER-3834             TO EMI-ERROR
  8667               MOVE -1                  TO BMAINTL
  8668               MOVE AL-UANON            TO BMAINTA
  8669               PERFORM 9900-ERROR-FORMAT
  8670                                 THRU 9900-EXIT
  8671               GO TO 8200-SEND-DATAONLY
  8672            END-IF
  8673        ELSE
  8674           MOVE ER-1609             TO EMI-ERROR
  8675           MOVE -1                  TO BMAINTL
  8676           MOVE AL-UANON            TO BMAINTA
  8677           PERFORM 9900-ERROR-FORMAT
  8678                                THRU 9900-EXIT
  8679           GO TO 8200-SEND-DATAONLY
  8680        END-IF
  8681
  8682        MOVE PI-PREV-ALT-KEY (1:33) TO ELCERT-KEY
  8683        PERFORM 6220-READ-ERMAIL THRU 6220-EXIT
  8684        IF (ERMAIL-FOUND)
  8685            IF (MA-ADDRESS-LINE-1 NOT GREATER THAN SPACES AND
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 163
* EL6311.cbl
  8686               MA-ADDRESS-LINE-2 NOT GREATER THAN SPACES)  OR
  8687               MA-CITY NOT GREATER THAN SPACES OR
  8688               MA-ADDR-STATE NOT GREATER THAN SPACES OR
  8689               MA-ZIP-CODE NOT GREATER THAN SPACES
  8690               MOVE ER-3835             TO EMI-ERROR
  8691               MOVE -1                  TO BMAINTL
  8692               MOVE AL-UANON            TO BMAINTA
  8693               PERFORM 9900-ERROR-FORMAT
  8694                                 THRU 9900-EXIT
  8695               GO TO 8200-SEND-DATAONLY
  8696            END-IF
  8697        ELSE
  8698           MOVE ER-3000             TO EMI-ERROR
  8699           MOVE -1                  TO BMAINTL
  8700           MOVE AL-UANON            TO BMAINTA
  8701           PERFORM 9900-ERROR-FORMAT
  8702                                THRU 9900-EXIT
  8703           GO TO 8200-SEND-DATAONLY
  8704        END-IF
  8705
  8706     END-IF
  8707     IF (EIBAID = DFHPF15 OR DFHPF17)
  8708        AND (CSR-EDIT-SESSION)
  8709        MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
  8710        MOVE PI-SV-CARRIER       TO PI-CARRIER
  8711        MOVE PI-SV-GROUPING      TO PI-GROUPING
  8712        MOVE PI-SV-STATE         TO PI-STATE
  8713        MOVE ERPNDB-ACCOUNT      TO PI-ACCOUNT
  8714        MOVE CCERTNOI            TO PI-CERT-PRIME
  8715        MOVE CSUFIXI             TO PI-CERT-SFX
  8716        MOVE CEFFDTI             TO DEEDIT-FIELD
  8717        PERFORM 8600-DEEDIT
  8718        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  8719        MOVE '4'                 TO DC-OPTION-CODE
  8720        PERFORM 9700-DATE-LINK
  8721        IF DATE-CONVERSION-ERROR
  8722           MOVE ER-0348          TO EMI-ERROR
  8723           MOVE -1               TO CEFFDTL
  8724           MOVE AL-UABON         TO CEFFDTA
  8725           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8726           GO TO 8200-SEND-DATAONLY
  8727        ELSE
  8728           MOVE DC-BIN-DATE-1    TO PI-CERT-EFF-DT
  8729           PERFORM 6000-CREATE-TEMP-STORAGE
  8730                                 THRU 6000-EXIT
  8731           IF EIBAID = DFHPF17
  8732               PERFORM 6400-CHECK-FOR-RES-REF-CLAIM
  8733                                  THRU 6400-EXIT
  8734               IF PI-RES-REF-CLM-TYPE NOT EQUAL
  8735                                 '2' AND '3' AND '4'
  8736                  MOVE ER-3831     TO  EMI-ERROR
  8737                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8738                  GO TO 8200-SEND-DATAONLY
  8739               END-IF
  8740               MOVE 'Y'          TO PI-CLM-RESC-IND
  8741           ELSE
  8742               MOVE 'N'          TO PI-CLM-RESC-IND
  8743           END-IF
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 164
* EL6311.cbl
  8744           MOVE XCTL-EL6316      TO PGM-NAME
  8745           MOVE '2'              TO PI-ISS-CAN-SW
  8746           MOVE LOW-VALUES       TO PI-6316-PASS-AREA
  8747           MOVE WS-EL6316-PASS-AREA TO PI-PROGRAM-WORK-AREA
  8748           GO TO 9300-XCTL
  8749        END-IF
  8750     END-IF
  8751
  8752     IF EIBAID = DFHPF4
  8753        MOVE '0'                TO PI-EDIT-SW
  8754        IF PI-DISPLAY-ORIGINAL-BATCH
  8755           NEXT SENTENCE
  8756        ELSE
  8757           GO TO 7200-DISPLAY-BATCHES.
  8758
  8759     IF EIBAID = DFHPF5
  8760        MOVE ER-0029                TO EMI-ERROR
  8761        MOVE -1                     TO BPFENTRL
  8762        MOVE AL-UNBON               TO BPFENTRA
  8763        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8764        GO TO 8200-SEND-DATAONLY.
  8765*        MOVE '0'                TO PI-EDIT-SW
  8766*        IF PI-DISPLAY-ORIGINAL-BATCH
  8767*           NEXT SENTENCE
  8768*        ELSE
  8769*           MOVE EL631B              TO PI-MAP-NAME
  8770*           MOVE LOW-VALUES          TO EL631BI
  8771*           MOVE 'A'                 TO BMAINTO
  8772*           MOVE AL-UANON            TO BMAINTA
  8773*           MOVE -1                  TO BMAINTL
  8774*           MOVE '5'                 TO PI-MAINT-FUNCTION
  8775*           GO TO 8100-SEND-INITIAL-MAP.
  8776
  8777     IF EIBAID = DFHPF6
  8778        MOVE ER-0029                TO EMI-ERROR
  8779        MOVE -1                     TO BPFENTRL
  8780        MOVE AL-UNBON               TO BPFENTRA
  8781        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8782        GO TO 8200-SEND-DATAONLY.
  8783*        MOVE '0'                TO PI-EDIT-SW
  8784*        IF PI-DISPLAY-ORIGINAL-BATCH
  8785*           NEXT SENTENCE
  8786*        ELSE
  8787*           MOVE EL631C              TO PI-MAP-NAME
  8788*           MOVE LOW-VALUES          TO EL631CI
  8789*           MOVE 'A'                 TO CMAINTO
  8790*           MOVE AL-UANON            TO CMAINTA
  8791*           MOVE -1                  TO CMAINTL
  8792*           MOVE '6'                 TO PI-MAINT-FUNCTION
  8793*           GO TO 8100-SEND-INITIAL-MAP.
  8794
  8795     IF EIBAID = DFHPF7
  8796        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8797        MOVE PI-SV-CARRIER          TO PI-CARRIER
  8798        MOVE PI-SV-GROUPING         TO PI-GROUPING
  8799        MOVE PI-SV-STATE            TO PI-STATE
  8800        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  8801        MOVE CCERTNOI               TO PI-CERT-PRIME
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 165
* EL6311.cbl
  8802        MOVE CSUFIXI                TO PI-CERT-SFX
  8803        MOVE CEFFDTI                TO DEEDIT-FIELD
  8804        PERFORM 8600-DEEDIT
  8805        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  8806        MOVE '4'                    TO DC-OPTION-CODE
  8807        PERFORM 9700-DATE-LINK
  8808        IF DATE-CONVERSION-ERROR
  8809           MOVE ER-0348            TO EMI-ERROR
  8810           MOVE -1                  TO BEFFDTL
  8811           MOVE AL-UABON            TO BEFFDTA
  8812           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8813           GO TO 8200-SEND-DATAONLY
  8814        ELSE
  8815           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  8816           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8817           MOVE XCTL-EL1273        TO PGM-NAME
  8818           GO TO 9300-XCTL.
  8819
  8820     IF EIBAID = DFHPF8
  8821        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8822        MOVE PI-SV-CARRIER          TO PI-CARRIER
  8823        MOVE PI-SV-GROUPING         TO PI-GROUPING
  8824        MOVE PI-SV-STATE            TO PI-STATE
  8825        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  8826        MOVE CCERTNOI               TO PI-CERT-PRIME
  8827        MOVE CSUFIXI                TO PI-CERT-SFX
  8828        MOVE CEFFDTI                TO DEEDIT-FIELD
  8829        PERFORM 8600-DEEDIT
  8830        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  8831        MOVE '4'                    TO DC-OPTION-CODE
  8832        PERFORM 9700-DATE-LINK
  8833        IF DATE-CONVERSION-ERROR
  8834           MOVE ER-0348             TO EMI-ERROR
  8835           MOVE -1                  TO BEFFDTL
  8836           MOVE AL-UABON            TO BEFFDTA
  8837           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8838           GO TO 8200-SEND-DATAONLY
  8839        ELSE
  8840           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  8841           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8842           IF PI-COMPANY-ID = 'DMD'
  8843               MOVE XCTL-EL401DMD      TO PGM-NAME
  8844             ELSE
  8845               MOVE XCTL-EL1279        TO PGM-NAME
  8846           END-IF
  8847           GO TO 9300-XCTL.
  8848
  8849     IF EIBAID = DFHPF9 AND PI-EDIT-SW = '1'
  8850        MOVE XCTL-EL6312     TO PGM-NAME
  8851
  8852* EXEC CICS XCTL
  8853*           PROGRAM  (PGM-NAME)
  8854*           COMMAREA (PROGRAM-INTERFACE-BLOCK)
  8855*           LENGTH   (WS-COMM-LENGTH)
  8856*       END-EXEC
  8857*    MOVE '.$C                   %   #00008797' TO DFHEIV0
  8858     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  8859     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 166
* EL6311.cbl
  8860     MOVE X'2020233030303038373937' TO DFHEIV0(25:11)
  8861     CALL 'kxdfhei1' USING DFHEIV0,
  8862           PGM-NAME,
  8863           PROGRAM-INTERFACE-BLOCK,
  8864           WS-COMM-LENGTH,
  8865           DFHEIV99
  8866     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8867     ELSE
  8868        MOVE '0'                 TO  PI-EDIT-SW.
  8869
  8870     IF EIBAID = DFHPF10
  8871         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8872         MOVE PI-PREV-KEY        TO PI-ERPNDB-KEY
  8873         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  8874         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  8875                                    PI-1042-WA
  8876         MOVE 4                  TO PI-689-DATA-SOURCE
  8877         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  8878         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  8879         MOVE PI-SV-STATE        TO PI-689-STATE
  8880         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  8881         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  8882         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  8883         MOVE PI-PB-ALT-CHG-SEQ-NO
  8884                                 TO PI-689-ALT-SEQ-NO
  8885         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  8886         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  8887         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  8888         MOVE +0                 TO PI-689-CONTROL
  8889         MOVE LOW-VALUES         TO PI-689-DATE-EDIT
  8890                                    PI-689-EXP-DATE
  8891                                    PI-689-RESP-PERSON
  8892                                    PI-689-TYPE
  8893                                    PI-689-FOLLOW-UP-EDIT
  8894                                    PI-689-RESEND1-EDIT
  8895                                    PI-689-SEQ-EDIT
  8896                                    PI-689-BCSEQ-EDIT
  8897                                    PI-689-LBL-OVERRIDE
  8898         MOVE W-LETTER-COMMUNICATION-AREAS
  8899                                 TO PI-PROGRAM-WORK-AREA
  8900         MOVE XCTL-EL689         TO PGM-NAME
  8901         GO TO 9300-XCTL.
  8902
  8903     IF  EIBAID = DFHPF16
  8904         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8905         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  8906         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  8907                                    PI-1042-WA
  8908         MOVE 4                  TO PI-689-DATA-SOURCE
  8909         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  8910         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  8911         MOVE PI-SV-STATE        TO PI-689-STATE
  8912         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  8913         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  8914         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  8915         MOVE PI-PB-ALT-CHG-SEQ-NO
  8916                                 TO PI-689-ALT-SEQ-NO
  8917         MOVE PI-PB-RECORD-TYPE  TO PI-689-CHG-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 167
* EL6311.cbl
  8918         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  8919         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  8920         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  8921         MOVE W-LETTER-COMMUNICATION-AREAS
  8922                                 TO PI-PROGRAM-WORK-AREA
  8923         MOVE XCTL-EL690         TO PGM-NAME
  8924         GO TO 9300-XCTL.
  8925
  8926     IF EIBAID = DFHPF13
  8927        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8928        MOVE PI-SV-CARRIER          TO PI-CARRIER
  8929        MOVE PI-SV-GROUPING         TO PI-GROUPING
  8930        MOVE PI-SV-STATE            TO PI-STATE
  8931        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  8932        MOVE CCERTNOI               TO PI-CERT-PRIME
  8933        MOVE CSUFIXI                TO PI-CERT-SFX
  8934        MOVE CEFFDTI                TO DEEDIT-FIELD
  8935        PERFORM 8600-DEEDIT
  8936        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  8937        MOVE '4'                    TO DC-OPTION-CODE
  8938        PERFORM 9700-DATE-LINK
  8939        IF DATE-CONVERSION-ERROR
  8940           MOVE ER-0348            TO EMI-ERROR
  8941           MOVE -1                  TO CEFFDTL
  8942           MOVE AL-UABON            TO CEFFDTA
  8943           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8944           GO TO 8200-SEND-DATAONLY
  8945        ELSE
  8946           MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
  8947           MOVE AL-UANON            TO CEFFDTA
  8948           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  8949           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8950           MOVE XCTL-EL677         TO PGM-NAME
  8951           GO TO 9300-XCTL.
  8952
  8953     IF EIBAID = DFHPF14
  8954        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8955        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
  8956        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
  8957        MOVE PI-SV-STATE            TO PI-CR-STATE
  8958        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  8959        MOVE SPACE                  TO PI-EDIT-SW
  8960        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8961        MOVE XCTL-EL650             TO PGM-NAME
  8962        GO TO 9300-XCTL.
  8963
  8964     IF EIBAID = DFHENTER OR DFHPF11
  8965        GO TO 2000-CANCEL-MAINLINE.
  8966
  8967     MOVE ER-0029                TO EMI-ERROR.
  8968     MOVE -1                     TO CPFENTRL.
  8969     MOVE AL-UNBON               TO CPFENTRA.
  8970     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8971     GO TO 8200-SEND-DATAONLY.
  8972
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 168
* EL6311.cbl
  8974
  8975******************************************************************
  8976*                                                                *
  8977*      BATCH SCREEN PF KEY CHECKING                              *
  8978*                                                                *
  8979******************************************************************
  8980
  8981******************************************************************
  8982*                                                                *
  8983*      PF KEY FUNCTIONS:                                         *
  8984*                                                                *
  8985*      PF1 = BROWSE FORWARD                                      *
  8986*      PF2 = BROWSE BACKWARD                                     *
  8987*      PF3 = DISPLAY PREMIUM TOTALS                              *
  8988*      PF4 = TRANSFER TO ACCOUNT BILLING                         *
  8989*                                                                *
  8990*                                                                *
  8991******************************************************************
  8992
  8993 0500-CHECK-BATCH-PF-KEYS.
  8994     IF EIBAID = DFHPF1
  8995        MOVE '0'                TO PI-EDIT-SW
  8996        IF ONLY-BATCH-HEADERS  OR ALL-OUT-OF-BAL
  8997           GO TO 5000-BROWSE-BATCH-HEADERS
  8998        ELSE
  8999           IF PI-GOOD-BROWSE
  9000              IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  9001                 GO TO 4100-BROWSE-PRIMARY-FORWARD
  9002              ELSE
  9003                 IF PI-FILE-BROWSE
  9004                    GO TO 4300-BROWSE-FILE-FORWARD
  9005                 ELSE
  9006                    IF PI-CSR-BROWSE
  9007                       GO TO 4200-BROWSE-CSR-FORWARD
  9008                    ELSE
  9009                       GO TO 4000-BROWSE-DETAIL-FORWARD
  9010           ELSE
  9011              GO TO 0800-BROWSE-ERROR.
  9012
  9013     IF EIBAID = DFHPF2
  9014        MOVE '0'                TO PI-EDIT-SW
  9015        IF ONLY-BATCH-HEADERS  OR ALL-OUT-OF-BAL
  9016           GO TO 5500-BROWSE-BATCH-BACKWARD
  9017        ELSE
  9018           IF PI-GOOD-BROWSE
  9019              IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  9020                 GO TO 4600-BROWSE-PRIMARY-BACKWARD
  9021              ELSE
  9022                 IF PI-FILE-BROWSE
  9023                    GO TO 4800-BROWSE-FILE-BACKWARD
  9024                 ELSE
  9025                    IF PI-CSR-BROWSE
  9026                       GO TO 4900-BROWSE-CSR-BACKWARD
  9027                    ELSE
  9028                       GO TO 4500-BROWSE-DETAIL-BACKWARD
  9029           ELSE
  9030              GO TO 0800-BROWSE-ERROR.
  9031
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 169
* EL6311.cbl
  9032     IF EIBAID = DFHPF3
  9033        GO TO 3000-BATCH-MAINLINE.
  9034
  9035     IF  EIBAID = DFHPF4
  9036        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9037        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
  9038        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
  9039        MOVE PI-SV-STATE            TO PI-CR-STATE
  9040        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  9041                                       PI-CR-FIN-RESP
  9042        MOVE 'A'                    TO PI-CR-TYPE
  9043        MOVE SPACE                  TO PI-EDIT-SW
  9044        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9045        MOVE XCTL-EL640             TO PGM-NAME
  9046        GO TO 9300-XCTL.
  9047
  9048     IF (ONLY-BATCH-HEADERS OR ALL-OUT-OF-BAL)
  9049       AND
  9050        (EIBAID = DFHENTER)
  9051           GO TO 3500-EDIT-BATCH-DATA.
  9052
  9053     IF EIBAID = DFHENTER
  9054        GO TO 3500-EDIT-BATCH-DATA.
  9055
  9056     MOVE ER-0029             TO EMI-ERROR.
  9057     MOVE -1                  TO DPFENTRL.
  9058     MOVE AL-UNBON            TO DPFENTRA.
  9059     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9060     GO TO 8200-SEND-DATAONLY.
  9061
  9062 0800-BROWSE-ERROR.
  9063     MOVE ER-2258                TO EMI-ERROR.
  9064     MOVE -1                     TO DPFENTRL.
  9065     MOVE AL-UNBON               TO DPFENTRA.
  9066     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9067     GO TO 8200-SEND-DATAONLY.
  9068
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 170
* EL6311.cbl
  9070
  9071******************************************************************
  9072*                                                                *
  9073*                I S S U E   M A I N L I N E                     *
  9074*                                                                *
  9075******************************************************************
  9076
  9077 1000-ISSUE-MAINLINE.
  9078     IF PI-DISPLAY-ORIGINAL-BATCH
  9079        IF BMAINTI NOT = 'C' AND 'D' AND 'S' AND 'K'
  9080           MOVE ER-0023             TO EMI-ERROR
  9081           MOVE -1                  TO BMAINTL
  9082           MOVE AL-UABON            TO BMAINTA
  9083           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9084           GO TO 8200-SEND-DATAONLY
  9085        ELSE
  9086           NEXT SENTENCE
  9087     ELSE
  9088        IF BMAINTI NOT = 'A' AND 'C' AND 'D' AND 'S' AND 'K'
  9089           MOVE ER-0023             TO EMI-ERROR
  9090           MOVE -1                  TO BMAINTL
  9091           MOVE AL-UABON            TO BMAINTA
  9092           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9093           GO TO 8200-SEND-DATAONLY.
  9094
  9095     IF BMAINTI = 'S'
  9096        GO TO 1100-SHOW-REQUEST.
  9097
  9098     IF NOT MODIFY-CAP
  9099         MOVE 'UPDATE'       TO SM-READ
  9100         PERFORM 9995-SECURITY-VIOLATION
  9101         MOVE ER-0070        TO EMI-ERROR
  9102         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9103         GO TO 8100-SEND-INITIAL-MAP.
  9104
  9105     IF BMAINTL GREATER THAN ZEROS
  9106        IF PI-PF5-FUNCTION
  9107           IF BMAINTI NOT = 'A'
  9108              MOVE AL-UABON  TO BMAINTA
  9109              MOVE -1        TO BMAINTL
  9110              MOVE ER-2260   TO EMI-ERROR
  9111              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9112              GO TO 8200-SEND-DATAONLY.
  9113
  9114     IF BCERTNOL = ZEROS
  9115       AND (BMAINTI = 'C' OR 'K' OR 'D')
  9116         NEXT SENTENCE
  9117     ELSE
  9118         IF BCERTNOL NOT = ZEROS
  9119             MOVE AL-UANON       TO BCERTNOA
  9120         ELSE
  9121             MOVE -1             TO BCERTNOL
  9122             MOVE  1             TO SET-CURSOR-SW
  9123             MOVE ER-2218        TO EMI-ERROR
  9124             MOVE AL-UABON       TO BCERTNOA
  9125             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9126
  9127     IF BSUFIXL NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 171
* EL6311.cbl
  9128         MOVE AL-UANON       TO BSUFIXA
  9129     ELSE
  9130         MOVE AL-SANOF       TO BSUFIXA.
  9131
  9132     IF BEFFDTL = ZEROS AND (BMAINTI = 'C' OR 'K' OR 'D')
  9133        NEXT SENTENCE
  9134     ELSE
  9135        IF BEFFDTL NOT = ZEROS
  9136           MOVE AL-UNNON             TO BEFFDTA
  9137           MOVE BEFFDTI              TO DEEDIT-FIELD
  9138           PERFORM 8600-DEEDIT
  9139           MOVE DEEDIT-FIELD-V0      TO DC-GREG-DATE-1-MDY
  9140           MOVE 4                    TO DC-OPTION-CODE
  9141           PERFORM 9700-DATE-LINK
  9142           IF NO-CONVERSION-ERROR
  9143              MOVE DC-BIN-DATE-1     TO WS-CONVERTED-EFFDT
  9144              ELSE
  9145              MOVE -1                TO BEFFDTL
  9146              MOVE  1                TO SET-CURSOR-SW
  9147              MOVE ER-2226           TO EMI-ERROR
  9148              MOVE AL-UNBON          TO BEFFDTA
  9149              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9150           ELSE
  9151              MOVE -1                TO BEFFDTL
  9152              MOVE  1                TO SET-CURSOR-SW
  9153              MOVE ER-2220           TO EMI-ERROR
  9154              MOVE AL-UNBON          TO BEFFDTA
  9155              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9156
  9157     MOVE PI-PREV-ALT-KEY            TO WS-ERPNDB-ALT-KEY.
  9158
  9159     IF BCERTNOL NOT = ZEROS
  9160        MOVE BCERTNOI                TO WS-NEW-PRIME
  9161     ELSE
  9162        MOVE SPACES                  TO WS-NEW-PRIME.
  9163
  9164     IF BSUFIXL NOT = ZEROS
  9165        MOVE BSUFIXI                 TO WS-NEW-SUFFIX
  9166     ELSE
  9167        MOVE SPACE                   TO WS-NEW-SUFFIX.
  9168
  9169     IF BEFFDTL NOT = ZEROS
  9170        MOVE WS-CONVERTED-EFFDT      TO WS-NEW-CERT-EFF-DT
  9171     ELSE
  9172        MOVE LOW-VALUES              TO WS-NEW-CERT-EFF-DT.
  9173
  9174     IF BMAINTI = 'A' OR 'K' OR 'S'
  9175        NEXT SENTENCE
  9176     ELSE
  9177        MOVE PI-PREV-ALT-KEY     TO WS-ERPNDB-ALT-KEY
  9178        IF WS-PB-CERT-NO     NOT = WS-NEW-CERT-NO      OR
  9179           WS-PB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT  OR
  9180           WS-PB-RECORD-TYPE NOT = '1'
  9181           IF BMAINTI = 'C'
  9182               MOVE ER-2287          TO EMI-ERROR
  9183               MOVE -1               TO BCERTNOL
  9184               MOVE AL-UABON         TO BCERTNOA BEFFDTA
  9185               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 172
* EL6311.cbl
  9186               GO TO 8200-SEND-DATAONLY
  9187             ELSE
  9188               MOVE ER-2260          TO EMI-ERROR
  9189               MOVE -1               TO BCERTNOL
  9190               MOVE AL-UABON         TO BCERTNOA
  9191               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9192               GO TO 8200-SEND-DATAONLY.
  9193
  9194     IF BMAINTI = 'D'
  9195         GO TO 1400-DELETE-ISSUE-ROUTINE.
  9196
  9197*    IF BMICRNOL  NOT =  ZEROS
  9198*        IF BMICRNOI  NUMERIC
  9199*            MOVE AL-UNNON       TO  BMICRNOA
  9200*        ELSE
  9201*            MOVE -1             TO  BMICRNOL
  9202*            MOVE 1              TO  SET-CURSOR-SW
  9203*            MOVE AL-UNBON       TO  BMICRNOA
  9204*            MOVE ER-2701        TO  EMI-ERROR
  9205*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9206     IF BVINL NOT = ZEROS
  9207        MOVE AL-UANON            TO BVINA
  9208     END-IF
  9209     IF B1STNML NOT = ZEROS
  9210         MOVE AL-UANON                TO B1STNMA.
  9211
  9212     IF BINITL  NOT = ZEROS
  9213        MOVE AL-UANON                TO BINITA.
  9214
  9215     IF BSEXL NOT = ZEROS
  9216        IF BSEXI = 'M' OR 'F'
  9217           MOVE AL-UANON             TO BSEXA
  9218        ELSE
  9219           MOVE -1               TO BSEXL
  9220           MOVE ER-2629          TO EMI-ERROR
  9221           MOVE AL-UABON         TO BSEXA
  9222           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9223
  9224     IF BAGEL NOT = ZEROS
  9225         IF BAGEI NUMERIC
  9226             MOVE BAGEI              TO WS-BAGE
  9227             MOVE AL-UNNON           TO BAGEA
  9228         ELSE
  9229             MOVE -1                 TO BAGEL
  9230             MOVE  1                 TO SET-CURSOR-SW
  9231             MOVE ER-2223            TO EMI-ERROR
  9232             MOVE AL-UNBON           TO BAGEA
  9233             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9234
  9235     MOVE LOW-VALUES             TO WS-CONVERTED-BIRTH
  9236
  9237     IF (BBIRTHL GREATER THAN +0) AND
  9238        (BBIRTHI NOT EQUAL SPACES)
  9239        NEXT SENTENCE
  9240     ELSE
  9241        GO TO 1010-CHECK-AGE.
  9242
  9243     MOVE BBIRTHI                TO DEEDIT-FIELD.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 173
* EL6311.cbl
  9244     PERFORM 8600-DEEDIT.
  9245     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
  9246     MOVE DC-GREG-DATE-1-MDY     TO WS-SAVE-BIRTH-DATE
  9247     MOVE AL-UNNON               TO BBIRTHA.
  9248     MOVE '4'                    TO DC-OPTION-CODE.
  9249     PERFORM 9700-DATE-LINK.
  9250     IF DATE-CONVERSION-ERROR
  9251        MOVE -1                  TO BBIRTHL
  9252        MOVE  1                  TO SET-CURSOR-SW
  9253        MOVE ER-2228             TO EMI-ERROR
  9254        MOVE AL-UNBON            TO BBIRTHA
  9255        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9256        GO TO 1010-CHECK-AGE.
  9257
  9258     IF (NO-CONVERSION-ERROR) AND
  9259        (DC-BIN-DATE-1 GREATER THAN WS-CONVERTED-EFFDT)
  9260        MOVE DC-BIN-DATE-1       TO WS-WORK-BIN-DT
  9261        SUBTRACT CENTURY-ADJ FROM WS-WORK-BIN-RED
  9262        MOVE WS-WORK-BIN-DT      TO DC-BIN-DATE-1
  9263                                    WS-CONVERTED-BIRTH
  9264        MOVE AL-UANON            TO BBIRTHA
  9265     ELSE
  9266        MOVE DC-BIN-DATE-1       TO WS-CONVERTED-BIRTH
  9267        MOVE AL-UANON            TO BBIRTHA.
  9268
  9269 1010-CHECK-AGE.
  9270
  9271*    IF BAGEL = ZERO
  9272*       IF BBIRTHL GREATER THAN ZERO
  9273*          PERFORM 1095-CALC-AGE THRU 1099-EXIT.
  9274
  9275     IF B1STPMTL NOT = ZEROS
  9276        IF B1STPMTI = SPACES
  9277           MOVE LOW-VALUES           TO WS-CONVERTED-1ST-PMT-DT
  9278        ELSE
  9279           MOVE B1STPMTI             TO DEEDIT-FIELD
  9280           PERFORM 8600-DEEDIT
  9281           MOVE DEEDIT-FIELD-V0      TO DC-GREG-DATE-1-MDY
  9282           MOVE AL-UNNON             TO B1STPMTA
  9283           MOVE 4                    TO DC-OPTION-CODE
  9284           PERFORM 9700-DATE-LINK
  9285           IF NO-CONVERSION-ERROR
  9286              MOVE DC-BIN-DATE-1     TO WS-CONVERTED-1ST-PMT-DT
  9287              MOVE AL-UANON          TO B1STPMTA
  9288           ELSE
  9289              MOVE -1                TO B1STPMTL
  9290              MOVE  1                TO SET-CURSOR-SW
  9291              MOVE ER-2200           TO EMI-ERROR
  9292              MOVE AL-UNBON          TO B1STPMTA
  9293              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9294
  9295     IF BDAYSL NOT = ZEROS
  9296         IF BDAYSI NUMERIC
  9297             MOVE AL-UNNON           TO BDAYSA
  9298         ELSE
  9299             MOVE -1                 TO BDAYSL
  9300             MOVE ER-2530            TO EMI-ERROR
  9301             MOVE AL-UNBON           TO BDAYSA
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 174
* EL6311.cbl
  9302             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9303
  9304     IF BLNTRML NOT = ZEROS
  9305         IF BLNTRMI NUMERIC
  9306             MOVE AL-UNNON       TO BLNTRMA
  9307         ELSE
  9308             MOVE -1             TO BLNTRML
  9309             MOVE ER-2533        TO EMI-ERROR
  9310             MOVE AL-UNBON       TO BLNTRMA
  9311             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9312
  9313**   IF PI-COMPANY-ID = 'DMD'
  9314     IF PI-COMPANY-ID = 'DMD' OR 'CID' or 'AHL'
  9315        NEXT SENTENCE
  9316     ELSE
  9317         IF BLNOFCRL NOT = ZEROS
  9318            PERFORM 7500-READ-ERLOFC THRU 7599-EXIT
  9319            IF LOAN-OFFICER-FOUND
  9320                MOVE AL-UANON        TO BLNOFCRA
  9321             ELSE
  9322                 MOVE SPACE          TO WS-LOAN-OFFICER
  9323                 MOVE -1             TO BLNOFCRL
  9324                 MOVE  1             TO SET-CURSOR-SW
  9325                 MOVE ER-3006        TO EMI-ERROR
  9326                 MOVE AL-UNBON       TO BLNOFCRA
  9327                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9328
  9329     IF BFREQL NOT = ZEROS
  9330         IF BFREQI NUMERIC
  9331             MOVE AL-UNNON       TO BFREQA
  9332         ELSE
  9333             MOVE -1             TO BFREQL
  9334             MOVE  1             TO SET-CURSOR-SW
  9335             MOVE ER-2223        TO EMI-ERROR
  9336             MOVE AL-UNBON       TO BFREQA
  9337             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9338
  9339     IF BMODEL NOT = ZEROS
  9340         MOVE BMODEI             TO WS-MODE-CODE
  9341                                    PI-BMODE
  9342         IF WS-MODE-CODE-VALID
  9343             MOVE AL-UANON       TO BMODEA
  9344         ELSE
  9345             MOVE -1             TO BMODEL
  9346             MOVE ER-2591        TO EMI-ERROR
  9347             MOVE AL-UABON       TO BMODEA
  9348             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9349
  9350     IF BPMTSL NOT = ZEROS
  9351         IF BPMTSI NUMERIC
  9352             MOVE AL-UNNON           TO BPMTSA
  9353             MOVE BPMTSI             TO PI-BPMTS
  9354         ELSE
  9355             MOVE -1                 TO BPMTSL
  9356             MOVE ER-2592            TO EMI-ERROR
  9357             MOVE AL-UNBON           TO BPMTSA
  9358             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9359
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 175
* EL6311.cbl
  9360     IF BPMTAMTL NOT = ZEROS
  9361
  9362* EXEC CICS BIF DEEDIT
  9363*            FIELD  (BPMTAMTI)
  9364*            LENGTH (9)
  9365*       END-EXEC
  9366     MOVE 9
  9367       TO DFHEIV11
  9368*    MOVE '@"L                   #   #00009296' TO DFHEIV0
  9369     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9370     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9371     MOVE X'2020233030303039323936' TO DFHEIV0(25:11)
  9372     CALL 'kxdfhei1' USING DFHEIV0,
  9373           BPMTAMTI,
  9374           DFHEIV11
  9375     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9376        MOVE BPMTAMTI           TO PI-BPMTAMT.
  9377*        MOVE BPMTAMTI           TO DEEDIT-FIELD-V2
  9378*        PERFORM 8600-DEEDIT
  9379*        MOVE DEEDIT-FIELD-V2    TO PI-BPMTAMT.
  9380
  9381*    IF BAPRL NOT = ZEROS
  9382*        EXEC CICS BIF DEEDIT
  9383*            FIELD  (BAPRI)
  9384*            LENGTH (7)
  9385*        END-EXEC
  9386*        MOVE BAPRI              TO WS-BAPR.
  9387
  9388     IF BAPRL > 0
  9389        MOVE +0                  TO  WS-BAPR
  9390        PERFORM VARYING WS-SUB FROM +1 BY +1 UNTIL
  9391           (WS-SUB > 7)
  9392           OR (BAPRI (WS-SUB:1) NUMERIC)
  9393           OR (BAPRI (WS-SUB:1) = '.')
  9394        END-PERFORM
  9395        IF WS-SUB > 7
  9396           MOVE ER-2471       TO EMI-ERROR
  9397           MOVE -1            TO BAPRL
  9398           MOVE AL-UNBON      TO BAPRA
  9399           PERFORM 9900-ERROR-FORMAT
  9400                                 THRU 9900-EXIT
  9401        ELSE
  9402           IF BAPRI (WS-SUB:1) NUMERIC
  9403              MOVE WS-SUB           TO WS-BEG
  9404              PERFORM VARYING WS-SUB FROM WS-SUB BY +1 UNTIL
  9405                 (WS-SUB > 7)
  9406                 OR (BAPRI (WS-SUB:1) NOT NUMERIC)
  9407              END-PERFORM
  9408              COMPUTE WS-END = WS-SUB - WS-BEG
  9409              MOVE BAPRI (WS-BEG:WS-END)
  9410                                 TO WS-APR-WHOLE-NUM
  9411           END-IF
  9412           IF BAPRI (WS-SUB:1) = '.'
  9413              COMPUTE WS-BEG = WS-SUB + 1
  9414              IF (WS-BEG < 8)
  9415                 AND (BAPRI (WS-BEG:1) NUMERIC)
  9416                 PERFORM VARYING WS-SUB FROM WS-BEG BY +1 UNTIL
  9417                    (WS-SUB > 7)
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 176
* EL6311.cbl
  9418                    OR (BAPRI (WS-SUB:1) NOT NUMERIC)
  9419                 END-PERFORM
  9420                 COMPUTE WS-END = WS-SUB - WS-BEG
  9421                 MOVE BAPRI (WS-BEG:WS-END)
  9422                                 TO WS-APR-DEC (1:WS-END)
  9423              END-IF
  9424           END-IF
  9425           MOVE AL-UNNON      TO BAPRA
  9426           MOVE WS-BAPR       TO BAPRO
  9427        END-IF
  9428     END-IF
  9429*     IF BAPRL NOT = ZEROS
  9430*        MOVE BAPRI              TO DEEDIT-FIELD-V4
  9431*        PERFORM 8600-DEEDIT
  9432*        MOVE DEEDIT-FIELD-V4    TO WS-BAPR.
  9433
  9434     IF BLIVESL NOT = ZEROS
  9435        MOVE BLIVESI             TO DEEDIT-FIELD
  9436        PERFORM 8600-DEEDIT
  9437        IF DEEDIT-FIELD-V0 NUMERIC
  9438           MOVE DEEDIT-FIELD-V0  TO WS-BLIVES
  9439           MOVE AL-UNNON         TO BLIVESA
  9440        ELSE
  9441           MOVE -1               TO BLIVESL
  9442           MOVE AL-UNBON         TO BLIVESA
  9443           MOVE ER-2223          TO EMI-ERROR
  9444           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9445
  9446*DMD CUSTOM CODING*************START
  9447*NOTE PI-I-NUM-BILLED IS A FIELD FOR 'DMD' ONLY
  9448     IF PI-COMPANY-ID NOT = 'DMD'
  9449         MOVE ZEROS               TO BBILLEDL
  9450         GO TO 1010-EDIT-CONT.
  9451
  9452     IF BBILLEDL NOT = ZEROS
  9453        MOVE BBILLEDI            TO WS-EDIT-CSO-FIELD
  9454        MOVE 'Y'                 TO WS-NUMERIC-SW
  9455        MOVE +1                  TO WS-CSO-SUB
  9456        PERFORM 1030-EDIT-FOR-NUMERICS THRU 1030-EDIT-EXIT
  9457        IF CSO-NUMERIC-FIELD
  9458
  9459* EXEC CICS BIF DEEDIT
  9460*              FIELD  (BBILLEDI)
  9461*              LENGTH (9)
  9462*          END-EXEC
  9463     MOVE 9
  9464       TO DFHEIV11
  9465*    MOVE '@"L                   #   #00009382' TO DFHEIV0
  9466     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9467     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9468     MOVE X'2020233030303039333832' TO DFHEIV0(25:11)
  9469     CALL 'kxdfhei1' USING DFHEIV0,
  9470           BBILLEDI,
  9471           DFHEIV11
  9472     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9473           MOVE BBILLEDI         TO WS-BILLED
  9474           MOVE AL-UNNON         TO BBILLEDA
  9475        ELSE
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 177
* EL6311.cbl
  9476           MOVE -1               TO BBILLEDL
  9477           MOVE AL-UNBON         TO BBILLEDA
  9478           MOVE ER-2547          TO EMI-ERROR
  9479           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9480     ELSE
  9481        IF BMAINTI EQUAL 'A'
  9482           MOVE -1               TO BBILLEDL
  9483           MOVE AL-UNBON         TO BBILLEDA
  9484           MOVE ER-8148          TO EMI-ERROR
  9485           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9486
  9487 1010-EDIT-CONT.
  9488
  9489     IF BFORCEL  NOT = ZEROS
  9490         IF FORCE-CAP
  9491            MOVE AL-UANON            TO BFORCEA
  9492         ELSE
  9493            MOVE ER-2945             TO EMI-ERROR
  9494            MOVE AL-UABON            TO BFORCEA
  9495            MOVE -1                  TO BFORCEL
  9496            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9497
  9498     IF BENTRYL NOT = ZEROS
  9499        IF BENTRYI NOT = ' ' AND 'E' AND 'R' AND 'P' AND
  9500                         'D' AND 'V' AND 'U' AND 'M'
  9501           MOVE ER-2224              TO EMI-ERROR
  9502           MOVE AL-UABON             TO BENTRYA
  9503           MOVE -1                   TO BENTRYL
  9504           MOVE  1                   TO SET-CURSOR-SW
  9505           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9506        ELSE
  9507           MOVE AL-UANON             TO BENTRYA.
  9508
  9509     IF BUNWRITL NOT = ZEROS
  9510        IF BUNWRITI NOT = ' ' AND 'A' AND 'D' AND 'U' AND 'N'
  9511           MOVE ER-7574              TO EMI-ERROR
  9512           MOVE AL-UABON             TO BUNWRITA
  9513           MOVE -1                   TO BUNWRITL
  9514           MOVE  1                   TO SET-CURSOR-SW
  9515           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9516        ELSE
  9517           MOVE AL-UANON             TO BUNWRITA.
  9518
  9519     IF BREINL  NOT = ZEROS
  9520         MOVE AL-UANON               TO BREINA.
  9521
  9522     IF BBILCDL NOT = ZEROS
  9523        IF BBILCDI NOT = ' ' AND 'H' AND 'R' AND 'L'
  9524                             AND 'A' AND 'B' AND 'E'
  9525           MOVE ER-2225              TO EMI-ERROR
  9526           MOVE AL-UABON             TO BBILCDA
  9527           MOVE -1                   TO BBILCDL
  9528           MOVE  1                   TO SET-CURSOR-SW
  9529           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9530        ELSE
  9531           MOVE AL-UANON             TO BBILCDA.
  9532
  9533     IF BSKPCDL NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 178
* EL6311.cbl
  9534         MOVE AL-UANON               TO BSKPCDA.
  9535
  9536     IF BINDGRPL NOT = ZEROS
  9537         MOVE AL-UANON               TO BINDGRPA.
  9538
  9539     IF BSIGL   NOT = ZEROS
  9540         MOVE AL-UANON               TO BSIGA.
  9541
  9542     IF BRTCLSL NOT = ZEROS
  9543         MOVE AL-UANON               TO BRTCLSA.
  9544
  9545     IF BMEMBERL NOT = ZEROS
  9546         MOVE AL-UANON               TO BMEMBERA.
  9547
  9548     MOVE +0                         TO WS-SUB1.
  9549
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 179
* EL6311.cbl
  9551
  9552******************************************************************
  9553*                                                                *
  9554*           E D I T   I S S U E   C O V E R A G E S              *
  9555*                                                                *
  9556******************************************************************
  9557
  9558 1020-EDIT-COVERAGES.
  9559     ADD +1                      TO WS-SUB1.
  9560
  9561     IF WS-SUB1 GREATER +2
  9562        GO TO 1025-EDIT-COMPLETE.
  9563
  9564     IF PI-COMPANY-ID = CLIENT-CRI OR CLIENT-LGX
  9565       IF (BMODEL   GREATER ZERO  OR
  9566            BPMTSL   GREATER ZERO  OR
  9567            BPMTAMTL GREATER ZERO)
  9568          AND
  9569            BTYPE-LEN (WS-SUB1) GREATER THAN +0
  9570               GO TO 1021-CONT-EDIT.
  9571
  9572     IF BTYPE-LEN      (WS-SUB1) GREATER THAN ZEROS OR
  9573        BTERM-LEN      (WS-SUB1) GREATER THAN ZEROS OR
  9574        BBEN-LEN       (WS-SUB1) GREATER THAN ZEROS OR
  9575        BPREM-LEN      (WS-SUB1) GREATER THAN ZEROS OR
  9576        BCRIT-PERD-LEN (WS-SUB1) GREATER THAN ZEROS OR
  9577        BEXPIRE-LEN    (WS-SUB1) GREATER THAN ZEROS OR
  9578        BALT-PREM-LEN  (WS-SUB1) GREATER THAN ZEROS OR
  9579        BALT-BEN-LEN   (WS-SUB1) GREATER THAN ZEROS
  9580        NEXT SENTENCE
  9581         ELSE
  9582            GO TO 1020-EDIT-COVERAGES.
  9583
  9584 1021-CONT-EDIT.
  9585
  9586     IF BMAINTI = 'A'
  9587        IF BTYPE-LEN  (WS-SUB1) GREATER THAN ZEROS
  9588           MOVE AL-UANON         TO BTYPE-ATTRB       (WS-SUB1)
  9589        ELSE
  9590           MOVE  -1              TO BTYPE-LEN         (WS-SUB1)
  9591           MOVE ER-7404          TO EMI-ERROR
  9592           MOVE AL-SABON         TO BKIND-ATTRB       (WS-SUB1)
  9593           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9594     ELSE
  9595        IF BTYPE-LEN  (WS-SUB1) GREATER THAN ZEROS
  9596           MOVE AL-UANON         TO BTYPE-ATTRB       (WS-SUB1).
  9597
  9598     IF BTERM-LEN (WS-SUB1) NOT EQUAL +0
  9599        MOVE BTERMI (WS-SUB1)    TO DEEDIT-FIELD
  9600        PERFORM 8600-DEEDIT
  9601        IF DEEDIT-FIELD-V0 NUMERIC
  9602           MOVE DEEDIT-FIELD-V0  TO WS-BTERM (WS-SUB1)
  9603        ELSE
  9604           MOVE ZEROS            TO WS-BTERM (WS-SUB1).
  9605
  9606     IF PI-COMPANY-ID NOT = CLIENT-CRI AND CLIENT-LGX
  9607*      IF BTERM-LEN (WS-SUB1) NOT GREATER THAN +0
  9608        IF BMODEL  GREATER THAN ZEROS  AND
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 180
* EL6311.cbl
  9609           BPMTSL  GREATER THAN ZEROS
  9610           PERFORM 6100-TERM-CONVERSION THRU 6199-EXIT.
  9611
  9612     IF PI-COMPANY-ID = CLIENT-CRI OR CLIENT-LGX
  9613         IF BMODEL   GREATER THAN ZEROS  OR
  9614            BPMTSL   GREATER THAN ZEROS  OR
  9615            BPMTAMTL GREATER THAN ZEROS
  9616             PERFORM 6100-TERM-CONVERSION THRU 6199-EXIT.
  9617
  9618     IF BMAINTI = ('C' OR 'K')
  9619        IF BTERM-LEN (WS-SUB1)  = ZEROS
  9620           NEXT SENTENCE
  9621        ELSE
  9622           MOVE BTERMI    (WS-SUB1)   TO DEEDIT-FIELD
  9623           PERFORM 8600-DEEDIT
  9624           IF DEEDIT-FIELD-V0 NUMERIC
  9625              MOVE DEEDIT-FIELD-V0    TO WS-BTERM    (WS-SUB1)
  9626              IF WS-BTERM (WS-SUB1)  GREATER THAN ZERO
  9627                    MOVE AL-UNNON     TO BTERM-ATTRB (WS-SUB1)
  9628              ELSE
  9629                    MOVE ER-2241      TO EMI-ERROR
  9630                    MOVE -1           TO BTERM-LEN   (WS-SUB1)
  9631                    MOVE AL-UNBON     TO BTERM-ATTRB (WS-SUB1)
  9632                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9633           ELSE
  9634              MOVE ER-2223          TO EMI-ERROR
  9635              MOVE -1               TO BTERM-LEN     (WS-SUB1)
  9636              MOVE AL-UNBON         TO BTERM-ATTRB   (WS-SUB1)
  9637              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9638     ELSE
  9639        IF  BTERM-LEN      (WS-SUB1)   GREATER THAN ZEROS
  9640            MOVE BTERMI    (WS-SUB1)   TO DEEDIT-FIELD
  9641            PERFORM 8600-DEEDIT
  9642            IF DEEDIT-FIELD-V0      NUMERIC
  9643               IF DEEDIT-FIELD-V0     GREATER THAN ZERO
  9644                  MOVE DEEDIT-FIELD-V0 TO WS-BTERM    (WS-SUB1)
  9645                  MOVE AL-UNNON        TO BTERM-ATTRB (WS-SUB1)
  9646               ELSE
  9647                  MOVE ER-2241         TO EMI-ERROR
  9648                  MOVE -1              TO BTERM-LEN   (WS-SUB1)
  9649                  MOVE AL-UNBON        TO BTERM-ATTRB (WS-SUB1)
  9650                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9651            ELSE
  9652              MOVE ER-2223             TO EMI-ERROR
  9653              MOVE -1                  TO BTERM-LEN   (WS-SUB1)
  9654              MOVE AL-UNBON            TO BTERM-ATTRB (WS-SUB1)
  9655              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9656        ELSE
  9657            MOVE ER-2240               TO EMI-ERROR
  9658            MOVE -1                    TO BTERM-LEN   (WS-SUB1)
  9659            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9660*    IF PI-COMPANY-ID NOT = CLIENT-CRI AND CLIENT-LGX
  9661*        IF BMODEL  GREATER THAN ZEROS  AND
  9662*           BPMTSL  GREATER THAN ZEROS
  9663*            PERFORM 6100-TERM-CONVERSION THRU 6199-EXIT.
  9664
  9665     IF BBEN-LEN (WS-SUB1) = ZEROS
  9666        AND BMAINTI = ('C' OR 'K')
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 181
* EL6311.cbl
  9667           NEXT SENTENCE
  9668     ELSE
  9669        IF BBEN-LEN (WS-SUB1) GREATER THAN ZEROS
  9670           MOVE AL-UNNON           TO BBEN-ATTRB (WS-SUB1)
  9671
  9672* EXEC CICS BIF DEEDIT
  9673*              FIELD  (BBENI (WS-SUB1))
  9674*              LENGTH (12)
  9675*          END-EXEC
  9676     MOVE 12
  9677       TO DFHEIV11
  9678*    MOVE '@"L                   #   #00009584' TO DFHEIV0
  9679     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9680     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9681     MOVE X'2020233030303039353834' TO DFHEIV0(25:11)
  9682     CALL 'kxdfhei1' USING DFHEIV0,
  9683           BBENI(WS-SUB1),
  9684           DFHEIV11
  9685     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9686           IF BBENI (WS-SUB1)  NUMERIC
  9687              IF BBENI (WS-SUB1) GREATER THAN ZEROS
  9688                 MOVE BBENI (WS-SUB1) TO WS-BBEN    (WS-SUB1)
  9689*          MOVE BBENI (WS-SUB1)    TO DEEDIT-FIELD
  9690*          PERFORM 8600-DEEDIT
  9691*          IF DEEDIT-FIELD-V2  NUMERIC
  9692*             IF DEEDIT-FIELD-V2 GREATER THAN ZEROS
  9693*                MOVE DEEDIT-FIELD-V2 TO WS-BBEN    (WS-SUB1)
  9694              ELSE
  9695                 MOVE ER-7632    TO EMI-ERROR
  9696                 MOVE -1         TO BBEN-LEN   (WS-SUB1)
  9697                 MOVE AL-UNBON   TO BBEN-ATTRB (WS-SUB1)
  9698                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9699           ELSE
  9700              MOVE ER-2223         TO EMI-ERROR
  9701              MOVE -1              TO BBEN-LEN   (WS-SUB1)
  9702              MOVE AL-UNBON        TO BBEN-ATTRB (WS-SUB1)
  9703              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9704        ELSE
  9705           MOVE ER-7632    TO EMI-ERROR
  9706           MOVE -1         TO BBEN-LEN   (WS-SUB1)
  9707           MOVE AL-UNBON   TO BBEN-ATTRB (WS-SUB1)
  9708           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9709
  9710     IF (BPREM-LEN    (WS-SUB1) = ZEROS)
  9711        AND (BMAINTI = ('C' OR 'K'))
  9712        CONTINUE
  9713     ELSE
  9714        IF BPREM-LEN   (WS-SUB1) GREATER THAN ZEROS
  9715           MOVE AL-UNNON           TO BPREM-ATTRB (WS-SUB1)
  9716           INSPECT BPREM-ALPHA (WS-SUB1) TALLYING WS-TALLY
  9717              FOR ALL '.'
  9718           IF WS-TALLY > 1
  9719              PERFORM VARYING A1 FROM 1 BY 1 UNTIL
  9720                 BPREM-ALPHA (WS-SUB1) (A1:1) = '.'
  9721              END-PERFORM
  9722              IF A1 < 9
  9723                 ADD 3 TO A1
  9724                 MOVE SPACES TO BPREM-ALPHA (WS-SUB1) (A1:12 - A1)
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 182
* EL6311.cbl
  9725              END-IF
  9726           ELSE
  9727              PERFORM VARYING A1 FROM 1 BY 1 UNTIL
  9728                (A1 > 11)
  9729                OR (BPREM-ALPHA (WS-SUB1) (A1:1) =
  9730                  LOW-VALUES OR SPACES)
  9731              END-PERFORM
  9732              IF A1 > 1 AND < 12
  9733                 MOVE SPACES
  9734                           TO BPREM-ALPHA (WS-SUB1) (A1:12 - A1)
  9735              END-IF
  9736           END-IF
  9737
  9738* EXEC CICS BIF DEEDIT
  9739*              FIELD  (BPREMI (WS-SUB1))
  9740*              LENGTH (11)
  9741*          END-EXEC
  9742     MOVE 11
  9743       TO DFHEIV11
  9744*    MOVE '@"L                   #   #00009639' TO DFHEIV0
  9745     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9746     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9747     MOVE X'2020233030303039363339' TO DFHEIV0(25:11)
  9748     CALL 'kxdfhei1' USING DFHEIV0,
  9749           BPREMI(WS-SUB1),
  9750           DFHEIV11
  9751     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9752           IF BPREMI (WS-SUB1) NUMERIC
  9753              IF BPREMI (WS-SUB1) GREATER THAN ZEROS
  9754                 MOVE BPREMI (WS-SUB1) TO WS-BPREM   (WS-SUB1)
  9755*          MOVE BPREMI (WS-SUB1)   TO DEEDIT-FIELD
  9756*          PERFORM 8600-DEEDIT
  9757*          IF DEEDIT-FIELD-V2  NUMERIC
  9758*             IF DEEDIT-FIELD-V2 GREATER THAN ZEROS
  9759*                MOVE DEEDIT-FIELD-V2 TO WS-BPREM   (WS-SUB1)
  9760              ELSE
  9761                 IF PI-COMPANY-ID NOT = 'DCC'
  9762                    MOVE ER-7633    TO EMI-ERROR
  9763                    MOVE -1         TO BPREM-LEN   (WS-SUB1)
  9764                    MOVE AL-UNBON   TO BPREM-ATTRB (WS-SUB1)
  9765                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9766                 END-IF
  9767              END-IF
  9768           ELSE
  9769              MOVE ER-2223         TO EMI-ERROR
  9770              MOVE -1              TO BPREM-LEN   (WS-SUB1)
  9771              MOVE AL-UNBON        TO BPREM-ATTRB (WS-SUB1)
  9772              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9773           END-IF
  9774        ELSE
  9775           IF PI-COMPANY-ID NOT = 'DCC'
  9776              MOVE ER-7633         TO EMI-ERROR
  9777              MOVE -1              TO BPREM-LEN   (WS-SUB1)
  9778              MOVE AL-UNBON        TO BPREM-ATTRB (WS-SUB1)
  9779              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9780           END-IF
  9781        END-IF
  9782     END-IF
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 183
* EL6311.cbl
  9783
  9784     IF BCPREM-LEN   (WS-SUB1) = ZEROS
  9785        NEXT SENTENCE
  9786     ELSE
  9787        MOVE AL-UNNON           TO BCPREM-ATTRB (WS-SUB1)
  9788
  9789* EXEC CICS BIF DEEDIT
  9790*           FIELD  (BCPREMI (WS-SUB1))
  9791*           LENGTH (11)
  9792*       END-EXEC
  9793     MOVE 11
  9794       TO DFHEIV11
  9795*    MOVE '@"L                   #   #00009679' TO DFHEIV0
  9796     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9797     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9798     MOVE X'2020233030303039363739' TO DFHEIV0(25:11)
  9799     CALL 'kxdfhei1' USING DFHEIV0,
  9800           BCPREMI(WS-SUB1),
  9801           DFHEIV11
  9802     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9803        IF BCPREMI (WS-SUB1) NUMERIC
  9804           MOVE BCPREMI (WS-SUB1) TO WS-BCPREM  (WS-SUB1)
  9805*       MOVE BCPREMI (WS-SUB1)  TO DEEDIT-FIELD-X11
  9806*       PERFORM 8600-DEEDIT
  9807*       IF DEEDIT-FIELD-V2  NUMERIC
  9808*          MOVE DEEDIT-FIELD-V2 TO WS-BCPREM  (WS-SUB1)
  9809        ELSE
  9810           MOVE ER-2223         TO EMI-ERROR
  9811           MOVE -1              TO BCPREM-LEN   (WS-SUB1)
  9812           MOVE AL-UNBON        TO BCPREM-ATTRB (WS-SUB1)
  9813           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9814
  9815     IF BCRIT-PERD-LEN  (WS-SUB1)    GREATER THAN ZEROS
  9816        MOVE BCRIT-PERDI (WS-SUB1)   TO DEEDIT-FIELD
  9817        PERFORM 8600-DEEDIT
  9818        IF DEEDIT-FIELD-V0 NUMERIC
  9819           MOVE DEEDIT-FIELD-V0      TO WS-BCRIT-PERD    (WS-SUB1)
  9820           MOVE AL-UNNON             TO BCRIT-PERD-ATTRB (WS-SUB1)
  9821         ELSE
  9822           MOVE -1                   TO BCRIT-PERD-LEN   (WS-SUB1)
  9823           MOVE AL-UNBON             TO BCRIT-PERD-ATTRB (WS-SUB1)
  9824           MOVE ER-2223              TO EMI-ERROR
  9825           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9826
  9827     IF BEXPIRE-LEN  (WS-SUB1)    GREATER THAN ZEROS
  9828        IF BEXPIRE   (WS-SUB1) = SPACES
  9829           MOVE LOW-VALUES       TO WS-CONVERTED-EXPIRDT (WS-SUB1)
  9830        ELSE
  9831           MOVE BEXPIRE (WS-SUB1)   TO DEEDIT-FIELD
  9832           PERFORM 8600-DEEDIT
  9833           IF DEEDIT-FIELD-V0        NUMERIC
  9834              MOVE AL-UNNON         TO BEXPIRE-ATTRB (WS-SUB1)
  9835              MOVE 4                TO DC-OPTION-CODE
  9836              MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  9837              PERFORM 9700-DATE-LINK
  9838              MOVE DC-BIN-DATE-1    TO WS-CONVERTED-EXPIRDT
  9839                                                        (WS-SUB1)
  9840              IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 184
* EL6311.cbl
  9841                 NEXT SENTENCE
  9842              ELSE
  9843                 MOVE -1         TO BEXPIRE-LEN   (WS-SUB1)
  9844                 MOVE ER-2531    TO EMI-ERROR
  9845                 MOVE AL-UNBON   TO BEXPIRE-ATTRB (WS-SUB1)
  9846                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9847           ELSE
  9848             MOVE -1             TO BEXPIRE-LEN   (WS-SUB1)
  9849             MOVE ER-2532        TO EMI-ERROR
  9850             MOVE AL-UNBON       TO BEXPIRE-ATTRB (WS-SUB1)
  9851             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9852
  9853     IF BALT-BEN-LEN   (WS-SUB1)  = ZEROS
  9854        NEXT SENTENCE
  9855     ELSE
  9856
  9857* EXEC CICS BIF DEEDIT
  9858*           FIELD  (BALT-BENI (WS-SUB1))
  9859*           LENGTH (12)
  9860*       END-EXEC
  9861     MOVE 12
  9862       TO DFHEIV11
  9863*    MOVE '@"L                   #   #00009736' TO DFHEIV0
  9864     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9865     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9866     MOVE X'2020233030303039373336' TO DFHEIV0(25:11)
  9867     CALL 'kxdfhei1' USING DFHEIV0,
  9868           BALT-BENI(WS-SUB1),
  9869           DFHEIV11
  9870     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9871        IF BALT-BENI (WS-SUB1) NUMERIC
  9872           MOVE BALT-BENI (WS-SUB1) TO WS-BALT-BEN    (WS-SUB1)
  9873*       MOVE BALT-BENI (WS-SUB1) TO DEEDIT-FIELD
  9874*       PERFORM 8600-DEEDIT
  9875*       IF DEEDIT-FIELD-V0 NUMERIC
  9876*          MOVE DEEDIT-FIELD-V2 TO WS-BALT-BEN        (WS-SUB1)
  9877        ELSE
  9878           MOVE ER-2223         TO EMI-ERROR
  9879           MOVE -1              TO BALT-BEN-LEN       (WS-SUB1)
  9880           MOVE AL-UNBON        TO BALT-BEN-ATTRB     (WS-SUB1)
  9881           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9882
  9883     IF BALT-PREM-LEN (WS-SUB1)  = ZEROS
  9884        NEXT SENTENCE
  9885     ELSE
  9886
  9887* EXEC CICS BIF DEEDIT
  9888*           FIELD  (BALT-PREMI (WS-SUB1))
  9889*           LENGTH (11)
  9890*       END-EXEC
  9891     MOVE 11
  9892       TO DFHEIV11
  9893*    MOVE '@"L                   #   #00009755' TO DFHEIV0
  9894     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9895     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9896     MOVE X'2020233030303039373535' TO DFHEIV0(25:11)
  9897     CALL 'kxdfhei1' USING DFHEIV0,
  9898           BALT-PREMI(WS-SUB1),
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 185
* EL6311.cbl
  9899           DFHEIV11
  9900     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9901        IF BALT-PREMI (WS-SUB1) NUMERIC
  9902           MOVE BALT-PREMI (WS-SUB1) TO WS-BALT-PREM  (WS-SUB1)
  9903*       MOVE BALT-PREMI    (WS-SUB1)   TO DEEDIT-FIELD
  9904*       PERFORM 8600-DEEDIT
  9905*       IF DEEDIT-FIELD-V0 NUMERIC
  9906*          MOVE DEEDIT-FIELD-V2 TO WS-BALT-PREM       (WS-SUB1)
  9907        ELSE
  9908           MOVE ER-2223         TO EMI-ERROR
  9909           MOVE -1              TO BALT-PREM-LEN      (WS-SUB1)
  9910           MOVE AL-UNBON        TO BALT-PREM-ATTRB    (WS-SUB1)
  9911           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9912
  9913      GO TO 1020-EDIT-COVERAGES.
  9914
  9915 1025-EDIT-COMPLETE.
  9916     IF PI-COMPANY-ID  =  'DMD'
  9917        MOVE LOW-VALUES             TO BNCERTI
  9918                                       BNSTATI.
  9919
  9920     IF EMI-ERROR = ZEROS
  9921         NEXT SENTENCE
  9922     ELSE
  9923         GO TO 8200-SEND-DATAONLY.
  9924
  9925     IF BMAINTI = 'A'
  9926         GO TO 1200-ADD-ISSUE-ROUTINE.
  9927
  9928     IF BMAINTI = 'C'
  9929         GO TO 1300-CHANGE-ISSUE-ROUTINE.
  9930
  9931     GO TO 2800-REWRITE-ISSUE-CERT-KEY.
  9932
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 186
* EL6311.cbl
  9934
  9935 1030-EDIT-FOR-NUMERICS.
  9936     IF WS-CSO-SUB EQUAL 10
  9937        GO TO 1030-EDIT-EXIT.
  9938
  9939     IF (WS-EDIT-BYTE (WS-CSO-SUB) NUMERIC OR
  9940        WS-EDIT-BYTE (WS-CSO-SUB) EQUAL ',' OR
  9941        WS-EDIT-BYTE (WS-CSO-SUB) EQUAL LOW-VALUES)
  9942           ADD +1               TO WS-CSO-SUB
  9943           GO TO 1030-EDIT-FOR-NUMERICS.
  9944
  9945     MOVE 'N'                   TO WS-NUMERIC-SW.
  9946
  9947 1030-EDIT-EXIT.
  9948******************************************************************
  9949*                                                                *
  9950*                 C A L C U L A T E   A G E                      *
  9951*                                                                *
  9952******************************************************************
  9953
  9954
  9955 1095-CALC-AGE.
  9956
  9957     MOVE WS-CONVERTED-BIRTH TO DC-BIN-DATE-1.
  9958     MOVE WS-CURRENT-BIN-DT  TO DC-BIN-DATE-2.
  9959     MOVE 1                  TO DC-OPTION-CODE.
  9960     PERFORM 9700-DATE-LINK
  9961     IF NO-CONVERSION-ERROR
  9962         COMPUTE WS-BAGE = DC-ELAPSED-MONTHS / 12
  9963         MOVE WS-BAGE            TO BAGEI
  9964         MOVE +2                 TO BAGEL
  9965         MOVE AL-UNNON TO BAGEA.
  9966
  9967 1099-EXIT.
  9968     EXIT.
  9969
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 187
* EL6311.cbl
  9971
  9972******************************************************************
  9973*                                                                *
  9974*                   S H O W   I S S U E                          *
  9975*                                                                *
  9976******************************************************************
  9977
  9978 1100-SHOW-REQUEST.
  9979     MOVE 'S'                    TO PI-MAINT-FUNCTION.
  9980
  9981     IF BCERTNOL = ZEROS AND
  9982        BEFFDTL  = ZEROS
  9983        MOVE -1                  TO BMAINTL
  9984        GO TO 8200-SEND-DATAONLY.
  9985
  9986     MOVE BCERTNOI               TO WS-NEW-PRIME.
  9987
  9988     IF BSUFIXL NOT = ZEROS
  9989        MOVE BSUFIXI             TO WS-NEW-SUFFIX
  9990     ELSE
  9991        MOVE SPACE               TO WS-NEW-SUFFIX.
  9992
  9993     MOVE BEFFDTI                TO DEEDIT-FIELD.
  9994     PERFORM 8600-DEEDIT.
  9995     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
  9996     MOVE '4'                    TO DC-OPTION-CODE.
  9997     PERFORM 9700-DATE-LINK.
  9998     IF DATE-CONVERSION-ERROR
  9999        MOVE ER-0348             TO EMI-ERROR
 10000        MOVE -1                  TO BEFFDTL
 10001        MOVE AL-UABON            TO BEFFDTA
 10002        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10003        GO TO 8200-SEND-DATAONLY
 10004     ELSE
 10005        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
 10006        MOVE AL-UANON            TO BEFFDTA
 10007        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 10008
 10009     MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
 10010
 10011     IF ERPNDB-CERT-NO     NOT = WS-NEW-CERT-NO   OR
 10012        ERPNDB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT
 10013          MOVE 'Y'                    TO WS-SHOW-SW
 10014          IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
 10015             GO TO 4100-BROWSE-PRIMARY-FORWARD
 10016           ELSE
 10017             IF PI-FILE-BROWSE
 10018                GO TO 4300-BROWSE-FILE-FORWARD
 10019              ELSE
 10020                IF PI-CSR-BROWSE
 10021                   GO TO 4200-BROWSE-CSR-FORWARD
 10022                ELSE
 10023                   GO TO 4000-BROWSE-DETAIL-FORWARD
 10024        ELSE
 10025           GO TO 3900-RE-DISPLAY-RECORD.
 10026
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 188
* EL6311.cbl
 10028
 10029******************************************************************
 10030*                                                                *
 10031*            A D D   I S S U E   R O U T I N E                   *
 10032*                                                                *
 10033******************************************************************
 10034
 10035***************************************************************
 10036*     1. GETMAIN FOR PENDING BUSINESS RECORDS.                *
 10037*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
 10038*     3. INITIALIZE RECORD WITH INITIAL DATA FROM SCREEN.     *
 10039*     4. LINK TO THE EDIT ROUTINE.                            *
 10040*     5. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
 10041*     6. WRITE THE NEW ISSUE RECORD.                          *
 10042*     7. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
 10043*     8. IF ANY ERRORS ARE DETECTED, THE ISSUE SCREEN IS      *
 10044*           DISPLAYED WITH ANY ASSOCIATED ERRORS,             *
 10045*        ELSE                                                 *
 10046*           A NEW INITIALIZED SCREEN WILL BE DISPLAYED.       *
 10047***************************************************************
 10048
 10049 1200-ADD-ISSUE-ROUTINE.
 10050     MOVE 'A'                    TO PI-MAINT-FUNCTION.
 10051
 10052
 10053* EXEC CICS GETMAIN
 10054*        SET     (ADDRESS OF PENDING-BUSINESS)
 10055*        LENGTH  (ERPNDB-RECORD-LENGTH)
 10056*    END-EXEC.
 10057*    MOVE '," L                  $   #00009910' TO DFHEIV0
 10058     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 10059     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10060     MOVE X'2020233030303039393130' TO DFHEIV0(25:11)
 10061     CALL 'kxdfhei1' USING DFHEIV0,
 10062           DFHEIV20,
 10063           ERPNDB-RECORD-LENGTH,
 10064           DFHEIV99
 10065     SET ADDRESS OF PENDING-BUSINESS TO
 10066         DFHEIV20
 10067     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10068
 10069
 10070
 10071* EXEC CICS HANDLE CONDITION
 10072*         NOTFND    (1280-BATCH-HDR-NOT-FOUND)
 10073*    END-EXEC.
 10074*    MOVE '"$I                   ! # #00009915' TO DFHEIV0
 10075     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10076     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10077     MOVE X'2320233030303039393135' TO DFHEIV0(25:11)
 10078     CALL 'kxdfhei1' USING DFHEIV0
 10079     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10080
 10081
 10082     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 10083     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 10084     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 10085
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 189
* EL6311.cbl
 10086
 10087* EXEC CICS READ
 10088*        INTO    (PENDING-BUSINESS)
 10089*        DATASET (FILE-ID-ERPNDB)
 10090*        RIDFLD  (ERPNDB-KEY)
 10091*    END-EXEC.
 10092     MOVE LENGTH OF
 10093      PENDING-BUSINESS
 10094       TO DFHEIV11
 10095*    MOVE '&"IL       E          (   #00009923' TO DFHEIV0
 10096     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10097     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10098     MOVE X'2020233030303039393233' TO DFHEIV0(25:11)
 10099     CALL 'kxdfhei1' USING DFHEIV0,
 10100           FILE-ID-ERPNDB,
 10101           PENDING-BUSINESS,
 10102           DFHEIV11,
 10103           ERPNDB-KEY,
 10104           DFHEIV99,
 10105           DFHEIV99,
 10106           DFHEIV99
 10107     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10108
 10109
 10110     MOVE PB-CSR-ID              TO WS-BATCH-CSR-ID.
 10111
 10112     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 10113     ADD +1                      TO WS-B-HIGHEST-SEQ-NO.
 10114     MOVE PB-CREDIT-SELECT-DT    TO WS-CREDIT-SELECT-DT.
 10115     MOVE SPACES                 TO PENDING-BUSINESS.
 10116     MOVE 'PB'                   TO PB-RECORD-ID.
 10117     MOVE PI-PREV-KEY            TO PB-CONTROL-PRIMARY.
 10118     MOVE PI-PREV-ALT-KEY        TO PB-CONTROL-BY-ACCOUNT.
 10119     MOVE SPACES                 TO PB-CERT-SFX.
 10120     MOVE WS-B-HIGHEST-SEQ-NO    TO PB-BATCH-SEQ-NO.
 10121     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
 10122                                    PB-ALT-CHG-SEQ-NO.
 10123
 10124     MOVE BCERTNOI               TO PB-CERT-PRIME.
 10125     MOVE '1'                    TO PB-RECORD-TYPE.
 10126
 10127     IF BSUFIXL NOT = ZEROS
 10128        MOVE BSUFIXI             TO PB-CERT-SFX.
 10129
 10130     MOVE WS-CONVERTED-EFFDT     TO PB-CERT-EFF-DT.
 10131
 10132     MOVE PI-COMPANY-CD          TO PB-COMPANY-CD.
 10133     MOVE PI-COMPANY-ID          TO PB-COMPANY-ID.
 10134
 10135     MOVE ZEROS                  TO PB-I-LOAN-TERM
 10136                                    PB-I-LF-PREM-CALC
 10137                                    PB-I-LF-ALT-PREM-CALC
 10138                                    PB-I-LF-RATE
 10139                                    PB-I-LF-ALT-RATE
 10140                                    PB-I-LF-REI-RATE
 10141                                    PB-I-LF-ALT-REI-RATE
 10142                                    PB-I-RATE-DEV-PCT-LF
 10143                                    PB-I-AH-PREM-CALC
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 190
* EL6311.cbl
 10144                                    PB-I-AH-RATE
 10145                                    PB-I-AH-REI-RATE
 10146                                    PB-I-AH-RATE-TRM
 10147                                    PB-I-RATE-DEV-PCT-AH
 10148                                    PB-I-BUSINESS-TYPE
 10149                                    PB-I-LIFE-COMMISSION
 10150                                    PB-I-JOINT-COMMISSION
 10151                                    PB-I-JOINT-AGE
 10152                                    PB-I-AH-COMMISSION
 10153                                    PB-I-CURR-SEQ
 10154                                    PB-CHG-COUNT
 10155                                    PB-LF-BILLED-AMTS
 10156                                    PB-AH-BILLED-AMTS
 10157                                    PB-CALC-TOLERANCE
 10158                                    PB-I-EXTENTION-DAYS
 10159*                                   PB-I-MICROFILM-NO
 10160                                    PB-I-TERM-IN-DAYS.
 10161
 10162     MOVE LOW-VALUES             TO PB-CREDIT-ACCEPT-DT
 10163                                    PB-I-LF-EXPIRE-DT
 10164                                    PB-I-AH-EXPIRE-DT
 10165                                    PB-BILLED-DT
 10166                                    PB-ACCT-EFF-DT
 10167                                    PB-ACCT-EXP-DT
 10168                                    PB-I-1ST-PMT-DT.
 10169
 10170     MOVE 'X'                    TO PB-FATAL-FLAG.
 10171
 10172     MOVE WS-CREDIT-SELECT-DT    TO PB-CREDIT-SELECT-DT.
 10173
 10174     IF BLSTNML GREATER THAN ZEROS
 10175         MOVE BLSTNMI            TO PB-I-INSURED-LAST-NAME.
 10176
 10177*    IF BMICRNOL  GREATER  ZEROS
 10178*        MOVE BMICRNOI           TO  PB-I-MICROFILM-NO
 10179*    ELSE
 10180*        MOVE ZEROS              TO  PB-I-MICROFILM-NO.
 10181     IF BVINL > ZEROS
 10182        MOVE BVINI               TO PB-I-VIN
 10183     END-IF
 10184     IF B1STNML GREATER THAN ZEROS
 10185         MOVE B1STNMI            TO PB-I-INSURED-FIRST-NAME.
 10186
 10187     IF BINITL  GREATER THAN ZEROS
 10188         MOVE BINITI             TO PB-I-INSURED-MIDDLE-INIT.
 10189
 10190     IF BBIRTHL GREATER THAN ZERO
 10191         MOVE WS-CONVERTED-BIRTH TO PB-I-BIRTHDAY
 10192     ELSE
 10193         MOVE LOW-VALUES         TO PB-I-BIRTHDAY.
 10194
 10195     IF B1STPMTL GREATER THAN ZERO
 10196         MOVE WS-CONVERTED-1ST-PMT-DT TO PB-I-1ST-PMT-DT
 10197     ELSE
 10198         MOVE LOW-VALUES              TO PB-I-1ST-PMT-DT.
 10199
 10200     IF BAGEL    GREATER THAN ZEROS
 10201         MOVE BAGEI              TO PB-I-AGE
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 191
* EL6311.cbl
 10202        ELSE
 10203         MOVE ZEROS              TO PB-I-AGE.
 10204
 10205     IF BSEXL    GREATER THAN ZEROS
 10206         MOVE BSEXI              TO PB-I-INSURED-SEX.
 10207
 10208     IF BTERM-LEN (1) GREATER THAN ZEROS
 10209        MOVE WS-BTERM (1)        TO PB-I-LF-TERM
 10210     ELSE
 10211        MOVE ZEROS               TO PB-I-LF-TERM.
 10212
 10213     IF BTERM-LEN (2) GREATER THAN ZEROS
 10214        MOVE WS-BTERM (2)        TO PB-I-AH-TERM
 10215     ELSE
 10216        MOVE ZEROS               TO PB-I-AH-TERM.
 10217
 10218     IF BLNTRML       GREATER THAN ZEROS
 10219         MOVE BLNTRMI            TO PB-I-LOAN-TERM
 10220        ELSE
 10221         MOVE ZEROS              TO PB-I-LOAN-TERM.
 10222
 10223     IF BFREQL        GREATER THAN ZEROS
 10224         MOVE BFREQI             TO PB-I-PAY-FREQUENCY
 10225        ELSE
 10226         MOVE ZEROS              TO PB-I-PAY-FREQUENCY.
 10227
 10228     IF BSKPCDL       GREATER THAN ZEROS
 10229         MOVE BSKPCDI            TO PB-I-SKIP-CODE.
 10230
 10231     IF BMODEL        GREATER THAN ZEROS
 10232         MOVE BMODEI             TO PB-I-TERM-TYPE
 10233                                    PI-BMODE.
 10234
 10235     IF BPMTSL        GREATER THAN ZEROS
 10236         MOVE BPMTSI             TO PB-I-NO-OF-PAYMENTS
 10237                                    PI-BPMTS
 10238        ELSE
 10239         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS
 10240                                    PI-BPMTS.
 10241
 10242     IF BPMTAMTL      GREATER THAN ZEROS
 10243         MOVE PI-BPMTAMT         TO PB-I-PAYMENT-AMOUNT
 10244        ELSE
 10245         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.
 10246
 10247     IF BTYPE-LEN (1)   GREATER THAN ZEROS
 10248        IF BTYPE  (1)   NOT = ZEROS
 10249           MOVE BTYPE (1)        TO PB-I-LF-INPUT-CD
 10250                                    PI-BTYPE (1)
 10251           MOVE ZEROS            TO PB-I-LF-BENEFIT-CD
 10252           MOVE SPACES           TO PB-I-LF-ABBR
 10253        ELSE
 10254           MOVE SPACES           TO PB-I-LF-INPUT-CD
 10255                                    PB-I-LF-ABBR
 10256           MOVE ZEROS            TO PB-I-LF-BENEFIT-CD
 10257     ELSE
 10258        MOVE SPACES              TO PB-I-LF-INPUT-CD
 10259                                    PB-I-LF-ABBR
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 192
* EL6311.cbl
 10260        MOVE ZEROS               TO PB-I-LF-BENEFIT-CD.
 10261
 10262     IF  BBEN-LEN      (1)  GREATER THAN ZEROS
 10263         MOVE WS-BBEN  (1)       TO PB-I-LF-BENEFIT-AMT
 10264     ELSE
 10265         MOVE ZEROS              TO PB-I-LF-BENEFIT-AMT.
 10266
 10267     IF  BALT-BEN-LEN     (1)  GREATER THAN ZEROS
 10268         MOVE WS-BALT-BEN (1)    TO PB-I-LF-ALT-BENEFIT-AMT
 10269     ELSE
 10270         MOVE ZEROS              TO PB-I-LF-ALT-BENEFIT-AMT.
 10271
 10272     IF  BPREM-LEN     (1)  GREATER THAN ZEROS
 10273         IF WS-BPREM   (1)  NOT = WS-ALL-NINES
 10274            ADD  WS-BPREM (1)    TO WS-B-LF-ISS-PRM-ENTERED
 10275            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 10276         ELSE
 10277            MOVE ZEROS           TO PB-I-LF-PREMIUM-AMT
 10278            MOVE '?'             TO PB-I-LF-CALC-FLAG
 10279     ELSE
 10280         MOVE ZEROS              TO PB-I-LF-PREMIUM-AMT.
 10281
 10282     IF  BCPREM-LEN     (1)  GREATER THAN ZEROS
 10283         MOVE WS-BCPREM (1)      TO PB-I-LF-PREM-CALC.
 10284
 10285     IF  BALT-PREM-LEN     (1)  GREATER THAN ZEROS
 10286         ADD  WS-BALT-PREM (1) TO WS-B-LF-ISS-PRM-ENTERED
 10287         MOVE WS-BALT-PREM (1) TO PB-I-LF-ALT-PREMIUM-AMT
 10288     ELSE
 10289         MOVE ZEROS            TO PB-I-LF-ALT-PREMIUM-AMT.
 10290
 10291     IF  BALT-PREM-LEN     (2) > ZEROS
 10292         MOVE WS-BALT-PREM (2) TO PB-I-TOT-FEES
 10293     ELSE
 10294         MOVE ZEROS            TO PB-I-TOT-FEES.
 10295
 10296     IF BTYPE-LEN     (2)   GREATER THAN ZEROS
 10297        IF BTYPE      (2)   NOT = ZEROS
 10298           MOVE BTYPE (2)      TO PB-I-AH-INPUT-CD
 10299                                  PI-BTYPE (2)
 10300           MOVE ZEROS          TO PB-I-AH-BENEFIT-CD
 10301           MOVE SPACES         TO PB-I-AH-ABBR
 10302        ELSE
 10303           MOVE SPACES         TO PB-I-AH-INPUT-CD
 10304                                  PB-I-AH-ABBR
 10305           MOVE ZEROS          TO PB-I-AH-BENEFIT-CD
 10306     ELSE
 10307        MOVE SPACES            TO PB-I-AH-INPUT-CD
 10308                                  PB-I-AH-ABBR
 10309        MOVE ZEROS             TO PB-I-AH-BENEFIT-CD.
 10310
 10311     IF  BBEN-LEN         (2)  GREATER THAN ZEROS
 10312         MOVE WS-BBEN     (2)  TO PB-I-AH-BENEFIT-AMT
 10313     ELSE
 10314         MOVE ZEROS            TO PB-I-AH-BENEFIT-AMT.
 10315
 10316     IF  BPREM-LEN     (2)  GREATER THAN ZEROS
 10317         IF WS-BPREM   (2)  NOT = WS-ALL-NINES
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 193
* EL6311.cbl
 10318            ADD  WS-BPREM (2)    TO WS-B-AH-ISS-PRM-ENTERED
 10319            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 10320         ELSE
 10321            MOVE ZEROS           TO PB-I-AH-PREMIUM-AMT
 10322            MOVE '?'             TO PB-I-AH-CALC-FLAG
 10323     ELSE
 10324         MOVE ZEROS              TO PB-I-AH-PREMIUM-AMT.
 10325
 10326     IF  BCPREM-LEN     (2)  GREATER THAN ZEROS
 10327         MOVE WS-BCPREM (2)      TO PB-I-AH-PREM-CALC.
 10328
 10329     IF BCRIT-PERD-LEN      (1)   GREATER THAN ZEROS
 10330        MOVE WS-BCRIT-PERD  (1)   TO PB-I-LF-CRIT-PER
 10331     ELSE
 10332        MOVE ZEROS                TO PB-I-LF-CRIT-PER.
 10333
 10334     IF BCRIT-PERD-LEN      (2)   GREATER THAN ZEROS
 10335        MOVE WS-BCRIT-PERD  (2)   TO PB-I-AH-CRIT-PER
 10336     ELSE
 10337        MOVE ZEROS                TO PB-I-AH-CRIT-PER.
 10338
 10339     IF BINDGRPL  GREATER THAN ZEROS
 10340         MOVE BINDGRPI           TO PB-I-INDV-GRP-OVRD.
 10341
 10342     IF BRTCLSL   GREATER THAN ZEROS
 10343         MOVE BRTCLSI            TO PB-I-RATE-CLASS-OVRD.
 10344
 10345     IF BSIGL     GREATER THAN ZEROS
 10346         MOVE BSIGI              TO PB-I-SIG-SW.
 10347
 10348     IF BAPRL     GREATER THAN ZEROS
 10349         MOVE WS-BAPR            TO PB-I-LOAN-APR
 10350     ELSE
 10351         MOVE ZEROS              TO PB-I-LOAN-APR.
 10352
 10353     IF BMEMBERL  GREATER THAN ZEROS
 10354         MOVE BMEMBERI       TO PB-I-MEMBER-NO.
 10355
 10356     IF BLNOFCRL  GREATER THAN ZEROS
 10357         MOVE BLNOFCRI           TO PB-I-LOAN-OFFICER.
 10358
 10359     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 10360        MOVE WS-CONVERTED-EXPIRDT (1) TO PB-I-LF-EXPIRE-DT
 10361     ELSE
 10362        MOVE LOW-VALUES               TO PB-I-LF-EXPIRE-DT.
 10363
 10364     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 10365        MOVE WS-CONVERTED-EXPIRDT (2) TO PB-I-AH-EXPIRE-DT
 10366     ELSE
 10367        MOVE LOW-VALUES               TO PB-I-AH-EXPIRE-DT.
 10368
 10369     IF BDAYSL   GREATER THAN ZEROS
 10370        MOVE BDAYSI              TO PB-I-TERM-IN-DAYS
 10371                                    PB-I-EXTENTION-DAYS
 10372     ELSE
 10373        MOVE ZEROS               TO PB-I-TERM-IN-DAYS
 10374                                    PB-I-EXTENTION-DAYS.
 10375
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 194
* EL6311.cbl
 10376     IF BDAYSL GREATER THAN ZEROS
 10377        MOVE '2'                 TO PB-I-DATA-ENTRY-SW.
 10378
 10379     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 10380        IF WS-CONVERTED-EXPIRDT   (1) GREATER THAN LOW-VALUES
 10381           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 10382
 10383     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 10384        IF WS-CONVERTED-EXPIRDT   (2) GREATER THAN LOW-VALUES
 10385           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 10386
 10387     IF B1STPMTL GREATER THAN ZEROS
 10388        MOVE '4'                 TO PB-I-DATA-ENTRY-SW.
 10389
 10390     IF PB-EXT-DAYS-PROCESSING
 10391        IF PB-I-EXTENTION-DAYS = ZEROS
 10392           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 10393
 10394     IF PB-EXPIRE-DT-PROCESSING
 10395        IF PB-I-LF-EXPIRE-DT = LOW-VALUES AND
 10396           PB-I-AH-EXPIRE-DT = LOW-VALUES
 10397             MOVE '1'            TO PB-I-DATA-ENTRY-SW.
 10398
 10399     IF PB-1ST-PMT-DT-PROCESSING
 10400        IF PB-I-1ST-PMT-DT = LOW-VALUES
 10401           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 10402
 10403     IF BREINL GREATER THAN ZEROS
 10404        MOVE BREINI              TO PB-I-SPECIAL-REIN-CODE.
 10405
 10406     IF BENTRYL NOT = ZEROS
 10407        MOVE BENTRYI             TO PB-BATCH-ENTRY
 10408        IF PI-COMPANY-ID = 'CID'
 10409           AND (PB-BATCH-ENTRY = 'P')
 10410           AND (PB-STATE = 'VA')
 10411           PERFORM 1500-UPDATE-ERNOTE
 10412                                 THRU 1500-EXIT
 10413        END-IF
 10414     END-IF
 10415     IF BUNWRITL NOT = ZEROS
 10416        MOVE BUNWRITI            TO PB-I-UNDERWRITING-STATUS.
 10417
 10418     IF BFORCEL NOT = ZEROS
 10419        MOVE BFORCEI             TO PB-FORCE-CODE.
 10420
 10421     IF BBILCDL NOT = ZEROS
 10422        MOVE BBILCDI             TO PB-RECORD-BILL.
 10423
 10424     IF BLIVESL GREATER THAN ZEROS
 10425        MOVE WS-BLIVES           TO PB-I-LIVES
 10426     ELSE
 10427        MOVE ZEROS               TO PB-I-LIVES.
 10428
 10429     IF BBILLEDL GREATER THAN ZEROS
 10430        MOVE WS-BILLED           TO PB-I-NUM-BILLED
 10431     ELSE
 10432        MOVE ZEROS               TO PB-I-NUM-BILLED.
 10433
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 195
* EL6311.cbl
 10434*    MOVE WS-REFERENCE           TO PB-I-REFERENCE.
 10435
 10436 1260-WRITE-PB-RECORD.
 10437     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY
 10438                                    PB-INPUT-BY.
 10439     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 10440     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT
 10441                                    PB-INPUT-DT.
 10442
 10443     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 10444     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 10445                                    PB-CONTROL-BY-ORIG-BATCH.
 10446
 10447
 10448     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 10449     MOVE WS-BATCH-CSR-ID        TO PB-CSR-ID.
 10450     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 10451     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 10452     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 10453
 10454     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 10455
 10456     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 10457
 10458     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 10459     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 10460     MOVE PB-SV-STATE            TO PI-SV-STATE.
 10461
 10462     ADD PB-I-LF-PREM-CALC       TO WS-B-LF-ISS-PRM-COMPUTED.
 10463     ADD PB-I-AH-PREM-CALC       TO WS-B-AH-ISS-PRM-COMPUTED.
 10464
 10465 1275-WRITE-PENDING-BUSINESS.
 10466     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 10467     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 10468     MOVE 'A'                    TO JP-RECORD-TYPE.
 10469     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 10470
 10471
 10472* EXEC CICS HANDLE CONDITION
 10473*        DUPREC (1290-DUPLICATE-ALT-INDEX)
 10474*    END-EXEC.
 10475*    MOVE '"$%                   ! $ #00010290' TO DFHEIV0
 10476     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 10477     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10478     MOVE X'2420233030303130323930' TO DFHEIV0(25:11)
 10479     CALL 'kxdfhei1' USING DFHEIV0
 10480     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10481
 10482
 10483
 10484* EXEC CICS WRITE
 10485*        DATASET (FILE-ID-ERPNDB)
 10486*        FROM    (PENDING-BUSINESS)
 10487*        RIDFLD  (PB-CONTROL-PRIMARY)
 10488*    END-EXEC.
 10489     MOVE LENGTH OF
 10490      PENDING-BUSINESS
 10491       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 196
* EL6311.cbl
 10492*    MOVE '&$ L                  ''   #00010294' TO DFHEIV0
 10493     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10494     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10495     MOVE X'2020233030303130323934' TO DFHEIV0(25:11)
 10496     CALL 'kxdfhei1' USING DFHEIV0,
 10497           FILE-ID-ERPNDB,
 10498           PENDING-BUSINESS,
 10499           DFHEIV11,
 10500           PB-CONTROL-PRIMARY,
 10501           DFHEIV99,
 10502           DFHEIV99
 10503     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10504
 10505
 10506     ADD +1                      TO  WS-B-ISSUE-CNT-ENTERED.
 10507
 10508     PERFORM 8400-LOG-JOURNAL-RECORD.
 10509
 10510******************************************************************
 10511*       A D D  O R I G I N A L  C E R T  I N F O                 *
 10512******************************************************************
 10513     display ' made it to add orig cert '
 10514     MOVE ELCERT-KEY             TO ERMAIL-KEY
 10515     MOVE ' '                    TO WS-ERMAIL-SW
 10516
 10517* EXEC CICS READ
 10518*       DATASET   (FILE-ID-ERMAIL)
 10519*       SET       (ADDRESS OF MAILING-DATA)
 10520*       RIDFLD    (ERMAIL-KEY)
 10521*       RESP      (WS-RESPONSE)
 10522*    END-EXEC
 10523*    MOVE '&"S        E          (  N#00010310' TO DFHEIV0
 10524     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10525     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10526     MOVE X'204E233030303130333130' TO DFHEIV0(25:11)
 10527     CALL 'kxdfhei1' USING DFHEIV0,
 10528           FILE-ID-ERMAIL,
 10529           DFHEIV20,
 10530           DFHEIV99,
 10531           ERMAIL-KEY,
 10532           DFHEIV99,
 10533           DFHEIV99,
 10534           DFHEIV99
 10535     SET ADDRESS OF MAILING-DATA TO
 10536         DFHEIV20
 10537     MOVE EIBRESP  TO WS-RESPONSE
 10538     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10539     IF RESP-NORMAL
 10540        SET ERMAIL-FOUND TO TRUE
 10541     END-IF
 10542
 10543     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 10544     MOVE SPACES                 TO ORIGINAL-CERTIFICATE
 10545     MOVE 'OC'                   TO OC-RECORD-ID
 10546     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 10547                                 TO OC-CONTROL-PRIMARY (1:33)
 10548     MOVE 'I'                    TO OC-RECORD-TYPE
 10549     MOVE +4096                  TO OC-KEY-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 197
* EL6311.cbl
 10550     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
 10551     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
 10552     MOVE WS-CURRENT-BIN-DT      TO OC-LAST-MAINT-DT
 10553     MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 10554     MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 10555     MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 10556     MOVE PB-I-AGE               TO OC-INS-AGE
 10557     MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 10558     MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 10559     MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 10560     MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 10561     MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 10562     MOVE PB-I-LF-TERM           TO OC-LF-TERM
 10563     MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 10564     MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 10565     MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 10566     MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 10567     MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 10568     IF PB-I-JOINT-COMMISSION > +0
 10569         MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 10570     ELSE
 10571         MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 10572     END-IF
 10573     MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
 10574     MOVE +0                     TO OC-LF-CANCEL-AMT
 10575                                    OC-LF-ITD-CANCEL-AMT
 10576     MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 10577     MOVE PB-I-AH-TERM           TO OC-AH-TERM
 10578     MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 10579     MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 10580     MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 10581     MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 10582     MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 10583     MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
 10584     MOVE +0                     TO OC-AH-CANCEL-AMT
 10585                                    OC-AH-ITD-CANCEL-AMT
 10586     MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 10587     MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 10588     MOVE 'N'                    TO OC-CANCEL-TRAN-IND
 10589     IF ERMAIL-FOUND
 10590        MOVE MA-CRED-BENE-NAME   TO OC-CRED-BENE-NAME
 10591     END-IF
 10592     IF NOT CERT-TRL-REC-NOT-FOUND
 10593        MOVE CS-INS-AGE-DEFAULT-FLAG TO
 10594                           OC-INS-AGE-DEFAULT-FLAG
 10595        MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 10596                           OC-JNT-AGE-DEFAULT-FLAG
 10597     END-IF
 10598     MOVE LOW-VALUES             TO OC-ENDORSEMENT-PROCESSED-DT
 10599     .
 10600 1275-WRITE-ELCRTO.
 10601
 10602* EXEC CICS WRITE
 10603*       DATASET   ('ELCRTO')
 10604*       FROM      (ORIGINAL-CERTIFICATE)
 10605*       RIDFLD    (OC-CONTROL-PRIMARY)
 10606*       RESP      (WS-RESPONSE)
 10607*    END-EXEC
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 198
* EL6311.cbl
 10608     MOVE LENGTH OF
 10609      ORIGINAL-CERTIFICATE
 10610       TO DFHEIV11
 10611     MOVE 'ELCRTO' TO DFHEIV1
 10612*    MOVE '&$ L                  ''  N#00010378' TO DFHEIV0
 10613     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10614     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10615     MOVE X'204E233030303130333738' TO DFHEIV0(25:11)
 10616     CALL 'kxdfhei1' USING DFHEIV0,
 10617           DFHEIV1,
 10618           ORIGINAL-CERTIFICATE,
 10619           DFHEIV11,
 10620           OC-CONTROL-PRIMARY,
 10621           DFHEIV99,
 10622           DFHEIV99
 10623     MOVE EIBRESP  TO WS-RESPONSE
 10624     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10625     display ' just wrote 1275 ' ws-response
 10626     IF RESP-DUPKEY
 10627        SUBTRACT +1              FROM OC-KEY-SEQ-NO
 10628        GO TO 1275-WRITE-ELCRTO
 10629     ELSE
 10630        IF NOT RESP-NORMAL
 10631           MOVE -1               TO BMAINTL
 10632           MOVE ER-7450          TO EMI-ERROR
 10633           PERFORM 9900-ERROR-FORMAT
 10634                                 THRU 9900-EXIT
 10635           GO TO 8200-SEND-DATAONLY
 10636        END-IF
 10637     END-IF
 10638******************************************************************
 10639*       U P D A T E   T H E   B A T C H   H E A D E R            *
 10640******************************************************************
 10641
 10642
 10643* EXEC CICS READ
 10644*        INTO    (PENDING-BUSINESS)
 10645*        DATASET (FILE-ID-ERPNDB)
 10646*        RIDFLD  (ERPNDB-KEY)
 10647*        UPDATE
 10648*    END-EXEC.
 10649     MOVE LENGTH OF
 10650      PENDING-BUSINESS
 10651       TO DFHEIV11
 10652*    MOVE '&"IL       EU         (   #00010401' TO DFHEIV0
 10653     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10654     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10655     MOVE X'2020233030303130343031' TO DFHEIV0(25:11)
 10656     CALL 'kxdfhei1' USING DFHEIV0,
 10657           FILE-ID-ERPNDB,
 10658           PENDING-BUSINESS,
 10659           DFHEIV11,
 10660           ERPNDB-KEY,
 10661           DFHEIV99,
 10662           DFHEIV99,
 10663           DFHEIV99
 10664     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10665
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 199
* EL6311.cbl
 10666
 10667     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 10668     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 10669     MOVE 'B'                    TO JP-RECORD-TYPE.
 10670     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 10671
 10672     PERFORM 8400-LOG-JOURNAL-RECORD.
 10673
 10674     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 10675
 10676
 10677* EXEC CICS REWRITE
 10678*        DATASET (FILE-ID-ERPNDB)
 10679*        FROM    (PENDING-BUSINESS)
 10680*    END-EXEC.
 10681     MOVE LENGTH OF
 10682      PENDING-BUSINESS
 10683       TO DFHEIV11
 10684*    MOVE '&& L                  %   #00010417' TO DFHEIV0
 10685     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10686     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10687     MOVE X'2020233030303130343137' TO DFHEIV0(25:11)
 10688     CALL 'kxdfhei1' USING DFHEIV0,
 10689           FILE-ID-ERPNDB,
 10690           PENDING-BUSINESS,
 10691           DFHEIV11,
 10692           DFHEIV99
 10693     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10694
 10695
 10696     MOVE 'C'                    TO JP-RECORD-TYPE.
 10697     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 10698
 10699     PERFORM 8400-LOG-JOURNAL-RECORD.
 10700
 10701     IF WS-ERRORS-PRESENT
 10702         GO TO 3900-RE-DISPLAY-RECORD.
 10703
 10704     MOVE ZEROS                  TO EMI-ERROR.
 10705     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10706     MOVE LOW-VALUES             TO EL631BI.
 10707     MOVE  -1                    TO BMAINTL.
 10708     GO TO 8100-SEND-INITIAL-MAP.
 10709
 10710 1280-BATCH-HDR-NOT-FOUND.
 10711     MOVE -1                     TO BMAINTL.
 10712     MOVE ER-7450                TO EMI-ERROR.
 10713     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10714     GO TO 8200-SEND-DATAONLY.
 10715
 10716 1290-DUPLICATE-ALT-INDEX.
 10717
 10718******************************************************************
 10719*                                                                *
 10720*      IF THE PB-B-HIGHEST-SEQ-NO WAS NOT UPDATED IN THE DATA    *
 10721*         ENTRY SESSION, ADD +1 TO THE HIGHEST SEQUENCE NUMBER   *
 10722*         AND ATTEMPT TO WRITE THE RECORD AGAIN. REPEAT THIS     *
 10723*         50 TIMES.  IF DUPREC CONDITION IS STILL ENCOUNTERED    *
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 200
* EL6311.cbl
 10724*         AFTER 50 TIMES, ASSUME THE DUPLICATE RECORD WAS        *
 10725*         CAUSED BY A DUPLICATE ALTERNATE KEY.                   *
 10726*                                                                *
 10727******************************************************************
 10728
 10729     IF LCP-ONCTR-01 =  0
 10730         ADD 1 TO LCP-ONCTR-01
 10731        MOVE +0                  TO WS-SEQ-NO-COUNTER.
 10732
 10733     ADD +1                      TO WS-SEQ-NO-COUNTER.
 10734
 10735     IF  WS-SEQ-NO-COUNTER GREATER THAN +50
 10736         NEXT SENTENCE
 10737     ELSE
 10738         ADD +1 TO PB-BATCH-SEQ-NO
 10739                   PB-CSR-BATCH-SEQ-NO
 10740         MOVE PB-BATCH-SEQ-NO TO WS-B-HIGHEST-SEQ-NO
 10741         GO TO 1275-WRITE-PENDING-BUSINESS.
 10742
 10743     MOVE -1                     TO BCERTNOL.
 10744     MOVE AL-UABON               TO BCERTNOA.
 10745     MOVE AL-UNBON               TO BEFFDTA.
 10746
 10747     MOVE 1                      TO EMI-SUB
 10748                                    EMI-SWITCH1
 10749                                    EMI-SWITCH-AREA-1
 10750                                    EMI-SWITCH-AREA-2.
 10751
 10752     MOVE SPACES                 TO EMI-ERROR-LINES.
 10753
 10754
 10755* EXEC CICS SYNCPOINT ROLLBACK
 10756*    END-EXEC.
 10757*    MOVE '6"R                   !   #00010480' TO DFHEIV0
 10758     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 10759     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10760     MOVE X'2020233030303130343830' TO DFHEIV0(25:11)
 10761     CALL 'kxdfhei1' USING DFHEIV0
 10762     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10763
 10764
 10765     MOVE ER-2247                TO EMI-ERROR.
 10766     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10767     GO TO 8200-SEND-DATAONLY.
 10768
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 201
* EL6311.cbl
 10770
 10771
 10772 1295-READ-CERT-TRAILER.
 10773
 10774
 10775* EXEC CICS GETMAIN
 10776*        SET     (ADDRESS OF CERTIFICATE-TRAILERS)
 10777*        LENGTH  (ELCRTT-RECORD-LENGTH)
 10778*        INITIMG (GETMAIN-SPACE)
 10779*    END-EXEC
 10780*    MOVE ',"IL                  $   #00010492' TO DFHEIV0
 10781     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 10782     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10783     MOVE X'2020233030303130343932' TO DFHEIV0(25:11)
 10784     CALL 'kxdfhei1' USING DFHEIV0,
 10785           DFHEIV20,
 10786           ELCRTT-RECORD-LENGTH,
 10787           GETMAIN-SPACE
 10788     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 10789         DFHEIV20
 10790     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10791
 10792     MOVE +0                     TO  WS-CERT-TRL-REC-NOT-FOUND.
 10793     MOVE ELCERT-KEY             TO  ELCRTT-PRIMARY.
 10794     MOVE 'C'                    TO  ELCRTT-REC-TYPE.
 10795
 10796
 10797* EXEC CICS HANDLE CONDITION
 10798*        NOTFND (1295-CERT-TRL-REC-NOTFND)
 10799*    END-EXEC.
 10800*    MOVE '"$I                   ! % #00010502' TO DFHEIV0
 10801     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10802     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10803     MOVE X'2520233030303130353032' TO DFHEIV0(25:11)
 10804     CALL 'kxdfhei1' USING DFHEIV0
 10805     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10806
 10807
 10808
 10809* EXEC CICS READ
 10810*        DATASET  (CRTT-ID)
 10811*        RIDFLD   (ELCRTT-KEY)
 10812*        INTO     (CERTIFICATE-TRAILERS)
 10813*    END-EXEC.
 10814     MOVE LENGTH OF
 10815      CERTIFICATE-TRAILERS
 10816       TO DFHEIV11
 10817*    MOVE '&"IL       E          (   #00010506' TO DFHEIV0
 10818     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10819     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10820     MOVE X'2020233030303130353036' TO DFHEIV0(25:11)
 10821     CALL 'kxdfhei1' USING DFHEIV0,
 10822           CRTT-ID,
 10823           CERTIFICATE-TRAILERS,
 10824           DFHEIV11,
 10825           ELCRTT-KEY,
 10826           DFHEIV99,
 10827           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 202
* EL6311.cbl
 10828           DFHEIV99
 10829     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10830
 10831
 10832     GO TO 1295-EXIT.
 10833
 10834 1295-CERT-TRL-REC-NOTFND.
 10835     MOVE +1                     TO WS-CERT-TRL-REC-NOT-FOUND.
 10836
 10837 1295-EXIT.
 10838     EXIT.
 10839
 10840******************************************************************
 10841*                                                                *
 10842*          C H A N G E   I S S U E   R O U T I N E               *
 10843*                                                                *
 10844******************************************************************
 10845
 10846***************************************************************
 10847*                                                             *
 10848*     1. GETMAIN FOR PENDING BUSINESS RECORD.                 *
 10849*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
 10850*     3. GET THE RECORD TO BE UPDATED AND SEE IF IT HAS BEEN  *
 10851*              BILLED.  IF IT HAS THEN SAVE A -COPY- OF THE   *
 10852*              ZERO RECORD FOR CREATING REVERSAL ENTRIES.     *
 10853*     4. UPDATE THE RECORD WITH THE SCREEN DATA               *
 10854*     5. LINK TO THE EDIT ROUTINE.                            *
 10855*     6. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
 10856*     7. REDISPLAY SCREEN DATA WITH NEW DATA RETURNED FROM    *
 10857*              THE EDIT ROUTINE.                              *
 10858*     7. REWRITE THE NEW ISSUE                                *
 10859*     8. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
 10860*                                                             *
 10861***************************************************************
 10862
 10863 1300-CHANGE-ISSUE-ROUTINE.
 10864     MOVE 'C'                    TO PI-MAINT-FUNCTION.
 10865
 10866     IF BCHGL NOT = ZEROS
 10867        MOVE ER-2196             TO EMI-ERROR
 10868        MOVE AL-UABON            TO BMAINTA
 10869        MOVE -1                  TO BMAINTL
 10870        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10871        GO TO 8200-SEND-DATAONLY.
 10872
 10873     MOVE BCERTNOI               TO WS-NEW-PRIME.
 10874
 10875     IF BSUFIXL NOT = ZEROS
 10876        MOVE BSUFIXI             TO WS-NEW-SUFFIX
 10877     ELSE
 10878        MOVE SPACE               TO WS-NEW-SUFFIX.
 10879
 10880     MOVE BEFFDTI                TO DEEDIT-FIELD.
 10881     PERFORM 8600-DEEDIT.
 10882     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 10883     MOVE '4'                    TO DC-OPTION-CODE.
 10884     PERFORM 9700-DATE-LINK.
 10885     IF DATE-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 203
* EL6311.cbl
 10886        MOVE ER-0348             TO EMI-ERROR
 10887        MOVE -1                  TO BEFFDTL
 10888        MOVE AL-UABON            TO BEFFDTA
 10889        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10890        GO TO 8200-SEND-DATAONLY
 10891     ELSE
 10892        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
 10893        MOVE AL-UANON            TO BEFFDTA
 10894        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 10895
 10896 1325-PROCESS-ISSUE-CHANGES.
 10897
 10898* EXEC CICS HANDLE CONDITION
 10899*         NOTFND    (1380-BATCH-HDR-NOT-FOUND)
 10900*    END-EXEC.
 10901*    MOVE '"$I                   ! & #00010577' TO DFHEIV0
 10902     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10903     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10904     MOVE X'2620233030303130353737' TO DFHEIV0(25:11)
 10905     CALL 'kxdfhei1' USING DFHEIV0
 10906     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10907
 10908
 10909     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 10910     MOVE +9999                   TO ERPNDB-BATCH-SEQ-NO.
 10911     MOVE ZEROS                   TO ERPNDB-BATCH-CHG-SEQ-NO.
 10912
 10913
 10914* EXEC CICS GETMAIN
 10915*        SET      (ADDRESS OF PENDING-BUSINESS)
 10916*        LENGTH   (ERPNDB-RECORD-LENGTH)
 10917*        INITIMG  (GETMAIN-SPACE)
 10918*     END-EXEC.
 10919*    MOVE ',"IL                  $   #00010585' TO DFHEIV0
 10920     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 10921     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10922     MOVE X'2020233030303130353835' TO DFHEIV0(25:11)
 10923     CALL 'kxdfhei1' USING DFHEIV0,
 10924           DFHEIV20,
 10925           ERPNDB-RECORD-LENGTH,
 10926           GETMAIN-SPACE
 10927     SET ADDRESS OF PENDING-BUSINESS TO
 10928         DFHEIV20
 10929     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10930
 10931
 10932
 10933* EXEC CICS READ
 10934*        INTO    (PENDING-BUSINESS)
 10935*        DATASET (FILE-ID-ERPNDB)
 10936*        RIDFLD  (ERPNDB-KEY)
 10937*    END-EXEC.
 10938     MOVE LENGTH OF
 10939      PENDING-BUSINESS
 10940       TO DFHEIV11
 10941*    MOVE '&"IL       E          (   #00010591' TO DFHEIV0
 10942     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10943     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 204
* EL6311.cbl
 10944     MOVE X'2020233030303130353931' TO DFHEIV0(25:11)
 10945     CALL 'kxdfhei1' USING DFHEIV0,
 10946           FILE-ID-ERPNDB,
 10947           PENDING-BUSINESS,
 10948           DFHEIV11,
 10949           ERPNDB-KEY,
 10950           DFHEIV99,
 10951           DFHEIV99,
 10952           DFHEIV99
 10953     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10954
 10955
 10956     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 10957
 10958
 10959* EXEC CICS HANDLE CONDITION
 10960*         NOTFND     (1385-REC-NOT-FOUND)
 10961*    END-EXEC.
 10962*    MOVE '"$I                   ! '' #00010599' TO DFHEIV0
 10963     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10964     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10965     MOVE X'2720233030303130353939' TO DFHEIV0(25:11)
 10966     CALL 'kxdfhei1' USING DFHEIV0
 10967     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10968
 10969
 10970**********************************************************
 10971*      DONT READ THE RECORD FOR UPDATE UNTIL             *
 10972*      AFTER THE CHANGE RECORD HAS BEEN CREATED.         *
 10973**********************************************************
 10974
 10975
 10976* EXEC CICS READ
 10977*        DATASET (FILE-ID-ERPNDB)
 10978*        INTO    (PENDING-BUSINESS)
 10979*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 10980*    END-EXEC.
 10981     MOVE LENGTH OF
 10982      PENDING-BUSINESS
 10983       TO DFHEIV11
 10984*    MOVE '&"IL       E          (   #00010608' TO DFHEIV0
 10985     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10986     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10987     MOVE X'2020233030303130363038' TO DFHEIV0(25:11)
 10988     CALL 'kxdfhei1' USING DFHEIV0,
 10989           FILE-ID-ERPNDB,
 10990           PENDING-BUSINESS,
 10991           DFHEIV11,
 10992           PI-PREV-CONTROL-PRIMARY,
 10993           DFHEIV99,
 10994           DFHEIV99,
 10995           DFHEIV99
 10996     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10997
 10998
 10999********** DO NOT ALLOW CHANGES IF THRU A/R
 11000     IF BMAINTI = 'C'
 11001         IF PB-EL860-INTERNAL-PROCESS
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 205
* EL6311.cbl
 11002             MOVE ER-4005          TO EMI-ERROR
 11003             MOVE -1               TO BMAINTL
 11004             MOVE AL-UABON         TO BMAINTA
 11005             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11006             GO TO 8200-SEND-DATAONLY.
 11007**********
 11008
 11009     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 11010        MOVE -1                 TO BMAINTL
 11011        MOVE ER-2197            TO EMI-ERROR
 11012        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11013        GO TO 8200-SEND-DATAONLY.
 11014
 11015     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 11016        MOVE ER-2196             TO EMI-ERROR
 11017        MOVE AL-UABON            TO BMAINTA
 11018        MOVE -1                  TO BMAINTL
 11019        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11020        GO TO 8200-SEND-DATAONLY.
 11021
 11022     MOVE ZEROS                  TO WS-SEQ-SAVE.
 11023
 11024     IF PB-BILLED-DT = LOW-VALUES AND
 11025        PB-CHG-COUNT = ZEROS
 11026        NEXT SENTENCE
 11027     ELSE
 11028        IF (BPREM-LEN (1) GREATER THAN ZEROS AND
 11029            WS-BPREM  (1) NOT = PB-I-LF-PREMIUM-AMT)
 11030           OR
 11031           (BPREM-LEN (2) GREATER THAN ZEROS AND
 11032            WS-BPREM  (2) NOT = PB-I-AH-PREMIUM-AMT)
 11033           PERFORM 2700-BUILD-CORRECTION-RECORD THRU 2799-EXIT.
 11034
 11035
 11036* EXEC CICS READ
 11037*        DATASET (FILE-ID-ERPNDB)
 11038*        INTO    (PENDING-BUSINESS)
 11039*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 11040*        UPDATE
 11041*    END-EXEC.
 11042     MOVE LENGTH OF
 11043      PENDING-BUSINESS
 11044       TO DFHEIV11
 11045*    MOVE '&"IL       EU         (   #00010650' TO DFHEIV0
 11046     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11047     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11048     MOVE X'2020233030303130363530' TO DFHEIV0(25:11)
 11049     CALL 'kxdfhei1' USING DFHEIV0,
 11050           FILE-ID-ERPNDB,
 11051           PENDING-BUSINESS,
 11052           DFHEIV11,
 11053           PI-PREV-CONTROL-PRIMARY,
 11054           DFHEIV99,
 11055           DFHEIV99,
 11056           DFHEIV99
 11057     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11058
 11059
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 206
* EL6311.cbl
 11060     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 11061     MOVE 'B'                    TO JP-RECORD-TYPE
 11062     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11063     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 11064
 11065     PERFORM 8400-LOG-JOURNAL-RECORD.
 11066
 11067     IF PB-BILLED-DT NOT = LOW-VALUES OR
 11068        PB-CHG-COUNT NOT = ZEROS
 11069        IF (BPREM-LEN (1) GREATER THAN ZEROS AND
 11070            WS-BPREM  (1) NOT = PB-I-LF-PREMIUM-AMT)
 11071           OR
 11072           (BPREM-LEN (2) GREATER THAN ZEROS AND
 11073            WS-BPREM  (2) NOT = PB-I-AH-PREMIUM-AMT)
 11074            MOVE LOW-VALUES             TO PB-BILLED-DT
 11075            ADD +1                      TO PB-CHG-COUNT.
 11076
 11077     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 11078     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 11079     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 11080     MOVE '5'                    TO DC-OPTION-CODE.
 11081     PERFORM 9700-DATE-LINK
 11082     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 11083
 11084*    IF BMICRNOL  GREATER  ZEROS
 11085*        MOVE BMICRNOI           TO  PB-I-MICROFILM-NO.
 11086
 11087     IF BVINL > ZEROS
 11088        MOVE BVINI               TO PB-I-VIN
 11089     END-IF
 11090     IF (BFORCEL NOT = ZEROS)
 11091        AND (PB-COMPANY-ID = 'DCC')
 11092        AND (BFORCEI = ' ')
 11093        AND (PB-FORCE-CODE = 'O')
 11094        COMPUTE PB-I-AH-PREMIUM-AMT =
 11095           PB-I-DCC-OVER-CHG-AMT + PB-I-AH-PREM-CALC
 11096        PERFORM 1800-REMOVE-CERT-NOTES
 11097                                 THRU 1800-EXIT
 11098        PERFORM 1900-DELETE-ERPYAJ
 11099                                 THRU 1900-EXIT
 11100        MOVE +0                  TO PB-I-DCC-OVER-CHG-AMT
 11101     END-IF
 11102     IF (BFORCEL NOT = ZEROS)
 11103        AND (PB-COMPANY-ID = 'DCC')
 11104        AND (BFORCEI = 'O')
 11105        AND (PB-FORCE-CODE NOT = 'O')
 11106        COMPUTE WS-OC-AMT = PB-I-AH-PREMIUM-AMT -
 11107           PB-I-AH-PREM-CALC
 11108        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1
 11109        MOVE SPACE               TO DC-OPTION-CODE
 11110        PERFORM 9700-DATE-LINK
 11111        MOVE DC-GREG-DATE-A-EDIT TO WS-OC-DATE
 11112        MOVE WS-OC-AMT           TO PB-I-DCC-OVER-CHG-AMT
 11113        MOVE PB-I-AH-PREM-CALC   TO PB-I-AH-PREMIUM-AMT
 11114        MOVE WS-OC-AMT           TO WS-OC-DIS-AMT
 11115        PERFORM 1500-UPDATE-ERNOTE
 11116                                 THRU 1500-EXIT
 11117        PERFORM 1600-UPDATE-ERPYAJ
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 207
* EL6311.cbl
 11118                                 THRU 1600-EXIT
 11119     END-IF
 11120     IF BLSTNML  GREATER THAN ZEROS
 11121         MOVE BLSTNMI            TO PB-I-INSURED-LAST-NAME.
 11122
 11123     IF B1STNML  GREATER THAN ZEROS
 11124         MOVE B1STNMI            TO PB-I-INSURED-FIRST-NAME.
 11125
 11126     IF BINITL   GREATER THAN ZEROS
 11127         MOVE BINITI             TO PB-I-INSURED-MIDDLE-INIT.
 11128
 11129     IF BBIRTHL  GREATER THAN ZERO
 11130         MOVE WS-CONVERTED-BIRTH TO PB-I-BIRTHDAY.
 11131
 11132     IF B1STPMTL GREATER THAN ZERO
 11133         MOVE WS-CONVERTED-1ST-PMT-DT TO PB-I-1ST-PMT-DT.
 11134
 11135     IF BAGEL    GREATER THAN ZEROS
 11136         MOVE BAGEI              TO PB-I-AGE.
 11137
 11138     MOVE 'N'                    TO WS-INS-AGE-SET
 11139                                    WS-JNT-AGE-SET.
 11140     IF BAGEL    GREATER THAN ZEROS
 11141        MOVE 'Y'                TO WS-INS-AGE-SET
 11142        IF BAGEI = ZERO AND
 11143             (PB-I-BIRTHDAY = LOW-VALUES OR SPACES)
 11144           MOVE 'Y'             TO WS-INS-AGE-DEFAULTED
 11145           MOVE 'AGE*'          TO BAGEDEFO
 11146        ELSE
 11147           MOVE 'N'             TO WS-INS-AGE-DEFAULTED
 11148           MOVE 'AGE '          TO BAGEDEFO
 11149        END-IF
 11150        PERFORM 1386-UPDATE-AGE-FLAGS THRU 1386-EXIT
 11151     END-IF.
 11152
 11153     IF BSEXL    GREATER THAN ZEROS
 11154         MOVE BSEXI              TO PB-I-INSURED-SEX.
 11155
 11156     IF BTERM-LEN (1)   GREATER THAN ZEROS
 11157        MOVE WS-BTERM (1)        TO PB-I-LF-TERM.
 11158
 11159     IF BTERM-LEN (2)   GREATER THAN ZEROS
 11160        MOVE WS-BTERM (2)        TO PB-I-AH-TERM.
 11161
 11162     IF BLNTRML  GREATER THAN ZEROS
 11163         MOVE BLNTRMI            TO PB-I-LOAN-TERM.
 11164
 11165     IF BFREQL   GREATER THAN ZEROS
 11166         MOVE BFREQI             TO PB-I-PAY-FREQUENCY.
 11167
 11168     IF BSKPCDL  GREATER THAN ZEROS
 11169         MOVE BSKPCDI            TO PB-I-SKIP-CODE.
 11170
 11171     IF BMODEL   GREATER THAN ZEROS
 11172         MOVE BMODEI             TO PB-I-TERM-TYPE
 11173                                    PI-BMODE.
 11174
 11175     IF BPMTSL   GREATER THAN ZEROS
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 208
* EL6311.cbl
 11176         MOVE BPMTSI             TO PB-I-NO-OF-PAYMENTS
 11177                                    PI-BPMTS.
 11178
 11179     IF BPMTAMTL GREATER THAN ZEROS
 11180         MOVE PI-BPMTAMT         TO PB-I-PAYMENT-AMOUNT.
 11181
 11182     IF  BBEN-LEN      (1)  GREATER THAN ZEROS
 11183         MOVE WS-BBEN  (1)       TO PB-I-LF-BENEFIT-AMT.
 11184
 11185     IF  BALT-BEN-LEN     (1)  GREATER THAN ZEROS
 11186         MOVE WS-BALT-BEN (1)    TO PB-I-LF-ALT-BENEFIT-AMT.
 11187
 11188     MOVE SPACE TO PB-I-LF-CALC-FLAG.
 11189
 11190     IF  BPREM-LEN     (1)  GREATER THAN ZEROS
 11191         IF WS-BPREM   (1)  NOT = WS-ALL-NINES
 11192            SUBTRACT PB-I-LF-PREMIUM-AMT
 11193                     FROM WS-B-LF-ISS-PRM-ENTERED
 11194            ADD  WS-BPREM (1)    TO WS-B-LF-ISS-PRM-ENTERED
 11195            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 11196            MOVE SPACE           TO PB-I-LF-CALC-FLAG
 11197         ELSE
 11198            MOVE ZEROS           TO PB-I-LF-PREMIUM-AMT
 11199            MOVE '?'             TO PB-I-LF-CALC-FLAG.
 11200
 11201     IF  BALT-PREM-LEN     (1)  GREATER THAN ZEROS
 11202            SUBTRACT PB-I-LF-ALT-PREMIUM-AMT
 11203                     FROM WS-B-LF-ISS-PRM-ENTERED
 11204         ADD  WS-BALT-PREM (1) TO WS-B-LF-ISS-PRM-ENTERED
 11205         MOVE WS-BALT-PREM (1) TO PB-I-LF-ALT-PREMIUM-AMT.
 11206
 11207     IF  BALT-PREM-LEN     (2)  > ZEROS
 11208         MOVE WS-BALT-PREM (2) TO PB-I-TOT-FEES.
 11209
 11210     IF  BBEN-LEN (2)  GREATER THAN ZEROS
 11211         MOVE WS-BBEN (2)  TO PB-I-AH-BENEFIT-AMT.
 11212
 11213     IF  BPREM-LEN     (2)  GREATER THAN ZEROS
 11214         IF WS-BPREM   (2)  NOT = WS-ALL-NINES
 11215            SUBTRACT PB-I-AH-PREMIUM-AMT
 11216                     FROM WS-B-AH-ISS-PRM-ENTERED
 11217            ADD  WS-BPREM (2)    TO WS-B-AH-ISS-PRM-ENTERED
 11218            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 11219            MOVE SPACE           TO PB-I-AH-CALC-FLAG
 11220         ELSE
 11221            MOVE ZEROS           TO PB-I-AH-PREMIUM-AMT
 11222            MOVE '?'             TO PB-I-AH-CALC-FLAG.
 11223
 11224     IF BCRIT-PERD-LEN      (1)   GREATER THAN ZEROS
 11225        MOVE WS-BCRIT-PERD  (1)   TO PB-I-LF-CRIT-PER.
 11226
 11227     IF BCRIT-PERD-LEN      (2)   GREATER THAN ZEROS
 11228        MOVE WS-BCRIT-PERD  (2)   TO PB-I-AH-CRIT-PER.
 11229
 11230     IF BINDGRPL            GREATER THAN ZEROS
 11231         MOVE BINDGRPI           TO PB-I-INDV-GRP-OVRD.
 11232
 11233     IF BRTCLSL             GREATER THAN ZEROS
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 209
* EL6311.cbl
 11234         MOVE BRTCLSI            TO PB-I-RATE-CLASS-OVRD.
 11235
 11236     IF BSIGL               GREATER THAN ZEROS
 11237         MOVE BSIGI              TO PB-I-SIG-SW.
 11238
 11239     IF BAPRL               GREATER THAN ZEROS
 11240         MOVE WS-BAPR            TO PB-I-LOAN-APR.
 11241
 11242     IF BMEMBERL            GREATER THAN ZEROS
 11243         MOVE BMEMBERI       TO PB-I-MEMBER-NO.
 11244
 11245     IF BLNOFCRL            GREATER THAN ZEROS
 11246         MOVE BLNOFCRI           TO PB-I-LOAN-OFFICER.
 11247
 11248     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 11249        MOVE WS-CONVERTED-EXPIRDT (1) TO PB-I-LF-EXPIRE-DT.
 11250
 11251     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 11252        MOVE WS-CONVERTED-EXPIRDT (2) TO PB-I-AH-EXPIRE-DT.
 11253
 11254     IF BDAYSL              GREATER THAN ZEROS
 11255        MOVE BDAYSI              TO PB-I-TERM-IN-DAYS
 11256                                    PB-I-EXTENTION-DAYS.
 11257
 11258     IF BDAYSL GREATER THAN ZEROS
 11259        MOVE '2'                 TO PB-I-DATA-ENTRY-SW.
 11260
 11261     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 11262        IF WS-CONVERTED-EXPIRDT   (1) GREATER THAN LOW-VALUES
 11263           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 11264
 11265     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 11266        IF WS-CONVERTED-EXPIRDT   (2) GREATER THAN LOW-VALUES
 11267           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 11268
 11269     IF B1STPMTL GREATER THAN ZEROS
 11270        MOVE '4'                 TO PB-I-DATA-ENTRY-SW.
 11271
 11272     IF PB-EXT-DAYS-PROCESSING
 11273        IF PB-I-EXTENTION-DAYS = ZEROS
 11274           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 11275
 11276     IF PB-EXPIRE-DT-PROCESSING
 11277        IF PB-I-LF-EXPIRE-DT = LOW-VALUES AND
 11278           PB-I-AH-EXPIRE-DT = LOW-VALUES
 11279             MOVE '1'            TO PB-I-DATA-ENTRY-SW.
 11280
 11281     IF PB-1ST-PMT-DT-PROCESSING
 11282        IF PB-I-1ST-PMT-DT = LOW-VALUES
 11283           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 11284
 11285     IF BREINL GREATER THAN ZEROS
 11286        MOVE BREINI              TO PB-I-SPECIAL-REIN-CODE.
 11287
 11288     IF BFORCEL NOT = ZEROS
 11289        MOVE BFORCEI             TO PB-FORCE-CODE.
 11290     IF (BENTRYL NOT = ZEROS)
 11291        AND (PB-COMPANY-ID = 'CID')
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 210
* EL6311.cbl
 11292        AND (PB-STATE = 'VA')
 11293        AND (BENTRYI NOT = 'P')
 11294        AND (PB-BATCH-ENTRY = 'P')
 11295        PERFORM 1800-REMOVE-CERT-NOTES
 11296                                 THRU 1800-EXIT
 11297     END-IF
 11298     IF BENTRYL NOT = ZEROS
 11299        MOVE BENTRYI             TO PB-BATCH-ENTRY
 11300        IF PI-COMPANY-ID = 'CID'
 11301           AND (PB-BATCH-ENTRY = 'P')
 11302           AND (PB-STATE = 'VA')
 11303           PERFORM 1500-UPDATE-ERNOTE
 11304                                 THRU 1500-EXIT
 11305        END-IF
 11306     END-IF
 11307
 11308     IF BUNWRITL NOT = ZEROS
 11309        MOVE BUNWRITI            TO PB-I-UNDERWRITING-STATUS.
 11310
 11311     IF BBILCDL NOT = ZEROS
 11312        MOVE BBILCDI             TO PB-RECORD-BILL.
 11313
 11314     IF BLIVESL GREATER THAN ZEROS
 11315        MOVE WS-BLIVES           TO PB-I-LIVES.
 11316
 11317
 11318*DMD CUSTOM CODING*************START
 11319     IF PI-COMPANY-ID NOT = 'DMD'
 11320         MOVE ZEROS               TO BBILLEDL.
 11321*DMD CUSTOM CODING*************END
 11322
 11323     IF BBILLEDL GREATER THAN ZEROS
 11324        MOVE WS-BILLED           TO PB-I-NUM-BILLED.
 11325
 11326
 11327*****************************************************************
 11328*        IF BTYPE = ZEROS OR SPACES DELETE COVERAGE             *
 11329*****************************************************************
 11330
 11331     IF BTYPE-LEN (1)   GREATER THAN ZEROS
 11332        IF BTYPE  (1)   = ZEROS OR SPACES
 11333           IF REMOVE-LF-COVERAGE
 11334               MOVE SPACES           TO PB-I-LF-INPUT-CD
 11335                                        PI-BTYPE (1)
 11336               SUBTRACT PB-I-LF-PREMIUM-AMT FROM
 11337                                        WS-B-LF-ISS-PRM-ENTERED
 11338               SUBTRACT PB-I-LF-ALT-PREMIUM-AMT FROM
 11339                                        WS-B-LF-ISS-PRM-ENTERED
 11340               SUBTRACT PB-I-LF-PREM-CALC FROM
 11341                                        WS-B-LF-ISS-PRM-COMPUTED
 11342               MOVE ZEROS            TO PB-I-LF-TERM
 11343                                        PB-I-LF-BENEFIT-AMT
 11344                                        PB-I-LF-PREMIUM-AMT
 11345                                        PB-I-LF-BENEFIT-CD
 11346                                        PB-I-LF-PREM-CALC
 11347                                        PB-I-LF-CRIT-PER
 11348                                        PB-I-LF-ALT-BENEFIT-AMT
 11349                                        PB-I-LF-ALT-PREMIUM-AMT
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 211
* EL6311.cbl
 11350               MOVE LOW-VALUES       TO PB-I-LF-EXPIRE-DT
 11351           ELSE
 11352               NEXT SENTENCE
 11353        ELSE
 11354           MOVE BTYPE (1)        TO PB-I-LF-INPUT-CD
 11355                                    PI-BTYPE (1).
 11356     IF BTYPE-LEN (2)   GREATER THAN ZEROS
 11357        IF BTYPE  (2)   = ZEROS OR SPACES
 11358           IF  REMOVE-AH-COVERAGE
 11359               MOVE SPACES           TO PB-I-AH-INPUT-CD
 11360                                        PI-BTYPE (2)
 11361               SUBTRACT PB-I-AH-PREMIUM-AMT FROM
 11362                                        WS-B-AH-ISS-PRM-ENTERED
 11363               SUBTRACT PB-I-AH-PREM-CALC FROM
 11364                                        WS-B-AH-ISS-PRM-COMPUTED
 11365               MOVE ZEROS            TO PB-I-AH-TERM
 11366                                        PB-I-AH-BENEFIT-AMT
 11367                                        PB-I-AH-PREMIUM-AMT
 11368                                        PB-I-AH-BENEFIT-CD
 11369                                        PB-I-AH-PREM-CALC
 11370                                        PB-I-AH-CRIT-PER
 11371               MOVE LOW-VALUES       TO PB-I-AH-EXPIRE-DT
 11372           ELSE
 11373               NEXT SENTENCE
 11374        ELSE
 11375           MOVE BTYPE (2)        TO PB-I-AH-INPUT-CD
 11376                                    PI-BTYPE (2).
 11377 1360-REWRITE-PB-RECORD.
 11378     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 11379
 11380     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 11381     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT.
 11382
 11383     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 11384
 11385     SUBTRACT PB-I-LF-PREM-CALC  FROM WS-B-LF-ISS-PRM-COMPUTED.
 11386     SUBTRACT PB-I-AH-PREM-CALC  FROM WS-B-AH-ISS-PRM-COMPUTED.
 11387
 11388     IF BCPREM-LEN (1)  GREATER THAN ZEROS
 11389         MOVE WS-BCPREM (1)      TO PB-I-LF-PREM-CALC.
 11390
 11391     IF BCPREM-LEN (2)  GREATER THAN ZEROS
 11392         MOVE WS-BCPREM (2)      TO PB-I-AH-PREM-CALC.
 11393
 11394     PERFORM 1390-UPDATE-ERPNDM THRU 1399-EXIT.
 11395
 11396     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 11397
 11398     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 11399
 11400     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 11401     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 11402     MOVE PB-SV-STATE            TO PI-SV-STATE.
 11403
 11404     ADD  PB-I-LF-PREM-CALC      TO WS-B-LF-ISS-PRM-COMPUTED.
 11405     ADD  PB-I-AH-PREM-CALC      TO WS-B-AH-ISS-PRM-COMPUTED.
 11406
 11407 1375-REWRITE-PB-RECORD.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 212
* EL6311.cbl
 11408     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 11409     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 11410     MOVE 'C'                    TO JP-RECORD-TYPE.
 11411     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11412
 11413
 11414* EXEC CICS REWRITE
 11415*        DATASET (FILE-ID-ERPNDB)
 11416*        FROM    (PENDING-BUSINESS)
 11417*    END-EXEC.
 11418     MOVE LENGTH OF
 11419      PENDING-BUSINESS
 11420       TO DFHEIV11
 11421*    MOVE '&& L                  %   #00011010' TO DFHEIV0
 11422     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11423     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11424     MOVE X'2020233030303131303130' TO DFHEIV0(25:11)
 11425     CALL 'kxdfhei1' USING DFHEIV0,
 11426           FILE-ID-ERPNDB,
 11427           PENDING-BUSINESS,
 11428           DFHEIV11,
 11429           DFHEIV99
 11430     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11431
 11432
 11433     PERFORM 8400-LOG-JOURNAL-RECORD.
 11434******************************************************************
 11435*       U P D A T E   T H E   O R I G   C E R T   I N F O        *
 11436******************************************************************
 11437     display ' made it to update orig cert '
 11438     MOVE ELCERT-KEY             TO ERMAIL-KEY
 11439     MOVE ' '                    TO WS-ERMAIL-SW
 11440
 11441* EXEC CICS READ
 11442*       DATASET   (FILE-ID-ERMAIL)
 11443*       SET       (ADDRESS OF MAILING-DATA)
 11444*       RIDFLD    (ERMAIL-KEY)
 11445*       RESP      (WS-RESPONSE)
 11446*    END-EXEC
 11447*    MOVE '&"S        E          (  N#00011022' TO DFHEIV0
 11448     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11449     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11450     MOVE X'204E233030303131303232' TO DFHEIV0(25:11)
 11451     CALL 'kxdfhei1' USING DFHEIV0,
 11452           FILE-ID-ERMAIL,
 11453           DFHEIV20,
 11454           DFHEIV99,
 11455           ERMAIL-KEY,
 11456           DFHEIV99,
 11457           DFHEIV99,
 11458           DFHEIV99
 11459     SET ADDRESS OF MAILING-DATA TO
 11460         DFHEIV20
 11461     MOVE EIBRESP  TO WS-RESPONSE
 11462     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11463     IF RESP-NORMAL
 11464        SET ERMAIL-FOUND TO TRUE
 11465     END-IF
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 213
* EL6311.cbl
 11466
 11467     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 11468     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 11469                                 TO ELCRTO-KEY
 11470     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 11471     MOVE +0                     TO ELCRTO-SEQ-NO
 11472
 11473* EXEC CICS READ
 11474*       DATASET   ('ELCRTO')
 11475*       INTO      (ORIGINAL-CERTIFICATE)
 11476*       RIDFLD    (ELCRTO-KEY)
 11477*       GTEQ
 11478*       RESP      (WS-RESPONSE)
 11479*    END-EXEC
 11480     MOVE LENGTH OF
 11481      ORIGINAL-CERTIFICATE
 11482       TO DFHEIV11
 11483     MOVE 'ELCRTO' TO DFHEIV1
 11484*    MOVE '&"IL       G          (  N#00011037' TO DFHEIV0
 11485     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 11486     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11487     MOVE X'204E233030303131303337' TO DFHEIV0(25:11)
 11488     CALL 'kxdfhei1' USING DFHEIV0,
 11489           DFHEIV1,
 11490           ORIGINAL-CERTIFICATE,
 11491           DFHEIV11,
 11492           ELCRTO-KEY,
 11493           DFHEIV99,
 11494           DFHEIV99,
 11495           DFHEIV99
 11496     MOVE EIBRESP  TO WS-RESPONSE
 11497     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11498     display ' just read gteq ' ws-response
 11499     IF RESP-NORMAL
 11500        AND (OC-CONTROL-PRIMARY (1:33) =
 11501                 PB-CONTROL-BY-ACCOUNT (1:33))
 11502        AND (OC-RECORD-TYPE = 'I')
 11503        display ' resp norm, key =, type i '
 11504        IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 11505           display ' end proc blank '
 11506           display ' csr edit session ' PI-CSR-SESSION-SW
 11507           IF NOT CSR-EDIT-SESSION
 11508
 11509* EXEC CICS READ
 11510*                DATASET   ('ELCRTO')
 11511*                INTO      (ORIGINAL-CERTIFICATE)
 11512*                RIDFLD    (OC-CONTROL-PRIMARY)
 11513*                UPDATE
 11514*                RESP      (WS-RESPONSE)
 11515*             END-EXEC
 11516     MOVE LENGTH OF
 11517      ORIGINAL-CERTIFICATE
 11518       TO DFHEIV11
 11519     MOVE 'ELCRTO' TO DFHEIV1
 11520*    MOVE '&"IL       EU         (  N#00011054' TO DFHEIV0
 11521     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11522     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11523     MOVE X'204E233030303131303534' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 214
* EL6311.cbl
 11524     CALL 'kxdfhei1' USING DFHEIV0,
 11525           DFHEIV1,
 11526           ORIGINAL-CERTIFICATE,
 11527           DFHEIV11,
 11528           OC-CONTROL-PRIMARY,
 11529           DFHEIV99,
 11530           DFHEIV99,
 11531           DFHEIV99
 11532     MOVE EIBRESP  TO WS-RESPONSE
 11533     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11534              DISPLAY ' JUST DID READ UPD ' WS-RESPONSE
 11535              IF RESP-NORMAL
 11536                 display ' good read upd '
 11537                 MOVE PB-I-INSURED-LAST-NAME TO
 11538                         OC-INS-LAST-NAME
 11539                 MOVE PB-I-INSURED-FIRST-NAME TO
 11540                         OC-INS-FIRST-NAME
 11541                 MOVE PB-I-INSURED-MIDDLE-INIT TO
 11542                         OC-INS-MIDDLE-INIT
 11543                 MOVE PB-I-AGE         TO OC-INS-AGE
 11544                 MOVE PB-I-JOINT-LAST-NAME   TO
 11545                         OC-JNT-LAST-NAME
 11546                 MOVE PB-I-JOINT-FIRST-NAME  TO
 11547                         OC-JNT-FIRST-NAME
 11548                 MOVE PB-I-JOINT-MIDDLE-INIT TO
 11549                         OC-JNT-MIDDLE-INIT
 11550                 MOVE PB-I-JOINT-AGE   TO OC-JNT-AGE
 11551                 MOVE PB-I-LF-BENEFIT-CD TO OC-LF-BENCD
 11552                 MOVE PB-I-LF-TERM     TO OC-LF-TERM
 11553                 MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
 11554                 MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
 11555                 MOVE PB-I-LF-ALT-BENEFIT-AMT TO
 11556                         OC-LF-ALT-BEN-AMT
 11557                 MOVE PB-I-LF-ALT-PREMIUM-AMT TO
 11558                         OC-LF-ALT-PRM-AMT
 11559                 MOVE PB-I-LF-EXPIRE-DT TO OC-LF-EXP-DT
 11560                 MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
 11561                 MOVE PB-I-AH-BENEFIT-CD TO OC-AH-BENCD
 11562                 MOVE PB-I-AH-TERM     TO OC-AH-TERM
 11563                 MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
 11564                 MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
 11565                 MOVE PB-I-AH-EXPIRE-DT TO OC-AH-EXP-DT
 11566                 MOVE PB-I-AH-COMMISSION TO OC-AH-COMM-PCT
 11567                 MOVE PB-I-AH-CRIT-PER TO OC-AH-CP
 11568                 MOVE PB-I-1ST-PMT-DT  TO OC-1ST-PMT-DT
 11569                 IF OC-CANCEL-TRAN-IND = 'N'
 11570                    MOVE LOW-VALUES    TO OC-LF-CANCEL-DT
 11571                    MOVE +0            TO OC-LF-CANCEL-AMT
 11572                                          OC-LF-ITD-CANCEL-AMT
 11573                    MOVE LOW-VALUES    TO OC-AH-CANCEL-DT
 11574                    MOVE +0            TO OC-AH-CANCEL-AMT
 11575                                          OC-AH-ITD-CANCEL-AMT
 11576                 END-IF
 11577                 MOVE 'Y'              TO OC-ISSUE-TRAN-IND
 11578                 MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 11579                 MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 11580                 MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 11581                 IF ERMAIL-FOUND
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 215
* EL6311.cbl
 11582                    MOVE MA-CRED-BENE-NAME
 11583                                 TO OC-CRED-BENE-NAME
 11584                 END-IF
 11585                 IF NOT CERT-TRL-REC-NOT-FOUND
 11586                    MOVE CS-INS-AGE-DEFAULT-FLAG TO
 11587                           OC-INS-AGE-DEFAULT-FLAG
 11588                    MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 11589                           OC-JNT-AGE-DEFAULT-FLAG
 11590                 END-IF
 11591
 11592* EXEC CICS REWRITE
 11593*                   DATASET   ('ELCRTO')
 11594*                   FROM      (ORIGINAL-CERTIFICATE)
 11595*                   RESP      (WS-RESPONSE)
 11596*                END-EXEC
 11597     MOVE LENGTH OF
 11598      ORIGINAL-CERTIFICATE
 11599       TO DFHEIV11
 11600     MOVE 'ELCRTO' TO DFHEIV1
 11601*    MOVE '&& L                  %  N#00011118' TO DFHEIV0
 11602     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11603     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11604     MOVE X'204E233030303131313138' TO DFHEIV0(25:11)
 11605     CALL 'kxdfhei1' USING DFHEIV0,
 11606           DFHEIV1,
 11607           ORIGINAL-CERTIFICATE,
 11608           DFHEIV11,
 11609           DFHEIV99
 11610     MOVE EIBRESP  TO WS-RESPONSE
 11611     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11612                 display ' just rewrote ' ws-response
 11613              END-IF
 11614           END-IF
 11615        ELSE
 11616           SUBTRACT +1 FROM OC-KEY-SEQ-NO
 11617           MOVE 'OC'             TO OC-RECORD-ID
 11618           MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 11619           MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 11620           MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 11621           MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 11622           MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 11623           MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 11624           MOVE PB-I-AGE         TO OC-INS-AGE
 11625           MOVE PB-I-JOINT-LAST-NAME TO OC-JNT-LAST-NAME
 11626           MOVE PB-I-JOINT-FIRST-NAME TO OC-JNT-FIRST-NAME
 11627           MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 11628           MOVE PB-I-JOINT-AGE   TO OC-JNT-AGE
 11629           MOVE PB-I-LF-BENEFIT-CD TO OC-LF-BENCD
 11630           MOVE PB-I-LF-TERM     TO OC-LF-TERM
 11631           MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
 11632           MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
 11633           MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 11634           MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 11635           MOVE PB-I-LF-EXPIRE-DT TO OC-LF-EXP-DT
 11636           MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
 11637           MOVE LOW-VALUES       TO OC-LF-CANCEL-DT
 11638           MOVE +0               TO OC-LF-CANCEL-AMT
 11639                                    OC-LF-ITD-CANCEL-AMT
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 216
* EL6311.cbl
 11640           MOVE PB-I-AH-BENEFIT-CD TO OC-AH-BENCD
 11641           MOVE PB-I-AH-TERM     TO OC-AH-TERM
 11642           MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
 11643           MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
 11644           MOVE PB-I-AH-EXPIRE-DT TO OC-AH-EXP-DT
 11645           MOVE PB-I-AH-COMMISSION TO OC-AH-COMM-PCT
 11646           MOVE PB-I-AH-CRIT-PER TO OC-AH-CP
 11647           MOVE LOW-VALUES       TO OC-AH-CANCEL-DT
 11648           MOVE +0               TO OC-AH-CANCEL-AMT
 11649                                    OC-AH-ITD-CANCEL-AMT
 11650           MOVE PB-I-1ST-PMT-DT  TO OC-1ST-PMT-DT
 11651           MOVE 'Y'              TO OC-ISSUE-TRAN-IND
 11652           MOVE 'N'              TO OC-CANCEL-TRAN-IND
 11653           IF ERMAIL-FOUND
 11654              MOVE MA-CRED-BENE-NAME
 11655                                 TO OC-CRED-BENE-NAME
 11656           END-IF
 11657           IF NOT CERT-TRL-REC-NOT-FOUND
 11658              MOVE CS-INS-AGE-DEFAULT-FLAG TO
 11659                           OC-INS-AGE-DEFAULT-FLAG
 11660              MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 11661                           OC-JNT-AGE-DEFAULT-FLAG
 11662           END-IF
 11663           MOVE LOW-VALUES       TO OC-ENDORSEMENT-PROCESSED-DT
 11664
 11665* EXEC CICS WRITE
 11666*             DATASET   ('ELCRTO')
 11667*             FROM      (ORIGINAL-CERTIFICATE)
 11668*             RIDFLD    (OC-CONTROL-PRIMARY)
 11669*             RESP      (WS-RESPONSE)
 11670*          END-EXEC
 11671     MOVE LENGTH OF
 11672      ORIGINAL-CERTIFICATE
 11673       TO DFHEIV11
 11674     MOVE 'ELCRTO' TO DFHEIV1
 11675*    MOVE '&$ L                  ''  N#00011175' TO DFHEIV0
 11676     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11677     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11678     MOVE X'204E233030303131313735' TO DFHEIV0(25:11)
 11679     CALL 'kxdfhei1' USING DFHEIV0,
 11680           DFHEIV1,
 11681           ORIGINAL-CERTIFICATE,
 11682           DFHEIV11,
 11683           OC-CONTROL-PRIMARY,
 11684           DFHEIV99,
 11685           DFHEIV99
 11686     MOVE EIBRESP  TO WS-RESPONSE
 11687     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11688        END-IF
 11689     ELSE
 11690        MOVE SPACES              TO ORIGINAL-CERTIFICATE
 11691        MOVE 'OC'                TO OC-RECORD-ID
 11692        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 11693                                 TO OC-CONTROL-PRIMARY (1:33)
 11694        MOVE 'I'                 TO OC-RECORD-TYPE
 11695        MOVE +4096               TO OC-KEY-SEQ-NO
 11696        MOVE PI-PROCESSOR-ID     TO OC-LAST-MAINT-BY
 11697        MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 217
* EL6311.cbl
 11698        MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 11699        MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 11700        MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 11701        MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 11702        MOVE PB-I-AGE            TO OC-INS-AGE
 11703        MOVE PB-I-JOINT-LAST-NAME TO OC-JNT-LAST-NAME
 11704        MOVE PB-I-JOINT-FIRST-NAME TO OC-JNT-FIRST-NAME
 11705        MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 11706        MOVE PB-I-JOINT-AGE      TO OC-JNT-AGE
 11707        MOVE PB-I-LF-BENEFIT-CD  TO OC-LF-BENCD
 11708        MOVE PB-I-LF-TERM        TO OC-LF-TERM
 11709        MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
 11710        MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
 11711        MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 11712        MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 11713        MOVE PB-I-LF-EXPIRE-DT   TO OC-LF-EXP-DT
 11714        MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
 11715        MOVE LOW-VALUES          TO OC-LF-CANCEL-DT
 11716        MOVE +0                  TO OC-LF-CANCEL-AMT
 11717                                    OC-LF-ITD-CANCEL-AMT
 11718        MOVE PB-I-AH-BENEFIT-CD  TO OC-AH-BENCD
 11719        MOVE PB-I-AH-TERM        TO OC-AH-TERM
 11720        MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
 11721        MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
 11722        MOVE PB-I-AH-EXPIRE-DT   TO OC-AH-EXP-DT
 11723        MOVE PB-I-AH-COMMISSION  TO OC-AH-COMM-PCT
 11724        MOVE PB-I-AH-CRIT-PER    TO OC-AH-CP
 11725        MOVE LOW-VALUES          TO OC-AH-CANCEL-DT
 11726        MOVE +0                  TO OC-AH-CANCEL-AMT
 11727                                    OC-AH-ITD-CANCEL-AMT
 11728        MOVE PB-I-1ST-PMT-DT     TO OC-1ST-PMT-DT
 11729        MOVE 'Y'                 TO OC-ISSUE-TRAN-IND
 11730        MOVE 'N'                 TO OC-CANCEL-TRAN-IND
 11731        IF ERMAIL-FOUND
 11732           MOVE MA-CRED-BENE-NAME
 11733                                 TO OC-CRED-BENE-NAME
 11734        END-IF
 11735        IF NOT CERT-TRL-REC-NOT-FOUND
 11736           MOVE CS-INS-AGE-DEFAULT-FLAG TO
 11737                           OC-INS-AGE-DEFAULT-FLAG
 11738           MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 11739                           OC-JNT-AGE-DEFAULT-FLAG
 11740        END-IF
 11741        MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 11742
 11743* EXEC CICS WRITE
 11744*          DATASET   ('ELCRTO')
 11745*          FROM      (ORIGINAL-CERTIFICATE)
 11746*          RIDFLD    (OC-CONTROL-PRIMARY)
 11747*          RESP      (WS-RESPONSE)
 11748*       END-EXEC
 11749     MOVE LENGTH OF
 11750      ORIGINAL-CERTIFICATE
 11751       TO DFHEIV11
 11752     MOVE 'ELCRTO' TO DFHEIV1
 11753*    MOVE '&$ L                  ''  N#00011235' TO DFHEIV0
 11754     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11755     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 218
* EL6311.cbl
 11756     MOVE X'204E233030303131323335' TO DFHEIV0(25:11)
 11757     CALL 'kxdfhei1' USING DFHEIV0,
 11758           DFHEIV1,
 11759           ORIGINAL-CERTIFICATE,
 11760           DFHEIV11,
 11761           OC-CONTROL-PRIMARY,
 11762           DFHEIV99,
 11763           DFHEIV99
 11764     MOVE EIBRESP  TO WS-RESPONSE
 11765     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11766     END-IF
 11767******************************************************************
 11768*       U P D A T E   T H E   B A T C H   H E A D E R            *
 11769******************************************************************
 11770
 11771     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 11772     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 11773
 11774
 11775* EXEC CICS READ
 11776*        INTO    (PENDING-BUSINESS)
 11777*        DATASET (FILE-ID-ERPNDB)
 11778*        RIDFLD  (ERPNDB-KEY)
 11779*        UPDATE
 11780*    END-EXEC.
 11781     MOVE LENGTH OF
 11782      PENDING-BUSINESS
 11783       TO DFHEIV11
 11784*    MOVE '&"IL       EU         (   #00011249' TO DFHEIV0
 11785     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11786     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11787     MOVE X'2020233030303131323439' TO DFHEIV0(25:11)
 11788     CALL 'kxdfhei1' USING DFHEIV0,
 11789           FILE-ID-ERPNDB,
 11790           PENDING-BUSINESS,
 11791           DFHEIV11,
 11792           ERPNDB-KEY,
 11793           DFHEIV99,
 11794           DFHEIV99,
 11795           DFHEIV99
 11796     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11797
 11798
 11799     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 11800     MOVE 'B'                    TO JP-RECORD-TYPE.
 11801     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11802
 11803     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 11804
 11805     PERFORM 8400-LOG-JOURNAL-RECORD.
 11806
 11807     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD
 11808
 11809     MOVE 'C'                    TO JP-RECORD-TYPE.
 11810     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11811
 11812
 11813* EXEC CICS REWRITE
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 219
* EL6311.cbl
 11814*        DATASET    (FILE-ID-ERPNDB)
 11815*        FROM       (PENDING-BUSINESS)
 11816*    END-EXEC.
 11817     MOVE LENGTH OF
 11818      PENDING-BUSINESS
 11819       TO DFHEIV11
 11820*    MOVE '&& L                  %   #00011269' TO DFHEIV0
 11821     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11822     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11823     MOVE X'2020233030303131323639' TO DFHEIV0(25:11)
 11824     CALL 'kxdfhei1' USING DFHEIV0,
 11825           FILE-ID-ERPNDB,
 11826           PENDING-BUSINESS,
 11827           DFHEIV11,
 11828           DFHEIV99
 11829     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11830
 11831
 11832     PERFORM 8400-LOG-JOURNAL-RECORD.
 11833
 11834     IF WS-ERRORS-PRESENT
 11835        GO TO 3900-RE-DISPLAY-RECORD.
 11836
 11837     MOVE ZEROS                  TO EMI-ERROR.
 11838     MOVE -1                     TO BMAINTL.
 11839     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11840     GO TO 3900-RE-DISPLAY-RECORD.
 11841
 11842 1380-BATCH-HDR-NOT-FOUND.
 11843     MOVE -1                     TO BMAINTL.
 11844     MOVE ER-7450                TO EMI-ERROR.
 11845     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11846     GO TO 8200-SEND-DATAONLY.
 11847
 11848 1385-REC-NOT-FOUND.
 11849     MOVE -1                     TO BMAINTL.
 11850     MOVE ER-7451                TO EMI-ERROR.
 11851     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11852     GO TO 8200-SEND-DATAONLY.
 11853
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 220
* EL6311.cbl
 11855
 11856 1386-UPDATE-AGE-FLAGS.
 11857
 11858
 11859* EXEC CICS GETMAIN
 11860*        SET     (ADDRESS OF CERTIFICATE-TRAILERS)
 11861*        LENGTH  (ELCRTT-RECORD-LENGTH)
 11862*        INITIMG (GETMAIN-SPACE)
 11863*    END-EXEC
 11864*    MOVE ',"IL                  $   #00011300' TO DFHEIV0
 11865     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11866     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11867     MOVE X'2020233030303131333030' TO DFHEIV0(25:11)
 11868     CALL 'kxdfhei1' USING DFHEIV0,
 11869           DFHEIV20,
 11870           ELCRTT-RECORD-LENGTH,
 11871           GETMAIN-SPACE
 11872     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 11873         DFHEIV20
 11874     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11875
 11876
 11877* EXEC CICS HANDLE CONDITION
 11878*        NOTFND   (1386-NOTFND)
 11879*    END-EXEC.
 11880*    MOVE '"$I                   ! ( #00011306' TO DFHEIV0
 11881     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11882     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11883     MOVE X'2820233030303131333036' TO DFHEIV0(25:11)
 11884     CALL 'kxdfhei1' USING DFHEIV0
 11885     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11886
 11887
 11888     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTT-PRIMARY
 11889     MOVE 'C'                TO ELCRTT-REC-TYPE
 11890
 11891
 11892* EXEC CICS READ
 11893*        UPDATE
 11894*        DATASET  (CRTT-ID)
 11895*        RIDFLD   (ELCRTT-KEY)
 11896*        INTO     (CERTIFICATE-TRAILERS)
 11897*    END-EXEC.
 11898     MOVE LENGTH OF
 11899      CERTIFICATE-TRAILERS
 11900       TO DFHEIV11
 11901*    MOVE '&"IL       EU         (   #00011313' TO DFHEIV0
 11902     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11903     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11904     MOVE X'2020233030303131333133' TO DFHEIV0(25:11)
 11905     CALL 'kxdfhei1' USING DFHEIV0,
 11906           CRTT-ID,
 11907           CERTIFICATE-TRAILERS,
 11908           DFHEIV11,
 11909           ELCRTT-KEY,
 11910           DFHEIV99,
 11911           DFHEIV99,
 11912           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 221
* EL6311.cbl
 11913     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11914
 11915
 11916     IF WS-INS-AGE-SET = 'Y'
 11917        MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG
 11918     END-IF
 11919     IF WS-JNT-AGE-SET = 'Y'
 11920        MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG
 11921     END-IF
 11922
 11923
 11924* EXEC CICS REWRITE
 11925*       DATASET  (CRTT-ID)
 11926*       FROM     (CERTIFICATE-TRAILERS)
 11927*    END-EXEC.
 11928     MOVE LENGTH OF
 11929      CERTIFICATE-TRAILERS
 11930       TO DFHEIV11
 11931*    MOVE '&& L                  %   #00011327' TO DFHEIV0
 11932     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11933     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11934     MOVE X'2020233030303131333237' TO DFHEIV0(25:11)
 11935     CALL 'kxdfhei1' USING DFHEIV0,
 11936           CRTT-ID,
 11937           CERTIFICATE-TRAILERS,
 11938           DFHEIV11,
 11939           DFHEIV99
 11940     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11941
 11942
 11943     GO TO 1386-EXIT.
 11944
 11945 1386-NOTFND.
 11946
 11947     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 11948     MOVE 'CS'         TO CS-RECORD-ID.
 11949     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTT-PRIMARY.
 11950     MOVE 'C'          TO ELCRTT-REC-TYPE.
 11951     MOVE ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 11952     MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG.
 11953     MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG.
 11954
 11955* EXEC CICS WRITE
 11956*       DATASET  (CRTT-ID)
 11957*       RIDFLD   (ELCRTT-KEY)
 11958*       FROM     (CERTIFICATE-TRAILERS)
 11959*    END-EXEC.
 11960     MOVE LENGTH OF
 11961      CERTIFICATE-TRAILERS
 11962       TO DFHEIV11
 11963*    MOVE '&$ L                  ''   #00011343' TO DFHEIV0
 11964     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11965     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11966     MOVE X'2020233030303131333433' TO DFHEIV0(25:11)
 11967     CALL 'kxdfhei1' USING DFHEIV0,
 11968           CRTT-ID,
 11969           CERTIFICATE-TRAILERS,
 11970           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 222
* EL6311.cbl
 11971           ELCRTT-KEY,
 11972           DFHEIV99,
 11973           DFHEIV99
 11974     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11975
 11976
 11977 1386-EXIT.
 11978     EXIT.
 11979
 11980 1390-UPDATE-ERPNDM.
 11981
 11982
 11983* EXEC CICS HANDLE CONDITION
 11984*        NOTFND (1399-EXIT)
 11985*    END-EXEC.
 11986*    MOVE '"$I                   ! ) #00011354' TO DFHEIV0
 11987     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11988     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11989     MOVE X'2920233030303131333534' TO DFHEIV0(25:11)
 11990     CALL 'kxdfhei1' USING DFHEIV0
 11991     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11992
 11993
 11994     MOVE PB-CONTROL-PRIMARY     TO  ERPNDM-KEY.
 11995
 11996
 11997* EXEC CICS READ
 11998*        SET     (ADDRESS OF PENDING-MAILING-DATA)
 11999*        DATASET (FILE-ID-ERPNDM)
 12000*        RIDFLD  (ERPNDM-KEY)
 12001*        UPDATE
 12002*    END-EXEC.
 12003*    MOVE '&"S        EU         (   #00011360' TO DFHEIV0
 12004     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12005     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12006     MOVE X'2020233030303131333630' TO DFHEIV0(25:11)
 12007     CALL 'kxdfhei1' USING DFHEIV0,
 12008           FILE-ID-ERPNDM,
 12009           DFHEIV20,
 12010           DFHEIV99,
 12011           ERPNDM-KEY,
 12012           DFHEIV99,
 12013           DFHEIV99,
 12014           DFHEIV99
 12015     SET ADDRESS OF PENDING-MAILING-DATA TO
 12016         DFHEIV20
 12017     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12018
 12019
 12020     MOVE PI-PROCESSOR-ID        TO PM-LAST-MAINT-BY.
 12021     MOVE EIBTIME                TO PM-LAST-MAINT-HHMMSS.
 12022     MOVE WS-CURRENT-BIN-DT      TO PM-LAST-MAINT-DT.
 12023
 12024     IF BLSTNML GREATER THAN ZEROS
 12025         MOVE BLSTNMI            TO PM-INSURED-LAST-NAME.
 12026
 12027     IF B1STNML GREATER  THAN ZEROS
 12028         MOVE B1STNMI            TO PM-INSURED-FIRST-NAME.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 223
* EL6311.cbl
 12029
 12030     IF BINITL GREATER THAN ZEROS
 12031         MOVE BINITI             TO PM-INSURED-MIDDLE-INIT.
 12032
 12033     IF BAGEL GREATER THAN ZEROS
 12034         MOVE WS-BAGE            TO PM-INSURED-ISSUE-AGE.
 12035
 12036     IF BBIRTHL GREATER THAN ZEROS
 12037         MOVE  WS-CONVERTED-BIRTH TO PM-INSURED-BIRTH-DT.
 12038
 12039     IF BSEXL GREATER THAN ZEROS
 12040         MOVE  BSEXI             TO PM-INSURED-SEX.
 12041
 12042
 12043* EXEC CICS REWRITE
 12044*        DATASET (FILE-ID-ERPNDM)
 12045*        FROM    (PENDING-MAILING-DATA)
 12046*    END-EXEC.
 12047     MOVE LENGTH OF
 12048      PENDING-MAILING-DATA
 12049       TO DFHEIV11
 12050*    MOVE '&& L                  %   #00011389' TO DFHEIV0
 12051     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12052     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12053     MOVE X'2020233030303131333839' TO DFHEIV0(25:11)
 12054     CALL 'kxdfhei1' USING DFHEIV0,
 12055           FILE-ID-ERPNDM,
 12056           PENDING-MAILING-DATA,
 12057           DFHEIV11,
 12058           DFHEIV99
 12059     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12060
 12061
 12062 1399-EXIT.
 12063     EXIT.
 12064
 12065******************************************************************
 12066*                                                                *
 12067*          D E L E T E   I S S U E   R O U T I N E               *
 12068*                                                                *
 12069******************************************************************
 12070
 12071 1400-DELETE-ISSUE-ROUTINE.
 12072     MOVE 'D'                    TO PI-MAINT-FUNCTION.
 12073
 12074     IF BCHGL NOT = ZEROS
 12075        MOVE ER-2196             TO EMI-ERROR
 12076        MOVE AL-UABON            TO BMAINTA
 12077        MOVE -1                  TO BMAINTL
 12078        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12079        GO TO 8200-SEND-DATAONLY.
 12080
 12081
 12082* EXEC CICS HANDLE CONDITION
 12083*         NOTFND    (1480-BATCH-HDR-NOT-FOUND)
 12084*    END-EXEC.
 12085*    MOVE '"$I                   ! * #00011413' TO DFHEIV0
 12086     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 224
* EL6311.cbl
 12087     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12088     MOVE X'2A20233030303131343133' TO DFHEIV0(25:11)
 12089     CALL 'kxdfhei1' USING DFHEIV0
 12090     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12091
 12092
 12093     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 12094     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 12095     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 12096
 12097
 12098* EXEC CICS READ
 12099*        SET     (ADDRESS OF PENDING-BUSINESS)
 12100*        DATASET (FILE-ID-ERPNDB)
 12101*        RIDFLD  (ERPNDB-KEY)
 12102*    END-EXEC.
 12103*    MOVE '&"S        E          (   #00011421' TO DFHEIV0
 12104     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12105     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12106     MOVE X'2020233030303131343231' TO DFHEIV0(25:11)
 12107     CALL 'kxdfhei1' USING DFHEIV0,
 12108           FILE-ID-ERPNDB,
 12109           DFHEIV20,
 12110           DFHEIV99,
 12111           ERPNDB-KEY,
 12112           DFHEIV99,
 12113           DFHEIV99,
 12114           DFHEIV99
 12115     SET ADDRESS OF PENDING-BUSINESS TO
 12116         DFHEIV20
 12117     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12118
 12119
 12120     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 12121
 12122     MOVE BCERTNOI               TO WS-NEW-PRIME.
 12123
 12124     IF BSUFIXL NOT = ZEROS
 12125        MOVE BSUFIXI             TO WS-NEW-SUFFIX
 12126     ELSE
 12127        MOVE SPACE               TO WS-NEW-SUFFIX.
 12128
 12129     MOVE BEFFDTI                TO DEEDIT-FIELD.
 12130     PERFORM 8600-DEEDIT.
 12131     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 12132     MOVE '4'                    TO DC-OPTION-CODE.
 12133     PERFORM 9700-DATE-LINK.
 12134     IF DATE-CONVERSION-ERROR
 12135        MOVE ER-0348             TO EMI-ERROR
 12136        MOVE -1                  TO BEFFDTL
 12137        MOVE AL-UABON            TO BEFFDTA
 12138        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12139        GO TO 8200-SEND-DATAONLY
 12140     ELSE
 12141        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
 12142        MOVE AL-UANON            TO BEFFDTA
 12143        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 12144
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 225
* EL6311.cbl
 12145
 12146* EXEC CICS HANDLE CONDITION
 12147*         NOTFND    (1490-RECORD-NOT-FOUND)
 12148*    END-EXEC.
 12149*    MOVE '"$I                   ! + #00011452' TO DFHEIV0
 12150     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12151     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12152     MOVE X'2B20233030303131343532' TO DFHEIV0(25:11)
 12153     CALL 'kxdfhei1' USING DFHEIV0
 12154     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12155
 12156
 12157
 12158* EXEC CICS READ
 12159*        SET     (ADDRESS OF PENDING-BUSINESS)
 12160*        DATASET (FILE-ID-ERPNDB)
 12161*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 12162*        UPDATE
 12163*    END-EXEC.
 12164*    MOVE '&"S        EU         (   #00011456' TO DFHEIV0
 12165     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12166     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12167     MOVE X'2020233030303131343536' TO DFHEIV0(25:11)
 12168     CALL 'kxdfhei1' USING DFHEIV0,
 12169           FILE-ID-ERPNDB,
 12170           DFHEIV20,
 12171           DFHEIV99,
 12172           PI-PREV-CONTROL-PRIMARY,
 12173           DFHEIV99,
 12174           DFHEIV99,
 12175           DFHEIV99
 12176     SET ADDRESS OF PENDING-BUSINESS TO
 12177         DFHEIV20
 12178     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12179
 12180
 12181     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 12182        MOVE -1                 TO BMAINTL
 12183        MOVE ER-2197            TO EMI-ERROR
 12184        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12185        GO TO 8200-SEND-DATAONLY.
 12186
 12187     IF PB-BILLED-DT NOT = LOW-VALUES
 12188        MOVE -1                 TO BMAINTL
 12189        MOVE ER-2129            TO EMI-ERROR
 12190        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12191        GO TO 8200-SEND-DATAONLY.
 12192
 12193     IF PB-CHG-COUNT NOT = ZEROS
 12194        MOVE ER-2336            TO EMI-ERROR
 12195        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12196        MOVE AL-UABON            TO BMAINTA
 12197        MOVE -1                  TO BMAINTL
 12198        GO TO 8200-SEND-DATAONLY.
 12199
 12200     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 12201        PB-CHG-COUNT NOT = ZEROS
 12202        MOVE ER-2196             TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 226
* EL6311.cbl
 12203        MOVE AL-UABON            TO BMAINTA
 12204        MOVE -1                  TO BMAINTL
 12205        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12206        GO TO 8200-SEND-DATAONLY.
 12207******************************************************************
 12208*                                                                *
 12209*       DELETE ORIGINAL CERTIFICATE INFO                         *
 12210*                                                                *
 12211******************************************************************
 12212     MOVE PI-PREV-ALT-KEY (1:33) TO ELCRTO-KEY (1:33)
 12213     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 12214     MOVE +0                     TO ELCRTO-SEQ-NO
 12215
 12216* EXEC CICS READ
 12217*       DATASET   ('ELCRTO')
 12218*       INTO      (ORIGINAL-CERTIFICATE)
 12219*       RIDFLD    (ELCRTO-KEY)
 12220*       GTEQ
 12221*       RESP      (WS-RESPONSE)
 12222*    END-EXEC
 12223     MOVE LENGTH OF
 12224      ORIGINAL-CERTIFICATE
 12225       TO DFHEIV11
 12226     MOVE 'ELCRTO' TO DFHEIV1
 12227*    MOVE '&"IL       G          (  N#00011497' TO DFHEIV0
 12228     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 12229     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12230     MOVE X'204E233030303131343937' TO DFHEIV0(25:11)
 12231     CALL 'kxdfhei1' USING DFHEIV0,
 12232           DFHEIV1,
 12233           ORIGINAL-CERTIFICATE,
 12234           DFHEIV11,
 12235           ELCRTO-KEY,
 12236           DFHEIV99,
 12237           DFHEIV99,
 12238           DFHEIV99
 12239     MOVE EIBRESP  TO WS-RESPONSE
 12240     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12241     IF RESP-NORMAL
 12242        AND (OC-CONTROL-PRIMARY (1:33) =
 12243                 PB-CONTROL-BY-ACCOUNT (1:33))
 12244        AND (OC-RECORD-TYPE = 'I')
 12245
 12246* EXEC CICS READ
 12247*          DATASET   ('ELCRTO')
 12248*          INTO      (ORIGINAL-CERTIFICATE)
 12249*          RIDFLD    (ELCRTO-KEY)
 12250*          UPDATE
 12251*          RESP      (WS-RESPONSE)
 12252*       END-EXEC
 12253     MOVE LENGTH OF
 12254      ORIGINAL-CERTIFICATE
 12255       TO DFHEIV11
 12256     MOVE 'ELCRTO' TO DFHEIV1
 12257*    MOVE '&"IL       EU         (  N#00011508' TO DFHEIV0
 12258     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12259     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12260     MOVE X'204E233030303131353038' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 227
* EL6311.cbl
 12261     CALL 'kxdfhei1' USING DFHEIV0,
 12262           DFHEIV1,
 12263           ORIGINAL-CERTIFICATE,
 12264           DFHEIV11,
 12265           ELCRTO-KEY,
 12266           DFHEIV99,
 12267           DFHEIV99,
 12268           DFHEIV99
 12269     MOVE EIBRESP  TO WS-RESPONSE
 12270     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12271        IF RESP-NORMAL
 12272
 12273* EXEC CICS DELETE
 12274*             DATASET   ('ELCRTO')
 12275*          END-EXEC
 12276     MOVE 'ELCRTO' TO DFHEIV1
 12277*    MOVE '&(                    &   #00011516' TO DFHEIV0
 12278     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12279     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12280     MOVE X'2020233030303131353136' TO DFHEIV0(25:11)
 12281     CALL 'kxdfhei1' USING DFHEIV0,
 12282           DFHEIV1,
 12283           DFHEIV99,
 12284           DFHEIV99,
 12285           DFHEIV99,
 12286           DFHEIV99
 12287     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12288        END-IF
 12289     END-IF
 12290******************************************************************
 12291*                                                                *
 12292*       DELETE PENDING MAILING ADDRESS RECORDS                   *
 12293*                                                                *
 12294******************************************************************
 12295
 12296* EXEC CICS HANDLE CONDITION
 12297*        NOTFND    (1405-DELETE-CERTIFICATE)
 12298*    END-EXEC.
 12299*    MOVE '"$I                   ! , #00011526' TO DFHEIV0
 12300     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12301     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12302     MOVE X'2C20233030303131353236' TO DFHEIV0(25:11)
 12303     CALL 'kxdfhei1' USING DFHEIV0
 12304     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12305
 12306
 12307
 12308* EXEC CICS READ
 12309*        EQUAL
 12310*        DATASET   (FILE-ID-ERPNDM)
 12311*        SET       (ADDRESS OF PENDING-MAILING-DATA)
 12312*        RIDFLD    (PI-PREV-CONTROL-PRIMARY)
 12313*        UPDATE
 12314*    END-EXEC.
 12315*    MOVE '&"S        EU         (   #00011530' TO DFHEIV0
 12316     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12317     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12318     MOVE X'2020233030303131353330' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 228
* EL6311.cbl
 12319     CALL 'kxdfhei1' USING DFHEIV0,
 12320           FILE-ID-ERPNDM,
 12321           DFHEIV20,
 12322           DFHEIV99,
 12323           PI-PREV-CONTROL-PRIMARY,
 12324           DFHEIV99,
 12325           DFHEIV99,
 12326           DFHEIV99
 12327     SET ADDRESS OF PENDING-MAILING-DATA TO
 12328         DFHEIV20
 12329     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12330
 12331
 12332     MOVE FILE-ID-ERPNDM         TO  JP-FILE-ID.
 12333     MOVE 'D'                    TO  JP-RECORD-TYPE.
 12334     MOVE PENDING-MAILING-DATA   TO  JP-RECORD-AREA.
 12335
 12336     MOVE ERPNDM-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12337
 12338
 12339* EXEC CICS DELETE
 12340*        DATASET   (FILE-ID-ERPNDM)
 12341*    END-EXEC.
 12342*    MOVE '&(                    &   #00011544' TO DFHEIV0
 12343     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12344     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12345     MOVE X'2020233030303131353434' TO DFHEIV0(25:11)
 12346     CALL 'kxdfhei1' USING DFHEIV0,
 12347           FILE-ID-ERPNDM,
 12348           DFHEIV99,
 12349           DFHEIV99,
 12350           DFHEIV99,
 12351           DFHEIV99
 12352     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12353
 12354
 12355******************************************************************
 12356*                PROCESS   CERTIFICATE                           *
 12357******************************************************************
 12358
 12359 1405-DELETE-CERTIFICATE.
 12360
 12361* EXEC CICS HANDLE CONDITION
 12362*         NOTFND  (1420-CONTINUE-DELETE)
 12363*    END-EXEC.
 12364*    MOVE '"$I                   ! - #00011553' TO DFHEIV0
 12365     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12366     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12367     MOVE X'2D20233030303131353533' TO DFHEIV0(25:11)
 12368     CALL 'kxdfhei1' USING DFHEIV0
 12369     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12370
 12371
 12372     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 12373     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 12374     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 12375     MOVE PB-SV-STATE            TO ELCERT-STATE.
 12376
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 229
* EL6311.cbl
 12377
 12378* EXEC CICS READ
 12379*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 12380*        DATASET (FILE-ID-ELCERT)
 12381*        RIDFLD  (ELCERT-KEY)
 12382*        UPDATE
 12383*    END-EXEC.
 12384*    MOVE '&"S        EU         (   #00011562' TO DFHEIV0
 12385     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12386     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12387     MOVE X'2020233030303131353632' TO DFHEIV0(25:11)
 12388     CALL 'kxdfhei1' USING DFHEIV0,
 12389           FILE-ID-ELCERT,
 12390           DFHEIV20,
 12391           DFHEIV99,
 12392           ELCERT-KEY,
 12393           DFHEIV99,
 12394           DFHEIV99,
 12395           DFHEIV99
 12396     SET ADDRESS OF CERTIFICATE-MASTER TO
 12397         DFHEIV20
 12398     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12399
 12400
 12401     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12402
 12403     MOVE FILE-ID-ELCERT         TO JP-FILE-ID.
 12404     MOVE 'B'                    TO JP-RECORD-TYPE
 12405     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 12406
 12407     PERFORM 8400-LOG-JOURNAL-RECORD.
 12408
 12409     IF CERT-NOTES-ARE-NOT-PRESENT
 12410        MOVE ' '                 TO WS-CERT-NOTE-SW
 12411     ELSE
 12412        MOVE 'Y'                 TO WS-CERT-NOTE-SW.
 12413
 12414     IF INSURED-ADDR-PRESENT
 12415        MOVE 'Y'                 TO WS-CERT-ADDRESS-SW.
 12416
 12417******************************************************************
 12418******* THIS CODE SHOULD BYPASS SETTING THE CLAIM-INTERFACE-SW  **
 12419******* IF THE CERTIFICATE HAS ALREADY GONE THROUGH A MONTH END **
 12420******************************************************************
 12421******************************************************************
 12422
 12423     IF CERT-ADDED-BATCH AND
 12424        (NOT NO-CLAIM-ATTACHED
 12425         OR
 12426         CM-CLAIM-ATTACHED-COUNT GREATER THAN +0)
 12427        GO TO 1410-REWRITE-CERT.
 12428
 12429******************************************************************
 12430******************************************************************
 12431
 12432     IF CERT-ADDED-BATCH  AND
 12433        (NO-CLAIM-ATTACHED OR CM-CLAIM-ATTACHED-COUNT = ZEROS)
 12434        GO TO 1410-REWRITE-CERT.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 230
* EL6311.cbl
 12435
 12436     IF NO-CLAIM-ATTACHED
 12437        NEXT SENTENCE
 12438     ELSE
 12439        MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-1
 12440        MOVE '2'                    TO CM-CLAIM-INTERFACE-SW
 12441        GO TO 1410-REWRITE-CERT.
 12442
 12443     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 12444     MOVE 'D'                      TO JP-RECORD-TYPE.
 12445     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 12446
 12447
 12448* EXEC CICS DELETE
 12449*         DATASET    (FILE-ID-ELCERT)
 12450*    END-EXEC.
 12451*    MOVE '&(                    &   #00011615' TO DFHEIV0
 12452     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12453     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12454     MOVE X'2020233030303131363135' TO DFHEIV0(25:11)
 12455     CALL 'kxdfhei1' USING DFHEIV0,
 12456           FILE-ID-ELCERT,
 12457           DFHEIV99,
 12458           DFHEIV99,
 12459           DFHEIV99,
 12460           DFHEIV99
 12461     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12462
 12463
 12464     PERFORM 8400-LOG-JOURNAL-RECORD.
 12465
 12466******************************************************************
 12467*                                                                *
 12468*       DELETE CERTIFICATE NOTES FOR ALL DELETED CERTIFICATES    *
 12469*                                                                *
 12470******************************************************************
 12471
 12472     IF  CERT-NOTES-ARE-PRESENT
 12473         NEXT SENTENCE
 12474     ELSE
 12475         GO TO 1407-DELETE-MAILING.
 12476
 12477
 12478* EXEC CICS HANDLE CONDITION
 12479*         NOTFND  (1406-DELETE-ERNOTE)
 12480*    END-EXEC.
 12481*    MOVE '"$I                   ! . #00011632' TO DFHEIV0
 12482     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12483     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12484     MOVE X'2E20233030303131363332' TO DFHEIV0(25:11)
 12485     CALL 'kxdfhei1' USING DFHEIV0
 12486     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12487
 12488
 12489     MOVE ELCERT-KEY            TO ERCNOT-KEY.
 12490     MOVE '0'                   TO ERCNOT-REC-TYPE.
 12491     MOVE 0                     TO ERCNOT-SEQUENCE.
 12492
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 231
* EL6311.cbl
 12493 1406-DELETE-ERCNOT-LOOP.
 12494
 12495
 12496* EXEC CICS READ
 12497*        GTEQ
 12498*        DATASET   (FILE-ID-ERCNOT)
 12499*        SET       (ADDRESS OF CERT-NOTE-FILE)
 12500*        RIDFLD    (ERCNOT-KEY)
 12501*    END-EXEC.
 12502*    MOVE '&"S        G          (   #00011642' TO DFHEIV0
 12503     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 12504     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12505     MOVE X'2020233030303131363432' TO DFHEIV0(25:11)
 12506     CALL 'kxdfhei1' USING DFHEIV0,
 12507           FILE-ID-ERCNOT,
 12508           DFHEIV20,
 12509           DFHEIV99,
 12510           ERCNOT-KEY,
 12511           DFHEIV99,
 12512           DFHEIV99,
 12513           DFHEIV99
 12514     SET ADDRESS OF CERT-NOTE-FILE TO
 12515         DFHEIV20
 12516     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12517
 12518
 12519     MOVE CZ-CONTROL-PRIMARY      TO ERCNOT-KEY
 12520     IF ERCNOT-PART-KEY NOT EQUAL ELCERT-KEY
 12521         GO TO 1406-DELETE-ERNOTE
 12522     END-IF.
 12523
 12524     MOVE FILE-ID-ERCNOT         TO  JP-FILE-ID.
 12525     MOVE 'D'                    TO  JP-RECORD-TYPE.
 12526     MOVE CERT-NOTE-FILE         TO  JP-RECORD-AREA.
 12527
 12528     MOVE ERCNOT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12529
 12530
 12531* EXEC CICS DELETE
 12532*        DATASET   (FILE-ID-ERCNOT)
 12533*        RIDFLD    (ERCNOT-KEY)
 12534*        END-EXEC.
 12535*    MOVE '&(  R                 &   #00011660' TO DFHEIV0
 12536     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
 12537     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12538     MOVE X'2020233030303131363630' TO DFHEIV0(25:11)
 12539     CALL 'kxdfhei1' USING DFHEIV0,
 12540           FILE-ID-ERCNOT,
 12541           ERCNOT-KEY,
 12542           DFHEIV99,
 12543           DFHEIV99,
 12544           DFHEIV99
 12545     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12546
 12547
 12548     PERFORM 8400-LOG-JOURNAL-RECORD.
 12549
 12550     GO TO 1406-DELETE-ERCNOT-LOOP.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 232
* EL6311.cbl
 12551
 12552 1406-DELETE-ERNOTE.
 12553
 12554
 12555* EXEC CICS HANDLE CONDITION
 12556*         NOTFND  (1407-DELETE-MAILING)
 12557*    END-EXEC.
 12558*    MOVE '"$I                   ! / #00011671' TO DFHEIV0
 12559     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12560     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12561     MOVE X'2F20233030303131363731' TO DFHEIV0(25:11)
 12562     CALL 'kxdfhei1' USING DFHEIV0
 12563     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12564
 12565
 12566
 12567* EXEC CICS READ
 12568*        EQUAL
 12569*        DATASET   (FILE-ID-ERNOTE)
 12570*        SET       (ADDRESS OF CERTIFICATE-NOTE)
 12571*        RIDFLD    (ELCERT-KEY)
 12572*        UPDATE
 12573*    END-EXEC.
 12574*    MOVE '&"S        EU         (   #00011675' TO DFHEIV0
 12575     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12576     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12577     MOVE X'2020233030303131363735' TO DFHEIV0(25:11)
 12578     CALL 'kxdfhei1' USING DFHEIV0,
 12579           FILE-ID-ERNOTE,
 12580           DFHEIV20,
 12581           DFHEIV99,
 12582           ELCERT-KEY,
 12583           DFHEIV99,
 12584           DFHEIV99,
 12585           DFHEIV99
 12586     SET ADDRESS OF CERTIFICATE-NOTE TO
 12587         DFHEIV20
 12588     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12589
 12590
 12591     MOVE FILE-ID-ERNOTE         TO  JP-FILE-ID.
 12592     MOVE 'D'                    TO  JP-RECORD-TYPE.
 12593     MOVE CERTIFICATE-NOTE       TO  JP-RECORD-AREA.
 12594
 12595     MOVE ERNOTE-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12596
 12597
 12598* EXEC CICS DELETE
 12599*        DATASET   (FILE-ID-ERNOTE)
 12600*        END-EXEC.
 12601*    MOVE '&(                    &   #00011689' TO DFHEIV0
 12602     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12603     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12604     MOVE X'2020233030303131363839' TO DFHEIV0(25:11)
 12605     CALL 'kxdfhei1' USING DFHEIV0,
 12606           FILE-ID-ERNOTE,
 12607           DFHEIV99,
 12608           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 233
* EL6311.cbl
 12609           DFHEIV99,
 12610           DFHEIV99
 12611     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12612
 12613
 12614     PERFORM 8400-LOG-JOURNAL-RECORD.
 12615
 12616******************************************************************
 12617*                                                                *
 12618*                DELETE MAILING ADDRESS RECORDS                  *
 12619*                                                                *
 12620******************************************************************
 12621
 12622 1407-DELETE-MAILING.
 12623     IF CERT-ADDRESS-PRESENT
 12624        NEXT SENTENCE
 12625     ELSE
 12626        GO TO 1420-CONTINUE-DELETE.
 12627
 12628
 12629* EXEC CICS HANDLE CONDITION
 12630*         NOTFND  (1420-CONTINUE-DELETE)
 12631*    END-EXEC.
 12632*    MOVE '"$I                   ! 0 #00011707' TO DFHEIV0
 12633     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12634     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12635     MOVE X'3020233030303131373037' TO DFHEIV0(25:11)
 12636     CALL 'kxdfhei1' USING DFHEIV0
 12637     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12638
 12639
 12640
 12641* EXEC CICS READ
 12642*        EQUAL
 12643*        DATASET   (FILE-ID-ERMAIL)
 12644*        SET       (ADDRESS OF MAILING-DATA)
 12645*        RIDFLD    (ELCERT-KEY)
 12646*        UPDATE
 12647*    END-EXEC.
 12648*    MOVE '&"S        EU         (   #00011711' TO DFHEIV0
 12649     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12650     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12651     MOVE X'2020233030303131373131' TO DFHEIV0(25:11)
 12652     CALL 'kxdfhei1' USING DFHEIV0,
 12653           FILE-ID-ERMAIL,
 12654           DFHEIV20,
 12655           DFHEIV99,
 12656           ELCERT-KEY,
 12657           DFHEIV99,
 12658           DFHEIV99,
 12659           DFHEIV99
 12660     SET ADDRESS OF MAILING-DATA TO
 12661         DFHEIV20
 12662     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12663
 12664
 12665     MOVE FILE-ID-ERMAIL         TO  JP-FILE-ID.
 12666     MOVE 'D'                    TO  JP-RECORD-TYPE.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 234
* EL6311.cbl
 12667     MOVE MAILING-DATA           TO  JP-RECORD-AREA.
 12668
 12669     MOVE ERMAIL-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12670
 12671
 12672* EXEC CICS DELETE
 12673*        DATASET   (FILE-ID-ERMAIL)
 12674*    END-EXEC.
 12675*    MOVE '&(                    &   #00011725' TO DFHEIV0
 12676     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12677     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12678     MOVE X'2020233030303131373235' TO DFHEIV0(25:11)
 12679     CALL 'kxdfhei1' USING DFHEIV0,
 12680           FILE-ID-ERMAIL,
 12681           DFHEIV99,
 12682           DFHEIV99,
 12683           DFHEIV99,
 12684           DFHEIV99
 12685     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12686
 12687
 12688     GO TO 1420-CONTINUE-DELETE.
 12689
 12690 1410-REWRITE-CERT.
 12691     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 12692     MOVE 'C'                      TO JP-RECORD-TYPE.
 12693     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 12694     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 12695
 12696
 12697* EXEC CICS REWRITE
 12698*         DATASET    (FILE-ID-ELCERT)
 12699*         FROM       (CERTIFICATE-MASTER)
 12700*         END-EXEC.
 12701     MOVE LENGTH OF
 12702      CERTIFICATE-MASTER
 12703       TO DFHEIV11
 12704*    MOVE '&& L                  %   #00011737' TO DFHEIV0
 12705     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12706     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12707     MOVE X'2020233030303131373337' TO DFHEIV0(25:11)
 12708     CALL 'kxdfhei1' USING DFHEIV0,
 12709           FILE-ID-ELCERT,
 12710           CERTIFICATE-MASTER,
 12711           DFHEIV11,
 12712           DFHEIV99
 12713     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12714
 12715
 12716     PERFORM 8400-LOG-JOURNAL-RECORD.
 12717
 12718 1420-CONTINUE-DELETE.
 12719     SUBTRACT PB-I-LF-PREMIUM-AMT FROM WS-B-LF-ISS-PRM-ENTERED.
 12720     SUBTRACT PB-I-LF-PREM-CALC   FROM WS-B-LF-ISS-PRM-COMPUTED.
 12721
 12722     SUBTRACT PB-I-AH-PREMIUM-AMT FROM WS-B-AH-ISS-PRM-ENTERED.
 12723     SUBTRACT PB-I-AH-PREM-CALC   FROM WS-B-AH-ISS-PRM-COMPUTED.
 12724
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 235
* EL6311.cbl
 12725     SUBTRACT +1 FROM WS-B-ISSUE-CNT-ENTERED.
 12726
 12727 1450-DELETE-PB-RECORD.
 12728     MOVE FILE-ID-ERPNDB           TO JP-FILE-ID
 12729     MOVE 'D'                      TO JP-RECORD-TYPE
 12730     MOVE PENDING-BUSINESS         TO JP-RECORD-AREA.
 12731
 12732
 12733* EXEC CICS DELETE
 12734*        DATASET    (FILE-ID-ERPNDB)
 12735*    END-EXEC.
 12736*    MOVE '&(                    &   #00011758' TO DFHEIV0
 12737     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12738     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12739     MOVE X'2020233030303131373538' TO DFHEIV0(25:11)
 12740     CALL 'kxdfhei1' USING DFHEIV0,
 12741           FILE-ID-ERPNDB,
 12742           DFHEIV99,
 12743           DFHEIV99,
 12744           DFHEIV99,
 12745           DFHEIV99
 12746     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12747
 12748
 12749     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12750
 12751     PERFORM 8400-LOG-JOURNAL-RECORD.
 12752
 12753     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 12754     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 12755     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 12756
 12757
 12758* EXEC CICS HANDLE CONDITION
 12759*         NOTFND    (1480-BATCH-HDR-NOT-FOUND)
 12760*    END-EXEC.
 12761*    MOVE '"$I                   ! 1 #00011770' TO DFHEIV0
 12762     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12763     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12764     MOVE X'3120233030303131373730' TO DFHEIV0(25:11)
 12765     CALL 'kxdfhei1' USING DFHEIV0
 12766     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12767
 12768
 12769
 12770* EXEC CICS READ
 12771*        SET     (ADDRESS OF PENDING-BUSINESS)
 12772*        DATASET (FILE-ID-ERPNDB)
 12773*        RIDFLD  (ERPNDB-KEY)
 12774*        UPDATE
 12775*    END-EXEC.
 12776*    MOVE '&"S        EU         (   #00011774' TO DFHEIV0
 12777     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12778     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12779     MOVE X'2020233030303131373734' TO DFHEIV0(25:11)
 12780     CALL 'kxdfhei1' USING DFHEIV0,
 12781           FILE-ID-ERPNDB,
 12782           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 236
* EL6311.cbl
 12783           DFHEIV99,
 12784           ERPNDB-KEY,
 12785           DFHEIV99,
 12786           DFHEIV99,
 12787           DFHEIV99
 12788     SET ADDRESS OF PENDING-BUSINESS TO
 12789         DFHEIV20
 12790     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12791
 12792
 12793     MOVE ERPNDB-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 12794
 12795     MOVE  FILE-ID-ERPNDB          TO JP-FILE-ID.
 12796
 12797     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 12798        WS-B-CANCEL-CNT-ENTERED = ZEROS
 12799        MOVE 'D'                   TO JP-RECORD-TYPE
 12800        MOVE PENDING-BUSINESS      TO JP-RECORD-AREA
 12801
 12802* EXEC CICS DELETE
 12803*            DATASET    (FILE-ID-ERPNDB)
 12804*       END-EXEC
 12805*    MOVE '&(                    &   #00011789' TO DFHEIV0
 12806     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12807     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12808     MOVE X'2020233030303131373839' TO DFHEIV0(25:11)
 12809     CALL 'kxdfhei1' USING DFHEIV0,
 12810           FILE-ID-ERPNDB,
 12811           DFHEIV99,
 12812           DFHEIV99,
 12813           DFHEIV99,
 12814           DFHEIV99
 12815     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12816        PERFORM 8400-LOG-JOURNAL-RECORD
 12817     ELSE
 12818        MOVE 'B'                 TO JP-RECORD-TYPE
 12819        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 12820        PERFORM 8400-LOG-JOURNAL-RECORD
 12821        MOVE WS-BATCH-RECORD     TO PB-BATCH-RECORD
 12822        MOVE 'C'                 TO JP-RECORD-TYPE
 12823        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 12824
 12825* EXEC CICS REWRITE
 12826*            DATASET    (FILE-ID-ERPNDB)
 12827*            FROM       (PENDING-BUSINESS)
 12828*       END-EXEC
 12829     MOVE LENGTH OF
 12830      PENDING-BUSINESS
 12831       TO DFHEIV11
 12832*    MOVE '&& L                  %   #00011800' TO DFHEIV0
 12833     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12834     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12835     MOVE X'2020233030303131383030' TO DFHEIV0(25:11)
 12836     CALL 'kxdfhei1' USING DFHEIV0,
 12837           FILE-ID-ERPNDB,
 12838           PENDING-BUSINESS,
 12839           DFHEIV11,
 12840           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 237
* EL6311.cbl
 12841     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12842        PERFORM 8400-LOG-JOURNAL-RECORD.
 12843
 12844******************************************************************
 12845*                                                                *
 12846*       DELETE THE A/R REQUEST RECORD IF THE COMPANY USES        *
 12847*       THE ACCOUNTS RECEIVABLE SYSTEM.                          *
 12848*                                                                *
 12849******************************************************************
 12850
 12851     IF NOT PI-AR-PROCESSING
 12852        GO TO 1475-DELETE-FINISHED.
 12853
 12854     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 12855        WS-B-CANCEL-CNT-ENTERED = ZEROS
 12856        NEXT SENTENCE
 12857     ELSE
 12858        GO TO 1475-DELETE-FINISHED.
 12859
 12860
 12861* EXEC CICS HANDLE CONDITION
 12862*         NOTFND    (1475-DELETE-FINISHED)
 12863*         END-EXEC.
 12864*    MOVE '"$I                   ! 2 #00011822' TO DFHEIV0
 12865     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12866     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12867     MOVE X'3220233030303131383232' TO DFHEIV0(25:11)
 12868     CALL 'kxdfhei1' USING DFHEIV0
 12869     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12870
 12871
 12872     MOVE ERPNDB-COMPANY-CD      TO ERRQST-COMPANY-CD.
 12873     MOVE ERPNDB-ENTRY-BATCH     TO ERRQST-ENTRY-BATCH.
 12874
 12875
 12876* EXEC CICS READ
 12877*        SET     (ADDRESS OF AR-REQUEST-RECORD)
 12878*        DATASET (FILE-ID-ERRQST)
 12879*        RIDFLD  (ERRQST-KEY)
 12880*        UPDATE
 12881*    END-EXEC.
 12882*    MOVE '&"S        EU         (   #00011829' TO DFHEIV0
 12883     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12884     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12885     MOVE X'2020233030303131383239' TO DFHEIV0(25:11)
 12886     CALL 'kxdfhei1' USING DFHEIV0,
 12887           FILE-ID-ERRQST,
 12888           DFHEIV20,
 12889           DFHEIV99,
 12890           ERRQST-KEY,
 12891           DFHEIV99,
 12892           DFHEIV99,
 12893           DFHEIV99
 12894     SET ADDRESS OF AR-REQUEST-RECORD TO
 12895         DFHEIV20
 12896     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12897
 12898
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 238
* EL6311.cbl
 12899     MOVE ERRQST-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 12900
 12901     MOVE  FILE-ID-ERRQST          TO JP-FILE-ID.
 12902
 12903     MOVE 'D'                      TO JP-RECORD-TYPE.
 12904     MOVE AR-REQUEST-RECORD        TO JP-RECORD-AREA.
 12905
 12906
 12907* EXEC CICS DELETE
 12908*         DATASET    (FILE-ID-ERRQST)
 12909*    END-EXEC.
 12910*    MOVE '&(                    &   #00011843' TO DFHEIV0
 12911     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12912     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12913     MOVE X'2020233030303131383433' TO DFHEIV0(25:11)
 12914     CALL 'kxdfhei1' USING DFHEIV0,
 12915           FILE-ID-ERRQST,
 12916           DFHEIV99,
 12917           DFHEIV99,
 12918           DFHEIV99,
 12919           DFHEIV99
 12920     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12921
 12922
 12923     PERFORM 8400-LOG-JOURNAL-RECORD.
 12924
 12925 1475-DELETE-FINISHED.
 12926     MOVE ZEROS                  TO EMI-ERROR.
 12927     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12928     MOVE LOW-VALUES             TO EL631BI.
 12929     MOVE -1                     TO BMAINTL.
 12930     GO TO 8100-SEND-INITIAL-MAP.
 12931
 12932 1480-BATCH-HDR-NOT-FOUND.
 12933     MOVE -1                     TO BMAINTL.
 12934     MOVE ER-7450                TO EMI-ERROR.
 12935     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12936     GO TO 8200-SEND-DATAONLY.
 12937
 12938 1490-RECORD-NOT-FOUND.
 12939     MOVE -1                     TO BMAINTL.
 12940     MOVE ER-7451                TO EMI-ERROR.
 12941     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12942     GO TO 8200-SEND-DATAONLY.
 12943
 12944******************************************************************
 12945*            O V E R   C H A R G E   P R O C E S S I N G         *
 12946******************************************************************
 12947 1500-UPDATE-ERNOTE.
 12948     PERFORM 1510-ADD-ERNOTE-REC THRU 1510-EXIT
 12949     MOVE 'A'                    TO WS-NOTE-SW
 12950     PERFORM 1520-UPDATE-ELCERT  THRU 1520-EXIT
 12951     .
 12952 1500-EXIT.
 12953     EXIT.
 12954 1510-ADD-ERNOTE-REC.
 12955
 12956* EXEC CICS GETMAIN
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 239
* EL6311.cbl
 12957*        SET     (ADDRESS OF CERTIFICATE-NOTE)
 12958*        LENGTH  (ERNOTE-RECORD-LENGTH)
 12959*        INITIMG (GETMAIN-SPACE)
 12960*    END-EXEC
 12961*    MOVE ',"IL                  $   #00011879' TO DFHEIV0
 12962     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12963     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12964     MOVE X'2020233030303131383739' TO DFHEIV0(25:11)
 12965     CALL 'kxdfhei1' USING DFHEIV0,
 12966           DFHEIV20,
 12967           ERNOTE-RECORD-LENGTH,
 12968           GETMAIN-SPACE
 12969     SET ADDRESS OF CERTIFICATE-NOTE TO
 12970         DFHEIV20
 12971     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12972     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 12973                                 TO ERNOTE-KEY
 12974
 12975* EXEC CICS READ
 12976*       DATASET    (FILE-ID-ERNOTE)
 12977*       RIDFLD     (ERNOTE-KEY)
 12978*       INTO       (CERTIFICATE-NOTE)
 12979*       RESP       (WS-RESPONSE)
 12980*       UPDATE
 12981*    END-EXEC
 12982     MOVE LENGTH OF
 12983      CERTIFICATE-NOTE
 12984       TO DFHEIV11
 12985*    MOVE '&"IL       EU         (  N#00011886' TO DFHEIV0
 12986     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12987     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12988     MOVE X'204E233030303131383836' TO DFHEIV0(25:11)
 12989     CALL 'kxdfhei1' USING DFHEIV0,
 12990           FILE-ID-ERNOTE,
 12991           CERTIFICATE-NOTE,
 12992           DFHEIV11,
 12993           ERNOTE-KEY,
 12994           DFHEIV99,
 12995           DFHEIV99,
 12996           DFHEIV99
 12997     MOVE EIBRESP  TO WS-RESPONSE
 12998     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12999     IF RESP-NORMAL
 13000        IF CN-BILLING-START-LINE-NO NOT NUMERIC
 13001           MOVE ZEROS            TO CN-BILLING-START-LINE-NO
 13002        END-IF
 13003        IF CN-BILLING-END-LINE-NO NOT NUMERIC
 13004           MOVE ZEROS            TO CN-BILLING-END-LINE-NO
 13005        END-IF
 13006        PERFORM VARYING N1 FROM +1 BY +1 UNTIL
 13007           (N1 > +10)
 13008           OR (CN-LINE (N1) (1:10) = 'OVERCHARGE')
 13009           OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 13010        END-PERFORM
 13011        IF (CN-LINE (N1) (1:10) = 'OVERCHARGE')
 13012          OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 13013
 13014* EXEC CICS UNLOCK
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 240
* EL6311.cbl
 13015*            DATASET    (FILE-ID-ERNOTE)
 13016*          END-EXEC
 13017*    MOVE '&*                    #   #00011907' TO DFHEIV0
 13018     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 13019     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13020     MOVE X'2020233030303131393037' TO DFHEIV0(25:11)
 13021     CALL 'kxdfhei1' USING DFHEIV0,
 13022           FILE-ID-ERNOTE,
 13023           DFHEIV99
 13024     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13025        ELSE
 13026          PERFORM VARYING N1 FROM +1 BY +1
 13027           UNTIL (N1 > +10)
 13028           OR (CN-LINE (N1) = SPACES OR LOW-VALUES)
 13029          END-PERFORM
 13030          IF (N1 < +11)
 13031            IF N1 >= CN-BILLING-START-LINE-NO AND
 13032              N1 <= CN-BILLING-END-LINE-NO
 13033              IF PI-COMPANY-ID = 'DCC'
 13034                 MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13035              ELSE
 13036                 MOVE WS-VA-NO-COMM-MESS
 13037                                    TO CN-LINE (N1)
 13038              END-IF
 13039            ELSE
 13040              IF (CN-BILLING-END-LINE-NO NOT = ZEROS) AND
 13041               (N1 = (CN-BILLING-END-LINE-NO + +1))
 13042                IF PI-COMPANY-ID = 'DCC'
 13043                  MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13044                ELSE
 13045                  MOVE WS-VA-NO-COMM-MESS
 13046                                    TO CN-LINE (N1)
 13047                END-IF
 13048                MOVE N1             TO CN-BILLING-END-LINE-NO
 13049              ELSE
 13050                IF (CN-BILLING-END-LINE-NO = ZEROS)
 13051                  IF PI-COMPANY-ID = 'DCC'
 13052                     MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13053                  ELSE
 13054                     MOVE WS-VA-NO-COMM-MESS
 13055                                    TO CN-LINE (N1)
 13056                  END-IF
 13057                  MOVE N1            TO CN-BILLING-END-LINE-NO
 13058                                      CN-BILLING-START-LINE-NO
 13059                ELSE
 13060                  IF (CN-BILLING-START-LINE-NO NOT = ZEROS) AND
 13061                    (N1 = (CN-BILLING-START-LINE-NO - +1))
 13062                     IF PI-COMPANY-ID = 'DCC'
 13063                       MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13064                     ELSE
 13065                       MOVE WS-VA-NO-COMM-MESS
 13066                                    TO CN-LINE (N1)
 13067                     END-IF
 13068                     MOVE N1         TO CN-BILLING-START-LINE-NO
 13069                  ELSE
 13070                     PERFORM 1700-SQUEEZE-IT-IN
 13071                                 THRU 1700-EXIT
 13072                  END-IF
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 241
* EL6311.cbl
 13073                END-IF
 13074              END-IF
 13075            END-IF
 13076            MOVE 'E631'              TO CN-LAST-MAINT-USER
 13077            MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
 13078            MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
 13079
 13080* EXEC CICS REWRITE
 13081*              DATASET    (FILE-ID-ERNOTE)
 13082*              FROM       (CERTIFICATE-NOTE)
 13083*              RESP       (WS-RESPONSE)
 13084*           END-EXEC
 13085     MOVE LENGTH OF
 13086      CERTIFICATE-NOTE
 13087       TO DFHEIV11
 13088*    MOVE '&& L                  %  N#00011964' TO DFHEIV0
 13089     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13090     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13091     MOVE X'204E233030303131393634' TO DFHEIV0(25:11)
 13092     CALL 'kxdfhei1' USING DFHEIV0,
 13093           FILE-ID-ERNOTE,
 13094           CERTIFICATE-NOTE,
 13095           DFHEIV11,
 13096           DFHEIV99
 13097     MOVE EIBRESP  TO WS-RESPONSE
 13098     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13099          END-IF
 13100        END-IF
 13101     ELSE
 13102        MOVE SPACES              TO CERTIFICATE-NOTE
 13103        MOVE 'CN'                TO CN-RECORD-ID
 13104        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13105                                 TO CN-CONTROL-PRIMARY
 13106                                    ERNOTE-KEY
 13107        MOVE 01                  TO CN-BILLING-START-LINE-NO
 13108                                    CN-BILLING-END-LINE-NO
 13109        IF PI-COMPANY-ID = 'DCC'
 13110           MOVE WS-OC-MESSAGE    TO CN-LINE (1)
 13111        ELSE
 13112           MOVE WS-VA-NO-COMM-MESS
 13113                                 TO CN-LINE (1)
 13114        END-IF
 13115        MOVE 'E631'              TO CN-LAST-MAINT-USER
 13116        MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
 13117        MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
 13118
 13119* EXEC CICS WRITE
 13120*          DATASET    (FILE-ID-ERNOTE)
 13121*          FROM       (CERTIFICATE-NOTE)
 13122*          RIDFLD     (ERNOTE-KEY)
 13123*          RESP       (WS-RESPONSE)
 13124*       END-EXEC
 13125     MOVE LENGTH OF
 13126      CERTIFICATE-NOTE
 13127       TO DFHEIV11
 13128*    MOVE '&$ L                  ''  N#00011988' TO DFHEIV0
 13129     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13130     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 242
* EL6311.cbl
 13131     MOVE X'204E233030303131393838' TO DFHEIV0(25:11)
 13132     CALL 'kxdfhei1' USING DFHEIV0,
 13133           FILE-ID-ERNOTE,
 13134           CERTIFICATE-NOTE,
 13135           DFHEIV11,
 13136           ERNOTE-KEY,
 13137           DFHEIV99,
 13138           DFHEIV99
 13139     MOVE EIBRESP  TO WS-RESPONSE
 13140     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13141     END-IF
 13142     .
 13143 1510-EXIT.
 13144     EXIT.
 13145 1520-UPDATE-ELCERT.
 13146     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13147                                 TO ELCERT-KEY
 13148
 13149* EXEC CICS READ
 13150*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 13151*        DATASET (FILE-ID-ELCERT)
 13152*        RIDFLD  (ELCERT-KEY)
 13153*        UPDATE
 13154*        RESP    (WS-RESPONSE)
 13155*    END-EXEC
 13156*    MOVE '&"S        EU         (  N#00012001' TO DFHEIV0
 13157     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13158     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13159     MOVE X'204E233030303132303031' TO DFHEIV0(25:11)
 13160     CALL 'kxdfhei1' USING DFHEIV0,
 13161           FILE-ID-ELCERT,
 13162           DFHEIV20,
 13163           DFHEIV99,
 13164           ELCERT-KEY,
 13165           DFHEIV99,
 13166           DFHEIV99,
 13167           DFHEIV99
 13168     SET ADDRESS OF CERTIFICATE-MASTER TO
 13169         DFHEIV20
 13170     MOVE EIBRESP  TO WS-RESPONSE
 13171     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13172     IF RESP-NORMAL
 13173        IF WS-NOTE-SW = 'A'
 13174           IF CM-NOTE-SW = ' '
 13175              MOVE '2'             TO CM-NOTE-SW
 13176           ELSE
 13177             IF CM-NOTE-SW = '1'
 13178                MOVE '3'           TO CM-NOTE-SW
 13179             ELSE
 13180               IF CM-NOTE-SW = '4'
 13181                  MOVE '6'         TO CM-NOTE-SW
 13182               ELSE
 13183                 IF CM-NOTE-SW = '5'
 13184                    MOVE '7'       TO CM-NOTE-SW
 13185                 END-IF
 13186               END-IF
 13187             END-IF
 13188           END-IF
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 243
* EL6311.cbl
 13189        ELSE
 13190           IF CM-NOTE-SW = '2'
 13191              MOVE ' '             TO CM-NOTE-SW
 13192           ELSE
 13193             IF CM-NOTE-SW = '3'
 13194                MOVE '1'           TO CM-NOTE-SW
 13195             ELSE
 13196               IF CM-NOTE-SW = '6'
 13197                  MOVE '4'         TO CM-NOTE-SW
 13198               ELSE
 13199                 IF CM-NOTE-SW = '7'
 13200                    MOVE '5'       TO CM-NOTE-SW
 13201                 END-IF
 13202               END-IF
 13203             END-IF
 13204           END-IF
 13205        END-IF
 13206
 13207* EXEC CICS REWRITE
 13208*          DATASET    (FILE-ID-ELCERT)
 13209*          FROM       (CERTIFICATE-MASTER)
 13210*          RESP       (WS-RESPONSE)
 13211*       END-EXEC
 13212     MOVE LENGTH OF
 13213      CERTIFICATE-MASTER
 13214       TO DFHEIV11
 13215*    MOVE '&& L                  %  N#00012042' TO DFHEIV0
 13216     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13217     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13218     MOVE X'204E233030303132303432' TO DFHEIV0(25:11)
 13219     CALL 'kxdfhei1' USING DFHEIV0,
 13220           FILE-ID-ELCERT,
 13221           CERTIFICATE-MASTER,
 13222           DFHEIV11,
 13223           DFHEIV99
 13224     MOVE EIBRESP  TO WS-RESPONSE
 13225     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13226        IF RESP-NORMAL
 13227           CONTINUE
 13228        ELSE
 13229           MOVE WS-RESPONSE TO EMI-ERROR
 13230           PERFORM 9900-ERROR-FORMAT
 13231                                 THRU 9900-EXIT
 13232           GO TO 8200-SEND-DATAONLY
 13233        END-IF
 13234     ELSE
 13235        MOVE -1                  TO BMAINTL
 13236        MOVE 0249                TO EMI-ERROR
 13237        PERFORM 9900-ERROR-FORMAT
 13238                                 THRU 9900-EXIT
 13239        GO TO 8200-SEND-DATAONLY
 13240     END-IF
 13241     .
 13242 1520-EXIT.
 13243     EXIT.
 13244 1600-UPDATE-ERPYAJ.
 13245     PERFORM 1610-ADD-ERPYAJ-BANK-REC
 13246                                 THRU 1610-EXIT
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 244
* EL6311.cbl
 13247     PERFORM 1620-ADD-ERPYAJ-DLR-REC
 13248                                 THRU 1620-EXIT
 13249     .
 13250 1600-EXIT.
 13251     EXIT.
 13252 1610-ADD-ERPYAJ-BANK-REC.
 13253
 13254* EXEC CICS GETMAIN
 13255*        SET     (ADDRESS OF PENDING-PAY-ADJ)
 13256*        LENGTH  (ERPYAJ-RECORD-LENGTH)
 13257*        INITIMG (GETMAIN-SPACE)
 13258*    END-EXEC
 13259*    MOVE ',"IL                  $   #00012074' TO DFHEIV0
 13260     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13261     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13262     MOVE X'2020233030303132303734' TO DFHEIV0(25:11)
 13263     CALL 'kxdfhei1' USING DFHEIV0,
 13264           DFHEIV20,
 13265           ERPYAJ-RECORD-LENGTH,
 13266           GETMAIN-SPACE
 13267     SET ADDRESS OF PENDING-PAY-ADJ TO
 13268         DFHEIV20
 13269     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13270     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 13271     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 13272     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 13273     MOVE PB-I-BANK-NUMBER       TO ERPYAJ-FIN-RESP
 13274     MOVE LOW-VALUES             TO ERPYAJ-ACCOUNT
 13275     MOVE +10                    TO ERPYAJ-SEQ-NO
 13276     MOVE 'R'                    TO ERPYAJ-TYPE
 13277     IF REVERSAL
 13278        MOVE 'C'                 TO ERPYAJ-TYPE
 13279     END-IF
 13280     MOVE SPACES                 TO PENDING-PAY-ADJ
 13281     MOVE 'PY'                   TO PY-RECORD-ID
 13282     MOVE ERPYAJ-KEY             TO PY-CONTROL-PRIMARY
 13283     MOVE WS-OC-AMT              TO PY-ENTRY-AMT
 13284     IF REVERSAL
 13285        MOVE PB-I-DCC-OVER-CHG-AMT
 13286                                 TO PY-ENTRY-AMT
 13287     END-IF
 13288     MOVE WS-CURRENT-BIN-DT      TO PY-LAST-MAINT-DT
 13289                                    PY-INPUT-DT
 13290*    MOVE X'A15F'                TO PY-LAST-MAINT-DT
 13291*                                   PY-INPUT-DT
 13292     MOVE PI-PROCESSOR-ID        TO PY-LAST-MAINT-BY
 13293     MOVE PI-CR-MONTH-END-DT     TO PY-CREDIT-SELECT-DT
 13294     MOVE 'OVERCHARGE'           TO PY-GL-COMMENT
 13295     MOVE 'B'                    TO PY-ERCOMP-TYPE
 13296     IF PB-CARRIER = '2'
 13297        MOVE '2725040330'        TO PY-GL-ACCOUNT
 13298     ELSE
 13299        MOVE '2725040130'        TO PY-GL-ACCOUNT
 13300     END-IF
 13301     MOVE LOW-VALUES             TO PY-CREDIT-ACCEPT-DT
 13302                                    PY-BILLED-DATE
 13303                                    PY-AR-DATE
 13304                                    PY-REPORTED-DT
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 245
* EL6311.cbl
 13305                                    PY-CHECK-WRITTEN-DT
 13306     MOVE ZEROS                  TO PY-CHECK-QUE-CONTROL
 13307                                    PY-CHECK-QUE-SEQUENCE
 13308     MOVE EIBTIME                TO PY-LAST-MAINT-HHMMSS
 13309     PERFORM WITH TEST AFTER
 13310        UNTIL (NOT RESP-DUPKEY)
 13311           AND (NOT RESP-DUPREC)
 13312
 13313* EXEC CICS WRITE
 13314*          DATASET    (FILE-ID-ERPYAJ)
 13315*          FROM       (PENDING-PAY-ADJ)
 13316*          RIDFLD     (ERPYAJ-KEY)
 13317*          RESP       (WS-RESPONSE)
 13318*       END-EXEC
 13319     MOVE LENGTH OF
 13320      PENDING-PAY-ADJ
 13321       TO DFHEIV11
 13322*    MOVE '&$ L                  ''  N#00012121' TO DFHEIV0
 13323     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13324     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13325     MOVE X'204E233030303132313231' TO DFHEIV0(25:11)
 13326     CALL 'kxdfhei1' USING DFHEIV0,
 13327           FILE-ID-ERPYAJ,
 13328           PENDING-PAY-ADJ,
 13329           DFHEIV11,
 13330           ERPYAJ-KEY,
 13331           DFHEIV99,
 13332           DFHEIV99
 13333     MOVE EIBRESP  TO WS-RESPONSE
 13334     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13335        IF RESP-DUPKEY OR RESP-DUPREC
 13336           ADD +1                TO ERPYAJ-SEQ-NO
 13337           MOVE ERPYAJ-SEQ-NO    TO PY-FILE-SEQ-NO
 13338        END-IF
 13339     END-PERFORM
 13340     .
 13341 1610-EXIT.
 13342     EXIT.
 13343 1620-ADD-ERPYAJ-DLR-REC.
 13344     MOVE 'C'                    TO ERPYAJ-TYPE
 13345     IF REVERSAL
 13346        MOVE 'R'                 TO ERPYAJ-TYPE
 13347     END-IF
 13348     MOVE PB-ACCOUNT             TO ERPYAJ-FIN-RESP
 13349                                    ERPYAJ-ACCOUNT
 13350     ADD +1                      TO ERPYAJ-SEQ-NO
 13351     MOVE ERPYAJ-KEY             TO PY-CONTROL-PRIMARY
 13352     MOVE 'A'                    TO PY-ERCOMP-TYPE
 13353     IF PB-CARRIER = '2'
 13354        MOVE '2725040330'        TO PY-GL-ACCOUNT
 13355     ELSE
 13356        MOVE '2725040130'        TO PY-GL-ACCOUNT
 13357     END-IF
 13358     PERFORM WITH TEST AFTER
 13359        UNTIL (NOT RESP-DUPKEY)
 13360           AND (NOT RESP-DUPREC)
 13361
 13362* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 246
* EL6311.cbl
 13363*          DATASET    (FILE-ID-ERPYAJ)
 13364*          FROM       (PENDING-PAY-ADJ)
 13365*          RIDFLD     (ERPYAJ-KEY)
 13366*          RESP       (WS-RESPONSE)
 13367*       END-EXEC
 13368     MOVE LENGTH OF
 13369      PENDING-PAY-ADJ
 13370       TO DFHEIV11
 13371*    MOVE '&$ L                  ''  N#00012153' TO DFHEIV0
 13372     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13373     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13374     MOVE X'204E233030303132313533' TO DFHEIV0(25:11)
 13375     CALL 'kxdfhei1' USING DFHEIV0,
 13376           FILE-ID-ERPYAJ,
 13377           PENDING-PAY-ADJ,
 13378           DFHEIV11,
 13379           ERPYAJ-KEY,
 13380           DFHEIV99,
 13381           DFHEIV99
 13382     MOVE EIBRESP  TO WS-RESPONSE
 13383     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13384        IF RESP-DUPKEY OR RESP-DUPREC
 13385           ADD +1                TO ERPYAJ-SEQ-NO
 13386           MOVE ERPYAJ-SEQ-NO    TO PY-FILE-SEQ-NO
 13387        END-IF
 13388     END-PERFORM
 13389     .
 13390 1620-EXIT.
 13391     EXIT.
 13392 1700-SQUEEZE-IT-IN.
 13393     IF (N1 > CN-BILLING-END-LINE-NO)
 13394        PERFORM VARYING N1 FROM N1 BY -1 UNTIL
 13395           N1 = +1
 13396           MOVE CN-LINE (N1 - 1)    TO CN-LINE (N1)
 13397           IF (N1 - 1) = (CN-BILLING-END-LINE-NO + 1)
 13398              IF PI-COMPANY-ID = 'DCC'
 13399                 MOVE WS-OC-MESSAGE TO CN-LINE (N1 - 1)
 13400              ELSE
 13401                 MOVE WS-VA-NO-COMM-MESS TO CN-LINE (N1 - 1)
 13402              END-IF
 13403              COMPUTE CN-BILLING-END-LINE-NO = N1 - 1
 13404              MOVE +2 TO N1
 13405           END-IF
 13406        END-PERFORM
 13407     ELSE
 13408        IF (N1 < CN-BILLING-START-LINE-NO)
 13409           PERFORM VARYING N1 FROM N1 BY +1 UNTIL
 13410              N1 = +10
 13411              MOVE CN-LINE (N1 + 1) TO CN-LINE (N1)
 13412              IF (N1 + 1) = (CN-BILLING-START-LINE-NO - 1)
 13413                 IF PI-COMPANY-ID = 'DCC'
 13414                    MOVE WS-OC-MESSAGE TO CN-LINE (N1 + 1)
 13415                 ELSE
 13416                    MOVE WS-VA-NO-COMM-MESS TO CN-LINE (N1 + 1)
 13417                 END-IF
 13418                 COMPUTE CN-BILLING-START-LINE-NO = N1 + 1
 13419                 MOVE +9 TO N1
 13420              END-IF
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 247
* EL6311.cbl
 13421           END-PERFORM
 13422        END-IF
 13423     END-IF
 13424     .
 13425 1700-EXIT.
 13426     EXIT.
 13427 1800-REMOVE-CERT-NOTES.
 13428     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13429                                 TO ERNOTE-KEY
 13430
 13431* EXEC CICS READ
 13432*       SET        (ADDRESS OF CERTIFICATE-NOTE)
 13433*       DATASET    (FILE-ID-ERNOTE)
 13434*       RIDFLD     (ERNOTE-KEY)
 13435*       RESP       (WS-RESPONSE)
 13436*       UPDATE
 13437*    END-EXEC
 13438*    MOVE '&"S        EU         (  N#00012205' TO DFHEIV0
 13439     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13440     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13441     MOVE X'204E233030303132323035' TO DFHEIV0(25:11)
 13442     CALL 'kxdfhei1' USING DFHEIV0,
 13443           FILE-ID-ERNOTE,
 13444           DFHEIV20,
 13445           DFHEIV99,
 13446           ERNOTE-KEY,
 13447           DFHEIV99,
 13448           DFHEIV99,
 13449           DFHEIV99
 13450     SET ADDRESS OF CERTIFICATE-NOTE TO
 13451         DFHEIV20
 13452     MOVE EIBRESP  TO WS-RESPONSE
 13453     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13454     IF RESP-NORMAL
 13455        PERFORM VARYING N1 FROM +1 BY +1 UNTIL
 13456           (N1 > +10)
 13457           OR (CN-LINE (N1) (1:10) = 'OVERCHARGE')
 13458           OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 13459        END-PERFORM
 13460        IF N1 < +11
 13461           MOVE SPACES              TO CN-LINE (N1)
 13462           IF N1 >= CN-BILLING-START-LINE-NO  AND
 13463              N1 <= CN-BILLING-END-LINE-NO
 13464              SUBTRACT 1 FROM CN-BILLING-END-LINE-NO
 13465              IF CN-BILLING-END-LINE-NO <
 13466                               CN-BILLING-START-LINE-NO
 13467                 MOVE ZEROS         TO CN-BILLING-END-LINE-NO
 13468                                     CN-BILLING-START-LINE-NO
 13469              END-IF
 13470              PERFORM 1820-SQUEEZE-ERNOTE
 13471                                  THRU 1820-EXIT
 13472           END-IF
 13473           IF CN-LINES = SPACES
 13474
 13475* EXEC CICS DELETE
 13476*                DATASET    (FILE-ID-ERNOTE)
 13477*                RESP       (WS-RESPONSE)
 13478*             END-EXEC
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 248
* EL6311.cbl
 13479*    MOVE '&(                    &  N#00012232' TO DFHEIV0
 13480     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13481     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13482     MOVE X'204E233030303132323332' TO DFHEIV0(25:11)
 13483     CALL 'kxdfhei1' USING DFHEIV0,
 13484           FILE-ID-ERNOTE,
 13485           DFHEIV99,
 13486           DFHEIV99,
 13487           DFHEIV99,
 13488           DFHEIV99
 13489     MOVE EIBRESP  TO WS-RESPONSE
 13490     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13491              IF RESP-NORMAL
 13492                 MOVE 'D'        TO WS-NOTE-SW
 13493                 PERFORM 1520-UPDATE-ELCERT
 13494                                 THRU 1520-EXIT
 13495              END-IF
 13496           ELSE
 13497
 13498* EXEC CICS REWRITE
 13499*                DATASET    (FILE-ID-ERNOTE)
 13500*                FROM       (CERTIFICATE-NOTE)
 13501*                RESP       (WS-RESPONSE)
 13502*             END-EXEC
 13503     MOVE LENGTH OF
 13504      CERTIFICATE-NOTE
 13505       TO DFHEIV11
 13506*    MOVE '&& L                  %  N#00012242' TO DFHEIV0
 13507     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13508     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13509     MOVE X'204E233030303132323432' TO DFHEIV0(25:11)
 13510     CALL 'kxdfhei1' USING DFHEIV0,
 13511           FILE-ID-ERNOTE,
 13512           CERTIFICATE-NOTE,
 13513           DFHEIV11,
 13514           DFHEIV99
 13515     MOVE EIBRESP  TO WS-RESPONSE
 13516     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13517           END-IF
 13518        END-IF
 13519     END-IF
 13520     .
 13521 1800-EXIT.
 13522     EXIT.
 13523 1820-SQUEEZE-ERNOTE.
 13524     MOVE CN-BILLING-START-LINE-NO TO N2
 13525     IF N2 = 0
 13526         MOVE +1                 TO N2
 13527     END-IF
 13528     PERFORM VARYING N1 FROM N2 BY +1 UNTIL
 13529        (N1 > +9)
 13530        IF CN-LINE (N1) = SPACES
 13531           MOVE CN-LINE (N1 + +1)
 13532                                 TO CN-LINE (N1)
 13533           MOVE SPACES           TO CN-LINE (N1 + +1)
 13534        END-IF
 13535     END-PERFORM
 13536     .
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 249
* EL6311.cbl
 13537 1820-EXIT.
 13538     EXIT.
 13539 1900-DELETE-ERPYAJ.
 13540     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 13541     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 13542     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 13543     MOVE PB-I-BANK-NUMBER       TO ERPYAJ-FIN-RESP
 13544     MOVE LOW-VALUES             TO ERPYAJ-ACCOUNT
 13545     MOVE +10                    TO ERPYAJ-SEQ-NO
 13546     MOVE 'R'                    TO ERPYAJ-TYPE
 13547     MOVE ERPYAJ-KEY             TO WS-SAVE-ERPYAJ-KEY
 13548
 13549* EXEC CICS STARTBR
 13550*       DATASET    (FILE-ID-ERPYAJ)
 13551*       RIDFLD     (ERPYAJ-KEY)
 13552*       RESP       (WS-RESPONSE)
 13553*    END-EXEC
 13554     MOVE 0
 13555       TO DFHEIV11
 13556*    MOVE '&,         G          &  N#00012278' TO DFHEIV0
 13557     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 13558     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13559     MOVE X'204E233030303132323738' TO DFHEIV0(25:11)
 13560     CALL 'kxdfhei1' USING DFHEIV0,
 13561           FILE-ID-ERPYAJ,
 13562           ERPYAJ-KEY,
 13563           DFHEIV99,
 13564           DFHEIV11,
 13565           DFHEIV99
 13566     MOVE EIBRESP  TO WS-RESPONSE
 13567     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13568     IF RESP-NORMAL
 13569        CONTINUE
 13570     ELSE
 13571        GO TO 1900-GET-DEALER
 13572     END-IF
 13573     .
 13574 1900-READNEXT-ERPYAJ-B.
 13575*  GET THE BANK ERPYAJ RECORD
 13576
 13577* EXEC CICS READNEXT
 13578*       DATASET    (FILE-ID-ERPYAJ)
 13579*       RIDFLD     (ERPYAJ-KEY)
 13580*       SET        (ADDRESS OF PENDING-PAY-ADJ)
 13581*       RESP       (WS-RESPONSE)
 13582*    END-EXEC
 13583     MOVE 0
 13584       TO DFHEIV11
 13585*    MOVE '&.S                   )  N#00012291' TO DFHEIV0
 13586     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 13587     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 13588     MOVE X'204E233030303132323931' TO DFHEIV0(25:11)
 13589     CALL 'kxdfhei1' USING DFHEIV0,
 13590           FILE-ID-ERPYAJ,
 13591           DFHEIV20,
 13592           DFHEIV99,
 13593           ERPYAJ-KEY,
 13594           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 250
* EL6311.cbl
 13595           DFHEIV11,
 13596           DFHEIV99,
 13597           DFHEIV99
 13598     SET ADDRESS OF PENDING-PAY-ADJ TO
 13599         DFHEIV20
 13600     MOVE EIBRESP  TO WS-RESPONSE
 13601     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13602     IF RESP-NORMAL
 13603        IF PY-CONTROL-PRIMARY (1:28) = WS-SAVE-ERPYAJ-KEY (1:28)
 13604           IF (PB-I-DCC-OVER-CHG-AMT = PY-ENTRY-AMT)
 13605              IF (PY-INPUT-DT = WS-CURRENT-BIN-DT)
 13606                 AND (PY-LAST-MAINT-BY = PI-PROCESSOR-ID)
 13607
 13608* EXEC CICS READ
 13609*                   DATASET    (FILE-ID-ERPYAJ)
 13610*                   RIDFLD     (ERPYAJ-KEY)
 13611*                   SET        (ADDRESS OF PENDING-PAY-ADJ)
 13612*                   RESP       (WS-RESPONSE)
 13613*                   UPDATE
 13614*                END-EXEC
 13615*    MOVE '&"S        EU         (  N#00012302' TO DFHEIV0
 13616     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13617     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13618     MOVE X'204E233030303132333032' TO DFHEIV0(25:11)
 13619     CALL 'kxdfhei1' USING DFHEIV0,
 13620           FILE-ID-ERPYAJ,
 13621           DFHEIV20,
 13622           DFHEIV99,
 13623           ERPYAJ-KEY,
 13624           DFHEIV99,
 13625           DFHEIV99,
 13626           DFHEIV99
 13627     SET ADDRESS OF PENDING-PAY-ADJ TO
 13628         DFHEIV20
 13629     MOVE EIBRESP  TO WS-RESPONSE
 13630     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13631                 IF RESP-NORMAL
 13632
 13633* EXEC CICS DELETE
 13634*                      DATASET   (FILE-ID-ERPYAJ)
 13635*                      RESP      (WS-RESPONSE)
 13636*                   END-EXEC
 13637*    MOVE '&(                    &  N#00012310' TO DFHEIV0
 13638     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13639     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13640     MOVE X'204E233030303132333130' TO DFHEIV0(25:11)
 13641     CALL 'kxdfhei1' USING DFHEIV0,
 13642           FILE-ID-ERPYAJ,
 13643           DFHEIV99,
 13644           DFHEIV99,
 13645           DFHEIV99,
 13646           DFHEIV99
 13647     MOVE EIBRESP  TO WS-RESPONSE
 13648     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13649                 END-IF
 13650              ELSE
 13651                 SET REVERSAL    TO TRUE
 13652                 PERFORM 1600-UPDATE-ERPYAJ
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 251
* EL6311.cbl
 13653                                 THRU 1600-EXIT
 13654                 GO TO 1900-EXIT
 13655              END-IF
 13656           ELSE
 13657              GO TO 1900-READNEXT-ERPYAJ-B
 13658           END-IF
 13659        END-IF
 13660
 13661* EXEC CICS ENDBR
 13662*          DATASET   (FILE-ID-ERPYAJ)
 13663*       END-EXEC
 13664     MOVE 0
 13665       TO DFHEIV11
 13666*    MOVE '&2                    $   #00012325' TO DFHEIV0
 13667     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 13668     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13669     MOVE X'2020233030303132333235' TO DFHEIV0(25:11)
 13670     CALL 'kxdfhei1' USING DFHEIV0,
 13671           FILE-ID-ERPYAJ,
 13672           DFHEIV11,
 13673           DFHEIV99
 13674     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13675     END-IF
 13676     .
 13677 1900-GET-DEALER.
 13678     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 13679     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 13680     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 13681     MOVE PB-ACCOUNT             TO ERPYAJ-FIN-RESP
 13682     MOVE PB-ACCOUNT             TO ERPYAJ-ACCOUNT
 13683     MOVE +10                    TO ERPYAJ-SEQ-NO
 13684     MOVE 'C'                    TO ERPYAJ-TYPE
 13685     MOVE ERPYAJ-KEY             TO WS-SAVE-ERPYAJ-KEY
 13686
 13687* EXEC CICS STARTBR
 13688*       DATASET    (FILE-ID-ERPYAJ)
 13689*       RIDFLD     (ERPYAJ-KEY)
 13690*       RESP       (WS-RESPONSE)
 13691*    END-EXEC
 13692     MOVE 0
 13693       TO DFHEIV11
 13694*    MOVE '&,         G          &  N#00012339' TO DFHEIV0
 13695     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 13696     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13697     MOVE X'204E233030303132333339' TO DFHEIV0(25:11)
 13698     CALL 'kxdfhei1' USING DFHEIV0,
 13699           FILE-ID-ERPYAJ,
 13700           ERPYAJ-KEY,
 13701           DFHEIV99,
 13702           DFHEIV11,
 13703           DFHEIV99
 13704     MOVE EIBRESP  TO WS-RESPONSE
 13705     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13706     IF RESP-NORMAL
 13707        CONTINUE
 13708     ELSE
 13709        GO TO 1900-EXIT
 13710     END-IF
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 252
* EL6311.cbl
 13711     .
 13712 1900-READNEXT-ERPYAJ-D.
 13713*  GET THE DEALER ERPYAJ RECORD
 13714
 13715* EXEC CICS READNEXT
 13716*       DATASET    (FILE-ID-ERPYAJ)
 13717*       RIDFLD     (ERPYAJ-KEY)
 13718*       SET        (ADDRESS OF PENDING-PAY-ADJ)
 13719*       RESP       (WS-RESPONSE)
 13720*    END-EXEC
 13721     MOVE 0
 13722       TO DFHEIV11
 13723*    MOVE '&.S                   )  N#00012352' TO DFHEIV0
 13724     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 13725     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 13726     MOVE X'204E233030303132333532' TO DFHEIV0(25:11)
 13727     CALL 'kxdfhei1' USING DFHEIV0,
 13728           FILE-ID-ERPYAJ,
 13729           DFHEIV20,
 13730           DFHEIV99,
 13731           ERPYAJ-KEY,
 13732           DFHEIV99,
 13733           DFHEIV11,
 13734           DFHEIV99,
 13735           DFHEIV99
 13736     SET ADDRESS OF PENDING-PAY-ADJ TO
 13737         DFHEIV20
 13738     MOVE EIBRESP  TO WS-RESPONSE
 13739     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13740     IF RESP-NORMAL
 13741        IF PY-CONTROL-PRIMARY (1:28) = WS-SAVE-ERPYAJ-KEY (1:28)
 13742           IF (PB-I-DCC-OVER-CHG-AMT = PY-ENTRY-AMT)
 13743              IF (PY-INPUT-DT = WS-CURRENT-BIN-DT)
 13744                 AND (PY-LAST-MAINT-BY = PI-PROCESSOR-ID)
 13745
 13746* EXEC CICS READ
 13747*                   DATASET    (FILE-ID-ERPYAJ)
 13748*                   RIDFLD     (ERPYAJ-KEY)
 13749*                   SET        (ADDRESS OF PENDING-PAY-ADJ)
 13750*                   RESP       (WS-RESPONSE)
 13751*                   UPDATE
 13752*                END-EXEC
 13753*    MOVE '&"S        EU         (  N#00012363' TO DFHEIV0
 13754     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13755     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13756     MOVE X'204E233030303132333633' TO DFHEIV0(25:11)
 13757     CALL 'kxdfhei1' USING DFHEIV0,
 13758           FILE-ID-ERPYAJ,
 13759           DFHEIV20,
 13760           DFHEIV99,
 13761           ERPYAJ-KEY,
 13762           DFHEIV99,
 13763           DFHEIV99,
 13764           DFHEIV99
 13765     SET ADDRESS OF PENDING-PAY-ADJ TO
 13766         DFHEIV20
 13767     MOVE EIBRESP  TO WS-RESPONSE
 13768     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 253
* EL6311.cbl
 13769                 IF RESP-NORMAL
 13770
 13771* EXEC CICS DELETE
 13772*                      DATASET   (FILE-ID-ERPYAJ)
 13773*                      RESP      (WS-RESPONSE)
 13774*                   END-EXEC
 13775*    MOVE '&(                    &  N#00012371' TO DFHEIV0
 13776     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13777     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13778     MOVE X'204E233030303132333731' TO DFHEIV0(25:11)
 13779     CALL 'kxdfhei1' USING DFHEIV0,
 13780           FILE-ID-ERPYAJ,
 13781           DFHEIV99,
 13782           DFHEIV99,
 13783           DFHEIV99,
 13784           DFHEIV99
 13785     MOVE EIBRESP  TO WS-RESPONSE
 13786     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13787                 END-IF
 13788              ELSE
 13789                 SET REVERSAL    TO TRUE
 13790              END-IF
 13791           ELSE
 13792              GO TO 1900-READNEXT-ERPYAJ-D
 13793           END-IF
 13794        END-IF
 13795
 13796* EXEC CICS ENDBR
 13797*          DATASET   (FILE-ID-ERPYAJ)
 13798*       END-EXEC
 13799     MOVE 0
 13800       TO DFHEIV11
 13801*    MOVE '&2                    $   #00012383' TO DFHEIV0
 13802     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 13803     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13804     MOVE X'2020233030303132333833' TO DFHEIV0(25:11)
 13805     CALL 'kxdfhei1' USING DFHEIV0,
 13806           FILE-ID-ERPYAJ,
 13807           DFHEIV11,
 13808           DFHEIV99
 13809     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13810     END-IF
 13811     .
 13812 1900-EXIT.
 13813     EXIT.
 13814******************************************************************
 13815*            C A N C E L   M A I N L I N E                       *
 13816******************************************************************
 13817
 13818 2000-CANCEL-MAINLINE.
 13819     IF PI-DISPLAY-ORIGINAL-BATCH
 13820        IF CMAINTI NOT = 'C' AND 'D' AND 'S' AND 'K'
 13821           MOVE ER-0023             TO EMI-ERROR
 13822           MOVE -1                  TO CMAINTL
 13823           MOVE AL-UABON            TO CMAINTA
 13824           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13825           GO TO 8200-SEND-DATAONLY
 13826        ELSE
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 254
* EL6311.cbl
 13827           NEXT SENTENCE
 13828     ELSE
 13829        IF CMAINTI NOT = 'A' AND 'C' AND 'D' AND 'S' AND 'K'
 13830           MOVE ER-0023             TO EMI-ERROR
 13831           MOVE -1                  TO CMAINTL
 13832           MOVE AL-UABON            TO CMAINTA
 13833           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13834           GO TO 8200-SEND-DATAONLY.
 13835
 13836     IF CMAINTI = 'S'
 13837        GO TO 2100-SHOW-REQUEST.
 13838
 13839     IF NOT MODIFY-CAP
 13840         MOVE 'UPDATE'       TO SM-READ
 13841         PERFORM 9995-SECURITY-VIOLATION
 13842         MOVE ER-0070        TO EMI-ERROR
 13843         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13844         GO TO 8100-SEND-INITIAL-MAP.
 13845
 13846     IF CMAINTL GREATER THAN ZEROS
 13847        IF PI-PF6-FUNCTION
 13848           IF CMAINTI NOT = 'A'
 13849              MOVE AL-UABON  TO CMAINTA
 13850              MOVE -1        TO CMAINTL
 13851              MOVE ER-2260   TO EMI-ERROR
 13852              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13853              GO TO 8200-SEND-DATAONLY.
 13854
 13855     IF CCERTNOL = ZEROS
 13856       AND (CMAINTI = 'C' OR 'K' OR 'D')
 13857         NEXT SENTENCE
 13858     ELSE
 13859         IF CCERTNOL NOT = ZEROS
 13860             MOVE AL-UANON       TO CCERTNOA
 13861         ELSE
 13862             MOVE -1             TO CCERTNOL
 13863             MOVE  1             TO SET-CURSOR-SW
 13864             MOVE ER-2218       TO EMI-ERROR
 13865             MOVE AL-UABON       TO CCERTNOA
 13866             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13867
 13868     IF CEFFDTL = ZEROS AND (CMAINTI = 'C' OR 'K' OR 'D')
 13869        NEXT SENTENCE
 13870     ELSE
 13871        IF CEFFDTL NOT = ZEROS
 13872           MOVE AL-UNNON         TO CEFFDTA
 13873           MOVE CEFFDTI TO DEEDIT-FIELD
 13874           PERFORM 8600-DEEDIT
 13875           MOVE 4                TO DC-OPTION-CODE
 13876           MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 13877           PERFORM 9700-DATE-LINK
 13878           IF NO-CONVERSION-ERROR
 13879              MOVE DC-BIN-DATE-1 TO WS-CONVERTED-EFFDT
 13880              ELSE
 13881              MOVE -1            TO CEFFDTL
 13882              MOVE  1            TO SET-CURSOR-SW
 13883              MOVE ER-2226      TO EMI-ERROR
 13884              MOVE AL-UNBON      TO CEFFDTA
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 255
* EL6311.cbl
 13885              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13886          ELSE
 13887          MOVE -1                 TO CEFFDTL
 13888          MOVE  1                 TO SET-CURSOR-SW
 13889          MOVE ER-2220            TO EMI-ERROR
 13890          MOVE AL-UNBON           TO CEFFDTA
 13891          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13892
 13893     MOVE PI-PREV-ALT-KEY            TO WS-ERPNDB-ALT-KEY.
 13894
 13895     IF CCERTNOL NOT = ZEROS
 13896        MOVE CCERTNOI                TO WS-NEW-PRIME
 13897     ELSE
 13898        MOVE SPACES                  TO WS-NEW-PRIME.
 13899
 13900     IF CSUFIXL NOT = ZEROS
 13901        MOVE CSUFIXI                 TO WS-NEW-SUFFIX
 13902     ELSE
 13903        MOVE SPACE                   TO WS-NEW-SUFFIX.
 13904
 13905     IF CEFFDTL NOT = ZEROS
 13906        MOVE WS-CONVERTED-EFFDT      TO WS-NEW-CERT-EFF-DT
 13907     ELSE
 13908        MOVE LOW-VALUES              TO WS-NEW-CERT-EFF-DT.
 13909
 13910     IF CMAINTI = 'A' OR 'K' OR 'S'
 13911        NEXT SENTENCE
 13912     ELSE
 13913        MOVE PI-PREV-ALT-KEY     TO WS-ERPNDB-ALT-KEY
 13914        IF WS-PB-CERT-NO     NOT = WS-NEW-CERT-NO     OR
 13915           WS-PB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT OR
 13916           WS-PB-RECORD-TYPE NOT = '2'
 13917           IF CMAINTI = 'C'
 13918              MOVE ER-2287          TO EMI-ERROR
 13919              MOVE -1               TO CCERTNOL
 13920              MOVE AL-UABON         TO CCERTNOA CEFFDTA
 13921              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13922              GO TO 8200-SEND-DATAONLY
 13923             ELSE
 13924              MOVE ER-2260          TO EMI-ERROR
 13925              MOVE -1               TO CCERTNOL
 13926              MOVE AL-UABON         TO CCERTNOA
 13927              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13928              GO TO 8200-SEND-DATAONLY.
 13929
 13930     IF CMAINTI = 'D'
 13931        GO TO 2400-DELETE-CANCEL-ROUTINE.
 13932
 13933     IF CLSTNML GREATER THAN ZEROS
 13934         MOVE AL-UANON           TO CLSTNMA.
 13935
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 256
* EL6311.cbl
 13937
 13938******************************************************************
 13939*                                                                *
 13940*           E D I T   C A N C E L   C O V E R A G E S            *
 13941*                                                                *
 13942******************************************************************
 13943
 13944 2015-EDIT-COVERAGES.
 13945     IF CCANDT1L      GREATER THAN ZEROS OR
 13946        CREFND1L      GREATER THAN ZEROS OR
 13947        CCANDT2L      GREATER THAN ZEROS OR
 13948        CREFND2L      GREATER THAN ZEROS OR
 13949        CMTHD1L       GREATER THAN ZEROS OR
 13950        CMTHD2L       GREATER THAN ZEROS OR
 13951        CLIVESL       GREATER THAN ZEROS OR
 13952        CPAYEEL       GREATER THAN ZEROS OR
 13953        CFORCEL       GREATER THAN ZEROS OR
 13954        CBILCDL       GREATER THAN ZEROS OR
 13955        CCANREAL      GREATER THAN ZEROS
 13956            NEXT SENTENCE
 13957         ELSE
 13958            GO TO 2030-EDIT-COMPLETE.
 13959
 13960     IF CCANDT1L = ZEROS
 13961        AND (CMAINTI = 'C' OR 'K')
 13962        NEXT SENTENCE
 13963     ELSE
 13964        IF CCANDT1L      GREATER THAN ZEROS
 13965            MOVE AL-UNNON            TO CCANDT1A
 13966            IF CCANDT1I = SPACES
 13967               MOVE LOW-VALUES       TO WS-CONVERTED-CANDT1
 13968            ELSE
 13969               MOVE CCANDT1I            TO DEEDIT-FIELD
 13970               PERFORM 8600-DEEDIT
 13971               IF DEEDIT-FIELD-V0   NUMERIC
 13972                  MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 13973                  MOVE 4                TO DC-OPTION-CODE
 13974                  PERFORM 9700-DATE-LINK
 13975                  IF NO-CONVERSION-ERROR
 13976                     MOVE DC-BIN-DATE-1    TO WS-CONVERTED-CANDT1
 13977                  ELSE
 13978                      MOVE -1        TO CCANDT1L
 13979                      MOVE ER-2227   TO EMI-ERROR
 13980                      MOVE AL-UNBON  TO CCANDT1A
 13981                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13982               ELSE
 13983                  MOVE -1         TO CCANDT1L
 13984                  MOVE ER-2223    TO EMI-ERROR
 13985                  MOVE AL-UNBON   TO CCANDT1A
 13986                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13987        ELSE
 13988            IF CREFND1L GREATER THAN ZEROS
 13989               MOVE -1             TO CCANDT1L
 13990               MOVE ER-2222        TO EMI-ERROR
 13991               MOVE AL-UNBOF       TO CCANDT1A
 13992               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13993
 13994     IF CREFND1L = ZEROS
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 257
* EL6311.cbl
 13995        AND (CMAINTI = 'C' OR 'K')
 13996         NEXT SENTENCE
 13997     ELSE
 13998         IF CREFND1L NOT = ZEROS
 13999            MOVE AL-UNNON        TO CREFND1A
 14000
 14001* EXEC CICS BIF DEEDIT
 14002*               FIELD  (CREFND1I)
 14003*               LENGTH (11)
 14004*           END-EXEC
 14005     MOVE 11
 14006       TO DFHEIV11
 14007*    MOVE '@"L                   #   #00012576' TO DFHEIV0
 14008     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 14009     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14010     MOVE X'2020233030303132353736' TO DFHEIV0(25:11)
 14011     CALL 'kxdfhei1' USING DFHEIV0,
 14012           CREFND1I,
 14013           DFHEIV11
 14014     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14015            MOVE CREFND1I        TO WS-CREFND1
 14016*           MOVE CREFND1I        TO DEEDIT-FIELD-X11
 14017*           PERFORM 8600-DEEDIT
 14018*           MOVE DEEDIT-FIELD-V2 TO WS-CREFND1
 14019            IF WS-CREFND1  = ZEROS
 14020               AND CMAINTI = 'A'
 14021             MOVE ER-2437        TO EMI-ERROR
 14022             MOVE -1             TO CREFND1L
 14023             MOVE AL-UNBON       TO CREFND1A
 14024             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14025
 14026     IF CCANREAL > +0
 14027        MOVE AL-UANON            TO CCANREAA
 14028        IF CCANREAI = 'R' OR ' '
 14029           CONTINUE
 14030        ELSE
 14031           MOVE ER-9841        TO EMI-ERROR
 14032           MOVE -1             TO CCANREAL
 14033           MOVE AL-UABON       TO CCANREAA
 14034           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14035        END-IF
 14036     END-IF
 14037     IF CMTHD1L EQUAL +0
 14038        NEXT SENTENCE
 14039     ELSE
 14040        IF CMTHD1L NOT = +0
 14041           MOVE AL-UNNON        TO CMTHD1A
 14042           IF CMTHD1I EQUAL '1' OR '2' OR '3' OR '4'
 14043                         OR '5' OR '6' OR '8' OR '9'
 14044                         OR 'R' OR ' '
 14045              NEXT SENTENCE
 14046           ELSE
 14047              MOVE ER-0582        TO EMI-ERROR
 14048              MOVE -1             TO CMTHD1L
 14049              MOVE AL-UNBON       TO CMTHD1A
 14050              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14051
 14052     IF CCANDT2L = ZEROS
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 258
* EL6311.cbl
 14053        AND (CMAINTI = 'C' OR 'K')
 14054         NEXT SENTENCE
 14055     ELSE
 14056         IF CCANDT2L  GREATER THAN ZEROS
 14057             MOVE AL-UNNON       TO CCANDT2A
 14058             IF CCANDT2I = SPACES
 14059                MOVE LOW-VALUES  TO WS-CONVERTED-CANDT2
 14060             ELSE
 14061                MOVE CCANDT2I       TO DEEDIT-FIELD
 14062                PERFORM 8600-DEEDIT
 14063                IF DEEDIT-FIELD-V0   NUMERIC
 14064                   MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 14065                   MOVE 4                TO DC-OPTION-CODE
 14066                   PERFORM 9700-DATE-LINK
 14067                   IF NO-CONVERSION-ERROR
 14068                      MOVE DC-BIN-DATE-1    TO WS-CONVERTED-CANDT2
 14069                   ELSE
 14070                      MOVE -1       TO CCANDT2L
 14071                      MOVE ER-2227  TO EMI-ERROR
 14072                      MOVE AL-UNBON TO CCANDT2A
 14073                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14074                ELSE
 14075                   MOVE -1         TO CCANDT2L
 14076                   MOVE ER-2223    TO EMI-ERROR
 14077                   MOVE AL-UNBON   TO CCANDT2A
 14078                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14079         ELSE
 14080            IF CREFND2L GREATER THAN ZEROS
 14081               MOVE -1             TO CCANDT2L
 14082               MOVE ER-2222        TO EMI-ERROR
 14083               MOVE AL-UNBOF       TO CCANDT2A
 14084               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14085
 14086     IF CREFND2L = ZEROS
 14087        AND (CMAINTI = 'C' OR 'K')
 14088         NEXT SENTENCE
 14089     ELSE
 14090         IF CREFND2L NOT = ZEROS
 14091            MOVE AL-UNNON        TO CREFND2A
 14092
 14093* EXEC CICS BIF DEEDIT
 14094*               FIELD  (CREFND2I)
 14095*               LENGTH (11)
 14096*           END-EXEC
 14097     MOVE 11
 14098       TO DFHEIV11
 14099*    MOVE '@"L                   #   #00012657' TO DFHEIV0
 14100     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 14101     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14102     MOVE X'2020233030303132363537' TO DFHEIV0(25:11)
 14103     CALL 'kxdfhei1' USING DFHEIV0,
 14104           CREFND2I,
 14105           DFHEIV11
 14106     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14107            MOVE CREFND2I        TO WS-CREFND2
 14108*           MOVE CREFND2I        TO DEEDIT-FIELD-X11
 14109*           PERFORM 8600-DEEDIT
 14110*           MOVE DEEDIT-FIELD-V2 TO WS-CREFND2
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 259
* EL6311.cbl
 14111            IF WS-CREFND2  = ZEROS
 14112               AND CMAINTI = 'A'
 14113             MOVE ER-2437        TO EMI-ERROR
 14114             MOVE -1             TO CREFND2L
 14115             MOVE AL-UNBON       TO CREFND2A
 14116             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14117
 14118     IF CMTHD2L EQUAL +0
 14119        NEXT SENTENCE
 14120     ELSE
 14121        IF CMTHD2L NOT = +0
 14122           MOVE AL-UNNON        TO CMTHD2A
 14123           IF CMTHD2I EQUAL '1' OR '2' OR '3' OR '4'
 14124                         OR '5' OR '6' OR '8' OR '9'
 14125                         OR ' ' OR 'R'
 14126              NEXT SENTENCE
 14127           ELSE
 14128              MOVE ER-0582        TO EMI-ERROR
 14129              MOVE -1             TO CMTHD2L
 14130              MOVE AL-UNBON       TO CMTHD2A
 14131              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14132
 14133     IF CLIVESL GREATER THAN ZEROS
 14134         MOVE CLIVESI            TO DEEDIT-FIELD
 14135         PERFORM 8600-DEEDIT
 14136         IF DEEDIT-FIELD-V0 NUMERIC
 14137             MOVE DEEDIT-FIELD-V0 TO WS-CLIVES
 14138             MOVE AL-UNNON       TO CLIVESA
 14139         ELSE
 14140             MOVE -1             TO CLIVESL
 14141             MOVE AL-UNBON       TO CLIVESA
 14142             MOVE ER-2223        TO EMI-ERROR
 14143             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14144
 14145     IF CFORCEL  NOT = ZEROS
 14146         IF FORCE-CAP
 14147            MOVE AL-UANON            TO CFORCEA
 14148         ELSE
 14149            MOVE ER-2945             TO EMI-ERROR
 14150            MOVE AL-UABON            TO CFORCEA
 14151            MOVE -1                  TO CFORCEL
 14152            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14153
 14154     IF CPAYEEL GREATER THAN ZEROS
 14155        MOVE AL-UANON            TO CPAYEEA.
 14156
 14157     IF CBILCDL NOT = ZEROS
 14158        IF CBILCDI NOT = ' ' AND 'H' AND 'R' AND 'L'
 14159                             AND 'A' AND 'B' AND 'E'
 14160           MOVE ER-2225              TO EMI-ERROR
 14161           MOVE AL-UABON             TO CBILCDA
 14162           MOVE -1                   TO CBILCDL
 14163           MOVE  1                   TO SET-CURSOR-SW
 14164           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14165        ELSE
 14166           MOVE AL-UANON             TO CBILCDA.
 14167
 14168 2030-EDIT-COMPLETE.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 260
* EL6311.cbl
 14169     IF EMI-ERROR = ZEROS
 14170         NEXT SENTENCE
 14171     ELSE
 14172         GO TO 8200-SEND-DATAONLY.
 14173
 14174     IF CMAINTI = 'A'
 14175        GO TO 2200-ADD-CANCEL-ROUTINE.
 14176
 14177     IF CMAINTI = 'C'
 14178        GO TO 2300-CHANGE-CANCEL-ROUTINE.
 14179
 14180     GO TO 2900-REWRITE-CAN-CERT-KEY.
 14181
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 261
* EL6311.cbl
 14183
 14184******************************************************************
 14185*                                                                *
 14186*                   S H O W   C A N C E L                        *
 14187*                                                                *
 14188******************************************************************
 14189
 14190 2100-SHOW-REQUEST.
 14191     MOVE 'S'                    TO PI-MAINT-FUNCTION.
 14192
 14193     IF CCERTNOL = ZEROS AND CEFFDTL = ZEROS
 14194        MOVE -1                  TO CMAINTL
 14195        GO TO 8200-SEND-DATAONLY.
 14196
 14197     MOVE CCERTNOI            TO WS-NEW-PRIME.
 14198
 14199     IF CSUFIXL NOT = ZEROS
 14200        MOVE CSUFIXI          TO WS-NEW-SUFFIX
 14201       ELSE
 14202        MOVE SPACE            TO WS-NEW-SUFFIX.
 14203
 14204     MOVE CEFFDTI                TO DEEDIT-FIELD.
 14205     PERFORM 8600-DEEDIT.
 14206     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 14207     MOVE '4'                    TO DC-OPTION-CODE.
 14208     PERFORM 9700-DATE-LINK.
 14209     IF DATE-CONVERSION-ERROR
 14210        MOVE ER-0348             TO EMI-ERROR
 14211        MOVE -1                  TO CEFFDTL
 14212        MOVE AL-UABON            TO CEFFDTA
 14213        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14214        GO TO 8200-SEND-DATAONLY
 14215     ELSE
 14216        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 14217        MOVE AL-UANON            TO CEFFDTA
 14218        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 14219
 14220     MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
 14221
 14222     IF (ERPNDB-CERT-NO     NOT = WS-NEW-CERT-NO)      OR
 14223        (ERPNDB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT)
 14224        MOVE 'Y'                    TO WS-SHOW-SW
 14225        IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
 14226           GO TO 4100-BROWSE-PRIMARY-FORWARD
 14227        ELSE
 14228           IF PI-FILE-BROWSE
 14229              GO TO 4300-BROWSE-FILE-FORWARD
 14230           ELSE
 14231              IF PI-CSR-BROWSE
 14232                 GO TO 4200-BROWSE-CSR-FORWARD
 14233              ELSE
 14234                 GO TO 4000-BROWSE-DETAIL-FORWARD
 14235     ELSE
 14236        GO TO 3900-RE-DISPLAY-RECORD.
 14237
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 262
* EL6311.cbl
 14239
 14240
 14241******************************************************************
 14242*                                                                *
 14243*            A D D   C A N C E L   R O U T I N E                 *
 14244*                                                                *
 14245******************************************************************
 14246
 14247 2200-ADD-CANCEL-ROUTINE.
 14248     MOVE 'A'                    TO PI-MAINT-FUNCTION.
 14249
 14250
 14251* EXEC CICS GETMAIN
 14252*        SET     (ADDRESS OF PENDING-BUSINESS)
 14253*        LENGTH  (ERPNDB-RECORD-LENGTH)
 14254*    END-EXEC.
 14255*    MOVE '," L                  $   #00012804' TO DFHEIV0
 14256     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 14257     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14258     MOVE X'2020233030303132383034' TO DFHEIV0(25:11)
 14259     CALL 'kxdfhei1' USING DFHEIV0,
 14260           DFHEIV20,
 14261           ERPNDB-RECORD-LENGTH,
 14262           DFHEIV99
 14263     SET ADDRESS OF PENDING-BUSINESS TO
 14264         DFHEIV20
 14265     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14266
 14267
 14268
 14269* EXEC CICS HANDLE CONDITION
 14270*         NOTFND    (2280-BATCH-HDR-NOT-FOUND)
 14271*    END-EXEC.
 14272*    MOVE '"$I                   ! 3 #00012809' TO DFHEIV0
 14273     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14274     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14275     MOVE X'3320233030303132383039' TO DFHEIV0(25:11)
 14276     CALL 'kxdfhei1' USING DFHEIV0
 14277     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14278
 14279
 14280     MOVE PI-PREV-KEY            TO ERPNDB-KEY
 14281     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 14282     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 14283
 14284
 14285* EXEC CICS READ
 14286*        INTO    (PENDING-BUSINESS)
 14287*        DATASET (FILE-ID-ERPNDB)
 14288*        RIDFLD  (ERPNDB-KEY)
 14289*    END-EXEC.
 14290     MOVE LENGTH OF
 14291      PENDING-BUSINESS
 14292       TO DFHEIV11
 14293*    MOVE '&"IL       E          (   #00012817' TO DFHEIV0
 14294     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 14295     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14296     MOVE X'2020233030303132383137' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 263
* EL6311.cbl
 14297     CALL 'kxdfhei1' USING DFHEIV0,
 14298           FILE-ID-ERPNDB,
 14299           PENDING-BUSINESS,
 14300           DFHEIV11,
 14301           ERPNDB-KEY,
 14302           DFHEIV99,
 14303           DFHEIV99,
 14304           DFHEIV99
 14305     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14306
 14307
 14308     MOVE PB-CSR-ID              TO WS-BATCH-CSR-ID.
 14309
 14310     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 14311     ADD +1                      TO WS-B-HIGHEST-SEQ-NO.
 14312     MOVE PB-CREDIT-SELECT-DT    TO WS-CREDIT-SELECT-DT.
 14313     MOVE SPACES                 TO PENDING-BUSINESS.
 14314     MOVE 'PB'                   TO PB-RECORD-ID.
 14315     MOVE PI-PREV-KEY            TO PB-CONTROL-PRIMARY.
 14316     MOVE PI-PREV-ALT-KEY        TO PB-CONTROL-BY-ACCOUNT.
 14317     MOVE SPACES                 TO PB-CERT-SFX.
 14318     MOVE WS-B-HIGHEST-SEQ-NO    TO PB-BATCH-SEQ-NO.
 14319     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
 14320                                    PB-ALT-CHG-SEQ-NO.
 14321
 14322     MOVE WS-CONVERTED-EFFDT     TO PB-CERT-EFF-DT.
 14323     MOVE CCERTNOI               TO PB-CERT-PRIME.
 14324     MOVE '2'                    TO PB-RECORD-TYPE.
 14325
 14326     MOVE PI-COMPANY-CD          TO PB-COMPANY-CD.
 14327     MOVE PI-COMPANY-ID          TO PB-COMPANY-ID.
 14328
 14329
 14330     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
 14331                                    PB-ALT-CHG-SEQ-NO
 14332                                    PB-C-LF-REF-CALC
 14333                                    PB-C-AH-REF-CALC
 14334                                    PB-C-LF-RFND-CLP
 14335                                    PB-C-AH-RFND-CLP
 14336                                    PB-CI-INSURED-AGE
 14337                                    PB-CI-LF-TERM
 14338                                    PB-CI-AH-TERM
 14339                                    PB-CI-LF-BENEFIT-CD
 14340                                    PB-CI-LF-BENEFIT-AMT
 14341                                    PB-CI-LF-ALT-BENEFIT-AMT
 14342                                    PB-CI-LF-PREMIUM-AMT
 14343                                    PB-CI-LF-ALT-PREMIUM-AMT
 14344                                    PB-CI-AH-BENEFIT-CD
 14345                                    PB-CI-AH-BENEFIT-AMT
 14346                                    PB-CI-AH-PREMIUM-AMT
 14347                                    PB-CI-PAY-FREQUENCY
 14348                                    PB-CI-LOAN-APR
 14349                                    PB-CI-LOAN-TERM
 14350                                    PB-CI-LIFE-COMMISSION
 14351                                    PB-CI-AH-COMMISSION
 14352                                    PB-CI-CURR-SEQ
 14353                                    PB-CI-AH-CANCEL-AMT
 14354                                    PB-CI-LF-CANCEL-AMT
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 264
* EL6311.cbl
 14355                                    PB-CI-RATE-DEV-PCT-LF
 14356                                    PB-CI-RATE-DEV-PCT-AH
 14357                                    PB-CI-EXTENTION-DAYS
 14358                                    PB-CI-TERM-IN-DAYS
 14359                                    PB-CI-LIVES
 14360                                    PB-CI-LF-CRIT-PER
 14361                                    PB-CI-AH-CRIT-PER
 14362                                    PB-C-LF-REM-TERM
 14363                                    PB-C-AH-REM-TERM
 14364                                    PB-CHG-COUNT
 14365                                    PB-LF-BILLED-AMTS
 14366                                    PB-AH-BILLED-AMTS
 14367                                    PB-C-NH-INT-ON-REFS
 14368*                                   PB-C-MICROFILM-NO
 14369                                    PB-CALC-TOLERANCE.
 14370
 14371     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
 14372                                    PB-CI-AH-SETTLEMENT-DT
 14373                                    PB-CI-DEATH-DT
 14374                                    PB-CI-LF-PRIOR-CANCEL-DT
 14375                                    PB-CI-AH-PRIOR-CANCEL-DT
 14376                                    PB-CI-ENTRY-DT
 14377                                    PB-CI-LF-EXPIRE-DT
 14378                                    PB-CI-AH-EXPIRE-DT
 14379                                    PB-CI-LOAN-1ST-PMT-DT
 14380                                    PB-C-LF-CANCEL-DT
 14381                                    PB-C-AH-CANCEL-DT
 14382                                    PB-CREDIT-ACCEPT-DT
 14383                                    PB-BILLED-DT
 14384                                    PB-ACCT-EFF-DT
 14385                                    PB-ACCT-EXP-DT.
 14386
 14387     MOVE 'X'                    TO PB-FATAL-FLAG.
 14388
 14389     MOVE WS-CREDIT-SELECT-DT    TO PB-CREDIT-SELECT-DT.
 14390
 14391     IF CSUFIXL     GREATER THAN ZEROS
 14392        MOVE CSUFIXI             TO PB-CERT-SFX.
 14393
 14394*    IF CMICRNOL  GREATER  ZEROS
 14395*        IF CMICRNOI  NUMERIC
 14396*            MOVE CMICRNOI       TO  PB-C-MICROFILM-NO
 14397*            MOVE AL-UNNON       TO  CMICRNOA
 14398*        ELSE
 14399*            MOVE -1             TO  CMICRNOL
 14400*            MOVE AL-UNBON       TO  CMICRNOA
 14401*            MOVE ER-2701        TO  EMI-ERROR
 14402*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14403
 14404     IF CLSTNML     GREATER THAN ZEROS
 14405        MOVE CLSTNMI             TO PB-C-LAST-NAME.
 14406
 14407     IF CCANREAL > ZEROS
 14408        MOVE CCANREAI            TO PB-C-CANCEL-REASON
 14409     END-IF
 14410     IF CPCYNL > ZEROS
 14411        MOVE CPCYNI              TO PB-C-POST-CARD-IND
 14412     END-IF
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 265
* EL6311.cbl
 14413     IF CCANDT1L    GREATER THAN ZEROS
 14414        MOVE WS-CONVERTED-CANDT1 TO PB-C-LF-CANCEL-DT.
 14415
 14416     IF CCANDT2L    GREATER THAN ZEROS
 14417        MOVE WS-CONVERTED-CANDT2 TO PB-C-AH-CANCEL-DT.
 14418
 14419     IF CMTHD1L    GREATER THAN +0
 14420        MOVE CMTHD1I             TO PB-C-LF-REFUND-OVERRIDE.
 14421
 14422     IF CMTHD2L    GREATER THAN +0
 14423        MOVE CMTHD2I             TO PB-C-AH-REFUND-OVERRIDE.
 14424
 14425     IF CREFND1L    GREATER THAN ZEROS
 14426        ADD  WS-CREFND1          TO WS-B-LF-CAN-PRM-ENTERED
 14427        MOVE WS-CREFND1          TO PB-C-LF-CANCEL-AMT
 14428     ELSE
 14429        MOVE ZEROS               TO PB-C-LF-CANCEL-AMT.
 14430
 14431     IF CREFND2L    GREATER THAN ZEROS
 14432        ADD  WS-CREFND2          TO WS-B-AH-CAN-PRM-ENTERED
 14433        MOVE WS-CREFND2          TO PB-C-AH-CANCEL-AMT
 14434     ELSE
 14435        MOVE ZEROS               TO PB-C-AH-CANCEL-AMT.
 14436
 14437     IF CLIVESL     GREATER THAN ZEROS
 14438        MOVE WS-CLIVES           TO PB-C-LIVES
 14439     ELSE
 14440        MOVE ZEROS               TO PB-C-LIVES.
 14441
 14442     IF CPAYEEL     GREATER THAN ZEROS
 14443        MOVE CPAYEEI             TO PB-C-PAYEE-CODE.
 14444
 14445     IF CFORCEL     GREATER THAN ZEROS
 14446        MOVE CFORCEI             TO PB-FORCE-CODE.
 14447
 14448     IF CBILCDL     GREATER THAN ZEROS
 14449        MOVE CBILCDI             TO PB-RECORD-BILL.
 14450
 14451*    MOVE WS-REFERENCE           TO PB-C-REFERENCE.
 14452
 14453 2260-WRITE-PB-RECORD.
 14454     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY
 14455                                    PB-INPUT-BY.
 14456     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 14457     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT
 14458                                    PB-INPUT-DT.
 14459
 14460     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 14461     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 14462                                    PB-CONTROL-BY-ORIG-BATCH.
 14463
 14464     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 14465     MOVE WS-BATCH-CSR-ID        TO PB-CSR-ID.
 14466     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 14467     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 14468     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 14469
 14470     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 266
* EL6311.cbl
 14471
 14472     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 14473
 14474     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 14475     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 14476     MOVE PB-SV-STATE            TO PI-SV-STATE.
 14477
 14478     ADD PB-C-LF-REF-CALC        TO WS-B-LF-CAN-PRM-COMPUTED.
 14479     ADD PB-C-AH-REF-CALC        TO WS-B-AH-CAN-PRM-COMPUTED.
 14480
 14481 2275-WRITE-PENDING-BUSINESS.
 14482     MOVE 'A'                    TO JP-RECORD-TYPE.
 14483     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 14484     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 14485     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 14486
 14487
 14488* EXEC CICS HANDLE CONDITION
 14489*        DUPREC (2290-DUPLICATE-ALT-INDEX)
 14490*    END-EXEC.
 14491*    MOVE '"$%                   ! 4 #00013002' TO DFHEIV0
 14492     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 14493     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14494     MOVE X'3420233030303133303032' TO DFHEIV0(25:11)
 14495     CALL 'kxdfhei1' USING DFHEIV0
 14496     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14497
 14498
 14499
 14500* EXEC CICS WRITE
 14501*        DATASET (FILE-ID-ERPNDB)
 14502*        FROM    (PENDING-BUSINESS)
 14503*        RIDFLD  (PB-CONTROL-PRIMARY)
 14504*    END-EXEC.
 14505     MOVE LENGTH OF
 14506      PENDING-BUSINESS
 14507       TO DFHEIV11
 14508*    MOVE '&$ L                  ''   #00013006' TO DFHEIV0
 14509     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 14510     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14511     MOVE X'2020233030303133303036' TO DFHEIV0(25:11)
 14512     CALL 'kxdfhei1' USING DFHEIV0,
 14513           FILE-ID-ERPNDB,
 14514           PENDING-BUSINESS,
 14515           DFHEIV11,
 14516           PB-CONTROL-PRIMARY,
 14517           DFHEIV99,
 14518           DFHEIV99
 14519     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14520
 14521
 14522     ADD +1                      TO WS-B-CANCEL-CNT-ENTERED.
 14523
 14524     PERFORM 8400-LOG-JOURNAL-RECORD.
 14525
 14526******************************************************************
 14527*       A D D  O R I G I N A L  C E R T  I N F O                 *
 14528******************************************************************
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 267
* EL6311.cbl
 14529
 14530     display ' made it to add orig CANCEL cert '
 14531     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 14532     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 14533     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 14534     MOVE PB-SV-STATE            TO ELCERT-STATE.
 14535
 14536
 14537* EXEC CICS READ
 14538*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 14539*        DATASET (FILE-ID-ELCERT)
 14540*        RIDFLD  (ELCERT-KEY)
 14541*        RESP    (WS-RESPONSE)
 14542*    END-EXEC.
 14543*    MOVE '&"S        E          (  N#00013026' TO DFHEIV0
 14544     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14545     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14546     MOVE X'204E233030303133303236' TO DFHEIV0(25:11)
 14547     CALL 'kxdfhei1' USING DFHEIV0,
 14548           FILE-ID-ELCERT,
 14549           DFHEIV20,
 14550           DFHEIV99,
 14551           ELCERT-KEY,
 14552           DFHEIV99,
 14553           DFHEIV99,
 14554           DFHEIV99
 14555     SET ADDRESS OF CERTIFICATE-MASTER TO
 14556         DFHEIV20
 14557     MOVE EIBRESP  TO WS-RESPONSE
 14558     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14559
 14560
 14561     IF NOT RESP-NORMAL
 14562        GO TO 2276-BYPASS-CRTO
 14563     END-IF
 14564
 14565     MOVE ELCERT-KEY             TO ERMAIL-KEY
 14566     MOVE ' '                    TO WS-ERMAIL-SW
 14567
 14568
 14569* EXEC CICS READ
 14570*       DATASET   (FILE-ID-ERMAIL)
 14571*       SET       (ADDRESS OF MAILING-DATA)
 14572*       RIDFLD    (ERMAIL-KEY)
 14573*       RESP      (WS-RESPONSE)
 14574*    END-EXEC
 14575*    MOVE '&"S        E          (  N#00013040' TO DFHEIV0
 14576     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14577     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14578     MOVE X'204E233030303133303430' TO DFHEIV0(25:11)
 14579     CALL 'kxdfhei1' USING DFHEIV0,
 14580           FILE-ID-ERMAIL,
 14581           DFHEIV20,
 14582           DFHEIV99,
 14583           ERMAIL-KEY,
 14584           DFHEIV99,
 14585           DFHEIV99,
 14586           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 268
* EL6311.cbl
 14587     SET ADDRESS OF MAILING-DATA TO
 14588         DFHEIV20
 14589     MOVE EIBRESP  TO WS-RESPONSE
 14590     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14591
 14592     IF RESP-NORMAL
 14593        SET ERMAIL-FOUND TO TRUE
 14594     END-IF
 14595
 14596     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 14597
 14598     MOVE SPACES                 TO ORIGINAL-CERTIFICATE
 14599     MOVE 'OC'                   TO OC-RECORD-ID
 14600     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 14601                                 TO OC-CONTROL-PRIMARY (1:33)
 14602     MOVE 'I'                    TO OC-RECORD-TYPE
 14603     MOVE +4096                  TO OC-KEY-SEQ-NO
 14604     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
 14605     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
 14606     MOVE WS-CURRENT-BIN-DT      TO OC-LAST-MAINT-DT
 14607
 14608     MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 14609     MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 14610     MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 14611     MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 14612     MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 14613     MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 14614     MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 14615     MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 14616     MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
 14617     MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
 14618     MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
 14619     MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
 14620     MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
 14621     MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
 14622     MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
 14623     MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
 14624     MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
 14625     MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
 14626     MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 14627     MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
 14628     MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
 14629     MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
 14630     MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
 14631     MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
 14632     MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
 14633     MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 14634     MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
 14635     MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
 14636     MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 14637     MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 14638     MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 14639     MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 14640
 14641     IF ERMAIL-FOUND
 14642        MOVE MA-CRED-BENE-NAME   TO OC-CRED-BENE-NAME
 14643     END-IF
 14644     IF NOT CERT-TRL-REC-NOT-FOUND
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 269
* EL6311.cbl
 14645        MOVE CS-INS-AGE-DEFAULT-FLAG TO
 14646                           OC-INS-AGE-DEFAULT-FLAG
 14647        MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 14648                           OC-JNT-AGE-DEFAULT-FLAG
 14649     END-IF
 14650     MOVE LOW-VALUES             TO OC-ENDORSEMENT-PROCESSED-DT
 14651     .
 14652 2275-WRITE-ELCRTO.
 14653
 14654
 14655* EXEC CICS WRITE
 14656*       DATASET   ('ELCRTO')
 14657*       FROM      (ORIGINAL-CERTIFICATE)
 14658*       RIDFLD    (OC-CONTROL-PRIMARY)
 14659*       RESP      (WS-RESPONSE)
 14660*    END-EXEC
 14661     MOVE LENGTH OF
 14662      ORIGINAL-CERTIFICATE
 14663       TO DFHEIV11
 14664     MOVE 'ELCRTO' TO DFHEIV1
 14665*    MOVE '&$ L                  ''  N#00013109' TO DFHEIV0
 14666     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 14667     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14668     MOVE X'204E233030303133313039' TO DFHEIV0(25:11)
 14669     CALL 'kxdfhei1' USING DFHEIV0,
 14670           DFHEIV1,
 14671           ORIGINAL-CERTIFICATE,
 14672           DFHEIV11,
 14673           OC-CONTROL-PRIMARY,
 14674           DFHEIV99,
 14675           DFHEIV99
 14676     MOVE EIBRESP  TO WS-RESPONSE
 14677     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14678
 14679     display ' just wrote 2275 ' ws-response
 14680     IF RESP-DUPKEY
 14681        SUBTRACT +1              FROM OC-KEY-SEQ-NO
 14682        GO TO 2275-WRITE-ELCRTO
 14683     ELSE
 14684        IF NOT RESP-NORMAL
 14685           MOVE -1               TO BMAINTL
 14686           MOVE ER-7450          TO EMI-ERROR
 14687           PERFORM 9900-ERROR-FORMAT
 14688                                 THRU 9900-EXIT
 14689           GO TO 8200-SEND-DATAONLY
 14690        END-IF
 14691     END-IF.
 14692
 14693 2276-BYPASS-CRTO.
 14694******************************************************************
 14695*       U P D A T E   T H E   B A T C H   H E A D E R            *
 14696******************************************************************
 14697
 14698
 14699* EXEC CICS READ
 14700*        INTO    (PENDING-BUSINESS)
 14701*        DATASET (FILE-ID-ERPNDB)
 14702*        RIDFLD  (ERPNDB-KEY)
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 270
* EL6311.cbl
 14703*        UPDATE
 14704*    END-EXEC.
 14705     MOVE LENGTH OF
 14706      PENDING-BUSINESS
 14707       TO DFHEIV11
 14708*    MOVE '&"IL       EU         (   #00013135' TO DFHEIV0
 14709     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 14710     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14711     MOVE X'2020233030303133313335' TO DFHEIV0(25:11)
 14712     CALL 'kxdfhei1' USING DFHEIV0,
 14713           FILE-ID-ERPNDB,
 14714           PENDING-BUSINESS,
 14715           DFHEIV11,
 14716           ERPNDB-KEY,
 14717           DFHEIV99,
 14718           DFHEIV99,
 14719           DFHEIV99
 14720     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14721
 14722
 14723     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 14724     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 14725     MOVE 'B'                    TO JP-RECORD-TYPE.
 14726     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 14727
 14728     PERFORM 8400-LOG-JOURNAL-RECORD.
 14729
 14730     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 14731
 14732
 14733* EXEC CICS REWRITE
 14734*        DATASET (FILE-ID-ERPNDB)
 14735*        FROM    (PENDING-BUSINESS)
 14736*    END-EXEC.
 14737     MOVE LENGTH OF
 14738      PENDING-BUSINESS
 14739       TO DFHEIV11
 14740*    MOVE '&& L                  %   #00013151' TO DFHEIV0
 14741     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 14742     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 14743     MOVE X'2020233030303133313531' TO DFHEIV0(25:11)
 14744     CALL 'kxdfhei1' USING DFHEIV0,
 14745           FILE-ID-ERPNDB,
 14746           PENDING-BUSINESS,
 14747           DFHEIV11,
 14748           DFHEIV99
 14749     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14750
 14751
 14752     MOVE 'C'                    TO JP-RECORD-TYPE.
 14753     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 14754
 14755     PERFORM 8400-LOG-JOURNAL-RECORD.
 14756
 14757     IF WS-ERRORS-PRESENT
 14758        GO TO 3900-RE-DISPLAY-RECORD.
 14759
 14760     MOVE ZEROS                  TO EMI-ERROR.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 271
* EL6311.cbl
 14761     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14762     MOVE LOW-VALUES             TO EL631CI.
 14763     MOVE  -1                    TO CMAINTL.
 14764     GO TO 8100-SEND-INITIAL-MAP.
 14765
 14766 2280-BATCH-HDR-NOT-FOUND.
 14767     MOVE -1                     TO BMAINTL.
 14768     MOVE ER-7450                TO EMI-ERROR.
 14769     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14770     GO TO 8200-SEND-DATAONLY.
 14771
 14772 2290-DUPLICATE-ALT-INDEX.
 14773
 14774******************************************************************
 14775*                                                                *
 14776*      IF THE PB-B-HIGHEST-SEQ-NO WAS NOT UPDATED IN THE DATA    *
 14777*         ENTRY SESSION, ADD +1 TO THE HIGHEST SEQUENCE NUMBER   *
 14778*         AND ATTEMPT TO WRITE THE RECORD AGAIN. REPEAT THIS     *
 14779*         50 TIMES.  IF DUPREC CONDITION IS STILL ENCOUNTERED    *
 14780*         AFTER 50 TIMES, ASSUME THE DUPLICATE RECORD WAS        *
 14781*         CAUSED BY A DUPLICATE ALTERNATE KEY.                   *
 14782*                                                                *
 14783******************************************************************
 14784
 14785     IF LCP-ONCTR-02 =  0
 14786         ADD 1 TO LCP-ONCTR-02
 14787        MOVE +0                  TO WS-SEQ-NO-COUNTER.
 14788
 14789     ADD +1                      TO WS-SEQ-NO-COUNTER.
 14790
 14791     IF  WS-SEQ-NO-COUNTER GREATER THAN +50
 14792         NEXT SENTENCE
 14793     ELSE
 14794         ADD +1 TO PB-BATCH-SEQ-NO
 14795                   PB-CSR-BATCH-SEQ-NO
 14796         MOVE PB-BATCH-SEQ-NO TO WS-B-HIGHEST-SEQ-NO
 14797         GO TO 2275-WRITE-PENDING-BUSINESS.
 14798
 14799     MOVE -1                     TO CCERTNOL.
 14800     MOVE AL-UABON               TO CCERTNOA.
 14801     MOVE AL-UNBON               TO CEFFDTA.
 14802
 14803     MOVE 1                      TO EMI-SUB
 14804                                    EMI-SWITCH1
 14805                                    EMI-SWITCH-AREA-1
 14806                                    EMI-SWITCH-AREA-2.
 14807
 14808     MOVE SPACES                 TO EMI-ERROR-LINES.
 14809
 14810
 14811* EXEC CICS SYNCPOINT ROLLBACK
 14812*    END-EXEC.
 14813*    MOVE '6"R                   !   #00013214' TO DFHEIV0
 14814     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 14815     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14816     MOVE X'2020233030303133323134' TO DFHEIV0(25:11)
 14817     CALL 'kxdfhei1' USING DFHEIV0
 14818     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 272
* EL6311.cbl
 14819
 14820
 14821     MOVE ER-2247                TO EMI-ERROR.
 14822     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14823     GO TO 8200-SEND-DATAONLY.
 14824
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 273
* EL6311.cbl
 14826
 14827******************************************************************
 14828*                                                                *
 14829*          C H A N G E   C A N C E L   R O U T I N E             *
 14830*                                                                *
 14831******************************************************************
 14832
 14833***************************************************************
 14834*                                                             *
 14835*     1. GETMAIN FOR PENDING BUSINESS RECORD.                 *
 14836*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
 14837*     3. GET THE RECORD TO BE UPDATED AND SEE IF IT HAS BEEN  *
 14838*              BILLED.  IF IT HAS THEN SAVE A COPY OF THE     *
 14839*              ZERO RECORD FOR CREATING REVERSAL ENTRIES.     *
 14840*     4. UPDATE THE RECORD WITH THE SCREEN DATA               *
 14841*     5. LINK TO THE EDIT ROUTINE.                            *
 14842*     6. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
 14843*     7. REDISPLAY SCREEN DATA WITH NEW DATA RETURNED FROM    *
 14844*              THE EDIT ROUTINE.                              *
 14845*     7. REWRITE THE NEW ISSUE                                *
 14846*     8. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
 14847*                                                             *
 14848***************************************************************
 14849 2300-CHANGE-CANCEL-ROUTINE.
 14850     MOVE 'C'                    TO PI-MAINT-FUNCTION.
 14851
 14852     IF CCHGL NOT = ZEROS
 14853        MOVE ER-2196             TO EMI-ERROR
 14854        MOVE AL-UABON            TO CMAINTA
 14855        MOVE -1                  TO CMAINTL
 14856        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14857        GO TO 8200-SEND-DATAONLY.
 14858
 14859     MOVE CCERTNOI               TO WS-NEW-PRIME.
 14860
 14861     IF CSUFIXL NOT = ZEROS
 14862        MOVE CSUFIXI             TO WS-NEW-SUFFIX
 14863     ELSE
 14864        MOVE SPACE               TO WS-NEW-SUFFIX.
 14865
 14866     MOVE CEFFDTI                TO DEEDIT-FIELD.
 14867     PERFORM 8600-DEEDIT.
 14868     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 14869     MOVE '4'                    TO DC-OPTION-CODE.
 14870
 14871     PERFORM 9700-DATE-LINK.
 14872
 14873     IF DATE-CONVERSION-ERROR
 14874        MOVE ER-0348             TO EMI-ERROR
 14875        MOVE -1                  TO CEFFDTL
 14876        MOVE AL-UABON            TO CEFFDTA
 14877        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14878        GO TO 8200-SEND-DATAONLY
 14879     ELSE
 14880        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 14881        MOVE AL-UANON            TO CEFFDTA
 14882        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 14883
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 274
* EL6311.cbl
 14884 2325-PROCESS-CANCEL-CHANGES.
 14885
 14886* EXEC CICS HANDLE CONDITION
 14887*         NOTFND    (2380-BATCH-HDR-NOT-FOUND)
 14888*    END-EXEC.
 14889*    MOVE '"$I                   ! 5 #00013281' TO DFHEIV0
 14890     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14891     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14892     MOVE X'3520233030303133323831' TO DFHEIV0(25:11)
 14893     CALL 'kxdfhei1' USING DFHEIV0
 14894     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14895
 14896
 14897     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 14898     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 14899     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 14900
 14901
 14902* EXEC CICS GETMAIN
 14903*        SET      (ADDRESS OF PENDING-BUSINESS)
 14904*        LENGTH   (ERPNDB-RECORD-LENGTH)
 14905*        INITIMG  (GETMAIN-SPACE)
 14906*     END-EXEC.
 14907*    MOVE ',"IL                  $   #00013289' TO DFHEIV0
 14908     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 14909     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14910     MOVE X'2020233030303133323839' TO DFHEIV0(25:11)
 14911     CALL 'kxdfhei1' USING DFHEIV0,
 14912           DFHEIV20,
 14913           ERPNDB-RECORD-LENGTH,
 14914           GETMAIN-SPACE
 14915     SET ADDRESS OF PENDING-BUSINESS TO
 14916         DFHEIV20
 14917     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14918
 14919
 14920
 14921* EXEC CICS READ
 14922*        INTO    (PENDING-BUSINESS)
 14923*        DATASET (FILE-ID-ERPNDB)
 14924*        RIDFLD  (ERPNDB-KEY)
 14925*    END-EXEC.
 14926     MOVE LENGTH OF
 14927      PENDING-BUSINESS
 14928       TO DFHEIV11
 14929*    MOVE '&"IL       E          (   #00013295' TO DFHEIV0
 14930     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 14931     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14932     MOVE X'2020233030303133323935' TO DFHEIV0(25:11)
 14933     CALL 'kxdfhei1' USING DFHEIV0,
 14934           FILE-ID-ERPNDB,
 14935           PENDING-BUSINESS,
 14936           DFHEIV11,
 14937           ERPNDB-KEY,
 14938           DFHEIV99,
 14939           DFHEIV99,
 14940           DFHEIV99
 14941     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 275
* EL6311.cbl
 14942
 14943
 14944     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 14945
 14946
 14947* EXEC CICS HANDLE CONDITION
 14948*         NOTFND     (2385-REC-NOT-FOUND)
 14949*    END-EXEC.
 14950*    MOVE '"$I                   ! 6 #00013303' TO DFHEIV0
 14951     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14952     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14953     MOVE X'3620233030303133333033' TO DFHEIV0(25:11)
 14954     CALL 'kxdfhei1' USING DFHEIV0
 14955     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14956
 14957
 14958**********************************************************
 14959*      DONT READ THE RECORD FOR UPDATE UNTIL             *
 14960*      AFTER THE CHANGE RECORD HAS BEEN CREATED.         *
 14961**********************************************************
 14962
 14963
 14964* EXEC CICS READ
 14965*        DATASET (FILE-ID-ERPNDB)
 14966*        INTO    (PENDING-BUSINESS)
 14967*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 14968*    END-EXEC.
 14969     MOVE LENGTH OF
 14970      PENDING-BUSINESS
 14971       TO DFHEIV11
 14972*    MOVE '&"IL       E          (   #00013312' TO DFHEIV0
 14973     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 14974     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14975     MOVE X'2020233030303133333132' TO DFHEIV0(25:11)
 14976     CALL 'kxdfhei1' USING DFHEIV0,
 14977           FILE-ID-ERPNDB,
 14978           PENDING-BUSINESS,
 14979           DFHEIV11,
 14980           PI-PREV-CONTROL-PRIMARY,
 14981           DFHEIV99,
 14982           DFHEIV99,
 14983           DFHEIV99
 14984     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14985
 14986
 14987********** DO NOT ALLOW CHANGES IF THRU A/R
 14988     IF BMAINTI = 'C'
 14989         IF PB-EL860-INTERNAL-PROCESS
 14990             MOVE ER-4005          TO EMI-ERROR
 14991             MOVE -1               TO BMAINTL
 14992             MOVE AL-UABON         TO BMAINTA
 14993             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14994             GO TO 8200-SEND-DATAONLY.
 14995**********
 14996
 14997     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 14998        MOVE -1                 TO CMAINTL
 14999        MOVE ER-2197            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 276
* EL6311.cbl
 15000        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15001        GO TO 8200-SEND-DATAONLY.
 15002
 15003     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 15004        MOVE ER-2196             TO EMI-ERROR
 15005        MOVE AL-UABON            TO CMAINTA
 15006        MOVE -1                  TO CMAINTL
 15007        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15008        GO TO 8200-SEND-DATAONLY.
 15009     MOVE ZEROS                  TO WS-SEQ-SAVE.
 15010
 15011     IF PB-BILLED-DT = LOW-VALUES AND
 15012        PB-CHG-COUNT = ZEROS
 15013        NEXT SENTENCE
 15014     ELSE
 15015        IF (CREFND1L GREATER THAN ZEROS AND
 15016            WS-CREFND1 NOT = PB-C-LF-CANCEL-AMT)
 15017           OR
 15018           (CREFND2L GREATER THAN ZEROS AND
 15019            WS-CREFND2 NOT = PB-C-AH-CANCEL-AMT)
 15020           PERFORM 2700-BUILD-CORRECTION-RECORD THRU 2799-EXIT.
 15021
 15022
 15023* EXEC CICS READ
 15024*        DATASET (FILE-ID-ERPNDB)
 15025*        INTO    (PENDING-BUSINESS)
 15026*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 15027*        UPDATE
 15028*    END-EXEC.
 15029     MOVE LENGTH OF
 15030      PENDING-BUSINESS
 15031       TO DFHEIV11
 15032*    MOVE '&"IL       EU         (   #00013353' TO DFHEIV0
 15033     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15034     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15035     MOVE X'2020233030303133333533' TO DFHEIV0(25:11)
 15036     CALL 'kxdfhei1' USING DFHEIV0,
 15037           FILE-ID-ERPNDB,
 15038           PENDING-BUSINESS,
 15039           DFHEIV11,
 15040           PI-PREV-CONTROL-PRIMARY,
 15041           DFHEIV99,
 15042           DFHEIV99,
 15043           DFHEIV99
 15044     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15045
 15046
 15047     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15048     MOVE 'B'                    TO JP-RECORD-TYPE
 15049     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15050     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15051
 15052     PERFORM 8400-LOG-JOURNAL-RECORD.
 15053
 15054     IF PB-BILLED-DT NOT = LOW-VALUES OR
 15055          PB-CHG-COUNT NOT = ZEROS
 15056        IF (CREFND1L GREATER THAN ZEROS AND
 15057            WS-CREFND1 NOT = PB-C-LF-CANCEL-AMT)
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 277
* EL6311.cbl
 15058           OR
 15059           (CREFND2L GREATER THAN ZEROS AND
 15060            WS-CREFND2 NOT = PB-C-AH-CANCEL-AMT)
 15061            ADD +1                      TO PB-CHG-COUNT
 15062            MOVE LOW-VALUES             TO PB-BILLED-DT.
 15063
 15064*    IF CMICRNOL  GREATER  ZEROS
 15065*        IF CMICRNOI  NUMERIC
 15066*            MOVE CMICRNOI       TO  PB-C-MICROFILM-NO
 15067*            MOVE AL-UNNON       TO  CMICRNOA
 15068*        ELSE
 15069*            MOVE -1             TO  CMICRNOL
 15070*            MOVE AL-UNBON       TO  CMICRNOA
 15071*            MOVE ER-2701        TO  EMI-ERROR
 15072*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15073
 15074     IF CSUFIXL GREATER THAN ZEROS
 15075        MOVE CSUFIXI             TO PB-CERT-SFX.
 15076
 15077     IF CLSTNML GREATER THAN ZEROS
 15078         MOVE CLSTNMI            TO PB-C-LAST-NAME.
 15079
 15080     IF CCANREAL > ZEROS
 15081        MOVE CCANREAI            TO PB-C-CANCEL-REASON
 15082     END-IF
 15083     IF CPCYNL > ZEROS
 15084        MOVE CPCYNI              TO PB-C-POST-CARD-IND
 15085     END-IF
 15086     IF CCANDT1L    GREATER THAN ZEROS
 15087        MOVE WS-CONVERTED-CANDT1 TO PB-C-LF-CANCEL-DT.
 15088
 15089     IF CCANDT2L    GREATER THAN ZEROS
 15090        MOVE WS-CONVERTED-CANDT2 TO PB-C-AH-CANCEL-DT.
 15091
 15092     IF CMTHD1L    GREATER THAN +0
 15093        MOVE CMTHD1I             TO PB-C-LF-REFUND-OVERRIDE.
 15094
 15095     IF CMTHD2L    GREATER THAN +0
 15096        MOVE CMTHD2I             TO PB-C-AH-REFUND-OVERRIDE.
 15097
 15098     IF CREFND1L    GREATER THAN ZEROS
 15099        SUBTRACT PB-C-LF-CANCEL-AMT FROM WS-B-LF-CAN-PRM-ENTERED
 15100        ADD  WS-CREFND1          TO WS-B-LF-CAN-PRM-ENTERED
 15101        MOVE WS-CREFND1          TO PB-C-LF-CANCEL-AMT
 15102        MOVE SPACE               TO PB-C-LF-CALC-REQ.
 15103
 15104     IF CREFND2L    GREATER THAN ZEROS
 15105        SUBTRACT PB-C-AH-CANCEL-AMT FROM WS-B-AH-CAN-PRM-ENTERED
 15106        ADD  WS-CREFND2          TO WS-B-AH-CAN-PRM-ENTERED
 15107        MOVE WS-CREFND2          TO PB-C-AH-CANCEL-AMT
 15108        MOVE SPACE               TO PB-C-AH-CALC-REQ.
 15109
 15110     IF CLIVESL     GREATER THAN ZEROS
 15111        MOVE WS-CLIVES           TO PB-C-LIVES.
 15112
 15113     IF CPAYEEL     GREATER THAN ZEROS
 15114        MOVE CPAYEEI             TO PB-C-PAYEE-CODE.
 15115
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 278
* EL6311.cbl
 15116     IF CFORCEL     GREATER THAN ZEROS
 15117        MOVE CFORCEI             TO PB-FORCE-CODE.
 15118
 15119     IF CBILCDL     GREATER THAN ZEROS
 15120        MOVE CBILCDI             TO PB-RECORD-BILL.
 15121
 15122 2360-REWRITE-PB-RECORD.
 15123     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 15124     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 15125     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT.
 15126     MOVE 'C'                    TO JP-RECORD-TYPE.
 15127     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15128     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15129     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15130
 15131     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 15132
 15133     SUBTRACT PB-C-LF-REF-CALC   FROM WS-B-LF-CAN-PRM-COMPUTED.
 15134     SUBTRACT PB-C-AH-REF-CALC   FROM WS-B-AH-CAN-PRM-COMPUTED.
 15135
 15136     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 15137
 15138     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 15139
 15140     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 15141     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 15142     MOVE PB-SV-STATE            TO PI-SV-STATE.
 15143
 15144     ADD PB-C-LF-REF-CALC        TO WS-B-LF-CAN-PRM-COMPUTED.
 15145     ADD PB-C-AH-REF-CALC        TO WS-B-AH-CAN-PRM-COMPUTED.
 15146
 15147 2375-REWRITE-PENDING-BUSINESS.
 15148     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15149     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15150     MOVE 'C'                    TO JP-RECORD-TYPE.
 15151     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15152
 15153
 15154* EXEC CICS REWRITE
 15155*        DATASET (FILE-ID-ERPNDB)
 15156*        FROM    (PENDING-BUSINESS)
 15157*    END-EXEC.
 15158     MOVE LENGTH OF
 15159      PENDING-BUSINESS
 15160       TO DFHEIV11
 15161*    MOVE '&& L                  %   #00013466' TO DFHEIV0
 15162     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15163     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15164     MOVE X'2020233030303133343636' TO DFHEIV0(25:11)
 15165     CALL 'kxdfhei1' USING DFHEIV0,
 15166           FILE-ID-ERPNDB,
 15167           PENDING-BUSINESS,
 15168           DFHEIV11,
 15169           DFHEIV99
 15170     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15171
 15172
 15173     PERFORM 8400-LOG-JOURNAL-RECORD.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 279
* EL6311.cbl
 15174
 15175******************************************************************
 15176*       U P D A T E   T H E   O R I G   C E R T   I N F O        *
 15177******************************************************************
 15178
 15179     display ' made it to update orig cancel cert '
 15180
 15181     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 15182     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 15183     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 15184     MOVE PB-SV-STATE            TO ELCERT-STATE.
 15185
 15186
 15187* EXEC CICS READ
 15188*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 15189*        DATASET (FILE-ID-ELCERT)
 15190*        RIDFLD  (ELCERT-KEY)
 15191*        RESP    (WS-RESPONSE)
 15192*    END-EXEC.
 15193*    MOVE '&"S        E          (  N#00013484' TO DFHEIV0
 15194     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15195     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15196     MOVE X'204E233030303133343834' TO DFHEIV0(25:11)
 15197     CALL 'kxdfhei1' USING DFHEIV0,
 15198           FILE-ID-ELCERT,
 15199           DFHEIV20,
 15200           DFHEIV99,
 15201           ELCERT-KEY,
 15202           DFHEIV99,
 15203           DFHEIV99,
 15204           DFHEIV99
 15205     SET ADDRESS OF CERTIFICATE-MASTER TO
 15206         DFHEIV20
 15207     MOVE EIBRESP  TO WS-RESPONSE
 15208     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15209
 15210
 15211     IF NOT RESP-NORMAL
 15212        GO TO 2376-BYPASS-CRTO
 15213     END-IF
 15214
 15215
 15216     MOVE ELCERT-KEY             TO ERMAIL-KEY
 15217     MOVE ' '                    TO WS-ERMAIL-SW
 15218
 15219
 15220* EXEC CICS READ
 15221*       DATASET   (FILE-ID-ERMAIL)
 15222*       SET       (ADDRESS OF MAILING-DATA)
 15223*       RIDFLD    (ERMAIL-KEY)
 15224*       RESP      (WS-RESPONSE)
 15225*    END-EXEC
 15226*    MOVE '&"S        E          (  N#00013499' TO DFHEIV0
 15227     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15228     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15229     MOVE X'204E233030303133343939' TO DFHEIV0(25:11)
 15230     CALL 'kxdfhei1' USING DFHEIV0,
 15231           FILE-ID-ERMAIL,
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 280
* EL6311.cbl
 15232           DFHEIV20,
 15233           DFHEIV99,
 15234           ERMAIL-KEY,
 15235           DFHEIV99,
 15236           DFHEIV99,
 15237           DFHEIV99
 15238     SET ADDRESS OF MAILING-DATA TO
 15239         DFHEIV20
 15240     MOVE EIBRESP  TO WS-RESPONSE
 15241     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15242
 15243     IF RESP-NORMAL
 15244        SET ERMAIL-FOUND TO TRUE
 15245     END-IF
 15246
 15247     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 15248
 15249     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 15250                                 TO ELCRTO-KEY
 15251     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 15252     MOVE +0                     TO ELCRTO-SEQ-NO
 15253
 15254
 15255* EXEC CICS READ
 15256*       DATASET   ('ELCRTO')
 15257*       INTO      (ORIGINAL-CERTIFICATE)
 15258*       RIDFLD    (ELCRTO-KEY)
 15259*       GTEQ
 15260*       RESP      (WS-RESPONSE)
 15261*    END-EXEC
 15262     MOVE LENGTH OF
 15263      ORIGINAL-CERTIFICATE
 15264       TO DFHEIV11
 15265     MOVE 'ELCRTO' TO DFHEIV1
 15266*    MOVE '&"IL       G          (  N#00013517' TO DFHEIV0
 15267     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 15268     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15269     MOVE X'204E233030303133353137' TO DFHEIV0(25:11)
 15270     CALL 'kxdfhei1' USING DFHEIV0,
 15271           DFHEIV1,
 15272           ORIGINAL-CERTIFICATE,
 15273           DFHEIV11,
 15274           ELCRTO-KEY,
 15275           DFHEIV99,
 15276           DFHEIV99,
 15277           DFHEIV99
 15278     MOVE EIBRESP  TO WS-RESPONSE
 15279     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15280
 15281     display ' just read gteq ' ws-response
 15282     IF RESP-NORMAL
 15283        AND (OC-CONTROL-PRIMARY (1:33) =
 15284                 PB-CONTROL-BY-ACCOUNT (1:33))
 15285        AND (OC-RECORD-TYPE = 'I')
 15286        display ' resp norm, key =, type i '
 15287        IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 15288           display ' end proc blank '
 15289           display ' csr edit session ' PI-CSR-SESSION-SW
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 281
* EL6311.cbl
 15290           IF NOT CSR-EDIT-SESSION
 15291
 15292* EXEC CICS READ
 15293*                DATASET   ('ELCRTO')
 15294*                INTO      (ORIGINAL-CERTIFICATE)
 15295*                RIDFLD    (OC-CONTROL-PRIMARY)
 15296*                UPDATE
 15297*                RESP      (WS-RESPONSE)
 15298*             END-EXEC
 15299     MOVE LENGTH OF
 15300      ORIGINAL-CERTIFICATE
 15301       TO DFHEIV11
 15302     MOVE 'ELCRTO' TO DFHEIV1
 15303*    MOVE '&"IL       EU         (  N#00013535' TO DFHEIV0
 15304     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15305     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15306     MOVE X'204E233030303133353335' TO DFHEIV0(25:11)
 15307     CALL 'kxdfhei1' USING DFHEIV0,
 15308           DFHEIV1,
 15309           ORIGINAL-CERTIFICATE,
 15310           DFHEIV11,
 15311           OC-CONTROL-PRIMARY,
 15312           DFHEIV99,
 15313           DFHEIV99,
 15314           DFHEIV99
 15315     MOVE EIBRESP  TO WS-RESPONSE
 15316     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15317              DISPLAY ' JUST DID READ UPD ' WS-RESPONSE
 15318              IF RESP-NORMAL
 15319                 display ' good read upd '
 15320                 IF OC-ISSUE-TRAN-IND = 'N'
 15321                    MOVE CM-INSURED-LAST-NAME   TO
 15322                         OC-INS-LAST-NAME
 15323                    MOVE CM-INSURED-FIRST-NAME  TO
 15324                         OC-INS-FIRST-NAME
 15325                    MOVE CM-INSURED-INITIAL2    TO
 15326                         OC-INS-MIDDLE-INIT
 15327                    MOVE CM-INSURED-ISSUE-AGE   TO
 15328                         OC-INS-AGE
 15329                    MOVE CM-JT-LAST-NAME        TO
 15330                         OC-JNT-LAST-NAME
 15331                    MOVE CM-JT-FIRST-NAME       TO
 15332                         OC-JNT-FIRST-NAME
 15333                    MOVE CM-JT-INITIAL          TO
 15334                         OC-JNT-MIDDLE-INIT
 15335                    MOVE CM-INSURED-JOINT-AGE   TO
 15336                         OC-JNT-AGE
 15337                    MOVE CM-LF-BENEFIT-CD       TO
 15338                         OC-LF-BENCD
 15339                    MOVE CM-LF-ORIG-TERM        TO
 15340                         OC-LF-TERM
 15341                    MOVE CM-LF-BENEFIT-AMT      TO
 15342                         OC-LF-BEN-AMT
 15343                    MOVE CM-LF-PREMIUM-AMT      TO
 15344                         OC-LF-PRM-AMT
 15345                    MOVE CM-LF-ALT-BENEFIT-AMT  TO
 15346                         OC-LF-ALT-BEN-AMT
 15347                    MOVE CM-LF-ALT-PREMIUM-AMT  TO
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 282
* EL6311.cbl
 15348                         OC-LF-ALT-PRM-AMT
 15349                    MOVE CM-LF-LOAN-EXPIRE-DT   TO
 15350                         OC-LF-EXP-DT
 15351                    MOVE CM-LIFE-COMM-PCT       TO
 15352                         OC-LF-COMM-PCT
 15353                    MOVE CM-AH-BENEFIT-CD       TO
 15354                         OC-AH-BENCD
 15355                    MOVE CM-AH-ORIG-TERM        TO
 15356                         OC-AH-TERM
 15357                    MOVE CM-AH-BENEFIT-AMT      TO
 15358                         OC-AH-BEN-AMT
 15359                    MOVE CM-AH-PREMIUM-AMT      TO
 15360                         OC-AH-PRM-AMT
 15361                    MOVE CM-AH-LOAN-EXPIRE-DT   TO
 15362                         OC-AH-EXP-DT
 15363                    MOVE CM-AH-COMM-PCT         TO
 15364                         OC-AH-COMM-PCT
 15365                    MOVE CM-AH-CRITICAL-PERIOD  TO
 15366                         OC-AH-CP
 15367                    MOVE CM-LOAN-1ST-PMT-DT     TO
 15368                         OC-1ST-PMT-DT
 15369                 END-IF
 15370                 MOVE PB-C-LF-CANCEL-DT      TO
 15371                         OC-LF-CANCEL-DT
 15372                 MOVE PB-C-LF-CANCEL-AMT     TO
 15373                         OC-LF-CANCEL-AMT
 15374                 MOVE CM-LF-ITD-CANCEL-AMT   TO
 15375                         OC-LF-ITD-CANCEL-AMT
 15376                 MOVE PB-C-AH-CANCEL-DT      TO
 15377                         OC-AH-CANCEL-DT
 15378                 MOVE PB-C-AH-CANCEL-AMT     TO
 15379                         OC-AH-CANCEL-AMT
 15380                 MOVE CM-AH-ITD-CANCEL-AMT   TO
 15381                         OC-AH-ITD-CANCEL-AMT
 15382                 MOVE 'Y'                    TO
 15383                         OC-CANCEL-TRAN-IND
 15384                 MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 15385                 MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 15386                 MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 15387                 IF ERMAIL-FOUND
 15388                    MOVE MA-CRED-BENE-NAME
 15389                                 TO OC-CRED-BENE-NAME
 15390                 END-IF
 15391                 IF NOT CERT-TRL-REC-NOT-FOUND
 15392                    MOVE CS-INS-AGE-DEFAULT-FLAG TO
 15393                           OC-INS-AGE-DEFAULT-FLAG
 15394                    MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 15395                           OC-JNT-AGE-DEFAULT-FLAG
 15396                 END-IF
 15397
 15398* EXEC CICS REWRITE
 15399*                   DATASET   ('ELCRTO')
 15400*                   FROM      (ORIGINAL-CERTIFICATE)
 15401*                   RESP      (WS-RESPONSE)
 15402*                END-EXEC
 15403     MOVE LENGTH OF
 15404      ORIGINAL-CERTIFICATE
 15405       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 283
* EL6311.cbl
 15406     MOVE 'ELCRTO' TO DFHEIV1
 15407*    MOVE '&& L                  %  N#00013622' TO DFHEIV0
 15408     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15409     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15410     MOVE X'204E233030303133363232' TO DFHEIV0(25:11)
 15411     CALL 'kxdfhei1' USING DFHEIV0,
 15412           DFHEIV1,
 15413           ORIGINAL-CERTIFICATE,
 15414           DFHEIV11,
 15415           DFHEIV99
 15416     MOVE EIBRESP  TO WS-RESPONSE
 15417     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15418                 display ' just rewrote ' ws-response
 15419              END-IF
 15420           END-IF
 15421        ELSE
 15422           SUBTRACT +1 FROM OC-KEY-SEQ-NO
 15423           MOVE 'OC'             TO OC-RECORD-ID
 15424           MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 15425           MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 15426           MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 15427           MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 15428           MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 15429           MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 15430           MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 15431           MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 15432           MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 15433           MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 15434           MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 15435           MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
 15436           MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
 15437           MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
 15438           MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
 15439           MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
 15440           MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
 15441           MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
 15442           MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
 15443           MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
 15444           MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
 15445           MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 15446           MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
 15447           MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
 15448           MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
 15449           MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
 15450           MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
 15451           MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
 15452           MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 15453           MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
 15454           MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
 15455           MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 15456           MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 15457           MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 15458           MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 15459           IF ERMAIL-FOUND
 15460              MOVE MA-CRED-BENE-NAME
 15461                                 TO OC-CRED-BENE-NAME
 15462           END-IF
 15463           IF NOT CERT-TRL-REC-NOT-FOUND
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 284
* EL6311.cbl
 15464              MOVE CS-INS-AGE-DEFAULT-FLAG TO
 15465                           OC-INS-AGE-DEFAULT-FLAG
 15466              MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 15467                           OC-JNT-AGE-DEFAULT-FLAG
 15468           END-IF
 15469           MOVE LOW-VALUES       TO OC-ENDORSEMENT-PROCESSED-DT
 15470
 15471* EXEC CICS WRITE
 15472*             DATASET   ('ELCRTO')
 15473*             FROM      (ORIGINAL-CERTIFICATE)
 15474*             RIDFLD    (OC-CONTROL-PRIMARY)
 15475*             RESP      (WS-RESPONSE)
 15476*          END-EXEC
 15477     MOVE LENGTH OF
 15478      ORIGINAL-CERTIFICATE
 15479       TO DFHEIV11
 15480     MOVE 'ELCRTO' TO DFHEIV1
 15481*    MOVE '&$ L                  ''  N#00013679' TO DFHEIV0
 15482     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15483     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15484     MOVE X'204E233030303133363739' TO DFHEIV0(25:11)
 15485     CALL 'kxdfhei1' USING DFHEIV0,
 15486           DFHEIV1,
 15487           ORIGINAL-CERTIFICATE,
 15488           DFHEIV11,
 15489           OC-CONTROL-PRIMARY,
 15490           DFHEIV99,
 15491           DFHEIV99
 15492     MOVE EIBRESP  TO WS-RESPONSE
 15493     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15494        END-IF
 15495     ELSE
 15496        MOVE SPACES              TO ORIGINAL-CERTIFICATE
 15497        MOVE 'OC'                TO OC-RECORD-ID
 15498        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 15499                                 TO OC-CONTROL-PRIMARY (1:33)
 15500        MOVE 'I'                 TO OC-RECORD-TYPE
 15501        MOVE +4096               TO OC-KEY-SEQ-NO
 15502        MOVE PI-PROCESSOR-ID     TO OC-LAST-MAINT-BY
 15503        MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 15504        MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 15505        MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 15506        MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 15507        MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 15508        MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 15509        MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 15510        MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 15511        MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 15512        MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 15513        MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
 15514        MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
 15515        MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
 15516        MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
 15517        MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
 15518        MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
 15519        MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
 15520        MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
 15521        MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 285
* EL6311.cbl
 15522        MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
 15523        MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 15524        MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
 15525        MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
 15526        MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
 15527        MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
 15528        MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
 15529        MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
 15530        MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 15531        MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
 15532        MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
 15533        MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 15534        MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 15535        MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 15536        MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 15537        IF ERMAIL-FOUND
 15538           MOVE MA-CRED-BENE-NAME
 15539                                 TO OC-CRED-BENE-NAME
 15540        END-IF
 15541        IF NOT CERT-TRL-REC-NOT-FOUND
 15542           MOVE CS-INS-AGE-DEFAULT-FLAG TO
 15543                           OC-INS-AGE-DEFAULT-FLAG
 15544           MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 15545                           OC-JNT-AGE-DEFAULT-FLAG
 15546        END-IF
 15547        MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 15548
 15549
 15550* EXEC CICS WRITE
 15551*          DATASET   ('ELCRTO')
 15552*          FROM      (ORIGINAL-CERTIFICATE)
 15553*          RIDFLD    (OC-CONTROL-PRIMARY)
 15554*          RESP      (WS-RESPONSE)
 15555*       END-EXEC
 15556     MOVE LENGTH OF
 15557      ORIGINAL-CERTIFICATE
 15558       TO DFHEIV11
 15559     MOVE 'ELCRTO' TO DFHEIV1
 15560*    MOVE '&$ L                  ''  N#00013740' TO DFHEIV0
 15561     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15562     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15563     MOVE X'204E233030303133373430' TO DFHEIV0(25:11)
 15564     CALL 'kxdfhei1' USING DFHEIV0,
 15565           DFHEIV1,
 15566           ORIGINAL-CERTIFICATE,
 15567           DFHEIV11,
 15568           OC-CONTROL-PRIMARY,
 15569           DFHEIV99,
 15570           DFHEIV99
 15571     MOVE EIBRESP  TO WS-RESPONSE
 15572     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15573     END-IF.
 15574
 15575 2376-BYPASS-CRTO.
 15576******************************************************************
 15577*       U P D A T E   T H E   B A T C H   H E A D E R            *
 15578******************************************************************
 15579
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 286
* EL6311.cbl
 15580
 15581* EXEC CICS HANDLE CONDITION
 15582*         NOTFND    (2380-BATCH-HDR-NOT-FOUND)
 15583*    END-EXEC.
 15584*    MOVE '"$I                   ! 7 #00013753' TO DFHEIV0
 15585     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15586     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15587     MOVE X'3720233030303133373533' TO DFHEIV0(25:11)
 15588     CALL 'kxdfhei1' USING DFHEIV0
 15589     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15590
 15591
 15592
 15593* EXEC CICS READ
 15594*        INTO    (PENDING-BUSINESS)
 15595*        DATASET (FILE-ID-ERPNDB)
 15596*        RIDFLD  (ERPNDB-KEY)
 15597*        UPDATE
 15598*    END-EXEC.
 15599     MOVE LENGTH OF
 15600      PENDING-BUSINESS
 15601       TO DFHEIV11
 15602*    MOVE '&"IL       EU         (   #00013757' TO DFHEIV0
 15603     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15604     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15605     MOVE X'2020233030303133373537' TO DFHEIV0(25:11)
 15606     CALL 'kxdfhei1' USING DFHEIV0,
 15607           FILE-ID-ERPNDB,
 15608           PENDING-BUSINESS,
 15609           DFHEIV11,
 15610           ERPNDB-KEY,
 15611           DFHEIV99,
 15612           DFHEIV99,
 15613           DFHEIV99
 15614     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15615
 15616
 15617     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15618     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15619     MOVE 'B'                    TO JP-RECORD-TYPE.
 15620     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15621
 15622     PERFORM 8400-LOG-JOURNAL-RECORD.
 15623
 15624     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 15625
 15626
 15627* EXEC CICS REWRITE
 15628*        DATASET (FILE-ID-ERPNDB)
 15629*        FROM    (PENDING-BUSINESS)
 15630*    END-EXEC.
 15631     MOVE LENGTH OF
 15632      PENDING-BUSINESS
 15633       TO DFHEIV11
 15634*    MOVE '&& L                  %   #00013773' TO DFHEIV0
 15635     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15636     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15637     MOVE X'2020233030303133373733' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 287
* EL6311.cbl
 15638     CALL 'kxdfhei1' USING DFHEIV0,
 15639           FILE-ID-ERPNDB,
 15640           PENDING-BUSINESS,
 15641           DFHEIV11,
 15642           DFHEIV99
 15643     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15644
 15645
 15646     MOVE 'C'                    TO JP-RECORD-TYPE.
 15647     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15648
 15649     PERFORM 8400-LOG-JOURNAL-RECORD.
 15650
 15651     IF WS-ERRORS-PRESENT
 15652         GO TO 3900-RE-DISPLAY-RECORD.
 15653
 15654     MOVE ZEROS                  TO EMI-ERROR
 15655     MOVE -1                     TO CMAINTL
 15656     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15657     GO TO 3900-RE-DISPLAY-RECORD.
 15658
 15659 2380-BATCH-HDR-NOT-FOUND.
 15660     MOVE -1                     TO BMAINTL.
 15661     MOVE ER-7450                TO EMI-ERROR.
 15662     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15663     GO TO 8200-SEND-DATAONLY.
 15664
 15665 2385-REC-NOT-FOUND.
 15666     MOVE -1                     TO BMAINTL.
 15667     MOVE ER-7451                TO EMI-ERROR.
 15668     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15669     GO TO 8200-SEND-DATAONLY.
 15670
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 288
* EL6311.cbl
 15672
 15673******************************************************************
 15674*                                                                *
 15675*          D E L E T E   C A N C E L   R O U T I N E             *
 15676*                                                                *
 15677******************************************************************
 15678
 15679 2400-DELETE-CANCEL-ROUTINE.
 15680     MOVE 'D'                    TO PI-MAINT-FUNCTION.
 15681
 15682     IF CCHGL NOT = ZEROS
 15683        MOVE ER-2196             TO EMI-ERROR
 15684        MOVE AL-UABON            TO CMAINTA
 15685        MOVE -1                  TO CMAINTL
 15686        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15687        GO TO 8200-SEND-DATAONLY.
 15688
 15689
 15690* EXEC CICS HANDLE CONDITION
 15691*         NOTFND    (2485-BATCH-HDR-NOT-FOUND)
 15692*    END-EXEC.
 15693*    MOVE '"$I                   ! 8 #00013821' TO DFHEIV0
 15694     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15695     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15696     MOVE X'3820233030303133383231' TO DFHEIV0(25:11)
 15697     CALL 'kxdfhei1' USING DFHEIV0
 15698     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15699
 15700
 15701     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 15702     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 15703     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 15704
 15705
 15706* EXEC CICS READ
 15707*        SET     (ADDRESS OF PENDING-BUSINESS)
 15708*        DATASET (FILE-ID-ERPNDB)
 15709*        RIDFLD  (ERPNDB-KEY)
 15710*    END-EXEC.
 15711*    MOVE '&"S        E          (   #00013829' TO DFHEIV0
 15712     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15713     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15714     MOVE X'2020233030303133383239' TO DFHEIV0(25:11)
 15715     CALL 'kxdfhei1' USING DFHEIV0,
 15716           FILE-ID-ERPNDB,
 15717           DFHEIV20,
 15718           DFHEIV99,
 15719           ERPNDB-KEY,
 15720           DFHEIV99,
 15721           DFHEIV99,
 15722           DFHEIV99
 15723     SET ADDRESS OF PENDING-BUSINESS TO
 15724         DFHEIV20
 15725     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15726
 15727
 15728     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 15729
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 289
* EL6311.cbl
 15730     MOVE CCERTNOI               TO WS-NEW-PRIME.
 15731
 15732     IF CSUFIXL NOT = ZEROS
 15733        MOVE CSUFIXI             TO WS-NEW-SUFFIX
 15734     ELSE
 15735        MOVE SPACE               TO WS-NEW-SUFFIX.
 15736
 15737     MOVE CEFFDTI                TO DEEDIT-FIELD.
 15738
 15739     PERFORM 8600-DEEDIT.
 15740     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 15741     MOVE '4'                    TO DC-OPTION-CODE.
 15742     PERFORM 9700-DATE-LINK.
 15743
 15744     IF DATE-CONVERSION-ERROR
 15745        MOVE ER-0348             TO EMI-ERROR
 15746        MOVE -1                  TO CEFFDTL
 15747        MOVE AL-UABON            TO CEFFDTA
 15748        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15749        GO TO 8200-SEND-DATAONLY
 15750     ELSE
 15751        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 15752        MOVE AL-UANON            TO CEFFDTA
 15753        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 15754
 15755
 15756* EXEC CICS HANDLE CONDITION
 15757*         NOTFND    (2490-RECORD-NOT-FOUND)
 15758*    END-EXEC.
 15759*    MOVE '"$I                   ! 9 #00013862' TO DFHEIV0
 15760     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15761     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15762     MOVE X'3920233030303133383632' TO DFHEIV0(25:11)
 15763     CALL 'kxdfhei1' USING DFHEIV0
 15764     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15765
 15766
 15767
 15768* EXEC CICS READ
 15769*        SET     (ADDRESS OF PENDING-BUSINESS)
 15770*        DATASET (FILE-ID-ERPNDB)
 15771*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 15772*        UPDATE
 15773*    END-EXEC.
 15774*    MOVE '&"S        EU         (   #00013866' TO DFHEIV0
 15775     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15776     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15777     MOVE X'2020233030303133383636' TO DFHEIV0(25:11)
 15778     CALL 'kxdfhei1' USING DFHEIV0,
 15779           FILE-ID-ERPNDB,
 15780           DFHEIV20,
 15781           DFHEIV99,
 15782           PI-PREV-CONTROL-PRIMARY,
 15783           DFHEIV99,
 15784           DFHEIV99,
 15785           DFHEIV99
 15786     SET ADDRESS OF PENDING-BUSINESS TO
 15787         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 290
* EL6311.cbl
 15788     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15789
 15790
 15791     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 15792        MOVE -1                 TO CMAINTL
 15793        MOVE ER-2197            TO EMI-ERROR
 15794        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15795        GO TO 8200-SEND-DATAONLY.
 15796
 15797     IF PB-BILLED-DT NOT = LOW-VALUES
 15798        MOVE -1                 TO CMAINTL
 15799        MOVE ER-2129            TO EMI-ERROR
 15800        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15801        GO TO 8200-SEND-DATAONLY.
 15802
 15803     IF PB-CHG-COUNT NOT = ZEROS
 15804        MOVE ER-2336            TO EMI-ERROR
 15805        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15806        MOVE AL-UABON            TO CMAINTA
 15807        MOVE -1                  TO CMAINTL
 15808        GO TO 8200-SEND-DATAONLY.
 15809
 15810     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 15811        PB-CHG-COUNT NOT = ZEROS
 15812        MOVE ER-2196             TO EMI-ERROR
 15813        MOVE AL-UABON            TO CMAINTA
 15814        MOVE -1                  TO CMAINTL
 15815        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15816        GO TO 8200-SEND-DATAONLY.
 15817
 15818     IF PB-CONFIRMATION-REPT-DT NOT = SPACES AND LOW-VALUES
 15819        MOVE ER-2900 TO EMI-ERROR
 15820        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15821        MOVE AL-UABON         TO CMAINTA
 15822        MOVE -1               TO CMAINTL
 15823        GO TO 8200-SEND-DATAONLY.
 15824
 15825
 15826* EXEC CICS HANDLE CONDITION
 15827*         NOTFND  (2475-CONTINUE-DELETE)
 15828*    END-EXEC
 15829*    MOVE '"$I                   ! : #00013907' TO DFHEIV0
 15830     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15831     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15832     MOVE X'3A20233030303133393037' TO DFHEIV0(25:11)
 15833     CALL 'kxdfhei1' USING DFHEIV0
 15834     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15835
 15836     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 15837     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 15838     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 15839     MOVE PB-SV-STATE            TO ELCERT-STATE.
 15840
 15841
 15842* EXEC CICS READ
 15843*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 15844*        DATASET (FILE-ID-ELCERT)
 15845*        RIDFLD  (ELCERT-KEY)
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 291
* EL6311.cbl
 15846*        UPDATE
 15847*    END-EXEC.
 15848*    MOVE '&"S        EU         (   #00013916' TO DFHEIV0
 15849     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15850     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15851     MOVE X'2020233030303133393136' TO DFHEIV0(25:11)
 15852     CALL 'kxdfhei1' USING DFHEIV0,
 15853           FILE-ID-ELCERT,
 15854           DFHEIV20,
 15855           DFHEIV99,
 15856           ELCERT-KEY,
 15857           DFHEIV99,
 15858           DFHEIV99,
 15859           DFHEIV99
 15860     SET ADDRESS OF CERTIFICATE-MASTER TO
 15861         DFHEIV20
 15862     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15863
 15864
 15865     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15866
 15867     MOVE FILE-ID-ELCERT         TO JP-FILE-ID.
 15868     MOVE 'B'                    TO JP-RECORD-TYPE.
 15869     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 15870     PERFORM 8400-LOG-JOURNAL-RECORD.
 15871
 15872     IF PB-CI-LIVES NOT NUMERIC
 15873         MOVE ZERO                    TO PB-CI-LIVES.
 15874
 15875     IF PB-C-LF-CANCEL-DT GREATER THAN LOW-VALUES
 15876        IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 15877           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 15878           MOVE ZERO                     TO CM-LF-ITD-CANCEL-AMT
 15879           MOVE LOW-VALUES               TO CM-LF-CANCEL-EXIT-DT
 15880                                            CM-LF-CANCEL-DT
 15881           MOVE SPACE                    TO CM-LF-EXIT-BATCH
 15882        ELSE
 15883           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 15884           MOVE PB-CI-LF-CANCEL-AMT      TO CM-LF-ITD-CANCEL-AMT
 15885           MOVE PB-CI-LF-PRIOR-CANCEL-DT TO CM-LF-CANCEL-DT
 15886           MOVE PB-CI-LIVES              TO CM-LIVES.
 15887
 15888     IF PB-C-LF-CANCEL-DT GREATER THAN LOW-VALUES
 15889        IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 15890           IF CM-LF-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 15891               MOVE CM-LF-STATUS-AT-CANCEL
 15892                                        TO CM-LF-CURRENT-STATUS
 15893               MOVE SPACE
 15894                                        TO CM-LF-STATUS-AT-CANCEL
 15895           ELSE
 15896               MOVE PB-CI-LF-POLICY-STATUS
 15897                                        TO CM-LF-CURRENT-STATUS
 15898        ELSE
 15899           MOVE PB-CI-LF-POLICY-STATUS  TO CM-LF-CURRENT-STATUS.
 15900
 15901
 15902     IF PB-C-AH-CANCEL-DT GREATER THAN LOW-VALUES
 15903        IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 292
* EL6311.cbl
 15904           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 15905           MOVE ZERO                     TO CM-AH-ITD-CANCEL-AMT
 15906           MOVE LOW-VALUES               TO CM-AH-CANCEL-EXIT-DT
 15907                                            CM-AH-CANCEL-DT
 15908           MOVE SPACE                    TO CM-AH-EXIT-BATCH
 15909        ELSE
 15910           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 15911           MOVE PB-CI-AH-CANCEL-AMT      TO CM-AH-ITD-CANCEL-AMT
 15912           MOVE PB-CI-AH-PRIOR-CANCEL-DT TO CM-AH-CANCEL-DT
 15913           MOVE PB-CI-LIVES              TO CM-LIVES.
 15914
 15915     IF PB-C-AH-CANCEL-DT GREATER THAN LOW-VALUES
 15916        IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 15917           IF CM-AH-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 15918               MOVE CM-AH-STATUS-AT-CANCEL
 15919                                        TO CM-AH-CURRENT-STATUS
 15920               MOVE SPACE
 15921                                        TO CM-AH-STATUS-AT-CANCEL
 15922           ELSE
 15923               MOVE PB-CI-AH-POLICY-STATUS
 15924                                        TO CM-AH-CURRENT-STATUS
 15925        ELSE
 15926           MOVE PB-CI-AH-POLICY-STATUS  TO CM-AH-CURRENT-STATUS.
 15927
 15928 2450-REWRITE-CERT.
 15929     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 15930     MOVE 'C'                      TO JP-RECORD-TYPE.
 15931     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 15932
 15933
 15934* EXEC CICS REWRITE
 15935*        DATASET  (FILE-ID-ELCERT)
 15936*        FROM     (CERTIFICATE-MASTER)
 15937*    END-EXEC.
 15938     MOVE LENGTH OF
 15939      CERTIFICATE-MASTER
 15940       TO DFHEIV11
 15941*    MOVE '&& L                  %   #00013991' TO DFHEIV0
 15942     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15943     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15944     MOVE X'2020233030303133393931' TO DFHEIV0(25:11)
 15945     CALL 'kxdfhei1' USING DFHEIV0,
 15946           FILE-ID-ELCERT,
 15947           CERTIFICATE-MASTER,
 15948           DFHEIV11,
 15949           DFHEIV99
 15950     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15951
 15952
 15953     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 15954
 15955     PERFORM 8400-LOG-JOURNAL-RECORD.
 15956
 15957 2475-CONTINUE-DELETE.
 15958     SUBTRACT PB-C-LF-CANCEL-AMT  FROM WS-B-LF-CAN-PRM-ENTERED.
 15959     SUBTRACT PB-C-AH-CANCEL-AMT  FROM WS-B-AH-CAN-PRM-ENTERED.
 15960
 15961     SUBTRACT PB-C-LF-REF-CALC    FROM WS-B-LF-CAN-PRM-COMPUTED.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 293
* EL6311.cbl
 15962     SUBTRACT PB-C-AH-REF-CALC    FROM WS-B-AH-CAN-PRM-COMPUTED.
 15963
 15964     SUBTRACT +1 FROM WS-B-CANCEL-CNT-ENTERED.
 15965
 15966     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID
 15967     MOVE 'D'                    TO JP-RECORD-TYPE
 15968     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15969
 15970
 15971* EXEC CICS DELETE
 15972*        DATASET    (FILE-ID-ERPNDB)
 15973*    END-EXEC.
 15974*    MOVE '&(                    &   #00014013' TO DFHEIV0
 15975     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 15976     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 15977     MOVE X'2020233030303134303133' TO DFHEIV0(25:11)
 15978     CALL 'kxdfhei1' USING DFHEIV0,
 15979           FILE-ID-ERPNDB,
 15980           DFHEIV99,
 15981           DFHEIV99,
 15982           DFHEIV99,
 15983           DFHEIV99
 15984     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15985
 15986
 15987     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15988
 15989     PERFORM 8400-LOG-JOURNAL-RECORD.
 15990
 15991     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 15992     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 15993
 15994
 15995* EXEC CICS HANDLE CONDITION
 15996*         NOTFND    (2485-BATCH-HDR-NOT-FOUND)
 15997*    END-EXEC.
 15998*    MOVE '"$I                   ! ; #00014024' TO DFHEIV0
 15999     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16000     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16001     MOVE X'3B20233030303134303234' TO DFHEIV0(25:11)
 16002     CALL 'kxdfhei1' USING DFHEIV0
 16003     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16004
 16005
 16006
 16007* EXEC CICS READ
 16008*        SET     (ADDRESS OF PENDING-BUSINESS)
 16009*        DATASET (FILE-ID-ERPNDB)
 16010*        RIDFLD  (ERPNDB-KEY)
 16011*        UPDATE
 16012*    END-EXEC.
 16013*    MOVE '&"S        EU         (   #00014028' TO DFHEIV0
 16014     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16015     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16016     MOVE X'2020233030303134303238' TO DFHEIV0(25:11)
 16017     CALL 'kxdfhei1' USING DFHEIV0,
 16018           FILE-ID-ERPNDB,
 16019           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 294
* EL6311.cbl
 16020           DFHEIV99,
 16021           ERPNDB-KEY,
 16022           DFHEIV99,
 16023           DFHEIV99,
 16024           DFHEIV99
 16025     SET ADDRESS OF PENDING-BUSINESS TO
 16026         DFHEIV20
 16027     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16028
 16029
 16030     MOVE FILE-ID-ERPNDB           TO JP-FILE-ID.
 16031     MOVE ERPNDB-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 16032
 16033     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 16034        WS-B-CANCEL-CNT-ENTERED = ZEROS
 16035        MOVE 'D'                 TO JP-RECORD-TYPE
 16036        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 16037
 16038* EXEC CICS DELETE
 16039*            DATASET    (FILE-ID-ERPNDB)
 16040*       END-EXEC
 16041*    MOVE '&(                    &   #00014042' TO DFHEIV0
 16042     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16043     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16044     MOVE X'2020233030303134303432' TO DFHEIV0(25:11)
 16045     CALL 'kxdfhei1' USING DFHEIV0,
 16046           FILE-ID-ERPNDB,
 16047           DFHEIV99,
 16048           DFHEIV99,
 16049           DFHEIV99,
 16050           DFHEIV99
 16051     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16052        PERFORM 8400-LOG-JOURNAL-RECORD
 16053     ELSE
 16054        MOVE 'B'                 TO JP-RECORD-TYPE
 16055        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 16056        PERFORM 8400-LOG-JOURNAL-RECORD
 16057        MOVE WS-BATCH-RECORD     TO PB-BATCH-RECORD
 16058        MOVE 'C'                 TO JP-RECORD-TYPE
 16059        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 16060
 16061* EXEC CICS REWRITE
 16062*            DATASET    (FILE-ID-ERPNDB)
 16063*            FROM       (PENDING-BUSINESS)
 16064*       END-EXEC
 16065     MOVE LENGTH OF
 16066      PENDING-BUSINESS
 16067       TO DFHEIV11
 16068*    MOVE '&& L                  %   #00014053' TO DFHEIV0
 16069     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16070     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16071     MOVE X'2020233030303134303533' TO DFHEIV0(25:11)
 16072     CALL 'kxdfhei1' USING DFHEIV0,
 16073           FILE-ID-ERPNDB,
 16074           PENDING-BUSINESS,
 16075           DFHEIV11,
 16076           DFHEIV99
 16077     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 295
* EL6311.cbl
 16078        PERFORM 8400-LOG-JOURNAL-RECORD.
 16079
 16080******************************************************************
 16081*                                                                *
 16082*       DELETE THE A/R REQUEST RECORD IF THE COMPANY USES        *
 16083*       THE ACCOUNTS RECEIVABLE SYSTEM.                          *
 16084*                                                                *
 16085******************************************************************
 16086
 16087     IF NOT PI-AR-PROCESSING
 16088        GO TO 2480-DELETE-FINISHED.
 16089
 16090     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 16091        WS-B-CANCEL-CNT-ENTERED = ZEROS
 16092        NEXT SENTENCE
 16093     ELSE
 16094        GO TO 2480-DELETE-FINISHED.
 16095
 16096
 16097* EXEC CICS HANDLE CONDITION
 16098*         NOTFND    (2480-DELETE-FINISHED)
 16099*    END-EXEC.
 16100*    MOVE '"$I                   ! < #00014075' TO DFHEIV0
 16101     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16102     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16103     MOVE X'3C20233030303134303735' TO DFHEIV0(25:11)
 16104     CALL 'kxdfhei1' USING DFHEIV0
 16105     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16106
 16107
 16108     MOVE ERPNDB-COMPANY-CD      TO ERRQST-COMPANY-CD.
 16109     MOVE ERPNDB-ENTRY-BATCH     TO ERRQST-ENTRY-BATCH.
 16110
 16111
 16112* EXEC CICS READ
 16113*        SET     (ADDRESS OF AR-REQUEST-RECORD)
 16114*        DATASET (FILE-ID-ERRQST)
 16115*        RIDFLD  (ERRQST-KEY)
 16116*        UPDATE
 16117*    END-EXEC.
 16118*    MOVE '&"S        EU         (   #00014082' TO DFHEIV0
 16119     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16120     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16121     MOVE X'2020233030303134303832' TO DFHEIV0(25:11)
 16122     CALL 'kxdfhei1' USING DFHEIV0,
 16123           FILE-ID-ERRQST,
 16124           DFHEIV20,
 16125           DFHEIV99,
 16126           ERRQST-KEY,
 16127           DFHEIV99,
 16128           DFHEIV99,
 16129           DFHEIV99
 16130     SET ADDRESS OF AR-REQUEST-RECORD TO
 16131         DFHEIV20
 16132     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16133
 16134
 16135     MOVE ERRQST-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 296
* EL6311.cbl
 16136
 16137     MOVE  FILE-ID-ERRQST          TO JP-FILE-ID.
 16138
 16139     MOVE 'D'                      TO JP-RECORD-TYPE.
 16140     MOVE AR-REQUEST-RECORD        TO JP-RECORD-AREA.
 16141
 16142
 16143* EXEC CICS DELETE
 16144*         DATASET    (FILE-ID-ERRQST)
 16145*    END-EXEC.
 16146*    MOVE '&(                    &   #00014096' TO DFHEIV0
 16147     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16148     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16149     MOVE X'2020233030303134303936' TO DFHEIV0(25:11)
 16150     CALL 'kxdfhei1' USING DFHEIV0,
 16151           FILE-ID-ERRQST,
 16152           DFHEIV99,
 16153           DFHEIV99,
 16154           DFHEIV99,
 16155           DFHEIV99
 16156     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16157
 16158
 16159     PERFORM 8400-LOG-JOURNAL-RECORD.
 16160
 16161 2480-DELETE-FINISHED.
 16162     MOVE ZEROS                  TO EMI-ERROR.
 16163     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16164     MOVE LOW-VALUES             TO EL631CI.
 16165     MOVE -1                     TO CMAINTL.
 16166     GO TO 8100-SEND-INITIAL-MAP.
 16167
 16168 2485-BATCH-HDR-NOT-FOUND.
 16169     MOVE -1                     TO CMAINTL
 16170     MOVE AL-UABON               TO CMAINTA.
 16171     MOVE ER-7450                TO EMI-ERROR.
 16172     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16173     GO TO 8200-SEND-DATAONLY.
 16174
 16175 2490-RECORD-NOT-FOUND.
 16176     MOVE -1                     TO CMAINTL
 16177     MOVE AL-UABON               TO CMAINTA.
 16178     MOVE ER-7451                TO EMI-ERROR.
 16179     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16180     GO TO 8200-SEND-DATAONLY.
 16181
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 297
* EL6311.cbl
 16183
 16184***************************************************************
 16185*                                                             *
 16186*       B U I L D   C O R R E C T I O N   R E C O R D         *
 16187*                                                             *
 16188***************************************************************
 16189
 16190***************************************************************
 16191*     ROUTINE TO CREATE COPY OF ZERO RECORD WHEN CHANGING     *
 16192*     AN ALREADY BILLED RECORD.                               *
 16193***************************************************************
 16194
 16195 2700-BUILD-CORRECTION-RECORD.
 16196     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 16197     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 16198     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 16199     MOVE '5'                    TO DC-OPTION-CODE.
 16200     PERFORM 9700-DATE-LINK.
 16201     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 16202
 16203     IF PB-CHG-COUNT = ZEROS
 16204        MOVE +1                  TO WS-SEQ-SAVE
 16205     ELSE
 16206        ADD +1  PB-CHG-COUNT     TO WS-SEQ-SAVE.
 16207
 16208     COMPUTE PB-BATCH-CHG-SEQ-NO = 1000 - WS-SEQ-SAVE.
 16209     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-ALT-CHG-SEQ-NO.
 16210
 16211     MOVE PB-CONTROL-PRIMARY     TO PB-CONTROL-BY-ORIG-BATCH.
 16212
 16213     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 16214     MOVE 'A'                    TO JP-RECORD-TYPE.
 16215     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16216
 16217
 16218* EXEC CICS WRITE
 16219*        DATASET    (FILE-ID-ERPNDB)
 16220*        FROM       (PENDING-BUSINESS)
 16221*        RIDFLD     (PB-CONTROL-PRIMARY)
 16222*    END-EXEC.
 16223     MOVE LENGTH OF
 16224      PENDING-BUSINESS
 16225       TO DFHEIV11
 16226*    MOVE '&$ L                  ''   #00014158' TO DFHEIV0
 16227     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16228     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16229     MOVE X'2020233030303134313538' TO DFHEIV0(25:11)
 16230     CALL 'kxdfhei1' USING DFHEIV0,
 16231           FILE-ID-ERPNDB,
 16232           PENDING-BUSINESS,
 16233           DFHEIV11,
 16234           PB-CONTROL-PRIMARY,
 16235           DFHEIV99,
 16236           DFHEIV99
 16237     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16238
 16239
 16240     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 298
* EL6311.cbl
 16241
 16242     PERFORM 8400-LOG-JOURNAL-RECORD.
 16243
 16244 2799-EXIT.
 16245      EXIT.
 16246
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 299
* EL6311.cbl
 16248
 16249******************************************************************
 16250*                                                                *
 16251*        R E W R I T E   I S S U E   C E R T.   K E Y            *
 16252*                                                                *
 16253******************************************************************
 16254
 16255 2800-REWRITE-ISSUE-CERT-KEY.
 16256     MOVE  PI-PREV-ALT-KEY       TO  ERPNDB-ALT-KEY.
 16257
 16258     IF  BCERTNOL GREATER THAN ZEROS
 16259         MOVE BCERTNOI           TO  ERPNDB-CERT-PRIME.
 16260
 16261     IF  BSUFIXL  GREATER THAN ZEROS
 16262         MOVE BSUFIXI            TO  ERPNDB-CERT-SFX.
 16263
 16264     IF  BEFFDTL  GREATER THAN ZEROS
 16265         MOVE WS-CONVERTED-EFFDT TO  ERPNDB-CERT-EFF-DT.
 16266
 16267 2810-READ-BY-ACCOUNT.
 16268
 16269* EXEC CICS HANDLE CONDITION
 16270*         NOTFND    (2820-PROCESS-REWRITE)
 16271*    END-EXEC.
 16272*    MOVE '"$I                   ! = #00014192' TO DFHEIV0
 16273     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16274     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16275     MOVE X'3D20233030303134313932' TO DFHEIV0(25:11)
 16276     CALL 'kxdfhei1' USING DFHEIV0
 16277     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16278
 16279
 16280
 16281* EXEC CICS READ
 16282*        SET     (ADDRESS OF PENDING-BUSINESS)
 16283*        DATASET (FILE-ID-ERPNDB2)
 16284*        RIDFLD  (ERPNDB-ALT-KEY)
 16285*    END-EXEC.
 16286*    MOVE '&"S        E          (   #00014196' TO DFHEIV0
 16287     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16288     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16289     MOVE X'2020233030303134313936' TO DFHEIV0(25:11)
 16290     CALL 'kxdfhei1' USING DFHEIV0,
 16291           FILE-ID-ERPNDB2,
 16292           DFHEIV20,
 16293           DFHEIV99,
 16294           ERPNDB-ALT-KEY,
 16295           DFHEIV99,
 16296           DFHEIV99,
 16297           DFHEIV99
 16298     SET ADDRESS OF PENDING-BUSINESS TO
 16299         DFHEIV20
 16300     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16301
 16302
 16303     GO TO 2890-DUPLICATE-RECORD.
 16304
 16305  2820-PROCESS-REWRITE.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 300
* EL6311.cbl
 16306
 16307* EXEC CICS HANDLE CONDITION
 16308*         NOTFND    (2885-RECORD-MISSING)
 16309*    END-EXEC.
 16310*    MOVE '"$I                   ! > #00014205' TO DFHEIV0
 16311     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16312     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16313     MOVE X'3E20233030303134323035' TO DFHEIV0(25:11)
 16314     CALL 'kxdfhei1' USING DFHEIV0
 16315     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16316
 16317
 16318     MOVE  PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 16319
 16320
 16321* EXEC CICS READ
 16322*        SET     (ADDRESS OF PENDING-BUSINESS)
 16323*        DATASET (FILE-ID-ERPNDB)
 16324*        RIDFLD  (ERPNDB-KEY)
 16325*        UPDATE
 16326*    END-EXEC.
 16327*    MOVE '&"S        EU         (   #00014211' TO DFHEIV0
 16328     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16329     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16330     MOVE X'2020233030303134323131' TO DFHEIV0(25:11)
 16331     CALL 'kxdfhei1' USING DFHEIV0,
 16332           FILE-ID-ERPNDB,
 16333           DFHEIV20,
 16334           DFHEIV99,
 16335           ERPNDB-KEY,
 16336           DFHEIV99,
 16337           DFHEIV99,
 16338           DFHEIV99
 16339     SET ADDRESS OF PENDING-BUSINESS TO
 16340         DFHEIV20
 16341     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16342
 16343
 16344     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 16345     MOVE 'D'                    TO JP-RECORD-TYPE.
 16346     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16347     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16348
 16349     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 16350
 16351     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 16352     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 16353     MOVE PB-SV-STATE            TO ELCERT-STATE.
 16354
 16355
 16356* EXEC CICS DELETE
 16357*        DATASET    (FILE-ID-ERPNDB)
 16358*    END-EXEC.
 16359*    MOVE '&(                    &   #00014229' TO DFHEIV0
 16360     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16361     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16362     MOVE X'2020233030303134323239' TO DFHEIV0(25:11)
 16363     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 301
* EL6311.cbl
 16364           FILE-ID-ERPNDB,
 16365           DFHEIV99,
 16366           DFHEIV99,
 16367           DFHEIV99,
 16368           DFHEIV99
 16369     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16370
 16371
 16372     PERFORM 8400-LOG-JOURNAL-RECORD.
 16373
 16374
 16375* EXEC CICS GETMAIN
 16376*        SET      (ADDRESS OF PENDING-BUSINESS)
 16377*        LENGTH   (ERPNDB-RECORD-LENGTH)
 16378*        INITIMG  (GETMAIN-SPACE)
 16379*    END-EXEC.
 16380*    MOVE ',"IL                  $   #00014235' TO DFHEIV0
 16381     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16382     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16383     MOVE X'2020233030303134323335' TO DFHEIV0(25:11)
 16384     CALL 'kxdfhei1' USING DFHEIV0,
 16385           DFHEIV20,
 16386           ERPNDB-RECORD-LENGTH,
 16387           GETMAIN-SPACE
 16388     SET ADDRESS OF PENDING-BUSINESS TO
 16389         DFHEIV20
 16390     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16391
 16392
 16393     MOVE JP-RECORD-AREA         TO PENDING-BUSINESS.
 16394
 16395
 16396* EXEC CICS HANDLE CONDITION
 16397*        NOTFND   (2830-BUILD-NEW-ISSUE-RECORD)
 16398*    END-EXEC.
 16399*    MOVE '"$I                   ! ? #00014243' TO DFHEIV0
 16400     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16401     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16402     MOVE X'3F20233030303134323433' TO DFHEIV0(25:11)
 16403     CALL 'kxdfhei1' USING DFHEIV0
 16404     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16405
 16406
 16407
 16408* EXEC CICS READ
 16409*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 16410*        DATASET (FILE-ID-ELCERT)
 16411*        RIDFLD  (ELCERT-KEY)
 16412*        UPDATE
 16413*    END-EXEC.
 16414*    MOVE '&"S        EU         (   #00014247' TO DFHEIV0
 16415     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16416     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16417     MOVE X'2020233030303134323437' TO DFHEIV0(25:11)
 16418     CALL 'kxdfhei1' USING DFHEIV0,
 16419           FILE-ID-ELCERT,
 16420           DFHEIV20,
 16421           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 302
* EL6311.cbl
 16422           ELCERT-KEY,
 16423           DFHEIV99,
 16424           DFHEIV99,
 16425           DFHEIV99
 16426     SET ADDRESS OF CERTIFICATE-MASTER TO
 16427         DFHEIV20
 16428     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16429
 16430
 16431     MOVE  FILE-ID-ELCERT        TO JP-FILE-ID.
 16432     MOVE 'B'                    TO JP-RECORD-TYPE
 16433     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 16434     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16435
 16436     IF INSURED-ADDR-PRESENT
 16437        MOVE 'Y'                 TO WS-CERT-ADDRESS-SW.
 16438
 16439     IF CERT-NOTES-ARE-NOT-PRESENT
 16440        MOVE SPACE               TO WS-CERT-NOTE-SW
 16441     ELSE
 16442        MOVE 'Y'                 TO WS-CERT-NOTE-SW.
 16443
 16444     IF CERT-ADDED-BATCH      OR
 16445        CERT-AND-CLAIM-ONLINE OR
 16446        CERT-WAS-CREATED-FOR-CLAIM
 16447        NEXT SENTENCE
 16448     ELSE
 16449        GO TO 2825-DELETE-CERTIFICATE.
 16450
 16451     PERFORM 8400-LOG-JOURNAL-RECORD.
 16452
 16453*********************************************************
 16454** DO NOT SET CERT-ADDED-BATCH AS CLAIM-CREATED CERT **
 16455     IF CERT-ADDED-BATCH
 16456         GO TO 2822-REWRITE-ELCERT.
 16457*********************************************************
 16458
 16459     IF NO-CLAIM-ATTACHED
 16460        NEXT SENTENCE
 16461     ELSE
 16462        MOVE SPACE               TO CM-CREDIT-INTERFACE-SW-1
 16463        MOVE '2'                 TO CM-CLAIM-INTERFACE-SW.
 16464
 16465 2822-REWRITE-ELCERT.
 16466     MOVE 'C'                    TO JP-RECORD-TYPE
 16467     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 16468
 16469     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16470
 16471
 16472* EXEC CICS REWRITE
 16473*         DATASET    (FILE-ID-ELCERT)
 16474*         FROM       (CERTIFICATE-MASTER)
 16475*    END-EXEC.
 16476     MOVE LENGTH OF
 16477      CERTIFICATE-MASTER
 16478       TO DFHEIV11
 16479*    MOVE '&& L                  %   #00014294' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 303
* EL6311.cbl
 16480     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16481     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16482     MOVE X'2020233030303134323934' TO DFHEIV0(25:11)
 16483     CALL 'kxdfhei1' USING DFHEIV0,
 16484           FILE-ID-ELCERT,
 16485           CERTIFICATE-MASTER,
 16486           DFHEIV11,
 16487           DFHEIV99
 16488     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16489
 16490
 16491     PERFORM 8400-LOG-JOURNAL-RECORD.
 16492
 16493     GO TO 2830-BUILD-NEW-ISSUE-RECORD.
 16494
 16495 2825-DELETE-CERTIFICATE.
 16496     MOVE 'D'                      TO JP-RECORD-TYPE.
 16497     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 16498
 16499     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 16500
 16501
 16502* EXEC CICS DELETE
 16503*         DATASET    (FILE-ID-ELCERT)
 16504*    END-EXEC.
 16505*    MOVE '&(                    &   #00014309' TO DFHEIV0
 16506     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16507     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16508     MOVE X'2020233030303134333039' TO DFHEIV0(25:11)
 16509     CALL 'kxdfhei1' USING DFHEIV0,
 16510           FILE-ID-ELCERT,
 16511           DFHEIV99,
 16512           DFHEIV99,
 16513           DFHEIV99,
 16514           DFHEIV99
 16515     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16516
 16517
 16518     PERFORM 8400-LOG-JOURNAL-RECORD.
 16519
 16520******************************************************************
 16521*       DELETE CERTIFICATE NOTES FOR ALL DELETED CERTIFICATES    *
 16522******************************************************************
 16523
 16524     IF CERT-NOTES-ARE-PRESENT
 16525        NEXT SENTENCE
 16526     ELSE
 16527        GO TO 2827-DELETE-MAILING.
 16528
 16529
 16530* EXEC CICS HANDLE CONDITION
 16531*         NOTFND  (2827-DELETE-MAILING)
 16532*    END-EXEC.
 16533*    MOVE '"$I                   ! @ #00014324' TO DFHEIV0
 16534     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16535     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16536     MOVE X'4020233030303134333234' TO DFHEIV0(25:11)
 16537     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 304
* EL6311.cbl
 16538     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16539
 16540
 16541
 16542* EXEC CICS READ
 16543*        EQUAL
 16544*        DATASET   (FILE-ID-ERNOTE)
 16545*        SET       (ADDRESS OF CERTIFICATE-NOTE)
 16546*        RIDFLD    (ELCERT-KEY)
 16547*        UPDATE
 16548*    END-EXEC.
 16549*    MOVE '&"S        EU         (   #00014328' TO DFHEIV0
 16550     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16551     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16552     MOVE X'2020233030303134333238' TO DFHEIV0(25:11)
 16553     CALL 'kxdfhei1' USING DFHEIV0,
 16554           FILE-ID-ERNOTE,
 16555           DFHEIV20,
 16556           DFHEIV99,
 16557           ELCERT-KEY,
 16558           DFHEIV99,
 16559           DFHEIV99,
 16560           DFHEIV99
 16561     SET ADDRESS OF CERTIFICATE-NOTE TO
 16562         DFHEIV20
 16563     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16564
 16565
 16566     MOVE  FILE-ID-ERNOTE        TO  JP-FILE-ID.
 16567     MOVE 'D'                    TO  JP-RECORD-TYPE.
 16568     MOVE CERTIFICATE-NOTE       TO  JP-RECORD-AREA.
 16569
 16570     MOVE ERNOTE-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16571
 16572
 16573* EXEC CICS DELETE
 16574*        DATASET   (FILE-ID-ERNOTE)
 16575*    END-EXEC.
 16576*    MOVE '&(                    &   #00014342' TO DFHEIV0
 16577     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16578     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16579     MOVE X'2020233030303134333432' TO DFHEIV0(25:11)
 16580     CALL 'kxdfhei1' USING DFHEIV0,
 16581           FILE-ID-ERNOTE,
 16582           DFHEIV99,
 16583           DFHEIV99,
 16584           DFHEIV99,
 16585           DFHEIV99
 16586     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16587
 16588
 16589     PERFORM 8400-LOG-JOURNAL-RECORD.
 16590
 16591******************************************************************
 16592*     DELETE MAILING ADDRESS RECORDS FOR DELETED CERTIFICATES    *
 16593******************************************************************
 16594
 16595 2827-DELETE-MAILING.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 305
* EL6311.cbl
 16596     IF CERT-ADDRESS-PRESENT
 16597        NEXT SENTENCE
 16598     ELSE
 16599        GO TO 2830-BUILD-NEW-ISSUE-RECORD.
 16600
 16601
 16602* EXEC CICS HANDLE CONDITION
 16603*         NOTFND  (2830-BUILD-NEW-ISSUE-RECORD)
 16604*    END-EXEC.
 16605*    MOVE '"$I                   ! A #00014358' TO DFHEIV0
 16606     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16607     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16608     MOVE X'4120233030303134333538' TO DFHEIV0(25:11)
 16609     CALL 'kxdfhei1' USING DFHEIV0
 16610     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16611
 16612
 16613     MOVE ELCERT-KEY             TO ERMAIL-KEY.
 16614
 16615
 16616* EXEC CICS READ
 16617*        EQUAL
 16618*        DATASET   (FILE-ID-ERMAIL)
 16619*        SET       (ADDRESS OF MAILING-DATA)
 16620*        RIDFLD    (ERMAIL-KEY)
 16621*        UPDATE
 16622*    END-EXEC.
 16623*    MOVE '&"S        EU         (   #00014364' TO DFHEIV0
 16624     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16625     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16626     MOVE X'2020233030303134333634' TO DFHEIV0(25:11)
 16627     CALL 'kxdfhei1' USING DFHEIV0,
 16628           FILE-ID-ERMAIL,
 16629           DFHEIV20,
 16630           DFHEIV99,
 16631           ERMAIL-KEY,
 16632           DFHEIV99,
 16633           DFHEIV99,
 16634           DFHEIV99
 16635     SET ADDRESS OF MAILING-DATA TO
 16636         DFHEIV20
 16637     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16638
 16639
 16640     MOVE FILE-ID-ERMAIL         TO  JP-FILE-ID.
 16641     MOVE 'D'                    TO  JP-RECORD-TYPE.
 16642     MOVE MAILING-DATA           TO  JP-RECORD-AREA.
 16643
 16644     MOVE ERMAIL-JOURNAL-LENGTH  TO  WS-JOURNAL-RECORD-LENGTH.
 16645
 16646
 16647* EXEC CICS DELETE
 16648*        DATASET   (FILE-ID-ERMAIL)
 16649*    END-EXEC.
 16650*    MOVE '&(                    &   #00014378' TO DFHEIV0
 16651     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16652     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16653     MOVE X'2020233030303134333738' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 306
* EL6311.cbl
 16654     CALL 'kxdfhei1' USING DFHEIV0,
 16655           FILE-ID-ERMAIL,
 16656           DFHEIV99,
 16657           DFHEIV99,
 16658           DFHEIV99,
 16659           DFHEIV99
 16660     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16661
 16662
 16663     PERFORM 8400-LOG-JOURNAL-RECORD.
 16664
 16665 2830-BUILD-NEW-ISSUE-RECORD.
 16666     MOVE SPACES                 TO ELCERT-KEY.
 16667
 16668     IF  BCERTNOL GREATER THAN ZEROS
 16669         MOVE BCERTNOI           TO  PB-CERT-PRIME.
 16670
 16671     IF  BSUFIXL  GREATER THAN ZEROS
 16672         MOVE BSUFIXI            TO  PB-CERT-SFX.
 16673
 16674     IF BEFFDTL GREATER THAN ZEROS
 16675        MOVE  WS-CONVERTED-EFFDT TO  PB-CERT-EFF-DT.
 16676
 16677 2870-WRITE-PENDING-BUSINESS.
 16678     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 16679     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 16680     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 16681     MOVE '5'                    TO DC-OPTION-CODE.
 16682     PERFORM 9700-DATE-LINK.
 16683     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 16684
 16685     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 16686
 16687     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 16688     MOVE 'A'                    TO JP-RECORD-TYPE.
 16689     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16690
 16691
 16692* EXEC CICS WRITE
 16693*        DATASET  (FILE-ID-ERPNDB)
 16694*        FROM     (PENDING-BUSINESS)
 16695*        RIDFLD   (PB-CONTROL-PRIMARY)
 16696*    END-EXEC.
 16697     MOVE LENGTH OF
 16698      PENDING-BUSINESS
 16699       TO DFHEIV11
 16700*    MOVE '&$ L                  ''   #00014410' TO DFHEIV0
 16701     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16702     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16703     MOVE X'2020233030303134343130' TO DFHEIV0(25:11)
 16704     CALL 'kxdfhei1' USING DFHEIV0,
 16705           FILE-ID-ERPNDB,
 16706           PENDING-BUSINESS,
 16707           DFHEIV11,
 16708           PB-CONTROL-PRIMARY,
 16709           DFHEIV99,
 16710           DFHEIV99
 16711     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 307
* EL6311.cbl
 16712
 16713
 16714     MOVE ERPNDB-JOURNAL-LENGTH TO WS-JOURNAL-RECORD-LENGTH.
 16715
 16716     PERFORM 8400-LOG-JOURNAL-RECORD.
 16717
 16718     GO TO 1325-PROCESS-ISSUE-CHANGES.
 16719
 16720 2885-RECORD-MISSING.
 16721     MOVE -1                     TO BMAINTL
 16722     MOVE AL-UABON               TO BMAINTA
 16723     MOVE ER-2902                TO EMI-ERROR.
 16724     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16725     GO TO 8200-SEND-DATAONLY.
 16726
 16727 2890-DUPLICATE-RECORD.
 16728     MOVE -1                     TO BMAINTL.
 16729     MOVE AL-UABON               TO BCERTNOA.
 16730     MOVE AL-UNBON               TO BEFFDTA.
 16731     MOVE SPACE                  TO BMAINTI.
 16732
 16733     MOVE 1                      TO EMI-SUB
 16734                                    EMI-SWITCH1
 16735                                    EMI-SWITCH-AREA-1
 16736                                    EMI-SWITCH-AREA-2.
 16737
 16738     MOVE SPACES                 TO EMI-ERROR-LINES.
 16739
 16740
 16741* EXEC CICS SYNCPOINT ROLLBACK
 16742*    END-EXEC.
 16743*    MOVE '6"R                   !   #00014442' TO DFHEIV0
 16744     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 16745     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16746     MOVE X'2020233030303134343432' TO DFHEIV0(25:11)
 16747     CALL 'kxdfhei1' USING DFHEIV0
 16748     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16749
 16750
 16751     MOVE ER-2247                TO EMI-ERROR.
 16752     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.
 16753     GO TO 8200-SEND-DATAONLY.
 16754
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 308
* EL6311.cbl
 16756
 16757******************************************************************
 16758*                                                                *
 16759*         R E W R I T E   C A N C E L   C E R T.   K E Y         *
 16760*                                                                *
 16761******************************************************************
 16762
 16763 2900-REWRITE-CAN-CERT-KEY.
 16764     MOVE  PI-PREV-ALT-KEY       TO  ERPNDB-ALT-KEY.
 16765
 16766     IF  CCERTNOL GREATER THAN ZEROS
 16767         MOVE  CCERTNOI          TO  ERPNDB-CERT-PRIME.
 16768
 16769     IF  CSUFIXL  GREATER THAN ZEROS
 16770         MOVE  CSUFIXI           TO  ERPNDB-CERT-SFX.
 16771
 16772     IF  CEFFDTL  GREATER THAN ZEROS
 16773         MOVE WS-CONVERTED-EFFDT TO  ERPNDB-CERT-EFF-DT.
 16774
 16775 2910-READ-BY-ACCOUNT.
 16776
 16777* EXEC CICS HANDLE CONDITION
 16778*         NOTFND    (2920-PROCESS-REWRITE)
 16779*    END-EXEC.
 16780*    MOVE '"$I                   ! B #00014470' TO DFHEIV0
 16781     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16782     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16783     MOVE X'4220233030303134343730' TO DFHEIV0(25:11)
 16784     CALL 'kxdfhei1' USING DFHEIV0
 16785     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16786
 16787
 16788
 16789* EXEC CICS READ
 16790*        SET     (ADDRESS OF PENDING-BUSINESS)
 16791*        DATASET (FILE-ID-ERPNDB2)
 16792*        RIDFLD  (ERPNDB-ALT-KEY)
 16793*    END-EXEC.
 16794*    MOVE '&"S        E          (   #00014474' TO DFHEIV0
 16795     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16796     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16797     MOVE X'2020233030303134343734' TO DFHEIV0(25:11)
 16798     CALL 'kxdfhei1' USING DFHEIV0,
 16799           FILE-ID-ERPNDB2,
 16800           DFHEIV20,
 16801           DFHEIV99,
 16802           ERPNDB-ALT-KEY,
 16803           DFHEIV99,
 16804           DFHEIV99,
 16805           DFHEIV99
 16806     SET ADDRESS OF PENDING-BUSINESS TO
 16807         DFHEIV20
 16808     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16809
 16810
 16811     GO TO 2990-DUPLICATE-RECORD.
 16812
 16813  2920-PROCESS-REWRITE.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 309
* EL6311.cbl
 16814
 16815* EXEC CICS HANDLE CONDITION
 16816*         NOTFND    (2985-RECORD-MISSING)
 16817*    END-EXEC.
 16818*    MOVE '"$I                   ! C #00014483' TO DFHEIV0
 16819     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16820     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16821     MOVE X'4320233030303134343833' TO DFHEIV0(25:11)
 16822     CALL 'kxdfhei1' USING DFHEIV0
 16823     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16824
 16825
 16826     MOVE  PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 16827
 16828
 16829* EXEC CICS READ
 16830*        SET     (ADDRESS OF PENDING-BUSINESS)
 16831*        DATASET (FILE-ID-ERPNDB)
 16832*        RIDFLD  (ERPNDB-KEY)
 16833*        UPDATE
 16834*    END-EXEC.
 16835*    MOVE '&"S        EU         (   #00014489' TO DFHEIV0
 16836     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16837     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16838     MOVE X'2020233030303134343839' TO DFHEIV0(25:11)
 16839     CALL 'kxdfhei1' USING DFHEIV0,
 16840           FILE-ID-ERPNDB,
 16841           DFHEIV20,
 16842           DFHEIV99,
 16843           ERPNDB-KEY,
 16844           DFHEIV99,
 16845           DFHEIV99,
 16846           DFHEIV99
 16847     SET ADDRESS OF PENDING-BUSINESS TO
 16848         DFHEIV20
 16849     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16850
 16851
 16852     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 16853     MOVE 'D'                    TO JP-RECORD-TYPE.
 16854     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16855     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16856
 16857     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 16858
 16859     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 16860     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 16861     MOVE PB-SV-STATE            TO ELCERT-STATE.
 16862
 16863
 16864* EXEC CICS DELETE
 16865*        DATASET    (FILE-ID-ERPNDB)
 16866*    END-EXEC.
 16867*    MOVE '&(                    &   #00014507' TO DFHEIV0
 16868     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16869     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16870     MOVE X'2020233030303134353037' TO DFHEIV0(25:11)
 16871     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 310
* EL6311.cbl
 16872           FILE-ID-ERPNDB,
 16873           DFHEIV99,
 16874           DFHEIV99,
 16875           DFHEIV99,
 16876           DFHEIV99
 16877     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16878
 16879
 16880     PERFORM 8400-LOG-JOURNAL-RECORD.
 16881
 16882
 16883* EXEC CICS GETMAIN
 16884*        SET      (ADDRESS OF PENDING-BUSINESS)
 16885*        LENGTH   (ERPNDB-RECORD-LENGTH)
 16886*        INITIMG  (GETMAIN-SPACE)
 16887*    END-EXEC.
 16888*    MOVE ',"IL                  $   #00014513' TO DFHEIV0
 16889     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16890     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16891     MOVE X'2020233030303134353133' TO DFHEIV0(25:11)
 16892     CALL 'kxdfhei1' USING DFHEIV0,
 16893           DFHEIV20,
 16894           ERPNDB-RECORD-LENGTH,
 16895           GETMAIN-SPACE
 16896     SET ADDRESS OF PENDING-BUSINESS TO
 16897         DFHEIV20
 16898     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16899
 16900
 16901     MOVE JP-RECORD-AREA         TO PENDING-BUSINESS.
 16902
 16903 2950-PROCESS-CANCELS.
 16904
 16905
 16906* EXEC CICS HANDLE CONDITION
 16907*         NOTFND  (2960-BUILD-NEW-CANCEL-RECORD)
 16908*    END-EXEC.
 16909*    MOVE '"$I                   ! D #00014523' TO DFHEIV0
 16910     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16911     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16912     MOVE X'4420233030303134353233' TO DFHEIV0(25:11)
 16913     CALL 'kxdfhei1' USING DFHEIV0
 16914     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16915
 16916
 16917
 16918* EXEC CICS READ
 16919*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 16920*        DATASET (FILE-ID-ELCERT)
 16921*        RIDFLD  (ELCERT-KEY)
 16922*        UPDATE
 16923*    END-EXEC.
 16924*    MOVE '&"S        EU         (   #00014527' TO DFHEIV0
 16925     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16926     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16927     MOVE X'2020233030303134353237' TO DFHEIV0(25:11)
 16928     CALL 'kxdfhei1' USING DFHEIV0,
 16929           FILE-ID-ELCERT,
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 311
* EL6311.cbl
 16930           DFHEIV20,
 16931           DFHEIV99,
 16932           ELCERT-KEY,
 16933           DFHEIV99,
 16934           DFHEIV99,
 16935           DFHEIV99
 16936     SET ADDRESS OF CERTIFICATE-MASTER TO
 16937         DFHEIV20
 16938     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16939
 16940
 16941     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 16942
 16943     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 16944     MOVE 'B'                      TO JP-RECORD-TYPE.
 16945     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 16946     PERFORM 8400-LOG-JOURNAL-RECORD.
 16947
 16948     IF PB-CI-LIVES NOT NUMERIC
 16949         MOVE ZERO                    TO PB-CI-LIVES.
 16950
 16951     IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 16952        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 16953        MOVE ZERO                     TO CM-LF-ITD-CANCEL-AMT
 16954        MOVE LOW-VALUES               TO CM-LF-CANCEL-EXIT-DT
 16955                                         CM-LF-CANCEL-DT
 16956     ELSE
 16957        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 16958        MOVE PB-CI-LF-CANCEL-AMT      TO CM-LF-ITD-CANCEL-AMT
 16959        MOVE PB-CI-LF-PRIOR-CANCEL-DT TO CM-LF-CANCEL-DT
 16960        MOVE PB-CI-LIVES              TO CM-LIVES.
 16961
 16962     IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 16963        IF CM-LF-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 16964            MOVE CM-LF-STATUS-AT-CANCEL
 16965                                     TO CM-LF-CURRENT-STATUS
 16966            MOVE SPACE
 16967                                     TO CM-LF-STATUS-AT-CANCEL
 16968        ELSE
 16969            MOVE PB-CI-LF-POLICY-STATUS
 16970                                     TO CM-LF-CURRENT-STATUS
 16971     ELSE
 16972        MOVE PB-CI-LF-POLICY-STATUS  TO CM-LF-CURRENT-STATUS.
 16973
 16974     IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 16975        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 16976        MOVE ZERO                     TO CM-AH-ITD-CANCEL-AMT
 16977        MOVE LOW-VALUES               TO CM-AH-CANCEL-EXIT-DT
 16978                                         CM-AH-CANCEL-DT
 16979     ELSE
 16980        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 16981        MOVE PB-CI-AH-CANCEL-AMT      TO CM-AH-ITD-CANCEL-AMT
 16982        MOVE PB-CI-AH-PRIOR-CANCEL-DT TO CM-AH-CANCEL-DT
 16983        MOVE PB-CI-LIVES              TO CM-LIVES.
 16984
 16985     IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 16986        IF CM-AH-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 16987            MOVE CM-AH-STATUS-AT-CANCEL
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 312
* EL6311.cbl
 16988                                     TO CM-AH-CURRENT-STATUS
 16989            MOVE SPACE
 16990                                     TO CM-AH-STATUS-AT-CANCEL
 16991        ELSE
 16992            MOVE PB-CI-AH-POLICY-STATUS
 16993                                     TO CM-AH-CURRENT-STATUS
 16994     ELSE
 16995        MOVE PB-CI-AH-POLICY-STATUS  TO CM-AH-CURRENT-STATUS.
 16996
 16997 2975-REWRITE-CERT.
 16998     MOVE 'C'                      TO JP-RECORD-TYPE.
 16999     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 17000
 17001
 17002* EXEC CICS REWRITE
 17003*        DATASET    (FILE-ID-ELCERT)
 17004*        FROM       (CERTIFICATE-MASTER)
 17005*    END-EXEC.
 17006     MOVE LENGTH OF
 17007      CERTIFICATE-MASTER
 17008       TO DFHEIV11
 17009*    MOVE '&& L                  %   #00014594' TO DFHEIV0
 17010     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17011     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17012     MOVE X'2020233030303134353934' TO DFHEIV0(25:11)
 17013     CALL 'kxdfhei1' USING DFHEIV0,
 17014           FILE-ID-ELCERT,
 17015           CERTIFICATE-MASTER,
 17016           DFHEIV11,
 17017           DFHEIV99
 17018     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17019
 17020
 17021     PERFORM 8400-LOG-JOURNAL-RECORD.
 17022
 17023 2960-BUILD-NEW-CANCEL-RECORD.
 17024     IF  CCERTNOL GREATER THAN ZEROS
 17025         MOVE CCERTNOI            TO PB-CERT-PRIME.
 17026
 17027     IF  CSUFIXL  GREATER THAN ZEROS
 17028         MOVE CSUFIXI             TO PB-CERT-SFX.
 17029
 17030     IF  CEFFDTL  GREATER  THAN ZEROS
 17031         MOVE WS-CONVERTED-EFFDT  TO PB-CERT-EFF-DT.
 17032
 17033 2970-WRITE-PENDING-BUSINESS.
 17034     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 17035     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 17036     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 17037     MOVE '5'                    TO DC-OPTION-CODE.
 17038     PERFORM 9700-DATE-LINK.
 17039     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 17040
 17041     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 17042
 17043     MOVE SPACES                 TO PB-CI-INSURED-NAME
 17044                                    PB-CI-INSURED-SEX
 17045                                    PB-CI-LF-BENEFIT-CD
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 313
* EL6311.cbl
 17046                                    PB-CI-AH-BENEFIT-CD
 17047                                    PB-CI-RATE-CLASS
 17048                                    PB-CI-RATE-DEV-LF
 17049                                    PB-CI-RATE-DEV-AH
 17050                                    PB-CI-LF-ABBR
 17051                                    PB-CI-AH-ABBR
 17052                                    PB-CI-OB-FLAG
 17053                                    PB-CI-LF-POLICY-STATUS
 17054                                    PB-CI-AH-POLICY-STATUS
 17055                                    PB-CI-INDV-GRP-CD
 17056                                    PB-CI-BENEFICIARY-NAME
 17057                                    PB-CI-NOTE-SW
 17058                                    PB-CI-SOC-SEC-NO
 17059                                    PB-CI-MEMBER-NO
 17060                                    PB-CI-INT-CODE
 17061                                    PB-CI-COMP-EXCP-SW
 17062                                    PB-CI-ENTRY-STATUS
 17063                                    PB-CI-CREDIT-INTERFACE-SW-1
 17064                                    PB-CI-CREDIT-INTERFACE-SW-2
 17065                                    PB-CI-ENTRY-BATCH.
 17066
 17067     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
 17068                                    PB-CI-AH-SETTLEMENT-DT
 17069                                    PB-CI-DEATH-DT
 17070                                    PB-CI-LF-PRIOR-CANCEL-DT
 17071                                    PB-CI-AH-PRIOR-CANCEL-DT
 17072                                    PB-CI-LOAN-1ST-PMT-DT
 17073                                    PB-CI-ENTRY-DT
 17074                                    PB-CI-LF-EXPIRE-DT
 17075                                    PB-CI-AH-EXPIRE-DT.
 17076
 17077     MOVE ZEROS                  TO PB-CI-INSURED-AGE
 17078                                    PB-CI-LF-TERM
 17079                                    PB-CI-LF-BENEFIT-AMT
 17080                                    PB-CI-LF-ALT-BENEFIT-AMT
 17081                                    PB-CI-LF-PREMIUM-AMT
 17082                                    PB-CI-LF-ALT-PREMIUM-AMT
 17083                                    PB-CI-AH-TERM
 17084                                    PB-CI-AH-BENEFIT-AMT
 17085                                    PB-CI-AH-PREMIUM-AMT
 17086                                    PB-CI-RATE-DEV-PCT-LF
 17087                                    PB-CI-RATE-DEV-PCT-AH
 17088                                    PB-CI-LIFE-COMMISSION
 17089                                    PB-CI-AH-COMMISSION
 17090                                    PB-CI-PAY-FREQUENCY
 17091                                    PB-CI-LOAN-APR
 17092                                    PB-CI-LOAN-TERM
 17093                                    PB-CI-CURR-SEQ
 17094                                    PB-CI-AH-CANCEL-AMT
 17095                                    PB-CI-LF-CANCEL-AMT
 17096                                    PB-CI-EXTENTION-DAYS
 17097                                    PB-CI-TERM-IN-DAYS
 17098                                    PB-CI-LOAN-OFFICER
 17099                                    PB-CI-LIVES
 17100                                    PB-CI-LF-CRIT-PER
 17101                                    PB-CI-AH-CRIT-PER
 17102                                    PB-C-LF-REM-TERM
 17103                                    PB-C-AH-REM-TERM.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 314
* EL6311.cbl
 17104
 17105     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 17106     MOVE 'A'                    TO JP-RECORD-TYPE.
 17107     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17108
 17109
 17110* EXEC CICS HANDLE CONDITION
 17111*        DUPREC   (2990-DUPLICATE-RECORD)
 17112*    END-EXEC.
 17113*    MOVE '"$%                   ! E #00014687' TO DFHEIV0
 17114     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 17115     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17116     MOVE X'4520233030303134363837' TO DFHEIV0(25:11)
 17117     CALL 'kxdfhei1' USING DFHEIV0
 17118     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17119
 17120
 17121
 17122* EXEC CICS WRITE
 17123*        DATASET  (FILE-ID-ERPNDB)
 17124*        FROM     (PENDING-BUSINESS)
 17125*        RIDFLD   (PB-CONTROL-PRIMARY)
 17126*    END-EXEC.
 17127     MOVE LENGTH OF
 17128      PENDING-BUSINESS
 17129       TO DFHEIV11
 17130*    MOVE '&$ L                  ''   #00014691' TO DFHEIV0
 17131     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17132     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17133     MOVE X'2020233030303134363931' TO DFHEIV0(25:11)
 17134     CALL 'kxdfhei1' USING DFHEIV0,
 17135           FILE-ID-ERPNDB,
 17136           PENDING-BUSINESS,
 17137           DFHEIV11,
 17138           PB-CONTROL-PRIMARY,
 17139           DFHEIV99,
 17140           DFHEIV99
 17141     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17142
 17143
 17144     MOVE ERPNDB-RECORD-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 17145
 17146     PERFORM 8400-LOG-JOURNAL-RECORD.
 17147
 17148     GO TO 2325-PROCESS-CANCEL-CHANGES.
 17149
 17150 2985-RECORD-MISSING.
 17151     MOVE -1                     TO CMAINTL
 17152     MOVE AL-UABON               TO CMAINTA.
 17153
 17154     MOVE ER-2902                TO EMI-ERROR.
 17155     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17156     GO TO 8200-SEND-DATAONLY.
 17157
 17158 2990-DUPLICATE-RECORD.
 17159     MOVE SPACE                  TO CMAINTI.
 17160     MOVE -1                     TO CMAINTL.
 17161     MOVE AL-UABON               TO CCERTNOA.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 315
* EL6311.cbl
 17162     MOVE AL-UNBON               TO CEFFDTA.
 17163
 17164     MOVE 1                      TO EMI-SUB
 17165                                    EMI-SWITCH1
 17166                                    EMI-SWITCH-AREA-1
 17167                                    EMI-SWITCH-AREA-2.
 17168     MOVE SPACES                 TO EMI-ERROR-LINES.
 17169
 17170
 17171* EXEC CICS SYNCPOINT ROLLBACK
 17172*    END-EXEC.
 17173*    MOVE '6"R                   !   #00014723' TO DFHEIV0
 17174     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17175     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17176     MOVE X'2020233030303134373233' TO DFHEIV0(25:11)
 17177     CALL 'kxdfhei1' USING DFHEIV0
 17178     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17179
 17180
 17181     MOVE ER-2247                TO EMI-ERROR.
 17182     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17183     GO TO 8200-SEND-DATAONLY.
 17184
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 316
* EL6311.cbl
 17186
 17187***************************************************************
 17188*     ROUTINE TO CALCULATE THE TOTAL OF ALL GOOD AND BAD      *
 17189*     PREMIUM FOR A SINGLE BATCH.                             *
 17190*         ACTIVATED VIA THE PF3 FROM THE BATCH TOTAL SCREEN.  *
 17191***************************************************************
 17192
 17193 3000-BATCH-MAINLINE.
 17194     IF PI-PREV-KEY NOT = SPACES
 17195         MOVE PI-PREV-KEY        TO ERPNDB-KEY
 17196     ELSE
 17197         MOVE PI-ERPNDB-KEY      TO ERPNDB-KEY.
 17198
 17199     MOVE +1                     TO ERPNDB-BATCH-SEQ-NO.
 17200
 17201 3010-READNEXT.
 17202
 17203* EXEC CICS READ
 17204*         DATASET    (FILE-ID-ERPNDB)
 17205*         SET        (ADDRESS OF PENDING-BUSINESS)
 17206*         RIDFLD     (ERPNDB-KEY)
 17207*         GTEQ
 17208*    END-EXEC.
 17209*    MOVE '&"S        G          (   #00014747' TO DFHEIV0
 17210     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 17211     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17212     MOVE X'2020233030303134373437' TO DFHEIV0(25:11)
 17213     CALL 'kxdfhei1' USING DFHEIV0,
 17214           FILE-ID-ERPNDB,
 17215           DFHEIV20,
 17216           DFHEIV99,
 17217           ERPNDB-KEY,
 17218           DFHEIV99,
 17219           DFHEIV99,
 17220           DFHEIV99
 17221     SET ADDRESS OF PENDING-BUSINESS TO
 17222         DFHEIV20
 17223     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17224
 17225
 17226     IF PB-COMPANY-CD  NOT = ERPNDB-COMPANY-CD OR
 17227        PB-ENTRY-BATCH NOT = ERPNDB-ENTRY-BATCH
 17228          GO TO 3030-END-BATCH.
 17229
 17230     MOVE PB-CONTROL-PRIMARY     TO ERPNDB-KEY.
 17231
 17232     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 17233        PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 17234          GO TO 3020-BUMP-SEQ.
 17235
 17236     IF PB-ISSUE
 17237        ADD +1                   TO WS-ISS-TOTAL-CNT
 17238        IF PB-FATAL-ERRORS
 17239           ADD +1                      TO WS-ISS-FATAL-CNT
 17240           PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 17241           GO TO 3020-BUMP-SEQ
 17242        ELSE
 17243           IF PB-UNFORCED-ERRORS
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 317
* EL6311.cbl
 17244              ADD +1                      TO WS-ISS-FORCE-CNT
 17245              PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 17246              GO TO 3020-BUMP-SEQ
 17247           ELSE
 17248              IF PB-RECORD-ON-HOLD OR PB-RECORD-RETURNED
 17249                 ADD +1                      TO WS-ISS-HOLD-CNT
 17250                 PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 17251                 GO TO 3020-BUMP-SEQ
 17252              ELSE
 17253                 PERFORM 3200-ADD-GOOD-ISSUE-PREM
 17254                     THRU  3299-EXIT
 17255                 GO TO 3020-BUMP-SEQ.
 17256
 17257     IF PB-CANCELLATION
 17258        ADD +1                   TO WS-CAN-TOTAL-CNT
 17259        IF PB-FATAL-ERRORS
 17260           ADD +1                 TO WS-CAN-FATAL-CNT
 17261           PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 17262           GO TO 3020-BUMP-SEQ
 17263        ELSE
 17264           IF PB-UNFORCED-ERRORS
 17265              ADD +1                 TO WS-CAN-FORCE-CNT
 17266              PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 17267              GO TO 3020-BUMP-SEQ
 17268           ELSE
 17269              IF PB-RECORD-ON-HOLD OR PB-RECORD-RETURNED
 17270                 ADD +1                 TO WS-CAN-HOLD-CNT
 17271                 PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 17272                 GO TO 3020-BUMP-SEQ
 17273              ELSE
 17274                 PERFORM 3400-ADD-GOOD-CANCEL-PREM
 17275                     THRU  3499-EXIT
 17276                 GO TO 3020-BUMP-SEQ.
 17277
 17278     IF PB-BATCH-TRAILER
 17279         GO TO 3030-END-BATCH.
 17280
 17281 3020-BUMP-SEQ.
 17282     ADD +1                      TO ERPNDB-BATCH-SEQ-NO.
 17283     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 17284     GO TO 3010-READNEXT.
 17285
 17286 3030-END-BATCH.
 17287     MOVE WS-ISS-TOTAL-CNT       TO DITOTALO.
 17288     MOVE WS-ISS-FATAL-CNT       TO DIFATALO.
 17289     MOVE WS-ISS-FORCE-CNT       TO DIFORCEO.
 17290     MOVE WS-ISS-HOLD-CNT        TO DIHOLDO.
 17291
 17292     COMPUTE DIAVAILO = (WS-ISS-TOTAL-CNT - WS-ISS-FATAL-CNT
 17293                                          - WS-ISS-FORCE-CNT
 17294                                          - WS-ISS-HOLD-CNT).
 17295
 17296     MOVE WS-ISS-GOOD-PREM       TO DIGPREMO.
 17297     MOVE WS-ISS-BAD-PREM        TO DIBPREMO.
 17298
 17299     MOVE WS-CAN-TOTAL-CNT       TO DCTOTALO.
 17300     MOVE WS-CAN-FATAL-CNT       TO DCFATALO.
 17301     MOVE WS-CAN-FORCE-CNT       TO DCFORCEO.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 318
* EL6311.cbl
 17302     MOVE WS-CAN-HOLD-CNT        TO DCHOLDO.
 17303     COMPUTE DCAVAILO = (WS-CAN-TOTAL-CNT - WS-CAN-FATAL-CNT
 17304                                          - WS-CAN-FORCE-CNT
 17305                                          - WS-CAN-HOLD-CNT).
 17306     MOVE WS-CAN-GOOD-PREM       TO DCGPREMO.
 17307     MOVE WS-CAN-BAD-PREM        TO DCBPREMO.
 17308
 17309     COMPUTE WS-NET-TOTAL-CNT
 17310         = WS-ISS-TOTAL-CNT - WS-CAN-TOTAL-CNT.
 17311     MOVE WS-NET-TOTAL-CNT       TO DNTOTALO.
 17312     COMPUTE WS-NET-FATAL-CNT
 17313         = WS-ISS-FATAL-CNT - WS-CAN-FATAL-CNT.
 17314     MOVE WS-NET-FATAL-CNT       TO DNFATALO.
 17315     COMPUTE WS-NET-FORCE-CNT
 17316         = WS-ISS-FORCE-CNT - WS-CAN-FORCE-CNT.
 17317     MOVE WS-NET-FORCE-CNT       TO DNFORCEO.
 17318     COMPUTE WS-NET-HOLD-CNT
 17319         = WS-ISS-HOLD-CNT - WS-CAN-HOLD-CNT.
 17320     MOVE WS-NET-HOLD-CNT        TO DNHOLDO.
 17321
 17322     COMPUTE WS-NET-AVAIL-CNT
 17323          = (WS-ISS-TOTAL-CNT - WS-ISS-FATAL-CNT
 17324                              - WS-ISS-FORCE-CNT
 17325                              - WS-ISS-HOLD-CNT)
 17326          - (WS-CAN-TOTAL-CNT - WS-CAN-FATAL-CNT
 17327                              - WS-CAN-FORCE-CNT
 17328                              - WS-CAN-HOLD-CNT).
 17329     MOVE WS-NET-AVAIL-CNT       TO DNAVAILO.
 17330
 17331     COMPUTE WS-NET-GOOD-PREM
 17332         = WS-ISS-GOOD-PREM - WS-CAN-GOOD-PREM.
 17333     MOVE WS-NET-GOOD-PREM       TO DNGPREMO.
 17334     COMPUTE WS-NET-BAD-PREM
 17335         = WS-ISS-BAD-PREM - WS-CAN-BAD-PREM.
 17336     MOVE WS-NET-BAD-PREM        TO DNBPREMO.
 17337
 17338     MOVE 0000                   TO EMI-ERROR.
 17339     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17340     MOVE -1                     TO DPFENTRL.
 17341     GO TO 8200-SEND-DATAONLY.
 17342
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 319
* EL6311.cbl
 17344
 17345******************************************************************
 17346*                                                                *
 17347*           A D D    B A D   I S S U E   P R E M I U M           *
 17348*                                                                *
 17349******************************************************************
 17350
 17351 3100-ADD-BAD-ISSUE-PREM.
 17352     IF PB-OVERRIDE-LIFE
 17353       OR PB-OVERRIDE-BOTH
 17354           ADD PB-I-LF-PREM-CALC       TO  WS-ISS-BAD-PREM
 17355           ADD PB-I-LF-ALT-PREM-CALC   TO  WS-ISS-BAD-PREM
 17356       ELSE
 17357           ADD PB-I-LF-PREMIUM-AMT     TO  WS-ISS-BAD-PREM
 17358           ADD PB-I-LF-ALT-PREMIUM-AMT TO  WS-ISS-BAD-PREM.
 17359
 17360     IF PB-OVERRIDE-AH
 17361       OR PB-OVERRIDE-BOTH
 17362           ADD PB-I-AH-PREM-CALC       TO  WS-ISS-BAD-PREM
 17363       ELSE
 17364           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-BAD-PREM.
 17365
 17366 3199-EXIT.
 17367     EXIT.
 17368
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 320
* EL6311.cbl
 17370
 17371******************************************************************
 17372*                                                                *
 17373*       A D D   G O O D   I S S U E   P R E M I U M              *
 17374*                                                                *
 17375******************************************************************
 17376
 17377 3200-ADD-GOOD-ISSUE-PREM.
 17378     IF PB-OVERRIDE-LIFE
 17379       OR PB-OVERRIDE-BOTH
 17380           ADD PB-I-LF-PREM-CALC       TO  WS-ISS-GOOD-PREM
 17381           ADD PB-I-LF-ALT-PREM-CALC   TO  WS-ISS-GOOD-PREM
 17382       ELSE
 17383           ADD PB-I-LF-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM
 17384           ADD PB-I-LF-ALT-PREMIUM-AMT TO  WS-ISS-GOOD-PREM.
 17385
 17386     IF PB-OVERRIDE-AH
 17387       OR PB-OVERRIDE-BOTH
 17388           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM
 17389       ELSE
 17390           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM.
 17391
 17392 3299-EXIT.
 17393     EXIT.
 17394
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 321
* EL6311.cbl
 17396
 17397
 17398******************************************************************
 17399*                                                                *
 17400*        A D D   B A D   C A N C E L   P R E M I U M             *
 17401*                                                                *
 17402******************************************************************
 17403
 17404 3300-ADD-BAD-CANCEL-PREM.
 17405     IF PB-OVERRIDE-LIFE
 17406       OR PB-OVERRIDE-BOTH
 17407           ADD PB-C-LF-REF-CALC   TO  WS-CAN-BAD-PREM
 17408       ELSE
 17409           ADD PB-C-LF-CANCEL-AMT TO  WS-CAN-BAD-PREM.
 17410
 17411     IF PB-OVERRIDE-AH
 17412       OR PB-OVERRIDE-BOTH
 17413           ADD PB-C-AH-REF-CALC   TO  WS-CAN-BAD-PREM
 17414       ELSE
 17415           ADD PB-C-AH-CANCEL-AMT TO  WS-CAN-BAD-PREM.
 17416
 17417 3399-EXIT.
 17418     EXIT.
 17419
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 322
* EL6311.cbl
 17421
 17422******************************************************************
 17423*                                                                *
 17424*       A D D   G O O D   C A N C E L   P R E M I U M            *
 17425*                                                                *
 17426******************************************************************
 17427
 17428 3400-ADD-GOOD-CANCEL-PREM.
 17429     IF PB-OVERRIDE-LIFE
 17430       OR PB-OVERRIDE-BOTH
 17431           ADD PB-C-LF-REF-CALC   TO  WS-CAN-GOOD-PREM
 17432       ELSE
 17433           ADD PB-C-LF-CANCEL-AMT TO  WS-CAN-GOOD-PREM.
 17434
 17435     IF PB-OVERRIDE-AH
 17436       OR PB-OVERRIDE-BOTH
 17437           ADD PB-C-AH-REF-CALC   TO  WS-CAN-GOOD-PREM
 17438       ELSE
 17439           ADD PB-C-AH-CANCEL-AMT TO  WS-CAN-GOOD-PREM.
 17440
 17441 3499-EXIT.
 17442     EXIT.
 17443
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 323
* EL6311.cbl
 17445
 17446******************************************************************
 17447*                                                                *
 17448*           E D I T   B A T C H   D A T A                        *
 17449*                                                                *
 17450******************************************************************
 17451
 17452 3500-EDIT-BATCH-DATA.
 17453     IF PI-PREV-KEY NOT = SPACES
 17454        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 17455     ELSE
 17456        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY.
 17457
 17458     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 17459     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 17460
 17461
 17462* EXEC CICS HANDLE CONDITION
 17463*         NOTFND      (3590-NOT-FOUND)
 17464*    END-EXEC.
 17465*    MOVE '"$I                   ! F #00014989' TO DFHEIV0
 17466     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17467     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17468     MOVE X'4620233030303134393839' TO DFHEIV0(25:11)
 17469     CALL 'kxdfhei1' USING DFHEIV0
 17470     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17471
 17472
 17473     IF DRISSL   GREATER THAN ZEROS OR
 17474        DRISSL   GREATER THAN ZEROS OR
 17475        DRLFPRML GREATER THAN ZEROS OR
 17476        DRAHPRML GREATER THAN ZEROS OR
 17477        DRCANCL  GREATER THAN ZEROS OR
 17478        DRLFRFDL GREATER THAN ZEROS OR
 17479        DRAHRFDL GREATER THAN ZEROS
 17480              NEXT SENTENCE
 17481          ELSE
 17482              MOVE ER-3224    TO EMI-ERROR
 17483              MOVE -1         TO DPFENTRL
 17484              MOVE AL-UNBON   TO DPFENTRA
 17485              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17486              GO TO 8200-SEND-DATAONLY.
 17487
 17488     IF NOT MODIFY-CAP
 17489         MOVE 'UPDATE'       TO SM-READ
 17490         PERFORM 9995-SECURITY-VIOLATION
 17491         MOVE ER-0070        TO EMI-ERROR
 17492         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17493         GO TO 8100-SEND-INITIAL-MAP.
 17494
 17495        IF DRISSL GREATER THAN ZEROS
 17496           MOVE AL-UNNON         TO DRISSA
 17497           MOVE DRISSI           TO DEEDIT-FIELD
 17498           PERFORM 8600-DEEDIT
 17499           IF DEEDIT-FIELD-V0  NUMERIC
 17500              MOVE DEEDIT-FIELD-V0 TO WS-DRISS
 17501           ELSE
 17502              MOVE ER-2223    TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 324
* EL6311.cbl
 17503              MOVE -1         TO DRISSL
 17504              MOVE AL-UNBON   TO DRISSA
 17505              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17506
 17507        IF DRLFPRML GREATER THAN ZEROS
 17508           MOVE AL-UNNON         TO DRLFPRMA
 17509
 17510* EXEC CICS BIF DEEDIT
 17511*              FIELD  (DRLFPRMI)
 17512*              LENGTH (11)
 17513*          END-EXEC
 17514     MOVE 11
 17515       TO DFHEIV11
 17516*    MOVE '@"L                   #   #00015029' TO DFHEIV0
 17517     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 17518     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 17519     MOVE X'2020233030303135303239' TO DFHEIV0(25:11)
 17520     CALL 'kxdfhei1' USING DFHEIV0,
 17521           DRLFPRMI,
 17522           DFHEIV11
 17523     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17524           IF DRLFPRMI NUMERIC
 17525              MOVE DRLFPRMI   TO WS-DRLFPRM
 17526*          MOVE DRLFPRMI         TO DEEDIT-FIELD
 17527*          PERFORM 8600-DEEDIT
 17528*          IF DEEDIT-FIELD-V2  NUMERIC
 17529*             MOVE DEEDIT-FIELD-V2 TO WS-DRLFPRM
 17530           ELSE
 17531              MOVE ER-2223    TO EMI-ERROR
 17532              MOVE -1         TO DRLFPRML
 17533              MOVE AL-UNBON   TO DRLFPRMA
 17534              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17535
 17536        IF DRAHPRML GREATER THAN ZEROS
 17537           MOVE AL-UNNON         TO DRAHPRMA
 17538
 17539* EXEC CICS BIF DEEDIT
 17540*              FIELD  (DRAHPRMI)
 17541*              LENGTH (11)
 17542*          END-EXEC
 17543     MOVE 11
 17544       TO DFHEIV11
 17545*    MOVE '@"L                   #   #00015047' TO DFHEIV0
 17546     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 17547     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 17548     MOVE X'2020233030303135303437' TO DFHEIV0(25:11)
 17549     CALL 'kxdfhei1' USING DFHEIV0,
 17550           DRAHPRMI,
 17551           DFHEIV11
 17552     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17553           IF DRAHPRMI NUMERIC
 17554              MOVE DRAHPRMI   TO WS-DRAHPRM
 17555*          MOVE DRAHPRMI         TO DEEDIT-FIELD
 17556*          PERFORM 8600-DEEDIT
 17557*          IF DEEDIT-FIELD-V2  NUMERIC
 17558*             MOVE DEEDIT-FIELD-V2 TO WS-DRAHPRM
 17559           ELSE
 17560              MOVE ER-2223    TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 325
* EL6311.cbl
 17561              MOVE -1         TO DRAHPRML
 17562              MOVE AL-UNBON   TO DRAHPRMA
 17563              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17564
 17565        IF DRCANCL GREATER THAN ZEROS
 17566           MOVE AL-UNNON         TO DRCANCA
 17567           MOVE DRCANCI          TO DEEDIT-FIELD
 17568           PERFORM 8600-DEEDIT
 17569           IF DEEDIT-FIELD-V0  NUMERIC
 17570              MOVE DEEDIT-FIELD-V0 TO WS-DRCANC
 17571           ELSE
 17572              MOVE ER-2223    TO EMI-ERROR
 17573              MOVE -1         TO DRCANCL
 17574              MOVE AL-UNBON   TO DRCANCL
 17575              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17576
 17577        IF DRLFRFDL GREATER THAN ZEROS
 17578           MOVE AL-UNNON         TO DRLFRFDA
 17579
 17580* EXEC CICS BIF DEEDIT
 17581*              FIELD  (DRLFRFDI)
 17582*              LENGTH (11)
 17583*          END-EXEC
 17584     MOVE 11
 17585       TO DFHEIV11
 17586*    MOVE '@"L                   #   #00015077' TO DFHEIV0
 17587     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 17588     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 17589     MOVE X'2020233030303135303737' TO DFHEIV0(25:11)
 17590     CALL 'kxdfhei1' USING DFHEIV0,
 17591           DRLFRFDI,
 17592           DFHEIV11
 17593     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17594           IF DRLFRFDI NUMERIC
 17595              MOVE DRLFRFDI   TO WS-DRLFRFD
 17596*          MOVE DRLFRFDI         TO DEEDIT-FIELD
 17597*          PERFORM 8600-DEEDIT
 17598*          IF DEEDIT-FIELD-V2  NUMERIC
 17599*             MOVE DEEDIT-FIELD-V2 TO WS-DRLFRFD
 17600           ELSE
 17601              MOVE ER-2223    TO EMI-ERROR
 17602              MOVE -1         TO DRLFRFDL
 17603              MOVE AL-UNBON   TO DRLFRFDA
 17604              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17605
 17606        IF DRAHRFDL GREATER THAN ZEROS
 17607           MOVE AL-UNNON         TO DRAHRFDA
 17608
 17609* EXEC CICS BIF DEEDIT
 17610*              FIELD  (DRAHRFDI)
 17611*              LENGTH (11)
 17612*          END-EXEC
 17613     MOVE 11
 17614       TO DFHEIV11
 17615*    MOVE '@"L                   #   #00015095' TO DFHEIV0
 17616     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 17617     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 17618     MOVE X'2020233030303135303935' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 326
* EL6311.cbl
 17619     CALL 'kxdfhei1' USING DFHEIV0,
 17620           DRAHRFDI,
 17621           DFHEIV11
 17622     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17623           IF DRAHRFDI NUMERIC
 17624              MOVE DRAHRFDI   TO WS-DRAHRFD
 17625*          MOVE DRAHRFDI         TO DEEDIT-FIELD
 17626*          PERFORM 8600-DEEDIT
 17627*          IF DEEDIT-FIELD-V2  NUMERIC
 17628*             MOVE DEEDIT-FIELD-V2 TO WS-DRAHRFD
 17629           ELSE
 17630              MOVE ER-2223    TO EMI-ERROR
 17631              MOVE -1         TO DRAHRFDL
 17632              MOVE AL-UNBON   TO DRAHRFDA
 17633              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17634
 17635     IF EMI-ERROR = ZEROS
 17636        GO 3600-UPDATE-BATCH-HEADER.
 17637
 17638     GO TO 8200-SEND-DATAONLY.
 17639
 17640 3590-NOT-FOUND.
 17641     MOVE ER-2192                TO EMI-ERROR.
 17642     MOVE -1                     TO DPFENTRL.
 17643     MOVE AL-UNBON               TO DPFENTRA.
 17644     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17645     GO TO 8200-SEND-DATAONLY.
 17646
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 327
* EL6311.cbl
 17648
 17649******************************************************************
 17650*                                                                *
 17651*           U P D A T E   B A T C H   H E A D E R                *
 17652*                                                                *
 17653******************************************************************
 17654
 17655 3600-UPDATE-BATCH-HEADER.
 17656
 17657* EXEC CICS HANDLE CONDITION
 17658*         NOTFND      (3690-NOT-FOUND)
 17659*    END-EXEC.
 17660*    MOVE '"$I                   ! G #00015132' TO DFHEIV0
 17661     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17662     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17663     MOVE X'4720233030303135313332' TO DFHEIV0(25:11)
 17664     CALL 'kxdfhei1' USING DFHEIV0
 17665     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17666
 17667
 17668
 17669* EXEC CICS READ
 17670*        DATASET (FILE-ID-ERPNDB)
 17671*        RIDFLD  (ERPNDB-KEY)
 17672*        SET     (ADDRESS OF PENDING-BUSINESS)
 17673*        UPDATE
 17674*    END-EXEC.
 17675*    MOVE '&"S        EU         (   #00015136' TO DFHEIV0
 17676     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17677     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17678     MOVE X'2020233030303135313336' TO DFHEIV0(25:11)
 17679     CALL 'kxdfhei1' USING DFHEIV0,
 17680           FILE-ID-ERPNDB,
 17681           DFHEIV20,
 17682           DFHEIV99,
 17683           ERPNDB-KEY,
 17684           DFHEIV99,
 17685           DFHEIV99,
 17686           DFHEIV99
 17687     SET ADDRESS OF PENDING-BUSINESS TO
 17688         DFHEIV20
 17689     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17690
 17691
 17692     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 17693     MOVE 'B'                    TO JP-RECORD-TYPE.
 17694     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17695
 17696     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17697
 17698     PERFORM 8400-LOG-JOURNAL-RECORD.
 17699
 17700     IF DRISSL GREATER THAN ZEROS
 17701        MOVE WS-DRISS            TO PB-B-ISSUE-CNT-REMITTED.
 17702
 17703     IF DRCANCL GREATER THAN ZEROS
 17704        MOVE WS-DRCANC           TO PB-B-CANCEL-CNT-REMITTED.
 17705
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 328
* EL6311.cbl
 17706
 17707     IF DRLFPRML GREATER THAN ZEROS
 17708        MOVE WS-DRLFPRM       TO PB-B-LF-ISS-PRM-REMITTED.
 17709
 17710     IF DRAHPRML GREATER THAN ZEROS
 17711        MOVE WS-DRAHPRM       TO PB-B-AH-ISS-PRM-REMITTED.
 17712
 17713     IF DRLFRFDL GREATER THAN ZEROS
 17714        MOVE WS-DRLFRFD       TO PB-B-LF-CAN-PRM-REMITTED.
 17715
 17716     IF DRAHRFDL GREATER THAN ZEROS
 17717        MOVE WS-DRAHRFD       TO PB-B-AH-CAN-PRM-REMITTED.
 17718
 17719 3670-REWRITE-BATCH-HEADER.
 17720     IF PB-B-ISSUE-CNT-REMITTED  =  PB-B-ISSUE-CNT-ENTERED   AND
 17721        PB-B-LF-ISS-PRM-ENTERED  =  PB-B-LF-ISS-PRM-REMITTED AND
 17722        PB-B-AH-ISS-PRM-ENTERED  =  PB-B-AH-ISS-PRM-REMITTED AND
 17723        PB-B-CANCEL-CNT-REMITTED =  PB-B-CANCEL-CNT-ENTERED  AND
 17724        PB-B-LF-CAN-PRM-ENTERED  =  PB-B-LF-CAN-PRM-REMITTED AND
 17725        PB-B-AH-CAN-PRM-ENTERED  =  PB-B-AH-CAN-PRM-REMITTED
 17726        MOVE SPACE               TO PB-OUT-BAL-CD
 17727     ELSE
 17728        MOVE 'O'                 TO PB-OUT-BAL-CD.
 17729
 17730     MOVE 'C'                    TO JP-RECORD-TYPE.
 17731     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17732
 17733
 17734* EXEC CICS REWRITE
 17735*         DATASET      (FILE-ID-ERPNDB)
 17736*         FROM         (PENDING-BUSINESS)
 17737*    END-EXEC.
 17738     MOVE LENGTH OF
 17739      PENDING-BUSINESS
 17740       TO DFHEIV11
 17741*    MOVE '&& L                  %   #00015184' TO DFHEIV0
 17742     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17743     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17744     MOVE X'2020233030303135313834' TO DFHEIV0(25:11)
 17745     CALL 'kxdfhei1' USING DFHEIV0,
 17746           FILE-ID-ERPNDB,
 17747           PENDING-BUSINESS,
 17748           DFHEIV11,
 17749           DFHEIV99
 17750     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17751
 17752
 17753     PERFORM 8400-LOG-JOURNAL-RECORD.
 17754
 17755     GO TO 7200-DISPLAY-BATCHES.
 17756
 17757 3690-NOT-FOUND.
 17758     MOVE ER-2192                TO EMI-ERROR.
 17759     MOVE -1                     TO DPFENTRL.
 17760     MOVE AL-UNBON               TO DPFENTRA.
 17761     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17762     GO TO 8200-SEND-DATAONLY.
 17763
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 329
* EL6311.cbl
 17765
 17766******************************************************************
 17767*                                                                *
 17768*           R E - D I S P L A Y   R E C O R D                    *
 17769*                                                                *
 17770******************************************************************
 17771
 17772 3900-RE-DISPLAY-RECORD.
 17773
 17774* EXEC CICS HANDLE CONDITION
 17775*         NOTFND   (3990-NOT-FOUND)
 17776*    END-EXEC.
 17777*    MOVE '"$I                   ! H #00015209' TO DFHEIV0
 17778     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17779     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17780     MOVE X'4820233030303135323039' TO DFHEIV0(25:11)
 17781     CALL 'kxdfhei1' USING DFHEIV0
 17782     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17783
 17784
 17785     IF PI-DISPLAY-ORIGINAL-BATCH
 17786         MOVE FILE-ID-ERPNDB3     TO FILE-ID
 17787     ELSE
 17788         MOVE FILE-ID-ERPNDB      TO FILE-ID.
 17789
 17790
 17791* EXEC CICS READ
 17792*         DATASET   (FILE-ID)
 17793*         RIDFLD    (PI-PREV-KEY)
 17794*         SET       (ADDRESS OF PENDING-BUSINESS)
 17795*    END-EXEC.
 17796*    MOVE '&"S        E          (   #00015218' TO DFHEIV0
 17797     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17798     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17799     MOVE X'2020233030303135323138' TO DFHEIV0(25:11)
 17800     CALL 'kxdfhei1' USING DFHEIV0,
 17801           FILE-ID,
 17802           DFHEIV20,
 17803           DFHEIV99,
 17804           PI-PREV-KEY,
 17805           DFHEIV99,
 17806           DFHEIV99,
 17807           DFHEIV99
 17808     SET ADDRESS OF PENDING-BUSINESS TO
 17809         DFHEIV20
 17810     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17811
 17812
 17813     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 17814
 17815     IF PB-ISSUE
 17816         GO TO 7000-DISPLAY-ISSUES.
 17817
 17818     IF PB-CANCELLATION
 17819         GO TO 7100-DISPLAY-CANCELS.
 17820
 17821     IF PB-BATCH-TRAILER
 17822         GO TO 7200-DISPLAY-BATCHES.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 330
* EL6311.cbl
 17823
 17824 3990-NOT-FOUND.
 17825     MOVE LOW-VALUES             TO EL631BI.
 17826
 17827     IF PI-MAP-NAME = EL631B
 17828         MOVE -1                  TO BMAINTL
 17829     ELSE
 17830         MOVE -1                  TO CMAINTL.
 17831
 17832     GO TO 8100-SEND-INITIAL-MAP.
 17833
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 331
* EL6311.cbl
 17835
 17836***************************************************************
 17837*     FORWARD BROWSING ROUTINE   (BY ALTERNATE KEY)           *
 17838*                                                             *
 17839*      1. START BROWSE WITH                                   *
 17840*         A. FIRST RECORD SPECIFIED FROM FIRST SCREEN         *
 17841*         B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN       *
 17842*         C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.       *
 17843*                                                             *
 17844*      2. READ RECORDS AND DETERMINE IF THEY ARE TO BE        *
 17845*         DISPLAYED BY USING THE FOLLOWING CHECKS.            *
 17846*         A. IS IT WITHIN THE SAME KEY GROUP?                 *
 17847*         B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED. *
 17848*         C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM   *
 17849*               AND IS IT TO BE DISPLAYED.                    *
 17850*         D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE        *
 17851*               DISPLAYED.                                    *
 17852*         E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE       *
 17853*               DISPLAYED.                                    *
 17854*                                                             *
 17855*      3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE      *
 17856*               RECORD KEY AND GO TO THE DISPLAY ROUTINE.     *
 17857***************************************************************
 17858
 17859 4000-BROWSE-DETAIL-FORWARD.
 17860     IF FIRST-TIME
 17861        MOVE PI-ERPNDB-ALT-KEY      TO ERPNDB-ALT-KEY
 17862     ELSE
 17863        IF SHOW-RECORD
 17864           MOVE PI-ERPNDB-ALT-KEY   TO ERPNDB-ALT-KEY
 17865           MOVE WS-NEW-CERT-NO      TO ERPNDB-CERT-NO
 17866           MOVE WS-NEW-CERT-EFF-DT  TO ERPNDB-CERT-EFF-DT
 17867           MOVE LOW-VALUES          TO ERPNDB-RECORD-TYPE
 17868           MOVE ZEROS               TO ERPNDB-ALT-CHG-SEQ-NO
 17869        ELSE
 17870           MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY.
 17871
 17872
 17873* EXEC CICS HANDLE CONDITION
 17874*         NOTFND   (4050-END-RECORDS)
 17875*         ENDFILE  (4050-END-RECORDS)
 17876*    END-EXEC.
 17877*    MOVE '"$I''                  ! I #00015283' TO DFHEIV0
 17878     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 17879     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17880     MOVE X'4920233030303135323833' TO DFHEIV0(25:11)
 17881     CALL 'kxdfhei1' USING DFHEIV0
 17882     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17883
 17884
 17885
 17886* EXEC CICS STARTBR
 17887*         DATASET   (FILE-ID-ERPNDB2)
 17888*         RIDFLD    (ERPNDB-ALT-KEY)
 17889*    END-EXEC.
 17890     MOVE 0
 17891       TO DFHEIV11
 17892*    MOVE '&,         G          &   #00015288' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 332
* EL6311.cbl
 17893     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 17894     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17895     MOVE X'2020233030303135323838' TO DFHEIV0(25:11)
 17896     CALL 'kxdfhei1' USING DFHEIV0,
 17897           FILE-ID-ERPNDB2,
 17898           ERPNDB-ALT-KEY,
 17899           DFHEIV99,
 17900           DFHEIV11,
 17901           DFHEIV99
 17902     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17903
 17904
 17905     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 17906
 17907     IF FIRST-TIME OR SHOW-RECORD
 17908        MOVE SPACE               TO WS-FIRST-TIME-SW
 17909        GO TO 4005-READ-NEXT-RECORD.
 17910
 17911
 17912* EXEC CICS READNEXT
 17913*         DATASET    (FILE-ID-ERPNDB2)
 17914*         SET        (ADDRESS OF PENDING-BUSINESS)
 17915*         RIDFLD     (ERPNDB-ALT-KEY)
 17916*    END-EXEC.
 17917     MOVE 0
 17918       TO DFHEIV11
 17919*    MOVE '&.S                   )   #00015299' TO DFHEIV0
 17920     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 17921     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 17922     MOVE X'2020233030303135323939' TO DFHEIV0(25:11)
 17923     CALL 'kxdfhei1' USING DFHEIV0,
 17924           FILE-ID-ERPNDB2,
 17925           DFHEIV20,
 17926           DFHEIV99,
 17927           ERPNDB-ALT-KEY,
 17928           DFHEIV99,
 17929           DFHEIV11,
 17930           DFHEIV99,
 17931           DFHEIV99
 17932     SET ADDRESS OF PENDING-BUSINESS TO
 17933         DFHEIV20
 17934     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17935
 17936
 17937 4005-READ-NEXT-RECORD.
 17938
 17939* EXEC CICS READNEXT
 17940*         DATASET    (FILE-ID-ERPNDB2)
 17941*         SET        (ADDRESS OF PENDING-BUSINESS)
 17942*         RIDFLD     (ERPNDB-ALT-KEY)
 17943*    END-EXEC.
 17944     MOVE 0
 17945       TO DFHEIV11
 17946*    MOVE '&.S                   )   #00015306' TO DFHEIV0
 17947     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 17948     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 17949     MOVE X'2020233030303135333036' TO DFHEIV0(25:11)
 17950     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 333
* EL6311.cbl
 17951           FILE-ID-ERPNDB2,
 17952           DFHEIV20,
 17953           DFHEIV99,
 17954           ERPNDB-ALT-KEY,
 17955           DFHEIV99,
 17956           DFHEIV11,
 17957           DFHEIV99,
 17958           DFHEIV99
 17959     SET ADDRESS OF PENDING-BUSINESS TO
 17960         DFHEIV20
 17961     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17962
 17963
 17964     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 17965
 17966     IF WS-BATCH-PREFIX = '#CL'
 17967        GO TO 4005-READ-NEXT-RECORD.
 17968
 17969     IF SHOW-RECORD
 17970        IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD        OR
 17971           PB-CARRIER       NOT = PI-PB-CARRIER        OR
 17972           PB-GROUPING      NOT = PI-PB-GROUPING       OR
 17973           PB-STATE         NOT = PI-PB-STATE          OR
 17974           PB-ACCOUNT       NOT = PI-PB-ACCOUNT        OR
 17975           PB-CERT-EFF-DT   NOT = WS-NEW-CERT-EFF-DT   OR
 17976           PB-CERT-NO       NOT = WS-NEW-CERT-NO
 17977           GO TO 4050-END-RECORDS
 17978        ELSE
 17979           GO TO 4010-CHECK-REC-TYPE.
 17980
 17981     IF PB-COMPANY-CD-A1    NOT = PI-COMPANY-CD        OR
 17982        PB-CARRIER          NOT = PI-PB-CARRIER        OR
 17983        PB-GROUPING         NOT = PI-PB-GROUPING       OR
 17984        PB-STATE            NOT = PI-PB-STATE          OR
 17985        PB-ACCOUNT          NOT = PI-PB-ACCOUNT
 17986        GO TO 4050-END-RECORDS.
 17987
 17988     IF PB-BATCH-TRAILER
 17989        GO TO 4005-READ-NEXT-RECORD.
 17990
 17991     IF PI-PB-CERT-NO NOT = LOW-VALUES
 17992        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 17993           GO TO 4005-READ-NEXT-RECORD
 17994        ELSE
 17995           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 17996              GO TO 4010-CHECK-REC-TYPE
 17997           ELSE
 17998              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 17999                 GO TO 4010-CHECK-REC-TYPE
 18000              ELSE
 18001                 GO TO 4005-READ-NEXT-RECORD.
 18002
 18003     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 18004        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 18005           GO TO 4005-READ-NEXT-RECORD.
 18006
 18007 4010-CHECK-REC-TYPE.
 18008     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 334
* EL6311.cbl
 18009         IF  PB-CARRIER = PI-CARRIER-SECURITY
 18010             NEXT SENTENCE
 18011         ELSE
 18012             GO TO 4005-READ-NEXT-RECORD.
 18013
 18014     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 18015         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 18016             NEXT SENTENCE
 18017        ELSE
 18018             GO TO 4005-READ-NEXT-RECORD.
 18019
 18020     IF NOT DISPLAY-CHANGE-RECORDS AND
 18021            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 18022        GO TO 4005-READ-NEXT-RECORD.
 18023
 18024     IF DISPLAY-HOLD-RECORDS AND
 18025        NOT PB-RECORD-ON-HOLD
 18026          GO TO 4005-READ-NEXT-RECORD.
 18027
 18028     IF PB-ISSUE
 18029        IF DISPLAY-CHK-REQ-RECORDS
 18030            GO TO 4005-READ-NEXT-RECORD.
 18031
 18032     IF PB-ISSUE
 18033        IF ISSUE-WITH-WARNING
 18034           IF PB-WARNING-ERRORS
 18035              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18036                  GO TO 4005-READ-NEXT-RECORD
 18037              ELSE
 18038                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18039                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18040                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18041                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18042                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18043                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18044                 GO TO 7000-DISPLAY-ISSUES
 18045           ELSE
 18046              GO TO 4005-READ-NEXT-RECORD.
 18047
 18048     IF PB-ISSUE
 18049        IF (ISSUES-IN-ERROR AND
 18050            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18051            ALL-ISSUES
 18052            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18053            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18054            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18055            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18056            MOVE PB-SV-STATE            TO PI-SV-STATE
 18057            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18058            GO TO 7000-DISPLAY-ISSUES
 18059        ELSE
 18060            GO TO 4005-READ-NEXT-RECORD.
 18061
 18062     IF PB-CANCELLATION
 18063        IF DISPLAY-CHK-REQ-RECORDS
 18064           IF PB-C-REFUND-REQUESTED
 18065              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18066              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 335
* EL6311.cbl
 18067              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18068              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18069              MOVE PB-SV-STATE            TO PI-SV-STATE
 18070              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18071              GO TO 7100-DISPLAY-CANCELS
 18072           ELSE
 18073               GO TO 4005-READ-NEXT-RECORD.
 18074
 18075     IF PB-CANCELLATION
 18076        IF CANCEL-WITH-WARNING
 18077           IF PB-WARNING-ERRORS
 18078              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18079                  GO TO 4005-READ-NEXT-RECORD
 18080              ELSE
 18081                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18082                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18083                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18084                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18085                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18086                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18087                 GO TO 7100-DISPLAY-CANCELS
 18088           ELSE
 18089              GO TO 4005-READ-NEXT-RECORD.
 18090
 18091     IF PB-CANCELLATION
 18092        IF (CANCEL-IN-ERROR  AND
 18093            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18094            ALL-CANCELS
 18095            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18096            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18097            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18098            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18099            MOVE PB-SV-STATE            TO PI-SV-STATE
 18100            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18101            GO TO 7100-DISPLAY-CANCELS.
 18102
 18103     GO TO 4005-READ-NEXT-RECORD.
 18104
 18105 4050-END-RECORDS.
 18106******************************************************************
 18107*                                                                *
 18108*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 18109*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING
 18110*         PROGRAM.                                               *
 18111*                                                                *
 18112******************************************************************
 18113
 18114     IF BROWSE-STARTED
 18115        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 18116
 18117* EXEC CICS ENDBR
 18118*            DATASET  (FILE-ID-ERPNDB2)
 18119*       END-EXEC.
 18120     MOVE 0
 18121       TO DFHEIV11
 18122*    MOVE '&2                    $   #00015464' TO DFHEIV0
 18123     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18124     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 336
* EL6311.cbl
 18125     MOVE X'2020233030303135343634' TO DFHEIV0(25:11)
 18126     CALL 'kxdfhei1' USING DFHEIV0,
 18127           FILE-ID-ERPNDB2,
 18128           DFHEIV11,
 18129           DFHEIV99
 18130     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18131
 18132
 18133     IF  EIBTRNID NOT = TRANS-EXB1
 18134         IF PENDING-BUS-RECS-FOUND
 18135             NEXT SENTENCE
 18136           ELSE
 18137             MOVE '9'            TO PI-BROWSE-SW
 18138             GO TO 9400-CLEAR.
 18139
 18140     IF SHOW-RECORD
 18141        MOVE ER-2253            TO EMI-ERROR
 18142       ELSE
 18143        MOVE ER-2254            TO EMI-ERROR.
 18144
 18145     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18146
 18147     IF PI-MAP-NAME = SPACES
 18148        MOVE -1                  TO DPFENTRL
 18149        MOVE EL631D               TO PI-MAP-NAME
 18150        GO TO 8100-SEND-INITIAL-MAP.
 18151
 18152     IF PI-MAP-NAME = EL631B
 18153        MOVE -1                  TO BMAINTL
 18154     ELSE
 18155        IF PI-MAP-NAME = EL631C
 18156           MOVE -1               TO CMAINTL
 18157        ELSE
 18158           MOVE -1               TO DPFENTRL.
 18159
 18160     GO TO 8200-SEND-DATAONLY.
 18161
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 337
* EL6311.cbl
 18163
 18164***************************************************************
 18165*                                                             *
 18166*     FORWARD BROWSING ROUTINE   (BY BATCH)                   *
 18167*                                                             *
 18168*       1. READ RECORDS WITHIN THE BATCH BASED ON             *
 18169*          A. FIRST TIME INTO PROGRAM FROM FIRST SCREEN       *
 18170*          B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN      *
 18171*          C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.      *
 18172*                                                             *
 18173*       2. READ RECORDS AND DETERMINE IF THEY ARE TO BE       *
 18174*          DISPLAYED BY USING THE FOLLOWING CHECKS.           *
 18175*          A. IS IT WITHIN THE SAME KEY GROUP?                *
 18176*          B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED.*
 18177*          C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM  *
 18178*                AND IS IT TO BE DISPLAYED.                   *
 18179*          D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE       *
 18180*                DISPLAYED.                                   *
 18181*          E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE      *
 18182*                DISPLAYED.                                   *
 18183*                                                             *
 18184*       3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE     *
 18185*                RECORD KEY AND GO TO THE DISPLAY ROUTINE.    *
 18186*                                                             *
 18187*       4. WHEN READING ADDITION RECORDS ADJUSTMENTS MUST BE  *
 18188*                MADE TO BYPASS THE CORRECTION RECORDS IF     *
 18189*                THEY ARE NOT TO BE DISPLAYED.                *
 18190*                                                             *
 18191***************************************************************
 18192
 18193 4100-BROWSE-PRIMARY-FORWARD.
 18194     IF FIRST-TIME  OR SHOW-RECORD
 18195        MOVE PI-ERPNDB-KEY         TO ERPNDB-KEY
 18196        MOVE +1                    TO ERPNDB-BATCH-SEQ-NO
 18197        MOVE ZEROS                 TO ERPNDB-BATCH-CHG-SEQ-NO
 18198     ELSE
 18199        MOVE PI-PREV-KEY           TO ERPNDB-KEY
 18200        IF ERPNDB-BATCH-SEQ-NO = +9999
 18201           GO TO 4150-END-BATCH
 18202        ELSE
 18203           IF DISPLAY-CHANGE-RECORDS
 18204              ADD +1             TO ERPNDB-BATCH-CHG-SEQ-NO
 18205           ELSE
 18206              MOVE ZEROS         TO ERPNDB-BATCH-CHG-SEQ-NO
 18207              ADD +1             TO ERPNDB-BATCH-SEQ-NO.
 18208
 18209     IF FIRST-TIME
 18210         IF ERPNDB-BATCH-SEQ-NO = +1  AND
 18211            PI-PB-BATCH-SEQ-NO NOT = ZERO
 18212              MOVE PI-PB-BATCH-SEQ-NO TO ERPNDB-BATCH-SEQ-NO.
 18213
 18214
 18215* EXEC CICS HANDLE CONDITION
 18216*         ENDFILE  (4150-END-BATCH)
 18217*    END-EXEC.
 18218*    MOVE '"$''                   ! J #00015549' TO DFHEIV0
 18219     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 18220     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 338
* EL6311.cbl
 18221     MOVE X'4A20233030303135353439' TO DFHEIV0(25:11)
 18222     CALL 'kxdfhei1' USING DFHEIV0
 18223     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18224
 18225
 18226 4105-READ-NEXT.
 18227
 18228* EXEC CICS HANDLE CONDITION
 18229*         NOTFND    (4150-END-BATCH)
 18230*    END-EXEC.
 18231*    MOVE '"$I                   ! K #00015554' TO DFHEIV0
 18232     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18233     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18234     MOVE X'4B20233030303135353534' TO DFHEIV0(25:11)
 18235     CALL 'kxdfhei1' USING DFHEIV0
 18236     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18237
 18238
 18239     MOVE SPACES                 TO WS-REC-FOUND-SW.
 18240
 18241     IF PI-DISPLAY-ORIGINAL-BATCH
 18242        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 18243     ELSE
 18244        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 18245
 18246
 18247* EXEC CICS READ
 18248*         DATASET   (FILE-ID)
 18249*         SET       (ADDRESS OF PENDING-BUSINESS)
 18250*         RIDFLD    (ERPNDB-KEY)
 18251*         GTEQ
 18252*    END-EXEC.
 18253*    MOVE '&"S        G          (   #00015565' TO DFHEIV0
 18254     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 18255     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18256     MOVE X'2020233030303135353635' TO DFHEIV0(25:11)
 18257     CALL 'kxdfhei1' USING DFHEIV0,
 18258           FILE-ID,
 18259           DFHEIV20,
 18260           DFHEIV99,
 18261           ERPNDB-KEY,
 18262           DFHEIV99,
 18263           DFHEIV99,
 18264           DFHEIV99
 18265     SET ADDRESS OF PENDING-BUSINESS TO
 18266         DFHEIV20
 18267     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18268
 18269
 18270     IF PI-DISPLAY-ORIGINAL-BATCH
 18271        IF (PB-ORIGINAL-COMPANY-CD  NOT = PI-COMPANY-CD) OR
 18272           (PB-ORIGINAL-ENTRY-BATCH NOT = PI-PB-ENTRY-BATCH)
 18273           GO TO 4150-END-BATCH
 18274        ELSE
 18275           IF PB-BATCH-TRAILER
 18276              MOVE HIGH-VALUES   TO ERPNDB-BATCH-SEQ-ALPHA
 18277              GO TO 4105-READ-NEXT
 18278           ELSE
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 339
* EL6311.cbl
 18279              NEXT SENTENCE
 18280     ELSE
 18281        IF (PB-COMPANY-CD  NOT = PI-COMPANY-CD) OR
 18282           (PB-ENTRY-BATCH NOT = PI-PB-ENTRY-BATCH)
 18283           GO TO 4150-END-BATCH.
 18284
 18285     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 18286
 18287     IF WS-BATCH-PREFIX = '#CL'
 18288         MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 18289         GO TO 4105-READ-NEXT.
 18290
 18291     MOVE PB-CARRIER             TO PI-PB-CARRIER.
 18292     MOVE PB-GROUPING            TO PI-PB-GROUPING.
 18293     MOVE PB-STATE               TO PI-PB-STATE.
 18294     MOVE PB-ACCOUNT             TO PI-PB-ACCOUNT.
 18295
 18296     IF PB-BATCH-TRAILER
 18297        IF SHOW-RECORD
 18298           GO TO 4150-END-BATCH
 18299        ELSE
 18300           MOVE ER-2251         TO EMI-ERROR
 18301           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18302           MOVE 1               TO PI-BROWSE-TYPE
 18303           GO TO 7200-DISPLAY-BATCHES.
 18304
 18305     IF SHOW-RECORD
 18306           IF WS-NEW-CERT-NO NOT = PB-CERT-NO
 18307              GO TO 4110-BUMP-SEQ
 18308           ELSE
 18309              IF WS-NEW-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 18310                 GO TO 4110-BUMP-SEQ
 18311              ELSE
 18312                 GO TO 4107-CHECK-REC-TYPE.
 18313
 18314     IF NOT  PI-PRIMARY-WITH-SELECT
 18315        GO TO 4107-CHECK-REC-TYPE.
 18316
 18317     IF PI-PB-CERT-NO NOT = LOW-VALUES
 18318        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 18319           GO TO 4110-BUMP-SEQ
 18320        ELSE
 18321           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 18322              GO TO 4107-CHECK-REC-TYPE
 18323           ELSE
 18324              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 18325                 GO TO 4107-CHECK-REC-TYPE
 18326              ELSE
 18327                 GO TO 4110-BUMP-SEQ.
 18328
 18329     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 18330        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 18331           GO TO 4110-BUMP-SEQ.
 18332
 18333 4107-CHECK-REC-TYPE.
 18334     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 18335         IF  PB-CARRIER = PI-CARRIER-SECURITY
 18336             NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 340
* EL6311.cbl
 18337           ELSE
 18338             GO TO 4110-BUMP-SEQ.
 18339
 18340     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 18341         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 18342             NEXT SENTENCE
 18343           ELSE
 18344             GO TO 4110-BUMP-SEQ.
 18345
 18346     IF NOT DISPLAY-CHANGE-RECORDS AND
 18347        PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 18348           GO TO 4110-BUMP-SEQ.
 18349
 18350     IF DISPLAY-HOLD-RECORDS AND
 18351        NOT PB-RECORD-ON-HOLD
 18352          GO TO 4110-BUMP-SEQ.
 18353
 18354     IF PB-ISSUE
 18355        IF DISPLAY-CHK-REQ-RECORDS
 18356            GO TO 4110-BUMP-SEQ.
 18357
 18358     IF PB-ISSUE
 18359        IF ISSUE-WITH-WARNING
 18360           IF PB-WARNING-ERRORS
 18361              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18362                  GO TO 4110-BUMP-SEQ
 18363              ELSE
 18364                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18365                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18366                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18367                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18368                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18369                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18370                 GO TO 7000-DISPLAY-ISSUES
 18371        ELSE
 18372            GO TO 4110-BUMP-SEQ.
 18373
 18374     IF PB-ISSUE
 18375        IF (ISSUES-IN-ERROR AND
 18376            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18377            ALL-ISSUES
 18378            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18379            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18380            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18381            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18382            MOVE PB-SV-STATE            TO PI-SV-STATE
 18383            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18384            GO TO 7000-DISPLAY-ISSUES
 18385        ELSE
 18386            GO TO 4110-BUMP-SEQ.
 18387
 18388     IF PB-CANCELLATION
 18389        IF DISPLAY-CHK-REQ-RECORDS
 18390           IF PB-C-REFUND-REQUESTED
 18391              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18392              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18393              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18394              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 341
* EL6311.cbl
 18395              MOVE PB-SV-STATE            TO PI-SV-STATE
 18396              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18397              GO TO 7100-DISPLAY-CANCELS
 18398           ELSE
 18399              GO TO 4110-BUMP-SEQ.
 18400
 18401     IF PB-CANCELLATION
 18402        IF CANCEL-WITH-WARNING
 18403           IF PB-WARNING-ERRORS
 18404              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18405                  GO TO 4110-BUMP-SEQ
 18406              ELSE
 18407                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18408                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18409                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18410                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18411                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18412                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18413                 GO TO 7100-DISPLAY-CANCELS
 18414           ELSE
 18415              GO TO 4110-BUMP-SEQ.
 18416
 18417     IF PB-CANCELLATION
 18418        IF (CANCEL-IN-ERROR  AND
 18419            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18420            ALL-CANCELS
 18421            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18422            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18423            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18424            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18425            MOVE PB-SV-STATE            TO PI-SV-STATE
 18426            MOVE 'Y'                    TO WS-PB-RECORDS-FOUND-SW
 18427            GO TO 7100-DISPLAY-CANCELS.
 18428
 18429 4110-BUMP-SEQ.
 18430     IF NOT DISPLAY-CHANGE-RECORDS
 18431        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 18432        ADD +1                   TO ERPNDB-BATCH-SEQ-NO
 18433     ELSE
 18434        IF PB-BATCH-SEQ-NO NOT = ERPNDB-BATCH-SEQ-NO
 18435           MOVE PB-BATCH-SEQ-NO  TO ERPNDB-BATCH-SEQ-NO
 18436           MOVE +999             TO ERPNDB-BATCH-CHG-SEQ-NO
 18437        ELSE
 18438           MOVE PB-BATCH-CHG-SEQ-NO  TO ERPNDB-BATCH-CHG-SEQ-NO
 18439           ADD +1                    TO ERPNDB-BATCH-CHG-SEQ-NO.
 18440
 18441     GO TO 4105-READ-NEXT.
 18442
 18443 4150-END-BATCH.
 18444******************************************************************
 18445*                                                                *
 18446*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 18447*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING     *
 18448*         PROGRAM.                                               *
 18449*                                                                *
 18450******************************************************************
 18451
 18452     IF  EIBTRNID NOT = TRANS-EXB1
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 342
* EL6311.cbl
 18453         IF PENDING-BUS-RECS-FOUND
 18454             NEXT SENTENCE
 18455           ELSE
 18456             MOVE '9'            TO PI-BROWSE-SW
 18457             GO TO 9400-CLEAR.
 18458
 18459     IF SHOW-RECORD
 18460        MOVE ER-2253             TO EMI-ERROR
 18461     ELSE
 18462        MOVE ER-2251             TO EMI-ERROR.
 18463
 18464     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18465
 18466     IF PI-MAP-NAME = SPACES
 18467        MOVE -1                  TO BMAINTL
 18468        MOVE EL631B              TO PI-MAP-NAME
 18469        GO TO 8100-SEND-INITIAL-MAP.
 18470
 18471     IF PI-MAP-NAME = EL631B
 18472        MOVE -1                  TO BMAINTL
 18473     ELSE
 18474        IF PI-MAP-NAME = EL631C
 18475           MOVE -1               TO CMAINTL
 18476        ELSE
 18477           MOVE -1               TO DPFENTRL.
 18478
 18479     GO TO 8200-SEND-DATAONLY.
 18480
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 343
* EL6311.cbl
 18482
 18483***************************************************************
 18484*     FORWARD BROWSING ROUTINE   (BY CSR)                     *
 18485*                                                             *
 18486*      1. START BROWSE WITH                                   *
 18487*         A. FIRST RECORD SPECIFIED FROM FIRST SCREEN         *
 18488*         B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN       *
 18489*         C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.       *
 18490*                                                             *
 18491*      2. READ RECORDS AND DETERMINE IF THEY ARE TO BE        *
 18492*         DISPLAYED BY USING THE FOLLOWING CHECKS.            *
 18493*         A. IS IT WITHIN THE SAME KEY GROUP?                 *
 18494*         B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED. *
 18495*         C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM   *
 18496*               AND IS IT TO BE DISPLAYED.                    *
 18497*         D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE        *
 18498*               DISPLAYED.                                    *
 18499*         E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE       *
 18500*               DISPLAYED.                                    *
 18501*                                                             *
 18502*      3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE      *
 18503*               RECORD KEY AND GO TO THE DISPLAY ROUTINE.     *
 18504***************************************************************
 18505
 18506 4200-BROWSE-CSR-FORWARD.
 18507
 18508     IF FIRST-TIME
 18509        MOVE PI-ERPNDB-CSR-KEY      TO ERPNDB-CSR-KEY
 18510     ELSE
 18511        MOVE PI-PREV-CSR-KEY        TO ERPNDB-CSR-KEY.
 18512
 18513
 18514* EXEC CICS HANDLE CONDITION
 18515*         NOTFND   (4250-END-RECORDS)
 18516*         ENDFILE  (4250-END-RECORDS)
 18517*    END-EXEC.
 18518*    MOVE '"$I''                  ! L #00015815' TO DFHEIV0
 18519     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18520     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18521     MOVE X'4C20233030303135383135' TO DFHEIV0(25:11)
 18522     CALL 'kxdfhei1' USING DFHEIV0
 18523     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18524
 18525
 18526
 18527* EXEC CICS STARTBR
 18528*         DATASET   (FILE-ID-ERPNDB4)
 18529*         RIDFLD    (ERPNDB-CSR-KEY)
 18530*    END-EXEC.
 18531     MOVE 0
 18532       TO DFHEIV11
 18533*    MOVE '&,         G          &   #00015820' TO DFHEIV0
 18534     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18535     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18536     MOVE X'2020233030303135383230' TO DFHEIV0(25:11)
 18537     CALL 'kxdfhei1' USING DFHEIV0,
 18538           FILE-ID-ERPNDB4,
 18539           ERPNDB-CSR-KEY,
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 344
* EL6311.cbl
 18540           DFHEIV99,
 18541           DFHEIV11,
 18542           DFHEIV99
 18543     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18544
 18545
 18546     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 18547
 18548     IF FIRST-TIME
 18549        MOVE SPACE               TO WS-FIRST-TIME-SW
 18550        GO TO 4205-READ-NEXT-RECORD.
 18551
 18552
 18553* EXEC CICS READNEXT
 18554*         DATASET    (FILE-ID-ERPNDB4)
 18555*         SET        (ADDRESS OF PENDING-BUSINESS)
 18556*         RIDFLD     (ERPNDB-CSR-KEY)
 18557*    END-EXEC.
 18558     MOVE 0
 18559       TO DFHEIV11
 18560*    MOVE '&.S                   )   #00015831' TO DFHEIV0
 18561     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18562     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18563     MOVE X'2020233030303135383331' TO DFHEIV0(25:11)
 18564     CALL 'kxdfhei1' USING DFHEIV0,
 18565           FILE-ID-ERPNDB4,
 18566           DFHEIV20,
 18567           DFHEIV99,
 18568           ERPNDB-CSR-KEY,
 18569           DFHEIV99,
 18570           DFHEIV11,
 18571           DFHEIV99,
 18572           DFHEIV99
 18573     SET ADDRESS OF PENDING-BUSINESS TO
 18574         DFHEIV20
 18575     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18576
 18577
 18578 4205-READ-NEXT-RECORD.
 18579
 18580
 18581* EXEC CICS READNEXT
 18582*         DATASET    (FILE-ID-ERPNDB4)
 18583*         SET        (ADDRESS OF PENDING-BUSINESS)
 18584*         RIDFLD     (ERPNDB-CSR-KEY)
 18585*    END-EXEC.
 18586     MOVE 0
 18587       TO DFHEIV11
 18588*    MOVE '&.S                   )   #00015839' TO DFHEIV0
 18589     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18590     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18591     MOVE X'2020233030303135383339' TO DFHEIV0(25:11)
 18592     CALL 'kxdfhei1' USING DFHEIV0,
 18593           FILE-ID-ERPNDB4,
 18594           DFHEIV20,
 18595           DFHEIV99,
 18596           ERPNDB-CSR-KEY,
 18597           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 345
* EL6311.cbl
 18598           DFHEIV11,
 18599           DFHEIV99,
 18600           DFHEIV99
 18601     SET ADDRESS OF PENDING-BUSINESS TO
 18602         DFHEIV20
 18603     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18604
 18605
 18606     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 18607
 18608     IF WS-BATCH-PREFIX = '#CL'
 18609        GO TO 4205-READ-NEXT-RECORD.
 18610
 18611     IF PB-CSR-COMPANY-CD   NOT = PI-COMPANY-CD OR
 18612        PB-CSR-ID           NOT = PI-PB-CSR-ID
 18613        GO TO 4250-END-RECORDS.
 18614
 18615     IF PB-BATCH-TRAILER
 18616        GO TO 4205-READ-NEXT-RECORD.
 18617
 18618     IF PI-PB-CERT-NO NOT = LOW-VALUES
 18619        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 18620           GO TO 4205-READ-NEXT-RECORD
 18621        ELSE
 18622           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 18623              GO TO 4210-CHECK-REC-TYPE
 18624           ELSE
 18625              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 18626                 GO TO 4210-CHECK-REC-TYPE
 18627              ELSE
 18628                 GO TO 4205-READ-NEXT-RECORD.
 18629
 18630     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 18631        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 18632           GO TO 4205-READ-NEXT-RECORD.
 18633
 18634 4210-CHECK-REC-TYPE.
 18635     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 18636         IF  PB-CARRIER = PI-CARRIER-SECURITY
 18637             NEXT SENTENCE
 18638         ELSE
 18639             GO TO 4205-READ-NEXT-RECORD.
 18640
 18641     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 18642         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 18643             NEXT SENTENCE
 18644        ELSE
 18645             GO TO 4205-READ-NEXT-RECORD.
 18646
 18647     IF NOT DISPLAY-CHANGE-RECORDS AND
 18648            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 18649        GO TO 4205-READ-NEXT-RECORD.
 18650
 18651     IF DISPLAY-HOLD-RECORDS AND
 18652        NOT PB-RECORD-ON-HOLD
 18653          GO TO 4205-READ-NEXT-RECORD.
 18654
 18655     IF PB-ISSUE
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 346
* EL6311.cbl
 18656        IF DISPLAY-CHK-REQ-RECORDS
 18657            GO TO 4205-READ-NEXT-RECORD.
 18658
 18659     IF PB-ISSUE
 18660        IF ISSUE-WITH-WARNING
 18661           IF PB-WARNING-ERRORS
 18662              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18663                  GO TO 4205-READ-NEXT-RECORD
 18664              ELSE
 18665                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18666                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 18667                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18668                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18669                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18670                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18671                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18672                 GO TO 7000-DISPLAY-ISSUES
 18673           ELSE
 18674              GO TO 4205-READ-NEXT-RECORD.
 18675
 18676     IF PB-ISSUE
 18677        IF (ISSUES-IN-ERROR AND
 18678            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18679            ALL-ISSUES
 18680            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18681            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 18682            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18683            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18684            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18685            MOVE PB-SV-STATE            TO PI-SV-STATE
 18686            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18687            GO TO 7000-DISPLAY-ISSUES
 18688        ELSE
 18689            GO TO 4205-READ-NEXT-RECORD.
 18690
 18691     IF PB-CANCELLATION
 18692        IF DISPLAY-CHK-REQ-RECORDS
 18693           IF PB-C-REFUND-REQUESTED
 18694              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18695              MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 18696              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18697              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18698              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18699              MOVE PB-SV-STATE            TO PI-SV-STATE
 18700              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18701              GO TO 7100-DISPLAY-CANCELS
 18702           ELSE
 18703               GO TO 4205-READ-NEXT-RECORD.
 18704
 18705     IF PB-CANCELLATION
 18706        IF CANCEL-WITH-WARNING
 18707           IF PB-WARNING-ERRORS
 18708              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18709                  GO TO 4205-READ-NEXT-RECORD
 18710              ELSE
 18711                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18712                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 18713                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 347
* EL6311.cbl
 18714                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18715                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18716                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18717                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18718                 GO TO 7100-DISPLAY-CANCELS
 18719           ELSE
 18720              GO TO 4205-READ-NEXT-RECORD.
 18721
 18722     IF PB-CANCELLATION
 18723        IF (CANCEL-IN-ERROR  AND
 18724            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18725            ALL-CANCELS
 18726            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18727            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 18728            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18729            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18730            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18731            MOVE PB-SV-STATE            TO PI-SV-STATE
 18732            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18733            GO TO 7100-DISPLAY-CANCELS.
 18734
 18735     GO TO 4205-READ-NEXT-RECORD.
 18736
 18737 4250-END-RECORDS.
 18738******************************************************************
 18739*                                                                *
 18740*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 18741*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING
 18742*         PROGRAM.                                               *
 18743*                                                                *
 18744******************************************************************
 18745
 18746     IF BROWSE-STARTED
 18747        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 18748
 18749* EXEC CICS ENDBR
 18750*            DATASET  (FILE-ID-ERPNDB4)
 18751*       END-EXEC.
 18752     MOVE 0
 18753       TO DFHEIV11
 18754*    MOVE '&2                    $   #00015987' TO DFHEIV0
 18755     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18756     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18757     MOVE X'2020233030303135393837' TO DFHEIV0(25:11)
 18758     CALL 'kxdfhei1' USING DFHEIV0,
 18759           FILE-ID-ERPNDB4,
 18760           DFHEIV11,
 18761           DFHEIV99
 18762     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18763
 18764
 18765     IF  EIBTRNID NOT = TRANS-EXB1
 18766         IF PENDING-BUS-RECS-FOUND
 18767             NEXT SENTENCE
 18768           ELSE
 18769             MOVE '9'            TO PI-BROWSE-SW
 18770             GO TO 9400-CLEAR.
 18771
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 348
* EL6311.cbl
 18772     IF SHOW-RECORD
 18773        MOVE ER-2253            TO EMI-ERROR
 18774       ELSE
 18775        MOVE ER-2254            TO EMI-ERROR.
 18776
 18777     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18778
 18779     IF PI-MAP-NAME = SPACES
 18780        MOVE -1                  TO DPFENTRL
 18781        MOVE EL631D               TO PI-MAP-NAME
 18782        GO TO 8100-SEND-INITIAL-MAP.
 18783
 18784     IF PI-MAP-NAME = EL631B
 18785        MOVE -1                  TO BMAINTL
 18786     ELSE
 18787        IF PI-MAP-NAME = EL631C
 18788           MOVE -1               TO CMAINTL
 18789        ELSE
 18790           MOVE -1               TO DPFENTRL.
 18791
 18792     GO TO 8200-SEND-DATAONLY.
 18793
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 349
* EL6311.cbl
 18795
 18796***************************************************************
 18797*                                                             *
 18798*     FORWARD BROWSING ROUTINE   (BY FILE)                    *
 18799*                                                             *
 18800*       1. READ RECORDS WITHIN THE FILE BY COMPANY            *
 18801*          A. FIRST TIME INTO PROGRAM FROM FIRST SCREEN       *
 18802*          B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN      *
 18803*                                                             *
 18804*       2. READ RECORDS AND DETERMINE IF THEY ARE TO BE       *
 18805*          DISPLAYED BY USING THE FOLLOWING CHECKS.           *
 18806*          A. IS IT WITHIN THE SAME COMPANY                   *
 18807*          B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED.*
 18808*          C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM  *
 18809*                AND IS IT TO BE DISPLAYED.                   *
 18810*          D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE       *
 18811*                DISPLAYED.                                   *
 18812*          E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE      *
 18813*                DISPLAYED.                                   *
 18814*                                                             *
 18815*       3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE     *
 18816*                RECORD KEY AND GO TO THE DISPLAY ROUTINE.    *
 18817*                                                             *
 18818*       4. WHEN READING ADDITION RECORDS ADJUSTMENTS MUST BE  *
 18819*                MADE TO BYPASS THE CORRECTION RECORDS IF     *
 18820*                THEY ARE NOT TO BE DISPLAYED.                *
 18821*                                                             *
 18822***************************************************************
 18823
 18824 4300-BROWSE-FILE-FORWARD.
 18825     IF FIRST-TIME OR SHOW-RECORD
 18826        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY
 18827        MOVE +1                  TO ERPNDB-BATCH-SEQ-NO
 18828        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 18829     ELSE
 18830        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 18831        IF ERPNDB-BATCH-SEQ-NO = +9999
 18832           MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
 18833        ELSE
 18834           IF DISPLAY-CHANGE-RECORDS
 18835              ADD +1             TO ERPNDB-BATCH-CHG-SEQ-NO
 18836           ELSE
 18837              MOVE ZEROS         TO ERPNDB-BATCH-CHG-SEQ-NO
 18838              ADD +1             TO ERPNDB-BATCH-SEQ-NO.
 18839
 18840
 18841* EXEC CICS HANDLE CONDITION
 18842*         ENDFILE  (4350-END-BATCH)
 18843*         NOTFND   (4350-END-BATCH)
 18844*    END-EXEC.
 18845*    MOVE '"$''I                  ! M #00016066' TO DFHEIV0
 18846     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 18847     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18848     MOVE X'4D20233030303136303636' TO DFHEIV0(25:11)
 18849     CALL 'kxdfhei1' USING DFHEIV0
 18850     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18851
 18852
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 350
* EL6311.cbl
 18853 4305-READ-NEXT.
 18854     IF PI-DISPLAY-ORIGINAL-BATCH
 18855        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 18856     ELSE
 18857        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 18858
 18859
 18860* EXEC CICS READ
 18861*         DATASET   (FILE-ID)
 18862*         SET       (ADDRESS OF PENDING-BUSINESS)
 18863*         RIDFLD    (ERPNDB-KEY)
 18864*         GTEQ
 18865*    END-EXEC.
 18866*    MOVE '&"S        G          (   #00016077' TO DFHEIV0
 18867     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 18868     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18869     MOVE X'2020233030303136303737' TO DFHEIV0(25:11)
 18870     CALL 'kxdfhei1' USING DFHEIV0,
 18871           FILE-ID,
 18872           DFHEIV20,
 18873           DFHEIV99,
 18874           ERPNDB-KEY,
 18875           DFHEIV99,
 18876           DFHEIV99,
 18877           DFHEIV99
 18878     SET ADDRESS OF PENDING-BUSINESS TO
 18879         DFHEIV20
 18880     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18881
 18882
 18883     IF PB-COMPANY-CD NOT = PI-COMPANY-CD
 18884        GO TO 4350-END-BATCH.
 18885
 18886     MOVE PB-ENTRY-BATCH         TO ERPNDB-ENTRY-BATCH
 18887                                    WS-BATCH-NO.
 18888
 18889     IF  WS-BATCH-PREFIX = '#CL'
 18890         MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 18891         GO TO 4305-READ-NEXT.
 18892
 18893     MOVE PB-CONTROL-PRIMARY     TO PI-ERPNDB-KEY.
 18894     MOVE PB-CARRIER             TO PI-PB-CARRIER.
 18895     MOVE PB-GROUPING            TO PI-PB-GROUPING.
 18896     MOVE PB-STATE               TO PI-PB-STATE.
 18897     MOVE PB-ACCOUNT             TO PI-PB-ACCOUNT.
 18898
 18899     IF PB-BATCH-TRAILER
 18900        MOVE HIGH-VALUES         TO ERPNDB-BATCH-SEQ-ALPHA
 18901        GO TO 4305-READ-NEXT.
 18902
 18903     IF SHOW-RECORD
 18904           IF WS-NEW-CERT-NO NOT = PB-CERT-NO
 18905              GO TO 4310-BUMP-SEQ
 18906           ELSE
 18907              IF WS-NEW-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 18908                 GO TO 4310-BUMP-SEQ
 18909              ELSE
 18910                 GO TO 4307-CHECK-REC-TYPE.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 351
* EL6311.cbl
 18911
 18912     IF PI-PB-CERT-NO NOT = LOW-VALUES
 18913        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 18914           GO TO 4310-BUMP-SEQ
 18915        ELSE
 18916           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 18917              GO TO 4307-CHECK-REC-TYPE
 18918           ELSE
 18919              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 18920                 GO TO 4307-CHECK-REC-TYPE
 18921              ELSE
 18922                 GO TO 4310-BUMP-SEQ.
 18923
 18924     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 18925        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 18926           GO TO 4310-BUMP-SEQ.
 18927
 18928 4307-CHECK-REC-TYPE.
 18929     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 18930         IF  PB-CARRIER = PI-CARRIER-SECURITY
 18931             NEXT SENTENCE
 18932         ELSE
 18933             GO TO 4310-BUMP-SEQ.
 18934
 18935     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 18936         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 18937             NEXT SENTENCE
 18938        ELSE
 18939             GO TO 4310-BUMP-SEQ.
 18940
 18941     IF NOT DISPLAY-CHANGE-RECORDS AND
 18942            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 18943        GO TO 4310-BUMP-SEQ.
 18944
 18945     IF DISPLAY-HOLD-RECORDS AND
 18946        NOT PB-RECORD-ON-HOLD
 18947          GO TO 4310-BUMP-SEQ.
 18948
 18949     IF PB-ISSUE
 18950        IF DISPLAY-CHK-REQ-RECORDS
 18951           GO TO 4310-BUMP-SEQ.
 18952
 18953     IF PB-ISSUE
 18954        IF ISSUE-WITH-WARNING
 18955           IF PB-WARNING-ERRORS
 18956              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18957                  GO TO 4310-BUMP-SEQ
 18958              ELSE
 18959                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18960                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18961                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18962                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18963                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18964                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18965                 GO TO 7000-DISPLAY-ISSUES
 18966           ELSE
 18967              GO TO 4310-BUMP-SEQ.
 18968
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 352
* EL6311.cbl
 18969     IF PB-ISSUE
 18970        IF (ISSUES-IN-ERROR AND
 18971            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18972            ALL-ISSUES
 18973            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18974            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18975            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18976            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18977            MOVE PB-SV-STATE            TO PI-SV-STATE
 18978            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18979            GO TO 7000-DISPLAY-ISSUES
 18980        ELSE
 18981            GO TO 4310-BUMP-SEQ.
 18982
 18983     IF PB-CANCELLATION
 18984        IF DISPLAY-CHK-REQ-RECORDS
 18985           IF PB-C-REFUND-REQUESTED
 18986              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18987              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18988              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18989              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18990              MOVE PB-SV-STATE            TO PI-SV-STATE
 18991              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18992              GO TO 7100-DISPLAY-CANCELS
 18993           ELSE
 18994              GO TO 4310-BUMP-SEQ.
 18995
 18996     IF PB-CANCELLATION
 18997        IF CANCEL-WITH-WARNING
 18998           IF PB-WARNING-ERRORS
 18999              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19000                  GO TO 4310-BUMP-SEQ
 19001              ELSE
 19002                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19003                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19004                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19005                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19006                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19007                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19008                 GO TO 7100-DISPLAY-CANCELS
 19009           ELSE
 19010              GO TO 4310-BUMP-SEQ.
 19011
 19012     IF PB-CANCELLATION
 19013        IF (CANCEL-IN-ERROR  AND
 19014            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19015            ALL-CANCELS
 19016            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19017            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19018            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19019            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19020            MOVE PB-SV-STATE            TO PI-SV-STATE
 19021            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19022            GO TO 7100-DISPLAY-CANCELS.
 19023
 19024 4310-BUMP-SEQ.
 19025     IF NOT DISPLAY-CHANGE-RECORDS
 19026        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 353
* EL6311.cbl
 19027        ADD +1                   TO ERPNDB-BATCH-SEQ-NO
 19028     ELSE
 19029        IF PB-BATCH-SEQ-NO NOT = ERPNDB-BATCH-SEQ-NO
 19030           MOVE PB-BATCH-SEQ-NO  TO ERPNDB-BATCH-SEQ-NO
 19031           MOVE +999             TO ERPNDB-BATCH-CHG-SEQ-NO
 19032        ELSE
 19033           MOVE PB-BATCH-CHG-SEQ-NO  TO ERPNDB-BATCH-CHG-SEQ-NO
 19034           ADD +1                TO ERPNDB-BATCH-CHG-SEQ-NO.
 19035
 19036     GO TO 4305-READ-NEXT.
 19037
 19038 4350-END-BATCH.
 19039
 19040******************************************************************
 19041*                                                                *
 19042*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 19043*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING    *
 19044*         PROGRAM.                                               *
 19045*                                                                *
 19046******************************************************************
 19047
 19048     IF  EIBTRNID NOT = TRANS-EXB1
 19049         IF PENDING-BUS-RECS-FOUND
 19050             NEXT SENTENCE
 19051           ELSE
 19052             MOVE '9'            TO PI-BROWSE-SW
 19053             GO TO 9400-CLEAR.
 19054
 19055     IF SHOW-RECORD
 19056        MOVE ER-2253            TO EMI-ERROR
 19057     ELSE
 19058        MOVE ER-2251            TO EMI-ERROR.
 19059
 19060     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19061
 19062     IF PI-MAP-NAME = SPACES
 19063        MOVE -1                  TO BMAINTL
 19064        MOVE EL631B               TO PI-MAP-NAME
 19065        GO TO 8100-SEND-INITIAL-MAP.
 19066
 19067     IF PI-MAP-NAME = EL631B
 19068        MOVE -1                  TO BMAINTL
 19069     ELSE
 19070        IF PI-MAP-NAME = EL631C
 19071           MOVE -1               TO CMAINTL
 19072        ELSE
 19073           MOVE -1               TO DPFENTRL.
 19074
 19075     GO TO 8200-SEND-DATAONLY.
 19076
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 354
* EL6311.cbl
 19078
 19079******************************************************************
 19080*                                                                *
 19081*        B R O W S E   D E T A I L   B A C K W A R D             *
 19082*                                                                *
 19083******************************************************************
 19084
 19085 4500-BROWSE-DETAIL-BACKWARD.
 19086
 19087     MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY.
 19088
 19089
 19090* EXEC CICS HANDLE CONDITION
 19091*         NOTFND   (4570-NOT-FOUND)
 19092*         ENDFILE  (4550-END-RECORDS)
 19093*    END-EXEC
 19094*    MOVE '"$I''                  ! N #00016290' TO DFHEIV0
 19095     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19096     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19097     MOVE X'4E20233030303136323930' TO DFHEIV0(25:11)
 19098     CALL 'kxdfhei1' USING DFHEIV0
 19099     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19100
 19101
 19102* EXEC CICS STARTBR
 19103*         DATASET   (FILE-ID-ERPNDB2)
 19104*         RIDFLD    (ERPNDB-ALT-KEY)
 19105*    END-EXEC.
 19106     MOVE 0
 19107       TO DFHEIV11
 19108*    MOVE '&,         G          &   #00016295' TO DFHEIV0
 19109     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19110     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19111     MOVE X'2020233030303136323935' TO DFHEIV0(25:11)
 19112     CALL 'kxdfhei1' USING DFHEIV0,
 19113           FILE-ID-ERPNDB2,
 19114           ERPNDB-ALT-KEY,
 19115           DFHEIV99,
 19116           DFHEIV11,
 19117           DFHEIV99
 19118     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19119
 19120
 19121     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW
 19122                                    WS-FIRST-TIME-SW.
 19123
 19124 4505-READ-PREV-RECORD.
 19125
 19126* EXEC CICS READPREV
 19127*         DATASET    (FILE-ID-ERPNDB2)
 19128*         SET        (ADDRESS OF PENDING-BUSINESS)
 19129*         RIDFLD     (ERPNDB-ALT-KEY)
 19130*    END-EXEC.
 19131     MOVE 0
 19132       TO DFHEIV11
 19133*    MOVE '&0S                   )   #00016304' TO DFHEIV0
 19134     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 19135     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 355
* EL6311.cbl
 19136     MOVE X'2020233030303136333034' TO DFHEIV0(25:11)
 19137     CALL 'kxdfhei1' USING DFHEIV0,
 19138           FILE-ID-ERPNDB2,
 19139           DFHEIV20,
 19140           DFHEIV99,
 19141           ERPNDB-ALT-KEY,
 19142           DFHEIV99,
 19143           DFHEIV11,
 19144           DFHEIV99,
 19145           DFHEIV99
 19146     SET ADDRESS OF PENDING-BUSINESS TO
 19147         DFHEIV20
 19148     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19149
 19150
 19151     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19152
 19153     IF WS-BATCH-PREFIX = '#CL'
 19154         GO TO 4505-READ-PREV-RECORD.
 19155
 19156     IF FIRST-TIME
 19157         MOVE SPACE               TO WS-FIRST-TIME-SW
 19158         GO TO 4505-READ-PREV-RECORD.
 19159
 19160     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD  OR
 19161        PB-CARRIER       NOT = PI-PB-CARRIER  OR
 19162        PB-GROUPING      NOT = PI-PB-GROUPING OR
 19163        PB-STATE         NOT = PI-PB-STATE    OR
 19164        PB-ACCOUNT       NOT = PI-PB-ACCOUNT
 19165          GO TO 4550-END-RECORDS.
 19166
 19167
 19168     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 19169
 19170     IF PB-BATCH-TRAILER
 19171        GO TO 4505-READ-PREV-RECORD.
 19172
 19173     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19174
 19175     IF  WS-BATCH-PREFIX = '#CL'
 19176         GO TO 4505-READ-PREV-RECORD.
 19177
 19178     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19179        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 19180           GO TO 4505-READ-PREV-RECORD
 19181        ELSE
 19182           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19183              GO TO 4510-CHECK-REC-TYPE
 19184           ELSE
 19185              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19186                 GO TO 4510-CHECK-REC-TYPE
 19187              ELSE
 19188                 GO TO 4505-READ-PREV-RECORD.
 19189
 19190     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19191        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19192           GO TO 4505-READ-PREV-RECORD.
 19193
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 356
* EL6311.cbl
 19194 4510-CHECK-REC-TYPE.
 19195     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19196         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19197             NEXT SENTENCE
 19198         ELSE
 19199             GO TO 4505-READ-PREV-RECORD.
 19200
 19201     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19202         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19203             NEXT SENTENCE
 19204        ELSE
 19205             GO TO 4505-READ-PREV-RECORD.
 19206
 19207     IF NOT DISPLAY-CHANGE-RECORDS AND
 19208            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19209        GO TO 4505-READ-PREV-RECORD.
 19210
 19211     IF DISPLAY-HOLD-RECORDS AND
 19212        NOT PB-RECORD-ON-HOLD
 19213          GO TO 4505-READ-PREV-RECORD.
 19214
 19215     IF PB-ISSUE
 19216        IF DISPLAY-CHK-REQ-RECORDS
 19217           GO TO 4505-READ-PREV-RECORD.
 19218
 19219     IF PB-ISSUE
 19220        IF ISSUE-WITH-WARNING
 19221           IF PB-WARNING-ERRORS
 19222              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19223                  GO TO 4505-READ-PREV-RECORD
 19224              ELSE
 19225                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19226                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19227                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19228                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19229                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19230                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19231                 GO TO 7000-DISPLAY-ISSUES
 19232           ELSE
 19233              GO TO 4505-READ-PREV-RECORD.
 19234
 19235     IF PB-ISSUE
 19236        IF (ISSUES-IN-ERROR AND
 19237            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19238            ALL-ISSUES
 19239            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19240            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19241            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19242            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19243            MOVE PB-SV-STATE            TO PI-SV-STATE
 19244            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19245            GO TO 7000-DISPLAY-ISSUES
 19246        ELSE
 19247            GO TO 4505-READ-PREV-RECORD.
 19248
 19249     IF PB-CANCELLATION
 19250        IF DISPLAY-CHK-REQ-RECORDS
 19251           IF PB-C-REFUND-REQUESTED
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 357
* EL6311.cbl
 19252              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19253              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19254              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19255              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19256              MOVE PB-SV-STATE            TO PI-SV-STATE
 19257              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19258              GO TO 7100-DISPLAY-CANCELS
 19259           ELSE
 19260              GO TO 4505-READ-PREV-RECORD.
 19261
 19262     IF PB-CANCELLATION
 19263        IF CANCEL-WITH-WARNING
 19264           IF PB-WARNING-ERRORS
 19265              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19266                  GO TO 4505-READ-PREV-RECORD
 19267              ELSE
 19268                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19269                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19270                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19271                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19272                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19273                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19274                 GO TO 7100-DISPLAY-CANCELS
 19275           ELSE
 19276              GO TO 4505-READ-PREV-RECORD.
 19277
 19278     IF PB-CANCELLATION
 19279        IF (CANCEL-IN-ERROR  AND
 19280            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19281            ALL-CANCELS
 19282            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19283            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19284            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19285            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19286            MOVE PB-SV-STATE            TO PI-SV-STATE
 19287            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19288            GO TO 7100-DISPLAY-CANCELS.
 19289
 19290     GO TO 4505-READ-PREV-RECORD.
 19291
 19292 4550-END-RECORDS.
 19293     IF PI-MAP-NAME = EL631B
 19294        MOVE -1                  TO BMAINTL
 19295     ELSE
 19296        IF PI-MAP-NAME = EL631C
 19297           MOVE -1               TO CMAINTL
 19298        ELSE
 19299           MOVE -1               TO DPFENTRL.
 19300
 19301     MOVE ER-2255               TO EMI-ERROR.
 19302     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19303     GO TO 8200-SEND-DATAONLY.
 19304
 19305 4570-NOT-FOUND.
 19306
 19307******************************************************************
 19308*      CONDITION MAY OCCUR IF PREV. RECORD HAS BEEN DELETED.     *
 19309******************************************************************
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 358
* EL6311.cbl
 19310
 19311
 19312* EXEC CICS RESETBR
 19313*         DATASET    (FILE-ID-ERPNDB2)
 19314*         RIDFLD     (ERPNDB-ALT-KEY)
 19315*    END-EXEC.
 19316     MOVE 0
 19317       TO DFHEIV11
 19318*    MOVE '&4         G          &   #00016470' TO DFHEIV0
 19319     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 19320     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19321     MOVE X'2020233030303136343730' TO DFHEIV0(25:11)
 19322     CALL 'kxdfhei1' USING DFHEIV0,
 19323           FILE-ID-ERPNDB2,
 19324           ERPNDB-ALT-KEY,
 19325           DFHEIV99,
 19326           DFHEIV11,
 19327           DFHEIV99
 19328     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19329
 19330
 19331
 19332* EXEC CICS READNEXT
 19333*         DATASET    (FILE-ID-ERPNDB2)
 19334*         SET        (ADDRESS OF PENDING-BUSINESS)
 19335*         RIDFLD     (ERPNDB-ALT-KEY)
 19336*    END-EXEC.
 19337     MOVE 0
 19338       TO DFHEIV11
 19339*    MOVE '&.S                   )   #00016475' TO DFHEIV0
 19340     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19341     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19342     MOVE X'2020233030303136343735' TO DFHEIV0(25:11)
 19343     CALL 'kxdfhei1' USING DFHEIV0,
 19344           FILE-ID-ERPNDB2,
 19345           DFHEIV20,
 19346           DFHEIV99,
 19347           ERPNDB-ALT-KEY,
 19348           DFHEIV99,
 19349           DFHEIV11,
 19350           DFHEIV99,
 19351           DFHEIV99
 19352     SET ADDRESS OF PENDING-BUSINESS TO
 19353         DFHEIV20
 19354     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19355
 19356
 19357
 19358* EXEC CICS READPREV
 19359*         DATASET    (FILE-ID-ERPNDB2)
 19360*         SET        (ADDRESS OF PENDING-BUSINESS)
 19361*         RIDFLD     (ERPNDB-ALT-KEY)
 19362*    END-EXEC.
 19363     MOVE 0
 19364       TO DFHEIV11
 19365*    MOVE '&0S                   )   #00016481' TO DFHEIV0
 19366     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 19367     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 359
* EL6311.cbl
 19368     MOVE X'2020233030303136343831' TO DFHEIV0(25:11)
 19369     CALL 'kxdfhei1' USING DFHEIV0,
 19370           FILE-ID-ERPNDB2,
 19371           DFHEIV20,
 19372           DFHEIV99,
 19373           ERPNDB-ALT-KEY,
 19374           DFHEIV99,
 19375           DFHEIV11,
 19376           DFHEIV99,
 19377           DFHEIV99
 19378     SET ADDRESS OF PENDING-BUSINESS TO
 19379         DFHEIV20
 19380     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19381
 19382
 19383 4580-READ-PREV-RECORD.
 19384
 19385* EXEC CICS READPREV
 19386*         DATASET    (FILE-ID-ERPNDB2)
 19387*         SET        (ADDRESS OF PENDING-BUSINESS)
 19388*         RIDFLD     (ERPNDB-ALT-KEY)
 19389*    END-EXEC.
 19390     MOVE 0
 19391       TO DFHEIV11
 19392*    MOVE '&0S                   )   #00016488' TO DFHEIV0
 19393     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 19394     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19395     MOVE X'2020233030303136343838' TO DFHEIV0(25:11)
 19396     CALL 'kxdfhei1' USING DFHEIV0,
 19397           FILE-ID-ERPNDB2,
 19398           DFHEIV20,
 19399           DFHEIV99,
 19400           ERPNDB-ALT-KEY,
 19401           DFHEIV99,
 19402           DFHEIV11,
 19403           DFHEIV99,
 19404           DFHEIV99
 19405     SET ADDRESS OF PENDING-BUSINESS TO
 19406         DFHEIV20
 19407     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19408
 19409
 19410     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19411
 19412     IF WS-BATCH-PREFIX = '#CL'
 19413        GO TO 4580-READ-PREV-RECORD.
 19414
 19415     MOVE SPACE                  TO WS-FIRST-TIME-SW.
 19416     GO TO 4505-READ-PREV-RECORD.
 19417
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 360
* EL6311.cbl
 19419
 19420******************************************************************
 19421*                                                                *
 19422*        B R O W S E   P R I M A R Y   B A C K W A R D           *
 19423*                                                                *
 19424******************************************************************
 19425
 19426 4600-BROWSE-PRIMARY-BACKWARD.
 19427        MOVE PI-PREV-KEY         TO ERPNDB-KEY.
 19428
 19429     IF ERPNDB-BATCH-SEQ-NO = +9999
 19430        MOVE PI-HIGH-SEQ-NO      TO ERPNDB-BATCH-SEQ-NO.
 19431
 19432        IF ERPNDB-BATCH-SEQ-NO = +0000
 19433           GO TO 4650-END-BATCH
 19434        ELSE
 19435           IF PI-MAP-NAME NOT = EL631D
 19436              IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19437                 SUBTRACT +1      FROM ERPNDB-BATCH-CHG-SEQ-NO
 19438              ELSE
 19439                 SUBTRACT +1      FROM ERPNDB-BATCH-SEQ-NO
 19440                 IF DISPLAY-CHANGE-RECORDS
 19441                    MOVE +999     TO ERPNDB-BATCH-CHG-SEQ-NO
 19442                 ELSE
 19443                    MOVE ZEROS    TO ERPNDB-BATCH-CHG-SEQ-NO.
 19444
 19445
 19446* EXEC CICS HANDLE CONDITION
 19447*         NOTFND    (4680-NOT-FOUND)
 19448*         ENDFILE   (4680-NOT-FOUND)
 19449*    END-EXEC.
 19450*    MOVE '"$I''                  ! O #00016529' TO DFHEIV0
 19451     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19452     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19453     MOVE X'4F20233030303136353239' TO DFHEIV0(25:11)
 19454     CALL 'kxdfhei1' USING DFHEIV0
 19455     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19456
 19457
 19458 4605-READ-NEXT.
 19459     IF ERPNDB-BATCH-SEQ-NO = +0000
 19460        GO TO 4650-END-BATCH.
 19461
 19462     IF PI-DISPLAY-ORIGINAL-BATCH
 19463        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 19464     ELSE
 19465        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 19466
 19467
 19468* EXEC CICS READ
 19469*         DATASET   (FILE-ID)
 19470*         SET       (ADDRESS OF PENDING-BUSINESS)
 19471*         RIDFLD    (ERPNDB-KEY)
 19472*    END-EXEC.
 19473*    MOVE '&"S        E          (   #00016543' TO DFHEIV0
 19474     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19475     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19476     MOVE X'2020233030303136353433' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 361
* EL6311.cbl
 19477     CALL 'kxdfhei1' USING DFHEIV0,
 19478           FILE-ID,
 19479           DFHEIV20,
 19480           DFHEIV99,
 19481           ERPNDB-KEY,
 19482           DFHEIV99,
 19483           DFHEIV99,
 19484           DFHEIV99
 19485     SET ADDRESS OF PENDING-BUSINESS TO
 19486         DFHEIV20
 19487     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19488
 19489
 19490     IF NOT  PI-PRIMARY-WITH-SELECT
 19491        GO TO 4607-CHECK-REC-TYPE.
 19492
 19493     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19494
 19495     IF  WS-BATCH-PREFIX = '#CL'
 19496         GO TO 4610-BUMP-SEQ.
 19497
 19498     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19499        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 19500           GO TO 4610-BUMP-SEQ
 19501        ELSE
 19502           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19503              GO TO 4607-CHECK-REC-TYPE
 19504           ELSE
 19505              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19506                 GO TO 4607-CHECK-REC-TYPE
 19507              ELSE
 19508                 GO TO 4610-BUMP-SEQ.
 19509
 19510     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19511        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19512           GO TO 4610-BUMP-SEQ.
 19513
 19514 4607-CHECK-REC-TYPE.
 19515     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19516         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19517             NEXT SENTENCE
 19518         ELSE
 19519             GO TO 4610-BUMP-SEQ.
 19520
 19521     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19522         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19523             NEXT SENTENCE
 19524        ELSE
 19525             GO TO 4610-BUMP-SEQ.
 19526
 19527     IF NOT DISPLAY-CHANGE-RECORDS AND
 19528            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19529        GO TO 4610-BUMP-SEQ.
 19530
 19531     IF DISPLAY-HOLD-RECORDS AND
 19532        NOT PB-RECORD-ON-HOLD
 19533          GO TO 4610-BUMP-SEQ.
 19534
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 362
* EL6311.cbl
 19535     IF PB-ISSUE
 19536        IF DISPLAY-CHK-REQ-RECORDS
 19537           GO TO 4610-BUMP-SEQ.
 19538
 19539     IF PB-ISSUE
 19540        IF ISSUE-WITH-WARNING
 19541           IF PB-WARNING-ERRORS
 19542              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19543                  GO TO 4610-BUMP-SEQ
 19544              ELSE
 19545                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19546                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19547                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19548                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19549                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19550                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19551                 GO TO 7000-DISPLAY-ISSUES
 19552           ELSE
 19553              GO TO 4610-BUMP-SEQ.
 19554
 19555     IF PB-ISSUE
 19556        IF (ISSUES-IN-ERROR AND
 19557            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19558            ALL-ISSUES
 19559            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19560            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19561            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19562            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19563            MOVE PB-SV-STATE            TO PI-SV-STATE
 19564            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19565            GO TO 7000-DISPLAY-ISSUES
 19566        ELSE
 19567            GO TO 4610-BUMP-SEQ.
 19568
 19569     IF PB-CANCELLATION
 19570        IF DISPLAY-CHK-REQ-RECORDS
 19571           IF PB-C-REFUND-REQUESTED
 19572              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19573              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19574              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19575              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19576              MOVE PB-SV-STATE            TO PI-SV-STATE
 19577              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19578              GO TO 7100-DISPLAY-CANCELS
 19579           ELSE
 19580              GO TO 4610-BUMP-SEQ.
 19581
 19582     IF PB-CANCELLATION
 19583        IF CANCEL-WITH-WARNING
 19584           IF PB-WARNING-ERRORS
 19585              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19586                  GO TO 4610-BUMP-SEQ
 19587              ELSE
 19588                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19589                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19590                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19591                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19592                 MOVE PB-SV-STATE            TO PI-SV-STATE
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 363
* EL6311.cbl
 19593                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19594                 GO TO 7100-DISPLAY-CANCELS
 19595           ELSE
 19596              GO TO 4610-BUMP-SEQ.
 19597
 19598     IF PB-CANCELLATION
 19599        IF (CANCEL-IN-ERROR  AND
 19600            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19601            ALL-CANCELS
 19602            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19603            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19604            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19605            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19606            MOVE PB-SV-STATE            TO PI-SV-STATE
 19607            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19608            GO TO 7100-DISPLAY-CANCELS.
 19609
 19610 4610-BUMP-SEQ.
 19611     IF ERPNDB-BATCH-SEQ-NO = ZEROS
 19612        GO TO 4650-END-BATCH.
 19613
 19614     IF DISPLAY-CHANGE-RECORDS
 19615        IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19616           SUBTRACT +1           FROM ERPNDB-BATCH-CHG-SEQ-NO
 19617        ELSE
 19618           MOVE +999             TO   ERPNDB-BATCH-CHG-SEQ-NO
 19619           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO
 19620        ELSE
 19621           MOVE ZEROS            TO   ERPNDB-BATCH-CHG-SEQ-NO
 19622           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO.
 19623
 19624        GO TO 4605-READ-NEXT.
 19625
 19626 4650-END-BATCH.
 19627     IF PI-MAP-NAME = EL631B
 19628        MOVE -1                  TO BMAINTL
 19629     ELSE
 19630        IF PI-MAP-NAME = EL631C
 19631           MOVE -1               TO CMAINTL
 19632        ELSE
 19633           MOVE -1               TO DPFENTRL.
 19634
 19635     MOVE ER-2252               TO EMI-ERROR.
 19636     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19637     GO TO 8200-SEND-DATAONLY.
 19638
 19639 4680-NOT-FOUND.
 19640     IF DISPLAY-CHANGE-RECORDS
 19641        IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19642           MOVE ZEROS            TO   ERPNDB-BATCH-CHG-SEQ-NO
 19643        ELSE
 19644           MOVE +999             TO   ERPNDB-BATCH-CHG-SEQ-NO
 19645           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO
 19646     ELSE
 19647        SUBTRACT +1              FROM ERPNDB-BATCH-SEQ-NO.
 19648
 19649     GO TO 4605-READ-NEXT.
 19650
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 364
* EL6311.cbl
 19652
 19653******************************************************************
 19654*                                                                *
 19655*        B R O W S E   F I L E   B A C K W A R D S               *
 19656*                                                                *
 19657******************************************************************
 19658
 19659 4800-BROWSE-FILE-BACKWARD.
 19660
 19661* EXEC CICS HANDLE CONDITION
 19662*         NOTFND   (4860-NOT-FOUND)
 19663*         ENDFILE  (4850-END-RECORDS)
 19664*    END-EXEC.
 19665*    MOVE '"$I''                  ! P #00016719' TO DFHEIV0
 19666     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19667     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19668     MOVE X'5020233030303136373139' TO DFHEIV0(25:11)
 19669     CALL 'kxdfhei1' USING DFHEIV0
 19670     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19671
 19672
 19673     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 19674
 19675     IF PI-DISPLAY-ORIGINAL-BATCH
 19676        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 19677     ELSE
 19678        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 19679
 19680
 19681* EXEC CICS STARTBR
 19682*         DATASET   (FILE-ID)
 19683*         RIDFLD    (ERPNDB-KEY)
 19684*    END-EXEC.
 19685     MOVE 0
 19686       TO DFHEIV11
 19687*    MOVE '&,         G          &   #00016731' TO DFHEIV0
 19688     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19689     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19690     MOVE X'2020233030303136373331' TO DFHEIV0(25:11)
 19691     CALL 'kxdfhei1' USING DFHEIV0,
 19692           FILE-ID,
 19693           ERPNDB-KEY,
 19694           DFHEIV99,
 19695           DFHEIV11,
 19696           DFHEIV99
 19697     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19698
 19699
 19700     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 19701
 19702
 19703* EXEC CICS READPREV
 19704*         DATASET    (FILE-ID-ERPNDB)
 19705*         SET        (ADDRESS OF PENDING-BUSINESS)
 19706*         RIDFLD     (ERPNDB-KEY)
 19707*    END-EXEC.
 19708     MOVE 0
 19709       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 365
* EL6311.cbl
 19710*    MOVE '&0S                   )   #00016738' TO DFHEIV0
 19711     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 19712     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19713     MOVE X'2020233030303136373338' TO DFHEIV0(25:11)
 19714     CALL 'kxdfhei1' USING DFHEIV0,
 19715           FILE-ID-ERPNDB,
 19716           DFHEIV20,
 19717           DFHEIV99,
 19718           ERPNDB-KEY,
 19719           DFHEIV99,
 19720           DFHEIV11,
 19721           DFHEIV99,
 19722           DFHEIV99
 19723     SET ADDRESS OF PENDING-BUSINESS TO
 19724         DFHEIV20
 19725     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19726
 19727
 19728 4810-READ-PREV-RECORD.
 19729
 19730* EXEC CICS READPREV
 19731*         DATASET    (FILE-ID-ERPNDB)
 19732*         SET        (ADDRESS OF PENDING-BUSINESS)
 19733*         RIDFLD     (ERPNDB-KEY)
 19734*    END-EXEC.
 19735     MOVE 0
 19736       TO DFHEIV11
 19737*    MOVE '&0S                   )   #00016745' TO DFHEIV0
 19738     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 19739     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19740     MOVE X'2020233030303136373435' TO DFHEIV0(25:11)
 19741     CALL 'kxdfhei1' USING DFHEIV0,
 19742           FILE-ID-ERPNDB,
 19743           DFHEIV20,
 19744           DFHEIV99,
 19745           ERPNDB-KEY,
 19746           DFHEIV99,
 19747           DFHEIV11,
 19748           DFHEIV99,
 19749           DFHEIV99
 19750     SET ADDRESS OF PENDING-BUSINESS TO
 19751         DFHEIV20
 19752     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19753
 19754
 19755     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD
 19756        GO TO 4850-END-RECORDS.
 19757
 19758     IF PB-BATCH-TRAILER
 19759        GO TO 4810-READ-PREV-RECORD.
 19760
 19761     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19762
 19763     IF  WS-BATCH-PREFIX = '#CL'
 19764         GO TO 4810-READ-PREV-RECORD.
 19765
 19766     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19767        IF PI-PB-CERT-NO NOT = PB-CERT-NO
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 366
* EL6311.cbl
 19768           GO TO 4810-READ-PREV-RECORD
 19769        ELSE
 19770           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19771              GO TO 4820-CHECK-REC-TYPE
 19772           ELSE
 19773              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19774                 GO TO 4820-CHECK-REC-TYPE
 19775              ELSE
 19776                 GO TO 4810-READ-PREV-RECORD.
 19777
 19778     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19779        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19780           GO TO 4810-READ-PREV-RECORD.
 19781
 19782 4820-CHECK-REC-TYPE.
 19783     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19784         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19785             NEXT SENTENCE
 19786         ELSE
 19787             GO TO 4810-READ-PREV-RECORD.
 19788
 19789     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19790         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19791             NEXT SENTENCE
 19792        ELSE
 19793             GO TO 4810-READ-PREV-RECORD.
 19794
 19795     IF NOT DISPLAY-CHANGE-RECORDS AND
 19796            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19797        GO TO 4810-READ-PREV-RECORD.
 19798
 19799     IF DISPLAY-HOLD-RECORDS AND
 19800        NOT PB-RECORD-ON-HOLD
 19801          GO TO 4810-READ-PREV-RECORD.
 19802
 19803     IF PB-ISSUE
 19804        IF DISPLAY-CHK-REQ-RECORDS
 19805           GO TO 4810-READ-PREV-RECORD.
 19806
 19807     IF PB-ISSUE
 19808        IF ISSUE-WITH-WARNING
 19809           IF PB-WARNING-ERRORS
 19810              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19811                  GO TO 4810-READ-PREV-RECORD
 19812              ELSE
 19813                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19814                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19815                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19816                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19817                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19818                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19819                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19820                 GO TO 7000-DISPLAY-ISSUES
 19821           ELSE
 19822              GO TO 4810-READ-PREV-RECORD.
 19823
 19824     IF PB-ISSUE
 19825        IF (ISSUES-IN-ERROR AND
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 367
* EL6311.cbl
 19826            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19827            ALL-ISSUES
 19828            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19829            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19830            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19831            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19832            MOVE PB-SV-STATE            TO PI-SV-STATE
 19833            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19834            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19835            GO TO 7000-DISPLAY-ISSUES
 19836        ELSE
 19837            GO TO 4810-READ-PREV-RECORD.
 19838
 19839     IF PB-CANCELLATION
 19840        IF DISPLAY-CHK-REQ-RECORDS
 19841           IF PB-C-REFUND-REQUESTED
 19842              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19843              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19844              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19845              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19846              MOVE PB-SV-STATE            TO PI-SV-STATE
 19847              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19848              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19849              GO TO 7100-DISPLAY-CANCELS
 19850           ELSE
 19851              GO TO 4810-READ-PREV-RECORD.
 19852
 19853     IF PB-CANCELLATION
 19854        IF CANCEL-WITH-WARNING
 19855           IF PB-WARNING-ERRORS
 19856              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19857                  GO TO 4810-READ-PREV-RECORD
 19858              ELSE
 19859                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19860                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19861                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19862                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19863                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19864                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19865                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19866                 GO TO 7100-DISPLAY-CANCELS
 19867           ELSE
 19868              GO TO 4810-READ-PREV-RECORD.
 19869
 19870     IF PB-CANCELLATION
 19871        IF (CANCEL-IN-ERROR  AND
 19872            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19873            ALL-CANCELS
 19874            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19875            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19876            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19877            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19878            MOVE PB-SV-STATE            TO PI-SV-STATE
 19879            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19880            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19881            GO TO 7100-DISPLAY-CANCELS.
 19882
 19883     GO TO 4810-READ-PREV-RECORD.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 368
* EL6311.cbl
 19884
 19885 4850-END-RECORDS.
 19886     MOVE ER-2252                TO EMI-ERROR.
 19887     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19888
 19889     IF PI-MAP-NAME = EL631B
 19890        MOVE -1                  TO BPFENTRL
 19891     ELSE
 19892        MOVE -1                  TO CPFENTRL.
 19893
 19894     GO TO 8200-SEND-DATAONLY.
 19895
 19896 4860-NOT-FOUND.
 19897
 19898******************************************************************
 19899*       CONDITION MAY OCCUR IF PREV RECORD HAS BEEN DELETED.     *
 19900******************************************************************
 19901
 19902
 19903* EXEC CICS RESETBR
 19904*         DATASET    (FILE-ID-ERPNDB)
 19905*         RIDFLD     (ERPNDB-KEY)
 19906*     END-EXEC.
 19907     MOVE 0
 19908       TO DFHEIV11
 19909*    MOVE '&4         G          &   #00016898' TO DFHEIV0
 19910     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 19911     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19912     MOVE X'2020233030303136383938' TO DFHEIV0(25:11)
 19913     CALL 'kxdfhei1' USING DFHEIV0,
 19914           FILE-ID-ERPNDB,
 19915           ERPNDB-KEY,
 19916           DFHEIV99,
 19917           DFHEIV11,
 19918           DFHEIV99
 19919     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19920
 19921
 19922
 19923* EXEC CICS READNEXT
 19924*         DATASET    (FILE-ID-ERPNDB)
 19925*         SET        (ADDRESS OF PENDING-BUSINESS)
 19926*         RIDFLD     (ERPNDB-KEY)
 19927*    END-EXEC.
 19928     MOVE 0
 19929       TO DFHEIV11
 19930*    MOVE '&.S                   )   #00016903' TO DFHEIV0
 19931     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19932     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19933     MOVE X'2020233030303136393033' TO DFHEIV0(25:11)
 19934     CALL 'kxdfhei1' USING DFHEIV0,
 19935           FILE-ID-ERPNDB,
 19936           DFHEIV20,
 19937           DFHEIV99,
 19938           ERPNDB-KEY,
 19939           DFHEIV99,
 19940           DFHEIV11,
 19941           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 369
* EL6311.cbl
 19942           DFHEIV99
 19943     SET ADDRESS OF PENDING-BUSINESS TO
 19944         DFHEIV20
 19945     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19946
 19947
 19948
 19949* EXEC CICS READPREV
 19950*         DATASET    (FILE-ID-ERPNDB)
 19951*         SET        (ADDRESS OF PENDING-BUSINESS)
 19952*         RIDFLD     (ERPNDB-KEY)
 19953*    END-EXEC.
 19954     MOVE 0
 19955       TO DFHEIV11
 19956*    MOVE '&0S                   )   #00016909' TO DFHEIV0
 19957     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 19958     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19959     MOVE X'2020233030303136393039' TO DFHEIV0(25:11)
 19960     CALL 'kxdfhei1' USING DFHEIV0,
 19961           FILE-ID-ERPNDB,
 19962           DFHEIV20,
 19963           DFHEIV99,
 19964           ERPNDB-KEY,
 19965           DFHEIV99,
 19966           DFHEIV11,
 19967           DFHEIV99,
 19968           DFHEIV99
 19969     SET ADDRESS OF PENDING-BUSINESS TO
 19970         DFHEIV20
 19971     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19972
 19973
 19974     GO TO 4810-READ-PREV-RECORD.
 19975
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 370
* EL6311.cbl
 19977
 19978******************************************************************
 19979*                                                                *
 19980*           B R O W S E   C S R   B A C K W A R D                *
 19981*                                                                *
 19982******************************************************************
 19983
 19984 4900-BROWSE-CSR-BACKWARD.
 19985
 19986     MOVE PI-PREV-CSR-KEY        TO ERPNDB-CSR-KEY.
 19987
 19988
 19989* EXEC CICS HANDLE CONDITION
 19990*         NOTFND   (4970-NOT-FOUND)
 19991*         ENDFILE  (4950-END-RECORDS)
 19992*    END-EXEC
 19993*    MOVE '"$I''                  ! Q #00016929' TO DFHEIV0
 19994     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19995     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19996     MOVE X'5120233030303136393239' TO DFHEIV0(25:11)
 19997     CALL 'kxdfhei1' USING DFHEIV0
 19998     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19999
 20000
 20001* EXEC CICS STARTBR
 20002*         DATASET   (FILE-ID-ERPNDB4)
 20003*         RIDFLD    (ERPNDB-CSR-KEY)
 20004*    END-EXEC.
 20005     MOVE 0
 20006       TO DFHEIV11
 20007*    MOVE '&,         G          &   #00016934' TO DFHEIV0
 20008     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20009     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20010     MOVE X'2020233030303136393334' TO DFHEIV0(25:11)
 20011     CALL 'kxdfhei1' USING DFHEIV0,
 20012           FILE-ID-ERPNDB4,
 20013           ERPNDB-CSR-KEY,
 20014           DFHEIV99,
 20015           DFHEIV11,
 20016           DFHEIV99
 20017     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20018
 20019
 20020     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW
 20021                                    WS-FIRST-TIME-SW.
 20022
 20023 4905-READ-PREV-RECORD.
 20024
 20025* EXEC CICS READPREV
 20026*         DATASET    (FILE-ID-ERPNDB4)
 20027*         SET        (ADDRESS OF PENDING-BUSINESS)
 20028*         RIDFLD     (ERPNDB-CSR-KEY)
 20029*    END-EXEC.
 20030     MOVE 0
 20031       TO DFHEIV11
 20032*    MOVE '&0S                   )   #00016943' TO DFHEIV0
 20033     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20034     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 371
* EL6311.cbl
 20035     MOVE X'2020233030303136393433' TO DFHEIV0(25:11)
 20036     CALL 'kxdfhei1' USING DFHEIV0,
 20037           FILE-ID-ERPNDB4,
 20038           DFHEIV20,
 20039           DFHEIV99,
 20040           ERPNDB-CSR-KEY,
 20041           DFHEIV99,
 20042           DFHEIV11,
 20043           DFHEIV99,
 20044           DFHEIV99
 20045     SET ADDRESS OF PENDING-BUSINESS TO
 20046         DFHEIV20
 20047     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20048
 20049
 20050     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20051
 20052     IF WS-BATCH-PREFIX = '#CL'
 20053         GO TO 4905-READ-PREV-RECORD.
 20054
 20055     IF FIRST-TIME
 20056         MOVE SPACE               TO WS-FIRST-TIME-SW
 20057         GO TO 4905-READ-PREV-RECORD.
 20058
 20059     IF PB-CSR-COMPANY-CD   NOT = PI-COMPANY-CD OR
 20060        PB-CSR-ID           NOT = PI-PB-CSR-ID
 20061        GO TO 4950-END-RECORDS.
 20062
 20063     IF PB-BATCH-TRAILER
 20064        GO TO 4905-READ-PREV-RECORD.
 20065
 20066     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20067
 20068     IF  WS-BATCH-PREFIX = '#CL'
 20069         GO TO 4905-READ-PREV-RECORD.
 20070
 20071     IF PI-PB-CERT-NO NOT = LOW-VALUES
 20072        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 20073           GO TO 4905-READ-PREV-RECORD
 20074        ELSE
 20075           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 20076              GO TO 4910-CHECK-REC-TYPE
 20077           ELSE
 20078              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 20079                 GO TO 4910-CHECK-REC-TYPE
 20080              ELSE
 20081                 GO TO 4905-READ-PREV-RECORD.
 20082
 20083     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 20084        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 20085           GO TO 4905-READ-PREV-RECORD.
 20086
 20087 4910-CHECK-REC-TYPE.
 20088     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20089         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20090             NEXT SENTENCE
 20091         ELSE
 20092             GO TO 4905-READ-PREV-RECORD.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 372
* EL6311.cbl
 20093
 20094     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20095         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20096             NEXT SENTENCE
 20097        ELSE
 20098             GO TO 4905-READ-PREV-RECORD.
 20099
 20100     IF NOT DISPLAY-CHANGE-RECORDS AND
 20101            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20102        GO TO 4905-READ-PREV-RECORD.
 20103
 20104     IF DISPLAY-HOLD-RECORDS AND
 20105        NOT PB-RECORD-ON-HOLD
 20106          GO TO 4905-READ-PREV-RECORD.
 20107
 20108     IF PB-ISSUE
 20109        IF DISPLAY-CHK-REQ-RECORDS
 20110           GO TO 4905-READ-PREV-RECORD.
 20111
 20112     IF PB-ISSUE
 20113        IF ISSUE-WITH-WARNING
 20114           IF PB-WARNING-ERRORS
 20115              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20116                  GO TO 4505-READ-PREV-RECORD
 20117              ELSE
 20118                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20119                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20120                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20121                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20122                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20123                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20124                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20125                 GO TO 7000-DISPLAY-ISSUES
 20126           ELSE
 20127              GO TO 4905-READ-PREV-RECORD.
 20128
 20129     IF PB-ISSUE
 20130        IF (ISSUES-IN-ERROR AND
 20131            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20132            ALL-ISSUES
 20133            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20134            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20135            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20136            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20137            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20138            MOVE PB-SV-STATE            TO PI-SV-STATE
 20139            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20140            GO TO 7000-DISPLAY-ISSUES
 20141        ELSE
 20142            GO TO 4905-READ-PREV-RECORD.
 20143
 20144     IF PB-CANCELLATION
 20145        IF DISPLAY-CHK-REQ-RECORDS
 20146           IF PB-C-REFUND-REQUESTED
 20147              MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20148              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20149              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20150              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 373
* EL6311.cbl
 20151              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20152              MOVE PB-SV-STATE            TO PI-SV-STATE
 20153              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20154              GO TO 7100-DISPLAY-CANCELS
 20155           ELSE
 20156              GO TO 4905-READ-PREV-RECORD.
 20157
 20158     IF PB-CANCELLATION
 20159        IF CANCEL-WITH-WARNING
 20160           IF PB-WARNING-ERRORS
 20161              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20162                  GO TO 4505-READ-PREV-RECORD
 20163              ELSE
 20164                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20165                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20166                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20167                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20168                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20169                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20170                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20171                 GO TO 7100-DISPLAY-CANCELS
 20172           ELSE
 20173              GO TO 4905-READ-PREV-RECORD.
 20174
 20175     IF PB-CANCELLATION
 20176        IF (CANCEL-IN-ERROR  AND
 20177            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20178            ALL-CANCELS
 20179            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20180            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20181            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20182            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20183            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20184            MOVE PB-SV-STATE            TO PI-SV-STATE
 20185            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20186            GO TO 7100-DISPLAY-CANCELS.
 20187
 20188     GO TO 4905-READ-PREV-RECORD.
 20189
 20190 4950-END-RECORDS.
 20191     IF PI-MAP-NAME = EL631B
 20192        MOVE -1                  TO BMAINTL
 20193     ELSE
 20194        IF PI-MAP-NAME = EL631C
 20195           MOVE -1               TO CMAINTL
 20196        ELSE
 20197           MOVE -1               TO DPFENTRL.
 20198
 20199     MOVE ER-2255               TO EMI-ERROR.
 20200     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20201     GO TO 8200-SEND-DATAONLY.
 20202
 20203 4970-NOT-FOUND.
 20204
 20205******************************************************************
 20206*      CONDITION MAY OCCUR IF PREV. RECORD HAS BEEN DELETED.     *
 20207******************************************************************
 20208
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 374
* EL6311.cbl
 20209
 20210* EXEC CICS RESETBR
 20211*         DATASET    (FILE-ID-ERPNDB4)
 20212*         RIDFLD     (ERPNDB-CSR-KEY)
 20213*    END-EXEC.
 20214     MOVE 0
 20215       TO DFHEIV11
 20216*    MOVE '&4         G          &   #00017108' TO DFHEIV0
 20217     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 20218     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20219     MOVE X'2020233030303137313038' TO DFHEIV0(25:11)
 20220     CALL 'kxdfhei1' USING DFHEIV0,
 20221           FILE-ID-ERPNDB4,
 20222           ERPNDB-CSR-KEY,
 20223           DFHEIV99,
 20224           DFHEIV11,
 20225           DFHEIV99
 20226     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20227
 20228
 20229
 20230* EXEC CICS READNEXT
 20231*         DATASET    (FILE-ID-ERPNDB4)
 20232*         SET        (ADDRESS OF PENDING-BUSINESS)
 20233*         RIDFLD     (ERPNDB-CSR-KEY)
 20234*    END-EXEC.
 20235     MOVE 0
 20236       TO DFHEIV11
 20237*    MOVE '&.S                   )   #00017113' TO DFHEIV0
 20238     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 20239     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20240     MOVE X'2020233030303137313133' TO DFHEIV0(25:11)
 20241     CALL 'kxdfhei1' USING DFHEIV0,
 20242           FILE-ID-ERPNDB4,
 20243           DFHEIV20,
 20244           DFHEIV99,
 20245           ERPNDB-CSR-KEY,
 20246           DFHEIV99,
 20247           DFHEIV11,
 20248           DFHEIV99,
 20249           DFHEIV99
 20250     SET ADDRESS OF PENDING-BUSINESS TO
 20251         DFHEIV20
 20252     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20253
 20254
 20255
 20256* EXEC CICS READPREV
 20257*         DATASET    (FILE-ID-ERPNDB4)
 20258*         SET        (ADDRESS OF PENDING-BUSINESS)
 20259*         RIDFLD     (ERPNDB-CSR-KEY)
 20260*    END-EXEC.
 20261     MOVE 0
 20262       TO DFHEIV11
 20263*    MOVE '&0S                   )   #00017119' TO DFHEIV0
 20264     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20265     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20266     MOVE X'2020233030303137313139' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 375
* EL6311.cbl
 20267     CALL 'kxdfhei1' USING DFHEIV0,
 20268           FILE-ID-ERPNDB4,
 20269           DFHEIV20,
 20270           DFHEIV99,
 20271           ERPNDB-CSR-KEY,
 20272           DFHEIV99,
 20273           DFHEIV11,
 20274           DFHEIV99,
 20275           DFHEIV99
 20276     SET ADDRESS OF PENDING-BUSINESS TO
 20277         DFHEIV20
 20278     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20279
 20280
 20281 4980-READ-PREV-RECORD.
 20282
 20283* EXEC CICS READPREV
 20284*         DATASET    (FILE-ID-ERPNDB4)
 20285*         SET        (ADDRESS OF PENDING-BUSINESS)
 20286*         RIDFLD     (ERPNDB-CSR-KEY)
 20287*    END-EXEC.
 20288     MOVE 0
 20289       TO DFHEIV11
 20290*    MOVE '&0S                   )   #00017126' TO DFHEIV0
 20291     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20292     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20293     MOVE X'2020233030303137313236' TO DFHEIV0(25:11)
 20294     CALL 'kxdfhei1' USING DFHEIV0,
 20295           FILE-ID-ERPNDB4,
 20296           DFHEIV20,
 20297           DFHEIV99,
 20298           ERPNDB-CSR-KEY,
 20299           DFHEIV99,
 20300           DFHEIV11,
 20301           DFHEIV99,
 20302           DFHEIV99
 20303     SET ADDRESS OF PENDING-BUSINESS TO
 20304         DFHEIV20
 20305     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20306
 20307
 20308     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20309
 20310     IF WS-BATCH-PREFIX = '#CL'
 20311        GO TO 4980-READ-PREV-RECORD.
 20312
 20313     MOVE SPACE                  TO WS-FIRST-TIME-SW.
 20314     GO TO 4905-READ-PREV-RECORD.
 20315
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 376
* EL6311.cbl
 20317
 20318
 20319******************************************************************
 20320*                                                                *
 20321*        B R O W S E   B A T C H   H E A D E R S                 *
 20322*                                                                *
 20323******************************************************************
 20324
 20325 5000-BROWSE-BATCH-HEADERS.
 20326
 20327     IF EIBTRNID NOT = TRANS-EXB1
 20328        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY
 20329        MOVE +9999               TO ERPNDB-BATCH-SEQ-NO
 20330        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 20331        GO TO 5010-READ-NEXT-RECORD.
 20332
 20333     IF EIBAID = DFHPF4
 20334        MOVE '0'                TO PI-EDIT-SW
 20335        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 20336        MOVE +9999               TO ERPNDB-BATCH-SEQ-NO
 20337        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 20338        GO TO 5010-READ-NEXT-RECORD.
 20339
 20340     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 20341     MOVE HIGH-VALUES            TO ERPNDB-BATCH-SEQ-ALPHA.
 20342     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 20343
 20344
 20345* EXEC CICS HANDLE CONDITION
 20346*         ENDFILE  (5050-NOT-FOUND)
 20347*    END-EXEC.
 20348*    MOVE '"$''                   ! R #00017168' TO DFHEIV0
 20349     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 20350     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20351     MOVE X'5220233030303137313638' TO DFHEIV0(25:11)
 20352     CALL 'kxdfhei1' USING DFHEIV0
 20353     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20354
 20355
 20356 5010-READ-NEXT-RECORD.
 20357
 20358* EXEC CICS HANDLE CONDITION
 20359*         NOTFND    (5050-NOT-FOUND)
 20360*    END-EXEC.
 20361*    MOVE '"$I                   ! S #00017173' TO DFHEIV0
 20362     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20363     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20364     MOVE X'5320233030303137313733' TO DFHEIV0(25:11)
 20365     CALL 'kxdfhei1' USING DFHEIV0
 20366     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20367
 20368
 20369
 20370* EXEC CICS READ
 20371*         DATASET   (FILE-ID-ERPNDB)
 20372*         SET       (ADDRESS OF PENDING-BUSINESS)
 20373*         RIDFLD    (ERPNDB-KEY)
 20374*         GTEQ
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 377
* EL6311.cbl
 20375*    END-EXEC.
 20376*    MOVE '&"S        G          (   #00017177' TO DFHEIV0
 20377     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 20378     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20379     MOVE X'2020233030303137313737' TO DFHEIV0(25:11)
 20380     CALL 'kxdfhei1' USING DFHEIV0,
 20381           FILE-ID-ERPNDB,
 20382           DFHEIV20,
 20383           DFHEIV99,
 20384           ERPNDB-KEY,
 20385           DFHEIV99,
 20386           DFHEIV99,
 20387           DFHEIV99
 20388     SET ADDRESS OF PENDING-BUSINESS TO
 20389         DFHEIV20
 20390     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20391
 20392
 20393     IF PB-COMPANY-CD NOT = PI-COMPANY-CD
 20394         GO TO 5050-NOT-FOUND.
 20395
 20396     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20397
 20398     IF WS-BATCH-PREFIX = '#CL'
 20399         MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 20400         MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
 20401         GO TO 5010-READ-NEXT-RECORD.
 20402
 20403     IF NOT PB-BATCH-TRAILER
 20404         MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 20405         MOVE +9999            TO ERPNDB-BATCH-SEQ-NO
 20406         GO TO 5010-READ-NEXT-RECORD.
 20407
 20408     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20409         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20410             NEXT SENTENCE
 20411         ELSE
 20412             MOVE PB-ENTRY-BATCH     TO ERPNDB-ENTRY-BATCH
 20413             MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 20414             MOVE ZEROS              TO ERPNDB-BATCH-CHG-SEQ-NO
 20415             GO TO 5010-READ-NEXT-RECORD.
 20416
 20417     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20418         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20419             NEXT SENTENCE
 20420        ELSE
 20421             MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 20422             MOVE ZEROS              TO ERPNDB-BATCH-CHG-SEQ-NO
 20423             GO TO 5010-READ-NEXT-RECORD.
 20424
 20425     IF EIBAID = DFHPF4
 20426        MOVE '0'                TO PI-EDIT-SW
 20427        GO TO 7200-DISPLAY-BATCHES.
 20428
 20429     IF PI-CSR-BROWSE
 20430        IF PB-CSR-ID           NOT = PI-PB-CSR-ID
 20431           MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 20432           MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 378
* EL6311.cbl
 20433           GO TO 5010-READ-NEXT-RECORD.
 20434
 20435     IF ONLY-BATCH-HEADERS OR PB-OUT-OF-BAL
 20436       IF PI-PB-CARRIER    = SPACES AND
 20437          PI-PB-GROUPING   = SPACES AND
 20438          PI-PB-STATE      = SPACES AND
 20439          PI-PB-ACCOUNT    = SPACES
 20440            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20441            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20442            GO TO 7200-DISPLAY-BATCHES
 20443         ELSE
 20444           IF PI-PB-CARRIER    = PB-CARRIER  AND
 20445              PI-PB-GROUPING   = PB-GROUPING AND
 20446              PI-PB-STATE      = PB-STATE    AND
 20447              PI-PB-ACCOUNT    = PB-ACCOUNT
 20448              MOVE PB-CONTROL-PRIMARY  TO PI-PREV-KEY
 20449              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20450              GO TO 7200-DISPLAY-BATCHES.
 20451
 20452     MOVE PB-CONTROL-PRIMARY        TO ERPNDB-KEY.
 20453     MOVE HIGH-VALUE                TO ERPNDB-BATCH-SEQ-ALPHA.
 20454
 20455
 20456* EXEC CICS HANDLE CONDITION
 20457*         NOTFND    (5050-NOT-FOUND)
 20458*    END-EXEC.
 20459*    MOVE '"$I                   ! T #00017246' TO DFHEIV0
 20460     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20461     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20462     MOVE X'5420233030303137323436' TO DFHEIV0(25:11)
 20463     CALL 'kxdfhei1' USING DFHEIV0
 20464     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20465
 20466
 20467
 20468* EXEC CICS READ
 20469*         DATASET   (FILE-ID-ERPNDB)
 20470*         SET       (ADDRESS OF PENDING-BUSINESS)
 20471*         RIDFLD    (ERPNDB-KEY)
 20472*         GTEQ
 20473*    END-EXEC.
 20474*    MOVE '&"S        G          (   #00017250' TO DFHEIV0
 20475     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 20476     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20477     MOVE X'2020233030303137323530' TO DFHEIV0(25:11)
 20478     CALL 'kxdfhei1' USING DFHEIV0,
 20479           FILE-ID-ERPNDB,
 20480           DFHEIV20,
 20481           DFHEIV99,
 20482           ERPNDB-KEY,
 20483           DFHEIV99,
 20484           DFHEIV99,
 20485           DFHEIV99
 20486     SET ADDRESS OF PENDING-BUSINESS TO
 20487         DFHEIV20
 20488     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20489
 20490
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 379
* EL6311.cbl
 20491     GO TO 5010-READ-NEXT-RECORD.
 20492
 20493 5050-NOT-FOUND.
 20494
 20495******************************************************************
 20496*                                                                *
 20497*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 20498*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING     *
 20499*         PROGRAM.                                               *
 20500*                                                                *
 20501******************************************************************
 20502
 20503     IF EIBTRNID NOT = TRANS-EXB1
 20504        IF PENDING-BUS-RECS-FOUND
 20505            NEXT SENTENCE
 20506          ELSE
 20507            MOVE '9'            TO PI-BROWSE-SW
 20508            GO TO 9400-CLEAR.
 20509
 20510     MOVE ER-2256                TO EMI-ERROR.
 20511     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20512
 20513     IF PI-MAP-NAME = SPACES
 20514        MOVE EL631D              TO PI-MAP-NAME
 20515        MOVE -1                  TO DPFENTRL
 20516        GO TO 8100-SEND-INITIAL-MAP.
 20517
 20518     IF PI-MAP-NAME = EL631B
 20519        MOVE -1                  TO BMAINTL
 20520     ELSE
 20521        IF PI-MAP-NAME = EL631C
 20522           MOVE -1               TO CMAINTL
 20523        ELSE
 20524           MOVE -1               TO DPFENTRL
 20525           GO TO 8200-SEND-DATAONLY.
 20526
 20527     GO TO 8100-SEND-INITIAL-MAP.
 20528
 20529     .
 20530 5100-PROCESS-POL-RESC.
 20531     MOVE ZEROS                  TO CG-LF-BENCD
 20532                                    CG-AH-BENCD
 20533                                    CG-LF-CAN-AMT
 20534                                    CG-AH-CAN-AMT
 20535     MOVE LOW-VALUES             TO CG-LF-CAN-DT
 20536                                    CG-AH-CAN-DT
 20537     MOVE SPACES                 TO CG-BATCH-NO
 20538     MOVE '4'                    TO CG-OPTION-CODE
 20539     MOVE PI-COMPANY-ID          TO CG-COMPANY-ID
 20540     MOVE PI-PROCESSOR-ID        TO CG-PROC-ID
 20541     MOVE PI-CR-MONTH-END-DT     TO CG-MONTH-END-DT
 20542     MOVE PI-COMPANY-CD          TO CG-CERT-COMPANY-CD
 20543     MOVE PI-SV-CARRIER          TO CG-CERT-CARRIER
 20544     MOVE PI-SV-GROUPING         TO CG-CERT-GROUP
 20545     MOVE PI-SV-STATE            TO CG-CERT-STATE
 20546     MOVE PI-PB-ACCOUNT          TO CG-CERT-ACCOUNT
 20547     MOVE PI-PB-CERT-EFF-DT      TO CG-CERT-EFF-DT
 20548     MOVE PI-PB-CERT-NO          TO CG-CERT-CERT-NO
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 380
* EL6311.cbl
 20549     MOVE PI-PREV-ALT-KEY (1:33)
 20550                                 TO CG-CERT-KEY
 20551     MOVE WS-CURRENT-BIN-DT      TO CG-CURRENT-DT
 20552     MOVE ZEROS                  TO CG-LF-CAN-AMT
 20553                                    CG-AH-CAN-AMT
 20554     MOVE LOW-VALUES             TO CG-LF-CAN-DT
 20555                                    CG-AH-CAN-DT
 20556     MOVE PI-PREV-BATCH          TO CG-BATCH-NO
 20557     MOVE ZERO                   TO CG-BATCH-SEQ-NO
 20558      display 'about to cancel ' cg-cert-key
 20559
 20560* EXEC CICS LINK
 20561*        PROGRAM  ('ELCANC')
 20562*        COMMAREA (CANCEL-GEN-PASS-AREA)
 20563*    END-EXEC
 20564     MOVE LENGTH OF
 20565      CANCEL-GEN-PASS-AREA
 20566       TO DFHEIV11
 20567     MOVE 'ELCANC' TO DFHEIV1
 20568*    MOVE '."C                   (   #00017325' TO DFHEIV0
 20569     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20570     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20571     MOVE X'2020233030303137333235' TO DFHEIV0(25:11)
 20572     CALL 'kxdfhei1' USING DFHEIV0,
 20573           DFHEIV1,
 20574           CANCEL-GEN-PASS-AREA,
 20575           DFHEIV11,
 20576           DFHEIV99,
 20577           DFHEIV99,
 20578           DFHEIV99,
 20579           DFHEIV99
 20580     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20581     IF CG-SUCCESS
 20582        CONTINUE
 20583     ELSE
 20584        MOVE SPACES              TO EMI-MESSAGE-AREA (1)
 20585        MOVE '3'                 TO EMI-SWITCH1
 20586        MOVE CG-ERROR-CODE TO EMI-TEXT-VARIABLE (1)
 20587        EVALUATE TRUE
 20588           WHEN CG-DATE-ERROR
 20589             MOVE WS-01-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 20590           WHEN CG-CERT-NOT-FOUND
 20591             MOVE WS-02-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 20592           WHEN CG-AMOUNT-ERROR
 20593             MOVE WS-04-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 20594           WHEN CG-OPTION-ERROR
 20595             MOVE WS-05-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 20596           WHEN CG-PREV-CAN
 20597             MOVE WS-06-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 20598           WHEN CG-INVALID-DATA
 20599             MOVE WS-07-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 20600           WHEN CG-NO-ACCT-MSTR
 20601             MOVE WS-08-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 20602           WHEN CG-SFX-A-EXIST
 20603             MOVE WS-09-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 20604           WHEN CG-MISC-ERROR
 20605             MOVE WS-99-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 20606           WHEN OTHER
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 381
* EL6311.cbl
 20607             MOVE ' ERROR - ELCANC - RETURN '
 20608                                 TO EMI-ERROR-TEXT (1) (12:25)
 20609        END-EVALUATE
 20610        GO TO 8200-SEND-DATAONLY
 20611     END-IF
 20612     .
 20613 5100-EXIT.
 20614     EXIT.
 20615
 20616******************************************************************
 20617*                                                                *
 20618*        B R O W S E   B A T C H   B A C K W A R D S             *
 20619*                                                                *
 20620******************************************************************
 20621
 20622 5500-BROWSE-BATCH-BACKWARD.
 20623
 20624* EXEC CICS HANDLE CONDITION
 20625*         NOTFND   (5550-END-RECORDS)
 20626*         ENDFILE  (5550-END-RECORDS)
 20627*    END-EXEC.
 20628*    MOVE '"$I''                  ! U #00017371' TO DFHEIV0
 20629     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20630     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20631     MOVE X'5520233030303137333731' TO DFHEIV0(25:11)
 20632     CALL 'kxdfhei1' USING DFHEIV0
 20633     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20634
 20635
 20636 5505-START-BROWSE.
 20637     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 20638     MOVE +1                     TO ERPNDB-BATCH-SEQ-NO.
 20639     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 20640
 20641
 20642* EXEC CICS STARTBR
 20643*         DATASET   (FILE-ID-ERPNDB)
 20644*         RIDFLD    (ERPNDB-ALT-KEY)
 20645*    END-EXEC.
 20646     MOVE 0
 20647       TO DFHEIV11
 20648*    MOVE '&,         G          &   #00017381' TO DFHEIV0
 20649     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20650     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20651     MOVE X'2020233030303137333831' TO DFHEIV0(25:11)
 20652     CALL 'kxdfhei1' USING DFHEIV0,
 20653           FILE-ID-ERPNDB,
 20654           ERPNDB-ALT-KEY,
 20655           DFHEIV99,
 20656           DFHEIV11,
 20657           DFHEIV99
 20658     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20659
 20660
 20661     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 20662
 20663
 20664* EXEC CICS READNEXT
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 382
* EL6311.cbl
 20665*         DATASET    (FILE-ID-ERPNDB)
 20666*         SET        (ADDRESS OF PENDING-BUSINESS)
 20667*         RIDFLD     (ERPNDB-KEY)
 20668*    END-EXEC.
 20669     MOVE 0
 20670       TO DFHEIV11
 20671*    MOVE '&.S                   )   #00017388' TO DFHEIV0
 20672     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 20673     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20674     MOVE X'2020233030303137333838' TO DFHEIV0(25:11)
 20675     CALL 'kxdfhei1' USING DFHEIV0,
 20676           FILE-ID-ERPNDB,
 20677           DFHEIV20,
 20678           DFHEIV99,
 20679           ERPNDB-KEY,
 20680           DFHEIV99,
 20681           DFHEIV11,
 20682           DFHEIV99,
 20683           DFHEIV99
 20684     SET ADDRESS OF PENDING-BUSINESS TO
 20685         DFHEIV20
 20686     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20687
 20688
 20689
 20690* EXEC CICS READPREV
 20691*         DATASET    (FILE-ID-ERPNDB)
 20692*         SET        (ADDRESS OF PENDING-BUSINESS)
 20693*         RIDFLD     (ERPNDB-KEY)
 20694*    END-EXEC.
 20695     MOVE 0
 20696       TO DFHEIV11
 20697*    MOVE '&0S                   )   #00017394' TO DFHEIV0
 20698     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20699     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20700     MOVE X'2020233030303137333934' TO DFHEIV0(25:11)
 20701     CALL 'kxdfhei1' USING DFHEIV0,
 20702           FILE-ID-ERPNDB,
 20703           DFHEIV20,
 20704           DFHEIV99,
 20705           ERPNDB-KEY,
 20706           DFHEIV99,
 20707           DFHEIV11,
 20708           DFHEIV99,
 20709           DFHEIV99
 20710     SET ADDRESS OF PENDING-BUSINESS TO
 20711         DFHEIV20
 20712     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20713
 20714
 20715
 20716* EXEC CICS READPREV
 20717*         DATASET    (FILE-ID-ERPNDB)
 20718*         SET        (ADDRESS OF PENDING-BUSINESS)
 20719*         RIDFLD     (ERPNDB-KEY)
 20720*    END-EXEC.
 20721     MOVE 0
 20722       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 383
* EL6311.cbl
 20723*    MOVE '&0S                   )   #00017400' TO DFHEIV0
 20724     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20725     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20726     MOVE X'2020233030303137343030' TO DFHEIV0(25:11)
 20727     CALL 'kxdfhei1' USING DFHEIV0,
 20728           FILE-ID-ERPNDB,
 20729           DFHEIV20,
 20730           DFHEIV99,
 20731           ERPNDB-KEY,
 20732           DFHEIV99,
 20733           DFHEIV11,
 20734           DFHEIV99,
 20735           DFHEIV99
 20736     SET ADDRESS OF PENDING-BUSINESS TO
 20737         DFHEIV20
 20738     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20739
 20740
 20741     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD
 20742        GO TO 5550-END-RECORDS.
 20743
 20744     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 20745
 20746     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20747
 20748     IF  WS-BATCH-PREFIX = '#CL'
 20749             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 20750
 20751* EXEC CICS ENDBR
 20752*                 DATASET  (FILE-ID-ERPNDB)
 20753*            END-EXEC
 20754     MOVE 0
 20755       TO DFHEIV11
 20756*    MOVE '&2                    $   #00017415' TO DFHEIV0
 20757     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20758     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20759     MOVE X'2020233030303137343135' TO DFHEIV0(25:11)
 20760     CALL 'kxdfhei1' USING DFHEIV0,
 20761           FILE-ID-ERPNDB,
 20762           DFHEIV11,
 20763           DFHEIV99
 20764     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20765         GO TO 5505-START-BROWSE.
 20766
 20767     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20768         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20769             NEXT SENTENCE
 20770         ELSE
 20771             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 20772
 20773* EXEC CICS ENDBR
 20774*                 DATASET  (FILE-ID-ERPNDB)
 20775*            END-EXEC
 20776     MOVE 0
 20777       TO DFHEIV11
 20778*    MOVE '&2                    $   #00017425' TO DFHEIV0
 20779     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20780     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 384
* EL6311.cbl
 20781     MOVE X'2020233030303137343235' TO DFHEIV0(25:11)
 20782     CALL 'kxdfhei1' USING DFHEIV0,
 20783           FILE-ID-ERPNDB,
 20784           DFHEIV11,
 20785           DFHEIV99
 20786     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20787             GO TO 5505-START-BROWSE.
 20788
 20789
 20790     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20791         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20792             NEXT SENTENCE
 20793        ELSE
 20794             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 20795
 20796* EXEC CICS ENDBR
 20797*                 DATASET  (FILE-ID-ERPNDB)
 20798*            END-EXEC
 20799     MOVE 0
 20800       TO DFHEIV11
 20801*    MOVE '&2                    $   #00017436' TO DFHEIV0
 20802     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20803     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20804     MOVE X'2020233030303137343336' TO DFHEIV0(25:11)
 20805     CALL 'kxdfhei1' USING DFHEIV0,
 20806           FILE-ID-ERPNDB,
 20807           DFHEIV11,
 20808           DFHEIV99
 20809     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20810             GO TO 5505-START-BROWSE.
 20811
 20812     IF NOT PB-BATCH-TRAILER
 20813        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 20814
 20815* EXEC CICS ENDBR
 20816*            DATASET  (FILE-ID-ERPNDB)
 20817*       END-EXEC
 20818     MOVE 0
 20819       TO DFHEIV11
 20820*    MOVE '&2                    $   #00017443' TO DFHEIV0
 20821     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20822     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20823     MOVE X'2020233030303137343433' TO DFHEIV0(25:11)
 20824     CALL 'kxdfhei1' USING DFHEIV0,
 20825           FILE-ID-ERPNDB,
 20826           DFHEIV11,
 20827           DFHEIV99
 20828     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20829        GO TO 5505-START-BROWSE.
 20830
 20831     IF PI-CSR-BROWSE
 20832        IF PB-CSR-ID           NOT = PI-PB-CSR-ID
 20833           MOVE SPACE            TO WS-BROWSE-STARTED-SW
 20834
 20835* EXEC CICS ENDBR
 20836*               DATASET  (FILE-ID-ERPNDB)
 20837*          END-EXEC
 20838     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 385
* EL6311.cbl
 20839       TO DFHEIV11
 20840*    MOVE '&2                    $   #00017451' TO DFHEIV0
 20841     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20842     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20843     MOVE X'2020233030303137343531' TO DFHEIV0(25:11)
 20844     CALL 'kxdfhei1' USING DFHEIV0,
 20845           FILE-ID-ERPNDB,
 20846           DFHEIV11,
 20847           DFHEIV99
 20848     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20849           GO TO 5505-START-BROWSE.
 20850
 20851     IF ONLY-BATCH-HEADERS OR PB-OUT-OF-BAL
 20852        IF PI-PB-CARRIER    = SPACES AND
 20853           PI-PB-GROUPING   = SPACES AND
 20854           PI-PB-STATE      = SPACES AND
 20855           PI-PB-ACCOUNT    = SPACES
 20856             GO TO 7200-DISPLAY-BATCHES
 20857          ELSE
 20858            IF PI-PB-CARRIER    = PB-CARRIER  AND
 20859               PI-PB-GROUPING   = PB-GROUPING AND
 20860               PI-PB-STATE      = PB-STATE    AND
 20861               PI-PB-ACCOUNT    = PB-ACCOUNT
 20862                 GO TO 7200-DISPLAY-BATCHES.
 20863
 20864     MOVE SPACE                  TO WS-BROWSE-STARTED-SW.
 20865
 20866
 20867* EXEC CICS ENDBR
 20868*         DATASET  (FILE-ID-ERPNDB)
 20869*    END-EXEC.
 20870     MOVE 0
 20871       TO DFHEIV11
 20872*    MOVE '&2                    $   #00017471' TO DFHEIV0
 20873     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20874     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20875     MOVE X'2020233030303137343731' TO DFHEIV0(25:11)
 20876     CALL 'kxdfhei1' USING DFHEIV0,
 20877           FILE-ID-ERPNDB,
 20878           DFHEIV11,
 20879           DFHEIV99
 20880     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20881
 20882
 20883     GO TO 5505-START-BROWSE.
 20884
 20885 5550-END-RECORDS.
 20886     MOVE ER-2257                TO EMI-ERROR.
 20887     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20888     MOVE -1                     TO DPFENTRL.
 20889
 20890     GO TO 8200-SEND-DATAONLY.
 20891
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 386
* EL6311.cbl
 20893
 20894******************************************************************
 20895*                                                                *
 20896*        C R E A T E   T E M P O R A R Y   S T O R A G E         *
 20897*                                                                *
 20898******************************************************************
 20899
 20900 6000-CREATE-TEMP-STORAGE.
 20901
 20902
 20903* EXEC CICS HANDLE CONDITION
 20904*        QIDERR  (6050-QID-ERROR)
 20905*    END-EXEC.
 20906*    MOVE '"$N                   ! V #00017494' TO DFHEIV0
 20907     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 20908     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20909     MOVE X'5620233030303137343934' TO DFHEIV0(25:11)
 20910     CALL 'kxdfhei1' USING DFHEIV0
 20911     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20912
 20913
 20914
 20915* EXEC CICS WRITEQ TS
 20916*        QUEUE    (QID)
 20917*        FROM     (PROGRAM-INTERFACE-BLOCK)
 20918*        LENGTH   (WS-COMM-LENGTH)
 20919*        ITEM     (W-ONE)
 20920*    END-EXEC.
 20921*    MOVE '*" I                  ''   #00017498' TO DFHEIV0
 20922     MOVE X'2A2220492020202020202020' TO DFHEIV0(1:12)
 20923     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20924     MOVE X'2020233030303137343938' TO DFHEIV0(25:11)
 20925     CALL 'kxdfhei1' USING DFHEIV0,
 20926           QID,
 20927           PROGRAM-INTERFACE-BLOCK,
 20928           WS-COMM-LENGTH,
 20929           W-ONE,
 20930           DFHEIV99,
 20931           DFHEIV99
 20932     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20933
 20934
 20935 6000-EXIT.
 20936      EXIT.
 20937
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 387
* EL6311.cbl
 20939
 20940******************************************************************
 20941*                                                                *
 20942*        R E C O V E R   T E M P O R A R Y   S T O R A G E       *
 20943*                                                                *
 20944******************************************************************
 20945
 20946 6050-RECOVER-TEMP-STORAGE.
 20947     IF PGM-NAME = XCTL-EL6312
 20948        GO TO 6050-EXIT.
 20949
 20950     IF PGM-NAME = XCTL-EL6313
 20951        GO TO 6050-EXIT.
 20952
 20953     IF PGM-NAME = XCTL-EL6315
 20954         MOVE PI-PROGRAM-WORK-AREA TO WS-EL6315-PASS-AREA
 20955     END-IF
 20956
 20957     IF PGM-NAME = XCTL-EL6316
 20958         MOVE PI-PROGRAM-WORK-AREA TO WS-EL6316-PASS-AREA
 20959     END-IF
 20960
 20961
 20962* EXEC CICS HANDLE CONDITION
 20963*        QIDERR  (6050-QID-ERROR)
 20964*    END-EXEC.
 20965*    MOVE '"$N                   ! W #00017531' TO DFHEIV0
 20966     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 20967     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20968     MOVE X'5720233030303137353331' TO DFHEIV0(25:11)
 20969     CALL 'kxdfhei1' USING DFHEIV0
 20970     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20971
 20972
 20973
 20974* EXEC CICS READQ TS
 20975*         QUEUE   (QID)
 20976*         INTO    (PROGRAM-INTERFACE-BLOCK)
 20977*         LENGTH  (WS-COMM-LENGTH)
 20978*         ITEM    (W-ONE)
 20979*     END-EXEC.
 20980*    MOVE '*$II   L              ''   #00017535' TO DFHEIV0
 20981     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
 20982     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20983     MOVE X'2020233030303137353335' TO DFHEIV0(25:11)
 20984     CALL 'kxdfhei1' USING DFHEIV0,
 20985           QID,
 20986           PROGRAM-INTERFACE-BLOCK,
 20987           WS-COMM-LENGTH,
 20988           W-ONE,
 20989           DFHEIV99,
 20990           DFHEIV99
 20991     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20992
 20993
 20994 6050-DELETE-TEMP-STORAGE.
 20995
 20996
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 388
* EL6311.cbl
 20997* EXEC CICS DELETEQ TS
 20998*        QUEUE   (QID)
 20999*    END-EXEC.
 21000*    MOVE '*&                    #   #00017544' TO DFHEIV0
 21001     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
 21002     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 21003     MOVE X'2020233030303137353434' TO DFHEIV0(25:11)
 21004     CALL 'kxdfhei1' USING DFHEIV0,
 21005           QID,
 21006           DFHEIV99
 21007     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21008
 21009
 21010     GO TO 6050-EXIT.
 21011
 21012 6050-QID-ERROR.
 21013     MOVE ER-0033                TO EMI-ERROR
 21014     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21015
 21016 6050-EXIT.
 21017      EXIT.
 21018
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 389
* EL6311.cbl
 21020
 21021******************************************************************
 21022*                                                                *
 21023*            T E R M   C O N V E R S I O N                       *
 21024*                                                                *
 21025******************************************************************
 21026
 21027 6100-TERM-CONVERSION.
 21028
 21029     IF PI-BPMTS = ZERO
 21030         GO TO 6199-EXIT.
 21031
 21032     IF PI-BMODE = ' ' OR 'M'
 21033         MOVE PI-BPMTS      TO WS-CALC-TERM-WHOLE
 21034         GO TO 6105-ROUND-TERM.
 21035
 21036     IF PI-BMODE = 'S'
 21037         COMPUTE WS-CALC-TERM = PI-BPMTS / 2
 21038         GO TO 6105-ROUND-TERM.
 21039
 21040     IF PI-BMODE = 'W'
 21041         COMPUTE WS-CALC-TERM = PI-BPMTS / 4.33333
 21042         GO TO 6105-ROUND-TERM.
 21043
 21044     IF PI-BMODE = 'B'
 21045         COMPUTE WS-CALC-TERM = PI-BPMTS / 2.16667
 21046         GO TO 6105-ROUND-TERM.
 21047
 21048     IF PI-BMODE = 'T'
 21049         COMPUTE WS-CALC-TERM = PI-BPMTS / 1.08334.
 21050
 21051 6105-ROUND-TERM.
 21052
 21053     IF WS-CALC-TERM-REMAIN GREATER THAN .00000
 21054         ADD +1                  TO WS-CALC-TERM-WHOLE
 21055         MOVE ZEROS              TO WS-CALC-TERM-REMAIN.
 21056
 21057     IF PI-COMPANY-ID = CLIENT-CRI OR CLIENT-LGX
 21058         GO TO 6125-COMPUTE-TERM-BENEFIT.
 21059
 21060     IF BTERM-LEN (WS-SUB1) NOT GREATER THAN +0
 21061         MOVE WS-CALC-TERM-WHOLE   TO BTERMO      (WS-SUB1)
 21062                                      WS-BTERM    (WS-SUB1)
 21063         MOVE +3                   TO BTERM-LEN   (WS-SUB1).
 21064
 21065     IF BTERM-LEN (WS-SUB1) GREATER THAN +0
 21066         IF WS-BTERM (WS-SUB1)   NOT = WS-CALC-TERM-WHOLE
 21067             MOVE -1               TO BMODEL
 21068             MOVE ER-2593          TO EMI-ERROR
 21069             MOVE AL-UNBON         TO BTERM-ATTRB (WS-SUB1)
 21070             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21071
 21072 6124-CHECK-BENEFIT.
 21073
 21074     IF BBEN-LEN (WS-SUB1) NOT GREATER THAN +0
 21075        GO TO 6126-COMPUTE-BENEFIT.
 21076
 21077     GO TO 6199-EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 390
* EL6311.cbl
 21078
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 391
* EL6311.cbl
 21080******************************************************************
 21081**         COMPUTE TERM AND BENEFIT
 21082******************************************************************
 21083 6125-COMPUTE-TERM-BENEFIT.
 21084
 21085     IF PI-BTYPE (WS-SUB1) = SPACES  OR
 21086        PI-BPMTAMT = ZERO
 21087         GO TO 6199-EXIT.
 21088
 21089     MOVE WS-CALC-TERM-WHOLE     TO  BTERMI    (WS-SUB1)
 21090                                     WS-BTERM  (WS-SUB1).
 21091     MOVE +3                     TO  BTERM-LEN (WS-SUB1).
 21092
 21093 6126-COMPUTE-BENEFIT.
 21094
 21095     IF PI-BMODE = 'M' OR  ' '
 21096         MOVE PI-BPMTAMT        TO  WS-BBEN (WS-SUB1).
 21097
 21098     IF PI-BMODE = 'W'
 21099         COMPUTE WS-BBEN (WS-SUB1) ROUNDED = PI-BPMTAMT * 4.33333.
 21100
 21101     IF PI-BMODE = 'S'
 21102         COMPUTE WS-BBEN (WS-SUB1)  ROUNDED = PI-BPMTAMT * 2.
 21103
 21104     IF PI-BMODE = 'B'
 21105         COMPUTE WS-BBEN (WS-SUB1) ROUNDED = PI-BPMTAMT * 2.16667.
 21106
 21107     IF PI-BMODE = 'T'
 21108         COMPUTE WS-BBEN (WS-SUB1) ROUNDED = PI-BPMTAMT * 1.08334.
 21109
 21110     IF WS-SUB1 = +1
 21111        COMPUTE WS-BBEN (WS-SUB1) =
 21112                WS-BBEN (WS-SUB1) * WS-CALC-TERM.
 21113
 21114     MOVE WS-BBEN (WS-SUB1)           TO BBENO       (WS-SUB1).
 21115     MOVE +12                         TO BBEN-LEN    (WS-SUB1).
 21116     MOVE AL-UNNON                    TO BBEN-ATTRB  (WS-SUB1).
 21117
 21118 6199-EXIT.
 21119     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 392
* EL6311.cbl
 21121
 21122******************************************************************
 21123*                                                                *
 21124*             D I S P L A Y   I S S U E S                        *
 21125*                                                                *
 21126******************************************************************
 21127
 21128 6200-CREATE-VADS.
 21129     MOVE PI-PREV-KEY            TO PI-ERPNDB-KEY
 21130     MOVE  PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY
 21131     MOVE SPACES                 TO WS-PASS-VADS-REC
 21132
 21133* EXEC CICS GETMAIN
 21134*       SET      (ADDRESS OF PENDING-BUSINESS)
 21135*       LENGTH   (ERPNDB-RECORD-LENGTH)
 21136*       INITIMG  (GETMAIN-SPACE)
 21137*       RESP     (WS-RESPONSE)
 21138*    END-EXEC
 21139*    MOVE ',"IL                  $  N#00017670' TO DFHEIV0
 21140     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 21141     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21142     MOVE X'204E233030303137363730' TO DFHEIV0(25:11)
 21143     CALL 'kxdfhei1' USING DFHEIV0,
 21144           DFHEIV20,
 21145           ERPNDB-RECORD-LENGTH,
 21146           GETMAIN-SPACE
 21147     SET ADDRESS OF PENDING-BUSINESS TO
 21148         DFHEIV20
 21149     MOVE EIBRESP  TO WS-RESPONSE
 21150     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21151
 21152* EXEC CICS READ
 21153*       INTO    (PENDING-BUSINESS)
 21154*       DATASET (FILE-ID-ERPNDB)
 21155*       RIDFLD  (ERPNDB-KEY)
 21156*       RESP    (WS-RESPONSE)
 21157*    END-EXEC
 21158     MOVE LENGTH OF
 21159      PENDING-BUSINESS
 21160       TO DFHEIV11
 21161*    MOVE '&"IL       E          (  N#00017676' TO DFHEIV0
 21162     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21163     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21164     MOVE X'204E233030303137363736' TO DFHEIV0(25:11)
 21165     CALL 'kxdfhei1' USING DFHEIV0,
 21166           FILE-ID-ERPNDB,
 21167           PENDING-BUSINESS,
 21168           DFHEIV11,
 21169           ERPNDB-KEY,
 21170           DFHEIV99,
 21171           DFHEIV99,
 21172           DFHEIV99
 21173     MOVE EIBRESP  TO WS-RESPONSE
 21174     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21175     IF RESP-NORMAL
 21176        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
 21177        IF (RESP-NORMAL)
 21178           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 393
* EL6311.cbl
 21179              AM-CONTROL-PRIMARY (1:20))
 21180           MOVE AM-NAME          TO VD-ACCOUNT-NAME
 21181        ELSE
 21182           MOVE 'ACCOUNT NOT FOUND'
 21183                                 TO VD-ACCOUNT-NAME
 21184        END-IF
 21185        MOVE FUNCTION LENGTH(VD-ACCOUNT-NAME)
 21186                                    TO M1
 21187        MOVE VD-ACCOUNT-NAME        TO WS-WORK-FIELD
 21188        PERFORM VARYING A2 FROM +1 BY +1 UNTIL
 21189           (A2 > M1)
 21190           OR (WS-WORK-FIELD (A2:1) = '*')
 21191           OR (WS-WORK-FIELD (A2:4) = ' DBA' OR ' AKA')
 21192           OR (WS-WORK-FIELD (A2:4) = '(DBA' OR '(AKA')
 21193        END-PERFORM
 21194        IF A2 > M1
 21195           CONTINUE
 21196        ELSE
 21197           MOVE WS-WORK-FIELD (1:A2 - 1)
 21198                                    TO VD-ACCOUNT-NAME
 21199        END-IF
 21200        MOVE PB-COMPANY-CD       TO VD-COMPANY-CD
 21201        MOVE PB-CARRIER          TO VD-CARRIER
 21202        MOVE PB-GROUPING         TO VD-GROUPING
 21203        MOVE PB-STATE            TO VD-STATE
 21204        MOVE PB-ACCOUNT          TO VD-ACCOUNT
 21205        MOVE PB-CERT-EFF-DT      TO VD-CERT-EFF-DT
 21206        MOVE PB-CERT-NO          TO VD-CERT-NO
 21207        MOVE PB-I-INSURED-LAST-NAME TO VD-INSURED-LAST-NAME
 21208        MOVE PB-I-INSURED-FIRST-NAME TO VD-INSURED-FIRST-NAME
 21209        MOVE PB-I-INSURED-MIDDLE-INIT TO VD-INSURED-MIDDLE-INIT
 21210        MOVE PB-I-JOINT-LAST-NAME TO VD-JOINT-LAST-NAME
 21211        MOVE PB-I-JOINT-FIRST-NAME TO VD-JOINT-FIRST-NAME
 21212        MOVE PB-I-JOINT-MIDDLE-INIT TO VD-JOINT-MIDDLE-INIT
 21213        MOVE PB-I-BENEFICIARY-NAME TO VD-BENEFICIARY-NAME
 21214        MOVE PB-ENTRY-BATCH      TO VD-ENTRY-BATCH
 21215        MOVE PB-CSR-ID           TO VD-CSR-ID
 21216        MOVE PB-I-LF-BENEFIT-CD  TO VD-LF-BENEFIT-CD
 21217        MOVE PB-I-LF-PREMIUM-AMT TO VD-LF-PREMIUM-AMT
 21218        MOVE PB-I-LF-BENEFIT-AMT TO VD-LF-BENEFIT-AMT
 21219        MOVE PB-I-LF-TERM        TO VD-LF-TERM
 21220        MOVE PB-I-LF-RATE        TO VD-LF-RATE
 21221        MOVE PB-I-AH-BENEFIT-CD  TO VD-AH-BENEFIT-CD
 21222        MOVE PB-I-AH-PREMIUM-AMT TO VD-AH-PREMIUM-AMT
 21223        MOVE PB-I-AH-BENEFIT-AMT TO VD-AH-BENEFIT-AMT
 21224        MOVE PB-I-AH-TERM        TO VD-AH-TERM
 21225        MOVE PB-I-AH-RATE        TO VD-AH-RATE
 21226        MOVE PB-I-LOAN-TERM      TO VD-LOAN-TERM
 21227        MOVE PB-I-LOAN-APR       TO VD-LOAN-APR
 21228        MOVE PB-I-1ST-PMT-DT     TO VD-1ST-PMT-DT
 21229     END-IF
 21230     MOVE PB-CONTROL-PRIMARY     TO  ERPNDM-KEY.
 21231
 21232
 21233* EXEC CICS GETMAIN
 21234*       SET      (ADDRESS OF PENDING-MAILING-DATA)
 21235*       LENGTH   (ERPNDM-RECORD-LENGTH)
 21236*       INITIMG  (GETMAIN-SPACE)
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 394
* EL6311.cbl
 21237*       RESP     (WS-RESPONSE)
 21238*    END-EXEC
 21239*    MOVE ',"IL                  $  N#00017739' TO DFHEIV0
 21240     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 21241     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21242     MOVE X'204E233030303137373339' TO DFHEIV0(25:11)
 21243     CALL 'kxdfhei1' USING DFHEIV0,
 21244           DFHEIV20,
 21245           ERPNDM-RECORD-LENGTH,
 21246           GETMAIN-SPACE
 21247     SET ADDRESS OF PENDING-MAILING-DATA TO
 21248         DFHEIV20
 21249     MOVE EIBRESP  TO WS-RESPONSE
 21250     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21251
 21252
 21253* EXEC CICS READ
 21254*       INTO    (PENDING-MAILING-DATA)
 21255*       DATASET (FILE-ID-ERPNDM)
 21256*       RIDFLD  (ERPNDM-KEY)
 21257*       RESP    (WS-RESPONSE)
 21258*    END-EXEC
 21259     MOVE LENGTH OF
 21260      PENDING-MAILING-DATA
 21261       TO DFHEIV11
 21262*    MOVE '&"IL       E          (  N#00017746' TO DFHEIV0
 21263     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21264     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21265     MOVE X'204E233030303137373436' TO DFHEIV0(25:11)
 21266     CALL 'kxdfhei1' USING DFHEIV0,
 21267           FILE-ID-ERPNDM,
 21268           PENDING-MAILING-DATA,
 21269           DFHEIV11,
 21270           ERPNDM-KEY,
 21271           DFHEIV99,
 21272           DFHEIV99,
 21273           DFHEIV99
 21274     MOVE EIBRESP  TO WS-RESPONSE
 21275     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21276
 21277     IF RESP-NORMAL
 21278        MOVE PM-ADDRESS-LINE-1    TO VD-INSURED-ADDRESS-1
 21279        MOVE PM-ADDRESS-LINE-2    TO VD-INSURED-ADDRESS-2
 21280        MOVE PM-CITY              TO VD-INSURED-CITY
 21281        MOVE PM-STATE             TO VD-INSURED-STATE
 21282        MOVE PM-ZIP               TO VD-INSURED-ZIP-CODE
 21283     END-IF
 21284
 21285     MOVE 'VAC1'                  TO VD-LETTER-ID
 21286     MOVE PI-PROCESSOR-ID         TO VD-PROC-ID
 21287     MOVE PI-COMPANY-ID           TO VD-COMP-ID
 21288     MOVE EIBTIME                 TO VD-CURRENT-TIME
 21289     MOVE WS-CURRENT-BIN-DT       TO VD-CURRENT-DATE
 21290     MOVE +0                      TO VD-ARCHIVE-NO
 21291     MOVE VIRGINIA-DISCLOSURE     TO WS-PASS-VADS-REC
 21292     .
 21293 6200-EXIT.
 21294     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 395
* EL6311.cbl
 21295 6210-READ-ERACCT.
 21296     MOVE PB-CONTROL-BY-ACCOUNT  TO ERACCT-KEY
 21297     MOVE LOW-VALUES             TO ERACCT-FILL
 21298
 21299* EXEC CICS READ
 21300*         DATASET   ('ERACCT')
 21301*         INTO      (ACCOUNT-MASTER)
 21302*         RIDFLD    (ERACCT-KEY)
 21303*         GTEQ
 21304*         RESP      (WS-RESPONSE)
 21305*    END-EXEC
 21306     MOVE LENGTH OF
 21307      ACCOUNT-MASTER
 21308       TO DFHEIV11
 21309     MOVE 'ERACCT' TO DFHEIV1
 21310*    MOVE '&"IL       G          (  N#00017774' TO DFHEIV0
 21311     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 21312     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21313     MOVE X'204E233030303137373734' TO DFHEIV0(25:11)
 21314     CALL 'kxdfhei1' USING DFHEIV0,
 21315           DFHEIV1,
 21316           ACCOUNT-MASTER,
 21317           DFHEIV11,
 21318           ERACCT-KEY,
 21319           DFHEIV99,
 21320           DFHEIV99,
 21321           DFHEIV99
 21322     MOVE EIBRESP  TO WS-RESPONSE
 21323     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21324     .
 21325 6210-EXIT.
 21326     EXIT.
 21327
 21328 6220-READ-ERMAIL.
 21329
 21330     MOVE ELCERT-KEY             TO ERMAIL-KEY
 21331     MOVE ' '                    TO WS-ERMAIL-SW
 21332
 21333
 21334* EXEC CICS READ
 21335*       DATASET   (FILE-ID-ERMAIL)
 21336*       SET       (ADDRESS OF MAILING-DATA)
 21337*       RIDFLD    (ERMAIL-KEY)
 21338*       RESP      (WS-RESPONSE)
 21339*    END-EXEC
 21340*    MOVE '&"S        E          (  N#00017790' TO DFHEIV0
 21341     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 21342     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21343     MOVE X'204E233030303137373930' TO DFHEIV0(25:11)
 21344     CALL 'kxdfhei1' USING DFHEIV0,
 21345           FILE-ID-ERMAIL,
 21346           DFHEIV20,
 21347           DFHEIV99,
 21348           ERMAIL-KEY,
 21349           DFHEIV99,
 21350           DFHEIV99,
 21351           DFHEIV99
 21352     SET ADDRESS OF MAILING-DATA TO
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 396
* EL6311.cbl
 21353         DFHEIV20
 21354     MOVE EIBRESP  TO WS-RESPONSE
 21355     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21356
 21357     IF RESP-NORMAL
 21358        SET ERMAIL-FOUND TO TRUE
 21359     END-IF
 21360     .
 21361 6220-EXIT.
 21362     EXIT.
 21363
 21364 6400-CHECK-FOR-RES-REF-CLAIM.
 21365     display 'made it to 6400- for ' pi-cert-no
 21366     MOVE LOW-VALUES             TO PI-RES-REF-CLM-TYPE
 21367
 21368     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD
 21369                                    W-CL-COMP-CD.
 21370     MOVE PI-CERT-NO             TO MSTR-CERT-NO
 21371                                    W-CL-CERT-NO.
 21372     MOVE SPACES                 TO MSTR-CERT-SFX.
 21373
 21374
 21375* EXEC CICS HANDLE CONDITION
 21376*        NOTFND  (6400-CONTINUE)
 21377*        ENDFILE (6400-CONTINUE)
 21378*    END-EXEC.
 21379*    MOVE '"$I''                  ! X #00017814' TO DFHEIV0
 21380     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21381     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21382     MOVE X'5820233030303137383134' TO DFHEIV0(25:11)
 21383     CALL 'kxdfhei1' USING DFHEIV0
 21384     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21385
 21386
 21387
 21388* EXEC CICS IGNORE CONDITION
 21389*        DUPKEY
 21390*    END-EXEC.
 21391*    MOVE '"*$                   !   #00017819' TO DFHEIV0
 21392     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 21393     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21394     MOVE X'2020233030303137383139' TO DFHEIV0(25:11)
 21395     CALL 'kxdfhei1' USING DFHEIV0
 21396     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21397
 21398
 21399
 21400* EXEC CICS STARTBR
 21401*        DATASET   (CLMS-ID)
 21402*        RIDFLD    (ELMSTR-KEY)
 21403*        GENERIC   EQUAL
 21404*        KEYLENGTH (ELMSTR-LENGTH)
 21405*    END-EXEC.
 21406     MOVE 0
 21407       TO DFHEIV11
 21408*    MOVE '&,   KG    E          &   #00017823' TO DFHEIV0
 21409     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 21410     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 397
* EL6311.cbl
 21411     MOVE X'2020233030303137383233' TO DFHEIV0(25:11)
 21412     CALL 'kxdfhei1' USING DFHEIV0,
 21413           CLMS-ID,
 21414           ELMSTR-KEY,
 21415           ELMSTR-LENGTH,
 21416           DFHEIV11,
 21417           DFHEIV99
 21418     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21419
 21420
 21421     display 'browse started'
 21422     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 21423
 21424 6400-NEXT-CLAIM.
 21425
 21426
 21427* EXEC CICS READNEXT
 21428*        DATASET   (CLMS-ID)
 21429*        RIDFLD    (ELMSTR-KEY)
 21430*        SET       (ADDRESS OF CLAIM-MASTER)
 21431*    END-EXEC.
 21432     MOVE 0
 21433       TO DFHEIV11
 21434*    MOVE '&.S                   )   #00017835' TO DFHEIV0
 21435     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 21436     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21437     MOVE X'2020233030303137383335' TO DFHEIV0(25:11)
 21438     CALL 'kxdfhei1' USING DFHEIV0,
 21439           CLMS-ID,
 21440           DFHEIV20,
 21441           DFHEIV99,
 21442           ELMSTR-KEY,
 21443           DFHEIV99,
 21444           DFHEIV11,
 21445           DFHEIV99,
 21446           DFHEIV99
 21447     SET ADDRESS OF CLAIM-MASTER TO
 21448         DFHEIV20
 21449     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21450
 21451
 21452     display 'read claim for ' mstr-cert-no
 21453     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 21454        MSTR-CERT-PRIME NOT = W-CL-CERT-PRIME
 21455         GO TO 6400-CONTINUE
 21456     END-IF.
 21457
 21458     IF PI-CARRIER     NOT = CL-CARRIER        OR
 21459        PI-GROUPING    NOT = CL-CERT-GROUPING  OR
 21460        PI-STATE       NOT = CL-CERT-STATE     OR
 21461        PI-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 21462        PI-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 21463         GO TO 6400-NEXT-CLAIM
 21464     END-IF.
 21465
 21466     display 'found claim ' cl-claim-no
 21467        ' with denial type ' cl-denial-type
 21468     IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 398
* EL6311.cbl
 21469         MOVE CL-DENIAL-TYPE TO PI-RES-REF-CLM-TYPE
 21470         GO TO 6400-CONTINUE
 21471     END-IF.
 21472
 21473     GO TO 6400-NEXT-CLAIM.
 21474
 21475 6400-CONTINUE.
 21476
 21477     IF WS-BROWSE-STARTED-SW = 'Y'
 21478
 21479* EXEC CICS ENDBR
 21480*            DATASET   (CLMS-ID)
 21481*        END-EXEC
 21482     MOVE 0
 21483       TO DFHEIV11
 21484*    MOVE '&2                    $   #00017867' TO DFHEIV0
 21485     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21486     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21487     MOVE X'2020233030303137383637' TO DFHEIV0(25:11)
 21488     CALL 'kxdfhei1' USING DFHEIV0,
 21489           CLMS-ID,
 21490           DFHEIV11,
 21491           DFHEIV99
 21492     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21493         MOVE 'N' TO WS-BROWSE-STARTED-SW
 21494     END-IF.
 21495
 21496 6400-EXIT.
 21497     EXIT.
 21498
 21499 7000-DISPLAY-ISSUES.
 21500
 21501     IF PI-DISPLAY-ORIGINAL-BATCH
 21502        MOVE PB-CONTROL-BY-ORIG-BATCH TO PI-PREV-KEY
 21503        MOVE ZEROS                    TO PI-PREV-CHG-SEQ-NO
 21504     ELSE
 21505        MOVE PB-CONTROL-PRIMARY      TO PI-PREV-KEY.
 21506
 21507     MOVE PB-CONTROL-PRIMARY         TO PI-PREV-CONTROL-PRIMARY.
 21508
 21509     MOVE 'Y'                        TO WS-DISPLAY-SW.
 21510     MOVE 'Y'                        TO PI-DISPLAY-SCREEN-SW.
 21511
 21512     MOVE LOW-VALUES                 TO EL631BI.
 21513     MOVE ZEROS                      TO PI-BPMTAMT
 21514                                        PI-BPMTS.
 21515     MOVE SPACE                      TO PI-BMODE
 21516                                        PI-BTYPE (1)
 21517                                        PI-BTYPE (2).
 21518     MOVE EL631B                     TO PI-MAP-NAME.
 21519     MOVE 'Y'                        TO PI-BROWSE-SW.
 21520     MOVE PB-BATCH-SEQ-NO            TO BSEQO
 21521                                        PI-HIGH-SEQ-NO.
 21522
 21523     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 21524        MOVE AL-SABOF                TO BCHGTA
 21525        SUBTRACT PB-BATCH-CHG-SEQ-NO FROM 1000 GIVING BCHGO
 21526        MOVE AL-SANON                TO BCHGA
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 399
* EL6311.cbl
 21527     ELSE
 21528        MOVE AL-SADOF                TO BCHGTA
 21529                                        BCHGA
 21530        MOVE PB-CHG-COUNT            TO BCHGO.
 21531
 21532     MOVE PB-LAST-MAINT-BY           TO BMANTBYO.
 21533     MOVE PB-LAST-MAINT-HHMMSS       TO WS-TIME.
 21534     MOVE WS-HR-MINS                 TO BMANTATO.
 21535
 21536     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 21537        MOVE PB-CREDIT-ACCEPT-DT     TO DC-BIN-DATE-1
 21538        MOVE SPACE                   TO DC-OPTION-CODE
 21539        PERFORM 9700-DATE-LINK
 21540        MOVE DC-GREG-DATE-1-EDIT     TO BMANTDTO
 21541        MOVE 'INACTIVE'              TO BMOENDTO
 21542     ELSE
 21543        MOVE PB-LAST-MAINT-DT        TO DC-BIN-DATE-1
 21544        MOVE SPACE                   TO DC-OPTION-CODE
 21545        PERFORM 9700-DATE-LINK
 21546        MOVE DC-GREG-DATE-1-EDIT     TO BMANTDTO
 21547        MOVE PB-CREDIT-SELECT-DT     TO DC-BIN-DATE-1
 21548        MOVE SPACE                   TO DC-OPTION-CODE
 21549        PERFORM 9700-DATE-LINK
 21550        MOVE DC-GREG-DATE-1-EDIT     TO BMOENDTO.
 21551
 21552*    MOVE PB-I-REFERENCE             TO BREFO.
 21553
 21554*    IF PI-COMPANY-ID EQUAL 'HER'
 21555*        MOVE PB-I-MEMBER-NO     TO  WS-MEMBER-NO
 21556*        IF WS-MEMBER-NO-1-8  IS NUMERIC
 21557*            IF WS-MEMBER-NO-1-8  GREATER  ZEROS
 21558*                MOVE WS-MEMBER-NO-1-8
 21559*                                TO  BMICRNOO.
 21560
 21561*    IF PB-I-MICROFILM-NO  IS NUMERIC
 21562*        IF PB-I-MICROFILM-NO  GREATER  ZEROS
 21563*            MOVE PB-I-MICROFILM-NO
 21564*                                TO  BMICRNOO.
 21565     IF PB-I-VIN NOT = SPACES
 21566        MOVE PB-I-VIN            TO BVINO
 21567     END-IF
 21568
 21569     MOVE PB-CERT-PRIME              TO BCERTNOO.
 21570     MOVE PB-CERT-SFX                TO BSUFIXO.
 21571     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 21572     MOVE SPACE                      TO DC-OPTION-CODE.
 21573     PERFORM 9700-DATE-LINK.
 21574     MOVE DC-GREG-DATE-1-EDIT        TO BEFFDTO
 21575
 21576     MOVE PB-I-INSURED-LAST-NAME     TO BLSTNMO.
 21577     MOVE PB-I-INSURED-FIRST-NAME    TO B1STNMO.
 21578     MOVE PB-I-INSURED-MIDDLE-INIT   TO BINITO.
 21579     MOVE PB-I-INSURED-SEX           TO BSEXO
 21580
 21581     IF PB-I-AGE NOT = ZEROS
 21582         MOVE PB-I-AGE               TO BAGEO.
 21583
 21584     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 400
* EL6311.cbl
 21585                                 TO ELCERT-KEY
 21586     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 21587     IF NOT CERT-TRL-REC-NOT-FOUND
 21588         IF CS-INS-AGE-DEFAULT-FLAG = 'Y'
 21589             MOVE 'AGE*'             TO BAGEDEFO
 21590         ELSE
 21591             MOVE 'AGE '             TO BAGEDEFO
 21592         END-IF
 21593     ELSE
 21594         MOVE 'AGE '             TO BAGEDEFO
 21595     END-IF
 21596
 21597     IF PB-I-BIRTHDAY NOT = LOW-VALUES
 21598         MOVE PB-I-BIRTHDAY          TO DC-BIN-DATE-1
 21599         MOVE SPACE                  TO DC-OPTION-CODE
 21600         PERFORM 9700-DATE-LINK
 21601         IF NO-CONVERSION-ERROR
 21602            MOVE DC-GREG-DATE-1-EDIT TO BBIRTHO.
 21603
 21604     IF PB-I-1ST-PMT-DT NOT = LOW-VALUES
 21605         MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-1
 21606         MOVE SPACE                  TO DC-OPTION-CODE
 21607         PERFORM 9700-DATE-LINK
 21608         IF NO-CONVERSION-ERROR
 21609            MOVE DC-GREG-DATE-1-EDIT TO B1STPMTO.
 21610
 21611     IF PB-I-EXTENTION-DAYS NUMERIC
 21612        IF PB-I-EXTENTION-DAYS GREATER THAN ZEROS
 21613           MOVE PB-I-EXTENTION-DAYS  TO BDAYSO
 21614        ELSE
 21615           IF PB-I-TERM-IN-DAYS NUMERIC
 21616              IF PB-I-TERM-IN-DAYS GREATER THAN ZEROS
 21617                 MOVE PB-I-TERM-IN-DAYS TO BDAYSO.
 21618
 21619     IF PB-I-LOAN-TERM GREATER THAN ZEROS
 21620        MOVE PB-I-LOAN-TERM          TO BLNTRMO.
 21621
 21622     MOVE PB-FORCE-CODE              TO BFORCEO.
 21623     MOVE PB-I-TERM-TYPE             TO BMODEO
 21624                                        PI-BMODE.
 21625
 21626     IF PB-I-PAY-FREQUENCY GREATER THAN ZEROS
 21627        MOVE PB-I-PAY-FREQUENCY      TO BFREQO.
 21628
 21629     IF PB-I-NO-OF-PAYMENTS GREATER THAN ZEROS
 21630         MOVE PB-I-NO-OF-PAYMENTS    TO BPMTSO
 21631                                        PI-BPMTS.
 21632
 21633     IF PB-I-PAYMENT-AMOUNT NUMERIC
 21634         IF PB-I-PAYMENT-AMOUNT GREATER THAN ZEROS
 21635           MOVE PB-I-PAYMENT-AMOUNT  TO BPMTAMTO
 21636                                        PI-BPMTAMT.
 21637
 21638     MOVE PB-I-LOAN-OFFICER          TO BLNOFCRO.
 21639     MOVE PB-BATCH-ENTRY             TO BENTRYO.
 21640     MOVE PB-I-UNDERWRITING-STATUS   TO BUNWRITO.
 21641     MOVE PB-I-SKIP-CODE             TO BSKPCDO.
 21642     MOVE PB-I-INDV-GRP-CD           TO BINDGRPO.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 401
* EL6311.cbl
 21643     MOVE PB-I-SIG-SW                TO BSIGO.
 21644     MOVE PB-I-RATE-CLASS-OVRD       TO BRTCLSO.
 21645     MOVE PB-I-SPECIAL-REIN-CODE     TO BREINO.
 21646     MOVE PB-RECORD-BILL             TO BBILCDO.
 21647     MOVE PB-FORCE-CODE              TO BFORCEO.
 21648
 21649     IF (PB-I-LIVES NUMERIC)
 21650        AND (PB-I-LIVES > ZEROS)
 21651        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
 21652        IF (RESP-NORMAL)
 21653           AND (AM-DCC-PRODUCT-CODE = 'DDF')
 21654           CONTINUE
 21655        ELSE
 21656           MOVE PB-I-LIVES       TO BLIVESO
 21657        END-IF
 21658     END-IF
 21659
 21660     IF PB-I-NUM-BILLED NUMERIC AND
 21661        PB-I-NUM-BILLED GREATER THAN ZEROS
 21662        MOVE PB-I-NUM-BILLED         TO BBILLEDO.
 21663*    ELSE
 21664*       MOVE ZEROS                   TO BBILLEDO.
 21665
 21666     MOVE PB-CHG-COUNT               TO BCHGCNTO.
 21667
 21668     IF PB-I-LOAN-APR NOT = ZEROS
 21669        MOVE PB-I-LOAN-APR           TO BAPRO.
 21670
 21671     IF PB-I-MEMBER-NO  GREATER THAN SPACES
 21672        MOVE PB-I-MEMBER-NO          TO BMEMBERO.
 21673
 21674     IF PB-ORIGINAL-ENTRY-BATCH NOT = SPACES
 21675        IF PB-ORIGINAL-ENTRY-BATCH NOT = PB-ENTRY-BATCH
 21676           MOVE AL-SANOF                TO BORIGHDA
 21677           MOVE PB-ORIGINAL-ENTRY-BATCH TO BORGNOO
 21678           MOVE PB-ORIGINAL-SEQ-NO      TO BORGSEQO.
 21679
 21680     MOVE PI-LIFE-OVERRIDE-L2        TO BKIND (1).
 21681
 21682     IF PB-I-LF-CRIT-PER GREATER THAN ZEROS
 21683        MOVE PB-I-LF-CRIT-PER        TO BCRIT-PERDO (1).
 21684
 21685     IF PB-I-LF-INPUT-CD GREATER THAN SPACES
 21686        MOVE PB-I-LF-INPUT-CD        TO BTYPE (1)
 21687                                        PI-BTYPE (1).
 21688
 21689     IF PB-I-LF-TERM     GREATER THAN ZEROS
 21690        MOVE PB-I-LF-TERM            TO BTERMO (1).
 21691
 21692     IF PB-I-LF-BENEFIT-AMT GREATER THAN ZEROS
 21693        MOVE PB-I-LF-BENEFIT-AMT     TO BBENO  (1).
 21694
 21695     IF PB-I-LF-ALT-BENEFIT-AMT GREATER THAN ZEROS
 21696        MOVE PB-I-LF-ALT-BENEFIT-AMT TO BALT-BENO   (1).
 21697
 21698     IF PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
 21699        MOVE PB-I-LF-PREMIUM-AMT     TO BPREMO      (1).
 21700
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 402
* EL6311.cbl
 21701     IF PB-I-LF-ALT-PREMIUM-AMT GREATER THAN ZEROS
 21702        MOVE PB-I-LF-ALT-PREMIUM-AMT TO BALT-PREMO  (1).
 21703
 21704     IF PB-I-LF-EXPIRE-DT NOT = LOW-VALUES
 21705         MOVE PB-I-LF-EXPIRE-DT      TO DC-BIN-DATE-1
 21706         MOVE SPACE                  TO DC-OPTION-CODE
 21707         PERFORM 9700-DATE-LINK
 21708         IF NO-CONVERSION-ERROR
 21709            MOVE DC-GREG-DATE-1-EDIT TO BEXPIRE   (1).
 21710
 21711     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 21712        MOVE PB-I-LF-BENEFIT-CD      TO BBEN-CD     (1)
 21713        MOVE PB-I-LF-ABBR            TO BBEN-ABBR   (1)
 21714        MOVE PB-I-LF-PREM-CALC       TO BCPREMO     (1)
 21715        SUBTRACT PB-I-LF-PREMIUM-AMT FROM PB-I-LF-PREM-CALC
 21716                 GIVING BDIFFO (1)
 21717     ELSE
 21718        MOVE SPACES                  TO BBEN-CD     (1)
 21719                                        BBEN-ABBR   (1).
 21720
 21721     IF PB-I-LF-ALT-PREMIUM-AMT GREATER THAN ZEROS
 21722        MOVE PB-I-LF-ALT-PREM-CALC   TO BCALT-PREM  (1)
 21723        SUBTRACT PB-I-LF-ALT-PREMIUM-AMT FROM
 21724                 PB-I-LF-ALT-PREM-CALC   GIVING BDALT-PREM (1).
 21725
 21726     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 21727       IF PB-RECORD-ON-HOLD
 21728          MOVE 'ON HOLD'           TO BBILL-LIT     (1).
 21729
 21730     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 21731       IF PB-RECORD-RETURNED
 21732          MOVE 'RETURNED'          TO BBILL-LIT     (1).
 21733
 21734     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 21735        AND (PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH)
 21736             MOVE 'OVERRIDE'          TO BBILL-LIT  (1).
 21737
 21738     MOVE PI-AH-OVERRIDE-L2          TO BKIND       (2).
 21739
 21740     IF PB-I-AH-CRIT-PER GREATER THAN ZEROS
 21741        MOVE PB-I-AH-CRIT-PER        TO BCRIT-PERDO (2).
 21742
 21743     IF PB-I-AH-INPUT-CD GREATER THAN SPACES
 21744        MOVE PB-I-AH-INPUT-CD        TO BTYPE       (2)
 21745                                        PI-BTYPE (2).
 21746
 21747     IF PB-I-AH-TERM     GREATER THAN ZEROS
 21748        MOVE PB-I-AH-TERM            TO BTERMO      (2).
 21749
 21750     IF PB-I-AH-BENEFIT-AMT GREATER THAN ZEROS
 21751        MOVE PB-I-AH-BENEFIT-AMT     TO BBENO       (2).
 21752
 21753     IF PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 21754        MOVE PB-I-AH-PREMIUM-AMT     TO BPREMO      (2).
 21755
 21756     IF PB-I-TOT-FEES NOT NUMERIC
 21757        MOVE ZEROS               TO PB-I-TOT-FEES
 21758     END-IF
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 403
* EL6311.cbl
 21759     IF PB-I-TOT-FEES > ZEROS
 21760        MOVE PB-I-TOT-FEES       TO BALT-PREMO  (2).
 21761
 21762     IF PB-I-AH-EXPIRE-DT NOT = LOW-VALUES
 21763         MOVE PB-I-AH-EXPIRE-DT      TO DC-BIN-DATE-1
 21764         MOVE SPACE                  TO DC-OPTION-CODE
 21765         PERFORM 9700-DATE-LINK
 21766         IF NO-CONVERSION-ERROR
 21767            MOVE DC-GREG-DATE-1-EDIT TO BEXPIRE       (2).
 21768
 21769     IF PB-I-TOT-FEES > ZEROS
 21770        MOVE PB-I-TOT-FEES-CALC      TO BCALT-PREM  (2)
 21771        SUBTRACT PB-I-TOT-FEES FROM
 21772                 PB-I-TOT-FEES-CALC GIVING BDALT-PREM (2).
 21773
 21774     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 21775        MOVE PB-I-AH-BENEFIT-CD      TO BBEN-CD     (2)
 21776        MOVE PB-I-AH-ABBR            TO BBEN-ABBR   (2)
 21777        MOVE PB-I-AH-PREM-CALC       TO BCPREMO     (2)
 21778        SUBTRACT PB-I-AH-PREMIUM-AMT FROM PB-I-AH-PREM-CALC
 21779                 GIVING BDIFFO (2)
 21780     ELSE
 21781        MOVE SPACES                  TO BBEN-CD     (2)
 21782                                        BBEN-ABBR   (2).
 21783
 21784     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 21785       IF PB-RECORD-ON-HOLD
 21786          MOVE 'ON HOLD'           TO BBILL-LIT     (2).
 21787
 21788     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 21789       IF PB-RECORD-RETURNED
 21790          MOVE 'RETURNED'          TO BBILL-LIT     (2).
 21791
 21792     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 21793        AND (PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH)
 21794             MOVE 'OVERRIDE'          TO BBILL-LIT  (2).
 21795
 21796     MOVE PB-CSR-ID                  TO BCSRO.
 21797
 21798     IF PI-COMPANY-ID  =  'DMD'
 21799        IF (EC-NEW-CERT = SPACES OR LOW-VALUES)
 21800            NEXT SENTENCE
 21801        ELSE
 21802            IF (PB-CERT-NO  NOT =  EC-NEW-CERT)
 21803               MOVE 'NEW CERT'       TO BNCERTLI
 21804               MOVE EC-NEW-CERT      TO BNCERTO.
 21805
 21806     IF PI-COMPANY-ID  =  'DMD'
 21807        IF (EC-NEW-STATE = LOW-VALUES OR SPACES)
 21808            NEXT SENTENCE
 21809        ELSE
 21810           IF (PB-SV-STATE  NOT =  EC-NEW-STATE)
 21811               MOVE 'NEW STATE'      TO BNSTATLI
 21812               MOVE EC-NEW-STATE     TO BNSTATO.
 21813
 21814 7000-CONTINUE.
 21815     MOVE 'C'                        TO BMAINTI.
 21816     MOVE AL-UANON                   TO BMAINTA.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 404
* EL6311.cbl
 21817
 21818     IF PB-BATCH-CHG-SEQ-NO = ZEROS
 21819        PERFORM 7300-FORMAT-ERRORS THRU 7399-EXIT.
 21820
 21821     IF PI-6315-FINALIZED = 'Y'   AND
 21822        PB-UNFORCED-ERRORS
 21823          MOVE -1                TO BFORCEL
 21824          MOVE  1                TO SET-CURSOR-SW
 21825     END-IF
 21826
 21827     IF NO-CURSOR-SET
 21828        MOVE -1                      TO BMAINTL.
 21829
 21830     GO TO 8100-SEND-INITIAL-MAP.
 21831
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 405
* EL6311.cbl
 21833
 21834******************************************************************
 21835*                                                                *
 21836*             D I S P L A Y   C A N C E L S                      *
 21837*                                                                *
 21838******************************************************************
 21839
 21840 7100-DISPLAY-CANCELS.
 21841     IF PI-DISPLAY-ORIGINAL-BATCH
 21842        MOVE PB-CONTROL-BY-ORIG-BATCH TO PI-PREV-KEY
 21843        MOVE ZEROS                    TO PI-PREV-CHG-SEQ-NO
 21844     ELSE
 21845        MOVE PB-CONTROL-PRIMARY      TO PI-PREV-KEY.
 21846
 21847     MOVE PB-CONTROL-PRIMARY         TO PI-PREV-CONTROL-PRIMARY.
 21848
 21849     MOVE 'Y'                        TO WS-DISPLAY-SW.
 21850     MOVE 'Y'                        TO PI-DISPLAY-SCREEN-SW.
 21851
 21852     MOVE LOW-VALUES                 TO EL631CI.
 21853     MOVE EL631C                     TO PI-MAP-NAME.
 21854     MOVE 'Y'                        TO PI-BROWSE-SW.
 21855     MOVE PB-BATCH-SEQ-NO            TO CSEQO
 21856                                        PI-HIGH-SEQ-NO.
 21857
 21858     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 21859        MOVE AL-SABOF                TO CCHGTA
 21860        SUBTRACT PB-BATCH-CHG-SEQ-NO FROM 1000 GIVING CCHGO
 21861        MOVE AL-SANON                TO CCHGA
 21862      ELSE
 21863        MOVE AL-SADOF                TO CCHGTA
 21864                                        CCHGA
 21865        MOVE PB-CHG-COUNT            TO CCHGCNTO.
 21866
 21867*    MOVE PB-C-REFERENCE             TO CREFO.
 21868
 21869*    IF PB-C-MICROFILM-NO IS NUMERIC
 21870*       IF PB-C-MICROFILM-NO  NOT = ZEROS
 21871*          MOVE PB-C-MICROFILM-NO
 21872*                                TO CMICRNOO
 21873*          MOVE AL-UNNON         TO CMICRNOA
 21874*       END-IF
 21875*    END-IF
 21876     IF PB-C-NH-INT-ON-REFS NUMERIC
 21877        IF PB-C-NH-INT-ON-REFS NOT = ZEROS
 21878           MOVE PB-C-NH-INT-ON-REFS
 21879                                 TO CNHINTO
 21880           MOVE AL-SANOF         TO CNHINTA
 21881        END-IF
 21882     END-IF
 21883     MOVE PB-CERT-PRIME              TO CCERTNOO.
 21884     MOVE PB-CERT-SFX                TO CSUFIXO.
 21885     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 21886     MOVE SPACE                      TO DC-OPTION-CODE.
 21887     PERFORM 9700-DATE-LINK.
 21888     MOVE DC-GREG-DATE-1-EDIT        TO CEFFDTO.
 21889
 21890     IF PB-C-LF-CANCEL-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 406
* EL6311.cbl
 21891        MOVE PB-C-LF-CANCEL-DT       TO DC-BIN-DATE-1
 21892        MOVE SPACE                   TO DC-OPTION-CODE
 21893        PERFORM 9700-DATE-LINK
 21894        IF NO-CONVERSION-ERROR
 21895           MOVE DC-GREG-DATE-1-EDIT  TO CCANDT1O.
 21896
 21897     IF PB-C-LF-REFUND-OVERRIDE EQUAL SPACES
 21898        NEXT SENTENCE
 21899     ELSE
 21900        MOVE PB-C-LF-REFUND-OVERRIDE TO CMTHD1I.
 21901
 21902     IF PB-C-AH-REFUND-OVERRIDE EQUAL SPACES
 21903        NEXT SENTENCE
 21904     ELSE
 21905        MOVE PB-C-AH-REFUND-OVERRIDE TO CMTHD2I.
 21906
 21907     IF PB-C-AH-CANCEL-DT   NOT = LOW-VALUES
 21908        MOVE PB-C-AH-CANCEL-DT       TO DC-BIN-DATE-1
 21909        MOVE SPACE                   TO DC-OPTION-CODE
 21910        PERFORM 9700-DATE-LINK
 21911        IF NO-CONVERSION-ERROR
 21912           MOVE DC-GREG-DATE-1-EDIT  TO CCANDT2O.
 21913
 21914     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 21915         MOVE PB-C-LF-CANCEL-AMT     TO CREFND1O.
 21916
 21917     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 21918         MOVE PB-C-AH-CANCEL-AMT     TO CREFND2O.
 21919
 21920     IF PB-C-LF-CANCEL-DT NOT = LOW-VALUES
 21921        MOVE PB-C-LF-REF-CALC        TO CCRFND1O
 21922        SUBTRACT PB-C-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC
 21923                 GIVING CDRFND1O.
 21924
 21925     IF PB-C-AH-CANCEL-DT NOT = LOW-VALUES
 21926        MOVE PB-C-AH-REF-CALC        TO CCRFND2O
 21927        SUBTRACT PB-C-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC
 21928                 GIVING CDRFND2O.
 21929
 21930     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 21931       IF PB-RECORD-ON-HOLD
 21932          MOVE 'ON HOLD'             TO CBILIT1O.
 21933
 21934     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 21935       IF PB-RECORD-RETURNED
 21936          MOVE 'RETURNED'            TO CBILIT1O.
 21937
 21938     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 21939        AND (PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH)
 21940             MOVE 'OVERRIDE'         TO CBILIT1O.
 21941
 21942     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 21943       IF PB-RECORD-ON-HOLD
 21944          MOVE 'ON HOLD'             TO CBILIT2O.
 21945
 21946     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 21947       IF PB-RECORD-RETURNED
 21948          MOVE 'RETURNED'            TO CBILIT2O.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 407
* EL6311.cbl
 21949
 21950     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 21951        AND (PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH)
 21952             MOVE 'OVERRIDE'         TO CBILIT2O.
 21953
 21954     MOVE PB-C-LAST-NAME             TO CLSTNMO.
 21955     MOVE PB-C-CANCEL-REASON         TO CCANREAO
 21956     IF PB-C-POST-CARD-IND = 'Y'
 21957        MOVE 'Y'                     TO CPCYNO
 21958     ELSE
 21959        MOVE 'N'                     TO CPCYNO
 21960     END-IF
 21961     MOVE PB-FORCE-CODE              TO CFORCEO.
 21962     MOVE PB-RECORD-BILL             TO CBILCDO.
 21963     MOVE PB-CI-LAST-NAME            TO CINAMEO.
 21964     MOVE SPACES                     TO CINITSO.
 21965     IF PB-CI-FIRST-NAME GREATER THAN SPACES
 21966         MOVE PB-CI-FIRST-NAME       TO CINITSO
 21967     ELSE
 21968         MOVE PB-CI-INITIALS         TO CINITSO
 21969     END-IF.
 21970
 21971     IF PB-CI-CANCEL-FEE NUMERIC
 21972        MOVE PB-CI-CANCEL-FEE        TO W-CANCEL-FEE-LONG
 21973        MOVE W-CANCEL-FEE-LONG       TO W-CANCEL-FEE
 21974     ELSE
 21975        MOVE ZEROES                  TO W-CANCEL-FEE.
 21976
 21977     MOVE W-CANCEL-FEE               TO CCANFEEO.
 21978
 21979     IF PB-CI-LF-PREMIUM-AMT NOT = ZEROS
 21980        ADD PB-CI-LF-PREMIUM-AMT
 21981             PB-CI-LF-ALT-PREMIUM-AMT  GIVING  CPREM1O.
 21982
 21983     IF PB-CI-AH-PREMIUM-AMT NOT = ZEROS
 21984        MOVE PB-CI-AH-PREMIUM-AMT       TO CPREM2O.
 21985
 21986     MOVE PB-CI-LF-TERM              TO CTERM1O.
 21987     MOVE PB-C-LF-REM-TERM           TO CRTERM1O.
 21988     MOVE PB-CI-AH-TERM              TO CTERM2O.
 21989     MOVE PB-C-AH-REM-TERM           TO CRTERM2O.
 21990
 21991     IF PB-C-LIVES NUMERIC
 21992        MOVE PB-C-LIVES              TO CLIVESO.
 21993
 21994     IF PB-C-PAYEE-CODE GREATER THAN SPACES
 21995        MOVE PB-C-PAYEE-CODE         TO CPAYEEO.
 21996
 21997     IF PB-CI-ENTRY-DT NOT = LOW-VALUES
 21998        MOVE PB-CI-ENTRY-DT          TO DC-BIN-DATE-1
 21999        MOVE SPACE                   TO DC-OPTION-CODE
 22000        PERFORM 9700-DATE-LINK
 22001        IF NO-CONVERSION-ERROR
 22002           MOVE DC-GREG-DATE-1-EDIT  TO CENTRDTO.
 22003
 22004     IF  PB-C-REFUND-CREATED
 22005         MOVE 'YES'                  TO CRFNDSWO
 22006     ELSE
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 408
* EL6311.cbl
 22007         IF PB-C-REFUND-REQUESTED
 22008            MOVE 'REQ'               TO CRFNDSWO
 22009         ELSE
 22010            MOVE 'NO'                TO CRFNDSWO.
 22011
 22012     MOVE PB-INPUT-DT                TO DC-BIN-DATE-1.
 22013     MOVE SPACE                      TO DC-OPTION-CODE.
 22014     PERFORM 9700-DATE-LINK.
 22015     MOVE DC-GREG-DATE-1-EDIT        TO CENTDTO.
 22016     MOVE PB-INPUT-BY                TO CENTBYO.
 22017
 22018     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 22019        MOVE PB-CREDIT-ACCEPT-DT     TO DC-BIN-DATE-1
 22020        MOVE SPACE                   TO DC-OPTION-CODE
 22021        PERFORM 9700-DATE-LINK
 22022        MOVE DC-GREG-DATE-1-EDIT     TO CMANTDTO
 22023        MOVE 'INACTIVE'              TO CMOENDTO
 22024     ELSE
 22025        MOVE PB-LAST-MAINT-DT        TO DC-BIN-DATE-1
 22026        MOVE SPACE                   TO DC-OPTION-CODE
 22027        PERFORM 9700-DATE-LINK
 22028        MOVE DC-GREG-DATE-1-EDIT     TO CMANTDTO
 22029        MOVE PB-CREDIT-SELECT-DT     TO DC-BIN-DATE-1
 22030        MOVE SPACE                   TO DC-OPTION-CODE
 22031        PERFORM 9700-DATE-LINK
 22032        MOVE DC-GREG-DATE-1-EDIT     TO CMOENDTO.
 22033
 22034     MOVE PB-LAST-MAINT-BY           TO CMANTBYO.
 22035
 22036     MOVE PB-LAST-MAINT-HHMMSS       TO WS-TIME.
 22037     MOVE WS-HR-MINS                 TO CMANTATO.
 22038
 22039     EVALUATE PB-LF-REFUND-TYPE
 22040        WHEN '1'
 22041           MOVE 'RULE78'            TO CLFREFNO
 22042        WHEN '2'
 22043           MOVE 'PRORAT'            TO CLFREFNO
 22044        WHEN '3'
 22045           MOVE 'CALIF'             TO CLFREFNO
 22046        WHEN '4'
 22047           MOVE 'IRREG'             TO CLFREFNO
 22048        WHEN '5'
 22049           MOVE 'NETPAY'            TO CLFREFNO
 22050        WHEN '6'
 22051           MOVE 'ATCP'              TO CLFREFNO
 22052        WHEN '7'
 22053           MOVE 'UTAH'              TO CLFREFNO
 22054        WHEN '8'
 22055           MOVE 'MEAN'              TO CLFREFNO
 22056        WHEN '9'
 22057           MOVE 'SUM '              TO CLFREFNO
 22058        WHEN 'B'
 22059           MOVE 'BALN'              TO CLFREFNO
 22060     END-EVALUATE.
 22061
 22062     EVALUATE TRUE
 22063        WHEN PB-AH-REFUND-TYPE =  '1'
 22064           MOVE 'RULE78'            TO CAHREFNO
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 409
* EL6311.cbl
 22065        WHEN PB-AH-REFUND-TYPE =  '2'
 22066           MOVE 'PRORAT'            TO CAHREFNO
 22067        WHEN PB-AH-REFUND-TYPE =  ('3' OR 'S')
 22068           MOVE 'CALIF'             TO CAHREFNO
 22069        WHEN PB-AH-REFUND-TYPE =  '4'
 22070           MOVE 'IRREG'             TO CAHREFNO
 22071        WHEN PB-AH-REFUND-TYPE =  '5'
 22072           MOVE 'NETPAY'            TO CAHREFNO
 22073        WHEN PB-AH-REFUND-TYPE =  '6'
 22074           MOVE 'ATCP'              TO CAHREFNO
 22075        WHEN PB-AH-REFUND-TYPE =  '7'
 22076           MOVE 'UTAH'              TO CAHREFNO
 22077        WHEN PB-AH-REFUND-TYPE =  '8'
 22078           MOVE 'MEAN'              TO CAHREFNO
 22079        WHEN PB-AH-REFUND-TYPE =  '9'
 22080           MOVE 'SUM '              TO CAHREFNO
 22081        WHEN PB-AH-REFUND-TYPE =  'B'
 22082           MOVE 'BALN'              TO CAHREFNO
 22083     END-EVALUATE.
 22084
 22085     MOVE PB-REIN-CD                 TO CREINCDO.
 22086
 22087     IF PB-ACCT-EFF-DT NOT = LOW-VALUES AND SPACES
 22088        MOVE PB-ACCT-EFF-DT          TO DC-BIN-DATE-1
 22089        MOVE SPACE                   TO DC-OPTION-CODE
 22090        PERFORM 9700-DATE-LINK
 22091        IF NO-CONVERSION-ERROR
 22092           MOVE DC-GREG-DATE-1-EDIT  TO CAEFFDTO.
 22093
 22094     IF PB-ACCT-EXP-DT  = HIGH-VALUES
 22095        MOVE 999999                  TO WS-EXP-DT-EDIT
 22096        INSPECT WS-EXP-DT-EDIT CONVERTING SPACES TO '/'
 22097        MOVE WS-EXP-DT-EDIT          TO CAEXPDTO
 22098     ELSE
 22099        IF PB-ACCT-EXP-DT NOT = LOW-VALUES
 22100           MOVE PB-ACCT-EXP-DT          TO DC-BIN-DATE-1
 22101           MOVE SPACE                   TO DC-OPTION-CODE
 22102           PERFORM 9700-DATE-LINK
 22103           IF NO-CONVERSION-ERROR
 22104              MOVE DC-GREG-DATE-1-EDIT  TO CAEXPDTO.
 22105
 22106     IF PB-ORIGINAL-ENTRY-BATCH NOT = SPACES
 22107        IF PB-ORIGINAL-ENTRY-BATCH NOT = PB-ENTRY-BATCH
 22108           MOVE AL-SANOF                TO CORIGHDA
 22109           MOVE PB-ORIGINAL-ENTRY-BATCH TO CORGNOO
 22110           MOVE PB-ORIGINAL-SEQ-NO      TO CORGSEQO.
 22111
 22112     MOVE PB-CSR-ID              TO CCSRO.
 22113
 22114     MOVE PB-CI-LIFE-COMMISSION  TO COMMLFO.
 22115     MOVE PB-CI-AH-COMMISSION    TO COMMAHO.
 22116
 22117     MOVE 'C'                    TO CMAINTI.
 22118     MOVE AL-UANON               TO CMAINTA.
 22119
 22120     IF PI-6316-FINALIZED = 'Y'  AND
 22121        PB-UNFORCED-ERRORS
 22122          MOVE -1                TO CFORCEL
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 410
* EL6311.cbl
 22123          MOVE  1                TO SET-CURSOR-SW
 22124     END-IF
 22125
 22126     IF PB-BATCH-CHG-SEQ-NO = ZEROS
 22127        PERFORM 7300-FORMAT-ERRORS THRU 7399-EXIT.
 22128
 22129     IF NO-CURSOR-SET
 22130        MOVE -1                  TO CMAINTL.
 22131
 22132     GO TO 8100-SEND-INITIAL-MAP.
 22133
 22134
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 411
* EL6311.cbl
 22136***************************************************************
 22137*     ROUTINE THAT MOVES ALL DATA FROM THE BATCH TOTAL        *
 22138*     RECORD TO THE BATCH TOTAL SCREEN.                       *
 22139***************************************************************
 22140
 22141 7200-DISPLAY-BATCHES.
 22142     MOVE EL631D                 TO PI-MAP-NAME.
 22143     MOVE LOW-VALUES             TO EL631DI.
 22144
 22145     MOVE 'Y'                    TO WS-DISPLAY-SW.
 22146
 22147
 22148* EXEC CICS HANDLE CONDITION
 22149*         NOTFND   (3690-NOT-FOUND)
 22150*    END-EXEC.
 22151*    MOVE '"$I                   ! Y #00018524' TO DFHEIV0
 22152     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 22153     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22154     MOVE X'5920233030303138353234' TO DFHEIV0(25:11)
 22155     CALL 'kxdfhei1' USING DFHEIV0
 22156     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22157
 22158
 22159     IF PI-DISPLAY-SCREEN
 22160        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 22161     ELSE
 22162        MOVE PB-CONTROL-PRIMARY  TO ERPNDB-KEY.
 22163
 22164     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 22165     MOVE +0                     TO ERPNDB-BATCH-CHG-SEQ-NO.
 22166
 22167
 22168* EXEC CICS READ
 22169*         DATASET   (FILE-ID-ERPNDB)
 22170*         RIDFLD    (ERPNDB-KEY)
 22171*         SET       (ADDRESS OF PENDING-BUSINESS)
 22172*    END-EXEC.
 22173*    MOVE '&"S        E          (   #00018536' TO DFHEIV0
 22174     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 22175     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22176     MOVE X'2020233030303138353336' TO DFHEIV0(25:11)
 22177     CALL 'kxdfhei1' USING DFHEIV0,
 22178           FILE-ID-ERPNDB,
 22179           DFHEIV20,
 22180           DFHEIV99,
 22181           ERPNDB-KEY,
 22182           DFHEIV99,
 22183           DFHEIV99,
 22184           DFHEIV99
 22185     SET ADDRESS OF PENDING-BUSINESS TO
 22186         DFHEIV20
 22187     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22188
 22189
 22190     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 22191     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 22192     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 22193     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 412
* EL6311.cbl
 22194     MOVE PB-SV-STATE            TO PI-SV-STATE.
 22195
 22196     MOVE EL631D                 TO PI-MAP-NAME.
 22197     MOVE LOW-VALUES             TO EL631DI.
 22198     MOVE PB-ENTRY-BATCH         TO DBATCHO.
 22199
 22200*    IF PI-AR-PROCESSING
 22201*       MOVE PB-REFERENCE        TO DREFO.
 22202
 22203     MOVE PB-CSR-ID              TO DCSRO.
 22204
 22205     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 22206        MOVE PB-CREDIT-ACCEPT-DT TO DC-BIN-DATE-1
 22207        MOVE SPACE               TO DC-OPTION-CODE
 22208        PERFORM 9700-DATE-LINK
 22209        MOVE DC-GREG-DATE-1-EDIT TO DMAINDTO
 22210        MOVE AL-SABOF            TO DLDATEA  DMAINDTA
 22211        MOVE 'INACTIVE'          TO DLDATEO
 22212     ELSE
 22213        MOVE PB-LAST-MAINT-DT    TO DC-BIN-DATE-1
 22214        MOVE SPACE               TO DC-OPTION-CODE
 22215        PERFORM 9700-DATE-LINK
 22216        MOVE DC-GREG-DATE-1-EDIT TO DMAINDTO.
 22217
 22218     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.
 22219     MOVE SPACE                  TO DC-OPTION-CODE.
 22220     PERFORM 9700-DATE-LINK.
 22221     MOVE DC-GREG-DATE-1-EDIT    TO DINPUTO.
 22222
 22223     IF PB-B-RECEIVED-DT = SPACES OR LOW-VALUES
 22224        MOVE DC-GREG-DATE-1-EDIT TO DRECVDTO
 22225     ELSE
 22226        MOVE PB-B-RECEIVED-DT    TO DC-BIN-DATE-1
 22227        MOVE SPACE               TO DC-OPTION-CODE
 22228        PERFORM 9700-DATE-LINK
 22229        MOVE DC-GREG-DATE-1-EDIT TO DRECVDTO.
 22230
 22231     MOVE PB-CREDIT-SELECT-DT    TO DC-BIN-DATE-1.
 22232     MOVE SPACE                  TO DC-OPTION-CODE.
 22233     PERFORM 9700-DATE-LINK.
 22234     MOVE DC-GREG-DATE-1-EDIT        TO DPROCDTO.
 22235
 22236     MOVE PB-B-ISSUE-CNT-REMITTED    TO DRISSO.
 22237     MOVE PB-B-ISSUE-CNT-ENTERED     TO DEISSO.
 22238
 22239     IF PB-B-ISSUE-CNT-REMITTED NOT = PB-B-ISSUE-CNT-ENTERED
 22240        SUBTRACT PB-B-ISSUE-CNT-ENTERED FROM
 22241                 PB-B-ISSUE-CNT-REMITTED GIVING DOISSO.
 22242
 22243     MOVE PB-B-LF-ISS-PRM-REMITTED   TO DRLFPRMO.
 22244     MOVE PB-B-LF-ISS-PRM-ENTERED    TO DELFPRMO.
 22245     MOVE PB-B-LF-ISS-PRM-COMPUTED   TO DCLFPRMO.
 22246
 22247     IF PB-B-LF-ISS-PRM-ENTERED NOT = PB-B-LF-ISS-PRM-REMITTED
 22248        SUBTRACT PB-B-LF-ISS-PRM-ENTERED FROM
 22249                 PB-B-LF-ISS-PRM-REMITTED  GIVING DOLFPRMO.
 22250
 22251     MOVE PB-B-AH-ISS-PRM-REMITTED   TO DRAHPRMO.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 413
* EL6311.cbl
 22252     MOVE PB-B-AH-ISS-PRM-ENTERED    TO DEAHPRMO.
 22253     MOVE PB-B-AH-ISS-PRM-COMPUTED   TO DCAHPRMO.
 22254
 22255     IF PB-B-AH-ISS-PRM-ENTERED NOT = PB-B-AH-ISS-PRM-REMITTED
 22256        SUBTRACT PB-B-AH-ISS-PRM-ENTERED FROM
 22257                 PB-B-AH-ISS-PRM-REMITTED  GIVING DOAHPRMO.
 22258
 22259     MOVE PB-B-CANCEL-CNT-REMITTED     TO DRCANCO.
 22260     MOVE PB-B-CANCEL-CNT-ENTERED      TO DECANCO.
 22261
 22262     IF PB-B-CANCEL-CNT-REMITTED NOT = PB-B-CANCEL-CNT-ENTERED
 22263        SUBTRACT PB-B-CANCEL-CNT-ENTERED FROM
 22264                 PB-B-CANCEL-CNT-REMITTED GIVING DOCANCO.
 22265
 22266     MOVE PB-B-LF-CAN-PRM-REMITTED   TO DRLFRFDO.
 22267     MOVE PB-B-LF-CAN-PRM-ENTERED    TO DELFRFDO.
 22268     MOVE PB-B-LF-CAN-PRM-COMPUTED   TO DCLFRFDO.
 22269
 22270     IF PB-B-LF-CAN-PRM-ENTERED NOT = PB-B-LF-CAN-PRM-REMITTED
 22271        SUBTRACT PB-B-LF-CAN-PRM-ENTERED FROM
 22272                 PB-B-LF-CAN-PRM-REMITTED  GIVING DOLFRFDO.
 22273
 22274     MOVE PB-B-AH-CAN-PRM-REMITTED   TO DRAHRFDO.
 22275     MOVE PB-B-AH-CAN-PRM-ENTERED    TO DEAHRFDO.
 22276     MOVE PB-B-AH-CAN-PRM-COMPUTED   TO DCAHRFDO.
 22277
 22278     IF PB-B-AH-CAN-PRM-ENTERED NOT = PB-B-AH-CAN-PRM-REMITTED
 22279        SUBTRACT PB-B-AH-CAN-PRM-ENTERED FROM
 22280                 PB-B-AH-CAN-PRM-REMITTED  GIVING DOAHRFDO.
 22281
 22282     MOVE -1                     TO DPFENTRL.
 22283     GO TO 8100-SEND-INITIAL-MAP.
 22284
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 414
* EL6311.cbl
 22286
 22287***************************************************************
 22288*     THIS ROUTINE DETERMINES IF EL050 ENCOUNTERED ANY        *
 22289*     ERRORS.  IF ERRORS WERE DETECTED, THE ONLINE ERROR      *
 22290*     PROCESSING ROUTINE IS CALLED TO FORMAT THE ERROR        *
 22291*     MESSAGES AND ACCUMULATE TOTALS FOR THE DIFFERENT        *
 22292*     SEVERITY LEVELS. THE SEVERITY FLAGS WITHIN THE RECORDS  *
 22293*     ARE THEN SET ACCORDINGLY.                               *
 22294*         ERROR NUMBERS FOR THE STANDARD ERRORS START AT 2600 *
 22295*         ERROR NUMBERS FOR ISSUE TRANSACTIONS  START AT 2625 *
 22296*         ERROR NUMBERS FOR CANCEL TRANSACTIONS START AT 2725 *
 22297***************************************************************
 22298
 22299******************************************************************
 22300*                                                                *
 22301*            E R R O R   A N A L Y S I S                         *
 22302*                                                                *
 22303******************************************************************
 22304
 22305******************************************************************
 22306*                                                                *
 22307*   THIS ROUTINE DETERMINES IF EL050 (EDIT PROGRAM) ENCOUNTERED  *
 22308*   ANY ERRORS.  IF ERRORS WERE DETECTED, THE ROUTINE READS THE  *
 22309*   ERROR FILE TO DETERMINE THE SEVERITY OF THE ERRORS.  ONCE    *
 22310*   THE SEVERITY OF ERRORS IS ESTABLISHED THE APPROPRIATE ERROR  *
 22311*   FLAGS ARE SET (FORCIBLE, UNFORCIBLE, WARNING, ETC.).         *
 22312*                                                                *
 22313*   IF ANY UNFORCED OR FATAL ERRORS, OR RECORD IS RETURNED       *
 22314*   OR PLACED ON HOLD UPDATE THE CERTIFICATE ACCORDINGLY.        *
 22315*                                                                *
 22316******************************************************************
 22317
 22318 7300-FORMAT-ERRORS.
 22319     MOVE ' '                    TO PI-ERRORS-SW
 22320     IF PB-COMMON-ERRORS = LOW-VALUES
 22321        IF PB-FATAL-ERRORS
 22322           MOVE ER-2695          TO EMI-ERROR
 22323           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22324           GO TO 7399-EXIT.
 22325
 22326     MOVE +0                     TO WS-SUB4.
 22327
 22328 7310-ERROR-LOOP.
 22329
 22330     ADD +1                      TO WS-SUB4.
 22331
 22332     IF WS-SUB4 GREATER THAN PB-NO-OF-ERRORS
 22333        GO TO 7350-SET-ERROR-FLAGS.
 22334
 22335     IF PI-COMPANY-ID = 'UCL'
 22336         IF PB-COMMON-ERROR (WS-SUB4) = ER-2799
 22337             MOVE WS-CERT-EFF-DT        TO DC-BIN-DATE-1
 22338             MOVE ' '                   TO DC-OPTION-CODE
 22339             PERFORM 9700-DATE-LINK
 22340             MOVE DC-GREG-DATE-1-MDY    TO EMI-AH-OVERRIDE-L6.
 22341
 22342     MOVE PB-COMMON-ERROR (WS-SUB4) TO EMI-ERROR.
 22343     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 415
* EL6311.cbl
 22344     PERFORM 7400-SET-ATTRIBUTES THRU 7499-EXIT.
 22345
 22346     GO TO 7310-ERROR-LOOP.
 22347
 22348
 22349 7350-SET-ERROR-FLAGS.
 22350
 22351     IF EMI-FATAL-CTR NOT = ZEROS
 22352        display 'fatal error counter = ' emi-fatal-ctr
 22353        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 22354        MOVE 'X'                 TO PB-FATAL-FLAG
 22355                                    PI-ERRORS-SW
 22356        GO TO 7355-SET-ERROR-FLAGS.
 22357
 22358     IF EMI-FORCABLE-CTR NOT = ZEROS
 22359        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 22360        IF PB-ISSUE
 22361           IF PB-ISSUE-FORCE
 22362              MOVE 'F'           TO PB-FORCE-ER-CD
 22363              MOVE ER-2600       TO EMI-ERROR
 22364              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22365             ELSE
 22366              MOVE 'X'           TO PB-FORCE-ER-CD
 22367*                                   PI-ERRORS-SW
 22368          ELSE
 22369           IF PB-CANCEL-FORCE OR PB-ALL-CANCEL-FORCED-NO-FEE
 22370              MOVE 'F'           TO PB-FORCE-ER-CD
 22371              MOVE ER-2600       TO EMI-ERROR
 22372              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22373             ELSE
 22374              MOVE 'X'           TO PB-FORCE-ER-CD.
 22375*                                   PI-ERRORS-SW.
 22376
 22377     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ERENDT-KEY (1:33)
 22378     IF PB-ISSUE
 22379         MOVE 'I'                TO ENDT-RECORD-TYPE
 22380     ELSE
 22381         MOVE 'C'                TO ENDT-RECORD-TYPE
 22382     END-IF
 22383     MOVE +0                     TO ENDT-SEQ-NO
 22384
 22385
 22386* EXEC CICS READ
 22387*        DATASET   (FILE-ID-ERENDT)
 22388*        SET       (ADDRESS OF ENDORSEMENT-RECORD)
 22389*        RIDFLD    (ERENDT-KEY)
 22390*        RESP      (WS-RESPONSE)
 22391*        GTEQ
 22392*    END-EXEC
 22393*    MOVE '&"S        G          (  N#00018737' TO DFHEIV0
 22394     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 22395     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22396     MOVE X'204E233030303138373337' TO DFHEIV0(25:11)
 22397     CALL 'kxdfhei1' USING DFHEIV0,
 22398           FILE-ID-ERENDT,
 22399           DFHEIV20,
 22400           DFHEIV99,
 22401           ERENDT-KEY,
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 416
* EL6311.cbl
 22402           DFHEIV99,
 22403           DFHEIV99,
 22404           DFHEIV99
 22405     SET ADDRESS OF ENDORSEMENT-RECORD TO
 22406         DFHEIV20
 22407     MOVE EIBRESP  TO WS-RESPONSE
 22408     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22409
 22410     IF RESP-NORMAL
 22411        AND (EN-CONTROL-PRIMARY (1:34) = ERENDT-KEY (1:34))
 22412        IF EN-BATCH-NUMBER = PB-ENTRY-BATCH
 22413            MOVE ER-0280          TO EMI-ERROR
 22414            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22415            MOVE EN-ARCHIVE-NO    TO ARCH-SUPPRESS
 22416            EVALUATE TRUE
 22417              WHEN EMI-ERROR-NUMBER (1) EQUAL ER-0280
 22418                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (1)
 22419              WHEN EMI-ERROR-NUMBER (2) EQUAL ER-0280
 22420                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (2)
 22421              WHEN EMI-ERROR-NUMBER (3) EQUAL ER-0280
 22422                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (3)
 22423            END-EVALUATE
 22424        END-IF
 22425     END-IF
 22426
 22427
 22428
 22429     IF FIRST-ENTRY OR
 22430        EIBAID = DFHPF1 OR DFHPF2
 22431        MOVE '0'                TO PI-EDIT-SW
 22432        GO TO 7399-EXIT.
 22433
 22434 7355-SET-ERROR-FLAGS.
 22435
 22436     IF EMI-WARNING-CTR NOT = ZEROS
 22437        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 22438        MOVE 'W'                 TO PB-WARN-ER-CD.
 22439
 22440     IF PB-UNFORCED-ERRORS OR
 22441        PB-FATAL-ERRORS    OR
 22442        PB-RECORD-ON-HOLD  OR
 22443        PB-RECORD-RETURNED OR
 22444        PB-CANCELLATION
 22445          NEXT SENTENCE
 22446        ELSE
 22447          GO TO 7399-EXIT.
 22448
 22449
 22450* EXEC CICS  HANDLE CONDITION
 22451*           NOTFND   (7399-EXIT)
 22452*    END-EXEC.
 22453*    MOVE '"$I                   ! Z #00018784' TO DFHEIV0
 22454     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 22455     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22456     MOVE X'5A20233030303138373834' TO DFHEIV0(25:11)
 22457     CALL 'kxdfhei1' USING DFHEIV0
 22458     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22459
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 417
* EL6311.cbl
 22460
 22461     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 22462     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 22463     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 22464     MOVE PB-SV-STATE            TO ELCERT-STATE.
 22465
 22466
 22467* EXEC CICS READ
 22468*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 22469*        DATASET (FILE-ID-ELCERT)
 22470*        RIDFLD  (ELCERT-KEY)
 22471*        UPDATE
 22472*    END-EXEC.
 22473*    MOVE '&"S        EU         (   #00018793' TO DFHEIV0
 22474     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 22475     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 22476     MOVE X'2020233030303138373933' TO DFHEIV0(25:11)
 22477     CALL 'kxdfhei1' USING DFHEIV0,
 22478           FILE-ID-ELCERT,
 22479           DFHEIV20,
 22480           DFHEIV99,
 22481           ELCERT-KEY,
 22482           DFHEIV99,
 22483           DFHEIV99,
 22484           DFHEIV99
 22485     SET ADDRESS OF CERTIFICATE-MASTER TO
 22486         DFHEIV20
 22487     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22488
 22489
 22490
 22491     MOVE CM-CREDIT-INTERFACE-SW-1         TO WS-SW-1
 22492     MOVE CM-CREDIT-INTERFACE-SW-2         TO WS-SW-2
 22493
 22494     IF (CERT-ADDED-BATCH OR CERT-PURGED-OFFLINE) AND PB-ISSUE
 22495        GO TO 7360-REWRITE-CERT-MASTER.
 22496
 22497     IF PB-ISSUE
 22498        IF PB-RECORD-RETURNED
 22499            MOVE '4'  TO CM-CREDIT-INTERFACE-SW-1
 22500            GO TO 7360-REWRITE-CERT-MASTER
 22501        ELSE
 22502            MOVE '2' TO CM-CREDIT-INTERFACE-SW-1
 22503            GO TO 7360-REWRITE-CERT-MASTER.
 22504
 22505     IF PB-RECORD-RETURNED
 22506         MOVE '7'      TO CM-CREDIT-INTERFACE-SW-2
 22507         GO TO 7360-REWRITE-CERT-MASTER.
 22508
 22509     IF PB-C-LF-CANCEL-VOIDED
 22510        IF (PB-UNFORCED-ERRORS OR
 22511            PB-FATAL-ERRORS    OR
 22512            PB-RECORD-ON-HOLD)
 22513            MOVE '6'             TO CM-CREDIT-INTERFACE-SW-2
 22514            GO TO 7360-REWRITE-CERT-MASTER
 22515        ELSE
 22516            MOVE '5'             TO CM-CREDIT-INTERFACE-SW-2
 22517            GO TO 7360-REWRITE-CERT-MASTER.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 418
* EL6311.cbl
 22518
 22519     IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS
 22520                            OR PB-RECORD-ON-HOLD)
 22521        MOVE '4'                 TO CM-CREDIT-INTERFACE-SW-2
 22522     ELSE
 22523        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.
 22524
 22525 7360-REWRITE-CERT-MASTER.
 22526
 22527     IF WS-SW-1 = CM-CREDIT-INTERFACE-SW-1 AND
 22528        WS-SW-2 = CM-CREDIT-INTERFACE-SW-2
 22529
 22530* EXEC CICS UNLOCK
 22531*            DATASET    (FILE-ID-ELCERT)
 22532*       END-EXEC
 22533*    MOVE '&*                    #   #00018839' TO DFHEIV0
 22534     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 22535     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 22536     MOVE X'2020233030303138383339' TO DFHEIV0(25:11)
 22537     CALL 'kxdfhei1' USING DFHEIV0,
 22538           FILE-ID-ELCERT,
 22539           DFHEIV99
 22540     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22541        GO TO 7399-EXIT.
 22542
 22543
 22544* EXEC CICS REWRITE
 22545*         DATASET    (FILE-ID-ELCERT)
 22546*         FROM       (CERTIFICATE-MASTER)
 22547*    END-EXEC.
 22548     MOVE LENGTH OF
 22549      CERTIFICATE-MASTER
 22550       TO DFHEIV11
 22551*    MOVE '&& L                  %   #00018844' TO DFHEIV0
 22552     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 22553     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 22554     MOVE X'2020233030303138383434' TO DFHEIV0(25:11)
 22555     CALL 'kxdfhei1' USING DFHEIV0,
 22556           FILE-ID-ELCERT,
 22557           CERTIFICATE-MASTER,
 22558           DFHEIV11,
 22559           DFHEIV99
 22560     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22561
 22562
 22563 7399-EXIT.
 22564      EXIT.
 22565
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 419
* EL6311.cbl
 22567
 22568*************************************************************
 22569*                                                           *
 22570*              S E T   A T T R I B U T E S                  *
 22571*                                                           *
 22572*************************************************************
 22573
 22574 7400-SET-ATTRIBUTES.
 22575
 22576     IF WS-SUB4 GREATER THAN PB-NO-OF-ERRORS
 22577        GO TO 7499-EXIT.
 22578
 22579**2601**
 22580
 22581     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2601
 22582        IF PB-ISSUE
 22583           MOVE AL-UABON         TO BEFFDTA
 22584           GO TO 7499-EXIT
 22585         ELSE
 22586           MOVE AL-UABON         TO CEFFDTA
 22587           GO TO 7499-EXIT.
 22588
 22589**2604**
 22590
 22591     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2604
 22592        IF PB-ISSUE
 22593           MOVE AL-UABON         TO BTYPE1A
 22594           MOVE -1               TO BTYPE1L
 22595           MOVE  1               TO SET-CURSOR-SW
 22596           GO TO 7499-EXIT.
 22597
 22598**2605**
 22599
 22600     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2605
 22601        IF PB-ISSUE
 22602           MOVE AL-UABON         TO BTYPE2A
 22603           MOVE -1               TO BTYPE2L
 22604           MOVE  1               TO SET-CURSOR-SW
 22605           GO TO 7499-EXIT.
 22606
 22607**2606**
 22608
 22609     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2606
 22610        IF PB-ISSUE
 22611           MOVE AL-UABON         TO BSIGA
 22612           MOVE -1               TO BSIGL
 22613           MOVE  1               TO SET-CURSOR-SW
 22614           GO TO 7499-EXIT.
 22615
 22616**2607**
 22617
 22618     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2607
 22619        IF PB-ISSUE
 22620           MOVE AL-UABON         TO BSIGA
 22621           MOVE -1               TO BSIGL
 22622           MOVE  1               TO SET-CURSOR-SW
 22623           GO TO 7499-EXIT.
 22624
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 420
* EL6311.cbl
 22625**2615**
 22626
 22627     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2607
 22628        IF PB-ISSUE
 22629           MOVE AL-UABOF         TO BREINA
 22630           MOVE -1               TO BREINL
 22631           GO TO 7499-EXIT.
 22632
 22633**2622**
 22634
 22635     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2622
 22636        IF PB-ISSUE
 22637           MOVE AL-UABON         TO BEFFDTA
 22638           GO TO 7499-EXIT
 22639        ELSE
 22640           MOVE AL-UABON         TO CEFFDTA
 22641           GO TO 7499-EXIT.
 22642
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 421
* EL6311.cbl
 22644
 22645*************************************************************
 22646*                                                           *
 22647*              I S S U E   E R R O R S                      *
 22648*                                                           *
 22649*************************************************************
 22650
 22651 7420-ISSUE-ERRORS.
 22652
 22653**2626**
 22654
 22655     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2626
 22656        MOVE AL-UABON            TO BCERTNOA
 22657        GO TO 7499-EXIT.
 22658
 22659**2627**
 22660
 22661     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2627
 22662        MOVE AL-UNBON            TO BAGEA
 22663        MOVE -1                  TO BAGEL
 22664        MOVE  1                  TO SET-CURSOR-SW
 22665        GO TO 7499-EXIT.
 22666
 22667**2628**
 22668
 22669     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2628
 22670        MOVE AL-UNBON            TO BAGEA
 22671        MOVE -1                  TO BAGEL
 22672        MOVE  1                  TO SET-CURSOR-SW
 22673        GO TO 7499-EXIT.
 22674
 22675**2629**
 22676
 22677     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2629
 22678        MOVE AL-UABON            TO BSEXA
 22679        MOVE -1                  TO BSEXL
 22680        MOVE  1                  TO SET-CURSOR-SW
 22681        GO TO 7499-EXIT.
 22682
 22683**2630**
 22684
 22685     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2630
 22686        MOVE -1                  TO BTYPE1L
 22687        MOVE  1                  TO SET-CURSOR-SW
 22688        GO TO 7499-EXIT.
 22689
 22690**2631**
 22691
 22692     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2631
 22693        MOVE -1                  TO BTYPE1L
 22694        MOVE  1                  TO SET-CURSOR-SW
 22695        GO TO 7499-EXIT.
 22696
 22697**2632**
 22698
 22699     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2632
 22700        MOVE AL-UNBON            TO BBEN1A
 22701        MOVE -1                  TO BBEN1L
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 422
* EL6311.cbl
 22702        MOVE  1                  TO SET-CURSOR-SW
 22703        GO TO 7499-EXIT.
 22704
 22705**2633**
 22706
 22707     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2633
 22708        MOVE AL-UNBON            TO BPREM1A
 22709        MOVE -1                  TO BPREM1L
 22710        MOVE  1                  TO SET-CURSOR-SW
 22711        GO TO 7499-EXIT.
 22712
 22713**2634**
 22714
 22715     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2634
 22716        MOVE -1                  TO BTYPE2L
 22717        MOVE  1                  TO SET-CURSOR-SW
 22718        GO TO 7499-EXIT.
 22719
 22720**2635**
 22721
 22722     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2635
 22723        MOVE AL-UNBON            TO BBEN2A
 22724        MOVE -1                  TO BBEN2L
 22725        MOVE  1                  TO SET-CURSOR-SW
 22726        GO TO 7499-EXIT.
 22727
 22728**2636**
 22729
 22730     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2636
 22731        MOVE AL-UNBON            TO BPREM2A
 22732        MOVE -1                  TO BPREM2L
 22733        MOVE  1                  TO SET-CURSOR-SW
 22734        GO TO 7499-EXIT.
 22735
 22736**2639**
 22737
 22738     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2639
 22739        MOVE AL-UNBON            TO BBEN1A
 22740        MOVE -1                  TO BBEN1L
 22741        MOVE  1                  TO SET-CURSOR-SW
 22742        GO TO 7499-EXIT.
 22743
 22744**2640**
 22745
 22746     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2640
 22747        MOVE AL-UNBON            TO BBEN2A
 22748        MOVE -1                  TO BBEN2L
 22749        MOVE  1                  TO SET-CURSOR-SW
 22750        GO TO 7499-EXIT.
 22751
 22752**2647**
 22753
 22754     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2647
 22755        MOVE AL-UNBON            TO BTERM1A
 22756        MOVE -1                  TO BTERM1L
 22757        MOVE  1                  TO SET-CURSOR-SW
 22758        GO TO 7499-EXIT.
 22759
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 423
* EL6311.cbl
 22760**2648**
 22761
 22762     IF PB-COMMON-ERROR (WS-SUB4) = ER-2648 OR ER-1575
 22763        MOVE AL-UNBON            TO BLNTRMA
 22764        MOVE -1                  TO BLNTRML
 22765        MOVE  1                  TO SET-CURSOR-SW
 22766        GO TO 7499-EXIT.
 22767
 22768**2649**
 22769
 22770     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2649
 22771        AND PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
 22772            MOVE AL-UNBON            TO BPREM1A
 22773            MOVE -1                  TO BPREM1L
 22774            MOVE  1                  TO SET-CURSOR-SW
 22775            GO TO 7499-EXIT
 22776     ELSE
 22777        IF PB-COMMON-ERROR    (WS-SUB4) = ER-2649
 22778           AND PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 22779            MOVE AL-UNBON            TO BPREM2A
 22780            MOVE -1                  TO BPREM2L
 22781            MOVE  1                  TO SET-CURSOR-SW
 22782            GO TO 7499-EXIT.
 22783
 22784**2650**
 22785
 22786     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2650
 22787        IF  PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
 22788            MOVE AL-UNBON        TO BPREM1A
 22789            MOVE -1              TO BPREM1L
 22790            MOVE  1              TO SET-CURSOR-SW
 22791            IF  PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 22792                MOVE AL-UNBON        TO BPREM2A
 22793                MOVE -1              TO BPREM2L
 22794                MOVE  1              TO SET-CURSOR-SW
 22795                GO TO 7499-EXIT
 22796            ELSE
 22797                GO TO 7499-EXIT
 22798        ELSE
 22799            IF  PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 22800                MOVE AL-UNBON        TO BPREM2A
 22801                MOVE -1              TO BPREM2L
 22802                MOVE  1              TO SET-CURSOR-SW
 22803                GO TO 7499-EXIT
 22804            ELSE
 22805                GO TO 7499-EXIT.
 22806
 22807**2651**
 22808
 22809     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2650
 22810        MOVE AL-UABON            TO BSIGA
 22811        MOVE -1                  TO BSIGL
 22812        MOVE  1                  TO SET-CURSOR-SW
 22813        GO TO 7499-EXIT.
 22814
 22815**2653**
 22816
 22817     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2653
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 424
* EL6311.cbl
 22818        MOVE AL-UABON            TO BFREQA
 22819        MOVE -1                  TO BFREQL
 22820        MOVE  1                  TO SET-CURSOR-SW
 22821        GO TO 7499-EXIT.
 22822
 22823**2654**
 22824
 22825     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2654
 22826        MOVE AL-UABON            TO BFREQA
 22827        MOVE -1                  TO BFREQL
 22828        MOVE  1                  TO SET-CURSOR-SW
 22829        GO TO 7499-EXIT.
 22830
 22831**2655**
 22832
 22833     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2655
 22834        MOVE AL-UABON            TO BFREQA
 22835        MOVE -1                  TO BFREQL
 22836        MOVE  1                  TO SET-CURSOR-SW
 22837        GO TO 7499-EXIT.
 22838
 22839**2656**
 22840
 22841     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2656
 22842        MOVE AL-UNBON            TO BAPRA
 22843        MOVE -1                  TO BAPRL
 22844        MOVE  1                  TO SET-CURSOR-SW
 22845        GO TO 7499-EXIT.
 22846
 22847**2657**
 22848
 22849     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2657
 22850        MOVE AL-UNBON            TO BAPRA
 22851        MOVE -1                  TO BAPRL
 22852        MOVE  1                  TO SET-CURSOR-SW
 22853        GO TO 7499-EXIT.
 22854
 22855**2658**
 22856
 22857     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2657
 22858        MOVE AL-UNBON            TO BTERM2A
 22859        MOVE -1                  TO BTERM2L
 22860        MOVE  1                  TO SET-CURSOR-SW
 22861        GO TO 7499-EXIT.
 22862
 22863**2660**
 22864
 22865     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2660
 22866        MOVE AL-UABON            TO BLSTNMA B1STNMA BINITA
 22867        MOVE -1                  TO BLSTNML
 22868        MOVE  1                  TO SET-CURSOR-SW
 22869        GO TO 7499-EXIT.
 22870
 22871
 22872**2662**
 22873
 22874     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2662
 22875        MOVE AL-UNBON            TO BAGEA
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 425
* EL6311.cbl
 22876        MOVE -1                  TO BAGEL
 22877        MOVE  1                  TO SET-CURSOR-SW
 22878        GO TO 7499-EXIT.
 22879
 22880**2663**
 22881
 22882     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2663
 22883        MOVE AL-UNBON            TO BAGEA
 22884        MOVE -1                  TO BAGEL
 22885        MOVE  1                  TO SET-CURSOR-SW
 22886        GO TO 7499-EXIT.
 22887
 22888**2664**
 22889
 22890     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2664
 22891        MOVE AL-UABON            TO BREINA
 22892        MOVE -1                  TO BREINL
 22893        MOVE  1                  TO SET-CURSOR-SW
 22894        GO TO 7499-EXIT.
 22895
 22896**2667**
 22897
 22898     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2667
 22899        MOVE AL-UNBON            TO BBEN2A
 22900        MOVE -1                  TO BBEN2L
 22901        MOVE  1                  TO SET-CURSOR-SW
 22902        GO TO 7499-EXIT.
 22903
 22904**2668**
 22905
 22906     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2668
 22907        MOVE AL-UABON            TO BEFFDTA
 22908        GO TO 7499-EXIT.
 22909
 22910**2669**
 22911
 22912     IF PB-COMMON-ERROR (WS-SUB4) = ER-2669 OR ER-1570
 22913       OR ER-2077 OR ER-2628 OR ER-2661 OR ER-3054 OR ER-3504
 22914       OR ER-3513 OR ER-7144 OR ER-9063 OR ER-9076 OR ER-9618
 22915        MOVE AL-UNBON            TO BAGEA
 22916        MOVE -1                  TO BAGEL
 22917        MOVE  1                  TO SET-CURSOR-SW
 22918        GO TO 7499-EXIT.
 22919
 22920**2670**
 22921
 22922     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2670
 22923        MOVE AL-UABON            TO BFORCEA
 22924        MOVE -1                  TO BFORCEL
 22925        MOVE  1                  TO SET-CURSOR-SW
 22926        GO TO 7499-EXIT.
 22927
 22928**2671**
 22929
 22930     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2671
 22931        MOVE AL-UABON            TO BEFFDTA
 22932        GO TO 7499-EXIT.
 22933
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 426
* EL6311.cbl
 22934**2672**
 22935
 22936     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2672
 22937        MOVE AL-UABON            TO BEFFDTA
 22938        GO TO 7499-EXIT.
 22939
 22940**2673**
 22941
 22942     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2673
 22943        MOVE AL-UABON            TO BEFFDTA
 22944        GO TO 7499-EXIT.
 22945
 22946**2674**
 22947
 22948     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2673
 22949        MOVE AL-UABON            TO BTYPE1A BTYPE2A
 22950        MOVE -1                  TO BTYPE1L
 22951        MOVE  1                  TO SET-CURSOR-SW
 22952        GO TO 7499-EXIT.
 22953
 22954**2677**
 22955
 22956     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2677
 22957        MOVE AL-UNBON            TO BTERM1A
 22958        MOVE -1                  TO BTERM1L
 22959        MOVE  1                  TO SET-CURSOR-SW
 22960        GO TO 7499-EXIT.
 22961
 22962**2678**
 22963
 22964     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2678
 22965        MOVE AL-UNBON            TO BTERM2A
 22966        MOVE -1                  TO BTERM2L
 22967        MOVE  1                  TO SET-CURSOR-SW
 22968        GO TO 7499-EXIT.
 22969
 22970**2679**
 22971
 22972     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2679
 22973        MOVE AL-UABON            TO BTYPE1A
 22974        MOVE -1                  TO BTYPE1L
 22975        MOVE  1                  TO SET-CURSOR-SW
 22976        GO TO 7499-EXIT.
 22977
 22978**2680**
 22979
 22980     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2680
 22981        MOVE AL-UABOF            TO B1STPMTA
 22982        MOVE -1                  TO B1STPMTL
 22983        MOVE  1                  TO SET-CURSOR-SW
 22984        GO TO 7499-EXIT.
 22985
 22986**2681**
 22987
 22988     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2681
 22989        MOVE AL-UABON            TO BDAYSA
 22990        MOVE -1                  TO BDAYSL
 22991        MOVE  1                  TO SET-CURSOR-SW
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 427
* EL6311.cbl
 22992        GO TO 7499-EXIT.
 22993
 22994**2682**
 22995
 22996     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2682
 22997        MOVE AL-UABON            TO BTERM1A
 22998        MOVE -1                  TO BTERM1L
 22999        MOVE  1                  TO SET-CURSOR-SW
 23000        GO TO 7499-EXIT.
 23001
 23002**2683**
 23003
 23004     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2683
 23005        MOVE AL-UABON            TO BSKPCDA
 23006        MOVE -1                  TO BSKPCDL
 23007        MOVE  1                  TO SET-CURSOR-SW
 23008        GO TO 7499-EXIT.
 23009
 23010**2684**
 23011
 23012     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2684
 23013        MOVE AL-UABON            TO BTYPE2A
 23014        MOVE -1                  TO BTYPE2L
 23015        MOVE  1                  TO SET-CURSOR-SW
 23016        GO TO 7499-EXIT.
 23017
 23018**2686**
 23019
 23020     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2686
 23021        MOVE AL-UABON            TO BTYPE2A
 23022        MOVE -1                  TO BTYPE2L
 23023        MOVE  1                  TO SET-CURSOR-SW
 23024        GO TO 7499-EXIT.
 23025
 23026**2689**
 23027
 23028     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2689
 23029        MOVE AL-UABON            TO BSIGA
 23030        MOVE -1                  TO BSIGL
 23031        MOVE  1                  TO SET-CURSOR-SW
 23032        GO TO 7499-EXIT.
 23033
 23034**2690**
 23035
 23036     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2690
 23037        MOVE AL-UABOF            TO BLNOFCRA
 23038        MOVE -1                  TO BLNOFCRL
 23039        MOVE  1                  TO SET-CURSOR-SW
 23040        GO TO 7499-EXIT.
 23041
 23042**2693**
 23043
 23044     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2693
 23045        MOVE AL-UABOF            TO BLNOFCRA
 23046        MOVE AL-UNBON            TO BBEN1A
 23047        MOVE -1                  TO BBEN1L
 23048        MOVE  1                  TO SET-CURSOR-SW
 23049        GO TO 7499-EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 428
* EL6311.cbl
 23050
 23051**2720**
 23052
 23053     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2720
 23054        MOVE AL-UNBON            TO BBEN1A
 23055        MOVE -1                  TO BBEN1L
 23056        MOVE  1                  TO SET-CURSOR-SW
 23057        GO TO 7499-EXIT.
 23058
 23059**2709**
 23060
 23061*    IF PB-COMMON-ERROR    (WS-SUB4) = ER-2709
 23062*       MOVE AL-UNBON            TO BBEN1A
 23063*       MOVE -1                  TO BBEN1L
 23064*       MOVE  1                  TO SET-CURSOR-SW
 23065*       GO TO 7499-EXIT.
 23066
 23067*************************************************************
 23068*                                                           *
 23069*            C A N C E L   E R R O R S                      *
 23070*                                                           *
 23071*************************************************************
 23072
 23073**2726**
 23074
 23075     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2726
 23076        MOVE AL-UABON            TO CCERTNOA
 23077        GO TO 7499-EXIT.
 23078
 23079**2728**
 23080
 23081     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2728
 23082        MOVE AL-UABON            TO CCERTNOA
 23083        GO TO 7499-EXIT.
 23084
 23085**2729**
 23086
 23087     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2729
 23088        MOVE AL-UABON            TO CCERTNOA
 23089        GO TO 7499-EXIT.
 23090
 23091**2730**
 23092
 23093     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2729
 23094        MOVE AL-UABON            TO CCERTNOA
 23095        GO TO 7499-EXIT.
 23096
 23097**2731**
 23098
 23099     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2731
 23100        MOVE AL-UABON            TO CCANDT1A
 23101        MOVE -1                  TO CCANDT1L
 23102        MOVE  1                  TO SET-CURSOR-SW
 23103        GO TO 7499-EXIT.
 23104
 23105**2732**
 23106
 23107     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2732
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 429
* EL6311.cbl
 23108        MOVE AL-UABON            TO CCANDT1A
 23109        MOVE -1                  TO CCANDT1L
 23110        MOVE  1                  TO SET-CURSOR-SW
 23111        GO TO 7499-EXIT.
 23112
 23113**2733**
 23114
 23115     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2733
 23116        MOVE AL-UABON            TO CCANDT1A
 23117        MOVE -1                  TO CCANDT1L
 23118        MOVE  1                  TO SET-CURSOR-SW
 23119        GO TO 7499-EXIT.
 23120
 23121**2734**
 23122
 23123     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2733
 23124        MOVE AL-UNBON            TO CREFND1A
 23125        MOVE -1                  TO CREFND1L
 23126        MOVE  1                  TO SET-CURSOR-SW
 23127        GO TO 7499-EXIT.
 23128
 23129**2735**
 23130
 23131     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2735
 23132        MOVE AL-UABON            TO CCANDT2A
 23133        MOVE -1                  TO CCANDT2L
 23134        MOVE  1                  TO SET-CURSOR-SW
 23135        GO TO 7499-EXIT.
 23136
 23137**2736**
 23138
 23139     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2735
 23140        IF  PB-C-LF-CANCEL-AMT GREATER THAN ZEROS
 23141            MOVE AL-UNBON        TO CREFND1A
 23142            MOVE -1              TO CREFND1L
 23143            MOVE  1              TO SET-CURSOR-SW
 23144            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 23145                MOVE AL-UNBON        TO CREFND2A
 23146                MOVE -1              TO CREFND2L
 23147                MOVE  1              TO SET-CURSOR-SW
 23148                GO TO 7499-EXIT
 23149            ELSE
 23150                GO TO 7499-EXIT
 23151        ELSE
 23152            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 23153                MOVE AL-UNBON        TO CREFND2A
 23154                MOVE -1              TO CREFND2L
 23155                MOVE  1              TO SET-CURSOR-SW
 23156                GO TO 7499-EXIT
 23157            ELSE
 23158                GO TO 7499-EXIT.
 23159
 23160**2738**
 23161
 23162     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 23163        MOVE -1                  TO CREFND2L
 23164        MOVE  1                  TO SET-CURSOR-SW
 23165        GO TO 7499-EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 430
* EL6311.cbl
 23166
 23167**2739**
 23168
 23169     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 23170        MOVE -1                  TO CREFND1L
 23171        MOVE  1                  TO SET-CURSOR-SW
 23172        GO TO 7499-EXIT.
 23173
 23174**2741**
 23175
 23176     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 23177        MOVE -1                  TO CREFND1L
 23178        MOVE  1                  TO SET-CURSOR-SW
 23179        GO TO 7499-EXIT.
 23180
 23181**2743**
 23182
 23183     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2743
 23184        MOVE AL-UNBON            TO CCANDT1A
 23185        MOVE -1                  TO CCANDT1L
 23186        MOVE  1                  TO SET-CURSOR-SW
 23187        GO TO 7499-EXIT.
 23188
 23189**2744**
 23190
 23191     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2744
 23192        MOVE AL-UNBON            TO CCANDT2A
 23193        MOVE -1                  TO CCANDT2L
 23194        MOVE  1                  TO SET-CURSOR-SW
 23195        GO TO 7499-EXIT.
 23196
 23197**2747**
 23198
 23199     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2747
 23200        MOVE AL-UABON            TO CLSTNMA
 23201        MOVE -1                  TO CLSTNML
 23202        MOVE  1                  TO SET-CURSOR-SW
 23203        GO TO 7499-EXIT.
 23204
 23205**2749**
 23206
 23207     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2749
 23208        MOVE AL-UABON            TO CFORCEA
 23209        MOVE -1                  TO CFORCEL
 23210        MOVE  1                  TO SET-CURSOR-SW
 23211        GO TO 7499-EXIT.
 23212
 23213**2753**
 23214
 23215     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2753
 23216        MOVE AL-UNBON            TO CCANDT1A
 23217        MOVE -1                  TO CCANDT1L
 23218        MOVE  1                  TO SET-CURSOR-SW
 23219        GO TO 7499-EXIT.
 23220
 23221**2755**
 23222
 23223     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2755
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 431
* EL6311.cbl
 23224        IF  PB-C-LF-CANCEL-AMT GREATER THAN ZEROS
 23225            MOVE AL-UNBON        TO CREFND1A
 23226            MOVE -1              TO CREFND1L
 23227            MOVE  1              TO SET-CURSOR-SW
 23228            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 23229                MOVE AL-UNBON        TO CREFND2A
 23230                MOVE -1              TO CREFND2L
 23231                MOVE  1              TO SET-CURSOR-SW
 23232                GO TO 7499-EXIT
 23233            ELSE
 23234                GO TO 7499-EXIT
 23235        ELSE
 23236            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 23237                MOVE AL-UNBON        TO CREFND2A
 23238                MOVE -1              TO CREFND2L
 23239                MOVE  1              TO SET-CURSOR-SW
 23240            ELSE
 23241                GO TO 7499-EXIT.
 23242
 23243**2757**
 23244
 23245     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2757
 23246        MOVE AL-UNBON            TO CLIVESA
 23247        MOVE -1                  TO CLIVESL
 23248        MOVE  1                  TO SET-CURSOR-SW
 23249        GO TO 7499-EXIT.
 23250
 23251**2771**
 23252
 23253     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2771
 23254        MOVE AL-UABON            TO CCANDT2A
 23255        MOVE -1                  TO CCANDT2L
 23256        MOVE  1                  TO SET-CURSOR-SW
 23257        GO TO 7499-EXIT.
 23258
 23259**2774**
 23260
 23261     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2774
 23262        MOVE AL-UABON            TO CCANDT1A
 23263        MOVE -1                  TO CCANDT1L
 23264        MOVE  1                  TO SET-CURSOR-SW
 23265        GO TO 7499-EXIT.
 23266
 23267**2775**
 23268
 23269     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2775
 23270        MOVE AL-UABON            TO CCANDT2A
 23271        MOVE -1                  TO CCANDT2L
 23272        MOVE  1                  TO SET-CURSOR-SW
 23273        GO TO 7499-EXIT.
 23274
 23275**2776**
 23276
 23277     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2776
 23278        MOVE AL-UABON            TO CCANDT1A
 23279        MOVE -1                  TO CCANDT1L
 23280        MOVE  1                  TO SET-CURSOR-SW
 23281        GO TO 7499-EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 432
* EL6311.cbl
 23282
 23283
 23284**2777**
 23285
 23286     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2777
 23287        MOVE AL-UABON            TO CCANDT2A
 23288        MOVE -1                  TO CCANDT2L
 23289        MOVE  1                  TO SET-CURSOR-SW
 23290        GO TO 7499-EXIT.
 23291
 23292**2794**
 23293
 23294     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2794
 23295        MOVE AL-UABON            TO CFORCEA
 23296        MOVE -1                  TO CFORCEL
 23297        MOVE  1                  TO SET-CURSOR-SW
 23298        GO TO 7499-EXIT.
 23299
 23300**2799**
 23301
 23302     IF PI-COMPANY-ID = 'UCL'
 23303         IF PB-COMMON-ERROR    (WS-SUB4) = ER-2799
 23304             MOVE AL-UNBON            TO BEFFDTA
 23305             MOVE -1                  TO BEFFDTL
 23306             MOVE  1                  TO SET-CURSOR-SW
 23307             GO TO 7499-EXIT.
 23308
 23309 7499-EXIT.
 23310      EXIT.
 23311
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 433
* EL6311.cbl
 23313
 23314 7500-READ-ERLOFC.
 23315     MOVE SPACES                 TO  WS-LOAN-OFFICER
 23316                                     ERLOFC-KEY.
 23317
 23318     MOVE PI-COMPANY-CD          TO  ERLOFC-COMPANY-CD.
 23319
 23320     IF ST-ACCNT-CNTL
 23321         MOVE PI-SV-STATE        TO  ERLOFC-STATE.
 23322
 23323     IF CARR-GROUP-ST-ACCNT-CNTL
 23324         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER
 23325         MOVE PI-SV-STATE        TO  ERLOFC-STATE
 23326         MOVE PI-SV-GROUPING     TO  ERLOFC-GROUPING.
 23327
 23328     IF CARR-ST-ACCNT-CNTL
 23329         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER
 23330         MOVE PI-SV-STATE        TO  ERLOFC-STATE.
 23331
 23332     IF CARR-ACCNT-CNTL
 23333         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER.
 23334
 23335     MOVE PI-PB-ACCOUNT          TO  ERLOFC-ACCOUNT.
 23336
 23337     MOVE BLNOFCRI               TO ERLOFC-OFFICER-CODE.
 23338
 23339
 23340* EXEC CICS HANDLE CONDITION
 23341*        NOTFND   (7550-OFFICER-NOTFND)
 23342*    END-EXEC.
 23343*    MOVE '"$I                   ! [ #00019625' TO DFHEIV0
 23344     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 23345     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 23346     MOVE X'5B20233030303139363235' TO DFHEIV0(25:11)
 23347     CALL 'kxdfhei1' USING DFHEIV0
 23348     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23349
 23350
 23351
 23352* EXEC CICS READ
 23353*        DATASET   (FILE-ID-ERLOFC)
 23354*        SET       (ADDRESS OF LOAN-OFFICER-MASTER)
 23355*        RIDFLD    (ERLOFC-KEY)
 23356*        EQUAL
 23357*    END-EXEC.
 23358*    MOVE '&"S        E          (   #00019629' TO DFHEIV0
 23359     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 23360     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 23361     MOVE X'2020233030303139363239' TO DFHEIV0(25:11)
 23362     CALL 'kxdfhei1' USING DFHEIV0,
 23363           FILE-ID-ERLOFC,
 23364           DFHEIV20,
 23365           DFHEIV99,
 23366           ERLOFC-KEY,
 23367           DFHEIV99,
 23368           DFHEIV99,
 23369           DFHEIV99
 23370     SET ADDRESS OF LOAN-OFFICER-MASTER TO
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 434
* EL6311.cbl
 23371         DFHEIV20
 23372     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23373
 23374
 23375     GO TO 7599-EXIT.
 23376
 23377 7550-OFFICER-NOTFND.
 23378     MOVE 'X'                    TO WS-LOAN-OFFICER.
 23379
 23380 7599-EXIT.
 23381      EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 435
* EL6311.cbl
 23383******************************************************************
 23384*                                                                *
 23385*            S  E N D    I N I T I A L   M A P                   *
 23386*                                                                *
 23387******************************************************************
 23388
 23389 8100-SEND-INITIAL-MAP.
 23390     MOVE EIBTIME                TO TIME-IN.
 23391
 23392     IF EIBAID = DFHPF11
 23393        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 23394        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 23395
 23396
 23397     IF PI-COMPANY-ID = CLIENT-GIC
 23398        MOVE AL-UNNOF               TO BCPREM-ATTRB (1)
 23399                                       BCPREM-ATTRB (2).
 23400
 23401     IF PI-COMPANY-ID = (CLIENT-MIC OR
 23402                         CLIENT-PEM OR
 23403                         CLIENT-CSO)
 23404        AND PI-DISPLAY-ORIGINAL-BATCH
 23405          IF PI-MAP-NAME = EL631B
 23406             MOVE AL-SADOF               TO BPF5HDRA
 23407                                            BPF4HDRA
 23408          ELSE
 23409             IF PI-MAP-NAME = EL631C
 23410                MOVE AL-SADOF            TO CPF5HDRA
 23411                                            CPF4HDRA.
 23412
 23413     IF PI-MAP-NAME = EL631B
 23414        MOVE AL-SADOF               TO BPF5HDRA
 23415     ELSE
 23416        MOVE AL-SADOF               TO CPF5HDRA
 23417     END-IF
 23418
 23419*DMD CUSTOM CODING*************START    DO IT WHEN SCREEN=EL631B &
 23420     IF PI-MAP-NAME = EL631B
 23421          IF PI-COMPANY-ID NOT = 'DMD'
 23422             MOVE AL-SANOF            TO BBILLEDA
 23423             MOVE AL-SADOF            TO DMDBILA.
 23424*DMD CUSTOM CODING*************END
 23425
 23426     IF PI-PROCESSOR-ID = 'LGXX'
 23427        IF PI-MAP-NAME = EL631B
 23428           MOVE AL-SABOF                    TO BREFHDGA
 23429           MOVE AL-SANOF                    TO BREFA
 23430        ELSE
 23431           IF PI-MAP-NAME = EL631C
 23432              MOVE AL-SABOF                 TO CREFHDGA
 23433              MOVE AL-SANOF                 TO CREFA.
 23434
 23435*******      ONLY SHOW CANCEL FEE FOR CLIENT ACE ON EL631C *******
 23436     IF PI-COMPANY-ID = (CLIENT-ACE OR CLIENT-LGX)
 23437        NEXT SENTENCE
 23438     ELSE
 23439        IF PI-MAP-NAME = EL631C
 23440           MOVE AL-SADOF            TO CCANTXTA
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 436
* EL6311.cbl
 23441                                       CCANFEEA.
 23442
 23443     IF PI-MAP-NAME = EL631D
 23444        IF PI-AR-PROCESSING
 23445           MOVE AL-SANOF            TO DREFHDGA
 23446        ELSE
 23447           MOVE AL-SADOF            TO DREFHDGA.
 23448
 23449     IF (PI-COMPANY-ID NOT = 'DCC')
 23450        AND (PI-MAP-NAME = EL631B)
 23451        MOVE AL-SADOF            TO BVINHA
 23452                                    BVINA
 23453     END-IF
 23454     IF PI-MAP-NAME = EL631B
 23455        IF CSR-EDIT-SESSION
 23456           MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
 23457                                 TO BHEADO
 23458           MOVE '4=B-HDR 6=RES'  TO BPF4HDRO
 23459        ELSE
 23460           MOVE AL-SADOF         TO BF15HDRA
 23461           MOVE '4=B-HDR      '  TO BPF4HDRO
 23462        END-IF
 23463        MOVE PI-MEMBER-CAPTION      TO BMEMCAPO
 23464        MOVE PI-LIFE-OVERRIDE-L2    TO BKIND1O
 23465        MOVE PI-AH-OVERRIDE-L2      TO BKIND2O
 23466        MOVE WS-CURRENT-DT          TO BDATEO
 23467        MOVE TIME-OUT               TO BTIMEO
 23468        MOVE EMI-MESSAGE-AREA (1)   TO BERMSG1O
 23469        MOVE EMI-MESSAGE-AREA (2)   TO BERMSG2O
 23470        MOVE EMI-MESSAGE-AREA (3)   TO BERMSG3O
 23471        IF   WS-DISPLAY-SCREEN
 23472             MOVE PB-ENTRY-BATCH    TO BBATCHO
 23473             MOVE PB-SV-CARRIER     TO BCARRO
 23474             MOVE PB-SV-GROUPING    TO BGROUPO
 23475             MOVE PB-SV-STATE       TO BSTATEO
 23476             MOVE PB-ACCOUNT        TO BACCTO
 23477        ELSE
 23478             MOVE PI-PB-ENTRY-BATCH TO BBATCHO
 23479     ELSE
 23480        IF PI-MAP-NAME = EL631C
 23481           MOVE '4=B-HDR      '     TO CPF4HDRO
 23482           IF CSR-EDIT-SESSION
 23483              MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
 23484                                 TO CHEADO
 23485           ELSE
 23486              MOVE AL-SADOF      TO CF15HDRA
 23487           END-IF
 23488           MOVE PI-PB-ENTRY-BATCH      TO CBATCHO
 23489           MOVE WS-CURRENT-DT          TO CDATEO
 23490           MOVE TIME-OUT               TO CTIMEO
 23491           MOVE PI-LIFE-OVERRIDE-L2    TO CKIND1O
 23492           MOVE PI-AH-OVERRIDE-L2      TO CKIND2O
 23493           MOVE PI-LIFE-OVERRIDE-L2    TO WS-REF-HDG-OVERRIDE
 23494           MOVE WS-C-HDG               TO CLFHDGO
 23495           MOVE PI-AH-OVERRIDE-L2      TO WS-REF-HDG-OVERRIDE
 23496           MOVE WS-C-HDG               TO CAHHDGO
 23497           MOVE EMI-MESSAGE-AREA (1)   TO CERMSG1O
 23498           MOVE EMI-MESSAGE-AREA (2)   TO CERMSG2O
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 437
* EL6311.cbl
 23499           MOVE EMI-MESSAGE-AREA (3)   TO CERMSG3O
 23500           IF   WS-DISPLAY-SCREEN
 23501                MOVE PB-ENTRY-BATCH    TO CBATCHO
 23502                MOVE PB-SV-CARRIER     TO CCARRO
 23503                MOVE PB-SV-GROUPING    TO CGROUPO
 23504                MOVE PB-SV-STATE       TO CSTATEO
 23505                MOVE PB-ACCOUNT        TO CACCTO
 23506           ELSE
 23507                MOVE PI-PB-ENTRY-BATCH TO CBATCHO
 23508        ELSE
 23509           MOVE WS-CURRENT-DT          TO DDATEO
 23510           MOVE TIME-OUT               TO DTIMEO
 23511           MOVE PI-LIFE-OVERRIDE-L2    TO WS-PREM-HDG-OVERRIDE
 23512                                          WS-REFUND-HDG-OVERRIDE
 23513           MOVE WS-D-PREM-HDG          TO DLFPHDGO
 23514           MOVE WS-D-REFUND-HDG        TO DLFRHDGO
 23515           MOVE PI-AH-OVERRIDE-L2      TO WS-PREM-HDG-OVERRIDE
 23516                                          WS-REFUND-HDG-OVERRIDE
 23517           MOVE WS-D-PREM-HDG          TO DAHPHDGO
 23518           MOVE WS-D-REFUND-HDG        TO DAHRHDGO
 23519           MOVE EMI-MESSAGE-AREA (1)   TO DERMSGO
 23520           IF CSR-EDIT-SESSION
 23521              MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
 23522                                 TO DHEADO
 23523           END-IF
 23524           IF  WS-DISPLAY-SCREEN
 23525               MOVE PB-ENTRY-BATCH     TO DBATCHO
 23526               MOVE PB-CARRIER         TO DCARRO
 23527               MOVE PB-GROUPING        TO DGROUPO
 23528               MOVE PB-STATE           TO DSTATEO
 23529               MOVE PB-ACCOUNT         TO DACCTO
 23530               MOVE PB-ACCOUNT-NAME    TO DACCTNMO
 23531           ELSE
 23532               MOVE EL631D             TO PI-MAP-NAME
 23533               MOVE PI-PB-ENTRY-BATCH  TO DBATCHO
 23534               MOVE PB-ACCOUNT-NAME TO DACCTNMO.
 23535
 23536     MOVE SPACE                        TO WS-DISPLAY-SW.
 23537
 23538
 23539* EXEC CICS SEND
 23540*        MAP      (PI-MAP-NAME)
 23541*        MAPSET   (MAPSET-EL6311S)
 23542*        FROM     (EL631BI)
 23543*        ERASE
 23544*        CURSOR
 23545*    END-EXEC.
 23546     MOVE LENGTH OF
 23547      EL631BI
 23548       TO DFHEIV12
 23549     MOVE -1
 23550       TO DFHEIV11
 23551*    MOVE '8$     CT  E    H L F ,   #00019799' TO DFHEIV0
 23552     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 23553     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 23554     MOVE X'2020233030303139373939' TO DFHEIV0(25:11)
 23555     CALL 'kxdfhei1' USING DFHEIV0,
 23556           PI-MAP-NAME,
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 438
* EL6311.cbl
 23557           EL631BI,
 23558           DFHEIV12,
 23559           MAPSET-EL6311S,
 23560           DFHEIV99,
 23561           DFHEIV99,
 23562           DFHEIV99,
 23563           DFHEIV11,
 23564           DFHEIV99,
 23565           DFHEIV99,
 23566           DFHEIV99
 23567     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23568
 23569
 23570     GO TO 9100-RETURN-TRAN.
 23571
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 439
* EL6311.cbl
 23573
 23574******************************************************************
 23575*                                                                *
 23576*              S E N D    D A T A O N L Y                        *
 23577*                                                                *
 23578******************************************************************
 23579
 23580 8200-SEND-DATAONLY.
 23581     MOVE EIBTIME                TO TIME-IN.
 23582
 23583     IF PI-COMPANY-ID = CLIENT-GIC
 23584        MOVE AL-UNNOF               TO BCPREM-ATTRB (1)
 23585                                       BCPREM-ATTRB (2).
 23586
 23587     IF PI-MAP-NAME = EL631B
 23588        MOVE PI-MEMBER-CAPTION      TO BMEMCAPO
 23589        MOVE WS-CURRENT-DT          TO BDATEO
 23590        MOVE TIME-OUT               TO BTIMEO
 23591        MOVE EMI-MESSAGE-AREA (1)   TO BERMSG1O
 23592        MOVE EMI-MESSAGE-AREA (2)   TO BERMSG2O
 23593        MOVE EMI-MESSAGE-AREA (3)   TO BERMSG3O
 23594        MOVE SPACES                 TO BPFENTRO
 23595        MOVE AL-UANOF               TO BPFENTRA
 23596
 23597*DMD CUSTOM CODING*************START    DO IT WHEN SCREEN=EL631B &
 23598        IF PI-COMPANY-ID NOT = 'DMD'
 23599             MOVE AL-SANOF            TO BBILLEDA
 23600             MOVE AL-SADOF            TO DMDBILA
 23601         ELSE
 23602            NEXT SENTENCE
 23603*DMD CUSTOM CODING*************END
 23604     ELSE
 23605        IF PI-MAP-NAME = EL631C
 23606           MOVE WS-CURRENT-DT          TO CDATEO
 23607           MOVE TIME-OUT               TO CTIMEO
 23608           MOVE EMI-MESSAGE-AREA (1)   TO CERMSG1O
 23609           MOVE EMI-MESSAGE-AREA (2)   TO CERMSG2O
 23610           MOVE EMI-MESSAGE-AREA (3)   TO CERMSG3O
 23611           MOVE SPACES                 TO CPFENTRO
 23612           MOVE AL-UANOF               TO CPFENTRA
 23613        ELSE
 23614           MOVE WS-CURRENT-DT          TO DDATEO
 23615           MOVE TIME-OUT               TO DTIMEO
 23616           MOVE EMI-MESSAGE-AREA (1)   TO DERMSGO.
 23617
 23618
 23619* EXEC CICS SEND
 23620*        MAP      (PI-MAP-NAME)
 23621*        MAPSET   (MAPSET-EL6311S)
 23622*        FROM     (EL631BI)
 23623*        DATAONLY
 23624*        CURSOR
 23625*    END-EXEC.
 23626     MOVE LENGTH OF
 23627      EL631BI
 23628       TO DFHEIV12
 23629     MOVE -1
 23630       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 440
* EL6311.cbl
 23631*    MOVE '8$D    CT       H L F ,   #00019855' TO DFHEIV0
 23632     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 23633     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 23634     MOVE X'2020233030303139383535' TO DFHEIV0(25:11)
 23635     CALL 'kxdfhei1' USING DFHEIV0,
 23636           PI-MAP-NAME,
 23637           EL631BI,
 23638           DFHEIV12,
 23639           MAPSET-EL6311S,
 23640           DFHEIV99,
 23641           DFHEIV99,
 23642           DFHEIV99,
 23643           DFHEIV11,
 23644           DFHEIV99,
 23645           DFHEIV99,
 23646           DFHEIV99
 23647     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23648
 23649
 23650     GO TO 9100-RETURN-TRAN.
 23651
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 441
* EL6311.cbl
 23653
 23654******************************************************************
 23655*                                                                *
 23656*           U T I L I T Y   R O U T I N E S                      *
 23657*                                                                *
 23658******************************************************************
 23659
 23660 8300-SEND-TEXT.
 23661
 23662* EXEC CICS SEND TEXT
 23663*        FROM     (LOGOFF-TEXT)
 23664*        LENGTH   (LOGOFF-LENGTH)
 23665*        ERASE
 23666*        FREEKB
 23667*    END-EXEC.
 23668*    MOVE '8&      T  E F  H   F -   #00019874' TO DFHEIV0
 23669     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 23670     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 23671     MOVE X'2020233030303139383734' TO DFHEIV0(25:11)
 23672     CALL 'kxdfhei1' USING DFHEIV0,
 23673           LOGOFF-TEXT,
 23674           LOGOFF-LENGTH,
 23675           DFHEIV99,
 23676           DFHEIV99,
 23677           DFHEIV99,
 23678           DFHEIV99,
 23679           DFHEIV99,
 23680           DFHEIV99,
 23681           DFHEIV99,
 23682           DFHEIV99,
 23683           DFHEIV99,
 23684           DFHEIV99
 23685     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23686
 23687
 23688
 23689* EXEC CICS RETURN
 23690*    END-EXEC.
 23691*    MOVE '.(                    ''   #00019881' TO DFHEIV0
 23692     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 23693     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 23694     MOVE X'2020233030303139383831' TO DFHEIV0(25:11)
 23695     CALL 'kxdfhei1' USING DFHEIV0,
 23696           DFHEIV99,
 23697           DFHEIV99,
 23698           DFHEIV99,
 23699           DFHEIV99,
 23700           DFHEIV99,
 23701           DFHEIV99
 23702     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23703
 23704
 23705 8400-LOG-JOURNAL-RECORD.
 23706     MOVE PI-PROCESSOR-ID        TO JP-USER-ID.
 23707     MOVE THIS-PGM               TO JP-PROGRAM-ID.
 23708
 23709*    EXEC CICS JOURNAL
 23710*        JFILEID     (PI-JOURNAL-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 442
* EL6311.cbl
 23711*        JTYPEID     ('EL')
 23712*        FROM        (JOURNAL-RECORD)
 23713*        LENGTH      (WS-JOURNAL-RECORD-LENGTH)
 23714*    END-EXEC.
 23715
 23716 8600-DEEDIT.
 23717
 23718* EXEC CICS BIF DEEDIT
 23719*         FIELD   (DEEDIT-FIELD)
 23720*         LENGTH  (15)
 23721*    END-EXEC.
 23722     MOVE 15
 23723       TO DFHEIV11
 23724*    MOVE '@"L                   #   #00019896' TO DFHEIV0
 23725     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 23726     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 23727     MOVE X'2020233030303139383936' TO DFHEIV0(25:11)
 23728     CALL 'kxdfhei1' USING DFHEIV0,
 23729           DEEDIT-FIELD,
 23730           DFHEIV11
 23731     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23732
 23733
 23734 8800-UNAUTHORIZED-ACCESS.
 23735     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 23736     GO TO 8300-SEND-TEXT.
 23737
 23738 8810-PF23.
 23739     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 23740     MOVE XCTL-EL005             TO PGM-NAME.
 23741     GO TO 9300-XCTL.
 23742
 23743 9100-RETURN-TRAN.
 23744     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 23745
 23746     IF  PI-MAP-NAME =  EL631B
 23747         MOVE '631B'             TO PI-CURRENT-SCREEN-NO.
 23748
 23749     IF  PI-MAP-NAME =  EL631C
 23750         MOVE '631C'             TO PI-CURRENT-SCREEN-NO.
 23751
 23752     IF  PI-MAP-NAME =  EL631D
 23753         MOVE '631D'             TO PI-CURRENT-SCREEN-NO.
 23754
 23755
 23756* EXEC CICS RETURN
 23757*        TRANSID    (TRANS-EXB1)
 23758*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 23759*        LENGTH     (1300)
 23760*    END-EXEC.
 23761     MOVE 1300
 23762       TO DFHEIV11
 23763*    MOVE '.(CT                  ''   #00019922' TO DFHEIV0
 23764     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 23765     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 23766     MOVE X'2020233030303139393232' TO DFHEIV0(25:11)
 23767     CALL 'kxdfhei1' USING DFHEIV0,
 23768           TRANS-EXB1,
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 443
* EL6311.cbl
 23769           PROGRAM-INTERFACE-BLOCK,
 23770           DFHEIV11,
 23771           DFHEIV99,
 23772           DFHEIV99,
 23773           DFHEIV99
 23774     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23775
 23776
 23777 9200-RETURN-MAIN-MENU.
 23778     MOVE XCTL-EL626             TO PGM-NAME.
 23779     GO TO 9300-XCTL.
 23780
 23781 9300-XCTL.
 23782
 23783* EXEC CICS XCTL
 23784*        PROGRAM    (PGM-NAME)
 23785*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 23786*        LENGTH     (PI-COMM-LENGTH)
 23787*    END-EXEC.
 23788*    MOVE '.$C                   %   #00019933' TO DFHEIV0
 23789     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 23790     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 23791     MOVE X'2020233030303139393333' TO DFHEIV0(25:11)
 23792     CALL 'kxdfhei1' USING DFHEIV0,
 23793           PGM-NAME,
 23794           PROGRAM-INTERFACE-BLOCK,
 23795           PI-COMM-LENGTH,
 23796           DFHEIV99
 23797     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23798
 23799
 23800 9400-CLEAR.
 23801     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
 23802     GO TO 9300-XCTL.
 23803
 23804 9500-PF12.
 23805     MOVE XCTL-EL010             TO PGM-NAME.
 23806     GO TO 9300-XCTL.
 23807
 23808 9600-PGMID-ERROR.
 23809
 23810* EXEC CICS HANDLE CONDITION
 23811*        PGMIDERR    (8300-SEND-TEXT)
 23812*    END-EXEC.
 23813*    MOVE '"$L                   ! \ #00019948' TO DFHEIV0
 23814     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 23815     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 23816     MOVE X'5C20233030303139393438' TO DFHEIV0(25:11)
 23817     CALL 'kxdfhei1' USING DFHEIV0
 23818     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23819
 23820
 23821     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
 23822     MOVE ' '                    TO PI-ENTRY-CD-1.
 23823     MOVE XCTL-EL005             TO PGM-NAME.
 23824     MOVE PGM-NAME               TO LOGOFF-PGM.
 23825     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
 23826     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 444
* EL6311.cbl
 23827
 23828 9700-DATE-LINK.
 23829     MOVE LINK-ELDATCV           TO PGM-NAME.
 23830
 23831* EXEC CICS LINK
 23832*        PROGRAM    (PGM-NAME)
 23833*        COMMAREA   (DATE-CONVERSION-DATA)
 23834*        LENGTH     (DC-COMM-LENGTH)
 23835*    END-EXEC.
 23836*    MOVE '."C                   (   #00019961' TO DFHEIV0
 23837     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 23838     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 23839     MOVE X'2020233030303139393631' TO DFHEIV0(25:11)
 23840     CALL 'kxdfhei1' USING DFHEIV0,
 23841           PGM-NAME,
 23842           DATE-CONVERSION-DATA,
 23843           DC-COMM-LENGTH,
 23844           DFHEIV99,
 23845           DFHEIV99,
 23846           DFHEIV99,
 23847           DFHEIV99
 23848     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23849
 23850
 23851 9800-LINK-PENDING-EDIT.
 23852     MOVE PI-LIFE-OVERRIDE-L1    TO PB-LIFE-OVERRIDE-L1.
 23853     MOVE PI-AH-OVERRIDE-L1      TO PB-AH-OVERRIDE-L1.
 23854
 23855     MOVE LINK-EL050             TO PGM-NAME
 23856     MOVE PENDING-BUSINESS       TO PASSED-RECORD
 23857     MOVE ZEROS                  TO WK-CO-MAX-CAP
 23858                                    WK-CO-TOL-CLAIM
 23859                                    WK-CO-TOL-PREM
 23860                                    WK-CO-TOL-REFUND
 23861                                    WK-CO-TOL-PREM-PCT
 23862                                    WK-CO-TOL-REFUND-PCT
 23863                                    WK-REFUND-OVS-AMT
 23864                                    WK-REFUND-OVS-PCT
 23865                                    WK-ACCT-ADDR
 23866                                    WK-LIFE-EDIT-ADDR
 23867                                    WK-AH-EDIT-ADDR
 23868                                    WK-LIFE-BEN-ADDR
 23869                                    WK-AH-BEN-ADDR
 23870                                    WK-STATE-ADDR
 23871                                    WK-PLAN-ADDR
 23872                                    WK-FORM-ADDR
 23873     MOVE PI-CSR-SESSION-SW      TO WK-CSR-SESSION-SW
 23874
 23875     MOVE '6'                    TO WK-ENTRY-SW.
 23876
 23877     MOVE SPACES                 TO EDIT-CRITERIA-DATA.
 23878
 23879     MOVE LOW-VALUES             TO EC-CO-MONTH-END-DT
 23880                                    EC-AM-EXPIRATION-DT
 23881                                    EC-AM-EFFECTIVE-DT
 23882                                    EC-CM-LF-CANCEL-DT
 23883                                    EC-CM-AH-CANCEL-DT
 23884                                    EC-CM-DEATH-DT.
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 445
* EL6311.cbl
 23885
 23886     MOVE ZEROS                  TO EC-CO-TOL-PREM
 23887                                    EC-CO-TOL-REFUND
 23888                                    EC-CO-MIN-AGE
 23889                                    EC-CO-MIN-PREMIUM
 23890                                    EC-CO-MIN-TERM
 23891                                    EC-CO-MAX-TERM
 23892                                    EC-ST-TOL-PREM
 23893                                    EC-ST-TOL-REFUND
 23894                                    EC-AM-LF-TOL-PREM
 23895                                    EC-AM-AH-TOL-PREM
 23896                                    EC-AM-LF-MAX-ATT-AGE
 23897                                    EC-AM-LF-MAX-AGE
 23898                                    EC-AM-LF-MAX-TERM
 23899                                    EC-AM-LF-MAX-TOT-BEN
 23900                                    EC-AM-AH-MAX-ATT-AGE
 23901                                    EC-AM-AH-MAX-AGE
 23902                                    EC-AM-AH-MAX-TERM
 23903                                    EC-AM-AH-MAX-TOT-BEN
 23904                                    EC-AM-AH-MAX-MON-BEN
 23905                                    EC-RT-LF-MAX-ATT-AGE
 23906                                    EC-RT-LF-MAX-AGE
 23907                                    EC-RT-LF-MAX-TERM
 23908                                    EC-RT-LF-MAX-TOT-BEN
 23909                                    EC-RT-AH-MAX-ATT-AGE
 23910                                    EC-RT-AH-MAX-AGE
 23911                                    EC-RT-AH-MAX-TERM
 23912                                    EC-RT-AH-MAX-TOT-BEN
 23913                                    EC-RT-AH-MAX-MON-BEN
 23914                                    EC-RT-AH-RATE
 23915                                    EC-RT-LF-RATE
 23916                                    EC-RT-LF-NSP-RATE
 23917                                    EC-RT-AH-NSP-RATE
 23918                                    EC-CM-LF-PRIOR-REFUND
 23919                                    EC-CM-AH-PRIOR-REFUND.
 23920
 23921     MOVE ZEROS                  TO EC-CO-TOL-PREM-PCT
 23922                                    EC-ST-TOL-PREM-PCT
 23923                                    EC-AM-LF-TOL-REFUND
 23924                                    EC-AM-LF-DEV-PERCENT
 23925                                    EC-CO-TOL-REFUND-PCT
 23926                                    EC-ST-TOL-REFUND-PCT
 23927                                    EC-AM-AH-TOL-REFUND
 23928                                    EC-AM-AH-DEV-PERCENT.
 23929
 23930
 23931* EXEC CICS LINK
 23932*         PROGRAM   (PGM-NAME)
 23933*         COMMAREA  (PASSED-RECORD)
 23934*         LENGTH    (WS-EDIT-PASS-LENGTH)
 23935*    END-EXEC.
 23936*    MOVE '."C                   (   #00020046' TO DFHEIV0
 23937     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 23938     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 23939     MOVE X'2020233030303230303436' TO DFHEIV0(25:11)
 23940     CALL 'kxdfhei1' USING DFHEIV0,
 23941           PGM-NAME,
 23942           PASSED-RECORD,
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 446
* EL6311.cbl
 23943           WS-EDIT-PASS-LENGTH,
 23944           DFHEIV99,
 23945           DFHEIV99,
 23946           DFHEIV99,
 23947           DFHEIV99
 23948     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23949
 23950
 23951     MOVE '1'                    TO PI-EDIT-SW.
 23952     MOVE EDIT-CRITERIA-DATA     TO PI-CRITERIA-DATA.
 23953
 23954     MOVE PASSED-RECORD          TO PENDING-BUSINESS.
 23955
 23956     IF PI-COMPANY-ID = 'UCL'
 23957         MOVE EC-AM-EFFECTIVE-DT TO WS-CERT-EFF-DT.
 23958
 23959     IF VALID-PB-ID
 23960        GO TO 9800-EXIT.
 23961
 23962     MOVE PENDING-BUSINESS       TO EMI-LINE1.
 23963
 23964     IF PI-MAP-NAME = EL631B
 23965        MOVE -1                  TO BMAINTL
 23966       ELSE
 23967        MOVE -1                  TO CMAINTL.
 23968
 23969     GO TO 8200-SEND-DATAONLY.
 23970
 23971 9800-EXIT.
 23972      EXIT.
 23973
 23974 9900-ERROR-FORMAT.
 23975
 23976     MOVE PI-COMPANY-ID TO EMI-CLIENT-ID.
 23977
 23978     IF NOT EMI-ERRORS-COMPLETE
 23979         MOVE LINK-EL001         TO PGM-NAME
 23980
 23981* EXEC CICS LINK
 23982*            PROGRAM    (PGM-NAME)
 23983*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 23984*            LENGTH     (EMI-COMM-LENGTH)
 23985*        END-EXEC.
 23986*    MOVE '."C                   (   #00020081' TO DFHEIV0
 23987     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 23988     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 23989     MOVE X'2020233030303230303831' TO DFHEIV0(25:11)
 23990     CALL 'kxdfhei1' USING DFHEIV0,
 23991           PGM-NAME,
 23992           ERROR-MESSAGE-INTERFACE-BLOCK,
 23993           EMI-COMM-LENGTH,
 23994           DFHEIV99,
 23995           DFHEIV99,
 23996           DFHEIV99,
 23997           DFHEIV99
 23998     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23999
 24000
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 447
* EL6311.cbl
 24001 9900-EXIT.
 24002     EXIT.
 24003
 24004 9990-ABEND.
 24005     MOVE LINK-EL004             TO PGM-NAME.
 24006     MOVE DFHEIBLK               TO EMI-LINE1.
 24007
 24008* EXEC CICS LINK
 24009*        PROGRAM   (PGM-NAME)
 24010*        COMMAREA  (EMI-LINE1)
 24011*        LENGTH    (72)
 24012*    END-EXEC.
 24013     MOVE 72
 24014       TO DFHEIV11
 24015*    MOVE '."C                   (   #00020093' TO DFHEIV0
 24016     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24017     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24018     MOVE X'2020233030303230303933' TO DFHEIV0(25:11)
 24019     CALL 'kxdfhei1' USING DFHEIV0,
 24020           PGM-NAME,
 24021           EMI-LINE1,
 24022           DFHEIV11,
 24023           DFHEIV99,
 24024           DFHEIV99,
 24025           DFHEIV99,
 24026           DFHEIV99
 24027     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24028
 24029
 24030     IF PI-MAP-NAME = EL631B
 24031        MOVE -1                  TO BMAINTL
 24032       ELSE
 24033        MOVE -1                  TO CMAINTL.
 24034
 24035     IF EIBTRNID NOT = TRANS-EXB1
 24036        GO TO 8100-SEND-INITIAL-MAP
 24037       ELSE
 24038        GO TO 8200-SEND-DATAONLY.
 24039
 24040 9995-SECURITY-VIOLATION.
 24041*                            COPY ELCSCTP.
 24042******************************************************************
 24043*                                                                *
 24044*                            ELCSCTP                             *
 24045*                            VMOD=2.001                          *
 24046*                                                                *
 24047*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 24048******************************************************************
 24049
 24050
 24051     MOVE EIBDATE          TO SM-JUL-DATE.
 24052     MOVE EIBTRMID         TO SM-TERMID.
 24053     MOVE THIS-PGM         TO SM-PGM.
 24054     MOVE EIBTIME          TO TIME-IN.
 24055     MOVE TIME-OUT         TO SM-TIME.
 24056     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 24057
 24058
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 448
* EL6311.cbl
 24059* EXEC CICS LINK
 24060*         PROGRAM  ('EL003')
 24061*         COMMAREA (SECURITY-MESSAGE)
 24062*         LENGTH   (80)
 24063*    END-EXEC.
 24064     MOVE 'EL003' TO DFHEIV1
 24065     MOVE 80
 24066       TO DFHEIV11
 24067*    MOVE '."C                   (   #00020127' TO DFHEIV0
 24068     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24069     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24070     MOVE X'2020233030303230313237' TO DFHEIV0(25:11)
 24071     CALL 'kxdfhei1' USING DFHEIV0,
 24072           DFHEIV1,
 24073           SECURITY-MESSAGE,
 24074           DFHEIV11,
 24075           DFHEIV99,
 24076           DFHEIV99,
 24077           DFHEIV99,
 24078           DFHEIV99
 24079     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24080
 24081
 24082******************************************************************
 24083
 24084
 24085 9999-DFHBACK SECTION.
 24086     MOVE '9%                    "   ' TO DFHEIV0
 24087     MOVE 'EL6311' TO DFHEIV1
 24088     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 24089     GOBACK.
 24090 9999-DFHEXIT.
 24091     IF DFHEIGDJ EQUAL 0001
 24092         NEXT SENTENCE
 24093     ELSE IF DFHEIGDJ EQUAL 2
 24094         GO TO 9600-PGMID-ERROR,
 24095               9990-ABEND,
 24096               9990-ABEND,
 24097               0010-MAIN-LOGIC
 24098         DEPENDING ON DFHEIGDI
 24099     ELSE IF DFHEIGDJ EQUAL 3
 24100         GO TO 1280-BATCH-HDR-NOT-FOUND
 24101         DEPENDING ON DFHEIGDI
 24102     ELSE IF DFHEIGDJ EQUAL 4
 24103         GO TO 1290-DUPLICATE-ALT-INDEX
 24104         DEPENDING ON DFHEIGDI
 24105     ELSE IF DFHEIGDJ EQUAL 5
 24106         GO TO 1295-CERT-TRL-REC-NOTFND
 24107         DEPENDING ON DFHEIGDI
 24108     ELSE IF DFHEIGDJ EQUAL 6
 24109         GO TO 1380-BATCH-HDR-NOT-FOUND
 24110         DEPENDING ON DFHEIGDI
 24111     ELSE IF DFHEIGDJ EQUAL 7
 24112         GO TO 1385-REC-NOT-FOUND
 24113         DEPENDING ON DFHEIGDI
 24114     ELSE IF DFHEIGDJ EQUAL 8
 24115         GO TO 1386-NOTFND
 24116         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 449
* EL6311.cbl
 24117     ELSE IF DFHEIGDJ EQUAL 9
 24118         GO TO 1399-EXIT
 24119         DEPENDING ON DFHEIGDI
 24120     ELSE IF DFHEIGDJ EQUAL 10
 24121         GO TO 1480-BATCH-HDR-NOT-FOUND
 24122         DEPENDING ON DFHEIGDI
 24123     ELSE IF DFHEIGDJ EQUAL 11
 24124         GO TO 1490-RECORD-NOT-FOUND
 24125         DEPENDING ON DFHEIGDI
 24126     ELSE IF DFHEIGDJ EQUAL 12
 24127         GO TO 1405-DELETE-CERTIFICATE
 24128         DEPENDING ON DFHEIGDI
 24129     ELSE IF DFHEIGDJ EQUAL 13
 24130         GO TO 1420-CONTINUE-DELETE
 24131         DEPENDING ON DFHEIGDI
 24132     ELSE IF DFHEIGDJ EQUAL 14
 24133         GO TO 1406-DELETE-ERNOTE
 24134         DEPENDING ON DFHEIGDI
 24135     ELSE IF DFHEIGDJ EQUAL 15
 24136         GO TO 1407-DELETE-MAILING
 24137         DEPENDING ON DFHEIGDI
 24138     ELSE IF DFHEIGDJ EQUAL 16
 24139         GO TO 1420-CONTINUE-DELETE
 24140         DEPENDING ON DFHEIGDI
 24141     ELSE IF DFHEIGDJ EQUAL 17
 24142         GO TO 1480-BATCH-HDR-NOT-FOUND
 24143         DEPENDING ON DFHEIGDI
 24144     ELSE IF DFHEIGDJ EQUAL 18
 24145         GO TO 1475-DELETE-FINISHED
 24146         DEPENDING ON DFHEIGDI
 24147     ELSE IF DFHEIGDJ EQUAL 19
 24148         GO TO 2280-BATCH-HDR-NOT-FOUND
 24149         DEPENDING ON DFHEIGDI
 24150     ELSE IF DFHEIGDJ EQUAL 20
 24151         GO TO 2290-DUPLICATE-ALT-INDEX
 24152         DEPENDING ON DFHEIGDI
 24153     ELSE IF DFHEIGDJ EQUAL 21
 24154         GO TO 2380-BATCH-HDR-NOT-FOUND
 24155         DEPENDING ON DFHEIGDI
 24156     ELSE IF DFHEIGDJ EQUAL 22
 24157         GO TO 2385-REC-NOT-FOUND
 24158         DEPENDING ON DFHEIGDI
 24159     ELSE IF DFHEIGDJ EQUAL 23
 24160         GO TO 2380-BATCH-HDR-NOT-FOUND
 24161         DEPENDING ON DFHEIGDI
 24162     ELSE IF DFHEIGDJ EQUAL 24
 24163         GO TO 2485-BATCH-HDR-NOT-FOUND
 24164         DEPENDING ON DFHEIGDI
 24165     ELSE IF DFHEIGDJ EQUAL 25
 24166         GO TO 2490-RECORD-NOT-FOUND
 24167         DEPENDING ON DFHEIGDI
 24168     ELSE IF DFHEIGDJ EQUAL 26
 24169         GO TO 2475-CONTINUE-DELETE
 24170         DEPENDING ON DFHEIGDI
 24171     ELSE IF DFHEIGDJ EQUAL 27
 24172         GO TO 2485-BATCH-HDR-NOT-FOUND
 24173         DEPENDING ON DFHEIGDI
 24174     ELSE IF DFHEIGDJ EQUAL 28
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 450
* EL6311.cbl
 24175         GO TO 2480-DELETE-FINISHED
 24176         DEPENDING ON DFHEIGDI
 24177     ELSE IF DFHEIGDJ EQUAL 29
 24178         GO TO 2820-PROCESS-REWRITE
 24179         DEPENDING ON DFHEIGDI
 24180     ELSE IF DFHEIGDJ EQUAL 30
 24181         GO TO 2885-RECORD-MISSING
 24182         DEPENDING ON DFHEIGDI
 24183     ELSE IF DFHEIGDJ EQUAL 31
 24184         GO TO 2830-BUILD-NEW-ISSUE-RECORD
 24185         DEPENDING ON DFHEIGDI
 24186     ELSE IF DFHEIGDJ EQUAL 32
 24187         GO TO 2827-DELETE-MAILING
 24188         DEPENDING ON DFHEIGDI
 24189     ELSE IF DFHEIGDJ EQUAL 33
 24190         GO TO 2830-BUILD-NEW-ISSUE-RECORD
 24191         DEPENDING ON DFHEIGDI
 24192     ELSE IF DFHEIGDJ EQUAL 34
 24193         GO TO 2920-PROCESS-REWRITE
 24194         DEPENDING ON DFHEIGDI
 24195     ELSE IF DFHEIGDJ EQUAL 35
 24196         GO TO 2985-RECORD-MISSING
 24197         DEPENDING ON DFHEIGDI
 24198     ELSE IF DFHEIGDJ EQUAL 36
 24199         GO TO 2960-BUILD-NEW-CANCEL-RECORD
 24200         DEPENDING ON DFHEIGDI
 24201     ELSE IF DFHEIGDJ EQUAL 37
 24202         GO TO 2990-DUPLICATE-RECORD
 24203         DEPENDING ON DFHEIGDI
 24204     ELSE IF DFHEIGDJ EQUAL 38
 24205         GO TO 3590-NOT-FOUND
 24206         DEPENDING ON DFHEIGDI
 24207     ELSE IF DFHEIGDJ EQUAL 39
 24208         GO TO 3690-NOT-FOUND
 24209         DEPENDING ON DFHEIGDI
 24210     ELSE IF DFHEIGDJ EQUAL 40
 24211         GO TO 3990-NOT-FOUND
 24212         DEPENDING ON DFHEIGDI
 24213     ELSE IF DFHEIGDJ EQUAL 41
 24214         GO TO 4050-END-RECORDS,
 24215               4050-END-RECORDS
 24216         DEPENDING ON DFHEIGDI
 24217     ELSE IF DFHEIGDJ EQUAL 42
 24218         GO TO 4150-END-BATCH
 24219         DEPENDING ON DFHEIGDI
 24220     ELSE IF DFHEIGDJ EQUAL 43
 24221         GO TO 4150-END-BATCH
 24222         DEPENDING ON DFHEIGDI
 24223     ELSE IF DFHEIGDJ EQUAL 44
 24224         GO TO 4250-END-RECORDS,
 24225               4250-END-RECORDS
 24226         DEPENDING ON DFHEIGDI
 24227     ELSE IF DFHEIGDJ EQUAL 45
 24228         GO TO 4350-END-BATCH,
 24229               4350-END-BATCH
 24230         DEPENDING ON DFHEIGDI
 24231     ELSE IF DFHEIGDJ EQUAL 46
 24232         GO TO 4570-NOT-FOUND,
* Micro Focus Server Express         V5.1 revision 000 20-Aug-13 05:30 Page 451
* EL6311.cbl
 24233               4550-END-RECORDS
 24234         DEPENDING ON DFHEIGDI
 24235     ELSE IF DFHEIGDJ EQUAL 47
 24236         GO TO 4680-NOT-FOUND,
 24237               4680-NOT-FOUND
 24238         DEPENDING ON DFHEIGDI
 24239     ELSE IF DFHEIGDJ EQUAL 48
 24240         GO TO 4860-NOT-FOUND,
 24241               4850-END-RECORDS
 24242         DEPENDING ON DFHEIGDI
 24243     ELSE IF DFHEIGDJ EQUAL 49
 24244         GO TO 4970-NOT-FOUND,
 24245               4950-END-RECORDS
 24246         DEPENDING ON DFHEIGDI
 24247     ELSE IF DFHEIGDJ EQUAL 50
 24248         GO TO 5050-NOT-FOUND
 24249         DEPENDING ON DFHEIGDI
 24250     ELSE IF DFHEIGDJ EQUAL 51
 24251         GO TO 5050-NOT-FOUND
 24252         DEPENDING ON DFHEIGDI
 24253     ELSE IF DFHEIGDJ EQUAL 52
 24254         GO TO 5050-NOT-FOUND
 24255         DEPENDING ON DFHEIGDI
 24256     ELSE IF DFHEIGDJ EQUAL 53
 24257         GO TO 5550-END-RECORDS,
 24258               5550-END-RECORDS
 24259         DEPENDING ON DFHEIGDI
 24260     ELSE IF DFHEIGDJ EQUAL 54
 24261         GO TO 6050-QID-ERROR
 24262         DEPENDING ON DFHEIGDI
 24263     ELSE IF DFHEIGDJ EQUAL 55
 24264         GO TO 6050-QID-ERROR
 24265         DEPENDING ON DFHEIGDI
 24266     ELSE IF DFHEIGDJ EQUAL 56
 24267         GO TO 6400-CONTINUE,
 24268               6400-CONTINUE
 24269         DEPENDING ON DFHEIGDI
 24270     ELSE IF DFHEIGDJ EQUAL 57
 24271         GO TO 3690-NOT-FOUND
 24272         DEPENDING ON DFHEIGDI
 24273     ELSE IF DFHEIGDJ EQUAL 58
 24274         GO TO 7399-EXIT
 24275         DEPENDING ON DFHEIGDI
 24276     ELSE IF DFHEIGDJ EQUAL 59
 24277         GO TO 7550-OFFICER-NOTFND
 24278         DEPENDING ON DFHEIGDI
 24279     ELSE IF DFHEIGDJ EQUAL 60
 24280         GO TO 8300-SEND-TEXT
 24281         DEPENDING ON DFHEIGDI.
 24282     MOVE '9%                    "   ' TO DFHEIV0
 24283     MOVE 'EL6311' TO DFHEIV1
 24284     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 24285     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       14760     Code:       96517
