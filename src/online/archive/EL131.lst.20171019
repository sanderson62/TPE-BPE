* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page   1
* EL131.cbl
* Options: int("EL131.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL131.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL131.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL131.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL131 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/03/95 18:43:40.
     7*                            VMOD=2.046.
     8*
     9*AUTHOR.        LOGIC, INC.
    10*               DALLAS, TEXAS.
    11*REMARKS. TRANSACTION EX24 - CLAIM MAINTENANCE.
    12*
    13******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page   2
* EL131.cbl
    14*                   C H A N G E   L O G
    15*
    16* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    17*-----------------------------------------------------------------
    18*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    19* EFFECTIVE    NUMBER
    20*-----------------------------------------------------------------
    21* 101501    2001100100006  SMVA  ADD USERID, POPULATE COMPO
    22* 062602    2002030700006  PEMA  Add note type of 'S'
    23*                                  (special review)
    24* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYP I
    25* 071508    2008071000003  AJRA  ADD EDIT FOR SOC SEC NUMBER
    26* 012009    2007042600001  PEMA  RESTRICT CLAIM TYPE FOR CID
    27* 032612    2011110200001  PEMA  AHL CHANGES
    28* 040412    2012040400003  AJRA  DO NOT DELETE CERT ON AHL
    29* 032613    2013032500002  AJRA  PROTECT CERT#,CARR,GRP,ST,ACCT,EF
    30* 052113    2012113000002  PEMA  ADD SPECIAL STUFF FOR SPP DDF
    31* 060413    2013060300001  AJRA  CHECK FOR AUTO PAY WHEN BENE REMO
    32* 071613    2013071200001  PEMA  REMOVE INC & RPT DATE EDITS.
    33* 080613    2013071600001  PEMA  ALLOW INC DTE CHANGE
    34* 082013    2013040900001  AJRA  ADD PF15 BENEFICIARY MAINT
    35* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
    36* 111113    2013110600002  AJRA  CHG LEVEL 5 RESTRICTIONS TO LEVEL
    37* 040814    2014030500002  AJRA  ADD ICD CODES
    38* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
    39* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
    40* 070714    2014052800001  PEMA  correct read on erpdef for DCC
    41* 031715  CR2015022700002  PEMA  CHECK CHG IN DIAGNOSIS
    42* 031815    2015021700001  TANA  BENE EDIT IF A PAYMENT PENDING
    43* 020816  CR2015082500001  PEMA  ADD PROCESSING FOR NEW COMP VPP
    44* 040617  CR2017022200003  TANA  INCREASE CHG INC DT TO 180 DAYS
    45* 062217  CR2017050300002  TANA  ADD AUTH RCVD FIELD
    46* 081817    2016100700001  TANA  ADD NBR OF EXTENSIONS
    47******************************************************************
    48
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page   3
* EL131.cbl
    50 ENVIRONMENT DIVISION.
    51
    52 DATA DIVISION.
    53
    54 WORKING-STORAGE SECTION.
    55 01  DFH-START PIC X(04).
    56
    57 77  FILLER  PIC X(32)  VALUE '********************************'.
    58 77  FILLER  PIC X(32)  VALUE '*   EL131  WORKING STORAGE     *'.
    59 77  FILLER  PIC X(32)  VALUE '*********** VMOD=2.046 *********'.
    60 77  s1                          pic s999 comp-3 value+0.
    61 77  s2                          pic s999 comp-3 value+0.
    62 77  a1                          pic s999 comp-3 value+0.
    63 77  WS-CRITICAL-PERIOD          PIC 99    VALUE ZEROS.
    64 77  WS-CRIT-PER-RTW-MOS         PIC 99    VALUE ZEROS.
    65 77  WS-EXCL-PERIOD              PIC S999 COMP-3 VALUE +0.
    66 77  WS-COV-ENDS                 PIC S999 COMP-3 VALUE +0.
    67 77  WS-ACC-PERIOD               PIC S999 COMP-3 VALUE +0.
    68 77  ws-max-extension            pic s999 comp-3 value +0.
    69 77  ws-max-moben                pic s9(7)v99 comp-3 value +0.
    70 77  WS-MONTHS-BETWEEN           PIC S999 COMP-3 VALUE +0.
    71 77  WS-ERPDEF-SW                PIC X     VALUE ' '.
    72     88  ERPDEF-FOUND                 VALUE 'Y'.
    73 77  WS-TRLR-FILE-EOF            PIC X     VALUE ' '.
    74     88  TRLR-FILE-EOF                VALUE 'Y'.
    75 77  WS-PAYMENT-PENDING          PIC X     VALUE ' '.
    76     88  PAYMENT-PENDING              VALUE 'Y'.
    77 77  WS-AUTH-RCVD                PIC X     VALUE ' '.
    78     88  AUTH-RCVD                    VALUE 'Y'.
    79     88  NO-AUTH-RCVD                 VALUE 'N'.
    80 77  ws-eracct-sw                pic x  value ' '.
    81     88  acct-found                value 'Y'.
    82 77  ws-benper-sw                pic x   value ' '.
    83     88  good-benper               value 'Y'.
    84 77  ws-claim-type               pic x value ' '.
    85 77  ws-ben-per                  pic 99 value 00.
    86 77  ws-tot-days-paid            pic s9(5) comp-3 value +0.
    87 77  ws-tot-amt-paid             pic s9(9)v99 comp-3 value +0.
    88 77  ws-pd-bens                  pic s9(5) comp-3 value +0.
    89 77  ws-max-bens                 pic s9(5) comp-3 value +0.
    90
    91 01  LCP-TIME-OF-DAY-XX.
    92     05  LCP-TIME-OF-DAY-68        PIC 9(6).
    93     05  FILLER                    PIC 99.
    94 01  LCP-CICS-TIME                 PIC 9(15).
    95*                            COPY ELCSCTM.
    96******************************************************************
    97*                                                                *
    98*                                                                *
    99*                            ELCSCTM                             *
   100*                            VMOD=2.001                          *
   101*                                                                *
   102*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   103*                                                                *
   104******************************************************************
   105 01  SECURITY-MESSAGE.
   106     12  FILLER                          PIC X(30)
   107            VALUE '** LOGIC SECURITY VIOLATION -'.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page   4
* EL131.cbl
   108     12  SM-READ                         PIC X(6).
   109     12  FILLER                          PIC X(5)
   110            VALUE ' PGM='.
   111     12  SM-PGM                          PIC X(6).
   112     12  FILLER                          PIC X(5)
   113            VALUE ' OPR='.
   114     12  SM-PROCESSOR-ID                 PIC X(4).
   115     12  FILLER                          PIC X(6)
   116            VALUE ' TERM='.
   117     12  SM-TERMID                       PIC X(4).
   118     12  FILLER                          PIC XX   VALUE SPACE.
   119     12  SM-JUL-DATE                     PIC 9(5).
   120     12  FILLER                          PIC X    VALUE SPACE.
   121     12  SM-TIME                         PIC 99.99.
   122
   123
   124*                            COPY ELCSCRTY.
   125******************************************************************
   126*                                                                *
   127*                                                                *
   128*                            ELCSCRTY                            *
   129*                            VMOD=2.001                          *
   130*                                                                *
   131*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   132*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   133*        SAVED IN PI-SECURITY-ADDRESS.                           *
   134*                                                                *
   135******************************************************************
   136 01  SECURITY-CONTROL.
   137     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   138     12  FILLER                       PIC XX    VALUE 'SC'.
   139     12  SC-CREDIT-CODES.
   140         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   141             20  SC-CREDIT-DISPLAY    PIC X.
   142             20  SC-CREDIT-UPDATE     PIC X.
   143     12  SC-CLAIMS-CODES.
   144         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   145             20  SC-CLAIMS-DISPLAY    PIC X.
   146             20  SC-CLAIMS-UPDATE     PIC X.
   147
   148*                            COPY ELCNWA.
   149*****************************************************************
   150*                                                               *
   151*                                                               *
   152*                            ELCNWA.                            *
   153*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   154*                            VMOD=2.003                         *
   155*                                                               *
   156*            M O V E   N A M E   W O R K   A R E A.             *
   157*                                                               *
   158*****************************************************************.
   159
   160 01  WS-NAME-WORK-AREA.
   161     05  WS-INSURED-LAST-NAME        PIC X(15).
   162     05  WS-INSURED-1ST-NAME         PIC X(12).
   163     05  WS-INSURED-MID-INIT         PIC X.
   164
   165     05  WS-NAME-WORK.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page   5
* EL131.cbl
   166         10  WS-NW                   PIC X
   167             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
   168
   169     05  WS-NAME-WORK2.
   170         10  WS-NW2                  PIC X
   171             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
   172                                        NWA-INDEX0.
   173
   174     05  WS-NAME-SW                  PIC S9          VALUE ZERO
   175                                     COMP-3.
   176
   177
   178 01  ws-dcc-error-line.
   179     05  filler occurs 15.
   180         10  ws-error-no        pic x(4).
   181 01  WS-DATE-AREA.
   182     12  SAVE-DATE              PIC X(8)    VALUE SPACES.
   183     12  SAVE-BIN-DATE          PIC XX      VALUE SPACES.
   184     12  SAVE-DATE-CCYYMMDD.
   185         16  SAVE-DATE-CC       PIC XX      VALUE SPACES.
   186         16  SAVE-DATE-YMD.
   187             20  SAVE-DATE-YY   PIC XX      VALUE SPACES.
   188             20  FILLER         PIC X(4)    VALUE SPACES.
   189
   190 01  WS-BLANK                   PIC X       VALUE ' '.
   191
   192 01  CSO-WORK-FIELDS.
   193     05  WS-HOLD-CLAIM-STATUS    PIC X.
   194     05  WS-CRIT-PER-RECURRENT   PIC 99    VALUE 00.
   195     05  WS-CRIT-PER-ALPHA REDEFINES WS-CRIT-PER-RECURRENT.
   196         10  WS-RECURRENT-YN     PIC X.
   197         10  FILLER              PIC X.
   198
   199 01  LITERALS-NUMBERS.
   200     12  SC-ITEM                 PIC S9(4)   VALUE +1    COMP.
   201     12  NINETY                  PIC S9(4)   VALUE +90   COMP.
   202     12  ELMSTR-GENERIC-LENGTH   PIC S9(4)   VALUE +9    COMP.
   203     12  GETMAIN-SPACE           PIC X       VALUE SPACE.
   204     12  THIS-PGM                PIC X(8)    VALUE 'EL131'.
   205     12  TRAN-ID                 PIC X(4)    VALUE 'EX24'.
   206     12  MAP-ID                  PIC X(4)    VALUE '131A'.
   207     12  MAP-LENGTH              PIC S9(4)   VALUE +1060  COMP.
   208
   209     12  XCTL-EL001              PIC X(8)    VALUE 'EL001'.
   210     12  XCTL-EL004              PIC X(8)    VALUE 'EL004'.
   211     12  XCTL-EL005              PIC X(8)    VALUE 'EL005'.
   212     12  XCTL-EL010              PIC X(8)    VALUE 'EL010'.
   213     12  XCTL-EL114              PIC X(8)    VALUE 'EL114'.
   214     12  XCTL-EL126              PIC X(8)    VALUE 'EL126'.
   215     12  XCTL-EL1273             PIC X(8)    VALUE 'EL1273'.
   216     12  XCTL-EL141              PIC X(8)    VALUE 'EL141'.
   217     12  XCTL-EL142              PIC X(8)    VALUE 'EL142'.
   218     12  XCTL-EL400DMD           PIC X(8)    VALUE 'EL400DMD'.
   219
   220     12  LINK-1523               PIC X(8)    VALUE 'EL1523'.
   221
   222     12  DATE-CONV               PIC X(8)    VALUE 'ELDATCV'.
   223
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page   6
* EL131.cbl
   224     12  RTRM-FILE-ID            PIC X(8)    VALUE 'ELRTRM'.
   225     12  CLMS-FILE-ID            PIC X(8)    VALUE 'ELMSTR'.
   226     12  NOTE-FILE-ID            PIC X(8)    VALUE 'ERNOTE'.
   227     12  CERT-FILE-ID            PIC X(8)    VALUE 'ELCERT'.
   228     12  TRLR-FILE-ID            PIC X(8)    VALUE 'ELTRLR'.
   229     12  CNTL-FILE-ID            PIC X(8)    VALUE 'ELCNTL'.
   230     12  ACTQ-FILE-ID            PIC X(8)    VALUE 'ELACTQ'.
   231     12  CHKQ-FILE-ID            PIC X(8)    VALUE 'ELCHKQ'.
   232     12  ACCT-FILE-ID            PIC X(8)    VALUE 'ERACCT'.
   233     12  ARCH-FILE-ID            PIC X(8)    VALUE 'ELARCH'.
   234     12  ALPH-FILE-ID            PIC X(8)    VALUE 'ELALPH'.
   235
   236     12  MISC-SUB                PIC S9(3)   COMP-3  VALUE +0.
   237     12  ONE-OR-MIN1             PIC S9      COMP-3  VALUE +1.
   238     12  WS-READNEXT-SWITCH      PIC S99     VALUE +1.
   239     12  WS-ASSOC-CERT-TOTAL     PIC S99             VALUE ZEROS.
   240         88  NO-ASSOCIATED-CERTS                     VALUE ZEROS.
   241     12  WS-ASSOC-CERT-SEQU      PIC S99             VALUE ZEROS.
   242     12  WS-ASSOCIATED-CERTS     PIC S9      COMP-3  VALUE +0.
   243     12  WS-DIAGNOSIS            PIC X(60)   VALUE SPACES.
   244     12  WS-ICD-CODE-1           PIC X(8).
   245     12  WS-ICD-CODE-2           PIC X(8).
   246     12  WS-CLAIM-SEQU.
   247         16  FILLER              PIC X VALUE '('.
   248         16  WS-CURRENT-SEQU     PIC Z9.
   249         16  FILLER              PIC X(04) VALUE ' OF '.
   250         16  WS-OF-SEQU          PIC Z9.
   251         16  FILLER              PIC X VALUE ')'.
   252     12  WS-EDIT-BEN-CODE        PIC XX.
   253         88  INVALID-BENEFIT-CODE   VALUE '  ' '00'
   254                                          '90' THRU '99'.
   255
   256     12  WS-EDIT-AMT             PIC ZZZ,ZZZ.99.
   257     12  WS-EDIT-NUMBER          PIC ZZZ9.
   258
   259     12  WS-RESPONSE             PIC S9(8)   COMP.
   260         88  WS-RESP-NORMAL              VALUE +00.
   261         88  WS-RESP-ERROR               VALUE +01.
   262         88  WS-RESP-NOTFND              VALUE +13.
   263         88  WS-RESP-DUPKEY              VALUE +15.
   264         88  WS-RESP-NOTOPEN             VALUE +19.
   265         88  WS-RESP-ENDFILE             VALUE +20.
   266
   267     12  WS-MOS-PAID             PIC 999.
   268     12  WS-ODD-DAYS             PIC 99.
   269     12  WS-REM-MOS              PIC 999.
   270     12  WS-REM-DAYS             PIC 99.
   271     12  WS-TERM-IN-DAYS         PIC 9(4).
   272     12  WS-REM-TERM-IN-DAYS     PIC 9(4).
   273
   274     12  WS-BROWSE-SW            PIC X       VALUE 'N'.
   275     12  WS-UPDATE-SW            PIC X       VALUE 'N'.
   276     12  WS-OPEN-CLOSE-SW        PIC X       VALUE ' '.
   277     12  WS-RESET-SW             PIC X       VALUE 'N'.
   278     12  WS-REC-FOUND-SW         PIC X       VALUE 'N'.
   279     12  WS-DMO-LENGTH           PIC S9(4)   VALUE +108 COMP.
   280     12  WS-DCT-LENGTH           PIC S9(4)   VALUE +53 COMP.
   281
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page   7
* EL131.cbl
   282 01  DMD-DATE-YYYYMMDD.
   283     12  DMD-DECADE          PIC XX      VALUE SPACES.
   284     12  DMD-YYMMDD.
   285         16  DMD-YY          PIC XX      VALUE SPACES.
   286         16  DMD-MM          PIC XX      VALUE SPACES.
   287         16  DMD-DD          PIC XX      VALUE SPACES.
   288
   289 01  DMD-DATE-MMDDYYYY.
   290     12  DMD-MDY-MM          PIC XX      VALUE SPACES.
   291     12  DMD-MDY-SLASH1      PIC X       VALUE '/'.
   292     12  DMD-MDY-DD          PIC XX      VALUE SPACES.
   293     12  DMD-MDY-SLASH2      PIC X       VALUE '/'.
   294     12  DMD-MDY-DECADE      PIC XX      VALUE SPACES.
   295     12  DMD-MDY-YY          PIC XX      VALUE SPACES.
   296
   297 01  WS-MAIL-CODE.
   298     12  FILLER              PIC X.
   299     12  DMD-MAIL-CODE.
   300         16  WS-MAIL-4       PIC X(4).
   301         16  WS-MAIL-5       PIC X.
   302     12  FILLER              PIC X(4).
   303
   304     12  W-NAME-LAST             PIC  X(15).
   305     12  W-NAME-FIRST            PIC  X(15).
   306     12  W-NAME-MIDDLE.
   307         16  FILLER              PIC  X.
   308         16  W-NAME-MIDDLE-2     PIC  X.
   309         16  FILLER              PIC  X(13).
   310
   311*    COPY ELCDCTB.
   312******************************************************************
   313*                                                                *
   314*                                                                *
   315*                            ELCDCTB.                            *
   316*                            VMOD=2.002                          *
   317*                                                                *
   318*   DESCRIPTION = DISTRIBUTION CONTROL TABLE MAINTENANCE PROGRAM *
   319*       COMMUNICATIONS AREA                                      *
   320*                                                                *
   321******************************************************************
   322 01  DCT-COMMUNICATION-AREA.
   323     12  DCT-BILLING-BANK-ID      PIC  X(05).
   324     12  DCT-LOGIC-BENEFICIARY-ID PIC  X(10).
   325     12  DCT-CREDIT-CARD-NUMBER   PIC  X(16).
   326     12  DCT-PRODUCT-CODE         PIC  X(02).
   327     12  DCT-COLUMN-ID-REQUESTED  PIC  X(02).
   328     12  DCT-RETURN-CODE          PIC  X(02).
   329     12  DCT-MAIL-CODE            PIC  X(05).
   330     12  DCT-DISTRIBUTION-CODE    PIC  X(04).
   331     12  DCT-MSA-ACCT-NO          PIC  X(07).
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page   8
* EL131.cbl
   333 01  ERROR-SWITCHES.
   334     12  ERROR-SWITCH            PIC X.
   335         88  SCREEN-ERROR                    VALUE 'X'.
   336     12  MSTR-KEY-SWITCH         PIC X.
   337         88  MSTR-KEY-CHANGED                VALUE 'X'.
   338     12  CERT-KEY-SWITCH         PIC X.
   339*********SET TO X IF ALTERNATE INDEXES WILL CHANGE
   340         88  CERT-ALT-KEY-CHANGED            VALUE 'X'.
   341*********SET TO Y IF PRIMARY KEY WILL CHANGE
   342         88  CERT-KEY-CHANGED                VALUE 'Y'.
   343     12  MSTR-SWITCH             PIC X.
   344         88  MSTR-UPDATES                    VALUE 'X'.
   345     12  crtt-switch             pic x value spaces.
   346         88  crtt-update             value 'X'.
   347     12  CERT-SWITCH             PIC X.
   348         88  CERT-UPDATES                    VALUE 'X'.
   349     12  UPDATE-SWITCH           PIC X.
   350         88  UPDATES-PRESENT                 VALUE 'X'.
   351     12  TRLR-SWITCH             PIC X.
   352         88  TRLR-UPDATE-REQUIRED            VALUE 'X'.
   353         88  UPDATE-MADE                     VALUE 'Y'.
   354     12  NINETY-TRLR-SWITCH      PIC X.
   355         88  NINETY-TRLR-UPDATED             VALUE 'X'.
   356     12  NINETY5-TRLR-SWITCH      PIC X  VALUE ' '.
   357         88  NINETY5-TRLR-UPDATED             VALUE 'X'.
   358     12  EARNINGS-CALC-SWITCH    PIC X.
   359         88  TEX-REG                         VALUE '4'.
   360         88  NET-PAY                         VALUE '5'.
   361     12  DLYACTV-SW              PIC X       VALUE 'N'.
   362         88  DLYACTV-RECORD-NEEDED           VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page   9
* EL131.cbl
   364 01  EDIT-WORK-AREA.
   365     12  COUNT-2                 PIC 9.
   366     12  CALL-PGM                PIC X(8).
   367     12  TRANS-ID                PIC X(4).
   368     12  CHECK-PFKEYS            PIC 99.
   369     12  CHECK-MAINT             PIC X.
   370         88  ADD-ALPHA-RECORD                VALUE 'A'.
   371         88  CHANGE-CLAIM                    VALUE 'C'.
   372         88  DELETE-CLAIM                    VALUE 'D'.
   373         88  CHANGE-NAME                     VALUE 'N'.
   374         88  VALID-OPTIONS                   VALUE 'A' 'C'
   375                                                   'D' 'N'.
   376
   377     12  HOLD-BENEFIT            PIC XX.
   378     12  HOLD-FREQ               PIC XX.
   379     12  HOLD-REPORTED           PIC XX  VALUE LOW-VALUES.
   380     12  HOLD-INCUR              PIC XX  VALUE LOW-VALUES.
   381     12  HOLD-PDTHRU             PIC XX.
   382     12  HOLD-ADDON              PIC XX.
   383     12  HOLD-NODAYS             PIC 9(4).
   384     12  HOLD-NOPMTS             PIC 9(3).
   385     12  HOLD-PDAMT              PIC 9(7)V99    COMP-3.
   386     12  HOLD-LOANBAL            PIC 9(7)V99    COMP-3  VALUE 0.
   387     12  HOLD-APR                PIC 9(3)V9(4)  COMP-3  VALUE 0.
   388     12  HOLD-BIRTH              PIC XX.
   389     12  HOLD-END                PIC XX.
   390     12  HOLD-EFF                PIC XX.
   391     12  HOLD-ENTRY              PIC XX.
   392     12  HOLD-LF-CV-BEN          PIC S9(9)V99   COMP-3  VALUE +0.
   393     12  HOLD-LF-RATE            PIC S9(4)V99   COMP-3  VALUE +0.
   394     12  HOLD-AH-CV-BEN          PIC S9(9)V99   COMP-3  VALUE +0.
   395     12  HOLD-AH-RATE            PIC S9(4)V99   COMP-3  VALUE +0.
   396     12  HOLD-LF-CV-CAN          PIC XX.
   397     12  HOLD-AH-CV-CAN          PIC XX.
   398     12  DIVIDE-QUOT             PIC 9(3).
   399     12  DIVIDE-REM              PIC 9(3).
   400
   401     12  WS-ALPHA-DATE.
   402         16  WS-ALPHA-YEAR.
   403             20  WS-ALPHA-YY-1   PIC 99.
   404             20  WS-ALPHA-YY-2   PIC 99.
   405         16  WS-ALPHA-MM         PIC 99.
   406         16  WS-ALPHA-DD         PIC 99.
   407
   408     12  BUILD-VALID-DATE.
   409         16  BUILD-MONTH         PIC 99.
   410         16  BUILD-DAY           PIC 99.
   411         16  BUILD-YEAR          PIC 99.
   412     12  DEEDIT-MMYY-INPUT.
   413         16  FILLER              PIC X.
   414         16  DEEDIT-MONTH        PIC XX.
   415         16  DEEDIT-YEAR         PIC XX.
   416     12  DEEDIT-BEN              PIC 9(9)V99.
   417     12  DEEDIT-DATE-INPUT.
   418         16  FILLER              PIC XX.
   419         16  DEEDIT-DATE         PIC X(6).
   420     12  WORK-DATE-MDY.
   421         16  MONTH-WORK          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page  10
* EL131.cbl
   422         16  FILLER              PIC X(4).
   423         16  YEAR-WORK           PIC XX.
   424     12  WORK-DATE-MY.
   425         16  WORK-MONTH          PIC XX.
   426         16  WORK-SLASH          PIC X       VALUE '/'.
   427         16  WORK-YEAR           PIC XX.
   428     12  HOLD-DATE.
   429         16  HOLD-MONTH          PIC 99.
   430         16  FILLER              PIC X(4).
   431         16  HOLD-YEAR           PIC 99.
   432     12  SPLIT-INFO-LINE-1.
   433         16  SPLIT-INFO-DESC     PIC X(15).
   434         16  FILLER              PIC X(5)    VALUE ' OLD='.
   435         16  SPLIT-INFO-OLD      PIC X(40).
   436     12  EFF-TERM-MO             PIC 9(4).
   437     12  CURR-MO                 PIC 9(4).
   438     12  WS-BIN-CURRENT-DT       PIC XX.
   439     12  WS-CALC-METHOD          PIC X.
   440     12  WS-INITIALS.
   441         16  WS-INIT-1           PIC X.
   442         16  WS-INIT-2           PIC X.
   443     12  WS-REIN-TABLE.
   444         16  WS-REIN-1           PIC X.
   445         16  WS-REIN-2           PIC X.
   446         16  WS-REIN-3           PIC X.
   447     12  PI-KEY.
   448         16  PI-TERM             PIC X(4).
   449         16  PI-QUAL             PIC X(4).
   450     12  CHECK-KEY               PIC X(20).
   451     12  SAVE-ACCT-KEY           PIC X(20).
   452     12  SKIP-ATTRIBUTE          PIC X      VALUE SPACES.
   453     12  WS-SOC-SEC-NUMBER.
   454         16  WS-SOC-SEC-NO       PIC 9(9).
   455         16  WS-SOC-SEC-BLANK    PIC X(2).
   456     12  WS-SOC-SEC-REDEF REDEFINES WS-SOC-SEC-NUMBER.
   457         16  WS-SSN-1-3          PIC 9(3).
   458         16  WS-SSN-DASH1        PIC X(1).
   459         16  WS-SSN-4-5          PIC 9(2).
   460         16  WS-SSN-DASH2        PIC X(1).
   461         16  WS-SSN-6-9          PIC 9(4).
   462     12  AUTO-PAY-TO-BENE        PIC X     VALUE 'N'.
   463     12  WS-RETURNED-FROM        PIC X(8)  VALUE SPACES.
   464
   465 01  WS-SAVE-FIELDS.
   466     12  WS-SAVE-BENEFICIARY     PIC X(10) VALUE LOW-VALUES.
   467     12  WS-SAVE-MAINTI          PIC X(1) VALUE LOW-VALUES.
   468     12  WS-SAVE-MAINTL          PIC S9(4) COMP VALUE +0.
   469     12  WS-SAVE-STATUSI         PIC X(6) VALUE LOW-VALUES.
   470     12  WS-SAVE-STATUSL         PIC S9(4) COMP VALUE +0.
   471     12  WS-SAVE-REPI            PIC X(8) VALUE LOW-VALUES.
   472     12  WS-SAVE-REPL            PIC S9(4) COMP VALUE +0.
   473     12  WS-SAVE-CAUSEI          PIC X(6) VALUE LOW-VALUES.
   474     12  WS-SAVE-CAUSEL          PIC S9(4) COMP VALUE +0.
   475     12  WS-SAVE-ENDI            PIC X(8) VALUE LOW-VALUES.
   476     12  WS-SAVE-ENDL            PIC S9(4) COMP VALUE +0.
   477     12  WS-SAVE-DIAGI           PIC X(60) VALUE LOW-VALUES.
   478     12  WS-SAVE-DIAGL           PIC S9(4) COMP VALUE +0.
   479     12  WS-SAVE-ICD1I           PIC X(8)  VALUE LOW-VALUES.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page  11
* EL131.cbl
   480     12  WS-SAVE-ICD1L           PIC S9(4) COMP VALUE +0.
   481     12  WS-SAVE-ICD2I           PIC X(8)  VALUE LOW-VALUES.
   482     12  WS-SAVE-ICD2L           PIC S9(4) COMP VALUE +0.
   483     12  WS-SAVE-BENEI           PIC X(10) VALUE LOW-VALUES.
   484     12  WS-SAVE-BENEL           PIC S9(4) COMP VALUE +0.
   485     12  WS-SAVE-BIRTHI          PIC X(8) VALUE LOW-VALUES.
   486     12  WS-SAVE-BIRTHL          PIC S9(4) COMP VALUE +0.
   487     12  WS-SAVE-SOCIALI         PIC X(11) VALUE LOW-VALUES.
   488     12  WS-SAVE-SOCIALL         PIC S9(4) COMP VALUE +0.
   489     12  WS-SAVE-SEXI            PIC X(1) VALUE LOW-VALUES.
   490     12  WS-SAVE-SEXL            PIC S9(4) COMP VALUE +0.
   491     12  WS-SAVE-MLNAMEI         PIC X(15) VALUE LOW-VALUES.
   492     12  WS-SAVE-MLNAMEL         PIC S9(4) COMP VALUE +0.
   493     12  WS-SAVE-MFNAMEI         PIC X(12) VALUE LOW-VALUES.
   494     12  WS-SAVE-MFNAMEL         PIC S9(4) COMP VALUE +0.
   495     12  WS-SAVE-MMINITI         PIC X(1) VALUE LOW-VALUES.
   496     12  WS-SAVE-MMINITL         PIC S9(4) COMP VALUE +0.
   497     12  WS-SAVE-LOANNOI         PIC X(8) VALUE LOW-VALUES.
   498     12  WS-SAVE-LOANNOL         PIC S9(4) COMP VALUE +0.
   499     12  WS-SAVE-LOANBALI        PIC 9(7)V99 VALUE ZEROS.
   500     12  WS-SAVE-LOANBALL        PIC S9(4) COMP VALUE +0.
   501     12  WS-SAVE-PROCI           PIC X(4) VALUE LOW-VALUES.
   502     12  WS-SAVE-PROCL           PIC S9(4) COMP VALUE +0.
   503     12  WS-SAVE-SUPVI           PIC X(1) VALUE LOW-VALUES.
   504     12  WS-SAVE-SUPVL           PIC S9(4) COMP VALUE +0.
   505     12  WS-SAVE-PRICDI          PIC X(1) VALUE LOW-VALUES.
   506     12  WS-SAVE-PRICDL          PIC S9(4) COMP VALUE +0.
   507     12  WS-SAVE-FILETOI         PIC X(4) VALUE LOW-VALUES.
   508     12  WS-SAVE-FILETOL         PIC S9(4) COMP VALUE +0.
   509     12  WS-SAVE-PDTHRUI         PIC X(8) VALUE LOW-VALUES.
   510     12  WS-SAVE-PDTHRUL         PIC S9(4) COMP VALUE +0.
   511     12  WS-SAVE-PDAMTI          PIC 9(7)V99 VALUE ZEROS.
   512     12  WS-SAVE-PDAMTL          PIC S9(4) COMP VALUE +0.
   513     12  WS-SAVE-NODAYSI         PIC 9(5) VALUE ZEROS.
   514     12  WS-SAVE-NODAYSL         PIC S9(4) COMP VALUE +0.
   515     12  WS-SAVE-NOPMTSI         PIC 9(4) VALUE ZEROS.
   516     12  WS-SAVE-NOPMTSL         PIC S9(4) COMP VALUE +0.
   517     12  WS-SAVE-FORMTYPI        PIC X(1) VALUE LOW-VALUES.
   518     12  WS-SAVE-FORMTYPL        PIC S9(4) COMP VALUE +0.
   519     12  WS-SAVE-OCCI            PIC X(6) VALUE LOW-VALUES.
   520     12  WS-SAVE-OCCL            PIC S9(4) COMP VALUE +0.
   521
   522 01  TERM-CALCULATION-WORK-AREA     COMP-3.
   523     12  M                   PIC S9(7)V99           VALUE ZEROS.
   524     12  L                   PIC S9(7)V99           VALUE ZEROS.
   525     12  N                   PIC S9(3)              VALUE ZEROS.
   526     12  N-STORE             PIC S9(3)              VALUE ZEROS.
   527     12  NV-STORE            PIC S9(3)              VALUE ZEROS.
   528     12  I                   PIC S99V9(5)           VALUE ZEROS.
   529     12  A-N                 PIC S9(7)V9(8)         VALUE ZEROS.
   530     12  IA-N                PIC S9(7)V9(8)         VALUE ZEROS.
   531     12  V                   PIC S9(3)V9(14)        VALUE ZEROS.
   532     12  R                   PIC S9(3)              VALUE ZEROS.
   533     12  M1                  PIC S9(7)V99           VALUE ZEROS.
   534     12  V-EX-N              PIC S9(3)V9(14)        VALUE ZEROS.
   535     12  TERM1               PIC S9(8)V9(9)         VALUE ZEROS.
   536     12  TERM2               PIC S9(8)V9(9)         VALUE ZEROS.
   537     12  TERM3               PIC S9(8)V9(9)         VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page  12
* EL131.cbl
   538     12  TERM4               PIC S9(3)V9(14)        VALUE ZEROS.
   539     12  LEFT-TOT-1          PIC S9(9)V9(8)         VALUE ZEROS.
   540     12  RIGHT-TOT-1         PIC S9(9)V9(8)         VALUE ZEROS.
   541     12  RIGHT-TOT-2         PIC S9(9)V9(8)         VALUE ZEROS.
   542
   543 01  TERM-CALC-WORK-AREA.
   544     12  WS-AH-RATE          PIC S999V9(5)          VALUE ZEROS.
   545     12  WS-LF-RATE          PIC S999V9(5)          VALUE ZEROS.
   546     12  WS-TERM             PIC S9(3)              VALUE ZEROS.
   547     12  WS-TERM-REM         PIC S9(3)V99           VALUE ZEROS.
   548     12  WS-REMAIN           PIC S99                VALUE ZEROS.
   549     12  V-EXPONENTS.
   550        14  V-EXPONENT       PIC S9(3)V9(14) COMP-3 OCCURS 250.
   551     12  V-EX-ONETIME        PIC 9                  VALUE 1.
   552
   553 01  TIME-IN.
   554     12  UN-HOURS                PIC XX.
   555     12  UN-MINUTES              PIC XX.
   556     12  FILLER                  PIC XX.
   557
   558 01  TIME-OUT.
   559     12  FOR-HOURS               PIC XX.
   560     12  FILLER                  PIC X       VALUE '.'.
   561     12  FOR-MINUTES             PIC XX.
   562
   563 01  ERROR-NUMBERS.
   564     12  ER-0000                 PIC X(4)    VALUE '0000'.
   565     12  ER-0004                 PIC X(4)    VALUE '0004'.
   566     12  ER-0008                 PIC X(4)    VALUE '0008'.
   567     12  ER-0023                 PIC X(4)    VALUE '0023'.
   568     12  ER-0029                 PIC X(4)    VALUE '0029'.
   569     12  ER-0068                 PIC X(4)    VALUE '0068'.
   570     12  ER-0070                 PIC X(4)    VALUE '0070'.
   571     12  ER-0149                 PIC X(4)    VALUE '0149'.
   572     12  ER-0154                 PIC X(4)    VALUE '0154'.
   573     12  ER-0169                 PIC X(4)    VALUE '0169'.
   574     12  ER-0192                 PIC X(4)    VALUE '0192'.
   575     12  ER-0199                 PIC X(4)    VALUE '0199'.
   576     12  ER-0203                 PIC X(4)    VALUE '0203'.
   577     12  ER-0204                 PIC X(4)    VALUE '0204'.
   578     12  ER-0205                 PIC X(4)    VALUE '0205'.
   579     12  ER-0206                 PIC X(4)    VALUE '0206'.
   580     12  ER-0208                 PIC X(4)    VALUE '0208'.
   581     12  ER-0210                 PIC X(4)    VALUE '0210'.
   582     12  ER-0215                 PIC X(4)    VALUE '0215'.
   583     12  ER-0219                 PIC X(4)    VALUE '0219'.
   584     12  ER-0220                 PIC X(4)    VALUE '0220'.
   585     12  ER-0222                 PIC X(4)    VALUE '0222'.
   586     12  ER-0223                 PIC X(4)    VALUE '0223'.
   587     12  ER-0224                 PIC X(4)    VALUE '0224'.
   588     12  ER-0227                 PIC X(4)    VALUE '0227'.
   589     12  ER-0230                 PIC X(4)    VALUE '0230'.
   590     12  ER-0232                 PIC X(4)    VALUE '0232'.
   591     12  ER-0233                 PIC X(4)    VALUE '0233'.
   592     12  ER-0236                 PIC X(4)    VALUE '0236'.
   593     12  ER-0237                 PIC X(4)    VALUE '0237'.
   594     12  ER-0238                 PIC X(4)    VALUE '0238'.
   595     12  ER-0240                 PIC X(4)    VALUE '0240'.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page  13
* EL131.cbl
   596     12  ER-0241                 PIC X(4)    VALUE '0241'.
   597     12  ER-0243                 PIC X(4)    VALUE '0243'.
   598     12  ER-0244                 PIC X(4)    VALUE '0244'.
   599     12  ER-0246                 PIC X(4)    VALUE '0246'.
   600     12  ER-0247                 PIC X(4)    VALUE '0247'.
   601     12  ER-0248                 PIC X(4)    VALUE '0248'.
   602     12  ER-0250                 PIC X(4)    VALUE '0250'.
   603     12  ER-0251                 PIC X(4)    VALUE '0251'.
   604     12  ER-0253                 PIC X(4)    VALUE '0253'.
   605     12  ER-0256                 PIC X(4)    VALUE '0256'.
   606     12  ER-0257                 PIC X(4)    VALUE '0257'.
   607     12  ER-0258                 PIC X(4)    VALUE '0258'.
   608     12  ER-0259                 PIC X(4)    VALUE '0259'.
   609     12  ER-0260                 PIC X(4)    VALUE '0260'.
   610     12  ER-0261                 PIC X(4)    VALUE '0261'.
   611     12  ER-0262                 PIC X(4)    VALUE '0262'.
   612     12  ER-0263                 PIC X(4)    VALUE '0263'.
   613     12  ER-0273                 PIC X(4)    VALUE '0273'.
   614     12  ER-0274                 PIC X(4)    VALUE '0274'.
   615     12  ER-0276                 PIC X(4)    VALUE '0276'.
   616     12  ER-0282                 PIC X(4)    VALUE '0282'.
   617     12  ER-0283                 PIC X(4)    VALUE '0283'.
   618     12  ER-0309                 PIC X(4)    VALUE '0309'.
   619     12  ER-0310                 PIC X(4)    VALUE '0310'.
   620     12  ER-0311                 PIC X(4)    VALUE '0311'.
   621     12  ER-0333                 PIC X(4)    VALUE '0333'.
   622     12  ER-0360                 PIC X(4)    VALUE '0360'.
   623     12  ER-0377                 PIC X(4)    VALUE '0377'.
   624     12  ER-0402                 PIC X(4)    VALUE '0402'.
   625     12  ER-0416                 PIC X(4)    VALUE '0416'.
   626     12  ER-0426                 PIC X(4)    VALUE '0426'.
   627     12  ER-0427                 PIC X(4)    VALUE '0427'.
   628     12  ER-0428                 PIC X(4)    VALUE '0428'.
   629     12  ER-0429                 PIC X(4)    VALUE '0429'.
   630     12  ER-0430                 PIC X(4)    VALUE '0430'.
   631     12  ER-0458                 PIC X(4)    VALUE '0458'.
   632     12  ER-0475                 PIC X(4)    VALUE '0475'.
   633     12  ER-0491                 PIC X(4)    VALUE '0491'.
   634     12  ER-0509                 PIC X(4)    VALUE '0509'.
   635     12  ER-0510                 PIC X(4)    VALUE '0510'.
   636     12  ER-0511                 PIC X(4)    VALUE '0511'.
   637     12  ER-0512                 PIC X(4)    VALUE '0512'.
   638     12  ER-0519                 PIC X(4)    VALUE '0519'.
   639     12  ER-0520                 PIC X(4)    VALUE '0520'.
   640     12  ER-0521                 PIC X(4)    VALUE '0521'.
   641     12  ER-0547                 PIC X(4)    VALUE '0547'.
   642     12  ER-0548                 PIC X(4)    VALUE '0548'.
   643     12  ER-0549                 PIC X(4)    VALUE '0549'.
   644     12  ER-0565                 PIC X(4)    VALUE '0565'.
   645     12  ER-0598                 PIC X(4)    VALUE '0598'.
   646     12  ER-0639                 PIC X(4)    VALUE '0639'.
   647     12  ER-0797                 PIC X(4)    VALUE '0797'.
   648     12  ER-0802                 PIC X(4)    VALUE '0802'.
   649     12  ER-0803                 PIC X(4)    VALUE '0803'.
   650     12  ER-0849                 PIC X(4)    VALUE '0849'.
   651     12  ER-0885                 PIC X(4)    VALUE '0885'.
   652     12  ER-0887                 PIC X(4)    VALUE '0887'.
   653     12  ER-0919                 PIC X(4)    VALUE '0919'.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page  14
* EL131.cbl
   654     12  ER-0921                 PIC X(4)    VALUE '0921'.
   655     12  ER-0938                 PIC X(4)    VALUE '0938'.
   656     12  ER-0946                 PIC X(4)    VALUE '0946'.
   657     12  ER-0947                 PIC X(4)    VALUE '0947'.
   658     12  ER-0948                 PIC X(4)    VALUE '0948'.
   659     12  ER-0949                 PIC X(4)    VALUE '0949'.
   660     12  ER-0950                 PIC X(4)    VALUE '0950'.
   661     12  ER-0951                 PIC X(4)    VALUE '0951'.
   662     12  ER-0954                 PIC X(4)    VALUE '0954'.
   663     12  ER-0974                 PIC X(4)    VALUE '0974'.
   664     12  ER-0975                 PIC X(4)    VALUE '0975'.
   665     12  ER-0992                 PIC X(4)    VALUE '0992'.
   666     12  er-1581                 pic x(4)    value '1581'.
   667     12  ER-1651                 PIC X(4)    VALUE '1651'.
   668     12  ER-1652                 PIC X(4)    VALUE '1652'.
   669     12  ER-1653                 PIC X(4)    VALUE '1653'.
   670     12  ER-1654                 PIC X(4)    VALUE '1654'.
   671     12  ER-1655                 PIC X(4)    VALUE '1655'.
   672     12  er-1656                 pic x(4)    value '1656'.
   673     12  ER-1661                 PIC X(4)    VALUE '1661'.
   674     12  ER-1662                 PIC X(4)    VALUE '1662'.
   675     12  ER-1663                 PIC X(4)    VALUE '1663'.
   676     12  er-1664                 pic x(4)    value '1664'.
   677     12  er-1665                 pic x(4)    value '1665'.
   678     12  er-1666                 pic x(4)    value '1666'.
   679     12  er-1668                 pic x(4)    value '1668'.
   680     12  er-1669                 pic x(4)    value '1669'.
   681     12  er-1676                 pic x(4)    value '1676'.
   682     12  ER-1678                 PIC X(4)    VALUE '1678'.
   683     12  ER-1772                 PIC X(4)    VALUE '1772'.
   684     12  ER-1773                 PIC X(4)    VALUE '1773'.
   685     12  ER-1778                 PIC X(4)    VALUE '1778'.
   686     12  ER-2280                 PIC X(4)    VALUE '2280'.
   687     12  ER-2878                 PIC X(4)    VALUE '2878'.
   688     12  ER-7641                 PIC X(4)    VALUE '7641'.
   689     12  ER-7642                 PIC X(4)    VALUE '7642'.
   690     12  ER-7650                 PIC X(4)    VALUE '7650'.
   691     12  ER-7651                 PIC X(4)    VALUE '7651'.
   692     12  ER-7687                 PIC X(4)    VALUE '7687'.
   693     12  ER-7689                 PIC X(4)    VALUE '7689'.
   694     12  ER-7690                 PIC X(4)    VALUE '7690'.
   695     12  ER-7691                 PIC X(4)    VALUE '7691'.
   696     12  ER-8003                 PIC X(4)    VALUE '8003'.
   697     12  ER-8051                 PIC X(4)    VALUE '8051'.
   698     12  ER-8052                 PIC X(4)    VALUE '8052'.
   699     12  ER-8053                 PIC X(4)    VALUE '8053'.
   700     12  ER-8054                 PIC X(4)    VALUE '8054'.
   701     12  ER-8055                 PIC X(4)    VALUE '8055'.
   702     12  ER-8056                 PIC X(4)    VALUE '8056'.
   703     12  ER-8057                 PIC X(4)    VALUE '8057'.
   704     12  ER-8058                 PIC X(4)    VALUE '8058'.
   705     12  ER-8059                 PIC X(4)    VALUE '8059'.
   706     12  ER-8060                 PIC X(4)    VALUE '8060'.
   707     12  ER-8061                 PIC X(4)    VALUE '8061'.
   708     12  ER-8062                 PIC X(4)    VALUE '8062'.
   709     12  ER-8063                 PIC X(4)    VALUE '8063'.
   710     12  ER-8064                 PIC X(4)    VALUE '8064'.
   711     12  ER-8065                 PIC X(4)    VALUE '8065'.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page  15
* EL131.cbl
   712     12  ER-8066                 PIC X(4)    VALUE '8066'.
   713     12  ER-8152                 PIC X(4)    VALUE '8152'.
   714     12  ER-8153                 PIC X(4)    VALUE '8153'.
   715     12  ER-8154                 PIC X(4)    VALUE '8154'.
   716     12  ER-8155                 PIC X(4)    VALUE '8155'.
   717 01  ERPDEF-KEY-SAVE             PIC X(18).
   718 01  ERPDEF-KEY.
   719     12  ERPDEF-COMPANY-CD       PIC X.
   720     12  ERPDEF-STATE            PIC XX.
   721     12  ERPDEF-PROD-CD          PIC XXX.
   722     12  F                       PIC X(7).
   723     12  ERPDEF-BEN-TYPE         PIC X.
   724     12  ERPDEF-BEN-CODE         PIC XX.
   725     12  ERPDEF-EXP-DT           PIC XX.
   726 01  MSTR-KEY.
   727     12  COMPANY-CODE            PIC X.
   728     12  CARRIER-CODE            PIC X.
   729     12  CLAIM-NO                PIC X(7).
   730     12  CERT-NO.
   731         16  CERT-NO-PRIME       PIC X(10).
   732         16  CERT-NO-SUFX        PIC X.
   733
   734 01  WS-SAVE-CLAIM-KEY.
   735     12  WS-SAVE-COMPANY-CD      PIC X.
   736     12  WS-SAVE-CARRIER         PIC X.
   737     12  WS-SAVE-CLAIM-NO        PIC X(7).
   738     12  WS-SAVE-CERT-NO.
   739         16  WS-CERT-NO-PRIME    PIC X(10).
   740         16  WS-CERT-NO-SUFX     PIC X.
   741
   742 01  CERT-KEY.
   743     12  CERT-COMPANY-CODE       PIC X.
   744     12  CERT-CARRIER            PIC X.
   745     12  CERT-GROUP              PIC X(6).
   746     12  CERT-STATE              PIC XX.
   747     12  CERT-ACCOUNT            PIC X(10).
   748     12  CERT-DATE               PIC XX.
   749     12  CERT-CERT.
   750         16  CERT-CERT-PRIME     PIC X(10).
   751         16  CERT-CERT-SUFX      PIC X.
   752
   753 01  ELCRTT-KEY.
   754     05  CTRLR-COMP-CD       PIC X.
   755     05  CTRLR-CARRIER       PIC X.
   756     05  CTRLR-GROUPING      PIC X(6).
   757     05  CTRLR-STATE         PIC X(2).
   758     05  CTRLR-ACCOUNT       PIC X(10).
   759     05  CTRLR-EFF-DT        PIC XX.
   760     05  CTRLR-CERT-NO       PIC X(11).
   761     05  CTRLR-REC-TYPE      PIC X.
   762 01  NOTE-KEY.
   763     12  NOTE-COMP-CD            PIC X.
   764     12  NOTE-CERT-KEY.
   765         16  NOTE-CARRIER        PIC X.
   766         16  NOTE-GROUP          PIC X(6).
   767         16  NOTE-STATE          PIC XX.
   768         16  NOTE-ACCOUNT        PIC X(10).
   769         16  NOTE-DATE           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page  16
* EL131.cbl
   770         16  NOTE-CERT-NO        PIC X(11).
   771
   772 01  TRLR-KEY.
   773     12  TRLR-MAIN-KEY.
   774         16  TRLR-COMPANY-CD     PIC X.
   775         16  TRLR-CARRIER        PIC X.
   776         16  TRLR-CLAIM-NO       PIC X(07).
   777         16  TRLR-CERT-NO        PIC X(11).
   778     12  TRLR-SEQ-NO             PIC S9(4)   COMP.
   779
   780 01  BENEFIT-KEY.
   781     12  BEN-CO-ID               PIC X(3).
   782     12  BEN-REC-TYPE            PIC X.
   783     12  FILLER                  PIC XX.
   784     12  BEN-ACC-CD              PIC XX.
   785     12  BEN-SEQ-NO              PIC S9(4)   COMP.
   786
   787 01  CNTL-KEY.
   788     12  CNTL-CO-ID              PIC X(3).
   789     12  CNTL-REC-TYPE           PIC X.
   790     12  CNTL-PROC-ID            PIC X(4).
   791     12  CNTL-STATE-ACCESS REDEFINES CNTL-PROC-ID.
   792         16  CNTL-STATE-NUMBER   PIC XX.
   793         16  FILLER              PIC XX.
   794     12  CNTL-CARRIER-ACCESS REDEFINES CNTL-PROC-ID.
   795         16  FILLER              PIC X(3).
   796         16  CNTL-CARRIER        PIC X.
   797     12  CNTL-SEQ-NO             PIC S9(4)   COMP.
   798
   799 01  ACTQ-KEY                    PIC X(20).
   800
   801 01  WS-LAST-TRLR-KEY            PIC X(22)  VALUE SPACES.
   802
   803 01  CHKQ-KEY.
   804     12  CHKQ-COMPANY-CODE       PIC X.
   805     12  CHKQ-CONTROL-NO         PIC S9(8)  COMP.
   806     12  CHKQ-SEQ-NO             PIC S9(4)  COMP.
   807
   808 01  ARCH-KEY.
   809     12  ARCH-COMPANY-CODE       PIC X.
   810     12  ARCH-ARCHIVE-NO         PIC S9(8)  COMP.
   811     12  ARCH-RECORD-TYPE        PIC X.
   812     12  ARCH-SEQ-NO             PIC S9(4)  COMP.
   813
   814 01  ACCT-KEY.
   815     05  ACCT-PARTIAL-KEY.
   816         12  ACCT-COMPANY-CODE   PIC X.
   817         12  ACCT-CARRIER        PIC X.
   818         12  ACCT-GROUP          PIC X(6).
   819         12  ACCT-STATE          PIC XX.
   820         12  ACCT-ACCOUNT        PIC X(10).
   821     05  ACCT-DATE               PIC XX.
   822
   823 01  WS-ELBENE-KEY.
   824     12  WS-ELBENE-COMPANY-CD    PIC X.
   825     12  WS-ELBENE-RECORD-TYPE   PIC X.
   826     12  WS-ELBENE-ID            PIC X(10).
   827
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page  17
* EL131.cbl
   828 01  ELALPH-KEY.
   829     12  ELALPH-COMPANY-CD       PIC X.
   830     12  ELALPH-SOURCE           PIC X.
   831     12  ELALPH-NAME.
   832         16  ELALPH-LAST-NAME    PIC X(15).
   833         16  ELALPH-FIRST-NAME.
   834             20  ELALPH-FIRST-INIT   PIC X.
   835             20  FILLER              PIC X(11).
   836         16  ELALPH-MIDDLE-INIT  PIC X.
   837     12  ELALPH-DATE             PIC X(08).
   838     12  ELALPH-TIME             PIC S9(04)    COMP.
   839
   840 01  COMP-LENGTHS.
   841     12  CNTL-GENERIC-LENGTH     PIC S9(4)   COMP VALUE +8.
   842     12  JOURNAL-LENGTH          PIC S9(4)   COMP VALUE +0.
   843     12  DATE-LENGTH             PIC S9(4)   COMP VALUE +8.
   844     12  MO-YR-LENGTH            PIC S9(4)   COMP VALUE +5.
   845     12  TERM-LENGTH             PIC S9(4)   COMP VALUE +3.
   846     12  BEN-LENGTH              PIC S9(4)   COMP VALUE +11.
   847     12  FREQ-LENGTH             PIC S9(4)   COMP VALUE +2.
   848     12  MSTR-LENGTH             PIC S9(4)   COMP VALUE +350.
   849     12  CERT-LENGTH             PIC S9(4)   COMP VALUE +450.
   850     12  TRLR-LENGTH             PIC S9(4)   COMP VALUE +200.
   851     12  ACTQ-LENGTH             PIC S9(4)   COMP VALUE +60.
   852     12  CHKQ-LENGTH             PIC S9(4)   COMP VALUE +100.
   853     12  ARCH-LENGTH             PIC S9(4)   COMP VALUE +90.
   854     12  ALPH-LENGTH             PIC S9(4)   COMP VALUE +128.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page  18
* EL131.cbl
   856*                                COPY ELCLNKLT.
   857******************************************************************
   858*                                                                *
   859*                                                                *
   860*                           ELCLNKLT                             *
   861*                            VMOD=2.003                          *
   862*                                                                *
   863*   THIS COPY BOOK IS USED TO PASS DATA TO THE LETTER GENERATOR  *
   864*   PROGRAM (EL1523). THE AREA SHOULD BE INITIALIZED TO LOW-     *
   865*   VALUES BEFORE ENTERING YOUR INFORMATION.                     *
   866*                                                                *
   867*   MOVE THE PROGRAM-INTERFACE-BLOCK TO W-1523-LINK-DATA BEFORE  *
   868*   COMPLETING THE REQUIRED FIELDS.                              *
   869*                                                                *
   870*   THE CALLING PROGRAM SHOULD CHECK:                            *
   871*   1. W-1523-ERROR-CODE WHERE 0000 INDICATES NO ERROR DETECTED. *
   872*                              9999 INDICATES AN UNKNOWN ABEND   *
   873*                                   WAS DETECTED.                *
   874*                              ALL OTHER VALUES ARE NORMAL ERROR *
   875*                              CODES FOUND IN THE ERROR FILE.    *
   876******************************************************************
   877 01  W-1523-LINKDATA.
   878     12  W-1523-COMMON-PI-DATA.
   879         16  W-1523-COMM-LENGTH  PIC S9(04) COMP   VALUE +1024.
   880         16  FILLER              PIC  X(67).
   881         16  W-1523-COMPANY-CD   PIC  X(01).
   882         16  FILLER              PIC  X(10).
   883         16  W-1523-CONTROL-IN-PROGRESS.
   884             20  W-1523-CARRIER  PIC  X(01).
   885             20  W-1523-GROUPING PIC  X(06).
   886             20  W-1523-STATE    PIC  X(02).
   887             20  W-1523-ACCOUNT  PIC  X(10).
   888             20  W-1523-CLAIM-CERT-GRP.
   889                 24  W-1523-CLAIM-NO
   890                                 PIC  X(07).
   891                 24  W-1523-CERT-NO.
   892                     28  W-1523-CERT-PRIME
   893                                 PIC  X(10).
   894                     28  W-1523-CERT-SFX
   895                                 PIC  X(01).
   896                 24  W-1523-CERT-EFF-DT
   897                                 PIC  X(02).
   898         16  FILLER              PIC X(265).
   899
   900     12  W-1523-WORK-AREA.
   901         16  W-1523-FORM-NUMBER  PIC  X(04).
   902         16  W-1523-NUMBER-COPIES
   903                                 PIC  9(01).
   904         16  W-1523-ADDR-TYPE    PIC  X(02).
   905         16  W-1523-FOLLOW-UP-DATE
   906                                 PIC  X(02).
   907         16  W-1523-RESEND-DATE  PIC  X(02).
   908         16  W-1523-ERROR-CODE   PIC  9(04).
   909             88  W-1523-NO-ERRORS-DETECTED VALUE 0000.
   910             88  W-1523-FATAL-ERROR
   911                                    VALUES  0006 0013 0042
   912                                            0154 0168 0169
   913                                            0176 9999 0172
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page  19
* EL131.cbl
   914                                            0179 0186 0281
   915                                            0332 2055 3697
   916                                            3698 3699 3770
   917                                            3771 3772 7675
   918                                            9106 9808 9883
   919                                            9887.
   920             88  W-1523-STOP-ERRORS
   921                                    VALUES  0013 0042 0154
   922                                            0168 0169 0172
   923                                            0281 0332 2055
   924                                            3698 3699 7675
   925                                            9106 9808 9883
   926                                            9999.
   927         16  W-1523-REASON       PIC  X(70).
   928         16  W-1523-ARCHIVE-NUMBER
   929                                 PIC  9(08).
   930     12  W-1523-POINTER-AREA.
   931         16  W-1523-ACCT-POINTER PIC S9(08) COMP.
   932         16  W-1523-ACTY-POINTER PIC S9(08) COMP.
   933         16  W-1523-ARCH-POINTER PIC S9(08) COMP.
   934         16  W-1523-VAR-POINTER  PIC S9(08) COMP.
   935         16  W-1523-PROD-POINTER PIC S9(08) COMP.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page  20
* EL131.cbl
   937*                                COPY ELCINTF.
   938******************************************************************
   939*                                                                *
   940*                                                                *
   941*                            ELCINTF.                            *
   942*                            VMOD=2.017                          *
   943*                                                                *
   944*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   945*                                                                *
   946*       LENGTH = 1024                                            *
   947*                                                                *
   948******************************************************************
   949*                   C H A N G E   L O G
   950*
   951* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   952*-----------------------------------------------------------------
   953*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   954* EFFECTIVE    NUMBER
   955*-----------------------------------------------------------------
   956* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   957******************************************************************
   958 01  PROGRAM-INTERFACE-BLOCK.
   959     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   960     12  PI-CALLING-PROGRAM              PIC X(8).
   961     12  PI-SAVED-PROGRAM-1              PIC X(8).
   962     12  PI-SAVED-PROGRAM-2              PIC X(8).
   963     12  PI-SAVED-PROGRAM-3              PIC X(8).
   964     12  PI-SAVED-PROGRAM-4              PIC X(8).
   965     12  PI-SAVED-PROGRAM-5              PIC X(8).
   966     12  PI-SAVED-PROGRAM-6              PIC X(8).
   967     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   968     12  PI-COMPANY-ID                   PIC XXX.
   969     12  PI-COMPANY-CD                   PIC X.
   970
   971     12  PI-COMPANY-PASSWORD             PIC X(8).
   972
   973     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   974
   975     12  PI-CONTROL-IN-PROGRESS.
   976         16  PI-CARRIER                  PIC X.
   977         16  PI-GROUPING                 PIC X(6).
   978         16  PI-STATE                    PIC XX.
   979         16  PI-ACCOUNT                  PIC X(10).
   980         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   981                                         PIC X(10).
   982         16  PI-CLAIM-CERT-GRP.
   983             20  PI-CLAIM-NO             PIC X(7).
   984             20  PI-CERT-NO.
   985                 25  PI-CERT-PRIME       PIC X(10).
   986                 25  PI-CERT-SFX         PIC X.
   987             20  PI-CERT-EFF-DT          PIC XX.
   988         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   989             20  PI-PLAN-CODE            PIC X(2).
   990             20  PI-REVISION-NUMBER      PIC X(3).
   991             20  PI-PLAN-EFF-DT          PIC X(2).
   992             20  PI-PLAN-EXP-DT          PIC X(2).
   993             20  FILLER                  PIC X(11).
   994         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page  21
* EL131.cbl
   995             20  PI-OE-REFERENCE-1.
   996                 25  PI-OE-REF-1-PRIME   PIC X(18).
   997                 25  PI-OE-REF-1-SUFF    PIC XX.
   998
   999     12  PI-SESSION-IN-PROGRESS          PIC X.
  1000         88  CLAIM-SESSION                   VALUE '1'.
  1001         88  CREDIT-SESSION                  VALUE '2'.
  1002         88  WARRANTY-SESSION                VALUE '3'.
  1003         88  MORTGAGE-SESSION                VALUE '4'.
  1004         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  1005
  1006
  1007*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  1008
  1009     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  1010     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  1011
  1012     12  PI-CREDIT-USER                  PIC X.
  1013         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  1014         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  1015
  1016     12  PI-CLAIM-USER                   PIC X.
  1017         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  1018         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  1019
  1020     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  1021         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  1022         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  1023         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  1024         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  1025         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  1026
  1027     12  PI-PROCESSOR-ID                 PIC X(4).
  1028
  1029     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  1030
  1031     12  PI-MEMBER-CAPTION               PIC X(10).
  1032
  1033     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1034         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  1035
  1036     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1037     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1038     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1039     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1040
  1041     12  PI-AH-OVERRIDE-L1               PIC X.
  1042     12  PI-AH-OVERRIDE-L2               PIC XX.
  1043     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1044     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1045
  1046     12  PI-NEW-SYSTEM                   PIC X(2).
  1047
  1048     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1049     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1050         88  PI-USES-PAID-TO                 VALUE '1'.
  1051     12  PI-CRDTCRD-SYSTEM.
  1052         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page  22
* EL131.cbl
  1053             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1054             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1055         16  PI-CC-MONTH-END-DT          PIC XX.
  1056     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1057
  1058     12  PI-OE-REFERENCE-2.
  1059         16  PI-OE-REF-2-PRIME           PIC X(10).
  1060         16  PI-OE-REF-2-SUFF            PIC X.
  1061
  1062     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1063
  1064     12  PI-LANGUAGE-TYPE                PIC X.
  1065             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1066             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1067             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1068
  1069     12  PI-POLICY-LINKAGE-IND           PIC X.
  1070         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1071         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1072                                                   LOW-VALUES.
  1073
  1074     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1075     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1076         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1077         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1078
  1079     12  PI-PROCESSOR-CSR-IND            PIC X.
  1080         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1081         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  1082
  1083     12  FILLER                          PIC X(3).
  1084
  1085     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1086
  1087     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1088         PI-SYSTEM-LEVEL.
  1089
  1090         16  PI-ENTRY-CODES.
  1091             20  PI-ENTRY-CD-1           PIC X.
  1092             20  PI-ENTRY-CD-2           PIC X.
  1093
  1094         16  PI-RETURN-CODES.
  1095             20  PI-RETURN-CD-1          PIC X.
  1096             20  PI-RETURN-CD-2          PIC X.
  1097
  1098         16  PI-UPDATE-STATUS-SAVE.
  1099             20  PI-UPDATE-BY            PIC X(4).
  1100             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1101
  1102         16  PI-LOWER-CASE-LETTERS       PIC X.
  1103             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1104
  1105*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1106*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1107*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1108
  1109         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1110             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page  23
* EL131.cbl
  1111             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1112             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1113             88  ACCNT-CNTL                  VALUE '3'.
  1114             88  CARR-ACCNT-CNTL             VALUE '4'.
  1115
  1116         16  PI-PROCESSOR-CAP-LIST.
  1117             20  PI-SYSTEM-CONTROLS.
  1118                24 PI-SYSTEM-DISPLAY     PIC X.
  1119                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1120                24 PI-SYSTEM-MODIFY      PIC X.
  1121                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1122             20  FILLER                  PIC XX.
  1123             20  PI-DISPLAY-CAP          PIC X.
  1124                 88  DISPLAY-CAP             VALUE 'Y'.
  1125             20  PI-MODIFY-CAP           PIC X.
  1126                 88  MODIFY-CAP              VALUE 'Y'.
  1127             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1128                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1129             20  PI-FORCE-CAP            PIC X.
  1130                 88  FORCE-CAP               VALUE 'Y'.
  1131
  1132         16  PI-PROGRAM-CONTROLS.
  1133             20  PI-PGM-PRINT-OPT        PIC X.
  1134             20  PI-PGM-FORMAT-OPT       PIC X.
  1135             20  PI-PGM-PROCESS-OPT      PIC X.
  1136             20  PI-PGM-TOTALS-OPT       PIC X.
  1137
  1138         16  PI-HELP-INTERFACE.
  1139             20  PI-LAST-ERROR-NO        PIC X(4).
  1140             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1141
  1142         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1143             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1144
  1145         16  PI-CR-CONTROL-IN-PROGRESS.
  1146             20  PI-CR-CARRIER           PIC X.
  1147             20  PI-CR-GROUPING          PIC X(6).
  1148             20  PI-CR-STATE             PIC XX.
  1149             20  PI-CR-ACCOUNT           PIC X(10).
  1150             20  PI-CR-FIN-RESP          PIC X(10).
  1151             20  PI-CR-TYPE              PIC X.
  1152
  1153         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1154
  1155         16  PI-CR-MONTH-END-DT          PIC XX.
  1156
  1157         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1158             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1159             88  PI-ZERO-CARRIER             VALUE '1'.
  1160             88  PI-ZERO-GROUPING            VALUE '2'.
  1161             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1162
  1163         16  PI-CARRIER-SECURITY         PIC X.
  1164             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1165
  1166         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1167             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1168             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page  24
* EL131.cbl
  1169
  1170         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1171             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1172                                         INDEXED BY PI-ACCESS-NDX
  1173                                         PIC X.
  1174
  1175         16  PI-GA-BILLING-CONTROL       PIC X.
  1176             88  PI-GA-BILLING               VALUE '1'.
  1177
  1178         16  PI-MAIL-PROCESSING          PIC X.
  1179             88  PI-MAIL-YES                 VALUE 'Y'.
  1180
  1181         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1182
  1183         16  PI-AR-SYSTEM.
  1184             20  PI-AR-PROCESSING-CNTL   PIC X.
  1185                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1186             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1187             20  PI-AR-MONTH-END-DT      PIC XX.
  1188
  1189         16  PI-MP-SYSTEM.
  1190             20  PI-MORTGAGE-USER            PIC X.
  1191                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1192                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1193             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1194                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1195                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1196                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1197                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1198                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1199             20  PI-MP-MONTH-END-DT          PIC XX.
  1200             20  PI-MP-REFERENCE-NO.
  1201                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1202                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1203
  1204         16  PI-LABEL-CONTROL            PIC X(01).
  1205             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1206             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1207
  1208         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1209             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1210
  1211         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1212             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1213             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1214
  1215         16  FILLER                      PIC X(14).
  1216
  1217     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1218******************************************************************
  1219     12  EL131-WORK-AREA REDEFINES PI-PROGRAM-WORK-AREA.
  1220         16  PI-NO-PMTS                    PIC 9(4).
  1221         16  PI-CERT-SWITCH                PIC X.
  1222             88  CREATED-CERT              VALUE '2'.
  1223         16  PI-PREM-TYPE                  PIC X.
  1224         16  PI-SAVE-CERT-NO.
  1225             20  PI-SAVE-CERT-NO-PRIME     PIC X(10).
  1226             20  PI-SAVE-CERT-NO-SUFX      PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page  25
* EL131.cbl
  1227         16  FILLER                        PIC X(46).
  1228         16  PI-CLAIM-DELETED-SWITCH       PIC X(1).
  1229         16  PI-PAYMENT-AMT                PIC S9(7)V99   COMP-3.
  1230         16  PI-REC-FOUND-SW               PIC X.
  1231         16  PI-LETTER-SW                  PIC X.
  1232         16  PI-PREV-TRLR-KEY              PIC X(22).
  1233         16  pi-claim-type                 pic x.
  1234         16  PI-AUTO-PAY-SEQ               PIC S9(4)      COMP.
  1235         16  pi-approval-level             pic x.
  1236         16  FILLER                        PIC X(543).
  1237
  1238 01  SAVE-RECORD                 PIC X(450).
  1239
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page  26
* EL131.cbl
  1241*                                COPY ELCLOGOF SUPPRESS.
  1242******************************************************************
  1243*                                                                *
  1244*                                                                *
  1245*                            ELCLOGOF.                           *
  1246*                            VMOD=2.001                          *
  1247*                                                                *
  1248*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  1249*                                                                *
  1250******************************************************************
  1251 01  CLASIC-LOGOFF.
  1252     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  1253     12  LOGOFF-TEXT.
  1254         16  FILLER          PIC X(5)    VALUE SPACES.
  1255         16  LOGOFF-MSG.
  1256             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  1257             20  FILLER      PIC X       VALUE SPACES.
  1258             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  1259         16  FILLER          PIC X(80)
  1260           VALUE '* YOU ARE NOW LOGGED OFF'.
  1261         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  1262         16  FILLER          PIC X       VALUE QUOTE.
  1263         16  LOGOFF-SYS-MSG  PIC X(17)
  1264           VALUE 'S CLAS-IC SYSTEM '.
  1265     12  TEXT-MESSAGES.
  1266         16  UNACCESS-MSG    PIC X(29)
  1267             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  1268         16  PGMIDERR-MSG    PIC X(17)
  1269             VALUE 'PROGRAM NOT FOUND'.
  1270
  1271*                                COPY ELCATTR SUPPRESS.
  1272******************************************************************
  1273*                                                                *
  1274*                            ELCATTR.                            *
  1275*                            VMOD=2.001                          *
  1276*                                                                *
  1277*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  1278*                                                                *
  1279*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  1280*                                                                *
  1281*                   POS 1   P=PROTECTED                          *
  1282*                           U=UNPROTECTED                        *
  1283*                           S=ASKIP                              *
  1284*                   POS 2   A=ALPHA/NUMERIC                      *
  1285*                           N=NUMERIC                            *
  1286*                   POS 3   N=NORMAL                             *
  1287*                           B=BRIGHT                             *
  1288*                           D=DARK                               *
  1289*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  1290*                           OF=MODIFIED DATA TAG OFF             *
  1291*                                                                *
  1292*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  1293******************************************************************
  1294 01  ATTRIBUTE-LIST.
  1295     12  AL-PABOF            PIC X       VALUE 'Y'.
  1296     12  AL-PABON            PIC X       VALUE 'Z'.
  1297     12  AL-PADOF            PIC X       VALUE '%'.
  1298     12  AL-PADON            PIC X       VALUE '_'.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page  27
* EL131.cbl
  1299     12  AL-PANOF            PIC X       VALUE '-'.
  1300     12  AL-PANON            PIC X       VALUE '/'.
  1301     12  AL-SABOF            PIC X       VALUE '8'.
  1302     12  AL-SABON            PIC X       VALUE '9'.
  1303     12  AL-SADOF            PIC X       VALUE '@'.
  1304     12  AL-SADON            PIC X       VALUE QUOTE.
  1305     12  AL-SANOF            PIC X       VALUE '0'.
  1306     12  AL-SANON            PIC X       VALUE '1'.
  1307     12  AL-UABOF            PIC X       VALUE 'H'.
  1308     12  AL-UABON            PIC X       VALUE 'I'.
  1309     12  AL-UADOF            PIC X       VALUE '<'.
  1310     12  AL-UADON            PIC X       VALUE '('.
  1311     12  AL-UANOF            PIC X       VALUE ' '.
  1312     12  AL-UANON            PIC X       VALUE 'A'.
  1313     12  AL-UNBOF            PIC X       VALUE 'Q'.
  1314     12  AL-UNBON            PIC X       VALUE 'R'.
  1315     12  AL-UNDOF            PIC X       VALUE '*'.
  1316     12  AL-UNDON            PIC X       VALUE ')'.
  1317     12  AL-UNNOF            PIC X       VALUE '&'.
  1318     12  AL-UNNON            PIC X       VALUE 'J'.
  1319
  1320*                                COPY ELCAID SUPPRESS.
  1321******************************************************************
  1322*                                                                *
  1323*                            ELCAID.                             *
  1324*                            VMOD=2.001                          *
  1325*                                                                *
  1326*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1327*                                                                *
  1328*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1329*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1330******************************************************************
  1331
  1332 01  DFHAID.
  1333   02  DFHNULL   PIC  X  VALUE  ' '.
  1334   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1335   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1336   02  DFHPEN    PIC  X  VALUE  '='.
  1337   02  DFHOPID   PIC  X  VALUE  'W'.
  1338   02  DFHPA1    PIC  X  VALUE  '%'.
  1339   02  DFHPA2    PIC  X  VALUE  '>'.
  1340   02  DFHPA3    PIC  X  VALUE  ','.
  1341   02  DFHPF1    PIC  X  VALUE  '1'.
  1342   02  DFHPF2    PIC  X  VALUE  '2'.
  1343   02  DFHPF3    PIC  X  VALUE  '3'.
  1344   02  DFHPF4    PIC  X  VALUE  '4'.
  1345   02  DFHPF5    PIC  X  VALUE  '5'.
  1346   02  DFHPF6    PIC  X  VALUE  '6'.
  1347   02  DFHPF7    PIC  X  VALUE  '7'.
  1348   02  DFHPF8    PIC  X  VALUE  '8'.
  1349   02  DFHPF9    PIC  X  VALUE  '9'.
  1350   02  DFHPF10   PIC  X  VALUE  ':'.
  1351   02  DFHPF11   PIC  X  VALUE  '#'.
  1352   02  DFHPF12   PIC  X  VALUE  '@'.
  1353   02  DFHPF13   PIC  X  VALUE  'A'.
  1354   02  DFHPF14   PIC  X  VALUE  'B'.
  1355   02  DFHPF15   PIC  X  VALUE  'C'.
  1356   02  DFHPF16   PIC  X  VALUE  'D'.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page  28
* EL131.cbl
  1357   02  DFHPF17   PIC  X  VALUE  'E'.
  1358   02  DFHPF18   PIC  X  VALUE  'F'.
  1359   02  DFHPF19   PIC  X  VALUE  'G'.
  1360   02  DFHPF20   PIC  X  VALUE  'H'.
  1361   02  DFHPF21   PIC  X  VALUE  'I'.
  1362*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1363   02  DFHPF22   PIC  X  VALUE  '['.
  1364   02  DFHPF23   PIC  X  VALUE  '.'.
  1365   02  DFHPF24   PIC  X  VALUE  '<'.
  1366   02  DFHMSRE   PIC  X  VALUE  'X'.
  1367   02  DFHSTRF   PIC  X  VALUE  'h'.
  1368   02  DFHTRIG   PIC  X  VALUE  '"'.
  1369 01  FILLER REDEFINES DFHAID.
  1370     12  FILLER                  PIC X(8).
  1371     12  AID-KEYS OCCURS 24 TIMES.
  1372         16  FILLER              PIC X.
  1373
  1374*                                COPY EL131S.
  1375 01  EL131AI.
  1376     05  FILLER            PIC  X(0012).
  1377*    -------------------------------
  1378     05  DATEL PIC S9(0004) COMP.
  1379     05  DATEF PIC  X(0001).
  1380     05  FILLER REDEFINES DATEF.
  1381         10  DATEA PIC  X(0001).
  1382     05  DATEI PIC  X(0008).
  1383*    -------------------------------
  1384     05  TIMEL PIC S9(0004) COMP.
  1385     05  TIMEF PIC  X(0001).
  1386     05  FILLER REDEFINES TIMEF.
  1387         10  TIMEA PIC  X(0001).
  1388     05  TIMEI PIC  X(0005).
  1389*    -------------------------------
  1390     05  SEQUL PIC S9(0004) COMP.
  1391     05  SEQUF PIC  X(0001).
  1392     05  FILLER REDEFINES SEQUF.
  1393         10  SEQUA PIC  X(0001).
  1394     05  SEQUI PIC  X(0010).
  1395*    -------------------------------
  1396     05  COMPL PIC S9(0004) COMP.
  1397     05  COMPF PIC  X(0001).
  1398     05  FILLER REDEFINES COMPF.
  1399         10  COMPA PIC  X(0001).
  1400     05  COMPI PIC  X(0003).
  1401*    -------------------------------
  1402     05  USERIDL PIC S9(0004) COMP.
  1403     05  USERIDF PIC  X(0001).
  1404     05  FILLER REDEFINES USERIDF.
  1405         10  USERIDA PIC  X(0001).
  1406     05  USERIDI PIC  X(0004).
  1407*    -------------------------------
  1408     05  LABEL1L PIC S9(0004) COMP.
  1409     05  LABEL1F PIC  X(0001).
  1410     05  FILLER REDEFINES LABEL1F.
  1411         10  LABEL1A PIC  X(0001).
  1412     05  LABEL1I PIC  X(0011).
  1413*    -------------------------------
  1414     05  PCERTNOL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page  29
* EL131.cbl
  1415     05  PCERTNOF PIC  X(0001).
  1416     05  FILLER REDEFINES PCERTNOF.
  1417         10  PCERTNOA PIC  X(0001).
  1418     05  PCERTNOI PIC  X(0010).
  1419*    -------------------------------
  1420     05  PSUFXL PIC S9(0004) COMP.
  1421     05  PSUFXF PIC  X(0001).
  1422     05  FILLER REDEFINES PSUFXF.
  1423         10  PSUFXA PIC  X(0001).
  1424     05  PSUFXI PIC  X(0001).
  1425*    -------------------------------
  1426     05  CCNOL PIC S9(0004) COMP.
  1427     05  CCNOF PIC  X(0001).
  1428     05  FILLER REDEFINES CCNOF.
  1429         10  CCNOA PIC  X(0001).
  1430     05  CCNOI PIC  X(0016).
  1431*    -------------------------------
  1432     05  MAINTL PIC S9(0004) COMP.
  1433     05  MAINTF PIC  X(0001).
  1434     05  FILLER REDEFINES MAINTF.
  1435         10  MAINTA PIC  X(0001).
  1436     05  MAINTI PIC  X(0001).
  1437*    -------------------------------
  1438     05  CLAIML PIC S9(0004) COMP.
  1439     05  CLAIMF PIC  X(0001).
  1440     05  FILLER REDEFINES CLAIMF.
  1441         10  CLAIMA PIC  X(0001).
  1442     05  CLAIMI PIC  X(0007).
  1443*    -------------------------------
  1444     05  CARRL PIC S9(0004) COMP.
  1445     05  CARRF PIC  X(0001).
  1446     05  FILLER REDEFINES CARRF.
  1447         10  CARRA PIC  X(0001).
  1448     05  CARRI PIC  X(0001).
  1449*    -------------------------------
  1450     05  CERTL PIC S9(0004) COMP.
  1451     05  CERTF PIC  X(0001).
  1452     05  FILLER REDEFINES CERTF.
  1453         10  CERTA PIC  X(0001).
  1454     05  CERTI PIC  X(0010).
  1455*    -------------------------------
  1456     05  SUFXL PIC S9(0004) COMP.
  1457     05  SUFXF PIC  X(0001).
  1458     05  FILLER REDEFINES SUFXF.
  1459         10  SUFXA PIC  X(0001).
  1460     05  SUFXI PIC  X(0001).
  1461*    -------------------------------
  1462     05  TYPEL PIC S9(0004) COMP.
  1463     05  TYPEF PIC  X(0001).
  1464     05  FILLER REDEFINES TYPEF.
  1465         10  TYPEA PIC  X(0001).
  1466     05  TYPEI PIC  X(0001).
  1467*    -------------------------------
  1468     05  BENPERL PIC S9(0004) COMP.
  1469     05  BENPERF PIC  X(0001).
  1470     05  FILLER REDEFINES BENPERF.
  1471         10  BENPERA PIC  X(0001).
  1472     05  BENPERI PIC  99.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page  30
* EL131.cbl
  1473*    -------------------------------
  1474     05  INSTYPEL PIC S9(0004) COMP.
  1475     05  INSTYPEF PIC  X(0001).
  1476     05  FILLER REDEFINES INSTYPEF.
  1477         10  INSTYPEA PIC  X(0001).
  1478     05  INSTYPEI PIC  X(0001).
  1479*    -------------------------------
  1480     05  STATUSL PIC S9(0004) COMP.
  1481     05  STATUSF PIC  X(0001).
  1482     05  FILLER REDEFINES STATUSF.
  1483         10  STATUSA PIC  X(0001).
  1484     05  STATUSI PIC  X(0006).
  1485*    -------------------------------
  1486     05  INCL PIC S9(0004) COMP.
  1487     05  INCF PIC  X(0001).
  1488     05  FILLER REDEFINES INCF.
  1489         10  INCA PIC  X(0001).
  1490     05  INCI PIC  X(0008).
  1491*    -------------------------------
  1492     05  REPL PIC S9(0004) COMP.
  1493     05  REPF PIC  X(0001).
  1494     05  FILLER REDEFINES REPF.
  1495         10  REPA PIC  X(0001).
  1496     05  REPI PIC  X(0008).
  1497*    -------------------------------
  1498     05  ICD1L PIC S9(0004) COMP.
  1499     05  ICD1F PIC  X(0001).
  1500     05  FILLER REDEFINES ICD1F.
  1501         10  ICD1A PIC  X(0001).
  1502     05  ICD1I PIC  X(0008).
  1503*    -------------------------------
  1504     05  ICD2L PIC S9(0004) COMP.
  1505     05  ICD2F PIC  X(0001).
  1506     05  FILLER REDEFINES ICD2F.
  1507         10  ICD2A PIC  X(0001).
  1508     05  ICD2I PIC  X(0008).
  1509*    -------------------------------
  1510     05  DIAGL PIC S9(0004) COMP.
  1511     05  DIAGF PIC  X(0001).
  1512     05  FILLER REDEFINES DIAGF.
  1513         10  DIAGA PIC  X(0001).
  1514     05  DIAGI PIC  X(0060).
  1515*    -------------------------------
  1516     05  ACCSWL PIC S9(0004) COMP.
  1517     05  ACCSWF PIC  X(0001).
  1518     05  FILLER REDEFINES ACCSWF.
  1519         10  ACCSWA PIC  X(0001).
  1520     05  ACCSWI PIC  X(0001).
  1521*    -------------------------------
  1522     05  BENEL PIC S9(0004) COMP.
  1523     05  BENEF PIC  X(0001).
  1524     05  FILLER REDEFINES BENEF.
  1525         10  BENEA PIC  X(0001).
  1526     05  BENEI PIC  X(0010).
  1527*    -------------------------------
  1528     05  BIRTHL PIC S9(0004) COMP.
  1529     05  BIRTHF PIC  X(0001).
  1530     05  FILLER REDEFINES BIRTHF.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page  31
* EL131.cbl
  1531         10  BIRTHA PIC  X(0001).
  1532     05  BIRTHI PIC  X(0008).
  1533*    -------------------------------
  1534     05  SOCIALL PIC S9(0004) COMP.
  1535     05  SOCIALF PIC  X(0001).
  1536     05  FILLER REDEFINES SOCIALF.
  1537         10  SOCIALA PIC  X(0001).
  1538     05  SOCIALI PIC  X(0011).
  1539*    -------------------------------
  1540     05  SEXL PIC S9(0004) COMP.
  1541     05  SEXF PIC  X(0001).
  1542     05  FILLER REDEFINES SEXF.
  1543         10  SEXA PIC  X(0001).
  1544     05  SEXI PIC  X(0001).
  1545*    -------------------------------
  1546     05  MLNAMEL PIC S9(0004) COMP.
  1547     05  MLNAMEF PIC  X(0001).
  1548     05  FILLER REDEFINES MLNAMEF.
  1549         10  MLNAMEA PIC  X(0001).
  1550     05  MLNAMEI PIC  X(0015).
  1551*    -------------------------------
  1552     05  MFNAMEL PIC S9(0004) COMP.
  1553     05  MFNAMEF PIC  X(0001).
  1554     05  FILLER REDEFINES MFNAMEF.
  1555         10  MFNAMEA PIC  X(0001).
  1556     05  MFNAMEI PIC  X(0012).
  1557*    -------------------------------
  1558     05  MMINITL PIC S9(0004) COMP.
  1559     05  MMINITF PIC  X(0001).
  1560     05  FILLER REDEFINES MMINITF.
  1561         10  MMINITA PIC  X(0001).
  1562     05  MMINITI PIC  X(0001).
  1563*    -------------------------------
  1564     05  AUTHRCVL PIC S9(0004) COMP.
  1565     05  AUTHRCVF PIC  X(0001).
  1566     05  FILLER REDEFINES AUTHRCVF.
  1567         10  AUTHRCVA PIC  X(0001).
  1568     05  AUTHRCVI PIC  X(0001).
  1569*    -------------------------------
  1570     05  CRTLNMEL PIC S9(0004) COMP.
  1571     05  CRTLNMEF PIC  X(0001).
  1572     05  FILLER REDEFINES CRTLNMEF.
  1573         10  CRTLNMEA PIC  X(0001).
  1574     05  CRTLNMEI PIC  X(0015).
  1575*    -------------------------------
  1576     05  CRTFNMEL PIC S9(0004) COMP.
  1577     05  CRTFNMEF PIC  X(0001).
  1578     05  FILLER REDEFINES CRTFNMEF.
  1579         10  CRTFNMEA PIC  X(0001).
  1580     05  CRTFNMEI PIC  X(0012).
  1581*    -------------------------------
  1582     05  CRTINITL PIC S9(0004) COMP.
  1583     05  CRTINITF PIC  X(0001).
  1584     05  FILLER REDEFINES CRTINITF.
  1585         10  CRTINITA PIC  X(0001).
  1586     05  CRTINITI PIC  X(0001).
  1587*    -------------------------------
  1588     05  LOANBALL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page  32
* EL131.cbl
  1589     05  LOANBALF PIC  X(0001).
  1590     05  FILLER REDEFINES LOANBALF.
  1591         10  LOANBALA PIC  X(0001).
  1592     05  LOANBALI PIC  9(7)V99.
  1593*    -------------------------------
  1594     05  PROCL PIC S9(0004) COMP.
  1595     05  PROCF PIC  X(0001).
  1596     05  FILLER REDEFINES PROCF.
  1597         10  PROCA PIC  X(0001).
  1598     05  PROCI PIC  X(0004).
  1599*    -------------------------------
  1600     05  SUPVL PIC S9(0004) COMP.
  1601     05  SUPVF PIC  X(0001).
  1602     05  FILLER REDEFINES SUPVF.
  1603         10  SUPVA PIC  X(0001).
  1604     05  SUPVI PIC  X(0001).
  1605*    -------------------------------
  1606     05  PRICDL PIC S9(0004) COMP.
  1607     05  PRICDF PIC  X(0001).
  1608     05  FILLER REDEFINES PRICDF.
  1609         10  PRICDA PIC  X(0001).
  1610     05  PRICDI PIC  X(0001).
  1611*    -------------------------------
  1612     05  CRITPL PIC S9(0004) COMP.
  1613     05  CRITPF PIC  X(0001).
  1614     05  FILLER REDEFINES CRITPF.
  1615         10  CRITPA PIC  X(0001).
  1616     05  CRITPI PIC  X(0002).
  1617*    -------------------------------
  1618     05  EXTENSL PIC S9(0004) COMP.
  1619     05  EXTENSF PIC  X(0001).
  1620     05  FILLER REDEFINES EXTENSF.
  1621         10  EXTENSA PIC  X(0001).
  1622     05  EXTENSI PIC  99.
  1623*    -------------------------------
  1624     05  FILETOL PIC S9(0004) COMP.
  1625     05  FILETOF PIC  X(0001).
  1626     05  FILLER REDEFINES FILETOF.
  1627         10  FILETOA PIC  X(0001).
  1628     05  FILETOI PIC  X(0004).
  1629*    -------------------------------
  1630     05  PTHRHDGL PIC S9(0004) COMP.
  1631     05  PTHRHDGF PIC  X(0001).
  1632     05  FILLER REDEFINES PTHRHDGF.
  1633         10  PTHRHDGA PIC  X(0001).
  1634     05  PTHRHDGI PIC  X(0010).
  1635*    -------------------------------
  1636     05  PDTHRUL PIC S9(0004) COMP.
  1637     05  PDTHRUF PIC  X(0001).
  1638     05  FILLER REDEFINES PDTHRUF.
  1639         10  PDTHRUA PIC  X(0001).
  1640     05  PDTHRUI PIC  X(0008).
  1641*    -------------------------------
  1642     05  PDAMTL PIC S9(0004) COMP.
  1643     05  PDAMTF PIC  X(0001).
  1644     05  FILLER REDEFINES PDAMTF.
  1645         10  PDAMTA PIC  X(0001).
  1646     05  PDAMTI PIC  9(7)V99.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page  33
* EL131.cbl
  1647*    -------------------------------
  1648     05  NODAYSL PIC S9(0004) COMP.
  1649     05  NODAYSF PIC  X(0001).
  1650     05  FILLER REDEFINES NODAYSF.
  1651         10  NODAYSA PIC  X(0001).
  1652     05  NODAYSI PIC  9(5).
  1653*    -------------------------------
  1654     05  NOPMTSL PIC S9(0004) COMP.
  1655     05  NOPMTSF PIC  X(0001).
  1656     05  FILLER REDEFINES NOPMTSF.
  1657         10  NOPMTSA PIC  X(0001).
  1658     05  NOPMTSI PIC  9(4).
  1659*    -------------------------------
  1660     05  FORMTYPL PIC S9(0004) COMP.
  1661     05  FORMTYPF PIC  X(0001).
  1662     05  FILLER REDEFINES FORMTYPF.
  1663         10  FORMTYPA PIC  X(0001).
  1664     05  FORMTYPI PIC  X(0001).
  1665*    -------------------------------
  1666     05  ESTL PIC S9(0004) COMP.
  1667     05  ESTF PIC  X(0001).
  1668     05  FILLER REDEFINES ESTF.
  1669         10  ESTA PIC  X(0001).
  1670     05  ESTI PIC  X(0008).
  1671*    -------------------------------
  1672     05  AUIDL PIC S9(0004) COMP.
  1673     05  AUIDF PIC  X(0001).
  1674     05  FILLER REDEFINES AUIDF.
  1675         10  AUIDA PIC  X(0001).
  1676     05  AUIDI PIC  X(0004).
  1677*    -------------------------------
  1678     05  OCCL PIC S9(0004) COMP.
  1679     05  OCCF PIC  X(0001).
  1680     05  FILLER REDEFINES OCCF.
  1681         10  OCCA PIC  X(0001).
  1682     05  OCCI PIC  X(0006).
  1683*    -------------------------------
  1684     05  MNTDTL PIC S9(0004) COMP.
  1685     05  MNTDTF PIC  X(0001).
  1686     05  FILLER REDEFINES MNTDTF.
  1687         10  MNTDTA PIC  X(0001).
  1688     05  MNTDTI PIC  X(0008).
  1689*    -------------------------------
  1690     05  MNTTYPEL PIC S9(0004) COMP.
  1691     05  MNTTYPEF PIC  X(0001).
  1692     05  FILLER REDEFINES MNTTYPEF.
  1693         10  MNTTYPEA PIC  X(0001).
  1694     05  MNTTYPEI PIC  X(0006).
  1695*    -------------------------------
  1696     05  CERTCARL PIC S9(0004) COMP.
  1697     05  CERTCARF PIC  X(0001).
  1698     05  FILLER REDEFINES CERTCARF.
  1699         10  CERTCARA PIC  X(0001).
  1700     05  CERTCARI PIC  X(0001).
  1701*    -------------------------------
  1702     05  CERTGRPL PIC S9(0004) COMP.
  1703     05  CERTGRPF PIC  X(0001).
  1704     05  FILLER REDEFINES CERTGRPF.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page  34
* EL131.cbl
  1705         10  CERTGRPA PIC  X(0001).
  1706     05  CERTGRPI PIC  X(0006).
  1707*    -------------------------------
  1708     05  CERTSTL PIC S9(0004) COMP.
  1709     05  CERTSTF PIC  X(0001).
  1710     05  FILLER REDEFINES CERTSTF.
  1711         10  CERTSTA PIC  X(0001).
  1712     05  CERTSTI PIC  X(0002).
  1713*    -------------------------------
  1714     05  CERTACTL PIC S9(0004) COMP.
  1715     05  CERTACTF PIC  X(0001).
  1716     05  FILLER REDEFINES CERTACTF.
  1717         10  CERTACTA PIC  X(0001).
  1718     05  CERTACTI PIC  X(0010).
  1719*    -------------------------------
  1720     05  CERTEFFL PIC S9(0004) COMP.
  1721     05  CERTEFFF PIC  X(0001).
  1722     05  FILLER REDEFINES CERTEFFF.
  1723         10  CERTEFFA PIC  X(0001).
  1724     05  CERTEFFI PIC  X(0008).
  1725*    -------------------------------
  1726     05  ISSAGEL PIC S9(0004) COMP.
  1727     05  ISSAGEF PIC  X(0001).
  1728     05  FILLER REDEFINES ISSAGEF.
  1729         10  ISSAGEA PIC  X(0001).
  1730     05  ISSAGEI PIC  X(0002).
  1731*    -------------------------------
  1732     05  APRL PIC S9(0004) COMP.
  1733     05  APRF PIC  X(0001).
  1734     05  FILLER REDEFINES APRF.
  1735         10  APRA PIC  X(0001).
  1736     05  APRI PIC  9(4)V9(4).
  1737*    -------------------------------
  1738     05  PMTFREQL PIC S9(0004) COMP.
  1739     05  PMTFREQF PIC  X(0001).
  1740     05  FILLER REDEFINES PMTFREQF.
  1741         10  PMTFREQA PIC  X(0001).
  1742     05  PMTFREQI PIC  99.
  1743*    -------------------------------
  1744     05  INDGRPL PIC S9(0004) COMP.
  1745     05  INDGRPF PIC  X(0001).
  1746     05  FILLER REDEFINES INDGRPF.
  1747         10  INDGRPA PIC  X(0001).
  1748     05  INDGRPI PIC  X(0001).
  1749*    -------------------------------
  1750     05  PREMTYPL PIC S9(0004) COMP.
  1751     05  PREMTYPF PIC  X(0001).
  1752     05  FILLER REDEFINES PREMTYPF.
  1753         10  PREMTYPA PIC  X(0001).
  1754     05  PREMTYPI PIC  X(0001).
  1755*    -------------------------------
  1756     05  REINCDL PIC S9(0004) COMP.
  1757     05  REINCDF PIC  X(0001).
  1758     05  FILLER REDEFINES REINCDF.
  1759         10  REINCDA PIC  X(0001).
  1760     05  REINCDI PIC  X(0001).
  1761*    -------------------------------
  1762     05  JNTLNMEL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page  35
* EL131.cbl
  1763     05  JNTLNMEF PIC  X(0001).
  1764     05  FILLER REDEFINES JNTLNMEF.
  1765         10  JNTLNMEA PIC  X(0001).
  1766     05  JNTLNMEI PIC  X(0015).
  1767*    -------------------------------
  1768     05  JNTFNMEL PIC S9(0004) COMP.
  1769     05  JNTFNMEF PIC  X(0001).
  1770     05  FILLER REDEFINES JNTFNMEF.
  1771         10  JNTFNMEA PIC  X(0001).
  1772     05  JNTFNMEI PIC  X(0012).
  1773*    -------------------------------
  1774     05  JNTINITL PIC S9(0004) COMP.
  1775     05  JNTINITF PIC  X(0001).
  1776     05  FILLER REDEFINES JNTINITF.
  1777         10  JNTINITA PIC  X(0001).
  1778     05  JNTINITI PIC  X(0001).
  1779*    -------------------------------
  1780     05  JNTAGEL PIC S9(0004) COMP.
  1781     05  JNTAGEF PIC  X(0001).
  1782     05  FILLER REDEFINES JNTAGEF.
  1783         10  JNTAGEA PIC  X(0001).
  1784     05  JNTAGEI PIC  X(0002).
  1785*    -------------------------------
  1786     05  ADDONDTL PIC S9(0004) COMP.
  1787     05  ADDONDTF PIC  X(0001).
  1788     05  FILLER REDEFINES ADDONDTF.
  1789         10  ADDONDTA PIC  X(0001).
  1790     05  ADDONDTI PIC  X(0008).
  1791*    -------------------------------
  1792     05  LCVDSCRL PIC S9(0004) COMP.
  1793     05  LCVDSCRF PIC  X(0001).
  1794     05  FILLER REDEFINES LCVDSCRF.
  1795         10  LCVDSCRA PIC  X(0001).
  1796     05  LCVDSCRI PIC  X(0006).
  1797*    -------------------------------
  1798     05  LCVKINDL PIC S9(0004) COMP.
  1799     05  LCVKINDF PIC  X(0001).
  1800     05  FILLER REDEFINES LCVKINDF.
  1801         10  LCVKINDA PIC  X(0001).
  1802     05  LCVKINDI PIC  X(0003).
  1803*    -------------------------------
  1804     05  LCVCDL PIC S9(0004) COMP.
  1805     05  LCVCDF PIC  X(0001).
  1806     05  FILLER REDEFINES LCVCDF.
  1807         10  LCVCDA PIC  X(0001).
  1808     05  LCVCDI PIC  X(0002).
  1809*    -------------------------------
  1810     05  LCVOTRML PIC S9(0004) COMP.
  1811     05  LCVOTRMF PIC  X(0001).
  1812     05  FILLER REDEFINES LCVOTRMF.
  1813         10  LCVOTRMA PIC  X(0001).
  1814     05  LCVOTRMI PIC  999.
  1815*    -------------------------------
  1816     05  LCVRTRML PIC S9(0004) COMP.
  1817     05  LCVRTRMF PIC  X(0001).
  1818     05  FILLER REDEFINES LCVRTRMF.
  1819         10  LCVRTRMA PIC  X(0001).
  1820     05  LCVRTRMI PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page  36
* EL131.cbl
  1821*    -------------------------------
  1822     05  LCVRATEL PIC S9(0004) COMP.
  1823     05  LCVRATEF PIC  X(0001).
  1824     05  FILLER REDEFINES LCVRATEF.
  1825         10  LCVRATEA PIC  X(0001).
  1826     05  LCVRATEI PIC  9999V99.
  1827*    -------------------------------
  1828     05  LCVBENEL PIC S9(0004) COMP.
  1829     05  LCVBENEF PIC  X(0001).
  1830     05  FILLER REDEFINES LCVBENEF.
  1831         10  LCVBENEA PIC  X(0001).
  1832     05  LCVBENEI PIC  9(9)V99.
  1833*    -------------------------------
  1834     05  LCVFORML PIC S9(0004) COMP.
  1835     05  LCVFORMF PIC  X(0001).
  1836     05  FILLER REDEFINES LCVFORMF.
  1837         10  LCVFORMA PIC  X(0001).
  1838     05  LCVFORMI PIC  X(0012).
  1839*    -------------------------------
  1840     05  LCVCNDTL PIC S9(0004) COMP.
  1841     05  LCVCNDTF PIC  X(0001).
  1842     05  FILLER REDEFINES LCVCNDTF.
  1843         10  LCVCNDTA PIC  X(0001).
  1844     05  LCVCNDTI PIC  X(0008).
  1845*    -------------------------------
  1846     05  LCVEXITL PIC S9(0004) COMP.
  1847     05  LCVEXITF PIC  X(0001).
  1848     05  FILLER REDEFINES LCVEXITF.
  1849         10  LCVEXITA PIC  X(0001).
  1850     05  LCVEXITI PIC  X(0008).
  1851*    -------------------------------
  1852     05  LCVSTATL PIC S9(0004) COMP.
  1853     05  LCVSTATF PIC  X(0001).
  1854     05  FILLER REDEFINES LCVSTATF.
  1855         10  LCVSTATA PIC  X(0001).
  1856     05  LCVSTATI PIC  X(0006).
  1857*    -------------------------------
  1858     05  ACVDSCRL PIC S9(0004) COMP.
  1859     05  ACVDSCRF PIC  X(0001).
  1860     05  FILLER REDEFINES ACVDSCRF.
  1861         10  ACVDSCRA PIC  X(0001).
  1862     05  ACVDSCRI PIC  X(0006).
  1863*    -------------------------------
  1864     05  ACVKINDL PIC S9(0004) COMP.
  1865     05  ACVKINDF PIC  X(0001).
  1866     05  FILLER REDEFINES ACVKINDF.
  1867         10  ACVKINDA PIC  X(0001).
  1868     05  ACVKINDI PIC  X(0003).
  1869*    -------------------------------
  1870     05  ACVCDL PIC S9(0004) COMP.
  1871     05  ACVCDF PIC  X(0001).
  1872     05  FILLER REDEFINES ACVCDF.
  1873         10  ACVCDA PIC  X(0001).
  1874     05  ACVCDI PIC  X(0002).
  1875*    -------------------------------
  1876     05  ACVOTRML PIC S9(0004) COMP.
  1877     05  ACVOTRMF PIC  X(0001).
  1878     05  FILLER REDEFINES ACVOTRMF.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page  37
* EL131.cbl
  1879         10  ACVOTRMA PIC  X(0001).
  1880     05  ACVOTRMI PIC  999.
  1881*    -------------------------------
  1882     05  ACVRTRML PIC S9(0004) COMP.
  1883     05  ACVRTRMF PIC  X(0001).
  1884     05  FILLER REDEFINES ACVRTRMF.
  1885         10  ACVRTRMA PIC  X(0001).
  1886     05  ACVRTRMI PIC  X(0003).
  1887*    -------------------------------
  1888     05  ACVRATEL PIC S9(0004) COMP.
  1889     05  ACVRATEF PIC  X(0001).
  1890     05  FILLER REDEFINES ACVRATEF.
  1891         10  ACVRATEA PIC  X(0001).
  1892     05  ACVRATEI PIC  9999V99.
  1893*    -------------------------------
  1894     05  ACVBENEL PIC S9(0004) COMP.
  1895     05  ACVBENEF PIC  X(0001).
  1896     05  FILLER REDEFINES ACVBENEF.
  1897         10  ACVBENEA PIC  X(0001).
  1898     05  ACVBENEI PIC  9(9)V99.
  1899*    -------------------------------
  1900     05  ACVFORML PIC S9(0004) COMP.
  1901     05  ACVFORMF PIC  X(0001).
  1902     05  FILLER REDEFINES ACVFORMF.
  1903         10  ACVFORMA PIC  X(0001).
  1904     05  ACVFORMI PIC  X(0012).
  1905*    -------------------------------
  1906     05  ACVCNDTL PIC S9(0004) COMP.
  1907     05  ACVCNDTF PIC  X(0001).
  1908     05  FILLER REDEFINES ACVCNDTF.
  1909         10  ACVCNDTA PIC  X(0001).
  1910     05  ACVCNDTI PIC  X(0008).
  1911*    -------------------------------
  1912     05  ACVEXITL PIC S9(0004) COMP.
  1913     05  ACVEXITF PIC  X(0001).
  1914     05  FILLER REDEFINES ACVEXITF.
  1915         10  ACVEXITA PIC  X(0001).
  1916     05  ACVEXITI PIC  X(0008).
  1917*    -------------------------------
  1918     05  ACVSTATL PIC S9(0004) COMP.
  1919     05  ACVSTATF PIC  X(0001).
  1920     05  FILLER REDEFINES ACVSTATF.
  1921         10  ACVSTATA PIC  X(0001).
  1922     05  ACVSTATI PIC  X(0006).
  1923*    -------------------------------
  1924     05  LABEL2L PIC S9(0004) COMP.
  1925     05  LABEL2F PIC  X(0001).
  1926     05  FILLER REDEFINES LABEL2F.
  1927         10  LABEL2A PIC  X(0001).
  1928     05  LABEL2I PIC  X(0014).
  1929*    -------------------------------
  1930     05  BCERT1L PIC S9(0004) COMP.
  1931     05  BCERT1F PIC  X(0001).
  1932     05  FILLER REDEFINES BCERT1F.
  1933         10  BCERT1A PIC  X(0001).
  1934     05  BCERT1I PIC  X(0010).
  1935*    -------------------------------
  1936     05  BSUFX1L PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page  38
* EL131.cbl
  1937     05  BSUFX1F PIC  X(0001).
  1938     05  FILLER REDEFINES BSUFX1F.
  1939         10  BSUFX1A PIC  X(0001).
  1940     05  BSUFX1I PIC  X(0001).
  1941*    -------------------------------
  1942     05  BCERT2L PIC S9(0004) COMP.
  1943     05  BCERT2F PIC  X(0001).
  1944     05  FILLER REDEFINES BCERT2F.
  1945         10  BCERT2A PIC  X(0001).
  1946     05  BCERT2I PIC  X(0010).
  1947*    -------------------------------
  1948     05  BSUFX2L PIC S9(0004) COMP.
  1949     05  BSUFX2F PIC  X(0001).
  1950     05  FILLER REDEFINES BSUFX2F.
  1951         10  BSUFX2A PIC  X(0001).
  1952     05  BSUFX2I PIC  X(0001).
  1953*    -------------------------------
  1954     05  BCERT3L PIC S9(0004) COMP.
  1955     05  BCERT3F PIC  X(0001).
  1956     05  FILLER REDEFINES BCERT3F.
  1957         10  BCERT3A PIC  X(0001).
  1958     05  BCERT3I PIC  X(0010).
  1959*    -------------------------------
  1960     05  BSUFX3L PIC S9(0004) COMP.
  1961     05  BSUFX3F PIC  X(0001).
  1962     05  FILLER REDEFINES BSUFX3F.
  1963         10  BSUFX3A PIC  X(0001).
  1964     05  BSUFX3I PIC  X(0001).
  1965*    -------------------------------
  1966     05  BCERT4L PIC S9(0004) COMP.
  1967     05  BCERT4F PIC  X(0001).
  1968     05  FILLER REDEFINES BCERT4F.
  1969         10  BCERT4A PIC  X(0001).
  1970     05  BCERT4I PIC  X(0010).
  1971*    -------------------------------
  1972     05  BSUFX4L PIC S9(0004) COMP.
  1973     05  BSUFX4F PIC  X(0001).
  1974     05  FILLER REDEFINES BSUFX4F.
  1975         10  BSUFX4A PIC  X(0001).
  1976     05  BSUFX4I PIC  X(0001).
  1977*    -------------------------------
  1978     05  BCERT5L PIC S9(0004) COMP.
  1979     05  BCERT5F PIC  X(0001).
  1980     05  FILLER REDEFINES BCERT5F.
  1981         10  BCERT5A PIC  X(0001).
  1982     05  BCERT5I PIC  X(0010).
  1983*    -------------------------------
  1984     05  BSUFX5L PIC S9(0004) COMP.
  1985     05  BSUFX5F PIC  X(0001).
  1986     05  FILLER REDEFINES BSUFX5F.
  1987         10  BSUFX5A PIC  X(0001).
  1988     05  BSUFX5I PIC  X(0001).
  1989*    -------------------------------
  1990     05  MSG1L PIC S9(0004) COMP.
  1991     05  MSG1F PIC  X(0001).
  1992     05  FILLER REDEFINES MSG1F.
  1993         10  MSG1A PIC  X(0001).
  1994     05  MSG1I PIC  X(0072).
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page  39
* EL131.cbl
  1995*    -------------------------------
  1996     05  MSG2L PIC S9(0004) COMP.
  1997     05  MSG2F PIC  X(0001).
  1998     05  FILLER REDEFINES MSG2F.
  1999         10  MSG2A PIC  X(0001).
  2000     05  MSG2I PIC  X(0072).
  2001*    -------------------------------
  2002     05  PFKEYL PIC S9(0004) COMP.
  2003     05  PFKEYF PIC  X(0001).
  2004     05  FILLER REDEFINES PFKEYF.
  2005         10  PFKEYA PIC  X(0001).
  2006     05  PFKEYI PIC  99.
  2007*    -------------------------------
  2008     05  PFKEY6L PIC S9(0004) COMP.
  2009     05  PFKEY6F PIC  X(0001).
  2010     05  FILLER REDEFINES PFKEY6F.
  2011         10  PFKEY6A PIC  X(0001).
  2012     05  PFKEY6I PIC  X(0016).
  2013 01  EL131AO REDEFINES EL131AI.
  2014     05  FILLER            PIC  X(0012).
  2015*    -------------------------------
  2016     05  FILLER            PIC  X(0003).
  2017     05  DATEO PIC  X(0008).
  2018*    -------------------------------
  2019     05  FILLER            PIC  X(0003).
  2020     05  TIMEO PIC  99.99.
  2021*    -------------------------------
  2022     05  FILLER            PIC  X(0003).
  2023     05  SEQUO PIC  X(0010).
  2024*    -------------------------------
  2025     05  FILLER            PIC  X(0003).
  2026     05  COMPO PIC  X(0003).
  2027*    -------------------------------
  2028     05  FILLER            PIC  X(0003).
  2029     05  USERIDO PIC  X(0004).
  2030*    -------------------------------
  2031     05  FILLER            PIC  X(0003).
  2032     05  LABEL1O PIC  X(0011).
  2033*    -------------------------------
  2034     05  FILLER            PIC  X(0003).
  2035     05  PCERTNOO PIC  X(0010).
  2036*    -------------------------------
  2037     05  FILLER            PIC  X(0003).
  2038     05  PSUFXO PIC  X(0001).
  2039*    -------------------------------
  2040     05  FILLER            PIC  X(0003).
  2041     05  CCNOO PIC  X(0016).
  2042*    -------------------------------
  2043     05  FILLER            PIC  X(0003).
  2044     05  MAINTO PIC  X(0001).
  2045*    -------------------------------
  2046     05  FILLER            PIC  X(0003).
  2047     05  CLAIMO PIC  X(0007).
  2048*    -------------------------------
  2049     05  FILLER            PIC  X(0003).
  2050     05  CARRO PIC  X(0001).
  2051*    -------------------------------
  2052     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page  40
* EL131.cbl
  2053     05  CERTO PIC  X(0010).
  2054*    -------------------------------
  2055     05  FILLER            PIC  X(0003).
  2056     05  SUFXO PIC  X(0001).
  2057*    -------------------------------
  2058     05  FILLER            PIC  X(0003).
  2059     05  TYPEO PIC  X(0001).
  2060*    -------------------------------
  2061     05  FILLER            PIC  X(0003).
  2062     05  BENPERO PIC  X(0002).
  2063*    -------------------------------
  2064     05  FILLER            PIC  X(0003).
  2065     05  INSTYPEO PIC  X(0001).
  2066*    -------------------------------
  2067     05  FILLER            PIC  X(0003).
  2068     05  STATUSO PIC  X(0006).
  2069*    -------------------------------
  2070     05  FILLER            PIC  X(0003).
  2071     05  INCO PIC  X(0008).
  2072*    -------------------------------
  2073     05  FILLER            PIC  X(0003).
  2074     05  REPO PIC  X(0008).
  2075*    -------------------------------
  2076     05  FILLER            PIC  X(0003).
  2077     05  ICD1O PIC  X(0008).
  2078*    -------------------------------
  2079     05  FILLER            PIC  X(0003).
  2080     05  ICD2O PIC  X(0008).
  2081*    -------------------------------
  2082     05  FILLER            PIC  X(0003).
  2083     05  DIAGO PIC  X(0060).
  2084*    -------------------------------
  2085     05  FILLER            PIC  X(0003).
  2086     05  ACCSWO PIC  X(0001).
  2087*    -------------------------------
  2088     05  FILLER            PIC  X(0003).
  2089     05  BENEO PIC  X(0010).
  2090*    -------------------------------
  2091     05  FILLER            PIC  X(0003).
  2092     05  BIRTHO PIC  X(0008).
  2093*    -------------------------------
  2094     05  FILLER            PIC  X(0003).
  2095     05  SOCIALO PIC  X(0011).
  2096*    -------------------------------
  2097     05  FILLER            PIC  X(0003).
  2098     05  SEXO PIC  X(0001).
  2099*    -------------------------------
  2100     05  FILLER            PIC  X(0003).
  2101     05  MLNAMEO PIC  X(0015).
  2102*    -------------------------------
  2103     05  FILLER            PIC  X(0003).
  2104     05  MFNAMEO PIC  X(0012).
  2105*    -------------------------------
  2106     05  FILLER            PIC  X(0003).
  2107     05  MMINITO PIC  X(0001).
  2108*    -------------------------------
  2109     05  FILLER            PIC  X(0003).
  2110     05  AUTHRCVO PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page  41
* EL131.cbl
  2111*    -------------------------------
  2112     05  FILLER            PIC  X(0003).
  2113     05  CRTLNMEO PIC  X(0015).
  2114*    -------------------------------
  2115     05  FILLER            PIC  X(0003).
  2116     05  CRTFNMEO PIC  X(0012).
  2117*    -------------------------------
  2118     05  FILLER            PIC  X(0003).
  2119     05  CRTINITO PIC  X(0001).
  2120*    -------------------------------
  2121     05  FILLER            PIC  X(0003).
  2122     05  LOANBALO PIC  ZZZZZ9.99.
  2123*    -------------------------------
  2124     05  FILLER            PIC  X(0003).
  2125     05  PROCO PIC  X(0004).
  2126*    -------------------------------
  2127     05  FILLER            PIC  X(0003).
  2128     05  SUPVO PIC  X(0001).
  2129*    -------------------------------
  2130     05  FILLER            PIC  X(0003).
  2131     05  PRICDO PIC  X(0001).
  2132*    -------------------------------
  2133     05  FILLER            PIC  X(0003).
  2134     05  CRITPO PIC  X(0002).
  2135*    -------------------------------
  2136     05  FILLER            PIC  X(0003).
  2137     05  EXTENSO PIC  X(0002).
  2138*    -------------------------------
  2139     05  FILLER            PIC  X(0003).
  2140     05  FILETOO PIC  X(0004).
  2141*    -------------------------------
  2142     05  FILLER            PIC  X(0003).
  2143     05  PTHRHDGO PIC  X(0010).
  2144*    -------------------------------
  2145     05  FILLER            PIC  X(0003).
  2146     05  PDTHRUO PIC  X(0008).
  2147*    -------------------------------
  2148     05  FILLER            PIC  X(0003).
  2149     05  PDAMTO PIC  Z(06).99.
  2150*    -------------------------------
  2151     05  FILLER            PIC  X(0003).
  2152     05  NODAYSO PIC  ZZZ99.
  2153*    -------------------------------
  2154     05  FILLER            PIC  X(0003).
  2155     05  NOPMTSO PIC  ZZ99.
  2156*    -------------------------------
  2157     05  FILLER            PIC  X(0003).
  2158     05  FORMTYPO PIC  X(0001).
  2159*    -------------------------------
  2160     05  FILLER            PIC  X(0003).
  2161     05  ESTO PIC  X(0008).
  2162*    -------------------------------
  2163     05  FILLER            PIC  X(0003).
  2164     05  AUIDO PIC  X(0004).
  2165*    -------------------------------
  2166     05  FILLER            PIC  X(0003).
  2167     05  OCCO PIC  X(0006).
  2168*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page  42
* EL131.cbl
  2169     05  FILLER            PIC  X(0003).
  2170     05  MNTDTO PIC  X(0008).
  2171*    -------------------------------
  2172     05  FILLER            PIC  X(0003).
  2173     05  MNTTYPEO PIC  X(0006).
  2174*    -------------------------------
  2175     05  FILLER            PIC  X(0003).
  2176     05  CERTCARO PIC  X(0001).
  2177*    -------------------------------
  2178     05  FILLER            PIC  X(0003).
  2179     05  CERTGRPO PIC  X(0006).
  2180*    -------------------------------
  2181     05  FILLER            PIC  X(0003).
  2182     05  CERTSTO PIC  X(0002).
  2183*    -------------------------------
  2184     05  FILLER            PIC  X(0003).
  2185     05  CERTACTO PIC  X(0010).
  2186*    -------------------------------
  2187     05  FILLER            PIC  X(0003).
  2188     05  CERTEFFO PIC  X(0008).
  2189*    -------------------------------
  2190     05  FILLER            PIC  X(0003).
  2191     05  ISSAGEO PIC  X(0002).
  2192*    -------------------------------
  2193     05  FILLER            PIC  X(0003).
  2194     05  APRO PIC  9(3).9(4).
  2195*    -------------------------------
  2196     05  FILLER            PIC  X(0003).
  2197     05  PMTFREQO PIC  99.
  2198*    -------------------------------
  2199     05  FILLER            PIC  X(0003).
  2200     05  INDGRPO PIC  X(0001).
  2201*    -------------------------------
  2202     05  FILLER            PIC  X(0003).
  2203     05  PREMTYPO PIC  X(0001).
  2204*    -------------------------------
  2205     05  FILLER            PIC  X(0003).
  2206     05  REINCDO PIC  X(0001).
  2207*    -------------------------------
  2208     05  FILLER            PIC  X(0003).
  2209     05  JNTLNMEO PIC  X(0015).
  2210*    -------------------------------
  2211     05  FILLER            PIC  X(0003).
  2212     05  JNTFNMEO PIC  X(0012).
  2213*    -------------------------------
  2214     05  FILLER            PIC  X(0003).
  2215     05  JNTINITO PIC  X(0001).
  2216*    -------------------------------
  2217     05  FILLER            PIC  X(0003).
  2218     05  JNTAGEO PIC  X(0002).
  2219*    -------------------------------
  2220     05  FILLER            PIC  X(0003).
  2221     05  ADDONDTO PIC  X(0008).
  2222*    -------------------------------
  2223     05  FILLER            PIC  X(0003).
  2224     05  LCVDSCRO PIC  X(0006).
  2225*    -------------------------------
  2226     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page  43
* EL131.cbl
  2227     05  LCVKINDO PIC  X(0003).
  2228*    -------------------------------
  2229     05  FILLER            PIC  X(0003).
  2230     05  LCVCDO PIC  X(0002).
  2231*    -------------------------------
  2232     05  FILLER            PIC  X(0003).
  2233     05  LCVOTRMO PIC  999.
  2234*    -------------------------------
  2235     05  FILLER            PIC  X(0003).
  2236     05  LCVRTRMO PIC  999.
  2237*    -------------------------------
  2238     05  FILLER            PIC  X(0003).
  2239     05  LCVRATEO PIC  ZZZ.ZZ.
  2240*    -------------------------------
  2241     05  FILLER            PIC  X(0003).
  2242     05  LCVBENEO PIC  ZZZZZZZZ.ZZ.
  2243*    -------------------------------
  2244     05  FILLER            PIC  X(0003).
  2245     05  LCVFORMO PIC  X(0012).
  2246*    -------------------------------
  2247     05  FILLER            PIC  X(0003).
  2248     05  LCVCNDTO PIC  X(0008).
  2249*    -------------------------------
  2250     05  FILLER            PIC  X(0003).
  2251     05  LCVEXITO PIC  X(0008).
  2252*    -------------------------------
  2253     05  FILLER            PIC  X(0003).
  2254     05  LCVSTATO PIC  X(0006).
  2255*    -------------------------------
  2256     05  FILLER            PIC  X(0003).
  2257     05  ACVDSCRO PIC  X(0006).
  2258*    -------------------------------
  2259     05  FILLER            PIC  X(0003).
  2260     05  ACVKINDO PIC  X(0003).
  2261*    -------------------------------
  2262     05  FILLER            PIC  X(0003).
  2263     05  ACVCDO PIC  X(0002).
  2264*    -------------------------------
  2265     05  FILLER            PIC  X(0003).
  2266     05  ACVOTRMO PIC  999.
  2267*    -------------------------------
  2268     05  FILLER            PIC  X(0003).
  2269     05  ACVRTRMO PIC  999.
  2270*    -------------------------------
  2271     05  FILLER            PIC  X(0003).
  2272     05  ACVRATEO PIC  ZZZ.ZZ.
  2273*    -------------------------------
  2274     05  FILLER            PIC  X(0003).
  2275     05  ACVBENEO PIC  ZZZZZZZZ.ZZ.
  2276*    -------------------------------
  2277     05  FILLER            PIC  X(0003).
  2278     05  ACVFORMO PIC  X(0012).
  2279*    -------------------------------
  2280     05  FILLER            PIC  X(0003).
  2281     05  ACVCNDTO PIC  X(0008).
  2282*    -------------------------------
  2283     05  FILLER            PIC  X(0003).
  2284     05  ACVEXITO PIC  X(0008).
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page  44
* EL131.cbl
  2285*    -------------------------------
  2286     05  FILLER            PIC  X(0003).
  2287     05  ACVSTATO PIC  X(0006).
  2288*    -------------------------------
  2289     05  FILLER            PIC  X(0003).
  2290     05  LABEL2O PIC  X(0014).
  2291*    -------------------------------
  2292     05  FILLER            PIC  X(0003).
  2293     05  BCERT1O PIC  X(0010).
  2294*    -------------------------------
  2295     05  FILLER            PIC  X(0003).
  2296     05  BSUFX1O PIC  X(0001).
  2297*    -------------------------------
  2298     05  FILLER            PIC  X(0003).
  2299     05  BCERT2O PIC  X(0010).
  2300*    -------------------------------
  2301     05  FILLER            PIC  X(0003).
  2302     05  BSUFX2O PIC  X(0001).
  2303*    -------------------------------
  2304     05  FILLER            PIC  X(0003).
  2305     05  BCERT3O PIC  X(0010).
  2306*    -------------------------------
  2307     05  FILLER            PIC  X(0003).
  2308     05  BSUFX3O PIC  X(0001).
  2309*    -------------------------------
  2310     05  FILLER            PIC  X(0003).
  2311     05  BCERT4O PIC  X(0010).
  2312*    -------------------------------
  2313     05  FILLER            PIC  X(0003).
  2314     05  BSUFX4O PIC  X(0001).
  2315*    -------------------------------
  2316     05  FILLER            PIC  X(0003).
  2317     05  BCERT5O PIC  X(0010).
  2318*    -------------------------------
  2319     05  FILLER            PIC  X(0003).
  2320     05  BSUFX5O PIC  X(0001).
  2321*    -------------------------------
  2322     05  FILLER            PIC  X(0003).
  2323     05  MSG1O PIC  X(0072).
  2324*    -------------------------------
  2325     05  FILLER            PIC  X(0003).
  2326     05  MSG2O PIC  X(0072).
  2327*    -------------------------------
  2328     05  FILLER            PIC  X(0003).
  2329     05  PFKEYO PIC  X(0002).
  2330*    -------------------------------
  2331     05  FILLER            PIC  X(0003).
  2332     05  PFKEY6O PIC  X(0016).
  2333*    -------------------------------
  2334
  2335*                                COPY ELCEMIB SUPPRESS.
  2336******************************************************************
  2337*                                                                *
  2338*                                                                *
  2339*                            ELCEMIB.                            *
  2340*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2341*                            VMOD=2.005                          *
  2342*                                                                *
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page  45
* EL131.cbl
  2343*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  2344*                                                                *
  2345******************************************************************
  2346 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  2347     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  2348     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  2349     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  2350     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  2351     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  2352     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  2353     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  2354     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  2355     12  EMI-SWITCH1             PIC X        VALUE '1'.
  2356         88  EMI-NO-ERRORS                    VALUE '1'.
  2357         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  2358         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  2359     12  EMI-SWITCH2             PIC X        VALUE '1'.
  2360         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  2361     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  2362         88  EMI-AREA1-EMPTY                  VALUE '1'.
  2363         88  EMI-AREA1-FULL                   VALUE '2'.
  2364     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  2365         88  EMI-AREA2-EMPTY                  VALUE '1'.
  2366         88  EMI-AREA2-FULL                   VALUE '2'.
  2367     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  2368         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  2369         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  2370         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  2371         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  2372         88  EMI-BYPASS-FATALS                VALUE 'X'.
  2373     12  EMI-ERROR-LINES.
  2374         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  2375         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  2376         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  2377         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  2378             20  EMI-ERR-CODES OCCURS 10 TIMES.
  2379                 24  EMI-ERR-NUM         PIC X(4).
  2380                 24  EMI-FILLER          PIC X.
  2381                 24  EMI-SEV             PIC X.
  2382                 24  FILLER              PIC X.
  2383             20  FILLER                  PIC X(02).
  2384     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  2385         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  2386             20  EMI-ERROR-NUMBER    PIC X(4).
  2387             20  EMI-FILL            PIC X.
  2388             20  EMI-SEVERITY        PIC X.
  2389             20  FILLER              PIC X.
  2390             20  EMI-ERROR-TEXT.
  2391                 24  EMI-TEXT-VARIABLE   PIC X(10).
  2392                 24  FILLER          PIC X(55).
  2393     12  EMI-SEVERITY-SAVE           PIC X.
  2394         88  EMI-NOTE                    VALUE 'N'.
  2395         88  EMI-WARNING                 VALUE 'W'.
  2396         88  EMI-FORCABLE                VALUE 'F'.
  2397         88  EMI-FATAL                   VALUE 'X'.
  2398     12  EMI-MESSAGE-FLAG            PIC X.
  2399         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  2400         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page  46
* EL131.cbl
  2401     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  2402     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  2403         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  2404         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  2405         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  2406     12  emi-claim-no                pic x(7).
  2407     12  emi-claim-type              pic x(6).
  2408     12  FILLER                      PIC X(124)  VALUE SPACES.
  2409     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  2410     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  2411     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  2412     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  2413
  2414*                                COPY ELCJPFX SUPPRESS.
  2415******************************************************************
  2416*                                                                *
  2417*                                                                *
  2418*                            ELCJPFX.                            *
  2419*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2420*                            VMOD=2.002                          *
  2421*                                                                *
  2422*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  2423*                                                                *
  2424*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  2425*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  2426*        ELCNTL - CONTROL FILE                                   *
  2427*        ELMSTR - CLAIM MASTERS                                  *
  2428*        ELTRLR - ACTIVITY TRAILERS                              *
  2429*        ELCHKQ - CHECK QUE                                      *
  2430******************************************************************
  2431 01  JOURNAL-RECORD.
  2432     12  jp-date                     pic s9(5) comp-3.
  2433     12  jp-time                     pic s9(7) comp-3.
  2434     12  JP-USER-ID                  PIC X(4).
  2435     12  JP-FILE-ID                  PIC X(8).
  2436     12  JP-PROGRAM-ID               PIC X(8).
  2437     12  JP-RECORD-TYPE              PIC X.
  2438         88 JP-ADD              VALUE 'A'.
  2439         88 JP-BEFORE-CHANGE    VALUE 'B'.
  2440         88 JP-AFTER-CHANGE     VALUE 'C'.
  2441         88 JP-DELETE           VALUE 'D'.
  2442         88 JP-GENERIC-DELETE   VALUE 'G'.
  2443         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  2444         88 JP-KEY-CHG-ADD      VALUE 'N'.
  2445     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  2446     12  JP-RECORD-AREA
  2447
  2448
  2449                                 PIC X(750).
  2450
  2451*                                COPY ELCCALC.
  2452******************************************************************
  2453*                                                                *
  2454*                           ELCCALC.                            *
  2455*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2456*                            VMOD=2.025                          *
  2457*                                                                *
  2458*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page  47
* EL131.cbl
  2459*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  2460*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  2461*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  2462*                                                                *
  2463*  PASSED TO ELRTRM                                              *
  2464*  -----------------                                             *
  2465*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  2466*  ORIGINAL TERM                                                 *
  2467*  BEGINNING DATE                                                *
  2468*  ENDING DATE                                                   *
  2469*  COMPANY I.D.                                                  *
  2470*  ACCOUNT MASTER USER FIELD                                     *
  2471*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  2472*  FREE LOOK DAYS                                                *
  2473*                                                                *
  2474*  RETURNED FROM ELRTRM                                          *
  2475*  ---------------------                                         *
  2476*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  2477*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  2478*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  2479*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  2480*----------------------------------------------------------------*
  2481*  PASSED TO ELRAMT                                              *
  2482*  ----------------                                              *
  2483*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  2484*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2485*  ORIGINAL AMOUNT                                               *
  2486*  ALTERNATE BENEFIT (BALLON)                                    *
  2487*  A.P.R. - NET PAY ONLY                                         *
  2488*  METHOD
  2489*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  2490*  COMPANY I.D.                                                  *
  2491*  BENEFIT TYPE                                                  *
  2492*                                                                *
  2493*  RETURNED FROM ELRAMT                                          *
  2494*  --------------------                                          *
  2495*  REMAINING AMOUNT 1 - CURRENT                                  *
  2496*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  2497*  REMAINING AMOUNT FACTOR
  2498*----------------------------------------------------------------*
  2499*  PASSED TO ELRESV                                              *
  2500*  -----------------                                             *
  2501*  CERTIFICATE EFFECTIVE DATE                                    *
  2502*  VALUATION DATE                                                *
  2503*  PAID THRU DATE                                                *
  2504*  BENEFIT                                                       *
  2505*  INCURRED DATE                                                 *
  2506*  REPORTED DATE                                                 *
  2507*  ISSUE AGE                                                     *
  2508*  TERM                                                          *
  2509*  CDT PERCENT                                                   *
  2510*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  2511* *CLAIM TYPE (LIFE, A/H)                                        *
  2512* *REMAINING BENEFIT (FROM ELRAMT)                               *
  2513* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  2514*                                                                *
  2515*  RETURNED FROM ELRESV                                          *
  2516*  --------------------                                          *
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page  48
* EL131.cbl
  2517*  CDT TABLE USED                                                *
  2518*  CDT FACTOR USED                                               *
  2519*  PAY TO CURRENT RESERVE                                        *
  2520*  I.B.N.R. - A/H ONLY                                           *
  2521*  FUTURE (ACCRUED) AH ONLY                                      *
  2522*----------------------------------------------------------------*
  2523*  PASSED TO ELRATE                                              *
  2524*  ----------------                                              *
  2525*  CERT ISSUE DATE                                               *
  2526*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2527*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2528*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  2529*  STATE CODE (CLIENT DEFINED)                                   *
  2530*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2531*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2532*  DEVIATION CODE                                                *
  2533*  ISSUE AGE                                                     *
  2534*  ORIGINAL BENEFIT AMOUNT                                       *
  2535*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2536*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  2537*  BENEFIT KIND (LIFE OR A/H)                                    *
  2538*  A.P.R.                                                        *
  2539*  METHOD
  2540*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2541*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2542*  COMPANY I.D. (3 CHARACTER)                                    *
  2543*  BENEFIT CODE                                                  *
  2544*  BENEFIT OVERRIDE CODE                                         *
  2545*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  2546*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  2547*  JOINT INDICATOR (CSL ONLY)                                    *
  2548*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  2549*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  2550*                                                                *
  2551*  RETURNED FROM ELRATE                                          *
  2552*  --------------------                                          *
  2553*  CALCULATED PREMIUM                                            *
  2554*  PREMIUM RATE                                                  *
  2555*  MORTALITY CODE                                                *
  2556*  MAX ATTAINED AGE                                              *
  2557*  MAX AGE                                                       *
  2558*  MAX TERM                                                      *
  2559*  MAX MONTHLY BENEFIT                                           *
  2560*  MAX TOTAL BENIFIT                                             *
  2561*  COMPOSITE RATE (OPEN-END ONLY)                                *
  2562*----------------------------------------------------------------*
  2563*  PASSED TO ELRFND                                              *
  2564*  ----------------                                              *
  2565*  CERT ISSUE DATE                                               *
  2566*  REFUND DATE                                                   *
  2567*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2568*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2569*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2570*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2571*  STATE CODE (CLIENT DEFINED)                                   *
  2572*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2573*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2574*  DEVIATION CODE                                                *
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page  49
* EL131.cbl
  2575*  ISSUE AGE                                                     *
  2576*  ORIGINAL BENEFIT AMOUNT                                       *
  2577*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2578*  PROCESS TYPE (CANCEL)                                         *
  2579*  BENEFIT KIND (LIFE OR A/H)                                    *
  2580*  A.P.R.                                                        *
  2581*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  2582*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  2583*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2584*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2585*  COMPANY I.D. (3 CHARACTER)                                    *
  2586*  BENEFIT CODE                                                  *
  2587*  BENEFIT OVERRIDE CODE                                         *
  2588*                                                                *
  2589*  RETURNED FROM ELRFND                                          *
  2590*  --------------------                                          *
  2591*  CALCULATED REFUND                                             *
  2592*----------------------------------------------------------------*
  2593*  PASSED TO ELEARN                                              *
  2594*  ----------------                                              *
  2595*  CERT ISSUE DATE                                               *
  2596*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2597*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2598*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2599*  STATE CODE (CLIENT DEFINED)                                   *
  2600*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2601*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2602*  DEVIATION CODE                                                *
  2603*  ISSUE AGE                                                     *
  2604*  ORIGINAL BENEFIT AMOUNT                                       *
  2605*  BENEFIT KIND (LIFE OR A/H)                                    *
  2606*  A.P.R.                                                        *
  2607*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  2608*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2609*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2610*  COMPANY I.D. (3 CHARACTER)                                    *
  2611*  BENEFIT CODE                                                  *
  2612*  BENEFIT OVERRIDE CODE                                         *
  2613*                                                                *
  2614*  RETURNED FROM ELEARN                                          *
  2615*  --------------------                                          *
  2616*  INDICATED  EARNINGS                                           *
  2617*----------------------------------------------------------------*
  2618*                 LENGTH = 450                                   *
  2619*                                                                *
  2620******************************************************************
  2621******************************************************************
  2622*                   C H A N G E   L O G
  2623*
  2624* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2625*-----------------------------------------------------------------
  2626*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2627* EFFECTIVE    NUMBER
  2628*-----------------------------------------------------------------
  2629* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  2630* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2631* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  2632* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page  50
* EL131.cbl
  2633* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  2634* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  2635* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  2636* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  2637* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2638* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
  2639* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  2640******************************************************************
  2641
  2642 01  CALCULATION-PASS-AREA.
  2643     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  2644                                     COMP.
  2645
  2646     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  2647       88  NO-CP-ERROR                             VALUE ZERO.
  2648       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  2649                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  2650       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  2651       88  CP-ERROR-IN-DATES                       VALUE '2'.
  2652       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  2653       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  2654       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  2655       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  2656       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  2657       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  2658       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  2659       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  2660       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  2661       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  2662       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  2663       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  2664       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  2665       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  2666       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  2667
  2668     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  2669       88  NO-CP-ERROR-2                           VALUE ZERO.
  2670***********************  INPUT AREAS ****************************
  2671
  2672     12  CP-CALCULATION-AREA.
  2673         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  2674         16  CP-CERT-EFF-DT        PIC XX.
  2675         16  CP-VALUATION-DT       PIC XX.
  2676         16  CP-PAID-THRU-DT       PIC XX.
  2677         16  CP-BENEFIT-TYPE       PIC X.
  2678           88  CP-AH                               VALUE 'A' 'D'
  2679                                                   'I' 'U'.
  2680           88  CP-REDUCING-LIFE                    VALUE 'R'.
  2681           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  2682         16  CP-INCURRED-DT        PIC XX.
  2683         16  CP-REPORTED-DT        PIC XX.
  2684         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  2685         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  2686         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  2687                                     COMP-3.
  2688         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  2689                                     COMP-3.
  2690         16  CP-CDT-METHOD         PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page  51
* EL131.cbl
  2691           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  2692           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  2693           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  2694         16  CP-CLAIM-TYPE         PIC X.
  2695           88  CP-AH-CLAIM                         VALUE 'A'.
  2696           88  CP-LIFE-CLAIM                       VALUE 'L'.
  2697         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  2698                                     COMP-3.
  2699         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  2700                                     COMP-3.
  2701         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  2702                                     COMP-3.
  2703         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  2704                                     COMP-3.
  2705         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2706                                     COMP-3.
  2707         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  2708                                     COMP-3.
  2709         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  2710                                     COMP-3.
  2711         16  CP-REM-TERM-METHOD    PIC X.
  2712           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  2713           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  2714           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  2715           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  2716           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  2717           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  2718           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  2719         16  CP-EARNING-METHOD     PIC X.
  2720           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  2721           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  2722           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  2723           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  2724           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  2725           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  2726           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  2727           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  2728           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  2729           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  2730           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  2731           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  2732           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  2733           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  2734         16  CP-PROCESS-TYPE       PIC X.
  2735           88  CP-CLAIM                            VALUE '1'.
  2736           88  CP-CANCEL                           VALUE '2'.
  2737           88  CP-ISSUE                            VALUE '3'.
  2738         16  CP-SPECIAL-CALC-CD    PIC X.
  2739           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  2740           88  CP-1-MTH-INTEREST               VALUE ' '.
  2741           88  CP-0-MTH-INTEREST               VALUE 'A'.
  2742           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  2743           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  2744           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  2745           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  2746           88  CP-FARM-PLAN                    VALUE 'F'.
  2747           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  2748           88  CP-2-MTH-INTEREST               VALUE 'I'.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page  52
* EL131.cbl
  2749           88  CP-3-MTH-INTEREST               VALUE 'J'.
  2750           88  CP-4-MTH-INTEREST               VALUE 'K'.
  2751           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  2752           88  CP-MORTGAGE-REC                 VALUE 'M'.
  2753           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  2754           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  2755           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  2756           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  2757                                                     'W' 'X'.
  2758           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  2759           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  2760           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  2761           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  2762           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  2763           88  CP-SUMMARY-REC                  VALUE 'Z'.
  2764           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  2765           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  2766           88  CP-AD-D-BENEFIT                 VALUE '4'.
  2767           88  CP-CSL-METH-1                   VALUE '5'.
  2768           88  CP-CSL-METH-2                   VALUE '6'.
  2769           88  CP-CSL-METH-3                   VALUE '7'.
  2770           88  CP-CSL-METH-4                   VALUE '8'.
  2771
  2772         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  2773                                     COMP-3.
  2774         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  2775         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  2776         16  CP-STATE              PIC XX          VALUE SPACE.
  2777         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  2778         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  2779           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  2780               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  2781         16  CP-R78-OPTION         PIC X.
  2782           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  2783           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  2784
  2785         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  2786         16  CP-IBNR-RESERVE-SW    PIC X.
  2787         16  CP-CLAIM-STATUS       PIC X.
  2788         16  CP-RATE-FILE          PIC X.
  2789         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  2790                                     COMP-3.
  2791
  2792         16  CP-LIFE-OVERRIDE-CODE PIC X.
  2793         16  CP-AH-OVERRIDE-CODE   PIC X.
  2794
  2795         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  2796                                     COMP-3.
  2797         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  2798                                   PIC S9(5)V99 COMP-3.
  2799         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  2800                                     COMP-3.
  2801         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2802                                     COMP-3.
  2803         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  2804                                     COMP-3.
  2805         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  2806                                  PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page  53
* EL131.cbl
  2807
  2808         16  CP-PAID-FROM-DATE     PIC X(02).
  2809         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  2810         16  CP-EXT-DAYS-CALC      PIC X.
  2811           88  CP-EXT-NO-CHG                   VALUE ' '.
  2812           88  CP-EXT-CHG-LF                   VALUE '1'.
  2813           88  CP-EXT-CHG-AH                   VALUE '2'.
  2814           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  2815         16  CP-DOMICILE-STATE     PIC XX.
  2816         16  CP-CARRIER            PIC X.
  2817         16  CP-REIN-FLAG          PIC X.
  2818         16  CP-REM-TRM-CALC-OPTION PIC X.
  2819           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  2820                      '2' '3' '4' '5'.
  2821           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  2822           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  2823           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  2824           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  2825           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  2826           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  2827           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  2828           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  2829         16  CP-SIG-SWITCH         PIC X.
  2830         16  CP-RATING-METHOD      PIC X.
  2831           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  2832           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  2833           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  2834           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  2835           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  2836           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  2837           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  2838           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  2839           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  2840         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  2841                                     COMP-3.
  2842         16  CP-BEN-CATEGORY       PIC X.
  2843         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2844         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  2845                                   PIC S99V9(5) COMP-3.
  2846         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2847         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  2848                                   PIC S99V9(5) COMP-3.
  2849         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  2850         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  2851         16  CP-EXPIRE-DT          PIC XX.
  2852         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  2853         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  2854         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  2855         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  2856         16  CP-DDF-SPEC-CALC      PIC X.
  2857             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  2858             88  CP-CALC-CLP              VALUE 'C'.
  2859         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  2860         16  CP-CANCEL-REASON      PIC X.
  2861         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  2862         16  CP-PMT-MODE           PIC X.
  2863         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  2864         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page  54
* EL131.cbl
  2865         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  2866         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  2867         16  FILLER                PIC X.
  2868
  2869***************    OUTPUT FROM ELRESV   ************************
  2870
  2871         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  2872
  2873         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  2874                                     COMP-3.
  2875         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  2876                                     COMP-3.
  2877         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  2878                                     COMP-3.
  2879         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  2880                                     COMP-3.
  2881         16  FILLER                PIC X(09).
  2882***************    OUTPUT FROM ELRTRM   *************************
  2883
  2884         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  2885                                     COMP-3.
  2886         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  2887                                     COMP-3.
  2888         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  2889                                     COMP-3.
  2890         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  2891                                     COMP-3.
  2892         16  FILLER                PIC X(12).
  2893
  2894***************    OUTPUT FROM ELRAMT   *************************
  2895
  2896         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  2897                                     COMP-3.
  2898         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  2899                                     COMP-3.
  2900         16  FILLER                PIC X(12).
  2901
  2902***************    OUTPUT FROM ELRATE   *************************
  2903
  2904         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  2905                                     COMP-3.
  2906         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  2907                                     COMP-3.
  2908         16  CP-MORTALITY-CODE     PIC X(4).
  2909         16  CP-RATE-EDIT-FLAG     PIC X.
  2910             88  CP-RATES-NEED-APR                  VALUE '1'.
  2911         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  2912                                     COMP-3.
  2913         16  CP-CANCEL-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  2914         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  2915         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  2916                                   PIC S9(7)V99 COMP-3.
  2917         16  FILLER                PIC X(07).
  2918
  2919***************    OUTPUT FROM ELRFND   *************************
  2920
  2921         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  2922                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page  55
* EL131.cbl
  2923         16  CP-REFUND-TYPE-USED   PIC X.
  2924           88  CP-R-AS-R78                         VALUE '1'.
  2925           88  CP-R-AS-PRORATA                     VALUE '2'.
  2926           88  CP-R-AS-CALIF                       VALUE '3'.
  2927           88  CP-R-AS-TEXAS                       VALUE '4'.
  2928           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  2929           88  CP-R-AS-NET-PAY                     VALUE '5'.
  2930           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  2931           88  CP-R-AS-MEAN                        VALUE '8'.
  2932           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  2933           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  2934           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  2935           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  2936           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  2937           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  2938         16  FILLER                PIC X(12).
  2939
  2940***************    OUTPUT FROM ELEARN   *************************
  2941
  2942         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  2943                                     COMP-3.
  2944         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  2945                                     COMP-3.
  2946         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  2947                                     COMP-3.
  2948         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  2949                                     COMP-3.
  2950         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  2951                                     COMP-3.
  2952         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  2953                                     COMP-3.
  2954         16  CP-EARNING-TYPE-USED  PIC X.
  2955           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  2956           88  CP-E-AS-R78                         VALUE '1'.
  2957           88  CP-E-AS-PRORATA                     VALUE '2'.
  2958           88  CP-E-AS-TEXAS                       VALUE '4'.
  2959           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  2960           88  CP-E-AS-NET-PAY                     VALUE '5'.
  2961           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  2962           88  CP-E-AS-MEAN                        VALUE '8'.
  2963           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  2964         16  FILLER                PIC X(12).
  2965
  2966***************    OUTPUT FROM ELPMNT   *************************
  2967
  2968         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  2969                                     COMP-3.
  2970         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  2971                                     COMP-3.
  2972         16  FILLER                PIC X(12).
  2973
  2974***************   MISC WORK AREAS    *****************************
  2975         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  2976                                     COMP-3.
  2977         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  2978                                     COMP-3.
  2979         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  2980                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page  56
* EL131.cbl
  2981         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  2982                                     COMP-3.
  2983         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  2984                                     COMP-3.
  2985         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  2986                                     COMP-3.
  2987         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  2988             88  OPEN-RATE-FILE                   VALUE 'O'.
  2989             88  CLOSE-RATE-FILE                  VALUE 'C'.
  2990             88  IO-ERROR                         VALUE 'E'.
  2991
  2992         16  CP-FIRST-PAY-DATE     PIC XX.
  2993
  2994         16  CP-JOINT-INDICATOR    PIC X.
  2995
  2996         16  CP-RESERVE-REMAINING-TERM
  2997                                   PIC S9(4)V9    VALUE ZERO
  2998                                     COMP-3.
  2999
  3000         16  CP-INSURED-BIRTH-DT   PIC XX.
  3001
  3002         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  3003                                     COMP-3.
  3004
  3005         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  3006                                     COMP-3.
  3007
  3008         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  3009                                     COMP-3.
  3010
  3011         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  3012                                     COMP-3.
  3013
  3014         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  3015                                     COMP-3.
  3016
  3017         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  3018                                     COMP-3.
  3019
  3020         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  3021                                     COMP-3.
  3022
  3023         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  3024             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  3025
  3026         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  3027                                     COMP-3.
  3028         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  3029                                     COMP-3.
  3030         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  3031         16  cp-extra-periods      pic 9 value zeros.
  3032         16  cp-net-only-state     pic x value spaces.
  3033         16  FILLER                PIC X(13).
  3034******************************************************************
  3035
  3036*                                COPY ELCDATE.
  3037******************************************************************
  3038*                                                                *
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page  57
* EL131.cbl
  3039*                                                                *
  3040*                            ELCDATE.                            *
  3041*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3042*                            VMOD=2.003
  3043*                                                                *
  3044*                                                                *
  3045*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  3046*                 LENGTH = 200                                   *
  3047******************************************************************
  3048
  3049 01  DATE-CONVERSION-DATA.
  3050     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  3051     12  DC-OPTION-CODE                PIC X.
  3052         88  BIN-TO-GREG                VALUE ' '.
  3053         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  3054         88  EDIT-GREG-TO-BIN           VALUE '2'.
  3055         88  YMD-GREG-TO-BIN            VALUE '3'.
  3056         88  MDY-GREG-TO-BIN            VALUE '4'.
  3057         88  JULIAN-TO-BIN              VALUE '5'.
  3058         88  BIN-PLUS-ELAPSED           VALUE '6'.
  3059         88  FIND-CENTURY               VALUE '7'.
  3060         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  3061         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  3062         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  3063         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  3064         88  JULIAN-TO-BIN-3            VALUE 'C'.
  3065         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  3066         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  3067         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3068         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3069         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  3070         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3071         88  BIN-3-TO-GREG              VALUE 'I'.
  3072         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3073         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3074         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3075         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  3076         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3077         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3078         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3079         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3080         88  THREE-CHARACTER-BIN
  3081                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3082         88  GREGORIAN-TO-BIN
  3083                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3084         88  BIN-TO-GREGORIAN
  3085                  VALUES ' ' '1' 'I' '8' 'G'.
  3086         88  JULIAN-TO-BINARY
  3087                  VALUES '5' 'C' 'E' 'F'.
  3088     12  DC-ERROR-CODE                 PIC X.
  3089         88  NO-CONVERSION-ERROR        VALUE ' '.
  3090         88  DATE-CONVERSION-ERROR
  3091                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  3092         88  DATE-IS-ZERO               VALUE '1'.
  3093         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  3094         88  DATE-IS-INVALID            VALUE '3'.
  3095         88  DATE1-GREATER-DATE2        VALUE '4'.
  3096         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page  58
* EL131.cbl
  3097         88  DATE-INVALID-OPTION        VALUE '9'.
  3098         88  INVALID-CENTURY            VALUE 'A'.
  3099         88  ONLY-CENTURY               VALUE 'B'.
  3100         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3101         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3102     12  DC-END-OF-MONTH               PIC X.
  3103         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3104     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3105         88  USE-NORMAL-PROCESS         VALUE ' '.
  3106         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  3107         88  ADJUST-UP-100-YRS          VALUE '2'.
  3108     12  FILLER                        PIC X.
  3109     12  DC-CONVERSION-DATES.
  3110         16  DC-BIN-DATE-1             PIC XX.
  3111         16  DC-BIN-DATE-2             PIC XX.
  3112         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  3113         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3114                       DC-GREG-DATE-1-EDIT.
  3115             20  DC-EDIT1-MONTH        PIC 99.
  3116             20  SLASH1-1              PIC X.
  3117             20  DC-EDIT1-DAY          PIC 99.
  3118             20  SLASH1-2              PIC X.
  3119             20  DC-EDIT1-YEAR         PIC 99.
  3120         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3121         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  3122                     DC-GREG-DATE-2-EDIT.
  3123             20  DC-EDIT2-MONTH        PIC 99.
  3124             20  SLASH2-1              PIC X.
  3125             20  DC-EDIT2-DAY          PIC 99.
  3126             20  SLASH2-2              PIC X.
  3127             20  DC-EDIT2-YEAR         PIC 99.
  3128         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3129         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3130                     DC-GREG-DATE-1-YMD.
  3131             20  DC-YMD-YEAR           PIC 99.
  3132             20  DC-YMD-MONTH          PIC 99.
  3133             20  DC-YMD-DAY            PIC 99.
  3134         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3135         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3136                      DC-GREG-DATE-1-MDY.
  3137             20  DC-MDY-MONTH          PIC 99.
  3138             20  DC-MDY-DAY            PIC 99.
  3139             20  DC-MDY-YEAR           PIC 99.
  3140         16  DC-GREG-DATE-1-ALPHA.
  3141             20  DC-ALPHA-MONTH        PIC X(10).
  3142             20  DC-ALPHA-DAY          PIC 99.
  3143             20  FILLER                PIC XX.
  3144             20  DC-ALPHA-CENTURY.
  3145                 24 DC-ALPHA-CEN-N     PIC 99.
  3146             20  DC-ALPHA-YEAR         PIC 99.
  3147         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3148         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3149         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3150         16  DC-JULIAN-DATE            PIC 9(05).
  3151         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  3152                                       PIC 9(05).
  3153         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3154             20  DC-JULIAN-YEAR        PIC 99.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page  59
* EL131.cbl
  3155             20  DC-JULIAN-DAYS        PIC 999.
  3156         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3157         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3158         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3159     12  DATE-CONVERSION-VARIBLES.
  3160         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3161         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3162             20  FILLER                PIC 9(3).
  3163             20  HOLD-CEN-1-CCYY.
  3164                 24  HOLD-CEN-1-CC     PIC 99.
  3165                 24  HOLD-CEN-1-YY     PIC 99.
  3166             20  HOLD-CEN-1-MO         PIC 99.
  3167             20  HOLD-CEN-1-DA         PIC 99.
  3168         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3169             20  HOLD-CEN-1-R-MO       PIC 99.
  3170             20  HOLD-CEN-1-R-DA       PIC 99.
  3171             20  HOLD-CEN-1-R-CCYY.
  3172                 24  HOLD-CEN-1-R-CC   PIC 99.
  3173                 24  HOLD-CEN-1-R-YY   PIC 99.
  3174             20  FILLER                PIC 9(3).
  3175         16  HOLD-CENTURY-1-X.
  3176             20  FILLER                PIC X(3)  VALUE SPACES.
  3177             20  HOLD-CEN-1-X-CCYY.
  3178                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3179                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3180             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3181             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3182         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3183             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3184             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3185             20  HOLD-CEN-1-R-X-CCYY.
  3186                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3187                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3188             20  FILLER                PIC XXX.
  3189         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3190         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3191         16  DC-JULIAN-DATE-1          PIC 9(07).
  3192         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3193             20  DC-JULIAN-1-CCYY.
  3194                 24  DC-JULIAN-1-CC    PIC 99.
  3195                 24  DC-JULIAN-1-YR    PIC 99.
  3196             20  DC-JULIAN-DA-1        PIC 999.
  3197         16  DC-JULIAN-DATE-2          PIC 9(07).
  3198         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3199             20  DC-JULIAN-2-CCYY.
  3200                 24  DC-JULIAN-2-CC    PIC 99.
  3201                 24  DC-JULIAN-2-YR    PIC 99.
  3202             20  DC-JULIAN-DA-2        PIC 999.
  3203         16  DC-GREG-DATE-A-EDIT.
  3204             20  DC-EDITA-MONTH        PIC 99.
  3205             20  SLASHA-1              PIC X VALUE '/'.
  3206             20  DC-EDITA-DAY          PIC 99.
  3207             20  SLASHA-2              PIC X VALUE '/'.
  3208             20  DC-EDITA-CCYY.
  3209                 24  DC-EDITA-CENT     PIC 99.
  3210                 24  DC-EDITA-YEAR     PIC 99.
  3211         16  DC-GREG-DATE-B-EDIT.
  3212             20  DC-EDITB-MONTH        PIC 99.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page  60
* EL131.cbl
  3213             20  SLASHB-1              PIC X VALUE '/'.
  3214             20  DC-EDITB-DAY          PIC 99.
  3215             20  SLASHB-2              PIC X VALUE '/'.
  3216             20  DC-EDITB-CCYY.
  3217                 24  DC-EDITB-CENT     PIC 99.
  3218                 24  DC-EDITB-YEAR     PIC 99.
  3219         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3220         16  DC-GREG-DATE-CYMD-R REDEFINES
  3221                              DC-GREG-DATE-CYMD.
  3222             20  DC-CYMD-CEN           PIC 99.
  3223             20  DC-CYMD-YEAR          PIC 99.
  3224             20  DC-CYMD-MONTH         PIC 99.
  3225             20  DC-CYMD-DAY           PIC 99.
  3226         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3227         16  DC-GREG-DATE-MDCY-R REDEFINES
  3228                              DC-GREG-DATE-MDCY.
  3229             20  DC-MDCY-MONTH         PIC 99.
  3230             20  DC-MDCY-DAY           PIC 99.
  3231             20  DC-MDCY-CEN           PIC 99.
  3232             20  DC-MDCY-YEAR          PIC 99.
  3233    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3234        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3235    12  DC-EL310-DATE                  PIC X(21).
  3236    12  FILLER                         PIC X(28).
  3237
  3238*                                COPY ELCDMO.
  3239******************************************************************
  3240*                                                                *
  3241*                                                                *
  3242*                            ELCDMO.                             *
  3243*                            VMOD=2.004                          *
  3244*                                                                *
  3245*   FILE DESCRIPTION = DLO025 (DMO FILE MAINTENANCE PGRM)        *
  3246*        COMMUNICATION AREA                                      *
  3247*   FILE TYPE = NA                                               *
  3248*   RECORD SIZE = 110    RECFORM = FIXED                         *
  3249*                                                                *
  3250******************************************************************
  3251 01  DMO-COMMUNICATION-AREA.
  3252     12  DM-RECORD-TYPE                  PIC  X(02).
  3253             88  DM-ISSUE-TRAN                VALUE 'CC'.
  3254             88  DM-CLAIM-STATUS-CHANGE       VALUE 'CS'.
  3255             88  DM-CLAIM-PAYMENT             VALUE 'DR'.
  3256     12  DM-DIST-CODE                    PIC  X(04).
  3257     12  DM-MAIL-CODE                    PIC  X(05).
  3258     12  DM-CREDIT-CARD-NUMBER           PIC  X(16).
  3259     12  DM-INSURED-NAME                 PIC  X(30).
  3260     12  DM-CLAIM-NO                     PIC  X(07).
  3261     12  DM-CLAIM-TYPE                   PIC  X.
  3262
  3263     12  DM-STATUS-DATA-AREA.
  3264         16  DM-CLAIM-STATUS             PIC  X.
  3265             88  DM-OPEN-NO-PAYMENTS              VALUE '1'.
  3266             88  DM-OPEN-WITH-PAYMENTS            VALUE '2'.
  3267             88  DM-CLOSED                        VALUE '3'.
  3268             88  DM-CLOSE-SETTLE-FINAL            VALUE '4'.
  3269             88  DM-DEFAULT                       VALUE '9'.
  3270         16  DM-STATUS-DATE              PIC  X(08).
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page  61
* EL131.cbl
  3271******YYYYMMDD
  3272         16  DM-STAT-CHANGE-TYPE         PIC  X.
  3273             88  DM-MANUAL-CLOSE                  VALUE 'C'.
  3274             88  DM-CLAIM-DENIED                  VALUE 'D'.
  3275             88  DM-FINAL-PAYMENT                 VALUE 'F'.
  3276             88  DM-INITIAL-PAYMENT               VALUE 'I'.
  3277             88  DM-AUTO-CLOSE                    VALUE 'Q'.
  3278             88  DM-RE-OPENED                     VALUE 'R'.
  3279             88  DM-NEW-CLAIM-SETUP               VALUE 'S'.
  3280             88  DM-VOIDED-PAYMENT                VALUE 'V'.
  3281             88  DM-CLAIM-DELETED                 VALUE 'X'.
  3282         16  DM-STAT-CARRIER             PIC X.
  3283
  3284     12  DM-DRAFT-DATA-AREA.
  3285         16  DM-PAYMENT-TYPE             PIC  X.
  3286             88  DM-VALID-CLAIM-TYPES VALUES 'L' 'D' 'U' 'A'.
  3287         16  DM-PAYMENT-AMT              PIC  9(05)V9(02).
  3288         16  DM-PAYMENT-DATE             PIC  X(08).
  3289******YYYYMMDD
  3290         16  DM-CERT-NO                  PIC  X(11).
  3291         16  DM-TRLR-SEQ-NO              PIC  9(04).
  3292         16  DM-CARRIER                  PIC  X.
  3293
  3294     12  DM-RETURN-CODE                  PIC  XX.
  3295*                                COPY ERCPDEF.
  3296******************************************************************
  3297*                                                                *
  3298*                                                                *
  3299*                            ERCPDEF.                            *
  3300*                                                                *
  3301*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  3302*                                                                *
  3303*    FILE TYPE = VSAM,KSDS                                       *
  3304*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  3305*                                                                *
  3306*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  3307*                                                                *
  3308*    LOG = YES                                                   *
  3309*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3310******************************************************************
  3311*                   C H A N G E   L O G
  3312*
  3313* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3314*-----------------------------------------------------------------
  3315*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3316* EFFECTIVE    NUMBER
  3317*-----------------------------------------------------------------
  3318* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3319* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  3320* 100314  CR2014061900001  PEMA  ADD PCT OF BENEFIT
  3321******************************************************************
  3322 01  PRODUCT-MASTER.
  3323    12  PD-RECORD-ID                 PIC X(02).
  3324        88  VALID-PD-ID                  VALUE 'PD'.
  3325    12  PD-CONTROL-PRIMARY.
  3326        16  PD-COMPANY-CD            PIC X.
  3327        16  PD-STATE                 PIC XX.
  3328        16  PD-PRODUCT-CD            PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page  62
* EL131.cbl
  3329        16  PD-FILLER                PIC X(7).
  3330        16  PD-BEN-TYPE              PIC X.
  3331        16  PD-BEN-CODE              PIC XX.
  3332        16  PD-PROD-EXP-DT           PIC XX.
  3333    12  FILLER                       PIC X(50).
  3334    12  PD-PRODUCT-DATA OCCURS 8.
  3335        16  PD-PROD-CODE             PIC X.
  3336            88  PD-PROD-LIFE           VALUE 'L'.
  3337            88  PD-PROD-PROP           VALUE 'P'.
  3338            88  PD-PROD-AH             VALUE 'A'.
  3339            88  PD-PROD-IU             VALUE 'I'.
  3340            88  PD-PROD-GAP            VALUE 'G'.
  3341            88  PD-PROD-FAML           VALUE 'F'.
  3342        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  3343        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  3344        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  3345        16  PD-MAX-TERM              PIC S999        COMP-3.
  3346        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  3347        16  FILLER                   PIC X.
  3348        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  3349        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  3350        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  3351        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  3352        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  3353        16  PD-REC-CRIT-PERIOD       PIC 99.
  3354        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  3355            20  PD-RECURRING-YN      PIC X.
  3356            20  FILLER               PIC X.
  3357        16  PD-RTW-MOS               PIC 99.
  3358        16  PD-MAX-EXTENSION         PIC 99.
  3359        16  pd-ben-pct               pic sv999 comp-3.
  3360*       16  FILLER                   PIC XX.
  3361    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  3362    12  PD-TERM-LIMITS OCCURS 15.
  3363        16  PD-LOW-TERM              PIC S999        COMP-3.
  3364        16  PD-HI-TERM               PIC S999        COMP-3.
  3365*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  3366    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  3367        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  3368        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  3369    12  PD-EARN-FACTORS.
  3370        16  FILLER OCCURS 15.
  3371            20  FILLER OCCURS 15.
  3372                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  3373    12  PD-PRODUCT-DESC              PIC X(80).
  3374    12  PD-TRUNCATED                 PIC X.
  3375    12  FILLER                       PIC X(59).
  3376    12  PD-MAINT-INFORMATION.
  3377        16  PD-LAST-MAINT-DT         PIC X(02).
  3378        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  3379        16  PD-LAST-MAINT-BY         PIC X(04).
  3380*                                COPY ELCCRTT.
  3381******************************************************************
  3382*                                                                *
  3383*                            ELCCRTT.                            *
  3384*                                                                *
  3385*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  3386*                                                                *
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page  63
* EL131.cbl
  3387*   FILE TYPE = VSAM,KSDS                                        *
  3388*   RECORD SIZE = 552  RECFORM = FIXED                           *
  3389*                                                                *
  3390*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  3391*                                                                *
  3392*   LOG = YES                                                    *
  3393*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3394******************************************************************
  3395*                   C H A N G E   L O G
  3396*
  3397* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3398*-----------------------------------------------------------------
  3399*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3400* EFFECTIVE    NUMBER
  3401*-----------------------------------------------------------------
  3402* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  3403* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  3404* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  3405* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  3406* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  3407* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3408* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  3409* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  3410* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  3411******************************************************************
  3412
  3413 01  CERTIFICATE-TRAILERS.
  3414     12  CS-RECORD-ID                      PIC XX.
  3415         88  VALID-CS-ID                      VALUE 'CS'.
  3416
  3417     12  CS-CONTROL-PRIMARY.
  3418         16  CS-COMPANY-CD                 PIC X.
  3419         16  CS-CARRIER                    PIC X.
  3420         16  CS-GROUPING                   PIC X(6).
  3421         16  CS-STATE                      PIC XX.
  3422         16  CS-ACCOUNT                    PIC X(10).
  3423         16  CS-CERT-EFF-DT                PIC XX.
  3424         16  CS-CERT-NO.
  3425             20  CS-CERT-PRIME             PIC X(10).
  3426             20  CS-CERT-SFX               PIC X.
  3427         16  CS-TRAILER-TYPE               PIC X.
  3428             88  COMM-TRLR           VALUE 'A'.
  3429             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  3430             88  CERT-DATA-TRLR      VALUE 'C'.
  3431
  3432     12  CS-DATA-AREA                      PIC X(516).
  3433
  3434     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  3435         16  CS-BANK-COMMISSION-AREA.
  3436             20  CS-BANK-COMMS       OCCURS 10.
  3437                 24  CS-AGT                PIC X(10).
  3438                 24  CS-COM-TYP            PIC X.
  3439                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  3440                 24  CS-RECALC-LV-INDIC    PIC X.
  3441                 24  FILLER                PIC X(10).
  3442         16  FILLER                        PIC X(256).
  3443
  3444     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page  64
* EL131.cbl
  3445****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  3446         16  CS-MB-CLAIM-DATA OCCURS 24.
  3447             20  CS-CLAIM-NO               PIC X(7).
  3448             20  CS-CLAIM-TYPE             PIC X.
  3449                 88  CS-AH-CLM               VALUE 'A'.
  3450                 88  CS-IU-CLM               VALUE 'I'.
  3451                 88  CS-GP-CLM               VALUE 'G'.
  3452                 88  CS-LF-CLM               VALUE 'L'.
  3453                 88  CS-PR-CLM               VALUE 'P'.
  3454                 88  CS-FL-CLM               VALUE 'F'.
  3455             20  CS-INSURED-TYPE           PIC X.
  3456                 88  CS-PRIM-INSURED          VALUE 'P'.
  3457                 88  CS-CO-BORROWER           VALUE 'C'.
  3458             20  CS-BENEFIT-PERIOD         PIC 99.
  3459             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  3460             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  3461             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  3462         16  FILLER                        PIC X(12).
  3463     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  3464         16  CS-VIN-NUMBER                 PIC X(17).
  3465         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  3466         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  3467         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  3468         16  cs-agent-name.
  3469             20  cs-agent-fname            pic x(20).
  3470             20  cs-agent-mi               pic x.
  3471             20  cs-agent-lname            pic x(25).
  3472         16  cs-license-no                 pic x(15).
  3473         16  cs-npn-number                 pic x(10).
  3474         16  cs-agent-edit-status          pic x.
  3475             88  cs-ae-refer-to-manager      value 'M'.
  3476             88  cs-ae-cover-sheet           value 'C'.
  3477             88  cs-ae-sig-form              value 'S'.
  3478             88  cs-ae-verified              value 'V'.
  3479             88  cs-unidentified-signature   value 'U'.
  3480             88  cs-cert-returned            value 'R'.
  3481             88  cs-accept-no-commission     value 'N'.
  3482         16  cs-year                       pic 9999.
  3483         16  cs-make                       pic x(20).
  3484         16  cs-model                      pic x(20).
  3485         16  cs-future                     pic x(20).
  3486         16  cs-vehicle-odometer           pic s9(7) comp-3.
  3487         16  FILLER                        PIC X(356). *> was 420
  3488*        16  FILLER                        PIC X(496).
  3489
  3490****************************************************************
  3491*
  3492* Copyright (c) 2007-2013 Dell Inc.
  3493* All rights reserved.
  3494*
  3495****************************************************************
  3496 01  DFHEIV.
  3497   02  DFHEIV0               PIC X(35).
  3498   02  DFHEIV1               PIC X(08).
  3499   02  DFHEIV2               PIC X(08).
  3500   02  DFHEIV3               PIC X(08).
  3501   02  DFHEIV4               PIC X(06).
  3502   02  DFHEIV5               PIC X(04).
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page  65
* EL131.cbl
  3503   02  DFHEIV6               PIC X(04).
  3504   02  DFHEIV7               PIC X(02).
  3505   02  DFHEIV8               PIC X(02).
  3506   02  DFHEIV9               PIC X(01).
  3507   02  DFHEIV10              PIC S9(7) COMP-3.
  3508   02  DFHEIV11              PIC S9(4) COMP SYNC.
  3509   02  DFHEIV12              PIC S9(4) COMP SYNC.
  3510   02  DFHEIV13              PIC S9(4) COMP SYNC.
  3511   02  DFHEIV14              PIC S9(4) COMP SYNC.
  3512   02  DFHEIV15              PIC S9(4) COMP SYNC.
  3513   02  DFHEIV16              PIC S9(9) COMP SYNC.
  3514   02  DFHEIV17              PIC X(04).
  3515   02  DFHEIV18              PIC X(04).
  3516   02  DFHEIV19              PIC X(04).
  3517   02  DFHEIV20              USAGE IS POINTER.
  3518   02  DFHEIV21              USAGE IS POINTER.
  3519   02  DFHEIV22              USAGE IS POINTER.
  3520   02  DFHEIV23              USAGE IS POINTER.
  3521   02  DFHEIV24              USAGE IS POINTER.
  3522   02  DFHEIV25              PIC S9(9) COMP SYNC.
  3523   02  DFHEIV26              PIC S9(9) COMP SYNC.
  3524   02  DFHEIV27              PIC S9(9) COMP SYNC.
  3525   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3526   02  DFHEIV29              PIC S9(9) COMP SYNC.
  3527   02  DFHEIV30              PIC S9(9) COMP SYNC.
  3528   02  DFHEIV31              PIC S9(9) COMP SYNC.
  3529   02  DFHEIV32              PIC S9(4) COMP SYNC.
  3530   02  DFHEIV33              PIC S9(4) COMP SYNC.
  3531   02  DFHEIV34              PIC S9(4) COMP SYNC.
  3532   02  DFHEIV35              PIC S9(4) COMP SYNC.
  3533   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3534   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3535   02  FILLER                PIC X(02).
  3536   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3537   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  3538   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3539   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3540   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3541   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  3542   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  3543 LINKAGE  SECTION.
  3544*****************************************************************
  3545*                                                               *
  3546* Copyright (c) 2007-2013 Dell Inc.                             *
  3547* All rights reserved.                                          *
  3548*                                                               *
  3549*****************************************************************
  3550 01  dfheiblk.
  3551     02  eibtime          pic s9(7) comp-3.
  3552     02  eibdate          pic s9(7) comp-3.
  3553     02  eibtrnid         pic x(4).
  3554     02  eibtaskn         pic s9(7) comp-3.
  3555     02  eibtrmid         pic x(4).
  3556     02  dfheigdi         pic s9(4) comp.
  3557     02  eibcposn         pic s9(4) comp.
  3558     02  eibcalen         pic s9(4) comp.
  3559     02  eibaid           pic x(1).
  3560     02  eibfiller1       pic x(1).
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page  66
* EL131.cbl
  3561     02  eibfn            pic x(2).
  3562     02  eibfiller2       pic x(2).
  3563     02  eibrcode         pic x(6).
  3564     02  eibfiller3       pic x(2).
  3565     02  eibds            pic x(8).
  3566     02  eibreqid         pic x(8).
  3567     02  eibrsrce         pic x(8).
  3568     02  eibsync          pic x(1).
  3569     02  eibfree          pic x(1).
  3570     02  eibrecv          pic x(1).
  3571     02  eibsend          pic x(1).
  3572     02  eibatt           pic x(1).
  3573     02  eibeoc           pic x(1).
  3574     02  eibfmh           pic x(1).
  3575     02  eibcompl         pic x(1).
  3576     02  eibsig           pic x(1).
  3577     02  eibconf          pic x(1).
  3578     02  eiberr           pic x(1).
  3579     02  eibrldbk         pic x(1).
  3580     02  eiberrcd         pic x(4).
  3581     02  eibsynrb         pic x(1).
  3582     02  eibnodat         pic x(1).
  3583     02  eibfiller5       pic x(2).
  3584     02  eibresp          pic s9(8) comp.
  3585     02  eibresp2         pic s9(8) comp.
  3586     02  dfheigdj         pic s9(4) comp.
  3587     02  dfheigdk         pic s9(4) comp.
  3588 01  DFHCOMMAREA                 PIC X(1024).
  3589
  3590*                                COPY ELCMSTR.
  3591******************************************************************
  3592*                                                                *
  3593*                            ELCMSTR.                            *
  3594*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3595*                            VMOD=2.012                          *
  3596*                                                                *
  3597*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  3598*                                                                *
  3599*   FILE TYPE = VSAM,KSDS                                        *
  3600*   RECORD SIZE = 350  RECFORM = FIXED                           *
  3601*                                                                *
  3602*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  3603*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  3604*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  3605*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  3606*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  3607*                                                 RKP=75,LEN=21  *
  3608*                                                                *
  3609*   **** NOTE ****                                               *
  3610*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  3611*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  3612*                                                                *
  3613*   LOG = YES                                                    *
  3614*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3615******************************************************************
  3616*                   C H A N G E   L O G
  3617*
  3618* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page  67
* EL131.cbl
  3619*-----------------------------------------------------------------
  3620*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3621* EFFECTIVE    NUMBER
  3622*-----------------------------------------------------------------
  3623* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  3624* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  3625* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  3626* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3627* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  3628* 081817    2016100700001  TANA  ADD NBR OF EXTENSIONS
  3629******************************************************************
  3630 01  CLAIM-MASTER.
  3631     12  CL-RECORD-ID                PIC XX.
  3632         88  VALID-CL-ID         VALUE 'CL'.
  3633
  3634     12  CL-CONTROL-PRIMARY.
  3635         16  CL-COMPANY-CD           PIC X.
  3636         16  CL-CARRIER              PIC X.
  3637         16  CL-CLAIM-NO             PIC X(7).
  3638         16  CL-CERT-NO.
  3639             20  CL-CERT-PRIME       PIC X(10).
  3640             20  CL-CERT-SFX         PIC X.
  3641
  3642     12  CL-CONTROL-BY-NAME.
  3643         16  CL-COMPANY-CD-A1        PIC X.
  3644         16  CL-INSURED-LAST-NAME    PIC X(15).
  3645         16  CL-INSURED-NAME.
  3646             20  CL-INSURED-1ST-NAME PIC X(12).
  3647             20  CL-INSURED-MID-INIT PIC X.
  3648
  3649     12  CL-CONTROL-BY-SSN.
  3650         16  CL-COMPANY-CD-A2        PIC X.
  3651         16  CL-SOC-SEC-NO.
  3652             20  CL-SSN-STATE        PIC XX.
  3653             20  CL-SSN-ACCOUNT      PIC X(6).
  3654             20  CL-SSN-LN3          PIC X(3).
  3655
  3656     12  CL-CONTROL-BY-CERT-NO.
  3657         16  CL-COMPANY-CD-A4        PIC X.
  3658         16  CL-CERT-NO-A4.
  3659             20  CL-CERT-A4-PRIME    PIC X(10).
  3660             20  CL-CERT-A4-SFX      PIC X.
  3661
  3662     12  CL-CONTROL-BY-CCN.
  3663         16  CL-COMPANY-CD-A5        PIC X.
  3664         16  CL-CCN-A5.
  3665             20  CL-CCN.
  3666                 24  CL-CCN-PREFIX-A5 PIC X(4).
  3667                 24  CL-CCN-PRIME-A5 PIC X(12).
  3668             20  CL-CCN-FILLER-A5    PIC X(4).
  3669
  3670     12  CL-INSURED-PROFILE-DATA.
  3671         16  CL-INSURED-BIRTH-DT     PIC XX.
  3672         16  CL-INSURED-SEX-CD       PIC X.
  3673             88  INSURED-IS-MALE        VALUE 'M'.
  3674             88  INSURED-IS-FEMALE      VALUE 'F'.
  3675             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  3676         16  CL-INSURED-OCC-CD       PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page  68
* EL131.cbl
  3677         16  FILLER                  PIC X(5).
  3678
  3679     12  CL-PROCESSING-INFO.
  3680         16  CL-PROCESSOR-ID         PIC X(4).
  3681         16  CL-CLAIM-STATUS         PIC X.
  3682             88  CLAIM-IS-OPEN          VALUE 'O'.
  3683             88  CLAIM-IS-CLOSED        VALUE 'C'.
  3684         16  CL-CLAIM-TYPE           PIC X.
  3685*            88  AH-CLAIM               VALUE 'A'.
  3686*            88  LIFE-CLAIM             VALUE 'L'.
  3687*            88  PROPERTY-CLAIM         VALUE 'P'.
  3688*            88  IUI-CLAIM              VALUE 'I'.
  3689*            88  GAP-CLAIM              VALUE 'G'.
  3690*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  3691         16  CL-CLAIM-PREM-TYPE      PIC X.
  3692             88  SINGLE-PREMIUM         VALUE '1'.
  3693             88  O-B-COVERAGE           VALUE '2'.
  3694             88  OPEN-END-COVERAGE      VALUE '3'.
  3695         16  CL-INCURRED-DT          PIC XX.
  3696         16  CL-REPORTED-DT          PIC XX.
  3697         16  CL-FILE-ESTABLISH-DT    PIC XX.
  3698         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  3699         16  CL-LAST-PMT-DT          PIC XX.
  3700         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  3701         16  CL-PAID-THRU-DT         PIC XX.
  3702         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  3703         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  3704         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  3705         16  CL-PMT-CALC-METHOD      PIC X.
  3706             88  CL-360-DAY-YR          VALUE '1'.
  3707             88  CL-365-DAY-YR          VALUE '2'.
  3708             88  CL-FULL-MONTHS         VALUE '3'.
  3709         16  CL-CAUSE-CD             PIC X(6).
  3710
  3711         16  CL-PRIME-CERT-NO.
  3712             20  CL-PRIME-CERT-PRIME PIC X(10).
  3713             20  CL-PRIME-CERT-SFX   PIC X.
  3714
  3715         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  3716             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  3717             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  3718
  3719         16  CL-MICROFILM-NO         PIC X(10).
  3720         16  FILLER REDEFINES CL-MICROFILM-NO.
  3721             20  CL-BENEFIT-PERIOD   PIC 99.
  3722             20  FILLER              PIC X(8).
  3723         16  CL-PROG-FORM-TYPE       PIC X.
  3724         16  CL-LAST-ADD-ON-DT       PIC XX.
  3725
  3726         16  CL-LAST-REOPEN-DT       PIC XX.
  3727         16  CL-LAST-CLOSE-DT        PIC XX.
  3728         16  CL-LAST-CLOSE-REASON    PIC X(01).
  3729             88  FINAL-PAID             VALUE '1'.
  3730             88  CLAIM-DENIED           VALUE '2'.
  3731             88  AUTO-CLOSE             VALUE '3'.
  3732             88  MANUAL-CLOSE           VALUE '4'.
  3733             88  BENEFITS-CHANGED       VALUE 'C'.
  3734             88  SETUP-ERRORS           VALUE 'E'.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page  69
* EL131.cbl
  3735         16  CL-ASSOC-CERT-SEQU      PIC S99.
  3736         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  3737         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  3738             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  3739         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  3740         16  FILLER                  PIC X.
  3741
  3742     12  CL-CERTIFICATE-DATA.
  3743         16  CL-CERT-ORIGIN          PIC X.
  3744             88  CERT-WAS-ONLINE        VALUE '1'.
  3745             88  CERT-WAS-CREATED       VALUE '2'.
  3746             88  COVERAGE-WAS-ADDED     VALUE '3'.
  3747         16  CL-CERT-KEY-DATA.
  3748             20  CL-CERT-CARRIER     PIC X.
  3749             20  CL-CERT-GROUPING    PIC X(6).
  3750             20  CL-CERT-STATE       PIC XX.
  3751             20  CL-CERT-ACCOUNT.
  3752                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  3753                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  3754             20  CL-CERT-EFF-DT      PIC XX.
  3755
  3756     12  CL-STATUS-CONTROLS.
  3757         16  CL-PRIORITY-CD          PIC X.
  3758             88  CONFIDENTIAL-DATA      VALUE '8'.
  3759             88  HIGHEST-PRIORITY       VALUE '9'.
  3760         16  CL-SUPV-ATTN-CD         PIC X.
  3761             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  3762             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  3763         16  CL-PURGED-DT            PIC XX.
  3764         16  CL-RESTORED-DT          PIC XX.
  3765         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  3766         16  CL-NEXT-RESEND-DT       PIC XX.
  3767         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  3768         16  CL-CRITICAL-PERIOD      PIC 99.
  3769*        16  FILLER                  PIC XX.
  3770         16  CL-LAST-MAINT-DT        PIC XX.
  3771         16  CL-LAST-MAINT-USER      PIC X(4).
  3772         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  3773         16  CL-LAST-MAINT-TYPE      PIC X.
  3774             88  CLAIM-SET-UP           VALUE ' '.
  3775             88  PAYMENT-MADE           VALUE '1'.
  3776             88  LETTER-SENT            VALUE '2'.
  3777             88  MASTER-WAS-ALTERED     VALUE '3'.
  3778             88  MASTER-WAS-RESTORED    VALUE '4'.
  3779             88  INCURRED-DATE-CHANGED  VALUE '5'.
  3780             88  FILE-CONVERTED         VALUE '6'.
  3781             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  3782             88  ERROR-CORRECTION       VALUE 'E'.
  3783         16  CL-RELATED-CLAIM-NO     PIC X(7).
  3784         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  3785         16  CL-BENEFICIARY          PIC X(10).
  3786         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  3787         16  CL-DENIAL-TYPE          PIC X.
  3788             88  CL-TYPE-DENIAL          VALUE '1'.
  3789             88  CL-TYPE-RESCISSION      VALUE '2'.
  3790             88  CL-TYPE-REFORMATION     VALUE '3'.
  3791             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  3792             88  CL-TYPE-RECONSIDERED    VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page  70
* EL131.cbl
  3793         16  CL-NO-OF-EXTENSIONS     PIC 99.
  3794         16  filler                  pic x(3).
  3795*        16  CL-CRIT-PER-RECURRENT   PIC X.
  3796*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  3797*        16  CL-RTW-DT               PIC XX.
  3798
  3799     12  CL-TRAILER-CONTROLS.
  3800         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  3801             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  3802             88  CL-LAST-TRL-AVAIL      VALUE +100.
  3803             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  3804         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  3805         16  FILLER                  PIC XX.
  3806         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  3807         16  CL-ADDRESS-TRAILER-CNT.
  3808             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  3809                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  3810             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  3811                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  3812             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  3813                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  3814             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  3815                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  3816             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  3817                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  3818             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  3819                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  3820             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  3821                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  3822
  3823     12  CL-CV-REFERENCE-NO.
  3824         16  CL-CV-REFNO-PRIME       PIC X(18).
  3825         16  CL-CV-REFNO-SFX         PIC XX.
  3826
  3827     12  CL-FILE-LOCATION            PIC X(4).
  3828
  3829     12  CL-PROCESS-ERRORS.
  3830         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  3831             88  NO-FATAL-ERRORS        VALUE ZERO.
  3832         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  3833             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  3834
  3835     12  CL-PRODUCT-CD               PIC X.
  3836
  3837     12  CL-CURRENT-KEY-DATA.
  3838         16  CL-CURRENT-CARRIER      PIC X.
  3839         16  CL-CURRENT-GROUPING     PIC X(6).
  3840         16  CL-CURRENT-STATE        PIC XX.
  3841         16  CL-CURRENT-ACCOUNT      PIC X(10).
  3842
  3843     12  CL-ASSOCIATES               PIC X.
  3844         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  3845         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  3846         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  3847         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  3848
  3849     12  CL-ACTIVITY-CODE            PIC 99.
  3850     12  CL-ACTIVITY-MAINT-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page  71
* EL131.cbl
  3851     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  3852
  3853     12  CL-LAPSE-REPORT-CODE        PIC 9.
  3854     12  CL-LAG-REPORT-CODE          PIC 9.
  3855     12  CL-LOAN-TYPE                PIC XX.
  3856     12  CL-LEGAL-STATE              PIC XX.
  3857
  3858     12  CL-YESNOSW                  PIC X.
  3859     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  3860         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  3861         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  3862         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  3863     12  cl-insured-type             pic x.
  3864         88  cl-claim-on-primary         value 'P'.
  3865         88  cl-claim-on-co-borrower     value 'C'.
  3866     12  cl-benefit-expiration-dt    PIC XX.
  3867
  3868*                                COPY ELCCERT.
  3869******************************************************************
  3870*                                                                *
  3871*                            ELCCERT.                            *
  3872*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3873*                            VMOD=2.013                          *
  3874*                                                                *
  3875*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  3876*                                                                *
  3877*   FILE TYPE = VSAM,KSDS                                        *
  3878*   RECORD SIZE = 450  RECFORM = FIXED                           *
  3879*                                                                *
  3880*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  3881*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  3882*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  3883*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  3884*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  3885*                                                                *
  3886*   LOG = YES                                                    *
  3887*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3888******************************************************************
  3889*                   C H A N G E   L O G
  3890*
  3891* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3892*-----------------------------------------------------------------
  3893*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3894* EFFECTIVE    NUMBER
  3895*-----------------------------------------------------------------
  3896* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3897* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  3898* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  3899* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  3900* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  3901* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  3902* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3903* 032612  CR2011110200001  PEMA  AHL CHANGES
  3904* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  3905* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  3906******************************************************************
  3907
  3908 01  CERTIFICATE-MASTER.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page  72
* EL131.cbl
  3909     12  CM-RECORD-ID                      PIC XX.
  3910         88  VALID-CM-ID                      VALUE 'CM'.
  3911
  3912     12  CM-CONTROL-PRIMARY.
  3913         16  CM-COMPANY-CD                 PIC X.
  3914         16  CM-CARRIER                    PIC X.
  3915         16  CM-GROUPING.
  3916             20  CM-GROUPING-PREFIX        PIC X(3).
  3917             20  CM-GROUPING-PRIME         PIC X(3).
  3918         16  CM-STATE                      PIC XX.
  3919         16  CM-ACCOUNT.
  3920             20  CM-ACCOUNT-PREFIX         PIC X(4).
  3921             20  CM-ACCOUNT-PRIME          PIC X(6).
  3922         16  CM-CERT-EFF-DT                PIC XX.
  3923         16  CM-CERT-NO.
  3924             20  CM-CERT-PRIME             PIC X(10).
  3925             20  CM-CERT-SFX               PIC X.
  3926
  3927     12  CM-CONTROL-BY-NAME.
  3928         16  CM-COMPANY-CD-A1              PIC X.
  3929         16  CM-INSURED-LAST-NAME          PIC X(15).
  3930         16  CM-INSURED-INITIALS.
  3931             20  CM-INSURED-INITIAL1       PIC X.
  3932             20  CM-INSURED-INITIAL2       PIC X.
  3933
  3934     12  CM-CONTROL-BY-SSN.
  3935         16  CM-COMPANY-CD-A2              PIC X.
  3936         16  CM-SOC-SEC-NO.
  3937             20  CM-SSN-STATE              PIC XX.
  3938             20  CM-SSN-ACCOUNT            PIC X(6).
  3939             20  CM-SSN-LN3.
  3940                 25  CM-INSURED-INITIALS-A2.
  3941                     30 CM-INSURED-INITIAL1-A2   PIC X.
  3942                     30 CM-INSURED-INITIAL2-A2   PIC X.
  3943                 25 CM-PART-LAST-NAME-A2         PIC X.
  3944
  3945     12  CM-CONTROL-BY-CERT-NO.
  3946         16  CM-COMPANY-CD-A4              PIC X.
  3947         16  CM-CERT-NO-A4                 PIC X(11).
  3948
  3949     12  CM-CONTROL-BY-MEMB.
  3950         16  CM-COMPANY-CD-A5              PIC X.
  3951         16  CM-MEMBER-NO.
  3952             20  CM-MEMB-STATE             PIC XX.
  3953             20  CM-MEMB-ACCOUNT           PIC X(6).
  3954             20  CM-MEMB-LN4.
  3955                 25  CM-INSURED-INITIALS-A5.
  3956                     30 CM-INSURED-INITIAL1-A5   PIC X.
  3957                     30 CM-INSURED-INITIAL2-A5   PIC X.
  3958                 25 CM-PART-LAST-NAME-A5         PIC XX.
  3959
  3960     12  CM-INSURED-PROFILE-DATA.
  3961         16  CM-INSURED-FIRST-NAME.
  3962             20  CM-INSURED-1ST-INIT       PIC X.
  3963             20  FILLER                    PIC X(9).
  3964         16  CM-INSURED-ISSUE-AGE          PIC 99.
  3965         16  CM-INSURED-SEX                PIC X.
  3966             88  CM-SEX-MALE                  VALUE 'M'.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page  73
* EL131.cbl
  3967             88  CM-SEX-FEMAL                 VALUE 'F'.
  3968         16  CM-INSURED-JOINT-AGE          PIC 99.
  3969         16  CM-JOINT-INSURED-NAME.
  3970             20  CM-JT-LAST-NAME           PIC X(15).
  3971             20  CM-JT-FIRST-NAME.
  3972                 24  CM-JT-1ST-INIT        PIC X.
  3973                 24  FILLER                PIC X(9).
  3974             20  CM-JT-INITIAL             PIC X.
  3975
  3976     12  CM-LIFE-DATA.
  3977         16  CM-LF-BENEFIT-CD              PIC XX.
  3978         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  3979         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  3980         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  3981         16  CM-LF-DEV-CODE                PIC XXX.
  3982         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  3983         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  3984         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  3985         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  3986         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  3987         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  3988         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  3989         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3990         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  3991         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  3992         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  3993         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  3994         16  cm-temp-epiq                  pic xx.
  3995             88  EPIQ-CLASS                  value 'EQ'.
  3996*        16  FILLER                        PIC XX.
  3997
  3998     12  CM-AH-DATA.
  3999         16  CM-AH-BENEFIT-CD              PIC XX.
  4000         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  4001         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  4002         16  CM-AH-DEV-CODE                PIC XXX.
  4003         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4004         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  4005         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4006         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4007         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4008         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  4009         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  4010         16  CM-AH-PAID-THRU-DT            PIC XX.
  4011             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  4012         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4013         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  4014         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  4015         16  FILLER                        PIC X.
  4016
  4017     12  CM-LOAN-INFORMATION.
  4018         16  CM-LIVES                      PIC S9(7)     COMP-3.
  4019         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  4020                                           PIC S9(5)V99  COMP-3.
  4021         16  CM-BILLED                     PIC S9(7)     COMP-3.
  4022         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  4023         16  CM-PAY-FREQUENCY              PIC S99.
  4024         16  CM-LOAN-TERM                  PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page  74
* EL131.cbl
  4025         16  CM-RATE-CLASS                 PIC XX.
  4026         16  CM-BENEFICIARY                PIC X(25).
  4027         16  CM-POLICY-FORM-NO             PIC X(12).
  4028         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  4029         16  CM-LAST-ADD-ON-DT             PIC XX.
  4030         16  CM-DEDUCTIBLE-AMOUNTS.
  4031             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  4032             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  4033         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4034             20  CM-RESIDENT-STATE         PIC XX.
  4035             20  CM-RATE-CODE              PIC X(4).
  4036             20  FILLER                    PIC XX.
  4037         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4038             20  CM-LOAN-OFFICER           PIC X(5).
  4039             20  FILLER                    PIC XXX.
  4040         16  CM-CSR-CODE                   PIC XXX.
  4041         16  CM-UNDERWRITING-CODE          PIC X.
  4042             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  4043         16  CM-POST-CARD-IND              PIC X.
  4044         16  CM-NH-INTERFACE-SW            PIC X.
  4045         16  CM-PREMIUM-TYPE               PIC X.
  4046             88  CM-SING-PRM                  VALUE '1'.
  4047             88  CM-O-B-COVERAGE              VALUE '2'.
  4048             88  CM-OPEN-END                  VALUE '3'.
  4049         16  CM-IND-GRP-TYPE               PIC X.
  4050             88  CM-INDIVIDUAL                VALUE 'I'.
  4051             88  CM-GROUP                     VALUE 'G'.
  4052         16  CM-SKIP-CODE                  PIC X.
  4053             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  4054             88  SKIP-JULY                    VALUE '1'.
  4055             88  SKIP-AUGUST                  VALUE '2'.
  4056             88  SKIP-SEPTEMBER               VALUE '3'.
  4057             88  SKIP-JULY-AUG                VALUE '4'.
  4058             88  SKIP-AUG-SEPT                VALUE '5'.
  4059             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  4060             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  4061             88  SKIP-JUNE                    VALUE '8'.
  4062             88  SKIP-JUNE-JULY               VALUE '9'.
  4063             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  4064             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  4065         16  CM-PAYMENT-MODE               PIC X.
  4066             88  PAY-MONTHLY                  VALUE SPACE.
  4067             88  PAY-WEEKLY                   VALUE '1'.
  4068             88  PAY-SEMI-MONTHLY             VALUE '2'.
  4069             88  PAY-BI-WEEKLY                VALUE '3'.
  4070             88  PAY-SEMI-ANUALLY             VALUE '4'.
  4071         16  CM-LOAN-NUMBER                PIC X(8).
  4072         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  4073         16  CM-OLD-LOF                    PIC XXX.
  4074*        16  CM-LOAN-OFFICER               PIC XXX.
  4075         16  CM-REIN-TABLE                 PIC XXX.
  4076         16  CM-SPECIAL-REIN-CODE          PIC X.
  4077         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  4078         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  4079         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  4080
  4081     12  CM-STATUS-DATA.
  4082         16  CM-ENTRY-STATUS               PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page  75
* EL131.cbl
  4083         16  CM-ENTRY-DT                   PIC XX.
  4084
  4085         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  4086         16  CM-LF-CANCEL-DT               PIC XX.
  4087         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  4088
  4089         16  CM-LF-STATUS-AT-DEATH         PIC X.
  4090         16  CM-LF-DEATH-DT                PIC XX.
  4091         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  4092
  4093         16  CM-LF-CURRENT-STATUS          PIC X.
  4094             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4095                                                'M' '4' '5' '9'.
  4096             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  4097             88  CM-LF-POLICY-PENDING         VALUE '2'.
  4098             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  4099             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  4100             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  4101             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  4102             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4103             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  4104             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4105             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  4106             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  4107             88  CM-LF-DECLINED               VALUE 'D'.
  4108             88  CM-LF-VOIDED                 VALUE 'V'.
  4109
  4110         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  4111         16  CM-AH-CANCEL-DT               PIC XX.
  4112         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  4113
  4114         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  4115         16  CM-AH-SETTLEMENT-DT           PIC XX.
  4116         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  4117
  4118         16  CM-AH-CURRENT-STATUS          PIC X.
  4119             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4120                                                'M' '4' '5' '9'.
  4121             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  4122             88  CM-AH-POLICY-PENDING         VALUE '2'.
  4123             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  4124             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  4125             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  4126             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  4127             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4128             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  4129             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4130             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  4131             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  4132             88  CM-AH-DECLINED               VALUE 'D'.
  4133             88  CM-AH-VOIDED                 VALUE 'V'.
  4134
  4135         16  CM-CLAIM-INTERFACE-SW         PIC X.
  4136             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  4137             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  4138             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  4139         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  4140
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page  76
* EL131.cbl
  4141         16  CM-ENTRY-BATCH                PIC X(6).
  4142         16  CM-LF-EXIT-BATCH              PIC X(6).
  4143         16  CM-AH-EXIT-BATCH              PIC X(6).
  4144         16  CM-LAST-MONTH-END             PIC XX.
  4145
  4146     12  CM-NOTE-SW                        PIC X.
  4147         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  4148         88  CERT-NOTES-PRESENT               VALUE '1'.
  4149         88  BILLING-NOTES-PRESENT            VALUE '2'.
  4150         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  4151         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  4152         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  4153         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  4154         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  4155     12  CM-COMP-EXCP-SW                   PIC X.
  4156         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  4157         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  4158     12  CM-INSURED-ADDRESS-SW             PIC X.
  4159         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  4160         88  INSURED-ADDR-PRESENT             VALUE '1'.
  4161
  4162*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  4163     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  4164     12  FILLER                            PIC X.
  4165
  4166*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  4167     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  4168     12  FILLER                            PIC X.
  4169*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  4170     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  4171
  4172     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  4173         88  CERT-ADDED-BATCH                 VALUE ' '.
  4174         88  CERT-ADDED-ONLINE                VALUE '1'.
  4175         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  4176         88  CERT-PURGED-OFFLINE              VALUE '3'.
  4177         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  4178     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  4179         88  CERT-AS-LOADED                   VALUE ' '.
  4180         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  4181         88  CERT-CLAIM-ONLINE                VALUE '2'.
  4182         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  4183         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  4184         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  4185         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  4186         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  4187
  4188     12  CM-ACCOUNT-COMM-PCTS.
  4189         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  4190         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  4191
  4192     12  CM-USER-FIELD                     PIC X.
  4193     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  4194     12  CM-CLP-STATE                      PIC XX.
  4195     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  4196     12  CM-USER-RESERVED                  PIC XXX.
  4197     12  FILLER REDEFINES CM-USER-RESERVED.
  4198         16  CM-AH-CLASS-CD                PIC XX.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page  77
* EL131.cbl
  4199         16  F                             PIC X.
  4200******************************************************************
  4201
  4202*                                COPY ELCTRLR.
  4203******************************************************************
  4204*                                                                *
  4205*                            ELCTRLR.                            *
  4206*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4207*                            VMOD=2.014                          *
  4208*                                                                *
  4209*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  4210*                                                                *
  4211*   FILE TYPE = VSAM,KSDS                                        *
  4212*   RECORD SIZE = 200    RECFORM = FIXED                         *
  4213*                                                                *
  4214*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  4215*       ALTERNATE INDEX = NONE                                   *
  4216*                                                                *
  4217*   LOG = YES                                                    *
  4218*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4219******************************************************************
  4220*                   C H A N G E   L O G
  4221*
  4222* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4223*-----------------------------------------------------------------
  4224*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4225* EFFECTIVE    NUMBER
  4226*-----------------------------------------------------------------
  4227* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  4228* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
  4229* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
  4230* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
  4231* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  4232* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  4233* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  4234* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
  4235* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  4236* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  4237* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  4238* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  4239* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAIL
  4240* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
  4241* 021213    2012092400007  AJRA  CAUSAL STATE SEQUENCE NO
  4242* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  4243* 102413  CR2013100800001  AJRA  ADD SPECIAL RELEASE IND
  4244* 022614    2013050100003  AJRA  ADD CERT CANCELLED NOTE TYPE - T
  4245* 040814    2014030500002  AJRA  ADD ICD CODES
  4246* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  4247* 013017  CR2016053100001  PEMA  ACH PROCESSING
  4248* 062217  CR2017050300002  TANA  ADD AUTH RCVD
  4249******************************************************************
  4250 01  ACTIVITY-TRAILERS.
  4251     12  AT-RECORD-ID                    PIC XX.
  4252         88  VALID-AT-ID                       VALUE 'AT'.
  4253
  4254     12  AT-CONTROL-PRIMARY.
  4255         16  AT-COMPANY-CD               PIC X.
  4256         16  AT-CARRIER                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page  78
* EL131.cbl
  4257         16  AT-CLAIM-NO                 PIC X(7).
  4258         16  AT-CERT-NO.
  4259             20  AT-CERT-PRIME           PIC X(10).
  4260             20  AT-CERT-SFX             PIC X.
  4261         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
  4262             88  AT-1ST-TRL-AVAIL             VALUE +4095.
  4263             88  AT-LAST-TRL-AVAIL            VALUE +100.
  4264             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
  4265             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
  4266             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
  4267             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  4268             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
  4269             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
  4270             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  4271             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  4272             88  AT-DIAGNOSIS-TRL             VALUE +90.
  4273             88  AT-BENEFICIARY-TRL           VALUE +91.
  4274             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  4275             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
  4276             88  AT-VFY-CAUSAL-STATE          VALUE +94.
  4277             88  AT-ERROR-MSGS-TRL            VALUE +95.
  4278
  4279     12  AT-TRAILER-TYPE                 PIC X.
  4280         88  RESERVE-EXPENSE-TR               VALUE '1'.
  4281         88  PAYMENT-TR                       VALUE '2'.
  4282         88  AUTO-PAY-TR                      VALUE '3'.
  4283         88  CORRESPONDENCE-TR                VALUE '4'.
  4284         88  ADDRESS-TR                       VALUE '5'.
  4285         88  GENERAL-INFO-TR                  VALUE '6'.
  4286         88  AUTO-PROMPT-TR                   VALUE '7'.
  4287         88  DENIAL-TR                        VALUE '8'.
  4288         88  INCURRED-CHG-TR                  VALUE '9'.
  4289         88  FORM-CONTROL-TR                  VALUE 'A'.
  4290
  4291     12  AT-RECORDED-DT                  PIC XX.
  4292     12  AT-RECORDED-BY                  PIC X(4).
  4293     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  4294
  4295     12  AT-TRAILER-BODY                 PIC X(165).
  4296
  4297     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  4298         16  AT-RESERVE-CONTROLS.
  4299             20  AT-MANUAL-SW            PIC X.
  4300                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  4301             20  AT-FUTURE-SW            PIC X.
  4302                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  4303             20  AT-PTC-SW               PIC X.
  4304                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  4305             20  AT-IBNR-SW              PIC X.
  4306                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  4307             20  AT-PTC-LF-SW            PIC X.
  4308                 88  AT-LF-PTC-USED          VALUE '1'.
  4309             20  AT-CDT-ACCESS-METHOD    PIC X.
  4310                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  4311                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  4312                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  4313             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
  4314         16  AT-LAST-COMPUTED-DT         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page  79
* EL131.cbl
  4315         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
  4316         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
  4317         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
  4318         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  4319         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  4320         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
  4321         16  AT-EXPENSE-CONTROLS.
  4322             20  AT-EXPENSE-METHOD       PIC X.
  4323                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
  4324                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  4325                 88  PERCENT-OF-PMT           VALUE '3'.
  4326                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  4327             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  4328             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
  4329         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  4330         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
  4331
  4332         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  4333         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  4334
  4335*        16  FILLER                      PIC X(53).
  4336         16  FILLER                      PIC X(47).
  4337
  4338         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  4339         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  4340
  4341         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  4342             20  AT-OPEN-CLOSE-DATE      PIC XX.
  4343             20  AT-OPEN-CLOSE-TYPE      PIC X.
  4344*                    C = CLOSED
  4345*                    O = OPEN
  4346             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  4347*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  4348
  4349     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  4350         16  AT-PAYMENT-TYPE             PIC X.
  4351             88  PARTIAL-PAYMENT                VALUE '1'.
  4352             88  FINAL-PAYMENT                  VALUE '2'.
  4353             88  LUMP-SUM-PAYMENT               VALUE '3'.
  4354             88  ADDITIONAL-PAYMENT             VALUE '4'.
  4355             88  CHARGEABLE-EXPENSE             VALUE '5'.
  4356             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  4357             88  VOIDED-PAYMENT                 VALUE '9'.
  4358             88  TRANSFER                       VALUE 'T'.
  4359             88  LIFE-INTEREST                  VALUE 'I'.
  4360
  4361         16  AT-CLAIM-TYPE               PIC X.
  4362             88  PAID-FOR-AH                    VALUE 'A'.
  4363             88  PAID-FOR-LIFE                  VALUE 'L'.
  4364             88  PAID-FOR-IUI                   VALUE 'I'.
  4365             88  PAID-FOR-GAP                   VALUE 'G'.
  4366             88  PAID-FOR-FAM                   VALUE 'F'.
  4367         16  AT-CLAIM-PREM-TYPE          PIC X.
  4368             88  AT-SINGLE-PREMIUM              VALUE '1'.
  4369             88  AT-O-B-COVERAGE                VALUE '2'.
  4370             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  4371         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
  4372         16  AT-CHECK-NO                 PIC X(7).
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page  80
* EL131.cbl
  4373         16  AT-PAID-FROM-DT             PIC XX.
  4374         16  AT-PAID-THRU-DT             PIC XX.
  4375         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
  4376         16  AT-ACH-PAYMENT              PIC X.
  4377*        16  FILLER                      PIC X.
  4378         16  AT-PAYEES-NAME              PIC X(30).
  4379         16  AT-PAYMENT-ORIGIN           PIC X.
  4380             88  ONLINE-MANUAL-PMT              VALUE '1'.
  4381             88  ONLINE-AUTO-PMT                VALUE '2'.
  4382             88  OFFLINE-PMT                    VALUE '3'.
  4383         16  AT-CHECK-WRITTEN-DT         PIC XX.
  4384         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  4385         16  AT-VOID-DATA.
  4386             20  AT-VOID-DT              PIC XX.
  4387*00144       20  AT-VOID-REASON          PIC X(30).
  4388             20  AT-VOID-REASON          PIC X(26).
  4389         16  AT-PMT-APPROVED-BY          PIC X(04).
  4390         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
  4391         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  4392         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  4393                                         PIC S99V9(5)  COMP-3.
  4394         16  AT-CREDIT-INTERFACE.
  4395             20  AT-PMT-SELECT-DT        PIC XX.
  4396                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  4397             20  AT-PMT-ACCEPT-DT        PIC XX.
  4398                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  4399             20  AT-VOID-SELECT-DT       PIC XX.
  4400                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  4401             20  AT-VOID-ACCEPT-DT       PIC XX.
  4402                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
  4403
  4404         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
  4405                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  4406                 88  CONVERSION-PAYMENT           VALUE +99999999.
  4407         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  4408
  4409         16  AT-FORCE-CONTROL            PIC X.
  4410             88  PAYMENT-WAS-FORCED           VALUE '1'.
  4411         16  AT-PREV-LAST-PMT-DT         PIC XX.
  4412         16  AT-PREV-PAID-THRU-DT        PIC XX.
  4413         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  4414         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  4415         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  4416         16  AT-BENEFIT-TYPE             PIC X.
  4417
  4418         16  AT-EXPENSE-TYPE             PIC X.
  4419         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  4420
  4421         16  AT-PAYEE-TYPE-CD.
  4422             20  AT-PAYEE-TYPE           PIC X.
  4423                 88  INSURED-PAID           VALUE 'I'.
  4424                 88  BENEFICIARY-PAID       VALUE 'B'.
  4425                 88  ACCOUNT-PAID           VALUE 'A'.
  4426                 88  OTHER-1-PAID           VALUE 'O'.
  4427                 88  OTHER-2-PAID           VALUE 'Q'.
  4428                 88  DOCTOR-PAID            VALUE 'P'.
  4429                 88  EMPLOYER-PAID          VALUE 'E'.
  4430             20  AT-PAYEE-SEQ            PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page  81
* EL131.cbl
  4431
  4432         16  AT-CASH-PAYMENT             PIC X.
  4433         16  AT-GROUPED-PAYMENT          PIC X.
  4434         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
  4435         16  AT-APPROVAL-LEVEL-REQD      PIC X.
  4436         16  AT-APPROVED-LEVEL           PIC X.
  4437         16  AT-VOID-TYPE                PIC X.
  4438             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
  4439             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
  4440         16  AT-AIG-UNEMP-IND            PIC X.
  4441             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
  4442         16  AT-ASSOCIATES               PIC X.
  4443             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
  4444             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  4445
  4446         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
  4447         16  AT-CV-PMT-CODE              PIC X.
  4448             88  FULL-DEATH-PAYMENT         VALUE '1'.
  4449             88  HALF-DEATH-PAYMENT         VALUE '2'.
  4450             88  FULL-ADD-PAYMENT           VALUE '3'.
  4451             88  HALF-ADD-PAYMENT           VALUE '4'.
  4452             88  FULL-RIDER-PAYMENT         VALUE '5'.
  4453             88  HALF-RIDER-PAYMENT         VALUE '6'.
  4454             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  4455             88  ADDL-PAYMENT               VALUE '8'.
  4456
  4457         16  AT-EOB-CODE1                PIC XXX.
  4458         16  AT-EOB-CODE2                PIC XXX.
  4459         16  AT-EOB-CODE3                PIC XXX.
  4460         16  FILLER REDEFINES AT-EOB-CODE3.
  4461             20  AT-PRINT-CLM-FORM       PIC X.
  4462             20  AT-PRINT-SURVEY         PIC X.
  4463             20  AT-SPECIAL-RELEASE      PIC X.
  4464         16  AT-EOB-CODE4                PIC XXX.
  4465         16  FILLER REDEFINES AT-EOB-CODE4.
  4466             20  AT-INT-PMT-SELECT-DT    PIC XX.
  4467             20  FILLER                  PIC X.
  4468         16  AT-EOB-CODE5                PIC XXX.
  4469         16  FILLER REDEFINES AT-EOB-CODE5.
  4470             20  AT-PMT-PROOF-DT         PIC XX.
  4471             20  FILLER                  PIC X.
  4472
  4473         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  4474             88  AT-PRINT-EOB            VALUE 'Y'.
  4475
  4476         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  4477         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  4478
  4479     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  4480         16  AT-SCHEDULE-START-DT        PIC XX.
  4481         16  AT-SCHEDULE-END-DT          PIC XX.
  4482         16  AT-TERMINATED-DT            PIC XX.
  4483         16  AT-LAST-PMT-TYPE            PIC X.
  4484             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  4485             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  4486         16  AT-FIRST-PMT-DATA.
  4487             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
  4488             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page  82
* EL131.cbl
  4489             20  AT-1ST-PAY-THRU-DT      PIC XX.
  4490         16  AT-REGULAR-PMT-DATA.
  4491             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
  4492             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
  4493             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
  4494         16  AT-AUTO-PAYEE-CD.
  4495             20  AT-AUTO-PAYEE-TYPE      PIC X.
  4496                 88  INSURED-PAID-AUTO      VALUE 'I'.
  4497                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
  4498                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
  4499                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
  4500                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  4501             20  AT-AUTO-PAYEE-SEQ       PIC X.
  4502         16  AT-AUTO-PAY-DAY             PIC 99.
  4503         16  AT-AUTO-CASH                PIC X.
  4504             88  AT-CASH                      VALUE 'Y'.
  4505             88  AT-NON-CASH                  VALUE 'N'.
  4506*        16  FILLER                      PIC X(129).
  4507         16  AT-AUTO-END-LETTER          PIC X(4).
  4508         16  FILLER                      PIC X(125).
  4509
  4510         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
  4511         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  4512
  4513     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  4514         16  AT-LETTER-SENT-DT           PIC XX.
  4515         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  4516         16  AT-AUTO-RE-SEND-DT          PIC XX.
  4517         16  AT-LETTER-ANSWERED-DT       PIC XX.
  4518         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  4519         16  AT-LETTER-ORIGIN            PIC X.
  4520             88  ONLINE-CREATION              VALUE '1' '3'.
  4521             88  OFFLINE-CREATION             VALUE '2' '4'.
  4522             88  NAPER-ONLINE-CREATION        VALUE '3'.
  4523             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  4524         16  AT-STD-LETTER-FORM          PIC X(4).
  4525         16  AT-REASON-TEXT              PIC X(70).
  4526         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  4527         16  AT-ADDRESEE-TYPE            PIC X.
  4528              88  INSURED-ADDRESEE            VALUE 'I'.
  4529              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  4530              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  4531              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  4532              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  4533              88  OTHER-ADDRESEE-1            VALUE 'O'.
  4534              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  4535         16  AT-ADDRESSEE-NAME           PIC X(30).
  4536         16  AT-INITIAL-PRINT-DATE       PIC XX.
  4537         16  AT-RESEND-PRINT-DATE        PIC XX.
  4538         16  AT-CORR-SOL-UNSOL           PIC X.
  4539         16  AT-LETTER-PURGED-DT         PIC XX.
  4540*
  4541*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  4542*
  4543         16  AT-CSO-REDEFINITION.
  4544             20  AT-RESEND-LETTER-FORM   PIC X(4).
  4545             20  AT-AUTO-CLOSE-IND       PIC X(1).
  4546             20  AT-LETTER-TO-BENE       PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page  83
* EL131.cbl
  4547             20  AT-STOP-LETTER-DT       PIC X(2).
  4548             20  AT-AUTH-RCVD            PIC X(1).
  4549             20  FILLER                  PIC X(18).
  4550*             20  FILLER                  PIC X(27).
  4551             20  AT-CSO-LETTER-STATUS    PIC X.
  4552                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  4553                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
  4554                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  4555             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
  4556             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  4557*
  4558*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  4559*
  4560*        16  FILLER                      PIC X(26).
  4561*
  4562*        16  AT-DMD-BSR-CODE             PIC X.
  4563*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  4564*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  4565*
  4566*        16  AT-DMD-LETTER-STATUS        PIC X.
  4567*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
  4568*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  4569*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
  4570*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  4571*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  4572
  4573         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  4574         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  4575
  4576     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  4577         16  AT-ADDRESS-TYPE             PIC X.
  4578             88  INSURED-ADDRESS               VALUE 'I'.
  4579             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  4580             88  ACCOUNT-ADDRESS               VALUE 'A'.
  4581             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  4582             88  EMPLOYER-ADDRESS              VALUE 'E'.
  4583             88  OTHER-ADDRESS-1               VALUE 'O'.
  4584             88  OTHER-ADDRESS-2               VALUE 'Q'.
  4585         16  AT-MAIL-TO-NAME             PIC X(30).
  4586         16  AT-ADDRESS-LINE-1           PIC X(30).
  4587         16  AT-ADDRESS-LINE-2           PIC X(30).
  4588         16  AT-CITY-STATE.
  4589             20  AT-CITY                 PIC X(28).
  4590             20  AT-STATE                PIC XX.
  4591         16  AT-ZIP.
  4592             20  AT-ZIP-CODE.
  4593                 24  AT-ZIP-1ST          PIC X.
  4594                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4595                 24  FILLER              PIC X(4).
  4596             20  AT-ZIP-PLUS4            PIC X(4).
  4597         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  4598             20  AT-CAN-POSTAL-1         PIC XXX.
  4599             20  AT-CAN-POSTAL-2         PIC XXX.
  4600             20  FILLER                  PIC XXX.
  4601         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  4602*         16  FILLER                      PIC X(23).
  4603         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
  4604         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page  84
* EL131.cbl
  4605         16  FILLER                      PIC X(13).
  4606         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  4607         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
  4608
  4609     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  4610         16  AT-INFO-LINE-1              PIC X(60).
  4611         16  FILLER REDEFINES AT-INFO-LINE-1.
  4612             20  AT-NOTE-ERROR-NO OCCURS 15
  4613                                         PIC X(4).
  4614         16  AT-INFO-LINE-2              PIC X(60).
  4615         16  FILLER REDEFINES AT-INFO-LINE-2.
  4616             20  AT-ICD-CODE-1           PIC X(8).
  4617             20  AT-ICD-CODE-2           PIC X(8).
  4618             20  FILLER                  PIC X(44).
  4619         16  AT-INFO-TRAILER-TYPE        PIC X.
  4620             88  AT-ERRORS-NOTE          VALUE 'E'.
  4621             88  AT-PAYMENT-NOTE         VALUE 'P'.
  4622             88  AT-CALL-NOTE            VALUE 'C'.
  4623             88  AT-MAINT-NOTE           VALUE 'M'.
  4624             88  AT-CERT-CHANGE          VALUE 'X'.
  4625             88  AT-APPROVAL-NOTE        VALUE 'R'.
  4626             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  4627             88  AT-CERT-CANCELLED       VALUE 'T'.
  4628         16  AT-CALL-TYPE                PIC X.
  4629             88  AT-PHONE-CALL-IN        VALUE 'I'.
  4630             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  4631         16  AT-NOTE-CONTINUATION        PIC X.
  4632             88  AT-CONTINUED-NOTE       VALUE 'X'.
  4633         16  AT-EOB-CODES-EXIST          PIC X.
  4634             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
  4635         16  FILLER                      PIC X(35).
  4636         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  4637         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  4638
  4639     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
  4640         16  AT-PROMPT-LINE-1            PIC X(60).
  4641         16  AT-PROMPT-LINE-2            PIC X(60).
  4642         16  AT-PROMPT-START-DT          PIC XX.
  4643         16  AT-PROMPT-END-DT            PIC XX.
  4644         16  FILLER                      PIC X(35).
  4645         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  4646         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  4647
  4648     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  4649         16  AT-DENIAL-INFO-1            PIC X(60).
  4650         16  AT-DENIAL-INFO-2            PIC X(60).
  4651         16  AT-DENIAL-DT                PIC XX.
  4652         16  AT-RETRACTION-DT            PIC XX.
  4653         16  AT-DENIAL-REASON-CODE       PIC X(4).
  4654*         16  FILLER                      PIC X(31).
  4655         16  AT-DENIAL-PROOF-DT          PIC XX.
  4656         16  FILLER                      PIC X(29).
  4657         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  4658         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  4659
  4660     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  4661         16  AT-OLD-INCURRED-DT          PIC XX.
  4662         16  AT-OLD-REPORTED-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page  85
* EL131.cbl
  4663         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  4664         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  4665         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
  4666         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  4667         16  AT-OLD-PAID-THRU-DT         PIC XX.
  4668         16  AT-LAST-PMT-MADE-DT         PIC XX.
  4669         16  FILLER                      PIC X(26).
  4670         16  AT-OLD-DIAG-CODE            PIC X(6).
  4671         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  4672         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  4673         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  4674         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  4675         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  4676         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  4677         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  4678         16  AT-OLD-ICD-CODE-1           PIC X(8).
  4679         16  AT-OLD-ICD-CODE-2           PIC X(8).
  4680         16  FILLER                      PIC X(9).
  4681         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  4682
  4683     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  4684         16  AT-FORM-SEND-ON-DT          PIC XX.
  4685         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  4686         16  AT-FORM-RE-SEND-DT          PIC XX.
  4687         16  AT-FORM-ANSWERED-DT         PIC XX.
  4688         16  AT-FORM-PRINTED-DT          PIC XX.
  4689         16  AT-FORM-REPRINT-DT          PIC XX.
  4690         16  AT-FORM-TYPE                PIC X.
  4691             88  INITIAL-FORM                  VALUE '1'.
  4692             88  PROGRESS-FORM                 VALUE '2'.
  4693         16  AT-INSTRUCT-LN-1            PIC X(28).
  4694         16  AT-INSTRUCT-LN-2            PIC X(28).
  4695         16  AT-INSTRUCT-LN-3            PIC X(28).
  4696         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  4697         16  AT-FORM-ADDRESS             PIC X.
  4698             88  FORM-TO-INSURED              VALUE 'I'.
  4699             88  FORM-TO-ACCOUNT              VALUE 'A'.
  4700             88  FORM-TO-OTHER-1              VALUE 'O'.
  4701             88  FORM-TO-OTHER-2              VALUE 'Q'.
  4702         16  AT-RELATED-1.
  4703             20 AT-REL-CARR-1            PIC X.
  4704             20 AT-REL-CLAIM-1           PIC X(7).
  4705             20 AT-REL-CERT-1            PIC X(11).
  4706         16  AT-RELATED-2.
  4707             20 AT-REL-CARR-2            PIC X.
  4708             20 AT-REL-CLAIM-2           PIC X(7).
  4709             20 AT-REL-CERT-2            PIC X(11).
  4710         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  4711         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  4712         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  4713         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  4714         16  AT-FORM-REM-PRINT-DT        PIC XX.
  4715         16  AT-STOP-FORM-DT             PIC X(2).
  4716
  4717         16  FILLER                      PIC X(09).
  4718         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  4719         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
  4720******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page  86
* EL131.cbl
  4721
  4722*                                COPY ELCCNTL.
  4723******************************************************************
  4724*                                                                *
  4725*                                                                *
  4726*                            ELCCNTL.                            *
  4727*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4728*                            VMOD=2.059                          *
  4729*                                                                *
  4730*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  4731*                                                                *
  4732*   FILE TYPE = VSAM,KSDS                                        *
  4733*   RECORD SIZE = 750  RECFORM = FIXED                           *
  4734*                                                                *
  4735*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  4736*       ALTERNATE INDEX = NONE                                   *
  4737*                                                                *
  4738*   LOG = YES                                                    *
  4739*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4740******************************************************************
  4741*                   C H A N G E   L O G
  4742*
  4743* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4744*-----------------------------------------------------------------
  4745*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4746* EFFECTIVE    NUMBER
  4747*-----------------------------------------------------------------
  4748* 082503                   PEMA  ADD BENEFIT GROUP
  4749* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4750* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  4751* 092705    2005050300006  PEMA  ADD SPP LEASES
  4752* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  4753* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  4754* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  4755* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  4756* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  4757* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  4758* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  4759* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  4760* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  4761* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  4762******************************************************************
  4763*
  4764 01  CONTROL-FILE.
  4765     12  CF-RECORD-ID                       PIC XX.
  4766         88  VALID-CF-ID                        VALUE 'CF'.
  4767
  4768     12  CF-CONTROL-PRIMARY.
  4769         16  CF-COMPANY-ID                  PIC XXX.
  4770         16  CF-RECORD-TYPE                 PIC X.
  4771             88  CF-COMPANY-MASTER              VALUE '1'.
  4772             88  CF-PROCESSOR-MASTER            VALUE '2'.
  4773             88  CF-STATE-MASTER                VALUE '3'.
  4774             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  4775             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  4776             88  CF-CARRIER-MASTER              VALUE '6'.
  4777             88  CF-MORTALITY-MASTER            VALUE '7'.
  4778             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page  87
* EL131.cbl
  4779             88  CF-TERMINAL-MASTER             VALUE '9'.
  4780             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  4781             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  4782             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  4783             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  4784             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  4785             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  4786             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  4787             88  CF-REMINDERS-MASTER            VALUE 'R'.
  4788             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  4789         16  CF-ACCESS-CD-GENL              PIC X(4).
  4790         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  4791             20  CF-PROCESSOR               PIC X(4).
  4792         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  4793             20  CF-STATE-CODE              PIC XX.
  4794             20  FILLER                     PIC XX.
  4795         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  4796             20  FILLER                     PIC XX.
  4797             20  CF-HI-BEN-IN-REC           PIC XX.
  4798         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  4799             20  FILLER                     PIC XXX.
  4800             20  CF-CARRIER-CNTL            PIC X.
  4801         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  4802             20  FILLER                     PIC XX.
  4803             20  CF-HI-TYPE-IN-REC          PIC 99.
  4804         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  4805             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  4806                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  4807             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  4808             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  4809         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  4810             20  FILLER                     PIC X.
  4811             20  CF-CUSTOM-REPORT-NO        PIC 999.
  4812         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  4813             20  FILLER                     PIC XX.
  4814             20  CF-MORTGAGE-PLAN           PIC XX.
  4815         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  4816
  4817     12  CF-LAST-MAINT-DT                   PIC XX.
  4818     12  CF-LAST-MAINT-BY                   PIC X(4).
  4819     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  4820
  4821     12  CF-RECORD-BODY                     PIC X(728).
  4822
  4823
  4824****************************************************************
  4825*             COMPANY MASTER RECORD                            *
  4826****************************************************************
  4827
  4828     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4829         16  CF-COMPANY-ADDRESS.
  4830             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  4831             20  CF-CL-IN-CARE-OF           PIC X(30).
  4832             20  CF-CL-ADDR-LINE-1          PIC X(30).
  4833             20  CF-CL-ADDR-LINE-2          PIC X(30).
  4834             20  CF-CL-CITY-STATE           PIC X(30).
  4835             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  4836             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page  88
* EL131.cbl
  4837         16  CF-COMPANY-CD                  PIC X.
  4838         16  CF-COMPANY-PASSWORD            PIC X(8).
  4839         16  CF-SECURITY-OPTION             PIC X.
  4840             88  ALL-SECURITY                   VALUE '1'.
  4841             88  COMPANY-VERIFY                 VALUE '2'.
  4842             88  PROCESSOR-VERIFY               VALUE '3'.
  4843             88  NO-SECURITY                    VALUE '4'.
  4844             88  ALL-BUT-TERM                   VALUE '5'.
  4845         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  4846             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  4847         16  CF-LGX-INTERFACE-CNTL          PIC X.
  4848             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  4849         16  CF-INFORCE-LOCATION            PIC X.
  4850             88  CERTS-ARE-ONLINE               VALUE '1'.
  4851             88  CERTS-ARE-OFFLINE              VALUE '2'.
  4852             88  NO-CERTS-AVAILABLE             VALUE '3'.
  4853         16  CF-LOWER-CASE-LETTERS          PIC X.
  4854         16  CF-CERT-ACCESS-CONTROL         PIC X.
  4855             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  4856             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  4857             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  4858             88  CF-ACCNT-CNTL                  VALUE '3'.
  4859             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  4860
  4861         16  CF-FORMS-PRINTER-ID            PIC X(4).
  4862         16  CF-CHECK-PRINTER-ID            PIC X(4).
  4863
  4864         16  CF-LGX-CREDIT-USER             PIC X.
  4865             88  CO-IS-NOT-USER                 VALUE 'N'.
  4866             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  4867
  4868         16 CF-CREDIT-CALC-CODES.
  4869             20  CF-CR-REM-TERM-CALC PIC X.
  4870               88  CR-EARN-AFTER-15TH           VALUE '1'.
  4871               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  4872               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  4873               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  4874               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  4875               88  CR-EARN-AFTER-14TH           VALUE '6'.
  4876               88  CR-EARN-AFTER-16TH           VALUE '7'.
  4877             20  CF-CR-R78-METHOD           PIC X.
  4878               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  4879               88  DONT-USE-PLUS-ONE            VALUE '1'.
  4880
  4881         16  CF-CLAIM-CONTROL-COUNTS.
  4882             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  4883                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  4884
  4885             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  4886                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  4887
  4888             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  4889                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  4890
  4891             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  4892                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  4893
  4894         16  CF-CURRENT-MONTH-END           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page  89
* EL131.cbl
  4895
  4896         16  CF-CO-CALC-QUOTE-TOLERANCE.
  4897             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  4898             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  4899             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  4900             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  4901                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4902                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4903             20  CF-CO-PREM-REJECT-SW       PIC X.
  4904                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  4905                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  4906             20  CF-CO-REF-REJECT-SW        PIC X.
  4907                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  4908                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  4909
  4910         16  CF-CO-REPORTING-DT             PIC XX.
  4911         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  4912         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  4913           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  4914           88  CF-CO-MONTH-END                  VALUE '1'.
  4915
  4916         16  CF-LGX-CLAIM-USER              PIC X.
  4917             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  4918             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  4919
  4920         16  CF-CREDIT-EDIT-CONTROLS.
  4921             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  4922             20  CF-MIN-AGE                 PIC 99.
  4923             20  CF-DEFAULT-AGE             PIC 99.
  4924             20  CF-MIN-TERM                PIC S999      COMP-3.
  4925             20  CF-MAX-TERM                PIC S999      COMP-3.
  4926             20  CF-DEFAULT-SEX             PIC X.
  4927             20  CF-JOINT-AGE-INPUT         PIC X.
  4928                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  4929             20  CF-BIRTH-DATE-INPUT        PIC X.
  4930                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  4931             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  4932                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  4933                 88  CF-ZERO-CARRIER            VALUE '1'.
  4934                 88  CF-ZERO-GROUPING           VALUE '2'.
  4935                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  4936             20  CF-EDIT-SW                 PIC X.
  4937                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  4938             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  4939             20  CF-CR-PR-METHOD            PIC X.
  4940               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  4941               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  4942             20  FILLER                     PIC X.
  4943
  4944         16  CF-CREDIT-MISC-CONTROLS.
  4945             20  CF-REIN-TABLE-SW           PIC X.
  4946                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  4947             20  CF-COMP-TABLE-SW           PIC X.
  4948                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  4949             20  CF-EXPERIENCE-RETENTION-AGE
  4950                                            PIC S9        COMP-3.
  4951             20  CF-CONVERSION-DT           PIC XX.
  4952             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page  90
* EL131.cbl
  4953             20  CF-RUN-FREQUENCY-SW        PIC X.
  4954                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  4955                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  4956
  4957             20  CF-CR-CHECK-NO-CONTROL.
  4958                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  4959                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  4960                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  4961                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  4962                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  4963                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  4964
  4965                 24  CF-CR-CHECK-COUNT       REDEFINES
  4966                     CF-CR-CHECK-COUNTER      PIC X(4).
  4967
  4968                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  4969                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  4970
  4971                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  4972                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  4973                 24  CF-MAIL-PROCESSING       PIC X.
  4974                     88  MAIL-PROCESSING          VALUE 'Y'.
  4975
  4976         16  CF-MISC-SYSTEM-CONTROL.
  4977             20  CF-SYSTEM-C                 PIC X.
  4978                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  4979             20  CF-SYSTEM-D                 PIC X.
  4980                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  4981             20  CF-SOC-SEC-NO-SW            PIC X.
  4982                 88  SOC-SEC-NO-USED             VALUE '1'.
  4983             20  CF-MEMBER-NO-SW             PIC X.
  4984                 88  MEMBER-NO-USED              VALUE '1'.
  4985             20  CF-TAX-ID-NUMBER            PIC X(11).
  4986             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  4987             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  4988                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  4989                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  4990                 88  CF-ALL-APPROVED             VALUE 'Y'.
  4991                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  4992             20  CF-SYSTEM-E                 PIC X.
  4993                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  4994
  4995         16  CF-LGX-LIFE-USER               PIC X.
  4996             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  4997             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  4998
  4999         16  CF-CR-MONTH-END-DT             PIC XX.
  5000
  5001         16  CF-FILE-MAINT-DATES.
  5002             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  5003                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  5004             20  CF-LAST-BATCH       REDEFINES
  5005                 CF-LAST-BATCH-NO               PIC X(4).
  5006             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  5007             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  5008             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  5009             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  5010             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page  91
* EL131.cbl
  5011             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  5012             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  5013             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  5014             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  5015             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  5016
  5017         16  CF-NEXT-COMPANY-ID             PIC XXX.
  5018         16  FILLER                         PIC X.
  5019
  5020         16  CF-ALT-MORT-CODE               PIC X(4).
  5021         16  CF-MEMBER-CAPTION              PIC X(10).
  5022
  5023         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  5024             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  5025             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  5026             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  5027             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  5028             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  5029
  5030         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  5031
  5032         16  CF-LIFE-OVERRIDE-L1            PIC X.
  5033         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  5034         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  5035         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  5036
  5037         16  CF-AH-OVERRIDE-L1              PIC X.
  5038         16  CF-AH-OVERRIDE-L2              PIC XX.
  5039         16  CF-AH-OVERRIDE-L6              PIC X(6).
  5040         16  CF-AH-OVERRIDE-L12             PIC X(12).
  5041
  5042         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  5043         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  5044
  5045         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  5046         16  CF-AR-LAST-EL860-DT            PIC XX.
  5047         16  CF-MP-MONTH-END-DT             PIC XX.
  5048
  5049         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  5050         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  5051             88  CF-CLAIM-PAID-TO               VALUE '1'.
  5052
  5053         16  CF-AR-MONTH-END-DT             PIC XX.
  5054
  5055         16  CF-CRDTCRD-USER                PIC X.
  5056             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  5057             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  5058
  5059         16  CF-CC-MONTH-END-DT             PIC XX.
  5060
  5061         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  5062
  5063         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  5064             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  5065             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  5066             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  5067         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  5068         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page  92
* EL131.cbl
  5069         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  5070         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  5071             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  5072             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  5073         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  5074         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  5075         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  5076             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  5077         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  5078
  5079         16  CF-CL-ZIP-CODE.
  5080             20  CF-CL-ZIP-PRIME.
  5081                 24  CF-CL-ZIP-1ST          PIC X.
  5082                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  5083                 24  FILLER                 PIC X(4).
  5084             20  CF-CL-ZIP-PLUS4            PIC X(4).
  5085         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  5086             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  5087             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  5088             20  FILLER                     PIC XXX.
  5089
  5090         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  5091         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  5092         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  5093         16  CF-CO-OPTION-START-DATE        PIC XX.
  5094         16  CF-REM-TRM-CALC-OPTION         PIC X.
  5095           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  5096                                                      '3' '4'.
  5097           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  5098           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  5099           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  5100           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  5101           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  5102           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  5103
  5104         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  5105
  5106         16  CF-PAYMENT-APPROVAL-LEVELS.
  5107             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  5108             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  5109             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  5110             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  5111             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  5112             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  5113
  5114         16  CF-END-USER-REPORTING-USER     PIC X.
  5115             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  5116             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  5117
  5118         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  5119             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  5120             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  5121
  5122         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  5123
  5124         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  5125         16  FILLER                         PIC X.
  5126
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page  93
* EL131.cbl
  5127         16  CF-CREDIT-ARCHIVE-CNTL.
  5128             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  5129             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  5130             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  5131
  5132         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  5133
  5134         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  5135             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  5136             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  5137
  5138         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  5139             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  5140             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  5141
  5142         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  5143
  5144         16  CF-CO-ACH-ID-CODE              PIC  X.
  5145             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  5146             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  5147             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  5148         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  5149         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  5150         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  5151         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  5152         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  5153         16  CF-CO-ACH-RECV-NO              PIC X(08).
  5154         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  5155         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  5156         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  5157                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  5158         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  5159                 CF-CO-ACH-TRACE-NO         PIC X(4).
  5160
  5161         16  CF-CO-OVER-SHORT.
  5162             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5163             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5164
  5165*         16  FILLER                         PIC X(102).
  5166         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  5167             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  5168             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  5169
  5170         16  CF-AH-APPROVAL-DAYS.
  5171             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  5172             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  5173             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  5174             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  5175
  5176         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  5177
  5178         16  CF-APPROV-LEV-5.
  5179             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  5180             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  5181             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  5182
  5183         16  FILLER                         PIC X(68).
  5184****************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page  94
* EL131.cbl
  5185*             PROCESSOR/USER RECORD                            *
  5186****************************************************************
  5187
  5188     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5189         16  CF-PROCESSOR-NAME              PIC X(30).
  5190         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  5191         16  CF-PROCESSOR-TITLE             PIC X(26).
  5192         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  5193                 88  MESSAGE-YES                VALUE 'Y'.
  5194                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  5195
  5196*****************************************************
  5197****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  5198****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  5199****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  5200****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  5201*****************************************************
  5202
  5203         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  5204             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  5205             20  CF-APPLICATION-FORCE       PIC X.
  5206             20  CF-INDIVIDUAL-APP.
  5207                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  5208                     28  CF-BROWSE-APP      PIC X.
  5209                     28  CF-UPDATE-APP      PIC X.
  5210
  5211         16  CF-CURRENT-TERM-ON             PIC X(4).
  5212         16  CF-PROCESSOR-LIMITS-CLAIMS.
  5213             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  5214             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  5215             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  5216             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  5217             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  5218             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  5219             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  5220         16  CF-PROCESSOR-CARRIER           PIC X.
  5221             88  NO-CARRIER-SECURITY            VALUE ' '.
  5222         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  5223             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  5224         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  5225             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  5226         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  5227             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  5228
  5229         16  CF-PROC-SYS-ACCESS-SW.
  5230             20  CF-PROC-CREDIT-CLAIMS-SW.
  5231                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  5232                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  5233                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  5234                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  5235             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  5236                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  5237                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  5238             20  CF-PROC-LIFE-GNRLDGR-SW.
  5239                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  5240                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  5241                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  5242                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page  95
* EL131.cbl
  5243             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  5244                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  5245                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  5246         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  5247             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  5248             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  5249         16  CF-PROCESSOR-PRINTER               PIC X(4).
  5250
  5251         16  CF-APPROVAL-LEVEL                  PIC X.
  5252             88  APPROVAL-LEVEL-1                   VALUE '1'.
  5253             88  APPROVAL-LEVEL-2                   VALUE '2'.
  5254             88  APPROVAL-LEVEL-3                   VALUE '3'.
  5255             88  APPROVAL-LEVEL-4                   VALUE '4'.
  5256             88  APPROVAL-LEVEL-5                   VALUE '5'.
  5257
  5258         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  5259
  5260         16  CF-LANGUAGE-TYPE                   PIC X.
  5261             88  CF-LANG-IS-ENG                     VALUE 'E'.
  5262             88  CF-LANG-IS-FR                      VALUE 'F'.
  5263
  5264         16  CF-CSR-IND                         PIC X.
  5265         16  FILLER                             PIC X(239).
  5266
  5267****************************************************************
  5268*             PROCESSOR/REMINDERS RECORD                       *
  5269****************************************************************
  5270
  5271     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  5272         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  5273             20  CF-START-REMIND-DT         PIC XX.
  5274             20  CF-END-REMIND-DT           PIC XX.
  5275             20  CF-REMINDER-TEXT           PIC X(50).
  5276         16  FILLER                         PIC X(296).
  5277
  5278
  5279****************************************************************
  5280*             STATE MASTER RECORD                              *
  5281****************************************************************
  5282
  5283     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5284         16  CF-STATE-ABBREVIATION          PIC XX.
  5285         16  CF-STATE-NAME                  PIC X(25).
  5286         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  5287         16  CF-ST-CALC-QUOTE-TOLERANCE.
  5288             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  5289             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  5290             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  5291             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  5292                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5293                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5294             20  CF-ST-PREM-REJECT-SW       PIC X.
  5295                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  5296                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  5297             20  CF-ST-REF-REJECT-SW        PIC X.
  5298                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  5299                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  5300         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page  96
* EL131.cbl
  5301         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  5302         16  CF-ST-REFUND-RULES.
  5303             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  5304             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  5305             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  5306         16  CF-ST-FST-PMT-EXTENSION.
  5307             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  5308             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  5309                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  5310                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  5311                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  5312                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  5313         16  CF-ST-STATE-CALL.
  5314             20  CF-ST-CALL-UNEARNED        PIC X.
  5315             20  CF-ST-CALL-RPT-CNTL        PIC X.
  5316             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  5317         16  CF-REPLACEMENT-LAW-SW          PIC X.
  5318             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  5319             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  5320         16  CF-REPLACEMENT-LETTER          PIC X(4).
  5321         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  5322         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  5323         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  5324         16  CF-ST-SPLIT-PAYMENT            PIC X.
  5325         16  FILLER                         PIC X.
  5326         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  5327             20  CF-ST-BENEFIT-CD           PIC XX.
  5328             20  CF-ST-BENEFIT-KIND         PIC X.
  5329                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  5330                 88  CF-ST-AH-KIND              VALUE 'A'.
  5331             20  CF-ST-REM-TERM-CALC        PIC X.
  5332                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  5333                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  5334                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  5335                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  5336                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  5337                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  5338                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  5339                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  5340
  5341             20  CF-ST-REFUND-CALC          PIC X.
  5342                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  5343                 88  ST-REFD-BY-R78             VALUE '1'.
  5344                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  5345                 88  ST-REFD-AS-CALIF           VALUE '3'.
  5346                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  5347                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  5348                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  5349                 88  ST-REFD-UTAH               VALUE '7'.
  5350                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  5351                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  5352                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  5353
  5354             20  CF-ST-EARNING-CALC         PIC X.
  5355                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  5356                 88  ST-EARN-BY-R78             VALUE '1'.
  5357                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  5358                 88  ST-EARN-AS-CALIF           VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page  97
* EL131.cbl
  5359                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  5360                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  5361                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  5362                 88  ST-EARN-MEAN               VALUE '8'.
  5363                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  5364
  5365             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  5366                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  5367                 88  ST-OVRD-BY-R78             VALUE '1'.
  5368                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  5369                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  5370                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  5371                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  5372                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  5373                 88  ST-OVRD-MEAN               VALUE '8'.
  5374                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  5375             20  cf-st-extra-periods        pic 9.
  5376*            20  FILLER                     PIC X.
  5377
  5378         16  CF-ST-COMMISSION-CAPS.
  5379             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  5380             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  5381             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  5382             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  5383         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  5384                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  5385
  5386         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  5387
  5388         16  CF-ST-STATUTORY-INTEREST.
  5389             20  CF-ST-STAT-DATE-FROM       PIC X.
  5390                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  5391                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  5392             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  5393             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  5394             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  5395             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  5396             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  5397
  5398         16  CF-ST-OVER-SHORT.
  5399             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  5400             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  5401
  5402         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  5403
  5404         16  CF-ST-RT-CALC                  PIC X.
  5405
  5406         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5407         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  5408         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5409         16  CF-ST-RF-LR-CALC               PIC X.
  5410         16  CF-ST-RF-LL-CALC               PIC X.
  5411         16  CF-ST-RF-LN-CALC               PIC X.
  5412         16  CF-ST-RF-AH-CALC               PIC X.
  5413         16  CF-ST-RF-CP-CALC               PIC X.
  5414*        16  FILLER                         PIC X(206).
  5415*CIDMOD         16  FILLER                         PIC X(192).
  5416         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page  98
* EL131.cbl
  5417             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  5418         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  5419         16  CF-ST-VFY-2ND-BENE             PIC X.
  5420         16  CF-ST-CAUSAL-STATE             PIC X.
  5421         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  5422         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  5423         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  5424             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  5425         16  CF-ST-NET-ONLY-STATE           PIC X.
  5426             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  5427         16  FILLER                         PIC X(181).
  5428
  5429****************************************************************
  5430*             BENEFIT MASTER RECORD                            *
  5431****************************************************************
  5432
  5433     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5434         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  5435             20  CF-BENEFIT-CODE            PIC XX.
  5436             20  CF-BENEFIT-NUMERIC  REDEFINES
  5437                 CF-BENEFIT-CODE            PIC XX.
  5438             20  CF-BENEFIT-ALPHA           PIC XXX.
  5439             20  CF-BENEFIT-DESCRIP         PIC X(10).
  5440             20  CF-BENEFIT-COMMENT         PIC X(10).
  5441
  5442             20  CF-LF-COVERAGE-TYPE        PIC X.
  5443                 88  CF-REDUCING                VALUE 'R'.
  5444                 88  CF-LEVEL                   VALUE 'L' 'P'.
  5445
  5446             20  CF-SPECIAL-CALC-CD         PIC X.
  5447                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  5448                 88  CF-NP-0-MO-INT             VALUE 'A'.
  5449                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  5450                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  5451                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  5452                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  5453                 88  CF-FARM-PLAN               VALUE 'F'.
  5454                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  5455                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  5456                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  5457                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  5458                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  5459                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  5460                 88  CF-PRUDENTIAL              VALUE 'P'.
  5461                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  5462                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  5463                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  5464                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  5465                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  5466                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  5467
  5468             20  CF-JOINT-INDICATOR         PIC X.
  5469                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  5470
  5471*            20  FILLER                     PIC X(12).
  5472             20  cf-maximum-benefits        pic s999 comp-3.
  5473             20  FILLER                     PIC X(09).
  5474             20  CF-BENEFIT-CATEGORY        PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page  99
* EL131.cbl
  5475             20  CF-LOAN-TYPE               PIC X(8).
  5476
  5477             20  CF-CO-REM-TERM-CALC        PIC X.
  5478                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  5479                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  5480                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  5481                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  5482                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  5483
  5484             20  CF-CO-EARNINGS-CALC        PIC X.
  5485                 88  CO-EARN-BY-R78             VALUE '1'.
  5486                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  5487                 88  CO-EARN-AS-CALIF           VALUE '3'.
  5488                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  5489                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  5490                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  5491                 88  CO-EARN-AS-MEAN            VALUE '8'.
  5492                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  5493
  5494             20  CF-CO-REFUND-CALC          PIC X.
  5495                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  5496                 88  CO-REFD-BY-R78             VALUE '1'.
  5497                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  5498                 88  CO-REFD-AS-CALIF           VALUE '3'.
  5499                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  5500                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  5501                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  5502                 88  CO-REFD-MEAN               VALUE '8'.
  5503                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  5504                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  5505                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  5506
  5507             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  5508                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  5509                 88  CO-OVRD-BY-R78             VALUE '1'.
  5510                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  5511                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  5512                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  5513                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  5514                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  5515                 88  CO-OVRD-MEAN               VALUE '8'.
  5516                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  5517
  5518             20  CF-CO-BEN-I-G-CD           PIC X.
  5519                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  5520                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  5521                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  5522
  5523         16  FILLER                         PIC X(304).
  5524
  5525
  5526****************************************************************
  5527*             CARRIER MASTER RECORD                            *
  5528****************************************************************
  5529
  5530     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5531         16  CF-ADDRESS-DATA.
  5532             20  CF-MAIL-TO-NAME            PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 100
* EL131.cbl
  5533             20  CF-IN-CARE-OF              PIC X(30).
  5534             20  CF-ADDRESS-LINE-1          PIC X(30).
  5535             20  CF-ADDRESS-LINE-2          PIC X(30).
  5536             20  CF-CITY-STATE              PIC X(30).
  5537             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  5538             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  5539
  5540         16  CF-CLAIM-NO-CONTROL.
  5541             20  CF-CLAIM-NO-METHOD         PIC X.
  5542                 88  CLAIM-NO-MANUAL            VALUE '1'.
  5543                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  5544                 88  CLAIM-NO-SEQ               VALUE '3'.
  5545                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  5546             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  5547                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  5548                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  5549                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  5550
  5551         16  CF-CHECK-NO-CONTROL.
  5552             20  CF-CHECK-NO-METHOD         PIC X.
  5553                 88  CHECK-NO-MANUAL            VALUE '1'.
  5554                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  5555                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  5556                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  5557             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  5558                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  5559
  5560         16  CF-DOMICILE-STATE              PIC XX.
  5561
  5562         16  CF-EXPENSE-CONTROLS.
  5563             20  CF-EXPENSE-METHOD          PIC X.
  5564                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  5565                 88  DOLLARS-PER-PMT            VALUE '2'.
  5566                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  5567                 88  DOLLARS-PER-MONTH          VALUE '4'.
  5568             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  5569             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  5570
  5571         16  CF-CORRESPONDENCE-CONTROL.
  5572             20  CF-LETTER-RESEND-OPT       PIC X.
  5573                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  5574                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  5575             20  FILLER                     PIC X(4).
  5576
  5577         16  CF-RESERVE-CONTROLS.
  5578             20  CF-MANUAL-SW               PIC X.
  5579                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  5580             20  CF-FUTURE-SW               PIC X.
  5581                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  5582             20  CF-PTC-SW                  PIC X.
  5583                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  5584             20  CF-IBNR-SW                 PIC X.
  5585                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  5586             20  CF-PTC-LF-SW               PIC X.
  5587                 88  CF-LF-PTC-USED             VALUE '1'.
  5588             20  CF-CDT-ACCESS-METHOD       PIC X.
  5589                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  5590                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 101
* EL131.cbl
  5591                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  5592             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  5593
  5594         16  CF-CLAIM-CALC-METHOD           PIC X.
  5595             88  360-PLUS-MONTHS                VALUE '1'.
  5596             88  365-PLUS-MONTHS                VALUE '2'.
  5597             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  5598             88  360-DAILY                      VALUE '4'.
  5599             88  365-DAILY                      VALUE '5'.
  5600
  5601         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  5602         16  FILLER                         PIC X(11).
  5603
  5604         16  CF-LIMIT-AMOUNTS.
  5605             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  5606             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  5607             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  5608             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  5609             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  5610             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  5611             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  5612             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  5613             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  5614             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  5615
  5616         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  5617         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  5618         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  5619
  5620         16  CF-ZIP-CODE.
  5621             20  CF-ZIP-PRIME.
  5622                 24  CF-ZIP-1ST             PIC X.
  5623                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5624                 24  FILLER                 PIC X(4).
  5625             20  CF-ZIP-PLUS4               PIC X(4).
  5626         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  5627             20  CF-CAN-POSTAL-1            PIC XXX.
  5628             20  CF-CAN-POSTAL-2            PIC XXX.
  5629             20  FILLER                     PIC XXX.
  5630
  5631         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  5632         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  5633         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  5634
  5635         16  CF-RATING-SWITCH               PIC X.
  5636             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  5637             88  CF-NO-RATING                   VALUE 'N'.
  5638
  5639         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  5640
  5641         16  CF-CARRIER-OVER-SHORT.
  5642             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5643             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5644
  5645         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  5646         16  CF-SECPAY-SWITCH               PIC X.
  5647             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  5648             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 102
* EL131.cbl
  5649         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  5650         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  5651         16  FILLER                         PIC X(444).
  5652*        16  FILLER                         PIC X(452).
  5653
  5654
  5655****************************************************************
  5656*             MORTALITY MASTER RECORD                          *
  5657****************************************************************
  5658
  5659     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5660         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  5661                                INDEXED BY CF-MORT-NDX.
  5662             20  CF-MORT-TABLE              PIC X(5).
  5663             20  CF-MORT-TABLE-TYPE         PIC X.
  5664                 88  CF-MORT-JOINT              VALUE 'J'.
  5665                 88  CF-MORT-SINGLE             VALUE 'S'.
  5666                 88  CF-MORT-COMBINED           VALUE 'C'.
  5667                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  5668                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  5669             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  5670             20  CF-MORT-AGE-METHOD         PIC XX.
  5671                 88  CF-AGE-LAST                VALUE 'AL'.
  5672                 88  CF-AGE-NEAR                VALUE 'AN'.
  5673             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  5674             20  CF-MORT-ADJUSTMENT-DIRECTION
  5675                                            PIC X.
  5676                 88  CF-MINUS                   VALUE '-'.
  5677                 88  CF-PLUS                    VALUE '+'.
  5678             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  5679             20  CF-MORT-JOINT-CODE         PIC X.
  5680                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  5681             20  CF-MORT-PC-Q               PIC X.
  5682                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  5683             20  CF-MORT-TABLE-CODE         PIC X(4).
  5684             20  CF-MORT-COMMENTS           PIC X(15).
  5685             20  FILLER                     PIC X(14).
  5686
  5687         16  FILLER                         PIC X(251).
  5688
  5689
  5690****************************************************************
  5691*             BUSSINESS TYPE MASTER RECORD                     *
  5692****************************************************************
  5693
  5694     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5695* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  5696* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  5697* AND RECORD 05 IS TYPES 81-99
  5698         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  5699             20  CF-BUSINESS-TITLE          PIC  X(19).
  5700             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  5701                                            PIC S9V9(4) COMP-3.
  5702             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  5703             20  FILLER                     PIC  X.
  5704         16  FILLER                         PIC  X(248).
  5705
  5706
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 103
* EL131.cbl
  5707****************************************************************
  5708*             TERMINAL MASTER RECORD                           *
  5709****************************************************************
  5710
  5711     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5712
  5713         16  CF-COMPANY-TERMINALS.
  5714             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  5715                                  PIC X(4).
  5716         16  FILLER               PIC X(248).
  5717
  5718
  5719****************************************************************
  5720*             LIFE EDIT MASTER RECORD                          *
  5721****************************************************************
  5722
  5723     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5724         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  5725             20  CF-LIFE-CODE-IN            PIC XX.
  5726             20  CF-LIFE-CODE-OUT           PIC XX.
  5727         16  FILLER                         PIC X(248).
  5728
  5729
  5730****************************************************************
  5731*             AH EDIT MASTER RECORD                            *
  5732****************************************************************
  5733
  5734     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5735         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  5736             20  CF-AH-CODE-IN              PIC XXX.
  5737             20  CF-AH-CODE-OUT             PIC XX.
  5738         16  FILLER                         PIC X(248).
  5739
  5740
  5741****************************************************************
  5742*             CREDIBILITY TABLES                               *
  5743****************************************************************
  5744
  5745     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5746         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  5747                             INDEXED BY CF-CRDB-NDX.
  5748             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  5749             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  5750             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  5751         16  FILLER                         PIC  X(332).
  5752
  5753
  5754****************************************************************
  5755*             REPORT CUSTOMIZATION RECORD                      *
  5756****************************************************************
  5757
  5758     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  5759         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  5760             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  5761             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  5762             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  5763**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  5764****       A T-TRANSFER.                                   ****
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 104
* EL131.cbl
  5765             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  5766
  5767         16  FILLER                         PIC XX.
  5768
  5769         16  CF-CARRIER-CNTL-OPT.
  5770             20  CF-CARRIER-OPT-SEQ         PIC 9.
  5771                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  5772                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  5773             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  5774                                            PIC X.
  5775         16  CF-GROUP-CNTL-OPT.
  5776             20  CF-GROUP-OPT-SEQ           PIC 9.
  5777                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  5778                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  5779             20  CF-GROUP-SELECT OCCURS 3 TIMES
  5780                                            PIC X(6).
  5781         16  CF-STATE-CNTL-OPT.
  5782             20  CF-STATE-OPT-SEQ           PIC 9.
  5783                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  5784                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  5785             20  CF-STATE-SELECT OCCURS 3 TIMES
  5786                                            PIC XX.
  5787         16  CF-ACCOUNT-CNTL-OPT.
  5788             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  5789                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  5790                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  5791             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  5792                                            PIC X(10).
  5793         16  CF-BUS-TYP-CNTL-OPT.
  5794             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  5795                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  5796                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  5797             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  5798                                            PIC XX.
  5799         16  CF-LF-TYP-CNTL-OPT.
  5800             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  5801                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  5802                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  5803             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  5804                                            PIC XX.
  5805         16  CF-AH-TYP-CNTL-OPT.
  5806             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  5807                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  5808                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  5809             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  5810                                            PIC XX.
  5811         16  CF-REPTCD1-CNTL-OPT.
  5812             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  5813                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  5814                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  5815             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  5816                                            PIC X(10).
  5817         16  CF-REPTCD2-CNTL-OPT.
  5818             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  5819                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  5820                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  5821             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  5822                                            PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 105
* EL131.cbl
  5823         16  CF-USER1-CNTL-OPT.
  5824             20  CF-USER1-OPT-SEQ           PIC 9.
  5825                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  5826                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  5827             20  CF-USER1-SELECT OCCURS 3 TIMES
  5828                                            PIC X(10).
  5829         16  CF-USER2-CNTL-OPT.
  5830             20  CF-USER2-OPT-SEQ           PIC 9.
  5831                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  5832                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  5833             20  CF-USER2-SELECT OCCURS 3 TIMES
  5834                                            PIC X(10).
  5835         16  CF-USER3-CNTL-OPT.
  5836             20  CF-USER3-OPT-SEQ           PIC 9.
  5837                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  5838                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  5839             20  CF-USER3-SELECT OCCURS 3 TIMES
  5840                                            PIC X(10).
  5841         16  CF-USER4-CNTL-OPT.
  5842             20  CF-USER4-OPT-SEQ           PIC 9.
  5843                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  5844                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  5845             20  CF-USER4-SELECT OCCURS 3 TIMES
  5846                                            PIC X(10).
  5847         16  CF-USER5-CNTL-OPT.
  5848             20  CF-USER5-OPT-SEQ           PIC 9.
  5849                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  5850                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  5851             20  CF-USER5-SELECT OCCURS 3 TIMES
  5852                                            PIC X(10).
  5853         16  CF-REINS-CNTL-OPT.
  5854             20  CF-REINS-OPT-SEQ           PIC 9.
  5855                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  5856                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  5857             20  CF-REINS-SELECT OCCURS 3 TIMES.
  5858                 24  CF-REINS-PRIME         PIC XXX.
  5859                 24  CF-REINS-SUB           PIC XXX.
  5860
  5861         16  CF-AGENT-CNTL-OPT.
  5862             20  CF-AGENT-OPT-SEQ           PIC 9.
  5863                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  5864                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  5865             20  CF-AGENT-SELECT OCCURS 3 TIMES
  5866                                            PIC X(10).
  5867
  5868         16  FILLER                         PIC X(43).
  5869
  5870         16  CF-LOSS-RATIO-SELECT.
  5871             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  5872             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  5873         16  CF-ENTRY-DATE-SELECT.
  5874             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  5875             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  5876         16  CF-EFFECTIVE-DATE-SELECT.
  5877             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  5878             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  5879
  5880         16  CF-EXCEPTION-LIST-IND          PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 106
* EL131.cbl
  5881             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  5882
  5883         16  FILLER                         PIC X(318).
  5884
  5885****************************************************************
  5886*                  EXCEPTION REPORTING RECORD                  *
  5887****************************************************************
  5888
  5889     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  5890         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  5891             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  5892
  5893         16  CF-COMBINED-LIFE-AH-OPT.
  5894             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  5895             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  5896             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  5897             20  CF-CANCELLATION-RATIO      PIC S9(02).
  5898
  5899         16  CF-LIFE-OPT.
  5900             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5901             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5902             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5903             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5904             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5905             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5906             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5907             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5908             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5909             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  5910
  5911         16  CF-AH-OPT.
  5912             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5913             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5914             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5915             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5916             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5917             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5918             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5919             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5920             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5921             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  5922
  5923         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  5924             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  5925             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  5926             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  5927
  5928         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  5929
  5930         16  FILLER                         PIC X(673).
  5931
  5932
  5933****************************************************************
  5934*             MORTGAGE SYSTEM PLAN RECORD                      *
  5935****************************************************************
  5936
  5937     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  5938         16  CF-PLAN-TYPE                   PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 107
* EL131.cbl
  5939             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  5940             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  5941             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  5942         16  CF-PLAN-ABBREV                 PIC XXX.
  5943         16  CF-PLAN-DESCRIPT               PIC X(10).
  5944         16  CF-PLAN-NOTES                  PIC X(20).
  5945         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  5946         16  CF-PLAN-UNDERWRITING.
  5947             20  CF-PLAN-TERM-DATA.
  5948                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  5949                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  5950             20  CF-PLAN-AGE-DATA.
  5951                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  5952                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  5953                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  5954             20  CF-PLAN-BENEFIT-DATA.
  5955                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5956                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5957                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  5958                                            PIC S9(7)V99  COMP-3.
  5959         16  CF-PLAN-POLICY-FORMS.
  5960             20  CF-POLICY-FORM             PIC X(12).
  5961             20  CF-MASTER-APPLICATION      PIC X(12).
  5962             20  CF-MASTER-POLICY           PIC X(12).
  5963         16  CF-PLAN-RATING.
  5964             20  CF-RATE-CODE               PIC X(5).
  5965             20  CF-SEX-RATING              PIC X.
  5966                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  5967                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  5968             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  5969             20  CF-SUB-STD-TYPE            PIC X.
  5970                 88  CF-PCT-OF-PREM            VALUE '1'.
  5971                 88  CF-PCT-OF-BENE            VALUE '2'.
  5972         16  CF-PLAN-PREM-TOLERANCES.
  5973             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  5974             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  5975         16  CF-PLAN-PYMT-TOLERANCES.
  5976             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  5977             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  5978         16  CF-PLAN-MISC-DATA.
  5979             20  FILLER                     PIC X.
  5980             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  5981             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  5982         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  5983         16  CF-PLAN-IND-GRP                PIC X.
  5984             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  5985                                                     '1'.
  5986             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  5987                                                     '2'.
  5988         16  CF-MIB-SEARCH-SW               PIC X.
  5989             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  5990             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  5991             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  5992             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  5993         16  CF-ALPHA-SEARCH-SW             PIC X.
  5994             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  5995             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  5996             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 108
* EL131.cbl
  5997             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  5998             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  5999             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  6000             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  6001             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  6002             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  6003             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  6004                                                     'A' 'B' 'C'
  6005                                                     'X' 'Y' 'Z'.
  6006         16  CF-EFF-DT-RULE-SW              PIC X.
  6007             88  CF-EFF-DT-ENTER               VALUE 'E'.
  6008             88  CF-EFF-DT-MONTH               VALUE 'M'.
  6009             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  6010             88  CF-EFF-DT-SEMI                VALUE 'S'.
  6011             88  CF-EFF-DT-ANN                 VALUE 'A'.
  6012         16  FILLER                         PIC X(4).
  6013         16  CF-HEALTH-QUESTIONS            PIC X.
  6014             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  6015         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  6016         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  6017         16  CF-PLAN-SNGL-JNT               PIC X.
  6018             88  CF-COMBINED-PLAN              VALUE 'C'.
  6019             88  CF-JNT-PLAN                   VALUE 'J'.
  6020             88  CF-SNGL-PLAN                  VALUE 'S'.
  6021         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  6022         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  6023         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  6024         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  6025         16  CF-RERATE-CNTL                 PIC  X.
  6026             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  6027             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  6028             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  6029             88  CF-AUTO-RECALC                 VALUE '4'.
  6030         16  CF-BENEFIT-TYPE                PIC  X.
  6031             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  6032             88  CF-BENEFIT-REDUCES             VALUE '2'.
  6033         16  CF-POLICY-FEE                  PIC S999V99
  6034                                                    COMP-3.
  6035         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  6036         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  6037         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  6038         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  6039         16  FILLER                         PIC  X(32).
  6040         16  CF-TERMINATION-FORM            PIC  X(04).
  6041         16  FILLER                         PIC  X(08).
  6042         16  CF-CLAIM-CAP                   PIC S9(7)V99
  6043                                                       COMP-3.
  6044         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  6045         16  CF-ISSUE-LETTER                PIC  X(4).
  6046         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  6047         16  CF-DEPENDENT-COVERAGE          PIC  X.
  6048             88  CF-YES-DEP-COV                 VALUE 'Y'.
  6049             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  6050         16  CF-MP-REFUND-CALC              PIC X.
  6051             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  6052             88  CF-MP-REFD-BY-R78              VALUE '1'.
  6053             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  6054             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 109
* EL131.cbl
  6055             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  6056             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  6057             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  6058             88  CF-MP-REFD-MEAN                VALUE '8'.
  6059         16  CF-ALT-RATE-CODE               PIC  X(5).
  6060
  6061
  6062         16  FILLER                         PIC X(498).
  6063****************************************************************
  6064*             MORTGAGE COMPANY MASTER RECORD                   *
  6065****************************************************************
  6066
  6067     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6068         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  6069         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  6070             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  6071             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  6072             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  6073             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  6074             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  6075
  6076         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  6077         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  6078         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  6079         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  6080         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  6081
  6082         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  6083             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  6084         16  CF-MP-RECON-USE-IND            PIC X(1).
  6085             88  CF-MP-USE-RECON             VALUE 'Y'.
  6086         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  6087             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  6088         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  6089             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  6090             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  6091         16  FILLER                         PIC X(1).
  6092         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  6093             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  6094         16  CF-MORTG-MIB-VERSION           PIC X.
  6095             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  6096             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  6097             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  6098         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  6099             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  6100                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  6101             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  6102                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  6103             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  6104                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  6105             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  6106                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  6107             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  6108                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  6109             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  6110                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  6111         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  6112         16  FILLER                         PIC X(7).
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 110
* EL131.cbl
  6113         16  CF-MORTG-DESTINATION-SYMBOL.
  6114             20  CF-MORTG-MIB-COMM          PIC X(5).
  6115             20  CF-MORTG-MIB-TERM          PIC X(5).
  6116         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  6117             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  6118         16  FILLER                         PIC X(03).
  6119         16  CF-MP-CHECK-NO-CONTROL.
  6120             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  6121                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  6122                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  6123                                                ' ' LOW-VALUES.
  6124                 88  CF-MP-CHECK-NO-PRE-PRINTED
  6125                                               VALUE '3'.
  6126         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  6127         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  6128         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  6129             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  6130                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  6131             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  6132                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  6133             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  6134                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  6135             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  6136                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  6137             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  6138                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  6139             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  6140                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  6141         16  CF-MORTG-BILLING-AREA.
  6142             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  6143                                            PIC X.
  6144         16  CF-MORTG-MONTH-END-DT          PIC XX.
  6145         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  6146         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  6147         16  CF-MORTG-MIB-DEST-SW           PIC X.
  6148             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  6149             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  6150         16  FILLER                         PIC X.
  6151         16  CF-MORTG-LABEL-CONTROL         PIC X.
  6152             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  6153             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  6154         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  6155         16  FILLER                         PIC X(8).
  6156         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  6157         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  6158         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  6159         16  CF-ACH-COMPANY-ID.
  6160             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  6161                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  6162                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  6163                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  6164             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  6165         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  6166             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  6167         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  6168             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  6169             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  6170         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 111
* EL131.cbl
  6171         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  6172         16  FILLER                         PIC X(536).
  6173
  6174****************************************************************
  6175*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  6176****************************************************************
  6177
  6178     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  6179         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  6180             20  CF-FEMALE-HEIGHT.
  6181                 24  CF-FEMALE-FT           PIC 99.
  6182                 24  CF-FEMALE-IN           PIC 99.
  6183             20  CF-FEMALE-MIN-WT           PIC 999.
  6184             20  CF-FEMALE-MAX-WT           PIC 999.
  6185         16  FILLER                         PIC X(428).
  6186
  6187     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  6188         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  6189             20  CF-MALE-HEIGHT.
  6190                 24  CF-MALE-FT             PIC 99.
  6191                 24  CF-MALE-IN             PIC 99.
  6192             20  CF-MALE-MIN-WT             PIC 999.
  6193             20  CF-MALE-MAX-WT             PIC 999.
  6194         16  FILLER                         PIC X(428).
  6195******************************************************************
  6196*             AUTOMATIC ACTIVITY RECORD                          *
  6197******************************************************************
  6198     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  6199         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  6200             20  CF-SYS-ACTIVE-SW           PIC X(01).
  6201             20  CF-SYS-LETTER-ID           PIC X(04).
  6202             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  6203             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  6204             20  CF-SYS-RESET-SW            PIC X(01).
  6205             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  6206             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  6207
  6208         16  FILLER                         PIC X(50).
  6209
  6210         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  6211             20  CF-USER-ACTIVE-SW          PIC X(01).
  6212             20  CF-USER-LETTER-ID          PIC X(04).
  6213             20  CF-USER-RESEND-DAYS        PIC 9(03).
  6214             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  6215             20  CF-USER-RESET-SW           PIC X(01).
  6216             20  CF-USER-REPORT-DAYS        PIC 9(03).
  6217             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  6218             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  6219
  6220         16  FILLER                         PIC X(246).
  6221
  6222*                                COPY ELCACTQ.
  6223******************************************************************
  6224*                                                                *
  6225*                            ELCACTQ.                            *
  6226*           PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
  6227*                            VMOD=2.004                          *
  6228*                                                                *
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 112
* EL131.cbl
  6229*   FILE DESCRIPTION = ACTIVITY QUE FILE                         *
  6230*                                                                *
  6231*   FILE TYPE = VSAM,KSDS                                        *
  6232*   RECORD SIZE = 60     RECFORM = FIXED                         *
  6233*                                                                *
  6234*   BASE CLUSTER NAME = ELACTQ             RKP=2,LEN=20          *
  6235*       ALTERNATE INDEX = NONE                                   *
  6236*                                                                *
  6237*   LOG = YES                                                    *
  6238*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6239*                                                                *
  6240*  NO  CID  MODS  IN  COPYBOOK  ELCACTQ                          *
  6241******************************************************************
  6242
  6243 01  ACTIVITY-QUE.
  6244     12  AQ-RECORD-ID                PIC XX.
  6245         88  VALID-AQ-ID                VALUE 'AQ'.
  6246
  6247     12  AQ-CONTROL-PRIMARY.
  6248         16  AQ-COMPANY-CD           PIC X.
  6249         16  AQ-CARRIER              PIC X.
  6250         16  AQ-CLAIM-NO             PIC X(7).
  6251         16  AQ-CERT-NO.
  6252             20  AQ-CERT-PRIME       PIC X(10).
  6253             20  AQ-CERT-SFX         PIC X.
  6254
  6255     12  AQ-PENDING-ACTIVITY-FLAGS.
  6256         88  NO-PENDING-ACTIVITY        VALUE SPACES.
  6257         16  AQ-PENDING-PAYMENT-FLAG PIC X.
  6258             88  PENDING-PAYMENTS       VALUE '1'.
  6259         16  AQ-PENDING-STATUS-FLAG  PIC X.
  6260             88  PENDING-FULL-PRINT     VALUE '1'.
  6261             88  PENDING-PART-PRINT     VALUE '2'.
  6262         16  AQ-PENDING-LETTER-FLAG  PIC X.
  6263             88  PENDING-LETTERS        VALUE '1'.
  6264         16  AQ-PENDING-CLAIM-RESTORE PIC X.
  6265             88  PENDING-RESTORE        VALUE 'C'.
  6266             88  PENDING-RESTORE-LETTER VALUE 'L'.
  6267
  6268     12  FILLER                      PIC X(20).
  6269
  6270     12  AQ-RESEND-DATE              PIC XX.
  6271     12  AQ-FOLLOWUP-DATE            PIC XX.
  6272     12  AQ-PAYMENT-COUNTER          PIC S9        COMP-3.
  6273     12  AQ-PMT-UNAPPROVED-COUNT     PIC S9        COMP-3.
  6274     12  AQ-AUTO-LETTER              PIC X(4).
  6275     12  FILLER                      PIC XX.
  6276     12  AQ-LAST-UPDATED-BY          PIC S9(4)     COMP.
  6277*****************************************************************
  6278
  6279*                                COPY ERCACCT.
  6280******************************************************************
  6281*                                                                *
  6282*                                                                *
  6283*                            ERCACCT                             *
  6284*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6285*                            VMOD=2.031                          *
  6286*                                                                *
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 113
* EL131.cbl
  6287*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6288*                                                                *
  6289*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6290*   VSAM ACCOUNT MASTER FILES.                                   *
  6291*                                                                *
  6292*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6293*                                                                *
  6294*   FILE TYPE = VSAM,KSDS                                        *
  6295*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6296*                                                                *
  6297*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6298*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6299*                                                                *
  6300*   LOG = NO                                                     *
  6301*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6302*                                                                *
  6303*                                                                *
  6304******************************************************************
  6305*                   C H A N G E   L O G
  6306*
  6307* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6308*-----------------------------------------------------------------
  6309*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6310* EFFECTIVE    NUMBER
  6311*-----------------------------------------------------------------
  6312* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6313* 092705    2005050300006  PEMA  ADD SPP LEASES
  6314* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6315* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6316* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6317* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6318* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6319* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  6320******************************************************************
  6321
  6322 01  ACCOUNT-MASTER.
  6323     12  AM-RECORD-ID                      PIC XX.
  6324         88  VALID-AM-ID                      VALUE 'AM'.
  6325
  6326     12  AM-CONTROL-PRIMARY.
  6327         16  AM-COMPANY-CD                 PIC X.
  6328         16  AM-MSTR-CNTRL.
  6329             20  AM-CONTROL-A.
  6330                 24  AM-CARRIER            PIC X.
  6331                 24  AM-GROUPING.
  6332                     28 AM-GROUPING-PREFIX PIC XXX.
  6333                     28 AM-GROUPING-PRIME  PIC XXX.
  6334                 24  AM-STATE              PIC XX.
  6335                 24  AM-ACCOUNT.
  6336                     28  AM-ACCOUNT-PREFIX PIC X(4).
  6337                     28  AM-ACCOUNT-PRIME  PIC X(6).
  6338             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6339                                           PIC X(19).
  6340             20  AM-CNTRL-B.
  6341                 24  AM-EXPIRATION-DT      PIC XX.
  6342                 24  FILLER                PIC X(4).
  6343             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6344                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 114
* EL131.cbl
  6345
  6346     12  AM-CONTROL-BY-VAR-GRP.
  6347         16  AM-COMPANY-CD-A1              PIC X.
  6348         16  AM-VG-CARRIER                 PIC X.
  6349         16  AM-VG-GROUPING                PIC X(6).
  6350         16  AM-VG-STATE                   PIC XX.
  6351         16  AM-VG-ACCOUNT                 PIC X(10).
  6352         16  AM-VG-DATE.
  6353             20  AM-VG-EXPIRATION-DT       PIC XX.
  6354             20  FILLER                    PIC X(4).
  6355         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6356                                           PIC 9(11)      COMP-3.
  6357     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6358         16  FILLER                        PIC X(10).
  6359         16  AM-VG-KEY3.
  6360             20  AM-VG3-ACCOUNT            PIC X(10).
  6361             20  AM-VG3-EXP-DT             PIC XX.
  6362         16  FILLER                        PIC X(4).
  6363     12  AM-MAINT-INFORMATION.
  6364         16  AM-LAST-MAINT-DT              PIC XX.
  6365         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6366         16  AM-LAST-MAINT-USER            PIC X(4).
  6367         16  FILLER                        PIC XX.
  6368
  6369     12  AM-EFFECTIVE-DT                   PIC XX.
  6370     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6371
  6372     12  AM-PREV-DATES  COMP-3.
  6373         16  AM-PREV-EXP-DT                PIC 9(11).
  6374         16  AM-PREV-EFF-DT                PIC 9(11).
  6375
  6376     12  AM-REPORT-CODE-1                  PIC X(10).
  6377     12  AM-REPORT-CODE-2                  PIC X(10).
  6378
  6379     12  AM-CITY-CODE                      PIC X(4).
  6380     12  AM-COUNTY-PARISH                  PIC X(6).
  6381
  6382     12  AM-NAME                           PIC X(30).
  6383     12  AM-PERSON                         PIC X(30).
  6384     12  AM-ADDRS                          PIC X(30).
  6385     12  AM-CITY.
  6386         16  AM-ADDR-CITY                  PIC X(28).
  6387         16  AM-ADDR-STATE                 PIC XX.
  6388     12  AM-ZIP.
  6389         16  AM-ZIP-PRIME.
  6390             20  AM-ZIP-PRI-1ST            PIC X.
  6391                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6392             20  FILLER                    PIC X(4).
  6393         16  AM-ZIP-PLUS4                  PIC X(4).
  6394     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  6395         16  AM-CAN-POSTAL-1               PIC XXX.
  6396         16  AM-CAN-POSTAL-2               PIC XXX.
  6397         16  FILLER                        PIC XXX.
  6398     12  AM-TEL-NO.
  6399         16  AM-AREA-CODE                  PIC 999.
  6400         16  AM-TEL-PRE                    PIC 999.
  6401         16  AM-TEL-NBR                    PIC 9(4).
  6402     12  AM-TEL-LOC                        PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 115
* EL131.cbl
  6403         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6404         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6405
  6406     12  AM-COMM-STRUCTURE.
  6407         16  AM-DEFN-1.
  6408             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6409                 24  AM-AGT.
  6410                     28  AM-AGT-PREFIX     PIC X(4).
  6411                     28  AM-AGT-PRIME      PIC X(6).
  6412                 24  AM-COM-TYP            PIC X.
  6413                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6414                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6415                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6416                 24  AM-RECALC-LV-INDIC    PIC X.
  6417                 24  AM-RETRO-LV-INDIC     PIC X.
  6418                 24  AM-GL-CODES           PIC X.
  6419                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6420                 24  FILLER                PIC X(01).
  6421         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6422             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6423                 24  FILLER                PIC X(11).
  6424                 24  AM-L-COMA             PIC XXX.
  6425                 24  AM-J-COMA             PIC XXX.
  6426                 24  AM-A-COMA             PIC XXX.
  6427                 24  FILLER                PIC X(6).
  6428
  6429     12  AM-COMM-CHANGE-STATUS             PIC X.
  6430         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6431
  6432     12  AM-CSR-CODE                       PIC X(4).
  6433
  6434     12  AM-BILLING-STATUS                 PIC X.
  6435         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6436         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6437     12  AM-AUTO-REFUND-SW                 PIC X.
  6438         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6439         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6440     12  AM-GPCD                           PIC 99.
  6441     12  AM-IG                             PIC X.
  6442         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6443         88  AM-HAS-GROUP                     VALUE '2'.
  6444     12  AM-STATUS                         PIC X.
  6445         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6446         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6447         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6448         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6449         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6450         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6451         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  6452         88  AM-ACCOUNT-LAPSED                VALUE '7'.
  6453         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  6454         88  AM-ACCOUNT-PENDING               VALUE '9'.
  6455     12  AM-REMIT-TO                       PIC 99.
  6456     12  AM-ID-NO                          PIC X(11).
  6457
  6458     12  AM-CAL-TABLE                      PIC XX.
  6459     12  AM-LF-DEVIATION                   PIC XXX.
  6460     12  AM-AH-DEVIATION                   PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 116
* EL131.cbl
  6461     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6462     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6463     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6464     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6465     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6466     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6467
  6468     12  AM-USER-FIELDS.
  6469         16  AM-FLD-1                      PIC XX.
  6470         16  AM-FLD-2                      PIC XX.
  6471         16  AM-FLD-3                      PIC XX.
  6472         16  AM-FLD-4                      PIC XX.
  6473         16  AM-FLD-5                      PIC XX.
  6474
  6475     12  AM-1ST-PROD-DATE.
  6476         16  AM-1ST-PROD-YR                PIC XX.
  6477         16  AM-1ST-PROD-MO                PIC XX.
  6478         16  AM-1ST-PROD-DA                PIC XX.
  6479     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6480     12  AM-CERTS-PURGED-DATE.
  6481         16  AM-PUR-YR                     PIC XX.
  6482         16  AM-PUR-MO                     PIC XX.
  6483         16  AM-PUR-DA                     PIC XX.
  6484     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6485     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6486     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6487     12  AM-INACTIVE-DATE.
  6488         16  AM-INA-MO                     PIC 99.
  6489         16  AM-INA-DA                     PIC 99.
  6490         16  AM-INA-YR                     PIC 99.
  6491     12  AM-AR-HI-CERT-DATE                PIC XX.
  6492
  6493     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6494     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6495
  6496     12  AM-OB-PAYMENT-MODE                PIC X.
  6497         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6498         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6499         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6500         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6501
  6502     12  AM-AH-ONLY-INDICATOR              PIC X.
  6503         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6504         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6505
  6506     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6507
  6508     12  AM-OVER-SHORT.
  6509         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6510         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  6511
  6512     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6513     12  AM-DCC-CLP-STATE                  PIC XX.
  6514
  6515     12  AM-RECALC-COMM                    PIC X.
  6516     12  AM-RECALC-REIN                    PIC X.
  6517
  6518     12  AM-REI-TABLE                      PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 117
* EL131.cbl
  6519     12  AM-REI-ET-LF                      PIC X.
  6520     12  AM-REI-ET-AH                      PIC X.
  6521     12  AM-REI-PE-LF                      PIC X.
  6522     12  AM-REI-PE-AH                      PIC X.
  6523     12  AM-REI-PRT-ST                     PIC X.
  6524     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6525     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6526     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6527     12  AM-REI-GROUP-A                    PIC X(6).
  6528     12  AM-REI-MORT                       PIC X(4).
  6529     12  AM-REI-PRT-OW                     PIC X.
  6530     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6531     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6532     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6533     12  AM-REI-GROUP-B                    PIC X(6).
  6534
  6535     12  AM-TRUST-TYPE                     PIC X(2).
  6536
  6537     12  AM-EMPLOYER-STMT-USED             PIC X.
  6538     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6539
  6540     12  AM-STD-AH-TYPE                    PIC XX.
  6541     12  AM-EARN-METHODS.
  6542         16  AM-EARN-METHOD-R              PIC X.
  6543             88 AM-REF-RL-R78                 VALUE 'R'.
  6544             88 AM-REF-RL-PR                  VALUE 'P'.
  6545             88 AM-REF-RL-MEAN                VALUE 'M'.
  6546             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6547         16  AM-EARN-METHOD-L              PIC X.
  6548             88 AM-REF-LL-R78                 VALUE 'R'.
  6549             88 AM-REF-LL-PR                  VALUE 'P'.
  6550             88 AM-REF-LL-MEAN                VALUE 'M'.
  6551             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6552         16  AM-EARN-METHOD-A              PIC X.
  6553             88 AM-REF-AH-R78                 VALUE 'R'.
  6554             88 AM-REF-AH-PR                  VALUE 'P'.
  6555             88 AM-REF-AH-MEAN                VALUE 'M'.
  6556             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6557             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6558             88 AM-REF-AH-NET                 VALUE 'N'.
  6559
  6560     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6561     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6562     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6563
  6564     12  AM-RET-Y-N                        PIC X.
  6565     12  AM-RET-P-E                        PIC X.
  6566     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6567     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6568     12  AM-RET-GRP                        PIC X(6).
  6569     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6570         16  AM-POOL-PRIME                 PIC XXX.
  6571         16  AM-POOL-SUB                   PIC XXX.
  6572     12  AM-RETRO-EARNINGS.
  6573         16  AM-RET-EARN-R                 PIC X.
  6574         16  AM-RET-EARN-L                 PIC X.
  6575         16  AM-RET-EARN-A                 PIC X.
  6576     12  AM-RET-ST-TAX-USE                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 118
* EL131.cbl
  6577         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6578         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6579     12  AM-RETRO-BEG-EARNINGS.
  6580         16  AM-RET-BEG-EARN-R             PIC X.
  6581         16  AM-RET-BEG-EARN-L             PIC X.
  6582         16  AM-RET-BEG-EARN-A             PIC X.
  6583     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6584     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6585
  6586     12  AM-USER-SELECT-OPTIONS.
  6587         16  AM-USER-SELECT-1              PIC X(10).
  6588         16  AM-USER-SELECT-2              PIC X(10).
  6589         16  AM-USER-SELECT-3              PIC X(10).
  6590         16  AM-USER-SELECT-4              PIC X(10).
  6591         16  AM-USER-SELECT-5              PIC X(10).
  6592
  6593     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6594
  6595     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6596
  6597     12  AM-RPT045A-SWITCH                 PIC X.
  6598         88  RPT045A-OFF                   VALUE 'N'.
  6599
  6600     12  AM-INSURANCE-LIMITS.
  6601         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6602         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6603
  6604     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6605         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6606
  6607     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6608         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6609         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6610
  6611     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6612
  6613     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6614     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6615     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6616     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6617     12  AM-DCC-UEF-STATE                  PIC XX.
  6618     12  FILLER                            PIC XXX.
  6619     12  AM-REPORT-CODE-3                  PIC X(10).
  6620*    12  FILLER                            PIC X(22).
  6621
  6622     12  AM-RESERVE-DATE.
  6623         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6624         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6625         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6626
  6627     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6628     12  AM-NOTIFICATION-TYPES.
  6629         16  AM-NOTIF-OF-LETTERS           PIC X.
  6630         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6631         16  AM-NOTIF-OF-REPORTS           PIC X.
  6632         16  AM-NOTIF-OF-STATUS            PIC X.
  6633
  6634     12  AM-BENEFIT-TABLE-USAGE            PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 119
* EL131.cbl
  6635         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6636         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6637         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6638         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6639
  6640     12  AM-BENEFIT-CONTROLS.
  6641         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6642             20  AM-BENEFIT-CODE           PIC XX.
  6643             20  AM-BENEFIT-TYPE           PIC X.
  6644             20  AM-BENEFIT-REVISION       PIC XXX.
  6645             20  AM-BENEFIT-REM-TERM       PIC X.
  6646             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6647             20  FILLER                    PIC XX.
  6648         16  FILLER                        PIC X(80).
  6649
  6650     12  AM-TRANSFER-DATA.
  6651         16  AM-TRANSFERRED-FROM.
  6652             20  AM-TRNFROM-CARRIER        PIC X.
  6653             20  AM-TRNFROM-GROUPING.
  6654                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6655                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6656             20  AM-TRNFROM-STATE          PIC XX.
  6657             20  AM-TRNFROM-ACCOUNT.
  6658                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6659                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6660             20  AM-TRNFROM-DTE            PIC XX.
  6661         16  AM-TRANSFERRED-TO.
  6662             20  AM-TRNTO-CARRIER          PIC X.
  6663             20  AM-TRNTO-GROUPING.
  6664                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6665                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6666             20  AM-TRNTO-STATE            PIC XX.
  6667             20  AM-TRNTO-ACCOUNT.
  6668                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6669                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6670             20  AM-TRNTO-DTE              PIC XX.
  6671         16  FILLER                        PIC X(10).
  6672
  6673     12  AM-SAVED-REMIT-TO                 PIC 99.
  6674
  6675     12  AM-COMM-STRUCTURE-SAVED.
  6676         16  AM-DEFN-1-SAVED.
  6677             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  6678                 24  AM-AGT-SV             PIC X(10).
  6679                 24  AM-COM-TYP-SV         PIC X.
  6680                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  6681                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  6682                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  6683                 24  AM-RECALC-LV-INDIC-SV PIC X.
  6684                 24  FILLER                PIC X.
  6685                 24  AM-GL-CODES-SV        PIC X.
  6686                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  6687                 24  FILLER                PIC X.
  6688         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  6689             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  6690                 24  FILLER                PIC X(11).
  6691                 24  AM-L-COMA-SV          PIC XXX.
  6692                 24  AM-J-COMA-SV          PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 120
* EL131.cbl
  6693                 24  AM-A-COMA-SV          PIC XXX.
  6694                 24  FILLER                PIC X(6).
  6695
  6696     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  6697         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  6698            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  6699            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  6700            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  6701
  6702     12  AM-ORIG-DEALER-NO                 PIC X(10).
  6703     12  FILLER                            PIC X(120).
  6704
  6705     12  AM-ACCOUNT-EXECUTIVE-DATA.
  6706         16  AM-CONTROL-NAME               PIC X(30).
  6707         16  AM-EXECUTIVE-ONE.
  6708             20  AM-EXEC1-NAME             PIC X(15).
  6709             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  6710                                                          COMP-3.
  6711             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  6712                                                          COMP-3.
  6713         16  AM-EXECUTIVE-TWO.
  6714             20  AM-EXEC2-NAME             PIC X(15).
  6715             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  6716                                                          COMP-3.
  6717             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  6718                                                          COMP-3.
  6719
  6720     12  AM-RETRO-ADDITIONAL-DATA.
  6721         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  6722         16  AM-RETRO-PREM-P-E             PIC X.
  6723         16  AM-RETRO-CLMS-P-I             PIC X.
  6724         16  AM-RETRO-RET-BRACKET-LF.
  6725             20  AM-RETRO-RET-METHOD-LF    PIC X.
  6726                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  6727                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  6728             20  AM-RETRO-RET-BASIS-LF     PIC X.
  6729                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  6730                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  6731             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  6732                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  6733                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  6734         16  AM-RETRO-RET-BRACKET-AH.
  6735             20  AM-RETRO-RET-METHOD-AH    PIC X.
  6736                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  6737                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  6738                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  6739             20  AM-RETRO-RET-BASIS-AH     PIC X.
  6740                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  6741                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  6742             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  6743                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  6744                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  6745
  6746     12  AM-COMMENTS.
  6747         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  6748
  6749     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  6750         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 121
* EL131.cbl
  6751         16  AM-FLI-BILLING-CODE           PIC X.
  6752         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  6753         16  AM-FLI-UNITED-IDENT           PIC X.
  6754         16  AM-FLI-INTEREST-LOST-DATA.
  6755             20  AM-FLI-BANK-NO            PIC X(5).
  6756             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  6757             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  6758             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  6759         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  6760             20  AM-FLI-AGT                PIC X(9).
  6761             20  AM-FLI-AGT-COMM-ACC       PIC X.
  6762             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  6763         16  FILLER                        PIC X(102).
  6764
  6765     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  6766         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  6767             20  AM-BENEFIT-DMD-CODE         PIC XX.
  6768             20  AM-BENEFIT-DMD-TYPE         PIC X.
  6769             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  6770             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  6771             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  6772         16  FILLER                          PIC X(10).
  6773******************************************************************
  6774
  6775*                                COPY ELCCHKQ.
  6776******************************************************************
  6777*                                                                *
  6778*                                                                *
  6779*                            ELCCHKQ.                            *
  6780*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6781*                            VMOD=2.007                          *
  6782*                                                                *
  6783*   FILE DESCRIPTION = CHECK QUE FILE                            *
  6784*                                                                *
  6785*   FILE TYPE = VSAM,KSDS                                        *
  6786*   RECORD SIZE = 100  RECFORM = FIXED                           *
  6787*                                                                *
  6788*   BASE CLUSTER = ELCHKQ                         RKP=2,LEN=7    *
  6789*       ALTERNATE PATH1 = ELCHKQ2 (BY PAYEE)      RKP=9,LEN=26   *
  6790*                                                                *
  6791*   LOG = YES                                                    *
  6792*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6793******************************************************************
  6794 01  CHECK-QUE.
  6795     12  CQ-RECORD-ID                PIC XX.
  6796         88  VALID-CQ-ID         VALUE 'CQ'.
  6797
  6798     12  CQ-CONTROL-PRIMARY.
  6799         16  CQ-COMPANY-CD           PIC X.
  6800         16  CQ-CONTROL-NUMBER       PIC S9(8)       COMP.
  6801         16  CQ-SEQUENCE-NUMBER      PIC S9(4)       COMP.
  6802
  6803     12  CQ-CONTROL-BY-PAYEE.
  6804         16  CQ-CONTROL-BY-NUMBER.
  6805             20  CQ-COMPANY-CD-A1     PIC X.
  6806             20  CQ-CONTROL-NUMBER-A1 PIC S9(8)      COMP.
  6807         16  CQ-PAYEE-CARRIER        PIC X.
  6808         16  CQ-PAYEE-GROUPING       PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 122
* EL131.cbl
  6809         16  CQ-PAYEE-STATE          PIC XX.
  6810         16  CQ-PAYEE-BENE-ACCT      PIC X(10).
  6811         16  CQ-SEQUENCE-NUMBER-A1   PIC S9(4)       COMP.
  6812
  6813     12  CQ-DMD-CONTROL  REDEFINES  CQ-CONTROL-BY-PAYEE.
  6814         16  CQ-DMD-COMPANY-CD-A2    PIC X.
  6815         16  CQ-DMD-PAYEE-TYPE-A2    PIC X.
  6816         16  CQ-DMD-BENE-CODE-A2     PIC X(10).
  6817         16  CQ-DMD-CLAIM-NO-A2      PIC X(7).
  6818         16  CQ-DMD-TIME-SEQ-A2      PIC S9(7)       COMP.
  6819         16  FILLER                  PIC X(3).
  6820
  6821     12  CQ-ENTRY-TYPE               PIC X.
  6822             88  CHECK-ON-QUE           VALUE 'Q'.
  6823             88  ALIGNMENT-CHECK        VALUE 'A'.
  6824             88  SPOILED-CHECK          VALUE 'S'.
  6825             88  PAYMENT-ABORTED        VALUE 'X'.
  6826
  6827     12  CQ-CLAIM-MAST-CNTL.
  6828         16  CQ-CARRIER              PIC X.
  6829         16  CQ-CLAIM-NO             PIC X(7).
  6830         16  CQ-CERT-NO.
  6831             20  CQ-CERT-PRIME       PIC X(10).
  6832             20  CQ-CERT-SFX         PIC X.
  6833         16  CQ-CLAIM-TYPE           PIC X.
  6834             88  CQ-LIFE-CLAIM          VALUE 'L'.
  6835             88  CQ-AH-CLAIM            VALUE 'A'.
  6836         16  CQ-CLAIM-SUB-TYPE       PIC X.
  6837             88  CQ-FIXED-COVERAGE      VALUE '1'.
  6838             88  CQ-O-B-COVERAGE        VALUE '2'.
  6839             88  CQ-OPEN-END-COVERAGE   VALUE '3'.
  6840
  6841     12  CQ-PMT-TRLR-SEQUENCE        PIC S9(4)       COMP.
  6842     12  CQ-CHECK-NUMBER             PIC X(7).
  6843     12  CQ-CHECK-AMOUNT             PIC S9(7)V99    COMP-3.
  6844     12  CQ-PAYMENT-TYPE             PIC X.
  6845             88  CQ-PARTIAL-PAYMENT        VALUE '1'.
  6846             88  CQ-FINAL-PAYMENT          VALUE '2'.
  6847             88  CQ-LUMP-SUM-PAYMENT       VALUE '3'.
  6848             88  CQ-ADDITIONAL-PAYMENT     VALUE '4'.
  6849             88  CQ-CHARGEABLE-EXPENSE     VALUE '5'.
  6850             88  CQ-NON-CHARGEABLE-EXPENSE VALUE '6'.
  6851             88  CQ-LIFE-PREMIUM-REFUND    VALUE '7'.
  6852             88  CQ-AH-PREMIUM-REFUND      VALUE '8'.
  6853     12  CQ-VOID-INDICATOR           PIC X.
  6854             88  CHECK-IS-STOPPED          VALUE 'S'.
  6855             88  CHECK-IS-VOID             VALUE 'V'.
  6856     12  CQ-TIMES-PRINTED            PIC S9(4)       COMP.
  6857     12  CQ-PRINT-AT-HHMM            PIC S9(4)       COMP.
  6858     12  CQ-CHECK-BY-USER            PIC X(4).
  6859     12  CQ-PRE-NUMBERING-SW         PIC X.
  6860       88  CHECKS-WERE-NOT-PRE-NUMBERED    VALUE SPACE.
  6861       88  CHECKS-WERE-PRE-NUMBERED        VALUE '1'.
  6862
  6863     12  CQ-CHECK-WRITTEN-DT         PIC XX.
  6864     12  CQ-LAST-UPDATED-BY          PIC S9(4)       COMP.
  6865     12  CQ-LEDGER-FLAG              PIC X(01).
  6866     12  CQ-VOID-AFTER-LEDGER        PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 123
* EL131.cbl
  6867     12  CQ-LAST-UPDATED-DT          PIC XX.
  6868     12  CQ-LAST-UPDATED-HHMMSS      PIC S9(6)       COMP-3.
  6869     12  CQ-APPLIED-TO-RCON-DT       PIC XX.
  6870
  6871     12  FILLER                      PIC X(04).
  6872
  6873******************************************************************
  6874
  6875*                                COPY ELCARCH.
  6876******************************************************************
  6877*                                                                *
  6878*                            ELCARCH.                            *
  6879*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6880*                            VMOD=2.007                          *
  6881*                                                                *
  6882*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  6883*                                                                *
  6884*   FILE TYPE = VSAM,KSDS                                        *
  6885*   RECORD SIZE = 090  RECFORM = FIXED                           *
  6886*                                                                *
  6887*   BASE CLUSTER = ELARCH                        RKP=2,LEN=8     *
  6888*       ALTERNATE PATH1 = ELARCH2 (RECORD TYPE)  RKP=10,LEN=8    *
  6889*                                                                *
  6890*   LOG = NO                                                     *
  6891*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6892*                                                                *
  6893*  THERE ARE CID MODS IN COPYBOOK ELCARCH                        *
  6894******************************************************************
  6895 01  LETTER-ARCHIVE.
  6896     12  LA-RECORD-ID                PIC XX.
  6897         88  VALID-LA-ID                VALUE 'LA'.
  6898
  6899     12  LA-CONTROL-PRIMARY.
  6900         16  LA-COMPANY-CD           PIC X.
  6901         16  LA-ARCHIVE-NO           PIC S9(8)     COMP.
  6902         16  LA-RECORD-TYPE          PIC X.
  6903             88  LA-HEADER-DATA         VALUE '1'.
  6904             88  LA-ADDRESS-DATA        VALUE '2'.
  6905             88  LA-TEXT-DATA           VALUE '3'.
  6906             88  LA-FORM-CONTROL-HDR    VALUE '4'.
  6907         16  LA-LINE-SEQ-NO          PIC S9(4)     COMP.
  6908
  6909     12  LA-CONTROL-BY-TYPE.
  6910         16  LA-COMPANY-CD-A1        PIC X.
  6911         16  LA-RECORD-TYPE-A1       PIC X.
  6912         16  LA-ARCHIVE-NO-A1        PIC S9(8)     COMP.
  6913         16  LA-LINE-SEQ-NO-A1       PIC S9(4)     COMP.
  6914
  6915     12  LA-TEXT-RECORD.
  6916         16  LA-SKIP-CONTROL         PIC XX.
  6917             88  NO-LINES-SKIPPED       VALUE SPACES.
  6918             88  SKIP-TO-NEXT-PAGE      VALUE '99'.
  6919         16  LA-TEXT-LINE            PIC X(70).
  6920
  6921     12  LA-ADDRESS-RECORD  REDEFINES  LA-TEXT-RECORD.
  6922         16  FILLER                  PIC XX.
  6923         16  LA-ADDRESS-LINE         PIC X(30).
  6924         16  FILLER                  PIC X(40).
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 124
* EL131.cbl
  6925
  6926     12  LA-HEADER-RECORD  REDEFINES  LA-TEXT-RECORD.
  6927         16  FILLER                  PIC XX.
  6928         16  LA-CARRIER              PIC X.
  6929         16  LA-CLAIM-NO             PIC X(7).
  6930         16  LA-CERT-NO.
  6931             20  LA-CERT-PRIME       PIC X(10).
  6932             20  LA-CERT-SFX         PIC X.
  6933         16  LA-NO-OF-COPIES         PIC S9.
  6934         16  LA-RESEND-DATE          PIC XX.
  6935         16  LA-PROCESSOR-CD         PIC X(4).
  6936         16  LA-CREATION-DT          PIC XX.
  6937         16  LA-INITIAL-PRINT-DATE   PIC XX.
  6938         16  LA-RESEND-PRINT-DATE    PIC XX.
  6939         16  LA-CORR-TRLR-SEQ        PIC S9(4)    COMP.
  6940         16  LA-1ST-RESEND-PRINT-DT  PIC XX.
  6941*
  6942* -----  16  LA-DMD-ADDITIONAL-FIELDS.
  6943*   I        20  LA-DMD-LETTER-FORM      PIC X(4).
  6944*   I        20  LA-DMD-PROD-CODE        PIC XX.
  6945*   I        20  LA-DMD-RES-ST           PIC XX.
  6946*   I        20  LA-DMD-CORR-TRLR-SEQ    PIC S9(4)    COMP.
  6947*   I        20  LA-DMD-LETTER-STATUS    PIC X.
  6948*  NEW           88  LA-DMD-LETTER-ONLINE   VALUE '1'.
  6949*  DMD           88  LA-DMD-LETTER-PURGED   VALUE '2'.
  6950*  CHGS          88  LA-DMD-LETTER-RELOADED VALUE '3'.
  6951*   I        20  LA-DMD-LETTER-PURGE-DT  PIC XX.
  6952*   I        20  LA-DMD-LETTER-RELOAD-DT PIC XX.
  6953*   I        20  LA-DMD-UND-CODE         PIC XX.
  6954*   I        20  LA-DMD-BEN-CODE         PIC XX.
  6955*   V    16  FILLER                  PIC X(15).
  6956* -----
  6957*
  6958* REINSERTED  CSO  MODS
  6959*
  6960         16  FILLER.
  6961             20  FILLER                  PIC X(29).
  6962             20  LA-CSO-LETTER-STATUS    PIC X.
  6963                 88  LA-CSO-LETTER-ONLINE   VALUE '1'.
  6964                 88  LA-CSO-LETTER-PURGED   VALUE '2'.
  6965                 88  LA-CSO-LETTER-RELOADED VALUE '3'.
  6966             20  LA-CSO-LETTER-PURGE-DT  PIC XX.
  6967             20  LA-CSO-LETTER-RELOAD-DT PIC XX.
  6968*
  6969
  6970     12  LA-FORM-CONTROL-HEADER REDEFINES  LA-TEXT-RECORD.
  6971         16  FILLER                  PIC XX.
  6972         16  LA4-CARRIER             PIC X.
  6973         16  LA4-CLAIM-NO            PIC X(7).
  6974         16  LA4-CERT-NO.
  6975             20  LA4-CERT-PRIME      PIC X(10).
  6976             20  LA4-CERT-SFX        PIC X.
  6977         16  LA4-NO-OF-COPIES        PIC S9.
  6978         16  LA4-RESEND-DATE         PIC XX.
  6979         16  LA4-PROCESSOR-CD        PIC X(4).
  6980         16  LA4-CREATION-DT         PIC XX.
  6981         16  LA4-INITIAL-PRINT-DATE  PIC XX.
  6982         16  LA4-RESEND-PRINT-DATE   PIC XX.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 125
* EL131.cbl
  6983         16  LA4-FORM-TRLR-SEQ       PIC S9(4)    COMP.
  6984         16  LA4-FORM-TYPE           PIC X.
  6985             88  LA4-INITIAL-FORM    VALUE '1'.
  6986             88  LA4-PROGRESS-FORM   VALUE '2'.
  6987         16  LA4-FORM-REM-PRINT-DT   PIC X(02).
  6988         16  LA4-STATE               PIC X(02).
  6989         16  FILLER                  PIC X(31).
  6990******************************************************************
  6991
  6992*                                COPY ELCBENE.
  6993******************************************************************
  6994*                                                                *
  6995*                            ELCBENE.                            *
  6996*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6997*                            VMOD=2.006                          *
  6998*                                                                *
  6999*   FILE DESCRIPTION = BENEFICIARY FILE                          *
  7000*                                                                *
  7001*   FILE TYPE = VSAM,KSDS                                        *
  7002*   RECORD SIZE = 500   RECFORM = FIX                            *
  7003*                                                                *
  7004*   BASE CLUSTER NAME = ELBENE                   RKP=2,LEN=12    *
  7005*     ALTERNATE PATH1 = ELBENE2 (ALT BY NAME)    RKP=14,LEN=42   *
  7006*                                                                *
  7007*   LOG = YES                                                    *
  7008*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7009*                                                                *
  7010*  NO  CID  MODS  TO  COPYBOOK  ELCBENE                          *
  7011******************************************************************
  7012*                   C H A N G E   L O G
  7013*
  7014* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7015*-----------------------------------------------------------------
  7016*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7017* EFFECTIVE    NUMBER
  7018*-----------------------------------------------------------------
  7019* 013017  CR2016053100001  PEMA  ACH PROCESSING
  7020******************************************************************
  7021
  7022 01  BENEFICIARY-MASTER.
  7023     12  BE-RECORD-ID                PIC XX.
  7024         88  VALID-BE-ID                VALUE 'BE'.
  7025
  7026     12  BE-CONTROL-PRIMARY.
  7027         16  BE-COMPANY-CD           PIC X.
  7028         16  BE-RECORD-TYPE          PIC X.
  7029             88  BENEFICIARY-RECORD  VALUE 'B'.
  7030             88  ADJUSTOR-RECORD     VALUE 'A'.
  7031         16  BE-BENEFICIARY          PIC X(10).
  7032     12  BE-CONTROL-BY-NAME.
  7033         16  BE-COMPANY-CD-A1        PIC X.
  7034         16  BE-RECORD-TYPE-A1       PIC X.
  7035         16  BE-MAIL-TO-NAME-A1      PIC X(30).
  7036         16  BE-ALTERNATE-PRIME-A1   PIC X(10).
  7037
  7038     12  BE-LAST-MAINT-DT            PIC XX.
  7039     12  BE-LAST-MAINT-BY            PIC X(4).
  7040     12  BE-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 126
* EL131.cbl
  7041
  7042     12  BE-ADDRESS-DATA.
  7043         16  BE-MAIL-TO-NAME         PIC X(30).
  7044         16  BE-ADDRESS-LINE-1       PIC X(30).
  7045         16  BE-ADDRESS-LINE-2       PIC X(30).
  7046         16  BE-ADDRESS-LINE-3       PIC X(30).
  7047         16  BE-CITY-STATE.
  7048             20  BE-CITY             PIC X(28).
  7049             20  BE-STATE            PIC XX.
  7050         16  BE-ZIP-CODE.
  7051             20  BE-ZIP-PRIME.
  7052                 24  BE-ZIP-1ST      PIC X.
  7053                     88  BE-CANADIAN-POST-CODE
  7054                                         VALUE 'A' THRU 'Z'.
  7055                 24  FILLER          PIC X(4).
  7056             20  BE-ZIP-PLUS4        PIC X(4).
  7057         16  BE-CANADIAN-POSTAL-CODE  REDEFINES  BE-ZIP-CODE.
  7058             20  BE-CAN-POSTAL-1     PIC XXX.
  7059             20  BE-CAN-POSTAL-2     PIC XXX.
  7060             20  FILLER              PIC XXX.
  7061         16  BE-PHONE-NO             PIC 9(11)     COMP-3.
  7062         16  BE-GROUP-CHECKS-Y-N     PIC X.
  7063
  7064******************************************************************
  7065*    THE BE-CARRIER FIELD IS USED BY 'AIG' TO DETERMINE HOW TO   *
  7066*    SET THE CARRIER CODE IN THE PENDING CLAIM FILE.             *
  7067******************************************************************
  7068     12  BE-CARRIER                  PIC X.
  7069
  7070     12  BE-ADDRESS-DATA2.
  7071         16  BE-MAIL-TO-NAME2        PIC X(30).
  7072         16  BE-ADDRESS-LINE-12      PIC X(30).
  7073         16  BE-ADDRESS-LINE-22      PIC X(30).
  7074         16  BE-ADDRESS-LINE-32      PIC X(30).
  7075         16  BE-CITY-STATE2.
  7076             20  BE-CITY2            PIC X(28).
  7077             20  BE-STATE2           PIC XX.
  7078         16  BE-ZIP-CODE2.
  7079             20  BE-ZIP-PRIME2.
  7080                 24  BE-ZIP-1ST2     PIC X.
  7081                     88  BE-CANADIAN-POST-CODE2
  7082                                         VALUE 'A' THRU 'Z'.
  7083                 24  FILLER          PIC X(4).
  7084             20  BE-ZIP-PLUS42       PIC X(4).
  7085         16  BE-CANADIAN-POSTAL-CODE2 REDEFINES  BE-ZIP-CODE2.
  7086             20  BE-CAN-POSTAL-12    PIC XXX.
  7087             20  BE-CAN-POSTAL-22    PIC XXX.
  7088             20  FILLER              PIC XXX.
  7089         16  BE-PHONE-NO2            PIC 9(11)     COMP-3.
  7090         16  BE-ACH-DATA.
  7091             20  BE-ACH-YES-OR-NO    PIC X.
  7092                 88  BE-ON-ACH       VALUE 'Y'.
  7093                 88  BE-NOT-ON-ACH   VALUE 'N' ' '.
  7094             20  BE-ACH-ABA-ROUTING-NUMBER
  7095                                     PIC X(15).
  7096             20  BE-ACH-BANK-ACCOUNT-NUMBER
  7097                                     PIC X(20).
  7098             20  FILLER              PIC X(25).
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 127
* EL131.cbl
  7099         16  BE-BILLING-STMT-DATA.
  7100*            20  BE-BSR              PIC X.
  7101*                88  BE-AUTOMATED-BSR      VALUE 'A'.
  7102*                88  BE-NOT-AUTOMATED-BSR  VALUE ' '.
  7103*            20  BE-BSR-FROM         PIC X(30).
  7104*            20  BE-BSR-DEPT         PIC X(30).
  7105             20  BE-BSR-PHONE-NUM    PIC 9(11)     COMP-3.
  7106             20  BE-BSR-FAX-NUM      PIC 9(11)     COMP-3.
  7107             20  BE-OUTPUT-TYPE      PIC X.
  7108                 88  BE-FAX-OUTPUT         VALUE 'F'.
  7109                 88  BE-PRINT-OUTPUT       VALUE 'P' ' '.
  7110
  7111     12  FILLER                      PIC X(28).
  7112******************************************************************
  7113
  7114*                                COPY ELCDAR.
  7115******************************************************************
  7116*                                                                *
  7117*   FILE DESC. = DAILY ACTIVITY FILE, FOR PROCESSING NITELY      *
  7118*   FILE TYPE = VSAM,KSDS                                        *
  7119*   RECORD SIZE = 25   RECFORM = FIXED                           *
  7120*   BASE CLUSTER = DLYACTV                                       *
  7121*   LOG = YES                                                    *
  7122*   NARRATIVE - FILE IS BUILT DURING DAYTIME CICS PROCESSING AND *
  7123*               IS THEN PROCESSED BY CYCLE PROCESSING AT NIGHT.  *
  7124*               THIS IS USED TO BUILD THE LOGIC "F" EXTRACT      *
  7125*               RECORDS FOR THOSE CLAIMS WHICH HAVE HAD ACTIVITY *
  7126*               DURING THE DAY. THE EXTRACTS THEN GET READ IN    *
  7127*               BY PROGRAM "LGINFCE".                            *
  7128*                                                                *
  7129******************************************************************
  7130 01  DAILY-ACTIVITY-RECORD.
  7131     05  DA-KEY.
  7132         10  DA-COMP-CD          PIC X.
  7133         10  DA-CARRIER          PIC X.
  7134         10  DA-CLAIM-NO         PIC X(7).
  7135         10  DA-CERT-NO.
  7136             15  DA-CERT-PRIME   PIC X(10).
  7137             15  DA-CERT-SFX     PIC X.
  7138     05  DA-TRAILER-SEQ-NO       PIC S9(4)  COMP.
  7139     05  DA-RECORD-TYPE          PIC X.
  7140     05  FILLER                  PIC X(2).
  7141******************************************************************
  7142
  7143*                                COPY ELCALPH.
  7144******************************************************************
  7145*                                                                *
  7146*                            ELCALPH.                            *
  7147*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7148*                            VMOD=2.003                          *
  7149*                                                                *
  7150*   FILE DESCRIPTION = ALPHA CROSS REFERENCE FILE                *
  7151*                                                                *
  7152*   FILE TYPE = VSAM,KSDS                                        *
  7153*   RECORD SIZE = 128  RECFORM = FIXED                           *
  7154*                                                                *
  7155*   BASE CLUSTER = ELALPH                         RKP=2,LEN=42   *
  7156*       ALTERNATE PATH1 = ELALPH2 (FULL CONTROL)  RKP=44,LEN=57  *
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 128
* EL131.cbl
  7157*                                                                *
  7158*   LOG = YES                                                    *
  7159*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7160*                                                                *
  7161*  NO  CID  MODS  IN  COPYBOOK  ELCALPH                          *
  7162******************************************************************
  7163
  7164 01  ALPHA-INDEX.
  7165     12  AI-RECORD-ID                         PIC XX.
  7166         88  VALID-AI-ID                  VALUE 'AI'.
  7167     12  AI-CONTROL-PRIMARY.
  7168         16  AI-COMPANY-CD                     PIC X.
  7169         16  AI-SOURCE                         PIC X.
  7170             88  AI-CLAIM-SYSTEM          VALUE 'C'.
  7171             88  AI-ADMIN-SYSTEM          VALUE 'A'.
  7172         16  AI-NAME.
  7173             20  AI-LAST-NAME                  PIC X(15).
  7174             20  AI-FIRST-NAME.
  7175                 24  AI-FIRST-INITIAL          PIC X.
  7176                 24  FILLER                    PIC X(11).
  7177             20  AI-MIDDLE-INIT                PIC X.
  7178         16  AI-DATE                           PIC X(8).
  7179         16  AI-TIME                           PIC S9(07) COMP-3.
  7180
  7181     12  AI-CONTROL-BY-ADMIN-KEY.
  7182         16  AI-CM-COMPANY-CD                  PIC X.
  7183         16  AI-CM-SOURCE                      PIC X.
  7184         16  AI-CM-CARRIER                     PIC X.
  7185         16  AI-CM-GROUPING.
  7186             20  AI-CM-GROUPING-PREFIX         PIC X(3).
  7187             20  AI-CM-GROUPING-PRIME          PIC X(3).
  7188         16  AI-CM-STATE                       PIC XX.
  7189         16  AI-CM-PRODUCER.
  7190             20  AI-CM-PRODUCER-PREFIX         PIC X(4).
  7191             20  AI-CM-PRODUCER-PRIME          PIC X(6).
  7192         16  AI-CM-CERT-EFF-DT                 PIC XX.
  7193         16  AI-CM-CERTIFICATE-NUMBER.
  7194             20  AI-CM-CERT-PRIME              PIC X(10).
  7195             20  AI-CM-CERT-SFX                PIC X.
  7196         16  AI-CM-DATE                        PIC X(8).
  7197         16  AI-CM-TIME                        PIC S9(7) COMP-3.
  7198         16  FILLER                            PIC X(11).
  7199
  7200     12  AI-CONTROL-BY-CLAIM-KEY REDEFINES
  7201         AI-CONTROL-BY-ADMIN-KEY.
  7202         16  AI-CL-COMPANY-CD                  PIC X.
  7203         16  AI-CL-SOURCE                      PIC X.
  7204         16  AI-CL-CARRIER                     PIC X.
  7205         16  AI-CL-CLAIM-NUMBER                PIC X(7).
  7206         16  AI-CL-CERTIFICATE-NUMBER.
  7207             20  AI-CL-CERT-PRIME              PIC X(10).
  7208             20  AI-CL-CERT-SFX                PIC X.
  7209         16  AI-CL-DATE                        PIC X(8).
  7210         16  AI-CL-INCURRED-DATE               PIC XX.
  7211         16  AI-CL-CLOSE-DATE                  PIC XX.
  7212         16  AI-CL-TIME                        PIC S9(7)  COMP-3.
  7213         16  AI-CREDIT-CARD-NUMBER.
  7214             20  AI-CCN.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 129
* EL131.cbl
  7215                 24  AI-CCN-PREFIX             PIC X(4).
  7216                 24  AI-CCN-PRIME              PIC X(12).
  7217             20  AI-CCN-FILLER                 PIC X(4).
  7218
  7219     12  AI-MAINT-INFO.
  7220         16  AI-LAST-MAINT-BY                  PIC X(4).
  7221         16  AI-LAST-MAINT-DT                  PIC XX.
  7222         16  AI-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  7223
  7224     12  AI-CLAIM-PAID-THRU-DT                 PIC XX.
  7225
  7226     12  FILLER                                PIC X(15).
  7227
  7228
  7229*                                COPY ERCDMDNT.
  7230******************************************************************
  7231*                                                                *
  7232*                            ERCDMDNT                            *
  7233*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7234*                            VMOD=2.005                          *
  7235*                                                                *
  7236*        FILE DESCRIPTION = DMD CERTIFICATE NOTES                *
  7237*                                                                *
  7238*        THIS COPYBOOK IS A REDEFINES OF ERCNOTE -               *
  7239*                                                                *
  7240*        FILE TYPE= VSAM,KSDS                                    *
  7241*        RECORD SIZE = 825    RECFORM = FIXED                    *
  7242*                                                                *
  7243*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  7244*                                                                *
  7245*        LOG = YES                                               *
  7246*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7247*                                                                *
  7248******************************************************************
  7249
  7250 01  CERTIFICATE-NOTE.
  7251     12  CN-RECORD-ID                     PIC  XX.
  7252         88  VALID-CN-ID                      VALUE 'CN'.
  7253
  7254     12  CN-CONTROL-PRIMARY.
  7255         16  CN-COMPANY-CD                PIC X.
  7256         16  CN-CERT-KEY.
  7257             20  CN-CARRIER               PIC X.
  7258             20  CN-GROUPING.
  7259                 24  CN-GROUPING-PREFIX   PIC XXX.
  7260                 24  CN-GROUPING-PRIME    PIC XXX.
  7261             20  CN-STATE                 PIC XX.
  7262             20  CN-ACCOUNT.
  7263                 24  CN-ACCOUNT-PREFIX    PIC X(4).
  7264                 24  CN-ACCOUNT-PRIME     PIC X(6).
  7265             20  CN-CERT-EFF-DT           PIC XX.
  7266             20  CN-CERT-NO.
  7267                 24  CN-CERT-PRIME        PIC X(10).
  7268                 24  CN-CERT-SFX          PIC X.
  7269
  7270     12  CN-BILLING-START-LINE-NO         PIC 99.
  7271     12  CN-BILLING-END-LINE-NO           PIC 99.
  7272
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 130
* EL131.cbl
  7273     12  CN-LINES.
  7274         16  CN-LINE                      PIC X(77)  OCCURS 10.
  7275
  7276     12  CN-CSI-NOTES REDEFINES CN-LINES.
  7277         16  CN-CSI-TEXT-NOTES            PIC X(77)  OCCURS 6.
  7278         16  CN-CSI-GENERAL-DATA-AREA.
  7279             20  CN-CSI-GENERAL-DATA      PIC X(77)  OCCURS 2.
  7280
  7281         16  CN-CSI-GENERAL-DATA-R REDEFINES
  7282             CN-CSI-GENERAL-DATA-AREA.
  7283             20  CN-CSI-GEN-NOC-KEY           PIC X(11).
  7284             20  CN-CSI-GEN-PRI-INSD-1ST-NAME PIC X(15).
  7285             20  CN-CSI-GEN-SEC-INSD-1ST-NAME PIC X(15).
  7286             20  CN-CSI-GEN-INSD-WORK-PHONE   PIC X(10).
  7287             20  CN-CSI-GEN-INFRM-1ST-NAME    PIC X(15).
  7288             20  CN-CSI-GEN-INFRM-LAST-NAME   PIC X(20).
  7289             20  CN-CSI-GEN-INFRM-MI          PIC X.
  7290             20  CN-CSI-GEN-INFRM-PHONE       PIC X(10).
  7291             20  CN-CSI-GEN-INFRM-REL         PIC X(15).
  7292             20  FILLER                       PIC XX.
  7293             20  CN-CSI-GEN-DATA-SOURCE       PIC XX.
  7294             20  FILLER                       PIC X(38).
  7295
  7296         16  CN-CSI-PRODUCT-DATA-AREA.
  7297             20  CN-CSI-PRODUCT-DATA      PIC X(77)  OCCURS 2.
  7298
  7299         16  CN-CSI-CREDIT-CARD-DATA REDEFINES
  7300             CN-CSI-PRODUCT-DATA-AREA.
  7301             20  CN-CSI-CC-BILL-BANK-ID   PIC X(6).
  7302             20  CN-CSI-CC-CANCEL-CD      PIC XX.
  7303             20  CN-CSI-CC-CANCEL-DT      PIC X(8).
  7304             20  CN-CSI-CC-CARD-TYPE      PIC XX.
  7305             20  CN-CSI-CC-CHANGE-AGE     PIC 999.
  7306             20  CN-CSI-CC-DIAGNOSIS-CD   PIC X(6).
  7307             20  FILLER                   PIC XX.
  7308             20  CN-CSI-CC-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7309             20  CN-CSI-CC-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  7310             20  CN-CSI-CC-INTEREST-PAID  PIC X.
  7311             20  CN-CSI-CC-ISSUE-ST       PIC XX.
  7312             20  CN-CSI-CC-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7313             20  CN-CSI-CC-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7314             20  CN-CSI-CC-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7315             20  CN-CSI-CC-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7316             20  CN-CSI-CC-OLD-ACCT-NO    PIC X(20).
  7317             20  CN-CSI-CC-POLICY-TYPE    PIC XXX.
  7318             20  CN-CSI-CC-PREMIUM-AMT    PIC S999V99   COMP-3.
  7319             20  CN-CSI-CC-PREMIUM-RT     PIC S999V999  COMP-3.
  7320             20  CN-CSI-CC-PREV-CLAIM-NO  PIC X(7).
  7321             20  CN-CSI-CC-SIGNED-DT      PIC X(8).
  7322             20  CN-CSI-CC-SPECIAL-TERM   PIC S999      COMP-3.
  7323             20  CN-CSI-CC-STMNT-DT       PIC X(8).
  7324             20  CN-CSI-CC-TERM-AGE       PIC 999.
  7325             20  CN-CSI-CC-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7326             20  CN-CSI-CC-WAIV-PREM-FLAG PIC X.
  7327             20  CN-CSI-CC-ISSUE-DT       PIC X(8).
  7328             20  CN-CSI-CC-BEN-CALC-SW    PIC X.
  7329             20  CN-CSI-CC-TERM-ROUND-SW  PIC X.
  7330             20  FILLER                   PIC X(25).
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 131
* EL131.cbl
  7331
  7332         16  CN-CSI-FAMILY-LEAVE-DATA REDEFINES
  7333             CN-CSI-CREDIT-CARD-DATA.
  7334             20  CN-CSI-FL-BILL-BANK-ID   PIC X(6).
  7335             20  CN-CSI-FL-CANCEL-CD      PIC XX.
  7336             20  CN-CSI-FL-CANCEL-DT      PIC X(8).
  7337             20  CN-CSI-FL-CARD-TYPE      PIC XX.
  7338             20  CN-CSI-FL-CHANGE-AGE     PIC 999.
  7339             20  CN-CSI-FL-DIAGNOSIS-CD   PIC X(6).
  7340             20  FILLER                   PIC XX.
  7341             20  CN-CSI-FL-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7342             20  CN-CSI-FL-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  7343             20  CN-CSI-FL-INTEREST-PAID  PIC X.
  7344             20  CN-CSI-FL-ISSUE-ST       PIC XX.
  7345             20  CN-CSI-FL-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7346             20  CN-CSI-FL-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7347             20  CN-CSI-FL-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7348             20  CN-CSI-FL-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7349             20  CN-CSI-FL-OLD-ACCT-NO    PIC X(20).
  7350             20  CN-CSI-FL-POLICY-TYPE    PIC XXX.
  7351             20  CN-CSI-FL-PREMIUM-AMT    PIC S999V99   COMP-3.
  7352             20  CN-CSI-FL-PREMIUM-RT     PIC S999V999  COMP-3.
  7353             20  CN-CSI-FL-PREV-CLAIM-NO  PIC X(7).
  7354             20  CN-CSI-FL-SIGNED-DT      PIC X(8).
  7355             20  CN-CSI-FL-SPECIAL-TERM   PIC S999      COMP-3.
  7356             20  CN-CSI-FL-STMNT-DT       PIC X(8).
  7357             20  CN-CSI-FL-TERM-AGE       PIC 999.
  7358             20  CN-CSI-FL-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7359             20  CN-CSI-FL-WAIV-PREM-FLAG PIC X.
  7360             20  CN-CSI-FL-ISSUE-DT       PIC X(8).
  7361             20  CN-CSI-FL-BEN-CALC-SW    PIC X.
  7362             20  CN-CSI-FL-TERM-ROUND-SW  PIC X.
  7363             20  CN-CSI-FL-LAST-DAY-WRKED PIC X(8).
  7364             20  FILLER                   PIC X(17).
  7365
  7366         16  CN-CSI-SENIOR-LIFE-DATA REDEFINES
  7367             CN-CSI-FAMILY-LEAVE-DATA.
  7368             20  CN-CSI-SL-BENE-DOB       PIC X(8).
  7369             20  CN-CSI-SL-BENE-NAME      PIC X(27).
  7370             20  CN-CSI-SL-BENE-REL       PIC X(8).
  7371             20  CN-CSI-SL-BENE-SSN       PIC S9(9)     COMP-3.
  7372             20  CN-CSI-SL-BILL-BANK-ID   PIC X(6).
  7373             20  CN-CSI-SL-CANCEL-DT      PIC X(8).
  7374             20  CN-CSI-SL-DIAGNOSIS-CD   PIC X(6).
  7375             20  CN-CSI-SL-INT-CHECK-DT   PIC X(8).
  7376             20  CN-CSI-SL-INT-CHECK-NO   PIC S9(7)     COMP-3.
  7377             20  CN-CSI-SL-INT-ON-PROCEEDS
  7378                                          PIC S9(5)V99  COMP-3.
  7379             20  CN-CSI-SL-ISSUE-DT       PIC X(8).
  7380             20  CN-CSI-SL-ISSUE-ST       PIC XX.
  7381             20  CN-CSI-SL-LIFE-PROCEEDS  PIC S9(5)V99  COMP-3.
  7382             20  CN-CSI-SL-LOAN-INT-DUE   PIC S9(5)V99  COMP-3.
  7383             20  CN-CSI-SL-POLICY-BENEFITS
  7384                                          PIC S9(5)V99  COMP-3.
  7385             20  CN-CSI-SL-POLICY-TYPE    PIC XXX.
  7386             20  CN-CSI-SL-PREM-AMT       PIC S9(5)V99  COMP-3.
  7387             20  CN-CSI-SL-PREM-CHECK-DT  PIC X(8).
  7388             20  CN-CSI-SL-PREM-CHECK-NO  PIC S9(7)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 132
* EL131.cbl
  7389             20  CN-CSI-SL-PREM-DUE       PIC S9(5)V99  COMP-3.
  7390             20  CN-CSI-SL-PREM-MODE      PIC 99.
  7391             20  CN-CSI-SL-PREM-REFUND    PIC S9(5)V99  COMP-3.
  7392             20  CN-CSI-SL-PREM-SUSP-DT   PIC X(8).
  7393             20  CN-CSI-SL-SIGNED-DT      PIC X(8).
  7394             20  CN-CSI-SL-STATE-NOT      PIC X.
  7395             20  FILLER                   PIC XX.
  7396
  7397         16  CN-CSI-PURCH-PROP-DATA REDEFINES
  7398             CN-CSI-SENIOR-LIFE-DATA.
  7399             20  CN-CSI-PP-CARD-TYPE      PIC XX.
  7400             20  CN-CSI-PP-CHANGE-AGE     PIC 999.
  7401             20  CN-CSI-PP-BEN-PAID-TO-DATE
  7402                                          PIC S9(5)V99  COMP-3.
  7403             20  CN-CSI-PP-BILL-BANK-ID   PIC X(6).
  7404             20  CN-CSI-PP-CANCEL-CD      PIC XX.
  7405             20  CN-CSI-PP-CANCEL-DT      PIC X(8).
  7406             20  CN-CSI-PP-DIAGNOSIS-CD   PIC X(6).
  7407             20  CN-CSI-PP-ISSUE-DT       PIC X(8).
  7408             20  CN-CSI-PP-ISSUE-ST       PIC XX.
  7409             20  CN-CSI-PP-MANUFACTURER   PIC X(17).
  7410             20  CN-CSI-PP-MODEL-NO       PIC X(8).
  7411             20  CN-CSI-PP-OLD-ACCT-NO    PIC X(20).
  7412             20  CN-CSI-PP-POLICY-TYPE    PIC XXX.
  7413             20  CN-CSI-PP-PREMIUM-RT     PIC S999V999  COMP-3.
  7414             20  CN-CSI-PP-PREV-CLAIM-NO  PIC X(7).
  7415             20  CN-CSI-PP-PURCHASE-DT    PIC X(8).
  7416             20  CN-CSI-PP-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7417             20  CN-CSI-PP-REPAIR         PIC X.
  7418             20  CN-CSI-PP-REPLACE        PIC X.
  7419             20  CN-CSI-PP-SERIAL-NO      PIC X(16).
  7420             20  CN-CSI-PP-SIGNED-DT      PIC X(8).
  7421             20  CN-CSI-PP-STMNT-DT       PIC X(8).
  7422             20  CN-CSI-PP-TERM-AGE       PIC 999.
  7423             20  FILLER                   PIC X(5).
  7424
  7425         16  CN-CSI-EXT-WARR-DATA REDEFINES
  7426             CN-CSI-PURCH-PROP-DATA.
  7427             20  CN-CSI-EW-CARD-TYPE      PIC XX.
  7428             20  CN-CSI-EW-CHANGE-AGE     PIC 999.
  7429             20  CN-CSI-EW-BILL-BANK-ID   PIC X(6).
  7430             20  CN-CSI-EW-CANCEL-CD      PIC XX.
  7431             20  CN-CSI-EW-CANCEL-DT      PIC X(8).
  7432             20  CN-CSI-EW-DIAGNOSIS-CD   PIC X(6).
  7433             20  CN-CSI-EW-ISSUE-DT       PIC X(8).
  7434             20  CN-CSI-EW-ISSUE-ST       PIC XX.
  7435             20  CN-CSI-EW-MANUFACTURER   PIC X(17).
  7436             20  CN-CSI-EW-MODEL-NO       PIC X(8).
  7437             20  CN-CSI-EW-OLD-ACCT-NO    PIC X(20).
  7438             20  CN-CSI-EW-POLICY-TYPE    PIC XXX.
  7439             20  CN-CSI-EW-PREMIUM-RT     PIC S999V999  COMP-3.
  7440             20  CN-CSI-EW-PREV-CLAIM-NO  PIC X(7).
  7441             20  CN-CSI-EW-PURCHASE-DT    PIC X(8).
  7442             20  CN-CSI-EW-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7443             20  CN-CSI-EW-REPAIR-COST    PIC S9(5)V99  COMP-3.
  7444             20  CN-CSI-EW-REPLACE        PIC X.
  7445             20  CN-CSI-EW-SERIAL-NO      PIC X(16).
  7446             20  CN-CSI-EW-SIGNED-DT      PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 133
* EL131.cbl
  7447             20  CN-CSI-EW-STMNT-DT       PIC X(8).
  7448             20  CN-CSI-EW-TERM-AGE       PIC 999.
  7449             20  CN-CSI-EW-WARRANTY-NO    PIC 99.
  7450             20  FILLER                   PIC X(4).
  7451
  7452     12  CN-LAST-MAINT-DT                 PIC XX.
  7453     12  CN-LAST-MAINT-HHMMSS             PIC S9(7)     COMP-3.
  7454     12  CN-LAST-MAINT-USER               PIC X(4).
  7455     12  FILLER                           PIC X(6).
  7456
  7457******************************************************************
  7458
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 134
* EL131.cbl
  7460 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CLAIM-MASTER
  7461                          CERTIFICATE-MASTER ACTIVITY-TRAILERS
  7462                          CONTROL-FILE ACTIVITY-QUE
  7463                          ACCOUNT-MASTER CHECK-QUE
  7464                          LETTER-ARCHIVE BENEFICIARY-MASTER
  7465                          DAILY-ACTIVITY-RECORD ALPHA-INDEX
  7466                          CERTIFICATE-NOTE.
  7467 0000-DFHEXIT SECTION.
  7468     MOVE '9#                    $   ' TO DFHEIV0.
  7469     MOVE 'EL131' TO DFHEIV1.
  7470     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7471
  7472     IF EIBCALEN = ZERO
  7473         GO TO 8800-UNAUTHORIZED-ACCESS.
  7474
  7475     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  7476     MOVE '5'                    TO DC-OPTION-CODE.
  7477     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  7478     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  7479     MOVE DC-GREG-DATE-1-YMD     TO  SAVE-DATE-YMD.
  7480     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  7481
  7482     IF SAVE-DATE-YY GREATER 70
  7483         MOVE 19                 TO SAVE-DATE-CC
  7484      ELSE
  7485         MOVE 20                 TO SAVE-DATE-CC.
  7486
  7487
  7488* EXEC CICS HANDLE CONDITION
  7489*        PGMIDERR (8820-XCTL-ERROR)
  7490*        NOTFND   (8150-ENTERED-CLAIM-NOTFOUND)
  7491*        ERROR    (9990-ABEND)
  7492*    END-EXEC.
  7493*    MOVE '"$LI.                 ! " #00007483' TO DFHEIV0
  7494     MOVE X'22244C492E20202020202020' TO DFHEIV0(1:12)
  7495     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7496     MOVE X'2220233030303037343833' TO DFHEIV0(25:11)
  7497     CALL 'kxdfhei1' USING DFHEIV0
  7498     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7499
  7500
  7501     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  7502     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  7503     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  7504
  7505     INITIALIZE    EDIT-WORK-AREA.
  7506     MOVE '/'                    TO WORK-SLASH.
  7507     MOVE SPACES                 TO ERROR-SWITCHES.
  7508
  7509     MOVE TRAN-ID                TO TRANS-ID.
  7510     MOVE EIBTRMID               TO PI-TERM.
  7511     MOVE MAP-ID                 TO PI-QUAL.
  7512
  7513     MOVE 2                      TO EMI-NUMBER-OF-LINES.
  7514
  7515     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  7516         MOVE LOW-VALUES         TO EL131AO
  7517         MOVE ER-0008            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 135
* EL131.cbl
  7518         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7519         MOVE -1                 TO MAINTL
  7520         GO TO 8110-SEND-DATA.
  7521
  7522     IF THIS-PGM NOT = PI-CALLING-PROGRAM
  7523         MOVE LOW-VALUES         TO EL131AO
  7524         MOVE PI-CALLING-PROGRAM TO WS-RETURNED-FROM
  7525         PERFORM 0100-UPDATE-PI THRU 0120-UPDATE-PI-EXIT
  7526         MOVE 'X'                TO PI-RETURN-CD-1
  7527         PERFORM 5000-BUILD-MAP THRU 5000-EXIT
  7528         MOVE -1                 TO MAINTL
  7529         IF WS-RETURNED-FROM = XCTL-EL114
  7530             PERFORM 4200-LOAD-CHANGES THRU 4200-EXIT
  7531         END-IF
  7532         GO TO 8100-SEND-MAP.
  7533
  7534     IF EIBAID = DFHCLEAR
  7535         GO TO 8200-RETURN-PRIOR.
  7536
  7537     IF PI-PROCESSOR-ID = 'LGXX'
  7538         NEXT SENTENCE
  7539     ELSE
  7540
  7541* EXEC CICS READQ TS
  7542*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  7543*            INTO    (SECURITY-CONTROL)
  7544*            LENGTH  (SC-COMM-LENGTH)
  7545*            ITEM    (SC-ITEM)
  7546*        END-EXEC
  7547*    MOVE '*$II   L              ''   #00007528' TO DFHEIV0
  7548     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  7549     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7550     MOVE X'2020233030303037353238' TO DFHEIV0(25:11)
  7551     CALL 'kxdfhei1' USING DFHEIV0,
  7552           PI-SECURITY-TEMP-STORE-ID,
  7553           SECURITY-CONTROL,
  7554           SC-COMM-LENGTH,
  7555           SC-ITEM,
  7556           DFHEIV99,
  7557           DFHEIV99
  7558     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7559         MOVE SC-CLAIMS-DISPLAY (5)    TO  PI-DISPLAY-CAP
  7560         MOVE SC-CLAIMS-UPDATE  (5)    TO  PI-MODIFY-CAP
  7561         IF NOT DISPLAY-CAP
  7562             MOVE 'READ'               TO  SM-READ
  7563             PERFORM 9995-SECURITY-VIOLATION
  7564             MOVE ER-0070              TO  EMI-ERROR
  7565             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7566             GO TO 8100-SEND-MAP.
  7567
  7568
  7569* EXEC CICS RECEIVE
  7570*        MAP    ('EL131A')
  7571*        MAPSET ('EL131S')
  7572*    END-EXEC.
  7573     MOVE 'EL131A' TO DFHEIV1
  7574     MOVE 'EL131S' TO DFHEIV2
  7575*    MOVE '8"T                   ''   #00007543' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 136
* EL131.cbl
  7576     MOVE X'382254202020202020202020' TO DFHEIV0(1:12)
  7577     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7578     MOVE X'2020233030303037353433' TO DFHEIV0(25:11)
  7579     CALL 'kxdfhei1' USING DFHEIV0,
  7580           DFHEIV1,
  7581           EL131AI,
  7582           DFHEIV99,
  7583           DFHEIV2,
  7584           DFHEIV99,
  7585           DFHEIV99
  7586     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7587
  7588
  7589     IF PFKEYL GREATER THAN ZERO
  7590         PERFORM 0200-TRANS-PF THRU 0210-EXIT.
  7591
  7592     IF SCREEN-ERROR
  7593         MOVE ER-0004 TO EMI-ERROR
  7594         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7595         MOVE -1 TO MAINTL
  7596         GO TO 8110-SEND-DATA.
  7597
  7598     IF EIBAID = DFHPF3
  7599         GO TO 8500-TRLR-MNT.
  7600
  7601     IF EIBAID = DFHPF4
  7602         GO TO 8600-ADDR-MNT.
  7603
  7604     IF EIBAID = DFHPF5
  7605         GO TO 8700-CERT-MNT.
  7606
  7607     IF PI-COMPANY-ID = 'DMD'
  7608       IF EIBAID = DFHPF6
  7609         GO TO 8750-DMD-CLM-FIX.
  7610
  7611     IF EIBAID = DFHPF7
  7612         GO TO 4000-FORCE-ERRORS.
  7613
  7614     IF EIBAID = DFHPF12
  7615         GO TO 8300-GET-HELP.
  7616
  7617     IF EIBAID = DFHPF15
  7618         GO TO 8725-BENEFICIARY-MNT
  7619     END-IF.
  7620
  7621     IF EIBAID = DFHPF23
  7622         GO TO 8810-PF23-ENTERED.
  7623
  7624     IF EIBAID = DFHPF24
  7625         GO TO 8400-RETURN-MASTER.
  7626
  7627     IF EIBAID NOT = DFHENTER
  7628         MOVE ER-0029            TO EMI-ERROR
  7629         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7630         MOVE -1                 TO MAINTL
  7631         GO TO 8110-SEND-DATA.
  7632
  7633     IF PI-RETURN-CD-1 =  'X'
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 137
* EL131.cbl
  7634         MOVE ER-0311            TO EMI-ERROR
  7635         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7636         MOVE -1                 TO MAINTL
  7637         GO TO 8110-SEND-DATA.
  7638
  7639     IF MAINTI = 'A'
  7640         GO TO 0500-ADD-ALPHA-ONLY.
  7641
  7642     IF MAINTI = 'N'
  7643         GO TO 0600-CHANGE-NAME.
  7644
  7645     PERFORM 1000-EDIT-SCREEN THRU 1010-EXIT.
  7646
  7647     IF SCREEN-ERROR
  7648         GO TO 8110-SEND-DATA.
  7649
  7650     IF NOT UPDATES-PRESENT AND NOT DELETE-CLAIM
  7651         MOVE ER-0276            TO EMI-ERROR
  7652         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7653         MOVE -1                 TO MAINTL
  7654         GO TO 8110-SEND-DATA.
  7655
  7656     PERFORM 2000-UPDATE-CLAIM THRU 2000-EXIT.
  7657
  7658     IF SCREEN-ERROR
  7659         GO TO 8110-SEND-DATA.
  7660
  7661     MOVE 'W'                    TO EMI-ACTION-SWITCH.
  7662
  7663     PERFORM 5000-BUILD-MAP THRU 5000-EXIT.
  7664
  7665     IF EMI-FORCABLE-CTR GREATER THAN ZERO
  7666         GO TO 8110-SEND-DATA.
  7667
  7668     IF EMI-FATAL-CTR GREATER THAN ZERO
  7669         GO TO 8110-SEND-DATA.
  7670
  7671     MOVE SPACE                  TO EMI-ACTION-SWITCH.
  7672
  7673     IF WS-OPEN-CLOSE-SW = 'Y'
  7674         IF PI-LETTER-SW = 'Y'
  7675             MOVE PI-COMPANY-ID  TO  CNTL-CO-ID
  7676             MOVE 'T'            TO  CNTL-REC-TYPE
  7677             MOVE SPACES         TO  CNTL-PROC-ID
  7678             MOVE +0             TO  CNTL-SEQ-NO
  7679
  7680* EXEC CICS READ
  7681*                DATASET   (CNTL-FILE-ID)
  7682*                RIDFLD    (CNTL-KEY)
  7683*                SET       (ADDRESS OF CONTROL-FILE)
  7684*            END-EXEC
  7685*    MOVE '&"S        E          (   #00007638' TO DFHEIV0
  7686     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7687     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7688     MOVE X'2020233030303037363338' TO DFHEIV0(25:11)
  7689     CALL 'kxdfhei1' USING DFHEIV0,
  7690           CNTL-FILE-ID,
  7691           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 138
* EL131.cbl
  7692           DFHEIV99,
  7693           CNTL-KEY,
  7694           DFHEIV99,
  7695           DFHEIV99,
  7696           DFHEIV99
  7697     SET ADDRESS OF CONTROL-FILE TO
  7698         DFHEIV20
  7699     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7700             PERFORM 7850-AUTO-LETTER-WRITER THRU 7850-EXIT.
  7701
  7702     MOVE ER-0000                TO EMI-ERROR.
  7703     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7704
  7705     MOVE SPACE                  TO MAINTO.
  7706     MOVE -1                     TO MAINTL.
  7707     GO TO 8100-SEND-MAP.
  7708
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 139
* EL131.cbl
  7710 0100-UPDATE-PI.
  7711
  7712     MOVE LOW-VALUES             TO WS-SAVE-BENEFICIARY.
  7713     IF WS-RETURNED-FROM = XCTL-EL114
  7714***sometimes there is crap in positions 7-10 when no code was sele
  7715        IF PI-PROGRAM-WORK-AREA (1:5) > SPACES
  7716          MOVE PI-PROGRAM-WORK-AREA (1:10) TO WS-SAVE-BENEFICIARY
  7717        END-IF
  7718     END-IF.
  7719
  7720     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  7721         GO TO 0110-UPDATE-UP.
  7722
  7723     MOVE PI-SAVED-PROGRAM-5     TO PI-SAVED-PROGRAM-6.
  7724     MOVE PI-SAVED-PROGRAM-4     TO PI-SAVED-PROGRAM-5.
  7725     MOVE PI-SAVED-PROGRAM-3     TO PI-SAVED-PROGRAM-4.
  7726     MOVE PI-SAVED-PROGRAM-2     TO PI-SAVED-PROGRAM-3.
  7727     MOVE PI-SAVED-PROGRAM-1     TO PI-SAVED-PROGRAM-2.
  7728     MOVE PI-RETURN-TO-PROGRAM   TO PI-SAVED-PROGRAM-1.
  7729     MOVE PI-CALLING-PROGRAM     TO PI-RETURN-TO-PROGRAM.
  7730     MOVE THIS-PGM               TO PI-CALLING-PROGRAM.
  7731     GO TO 0120-UPDATE-PI-EXIT.
  7732
  7733 0110-UPDATE-UP.
  7734     MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM.
  7735     MOVE PI-SAVED-PROGRAM-1 TO PI-RETURN-TO-PROGRAM.
  7736     MOVE PI-SAVED-PROGRAM-2 TO PI-SAVED-PROGRAM-1.
  7737     MOVE PI-SAVED-PROGRAM-3 TO PI-SAVED-PROGRAM-2.
  7738     MOVE PI-SAVED-PROGRAM-4 TO PI-SAVED-PROGRAM-3.
  7739     MOVE PI-SAVED-PROGRAM-5 TO PI-SAVED-PROGRAM-4.
  7740     MOVE PI-SAVED-PROGRAM-6 TO PI-SAVED-PROGRAM-5.
  7741     MOVE SPACES             TO PI-SAVED-PROGRAM-6.
  7742
  7743
  7744* EXEC CICS HANDLE CONDITION
  7745*         QIDERR    (0130-TS-ERROR)
  7746*         ITEMERR   (0130-TS-ERROR)
  7747*    END-EXEC.
  7748*    MOVE '"$N<                  ! # #00007686' TO DFHEIV0
  7749     MOVE X'22244E3C2020202020202020' TO DFHEIV0(1:12)
  7750     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7751     MOVE X'2320233030303037363836' TO DFHEIV0(25:11)
  7752     CALL 'kxdfhei1' USING DFHEIV0
  7753     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7754
  7755
  7756     IF WS-RETURNED-FROM = XCTL-EL114
  7757
  7758* EXEC CICS READQ TS
  7759*            QUEUE    (PI-KEY)
  7760*            INTO     (EL131AI)
  7761*            LENGTH   (MAP-LENGTH)
  7762*       END-EXEC
  7763*    MOVE '*$I    L              ''   #00007692' TO DFHEIV0
  7764     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7765     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7766     MOVE X'2020233030303037363932' TO DFHEIV0(25:11)
  7767     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 140
* EL131.cbl
  7768           PI-KEY,
  7769           EL131AI,
  7770           MAP-LENGTH,
  7771           DFHEIV99,
  7772           DFHEIV99,
  7773           DFHEIV99
  7774     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7775
  7776        IF WS-SAVE-BENEFICIARY > SPACES
  7777            MOVE WS-SAVE-BENEFICIARY TO BENEI
  7778            MOVE +10            TO BENEL
  7779            MOVE LOW-VALUES TO WS-SAVE-BENEFICIARY
  7780        END-IF
  7781        PERFORM 4100-SAVE-CHANGES THRU 4100-EXIT
  7782     END-IF.
  7783
  7784
  7785* EXEC CICS READQ TS
  7786*         QUEUE    (PI-KEY)
  7787*         INTO     (PROGRAM-INTERFACE-BLOCK)
  7788*         LENGTH   (PI-COMM-LENGTH)
  7789*    END-EXEC.
  7790*    MOVE '*$I    L              ''   #00007706' TO DFHEIV0
  7791     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7792     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7793     MOVE X'2020233030303037373036' TO DFHEIV0(25:11)
  7794     CALL 'kxdfhei1' USING DFHEIV0,
  7795           PI-KEY,
  7796           PROGRAM-INTERFACE-BLOCK,
  7797           PI-COMM-LENGTH,
  7798           DFHEIV99,
  7799           DFHEIV99,
  7800           DFHEIV99
  7801     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7802
  7803
  7804
  7805* EXEC CICS DELETEQ TS
  7806*         QUEUE    (PI-KEY)
  7807*    END-EXEC.
  7808*    MOVE '*&                    #   #00007712' TO DFHEIV0
  7809     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  7810     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7811     MOVE X'2020233030303037373132' TO DFHEIV0(25:11)
  7812     CALL 'kxdfhei1' USING DFHEIV0,
  7813           PI-KEY,
  7814           DFHEIV99
  7815     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7816
  7817
  7818 0120-UPDATE-PI-EXIT.
  7819     EXIT.
  7820
  7821 0130-TS-ERROR.
  7822     MOVE LOW-VALUES             TO EL131AO.
  7823     MOVE ER-0192                TO EMI-ERROR.
  7824
  7825     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 141
* EL131.cbl
  7826
  7827     GO TO 8100-SEND-MAP.
  7828
  7829 0200-TRANS-PF.
  7830     IF EIBAID NOT = DFHENTER
  7831         MOVE 'X'                TO ERROR-SWITCH
  7832         GO TO 0210-EXIT.
  7833
  7834     IF PFKEYI NOT NUMERIC
  7835         MOVE 'X'                TO ERROR-SWITCH
  7836         GO TO 0210-EXIT.
  7837
  7838     MOVE PFKEYI                 TO CHECK-PFKEYS.
  7839
  7840     IF CHECK-PFKEYS LESS 1 OR GREATER 24
  7841         MOVE 'X' TO ERROR-SWITCH
  7842         GO TO 0210-EXIT.
  7843
  7844     MOVE AID-KEYS (CHECK-PFKEYS) TO EIBAID.
  7845
  7846 0210-EXIT.
  7847     EXIT.
  7848
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 142
* EL131.cbl
  7850 0500-ADD-ALPHA-ONLY.
  7851******************************************************************
  7852*    ADD NAME TO ALPHA FILE.  NO CHANGES ARE MADE TO THE CLAIM   *
  7853*    RECORD.                                                     *
  7854******************************************************************
  7855
  7856     IF MLNAMEL = +0 AND
  7857        MFNAMEL = +0 AND
  7858        MMINITL = +0
  7859         MOVE ER-0797                TO  EMI-ERROR
  7860         MOVE -1                     TO  MAINTL
  7861         MOVE AL-UABON               TO  MAINTA
  7862         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7863         GO TO 8110-SEND-DATA.
  7864
  7865     MOVE PI-COMPANY-CD              TO  COMPANY-CODE.
  7866     MOVE PI-CARRIER                 TO  CARRIER-CODE.
  7867     MOVE PI-CLAIM-NO                TO  CLAIM-NO.
  7868     MOVE PI-CERT-NO                 TO  CERT-NO.
  7869
  7870
  7871* EXEC CICS READ
  7872*        DATASET   (CLMS-FILE-ID)
  7873*        RIDFLD    (MSTR-KEY)
  7874*        SET       (ADDRESS OF CLAIM-MASTER)
  7875*    END-EXEC.
  7876*    MOVE '&"S        E          (   #00007768' TO DFHEIV0
  7877     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7878     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7879     MOVE X'2020233030303037373638' TO DFHEIV0(25:11)
  7880     CALL 'kxdfhei1' USING DFHEIV0,
  7881           CLMS-FILE-ID,
  7882           DFHEIV20,
  7883           DFHEIV99,
  7884           MSTR-KEY,
  7885           DFHEIV99,
  7886           DFHEIV99,
  7887           DFHEIV99
  7888     SET ADDRESS OF CLAIM-MASTER TO
  7889         DFHEIV20
  7890     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7891
  7892
  7893
  7894* EXEC CICS GETMAIN
  7895*        SET       (ADDRESS OF ALPHA-INDEX)
  7896*        LENGTH    (ALPH-LENGTH)
  7897*        INITIMG   (GETMAIN-SPACE)
  7898*    END-EXEC.
  7899*    MOVE ',"IL                  $   #00007774' TO DFHEIV0
  7900     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7901     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7902     MOVE X'2020233030303037373734' TO DFHEIV0(25:11)
  7903     CALL 'kxdfhei1' USING DFHEIV0,
  7904           DFHEIV20,
  7905           ALPH-LENGTH,
  7906           GETMAIN-SPACE
  7907     SET ADDRESS OF ALPHA-INDEX TO
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 143
* EL131.cbl
  7908         DFHEIV20
  7909     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7910
  7911
  7912     MOVE 'AI'                       TO  AI-RECORD-ID.
  7913     MOVE CL-COMPANY-CD              TO  AI-COMPANY-CD
  7914                                         AI-CL-COMPANY-CD.
  7915     MOVE 'C'                        TO  AI-SOURCE
  7916                                         AI-CL-SOURCE.
  7917
  7918     IF MLNAMEL IS GREATER THAN +0
  7919         MOVE MLNAMEI                TO  AI-LAST-NAME
  7920     ELSE
  7921         MOVE CL-INSURED-LAST-NAME   TO  AI-LAST-NAME.
  7922
  7923     IF MFNAMEL IS GREATER THAN +0
  7924         MOVE MFNAMEI                TO  AI-FIRST-NAME
  7925     ELSE
  7926         MOVE CL-INSURED-1ST-NAME    TO  AI-FIRST-NAME.
  7927
  7928     IF MMINITL IS GREATER THAN +0
  7929         MOVE MMINITI                TO  AI-MIDDLE-INIT
  7930     ELSE
  7931         MOVE CL-INSURED-MID-INIT    TO  AI-MIDDLE-INIT.
  7932
  7933     MOVE EIBDATE                    TO  DC-JULIAN-YYDDD.
  7934     MOVE '5'                        TO  DC-OPTION-CODE.
  7935     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  7936     MOVE DC-GREG-DATE-1-MDY         TO  BUILD-VALID-DATE.
  7937     IF BUILD-YEAR IS GREATER THAN 50
  7938         MOVE '19'                   TO  WS-ALPHA-YY-1
  7939         MOVE BUILD-YEAR             TO  WS-ALPHA-YY-2
  7940         MOVE BUILD-MONTH            TO  WS-ALPHA-MM
  7941         MOVE BUILD-DAY              TO  WS-ALPHA-DD
  7942     ELSE
  7943         MOVE '20'                   TO  WS-ALPHA-YY-1
  7944         MOVE BUILD-YEAR             TO  WS-ALPHA-YY-2
  7945         MOVE BUILD-MONTH            TO  WS-ALPHA-MM
  7946         MOVE BUILD-DAY              TO  WS-ALPHA-DD.
  7947
  7948     MOVE WS-ALPHA-DATE              TO  AI-DATE
  7949                                         AI-CL-DATE.
  7950
  7951     MOVE EIBTIME                    TO  AI-TIME
  7952                                         AI-CL-TIME.
  7953
  7954     MOVE CL-COMPANY-CD              TO  AI-CL-COMPANY-CD.
  7955     MOVE 'C'                        TO  AI-CL-SOURCE.
  7956     MOVE CL-CARRIER                 TO  AI-CL-CARRIER.
  7957     MOVE CL-CLAIM-NO                TO  AI-CL-CLAIM-NUMBER.
  7958     MOVE CL-CERT-NO                 TO  AI-CL-CERTIFICATE-NUMBER.
  7959     MOVE CL-INCURRED-DT             TO  AI-CL-INCURRED-DATE.
  7960     MOVE LOW-VALUES                 TO  AI-CL-CLOSE-DATE.
  7961
  7962     MOVE PI-PROCESSOR-ID            TO  AI-LAST-MAINT-BY.
  7963     MOVE SAVE-BIN-DATE              TO  AI-LAST-MAINT-DT.
  7964     MOVE EIBTIME                    TO  AI-LAST-MAINT-HHMMSS.
  7965
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 144
* EL131.cbl
  7966
  7967* EXEC CICS WRITE
  7968*        DATASET   (ALPH-FILE-ID)
  7969*        RIDFLD    (AI-CONTROL-PRIMARY)
  7970*        FROM      (ALPHA-INDEX)
  7971*    END-EXEC.
  7972     MOVE LENGTH OF
  7973      ALPHA-INDEX
  7974       TO DFHEIV11
  7975*    MOVE '&$ L                  ''   #00007834' TO DFHEIV0
  7976     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7977     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7978     MOVE X'2020233030303037383334' TO DFHEIV0(25:11)
  7979     CALL 'kxdfhei1' USING DFHEIV0,
  7980           ALPH-FILE-ID,
  7981           ALPHA-INDEX,
  7982           DFHEIV11,
  7983           AI-CONTROL-PRIMARY,
  7984           DFHEIV99,
  7985           DFHEIV99
  7986     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7987
  7988
  7989     MOVE LOW-VALUES                 TO  EL131AO.
  7990     PERFORM 5000-BUILD-MAP THRU 5000-EXIT.
  7991     MOVE ER-0000                    TO  EMI-ERROR.
  7992     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7993     MOVE -1                         TO  MAINTL.
  7994     GO TO 8100-SEND-MAP.
  7995
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 145
* EL131.cbl
  7997 0600-CHANGE-NAME.
  7998******************************************************************
  7999*    MOVE NAME IN THE CLAIM RECORD TO THE ALPHA FILE AND REPLACE *
  8000*    IT WITH THE NAME THAT IS KEYED ON THE SCREEN.               *
  8001******************************************************************
  8002
  8003     IF MLNAMEL = +0 AND
  8004        MFNAMEL = +0 AND
  8005        MMINITL = +0
  8006         MOVE ER-0276                TO  EMI-ERROR
  8007         MOVE -1                     TO  MAINTL
  8008         MOVE AL-UABON               TO  MAINTA
  8009         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8010         GO TO 8110-SEND-DATA.
  8011
  8012     MOVE PI-COMPANY-CD              TO  COMPANY-CODE.
  8013     MOVE PI-CARRIER                 TO  CARRIER-CODE.
  8014     MOVE PI-CLAIM-NO                TO  CLAIM-NO.
  8015     MOVE PI-CERT-NO                 TO  CERT-NO.
  8016
  8017
  8018* EXEC CICS READ
  8019*        DATASET   (CLMS-FILE-ID)
  8020*        RIDFLD    (MSTR-KEY)
  8021*        SET       (ADDRESS OF CLAIM-MASTER)
  8022*    END-EXEC.
  8023*    MOVE '&"S        E          (   #00007868' TO DFHEIV0
  8024     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8025     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8026     MOVE X'2020233030303037383638' TO DFHEIV0(25:11)
  8027     CALL 'kxdfhei1' USING DFHEIV0,
  8028           CLMS-FILE-ID,
  8029           DFHEIV20,
  8030           DFHEIV99,
  8031           MSTR-KEY,
  8032           DFHEIV99,
  8033           DFHEIV99,
  8034           DFHEIV99
  8035     SET ADDRESS OF CLAIM-MASTER TO
  8036         DFHEIV20
  8037     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8038
  8039
  8040
  8041* EXEC CICS GETMAIN
  8042*        SET       (ADDRESS OF ALPHA-INDEX)
  8043*        LENGTH    (ALPH-LENGTH)
  8044*        INITIMG   (GETMAIN-SPACE)
  8045*    END-EXEC.
  8046*    MOVE ',"IL                  $   #00007874' TO DFHEIV0
  8047     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  8048     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8049     MOVE X'2020233030303037383734' TO DFHEIV0(25:11)
  8050     CALL 'kxdfhei1' USING DFHEIV0,
  8051           DFHEIV20,
  8052           ALPH-LENGTH,
  8053           GETMAIN-SPACE
  8054     SET ADDRESS OF ALPHA-INDEX TO
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 146
* EL131.cbl
  8055         DFHEIV20
  8056     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8057
  8058
  8059     MOVE 'AI'                       TO  AI-RECORD-ID.
  8060     MOVE CL-COMPANY-CD              TO  AI-COMPANY-CD
  8061                                         AI-CL-COMPANY-CD.
  8062     MOVE 'C'                        TO  AI-SOURCE
  8063                                         AI-CL-SOURCE.
  8064
  8065     MOVE CL-INSURED-LAST-NAME       TO  AI-LAST-NAME.
  8066     MOVE CL-INSURED-1ST-NAME        TO  AI-FIRST-NAME.
  8067     MOVE CL-INSURED-MID-INIT        TO  AI-MIDDLE-INIT.
  8068
  8069     MOVE EIBDATE                    TO  DC-JULIAN-YYDDD.
  8070     MOVE '5'                        TO  DC-OPTION-CODE.
  8071     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  8072     MOVE DC-GREG-DATE-1-MDY         TO  BUILD-VALID-DATE.
  8073     IF BUILD-YEAR IS GREATER THAN 50
  8074         MOVE '19'                   TO  WS-ALPHA-YY-1
  8075         MOVE BUILD-YEAR             TO  WS-ALPHA-YY-2
  8076         MOVE BUILD-MONTH            TO  WS-ALPHA-MM
  8077         MOVE BUILD-DAY              TO  WS-ALPHA-DD
  8078     ELSE
  8079         MOVE '20'                   TO  WS-ALPHA-YY-1
  8080         MOVE BUILD-YEAR             TO  WS-ALPHA-YY-2
  8081         MOVE BUILD-MONTH            TO  WS-ALPHA-MM
  8082         MOVE BUILD-DAY              TO  WS-ALPHA-DD.
  8083
  8084     MOVE WS-ALPHA-DATE              TO  AI-DATE
  8085                                         AI-CL-DATE.
  8086
  8087     MOVE EIBTIME                    TO  AI-TIME
  8088                                         AI-CL-TIME.
  8089
  8090     MOVE CL-COMPANY-CD              TO  AI-CL-COMPANY-CD.
  8091     MOVE 'C'                        TO  AI-CL-SOURCE.
  8092     MOVE CL-CARRIER                 TO  AI-CL-CARRIER.
  8093     MOVE CL-CLAIM-NO                TO  AI-CL-CLAIM-NUMBER.
  8094     MOVE CL-CERT-NO                 TO  AI-CL-CERTIFICATE-NUMBER.
  8095     MOVE CL-INCURRED-DT             TO  AI-CL-INCURRED-DATE.
  8096     MOVE LOW-VALUES                 TO  AI-CL-CLOSE-DATE.
  8097
  8098     MOVE PI-PROCESSOR-ID            TO  AI-LAST-MAINT-BY.
  8099     MOVE SAVE-BIN-DATE              TO  AI-LAST-MAINT-DT.
  8100     MOVE EIBTIME                    TO  AI-LAST-MAINT-HHMMSS.
  8101
  8102     IF PI-COMPANY-ID = 'CID' or 'AHL'
  8103         MOVE 'Y'                TO CL-YESNOSW
  8104     END-IF.
  8105
  8106
  8107* EXEC CICS WRITE
  8108*        DATASET   (ALPH-FILE-ID)
  8109*        RIDFLD    (AI-CONTROL-PRIMARY)
  8110*        FROM      (ALPHA-INDEX)
  8111*    END-EXEC.
  8112     MOVE LENGTH OF
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 147
* EL131.cbl
  8113      ALPHA-INDEX
  8114       TO DFHEIV11
  8115*    MOVE '&$ L                  ''   #00007927' TO DFHEIV0
  8116     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  8117     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8118     MOVE X'2020233030303037393237' TO DFHEIV0(25:11)
  8119     CALL 'kxdfhei1' USING DFHEIV0,
  8120           ALPH-FILE-ID,
  8121           ALPHA-INDEX,
  8122           DFHEIV11,
  8123           AI-CONTROL-PRIMARY,
  8124           DFHEIV99,
  8125           DFHEIV99
  8126     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8127
  8128
  8129
  8130* EXEC CICS READ
  8131*        DATASET   (CLMS-FILE-ID)
  8132*        RIDFLD    (MSTR-KEY)
  8133*        SET       (ADDRESS OF CLAIM-MASTER)
  8134*        UPDATE
  8135*    END-EXEC.
  8136*    MOVE '&"S        EU         (   #00007933' TO DFHEIV0
  8137     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8138     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8139     MOVE X'2020233030303037393333' TO DFHEIV0(25:11)
  8140     CALL 'kxdfhei1' USING DFHEIV0,
  8141           CLMS-FILE-ID,
  8142           DFHEIV20,
  8143           DFHEIV99,
  8144           MSTR-KEY,
  8145           DFHEIV99,
  8146           DFHEIV99,
  8147           DFHEIV99
  8148     SET ADDRESS OF CLAIM-MASTER TO
  8149         DFHEIV20
  8150     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8151
  8152
  8153     if (cl-priority-cd = '8')
  8154        and (pi-processor-id not = 'PEMA'and 'JMS '
  8155             AND 'AMWA' AND 'KMSB')
  8156        MOVE ER-8003             TO EMI-ERROR
  8157        PERFORM 9900-ERROR-FORMAT
  8158                                 THRU 9900-EXIT
  8159        MOVE -1                  TO MAINTL
  8160        GO TO 8110-SEND-DATA
  8161     end-if
  8162
  8163     IF MLNAMEL IS GREATER THAN +0
  8164         MOVE MLNAMEI                TO  CL-INSURED-LAST-NAME.
  8165
  8166     IF MFNAMEL IS GREATER THAN +0
  8167         MOVE MFNAMEI                TO  CL-INSURED-1ST-NAME.
  8168
  8169     IF MMINITL IS GREATER THAN +0
  8170         MOVE MMINITI                TO  CL-INSURED-MID-INIT.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 148
* EL131.cbl
  8171
  8172     MOVE PI-PROCESSOR-ID            TO  CL-LAST-MAINT-USER.
  8173     MOVE SAVE-BIN-DATE              TO  CL-LAST-MAINT-DT.
  8174     MOVE EIBTIME                    TO  CL-LAST-MAINT-HHMMSS.
  8175     MOVE '3'                        TO  CL-LAST-MAINT-TYPE.
  8176
  8177     IF PI-COMPANY-ID = 'CID' or 'AHL'
  8178         MOVE 'Y'                TO CL-YESNOSW
  8179     END-IF.
  8180
  8181
  8182* EXEC CICS HANDLE CONDITION
  8183*        DUPKEY   (0600-CONTINUE-NAME-UPDATE)
  8184*    END-EXEC.
  8185*    MOVE '"$$                   ! $ #00007968' TO DFHEIV0
  8186     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  8187     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8188     MOVE X'2420233030303037393638' TO DFHEIV0(25:11)
  8189     CALL 'kxdfhei1' USING DFHEIV0
  8190     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8191
  8192
  8193
  8194* EXEC CICS REWRITE
  8195*        DATASET   (CLMS-FILE-ID)
  8196*        FROM      (CLAIM-MASTER)
  8197*    END-EXEC.
  8198     MOVE LENGTH OF
  8199      CLAIM-MASTER
  8200       TO DFHEIV11
  8201*    MOVE '&& L                  %   #00007972' TO DFHEIV0
  8202     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8203     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8204     MOVE X'2020233030303037393732' TO DFHEIV0(25:11)
  8205     CALL 'kxdfhei1' USING DFHEIV0,
  8206           CLMS-FILE-ID,
  8207           CLAIM-MASTER,
  8208           DFHEIV11,
  8209           DFHEIV99
  8210     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8211
  8212
  8213 0600-CONTINUE-NAME-UPDATE.
  8214
  8215     MOVE LOW-VALUES                 TO  EL131AO.
  8216     PERFORM 5000-BUILD-MAP THRU 5000-EXIT.
  8217     MOVE ER-0000                    TO  EMI-ERROR.
  8218     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8219     MOVE -1                         TO  MAINTL.
  8220     GO TO 8100-SEND-MAP.
  8221
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 149
* EL131.cbl
  8223 1000-EDIT-SCREEN.
  8224
  8225     MOVE MAINTI                 TO CHECK-MAINT.
  8226
  8227     IF NOT VALID-OPTIONS
  8228         MOVE 'X'                TO ERROR-SWITCH
  8229         MOVE -1                 TO MAINTL
  8230         MOVE AL-UABON           TO MAINTA
  8231         MOVE ER-0023            TO EMI-ERROR
  8232         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8233         GO TO 1010-EXIT.
  8234
  8235     IF NOT MODIFY-CAP
  8236         MOVE 'UPDATE'           TO  SM-READ
  8237         PERFORM 9995-SECURITY-VIOLATION
  8238         MOVE ER-0070               TO  EMI-ERROR
  8239         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8240         GO TO 8100-SEND-MAP.
  8241
  8242     IF DELETE-CLAIM
  8243         MOVE AL-UANON TO MAINTA
  8244         GO TO 1010-EXIT.
  8245
  8246     MOVE AL-UANON               TO MAINTA.
  8247
  8248     IF CCNOI GREATER THAN LOW-VALUES
  8249         MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH.
  8250
  8251     IF PI-COMPANY-ID = 'CSL'
  8252        CONTINUE
  8253     ELSE
  8254        IF TYPEL > ZERO
  8255           IF ((PI-COMPANY-ID = 'CID' or 'AHL')
  8256              AND (TYPEI = PI-AH-OVERRIDE-L1 OR
  8257                    PI-LIFE-OVERRIDE-L1))
  8258                       OR
  8259              ((PI-COMPANY-ID = 'DCC' OR 'VPP')
  8260              AND (TYPEI = PI-AH-OVERRIDE-L1 OR
  8261                PI-LIFE-OVERRIDE-L1 OR 'I' OR 'G' OR 'F'))
  8262              MOVE AL-UANON      TO TYPEA
  8263              MOVE 'X'           TO UPDATE-SWITCH MSTR-SWITCH
  8264           ELSE
  8265              MOVE ER-0199       TO EMI-ERROR
  8266              PERFORM 9900-ERROR-FORMAT
  8267                                 THRU 9900-EXIT
  8268              MOVE AL-UABON      TO TYPEA
  8269              MOVE -1            TO TYPEL
  8270              MOVE 'X'           TO ERROR-SWITCH
  8271           END-IF
  8272        ELSE
  8273           MOVE AL-UANOF         TO TYPEA
  8274        END-IF
  8275     END-IF
  8276     IF STATUSI GREATER THAN LOW-VALUES
  8277         IF STATUSI = 'OPEN' OR 'CLOSED' OR 'O' OR 'C'
  8278             MOVE 'Y'            TO WS-OPEN-CLOSE-SW
  8279             MOVE AL-UANON       TO STATUSA
  8280             MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH TRLR-SWITCH
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 150
* EL131.cbl
  8281             MOVE 'Y'            TO DLYACTV-SW
  8282         ELSE
  8283             MOVE ER-0333        TO EMI-ERROR
  8284             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8285             MOVE AL-UABON       TO STATUSA
  8286             MOVE -1             TO STATUSL
  8287             MOVE 'X'            TO ERROR-SWITCH
  8288         END-IF
  8289     ELSE
  8290         MOVE SPACE              TO TRLR-SWITCH
  8291         MOVE 'N'                TO DLYACTV-SW
  8292         MOVE AL-UANOF           TO STATUSA.
  8293
  8294     IF PROCI GREATER THAN LOW-VALUES
  8295         PERFORM 1120-EDIT-PROC THRU 1120-EXIT
  8296     ELSE
  8297         MOVE AL-UANOF TO PROCA.
  8298
  8299     IF SEXI GREATER THAN LOW-VALUES
  8300         IF SEXI = 'F' OR 'M'
  8301             MOVE AL-UANON       TO SEXA
  8302             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8303           ELSE
  8304             MOVE ER-0219        TO EMI-ERROR
  8305             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8306             MOVE AL-UABON       TO SEXA
  8307             MOVE -1             TO SEXL
  8308             MOVE 'X'            TO ERROR-SWITCH
  8309       ELSE
  8310         MOVE AL-UANOF           TO SEXA.
  8311
  8312     IF BIRTHL = +0
  8313         MOVE LOW-VALUES         TO  HOLD-BIRTH
  8314         MOVE AL-UANOF           TO  BIRTHA
  8315         GO TO 1000-CONTINUE-EDITS.
  8316
  8317     IF BIRTHI = SPACES
  8318         MOVE LOW-VALUES         TO  HOLD-BIRTH
  8319         MOVE 'X'                TO  UPDATE-SWITCH
  8320                                     MSTR-SWITCH
  8321         GO TO 1000-CONTINUE-EDITS.
  8322
  8323     MOVE BIRTHI                 TO  DEEDIT-DATE-INPUT.
  8324     PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT.
  8325     MOVE DEEDIT-DATE            TO  DC-GREG-DATE-1-MDY.
  8326     MOVE '4'                    TO  DC-OPTION-CODE.
  8327     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  8328     IF DATE-CONVERSION-ERROR
  8329         MOVE ER-0220            TO  EMI-ERROR
  8330         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8331         MOVE AL-UABON           TO  BIRTHA
  8332         MOVE -1                 TO  BIRTHL
  8333         MOVE 'X'                TO  ERROR-SWITCH
  8334         GO TO 1000-CONTINUE-EDITS.
  8335
  8336******************************************************************
  8337**   IF CALCULATED BIRTH DATE IS GREATER THAN TODAYS DATE       **
  8338**   USE THE CENTURY ADJUSTMENT SWITCH IN THE DATE ROUTINE      **
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 151
* EL131.cbl
  8339**   TO SUBTRACT 100 YEARS TO OBTAIN THE CORRECT BIRTH DATE.    **
  8340******************************************************************
  8341     IF DC-BIN-DATE-1 IS GREATER THAN SAVE-BIN-DATE
  8342         MOVE BIRTHI             TO  DEEDIT-DATE-INPUT
  8343         PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT
  8344         MOVE DEEDIT-DATE        TO  DC-GREG-DATE-1-MDY
  8345         MOVE '4'                TO  DC-OPTION-CODE
  8346         MOVE '1'                TO  DC-CENTURY-ADJUSTMENT
  8347         MOVE +0                 TO  DC-ELAPSED-MONTHS
  8348                                     DC-ELAPSED-DAYS
  8349         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8350         IF DATE-CONVERSION-ERROR
  8351             MOVE ER-0220        TO  EMI-ERROR
  8352             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8353             MOVE AL-UABON       TO  BIRTHA
  8354             MOVE -1             TO  BIRTHL
  8355             MOVE 'X'            TO  ERROR-SWITCH
  8356             GO TO 1000-CONTINUE-EDITS.
  8357
  8358     MOVE AL-UANON               TO  BIRTHA.
  8359     MOVE 'X'                    TO  UPDATE-SWITCH
  8360                                     MSTR-SWITCH.
  8361     MOVE DC-GREG-DATE-1-EDIT    TO  BIRTHO.
  8362     MOVE DC-BIN-DATE-1          TO  HOLD-BIRTH.
  8363     MOVE ' '                    TO  DC-CENTURY-ADJUSTMENT.
  8364
  8365 1000-CONTINUE-EDITS.
  8366
  8367     IF SOCIALI GREATER THAN LOW-VALUES
  8368         MOVE SOCIALI TO WS-SOC-SEC-NUMBER
  8369         IF WS-SOC-SEC-NO NUMERIC AND
  8370           (WS-SOC-SEC-BLANK = SPACES OR LOW-VALUES)
  8371             NEXT SENTENCE
  8372         ELSE
  8373            IF WS-SSN-1-3 NUMERIC AND WS-SSN-4-5 NUMERIC AND
  8374               WS-SSN-6-9 NUMERIC AND WS-SSN-DASH1 = '-' AND
  8375               WS-SSN-DASH2 = '-'
  8376                 NEXT SENTENCE
  8377            ELSE
  8378                 MOVE ER-0887        TO  EMI-ERROR
  8379                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8380                 MOVE AL-UABON       TO  SOCIALA
  8381                 MOVE -1             TO  SOCIALL
  8382                 MOVE 'X'            TO  ERROR-SWITCH
  8383            END-IF
  8384        END-IF
  8385     END-IF.
  8386     if critpl > zeros
  8387        and critpi numeric
  8388        move al-uanon            to critpa
  8389        move 'X'                 to update-switch
  8390     end-if
  8391     IF SOCIALI GREATER THAN LOW-VALUES
  8392         MOVE AL-UANON           TO SOCIALA
  8393         MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH MSTR-KEY-SWITCH
  8394     ELSE
  8395         MOVE AL-UANOF           TO SOCIALA.
  8396
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 152
* EL131.cbl
  8397     IF OCCI GREATER THAN LOW-VALUES
  8398         MOVE AL-UANON           TO OCCA
  8399         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8400     ELSE
  8401         MOVE AL-UANOF           TO OCCA.
  8402
  8403     IF BENEL NOT GREATER THAN ZERO
  8404            GO TO 1005-CONTINUE-EDITS.
  8405
  8406     IF BENEI = SPACES
  8407        IF PI-AUTO-PAY-SEQ NOT = ZEROS
  8408           MOVE 'N'             TO AUTO-PAY-TO-BENE
  8409           PERFORM 2800-CHECK-AUTO-PAY THRU 2800-EXIT
  8410           IF AUTO-PAY-TO-BENE = 'Y'
  8411               MOVE ER-1773      TO  EMI-ERROR
  8412               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8413               MOVE 'X'          TO ERROR-SWITCH
  8414               MOVE AL-UABON     TO BENEA
  8415               MOVE -1           TO BENEL
  8416           ELSE
  8417               MOVE 'X'          TO UPDATE-SWITCH MSTR-SWITCH
  8418           END-IF
  8419        ELSE
  8420           PERFORM 1050-EDIT-BENE THRU 1050-EXIT
  8421           IF PAYMENT-PENDING
  8422               MOVE ER-1772      TO  EMI-ERROR
  8423               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8424               MOVE 'X'          TO ERROR-SWITCH
  8425               MOVE AL-UABON     TO BENEA
  8426               MOVE -1           TO BENEL
  8427           END-IF
  8428           MOVE 'X'              TO UPDATE-SWITCH MSTR-SWITCH
  8429        END-IF
  8430        GO TO 1005-CONTINUE-EDITS.
  8431
  8432
  8433* EXEC CICS HANDLE CONDITION
  8434*        NOTFND (1004-BENE-NOT-FOUND)
  8435*    END-EXEC.
  8436*    MOVE '"$I                   ! % #00008196' TO DFHEIV0
  8437     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8438     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8439     MOVE X'2520233030303038313936' TO DFHEIV0(25:11)
  8440     CALL 'kxdfhei1' USING DFHEIV0
  8441     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8442
  8443
  8444     MOVE PI-COMPANY-CD          TO  WS-ELBENE-COMPANY-CD.
  8445     MOVE 'B'                    TO  WS-ELBENE-RECORD-TYPE.
  8446     MOVE BENEI                  TO  WS-ELBENE-ID.
  8447
  8448
  8449* EXEC CICS READ
  8450*        DATASET ('ELBENE')
  8451*        RIDFLD  (WS-ELBENE-KEY)
  8452*        SET     (ADDRESS OF BENEFICIARY-MASTER)
  8453*    END-EXEC.
  8454     MOVE 'ELBENE' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 153
* EL131.cbl
  8455*    MOVE '&"S        E          (   #00008204' TO DFHEIV0
  8456     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8457     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8458     MOVE X'2020233030303038323034' TO DFHEIV0(25:11)
  8459     CALL 'kxdfhei1' USING DFHEIV0,
  8460           DFHEIV1,
  8461           DFHEIV20,
  8462           DFHEIV99,
  8463           WS-ELBENE-KEY,
  8464           DFHEIV99,
  8465           DFHEIV99,
  8466           DFHEIV99
  8467     SET ADDRESS OF BENEFICIARY-MASTER TO
  8468         DFHEIV20
  8469     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8470
  8471
  8472     MOVE AL-UANON               TO  BENEA.
  8473     MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH.
  8474
  8475     GO TO 1005-CONTINUE-EDITS.
  8476
  8477 1004-BENE-NOT-FOUND.
  8478     MOVE ER-0565                TO  EMI-ERROR.
  8479
  8480     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8481     MOVE 'X'                    TO ERROR-SWITCH.
  8482     MOVE AL-UABON               TO BENEA.
  8483     MOVE -1                     TO BENEL.
  8484
  8485 1005-CONTINUE-EDITS.
  8486
  8487     IF DIAGI GREATER THAN LOW-VALUES
  8488         MOVE AL-UANON           TO DIAGA
  8489         MOVE 'X'                TO UPDATE-SWITCH
  8490                                    NINETY-TRLR-SWITCH
  8491     ELSE
  8492         MOVE AL-UANOF           TO DIAGA.
  8493
  8494     IF ICD1I GREATER THAN LOW-VALUES
  8495         IF (ICD1I GREATER THAN SPACES) AND
  8496            (ICD1I(4:1) NOT = '.')
  8497             IF ICD1I(4:1) = ' '
  8498                 MOVE '.' TO ICD1I(4:1)
  8499             ELSE
  8500                 IF ICD1I(8:1) = ' '
  8501                     MOVE ICD1I(7:1) TO ICD1I(8:1)
  8502                     MOVE ICD1I(6:1) TO ICD1I(7:1)
  8503                     MOVE ICD1I(5:1) TO ICD1I(6:1)
  8504                     MOVE ICD1I(4:1) TO ICD1I(5:1)
  8505                     MOVE '.'        TO ICD1I(4:1)
  8506                 END-IF
  8507             END-IF
  8508         END-IF
  8509         IF (ICD1I GREATER THAN SPACES) AND
  8510            (ICD1I(1:1) NOT > ' ' OR
  8511             ICD1I(2:1) NOT > ' ' OR
  8512             ICD1I(3:1) NOT > ' ' OR
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 154
* EL131.cbl
  8513             ICD1I(4:1) NOT = '.')
  8514              MOVE ER-0992        TO  EMI-ERROR
  8515              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8516              MOVE 'X'            TO ERROR-SWITCH
  8517              MOVE AL-UABON       TO ICD1A
  8518              MOVE -1             TO ICD1L
  8519         ELSE
  8520             MOVE AL-UANON       TO ICD1A
  8521             MOVE 'X'            TO UPDATE-SWITCH
  8522                                    NINETY-TRLR-SWITCH
  8523         END-IF
  8524     ELSE
  8525         MOVE AL-UANOF           TO ICD1A
  8526     END-IF.
  8527
  8528     IF ICD2I GREATER THAN LOW-VALUES
  8529         IF (ICD2I GREATER THAN SPACES) AND
  8530            (ICD2I(4:1) NOT = '.')
  8531             IF ICD2I(4:1) = ' '
  8532                 MOVE '.' TO ICD2I(4:1)
  8533             ELSE
  8534                 IF ICD2I(8:1) = ' '
  8535                     MOVE ICD2I(7:1) TO ICD2I(8:1)
  8536                     MOVE ICD2I(6:1) TO ICD2I(7:1)
  8537                     MOVE ICD2I(5:1) TO ICD2I(6:1)
  8538                     MOVE ICD2I(4:1) TO ICD2I(5:1)
  8539                     MOVE '.'        TO ICD2I(4:1)
  8540                 END-IF
  8541             END-IF
  8542         END-IF
  8543         IF (ICD2I GREATER THAN SPACES) AND
  8544            (ICD2I(1:1) NOT > ' ' OR
  8545             ICD2I(2:1) NOT > ' ' OR
  8546             ICD2I(3:1) NOT > ' ' OR
  8547             ICD2I(4:1) NOT = '.')
  8548              MOVE ER-0992        TO EMI-ERROR
  8549              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8550              MOVE 'X'            TO ERROR-SWITCH
  8551              MOVE AL-UABON       TO ICD2A
  8552              MOVE -1             TO ICD2L
  8553         ELSE
  8554             MOVE AL-UANON       TO ICD2A
  8555             MOVE 'X'            TO UPDATE-SWITCH
  8556                                    NINETY-TRLR-SWITCH
  8557         END-IF
  8558     ELSE
  8559         MOVE AL-UANOF           TO ICD2A
  8560     END-IF.
  8561
  8562*    IF CAUSEI GREATER THAN LOW-VALUES
  8563*        MOVE AL-UANON           TO CAUSEA
  8564*        MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8565*    ELSE
  8566*        MOVE AL-UANOF           TO CAUSEA.
  8567
  8568*    IF ENDL GREATER THAN ZERO
  8569*        MOVE LOW-VALUES         TO HOLD-END
  8570*        IF ENDI = SPACES
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 155
* EL131.cbl
  8571*            MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8572*        ELSE
  8573*            MOVE ENDI           TO DEEDIT-DATE-INPUT
  8574*            EXEC CICS BIF DEEDIT
  8575*                FIELD    (DEEDIT-DATE-INPUT)
  8576*                LENGTH   (DATE-LENGTH)
  8577*            END-EXEC
  8578*            MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8579*            MOVE '4'            TO DC-OPTION-CODE
  8580*            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8581*            IF NOT DATE-CONVERSION-ERROR
  8582*                MOVE DC-BIN-DATE-1      TO HOLD-END
  8583*                MOVE AL-UANON   TO ENDA
  8584*                MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8585*                MOVE DC-GREG-DATE-1-EDIT TO ENDO
  8586*            ELSE
  8587*                MOVE ER-0224    TO EMI-ERROR
  8588*                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8589*                MOVE AL-UABON   TO ENDA
  8590*                MOVE -1         TO ENDL
  8591*                MOVE 'X'        TO ERROR-SWITCH
  8592*      ELSE
  8593*          MOVE AL-UANOF         TO ENDA.
  8594
  8595     IF INCL GREATER THAN ZERO
  8596         MOVE LOW-VALUES         TO HOLD-INCUR
  8597         IF INCI = SPACES
  8598             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8599         ELSE
  8600             MOVE INCI           TO DEEDIT-DATE-INPUT
  8601
  8602* EXEC CICS BIF DEEDIT
  8603*                FIELD    (DEEDIT-DATE-INPUT)
  8604*                LENGTH   (DATE-LENGTH)
  8605*            END-EXEC
  8606*    MOVE '@"L                   #   #00008339' TO DFHEIV0
  8607     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8608     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8609     MOVE X'2020233030303038333339' TO DFHEIV0(25:11)
  8610     CALL 'kxdfhei1' USING DFHEIV0,
  8611           DEEDIT-DATE-INPUT,
  8612           DATE-LENGTH
  8613     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8614             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8615             MOVE '4'            TO DC-OPTION-CODE
  8616             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8617             IF NOT DATE-CONVERSION-ERROR
  8618                 MOVE DC-BIN-DATE-1      TO HOLD-INCUR
  8619                 MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8620                 MOVE AL-UANON           TO INCA
  8621                 MOVE DC-GREG-DATE-1-EDIT TO INCO
  8622             ELSE
  8623                 MOVE ER-0222    TO EMI-ERROR
  8624                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8625                 MOVE AL-UABON   TO INCA
  8626                 MOVE -1         TO INCL
  8627                 MOVE 'X'        TO ERROR-SWITCH
  8628       ELSE
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 156
* EL131.cbl
  8629           IF PI-NO-PMTS = ZEROS
  8630               MOVE AL-UANOF     TO INCA.
  8631
  8632     IF REPL GREATER THAN ZERO
  8633         MOVE LOW-VALUES         TO HOLD-REPORTED
  8634         IF REPI = SPACES
  8635             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8636         ELSE
  8637             MOVE REPI           TO DEEDIT-DATE-INPUT
  8638
  8639* EXEC CICS BIF DEEDIT
  8640*                FIELD    (DEEDIT-DATE-INPUT)
  8641*                LENGTH   (DATE-LENGTH)
  8642*            END-EXEC
  8643*    MOVE '@"L                   #   #00008367' TO DFHEIV0
  8644     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8645     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8646     MOVE X'2020233030303038333637' TO DFHEIV0(25:11)
  8647     CALL 'kxdfhei1' USING DFHEIV0,
  8648           DEEDIT-DATE-INPUT,
  8649           DATE-LENGTH
  8650     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8651             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8652             MOVE '4'            TO DC-OPTION-CODE
  8653             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8654             IF NOT DATE-CONVERSION-ERROR
  8655                 MOVE DC-BIN-DATE-1      TO HOLD-REPORTED
  8656                 MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8657                 MOVE AL-UANON   TO REPA
  8658                 MOVE DC-GREG-DATE-1-EDIT TO REPO
  8659             ELSE
  8660                 MOVE ER-0223    TO EMI-ERROR
  8661                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8662                 MOVE AL-UABON   TO REPA
  8663                 MOVE -1         TO REPL
  8664                 MOVE 'X'        TO ERROR-SWITCH
  8665       ELSE
  8666         MOVE AL-UANOF TO REPA.
  8667
  8668     IF PDTHRUI GREATER THAN LOW-VALUES
  8669        MOVE LOW-VALUES         TO HOLD-PDTHRU
  8670        IF PDTHRUI = SPACES
  8671           MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8672        ELSE
  8673           MOVE PDTHRUI        TO DEEDIT-DATE-INPUT
  8674
  8675* EXEC CICS BIF DEEDIT
  8676*               FIELD    (DEEDIT-DATE-INPUT)
  8677*               LENGTH   (DATE-LENGTH)
  8678*          END-EXEC
  8679*    MOVE '@"L                   #   #00008394' TO DFHEIV0
  8680     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8681     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8682     MOVE X'2020233030303038333934' TO DFHEIV0(25:11)
  8683     CALL 'kxdfhei1' USING DFHEIV0,
  8684           DEEDIT-DATE-INPUT,
  8685           DATE-LENGTH
  8686     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 157
* EL131.cbl
  8687           MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8688           MOVE '4'            TO DC-OPTION-CODE
  8689           PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8690           IF NOT DATE-CONVERSION-ERROR
  8691              MOVE DC-BIN-DATE-1      TO HOLD-PDTHRU
  8692              MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8693              MOVE AL-UANON   TO PDTHRUA
  8694              MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
  8695              IF PI-USES-PAID-TO
  8696                 MOVE '6'            TO DC-OPTION-CODE
  8697                 MOVE -1             TO DC-ELAPSED-DAYS
  8698                 MOVE +0             TO DC-ELAPSED-MONTHS
  8699                 PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8700                 IF NO-CONVERSION-ERROR
  8701                    MOVE DC-BIN-DATE-2 TO HOLD-PDTHRU
  8702                 ELSE
  8703                    NEXT SENTENCE
  8704              ELSE
  8705                 NEXT SENTENCE
  8706           ELSE
  8707              MOVE ER-0475    TO EMI-ERROR
  8708              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8709              MOVE AL-UABON   TO PDTHRUA
  8710              MOVE -1         TO PDTHRUL
  8711              MOVE 'X'        TO ERROR-SWITCH
  8712     ELSE
  8713        IF MODIFY-CAP
  8714           MOVE AL-UANOF        TO PDTHRUA.
  8715
  8716     IF PDAMTL GREATER THAN +0
  8717         MOVE ZEROS              TO HOLD-PDAMT
  8718
  8719* EXEC CICS BIF DEEDIT
  8720*            FIELD    (PDAMTI)
  8721*            LENGTH   (9)
  8722*        END-EXEC
  8723     MOVE 9
  8724       TO DFHEIV11
  8725*    MOVE '@"L                   #   #00008429' TO DFHEIV0
  8726     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8727     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8728     MOVE X'2020233030303038343239' TO DFHEIV0(25:11)
  8729     CALL 'kxdfhei1' USING DFHEIV0,
  8730           PDAMTI,
  8731           DFHEIV11
  8732     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8733         IF PDAMTI NUMERIC
  8734             MOVE PDAMTI         TO HOLD-PDAMT PDAMTO
  8735             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8736             MOVE AL-UNNON       TO PDAMTA
  8737         ELSE
  8738             MOVE ER-0547        TO EMI-ERROR
  8739             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8740             MOVE AL-UNBON       TO PDAMTA
  8741             MOVE -1             TO PDAMTL
  8742             MOVE 'X'            TO ERROR-SWITCH
  8743     ELSE
  8744         IF MODIFY-CAP
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 158
* EL131.cbl
  8745            MOVE AL-UNNOF        TO PDAMTA.
  8746
  8747     IF NODAYSI GREATER THAN LOW-VALUES
  8748         MOVE ZEROS              TO HOLD-NODAYS
  8749
  8750* EXEC CICS BIF DEEDIT
  8751*            FIELD (NODAYSI)
  8752*            LENGTH (5)
  8753*        END-EXEC
  8754     MOVE 5
  8755       TO DFHEIV11
  8756*    MOVE '@"L                   #   #00008449' TO DFHEIV0
  8757     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8758     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8759     MOVE X'2020233030303038343439' TO DFHEIV0(25:11)
  8760     CALL 'kxdfhei1' USING DFHEIV0,
  8761           NODAYSI,
  8762           DFHEIV11
  8763     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8764         IF NODAYSI NUMERIC
  8765             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8766             MOVE AL-UNNON       TO NODAYSA
  8767             MOVE NODAYSI        TO  HOLD-NODAYS  NODAYSO
  8768         ELSE
  8769             MOVE ER-0491        TO EMI-ERROR
  8770             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8771             MOVE AL-UNBON       TO NODAYSA
  8772             MOVE -1             TO NODAYSL
  8773             MOVE 'X'            TO ERROR-SWITCH
  8774     ELSE
  8775         IF MODIFY-CAP
  8776            MOVE AL-UNNOF        TO NODAYSA.
  8777
  8778     IF NOPMTSI GREATER THAN LOW-VALUES
  8779         MOVE ZEROS              TO HOLD-NOPMTS
  8780
  8781* EXEC CICS BIF DEEDIT
  8782*            FIELD (NOPMTSI)
  8783*            LENGTH (4)
  8784*        END-EXEC
  8785     MOVE 4
  8786       TO DFHEIV11
  8787*    MOVE '@"L                   #   #00008469' TO DFHEIV0
  8788     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8789     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8790     MOVE X'2020233030303038343639' TO DFHEIV0(25:11)
  8791     CALL 'kxdfhei1' USING DFHEIV0,
  8792           NOPMTSI,
  8793           DFHEIV11
  8794     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8795         IF NOPMTSI NUMERIC
  8796             MOVE NOPMTSI        TO HOLD-NOPMTS  NOPMTSO
  8797             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8798             MOVE AL-UNNON       TO NOPMTSA
  8799           ELSE
  8800             MOVE ER-0548        TO EMI-ERROR
  8801             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8802             MOVE AL-UNBON       TO NOPMTSA
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 159
* EL131.cbl
  8803             MOVE -1             TO NOPMTSL
  8804             MOVE 'X'            TO ERROR-SWITCH
  8805       ELSE
  8806         IF MODIFY-CAP
  8807            MOVE AL-UNNOF        TO NOPMTSA.
  8808
  8809     IF FORMTYPI GREATER THAN LOW-VALUES
  8810         IF FORMTYPI = ' ' OR 'L' OR 'S'
  8811             MOVE AL-UANON       TO FORMTYPA
  8812             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8813           ELSE
  8814             MOVE ER-7650        TO EMI-ERROR
  8815             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8816             MOVE AL-UABON       TO FORMTYPA
  8817             MOVE -1             TO FORMTYPL
  8818             MOVE 'X'            TO ERROR-SWITCH
  8819       ELSE
  8820         MOVE AL-UANOF           TO FORMTYPA.
  8821
  8822     IF PRICDL GREATER THAN ZERO
  8823         IF (PRICDI = ' ') OR
  8824            (PRICDI GREATER THAN ZERO   AND
  8825             PRICDI NOT GREATER THAN '9')
  8826             MOVE AL-UANON       TO PRICDA
  8827             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8828         ELSE
  8829             MOVE ER-0274        TO EMI-ERROR
  8830             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8831             MOVE AL-UABON       TO PRICDA
  8832             MOVE -1             TO PRICDL
  8833             MOVE 'X'            TO ERROR-SWITCH
  8834     ELSE
  8835         MOVE AL-UANOF TO PRICDA.
  8836
  8837     IF PI-COMPANY-ID = 'DMD'
  8838     IF PRICDL GREATER THAN ZERO
  8839       IF SYSTEM-MODIFY-CAP  OR
  8840          PI-PROCESSOR-ID = 'LGXX'
  8841             NEXT SENTENCE
  8842           ELSE
  8843            IF CL-PRIORITY-CD = '9'  OR
  8844               PRICDI         = '9'
  8845                  MOVE ER-0938        TO EMI-ERROR
  8846                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8847                  MOVE AL-UABON       TO PRICDA
  8848                  MOVE -1             TO PRICDL
  8849                  MOVE 'X'            TO ERROR-SWITCH.
  8850
  8851     IF FILETOL GREATER THAN ZERO
  8852         MOVE AL-UANON           TO FILETOA
  8853         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8854     ELSE
  8855         MOVE AL-UANOF TO FILETOA.
  8856
  8857     IF SUPVL GREATER THAN ZERO
  8858         IF SUPVI = 'Y' OR 'N' OR SPACE
  8859             MOVE AL-UANON       TO SUPVA
  8860             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 160
* EL131.cbl
  8861         ELSE
  8862             MOVE ER-0230        TO EMI-ERROR
  8863             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8864             MOVE AL-UABON       TO SUPVA
  8865             MOVE -1             TO SUPVL
  8866             MOVE 'X'            TO ERROR-SWITCH
  8867     ELSE
  8868         MOVE AL-UANOF           TO SUPVA.
  8869
  8870     IF MLNAMEL GREATER THAN ZERO
  8871         IF MLNAMEI GREATER THAN SPACES
  8872            MOVE AL-UANON        TO MLNAMEA
  8873            MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH
  8874                                     MSTR-KEY-SWITCH
  8875         ELSE
  8876            MOVE ER-0236         TO EMI-ERROR
  8877            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8878            MOVE AL-UABON        TO MLNAMEA
  8879            MOVE -1              TO MLNAMEL
  8880            MOVE 'X'             TO ERROR-SWITCH
  8881     ELSE
  8882         MOVE AL-UANOF           TO MLNAMEA.
  8883
  8884     IF MFNAMEI GREATER THAN LOW-VALUES
  8885         MOVE AL-UANON           TO MFNAMEA
  8886         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8887     ELSE
  8888         MOVE AL-UANOF           TO MFNAMEA.
  8889
  8890     IF MMINITI GREATER THAN LOW-VALUES
  8891         MOVE AL-UANON           TO MMINITA
  8892         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8893     ELSE
  8894         MOVE AL-UANOF           TO MMINITA.
  8895
  8896     IF CRTLNMEI GREATER THAN LOW-VALUES
  8897         IF CRTLNMEI NOT = SPACES
  8898            MOVE AL-UANON        TO CRTLNMEA
  8899            MOVE 'X'             TO  UPDATE-SWITCH CERT-SWITCH
  8900                                     CERT-KEY-SWITCH
  8901        ELSE
  8902            MOVE ER-0236         TO EMI-ERROR
  8903            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8904            MOVE AL-UABON        TO CRTLNMEA
  8905            MOVE -1              TO CRTLNMEL
  8906            MOVE 'X'             TO ERROR-SWITCH
  8907     ELSE
  8908         MOVE AL-UANOF           TO CRTLNMEA.
  8909
  8910     IF CRTFNMEI GREATER THAN LOW-VALUES
  8911         MOVE AL-UANON           TO CRTFNMEA
  8912         MOVE 'X'                TO UPDATE-SWITCH CERT-SWITCH
  8913     ELSE
  8914         MOVE AL-UANOF           TO CRTFNMEA.
  8915
  8916     IF CRTINITI GREATER THAN LOW-VALUES
  8917         MOVE AL-UANON           TO CRTINITA
  8918         MOVE 'X' TO UPDATE-SWITCH CERT-SWITCH CERT-KEY-SWITCH
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 161
* EL131.cbl
  8919     ELSE
  8920         MOVE AL-UANOF           TO CRTINITA.
  8921
  8922     IF ISSAGEL GREATER THAN ZERO
  8923         IF ISSAGEI NUMERIC
  8924            MOVE AL-UANON        TO ISSAGEA
  8925            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  8926         ELSE
  8927            MOVE ER-0237         TO EMI-ERROR
  8928            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8929            MOVE AL-UABON        TO ISSAGEA
  8930            MOVE -1              TO ISSAGEL
  8931            MOVE 'X'             TO ERROR-SWITCH
  8932     ELSE
  8933         MOVE AL-UANOF           TO ISSAGEA.
  8934
  8935     IF JNTFNMEI GREATER THAN LOW-VALUES
  8936         MOVE AL-UANON           TO JNTFNMEA
  8937         MOVE 'X'                TO UPDATE-SWITCH CERT-SWITCH
  8938     ELSE
  8939         MOVE AL-UANOF           TO JNTFNMEA.
  8940
  8941     IF JNTLNMEI GREATER THAN LOW-VALUES
  8942         MOVE AL-UANON           TO JNTLNMEA
  8943         MOVE 'X'                TO UPDATE-SWITCH CERT-SWITCH
  8944     ELSE
  8945         MOVE AL-UANOF           TO JNTLNMEA.
  8946
  8947     IF JNTINITI GREATER THAN LOW-VALUES
  8948         MOVE AL-UANON           TO JNTINITA
  8949         MOVE 'X'                TO UPDATE-SWITCH CERT-SWITCH
  8950     ELSE
  8951         MOVE AL-UANOF           TO JNTINITA.
  8952
  8953     IF JNTAGEL GREATER THAN ZERO
  8954         IF JNTAGEI NUMERIC
  8955            MOVE AL-UANON        TO JNTAGEA
  8956            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  8957         ELSE
  8958            MOVE ER-0238         TO EMI-ERROR
  8959            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8960            MOVE AL-UABON        TO JNTAGEA
  8961            MOVE -1              TO JNTAGEL
  8962            MOVE 'X'             TO ERROR-SWITCH
  8963     ELSE
  8964         MOVE AL-UANOF           TO JNTAGEA.
  8965
  8966     IF ADDONDTI GREATER THAN LOW-VALUES
  8967         MOVE LOW-VALUES         TO HOLD-ADDON
  8968         IF ADDONDTI = SPACES
  8969             MOVE 'X'  TO UPDATE-SWITCH MSTR-SWITCH CERT-SWITCH
  8970         ELSE
  8971             MOVE ADDONDTI       TO DEEDIT-DATE-INPUT
  8972
  8973* EXEC CICS BIF DEEDIT
  8974*                FIELD    (DEEDIT-DATE-INPUT)
  8975*                LENGTH   (DATE-LENGTH)
  8976*            END-EXEC
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 162
* EL131.cbl
  8977*    MOVE '@"L                   #   #00008650' TO DFHEIV0
  8978     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8979     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8980     MOVE X'2020233030303038363530' TO DFHEIV0(25:11)
  8981     CALL 'kxdfhei1' USING DFHEIV0,
  8982           DEEDIT-DATE-INPUT,
  8983           DATE-LENGTH
  8984     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8985             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8986             MOVE '4'            TO DC-OPTION-CODE
  8987             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8988             IF NOT DATE-CONVERSION-ERROR
  8989                 MOVE DC-BIN-DATE-1      TO HOLD-ADDON
  8990                 MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8991                                                  CERT-SWITCH
  8992                 MOVE AL-UANON   TO ADDONDTA
  8993                 MOVE DC-GREG-DATE-1-EDIT TO ADDONDTO
  8994             ELSE
  8995                 MOVE ER-7651    TO EMI-ERROR
  8996                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8997                 MOVE AL-UABON   TO ADDONDTA
  8998                 MOVE -1         TO ADDONDTL
  8999                 MOVE 'X'        TO ERROR-SWITCH
  9000       ELSE
  9001         MOVE AL-UANOF TO ADDONDTA.
  9002
  9003     IF LCVCDI GREATER THAN LOW-VALUES
  9004         MOVE LCVCDI             TO WS-EDIT-BEN-CODE
  9005         PERFORM 1240-EDIT-LIFE-CODE THRU 1240-EXIT
  9006     ELSE
  9007         MOVE AL-UANOF           TO LCVCDA.
  9008
  9009     IF ACVCDI GREATER THAN LOW-VALUES
  9010         MOVE ACVCDI             TO WS-EDIT-BEN-CODE
  9011         PERFORM 1310-EDIT-AH-CODE THRU 1310-EXIT
  9012     ELSE
  9013         MOVE AL-UANOF           TO ACVCDA.
  9014
  9015     IF LCVOTRMI GREATER THAN LOW-VALUES
  9016
  9017* EXEC CICS BIF DEEDIT
  9018*            FIELD (LCVOTRMI)
  9019*            LENGTH(3)
  9020*        END-EXEC
  9021     MOVE 3
  9022       TO DFHEIV11
  9023*    MOVE '@"L                   #   #00008685' TO DFHEIV0
  9024     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9025     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9026     MOVE X'2020233030303038363835' TO DFHEIV0(25:11)
  9027     CALL 'kxdfhei1' USING DFHEIV0,
  9028           LCVOTRMI,
  9029           DFHEIV11
  9030     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9031         IF LCVOTRMI IS NUMERIC
  9032             MOVE LCVOTRMI       TO LCVOTRMO
  9033             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  9034             MOVE AL-UANON       TO LCVOTRMA
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 163
* EL131.cbl
  9035         ELSE
  9036             MOVE ER-0241        TO EMI-ERROR
  9037             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9038             MOVE AL-UNBON       TO LCVOTRMA
  9039             MOVE 'X'            TO ERROR-SWITCH
  9040             MOVE -1             TO LCVOTRML
  9041     ELSE
  9042         MOVE AL-UANOF           TO LCVOTRMA.
  9043
  9044     IF ACVOTRMI GREATER THAN LOW-VALUES
  9045
  9046* EXEC CICS BIF DEEDIT
  9047*            FIELD (ACVOTRMI)
  9048*            LENGTH(3)
  9049*        END-EXEC
  9050     MOVE 3
  9051       TO DFHEIV11
  9052*    MOVE '@"L                   #   #00008703' TO DFHEIV0
  9053     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9054     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9055     MOVE X'2020233030303038373033' TO DFHEIV0(25:11)
  9056     CALL 'kxdfhei1' USING DFHEIV0,
  9057           ACVOTRMI,
  9058           DFHEIV11
  9059     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9060         IF ACVOTRMI IS NUMERIC
  9061             MOVE ACVOTRMI       TO ACVOTRMO
  9062             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  9063             MOVE AL-UANON       TO ACVOTRMA
  9064         ELSE
  9065             MOVE ER-0241        TO EMI-ERROR
  9066             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9067             MOVE AL-UNBON       TO ACVOTRMA
  9068             MOVE 'X'            TO ERROR-SWITCH
  9069             MOVE -1             TO ACVOTRML
  9070     ELSE
  9071         MOVE AL-UANOF           TO ACVOTRMA.
  9072
  9073     IF LCVRATEL GREATER THAN +0
  9074
  9075* EXEC CICS BIF DEEDIT
  9076*            FIELD (LCVRATEI)
  9077*            LENGTH(6)
  9078*        END-EXEC
  9079     MOVE 6
  9080       TO DFHEIV11
  9081*    MOVE '@"L                   #   #00008721' TO DFHEIV0
  9082     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9083     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9084     MOVE X'2020233030303038373231' TO DFHEIV0(25:11)
  9085     CALL 'kxdfhei1' USING DFHEIV0,
  9086           LCVRATEI,
  9087           DFHEIV11
  9088     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9089         IF LCVRATEI IS NUMERIC
  9090             MOVE LCVRATEI       TO HOLD-LF-RATE  LCVRATEO
  9091             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  9092             MOVE AL-UNNON       TO LCVRATEA
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 164
* EL131.cbl
  9093         ELSE
  9094             MOVE ER-2280        TO EMI-ERROR
  9095             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9096             MOVE AL-UNBON       TO LCVRATEA
  9097             MOVE 'X'            TO ERROR-SWITCH
  9098             MOVE -1             TO LCVRATEL
  9099     ELSE
  9100         MOVE AL-UNNOF           TO LCVRATEA.
  9101
  9102     IF ACVRATEL GREATER THAN +0
  9103
  9104* EXEC CICS BIF DEEDIT
  9105*            FIELD (ACVRATEI)
  9106*            LENGTH(6)
  9107*        END-EXEC
  9108     MOVE 6
  9109       TO DFHEIV11
  9110*    MOVE '@"L                   #   #00008739' TO DFHEIV0
  9111     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9112     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9113     MOVE X'2020233030303038373339' TO DFHEIV0(25:11)
  9114     CALL 'kxdfhei1' USING DFHEIV0,
  9115           ACVRATEI,
  9116           DFHEIV11
  9117     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9118         IF ACVRATEI IS NUMERIC
  9119             MOVE ACVRATEI       TO HOLD-AH-RATE  ACVRATEO
  9120             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  9121             MOVE AL-UNNON       TO ACVRATEA
  9122         ELSE
  9123             MOVE ER-2280        TO EMI-ERROR
  9124             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9125             MOVE AL-UNBON       TO ACVRATEA
  9126             MOVE 'X'            TO ERROR-SWITCH
  9127             MOVE -1             TO ACVRATEL
  9128     ELSE
  9129         MOVE AL-UNNOF           TO ACVRATEA.
  9130
  9131     IF LCVBENEL GREATER THAN ZERO
  9132
  9133* EXEC CICS BIF DEEDIT
  9134*            FIELD (LCVBENEI)
  9135*            LENGTH (11)
  9136*        END-EXEC
  9137     MOVE 11
  9138       TO DFHEIV11
  9139*    MOVE '@"L                   #   #00008757' TO DFHEIV0
  9140     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9141     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9142     MOVE X'2020233030303038373537' TO DFHEIV0(25:11)
  9143     CALL 'kxdfhei1' USING DFHEIV0,
  9144           LCVBENEI,
  9145           DFHEIV11
  9146     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9147         IF LCVBENEI IS NUMERIC
  9148            MOVE LCVBENEI        TO HOLD-LF-CV-BEN  LCVBENEO
  9149            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  9150            MOVE AL-UNNON        TO LCVBENEA
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 165
* EL131.cbl
  9151         ELSE
  9152            MOVE ER-0243         TO EMI-ERROR
  9153            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9154            MOVE AL-UNBON        TO LCVBENEA
  9155            MOVE -1              TO LCVBENEL
  9156            MOVE 'X'             TO ERROR-SWITCH
  9157     ELSE
  9158         MOVE AL-UANOF           TO LCVBENEA.
  9159
  9160     IF ACVBENEL GREATER THAN ZERO
  9161
  9162* EXEC CICS BIF DEEDIT
  9163*            FIELD (ACVBENEI)
  9164*            LENGTH (11)
  9165*        END-EXEC
  9166     MOVE 11
  9167       TO DFHEIV11
  9168*    MOVE '@"L                   #   #00008775' TO DFHEIV0
  9169     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9170     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9171     MOVE X'2020233030303038373735' TO DFHEIV0(25:11)
  9172     CALL 'kxdfhei1' USING DFHEIV0,
  9173           ACVBENEI,
  9174           DFHEIV11
  9175     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9176         IF ACVBENEI IS NUMERIC
  9177            MOVE ACVBENEI        TO HOLD-AH-CV-BEN  ACVBENEO
  9178            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  9179            MOVE AL-UNNON        TO ACVBENEA
  9180         ELSE
  9181            MOVE ER-0243         TO EMI-ERROR
  9182            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9183            MOVE AL-UNBON        TO ACVBENEA
  9184            MOVE -1              TO ACVBENEL
  9185            MOVE 'X'             TO ERROR-SWITCH
  9186     ELSE
  9187         MOVE AL-UANOF           TO ACVBENEA.
  9188
  9189     IF LCVFORMI GREATER THAN LOW-VALUES
  9190        MOVE 'X'                 TO UPDATE-SWITCH CERT-SWITCH
  9191        MOVE AL-UANON            TO LCVFORMA
  9192     ELSE
  9193        MOVE AL-UANOF            TO LCVFORMA.
  9194
  9195     IF ACVFORMI GREATER THAN LOW-VALUES
  9196        MOVE 'X'                 TO UPDATE-SWITCH CERT-SWITCH
  9197        MOVE AL-UANON            TO ACVFORMA
  9198     ELSE
  9199        MOVE AL-UANOF            TO ACVFORMA.
  9200
  9201     IF LCVCNDTL GREATER THAN ZERO
  9202         MOVE LOW-VALUES         TO HOLD-LF-CV-CAN
  9203         IF LCVCNDTI = SPACES
  9204             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  9205         ELSE
  9206             MOVE LCVCNDTI       TO DEEDIT-DATE-INPUT
  9207             PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT
  9208             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 166
* EL131.cbl
  9209             MOVE '4'            TO DC-OPTION-CODE
  9210             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  9211             IF NOT DATE-CONVERSION-ERROR
  9212                 MOVE DC-BIN-DATE-1      TO HOLD-LF-CV-CAN
  9213                 MOVE AL-UANON   TO LCVCNDTA
  9214                 MOVE 'X'        TO UPDATE-SWITCH CERT-SWITCH
  9215                 MOVE DC-GREG-DATE-1-EDIT TO LCVCNDTO
  9216             ELSE
  9217                 MOVE ER-0246    TO EMI-ERROR
  9218                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9219                 MOVE AL-UABON   TO LCVCNDTA
  9220                 MOVE -1         TO LCVCNDTL
  9221                 MOVE 'X'        TO ERROR-SWITCH
  9222     ELSE
  9223         MOVE LOW-VALUES         TO HOLD-LF-CV-CAN
  9224         MOVE AL-UANOF           TO LCVCNDTA.
  9225
  9226     IF ACVCNDTL GREATER THAN ZERO
  9227         MOVE LOW-VALUES         TO HOLD-AH-CV-CAN
  9228         IF ACVCNDTI = SPACES
  9229             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  9230         ELSE
  9231             MOVE ACVCNDTI       TO DEEDIT-DATE-INPUT
  9232             PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT
  9233             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  9234             MOVE '4'            TO DC-OPTION-CODE
  9235             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  9236             IF NOT DATE-CONVERSION-ERROR
  9237                 MOVE DC-BIN-DATE-1      TO HOLD-AH-CV-CAN
  9238                 MOVE AL-UANON   TO ACVCNDTA
  9239                 MOVE 'X'        TO UPDATE-SWITCH CERT-SWITCH
  9240                 MOVE DC-GREG-DATE-1-EDIT TO ACVCNDTO
  9241             ELSE
  9242                 MOVE ER-0246    TO EMI-ERROR
  9243                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9244                 MOVE AL-UABON   TO ACVCNDTA
  9245                 MOVE -1         TO ACVCNDTL
  9246                 MOVE 'X'        TO ERROR-SWITCH
  9247     ELSE
  9248         MOVE LOW-VALUES         TO HOLD-AH-CV-CAN
  9249         MOVE AL-UANOF           TO ACVCNDTA.
  9250
  9251     IF APRL GREATER THAN +0
  9252
  9253* EXEC CICS BIF DEEDIT
  9254*            FIELD    (APRI)
  9255*            LENGTH   (8)
  9256*        END-EXEC
  9257     MOVE 8
  9258       TO DFHEIV11
  9259*    MOVE '@"L                   #   #00008855' TO DFHEIV0
  9260     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9261     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9262     MOVE X'2020233030303038383535' TO DFHEIV0(25:11)
  9263     CALL 'kxdfhei1' USING DFHEIV0,
  9264           APRI,
  9265           DFHEIV11
  9266     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 167
* EL131.cbl
  9267         IF APRI NUMERIC
  9268            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  9269            MOVE APRI            TO HOLD-APR APRO
  9270            MOVE AL-UANON        TO APRA
  9271          ELSE
  9272            MOVE ER-0259         TO EMI-ERROR
  9273            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9274            MOVE AL-UABON        TO APRA
  9275            MOVE -1              TO APRL
  9276            MOVE 'X'             TO ERROR-SWITCH
  9277     ELSE
  9278         MOVE AL-UANOF           TO APRA.
  9279
  9280     IF PMTFREQL GREATER THAN ZERO
  9281
  9282* EXEC CICS BIF DEEDIT
  9283*            FIELD    (PMTFREQI)
  9284*            LENGTH   (2)
  9285*        END-EXEC
  9286     MOVE 2
  9287       TO DFHEIV11
  9288*    MOVE '@"L                   #   #00008873' TO DFHEIV0
  9289     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9290     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9291     MOVE X'2020233030303038383733' TO DFHEIV0(25:11)
  9292     CALL 'kxdfhei1' USING DFHEIV0,
  9293           PMTFREQI,
  9294           DFHEIV11
  9295     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9296         IF PMTFREQI NUMERIC
  9297            MOVE PMTFREQI        TO  HOLD-FREQ PMTFREQO
  9298            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  9299            MOVE AL-UANON        TO PMTFREQA
  9300          ELSE
  9301            MOVE ER-0427         TO EMI-ERROR
  9302            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9303            MOVE AL-UABON        TO PMTFREQA
  9304            MOVE -1              TO PMTFREQL
  9305            MOVE 'X'             TO ERROR-SWITCH
  9306     ELSE
  9307         MOVE AL-UANOF           TO PMTFREQA.
  9308
  9309     IF INDGRPL GREATER THAN ZERO
  9310         IF INDGRPI = 'I' OR 'G' OR SPACE
  9311             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  9312             MOVE AL-UANON       TO INDGRPA
  9313          ELSE
  9314             MOVE ER-0260        TO EMI-ERROR
  9315             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9316             MOVE AL-UABON       TO INDGRPA
  9317             MOVE -1             TO INDGRPL
  9318             MOVE 'X'            TO ERROR-SWITCH
  9319     ELSE
  9320         MOVE AL-UANOF           TO INDGRPA.
  9321
  9322     IF PREMTYPL GREATER THAN ZERO
  9323         IF PREMTYPI = '1' OR '2' OR '3'
  9324            MOVE PREMTYPI        TO PI-PREM-TYPE
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 168
* EL131.cbl
  9325            MOVE AL-UNNON        TO PREMTYPA
  9326            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  9327          ELSE
  9328            MOVE ER-0227         TO EMI-ERROR
  9329            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9330            MOVE AL-UNBON        TO PREMTYPA
  9331            MOVE -1              TO PREMTYPL
  9332            MOVE 'X'             TO ERROR-SWITCH
  9333     ELSE
  9334         MOVE AL-UANOF           TO PREMTYPA.
  9335
  9336     IF LOANBALL GREATER THAN ZERO
  9337
  9338* EXEC CICS BIF DEEDIT
  9339*             FIELD    (LOANBALI)
  9340*             LENGTH   (9)
  9341*        END-EXEC
  9342     MOVE 9
  9343       TO DFHEIV11
  9344*    MOVE '@"L                   #   #00008918' TO DFHEIV0
  9345     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9346     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9347     MOVE X'2020233030303038393138' TO DFHEIV0(25:11)
  9348     CALL 'kxdfhei1' USING DFHEIV0,
  9349           LOANBALI,
  9350           DFHEIV11
  9351     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9352         IF LOANBALI NUMERIC
  9353             MOVE LOANBALI       TO  HOLD-LOANBAL LOANBALO
  9354             MOVE 'X' TO UPDATE-SWITCH CERT-SWITCH MSTR-SWITCH
  9355             MOVE AL-UNNON TO LOANBALA
  9356         ELSE
  9357             MOVE ER-0639        TO EMI-ERROR
  9358             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9359             MOVE AL-UNBON       TO LOANBALA
  9360             MOVE -1             TO LOANBALL
  9361             MOVE 'X'            TO ERROR-SWITCH
  9362     ELSE
  9363         MOVE AL-UNNOF           TO LOANBALA.
  9364
  9365*    IF LOANNOL GREATER THAN ZERO
  9366*          MOVE 'X'                 TO UPDATE-SWITCH CERT-SWITCH
  9367*          MOVE AL-UANON            TO LOANNOA
  9368*       ELSE
  9369*          MOVE AL-UANOF            TO LOANNOA.
  9370
  9371     IF REINCDI GREATER THAN LOW-VALUES
  9372        MOVE 'X'                 TO UPDATE-SWITCH CERT-SWITCH
  9373        MOVE AL-UANON            TO REINCDA
  9374     ELSE
  9375        MOVE AL-UANOF            TO REINCDA.
  9376
  9377     IF CERTI GREATER THAN LOW-VALUES
  9378         PERFORM 1460-EDIT-CERT-NO THRU 1460-EXIT
  9379     ELSE
  9380         MOVE AL-UANOF           TO CERTA.
  9381
  9382     IF CERTEFFI GREATER THAN LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 169
* EL131.cbl
  9383         PERFORM 1470-EDIT-EFF THRU 1470-EXIT
  9384     ELSE
  9385         MOVE AL-UANOF           TO CERTEFFA.
  9386
  9387     IF CERTACTI GREATER THAN LOW-VALUES
  9388         PERFORM 1480-EDIT-ACCT THRU 1480-EXIT
  9389     ELSE
  9390         MOVE AL-UANOF           TO CERTACTA.
  9391
  9392     IF CERTSTI GREATER THAN LOW-VALUES
  9393         PERFORM 1490-EDIT-STATE THRU 1490-EXIT
  9394     ELSE
  9395         MOVE AL-UANOF           TO CERTSTA.
  9396
  9397     IF CERTCARI GREATER THAN LOW-VALUES
  9398         PERFORM 1500-EDIT-CARR THRU 1500-EXIT
  9399     ELSE
  9400         MOVE AL-UANOF           TO CERTCARA.
  9401
  9402     IF DLYACTV-RECORD-NEEDED
  9403         PERFORM 1150-OUTPUT-ACTIVITY-RECORD THRU
  9404                 1150-EXIT
  9405     END-IF.
  9406
  9407     IF CERTEFFI GREATER LOW-VALUES OR
  9408        CERTACTI GREATER LOW-VALUES OR
  9409        CERTSTI  GREATER LOW-VALUES OR
  9410        CERTCARI GREATER LOW-VALUES OR
  9411        CERTGRPI GREATER LOW-VALUES
  9412        PERFORM 1620-VERIFY-ACCT THRU 1620-EXIT.
  9413
  9414*    IF PI-COMPANY-ID = 'CRI' OR 'PEM' OR 'NCL'
  9415*      IF PI-PREM-TYPE NOT = '1'  AND
  9416*         PI-NO-PMTS = ZEROS
  9417*          IF LOANBALL GREATER +0 OR
  9418*             ACVBENEL GREATER +0
  9419*               PERFORM 1620-VERIFY-ACCT THRU 1620-EXIT.
  9420     if not acct-found
  9421        perform 1620-VERIFY-ACCT THRU 1620-EXIT
  9422     end-if
  9423     MOVE PI-COMPANY-CD          TO COMPANY-CODE
  9424     MOVE PI-CARRIER             TO CARRIER-CODE
  9425     MOVE PI-CLAIM-NO            TO CLAIM-NO
  9426     MOVE PI-CERT-NO             TO CERT-NO
  9427
  9428* EXEC CICS READ
  9429*        DATASET   (CLMS-FILE-ID)
  9430*        RIDFLD    (MSTR-KEY)
  9431*        SET       (ADDRESS OF CLAIM-MASTER)
  9432*        RESP      (WS-RESPONSE)
  9433*    END-EXEC
  9434*    MOVE '&"S        E          (  N#00008997' TO DFHEIV0
  9435     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9436     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9437     MOVE X'204E233030303038393937' TO DFHEIV0(25:11)
  9438     CALL 'kxdfhei1' USING DFHEIV0,
  9439           CLMS-FILE-ID,
  9440           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 170
* EL131.cbl
  9441           DFHEIV99,
  9442           MSTR-KEY,
  9443           DFHEIV99,
  9444           DFHEIV99,
  9445           DFHEIV99
  9446     SET ADDRESS OF CLAIM-MASTER TO
  9447         DFHEIV20
  9448     MOVE EIBRESP  TO WS-RESPONSE
  9449     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9450     MOVE CL-COMPANY-CD          TO CERT-COMPANY-CODE
  9451     MOVE CL-CERT-CARRIER        TO CERT-CARRIER
  9452     MOVE CL-CERT-GROUPING       TO CERT-GROUP
  9453     MOVE CL-CERT-STATE          TO CERT-STATE
  9454     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT
  9455     MOVE CL-CERT-EFF-DT         TO CERT-DATE
  9456     MOVE CL-CERT-NO             TO CERT-CERT
  9457
  9458* EXEC CICS READ
  9459*       DATASET   (CERT-FILE-ID)
  9460*       RIDFLD    (CERT-KEY)
  9461*       SET       (ADDRESS OF CERTIFICATE-MASTER)
  9462*       RESP      (WS-RESPONSE)
  9463*    END-EXEC
  9464*    MOVE '&"S        E          (  N#00009010' TO DFHEIV0
  9465     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9466     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9467     MOVE X'204E233030303039303130' TO DFHEIV0(25:11)
  9468     CALL 'kxdfhei1' USING DFHEIV0,
  9469           CERT-FILE-ID,
  9470           DFHEIV20,
  9471           DFHEIV99,
  9472           CERT-KEY,
  9473           DFHEIV99,
  9474           DFHEIV99,
  9475           DFHEIV99
  9476     SET ADDRESS OF CERTIFICATE-MASTER TO
  9477         DFHEIV20
  9478     MOVE EIBRESP  TO WS-RESPONSE
  9479     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9480     if mfnamei > low-values
  9481        move mfnamei to w-name-first
  9482     else
  9483        move cl-insured-1st-name to w-name-first
  9484     end-if
  9485     if mlnamei > low-values
  9486        move mlnamei to w-name-last
  9487     else
  9488        move cl-insured-last-name to w-name-last
  9489     end-if
  9490     if instypel > zeros
  9491        evaluate true
  9492           when cl-no-of-days-paid > zeros
  9493              move er-1668       to emi-error
  9494              perform 9900-error-format
  9495                                 thru 9900-exit
  9496              move al-uabon      to instypea
  9497              move -1            to instypel
  9498              move 'X'           to error-switch
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 171
* EL131.cbl
  9499           when instypei = 'C'
  9500              if w-name-first (1:10) = cm-insured-first-name
  9501                 move er-1666    to emi-error
  9502                 PERFORM 9900-ERROR-FORMAT
  9503                                 THRU 9900-EXIT
  9504                 move al-uabon   to instypea
  9505                 move -1         to instypel
  9506                 move 'X'        to error-switch
  9507              end-if
  9508           when instypei = 'P'
  9509              if (w-name-first (1:10) <> cm-insured-first-name)
  9510                 or (w-name-last <> cm-insured-last-name)
  9511                 move er-1676    to emi-error
  9512                 PERFORM 9900-ERROR-FORMAT
  9513                                 THRU 9900-EXIT
  9514                 move al-uabon   to instypea
  9515                 move -1         to instypel
  9516                 move 'X'        to error-switch
  9517              end-if
  9518        end-evaluate
  9519     end-if
  9520*    if (instypel > zeros)
  9521*       and (cl-no-of-days-paid > zero)
  9522*       move er-1668             to emi-error
  9523*       perform 9900-error-format thru 9900-exit
  9524*       move al-uabon            to instypea
  9525*       move -1                  to instypel
  9526*       move 'X'                 to error-switch
  9527*    end-if
  9528*
  9529*    if instypel > zero
  9530*       if instypei = 'C'
  9531*          if w-name-first (1:10) = cm-insured-first-name
  9532*             move er-1666          to emi-error
  9533*             PERFORM 9900-ERROR-FORMAT
  9534*                                   THRU 9900-EXIT
  9535*             move al-uabon         to instypea
  9536*             move -1               to instypel
  9537*             move 'X'              to error-switch
  9538*          end-if
  9539*       end-if
  9540*    end-if
  9541     if (pi-company-id = 'DCC' OR 'VPP')
  9542        and (acct-found)
  9543        perform 2120-check-pdef  thru 2120-exit
  9544        IF EXTENSL > ZERO
  9545           IF EXTENSI NUMERIC
  9546              IF EXTENSI >  WS-MAX-EXTENSION
  9547                AND ERPDEF-FOUND
  9548                 MOVE ER-1678          TO EMI-ERROR
  9549                 PERFORM 9900-ERROR-FORMAT
  9550                                       THRU 9900-EXIT
  9551                 MOVE AL-UABON         TO EXTENSA
  9552                 MOVE -1               TO EXTENSL
  9553                 MOVE 'X'              TO ERROR-SWITCH
  9554              ELSE
  9555                 MOVE 'X'              TO UPDATE-SWITCH
  9556              END-IF
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 172
* EL131.cbl
  9557           ELSE
  9558              MOVE ER-1778          TO EMI-ERROR
  9559              PERFORM 9900-ERROR-FORMAT
  9560                                    THRU 9900-EXIT
  9561              MOVE AL-UABON         TO EXTENSA
  9562              MOVE -1               TO EXTENSL
  9563              MOVE 'X'              TO ERROR-SWITCH
  9564           END-IF
  9565        END-IF
  9566     end-if
  9567     if benperl > zeros
  9568        move al-uanon            to benpera
  9569     end-if
  9570     if benperl > zeros
  9571        if benperi numeric
  9572           perform 1015-edit-benefit-period
  9573                                 thru 1015-exit
  9574        else
  9575           move er-1669          to emi-error
  9576           PERFORM 9900-ERROR-FORMAT
  9577                                 THRU 9900-EXIT
  9578           move al-uabon         to benpera
  9579           move -1               to benperl
  9580           move 'X'              to error-switch
  9581        end-if
  9582    end-if
  9583     if instypel > zeros
  9584        if instypei = 'P' OR 'C'
  9585           move 'X'              to update-switch
  9586                                    mstr-switch
  9587           move al-uanon         to instypea
  9588        else
  9589            move er-1654          to emi-error
  9590           PERFORM 9900-ERROR-FORMAT
  9591                                 THRU 9900-EXIT
  9592           move al-uabon         to instypea
  9593           move -1               to instypel
  9594           move 'X'              to error-switch
  9595        end-if
  9596    end-if
  9597     if accswl > zeros
  9598        if accswi = 'Y' OR 'N'
  9599           MOVE 'X'              TO UPDATE-SWITCH
  9600                                    MSTR-SWITCH
  9601           MOVE AL-UANON         TO accswa
  9602*       else
  9603*          move er-1656          to emi-error
  9604*          PERFORM 9900-ERROR-FORMAT
  9605*                                THRU 9900-EXIT
  9606*          move al-uabon         to accswa
  9607*          move -1               to accswl
  9608*          move 'X'              to error-switch
  9609*          move al-uanof         to accswa
  9610        end-if
  9611     end-if
  9612     IF CERTL = ZEROS AND
  9613        SUFXL = ZEROS
  9614          GO TO 1010-EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 173
* EL131.cbl
  9615
  9616     IF CERTL GREATER THAN ZEROS
  9617         IF CERTI NOT = PI-SAVE-CERT-NO-PRIME
  9618             MOVE CERTI          TO PI-SAVE-CERT-NO-PRIME
  9619             MOVE 'Y'            TO SKIP-ATTRIBUTE
  9620             MOVE 'X'            TO ERROR-SWITCH
  9621             PERFORM 7000-RESET-ATTRIBUTE THRU 7000-EXIT.
  9622
  9623     IF SUFXL GREATER THAN ZEROS
  9624         IF SUFXI NOT = PI-SAVE-CERT-NO-SUFX
  9625             MOVE SUFXI          TO PI-SAVE-CERT-NO-SUFX
  9626             MOVE 'Y'            TO SKIP-ATTRIBUTE
  9627             MOVE 'X'            TO ERROR-SWITCH
  9628             PERFORM 7000-RESET-ATTRIBUTE THRU 7000-EXIT.
  9629
  9630 1010-EXIT.
  9631     EXIT.
  9632
  9633 1015-edit-benefit-period.
  9634     move ' '                    to ws-benper-sw
  9635     evaluate true
  9636        when not erpdef-found
  9637           set good-benper       to true
  9638        when pd-recurring-yn (a1) = 'Y'
  9639           set good-benper       to true
  9640        when pd-recurring-yn (a1) = 'N'
  9641           if benperi < 02
  9642              set good-benper    to true
  9643           end-if
  9644        when pd-rec-crit-period (a1) numeric
  9645           if benperi <= pd-rec-crit-period (a1)
  9646              set good-benper    to true
  9647           end-if
  9648     end-evaluate
  9649     MOVE CERT-KEY               TO ELCRTT-KEY
  9650     MOVE 'B'                    TO CTRLR-REC-TYPE
  9651
  9652* EXEC CICS READ
  9653*       DATASET   ('ELCRTT')
  9654*       RIDFLD    (ELCRTT-KEY)
  9655*       INTO      (CERTIFICATE-TRAILERS)
  9656*       RESP      (WS-RESPONSE)
  9657*    END-EXEC
  9658     MOVE LENGTH OF
  9659      CERTIFICATE-TRAILERS
  9660       TO DFHEIV11
  9661     MOVE 'ELCRTT' TO DFHEIV1
  9662*    MOVE '&"IL       E          (  N#00009187' TO DFHEIV0
  9663     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  9664     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9665     MOVE X'204E233030303039313837' TO DFHEIV0(25:11)
  9666     CALL 'kxdfhei1' USING DFHEIV0,
  9667           DFHEIV1,
  9668           CERTIFICATE-TRAILERS,
  9669           DFHEIV11,
  9670           ELCRTT-KEY,
  9671           DFHEIV99,
  9672           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 174
* EL131.cbl
  9673           DFHEIV99
  9674     MOVE EIBRESP  TO WS-RESPONSE
  9675     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9676     IF WS-RESP-NORMAL
  9677        perform varying s1 from +1 by +1 until
  9678           (s1 > +24)
  9679           or ((cs-claim-type (s1) = cl-claim-type)
  9680           and (cs-insured-type (s1) = cl-insured-type)
  9681           and (cs-benefit-period (s1) > benperi))
  9682        end-perform
  9683        if s1 < +25
  9684           move er-1665          to emi-error
  9685           PERFORM 9900-ERROR-FORMAT
  9686                                 THRU 9900-EXIT
  9687           move al-uabon         to benpera
  9688           move -1               to benperl
  9689           move 'X'              to error-switch
  9690           go to 1015-exit
  9691*       else
  9692*          set good-benper       to true
  9693        end-if
  9694     end-if
  9695     if good-benper
  9696        move 'X'                 to update-switch
  9697                                    mstr-switch
  9698        move al-uanon            to benpera
  9699     else
  9700        move er-1669             to emi-error
  9701        PERFORM 9900-ERROR-FORMAT
  9702                                 THRU 9900-EXIT
  9703        move al-uabon            to benpera
  9704        move -1                  to benperl
  9705        move 'X'                 to error-switch
  9706     end-if
  9707     .
  9708 1015-exit.
  9709     exit.
  9710 1050-EDIT-BENE.
  9711     MOVE PI-COMPANY-CD      TO TRLR-COMPANY-CD.
  9712     MOVE PI-CARRIER         TO TRLR-CARRIER.
  9713     MOVE PI-CLAIM-NO        TO TRLR-CLAIM-NO.
  9714     MOVE PI-CERT-NO         TO TRLR-CERT-NO.
  9715     MOVE 1000               TO TRLR-SEQ-NO.
  9716
  9717
  9718* EXEC CICS HANDLE CONDITION
  9719*         NOTFND    (1052-DONE)
  9720*         ENDFILE   (1052-DONE)
  9721*    END-EXEC.
  9722*    MOVE '"$I''                  ! & #00009234' TO DFHEIV0
  9723     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  9724     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9725     MOVE X'2620233030303039323334' TO DFHEIV0(25:11)
  9726     CALL 'kxdfhei1' USING DFHEIV0
  9727     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9728
  9729
  9730
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 175
* EL131.cbl
  9731* EXEC CICS STARTBR
  9732*        DATASET (TRLR-FILE-ID)
  9733*        RIDFLD  (TRLR-KEY)
  9734*    END-EXEC
  9735     MOVE 0
  9736       TO DFHEIV11
  9737*    MOVE '&,         G          &   #00009239' TO DFHEIV0
  9738     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9739     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9740     MOVE X'2020233030303039323339' TO DFHEIV0(25:11)
  9741     CALL 'kxdfhei1' USING DFHEIV0,
  9742           TRLR-FILE-ID,
  9743           TRLR-KEY,
  9744           DFHEIV99,
  9745           DFHEIV11,
  9746           DFHEIV99
  9747     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9748
  9749
  9750     MOVE SPACES TO WS-TRLR-FILE-EOF
  9751                    WS-PAYMENT-PENDING
  9752     PERFORM 1052-READ-TRLR THRU 1052-EXIT
  9753       UNTIL  TRLR-FILE-EOF
  9754         OR PAYMENT-PENDING
  9755
  9756
  9757* EXEC CICS ENDBR
  9758*        DATASET (TRLR-FILE-ID)
  9759*    END-EXEC.
  9760     MOVE 0
  9761       TO DFHEIV11
  9762*    MOVE '&2                    $   #00009251' TO DFHEIV0
  9763     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9764     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9765     MOVE X'2020233030303039323531' TO DFHEIV0(25:11)
  9766     CALL 'kxdfhei1' USING DFHEIV0,
  9767           TRLR-FILE-ID,
  9768           DFHEIV11,
  9769           DFHEIV99
  9770     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9771
  9772 1050-EXIT.
  9773     EXIT.
  9774
  9775 1052-READ-TRLR.
  9776
  9777* EXEC CICS READNEXT
  9778*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
  9779*         DATASET  (TRLR-FILE-ID)
  9780*         RIDFLD   (TRLR-KEY)
  9781*    END-EXEC.
  9782     MOVE 0
  9783       TO DFHEIV11
  9784*    MOVE '&.S                   )   #00009258' TO DFHEIV0
  9785     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9786     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  9787     MOVE X'2020233030303039323538' TO DFHEIV0(25:11)
  9788     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 176
* EL131.cbl
  9789           TRLR-FILE-ID,
  9790           DFHEIV20,
  9791           DFHEIV99,
  9792           TRLR-KEY,
  9793           DFHEIV99,
  9794           DFHEIV11,
  9795           DFHEIV99,
  9796           DFHEIV99
  9797     SET ADDRESS OF ACTIVITY-TRAILERS TO
  9798         DFHEIV20
  9799     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9800
  9801
  9802     IF PI-COMPANY-CD   = TRLR-COMPANY-CD
  9803       AND PI-CARRIER  = TRLR-CARRIER
  9804       AND PI-CLAIM-NO = TRLR-CLAIM-NO
  9805       AND PI-CERT-NO  = TRLR-CERT-NO
  9806        CONTINUE
  9807     ELSE
  9808        GO TO 1052-DONE
  9809     END-IF.
  9810
  9811     IF PAYMENT-TR
  9812       AND BENEFICIARY-PAID
  9813       AND AT-VOID-DT = LOW-VALUES
  9814       AND AT-CHECK-WRITTEN-DT NOT > SPACES
  9815         SET PAYMENT-PENDING TO TRUE
  9816     END-IF.
  9817
  9818     IF CORRESPONDENCE-TR
  9819        IF AT-AUTH-RCVD = 'Y'
  9820           SET AUTH-RCVD TO TRUE
  9821        ELSE
  9822        IF AT-AUTH-RCVD = 'N'
  9823           SET NO-AUTH-RCVD TO TRUE
  9824        END-IF
  9825        END-IF
  9826     END-IF.
  9827
  9828     GO TO 1052-EXIT.
  9829
  9830 1052-DONE.
  9831     SET TRLR-FILE-EOF TO TRUE.
  9832 1052-EXIT.
  9833     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 177
* EL131.cbl
  9835 1120-EDIT-PROC.
  9836     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
  9837     MOVE '2'                    TO CNTL-REC-TYPE.
  9838     MOVE PROCI                  TO CNTL-PROC-ID.
  9839     MOVE ZERO                   TO CNTL-SEQ-NO.
  9840
  9841
  9842* EXEC CICS HANDLE CONDITION
  9843*         NOTFND    (1120-CNTL-NOTFND)
  9844*    END-EXEC.
  9845*    MOVE '"$I                   ! '' #00009303' TO DFHEIV0
  9846     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9847     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9848     MOVE X'2720233030303039333033' TO DFHEIV0(25:11)
  9849     CALL 'kxdfhei1' USING DFHEIV0
  9850     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9851
  9852
  9853
  9854* EXEC CICS READ
  9855*         SET      (ADDRESS OF CONTROL-FILE)
  9856*         DATASET  (CNTL-FILE-ID)
  9857*         RIDFLD   (CNTL-KEY)
  9858*    END-EXEC.
  9859*    MOVE '&"S        E          (   #00009307' TO DFHEIV0
  9860     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9861     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9862     MOVE X'2020233030303039333037' TO DFHEIV0(25:11)
  9863     CALL 'kxdfhei1' USING DFHEIV0,
  9864           CNTL-FILE-ID,
  9865           DFHEIV20,
  9866           DFHEIV99,
  9867           CNTL-KEY,
  9868           DFHEIV99,
  9869           DFHEIV99,
  9870           DFHEIV99
  9871     SET ADDRESS OF CONTROL-FILE TO
  9872         DFHEIV20
  9873     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9874
  9875
  9876     MOVE AL-UANON               TO PROCA.
  9877     MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH MSTR-KEY-SWITCH.
  9878     GO TO 1120-EXIT.
  9879
  9880 1120-CNTL-NOTFND.
  9881     MOVE ER-0273                TO EMI-ERROR.
  9882     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9883     MOVE AL-UABON               TO PROCA.
  9884     MOVE -1                     TO PROCL.
  9885     MOVE 'X'                    TO ERROR-SWITCH.
  9886
  9887 1120-EXIT.
  9888     EXIT.
  9889
  9890*************************************************************
  9891*****    BEGIN PROCESSING FOR OUTPUTTING DLYACTV RECORD    **
  9892*************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 178
* EL131.cbl
  9893
  9894 1150-OUTPUT-ACTIVITY-RECORD.
  9895
  9896
  9897* EXEC CICS GETMAIN
  9898*        SET (ADDRESS OF DAILY-ACTIVITY-RECORD)
  9899*        LENGTH (25)
  9900*        INITIMG (WS-BLANK)
  9901*    END-EXEC.
  9902     MOVE 25
  9903       TO DFHEIV11
  9904*    MOVE ',"IL                  $   #00009333' TO DFHEIV0
  9905     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  9906     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9907     MOVE X'2020233030303039333333' TO DFHEIV0(25:11)
  9908     CALL 'kxdfhei1' USING DFHEIV0,
  9909           DFHEIV20,
  9910           DFHEIV11,
  9911           WS-BLANK
  9912     SET ADDRESS OF DAILY-ACTIVITY-RECORD TO
  9913         DFHEIV20
  9914     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9915
  9916
  9917     MOVE SPACES                 TO DAILY-ACTIVITY-RECORD.
  9918     MOVE PI-COMPANY-CD          TO DA-COMP-CD.
  9919     MOVE PI-CARRIER             TO DA-CARRIER.
  9920     MOVE PI-CLAIM-NO            TO DA-CLAIM-NO.
  9921     MOVE PI-CERT-NO             TO DA-CERT-NO.
  9922     MOVE ZEROS                  TO DA-TRAILER-SEQ-NO.
  9923     MOVE WS-HOLD-CLAIM-STATUS   TO DA-RECORD-TYPE.
  9924
  9925
  9926* EXEC CICS HANDLE CONDITION
  9927*        NOTOPEN (1150-NOTOPEN-ERROR)
  9928*        DUPREC (1150-EXIT)
  9929*    END-EXEC.
  9930*    MOVE '"$J%                  ! ( #00009347' TO DFHEIV0
  9931     MOVE X'22244A252020202020202020' TO DFHEIV0(1:12)
  9932     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9933     MOVE X'2820233030303039333437' TO DFHEIV0(25:11)
  9934     CALL 'kxdfhei1' USING DFHEIV0
  9935     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9936
  9937     MOVE DAILY-ACTIVITY-RECORD  TO JP-RECORD-AREA.
  9938     MOVE 'DLYACTV'              TO JP-FILE-ID.
  9939     MOVE 'A'                    TO JP-RECORD-TYPE.
  9940     MOVE +48                    TO JOURNAL-LENGTH.
  9941
  9942
  9943* EXEC CICS WRITE
  9944*        DATASET ('DLYACTV')
  9945*        RIDFLD (DA-KEY)
  9946*        FROM (DAILY-ACTIVITY-RECORD)
  9947*        LENGTH (25)
  9948*    END-EXEC.
  9949     MOVE 'DLYACTV' TO DFHEIV1
  9950     MOVE 25
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 179
* EL131.cbl
  9951       TO DFHEIV11
  9952*    MOVE '&$ L                  ''   #00009356' TO DFHEIV0
  9953     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9954     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9955     MOVE X'2020233030303039333536' TO DFHEIV0(25:11)
  9956     CALL 'kxdfhei1' USING DFHEIV0,
  9957           DFHEIV1,
  9958           DAILY-ACTIVITY-RECORD,
  9959           DFHEIV11,
  9960           DA-KEY,
  9961           DFHEIV99,
  9962           DFHEIV99
  9963     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9964
  9965
  9966     GO TO 1150-EXIT.
  9967
  9968 1150-NOTOPEN-ERROR.
  9969
  9970     MOVE '2955'                 TO EMI-ERROR.
  9971     MOVE -1                     TO MAINTL.
  9972     MOVE AL-UANON               TO MAINTA.
  9973     MOVE 'X'                    TO ERROR-SWITCH.
  9974     PERFORM 9900-ERROR-FORMAT THRU
  9975             9900-EXIT.
  9976
  9977 1150-EXIT.
  9978     EXIT.
  9979
  9980*************************************************************
  9981*****    END OF PROCESSING FOR OUTPUTTING DLYACTV RECORD    *
  9982*************************************************************
  9983
  9984 1240-EDIT-LIFE-CODE.
  9985
  9986     IF INVALID-BENEFIT-CODE
  9987         GO TO 1240-SET-ERROR.
  9988
  9989     MOVE SPACES                 TO BENEFIT-KEY.
  9990     MOVE PI-COMPANY-ID          TO BEN-CO-ID.
  9991     MOVE '4'                    TO BEN-REC-TYPE.
  9992     MOVE LCVCDI                 TO BEN-ACC-CD HOLD-BENEFIT.
  9993     MOVE ZERO                   TO BEN-SEQ-NO.
  9994
  9995
  9996* EXEC CICS READ GTEQ
  9997*         DATASET  (CNTL-FILE-ID)
  9998*         RIDFLD   (BENEFIT-KEY)
  9999*         SET      (ADDRESS OF CONTROL-FILE)
 10000*    END-EXEC.
 10001*    MOVE '&"S        G          (   #00009392' TO DFHEIV0
 10002     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 10003     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10004     MOVE X'2020233030303039333932' TO DFHEIV0(25:11)
 10005     CALL 'kxdfhei1' USING DFHEIV0,
 10006           CNTL-FILE-ID,
 10007           DFHEIV20,
 10008           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 180
* EL131.cbl
 10009           BENEFIT-KEY,
 10010           DFHEIV99,
 10011           DFHEIV99,
 10012           DFHEIV99
 10013     SET ADDRESS OF CONTROL-FILE TO
 10014         DFHEIV20
 10015     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10016
 10017
 10018     IF CF-COMPANY-ID  NOT = PI-COMPANY-ID OR
 10019        CF-RECORD-TYPE NOT = '4'
 10020         GO TO 1240-SET-ERROR.
 10021
 10022     MOVE ZERO                   TO COUNT-2.
 10023     PERFORM 5040-FIND-BENEFIT THRU 5060-EXIT.
 10024
 10025     IF SCREEN-ERROR
 10026         GO TO 1240-SET-ERROR.
 10027
 10028 1240-SET-CODE-SWITCHES.
 10029     MOVE 'X'                    TO UPDATE-SWITCH CERT-SWITCH.
 10030     MOVE AL-UANON               TO LCVCDA.
 10031     GO TO 1240-EXIT.
 10032
 10033 1240-SET-ERROR.
 10034     MOVE ER-0240                TO EMI-ERROR.
 10035     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10036     MOVE 'X'                    TO ERROR-SWITCH.
 10037     MOVE AL-UABON               TO LCVCDA.
 10038     MOVE -1                     TO LCVCDL.
 10039
 10040 1240-EXIT.
 10041     EXIT.
 10042
 10043 1310-EDIT-AH-CODE.
 10044     IF INVALID-BENEFIT-CODE
 10045         GO TO 1310-SET-ERROR.
 10046
 10047     MOVE SPACES                 TO BENEFIT-KEY.
 10048     MOVE PI-COMPANY-ID          TO BEN-CO-ID.
 10049     MOVE '5'                    TO BEN-REC-TYPE.
 10050     MOVE ACVCDI                 TO BEN-ACC-CD HOLD-BENEFIT.
 10051     MOVE ZERO                   TO BEN-SEQ-NO.
 10052
 10053
 10054* EXEC CICS READ GTEQ
 10055*         DATASET  (CNTL-FILE-ID)
 10056*         RIDFLD   (BENEFIT-KEY)
 10057*         SET      (ADDRESS OF CONTROL-FILE)
 10058*    END-EXEC.
 10059*    MOVE '&"S        G          (   #00009433' TO DFHEIV0
 10060     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 10061     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10062     MOVE X'2020233030303039343333' TO DFHEIV0(25:11)
 10063     CALL 'kxdfhei1' USING DFHEIV0,
 10064           CNTL-FILE-ID,
 10065           DFHEIV20,
 10066           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 181
* EL131.cbl
 10067           BENEFIT-KEY,
 10068           DFHEIV99,
 10069           DFHEIV99,
 10070           DFHEIV99
 10071     SET ADDRESS OF CONTROL-FILE TO
 10072         DFHEIV20
 10073     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10074
 10075
 10076     IF CF-COMPANY-ID  NOT = PI-COMPANY-ID OR
 10077        CF-RECORD-TYPE NOT = '5'
 10078         GO TO 1310-SET-ERROR.
 10079
 10080     MOVE ZERO                   TO COUNT-2.
 10081     PERFORM 5040-FIND-BENEFIT THRU 5060-EXIT.
 10082     IF SCREEN-ERROR
 10083         GO TO 1310-SET-ERROR.
 10084
 10085 1310-SET-CODE-SWITCHES.
 10086     MOVE 'X'                    TO UPDATE-SWITCH CERT-SWITCH.
 10087     MOVE AL-UANON               TO ACVCDA.
 10088     GO TO 1310-EXIT.
 10089
 10090 1310-SET-ERROR.
 10091     MOVE ER-0250                TO EMI-ERROR.
 10092     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10093     MOVE AL-UABON               TO ACVCDA.
 10094     MOVE 'X'                    TO ERROR-SWITCH.
 10095     MOVE -1                     TO ACVCDL.
 10096
 10097 1310-EXIT.
 10098     EXIT.
 10099
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 182
* EL131.cbl
 10101 1460-EDIT-CERT-NO.
 10102     MOVE CERTI                  TO WS-CERT-NO-PRIME.
 10103     MOVE SUFXI                  TO WS-CERT-NO-SUFX.
 10104
 10105     IF WS-SAVE-CERT-NO = SPACES
 10106         MOVE ER-0203            TO EMI-ERROR
 10107         GO TO 1460-CERT-NO-ERROR.
 10108
 10109     IF WS-CERT-NO-PRIME = SPACES AND
 10110        WS-CERT-NO-SUFX GREATER THAN SPACE
 10111            MOVE ER-0210         TO EMI-ERROR
 10112            GO TO 1460-CERT-NO-ERROR.
 10113
 10114     MOVE 'X'                    TO UPDATE-SWITCH.
 10115     MOVE 'Y'                    TO CERT-KEY-SWITCH.
 10116     MOVE AL-UANON               TO CERTA.
 10117
 10118     IF SUFXL IS GREATER THAN 0
 10119         MOVE AL-UANON           TO SUFXA.
 10120
 10121     GO TO 1460-EXIT.
 10122
 10123 1460-CERT-NO-ERROR.
 10124     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10125     MOVE AL-UABON               TO SUFXA.
 10126     MOVE AL-UABON               TO CERTA.
 10127     MOVE -1                     TO CERTL.
 10128     MOVE 'X'                    TO ERROR-SWITCH.
 10129
 10130 1460-EXIT.
 10131     EXIT.
 10132
 10133 1470-EDIT-EFF.
 10134     IF CERTEFFI = SPACES
 10135         GO TO 1470-DATE-ERROR.
 10136
 10137     MOVE CERTEFFI               TO DEEDIT-DATE-INPUT.
 10138     PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT.
 10139     IF DEEDIT-DATE = ZERO
 10140         GO TO 1470-DATE-ERROR.
 10141
 10142     MOVE DEEDIT-DATE            TO DC-GREG-DATE-1-MDY.
 10143     MOVE '4'                    TO DC-OPTION-CODE.
 10144     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
 10145     IF NOT DATE-CONVERSION-ERROR
 10146         MOVE DC-BIN-DATE-1      TO HOLD-EFF
 10147         MOVE AL-UANON           TO CERTEFFA
 10148         MOVE 'X'                TO UPDATE-SWITCH
 10149         MOVE 'Y'                TO CERT-KEY-SWITCH
 10150         MOVE DC-GREG-DATE-1-EDIT TO CERTEFFO
 10151         GO TO 1470-EXIT.
 10152
 10153 1470-DATE-ERROR.
 10154     MOVE ER-0215                TO EMI-ERROR.
 10155     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10156     MOVE AL-UABON               TO CERTEFFA.
 10157     MOVE -1                     TO CERTEFFL.
 10158     MOVE 'X'                    TO ERROR-SWITCH.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 183
* EL131.cbl
 10159
 10160 1470-EXIT.
 10161     EXIT.
 10162
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 184
* EL131.cbl
 10164 1480-EDIT-ACCT.
 10165     IF CERTACTI = SPACES
 10166         MOVE ER-0232            TO EMI-ERROR
 10167         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10168         MOVE AL-UABON           TO CERTACTA
 10169         MOVE -1                 TO CERTACTL
 10170         MOVE 'X'                TO ERROR-SWITCH
 10171     ELSE
 10172         MOVE 'X'                TO UPDATE-SWITCH
 10173         MOVE 'Y'                TO CERT-KEY-SWITCH.
 10174
 10175 1480-EXIT.
 10176     EXIT.
 10177
 10178 1490-EDIT-STATE.
 10179     IF CERTSTI = SPACES
 10180         MOVE ER-0233            TO EMI-ERROR
 10181         GO TO 1490-STATE-ERROR.
 10182
 10183     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
 10184     MOVE '3'                    TO CNTL-REC-TYPE.
 10185     MOVE SPACES                 TO CNTL-STATE-ACCESS.
 10186     MOVE CERTSTI                TO CNTL-STATE-NUMBER.
 10187     MOVE ZERO                   TO CNTL-SEQ-NO.
 10188
 10189
 10190* EXEC CICS HANDLE CONDITION
 10191*         NOTFND (1490-STATE-NOTFND)
 10192*    END-EXEC.
 10193*    MOVE '"$I                   ! ) #00009552' TO DFHEIV0
 10194     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10195     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10196     MOVE X'2920233030303039353532' TO DFHEIV0(25:11)
 10197     CALL 'kxdfhei1' USING DFHEIV0
 10198     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10199
 10200
 10201
 10202* EXEC CICS READ
 10203*         SET        (ADDRESS OF CONTROL-FILE)
 10204*         DATASET    ('ELCNTL')
 10205*         RIDFLD     (CNTL-KEY)
 10206*         KEYLENGTH  (CNTL-GENERIC-LENGTH)
 10207*         GENERIC
 10208*    END-EXEC.
 10209     MOVE 'ELCNTL' TO DFHEIV1
 10210*    MOVE '&"S  KG    E          (   #00009556' TO DFHEIV0
 10211     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 10212     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10213     MOVE X'2020233030303039353536' TO DFHEIV0(25:11)
 10214     CALL 'kxdfhei1' USING DFHEIV0,
 10215           DFHEIV1,
 10216           DFHEIV20,
 10217           DFHEIV99,
 10218           CNTL-KEY,
 10219           CNTL-GENERIC-LENGTH,
 10220           DFHEIV99,
 10221           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 185
* EL131.cbl
 10222     SET ADDRESS OF CONTROL-FILE TO
 10223         DFHEIV20
 10224     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10225
 10226
 10227     MOVE AL-UANON               TO CERTSTA.
 10228     MOVE 'X'                    TO UPDATE-SWITCH.
 10229     MOVE 'Y'                    TO CERT-KEY-SWITCH.
 10230     GO TO 1490-EXIT.
 10231
 10232 1490-STATE-NOTFND.
 10233     MOVE ER-0149                TO EMI-ERROR.
 10234
 10235 1490-STATE-ERROR.
 10236     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10237     MOVE AL-UABON               TO CERTSTA.
 10238     MOVE -1                     TO CERTSTL.
 10239     MOVE 'X'                    TO ERROR-SWITCH.
 10240
 10241 1490-EXIT.
 10242     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 186
* EL131.cbl
 10244 1500-EDIT-CARR.
 10245     IF CERTCARI = SPACES
 10246         GO TO 1500-CARR-NOTFND.
 10247
 10248     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
 10249     MOVE '6'                    TO CNTL-REC-TYPE.
 10250     MOVE SPACES                 TO CNTL-CARRIER-ACCESS.
 10251     MOVE CERTCARI               TO CNTL-CARRIER.
 10252     MOVE ZERO                   TO CNTL-SEQ-NO.
 10253
 10254
 10255* EXEC CICS HANDLE CONDITION
 10256*         NOTFND   (1500-CARR-NOTFND)
 10257*    END-EXEC.
 10258*    MOVE '"$I                   ! * #00009591' TO DFHEIV0
 10259     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10260     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10261     MOVE X'2A20233030303039353931' TO DFHEIV0(25:11)
 10262     CALL 'kxdfhei1' USING DFHEIV0
 10263     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10264
 10265
 10266
 10267* EXEC CICS READ
 10268*         SET        (ADDRESS OF CONTROL-FILE)
 10269*         DATASET    ('ELCNTL')
 10270*         RIDFLD     (CNTL-KEY)
 10271*         KEYLENGTH  (CNTL-GENERIC-LENGTH)
 10272*         GENERIC
 10273*    END-EXEC.
 10274     MOVE 'ELCNTL' TO DFHEIV1
 10275*    MOVE '&"S  KG    E          (   #00009595' TO DFHEIV0
 10276     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 10277     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10278     MOVE X'2020233030303039353935' TO DFHEIV0(25:11)
 10279     CALL 'kxdfhei1' USING DFHEIV0,
 10280           DFHEIV1,
 10281           DFHEIV20,
 10282           DFHEIV99,
 10283           CNTL-KEY,
 10284           CNTL-GENERIC-LENGTH,
 10285           DFHEIV99,
 10286           DFHEIV99
 10287     SET ADDRESS OF CONTROL-FILE TO
 10288         DFHEIV20
 10289     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10290
 10291
 10292     MOVE AL-UANON               TO CERTCARA.
 10293     MOVE 'X'                    TO UPDATE-SWITCH.
 10294     MOVE 'Y'                    TO CERT-KEY-SWITCH.
 10295     GO TO 1500-EXIT.
 10296
 10297 1500-CARR-NOTFND.
 10298     MOVE ER-0360                TO EMI-ERROR.
 10299     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10300     MOVE AL-UABON               TO CERTCARA.
 10301     MOVE -1                     TO CERTCARL.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 187
* EL131.cbl
 10302     MOVE 'X'                    TO ERROR-SWITCH.
 10303
 10304 1500-EXIT.
 10305     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 188
* EL131.cbl
 10307 1510-DEEDIT-DATE.
 10308
 10309* EXEC CICS BIF DEEDIT
 10310*         FIELD    (DEEDIT-DATE-INPUT)
 10311*         LENGTH   (DATE-LENGTH)
 10312*    END-EXEC.
 10313*    MOVE '@"L                   #   #00009619' TO DFHEIV0
 10314     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10315     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10316     MOVE X'2020233030303039363139' TO DFHEIV0(25:11)
 10317     CALL 'kxdfhei1' USING DFHEIV0,
 10318           DEEDIT-DATE-INPUT,
 10319           DATE-LENGTH
 10320     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10321
 10322
 10323 1510-EXIT.
 10324     EXIT.
 10325
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 189
* EL131.cbl
 10327 1620-VERIFY-ACCT.
 10328
 10329     move ' '                    to ws-eracct-sw
 10330     MOVE PI-COMPANY-CD          TO ACCT-COMPANY-CODE.
 10331     MOVE PI-CARRIER             TO ACCT-CARRIER.
 10332     MOVE PI-GROUPING            TO ACCT-GROUP.
 10333     MOVE PI-STATE               TO ACCT-STATE.
 10334     MOVE PI-ACCOUNT             TO ACCT-ACCOUNT.
 10335
 10336     IF CERTEFFI GREATER THAN LOW-VALUES
 10337         MOVE HOLD-EFF           TO ACCT-DATE
 10338     ELSE
 10339         MOVE PI-CERT-EFF-DT     TO HOLD-EFF ACCT-DATE.
 10340
 10341     IF CERTACTI GREATER THAN LOW-VALUES
 10342         MOVE CERTACTI           TO  ACCT-ACCOUNT.
 10343     IF CERTSTI GREATER THAN LOW-VALUES
 10344         MOVE CERTSTI            TO  ACCT-STATE.
 10345     IF CERTCARI GREATER THAN LOW-VALUES
 10346         MOVE CERTCARI           TO  ACCT-CARRIER.
 10347     IF CERTGRPI GREATER THAN LOW-VALUES
 10348         MOVE CERTGRPI           TO ACCT-GROUP.
 10349
 10350     MOVE ACCT-PARTIAL-KEY       TO SAVE-ACCT-KEY.
 10351
 10352
 10353* EXEC CICS HANDLE CONDITION
 10354*         NOTFND  (1620-ACCT-NOTFND)
 10355*    END-EXEC.
 10356*    MOVE '"$I                   ! + #00009653' TO DFHEIV0
 10357     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10358     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10359     MOVE X'2B20233030303039363533' TO DFHEIV0(25:11)
 10360     CALL 'kxdfhei1' USING DFHEIV0
 10361     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10362
 10363
 10364
 10365* EXEC CICS STARTBR
 10366*         DATASET   (ACCT-FILE-ID)
 10367*         RIDFLD    (ACCT-KEY)
 10368*    END-EXEC.
 10369     MOVE 0
 10370       TO DFHEIV11
 10371*    MOVE '&,         G          &   #00009657' TO DFHEIV0
 10372     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 10373     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10374     MOVE X'2020233030303039363537' TO DFHEIV0(25:11)
 10375     CALL 'kxdfhei1' USING DFHEIV0,
 10376           ACCT-FILE-ID,
 10377           ACCT-KEY,
 10378           DFHEIV99,
 10379           DFHEIV11,
 10380           DFHEIV99
 10381     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10382
 10383
 10384 1620-ACCT-LOOP.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 190
* EL131.cbl
 10385
 10386
 10387* EXEC CICS READNEXT
 10388*         DATASET  (ACCT-FILE-ID)
 10389*         RIDFLD   (ACCT-KEY)
 10390*         SET      (ADDRESS OF ACCOUNT-MASTER)
 10391*    END-EXEC.
 10392     MOVE 0
 10393       TO DFHEIV11
 10394*    MOVE '&.S                   )   #00009664' TO DFHEIV0
 10395     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 10396     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 10397     MOVE X'2020233030303039363634' TO DFHEIV0(25:11)
 10398     CALL 'kxdfhei1' USING DFHEIV0,
 10399           ACCT-FILE-ID,
 10400           DFHEIV20,
 10401           DFHEIV99,
 10402           ACCT-KEY,
 10403           DFHEIV99,
 10404           DFHEIV11,
 10405           DFHEIV99,
 10406           DFHEIV99
 10407     SET ADDRESS OF ACCOUNT-MASTER TO
 10408         DFHEIV20
 10409     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10410
 10411
 10412     IF SAVE-ACCT-KEY NOT = ACCT-PARTIAL-KEY
 10413         GO TO 1620-ACCT-NOTFND.
 10414
 10415     IF HOLD-EFF NOT LESS AM-EFFECTIVE-DT  AND
 10416        HOLD-EFF     LESS AM-EXPIRATION-DT
 10417         NEXT SENTENCE
 10418     ELSE
 10419         GO TO 1620-ACCT-LOOP.
 10420
 10421     set acct-found to true
 10422     IF PI-COMPANY-ID NOT = 'CRI' AND 'PEM' AND 'NCL'
 10423         GO TO 1620-ACCT-END-BROWSE.
 10424
 10425     IF LOANBALL GREATER THAN +0
 10426         IF AM-MAX-TOT-BEN NUMERIC  AND
 10427            AM-MAX-TOT-BEN GREATER THAN ZERO
 10428             IF HOLD-LOANBAL GREATER THAN AM-MAX-TOT-BEN
 10429                 MOVE AL-UNBON     TO LOANBALA
 10430                 MOVE -1           TO LOANBALL
 10431                 MOVE 'X'          TO ERROR-SWITCH
 10432                 MOVE ER-7641      TO EMI-ERROR
 10433                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10434
 10435     IF ACVBENEL GREATER THAN +0
 10436         IF AM-MAX-MON-BEN NUMERIC  AND
 10437            AM-MAX-MON-BEN GREATER THAN ZERO
 10438             IF HOLD-AH-CV-BEN GREATER THAN AM-MAX-MON-BEN
 10439                 MOVE AL-UNBON     TO ACVBENEA
 10440                 MOVE -1           TO ACVBENEL
 10441                 MOVE 'X'          TO ERROR-SWITCH
 10442                 MOVE ER-7642      TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 191
* EL131.cbl
 10443                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10444
 10445 1620-ACCT-END-BROWSE.
 10446
 10447
 10448* EXEC CICS ENDBR
 10449*         DATASET (ACCT-FILE-ID)
 10450*    END-EXEC.
 10451     MOVE 0
 10452       TO DFHEIV11
 10453*    MOVE '&2                    $   #00009705' TO DFHEIV0
 10454     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 10455     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10456     MOVE X'2020233030303039373035' TO DFHEIV0(25:11)
 10457     CALL 'kxdfhei1' USING DFHEIV0,
 10458           ACCT-FILE-ID,
 10459           DFHEIV11,
 10460           DFHEIV99
 10461     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10462
 10463
 10464     GO TO 1620-EXIT.
 10465
 10466 1620-ACCT-NOTFND.
 10467
 10468     MOVE -1                     TO MAINTL.
 10469     MOVE 'X'                    TO ERROR-SWITCH.
 10470     MOVE ER-0426                TO EMI-ERROR.
 10471     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10472
 10473 1620-EXIT.
 10474     EXIT.
 10475
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 192
* EL131.cbl
 10477 2000-UPDATE-CLAIM.
 10478
 10479     MOVE SPACES                 TO ERROR-SWITCH.
 10480     MOVE PI-COMPANY-CD          TO COMPANY-CODE.
 10481     MOVE PI-CARRIER             TO CARRIER-CODE.
 10482     MOVE PI-CLAIM-NO            TO CLAIM-NO.
 10483     MOVE PI-CERT-NO             TO CERT-NO.
 10484
 10485     IF DELETE-CLAIM
 10486         GO TO 3000-DELETE-CLAIM.
 10487
 10488     IF  NOT MODIFY-CAP
 10489         MOVE ER-0070            TO EMI-ERROR
 10490         MOVE 'X'                TO ERROR-SWITCH
 10491         MOVE -1                 TO MAINTL
 10492         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10493         GO TO 2000-EXIT.
 10494
 10495     MOVE MSTR-KEY               TO TRLR-MAIN-KEY ACTQ-KEY.
 10496     MOVE ZERO                   TO TRLR-SEQ-NO.
 10497
 10498
 10499* EXEC CICS READ UPDATE
 10500*         SET       (ADDRESS OF CLAIM-MASTER)
 10501*         DATASET   (CLMS-FILE-ID)
 10502*         RIDFLD    (MSTR-KEY)
 10503*    END-EXEC.
 10504*    MOVE '&"S        EU         (   #00009743' TO DFHEIV0
 10505     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10506     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10507     MOVE X'2020233030303039373433' TO DFHEIV0(25:11)
 10508     CALL 'kxdfhei1' USING DFHEIV0,
 10509           CLMS-FILE-ID,
 10510           DFHEIV20,
 10511           DFHEIV99,
 10512           MSTR-KEY,
 10513           DFHEIV99,
 10514           DFHEIV99,
 10515           DFHEIV99
 10516     SET ADDRESS OF CLAIM-MASTER TO
 10517         DFHEIV20
 10518     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10519
 10520
 10521     if (incl > zeros)
 10522        and (cl-no-of-pmts-made > 0)
 10523        and (hold-incur > low-values)
 10524        and (hold-incur not = cl-incurred-dt)
 10525        if hold-incur > cl-incurred-dt
 10526           move cl-incurred-dt   to dc-bin-date-1
 10527           move hold-incur       to dc-bin-date-2
 10528        else
 10529           move hold-incur       to dc-bin-date-1
 10530           move cl-incurred-dt   to dc-bin-date-2
 10531        end-if
 10532        move '1'                 to dc-option-code
 10533        PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 10534        if dc-elapsed-days > +180
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 193
* EL131.cbl
 10535           MOVE ER-1663             TO EMI-ERROR
 10536           PERFORM 9900-ERROR-FORMAT
 10537                                 THRU 9900-EXIT
 10538           MOVE -1                  TO MAINTL
 10539           GO TO 8110-SEND-DATA
 10540        end-if
 10541     end-if
 10542     IF (CL-PRIORITY-CD = '8')
 10543        AND (PI-PROCESSOR-ID NOT = 'PEMA' AND 'JMS '
 10544             AND 'AMWA' AND 'KMSB')
 10545        MOVE ER-8003             TO EMI-ERROR
 10546        PERFORM 9900-ERROR-FORMAT
 10547                                 THRU 9900-EXIT
 10548        MOVE -1                  TO MAINTL
 10549        GO TO 8110-SEND-DATA
 10550     END-IF
 10551
 10552     IF PI-UPDATE-BY NOT = CL-LAST-MAINT-USER
 10553         MOVE ER-0068            TO EMI-ERROR
 10554         PERFORM 2010-RELEASE-REC THRU 2010-EXIT
 10555         GO TO 2000-EXIT.
 10556
 10557     IF PI-UPDATE-HHMMSS NOT = CL-LAST-MAINT-HHMMSS
 10558         MOVE ER-0068            TO EMI-ERROR
 10559         PERFORM 2010-RELEASE-REC THRU 2010-EXIT
 10560         GO TO 2000-EXIT.
 10561
 10562     IF CL-CLAIM-PAYMENT-STATUS NOT NUMERIC
 10563         MOVE ZEROS              TO CL-CLAIM-PAYMENT-STATUS.
 10564
 10565     IF CL-PURGED-DT NOT = LOW-VALUES
 10566         MOVE ER-7691            TO EMI-ERROR
 10567         PERFORM 2010-RELEASE-REC THRU 2010-EXIT
 10568         GO TO 2000-EXIT.
 10569
 10570     IF CERT-KEY-CHANGED
 10571         PERFORM 2060-CHANGE-CERT THRU 2060-EXIT.
 10572
 10573     IF SCREEN-ERROR
 10574         MOVE ER-0068            TO EMI-ERROR
 10575         PERFORM 2010-RELEASE-REC THRU 2010-EXIT
 10576         GO TO 2000-EXIT.
 10577
 10578     IF NINETY-TRLR-UPDATED
 10579         PERFORM 2425-UPDATE-NINETY-TRLR THRU 2425-EXIT.
 10580
 10581     IF MSTR-KEY-CHANGED
 10582         PERFORM 2030-KEY-UPDATE THRU 2030-EXIT
 10583        ELSE
 10584         PERFORM 2020-NORMAL-UPDATE THRU 2020-EXIT.
 10585
 10586     IF TRLR-UPDATE-REQUIRED
 10587         PERFORM 2300-UPDATE-TRLR THRU 2300-EXIT.
 10588
 10589 2000-CHECK-CERT.
 10590     IF NOT CERT-UPDATES
 10591         GO TO 2000-EXIT.
 10592
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 194
* EL131.cbl
 10593     MOVE PI-COMPANY-CD          TO CERT-COMPANY-CODE.
 10594     MOVE PI-CARRIER             TO CERT-CARRIER.
 10595     MOVE PI-GROUPING            TO CERT-GROUP.
 10596     MOVE PI-STATE               TO CERT-STATE.
 10597     MOVE PI-ACCOUNT             TO CERT-ACCOUNT.
 10598     MOVE PI-CERT-EFF-DT         TO CERT-DATE.
 10599     MOVE PI-CERT-NO             TO CERT-CERT.
 10600
 10601     IF CERT-ALT-KEY-CHANGED
 10602         PERFORM 2050-KEY-UPDATE THRU 2050-EXIT
 10603     ELSE
 10604         PERFORM 2040-NORMAL-UPDATE THRU 2040-EXIT.
 10605
 10606 2000-EXIT.
 10607     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 195
* EL131.cbl
 10609 2010-RELEASE-REC.
 10610
 10611* EXEC CICS UNLOCK
 10612*         DATASET  (CLMS-FILE-ID)
 10613*    END-EXEC
 10614*    MOVE '&*                    #   #00009838' TO DFHEIV0
 10615     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 10616     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10617     MOVE X'2020233030303039383338' TO DFHEIV0(25:11)
 10618     CALL 'kxdfhei1' USING DFHEIV0,
 10619           CLMS-FILE-ID,
 10620           DFHEIV99
 10621     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10622
 10623     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10624     MOVE 'X'                    TO ERROR-SWITCH.
 10625
 10626 2010-EXIT.
 10627     EXIT.
 10628
 10629 2020-NORMAL-UPDATE.
 10630     PERFORM 2600-CREATE-MAINT-NOTE THRU 2600-EXIT.
 10631
 10632     PERFORM 2100-MOVE-MSTR THRU 2100-EXIT.
 10633
 10634     IF WS-OPEN-CLOSE-SW = 'Y'
 10635       PERFORM  7800-CHECK-AUTO-ACTIVITY THRU 7800-EXIT
 10636       IF PI-REC-FOUND-SW = 'Y'
 10637         IF CL-ACTIVITY-CODE = 09
 10638           NEXT SENTENCE
 10639         ELSE
 10640           IF WS-RESET-SW = 'Y'
 10641             IF CL-CLAIM-STATUS = 'C'
 10642               MOVE 07               TO  CL-ACTIVITY-CODE
 10643               MOVE SAVE-BIN-DATE    TO  CL-ACTIVITY-MAINT-DT
 10644               MOVE 'CLOS'           TO  CL-ACTIVITY-MAINT-TYPE
 10645             ELSE
 10646               MOVE 08               TO  CL-ACTIVITY-CODE
 10647               MOVE SAVE-BIN-DATE    TO  CL-ACTIVITY-MAINT-DT
 10648               MOVE 'OPEN'           TO  CL-ACTIVITY-MAINT-TYPE.
 10649
 10650     IF PI-COMPANY-ID = 'CID' or 'AHL'
 10651         MOVE 'Y'                TO CL-YESNOSW
 10652     END-IF.
 10653
 10654     if pi-company-id = 'DCC' OR 'VPP'
 10655        perform 1620-VERIFY-ACCT THRU 1620-EXIT
 10656        perform 2120-check-pdef  thru 2120-exit
 10657     end-if
 10658     if ((benperl <> zeros)
 10659        and (benperi numeric))
 10660                  or
 10661            (instypel <> zeros)
 10662        perform 2140-update-elcrtt thru 2140-exit
 10663     end-if
 10664
 10665* EXEC CICS HANDLE CONDITION
 10666*         DUPKEY   (2020-EXIT)
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 196
* EL131.cbl
 10667*    END-EXEC.
 10668*    MOVE '"$$                   ! , #00009883' TO DFHEIV0
 10669     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10670     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10671     MOVE X'2C20233030303039383833' TO DFHEIV0(25:11)
 10672     CALL 'kxdfhei1' USING DFHEIV0
 10673     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10674
 10675
 10676
 10677* EXEC CICS REWRITE
 10678*         DATASET   (CLMS-FILE-ID)
 10679*         FROM      (CLAIM-MASTER)
 10680*    END-EXEC.
 10681     MOVE LENGTH OF
 10682      CLAIM-MASTER
 10683       TO DFHEIV11
 10684*    MOVE '&& L                  %   #00009887' TO DFHEIV0
 10685     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10686     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10687     MOVE X'2020233030303039383837' TO DFHEIV0(25:11)
 10688     CALL 'kxdfhei1' USING DFHEIV0,
 10689           CLMS-FILE-ID,
 10690           CLAIM-MASTER,
 10691           DFHEIV11,
 10692           DFHEIV99
 10693     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10694
 10695
 10696 2020-EXIT.
 10697     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 197
* EL131.cbl
 10699 2030-KEY-UPDATE.
 10700     MOVE CLAIM-MASTER           TO JP-RECORD-AREA.
 10701
 10702
 10703* EXEC CICS DELETE
 10704*        DATASET  (CLMS-FILE-ID)
 10705*    END-EXEC.
 10706*    MOVE '&(                    &   #00009898' TO DFHEIV0
 10707     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 10708     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10709     MOVE X'2020233030303039383938' TO DFHEIV0(25:11)
 10710     CALL 'kxdfhei1' USING DFHEIV0,
 10711           CLMS-FILE-ID,
 10712           DFHEIV99,
 10713           DFHEIV99,
 10714           DFHEIV99,
 10715           DFHEIV99
 10716     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10717
 10718
 10719
 10720* EXEC CICS GETMAIN
 10721*         SET      (ADDRESS OF CLAIM-MASTER)
 10722*         LENGTH   (MSTR-LENGTH)
 10723*         INITIMG  (GETMAIN-SPACE)
 10724*    END-EXEC.
 10725*    MOVE ',"IL                  $   #00009902' TO DFHEIV0
 10726     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 10727     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10728     MOVE X'2020233030303039393032' TO DFHEIV0(25:11)
 10729     CALL 'kxdfhei1' USING DFHEIV0,
 10730           DFHEIV20,
 10731           MSTR-LENGTH,
 10732           GETMAIN-SPACE
 10733     SET ADDRESS OF CLAIM-MASTER TO
 10734         DFHEIV20
 10735     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10736
 10737
 10738     MOVE JP-RECORD-AREA         TO CLAIM-MASTER.
 10739
 10740     PERFORM 2600-CREATE-MAINT-NOTE THRU 2600-EXIT.
 10741
 10742     PERFORM 2100-MOVE-MSTR THRU 2100-EXIT.
 10743
 10744     IF WS-OPEN-CLOSE-SW = 'Y'
 10745       PERFORM 7800-CHECK-AUTO-ACTIVITY THRU 7800-EXIT
 10746         IF PI-REC-FOUND-SW = 'Y'
 10747           IF CL-ACTIVITY-CODE = 09
 10748             NEXT SENTENCE
 10749           ELSE
 10750             IF WS-RESET-SW = 'Y'
 10751               IF CL-CLAIM-STATUS = 'C'
 10752                 MOVE 07             TO  CL-ACTIVITY-CODE
 10753                 MOVE SAVE-BIN-DATE  TO  CL-ACTIVITY-MAINT-DT
 10754                 MOVE 'CLOS'         TO  CL-ACTIVITY-MAINT-TYPE
 10755               ELSE
 10756                 MOVE 08             TO  CL-ACTIVITY-CODE
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 198
* EL131.cbl
 10757                 MOVE SAVE-BIN-DATE  TO  CL-ACTIVITY-MAINT-DT
 10758                 MOVE 'OPEN'         TO  CL-ACTIVITY-MAINT-TYPE.
 10759
 10760
 10761* EXEC CICS HANDLE CONDITION
 10762*         DUPKEY    (2030-EXIT)
 10763*    END-EXEC.
 10764*    MOVE '"$$                   ! - #00009930' TO DFHEIV0
 10765     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10766     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10767     MOVE X'2D20233030303039393330' TO DFHEIV0(25:11)
 10768     CALL 'kxdfhei1' USING DFHEIV0
 10769     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10770
 10771
 10772** POPULATE THE CREDIT-CARD NO WITH THE CERT NO.
 10773*    MOVE CL-CERT-NO             TO CL-CCN-A5.
 10774
 10775     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 10776         MOVE 'Y'                TO CL-YESNOSW
 10777     END-IF.
 10778
 10779
 10780* EXEC CICS WRITE
 10781*         DATASET   (CLMS-FILE-ID)
 10782*         RIDFLD    (MSTR-KEY)
 10783*         FROM      (CLAIM-MASTER)
 10784*    END-EXEC.
 10785     MOVE LENGTH OF
 10786      CLAIM-MASTER
 10787       TO DFHEIV11
 10788*    MOVE '&$ L                  ''   #00009941' TO DFHEIV0
 10789     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10790     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10791     MOVE X'2020233030303039393431' TO DFHEIV0(25:11)
 10792     CALL 'kxdfhei1' USING DFHEIV0,
 10793           CLMS-FILE-ID,
 10794           CLAIM-MASTER,
 10795           DFHEIV11,
 10796           MSTR-KEY,
 10797           DFHEIV99,
 10798           DFHEIV99
 10799     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10800
 10801
 10802 2030-EXIT.
 10803     EXIT.
 10804
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 199
* EL131.cbl
 10806 2040-NORMAL-UPDATE.
 10807
 10808* EXEC CICS READ UPDATE
 10809*         DATASET  (CERT-FILE-ID)
 10810*         RIDFLD   (CERT-KEY)
 10811*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 10812*    END-EXEC.
 10813*    MOVE '&"S        EU         (   #00009952' TO DFHEIV0
 10814     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10815     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10816     MOVE X'2020233030303039393532' TO DFHEIV0(25:11)
 10817     CALL 'kxdfhei1' USING DFHEIV0,
 10818           CERT-FILE-ID,
 10819           DFHEIV20,
 10820           DFHEIV99,
 10821           CERT-KEY,
 10822           DFHEIV99,
 10823           DFHEIV99,
 10824           DFHEIV99
 10825     SET ADDRESS OF CERTIFICATE-MASTER TO
 10826         DFHEIV20
 10827     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10828
 10829
 10830     PERFORM 2200-MOVE-CERT THRU 2200-EXIT.
 10831
 10832
 10833* EXEC CICS HANDLE CONDITION
 10834*         DUPKEY   (2040-EXIT)
 10835*    END-EXEC.
 10836*    MOVE '"$$                   ! . #00009960' TO DFHEIV0
 10837     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10838     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10839     MOVE X'2E20233030303039393630' TO DFHEIV0(25:11)
 10840     CALL 'kxdfhei1' USING DFHEIV0
 10841     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10842
 10843
 10844
 10845* EXEC CICS REWRITE
 10846*         DATASET  (CERT-FILE-ID)
 10847*         FROM     (CERTIFICATE-MASTER)
 10848*    END-EXEC.
 10849     MOVE LENGTH OF
 10850      CERTIFICATE-MASTER
 10851       TO DFHEIV11
 10852*    MOVE '&& L                  %   #00009964' TO DFHEIV0
 10853     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10854     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10855     MOVE X'2020233030303039393634' TO DFHEIV0(25:11)
 10856     CALL 'kxdfhei1' USING DFHEIV0,
 10857           CERT-FILE-ID,
 10858           CERTIFICATE-MASTER,
 10859           DFHEIV11,
 10860           DFHEIV99
 10861     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10862
 10863
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 200
* EL131.cbl
 10864 2040-EXIT.
 10865     EXIT.
 10866
 10867 2050-KEY-UPDATE.
 10868
 10869* EXEC CICS READ UPDATE
 10870*         DATASET  (CERT-FILE-ID)
 10871*         RIDFLD   (CERT-KEY)
 10872*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 10873*    END-EXEC.
 10874*    MOVE '&"S        EU         (   #00009973' TO DFHEIV0
 10875     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10876     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10877     MOVE X'2020233030303039393733' TO DFHEIV0(25:11)
 10878     CALL 'kxdfhei1' USING DFHEIV0,
 10879           CERT-FILE-ID,
 10880           DFHEIV20,
 10881           DFHEIV99,
 10882           CERT-KEY,
 10883           DFHEIV99,
 10884           DFHEIV99,
 10885           DFHEIV99
 10886     SET ADDRESS OF CERTIFICATE-MASTER TO
 10887         DFHEIV20
 10888     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10889
 10890
 10891     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 10892
 10893
 10894* EXEC CICS DELETE
 10895*         DATASET   (CERT-FILE-ID)
 10896*    END-EXEC.
 10897*    MOVE '&(                    &   #00009981' TO DFHEIV0
 10898     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 10899     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10900     MOVE X'2020233030303039393831' TO DFHEIV0(25:11)
 10901     CALL 'kxdfhei1' USING DFHEIV0,
 10902           CERT-FILE-ID,
 10903           DFHEIV99,
 10904           DFHEIV99,
 10905           DFHEIV99,
 10906           DFHEIV99
 10907     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10908
 10909
 10910
 10911* EXEC CICS GETMAIN
 10912*         SET       (ADDRESS OF CERTIFICATE-MASTER)
 10913*         LENGTH    (CERT-LENGTH)
 10914*         INITIMG   (GETMAIN-SPACE)
 10915*    END-EXEC.
 10916*    MOVE ',"IL                  $   #00009985' TO DFHEIV0
 10917     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 10918     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10919     MOVE X'2020233030303039393835' TO DFHEIV0(25:11)
 10920     CALL 'kxdfhei1' USING DFHEIV0,
 10921           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 201
* EL131.cbl
 10922           CERT-LENGTH,
 10923           GETMAIN-SPACE
 10924     SET ADDRESS OF CERTIFICATE-MASTER TO
 10925         DFHEIV20
 10926     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10927
 10928
 10929     MOVE JP-RECORD-AREA         TO CERTIFICATE-MASTER.
 10930
 10931     PERFORM 2200-MOVE-CERT THRU 2200-EXIT.
 10932
 10933
 10934* EXEC CICS HANDLE CONDITION
 10935*         DUPKEY (2050-EXIT)
 10936*    END-EXEC.
 10937*    MOVE '"$$                   ! / #00009995' TO DFHEIV0
 10938     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10939     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10940     MOVE X'2F20233030303039393935' TO DFHEIV0(25:11)
 10941     CALL 'kxdfhei1' USING DFHEIV0
 10942     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10943
 10944
 10945
 10946* EXEC CICS WRITE
 10947*         DATASET  (CERT-FILE-ID)
 10948*         RIDFLD   (CERT-KEY)
 10949*         FROM     (CERTIFICATE-MASTER)
 10950*    END-EXEC.
 10951     MOVE LENGTH OF
 10952      CERTIFICATE-MASTER
 10953       TO DFHEIV11
 10954*    MOVE '&$ L                  ''   #00009999' TO DFHEIV0
 10955     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10956     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10957     MOVE X'2020233030303039393939' TO DFHEIV0(25:11)
 10958     CALL 'kxdfhei1' USING DFHEIV0,
 10959           CERT-FILE-ID,
 10960           CERTIFICATE-MASTER,
 10961           DFHEIV11,
 10962           CERT-KEY,
 10963           DFHEIV99,
 10964           DFHEIV99
 10965     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10966
 10967
 10968 2050-EXIT.
 10969     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 202
* EL131.cbl
 10971 2060-CHANGE-CERT.
 10972     MOVE PI-COMPANY-CD          TO CERT-COMPANY-CODE.
 10973     MOVE PI-CARRIER             TO CERT-CARRIER.
 10974     MOVE PI-GROUPING            TO CERT-GROUP.
 10975     MOVE PI-STATE               TO CERT-STATE.
 10976     MOVE PI-ACCOUNT             TO CERT-ACCOUNT.
 10977     MOVE PI-CERT-EFF-DT         TO CERT-DATE.
 10978     MOVE PI-CERT-NO             TO CERT-CERT.
 10979     IF CERTEFFI GREATER THAN LOW-VALUES
 10980         MOVE HOLD-EFF           TO CERT-DATE.
 10981     IF CERTACTI GREATER THAN LOW-VALUES
 10982         MOVE CERTACTI           TO CERT-ACCOUNT.
 10983     IF CERTSTI GREATER THAN LOW-VALUES
 10984         MOVE CERTSTI            TO CERT-STATE.
 10985     IF CERTCARI GREATER THAN LOW-VALUES
 10986         MOVE CERTCARI           TO CERT-CARRIER.
 10987     IF CERTGRPI GREATER THAN LOW-VALUES
 10988         MOVE CERTGRPI           TO CERT-GROUP.
 10989     IF CERTI GREATER THAN LOW-VALUES
 10990         MOVE CERTI              TO CERT-CERT-PRIME.
 10991     IF SUFXI GREATER THAN LOW-VALUES
 10992         MOVE SUFXI              TO CERT-CERT-SUFX.
 10993
 10994
 10995* EXEC CICS HANDLE CONDITION
 10996*         NOTFND   (2060-CERT-NOTFND)
 10997*    END-EXEC.
 10998*    MOVE '"$I                   ! 0 #00010031' TO DFHEIV0
 10999     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11000     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11001     MOVE X'3020233030303130303331' TO DFHEIV0(25:11)
 11002     CALL 'kxdfhei1' USING DFHEIV0
 11003     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11004
 11005
 11006
 11007* EXEC CICS READ UPDATE
 11008*         DATASET  (CERT-FILE-ID)
 11009*         RIDFLD   (CERT-KEY)
 11010*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 11011*    END-EXEC.
 11012*    MOVE '&"S        EU         (   #00010035' TO DFHEIV0
 11013     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11014     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11015     MOVE X'2020233030303130303335' TO DFHEIV0(25:11)
 11016     CALL 'kxdfhei1' USING DFHEIV0,
 11017           CERT-FILE-ID,
 11018           DFHEIV20,
 11019           DFHEIV99,
 11020           CERT-KEY,
 11021           DFHEIV99,
 11022           DFHEIV99,
 11023           DFHEIV99
 11024     SET ADDRESS OF CERTIFICATE-MASTER TO
 11025         DFHEIV20
 11026     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11027
 11028
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 203
* EL131.cbl
 11029     ADD 1                       TO CM-CLAIM-ATTACHED-COUNT.
 11030
 11031     IF CM-CLAIM-INTERFACE-SW = SPACES
 11032        MOVE '1'   TO CM-CLAIM-INTERFACE-SW PI-CERT-SWITCH.
 11033
 11034
 11035* EXEC CICS HANDLE CONDITION
 11036*         DUPKEY   (2060-DUPKEY)
 11037*    END-EXEC.
 11038*    MOVE '"$$                   ! 1 #00010046' TO DFHEIV0
 11039     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 11040     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11041     MOVE X'3120233030303130303436' TO DFHEIV0(25:11)
 11042     CALL 'kxdfhei1' USING DFHEIV0
 11043     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11044
 11045
 11046
 11047* EXEC CICS REWRITE
 11048*         DATASET  (CERT-FILE-ID)
 11049*         FROM     (CERTIFICATE-MASTER)
 11050*    END-EXEC.
 11051     MOVE LENGTH OF
 11052      CERTIFICATE-MASTER
 11053       TO DFHEIV11
 11054*    MOVE '&& L                  %   #00010050' TO DFHEIV0
 11055     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11056     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11057     MOVE X'2020233030303130303530' TO DFHEIV0(25:11)
 11058     CALL 'kxdfhei1' USING DFHEIV0,
 11059           CERT-FILE-ID,
 11060           CERTIFICATE-MASTER,
 11061           DFHEIV11,
 11062           DFHEIV99
 11063     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11064
 11065
 11066 2060-DUPKEY.
 11067
 11068     PERFORM 2070-CHECK-OLD THRU 2070-EXIT.
 11069
 11070 2060-CHANGE-TRLR-ACTQ.
 11071     IF SCREEN-ERROR
 11072         GO TO 2060-EXIT.
 11073
 11074     IF CERTI    GREATER LOW-VALUES OR
 11075        SUFXI    GREATER LOW-VALUES OR
 11076        CERTCARI GREATER LOW-VALUES
 11077         PERFORM 2400-UPDATE-TRLR THRU 2400-EXIT
 11078         PERFORM 2430-UPDATE-ACTQ THRU 2430-EXIT.
 11079
 11080     MOVE SPACES                 TO CERT-KEY-SWITCH
 11081                                    CERT-SWITCH
 11082                                    TRLR-SWITCH
 11083                                    NINETY-TRLR-SWITCH.
 11084     MOVE 'X' TO MSTR-KEY-SWITCH MSTR-SWITCH.
 11085     GO TO 2060-EXIT.
 11086
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 204
* EL131.cbl
 11087 2060-CERT-NOTFND.
 11088     PERFORM 2070-CHECK-OLD THRU 2070-EXIT.
 11089
 11090     IF WS-REC-FOUND-SW = 'N'
 11091         MOVE ER-0206            TO  EMI-ERROR
 11092         MOVE -1                 TO  MAINTL
 11093         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11094
 11095* EXEC CICS UNLOCK
 11096*            DATASET   (CLMS-FILE-ID)
 11097*        END-EXEC
 11098*    MOVE '&*                    #   #00010083' TO DFHEIV0
 11099     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 11100     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 11101     MOVE X'2020233030303130303833' TO DFHEIV0(25:11)
 11102     CALL 'kxdfhei1' USING DFHEIV0,
 11103           CLMS-FILE-ID,
 11104           DFHEIV99
 11105     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11106         GO TO 8110-SEND-DATA.
 11107
 11108     PERFORM 2080-CREATE-CERT THRU 2080-EXIT.
 11109
 11110     GO TO 2060-CHANGE-TRLR-ACTQ.
 11111
 11112 2060-EXIT.
 11113     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 205
* EL131.cbl
 11115 2070-CHECK-OLD.
 11116
 11117
 11118* EXEC CICS HANDLE CONDITION
 11119*        NOTFND   (2070-NOT-FOUND)
 11120*    END-EXEC.
 11121*    MOVE '"$I                   ! 2 #00010097' TO DFHEIV0
 11122     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11123     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11124     MOVE X'3220233030303130303937' TO DFHEIV0(25:11)
 11125     CALL 'kxdfhei1' USING DFHEIV0
 11126     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11127
 11128
 11129     MOVE PI-COMPANY-CD          TO CERT-COMPANY-CODE.
 11130     MOVE PI-CARRIER             TO CERT-CARRIER.
 11131     MOVE PI-GROUPING            TO CERT-GROUP.
 11132     MOVE PI-STATE               TO CERT-STATE.
 11133     MOVE PI-ACCOUNT             TO CERT-ACCOUNT.
 11134     MOVE PI-CERT-EFF-DT         TO CERT-DATE.
 11135     MOVE PI-CERT-NO             TO CERT-CERT.
 11136
 11137
 11138* EXEC CICS READ UPDATE
 11139*         DATASET  (CERT-FILE-ID)
 11140*         RIDFLD   (CERT-KEY)
 11141*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 11142*    END-EXEC.
 11143*    MOVE '&"S        EU         (   #00010109' TO DFHEIV0
 11144     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11145     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11146     MOVE X'2020233030303130313039' TO DFHEIV0(25:11)
 11147     CALL 'kxdfhei1' USING DFHEIV0,
 11148           CERT-FILE-ID,
 11149           DFHEIV20,
 11150           DFHEIV99,
 11151           CERT-KEY,
 11152           DFHEIV99,
 11153           DFHEIV99,
 11154           DFHEIV99
 11155     SET ADDRESS OF CERTIFICATE-MASTER TO
 11156         DFHEIV20
 11157     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11158
 11159
 11160     MOVE 'Y'                    TO WS-REC-FOUND-SW.
 11161     MOVE CERTIFICATE-MASTER     TO SAVE-RECORD.
 11162     SUBTRACT 1                  FROM CM-CLAIM-ATTACHED-COUNT.
 11163
 11164     IF CM-CLAIM-ATTACHED-COUNT LESS THAN ZERO
 11165         MOVE ZERO               TO CM-CLAIM-ATTACHED-COUNT.
 11166
 11167     IF CM-CLAIM-ATTACHED-COUNT = ZERO
 11168       AND
 11169        CERT-WAS-CREATED-FOR-CLAIM
 11170         MOVE CERTIFICATE-MASTER TO JP-RECORD-AREA
 11171
 11172* EXEC CICS DELETE
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 206
* EL131.cbl
 11173*             DATASET   (CERT-FILE-ID)
 11174*        END-EXEC
 11175*    MOVE '&(                    &   #00010126' TO DFHEIV0
 11176     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 11177     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11178     MOVE X'2020233030303130313236' TO DFHEIV0(25:11)
 11179     CALL 'kxdfhei1' USING DFHEIV0,
 11180           CERT-FILE-ID,
 11181           DFHEIV99,
 11182           DFHEIV99,
 11183           DFHEIV99,
 11184           DFHEIV99
 11185     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11186         GO TO 2070-EXIT.
 11187
 11188     IF CM-CLAIM-ATTACHED-COUNT = ZERO
 11189         MOVE SPACE TO CM-CLAIM-INTERFACE-SW PI-CERT-SWITCH.
 11190
 11191
 11192* EXEC CICS HANDLE CONDITION
 11193*         DUPKEY   (2070-EXIT)
 11194*    END-EXEC.
 11195*    MOVE '"$$                   ! 3 #00010134' TO DFHEIV0
 11196     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 11197     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11198     MOVE X'3320233030303130313334' TO DFHEIV0(25:11)
 11199     CALL 'kxdfhei1' USING DFHEIV0
 11200     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11201
 11202
 11203
 11204* EXEC CICS REWRITE
 11205*         DATASET  (CERT-FILE-ID)
 11206*         FROM     (CERTIFICATE-MASTER)
 11207*    END-EXEC.
 11208     MOVE LENGTH OF
 11209      CERTIFICATE-MASTER
 11210       TO DFHEIV11
 11211*    MOVE '&& L                  %   #00010138' TO DFHEIV0
 11212     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11213     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11214     MOVE X'2020233030303130313338' TO DFHEIV0(25:11)
 11215     CALL 'kxdfhei1' USING DFHEIV0,
 11216           CERT-FILE-ID,
 11217           CERTIFICATE-MASTER,
 11218           DFHEIV11,
 11219           DFHEIV99
 11220     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11221
 11222
 11223     GO TO 2070-EXIT.
 11224
 11225 2070-NOT-FOUND.
 11226     MOVE 'N'                        TO  WS-REC-FOUND-SW.
 11227
 11228 2070-EXIT.
 11229     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 207
* EL131.cbl
 11231 2080-CREATE-CERT.
 11232
 11233* EXEC CICS GETMAIN
 11234*         SET       (ADDRESS OF CERTIFICATE-MASTER)
 11235*         LENGTH    (CERT-LENGTH)
 11236*         INITIMG   (GETMAIN-SPACE)
 11237*    END-EXEC.
 11238*    MOVE ',"IL                  $   #00010152' TO DFHEIV0
 11239     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11240     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11241     MOVE X'2020233030303130313532' TO DFHEIV0(25:11)
 11242     CALL 'kxdfhei1' USING DFHEIV0,
 11243           DFHEIV20,
 11244           CERT-LENGTH,
 11245           GETMAIN-SPACE
 11246     SET ADDRESS OF CERTIFICATE-MASTER TO
 11247         DFHEIV20
 11248     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11249
 11250
 11251     MOVE SAVE-RECORD            TO CERTIFICATE-MASTER.
 11252
 11253     IF CERTEFFI GREATER THAN LOW-VALUES
 11254         MOVE HOLD-EFF           TO CERT-DATE CM-CERT-EFF-DT
 11255                                    DC-BIN-DATE-1
 11256         MOVE '6'                TO DC-OPTION-CODE
 11257         MOVE +1                 TO DC-ELAPSED-MONTHS
 11258         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 11259         IF NO-CONVERSION-ERROR
 11260             MOVE DC-BIN-DATE-2  TO CM-LOAN-1ST-PMT-DT.
 11261
 11262     IF CERTACTI GREATER THAN LOW-VALUES
 11263         MOVE CERTACTI           TO CERT-ACCOUNT CM-ACCOUNT.
 11264     IF CERTSTI GREATER THAN LOW-VALUES
 11265         MOVE CERTSTI            TO CERT-STATE CM-STATE.
 11266     IF CERTCARI GREATER THAN LOW-VALUES
 11267         MOVE CERTCARI           TO CERT-CARRIER CM-CARRIER.
 11268     IF CERTGRPI GREATER THAN LOW-VALUES
 11269         MOVE CERTGRPI           TO CERT-GROUP CM-GROUPING.
 11270     IF CERTI GREATER THAN LOW-VALUES
 11271         MOVE CERTI              TO CERT-CERT-PRIME
 11272                                    CM-CERT-PRIME
 11273         MOVE CM-CERT-NO         TO CM-CERT-NO-A4.
 11274
 11275     IF SUFXI GREATER THAN LOW-VALUES
 11276         MOVE SUFXI              TO CERT-CERT-SUFX
 11277                                    CM-CERT-SFX
 11278         MOVE CM-CERT-NO         TO CM-CERT-NO-A4.
 11279
 11280     PERFORM 2200-MOVE-CERT THRU 2200-EXIT.
 11281
 11282     MOVE LOW-VALUES             TO CM-LAST-MONTH-END.
 11283
 11284     MOVE SPACES                 TO CM-ENTRY-BATCH
 11285                                    CM-LF-EXIT-BATCH
 11286                                    CM-AH-EXIT-BATCH
 11287                                    CM-CREDIT-INTERFACE-SW-1
 11288                                    CM-CREDIT-INTERFACE-SW-2.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 208
* EL131.cbl
 11289
 11290     IF CM-LF-CURRENT-STATUS = '2' OR '3' OR '4' OR '5' OR
 11291                               '9' OR 'D' OR 'V'
 11292         MOVE '1'                TO CM-LF-CURRENT-STATUS.
 11293
 11294     IF CM-AH-CURRENT-STATUS = '2' OR '3' OR '4' OR '5' OR
 11295                               '9' OR 'D' OR 'V'
 11296         MOVE '1'                TO CM-AH-CURRENT-STATUS.
 11297
 11298     MOVE '2'                    TO CM-CLAIM-INTERFACE-SW
 11299                                    CL-CERT-ORIGIN PI-CERT-SWITCH.
 11300     MOVE 1                      TO CM-CLAIM-ATTACHED-COUNT.
 11301
 11302
 11303* EXEC CICS HANDLE CONDITION
 11304*         DUPKEY (2080-EXIT)
 11305*    END-EXEC.
 11306*    MOVE '"$$                   ! 4 #00010209' TO DFHEIV0
 11307     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 11308     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11309     MOVE X'3420233030303130323039' TO DFHEIV0(25:11)
 11310     CALL 'kxdfhei1' USING DFHEIV0
 11311     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11312
 11313
 11314
 11315* EXEC CICS WRITE
 11316*         DATASET  (CERT-FILE-ID)
 11317*         RIDFLD   (CERT-KEY)
 11318*         FROM     (CERTIFICATE-MASTER)
 11319*    END-EXEC.
 11320     MOVE LENGTH OF
 11321      CERTIFICATE-MASTER
 11322       TO DFHEIV11
 11323*    MOVE '&$ L                  ''   #00010213' TO DFHEIV0
 11324     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11325     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11326     MOVE X'2020233030303130323133' TO DFHEIV0(25:11)
 11327     CALL 'kxdfhei1' USING DFHEIV0,
 11328           CERT-FILE-ID,
 11329           CERTIFICATE-MASTER,
 11330           DFHEIV11,
 11331           CERT-KEY,
 11332           DFHEIV99,
 11333           DFHEIV99
 11334     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11335
 11336
 11337 2080-EXIT.
 11338     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 209
* EL131.cbl
 11340 2100-MOVE-MSTR.
 11341     IF TYPEI GREATER THAN LOW-VALUES
 11342         MOVE TYPEI              TO CL-CLAIM-TYPE.
 11343
 11344     IF STATUSI = LOW-VALUES
 11345         GO TO 2100-NO-STATUS-CHANGE.
 11346
 11347     IF STATUSI = 'OPEN' OR 'O'
 11348         IF CL-CLAIM-STATUS = 'O'
 11349             MOVE SPACES         TO TRLR-SWITCH
 11350                 GO TO 2100-NO-STATUS-CHANGE.
 11351
 11352     IF STATUSI = 'CLOSED' OR 'C'
 11353         IF CL-CLAIM-STATUS = 'C'
 11354             MOVE SPACES         TO TRLR-SWITCH
 11355                 GO TO 2100-NO-STATUS-CHANGE.
 11356
 11357     IF PI-COMPANY-ID = 'DMD'
 11358        IF STATUSI = 'OPEN' OR 'O'
 11359           IF CL-LAST-CLOSE-REASON = 'C' OR 'E'
 11360              MOVE ZERO       TO STATUSL
 11361              MOVE LOW-VALUES TO STATUSI
 11362              GO TO 2100-NO-STATUS-CHANGE.
 11363
 11364     IF PI-COMPANY-ID = 'DMD'
 11365         PERFORM 8000-CREATE-DMO-REC THRU 8000-EXIT.
 11366
 11367     MOVE STATUSI                TO CL-CLAIM-STATUS.
 11368
 11369 2100-NO-STATUS-CHANGE.
 11370
 11371     IF CCNOI GREATER THAN LOW-VALUES
 11372         MOVE CCNOI              TO CL-CCN.
 11373
 11374     IF PROCI GREATER THAN LOW-VALUES
 11375         MOVE PROCI              TO CL-PROCESSOR-ID.
 11376
 11377     if (accswi > low-values)
 11378        and (accswi = 'Y' OR 'N')
 11379        move accswi              to cl-accident-claim-sw
 11380     end-if
 11381     if benperi > low-values
 11382        and benperi numeric
 11383        move benperi             to cl-benefit-period
 11384     end-if
 11385     if instypei > low-values
 11386        move instypei            to cl-insured-type
 11387     end-if
 11388     IF SEXI GREATER THAN LOW-VALUES
 11389         MOVE SEXI               TO CL-INSURED-SEX-CD.
 11390
 11391     IF BIRTHI GREATER THAN LOW-VALUES
 11392         MOVE HOLD-BIRTH         TO CL-INSURED-BIRTH-DT.
 11393
 11394     IF SOCIALI GREATER THAN LOW-VALUES
 11395       AND
 11396        SOCIALI = SPACES
 11397         MOVE CL-CERT-STATE      TO CL-SSN-STATE
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 210
* EL131.cbl
 11398         MOVE CL-CERT-ACCOUNT-PRIME   TO CL-SSN-ACCOUNT
 11399         MOVE CL-INSURED-LAST-NAME   TO CL-SSN-LN3
 11400     ELSE
 11401         IF SOCIALI GREATER THAN LOW-VALUES
 11402             MOVE SOCIALI        TO CL-SOC-SEC-NO.
 11403
 11404     IF OCCI GREATER THAN LOW-VALUES
 11405         MOVE OCCI               TO CL-INSURED-OCC-CD.
 11406
 11407     IF BENEL GREATER THAN ZERO
 11408         MOVE BENEI              TO CL-BENEFICIARY.
 11409
 11410     IF DIAGI GREATER THAN LOW-VALUES
 11411         MOVE DIAGI              TO WS-DIAGNOSIS.
 11412
 11413     IF ICD1I GREATER THAN LOW-VALUES
 11414         MOVE ICD1I              TO WS-ICD-CODE-1
 11415     END-IF.
 11416
 11417     IF ICD2I GREATER THAN LOW-VALUES
 11418         MOVE ICD2I              TO WS-ICD-CODE-2
 11419     END-IF.
 11420
 11421     IF PREMTYPI GREATER THAN LOW-VALUES
 11422         MOVE PREMTYPI           TO CL-CLAIM-PREM-TYPE.
 11423
 11424*    IF CAUSEI GREATER THAN LOW-VALUES
 11425*        MOVE CAUSEI             TO CL-CAUSE-CD.
 11426
 11427*    IF ENDI GREATER THAN LOW-VALUES
 11428*        MOVE HOLD-END           TO CL-EST-END-OF-DISAB-DT.
 11429
 11430     IF PDTHRUI GREATER THAN LOW-VALUES
 11431        MOVE HOLD-PDTHRU         TO CL-PAID-THRU-DT.
 11432
 11433     IF PDAMTL GREATER THAN +0
 11434        MOVE HOLD-PDAMT          TO CL-TOTAL-PAID-AMT.
 11435
 11436     IF NODAYSI GREATER THAN LOW-VALUES
 11437        MOVE HOLD-NODAYS         TO CL-NO-OF-DAYS-PAID.
 11438
 11439     IF NOPMTSI GREATER THAN LOW-VALUES
 11440        MOVE HOLD-NOPMTS         TO CL-NO-OF-PMTS-MADE.
 11441
 11442     IF FORMTYPI GREATER THAN LOW-VALUES
 11443        MOVE FORMTYPI            TO CL-PROG-FORM-TYPE.
 11444
 11445     IF INCI GREATER THAN LOW-VALUES
 11446        MOVE HOLD-INCUR          TO CL-INCURRED-DT.
 11447
 11448     IF REPI GREATER THAN LOW-VALUES
 11449        MOVE HOLD-REPORTED       TO CL-REPORTED-DT.
 11450
 11451     IF ADDONDTI GREATER THAN LOW-VALUES
 11452        MOVE HOLD-ADDON          TO CL-LAST-ADD-ON-DT.
 11453
 11454     IF PRICDI GREATER THAN LOW-VALUES
 11455         MOVE PRICDI             TO CL-PRIORITY-CD.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 211
* EL131.cbl
 11456
 11457     IF CRITPL  > ZEROS
 11458        MOVE CRITPI              TO CL-CRITICAL-PERIOD
 11459     END-IF
 11460
 11461     IF EXTENSL  > ZEROS
 11462        MOVE EXTENSI             TO CL-NO-OF-EXTENSIONS
 11463     END-IF
 11464*    IF CRITPTL > ZEROS
 11465*       MOVE CRITPTI             TO CL-CRIT-PER-RECURRENT
 11466*    END-IF
 11467
 11468*    IF RTWMOSL > ZEROS
 11469*       MOVE RTWMOSI             TO CL-CRIT-PER-RTW-MOS
 11470*    END-IF
 11471     IF FILETOI GREATER THAN LOW-VALUES
 11472         MOVE FILETOI            TO CL-FILE-LOCATION.
 11473
 11474     IF SUPVI GREATER THAN LOW-VALUES
 11475         MOVE SUPVI              TO CL-SUPV-ATTN-CD.
 11476
 11477     IF MLNAMEI GREATER THAN LOW-VALUES
 11478         MOVE MLNAMEI            TO CL-INSURED-LAST-NAME.
 11479
 11480     IF MFNAMEI GREATER THAN LOW-VALUES
 11481         MOVE MFNAMEI            TO CL-INSURED-1ST-NAME.
 11482
 11483     IF MMINITI GREATER THAN LOW-VALUES
 11484         MOVE MMINITI            TO CL-INSURED-MID-INIT.
 11485
 11486     IF CERTEFFI GREATER THAN LOW-VALUES
 11487         MOVE HOLD-EFF           TO CL-CERT-EFF-DT.
 11488
 11489     IF CERTACTI GREATER THAN LOW-VALUES
 11490         MOVE CERTACTI           TO CL-CERT-ACCOUNT.
 11491
 11492     IF CERTSTI GREATER THAN LOW-VALUES
 11493         MOVE CERTSTI            TO CL-CERT-STATE.
 11494
 11495     IF CERTCARI GREATER THAN LOW-VALUES
 11496         MOVE CERTCARI           TO CL-CERT-CARRIER CARRIER-CODE
 11497                                    CL-CARRIER.
 11498
 11499     IF CERTGRPI GREATER THAN LOW-VALUES
 11500         MOVE CERTGRPI           TO CL-CERT-GROUPING.
 11501
 11502     IF CERTI GREATER THAN LOW-VALUES
 11503         MOVE CERTI              TO CERT-NO-PRIME.
 11504
 11505     IF SUFXI GREATER THAN LOW-VALUES
 11506         MOVE SUFXI              TO CERT-NO-SUFX.
 11507
 11508     MOVE CERT-NO                TO CL-CERT-NO
 11509                                    CL-CERT-NO-A4.
 11510
 11511     IF PI-COMPANY-ID = 'FLA'
 11512          NEXT SENTENCE
 11513     ELSE
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 212
* EL131.cbl
 11514         MOVE SAVE-BIN-DATE      TO CL-LAST-MAINT-DT
 11515         MOVE PI-PROCESSOR-ID    TO CL-LAST-MAINT-USER
 11516         MOVE EIBTIME            TO CL-LAST-MAINT-HHMMSS
 11517         MOVE '3'                TO CL-LAST-MAINT-TYPE.
 11518
 11519     IF TRLR-UPDATE-REQUIRED
 11520        MOVE CL-CONTROL-PRIMARY TO TRLR-KEY
 11521        MOVE ZEROS              TO TRLR-SEQ-NO
 11522
 11523* EXEC CICS READ
 11524*            DATASET   (TRLR-FILE-ID)
 11525*            RIDFLD    (TRLR-KEY)
 11526*            SET       (ADDRESS OF ACTIVITY-TRAILERS)
 11527*       END-EXEC
 11528*    MOVE '&"S        E          (   #00010404' TO DFHEIV0
 11529     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11530     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11531     MOVE X'2020233030303130343034' TO DFHEIV0(25:11)
 11532     CALL 'kxdfhei1' USING DFHEIV0,
 11533           TRLR-FILE-ID,
 11534           DFHEIV20,
 11535           DFHEIV99,
 11536           TRLR-KEY,
 11537           DFHEIV99,
 11538           DFHEIV99,
 11539           DFHEIV99
 11540     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11541         DFHEIV20
 11542     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11543        IF AT-TRAILER-TYPE = '1'
 11544           MOVE +1 TO MISC-SUB
 11545           PERFORM 2100-BUMP-OPEN-CLOSE-HIST UNTIL
 11546           MISC-SUB GREATER THAN +6 OR
 11547           AT-OPEN-CLOSE-TYPE (MISC-SUB) = SPACES
 11548           IF MISC-SUB GREATER THAN +1
 11549              SUBTRACT +1 FROM MISC-SUB
 11550              IF AT-OPEN-CLOSE-TYPE (MISC-SUB) = STATUSI
 11551                 GO TO 2100-BYPASS-LAST-UPDATE.
 11552
 11553     IF TRLR-UPDATE-REQUIRED AND
 11554        CLAIM-IS-OPEN
 11555         MOVE SAVE-BIN-DATE      TO CL-LAST-REOPEN-DT
 11556     ELSE
 11557         IF TRLR-UPDATE-REQUIRED AND
 11558            CLAIM-IS-CLOSED
 11559             MOVE SAVE-BIN-DATE  TO CL-LAST-CLOSE-DT
 11560             MOVE '4'            TO CL-LAST-CLOSE-REASON.
 11561
 11562 2100-BYPASS-LAST-UPDATE.
 11563     MOVE EMI-FORCABLE-CTR       TO CL-FORCEABLE-ERROR-CNT.
 11564     MOVE EMI-FATAL-CTR          TO CL-FATAL-ERROR-CNT.
 11565
 11566     GO TO 2100-EXIT.
 11567
 11568 2100-BUMP-OPEN-CLOSE-HIST.
 11569     ADD +1                      TO MISC-SUB.
 11570
 11571 2100-EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 213
* EL131.cbl
 11572     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 214
* EL131.cbl
 11574 2120-check-pdef.
 11575     move +0                     to s1
 11576     MOVE ZEROS                  TO WS-MONTHS-BETWEEN
 11577     move spaces                 to ws-dcc-error-line
 11578     PERFORM 3997-GET-ERPDEF  THRU 3997-EXIT
 11579     IF ERPDEF-FOUND
 11580        perform 2130-check-trlr  thru 2130-exit
 11581        move +1                  to s1
 11582*       if cl-accident-claim-sw = ' '
 11583*          move er-1655             to ws-error-no (s1)
 11584*          add +1 to s1
 11585*       end-if
 11586        MOVE CL-CERT-EFF-DT      TO DC-BIN-DATE-1
 11587        MOVE cl-incurred-dt      TO DC-BIN-DATE-2
 11588        if (hold-incur > low-values)
 11589           and (incl > zeros)
 11590           and (hold-incur not = cl-incurred-dt)
 11591           move hold-incur       to dc-bin-date-2
 11592        end-if
 11593        MOVE '1'                 TO DC-OPTION-CODE
 11594        MOVE +0                  TO DC-ELAPSED-MONTHS
 11595                                    DC-ELAPSED-DAYS
 11596        PERFORM 9800-CONVERT-DATE
 11597                                 THRU 9800-EXIT
 11598        IF NO-CONVERSION-ERROR
 11599           MOVE DC-ELAPSED-MONTHS
 11600                                 TO WS-MONTHS-BETWEEN
 11601           IF DC-ELAPSED-DAYS > 1
 11602              ADD 1 TO WS-MONTHS-BETWEEN
 11603           END-IF
 11604        ELSE
 11605           display ' dte conv error ' dc-error-code
 11606           MOVE ZEROS            TO WS-MONTHS-BETWEEN
 11607        END-IF
 11608        IF (WS-EXCL-PERIOD = ZEROS)
 11609           OR (WS-MONTHS-BETWEEN = ZEROS)
 11610           CONTINUE
 11611        ELSE
 11612           IF WS-MONTHS-BETWEEN  <= WS-EXCL-PERIOD
 11613              MOVE ER-1651       TO ws-error-no (s1)
 11614              add +1             to s1
 11615           END-IF
 11616        END-IF
 11617        IF (WS-COV-ENDS = ZEROS)
 11618           OR (WS-MONTHS-BETWEEN = ZEROS)
 11619           CONTINUE
 11620        ELSE
 11621           IF WS-MONTHS-BETWEEN > WS-COV-ENDS
 11622              MOVE -1            TO MAINTL
 11623              MOVE ER-1653       TO ws-error-no (s1)
 11624              add +1 to s1
 11625           END-IF
 11626        END-IF
 11627        IF (WS-ACC-PERIOD = ZEROS)
 11628           OR (WS-MONTHS-BETWEEN = ZEROS)
 11629           CONTINUE
 11630        ELSE
 11631           IF (WS-MONTHS-BETWEEN <= WS-ACC-PERIOD)
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 215
* EL131.cbl
 11632              and (accswi = spaces or low-values)
 11633*             and (cl-accident-claim-sw = ' ')
 11634              move er-1655       to ws-error-no (s1)
 11635              add +1             to s1
 11636           end-if
 11637           IF WS-MONTHS-BETWEEN <= WS-ACC-PERIOD
 11638*             if (cl-accident-claim-sw not = 'Y')
 11639              if (accswi not = 'Y')
 11640                 MOVE ER-1652    TO ws-error-no (s1)
 11641              else
 11642                 move er-1662    to ws-error-no (s1)
 11643              end-if
 11644              MOVE -1            TO MAINTL
 11645              add +1             to s1
 11646           END-IF
 11647        END-IF
 11648        if cl-claim-type  = 'I'
 11649           move er-1661          to ws-error-no (s1)
 11650           add +1                to s1
 11651        end-if
 11652        perform 2130-check-trlr  thru 2130-exit
 11653     END-IF
 11654
 11655     .
 11656 2120-exit.
 11657     exit.
 11658
 11659 2130-check-trlr.
 11660
 11661     evaluate true
 11662        when s1 = +0
 11663           move cl-control-primary
 11664                                 to trlr-key
 11665           MOVE +95              TO TRLR-SEQ-NO
 11666
 11667* EXEC CICS READ
 11668*             update
 11669*             DATASET  ('ELTRLR')
 11670*             SET      (ADDRESS OF ACTIVITY-TRAILERS)
 11671*             RIDFLD   (TRLR-KEY)
 11672*             RESP     (WS-RESPONSE)
 11673*          END-EXEC
 11674     MOVE 'ELTRLR' TO DFHEIV1
 11675*    MOVE '&"S        EU         (  N#00010532' TO DFHEIV0
 11676     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11677     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11678     MOVE X'204E233030303130353332' TO DFHEIV0(25:11)
 11679     CALL 'kxdfhei1' USING DFHEIV0,
 11680           DFHEIV1,
 11681           DFHEIV20,
 11682           DFHEIV99,
 11683           TRLR-KEY,
 11684           DFHEIV99,
 11685           DFHEIV99,
 11686           DFHEIV99
 11687     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11688         DFHEIV20
 11689     MOVE EIBRESP  TO WS-RESPONSE
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 216
* EL131.cbl
 11690     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11691           if ws-resp-normal
 11692              move spaces        to at-info-line-1
 11693           end-if
 11694        when s1 = +1
 11695           if ws-resp-normal
 11696
 11697* exec cics rewrite
 11698*                dataset   ('ELTRLR')
 11699*                from      (activity-trailers)
 11700*             end-exec
 11701     MOVE LENGTH OF
 11702      activity-trailers
 11703       TO DFHEIV11
 11704     MOVE 'ELTRLR' TO DFHEIV1
 11705*    MOVE '&& L                  %   #00010544' TO DFHEIV0
 11706     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11707     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11708     MOVE X'2020233030303130353434' TO DFHEIV0(25:11)
 11709     CALL 'kxdfhei1' USING DFHEIV0,
 11710           DFHEIV1,
 11711           activity-trailers,
 11712           DFHEIV11,
 11713           DFHEIV99
 11714     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11715           end-if
 11716        when s1 > +1
 11717           if ws-resp-normal
 11718              move ws-dcc-error-line
 11719                                 to at-info-line-1
 11720
 11721* exec cics rewrite
 11722*                dataset   ('ELTRLR')
 11723*                from      (activity-trailers)
 11724*             end-exec
 11725     MOVE LENGTH OF
 11726      activity-trailers
 11727       TO DFHEIV11
 11728     MOVE 'ELTRLR' TO DFHEIV1
 11729*    MOVE '&& L                  %   #00010553' TO DFHEIV0
 11730     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11731     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11732     MOVE X'2020233030303130353533' TO DFHEIV0(25:11)
 11733     CALL 'kxdfhei1' USING DFHEIV0,
 11734           DFHEIV1,
 11735           activity-trailers,
 11736           DFHEIV11,
 11737           DFHEIV99
 11738     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11739           else
 11740
 11741* EXEC CICS GETMAIN
 11742*                SET      (ADDRESS OF ACTIVITY-TRAILERS)
 11743*                LENGTH   (TRLR-LENGTH)
 11744*                INITIMG  (GETMAIN-SPACE)
 11745*             END-EXEC
 11746*    MOVE ',"IL                  $   #00010558' TO DFHEIV0
 11747     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 217
* EL131.cbl
 11748     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11749     MOVE X'2020233030303130353538' TO DFHEIV0(25:11)
 11750     CALL 'kxdfhei1' USING DFHEIV0,
 11751           DFHEIV20,
 11752           TRLR-LENGTH,
 11753           GETMAIN-SPACE
 11754     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11755         DFHEIV20
 11756     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11757              move 'AT'          to at-record-id
 11758              move cl-control-primary
 11759                                 to at-control-primary
 11760              move +95           to at-sequence-no
 11761              move '6'           to at-trailer-type
 11762              move ws-dcc-error-line
 11763                                 to at-info-line-1
 11764              move 'E'           to at-info-trailer-type
 11765              move save-bin-date to at-recorded-dt
 11766                                    at-gen-info-last-maint-dt
 11767              move pi-processor-id
 11768                                 to at-recorded-by
 11769                                    at-gen-info-last-updated-by
 11770              move eibtime       to at-last-maint-hhmmss
 11771
 11772* exec cics write
 11773*                dataset   ('ELTRLR')
 11774*                from      (activity-trailers)
 11775*                ridfld    (trlr-key)
 11776*             end-exec
 11777     MOVE LENGTH OF
 11778      activity-trailers
 11779       TO DFHEIV11
 11780     MOVE 'ELTRLR' TO DFHEIV1
 11781*    MOVE '&$ L                  ''   #00010577' TO DFHEIV0
 11782     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11783     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11784     MOVE X'2020233030303130353737' TO DFHEIV0(25:11)
 11785     CALL 'kxdfhei1' USING DFHEIV0,
 11786           DFHEIV1,
 11787           activity-trailers,
 11788           DFHEIV11,
 11789           trlr-key,
 11790           DFHEIV99,
 11791           DFHEIV99
 11792     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11793              perform varying s1 from +1 by +1 until
 11794                 ws-error-no (s1) = spaces
 11795                 move ws-error-no (s1)
 11796                                 to emi-error
 11797                 PERFORM 9900-ERROR-FORMAT
 11798                                 THRU 9900-EXIT
 11799              end-perform
 11800           end-if
 11801     end-evaluate
 11802
 11803     .
 11804 2130-exit.
 11805     exit.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 218
* EL131.cbl
 11806 2140-update-elcrtt.
 11807     move ' '                    to crtt-switch
 11808     MOVE CERT-KEY               TO ELCRTT-KEY
 11809     MOVE 'B'                    TO CTRLR-REC-TYPE
 11810
 11811* EXEC CICS READ
 11812*       UPDATE
 11813*       DATASET   ('ELCRTT')
 11814*       RIDFLD    (ELCRTT-KEY)
 11815*       INTO      (CERTIFICATE-TRAILERS)
 11816*       RESP      (WS-RESPONSE)
 11817*    END-EXEC
 11818     MOVE LENGTH OF
 11819      CERTIFICATE-TRAILERS
 11820       TO DFHEIV11
 11821     MOVE 'ELCRTT' TO DFHEIV1
 11822*    MOVE '&"IL       EU         (  N#00010599' TO DFHEIV0
 11823     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11824     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11825     MOVE X'204E233030303130353939' TO DFHEIV0(25:11)
 11826     CALL 'kxdfhei1' USING DFHEIV0,
 11827           DFHEIV1,
 11828           CERTIFICATE-TRAILERS,
 11829           DFHEIV11,
 11830           ELCRTT-KEY,
 11831           DFHEIV99,
 11832           DFHEIV99,
 11833           DFHEIV99
 11834     MOVE EIBRESP  TO WS-RESPONSE
 11835     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11836     IF WS-RESP-NORMAL
 11837        perform varying s1 from +1 by +1 until
 11838           (s1 > +24)
 11839           or (cs-claim-no (s1) = cl-claim-no)
 11840        end-perform
 11841        if (s1 < +25)
 11842           if (benperl <> zeros)
 11843              and (cs-benefit-period (s1) not = benperi)
 11844              move benperi       to cs-benefit-period (s1)
 11845              set crtt-update    to true
 11846          end-if
 11847          if (instypel <> zeros)
 11848             and (instypei not = cs-insured-type (s1))
 11849             move instypei      to cs-insured-type (s1)
 11850             set crtt-update    to true
 11851          end-if
 11852          move cs-claim-type (s1) to ws-claim-type
 11853          move cs-benefit-period (s1) to ws-ben-per
 11854        end-if
 11855        if crtt-update
 11856           perform 2150-accum    thru 2150-exit
 11857
 11858* EXEC CICS REWRITE
 11859*             DATASET   ('ELCRTT')
 11860*             FROM      (CERTIFICATE-TRAILERS)
 11861*          END-EXEC
 11862     MOVE LENGTH OF
 11863      CERTIFICATE-TRAILERS
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 219
* EL131.cbl
 11864       TO DFHEIV11
 11865     MOVE 'ELCRTT' TO DFHEIV1
 11866*    MOVE '&& L                  %   #00010627' TO DFHEIV0
 11867     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11868     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11869     MOVE X'2020233030303130363237' TO DFHEIV0(25:11)
 11870     CALL 'kxdfhei1' USING DFHEIV0,
 11871           DFHEIV1,
 11872           CERTIFICATE-TRAILERS,
 11873           DFHEIV11,
 11874           DFHEIV99
 11875     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11876        else
 11877
 11878* exec cics unlock
 11879*             dataset   ('ELCRTT')
 11880*          end-exec
 11881     MOVE 'ELCRTT' TO DFHEIV1
 11882*    MOVE '&*                    #   #00010632' TO DFHEIV0
 11883     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 11884     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 11885     MOVE X'2020233030303130363332' TO DFHEIV0(25:11)
 11886     CALL 'kxdfhei1' USING DFHEIV0,
 11887           DFHEIV1,
 11888           DFHEIV99
 11889     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11890        end-if
 11891     end-if
 11892     .
 11893 2140-exit.
 11894     exit.
 11895 2150-accum.
 11896     if not erpdef-found
 11897        perform 3997-get-erpdef  thru 3997-exit
 11898     end-if
 11899     if (erpdef-found)
 11900        and (ws-max-moben not = zeros)
 11901        and (ws-max-moben < cm-ah-benefit-amt)
 11902        continue
 11903     else
 11904        move cm-ah-benefit-amt   to ws-max-moben
 11905     end-if
 11906     move cm-ah-orig-term        to ws-max-bens
 11907     if cl-critical-period not = zeros and spaces
 11908        move cl-critical-period  to ws-max-bens
 11909     end-if
 11910     move zeros to ws-tot-days-paid ws-tot-amt-paid
 11911     perform varying s2 from +1 by +1 until
 11912        (s2 > +24)
 11913        or (cs-claim-no (s2) = spaces)
 11914        if (cs-benefit-period (s2) = ws-ben-per)
 11915           and (cs-claim-type (s2) = ws-claim-type)
 11916           and (cs-insured-type (s2) = cl-insured-type)
 11917*          compute ws-tot-days-paid =
 11918*             ws-tot-days-paid + cs-days-paid (s2)
 11919           compute ws-tot-amt-paid =
 11920              ws-tot-amt-paid + cs-total-paid (s2)
 11921        end-if
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 220
* EL131.cbl
 11922     end-perform
 11923     if s2 < +25
 11924        compute ws-pd-bens rounded =
 11925           ws-tot-amt-paid / ws-max-moben
 11926        compute cs-remaining-bens (s1) =
 11927           ws-max-bens - ws-pd-bens
 11928        if cs-remaining-bens (s1) < zeros
 11929           move zeros            to cs-remaining-bens (s1)
 11930        end-if
 11931     end-if
 11932     .
 11933 2150-exit.
 11934     exit.
 11935 2200-MOVE-CERT.
 11936     IF CRTLNMEI GREATER THAN LOW-VALUES
 11937         MOVE CRTLNMEI           TO CM-INSURED-LAST-NAME.
 11938
 11939     IF CRTFNMEI GREATER THAN LOW-VALUES
 11940         MOVE CRTFNMEI           TO CM-INSURED-FIRST-NAME
 11941         MOVE CM-INSURED-1ST-INIT TO CM-INSURED-INITIAL1.
 11942
 11943     IF CRTINITI GREATER THAN LOW-VALUES
 11944         MOVE CRTINITI           TO CM-INSURED-INITIAL2.
 11945
 11946     IF CM-INSURED-INITIALS = SPACES
 11947         MOVE '**'               TO CM-INSURED-INITIALS.
 11948
 11949     IF ISSAGEI GREATER THAN LOW-VALUES
 11950         MOVE ISSAGEI            TO CM-INSURED-ISSUE-AGE.
 11951
 11952     IF JNTFNMEI GREATER THAN LOW-VALUES
 11953         MOVE JNTFNMEI           TO CM-JT-FIRST-NAME.
 11954
 11955     IF JNTLNMEI GREATER THAN LOW-VALUES
 11956         MOVE JNTLNMEI           TO CM-JT-LAST-NAME.
 11957
 11958     IF JNTINITI GREATER THAN LOW-VALUES
 11959         MOVE JNTINITI           TO CM-JT-INITIAL.
 11960
 11961     IF JNTAGEI GREATER THAN LOW-VALUES
 11962         MOVE JNTAGEI            TO CM-INSURED-JOINT-AGE.
 11963
 11964     IF ADDONDTI GREATER THAN LOW-VALUES
 11965        MOVE HOLD-ADDON          TO CM-LAST-ADD-ON-DT.
 11966
 11967     IF LCVCDI GREATER THAN LOW-VALUES
 11968        IF LCVCDI = SPACES OR ZEROS
 11969           MOVE ZEROS            TO CM-LF-BENEFIT-CD
 11970        ELSE
 11971           MOVE LCVCDI           TO CM-LF-BENEFIT-CD.
 11972
 11973     IF LCVOTRMI GREATER THAN LOW-VALUES
 11974         MOVE LCVOTRMI           TO CM-LF-ORIG-TERM.
 11975
 11976     IF LCVRATEL GREATER THAN +0
 11977         MOVE HOLD-LF-RATE       TO CM-LF-PREMIUM-RATE.
 11978
 11979     IF LCVBENEL GREATER THAN +0
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 221
* EL131.cbl
 11980         MOVE HOLD-LF-CV-BEN     TO CM-LF-BENEFIT-AMT.
 11981
 11982     IF LCVFORMI GREATER THAN LOW-VALUES
 11983         MOVE LCVFORMI           TO CM-POLICY-FORM-NO.
 11984
 11985     IF LCVCNDTI = LOW-VALUES
 11986        GO TO 2210-SET-STATUS.
 11987
 11988     IF HOLD-LF-CV-CAN NOT = LOW-VALUES
 11989        MOVE '8'                 TO CM-LF-CURRENT-STATUS
 11990        MOVE HOLD-LF-CV-CAN      TO CM-LF-CANCEL-DT
 11991        GO TO 2210-SET-STATUS.
 11992
 11993     IF CM-LF-CURRENT-STATUS = '7'
 11994        MOVE CM-LF-STATUS-AT-DEATH   TO CM-LF-CURRENT-STATUS
 11995        MOVE SPACES              TO CM-LF-STATUS-AT-DEATH
 11996        MOVE LOW-VALUES          TO CM-LF-DEATH-EXIT-DT
 11997                                    CM-LF-DEATH-DT
 11998        GO TO 2210-SET-STATUS.
 11999
 12000     IF CM-LF-CURRENT-STATUS = '8'
 12001        MOVE '1'                 TO CM-LF-CURRENT-STATUS
 12002        MOVE LOW-VALUES          TO CM-LF-DEATH-EXIT-DT
 12003                                    CM-LF-CANCEL-DT.
 12004
 12005 2210-SET-STATUS.
 12006
 12007     IF CM-LF-CURRENT-STATUS = SPACES
 12008         MOVE '1'                TO CM-LF-CURRENT-STATUS.
 12009
 12010     IF CM-LF-ORIG-TERM GREATER THAN ZERO
 12011         MOVE '6'                TO DC-OPTION-CODE
 12012         MOVE CM-LF-ORIG-TERM    TO DC-ELAPSED-MONTHS
 12013         MOVE CM-CERT-EFF-DT     TO DC-BIN-DATE-1
 12014         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12015         IF NO-CONVERSION-ERROR
 12016             MOVE DC-BIN-DATE-2  TO CM-LF-LOAN-EXPIRE-DT
 12017         ELSE
 12018             MOVE LOW-VALUES     TO CM-LF-LOAN-EXPIRE-DT
 12019     ELSE
 12020         MOVE LOW-VALUES         TO CM-LF-LOAN-EXPIRE-DT.
 12021
 12022 2215-PROCESS-AH-SIDE.
 12023
 12024     IF ACVCDI GREATER THAN LOW-VALUES
 12025        IF ACVCDI = SPACES OR ZEROS
 12026           MOVE ZEROS            TO CM-AH-BENEFIT-CD
 12027        ELSE
 12028           MOVE ACVCDI           TO CM-AH-BENEFIT-CD.
 12029
 12030     IF ACVOTRMI GREATER THAN LOW-VALUES
 12031         MOVE ACVOTRMI           TO CM-AH-ORIG-TERM.
 12032
 12033     IF ACVRATEL GREATER THAN +0
 12034         MOVE HOLD-AH-RATE       TO CM-AH-PREMIUM-RATE.
 12035
 12036     IF ACVBENEL GREATER THAN +0
 12037         MOVE HOLD-AH-CV-BEN     TO CM-AH-BENEFIT-AMT
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 222
* EL131.cbl
 12038                                    PI-PAYMENT-AMT.
 12039
 12040     IF ACVFORMI GREATER THAN LOW-VALUES
 12041         MOVE ACVFORMI           TO CM-POLICY-FORM-NO.
 12042
 12043     IF ACVCNDTI = LOW-VALUES
 12044        GO TO 2220-SET-STATUS.
 12045
 12046     IF HOLD-AH-CV-CAN NOT = LOW-VALUES
 12047        MOVE '8'                 TO CM-AH-CURRENT-STATUS
 12048        MOVE HOLD-AH-CV-CAN      TO CM-AH-CANCEL-DT
 12049        GO TO 2220-SET-STATUS.
 12050
 12051     IF CM-AH-CURRENT-STATUS = '6'
 12052        MOVE CM-AH-STATUS-AT-SETTLEMENT
 12053                                 TO CM-AH-CURRENT-STATUS
 12054        MOVE SPACES              TO CM-AH-STATUS-AT-SETTLEMENT
 12055        MOVE LOW-VALUES          TO CM-AH-SETTLEMENT-EXIT-DT
 12056                                    CM-AH-SETTLEMENT-DT
 12057        GO TO 2220-SET-STATUS.
 12058
 12059     IF CM-AH-CURRENT-STATUS = '8'
 12060        MOVE '1'                 TO CM-AH-CURRENT-STATUS
 12061        MOVE LOW-VALUES          TO CM-AH-SETTLEMENT-EXIT-DT
 12062                                    CM-AH-CANCEL-DT.
 12063
 12064 2220-SET-STATUS.
 12065     IF CM-AH-CURRENT-STATUS = SPACES
 12066         MOVE '1'                TO CM-AH-CURRENT-STATUS.
 12067
 12068     IF CM-AH-ORIG-TERM GREATER THAN ZERO
 12069         MOVE '6'                TO DC-OPTION-CODE
 12070         MOVE CM-AH-ORIG-TERM    TO DC-ELAPSED-MONTHS
 12071         MOVE CM-CERT-EFF-DT     TO DC-BIN-DATE-1
 12072         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12073         IF NO-CONVERSION-ERROR
 12074             MOVE DC-BIN-DATE-2  TO CM-AH-LOAN-EXPIRE-DT
 12075         ELSE
 12076             MOVE LOW-VALUES     TO CM-AH-LOAN-EXPIRE-DT
 12077     ELSE
 12078         MOVE LOW-VALUES         TO CM-AH-LOAN-EXPIRE-DT.
 12079
 12080 2225-FINISH-CERT.
 12081     IF APRL GREATER THAN +0
 12082         MOVE HOLD-APR           TO CM-LOAN-APR.
 12083
 12084     IF PMTFREQI GREATER THAN LOW-VALUES
 12085         MOVE PMTFREQI           TO CM-PAY-FREQUENCY.
 12086
 12087     IF INDGRPI GREATER THAN LOW-VALUES
 12088         MOVE INDGRPI            TO CM-IND-GRP-TYPE.
 12089
 12090*    IF LOANNOI GREATER THAN LOW-VALUES
 12091*       MOVE LOANNOI             TO CM-LOAN-NUMBER.
 12092
 12093     IF LOANBALL GREATER THAN +0
 12094        MOVE HOLD-LOANBAL        TO CM-LOAN-BALANCE.
 12095
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 223
* EL131.cbl
 12096     IF PREMTYPI GREATER THAN LOW-VALUES
 12097         MOVE PREMTYPI           TO CM-PREMIUM-TYPE.
 12098
 12099     IF REINCDI GREATER THAN LOW-VALUES
 12100         MOVE REINCDI            TO CM-SPECIAL-REIN-CODE
 12101                                    WS-REIN-1
 12102                                    WS-REIN-2
 12103                                    WS-REIN-3
 12104         MOVE WS-REIN-TABLE      TO CM-REIN-TABLE.
 12105
 12106     MOVE LOW-VALUES             TO CM-AH-PAID-THRU-DT.
 12107
 12108     MOVE ZEROS                  TO CM-LOAN-TERM
 12109                                    CM-LIFE-COMM-PCT
 12110                                    CM-AH-COMM-PCT.
 12111
 12112*    IF PI-COMPANY-ID = 'CRI' OR 'PEM' OR 'NCL'
 12113*      IF CM-PREMIUM-TYPE NOT = '1'  AND
 12114*         PI-NO-PMTS = ZEROS
 12115*          IF LOANBALL GREATER THAN +0          OR
 12116*             ACVBENEL GREATER THAN +0          OR
 12117*             APRL     GREATER THAN +0          OR
 12118*             LCVRATEL GREATER THAN +0          OR
 12119*             ACVRATEL GREATER THAN +0
 12120*               PERFORM 6000-CALCULATE-CERT-TERM THRU 6000-EXIT.
 12121
 12122 2200-EXIT.
 12123     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 224
* EL131.cbl
 12125 2300-UPDATE-TRLR.
 12126     MOVE ZERO                   TO TRLR-SEQ-NO.
 12127
 12128* EXEC CICS READ UPDATE
 12129*         DATASET  (TRLR-FILE-ID)
 12130*         RIDFLD   (TRLR-KEY)
 12131*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 12132*    END-EXEC.
 12133*    MOVE '&"S        EU         (   #00010872' TO DFHEIV0
 12134     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12135     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12136     MOVE X'2020233030303130383732' TO DFHEIV0(25:11)
 12137     CALL 'kxdfhei1' USING DFHEIV0,
 12138           TRLR-FILE-ID,
 12139           DFHEIV20,
 12140           DFHEIV99,
 12141           TRLR-KEY,
 12142           DFHEIV99,
 12143           DFHEIV99,
 12144           DFHEIV99
 12145     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12146         DFHEIV20
 12147     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12148
 12149
 12150     MOVE ZERO                   TO COUNT-2.
 12151
 12152     PERFORM 2310-INS-STATUS THRU 2310-EXIT
 12153         UNTIL UPDATE-MADE OR COUNT-2 GREATER THAN 6.
 12154
 12155     IF NOT UPDATE-MADE
 12156         PERFORM 2320-SHIFT-STATUS THRU 2320-EXIT.
 12157
 12158
 12159* EXEC CICS REWRITE
 12160*         DATASET  (TRLR-FILE-ID)
 12161*         FROM     (ACTIVITY-TRAILERS)
 12162*    END-EXEC.
 12163     MOVE LENGTH OF
 12164      ACTIVITY-TRAILERS
 12165       TO DFHEIV11
 12166*    MOVE '&& L                  %   #00010886' TO DFHEIV0
 12167     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12168     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12169     MOVE X'2020233030303130383836' TO DFHEIV0(25:11)
 12170     CALL 'kxdfhei1' USING DFHEIV0,
 12171           TRLR-FILE-ID,
 12172           ACTIVITY-TRAILERS,
 12173           DFHEIV11,
 12174           DFHEIV99
 12175     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12176
 12177
 12178 2300-EXIT.
 12179     EXIT.
 12180
 12181 2310-INS-STATUS.
 12182     ADD 1                       TO COUNT-2.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 225
* EL131.cbl
 12183     IF AT-OPEN-CLOSE-TYPE (COUNT-2) = SPACE
 12184         PERFORM 2330-ADD-UPDATE THRU 2330-EXIT
 12185         MOVE 'Y'                TO TRLR-SWITCH.
 12186
 12187 2310-EXIT.
 12188     EXIT.
 12189
 12190 2320-SHIFT-STATUS.
 12191     IF AT-OPEN-CLOSE-TYPE (6) = STATUSI
 12192        MOVE 6                   TO COUNT-2
 12193        GO TO 2320-EXIT.
 12194
 12195     MOVE AT-OPEN-CLOSE-HISTORY (2) TO AT-OPEN-CLOSE-HISTORY (1).
 12196     MOVE AT-OPEN-CLOSE-HISTORY (3) TO AT-OPEN-CLOSE-HISTORY (2).
 12197     MOVE AT-OPEN-CLOSE-HISTORY (4) TO AT-OPEN-CLOSE-HISTORY (3).
 12198     MOVE AT-OPEN-CLOSE-HISTORY (5) TO AT-OPEN-CLOSE-HISTORY (4).
 12199     MOVE AT-OPEN-CLOSE-HISTORY (6) TO AT-OPEN-CLOSE-HISTORY (5).
 12200     MOVE 6       TO COUNT-2.
 12201     PERFORM 2330-ADD-UPDATE THRU 2330-EXIT.
 12202
 12203 2320-EXIT.
 12204     EXIT.
 12205
 12206 2330-ADD-UPDATE.
 12207
 12208     IF COUNT-2 GREATER THAN 1
 12209        COMPUTE MISC-SUB = (COUNT-2 - 1)
 12210        IF AT-OPEN-CLOSE-TYPE (MISC-SUB) = STATUSI
 12211           GO TO 2330-EXIT.
 12212
 12213     MOVE SAVE-BIN-DATE         TO AT-OPEN-CLOSE-DATE (COUNT-2)
 12214                                   AT-RESERVES-LAST-MAINT-DT
 12215
 12216     MOVE PI-PROCESSOR-ID       TO AT-RESERVES-LAST-UPDATED-BY
 12217     MOVE EIBTIME               TO AT-LAST-MAINT-HHMMSS
 12218     MOVE STATUSI               TO AT-OPEN-CLOSE-TYPE (COUNT-2)
 12219     MOVE 'ALTER'               TO AT-OPEN-CLOSE-REASON (COUNT-2).
 12220
 12221 2330-EXIT.
 12222     EXIT.
 12223
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 226
* EL131.cbl
 12225 2400-UPDATE-TRLR.
 12226
 12227* EXEC CICS HANDLE CONDITION
 12228*         NOTFND    (2400-TRLR-NOTFND)
 12229*         ENDFILE   (2410-EXIT)
 12230*    END-EXEC.
 12231*    MOVE '"$I''                  ! 5 #00010939' TO DFHEIV0
 12232     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 12233     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12234     MOVE X'3520233030303130393339' TO DFHEIV0(25:11)
 12235     CALL 'kxdfhei1' USING DFHEIV0
 12236     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12237
 12238
 12239
 12240* EXEC CICS STARTBR
 12241*        DATASET (TRLR-FILE-ID)
 12242*        RIDFLD  (TRLR-KEY)
 12243*    END-EXEC.
 12244     MOVE 0
 12245       TO DFHEIV11
 12246*    MOVE '&,         G          &   #00010944' TO DFHEIV0
 12247     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 12248     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12249     MOVE X'2020233030303130393434' TO DFHEIV0(25:11)
 12250     CALL 'kxdfhei1' USING DFHEIV0,
 12251           TRLR-FILE-ID,
 12252           TRLR-KEY,
 12253           DFHEIV99,
 12254           DFHEIV11,
 12255           DFHEIV99
 12256     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12257
 12258
 12259
 12260* EXEC CICS GETMAIN
 12261*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 12262*         LENGTH    (TRLR-LENGTH)
 12263*         INITIMG   (GETMAIN-SPACE)
 12264*    END-EXEC.
 12265*    MOVE ',"IL                  $   #00010949' TO DFHEIV0
 12266     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12267     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12268     MOVE X'2020233030303130393439' TO DFHEIV0(25:11)
 12269     CALL 'kxdfhei1' USING DFHEIV0,
 12270           DFHEIV20,
 12271           TRLR-LENGTH,
 12272           GETMAIN-SPACE
 12273     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12274         DFHEIV20
 12275     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12276
 12277
 12278     PERFORM 2410-CHANGE-TRLR THRU 2410-EXIT.
 12279
 12280
 12281* EXEC CICS ENDBR
 12282*        DATASET (TRLR-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 227
* EL131.cbl
 12283*    END-EXEC.
 12284     MOVE 0
 12285       TO DFHEIV11
 12286*    MOVE '&2                    $   #00010957' TO DFHEIV0
 12287     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 12288     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12289     MOVE X'2020233030303130393537' TO DFHEIV0(25:11)
 12290     CALL 'kxdfhei1' USING DFHEIV0,
 12291           TRLR-FILE-ID,
 12292           DFHEIV11,
 12293           DFHEIV99
 12294     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12295
 12296
 12297     GO TO 2400-EXIT.
 12298
 12299 2400-TRLR-NOTFND.
 12300     MOVE ER-0205                TO EMI-ERROR.
 12301     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12302     MOVE 'X'                    TO ERROR-SWITCH.
 12303
 12304 2400-EXIT.
 12305     EXIT.
 12306
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 228
* EL131.cbl
 12308 2410-CHANGE-TRLR.
 12309
 12310* EXEC CICS READNEXT
 12311*        DATASET (TRLR-FILE-ID)
 12312*        RIDFLD  (TRLR-KEY)
 12313*        INTO    (ACTIVITY-TRAILERS)
 12314*    END-EXEC.
 12315     MOVE LENGTH OF
 12316      ACTIVITY-TRAILERS
 12317       TO DFHEIV12
 12318     MOVE 0
 12319       TO DFHEIV11
 12320*    MOVE '&.IL                  )   #00010973' TO DFHEIV0
 12321     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 12322     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 12323     MOVE X'2020233030303130393733' TO DFHEIV0(25:11)
 12324     CALL 'kxdfhei1' USING DFHEIV0,
 12325           TRLR-FILE-ID,
 12326           ACTIVITY-TRAILERS,
 12327           DFHEIV12,
 12328           TRLR-KEY,
 12329           DFHEIV99,
 12330           DFHEIV11,
 12331           DFHEIV99,
 12332           DFHEIV99
 12333     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12334
 12335
 12336     IF AT-CONTROL-PRIMARY = WS-LAST-TRLR-KEY
 12337        GO TO 2410-CHANGE-TRLR.
 12338
 12339     MOVE AT-CONTROL-PRIMARY     TO WS-LAST-TRLR-KEY
 12340                                    CHECK-KEY.
 12341
 12342     IF CHECK-KEY NOT = MSTR-KEY
 12343         GO TO 2410-EXIT.
 12344
 12345
 12346* EXEC CICS ENDBR
 12347*        DATASET (TRLR-FILE-ID)
 12348*    END-EXEC.
 12349     MOVE 0
 12350       TO DFHEIV11
 12351*    MOVE '&2                    $   #00010988' TO DFHEIV0
 12352     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 12353     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12354     MOVE X'2020233030303130393838' TO DFHEIV0(25:11)
 12355     CALL 'kxdfhei1' USING DFHEIV0,
 12356           TRLR-FILE-ID,
 12357           DFHEIV11,
 12358           DFHEIV99
 12359     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12360
 12361
 12362
 12363* EXEC CICS READ UPDATE
 12364*        DATASET (TRLR-FILE-ID)
 12365*        RIDFLD  (TRLR-KEY)
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 229
* EL131.cbl
 12366*        INTO    (ACTIVITY-TRAILERS)
 12367*    END-EXEC.
 12368     MOVE LENGTH OF
 12369      ACTIVITY-TRAILERS
 12370       TO DFHEIV11
 12371*    MOVE '&"IL       EU         (   #00010992' TO DFHEIV0
 12372     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12373     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12374     MOVE X'2020233030303130393932' TO DFHEIV0(25:11)
 12375     CALL 'kxdfhei1' USING DFHEIV0,
 12376           TRLR-FILE-ID,
 12377           ACTIVITY-TRAILERS,
 12378           DFHEIV11,
 12379           TRLR-KEY,
 12380           DFHEIV99,
 12381           DFHEIV99,
 12382           DFHEIV99
 12383     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12384
 12385
 12386
 12387* EXEC CICS DELETE
 12388*        DATASET (TRLR-FILE-ID)
 12389*    END-EXEC.
 12390*    MOVE '&(                    &   #00010998' TO DFHEIV0
 12391     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12392     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12393     MOVE X'2020233030303130393938' TO DFHEIV0(25:11)
 12394     CALL 'kxdfhei1' USING DFHEIV0,
 12395           TRLR-FILE-ID,
 12396           DFHEIV99,
 12397           DFHEIV99,
 12398           DFHEIV99,
 12399           DFHEIV99
 12400     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12401
 12402
 12403     IF AT-SEQUENCE-NO = ZERO AND
 12404        TRLR-UPDATE-REQUIRED
 12405         PERFORM 2420-UPDATE-TRLR THRU 2420-EXIT.
 12406
 12407     IF CERTI GREATER THAN LOW-VALUES
 12408        MOVE CERTI               TO AT-CERT-PRIME.
 12409
 12410     IF SUFXI GREATER THAN LOW-VALUES
 12411        MOVE SUFXI               TO AT-CERT-SFX.
 12412
 12413     IF CERTCARI GREATER THAN LOW-VALUES
 12414        MOVE CERTCARI            TO AT-CARRIER.
 12415
 12416     IF PAYMENT-TR
 12417        IF AT-CHECK-QUE-CONTROL NOT = ZEROS
 12418           AND AT-CHECK-QUE-CONTROL NOT = 99999999
 12419              PERFORM 2460-UPDATE-CHECKQ THRU 2460-EXIT.
 12420
 12421     IF CORRESPONDENCE-TR
 12422        AND AT-LETTER-ARCHIVE-NO NOT = ZEROS
 12423           PERFORM 2475-UPDATE-LETTER THRU 2475-EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 230
* EL131.cbl
 12424
 12425
 12426* EXEC CICS WRITE
 12427*         DATASET  (TRLR-FILE-ID)
 12428*         RIDFLD   (AT-CONTROL-PRIMARY)
 12429*         FROM     (ACTIVITY-TRAILERS)
 12430*    END-EXEC.
 12431     MOVE LENGTH OF
 12432      ACTIVITY-TRAILERS
 12433       TO DFHEIV11
 12434*    MOVE '&$ L                  ''   #00011024' TO DFHEIV0
 12435     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12436     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12437     MOVE X'2020233030303131303234' TO DFHEIV0(25:11)
 12438     CALL 'kxdfhei1' USING DFHEIV0,
 12439           TRLR-FILE-ID,
 12440           ACTIVITY-TRAILERS,
 12441           DFHEIV11,
 12442           AT-CONTROL-PRIMARY,
 12443           DFHEIV99,
 12444           DFHEIV99
 12445     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12446
 12447
 12448
 12449* EXEC CICS STARTBR
 12450*         DATASET  (TRLR-FILE-ID)
 12451*         RIDFLD   (TRLR-KEY)
 12452*    END-EXEC.
 12453     MOVE 0
 12454       TO DFHEIV11
 12455*    MOVE '&,         G          &   #00011030' TO DFHEIV0
 12456     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 12457     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12458     MOVE X'2020233030303131303330' TO DFHEIV0(25:11)
 12459     CALL 'kxdfhei1' USING DFHEIV0,
 12460           TRLR-FILE-ID,
 12461           TRLR-KEY,
 12462           DFHEIV99,
 12463           DFHEIV11,
 12464           DFHEIV99
 12465     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12466
 12467
 12468     GO TO 2410-CHANGE-TRLR.
 12469
 12470 2410-EXIT.
 12471     EXIT.
 12472
 12473 2420-UPDATE-TRLR.
 12474     MOVE ZERO TO COUNT-2.
 12475     PERFORM 2310-INS-STATUS THRU 2310-EXIT
 12476         UNTIL UPDATE-MADE OR COUNT-2 GREATER THAN 6.
 12477
 12478     IF NOT UPDATE-MADE
 12479         PERFORM 2320-SHIFT-STATUS THRU 2320-EXIT.
 12480
 12481 2420-EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 231
* EL131.cbl
 12482     EXIT.
 12483
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 232
* EL131.cbl
 12485 2425-UPDATE-NINETY-TRLR.
 12486
 12487     MOVE +90                    TO TRLR-SEQ-NO.
 12488
 12489
 12490* EXEC CICS HANDLE CONDITION
 12491*         NOTFND    (2425-NINETY-NOTFND)
 12492*         ENDFILE   (2425-NINETY-NOTFND)
 12493*    END-EXEC.
 12494*    MOVE '"$I''                  ! 6 #00011056' TO DFHEIV0
 12495     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 12496     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12497     MOVE X'3620233030303131303536' TO DFHEIV0(25:11)
 12498     CALL 'kxdfhei1' USING DFHEIV0
 12499     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12500
 12501
 12502
 12503* EXEC CICS READ UPDATE
 12504*        DATASET (TRLR-FILE-ID)
 12505*        SET     (ADDRESS OF ACTIVITY-TRAILERS)
 12506*        RIDFLD  (TRLR-KEY)
 12507*    END-EXEC.
 12508*    MOVE '&"S        EU         (   #00011061' TO DFHEIV0
 12509     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12510     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12511     MOVE X'2020233030303131303631' TO DFHEIV0(25:11)
 12512     CALL 'kxdfhei1' USING DFHEIV0,
 12513           TRLR-FILE-ID,
 12514           DFHEIV20,
 12515           DFHEIV99,
 12516           TRLR-KEY,
 12517           DFHEIV99,
 12518           DFHEIV99,
 12519           DFHEIV99
 12520     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12521         DFHEIV20
 12522     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12523
 12524     if (diagi > low-values)
 12525        and (diagi not = at-info-line-1)
 12526        and (cl-total-paid-amt > zeros)
 12527        move cl-cert-eff-dt      to dc-bin-date-1
 12528        move cl-paid-thru-dt     to dc-bin-date-2
 12529        move '1'                 to dc-option-code
 12530        perform 9800-convert-date
 12531                                 thru 9800-exit
 12532        if no-conversion-error
 12533           and dc-elapsed-months < +24
 12534           and (not emi-bypass-forcables)
 12535           move er-1581          to emi-error
 12536           perform 9900-error-format
 12537                                thru 9900-exit
 12538           move -1              to diagl
 12539           go to 8110-send-data
 12540        end-if
 12541     end-if
 12542     MOVE AT-INFO-LINE-1        TO WS-DIAGNOSIS.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 233
* EL131.cbl
 12543     MOVE AT-ICD-CODE-1         TO WS-ICD-CODE-1.
 12544     MOVE AT-ICD-CODE-2         TO WS-ICD-CODE-2.
 12545
 12546     IF DIAGI GREATER THAN LOW-VALUES
 12547         MOVE DIAGI             TO AT-INFO-LINE-1
 12548     END-IF.
 12549
 12550     IF ICD1I GREATER THAN LOW-VALUES
 12551         MOVE ICD1I             TO AT-ICD-CODE-1
 12552     END-IF.
 12553
 12554     IF ICD2I GREATER THAN LOW-VALUES
 12555         MOVE ICD2I             TO AT-ICD-CODE-2
 12556     END-IF.
 12557
 12558
 12559* EXEC CICS REWRITE
 12560*        DATASET (TRLR-FILE-ID)
 12561*        FROM    (ACTIVITY-TRAILERS)
 12562*    END-EXEC.
 12563     MOVE LENGTH OF
 12564      ACTIVITY-TRAILERS
 12565       TO DFHEIV11
 12566*    MOVE '&& L                  %   #00011100' TO DFHEIV0
 12567     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12568     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12569     MOVE X'2020233030303131313030' TO DFHEIV0(25:11)
 12570     CALL 'kxdfhei1' USING DFHEIV0,
 12571           TRLR-FILE-ID,
 12572           ACTIVITY-TRAILERS,
 12573           DFHEIV11,
 12574           DFHEIV99
 12575     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12576
 12577
 12578     IF DIAGI GREATER THAN LOW-VALUES
 12579       AND DIAGI NOT = WS-DIAGNOSIS
 12580         MOVE 'DIAGNOSIS'          TO SPLIT-INFO-DESC
 12581         MOVE WS-DIAGNOSIS         TO SPLIT-INFO-OLD
 12582         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12583
 12584     IF ICD1I GREATER THAN LOW-VALUES
 12585       AND ICD1I NOT = WS-ICD-CODE-1
 12586         MOVE 'ICD CODE 1'         TO SPLIT-INFO-DESC
 12587         MOVE WS-ICD-CODE-1        TO SPLIT-INFO-OLD
 12588         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT
 12589     END-IF.
 12590
 12591     IF ICD2I GREATER THAN LOW-VALUES
 12592       AND ICD2I NOT = WS-ICD-CODE-2
 12593         MOVE 'ICD CODE 2'         TO SPLIT-INFO-DESC
 12594         MOVE WS-ICD-CODE-2        TO SPLIT-INFO-OLD
 12595         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT
 12596     END-IF.
 12597
 12598     GO TO 2425-EXIT.
 12599
 12600 2425-NINETY-NOTFND.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 234
* EL131.cbl
 12601
 12602
 12603* EXEC CICS GETMAIN
 12604*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 12605*         LENGTH    (TRLR-LENGTH)
 12606*         INITIMG   (GETMAIN-SPACE)
 12607*    END-EXEC.
 12608*    MOVE ',"IL                  $   #00011129' TO DFHEIV0
 12609     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12610     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12611     MOVE X'2020233030303131313239' TO DFHEIV0(25:11)
 12612     CALL 'kxdfhei1' USING DFHEIV0,
 12613           DFHEIV20,
 12614           TRLR-LENGTH,
 12615           GETMAIN-SPACE
 12616     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12617         DFHEIV20
 12618     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12619
 12620
 12621     MOVE +90                  TO TRLR-SEQ-NO.
 12622     MOVE TRLR-KEY             TO AT-CONTROL-PRIMARY.
 12623
 12624     MOVE 'AT'                 TO AT-RECORD-ID
 12625     MOVE '6'                  TO AT-TRAILER-TYPE
 12626     MOVE SAVE-BIN-DATE        TO AT-RECORDED-DT
 12627                                  AT-GEN-INFO-LAST-MAINT-DT
 12628     MOVE PI-PROCESSOR-ID      TO AT-RECORDED-BY
 12629                                  AT-GEN-INFO-LAST-UPDATED-BY
 12630     MOVE EIBTIME              TO AT-LAST-MAINT-HHMMSS
 12631     MOVE DIAGI                TO AT-INFO-LINE-1.
 12632     MOVE ICD1I                TO AT-ICD-CODE-1.
 12633     MOVE ICD2I                TO AT-ICD-CODE-2.
 12634
 12635
 12636* EXEC CICS WRITE
 12637*        DATASET (TRLR-FILE-ID)
 12638*        FROM    (ACTIVITY-TRAILERS)
 12639*        RIDFLD  (TRLR-KEY)
 12640*    END-EXEC.
 12641     MOVE LENGTH OF
 12642      ACTIVITY-TRAILERS
 12643       TO DFHEIV11
 12644*    MOVE '&$ L                  ''   #00011149' TO DFHEIV0
 12645     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12646     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12647     MOVE X'2020233030303131313439' TO DFHEIV0(25:11)
 12648     CALL 'kxdfhei1' USING DFHEIV0,
 12649           TRLR-FILE-ID,
 12650           ACTIVITY-TRAILERS,
 12651           DFHEIV11,
 12652           TRLR-KEY,
 12653           DFHEIV99,
 12654           DFHEIV99
 12655     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12656
 12657
 12658 2425-EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 235
* EL131.cbl
 12659     EXIT.
 12660
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 236
* EL131.cbl
 12662 2430-UPDATE-ACTQ.
 12663
 12664* EXEC CICS HANDLE CONDITION
 12665*         NOTFND    (2430-EXIT)
 12666*         ENDFILE   (2440-EXIT)
 12667*    END-EXEC.
 12668*    MOVE '"$I''                  ! 7 #00011160' TO DFHEIV0
 12669     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 12670     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12671     MOVE X'3720233030303131313630' TO DFHEIV0(25:11)
 12672     CALL 'kxdfhei1' USING DFHEIV0
 12673     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12674
 12675
 12676
 12677* EXEC CICS STARTBR
 12678*         DATASET  (ACTQ-FILE-ID)
 12679*         RIDFLD   (ACTQ-KEY)
 12680*    END-EXEC.
 12681     MOVE 0
 12682       TO DFHEIV11
 12683*    MOVE '&,         G          &   #00011165' TO DFHEIV0
 12684     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 12685     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12686     MOVE X'2020233030303131313635' TO DFHEIV0(25:11)
 12687     CALL 'kxdfhei1' USING DFHEIV0,
 12688           ACTQ-FILE-ID,
 12689           ACTQ-KEY,
 12690           DFHEIV99,
 12691           DFHEIV11,
 12692           DFHEIV99
 12693     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12694
 12695
 12696
 12697* EXEC CICS GETMAIN
 12698*         SET      (ADDRESS OF ACTIVITY-QUE)
 12699*         LENGTH   (ACTQ-LENGTH)
 12700*         INITIMG  (GETMAIN-SPACE)
 12701*    END-EXEC.
 12702*    MOVE ',"IL                  $   #00011170' TO DFHEIV0
 12703     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12704     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12705     MOVE X'2020233030303131313730' TO DFHEIV0(25:11)
 12706     CALL 'kxdfhei1' USING DFHEIV0,
 12707           DFHEIV20,
 12708           ACTQ-LENGTH,
 12709           GETMAIN-SPACE
 12710     SET ADDRESS OF ACTIVITY-QUE TO
 12711         DFHEIV20
 12712     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12713
 12714
 12715     PERFORM 2440-CHANGE-ACTQ THRU 2440-EXIT.
 12716
 12717 2430-EXIT.
 12718     EXIT.
 12719
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 237
* EL131.cbl
 12720 2440-CHANGE-ACTQ.
 12721
 12722
 12723* EXEC CICS READNEXT
 12724*         DATASET  (ACTQ-FILE-ID)
 12725*         RIDFLD   (ACTQ-KEY)
 12726*         INTO     (ACTIVITY-QUE)
 12727*    END-EXEC.
 12728     MOVE LENGTH OF
 12729      ACTIVITY-QUE
 12730       TO DFHEIV12
 12731     MOVE 0
 12732       TO DFHEIV11
 12733*    MOVE '&.IL                  )   #00011183' TO DFHEIV0
 12734     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 12735     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 12736     MOVE X'2020233030303131313833' TO DFHEIV0(25:11)
 12737     CALL 'kxdfhei1' USING DFHEIV0,
 12738           ACTQ-FILE-ID,
 12739           ACTIVITY-QUE,
 12740           DFHEIV12,
 12741           ACTQ-KEY,
 12742           DFHEIV99,
 12743           DFHEIV11,
 12744           DFHEIV99,
 12745           DFHEIV99
 12746     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12747
 12748
 12749
 12750* EXEC CICS ENDBR
 12751*         DATASET (ACTQ-FILE-ID)
 12752*    END-EXEC.
 12753     MOVE 0
 12754       TO DFHEIV11
 12755*    MOVE '&2                    $   #00011189' TO DFHEIV0
 12756     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 12757     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12758     MOVE X'2020233030303131313839' TO DFHEIV0(25:11)
 12759     CALL 'kxdfhei1' USING DFHEIV0,
 12760           ACTQ-FILE-ID,
 12761           DFHEIV11,
 12762           DFHEIV99
 12763     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12764
 12765
 12766     IF ACTQ-KEY NOT = MSTR-KEY
 12767         GO TO 2440-EXIT.
 12768
 12769
 12770* EXEC CICS READ UPDATE
 12771*         DATASET  (ACTQ-FILE-ID)
 12772*         RIDFLD   (AQ-CONTROL-PRIMARY)
 12773*         SET      (ADDRESS OF ACTIVITY-QUE)
 12774*    END-EXEC.
 12775*    MOVE '&"S        EU         (   #00011196' TO DFHEIV0
 12776     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12777     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 238
* EL131.cbl
 12778     MOVE X'2020233030303131313936' TO DFHEIV0(25:11)
 12779     CALL 'kxdfhei1' USING DFHEIV0,
 12780           ACTQ-FILE-ID,
 12781           DFHEIV20,
 12782           DFHEIV99,
 12783           AQ-CONTROL-PRIMARY,
 12784           DFHEIV99,
 12785           DFHEIV99,
 12786           DFHEIV99
 12787     SET ADDRESS OF ACTIVITY-QUE TO
 12788         DFHEIV20
 12789     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12790
 12791
 12792     MOVE ACTIVITY-QUE           TO JP-RECORD-AREA
 12793
 12794
 12795* EXEC CICS DELETE
 12796*         DATASET (ACTQ-FILE-ID)
 12797*    END-EXEC.
 12798*    MOVE '&(                    &   #00011204' TO DFHEIV0
 12799     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12800     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12801     MOVE X'2020233030303131323034' TO DFHEIV0(25:11)
 12802     CALL 'kxdfhei1' USING DFHEIV0,
 12803           ACTQ-FILE-ID,
 12804           DFHEIV99,
 12805           DFHEIV99,
 12806           DFHEIV99,
 12807           DFHEIV99
 12808     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12809
 12810
 12811     MOVE JP-RECORD-AREA         TO ACTIVITY-QUE.
 12812     IF CERTI GREATER THAN LOW-VALUES
 12813        MOVE CERTI               TO AQ-CERT-PRIME.
 12814     IF SUFXI GREATER THAN LOW-VALUES
 12815        MOVE SUFXI               TO AQ-CERT-SFX.
 12816     IF CERTCARI GREATER THAN LOW-VALUES
 12817        MOVE CERTCARI            TO AQ-CARRIER.
 12818
 12819
 12820* EXEC CICS HANDLE CONDITION
 12821*         DUPREC   (2440-EXIT)
 12822*    END-EXEC.
 12823*    MOVE '"$%                   ! 8 #00011216' TO DFHEIV0
 12824     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 12825     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12826     MOVE X'3820233030303131323136' TO DFHEIV0(25:11)
 12827     CALL 'kxdfhei1' USING DFHEIV0
 12828     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12829
 12830
 12831
 12832* EXEC CICS WRITE
 12833*         DATASET  (ACTQ-FILE-ID)
 12834*         RIDFLD   (AQ-CONTROL-PRIMARY)
 12835*         FROM     (ACTIVITY-QUE)
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 239
* EL131.cbl
 12836*    END-EXEC.
 12837     MOVE LENGTH OF
 12838      ACTIVITY-QUE
 12839       TO DFHEIV11
 12840*    MOVE '&$ L                  ''   #00011220' TO DFHEIV0
 12841     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12842     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12843     MOVE X'2020233030303131323230' TO DFHEIV0(25:11)
 12844     CALL 'kxdfhei1' USING DFHEIV0,
 12845           ACTQ-FILE-ID,
 12846           ACTIVITY-QUE,
 12847           DFHEIV11,
 12848           AQ-CONTROL-PRIMARY,
 12849           DFHEIV99,
 12850           DFHEIV99
 12851     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12852
 12853
 12854 2440-EXIT.
 12855     EXIT.
 12856
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 240
* EL131.cbl
 12858 2460-UPDATE-CHECKQ.
 12859
 12860* EXEC CICS HANDLE CONDITION
 12861*         NOTFND   (2460-EXIT)
 12862*    END-EXEC.
 12863*    MOVE '"$I                   ! 9 #00011231' TO DFHEIV0
 12864     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12865     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12866     MOVE X'3920233030303131323331' TO DFHEIV0(25:11)
 12867     CALL 'kxdfhei1' USING DFHEIV0
 12868     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12869
 12870
 12871     MOVE AT-CHECK-QUE-CONTROL   TO CHKQ-CONTROL-NO.
 12872     MOVE AT-CHECK-QUE-SEQUENCE  TO CHKQ-SEQ-NO.
 12873     MOVE PI-COMPANY-CD          TO CHKQ-COMPANY-CODE.
 12874
 12875
 12876* EXEC CICS READ UPDATE
 12877*         DATASET   (CHKQ-FILE-ID)
 12878*         RIDFLD    (CHKQ-KEY)
 12879*         SET       (ADDRESS OF CHECK-QUE)
 12880*    END-EXEC.
 12881*    MOVE '&"S        EU         (   #00011239' TO DFHEIV0
 12882     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12883     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12884     MOVE X'2020233030303131323339' TO DFHEIV0(25:11)
 12885     CALL 'kxdfhei1' USING DFHEIV0,
 12886           CHKQ-FILE-ID,
 12887           DFHEIV20,
 12888           DFHEIV99,
 12889           CHKQ-KEY,
 12890           DFHEIV99,
 12891           DFHEIV99,
 12892           DFHEIV99
 12893     SET ADDRESS OF CHECK-QUE TO
 12894         DFHEIV20
 12895     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12896
 12897
 12898     IF CERTI GREATER THAN LOW-VALUES
 12899        MOVE CERTI               TO CQ-CERT-PRIME.
 12900     IF SUFXI GREATER THAN LOW-VALUES
 12901        MOVE SUFXI               TO CQ-CERT-SFX.
 12902     IF CERTCARI GREATER THAN LOW-VALUES
 12903        MOVE CERTCARI            TO CQ-CARRIER.
 12904
 12905
 12906* EXEC CICS REWRITE
 12907*         DATASET  (CHKQ-FILE-ID)
 12908*         FROM     (CHECK-QUE)
 12909*    END-EXEC.
 12910     MOVE LENGTH OF
 12911      CHECK-QUE
 12912       TO DFHEIV11
 12913*    MOVE '&& L                  %   #00011252' TO DFHEIV0
 12914     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12915     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 241
* EL131.cbl
 12916     MOVE X'2020233030303131323532' TO DFHEIV0(25:11)
 12917     CALL 'kxdfhei1' USING DFHEIV0,
 12918           CHKQ-FILE-ID,
 12919           CHECK-QUE,
 12920           DFHEIV11,
 12921           DFHEIV99
 12922     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12923
 12924
 12925 2460-EXIT.
 12926     EXIT.
 12927
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 242
* EL131.cbl
 12929 2475-UPDATE-LETTER.
 12930
 12931* EXEC CICS HANDLE CONDITION
 12932*         NOTFND   (2475-EXIT)
 12933*    END-EXEC.
 12934*    MOVE '"$I                   ! : #00011262' TO DFHEIV0
 12935     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12936     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12937     MOVE X'3A20233030303131323632' TO DFHEIV0(25:11)
 12938     CALL 'kxdfhei1' USING DFHEIV0
 12939     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12940
 12941
 12942     MOVE AT-LETTER-ARCHIVE-NO   TO ARCH-ARCHIVE-NO.
 12943     MOVE '1'                    TO ARCH-RECORD-TYPE.
 12944     MOVE ZEROS                  TO ARCH-SEQ-NO.
 12945     MOVE PI-COMPANY-CD          TO ARCH-COMPANY-CODE.
 12946
 12947
 12948* EXEC CICS READ UPDATE
 12949*         DATASET   (ARCH-FILE-ID)
 12950*         RIDFLD    (ARCH-KEY)
 12951*         SET       (ADDRESS OF LETTER-ARCHIVE)
 12952*    END-EXEC.
 12953*    MOVE '&"S        EU         (   #00011271' TO DFHEIV0
 12954     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12955     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12956     MOVE X'2020233030303131323731' TO DFHEIV0(25:11)
 12957     CALL 'kxdfhei1' USING DFHEIV0,
 12958           ARCH-FILE-ID,
 12959           DFHEIV20,
 12960           DFHEIV99,
 12961           ARCH-KEY,
 12962           DFHEIV99,
 12963           DFHEIV99,
 12964           DFHEIV99
 12965     SET ADDRESS OF LETTER-ARCHIVE TO
 12966         DFHEIV20
 12967     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12968
 12969
 12970* COMPARE LETTER HEADER INFORMATION TO ASSURE THAT IT BELONGS
 12971* TO THIS MASTER-KEY INFORMATION.
 12972
 12973     IF LA-CARRIER  = CARRIER-CODE AND
 12974        LA-CLAIM-NO = CLAIM-NO     AND
 12975        LA-CERT-NO  = CERT-NO
 12976        NEXT SENTENCE
 12977     ELSE
 12978        GO TO 2475-UNLOCK.
 12979
 12980     IF CERTI GREATER THAN LOW-VALUES
 12981        MOVE CERTI               TO LA-CERT-PRIME.
 12982     IF SUFXI GREATER THAN LOW-VALUES
 12983        MOVE SUFXI               TO LA-CERT-SFX.
 12984     IF CERTCARI GREATER THAN LOW-VALUES
 12985        MOVE CERTCARI            TO LA-CARRIER.
 12986
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 243
* EL131.cbl
 12987
 12988* EXEC CICS REWRITE
 12989*         DATASET  (ARCH-FILE-ID)
 12990*         FROM     (LETTER-ARCHIVE)
 12991*    END-EXEC.
 12992     MOVE LENGTH OF
 12993      LETTER-ARCHIVE
 12994       TO DFHEIV11
 12995*    MOVE '&& L                  %   #00011294' TO DFHEIV0
 12996     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12997     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12998     MOVE X'2020233030303131323934' TO DFHEIV0(25:11)
 12999     CALL 'kxdfhei1' USING DFHEIV0,
 13000           ARCH-FILE-ID,
 13001           LETTER-ARCHIVE,
 13002           DFHEIV11,
 13003           DFHEIV99
 13004     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13005
 13006
 13007     GO TO 2475-EXIT.
 13008
 13009 2475-UNLOCK.
 13010
 13011* EXEC CICS UNLOCK
 13012*         DATASET  (ARCH-FILE-ID)
 13013*    END-EXEC.
 13014*    MOVE '&*                    #   #00011302' TO DFHEIV0
 13015     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 13016     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13017     MOVE X'2020233030303131333032' TO DFHEIV0(25:11)
 13018     CALL 'kxdfhei1' USING DFHEIV0,
 13019           ARCH-FILE-ID,
 13020           DFHEIV99
 13021     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13022
 13023
 13024 2475-EXIT.
 13025     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 244
* EL131.cbl
 13027 2600-CREATE-MAINT-NOTE.
 13028     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
 13029     MOVE '1'                    TO CNTL-REC-TYPE.
 13030     MOVE SPACES                 TO CNTL-PROC-ID.
 13031     MOVE ZERO                   TO CNTL-SEQ-NO.
 13032
 13033
 13034* EXEC CICS READ
 13035*         SET        (ADDRESS OF CONTROL-FILE)
 13036*         DATASET    ('ELCNTL')
 13037*         RIDFLD     (CNTL-KEY)
 13038*    END-EXEC.
 13039     MOVE 'ELCNTL' TO DFHEIV1
 13040*    MOVE '&"S        E          (   #00011315' TO DFHEIV0
 13041     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13042     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13043     MOVE X'2020233030303131333135' TO DFHEIV0(25:11)
 13044     CALL 'kxdfhei1' USING DFHEIV0,
 13045           DFHEIV1,
 13046           DFHEIV20,
 13047           DFHEIV99,
 13048           CNTL-KEY,
 13049           DFHEIV99,
 13050           DFHEIV99,
 13051           DFHEIV99
 13052     SET ADDRESS OF CONTROL-FILE TO
 13053         DFHEIV20
 13054     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13055
 13056
 13057     IF CO-NO-USE-AUDIT-CHANGES
 13058         GO TO 2600-EXIT.
 13059
 13060     IF PROCL GREATER ZERO
 13061     IF PROCI NOT = LOW-VALUES
 13062     IF PROCI NOT = CL-PROCESSOR-ID
 13063         MOVE 'PROCESSOR'          TO SPLIT-INFO-DESC
 13064         MOVE CL-PROCESSOR-ID      TO SPLIT-INFO-OLD
 13065         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13066
 13067     IF SEXL GREATER ZERO
 13068     IF SEXI NOT = LOW-VALUES
 13069     IF SEXI NOT = CL-INSURED-SEX-CD
 13070         MOVE 'SEX'                TO SPLIT-INFO-DESC
 13071         MOVE CL-INSURED-SEX-CD    TO SPLIT-INFO-OLD
 13072         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13073
 13074     IF BIRTHL GREATER ZERO
 13075     IF HOLD-BIRTH NOT = LOW-VALUES
 13076     IF HOLD-BIRTH NOT = CL-INSURED-BIRTH-DT
 13077         MOVE 'BIRTH'              TO SPLIT-INFO-DESC
 13078         MOVE CL-INSURED-BIRTH-DT  TO DC-BIN-DATE-1
 13079         MOVE SPACES               TO DC-OPTION-CODE
 13080         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13081         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 13082         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13083
 13084     IF SOCIALL GREATER ZERO
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 245
* EL131.cbl
 13085     IF SOCIALI NOT = LOW-VALUES
 13086     IF SOCIALI NOT = CL-SOC-SEC-NO
 13087         MOVE 'SOC SEC NO'         TO SPLIT-INFO-DESC
 13088         MOVE CL-SOC-SEC-NO        TO SPLIT-INFO-OLD
 13089         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13090
 13091     IF OCCL GREATER ZERO
 13092     IF OCCI NOT = LOW-VALUES
 13093     IF OCCI NOT = CL-INSURED-OCC-CD
 13094         MOVE 'OCCUPATION'         TO SPLIT-INFO-DESC
 13095         MOVE CL-INSURED-OCC-CD    TO SPLIT-INFO-OLD
 13096         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13097
 13098     IF BENEL GREATER ZERO
 13099     IF BENEI NOT = LOW-VALUES
 13100     IF BENEI NOT = CL-BENEFICIARY
 13101         MOVE 'BENEFICIARY'        TO SPLIT-INFO-DESC
 13102         MOVE CL-BENEFICIARY      TO SPLIT-INFO-OLD
 13103         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13104
 13105     IF PREMTYPL GREATER ZERO
 13106     IF PREMTYPI NOT = LOW-VALUES
 13107     IF PREMTYPI NOT = CL-CLAIM-PREM-TYPE
 13108         MOVE 'PREM TYPE'          TO SPLIT-INFO-DESC
 13109         MOVE CL-CLAIM-PREM-TYPE   TO SPLIT-INFO-OLD
 13110         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13111
 13112*    IF CAUSEL GREATER ZERO
 13113*    IF CAUSEI NOT = LOW-VALUES
 13114*    IF CAUSEI NOT = CL-CAUSE-CD
 13115*        MOVE 'CAUSE CD'           TO SPLIT-INFO-DESC
 13116*        MOVE CL-CAUSE-CD          TO SPLIT-INFO-OLD
 13117*        PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13118
 13119*    IF ENDL GREATER ZERO
 13120*    IF HOLD-END NOT = LOW-VALUES
 13121*    IF HOLD-END NOT = CL-EST-END-OF-DISAB-DT
 13122*        MOVE 'END DT'             TO SPLIT-INFO-DESC
 13123*        MOVE CL-EST-END-OF-DISAB-DT
 13124*                                  TO DC-BIN-DATE-1
 13125*        MOVE SPACES               TO DC-OPTION-CODE
 13126*        PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13127*        MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 13128*        PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13129
 13130     IF PDTHRUL GREATER ZERO
 13131     IF HOLD-PDTHRU NOT = LOW-VALUES
 13132     IF HOLD-PDTHRU NOT = CL-PAID-THRU-DT
 13133         MOVE 'PAID THRU'          TO SPLIT-INFO-DESC
 13134         MOVE CL-PAID-THRU-DT      TO DC-BIN-DATE-1
 13135         MOVE SPACES               TO DC-OPTION-CODE
 13136         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13137         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 13138         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13139
 13140     IF PDAMTL GREATER ZERO
 13141     IF HOLD-PDAMT NOT = ZEROS
 13142     IF HOLD-PDAMT NOT = CL-TOTAL-PAID-AMT
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 246
* EL131.cbl
 13143         MOVE 'PAID AMOUNT'        TO SPLIT-INFO-DESC
 13144         MOVE CL-TOTAL-PAID-AMT    TO WS-EDIT-AMT
 13145         MOVE WS-EDIT-AMT          TO SPLIT-INFO-OLD
 13146         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13147
 13148     IF NODAYSL GREATER ZERO
 13149     IF HOLD-NODAYS NOT = ZEROS
 13150     IF HOLD-NODAYS NOT = CL-NO-OF-DAYS-PAID
 13151         MOVE 'DAYS PAID'          TO SPLIT-INFO-DESC
 13152         MOVE CL-NO-OF-DAYS-PAID   TO WS-EDIT-NUMBER
 13153         MOVE WS-EDIT-NUMBER       TO SPLIT-INFO-OLD
 13154         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13155
 13156     IF NOPMTSL GREATER ZERO
 13157     IF HOLD-NOPMTS NOT = ZEROS
 13158     IF HOLD-NOPMTS NOT = CL-NO-OF-PMTS-MADE
 13159         MOVE 'PMTS MADE'          TO SPLIT-INFO-DESC
 13160         MOVE CL-NO-OF-PMTS-MADE   TO WS-EDIT-NUMBER
 13161         MOVE WS-EDIT-NUMBER       TO SPLIT-INFO-OLD
 13162         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13163
 13164     IF FORMTYPL GREATER ZERO
 13165     IF FORMTYPI NOT = LOW-VALUES
 13166     IF FORMTYPI NOT = CL-PROG-FORM-TYPE
 13167         MOVE 'FORM TYPE'          TO SPLIT-INFO-DESC
 13168         MOVE CL-PROG-FORM-TYPE    TO SPLIT-INFO-OLD
 13169         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13170
 13171     IF REPL GREATER ZERO
 13172     IF HOLD-REPORTED NOT = LOW-VALUES
 13173     IF HOLD-REPORTED NOT = CL-REPORTED-DT
 13174         MOVE 'REPORTED DT'        TO SPLIT-INFO-DESC
 13175         MOVE CL-REPORTED-DT       TO DC-BIN-DATE-1
 13176         MOVE SPACES               TO DC-OPTION-CODE
 13177         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13178         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 13179         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13180
 13181     IF ADDONDTL GREATER ZERO
 13182     IF HOLD-ADDON NOT = LOW-VALUES
 13183     IF HOLD-ADDON NOT = CL-LAST-ADD-ON-DT
 13184         MOVE 'ADD ON DT'          TO SPLIT-INFO-DESC
 13185         MOVE CL-LAST-ADD-ON-DT    TO DC-BIN-DATE-1
 13186         MOVE SPACES               TO DC-OPTION-CODE
 13187         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13188         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 13189         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13190
 13191     IF PRICDL GREATER ZERO
 13192     IF PRICDI NOT = LOW-VALUES
 13193     IF PRICDI NOT = CL-PRIORITY-CD
 13194         MOVE 'PRIORITY CODE'      TO SPLIT-INFO-DESC
 13195         MOVE CL-PRIORITY-CD       TO SPLIT-INFO-OLD
 13196         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13197
 13198     IF FILETOL GREATER ZERO
 13199     IF FILETOI NOT = LOW-VALUES
 13200     IF FILETOI NOT = CL-FILE-LOCATION
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 247
* EL131.cbl
 13201         MOVE 'FILE TO'            TO SPLIT-INFO-DESC
 13202         MOVE CL-FILE-LOCATION     TO SPLIT-INFO-OLD
 13203         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13204
 13205     IF SUPVL GREATER ZERO
 13206     IF SUPVI NOT = LOW-VALUES
 13207     IF SUPVI NOT = CL-SUPV-ATTN-CD
 13208         MOVE 'SUPV (Y/N)'         TO SPLIT-INFO-DESC
 13209         MOVE CL-SUPV-ATTN-CD      TO SPLIT-INFO-OLD
 13210         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13211*    IF (CRITPTL > ZERO)
 13212*       AND (CRITPTI NOT = LOW-VALUES)
 13213*       AND (CRITPTI NOT = CL-CRIT-PER-RECURRENT)
 13214*       MOVE 'CRIT PER RECURR'   TO SPLIT-INFO-DESC
 13215*       MOVE CL-CRIT-PER-RECURRENT
 13216*                                TO SPLIT-INFO-OLD
 13217*       PERFORM 2650-WRITE-MAINT-NOTE
 13218*                                THRU 2650-EXIT
 13219*    END-IF
 13220
 13221*    IF (RTWMOSL > ZERO)
 13222*       AND (RTWMOSI NOT = LOW-VALUES)
 13223*       AND (RTWMOSI NOT = CL-CRIT-PER-RTW-MOS)
 13224*       MOVE 'CRIT PER RTW MO'   TO SPLIT-INFO-DESC
 13225*       MOVE CL-CRIT-PER-RTW-MOS TO SPLIT-INFO-OLD
 13226*       PERFORM 2650-WRITE-MAINT-NOTE
 13227*                                THRU 2650-EXIT
 13228*    END-IF
 13229     IF MLNAMEL GREATER ZERO
 13230     IF MLNAMEI NOT = LOW-VALUES
 13231     IF MLNAMEI NOT = CL-INSURED-LAST-NAME
 13232         MOVE 'INS LAST NAME'      TO SPLIT-INFO-DESC
 13233         MOVE CL-INSURED-LAST-NAME TO SPLIT-INFO-OLD
 13234         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13235
 13236     IF MFNAMEL GREATER ZERO
 13237     IF MFNAMEI NOT = LOW-VALUES
 13238     IF MFNAMEI NOT = CL-INSURED-1ST-NAME
 13239         MOVE 'INS 1ST NAME'       TO SPLIT-INFO-DESC
 13240         MOVE CL-INSURED-1ST-NAME  TO SPLIT-INFO-OLD
 13241         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13242
 13243     IF MMINITL GREATER ZERO
 13244     IF MMINITI NOT = LOW-VALUES
 13245     IF MMINITI NOT = CL-INSURED-MID-INIT
 13246         MOVE 'INS MID INITL'      TO SPLIT-INFO-DESC
 13247         MOVE CL-INSURED-MID-INIT  TO SPLIT-INFO-OLD
 13248         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13249
 13250     IF CERTEFFL GREATER ZERO
 13251     IF HOLD-EFF NOT = LOW-VALUES
 13252     IF HOLD-EFF NOT = CL-CERT-EFF-DT
 13253         MOVE 'CERT EFF DT'        TO SPLIT-INFO-DESC
 13254         MOVE CL-CERT-EFF-DT       TO DC-BIN-DATE-1
 13255         MOVE SPACES               TO DC-OPTION-CODE
 13256         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13257         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 13258         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 248
* EL131.cbl
 13259
 13260     IF CERTACTL GREATER ZERO
 13261     IF CERTACTI NOT = LOW-VALUES
 13262     IF CERTACTI NOT = CL-CERT-ACCOUNT
 13263         MOVE 'CERT ACCOUNT'       TO SPLIT-INFO-DESC
 13264         MOVE CL-CERT-ACCOUNT      TO SPLIT-INFO-OLD
 13265         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13266
 13267     IF CERTSTL GREATER ZERO
 13268     IF CERTSTI NOT = LOW-VALUES
 13269     IF CERTSTI NOT = CL-CERT-STATE
 13270         MOVE 'CERT STATE'         TO SPLIT-INFO-DESC
 13271         MOVE CL-CERT-STATE        TO SPLIT-INFO-OLD
 13272         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13273
 13274     IF CERTCARL GREATER ZERO
 13275     IF CERTCARI NOT = LOW-VALUES
 13276     IF CERTCARI NOT = CL-CERT-CARRIER
 13277         MOVE 'CERT CARRIER'       TO SPLIT-INFO-DESC
 13278         MOVE CL-CERT-CARRIER      TO SPLIT-INFO-OLD
 13279         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13280
 13281     IF CERTGRPL GREATER ZERO
 13282     IF CERTGRPI NOT = LOW-VALUES
 13283     IF CERTGRPI NOT = CL-CERT-GROUPING
 13284         MOVE 'CERT GROUPING'      TO SPLIT-INFO-DESC
 13285         MOVE CL-CERT-GROUPING     TO SPLIT-INFO-OLD
 13286         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13287
 13288     IF CERTL GREATER ZERO OR
 13289        SUFXL GREATER ZERO
 13290     IF (CERTI NOT = LOW-VALUES AND
 13291                     CL-CERT-PRIME)
 13292                OR
 13293        (SUFXI NOT = LOW-VALUES AND
 13294                     CL-CERT-SFX)
 13295         MOVE 'CERT NO'            TO SPLIT-INFO-DESC
 13296         MOVE CL-CERT-NO           TO SPLIT-INFO-OLD
 13297         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13298     IF incl > zeros
 13299        IF (HOLD-INCUR NOT = LOW-VALUES)
 13300           AND (HOLD-INCUR NOT = CL-INCURRED-DT)
 13301           MOVE 'INC DTE'        TO SPLIT-INFO-DESC
 13302           MOVE CL-INCURRED-DT   TO DC-BIN-DATE-1
 13303           MOVE SPACES           TO DC-OPTION-CODE
 13304           PERFORM 9800-CONVERT-DATE
 13305                                 THRU 9800-EXIT
 13306           MOVE DC-GREG-DATE-1-EDIT
 13307                                 TO SPLIT-INFO-OLD
 13308           PERFORM 2650-WRITE-MAINT-NOTE
 13309                                 THRU 2650-EXIT
 13310        END-IF
 13311     END-IF
 13312     .
 13313 2600-EXIT.
 13314      EXIT.
 13315
 13316 2650-WRITE-MAINT-NOTE.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 249
* EL131.cbl
 13317
 13318* EXEC CICS GETMAIN
 13319*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 13320*         LENGTH   (TRLR-LENGTH)
 13321*         INITIMG  (GETMAIN-SPACE)
 13322*    END-EXEC.
 13323*    MOVE ',"IL                  $   #00011581' TO DFHEIV0
 13324     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13325     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13326     MOVE X'2020233030303131353831' TO DFHEIV0(25:11)
 13327     CALL 'kxdfhei1' USING DFHEIV0,
 13328           DFHEIV20,
 13329           TRLR-LENGTH,
 13330           GETMAIN-SPACE
 13331     SET ADDRESS OF ACTIVITY-TRAILERS TO
 13332         DFHEIV20
 13333     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13334
 13335
 13336
 13337* EXEC CICS HANDLE CONDITION
 13338*         DUPREC   (2650-EXIT)
 13339*    END-EXEC.
 13340*    MOVE '"$%                   ! ; #00011587' TO DFHEIV0
 13341     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 13342     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13343     MOVE X'3B20233030303131353837' TO DFHEIV0(25:11)
 13344     CALL 'kxdfhei1' USING DFHEIV0
 13345     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13346
 13347
 13348     MOVE SPACES             TO ACTIVITY-TRAILERS.
 13349
 13350     IF CERTL GREATER ZERO
 13351         MOVE CERTI          TO CL-CERT-PRIME.
 13352
 13353     IF SUFXL GREATER ZERO
 13354         MOVE SUFXI          TO CL-CERT-SFX.
 13355
 13356     MOVE CL-CONTROL-PRIMARY TO AT-CONTROL-PRIMARY.
 13357
 13358     SUBTRACT 1 FROM  CL-TRAILER-SEQ-CNT.
 13359     MOVE CL-TRAILER-SEQ-CNT TO AT-SEQUENCE-NO.
 13360
 13361     MOVE 'AT'               TO AT-RECORD-ID.
 13362
 13363     MOVE '6'                TO AT-TRAILER-TYPE.
 13364     MOVE SAVE-BIN-DATE      TO AT-RECORDED-DT
 13365                                AT-GEN-INFO-LAST-MAINT-DT.
 13366     MOVE PI-PROCESSOR-ID    TO AT-RECORDED-BY
 13367                                AT-GEN-INFO-LAST-UPDATED-BY.
 13368     MOVE EIBTIME            TO AT-LAST-MAINT-HHMMSS.
 13369     MOVE SPLIT-INFO-LINE-1  TO AT-INFO-LINE-1.
 13370     MOVE 'M'                TO AT-INFO-TRAILER-TYPE.
 13371
 13372
 13373* EXEC CICS WRITE
 13374*         DATASET  (TRLR-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 250
* EL131.cbl
 13375*         RIDFLD   (AT-CONTROL-PRIMARY)
 13376*         FROM     (ACTIVITY-TRAILERS)
 13377*    END-EXEC.
 13378     MOVE LENGTH OF
 13379      ACTIVITY-TRAILERS
 13380       TO DFHEIV11
 13381*    MOVE '&$ L                  ''   #00011615' TO DFHEIV0
 13382     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13383     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13384     MOVE X'2020233030303131363135' TO DFHEIV0(25:11)
 13385     CALL 'kxdfhei1' USING DFHEIV0,
 13386           TRLR-FILE-ID,
 13387           ACTIVITY-TRAILERS,
 13388           DFHEIV11,
 13389           AT-CONTROL-PRIMARY,
 13390           DFHEIV99,
 13391           DFHEIV99
 13392     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13393
 13394
 13395 2650-EXIT.
 13396      EXIT.
 13397
 13398 2800-CHECK-AUTO-PAY.
 13399
 13400     MOVE PI-COMPANY-CD      TO TRLR-COMPANY-CD.
 13401     MOVE PI-CARRIER         TO TRLR-CARRIER.
 13402     MOVE PI-CLAIM-NO        TO TRLR-CLAIM-NO.
 13403     MOVE PI-CERT-NO         TO TRLR-CERT-NO.
 13404     MOVE PI-AUTO-PAY-SEQ    TO TRLR-SEQ-NO.
 13405
 13406
 13407* EXEC CICS HANDLE CONDITION
 13408*         NOTFND    (2800-EXIT)
 13409*         ENDFILE   (2800-EXIT)
 13410*    END-EXEC.
 13411*    MOVE '"$I''                  ! < #00011632' TO DFHEIV0
 13412     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 13413     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13414     MOVE X'3C20233030303131363332' TO DFHEIV0(25:11)
 13415     CALL 'kxdfhei1' USING DFHEIV0
 13416     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13417
 13418
 13419
 13420* EXEC CICS READ
 13421*        DATASET (TRLR-FILE-ID)
 13422*        SET     (ADDRESS OF ACTIVITY-TRAILERS)
 13423*        RIDFLD  (TRLR-KEY)
 13424*    END-EXEC.
 13425*    MOVE '&"S        E          (   #00011637' TO DFHEIV0
 13426     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13427     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13428     MOVE X'2020233030303131363337' TO DFHEIV0(25:11)
 13429     CALL 'kxdfhei1' USING DFHEIV0,
 13430           TRLR-FILE-ID,
 13431           DFHEIV20,
 13432           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 251
* EL131.cbl
 13433           TRLR-KEY,
 13434           DFHEIV99,
 13435           DFHEIV99,
 13436           DFHEIV99
 13437     SET ADDRESS OF ACTIVITY-TRAILERS TO
 13438         DFHEIV20
 13439     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13440
 13441
 13442     IF BENEFICIARY-PAID-AUTO
 13443         MOVE 'Y'              TO AUTO-PAY-TO-BENE
 13444     END-IF.
 13445
 13446 2800-EXIT.
 13447      EXIT.
 13448
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 252
* EL131.cbl
 13450 3000-DELETE-CLAIM.
 13451     IF  NOT MODIFY-CAP
 13452         MOVE ER-0070            TO EMI-ERROR
 13453         MOVE -1                 TO MAINTL
 13454         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13455         GO TO 8110-SEND-DATA.
 13456
 13457
 13458* EXEC CICS READ
 13459*         SET      (ADDRESS OF CLAIM-MASTER)
 13460*         DATASET  (CLMS-FILE-ID)
 13461*         RIDFLD   (MSTR-KEY)
 13462*    END-EXEC.
 13463*    MOVE '&"S        E          (   #00011658' TO DFHEIV0
 13464     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13465     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13466     MOVE X'2020233030303131363538' TO DFHEIV0(25:11)
 13467     CALL 'kxdfhei1' USING DFHEIV0,
 13468           CLMS-FILE-ID,
 13469           DFHEIV20,
 13470           DFHEIV99,
 13471           MSTR-KEY,
 13472           DFHEIV99,
 13473           DFHEIV99,
 13474           DFHEIV99
 13475     SET ADDRESS OF CLAIM-MASTER TO
 13476         DFHEIV20
 13477     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13478
 13479
 13480     IF CL-1ST-TRL-AVAIL
 13481         PERFORM 3010-DEL-MSTR-TRLR THRU 3010-EXIT
 13482     ELSE
 13483        MOVE MSTR-KEY            TO TRLR-MAIN-KEY
 13484        MOVE 0                   TO TRLR-SEQ-NO
 13485
 13486* EXEC CICS STARTBR
 13487*            DATASET (TRLR-FILE-ID)
 13488*            RIDFLD  (TRLR-KEY)
 13489*        END-EXEC
 13490     MOVE 0
 13491       TO DFHEIV11
 13492*    MOVE '&,         G          &   #00011669' TO DFHEIV0
 13493     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 13494     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13495     MOVE X'2020233030303131363639' TO DFHEIV0(25:11)
 13496     CALL 'kxdfhei1' USING DFHEIV0,
 13497           TRLR-FILE-ID,
 13498           TRLR-KEY,
 13499           DFHEIV99,
 13500           DFHEIV11,
 13501           DFHEIV99
 13502     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13503         PERFORM 3060-READ-TRLR THRU 3060-EXIT
 13504
 13505* EXEC CICS ENDBR
 13506*            DATASET (TRLR-FILE-ID)
 13507*        END-EXEC
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 253
* EL131.cbl
 13508     MOVE 0
 13509       TO DFHEIV11
 13510*    MOVE '&2                    $   #00011674' TO DFHEIV0
 13511     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 13512     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13513     MOVE X'2020233030303131363734' TO DFHEIV0(25:11)
 13514     CALL 'kxdfhei1' USING DFHEIV0,
 13515           TRLR-FILE-ID,
 13516           DFHEIV11,
 13517           DFHEIV99
 13518     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13519        IF SCREEN-ERROR
 13520            MOVE ER-0208         TO EMI-ERROR
 13521            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13522            MOVE -1              TO MAINTL
 13523            GO TO 8110-SEND-DATA
 13524        ELSE
 13525            PERFORM 3010-DEL-MSTR-TRLR THRU 3010-EXIT.
 13526
 13527     IF SCREEN-ERROR
 13528         MOVE -1                 TO MAINTL
 13529         GO TO 8110-SEND-DATA.
 13530
 13531     MOVE -1                     TO ONE-OR-MIN1.
 13532     PERFORM 7700-CHECK-SEQUENCE THRU 7799-EXIT.
 13533
 13534     IF WS-ASSOC-CERT-TOTAL NOT = ZERO
 13535         MOVE CL-CONTROL-PRIMARY TO MSTR-KEY
 13536                                    WS-SAVE-CLAIM-KEY
 13537         MOVE +1                 TO ONE-OR-MIN1
 13538         PERFORM 7710-RESEQUENCE-CLAIMS THRU 7799-EXIT.
 13539
 13540     MOVE 'D'                    TO PI-CLAIM-DELETED-SWITCH.
 13541
 13542     MOVE LOW-VALUES             TO EL131AO.
 13543     MOVE ER-0000                TO EMI-ERROR.
 13544     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13545     MOVE 'X'                    TO PI-RETURN-CD-1.
 13546     MOVE -1                     TO MAINTL.
 13547     GO TO 8100-SEND-MAP.
 13548
 13549 3010-DEL-MSTR-TRLR.
 13550
 13551* EXEC CICS READ UPDATE
 13552*         SET       (ADDRESS OF CLAIM-MASTER)
 13553*         DATASET   (CLMS-FILE-ID)
 13554*         RIDFLD    (MSTR-KEY)
 13555*    END-EXEC.
 13556*    MOVE '&"S        EU         (   #00011708' TO DFHEIV0
 13557     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13558     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13559     MOVE X'2020233030303131373038' TO DFHEIV0(25:11)
 13560     CALL 'kxdfhei1' USING DFHEIV0,
 13561           CLMS-FILE-ID,
 13562           DFHEIV20,
 13563           DFHEIV99,
 13564           MSTR-KEY,
 13565           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 254
* EL131.cbl
 13566           DFHEIV99,
 13567           DFHEIV99
 13568     SET ADDRESS OF CLAIM-MASTER TO
 13569         DFHEIV20
 13570     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13571
 13572
 13573     if (cl-priority-cd = '8')
 13574        and (pi-processor-id not = 'PEMA' and 'JMS '
 13575             AND 'AMWA')
 13576        MOVE ER-8003             TO EMI-ERROR
 13577        PERFORM 9900-ERROR-FORMAT
 13578                                 THRU 9900-EXIT
 13579        MOVE -1                  TO MAINTL
 13580        GO TO 8110-SEND-DATA
 13581     end-if
 13582
 13583     MOVE MSTR-KEY               TO TRLR-MAIN-KEY ACTQ-KEY.
 13584     MOVE ZERO                   TO TRLR-SEQ-NO.
 13585
 13586
 13587* EXEC CICS HANDLE CONDITION
 13588*         NOTFND    (3010-DEL-ACTQ)
 13589*         ENDFILE   (3040-EXIT)
 13590*    END-EXEC.
 13591*    MOVE '"$I''                  ! = #00011727' TO DFHEIV0
 13592     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 13593     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13594     MOVE X'3D20233030303131373237' TO DFHEIV0(25:11)
 13595     CALL 'kxdfhei1' USING DFHEIV0
 13596     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13597
 13598
 13599     PERFORM 3040-DELETE-TRLR THRU 3040-EXIT.
 13600
 13601 3010-DEL-ACTQ.
 13602
 13603
 13604* EXEC CICS HANDLE CONDITION
 13605*         NOTFND    (3010-NO-ACTIVITY)
 13606*         ENDFILE   (3050-EXIT)
 13607*    END-EXEC.
 13608*    MOVE '"$I''                  ! > #00011736' TO DFHEIV0
 13609     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 13610     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13611     MOVE X'3E20233030303131373336' TO DFHEIV0(25:11)
 13612     CALL 'kxdfhei1' USING DFHEIV0
 13613     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13614
 13615
 13616
 13617* EXEC CICS STARTBR
 13618*         DATASET  (ACTQ-FILE-ID)
 13619*         RIDFLD   (ACTQ-KEY)
 13620*    END-EXEC.
 13621     MOVE 0
 13622       TO DFHEIV11
 13623*    MOVE '&,         G          &   #00011741' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 255
* EL131.cbl
 13624     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 13625     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13626     MOVE X'2020233030303131373431' TO DFHEIV0(25:11)
 13627     CALL 'kxdfhei1' USING DFHEIV0,
 13628           ACTQ-FILE-ID,
 13629           ACTQ-KEY,
 13630           DFHEIV99,
 13631           DFHEIV11,
 13632           DFHEIV99
 13633     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13634
 13635
 13636
 13637* EXEC CICS GETMAIN
 13638*         SET      (ADDRESS OF ACTIVITY-QUE)
 13639*         LENGTH   (ACTQ-LENGTH)
 13640*         INITIMG  (GETMAIN-SPACE)
 13641*    END-EXEC.
 13642*    MOVE ',"IL                  $   #00011746' TO DFHEIV0
 13643     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13644     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13645     MOVE X'2020233030303131373436' TO DFHEIV0(25:11)
 13646     CALL 'kxdfhei1' USING DFHEIV0,
 13647           DFHEIV20,
 13648           ACTQ-LENGTH,
 13649           GETMAIN-SPACE
 13650     SET ADDRESS OF ACTIVITY-QUE TO
 13651         DFHEIV20
 13652     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13653
 13654
 13655     PERFORM 3050-DELETE-ACTQ THRU 3050-EXIT.
 13656
 13657
 13658* EXEC CICS ENDBR
 13659*         DATASET (ACTQ-FILE-ID)
 13660*    END-EXEC.
 13661     MOVE 0
 13662       TO DFHEIV11
 13663*    MOVE '&2                    $   #00011754' TO DFHEIV0
 13664     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 13665     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13666     MOVE X'2020233030303131373534' TO DFHEIV0(25:11)
 13667     CALL 'kxdfhei1' USING DFHEIV0,
 13668           ACTQ-FILE-ID,
 13669           DFHEIV11,
 13670           DFHEIV99
 13671     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13672
 13673
 13674 3010-NO-ACTIVITY.
 13675
 13676
 13677* EXEC CICS HANDLE CONDITION
 13678*        NOTFND   (3010-CERT-NOT-FOUND)
 13679*    END-EXEC.
 13680*    MOVE '"$I                   ! ? #00011760' TO DFHEIV0
 13681     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 256
* EL131.cbl
 13682     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13683     MOVE X'3F20233030303131373630' TO DFHEIV0(25:11)
 13684     CALL 'kxdfhei1' USING DFHEIV0
 13685     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13686
 13687
 13688     MOVE CL-COMPANY-CD          TO CERT-COMPANY-CODE.
 13689     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
 13690     MOVE CL-CERT-GROUPING       TO CERT-GROUP.
 13691     MOVE CL-CERT-STATE          TO CERT-STATE.
 13692     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
 13693     MOVE CL-CERT-EFF-DT         TO CERT-DATE.
 13694     MOVE CL-CERT-NO             TO CERT-CERT.
 13695
 13696
 13697* EXEC CICS READ
 13698*        DATASET   (CERT-FILE-ID)
 13699*        RIDFLD    (CERT-KEY)
 13700*        SET       (ADDRESS OF CERTIFICATE-MASTER)
 13701*    END-EXEC.
 13702*    MOVE '&"S        E          (   #00011772' TO DFHEIV0
 13703     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13704     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13705     MOVE X'2020233030303131373732' TO DFHEIV0(25:11)
 13706     CALL 'kxdfhei1' USING DFHEIV0,
 13707           CERT-FILE-ID,
 13708           DFHEIV20,
 13709           DFHEIV99,
 13710           CERT-KEY,
 13711           DFHEIV99,
 13712           DFHEIV99,
 13713           DFHEIV99
 13714     SET ADDRESS OF CERTIFICATE-MASTER TO
 13715         DFHEIV20
 13716     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13717
 13718
 13719     IF CERT-WAS-CREATED AND CM-CLAIM-ATTACHED-COUNT = 1
 13720       AND PI-COMPANY-ID NOT EQUAL 'AHL'
 13721         PERFORM 3030-DELETE-CERT THRU 3030-EXIT
 13722     ELSE
 13723         PERFORM 3020-UPDATE-CERT THRU 3020-EXIT.
 13724
 13725 3010-UPDATE-CERT-TRLR.
 13726
 13727     MOVE CERT-KEY               TO ELCRTT-KEY
 13728     MOVE 'B'                    TO CTRLR-REC-TYPE
 13729
 13730* EXEC CICS READ
 13731*       UPDATE
 13732*       DATASET   ('ELCRTT')
 13733*       RIDFLD    (ELCRTT-KEY)
 13734*       INTO      (CERTIFICATE-TRAILERS)
 13735*       RESP      (WS-RESPONSE)
 13736*    END-EXEC
 13737     MOVE LENGTH OF
 13738      CERTIFICATE-TRAILERS
 13739       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 257
* EL131.cbl
 13740     MOVE 'ELCRTT' TO DFHEIV1
 13741*    MOVE '&"IL       EU         (  N#00011788' TO DFHEIV0
 13742     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 13743     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13744     MOVE X'204E233030303131373838' TO DFHEIV0(25:11)
 13745     CALL 'kxdfhei1' USING DFHEIV0,
 13746           DFHEIV1,
 13747           CERTIFICATE-TRAILERS,
 13748           DFHEIV11,
 13749           ELCRTT-KEY,
 13750           DFHEIV99,
 13751           DFHEIV99,
 13752           DFHEIV99
 13753     MOVE EIBRESP  TO WS-RESPONSE
 13754     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13755     IF WS-RESP-NORMAL
 13756        perform varying s1 from +1 by +1 until
 13757           (s1 > +24)
 13758           or (cs-claim-no (s1) = cl-claim-no)
 13759        end-perform
 13760        if s1 < +25
 13761           move spaces           to cs-claim-no (s1)
 13762                                    cs-claim-type (s1)
 13763                                    cs-insured-type (s1)
 13764           move zeros            to cs-days-paid (s1)
 13765                                    cs-total-paid (s1)
 13766                                    cs-benefit-period (s1)
 13767           if s1 not = +24
 13768              compute s2 = s1 + +1
 13769              perform 3015-bump  thru 3015-exit
 13770           end-if
 13771
 13772* EXEC CICS REWRITE
 13773*             DATASET   ('ELCRTT')
 13774*             FROM      (CERTIFICATE-TRAILERS)
 13775*          END-EXEC
 13776     MOVE LENGTH OF
 13777      CERTIFICATE-TRAILERS
 13778       TO DFHEIV11
 13779     MOVE 'ELCRTT' TO DFHEIV1
 13780*    MOVE '&& L                  %   #00011811' TO DFHEIV0
 13781     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13782     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13783     MOVE X'2020233030303131383131' TO DFHEIV0(25:11)
 13784     CALL 'kxdfhei1' USING DFHEIV0,
 13785           DFHEIV1,
 13786           CERTIFICATE-TRAILERS,
 13787           DFHEIV11,
 13788           DFHEIV99
 13789     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13790        end-if
 13791     end-if
 13792     .
 13793 3010-CERT-NOT-FOUND.
 13794
 13795
 13796* EXEC CICS DELETE
 13797*        DATASET  (CLMS-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 258
* EL131.cbl
 13798*    END-EXEC.
 13799*    MOVE '&(                    &   #00011820' TO DFHEIV0
 13800     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13801     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13802     MOVE X'2020233030303131383230' TO DFHEIV0(25:11)
 13803     CALL 'kxdfhei1' USING DFHEIV0,
 13804           CLMS-FILE-ID,
 13805           DFHEIV99,
 13806           DFHEIV99,
 13807           DFHEIV99,
 13808           DFHEIV99
 13809     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13810
 13811
 13812 3010-EXIT.
 13813      EXIT.
 13814
 13815 3015-bump.
 13816     perform varying s2 from s2 by +1 until s2 > +24
 13817        move cs-mb-claim-data (s2)
 13818                                 to cs-mb-claim-data (s1)
 13819        move spaces              to cs-mb-claim-data (s2)
 13820        add +1 to s1
 13821     end-perform
 13822     .
 13823 3015-exit.
 13824     exit.
 13825 3020-UPDATE-CERT.
 13826
 13827* EXEC CICS READ UPDATE
 13828*         DATASET  (CERT-FILE-ID)
 13829*         RIDFLD   (CERT-KEY)
 13830*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 13831*    END-EXEC.
 13832*    MOVE '&"S        EU         (   #00011838' TO DFHEIV0
 13833     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13834     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13835     MOVE X'2020233030303131383338' TO DFHEIV0(25:11)
 13836     CALL 'kxdfhei1' USING DFHEIV0,
 13837           CERT-FILE-ID,
 13838           DFHEIV20,
 13839           DFHEIV99,
 13840           CERT-KEY,
 13841           DFHEIV99,
 13842           DFHEIV99,
 13843           DFHEIV99
 13844     SET ADDRESS OF CERTIFICATE-MASTER TO
 13845         DFHEIV20
 13846     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13847
 13848
 13849     SUBTRACT 1       FROM CM-CLAIM-ATTACHED-COUNT.
 13850
 13851
 13852* EXEC CICS HANDLE CONDITION
 13853*         DUPKEY   (3020-EXIT)
 13854*    END-EXEC.
 13855*    MOVE '"$$                   ! @ #00011846' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 259
* EL131.cbl
 13856     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 13857     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13858     MOVE X'4020233030303131383436' TO DFHEIV0(25:11)
 13859     CALL 'kxdfhei1' USING DFHEIV0
 13860     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13861
 13862
 13863
 13864* EXEC CICS REWRITE
 13865*         DATASET  (CERT-FILE-ID)
 13866*         FROM     (CERTIFICATE-MASTER)
 13867*    END-EXEC.
 13868     MOVE LENGTH OF
 13869      CERTIFICATE-MASTER
 13870       TO DFHEIV11
 13871*    MOVE '&& L                  %   #00011850' TO DFHEIV0
 13872     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13873     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13874     MOVE X'2020233030303131383530' TO DFHEIV0(25:11)
 13875     CALL 'kxdfhei1' USING DFHEIV0,
 13876           CERT-FILE-ID,
 13877           CERTIFICATE-MASTER,
 13878           DFHEIV11,
 13879           DFHEIV99
 13880     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13881
 13882
 13883 3020-EXIT.
 13884     EXIT.
 13885
 13886 3030-DELETE-CERT.
 13887
 13888* EXEC CICS READ UPDATE
 13889*         DATASET  (CERT-FILE-ID)
 13890*         RIDFLD   (CERT-KEY)
 13891*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 13892*    END-EXEC.
 13893*    MOVE '&"S        EU         (   #00011859' TO DFHEIV0
 13894     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13895     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13896     MOVE X'2020233030303131383539' TO DFHEIV0(25:11)
 13897     CALL 'kxdfhei1' USING DFHEIV0,
 13898           CERT-FILE-ID,
 13899           DFHEIV20,
 13900           DFHEIV99,
 13901           CERT-KEY,
 13902           DFHEIV99,
 13903           DFHEIV99,
 13904           DFHEIV99
 13905     SET ADDRESS OF CERTIFICATE-MASTER TO
 13906         DFHEIV20
 13907     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13908
 13909
 13910
 13911* EXEC CICS DELETE
 13912*         DATASET   (CERT-FILE-ID)
 13913*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 260
* EL131.cbl
 13914*    MOVE '&(                    &   #00011865' TO DFHEIV0
 13915     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13916     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13917     MOVE X'2020233030303131383635' TO DFHEIV0(25:11)
 13918     CALL 'kxdfhei1' USING DFHEIV0,
 13919           CERT-FILE-ID,
 13920           DFHEIV99,
 13921           DFHEIV99,
 13922           DFHEIV99,
 13923           DFHEIV99
 13924     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13925
 13926
 13927 3030-EXIT.
 13928     EXIT.
 13929
 13930 3040-DELETE-TRLR.
 13931
 13932* EXEC CICS READ
 13933*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 13934*         DATASET  (TRLR-FILE-ID)
 13935*         RIDFLD   (TRLR-KEY)
 13936*         GTEQ
 13937*    END-EXEC.
 13938*    MOVE '&"S        G          (   #00011873' TO DFHEIV0
 13939     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 13940     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13941     MOVE X'2020233030303131383733' TO DFHEIV0(25:11)
 13942     CALL 'kxdfhei1' USING DFHEIV0,
 13943           TRLR-FILE-ID,
 13944           DFHEIV20,
 13945           DFHEIV99,
 13946           TRLR-KEY,
 13947           DFHEIV99,
 13948           DFHEIV99,
 13949           DFHEIV99
 13950     SET ADDRESS OF ACTIVITY-TRAILERS TO
 13951         DFHEIV20
 13952     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13953
 13954
 13955     IF PI-COMPANY-CD = AT-COMPANY-CD
 13956        MOVE AT-CONTROL-PRIMARY  TO TRLR-KEY
 13957        IF TRLR-MAIN-KEY GREATER THAN CL-CONTROL-PRIMARY
 13958           GO TO 3040-EXIT
 13959        ELSE
 13960           NEXT SENTENCE
 13961     ELSE
 13962        GO TO 3040-EXIT.
 13963
 13964
 13965* EXEC CICS DELETE
 13966*         DATASET  (TRLR-FILE-ID)
 13967*         RIDFLD   (TRLR-KEY)
 13968*    END-EXEC.
 13969*    MOVE '&(  R                 &   #00011889' TO DFHEIV0
 13970     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
 13971     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 261
* EL131.cbl
 13972     MOVE X'2020233030303131383839' TO DFHEIV0(25:11)
 13973     CALL 'kxdfhei1' USING DFHEIV0,
 13974           TRLR-FILE-ID,
 13975           TRLR-KEY,
 13976           DFHEIV99,
 13977           DFHEIV99,
 13978           DFHEIV99
 13979     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13980
 13981
 13982     GO TO 3040-DELETE-TRLR.
 13983
 13984 3040-EXIT.
 13985     EXIT.
 13986
 13987 3050-DELETE-ACTQ.
 13988
 13989* EXEC CICS READNEXT
 13990*         DATASET  (ACTQ-FILE-ID)
 13991*         RIDFLD   (ACTQ-KEY)
 13992*         INTO     (ACTIVITY-QUE)
 13993*    END-EXEC.
 13994     MOVE LENGTH OF
 13995      ACTIVITY-QUE
 13996       TO DFHEIV12
 13997     MOVE 0
 13998       TO DFHEIV11
 13999*    MOVE '&.IL                  )   #00011900' TO DFHEIV0
 14000     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 14001     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 14002     MOVE X'2020233030303131393030' TO DFHEIV0(25:11)
 14003     CALL 'kxdfhei1' USING DFHEIV0,
 14004           ACTQ-FILE-ID,
 14005           ACTIVITY-QUE,
 14006           DFHEIV12,
 14007           ACTQ-KEY,
 14008           DFHEIV99,
 14009           DFHEIV11,
 14010           DFHEIV99,
 14011           DFHEIV99
 14012     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14013
 14014
 14015     IF ACTQ-KEY GREATER THAN CL-CONTROL-PRIMARY
 14016         GO TO 3050-EXIT.
 14017
 14018
 14019* EXEC CICS ENDBR
 14020*         DATASET  (ACTQ-FILE-ID)
 14021*    END-EXEC.
 14022     MOVE 0
 14023       TO DFHEIV11
 14024*    MOVE '&2                    $   #00011909' TO DFHEIV0
 14025     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 14026     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14027     MOVE X'2020233030303131393039' TO DFHEIV0(25:11)
 14028     CALL 'kxdfhei1' USING DFHEIV0,
 14029           ACTQ-FILE-ID,
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 262
* EL131.cbl
 14030           DFHEIV11,
 14031           DFHEIV99
 14032     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14033
 14034
 14035
 14036* EXEC CICS DELETE
 14037*         DATASET   (ACTQ-FILE-ID)
 14038*         RIDFLD    (ACTQ-KEY)
 14039*    END-EXEC.
 14040*    MOVE '&(  R                 &   #00011913' TO DFHEIV0
 14041     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
 14042     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14043     MOVE X'2020233030303131393133' TO DFHEIV0(25:11)
 14044     CALL 'kxdfhei1' USING DFHEIV0,
 14045           ACTQ-FILE-ID,
 14046           ACTQ-KEY,
 14047           DFHEIV99,
 14048           DFHEIV99,
 14049           DFHEIV99
 14050     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14051
 14052
 14053
 14054* EXEC CICS STARTBR
 14055*         DATASET   (ACTQ-FILE-ID)
 14056*         RIDFLD    (ACTQ-KEY)
 14057*    END-EXEC.
 14058     MOVE 0
 14059       TO DFHEIV11
 14060*    MOVE '&,         G          &   #00011918' TO DFHEIV0
 14061     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 14062     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14063     MOVE X'2020233030303131393138' TO DFHEIV0(25:11)
 14064     CALL 'kxdfhei1' USING DFHEIV0,
 14065           ACTQ-FILE-ID,
 14066           ACTQ-KEY,
 14067           DFHEIV99,
 14068           DFHEIV11,
 14069           DFHEIV99
 14070     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14071
 14072
 14073     GO TO 3050-DELETE-ACTQ.
 14074
 14075 3050-EXIT.
 14076     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 263
* EL131.cbl
 14078 3060-READ-TRLR.
 14079
 14080* EXEC CICS HANDLE CONDITION
 14081*         NOTFND    (3060-EXIT)
 14082*         ENDFILE   (3060-EXIT)
 14083*    END-EXEC.
 14084*    MOVE '"$I''                  ! A #00011929' TO DFHEIV0
 14085     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 14086     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14087     MOVE X'4120233030303131393239' TO DFHEIV0(25:11)
 14088     CALL 'kxdfhei1' USING DFHEIV0
 14089     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14090
 14091
 14092 3060-LOOP.
 14093
 14094* EXEC CICS READNEXT
 14095*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 14096*         DATASET  (TRLR-FILE-ID)
 14097*         RIDFLD   (TRLR-KEY)
 14098*    END-EXEC.
 14099     MOVE 0
 14100       TO DFHEIV11
 14101*    MOVE '&.S                   )   #00011935' TO DFHEIV0
 14102     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 14103     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 14104     MOVE X'2020233030303131393335' TO DFHEIV0(25:11)
 14105     CALL 'kxdfhei1' USING DFHEIV0,
 14106           TRLR-FILE-ID,
 14107           DFHEIV20,
 14108           DFHEIV99,
 14109           TRLR-KEY,
 14110           DFHEIV99,
 14111           DFHEIV11,
 14112           DFHEIV99,
 14113           DFHEIV99
 14114     SET ADDRESS OF ACTIVITY-TRAILERS TO
 14115         DFHEIV20
 14116     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14117
 14118
 14119     IF TRLR-MAIN-KEY GREATER THAN CL-CONTROL-PRIMARY
 14120         GO TO 3060-EXIT.
 14121
 14122     IF FORM-CONTROL-TR
 14123         IF AT-RECORDED-DT = SAVE-BIN-DATE
 14124             NEXT SENTENCE
 14125         ELSE
 14126             MOVE 'X'            TO ERROR-SWITCH
 14127             GO TO 3060-EXIT
 14128     ELSE
 14129         IF PAYMENT-TR OR CORRESPONDENCE-TR
 14130            MOVE 'X'                 TO ERROR-SWITCH
 14131            GO TO 3060-EXIT.
 14132
 14133     GO TO 3060-LOOP.
 14134
 14135 3060-EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 264
* EL131.cbl
 14136     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 265
* EL131.cbl
 14138 3997-GET-ERPDEF.
 14139
 14140     move cl-company-cd          to cert-company-code
 14141     move cl-cert-key-data       to cert-key (2:21)
 14142     move cl-cert-no             to cert-cert
 14143
 14144
 14145* EXEC CICS READ
 14146*        DATASET   (CERT-FILE-ID)
 14147*        RIDFLD    (CERT-KEY)
 14148*        SET       (ADDRESS OF CERTIFICATE-MASTER)
 14149*        resp      (ws-response)
 14150*    END-EXEC
 14151*    MOVE '&"S        E          (  N#00011966' TO DFHEIV0
 14152     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14153     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14154     MOVE X'204E233030303131393636' TO DFHEIV0(25:11)
 14155     CALL 'kxdfhei1' USING DFHEIV0,
 14156           CERT-FILE-ID,
 14157           DFHEIV20,
 14158           DFHEIV99,
 14159           CERT-KEY,
 14160           DFHEIV99,
 14161           DFHEIV99,
 14162           DFHEIV99
 14163     SET ADDRESS OF CERTIFICATE-MASTER TO
 14164         DFHEIV20
 14165     MOVE EIBRESP  TO ws-response
 14166     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14167
 14168     MOVE SPACES                 TO WS-CRIT-PER-ALPHA
 14169                                    WS-ERPDEF-SW
 14170     MOVE ZEROS                  TO WS-CRITICAL-PERIOD
 14171                                    WS-CRIT-PER-RTW-MOS
 14172
 14173     if cm-clp-state = spaces or low-values or zeros
 14174        move cm-state            to cm-clp-state
 14175     end-if
 14176     MOVE PI-COMPANY-CD          TO ERPDEF-KEY
 14177     MOVE CM-clp-state           TO ERPDEF-STATE
 14178     MOVE am-dcc-product-code    TO ERPDEF-PROD-CD
 14179     evaluate true
 14180        when (cl-claim-type = 'L' or 'P')
 14181           and (cm-lf-benefit-cd not = '00' and '  ' and 'DD'
 14182             and 'CU')
 14183           move 'L'              to erpdef-ben-type
 14184           move cm-lf-benefit-cd to erpdef-ben-code
 14185        when (cl-claim-type not = 'L' and 'P')
 14186           and (cm-ah-benefit-cd not = '00' and '  ')
 14187           move 'A'              to erpdef-ben-type
 14188           move cm-ah-benefit-cd to erpdef-ben-code
 14189        when (cl-claim-type not = 'L' and 'P')
 14190           and (cm-ah-benefit-cd = '00' or '  ')
 14191           move 'L'              to erpdef-ben-type
 14192           move cm-lf-benefit-cd to erpdef-ben-code
 14193        when (cl-claim-type = 'L' or 'P')
 14194           and (cm-lf-benefit-cd = '00' or '  ' or 'DD' or 'CU')
 14195           move 'A'              to erpdef-ben-type
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 266
* EL131.cbl
 14196           move cm-ah-benefit-cd to erpdef-ben-code
 14197        when other
 14198           move 'A'              to erpdef-ben-type
 14199           move cm-ah-benefit-cd to erpdef-ben-code
 14200     end-evaluate
 14201
 14202*    if (cl-claim-type = 'L' or 'P')
 14203*       and (cm-lf-benefit-cd not = '00' and '  ' and 'DD'
 14204*          and 'CU')
 14205*       move 'L'                 to erpdef-ben-type
 14206*       move cm-lf-benefit-cd    to erpdef-ben-code
 14207*    else
 14208*       MOVE 'A'                 TO ERPDEF-BEN-TYPE
 14209*       MOVE CM-AH-BENEFIT-CD    TO ERPDEF-BEN-CODE
 14210*    end-if
 14211     MOVE CM-CERT-EFF-DT         TO ERPDEF-EXP-DT
 14212     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
 14213
 14214
 14215* EXEC CICS STARTBR
 14216*        DATASET  ('ERPDEF')
 14217*        RIDFLD   (ERPDEF-KEY)
 14218*        GTEQ
 14219*        RESP     (WS-RESPONSE)
 14220*    END-EXEC
 14221     MOVE 'ERPDEF' TO DFHEIV1
 14222     MOVE 0
 14223       TO DFHEIV11
 14224*    MOVE '&,         G          &  N#00012019' TO DFHEIV0
 14225     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 14226     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14227     MOVE X'204E233030303132303139' TO DFHEIV0(25:11)
 14228     CALL 'kxdfhei1' USING DFHEIV0,
 14229           DFHEIV1,
 14230           ERPDEF-KEY,
 14231           DFHEIV99,
 14232           DFHEIV11,
 14233           DFHEIV99
 14234     MOVE EIBRESP  TO WS-RESPONSE
 14235     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14236
 14237     IF WS-RESP-NORMAL
 14238
 14239* EXEC CICS READNEXT
 14240*          DATASET  ('ERPDEF')
 14241*          INTO     (PRODUCT-MASTER)
 14242*          RIDFLD   (ERPDEF-KEY)
 14243*          RESP     (WS-RESPONSE)
 14244*       END-EXEC
 14245     MOVE LENGTH OF
 14246      PRODUCT-MASTER
 14247       TO DFHEIV12
 14248     MOVE 'ERPDEF' TO DFHEIV1
 14249     MOVE 0
 14250       TO DFHEIV11
 14251*    MOVE '&.IL                  )  N#00012027' TO DFHEIV0
 14252     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 14253     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 267
* EL131.cbl
 14254     MOVE X'204E233030303132303237' TO DFHEIV0(25:11)
 14255     CALL 'kxdfhei1' USING DFHEIV0,
 14256           DFHEIV1,
 14257           PRODUCT-MASTER,
 14258           DFHEIV12,
 14259           ERPDEF-KEY,
 14260           DFHEIV99,
 14261           DFHEIV11,
 14262           DFHEIV99,
 14263           DFHEIV99
 14264     MOVE EIBRESP  TO WS-RESPONSE
 14265     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14266        IF WS-RESP-NORMAL
 14267           IF (ERPDEF-KEY-SAVE (1:16) =
 14268              PD-CONTROL-PRIMARY (1:16))
 14269              AND (CM-CERT-EFF-DT < PD-PROD-EXP-DT)
 14270              PERFORM VARYING A1 FROM +1 BY +1 UNTIL
 14271                 (A1 > +8)
 14272                 OR (PD-PROD-CODE (A1) = cl-claim-type)
 14273              END-PERFORM
 14274              IF A1 < +9
 14275                 SET ERPDEF-FOUND TO TRUE
 14276                 MOVE PD-CRIT-PERIOD (A1)
 14277                              TO WS-CRITICAL-PERIOD
 14278                 MOVE PD-REC-CRIT-PERIOD (A1)
 14279                              TO WS-CRIT-PER-RECURRENT
 14280                 IF PD-RTW-MOS (A1) NUMERIC
 14281                    MOVE PD-RTW-MOS (A1)
 14282                              TO WS-CRIT-PER-RTW-MOS
 14283                 ELSE
 14284                    MOVE 0    TO WS-CRIT-PER-RTW-MOS
 14285                 END-IF
 14286                 IF PD-EXCLUSION-PERIOD-DAYS (A1) NUMERIC
 14287                    MOVE PD-EXCLUSION-PERIOD-DAYS (A1)
 14288                                 TO WS-EXCL-PERIOD
 14289                 END-IF
 14290                 IF PD-COVERAGE-ENDS-MOS (A1) NUMERIC
 14291                    MOVE PD-COVERAGE-ENDS-MOS (A1)
 14292                                 TO WS-COV-ENDS
 14293                 END-IF
 14294                 IF PD-ACCIDENT-ONLY-MOS (A1) NUMERIC
 14295                    MOVE PD-ACCIDENT-ONLY-MOS (A1)
 14296                                 TO WS-ACC-PERIOD
 14297                 END-IF
 14298                 if pd-max-extension (a1) numeric
 14299                    move pd-max-extension (a1)
 14300                                 to ws-max-extension
 14301                 end-if
 14302                 if pd-max-amt (a1) numeric
 14303                    move pd-max-amt (a1)
 14304                                 to ws-max-moben
 14305                 end-if
 14306              END-IF
 14307           END-IF
 14308        END-IF
 14309     END-IF
 14310
 14311     .
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 268
* EL131.cbl
 14312 3997-EXIT.
 14313     EXIT.
 14314 4000-FORCE-ERRORS.
 14315     IF PI-RETURN-CD-1 = 'X'
 14316         MOVE ER-0311            TO EMI-ERROR
 14317         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14318         MOVE -1                 TO MAINTL
 14319         GO TO 8110-SEND-DATA.
 14320
 14321     IF NOT FORCE-CAP
 14322         MOVE ER-0416            TO EMI-ERROR
 14323         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14324         MOVE -1                 TO MAINTL
 14325         GO TO 8110-SEND-DATA.
 14326
 14327     MOVE 'F'                    TO EMI-ACTION-SWITCH.
 14328     PERFORM 1000-EDIT-SCREEN THRU 1010-EXIT.
 14329     IF EMI-FATAL-CTR GREATER THAN ZERO
 14330         GO TO 4000-FATAL-ERRORS.
 14331
 14332     PERFORM 2000-UPDATE-CLAIM THRU 2000-EXIT.
 14333
 14334     IF EMI-FATAL-CTR GREATER THAN ZERO
 14335         GO TO 4000-FATAL-ERRORS.
 14336
 14337     PERFORM 5000-BUILD-MAP THRU 5000-EXIT.
 14338
 14339     IF EMI-FATAL-CTR GREATER THAN ZERO
 14340         GO TO 4000-FATAL-ERRORS.
 14341
 14342     MOVE SPACE                  TO EMI-ACTION-SWITCH MAINTO.
 14343     MOVE AL-UANOF               TO CERTA.
 14344     MOVE ER-0000 TO EMI-ERROR.
 14345     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14346
 14347 4000-FATAL-ERRORS.
 14348     MOVE -1                     TO MAINTL.
 14349     GO TO 8110-SEND-DATA.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 269
* EL131.cbl
 14351
 14352 4100-SAVE-CHANGES.
 14353     IF MAINTL > 0
 14354         MOVE MAINTI  TO WS-SAVE-MAINTI
 14355         MOVE MAINTL  TO WS-SAVE-MAINTL
 14356     END-IF
 14357     IF STATUSL > 0
 14358         MOVE STATUSI  TO WS-SAVE-STATUSI
 14359         MOVE STATUSL  TO WS-SAVE-STATUSL
 14360     END-IF
 14361     IF REPL > 0
 14362         MOVE REPI  TO WS-SAVE-REPI
 14363         MOVE REPL  TO WS-SAVE-REPL
 14364     END-IF
 14365*    IF CAUSEL > 0
 14366*        MOVE CAUSEI  TO WS-SAVE-CAUSEI
 14367*        MOVE CAUSEL  TO WS-SAVE-CAUSEL
 14368*    END-IF
 14369*    IF ENDL > 0
 14370*        MOVE ENDI  TO WS-SAVE-ENDI
 14371*        MOVE ENDL  TO WS-SAVE-ENDL
 14372*    END-IF
 14373     IF DIAGL > 0
 14374         MOVE DIAGI  TO WS-SAVE-DIAGI
 14375         MOVE DIAGL  TO WS-SAVE-DIAGL
 14376     END-IF
 14377     IF ICD1L > 0
 14378         MOVE ICD1I  TO WS-SAVE-ICD1I
 14379         MOVE ICD1L  TO WS-SAVE-ICD1L
 14380     END-IF
 14381     IF ICD2L > 0
 14382         MOVE ICD2I  TO WS-SAVE-ICD2I
 14383         MOVE ICD2L  TO WS-SAVE-ICD2L
 14384     END-IF
 14385     IF BENEL > 0
 14386         MOVE BENEI  TO WS-SAVE-BENEI
 14387         MOVE BENEL  TO WS-SAVE-BENEL
 14388     END-IF
 14389     IF BIRTHL > 0
 14390         MOVE BIRTHI  TO WS-SAVE-BIRTHI
 14391         MOVE BIRTHL  TO WS-SAVE-BIRTHL
 14392     END-IF
 14393     IF SOCIALL > 0
 14394         MOVE SOCIALI  TO WS-SAVE-SOCIALI
 14395         MOVE SOCIALL  TO WS-SAVE-SOCIALL
 14396     END-IF
 14397     IF SEXL > 0
 14398         MOVE SEXI  TO WS-SAVE-SEXI
 14399         MOVE SEXL  TO WS-SAVE-SEXL
 14400     END-IF
 14401     IF MLNAMEL > 0
 14402         MOVE MLNAMEI  TO WS-SAVE-MLNAMEI
 14403         MOVE MLNAMEL  TO WS-SAVE-MLNAMEL
 14404     END-IF
 14405     IF MFNAMEL > 0
 14406         MOVE MFNAMEI  TO WS-SAVE-MFNAMEI
 14407         MOVE MFNAMEL  TO WS-SAVE-MFNAMEL
 14408     END-IF
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 270
* EL131.cbl
 14409     IF MMINITL > 0
 14410         MOVE MMINITI  TO WS-SAVE-MMINITI
 14411         MOVE MMINITL  TO WS-SAVE-MMINITL
 14412     END-IF
 14413*    IF LOANNOL > 0
 14414*        MOVE LOANNOI  TO WS-SAVE-LOANNOI
 14415*        MOVE LOANNOL  TO WS-SAVE-LOANNOL
 14416*    END-IF
 14417     IF LOANBALL > 0
 14418         MOVE LOANBALI  TO WS-SAVE-LOANBALI
 14419         MOVE LOANBALL  TO WS-SAVE-LOANBALL
 14420     END-IF
 14421     IF PROCL > 0
 14422         MOVE PROCI  TO WS-SAVE-PROCI
 14423         MOVE PROCL  TO WS-SAVE-PROCL
 14424     END-IF
 14425     IF SUPVL > 0
 14426         MOVE SUPVI  TO WS-SAVE-SUPVI
 14427         MOVE SUPVL  TO WS-SAVE-SUPVL
 14428     END-IF
 14429     IF PRICDL > 0
 14430         MOVE PRICDI  TO WS-SAVE-PRICDI
 14431         MOVE PRICDL  TO WS-SAVE-PRICDL
 14432     END-IF
 14433     IF FILETOL > 0
 14434         MOVE FILETOI  TO WS-SAVE-FILETOI
 14435         MOVE FILETOL  TO WS-SAVE-FILETOL
 14436     END-IF
 14437     IF PDTHRUL > 0
 14438         MOVE PDTHRUI  TO WS-SAVE-PDTHRUI
 14439         MOVE PDTHRUL  TO WS-SAVE-PDTHRUL
 14440     END-IF
 14441     IF PDAMTL > 0
 14442         MOVE PDAMTI  TO WS-SAVE-PDAMTI
 14443         MOVE PDAMTL  TO WS-SAVE-PDAMTL
 14444     END-IF
 14445     IF NODAYSL > 0
 14446         MOVE NODAYSI  TO WS-SAVE-NODAYSI
 14447         MOVE NODAYSL  TO WS-SAVE-NODAYSL
 14448     END-IF
 14449     IF NOPMTSL > 0
 14450         MOVE NOPMTSI  TO WS-SAVE-NOPMTSI
 14451         MOVE NOPMTSL  TO WS-SAVE-NOPMTSL
 14452     END-IF
 14453     IF FORMTYPL > 0
 14454         MOVE FORMTYPI  TO WS-SAVE-FORMTYPI
 14455         MOVE FORMTYPL  TO WS-SAVE-FORMTYPL
 14456     END-IF
 14457     IF OCCL > 0
 14458         MOVE OCCI  TO WS-SAVE-OCCI
 14459         MOVE OCCL  TO WS-SAVE-OCCL
 14460     END-IF.
 14461 4100-EXIT.
 14462      EXIT.
 14463
 14464 4200-LOAD-CHANGES.
 14465     IF WS-SAVE-MAINTL > 0
 14466         MOVE WS-SAVE-MAINTI  TO MAINTI
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 271
* EL131.cbl
 14467         MOVE WS-SAVE-MAINTL  TO MAINTL
 14468         MOVE AL-UANON        TO MAINTA
 14469     END-IF
 14470     IF WS-SAVE-STATUSL > 0
 14471         MOVE WS-SAVE-STATUSI  TO STATUSI
 14472         MOVE WS-SAVE-STATUSL  TO STATUSL
 14473         MOVE AL-UANON         TO STATUSA
 14474     END-IF
 14475     IF WS-SAVE-REPL > 0
 14476         MOVE WS-SAVE-REPI  TO REPI
 14477         MOVE WS-SAVE-REPL  TO REPL
 14478         MOVE AL-UANON      TO REPA
 14479     END-IF
 14480*    IF WS-SAVE-CAUSEL > 0
 14481*        MOVE WS-SAVE-CAUSEI  TO CAUSEI
 14482*        MOVE WS-SAVE-CAUSEL  TO CAUSEL
 14483*        MOVE AL-UANON        TO CAUSEA
 14484*    END-IF
 14485*    IF WS-SAVE-ENDL > 0
 14486*        MOVE WS-SAVE-ENDI  TO ENDI
 14487*        MOVE WS-SAVE-ENDL  TO ENDL
 14488*        MOVE AL-UANON      TO ENDA
 14489*    END-IF
 14490     IF WS-SAVE-DIAGL > 0
 14491         MOVE WS-SAVE-DIAGI  TO DIAGI
 14492         MOVE WS-SAVE-DIAGL  TO DIAGL
 14493         MOVE AL-UANON       TO DIAGA
 14494     END-IF
 14495     IF WS-SAVE-ICD1L > 0
 14496         MOVE WS-SAVE-ICD1I  TO ICD1I
 14497         MOVE WS-SAVE-ICD1L  TO ICD1L
 14498         MOVE AL-UANON       TO ICD1A
 14499     END-IF
 14500     IF WS-SAVE-ICD2L > 0
 14501         MOVE WS-SAVE-ICD2I  TO ICD2I
 14502         MOVE WS-SAVE-ICD2L  TO ICD2L
 14503         MOVE AL-UANON       TO ICD2A
 14504     END-IF
 14505     IF WS-SAVE-BENEL > 0
 14506         MOVE WS-SAVE-BENEI  TO BENEI
 14507         MOVE WS-SAVE-BENEL  TO BENEL
 14508         MOVE AL-UANON       TO BENEA
 14509     END-IF
 14510     IF WS-SAVE-BIRTHL > 0
 14511         MOVE WS-SAVE-BIRTHI  TO BIRTHI
 14512         MOVE WS-SAVE-BIRTHL  TO BIRTHL
 14513         MOVE AL-UANON        TO BIRTHA
 14514     END-IF
 14515     IF WS-SAVE-SOCIALL > 0
 14516         MOVE WS-SAVE-SOCIALI  TO SOCIALI
 14517         MOVE WS-SAVE-SOCIALL  TO SOCIALL
 14518         MOVE AL-UANON         TO SOCIALA
 14519     END-IF
 14520     IF WS-SAVE-SEXL > 0
 14521         MOVE WS-SAVE-SEXI  TO SEXI
 14522         MOVE WS-SAVE-SEXL  TO SEXL
 14523         MOVE AL-UANON      TO SEXA
 14524     END-IF
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 272
* EL131.cbl
 14525     IF WS-SAVE-MLNAMEL > 0
 14526         MOVE WS-SAVE-MLNAMEI  TO MLNAMEI
 14527         MOVE WS-SAVE-MLNAMEL  TO MLNAMEL
 14528         MOVE AL-UANON         TO MLNAMEA
 14529     END-IF
 14530     IF WS-SAVE-MFNAMEL > 0
 14531         MOVE WS-SAVE-MFNAMEI  TO MFNAMEI
 14532         MOVE WS-SAVE-MFNAMEL  TO MFNAMEL
 14533         MOVE AL-UANON         TO MFNAMEA
 14534     END-IF
 14535     IF WS-SAVE-MMINITL > 0
 14536         MOVE WS-SAVE-MMINITI  TO MMINITI
 14537         MOVE WS-SAVE-MMINITL  TO MMINITL
 14538         MOVE AL-UANON         TO MMINITA
 14539     END-IF
 14540*    IF WS-SAVE-LOANNOL > 0
 14541*        MOVE WS-SAVE-LOANNOI  TO LOANNOI
 14542*        MOVE WS-SAVE-LOANNOL  TO LOANNOL
 14543*        MOVE AL-UANON         TO LOANNOA
 14544*    END-IF
 14545     IF WS-SAVE-LOANBALL > 0
 14546         MOVE WS-SAVE-LOANBALI  TO LOANBALI
 14547         MOVE WS-SAVE-LOANBALL  TO LOANBALL
 14548         MOVE AL-UANON          TO LOANBALA
 14549     END-IF
 14550     IF WS-SAVE-PROCL > 0
 14551         MOVE WS-SAVE-PROCI  TO PROCI
 14552         MOVE WS-SAVE-PROCL  TO PROCL
 14553         MOVE AL-UANON       TO PROCA
 14554     END-IF
 14555     IF WS-SAVE-SUPVL > 0
 14556         MOVE WS-SAVE-SUPVI  TO SUPVI
 14557         MOVE WS-SAVE-SUPVL  TO SUPVL
 14558         MOVE AL-UANON       TO SUPVA
 14559     END-IF
 14560     IF WS-SAVE-PRICDL > 0
 14561         MOVE WS-SAVE-PRICDI  TO PRICDI
 14562         MOVE WS-SAVE-PRICDL  TO PRICDL
 14563         MOVE AL-UANON        TO PRICDA
 14564     END-IF
 14565     IF WS-SAVE-FILETOL > 0
 14566         MOVE WS-SAVE-FILETOI  TO FILETOI
 14567         MOVE WS-SAVE-FILETOL  TO FILETOL
 14568         MOVE AL-UANON         TO FILETOA
 14569     END-IF
 14570     IF WS-SAVE-PDTHRUL > 0
 14571         MOVE WS-SAVE-PDTHRUI  TO PDTHRUI
 14572         MOVE WS-SAVE-PDTHRUL  TO PDTHRUL
 14573         MOVE AL-UANON         TO PDTHRUA
 14574     END-IF
 14575     IF WS-SAVE-PDAMTL > 0
 14576         MOVE WS-SAVE-PDAMTI  TO PDAMTI
 14577         MOVE WS-SAVE-PDAMTL  TO PDAMTL
 14578         MOVE AL-UANON        TO PDAMTA
 14579     END-IF
 14580     IF WS-SAVE-NODAYSL > 0
 14581         MOVE WS-SAVE-NODAYSI  TO NODAYSI
 14582         MOVE WS-SAVE-NODAYSL  TO NODAYSL
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 273
* EL131.cbl
 14583         MOVE AL-UANON         TO NODAYSA
 14584     END-IF
 14585     IF WS-SAVE-NOPMTSL > 0
 14586         MOVE WS-SAVE-NOPMTSI  TO NOPMTSI
 14587         MOVE WS-SAVE-NOPMTSL  TO NOPMTSL
 14588         MOVE AL-UANON         TO NOPMTSA
 14589     END-IF
 14590     IF WS-SAVE-FORMTYPL > 0
 14591         MOVE WS-SAVE-FORMTYPI  TO FORMTYPI
 14592         MOVE WS-SAVE-FORMTYPL  TO FORMTYPL
 14593         MOVE AL-UANON          TO FORMTYPA
 14594     END-IF
 14595     IF WS-SAVE-OCCL > 0
 14596         MOVE WS-SAVE-OCCI  TO OCCI
 14597         MOVE WS-SAVE-OCCL  TO OCCL
 14598         MOVE AL-UANON      TO OCCA
 14599     END-IF.
 14600 4200-EXIT.
 14601      EXIT.
 14602
 14603 5000-BUILD-MAP.
 14604     IF PI-RETURN-CD-1 = SPACE
 14605         PERFORM 5010-RESET-PI-AREA THRU 5010-EXIT.
 14606
 14607     MOVE SPACE                  TO PI-RETURN-CD-1.
 14608
 14609     MOVE LOW-VALUES             TO EL131AI.
 14610
 14611     MOVE PI-COMPANY-CD          TO COMPANY-CODE.
 14612     MOVE PI-CARRIER             TO CARRIER-CODE.
 14613     MOVE PI-CLAIM-NO            TO CLAIM-NO.
 14614     MOVE PI-CERT-NO             TO CERT-NO.
 14615
 14616 5000-READ-CLAIM-MASTER.
 14617
 14618
 14619* EXEC CICS READ
 14620*         SET      (ADDRESS OF CLAIM-MASTER)
 14621*         DATASET  (CLMS-FILE-ID)
 14622*         RIDFLD   (MSTR-KEY)
 14623*    END-EXEC.
 14624*    MOVE '&"S        E          (   #00012385' TO DFHEIV0
 14625     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14626     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14627     MOVE X'2020233030303132333835' TO DFHEIV0(25:11)
 14628     CALL 'kxdfhei1' USING DFHEIV0,
 14629           CLMS-FILE-ID,
 14630           DFHEIV20,
 14631           DFHEIV99,
 14632           MSTR-KEY,
 14633           DFHEIV99,
 14634           DFHEIV99,
 14635           DFHEIV99
 14636     SET ADDRESS OF CLAIM-MASTER TO
 14637         DFHEIV20
 14638     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14639
 14640
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 274
* EL131.cbl
 14641     PERFORM 5020-MOVE-MSTR THRU 5020-EXIT.
 14642
 14643 5000-READ-DIAGNOSIS-TRAILER.
 14644
 14645
 14646* EXEC CICS HANDLE CONDITION
 14647*         NOTFND (5000-TRLR-NOT-FOUND)
 14648*    END-EXEC.
 14649*    MOVE '"$I                   ! B #00012395' TO DFHEIV0
 14650     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14651     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14652     MOVE X'4220233030303132333935' TO DFHEIV0(25:11)
 14653     CALL 'kxdfhei1' USING DFHEIV0
 14654     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14655
 14656
 14657     MOVE MSTR-KEY               TO TRLR-KEY.
 14658     MOVE NINETY                 TO TRLR-SEQ-NO.
 14659
 14660
 14661* EXEC CICS READ
 14662*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 14663*         DATASET  (TRLR-FILE-ID)
 14664*         RIDFLD   (TRLR-KEY)
 14665*    END-EXEC.
 14666*    MOVE '&"S        E          (   #00012402' TO DFHEIV0
 14667     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14668     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14669     MOVE X'2020233030303132343032' TO DFHEIV0(25:11)
 14670     CALL 'kxdfhei1' USING DFHEIV0,
 14671           TRLR-FILE-ID,
 14672           DFHEIV20,
 14673           DFHEIV99,
 14674           TRLR-KEY,
 14675           DFHEIV99,
 14676           DFHEIV99,
 14677           DFHEIV99
 14678     SET ADDRESS OF ACTIVITY-TRAILERS TO
 14679         DFHEIV20
 14680     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14681
 14682
 14683     MOVE AT-INFO-LINE-1         TO DIAGO.
 14684     MOVE AT-ICD-CODE-1          TO ICD1O.
 14685     MOVE AT-ICD-CODE-2          TO ICD2O.
 14686
 14687 5000-READ-CERTIFICATE-MASTER.
 14688
 14689     MOVE PI-COMPANY-CD          TO CERT-COMPANY-CODE.
 14690     MOVE CL-CERT-CARRIER        TO CERT-CARRIER
 14691     MOVE CL-CERT-GROUPING       TO CERT-GROUP PI-GROUPING.
 14692     MOVE CL-CERT-STATE          TO CERT-STATE PI-STATE.
 14693     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT PI-ACCOUNT.
 14694     MOVE CL-CERT-NO             TO CERT-CERT PI-CERT-NO.
 14695     MOVE CL-CERT-EFF-DT         TO CERT-DATE PI-CERT-EFF-DT.
 14696
 14697
 14698* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 275
* EL131.cbl
 14699*         NOTFND (5000-CERT-NOT-FOUND)
 14700*    END-EXEC.
 14701*    MOVE '"$I                   ! C #00012422' TO DFHEIV0
 14702     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14703     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14704     MOVE X'4320233030303132343232' TO DFHEIV0(25:11)
 14705     CALL 'kxdfhei1' USING DFHEIV0
 14706     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14707
 14708
 14709
 14710* EXEC CICS READ
 14711*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 14712*         DATASET  (CERT-FILE-ID)
 14713*         RIDFLD   (CERT-KEY)
 14714*    END-EXEC.
 14715*    MOVE '&"S        E          (   #00012426' TO DFHEIV0
 14716     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14717     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14718     MOVE X'2020233030303132343236' TO DFHEIV0(25:11)
 14719     CALL 'kxdfhei1' USING DFHEIV0,
 14720           CERT-FILE-ID,
 14721           DFHEIV20,
 14722           DFHEIV99,
 14723           CERT-KEY,
 14724           DFHEIV99,
 14725           DFHEIV99,
 14726           DFHEIV99
 14727     SET ADDRESS OF CERTIFICATE-MASTER TO
 14728         DFHEIV20
 14729     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14730
 14731
 14732     PERFORM 5030-MOVE-CERT THRU 5030-EXIT.
 14733     PERFORM 5100-LOAD-CORR-TRLR THRU 5100-EXIT.
 14734     PERFORM 7600-BROWSE-CLAIM THRU 7699-EXIT.
 14735
 14736     GO TO 5000-EXIT.
 14737
 14738 5000-TRLR-NOT-FOUND.
 14739     MOVE ER-7687                TO EMI-ERROR.
 14740     MOVE -1                     TO DIAGL.
 14741     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14742     GO TO 5000-EXIT.
 14743
 14744 5000-CERT-NOT-FOUND.
 14745     MOVE ER-0206                TO EMI-ERROR.
 14746     MOVE -1                     TO CERTL.
 14747     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14748
 14749 5000-EXIT.
 14750     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 276
* EL131.cbl
 14752 5010-RESET-PI-AREA.
 14753     IF CERTI GREATER THAN LOW-VALUES
 14754         MOVE CERTI              TO PI-CERT-PRIME.
 14755
 14756     IF SUFXI GREATER THAN LOW-VALUES
 14757         MOVE SUFXI              TO PI-CERT-SFX.
 14758
 14759     IF CERTEFFI GREATER THAN LOW-VALUES
 14760         MOVE HOLD-EFF           TO PI-CERT-EFF-DT.
 14761
 14762     IF CERTACTI GREATER THAN LOW-VALUES
 14763         MOVE CERTACTI           TO PI-ACCOUNT.
 14764
 14765     IF CERTSTI GREATER THAN LOW-VALUES
 14766         MOVE CERTSTI            TO PI-STATE.
 14767
 14768     IF CERTCARI GREATER THAN LOW-VALUES
 14769         MOVE CERTCARI           TO PI-CARRIER.
 14770
 14771     IF CERTGRPI GREATER THAN LOW-VALUES
 14772         MOVE CERTGRPI           TO PI-GROUPING.
 14773
 14774 5010-EXIT.
 14775     EXIT.
 14776
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 277
* EL131.cbl
 14778 5020-MOVE-MSTR.
 14779
 14780     MOVE CL-ASSOC-CERT-SEQU     TO WS-CURRENT-SEQU.
 14781     MOVE CL-ASSOC-CERT-TOTAL    TO WS-OF-SEQU.
 14782     MOVE WS-CLAIM-SEQU          TO SEQUO.
 14783     MOVE AL-SABON               TO SEQUA.
 14784     MOVE CL-CLAIM-NO            TO CLAIMO PI-CLAIM-NO.
 14785     MOVE CL-CLAIM-TYPE          TO TYPEO
 14786                                    pi-claim-type
 14787
 14788     IF CL-TOTAL-PAID-AMT  = +0 AND
 14789        CL-LAST-PMT-AMT    = +0 AND
 14790        CL-NO-OF-PMTS-MADE = +0
 14791          MOVE AL-UANON          TO TYPEA.
 14792
 14793     MOVE CL-PRIME-CERT-PRIME    TO PCERTNOO.
 14794     MOVE CL-PRIME-CERT-SFX      TO PSUFXO.
 14795     MOVE CL-CERT-PRIME          TO CERTO.
 14796     MOVE CL-CERT-SFX            TO SUFXO.
 14797     MOVE CL-CERT-CARRIER        TO CARRO.
 14798
 14799     IF CL-CLAIM-STATUS = 'C'
 14800         MOVE 'CLOSED'           TO STATUSO
 14801     ELSE
 14802         MOVE 'OPEN  '           TO STATUSO.
 14803
 14804     move cl-accident-claim-sw   to accswo
 14805     if cl-benefit-period not numeric
 14806        move zeros               to cl-benefit-period
 14807     end-if
 14808     move cl-benefit-period      to benpero
 14809     move cl-insured-type        to instypeo
 14810     MOVE CL-PROCESSOR-ID        TO PROCO.
 14811
 14812     MOVE CL-FILE-ESTABLISHED-BY TO AUIDO.
 14813     MOVE CL-CCN                 TO CCNOO.
 14814
 14815     MOVE CL-INSURED-LAST-NAME   TO MLNAMEO.
 14816     MOVE CL-INSURED-1ST-NAME    TO MFNAMEO.
 14817     MOVE CL-INSURED-MID-INIT    TO MMINITO.
 14818     MOVE CL-INSURED-SEX-CD      TO SEXO.
 14819
 14820     IF CL-INSURED-BIRTH-DT GREATER THAN LOW-VALUES
 14821         MOVE CL-INSURED-BIRTH-DT TO DC-BIN-DATE-1
 14822         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 14823         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14824         MOVE DC-GREG-DATE-1-EDIT TO BIRTHO
 14825     ELSE
 14826         MOVE SPACES             TO BIRTHO.
 14827
 14828     IF CL-SSN-STATE   = CL-CERT-STATE  AND
 14829        CL-SSN-ACCOUNT = CL-CERT-ACCOUNT-PRIME
 14830         NEXT SENTENCE
 14831       ELSE
 14832         MOVE CL-SOC-SEC-NO      TO SOCIALO.
 14833
 14834     IF PI-COMPANY-ID = 'DMD'
 14835       IF CL-CERT-PRIME (4:1) = 'U' OR 'F'
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 278
* EL131.cbl
 14836          IF SOCIALO = SPACES OR LOW-VALUES
 14837            MOVE ER-0885         TO EMI-ERROR
 14838            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14839
 14840     MOVE CL-INSURED-OCC-CD      TO OCCO.
 14841*    MOVE CL-CAUSE-CD            TO CAUSEO.
 14842
 14843*    IF CL-EST-END-OF-DISAB-DT GREATER THAN LOW-VALUES
 14844*        MOVE CL-EST-END-OF-DISAB-DT TO DC-BIN-DATE-1
 14845*        MOVE SPACES                 TO DC-OPTION-CODE
 14846*        PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14847*        MOVE DC-GREG-DATE-1-EDIT TO ENDO
 14848*    ELSE
 14849*        MOVE SPACES             TO ENDO.
 14850
 14851     IF CL-PAID-THRU-DT GREATER THAN LOW-VALUES
 14852        MOVE CL-PAID-THRU-DT    TO DC-BIN-DATE-1
 14853        MOVE SPACES             TO DC-OPTION-CODE
 14854        PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14855        MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
 14856        IF PI-USES-PAID-TO
 14857           MOVE CL-PAID-THRU-DT    TO DC-BIN-DATE-1
 14858           MOVE '6'                TO DC-OPTION-CODE
 14859           MOVE +1                 TO DC-ELAPSED-DAYS
 14860           MOVE +0                 TO DC-ELAPSED-MONTHS
 14861           PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14862           MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
 14863        ELSE
 14864           NEXT SENTENCE
 14865     ELSE
 14866        MOVE SPACES             TO PDTHRUO.
 14867
 14868     MOVE CL-TOTAL-PAID-AMT      TO PDAMTO.
 14869     MOVE CL-NO-OF-DAYS-PAID     TO NODAYSO.
 14870     MOVE CL-NO-OF-PMTS-MADE     TO NOPMTSO.
 14871     MOVE CL-PROG-FORM-TYPE      TO FORMTYPO.
 14872
 14873     IF MODIFY-CAP
 14874        MOVE AL-UNNOF            TO PDAMTA
 14875                                    NODAYSA
 14876                                    NOPMTSA
 14877        MOVE AL-UANOF            TO PDTHRUA.
 14878     MOVE PI-COMPANY-ID          TO CNTL-CO-ID
 14879     MOVE '2'                    TO CNTL-REC-TYPE
 14880     MOVE +0                     TO CNTL-SEQ-NO
 14881     MOVE PI-PROCESSOR-ID        TO CNTL-PROC-ID
 14882
 14883
 14884* EXEC CICS READ
 14885*         DATASET  (CNTL-FILE-ID)
 14886*         SET      (ADDRESS OF CONTROL-FILE)
 14887*         RIDFLD   (CNTL-KEY)
 14888*         RESP     (WS-RESPONSE)
 14889*    END-EXEC
 14890*    MOVE '&"S        E          (  N#00012583' TO DFHEIV0
 14891     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14892     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14893     MOVE X'204E233030303132353833' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 279
* EL131.cbl
 14894     CALL 'kxdfhei1' USING DFHEIV0,
 14895           CNTL-FILE-ID,
 14896           DFHEIV20,
 14897           DFHEIV99,
 14898           CNTL-KEY,
 14899           DFHEIV99,
 14900           DFHEIV99,
 14901           DFHEIV99
 14902     SET ADDRESS OF CONTROL-FILE TO
 14903         DFHEIV20
 14904     MOVE EIBRESP  TO WS-RESPONSE
 14905     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14906
 14907     IF WS-RESP-NORMAL
 14908        MOVE CF-APPROVAL-LEVEL   TO PI-APPROVAL-LEVEL
 14909     end-if
 14910     IF CL-INCURRED-DT GREATER THAN LOW-VALUES
 14911         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 14912         MOVE SPACES             TO DC-OPTION-CODE
 14913         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14914         MOVE DC-GREG-DATE-1-EDIT TO INCO
 14915     ELSE
 14916         MOVE SPACES             TO INCO.
 14917
 14918     IF (CL-NO-OF-PMTS-MADE = ZEROS)
 14919        OR (PI-APPROVAL-LEVEL = '4' OR '5')
 14920        MOVE AL-UANOF            TO INCA
 14921     end-if
 14922     MOVE CL-NO-OF-PMTS-MADE     TO PI-NO-PMTS.
 14923
 14924     IF CL-REPORTED-DT GREATER THAN LOW-VALUES
 14925         MOVE CL-REPORTED-DT     TO DC-BIN-DATE-1
 14926         MOVE SPACES             TO DC-OPTION-CODE
 14927         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14928         MOVE DC-GREG-DATE-1-EDIT TO REPO
 14929     ELSE
 14930         MOVE SPACES             TO REPO.
 14931
 14932     IF CL-FILE-ESTABLISH-DT GREATER THAN LOW-VALUES
 14933         MOVE CL-FILE-ESTABLISH-DT TO DC-BIN-DATE-1
 14934         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 14935         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14936         MOVE DC-GREG-DATE-1-EDIT TO ESTO
 14937     ELSE
 14938         MOVE SPACES             TO ESTO.
 14939
 14940     IF CL-LAST-MAINT-DT GREATER THAN LOW-VALUES
 14941         MOVE CL-LAST-MAINT-DT   TO DC-BIN-DATE-1
 14942         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 14943         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14944         MOVE DC-GREG-DATE-1-EDIT TO MNTDTO
 14945     ELSE
 14946         MOVE SPACES             TO MNTDTO.
 14947
 14948
 14949     IF CL-LAST-MAINT-TYPE = SPACE
 14950         MOVE 'SET-UP'           TO MNTTYPEO
 14951     ELSE
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 280
* EL131.cbl
 14952     IF CL-LAST-MAINT-TYPE = '1'
 14953         MOVE 'PAYMNT'           TO MNTTYPEO
 14954     ELSE
 14955     IF CL-LAST-MAINT-TYPE = '2'
 14956         MOVE 'LETTER'           TO MNTTYPEO
 14957     ELSE
 14958     IF CL-LAST-MAINT-TYPE = '3'
 14959         MOVE 'UPDATE'           TO MNTTYPEO
 14960     ELSE
 14961     IF CL-LAST-MAINT-TYPE = '4'
 14962         MOVE 'RESTOR'           TO MNTTYPEO
 14963     ELSE
 14964     IF CL-LAST-MAINT-TYPE = '5'
 14965         MOVE 'INC DT'           TO MNTTYPEO
 14966     ELSE
 14967     IF CL-LAST-MAINT-TYPE = '6'
 14968         MOVE ' CONV'            TO MNTTYPEO
 14969     ELSE
 14970     IF CL-LAST-MAINT-TYPE = 'C'
 14971         MOVE 'CHGBEN'           TO MNTTYPEO
 14972     ELSE
 14973     IF CL-LAST-MAINT-TYPE = 'E'
 14974         MOVE 'ERRCOR'           TO MNTTYPEO
 14975     ELSE
 14976         MOVE SPACES             TO MNTTYPEO.
 14977
 14978     MOVE CL-BENEFICIARY         TO BENEO.
 14979     MOVE CL-FILE-LOCATION       TO FILETOO.
 14980     IF CL-CRITICAL-PERIOD NOT NUMERIC
 14981        MOVE ZEROS               TO CL-CRITICAL-PERIOD
 14982     END-IF
 14983     MOVE CL-CRITICAL-PERIOD     TO CRITPO
 14984     IF CL-NO-OF-EXTENSIONS NOT NUMERIC
 14985        MOVE ZEROS               TO CL-NO-OF-EXTENSIONS
 14986     END-IF
 14987     MOVE CL-NO-OF-EXTENSIONS    TO EXTENSO
 14988*    MOVE CL-CRIT-PER-RECURRENT
 14989*                                TO CRITPTO
 14990*    IF CL-CRIT-PER-RTW-MOS NOT NUMERIC
 14991*       MOVE ZEROS               TO CL-CRIT-PER-RTW-MOS
 14992*    END-IF
 14993*    MOVE CL-CRIT-PER-RTW-MOS    TO RTWMOSO
 14994     MOVE CL-PRIORITY-CD         TO PRICDO.
 14995     MOVE CL-SUPV-ATTN-CD        TO SUPVO.
 14996     MOVE CL-LAST-MAINT-USER     TO PI-UPDATE-BY.
 14997     MOVE CL-LAST-MAINT-HHMMSS   TO PI-UPDATE-HHMMSS.
 14998     MOVE CL-AUTO-PAY-SEQ        TO PI-AUTO-PAY-SEQ.
 14999
 15000 5020-EXIT.
 15001     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 281
* EL131.cbl
 15003 5030-MOVE-CERT.
 15004
 15005     IF CM-CERT-EFF-DT GREATER THAN LOW-VALUES
 15006         MOVE CM-CERT-EFF-DT     TO DC-BIN-DATE-1
 15007         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 15008         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15009         MOVE DC-GREG-DATE-1-EDIT    TO CERTEFFO HOLD-DATE
 15010       ELSE
 15011         MOVE SPACES             TO CERTEFFO
 15012         MOVE ZERO               TO HOLD-DATE.
 15013
 15014     MOVE CM-ACCOUNT             TO CERTACTO.
 15015     MOVE CM-STATE               TO CERTSTO PI-STATE.
 15016     MOVE CM-GROUPING            TO CERTGRPO.
 15017     MOVE CM-CARRIER             TO CERTCARO.
 15018     MOVE CM-INSURED-LAST-NAME   TO CRTLNMEO.
 15019     MOVE CM-INSURED-INITIAL2    TO CRTINITO.
 15020     MOVE CM-INSURED-FIRST-NAME  TO CRTFNMEO.
 15021     MOVE CM-INSURED-ISSUE-AGE   TO ISSAGEO.
 15022     MOVE CM-JT-LAST-NAME        TO JNTLNMEO.
 15023     MOVE CM-JT-FIRST-NAME       TO JNTFNMEO.
 15024     MOVE CM-JT-INITIAL          TO JNTINITO.
 15025     MOVE CM-INSURED-JOINT-AGE   TO JNTAGEO.
 15026
 15027*** READ STATE MASTER RECORD FOR FREE LOOK PERIOD ***
 15028     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
 15029     MOVE '3'                    TO CNTL-REC-TYPE.
 15030     MOVE SPACES                 TO CNTL-STATE-ACCESS.
 15031     MOVE CM-STATE               TO CNTL-STATE-NUMBER.
 15032     MOVE ZERO                   TO CNTL-SEQ-NO.
 15033
 15034
 15035* EXEC CICS READ
 15036*         SET        (ADDRESS OF CONTROL-FILE)
 15037*         DATASET    ('ELCNTL')
 15038*         RIDFLD     (CNTL-KEY)
 15039*         RESP       (WS-RESPONSE)
 15040*    END-EXEC.
 15041     MOVE 'ELCNTL' TO DFHEIV1
 15042*    MOVE '&"S        E          (  N#00012717' TO DFHEIV0
 15043     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15044     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15045     MOVE X'204E233030303132373137' TO DFHEIV0(25:11)
 15046     CALL 'kxdfhei1' USING DFHEIV0,
 15047           DFHEIV1,
 15048           DFHEIV20,
 15049           DFHEIV99,
 15050           CNTL-KEY,
 15051           DFHEIV99,
 15052           DFHEIV99,
 15053           DFHEIV99
 15054     SET ADDRESS OF CONTROL-FILE TO
 15055         DFHEIV20
 15056     MOVE EIBRESP  TO WS-RESPONSE
 15057     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15058
 15059
 15060     IF WS-RESP-NOTFND
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 282
* EL131.cbl
 15061        MOVE ZERO                TO CP-FREE-LOOK
 15062     ELSE
 15063        MOVE CF-ST-FREE-LOOK-PERIOD
 15064                                 TO CP-FREE-LOOK.
 15065
 15066     IF CM-LF-BENEFIT-CD = '00'
 15067        GO TO 5030-MOVE-CERT-AH.
 15068
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 283
* EL131.cbl
 15070     MOVE EIBDATE                TO DC-JULIAN-YYDDD
 15071     MOVE '5'                    TO DC-OPTION-CODE
 15072     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15073     MOVE DC-BIN-DATE-1          TO WS-BIN-CURRENT-DT.
 15074     MOVE PI-LIFE-OVERRIDE-L6    TO LCVDSCRO.
 15075     MOVE CM-LF-BENEFIT-CD       TO LCVCDO HOLD-BENEFIT.
 15076     MOVE CM-LF-ORIG-TERM        TO LCVOTRMO  CP-ORIGINAL-TERM.
 15077     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT
 15078     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 15079     MOVE CL-INCURRED-DT         TO CP-VALUATION-DT
 15080     MOVE '4'                    TO CP-REM-TERM-METHOD
 15081     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID
 15082     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 15083     PERFORM 9700-LINK-RTRM-FILE-ID THRU 9700-EXIT.
 15084
 15085     MOVE CP-REMAINING-TERM-3    TO LCVRTRMO.
 15086     IF CM-LF-PREMIUM-RATE NUMERIC
 15087         MOVE CM-LF-PREMIUM-RATE TO LCVRATEO
 15088     ELSE
 15089         MOVE ZEROS              TO LCVRATEO.
 15090
 15091     IF CM-LF-ALT-BENEFIT-AMT NOT NUMERIC
 15092         MOVE ZEROS              TO CM-LF-ALT-BENEFIT-AMT.
 15093
 15094     COMPUTE LCVBENEO = CM-LF-BENEFIT-AMT + CM-LF-ALT-BENEFIT-AMT.
 15095
 15096     MOVE CM-POLICY-FORM-NO      TO LCVFORMO.
 15097
 15098     IF CM-LF-CURRENT-STATUS = '8'
 15099        IF CM-LF-CANCEL-DT NOT = LOW-VALUES
 15100            MOVE CM-LF-CANCEL-DT TO DC-BIN-DATE-1
 15101            MOVE ' '             TO DC-OPTION-CODE
 15102            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15103            IF NOT DATE-CONVERSION-ERROR
 15104                MOVE DC-GREG-DATE-1-EDIT     TO LCVCNDTO.
 15105
 15106     IF CM-LF-CURRENT-STATUS = '7'
 15107        IF CM-LF-DEATH-DT NOT = LOW-VALUES
 15108            MOVE CM-LF-DEATH-DT  TO DC-BIN-DATE-1
 15109            MOVE ' '             TO DC-OPTION-CODE
 15110            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15111            IF NOT DATE-CONVERSION-ERROR
 15112                MOVE DC-GREG-DATE-1-EDIT     TO LCVCNDTO.
 15113
 15114     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
 15115         MOVE ' '                TO DC-OPTION-CODE
 15116         MOVE CM-LF-DEATH-EXIT-DT TO DC-BIN-DATE-1
 15117         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15118         IF NOT DATE-CONVERSION-ERROR
 15119             MOVE DC-GREG-DATE-1-EDIT TO HOLD-DATE
 15120             MOVE HOLD-MONTH     TO WORK-MONTH
 15121             MOVE HOLD-YEAR      TO WORK-YEAR
 15122             MOVE WORK-DATE-MY   TO LCVEXITO.
 15123
 15124     IF CM-LF-CURRENT-STATUS = '1' OR = '4'
 15125        IF CP-REMAINING-TERM-3 = ZEROS
 15126           MOVE 'EXPIRED'        TO LCVSTATO
 15127        ELSE
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 284
* EL131.cbl
 15128           MOVE 'ACTIVE'         TO LCVSTATO.
 15129
 15130     IF CM-LF-CURRENT-STATUS = '2'
 15131        MOVE 'PEND   '           TO LCVSTATO.
 15132     IF CM-LF-CURRENT-STATUS = '3'
 15133        MOVE 'RESTORE'           TO LCVSTATO.
 15134     IF CM-LF-CURRENT-STATUS = '5'
 15135        MOVE 'REISSUE'           TO LCVSTATO.
 15136     IF CM-LF-CURRENT-STATUS = '6'
 15137        MOVE 'LMP DIS'           TO LCVSTATO.
 15138     IF CM-LF-CURRENT-STATUS = '7'
 15139        MOVE 'DEATH  '           TO LCVSTATO.
 15140     IF CM-LF-CURRENT-STATUS = '8'
 15141        MOVE 'CANCEL '           TO LCVSTATO.
 15142     IF CM-LF-CURRENT-STATUS = '9'
 15143        MOVE 'RE-ONLY'           TO LCVSTATO.
 15144     IF CM-LF-CURRENT-STATUS = 'V'
 15145        MOVE 'VOID   '           TO LCVSTATO.
 15146     IF CM-LF-CURRENT-STATUS = 'D'
 15147        MOVE 'DECLINE'           TO LCVSTATO.
 15148
 15149     MOVE SPACES                 TO BENEFIT-KEY ERROR-SWITCH.
 15150     MOVE PI-COMPANY-ID          TO BEN-CO-ID.
 15151     MOVE '4'                    TO BEN-REC-TYPE.
 15152     MOVE CM-LF-BENEFIT-CD       TO BEN-ACC-CD.
 15153     MOVE ZERO                   TO BEN-SEQ-NO.
 15154
 15155
 15156* EXEC CICS READ GTEQ
 15157*         DATASET  (CNTL-FILE-ID)
 15158*         RIDFLD   (BENEFIT-KEY)
 15159*         SET      (ADDRESS OF CONTROL-FILE)
 15160*    END-EXEC.
 15161*    MOVE '&"S        G          (   #00012819' TO DFHEIV0
 15162     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 15163     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15164     MOVE X'2020233030303132383139' TO DFHEIV0(25:11)
 15165     CALL 'kxdfhei1' USING DFHEIV0,
 15166           CNTL-FILE-ID,
 15167           DFHEIV20,
 15168           DFHEIV99,
 15169           BENEFIT-KEY,
 15170           DFHEIV99,
 15171           DFHEIV99,
 15172           DFHEIV99
 15173     SET ADDRESS OF CONTROL-FILE TO
 15174         DFHEIV20
 15175     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15176
 15177
 15178     IF CF-COMPANY-ID NOT = PI-COMPANY-ID OR
 15179        CF-RECORD-TYPE NOT = '4'
 15180         MOVE ER-0240            TO EMI-ERROR
 15181         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15182         GO TO 5030-MOVE-CERT-FINISH.
 15183
 15184     MOVE ZERO                   TO COUNT-2.
 15185     PERFORM 5040-FIND-BENEFIT THRU 5060-EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 285
* EL131.cbl
 15186
 15187     IF SCREEN-ERROR
 15188         MOVE ER-0282            TO EMI-ERROR
 15189         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15190        ELSE
 15191         MOVE CF-BENEFIT-ALPHA (COUNT-2) TO LCVKINDO.
 15192
 15193 5030-MOVE-CERT-AH.
 15194
 15195     IF CM-LF-BENEFIT-CD = '00'
 15196         IF CM-AH-BENEFIT-CD = '00'
 15197             GO TO 5030-MOVE-CERT-FINISH.
 15198
 15199     IF CM-AH-BENEFIT-CD = '00'
 15200        MOVE SPACES             TO ACVKINDO
 15201        COMPUTE PI-PAYMENT-AMT =
 15202                    CM-LF-BENEFIT-AMT / CM-LF-ORIG-TERM
 15203        GO TO 5030-MOVE-CERT-FINISH.
 15204
 15205     MOVE PI-AH-OVERRIDE-L6      TO ACVDSCRO.
 15206     MOVE CM-AH-BENEFIT-CD       TO ACVCDO HOLD-BENEFIT.
 15207     MOVE DC-GREG-DATE-1-EDIT    TO HOLD-DATE.
 15208     MOVE CM-AH-ORIG-TERM        TO ACVOTRMO CP-ORIGINAL-TERM.
 15209     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT
 15210     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 15211     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 15212     MOVE SAVE-BIN-DATE          TO CP-VALUATION-DT.
 15213
 15214**DMD **********************************************
 15215     IF PI-COMPANY-ID = 'DMD'
 15216         COMPUTE WS-TERM-IN-DAYS = CM-AH-ORIG-TERM * 30 +
 15217                                   CM-PMT-EXTENSION-DAYS
 15218         COMPUTE WS-REM-TERM-IN-DAYS = WS-TERM-IN-DAYS -
 15219                                      CL-NO-OF-DAYS-PAID
 15220         DIVIDE WS-REM-TERM-IN-DAYS BY +30
 15221             GIVING WS-REM-MOS REMAINDER WS-REM-DAYS
 15222         MOVE WS-REM-MOS         TO ACVRTRMO
 15223                                    CP-REMAINING-TERM-3
 15224*        MOVE WS-REM-DAYS        TO DAYSPO
 15225         GO TO 5030-SKIP-RTRM.
 15226**DMD **********************************************
 15227
 15228     MOVE '4'                    TO CP-REM-TERM-METHOD.
 15229     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 15230     PERFORM 9700-LINK-RTRM-FILE-ID THRU 9700-EXIT.
 15231     MOVE CP-REMAINING-TERM-3    TO ACVRTRMO.
 15232
 15233 5030-SKIP-RTRM.
 15234     IF CM-AH-PREMIUM-RATE NUMERIC
 15235         MOVE CM-AH-PREMIUM-RATE TO ACVRATEO
 15236     ELSE
 15237         MOVE ZEROS              TO ACVRATEO.
 15238
 15239     MOVE CM-AH-BENEFIT-AMT      TO ACVBENEO  PI-PAYMENT-AMT.
 15240     MOVE CM-POLICY-FORM-NO      TO ACVFORMO.
 15241
 15242     IF CM-AH-CURRENT-STATUS = '8'
 15243        IF CM-AH-CANCEL-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 286
* EL131.cbl
 15244            MOVE CM-AH-CANCEL-DT TO DC-BIN-DATE-1
 15245            MOVE ' '             TO DC-OPTION-CODE
 15246            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15247            IF NOT DATE-CONVERSION-ERROR
 15248                MOVE DC-GREG-DATE-1-EDIT     TO ACVCNDTO.
 15249
 15250     IF CM-AH-CURRENT-STATUS = '6' OR '7'
 15251        IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
 15252            MOVE CM-AH-SETTLEMENT-DT         TO DC-BIN-DATE-1
 15253            MOVE ' '             TO DC-OPTION-CODE
 15254            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15255            IF NOT DATE-CONVERSION-ERROR
 15256                MOVE DC-GREG-DATE-1-EDIT     TO ACVCNDTO.
 15257
 15258     IF CM-AH-CURRENT-STATUS = '1' OR = '4'
 15259        IF CP-REMAINING-TERM-3 = ZEROS
 15260           MOVE 'EXPIRED'        TO ACVSTATO
 15261        ELSE
 15262           MOVE 'ACTIVE'         TO ACVSTATO.
 15263
 15264     IF CM-AH-CURRENT-STATUS = '2'
 15265        MOVE 'PEND   '           TO ACVSTATO.
 15266     IF CM-AH-CURRENT-STATUS = '3'
 15267        MOVE 'RESTORE'           TO ACVSTATO.
 15268     IF CM-AH-CURRENT-STATUS = '5'
 15269        MOVE 'REISSUE'           TO ACVSTATO.
 15270     IF CM-AH-CURRENT-STATUS = '6'
 15271        MOVE 'LMP DIS'           TO ACVSTATO.
 15272     IF CM-AH-CURRENT-STATUS = '7'
 15273        MOVE 'DEATH  '           TO ACVSTATO.
 15274     IF CM-AH-CURRENT-STATUS = '8'
 15275        MOVE 'CANCEL '           TO ACVSTATO.
 15276     IF CM-AH-CURRENT-STATUS = '9'
 15277        MOVE 'RE-ONLY'           TO ACVSTATO.
 15278     IF CM-AH-CURRENT-STATUS = 'V'
 15279        MOVE 'VOID   '           TO ACVSTATO.
 15280     IF CM-AH-CURRENT-STATUS = '9'
 15281        MOVE 'DECLINE'           TO ACVSTATO.
 15282
 15283     IF CM-AH-SETTLEMENT-EXIT-DT NOT = LOW-VALUES
 15284         MOVE ' '                TO DC-OPTION-CODE
 15285         MOVE CM-AH-SETTLEMENT-EXIT-DT TO DC-BIN-DATE-1
 15286         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15287         IF NOT DATE-CONVERSION-ERROR
 15288             MOVE DC-GREG-DATE-1-EDIT     TO HOLD-DATE
 15289             MOVE HOLD-MONTH     TO WORK-MONTH
 15290             MOVE HOLD-YEAR      TO WORK-YEAR
 15291             MOVE WORK-DATE-MY   TO ACVEXITO.
 15292
 15293     MOVE SPACES                 TO BENEFIT-KEY ERROR-SWITCH.
 15294
 15295     MOVE PI-COMPANY-ID          TO BEN-CO-ID.
 15296     MOVE '5'                    TO BEN-REC-TYPE.
 15297     MOVE CM-AH-BENEFIT-CD       TO BEN-ACC-CD.
 15298     MOVE ZERO                   TO BEN-SEQ-NO.
 15299
 15300
 15301* EXEC CICS READ GTEQ
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 287
* EL131.cbl
 15302*         DATASET  (CNTL-FILE-ID)
 15303*         RIDFLD   (BENEFIT-KEY)
 15304*         SET      (ADDRESS OF CONTROL-FILE)
 15305*    END-EXEC.
 15306*    MOVE '&"S        G          (   #00012947' TO DFHEIV0
 15307     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 15308     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15309     MOVE X'2020233030303132393437' TO DFHEIV0(25:11)
 15310     CALL 'kxdfhei1' USING DFHEIV0,
 15311           CNTL-FILE-ID,
 15312           DFHEIV20,
 15313           DFHEIV99,
 15314           BENEFIT-KEY,
 15315           DFHEIV99,
 15316           DFHEIV99,
 15317           DFHEIV99
 15318     SET ADDRESS OF CONTROL-FILE TO
 15319         DFHEIV20
 15320     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15321
 15322
 15323     IF CF-COMPANY-ID NOT = PI-COMPANY-ID OR
 15324        CF-RECORD-TYPE NOT = '5'
 15325         MOVE ER-0250            TO EMI-ERROR
 15326         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15327         GO TO 5030-MOVE-CERT-FINISH.
 15328
 15329     MOVE ZERO                   TO COUNT-2.
 15330     PERFORM 5040-FIND-BENEFIT THRU 5060-EXIT.
 15331
 15332     IF SCREEN-ERROR
 15333         MOVE ER-0283            TO EMI-ERROR
 15334         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15335       ELSE
 15336         MOVE CF-BENEFIT-ALPHA (COUNT-2) TO ACVKINDO.
 15337
 15338 5030-MOVE-CERT-FINISH.
 15339
 15340     MOVE CM-LOAN-APR            TO APRO.
 15341     MOVE CM-PAY-FREQUENCY       TO PMTFREQO.
 15342     MOVE CM-IND-GRP-TYPE        TO INDGRPO.
 15343     MOVE CM-PREMIUM-TYPE        TO PREMTYPO  PI-PREM-TYPE.
 15344*    MOVE CM-LOAN-NUMBER         TO LOANNOO
 15345     MOVE CM-LOAN-BALANCE        TO LOANBALO.
 15346     MOVE CM-SPECIAL-REIN-CODE   TO REINCDO.
 15347
 15348     IF CM-LAST-ADD-ON-DT NOT = SPACES  AND  ZEROS
 15349         MOVE CM-LAST-ADD-ON-DT  TO DC-BIN-DATE-1
 15350         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 15351         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15352         MOVE DC-GREG-DATE-1-EDIT  TO ADDONDTO
 15353     ELSE
 15354         MOVE SPACES               TO ADDONDTO.
 15355
 15356     MOVE CM-CLAIM-INTERFACE-SW  TO PI-CERT-SWITCH.
 15357
 15358 5030-EXIT.
 15359     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 288
* EL131.cbl
 15361 5040-FIND-BENEFIT.
 15362     ADD 1                       TO COUNT-2.
 15363     IF COUNT-2 GREATER THAN 8
 15364         GO TO 5050-BENEFIT-NOTFND.
 15365
 15366     IF CF-BENEFIT-CODE (COUNT-2) = HOLD-BENEFIT
 15367         GO TO 5060-EXIT.
 15368
 15369     IF CF-BENEFIT-CODE (COUNT-2) GREATER THAN HOLD-BENEFIT
 15370         GO TO 5050-BENEFIT-NOTFND.
 15371
 15372     GO TO 5040-FIND-BENEFIT.
 15373
 15374 5050-BENEFIT-NOTFND.
 15375     MOVE 'X'                    TO ERROR-SWITCH.
 15376
 15377 5060-EXIT.
 15378     EXIT.
 15379 5100-LOAD-CORR-TRLR.
 15380     MOVE PI-COMPANY-CD      TO TRLR-COMPANY-CD.
 15381     MOVE PI-CARRIER         TO TRLR-CARRIER.
 15382     MOVE PI-CLAIM-NO        TO TRLR-CLAIM-NO.
 15383     MOVE PI-CERT-NO         TO TRLR-CERT-NO.
 15384     MOVE 1000               TO TRLR-SEQ-NO.
 15385
 15386
 15387* EXEC CICS HANDLE CONDITION
 15388*         NOTFND    (1052-DONE)
 15389*         ENDFILE   (1052-DONE)
 15390*    END-EXEC.
 15391*    MOVE '"$I''                  ! D #00013016' TO DFHEIV0
 15392     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 15393     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15394     MOVE X'4420233030303133303136' TO DFHEIV0(25:11)
 15395     CALL 'kxdfhei1' USING DFHEIV0
 15396     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15397
 15398
 15399
 15400* EXEC CICS STARTBR
 15401*        DATASET (TRLR-FILE-ID)
 15402*        RIDFLD  (TRLR-KEY)
 15403*    END-EXEC
 15404     MOVE 0
 15405       TO DFHEIV11
 15406*    MOVE '&,         G          &   #00013021' TO DFHEIV0
 15407     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 15408     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 15409     MOVE X'2020233030303133303231' TO DFHEIV0(25:11)
 15410     CALL 'kxdfhei1' USING DFHEIV0,
 15411           TRLR-FILE-ID,
 15412           TRLR-KEY,
 15413           DFHEIV99,
 15414           DFHEIV11,
 15415           DFHEIV99
 15416     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15417
 15418
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 289
* EL131.cbl
 15419     MOVE SPACES TO WS-TRLR-FILE-EOF
 15420                    WS-AUTH-RCVD
 15421     PERFORM 1052-READ-TRLR THRU 1052-EXIT
 15422       UNTIL  TRLR-FILE-EOF
 15423         OR WS-AUTH-RCVD > SPACES.
 15424
 15425
 15426* EXEC CICS ENDBR
 15427*        DATASET (TRLR-FILE-ID)
 15428*    END-EXEC.
 15429     MOVE 0
 15430       TO DFHEIV11
 15431*    MOVE '&2                    $   #00013033' TO DFHEIV0
 15432     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 15433     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15434     MOVE X'2020233030303133303333' TO DFHEIV0(25:11)
 15435     CALL 'kxdfhei1' USING DFHEIV0,
 15436           TRLR-FILE-ID,
 15437           DFHEIV11,
 15438           DFHEIV99
 15439     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15440
 15441
 15442     IF AUTH-RCVD
 15443        MOVE 'Y' TO AUTHRCVO
 15444     ELSE
 15445        MOVE 'N' TO AUTHRCVO
 15446     END-IF.
 15447
 15448
 15449 5100-EXIT.
 15450     EXIT.
 15451
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 290
* EL131.cbl
 15453 6000-CALCULATE-CERT-TERM.
 15454
 15455     IF CM-LF-PREMIUM-RATE NOT NUMERIC
 15456         MOVE ZEROS              TO CM-LF-PREMIUM-RATE.
 15457     IF CM-AH-PREMIUM-RATE NOT NUMERIC
 15458         MOVE ZEROS              TO CM-AH-PREMIUM-RATE.
 15459     IF CM-LOAN-APR NOT NUMERIC
 15460         MOVE ZEROS              TO CM-LOAN-APR.
 15461
 15462*    IF WS-CALC-METHOD  = 'G'
 15463         PERFORM 6100-CALC-GROSS-TERM THRU 6200-EXIT
 15464*     ELSE
 15465*        PERFORM 6500-CALC-NET-TERM   THRU 6700-EXIT.
 15466
 15467     IF N GREATER 120
 15468         MOVE 120                TO N.
 15469
 15470     MOVE '6'                    TO DC-OPTION-CODE.
 15471     MOVE N                      TO DC-ELAPSED-MONTHS.
 15472     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1.
 15473     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
 15474
 15475     IF CM-LF-BENEFIT-CD NOT = ZERO
 15476         MOVE N                  TO CM-LF-ORIG-TERM
 15477         COMPUTE CM-LF-BENEFIT-AMT = PI-PAYMENT-AMT * N
 15478         IF NO-CONVERSION-ERROR
 15479             MOVE DC-BIN-DATE-2  TO CM-LF-LOAN-EXPIRE-DT.
 15480
 15481     IF CM-AH-BENEFIT-CD NOT = ZERO
 15482         MOVE N                  TO CM-AH-ORIG-TERM
 15483         IF NO-CONVERSION-ERROR
 15484             MOVE DC-BIN-DATE-2  TO CM-AH-LOAN-EXPIRE-DT.
 15485
 15486 6000-EXIT.
 15487      EXIT.
 15488
 15489 6100-CALC-GROSS-TERM.
 15490     MOVE CM-LOAN-BALANCE         TO L.
 15491     MOVE PI-PAYMENT-AMT          TO M.
 15492
 15493     COMPUTE N = L / M.
 15494     IF N LESS 1
 15495         MOVE 1  TO N.
 15496
 15497     IF CM-LF-BENEFIT-CD NOT = ZERO
 15498         COMPUTE WS-LF-RATE = CM-LF-PREMIUM-RATE / +1000
 15499     ELSE
 15500         MOVE ZEROS               TO WS-LF-RATE.
 15501
 15502     IF CM-AH-BENEFIT-CD NOT = ZERO
 15503         COMPUTE WS-AH-RATE = CM-AH-PREMIUM-RATE / +1000
 15504     ELSE
 15505         MOVE ZEROS               TO WS-AH-RATE.
 15506
 15507     COMPUTE I = CM-LOAN-APR / +1200.
 15508
 15509 6105-LOOP.
 15510     IF N GREATER 240
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 291
* EL131.cbl
 15511         GO TO 6200-EXIT.
 15512     PERFORM 6210-CALC-LEFT-RIGHTONE THRU 6220-EXIT.
 15513     IF LEFT-TOT-1 GREATER RIGHT-TOT-1
 15514         ADD 1 TO N
 15515         GO TO 6105-LOOP.
 15516
 15517 6200-EXIT.
 15518      EXIT.
 15519
 15520 6210-CALC-LEFT-RIGHTONE.
 15521      MOVE L         TO LEFT-TOT-1.
 15522      SUBTRACT 1 FROM N.
 15523      PERFORM 6300-CALC-A-N THRU 6300-EXIT.
 15524      PERFORM 6350-CALC-IA-N THRU 6400-EXIT.
 15525      ADD 1 TO N.
 15526 6211-CALC-TERM1.
 15527      MOVE N         TO TERM1.
 15528      MULTIPLY M BY TERM1.
 15529 6212-LOOP.
 15530      COMPUTE TERM1 = (WS-AH-RATE + WS-LF-RATE) * TERM1.
 15531      ADD 1 TO A-N.
 15532      MULTIPLY A-N BY TERM1.
 15533      SUBTRACT 1 FROM A-N.
 15534      ADD TERM1 TO LEFT-TOT-1.
 15535 6213-CALC-TERM2.
 15536      MOVE M         TO TERM2.
 15537      COMPUTE TERM2 = (WS-AH-RATE + WS-LF-RATE) * TERM2.
 15538      MULTIPLY IA-N BY TERM2.
 15539      SUBTRACT TERM2 FROM LEFT-TOT-1.
 15540 6215-CALC-RIGHTONE.
 15541      MOVE M         TO RIGHT-TOT-1.
 15542      PERFORM 6300-CALC-A-N THRU 6300-EXIT.
 15543      MULTIPLY A-N BY RIGHT-TOT-1.
 15544 6220-EXIT.
 15545      EXIT.
 15546
 15547 6300-CALC-A-N.
 15548     IF N LESS 1
 15549         MOVE 0     TO A-N
 15550         GO TO 6300-EXIT.
 15551     IF I = 0
 15552         MOVE .00001 TO I.
 15553     ADD 1 TO I.
 15554     DIVIDE I INTO 1 GIVING V.
 15555     SUBTRACT 1 FROM I.
 15556     PERFORM 6450-CALC-V-EX-N THRU 6490-EXIT.
 15557     SUBTRACT V-EX-N FROM 1 GIVING TERM3.
 15558     DIVIDE I INTO TERM3 GIVING A-N.
 15559 6300-EXIT.
 15560      EXIT.
 15561
 15562 6350-CALC-IA-N.
 15563     IF N LESS 1
 15564         MOVE 0      TO IA-N
 15565         GO TO 6400-EXIT.
 15566     ADD 1 TO N.
 15567     PERFORM 6450-CALC-V-EX-N THRU 6490-EXIT.
 15568     SUBTRACT 1 FROM N.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 292
* EL131.cbl
 15569     MULTIPLY N BY V-EX-N GIVING TERM3.
 15570     SUBTRACT TERM3 FROM A-N GIVING TERM3.
 15571     SUBTRACT V FROM 1 GIVING TERM4.
 15572     DIVIDE TERM4 INTO TERM3 GIVING IA-N.
 15573 6400-EXIT.
 15574      EXIT.
 15575
 15576 6450-CALC-V-EX-N.
 15577     IF N LESS 1
 15578         MOVE 1    TO V-EX-N
 15579         GO TO 6490-EXIT.
 15580     MOVE N        TO NV-STORE.
 15581     IF V-EX-ONETIME = 1  OR
 15582        V NOT = V-EXPONENT (1)
 15583          PERFORM 6470-BUILD-V-EX-TABLE THRU 6480-EXIT.
 15584 6460-LOOP.
 15585     IF N GREATER 248
 15586         MOVE 248 TO N.
 15587     IF N = 1
 15588         MOVE V               TO V-EX-N
 15589      ELSE
 15590         MOVE V-EXPONENT (N)  TO V-EX-N.
 15591     GO TO 6490-EXIT.
 15592
 15593 6470-BUILD-V-EX-TABLE.
 15594     MOVE 2      TO N.
 15595     MOVE V      TO V-EXPONENT (1)
 15596                    V-EX-N.
 15597 6471-LOOP.
 15598     MULTIPLY V BY V-EX-N.
 15599     MOVE V-EX-N   TO V-EXPONENT (N).
 15600     ADD 1 TO N.
 15601     IF N LESS 248
 15602         GO TO 6471-LOOP.
 15603     MOVE NV-STORE     TO N.
 15604     MOVE 0            TO V-EX-ONETIME.
 15605 6480-EXIT.
 15606      EXIT.
 15607
 15608 6490-EXIT.
 15609      EXIT.
 15610
 15611 6500-CALC-NET-TERM.
 15612     MOVE CM-LOAN-BALANCE         TO L.
 15613     MOVE PI-PAYMENT-AMT          TO M.
 15614
 15615     DIVIDE L BY M GIVING N REMAINDER WS-REMAIN.
 15616     IF WS-REMAIN GREATER ZERO
 15617         ADD 1 TO N.
 15618     IF N = 0
 15619         MOVE 1 TO N.
 15620
 15621 6700-EXIT.
 15622      EXIT.
 15623
 15624 6999-CALC-TERM-EXIT.
 15625     EXIT.
 15626
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 293
* EL131.cbl
 15628 7000-RESET-ATTRIBUTE.
 15629
 15630     MOVE AL-UANON               TO CERTEFFA  CERTACTA
 15631                                    CERTSTA   CERTCARA
 15632                                    CERTGRPA.
 15633     MOVE -1                     TO CERTCARL.
 15634
 15635 7000-EXIT.
 15636     EXIT.
 15637
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 294
* EL131.cbl
 15639 7600-BROWSE-CLAIM.
 15640
 15641
 15642* EXEC CICS READ
 15643*        DATASET(CLMS-FILE-ID)
 15644*        SET    (ADDRESS OF CLAIM-MASTER)
 15645*        RIDFLD (MSTR-KEY)
 15646*        GENERIC
 15647*        EQUAL
 15648*        KEYLENGTH(ELMSTR-GENERIC-LENGTH)
 15649*    END-EXEC.
 15650*    MOVE '&"S  KG    E          (   #00013236' TO DFHEIV0
 15651     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 15652     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15653     MOVE X'2020233030303133323336' TO DFHEIV0(25:11)
 15654     CALL 'kxdfhei1' USING DFHEIV0,
 15655           CLMS-FILE-ID,
 15656           DFHEIV20,
 15657           DFHEIV99,
 15658           MSTR-KEY,
 15659           ELMSTR-GENERIC-LENGTH,
 15660           DFHEIV99,
 15661           DFHEIV99
 15662     SET ADDRESS OF CLAIM-MASTER TO
 15663         DFHEIV20
 15664     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15665
 15666
 15667     MOVE CL-CONTROL-PRIMARY     TO MSTR-KEY.
 15668
 15669     if cl-assoc-cert-total = 0
 15670        move 1 to cl-assoc-cert-total
 15671     end-if
 15672     IF CL-ASSOC-CERT-SEQU = 0
 15673        MOVE 1 TO CL-ASSOC-CERT-SEQU
 15674     END-IF
 15675
 15676     IF CL-ASSOC-CERT-TOTAL = 1
 15677         MOVE AL-SADOF           TO BCERT1A
 15678                                    BSUFX1A
 15679                                    BCERT2A
 15680                                    BSUFX2A
 15681                                    BCERT3A
 15682                                    BSUFX3A
 15683                                    BCERT4A
 15684                                    BSUFX4A
 15685                                    BCERT5A
 15686                                    BSUFX5A
 15687                                    PCERTNOA
 15688                                    PSUFXA
 15689                                    LABEL1A
 15690                                    LABEL2A
 15691         GO TO 7699-EXIT.
 15692
 15693 7610-BROWSE-CLAIM-LOOP.
 15694
 15695     MOVE LOW-VALUES             TO BCERT1O
 15696                                    BSUFX1O
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 295
* EL131.cbl
 15697                                    BCERT2O
 15698                                    BSUFX2O
 15699                                    BCERT3O
 15700                                    BSUFX3O
 15701                                    BCERT4O
 15702                                    BSUFX4O
 15703                                    BCERT5O
 15704                                    BSUFX5O.
 15705
 15706
 15707* EXEC CICS HANDLE CONDITION
 15708*        ENDFILE  (7630-END-BROWSE)
 15709*    END-EXEC.
 15710*    MOVE '"$''                   ! E #00013284' TO DFHEIV0
 15711     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 15712     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15713     MOVE X'4520233030303133323834' TO DFHEIV0(25:11)
 15714     CALL 'kxdfhei1' USING DFHEIV0
 15715     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15716
 15717
 15718
 15719* EXEC CICS STARTBR
 15720*        DATASET    (CLMS-FILE-ID)
 15721*        RIDFLD     (MSTR-KEY)
 15722*    END-EXEC.
 15723     MOVE 0
 15724       TO DFHEIV11
 15725*    MOVE '&,         G          &   #00013288' TO DFHEIV0
 15726     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 15727     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 15728     MOVE X'2020233030303133323838' TO DFHEIV0(25:11)
 15729     CALL 'kxdfhei1' USING DFHEIV0,
 15730           CLMS-FILE-ID,
 15731           MSTR-KEY,
 15732           DFHEIV99,
 15733           DFHEIV11,
 15734           DFHEIV99
 15735     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15736
 15737
 15738     MOVE +1                     TO WS-ASSOCIATED-CERTS.
 15739
 15740 7620-READ-CLAIM-LOOP.
 15741
 15742
 15743* EXEC CICS READNEXT
 15744*        DATASET   (CLMS-FILE-ID)
 15745*        SET       (ADDRESS OF CLAIM-MASTER)
 15746*        RIDFLD    (MSTR-KEY)
 15747*    END-EXEC.
 15748     MOVE 0
 15749       TO DFHEIV11
 15750*    MOVE '&.S                   )   #00013297' TO DFHEIV0
 15751     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 15752     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 15753     MOVE X'2020233030303133323937' TO DFHEIV0(25:11)
 15754     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 296
* EL131.cbl
 15755           CLMS-FILE-ID,
 15756           DFHEIV20,
 15757           DFHEIV99,
 15758           MSTR-KEY,
 15759           DFHEIV99,
 15760           DFHEIV11,
 15761           DFHEIV99,
 15762           DFHEIV99
 15763     SET ADDRESS OF CLAIM-MASTER TO
 15764         DFHEIV20
 15765     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15766
 15767
 15768     IF CL-COMPANY-CD  NOT = PI-COMPANY-CD   OR
 15769        CL-CARRIER     NOT = CARRI           OR
 15770        CL-CLAIM-NO    NOT = CLAIMI
 15771        GO TO 7630-END-BROWSE.
 15772
 15773     IF WS-ASSOCIATED-CERTS = 1
 15774         MOVE CL-CERT-PRIME      TO BCERT1O
 15775         MOVE CL-CERT-SFX        TO BSUFX1O.
 15776
 15777     IF WS-ASSOCIATED-CERTS = 2
 15778         MOVE CL-CERT-PRIME      TO BCERT2O
 15779         MOVE CL-CERT-SFX        TO BSUFX2O.
 15780
 15781     IF WS-ASSOCIATED-CERTS = 3
 15782         MOVE CL-CERT-PRIME      TO BCERT3O
 15783         MOVE CL-CERT-SFX        TO BSUFX3O.
 15784
 15785     IF WS-ASSOCIATED-CERTS = 4
 15786         MOVE CL-CERT-PRIME      TO BCERT4O
 15787         MOVE CL-CERT-SFX        TO BSUFX4O.
 15788
 15789     IF WS-ASSOCIATED-CERTS = 5
 15790         MOVE CL-CERT-PRIME      TO BCERT5O
 15791         MOVE CL-CERT-SFX        TO BSUFX5O
 15792     ELSE
 15793         ADD +1                  TO WS-ASSOCIATED-CERTS
 15794         GO TO 7620-READ-CLAIM-LOOP.
 15795
 15796 7630-END-BROWSE.
 15797
 15798
 15799* EXEC CICS ENDBR
 15800*        DATASET   (CLMS-FILE-ID)
 15801*    END-EXEC.
 15802     MOVE 0
 15803       TO DFHEIV11
 15804*    MOVE '&2                    $   #00013333' TO DFHEIV0
 15805     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 15806     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15807     MOVE X'2020233030303133333333' TO DFHEIV0(25:11)
 15808     CALL 'kxdfhei1' USING DFHEIV0,
 15809           CLMS-FILE-ID,
 15810           DFHEIV11,
 15811           DFHEIV99
 15812     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 297
* EL131.cbl
 15813
 15814
 15815 7640-HIGHLIGHT-CERT-DISPLAYED.
 15816
 15817     MOVE AL-SANON               TO BCERT1A
 15818                                    BSUFX1A
 15819                                    BCERT2A
 15820                                    BSUFX2A
 15821                                    BCERT3A
 15822                                    BSUFX3A
 15823                                    BCERT4A
 15824                                    BSUFX4A
 15825                                    BCERT5A
 15826                                    BSUFX5A.
 15827
 15828     IF BCERT1O = CERTI AND
 15829        BSUFX1O = SUFXI
 15830            MOVE AL-SABON        TO BCERT1A
 15831                                    BSUFX1A.
 15832
 15833     IF BCERT2O = CERTI AND
 15834        BSUFX2O = SUFXI
 15835            MOVE AL-SABON        TO BCERT2A
 15836                                    BSUFX2A.
 15837
 15838     IF BCERT3O = CERTI AND
 15839        BSUFX3O = SUFXI
 15840            MOVE AL-SABON        TO BCERT3A
 15841                                    BSUFX3A.
 15842
 15843     IF BCERT4O = CERTI AND
 15844        BSUFX4O = SUFXI
 15845            MOVE AL-SABON        TO BCERT4A
 15846                                    BSUFX4A.
 15847
 15848     IF BCERT5O = CERTI AND
 15849        BSUFX5O = SUFXI
 15850            MOVE AL-SABON        TO BCERT5A
 15851                                    BSUFX5A.
 15852
 15853 7699-EXIT.
 15854     EXIT.
 15855
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 298
* EL131.cbl
 15857 7700-CHECK-SEQUENCE.
 15858
 15859
 15860* EXEC CICS HANDLE CONDITION
 15861*        ENDFILE  (7799-EXIT)
 15862*        NOTFND   (7799-EXIT)
 15863*    END-EXEC.
 15864*    MOVE '"$''I                  ! F #00013381' TO DFHEIV0
 15865     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 15866     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15867     MOVE X'4620233030303133333831' TO DFHEIV0(25:11)
 15868     CALL 'kxdfhei1' USING DFHEIV0
 15869     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15870
 15871
 15872
 15873* EXEC CICS READ
 15874*        DATASET(CLMS-FILE-ID)
 15875*        SET    (ADDRESS OF CLAIM-MASTER)
 15876*        RIDFLD (MSTR-KEY)
 15877*        GENERIC
 15878*        KEYLENGTH(ELMSTR-GENERIC-LENGTH)
 15879*    END-EXEC.
 15880*    MOVE '&"S  KG    E          (   #00013386' TO DFHEIV0
 15881     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 15882     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15883     MOVE X'2020233030303133333836' TO DFHEIV0(25:11)
 15884     CALL 'kxdfhei1' USING DFHEIV0,
 15885           CLMS-FILE-ID,
 15886           DFHEIV20,
 15887           DFHEIV99,
 15888           MSTR-KEY,
 15889           ELMSTR-GENERIC-LENGTH,
 15890           DFHEIV99,
 15891           DFHEIV99
 15892     SET ADDRESS OF CLAIM-MASTER TO
 15893         DFHEIV20
 15894     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15895
 15896
 15897     COMPUTE WS-ASSOC-CERT-TOTAL =
 15898             CL-ASSOC-CERT-TOTAL + ONE-OR-MIN1.
 15899
 15900     GO TO 7799-EXIT.
 15901
 15902 7710-RESEQUENCE-CLAIMS.
 15903
 15904
 15905* EXEC CICS HANDLE CONDITION
 15906*        ENDFILE  (7799-EXIT)
 15907*    END-EXEC.
 15908*    MOVE '"$''                   ! G #00013401' TO DFHEIV0
 15909     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 15910     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15911     MOVE X'4720233030303133343031' TO DFHEIV0(25:11)
 15912     CALL 'kxdfhei1' USING DFHEIV0
 15913     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15914
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 299
* EL131.cbl
 15915
 15916
 15917* EXEC CICS STARTBR
 15918*        DATASET(CLMS-FILE-ID)
 15919*        RIDFLD (MSTR-KEY)
 15920*    END-EXEC.
 15921     MOVE 0
 15922       TO DFHEIV11
 15923*    MOVE '&,         G          &   #00013405' TO DFHEIV0
 15924     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 15925     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 15926     MOVE X'2020233030303133343035' TO DFHEIV0(25:11)
 15927     CALL 'kxdfhei1' USING DFHEIV0,
 15928           CLMS-FILE-ID,
 15929           MSTR-KEY,
 15930           DFHEIV99,
 15931           DFHEIV11,
 15932           DFHEIV99
 15933     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15934
 15935
 15936     COMPUTE WS-ASSOC-CERT-SEQU =
 15937             WS-ASSOC-CERT-SEQU + 1.
 15938
 15939     COMPUTE WS-READNEXT-SWITCH =
 15940             WS-READNEXT-SWITCH + 1.
 15941
 15942 7720-READ-CLAIM-LOOP.
 15943
 15944
 15945* EXEC CICS READNEXT
 15946*        DATASET(CLMS-FILE-ID)
 15947*        SET    (ADDRESS OF CLAIM-MASTER)
 15948*        RIDFLD (MSTR-KEY)
 15949*    END-EXEC.
 15950     MOVE 0
 15951       TO DFHEIV11
 15952*    MOVE '&.S                   )   #00013418' TO DFHEIV0
 15953     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 15954     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 15955     MOVE X'2020233030303133343138' TO DFHEIV0(25:11)
 15956     CALL 'kxdfhei1' USING DFHEIV0,
 15957           CLMS-FILE-ID,
 15958           DFHEIV20,
 15959           DFHEIV99,
 15960           MSTR-KEY,
 15961           DFHEIV99,
 15962           DFHEIV11,
 15963           DFHEIV99,
 15964           DFHEIV99
 15965     SET ADDRESS OF CLAIM-MASTER TO
 15966         DFHEIV20
 15967     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15968
 15969
 15970     IF WS-READNEXT-SWITCH = 1
 15971         ADD 1                   TO WS-READNEXT-SWITCH
 15972         GO TO 7720-READ-CLAIM-LOOP.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 300
* EL131.cbl
 15973
 15974 7730-END-BROWSE.
 15975
 15976
 15977* EXEC CICS ENDBR
 15978*        DATASET(CLMS-FILE-ID)
 15979*    END-EXEC.
 15980     MOVE 0
 15981       TO DFHEIV11
 15982*    MOVE '&2                    $   #00013430' TO DFHEIV0
 15983     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 15984     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15985     MOVE X'2020233030303133343330' TO DFHEIV0(25:11)
 15986     CALL 'kxdfhei1' USING DFHEIV0,
 15987           CLMS-FILE-ID,
 15988           DFHEIV11,
 15989           DFHEIV99
 15990     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15991
 15992
 15993 7740-READ-CLAIM-UPDATE.
 15994
 15995     IF CL-COMPANY-CD  NOT = WS-SAVE-COMPANY-CD  OR
 15996        CL-CARRIER     NOT = WS-SAVE-CARRIER     OR
 15997        CL-CLAIM-NO    NOT = WS-SAVE-CLAIM-NO
 15998        GO TO 7799-EXIT
 15999     ELSE
 16000        MOVE ZERO                TO WS-READNEXT-SWITCH.
 16001
 16002
 16003* EXEC CICS READ
 16004*        DATASET(CLMS-FILE-ID)
 16005*        SET    (ADDRESS OF CLAIM-MASTER)
 16006*        RIDFLD (MSTR-KEY)
 16007*        UPDATE
 16008*    END-EXEC.
 16009*    MOVE '&"S        EU         (   #00013443' TO DFHEIV0
 16010     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16011     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16012     MOVE X'2020233030303133343433' TO DFHEIV0(25:11)
 16013     CALL 'kxdfhei1' USING DFHEIV0,
 16014           CLMS-FILE-ID,
 16015           DFHEIV20,
 16016           DFHEIV99,
 16017           MSTR-KEY,
 16018           DFHEIV99,
 16019           DFHEIV99,
 16020           DFHEIV99
 16021     SET ADDRESS OF CLAIM-MASTER TO
 16022         DFHEIV20
 16023     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16024
 16025
 16026     if (cl-priority-cd = '8')
 16027        and (pi-processor-id not = 'PEMA' and 'JMS '
 16028             AND 'AMWA')
 16029        MOVE ER-8003             TO EMI-ERROR
 16030        PERFORM 9900-ERROR-FORMAT
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 301
* EL131.cbl
 16031                                 THRU 9900-EXIT
 16032        MOVE -1                  TO MAINTL
 16033        GO TO 8110-SEND-DATA
 16034     end-if
 16035
 16036     IF PI-COMPANY-ID = 'CID' or 'AHL'
 16037         MOVE 'Y'                TO CL-YESNOSW
 16038     END-IF.
 16039
 16040     MOVE WS-ASSOC-CERT-TOTAL    TO CL-ASSOC-CERT-TOTAL.
 16041     MOVE WS-ASSOC-CERT-SEQU     TO CL-ASSOC-CERT-SEQU.
 16042
 16043
 16044* EXEC CICS REWRITE
 16045*         DATASET(CLMS-FILE-ID)
 16046*         FROM   (CLAIM-MASTER)
 16047*    END-EXEC.
 16048     MOVE LENGTH OF
 16049      CLAIM-MASTER
 16050       TO DFHEIV11
 16051*    MOVE '&& L                  %   #00013467' TO DFHEIV0
 16052     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16053     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16054     MOVE X'2020233030303133343637' TO DFHEIV0(25:11)
 16055     CALL 'kxdfhei1' USING DFHEIV0,
 16056           CLMS-FILE-ID,
 16057           CLAIM-MASTER,
 16058           DFHEIV11,
 16059           DFHEIV99
 16060     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16061
 16062
 16063     GO TO 7710-RESEQUENCE-CLAIMS.
 16064
 16065 7799-EXIT.
 16066     EXIT.
 16067
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 302
* EL131.cbl
 16069 7800-CHECK-AUTO-ACTIVITY.
 16070
 16071
 16072* EXEC CICS HANDLE CONDITION
 16073*        NOTFND   (7800-NOT-FOUND)
 16074*    END-EXEC.
 16075*    MOVE '"$I                   ! H #00013480' TO DFHEIV0
 16076     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16077     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16078     MOVE X'4820233030303133343830' TO DFHEIV0(25:11)
 16079     CALL 'kxdfhei1' USING DFHEIV0
 16080     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16081
 16082
 16083     MOVE PI-COMPANY-ID              TO  CNTL-CO-ID.
 16084     MOVE 'T'                        TO  CNTL-REC-TYPE.
 16085     MOVE SPACES                     TO  CNTL-PROC-ID.
 16086     MOVE +0                         TO  CNTL-SEQ-NO.
 16087
 16088
 16089* EXEC CICS READ
 16090*        DATASET   (CNTL-FILE-ID)
 16091*        RIDFLD    (CNTL-KEY)
 16092*        SET       (ADDRESS OF CONTROL-FILE)
 16093*    END-EXEC.
 16094*    MOVE '&"S        E          (   #00013489' TO DFHEIV0
 16095     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16096     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16097     MOVE X'2020233030303133343839' TO DFHEIV0(25:11)
 16098     CALL 'kxdfhei1' USING DFHEIV0,
 16099           CNTL-FILE-ID,
 16100           DFHEIV20,
 16101           DFHEIV99,
 16102           CNTL-KEY,
 16103           DFHEIV99,
 16104           DFHEIV99,
 16105           DFHEIV99
 16106     SET ADDRESS OF CONTROL-FILE TO
 16107         DFHEIV20
 16108     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16109
 16110
 16111     IF CL-ACTIVITY-CODE IS NOT NUMERIC
 16112         MOVE ZEROS                  TO  CL-ACTIVITY-CODE.
 16113
 16114     IF CL-ACTIVITY-CODE NOT = ZEROS
 16115         MOVE CL-ACTIVITY-CODE                 TO  MISC-SUB
 16116         IF MISC-SUB IS GREATER THAN +9
 16117             SUBTRACT +9 FROM MISC-SUB
 16118             MOVE CF-USER-RESET-SW (MISC-SUB)  TO  WS-RESET-SW
 16119         ELSE
 16120             MOVE CF-SYS-RESET-SW  (MISC-SUB)  TO  WS-RESET-SW
 16121     ELSE
 16122         MOVE 'Y'                              TO  WS-RESET-SW.
 16123
 16124     IF STATUSI = 'C' OR 'CLOSED'
 16125         IF CF-SYS-ACTIVE-SW (7) = ' ' OR 'N'
 16126             MOVE 'N'                TO  PI-REC-FOUND-SW
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 303
* EL131.cbl
 16127                                         PI-LETTER-SW
 16128             GO TO 7800-EXIT.
 16129
 16130     IF STATUSI = 'C' OR 'CLOSED'
 16131         IF CF-SYS-LETTER-ID (7) = SPACES OR LOW-VALUES
 16132             MOVE 'N'                TO  PI-LETTER-SW
 16133         ELSE
 16134             MOVE 'Y'                TO  PI-LETTER-SW.
 16135
 16136     IF STATUSI = 'O' OR 'OPEN'
 16137         IF CF-SYS-ACTIVE-SW (8) = ' ' OR 'N'
 16138             MOVE 'N'                TO  PI-REC-FOUND-SW
 16139                                         PI-LETTER-SW
 16140             GO TO 7800-EXIT.
 16141
 16142     IF STATUSI = 'O' OR 'OPEN'
 16143         IF CF-SYS-LETTER-ID (8) = SPACES OR LOW-VALUES
 16144             MOVE 'N'                TO  PI-LETTER-SW
 16145         ELSE
 16146             MOVE 'Y'                TO  PI-LETTER-SW.
 16147
 16148     MOVE 'Y'                        TO  PI-REC-FOUND-SW.
 16149     GO TO 7800-EXIT.
 16150
 16151 7800-NOT-FOUND.
 16152
 16153     MOVE 'N'                        TO  PI-REC-FOUND-SW
 16154                                         PI-LETTER-SW.
 16155
 16156 7800-EXIT.
 16157     EXIT.
 16158
 16159 7850-AUTO-LETTER-WRITER.
 16160
 16161     MOVE LOW-VALUES                 TO  W-1523-LINKDATA.
 16162     MOVE PROGRAM-INTERFACE-BLOCK    TO  W-1523-COMMON-PI-DATA.
 16163
 16164     IF STATUSI = 'C' OR 'CLOSED'
 16165         MOVE CF-SYS-LETTER-ID (7)   TO  W-1523-FORM-NUMBER
 16166     ELSE
 16167         MOVE CF-SYS-LETTER-ID (8)   TO  W-1523-FORM-NUMBER.
 16168
 16169     IF STATUSI = 'C' OR 'CLOSED'
 16170         IF CF-SYS-RESEND-DAYS (7) NOT = ZEROS
 16171             MOVE SAVE-BIN-DATE      TO  DC-BIN-DATE-1
 16172             MOVE '6'                TO  DC-OPTION-CODE
 16173             MOVE CF-SYS-RESEND-DAYS (7) TO  DC-ELAPSED-DAYS
 16174             MOVE +0                 TO  DC-ELAPSED-MONTHS
 16175             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 16176             IF NO-CONVERSION-ERROR
 16177                 MOVE DC-BIN-DATE-2  TO  W-1523-RESEND-DATE
 16178             ELSE
 16179                 MOVE LOW-VALUES     TO  W-1523-RESEND-DATE.
 16180
 16181     IF STATUSI = 'C' OR 'CLOSED'
 16182         IF CF-SYS-FOLLOW-UP-DAYS (7) NOT = ZEROS
 16183             MOVE SAVE-BIN-DATE      TO  DC-BIN-DATE-1
 16184             MOVE '6'                TO  DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 304
* EL131.cbl
 16185             MOVE CF-SYS-FOLLOW-UP-DAYS (7) TO  DC-ELAPSED-DAYS
 16186             MOVE +0                 TO  DC-ELAPSED-MONTHS
 16187             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 16188             IF NO-CONVERSION-ERROR
 16189                 MOVE DC-BIN-DATE-2  TO  W-1523-FOLLOW-UP-DATE
 16190             ELSE
 16191                 MOVE LOW-VALUES     TO  W-1523-FOLLOW-UP-DATE.
 16192
 16193     IF STATUSI = 'O' OR 'OPEN'
 16194         IF CF-SYS-RESEND-DAYS (8) NOT = ZEROS
 16195             MOVE SAVE-BIN-DATE      TO  DC-BIN-DATE-1
 16196             MOVE '6'                TO  DC-OPTION-CODE
 16197             MOVE CF-SYS-RESEND-DAYS (8) TO  DC-ELAPSED-DAYS
 16198             MOVE +0                 TO  DC-ELAPSED-MONTHS
 16199             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 16200             IF NO-CONVERSION-ERROR
 16201                 MOVE DC-BIN-DATE-2  TO  W-1523-RESEND-DATE
 16202             ELSE
 16203                 MOVE LOW-VALUES     TO  W-1523-RESEND-DATE.
 16204
 16205     IF STATUSI = 'O' OR 'OPEN'
 16206         IF CF-SYS-FOLLOW-UP-DAYS (8) NOT = ZEROS
 16207             MOVE SAVE-BIN-DATE      TO  DC-BIN-DATE-1
 16208             MOVE '6'                TO  DC-OPTION-CODE
 16209             MOVE CF-SYS-FOLLOW-UP-DAYS (8) TO  DC-ELAPSED-DAYS
 16210             MOVE +0                 TO  DC-ELAPSED-MONTHS
 16211             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 16212             IF NO-CONVERSION-ERROR
 16213                 MOVE DC-BIN-DATE-2  TO  W-1523-FOLLOW-UP-DATE
 16214             ELSE
 16215                 MOVE LOW-VALUES     TO  W-1523-FOLLOW-UP-DATE.
 16216
 16217
 16218* EXEC CICS LINK
 16219*        PROGRAM    (LINK-1523)
 16220*        COMMAREA   (W-1523-LINKDATA)
 16221*        LENGTH     (W-1523-COMM-LENGTH)
 16222*    END-EXEC.
 16223*    MOVE '."C                   (   #00013601' TO DFHEIV0
 16224     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16225     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16226     MOVE X'2020233030303133363031' TO DFHEIV0(25:11)
 16227     CALL 'kxdfhei1' USING DFHEIV0,
 16228           LINK-1523,
 16229           W-1523-LINKDATA,
 16230           W-1523-COMM-LENGTH,
 16231           DFHEIV99,
 16232           DFHEIV99,
 16233           DFHEIV99,
 16234           DFHEIV99
 16235     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16236
 16237
 16238     IF W-1523-ERROR-CODE = ZEROS
 16239         GO TO 7850-EXIT.
 16240
 16241     IF W-1523-FATAL-ERROR
 16242         MOVE ER-0802                TO  EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 305
* EL131.cbl
 16243         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16244
 16245     IF W-1523-ERROR-CODE = 0191
 16246         MOVE ER-0803                TO  EMI-ERROR
 16247         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16248
 16249 7850-EXIT.
 16250     EXIT.
 16251
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 306
* EL131.cbl
 16253 8000-CREATE-DMO-REC.
 16254     MOVE PI-COMPANY-CD          TO NOTE-COMP-CD.
 16255     MOVE CL-CERT-KEY-DATA       TO NOTE-CERT-KEY.
 16256     MOVE CL-CERT-NO             TO NOTE-CERT-NO.
 16257
 16258
 16259* EXEC CICS HANDLE CONDITION
 16260*         NOTFND   (8000-NOTE-NOT-FOUND)
 16261*    END-EXEC.
 16262*    MOVE '"$I                   ! I #00013627' TO DFHEIV0
 16263     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16264     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16265     MOVE X'4920233030303133363237' TO DFHEIV0(25:11)
 16266     CALL 'kxdfhei1' USING DFHEIV0
 16267     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16268
 16269
 16270
 16271* EXEC CICS READ
 16272*         DATASET(NOTE-FILE-ID)
 16273*         SET    (ADDRESS OF CERTIFICATE-NOTE)
 16274*         RIDFLD (NOTE-KEY)
 16275*    END-EXEC.
 16276*    MOVE '&"S        E          (   #00013631' TO DFHEIV0
 16277     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16278     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16279     MOVE X'2020233030303133363331' TO DFHEIV0(25:11)
 16280     CALL 'kxdfhei1' USING DFHEIV0,
 16281           NOTE-FILE-ID,
 16282           DFHEIV20,
 16283           DFHEIV99,
 16284           NOTE-KEY,
 16285           DFHEIV99,
 16286           DFHEIV99,
 16287           DFHEIV99
 16288     SET ADDRESS OF CERTIFICATE-NOTE TO
 16289         DFHEIV20
 16290     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16291
 16292
 16293     MOVE SPACES                 TO DCT-COMMUNICATION-AREA.
 16294     MOVE CL-BENEFICIARY         TO DCT-LOGIC-BENEFICIARY-ID.
 16295     MOVE CL-CCN                 TO DCT-CREDIT-CARD-NUMBER.
 16296
 16297     IF CL-CERT-GROUPING (5:2) = SPACES OR ZEROS
 16298         MOVE 'CC'               TO DCT-PRODUCT-CODE
 16299     ELSE
 16300         MOVE CL-CERT-GROUPING (5:2) TO DCT-PRODUCT-CODE.
 16301
 16302     MOVE CN-CSI-CC-BILL-BANK-ID TO DCT-BILLING-BANK-ID.
 16303     MOVE '02'                   TO DCT-COLUMN-ID-REQUESTED.
 16304
 16305
 16306* EXEC CICS LINK
 16307*        PROGRAM    ('DLO006')
 16308*        COMMAREA   (DCT-COMMUNICATION-AREA)
 16309*        LENGTH     (WS-DCT-LENGTH)
 16310*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 307
* EL131.cbl
 16311     MOVE 'DLO006' TO DFHEIV1
 16312*    MOVE '."C                   (   #00013649' TO DFHEIV0
 16313     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16314     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16315     MOVE X'2020233030303133363439' TO DFHEIV0(25:11)
 16316     CALL 'kxdfhei1' USING DFHEIV0,
 16317           DFHEIV1,
 16318           DCT-COMMUNICATION-AREA,
 16319           WS-DCT-LENGTH,
 16320           DFHEIV99,
 16321           DFHEIV99,
 16322           DFHEIV99,
 16323           DFHEIV99
 16324     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16325
 16326
 16327     IF  DCT-RETURN-CODE = 'OK'
 16328         GO TO 8000-CONT.
 16329
 16330     IF DCT-RETURN-CODE = '01' OR '02'
 16331         GO TO 8000-EXIT.
 16332
 16333     IF DCT-RETURN-CODE = '03'
 16334         MOVE ER-0951            TO EMI-ERROR
 16335         MOVE -1                 TO MAINTL
 16336         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16337         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16338         GO TO 8110-SEND-DATA.
 16339
 16340     IF DCT-RETURN-CODE = '04'
 16341         MOVE ER-0946            TO EMI-ERROR
 16342         MOVE -1                 TO MAINTL
 16343         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16344         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16345         GO TO 8110-SEND-DATA.
 16346
 16347     IF DCT-RETURN-CODE = '05'
 16348         MOVE ER-0947            TO EMI-ERROR
 16349         MOVE -1                 TO MAINTL
 16350         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16351         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16352         GO TO 8110-SEND-DATA.
 16353
 16354     IF DCT-RETURN-CODE = '06'
 16355         MOVE ER-0921            TO EMI-ERROR
 16356         MOVE -1                 TO MAINTL
 16357         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16358         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16359         GO TO 8110-SEND-DATA.
 16360
 16361     IF DCT-RETURN-CODE = '07'
 16362         MOVE ER-0919            TO EMI-ERROR
 16363         MOVE -1                 TO MAINTL
 16364         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16365         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16366         GO TO 8110-SEND-DATA.
 16367
 16368     IF DCT-RETURN-CODE = '08'
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 308
* EL131.cbl
 16369         MOVE ER-0948            TO EMI-ERROR
 16370         MOVE -1                 TO MAINTL
 16371         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16372         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16373         GO TO 8110-SEND-DATA.
 16374
 16375     IF DCT-RETURN-CODE = 'N1'
 16376         MOVE ER-0950            TO EMI-ERROR
 16377         MOVE -1                 TO MAINTL
 16378         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16379         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16380         GO TO 8110-SEND-DATA.
 16381
 16382     IF DCT-RETURN-CODE = 'E1'
 16383         MOVE ER-0974            TO EMI-ERROR
 16384         MOVE -1                 TO MAINTL
 16385         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16386         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16387         GO TO 8110-SEND-DATA.
 16388
 16389     IF DCT-RETURN-CODE = 'E2'
 16390         MOVE ER-0975            TO EMI-ERROR
 16391         MOVE -1                 TO MAINTL
 16392         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16393         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16394         GO TO 8110-SEND-DATA.
 16395
 16396     IF DCT-RETURN-CODE NOT = 'OK'
 16397         MOVE ER-0949            TO EMI-ERROR
 16398         MOVE -1                 TO MAINTL
 16399         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16400         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16401         GO TO 8110-SEND-DATA.
 16402
 16403 8000-CONT.
 16404
 16405     MOVE SPACES                 TO DMO-COMMUNICATION-AREA.
 16406     MOVE 'CS'                   TO DM-RECORD-TYPE.
 16407     MOVE DCT-DISTRIBUTION-CODE  TO DM-DIST-CODE.
 16408     MOVE DCT-MAIL-CODE          TO DM-MAIL-CODE.
 16409     MOVE CL-CLAIM-NO            TO DM-CLAIM-NO.
 16410     MOVE CL-CERT-NO (4:1)       TO DM-CLAIM-TYPE.
 16411     MOVE CL-CCN                 TO DM-CREDIT-CARD-NUMBER.
 16412     MOVE SAVE-DATE-CCYYMMDD     TO DM-STATUS-DATE.
 16413
 16414     MOVE CL-INSURED-LAST-NAME   TO W-NAME-LAST.
 16415     MOVE CL-INSURED-1ST-NAME    TO W-NAME-FIRST.
 16416     MOVE CL-INSURED-MID-INIT    TO W-NAME-MIDDLE.
 16417     PERFORM 8050-FORMAT-LAST-NAME-1ST THRU 8050-EXIT.
 16418     MOVE WS-NAME-WORK           TO DM-INSURED-NAME.
 16419
 16420     IF STATUSI = 'OPEN' OR 'O'
 16421         MOVE 'R'                TO DM-STAT-CHANGE-TYPE
 16422      ELSE
 16423         MOVE 'C'                TO DM-STAT-CHANGE-TYPE.
 16424
 16425     IF STATUSI = 'OPEN' OR 'O'
 16426        IF CL-NO-OF-PMTS-MADE = 0
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 309
* EL131.cbl
 16427         MOVE '1'                TO DM-CLAIM-STATUS
 16428      ELSE
 16429         MOVE '2'                TO DM-CLAIM-STATUS.
 16430
 16431     IF STATUSI = 'CLOSED' OR 'C'
 16432        IF NOT FINAL-PAID
 16433         MOVE '3'                TO DM-CLAIM-STATUS
 16434      ELSE
 16435         MOVE '4'                TO DM-CLAIM-STATUS.
 16436
 16437     MOVE CL-CARRIER             TO DM-STAT-CARRIER.
 16438
 16439
 16440* EXEC CICS LINK
 16441*        PROGRAM    ('DLO025')
 16442*        COMMAREA   (DMO-COMMUNICATION-AREA)
 16443*        LENGTH     (WS-DMO-LENGTH)
 16444*    END-EXEC.
 16445     MOVE 'DLO025' TO DFHEIV1
 16446*    MOVE '."C                   (   #00013767' TO DFHEIV0
 16447     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16448     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16449     MOVE X'2020233030303133373637' TO DFHEIV0(25:11)
 16450     CALL 'kxdfhei1' USING DFHEIV0,
 16451           DFHEIV1,
 16452           DMO-COMMUNICATION-AREA,
 16453           WS-DMO-LENGTH,
 16454           DFHEIV99,
 16455           DFHEIV99,
 16456           DFHEIV99,
 16457           DFHEIV99
 16458     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16459
 16460
 16461     IF  DM-RETURN-CODE = 'OK'
 16462         GO TO 8000-EXIT.
 16463
 16464     IF DM-RETURN-CODE = '01'
 16465         MOVE ER-8051            TO EMI-ERROR
 16466         MOVE -1                 TO MAINTL
 16467         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16468         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16469         GO TO 8110-SEND-DATA.
 16470
 16471     IF DM-RETURN-CODE = '02'
 16472         MOVE ER-8052            TO EMI-ERROR
 16473         MOVE -1                 TO MAINTL
 16474         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16475         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16476         GO TO 8110-SEND-DATA.
 16477
 16478     IF DM-RETURN-CODE = '03'
 16479         MOVE ER-8053            TO EMI-ERROR
 16480         MOVE -1                 TO MAINTL
 16481         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16482         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16483         GO TO 8110-SEND-DATA.
 16484
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 310
* EL131.cbl
 16485     IF DM-RETURN-CODE = '04'
 16486         MOVE ER-8054            TO EMI-ERROR
 16487         MOVE -1                 TO MAINTL
 16488         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16489         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16490         GO TO 8110-SEND-DATA.
 16491
 16492     IF DM-RETURN-CODE = '05'
 16493         MOVE ER-8055            TO EMI-ERROR
 16494         MOVE -1                 TO MAINTL
 16495         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16496         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16497         GO TO 8110-SEND-DATA.
 16498
 16499     IF DM-RETURN-CODE = '06'
 16500         MOVE ER-8056            TO EMI-ERROR
 16501         MOVE -1                 TO MAINTL
 16502         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16503         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16504         GO TO 8110-SEND-DATA.
 16505
 16506     IF DM-RETURN-CODE = '07'
 16507         MOVE ER-8057            TO EMI-ERROR
 16508         MOVE -1                 TO MAINTL
 16509         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16510         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16511         GO TO 8110-SEND-DATA.
 16512
 16513     IF DM-RETURN-CODE = '08'
 16514         MOVE ER-8058            TO EMI-ERROR
 16515         MOVE -1                 TO MAINTL
 16516         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16517         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16518         GO TO 8110-SEND-DATA.
 16519
 16520     IF DM-RETURN-CODE = '09'
 16521         MOVE ER-8059            TO EMI-ERROR
 16522         MOVE -1                 TO MAINTL
 16523         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16524         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16525         GO TO 8110-SEND-DATA.
 16526
 16527     IF DM-RETURN-CODE = '10'
 16528         MOVE ER-8060            TO EMI-ERROR
 16529         MOVE -1                 TO MAINTL
 16530         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16531         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16532         GO TO 8110-SEND-DATA.
 16533
 16534     IF DM-RETURN-CODE = '11'
 16535         MOVE ER-8061            TO EMI-ERROR
 16536         MOVE -1                 TO MAINTL
 16537         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16538         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16539         GO TO 8110-SEND-DATA.
 16540
 16541     IF DM-RETURN-CODE = '12'
 16542         MOVE ER-8062            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 311
* EL131.cbl
 16543         MOVE -1                 TO MAINTL
 16544         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16545         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16546         GO TO 8110-SEND-DATA.
 16547
 16548     IF DM-RETURN-CODE = '13'
 16549         MOVE ER-8063            TO EMI-ERROR
 16550         MOVE -1                 TO MAINTL
 16551         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16552         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16553         GO TO 8110-SEND-DATA.
 16554
 16555     IF DM-RETURN-CODE = '14'
 16556         MOVE ER-8064            TO EMI-ERROR
 16557         MOVE -1                 TO MAINTL
 16558         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16559         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16560         GO TO 8110-SEND-DATA.
 16561
 16562     IF DM-RETURN-CODE = '15'
 16563         MOVE ER-8065            TO EMI-ERROR
 16564         MOVE -1                 TO MAINTL
 16565         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16566         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16567         GO TO 8110-SEND-DATA.
 16568
 16569     IF DM-RETURN-CODE = '16'
 16570         MOVE ER-8154            TO EMI-ERROR
 16571         MOVE -1                 TO MAINTL
 16572         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16573         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16574         GO TO 8110-SEND-DATA.
 16575
 16576     IF DM-RETURN-CODE = '17'
 16577         MOVE ER-8155            TO EMI-ERROR
 16578         MOVE -1                 TO MAINTL
 16579         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16580         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16581         GO TO 8110-SEND-DATA.
 16582
 16583     IF DM-RETURN-CODE = 'N1'
 16584         MOVE ER-8152            TO EMI-ERROR
 16585         MOVE -1                 TO MAINTL
 16586         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16587         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16588         GO TO 8110-SEND-DATA.
 16589
 16590     IF DM-RETURN-CODE = 'E1'
 16591         MOVE ER-8153            TO EMI-ERROR
 16592         MOVE -1                 TO MAINTL
 16593         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16594         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16595         GO TO 8110-SEND-DATA.
 16596
 16597     MOVE ER-8066                TO EMI-ERROR.
 16598     MOVE -1                     TO MAINTL.
 16599     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16600     PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 312
* EL131.cbl
 16601     GO TO 8110-SEND-DATA.
 16602
 16603 8000-NOTE-NOT-FOUND.
 16604
 16605* EXEC CICS SYNCPOINT ROLLBACK END-EXEC.
 16606*    MOVE '6"R                   !   #00013916' TO DFHEIV0
 16607     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 16608     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16609     MOVE X'2020233030303133393136' TO DFHEIV0(25:11)
 16610     CALL 'kxdfhei1' USING DFHEIV0
 16611     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16612
 16613     MOVE ER-0954                TO EMI-ERROR.
 16614     MOVE -1                     TO MAINTL.
 16615     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16616     GO TO 8110-SEND-DATA.
 16617
 16618 8000-EXIT.
 16619     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 313
* EL131.cbl
 16621 8050-FORMAT-LAST-NAME-1ST.
 16622*****************************************************************
 16623*             M O V E   N A M E   R O U T I N E                 *
 16624*                                                               *
 16625*     THE FOLLOWING ROUTINE REARRANGES A GIVEN NAME SO          *
 16626*     THAT IT READS LAST, FIRST, MIDDLE.  PLACE NAME            *
 16627*     FIELDS IN THE FOLLOWING WORKING-STORAGE FIELDS.           *
 16628*                                                               *
 16629*                  FIELD               VALUE                    *
 16630*                  -----               -----                    *
 16631*           W-NAME-LAST    (CL15)      SMITH                    *
 16632*           W-NAME-FIRST   (CL15)      JOHN                     *
 16633*           W-NAME-MIDDLE  (CL15)      ALLEN/A                  *
 16634*                                                               *
 16635*     AFTER NAME HAS BEEN MOVED WS-NAME-WORK WILL CONTAIN       *
 16636*                SMITH, JOHN ALLEN                              *
 16637*                     OR                                        *
 16638*                SMITH, JOHN A.                                 *
 16639*                                                               *
 16640*     TO USE THIS ROUTINE YOU NEED THE WORKING-STORAGE          *
 16641*     COPYBOOK, ELCNWA.                                         *
 16642*****************************************************************.
 16643
 16644     MOVE SPACES                 TO WS-NAME-WORK-AREA.
 16645     MOVE ZERO                   TO WS-NAME-SW.
 16646     SET NWA-INDEX               TO +1.
 16647
 16648     IF W-NAME-LAST   = SPACES  AND
 16649        W-NAME-MIDDLE = SPACES
 16650          MOVE +1                TO WS-NAME-SW.
 16651
 16652     MOVE W-NAME-LAST            TO WS-NAME-WORK2.
 16653     PERFORM 8060-MOVE-NAME THRU 8060-EXIT.
 16654
 16655     MOVE W-NAME-FIRST           TO WS-NAME-WORK2.
 16656     PERFORM 8060-MOVE-NAME THRU 8060-EXIT.
 16657
 16658     SET NWA-INDEX UP BY +1.
 16659
 16660     IF W-NAME-MIDDLE NOT = SPACES
 16661         IF W-NAME-MIDDLE-2 = SPACES
 16662             MOVE W-NAME-MIDDLE  TO WS-NW (NWA-INDEX)
 16663             SET NWA-INDEX UP BY +1
 16664             MOVE '.'            TO WS-NW (NWA-INDEX)
 16665             SET NWA-INDEX UP BY +2
 16666         ELSE
 16667             MOVE W-NAME-MIDDLE  TO WS-NAME-WORK2
 16668             PERFORM 8060-MOVE-NAME THRU 8060-EXIT.
 16669
 16670 8050-EXIT.
 16671     EXIT.
 16672
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 314
* EL131.cbl
 16674 8060-MOVE-NAME.
 16675     IF WS-NAME-SW GREATER THAN +1
 16676         GO TO 8060-EXIT.
 16677
 16678     IF WS-NAME-WORK2 = SPACES
 16679         GO TO 8060-EXIT.
 16680
 16681     SET NWA-INDEX2            TO +1.
 16682     SET NWA-INDEX3            TO +2.
 16683
 16684 8060-MOVE-NAME-CYCLE.
 16685     MOVE WS-NW2 (NWA-INDEX2)  TO WS-NW (NWA-INDEX).
 16686
 16687     IF NWA-INDEX LESS THAN +30
 16688         SET NWA-INDEX UP BY +1
 16689     ELSE
 16690         ADD +2 TO  WS-NAME-SW
 16691         GO TO 8060-EXIT.
 16692
 16693     IF NWA-INDEX2 LESS THAN +20
 16694         SET NWA-INDEX3 UP BY +1
 16695         SET NWA-INDEX2 UP BY +1.
 16696
 16697     IF WS-NW2 (NWA-INDEX2) = SPACES  AND
 16698        WS-NW2 (NWA-INDEX3) = SPACES
 16699         IF WS-NAME-SW = ZERO
 16700             MOVE ','            TO WS-NW (NWA-INDEX)
 16701             SET NWA-INDEX UP BY +2
 16702             MOVE +1             TO WS-NAME-SW
 16703             GO TO 8060-EXIT
 16704         ELSE
 16705             GO TO 8060-EXIT.
 16706
 16707     GO TO 8060-MOVE-NAME-CYCLE.
 16708
 16709 8060-EXIT.
 16710     EXIT.
 16711
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 315
* EL131.cbl
 16713
 16714 8070-UNLOCK-CLAIM-MSTR.
 16715
 16716* EXEC CICS UNLOCK
 16717*        DATASET   (CLMS-FILE-ID)
 16718*    END-EXEC.
 16719*    MOVE '&*                    #   #00014019' TO DFHEIV0
 16720     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 16721     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 16722     MOVE X'2020233030303134303139' TO DFHEIV0(25:11)
 16723     CALL 'kxdfhei1' USING DFHEIV0,
 16724           CLMS-FILE-ID,
 16725           DFHEIV99
 16726     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16727
 16728
 16729 8070-EXIT.
 16730      EXIT.
 16731
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 316
* EL131.cbl
 16733 8100-SEND-MAP.
 16734     PERFORM 8120-FORMAT-TIME-DATE THRU 8130-EXIT.
 16735
 16736     move al-uanon               to accswa
 16737     IF NOT PI-NO-CARRIER-SECURITY
 16738        MOVE AL-SANOF            TO CERTCARA.
 16739     IF NOT PI-NO-ACCOUNT-SECURITY
 16740        MOVE AL-SANOF            TO CERTACTA.
 16741
 16742     IF PI-PROCESSOR-ID = 'LGXX'
 16743        MOVE AL-UANON            TO CCNOA.
 16744
 16745     IF PI-COMPANY-ID = 'DMD'
 16746        NEXT SENTENCE
 16747     ELSE
 16748        MOVE AL-SADOF            TO PFKEY6A.
 16749     IF NOT (PI-COMPANY-ID = 'DCC' OR 'VPP')
 16750        MOVE AL-SANOF TO EXTENSA
 16751     END-IF
 16752
 16753     IF PI-USES-PAID-TO
 16754        MOVE 'PAID TO  :' TO PTHRHDGO.
 16755
 16756
 16757* EXEC CICS SEND
 16758*         MAP     ('EL131A')
 16759*         MAPSET  ('EL131S')
 16760*         ERASE
 16761*         FREEKB
 16762*         CURSOR
 16763*    END-EXEC.
 16764     MOVE 'EL131A' TO DFHEIV1
 16765     MOVE -1
 16766       TO DFHEIV11
 16767     MOVE 'EL131S' TO DFHEIV2
 16768*    MOVE '8$     CT  E F  H     ,   #00014050' TO DFHEIV0
 16769     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 16770     MOVE X'204620204820202020202C20' TO DFHEIV0(13:12)
 16771     MOVE X'2020233030303134303530' TO DFHEIV0(25:11)
 16772     CALL 'kxdfhei1' USING DFHEIV0,
 16773           DFHEIV1,
 16774           EL131AO,
 16775           DFHEIV99,
 16776           DFHEIV2,
 16777           DFHEIV99,
 16778           DFHEIV99,
 16779           DFHEIV99,
 16780           DFHEIV11,
 16781           DFHEIV99,
 16782           DFHEIV99,
 16783           DFHEIV99
 16784     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16785
 16786
 16787     GO TO 9000-RETURN-TRANS.
 16788
 16789 8110-SEND-DATA.
 16790     PERFORM 8120-FORMAT-TIME-DATE THRU 8130-EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 317
* EL131.cbl
 16791
 16792     IF PI-USES-PAID-TO
 16793        MOVE 'PAID TO  :' TO PTHRHDGO.
 16794
 16795     IF PI-PROCESSOR-ID = 'LGXX'
 16796        MOVE AL-UANON            TO CCNOA.
 16797
 16798     IF PI-COMPANY-ID = 'DMD'
 16799        NEXT SENTENCE
 16800     ELSE
 16801        MOVE AL-SADOF            TO PFKEY6A.
 16802
 16803
 16804* EXEC CICS SEND
 16805*         MAP      ('EL131A')
 16806*         MAPSET   ('EL131S')
 16807*         DATAONLY
 16808*         FREEKB
 16809*         CURSOR
 16810*    END-EXEC.
 16811     MOVE 'EL131A' TO DFHEIV1
 16812     MOVE -1
 16813       TO DFHEIV11
 16814     MOVE 'EL131S' TO DFHEIV2
 16815*    MOVE '8$D    CT    F  H     ,   #00014074' TO DFHEIV0
 16816     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 16817     MOVE X'204620204820202020202C20' TO DFHEIV0(13:12)
 16818     MOVE X'2020233030303134303734' TO DFHEIV0(25:11)
 16819     CALL 'kxdfhei1' USING DFHEIV0,
 16820           DFHEIV1,
 16821           EL131AO,
 16822           DFHEIV99,
 16823           DFHEIV2,
 16824           DFHEIV99,
 16825           DFHEIV99,
 16826           DFHEIV99,
 16827           DFHEIV11,
 16828           DFHEIV99,
 16829           DFHEIV99,
 16830           DFHEIV99
 16831     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16832
 16833
 16834     GO TO 9000-RETURN-TRANS.
 16835
 16836 8120-FORMAT-TIME-DATE.
 16837     perform 8140-check-for-prev-errors
 16838                                 thru 8140-exit
 16839     IF SKIP-ATTRIBUTE = 'Y'
 16840        MOVE SPACES              TO SKIP-ATTRIBUTE
 16841        MOVE ER-0598             TO EMI-ERROR
 16842        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16843        GO TO 8125-SKIP-ATTRIBUTE.
 16844
 16845*     IF PI-COMPANY-ID = 'DMD'
 16846      IF PI-PROCESSOR-ID <> 'EMER'
 16847         MOVE AL-PANOF           TO CERTEFFA  CERTACTA  CERTSTA
 16848                                    CERTCARA  CERTGRPA CERTA SUFXA
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 318
* EL131.cbl
 16849
 16850     MOVE AL-PANOF               TO CRTLNMEA  CRTFNMEA  CRTINITA
 16851                                    ISSAGEA   JNTLNMEA  JNTFNMEA
 16852                                    JNTINITA  JNTAGEA   APRA
 16853                                    LCVCDA    LCVOTRMA  LCVRTRMA
 16854                                    LCVBENEA  LCVFORMA  LCVCNDTA
 16855                                    LCVEXITA  LCVSTATA  LCVKINDA
 16856                                    ACVCDA    ACVOTRMA  ACVRTRMA
 16857                                    ACVBENEA  ACVFORMA  ACVCNDTA
 16858                                    ACVEXITA  ACVSTATA  ACVKINDA
 16859                                    PMTFREQA  INDGRPA   PREMTYPA
 16860                                    REINCDA   LCVRATEA  ACVRATEA
 16861                                    ADDONDTA.
 16862
 16863*    IF PI-PROCESSOR-ID NOT = 'LGXX'
 16864*       IF PI-COMPANY-ID = 'DMD'
 16865*          MOVE AL-SANOF         TO TYPEA     CERTA     CERTSTA
 16866*                                   SUFXA
 16867*                                   PDAMTA    NODAYSA   NOPMTSA
 16868*                                   INCA      OCCA
 16869*          IF NOT SYSTEM-MODIFY-CAP
 16870*              MOVE AL-SANOF         TO PDTHRUA.
 16871
 16872     IF PI-COMPANY-ID NOT = 'CRI' AND 'PEM' AND 'NCL'
 16873         MOVE AL-SANOF           TO LCVRATEA  ACVRATEA.
 16874
 16875 8125-SKIP-ATTRIBUTE.
 16876
 16877     MOVE SAVE-DATE              TO DATEO.
 16878
 16879* EXEC CICS ASKTIME ABSTIME(LCP-CICS-TIME)
 16880*    END-EXEC
 16881*    MOVE '0"A                   "   #00014126' TO DFHEIV0
 16882     MOVE X'302241202020202020202020' TO DFHEIV0(1:12)
 16883     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 16884     MOVE X'2020233030303134313236' TO DFHEIV0(25:11)
 16885     CALL 'kxdfhei1' USING DFHEIV0,
 16886           LCP-CICS-TIME
 16887     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16888
 16889* EXEC CICS FORMATTIME
 16890*              ABSTIME(LCP-CICS-TIME)
 16891*              TIME(LCP-TIME-OF-DAY-XX)
 16892*    END-EXEC
 16893*    MOVE 'j$(     (             #   #00014128' TO DFHEIV0
 16894     MOVE X'6A2428202020202028202020' TO DFHEIV0(1:12)
 16895     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 16896     MOVE X'2020233030303134313238' TO DFHEIV0(25:11)
 16897     CALL 'kxdfhei1' USING DFHEIV0,
 16898           LCP-CICS-TIME,
 16899           LCP-TIME-OF-DAY-XX
 16900     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16901     MOVE  LCP-TIME-OF-DAY-68 TO TIME-IN.
 16902     MOVE UN-HOURS               TO FOR-HOURS.
 16903     MOVE UN-MINUTES             TO FOR-MINUTES.
 16904     MOVE TIME-OUT               TO TIMEO.
 16905     MOVE PI-COMPANY-ID          TO COMPO.
 16906     MOVE PI-PROCESSOR-ID        TO USERIDO.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 319
* EL131.cbl
 16907     MOVE MAP-ID                 TO PI-CURRENT-SCREEN-NO.
 16908     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 16909     MOVE EMI-MESSAGE-AREA (1)   TO MSG1O.
 16910     MOVE EMI-MESSAGE-AREA (2)   TO MSG2O.
 16911
 16912 8130-EXIT.
 16913     EXIT.
 16914
 16915 8140-check-for-prev-errors.
 16916
 16917     MOVE PI-COMPANY-CD          TO trlr-company-cd
 16918     MOVE PI-CARRIER             TO trlr-carrier
 16919     MOVE PI-CLAIM-NO            TO trlr-claim-no
 16920     MOVE PI-CERT-NO             TO trlr-cert-no
 16921     MOVE +95                    TO TRLR-SEQ-NO
 16922
 16923
 16924* EXEC CICS READ
 16925*       DATASET  ('ELTRLR')
 16926*       SET      (ADDRESS OF ACTIVITY-TRAILERS)
 16927*       RIDFLD   (TRLR-KEY)
 16928*       RESP     (WS-RESPONSE)
 16929*    END-EXEC
 16930     MOVE 'ELTRLR' TO DFHEIV1
 16931*    MOVE '&"S        E          (  N#00014154' TO DFHEIV0
 16932     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16933     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16934     MOVE X'204E233030303134313534' TO DFHEIV0(25:11)
 16935     CALL 'kxdfhei1' USING DFHEIV0,
 16936           DFHEIV1,
 16937           DFHEIV20,
 16938           DFHEIV99,
 16939           TRLR-KEY,
 16940           DFHEIV99,
 16941           DFHEIV99,
 16942           DFHEIV99
 16943     SET ADDRESS OF ACTIVITY-TRAILERS TO
 16944         DFHEIV20
 16945     MOVE EIBRESP  TO WS-RESPONSE
 16946     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16947
 16948     if ws-resp-normal
 16949        perform varying s1 from +1 by +1 until
 16950           at-note-error-no (s1) = spaces
 16951           if at-note-error-no (s1) = '1652'
 16952              continue
 16953           else
 16954              move at-note-error-no (s1)
 16955                                 to emi-error
 16956              move -1 to maintl
 16957              if at-note-error-no (s1) = '1653'
 16958                 evaluate true
 16959                    when pi-claim-type = 'L'
 16960                       move '  LF  '
 16961                        to emi-claim-type
 16962                    when pi-claim-type = 'I'
 16963                       move '  IU  '
 16964                        to emi-claim-type
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 320
* EL131.cbl
 16965                    WHEN PI-CLAIM-TYPE = 'F'
 16966                       MOVE '  FL  '
 16967                        TO EMI-CLAIM-TYPE
 16968                    when other
 16969                       move '  AH  '
 16970                        to emi-claim-type
 16971                 end-evaluate
 16972              end-if
 16973              PERFORM 9900-ERROR-FORMAT
 16974                                 THRU 9900-EXIT
 16975           end-if
 16976*          if at-note-error-no (s1) = '1653'
 16977*             perform varying emi-sub from 1 by 1 until
 16978*                emi-sub > 3
 16979*                if emi-error-number (emi-sub) = '1653'
 16980*                   evaluate true
 16981*                      when pi-claim-type = 'L'
 16982*                         move '  LF  '
 16983*                          to emi-claim-type
 16984*                      when pi-claim-type = 'I'
 16985*                         move '  IU  '
 16986*                          to emi-claim-type
 16987*                      when other
 16988*                         move '  AH  '
 16989*                          to emi-claim-type
 16990*                   end-evaluate
 16991*                end-if
 16992*             end-perform
 16993*          end-if
 16994        end-perform
 16995     else
 16996        display ' resp not normal ' ws-response ' '
 16997        trlr-key (2:19)
 16998     end-if
 16999
 17000     .
 17001 8140-exit.
 17002     exit.
 17003 8150-ENTERED-CLAIM-NOTFOUND.
 17004
 17005     MOVE ER-0204                TO EMI-ERROR.
 17006     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17007     MOVE -1                     TO MAINTL.
 17008     GO TO 8100-SEND-MAP.
 17009
 17010 8200-RETURN-PRIOR.
 17011     MOVE SPACE                  TO PI-RETURN-CD-1.
 17012     MOVE PI-RETURN-TO-PROGRAM   TO CALL-PGM.
 17013     GO TO 9200-XCTL.
 17014
 17015 8300-GET-HELP.
 17016     MOVE XCTL-EL010             TO CALL-PGM.
 17017     GO TO 9200-XCTL.
 17018
 17019 8400-RETURN-MASTER.
 17020     MOVE SPACE                  TO PI-RETURN-CD-1.
 17021     MOVE XCTL-EL126             TO CALL-PGM.
 17022     GO TO 9200-XCTL.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 321
* EL131.cbl
 17023
 17024 8500-TRLR-MNT.
 17025     IF PI-RETURN-CD-1 = 'X'
 17026         MOVE ER-0311            TO EMI-ERROR
 17027         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17028         MOVE -1                 TO MAINTL
 17029         GO TO 8110-SEND-DATA.
 17030
 17031
 17032* EXEC CICS WRITEQ TS
 17033*         QUEUE     (PI-KEY)
 17034*         FROM      (PROGRAM-INTERFACE-BLOCK)
 17035*         LENGTH    (PI-COMM-LENGTH)
 17036*    END-EXEC.
 17037*    MOVE '*"     L              ''   #00014244' TO DFHEIV0
 17038     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
 17039     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17040     MOVE X'2020233030303134323434' TO DFHEIV0(25:11)
 17041     CALL 'kxdfhei1' USING DFHEIV0,
 17042           PI-KEY,
 17043           PROGRAM-INTERFACE-BLOCK,
 17044           PI-COMM-LENGTH,
 17045           DFHEIV99,
 17046           DFHEIV99,
 17047           DFHEIV99
 17048     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17049
 17050
 17051     MOVE XCTL-EL142             TO CALL-PGM.
 17052     GO TO 9200-XCTL.
 17053
 17054 8600-ADDR-MNT.
 17055     IF PI-RETURN-CD-1 = 'X'
 17056         MOVE ER-0311            TO EMI-ERROR
 17057         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17058         MOVE -1                 TO MAINTL
 17059         GO TO 8110-SEND-DATA.
 17060
 17061
 17062* EXEC CICS WRITEQ TS
 17063*         QUEUE     (PI-KEY)
 17064*         FROM      (PROGRAM-INTERFACE-BLOCK)
 17065*         LENGTH    (PI-COMM-LENGTH)
 17066*    END-EXEC.
 17067*    MOVE '*"     L              ''   #00014260' TO DFHEIV0
 17068     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
 17069     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17070     MOVE X'2020233030303134323630' TO DFHEIV0(25:11)
 17071     CALL 'kxdfhei1' USING DFHEIV0,
 17072           PI-KEY,
 17073           PROGRAM-INTERFACE-BLOCK,
 17074           PI-COMM-LENGTH,
 17075           DFHEIV99,
 17076           DFHEIV99,
 17077           DFHEIV99
 17078     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17079
 17080
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 322
* EL131.cbl
 17081     MOVE XCTL-EL141             TO CALL-PGM.
 17082     GO TO 9200-XCTL.
 17083
 17084 8700-CERT-MNT.
 17085     IF PI-RETURN-CD-1 = 'X'
 17086         MOVE ER-7690            TO EMI-ERROR
 17087         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17088         MOVE -1                 TO MAINTL
 17089         GO TO 8110-SEND-DATA.
 17090
 17091
 17092* EXEC CICS WRITEQ TS
 17093*         QUEUE     (PI-KEY)
 17094*         FROM      (PROGRAM-INTERFACE-BLOCK)
 17095*         LENGTH    (PI-COMM-LENGTH)
 17096*    END-EXEC.
 17097*    MOVE '*"     L              ''   #00014276' TO DFHEIV0
 17098     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
 17099     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17100     MOVE X'2020233030303134323736' TO DFHEIV0(25:11)
 17101     CALL 'kxdfhei1' USING DFHEIV0,
 17102           PI-KEY,
 17103           PROGRAM-INTERFACE-BLOCK,
 17104           PI-COMM-LENGTH,
 17105           DFHEIV99,
 17106           DFHEIV99,
 17107           DFHEIV99
 17108     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17109
 17110
 17111     MOVE XCTL-EL1273            TO CALL-PGM.
 17112     GO TO 9200-XCTL.
 17113
 17114 8725-BENEFICIARY-MNT.
 17115     IF PI-RETURN-CD-1 = 'X'
 17116         MOVE ER-0311            TO EMI-ERROR
 17117         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17118         MOVE -1                 TO MAINTL
 17119         GO TO 8110-SEND-DATA.
 17120
 17121
 17122* EXEC CICS WRITEQ TS
 17123*         QUEUE     (PI-KEY)
 17124*         FROM      (EL131AI)
 17125*         LENGTH    (MAP-LENGTH)
 17126*    END-EXEC.
 17127*    MOVE '*"     L              ''   #00014292' TO DFHEIV0
 17128     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
 17129     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17130     MOVE X'2020233030303134323932' TO DFHEIV0(25:11)
 17131     CALL 'kxdfhei1' USING DFHEIV0,
 17132           PI-KEY,
 17133           EL131AI,
 17134           MAP-LENGTH,
 17135           DFHEIV99,
 17136           DFHEIV99,
 17137           DFHEIV99
 17138     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 323
* EL131.cbl
 17139
 17140
 17141
 17142* EXEC CICS WRITEQ TS
 17143*         QUEUE     (PI-KEY)
 17144*         FROM      (PROGRAM-INTERFACE-BLOCK)
 17145*         LENGTH    (PI-COMM-LENGTH)
 17146*    END-EXEC.
 17147*    MOVE '*"     L              ''   #00014298' TO DFHEIV0
 17148     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
 17149     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17150     MOVE X'2020233030303134323938' TO DFHEIV0(25:11)
 17151     CALL 'kxdfhei1' USING DFHEIV0,
 17152           PI-KEY,
 17153           PROGRAM-INTERFACE-BLOCK,
 17154           PI-COMM-LENGTH,
 17155           DFHEIV99,
 17156           DFHEIV99,
 17157           DFHEIV99
 17158     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17159
 17160
 17161     MOVE XCTL-EL114             TO CALL-PGM.
 17162     GO TO 9200-XCTL.
 17163
 17164 8750-DMD-CLM-FIX.
 17165
 17166* EXEC CICS WRITEQ TS
 17167*         QUEUE     (PI-KEY)
 17168*         FROM      (PROGRAM-INTERFACE-BLOCK)
 17169*         LENGTH    (PI-COMM-LENGTH)
 17170*    END-EXEC.
 17171*    MOVE '*"     L              ''   #00014308' TO DFHEIV0
 17172     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
 17173     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17174     MOVE X'2020233030303134333038' TO DFHEIV0(25:11)
 17175     CALL 'kxdfhei1' USING DFHEIV0,
 17176           PI-KEY,
 17177           PROGRAM-INTERFACE-BLOCK,
 17178           PI-COMM-LENGTH,
 17179           DFHEIV99,
 17180           DFHEIV99,
 17181           DFHEIV99
 17182     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17183
 17184
 17185     MOVE XCTL-EL400DMD          TO CALL-PGM.
 17186     GO TO 9200-XCTL.
 17187
 17188 8800-UNAUTHORIZED-ACCESS.
 17189     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 17190     GO TO 8990-SEND-TEXT.
 17191
 17192 8810-PF23-ENTERED.
 17193     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 17194     MOVE XCTL-EL005             TO CALL-PGM.
 17195     GO TO 9200-XCTL.
 17196
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 324
* EL131.cbl
 17197 8820-XCTL-ERROR.
 17198
 17199* EXEC CICS HANDLE CONDITION
 17200*        PGMIDERR (8990-SEND-TEXT)
 17201*    END-EXEC.
 17202*    MOVE '"$L                   ! J #00014327' TO DFHEIV0
 17203     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 17204     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17205     MOVE X'4A20233030303134333237' TO DFHEIV0(25:11)
 17206     CALL 'kxdfhei1' USING DFHEIV0
 17207     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17208
 17209
 17210     MOVE SPACE                 TO PI-ENTRY-CD-1.
 17211     MOVE CALL-PGM              TO PI-CALLING-PROGRAM  LOGOFF-PGM
 17212     MOVE PGMIDERR-MSG          TO LOGOFF-FILL.
 17213     MOVE XCTL-EL005            TO CALL-PGM.
 17214     GO TO 9200-XCTL.
 17215
 17216 8990-SEND-TEXT.
 17217
 17218* EXEC CICS SEND TEXT
 17219*         FROM      (LOGOFF-TEXT)
 17220*         LENGTH    (LOGOFF-LENGTH)
 17221*         ERASE
 17222*         FREEKB
 17223*    END-EXEC.
 17224*    MOVE '8&      T  E F  H   F -   #00014338' TO DFHEIV0
 17225     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 17226     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 17227     MOVE X'2020233030303134333338' TO DFHEIV0(25:11)
 17228     CALL 'kxdfhei1' USING DFHEIV0,
 17229           LOGOFF-TEXT,
 17230           LOGOFF-LENGTH,
 17231           DFHEIV99,
 17232           DFHEIV99,
 17233           DFHEIV99,
 17234           DFHEIV99,
 17235           DFHEIV99,
 17236           DFHEIV99,
 17237           DFHEIV99,
 17238           DFHEIV99,
 17239           DFHEIV99,
 17240           DFHEIV99
 17241     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17242
 17243
 17244     GO TO 9100-RETURN-CICS.
 17245
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 325
* EL131.cbl
 17247 9000-RETURN-TRANS.
 17248
 17249* EXEC CICS RETURN
 17250*         TRANSID   (TRANS-ID)
 17251*         COMMAREA  (PROGRAM-INTERFACE-BLOCK)
 17252*         LENGTH    (PI-COMM-LENGTH)
 17253*    END-EXEC.
 17254*    MOVE '.(CT                  ''   #00014349' TO DFHEIV0
 17255     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 17256     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17257     MOVE X'2020233030303134333439' TO DFHEIV0(25:11)
 17258     CALL 'kxdfhei1' USING DFHEIV0,
 17259           TRANS-ID,
 17260           PROGRAM-INTERFACE-BLOCK,
 17261           PI-COMM-LENGTH,
 17262           DFHEIV99,
 17263           DFHEIV99,
 17264           DFHEIV99
 17265     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17266
 17267
 17268
 17269* GOBACK.
 17270     MOVE '9%                    "   ' TO DFHEIV0
 17271     MOVE 'EL131' TO DFHEIV1
 17272     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 17273     GOBACK.
 17274
 17275 9100-RETURN-CICS.
 17276
 17277* EXEC CICS RETURN
 17278*    END-EXEC.
 17279*    MOVE '.(                    ''   #00014358' TO DFHEIV0
 17280     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 17281     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17282     MOVE X'2020233030303134333538' TO DFHEIV0(25:11)
 17283     CALL 'kxdfhei1' USING DFHEIV0,
 17284           DFHEIV99,
 17285           DFHEIV99,
 17286           DFHEIV99,
 17287           DFHEIV99,
 17288           DFHEIV99,
 17289           DFHEIV99
 17290     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17291
 17292
 17293
 17294* GOBACK.
 17295     MOVE '9%                    "   ' TO DFHEIV0
 17296     MOVE 'EL131' TO DFHEIV1
 17297     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 17298     GOBACK.
 17299
 17300 9200-XCTL.
 17301
 17302* EXEC CICS XCTL
 17303*         PROGRAM    (CALL-PGM)
 17304*         COMMAREA   (PROGRAM-INTERFACE-BLOCK)
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 326
* EL131.cbl
 17305*         LENGTH     (PI-COMM-LENGTH)
 17306*    END-EXEC.
 17307*    MOVE '.$C                   %   #00014364' TO DFHEIV0
 17308     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 17309     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17310     MOVE X'2020233030303134333634' TO DFHEIV0(25:11)
 17311     CALL 'kxdfhei1' USING DFHEIV0,
 17312           CALL-PGM,
 17313           PROGRAM-INTERFACE-BLOCK,
 17314           PI-COMM-LENGTH,
 17315           DFHEIV99
 17316     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17317
 17318
 17319 9700-LINK-RTRM-FILE-ID.
 17320
 17321* EXEC CICS LINK
 17322*        PROGRAM  (RTRM-FILE-ID)
 17323*        COMMAREA (CALCULATION-PASS-AREA)
 17324*        LENGTH   (CP-COMM-LENGTH)
 17325*    END-EXEC.
 17326*    MOVE '."C                   (   #00014371' TO DFHEIV0
 17327     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17328     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17329     MOVE X'2020233030303134333731' TO DFHEIV0(25:11)
 17330     CALL 'kxdfhei1' USING DFHEIV0,
 17331           RTRM-FILE-ID,
 17332           CALCULATION-PASS-AREA,
 17333           CP-COMM-LENGTH,
 17334           DFHEIV99,
 17335           DFHEIV99,
 17336           DFHEIV99,
 17337           DFHEIV99
 17338     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17339
 17340
 17341 9700-EXIT.
 17342      EXIT.
 17343
 17344 9800-CONVERT-DATE.
 17345     MOVE SPACES TO DC-ERROR-CODE.
 17346
 17347* EXEC CICS LINK
 17348*         PROGRAM    (DATE-CONV)
 17349*         COMMAREA   (DATE-CONVERSION-DATA)
 17350*         LENGTH     (DC-COMM-LENGTH)
 17351*    END-EXEC.
 17352*    MOVE '."C                   (   #00014382' TO DFHEIV0
 17353     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17354     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17355     MOVE X'2020233030303134333832' TO DFHEIV0(25:11)
 17356     CALL 'kxdfhei1' USING DFHEIV0,
 17357           DATE-CONV,
 17358           DATE-CONVERSION-DATA,
 17359           DC-COMM-LENGTH,
 17360           DFHEIV99,
 17361           DFHEIV99,
 17362           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 327
* EL131.cbl
 17363           DFHEIV99
 17364     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17365
 17366
 17367 9800-EXIT.
 17368     EXIT.
 17369
 17370 9900-ERROR-FORMAT.
 17371
 17372* EXEC CICS LINK
 17373*         PROGRAM    (XCTL-EL001)
 17374*         COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 17375*         LENGTH     (EMI-COMM-LENGTH)
 17376*    END-EXEC.
 17377*    MOVE '."C                   (   #00014392' TO DFHEIV0
 17378     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17379     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17380     MOVE X'2020233030303134333932' TO DFHEIV0(25:11)
 17381     CALL 'kxdfhei1' USING DFHEIV0,
 17382           XCTL-EL001,
 17383           ERROR-MESSAGE-INTERFACE-BLOCK,
 17384           EMI-COMM-LENGTH,
 17385           DFHEIV99,
 17386           DFHEIV99,
 17387           DFHEIV99,
 17388           DFHEIV99
 17389     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17390
 17391
 17392 9900-EXIT.
 17393     EXIT.
 17394
 17395 9990-ABEND.
 17396     MOVE DFHEIBLK               TO EMI-LINE1.
 17397
 17398* EXEC CICS LINK
 17399*         PROGRAM   (XCTL-EL004)
 17400*         COMMAREA  (EMI-LINE1)
 17401*         LENGTH    (72)
 17402*     END-EXEC.
 17403     MOVE 72
 17404       TO DFHEIV11
 17405*    MOVE '."C                   (   #00014403' TO DFHEIV0
 17406     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17407     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17408     MOVE X'2020233030303134343033' TO DFHEIV0(25:11)
 17409     CALL 'kxdfhei1' USING DFHEIV0,
 17410           XCTL-EL004,
 17411           EMI-LINE1,
 17412           DFHEIV11,
 17413           DFHEIV99,
 17414           DFHEIV99,
 17415           DFHEIV99,
 17416           DFHEIV99
 17417     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17418
 17419
 17420     MOVE -1                     TO  MAINTL
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 328
* EL131.cbl
 17421
 17422     GO TO 8110-SEND-DATA.
 17423
 17424 9995-SECURITY-VIOLATION.
 17425*           COPY ELCSCTP.
 17426******************************************************************
 17427*                                                                *
 17428*                            ELCSCTP                             *
 17429*                            VMOD=2.001                          *
 17430*                                                                *
 17431*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 17432******************************************************************
 17433
 17434
 17435     MOVE EIBDATE          TO SM-JUL-DATE.
 17436     MOVE EIBTRMID         TO SM-TERMID.
 17437     MOVE THIS-PGM         TO SM-PGM.
 17438     MOVE EIBTIME          TO TIME-IN.
 17439     MOVE TIME-OUT         TO SM-TIME.
 17440     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 17441
 17442
 17443* EXEC CICS LINK
 17444*         PROGRAM  ('EL003')
 17445*         COMMAREA (SECURITY-MESSAGE)
 17446*         LENGTH   (80)
 17447*    END-EXEC.
 17448     MOVE 'EL003' TO DFHEIV1
 17449     MOVE 80
 17450       TO DFHEIV11
 17451*    MOVE '."C                   (   #00014431' TO DFHEIV0
 17452     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17453     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17454     MOVE X'2020233030303134343331' TO DFHEIV0(25:11)
 17455     CALL 'kxdfhei1' USING DFHEIV0,
 17456           DFHEIV1,
 17457           SECURITY-MESSAGE,
 17458           DFHEIV11,
 17459           DFHEIV99,
 17460           DFHEIV99,
 17461           DFHEIV99,
 17462           DFHEIV99
 17463     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17464
 17465
 17466******************************************************************
 17467
 17468
 17469
 17470 9999-DFHBACK SECTION.
 17471     MOVE '9%                    "   ' TO DFHEIV0
 17472     MOVE 'EL131' TO DFHEIV1
 17473     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 17474     GOBACK.
 17475 9999-DFHEXIT.
 17476     IF DFHEIGDJ EQUAL 0001
 17477         NEXT SENTENCE
 17478     ELSE IF DFHEIGDJ EQUAL 2
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 329
* EL131.cbl
 17479         GO TO 8820-XCTL-ERROR,
 17480               8150-ENTERED-CLAIM-NOTFOUND,
 17481               9990-ABEND
 17482         DEPENDING ON DFHEIGDI
 17483     ELSE IF DFHEIGDJ EQUAL 3
 17484         GO TO 0130-TS-ERROR,
 17485               0130-TS-ERROR
 17486         DEPENDING ON DFHEIGDI
 17487     ELSE IF DFHEIGDJ EQUAL 4
 17488         GO TO 0600-CONTINUE-NAME-UPDATE
 17489         DEPENDING ON DFHEIGDI
 17490     ELSE IF DFHEIGDJ EQUAL 5
 17491         GO TO 1004-BENE-NOT-FOUND
 17492         DEPENDING ON DFHEIGDI
 17493     ELSE IF DFHEIGDJ EQUAL 6
 17494         GO TO 1052-DONE,
 17495               1052-DONE
 17496         DEPENDING ON DFHEIGDI
 17497     ELSE IF DFHEIGDJ EQUAL 7
 17498         GO TO 1120-CNTL-NOTFND
 17499         DEPENDING ON DFHEIGDI
 17500     ELSE IF DFHEIGDJ EQUAL 8
 17501         GO TO 1150-NOTOPEN-ERROR,
 17502               1150-EXIT
 17503         DEPENDING ON DFHEIGDI
 17504     ELSE IF DFHEIGDJ EQUAL 9
 17505         GO TO 1490-STATE-NOTFND
 17506         DEPENDING ON DFHEIGDI
 17507     ELSE IF DFHEIGDJ EQUAL 10
 17508         GO TO 1500-CARR-NOTFND
 17509         DEPENDING ON DFHEIGDI
 17510     ELSE IF DFHEIGDJ EQUAL 11
 17511         GO TO 1620-ACCT-NOTFND
 17512         DEPENDING ON DFHEIGDI
 17513     ELSE IF DFHEIGDJ EQUAL 12
 17514         GO TO 2020-EXIT
 17515         DEPENDING ON DFHEIGDI
 17516     ELSE IF DFHEIGDJ EQUAL 13
 17517         GO TO 2030-EXIT
 17518         DEPENDING ON DFHEIGDI
 17519     ELSE IF DFHEIGDJ EQUAL 14
 17520         GO TO 2040-EXIT
 17521         DEPENDING ON DFHEIGDI
 17522     ELSE IF DFHEIGDJ EQUAL 15
 17523         GO TO 2050-EXIT
 17524         DEPENDING ON DFHEIGDI
 17525     ELSE IF DFHEIGDJ EQUAL 16
 17526         GO TO 2060-CERT-NOTFND
 17527         DEPENDING ON DFHEIGDI
 17528     ELSE IF DFHEIGDJ EQUAL 17
 17529         GO TO 2060-DUPKEY
 17530         DEPENDING ON DFHEIGDI
 17531     ELSE IF DFHEIGDJ EQUAL 18
 17532         GO TO 2070-NOT-FOUND
 17533         DEPENDING ON DFHEIGDI
 17534     ELSE IF DFHEIGDJ EQUAL 19
 17535         GO TO 2070-EXIT
 17536         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 330
* EL131.cbl
 17537     ELSE IF DFHEIGDJ EQUAL 20
 17538         GO TO 2080-EXIT
 17539         DEPENDING ON DFHEIGDI
 17540     ELSE IF DFHEIGDJ EQUAL 21
 17541         GO TO 2400-TRLR-NOTFND,
 17542               2410-EXIT
 17543         DEPENDING ON DFHEIGDI
 17544     ELSE IF DFHEIGDJ EQUAL 22
 17545         GO TO 2425-NINETY-NOTFND,
 17546               2425-NINETY-NOTFND
 17547         DEPENDING ON DFHEIGDI
 17548     ELSE IF DFHEIGDJ EQUAL 23
 17549         GO TO 2430-EXIT,
 17550               2440-EXIT
 17551         DEPENDING ON DFHEIGDI
 17552     ELSE IF DFHEIGDJ EQUAL 24
 17553         GO TO 2440-EXIT
 17554         DEPENDING ON DFHEIGDI
 17555     ELSE IF DFHEIGDJ EQUAL 25
 17556         GO TO 2460-EXIT
 17557         DEPENDING ON DFHEIGDI
 17558     ELSE IF DFHEIGDJ EQUAL 26
 17559         GO TO 2475-EXIT
 17560         DEPENDING ON DFHEIGDI
 17561     ELSE IF DFHEIGDJ EQUAL 27
 17562         GO TO 2650-EXIT
 17563         DEPENDING ON DFHEIGDI
 17564     ELSE IF DFHEIGDJ EQUAL 28
 17565         GO TO 2800-EXIT,
 17566               2800-EXIT
 17567         DEPENDING ON DFHEIGDI
 17568     ELSE IF DFHEIGDJ EQUAL 29
 17569         GO TO 3010-DEL-ACTQ,
 17570               3040-EXIT
 17571         DEPENDING ON DFHEIGDI
 17572     ELSE IF DFHEIGDJ EQUAL 30
 17573         GO TO 3010-NO-ACTIVITY,
 17574               3050-EXIT
 17575         DEPENDING ON DFHEIGDI
 17576     ELSE IF DFHEIGDJ EQUAL 31
 17577         GO TO 3010-CERT-NOT-FOUND
 17578         DEPENDING ON DFHEIGDI
 17579     ELSE IF DFHEIGDJ EQUAL 32
 17580         GO TO 3020-EXIT
 17581         DEPENDING ON DFHEIGDI
 17582     ELSE IF DFHEIGDJ EQUAL 33
 17583         GO TO 3060-EXIT,
 17584               3060-EXIT
 17585         DEPENDING ON DFHEIGDI
 17586     ELSE IF DFHEIGDJ EQUAL 34
 17587         GO TO 5000-TRLR-NOT-FOUND
 17588         DEPENDING ON DFHEIGDI
 17589     ELSE IF DFHEIGDJ EQUAL 35
 17590         GO TO 5000-CERT-NOT-FOUND
 17591         DEPENDING ON DFHEIGDI
 17592     ELSE IF DFHEIGDJ EQUAL 36
 17593         GO TO 1052-DONE,
 17594               1052-DONE
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:17 Page 331
* EL131.cbl
 17595         DEPENDING ON DFHEIGDI
 17596     ELSE IF DFHEIGDJ EQUAL 37
 17597         GO TO 7630-END-BROWSE
 17598         DEPENDING ON DFHEIGDI
 17599     ELSE IF DFHEIGDJ EQUAL 38
 17600         GO TO 7799-EXIT,
 17601               7799-EXIT
 17602         DEPENDING ON DFHEIGDI
 17603     ELSE IF DFHEIGDJ EQUAL 39
 17604         GO TO 7799-EXIT
 17605         DEPENDING ON DFHEIGDI
 17606     ELSE IF DFHEIGDJ EQUAL 40
 17607         GO TO 7800-NOT-FOUND
 17608         DEPENDING ON DFHEIGDI
 17609     ELSE IF DFHEIGDJ EQUAL 41
 17610         GO TO 8000-NOTE-NOT-FOUND
 17611         DEPENDING ON DFHEIGDI
 17612     ELSE IF DFHEIGDJ EQUAL 42
 17613         GO TO 8990-SEND-TEXT
 17614         DEPENDING ON DFHEIGDI.
 17615     MOVE '9%                    "   ' TO DFHEIV0
 17616     MOVE 'EL131' TO DFHEIV1
 17617     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 17618     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       14140     Code:       61124
