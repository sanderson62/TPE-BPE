* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page   1
* EL6318.cbl
* Options: int("EL6318.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL6318.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL6318.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL6318.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.                 EL6318.
     3*
     4*AUTHOR.        PABLO
     5*               OMAHA, NEBRASKA
     6*DATE-COMPILED.
     7*SECURITY.   *****************************************************
     8*            *                                                   *
     9*            *   THIS PROGRAM IS THE PROPERTY OF CNETRAL STATES  *
    10*            *   HEALTH AND LIFE                                 *
    11*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    12*            *   OF CSO.        IS EXPRESSLY PROHIBITED WITHOUT  *
    13*            *   THE PRIOR WRITTEN PERMISSION OF CENTRAL STATES. *
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page   2
* EL6318.cbl
    14*            *                                                   *
    15*            *****************************************************
    16*-----------------------------------------------------------------
    17*                   C H A N G E   L O G
    18*
    19* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    20*-----------------------------------------------------------------
    21*  CHANGE  CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    22* EFFECTIVE    NUMBER
    23*-----------------------------------------------------------------
    24*          2011022800001  PEMA  NEW PROGRAM
    25* 012412   2011022800001  AJRA  NAPERSOFT
    26* 060612   2011022800001  AJRA  NAPERSOFT
    27* 062712   2011022800001  AJRA  REDEFINE ORIG DATA
    28* 072312   2011022800001  AJRA  NAPERSOFT MISC
    29* 102212   2012101700002  AJRA  SCREEN ID
    30* 103012   2012101700002  AJRA  ADD CERT NOTES TO TOP OF LIST
    31* 110612   2012101700002  AJRA  ADD NEW FIELDS
    32* 112612   2012101700002  AJRA  CHECK FOR PROMPT LETTER
    33* 121012   2012101700002  AJRA  HIGHLIGHT REASON CODES
    34* 121112   2012101700002  AJRA  CHANGE PF1, PF2 TO PF3, PF4
    35* 121212   2012101700002  AJRA  CHG LAST 2 CERT NOTES TO BILLING N
    36*-----------------------------------------------------------------
    37*REMARKS.
    38*        TRANSACTION - EXBE - GENERAL CHANGE ENDORSEMENT
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page   3
* EL6318.cbl
    40 ENVIRONMENT DIVISION.
    41 DATA DIVISION.
    42 WORKING-STORAGE SECTION.
    43 01  DFH-START PIC X(04).
    44 77  FILLER  PIC X(32)  VALUE '********************************'.
    45 77  FILLER  PIC X(32)  VALUE '*    EL6318 WORKING STORAGE    *'.
    46 77  FILLER  PIC X(32)  VALUE '******** VMOD=2.001 ************'.
    47 77  NOTE-SUB PIC S9(5) COMP-3 VALUE +0.
    48 77  WS-SEQ-NO                   PIC 9(4) BINARY.
    49 77  WS-SET-CODES-MDT            PIC X  VALUE SPACES.
    50 77  s1                          pic s999 comp-3 value +0.
    51 77  s2                          pic s999 comp-3 value +0.
    52 77  W-ARCH-NUMBER               PIC S9(08)      COMP value +0.
    53 77  WS-ERACCT-SW                PIC X  VALUE ' '.
    54     88  ACCT-FOUND                 VALUE 'Y'.
    55 77  WS-CHGBACK                 PIC 99  VALUE ZEROS.
    56 77  WS-CSO-PORTION              PIC S9(5)V99 COMP-3 VALUE +0.
    57 77  WS-ACCT-PORTION             PIC S9(5)V99 COMP-3 VALUE +0.
    58 77  WS-DIFF                     PIC 99 VALUE ZEROS.
    59 77  WS-SAVE-ERACCT-KEY          PIC X(20)  VALUE SPACES.
    60 77  WS-DUE-BORROWER             PIC S9(7)V99 COMP-3 VALUE +0.
    61 77  WS-REASON-SW                PIC X  VALUE ' '.
    62     88  REASONS-FOUND                  VALUE 'Y'.
    63     88  REASONS-NOT-FOUND              VALUE 'N'.
    64 77  WS-CERT-UPDATE-SW           PIC X  VALUE ' '.
    65     88  NO-CERT-RW                 VALUE 'N'.
    66     88  CERT-RW                    VALUE 'Y'.
    67 01  P pointer.
    68 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
    69 01  KIXHOST             pic x(9) value Z"HOSTNAME".
    70 01  var-ptr pointer.
    71 01  env-var-len                 pic 9(4)  binary.
    72 01  rc                          pic 9(9)  binary.
    73 01  WS-KIXHOST                  PIC X(10).
    74 01  WS-KIXSYS.
    75     05  WS-KIX-FIL1             PIC X(10).
    76     05  WS-KIX-APPS             PIC X(10).
    77     05  WS-KIX-ENV              PIC X(10).
    78     05  WS-KIX-MYENV            PIC X(10).
    79     05  WS-KIX-SYS              PIC X(10).
    80*                                COPY ELCSCTM.
    81******************************************************************
    82*                                                                *
    83*                                                                *
    84*                            ELCSCTM                             *
    85*                            VMOD=2.001                          *
    86*                                                                *
    87*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    88*                                                                *
    89******************************************************************
    90 01  SECURITY-MESSAGE.
    91     12  FILLER                          PIC X(30)
    92            VALUE '** LOGIC SECURITY VIOLATION -'.
    93     12  SM-READ                         PIC X(6).
    94     12  FILLER                          PIC X(5)
    95            VALUE ' PGM='.
    96     12  SM-PGM                          PIC X(6).
    97     12  FILLER                          PIC X(5)
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page   4
* EL6318.cbl
    98            VALUE ' OPR='.
    99     12  SM-PROCESSOR-ID                 PIC X(4).
   100     12  FILLER                          PIC X(6)
   101            VALUE ' TERM='.
   102     12  SM-TERMID                       PIC X(4).
   103     12  FILLER                          PIC XX   VALUE SPACE.
   104     12  SM-JUL-DATE                     PIC 9(5).
   105     12  FILLER                          PIC X    VALUE SPACE.
   106     12  SM-TIME                         PIC 99.99.
   107
   108*                                COPY ELCSCRTY.
   109******************************************************************
   110*                                                                *
   111*                                                                *
   112*                            ELCSCRTY                            *
   113*                            VMOD=2.001                          *
   114*                                                                *
   115*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   116*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   117*        SAVED IN PI-SECURITY-ADDRESS.                           *
   118*                                                                *
   119******************************************************************
   120 01  SECURITY-CONTROL.
   121     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   122     12  FILLER                       PIC XX    VALUE 'SC'.
   123     12  SC-CREDIT-CODES.
   124         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   125             20  SC-CREDIT-DISPLAY    PIC X.
   126             20  SC-CREDIT-UPDATE     PIC X.
   127     12  SC-CLAIMS-CODES.
   128         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   129             20  SC-CLAIMS-DISPLAY    PIC X.
   130             20  SC-CLAIMS-UPDATE     PIC X.
   131 01 srch-commarea.
   132*                                copy ELCADLTRSPI.
   133******************************************************************
   134*                   C H A N G E   L O G
   135*
   136* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   137*-----------------------------------------------------------------
   138*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   139* EFFECTIVE    NUMBER
   140*-----------------------------------------------------------------
   141* 060611    2011022800001  PEMA  NEW COPYBOOK
   142* 101812    2012101700002  AJRA  ADD ENDT ARCHIVE NO, SCREENID
   143* 110612    2012101700002  AJRA  EXPAND PASSED DATA
   144******************************************************************
   145****************************************
   146*  commarea for NaperSoft On Demand Admin services letters
   147*  (business logic input & output)
   148****************************************
   149     03  BL-INPUT.
   150         05  BL-DATA-SRCE        PIC X.
   151         05  BL-LETTER-ID        PIC XXXX.
   152         05  BL-CARRIER          PIC X.
   153         05  BL-GROUP            PIC X(6).
   154         05  BL-STATE            PIC XX.
   155         05  BL-ACCOUNT          PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page   5
* EL6318.cbl
   156         05  BL-EFF-DT           PIC X(10).
   157         05  BL-CERT-NO          PIC X(11).
   158         05  BL-BATCH-NO         PIC X(6).
   159         05  BL-BATCH-SEQ        PIC 9(8).
   160         05  BL-RESP-NO          PIC X(10).
   161         05  BL-NO-OF-COPIES     PIC 99.
   162         05  BL-PROC-ID          PIC XXXX.
   163         05  BL-COMP-ID          PIC XXX.
   164         05  BL-PRINT-NOW-SW     PIC X.
   165         05  BL-ENC-CD           PIC XXX.
   166         05  BL-RESEND-DT        PIC X(10).
   167         05  BL-FOLLOW-UP-DT     PIC X(10).
   168         05  BL-ARCHIVE-NO       PIC 9(8).
   169         05  BL-FUNC             PIC X(8).
   170         05  BL-COMMENTS         PIC X(100).
   171         05  FILLER REDEFINES BL-COMMENTS.
   172             10  BL-REASON-CODE OCCURS 12 PIC X(4).
   173             10  BL-LETTER-TO-ACCT PIC X.
   174             10  BL-LETTER-TO-BENE PIC X.
   175             10  BL-WRITE-ERARCH   PIC X.
   176                 88  ERARCH-QWS      VALUE 'Q'.
   177                 88  ERARCH-BATCH    VALUE 'B'.
   178                 88  ERARCH-TEMP     VALUE 'T'.
   179             10  BL-PROCESS-TYPE PIC X(07).
   180             10  BL-CERT-FORM-ID PIC X(05).
   181             10  BL-ENDT-ARCH-NO PIC 9(08) BINARY.
   182             10  BL-SOURCE-SCREEN PIC X(8).
   183             10  FILLER          PIC X(25).
   184     03  BL-OUTPUT.
   185         05  BL-STATUS                   PIC X.
   186             88  BL-OK                      VALUE "P".
   187             88  BL-FAIL                  VALUE "F".
   188         05  BL-MESSAGE          PIC X(50).
   189     03  BL-RECORD-PASSED-DATA   PIC X(6200).
   190     03  FILLER                  PIC X(31).
   191
   192*** Z CONTROL LAYOUT MOVED TO COPYBOOK ELCZREC
   193*                                COPY ELCZREC.
   194******************************************************************
   195*                                                                *
   196*                                                                *
   197*                            ELCZREC.                            *
   198*                                                                *
   199*   FILE DESCRIPTION = Z CONTROL RECORD LAYOUT                   *
   200*                                                                *
   201******************************************************************
   202*-----------------------------------------------------------------
   203*                   C H A N G E   L O G
   204*
   205* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   206*-----------------------------------------------------------------
   207*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   208* EFFECTIVE    NUMBER
   209*-----------------------------------------------------------------
   210* 122011    2011022800001  AJRA  NEW FILE
   211* 073112    2011022800001  AJRA  ADD ACCT SUMM, CSO SUMM
   212*-----------------------------------------------------------------
   213 01  W-Z-CONTROL-DATA.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page   6
* EL6318.cbl
   214     05  W-NUMBER-OF-COPIES      PIC  9.
   215     05  FILLER                  PIC  X.
   216     05  W-DAYS-TO-FOLLOW-UP     PIC  999.
   217     05  FILLER                  PIC  X.
   218     05  W-DAYS-TO-RESEND        PIC  999.
   219     05  FILLER                  PIC  X.
   220     05  W-FORM-TO-RESEND        PIC  X(4).
   221     05  FILLER                  PIC  X.
   222     05  W-PROMPT-LETTER         PIC  X.
   223     05  FILLER                  PIC  X.
   224     05  W-ENCLOSURE-CD          PIC  XXX.
   225     05  FILLER                  PIC  X.
   226     05  W-AUTO-CLOSE-IND        PIC  X.
   227     05  FILLER                  PIC  X.
   228     05  W-LETTER-TO-BENE        PIC  X.
   229     05  FILLER                  PIC  X.
   230     05  W-LETTER-TO-ACCT        PIC  X.
   231     05  FILLER                  PIC  X.
   232     05  W-LETTER-TYPE           PIC  X.
   233     05  FILLER                  PIC  X.
   234     05  W-PRINT-CERTIFICATE     PIC  X.
   235     05  FILLER                  PIC  X.
   236     05  W-REFUND-REQUIRED       PIC  X.
   237     05  FILLER                  PIC  X.
   238     05  W-ONBASE-CODE           PIC  XX.
   239     05  FILLER                  PIC  X.
   240     05  W-ACCT-SUMM             PIC  X.
   241     05  FILLER                  PIC  X.
   242     05  W-CSO-SUMM              PIC  X.
   243     05  FILLER                  PIC  X(31).
   244 01  WS-PASSED-REASON-CODES      PIC X(60)  VALUE SPACES.
   245 01  STANDARD-AREAS.
   246     12  W-ARCH-SUPPRESS         PIC ZZZZZZZ9.
   247     12  W-ARCH-EDIT REDEFINES W-ARCH-SUPPRESS
   248                                 PIC  X(08).
   249     12  W-ARCH-LENGTH           PIC S9(04)  COMP  VALUE +250.
   250     12  QID.
   251         16  QID-TERM        PIC X(4)    VALUE SPACES.
   252         16  FILLER          PIC X(4)    VALUE '631K'.
   253     12  MAP-LENGTH          PIC 9(4)   VALUE 359 BINARY.
   254     12  TIME-MT                 PIC S9(7).
   255     12  TIME-MT-R  REDEFINES TIME-MT.
   256         16  FILLER              PIC X.
   257         16  TIME-LMT            PIC 99V99.
   258         16  FILLER              PIC X(2).
   259     12  GETMAIN-SPACE           PIC X VALUE SPACES.
   260     12  ERENDT-LENGTH           PIC S9(04) VALUE +579 COMP.
   261     12  ERPNDB-LENGTH           PIC 9(04)  VALUE 585 COMP.
   262     12  ERCNOT-LENGTH           PIC S9(04) VALUE +150 COMP.
   263     12  ERNOTE-LENGTH           PIC S9(04) VALUE +825 COMP.
   264     12  ELEOBC-LENGTH           PIC S9(04) VALUE +350 COMP.
   265     12  W-CNTL-KEY.
   266         16  W-CNTL-COMPANY-ID   PIC  X(03).
   267         16  W-CNTL-RECORD-TYPE  PIC  X(01)   VALUE '1'.
   268         16  W-CNTL-GENL.
   269             20  W-CNTL-GEN1     PIC  X(02)   VALUE SPACES.
   270             20  W-CNTL-GEN2.
   271                 24 W-CNTL-GEN3  PIC  X(01)   VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page   7
* EL6318.cbl
   272                 24 W-CNTL-GEN4  PIC  X(01)   VALUE SPACES.
   273         16  W-CNTL-SEQ-NO       PIC S9(04)   VALUE +0    COMP.
   274     12  WS-ELCERT-KEY.
   275         16  W-CERT-COMPANY-CD   PIC X.
   276         16  W-CERT-CARRIER      PIC X.
   277         16  W-CERT-GROUPING     PIC X(6).
   278         16  W-CERT-STATE        PIC XX.
   279         16  W-CERT-ACCOUNT      PIC X(10).
   280         16  W-CERT-CERT-EFF-DT  PIC XX.
   281         16  W-CERT-CERT-PRIME   PIC X(10).
   282         16  W-CERT-CERT-SFX     PIC X.
   283     12  WS-ELEOBC-KEY.
   284         16  WS-EOBC-COMPANY-CD  PIC X.
   285         16  WS-EOBC-REC-TYPE    PIC X.
   286         16  WS-EOBC-CODE        PIC X(4).
   287         16  FILLER              PIC X(9).
   288     12  WS-ERNOTE-KEY.
   289         16  W-NOTE-COMPANY-CD   PIC X.
   290         16  W-NOTE-CARRIER      PIC X.
   291         16  W-NOTE-GROUPING     PIC X(6).
   292         16  W-NOTE-STATE        PIC XX.
   293         16  W-NOTE-ACCOUNT      PIC X(10).
   294         16  W-NOTE-CERT-EFF-DT  PIC XX.
   295         16  W-NOTE-CERT-PRIME   PIC X(10).
   296         16  W-NOTE-CERT-SFX     PIC X.
   297     12  ELLETR-KEY.
   298         16  LETR-PART-KEY.
   299             20  LETR-COMPANY-CD PIC X.
   300             20  LETR-LETTER-ID  PIC X(4).
   301         16  LETR-FILLER         PIC X(8).
   302         16  LETR-SEQ-NO         PIC 9(4) BINARY.
   303     12  ELLETR-SAVE-PART-KEY    PIC X(5).
   304     12  ERPNDB2-KEY.
   305         16  PNDB2-COMPANY-CD    PIC X.
   306         16  PNDB2-CARRIER       PIC X.
   307         16  PNDB2-GROUPING      PIC X(6).
   308         16  PNDB2-STATE         PIC XX.
   309         16  PNDB2-ACCOUNT       PIC X(10).
   310         16  PNDB2-CERT-EFF-DT   PIC XX.
   311         16  PNDB2-CERT-PRIME    PIC X(10).
   312         16  PNDB2-CERT-SFX      PIC X.
   313         16  PNDB2-CHG-SEQ-NO    PIC 9(4) BINARY.
   314         16  PNDB2-RECORD-TYPE   PIC X.
   315     12  ERPNDB-KEY.
   316         16  PNDB-COMPANY-CD     PIC X.
   317         16  PNDB-BATCH-NO       PIC X(6).
   318         16  PNDB-BATCH-SEQ-NO   PIC 9(4) BINARY.
   319         16  PNDB-CHG-SEQ-NO     PIC 9(4) BINARY.
   320     12  ERENDT-KEY.
   321         16  ENDT-COMPANY-CD       PIC X.
   322         16  ENDT-CARRIER          PIC X.
   323         16  ENDT-GROUPING         PIC X(6).
   324         16  ENDT-STATE            PIC XX.
   325         16  ENDT-ACCOUNT          PIC X(10).
   326         16  ENDT-CERT-EFF-DT      PIC XX.
   327         16  ENDT-CERT-PRIME       PIC X(10).
   328         16  ENDT-CERT-SFX         PIC X.
   329         16  ENDT-RECORD-TYPE      PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page   8
* EL6318.cbl
   330         16  ENDT-SEQ-NO           PIC 9(4) BINARY.
   331     12  ELCRTO-KEY.
   332         16  CRTO-COMPANY-CD     PIC X.
   333         16  CRTO-CARRIER        PIC X.
   334         16  CRTO-GROUPING       PIC X(6).
   335         16  CRTO-STATE          PIC XX.
   336         16  CRTO-ACCOUNT        PIC X(10).
   337         16  CRTO-CERT-EFF-DT    PIC XX.
   338         16  CRTO-CERT-PRIME     PIC X(10).
   339         16  CRTO-CERT-SFX       PIC X.
   340         16  CRTO-RECORD-TYPE    PIC X.
   341         16  CRTO-SEQ-NO         PIC 9(4) BINARY.
   342     12  WS-ERMAIL-KEY.
   343         16  MAIL-COMPANY-CD     PIC X.
   344         16  MAIL-CARRIER        PIC X.
   345         16  MAIL-GROUPING       PIC X(6).
   346         16  MAIL-STATE          PIC XX.
   347         16  MAIL-ACCOUNT        PIC X(10).
   348         16  MAIL-CERT-EFF-DT    PIC XX.
   349         16  MAIL-CERT-PRIME     PIC X(10).
   350         16  MAIL-CERT-SFX       PIC X.
   351     12  WS-LF-CANC-DT           PIC XX   VALUE LOW-VALUES.
   352     12  WS-AH-CANC-DT           PIC XX   VALUE LOW-VALUES.
   353     12  WS-CURRENT-DT.
   354         16  FILLER              PIC X(6)    VALUE SPACES.
   355         16  WS-CURRENT-YR       PIC XX      VALUE SPACES.
   356     12  WS-CURRENT-BIN-DT       PIC XX    VALUE LOW-VALUES.
   357     12  WS-ISS-CAN-SW           PIC X     VALUE LOW-VALUES.
   358         88  CANCEL-REC            VALUE 'C'.
   359         88  ISSUE-REC             VALUE 'I'.
   360     12  WS-WORK-AMT             PIC S9(9)V99 COMP-3 VALUE +0.
   361     12  WS-HOLD-ACCT-KEY        PIC X(26) VALUE LOW-VALUES.
   362     12  ELCNTL-KEY.
   363         16  CNTL-COMP-ID        PIC X(3)  VALUE SPACES.
   364         16  CNTL-REC-TYPE       PIC X     VALUE SPACES.
   365         16  CNTL-ACCESS.
   366             20  CNTL-STATE      PIC XX    VALUE SPACES.
   367             20  FILLER          PIC X     VALUE SPACES.
   368             20  CNTL-CARRIER    PIC X     VALUE SPACES.
   369         16  CNTL-SEQ            PIC S9(4) VALUE +0 COMP.
   370     12  WS-ERACCT-KEY.
   371         16  ACCT-COMPANY-CD     PIC X.
   372         16  ACCT-CARRIER        PIC X.
   373         16  ACCT-GROUPING       PIC X(6).
   374         16  ACCT-STATE          PIC XX.
   375         16  ACCT-ACCOUNT        PIC X(10).
   376         16  ACCT-EXP-DATE       PIC XX    VALUE SPACES.
   377         16  FILLER              PIC X(4)  VALUE LOW-VALUES.
   378     12  ERACCT-SAVE-KEY         PIC X(20) VALUE SPACES.
   379     12  WS-ELCERT-FILE-ID       PIC X(8) VALUE 'ELCERT'.
   380     12  WS-ELCNTL-FILE-ID       PIC X(8) VALUE 'ELCNTL'.
   381     12  WS-ERNOTE-FILE-ID       PIC X(8) VALUE 'ERNOTE'.
   382     12  WS-ELCRTO-FILE-ID       PIC X(8) VALUE 'ELCRTO'.
   383     12  WS-ERENDT-FILE-ID       PIC X(8) VALUE 'ERENDT'.
   384     12  WS-ERPNDB2-FILE-ID      PIC X(8) VALUE 'ERPNDB2'.
   385     12  WS-ERPNDB-FILE-ID       PIC X(8) VALUE 'ERPNDB'.
   386     12  WS-ERACCT2-FILE-ID      PIC X(8) VALUE 'ERACCT2'.
   387     12  WS-ERCNOT-FILE-ID       PIC X(8) VALUE 'ERCNOT'.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page   9
* EL6318.cbl
   388     12  WS-ELEOBC-FILE-ID       PIC X(8) VALUE 'ELEOBC'.
   389     12  WS-RESPONSE             PIC S9(8)   COMP.
   390         88  RESP-NORMAL                  VALUE +00.
   391         88  RESP-NOTFND                  VALUE +13.
   392         88  RESP-DUPREC                  VALUE +14.
   393         88  RESP-DUPKEY                  VALUE +15.
   394         88  RESP-NOTOPEN                 VALUE +19.
   395         88  RESP-ENDFILE                 VALUE +20.
   396     12  MAP-NAME            PIC X(8)    VALUE 'EL631K'.
   397     12  MAPSET-NAME         PIC X(8)    VALUE 'EL6318S'.
   398     12  SCREEN-NUMBER       PIC X(4)    VALUE '631K'.
   399     12  TRANS-ID            PIC X(4)    VALUE 'EXBE'.
   400     12  THIS-PGM            PIC X(8)    VALUE 'EL6318'.
   401     12  PGM-NAME            PIC X(8).
   402     12  TIME-IN             PIC S9(7).
   403     12  TIME-OUT-R  REDEFINES TIME-IN.
   404         16  FILLER          PIC X.
   405         16  TIME-OUT        PIC 99V99.
   406         16  FILLER          PIC X(2).
   407     12  XCTL-005            PIC X(8)    VALUE 'EL005'.
   408     12  XCTL-010            PIC X(8)    VALUE 'EL010'.
   409     12  XCTL-626            PIC X(8)    VALUE 'EL626'.
   410     12  XCTL-6311           PIC X(8)    VALUE 'EL6311'.
   411     12  LINK-001            PIC X(8)    VALUE 'EL001'.
   412     12  LINK-004            PIC X(8)    VALUE 'EL004'.
   413     12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
   414     12  WS-PHONE.
   415         16  WS-PH1              PIC XXX.
   416         16  WS-PH2              PIC XXX.
   417         16  WS-PH3              PIC XXXX.
   418     12  WS-PHONE-NUM REDEFINES WS-PHONE PIC 9(10).
   419     12  WS-DEV-RT               PIC S9V9(6) COMP-3.
   420
   421     12  WS-BILLING-NOTE.
   422         16  WS-BN-NOTE          PIC X(25).
   423         16  WS-BN-LTRID         PIC X(4).
   424         16  FILLER              PIC X(3).
   425         16  WS-BN-DATE          PIC X(8).
   426         16  FILLER              PIC X(3).
   427         16  WS-BN-USERID        PIC X(4).
   428         16  FILLER              PIC X(30).
   429     12  WS-MANUAL-BILL-NOTE REDEFINES WS-BILLING-NOTE.
   430         16  WS-MAN-BN-NOTE      PIC X(63).
   431         16  FILLER              PIC X(14).
   432     12  WS-LEN                  PIC S9(5) COMP-3 VALUE +0.
   433
   434     12  WS-SAVE-REASON-CODE-IND PIC X(26).
   435
   436 01  NEW-ELCRTO-REC.
   437     12  NEW-ELCRTO-KEY.
   438         16  NCRTO-COMPANY-CD      PIC X.
   439         16  NCRTO-CARRIER         PIC X.
   440         16  NCRTO-GROUPING        PIC X(6).
   441         16  NCRTO-STATE           PIC XX.
   442         16  NCRTO-ACCOUNT         PIC X(10).
   443         16  NCRTO-CERT-EFF-DT     PIC XX.
   444         16  NCRTO-CERT-PRIME      PIC X(10).
   445         16  NCRTO-CERT-SFX        PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  10
* EL6318.cbl
   446         16  NCRTO-RECORD-TYPE     PIC X.
   447         16  NCRTO-SEQ-NO          PIC 9(4) BINARY.
   448     12  NEW-ORIG-REC.
   449         16  NCRTO-INS-LAST-NAME   PIC X(15).
   450         16  NCRTO-INS-FIRST-NAME  PIC X(10).
   451         16  NCRTO-INS-MIDDLE-INIT PIC X.
   452         16  NCRTO-INS-AGE         PIC S999     COMP-3.
   453         16  NCRTO-JNT-LAST-NAME   PIC X(15).
   454         16  NCRTO-JNT-FIRST-NAME  PIC X(10).
   455         16  NCRTO-JNT-MIDDLE-INIT PIC X.
   456         16  NCRTO-JNT-AGE         PIC S999     COMP-3.
   457         16  NCRTO-LF-BENCD        PIC XX.
   458         16  NCRTO-LF-TERM         PIC S999      COMP-3.
   459         16  NCRTO-LF-BEN-AMT      PIC S9(9)V99  COMP-3.
   460         16  NCRTO-LF-PRM-AMT      PIC S9(7)V99  COMP-3.
   461         16  NCRTO-LF-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
   462         16  NCRTO-LF-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
   463         16  NCRTO-LF-EXP-DT       PIC XX.
   464         16  NCRTO-LF-COMM-PCT     PIC SV9(5)    COMP-3.
   465         16  NCRTO-LF-CANCEL-DT    PIC XX.
   466         16  NCRTO-LF-CANCEL-AMT   PIC S9(7)V99  COMP-3.
   467         16  NCRTO-LF-ITD-CANCEL-AMT PIC S9(7)V99 COMP-3.
   468         16  NCRTO-AH-BENCD        PIC XX.
   469         16  NCRTO-AH-TERM         PIC S999      COMP-3.
   470         16  NCRTO-AH-BEN-AMT      PIC S9(9)V99  COMP-3.
   471         16  NCRTO-AH-PRM-AMT      PIC S9(7)V99  COMP-3.
   472         16  NCRTO-AH-EXP-DT       PIC XX.
   473         16  NCRTO-AH-COMM-PCT     PIC SV9(5)    COMP-3.
   474         16  NCRTO-AH-CP           PIC 99.
   475         16  NCRTO-AH-CANCEL-DT    PIC XX.
   476         16  NCRTO-AH-CANCEL-AMT   PIC S9(7)V99  COMP-3.
   477         16  NCRTO-AH-ITD-CANCEL-AMT PIC S9(7)V99 COMP-3.
   478         16  NCRTO-CRED-BENE-NAME  PIC X(25).
   479         16  NCRTO-1ST-PMT-DT      PIC XX.
   480         16  FILLER                PIC X(239).
   481
   482 01  CERT-NOTE-ENTRIES.
   483     12  CERT-NT OCCURS 300 TIMES INDEXED BY TB-INDX TB-INDX1.
   484         16  CERT-NT-TEXT                PIC X(63).
   485         16  CERT-NT-LAST-MAINT-BY       PIC XXXX.
   486         16  CERT-NT-LAST-MAINT-DT       PIC XX.
   487         16  CERT-NT-LAST-MAINT-HHMMSS   PIC S9(7) COMP-3.
   488
   489 01  ERCNOT-AREA.
   490     12  ERCNOT-KEY-LENGTH       PIC S9(4)   COMP VALUE +36.
   491     12  ERCNOT-START-LENGTH     PIC S9(4)   COMP VALUE +34.
   492     12  ERCNOT-KEY.
   493         16  ERCNOT-PARTIAL-KEY.
   494             20 ERCNOT-COMPANY-CD    PIC X.
   495             20 ERCNOT-CARRIER       PIC X.
   496             20 ERCNOT-GROUPING      PIC X(06).
   497             20 ERCNOT-STATE         PIC XX.
   498             20 ERCNOT-ACCOUNT       PIC X(10).
   499             20 ERCNOT-EFF-DT        PIC XX.
   500             20 ERCNOT-CERT-NO.
   501                25 ERCNOT-CERT-PRIME PIC X(10).
   502                25 ERCNOT-CERT-SFX   PIC X.
   503             20 ERCNOT-REC-TYP       PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  11
* EL6318.cbl
   504         16 ERCNOT-SEQ           PIC S9(4) COMP.
   505     12  SV-PARTIAL-KEY.
   506         20 SV-COMPANY-CD            PIC X.
   507         20 SV-CARRIER               PIC X.
   508         20 SV-GROUPING              PIC X(06).
   509         20 SV-STATE                 PIC XX.
   510         20 SV-ACCOUNT               PIC X(10).
   511         20 SV-EFF-DT                PIC XX.
   512         20 SV-CERT-NO.
   513            25 SV-CERT-PRIME         PIC X(10).
   514            25 SV-CERT-SFX           PIC X(1).
   515         20 SV-REC-TYP               PIC X.
   516 01  ERROR-MESSAGES.
   517     12  ER-0000                 PIC X(4)  VALUE '0000'.
   518     12  ER-0004                 PIC X(4)  VALUE '0004'.
   519     12  ER-0008                 PIC X(4)  VALUE '0008'.
   520     12  ER-0023                 PIC X(4)  VALUE '0023'.
   521     12  ER-0029                 PIC X(4)  VALUE '0029'.
   522     12  ER-0068                 PIC X(4)  VALUE '0068'.
   523     12  ER-0132                 PIC X(4)  VALUE '0132'.
   524     12  ER-0142                 PIC X(4)  VALUE '0142'.
   525     12  ER-0148                 PIC X(4)  VALUE '0148'.
   526     12  ER-0215                 PIC X(4)  VALUE '0215'.
   527     12  ER-0280                 PIC X(4)  VALUE '0280'.
   528     12  ER-0348                 PIC X(4)  VALUE '0348'.
   529     12  ER-0419                 PIC X(4)  VALUE '0419'.
   530     12  ER-0715                 PIC X(4)  VALUE '0715'.
   531     12  ER-0894                 PIC X(4)  VALUE '0894'.
   532     12  ER-1101                 PIC X(4)  VALUE '1101'.
   533     12  ER-1236                 PIC X(4)  VALUE '1236'.
   534     12  ER-1778                 PIC X(4)  VALUE '1778'.
   535     12  ER-1818                 PIC X(4)  VALUE '1818'.
   536     12  ER-1820                 PIC X(4)  VALUE '1820'.
   537     12  ER-1821                 PIC X(4)  VALUE '1821'.
   538     12  ER-2056                 PIC X(4)  VALUE '2056'.
   539     12  ER-2079                 PIC X(4)  VALUE '2079'.
   540     12  ER-2208                 PIC X(4)  VALUE '2208'.
   541     12  ER-2209                 PIC X(4)  VALUE '2209'.
   542     12  ER-2237                 PIC X(4)  VALUE '2237'.
   543     12  ER-2238                 PIC X(4)  VALUE '2238'.
   544     12  ER-2253                 PIC X(4)  VALUE '2253'.
   545     12  ER-2619                 PIC X(4)  VALUE '2619'.
   546     12  ER-2651                 PIC X(4)  VALUE '2651'.
   547     12  ER-2784                 PIC X(4)  VALUE '2784'.
   548     12  ER-2785                 PIC X(4)  VALUE '2785'.
   549     12  ER-2786                 PIC X(4)  VALUE '2786'.
   550     12  ER-2791                 PIC X(4)  VALUE '2791'.
   551     12  ER-2845                 PIC X(4)  VALUE '2845'.
   552     12  ER-2848                 PIC X(4)  VALUE '2848'.
   553     12  ER-2851                 PIC X(4)  VALUE '2851'.
   554     12  ER-3830                 PIC X(4)  VALUE '3830'.
   555     12  ER-3833                 PIC X(4)  VALUE '3833'.
   556     12  ER-7345                 PIC X(4)  VALUE '7345'.
   557     12  ER-7638                 PIC X(4)  VALUE '7638'.
   558     12  ER-8888                 PIC X(4)  VALUE '8888'.
   559     12  ER-9999                 PIC X(4)  VALUE '9999'.
   560*    COPY ELCDATE.
   561******************************************************************
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  12
* EL6318.cbl
   562*                                                                *
   563*                                                                *
   564*                            ELCDATE.                            *
   565*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   566*                            VMOD=2.003
   567*                                                                *
   568*                                                                *
   569*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   570*                 LENGTH = 200                                   *
   571******************************************************************
   572
   573 01  DATE-CONVERSION-DATA.
   574     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   575     12  DC-OPTION-CODE                PIC X.
   576         88  BIN-TO-GREG                VALUE ' '.
   577         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   578         88  EDIT-GREG-TO-BIN           VALUE '2'.
   579         88  YMD-GREG-TO-BIN            VALUE '3'.
   580         88  MDY-GREG-TO-BIN            VALUE '4'.
   581         88  JULIAN-TO-BIN              VALUE '5'.
   582         88  BIN-PLUS-ELAPSED           VALUE '6'.
   583         88  FIND-CENTURY               VALUE '7'.
   584         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   585         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   586         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   587         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   588         88  JULIAN-TO-BIN-3            VALUE 'C'.
   589         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   590         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   591         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   592         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   593         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   594         88  CHECK-LEAP-YEAR            VALUE 'H'.
   595         88  BIN-3-TO-GREG              VALUE 'I'.
   596         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   597         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   598         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   599         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   600         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   601         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   602         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   603         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   604         88  THREE-CHARACTER-BIN
   605                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   606         88  GREGORIAN-TO-BIN
   607                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   608         88  BIN-TO-GREGORIAN
   609                  VALUES ' ' '1' 'I' '8' 'G'.
   610         88  JULIAN-TO-BINARY
   611                  VALUES '5' 'C' 'E' 'F'.
   612     12  DC-ERROR-CODE                 PIC X.
   613         88  NO-CONVERSION-ERROR        VALUE ' '.
   614         88  DATE-CONVERSION-ERROR
   615                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   616         88  DATE-IS-ZERO               VALUE '1'.
   617         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   618         88  DATE-IS-INVALID            VALUE '3'.
   619         88  DATE1-GREATER-DATE2        VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  13
* EL6318.cbl
   620         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   621         88  DATE-INVALID-OPTION        VALUE '9'.
   622         88  INVALID-CENTURY            VALUE 'A'.
   623         88  ONLY-CENTURY               VALUE 'B'.
   624         88  ONLY-LEAP-YEAR             VALUE 'C'.
   625         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   626     12  DC-END-OF-MONTH               PIC X.
   627         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   628     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   629         88  USE-NORMAL-PROCESS         VALUE ' '.
   630         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   631         88  ADJUST-UP-100-YRS          VALUE '2'.
   632     12  FILLER                        PIC X.
   633     12  DC-CONVERSION-DATES.
   634         16  DC-BIN-DATE-1             PIC XX.
   635         16  DC-BIN-DATE-2             PIC XX.
   636         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   637         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   638                       DC-GREG-DATE-1-EDIT.
   639             20  DC-EDIT1-MONTH        PIC 99.
   640             20  SLASH1-1              PIC X.
   641             20  DC-EDIT1-DAY          PIC 99.
   642             20  SLASH1-2              PIC X.
   643             20  DC-EDIT1-YEAR         PIC 99.
   644         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   645         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   646                     DC-GREG-DATE-2-EDIT.
   647             20  DC-EDIT2-MONTH        PIC 99.
   648             20  SLASH2-1              PIC X.
   649             20  DC-EDIT2-DAY          PIC 99.
   650             20  SLASH2-2              PIC X.
   651             20  DC-EDIT2-YEAR         PIC 99.
   652         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   653         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   654                     DC-GREG-DATE-1-YMD.
   655             20  DC-YMD-YEAR           PIC 99.
   656             20  DC-YMD-MONTH          PIC 99.
   657             20  DC-YMD-DAY            PIC 99.
   658         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   659         16  DC-GREG-DATE-1-MDY-R REDEFINES
   660                      DC-GREG-DATE-1-MDY.
   661             20  DC-MDY-MONTH          PIC 99.
   662             20  DC-MDY-DAY            PIC 99.
   663             20  DC-MDY-YEAR           PIC 99.
   664         16  DC-GREG-DATE-1-ALPHA.
   665             20  DC-ALPHA-MONTH        PIC X(10).
   666             20  DC-ALPHA-DAY          PIC 99.
   667             20  FILLER                PIC XX.
   668             20  DC-ALPHA-CENTURY.
   669                 24 DC-ALPHA-CEN-N     PIC 99.
   670             20  DC-ALPHA-YEAR         PIC 99.
   671         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   672         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   673         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   674         16  DC-JULIAN-DATE            PIC 9(05).
   675         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   676                                       PIC 9(05).
   677         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  14
* EL6318.cbl
   678             20  DC-JULIAN-YEAR        PIC 99.
   679             20  DC-JULIAN-DAYS        PIC 999.
   680         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   681         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   682         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   683     12  DATE-CONVERSION-VARIBLES.
   684         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   685         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   686             20  FILLER                PIC 9(3).
   687             20  HOLD-CEN-1-CCYY.
   688                 24  HOLD-CEN-1-CC     PIC 99.
   689                 24  HOLD-CEN-1-YY     PIC 99.
   690             20  HOLD-CEN-1-MO         PIC 99.
   691             20  HOLD-CEN-1-DA         PIC 99.
   692         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   693             20  HOLD-CEN-1-R-MO       PIC 99.
   694             20  HOLD-CEN-1-R-DA       PIC 99.
   695             20  HOLD-CEN-1-R-CCYY.
   696                 24  HOLD-CEN-1-R-CC   PIC 99.
   697                 24  HOLD-CEN-1-R-YY   PIC 99.
   698             20  FILLER                PIC 9(3).
   699         16  HOLD-CENTURY-1-X.
   700             20  FILLER                PIC X(3)  VALUE SPACES.
   701             20  HOLD-CEN-1-X-CCYY.
   702                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   703                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   704             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   705             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   706         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   707             20  HOLD-CEN-1-R-X-MO     PIC XX.
   708             20  HOLD-CEN-1-R-X-DA     PIC XX.
   709             20  HOLD-CEN-1-R-X-CCYY.
   710                 24  HOLD-CEN-1-R-X-CC PIC XX.
   711                 24  HOLD-CEN-1-R-X-YY PIC XX.
   712             20  FILLER                PIC XXX.
   713         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   714         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   715         16  DC-JULIAN-DATE-1          PIC 9(07).
   716         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   717             20  DC-JULIAN-1-CCYY.
   718                 24  DC-JULIAN-1-CC    PIC 99.
   719                 24  DC-JULIAN-1-YR    PIC 99.
   720             20  DC-JULIAN-DA-1        PIC 999.
   721         16  DC-JULIAN-DATE-2          PIC 9(07).
   722         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   723             20  DC-JULIAN-2-CCYY.
   724                 24  DC-JULIAN-2-CC    PIC 99.
   725                 24  DC-JULIAN-2-YR    PIC 99.
   726             20  DC-JULIAN-DA-2        PIC 999.
   727         16  DC-GREG-DATE-A-EDIT.
   728             20  DC-EDITA-MONTH        PIC 99.
   729             20  SLASHA-1              PIC X VALUE '/'.
   730             20  DC-EDITA-DAY          PIC 99.
   731             20  SLASHA-2              PIC X VALUE '/'.
   732             20  DC-EDITA-CCYY.
   733                 24  DC-EDITA-CENT     PIC 99.
   734                 24  DC-EDITA-YEAR     PIC 99.
   735         16  DC-GREG-DATE-B-EDIT.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  15
* EL6318.cbl
   736             20  DC-EDITB-MONTH        PIC 99.
   737             20  SLASHB-1              PIC X VALUE '/'.
   738             20  DC-EDITB-DAY          PIC 99.
   739             20  SLASHB-2              PIC X VALUE '/'.
   740             20  DC-EDITB-CCYY.
   741                 24  DC-EDITB-CENT     PIC 99.
   742                 24  DC-EDITB-YEAR     PIC 99.
   743         16  DC-GREG-DATE-CYMD         PIC 9(08).
   744         16  DC-GREG-DATE-CYMD-R REDEFINES
   745                              DC-GREG-DATE-CYMD.
   746             20  DC-CYMD-CEN           PIC 99.
   747             20  DC-CYMD-YEAR          PIC 99.
   748             20  DC-CYMD-MONTH         PIC 99.
   749             20  DC-CYMD-DAY           PIC 99.
   750         16  DC-GREG-DATE-MDCY         PIC 9(08).
   751         16  DC-GREG-DATE-MDCY-R REDEFINES
   752                              DC-GREG-DATE-MDCY.
   753             20  DC-MDCY-MONTH         PIC 99.
   754             20  DC-MDCY-DAY           PIC 99.
   755             20  DC-MDCY-CEN           PIC 99.
   756             20  DC-MDCY-YEAR          PIC 99.
   757    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   758        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   759    12  DC-EL310-DATE                  PIC X(21).
   760    12  FILLER                         PIC X(28).
   761*    COPY ELCTEXT.
   762******************************************************************
   763*                                                                *
   764*                                                                *
   765*                            ELCTEXT.                            *
   766*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   767*                            VMOD=2.008                          *
   768*                                                                *
   769*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
   770*                                     FORM LETTERS,              *
   771*                                     CERT FORM DISPLAY.
   772*                                                                *
   773*   FILE TYPE = VSAM,KSDS                                        *
   774*   RECORD SIZE = 100   RECFORM = FIXED                          *
   775*                                                                *
   776*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
   777*       ALTERNATE INDEX = NONE                                   *
   778*                                                                *
   779*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
   780*       ALTERNATE INDEX = NONE                                   *
   781*                                                                *
   782*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
   783*       ALTERNATE INDEX = NONE                                   *
   784*                                                                *
   785*   LOG = NO                                                     *
   786*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   787******************************************************************
   788 01  TEXT-FILES.
   789     12  TEXT-FILE-ID                PIC XX.
   790         88  FORMS-FILE-TEXT            VALUE 'TF'.
   791         88  LETTER-FILE-TEXT           VALUE 'TL'.
   792         88  HELP-FILE-TEXT             VALUE 'TH'.
   793
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  16
* EL6318.cbl
   794     12  TX-CONTROL-PRIMARY.
   795         16  TX-COMPANY-CD           PIC X.
   796             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
   797         16  TX-ACCESS-CD-GENL       PIC X(12).
   798
   799         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
   800             20  TX-LETTER-NO        PIC X(4).
   801             20  FILLER              PIC X(8).
   802
   803         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
   804             20  TX-FORM-NO          PIC X(12).
   805
   806         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
   807             20  TX-HELP-TYPE        PIC X.
   808                 88  HELP-FOR-GENERAL   VALUE ' '.
   809                 88  HELP-BY-SCREEN     VALUE 'S'.
   810                 88  HELP-BY-ERROR      VALUE 'E'.
   811             20  TX-SCREEN-OR-ERROR  PIC X(4).
   812                 88  GENERAL-INFO-HELP  VALUE '0000'.
   813             20  TX-HELP-FOR-COMPANY  PIC XXX.
   814                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
   815             20  FILLER              PIC X(4).
   816
   817         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
   818
   819     12  TX-PROCESS-CONTROL          PIC XX.
   820         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
   821
   822     12  TX-TEXT-LINE                PIC X(70).
   823
   824     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
   825         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
   826         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
   827         88  TX-VALID-FORM-SQUEEZE-VALUE
   828                                        VALUE 'Y' ' '.
   829
   830     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
   831         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
   832         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
   833         88  TX-DO-NOT-ADJUST           VALUE 'N'.
   834         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
   835         88  TX-NEW-PARAGRAPH           VALUE 'P'.
   836         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
   837         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
   838                                              'K' 'N' ' '
   839                                              'Z'.
   840
   841     12  TX-ARCHIVE-SW               PIC X.
   842         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
   843         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
   844         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
   845
   846     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
   847     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
   848
   849     12  TX-BSR-CODE                 PIC X.
   850         88  TX-BSR-LETTER              VALUE 'B'.
   851         88  TX-NON-BSR-LETTER          VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  17
* EL6318.cbl
   852
   853     12  FILLER                      PIC X.
   854*****************************************************************
   855*    COPY ELCLOGOF.
   856******************************************************************
   857*                                                                *
   858*                                                                *
   859*                            ELCLOGOF.                           *
   860*                            VMOD=2.001                          *
   861*                                                                *
   862*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   863*                                                                *
   864******************************************************************
   865 01  CLASIC-LOGOFF.
   866     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   867     12  LOGOFF-TEXT.
   868         16  FILLER          PIC X(5)    VALUE SPACES.
   869         16  LOGOFF-MSG.
   870             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   871             20  FILLER      PIC X       VALUE SPACES.
   872             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   873         16  FILLER          PIC X(80)
   874           VALUE '* YOU ARE NOW LOGGED OFF'.
   875         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   876         16  FILLER          PIC X       VALUE QUOTE.
   877         16  LOGOFF-SYS-MSG  PIC X(17)
   878           VALUE 'S CLAS-IC SYSTEM '.
   879     12  TEXT-MESSAGES.
   880         16  UNACCESS-MSG    PIC X(29)
   881             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   882         16  PGMIDERR-MSG    PIC X(17)
   883             VALUE 'PROGRAM NOT FOUND'.
   884*    COPY ELCATTR.
   885******************************************************************
   886*                                                                *
   887*                            ELCATTR.                            *
   888*                            VMOD=2.001                          *
   889*                                                                *
   890*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   891*                                                                *
   892*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   893*                                                                *
   894*                   POS 1   P=PROTECTED                          *
   895*                           U=UNPROTECTED                        *
   896*                           S=ASKIP                              *
   897*                   POS 2   A=ALPHA/NUMERIC                      *
   898*                           N=NUMERIC                            *
   899*                   POS 3   N=NORMAL                             *
   900*                           B=BRIGHT                             *
   901*                           D=DARK                               *
   902*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   903*                           OF=MODIFIED DATA TAG OFF             *
   904*                                                                *
   905*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   906******************************************************************
   907 01  ATTRIBUTE-LIST.
   908     12  AL-PABOF            PIC X       VALUE 'Y'.
   909     12  AL-PABON            PIC X       VALUE 'Z'.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  18
* EL6318.cbl
   910     12  AL-PADOF            PIC X       VALUE '%'.
   911     12  AL-PADON            PIC X       VALUE '_'.
   912     12  AL-PANOF            PIC X       VALUE '-'.
   913     12  AL-PANON            PIC X       VALUE '/'.
   914     12  AL-SABOF            PIC X       VALUE '8'.
   915     12  AL-SABON            PIC X       VALUE '9'.
   916     12  AL-SADOF            PIC X       VALUE '@'.
   917     12  AL-SADON            PIC X       VALUE QUOTE.
   918     12  AL-SANOF            PIC X       VALUE '0'.
   919     12  AL-SANON            PIC X       VALUE '1'.
   920     12  AL-UABOF            PIC X       VALUE 'H'.
   921     12  AL-UABON            PIC X       VALUE 'I'.
   922     12  AL-UADOF            PIC X       VALUE '<'.
   923     12  AL-UADON            PIC X       VALUE '('.
   924     12  AL-UANOF            PIC X       VALUE ' '.
   925     12  AL-UANON            PIC X       VALUE 'A'.
   926     12  AL-UNBOF            PIC X       VALUE 'Q'.
   927     12  AL-UNBON            PIC X       VALUE 'R'.
   928     12  AL-UNDOF            PIC X       VALUE '*'.
   929     12  AL-UNDON            PIC X       VALUE ')'.
   930     12  AL-UNNOF            PIC X       VALUE '&'.
   931     12  AL-UNNON            PIC X       VALUE 'J'.
   932*    COPY ELCEMIB.
   933******************************************************************
   934*                                                                *
   935*                                                                *
   936*                            ELCEMIB.                            *
   937*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   938*                            VMOD=2.005                          *
   939*                                                                *
   940*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   941*                                                                *
   942******************************************************************
   943 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   944     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   945     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   946     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   947     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   948     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   949     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   950     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   951     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   952     12  EMI-SWITCH1             PIC X        VALUE '1'.
   953         88  EMI-NO-ERRORS                    VALUE '1'.
   954         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   955         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   956     12  EMI-SWITCH2             PIC X        VALUE '1'.
   957         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   958     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   959         88  EMI-AREA1-EMPTY                  VALUE '1'.
   960         88  EMI-AREA1-FULL                   VALUE '2'.
   961     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   962         88  EMI-AREA2-EMPTY                  VALUE '1'.
   963         88  EMI-AREA2-FULL                   VALUE '2'.
   964     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   965         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   966         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   967         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  19
* EL6318.cbl
   968         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   969         88  EMI-BYPASS-FATALS                VALUE 'X'.
   970     12  EMI-ERROR-LINES.
   971         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   972         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   973         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   974         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   975             20  EMI-ERR-CODES OCCURS 10 TIMES.
   976                 24  EMI-ERR-NUM         PIC X(4).
   977                 24  EMI-FILLER          PIC X.
   978                 24  EMI-SEV             PIC X.
   979                 24  FILLER              PIC X.
   980             20  FILLER                  PIC X(02).
   981     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   982         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   983             20  EMI-ERROR-NUMBER    PIC X(4).
   984             20  EMI-FILL            PIC X.
   985             20  EMI-SEVERITY        PIC X.
   986             20  FILLER              PIC X.
   987             20  EMI-ERROR-TEXT.
   988                 24  EMI-TEXT-VARIABLE   PIC X(10).
   989                 24  FILLER          PIC X(55).
   990     12  EMI-SEVERITY-SAVE           PIC X.
   991         88  EMI-NOTE                    VALUE 'N'.
   992         88  EMI-WARNING                 VALUE 'W'.
   993         88  EMI-FORCABLE                VALUE 'F'.
   994         88  EMI-FATAL                   VALUE 'X'.
   995     12  EMI-MESSAGE-FLAG            PIC X.
   996         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   997         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   998     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   999     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  1000         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  1001         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  1002         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  1003     12  FILLER                      PIC X(137)  VALUE SPACES.
  1004     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  1005     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  1006     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  1007     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  1008*    COPY ELCINTF.
  1009******************************************************************
  1010*                                                                *
  1011*                                                                *
  1012*                            ELCINTF.                            *
  1013*                            VMOD=2.017                          *
  1014*                                                                *
  1015*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  1016*                                                                *
  1017*       LENGTH = 1024                                            *
  1018*                                                                *
  1019******************************************************************
  1020*                   C H A N G E   L O G
  1021*
  1022* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1023*-----------------------------------------------------------------
  1024*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1025* EFFECTIVE    NUMBER
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  20
* EL6318.cbl
  1026*-----------------------------------------------------------------
  1027* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  1028******************************************************************
  1029 01  PROGRAM-INTERFACE-BLOCK.
  1030     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  1031     12  PI-CALLING-PROGRAM              PIC X(8).
  1032     12  PI-SAVED-PROGRAM-1              PIC X(8).
  1033     12  PI-SAVED-PROGRAM-2              PIC X(8).
  1034     12  PI-SAVED-PROGRAM-3              PIC X(8).
  1035     12  PI-SAVED-PROGRAM-4              PIC X(8).
  1036     12  PI-SAVED-PROGRAM-5              PIC X(8).
  1037     12  PI-SAVED-PROGRAM-6              PIC X(8).
  1038     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  1039     12  PI-COMPANY-ID                   PIC XXX.
  1040     12  PI-COMPANY-CD                   PIC X.
  1041
  1042     12  PI-COMPANY-PASSWORD             PIC X(8).
  1043
  1044     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  1045
  1046     12  PI-CONTROL-IN-PROGRESS.
  1047         16  PI-CARRIER                  PIC X.
  1048         16  PI-GROUPING                 PIC X(6).
  1049         16  PI-STATE                    PIC XX.
  1050         16  PI-ACCOUNT                  PIC X(10).
  1051         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  1052                                         PIC X(10).
  1053         16  PI-CLAIM-CERT-GRP.
  1054             20  PI-CLAIM-NO             PIC X(7).
  1055             20  PI-CERT-NO.
  1056                 25  PI-CERT-PRIME       PIC X(10).
  1057                 25  PI-CERT-SFX         PIC X.
  1058             20  PI-CERT-EFF-DT          PIC XX.
  1059         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  1060             20  PI-PLAN-CODE            PIC X(2).
  1061             20  PI-REVISION-NUMBER      PIC X(3).
  1062             20  PI-PLAN-EFF-DT          PIC X(2).
  1063             20  PI-PLAN-EXP-DT          PIC X(2).
  1064             20  FILLER                  PIC X(11).
  1065         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
  1066             20  PI-OE-REFERENCE-1.
  1067                 25  PI-OE-REF-1-PRIME   PIC X(18).
  1068                 25  PI-OE-REF-1-SUFF    PIC XX.
  1069
  1070     12  PI-SESSION-IN-PROGRESS          PIC X.
  1071         88  CLAIM-SESSION                   VALUE '1'.
  1072         88  CREDIT-SESSION                  VALUE '2'.
  1073         88  WARRANTY-SESSION                VALUE '3'.
  1074         88  MORTGAGE-SESSION                VALUE '4'.
  1075         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  1076
  1077
  1078*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  1079
  1080     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  1081     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  1082
  1083     12  PI-CREDIT-USER                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  21
* EL6318.cbl
  1084         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  1085         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  1086
  1087     12  PI-CLAIM-USER                   PIC X.
  1088         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  1089         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  1090
  1091     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  1092         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  1093         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  1094         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  1095         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  1096         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  1097
  1098     12  PI-PROCESSOR-ID                 PIC X(4).
  1099
  1100     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  1101
  1102     12  PI-MEMBER-CAPTION               PIC X(10).
  1103
  1104     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1105         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  1106
  1107     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1108     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1109     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1110     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1111
  1112     12  PI-AH-OVERRIDE-L1               PIC X.
  1113     12  PI-AH-OVERRIDE-L2               PIC XX.
  1114     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1115     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1116
  1117     12  PI-NEW-SYSTEM                   PIC X(2).
  1118
  1119     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1120     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1121         88  PI-USES-PAID-TO                 VALUE '1'.
  1122     12  PI-CRDTCRD-SYSTEM.
  1123         16  PI-CRDTCRD-USER             PIC X.
  1124             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1125             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1126         16  PI-CC-MONTH-END-DT          PIC XX.
  1127     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1128
  1129     12  PI-OE-REFERENCE-2.
  1130         16  PI-OE-REF-2-PRIME           PIC X(10).
  1131         16  PI-OE-REF-2-SUFF            PIC X.
  1132
  1133     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1134
  1135     12  PI-LANGUAGE-TYPE                PIC X.
  1136             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1137             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1138             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1139
  1140     12  PI-POLICY-LINKAGE-IND           PIC X.
  1141         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  22
* EL6318.cbl
  1142         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1143                                                   LOW-VALUES.
  1144
  1145     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1146     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1147         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1148         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1149
  1150     12  PI-PROCESSOR-CSR-IND            PIC X.
  1151         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1152         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  1153
  1154     12  FILLER                          PIC X(3).
  1155
  1156     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1157
  1158     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1159         PI-SYSTEM-LEVEL.
  1160
  1161         16  PI-ENTRY-CODES.
  1162             20  PI-ENTRY-CD-1           PIC X.
  1163             20  PI-ENTRY-CD-2           PIC X.
  1164
  1165         16  PI-RETURN-CODES.
  1166             20  PI-RETURN-CD-1          PIC X.
  1167             20  PI-RETURN-CD-2          PIC X.
  1168
  1169         16  PI-UPDATE-STATUS-SAVE.
  1170             20  PI-UPDATE-BY            PIC X(4).
  1171             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1172
  1173         16  PI-LOWER-CASE-LETTERS       PIC X.
  1174             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1175
  1176*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1177*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1178*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1179
  1180         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1181             88  ST-ACCNT-CNTL               VALUE ' '.
  1182             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1183             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1184             88  ACCNT-CNTL                  VALUE '3'.
  1185             88  CARR-ACCNT-CNTL             VALUE '4'.
  1186
  1187         16  PI-PROCESSOR-CAP-LIST.
  1188             20  PI-SYSTEM-CONTROLS.
  1189                24 PI-SYSTEM-DISPLAY     PIC X.
  1190                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1191                24 PI-SYSTEM-MODIFY      PIC X.
  1192                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1193             20  FILLER                  PIC XX.
  1194             20  PI-DISPLAY-CAP          PIC X.
  1195                 88  DISPLAY-CAP             VALUE 'Y'.
  1196             20  PI-MODIFY-CAP           PIC X.
  1197                 88  MODIFY-CAP              VALUE 'Y'.
  1198             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1199                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  23
* EL6318.cbl
  1200             20  PI-FORCE-CAP            PIC X.
  1201                 88  FORCE-CAP               VALUE 'Y'.
  1202
  1203         16  PI-PROGRAM-CONTROLS.
  1204             20  PI-PGM-PRINT-OPT        PIC X.
  1205             20  PI-PGM-FORMAT-OPT       PIC X.
  1206             20  PI-PGM-PROCESS-OPT      PIC X.
  1207             20  PI-PGM-TOTALS-OPT       PIC X.
  1208
  1209         16  PI-HELP-INTERFACE.
  1210             20  PI-LAST-ERROR-NO        PIC X(4).
  1211             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1212
  1213         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1214             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1215
  1216         16  PI-CR-CONTROL-IN-PROGRESS.
  1217             20  PI-CR-CARRIER           PIC X.
  1218             20  PI-CR-GROUPING          PIC X(6).
  1219             20  PI-CR-STATE             PIC XX.
  1220             20  PI-CR-ACCOUNT           PIC X(10).
  1221             20  PI-CR-FIN-RESP          PIC X(10).
  1222             20  PI-CR-TYPE              PIC X.
  1223
  1224         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1225
  1226         16  PI-CR-MONTH-END-DT          PIC XX.
  1227
  1228         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1229             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1230             88  PI-ZERO-CARRIER             VALUE '1'.
  1231             88  PI-ZERO-GROUPING            VALUE '2'.
  1232             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1233
  1234         16  PI-CARRIER-SECURITY         PIC X.
  1235             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1236
  1237         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1238             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1239             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
  1240
  1241         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1242             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1243                                         INDEXED BY PI-ACCESS-NDX
  1244                                         PIC X.
  1245
  1246         16  PI-GA-BILLING-CONTROL       PIC X.
  1247             88  PI-GA-BILLING               VALUE '1'.
  1248
  1249         16  PI-MAIL-PROCESSING          PIC X.
  1250             88  PI-MAIL-YES                 VALUE 'Y'.
  1251
  1252         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1253
  1254         16  PI-AR-SYSTEM.
  1255             20  PI-AR-PROCESSING-CNTL   PIC X.
  1256                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1257             20  PI-AR-SUMMARY-CODE      PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  24
* EL6318.cbl
  1258             20  PI-AR-MONTH-END-DT      PIC XX.
  1259
  1260         16  PI-MP-SYSTEM.
  1261             20  PI-MORTGAGE-USER            PIC X.
  1262                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1263                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1264             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1265                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1266                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1267                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1268                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1269                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1270             20  PI-MP-MONTH-END-DT          PIC XX.
  1271             20  PI-MP-REFERENCE-NO.
  1272                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1273                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1274
  1275         16  PI-LABEL-CONTROL            PIC X(01).
  1276             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1277             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1278
  1279         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1280             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1281
  1282         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1283             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1284             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1285
  1286         16  FILLER                      PIC X(14).
  1287
  1288     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1289******************************************************************
  1290     12  FILLER REDEFINES PI-PROGRAM-WORK-AREA.
  1291        16  PI-ISS-CAN-SW           PIC X.
  1292        16  PI-ERENDT-KEY.
  1293            20  PI-ENDT-COMPANY-CD  PIC X.
  1294            20  PI-ENDT-CARRIER     PIC X.
  1295            20  PI-ENDT-GROUPING    PIC X(6).
  1296            20  PI-ENDT-STATE       PIC XX.
  1297            20  PI-ENDT-ACCOUNT     PIC X(10).
  1298            20  PI-ENDT-CERT-EFF-DT PIC XX.
  1299            20  PI-ENDT-CERT-PRIME  PIC X(10).
  1300            20  PI-ENDT-CERT-SFX    PIC X.
  1301            20  PI-ENDT-RECORD-TYPE PIC X.
  1302            20  PI-ENDT-SEQ-NO      PIC 9(4) BINARY.
  1303        16  PI-ELCRTO-KEY.
  1304            20  PI-CRTO-COMPANY-CD  PIC X.
  1305            20  PI-CRTO-CARRIER     PIC X.
  1306            20  PI-CRTO-GROUPING    PIC X(6).
  1307            20  PI-CRTO-STATE       PIC XX.
  1308            20  PI-CRTO-ACCOUNT     PIC X(10).
  1309            20  PI-CRTO-CERT-EFF-DT PIC XX.
  1310            20  PI-CRTO-CERT-PRIME  PIC X(10).
  1311            20  PI-CRTO-CERT-SFX    PIC X.
  1312            20  PI-CRTO-RECORD-TYPE PIC X.
  1313            20  PI-CRTO-SEQ-NO      PIC 9(4) BINARY.
  1314        16  PI-ERPNDB-KEY           PIC X(11).
  1315        16  PI-DOCUMENT-PROCESSED   PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  25
* EL6318.cbl
  1316            88  PI-VERI-PROCESSED      VALUE 'V'.
  1317            88  PI-ENDO-PROCESSED      VALUE 'G'.
  1318        16  PI-PREV-ERENDT-KEY      PIC X(36).
  1319        16  PI-RES-REF-CLM-TYPE     PIC X.
  1320        16  PI-CLM-REFORM-IND       PIC X.
  1321            88  PI-CLAIM-REFORMATION   VALUE 'Y'.
  1322        16  PI-CLEAR-ERROR-SW       PIC X.
  1323            88  PI-CLEAR-ERROR         VALUE 'Y'.
  1324        16  PI-PRINT-CERTIFICATE    PIC X.
  1325        16  PI-ENTERED.
  1326            20  PI-PRTSW-ENTERED    PIC X.
  1327            20  PI-SIGREQ-ENTERED   PIC X.
  1328            20  PI-MONEY-ENTERED    PIC X.
  1329            20  PI-LTRID-ENTERED    PIC X(4).
  1330            20  PI-VOUCHER-ENTERED  PIC X.
  1331            20  PI-HLTHAPP-ENTERED  PIC X.
  1332            20  PI-PAYEE-ENTERED    PIC X(10).
  1333            20  PI-CERTID-ENTERED   PIC X(5).
  1334            20  PI-REASONS-ENTERED  PIC X(84).
  1335            20  PI-CERTNT1-ENTERED  PIC X(63).
  1336            20  PI-CERTNT2-ENTERED  PIC X(63).
  1337        16  PI-FINALIZED-IND        PIC X.
  1338        16  PI-CERTNT3-ENTERED      PIC X(63).
  1339        16  PI-CERTNT4-ENTERED      PIC X(63).
  1340        16  PI-BILLNT1-ENTERED      PIC X(63).
  1341        16  PI-BILLNT2-ENTERED      PIC X(63).
  1342        16  PI-REASON-CODE-IND      PIC X(26).
  1343        16  FILLER                  PIC X(2).
  1344    12  FILLER                      PIC X(276).
  1345*    COPY ELCAID.
  1346******************************************************************
  1347*                                                                *
  1348*                            ELCAID.                             *
  1349*                            VMOD=2.001                          *
  1350*                                                                *
  1351*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1352*                                                                *
  1353*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1354*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1355******************************************************************
  1356
  1357 01  DFHAID.
  1358   02  DFHNULL   PIC  X  VALUE  ' '.
  1359   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1360   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1361   02  DFHPEN    PIC  X  VALUE  '='.
  1362   02  DFHOPID   PIC  X  VALUE  'W'.
  1363   02  DFHPA1    PIC  X  VALUE  '%'.
  1364   02  DFHPA2    PIC  X  VALUE  '>'.
  1365   02  DFHPA3    PIC  X  VALUE  ','.
  1366   02  DFHPF1    PIC  X  VALUE  '1'.
  1367   02  DFHPF2    PIC  X  VALUE  '2'.
  1368   02  DFHPF3    PIC  X  VALUE  '3'.
  1369   02  DFHPF4    PIC  X  VALUE  '4'.
  1370   02  DFHPF5    PIC  X  VALUE  '5'.
  1371   02  DFHPF6    PIC  X  VALUE  '6'.
  1372   02  DFHPF7    PIC  X  VALUE  '7'.
  1373   02  DFHPF8    PIC  X  VALUE  '8'.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  26
* EL6318.cbl
  1374   02  DFHPF9    PIC  X  VALUE  '9'.
  1375   02  DFHPF10   PIC  X  VALUE  ':'.
  1376   02  DFHPF11   PIC  X  VALUE  '#'.
  1377   02  DFHPF12   PIC  X  VALUE  '@'.
  1378   02  DFHPF13   PIC  X  VALUE  'A'.
  1379   02  DFHPF14   PIC  X  VALUE  'B'.
  1380   02  DFHPF15   PIC  X  VALUE  'C'.
  1381   02  DFHPF16   PIC  X  VALUE  'D'.
  1382   02  DFHPF17   PIC  X  VALUE  'E'.
  1383   02  DFHPF18   PIC  X  VALUE  'F'.
  1384   02  DFHPF19   PIC  X  VALUE  'G'.
  1385   02  DFHPF20   PIC  X  VALUE  'H'.
  1386   02  DFHPF21   PIC  X  VALUE  'I'.
  1387*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1388   02  DFHPF22   PIC  X  VALUE  '['.
  1389   02  DFHPF23   PIC  X  VALUE  '.'.
  1390   02  DFHPF24   PIC  X  VALUE  '<'.
  1391   02  DFHMSRE   PIC  X  VALUE  'X'.
  1392   02  DFHSTRF   PIC  X  VALUE  'h'.
  1393   02  DFHTRIG   PIC  X  VALUE  '"'.
  1394 01  FILLER    REDEFINES DFHAID.
  1395     12  FILLER              PIC X(8).
  1396     12  PF-VALUES           PIC X       OCCURS 24 TIMES.
  1397     12  FILLER              PIC X(3).
  1398*   COPY EL6318S.
  1399 01  EL631KI.
  1400     05  FILLER            PIC  X(0012).
  1401*    -------------------------------
  1402     05  DATEL PIC S9(0004) COMP.
  1403     05  DATEF PIC  X(0001).
  1404     05  FILLER REDEFINES DATEF.
  1405         10  DATEA PIC  X(0001).
  1406     05  DATEI PIC  X(0008).
  1407*    -------------------------------
  1408     05  TIMEL PIC S9(0004) COMP.
  1409     05  TIMEF PIC  X(0001).
  1410     05  FILLER REDEFINES TIMEF.
  1411         10  TIMEA PIC  X(0001).
  1412     05  TIMEI PIC  X(0005).
  1413*    -------------------------------
  1414     05  PROCIDL PIC S9(0004) COMP.
  1415     05  PROCIDF PIC  X(0001).
  1416     05  FILLER REDEFINES PROCIDF.
  1417         10  PROCIDA PIC  X(0001).
  1418     05  PROCIDI PIC  X(0004).
  1419*    -------------------------------
  1420     05  HOSTL PIC S9(0004) COMP.
  1421     05  HOSTF PIC  X(0001).
  1422     05  FILLER REDEFINES HOSTF.
  1423         10  HOSTA PIC  X(0001).
  1424     05  HOSTI PIC  X(0009).
  1425*    -------------------------------
  1426     05  SYSL PIC S9(0004) COMP.
  1427     05  SYSF PIC  X(0001).
  1428     05  FILLER REDEFINES SYSF.
  1429         10  SYSA PIC  X(0001).
  1430     05  SYSI PIC  X(0005).
  1431*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  27
* EL6318.cbl
  1432     05  COMPANYL PIC S9(0004) COMP.
  1433     05  COMPANYF PIC  X(0001).
  1434     05  FILLER REDEFINES COMPANYF.
  1435         10  COMPANYA PIC  X(0001).
  1436     05  COMPANYI PIC  X(0003).
  1437*    -------------------------------
  1438     05  DATASORL PIC S9(0004) COMP.
  1439     05  DATASORF PIC  X(0001).
  1440     05  FILLER REDEFINES DATASORF.
  1441         10  DATASORA PIC  X(0001).
  1442     05  DATASORI PIC  X(0001).
  1443*    -------------------------------
  1444     05  BATCHNOL PIC S9(0004) COMP.
  1445     05  BATCHNOF PIC  X(0001).
  1446     05  FILLER REDEFINES BATCHNOF.
  1447         10  BATCHNOA PIC  X(0001).
  1448     05  BATCHNOI PIC  X(0006).
  1449*    -------------------------------
  1450     05  BSEQNOL PIC S9(0004) COMP.
  1451     05  BSEQNOF PIC  X(0001).
  1452     05  FILLER REDEFINES BSEQNOF.
  1453         10  BSEQNOA PIC  X(0001).
  1454     05  BSEQNOI PIC  X(0008).
  1455*    -------------------------------
  1456     05  ARCHNOL PIC S9(0004) COMP.
  1457     05  ARCHNOF PIC  X(0001).
  1458     05  FILLER REDEFINES ARCHNOF.
  1459         10  ARCHNOA PIC  X(0001).
  1460     05  ARCHNOI PIC  X(0008).
  1461*    -------------------------------
  1462     05  PRTSWL PIC S9(0004) COMP.
  1463     05  PRTSWF PIC  X(0001).
  1464     05  FILLER REDEFINES PRTSWF.
  1465         10  PRTSWA PIC  X(0001).
  1466     05  PRTSWI PIC  X(0001).
  1467*    -------------------------------
  1468     05  CARRL PIC S9(0004) COMP.
  1469     05  CARRF PIC  X(0001).
  1470     05  FILLER REDEFINES CARRF.
  1471         10  CARRA PIC  X(0001).
  1472     05  CARRI PIC  X(0001).
  1473*    -------------------------------
  1474     05  GROUPL PIC S9(0004) COMP.
  1475     05  GROUPF PIC  X(0001).
  1476     05  FILLER REDEFINES GROUPF.
  1477         10  GROUPA PIC  X(0001).
  1478     05  GROUPI PIC  X(0006).
  1479*    -------------------------------
  1480     05  STATEL PIC S9(0004) COMP.
  1481     05  STATEF PIC  X(0001).
  1482     05  FILLER REDEFINES STATEF.
  1483         10  STATEA PIC  X(0001).
  1484     05  STATEI PIC  X(0002).
  1485*    -------------------------------
  1486     05  ACCTL PIC S9(0004) COMP.
  1487     05  ACCTF PIC  X(0001).
  1488     05  FILLER REDEFINES ACCTF.
  1489         10  ACCTA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  28
* EL6318.cbl
  1490     05  ACCTI PIC  X(0010).
  1491*    -------------------------------
  1492     05  EFFDTL PIC S9(0004) COMP.
  1493     05  EFFDTF PIC  X(0001).
  1494     05  FILLER REDEFINES EFFDTF.
  1495         10  EFFDTA PIC  X(0001).
  1496     05  EFFDTI PIC  X(0008).
  1497*    -------------------------------
  1498     05  CERTNOL PIC S9(0004) COMP.
  1499     05  CERTNOF PIC  X(0001).
  1500     05  FILLER REDEFINES CERTNOF.
  1501         10  CERTNOA PIC  X(0001).
  1502     05  CERTNOI PIC  X(0010).
  1503*    -------------------------------
  1504     05  CRTSFXL PIC S9(0004) COMP.
  1505     05  CRTSFXF PIC  X(0001).
  1506     05  FILLER REDEFINES CRTSFXF.
  1507         10  CRTSFXA PIC  X(0001).
  1508     05  CRTSFXI PIC  X(0001).
  1509*    -------------------------------
  1510     05  SEQNOL PIC S9(0004) COMP.
  1511     05  SEQNOF PIC  X(0001).
  1512     05  FILLER REDEFINES SEQNOF.
  1513         10  SEQNOA PIC  X(0001).
  1514     05  SEQNOI PIC  X(0006).
  1515*    -------------------------------
  1516     05  SIGREQL PIC S9(0004) COMP.
  1517     05  SIGREQF PIC  X(0001).
  1518     05  FILLER REDEFINES SIGREQF.
  1519         10  SIGREQA PIC  X(0001).
  1520     05  SIGREQI PIC  X(0001).
  1521*    -------------------------------
  1522     05  LTRIDL PIC S9(0004) COMP.
  1523     05  LTRIDF PIC  X(0001).
  1524     05  FILLER REDEFINES LTRIDF.
  1525         10  LTRIDA PIC  X(0001).
  1526     05  LTRIDI PIC  X(0004).
  1527*    -------------------------------
  1528     05  HLTHAPPL PIC S9(0004) COMP.
  1529     05  HLTHAPPF PIC  X(0001).
  1530     05  FILLER REDEFINES HLTHAPPF.
  1531         10  HLTHAPPA PIC  X(0001).
  1532     05  HLTHAPPI PIC  X(0001).
  1533*    -------------------------------
  1534     05  VOUCHL PIC S9(0004) COMP.
  1535     05  VOUCHF PIC  X(0001).
  1536     05  FILLER REDEFINES VOUCHF.
  1537         10  VOUCHA PIC  X(0001).
  1538     05  VOUCHI PIC  X(0001).
  1539*    -------------------------------
  1540     05  PAYEEL PIC S9(0004) COMP.
  1541     05  PAYEEF PIC  X(0001).
  1542     05  FILLER REDEFINES PAYEEF.
  1543         10  PAYEEA PIC  X(0001).
  1544     05  PAYEEI PIC  X(0010).
  1545*    -------------------------------
  1546     05  CERTIDL PIC S9(0004) COMP.
  1547     05  CERTIDF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  29
* EL6318.cbl
  1548     05  FILLER REDEFINES CERTIDF.
  1549         10  CERTIDA PIC  X(0001).
  1550     05  CERTIDI PIC  X(0005).
  1551*    -------------------------------
  1552     05  RCD01L PIC S9(0004) COMP.
  1553     05  RCD01F PIC  X(0001).
  1554     05  FILLER REDEFINES RCD01F.
  1555         10  RCD01A PIC  X(0001).
  1556     05  RCD01I PIC  X(0004).
  1557*    -------------------------------
  1558     05  RCD02L PIC S9(0004) COMP.
  1559     05  RCD02F PIC  X(0001).
  1560     05  FILLER REDEFINES RCD02F.
  1561         10  RCD02A PIC  X(0001).
  1562     05  RCD02I PIC  X(0004).
  1563*    -------------------------------
  1564     05  RCD03L PIC S9(0004) COMP.
  1565     05  RCD03F PIC  X(0001).
  1566     05  FILLER REDEFINES RCD03F.
  1567         10  RCD03A PIC  X(0001).
  1568     05  RCD03I PIC  X(0004).
  1569*    -------------------------------
  1570     05  RCD04L PIC S9(0004) COMP.
  1571     05  RCD04F PIC  X(0001).
  1572     05  FILLER REDEFINES RCD04F.
  1573         10  RCD04A PIC  X(0001).
  1574     05  RCD04I PIC  X(0004).
  1575*    -------------------------------
  1576     05  RCD05L PIC S9(0004) COMP.
  1577     05  RCD05F PIC  X(0001).
  1578     05  FILLER REDEFINES RCD05F.
  1579         10  RCD05A PIC  X(0001).
  1580     05  RCD05I PIC  X(0004).
  1581*    -------------------------------
  1582     05  RCD06L PIC S9(0004) COMP.
  1583     05  RCD06F PIC  X(0001).
  1584     05  FILLER REDEFINES RCD06F.
  1585         10  RCD06A PIC  X(0001).
  1586     05  RCD06I PIC  X(0004).
  1587*    -------------------------------
  1588     05  RCD07L PIC S9(0004) COMP.
  1589     05  RCD07F PIC  X(0001).
  1590     05  FILLER REDEFINES RCD07F.
  1591         10  RCD07A PIC  X(0001).
  1592     05  RCD07I PIC  X(0004).
  1593*    -------------------------------
  1594     05  RCD08L PIC S9(0004) COMP.
  1595     05  RCD08F PIC  X(0001).
  1596     05  FILLER REDEFINES RCD08F.
  1597         10  RCD08A PIC  X(0001).
  1598     05  RCD08I PIC  X(0004).
  1599*    -------------------------------
  1600     05  RCD09L PIC S9(0004) COMP.
  1601     05  RCD09F PIC  X(0001).
  1602     05  FILLER REDEFINES RCD09F.
  1603         10  RCD09A PIC  X(0001).
  1604     05  RCD09I PIC  X(0004).
  1605*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  30
* EL6318.cbl
  1606     05  RCD10L PIC S9(0004) COMP.
  1607     05  RCD10F PIC  X(0001).
  1608     05  FILLER REDEFINES RCD10F.
  1609         10  RCD10A PIC  X(0001).
  1610     05  RCD10I PIC  X(0004).
  1611*    -------------------------------
  1612     05  RCD11L PIC S9(0004) COMP.
  1613     05  RCD11F PIC  X(0001).
  1614     05  FILLER REDEFINES RCD11F.
  1615         10  RCD11A PIC  X(0001).
  1616     05  RCD11I PIC  X(0004).
  1617*    -------------------------------
  1618     05  RCD12L PIC S9(0004) COMP.
  1619     05  RCD12F PIC  X(0001).
  1620     05  FILLER REDEFINES RCD12F.
  1621         10  RCD12A PIC  X(0001).
  1622     05  RCD12I PIC  X(0004).
  1623*    -------------------------------
  1624     05  CRTNT1L PIC S9(0004) COMP.
  1625     05  CRTNT1F PIC  X(0001).
  1626     05  FILLER REDEFINES CRTNT1F.
  1627         10  CRTNT1A PIC  X(0001).
  1628     05  CRTNT1I PIC  X(0063).
  1629*    -------------------------------
  1630     05  CRTNT2L PIC S9(0004) COMP.
  1631     05  CRTNT2F PIC  X(0001).
  1632     05  FILLER REDEFINES CRTNT2F.
  1633         10  CRTNT2A PIC  X(0001).
  1634     05  CRTNT2I PIC  X(0063).
  1635*    -------------------------------
  1636     05  CRTNT3L PIC S9(0004) COMP.
  1637     05  CRTNT3F PIC  X(0001).
  1638     05  FILLER REDEFINES CRTNT3F.
  1639         10  CRTNT3A PIC  X(0001).
  1640     05  CRTNT3I PIC  X(0063).
  1641*    -------------------------------
  1642     05  CRTNT4L PIC S9(0004) COMP.
  1643     05  CRTNT4F PIC  X(0001).
  1644     05  FILLER REDEFINES CRTNT4F.
  1645         10  CRTNT4A PIC  X(0001).
  1646     05  CRTNT4I PIC  X(0063).
  1647*    -------------------------------
  1648     05  BILNT1L PIC S9(0004) COMP.
  1649     05  BILNT1F PIC  X(0001).
  1650     05  FILLER REDEFINES BILNT1F.
  1651         10  BILNT1A PIC  X(0001).
  1652     05  BILNT1I PIC  X(0063).
  1653*    -------------------------------
  1654     05  BILNT2L PIC S9(0004) COMP.
  1655     05  BILNT2F PIC  X(0001).
  1656     05  FILLER REDEFINES BILNT2F.
  1657         10  BILNT2A PIC  X(0001).
  1658     05  BILNT2I PIC  X(0063).
  1659*    -------------------------------
  1660     05  ERRMSG1L PIC S9(0004) COMP.
  1661     05  ERRMSG1F PIC  X(0001).
  1662     05  FILLER REDEFINES ERRMSG1F.
  1663         10  ERRMSG1A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  31
* EL6318.cbl
  1664     05  ERRMSG1I PIC  X(0075).
  1665*    -------------------------------
  1666     05  ERRMSG2L PIC S9(0004) COMP.
  1667     05  ERRMSG2F PIC  X(0001).
  1668     05  FILLER REDEFINES ERRMSG2F.
  1669         10  ERRMSG2A PIC  X(0001).
  1670     05  ERRMSG2I PIC  X(0075).
  1671*    -------------------------------
  1672     05  PFENTRL PIC S9(0004) COMP.
  1673     05  PFENTRF PIC  X(0001).
  1674     05  FILLER REDEFINES PFENTRF.
  1675         10  PFENTRA PIC  X(0001).
  1676     05  PFENTRI PIC  9(2).
  1677 01  EL631KO REDEFINES EL631KI.
  1678     05  FILLER            PIC  X(0012).
  1679*    -------------------------------
  1680     05  FILLER            PIC  X(0003).
  1681     05  DATEO PIC  X(0008).
  1682*    -------------------------------
  1683     05  FILLER            PIC  X(0003).
  1684     05  TIMEO PIC  99.99.
  1685*    -------------------------------
  1686     05  FILLER            PIC  X(0003).
  1687     05  PROCIDO PIC  X(0004).
  1688*    -------------------------------
  1689     05  FILLER            PIC  X(0003).
  1690     05  HOSTO PIC  X(0009).
  1691*    -------------------------------
  1692     05  FILLER            PIC  X(0003).
  1693     05  SYSO PIC  X(0005).
  1694*    -------------------------------
  1695     05  FILLER            PIC  X(0003).
  1696     05  COMPANYO PIC  X(0003).
  1697*    -------------------------------
  1698     05  FILLER            PIC  X(0003).
  1699     05  DATASORO PIC  X(0001).
  1700*    -------------------------------
  1701     05  FILLER            PIC  X(0003).
  1702     05  BATCHNOO PIC  X(0006).
  1703*    -------------------------------
  1704     05  FILLER            PIC  X(0003).
  1705     05  BSEQNOO PIC  X(0008).
  1706*    -------------------------------
  1707     05  FILLER            PIC  X(0003).
  1708     05  ARCHNOO PIC  X(0008).
  1709*    -------------------------------
  1710     05  FILLER            PIC  X(0003).
  1711     05  PRTSWO PIC  X(0001).
  1712*    -------------------------------
  1713     05  FILLER            PIC  X(0003).
  1714     05  CARRO PIC  X(0001).
  1715*    -------------------------------
  1716     05  FILLER            PIC  X(0003).
  1717     05  GROUPO PIC  X(0006).
  1718*    -------------------------------
  1719     05  FILLER            PIC  X(0003).
  1720     05  STATEO PIC  X(0002).
  1721*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  32
* EL6318.cbl
  1722     05  FILLER            PIC  X(0003).
  1723     05  ACCTO PIC  X(0010).
  1724*    -------------------------------
  1725     05  FILLER            PIC  X(0003).
  1726     05  EFFDTO PIC  X(0008).
  1727*    -------------------------------
  1728     05  FILLER            PIC  X(0003).
  1729     05  CERTNOO PIC  X(0010).
  1730*    -------------------------------
  1731     05  FILLER            PIC  X(0003).
  1732     05  CRTSFXO PIC  X(0001).
  1733*    -------------------------------
  1734     05  FILLER            PIC  X(0003).
  1735     05  SEQNOO PIC  999999.
  1736*    -------------------------------
  1737     05  FILLER            PIC  X(0003).
  1738     05  SIGREQO PIC  X(0001).
  1739*    -------------------------------
  1740     05  FILLER            PIC  X(0003).
  1741     05  LTRIDO PIC  X(0004).
  1742*    -------------------------------
  1743     05  FILLER            PIC  X(0003).
  1744     05  HLTHAPPO PIC  X(0001).
  1745*    -------------------------------
  1746     05  FILLER            PIC  X(0003).
  1747     05  VOUCHO PIC  X(0001).
  1748*    -------------------------------
  1749     05  FILLER            PIC  X(0003).
  1750     05  PAYEEO PIC  X(0010).
  1751*    -------------------------------
  1752     05  FILLER            PIC  X(0003).
  1753     05  CERTIDO PIC  X(0005).
  1754*    -------------------------------
  1755     05  FILLER            PIC  X(0003).
  1756     05  RCD01O PIC  X(0004).
  1757*    -------------------------------
  1758     05  FILLER            PIC  X(0003).
  1759     05  RCD02O PIC  X(0004).
  1760*    -------------------------------
  1761     05  FILLER            PIC  X(0003).
  1762     05  RCD03O PIC  X(0004).
  1763*    -------------------------------
  1764     05  FILLER            PIC  X(0003).
  1765     05  RCD04O PIC  X(0004).
  1766*    -------------------------------
  1767     05  FILLER            PIC  X(0003).
  1768     05  RCD05O PIC  X(0004).
  1769*    -------------------------------
  1770     05  FILLER            PIC  X(0003).
  1771     05  RCD06O PIC  X(0004).
  1772*    -------------------------------
  1773     05  FILLER            PIC  X(0003).
  1774     05  RCD07O PIC  X(0004).
  1775*    -------------------------------
  1776     05  FILLER            PIC  X(0003).
  1777     05  RCD08O PIC  X(0004).
  1778*    -------------------------------
  1779     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  33
* EL6318.cbl
  1780     05  RCD09O PIC  X(0004).
  1781*    -------------------------------
  1782     05  FILLER            PIC  X(0003).
  1783     05  RCD10O PIC  X(0004).
  1784*    -------------------------------
  1785     05  FILLER            PIC  X(0003).
  1786     05  RCD11O PIC  X(0004).
  1787*    -------------------------------
  1788     05  FILLER            PIC  X(0003).
  1789     05  RCD12O PIC  X(0004).
  1790*    -------------------------------
  1791     05  FILLER            PIC  X(0003).
  1792     05  CRTNT1O PIC  X(0063).
  1793*    -------------------------------
  1794     05  FILLER            PIC  X(0003).
  1795     05  CRTNT2O PIC  X(0063).
  1796*    -------------------------------
  1797     05  FILLER            PIC  X(0003).
  1798     05  CRTNT3O PIC  X(0063).
  1799*    -------------------------------
  1800     05  FILLER            PIC  X(0003).
  1801     05  CRTNT4O PIC  X(0063).
  1802*    -------------------------------
  1803     05  FILLER            PIC  X(0003).
  1804     05  BILNT1O PIC  X(0063).
  1805*    -------------------------------
  1806     05  FILLER            PIC  X(0003).
  1807     05  BILNT2O PIC  X(0063).
  1808*    -------------------------------
  1809     05  FILLER            PIC  X(0003).
  1810     05  ERRMSG1O PIC  X(0075).
  1811*    -------------------------------
  1812     05  FILLER            PIC  X(0003).
  1813     05  ERRMSG2O PIC  X(0075).
  1814*    -------------------------------
  1815     05  FILLER            PIC  X(0003).
  1816     05  PFENTRO PIC  X(0002).
  1817*    -------------------------------
  1818 01  FILLER REDEFINES EL631KI.
  1819     12  FILLER             PIC X(211).
  1820     12  REASONCDS.
  1821         16  FILLER OCCURS 12.
  1822           20  REACDL       PIC S9(4) COMP.
  1823           20  REACDA       PIC X.
  1824           20  REACD-IN     PIC X(4).
  1825     12  FILLER             PIC X(293).
  1826****************************************************************
  1827*
  1828* Copyright (c) 2007 by Clerity Solutions, Inc.
  1829* All rights reserved.
  1830*
  1831****************************************************************
  1832 01  DFHEIV.
  1833   02  DFHEIV0               PIC X(35).
  1834   02  DFHEIV1               PIC X(08).
  1835   02  DFHEIV2               PIC X(08).
  1836   02  DFHEIV3               PIC X(08).
  1837   02  DFHEIV4               PIC X(06).
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  34
* EL6318.cbl
  1838   02  DFHEIV5               PIC X(04).
  1839   02  DFHEIV6               PIC X(04).
  1840   02  DFHEIV7               PIC X(02).
  1841   02  DFHEIV8               PIC X(02).
  1842   02  DFHEIV9               PIC X(01).
  1843   02  DFHEIV10              PIC S9(7) COMP-3.
  1844   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1845   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1846   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1847   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1848   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1849   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1850   02  DFHEIV17              PIC X(04).
  1851   02  DFHEIV18              PIC X(04).
  1852   02  DFHEIV19              PIC X(04).
  1853   02  DFHEIV20              USAGE IS POINTER.
  1854   02  DFHEIV21              USAGE IS POINTER.
  1855   02  DFHEIV22              USAGE IS POINTER.
  1856   02  DFHEIV23              USAGE IS POINTER.
  1857   02  DFHEIV24              USAGE IS POINTER.
  1858   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1859   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1860   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1861   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1862   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1863   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1864   02  FILLER                PIC X(02).
  1865   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1866   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1867   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1868   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1869   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1870 LINKAGE  SECTION.
  1871*****************************************************************
  1872*                                                               *
  1873* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1874* All rights reserved.                                          *
  1875*                                                               *
  1876*****************************************************************
  1877 01  dfheiblk.
  1878     02  eibtime          pic s9(7) comp-3.
  1879     02  eibdate          pic s9(7) comp-3.
  1880     02  eibtrnid         pic x(4).
  1881     02  eibtaskn         pic s9(7) comp-3.
  1882     02  eibtrmid         pic x(4).
  1883     02  dfheigdi         pic s9(4) comp.
  1884     02  eibcposn         pic s9(4) comp.
  1885     02  eibcalen         pic s9(4) comp.
  1886     02  eibaid           pic x(1).
  1887     02  eibfiller1       pic x(1).
  1888     02  eibfn            pic x(2).
  1889     02  eibfiller2       pic x(2).
  1890     02  eibrcode         pic x(6).
  1891     02  eibfiller3       pic x(2).
  1892     02  eibds            pic x(8).
  1893     02  eibreqid         pic x(8).
  1894     02  eibrsrce         pic x(8).
  1895     02  eibsync          pic x(1).
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  35
* EL6318.cbl
  1896     02  eibfree          pic x(1).
  1897     02  eibrecv          pic x(1).
  1898     02  eibsend          pic x(1).
  1899     02  eibatt           pic x(1).
  1900     02  eibeoc           pic x(1).
  1901     02  eibfmh           pic x(1).
  1902     02  eibcompl         pic x(1).
  1903     02  eibsig           pic x(1).
  1904     02  eibconf          pic x(1).
  1905     02  eiberr           pic x(1).
  1906     02  eibrldbk         pic x(1).
  1907     02  eiberrcd         pic x(4).
  1908     02  eibsynrb         pic x(1).
  1909     02  eibnodat         pic x(1).
  1910     02  eibfiller5       pic x(2).
  1911     02  eibresp          pic 9(09) comp.
  1912     02  eibresp2         pic 9(09) comp.
  1913     02  dfheigdj         pic s9(4) comp.
  1914     02  dfheigdk         pic s9(4) comp.
  1915 01  DFHCOMMAREA                 PIC X(1300).
  1916 01  var  pic x(30).
  1917*                                COPY ERCACCT.
  1918******************************************************************
  1919*                                                                *
  1920*                                                                *
  1921*                            ERCACCT                             *
  1922*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1923*                            VMOD=2.031                          *
  1924*                                                                *
  1925*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  1926*                                                                *
  1927*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  1928*   VSAM ACCOUNT MASTER FILES.                                   *
  1929*                                                                *
  1930*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  1931*                                                                *
  1932*   FILE TYPE = VSAM,KSDS                                        *
  1933*   RECORD SIZE = 2000  RECFORM = FIX                            *
  1934*                                                                *
  1935*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  1936*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  1937*                                                                *
  1938*   LOG = NO                                                     *
  1939*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1940*                                                                *
  1941*                                                                *
  1942******************************************************************
  1943*                   C H A N G E   L O G
  1944*
  1945* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1946*-----------------------------------------------------------------
  1947*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1948* EFFECTIVE    NUMBER
  1949*-----------------------------------------------------------------
  1950* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  1951* 092705    2005050300006  PEMA  ADD SPP LEASES
  1952* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  1953* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  36
* EL6318.cbl
  1954* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  1955* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  1956* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  1957******************************************************************
  1958
  1959 01  ACCOUNT-MASTER.
  1960     12  AM-RECORD-ID                      PIC XX.
  1961         88  VALID-AM-ID                      VALUE 'AM'.
  1962
  1963     12  AM-CONTROL-PRIMARY.
  1964         16  AM-COMPANY-CD                 PIC X.
  1965         16  AM-MSTR-CNTRL.
  1966             20  AM-CONTROL-A.
  1967                 24  AM-CARRIER            PIC X.
  1968                 24  AM-GROUPING.
  1969                     28 AM-GROUPING-PREFIX PIC XXX.
  1970                     28 AM-GROUPING-PRIME  PIC XXX.
  1971                 24  AM-STATE              PIC XX.
  1972                 24  AM-ACCOUNT.
  1973                     28  AM-ACCOUNT-PREFIX PIC X(4).
  1974                     28  AM-ACCOUNT-PRIME  PIC X(6).
  1975             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  1976                                           PIC X(19).
  1977             20  AM-CNTRL-B.
  1978                 24  AM-EXPIRATION-DT      PIC XX.
  1979                 24  FILLER                PIC X(4).
  1980             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  1981                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  1982
  1983     12  AM-CONTROL-BY-VAR-GRP.
  1984         16  AM-COMPANY-CD-A1              PIC X.
  1985         16  AM-VG-CARRIER                 PIC X.
  1986         16  AM-VG-GROUPING                PIC X(6).
  1987         16  AM-VG-STATE                   PIC XX.
  1988         16  AM-VG-ACCOUNT                 PIC X(10).
  1989         16  AM-VG-DATE.
  1990             20  AM-VG-EXPIRATION-DT       PIC XX.
  1991             20  FILLER                    PIC X(4).
  1992         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  1993                                           PIC 9(11)      COMP-3.
  1994     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  1995         16  FILLER                        PIC X(10).
  1996         16  AM-VG-KEY3.
  1997             20  AM-VG3-ACCOUNT            PIC X(10).
  1998             20  AM-VG3-EXP-DT             PIC XX.
  1999         16  FILLER                        PIC X(4).
  2000     12  AM-MAINT-INFORMATION.
  2001         16  AM-LAST-MAINT-DT              PIC XX.
  2002         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2003         16  AM-LAST-MAINT-USER            PIC X(4).
  2004         16  FILLER                        PIC XX.
  2005
  2006     12  AM-EFFECTIVE-DT                   PIC XX.
  2007     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  2008
  2009     12  AM-PREV-DATES  COMP-3.
  2010         16  AM-PREV-EXP-DT                PIC 9(11).
  2011         16  AM-PREV-EFF-DT                PIC 9(11).
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  37
* EL6318.cbl
  2012
  2013     12  AM-REPORT-CODE-1                  PIC X(10).
  2014     12  AM-REPORT-CODE-2                  PIC X(10).
  2015
  2016     12  AM-CITY-CODE                      PIC X(4).
  2017     12  AM-COUNTY-PARISH                  PIC X(6).
  2018
  2019     12  AM-NAME                           PIC X(30).
  2020     12  AM-PERSON                         PIC X(30).
  2021     12  AM-ADDRS                          PIC X(30).
  2022     12  AM-CITY.
  2023         16  AM-ADDR-CITY                  PIC X(28).
  2024         16  AM-ADDR-STATE                 PIC XX.
  2025     12  AM-ZIP.
  2026         16  AM-ZIP-PRIME.
  2027             20  AM-ZIP-PRI-1ST            PIC X.
  2028                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  2029             20  FILLER                    PIC X(4).
  2030         16  AM-ZIP-PLUS4                  PIC X(4).
  2031     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  2032         16  AM-CAN-POSTAL-1               PIC XXX.
  2033         16  AM-CAN-POSTAL-2               PIC XXX.
  2034         16  FILLER                        PIC XXX.
  2035     12  AM-TEL-NO.
  2036         16  AM-AREA-CODE                  PIC 999.
  2037         16  AM-TEL-PRE                    PIC 999.
  2038         16  AM-TEL-NBR                    PIC 9(4).
  2039     12  AM-TEL-LOC                        PIC X.
  2040         88  AM-TEL-AT-HOME                   VALUE 'H'.
  2041         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  2042
  2043     12  AM-COMM-STRUCTURE.
  2044         16  AM-DEFN-1.
  2045             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  2046                 24  AM-AGT.
  2047                     28  AM-AGT-PREFIX     PIC X(4).
  2048                     28  AM-AGT-PRIME      PIC X(6).
  2049                 24  AM-COM-TYP            PIC X.
  2050                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  2051                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  2052                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  2053                 24  AM-RECALC-LV-INDIC    PIC X.
  2054                 24  AM-RETRO-LV-INDIC     PIC X.
  2055                 24  AM-GL-CODES           PIC X.
  2056                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  2057                 24  FILLER                PIC X(01).
  2058         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  2059             20  AM-COM-TBLS        OCCURS 10 TIMES.
  2060                 24  FILLER                PIC X(11).
  2061                 24  AM-L-COMA             PIC XXX.
  2062                 24  AM-J-COMA             PIC XXX.
  2063                 24  AM-A-COMA             PIC XXX.
  2064                 24  FILLER                PIC X(6).
  2065
  2066     12  AM-COMM-CHANGE-STATUS             PIC X.
  2067         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  2068
  2069     12  AM-CSR-CODE                       PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  38
* EL6318.cbl
  2070
  2071     12  AM-BILLING-STATUS                 PIC X.
  2072         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  2073         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  2074     12  AM-AUTO-REFUND-SW                 PIC X.
  2075         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  2076         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  2077     12  AM-GPCD                           PIC 99.
  2078     12  AM-IG                             PIC X.
  2079         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  2080         88  AM-HAS-GROUP                     VALUE '2'.
  2081     12  AM-STATUS                         PIC X.
  2082         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  2083         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  2084         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  2085         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  2086         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  2087         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  2088     12  AM-REMIT-TO                       PIC 99.
  2089     12  AM-ID-NO                          PIC X(11).
  2090
  2091     12  AM-CAL-TABLE                      PIC XX.
  2092     12  AM-LF-DEVIATION                   PIC XXX.
  2093     12  AM-AH-DEVIATION                   PIC XXX.
  2094     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2095     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2096     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  2097     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  2098     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2099     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2100
  2101     12  AM-USER-FIELDS.
  2102         16  AM-FLD-1                      PIC XX.
  2103         16  AM-FLD-2                      PIC XX.
  2104         16  AM-FLD-3                      PIC XX.
  2105         16  AM-FLD-4                      PIC XX.
  2106         16  AM-FLD-5                      PIC XX.
  2107
  2108     12  AM-1ST-PROD-DATE.
  2109         16  AM-1ST-PROD-YR                PIC XX.
  2110         16  AM-1ST-PROD-MO                PIC XX.
  2111         16  AM-1ST-PROD-DA                PIC XX.
  2112     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  2113     12  AM-CERTS-PURGED-DATE.
  2114         16  AM-PUR-YR                     PIC XX.
  2115         16  AM-PUR-MO                     PIC XX.
  2116         16  AM-PUR-DA                     PIC XX.
  2117     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  2118     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  2119     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  2120     12  AM-INACTIVE-DATE.
  2121         16  AM-INA-MO                     PIC 99.
  2122         16  AM-INA-DA                     PIC 99.
  2123         16  AM-INA-YR                     PIC 99.
  2124     12  AM-AR-HI-CERT-DATE                PIC XX.
  2125
  2126     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2127     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  39
* EL6318.cbl
  2128
  2129     12  AM-OB-PAYMENT-MODE                PIC X.
  2130         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  2131         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  2132         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  2133         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  2134
  2135     12  AM-AH-ONLY-INDICATOR              PIC X.
  2136         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  2137         88  AM-NO-AH-ONLY                    VALUE 'N'.
  2138
  2139     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  2140
  2141     12  AM-OVER-SHORT.
  2142         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  2143         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  2144
  2145     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  2146     12  AM-DCC-CLP-STATE                  PIC XX.
  2147
  2148     12  AM-RECALC-COMM                    PIC X.
  2149     12  AM-RECALC-REIN                    PIC X.
  2150
  2151     12  AM-REI-TABLE                      PIC XXX.
  2152     12  AM-REI-ET-LF                      PIC X.
  2153     12  AM-REI-ET-AH                      PIC X.
  2154     12  AM-REI-PE-LF                      PIC X.
  2155     12  AM-REI-PE-AH                      PIC X.
  2156     12  AM-REI-PRT-ST                     PIC X.
  2157     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  2158     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  2159     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  2160     12  AM-REI-GROUP-A                    PIC X(6).
  2161     12  AM-REI-MORT                       PIC X(4).
  2162     12  AM-REI-PRT-OW                     PIC X.
  2163     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  2164     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  2165     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  2166     12  AM-REI-GROUP-B                    PIC X(6).
  2167
  2168     12  AM-TRUST-TYPE                     PIC X(2).
  2169
  2170     12  AM-EMPLOYER-STMT-USED             PIC X.
  2171     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  2172
  2173     12  AM-STD-AH-TYPE                    PIC XX.
  2174     12  AM-EARN-METHODS.
  2175         16  AM-EARN-METHOD-R              PIC X.
  2176             88 AM-REF-RL-R78                 VALUE 'R'.
  2177             88 AM-REF-RL-PR                  VALUE 'P'.
  2178             88 AM-REF-RL-MEAN                VALUE 'M'.
  2179             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  2180         16  AM-EARN-METHOD-L              PIC X.
  2181             88 AM-REF-LL-R78                 VALUE 'R'.
  2182             88 AM-REF-LL-PR                  VALUE 'P'.
  2183             88 AM-REF-LL-MEAN                VALUE 'M'.
  2184             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  2185         16  AM-EARN-METHOD-A              PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  40
* EL6318.cbl
  2186             88 AM-REF-AH-R78                 VALUE 'R'.
  2187             88 AM-REF-AH-PR                  VALUE 'P'.
  2188             88 AM-REF-AH-MEAN                VALUE 'M'.
  2189             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  2190             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  2191             88 AM-REF-AH-NET                 VALUE 'N'.
  2192
  2193     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  2194     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  2195     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  2196
  2197     12  AM-RET-Y-N                        PIC X.
  2198     12  AM-RET-P-E                        PIC X.
  2199     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  2200     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  2201     12  AM-RET-GRP                        PIC X(6).
  2202     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  2203         16  AM-POOL-PRIME                 PIC XXX.
  2204         16  AM-POOL-SUB                   PIC XXX.
  2205     12  AM-RETRO-EARNINGS.
  2206         16  AM-RET-EARN-R                 PIC X.
  2207         16  AM-RET-EARN-L                 PIC X.
  2208         16  AM-RET-EARN-A                 PIC X.
  2209     12  AM-RET-ST-TAX-USE                 PIC X.
  2210         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  2211         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  2212     12  AM-RETRO-BEG-EARNINGS.
  2213         16  AM-RET-BEG-EARN-R             PIC X.
  2214         16  AM-RET-BEG-EARN-L             PIC X.
  2215         16  AM-RET-BEG-EARN-A             PIC X.
  2216     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  2217     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  2218
  2219     12  AM-USER-SELECT-OPTIONS.
  2220         16  AM-USER-SELECT-1              PIC X(10).
  2221         16  AM-USER-SELECT-2              PIC X(10).
  2222         16  AM-USER-SELECT-3              PIC X(10).
  2223         16  AM-USER-SELECT-4              PIC X(10).
  2224         16  AM-USER-SELECT-5              PIC X(10).
  2225
  2226     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2227
  2228     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2229
  2230     12  AM-RPT045A-SWITCH                 PIC X.
  2231         88  RPT045A-OFF                   VALUE 'N'.
  2232
  2233     12  AM-INSURANCE-LIMITS.
  2234         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  2235         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  2236
  2237     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  2238         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  2239
  2240     12  AM-DISMBR-COVERAGE-SW             PIC X.
  2241         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  2242         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  2243
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  41
* EL6318.cbl
  2244     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  2245
  2246     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  2247     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  2248     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  2249     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  2250     12  AM-DCC-UEF-STATE                  PIC XX.
  2251     12  FILLER                            PIC XXX.
  2252     12  AM-REPORT-CODE-3                  PIC X(10).
  2253*    12  FILLER                            PIC X(22).
  2254
  2255     12  AM-RESERVE-DATE.
  2256         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  2257         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  2258         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  2259
  2260     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  2261     12  AM-NOTIFICATION-TYPES.
  2262         16  AM-NOTIF-OF-LETTERS           PIC X.
  2263         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  2264         16  AM-NOTIF-OF-REPORTS           PIC X.
  2265         16  AM-NOTIF-OF-STATUS            PIC X.
  2266
  2267     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  2268         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  2269         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  2270         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  2271         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  2272
  2273     12  AM-BENEFIT-CONTROLS.
  2274         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  2275             20  AM-BENEFIT-CODE           PIC XX.
  2276             20  AM-BENEFIT-TYPE           PIC X.
  2277             20  AM-BENEFIT-REVISION       PIC XXX.
  2278             20  AM-BENEFIT-REM-TERM       PIC X.
  2279             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  2280             20  FILLER                    PIC XX.
  2281         16  FILLER                        PIC X(80).
  2282
  2283     12  AM-TRANSFER-DATA.
  2284         16  AM-TRANSFERRED-FROM.
  2285             20  AM-TRNFROM-CARRIER        PIC X.
  2286             20  AM-TRNFROM-GROUPING.
  2287                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  2288                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  2289             20  AM-TRNFROM-STATE          PIC XX.
  2290             20  AM-TRNFROM-ACCOUNT.
  2291                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  2292                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  2293             20  AM-TRNFROM-DTE            PIC XX.
  2294         16  AM-TRANSFERRED-TO.
  2295             20  AM-TRNTO-CARRIER          PIC X.
  2296             20  AM-TRNTO-GROUPING.
  2297                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  2298                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  2299             20  AM-TRNTO-STATE            PIC XX.
  2300             20  AM-TRNTO-ACCOUNT.
  2301                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  42
* EL6318.cbl
  2302                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  2303             20  AM-TRNTO-DTE              PIC XX.
  2304         16  FILLER                        PIC X(10).
  2305
  2306     12  AM-SAVED-REMIT-TO                 PIC 99.
  2307
  2308     12  AM-COMM-STRUCTURE-SAVED.
  2309         16  AM-DEFN-1-SAVED.
  2310             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  2311                 24  AM-AGT-SV             PIC X(10).
  2312                 24  AM-COM-TYP-SV         PIC X.
  2313                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  2314                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  2315                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  2316                 24  AM-RECALC-LV-INDIC-SV PIC X.
  2317                 24  FILLER                PIC X.
  2318                 24  AM-GL-CODES-SV        PIC X.
  2319                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  2320                 24  FILLER                PIC X.
  2321         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  2322             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  2323                 24  FILLER                PIC X(11).
  2324                 24  AM-L-COMA-SV          PIC XXX.
  2325                 24  AM-J-COMA-SV          PIC XXX.
  2326                 24  AM-A-COMA-SV          PIC XXX.
  2327                 24  FILLER                PIC X(6).
  2328
  2329     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  2330         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  2331            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  2332            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  2333            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  2334
  2335     12  AM-ORIG-DEALER-NO                 PIC X(10).
  2336     12  FILLER                            PIC X(120).
  2337
  2338     12  AM-ACCOUNT-EXECUTIVE-DATA.
  2339         16  AM-CONTROL-NAME               PIC X(30).
  2340         16  AM-EXECUTIVE-ONE.
  2341             20  AM-EXEC1-NAME             PIC X(15).
  2342             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  2343                                                          COMP-3.
  2344             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  2345                                                          COMP-3.
  2346         16  AM-EXECUTIVE-TWO.
  2347             20  AM-EXEC2-NAME             PIC X(15).
  2348             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  2349                                                          COMP-3.
  2350             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  2351                                                          COMP-3.
  2352
  2353     12  AM-RETRO-ADDITIONAL-DATA.
  2354         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  2355         16  AM-RETRO-PREM-P-E             PIC X.
  2356         16  AM-RETRO-CLMS-P-I             PIC X.
  2357         16  AM-RETRO-RET-BRACKET-LF.
  2358             20  AM-RETRO-RET-METHOD-LF    PIC X.
  2359                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  43
* EL6318.cbl
  2360                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  2361             20  AM-RETRO-RET-BASIS-LF     PIC X.
  2362                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  2363                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  2364             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  2365                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  2366                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  2367         16  AM-RETRO-RET-BRACKET-AH.
  2368             20  AM-RETRO-RET-METHOD-AH    PIC X.
  2369                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  2370                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  2371                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  2372             20  AM-RETRO-RET-BASIS-AH     PIC X.
  2373                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  2374                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  2375             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  2376                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  2377                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  2378
  2379     12  AM-COMMENTS.
  2380         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  2381
  2382     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  2383         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  2384         16  AM-FLI-BILLING-CODE           PIC X.
  2385         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  2386         16  AM-FLI-UNITED-IDENT           PIC X.
  2387         16  AM-FLI-INTEREST-LOST-DATA.
  2388             20  AM-FLI-BANK-NO            PIC X(5).
  2389             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  2390             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  2391             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  2392         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  2393             20  AM-FLI-AGT                PIC X(9).
  2394             20  AM-FLI-AGT-COMM-ACC       PIC X.
  2395             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  2396         16  FILLER                        PIC X(102).
  2397
  2398     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  2399         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  2400             20  AM-BENEFIT-DMD-CODE         PIC XX.
  2401             20  AM-BENEFIT-DMD-TYPE         PIC X.
  2402             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  2403             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  2404             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  2405         16  FILLER                          PIC X(10).
  2406******************************************************************
  2407*                                COPY ELCCNTL.
  2408******************************************************************
  2409*                                                                *
  2410*                                                                *
  2411*                            ELCCNTL.                            *
  2412*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2413*                            VMOD=2.059                          *
  2414*                                                                *
  2415*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  2416*                                                                *
  2417*   FILE TYPE = VSAM,KSDS                                        *
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  44
* EL6318.cbl
  2418*   RECORD SIZE = 750  RECFORM = FIXED                           *
  2419*                                                                *
  2420*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  2421*       ALTERNATE INDEX = NONE                                   *
  2422*                                                                *
  2423*   LOG = YES                                                    *
  2424*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2425******************************************************************
  2426*                   C H A N G E   L O G
  2427*
  2428* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2429*-----------------------------------------------------------------
  2430*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2431* EFFECTIVE    NUMBER
  2432*-----------------------------------------------------------------
  2433* 082503                   PEMA  ADD BENEFIT GROUP
  2434* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2435* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2436* 092705    2005050300006  PEMA  ADD SPP LEASES
  2437* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  2438* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  2439* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  2440* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  2441* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  2442* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2443******************************************************************
  2444*
  2445 01  CONTROL-FILE.
  2446     12  CF-RECORD-ID                       PIC XX.
  2447         88  VALID-CF-ID                        VALUE 'CF'.
  2448
  2449     12  CF-CONTROL-PRIMARY.
  2450         16  CF-COMPANY-ID                  PIC XXX.
  2451         16  CF-RECORD-TYPE                 PIC X.
  2452             88  CF-COMPANY-MASTER              VALUE '1'.
  2453             88  CF-PROCESSOR-MASTER            VALUE '2'.
  2454             88  CF-STATE-MASTER                VALUE '3'.
  2455             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  2456             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  2457             88  CF-CARRIER-MASTER              VALUE '6'.
  2458             88  CF-MORTALITY-MASTER            VALUE '7'.
  2459             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  2460             88  CF-TERMINAL-MASTER             VALUE '9'.
  2461             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  2462             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  2463             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  2464             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  2465             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  2466             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  2467             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  2468             88  CF-REMINDERS-MASTER            VALUE 'R'.
  2469             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  2470         16  CF-ACCESS-CD-GENL              PIC X(4).
  2471         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  2472             20  CF-PROCESSOR               PIC X(4).
  2473         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  2474             20  CF-STATE-CODE              PIC XX.
  2475             20  FILLER                     PIC XX.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  45
* EL6318.cbl
  2476         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  2477             20  FILLER                     PIC XX.
  2478             20  CF-HI-BEN-IN-REC           PIC XX.
  2479         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  2480             20  FILLER                     PIC XXX.
  2481             20  CF-CARRIER-CNTL            PIC X.
  2482         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  2483             20  FILLER                     PIC XX.
  2484             20  CF-HI-TYPE-IN-REC          PIC 99.
  2485         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  2486             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  2487                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  2488             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  2489             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  2490         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  2491             20  FILLER                     PIC X.
  2492             20  CF-CUSTOM-REPORT-NO        PIC 999.
  2493         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  2494             20  FILLER                     PIC XX.
  2495             20  CF-MORTGAGE-PLAN           PIC XX.
  2496         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  2497
  2498     12  CF-LAST-MAINT-DT                   PIC XX.
  2499     12  CF-LAST-MAINT-BY                   PIC X(4).
  2500     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2501
  2502     12  CF-RECORD-BODY                     PIC X(728).
  2503
  2504
  2505****************************************************************
  2506*             COMPANY MASTER RECORD                            *
  2507****************************************************************
  2508
  2509     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2510         16  CF-COMPANY-ADDRESS.
  2511             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  2512             20  CF-CL-IN-CARE-OF           PIC X(30).
  2513             20  CF-CL-ADDR-LINE-1          PIC X(30).
  2514             20  CF-CL-ADDR-LINE-2          PIC X(30).
  2515             20  CF-CL-CITY-STATE           PIC X(30).
  2516             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  2517             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  2518         16  CF-COMPANY-CD                  PIC X.
  2519         16  CF-COMPANY-PASSWORD            PIC X(8).
  2520         16  CF-SECURITY-OPTION             PIC X.
  2521             88  ALL-SECURITY                   VALUE '1'.
  2522             88  COMPANY-VERIFY                 VALUE '2'.
  2523             88  PROCESSOR-VERIFY               VALUE '3'.
  2524             88  NO-SECURITY                    VALUE '4'.
  2525             88  ALL-BUT-TERM                   VALUE '5'.
  2526         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  2527             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  2528         16  CF-LGX-INTERFACE-CNTL          PIC X.
  2529             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  2530         16  CF-INFORCE-LOCATION            PIC X.
  2531             88  CERTS-ARE-ONLINE               VALUE '1'.
  2532             88  CERTS-ARE-OFFLINE              VALUE '2'.
  2533             88  NO-CERTS-AVAILABLE             VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  46
* EL6318.cbl
  2534         16  CF-LOWER-CASE-LETTERS          PIC X.
  2535         16  CF-CERT-ACCESS-CONTROL         PIC X.
  2536             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  2537             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2538             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  2539             88  CF-ACCNT-CNTL                  VALUE '3'.
  2540             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  2541
  2542         16  CF-FORMS-PRINTER-ID            PIC X(4).
  2543         16  CF-CHECK-PRINTER-ID            PIC X(4).
  2544
  2545         16  CF-LGX-CREDIT-USER             PIC X.
  2546             88  CO-IS-NOT-USER                 VALUE 'N'.
  2547             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  2548
  2549         16 CF-CREDIT-CALC-CODES.
  2550             20  CF-CR-REM-TERM-CALC PIC X.
  2551               88  CR-EARN-AFTER-15TH           VALUE '1'.
  2552               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  2553               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  2554               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  2555               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  2556               88  CR-EARN-AFTER-14TH           VALUE '6'.
  2557               88  CR-EARN-AFTER-16TH           VALUE '7'.
  2558             20  CF-CR-R78-METHOD           PIC X.
  2559               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  2560               88  DONT-USE-PLUS-ONE            VALUE '1'.
  2561
  2562         16  CF-CLAIM-CONTROL-COUNTS.
  2563             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  2564                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  2565
  2566             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  2567                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  2568
  2569             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  2570                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  2571
  2572             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  2573                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  2574
  2575         16  CF-CURRENT-MONTH-END           PIC XX.
  2576
  2577         16  CF-CO-CALC-QUOTE-TOLERANCE.
  2578             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  2579             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  2580             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  2581             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  2582                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2583                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2584             20  CF-CO-PREM-REJECT-SW       PIC X.
  2585                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  2586                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  2587             20  CF-CO-REF-REJECT-SW        PIC X.
  2588                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  2589                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  2590
  2591         16  CF-CO-REPORTING-DT             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  47
* EL6318.cbl
  2592         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  2593         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  2594           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  2595           88  CF-CO-MONTH-END                  VALUE '1'.
  2596
  2597         16  CF-LGX-CLAIM-USER              PIC X.
  2598             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  2599             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  2600
  2601         16  CF-CREDIT-EDIT-CONTROLS.
  2602             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  2603             20  CF-MIN-AGE                 PIC 99.
  2604             20  CF-DEFAULT-AGE             PIC 99.
  2605             20  CF-MIN-TERM                PIC S999      COMP-3.
  2606             20  CF-MAX-TERM                PIC S999      COMP-3.
  2607             20  CF-DEFAULT-SEX             PIC X.
  2608             20  CF-JOINT-AGE-INPUT         PIC X.
  2609                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  2610             20  CF-BIRTH-DATE-INPUT        PIC X.
  2611                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  2612             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  2613                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  2614                 88  CF-ZERO-CARRIER            VALUE '1'.
  2615                 88  CF-ZERO-GROUPING           VALUE '2'.
  2616                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  2617             20  CF-EDIT-SW                 PIC X.
  2618                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  2619             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  2620             20  CF-CR-PR-METHOD            PIC X.
  2621               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  2622               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  2623             20  FILLER                     PIC X.
  2624
  2625         16  CF-CREDIT-MISC-CONTROLS.
  2626             20  CF-REIN-TABLE-SW           PIC X.
  2627                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  2628             20  CF-COMP-TABLE-SW           PIC X.
  2629                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  2630             20  CF-EXPERIENCE-RETENTION-AGE
  2631                                            PIC S9        COMP-3.
  2632             20  CF-CONVERSION-DT           PIC XX.
  2633             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  2634             20  CF-RUN-FREQUENCY-SW        PIC X.
  2635                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  2636                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  2637
  2638             20  CF-CR-CHECK-NO-CONTROL.
  2639                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  2640                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  2641                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  2642                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  2643                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  2644                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  2645
  2646                 24  CF-CR-CHECK-COUNT       REDEFINES
  2647                     CF-CR-CHECK-COUNTER      PIC X(4).
  2648
  2649                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  48
* EL6318.cbl
  2650                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  2651
  2652                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  2653                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  2654                 24  CF-MAIL-PROCESSING       PIC X.
  2655                     88  MAIL-PROCESSING          VALUE 'Y'.
  2656
  2657         16  CF-MISC-SYSTEM-CONTROL.
  2658             20  CF-SYSTEM-C                 PIC X.
  2659                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  2660             20  CF-SYSTEM-D                 PIC X.
  2661                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  2662             20  CF-SOC-SEC-NO-SW            PIC X.
  2663                 88  SOC-SEC-NO-USED             VALUE '1'.
  2664             20  CF-MEMBER-NO-SW             PIC X.
  2665                 88  MEMBER-NO-USED              VALUE '1'.
  2666             20  CF-TAX-ID-NUMBER            PIC X(11).
  2667             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  2668             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  2669                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  2670                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  2671                 88  CF-ALL-APPROVED             VALUE 'Y'.
  2672                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  2673             20  CF-SYSTEM-E                 PIC X.
  2674                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  2675
  2676         16  CF-LGX-LIFE-USER               PIC X.
  2677             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  2678             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  2679
  2680         16  CF-CR-MONTH-END-DT             PIC XX.
  2681
  2682         16  CF-FILE-MAINT-DATES.
  2683             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  2684                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  2685             20  CF-LAST-BATCH       REDEFINES
  2686                 CF-LAST-BATCH-NO               PIC X(4).
  2687             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  2688             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  2689             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  2690             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  2691             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  2692             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  2693             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  2694             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  2695             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  2696             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  2697
  2698         16  CF-NEXT-COMPANY-ID             PIC XXX.
  2699         16  FILLER                         PIC X.
  2700
  2701         16  CF-ALT-MORT-CODE               PIC X(4).
  2702         16  CF-MEMBER-CAPTION              PIC X(10).
  2703
  2704         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  2705             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  2706             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  2707             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  49
* EL6318.cbl
  2708             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  2709             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  2710
  2711         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  2712
  2713         16  CF-LIFE-OVERRIDE-L1            PIC X.
  2714         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  2715         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  2716         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  2717
  2718         16  CF-AH-OVERRIDE-L1              PIC X.
  2719         16  CF-AH-OVERRIDE-L2              PIC XX.
  2720         16  CF-AH-OVERRIDE-L6              PIC X(6).
  2721         16  CF-AH-OVERRIDE-L12             PIC X(12).
  2722
  2723         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  2724         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  2725
  2726         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  2727         16  CF-AR-LAST-EL860-DT            PIC XX.
  2728         16  CF-MP-MONTH-END-DT             PIC XX.
  2729
  2730         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  2731         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  2732             88  CF-CLAIM-PAID-TO               VALUE '1'.
  2733
  2734         16  CF-AR-MONTH-END-DT             PIC XX.
  2735
  2736         16  CF-CRDTCRD-USER                PIC X.
  2737             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  2738             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  2739
  2740         16  CF-CC-MONTH-END-DT             PIC XX.
  2741
  2742         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  2743
  2744         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  2745             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  2746             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  2747             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  2748         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  2749         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  2750         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  2751         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  2752             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  2753             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  2754         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  2755         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  2756         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  2757             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  2758         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  2759
  2760         16  CF-CL-ZIP-CODE.
  2761             20  CF-CL-ZIP-PRIME.
  2762                 24  CF-CL-ZIP-1ST          PIC X.
  2763                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  2764                 24  FILLER                 PIC X(4).
  2765             20  CF-CL-ZIP-PLUS4            PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  50
* EL6318.cbl
  2766         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  2767             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  2768             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  2769             20  FILLER                     PIC XXX.
  2770
  2771         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  2772         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  2773         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  2774         16  CF-CO-OPTION-START-DATE        PIC XX.
  2775         16  CF-REM-TRM-CALC-OPTION         PIC X.
  2776           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  2777                                                      '3' '4'.
  2778           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  2779           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  2780           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  2781           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  2782           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  2783           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  2784
  2785         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  2786
  2787         16  CF-PAYMENT-APPROVAL-LEVELS.
  2788             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  2789             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  2790             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  2791             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  2792             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  2793             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  2794
  2795         16  CF-END-USER-REPORTING-USER     PIC X.
  2796             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  2797             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  2798
  2799         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  2800             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  2801             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  2802
  2803         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  2804
  2805         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  2806         16  FILLER                         PIC X.
  2807
  2808         16  CF-CREDIT-ARCHIVE-CNTL.
  2809             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  2810             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  2811             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  2812
  2813         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  2814
  2815         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  2816             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  2817             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  2818
  2819         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  2820             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  2821             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  2822
  2823         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  51
* EL6318.cbl
  2824
  2825         16  CF-CO-ACH-ID-CODE              PIC  X.
  2826             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  2827             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  2828             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  2829         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  2830         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  2831         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  2832         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  2833         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  2834         16  CF-CO-ACH-RECV-NO              PIC X(08).
  2835         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  2836         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  2837         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  2838                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  2839         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  2840                 CF-CO-ACH-TRACE-NO         PIC X(4).
  2841
  2842         16  CF-CO-OVER-SHORT.
  2843             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2844             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2845
  2846*         16  FILLER                         PIC X(102).
  2847         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  2848             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  2849             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  2850
  2851         16  CF-AH-APPROVAL-DAYS.
  2852             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  2853             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  2854             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  2855             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  2856
  2857         16  FILLER                         PIC X(82).
  2858****************************************************************
  2859*             PROCESSOR/USER RECORD                            *
  2860****************************************************************
  2861
  2862     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2863         16  CF-PROCESSOR-NAME              PIC X(30).
  2864         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  2865         16  CF-PROCESSOR-TITLE             PIC X(26).
  2866         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  2867                 88  MESSAGE-YES                VALUE 'Y'.
  2868                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  2869
  2870*****************************************************
  2871****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  2872****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  2873****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  2874****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  2875*****************************************************
  2876
  2877         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  2878             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  2879             20  CF-APPLICATION-FORCE       PIC X.
  2880             20  CF-INDIVIDUAL-APP.
  2881                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  52
* EL6318.cbl
  2882                     28  CF-BROWSE-APP      PIC X.
  2883                     28  CF-UPDATE-APP      PIC X.
  2884
  2885         16  CF-CURRENT-TERM-ON             PIC X(4).
  2886         16  CF-PROCESSOR-LIMITS-CLAIMS.
  2887             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  2888             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  2889             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  2890             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  2891             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  2892             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  2893             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  2894         16  CF-PROCESSOR-CARRIER           PIC X.
  2895             88  NO-CARRIER-SECURITY            VALUE ' '.
  2896         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  2897             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  2898         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  2899             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  2900         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  2901             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  2902
  2903         16  CF-PROC-SYS-ACCESS-SW.
  2904             20  CF-PROC-CREDIT-CLAIMS-SW.
  2905                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  2906                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  2907                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  2908                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  2909             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  2910                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  2911                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  2912             20  CF-PROC-LIFE-GNRLDGR-SW.
  2913                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  2914                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  2915                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  2916                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  2917             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  2918                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  2919                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  2920         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  2921             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  2922             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  2923         16  CF-PROCESSOR-PRINTER               PIC X(4).
  2924
  2925         16  CF-APPROVAL-LEVEL                  PIC X.
  2926             88  APPROVAL-LEVEL-1                   VALUE '1'.
  2927             88  APPROVAL-LEVEL-2                   VALUE '2'.
  2928             88  APPROVAL-LEVEL-3                   VALUE '3'.
  2929             88  APPROVAL-LEVEL-4                   VALUE '4'.
  2930
  2931         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  2932
  2933         16  CF-LANGUAGE-TYPE                   PIC X.
  2934             88  CF-LANG-IS-ENG                     VALUE 'E'.
  2935             88  CF-LANG-IS-FR                      VALUE 'F'.
  2936
  2937         16  CF-CSR-IND                         PIC X.
  2938         16  FILLER                             PIC X(239).
  2939
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  53
* EL6318.cbl
  2940****************************************************************
  2941*             PROCESSOR/REMINDERS RECORD                       *
  2942****************************************************************
  2943
  2944     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  2945         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  2946             20  CF-START-REMIND-DT         PIC XX.
  2947             20  CF-END-REMIND-DT           PIC XX.
  2948             20  CF-REMINDER-TEXT           PIC X(50).
  2949         16  FILLER                         PIC X(296).
  2950
  2951
  2952****************************************************************
  2953*             STATE MASTER RECORD                              *
  2954****************************************************************
  2955
  2956     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2957         16  CF-STATE-ABBREVIATION          PIC XX.
  2958         16  CF-STATE-NAME                  PIC X(25).
  2959         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  2960         16  CF-ST-CALC-QUOTE-TOLERANCE.
  2961             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  2962             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  2963             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  2964             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  2965                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2966                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2967             20  CF-ST-PREM-REJECT-SW       PIC X.
  2968                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  2969                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  2970             20  CF-ST-REF-REJECT-SW        PIC X.
  2971                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  2972                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  2973         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  2974         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  2975         16  CF-ST-REFUND-RULES.
  2976             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  2977             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  2978             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  2979         16  CF-ST-FST-PMT-EXTENSION.
  2980             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  2981             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  2982                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  2983                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  2984                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  2985                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  2986         16  CF-ST-STATE-CALL.
  2987             20  CF-ST-CALL-UNEARNED        PIC X.
  2988             20  CF-ST-CALL-RPT-CNTL        PIC X.
  2989             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  2990         16  CF-REPLACEMENT-LAW-SW          PIC X.
  2991             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  2992             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  2993         16  CF-REPLACEMENT-LETTER          PIC X(4).
  2994         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  2995         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  2996         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  2997         16  CF-ST-SPLIT-PAYMENT            PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  54
* EL6318.cbl
  2998         16  FILLER                         PIC X.
  2999         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  3000             20  CF-ST-BENEFIT-CD           PIC XX.
  3001             20  CF-ST-BENEFIT-KIND         PIC X.
  3002                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  3003                 88  CF-ST-AH-KIND              VALUE 'A'.
  3004             20  CF-ST-REM-TERM-CALC        PIC X.
  3005                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  3006                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  3007                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  3008                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  3009                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  3010                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  3011                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  3012                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  3013
  3014             20  CF-ST-REFUND-CALC          PIC X.
  3015                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  3016                 88  ST-REFD-BY-R78             VALUE '1'.
  3017                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  3018                 88  ST-REFD-AS-CALIF           VALUE '3'.
  3019                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  3020                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  3021                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  3022                 88  ST-REFD-UTAH               VALUE '7'.
  3023                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  3024                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  3025                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  3026
  3027             20  CF-ST-EARNING-CALC         PIC X.
  3028                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  3029                 88  ST-EARN-BY-R78             VALUE '1'.
  3030                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  3031                 88  ST-EARN-AS-CALIF           VALUE '3'.
  3032                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  3033                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  3034                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  3035                 88  ST-EARN-MEAN               VALUE '8'.
  3036                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  3037
  3038             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  3039                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  3040                 88  ST-OVRD-BY-R78             VALUE '1'.
  3041                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  3042                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  3043                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  3044                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  3045                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  3046                 88  ST-OVRD-MEAN               VALUE '8'.
  3047                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  3048             20  FILLER                     PIC X.
  3049
  3050         16  CF-ST-COMMISSION-CAPS.
  3051             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  3052             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  3053             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  3054             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  3055         16  CF-COMM-CAP-LIMIT-TO           PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  55
* EL6318.cbl
  3056                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  3057
  3058         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  3059
  3060         16  CF-ST-STATUTORY-INTEREST.
  3061             20  CF-ST-STAT-DATE-FROM       PIC X.
  3062                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  3063                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  3064             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  3065             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  3066             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  3067             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  3068             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  3069
  3070         16  CF-ST-OVER-SHORT.
  3071             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  3072             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  3073
  3074         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  3075
  3076         16  CF-ST-RT-CALC                  PIC X.
  3077
  3078         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  3079         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  3080         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  3081         16  CF-ST-RF-LR-CALC               PIC X.
  3082         16  CF-ST-RF-LL-CALC               PIC X.
  3083         16  CF-ST-RF-LN-CALC               PIC X.
  3084         16  CF-ST-RF-AH-CALC               PIC X.
  3085         16  CF-ST-RF-CP-CALC               PIC X.
  3086*        16  FILLER                         PIC X(206).
  3087*CIDMOD         16  FILLER                         PIC X(192).
  3088         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  3089             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  3090         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  3091         16  CF-ST-VFY-2ND-BENE             PIC X.
  3092         16  FILLER                         PIC X(186).
  3093
  3094****************************************************************
  3095*             BENEFIT MASTER RECORD                            *
  3096****************************************************************
  3097
  3098     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3099         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  3100             20  CF-BENEFIT-CODE            PIC XX.
  3101             20  CF-BENEFIT-NUMERIC  REDEFINES
  3102                 CF-BENEFIT-CODE            PIC XX.
  3103             20  CF-BENEFIT-ALPHA           PIC XXX.
  3104             20  CF-BENEFIT-DESCRIP         PIC X(10).
  3105             20  CF-BENEFIT-COMMENT         PIC X(10).
  3106
  3107             20  CF-LF-COVERAGE-TYPE        PIC X.
  3108                 88  CF-REDUCING                VALUE 'R'.
  3109                 88  CF-LEVEL                   VALUE 'L' 'P'.
  3110
  3111             20  CF-SPECIAL-CALC-CD         PIC X.
  3112                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  3113                 88  CF-NP-0-MO-INT             VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  56
* EL6318.cbl
  3114                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  3115                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  3116                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  3117                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  3118                 88  CF-FARM-PLAN               VALUE 'F'.
  3119                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  3120                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  3121                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  3122                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  3123                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  3124                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  3125                 88  CF-PRUDENTIAL              VALUE 'P'.
  3126                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  3127                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  3128                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  3129                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  3130                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  3131                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  3132
  3133             20  CF-JOINT-INDICATOR         PIC X.
  3134                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  3135
  3136*            20  FILLER                     PIC X(12).
  3137             20  FILLER                     PIC X(11).
  3138             20  CF-BENEFIT-CATEGORY        PIC X.
  3139             20  CF-LOAN-TYPE               PIC X(8).
  3140
  3141             20  CF-CO-REM-TERM-CALC        PIC X.
  3142                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  3143                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  3144                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  3145                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  3146                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  3147
  3148             20  CF-CO-EARNINGS-CALC        PIC X.
  3149                 88  CO-EARN-BY-R78             VALUE '1'.
  3150                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  3151                 88  CO-EARN-AS-CALIF           VALUE '3'.
  3152                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  3153                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  3154                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  3155                 88  CO-EARN-AS-MEAN            VALUE '8'.
  3156                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  3157
  3158             20  CF-CO-REFUND-CALC          PIC X.
  3159                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  3160                 88  CO-REFD-BY-R78             VALUE '1'.
  3161                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  3162                 88  CO-REFD-AS-CALIF           VALUE '3'.
  3163                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  3164                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  3165                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  3166                 88  CO-REFD-MEAN               VALUE '8'.
  3167                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  3168                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  3169                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  3170
  3171             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  57
* EL6318.cbl
  3172                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  3173                 88  CO-OVRD-BY-R78             VALUE '1'.
  3174                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  3175                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  3176                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  3177                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  3178                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  3179                 88  CO-OVRD-MEAN               VALUE '8'.
  3180                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  3181
  3182             20  CF-CO-BEN-I-G-CD           PIC X.
  3183                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  3184                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  3185                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  3186
  3187         16  FILLER                         PIC X(304).
  3188
  3189
  3190****************************************************************
  3191*             CARRIER MASTER RECORD                            *
  3192****************************************************************
  3193
  3194     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3195         16  CF-ADDRESS-DATA.
  3196             20  CF-MAIL-TO-NAME            PIC X(30).
  3197             20  CF-IN-CARE-OF              PIC X(30).
  3198             20  CF-ADDRESS-LINE-1          PIC X(30).
  3199             20  CF-ADDRESS-LINE-2          PIC X(30).
  3200             20  CF-CITY-STATE              PIC X(30).
  3201             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  3202             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  3203
  3204         16  CF-CLAIM-NO-CONTROL.
  3205             20  CF-CLAIM-NO-METHOD         PIC X.
  3206                 88  CLAIM-NO-MANUAL            VALUE '1'.
  3207                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  3208                 88  CLAIM-NO-SEQ               VALUE '3'.
  3209                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  3210             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  3211                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  3212                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  3213                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  3214
  3215         16  CF-CHECK-NO-CONTROL.
  3216             20  CF-CHECK-NO-METHOD         PIC X.
  3217                 88  CHECK-NO-MANUAL            VALUE '1'.
  3218                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  3219                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  3220                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  3221             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  3222                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  3223
  3224         16  CF-DOMICILE-STATE              PIC XX.
  3225
  3226         16  CF-EXPENSE-CONTROLS.
  3227             20  CF-EXPENSE-METHOD          PIC X.
  3228                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  3229                 88  DOLLARS-PER-PMT            VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  58
* EL6318.cbl
  3230                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  3231                 88  DOLLARS-PER-MONTH          VALUE '4'.
  3232             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  3233             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  3234
  3235         16  CF-CORRESPONDENCE-CONTROL.
  3236             20  CF-LETTER-RESEND-OPT       PIC X.
  3237                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  3238                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  3239             20  FILLER                     PIC X(4).
  3240
  3241         16  CF-RESERVE-CONTROLS.
  3242             20  CF-MANUAL-SW               PIC X.
  3243                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  3244             20  CF-FUTURE-SW               PIC X.
  3245                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  3246             20  CF-PTC-SW                  PIC X.
  3247                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  3248             20  CF-IBNR-SW                 PIC X.
  3249                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  3250             20  CF-PTC-LF-SW               PIC X.
  3251                 88  CF-LF-PTC-USED             VALUE '1'.
  3252             20  CF-CDT-ACCESS-METHOD       PIC X.
  3253                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  3254                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  3255                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  3256             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  3257
  3258         16  CF-CLAIM-CALC-METHOD           PIC X.
  3259             88  360-PLUS-MONTHS                VALUE '1'.
  3260             88  365-PLUS-MONTHS                VALUE '2'.
  3261             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  3262             88  360-DAILY                      VALUE '4'.
  3263             88  365-DAILY                      VALUE '5'.
  3264
  3265         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  3266         16  FILLER                         PIC X(11).
  3267
  3268         16  CF-LIMIT-AMOUNTS.
  3269             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  3270             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  3271             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  3272             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  3273             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  3274             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  3275             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  3276             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  3277             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  3278             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  3279
  3280         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  3281         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  3282         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  3283
  3284         16  CF-ZIP-CODE.
  3285             20  CF-ZIP-PRIME.
  3286                 24  CF-ZIP-1ST             PIC X.
  3287                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  59
* EL6318.cbl
  3288                 24  FILLER                 PIC X(4).
  3289             20  CF-ZIP-PLUS4               PIC X(4).
  3290         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  3291             20  CF-CAN-POSTAL-1            PIC XXX.
  3292             20  CF-CAN-POSTAL-2            PIC XXX.
  3293             20  FILLER                     PIC XXX.
  3294
  3295         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  3296         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  3297         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  3298
  3299         16  CF-RATING-SWITCH               PIC X.
  3300             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  3301             88  CF-NO-RATING                   VALUE 'N'.
  3302
  3303         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  3304
  3305         16  CF-CARRIER-OVER-SHORT.
  3306             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3307             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3308
  3309         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  3310         16  CF-SECPAY-SWITCH               PIC X.
  3311             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  3312             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  3313         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  3314         16  FILLER                         PIC X(448).
  3315*        16  FILLER                         PIC X(452).
  3316
  3317
  3318****************************************************************
  3319*             MORTALITY MASTER RECORD                          *
  3320****************************************************************
  3321
  3322     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3323         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  3324                                INDEXED BY CF-MORT-NDX.
  3325             20  CF-MORT-TABLE              PIC X(5).
  3326             20  CF-MORT-TABLE-TYPE         PIC X.
  3327                 88  CF-MORT-JOINT              VALUE 'J'.
  3328                 88  CF-MORT-SINGLE             VALUE 'S'.
  3329                 88  CF-MORT-COMBINED           VALUE 'C'.
  3330                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  3331                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  3332             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  3333             20  CF-MORT-AGE-METHOD         PIC XX.
  3334                 88  CF-AGE-LAST                VALUE 'AL'.
  3335                 88  CF-AGE-NEAR                VALUE 'AN'.
  3336             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  3337             20  CF-MORT-ADJUSTMENT-DIRECTION
  3338                                            PIC X.
  3339                 88  CF-MINUS                   VALUE '-'.
  3340                 88  CF-PLUS                    VALUE '+'.
  3341             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  3342             20  CF-MORT-JOINT-CODE         PIC X.
  3343                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  3344             20  CF-MORT-PC-Q               PIC X.
  3345                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  60
* EL6318.cbl
  3346             20  CF-MORT-TABLE-CODE         PIC X(4).
  3347             20  CF-MORT-COMMENTS           PIC X(15).
  3348             20  FILLER                     PIC X(14).
  3349
  3350         16  FILLER                         PIC X(251).
  3351
  3352
  3353****************************************************************
  3354*             BUSSINESS TYPE MASTER RECORD                     *
  3355****************************************************************
  3356
  3357     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3358* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  3359* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  3360* AND RECORD 05 IS TYPES 81-99
  3361         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  3362             20  CF-BUSINESS-TITLE          PIC  X(19).
  3363             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  3364                                            PIC S9V9(4) COMP-3.
  3365             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  3366             20  FILLER                     PIC  X.
  3367         16  FILLER                         PIC  X(248).
  3368
  3369
  3370****************************************************************
  3371*             TERMINAL MASTER RECORD                           *
  3372****************************************************************
  3373
  3374     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3375
  3376         16  CF-COMPANY-TERMINALS.
  3377             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  3378                                  PIC X(4).
  3379         16  FILLER               PIC X(248).
  3380
  3381
  3382****************************************************************
  3383*             LIFE EDIT MASTER RECORD                          *
  3384****************************************************************
  3385
  3386     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3387         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  3388             20  CF-LIFE-CODE-IN            PIC XX.
  3389             20  CF-LIFE-CODE-OUT           PIC XX.
  3390         16  FILLER                         PIC X(248).
  3391
  3392
  3393****************************************************************
  3394*             AH EDIT MASTER RECORD                            *
  3395****************************************************************
  3396
  3397     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3398         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  3399             20  CF-AH-CODE-IN              PIC XXX.
  3400             20  CF-AH-CODE-OUT             PIC XX.
  3401         16  FILLER                         PIC X(248).
  3402
  3403
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  61
* EL6318.cbl
  3404****************************************************************
  3405*             CREDIBILITY TABLES                               *
  3406****************************************************************
  3407
  3408     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3409         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  3410                             INDEXED BY CF-CRDB-NDX.
  3411             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  3412             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  3413             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  3414         16  FILLER                         PIC  X(332).
  3415
  3416
  3417****************************************************************
  3418*             REPORT CUSTOMIZATION RECORD                      *
  3419****************************************************************
  3420
  3421     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  3422         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  3423             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  3424             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  3425             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  3426**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  3427****       A T-TRANSFER.                                   ****
  3428             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  3429
  3430         16  FILLER                         PIC XX.
  3431
  3432         16  CF-CARRIER-CNTL-OPT.
  3433             20  CF-CARRIER-OPT-SEQ         PIC 9.
  3434                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  3435                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  3436             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  3437                                            PIC X.
  3438         16  CF-GROUP-CNTL-OPT.
  3439             20  CF-GROUP-OPT-SEQ           PIC 9.
  3440                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  3441                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  3442             20  CF-GROUP-SELECT OCCURS 3 TIMES
  3443                                            PIC X(6).
  3444         16  CF-STATE-CNTL-OPT.
  3445             20  CF-STATE-OPT-SEQ           PIC 9.
  3446                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  3447                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  3448             20  CF-STATE-SELECT OCCURS 3 TIMES
  3449                                            PIC XX.
  3450         16  CF-ACCOUNT-CNTL-OPT.
  3451             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  3452                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  3453                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  3454             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  3455                                            PIC X(10).
  3456         16  CF-BUS-TYP-CNTL-OPT.
  3457             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  3458                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  3459                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  3460             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  3461                                            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  62
* EL6318.cbl
  3462         16  CF-LF-TYP-CNTL-OPT.
  3463             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  3464                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  3465                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  3466             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  3467                                            PIC XX.
  3468         16  CF-AH-TYP-CNTL-OPT.
  3469             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  3470                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  3471                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  3472             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  3473                                            PIC XX.
  3474         16  CF-REPTCD1-CNTL-OPT.
  3475             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  3476                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  3477                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  3478             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  3479                                            PIC X(10).
  3480         16  CF-REPTCD2-CNTL-OPT.
  3481             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  3482                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  3483                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  3484             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  3485                                            PIC X(10).
  3486         16  CF-USER1-CNTL-OPT.
  3487             20  CF-USER1-OPT-SEQ           PIC 9.
  3488                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  3489                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  3490             20  CF-USER1-SELECT OCCURS 3 TIMES
  3491                                            PIC X(10).
  3492         16  CF-USER2-CNTL-OPT.
  3493             20  CF-USER2-OPT-SEQ           PIC 9.
  3494                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  3495                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  3496             20  CF-USER2-SELECT OCCURS 3 TIMES
  3497                                            PIC X(10).
  3498         16  CF-USER3-CNTL-OPT.
  3499             20  CF-USER3-OPT-SEQ           PIC 9.
  3500                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  3501                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  3502             20  CF-USER3-SELECT OCCURS 3 TIMES
  3503                                            PIC X(10).
  3504         16  CF-USER4-CNTL-OPT.
  3505             20  CF-USER4-OPT-SEQ           PIC 9.
  3506                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  3507                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  3508             20  CF-USER4-SELECT OCCURS 3 TIMES
  3509                                            PIC X(10).
  3510         16  CF-USER5-CNTL-OPT.
  3511             20  CF-USER5-OPT-SEQ           PIC 9.
  3512                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  3513                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  3514             20  CF-USER5-SELECT OCCURS 3 TIMES
  3515                                            PIC X(10).
  3516         16  CF-REINS-CNTL-OPT.
  3517             20  CF-REINS-OPT-SEQ           PIC 9.
  3518                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  3519                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  63
* EL6318.cbl
  3520             20  CF-REINS-SELECT OCCURS 3 TIMES.
  3521                 24  CF-REINS-PRIME         PIC XXX.
  3522                 24  CF-REINS-SUB           PIC XXX.
  3523
  3524         16  CF-AGENT-CNTL-OPT.
  3525             20  CF-AGENT-OPT-SEQ           PIC 9.
  3526                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  3527                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  3528             20  CF-AGENT-SELECT OCCURS 3 TIMES
  3529                                            PIC X(10).
  3530
  3531         16  FILLER                         PIC X(43).
  3532
  3533         16  CF-LOSS-RATIO-SELECT.
  3534             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  3535             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  3536         16  CF-ENTRY-DATE-SELECT.
  3537             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  3538             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  3539         16  CF-EFFECTIVE-DATE-SELECT.
  3540             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  3541             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  3542
  3543         16  CF-EXCEPTION-LIST-IND          PIC X.
  3544             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  3545
  3546         16  FILLER                         PIC X(318).
  3547
  3548****************************************************************
  3549*                  EXCEPTION REPORTING RECORD                  *
  3550****************************************************************
  3551
  3552     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  3553         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  3554             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  3555
  3556         16  CF-COMBINED-LIFE-AH-OPT.
  3557             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  3558             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  3559             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  3560             20  CF-CANCELLATION-RATIO      PIC S9(02).
  3561
  3562         16  CF-LIFE-OPT.
  3563             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3564             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3565             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3566             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3567             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3568             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3569             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3570             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3571             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3572             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  3573
  3574         16  CF-AH-OPT.
  3575             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3576             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3577             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  64
* EL6318.cbl
  3578             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3579             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3580             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3581             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3582             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3583             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3584             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  3585
  3586         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  3587             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  3588             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  3589             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  3590
  3591         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  3592
  3593         16  FILLER                         PIC X(673).
  3594
  3595
  3596****************************************************************
  3597*             MORTGAGE SYSTEM PLAN RECORD                      *
  3598****************************************************************
  3599
  3600     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  3601         16  CF-PLAN-TYPE                   PIC X.
  3602             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  3603             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  3604             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  3605         16  CF-PLAN-ABBREV                 PIC XXX.
  3606         16  CF-PLAN-DESCRIPT               PIC X(10).
  3607         16  CF-PLAN-NOTES                  PIC X(20).
  3608         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  3609         16  CF-PLAN-UNDERWRITING.
  3610             20  CF-PLAN-TERM-DATA.
  3611                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  3612                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  3613             20  CF-PLAN-AGE-DATA.
  3614                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  3615                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  3616                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  3617             20  CF-PLAN-BENEFIT-DATA.
  3618                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3619                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3620                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  3621                                            PIC S9(7)V99  COMP-3.
  3622         16  CF-PLAN-POLICY-FORMS.
  3623             20  CF-POLICY-FORM             PIC X(12).
  3624             20  CF-MASTER-APPLICATION      PIC X(12).
  3625             20  CF-MASTER-POLICY           PIC X(12).
  3626         16  CF-PLAN-RATING.
  3627             20  CF-RATE-CODE               PIC X(5).
  3628             20  CF-SEX-RATING              PIC X.
  3629                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  3630                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  3631             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  3632             20  CF-SUB-STD-TYPE            PIC X.
  3633                 88  CF-PCT-OF-PREM            VALUE '1'.
  3634                 88  CF-PCT-OF-BENE            VALUE '2'.
  3635         16  CF-PLAN-PREM-TOLERANCES.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  65
* EL6318.cbl
  3636             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  3637             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  3638         16  CF-PLAN-PYMT-TOLERANCES.
  3639             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  3640             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  3641         16  CF-PLAN-MISC-DATA.
  3642             20  FILLER                     PIC X.
  3643             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  3644             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  3645         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  3646         16  CF-PLAN-IND-GRP                PIC X.
  3647             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  3648                                                     '1'.
  3649             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  3650                                                     '2'.
  3651         16  CF-MIB-SEARCH-SW               PIC X.
  3652             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  3653             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  3654             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  3655             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  3656         16  CF-ALPHA-SEARCH-SW             PIC X.
  3657             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  3658             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  3659             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  3660             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  3661             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  3662             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  3663             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  3664             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  3665             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  3666             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  3667                                                     'A' 'B' 'C'
  3668                                                     'X' 'Y' 'Z'.
  3669         16  CF-EFF-DT-RULE-SW              PIC X.
  3670             88  CF-EFF-DT-ENTER               VALUE 'E'.
  3671             88  CF-EFF-DT-MONTH               VALUE 'M'.
  3672             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  3673             88  CF-EFF-DT-SEMI                VALUE 'S'.
  3674             88  CF-EFF-DT-ANN                 VALUE 'A'.
  3675         16  FILLER                         PIC X(4).
  3676         16  CF-HEALTH-QUESTIONS            PIC X.
  3677             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  3678         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  3679         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  3680         16  CF-PLAN-SNGL-JNT               PIC X.
  3681             88  CF-COMBINED-PLAN              VALUE 'C'.
  3682             88  CF-JNT-PLAN                   VALUE 'J'.
  3683             88  CF-SNGL-PLAN                  VALUE 'S'.
  3684         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  3685         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  3686         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  3687         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  3688         16  CF-RERATE-CNTL                 PIC  X.
  3689             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  3690             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  3691             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  3692             88  CF-AUTO-RECALC                 VALUE '4'.
  3693         16  CF-BENEFIT-TYPE                PIC  X.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  66
* EL6318.cbl
  3694             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  3695             88  CF-BENEFIT-REDUCES             VALUE '2'.
  3696         16  CF-POLICY-FEE                  PIC S999V99
  3697                                                    COMP-3.
  3698         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  3699         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  3700         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  3701         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  3702         16  FILLER                         PIC  X(32).
  3703         16  CF-TERMINATION-FORM            PIC  X(04).
  3704         16  FILLER                         PIC  X(08).
  3705         16  CF-CLAIM-CAP                   PIC S9(7)V99
  3706                                                       COMP-3.
  3707         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  3708         16  CF-ISSUE-LETTER                PIC  X(4).
  3709         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  3710         16  CF-DEPENDENT-COVERAGE          PIC  X.
  3711             88  CF-YES-DEP-COV                 VALUE 'Y'.
  3712             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  3713         16  CF-MP-REFUND-CALC              PIC X.
  3714             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  3715             88  CF-MP-REFD-BY-R78              VALUE '1'.
  3716             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  3717             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  3718             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  3719             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  3720             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  3721             88  CF-MP-REFD-MEAN                VALUE '8'.
  3722         16  CF-ALT-RATE-CODE               PIC  X(5).
  3723
  3724
  3725         16  FILLER                         PIC X(498).
  3726****************************************************************
  3727*             MORTGAGE COMPANY MASTER RECORD                   *
  3728****************************************************************
  3729
  3730     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3731         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  3732         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  3733             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  3734             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  3735             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  3736             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  3737             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  3738
  3739         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  3740         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  3741         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  3742         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  3743         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  3744
  3745         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  3746             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  3747         16  CF-MP-RECON-USE-IND            PIC X(1).
  3748             88  CF-MP-USE-RECON             VALUE 'Y'.
  3749         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  3750             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  3751         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  67
* EL6318.cbl
  3752             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  3753             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  3754         16  FILLER                         PIC X(1).
  3755         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  3756             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  3757         16  CF-MORTG-MIB-VERSION           PIC X.
  3758             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  3759             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  3760             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  3761         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  3762             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  3763                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  3764             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  3765                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  3766             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  3767                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  3768             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  3769                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  3770             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  3771                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  3772             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  3773                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  3774         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  3775         16  FILLER                         PIC X(7).
  3776         16  CF-MORTG-DESTINATION-SYMBOL.
  3777             20  CF-MORTG-MIB-COMM          PIC X(5).
  3778             20  CF-MORTG-MIB-TERM          PIC X(5).
  3779         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  3780             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  3781         16  FILLER                         PIC X(03).
  3782         16  CF-MP-CHECK-NO-CONTROL.
  3783             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  3784                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  3785                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  3786                                                ' ' LOW-VALUES.
  3787                 88  CF-MP-CHECK-NO-PRE-PRINTED
  3788                                               VALUE '3'.
  3789         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  3790         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  3791         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  3792             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  3793                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  3794             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  3795                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  3796             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  3797                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  3798             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  3799                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  3800             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  3801                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  3802             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  3803                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  3804         16  CF-MORTG-BILLING-AREA.
  3805             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  3806                                            PIC X.
  3807         16  CF-MORTG-MONTH-END-DT          PIC XX.
  3808         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  3809         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  68
* EL6318.cbl
  3810         16  CF-MORTG-MIB-DEST-SW           PIC X.
  3811             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  3812             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  3813         16  FILLER                         PIC X.
  3814         16  CF-MORTG-LABEL-CONTROL         PIC X.
  3815             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  3816             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  3817         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  3818         16  FILLER                         PIC X(8).
  3819         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  3820         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  3821         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  3822         16  CF-ACH-COMPANY-ID.
  3823             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  3824                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  3825                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  3826                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  3827             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  3828         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  3829             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  3830         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  3831             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  3832             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  3833         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  3834         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  3835         16  FILLER                         PIC X(536).
  3836
  3837****************************************************************
  3838*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  3839****************************************************************
  3840
  3841     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  3842         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  3843             20  CF-FEMALE-HEIGHT.
  3844                 24  CF-FEMALE-FT           PIC 99.
  3845                 24  CF-FEMALE-IN           PIC 99.
  3846             20  CF-FEMALE-MIN-WT           PIC 999.
  3847             20  CF-FEMALE-MAX-WT           PIC 999.
  3848         16  FILLER                         PIC X(428).
  3849
  3850     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  3851         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  3852             20  CF-MALE-HEIGHT.
  3853                 24  CF-MALE-FT             PIC 99.
  3854                 24  CF-MALE-IN             PIC 99.
  3855             20  CF-MALE-MIN-WT             PIC 999.
  3856             20  CF-MALE-MAX-WT             PIC 999.
  3857         16  FILLER                         PIC X(428).
  3858******************************************************************
  3859*             AUTOMATIC ACTIVITY RECORD                          *
  3860******************************************************************
  3861     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  3862         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  3863             20  CF-SYS-ACTIVE-SW           PIC X(01).
  3864             20  CF-SYS-LETTER-ID           PIC X(04).
  3865             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  3866             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  3867             20  CF-SYS-RESET-SW            PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  69
* EL6318.cbl
  3868             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  3869             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  3870
  3871         16  FILLER                         PIC X(50).
  3872
  3873         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  3874             20  CF-USER-ACTIVE-SW          PIC X(01).
  3875             20  CF-USER-LETTER-ID          PIC X(04).
  3876             20  CF-USER-RESEND-DAYS        PIC 9(03).
  3877             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  3878             20  CF-USER-RESET-SW           PIC X(01).
  3879             20  CF-USER-REPORT-DAYS        PIC 9(03).
  3880             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  3881             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  3882
  3883         16  FILLER                         PIC X(246).
  3884*                                COPY ERCPNDB.
  3885******************************************************************
  3886*                                                                *
  3887*                                                                *
  3888*                            ERCPNDB.                            *
  3889*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3890*                            VMOD=2.025                          *
  3891*                                                                *
  3892*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  3893*                                                                *
  3894******************************************************************
  3895*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  3896*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  3897******************************************************************
  3898*                                                                *
  3899*                                                                *
  3900*   FILE TYPE = VSAM,KSDS                                        *
  3901*   RECORD SIZE = 585  RECFORM = FIXED                           *
  3902*                                                                *
  3903*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  3904*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  3905*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  3906*                                                 RKP=13,LEN=36  *
  3907*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  3908*                                      AND CHG-SEQ.)             *
  3909*                                                RKP=49,LEN=11   *
  3910*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  3911*                                      AND CHG-SEQ.)             *
  3912*                                                RKP=60,LEN=15   *
  3913*                                                                *
  3914*   LOG = NO                                                     *
  3915*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3916******************************************************************
  3917******************************************************************
  3918*                   C H A N G E   L O G
  3919*
  3920* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3921*-----------------------------------------------------------------
  3922*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3923* EFFECTIVE    NUMBER
  3924*-----------------------------------------------------------------
  3925* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  70
* EL6318.cbl
  3926* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3927* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  3928* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  3929* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  3930* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  3931* 032306                   PEMA  ADD BOW LOAN NUMBER
  3932* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  3933* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  3934* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  3935* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  3936* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  3937* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  3938* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3939* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  3940******************************************************************
  3941
  3942 01  PENDING-BUSINESS.
  3943     12  PB-RECORD-ID                     PIC XX.
  3944         88  VALID-PB-ID                        VALUE 'PB'.
  3945
  3946     12  PB-CONTROL-PRIMARY.
  3947         16  PB-COMPANY-CD                PIC X.
  3948         16  PB-ENTRY-BATCH               PIC X(6).
  3949         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  3950         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  3951
  3952     12  PB-CONTROL-BY-ACCOUNT.
  3953         16  PB-COMPANY-CD-A1             PIC X.
  3954         16  PB-CARRIER                   PIC X.
  3955         16  PB-GROUPING.
  3956             20  PB-GROUPING-PREFIX       PIC XXX.
  3957             20  PB-GROUPING-PRIME        PIC XXX.
  3958         16  PB-STATE                     PIC XX.
  3959         16  PB-ACCOUNT.
  3960             20  PB-ACCOUNT-PREFIX        PIC X(4).
  3961             20  PB-ACCOUNT-PRIME         PIC X(6).
  3962         16  PB-CERT-EFF-DT               PIC XX.
  3963         16  PB-CERT-NO.
  3964             20  PB-CERT-PRIME            PIC X(10).
  3965             20  PB-CERT-SFX              PIC X.
  3966         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  3967
  3968         16  PB-RECORD-TYPE               PIC X.
  3969             88  PB-MAILING-DATA                VALUE '0'.
  3970             88  PB-ISSUE                       VALUE '1'.
  3971             88  PB-CANCELLATION                VALUE '2'.
  3972             88  PB-BATCH-TRAILER               VALUE '9'.
  3973
  3974     12  PB-CONTROL-BY-ORIG-BATCH.
  3975         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  3976         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  3977         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  3978         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  3979
  3980     12  PB-CONTROL-BY-CSR.
  3981         16  PB-CSR-COMPANY-CD            PIC X.
  3982         16  PB-CSR-ID                    PIC X(4).
  3983         16  PB-CSR-ENTRY-BATCH           PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  71
* EL6318.cbl
  3984         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  3985         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  3986******************************************************************
  3987*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  3988******************************************************************
  3989
  3990     12  PB-LAST-MAINT-DT                 PIC XX.
  3991     12  PB-LAST-MAINT-BY                 PIC X(4).
  3992     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  3993
  3994     12  PB-RECORD-BODY                   PIC X(375).
  3995
  3996     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  3997         16  PB-CERT-ORIGIN               PIC X.
  3998             88  CLASIC-CREATED-CERT         VALUE '1'.
  3999         16  PB-I-NAME.
  4000             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  4001             20  PB-I-INSURED-FIRST-NAME.
  4002                 24  PB-I-INSURED-1ST-INIT PIC X.
  4003                 24  FILLER                PIC X(9).
  4004             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  4005         16  PB-I-AGE                     PIC S99   COMP-3.
  4006         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  4007         16  PB-I-BIRTHDAY                PIC XX.
  4008         16  PB-I-INSURED-SEX             PIC X.
  4009             88  PB-SEX-MALE     VALUE 'M'.
  4010             88  PB-SEX-FEMALE   VALUE 'F'.
  4011
  4012         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  4013         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  4014         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  4015         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  4016         16  PB-I-SKIP-CODE               PIC X.
  4017             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  4018             88  PB-SKIP-JULY              VALUE '1'.
  4019             88  PB-SKIP-AUGUST            VALUE '2'.
  4020             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  4021             88  PB-SKIP-JULY-AUG          VALUE '4'.
  4022             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  4023             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  4024             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  4025             88  PB-SKIP-JUNE              VALUE '8'.
  4026             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  4027             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  4028             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  4029         16  PB-I-TERM-TYPE               PIC X.
  4030             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  4031             88  PB-PAID-WEEKLY            VALUE 'W'.
  4032             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  4033             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  4034             88  PB-PAID-13-YEARLY         VALUE 'T'.
  4035         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  4036         16  PB-I-POLICY-FORM-NO          PIC X(12).
  4037         16  PB-I-DATA-ENTRY-SW           PIC X.
  4038             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  4039             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  4040             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  4041             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  72
* EL6318.cbl
  4042         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  4043         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  4044*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  4045         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  4046         16  FILLER                       PIC X.
  4047
  4048         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  4049             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  4050             88  PB-INVALID-LIFE             VALUE '  ' '00'
  4051                                                   '90' THRU '99'.
  4052         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  4053                                          PIC XX.
  4054         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  4055         16  PB-I-AMOUNT-FINANCED REDEFINES
  4056                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  4057         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  4058         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  4059                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4060         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4061         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  4062         16  PB-I-CLP-AMOUNT REDEFINES
  4063                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  4064         16  PB-I-LF-CALC-FLAG            PIC X.
  4065             88 PB-COMP-LF-PREM               VALUE '?'.
  4066         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  4067         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  4068         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  4069         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  4070         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4071         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4072         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4073         16  PB-I-LF-ABBR                 PIC XXX.
  4074         16  PB-I-LF-INPUT-CD             PIC XX.
  4075
  4076         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4077             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4078             88  PB-INVALID-AH               VALUE '  ' '00'
  4079                                                   '90' THRU '99'.
  4080         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4081         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4082         16  PB-I-AH-CALC-FLAG            PIC X.
  4083             88 PB-COMP-AH-PREM                  VALUE '?'.
  4084         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4085         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4086         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4087         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  4088         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4089         16  PB-I-AH-ABBR                 PIC XXX.
  4090         16  PB-I-AH-INPUT-CD             PIC XXX.
  4091
  4092         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4093         16  PB-I-REIN-TABLE              PIC XXX.
  4094         16  PB-I-BUSINESS-TYPE           PIC 99.
  4095         16  PB-I-INDV-GRP-CD             PIC X.
  4096         16  PB-I-MORT-CODE.
  4097             20  PB-I-TABLE               PIC X.
  4098             20  PB-I-INTEREST            PIC XX.
  4099             20  PB-I-MORT-TYP            PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  73
* EL6318.cbl
  4100         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4101         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  4102         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  4103         16  PB-I-INDV-GRP-OVRD           PIC X.
  4104         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  4105         16  PB-I-SIG-SW                  PIC X.
  4106             88  PB-POLICY-SIGNED             VALUE 'Y'.
  4107         16  PB-I-RATE-CLASS              PIC XX.
  4108         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4109         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4110         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4111         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  4112         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  4113         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  4114         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  4115         16  PB-I-BENEFIT-TYPE            PIC XXX.
  4116         16  PB-I-OB-FLAG                 PIC X.
  4117             88  PB-I-OB                      VALUE 'B'.
  4118             88  PB-I-SUMMARY                 VALUE 'Z'.
  4119         16  PB-I-ENTRY-STATUS            PIC X.
  4120             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  4121                                              'M' '5' '9' '2'.
  4122             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  4123             88  PB-I-POLICY-PENDING          VALUE '2'.
  4124             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  4125             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  4126             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  4127             88  PB-I-REIN-ONLY               VALUE '9'.
  4128             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  4129             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  4130             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  4131             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  4132         16  PB-I-INT-CODE                PIC X.
  4133             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  4134             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  4135         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  4136         16  PB-I-SOC-SEC-NO              PIC X(11).
  4137         16  PB-I-MEMBER-NO               PIC X(12).
  4138         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  4139*        16  PB-I-LOAN-OFFICER            PIC XXX.
  4140         16  PB-I-OLD-LOF                 PIC XXX.
  4141         16  PB-I-LF-EXPIRE-DT            PIC XX.
  4142         16  PB-I-AH-EXPIRE-DT            PIC XX.
  4143         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  4144         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  4145         16  PB-I-LIFE-INDICATOR          PIC X.
  4146             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  4147         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  4148         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  4149                                          PIC S9(5)V99    COMP-3.
  4150         16  PB-I-MAIL-ADDRS-SW           PIC X.
  4151             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  4152             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  4153         16  PB-I-1ST-PMT-DT              PIC XX.
  4154         16  PB-I-JOINT-INSURED.
  4155             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  4156             20 PB-I-JOINT-FIRST-NAME.
  4157                24  PB-I-JOINT-FIRST-INIT PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  74
* EL6318.cbl
  4158                24  FILLER                PIC X(9).
  4159             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  4160*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  4161         16  PB-I-BENEFICIARY-NAME.
  4162             20  PB-I-BANK-NUMBER         PIC X(10).
  4163             20  FILLER                   PIC X(15).
  4164         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  4165         16  PB-I-REFERENCE               PIC X(12).
  4166         16  FILLER REDEFINES PB-I-REFERENCE.
  4167             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  4168             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  4169             20  PB-I-CLP-STATE           PIC XX.
  4170         16  PB-I-UNDERWRITING-STATUS     PIC X.
  4171             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  4172             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  4173             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  4174         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  4175         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  4176         16  PB-I-RESIDENT-STATE          PIC XX.
  4177         16  PB-I-RATE-CODE               PIC X(4).
  4178         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  4179         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4180         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4181         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  4182         16  PB-I-BANK-NOCHRGB            PIC 99.
  4183         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  4184         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  4185
  4186     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  4187         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  4188             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  4189         16  PB-C-CANCEL-ORIGIN           PIC X.
  4190             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  4191         16  PB-C-LF-CANCEL-DT            PIC XX.
  4192         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4193         16  PB-C-LF-CALC-REQ             PIC X.
  4194             88 PB-COMP-LF-CANCEL            VALUE '?'.
  4195         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  4196         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  4197         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  4198             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  4199         16  PB-C-AH-CANCEL-DT            PIC XX.
  4200         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4201         16  PB-C-AH-CALC-REQ             PIC X.
  4202             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4203         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4204         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4205         16  PB-C-LAST-NAME               PIC X(15).
  4206         16  PB-C-REFUND-SW               PIC X.
  4207             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4208             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4209         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4210         16  PB-C-PAYEE-CODE              PIC X(6).
  4211         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4212         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4213         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4214         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4215         16  PB-C-REFERENCE               PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  75
* EL6318.cbl
  4216         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4217         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4218         16  PB-C-POST-CARD-IND           PIC X.
  4219         16  PB-C-CANCEL-REASON           PIC X.
  4220         16  PB-C-REF-INTERFACE-SW        PIC X.
  4221         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4222         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  4223         16  FILLER                       PIC X(01).
  4224*        16  FILLER                       PIC X(18).
  4225         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4226*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  4227         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  4228         16  PB-CANCELED-CERT-DATA.
  4229             20  PB-CI-INSURED-NAME.
  4230                 24  PB-CI-LAST-NAME      PIC X(15).
  4231                 24  PB-CI-INITIALS       PIC XX.
  4232             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4233             20  PB-CI-INSURED-SEX        PIC X.
  4234             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4235             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4236             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4237             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4238             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4239             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4240             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4241             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4242             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4243             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4244             20  PB-CI-RATE-CLASS         PIC XX.
  4245             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4246             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4247             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4248             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4249             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4250             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4251             20  PB-CI-LF-ABBR            PIC X(3).
  4252             20  PB-CI-AH-ABBR            PIC X(3).
  4253             20  PB-CI-OB-FLAG            PIC X.
  4254                 88  PB-CI-OB                VALUE 'B'.
  4255             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4256                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4257                                           'M' '4' '5' '9' '2'.
  4258                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4259                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4260                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4261                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4262                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4263                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4264                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4265                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4266                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4267                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4268                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4269                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4270             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4271                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4272                                           'M' '4' '5' '9' '2'.
  4273                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  76
* EL6318.cbl
  4274                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  4275                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  4276                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  4277                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  4278                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4279                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4280                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4281                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4282                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  4283                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4284                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  4285             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4286             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  4287             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4288             20  PB-CI-MEMBER-NO          PIC X(12).
  4289             20  PB-CI-INT-CODE           PIC X.
  4290                 88  PB-CI-ADD-ON                  VALUE 'A'.
  4291                 88  PB-CI-SIMPLE                  VALUE 'S'.
  4292             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  4293             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  4294             20  PB-CI-COMP-EXCP-SW       PIC X.
  4295                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  4296                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  4297             20  PB-CI-ENTRY-STATUS       PIC X.
  4298             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  4299             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  4300             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  4301             20  PB-CI-DEATH-DT           PIC XX.
  4302             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  4303             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  4304             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4305             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4306             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  4307             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  4308             20  PB-CI-ENTRY-DT              PIC XX.
  4309             20  PB-CI-ENTRY-BATCH           PIC X(6).
  4310             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  4311             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  4312             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  4313             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  4314             20  PB-CI-OLD-LOF               PIC XXX.
  4315*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  4316             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  4317             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  4318             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  4319             20  PB-CI-INDV-GRP-CD           PIC X.
  4320             20  PB-CI-BENEFICIARY-NAME.
  4321                 24  PB-CI-BANK-NUMBER       PIC X(10).
  4322                 24  FILLER                  PIC X(15).
  4323             20  PB-CI-NOTE-SW               PIC X.
  4324             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  4325             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  4326             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  4327             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  4328             20  PB-CI-LOAN-OFFICER          PIC X(5).
  4329             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  4330             20  PB-CI-FIRST-NAME            PIC X(10).
  4331             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  77
* EL6318.cbl
  4332
  4333         16  FILLER                       PIC X(13).
  4334*032306  16  FILLER                       PIC X(27).
  4335*        16  FILLER                       PIC X(46).
  4336
  4337     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  4338         16  FILLER                       PIC X(10).
  4339         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  4340         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  4341         16  PB-M-INSURED-MID-INIT        PIC X.
  4342         16  PB-M-INSURED-AGE             PIC 99.
  4343         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  4344         16  PB-M-INSURED-SEX             PIC X.
  4345         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  4346         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  4347         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  4348         16  PB-M-INSURED-CITY-STATE.
  4349             20  PB-M-INSURED-CITY        PIC X(28).
  4350             20  PB-M-INSURED-STATE       PIC XX.
  4351         16  PB-M-INSURED-ZIP-CODE.
  4352             20  PB-M-INSURED-ZIP-PRIME.
  4353                 24  PB-M-INSURED-ZIP-1   PIC X.
  4354                     88  PB-M-CANADIAN-POST-CODE
  4355                                             VALUE 'A' THRU 'Z'.
  4356                 24  FILLER               PIC X(4).
  4357             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  4358         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  4359                                        PB-M-INSURED-ZIP-CODE.
  4360             20  PM-M-INS-CAN-POST1       PIC XXX.
  4361             20  PM-M-INS-CAN-POST2       PIC XXX.
  4362             20  FILLER                   PIC XXX.
  4363         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  4364         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  4365         16  PB-M-CRED-BENE-NAME          PIC X(30).
  4366         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  4367         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  4368         16  PB-M-CRED-BENE-CITYST.
  4369             20  PB-M-CRED-BENE-CITY      PIC X(28).
  4370             20  PB-M-CRED-BENE-STATE     PIC XX.
  4371         16  FILLER                       PIC X(92).
  4372
  4373     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  4374         16  FILLER                       PIC X(10).
  4375         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4376         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4377         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4378         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4379         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4380         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4381         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4382         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4383         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4384         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4385         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4386         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4387         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  4388         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  4389         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  78
* EL6318.cbl
  4390         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  4391         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  4392         16  PB-ACCOUNT-NAME              PIC X(30).
  4393         16  PB-PREM-REF-RPT-FLAG         PIC X.
  4394         16  PB-REFERENCE                 PIC X(12).
  4395         16  PB-B-RECEIVED-DT             PIC XX.
  4396         16  FILLER                       PIC X(234).
  4397
  4398     12  PB-RECORD-STATUS.
  4399         16  PB-CREDIT-SELECT-DT          PIC XX.
  4400         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  4401         16  PB-BILLED-DT                 PIC XX.
  4402         16  PB-BILLING-STATUS            PIC X.
  4403             88  PB-ENTRY-REVERSED            VALUE 'R'.
  4404             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  4405             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  4406         16  PB-RECORD-BILL               PIC X.
  4407             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  4408             88  PB-RECORD-RETURNED           VALUE 'R'.
  4409             88  PB-RECORD-ENDORSED           VALUE 'E'.
  4410             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  4411             88  PB-OVERRIDE-AH               VALUE 'A'.
  4412             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  4413         16  PB-BATCH-ENTRY               PIC X.
  4414             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  4415             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  4416             88  PB-REISSUED-CERT             VALUE 'E'.
  4417             88  PB-MONTHLY-CERT              VALUE 'M'.
  4418             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  4419             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  4420             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  4421         16  PB-FORCE-CODE                PIC X.
  4422             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  4423             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  4424             88  PB-CANCEL-FORCE              VALUE '8'.
  4425             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  4426             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  4427             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  4428             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  4429             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  4430             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  4431             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  4432         16  PB-FATAL-FLAG                PIC X.
  4433             88  PB-FATAL-ERRORS              VALUE 'X'.
  4434         16  PB-FORCE-ER-CD               PIC X.
  4435             88  PB-FORCE-ERRORS              VALUE 'F'.
  4436             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  4437         16  PB-WARN-ER-CD                PIC X.
  4438             88  PB-WARNING-ERRORS            VALUE 'W'.
  4439         16  FILLER                       PIC X.
  4440         16  PB-OUT-BAL-CD                PIC X.
  4441             88  PB-OUT-OF-BAL                VALUE 'O'.
  4442         16  PB-LIFE-OVERRIDE-L1          PIC X.
  4443         16  PB-AH-OVERRIDE-L1            PIC X.
  4444         16  PB-INPUT-DT                  PIC XX.
  4445         16  PB-INPUT-BY                  PIC X(4).
  4446         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  4447         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  79
* EL6318.cbl
  4448         16  PB-TOLERANCE-REJECT-SW       PIC X.
  4449         16  PB-LF-EARNING-METHOD         PIC X.
  4450         16  PB-AH-EARNING-METHOD         PIC X.
  4451         16  PB-LF-TERM-CALC-METHOD       PIC X.
  4452         16  PB-AH-TERM-CALC-METHOD       PIC X.
  4453         16  PB-REIN-CD                   PIC XXX.
  4454         16  PB-LF-REFUND-TYPE            PIC X.
  4455         16  PB-AH-REFUND-TYPE            PIC X.
  4456         16  PB-ACCT-EFF-DT               PIC XX.
  4457         16  PB-ACCT-EXP-DT               PIC XX.
  4458         16  PB-COMPANY-ID                PIC X(3).
  4459         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4460         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4461         16  PB-SV-CARRIER                PIC X.
  4462         16  PB-SV-GROUPING               PIC X(6).
  4463         16  PB-SV-STATE                  PIC XX.
  4464         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  4465         16  PB-GA-BILLING-INFO.
  4466             20  PB-GA-BILL-DT OCCURS 5 TIMES
  4467                                          PIC XX.
  4468         16  PB-SV-REMIT-TO  REDEFINES
  4469             PB-GA-BILLING-INFO           PIC X(10).
  4470         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  4471         16  PB-I-LOAN-OFFICER            PIC X(5).
  4472         16  PB-I-VIN                     PIC X(17).
  4473
  4474         16  FILLER                       PIC X(04).
  4475         16  IMNET-BYPASS-SW              PIC X.
  4476
  4477******************************************************************
  4478*                COMMON EDIT ERRORS                              *
  4479******************************************************************
  4480
  4481     12  PB-COMMON-ERRORS.
  4482         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  4483                                           PIC S9(4)     COMP.
  4484
  4485******************************************************************
  4486*                                COPY ELCCERT.
  4487******************************************************************
  4488*                                                                *
  4489*                            ELCCERT.                            *
  4490*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4491*                            VMOD=2.013                          *
  4492*                                                                *
  4493*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  4494*                                                                *
  4495*   FILE TYPE = VSAM,KSDS                                        *
  4496*   RECORD SIZE = 450  RECFORM = FIXED                           *
  4497*                                                                *
  4498*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  4499*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  4500*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  4501*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  4502*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  4503*                                                                *
  4504*   LOG = YES                                                    *
  4505*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  80
* EL6318.cbl
  4506******************************************************************
  4507*                   C H A N G E   L O G
  4508*
  4509* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4510*-----------------------------------------------------------------
  4511*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4512* EFFECTIVE    NUMBER
  4513*-----------------------------------------------------------------
  4514* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4515* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4516* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  4517* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4518* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4519* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  4520* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4521* 032612  CR2011110200001  PEMA  AHL CHANGES
  4522******************************************************************
  4523
  4524 01  CERTIFICATE-MASTER.
  4525     12  CM-RECORD-ID                      PIC XX.
  4526         88  VALID-CM-ID                      VALUE 'CM'.
  4527
  4528     12  CM-CONTROL-PRIMARY.
  4529         16  CM-COMPANY-CD                 PIC X.
  4530         16  CM-CARRIER                    PIC X.
  4531         16  CM-GROUPING.
  4532             20  CM-GROUPING-PREFIX        PIC X(3).
  4533             20  CM-GROUPING-PRIME         PIC X(3).
  4534         16  CM-STATE                      PIC XX.
  4535         16  CM-ACCOUNT.
  4536             20  CM-ACCOUNT-PREFIX         PIC X(4).
  4537             20  CM-ACCOUNT-PRIME          PIC X(6).
  4538         16  CM-CERT-EFF-DT                PIC XX.
  4539         16  CM-CERT-NO.
  4540             20  CM-CERT-PRIME             PIC X(10).
  4541             20  CM-CERT-SFX               PIC X.
  4542
  4543     12  CM-CONTROL-BY-NAME.
  4544         16  CM-COMPANY-CD-A1              PIC X.
  4545         16  CM-INSURED-LAST-NAME          PIC X(15).
  4546         16  CM-INSURED-INITIALS.
  4547             20  CM-INSURED-INITIAL1       PIC X.
  4548             20  CM-INSURED-INITIAL2       PIC X.
  4549
  4550     12  CM-CONTROL-BY-SSN.
  4551         16  CM-COMPANY-CD-A2              PIC X.
  4552         16  CM-SOC-SEC-NO.
  4553             20  CM-SSN-STATE              PIC XX.
  4554             20  CM-SSN-ACCOUNT            PIC X(6).
  4555             20  CM-SSN-LN3.
  4556                 25  CM-INSURED-INITIALS-A2.
  4557                     30 CM-INSURED-INITIAL1-A2   PIC X.
  4558                     30 CM-INSURED-INITIAL2-A2   PIC X.
  4559                 25 CM-PART-LAST-NAME-A2         PIC X.
  4560
  4561     12  CM-CONTROL-BY-CERT-NO.
  4562         16  CM-COMPANY-CD-A4              PIC X.
  4563         16  CM-CERT-NO-A4                 PIC X(11).
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  81
* EL6318.cbl
  4564
  4565     12  CM-CONTROL-BY-MEMB.
  4566         16  CM-COMPANY-CD-A5              PIC X.
  4567         16  CM-MEMBER-NO.
  4568             20  CM-MEMB-STATE             PIC XX.
  4569             20  CM-MEMB-ACCOUNT           PIC X(6).
  4570             20  CM-MEMB-LN4.
  4571                 25  CM-INSURED-INITIALS-A5.
  4572                     30 CM-INSURED-INITIAL1-A5   PIC X.
  4573                     30 CM-INSURED-INITIAL2-A5   PIC X.
  4574                 25 CM-PART-LAST-NAME-A5         PIC XX.
  4575
  4576     12  CM-INSURED-PROFILE-DATA.
  4577         16  CM-INSURED-FIRST-NAME.
  4578             20  CM-INSURED-1ST-INIT       PIC X.
  4579             20  FILLER                    PIC X(9).
  4580         16  CM-INSURED-ISSUE-AGE          PIC 99.
  4581         16  CM-INSURED-SEX                PIC X.
  4582             88  CM-SEX-MALE                  VALUE 'M'.
  4583             88  CM-SEX-FEMAL                 VALUE 'F'.
  4584         16  CM-INSURED-JOINT-AGE          PIC 99.
  4585         16  CM-JOINT-INSURED-NAME.
  4586             20  CM-JT-LAST-NAME           PIC X(15).
  4587             20  CM-JT-FIRST-NAME.
  4588                 24  CM-JT-1ST-INIT        PIC X.
  4589                 24  FILLER                PIC X(9).
  4590             20  CM-JT-INITIAL             PIC X.
  4591
  4592     12  CM-LIFE-DATA.
  4593         16  CM-LF-BENEFIT-CD              PIC XX.
  4594         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  4595         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  4596         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  4597         16  CM-LF-DEV-CODE                PIC XXX.
  4598         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4599         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  4600         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4601         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  4602         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4603         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4604         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  4605         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4606         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  4607         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4608         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4609         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  4610         16  FILLER                        PIC XX.
  4611
  4612     12  CM-AH-DATA.
  4613         16  CM-AH-BENEFIT-CD              PIC XX.
  4614         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  4615         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  4616         16  CM-AH-DEV-CODE                PIC XXX.
  4617         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4618         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  4619         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4620         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4621         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  82
* EL6318.cbl
  4622         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  4623         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  4624         16  CM-AH-PAID-THRU-DT            PIC XX.
  4625             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  4626         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4627         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4628         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  4629         16  FILLER                        PIC X.
  4630
  4631     12  CM-LOAN-INFORMATION.
  4632         16  CM-LIVES                      PIC S9(7)     COMP-3.
  4633         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  4634                                           PIC S9(5)V99  COMP-3.
  4635         16  CM-BILLED                     PIC S9(7)     COMP-3.
  4636         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  4637         16  CM-PAY-FREQUENCY              PIC S99.
  4638         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  4639         16  CM-RATE-CLASS                 PIC XX.
  4640         16  CM-BENEFICIARY                PIC X(25).
  4641         16  CM-POLICY-FORM-NO             PIC X(12).
  4642         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  4643         16  CM-LAST-ADD-ON-DT             PIC XX.
  4644         16  CM-DEDUCTIBLE-AMOUNTS.
  4645             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  4646             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  4647         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4648             20  CM-RESIDENT-STATE         PIC XX.
  4649             20  CM-RATE-CODE              PIC X(4).
  4650             20  FILLER                    PIC XX.
  4651         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4652             20  CM-LOAN-OFFICER           PIC X(5).
  4653             20  FILLER                    PIC XXX.
  4654         16  CM-CSR-CODE                   PIC XXX.
  4655         16  CM-UNDERWRITING-CODE          PIC X.
  4656             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  4657         16  CM-POST-CARD-IND              PIC X.
  4658         16  CM-NH-INTERFACE-SW            PIC X.
  4659         16  CM-PREMIUM-TYPE               PIC X.
  4660             88  CM-SING-PRM                  VALUE '1'.
  4661             88  CM-O-B-COVERAGE              VALUE '2'.
  4662             88  CM-OPEN-END                  VALUE '3'.
  4663         16  CM-IND-GRP-TYPE               PIC X.
  4664             88  CM-INDIVIDUAL                VALUE 'I'.
  4665             88  CM-GROUP                     VALUE 'G'.
  4666         16  CM-SKIP-CODE                  PIC X.
  4667             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  4668             88  SKIP-JULY                    VALUE '1'.
  4669             88  SKIP-AUGUST                  VALUE '2'.
  4670             88  SKIP-SEPTEMBER               VALUE '3'.
  4671             88  SKIP-JULY-AUG                VALUE '4'.
  4672             88  SKIP-AUG-SEPT                VALUE '5'.
  4673             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  4674             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  4675             88  SKIP-JUNE                    VALUE '8'.
  4676             88  SKIP-JUNE-JULY               VALUE '9'.
  4677             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  4678             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  4679         16  CM-PAYMENT-MODE               PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  83
* EL6318.cbl
  4680             88  PAY-MONTHLY                  VALUE SPACE.
  4681             88  PAY-WEEKLY                   VALUE '1'.
  4682             88  PAY-SEMI-MONTHLY             VALUE '2'.
  4683             88  PAY-BI-WEEKLY                VALUE '3'.
  4684             88  PAY-SEMI-ANUALLY             VALUE '4'.
  4685         16  CM-LOAN-NUMBER                PIC X(8).
  4686         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  4687         16  CM-OLD-LOF                    PIC XXX.
  4688*        16  CM-LOAN-OFFICER               PIC XXX.
  4689         16  CM-REIN-TABLE                 PIC XXX.
  4690         16  CM-SPECIAL-REIN-CODE          PIC X.
  4691         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  4692         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  4693         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  4694
  4695     12  CM-STATUS-DATA.
  4696         16  CM-ENTRY-STATUS               PIC X.
  4697         16  CM-ENTRY-DT                   PIC XX.
  4698
  4699         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  4700         16  CM-LF-CANCEL-DT               PIC XX.
  4701         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  4702
  4703         16  CM-LF-STATUS-AT-DEATH         PIC X.
  4704         16  CM-LF-DEATH-DT                PIC XX.
  4705         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  4706
  4707         16  CM-LF-CURRENT-STATUS          PIC X.
  4708             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4709                                                'M' '4' '5' '9'.
  4710             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  4711             88  CM-LF-POLICY-PENDING         VALUE '2'.
  4712             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  4713             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  4714             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  4715             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4716             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  4717             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4718             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  4719             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  4720             88  CM-LF-DECLINED               VALUE 'D'.
  4721             88  CM-LF-VOIDED                 VALUE 'V'.
  4722
  4723         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  4724         16  CM-AH-CANCEL-DT               PIC XX.
  4725         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  4726
  4727         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  4728         16  CM-AH-SETTLEMENT-DT           PIC XX.
  4729         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  4730
  4731         16  CM-AH-CURRENT-STATUS          PIC X.
  4732             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4733                                                'M' '4' '5' '9'.
  4734             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  4735             88  CM-AH-POLICY-PENDING         VALUE '2'.
  4736             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  4737             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  84
* EL6318.cbl
  4738             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  4739             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4740             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  4741             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4742             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  4743             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  4744             88  CM-AH-DECLINED               VALUE 'D'.
  4745             88  CM-AH-VOIDED                 VALUE 'V'.
  4746
  4747         16  CM-CLAIM-INTERFACE-SW         PIC X.
  4748             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  4749             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  4750             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  4751         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  4752
  4753         16  CM-ENTRY-BATCH                PIC X(6).
  4754         16  CM-LF-EXIT-BATCH              PIC X(6).
  4755         16  CM-AH-EXIT-BATCH              PIC X(6).
  4756         16  CM-LAST-MONTH-END             PIC XX.
  4757
  4758     12  CM-NOTE-SW                        PIC X.
  4759         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  4760         88  CERT-NOTES-PRESENT               VALUE '1'.
  4761         88  BILLING-NOTES-PRESENT            VALUE '2'.
  4762         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  4763         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  4764         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  4765         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  4766         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  4767     12  CM-COMP-EXCP-SW                   PIC X.
  4768         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  4769         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  4770     12  CM-INSURED-ADDRESS-SW             PIC X.
  4771         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  4772         88  INSURED-ADDR-PRESENT             VALUE '1'.
  4773
  4774*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  4775     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  4776     12  FILLER                            PIC X.
  4777
  4778*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  4779     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  4780     12  FILLER                            PIC X.
  4781*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  4782     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  4783
  4784     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  4785         88  CERT-ADDED-BATCH                 VALUE ' '.
  4786         88  CERT-ADDED-ONLINE                VALUE '1'.
  4787         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  4788         88  CERT-PURGED-OFFLINE              VALUE '3'.
  4789         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  4790     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  4791         88  CERT-AS-LOADED                   VALUE ' '.
  4792         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  4793         88  CERT-CLAIM-ONLINE                VALUE '2'.
  4794         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  4795         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  85
* EL6318.cbl
  4796         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  4797         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  4798         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  4799
  4800     12  CM-ACCOUNT-COMM-PCTS.
  4801         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  4802         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  4803
  4804     12  CM-USER-FIELD                     PIC X.
  4805     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  4806     12  CM-CLP-STATE                      PIC XX.
  4807     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  4808     12  CM-USER-RESERVED                  PIC XXX.
  4809     12  FILLER REDEFINES CM-USER-RESERVED.
  4810         16  CM-AH-CLASS-CD                PIC XX.
  4811         16  F                             PIC X.
  4812******************************************************************
  4813*                                COPY ELCCRTO.
  4814******************************************************************
  4815*                                                                *
  4816*                            ELCCRTO.                            *
  4817*                                                                *
  4818*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  4819*                                                                *
  4820*   FILE TYPE = VSAM,KSDS                                        *
  4821*   RECORD SIZE = 524  RECFORM = FIXED                           *
  4822*                                                                *
  4823*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  4824*                                                                *
  4825*   LOG = YES                                                    *
  4826*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4827******************************************************************
  4828*                   C H A N G E   L O G
  4829*
  4830* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4831*-----------------------------------------------------------------
  4832*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4833* EFFECTIVE    NUMBER
  4834*-----------------------------------------------------------------
  4835* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  4836* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  4837* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  4838******************************************************************
  4839 01  ORIGINAL-CERTIFICATE.
  4840     12  OC-RECORD-ID                      PIC XX.
  4841         88  VALID-OC-ID                      VALUE 'OC'.
  4842     12  OC-CONTROL-PRIMARY.
  4843         16  OC-COMPANY-CD                 PIC X.
  4844         16  OC-CARRIER                    PIC X.
  4845         16  OC-GROUPING                   PIC X(6).
  4846         16  OC-STATE                      PIC XX.
  4847         16  OC-ACCOUNT                    PIC X(10).
  4848         16  OC-CERT-EFF-DT                PIC XX.
  4849         16  OC-CERT-NO.
  4850             20  OC-CERT-PRIME             PIC X(10).
  4851             20  OC-CERT-SFX               PIC X.
  4852         16  OC-RECORD-TYPE                PIC X.
  4853         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  86
* EL6318.cbl
  4854     12  OC-LAST-MAINT-DT                  PIC XX.
  4855     12  OC-LAST-MAINT-BY                  PIC X(4).
  4856     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  4857     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  4858     12  FILLER                            PIC X(49).
  4859     12  OC-ORIG-REC.
  4860         16  OC-INS-LAST-NAME              PIC X(15).
  4861         16  OC-INS-FIRST-NAME             PIC X(10).
  4862         16  OC-INS-MIDDLE-INIT            PIC X.
  4863         16  OC-INS-AGE                    PIC S999     COMP-3.
  4864         16  OC-JNT-LAST-NAME              PIC X(15).
  4865         16  OC-JNT-FIRST-NAME             PIC X(10).
  4866         16  OC-JNT-MIDDLE-INIT            PIC X.
  4867         16  OC-JNT-AGE                    PIC S999     COMP-3.
  4868         16  OC-LF-BENCD                   PIC XX.
  4869         16  OC-LF-TERM                    PIC S999      COMP-3.
  4870         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  4871         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  4872         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  4873         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  4874         16  OC-LF-EXP-DT                  PIC XX.
  4875         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  4876         16  OC-LF-CANCEL-DT               PIC XX.
  4877         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  4878         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4879         16  OC-AH-BENCD                   PIC XX.
  4880         16  OC-AH-TERM                    PIC S999      COMP-3.
  4881         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  4882         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  4883         16  OC-AH-EXP-DT                  PIC XX.
  4884         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  4885         16  OC-AH-CP                      PIC 99.
  4886         16  OC-AH-CANCEL-DT               PIC XX.
  4887         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  4888         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4889         16  OC-CRED-BENE-NAME             PIC X(25).
  4890         16  OC-1ST-PMT-DT                 PIC XX.
  4891         16  FILLER                        PIC X(215).
  4892
  4893     12  FILLER                            PIC X(50).
  4894******************************************************************
  4895*                                COPY ERCENDT.
  4896******************************************************************
  4897*                                                                *
  4898*                                                                *
  4899*                            ERCENDT.                            *
  4900*                            VMOD=2.001                          *
  4901*                                                                *
  4902*   FILE DESCRIPTION = ENDORSEMENT FILE                          *
  4903*                                                                *
  4904*   FILE TYPE = VSAM,KSDS                                        *
  4905*   RECORD SIZE = 579  RECFORM = FIXED                           *
  4906*                                                                *
  4907*   BASE CLUSTER = ERENDT                         RKP=02,LEN=36  *
  4908*       ALTERNATE PATH1 = ERENDT2 (BY ARCH NO)    RKP=38,LEN=05  *
  4909*                                                                *
  4910*   LOG = NO                                                     *
  4911*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  87
* EL6318.cbl
  4912******************************************************************
  4913*-----------------------------------------------------------------
  4914*                   C H A N G E   L O G
  4915*
  4916* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4917*-----------------------------------------------------------------
  4918*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4919* EFFECTIVE    NUMBER
  4920*-----------------------------------------------------------------
  4921* 052307    2006052600001  AJRA  ADDED FLAG FOR CANCELS ON CERTS
  4922*                                WITH OPEN CLAIMS
  4923* 072312    2011022800001  AJRA  ADDED BATCH NUMBER
  4924* 110612    2012101700002  AJRA  ADD NEW FIELDS
  4925*-----------------------------------------------------------------
  4926 01  ENDORSEMENT-RECORD.
  4927     12  EN-RECORD-ID                PIC XX.
  4928         88  VALID-EN-ID                VALUE 'EN'.
  4929     12  EN-CONTROL-PRIMARY.
  4930         16  EN-COMPANY-CD           PIC X.
  4931         16  EN-CARRIER              PIC X.
  4932         16  EN-GROUPING             PIC X(6).
  4933         16  EN-STATE                PIC XX.
  4934         16  EN-ACCOUNT              PIC X(10).
  4935         16  EN-CERT-EFF-DT          PIC XX.
  4936         16  EN-CERT-NO.
  4937             20  EN-CERT-PRIME       PIC X(10).
  4938             20  EN-CERT-SFX         PIC X.
  4939         16  EN-REC-TYPE             PIC X.
  4940             88  EN-ISSUE               VALUE 'I'.
  4941             88  EN-CANCELLATION        VALUE 'C'.
  4942         16  EN-SEQ-NO               PIC 9(04) BINARY.
  4943     12  EN-CONTROL-BY-ARCH-NO.
  4944         16  EN-COMPANY-CD-A1              PIC X.
  4945         16  EN-ARCHIVE-NO                 PIC 9(8) BINARY.
  4946     12  EN-LAST-MAINT-DT            PIC XX.
  4947     12  EN-LAST-MAINT-BY            PIC X(4).
  4948     12  EN-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  4949     12  EN-ENDORSEMENT-RECORD       PIC X(329).
  4950     12  EN-ISSUE-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  4951         16  EN-INS-ORIG-LAST-NAME   PIC X(15).
  4952         16  EN-INS-ORIG-FIRST-NAME  PIC X(10).
  4953         16  EN-INS-ORIG-MIDDLE-INIT PIC X.
  4954         16  EN-INS-ORIG-AGE         PIC S999     COMP-3.
  4955         16  EN-JNT-ORIG-LAST-NAME   PIC X(15).
  4956         16  EN-JNT-ORIG-FIRST-NAME  PIC X(10).
  4957         16  EN-JNT-ORIG-MIDDLE-INIT PIC X.
  4958         16  EN-JNT-ORIG-AGE         PIC S999     COMP-3.
  4959         16  EN-LF-ORIG-BENCD        PIC XX.
  4960         16  EN-LF-ORIG-TERM         PIC S999      COMP-3.
  4961         16  EN-LF-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  4962         16  EN-LF-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  4963         16  EN-LF-ORIG-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
  4964         16  EN-LF-ORIG-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
  4965         16  EN-LF-ORIG-EXP-DT       PIC XX.
  4966*        16  EN-LF-ORIG-COV-TYPE     PIC X(10).
  4967         16  EN-ORIG-CRED-BENE       PIC X(25).
  4968         16  EN-LF-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  4969         16  FILLER                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  88
* EL6318.cbl
  4970         16  EN-AH-ORIG-BENCD        PIC XX.
  4971         16  EN-AH-ORIG-TERM         PIC S999      COMP-3.
  4972         16  EN-AH-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  4973         16  EN-AH-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  4974         16  EN-AH-ORIG-EXP-DT       PIC XX.
  4975*        16  EN-AH-ORIG-COV-TYPE     PIC X(10).
  4976*        16  EN-AH-ORIG-WAIT-PER     PIC 99.
  4977         16  EN-AH-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  4978         16  F                       PIC X(09).
  4979         16  EN-AH-ORIG-CP           PIC 99.
  4980         16  EN-INS-NEW-LAST-NAME    PIC X(15).
  4981         16  EN-INS-NEW-FIRST-NAME   PIC X(10).
  4982         16  EN-INS-NEW-MIDDLE-INIT  PIC X.
  4983         16  EN-INS-NEW-AGE          PIC S999     COMP-3.
  4984         16  EN-JNT-NEW-LAST-NAME    PIC X(15).
  4985         16  EN-JNT-NEW-FIRST-NAME   PIC X(10).
  4986         16  EN-JNT-NEW-MIDDLE-INIT  PIC X.
  4987         16  EN-JNT-NEW-AGE          PIC S999     COMP-3.
  4988         16  EN-LF-NEW-BENCD         PIC XX.
  4989         16  EN-LF-NEW-TERM          PIC S999      COMP-3.
  4990         16  EN-LF-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  4991         16  EN-LF-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  4992         16  EN-LF-NEW-ALT-BEN-AMT   PIC S9(9)V99  COMP-3.
  4993         16  EN-LF-NEW-ALT-PRM-AMT   PIC S9(7)V99  COMP-3.
  4994         16  EN-LF-NEW-EXP-DT        PIC XX.
  4995         16  EN-NEW-CRED-BENE        PIC X(25).
  4996         16  EN-LF-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  4997         16  FILLER                  PIC X.
  4998         16  EN-AH-NEW-BENCD         PIC XX.
  4999         16  EN-AH-NEW-TERM          PIC S999      COMP-3.
  5000         16  EN-AH-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  5001         16  EN-AH-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  5002         16  EN-AH-NEW-EXP-DT        PIC XX.
  5003*        16  EN-AH-NEW-COV-TYPE      PIC X(10).
  5004*        16  EN-AH-NEW-WAIT-PER      PIC 99.
  5005*        16  F                       PIC X(12).
  5006         16  EN-AH-NEW-CP            PIC 99.
  5007         16  EN-SIG-SW               PIC X.
  5008         16  EN-AH-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  5009         16  FILLER                  PIC X(37).
  5010     12  EN-CANCEL-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  5011         16  EN-LF-ORIG-REF-DT       PIC XX.
  5012         16  EN-LF-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  5013         16  EN-AH-ORIG-REF-DT       PIC XX.
  5014         16  EN-AH-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  5015         16  EN-LF-NEW-REF-DT        PIC XX.
  5016         16  EN-LF-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  5017         16  EN-AH-NEW-REF-DT        PIC XX.
  5018         16  EN-AH-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  5019         16  EN-FLAG-CERT            PIC X.
  5020         16  EN-INS-LAST-NAME        PIC X(15).
  5021         16  EN-INS-FIRST-NAME       PIC X(10).
  5022         16  EN-INS-MIDDLE-INIT      PIC X.
  5023         16  EN-LF-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  5024         16  EN-AH-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  5025         16  EN-LF-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  5026         16  EN-AH-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  5027         16  FILLER                  PIC X(262).
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  89
* EL6318.cbl
  5028     12  EN-MONEY-SW             PIC X.
  5029     12  EN-HEALTH-APP           PIC X.
  5030     12  EN-VOUCHER-SW           PIC X.
  5031     12  EN-PAYEE                PIC X(14).
  5032     12  EN-INPUT-DT             PIC XX.
  5033     12  EN-PROCESS-DT           PIC XX.
  5034     12  EN-LF-COMMISSION        PIC SV9(5)    COMP-3.
  5035     12  EN-AH-COMMISSION        PIC SV9(5)    COMP-3.
  5036     12  EN-REASON-CODES.
  5037         16  F OCCURS 12.
  5038             20  EN-REASON-CODE  PIC X(4).
  5039     12  EN-TEMPLATE-USED        PIC X(8).
  5040     12  EN-DOCU-TYPE            PIC X.
  5041         88  EN-VERI-DOCU          VALUE 'V'.
  5042         88  EN-GCE-DOCU           VALUE 'G'.
  5043         88  EN-CANC-DOCU          VALUE 'C'.
  5044     12  EN-COMMENTS1            PIC X(13).
  5045     12  EN-COMMENTS2            PIC X(70).
  5046     12  EN-COMM-CHGBK           PIC X.
  5047         88  EN-DO-NOT-CHG-ACCT    VALUE 'N'.
  5048         88  EN-CHG-ACCT           VALUE 'Y'.
  5049     12  EN-CSO-PORTION          PIC S9(5)V99  COMP-3.
  5050     12  EN-ACCT-PORTION         PIC S9(5)V99  COMP-3.
  5051     12  EN-BATCH-NUMBER         PIC X(6).
  5052     12  EN-ACCT-SUMM            PIC X.
  5053     12  EN-CSO-SUMM             PIC X.
  5054     12  FILLER                  PIC X(13).
  5055******************************************************************
  5056*                                COPY ERCNOTE.
  5057******************************************************************
  5058*                                                                *
  5059*                                                                *
  5060*                            ERCNOTE                             *
  5061*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5062*                            VMOD=2.003                          *
  5063*                                                                *
  5064*        FILE DESCRIPTION = CERTIFICATE AND BILLING NOTES        *
  5065*                                                                *
  5066*        FILE TYPE= VSAM,KSDS                                    *
  5067*        RECORD SIZE = 825    RECFORM = FIXED                    *
  5068*                                                                *
  5069*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  5070*                                                                *
  5071*        LOG = YES                                               *
  5072*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  5073*                                                                *
  5074******************************************************************
  5075*                   C H A N G E   L O G
  5076*
  5077* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5078*-----------------------------------------------------------------
  5079*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5080* EFFECTIVE    NUMBER
  5081*-----------------------------------------------------------------
  5082* 091509  CR2008100900003  AJRA  CERT NOTES MOVED TO NEW FILE. THI
  5083*                                FILE WILL CONTAIN BILLING NOTES O
  5084******************************************************************
  5085
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  90
* EL6318.cbl
  5086 01  CERTIFICATE-NOTE.
  5087     12  CN-RECORD-ID                PIC  XX.
  5088         88  VALID-CN-ID                  VALUE 'CN'.
  5089
  5090     12  CN-CONTROL-PRIMARY.
  5091         16  CN-COMPANY-CD           PIC X.
  5092         16  CN-CARRIER              PIC X.
  5093         16  CN-GROUPING.
  5094             20 CN-GROUPING-PREFIX   PIC XXX.
  5095             20 CN-GROUPING-PRIME    PIC XXX.
  5096         16  CN-STATE                PIC XX.
  5097         16  CN-ACCOUNT.
  5098             20 CN-ACCOUNT-PREFIX    PIC X(4).
  5099             20 CN-ACCOUNT-PRIME     PIC X(6).
  5100         16  CN-CERT-EFF-DT          PIC XX.
  5101         16  CN-CERT-NO.
  5102             20  CN-CERT-PRIME       PIC X(10).
  5103             20  CN-CERT-SFX         PIC X.
  5104
  5105     12  CN-BILLING-START-LINE-NO    PIC 99.
  5106     12  CN-BILLING-END-LINE-NO      PIC 99.
  5107
  5108     12  CN-LINES.
  5109         16  CN-LINE OCCURS 10       PIC X(77).
  5110
  5111     12  CN-LAST-MAINT-DT            PIC XX.
  5112     12  CN-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  5113     12  CN-LAST-MAINT-USER          PIC X(4).
  5114     12  FILLER                      PIC X(6).
  5115******************************************************************
  5116*                                COPY ERCMAIL.
  5117******************************************************************
  5118*                                                                *
  5119*                                                                *
  5120*                            ERCMAIL                             *
  5121*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5122*                            VMOD=2.003                          *
  5123*                                                                *
  5124*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  5125*                                                                *
  5126*   FILE TYPE = VSAM,KSDS                                        *
  5127*   RECORD SIZE = 374   RECFORM = FIX                            *
  5128*                                                                *
  5129*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  5130*   ALTERNATE PATH    = NOT USED                                 *
  5131*                                                                *
  5132*   LOG = YES                                                    *
  5133*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5134******************************************************************
  5135*                   C H A N G E   L O G
  5136*
  5137* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5138*-----------------------------------------------------------------
  5139*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5140* EFFECTIVE    NUMBER
  5141*-----------------------------------------------------------------
  5142* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  5143* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  91
* EL6318.cbl
  5144* 111108                   PEMA  ADD CRED BENE ADDR2
  5145******************************************************************
  5146
  5147 01  MAILING-DATA.
  5148     12  MA-RECORD-ID                      PIC XX.
  5149         88  VALID-MA-ID                       VALUE 'MA'.
  5150
  5151     12  MA-CONTROL-PRIMARY.
  5152         16  MA-COMPANY-CD                 PIC X.
  5153         16  MA-CARRIER                    PIC X.
  5154         16  MA-GROUPING.
  5155             20  MA-GROUPING-PREFIX        PIC XXX.
  5156             20  MA-GROUPING-PRIME         PIC XXX.
  5157         16  MA-STATE                      PIC XX.
  5158         16  MA-ACCOUNT.
  5159             20  MA-ACCOUNT-PREFIX         PIC X(4).
  5160             20  MA-ACCOUNT-PRIME          PIC X(6).
  5161         16  MA-CERT-EFF-DT                PIC XX.
  5162         16  MA-CERT-NO.
  5163             20  MA-CERT-PRIME             PIC X(10).
  5164             20  MA-CERT-SFX               PIC X.
  5165
  5166     12  FILLER                            PIC XX.
  5167
  5168     12  MA-ACCESS-CONTROL.
  5169         16  MA-SOURCE-SYSTEM              PIC XX.
  5170             88  MA-FROM-CREDIT                VALUE 'CR'.
  5171             88  MA-FROM-VSI                   VALUE 'VS'.
  5172             88  MA-FROM-WARRANTY              VALUE 'WA'.
  5173             88  MA-FROM-OTHER                 VALUE 'OT'.
  5174         16  MA-RECORD-ADD-DT              PIC XX.
  5175         16  MA-RECORD-ADDED-BY            PIC XXXX.
  5176         16  MA-LAST-MAINT-DT              PIC XX.
  5177         16  MA-LAST-MAINT-BY              PIC XXXX.
  5178         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  5179
  5180     12  MA-PROFILE-INFO.
  5181         16  MA-QUALIFY-CODE-1             PIC XX.
  5182         16  MA-QUALIFY-CODE-2             PIC XX.
  5183         16  MA-QUALIFY-CODE-3             PIC XX.
  5184         16  MA-QUALIFY-CODE-4             PIC XX.
  5185         16  MA-QUALIFY-CODE-5             PIC XX.
  5186
  5187         16  MA-INSURED-LAST-NAME          PIC X(15).
  5188         16  MA-INSURED-FIRST-NAME         PIC X(10).
  5189         16  MA-INSURED-MIDDLE-INIT        PIC X.
  5190         16  MA-INSURED-ISSUE-AGE          PIC 99.
  5191         16  MA-INSURED-BIRTH-DT           PIC XX.
  5192         16  MA-INSURED-SEX                PIC X.
  5193             88  MA-SEX-MALE                   VALUE 'M'.
  5194             88  MA-SEX-FEMALE                 VALUE 'F'.
  5195         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  5196
  5197         16  MA-ADDRESS-CORRECTED          PIC X.
  5198         16  MA-JOINT-BIRTH-DT             PIC XX.
  5199*        16  FILLER                        PIC X(12).
  5200
  5201         16  MA-ADDRESS-LINE-1             PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  92
* EL6318.cbl
  5202         16  MA-ADDRESS-LINE-2             PIC X(30).
  5203         16  MA-CITY-STATE.
  5204             20  MA-CITY                   PIC X(28).
  5205             20  MA-ADDR-STATE             PIC XX.
  5206         16  MA-ZIP.
  5207             20  MA-ZIP-CODE.
  5208                 24  MA-ZIP-CODE-1ST       PIC X(1).
  5209                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5210                 24  FILLER                PIC X(4).
  5211             20  MA-ZIP-PLUS4              PIC X(4).
  5212         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  5213             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  5214             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  5215             20  FILLER                    PIC X(3).
  5216
  5217         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  5218
  5219         16  FILLER                        PIC XXX.
  5220*        16  FILLER                        PIC X(10).
  5221
  5222     12  MA-CRED-BENE-INFO.
  5223         16  MA-CRED-BENE-NAME                 PIC X(25).
  5224         16  MA-CRED-BENE-ADDR                 PIC X(30).
  5225         16  MA-CRED-BENE-ADDR2                PIC X(30).
  5226         16  MA-CRED-BENE-CTYST.
  5227             20  MA-CRED-BENE-CITY             PIC X(28).
  5228             20  MA-CRED-BENE-STATE            PIC XX.
  5229         16  MA-CRED-BENE-ZIP.
  5230             20  MA-CB-ZIP-CODE.
  5231                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  5232                     88  MA-CB-CANADIAN-POST-CODE
  5233                                           VALUE 'A' THRU 'Z'.
  5234                 24  FILLER                    PIC X(4).
  5235             20  MA-CB-ZIP-PLUS4               PIC X(4).
  5236         16  MA-CB-CANADIAN-POSTAL-CODE
  5237                            REDEFINES MA-CRED-BENE-ZIP.
  5238             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  5239             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  5240             20  FILLER                        PIC X(3).
  5241     12  MA-POST-CARD-MAIL-DATA.
  5242         16  MA-MAIL-DATA OCCURS 7.
  5243             20  MA-MAIL-TYPE              PIC X.
  5244                 88  MA-12MO-MAILING           VALUE '1'.
  5245                 88  MA-EXP-MAILING            VALUE '2'.
  5246             20  MA-MAIL-STATUS            PIC X.
  5247                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  5248                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  5249                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  5250             20  MA-MAIL-DATE              PIC XX.
  5251     12  FILLER                            PIC XX.
  5252     12  FILLER                            PIC XX.
  5253*    12  FILLER                            PIC X(30).
  5254******************************************************************
  5255*                                COPY ERCARCH.
  5256******************************************************************
  5257*                                                                *
  5258*                            ERCARCH.                            *
  5259*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  93
* EL6318.cbl
  5260*                            VMOD=2.002                          *
  5261*                                                                *
  5262*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  5263*                                                                *
  5264*   FILE TYPE = VSAM,KSDS                                        *
  5265*   RECORD SIZE = 250  RECFORM = FIXED                           *
  5266*                                                                *
  5267*   BASE CLUSTER = ERARCH                        RKP=2,LEN=5     *
  5268*     ALTERNATE PATH1 = ERARCH2 (CERT/RESP)      RKP=07,LEN=35   *
  5269*     ALTERNATE PATH2 = ERARCH3 (FORM NUMBER)    RKP=44,LEN=28   *
  5270*     ALTERNATE PATH3 = ERARCH4 (PROCCESSOR ID)  RKP=73,LEN=28   *
  5271*     ALTERNATE PATH4 = ERARCH5 (ACCOUNT KEY)    RKP=100,LEN=24  *
  5272*     ALTERNATE PATH5 = ERARCH6 (BTCH/CHK KEY)   RKP=124,LEN=11  *
  5273*                                                                *
  5274*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5275******************************************************************
  5276*                   C H A N G E   L O G
  5277*
  5278* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5279*-----------------------------------------------------------------
  5280*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5281* EFFECTIVE    NUMBER
  5282*-----------------------------------------------------------------
  5283* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  5284* 070711  CR2011022800001  AJRA  NAPERSOFT CHANGES
  5285* 110612    2012101700002  AJRA  ADD NEW FIELDS
  5286******************************************************************
  5287 01  LETTER-ARCHIVE.
  5288     12  LA-RECORD-ID                PIC  X(02).
  5289         88  LA-VALID-ID                VALUE 'LA'.
  5290
  5291     12  LA-CONTROL-PRIMARY.
  5292         16  LA-COMPANY-CD           PIC  X(01).
  5293         16  LA-ARCHIVE-NO           PIC S9(08)    COMP.
  5294
  5295     12  LA-CONTROL-BY-CERT-RESP.
  5296         16  LA-COMPANY-CD-A2        PIC  X(01).
  5297         16  LA-CERT-NO-A2.
  5298             20  LA-CERT-PRIME-A2    PIC  X(10).
  5299             20  LA-CERT-SUFFIX-A2   PIC  X(01).
  5300         16  LA-RSP-PERSON-A2 REDEFINES LA-CERT-NO-A2.
  5301             20  LA-RESP-PERSON-A2   PIC  X(10).
  5302             20  LA-TYPE-A2          PIC  X(01).
  5303         16  LA-CARRIER-A2           PIC  X(01).
  5304         16  LA-GROUPING-A2          PIC  X(06).
  5305         16  LA-STATE-A2             PIC  X(02).
  5306         16  LA-ACCOUNT-A2           PIC  X(10).
  5307         16  LA-EFFECT-DATE-A2       PIC  X(02).
  5308         16  LA-ARCHIVE-NO-A2        PIC S9(08)    COMP.
  5309
  5310     12  LA-CONTROL-BY-FORM.
  5311         16  LA-COMPANY-CD-A3        PIC  X(01).
  5312         16  LA-FORM-A3              PIC  X(04).
  5313         16  LA-CARRIER-A3           PIC  X(01).
  5314         16  LA-GROUPING-A3          PIC  X(06).
  5315         16  LA-STATE-A3             PIC  X(02).
  5316         16  LA-ACCOUNT-A3           PIC  X(10).
  5317         16  LA-ARCHIVE-NO-A3        PIC S9(08)    COMP.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  94
* EL6318.cbl
  5318
  5319     12  LA-CONTROL-BY-PROCESSOR.
  5320         16  LA-COMPANY-CD-A4        PIC  X(01).
  5321         16  LA-PROCESSOR-CD         PIC  X(04).
  5322         16  LA-CARRIER-A4           PIC  X(01).
  5323         16  LA-GROUPING-A4          PIC  X(06).
  5324         16  LA-STATE-A4             PIC  X(02).
  5325         16  LA-ACCOUNT-A4           PIC  X(10).
  5326         16  LA-ARCHIVE-NO-A4        PIC S9(08)    COMP.
  5327
  5328     12  LA-CONTROL-BY-KEY-FIELDS.
  5329         16  LA-COMPANY-CD-A5        PIC  X(01).
  5330         16  LA-CARRIER-A5           PIC  X(01).
  5331         16  LA-GROUPING-A5          PIC  X(06).
  5332         16  LA-STATE-A5             PIC  X(02).
  5333         16  LA-ACCOUNT-A5           PIC  X(10).
  5334         16  LA-ARCHIVE-NO-A5        PIC S9(08)    COMP.
  5335
  5336     12  LA-CONTROL-BY-GROUP-CODE.
  5337         16  LA-COMPANY-CD-A6        PIC  X(01).
  5338         16  LA-ENTRY-A6.
  5339             20  LA-FILLER           PIC  X(02).
  5340             20  LA-QUE-CONTROL-A6   PIC S9(08)    COMP.
  5341         16  LA-ARCHIVE-NO-A6        PIC S9(08)    COMP.
  5342
  5343     12  FILLER                      PIC  X(09).
  5344
  5345     12  LA-HEADER-RECORD.
  5346         16  LA-NUMBER-LABEL-LINES   PIC S9(04)    COMP.
  5347         16  LA-CREATION-DATE        PIC  X(02).
  5348         16  LA-FOLLOW-UP-DATE       PIC  X(02).
  5349         16  LA-FINAL-ACT-DATE       REDEFINES
  5350               LA-FOLLOW-UP-DATE     PIC  X(02).
  5351         16  LA-INITIAL-PRINT-DATE   PIC  X(02).
  5352         16  LA-NO-OF-COPIES         PIC S9(01).
  5353         16  LA-NO-OF-TEXT-RECORDS   PIC S9(04)    COMP.
  5354         16  LA-REPLY-DATE           PIC  X(02).
  5355         16  LA-RESEND-DATES.
  5356             20  LA-RESEND-DATE      PIC  X(02).
  5357             20  LA-SENT-DATE        PIC  X(02).
  5358             20  FILLER              PIC  X(08).
  5359         16  LA-SOURCE-INFORMATION.
  5360             20  LA-DATA-SOURCE      PIC  X(01).
  5361             20  LA-ADDR-SOURCE      PIC  X(01).
  5362         16  LA-STATUS               PIC  X(01).
  5363             88  LA-STATUS-ACTIVE         VALUE 'A'.
  5364             88  LA-STATUS-COMPLETED      VALUE 'C'.
  5365             88  LA-STATUS-ON-HOLD        VALUE 'H'.
  5366             88  LA-STATUS-TO-BE-PURGED   VALUE 'X'.
  5367             88  LA-STATUS-PURGED         VALUE 'P'.
  5368             88  LA-STATUS-VOIDED         VALUE 'V'.
  5369         16  LA-LAST-RESENT-PRINT-DATE
  5370                                     PIC  X(02).
  5371         16  LA-PRINT-RESTRICTION    PIC  X(01).
  5372             88  LA-PRINT-ONLY-WHEN-CNTL-GIVEN
  5373                                          VALUE 'C'.
  5374             88  LA-PRINT-ONLY-WHEN-FORM-GIVEN
  5375                                          VALUE 'F'.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  95
* EL6318.cbl
  5376             88  LA-PRINT-ONLY-WHEN-PROC-GIVEN
  5377                                          VALUE 'P'.
  5378         16  LA-PURGED-DATE          PIC  X(02).
  5379         16  LA-VOIDED-DATE          PIC  X(02).
  5380         16  LA-RESEND-LETR          PIC  X(4).
  5381         16  FILLER                  PIC  X(08).
  5382*        16  LA-RESEND-LETR-2        PIC  X(4).
  5383*        16  LA-RESEND-LETR-3        PIC  X(4).
  5384*        16  FILLER                  PIC  X(59).
  5385         16  LA-ARCHIVE-STATUS       PIC  X.
  5386             88  LA-TEMP                VALUE 'T'.
  5387             88  LA-QWS                 VALUE 'Q'.
  5388             88  LA-BATCH               VALUE 'B'.
  5389         16  LA-FINAL-ACT-IND        PIC  X(1).
  5390         16  LA-VA-DISCLOSURE-IND    PIC  X(1).
  5391         16  LA-ENDT-ARCH-NO         PIC S9(8) COMP.
  5392         16  LA-ENDT-ARCH-NO-X REDEFINES LA-ENDT-ARCH-NO
  5393                                     PIC X(4).
  5394         16  FILLER                  PIC  X(42).
  5395*        16  FILLER                  PIC  X(71).
  5396         16  LA-LAST-MAINT-DATE      PIC  X(2).
  5397         16  LA-LAST-MAINT-TIME      PIC S9(6) COMP-3.
  5398         16  LA-LAST-MAINT-TIMEX  REDEFINES LA-LAST-MAINT-TIME
  5399                                     PIC  X(4).
  5400         16  LA-LAST-UPDATED-BY      PIC  X(4).
  5401
  5402******************************************************************
  5403*                                COPY ERCCNOT.
  5404******************************************************************
  5405*                                                                *
  5406*                            ERCCNOT                             *
  5407*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5408*                            VMOD=2.003                          *
  5409*                                                                *
  5410*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  5411*                                                                *
  5412*        FILE TYPE= VSAM,KSDS                                    *
  5413*        RECORD SIZE = 150    RECFORM = FIXED                    *
  5414*                                                                *
  5415*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  5416*                                                                *
  5417*        LOG = YES                                               *
  5418*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  5419*                                                                *
  5420******************************************************************
  5421*                   C H A N G E   L O G
  5422*
  5423* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5424*-----------------------------------------------------------------
  5425*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5426* EFFECTIVE    NUMBER
  5427*-----------------------------------------------------------------
  5428* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  5429******************************************************************
  5430
  5431 01  CERT-NOTE-FILE.
  5432     12  CZ-RECORD-ID                PIC  XX.
  5433         88  VALID-CZ-ID                  VALUE 'CZ'.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  96
* EL6318.cbl
  5434
  5435     12  CZ-CONTROL-PRIMARY.
  5436         16  CZ-COMPANY-CD           PIC X.
  5437         16  CZ-CARRIER              PIC X.
  5438         16  CZ-GROUPING.
  5439             20 CZ-GROUPING-PREFIX   PIC XXX.
  5440             20 CZ-GROUPING-PRIME    PIC XXX.
  5441         16  CZ-STATE                PIC XX.
  5442         16  CZ-ACCOUNT.
  5443             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  5444             20 CZ-ACCOUNT-PRIME     PIC X(6).
  5445         16  CZ-CERT-EFF-DT          PIC XX.
  5446         16  CZ-CERT-NO.
  5447             20  CZ-CERT-PRIME       PIC X(10).
  5448             20  CZ-CERT-SFX         PIC X.
  5449         16  CZ-RECORD-TYPE          PIC X.
  5450             88  CERT-NOTE           VALUE '1'.
  5451             88  CLAIM-CERT-NOTE     VALUE '2'.
  5452         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  5453
  5454     12  CZ-LAST-MAINT-DT            PIC XX.
  5455     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  5456     12  CZ-LAST-MAINT-USER          PIC X(4).
  5457
  5458     12  CZ-NOTE-INFORMATION.
  5459         16  CZ-NOTE                 PIC X(63).
  5460         16  FILLER                  PIC X(39).
  5461******************************************************************
  5462*                                COPY ELCEOBC.
  5463******************************************************************
  5464*                                                                *
  5465*                                                                *
  5466*                            ELCEOBC                             *
  5467*                            VMOD=2.001                          *
  5468*                                                                *
  5469*   CLAIM SYSTEM EOB CODE TABLE                                  *
  5470*                                                                *
  5471*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  5472*   VSAM EOB CODE TABLE                                          *
  5473*                                                                *
  5474*   FILE DESCRIPTION = EOB CODE TABLE                            *
  5475*                                                                *
  5476*   FILE TYPE = VSAM,KSDS                                        *
  5477*   RECORD SIZE = 350   RECFORM = FIX                            *
  5478*                                                                *
  5479*   BASE CLUSTER NAME = ELEOBC                    RKP=2,LEN=15   *
  5480*                                                                *
  5481*   LOG = NO                                                     *
  5482*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5483*                                                                *
  5484*                                                                *
  5485******************************************************************
  5486*                   C H A N G E   L O G
  5487*
  5488* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5489*-----------------------------------------------------------------
  5490*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5491* EFFECTIVE    NUMBER
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  97
* EL6318.cbl
  5492*-----------------------------------------------------------------
  5493* 120808    2008100900001  PEMA  NEW COPYBOOK/FILE
  5494* 081511    2011022800001  PEMA  CHG FOR ADMIN SERV NAPERSOFT
  5495******************************************************************
  5496 01  EOB-CODES.
  5497     12  EO-RECORD-ID                      PIC XX.
  5498         88  VALID-DN-ID                      VALUE 'EO'.
  5499     12  EO-CONTROL-PRIMARY.
  5500         16  EO-COMPANY-CD                 PIC X.
  5501         16  EO-RECORD-TYPE                PIC X.
  5502             88  EO-EOB-RECS                  VALUE '1'.
  5503             88  EO-VERIF-RECS                VALUE '2'.
  5504             88  EO-GCE-RECS                  VALUE '3'.
  5505         16  EO-EOB-CODE                   PIC X(4).
  5506         16  FILLER                        PIC X(9).
  5507     12  EO-MAINT-INFORMATION.
  5508         16  EO-LAST-MAINT-DT              PIC XX.
  5509         16  EO-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  5510         16  EO-LAST-MAINT-USER            PIC X(4).
  5511         16  FILLER                        PIC XX.
  5512     12  EO-DESCRIPTION                    PIC X(275).
  5513     12  FILLER                            PIC X(46).
  5514******************************************************************
  5515 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA VAR
  5516                          ACCOUNT-MASTER CONTROL-FILE
  5517                          PENDING-BUSINESS CERTIFICATE-MASTER
  5518                          ORIGINAL-CERTIFICATE
  5519                          ENDORSEMENT-RECORD CERTIFICATE-NOTE
  5520                          MAILING-DATA LETTER-ARCHIVE
  5521                          CERT-NOTE-FILE EOB-CODES.
  5522 0000-DFHEXIT SECTION.
  5523     MOVE '9#                    $   ' TO DFHEIV0.
  5524     MOVE 'EL6318' TO DFHEIV1.
  5525     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  5526     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK
  5527     MOVE EIBDATE                TO DC-JULIAN-YYDDD
  5528     MOVE '5'                    TO DC-OPTION-CODE
  5529     PERFORM 9700-DATE-LINK
  5530     MOVE DC-GREG-DATE-1-EDIT    TO WS-CURRENT-DT
  5531     MOVE DC-BIN-DATE-1          TO WS-CURRENT-BIN-DT
  5532     MOVE EIBTRMID               TO QID-TERM
  5533     MOVE 2                      TO EMI-NUMBER-OF-LINES
  5534     IF EIBCALEN = 0
  5535        GO TO 8800-UNAUTHORIZED-ACCESS
  5536     END-IF
  5537     MOVE FUNCTION LENGTH(EL631KI) TO MAP-LENGTH
  5538     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  5539        IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  5540           MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  5541           MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  5542           MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  5543           MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  5544           MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  5545           MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  5546           MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  5547           MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  5548           MOVE LOW-VALUES           TO EL631KI
  5549           MOVE 'Y'                  TO PI-CLEAR-ERROR-SW
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  98
* EL6318.cbl
  5550           GO TO 0350-BUILD-INIT-MAP
  5551        END-IF
  5552     END-IF
  5553     IF PI-CALLING-PROGRAM = 'EL614'
  5554        MOVE PI-PROGRAM-WORK-AREA (1:60)
  5555                                 TO WS-PASSED-REASON-CODES
  5556        DISPLAY ' COMING BACK FROM 614 ' WS-PASSED-REASON-CODES
  5557        IF WS-PASSED-REASON-CODES NOT = SPACES
  5558           MOVE 'Y'                TO WS-SET-CODES-MDT
  5559        ELSE
  5560           MOVE 'N'                TO WS-SET-CODES-MDT
  5561        END-IF
  5562        PERFORM 0600-RECOVER-TEMP-STORAGE
  5563                                 THRU 0600-EXIT
  5564        GO TO 0350-BUILD-INIT-MAP
  5565     END-IF
  5566     IF EIBAID = DFHCLEAR
  5567        IF PI-CLEAR-ERROR
  5568           MOVE SPACES            TO PI-CLEAR-ERROR-SW
  5569           MOVE ER-3833           TO EMI-ERROR
  5570           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5571           GO TO 0350-BUILD-INIT-MAP
  5572        ELSE
  5573           GO TO 9400-CLEAR
  5574        END-IF
  5575     END-IF
  5576     .
  5577 0200-RECEIVE.
  5578     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  5579        MOVE ER-0008             TO EMI-ERROR
  5580        PERFORM 9900-ERROR-FORMAT
  5581                                 THRU 9900-EXIT
  5582        MOVE -1                  TO PFENTRL
  5583        GO TO 8100-SEND-INITIAL-MAP
  5584     END-IF
  5585
  5586* EXEC CICS RECEIVE
  5587*        MAP      (MAP-NAME)
  5588*        MAPSET   (MAPSET-NAME)
  5589*        INTO     (EL631KI)
  5590*    END-EXEC
  5591     MOVE LENGTH OF
  5592      EL631KI
  5593       TO DFHEIV11
  5594*    MOVE '8"T I  L              ''   #00005581' TO DFHEIV0
  5595     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  5596     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5597     MOVE X'2020233030303035353831' TO DFHEIV0(25:11)
  5598     CALL 'kxdfhei1' USING DFHEIV0,
  5599           MAP-NAME,
  5600           EL631KI,
  5601           DFHEIV11,
  5602           MAPSET-NAME,
  5603           DFHEIV99,
  5604           DFHEIV99
  5605     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5606     IF PFENTRL = 0
  5607         GO TO 0300-CHECK-PFKEYS
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  99
* EL6318.cbl
  5608     END-IF
  5609     IF EIBAID NOT = DFHENTER
  5610         MOVE ER-0004            TO EMI-ERROR
  5611         GO TO 0320-INPUT-ERROR
  5612     END-IF
  5613     IF (PFENTRI NUMERIC) AND (PFENTRI > 0 AND < 25)
  5614        MOVE PF-VALUES (PFENTRI) TO EIBAID
  5615     ELSE
  5616        MOVE ER-0029            TO EMI-ERROR
  5617        GO TO 0320-INPUT-ERROR
  5618     END-IF
  5619     .
  5620 0300-CHECK-PFKEYS.
  5621     IF EIBAID = DFHPF3
  5622        MOVE 'Y'                 TO PI-CLEAR-ERROR-SW
  5623        PERFORM 0500-CREATE-TEMP-STORAGE THRU 0500-EXIT
  5624        MOVE 'EL614'             TO PGM-NAME
  5625        MOVE PI-REASON-CODE-IND  TO WS-SAVE-REASON-CODE-IND
  5626        MOVE SPACES              TO PI-PROGRAM-WORK-AREA
  5627        move +1                  to s2
  5628        perform varying s1 from +1 by +1 until s1 > +12
  5629           if reacd-in (s1) not = spaces and low-values
  5630              move reacd-in (s1)    to pi-program-work-area (s2:4)
  5631              add +5 to s2
  5632           end-if
  5633        END-perform
  5634        MOVE WS-SAVE-REASON-CODE-IND TO PI-REASON-CODE-IND
  5635        DISPLAY ' GOING TO 614 ' PI-PROGRAM-WORK-AREA (1:60)
  5636        GO TO 9300-XCTL
  5637     END-IF
  5638     IF EIBAID = DFHPF4 OR DFHPF8
  5639        GO TO 0360-FINALIZE
  5640     END-IF
  5641     IF EIBAID = DFHPF23
  5642        IF PI-CLEAR-ERROR
  5643           MOVE SPACES            TO PI-CLEAR-ERROR-SW
  5644           MOVE ER-3833           TO EMI-ERROR
  5645           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5646           GO TO 0350-BUILD-INIT-MAP
  5647        ELSE
  5648           GO TO 8810-PF23
  5649        END-IF
  5650     END-IF
  5651     IF EIBAID = DFHPF24
  5652        IF PI-CLEAR-ERROR
  5653           MOVE SPACES            TO PI-CLEAR-ERROR-SW
  5654           MOVE ER-3833           TO EMI-ERROR
  5655           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5656           GO TO 0350-BUILD-INIT-MAP
  5657        ELSE
  5658           GO TO 9200-RETURN-MAIN-MENU
  5659        END-IF
  5660     END-IF
  5661     IF EIBAID = DFHPF12
  5662        GO TO 9500-PF12
  5663     END-IF
  5664     IF EIBAID = DFHENTER
  5665        MOVE 'Y'                 TO PI-CLEAR-ERROR-SW
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 100
* EL6318.cbl
  5666        GO TO 0325-EDIT-SCREEN
  5667     END-IF
  5668     MOVE ER-0029                TO EMI-ERROR
  5669     .
  5670 0320-INPUT-ERROR.
  5671     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5672     MOVE AL-UNBON               TO PFENTRA
  5673     MOVE -1                     TO PFENTRL
  5674     GO TO 8200-SEND-DATAONLY
  5675     .
  5676 0325-EDIT-SCREEN.
  5677     IF PRTSWL > ZEROS
  5678       IF PRTSWI = 'Y' OR 'N' OR 'P' OR ' '
  5679*          MOVE AL-UANON       TO PRTSWA
  5680*          IF PRTSWI = ' '
  5681*             MOVE 'N'         TO PRTSWI
  5682              MOVE 'P'         TO PRTSWI
  5683*          END-IF
  5684*          MOVE PRTSWI         TO PI-PRTSW-ENTERED
  5685        END-IF
  5686     END-IF
  5687     IF (SIGREQL > ZEROS)
  5688        AND (SIGREQI = 'Y' OR 'N' OR ' ')
  5689        MOVE AL-UANON         TO SIGREQA
  5690        IF SIGREQI = ' '
  5691           MOVE 'N'           TO SIGREQI
  5692        END-IF
  5693        MOVE SIGREQI          TO PI-SIGREQ-ENTERED
  5694     ELSE
  5695        MOVE ER-2651          TO EMI-ERROR
  5696        MOVE -1               TO SIGREQL
  5697        MOVE AL-UABON         TO SIGREQA
  5698        PERFORM 9900-ERROR-FORMAT
  5699                                 THRU 9900-EXIT
  5700     END-IF
  5701     IF LTRIDL > ZEROS
  5702        AND LTRIDI > SPACES
  5703        MOVE PI-COMPANY-CD       TO LETR-COMPANY-CD
  5704        MOVE LTRIDI              TO LETR-LETTER-ID
  5705                                    PI-LTRID-ENTERED
  5706        MOVE LETR-PART-KEY       TO ELLETR-SAVE-PART-KEY
  5707        MOVE SPACES              TO LETR-FILLER
  5708        MOVE 0                   TO LETR-SEQ-NO
  5709        PERFORM 0326-GET-Z-RECORD THRU 0326-EXIT
  5710     ELSE
  5711        MOVE ER-1236          TO EMI-ERROR
  5712        MOVE -1               TO LTRIDL
  5713        MOVE AL-UABON         TO LTRIDA
  5714        PERFORM 9900-ERROR-FORMAT
  5715                                 THRU 9900-EXIT
  5716     END-IF
  5717
  5718     IF W-PROMPT-LETTER EQUAL 'Y'
  5719         MOVE ER-0894            TO EMI-ERROR
  5720         MOVE -1                 TO LTRIDL
  5721         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5722     END-IF
  5723     IF VOUCHL > ZEROS
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 101
* EL6318.cbl
  5724        IF VOUCHI = 'Y' OR 'N'
  5725           MOVE AL-UANON         TO VOUCHA
  5726           MOVE VOUCHI           TO PI-VOUCHER-ENTERED
  5727        ELSE
  5728           MOVE ER-9999          TO EMI-ERROR
  5729           MOVE -1               TO VOUCHL
  5730           MOVE AL-UABON         TO VOUCHA
  5731           PERFORM 9900-ERROR-FORMAT
  5732                                 THRU 9900-EXIT
  5733        END-IF
  5734     END-IF
  5735     IF HLTHAPPL > ZEROS
  5736        IF HLTHAPPI = 'Y' OR 'N'
  5737           MOVE AL-UANON         TO HLTHAPPA
  5738           MOVE HLTHAPPI         TO PI-HLTHAPP-ENTERED
  5739        ELSE
  5740           MOVE ER-9999          TO EMI-ERROR
  5741           MOVE -1               TO HLTHAPPL
  5742           MOVE AL-UABON         TO HLTHAPPA
  5743           PERFORM 9900-ERROR-FORMAT
  5744                                 THRU 9900-EXIT
  5745        END-IF
  5746     END-IF
  5747     IF PAYEEL > ZEROS
  5748        IF PAYEEI > SPACES
  5749           MOVE AL-UANON         TO PAYEEA
  5750           MOVE PAYEEI           TO PI-PAYEE-ENTERED
  5751        ELSE
  5752           MOVE ER-9999          TO EMI-ERROR
  5753           MOVE -1               TO PAYEEL
  5754           MOVE AL-UABON         TO PAYEEA
  5755           PERFORM 9900-ERROR-FORMAT
  5756                                 THRU 9900-EXIT
  5757        END-IF
  5758     END-IF
  5759     IF CERTIDL > ZEROS
  5760         IF CERTIDI NUMERIC
  5761            MOVE AL-UANON      TO CERTIDA
  5762            MOVE CERTIDI       TO PI-CERTID-ENTERED
  5763         ELSE
  5764            MOVE ER-1778       TO EMI-ERROR
  5765            MOVE -1            TO CERTIDL
  5766            MOVE AL-UABON      TO CERTIDA
  5767            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5768        END-IF
  5769     ELSE
  5770        IF PI-PRINT-CERTIFICATE = 'Y'
  5771            MOVE ER-0715       TO EMI-ERROR
  5772            MOVE -1            TO CERTIDL
  5773            MOVE AL-UABON      TO CERTIDA
  5774            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5775        END-IF
  5776     END-IF
  5777     SET REASONS-NOT-FOUND TO TRUE
  5778     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  5779        IF REACDL (S1) = +4 OR
  5780          (REACD-IN (S1) NOT = SPACES AND LOW-VALUES)
  5781              MOVE AL-SANON     TO REACDA (S1)
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 102
* EL6318.cbl
  5782              SET REASONS-FOUND TO TRUE
  5783        END-IF
  5784     END-PERFORM
  5785
  5786     IF REASONS-NOT-FOUND
  5787        MOVE ER-1820             TO EMI-ERROR
  5788        MOVE -1                  TO PFENTRL
  5789        PERFORM 9900-ERROR-FORMAT
  5790                                 THRU 9900-EXIT
  5791     ELSE
  5792        MOVE REASONCDS           TO PI-REASONS-ENTERED
  5793     END-IF
  5794
  5795     IF CRTNT1L > ZEROS
  5796        IF CRTNT1I > SPACES
  5797           MOVE CRTNT1I          TO PI-CERTNT1-ENTERED
  5798        END-IF
  5799     END-IF
  5800
  5801     IF CRTNT2L > ZEROS
  5802        IF CRTNT2I > SPACES
  5803           MOVE CRTNT2I          TO PI-CERTNT2-ENTERED
  5804        END-IF
  5805     END-IF
  5806
  5807     IF CRTNT3L > ZEROS
  5808        IF CRTNT3I > SPACES
  5809           MOVE CRTNT3I          TO PI-CERTNT3-ENTERED
  5810        END-IF
  5811     END-IF
  5812
  5813     IF CRTNT4L > ZEROS
  5814        IF CRTNT4I > SPACES
  5815           MOVE CRTNT4I          TO PI-CERTNT4-ENTERED
  5816        END-IF
  5817     END-IF
  5818
  5819     IF BILNT1L > ZEROS
  5820        IF BILNT1I > SPACES
  5821           MOVE BILNT1I          TO PI-BILLNT1-ENTERED
  5822        END-IF
  5823     END-IF
  5824
  5825     IF BILNT2L > ZEROS
  5826        IF BILNT2I > SPACES
  5827           MOVE BILNT2I          TO PI-BILLNT2-ENTERED
  5828        END-IF
  5829     END-IF
  5830
  5831     .
  5832 0325-EXIT.
  5833     EXIT.
  5834
  5835 0326-GET-Z-RECORD.
  5836
  5837     MOVE SPACES  TO W-Z-CONTROL-DATA
  5838
  5839
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 103
* EL6318.cbl
  5840* EXEC CICS STARTBR
  5841*         DATASET    ('ELLETR')
  5842*         RIDFLD     (ELLETR-KEY)
  5843*         GTEQ
  5844*         RESP      (WS-RESPONSE)
  5845*    END-EXEC.
  5846     MOVE 'ELLETR' TO DFHEIV1
  5847     MOVE 0
  5848       TO DFHEIV11
  5849*    MOVE '&,         G          &  N#00005819' TO DFHEIV0
  5850     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  5851     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5852     MOVE X'204E233030303035383139' TO DFHEIV0(25:11)
  5853     CALL 'kxdfhei1' USING DFHEIV0,
  5854           DFHEIV1,
  5855           ELLETR-KEY,
  5856           DFHEIV99,
  5857           DFHEIV11,
  5858           DFHEIV99
  5859     MOVE EIBRESP  TO WS-RESPONSE
  5860     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5861
  5862     IF NOT RESP-NORMAL
  5863         MOVE ER-1236          TO EMI-ERROR
  5864         MOVE -1               TO LTRIDL
  5865         MOVE AL-UABON         TO LTRIDA
  5866         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5867         GO TO 0326-ENDBR
  5868     END-IF.
  5869
  5870 0326-READNEXT.
  5871
  5872
  5873* EXEC CICS READNEXT
  5874*        DATASET   ('ELLETR')
  5875*        INTO      (TEXT-FILES)
  5876*        RIDFLD    (ELLETR-KEY)
  5877*        RESP      (WS-RESPONSE)
  5878*    END-EXEC
  5879     MOVE LENGTH OF
  5880      TEXT-FILES
  5881       TO DFHEIV12
  5882     MOVE 'ELLETR' TO DFHEIV1
  5883     MOVE 0
  5884       TO DFHEIV11
  5885*    MOVE '&.IL                  )  N#00005835' TO DFHEIV0
  5886     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  5887     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5888     MOVE X'204E233030303035383335' TO DFHEIV0(25:11)
  5889     CALL 'kxdfhei1' USING DFHEIV0,
  5890           DFHEIV1,
  5891           TEXT-FILES,
  5892           DFHEIV12,
  5893           ELLETR-KEY,
  5894           DFHEIV99,
  5895           DFHEIV11,
  5896           DFHEIV99,
  5897           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 104
* EL6318.cbl
  5898     MOVE EIBRESP  TO WS-RESPONSE
  5899     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5900     IF RESP-NORMAL
  5901        IF TX-CONTROL-PRIMARY(1:5) NOT = ELLETR-SAVE-PART-KEY
  5902           MOVE ER-1236          TO EMI-ERROR
  5903           MOVE -1               TO LTRIDL
  5904           MOVE AL-UABON         TO LTRIDA
  5905           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5906           GO TO 0326-ENDBR
  5907        END-IF
  5908
  5909        MOVE AL-UANON         TO LTRIDA
  5910        IF TX-LINE-SQUEEZE-CONTROL = 'Z'
  5911           MOVE TX-TEXT-LINE  TO W-Z-CONTROL-DATA
  5912        ELSE
  5913           GO TO 0326-READNEXT
  5914        END-IF
  5915     ELSE
  5916        MOVE ER-1236          TO EMI-ERROR
  5917        MOVE -1               TO LTRIDL
  5918        MOVE AL-UABON         TO LTRIDA
  5919        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5920        GO TO 0326-ENDBR
  5921     END-IF.
  5922
  5923 0326-ENDBR.
  5924
  5925
  5926* EXEC CICS ENDBR
  5927*        DATASET     ('ELLETR')
  5928*    END-EXEC.
  5929     MOVE 'ELLETR' TO DFHEIV1
  5930     MOVE 0
  5931       TO DFHEIV11
  5932*    MOVE '&2                    $   #00005866' TO DFHEIV0
  5933     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  5934     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5935     MOVE X'2020233030303035383636' TO DFHEIV0(25:11)
  5936     CALL 'kxdfhei1' USING DFHEIV0,
  5937           DFHEIV1,
  5938           DFHEIV11,
  5939           DFHEIV99
  5940     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5941
  5942
  5943 0326-EXIT.
  5944      EXIT.
  5945 0330-CHECK-ERRORS.
  5946     IF EMI-NO-ERRORS
  5947        GO TO 0350-BUILD-INIT-MAP
  5948     ELSE
  5949        GO TO 8200-SEND-DATAONLY
  5950     END-IF
  5951     .
  5952 0330-EXIT.
  5953     EXIT.
  5954 0350-BUILD-INIT-MAP.
  5955     MOVE PI-CRTO-CARRIER        TO CARRO
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 105
* EL6318.cbl
  5956     MOVE PI-CRTO-GROUPING       TO GROUPO
  5957     MOVE PI-CRTO-STATE          TO STATEO
  5958     MOVE PI-CRTO-ACCOUNT        TO ACCTO
  5959     MOVE PI-CRTO-CERT-PRIME     TO CERTNOO
  5960     MOVE PI-CRTO-CERT-SFX       TO CRTSFXO
  5961     MOVE PI-CRTO-SEQ-NO         TO SEQNOO
  5962     MOVE PI-CRTO-CERT-EFF-DT    TO DC-BIN-DATE-1
  5963     MOVE ' '                    TO DC-OPTION-CODE
  5964     PERFORM 9700-DATE-LINK
  5965     IF NO-CONVERSION-ERROR
  5966        MOVE DC-GREG-DATE-1-EDIT TO EFFDTO
  5967     END-IF
  5968*     IF PI-PRTSW-ENTERED > SPACES
  5969*        MOVE PI-PRTSW-ENTERED    TO PRTSWI
  5970*        MOVE AL-UANON            TO PRTSWA
  5971*        MOVE +1                  TO PRTSWL
  5972*     END-IF
  5973
  5974     IF PI-SIGREQ-ENTERED > SPACES
  5975        MOVE PI-SIGREQ-ENTERED   TO SIGREQI
  5976        MOVE AL-UANON            TO SIGREQA
  5977        MOVE +1                  TO SIGREQL
  5978     ELSE
  5979        IF PI-CLAIM-REFORMATION
  5980            MOVE 'Y'             TO SIGREQI
  5981            MOVE AL-UANON        TO SIGREQA
  5982            MOVE +1              TO SIGREQL
  5983        END-IF
  5984     END-IF
  5985
  5986     IF PI-LTRID-ENTERED > SPACES
  5987        MOVE PI-LTRID-ENTERED    TO LTRIDI
  5988        MOVE AL-UANON            TO LTRIDA
  5989        MOVE +4                  TO LTRIDL
  5990     ELSE
  5991        IF PI-CLAIM-REFORMATION
  5992            MOVE 'CLRF'          TO LTRIDI
  5993            MOVE AL-UANON        TO LTRIDA
  5994            MOVE +4              TO LTRIDL
  5995        END-IF
  5996     END-IF
  5997
  5998     IF PI-VOUCHER-ENTERED > SPACES
  5999        MOVE PI-VOUCHER-ENTERED  TO VOUCHI
  6000        MOVE AL-UANON            TO VOUCHA
  6001        MOVE +1                  TO VOUCHL
  6002     END-IF
  6003
  6004     IF PI-HLTHAPP-ENTERED > SPACES
  6005        MOVE PI-HLTHAPP-ENTERED  TO HLTHAPPI
  6006        MOVE AL-UANON            TO HLTHAPPA
  6007        MOVE +1                  TO HLTHAPPL
  6008     END-IF
  6009
  6010     IF PI-PAYEE-ENTERED > SPACES
  6011        MOVE PI-PAYEE-ENTERED    TO PAYEEI
  6012        MOVE AL-UANON            TO PAYEEA
  6013        MOVE +10                 TO PAYEEL
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 106
* EL6318.cbl
  6014     END-IF
  6015
  6016     IF PI-CERTID-ENTERED > SPACES
  6017        MOVE PI-CERTID-ENTERED   TO CERTIDI
  6018        MOVE AL-UANON            TO CERTIDA
  6019        MOVE +5                  TO CERTIDL
  6020     END-IF
  6021
  6022     SET REASONS-NOT-FOUND TO TRUE
  6023     MOVE PI-REASONS-ENTERED     TO REASONCDS
  6024     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  6025        IF REACDL (S1) = +4 OR
  6026          (REACD-IN (S1) NOT = SPACES AND LOW-VALUES)
  6027              MOVE AL-SANON      TO REACDA (S1)
  6028              MOVE +4            TO REACDL (S1)
  6029              SET REASONS-FOUND  TO TRUE
  6030        END-IF
  6031     END-PERFORM
  6032
  6033     IF REASONS-NOT-FOUND
  6034         IF PI-CLAIM-REFORMATION
  6035            MOVE 'CRNA'          TO REACD-IN (1)
  6036            MOVE AL-SANON        TO REACDA (1)
  6037            MOVE +4              TO REACDL (1)
  6038            SET REASONS-FOUND    TO TRUE
  6039        END-IF
  6040     END-IF
  6041
  6042     IF PI-CERTNT1-ENTERED > SPACES
  6043        MOVE PI-CERTNT1-ENTERED  TO CRTNT1I
  6044        MOVE AL-UANON            TO CRTNT1A
  6045        MOVE +63                 TO CRTNT1L
  6046     END-IF
  6047
  6048     IF PI-CERTNT2-ENTERED > SPACES
  6049        MOVE PI-CERTNT2-ENTERED  TO CRTNT2I
  6050        MOVE AL-UANON            TO CRTNT2A
  6051        MOVE +63                 TO CRTNT2L
  6052     END-IF
  6053
  6054     IF PI-CERTNT3-ENTERED > SPACES
  6055        MOVE PI-CERTNT3-ENTERED  TO CRTNT3I
  6056        MOVE AL-UANON            TO CRTNT3A
  6057        MOVE +63                 TO CRTNT3L
  6058     END-IF
  6059
  6060     IF PI-CERTNT4-ENTERED > SPACES
  6061        MOVE PI-CERTNT4-ENTERED  TO CRTNT4I
  6062        MOVE AL-UANON            TO CRTNT4A
  6063        MOVE +63                 TO CRTNT4L
  6064     END-IF
  6065
  6066     IF PI-BILLNT1-ENTERED > SPACES
  6067        MOVE PI-BILLNT1-ENTERED  TO BILNT1I
  6068        MOVE AL-UANON            TO BILNT1A
  6069        MOVE +63                 TO BILNT1L
  6070     END-IF
  6071
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 107
* EL6318.cbl
  6072     IF PI-BILLNT2-ENTERED > SPACES
  6073        MOVE PI-BILLNT2-ENTERED  TO BILNT2I
  6074        MOVE AL-UANON            TO BILNT2A
  6075        MOVE +63                 TO BILNT2L
  6076     END-IF
  6077
  6078     GO TO 8100-SEND-INITIAL-MAP
  6079     .
  6080 0360-FINALIZE.
  6081     display ' made it to 0360 '
  6082     set P to address of KIXSYS
  6083     CALL "getenv" using by value P returning var-ptr
  6084     if var-ptr = null then
  6085        display ' kixsys not set '
  6086     else
  6087        set address of var to var-ptr
  6088        move 0 to env-var-len
  6089        inspect var tallying env-var-len
  6090          for characters before X'00'
  6091*       DISPLAY '  KIXSYS = ' var (1:env-var-len)
  6092        unstring var (1:env-var-len) delimited by '/'
  6093           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  6094              WS-KIX-SYS
  6095        end-unstring
  6096*       DISPLAY ' WS KIX SYS ' WS-KIXSYS
  6097*       DISPLAY ' WS KIX MYENV ' WS-KIX-MYENV
  6098     end-if
  6099     set P to address of KIXHOST
  6100     CALL "getenv" using by value P returning var-ptr
  6101     if var-ptr = null then
  6102        display ' kixhost not set '
  6103     else
  6104        set address of var to var-ptr
  6105        move 0 to env-var-len
  6106        inspect var tallying env-var-len
  6107          for characters before X'00'
  6108*       DISPLAY '  KIXHOST = ' var (1:env-var-len)
  6109        MOVE var(1:env-var-len)  to ws-kixhost
  6110        DISPLAY ' WS KIX HOST ' WS-KIXhost
  6111     end-if
  6112     PERFORM 0325-EDIT-SCREEN    THRU 0325-EXIT
  6113     IF NOT EMI-NO-ERRORS
  6114       AND EIBAID = DFHPF4
  6115        GO TO 8200-SEND-DATAONLY
  6116     END-IF
  6117     MOVE LOW-VALUES             TO NEW-ELCRTO-REC
  6118     MOVE PI-ELCRTO-KEY          TO ELCRTO-KEY
  6119                                    NEW-ELCRTO-KEY
  6120     SUBTRACT +1               FROM NCRTO-SEQ-NO
  6121     PERFORM 0362-READ-ELCRTO    THRU 0362-EXIT
  6122     IF RESP-NORMAL
  6123        AND (PI-ELCRTO-KEY = OC-CONTROL-PRIMARY)
  6124        DISPLAY ' RESP NORMAL AND = '
  6125        PERFORM 0400-ADD-ERENDT  THRU 0400-EXIT
  6126*       PERFORM 1000-BUILD-ERARCH THRU 1000-EXIT
  6127        PERFORM 1100-CALL-NS-BUS-LOGIC
  6128                                 THRU 1100-EXIT
  6129        IF BL-OK
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 108
* EL6318.cbl
  6130           CONTINUE
  6131        ELSE
  6132           MOVE ER-8888          TO EMI-ERROR-NUMBER (1)
  6133           MOVE BL-MESSAGE       TO EMI-ERROR-TEXT (1)
  6134           MOVE -1               TO SIGREQL
  6135        END-IF
  6136     ELSE
  6137        MOVE ER-9999             TO EMI-ERROR
  6138        PERFORM 9900-ERROR-FORMAT
  6139                                 THRU 9900-EXIT
  6140        MOVE -1                  TO SIGREQL
  6141        GO TO 8100-SEND-INITIAL-MAP
  6142     END-IF
  6143     MOVE FUNCTION UPPER-CASE(WS-KIX-MYENV)
  6144                                 TO SYSO
  6145     MOVE WS-KIXHOST             TO HOSTO
  6146     MOVE PI-COMPANY-ID          TO COMPANYO
  6147     MOVE '4'                    TO DATASORO
  6148     MOVE BL-BATCH-NO            TO BATCHNOO
  6149     MOVE BL-BATCH-SEQ           TO BSEQNOO
  6150     MOVE BL-ARCHIVE-NO          TO ARCHNOO
  6151     MOVE PI-PROCESSOR-ID        TO PROCIDO
  6152*    MOVE 'N'                    TO PRTSWO
  6153*    MOVE -1                     TO PRTSWL
  6154*    MOVE AL-UANON               TO PRTSWA
  6155     MOVE -1                     TO SIGREQL
  6156     MOVE AL-UANON               TO SIGREQA
  6157     IF EIBAID = DFHPF4
  6158        MOVE SPACES              TO PI-CLEAR-ERROR-SW
  6159        MOVE ER-0280             TO EMI-ERROR
  6160        PERFORM 9900-ERROR-FORMAT
  6161                                 THRU 9900-EXIT
  6162        MOVE BL-ARCHIVE-NO       TO W-ARCH-SUPPRESS
  6163        MOVE W-ARCH-EDIT         TO EMI-TEXT-VARIABLE (1)
  6164        MOVE 'Y'                 TO PI-FINALIZED-IND
  6165        GO TO 9400-CLEAR
  6166     ELSE
  6167        MOVE ER-1818             TO EMI-ERROR
  6168        PERFORM 9900-ERROR-FORMAT
  6169                                 THRU 9900-EXIT
  6170     END-IF
  6171     GO TO 0350-BUILD-INIT-MAP
  6172     .
  6173 0360-EXIT.
  6174     EXIT.
  6175 0362-READ-ELCRTO.
  6176     display ' made it to 0362 '
  6177
  6178* EXEC CICS READ
  6179*        DATASET   (WS-ELCRTO-FILE-ID)
  6180*        SET       (ADDRESS OF ORIGINAL-CERTIFICATE)
  6181*        RIDFLD    (ELCRTO-KEY)
  6182*        RESP      (WS-RESPONSE)
  6183*    END-EXEC
  6184*    MOVE '&"S        E          (  N#00006104' TO DFHEIV0
  6185     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6186     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6187     MOVE X'204E233030303036313034' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 109
* EL6318.cbl
  6188     CALL 'kxdfhei1' USING DFHEIV0,
  6189           WS-ELCRTO-FILE-ID,
  6190           DFHEIV20,
  6191           DFHEIV99,
  6192           ELCRTO-KEY,
  6193           DFHEIV99,
  6194           DFHEIV99,
  6195           DFHEIV99
  6196     SET ADDRESS OF ORIGINAL-CERTIFICATE TO
  6197         DFHEIV20
  6198     MOVE EIBRESP  TO WS-RESPONSE
  6199     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6200     .
  6201 0362-EXIT.
  6202     EXIT.
  6203 0363-READ-ELCRTO-UPD.
  6204     display ' made it to 0363 '
  6205
  6206* EXEC CICS READ
  6207*        DATASET   (WS-ELCRTO-FILE-ID)
  6208*        SET       (ADDRESS OF ORIGINAL-CERTIFICATE)
  6209*        RIDFLD    (ELCRTO-KEY)
  6210*        UPDATE
  6211*        RESP      (WS-RESPONSE)
  6212*    END-EXEC
  6213*    MOVE '&"S        EU         (  N#00006115' TO DFHEIV0
  6214     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6215     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  6216     MOVE X'204E233030303036313135' TO DFHEIV0(25:11)
  6217     CALL 'kxdfhei1' USING DFHEIV0,
  6218           WS-ELCRTO-FILE-ID,
  6219           DFHEIV20,
  6220           DFHEIV99,
  6221           ELCRTO-KEY,
  6222           DFHEIV99,
  6223           DFHEIV99,
  6224           DFHEIV99
  6225     SET ADDRESS OF ORIGINAL-CERTIFICATE TO
  6226         DFHEIV20
  6227     MOVE EIBRESP  TO WS-RESPONSE
  6228     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6229     .
  6230 0363-EXIT.
  6231     EXIT.
  6232 0365-READ-ERENDT.
  6233
  6234* EXEC CICS READ
  6235*        DATASET   (WS-ERENDT-FILE-ID)
  6236*        SET       (ADDRESS OF ENDORSEMENT-RECORD)
  6237*        RIDFLD    (ERENDT-KEY)
  6238*        RESP      (WS-RESPONSE)
  6239*    END-EXEC
  6240*    MOVE '&"S        E          (  N#00006126' TO DFHEIV0
  6241     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6242     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6243     MOVE X'204E233030303036313236' TO DFHEIV0(25:11)
  6244     CALL 'kxdfhei1' USING DFHEIV0,
  6245           WS-ERENDT-FILE-ID,
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 110
* EL6318.cbl
  6246           DFHEIV20,
  6247           DFHEIV99,
  6248           ERENDT-KEY,
  6249           DFHEIV99,
  6250           DFHEIV99,
  6251           DFHEIV99
  6252     SET ADDRESS OF ENDORSEMENT-RECORD TO
  6253         DFHEIV20
  6254     MOVE EIBRESP  TO WS-RESPONSE
  6255     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6256     .
  6257 0365-EXIT.
  6258     EXIT.
  6259 0400-ADD-ERENDT.
  6260     PERFORM 1500-GET-ARCH-NO    THRU 1500-EXIT
  6261     display ' made it to 0400 '
  6262
  6263* EXEC CICS GETMAIN
  6264*         SET      (ADDRESS OF ENDORSEMENT-RECORD)
  6265*         LENGTH   (ERENDT-LENGTH)
  6266*         INITIMG  (GETMAIN-SPACE)
  6267*    END-EXEC
  6268*    MOVE ',"IL                  $   #00006138' TO DFHEIV0
  6269     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6270     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6271     MOVE X'2020233030303036313338' TO DFHEIV0(25:11)
  6272     CALL 'kxdfhei1' USING DFHEIV0,
  6273           DFHEIV20,
  6274           ERENDT-LENGTH,
  6275           GETMAIN-SPACE
  6276     SET ADDRESS OF ENDORSEMENT-RECORD TO
  6277         DFHEIV20
  6278     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6279     PERFORM 0410-INIT-ERENDT    THRU 0410-EXIT
  6280     MOVE PI-PROCESSOR-ID        TO EN-LAST-MAINT-BY
  6281     MOVE EIBTIME                TO EN-LAST-MAINT-HHMMSS
  6282     MOVE WS-CURRENT-BIN-DT      TO EN-LAST-MAINT-DT
  6283                                    EN-INPUT-DT
  6284                                    EN-PROCESS-DT
  6285
  6286     MOVE OC-INS-FIRST-NAME    TO EN-INS-ORIG-FIRST-NAME
  6287     MOVE OC-INS-MIDDLE-INIT   TO EN-INS-ORIG-MIDDLE-INIT
  6288     MOVE OC-INS-LAST-NAME     TO EN-INS-ORIG-LAST-NAME
  6289     MOVE OC-INS-AGE           TO EN-INS-ORIG-AGE
  6290     MOVE OC-JNT-FIRST-NAME    TO EN-JNT-ORIG-FIRST-NAME
  6291     MOVE OC-JNT-MIDDLE-INIT   TO EN-JNT-ORIG-MIDDLE-INIT
  6292     MOVE OC-JNT-LAST-NAME     TO EN-JNT-ORIG-LAST-NAME
  6293     MOVE OC-JNT-AGE           TO EN-JNT-ORIG-AGE
  6294     MOVE OC-LF-BENCD          TO EN-LF-ORIG-BENCD
  6295     IF OC-LF-BENCD NOT = '00' AND '  '
  6296        MOVE OC-LF-BEN-AMT       TO EN-LF-ORIG-BEN-AMT
  6297        MOVE OC-LF-PRM-AMT       TO EN-LF-ORIG-PRM-AMT
  6298        MOVE OC-LF-ALT-BEN-AMT   TO EN-LF-ORIG-ALT-BEN-AMT
  6299        MOVE OC-LF-ALT-PRM-AMT   TO EN-LF-ORIG-ALT-PRM-AMT
  6300        MOVE OC-LF-TERM          TO EN-LF-ORIG-TERM
  6301        MOVE OC-LF-EXP-DT        TO EN-LF-ORIG-EXP-DT
  6302        MOVE OC-LF-COMM-PCT      TO EN-LF-ORIG-COMM-PCT
  6303     END-IF
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 111
* EL6318.cbl
  6304     MOVE OC-AH-BENCD          TO EN-AH-ORIG-BENCD
  6305     IF OC-AH-BENCD NOT = '00' AND '  '
  6306        MOVE OC-AH-BEN-AMT       TO EN-AH-ORIG-BEN-AMT
  6307        MOVE OC-AH-PRM-AMT       TO EN-AH-ORIG-PRM-AMT
  6308        MOVE OC-AH-TERM          TO EN-AH-ORIG-TERM
  6309        MOVE OC-AH-EXP-DT        TO EN-AH-ORIG-EXP-DT
  6310        MOVE OC-AH-CP            TO EN-AH-ORIG-CP
  6311        MOVE OC-AH-COMM-PCT      TO EN-AH-ORIG-COMM-PCT
  6312     END-IF
  6313     MOVE OC-CRED-BENE-NAME      TO EN-ORIG-CRED-BENE
  6314
  6315* EXEC CICS GETMAIN
  6316*         SET      (ADDRESS OF PENDING-BUSINESS)
  6317*         LENGTH   (ERPNDB-LENGTH)
  6318*         INITIMG  (GETMAIN-SPACE)
  6319*    END-EXEC
  6320*    MOVE ',"IL                  $   #00006178' TO DFHEIV0
  6321     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6322     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6323     MOVE X'2020233030303036313738' TO DFHEIV0(25:11)
  6324     CALL 'kxdfhei1' USING DFHEIV0,
  6325           DFHEIV20,
  6326           ERPNDB-LENGTH,
  6327           GETMAIN-SPACE
  6328     SET ADDRESS OF PENDING-BUSINESS TO
  6329         DFHEIV20
  6330     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6331     DISPLAY ' JUST DID GETMAIN ON ERPNDB '
  6332     MOVE PI-ERPNDB-KEY          TO ERPNDB-KEY
  6333
  6334* EXEC CICS READ
  6335*        DATASET   (WS-ERPNDB-FILE-ID)
  6336*        INTO      (PENDING-BUSINESS)
  6337*        RIDFLD    (ERPNDB-KEY)
  6338*        RESP      (WS-RESPONSE)
  6339*    END-EXEC
  6340     MOVE LENGTH OF
  6341      PENDING-BUSINESS
  6342       TO DFHEIV11
  6343*    MOVE '&"IL       E          (  N#00006185' TO DFHEIV0
  6344     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  6345     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6346     MOVE X'204E233030303036313835' TO DFHEIV0(25:11)
  6347     CALL 'kxdfhei1' USING DFHEIV0,
  6348           WS-ERPNDB-FILE-ID,
  6349           PENDING-BUSINESS,
  6350           DFHEIV11,
  6351           ERPNDB-KEY,
  6352           DFHEIV99,
  6353           DFHEIV99,
  6354           DFHEIV99
  6355     MOVE EIBRESP  TO WS-RESPONSE
  6356     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6357     IF NOT RESP-NORMAL
  6358        GO TO 0400-EXIT
  6359     END-IF
  6360*    set found-pndb to true
  6361     display ' good read on erpndb '
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 112
* EL6318.cbl
  6362     MOVE PB-I-INSURED-FIRST-NAME  TO EN-INS-NEW-FIRST-NAME
  6363                                      NCRTO-INS-FIRST-NAME
  6364     MOVE PB-I-INSURED-MIDDLE-INIT TO EN-INS-NEW-MIDDLE-INIT
  6365                                      NCRTO-INS-MIDDLE-INIT
  6366     MOVE PB-I-INSURED-LAST-NAME   TO EN-INS-NEW-LAST-NAME
  6367                                      NCRTO-INS-LAST-NAME
  6368     MOVE PB-I-AGE                 TO EN-INS-NEW-AGE
  6369                                      NCRTO-INS-AGE
  6370     MOVE PB-I-JOINT-FIRST-NAME    TO EN-JNT-NEW-FIRST-NAME
  6371                                      NCRTO-JNT-FIRST-NAME
  6372     MOVE PB-I-JOINT-MIDDLE-INIT   TO EN-JNT-NEW-MIDDLE-INIT
  6373                                      NCRTO-JNT-MIDDLE-INIT
  6374     MOVE PB-I-JOINT-LAST-NAME     TO EN-JNT-NEW-LAST-NAME
  6375                                      NCRTO-JNT-LAST-NAME
  6376     MOVE PB-I-JOINT-AGE           TO EN-JNT-NEW-AGE
  6377                                      NCRTO-JNT-AGE
  6378     MOVE PB-I-LF-BENEFIT-CD       TO EN-LF-NEW-BENCD
  6379                                      NCRTO-LF-BENCD
  6380     IF PB-I-LF-BENEFIT-CD NOT = '00' AND '  '
  6381        MOVE PB-I-LF-BENEFIT-AMT   TO EN-LF-NEW-BEN-AMT
  6382                                      NCRTO-LF-BEN-AMT
  6383        MOVE PB-I-LF-PREMIUM-AMT   TO EN-LF-NEW-PRM-AMT
  6384                                      NCRTO-LF-PRM-AMT
  6385        MOVE PB-I-LF-ALT-BENEFIT-AMT TO EN-LF-NEW-ALT-BEN-AMT
  6386                                      NCRTO-LF-ALT-BEN-AMT
  6387        MOVE PB-I-LF-ALT-PREMIUM-AMT TO EN-LF-NEW-ALT-PRM-AMT
  6388                                      NCRTO-LF-ALT-PRM-AMT
  6389        MOVE PB-I-LF-TERM          TO EN-LF-NEW-TERM
  6390                                      NCRTO-LF-TERM
  6391        MOVE PB-I-LF-EXPIRE-DT     TO EN-LF-NEW-EXP-DT
  6392                                      NCRTO-LF-EXP-DT
  6393        IF PB-I-JOINT-COMMISSION > +0
  6394           MOVE PB-I-JOINT-COMMISSION
  6395                                   TO EN-LF-NEW-COMM-PCT
  6396                                      NCRTO-LF-COMM-PCT
  6397        ELSE
  6398           MOVE PB-I-LIFE-COMMISSION
  6399                                   TO EN-LF-NEW-COMM-PCT
  6400                                      NCRTO-LF-COMM-PCT
  6401        END-IF
  6402     END-IF
  6403     MOVE PB-I-AH-BENEFIT-CD       TO EN-AH-NEW-BENCD
  6404                                      NCRTO-AH-BENCD
  6405     IF PB-I-AH-BENEFIT-CD NOT = '00' AND '  '
  6406        MOVE PB-I-AH-BENEFIT-AMT   TO EN-AH-NEW-BEN-AMT
  6407                                      NCRTO-AH-BEN-AMT
  6408        MOVE PB-I-AH-PREMIUM-AMT   TO EN-AH-NEW-PRM-AMT
  6409                                      NCRTO-AH-PRM-AMT
  6410        MOVE PB-I-AH-TERM          TO EN-AH-NEW-TERM
  6411                                      NCRTO-AH-TERM
  6412        MOVE PB-I-AH-EXPIRE-DT     TO EN-AH-NEW-EXP-DT
  6413                                      NCRTO-AH-EXP-DT
  6414        MOVE PB-I-AH-CRIT-PER      TO EN-AH-NEW-CP
  6415                                      NCRTO-AH-CP
  6416        MOVE PB-I-AH-COMMISSION    TO EN-AH-NEW-COMM-PCT
  6417                                      NCRTO-AH-COMM-PCT
  6418     END-IF
  6419     MOVE PB-I-1ST-PMT-DT          TO NCRTO-1ST-PMT-DT
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 113
* EL6318.cbl
  6420     MOVE PB-ENTRY-BATCH           TO EN-BATCH-NUMBER
  6421     MOVE W-ACCT-SUMM              TO EN-ACCT-SUMM
  6422     MOVE W-CSO-SUMM               TO EN-CSO-SUMM
  6423*     PERFORM 0450-GET-ERACCT     THRU 0450-EXIT
  6424     MOVE 'Y'                    TO EN-COMM-CHGBK
  6425
  6426     COMPUTE WS-DUE-BORROWER = (EN-LF-ORIG-PRM-AMT
  6427        + EN-LF-ORIG-ALT-PRM-AMT + EN-AH-ORIG-PRM-AMT) -
  6428        (EN-LF-NEW-PRM-AMT + EN-LF-NEW-ALT-PRM-AMT +
  6429        EN-AH-NEW-PRM-AMT)
  6430     COMPUTE EN-ACCT-PORTION ROUNDED =
  6431        (((EN-LF-ORIG-PRM-AMT + EN-LF-ORIG-ALT-PRM-AMT) -
  6432        (EN-LF-NEW-PRM-AMT + EN-LF-NEW-ALT-PRM-AMT))
  6433        * EN-LF-NEW-COMM-PCT)
  6434                       +
  6435        ((EN-AH-ORIG-PRM-AMT - EN-AH-NEW-PRM-AMT)
  6436        * EN-AH-NEW-COMM-PCT)
  6437     COMPUTE EN-CSO-PORTION = WS-DUE-BORROWER -
  6438        EN-ACCT-PORTION
  6439     move pb-control-by-account (1:33)
  6440                                 to ws-ermail-key
  6441
  6442* EXEC CICS READ
  6443*        DATASET   ('ERMAIL')
  6444*        SET       (ADDRESS OF MAILING-DATA)
  6445*        RIDFLD    (WS-ERMAIL-KEY)
  6446*        RESP      (WS-RESPONSE)
  6447*    END-EXEC
  6448     MOVE 'ERMAIL' TO DFHEIV1
  6449*    MOVE '&"S        E          (  N#00006275' TO DFHEIV0
  6450     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6451     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6452     MOVE X'204E233030303036323735' TO DFHEIV0(25:11)
  6453     CALL 'kxdfhei1' USING DFHEIV0,
  6454           DFHEIV1,
  6455           DFHEIV20,
  6456           DFHEIV99,
  6457           WS-ERMAIL-KEY,
  6458           DFHEIV99,
  6459           DFHEIV99,
  6460           DFHEIV99
  6461     SET ADDRESS OF MAILING-DATA TO
  6462         DFHEIV20
  6463     MOVE EIBRESP  TO WS-RESPONSE
  6464     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6465     IF RESP-NORMAL
  6466        DISPLAY ' FOUND ERMAIL '
  6467        MOVE MA-CRED-BENE-NAME   TO EN-NEW-CRED-BENE
  6468                                    NCRTO-CRED-BENE-NAME
  6469     ELSE
  6470        DISPLAY ' ERMAIL READ ' WS-RESPONSE
  6471     END-IF
  6472     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  6473        IF REACD-IN (S1) NOT = LOW-VALUES
  6474           MOVE REACD-IN (S1)    TO EN-REASON-CODE (S1)
  6475        END-IF
  6476     END-PERFORM
  6477     MOVE LTRIDI                 TO EN-TEMPLATE-USED
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 114
* EL6318.cbl
  6478     MOVE 'G'                    TO EN-DOCU-TYPE
  6479     MOVE 'Y'                    TO EN-MONEY-SW
  6480     MOVE SIGREQI                TO EN-SIG-SW
  6481     MOVE VOUCHI                 TO EN-VOUCHER-SW
  6482     MOVE PAYEEI                 TO EN-PAYEE
  6483     MOVE HLTHAPPI               TO EN-HEALTH-APP
  6484     DISPLAY ' 0400 EXIT '
  6485     PERFORM 0430-WRITE-ERENDT   THRU 0430-EXIT
  6486     .
  6487 0400-EXIT.
  6488     EXIT.
  6489 0410-INIT-ERENDT.
  6490     display ' made it to 0410 '
  6491     MOVE OC-CONTROL-PRIMARY     TO ERENDT-KEY
  6492     MOVE ZEROS                  TO ENDT-SEQ-NO
  6493
  6494* EXEC CICS READ
  6495*        DATASET    (WS-ERENDT-FILE-ID)
  6496*        RIDFLD     (ERENDT-KEY)
  6497*        INTO       (ENDORSEMENT-RECORD)
  6498*        RESP       (WS-RESPONSE)
  6499*        GTEQ
  6500*    END-EXEC
  6501     MOVE LENGTH OF
  6502      ENDORSEMENT-RECORD
  6503       TO DFHEIV11
  6504*    MOVE '&"IL       G          (  N#00006309' TO DFHEIV0
  6505     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  6506     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6507     MOVE X'204E233030303036333039' TO DFHEIV0(25:11)
  6508     CALL 'kxdfhei1' USING DFHEIV0,
  6509           WS-ERENDT-FILE-ID,
  6510           ENDORSEMENT-RECORD,
  6511           DFHEIV11,
  6512           ERENDT-KEY,
  6513           DFHEIV99,
  6514           DFHEIV99,
  6515           DFHEIV99
  6516     MOVE EIBRESP  TO WS-RESPONSE
  6517     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6518     IF RESP-NORMAL
  6519        AND (EN-CONTROL-PRIMARY (1:34) =
  6520           OC-CONTROL-PRIMARY (1:34))
  6521        COMPUTE WS-SEQ-NO = EN-SEQ-NO - +1
  6522     ELSE
  6523        MOVE +4096               TO WS-SEQ-NO
  6524     END-IF
  6525     MOVE 'EN'                   TO ENDORSEMENT-RECORD
  6526     MOVE OC-CONTROL-PRIMARY     TO EN-CONTROL-PRIMARY
  6527     MOVE EN-COMPANY-CD          TO EN-COMPANY-CD-A1
  6528     MOVE WS-SEQ-NO              TO EN-SEQ-NO
  6529     INITIALIZE EN-ISSUE-RECORD
  6530     MOVE LOW-VALUES             TO EN-LF-ORIG-EXP-DT
  6531                                    EN-AH-ORIG-EXP-DT
  6532                                    EN-LF-NEW-EXP-DT
  6533                                    EN-AH-NEW-EXP-DT
  6534                                    EN-PROCESS-DT
  6535     .
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 115
* EL6318.cbl
  6536 0410-EXIT.
  6537     EXIT.
  6538 0420-UPDATE-ELCRTO.
  6539     PERFORM 0363-READ-ELCRTO-UPD THRU 0363-EXIT
  6540     IF RESP-NORMAL
  6541        MOVE WS-CURRENT-BIN-DT   TO OC-ENDORSEMENT-PROCESSED-DT
  6542                                    OC-LAST-MAINT-DT
  6543        MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
  6544        MOVE PI-PROCESSOR-ID     TO OC-LAST-MAINT-BY
  6545
  6546* EXEC CICS REWRITE
  6547*          FROM     (ORIGINAL-CERTIFICATE)
  6548*          DATASET  ('ELCRTO')
  6549*       END-EXEC
  6550     MOVE LENGTH OF
  6551      ORIGINAL-CERTIFICATE
  6552       TO DFHEIV11
  6553     MOVE 'ELCRTO' TO DFHEIV1
  6554*    MOVE '&& L                  %   #00006343' TO DFHEIV0
  6555     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  6556     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  6557     MOVE X'2020233030303036333433' TO DFHEIV0(25:11)
  6558     CALL 'kxdfhei1' USING DFHEIV0,
  6559           DFHEIV1,
  6560           ORIGINAL-CERTIFICATE,
  6561           DFHEIV11,
  6562           DFHEIV99
  6563     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6564     END-IF
  6565     .
  6566 0420-EXIT.
  6567     EXIT.
  6568
  6569 0425-ADD-NEW-ELCRTO.
  6570     MOVE SPACES                 TO ORIGINAL-CERTIFICATE
  6571     MOVE 'OC'                   TO OC-RECORD-ID
  6572     MOVE NEW-ELCRTO-KEY         TO OC-CONTROL-PRIMARY
  6573     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
  6574     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
  6575     MOVE WS-CURRENT-BIN-DT      TO OC-LAST-MAINT-DT
  6576     MOVE NCRTO-INS-FIRST-NAME   TO OC-INS-FIRST-NAME
  6577     MOVE NCRTO-INS-MIDDLE-INIT  TO OC-INS-MIDDLE-INIT
  6578     MOVE NCRTO-INS-LAST-NAME    TO OC-INS-LAST-NAME
  6579     MOVE NCRTO-INS-AGE          TO OC-INS-AGE
  6580     MOVE NCRTO-JNT-FIRST-NAME   TO OC-JNT-FIRST-NAME
  6581     MOVE NCRTO-JNT-MIDDLE-INIT  TO OC-JNT-MIDDLE-INIT
  6582     MOVE NCRTO-JNT-LAST-NAME    TO OC-JNT-LAST-NAME
  6583     MOVE NCRTO-JNT-AGE          TO OC-JNT-AGE
  6584     MOVE NCRTO-LF-BENCD         TO OC-LF-BENCD
  6585     MOVE NCRTO-LF-BEN-AMT       TO OC-LF-BEN-AMT
  6586     MOVE NCRTO-LF-PRM-AMT       TO OC-LF-PRM-AMT
  6587     MOVE NCRTO-LF-ALT-BEN-AMT   TO OC-LF-ALT-BEN-AMT
  6588     MOVE NCRTO-LF-ALT-PRM-AMT   TO OC-LF-ALT-PRM-AMT
  6589     MOVE NCRTO-LF-TERM          TO OC-LF-TERM
  6590     MOVE NCRTO-LF-EXP-DT        TO OC-LF-EXP-DT
  6591     MOVE NCRTO-LF-COMM-PCT      TO OC-LF-COMM-PCT
  6592     MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
  6593     MOVE +0                     TO OC-LF-CANCEL-AMT
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 116
* EL6318.cbl
  6594                                    OC-LF-ITD-CANCEL-AMT
  6595     MOVE NCRTO-AH-BENCD         TO OC-AH-BENCD
  6596     MOVE NCRTO-AH-BEN-AMT       TO OC-AH-BEN-AMT
  6597     MOVE NCRTO-AH-PRM-AMT       TO OC-AH-PRM-AMT
  6598     MOVE NCRTO-AH-TERM          TO OC-AH-TERM
  6599     MOVE NCRTO-AH-EXP-DT        TO OC-AH-EXP-DT
  6600     MOVE NCRTO-AH-CP            TO OC-AH-CP
  6601     MOVE NCRTO-AH-COMM-PCT      TO OC-AH-COMM-PCT
  6602     MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
  6603     MOVE +0                     TO OC-AH-CANCEL-AMT
  6604                                    OC-AH-ITD-CANCEL-AMT
  6605     MOVE NCRTO-CRED-BENE-NAME   TO OC-CRED-BENE-NAME
  6606     MOVE NCRTO-1ST-PMT-DT       TO OC-1ST-PMT-DT
  6607     MOVE LOW-VALUES             TO OC-ENDORSEMENT-PROCESSED-DT
  6608     .
  6609 0425-WRITE-ELCRTO.
  6610
  6611
  6612* EXEC CICS WRITE
  6613*       DATASET   ('ELCRTO')
  6614*       FROM      (ORIGINAL-CERTIFICATE)
  6615*       RIDFLD    (OC-CONTROL-PRIMARY)
  6616*       RESP      (WS-RESPONSE)
  6617*    END-EXEC
  6618     MOVE LENGTH OF
  6619      ORIGINAL-CERTIFICATE
  6620       TO DFHEIV11
  6621     MOVE 'ELCRTO' TO DFHEIV1
  6622*    MOVE '&$ L                  ''  N#00006394' TO DFHEIV0
  6623     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6624     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6625     MOVE X'204E233030303036333934' TO DFHEIV0(25:11)
  6626     CALL 'kxdfhei1' USING DFHEIV0,
  6627           DFHEIV1,
  6628           ORIGINAL-CERTIFICATE,
  6629           DFHEIV11,
  6630           OC-CONTROL-PRIMARY,
  6631           DFHEIV99,
  6632           DFHEIV99
  6633     MOVE EIBRESP  TO WS-RESPONSE
  6634     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6635
  6636     display ' just wrote new crto ' ws-response
  6637     IF RESP-DUPKEY
  6638        SUBTRACT +1              FROM OC-KEY-SEQ-NO
  6639        GO TO 0425-WRITE-ELCRTO
  6640     ELSE
  6641        IF NOT RESP-NORMAL
  6642           MOVE -1               TO SIGREQL
  6643           MOVE ER-3830          TO EMI-ERROR
  6644           PERFORM 9900-ERROR-FORMAT
  6645                                 THRU 9900-EXIT
  6646        ELSE
  6647           MOVE OC-CONTROL-PRIMARY TO PI-ELCRTO-KEY
  6648        END-IF
  6649     END-IF
  6650
  6651     .
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 117
* EL6318.cbl
  6652 0425-EXIT.
  6653     EXIT.
  6654
  6655 0426-ADD-CERT-NOTES.
  6656
  6657     MOVE LOW-VALUES TO CERT-NOTE-ENTRIES
  6658     SET TB-INDX TO 1
  6659
  6660     IF PI-CERTNT1-ENTERED > SPACES
  6661         MOVE PI-CERTNT1-ENTERED TO CERT-NT-TEXT (TB-INDX)
  6662         MOVE PI-PROCESSOR-ID    TO
  6663                      CERT-NT-LAST-MAINT-BY (TB-INDX)
  6664         MOVE EIBTIME            TO
  6665                      CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  6666         MOVE WS-CURRENT-BIN-DT  TO
  6667                      CERT-NT-LAST-MAINT-DT (TB-INDX)
  6668         SET TB-INDX UP BY +1
  6669     END-IF
  6670
  6671     IF PI-CERTNT2-ENTERED > SPACES
  6672         MOVE PI-CERTNT2-ENTERED TO CERT-NT-TEXT (TB-INDX)
  6673         MOVE PI-PROCESSOR-ID    TO
  6674                      CERT-NT-LAST-MAINT-BY (TB-INDX)
  6675         MOVE EIBTIME            TO
  6676                      CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  6677         MOVE WS-CURRENT-BIN-DT  TO
  6678                      CERT-NT-LAST-MAINT-DT (TB-INDX)
  6679         SET TB-INDX UP BY +1
  6680     END-IF
  6681
  6682     IF PI-CERTNT3-ENTERED > SPACES
  6683         MOVE PI-CERTNT3-ENTERED TO CERT-NT-TEXT (TB-INDX)
  6684         MOVE PI-PROCESSOR-ID    TO
  6685                      CERT-NT-LAST-MAINT-BY (TB-INDX)
  6686         MOVE EIBTIME            TO
  6687                      CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  6688         MOVE WS-CURRENT-BIN-DT  TO
  6689                      CERT-NT-LAST-MAINT-DT (TB-INDX)
  6690         SET TB-INDX UP BY +1
  6691     END-IF
  6692
  6693     IF PI-CERTNT4-ENTERED > SPACES
  6694         MOVE PI-CERTNT4-ENTERED TO CERT-NT-TEXT (TB-INDX)
  6695         MOVE PI-PROCESSOR-ID    TO
  6696                      CERT-NT-LAST-MAINT-BY (TB-INDX)
  6697         MOVE EIBTIME            TO
  6698                      CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  6699         MOVE WS-CURRENT-BIN-DT  TO
  6700                      CERT-NT-LAST-MAINT-DT (TB-INDX)
  6701         SET TB-INDX UP BY +1
  6702     END-IF
  6703
  6704     IF CERT-NOTE-ENTRIES > SPACES
  6705         PERFORM 0427-LOAD-CURRENT-CERT-NOTES THRU 0427-EXIT
  6706         PERFORM 1700-WRITE-CERT-NOTE THRU 1799-EXIT
  6707     END-IF
  6708
  6709     IF PI-BILLNT1-ENTERED > SPACES
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 118
* EL6318.cbl
  6710         MOVE SPACES             TO WS-MANUAL-BILL-NOTE
  6711         MOVE PI-BILLNT1-ENTERED TO WS-MAN-BN-NOTE
  6712         MOVE +63 TO WS-LEN
  6713         PERFORM 0441-UPDATE-BILLING-NOTE THRU 0441-EXIT
  6714     END-IF
  6715
  6716     IF PI-BILLNT2-ENTERED > SPACES
  6717         MOVE SPACES             TO WS-MANUAL-BILL-NOTE
  6718         MOVE PI-BILLNT2-ENTERED TO WS-MAN-BN-NOTE
  6719         MOVE +63 TO WS-LEN
  6720         PERFORM 0441-UPDATE-BILLING-NOTE THRU 0441-EXIT
  6721     END-IF
  6722
  6723     .
  6724 0426-EXIT.
  6725     EXIT.
  6726
  6727 0427-LOAD-CURRENT-CERT-NOTES.
  6728
  6729     MOVE PI-CRTO-COMPANY-CD  TO ERCNOT-COMPANY-CD
  6730     MOVE PI-CRTO-CARRIER     TO ERCNOT-CARRIER
  6731     MOVE PI-CRTO-GROUPING    TO ERCNOT-GROUPING
  6732     MOVE PI-CRTO-STATE       TO ERCNOT-STATE
  6733     MOVE PI-CRTO-ACCOUNT     TO ERCNOT-ACCOUNT
  6734     MOVE PI-CRTO-CERT-EFF-DT TO ERCNOT-EFF-DT
  6735     MOVE PI-CRTO-CERT-PRIME  TO ERCNOT-CERT-PRIME
  6736     MOVE PI-CRTO-CERT-SFX    TO ERCNOT-CERT-SFX
  6737     MOVE '1'                 TO ERCNOT-REC-TYP
  6738     MOVE +0                  TO ERCNOT-SEQ
  6739     MOVE ERCNOT-PARTIAL-KEY  TO SV-PARTIAL-KEY
  6740
  6741
  6742* EXEC CICS STARTBR
  6743*         DATASET(WS-ERCNOT-FILE-ID)
  6744*         RIDFLD(ERCNOT-KEY)
  6745*         KEYLENGTH(ERCNOT-START-LENGTH)
  6746*         RESP      (WS-RESPONSE)
  6747*         GENERIC
  6748*         GTEQ
  6749*    END-EXEC.
  6750     MOVE 0
  6751       TO DFHEIV11
  6752*    MOVE '&,   KG    G          &  N#00006506' TO DFHEIV0
  6753     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
  6754     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6755     MOVE X'204E233030303036353036' TO DFHEIV0(25:11)
  6756     CALL 'kxdfhei1' USING DFHEIV0,
  6757           WS-ERCNOT-FILE-ID,
  6758           ERCNOT-KEY,
  6759           ERCNOT-START-LENGTH,
  6760           DFHEIV11,
  6761           DFHEIV99
  6762     MOVE EIBRESP  TO WS-RESPONSE
  6763     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6764
  6765
  6766     IF NOT RESP-NORMAL
  6767        GO TO 0427-ENDBR
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 119
* EL6318.cbl
  6768     END-IF.
  6769
  6770 0427-LOOP.
  6771
  6772* EXEC CICS READNEXT
  6773*         SET(ADDRESS OF CERT-NOTE-FILE)
  6774*         DATASET(WS-ERCNOT-FILE-ID)
  6775*         RIDFLD(ERCNOT-KEY)
  6776*    END-EXEC.
  6777     MOVE 0
  6778       TO DFHEIV11
  6779*    MOVE '&.S                   )   #00006520' TO DFHEIV0
  6780     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  6781     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6782     MOVE X'2020233030303036353230' TO DFHEIV0(25:11)
  6783     CALL 'kxdfhei1' USING DFHEIV0,
  6784           WS-ERCNOT-FILE-ID,
  6785           DFHEIV20,
  6786           DFHEIV99,
  6787           ERCNOT-KEY,
  6788           DFHEIV99,
  6789           DFHEIV11,
  6790           DFHEIV99,
  6791           DFHEIV99
  6792     SET ADDRESS OF CERT-NOTE-FILE TO
  6793         DFHEIV20
  6794     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6795
  6796
  6797     IF CZ-COMPANY-CD NOT = PI-CRTO-COMPANY-CD
  6798         GO TO 0427-ENDBR
  6799     END-IF.
  6800
  6801     IF (CZ-CARRIER = SV-CARRIER)
  6802        AND (CZ-GROUPING = SV-GROUPING)
  6803        AND (CZ-STATE = SV-STATE)
  6804        AND (CZ-ACCOUNT = SV-ACCOUNT)
  6805        AND (CZ-CERT-EFF-DT = SV-EFF-DT)
  6806        AND (CZ-CERT-NO = SV-CERT-NO)
  6807        AND (CZ-RECORD-TYPE = '1')
  6808          MOVE CZ-NOTE TO CERT-NT-TEXT (TB-INDX)
  6809          MOVE CZ-LAST-MAINT-USER TO
  6810                      CERT-NT-LAST-MAINT-BY (TB-INDX)
  6811          MOVE CZ-LAST-MAINT-DT TO
  6812                      CERT-NT-LAST-MAINT-DT (TB-INDX)
  6813          MOVE CZ-LAST-MAINT-HHMMSS TO
  6814                      CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  6815          SET TB-INDX UP BY 1
  6816          GO TO 0427-LOOP
  6817     END-IF.
  6818
  6819 0427-ENDBR.
  6820
  6821
  6822* EXEC CICS ENDBR
  6823*         DATASET(WS-ERCNOT-FILE-ID)
  6824*    END-EXEC.
  6825     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 120
* EL6318.cbl
  6826       TO DFHEIV11
  6827*    MOVE '&2                    $   #00006550' TO DFHEIV0
  6828     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6829     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6830     MOVE X'2020233030303036353530' TO DFHEIV0(25:11)
  6831     CALL 'kxdfhei1' USING DFHEIV0,
  6832           WS-ERCNOT-FILE-ID,
  6833           DFHEIV11,
  6834           DFHEIV99
  6835     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6836
  6837
  6838     .
  6839 0427-EXIT.
  6840     EXIT.
  6841
  6842 0430-WRITE-ERENDT.
  6843     DISPLAY ' NO ERRORS, ABOUT TO WRITE ERENDT '
  6844     MOVE EN-CONTROL-PRIMARY     TO PI-ERENDT-KEY
  6845     MOVE W-ARCH-NUMBER          TO EN-ARCHIVE-NO
  6846
  6847* EXEC CICS WRITE
  6848*         DATASET   (WS-ERENDT-FILE-ID)
  6849*         FROM      (ENDORSEMENT-RECORD)
  6850*         RIDFLD    (EN-CONTROL-PRIMARY)
  6851*         RESP      (WS-RESPONSE)
  6852*    END-EXEC
  6853     MOVE LENGTH OF
  6854      ENDORSEMENT-RECORD
  6855       TO DFHEIV11
  6856*    MOVE '&$ L                  ''  N#00006562' TO DFHEIV0
  6857     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6858     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6859     MOVE X'204E233030303036353632' TO DFHEIV0(25:11)
  6860     CALL 'kxdfhei1' USING DFHEIV0,
  6861           WS-ERENDT-FILE-ID,
  6862           ENDORSEMENT-RECORD,
  6863           DFHEIV11,
  6864           EN-CONTROL-PRIMARY,
  6865           DFHEIV99,
  6866           DFHEIV99
  6867     MOVE EIBRESP  TO WS-RESPONSE
  6868     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6869     IF RESP-NORMAL
  6870        MOVE 'G'                 TO PI-DOCUMENT-PROCESSED
  6871        display ' good write erendt '
  6872        IF EIBAID = DFHPF4
  6873           PERFORM 0420-UPDATE-ELCRTO THRU 0420-EXIT
  6874           PERFORM 0425-ADD-NEW-ELCRTO THRU 0425-EXIT
  6875           PERFORM 0426-ADD-CERT-NOTES THRU 0426-EXIT
  6876           PERFORM 0440-ADD-BILLING-NOTE THRU 0440-EXIT
  6877        END-IF
  6878     ELSE
  6879        DISPLAY ' NOT A GOOD WRITE ERENDT ' WS-RESPONSE
  6880        MOVE -1                  TO SIGREQL
  6881        MOVE ER-0132             TO EMI-ERROR
  6882        MOVE AL-UABON            TO SIGREQA
  6883        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 121
* EL6318.cbl
  6884     END-IF
  6885     .
  6886 0430-EXIT.
  6887     EXIT.
  6888
  6889
  6890 0440-ADD-BILLING-NOTE.
  6891
  6892* EXEC CICS GETMAIN
  6893*         SET      (ADDRESS OF EOB-CODES)
  6894*         LENGTH   (ELEOBC-LENGTH)
  6895*         INITIMG  (GETMAIN-SPACE)
  6896*    END-EXEC
  6897*    MOVE ',"IL                  $   #00006590' TO DFHEIV0
  6898     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6899     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6900     MOVE X'2020233030303036353930' TO DFHEIV0(25:11)
  6901     CALL 'kxdfhei1' USING DFHEIV0,
  6902           DFHEIV20,
  6903           ELEOBC-LENGTH,
  6904           GETMAIN-SPACE
  6905     SET ADDRESS OF EOB-CODES TO
  6906         DFHEIV20
  6907     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6908
  6909     MOVE LOW-VALUES             TO WS-ELEOBC-KEY
  6910     MOVE PI-COMPANY-CD          TO WS-EOBC-COMPANY-CD
  6911     MOVE '5'                    TO WS-EOBC-REC-TYPE
  6912
  6913
  6914* EXEC CICS STARTBR
  6915*        DATASET   ('ELEOBC')
  6916*        RIDFLD    (WS-ELEOBC-KEY)
  6917*        GTEQ
  6918*        RESP      (WS-RESPONSE)
  6919*    END-EXEC
  6920     MOVE 'ELEOBC' TO DFHEIV1
  6921     MOVE 0
  6922       TO DFHEIV11
  6923*    MOVE '&,         G          &  N#00006600' TO DFHEIV0
  6924     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6925     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6926     MOVE X'204E233030303036363030' TO DFHEIV0(25:11)
  6927     CALL 'kxdfhei1' USING DFHEIV0,
  6928           DFHEIV1,
  6929           WS-ELEOBC-KEY,
  6930           DFHEIV99,
  6931           DFHEIV11,
  6932           DFHEIV99
  6933     MOVE EIBRESP  TO WS-RESPONSE
  6934     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6935
  6936     IF NOT RESP-NORMAL
  6937        GO TO 0440-EXIT
  6938     END-IF
  6939      .
  6940 0440-READNEXT-ELEOBC.
  6941
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 122
* EL6318.cbl
  6942
  6943* EXEC CICS READNEXT
  6944*       INTO    (EOB-CODES)
  6945*       DATASET ('ELEOBC')
  6946*       RIDFLD  (WS-ELEOBC-KEY)
  6947*       RESP    (WS-RESPONSE)
  6948*    END-EXEC
  6949     MOVE LENGTH OF
  6950      EOB-CODES
  6951       TO DFHEIV12
  6952     MOVE 'ELEOBC' TO DFHEIV1
  6953     MOVE 0
  6954       TO DFHEIV11
  6955*    MOVE '&.IL                  )  N#00006613' TO DFHEIV0
  6956     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  6957     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6958     MOVE X'204E233030303036363133' TO DFHEIV0(25:11)
  6959     CALL 'kxdfhei1' USING DFHEIV0,
  6960           DFHEIV1,
  6961           EOB-CODES,
  6962           DFHEIV12,
  6963           WS-ELEOBC-KEY,
  6964           DFHEIV99,
  6965           DFHEIV11,
  6966           DFHEIV99,
  6967           DFHEIV99
  6968     MOVE EIBRESP  TO WS-RESPONSE
  6969     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6970
  6971     IF RESP-NORMAL
  6972         IF EO-RECORD-TYPE NOT = '5'
  6973             GO TO 0440-EXIT
  6974         END-IF
  6975     ELSE
  6976         GO TO 0440-EXIT
  6977     END-IF
  6978
  6979     IF EO-RECORD-TYPE = '5' AND
  6980        EO-EOB-CODE = PI-LTRID-ENTERED
  6981           CONTINUE
  6982     ELSE
  6983         GO TO 0440-READNEXT-ELEOBC
  6984     END-IF
  6985
  6986     MOVE SPACES TO WS-BILLING-NOTE
  6987     MOVE EO-DESCRIPTION TO WS-BN-NOTE
  6988     MOVE PI-LTRID-ENTERED TO WS-BN-LTRID
  6989     MOVE WS-CURRENT-DT TO WS-BN-DATE
  6990     MOVE PI-PROCESSOR-ID TO WS-BN-USERID
  6991     MOVE +25 TO WS-LEN
  6992
  6993     PERFORM 0441-UPDATE-BILLING-NOTE THRU 0441-EXIT
  6994     .
  6995 0440-EXIT.
  6996     EXIT.
  6997
  6998 0441-UPDATE-BILLING-NOTE.
  6999
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 123
* EL6318.cbl
  7000* EXEC CICS GETMAIN
  7001*         SET      (ADDRESS OF CERTIFICATE-NOTE)
  7002*         LENGTH   (ERNOTE-LENGTH)
  7003*         INITIMG  (GETMAIN-SPACE)
  7004*    END-EXEC
  7005*    MOVE ',"IL                  $   #00006648' TO DFHEIV0
  7006     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7007     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7008     MOVE X'2020233030303036363438' TO DFHEIV0(25:11)
  7009     CALL 'kxdfhei1' USING DFHEIV0,
  7010           DFHEIV20,
  7011           ERNOTE-LENGTH,
  7012           GETMAIN-SPACE
  7013     SET ADDRESS OF CERTIFICATE-NOTE TO
  7014         DFHEIV20
  7015     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7016
  7017     MOVE PI-ERENDT-KEY (1:33) TO WS-ERNOTE-KEY
  7018
  7019
  7020* EXEC CICS READ
  7021*       DATASET    (WS-ERNOTE-FILE-ID)
  7022*       RIDFLD     (WS-ERNOTE-KEY)
  7023*       INTO       (CERTIFICATE-NOTE)
  7024*       RESP       (WS-RESPONSE)
  7025*       UPDATE
  7026*    END-EXEC
  7027     MOVE LENGTH OF
  7028      CERTIFICATE-NOTE
  7029       TO DFHEIV11
  7030*    MOVE '&"IL       EU         (  N#00006656' TO DFHEIV0
  7031     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  7032     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7033     MOVE X'204E233030303036363536' TO DFHEIV0(25:11)
  7034     CALL 'kxdfhei1' USING DFHEIV0,
  7035           WS-ERNOTE-FILE-ID,
  7036           CERTIFICATE-NOTE,
  7037           DFHEIV11,
  7038           WS-ERNOTE-KEY,
  7039           DFHEIV99,
  7040           DFHEIV99,
  7041           DFHEIV99
  7042     MOVE EIBRESP  TO WS-RESPONSE
  7043     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7044
  7045     IF RESP-NORMAL
  7046       IF CN-BILLING-START-LINE-NO NOT NUMERIC
  7047          MOVE ZEROS            TO CN-BILLING-START-LINE-NO
  7048       END-IF
  7049       IF CN-BILLING-END-LINE-NO NOT NUMERIC
  7050          MOVE ZEROS            TO CN-BILLING-END-LINE-NO
  7051       END-IF
  7052       PERFORM VARYING NOTE-SUB FROM +1 BY +1 UNTIL
  7053           (NOTE-SUB > +10) OR
  7054           (CN-LINE (NOTE-SUB) (1:WS-LEN) =
  7055                             WS-BILLING-NOTE (1:WS-LEN))
  7056       END-PERFORM
  7057       IF CN-LINE (NOTE-SUB) (1:WS-LEN) =
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 124
* EL6318.cbl
  7058                              WS-BILLING-NOTE (1:WS-LEN)
  7059
  7060* EXEC CICS UNLOCK
  7061*           DATASET    (WS-ERNOTE-FILE-ID)
  7062*        END-EXEC
  7063*    MOVE '&*                    #   #00006678' TO DFHEIV0
  7064     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  7065     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7066     MOVE X'2020233030303036363738' TO DFHEIV0(25:11)
  7067     CALL 'kxdfhei1' USING DFHEIV0,
  7068           WS-ERNOTE-FILE-ID,
  7069           DFHEIV99
  7070     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7071       ELSE
  7072         PERFORM VARYING NOTE-SUB FROM +1 BY +1 UNTIL
  7073           (NOTE-SUB > +10) OR
  7074           (CN-LINE (NOTE-SUB) = SPACES OR LOW-VALUES)
  7075         END-PERFORM
  7076         IF (NOTE-SUB < +11)
  7077           IF NOTE-SUB >= CN-BILLING-START-LINE-NO AND
  7078              NOTE-SUB <= CN-BILLING-END-LINE-NO
  7079                MOVE WS-BILLING-NOTE TO CN-LINE (NOTE-SUB)
  7080           ELSE
  7081             IF (CN-BILLING-END-LINE-NO NOT = ZEROS) AND
  7082              (NOTE-SUB = (CN-BILLING-END-LINE-NO + +1))
  7083                MOVE WS-BILLING-NOTE   TO CN-LINE (NOTE-SUB)
  7084                MOVE NOTE-SUB     TO CN-BILLING-END-LINE-NO
  7085             ELSE
  7086               IF (CN-BILLING-START-LINE-NO NOT = ZEROS) AND
  7087                  (NOTE-SUB = (CN-BILLING-START-LINE-NO - +1))
  7088                     MOVE WS-BILLING-NOTE TO CN-LINE (NOTE-SUB)
  7089                     MOVE NOTE-SUB  TO CN-BILLING-START-LINE-NO
  7090               ELSE
  7091                 IF (CN-BILLING-END-LINE-NO = ZEROS)
  7092                   MOVE WS-BILLING-NOTE  TO CN-LINE (NOTE-SUB)
  7093                   MOVE NOTE-SUB    TO CN-BILLING-END-LINE-NO
  7094                                       CN-BILLING-START-LINE-NO
  7095                 ELSE
  7096                    PERFORM 0442-SQUEEZE-IT-IN THRU 0442-EXIT
  7097                 END-IF
  7098               END-IF
  7099             END-IF
  7100           END-IF
  7101           MOVE PI-PROCESSOR-ID     TO CN-LAST-MAINT-USER
  7102           MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
  7103           MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
  7104
  7105* EXEC CICS REWRITE
  7106*             DATASET    (WS-ERNOTE-FILE-ID)
  7107*             FROM       (CERTIFICATE-NOTE)
  7108*             RESP       (WS-RESPONSE)
  7109*          END-EXEC
  7110     MOVE LENGTH OF
  7111      CERTIFICATE-NOTE
  7112       TO DFHEIV11
  7113*    MOVE '&& L                  %  N#00006714' TO DFHEIV0
  7114     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7115     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 125
* EL6318.cbl
  7116     MOVE X'204E233030303036373134' TO DFHEIV0(25:11)
  7117     CALL 'kxdfhei1' USING DFHEIV0,
  7118           WS-ERNOTE-FILE-ID,
  7119           CERTIFICATE-NOTE,
  7120           DFHEIV11,
  7121           DFHEIV99
  7122     MOVE EIBRESP  TO WS-RESPONSE
  7123     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7124           PERFORM 0445-CERTIFICATE-UPDATE THRU 0445-EXIT
  7125         END-IF
  7126       END-IF
  7127     ELSE
  7128        MOVE SPACES              TO CERTIFICATE-NOTE
  7129        MOVE 'CN'                TO CN-RECORD-ID
  7130        MOVE PI-ERENDT-KEY (1:33) TO CN-CONTROL-PRIMARY
  7131                                     WS-ERNOTE-KEY
  7132        MOVE 01                  TO CN-BILLING-START-LINE-NO
  7133                                    CN-BILLING-END-LINE-NO
  7134        MOVE WS-BILLING-NOTE     TO CN-LINE (01)
  7135        MOVE PI-PROCESSOR-ID     TO CN-LAST-MAINT-USER
  7136        MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
  7137        MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
  7138
  7139* EXEC CICS WRITE
  7140*          DATASET    (WS-ERNOTE-FILE-ID)
  7141*          FROM       (CERTIFICATE-NOTE)
  7142*          RIDFLD     (WS-ERNOTE-KEY)
  7143*          RESP       (WS-RESPONSE)
  7144*       END-EXEC
  7145     MOVE LENGTH OF
  7146      CERTIFICATE-NOTE
  7147       TO DFHEIV11
  7148*    MOVE '&$ L                  ''  N#00006733' TO DFHEIV0
  7149     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7150     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7151     MOVE X'204E233030303036373333' TO DFHEIV0(25:11)
  7152     CALL 'kxdfhei1' USING DFHEIV0,
  7153           WS-ERNOTE-FILE-ID,
  7154           CERTIFICATE-NOTE,
  7155           DFHEIV11,
  7156           WS-ERNOTE-KEY,
  7157           DFHEIV99,
  7158           DFHEIV99
  7159     MOVE EIBRESP  TO WS-RESPONSE
  7160     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7161
  7162        PERFORM 0445-CERTIFICATE-UPDATE THRU 0445-EXIT
  7163     END-IF
  7164
  7165     .
  7166 0441-EXIT.
  7167     EXIT.
  7168
  7169
  7170 0442-SQUEEZE-IT-IN.
  7171
  7172     IF NOTE-SUB < CN-BILLING-START-LINE-NO
  7173        PERFORM VARYING NOTE-SUB FROM NOTE-SUB BY +1 UNTIL
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 126
* EL6318.cbl
  7174           NOTE-SUB = +10
  7175           MOVE CN-LINE (NOTE-SUB + 1) TO CN-LINE (NOTE-SUB)
  7176           IF (NOTE-SUB + 1) = (CN-BILLING-START-LINE-NO - 1)
  7177             MOVE WS-BILLING-NOTE TO CN-LINE (NOTE-SUB + 1)
  7178             COMPUTE CN-BILLING-START-LINE-NO = NOTE-SUB + 1
  7179             MOVE +9 TO NOTE-SUB
  7180           END-IF
  7181        END-PERFORM
  7182     ELSE
  7183        IF NOTE-SUB > CN-BILLING-END-LINE-NO
  7184           PERFORM VARYING NOTE-SUB FROM NOTE-SUB BY -1
  7185             UNTIL NOTE-SUB = +1
  7186             MOVE CN-LINE (NOTE-SUB - 1) TO CN-LINE (NOTE-SUB)
  7187             IF (NOTE-SUB - 1) = (CN-BILLING-END-LINE-NO + 1)
  7188                MOVE WS-BILLING-NOTE  TO CN-LINE (NOTE-SUB - 1)
  7189                COMPUTE CN-BILLING-END-LINE-NO = NOTE-SUB - 1
  7190                MOVE +2          TO NOTE-SUB
  7191             END-IF
  7192           END-PERFORM
  7193        END-IF
  7194     END-IF
  7195
  7196     .
  7197 0442-EXIT.
  7198     EXIT.
  7199
  7200 0445-CERTIFICATE-UPDATE.
  7201    display 'billing note written, updating cert'
  7202     PERFORM 1800-READ-ELCERT-UPDATE THRU 1800-EXIT
  7203     IF RESP-NORMAL
  7204        EVALUATE CM-NOTE-SW
  7205           WHEN '2'
  7206           WHEN '3'
  7207           WHEN '6'
  7208           WHEN '7'
  7209              SET NO-CERT-RW     TO TRUE
  7210           WHEN ' '
  7211              MOVE '2'           TO CM-NOTE-SW
  7212           WHEN '1'
  7213              MOVE '3'           TO CM-NOTE-SW
  7214           WHEN '4'
  7215              MOVE '6'           TO CM-NOTE-SW
  7216           WHEN '5'
  7217              MOVE '7'           TO CM-NOTE-SW
  7218        END-EVALUATE
  7219     END-IF
  7220     IF NOT NO-CERT-RW
  7221        PERFORM 1810-REWRITE-ELCERT
  7222                                 THRU 1810-EXIT
  7223     ELSE
  7224
  7225* EXEC CICS UNLOCK
  7226*          DATASET    (WS-ELCERT-FILE-ID)
  7227*       END-EXEC
  7228*    MOVE '&*                    #   #00006802' TO DFHEIV0
  7229     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  7230     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7231     MOVE X'2020233030303036383032' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 127
* EL6318.cbl
  7232     CALL 'kxdfhei1' USING DFHEIV0,
  7233           WS-ELCERT-FILE-ID,
  7234           DFHEIV99
  7235     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7236     END-IF
  7237
  7238     .
  7239 0445-EXIT.
  7240     EXIT.
  7241
  7242 0450-GET-ERACCT.
  7243     MOVE ' '                    TO WS-ERACCT-SW
  7244     MOVE ZEROS                  TO WS-CHGBACK
  7245                                    WS-CSO-PORTION
  7246                                    WS-ACCT-PORTION
  7247                                    WS-DIFF
  7248     PERFORM 0460-STARTBR-ERACCT THRU 0460-EXIT
  7249     IF RESP-NORMAL
  7250        PERFORM 0470-READNEXT-ERACCT
  7251                                 THRU 0470-EXIT
  7252     END-IF
  7253     IF RESP-NORMAL
  7254        IF AM-CONTROL-PRIMARY (1:20) = EN-CONTROL-PRIMARY (1:20)
  7255           IF EN-CERT-EFF-DT < AM-EXPIRATION-DT
  7256              AND >= AM-EFFECTIVE-DT
  7257              SET ACCT-FOUND TO TRUE
  7258           ELSE
  7259              PERFORM 0470-READNEXT-ERACCT
  7260                                 THRU 0470-EXIT
  7261              IF RESP-NORMAL
  7262                 IF AM-CONTROL-PRIMARY (1:20)
  7263                    = EN-CONTROL-PRIMARY (1:20)
  7264                    IF EN-CERT-EFF-DT < AM-EXPIRATION-DT
  7265                       AND >= AM-EFFECTIVE-DT
  7266                       SET ACCT-FOUND TO TRUE
  7267                    END-IF
  7268                 END-IF
  7269              END-IF
  7270           END-IF
  7271        END-IF
  7272     END-IF
  7273     IF ACCT-FOUND
  7274        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  7275           (AM-COM-TYP (S1) = 'C' OR 'D')
  7276           OR (S1 > +10)
  7277        END-PERFORM
  7278        IF S1 < +11
  7279           MOVE AM-COMM-CHARGEBACK (S1)
  7280                                 TO WS-CHGBACK
  7281        END-IF
  7282     END-IF
  7283    .
  7284 0450-EXIT.
  7285     EXIT.
  7286 0460-STARTBR-ERACCT.
  7287     MOVE LOW-VALUES             TO WS-ERACCT-KEY
  7288     MOVE EN-CONTROL-PRIMARY     TO WS-ERACCT-KEY (1:22)
  7289     MOVE WS-ERACCT-KEY          TO WS-SAVE-ERACCT-KEY
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 128
* EL6318.cbl
  7290
  7291* EXEC CICS STARTBR
  7292*        DATASET   ('ERACCT')
  7293*        RIDFLD    (WS-ERACCT-KEY)
  7294*        GTEQ
  7295*        RESP      (WS-RESPONSE)
  7296*    END-EXEC
  7297     MOVE 'ERACCT' TO DFHEIV1
  7298     MOVE 0
  7299       TO DFHEIV11
  7300*    MOVE '&,         G          &  N#00006859' TO DFHEIV0
  7301     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7302     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7303     MOVE X'204E233030303036383539' TO DFHEIV0(25:11)
  7304     CALL 'kxdfhei1' USING DFHEIV0,
  7305           DFHEIV1,
  7306           WS-ERACCT-KEY,
  7307           DFHEIV99,
  7308           DFHEIV11,
  7309           DFHEIV99
  7310     MOVE EIBRESP  TO WS-RESPONSE
  7311     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7312     .
  7313 0460-EXIT.
  7314     EXIT.
  7315 0470-READNEXT-ERACCT.
  7316
  7317* EXEC CICS READNEXT
  7318*       INTO    (ACCOUNT-MASTER)
  7319*       DATASET ('ERACCT')
  7320*       RIDFLD  (WS-ERACCT-KEY)
  7321*       RESP    (WS-RESPONSE)
  7322*    END-EXEC
  7323     MOVE LENGTH OF
  7324      ACCOUNT-MASTER
  7325       TO DFHEIV12
  7326     MOVE 'ERACCT' TO DFHEIV1
  7327     MOVE 0
  7328       TO DFHEIV11
  7329*    MOVE '&.IL                  )  N#00006869' TO DFHEIV0
  7330     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  7331     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7332     MOVE X'204E233030303036383639' TO DFHEIV0(25:11)
  7333     CALL 'kxdfhei1' USING DFHEIV0,
  7334           DFHEIV1,
  7335           ACCOUNT-MASTER,
  7336           DFHEIV12,
  7337           WS-ERACCT-KEY,
  7338           DFHEIV99,
  7339           DFHEIV11,
  7340           DFHEIV99,
  7341           DFHEIV99
  7342     MOVE EIBRESP  TO WS-RESPONSE
  7343     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7344     .
  7345 0470-EXIT.
  7346     EXIT.
  7347 0500-CREATE-TEMP-STORAGE.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 129
* EL6318.cbl
  7348     display ' about to write pi ' program-interface-block
  7349
  7350* EXEC CICS WRITEQ TS
  7351*        QUEUE (QID)
  7352*        FROM  (PROGRAM-INTERFACE-BLOCK)
  7353*        LENGTH(PI-COMM-LENGTH)
  7354*    END-EXEC
  7355*    MOVE '*"                    ''   #00006880' TO DFHEIV0
  7356     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  7357     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7358     MOVE X'2020233030303036383830' TO DFHEIV0(25:11)
  7359     CALL 'kxdfhei1' USING DFHEIV0,
  7360           QID,
  7361           PROGRAM-INTERFACE-BLOCK,
  7362           PI-COMM-LENGTH,
  7363           DFHEIV99,
  7364           DFHEIV99,
  7365           DFHEIV99
  7366     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7367     display ' about to write map ' el631ki
  7368
  7369* EXEC CICS WRITEQ TS
  7370*        QUEUE (QID)
  7371*        FROM  (EL631KI)
  7372*        LENGTH(MAP-LENGTH)
  7373*    END-EXEC.
  7374*    MOVE '*"                    ''   #00006886' TO DFHEIV0
  7375     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  7376     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7377     MOVE X'2020233030303036383836' TO DFHEIV0(25:11)
  7378     CALL 'kxdfhei1' USING DFHEIV0,
  7379           QID,
  7380           EL631KI,
  7381           MAP-LENGTH,
  7382           DFHEIV99,
  7383           DFHEIV99,
  7384           DFHEIV99
  7385     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7386
  7387 0500-EXIT.
  7388      EXIT.
  7389 0600-RECOVER-TEMP-STORAGE.
  7390     display ' about to recover pi '
  7391
  7392* EXEC CICS READQ TS
  7393*        QUEUE (QID)
  7394*        INTO  (PROGRAM-INTERFACE-BLOCK)
  7395*        LENGTH(PI-COMM-LENGTH)
  7396*    END-EXEC
  7397*    MOVE '*$I    L              ''   #00006895' TO DFHEIV0
  7398     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7399     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7400     MOVE X'2020233030303036383935' TO DFHEIV0(25:11)
  7401     CALL 'kxdfhei1' USING DFHEIV0,
  7402           QID,
  7403           PROGRAM-INTERFACE-BLOCK,
  7404           PI-COMM-LENGTH,
  7405           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 130
* EL6318.cbl
  7406           DFHEIV99,
  7407           DFHEIV99
  7408     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7409     display ' pi ' pi-program-work-area
  7410     display ' about to recover map '
  7411
  7412* EXEC CICS READQ TS
  7413*        QUEUE (QID)
  7414*        INTO  (EL631KI)
  7415*        LENGTH(MAP-LENGTH)
  7416*    END-EXEC
  7417*    MOVE '*$I    L              ''   #00006902' TO DFHEIV0
  7418     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7419     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7420     MOVE X'2020233030303036393032' TO DFHEIV0(25:11)
  7421     CALL 'kxdfhei1' USING DFHEIV0,
  7422           QID,
  7423           EL631KI,
  7424           MAP-LENGTH,
  7425           DFHEIV99,
  7426           DFHEIV99,
  7427           DFHEIV99
  7428     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7429     display ' map ' el631ki
  7430     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
  7431     MOVE AL-UANON            TO SIGREQA
  7432     MOVE AL-UANON            TO LTRIDA
  7433     MOVE AL-UANON            TO VOUCHA
  7434     MOVE AL-UANON            TO HLTHAPPA
  7435     MOVE AL-UANON            TO PAYEEA
  7436     IF WS-SET-CODES-MDT = 'Y'
  7437        move +1                  to s2
  7438        perform varying s1 from +1 by +5 until s1 > +60
  7439           MOVE WS-PASSED-REASON-CODES (s1:4)
  7440                                 TO reacd-in (s2)
  7441           IF REACD-IN (S2) NOT EQUAL SPACES AND LOW-VALUES
  7442               MOVE AL-SANON     TO REACDA (S2)
  7443               MOVE +4           TO REACDL (S2)
  7444           END-IF
  7445           add +1                to s2
  7446        end-perform
  7447        MOVE REASONCDS       TO PI-REASONS-ENTERED
  7448     END-IF
  7449     IF CERTIDI > SPACES
  7450         MOVE AL-UANON       TO CERTIDA
  7451     END-IF
  7452
  7453     IF CRTNT1I > SPACES
  7454         MOVE AL-UANON       TO CRTNT1A
  7455     END-IF
  7456
  7457     IF CRTNT2I > SPACES
  7458         MOVE AL-UANON       TO CRTNT2A
  7459     END-IF
  7460
  7461     IF CRTNT3I > SPACES
  7462         MOVE AL-UANON       TO CRTNT3A
  7463     END-IF
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 131
* EL6318.cbl
  7464
  7465     IF CRTNT4I > SPACES
  7466         MOVE AL-UANON       TO CRTNT4A
  7467     END-IF
  7468
  7469     IF BILNT1I > SPACES
  7470         MOVE AL-UANON       TO BILNT1A
  7471     END-IF
  7472
  7473     IF BILNT2I > SPACES
  7474         MOVE AL-UANON       TO BILNT2A
  7475     END-IF
  7476     .
  7477 0600-EXIT.
  7478      EXIT.
  7479 0800-DELETE-TS.
  7480
  7481* EXEC CICS DELETEQ TS
  7482*        QUEUE(QID)
  7483*    END-EXEC
  7484*    MOVE '*&                    #   #00006958' TO DFHEIV0
  7485     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  7486     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7487     MOVE X'2020233030303036393538' TO DFHEIV0(25:11)
  7488     CALL 'kxdfhei1' USING DFHEIV0,
  7489           QID,
  7490           DFHEIV99
  7491     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7492     .
  7493 0800-EXIT.
  7494      EXIT.
  7495 1000-BUILD-ERARCH.
  7496     display ' made it to 1000 '
  7497     MOVE SPACES                 TO W-CNTL-KEY
  7498     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID
  7499     MOVE '1'                    TO W-CNTL-RECORD-TYPE
  7500     MOVE ZEROS                  TO W-CNTL-SEQ-NO
  7501
  7502* EXEC CICS READ
  7503*         DATASET    (WS-ELCNTL-FILE-ID)
  7504*         SET        (ADDRESS OF CONTROL-FILE)
  7505*         RIDFLD     (W-CNTL-KEY)
  7506*         UPDATE
  7507*         RESP       (WS-RESPONSE)
  7508*    END-EXEC
  7509*    MOVE '&"S        EU         (  N#00006970' TO DFHEIV0
  7510     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7511     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7512     MOVE X'204E233030303036393730' TO DFHEIV0(25:11)
  7513     CALL 'kxdfhei1' USING DFHEIV0,
  7514           WS-ELCNTL-FILE-ID,
  7515           DFHEIV20,
  7516           DFHEIV99,
  7517           W-CNTL-KEY,
  7518           DFHEIV99,
  7519           DFHEIV99,
  7520           DFHEIV99
  7521     SET ADDRESS OF CONTROL-FILE TO
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 132
* EL6318.cbl
  7522         DFHEIV20
  7523     MOVE EIBRESP  TO WS-RESPONSE
  7524     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7525     IF RESP-NORMAL
  7526        display ' good read elcntl '
  7527        IF CF-CREDIT-LAST-ARCH-NUM NOT NUMERIC
  7528           MOVE ZEROS            TO CF-CREDIT-LAST-ARCH-NUM
  7529        END-IF
  7530        ADD 1                    TO CF-CREDIT-LAST-ARCH-NUM
  7531        MOVE CF-CREDIT-LAST-ARCH-NUM
  7532                                 TO W-ARCH-NUMBER
  7533
  7534* EXEC CICS REWRITE
  7535*          FROM      (CONTROL-FILE)
  7536*          DATASET   (WS-ELCNTL-FILE-ID)
  7537*       END-EXEC
  7538     MOVE LENGTH OF
  7539      CONTROL-FILE
  7540       TO DFHEIV11
  7541*    MOVE '&& L                  %   #00006985' TO DFHEIV0
  7542     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7543     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7544     MOVE X'2020233030303036393835' TO DFHEIV0(25:11)
  7545     CALL 'kxdfhei1' USING DFHEIV0,
  7546           WS-ELCNTL-FILE-ID,
  7547           CONTROL-FILE,
  7548           DFHEIV11,
  7549           DFHEIV99
  7550     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7551     END-IF
  7552
  7553* EXEC CICS GETMAIN
  7554*       SET      (ADDRESS OF LETTER-ARCHIVE)
  7555*       LENGTH   (W-ARCH-LENGTH)
  7556*    END-EXEC
  7557*    MOVE '," L                  $   #00006990' TO DFHEIV0
  7558     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
  7559     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7560     MOVE X'2020233030303036393930' TO DFHEIV0(25:11)
  7561     CALL 'kxdfhei1' USING DFHEIV0,
  7562           DFHEIV20,
  7563           W-ARCH-LENGTH,
  7564           DFHEIV99
  7565     SET ADDRESS OF LETTER-ARCHIVE TO
  7566         DFHEIV20
  7567     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7568     MOVE 'LA'                   TO LETTER-ARCHIVE
  7569     MOVE W-ARCH-NUMBER          TO LA-ARCHIVE-NO
  7570                                    LA-ARCHIVE-NO-A2
  7571                                    LA-ARCHIVE-NO-A3
  7572                                    LA-ARCHIVE-NO-A4
  7573                                    LA-ARCHIVE-NO-A5
  7574                                    LA-ARCHIVE-NO-A6
  7575     MOVE PI-COMPANY-CD          TO LA-COMPANY-CD
  7576                                    LA-COMPANY-CD-A2
  7577                                    LA-COMPANY-CD-A3
  7578                                    LA-COMPANY-CD-A4
  7579                                    LA-COMPANY-CD-A5
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 133
* EL6318.cbl
  7580                                    LA-COMPANY-CD-A6
  7581     MOVE PB-CARRIER             TO LA-CARRIER-A2
  7582                                    LA-CARRIER-A3
  7583                                    LA-CARRIER-A4
  7584                                    LA-CARRIER-A5
  7585     MOVE Pb-cert-eff-dt         TO LA-EFFECT-DATE-A2
  7586     MOVE PB-GROUPING            TO LA-GROUPING-A2
  7587                                    LA-GROUPING-A3
  7588                                    LA-GROUPING-A4
  7589                                    LA-GROUPING-A5
  7590     MOVE PB-ACCOUNT             TO LA-ACCOUNT-A2
  7591                                    LA-ACCOUNT-A3
  7592                                    LA-ACCOUNT-A4
  7593                                    LA-ACCOUNT-A5
  7594     MOVE PB-STATE               TO LA-STATE-A2
  7595                                    LA-STATE-A3
  7596                                    LA-STATE-A4
  7597                                    LA-STATE-A5
  7598     MOVE PB-CERT-PRIME          TO LA-CERT-PRIME-A2
  7599     MOVE PB-CERT-SFX            TO LA-CERT-SUFFIX-A2
  7600     MOVE PB-ENTRY-BATCH         TO LA-ENTRY-A6
  7601     MOVE PI-PROCESSOR-ID        TO LA-PROCESSOR-CD
  7602     MOVE LOW-VALUES             TO LA-LAST-RESENT-PRINT-DATE
  7603                                    LA-INITIAL-PRINT-DATE
  7604                                    LA-SENT-DATE
  7605                                    LA-REPLY-DATE
  7606                                    LA-RESEND-DATE
  7607                                    LA-FOLLOW-UP-DATE
  7608     MOVE 'A'                    TO LA-STATUS
  7609     MOVE W-NUMBER-OF-COPIES     TO LA-NO-OF-COPIES
  7610     MOVE W-AUTO-CLOSE-IND       TO LA-FINAL-ACT-IND
  7611     MOVE LTRIDI                 TO LA-FORM-A3
  7612     MOVE '4'                    TO LA-DATA-SOURCE
  7613     MOVE WS-CURRENT-BIN-DT      TO LA-CREATION-DATE
  7614     MOVE ZEROS                  TO LA-NUMBER-LABEL-LINES
  7615                                    LA-NO-OF-TEXT-RECORDS
  7616
  7617* EXEC CICS WRITE
  7618*         DATASET   ('ERARCH')
  7619*         FROM      (LETTER-ARCHIVE)
  7620*         RIDFLD    (LA-CONTROL-PRIMARY)
  7621*         RESP      (WS-RESPONSE)
  7622*    END-EXEC
  7623     MOVE LENGTH OF
  7624      LETTER-ARCHIVE
  7625       TO DFHEIV11
  7626     MOVE 'ERARCH' TO DFHEIV1
  7627*    MOVE '&$ L                  ''  N#00007042' TO DFHEIV0
  7628     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7629     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7630     MOVE X'204E233030303037303432' TO DFHEIV0(25:11)
  7631     CALL 'kxdfhei1' USING DFHEIV0,
  7632           DFHEIV1,
  7633           LETTER-ARCHIVE,
  7634           DFHEIV11,
  7635           LA-CONTROL-PRIMARY,
  7636           DFHEIV99,
  7637           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 134
* EL6318.cbl
  7638     MOVE EIBRESP  TO WS-RESPONSE
  7639     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7640     IF RESP-NORMAL
  7641        display ' good write erarch '
  7642        MOVE ER-0280             TO EMI-ERROR
  7643        MOVE -1                  TO SIGREQL
  7644        PERFORM 9900-ERROR-FORMAT
  7645                                 THRU 9900-EXIT
  7646        MOVE W-ARCH-NUMBER       TO W-ARCH-SUPPRESS
  7647        MOVE W-ARCH-EDIT         TO EMI-TEXT-VARIABLE (1)
  7648     ELSE
  7649        MOVE ER-7345             TO EMI-ERROR
  7650        MOVE -1                  TO SIGREQL
  7651        PERFORM 9900-ERROR-FORMAT
  7652                                 THRU 9900-EXIT
  7653     END-IF
  7654     .
  7655 1000-EXIT.
  7656     EXIT.
  7657 1100-CALL-NS-BUS-LOGIC.
  7658     DISPLAY ' MADE IT TO 1100 '
  7659     MOVE SPACES                 TO BL-INPUT
  7660     MOVE W-ARCH-NUMBER          TO BL-ARCHIVE-NO
  7661     MOVE '4'                    TO BL-DATA-SRCE
  7662     MOVE PB-CARRIER             TO BL-CARRIER
  7663     MOVE PB-GROUPING            TO BL-GROUP
  7664     MOVE PB-STATE               TO BL-STATE
  7665     MOVE PB-ACCOUNT             TO BL-ACCOUNT
  7666     IF PB-CERT-EFF-DT NOT = LOW-VALUES
  7667        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
  7668        MOVE ' '                 TO DC-OPTION-CODE
  7669        PERFORM 9700-date-link
  7670        IF NO-CONVERSION-ERROR
  7671           MOVE DC-GREG-DATE-B-EDIT
  7672                                 TO BL-EFF-DT
  7673        END-IF
  7674     END-IF
  7675     MOVE PB-CERT-NO             TO BL-CERT-NO
  7676     MOVE PB-ENTRY-BATCH         TO BL-BATCH-NO
  7677     MOVE PB-BATCH-SEQ-NO        TO BL-BATCH-SEQ
  7678     MOVE SPACES                 TO BL-RESP-NO
  7679     MOVE LTRIDI                 TO BL-LETTER-ID
  7680     MOVE W-NUMBER-OF-COPIES     TO BL-NO-OF-COPIES
  7681     MOVE PI-PROCESSOR-ID        TO BL-PROC-ID
  7682*    MOVE 'ALWA'                 TO BL-PROC-ID
  7683     MOVE PI-COMPANY-ID          TO BL-COMP-ID
  7684*    MOVE IFF-PRINT-NOW-SW       TO BL-PRINT-NOW-SW
  7685*    MOVE IFF-ENC-CD             TO BL-ENC-CD
  7686     IF EIBAID = DFHPF4
  7687        MOVE 'B'                 TO BL-WRITE-ERARCH
  7688     ELSE
  7689        MOVE 'T'                 TO BL-WRITE-ERARCH
  7690     END-IF
  7691     MOVE CERTIDI                TO BL-CERT-FORM-ID
  7692     MOVE W-ARCH-NUMBER          TO BL-ENDT-ARCH-NO
  7693     MOVE 'ISS ENDT'             TO BL-SOURCE-SCREEN
  7694     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  7695        IF REACD-IN (S1) NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 135
* EL6318.cbl
  7696           MOVE REACD-IN (S1)    TO BL-REASON-CODE (S1)
  7697        END-IF
  7698     END-PERFORM
  7699    DISPLAY ' ABOUT TO LINK TO NSRASBL '
  7700*****************************************
  7701* Invoke the LETTER business logic
  7702*****************************************
  7703
  7704* exec cics link
  7705*       program('NSRASBL')
  7706*       commarea(srch-commarea)
  7707*    end-exec.
  7708     MOVE LENGTH OF
  7709      srch-commarea
  7710       TO DFHEIV11
  7711     MOVE 'NSRASBL' TO DFHEIV1
  7712*    MOVE '."C                   (   #00007111' TO DFHEIV0
  7713     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  7714     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7715     MOVE X'2020233030303037313131' TO DFHEIV0(25:11)
  7716     CALL 'kxdfhei1' USING DFHEIV0,
  7717           DFHEIV1,
  7718           srch-commarea,
  7719           DFHEIV11,
  7720           DFHEIV99,
  7721           DFHEIV99,
  7722           DFHEIV99,
  7723           DFHEIV99
  7724     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7725
  7726     DISPLAY ' MADE IT BACK FROM NSRASBL ' BL-STATUS ' '
  7727        BL-MESSAGE
  7728     .
  7729 1100-EXIT.
  7730     EXIT.
  7731 1500-GET-ARCH-NO.
  7732     display ' made it to 1500 '
  7733     MOVE SPACES                 TO ELCNTL-KEY
  7734     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID
  7735     MOVE '1'                    TO CNTL-REC-TYPE
  7736     MOVE ZEROS                  TO CNTL-SEQ
  7737
  7738* EXEC CICS READ
  7739*         DATASET    (WS-ELCNTL-FILE-ID)
  7740*         SET        (ADDRESS OF CONTROL-FILE)
  7741*         RIDFLD     (ELCNTL-KEY)
  7742*         UPDATE
  7743*         RESP       (WS-RESPONSE)
  7744*    END-EXEC
  7745*    MOVE '&"S        EU         (  N#00007126' TO DFHEIV0
  7746     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7747     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7748     MOVE X'204E233030303037313236' TO DFHEIV0(25:11)
  7749     CALL 'kxdfhei1' USING DFHEIV0,
  7750           WS-ELCNTL-FILE-ID,
  7751           DFHEIV20,
  7752           DFHEIV99,
  7753           ELCNTL-KEY,
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 136
* EL6318.cbl
  7754           DFHEIV99,
  7755           DFHEIV99,
  7756           DFHEIV99
  7757     SET ADDRESS OF CONTROL-FILE TO
  7758         DFHEIV20
  7759     MOVE EIBRESP  TO WS-RESPONSE
  7760     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7761     IF RESP-NORMAL
  7762        display ' good read elcntl '
  7763        IF CF-CREDIT-LAST-ARCH-NUM NOT NUMERIC
  7764           MOVE ZEROS            TO CF-CREDIT-LAST-ARCH-NUM
  7765        END-IF
  7766        ADD 1                    TO CF-CREDIT-LAST-ARCH-NUM
  7767        MOVE CF-CREDIT-LAST-ARCH-NUM
  7768                                 TO W-ARCH-NUMBER
  7769        display ' new arch number ' w-arch-number
  7770
  7771* EXEC CICS REWRITE
  7772*          FROM      (CONTROL-FILE)
  7773*          DATASET   (WS-ELCNTL-FILE-ID)
  7774*       END-EXEC
  7775     MOVE LENGTH OF
  7776      CONTROL-FILE
  7777       TO DFHEIV11
  7778*    MOVE '&& L                  %   #00007142' TO DFHEIV0
  7779     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7780     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7781     MOVE X'2020233030303037313432' TO DFHEIV0(25:11)
  7782     CALL 'kxdfhei1' USING DFHEIV0,
  7783           WS-ELCNTL-FILE-ID,
  7784           CONTROL-FILE,
  7785           DFHEIV11,
  7786           DFHEIV99
  7787     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7788     END-IF
  7789     .
  7790 1500-EXIT.
  7791     EXIT.
  7792
  7793
  7794 1700-WRITE-CERT-NOTE      SECTION.
  7795
  7796     MOVE SV-PARTIAL-KEY TO ERCNOT-PARTIAL-KEY.
  7797     MOVE ZERO           TO ERCNOT-SEQ.
  7798     SET TB-INDX         DOWN BY 1.
  7799     SET TB-INDX1        TO TB-INDX.
  7800
  7801****DELETE CURRENT CERT NOTES
  7802 1700-LOOP.
  7803
  7804* EXEC CICS READ
  7805*        DATASET (WS-ERCNOT-FILE-ID)
  7806*        RIDFLD  (ERCNOT-KEY)
  7807*        SET     (ADDRESS OF CERT-NOTE-FILE)
  7808*        RESP    (WS-RESPONSE)
  7809*        GTEQ
  7810*    END-EXEC.
  7811*    MOVE '&"S        G          (  N#00007161' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 137
* EL6318.cbl
  7812     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  7813     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7814     MOVE X'204E233030303037313631' TO DFHEIV0(25:11)
  7815     CALL 'kxdfhei1' USING DFHEIV0,
  7816           WS-ERCNOT-FILE-ID,
  7817           DFHEIV20,
  7818           DFHEIV99,
  7819           ERCNOT-KEY,
  7820           DFHEIV99,
  7821           DFHEIV99,
  7822           DFHEIV99
  7823     SET ADDRESS OF CERT-NOTE-FILE TO
  7824         DFHEIV20
  7825     MOVE EIBRESP  TO WS-RESPONSE
  7826     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7827
  7828
  7829     IF NOT RESP-NORMAL
  7830        GO TO 1700-ENDDEL
  7831     END-IF
  7832
  7833     MOVE CZ-CONTROL-PRIMARY     TO ERCNOT-KEY.
  7834
  7835     IF ERCNOT-PARTIAL-KEY NOT = SV-PARTIAL-KEY
  7836         GO TO 1700-ENDDEL
  7837     END-IF.
  7838
  7839
  7840* EXEC CICS DELETE
  7841*        DATASET (WS-ERCNOT-FILE-ID)
  7842*        RIDFLD  (ERCNOT-KEY)
  7843*    END-EXEC.
  7844*    MOVE '&(  R                 &   #00007179' TO DFHEIV0
  7845     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
  7846     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7847     MOVE X'2020233030303037313739' TO DFHEIV0(25:11)
  7848     CALL 'kxdfhei1' USING DFHEIV0,
  7849           WS-ERCNOT-FILE-ID,
  7850           ERCNOT-KEY,
  7851           DFHEIV99,
  7852           DFHEIV99,
  7853           DFHEIV99
  7854     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7855
  7856
  7857     GO TO 1700-LOOP.
  7858
  7859 1700-ENDDEL.
  7860
  7861
  7862* EXEC CICS GETMAIN
  7863*         LENGTH(ERCNOT-LENGTH)
  7864*         SET(ADDRESS OF CERT-NOTE-FILE)
  7865*         INITIMG(GETMAIN-SPACE)
  7866*    END-EXEC.
  7867*    MOVE ',"IL                  $   #00007188' TO DFHEIV0
  7868     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7869     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 138
* EL6318.cbl
  7870     MOVE X'2020233030303037313838' TO DFHEIV0(25:11)
  7871     CALL 'kxdfhei1' USING DFHEIV0,
  7872           DFHEIV20,
  7873           ERCNOT-LENGTH,
  7874           GETMAIN-SPACE
  7875     SET ADDRESS OF CERT-NOTE-FILE TO
  7876         DFHEIV20
  7877     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7878
  7879
  7880     SET TB-INDX TO 1.
  7881     MOVE SV-PARTIAL-KEY TO ERCNOT-PARTIAL-KEY
  7882     MOVE +0             TO ERCNOT-SEQ
  7883
  7884     PERFORM VARYING TB-INDX FROM 1 BY 1
  7885             UNTIL TB-INDX > TB-INDX1
  7886        MOVE SPACES                 TO  CERT-NOTE-FILE
  7887        ADD 1                       TO  ERCNOT-SEQ
  7888        MOVE ERCNOT-KEY             TO  CZ-CONTROL-PRIMARY
  7889        MOVE  'CZ'                  TO  CZ-RECORD-ID
  7890        MOVE CERT-NT-TEXT (TB-INDX) TO  CZ-NOTE
  7891        MOVE CERT-NT-LAST-MAINT-BY (TB-INDX)
  7892                                    TO  CZ-LAST-MAINT-USER
  7893        MOVE CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  7894                                    TO  CZ-LAST-MAINT-HHMMSS
  7895        MOVE CERT-NT-LAST-MAINT-DT (TB-INDX)
  7896                                    TO  CZ-LAST-MAINT-DT
  7897
  7898
  7899* EXEC CICS WRITE
  7900*            DATASET(WS-ERCNOT-FILE-ID)
  7901*            FROM(CERT-NOTE-FILE)
  7902*            RIDFLD(ERCNOT-KEY)
  7903*       END-EXEC
  7904     MOVE LENGTH OF
  7905      CERT-NOTE-FILE
  7906       TO DFHEIV11
  7907*    MOVE '&$ L                  ''   #00007212' TO DFHEIV0
  7908     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7909     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7910     MOVE X'2020233030303037323132' TO DFHEIV0(25:11)
  7911     CALL 'kxdfhei1' USING DFHEIV0,
  7912           WS-ERCNOT-FILE-ID,
  7913           CERT-NOTE-FILE,
  7914           DFHEIV11,
  7915           ERCNOT-KEY,
  7916           DFHEIV99,
  7917           DFHEIV99
  7918     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7919     END-PERFORM
  7920
  7921     PERFORM 1800-READ-ELCERT-UPDATE THRU 1800-EXIT
  7922     IF RESP-NORMAL
  7923        EVALUATE CM-NOTE-SW
  7924           WHEN '1'
  7925           WHEN '3'
  7926           WHEN '5'
  7927           WHEN '7'
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 139
* EL6318.cbl
  7928              SET NO-CERT-RW     TO TRUE
  7929           WHEN ' '
  7930              MOVE '1'           TO CM-NOTE-SW
  7931           WHEN '2'
  7932              MOVE '3'           TO CM-NOTE-SW
  7933           WHEN '4'
  7934              MOVE '5'           TO CM-NOTE-SW
  7935           WHEN '6'
  7936              MOVE '7'           TO CM-NOTE-SW
  7937        END-EVALUATE
  7938     END-IF
  7939     IF NOT NO-CERT-RW
  7940        PERFORM 1810-REWRITE-ELCERT
  7941                                 THRU 1810-EXIT
  7942     ELSE
  7943
  7944* EXEC CICS UNLOCK
  7945*          DATASET    (WS-ELCERT-FILE-ID)
  7946*       END-EXEC
  7947*    MOVE '&*                    #   #00007241' TO DFHEIV0
  7948     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  7949     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7950     MOVE X'2020233030303037323431' TO DFHEIV0(25:11)
  7951     CALL 'kxdfhei1' USING DFHEIV0,
  7952           WS-ELCERT-FILE-ID,
  7953           DFHEIV99
  7954     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7955     END-IF
  7956
  7957     .
  7958 1799-EXIT.
  7959     EXIT.
  7960
  7961 1800-READ-ELCERT-UPDATE.
  7962
  7963     MOVE PI-COMPANY-CD          TO  W-CERT-COMPANY-CD.
  7964     MOVE PI-CRTO-CARRIER        TO  W-CERT-CARRIER.
  7965     MOVE PI-CRTO-GROUPING       TO  W-CERT-GROUPING.
  7966     MOVE PI-CRTO-STATE          TO  W-CERT-STATE.
  7967     MOVE PI-CRTO-ACCOUNT        TO  W-CERT-ACCOUNT.
  7968     MOVE PI-CRTO-CERT-EFF-DT    TO  W-CERT-CERT-EFF-DT.
  7969     MOVE PI-CRTO-CERT-PRIME     TO  W-CERT-CERT-PRIME.
  7970     MOVE PI-CRTO-CERT-SFX       TO  W-CERT-CERT-SFX.
  7971
  7972
  7973* EXEC CICS READ
  7974*        UPDATE
  7975*        DATASET  (WS-ELCERT-FILE-ID)
  7976*        RIDFLD   (WS-ELCERT-KEY)
  7977*        SET      (ADDRESS OF CERTIFICATE-MASTER)
  7978*        RESP     (WS-RESPONSE)
  7979*    END-EXEC
  7980*    MOVE '&"S        EU         (  N#00007261' TO DFHEIV0
  7981     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7982     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7983     MOVE X'204E233030303037323631' TO DFHEIV0(25:11)
  7984     CALL 'kxdfhei1' USING DFHEIV0,
  7985           WS-ELCERT-FILE-ID,
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 140
* EL6318.cbl
  7986           DFHEIV20,
  7987           DFHEIV99,
  7988           WS-ELCERT-KEY,
  7989           DFHEIV99,
  7990           DFHEIV99,
  7991           DFHEIV99
  7992     SET ADDRESS OF CERTIFICATE-MASTER TO
  7993         DFHEIV20
  7994     MOVE EIBRESP  TO WS-RESPONSE
  7995     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7996
  7997     .
  7998 1800-EXIT.
  7999     EXIT.
  8000
  8001 1810-REWRITE-ELCERT.
  8002
  8003
  8004* EXEC CICS REWRITE
  8005*        FROM     (CERTIFICATE-MASTER)
  8006*        DATASET  (WS-ELCERT-FILE-ID)
  8007*        RESP     (WS-RESPONSE)
  8008*    END-EXEC.
  8009     MOVE LENGTH OF
  8010      CERTIFICATE-MASTER
  8011       TO DFHEIV11
  8012*    MOVE '&& L                  %  N#00007275' TO DFHEIV0
  8013     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8014     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8015     MOVE X'204E233030303037323735' TO DFHEIV0(25:11)
  8016     CALL 'kxdfhei1' USING DFHEIV0,
  8017           WS-ELCERT-FILE-ID,
  8018           CERTIFICATE-MASTER,
  8019           DFHEIV11,
  8020           DFHEIV99
  8021     MOVE EIBRESP  TO WS-RESPONSE
  8022     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8023
  8024
  8025     .
  8026 1810-EXIT.
  8027     EXIT.
  8028
  8029 8100-SEND-INITIAL-MAP.
  8030     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  8031     MOVE '5'                    TO DC-OPTION-CODE.
  8032     PERFORM 9700-DATE-LINK.
  8033     MOVE DC-GREG-DATE-1-EDIT    TO DATEO.
  8034     MOVE EIBTIME                TO TIME-IN.
  8035     MOVE TIME-OUT               TO TIMEO.
  8036     MOVE -1                     TO SIGREQL
  8037     IF PI-PROCESSOR-IS-CSR-SUPER
  8038        perform varying s1 from +1 by +1 until
  8039           s1 > +12
  8040           MOVE AL-UANON            TO reacda (s1)
  8041        end-perform
  8042     END-IF
  8043     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 141
* EL6318.cbl
  8044     MOVE EMI-MESSAGE-AREA (2)   TO ERRMSG2O.
  8045
  8046* EXEC CICS SEND
  8047*        MAP      (MAP-NAME)
  8048*        MAPSET   (MAPSET-NAME)
  8049*        FROM     (EL631KO)
  8050*        ERASE
  8051*        CURSOR
  8052*    END-EXEC.
  8053     MOVE LENGTH OF
  8054      EL631KO
  8055       TO DFHEIV12
  8056     MOVE -1
  8057       TO DFHEIV11
  8058*    MOVE '8$     CT  E    H L F ,   #00007301' TO DFHEIV0
  8059     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  8060     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  8061     MOVE X'2020233030303037333031' TO DFHEIV0(25:11)
  8062     CALL 'kxdfhei1' USING DFHEIV0,
  8063           MAP-NAME,
  8064           EL631KO,
  8065           DFHEIV12,
  8066           MAPSET-NAME,
  8067           DFHEIV99,
  8068           DFHEIV99,
  8069           DFHEIV99,
  8070           DFHEIV11,
  8071           DFHEIV99,
  8072           DFHEIV99,
  8073           DFHEIV99
  8074     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8075
  8076     GO TO 9100-RETURN-TRAN.
  8077 8200-SEND-DATAONLY.
  8078     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  8079     MOVE '5'                    TO DC-OPTION-CODE.
  8080     PERFORM 9700-DATE-LINK.
  8081     MOVE DC-GREG-DATE-1-EDIT    TO DATEO.
  8082     MOVE EIBTIME                TO TIME-IN.
  8083     MOVE TIME-OUT               TO TIMEO.
  8084     MOVE -1                     TO PFENTRL
  8085     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O
  8086     MOVE EMI-MESSAGE-AREA (2)   TO ERRMSG2O
  8087
  8088* EXEC CICS SEND
  8089*        MAP      (MAP-NAME)
  8090*        MAPSET   (MAPSET-NAME)
  8091*        FROM     (EL631KO)
  8092*        DATAONLY
  8093*        ERASEAUP
  8094*        CURSOR
  8095*    END-EXEC.
  8096     MOVE LENGTH OF
  8097      EL631KO
  8098       TO DFHEIV12
  8099     MOVE -1
  8100       TO DFHEIV11
  8101*    MOVE '8$D    CT  A    H L F ,   #00007319' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 142
* EL6318.cbl
  8102     MOVE X'382444202020204354202041' TO DFHEIV0(1:12)
  8103     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  8104     MOVE X'2020233030303037333139' TO DFHEIV0(25:11)
  8105     CALL 'kxdfhei1' USING DFHEIV0,
  8106           MAP-NAME,
  8107           EL631KO,
  8108           DFHEIV12,
  8109           MAPSET-NAME,
  8110           DFHEIV99,
  8111           DFHEIV99,
  8112           DFHEIV99,
  8113           DFHEIV11,
  8114           DFHEIV99,
  8115           DFHEIV99,
  8116           DFHEIV99
  8117     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8118
  8119     GO TO 9100-RETURN-TRAN.
  8120 8300-SEND-TEXT.
  8121
  8122* EXEC CICS SEND TEXT
  8123*        FROM     (LOGOFF-TEXT)
  8124*        LENGTH   (LOGOFF-LENGTH)
  8125*        ERASE
  8126*        FREEKB
  8127*    END-EXEC.
  8128*    MOVE '8&      T  E F  H   F -   #00007329' TO DFHEIV0
  8129     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  8130     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  8131     MOVE X'2020233030303037333239' TO DFHEIV0(25:11)
  8132     CALL 'kxdfhei1' USING DFHEIV0,
  8133           LOGOFF-TEXT,
  8134           LOGOFF-LENGTH,
  8135           DFHEIV99,
  8136           DFHEIV99,
  8137           DFHEIV99,
  8138           DFHEIV99,
  8139           DFHEIV99,
  8140           DFHEIV99,
  8141           DFHEIV99,
  8142           DFHEIV99,
  8143           DFHEIV99,
  8144           DFHEIV99
  8145     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8146
  8147
  8148* EXEC CICS RETURN
  8149*    END-EXEC.
  8150*    MOVE '.(                    ''   #00007335' TO DFHEIV0
  8151     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  8152     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8153     MOVE X'2020233030303037333335' TO DFHEIV0(25:11)
  8154     CALL 'kxdfhei1' USING DFHEIV0,
  8155           DFHEIV99,
  8156           DFHEIV99,
  8157           DFHEIV99,
  8158           DFHEIV99,
  8159           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 143
* EL6318.cbl
  8160           DFHEIV99
  8161     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8162
  8163 8800-UNAUTHORIZED-ACCESS.
  8164     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
  8165     GO TO 8300-SEND-TEXT.
  8166 8810-PF23.
  8167     MOVE EIBAID                 TO PI-ENTRY-CD-1.
  8168     MOVE XCTL-005               TO PGM-NAME.
  8169     GO TO 9300-XCTL.
  8170 9000-RETURN-CICS.
  8171
  8172* EXEC CICS RETURN
  8173*    END-EXEC.
  8174*    MOVE '.(                    ''   #00007345' TO DFHEIV0
  8175     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  8176     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8177     MOVE X'2020233030303037333435' TO DFHEIV0(25:11)
  8178     CALL 'kxdfhei1' USING DFHEIV0,
  8179           DFHEIV99,
  8180           DFHEIV99,
  8181           DFHEIV99,
  8182           DFHEIV99,
  8183           DFHEIV99,
  8184           DFHEIV99
  8185     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8186
  8187 9100-RETURN-TRAN.
  8188     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
  8189     MOVE SCREEN-NUMBER          TO PI-CURRENT-SCREEN-NO.
  8190
  8191* EXEC CICS RETURN
  8192*        TRANSID    (TRANS-ID)
  8193*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  8194*        LENGTH     (PI-COMM-LENGTH)
  8195*    END-EXEC.
  8196*    MOVE '.(CT                  ''   #00007350' TO DFHEIV0
  8197     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  8198     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8199     MOVE X'2020233030303037333530' TO DFHEIV0(25:11)
  8200     CALL 'kxdfhei1' USING DFHEIV0,
  8201           TRANS-ID,
  8202           PROGRAM-INTERFACE-BLOCK,
  8203           PI-COMM-LENGTH,
  8204           DFHEIV99,
  8205           DFHEIV99,
  8206           DFHEIV99
  8207     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8208
  8209 9200-RETURN-MAIN-MENU.
  8210     MOVE XCTL-626               TO PGM-NAME.
  8211     GO TO 9300-XCTL.
  8212 9300-XCTL.
  8213
  8214* EXEC CICS XCTL
  8215*        PROGRAM    (PGM-NAME)
  8216*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  8217*        LENGTH     (PI-COMM-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 144
* EL6318.cbl
  8218*    END-EXEC.
  8219*    MOVE '.$C                   %   #00007359' TO DFHEIV0
  8220     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  8221     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8222     MOVE X'2020233030303037333539' TO DFHEIV0(25:11)
  8223     CALL 'kxdfhei1' USING DFHEIV0,
  8224           PGM-NAME,
  8225           PROGRAM-INTERFACE-BLOCK,
  8226           PI-COMM-LENGTH,
  8227           DFHEIV99
  8228     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8229
  8230 9400-CLEAR.
  8231     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
  8232
  8233* EXEC CICS XCTL
  8234*        PROGRAM    (PGM-NAME)
  8235*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  8236*        LENGTH     (PI-COMM-LENGTH)
  8237*    END-EXEC.
  8238*    MOVE '.$C                   %   #00007366' TO DFHEIV0
  8239     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  8240     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8241     MOVE X'2020233030303037333636' TO DFHEIV0(25:11)
  8242     CALL 'kxdfhei1' USING DFHEIV0,
  8243           PGM-NAME,
  8244           PROGRAM-INTERFACE-BLOCK,
  8245           PI-COMM-LENGTH,
  8246           DFHEIV99
  8247     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8248
  8249 9500-PF12.
  8250     MOVE XCTL-010               TO PGM-NAME.
  8251     GO TO 9300-XCTL.
  8252 9600-PGMID-ERROR.
  8253
  8254* EXEC CICS HANDLE CONDITION
  8255*        PGMIDERR    (8300-SEND-TEXT)
  8256*    END-EXEC.
  8257*    MOVE '"$L                   ! " #00007375' TO DFHEIV0
  8258     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  8259     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8260     MOVE X'2220233030303037333735' TO DFHEIV0(25:11)
  8261     CALL 'kxdfhei1' USING DFHEIV0
  8262     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8263
  8264     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
  8265     MOVE ' '                    TO PI-ENTRY-CD-1.
  8266     MOVE XCTL-005               TO PGM-NAME.
  8267     MOVE PGM-NAME               TO LOGOFF-PGM.
  8268     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
  8269     GO TO 9300-XCTL.
  8270 9700-DATE-LINK.
  8271     MOVE LINK-ELDATCV           TO PGM-NAME.
  8272
  8273* EXEC CICS LINK
  8274*        PROGRAM    (PGM-NAME)
  8275*        COMMAREA   (DATE-CONVERSION-DATA)
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 145
* EL6318.cbl
  8276*        LENGTH     (DC-COMM-LENGTH)
  8277*    END-EXEC.
  8278*    MOVE '."C                   (   #00007386' TO DFHEIV0
  8279     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8280     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8281     MOVE X'2020233030303037333836' TO DFHEIV0(25:11)
  8282     CALL 'kxdfhei1' USING DFHEIV0,
  8283           PGM-NAME,
  8284           DATE-CONVERSION-DATA,
  8285           DC-COMM-LENGTH,
  8286           DFHEIV99,
  8287           DFHEIV99,
  8288           DFHEIV99,
  8289           DFHEIV99
  8290     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8291
  8292 9900-ERROR-FORMAT.
  8293     IF NOT EMI-ERRORS-COMPLETE
  8294        MOVE LINK-001            TO PGM-NAME
  8295
  8296* EXEC CICS LINK
  8297*           PROGRAM    (PGM-NAME)
  8298*           COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
  8299*           LENGTH     (EMI-COMM-LENGTH)
  8300*       END-EXEC
  8301*    MOVE '."C                   (   #00007394' TO DFHEIV0
  8302     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8303     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8304     MOVE X'2020233030303037333934' TO DFHEIV0(25:11)
  8305     CALL 'kxdfhei1' USING DFHEIV0,
  8306           PGM-NAME,
  8307           ERROR-MESSAGE-INTERFACE-BLOCK,
  8308           EMI-COMM-LENGTH,
  8309           DFHEIV99,
  8310           DFHEIV99,
  8311           DFHEIV99,
  8312           DFHEIV99
  8313     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8314     END-IF
  8315     .
  8316 9900-EXIT.
  8317     EXIT.
  8318 9990-ABEND.
  8319     MOVE LINK-004               TO PGM-NAME.
  8320     MOVE DFHEIBLK               TO EMI-LINE1.
  8321
  8322* EXEC CICS LINK
  8323*        PROGRAM   (PGM-NAME)
  8324*        COMMAREA  (EMI-LINE1)
  8325*        LENGTH    (72)
  8326*    END-EXEC.
  8327     MOVE 72
  8328       TO DFHEIV11
  8329*    MOVE '."C                   (   #00007406' TO DFHEIV0
  8330     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8331     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8332     MOVE X'2020233030303037343036' TO DFHEIV0(25:11)
  8333     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 146
* EL6318.cbl
  8334           PGM-NAME,
  8335           EMI-LINE1,
  8336           DFHEIV11,
  8337           DFHEIV99,
  8338           DFHEIV99,
  8339           DFHEIV99,
  8340           DFHEIV99
  8341     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8342
  8343     GO TO 8200-SEND-DATAONLY.
  8344
  8345* GOBACK.
  8346     MOVE '9%                    "   ' TO DFHEIV0
  8347     MOVE 'EL6318' TO DFHEIV1
  8348     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  8349     GOBACK.
  8350 9995-SECURITY-VIOLATION.
  8351*                            COPY ELCSCTP.
  8352******************************************************************
  8353*                                                                *
  8354*                            ELCSCTP                             *
  8355*                            VMOD=2.001                          *
  8356*                                                                *
  8357*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  8358******************************************************************
  8359
  8360
  8361     MOVE EIBDATE          TO SM-JUL-DATE.
  8362     MOVE EIBTRMID         TO SM-TERMID.
  8363     MOVE THIS-PGM         TO SM-PGM.
  8364     MOVE EIBTIME          TO TIME-IN.
  8365     MOVE TIME-OUT         TO SM-TIME.
  8366     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  8367
  8368
  8369* EXEC CICS LINK
  8370*         PROGRAM  ('EL003')
  8371*         COMMAREA (SECURITY-MESSAGE)
  8372*         LENGTH   (80)
  8373*    END-EXEC.
  8374     MOVE 'EL003' TO DFHEIV1
  8375     MOVE 80
  8376       TO DFHEIV11
  8377*    MOVE '."C                   (   #00007431' TO DFHEIV0
  8378     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8379     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8380     MOVE X'2020233030303037343331' TO DFHEIV0(25:11)
  8381     CALL 'kxdfhei1' USING DFHEIV0,
  8382           DFHEIV1,
  8383           SECURITY-MESSAGE,
  8384           DFHEIV11,
  8385           DFHEIV99,
  8386           DFHEIV99,
  8387           DFHEIV99,
  8388           DFHEIV99
  8389     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8390
  8391
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 147
* EL6318.cbl
  8392******************************************************************
  8393
  8394 9995-EXIT.
  8395     EXIT.
  8396
  8397 9999-DFHBACK SECTION.
  8398     MOVE '9%                    "   ' TO DFHEIV0
  8399     MOVE 'EL6318' TO DFHEIV1
  8400     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  8401     GOBACK.
  8402 9999-DFHEXIT.
  8403     IF DFHEIGDJ EQUAL 0001
  8404         NEXT SENTENCE
  8405     ELSE IF DFHEIGDJ EQUAL 2
  8406         GO TO 8300-SEND-TEXT
  8407         DEPENDING ON DFHEIGDI.
  8408     MOVE '9%                    "   ' TO DFHEIV0
  8409     MOVE 'EL6318' TO DFHEIV1
  8410     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  8411     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       34756     Code:       19212
