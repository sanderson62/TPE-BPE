* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page   1
* EL131.cbl
* Options: int("EL131.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL131.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL131.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL131.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL131 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/03/95 18:43:40.
     7*                            VMOD=2.046.
     8*
     9*AUTHOR.        LOGIC, INC.
    10*               DALLAS, TEXAS.
    11*REMARKS. TRANSACTION EX24 - CLAIM MAINTENANCE.
    12*
    13******************************************************************
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page   2
* EL131.cbl
    14*                   C H A N G E   L O G
    15*
    16* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    17*-----------------------------------------------------------------
    18*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    19* EFFECTIVE    NUMBER
    20*-----------------------------------------------------------------
    21* 101501    2001100100006  SMVA  ADD USERID, POPULATE COMPO
    22* 062602    2002030700006  PEMA  Add note type of 'S'
    23*                                  (special review)
    24* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYP I
    25* 071508    2008071000003  AJRA  ADD EDIT FOR SOC SEC NUMBER
    26* 012009    2007042600001  PEMA  RESTRICT CLAIM TYPE FOR CID
    27* 032612    2011110200001  PEMA  AHL CHANGES
    28* 040412    2012040400003  AJRA  DO NOT DELETE CERT ON AHL
    29* 032613    2013032500002  AJRA  PROTECT CERT#,CARR,GRP,ST,ACCT,EF
    30* 052113    2012113000002  PEMA  ADD SPECIAL STUFF FOR SPP DDF
    31* 060413    2013060300001  AJRA  CHECK FOR AUTO PAY WHEN BENE REMO
    32* 071613    2013071200001  PEMA  REMOVE INC & RPT DATE EDITS.
    33* 080613    2013071600001  PEMA  ALLOW INC DTE CHANGE
    34* 082013    2013040900001  AJRA  ADD PF15 BENEFICIARY MAINT
    35* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
    36* 111113    2013110600002  AJRA  CHG LEVEL 5 RESTRICTIONS TO LEVEL
    37* 040814    2014030500002  AJRA  ADD ICD CODES
    38* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
    39* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
    40* 070714    2014052800001  PEMA  correct read on erpdef for DCC
    41* 031715  CR2015022700002  PEMA  CHECK CHG IN DIAGNOSIS
    42* 031815    2015021700001  TANA  BENE EDIT IF A PAYMENT PENDING
    43* 020816  CR2015082500001  PEMA  ADD PROCESSING FOR NEW COMP VPP
    44* 040617  CR2017022200003  TANA  INCREASE CHG INC DT TO 180 DAYS
    45* 062217  CR2017050300002  TANA  ADD AUTH RCVD FIELD
    46* 081817    2016100700001  TANA  ADD NBR OF EXTENSIONS
    47* 101917  CR2017083000003  TANA  ADD CONTRACT CONTESTABLE MSG
    48* 021418  CR2017110200001  TANA  EDIT NAME CHANGE AGST INSRD TYPE
    49* 052918  CR2018031500002  TANA  Add Message for filing time limit
    50* 061418  IR2018053000003  TANA  Fix Causal state / filing limit
    51* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
    52* 011020  IR2019121100004  PEMA  ADD last name to compare.
    53******************************************************************
    54
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page   3
* EL131.cbl
    56 ENVIRONMENT DIVISION.
    57
    58 DATA DIVISION.
    59
    60 WORKING-STORAGE SECTION.
    61 01  DFH-START PIC X(04).
    62
    63 77  FILLER  PIC X(32)  VALUE '********************************'.
    64 77  FILLER  PIC X(32)  VALUE '*   EL131  WORKING STORAGE     *'.
    65 77  FILLER  PIC X(32)  VALUE '*********** VMOD=2.046 *********'.
    66 77  s1                          pic s999 comp-3 value+0.
    67 77  s2                          pic s999 comp-3 value+0.
    68 77  a1                          pic s999 comp-3 value+0.
    69 77  WS-CRITICAL-PERIOD          PIC 99    VALUE ZEROS.
    70 77  WS-CRIT-PER-RTW-MOS         PIC 99    VALUE ZEROS.
    71 77  WS-EXCL-PERIOD              PIC S999 COMP-3 VALUE +0.
    72 77  WS-COV-ENDS                 PIC S999 COMP-3 VALUE +0.
    73 77  WS-ACC-PERIOD               PIC S999 COMP-3 VALUE +0.
    74 77  ws-max-extension            pic s999 comp-3 value +0.
    75 77  ws-max-moben                pic s9(7)v99 comp-3 value +0.
    76 77  WS-MONTHS-BETWEEN           PIC S999 COMP-3 VALUE +0.
    77 77  WS-ERPDEF-SW                PIC X     VALUE ' '.
    78     88  ERPDEF-FOUND                 VALUE 'Y'.
    79 77  WS-TRLR-FILE-EOF            PIC X     VALUE ' '.
    80     88  TRLR-FILE-EOF                VALUE 'Y'.
    81 77  WS-PAYMENT-PENDING          PIC X     VALUE ' '.
    82     88  PAYMENT-PENDING              VALUE 'Y'.
    83 77  WS-AUTH-RCVD                PIC X     VALUE ' '.
    84     88  AUTH-RCVD                    VALUE 'Y'.
    85     88  NO-AUTH-RCVD                 VALUE 'N'.
    86 77  ws-eracct-sw                pic x  value ' '.
    87     88  acct-found                value 'Y'.
    88 77  ws-benper-sw                pic x   value ' '.
    89     88  good-benper               value 'Y'.
    90 77  ws-claim-type               pic x value ' '.
    91 77  ws-ben-per                  pic 99 value 00.
    92 77  ws-tot-days-paid            pic s9(5) comp-3 value +0.
    93 77  ws-tot-amt-paid             pic s9(9)v99 comp-3 value +0.
    94 77  ws-pd-bens                  pic s9(5) comp-3 value +0.
    95 77  ws-max-bens                 pic s9(5) comp-3 value +0.
    96
    97 01  LCP-TIME-OF-DAY-XX.
    98     05  LCP-TIME-OF-DAY-68        PIC 9(6).
    99     05  FILLER                    PIC 99.
   100 01  LCP-CICS-TIME                 PIC 9(15).
   101*                            COPY ELCSCTM.
   102******************************************************************
   103*                                                                *
   104*                                                                *
   105*                            ELCSCTM                             *
   106*                            VMOD=2.001                          *
   107*                                                                *
   108*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   109*                                                                *
   110******************************************************************
   111 01  SECURITY-MESSAGE.
   112     12  FILLER                          PIC X(30)
   113            VALUE '** LOGIC SECURITY VIOLATION -'.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page   4
* EL131.cbl
   114     12  SM-READ                         PIC X(6).
   115     12  FILLER                          PIC X(5)
   116            VALUE ' PGM='.
   117     12  SM-PGM                          PIC X(6).
   118     12  FILLER                          PIC X(5)
   119            VALUE ' OPR='.
   120     12  SM-PROCESSOR-ID                 PIC X(4).
   121     12  FILLER                          PIC X(6)
   122            VALUE ' TERM='.
   123     12  SM-TERMID                       PIC X(4).
   124     12  FILLER                          PIC XX   VALUE SPACE.
   125     12  SM-JUL-DATE                     PIC 9(5).
   126     12  FILLER                          PIC X    VALUE SPACE.
   127     12  SM-TIME                         PIC 99.99.
   128
   129
   130*                            COPY ELCSCRTY.
   131******************************************************************
   132*                                                                *
   133*                                                                *
   134*                            ELCSCRTY                            *
   135*                            VMOD=2.001                          *
   136*                                                                *
   137*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   138*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   139*        SAVED IN PI-SECURITY-ADDRESS.                           *
   140*                                                                *
   141******************************************************************
   142 01  SECURITY-CONTROL.
   143     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   144     12  FILLER                       PIC XX    VALUE 'SC'.
   145     12  SC-CREDIT-CODES.
   146         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   147             20  SC-CREDIT-DISPLAY    PIC X.
   148             20  SC-CREDIT-UPDATE     PIC X.
   149     12  SC-CLAIMS-CODES.
   150         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   151             20  SC-CLAIMS-DISPLAY    PIC X.
   152             20  SC-CLAIMS-UPDATE     PIC X.
   153
   154*                            COPY ELCNWA.
   155*****************************************************************
   156*                                                               *
   157*                                                               *
   158*                            ELCNWA.                            *
   159*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   160*                            VMOD=2.003                         *
   161*                                                               *
   162*            M O V E   N A M E   W O R K   A R E A.             *
   163*                                                               *
   164*****************************************************************.
   165
   166 01  WS-NAME-WORK-AREA.
   167     05  WS-INSURED-LAST-NAME        PIC X(15).
   168     05  WS-INSURED-1ST-NAME         PIC X(12).
   169     05  WS-INSURED-MID-INIT         PIC X.
   170
   171     05  WS-NAME-WORK.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page   5
* EL131.cbl
   172         10  WS-NW                   PIC X
   173             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
   174
   175     05  WS-NAME-WORK2.
   176         10  WS-NW2                  PIC X
   177             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
   178                                        NWA-INDEX0.
   179
   180     05  WS-NAME-SW                  PIC S9          VALUE ZERO
   181                                     COMP-3.
   182
   183
   184 01  ws-dcc-error-line.
   185     05  filler occurs 15.
   186         10  ws-error-no        pic x(4).
   187 01  WS-DATE-AREA.
   188     12  SAVE-DATE              PIC X(8)    VALUE SPACES.
   189     12  SAVE-BIN-DATE          PIC XX      VALUE SPACES.
   190     12  SAVE-DATE-CCYYMMDD.
   191         16  SAVE-DATE-CC       PIC XX      VALUE SPACES.
   192         16  SAVE-DATE-YMD.
   193             20  SAVE-DATE-YY   PIC XX      VALUE SPACES.
   194             20  FILLER         PIC X(4)    VALUE SPACES.
   195
   196 01  WS-BLANK                   PIC X       VALUE ' '.
   197
   198 01  CSO-WORK-FIELDS.
   199     05  WS-HOLD-CLAIM-STATUS    PIC X.
   200     05  WS-CRIT-PER-RECURRENT   PIC 99    VALUE 00.
   201     05  WS-CRIT-PER-ALPHA REDEFINES WS-CRIT-PER-RECURRENT.
   202         10  WS-RECURRENT-YN     PIC X.
   203         10  FILLER              PIC X.
   204
   205 01  LITERALS-NUMBERS.
   206     12  SC-ITEM                 PIC S9(4)   VALUE +1    COMP.
   207     12  NINETY                  PIC S9(4)   VALUE +90   COMP.
   208     12  ELMSTR-GENERIC-LENGTH   PIC S9(4)   VALUE +9    COMP.
   209     12  GETMAIN-SPACE           PIC X       VALUE SPACE.
   210     12  THIS-PGM                PIC X(8)    VALUE 'EL131'.
   211     12  TRAN-ID                 PIC X(4)    VALUE 'EX24'.
   212     12  MAP-ID                  PIC X(4)    VALUE '131A'.
   213     12  MAP-LENGTH              PIC S9(4)   VALUE +1060  COMP.
   214
   215     12  XCTL-EL001              PIC X(8)    VALUE 'EL001'.
   216     12  XCTL-EL004              PIC X(8)    VALUE 'EL004'.
   217     12  XCTL-EL005              PIC X(8)    VALUE 'EL005'.
   218     12  XCTL-EL010              PIC X(8)    VALUE 'EL010'.
   219     12  XCTL-EL114              PIC X(8)    VALUE 'EL114'.
   220     12  XCTL-EL126              PIC X(8)    VALUE 'EL126'.
   221     12  XCTL-EL1273             PIC X(8)    VALUE 'EL1273'.
   222     12  XCTL-EL141              PIC X(8)    VALUE 'EL141'.
   223     12  XCTL-EL142              PIC X(8)    VALUE 'EL142'.
   224     12  XCTL-EL400DMD           PIC X(8)    VALUE 'EL400DMD'.
   225
   226     12  LINK-1523               PIC X(8)    VALUE 'EL1523'.
   227
   228     12  DATE-CONV               PIC X(8)    VALUE 'ELDATCV'.
   229
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page   6
* EL131.cbl
   230     12  RTRM-FILE-ID            PIC X(8)    VALUE 'ELRTRM'.
   231     12  CLMS-FILE-ID            PIC X(8)    VALUE 'ELMSTR'.
   232     12  NOTE-FILE-ID            PIC X(8)    VALUE 'ERNOTE'.
   233     12  CERT-FILE-ID            PIC X(8)    VALUE 'ELCERT'.
   234     12  TRLR-FILE-ID            PIC X(8)    VALUE 'ELTRLR'.
   235     12  CNTL-FILE-ID            PIC X(8)    VALUE 'ELCNTL'.
   236     12  ACTQ-FILE-ID            PIC X(8)    VALUE 'ELACTQ'.
   237     12  CHKQ-FILE-ID            PIC X(8)    VALUE 'ELCHKQ'.
   238     12  ACCT-FILE-ID            PIC X(8)    VALUE 'ERACCT'.
   239     12  ARCH-FILE-ID            PIC X(8)    VALUE 'ELARCH'.
   240     12  ALPH-FILE-ID            PIC X(8)    VALUE 'ELALPH'.
   241     12  WS-CONTEST-NOTE      PIC X(44)
   242         VALUE 'CONTRACT NOW CONTESTABLE - INC/RPT DT CHGD'.
   243     12  WS-FILE-LIM-NOTE     PIC X(44)
   244         VALUE 'FILING TIME LIMIT OK - INCRD DT CHGD'.
   245
   246     12  WS-FILING-NOTE     PIC X(30)
   247         VALUE 'FILING TIME LIMIT EXCEEDED'.
   248
   249     12  MISC-SUB                PIC S9(3)   COMP-3  VALUE +0.
   250     12  ONE-OR-MIN1             PIC S9      COMP-3  VALUE +1.
   251     12  WS-READNEXT-SWITCH      PIC S99     VALUE +1.
   252     12  WS-ASSOC-CERT-TOTAL     PIC S99             VALUE ZEROS.
   253         88  NO-ASSOCIATED-CERTS                     VALUE ZEROS.
   254     12  WS-ASSOC-CERT-SEQU      PIC S99             VALUE ZEROS.
   255     12  WS-ASSOCIATED-CERTS     PIC S9      COMP-3  VALUE +0.
   256     12  WS-DIAGNOSIS            PIC X(60)   VALUE SPACES.
   257     12  WS-ICD-CODE-1           PIC X(8).
   258     12  WS-ICD-CODE-2           PIC X(8).
   259     12  WS-CLAIM-SEQU.
   260         16  FILLER              PIC X VALUE '('.
   261         16  WS-CURRENT-SEQU     PIC Z9.
   262         16  FILLER              PIC X(04) VALUE ' OF '.
   263         16  WS-OF-SEQU          PIC Z9.
   264         16  FILLER              PIC X VALUE ')'.
   265     12  WS-EDIT-BEN-CODE        PIC XX.
   266         88  INVALID-BENEFIT-CODE   VALUE '  ' '00'
   267                                          '90' THRU '99'.
   268
   269     12  WS-EDIT-AMT             PIC ZZZ,ZZZ.99.
   270     12  WS-EDIT-NUMBER          PIC ZZZ9.
   271
   272     12  WS-RESPONSE             PIC S9(8)   COMP.
   273         88  WS-RESP-NORMAL              VALUE +00.
   274         88  WS-RESP-ERROR               VALUE +01.
   275         88  WS-RESP-NOTFND              VALUE +13.
   276         88  WS-RESP-DUPKEY              VALUE +15.
   277         88  WS-RESP-NOTOPEN             VALUE +19.
   278         88  WS-RESP-ENDFILE             VALUE +20.
   279
   280     12  WS-MOS-PAID             PIC 999.
   281     12  WS-ODD-DAYS             PIC 99.
   282     12  WS-REM-MOS              PIC 999.
   283     12  WS-REM-DAYS             PIC 99.
   284     12  WS-TERM-IN-DAYS         PIC 9(4).
   285     12  WS-REM-TERM-IN-DAYS     PIC 9(4).
   286
   287     12  WS-BROWSE-SW            PIC X       VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page   7
* EL131.cbl
   288     12  WS-UPDATE-SW            PIC X       VALUE 'N'.
   289     12  WS-OPEN-CLOSE-SW        PIC X       VALUE ' '.
   290     12  WS-RESET-SW             PIC X       VALUE 'N'.
   291     12  WS-REC-FOUND-SW         PIC X       VALUE 'N'.
   292     12  WS-DMO-LENGTH           PIC S9(4)   VALUE +108 COMP.
   293     12  WS-DCT-LENGTH           PIC S9(4)   VALUE +53 COMP.
   294
   295 01  DMD-DATE-YYYYMMDD.
   296     12  DMD-DECADE          PIC XX      VALUE SPACES.
   297     12  DMD-YYMMDD.
   298         16  DMD-YY          PIC XX      VALUE SPACES.
   299         16  DMD-MM          PIC XX      VALUE SPACES.
   300         16  DMD-DD          PIC XX      VALUE SPACES.
   301
   302 01  DMD-DATE-MMDDYYYY.
   303     12  DMD-MDY-MM          PIC XX      VALUE SPACES.
   304     12  DMD-MDY-SLASH1      PIC X       VALUE '/'.
   305     12  DMD-MDY-DD          PIC XX      VALUE SPACES.
   306     12  DMD-MDY-SLASH2      PIC X       VALUE '/'.
   307     12  DMD-MDY-DECADE      PIC XX      VALUE SPACES.
   308     12  DMD-MDY-YY          PIC XX      VALUE SPACES.
   309
   310 01  WS-MAIL-CODE.
   311     12  FILLER              PIC X.
   312     12  DMD-MAIL-CODE.
   313         16  WS-MAIL-4       PIC X(4).
   314         16  WS-MAIL-5       PIC X.
   315     12  FILLER              PIC X(4).
   316
   317     12  W-NAME-LAST             PIC  X(15).
   318     12  W-NAME-FIRST            PIC  X(15).
   319     12  W-NAME-MIDDLE.
   320         16  FILLER              PIC  X.
   321         16  W-NAME-MIDDLE-2     PIC  X.
   322         16  FILLER              PIC  X(13).
   323
   324*    COPY ELCDCTB.
   325******************************************************************
   326*                                                                *
   327*                                                                *
   328*                            ELCDCTB.                            *
   329*                            VMOD=2.002                          *
   330*                                                                *
   331*   DESCRIPTION = DISTRIBUTION CONTROL TABLE MAINTENANCE PROGRAM *
   332*       COMMUNICATIONS AREA                                      *
   333*                                                                *
   334******************************************************************
   335 01  DCT-COMMUNICATION-AREA.
   336     12  DCT-BILLING-BANK-ID      PIC  X(05).
   337     12  DCT-LOGIC-BENEFICIARY-ID PIC  X(10).
   338     12  DCT-CREDIT-CARD-NUMBER   PIC  X(16).
   339     12  DCT-PRODUCT-CODE         PIC  X(02).
   340     12  DCT-COLUMN-ID-REQUESTED  PIC  X(02).
   341     12  DCT-RETURN-CODE          PIC  X(02).
   342     12  DCT-MAIL-CODE            PIC  X(05).
   343     12  DCT-DISTRIBUTION-CODE    PIC  X(04).
   344     12  DCT-MSA-ACCT-NO          PIC  X(07).
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page   8
* EL131.cbl
   346 01  ERROR-SWITCHES.
   347     12  ERROR-SWITCH            PIC X.
   348         88  SCREEN-ERROR                    VALUE 'X'.
   349     12  MSTR-KEY-SWITCH         PIC X.
   350         88  MSTR-KEY-CHANGED                VALUE 'X'.
   351     12  CERT-KEY-SWITCH         PIC X.
   352*********SET TO X IF ALTERNATE INDEXES WILL CHANGE
   353         88  CERT-ALT-KEY-CHANGED            VALUE 'X'.
   354*********SET TO Y IF PRIMARY KEY WILL CHANGE
   355         88  CERT-KEY-CHANGED                VALUE 'Y'.
   356     12  MSTR-SWITCH             PIC X.
   357         88  MSTR-UPDATES                    VALUE 'X'.
   358     12  crtt-switch             pic x value spaces.
   359         88  crtt-update             value 'X'.
   360     12  CERT-SWITCH             PIC X.
   361         88  CERT-UPDATES                    VALUE 'X'.
   362     12  UPDATE-SWITCH           PIC X.
   363         88  UPDATES-PRESENT                 VALUE 'X'.
   364     12  TRLR-SWITCH             PIC X.
   365         88  TRLR-UPDATE-REQUIRED            VALUE 'X'.
   366         88  UPDATE-MADE                     VALUE 'Y'.
   367     12  NINETY-TRLR-SWITCH      PIC X.
   368         88  NINETY-TRLR-UPDATED             VALUE 'X'.
   369     12  NINETY5-TRLR-SWITCH      PIC X  VALUE ' '.
   370         88  NINETY5-TRLR-UPDATED             VALUE 'X'.
   371     12  EARNINGS-CALC-SWITCH    PIC X.
   372         88  TEX-REG                         VALUE '4'.
   373         88  NET-PAY                         VALUE '5'.
   374     12  DLYACTV-SW              PIC X       VALUE 'N'.
   375         88  DLYACTV-RECORD-NEEDED           VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page   9
* EL131.cbl
   377 01  EDIT-WORK-AREA.
   378     12  COUNT-2                 PIC 9.
   379     12  CALL-PGM                PIC X(8).
   380     12  TRANS-ID                PIC X(4).
   381     12  CHECK-PFKEYS            PIC 99.
   382     12  CHECK-MAINT             PIC X.
   383         88  ADD-ALPHA-RECORD                VALUE 'A'.
   384         88  CHANGE-CLAIM                    VALUE 'C'.
   385         88  DELETE-CLAIM                    VALUE 'D'.
   386         88  CHANGE-NAME                     VALUE 'N'.
   387         88  VALID-OPTIONS                   VALUE 'A' 'C'
   388                                                   'D' 'N'.
   389
   390     12  HOLD-BENEFIT            PIC XX.
   391     12  HOLD-FREQ               PIC XX.
   392     12  HOLD-REPORTED           PIC XX  VALUE LOW-VALUES.
   393     12  HOLD-INCUR              PIC XX  VALUE LOW-VALUES.
   394     12  HOLD-PDTHRU             PIC XX.
   395     12  HOLD-ADDON              PIC XX.
   396     12  HOLD-NODAYS             PIC 9(4).
   397     12  HOLD-NOPMTS             PIC 9(3).
   398     12  HOLD-PDAMT              PIC 9(7)V99    COMP-3.
   399     12  HOLD-LOANBAL            PIC 9(7)V99    COMP-3  VALUE 0.
   400     12  HOLD-APR                PIC 9(3)V9(4)  COMP-3  VALUE 0.
   401     12  HOLD-BIRTH              PIC XX.
   402     12  HOLD-END                PIC XX.
   403     12  HOLD-EFF                PIC XX.
   404     12  HOLD-ENTRY              PIC XX.
   405     12  HOLD-LF-CV-BEN          PIC S9(9)V99   COMP-3  VALUE +0.
   406     12  HOLD-LF-RATE            PIC S9(4)V99   COMP-3  VALUE +0.
   407     12  HOLD-AH-CV-BEN          PIC S9(9)V99   COMP-3  VALUE +0.
   408     12  HOLD-AH-RATE            PIC S9(4)V99   COMP-3  VALUE +0.
   409     12  HOLD-LF-CV-CAN          PIC XX.
   410     12  HOLD-AH-CV-CAN          PIC XX.
   411     12  DIVIDE-QUOT             PIC 9(3).
   412     12  DIVIDE-REM              PIC 9(3).
   413
   414     12  WS-ALPHA-DATE.
   415         16  WS-ALPHA-YEAR.
   416             20  WS-ALPHA-YY-1   PIC 99.
   417             20  WS-ALPHA-YY-2   PIC 99.
   418         16  WS-ALPHA-MM         PIC 99.
   419         16  WS-ALPHA-DD         PIC 99.
   420
   421     12  BUILD-VALID-DATE.
   422         16  BUILD-MONTH         PIC 99.
   423         16  BUILD-DAY           PIC 99.
   424         16  BUILD-YEAR          PIC 99.
   425     12  DEEDIT-MMYY-INPUT.
   426         16  FILLER              PIC X.
   427         16  DEEDIT-MONTH        PIC XX.
   428         16  DEEDIT-YEAR         PIC XX.
   429     12  DEEDIT-BEN              PIC 9(9)V99.
   430     12  DEEDIT-DATE-INPUT.
   431         16  FILLER              PIC XX.
   432         16  DEEDIT-DATE         PIC X(6).
   433     12  WORK-DATE-MDY.
   434         16  MONTH-WORK          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page  10
* EL131.cbl
   435         16  FILLER              PIC X(4).
   436         16  YEAR-WORK           PIC XX.
   437     12  WORK-DATE-MY.
   438         16  WORK-MONTH          PIC XX.
   439         16  WORK-SLASH          PIC X       VALUE '/'.
   440         16  WORK-YEAR           PIC XX.
   441     12  HOLD-DATE.
   442         16  HOLD-MONTH          PIC 99.
   443         16  FILLER              PIC X(4).
   444         16  HOLD-YEAR           PIC 99.
   445     12  SPLIT-INFO-LINE-1.
   446         16  SPLIT-INFO-DESC     PIC X(15).
   447         16  FILLER              PIC X(5)    VALUE ' OLD='.
   448         16  SPLIT-INFO-OLD      PIC X(40).
   449     12  EFF-TERM-MO             PIC 9(4).
   450     12  CURR-MO                 PIC 9(4).
   451     12  WS-BIN-CURRENT-DT       PIC XX.
   452     12  WS-CALC-METHOD          PIC X.
   453     12  WS-INITIALS.
   454         16  WS-INIT-1           PIC X.
   455         16  WS-INIT-2           PIC X.
   456     12  WS-REIN-TABLE.
   457         16  WS-REIN-1           PIC X.
   458         16  WS-REIN-2           PIC X.
   459         16  WS-REIN-3           PIC X.
   460     12  PI-KEY.
   461         16  PI-TERM             PIC X(4).
   462         16  PI-QUAL             PIC X(4).
   463     12  CHECK-KEY               PIC X(20).
   464     12  SAVE-ACCT-KEY           PIC X(20).
   465     12  SKIP-ATTRIBUTE          PIC X      VALUE SPACES.
   466     12  WS-SOC-SEC-NUMBER.
   467         16  WS-SOC-SEC-NO       PIC 9(9).
   468         16  WS-SOC-SEC-BLANK    PIC X(2).
   469     12  WS-SOC-SEC-REDEF REDEFINES WS-SOC-SEC-NUMBER.
   470         16  WS-SSN-1-3          PIC 9(3).
   471         16  WS-SSN-DASH1        PIC X(1).
   472         16  WS-SSN-4-5          PIC 9(2).
   473         16  WS-SSN-DASH2        PIC X(1).
   474         16  WS-SSN-6-9          PIC 9(4).
   475     12  AUTO-PAY-TO-BENE        PIC X     VALUE 'N'.
   476     12  WS-RETURNED-FROM        PIC X(8)  VALUE SPACES.
   477
   478 01  WS-SAVE-FIELDS.
   479     12  WS-SAVE-BENEFICIARY     PIC X(10) VALUE LOW-VALUES.
   480     12  WS-SAVE-MAINTI          PIC X(1) VALUE LOW-VALUES.
   481     12  WS-SAVE-MAINTL          PIC S9(4) COMP VALUE +0.
   482     12  WS-SAVE-STATUSI         PIC X(6) VALUE LOW-VALUES.
   483     12  WS-SAVE-STATUSL         PIC S9(4) COMP VALUE +0.
   484     12  WS-SAVE-REPI            PIC X(8) VALUE LOW-VALUES.
   485     12  WS-SAVE-REPL            PIC S9(4) COMP VALUE +0.
   486     12  WS-SAVE-CAUSEI          PIC X(6) VALUE LOW-VALUES.
   487     12  WS-SAVE-CAUSEL          PIC S9(4) COMP VALUE +0.
   488     12  WS-SAVE-ENDI            PIC X(8) VALUE LOW-VALUES.
   489     12  WS-SAVE-ENDL            PIC S9(4) COMP VALUE +0.
   490     12  WS-SAVE-DIAGI           PIC X(60) VALUE LOW-VALUES.
   491     12  WS-SAVE-DIAGL           PIC S9(4) COMP VALUE +0.
   492     12  WS-SAVE-ICD1I           PIC X(8)  VALUE LOW-VALUES.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page  11
* EL131.cbl
   493     12  WS-SAVE-ICD1L           PIC S9(4) COMP VALUE +0.
   494     12  WS-SAVE-ICD2I           PIC X(8)  VALUE LOW-VALUES.
   495     12  WS-SAVE-ICD2L           PIC S9(4) COMP VALUE +0.
   496     12  WS-SAVE-BENEI           PIC X(10) VALUE LOW-VALUES.
   497     12  WS-SAVE-BENEL           PIC S9(4) COMP VALUE +0.
   498     12  WS-SAVE-BIRTHI          PIC X(8) VALUE LOW-VALUES.
   499     12  WS-SAVE-BIRTHL          PIC S9(4) COMP VALUE +0.
   500     12  WS-SAVE-SOCIALI         PIC X(11) VALUE LOW-VALUES.
   501     12  WS-SAVE-SOCIALL         PIC S9(4) COMP VALUE +0.
   502     12  WS-SAVE-SEXI            PIC X(1) VALUE LOW-VALUES.
   503     12  WS-SAVE-SEXL            PIC S9(4) COMP VALUE +0.
   504     12  WS-SAVE-MLNAMEI         PIC X(15) VALUE LOW-VALUES.
   505     12  WS-SAVE-MLNAMEL         PIC S9(4) COMP VALUE +0.
   506     12  WS-SAVE-MFNAMEI         PIC X(12) VALUE LOW-VALUES.
   507     12  WS-SAVE-MFNAMEL         PIC S9(4) COMP VALUE +0.
   508     12  WS-SAVE-MMINITI         PIC X(1) VALUE LOW-VALUES.
   509     12  WS-SAVE-MMINITL         PIC S9(4) COMP VALUE +0.
   510     12  WS-SAVE-LOANNOI         PIC X(8) VALUE LOW-VALUES.
   511     12  WS-SAVE-LOANNOL         PIC S9(4) COMP VALUE +0.
   512     12  WS-SAVE-LOANBALI        PIC 9(7)V99 VALUE ZEROS.
   513     12  WS-SAVE-LOANBALL        PIC S9(4) COMP VALUE +0.
   514     12  WS-SAVE-PROCI           PIC X(4) VALUE LOW-VALUES.
   515     12  WS-SAVE-PROCL           PIC S9(4) COMP VALUE +0.
   516     12  WS-SAVE-SUPVI           PIC X(1) VALUE LOW-VALUES.
   517     12  WS-SAVE-SUPVL           PIC S9(4) COMP VALUE +0.
   518     12  WS-SAVE-PRICDI          PIC X(1) VALUE LOW-VALUES.
   519     12  WS-SAVE-PRICDL          PIC S9(4) COMP VALUE +0.
   520     12  WS-SAVE-FILETOI         PIC X(4) VALUE LOW-VALUES.
   521     12  WS-SAVE-FILETOL         PIC S9(4) COMP VALUE +0.
   522     12  WS-SAVE-PDTHRUI         PIC X(8) VALUE LOW-VALUES.
   523     12  WS-SAVE-PDTHRUL         PIC S9(4) COMP VALUE +0.
   524     12  WS-SAVE-PDAMTI          PIC 9(7)V99 VALUE ZEROS.
   525     12  WS-SAVE-PDAMTL          PIC S9(4) COMP VALUE +0.
   526     12  WS-SAVE-NODAYSI         PIC 9(5) VALUE ZEROS.
   527     12  WS-SAVE-NODAYSL         PIC S9(4) COMP VALUE +0.
   528     12  WS-SAVE-NOPMTSI         PIC 9(4) VALUE ZEROS.
   529     12  WS-SAVE-NOPMTSL         PIC S9(4) COMP VALUE +0.
   530     12  WS-SAVE-FORMTYPI        PIC X(1) VALUE LOW-VALUES.
   531     12  WS-SAVE-FORMTYPL        PIC S9(4) COMP VALUE +0.
   532     12  WS-SAVE-OCCI            PIC X(6) VALUE LOW-VALUES.
   533     12  WS-SAVE-OCCL            PIC S9(4) COMP VALUE +0.
   534
   535 01  TERM-CALCULATION-WORK-AREA     COMP-3.
   536     12  M                   PIC S9(7)V99           VALUE ZEROS.
   537     12  L                   PIC S9(7)V99           VALUE ZEROS.
   538     12  N                   PIC S9(3)              VALUE ZEROS.
   539     12  N-STORE             PIC S9(3)              VALUE ZEROS.
   540     12  NV-STORE            PIC S9(3)              VALUE ZEROS.
   541     12  I                   PIC S99V9(5)           VALUE ZEROS.
   542     12  A-N                 PIC S9(7)V9(8)         VALUE ZEROS.
   543     12  IA-N                PIC S9(7)V9(8)         VALUE ZEROS.
   544     12  V                   PIC S9(3)V9(14)        VALUE ZEROS.
   545     12  R                   PIC S9(3)              VALUE ZEROS.
   546     12  M1                  PIC S9(7)V99           VALUE ZEROS.
   547     12  V-EX-N              PIC S9(3)V9(14)        VALUE ZEROS.
   548     12  TERM1               PIC S9(8)V9(9)         VALUE ZEROS.
   549     12  TERM2               PIC S9(8)V9(9)         VALUE ZEROS.
   550     12  TERM3               PIC S9(8)V9(9)         VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page  12
* EL131.cbl
   551     12  TERM4               PIC S9(3)V9(14)        VALUE ZEROS.
   552     12  LEFT-TOT-1          PIC S9(9)V9(8)         VALUE ZEROS.
   553     12  RIGHT-TOT-1         PIC S9(9)V9(8)         VALUE ZEROS.
   554     12  RIGHT-TOT-2         PIC S9(9)V9(8)         VALUE ZEROS.
   555
   556 01  TERM-CALC-WORK-AREA.
   557     12  WS-AH-RATE          PIC S999V9(5)          VALUE ZEROS.
   558     12  WS-LF-RATE          PIC S999V9(5)          VALUE ZEROS.
   559     12  WS-TERM             PIC S9(3)              VALUE ZEROS.
   560     12  WS-TERM-REM         PIC S9(3)V99           VALUE ZEROS.
   561     12  WS-REMAIN           PIC S99                VALUE ZEROS.
   562     12  V-EXPONENTS.
   563        14  V-EXPONENT       PIC S9(3)V9(14) COMP-3 OCCURS 250.
   564     12  V-EX-ONETIME        PIC 9                  VALUE 1.
   565
   566 01  TIME-IN.
   567     12  UN-HOURS                PIC XX.
   568     12  UN-MINUTES              PIC XX.
   569     12  FILLER                  PIC XX.
   570
   571 01  TIME-OUT.
   572     12  FOR-HOURS               PIC XX.
   573     12  FILLER                  PIC X       VALUE '.'.
   574     12  FOR-MINUTES             PIC XX.
   575
   576 01  ERROR-NUMBERS.
   577     12  ER-0000                 PIC X(4)    VALUE '0000'.
   578     12  ER-0004                 PIC X(4)    VALUE '0004'.
   579     12  ER-0008                 PIC X(4)    VALUE '0008'.
   580     12  ER-0023                 PIC X(4)    VALUE '0023'.
   581     12  ER-0029                 PIC X(4)    VALUE '0029'.
   582     12  ER-0068                 PIC X(4)    VALUE '0068'.
   583     12  ER-0070                 PIC X(4)    VALUE '0070'.
   584     12  ER-0149                 PIC X(4)    VALUE '0149'.
   585     12  ER-0154                 PIC X(4)    VALUE '0154'.
   586     12  ER-0169                 PIC X(4)    VALUE '0169'.
   587     12  ER-0192                 PIC X(4)    VALUE '0192'.
   588     12  ER-0199                 PIC X(4)    VALUE '0199'.
   589     12  ER-0203                 PIC X(4)    VALUE '0203'.
   590     12  ER-0204                 PIC X(4)    VALUE '0204'.
   591     12  ER-0205                 PIC X(4)    VALUE '0205'.
   592     12  ER-0206                 PIC X(4)    VALUE '0206'.
   593     12  ER-0208                 PIC X(4)    VALUE '0208'.
   594     12  ER-0210                 PIC X(4)    VALUE '0210'.
   595     12  ER-0215                 PIC X(4)    VALUE '0215'.
   596     12  ER-0219                 PIC X(4)    VALUE '0219'.
   597     12  ER-0220                 PIC X(4)    VALUE '0220'.
   598     12  ER-0222                 PIC X(4)    VALUE '0222'.
   599     12  ER-0223                 PIC X(4)    VALUE '0223'.
   600     12  ER-0224                 PIC X(4)    VALUE '0224'.
   601     12  ER-0227                 PIC X(4)    VALUE '0227'.
   602     12  ER-0230                 PIC X(4)    VALUE '0230'.
   603     12  ER-0232                 PIC X(4)    VALUE '0232'.
   604     12  ER-0233                 PIC X(4)    VALUE '0233'.
   605     12  ER-0236                 PIC X(4)    VALUE '0236'.
   606     12  ER-0237                 PIC X(4)    VALUE '0237'.
   607     12  ER-0238                 PIC X(4)    VALUE '0238'.
   608     12  ER-0240                 PIC X(4)    VALUE '0240'.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page  13
* EL131.cbl
   609     12  ER-0241                 PIC X(4)    VALUE '0241'.
   610     12  ER-0243                 PIC X(4)    VALUE '0243'.
   611     12  ER-0244                 PIC X(4)    VALUE '0244'.
   612     12  ER-0246                 PIC X(4)    VALUE '0246'.
   613     12  ER-0247                 PIC X(4)    VALUE '0247'.
   614     12  ER-0248                 PIC X(4)    VALUE '0248'.
   615     12  ER-0250                 PIC X(4)    VALUE '0250'.
   616     12  ER-0251                 PIC X(4)    VALUE '0251'.
   617     12  ER-0253                 PIC X(4)    VALUE '0253'.
   618     12  ER-0256                 PIC X(4)    VALUE '0256'.
   619     12  ER-0257                 PIC X(4)    VALUE '0257'.
   620     12  ER-0258                 PIC X(4)    VALUE '0258'.
   621     12  ER-0259                 PIC X(4)    VALUE '0259'.
   622     12  ER-0260                 PIC X(4)    VALUE '0260'.
   623     12  ER-0261                 PIC X(4)    VALUE '0261'.
   624     12  ER-0262                 PIC X(4)    VALUE '0262'.
   625     12  ER-0263                 PIC X(4)    VALUE '0263'.
   626     12  ER-0273                 PIC X(4)    VALUE '0273'.
   627     12  ER-0274                 PIC X(4)    VALUE '0274'.
   628     12  ER-0276                 PIC X(4)    VALUE '0276'.
   629     12  ER-0282                 PIC X(4)    VALUE '0282'.
   630     12  ER-0283                 PIC X(4)    VALUE '0283'.
   631     12  ER-0309                 PIC X(4)    VALUE '0309'.
   632     12  ER-0310                 PIC X(4)    VALUE '0310'.
   633     12  ER-0311                 PIC X(4)    VALUE '0311'.
   634     12  ER-0333                 PIC X(4)    VALUE '0333'.
   635     12  ER-0360                 PIC X(4)    VALUE '0360'.
   636     12  ER-0377                 PIC X(4)    VALUE '0377'.
   637     12  ER-0402                 PIC X(4)    VALUE '0402'.
   638     12  ER-0416                 PIC X(4)    VALUE '0416'.
   639     12  ER-0426                 PIC X(4)    VALUE '0426'.
   640     12  ER-0427                 PIC X(4)    VALUE '0427'.
   641     12  ER-0428                 PIC X(4)    VALUE '0428'.
   642     12  ER-0429                 PIC X(4)    VALUE '0429'.
   643     12  ER-0430                 PIC X(4)    VALUE '0430'.
   644     12  ER-0458                 PIC X(4)    VALUE '0458'.
   645     12  ER-0475                 PIC X(4)    VALUE '0475'.
   646     12  ER-0491                 PIC X(4)    VALUE '0491'.
   647     12  ER-0509                 PIC X(4)    VALUE '0509'.
   648     12  ER-0510                 PIC X(4)    VALUE '0510'.
   649     12  ER-0511                 PIC X(4)    VALUE '0511'.
   650     12  ER-0512                 PIC X(4)    VALUE '0512'.
   651     12  ER-0519                 PIC X(4)    VALUE '0519'.
   652     12  ER-0520                 PIC X(4)    VALUE '0520'.
   653     12  ER-0521                 PIC X(4)    VALUE '0521'.
   654     12  ER-0547                 PIC X(4)    VALUE '0547'.
   655     12  ER-0548                 PIC X(4)    VALUE '0548'.
   656     12  ER-0549                 PIC X(4)    VALUE '0549'.
   657     12  ER-0565                 PIC X(4)    VALUE '0565'.
   658     12  ER-0598                 PIC X(4)    VALUE '0598'.
   659     12  ER-0639                 PIC X(4)    VALUE '0639'.
   660     12  ER-0797                 PIC X(4)    VALUE '0797'.
   661     12  ER-0802                 PIC X(4)    VALUE '0802'.
   662     12  ER-0803                 PIC X(4)    VALUE '0803'.
   663     12  ER-0849                 PIC X(4)    VALUE '0849'.
   664     12  ER-0885                 PIC X(4)    VALUE '0885'.
   665     12  ER-0887                 PIC X(4)    VALUE '0887'.
   666     12  ER-0919                 PIC X(4)    VALUE '0919'.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page  14
* EL131.cbl
   667     12  ER-0921                 PIC X(4)    VALUE '0921'.
   668     12  ER-0938                 PIC X(4)    VALUE '0938'.
   669     12  ER-0946                 PIC X(4)    VALUE '0946'.
   670     12  ER-0947                 PIC X(4)    VALUE '0947'.
   671     12  ER-0948                 PIC X(4)    VALUE '0948'.
   672     12  ER-0949                 PIC X(4)    VALUE '0949'.
   673     12  ER-0950                 PIC X(4)    VALUE '0950'.
   674     12  ER-0951                 PIC X(4)    VALUE '0951'.
   675     12  ER-0954                 PIC X(4)    VALUE '0954'.
   676     12  ER-0974                 PIC X(4)    VALUE '0974'.
   677     12  ER-0975                 PIC X(4)    VALUE '0975'.
   678     12  ER-0992                 PIC X(4)    VALUE '0992'.
   679     12  er-1581                 pic x(4)    value '1581'.
   680     12  ER-1651                 PIC X(4)    VALUE '1651'.
   681     12  ER-1652                 PIC X(4)    VALUE '1652'.
   682     12  ER-1653                 PIC X(4)    VALUE '1653'.
   683     12  ER-1654                 PIC X(4)    VALUE '1654'.
   684     12  ER-1655                 PIC X(4)    VALUE '1655'.
   685     12  er-1656                 pic x(4)    value '1656'.
   686     12  ER-1661                 PIC X(4)    VALUE '1661'.
   687     12  ER-1662                 PIC X(4)    VALUE '1662'.
   688     12  ER-1663                 PIC X(4)    VALUE '1663'.
   689     12  er-1664                 pic x(4)    value '1664'.
   690     12  er-1665                 pic x(4)    value '1665'.
   691     12  er-1666                 pic x(4)    value '1666'.
   692     12  er-1668                 pic x(4)    value '1668'.
   693     12  er-1669                 pic x(4)    value '1669'.
   694     12  er-1675                 pic x(4)    value '1675'.
   695     12  er-1676                 pic x(4)    value '1676'.
   696     12  ER-1678                 PIC X(4)    VALUE '1678'.
   697     12  ER-1679                 PIC X(4)    VALUE '1679'.
   698     12  ER-1772                 PIC X(4)    VALUE '1772'.
   699     12  ER-1773                 PIC X(4)    VALUE '1773'.
   700     12  ER-1778                 PIC X(4)    VALUE '1778'.
   701     12  ER-2280                 PIC X(4)    VALUE '2280'.
   702     12  ER-2878                 PIC X(4)    VALUE '2878'.
   703     12  ER-7572                 PIC X(4)    VALUE '7572'.
   704     12  ER-7641                 PIC X(4)    VALUE '7641'.
   705     12  ER-7642                 PIC X(4)    VALUE '7642'.
   706     12  ER-7650                 PIC X(4)    VALUE '7650'.
   707     12  ER-7651                 PIC X(4)    VALUE '7651'.
   708     12  ER-7687                 PIC X(4)    VALUE '7687'.
   709     12  ER-7689                 PIC X(4)    VALUE '7689'.
   710     12  ER-7690                 PIC X(4)    VALUE '7690'.
   711     12  ER-7691                 PIC X(4)    VALUE '7691'.
   712     12  ER-8003                 PIC X(4)    VALUE '8003'.
   713     12  ER-8051                 PIC X(4)    VALUE '8051'.
   714     12  ER-8052                 PIC X(4)    VALUE '8052'.
   715     12  ER-8053                 PIC X(4)    VALUE '8053'.
   716     12  ER-8054                 PIC X(4)    VALUE '8054'.
   717     12  ER-8055                 PIC X(4)    VALUE '8055'.
   718     12  ER-8056                 PIC X(4)    VALUE '8056'.
   719     12  ER-8057                 PIC X(4)    VALUE '8057'.
   720     12  ER-8058                 PIC X(4)    VALUE '8058'.
   721     12  ER-8059                 PIC X(4)    VALUE '8059'.
   722     12  ER-8060                 PIC X(4)    VALUE '8060'.
   723     12  ER-8061                 PIC X(4)    VALUE '8061'.
   724     12  ER-8062                 PIC X(4)    VALUE '8062'.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page  15
* EL131.cbl
   725     12  ER-8063                 PIC X(4)    VALUE '8063'.
   726     12  ER-8064                 PIC X(4)    VALUE '8064'.
   727     12  ER-8065                 PIC X(4)    VALUE '8065'.
   728     12  ER-8066                 PIC X(4)    VALUE '8066'.
   729     12  ER-8152                 PIC X(4)    VALUE '8152'.
   730     12  ER-8153                 PIC X(4)    VALUE '8153'.
   731     12  ER-8154                 PIC X(4)    VALUE '8154'.
   732     12  ER-8155                 PIC X(4)    VALUE '8155'.
   733 01  ERPDEF-KEY-SAVE             PIC X(18).
   734 01  ERPDEF-KEY.
   735     12  ERPDEF-COMPANY-CD       PIC X.
   736     12  ERPDEF-STATE            PIC XX.
   737     12  ERPDEF-PROD-CD          PIC XXX.
   738     12  F                       PIC X(7).
   739     12  ERPDEF-BEN-TYPE         PIC X.
   740     12  ERPDEF-BEN-CODE         PIC XX.
   741     12  ERPDEF-EXP-DT           PIC XX.
   742 01  MSTR-KEY.
   743     12  COMPANY-CODE            PIC X.
   744     12  CARRIER-CODE            PIC X.
   745     12  CLAIM-NO                PIC X(7).
   746     12  CERT-NO.
   747         16  CERT-NO-PRIME       PIC X(10).
   748         16  CERT-NO-SUFX        PIC X.
   749
   750 01  WS-SAVE-CLAIM-KEY.
   751     12  WS-SAVE-COMPANY-CD      PIC X.
   752     12  WS-SAVE-CARRIER         PIC X.
   753     12  WS-SAVE-CLAIM-NO        PIC X(7).
   754     12  WS-SAVE-CERT-NO.
   755         16  WS-CERT-NO-PRIME    PIC X(10).
   756         16  WS-CERT-NO-SUFX     PIC X.
   757
   758 01  CERT-KEY.
   759     12  CERT-COMPANY-CODE       PIC X.
   760     12  CERT-CARRIER            PIC X.
   761     12  CERT-GROUP              PIC X(6).
   762     12  CERT-STATE              PIC XX.
   763     12  CERT-ACCOUNT            PIC X(10).
   764     12  CERT-DATE               PIC XX.
   765     12  CERT-CERT.
   766         16  CERT-CERT-PRIME     PIC X(10).
   767         16  CERT-CERT-SUFX      PIC X.
   768
   769 01  ELCRTT-KEY.
   770     05  CTRLR-COMP-CD       PIC X.
   771     05  CTRLR-CARRIER       PIC X.
   772     05  CTRLR-GROUPING      PIC X(6).
   773     05  CTRLR-STATE         PIC X(2).
   774     05  CTRLR-ACCOUNT       PIC X(10).
   775     05  CTRLR-EFF-DT        PIC XX.
   776     05  CTRLR-CERT-NO       PIC X(11).
   777     05  CTRLR-REC-TYPE      PIC X.
   778 01  NOTE-KEY.
   779     12  NOTE-COMP-CD            PIC X.
   780     12  NOTE-CERT-KEY.
   781         16  NOTE-CARRIER        PIC X.
   782         16  NOTE-GROUP          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page  16
* EL131.cbl
   783         16  NOTE-STATE          PIC XX.
   784         16  NOTE-ACCOUNT        PIC X(10).
   785         16  NOTE-DATE           PIC XX.
   786         16  NOTE-CERT-NO        PIC X(11).
   787
   788 01  TRLR-KEY.
   789     12  TRLR-MAIN-KEY.
   790         16  TRLR-COMPANY-CD     PIC X.
   791         16  TRLR-CARRIER        PIC X.
   792         16  TRLR-CLAIM-NO       PIC X(07).
   793         16  TRLR-CERT-NO        PIC X(11).
   794     12  TRLR-SEQ-NO             PIC S9(4)   COMP.
   795
   796 01  BENEFIT-KEY.
   797     12  BEN-CO-ID               PIC X(3).
   798     12  BEN-REC-TYPE            PIC X.
   799     12  FILLER                  PIC XX.
   800     12  BEN-ACC-CD              PIC XX.
   801     12  BEN-SEQ-NO              PIC S9(4)   COMP.
   802
   803 01  CNTL-KEY.
   804     12  CNTL-CO-ID              PIC X(3).
   805     12  CNTL-REC-TYPE           PIC X.
   806     12  CNTL-PROC-ID            PIC X(4).
   807     12  CNTL-STATE-ACCESS REDEFINES CNTL-PROC-ID.
   808         16  CNTL-STATE-NUMBER   PIC XX.
   809         16  FILLER              PIC XX.
   810     12  CNTL-CARRIER-ACCESS REDEFINES CNTL-PROC-ID.
   811         16  FILLER              PIC X(3).
   812         16  CNTL-CARRIER        PIC X.
   813     12  CNTL-SEQ-NO             PIC S9(4)   COMP.
   814
   815 01  ACTQ-KEY                    PIC X(20).
   816
   817 01  WS-LAST-TRLR-KEY            PIC X(22)  VALUE SPACES.
   818
   819 01  CHKQ-KEY.
   820     12  CHKQ-COMPANY-CODE       PIC X.
   821     12  CHKQ-CONTROL-NO         PIC S9(8)  COMP.
   822     12  CHKQ-SEQ-NO             PIC S9(4)  COMP.
   823
   824 01  ARCH-KEY.
   825     12  ARCH-COMPANY-CODE       PIC X.
   826     12  ARCH-ARCHIVE-NO         PIC S9(8)  COMP.
   827     12  ARCH-RECORD-TYPE        PIC X.
   828     12  ARCH-SEQ-NO             PIC S9(4)  COMP.
   829
   830 01  ACCT-KEY.
   831     05  ACCT-PARTIAL-KEY.
   832         12  ACCT-COMPANY-CODE   PIC X.
   833         12  ACCT-CARRIER        PIC X.
   834         12  ACCT-GROUP          PIC X(6).
   835         12  ACCT-STATE          PIC XX.
   836         12  ACCT-ACCOUNT        PIC X(10).
   837     05  ACCT-DATE               PIC XX.
   838
   839 01  WS-ELBENE-KEY.
   840     12  WS-ELBENE-COMPANY-CD    PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page  17
* EL131.cbl
   841     12  WS-ELBENE-RECORD-TYPE   PIC X.
   842     12  WS-ELBENE-ID            PIC X(10).
   843
   844 01  ELALPH-KEY.
   845     12  ELALPH-COMPANY-CD       PIC X.
   846     12  ELALPH-SOURCE           PIC X.
   847     12  ELALPH-NAME.
   848         16  ELALPH-LAST-NAME    PIC X(15).
   849         16  ELALPH-FIRST-NAME.
   850             20  ELALPH-FIRST-INIT   PIC X.
   851             20  FILLER              PIC X(11).
   852         16  ELALPH-MIDDLE-INIT  PIC X.
   853     12  ELALPH-DATE             PIC X(08).
   854     12  ELALPH-TIME             PIC S9(04)    COMP.
   855
   856 01  COMP-LENGTHS.
   857     12  CNTL-GENERIC-LENGTH     PIC S9(4)   COMP VALUE +8.
   858     12  JOURNAL-LENGTH          PIC S9(4)   COMP VALUE +0.
   859     12  DATE-LENGTH             PIC S9(4)   COMP VALUE +8.
   860     12  MO-YR-LENGTH            PIC S9(4)   COMP VALUE +5.
   861     12  TERM-LENGTH             PIC S9(4)   COMP VALUE +3.
   862     12  BEN-LENGTH              PIC S9(4)   COMP VALUE +11.
   863     12  FREQ-LENGTH             PIC S9(4)   COMP VALUE +2.
   864     12  MSTR-LENGTH             PIC S9(4)   COMP VALUE +350.
   865     12  CERT-LENGTH             PIC S9(4)   COMP VALUE +450.
   866     12  TRLR-LENGTH             PIC S9(4)   COMP VALUE +200.
   867     12  ACTQ-LENGTH             PIC S9(4)   COMP VALUE +60.
   868     12  CHKQ-LENGTH             PIC S9(4)   COMP VALUE +100.
   869     12  ARCH-LENGTH             PIC S9(4)   COMP VALUE +90.
   870     12  ALPH-LENGTH             PIC S9(4)   COMP VALUE +128.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page  18
* EL131.cbl
   872*                                COPY ELCLNKLT.
   873******************************************************************
   874*                                                                *
   875*                                                                *
   876*                           ELCLNKLT                             *
   877*                            VMOD=2.003                          *
   878*                                                                *
   879*   THIS COPY BOOK IS USED TO PASS DATA TO THE LETTER GENERATOR  *
   880*   PROGRAM (EL1523). THE AREA SHOULD BE INITIALIZED TO LOW-     *
   881*   VALUES BEFORE ENTERING YOUR INFORMATION.                     *
   882*                                                                *
   883*   MOVE THE PROGRAM-INTERFACE-BLOCK TO W-1523-LINK-DATA BEFORE  *
   884*   COMPLETING THE REQUIRED FIELDS.                              *
   885*                                                                *
   886*   THE CALLING PROGRAM SHOULD CHECK:                            *
   887*   1. W-1523-ERROR-CODE WHERE 0000 INDICATES NO ERROR DETECTED. *
   888*                              9999 INDICATES AN UNKNOWN ABEND   *
   889*                                   WAS DETECTED.                *
   890*                              ALL OTHER VALUES ARE NORMAL ERROR *
   891*                              CODES FOUND IN THE ERROR FILE.    *
   892******************************************************************
   893 01  W-1523-LINKDATA.
   894     12  W-1523-COMMON-PI-DATA.
   895         16  W-1523-COMM-LENGTH  PIC S9(04) COMP   VALUE +1024.
   896         16  FILLER              PIC  X(67).
   897         16  W-1523-COMPANY-CD   PIC  X(01).
   898         16  FILLER              PIC  X(10).
   899         16  W-1523-CONTROL-IN-PROGRESS.
   900             20  W-1523-CARRIER  PIC  X(01).
   901             20  W-1523-GROUPING PIC  X(06).
   902             20  W-1523-STATE    PIC  X(02).
   903             20  W-1523-ACCOUNT  PIC  X(10).
   904             20  W-1523-CLAIM-CERT-GRP.
   905                 24  W-1523-CLAIM-NO
   906                                 PIC  X(07).
   907                 24  W-1523-CERT-NO.
   908                     28  W-1523-CERT-PRIME
   909                                 PIC  X(10).
   910                     28  W-1523-CERT-SFX
   911                                 PIC  X(01).
   912                 24  W-1523-CERT-EFF-DT
   913                                 PIC  X(02).
   914         16  FILLER              PIC X(265).
   915
   916     12  W-1523-WORK-AREA.
   917         16  W-1523-FORM-NUMBER  PIC  X(04).
   918         16  W-1523-NUMBER-COPIES
   919                                 PIC  9(01).
   920         16  W-1523-ADDR-TYPE    PIC  X(02).
   921         16  W-1523-FOLLOW-UP-DATE
   922                                 PIC  X(02).
   923         16  W-1523-RESEND-DATE  PIC  X(02).
   924         16  W-1523-ERROR-CODE   PIC  9(04).
   925             88  W-1523-NO-ERRORS-DETECTED VALUE 0000.
   926             88  W-1523-FATAL-ERROR
   927                                    VALUES  0006 0013 0042
   928                                            0154 0168 0169
   929                                            0176 9999 0172
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page  19
* EL131.cbl
   930                                            0179 0186 0281
   931                                            0332 2055 3697
   932                                            3698 3699 3770
   933                                            3771 3772 7675
   934                                            9106 9808 9883
   935                                            9887.
   936             88  W-1523-STOP-ERRORS
   937                                    VALUES  0013 0042 0154
   938                                            0168 0169 0172
   939                                            0281 0332 2055
   940                                            3698 3699 7675
   941                                            9106 9808 9883
   942                                            9999.
   943         16  W-1523-REASON       PIC  X(70).
   944         16  W-1523-ARCHIVE-NUMBER
   945                                 PIC  9(08).
   946     12  W-1523-POINTER-AREA.
   947         16  W-1523-ACCT-POINTER PIC S9(08) COMP.
   948         16  W-1523-ACTY-POINTER PIC S9(08) COMP.
   949         16  W-1523-ARCH-POINTER PIC S9(08) COMP.
   950         16  W-1523-VAR-POINTER  PIC S9(08) COMP.
   951         16  W-1523-PROD-POINTER PIC S9(08) COMP.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page  20
* EL131.cbl
   953*                                COPY ELCINTF.
   954******************************************************************
   955*                                                                *
   956*                                                                *
   957*                            ELCINTF.                            *
   958*                            VMOD=2.017                          *
   959*                                                                *
   960*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   961*                                                                *
   962*       LENGTH = 1024                                            *
   963*                                                                *
   964******************************************************************
   965*                   C H A N G E   L O G
   966*
   967* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   968*-----------------------------------------------------------------
   969*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   970* EFFECTIVE    NUMBER
   971*-----------------------------------------------------------------
   972* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   973******************************************************************
   974 01  PROGRAM-INTERFACE-BLOCK.
   975     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   976     12  PI-CALLING-PROGRAM              PIC X(8).
   977     12  PI-SAVED-PROGRAM-1              PIC X(8).
   978     12  PI-SAVED-PROGRAM-2              PIC X(8).
   979     12  PI-SAVED-PROGRAM-3              PIC X(8).
   980     12  PI-SAVED-PROGRAM-4              PIC X(8).
   981     12  PI-SAVED-PROGRAM-5              PIC X(8).
   982     12  PI-SAVED-PROGRAM-6              PIC X(8).
   983     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   984     12  PI-COMPANY-ID                   PIC XXX.
   985     12  PI-COMPANY-CD                   PIC X.
   986
   987     12  PI-COMPANY-PASSWORD             PIC X(8).
   988
   989     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   990
   991     12  PI-CONTROL-IN-PROGRESS.
   992         16  PI-CARRIER                  PIC X.
   993         16  PI-GROUPING                 PIC X(6).
   994         16  PI-STATE                    PIC XX.
   995         16  PI-ACCOUNT                  PIC X(10).
   996         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   997                                         PIC X(10).
   998         16  PI-CLAIM-CERT-GRP.
   999             20  PI-CLAIM-NO             PIC X(7).
  1000             20  PI-CERT-NO.
  1001                 25  PI-CERT-PRIME       PIC X(10).
  1002                 25  PI-CERT-SFX         PIC X.
  1003             20  PI-CERT-EFF-DT          PIC XX.
  1004         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  1005             20  PI-PLAN-CODE            PIC X(2).
  1006             20  PI-REVISION-NUMBER      PIC X(3).
  1007             20  PI-PLAN-EFF-DT          PIC X(2).
  1008             20  PI-PLAN-EXP-DT          PIC X(2).
  1009             20  FILLER                  PIC X(11).
  1010         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page  21
* EL131.cbl
  1011             20  PI-OE-REFERENCE-1.
  1012                 25  PI-OE-REF-1-PRIME   PIC X(18).
  1013                 25  PI-OE-REF-1-SUFF    PIC XX.
  1014
  1015     12  PI-SESSION-IN-PROGRESS          PIC X.
  1016         88  CLAIM-SESSION                   VALUE '1'.
  1017         88  CREDIT-SESSION                  VALUE '2'.
  1018         88  WARRANTY-SESSION                VALUE '3'.
  1019         88  MORTGAGE-SESSION                VALUE '4'.
  1020         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  1021
  1022
  1023*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  1024
  1025     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  1026     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  1027
  1028     12  PI-CREDIT-USER                  PIC X.
  1029         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  1030         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  1031
  1032     12  PI-CLAIM-USER                   PIC X.
  1033         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  1034         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  1035
  1036     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  1037         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  1038         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  1039         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  1040         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  1041         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  1042
  1043     12  PI-PROCESSOR-ID                 PIC X(4).
  1044
  1045     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  1046
  1047     12  PI-MEMBER-CAPTION               PIC X(10).
  1048
  1049     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1050         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  1051
  1052     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1053     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1054     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1055     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1056
  1057     12  PI-AH-OVERRIDE-L1               PIC X.
  1058     12  PI-AH-OVERRIDE-L2               PIC XX.
  1059     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1060     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1061
  1062     12  PI-NEW-SYSTEM                   PIC X(2).
  1063
  1064     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1065     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1066         88  PI-USES-PAID-TO                 VALUE '1'.
  1067     12  PI-CRDTCRD-SYSTEM.
  1068         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page  22
* EL131.cbl
  1069             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1070             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1071         16  PI-CC-MONTH-END-DT          PIC XX.
  1072     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1073
  1074     12  PI-OE-REFERENCE-2.
  1075         16  PI-OE-REF-2-PRIME           PIC X(10).
  1076         16  PI-OE-REF-2-SUFF            PIC X.
  1077
  1078     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1079
  1080     12  PI-LANGUAGE-TYPE                PIC X.
  1081             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1082             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1083             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1084
  1085     12  PI-POLICY-LINKAGE-IND           PIC X.
  1086         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1087         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1088                                                   LOW-VALUES.
  1089
  1090     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1091     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1092         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1093         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1094
  1095     12  PI-PROCESSOR-CSR-IND            PIC X.
  1096         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1097         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  1098
  1099     12  FILLER                          PIC X(3).
  1100
  1101     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1102
  1103     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1104         PI-SYSTEM-LEVEL.
  1105
  1106         16  PI-ENTRY-CODES.
  1107             20  PI-ENTRY-CD-1           PIC X.
  1108             20  PI-ENTRY-CD-2           PIC X.
  1109
  1110         16  PI-RETURN-CODES.
  1111             20  PI-RETURN-CD-1          PIC X.
  1112             20  PI-RETURN-CD-2          PIC X.
  1113
  1114         16  PI-UPDATE-STATUS-SAVE.
  1115             20  PI-UPDATE-BY            PIC X(4).
  1116             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1117
  1118         16  PI-LOWER-CASE-LETTERS       PIC X.
  1119             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1120
  1121*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1122*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1123*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1124
  1125         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1126             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page  23
* EL131.cbl
  1127             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1128             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1129             88  ACCNT-CNTL                  VALUE '3'.
  1130             88  CARR-ACCNT-CNTL             VALUE '4'.
  1131
  1132         16  PI-PROCESSOR-CAP-LIST.
  1133             20  PI-SYSTEM-CONTROLS.
  1134                24 PI-SYSTEM-DISPLAY     PIC X.
  1135                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1136                24 PI-SYSTEM-MODIFY      PIC X.
  1137                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1138             20  FILLER                  PIC XX.
  1139             20  PI-DISPLAY-CAP          PIC X.
  1140                 88  DISPLAY-CAP             VALUE 'Y'.
  1141             20  PI-MODIFY-CAP           PIC X.
  1142                 88  MODIFY-CAP              VALUE 'Y'.
  1143             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1144                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1145             20  PI-FORCE-CAP            PIC X.
  1146                 88  FORCE-CAP               VALUE 'Y'.
  1147
  1148         16  PI-PROGRAM-CONTROLS.
  1149             20  PI-PGM-PRINT-OPT        PIC X.
  1150             20  PI-PGM-FORMAT-OPT       PIC X.
  1151             20  PI-PGM-PROCESS-OPT      PIC X.
  1152             20  PI-PGM-TOTALS-OPT       PIC X.
  1153
  1154         16  PI-HELP-INTERFACE.
  1155             20  PI-LAST-ERROR-NO        PIC X(4).
  1156             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1157
  1158         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1159             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1160
  1161         16  PI-CR-CONTROL-IN-PROGRESS.
  1162             20  PI-CR-CARRIER           PIC X.
  1163             20  PI-CR-GROUPING          PIC X(6).
  1164             20  PI-CR-STATE             PIC XX.
  1165             20  PI-CR-ACCOUNT           PIC X(10).
  1166             20  PI-CR-FIN-RESP          PIC X(10).
  1167             20  PI-CR-TYPE              PIC X.
  1168
  1169         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1170
  1171         16  PI-CR-MONTH-END-DT          PIC XX.
  1172
  1173         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1174             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1175             88  PI-ZERO-CARRIER             VALUE '1'.
  1176             88  PI-ZERO-GROUPING            VALUE '2'.
  1177             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1178
  1179         16  PI-CARRIER-SECURITY         PIC X.
  1180             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1181
  1182         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1183             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1184             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page  24
* EL131.cbl
  1185
  1186         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1187             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1188                                         INDEXED BY PI-ACCESS-NDX
  1189                                         PIC X.
  1190
  1191         16  PI-GA-BILLING-CONTROL       PIC X.
  1192             88  PI-GA-BILLING               VALUE '1'.
  1193
  1194         16  PI-MAIL-PROCESSING          PIC X.
  1195             88  PI-MAIL-YES                 VALUE 'Y'.
  1196
  1197         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1198
  1199         16  PI-AR-SYSTEM.
  1200             20  PI-AR-PROCESSING-CNTL   PIC X.
  1201                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1202             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1203             20  PI-AR-MONTH-END-DT      PIC XX.
  1204
  1205         16  PI-MP-SYSTEM.
  1206             20  PI-MORTGAGE-USER            PIC X.
  1207                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1208                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1209             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1210                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1211                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1212                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1213                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1214                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1215             20  PI-MP-MONTH-END-DT          PIC XX.
  1216             20  PI-MP-REFERENCE-NO.
  1217                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1218                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1219
  1220         16  PI-LABEL-CONTROL            PIC X(01).
  1221             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1222             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1223
  1224         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1225             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1226
  1227         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1228             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1229             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1230
  1231         16  FILLER                      PIC X(14).
  1232
  1233     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1234******************************************************************
  1235     12  EL131-WORK-AREA REDEFINES PI-PROGRAM-WORK-AREA.
  1236         16  PI-NO-PMTS                    PIC 9(4).
  1237         16  PI-CERT-SWITCH                PIC X.
  1238             88  CREATED-CERT              VALUE '2'.
  1239         16  PI-PREM-TYPE                  PIC X.
  1240         16  PI-SAVE-CERT-NO.
  1241             20  PI-SAVE-CERT-NO-PRIME     PIC X(10).
  1242             20  PI-SAVE-CERT-NO-SUFX      PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page  25
* EL131.cbl
  1243         16  FILLER                        PIC X(46).
  1244         16  PI-CLAIM-DELETED-SWITCH       PIC X(1).
  1245         16  PI-PAYMENT-AMT                PIC S9(7)V99   COMP-3.
  1246         16  PI-REC-FOUND-SW               PIC X.
  1247         16  PI-LETTER-SW                  PIC X.
  1248         16  PI-PREV-TRLR-KEY              PIC X(22).
  1249         16  pi-claim-type                 pic x.
  1250         16  PI-AUTO-PAY-SEQ               PIC S9(4)      COMP.
  1251         16  pi-approval-level             pic x.
  1252         16  FILLER                        PIC X(543).
  1253
  1254 01  SAVE-RECORD                 PIC X(450).
  1255
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page  26
* EL131.cbl
  1257*                                COPY ELCLOGOF SUPPRESS.
  1258******************************************************************
  1259*                                                                *
  1260*                                                                *
  1261*                            ELCLOGOF.                           *
  1262*                            VMOD=2.001                          *
  1263*                                                                *
  1264*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  1265*                                                                *
  1266******************************************************************
  1267 01  CLASIC-LOGOFF.
  1268     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  1269     12  LOGOFF-TEXT.
  1270         16  FILLER          PIC X(5)    VALUE SPACES.
  1271         16  LOGOFF-MSG.
  1272             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  1273             20  FILLER      PIC X       VALUE SPACES.
  1274             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  1275         16  FILLER          PIC X(80)
  1276           VALUE '* YOU ARE NOW LOGGED OFF'.
  1277         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  1278         16  FILLER          PIC X       VALUE QUOTE.
  1279         16  LOGOFF-SYS-MSG  PIC X(17)
  1280           VALUE 'S CLAS-IC SYSTEM '.
  1281     12  TEXT-MESSAGES.
  1282         16  UNACCESS-MSG    PIC X(29)
  1283             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  1284         16  PGMIDERR-MSG    PIC X(17)
  1285             VALUE 'PROGRAM NOT FOUND'.
  1286
  1287*                                COPY ELCATTR SUPPRESS.
  1288******************************************************************
  1289*                                                                *
  1290*                            ELCATTR.                            *
  1291*                            VMOD=2.001                          *
  1292*                                                                *
  1293*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  1294*                                                                *
  1295*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  1296*                                                                *
  1297*                   POS 1   P=PROTECTED                          *
  1298*                           U=UNPROTECTED                        *
  1299*                           S=ASKIP                              *
  1300*                   POS 2   A=ALPHA/NUMERIC                      *
  1301*                           N=NUMERIC                            *
  1302*                   POS 3   N=NORMAL                             *
  1303*                           B=BRIGHT                             *
  1304*                           D=DARK                               *
  1305*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  1306*                           OF=MODIFIED DATA TAG OFF             *
  1307*                                                                *
  1308*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  1309******************************************************************
  1310 01  ATTRIBUTE-LIST.
  1311     12  AL-PABOF            PIC X       VALUE 'Y'.
  1312     12  AL-PABON            PIC X       VALUE 'Z'.
  1313     12  AL-PADOF            PIC X       VALUE '%'.
  1314     12  AL-PADON            PIC X       VALUE '_'.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page  27
* EL131.cbl
  1315     12  AL-PANOF            PIC X       VALUE '-'.
  1316     12  AL-PANON            PIC X       VALUE '/'.
  1317     12  AL-SABOF            PIC X       VALUE '8'.
  1318     12  AL-SABON            PIC X       VALUE '9'.
  1319     12  AL-SADOF            PIC X       VALUE '@'.
  1320     12  AL-SADON            PIC X       VALUE QUOTE.
  1321     12  AL-SANOF            PIC X       VALUE '0'.
  1322     12  AL-SANON            PIC X       VALUE '1'.
  1323     12  AL-UABOF            PIC X       VALUE 'H'.
  1324     12  AL-UABON            PIC X       VALUE 'I'.
  1325     12  AL-UADOF            PIC X       VALUE '<'.
  1326     12  AL-UADON            PIC X       VALUE '('.
  1327     12  AL-UANOF            PIC X       VALUE ' '.
  1328     12  AL-UANON            PIC X       VALUE 'A'.
  1329     12  AL-UNBOF            PIC X       VALUE 'Q'.
  1330     12  AL-UNBON            PIC X       VALUE 'R'.
  1331     12  AL-UNDOF            PIC X       VALUE '*'.
  1332     12  AL-UNDON            PIC X       VALUE ')'.
  1333     12  AL-UNNOF            PIC X       VALUE '&'.
  1334     12  AL-UNNON            PIC X       VALUE 'J'.
  1335
  1336*                                COPY ELCAID SUPPRESS.
  1337******************************************************************
  1338*                                                                *
  1339*                            ELCAID.                             *
  1340*                            VMOD=2.001                          *
  1341*                                                                *
  1342*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1343*                                                                *
  1344*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1345*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1346******************************************************************
  1347
  1348 01  DFHAID.
  1349   02  DFHNULL   PIC  X  VALUE  ' '.
  1350   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1351   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1352   02  DFHPEN    PIC  X  VALUE  '='.
  1353   02  DFHOPID   PIC  X  VALUE  'W'.
  1354   02  DFHPA1    PIC  X  VALUE  '%'.
  1355   02  DFHPA2    PIC  X  VALUE  '>'.
  1356   02  DFHPA3    PIC  X  VALUE  ','.
  1357   02  DFHPF1    PIC  X  VALUE  '1'.
  1358   02  DFHPF2    PIC  X  VALUE  '2'.
  1359   02  DFHPF3    PIC  X  VALUE  '3'.
  1360   02  DFHPF4    PIC  X  VALUE  '4'.
  1361   02  DFHPF5    PIC  X  VALUE  '5'.
  1362   02  DFHPF6    PIC  X  VALUE  '6'.
  1363   02  DFHPF7    PIC  X  VALUE  '7'.
  1364   02  DFHPF8    PIC  X  VALUE  '8'.
  1365   02  DFHPF9    PIC  X  VALUE  '9'.
  1366   02  DFHPF10   PIC  X  VALUE  ':'.
  1367   02  DFHPF11   PIC  X  VALUE  '#'.
  1368   02  DFHPF12   PIC  X  VALUE  '@'.
  1369   02  DFHPF13   PIC  X  VALUE  'A'.
  1370   02  DFHPF14   PIC  X  VALUE  'B'.
  1371   02  DFHPF15   PIC  X  VALUE  'C'.
  1372   02  DFHPF16   PIC  X  VALUE  'D'.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page  28
* EL131.cbl
  1373   02  DFHPF17   PIC  X  VALUE  'E'.
  1374   02  DFHPF18   PIC  X  VALUE  'F'.
  1375   02  DFHPF19   PIC  X  VALUE  'G'.
  1376   02  DFHPF20   PIC  X  VALUE  'H'.
  1377   02  DFHPF21   PIC  X  VALUE  'I'.
  1378*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1379   02  DFHPF22   PIC  X  VALUE  '['.
  1380   02  DFHPF23   PIC  X  VALUE  '.'.
  1381   02  DFHPF24   PIC  X  VALUE  '<'.
  1382   02  DFHMSRE   PIC  X  VALUE  'X'.
  1383   02  DFHSTRF   PIC  X  VALUE  'h'.
  1384   02  DFHTRIG   PIC  X  VALUE  '"'.
  1385 01  FILLER REDEFINES DFHAID.
  1386     12  FILLER                  PIC X(8).
  1387     12  AID-KEYS OCCURS 24 TIMES.
  1388         16  FILLER              PIC X.
  1389
  1390*                                COPY EL131S.
  1391 01  EL131AI.
  1392     05  FILLER            PIC  X(0012).
  1393*    -------------------------------
  1394     05  DATEL PIC S9(0004) COMP.
  1395     05  DATEF PIC  X(0001).
  1396     05  FILLER REDEFINES DATEF.
  1397         10  DATEA PIC  X(0001).
  1398     05  DATEI PIC  X(0008).
  1399*    -------------------------------
  1400     05  TIMEL PIC S9(0004) COMP.
  1401     05  TIMEF PIC  X(0001).
  1402     05  FILLER REDEFINES TIMEF.
  1403         10  TIMEA PIC  X(0001).
  1404     05  TIMEI PIC  X(0005).
  1405*    -------------------------------
  1406     05  SEQUL PIC S9(0004) COMP.
  1407     05  SEQUF PIC  X(0001).
  1408     05  FILLER REDEFINES SEQUF.
  1409         10  SEQUA PIC  X(0001).
  1410     05  SEQUI PIC  X(0010).
  1411*    -------------------------------
  1412     05  COMPL PIC S9(0004) COMP.
  1413     05  COMPF PIC  X(0001).
  1414     05  FILLER REDEFINES COMPF.
  1415         10  COMPA PIC  X(0001).
  1416     05  COMPI PIC  X(0003).
  1417*    -------------------------------
  1418     05  USERIDL PIC S9(0004) COMP.
  1419     05  USERIDF PIC  X(0001).
  1420     05  FILLER REDEFINES USERIDF.
  1421         10  USERIDA PIC  X(0001).
  1422     05  USERIDI PIC  X(0004).
  1423*    -------------------------------
  1424     05  LABEL1L PIC S9(0004) COMP.
  1425     05  LABEL1F PIC  X(0001).
  1426     05  FILLER REDEFINES LABEL1F.
  1427         10  LABEL1A PIC  X(0001).
  1428     05  LABEL1I PIC  X(0011).
  1429*    -------------------------------
  1430     05  PCERTNOL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page  29
* EL131.cbl
  1431     05  PCERTNOF PIC  X(0001).
  1432     05  FILLER REDEFINES PCERTNOF.
  1433         10  PCERTNOA PIC  X(0001).
  1434     05  PCERTNOI PIC  X(0010).
  1435*    -------------------------------
  1436     05  PSUFXL PIC S9(0004) COMP.
  1437     05  PSUFXF PIC  X(0001).
  1438     05  FILLER REDEFINES PSUFXF.
  1439         10  PSUFXA PIC  X(0001).
  1440     05  PSUFXI PIC  X(0001).
  1441*    -------------------------------
  1442     05  CCNOL PIC S9(0004) COMP.
  1443     05  CCNOF PIC  X(0001).
  1444     05  FILLER REDEFINES CCNOF.
  1445         10  CCNOA PIC  X(0001).
  1446     05  CCNOI PIC  X(0016).
  1447*    -------------------------------
  1448     05  MAINTL PIC S9(0004) COMP.
  1449     05  MAINTF PIC  X(0001).
  1450     05  FILLER REDEFINES MAINTF.
  1451         10  MAINTA PIC  X(0001).
  1452     05  MAINTI PIC  X(0001).
  1453*    -------------------------------
  1454     05  CLAIML PIC S9(0004) COMP.
  1455     05  CLAIMF PIC  X(0001).
  1456     05  FILLER REDEFINES CLAIMF.
  1457         10  CLAIMA PIC  X(0001).
  1458     05  CLAIMI PIC  X(0007).
  1459*    -------------------------------
  1460     05  CARRL PIC S9(0004) COMP.
  1461     05  CARRF PIC  X(0001).
  1462     05  FILLER REDEFINES CARRF.
  1463         10  CARRA PIC  X(0001).
  1464     05  CARRI PIC  X(0001).
  1465*    -------------------------------
  1466     05  CERTL PIC S9(0004) COMP.
  1467     05  CERTF PIC  X(0001).
  1468     05  FILLER REDEFINES CERTF.
  1469         10  CERTA PIC  X(0001).
  1470     05  CERTI PIC  X(0010).
  1471*    -------------------------------
  1472     05  SUFXL PIC S9(0004) COMP.
  1473     05  SUFXF PIC  X(0001).
  1474     05  FILLER REDEFINES SUFXF.
  1475         10  SUFXA PIC  X(0001).
  1476     05  SUFXI PIC  X(0001).
  1477*    -------------------------------
  1478     05  TYPEL PIC S9(0004) COMP.
  1479     05  TYPEF PIC  X(0001).
  1480     05  FILLER REDEFINES TYPEF.
  1481         10  TYPEA PIC  X(0001).
  1482     05  TYPEI PIC  X(0001).
  1483*    -------------------------------
  1484     05  BENPERL PIC S9(0004) COMP.
  1485     05  BENPERF PIC  X(0001).
  1486     05  FILLER REDEFINES BENPERF.
  1487         10  BENPERA PIC  X(0001).
  1488     05  BENPERI PIC  99.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page  30
* EL131.cbl
  1489*    -------------------------------
  1490     05  INSTYPEL PIC S9(0004) COMP.
  1491     05  INSTYPEF PIC  X(0001).
  1492     05  FILLER REDEFINES INSTYPEF.
  1493         10  INSTYPEA PIC  X(0001).
  1494     05  INSTYPEI PIC  X(0001).
  1495*    -------------------------------
  1496     05  STATUSL PIC S9(0004) COMP.
  1497     05  STATUSF PIC  X(0001).
  1498     05  FILLER REDEFINES STATUSF.
  1499         10  STATUSA PIC  X(0001).
  1500     05  STATUSI PIC  X(0006).
  1501*    -------------------------------
  1502     05  INCL PIC S9(0004) COMP.
  1503     05  INCF PIC  X(0001).
  1504     05  FILLER REDEFINES INCF.
  1505         10  INCA PIC  X(0001).
  1506     05  INCI PIC  X(0008).
  1507*    -------------------------------
  1508     05  REPL PIC S9(0004) COMP.
  1509     05  REPF PIC  X(0001).
  1510     05  FILLER REDEFINES REPF.
  1511         10  REPA PIC  X(0001).
  1512     05  REPI PIC  X(0008).
  1513*    -------------------------------
  1514     05  ICD1L PIC S9(0004) COMP.
  1515     05  ICD1F PIC  X(0001).
  1516     05  FILLER REDEFINES ICD1F.
  1517         10  ICD1A PIC  X(0001).
  1518     05  ICD1I PIC  X(0008).
  1519*    -------------------------------
  1520     05  ICD2L PIC S9(0004) COMP.
  1521     05  ICD2F PIC  X(0001).
  1522     05  FILLER REDEFINES ICD2F.
  1523         10  ICD2A PIC  X(0001).
  1524     05  ICD2I PIC  X(0008).
  1525*    -------------------------------
  1526     05  DIAGL PIC S9(0004) COMP.
  1527     05  DIAGF PIC  X(0001).
  1528     05  FILLER REDEFINES DIAGF.
  1529         10  DIAGA PIC  X(0001).
  1530     05  DIAGI PIC  X(0060).
  1531*    -------------------------------
  1532     05  ACCSWL PIC S9(0004) COMP.
  1533     05  ACCSWF PIC  X(0001).
  1534     05  FILLER REDEFINES ACCSWF.
  1535         10  ACCSWA PIC  X(0001).
  1536     05  ACCSWI PIC  X(0001).
  1537*    -------------------------------
  1538     05  BENEL PIC S9(0004) COMP.
  1539     05  BENEF PIC  X(0001).
  1540     05  FILLER REDEFINES BENEF.
  1541         10  BENEA PIC  X(0001).
  1542     05  BENEI PIC  X(0010).
  1543*    -------------------------------
  1544     05  BIRTHL PIC S9(0004) COMP.
  1545     05  BIRTHF PIC  X(0001).
  1546     05  FILLER REDEFINES BIRTHF.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page  31
* EL131.cbl
  1547         10  BIRTHA PIC  X(0001).
  1548     05  BIRTHI PIC  X(0008).
  1549*    -------------------------------
  1550     05  SOCIALL PIC S9(0004) COMP.
  1551     05  SOCIALF PIC  X(0001).
  1552     05  FILLER REDEFINES SOCIALF.
  1553         10  SOCIALA PIC  X(0001).
  1554     05  SOCIALI PIC  X(0011).
  1555*    -------------------------------
  1556     05  SEXL PIC S9(0004) COMP.
  1557     05  SEXF PIC  X(0001).
  1558     05  FILLER REDEFINES SEXF.
  1559         10  SEXA PIC  X(0001).
  1560     05  SEXI PIC  X(0001).
  1561*    -------------------------------
  1562     05  MLNAMEL PIC S9(0004) COMP.
  1563     05  MLNAMEF PIC  X(0001).
  1564     05  FILLER REDEFINES MLNAMEF.
  1565         10  MLNAMEA PIC  X(0001).
  1566     05  MLNAMEI PIC  X(0015).
  1567*    -------------------------------
  1568     05  MFNAMEL PIC S9(0004) COMP.
  1569     05  MFNAMEF PIC  X(0001).
  1570     05  FILLER REDEFINES MFNAMEF.
  1571         10  MFNAMEA PIC  X(0001).
  1572     05  MFNAMEI PIC  X(0012).
  1573*    -------------------------------
  1574     05  MMINITL PIC S9(0004) COMP.
  1575     05  MMINITF PIC  X(0001).
  1576     05  FILLER REDEFINES MMINITF.
  1577         10  MMINITA PIC  X(0001).
  1578     05  MMINITI PIC  X(0001).
  1579*    -------------------------------
  1580     05  AUTHRCVL PIC S9(0004) COMP.
  1581     05  AUTHRCVF PIC  X(0001).
  1582     05  FILLER REDEFINES AUTHRCVF.
  1583         10  AUTHRCVA PIC  X(0001).
  1584     05  AUTHRCVI PIC  X(0001).
  1585*    -------------------------------
  1586     05  CRTLNMEL PIC S9(0004) COMP.
  1587     05  CRTLNMEF PIC  X(0001).
  1588     05  FILLER REDEFINES CRTLNMEF.
  1589         10  CRTLNMEA PIC  X(0001).
  1590     05  CRTLNMEI PIC  X(0015).
  1591*    -------------------------------
  1592     05  CRTFNMEL PIC S9(0004) COMP.
  1593     05  CRTFNMEF PIC  X(0001).
  1594     05  FILLER REDEFINES CRTFNMEF.
  1595         10  CRTFNMEA PIC  X(0001).
  1596     05  CRTFNMEI PIC  X(0012).
  1597*    -------------------------------
  1598     05  CRTINITL PIC S9(0004) COMP.
  1599     05  CRTINITF PIC  X(0001).
  1600     05  FILLER REDEFINES CRTINITF.
  1601         10  CRTINITA PIC  X(0001).
  1602     05  CRTINITI PIC  X(0001).
  1603*    -------------------------------
  1604     05  LOANBALL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page  32
* EL131.cbl
  1605     05  LOANBALF PIC  X(0001).
  1606     05  FILLER REDEFINES LOANBALF.
  1607         10  LOANBALA PIC  X(0001).
  1608     05  LOANBALI PIC  9(7)V99.
  1609*    -------------------------------
  1610     05  PROCL PIC S9(0004) COMP.
  1611     05  PROCF PIC  X(0001).
  1612     05  FILLER REDEFINES PROCF.
  1613         10  PROCA PIC  X(0001).
  1614     05  PROCI PIC  X(0004).
  1615*    -------------------------------
  1616     05  SUPVL PIC S9(0004) COMP.
  1617     05  SUPVF PIC  X(0001).
  1618     05  FILLER REDEFINES SUPVF.
  1619         10  SUPVA PIC  X(0001).
  1620     05  SUPVI PIC  X(0001).
  1621*    -------------------------------
  1622     05  PRICDL PIC S9(0004) COMP.
  1623     05  PRICDF PIC  X(0001).
  1624     05  FILLER REDEFINES PRICDF.
  1625         10  PRICDA PIC  X(0001).
  1626     05  PRICDI PIC  X(0001).
  1627*    -------------------------------
  1628     05  CRITPL PIC S9(0004) COMP.
  1629     05  CRITPF PIC  X(0001).
  1630     05  FILLER REDEFINES CRITPF.
  1631         10  CRITPA PIC  X(0001).
  1632     05  CRITPI PIC  X(0002).
  1633*    -------------------------------
  1634     05  EXTENSL PIC S9(0004) COMP.
  1635     05  EXTENSF PIC  X(0001).
  1636     05  FILLER REDEFINES EXTENSF.
  1637         10  EXTENSA PIC  X(0001).
  1638     05  EXTENSI PIC  99.
  1639*    -------------------------------
  1640     05  FILETOL PIC S9(0004) COMP.
  1641     05  FILETOF PIC  X(0001).
  1642     05  FILLER REDEFINES FILETOF.
  1643         10  FILETOA PIC  X(0001).
  1644     05  FILETOI PIC  X(0004).
  1645*    -------------------------------
  1646     05  PTHRHDGL PIC S9(0004) COMP.
  1647     05  PTHRHDGF PIC  X(0001).
  1648     05  FILLER REDEFINES PTHRHDGF.
  1649         10  PTHRHDGA PIC  X(0001).
  1650     05  PTHRHDGI PIC  X(0010).
  1651*    -------------------------------
  1652     05  PDTHRUL PIC S9(0004) COMP.
  1653     05  PDTHRUF PIC  X(0001).
  1654     05  FILLER REDEFINES PDTHRUF.
  1655         10  PDTHRUA PIC  X(0001).
  1656     05  PDTHRUI PIC  X(0008).
  1657*    -------------------------------
  1658     05  PDAMTL PIC S9(0004) COMP.
  1659     05  PDAMTF PIC  X(0001).
  1660     05  FILLER REDEFINES PDAMTF.
  1661         10  PDAMTA PIC  X(0001).
  1662     05  PDAMTI PIC  9(7)V99.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page  33
* EL131.cbl
  1663*    -------------------------------
  1664     05  NODAYSL PIC S9(0004) COMP.
  1665     05  NODAYSF PIC  X(0001).
  1666     05  FILLER REDEFINES NODAYSF.
  1667         10  NODAYSA PIC  X(0001).
  1668     05  NODAYSI PIC  9(5).
  1669*    -------------------------------
  1670     05  NOPMTSL PIC S9(0004) COMP.
  1671     05  NOPMTSF PIC  X(0001).
  1672     05  FILLER REDEFINES NOPMTSF.
  1673         10  NOPMTSA PIC  X(0001).
  1674     05  NOPMTSI PIC  9(4).
  1675*    -------------------------------
  1676     05  FORMTYPL PIC S9(0004) COMP.
  1677     05  FORMTYPF PIC  X(0001).
  1678     05  FILLER REDEFINES FORMTYPF.
  1679         10  FORMTYPA PIC  X(0001).
  1680     05  FORMTYPI PIC  X(0001).
  1681*    -------------------------------
  1682     05  ESTL PIC S9(0004) COMP.
  1683     05  ESTF PIC  X(0001).
  1684     05  FILLER REDEFINES ESTF.
  1685         10  ESTA PIC  X(0001).
  1686     05  ESTI PIC  X(0008).
  1687*    -------------------------------
  1688     05  AUIDL PIC S9(0004) COMP.
  1689     05  AUIDF PIC  X(0001).
  1690     05  FILLER REDEFINES AUIDF.
  1691         10  AUIDA PIC  X(0001).
  1692     05  AUIDI PIC  X(0004).
  1693*    -------------------------------
  1694     05  OCCL PIC S9(0004) COMP.
  1695     05  OCCF PIC  X(0001).
  1696     05  FILLER REDEFINES OCCF.
  1697         10  OCCA PIC  X(0001).
  1698     05  OCCI PIC  X(0006).
  1699*    -------------------------------
  1700     05  MNTDTL PIC S9(0004) COMP.
  1701     05  MNTDTF PIC  X(0001).
  1702     05  FILLER REDEFINES MNTDTF.
  1703         10  MNTDTA PIC  X(0001).
  1704     05  MNTDTI PIC  X(0008).
  1705*    -------------------------------
  1706     05  MNTTYPEL PIC S9(0004) COMP.
  1707     05  MNTTYPEF PIC  X(0001).
  1708     05  FILLER REDEFINES MNTTYPEF.
  1709         10  MNTTYPEA PIC  X(0001).
  1710     05  MNTTYPEI PIC  X(0006).
  1711*    -------------------------------
  1712     05  CERTCARL PIC S9(0004) COMP.
  1713     05  CERTCARF PIC  X(0001).
  1714     05  FILLER REDEFINES CERTCARF.
  1715         10  CERTCARA PIC  X(0001).
  1716     05  CERTCARI PIC  X(0001).
  1717*    -------------------------------
  1718     05  CERTGRPL PIC S9(0004) COMP.
  1719     05  CERTGRPF PIC  X(0001).
  1720     05  FILLER REDEFINES CERTGRPF.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page  34
* EL131.cbl
  1721         10  CERTGRPA PIC  X(0001).
  1722     05  CERTGRPI PIC  X(0006).
  1723*    -------------------------------
  1724     05  CERTSTL PIC S9(0004) COMP.
  1725     05  CERTSTF PIC  X(0001).
  1726     05  FILLER REDEFINES CERTSTF.
  1727         10  CERTSTA PIC  X(0001).
  1728     05  CERTSTI PIC  X(0002).
  1729*    -------------------------------
  1730     05  CERTACTL PIC S9(0004) COMP.
  1731     05  CERTACTF PIC  X(0001).
  1732     05  FILLER REDEFINES CERTACTF.
  1733         10  CERTACTA PIC  X(0001).
  1734     05  CERTACTI PIC  X(0010).
  1735*    -------------------------------
  1736     05  CERTEFFL PIC S9(0004) COMP.
  1737     05  CERTEFFF PIC  X(0001).
  1738     05  FILLER REDEFINES CERTEFFF.
  1739         10  CERTEFFA PIC  X(0001).
  1740     05  CERTEFFI PIC  X(0008).
  1741*    -------------------------------
  1742     05  ISSAGEL PIC S9(0004) COMP.
  1743     05  ISSAGEF PIC  X(0001).
  1744     05  FILLER REDEFINES ISSAGEF.
  1745         10  ISSAGEA PIC  X(0001).
  1746     05  ISSAGEI PIC  X(0002).
  1747*    -------------------------------
  1748     05  APRL PIC S9(0004) COMP.
  1749     05  APRF PIC  X(0001).
  1750     05  FILLER REDEFINES APRF.
  1751         10  APRA PIC  X(0001).
  1752     05  APRI PIC  9(4)V9(4).
  1753*    -------------------------------
  1754     05  PMTFREQL PIC S9(0004) COMP.
  1755     05  PMTFREQF PIC  X(0001).
  1756     05  FILLER REDEFINES PMTFREQF.
  1757         10  PMTFREQA PIC  X(0001).
  1758     05  PMTFREQI PIC  99.
  1759*    -------------------------------
  1760     05  INDGRPL PIC S9(0004) COMP.
  1761     05  INDGRPF PIC  X(0001).
  1762     05  FILLER REDEFINES INDGRPF.
  1763         10  INDGRPA PIC  X(0001).
  1764     05  INDGRPI PIC  X(0001).
  1765*    -------------------------------
  1766     05  PREMTYPL PIC S9(0004) COMP.
  1767     05  PREMTYPF PIC  X(0001).
  1768     05  FILLER REDEFINES PREMTYPF.
  1769         10  PREMTYPA PIC  X(0001).
  1770     05  PREMTYPI PIC  X(0001).
  1771*    -------------------------------
  1772     05  REINCDL PIC S9(0004) COMP.
  1773     05  REINCDF PIC  X(0001).
  1774     05  FILLER REDEFINES REINCDF.
  1775         10  REINCDA PIC  X(0001).
  1776     05  REINCDI PIC  X(0001).
  1777*    -------------------------------
  1778     05  JNTLNMEL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page  35
* EL131.cbl
  1779     05  JNTLNMEF PIC  X(0001).
  1780     05  FILLER REDEFINES JNTLNMEF.
  1781         10  JNTLNMEA PIC  X(0001).
  1782     05  JNTLNMEI PIC  X(0015).
  1783*    -------------------------------
  1784     05  JNTFNMEL PIC S9(0004) COMP.
  1785     05  JNTFNMEF PIC  X(0001).
  1786     05  FILLER REDEFINES JNTFNMEF.
  1787         10  JNTFNMEA PIC  X(0001).
  1788     05  JNTFNMEI PIC  X(0012).
  1789*    -------------------------------
  1790     05  JNTINITL PIC S9(0004) COMP.
  1791     05  JNTINITF PIC  X(0001).
  1792     05  FILLER REDEFINES JNTINITF.
  1793         10  JNTINITA PIC  X(0001).
  1794     05  JNTINITI PIC  X(0001).
  1795*    -------------------------------
  1796     05  JNTAGEL PIC S9(0004) COMP.
  1797     05  JNTAGEF PIC  X(0001).
  1798     05  FILLER REDEFINES JNTAGEF.
  1799         10  JNTAGEA PIC  X(0001).
  1800     05  JNTAGEI PIC  X(0002).
  1801*    -------------------------------
  1802     05  ADDONDTL PIC S9(0004) COMP.
  1803     05  ADDONDTF PIC  X(0001).
  1804     05  FILLER REDEFINES ADDONDTF.
  1805         10  ADDONDTA PIC  X(0001).
  1806     05  ADDONDTI PIC  X(0008).
  1807*    -------------------------------
  1808     05  LCVDSCRL PIC S9(0004) COMP.
  1809     05  LCVDSCRF PIC  X(0001).
  1810     05  FILLER REDEFINES LCVDSCRF.
  1811         10  LCVDSCRA PIC  X(0001).
  1812     05  LCVDSCRI PIC  X(0006).
  1813*    -------------------------------
  1814     05  LCVKINDL PIC S9(0004) COMP.
  1815     05  LCVKINDF PIC  X(0001).
  1816     05  FILLER REDEFINES LCVKINDF.
  1817         10  LCVKINDA PIC  X(0001).
  1818     05  LCVKINDI PIC  X(0003).
  1819*    -------------------------------
  1820     05  LCVCDL PIC S9(0004) COMP.
  1821     05  LCVCDF PIC  X(0001).
  1822     05  FILLER REDEFINES LCVCDF.
  1823         10  LCVCDA PIC  X(0001).
  1824     05  LCVCDI PIC  X(0002).
  1825*    -------------------------------
  1826     05  LCVOTRML PIC S9(0004) COMP.
  1827     05  LCVOTRMF PIC  X(0001).
  1828     05  FILLER REDEFINES LCVOTRMF.
  1829         10  LCVOTRMA PIC  X(0001).
  1830     05  LCVOTRMI PIC  999.
  1831*    -------------------------------
  1832     05  LCVRTRML PIC S9(0004) COMP.
  1833     05  LCVRTRMF PIC  X(0001).
  1834     05  FILLER REDEFINES LCVRTRMF.
  1835         10  LCVRTRMA PIC  X(0001).
  1836     05  LCVRTRMI PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page  36
* EL131.cbl
  1837*    -------------------------------
  1838     05  LCVRATEL PIC S9(0004) COMP.
  1839     05  LCVRATEF PIC  X(0001).
  1840     05  FILLER REDEFINES LCVRATEF.
  1841         10  LCVRATEA PIC  X(0001).
  1842     05  LCVRATEI PIC  9999V99.
  1843*    -------------------------------
  1844     05  LCVBENEL PIC S9(0004) COMP.
  1845     05  LCVBENEF PIC  X(0001).
  1846     05  FILLER REDEFINES LCVBENEF.
  1847         10  LCVBENEA PIC  X(0001).
  1848     05  LCVBENEI PIC  9(9)V99.
  1849*    -------------------------------
  1850     05  LCVFORML PIC S9(0004) COMP.
  1851     05  LCVFORMF PIC  X(0001).
  1852     05  FILLER REDEFINES LCVFORMF.
  1853         10  LCVFORMA PIC  X(0001).
  1854     05  LCVFORMI PIC  X(0012).
  1855*    -------------------------------
  1856     05  LCVCNDTL PIC S9(0004) COMP.
  1857     05  LCVCNDTF PIC  X(0001).
  1858     05  FILLER REDEFINES LCVCNDTF.
  1859         10  LCVCNDTA PIC  X(0001).
  1860     05  LCVCNDTI PIC  X(0008).
  1861*    -------------------------------
  1862     05  LCVEXITL PIC S9(0004) COMP.
  1863     05  LCVEXITF PIC  X(0001).
  1864     05  FILLER REDEFINES LCVEXITF.
  1865         10  LCVEXITA PIC  X(0001).
  1866     05  LCVEXITI PIC  X(0008).
  1867*    -------------------------------
  1868     05  LCVSTATL PIC S9(0004) COMP.
  1869     05  LCVSTATF PIC  X(0001).
  1870     05  FILLER REDEFINES LCVSTATF.
  1871         10  LCVSTATA PIC  X(0001).
  1872     05  LCVSTATI PIC  X(0006).
  1873*    -------------------------------
  1874     05  ACVDSCRL PIC S9(0004) COMP.
  1875     05  ACVDSCRF PIC  X(0001).
  1876     05  FILLER REDEFINES ACVDSCRF.
  1877         10  ACVDSCRA PIC  X(0001).
  1878     05  ACVDSCRI PIC  X(0006).
  1879*    -------------------------------
  1880     05  ACVKINDL PIC S9(0004) COMP.
  1881     05  ACVKINDF PIC  X(0001).
  1882     05  FILLER REDEFINES ACVKINDF.
  1883         10  ACVKINDA PIC  X(0001).
  1884     05  ACVKINDI PIC  X(0003).
  1885*    -------------------------------
  1886     05  ACVCDL PIC S9(0004) COMP.
  1887     05  ACVCDF PIC  X(0001).
  1888     05  FILLER REDEFINES ACVCDF.
  1889         10  ACVCDA PIC  X(0001).
  1890     05  ACVCDI PIC  X(0002).
  1891*    -------------------------------
  1892     05  ACVOTRML PIC S9(0004) COMP.
  1893     05  ACVOTRMF PIC  X(0001).
  1894     05  FILLER REDEFINES ACVOTRMF.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page  37
* EL131.cbl
  1895         10  ACVOTRMA PIC  X(0001).
  1896     05  ACVOTRMI PIC  999.
  1897*    -------------------------------
  1898     05  ACVRTRML PIC S9(0004) COMP.
  1899     05  ACVRTRMF PIC  X(0001).
  1900     05  FILLER REDEFINES ACVRTRMF.
  1901         10  ACVRTRMA PIC  X(0001).
  1902     05  ACVRTRMI PIC  X(0003).
  1903*    -------------------------------
  1904     05  ACVRATEL PIC S9(0004) COMP.
  1905     05  ACVRATEF PIC  X(0001).
  1906     05  FILLER REDEFINES ACVRATEF.
  1907         10  ACVRATEA PIC  X(0001).
  1908     05  ACVRATEI PIC  9999V99.
  1909*    -------------------------------
  1910     05  ACVBENEL PIC S9(0004) COMP.
  1911     05  ACVBENEF PIC  X(0001).
  1912     05  FILLER REDEFINES ACVBENEF.
  1913         10  ACVBENEA PIC  X(0001).
  1914     05  ACVBENEI PIC  9(9)V99.
  1915*    -------------------------------
  1916     05  ACVFORML PIC S9(0004) COMP.
  1917     05  ACVFORMF PIC  X(0001).
  1918     05  FILLER REDEFINES ACVFORMF.
  1919         10  ACVFORMA PIC  X(0001).
  1920     05  ACVFORMI PIC  X(0012).
  1921*    -------------------------------
  1922     05  ACVCNDTL PIC S9(0004) COMP.
  1923     05  ACVCNDTF PIC  X(0001).
  1924     05  FILLER REDEFINES ACVCNDTF.
  1925         10  ACVCNDTA PIC  X(0001).
  1926     05  ACVCNDTI PIC  X(0008).
  1927*    -------------------------------
  1928     05  ACVEXITL PIC S9(0004) COMP.
  1929     05  ACVEXITF PIC  X(0001).
  1930     05  FILLER REDEFINES ACVEXITF.
  1931         10  ACVEXITA PIC  X(0001).
  1932     05  ACVEXITI PIC  X(0008).
  1933*    -------------------------------
  1934     05  ACVSTATL PIC S9(0004) COMP.
  1935     05  ACVSTATF PIC  X(0001).
  1936     05  FILLER REDEFINES ACVSTATF.
  1937         10  ACVSTATA PIC  X(0001).
  1938     05  ACVSTATI PIC  X(0006).
  1939*    -------------------------------
  1940     05  LABEL2L PIC S9(0004) COMP.
  1941     05  LABEL2F PIC  X(0001).
  1942     05  FILLER REDEFINES LABEL2F.
  1943         10  LABEL2A PIC  X(0001).
  1944     05  LABEL2I PIC  X(0014).
  1945*    -------------------------------
  1946     05  BCERT1L PIC S9(0004) COMP.
  1947     05  BCERT1F PIC  X(0001).
  1948     05  FILLER REDEFINES BCERT1F.
  1949         10  BCERT1A PIC  X(0001).
  1950     05  BCERT1I PIC  X(0010).
  1951*    -------------------------------
  1952     05  BSUFX1L PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page  38
* EL131.cbl
  1953     05  BSUFX1F PIC  X(0001).
  1954     05  FILLER REDEFINES BSUFX1F.
  1955         10  BSUFX1A PIC  X(0001).
  1956     05  BSUFX1I PIC  X(0001).
  1957*    -------------------------------
  1958     05  BCERT2L PIC S9(0004) COMP.
  1959     05  BCERT2F PIC  X(0001).
  1960     05  FILLER REDEFINES BCERT2F.
  1961         10  BCERT2A PIC  X(0001).
  1962     05  BCERT2I PIC  X(0010).
  1963*    -------------------------------
  1964     05  BSUFX2L PIC S9(0004) COMP.
  1965     05  BSUFX2F PIC  X(0001).
  1966     05  FILLER REDEFINES BSUFX2F.
  1967         10  BSUFX2A PIC  X(0001).
  1968     05  BSUFX2I PIC  X(0001).
  1969*    -------------------------------
  1970     05  BCERT3L PIC S9(0004) COMP.
  1971     05  BCERT3F PIC  X(0001).
  1972     05  FILLER REDEFINES BCERT3F.
  1973         10  BCERT3A PIC  X(0001).
  1974     05  BCERT3I PIC  X(0010).
  1975*    -------------------------------
  1976     05  BSUFX3L PIC S9(0004) COMP.
  1977     05  BSUFX3F PIC  X(0001).
  1978     05  FILLER REDEFINES BSUFX3F.
  1979         10  BSUFX3A PIC  X(0001).
  1980     05  BSUFX3I PIC  X(0001).
  1981*    -------------------------------
  1982     05  BCERT4L PIC S9(0004) COMP.
  1983     05  BCERT4F PIC  X(0001).
  1984     05  FILLER REDEFINES BCERT4F.
  1985         10  BCERT4A PIC  X(0001).
  1986     05  BCERT4I PIC  X(0010).
  1987*    -------------------------------
  1988     05  BSUFX4L PIC S9(0004) COMP.
  1989     05  BSUFX4F PIC  X(0001).
  1990     05  FILLER REDEFINES BSUFX4F.
  1991         10  BSUFX4A PIC  X(0001).
  1992     05  BSUFX4I PIC  X(0001).
  1993*    -------------------------------
  1994     05  BCERT5L PIC S9(0004) COMP.
  1995     05  BCERT5F PIC  X(0001).
  1996     05  FILLER REDEFINES BCERT5F.
  1997         10  BCERT5A PIC  X(0001).
  1998     05  BCERT5I PIC  X(0010).
  1999*    -------------------------------
  2000     05  BSUFX5L PIC S9(0004) COMP.
  2001     05  BSUFX5F PIC  X(0001).
  2002     05  FILLER REDEFINES BSUFX5F.
  2003         10  BSUFX5A PIC  X(0001).
  2004     05  BSUFX5I PIC  X(0001).
  2005*    -------------------------------
  2006     05  MSG1L PIC S9(0004) COMP.
  2007     05  MSG1F PIC  X(0001).
  2008     05  FILLER REDEFINES MSG1F.
  2009         10  MSG1A PIC  X(0001).
  2010     05  MSG1I PIC  X(0072).
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page  39
* EL131.cbl
  2011*    -------------------------------
  2012     05  MSG2L PIC S9(0004) COMP.
  2013     05  MSG2F PIC  X(0001).
  2014     05  FILLER REDEFINES MSG2F.
  2015         10  MSG2A PIC  X(0001).
  2016     05  MSG2I PIC  X(0072).
  2017*    -------------------------------
  2018     05  PFKEYL PIC S9(0004) COMP.
  2019     05  PFKEYF PIC  X(0001).
  2020     05  FILLER REDEFINES PFKEYF.
  2021         10  PFKEYA PIC  X(0001).
  2022     05  PFKEYI PIC  99.
  2023*    -------------------------------
  2024     05  PFKEY6L PIC S9(0004) COMP.
  2025     05  PFKEY6F PIC  X(0001).
  2026     05  FILLER REDEFINES PFKEY6F.
  2027         10  PFKEY6A PIC  X(0001).
  2028     05  PFKEY6I PIC  X(0016).
  2029 01  EL131AO REDEFINES EL131AI.
  2030     05  FILLER            PIC  X(0012).
  2031*    -------------------------------
  2032     05  FILLER            PIC  X(0003).
  2033     05  DATEO PIC  X(0008).
  2034*    -------------------------------
  2035     05  FILLER            PIC  X(0003).
  2036     05  TIMEO PIC  99.99.
  2037*    -------------------------------
  2038     05  FILLER            PIC  X(0003).
  2039     05  SEQUO PIC  X(0010).
  2040*    -------------------------------
  2041     05  FILLER            PIC  X(0003).
  2042     05  COMPO PIC  X(0003).
  2043*    -------------------------------
  2044     05  FILLER            PIC  X(0003).
  2045     05  USERIDO PIC  X(0004).
  2046*    -------------------------------
  2047     05  FILLER            PIC  X(0003).
  2048     05  LABEL1O PIC  X(0011).
  2049*    -------------------------------
  2050     05  FILLER            PIC  X(0003).
  2051     05  PCERTNOO PIC  X(0010).
  2052*    -------------------------------
  2053     05  FILLER            PIC  X(0003).
  2054     05  PSUFXO PIC  X(0001).
  2055*    -------------------------------
  2056     05  FILLER            PIC  X(0003).
  2057     05  CCNOO PIC  X(0016).
  2058*    -------------------------------
  2059     05  FILLER            PIC  X(0003).
  2060     05  MAINTO PIC  X(0001).
  2061*    -------------------------------
  2062     05  FILLER            PIC  X(0003).
  2063     05  CLAIMO PIC  X(0007).
  2064*    -------------------------------
  2065     05  FILLER            PIC  X(0003).
  2066     05  CARRO PIC  X(0001).
  2067*    -------------------------------
  2068     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page  40
* EL131.cbl
  2069     05  CERTO PIC  X(0010).
  2070*    -------------------------------
  2071     05  FILLER            PIC  X(0003).
  2072     05  SUFXO PIC  X(0001).
  2073*    -------------------------------
  2074     05  FILLER            PIC  X(0003).
  2075     05  TYPEO PIC  X(0001).
  2076*    -------------------------------
  2077     05  FILLER            PIC  X(0003).
  2078     05  BENPERO PIC  X(0002).
  2079*    -------------------------------
  2080     05  FILLER            PIC  X(0003).
  2081     05  INSTYPEO PIC  X(0001).
  2082*    -------------------------------
  2083     05  FILLER            PIC  X(0003).
  2084     05  STATUSO PIC  X(0006).
  2085*    -------------------------------
  2086     05  FILLER            PIC  X(0003).
  2087     05  INCO PIC  X(0008).
  2088*    -------------------------------
  2089     05  FILLER            PIC  X(0003).
  2090     05  REPO PIC  X(0008).
  2091*    -------------------------------
  2092     05  FILLER            PIC  X(0003).
  2093     05  ICD1O PIC  X(0008).
  2094*    -------------------------------
  2095     05  FILLER            PIC  X(0003).
  2096     05  ICD2O PIC  X(0008).
  2097*    -------------------------------
  2098     05  FILLER            PIC  X(0003).
  2099     05  DIAGO PIC  X(0060).
  2100*    -------------------------------
  2101     05  FILLER            PIC  X(0003).
  2102     05  ACCSWO PIC  X(0001).
  2103*    -------------------------------
  2104     05  FILLER            PIC  X(0003).
  2105     05  BENEO PIC  X(0010).
  2106*    -------------------------------
  2107     05  FILLER            PIC  X(0003).
  2108     05  BIRTHO PIC  X(0008).
  2109*    -------------------------------
  2110     05  FILLER            PIC  X(0003).
  2111     05  SOCIALO PIC  X(0011).
  2112*    -------------------------------
  2113     05  FILLER            PIC  X(0003).
  2114     05  SEXO PIC  X(0001).
  2115*    -------------------------------
  2116     05  FILLER            PIC  X(0003).
  2117     05  MLNAMEO PIC  X(0015).
  2118*    -------------------------------
  2119     05  FILLER            PIC  X(0003).
  2120     05  MFNAMEO PIC  X(0012).
  2121*    -------------------------------
  2122     05  FILLER            PIC  X(0003).
  2123     05  MMINITO PIC  X(0001).
  2124*    -------------------------------
  2125     05  FILLER            PIC  X(0003).
  2126     05  AUTHRCVO PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page  41
* EL131.cbl
  2127*    -------------------------------
  2128     05  FILLER            PIC  X(0003).
  2129     05  CRTLNMEO PIC  X(0015).
  2130*    -------------------------------
  2131     05  FILLER            PIC  X(0003).
  2132     05  CRTFNMEO PIC  X(0012).
  2133*    -------------------------------
  2134     05  FILLER            PIC  X(0003).
  2135     05  CRTINITO PIC  X(0001).
  2136*    -------------------------------
  2137     05  FILLER            PIC  X(0003).
  2138     05  LOANBALO PIC  ZZZZZ9.99.
  2139*    -------------------------------
  2140     05  FILLER            PIC  X(0003).
  2141     05  PROCO PIC  X(0004).
  2142*    -------------------------------
  2143     05  FILLER            PIC  X(0003).
  2144     05  SUPVO PIC  X(0001).
  2145*    -------------------------------
  2146     05  FILLER            PIC  X(0003).
  2147     05  PRICDO PIC  X(0001).
  2148*    -------------------------------
  2149     05  FILLER            PIC  X(0003).
  2150     05  CRITPO PIC  X(0002).
  2151*    -------------------------------
  2152     05  FILLER            PIC  X(0003).
  2153     05  EXTENSO PIC  X(0002).
  2154*    -------------------------------
  2155     05  FILLER            PIC  X(0003).
  2156     05  FILETOO PIC  X(0004).
  2157*    -------------------------------
  2158     05  FILLER            PIC  X(0003).
  2159     05  PTHRHDGO PIC  X(0010).
  2160*    -------------------------------
  2161     05  FILLER            PIC  X(0003).
  2162     05  PDTHRUO PIC  X(0008).
  2163*    -------------------------------
  2164     05  FILLER            PIC  X(0003).
  2165     05  PDAMTO PIC  Z(06).99.
  2166*    -------------------------------
  2167     05  FILLER            PIC  X(0003).
  2168     05  NODAYSO PIC  ZZZ99.
  2169*    -------------------------------
  2170     05  FILLER            PIC  X(0003).
  2171     05  NOPMTSO PIC  ZZ99.
  2172*    -------------------------------
  2173     05  FILLER            PIC  X(0003).
  2174     05  FORMTYPO PIC  X(0001).
  2175*    -------------------------------
  2176     05  FILLER            PIC  X(0003).
  2177     05  ESTO PIC  X(0008).
  2178*    -------------------------------
  2179     05  FILLER            PIC  X(0003).
  2180     05  AUIDO PIC  X(0004).
  2181*    -------------------------------
  2182     05  FILLER            PIC  X(0003).
  2183     05  OCCO PIC  X(0006).
  2184*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page  42
* EL131.cbl
  2185     05  FILLER            PIC  X(0003).
  2186     05  MNTDTO PIC  X(0008).
  2187*    -------------------------------
  2188     05  FILLER            PIC  X(0003).
  2189     05  MNTTYPEO PIC  X(0006).
  2190*    -------------------------------
  2191     05  FILLER            PIC  X(0003).
  2192     05  CERTCARO PIC  X(0001).
  2193*    -------------------------------
  2194     05  FILLER            PIC  X(0003).
  2195     05  CERTGRPO PIC  X(0006).
  2196*    -------------------------------
  2197     05  FILLER            PIC  X(0003).
  2198     05  CERTSTO PIC  X(0002).
  2199*    -------------------------------
  2200     05  FILLER            PIC  X(0003).
  2201     05  CERTACTO PIC  X(0010).
  2202*    -------------------------------
  2203     05  FILLER            PIC  X(0003).
  2204     05  CERTEFFO PIC  X(0008).
  2205*    -------------------------------
  2206     05  FILLER            PIC  X(0003).
  2207     05  ISSAGEO PIC  X(0002).
  2208*    -------------------------------
  2209     05  FILLER            PIC  X(0003).
  2210     05  APRO PIC  9(3).9(4).
  2211*    -------------------------------
  2212     05  FILLER            PIC  X(0003).
  2213     05  PMTFREQO PIC  99.
  2214*    -------------------------------
  2215     05  FILLER            PIC  X(0003).
  2216     05  INDGRPO PIC  X(0001).
  2217*    -------------------------------
  2218     05  FILLER            PIC  X(0003).
  2219     05  PREMTYPO PIC  X(0001).
  2220*    -------------------------------
  2221     05  FILLER            PIC  X(0003).
  2222     05  REINCDO PIC  X(0001).
  2223*    -------------------------------
  2224     05  FILLER            PIC  X(0003).
  2225     05  JNTLNMEO PIC  X(0015).
  2226*    -------------------------------
  2227     05  FILLER            PIC  X(0003).
  2228     05  JNTFNMEO PIC  X(0012).
  2229*    -------------------------------
  2230     05  FILLER            PIC  X(0003).
  2231     05  JNTINITO PIC  X(0001).
  2232*    -------------------------------
  2233     05  FILLER            PIC  X(0003).
  2234     05  JNTAGEO PIC  X(0002).
  2235*    -------------------------------
  2236     05  FILLER            PIC  X(0003).
  2237     05  ADDONDTO PIC  X(0008).
  2238*    -------------------------------
  2239     05  FILLER            PIC  X(0003).
  2240     05  LCVDSCRO PIC  X(0006).
  2241*    -------------------------------
  2242     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page  43
* EL131.cbl
  2243     05  LCVKINDO PIC  X(0003).
  2244*    -------------------------------
  2245     05  FILLER            PIC  X(0003).
  2246     05  LCVCDO PIC  X(0002).
  2247*    -------------------------------
  2248     05  FILLER            PIC  X(0003).
  2249     05  LCVOTRMO PIC  999.
  2250*    -------------------------------
  2251     05  FILLER            PIC  X(0003).
  2252     05  LCVRTRMO PIC  999.
  2253*    -------------------------------
  2254     05  FILLER            PIC  X(0003).
  2255     05  LCVRATEO PIC  ZZZ.ZZ.
  2256*    -------------------------------
  2257     05  FILLER            PIC  X(0003).
  2258     05  LCVBENEO PIC  ZZZZZZZZ.ZZ.
  2259*    -------------------------------
  2260     05  FILLER            PIC  X(0003).
  2261     05  LCVFORMO PIC  X(0012).
  2262*    -------------------------------
  2263     05  FILLER            PIC  X(0003).
  2264     05  LCVCNDTO PIC  X(0008).
  2265*    -------------------------------
  2266     05  FILLER            PIC  X(0003).
  2267     05  LCVEXITO PIC  X(0008).
  2268*    -------------------------------
  2269     05  FILLER            PIC  X(0003).
  2270     05  LCVSTATO PIC  X(0006).
  2271*    -------------------------------
  2272     05  FILLER            PIC  X(0003).
  2273     05  ACVDSCRO PIC  X(0006).
  2274*    -------------------------------
  2275     05  FILLER            PIC  X(0003).
  2276     05  ACVKINDO PIC  X(0003).
  2277*    -------------------------------
  2278     05  FILLER            PIC  X(0003).
  2279     05  ACVCDO PIC  X(0002).
  2280*    -------------------------------
  2281     05  FILLER            PIC  X(0003).
  2282     05  ACVOTRMO PIC  999.
  2283*    -------------------------------
  2284     05  FILLER            PIC  X(0003).
  2285     05  ACVRTRMO PIC  999.
  2286*    -------------------------------
  2287     05  FILLER            PIC  X(0003).
  2288     05  ACVRATEO PIC  ZZZ.ZZ.
  2289*    -------------------------------
  2290     05  FILLER            PIC  X(0003).
  2291     05  ACVBENEO PIC  ZZZZZZZZ.ZZ.
  2292*    -------------------------------
  2293     05  FILLER            PIC  X(0003).
  2294     05  ACVFORMO PIC  X(0012).
  2295*    -------------------------------
  2296     05  FILLER            PIC  X(0003).
  2297     05  ACVCNDTO PIC  X(0008).
  2298*    -------------------------------
  2299     05  FILLER            PIC  X(0003).
  2300     05  ACVEXITO PIC  X(0008).
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page  44
* EL131.cbl
  2301*    -------------------------------
  2302     05  FILLER            PIC  X(0003).
  2303     05  ACVSTATO PIC  X(0006).
  2304*    -------------------------------
  2305     05  FILLER            PIC  X(0003).
  2306     05  LABEL2O PIC  X(0014).
  2307*    -------------------------------
  2308     05  FILLER            PIC  X(0003).
  2309     05  BCERT1O PIC  X(0010).
  2310*    -------------------------------
  2311     05  FILLER            PIC  X(0003).
  2312     05  BSUFX1O PIC  X(0001).
  2313*    -------------------------------
  2314     05  FILLER            PIC  X(0003).
  2315     05  BCERT2O PIC  X(0010).
  2316*    -------------------------------
  2317     05  FILLER            PIC  X(0003).
  2318     05  BSUFX2O PIC  X(0001).
  2319*    -------------------------------
  2320     05  FILLER            PIC  X(0003).
  2321     05  BCERT3O PIC  X(0010).
  2322*    -------------------------------
  2323     05  FILLER            PIC  X(0003).
  2324     05  BSUFX3O PIC  X(0001).
  2325*    -------------------------------
  2326     05  FILLER            PIC  X(0003).
  2327     05  BCERT4O PIC  X(0010).
  2328*    -------------------------------
  2329     05  FILLER            PIC  X(0003).
  2330     05  BSUFX4O PIC  X(0001).
  2331*    -------------------------------
  2332     05  FILLER            PIC  X(0003).
  2333     05  BCERT5O PIC  X(0010).
  2334*    -------------------------------
  2335     05  FILLER            PIC  X(0003).
  2336     05  BSUFX5O PIC  X(0001).
  2337*    -------------------------------
  2338     05  FILLER            PIC  X(0003).
  2339     05  MSG1O PIC  X(0072).
  2340*    -------------------------------
  2341     05  FILLER            PIC  X(0003).
  2342     05  MSG2O PIC  X(0072).
  2343*    -------------------------------
  2344     05  FILLER            PIC  X(0003).
  2345     05  PFKEYO PIC  X(0002).
  2346*    -------------------------------
  2347     05  FILLER            PIC  X(0003).
  2348     05  PFKEY6O PIC  X(0016).
  2349*    -------------------------------
  2350
  2351*                                COPY ELCEMIB SUPPRESS.
  2352******************************************************************
  2353*                                                                *
  2354*                                                                *
  2355*                            ELCEMIB.                            *
  2356*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2357*                            VMOD=2.005                          *
  2358*                                                                *
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page  45
* EL131.cbl
  2359*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  2360*                                                                *
  2361******************************************************************
  2362 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  2363     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  2364     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  2365     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  2366     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  2367     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  2368     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  2369     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  2370     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  2371     12  EMI-SWITCH1             PIC X        VALUE '1'.
  2372         88  EMI-NO-ERRORS                    VALUE '1'.
  2373         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  2374         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  2375     12  EMI-SWITCH2             PIC X        VALUE '1'.
  2376         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  2377     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  2378         88  EMI-AREA1-EMPTY                  VALUE '1'.
  2379         88  EMI-AREA1-FULL                   VALUE '2'.
  2380     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  2381         88  EMI-AREA2-EMPTY                  VALUE '1'.
  2382         88  EMI-AREA2-FULL                   VALUE '2'.
  2383     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  2384         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  2385         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  2386         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  2387         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  2388         88  EMI-BYPASS-FATALS                VALUE 'X'.
  2389     12  EMI-ERROR-LINES.
  2390         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  2391         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  2392         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  2393         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  2394             20  EMI-ERR-CODES OCCURS 10 TIMES.
  2395                 24  EMI-ERR-NUM         PIC X(4).
  2396                 24  EMI-FILLER          PIC X.
  2397                 24  EMI-SEV             PIC X.
  2398                 24  FILLER              PIC X.
  2399             20  FILLER                  PIC X(02).
  2400     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  2401         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  2402             20  EMI-ERROR-NUMBER    PIC X(4).
  2403             20  EMI-FILL            PIC X.
  2404             20  EMI-SEVERITY        PIC X.
  2405             20  FILLER              PIC X.
  2406             20  EMI-ERROR-TEXT.
  2407                 24  EMI-TEXT-VARIABLE   PIC X(10).
  2408                 24  FILLER          PIC X(55).
  2409     12  EMI-SEVERITY-SAVE           PIC X.
  2410         88  EMI-NOTE                    VALUE 'N'.
  2411         88  EMI-WARNING                 VALUE 'W'.
  2412         88  EMI-FORCABLE                VALUE 'F'.
  2413         88  EMI-FATAL                   VALUE 'X'.
  2414     12  EMI-MESSAGE-FLAG            PIC X.
  2415         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  2416         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page  46
* EL131.cbl
  2417     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  2418     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  2419         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  2420         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  2421         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  2422     12  emi-claim-no                pic x(7).
  2423     12  emi-claim-type              pic x(6).
  2424     12  FILLER                      PIC X(124)  VALUE SPACES.
  2425     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  2426     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  2427     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  2428     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  2429
  2430*                                COPY ELCJPFX SUPPRESS.
  2431******************************************************************
  2432*                                                                *
  2433*                                                                *
  2434*                            ELCJPFX.                            *
  2435*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2436*                            VMOD=2.002                          *
  2437*                                                                *
  2438*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  2439*                                                                *
  2440*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  2441*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  2442*        ELCNTL - CONTROL FILE                                   *
  2443*        ELMSTR - CLAIM MASTERS                                  *
  2444*        ELTRLR - ACTIVITY TRAILERS                              *
  2445*        ELCHKQ - CHECK QUE                                      *
  2446******************************************************************
  2447 01  JOURNAL-RECORD.
  2448     12  jp-date                     pic s9(5) comp-3.
  2449     12  jp-time                     pic s9(7) comp-3.
  2450     12  JP-USER-ID                  PIC X(4).
  2451     12  JP-FILE-ID                  PIC X(8).
  2452     12  JP-PROGRAM-ID               PIC X(8).
  2453     12  JP-RECORD-TYPE              PIC X.
  2454         88 JP-ADD              VALUE 'A'.
  2455         88 JP-BEFORE-CHANGE    VALUE 'B'.
  2456         88 JP-AFTER-CHANGE     VALUE 'C'.
  2457         88 JP-DELETE           VALUE 'D'.
  2458         88 JP-GENERIC-DELETE   VALUE 'G'.
  2459         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  2460         88 JP-KEY-CHG-ADD      VALUE 'N'.
  2461     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  2462     12  JP-RECORD-AREA
  2463
  2464
  2465                                 PIC X(750).
  2466
  2467*                                COPY ELCCALC.
  2468******************************************************************
  2469*                                                                *
  2470*                           ELCCALC.                            *
  2471*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2472*                            VMOD=2.025                          *
  2473*                                                                *
  2474*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page  47
* EL131.cbl
  2475*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  2476*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  2477*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  2478*                                                                *
  2479*  PASSED TO ELRTRM                                              *
  2480*  -----------------                                             *
  2481*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  2482*  ORIGINAL TERM                                                 *
  2483*  BEGINNING DATE                                                *
  2484*  ENDING DATE                                                   *
  2485*  COMPANY I.D.                                                  *
  2486*  ACCOUNT MASTER USER FIELD                                     *
  2487*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  2488*  FREE LOOK DAYS                                                *
  2489*                                                                *
  2490*  RETURNED FROM ELRTRM                                          *
  2491*  ---------------------                                         *
  2492*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  2493*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  2494*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  2495*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  2496*----------------------------------------------------------------*
  2497*  PASSED TO ELRAMT                                              *
  2498*  ----------------                                              *
  2499*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  2500*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2501*  ORIGINAL AMOUNT                                               *
  2502*  ALTERNATE BENEFIT (BALLON)                                    *
  2503*  A.P.R. - NET PAY ONLY                                         *
  2504*  METHOD
  2505*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  2506*  COMPANY I.D.                                                  *
  2507*  BENEFIT TYPE                                                  *
  2508*                                                                *
  2509*  RETURNED FROM ELRAMT                                          *
  2510*  --------------------                                          *
  2511*  REMAINING AMOUNT 1 - CURRENT                                  *
  2512*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  2513*  REMAINING AMOUNT FACTOR
  2514*----------------------------------------------------------------*
  2515*  PASSED TO ELRESV                                              *
  2516*  -----------------                                             *
  2517*  CERTIFICATE EFFECTIVE DATE                                    *
  2518*  VALUATION DATE                                                *
  2519*  PAID THRU DATE                                                *
  2520*  BENEFIT                                                       *
  2521*  INCURRED DATE                                                 *
  2522*  REPORTED DATE                                                 *
  2523*  ISSUE AGE                                                     *
  2524*  TERM                                                          *
  2525*  CDT PERCENT                                                   *
  2526*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  2527* *CLAIM TYPE (LIFE, A/H)                                        *
  2528* *REMAINING BENEFIT (FROM ELRAMT)                               *
  2529* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  2530*                                                                *
  2531*  RETURNED FROM ELRESV                                          *
  2532*  --------------------                                          *
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page  48
* EL131.cbl
  2533*  CDT TABLE USED                                                *
  2534*  CDT FACTOR USED                                               *
  2535*  PAY TO CURRENT RESERVE                                        *
  2536*  I.B.N.R. - A/H ONLY                                           *
  2537*  FUTURE (ACCRUED) AH ONLY                                      *
  2538*----------------------------------------------------------------*
  2539*  PASSED TO ELRATE                                              *
  2540*  ----------------                                              *
  2541*  CERT ISSUE DATE                                               *
  2542*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2543*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2544*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  2545*  STATE CODE (CLIENT DEFINED)                                   *
  2546*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2547*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2548*  DEVIATION CODE                                                *
  2549*  ISSUE AGE                                                     *
  2550*  ORIGINAL BENEFIT AMOUNT                                       *
  2551*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2552*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  2553*  BENEFIT KIND (LIFE OR A/H)                                    *
  2554*  A.P.R.                                                        *
  2555*  METHOD
  2556*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2557*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2558*  COMPANY I.D. (3 CHARACTER)                                    *
  2559*  BENEFIT CODE                                                  *
  2560*  BENEFIT OVERRIDE CODE                                         *
  2561*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  2562*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  2563*  JOINT INDICATOR (CSL ONLY)                                    *
  2564*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  2565*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  2566*                                                                *
  2567*  RETURNED FROM ELRATE                                          *
  2568*  --------------------                                          *
  2569*  CALCULATED PREMIUM                                            *
  2570*  PREMIUM RATE                                                  *
  2571*  MORTALITY CODE                                                *
  2572*  MAX ATTAINED AGE                                              *
  2573*  MAX AGE                                                       *
  2574*  MAX TERM                                                      *
  2575*  MAX MONTHLY BENEFIT                                           *
  2576*  MAX TOTAL BENIFIT                                             *
  2577*  COMPOSITE RATE (OPEN-END ONLY)                                *
  2578*----------------------------------------------------------------*
  2579*  PASSED TO ELRFND                                              *
  2580*  ----------------                                              *
  2581*  CERT ISSUE DATE                                               *
  2582*  REFUND DATE                                                   *
  2583*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2584*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2585*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2586*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2587*  STATE CODE (CLIENT DEFINED)                                   *
  2588*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2589*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2590*  DEVIATION CODE                                                *
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page  49
* EL131.cbl
  2591*  ISSUE AGE                                                     *
  2592*  ORIGINAL BENEFIT AMOUNT                                       *
  2593*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2594*  PROCESS TYPE (CANCEL)                                         *
  2595*  BENEFIT KIND (LIFE OR A/H)                                    *
  2596*  A.P.R.                                                        *
  2597*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  2598*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  2599*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2600*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2601*  COMPANY I.D. (3 CHARACTER)                                    *
  2602*  BENEFIT CODE                                                  *
  2603*  BENEFIT OVERRIDE CODE                                         *
  2604*                                                                *
  2605*  RETURNED FROM ELRFND                                          *
  2606*  --------------------                                          *
  2607*  CALCULATED REFUND                                             *
  2608*----------------------------------------------------------------*
  2609*  PASSED TO ELEARN                                              *
  2610*  ----------------                                              *
  2611*  CERT ISSUE DATE                                               *
  2612*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2613*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2614*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2615*  STATE CODE (CLIENT DEFINED)                                   *
  2616*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2617*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2618*  DEVIATION CODE                                                *
  2619*  ISSUE AGE                                                     *
  2620*  ORIGINAL BENEFIT AMOUNT                                       *
  2621*  BENEFIT KIND (LIFE OR A/H)                                    *
  2622*  A.P.R.                                                        *
  2623*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  2624*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2625*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2626*  COMPANY I.D. (3 CHARACTER)                                    *
  2627*  BENEFIT CODE                                                  *
  2628*  BENEFIT OVERRIDE CODE                                         *
  2629*                                                                *
  2630*  RETURNED FROM ELEARN                                          *
  2631*  --------------------                                          *
  2632*  INDICATED  EARNINGS                                           *
  2633*----------------------------------------------------------------*
  2634*                 LENGTH = 450                                   *
  2635*                                                                *
  2636******************************************************************
  2637******************************************************************
  2638*                   C H A N G E   L O G
  2639*
  2640* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2641*-----------------------------------------------------------------
  2642*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2643* EFFECTIVE    NUMBER
  2644*-----------------------------------------------------------------
  2645* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  2646* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2647* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  2648* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page  50
* EL131.cbl
  2649* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  2650* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  2651* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  2652* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  2653* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2654* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
  2655* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  2656******************************************************************
  2657
  2658 01  CALCULATION-PASS-AREA.
  2659     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  2660                                     COMP.
  2661
  2662     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  2663       88  NO-CP-ERROR                             VALUE ZERO.
  2664       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  2665                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  2666       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  2667       88  CP-ERROR-IN-DATES                       VALUE '2'.
  2668       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  2669       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  2670       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  2671       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  2672       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  2673       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  2674       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  2675       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  2676       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  2677       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  2678       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  2679       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  2680       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  2681       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  2682       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  2683
  2684     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  2685       88  NO-CP-ERROR-2                           VALUE ZERO.
  2686***********************  INPUT AREAS ****************************
  2687
  2688     12  CP-CALCULATION-AREA.
  2689         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  2690         16  CP-CERT-EFF-DT        PIC XX.
  2691         16  CP-VALUATION-DT       PIC XX.
  2692         16  CP-PAID-THRU-DT       PIC XX.
  2693         16  CP-BENEFIT-TYPE       PIC X.
  2694           88  CP-AH                               VALUE 'A' 'D'
  2695                                                   'I' 'U'.
  2696           88  CP-REDUCING-LIFE                    VALUE 'R'.
  2697           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  2698         16  CP-INCURRED-DT        PIC XX.
  2699         16  CP-REPORTED-DT        PIC XX.
  2700         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  2701         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  2702         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  2703                                     COMP-3.
  2704         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  2705                                     COMP-3.
  2706         16  CP-CDT-METHOD         PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page  51
* EL131.cbl
  2707           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  2708           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  2709           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  2710         16  CP-CLAIM-TYPE         PIC X.
  2711           88  CP-AH-CLAIM                         VALUE 'A'.
  2712           88  CP-LIFE-CLAIM                       VALUE 'L'.
  2713         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  2714                                     COMP-3.
  2715         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  2716                                     COMP-3.
  2717         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  2718                                     COMP-3.
  2719         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  2720                                     COMP-3.
  2721         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2722                                     COMP-3.
  2723         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  2724                                     COMP-3.
  2725         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  2726                                     COMP-3.
  2727         16  CP-REM-TERM-METHOD    PIC X.
  2728           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  2729           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  2730           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  2731           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  2732           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  2733           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  2734           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  2735         16  CP-EARNING-METHOD     PIC X.
  2736           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  2737           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  2738           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  2739           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  2740           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  2741           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  2742           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  2743           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  2744           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  2745           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  2746           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  2747           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  2748           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  2749           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  2750         16  CP-PROCESS-TYPE       PIC X.
  2751           88  CP-CLAIM                            VALUE '1'.
  2752           88  CP-CANCEL                           VALUE '2'.
  2753           88  CP-ISSUE                            VALUE '3'.
  2754         16  CP-SPECIAL-CALC-CD    PIC X.
  2755           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  2756           88  CP-1-MTH-INTEREST               VALUE ' '.
  2757           88  CP-0-MTH-INTEREST               VALUE 'A'.
  2758           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  2759           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  2760           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  2761           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  2762           88  CP-FARM-PLAN                    VALUE 'F'.
  2763           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  2764           88  CP-2-MTH-INTEREST               VALUE 'I'.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page  52
* EL131.cbl
  2765           88  CP-3-MTH-INTEREST               VALUE 'J'.
  2766           88  CP-4-MTH-INTEREST               VALUE 'K'.
  2767           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  2768           88  CP-MORTGAGE-REC                 VALUE 'M'.
  2769           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  2770           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  2771           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  2772           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  2773                                                     'W' 'X'.
  2774           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  2775           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  2776           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  2777           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  2778           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  2779           88  CP-SUMMARY-REC                  VALUE 'Z'.
  2780           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  2781           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  2782           88  CP-AD-D-BENEFIT                 VALUE '4'.
  2783           88  CP-CSL-METH-1                   VALUE '5'.
  2784           88  CP-CSL-METH-2                   VALUE '6'.
  2785           88  CP-CSL-METH-3                   VALUE '7'.
  2786           88  CP-CSL-METH-4                   VALUE '8'.
  2787
  2788         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  2789                                     COMP-3.
  2790         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  2791         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  2792         16  CP-STATE              PIC XX          VALUE SPACE.
  2793         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  2794         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  2795           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  2796               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  2797         16  CP-R78-OPTION         PIC X.
  2798           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  2799           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  2800
  2801         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  2802         16  CP-IBNR-RESERVE-SW    PIC X.
  2803         16  CP-CLAIM-STATUS       PIC X.
  2804         16  CP-RATE-FILE          PIC X.
  2805         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  2806                                     COMP-3.
  2807
  2808         16  CP-LIFE-OVERRIDE-CODE PIC X.
  2809         16  CP-AH-OVERRIDE-CODE   PIC X.
  2810
  2811         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  2812                                     COMP-3.
  2813         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  2814                                   PIC S9(5)V99 COMP-3.
  2815         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  2816                                     COMP-3.
  2817         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2818                                     COMP-3.
  2819         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  2820                                     COMP-3.
  2821         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  2822                                  PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page  53
* EL131.cbl
  2823
  2824         16  CP-PAID-FROM-DATE     PIC X(02).
  2825         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  2826         16  CP-EXT-DAYS-CALC      PIC X.
  2827           88  CP-EXT-NO-CHG                   VALUE ' '.
  2828           88  CP-EXT-CHG-LF                   VALUE '1'.
  2829           88  CP-EXT-CHG-AH                   VALUE '2'.
  2830           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  2831         16  CP-DOMICILE-STATE     PIC XX.
  2832         16  CP-CARRIER            PIC X.
  2833         16  CP-REIN-FLAG          PIC X.
  2834         16  CP-REM-TRM-CALC-OPTION PIC X.
  2835           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  2836                      '2' '3' '4' '5'.
  2837           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  2838           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  2839           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  2840           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  2841           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  2842           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  2843           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  2844           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  2845         16  CP-SIG-SWITCH         PIC X.
  2846         16  CP-RATING-METHOD      PIC X.
  2847           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  2848           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  2849           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  2850           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  2851           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  2852           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  2853           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  2854           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  2855           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  2856         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  2857                                     COMP-3.
  2858         16  CP-BEN-CATEGORY       PIC X.
  2859         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2860         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  2861                                   PIC S99V9(5) COMP-3.
  2862         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2863         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  2864                                   PIC S99V9(5) COMP-3.
  2865         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  2866         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  2867         16  CP-EXPIRE-DT          PIC XX.
  2868         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  2869         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  2870         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  2871         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  2872         16  CP-DDF-SPEC-CALC      PIC X.
  2873             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  2874             88  CP-CALC-CLP              VALUE 'C'.
  2875         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  2876         16  CP-CANCEL-REASON      PIC X.
  2877         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  2878         16  CP-PMT-MODE           PIC X.
  2879         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  2880         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page  54
* EL131.cbl
  2881         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  2882         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  2883         16  FILLER                PIC X.
  2884
  2885***************    OUTPUT FROM ELRESV   ************************
  2886
  2887         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  2888
  2889         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  2890                                     COMP-3.
  2891         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  2892                                     COMP-3.
  2893         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  2894                                     COMP-3.
  2895         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  2896                                     COMP-3.
  2897         16  FILLER                PIC X(09).
  2898***************    OUTPUT FROM ELRTRM   *************************
  2899
  2900         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  2901                                     COMP-3.
  2902         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  2903                                     COMP-3.
  2904         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  2905                                     COMP-3.
  2906         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  2907                                     COMP-3.
  2908         16  FILLER                PIC X(12).
  2909
  2910***************    OUTPUT FROM ELRAMT   *************************
  2911
  2912         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  2913                                     COMP-3.
  2914         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  2915                                     COMP-3.
  2916         16  FILLER                PIC X(12).
  2917
  2918***************    OUTPUT FROM ELRATE   *************************
  2919
  2920         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  2921                                     COMP-3.
  2922         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  2923                                     COMP-3.
  2924         16  CP-MORTALITY-CODE     PIC X(4).
  2925         16  CP-RATE-EDIT-FLAG     PIC X.
  2926             88  CP-RATES-NEED-APR                  VALUE '1'.
  2927         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  2928                                     COMP-3.
  2929         16  CP-CANCEL-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  2930         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  2931         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  2932                                   PIC S9(7)V99 COMP-3.
  2933         16  FILLER                PIC X(07).
  2934
  2935***************    OUTPUT FROM ELRFND   *************************
  2936
  2937         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  2938                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page  55
* EL131.cbl
  2939         16  CP-REFUND-TYPE-USED   PIC X.
  2940           88  CP-R-AS-R78                         VALUE '1'.
  2941           88  CP-R-AS-PRORATA                     VALUE '2'.
  2942           88  CP-R-AS-CALIF                       VALUE '3'.
  2943           88  CP-R-AS-TEXAS                       VALUE '4'.
  2944           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  2945           88  CP-R-AS-NET-PAY                     VALUE '5'.
  2946           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  2947           88  CP-R-AS-MEAN                        VALUE '8'.
  2948           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  2949           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  2950           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  2951           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  2952           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  2953           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  2954         16  FILLER                PIC X(12).
  2955
  2956***************    OUTPUT FROM ELEARN   *************************
  2957
  2958         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  2959                                     COMP-3.
  2960         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  2961                                     COMP-3.
  2962         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  2963                                     COMP-3.
  2964         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  2965                                     COMP-3.
  2966         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  2967                                     COMP-3.
  2968         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  2969                                     COMP-3.
  2970         16  CP-EARNING-TYPE-USED  PIC X.
  2971           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  2972           88  CP-E-AS-R78                         VALUE '1'.
  2973           88  CP-E-AS-PRORATA                     VALUE '2'.
  2974           88  CP-E-AS-TEXAS                       VALUE '4'.
  2975           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  2976           88  CP-E-AS-NET-PAY                     VALUE '5'.
  2977           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  2978           88  CP-E-AS-MEAN                        VALUE '8'.
  2979           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  2980         16  FILLER                PIC X(12).
  2981
  2982***************    OUTPUT FROM ELPMNT   *************************
  2983
  2984         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  2985                                     COMP-3.
  2986         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  2987                                     COMP-3.
  2988         16  FILLER                PIC X(12).
  2989
  2990***************   MISC WORK AREAS    *****************************
  2991         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  2992                                     COMP-3.
  2993         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  2994                                     COMP-3.
  2995         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  2996                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page  56
* EL131.cbl
  2997         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  2998                                     COMP-3.
  2999         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  3000                                     COMP-3.
  3001         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  3002                                     COMP-3.
  3003         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  3004             88  OPEN-RATE-FILE                   VALUE 'O'.
  3005             88  CLOSE-RATE-FILE                  VALUE 'C'.
  3006             88  IO-ERROR                         VALUE 'E'.
  3007
  3008         16  CP-FIRST-PAY-DATE     PIC XX.
  3009
  3010         16  CP-JOINT-INDICATOR    PIC X.
  3011
  3012         16  CP-RESERVE-REMAINING-TERM
  3013                                   PIC S9(4)V9    VALUE ZERO
  3014                                     COMP-3.
  3015
  3016         16  CP-INSURED-BIRTH-DT   PIC XX.
  3017
  3018         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  3019                                     COMP-3.
  3020
  3021         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  3022                                     COMP-3.
  3023
  3024         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  3025                                     COMP-3.
  3026
  3027         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  3028                                     COMP-3.
  3029
  3030         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  3031                                     COMP-3.
  3032
  3033         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  3034                                     COMP-3.
  3035
  3036         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  3037                                     COMP-3.
  3038
  3039         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  3040             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  3041
  3042         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  3043                                     COMP-3.
  3044         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  3045                                     COMP-3.
  3046         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  3047         16  cp-extra-periods      pic 9 value zeros.
  3048         16  cp-net-only-state     pic x value spaces.
  3049         16  FILLER                PIC X(13).
  3050******************************************************************
  3051
  3052*                                COPY ELCDATE.
  3053******************************************************************
  3054*                                                                *
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page  57
* EL131.cbl
  3055*                                                                *
  3056*                            ELCDATE.                            *
  3057*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3058*                            VMOD=2.003
  3059*                                                                *
  3060*                                                                *
  3061*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  3062*                 LENGTH = 200                                   *
  3063******************************************************************
  3064
  3065 01  DATE-CONVERSION-DATA.
  3066     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  3067     12  DC-OPTION-CODE                PIC X.
  3068         88  BIN-TO-GREG                VALUE ' '.
  3069         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  3070         88  EDIT-GREG-TO-BIN           VALUE '2'.
  3071         88  YMD-GREG-TO-BIN            VALUE '3'.
  3072         88  MDY-GREG-TO-BIN            VALUE '4'.
  3073         88  JULIAN-TO-BIN              VALUE '5'.
  3074         88  BIN-PLUS-ELAPSED           VALUE '6'.
  3075         88  FIND-CENTURY               VALUE '7'.
  3076         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  3077         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  3078         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  3079         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  3080         88  JULIAN-TO-BIN-3            VALUE 'C'.
  3081         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  3082         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  3083         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3084         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3085         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  3086         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3087         88  BIN-3-TO-GREG              VALUE 'I'.
  3088         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3089         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3090         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3091         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  3092         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3093         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3094         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3095         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3096         88  THREE-CHARACTER-BIN
  3097                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3098         88  GREGORIAN-TO-BIN
  3099                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3100         88  BIN-TO-GREGORIAN
  3101                  VALUES ' ' '1' 'I' '8' 'G'.
  3102         88  JULIAN-TO-BINARY
  3103                  VALUES '5' 'C' 'E' 'F'.
  3104     12  DC-ERROR-CODE                 PIC X.
  3105         88  NO-CONVERSION-ERROR        VALUE ' '.
  3106         88  DATE-CONVERSION-ERROR
  3107                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  3108         88  DATE-IS-ZERO               VALUE '1'.
  3109         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  3110         88  DATE-IS-INVALID            VALUE '3'.
  3111         88  DATE1-GREATER-DATE2        VALUE '4'.
  3112         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page  58
* EL131.cbl
  3113         88  DATE-INVALID-OPTION        VALUE '9'.
  3114         88  INVALID-CENTURY            VALUE 'A'.
  3115         88  ONLY-CENTURY               VALUE 'B'.
  3116         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3117         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3118     12  DC-END-OF-MONTH               PIC X.
  3119         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3120     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3121         88  USE-NORMAL-PROCESS         VALUE ' '.
  3122         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  3123         88  ADJUST-UP-100-YRS          VALUE '2'.
  3124     12  FILLER                        PIC X.
  3125     12  DC-CONVERSION-DATES.
  3126         16  DC-BIN-DATE-1             PIC XX.
  3127         16  DC-BIN-DATE-2             PIC XX.
  3128         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  3129         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3130                       DC-GREG-DATE-1-EDIT.
  3131             20  DC-EDIT1-MONTH        PIC 99.
  3132             20  SLASH1-1              PIC X.
  3133             20  DC-EDIT1-DAY          PIC 99.
  3134             20  SLASH1-2              PIC X.
  3135             20  DC-EDIT1-YEAR         PIC 99.
  3136         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3137         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  3138                     DC-GREG-DATE-2-EDIT.
  3139             20  DC-EDIT2-MONTH        PIC 99.
  3140             20  SLASH2-1              PIC X.
  3141             20  DC-EDIT2-DAY          PIC 99.
  3142             20  SLASH2-2              PIC X.
  3143             20  DC-EDIT2-YEAR         PIC 99.
  3144         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3145         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3146                     DC-GREG-DATE-1-YMD.
  3147             20  DC-YMD-YEAR           PIC 99.
  3148             20  DC-YMD-MONTH          PIC 99.
  3149             20  DC-YMD-DAY            PIC 99.
  3150         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3151         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3152                      DC-GREG-DATE-1-MDY.
  3153             20  DC-MDY-MONTH          PIC 99.
  3154             20  DC-MDY-DAY            PIC 99.
  3155             20  DC-MDY-YEAR           PIC 99.
  3156         16  DC-GREG-DATE-1-ALPHA.
  3157             20  DC-ALPHA-MONTH        PIC X(10).
  3158             20  DC-ALPHA-DAY          PIC 99.
  3159             20  FILLER                PIC XX.
  3160             20  DC-ALPHA-CENTURY.
  3161                 24 DC-ALPHA-CEN-N     PIC 99.
  3162             20  DC-ALPHA-YEAR         PIC 99.
  3163         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3164         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3165         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3166         16  DC-JULIAN-DATE            PIC 9(05).
  3167         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  3168                                       PIC 9(05).
  3169         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3170             20  DC-JULIAN-YEAR        PIC 99.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page  59
* EL131.cbl
  3171             20  DC-JULIAN-DAYS        PIC 999.
  3172         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3173         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3174         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3175     12  DATE-CONVERSION-VARIBLES.
  3176         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3177         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3178             20  FILLER                PIC 9(3).
  3179             20  HOLD-CEN-1-CCYY.
  3180                 24  HOLD-CEN-1-CC     PIC 99.
  3181                 24  HOLD-CEN-1-YY     PIC 99.
  3182             20  HOLD-CEN-1-MO         PIC 99.
  3183             20  HOLD-CEN-1-DA         PIC 99.
  3184         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3185             20  HOLD-CEN-1-R-MO       PIC 99.
  3186             20  HOLD-CEN-1-R-DA       PIC 99.
  3187             20  HOLD-CEN-1-R-CCYY.
  3188                 24  HOLD-CEN-1-R-CC   PIC 99.
  3189                 24  HOLD-CEN-1-R-YY   PIC 99.
  3190             20  FILLER                PIC 9(3).
  3191         16  HOLD-CENTURY-1-X.
  3192             20  FILLER                PIC X(3)  VALUE SPACES.
  3193             20  HOLD-CEN-1-X-CCYY.
  3194                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3195                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3196             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3197             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3198         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3199             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3200             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3201             20  HOLD-CEN-1-R-X-CCYY.
  3202                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3203                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3204             20  FILLER                PIC XXX.
  3205         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3206         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3207         16  DC-JULIAN-DATE-1          PIC 9(07).
  3208         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3209             20  DC-JULIAN-1-CCYY.
  3210                 24  DC-JULIAN-1-CC    PIC 99.
  3211                 24  DC-JULIAN-1-YR    PIC 99.
  3212             20  DC-JULIAN-DA-1        PIC 999.
  3213         16  DC-JULIAN-DATE-2          PIC 9(07).
  3214         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3215             20  DC-JULIAN-2-CCYY.
  3216                 24  DC-JULIAN-2-CC    PIC 99.
  3217                 24  DC-JULIAN-2-YR    PIC 99.
  3218             20  DC-JULIAN-DA-2        PIC 999.
  3219         16  DC-GREG-DATE-A-EDIT.
  3220             20  DC-EDITA-MONTH        PIC 99.
  3221             20  SLASHA-1              PIC X VALUE '/'.
  3222             20  DC-EDITA-DAY          PIC 99.
  3223             20  SLASHA-2              PIC X VALUE '/'.
  3224             20  DC-EDITA-CCYY.
  3225                 24  DC-EDITA-CENT     PIC 99.
  3226                 24  DC-EDITA-YEAR     PIC 99.
  3227         16  DC-GREG-DATE-B-EDIT.
  3228             20  DC-EDITB-MONTH        PIC 99.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page  60
* EL131.cbl
  3229             20  SLASHB-1              PIC X VALUE '/'.
  3230             20  DC-EDITB-DAY          PIC 99.
  3231             20  SLASHB-2              PIC X VALUE '/'.
  3232             20  DC-EDITB-CCYY.
  3233                 24  DC-EDITB-CENT     PIC 99.
  3234                 24  DC-EDITB-YEAR     PIC 99.
  3235         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3236         16  DC-GREG-DATE-CYMD-R REDEFINES
  3237                              DC-GREG-DATE-CYMD.
  3238             20  DC-CYMD-CEN           PIC 99.
  3239             20  DC-CYMD-YEAR          PIC 99.
  3240             20  DC-CYMD-MONTH         PIC 99.
  3241             20  DC-CYMD-DAY           PIC 99.
  3242         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3243         16  DC-GREG-DATE-MDCY-R REDEFINES
  3244                              DC-GREG-DATE-MDCY.
  3245             20  DC-MDCY-MONTH         PIC 99.
  3246             20  DC-MDCY-DAY           PIC 99.
  3247             20  DC-MDCY-CEN           PIC 99.
  3248             20  DC-MDCY-YEAR          PIC 99.
  3249    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3250        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3251    12  DC-EL310-DATE                  PIC X(21).
  3252    12  FILLER                         PIC X(28).
  3253
  3254*                                COPY ELCDMO.
  3255******************************************************************
  3256*                                                                *
  3257*                                                                *
  3258*                            ELCDMO.                             *
  3259*                            VMOD=2.004                          *
  3260*                                                                *
  3261*   FILE DESCRIPTION = DLO025 (DMO FILE MAINTENANCE PGRM)        *
  3262*        COMMUNICATION AREA                                      *
  3263*   FILE TYPE = NA                                               *
  3264*   RECORD SIZE = 110    RECFORM = FIXED                         *
  3265*                                                                *
  3266******************************************************************
  3267 01  DMO-COMMUNICATION-AREA.
  3268     12  DM-RECORD-TYPE                  PIC  X(02).
  3269             88  DM-ISSUE-TRAN                VALUE 'CC'.
  3270             88  DM-CLAIM-STATUS-CHANGE       VALUE 'CS'.
  3271             88  DM-CLAIM-PAYMENT             VALUE 'DR'.
  3272     12  DM-DIST-CODE                    PIC  X(04).
  3273     12  DM-MAIL-CODE                    PIC  X(05).
  3274     12  DM-CREDIT-CARD-NUMBER           PIC  X(16).
  3275     12  DM-INSURED-NAME                 PIC  X(30).
  3276     12  DM-CLAIM-NO                     PIC  X(07).
  3277     12  DM-CLAIM-TYPE                   PIC  X.
  3278
  3279     12  DM-STATUS-DATA-AREA.
  3280         16  DM-CLAIM-STATUS             PIC  X.
  3281             88  DM-OPEN-NO-PAYMENTS              VALUE '1'.
  3282             88  DM-OPEN-WITH-PAYMENTS            VALUE '2'.
  3283             88  DM-CLOSED                        VALUE '3'.
  3284             88  DM-CLOSE-SETTLE-FINAL            VALUE '4'.
  3285             88  DM-DEFAULT                       VALUE '9'.
  3286         16  DM-STATUS-DATE              PIC  X(08).
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page  61
* EL131.cbl
  3287******YYYYMMDD
  3288         16  DM-STAT-CHANGE-TYPE         PIC  X.
  3289             88  DM-MANUAL-CLOSE                  VALUE 'C'.
  3290             88  DM-CLAIM-DENIED                  VALUE 'D'.
  3291             88  DM-FINAL-PAYMENT                 VALUE 'F'.
  3292             88  DM-INITIAL-PAYMENT               VALUE 'I'.
  3293             88  DM-AUTO-CLOSE                    VALUE 'Q'.
  3294             88  DM-RE-OPENED                     VALUE 'R'.
  3295             88  DM-NEW-CLAIM-SETUP               VALUE 'S'.
  3296             88  DM-VOIDED-PAYMENT                VALUE 'V'.
  3297             88  DM-CLAIM-DELETED                 VALUE 'X'.
  3298         16  DM-STAT-CARRIER             PIC X.
  3299
  3300     12  DM-DRAFT-DATA-AREA.
  3301         16  DM-PAYMENT-TYPE             PIC  X.
  3302             88  DM-VALID-CLAIM-TYPES VALUES 'L' 'D' 'U' 'A'.
  3303         16  DM-PAYMENT-AMT              PIC  9(05)V9(02).
  3304         16  DM-PAYMENT-DATE             PIC  X(08).
  3305******YYYYMMDD
  3306         16  DM-CERT-NO                  PIC  X(11).
  3307         16  DM-TRLR-SEQ-NO              PIC  9(04).
  3308         16  DM-CARRIER                  PIC  X.
  3309
  3310     12  DM-RETURN-CODE                  PIC  XX.
  3311*                                COPY ERCPDEF.
  3312******************************************************************
  3313*                                                                *
  3314*                                                                *
  3315*                            ERCPDEF.                            *
  3316*                                                                *
  3317*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  3318*                                                                *
  3319*    FILE TYPE = VSAM,KSDS                                       *
  3320*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  3321*                                                                *
  3322*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  3323*                                                                *
  3324*    LOG = YES                                                   *
  3325*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3326******************************************************************
  3327*                   C H A N G E   L O G
  3328*
  3329* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3330*-----------------------------------------------------------------
  3331*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3332* EFFECTIVE    NUMBER
  3333*-----------------------------------------------------------------
  3334* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3335* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  3336* 100314  CR2014061900001  PEMA  ADD PCT OF BENEFIT
  3337* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  3338******************************************************************
  3339 01  PRODUCT-MASTER.
  3340    12  PD-RECORD-ID                 PIC X(02).
  3341        88  VALID-PD-ID                  VALUE 'PD'.
  3342    12  PD-CONTROL-PRIMARY.
  3343        16  PD-COMPANY-CD            PIC X.
  3344        16  PD-STATE                 PIC XX.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page  62
* EL131.cbl
  3345        16  PD-PRODUCT-CD            PIC XXX.
  3346        16  PD-FILLER                PIC X(7).
  3347        16  PD-BEN-TYPE              PIC X.
  3348        16  PD-BEN-CODE              PIC XX.
  3349        16  PD-PROD-EXP-DT           PIC XX.
  3350    12  FILLER                       PIC X(50).
  3351    12  PD-PRODUCT-DATA OCCURS 8.
  3352        16  PD-PROD-CODE             PIC X.
  3353            88  PD-PROD-LIFE           VALUE 'L'.
  3354            88  PD-PROD-PROP           VALUE 'P'.
  3355            88  PD-PROD-AH             VALUE 'A'.
  3356            88  PD-PROD-IU             VALUE 'I'.
  3357            88  PD-PROD-GAP            VALUE 'G'.
  3358            88  PD-PROD-FAML           VALUE 'F'.
  3359            88  PD-PROD-OTH            VALUE 'O'.
  3360        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  3361        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  3362        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  3363        16  PD-MAX-TERM              PIC S999        COMP-3.
  3364        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  3365        16  FILLER                   PIC X.
  3366        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  3367        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  3368        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  3369        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  3370        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  3371        16  PD-REC-CRIT-PERIOD       PIC 99.
  3372        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  3373            20  PD-RECURRING-YN      PIC X.
  3374            20  FILLER               PIC X.
  3375        16  PD-RTW-MOS               PIC 99.
  3376        16  PD-MAX-EXTENSION         PIC 99.
  3377        16  pd-ben-pct               pic sv999 comp-3.
  3378*       16  FILLER                   PIC XX.
  3379    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  3380    12  PD-TERM-LIMITS OCCURS 15.
  3381        16  PD-LOW-TERM              PIC S999        COMP-3.
  3382        16  PD-HI-TERM               PIC S999        COMP-3.
  3383*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  3384    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  3385        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  3386        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  3387    12  PD-EARN-FACTORS.
  3388        16  FILLER OCCURS 15.
  3389            20  FILLER OCCURS 15.
  3390                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  3391    12  PD-PRODUCT-DESC              PIC X(80).
  3392    12  PD-TRUNCATED                 PIC X.
  3393    12  FILLER                       PIC X(59).
  3394    12  PD-MAINT-INFORMATION.
  3395        16  PD-LAST-MAINT-DT         PIC X(02).
  3396        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  3397        16  PD-LAST-MAINT-BY         PIC X(04).
  3398*                                COPY ELCCRTT.
  3399******************************************************************
  3400*                                                                *
  3401*                            ELCCRTT.                            *
  3402*                                                                *
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page  63
* EL131.cbl
  3403*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  3404*                                                                *
  3405*   FILE TYPE = VSAM,KSDS                                        *
  3406*   RECORD SIZE = 552  RECFORM = FIXED                           *
  3407*                                                                *
  3408*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  3409*                                                                *
  3410*   LOG = YES                                                    *
  3411*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3412******************************************************************
  3413*                   C H A N G E   L O G
  3414*
  3415* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3416*-----------------------------------------------------------------
  3417*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3418* EFFECTIVE    NUMBER
  3419*-----------------------------------------------------------------
  3420* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  3421* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  3422* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  3423* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  3424* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  3425* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3426* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  3427* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  3428* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  3429* 012918  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
  3430* 091318  CR2018073000001  PEMA  ADD Refund methods
  3431* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  3432******************************************************************
  3433
  3434 01  CERTIFICATE-TRAILERS.
  3435     12  CS-RECORD-ID                      PIC XX.
  3436         88  VALID-CS-ID                      VALUE 'CS'.
  3437
  3438     12  CS-CONTROL-PRIMARY.
  3439         16  CS-COMPANY-CD                 PIC X.
  3440         16  CS-CARRIER                    PIC X.
  3441         16  CS-GROUPING                   PIC X(6).
  3442         16  CS-STATE                      PIC XX.
  3443         16  CS-ACCOUNT                    PIC X(10).
  3444         16  CS-CERT-EFF-DT                PIC XX.
  3445         16  CS-CERT-NO.
  3446             20  CS-CERT-PRIME             PIC X(10).
  3447             20  CS-CERT-SFX               PIC X.
  3448         16  CS-TRAILER-TYPE               PIC X.
  3449             88  COMM-TRLR           VALUE 'A'.
  3450             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  3451             88  CERT-DATA-TRLR      VALUE 'C'.
  3452
  3453     12  CS-DATA-AREA                      PIC X(516).
  3454
  3455     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  3456         16  CS-BANK-COMMISSION-AREA.
  3457             20  CS-BANK-COMMS       OCCURS 10.
  3458                 24  CS-AGT                PIC X(10).
  3459                 24  CS-COM-TYP            PIC X.
  3460                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page  64
* EL131.cbl
  3461                 24  CS-RECALC-LV-INDIC    PIC X.
  3462                 24  FILLER                PIC X(10).
  3463         16  FILLER                        PIC X(256).
  3464
  3465     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  3466****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  3467         16  CS-MB-CLAIM-DATA OCCURS 24.
  3468             20  CS-CLAIM-NO               PIC X(7).
  3469             20  CS-CLAIM-TYPE             PIC X.
  3470                 88  CS-AH-CLM               VALUE 'A'.
  3471                 88  CS-IU-CLM               VALUE 'I'.
  3472                 88  CS-GP-CLM               VALUE 'G'.
  3473                 88  CS-LF-CLM               VALUE 'L'.
  3474                 88  CS-PR-CLM               VALUE 'P'.
  3475                 88  CS-FL-CLM               VALUE 'F'.
  3476                 88  CS-OT-CLM               VALUE 'O'.
  3477             20  CS-INSURED-TYPE           PIC X.
  3478                 88  CS-PRIM-INSURED          VALUE 'P'.
  3479                 88  CS-CO-BORROWER           VALUE 'C'.
  3480             20  CS-BENEFIT-PERIOD         PIC 99.
  3481             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  3482             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  3483             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  3484         16  FILLER                        PIC X(12).
  3485     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  3486         16  CS-VIN-NUMBER                 PIC X(17).
  3487         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  3488         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  3489         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  3490         16  cs-agent-name.
  3491             20  cs-agent-fname            pic x(20).
  3492             20  cs-agent-mi               pic x.
  3493             20  cs-agent-lname            pic x(25).
  3494         16  cs-license-no                 pic x(15).
  3495         16  cs-npn-number                 pic x(10).
  3496         16  cs-agent-edit-status          pic x.
  3497             88  cs-ae-refer-to-manager      value 'M'.
  3498             88  cs-ae-cover-sheet           value 'C'.
  3499             88  cs-ae-sig-form              value 'S'.
  3500             88  cs-ae-verified              value 'V'.
  3501             88  cs-unidentified-signature   value 'U'.
  3502             88  cs-cert-returned            value 'R'.
  3503             88  cs-accept-no-commission     value 'N'.
  3504         16  cs-year                       pic 9999.
  3505         16  cs-make                       pic x(20).
  3506         16  cs-model                      pic x(20).
  3507         16  cs-future                     pic x(20).
  3508         16  cs-vehicle-odometer           pic s9(7) comp-3.
  3509         16  cs-claim-verification-status  pic x.
  3510             88  cs-clm-ver-eligible         value 'A'.
  3511             88  cs-clm-ver-partial-elig     value 'B'.
  3512             88  cs-clm-ver-not-eligible     value 'C'.
  3513             88  cs-clm-ver-not-elig-opn-clm value 'D'.
  3514             88  cs-clm-ver-not-part-elig-rw value 'E'.
  3515             88  cs-clm-ver-ND-CERT          value 'F'.
  3516             88  cs-clm-ver-spec-other       value 'G'.
  3517             88  cs-clam-ver-pratial-corrected
  3518                                             value 'H'.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page  65
* EL131.cbl
  3519             88  cs-clm-ver-no-matches       value 'I'.
  3520             88  cs-clm-ver-not-elig-corrected
  3521                                             value 'J'.
  3522             88  cs-clm-ver-needs-review     value 'R'.
  3523             88  cs-clm-ver-sent-to-claims   value 'W'.
  3524         16  CS-LF-REFUND-METHOD           PIC X.
  3525         16  CS-AH-REFUND-METHOD           PIC X.
  3526         16  FILLER                        PIC X(353). *> was 420
  3527*        16  FILLER                        PIC X(496).
  3528
  3529****************************************************************
  3530*
  3531* Copyright (c) 2007-2013 Dell Inc.
  3532* All rights reserved.
  3533*
  3534****************************************************************
  3535 01  DFHEIV.
  3536   02  DFHEIV0               PIC X(35).
  3537   02  DFHEIV1               PIC X(08).
  3538   02  DFHEIV2               PIC X(08).
  3539   02  DFHEIV3               PIC X(08).
  3540   02  DFHEIV4               PIC X(06).
  3541   02  DFHEIV5               PIC X(04).
  3542   02  DFHEIV6               PIC X(04).
  3543   02  DFHEIV7               PIC X(02).
  3544   02  DFHEIV8               PIC X(02).
  3545   02  DFHEIV9               PIC X(01).
  3546   02  DFHEIV10              PIC S9(7) COMP-3.
  3547   02  DFHEIV11              PIC S9(4) COMP SYNC.
  3548   02  DFHEIV12              PIC S9(4) COMP SYNC.
  3549   02  DFHEIV13              PIC S9(4) COMP SYNC.
  3550   02  DFHEIV14              PIC S9(4) COMP SYNC.
  3551   02  DFHEIV15              PIC S9(4) COMP SYNC.
  3552   02  DFHEIV16              PIC S9(9) COMP SYNC.
  3553   02  DFHEIV17              PIC X(04).
  3554   02  DFHEIV18              PIC X(04).
  3555   02  DFHEIV19              PIC X(04).
  3556   02  DFHEIV20              USAGE IS POINTER.
  3557   02  DFHEIV21              USAGE IS POINTER.
  3558   02  DFHEIV22              USAGE IS POINTER.
  3559   02  DFHEIV23              USAGE IS POINTER.
  3560   02  DFHEIV24              USAGE IS POINTER.
  3561   02  DFHEIV25              PIC S9(9) COMP SYNC.
  3562   02  DFHEIV26              PIC S9(9) COMP SYNC.
  3563   02  DFHEIV27              PIC S9(9) COMP SYNC.
  3564   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3565   02  DFHEIV29              PIC S9(9) COMP SYNC.
  3566   02  DFHEIV30              PIC S9(9) COMP SYNC.
  3567   02  DFHEIV31              PIC S9(9) COMP SYNC.
  3568   02  DFHEIV32              PIC S9(4) COMP SYNC.
  3569   02  DFHEIV33              PIC S9(4) COMP SYNC.
  3570   02  DFHEIV34              PIC S9(4) COMP SYNC.
  3571   02  DFHEIV35              PIC S9(4) COMP SYNC.
  3572   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3573   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3574   02  FILLER                PIC X(02).
  3575   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3576   02  DFHEIVL0              PIC X(48) VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page  66
* EL131.cbl
  3577   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3578   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3579   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3580   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  3581   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  3582 LINKAGE  SECTION.
  3583*****************************************************************
  3584*                                                               *
  3585* Copyright (c) 2007-2013 Dell Inc.                             *
  3586* All rights reserved.                                          *
  3587*                                                               *
  3588*****************************************************************
  3589 01  dfheiblk.
  3590     02  eibtime          pic s9(7) comp-3.
  3591     02  eibdate          pic s9(7) comp-3.
  3592     02  eibtrnid         pic x(4).
  3593     02  eibtaskn         pic s9(7) comp-3.
  3594     02  eibtrmid         pic x(4).
  3595     02  dfheigdi         pic s9(4) comp.
  3596     02  eibcposn         pic s9(4) comp.
  3597     02  eibcalen         pic s9(4) comp.
  3598     02  eibaid           pic x(1).
  3599     02  eibfiller1       pic x(1).
  3600     02  eibfn            pic x(2).
  3601     02  eibfiller2       pic x(2).
  3602     02  eibrcode         pic x(6).
  3603     02  eibfiller3       pic x(2).
  3604     02  eibds            pic x(8).
  3605     02  eibreqid         pic x(8).
  3606     02  eibrsrce         pic x(8).
  3607     02  eibsync          pic x(1).
  3608     02  eibfree          pic x(1).
  3609     02  eibrecv          pic x(1).
  3610     02  eibsend          pic x(1).
  3611     02  eibatt           pic x(1).
  3612     02  eibeoc           pic x(1).
  3613     02  eibfmh           pic x(1).
  3614     02  eibcompl         pic x(1).
  3615     02  eibsig           pic x(1).
  3616     02  eibconf          pic x(1).
  3617     02  eiberr           pic x(1).
  3618     02  eibrldbk         pic x(1).
  3619     02  eiberrcd         pic x(4).
  3620     02  eibsynrb         pic x(1).
  3621     02  eibnodat         pic x(1).
  3622     02  eibfiller5       pic x(2).
  3623     02  eibresp          pic s9(8) comp.
  3624     02  eibresp2         pic s9(8) comp.
  3625     02  dfheigdj         pic s9(4) comp.
  3626     02  dfheigdk         pic s9(4) comp.
  3627 01  DFHCOMMAREA                 PIC X(1024).
  3628
  3629*                                COPY ELCMSTR.
  3630******************************************************************
  3631*                                                                *
  3632*                            ELCMSTR.                            *
  3633*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3634*                            VMOD=2.012                          *
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page  67
* EL131.cbl
  3635*                                                                *
  3636*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  3637*                                                                *
  3638*   FILE TYPE = VSAM,KSDS                                        *
  3639*   RECORD SIZE = 350  RECFORM = FIXED                           *
  3640*                                                                *
  3641*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  3642*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  3643*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  3644*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  3645*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  3646*                                                 RKP=75,LEN=21  *
  3647*                                                                *
  3648*   **** NOTE ****                                               *
  3649*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  3650*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  3651*                                                                *
  3652*   LOG = YES                                                    *
  3653*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3654******************************************************************
  3655*                   C H A N G E   L O G
  3656*
  3657* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3658*-----------------------------------------------------------------
  3659*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3660* EFFECTIVE    NUMBER
  3661*-----------------------------------------------------------------
  3662* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  3663* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  3664* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  3665* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3666* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  3667* 081817    2016100700001  TANA  ADD NBR OF EXTENSIONS
  3668* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  3669******************************************************************
  3670 01  CLAIM-MASTER.
  3671     12  CL-RECORD-ID                PIC XX.
  3672         88  VALID-CL-ID         VALUE 'CL'.
  3673
  3674     12  CL-CONTROL-PRIMARY.
  3675         16  CL-COMPANY-CD           PIC X.
  3676         16  CL-CARRIER              PIC X.
  3677         16  CL-CLAIM-NO             PIC X(7).
  3678         16  CL-CERT-NO.
  3679             20  CL-CERT-PRIME       PIC X(10).
  3680             20  CL-CERT-SFX         PIC X.
  3681
  3682     12  CL-CONTROL-BY-NAME.
  3683         16  CL-COMPANY-CD-A1        PIC X.
  3684         16  CL-INSURED-LAST-NAME    PIC X(15).
  3685         16  CL-INSURED-NAME.
  3686             20  CL-INSURED-1ST-NAME PIC X(12).
  3687             20  CL-INSURED-MID-INIT PIC X.
  3688
  3689     12  CL-CONTROL-BY-SSN.
  3690         16  CL-COMPANY-CD-A2        PIC X.
  3691         16  CL-SOC-SEC-NO.
  3692             20  CL-SSN-STATE        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page  68
* EL131.cbl
  3693             20  CL-SSN-ACCOUNT      PIC X(6).
  3694             20  CL-SSN-LN3          PIC X(3).
  3695
  3696     12  CL-CONTROL-BY-CERT-NO.
  3697         16  CL-COMPANY-CD-A4        PIC X.
  3698         16  CL-CERT-NO-A4.
  3699             20  CL-CERT-A4-PRIME    PIC X(10).
  3700             20  CL-CERT-A4-SFX      PIC X.
  3701
  3702     12  CL-CONTROL-BY-CCN.
  3703         16  CL-COMPANY-CD-A5        PIC X.
  3704         16  CL-CCN-A5.
  3705             20  CL-CCN.
  3706                 24  CL-CCN-PREFIX-A5 PIC X(4).
  3707                 24  CL-CCN-PRIME-A5 PIC X(12).
  3708             20  CL-CCN-FILLER-A5    PIC X(4).
  3709
  3710     12  CL-INSURED-PROFILE-DATA.
  3711         16  CL-INSURED-BIRTH-DT     PIC XX.
  3712         16  CL-INSURED-SEX-CD       PIC X.
  3713             88  INSURED-IS-MALE        VALUE 'M'.
  3714             88  INSURED-IS-FEMALE      VALUE 'F'.
  3715             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  3716         16  CL-INSURED-OCC-CD       PIC X(6).
  3717         16  FILLER                  PIC X(5).
  3718
  3719     12  CL-PROCESSING-INFO.
  3720         16  CL-PROCESSOR-ID         PIC X(4).
  3721         16  CL-CLAIM-STATUS         PIC X.
  3722             88  CLAIM-IS-OPEN          VALUE 'O'.
  3723             88  CLAIM-IS-CLOSED        VALUE 'C'.
  3724         16  CL-CLAIM-TYPE           PIC X.
  3725*            88  AH-CLAIM               VALUE 'A'.
  3726*            88  LIFE-CLAIM             VALUE 'L'.
  3727*            88  PROPERTY-CLAIM         VALUE 'P'.
  3728*            88  IUI-CLAIM              VALUE 'I'.
  3729*            88  GAP-CLAIM              VALUE 'G'.
  3730*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  3731*            88  OTHER-CLAIM            VALUE 'O'.
  3732         16  CL-CLAIM-PREM-TYPE      PIC X.
  3733             88  SINGLE-PREMIUM         VALUE '1'.
  3734             88  O-B-COVERAGE           VALUE '2'.
  3735             88  OPEN-END-COVERAGE      VALUE '3'.
  3736         16  CL-INCURRED-DT          PIC XX.
  3737         16  CL-REPORTED-DT          PIC XX.
  3738         16  CL-FILE-ESTABLISH-DT    PIC XX.
  3739         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  3740         16  CL-LAST-PMT-DT          PIC XX.
  3741         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  3742         16  CL-PAID-THRU-DT         PIC XX.
  3743         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  3744         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  3745         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  3746         16  CL-PMT-CALC-METHOD      PIC X.
  3747             88  CL-360-DAY-YR          VALUE '1'.
  3748             88  CL-365-DAY-YR          VALUE '2'.
  3749             88  CL-FULL-MONTHS         VALUE '3'.
  3750         16  CL-CAUSE-CD             PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page  69
* EL131.cbl
  3751
  3752         16  CL-PRIME-CERT-NO.
  3753             20  CL-PRIME-CERT-PRIME PIC X(10).
  3754             20  CL-PRIME-CERT-SFX   PIC X.
  3755
  3756         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  3757             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  3758             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  3759
  3760         16  CL-MICROFILM-NO         PIC X(10).
  3761         16  FILLER REDEFINES CL-MICROFILM-NO.
  3762             20  CL-BENEFIT-PERIOD   PIC 99.
  3763             20  FILLER              PIC X(8).
  3764         16  CL-PROG-FORM-TYPE       PIC X.
  3765         16  CL-LAST-ADD-ON-DT       PIC XX.
  3766
  3767         16  CL-LAST-REOPEN-DT       PIC XX.
  3768         16  CL-LAST-CLOSE-DT        PIC XX.
  3769         16  CL-LAST-CLOSE-REASON    PIC X(01).
  3770             88  FINAL-PAID             VALUE '1'.
  3771             88  CLAIM-DENIED           VALUE '2'.
  3772             88  AUTO-CLOSE             VALUE '3'.
  3773             88  MANUAL-CLOSE           VALUE '4'.
  3774             88  BENEFITS-CHANGED       VALUE 'C'.
  3775             88  SETUP-ERRORS           VALUE 'E'.
  3776         16  CL-ASSOC-CERT-SEQU      PIC S99.
  3777         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  3778         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  3779             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  3780         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  3781         16  FILLER                  PIC X.
  3782
  3783     12  CL-CERTIFICATE-DATA.
  3784         16  CL-CERT-ORIGIN          PIC X.
  3785             88  CERT-WAS-ONLINE        VALUE '1'.
  3786             88  CERT-WAS-CREATED       VALUE '2'.
  3787             88  COVERAGE-WAS-ADDED     VALUE '3'.
  3788         16  CL-CERT-KEY-DATA.
  3789             20  CL-CERT-CARRIER     PIC X.
  3790             20  CL-CERT-GROUPING    PIC X(6).
  3791             20  CL-CERT-STATE       PIC XX.
  3792             20  CL-CERT-ACCOUNT.
  3793                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  3794                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  3795             20  CL-CERT-EFF-DT      PIC XX.
  3796
  3797     12  CL-STATUS-CONTROLS.
  3798         16  CL-PRIORITY-CD          PIC X.
  3799             88  CONFIDENTIAL-DATA      VALUE '8'.
  3800             88  HIGHEST-PRIORITY       VALUE '9'.
  3801         16  CL-SUPV-ATTN-CD         PIC X.
  3802             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  3803             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  3804         16  CL-PURGED-DT            PIC XX.
  3805         16  CL-RESTORED-DT          PIC XX.
  3806         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  3807         16  CL-NEXT-RESEND-DT       PIC XX.
  3808         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page  70
* EL131.cbl
  3809         16  CL-CRITICAL-PERIOD      PIC 99.
  3810*        16  FILLER                  PIC XX.
  3811         16  CL-LAST-MAINT-DT        PIC XX.
  3812         16  CL-LAST-MAINT-USER      PIC X(4).
  3813         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  3814         16  CL-LAST-MAINT-TYPE      PIC X.
  3815             88  CLAIM-SET-UP           VALUE ' '.
  3816             88  PAYMENT-MADE           VALUE '1'.
  3817             88  LETTER-SENT            VALUE '2'.
  3818             88  MASTER-WAS-ALTERED     VALUE '3'.
  3819             88  MASTER-WAS-RESTORED    VALUE '4'.
  3820             88  INCURRED-DATE-CHANGED  VALUE '5'.
  3821             88  FILE-CONVERTED         VALUE '6'.
  3822             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  3823             88  ERROR-CORRECTION       VALUE 'E'.
  3824         16  CL-RELATED-CLAIM-NO     PIC X(7).
  3825         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  3826         16  CL-BENEFICIARY          PIC X(10).
  3827         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  3828         16  CL-DENIAL-TYPE          PIC X.
  3829             88  CL-TYPE-DENIAL          VALUE '1'.
  3830             88  CL-TYPE-RESCISSION      VALUE '2'.
  3831             88  CL-TYPE-REFORMATION     VALUE '3'.
  3832             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  3833             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  3834         16  CL-NO-OF-EXTENSIONS     PIC 99.
  3835         16  filler                  pic x(3).
  3836*        16  CL-CRIT-PER-RECURRENT   PIC X.
  3837*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  3838*        16  CL-RTW-DT               PIC XX.
  3839
  3840     12  CL-TRAILER-CONTROLS.
  3841         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  3842             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  3843             88  CL-LAST-TRL-AVAIL      VALUE +100.
  3844             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  3845         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  3846         16  FILLER                  PIC XX.
  3847         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  3848         16  CL-ADDRESS-TRAILER-CNT.
  3849             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  3850                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  3851             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  3852                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  3853             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  3854                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  3855             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  3856                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  3857             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  3858                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  3859             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  3860                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  3861             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  3862                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  3863
  3864     12  CL-CV-REFERENCE-NO.
  3865         16  CL-CV-REFNO-PRIME       PIC X(18).
  3866         16  CL-CV-REFNO-SFX         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page  71
* EL131.cbl
  3867
  3868     12  CL-FILE-LOCATION            PIC X(4).
  3869
  3870     12  CL-PROCESS-ERRORS.
  3871         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  3872             88  NO-FATAL-ERRORS        VALUE ZERO.
  3873         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  3874             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  3875
  3876     12  CL-PRODUCT-CD               PIC X.
  3877
  3878     12  CL-CURRENT-KEY-DATA.
  3879         16  CL-CURRENT-CARRIER      PIC X.
  3880         16  CL-CURRENT-GROUPING     PIC X(6).
  3881         16  CL-CURRENT-STATE        PIC XX.
  3882         16  CL-CURRENT-ACCOUNT      PIC X(10).
  3883
  3884     12  CL-ASSOCIATES               PIC X.
  3885         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  3886         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  3887         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  3888         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  3889
  3890     12  CL-ACTIVITY-CODE            PIC 99.
  3891     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  3892     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  3893
  3894     12  CL-LAPSE-REPORT-CODE        PIC 9.
  3895     12  CL-LAG-REPORT-CODE          PIC 9.
  3896     12  CL-LOAN-TYPE                PIC XX.
  3897     12  CL-LEGAL-STATE              PIC XX.
  3898
  3899     12  CL-YESNOSW                  PIC X.
  3900     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  3901         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  3902         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  3903         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  3904     12  cl-insured-type             pic x.
  3905         88  cl-claim-on-primary         value 'P'.
  3906         88  cl-claim-on-co-borrower     value 'C'.
  3907     12  cl-benefit-expiration-dt    PIC XX.
  3908
  3909*                                COPY ELCCERT.
  3910******************************************************************
  3911*                                                                *
  3912*                            ELCCERT.                            *
  3913*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3914*                            VMOD=2.013                          *
  3915*                                                                *
  3916*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  3917*                                                                *
  3918*   FILE TYPE = VSAM,KSDS                                        *
  3919*   RECORD SIZE = 450  RECFORM = FIXED                           *
  3920*                                                                *
  3921*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  3922*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  3923*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  3924*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page  72
* EL131.cbl
  3925*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  3926*                                                                *
  3927*   LOG = YES                                                    *
  3928*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3929******************************************************************
  3930*                   C H A N G E   L O G
  3931*
  3932* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3933*-----------------------------------------------------------------
  3934*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3935* EFFECTIVE    NUMBER
  3936*-----------------------------------------------------------------
  3937* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3938* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  3939* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  3940* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  3941* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  3942* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  3943* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3944* 032612  CR2011110200001  PEMA  AHL CHANGES
  3945* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  3946* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  3947* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
  3948******************************************************************
  3949
  3950 01  CERTIFICATE-MASTER.
  3951     12  CM-RECORD-ID                      PIC XX.
  3952         88  VALID-CM-ID                      VALUE 'CM'.
  3953
  3954     12  CM-CONTROL-PRIMARY.
  3955         16  CM-COMPANY-CD                 PIC X.
  3956         16  CM-CARRIER                    PIC X.
  3957         16  CM-GROUPING.
  3958             20  CM-GROUPING-PREFIX        PIC X(3).
  3959             20  CM-GROUPING-PRIME         PIC X(3).
  3960         16  CM-STATE                      PIC XX.
  3961         16  CM-ACCOUNT.
  3962             20  CM-ACCOUNT-PREFIX         PIC X(4).
  3963             20  CM-ACCOUNT-PRIME          PIC X(6).
  3964         16  CM-CERT-EFF-DT                PIC XX.
  3965         16  CM-CERT-NO.
  3966             20  CM-CERT-PRIME             PIC X(10).
  3967             20  CM-CERT-SFX               PIC X.
  3968
  3969     12  CM-CONTROL-BY-NAME.
  3970         16  CM-COMPANY-CD-A1              PIC X.
  3971         16  CM-INSURED-LAST-NAME          PIC X(15).
  3972         16  CM-INSURED-INITIALS.
  3973             20  CM-INSURED-INITIAL1       PIC X.
  3974             20  CM-INSURED-INITIAL2       PIC X.
  3975
  3976     12  CM-CONTROL-BY-SSN.
  3977         16  CM-COMPANY-CD-A2              PIC X.
  3978         16  CM-SOC-SEC-NO.
  3979             20  CM-SSN-STATE              PIC XX.
  3980             20  CM-SSN-ACCOUNT            PIC X(6).
  3981             20  CM-SSN-LN3.
  3982                 25  CM-INSURED-INITIALS-A2.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page  73
* EL131.cbl
  3983                     30 CM-INSURED-INITIAL1-A2   PIC X.
  3984                     30 CM-INSURED-INITIAL2-A2   PIC X.
  3985                 25 CM-PART-LAST-NAME-A2         PIC X.
  3986
  3987     12  CM-CONTROL-BY-CERT-NO.
  3988         16  CM-COMPANY-CD-A4              PIC X.
  3989         16  CM-CERT-NO-A4                 PIC X(11).
  3990
  3991     12  CM-CONTROL-BY-MEMB.
  3992         16  CM-COMPANY-CD-A5              PIC X.
  3993         16  CM-MEMBER-NO.
  3994             20  CM-MEMB-STATE             PIC XX.
  3995             20  CM-MEMB-ACCOUNT           PIC X(6).
  3996             20  CM-MEMB-LN4.
  3997                 25  CM-INSURED-INITIALS-A5.
  3998                     30 CM-INSURED-INITIAL1-A5   PIC X.
  3999                     30 CM-INSURED-INITIAL2-A5   PIC X.
  4000                 25 CM-PART-LAST-NAME-A5         PIC XX.
  4001
  4002     12  CM-INSURED-PROFILE-DATA.
  4003         16  CM-INSURED-FIRST-NAME.
  4004             20  CM-INSURED-1ST-INIT       PIC X.
  4005             20  FILLER                    PIC X(9).
  4006         16  CM-INSURED-ISSUE-AGE          PIC 99.
  4007         16  CM-INSURED-SEX                PIC X.
  4008             88  CM-SEX-MALE                  VALUE 'M'.
  4009             88  CM-SEX-FEMAL                 VALUE 'F'.
  4010         16  CM-INSURED-JOINT-AGE          PIC 99.
  4011         16  CM-JOINT-INSURED-NAME.
  4012             20  CM-JT-LAST-NAME           PIC X(15).
  4013             20  CM-JT-FIRST-NAME.
  4014                 24  CM-JT-1ST-INIT        PIC X.
  4015                 24  FILLER                PIC X(9).
  4016             20  CM-JT-INITIAL             PIC X.
  4017
  4018     12  CM-LIFE-DATA.
  4019         16  CM-LF-BENEFIT-CD              PIC XX.
  4020         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  4021         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  4022         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  4023         16  CM-LF-DEV-CODE                PIC XXX.
  4024         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4025         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  4026         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4027         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  4028         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4029         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4030         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  4031         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4032         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  4033         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4034         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4035         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  4036         16  cm-temp-epiq                  pic xx.
  4037             88  EPIQ-CLASS                  value 'EQ'.
  4038*        16  FILLER                        PIC XX.
  4039
  4040     12  CM-AH-DATA.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page  74
* EL131.cbl
  4041         16  CM-AH-BENEFIT-CD              PIC XX.
  4042         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  4043         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  4044         16  CM-AH-DEV-CODE                PIC XXX.
  4045         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4046         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  4047         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4048         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4049         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4050         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  4051         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  4052         16  CM-AH-PAID-THRU-DT            PIC XX.
  4053             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  4054         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4055         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  4056         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  4057         16  FILLER                        PIC X.
  4058
  4059     12  CM-LOAN-INFORMATION.
  4060         16  CM-LIVES                      PIC S9(7)     COMP-3.
  4061         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  4062                                           PIC S9(5)V99  COMP-3.
  4063         16  CM-BILLED                     PIC S9(7)     COMP-3.
  4064         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  4065         16  CM-PAY-FREQUENCY              PIC S99.
  4066         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  4067         16  CM-RATE-CLASS                 PIC XX.
  4068         16  CM-BENEFICIARY                PIC X(25).
  4069         16  CM-POLICY-FORM-NO             PIC X(12).
  4070         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  4071         16  CM-LAST-ADD-ON-DT             PIC XX.
  4072         16  CM-DEDUCTIBLE-AMOUNTS.
  4073             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  4074             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  4075         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4076             20  CM-RESIDENT-STATE         PIC XX.
  4077             20  CM-RATE-CODE              PIC X(4).
  4078             20  FILLER                    PIC XX.
  4079         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4080             20  CM-LOAN-OFFICER           PIC X(5).
  4081             20  FILLER                    PIC XXX.
  4082         16  CM-CSR-CODE                   PIC XXX.
  4083         16  CM-UNDERWRITING-CODE          PIC X.
  4084             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  4085         16  CM-POST-CARD-IND              PIC X.
  4086         16  CM-REF-INTERFACE-SW           PIC X.
  4087         16  CM-PREMIUM-TYPE               PIC X.
  4088             88  CM-SING-PRM                  VALUE '1'.
  4089             88  CM-O-B-COVERAGE              VALUE '2'.
  4090             88  CM-OPEN-END                  VALUE '3'.
  4091         16  CM-IND-GRP-TYPE               PIC X.
  4092             88  CM-INDIVIDUAL                VALUE 'I'.
  4093             88  CM-GROUP                     VALUE 'G'.
  4094         16  CM-SKIP-CODE                  PIC X.
  4095             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  4096             88  SKIP-JULY                    VALUE '1'.
  4097             88  SKIP-AUGUST                  VALUE '2'.
  4098             88  SKIP-SEPTEMBER               VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page  75
* EL131.cbl
  4099             88  SKIP-JULY-AUG                VALUE '4'.
  4100             88  SKIP-AUG-SEPT                VALUE '5'.
  4101             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  4102             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  4103             88  SKIP-JUNE                    VALUE '8'.
  4104             88  SKIP-JUNE-JULY               VALUE '9'.
  4105             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  4106             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  4107         16  CM-PAYMENT-MODE               PIC X.
  4108             88  PAY-MONTHLY                  VALUE SPACE.
  4109             88  PAY-WEEKLY                   VALUE '1'.
  4110             88  PAY-SEMI-MONTHLY             VALUE '2'.
  4111             88  PAY-BI-WEEKLY                VALUE '3'.
  4112             88  PAY-SEMI-ANUALLY             VALUE '4'.
  4113         16  CM-LOAN-NUMBER                PIC X(8).
  4114         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  4115         16  CM-OLD-LOF                    PIC XXX.
  4116*        16  CM-LOAN-OFFICER               PIC XXX.
  4117         16  CM-REIN-TABLE                 PIC XXX.
  4118         16  CM-SPECIAL-REIN-CODE          PIC X.
  4119         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  4120         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  4121         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  4122
  4123     12  CM-STATUS-DATA.
  4124         16  CM-ENTRY-STATUS               PIC X.
  4125         16  CM-ENTRY-DT                   PIC XX.
  4126
  4127         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  4128         16  CM-LF-CANCEL-DT               PIC XX.
  4129         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  4130
  4131         16  CM-LF-STATUS-AT-DEATH         PIC X.
  4132         16  CM-LF-DEATH-DT                PIC XX.
  4133         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  4134
  4135         16  CM-LF-CURRENT-STATUS          PIC X.
  4136             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4137                                                'M' '4' '5' '9'.
  4138             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  4139             88  CM-LF-POLICY-PENDING         VALUE '2'.
  4140             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  4141             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  4142             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  4143             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  4144             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4145             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  4146             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4147             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  4148             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  4149             88  CM-LF-DECLINED               VALUE 'D'.
  4150             88  CM-LF-VOIDED                 VALUE 'V'.
  4151
  4152         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  4153         16  CM-AH-CANCEL-DT               PIC XX.
  4154         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  4155
  4156         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page  76
* EL131.cbl
  4157         16  CM-AH-SETTLEMENT-DT           PIC XX.
  4158         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  4159
  4160         16  CM-AH-CURRENT-STATUS          PIC X.
  4161             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4162                                                'M' '4' '5' '9'.
  4163             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  4164             88  CM-AH-POLICY-PENDING         VALUE '2'.
  4165             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  4166             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  4167             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  4168             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  4169             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4170             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  4171             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4172             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  4173             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  4174             88  CM-AH-DECLINED               VALUE 'D'.
  4175             88  CM-AH-VOIDED                 VALUE 'V'.
  4176
  4177         16  CM-CLAIM-INTERFACE-SW         PIC X.
  4178             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  4179             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  4180             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  4181         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  4182
  4183         16  CM-ENTRY-BATCH                PIC X(6).
  4184         16  CM-LF-EXIT-BATCH              PIC X(6).
  4185         16  CM-AH-EXIT-BATCH              PIC X(6).
  4186         16  CM-LAST-MONTH-END             PIC XX.
  4187
  4188     12  CM-NOTE-SW                        PIC X.
  4189         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  4190         88  CERT-NOTES-PRESENT               VALUE '1'.
  4191         88  BILLING-NOTES-PRESENT            VALUE '2'.
  4192         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  4193         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  4194         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  4195         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  4196         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  4197     12  CM-COMP-EXCP-SW                   PIC X.
  4198         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  4199         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  4200     12  CM-INSURED-ADDRESS-SW             PIC X.
  4201         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  4202         88  INSURED-ADDR-PRESENT             VALUE '1'.
  4203
  4204*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  4205     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  4206     12  FILLER                            PIC X.
  4207
  4208*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  4209     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  4210     12  FILLER                            PIC X.
  4211*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  4212     12  CM-INT-ON-REFS                    PIC S9(7)V99   COMP-3.
  4213
  4214     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page  77
* EL131.cbl
  4215         88  CERT-ADDED-BATCH                 VALUE ' '.
  4216         88  CERT-ADDED-ONLINE                VALUE '1'.
  4217         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  4218         88  CERT-PURGED-OFFLINE              VALUE '3'.
  4219         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  4220     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  4221         88  CERT-AS-LOADED                   VALUE ' '.
  4222         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  4223         88  CERT-CLAIM-ONLINE                VALUE '2'.
  4224         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  4225         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  4226         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  4227         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  4228         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  4229
  4230     12  CM-ACCOUNT-COMM-PCTS.
  4231         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  4232         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  4233
  4234     12  CM-USER-FIELD                     PIC X.
  4235     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  4236     12  CM-CLP-STATE                      PIC XX.
  4237     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  4238     12  CM-USER-RESERVED                  PIC XXX.
  4239     12  FILLER REDEFINES CM-USER-RESERVED.
  4240         16  CM-AH-CLASS-CD                PIC XX.
  4241         16  F                             PIC X.
  4242******************************************************************
  4243
  4244*                                COPY ELCTRLR.
  4245******************************************************************
  4246*                                                                *
  4247*                            ELCTRLR.                            *
  4248*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4249*                            VMOD=2.014                          *
  4250*                                                                *
  4251*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  4252*                                                                *
  4253*   FILE TYPE = VSAM,KSDS                                        *
  4254*   RECORD SIZE = 200    RECFORM = FIXED                         *
  4255*                                                                *
  4256*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  4257*       ALTERNATE INDEX = NONE                                   *
  4258*                                                                *
  4259*   LOG = YES                                                    *
  4260*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4261******************************************************************
  4262*                   C H A N G E   L O G
  4263*
  4264* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4265*-----------------------------------------------------------------
  4266*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4267* EFFECTIVE    NUMBER
  4268*-----------------------------------------------------------------
  4269* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  4270* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
  4271* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
  4272* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page  78
* EL131.cbl
  4273* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  4274* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  4275* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  4276* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
  4277* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  4278* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  4279* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  4280* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  4281* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAIL
  4282* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
  4283* 021213    2012092400007  AJRA  CAUSAL STATE SEQUENCE NO
  4284* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  4285* 102413  CR2013100800001  AJRA  ADD SPECIAL RELEASE IND
  4286* 022614    2013050100003  AJRA  ADD CERT CANCELLED NOTE TYPE - T
  4287* 040814    2014030500002  AJRA  ADD ICD CODES
  4288* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  4289* 013017  CR2016053100001  PEMA  ACH PROCESSING
  4290* 062217  CR2017050300002  TANA  ADD AUTH RCVD
  4291* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  4292* 102418  CR2018083000001  TANA  ADD ADD NEW CALL TYPE
  4293******************************************************************
  4294 01  ACTIVITY-TRAILERS.
  4295     12  AT-RECORD-ID                    PIC XX.
  4296         88  VALID-AT-ID                       VALUE 'AT'.
  4297
  4298     12  AT-CONTROL-PRIMARY.
  4299         16  AT-COMPANY-CD               PIC X.
  4300         16  AT-CARRIER                  PIC X.
  4301         16  AT-CLAIM-NO                 PIC X(7).
  4302         16  AT-CERT-NO.
  4303             20  AT-CERT-PRIME           PIC X(10).
  4304             20  AT-CERT-SFX             PIC X.
  4305         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
  4306             88  AT-1ST-TRL-AVAIL             VALUE +4095.
  4307             88  AT-LAST-TRL-AVAIL            VALUE +100.
  4308             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
  4309             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
  4310             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
  4311             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  4312             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
  4313             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
  4314             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  4315             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  4316             88  AT-DIAGNOSIS-TRL             VALUE +90.
  4317             88  AT-BENEFICIARY-TRL           VALUE +91.
  4318             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  4319             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
  4320             88  AT-VFY-CAUSAL-STATE          VALUE +94.
  4321             88  AT-ERROR-MSGS-TRL            VALUE +95.
  4322
  4323     12  AT-TRAILER-TYPE                 PIC X.
  4324         88  RESERVE-EXPENSE-TR               VALUE '1'.
  4325         88  PAYMENT-TR                       VALUE '2'.
  4326         88  AUTO-PAY-TR                      VALUE '3'.
  4327         88  CORRESPONDENCE-TR                VALUE '4'.
  4328         88  ADDRESS-TR                       VALUE '5'.
  4329         88  GENERAL-INFO-TR                  VALUE '6'.
  4330         88  AUTO-PROMPT-TR                   VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page  79
* EL131.cbl
  4331         88  DENIAL-TR                        VALUE '8'.
  4332         88  INCURRED-CHG-TR                  VALUE '9'.
  4333         88  FORM-CONTROL-TR                  VALUE 'A'.
  4334
  4335     12  AT-RECORDED-DT                  PIC XX.
  4336     12  AT-RECORDED-BY                  PIC X(4).
  4337     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  4338
  4339     12  AT-TRAILER-BODY                 PIC X(165).
  4340
  4341     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  4342         16  AT-RESERVE-CONTROLS.
  4343             20  AT-MANUAL-SW            PIC X.
  4344                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  4345             20  AT-FUTURE-SW            PIC X.
  4346                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  4347             20  AT-PTC-SW               PIC X.
  4348                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  4349             20  AT-IBNR-SW              PIC X.
  4350                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  4351             20  AT-PTC-LF-SW            PIC X.
  4352                 88  AT-LF-PTC-USED          VALUE '1'.
  4353             20  AT-CDT-ACCESS-METHOD    PIC X.
  4354                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  4355                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  4356                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  4357             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
  4358         16  AT-LAST-COMPUTED-DT         PIC XX.
  4359         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
  4360         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
  4361         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
  4362         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  4363         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  4364         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
  4365         16  AT-EXPENSE-CONTROLS.
  4366             20  AT-EXPENSE-METHOD       PIC X.
  4367                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
  4368                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  4369                 88  PERCENT-OF-PMT           VALUE '3'.
  4370                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  4371             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  4372             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
  4373         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  4374         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
  4375
  4376         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  4377         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  4378
  4379*        16  FILLER                      PIC X(53).
  4380         16  FILLER                      PIC X(47).
  4381
  4382         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  4383         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  4384
  4385         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  4386             20  AT-OPEN-CLOSE-DATE      PIC XX.
  4387             20  AT-OPEN-CLOSE-TYPE      PIC X.
  4388*                    C = CLOSED
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page  80
* EL131.cbl
  4389*                    O = OPEN
  4390             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  4391*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  4392
  4393     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  4394         16  AT-PAYMENT-TYPE             PIC X.
  4395             88  PARTIAL-PAYMENT                VALUE '1'.
  4396             88  FINAL-PAYMENT                  VALUE '2'.
  4397             88  LUMP-SUM-PAYMENT               VALUE '3'.
  4398             88  ADDITIONAL-PAYMENT             VALUE '4'.
  4399             88  CHARGEABLE-EXPENSE             VALUE '5'.
  4400             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  4401             88  VOIDED-PAYMENT                 VALUE '9'.
  4402             88  TRANSFER                       VALUE 'T'.
  4403             88  LIFE-INTEREST                  VALUE 'I'.
  4404
  4405         16  AT-CLAIM-TYPE               PIC X.
  4406             88  PAID-FOR-AH                    VALUE 'A'.
  4407             88  PAID-FOR-LIFE                  VALUE 'L'.
  4408             88  PAID-FOR-IUI                   VALUE 'I'.
  4409             88  PAID-FOR-GAP                   VALUE 'G'.
  4410             88  PAID-FOR-FAM                   VALUE 'F'.
  4411             88  PAID-FOR-OTH                   VALUE 'O'.
  4412         16  AT-CLAIM-PREM-TYPE          PIC X.
  4413             88  AT-SINGLE-PREMIUM              VALUE '1'.
  4414             88  AT-O-B-COVERAGE                VALUE '2'.
  4415             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  4416         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
  4417         16  AT-CHECK-NO                 PIC X(7).
  4418         16  AT-PAID-FROM-DT             PIC XX.
  4419         16  AT-PAID-THRU-DT             PIC XX.
  4420         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
  4421         16  AT-ACH-PAYMENT              PIC X.
  4422*        16  FILLER                      PIC X.
  4423         16  AT-PAYEES-NAME              PIC X(30).
  4424         16  AT-PAYMENT-ORIGIN           PIC X.
  4425             88  ONLINE-MANUAL-PMT              VALUE '1'.
  4426             88  ONLINE-AUTO-PMT                VALUE '2'.
  4427             88  OFFLINE-PMT                    VALUE '3'.
  4428         16  AT-CHECK-WRITTEN-DT         PIC XX.
  4429         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  4430         16  AT-VOID-DATA.
  4431             20  AT-VOID-DT              PIC XX.
  4432*00144       20  AT-VOID-REASON          PIC X(30).
  4433             20  AT-VOID-REASON          PIC X(26).
  4434         16  AT-PMT-APPROVED-BY          PIC X(04).
  4435         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
  4436         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  4437         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  4438                                         PIC S99V9(5)  COMP-3.
  4439         16  AT-CREDIT-INTERFACE.
  4440             20  AT-PMT-SELECT-DT        PIC XX.
  4441                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  4442             20  AT-PMT-ACCEPT-DT        PIC XX.
  4443                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  4444             20  AT-VOID-SELECT-DT       PIC XX.
  4445                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  4446             20  AT-VOID-ACCEPT-DT       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page  81
* EL131.cbl
  4447                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
  4448
  4449         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
  4450                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  4451                 88  CONVERSION-PAYMENT           VALUE +99999999.
  4452         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  4453
  4454         16  AT-FORCE-CONTROL            PIC X.
  4455             88  PAYMENT-WAS-FORCED           VALUE '1'.
  4456         16  AT-PREV-LAST-PMT-DT         PIC XX.
  4457         16  AT-PREV-PAID-THRU-DT        PIC XX.
  4458         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  4459         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  4460         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  4461         16  AT-BENEFIT-TYPE             PIC X.
  4462
  4463         16  AT-EXPENSE-TYPE             PIC X.
  4464         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  4465
  4466         16  AT-PAYEE-TYPE-CD.
  4467             20  AT-PAYEE-TYPE           PIC X.
  4468                 88  INSURED-PAID           VALUE 'I'.
  4469                 88  BENEFICIARY-PAID       VALUE 'B'.
  4470                 88  ACCOUNT-PAID           VALUE 'A'.
  4471                 88  OTHER-1-PAID           VALUE 'O'.
  4472                 88  OTHER-2-PAID           VALUE 'Q'.
  4473                 88  DOCTOR-PAID            VALUE 'P'.
  4474                 88  EMPLOYER-PAID          VALUE 'E'.
  4475             20  AT-PAYEE-SEQ            PIC X.
  4476
  4477         16  AT-CASH-PAYMENT             PIC X.
  4478         16  AT-GROUPED-PAYMENT          PIC X.
  4479         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
  4480         16  AT-APPROVAL-LEVEL-REQD      PIC X.
  4481         16  AT-APPROVED-LEVEL           PIC X.
  4482         16  AT-VOID-TYPE                PIC X.
  4483             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
  4484             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
  4485         16  AT-AIG-UNEMP-IND            PIC X.
  4486             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
  4487         16  AT-ASSOCIATES               PIC X.
  4488             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
  4489             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  4490
  4491         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
  4492         16  AT-CV-PMT-CODE              PIC X.
  4493             88  FULL-DEATH-PAYMENT         VALUE '1'.
  4494             88  HALF-DEATH-PAYMENT         VALUE '2'.
  4495             88  FULL-ADD-PAYMENT           VALUE '3'.
  4496             88  HALF-ADD-PAYMENT           VALUE '4'.
  4497             88  FULL-RIDER-PAYMENT         VALUE '5'.
  4498             88  HALF-RIDER-PAYMENT         VALUE '6'.
  4499             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  4500             88  ADDL-PAYMENT               VALUE '8'.
  4501
  4502         16  AT-EOB-CODE1                PIC XXX.
  4503         16  AT-EOB-CODE2                PIC XXX.
  4504         16  AT-EOB-CODE3                PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page  82
* EL131.cbl
  4505         16  FILLER REDEFINES AT-EOB-CODE3.
  4506             20  AT-PRINT-CLM-FORM       PIC X.
  4507             20  AT-PRINT-SURVEY         PIC X.
  4508             20  AT-SPECIAL-RELEASE      PIC X.
  4509         16  AT-EOB-CODE4                PIC XXX.
  4510         16  FILLER REDEFINES AT-EOB-CODE4.
  4511             20  AT-INT-PMT-SELECT-DT    PIC XX.
  4512             20  FILLER                  PIC X.
  4513         16  AT-EOB-CODE5                PIC XXX.
  4514         16  FILLER REDEFINES AT-EOB-CODE5.
  4515             20  AT-PMT-PROOF-DT         PIC XX.
  4516             20  FILLER                  PIC X.
  4517
  4518         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  4519             88  AT-PRINT-EOB            VALUE 'Y'.
  4520
  4521         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  4522         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  4523
  4524     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  4525         16  AT-SCHEDULE-START-DT        PIC XX.
  4526         16  AT-SCHEDULE-END-DT          PIC XX.
  4527         16  AT-TERMINATED-DT            PIC XX.
  4528         16  AT-LAST-PMT-TYPE            PIC X.
  4529             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  4530             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  4531         16  AT-FIRST-PMT-DATA.
  4532             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
  4533             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
  4534             20  AT-1ST-PAY-THRU-DT      PIC XX.
  4535         16  AT-REGULAR-PMT-DATA.
  4536             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
  4537             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
  4538             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
  4539         16  AT-AUTO-PAYEE-CD.
  4540             20  AT-AUTO-PAYEE-TYPE      PIC X.
  4541                 88  INSURED-PAID-AUTO      VALUE 'I'.
  4542                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
  4543                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
  4544                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
  4545                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  4546             20  AT-AUTO-PAYEE-SEQ       PIC X.
  4547         16  AT-AUTO-PAY-DAY             PIC 99.
  4548         16  AT-AUTO-CASH                PIC X.
  4549             88  AT-CASH                      VALUE 'Y'.
  4550             88  AT-NON-CASH                  VALUE 'N'.
  4551*        16  FILLER                      PIC X(129).
  4552         16  AT-AUTO-END-LETTER          PIC X(4).
  4553         16  FILLER                      PIC X(125).
  4554
  4555         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
  4556         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  4557
  4558     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  4559         16  AT-LETTER-SENT-DT           PIC XX.
  4560         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  4561         16  AT-AUTO-RE-SEND-DT          PIC XX.
  4562         16  AT-LETTER-ANSWERED-DT       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page  83
* EL131.cbl
  4563         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  4564         16  AT-LETTER-ORIGIN            PIC X.
  4565             88  ONLINE-CREATION              VALUE '1' '3'.
  4566             88  OFFLINE-CREATION             VALUE '2' '4'.
  4567             88  NAPER-ONLINE-CREATION        VALUE '3'.
  4568             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  4569         16  AT-STD-LETTER-FORM          PIC X(4).
  4570         16  AT-REASON-TEXT              PIC X(70).
  4571         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  4572         16  AT-ADDRESEE-TYPE            PIC X.
  4573              88  INSURED-ADDRESEE            VALUE 'I'.
  4574              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  4575              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  4576              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  4577              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  4578              88  OTHER-ADDRESEE-1            VALUE 'O'.
  4579              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  4580         16  AT-ADDRESSEE-NAME           PIC X(30).
  4581         16  AT-INITIAL-PRINT-DATE       PIC XX.
  4582         16  AT-RESEND-PRINT-DATE        PIC XX.
  4583         16  AT-CORR-SOL-UNSOL           PIC X.
  4584         16  AT-LETTER-PURGED-DT         PIC XX.
  4585*
  4586*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  4587*
  4588         16  AT-CSO-REDEFINITION.
  4589             20  AT-RESEND-LETTER-FORM   PIC X(4).
  4590             20  AT-AUTO-CLOSE-IND       PIC X(1).
  4591             20  AT-LETTER-TO-BENE       PIC X(1).
  4592             20  AT-STOP-LETTER-DT       PIC X(2).
  4593             20  AT-AUTH-RCVD            PIC X(1).
  4594             20  FILLER                  PIC X(18).
  4595*             20  FILLER                  PIC X(27).
  4596             20  AT-CSO-LETTER-STATUS    PIC X.
  4597                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  4598                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
  4599                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  4600             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
  4601             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  4602*
  4603*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  4604*
  4605*        16  FILLER                      PIC X(26).
  4606*
  4607*        16  AT-DMD-BSR-CODE             PIC X.
  4608*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  4609*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  4610*
  4611*        16  AT-DMD-LETTER-STATUS        PIC X.
  4612*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
  4613*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  4614*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
  4615*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  4616*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  4617
  4618         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  4619         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  4620
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page  84
* EL131.cbl
  4621     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  4622         16  AT-ADDRESS-TYPE             PIC X.
  4623             88  INSURED-ADDRESS               VALUE 'I'.
  4624             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  4625             88  ACCOUNT-ADDRESS               VALUE 'A'.
  4626             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  4627             88  EMPLOYER-ADDRESS              VALUE 'E'.
  4628             88  OTHER-ADDRESS-1               VALUE 'O'.
  4629             88  OTHER-ADDRESS-2               VALUE 'Q'.
  4630         16  AT-MAIL-TO-NAME             PIC X(30).
  4631         16  AT-ADDRESS-LINE-1           PIC X(30).
  4632         16  AT-ADDRESS-LINE-2           PIC X(30).
  4633         16  AT-CITY-STATE.
  4634             20  AT-CITY                 PIC X(28).
  4635             20  AT-STATE                PIC XX.
  4636         16  AT-ZIP.
  4637             20  AT-ZIP-CODE.
  4638                 24  AT-ZIP-1ST          PIC X.
  4639                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4640                 24  FILLER              PIC X(4).
  4641             20  AT-ZIP-PLUS4            PIC X(4).
  4642         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  4643             20  AT-CAN-POSTAL-1         PIC XXX.
  4644             20  AT-CAN-POSTAL-2         PIC XXX.
  4645             20  FILLER                  PIC XXX.
  4646         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  4647*         16  FILLER                      PIC X(23).
  4648         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
  4649         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
  4650         16  FILLER                      PIC X(13).
  4651         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  4652         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
  4653
  4654     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  4655         16  AT-INFO-LINE-1              PIC X(60).
  4656         16  FILLER REDEFINES AT-INFO-LINE-1.
  4657             20  AT-NOTE-ERROR-NO OCCURS 15
  4658                                         PIC X(4).
  4659         16  AT-INFO-LINE-2              PIC X(60).
  4660         16  FILLER REDEFINES AT-INFO-LINE-2.
  4661             20  AT-ICD-CODE-1           PIC X(8).
  4662             20  AT-ICD-CODE-2           PIC X(8).
  4663             20  FILLER                  PIC X(44).
  4664         16  AT-INFO-TRAILER-TYPE        PIC X.
  4665             88  AT-ERRORS-NOTE          VALUE 'E'.
  4666             88  AT-PAYMENT-NOTE         VALUE 'P'.
  4667             88  AT-CALL-NOTE            VALUE 'C'.
  4668             88  AT-MAINT-NOTE           VALUE 'M'.
  4669             88  AT-CERT-CHANGE          VALUE 'X'.
  4670             88  AT-APPROVAL-NOTE        VALUE 'R'.
  4671             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  4672             88  AT-CERT-CANCELLED       VALUE 'T'.
  4673         16  AT-CALL-TYPE                PIC X.
  4674             88  AT-PHONE-CALL-IN        VALUE 'I'.
  4675             88  AT-PHONE-CALL-NEW       VALUE 'N'.
  4676             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  4677         16  AT-NOTE-CONTINUATION        PIC X.
  4678             88  AT-CONTINUED-NOTE       VALUE 'X'.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page  85
* EL131.cbl
  4679         16  AT-EOB-CODES-EXIST          PIC X.
  4680             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
  4681         16  FILLER                      PIC X(35).
  4682         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  4683         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  4684
  4685     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
  4686         16  AT-PROMPT-LINE-1            PIC X(60).
  4687         16  AT-PROMPT-LINE-2            PIC X(60).
  4688         16  AT-PROMPT-START-DT          PIC XX.
  4689         16  AT-PROMPT-END-DT            PIC XX.
  4690         16  FILLER                      PIC X(35).
  4691         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  4692         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  4693
  4694     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  4695         16  AT-DENIAL-INFO-1            PIC X(60).
  4696         16  AT-DENIAL-INFO-2            PIC X(60).
  4697         16  AT-DENIAL-DT                PIC XX.
  4698         16  AT-RETRACTION-DT            PIC XX.
  4699         16  AT-DENIAL-REASON-CODE       PIC X(4).
  4700*         16  FILLER                      PIC X(31).
  4701         16  AT-DENIAL-PROOF-DT          PIC XX.
  4702         16  FILLER                      PIC X(29).
  4703         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  4704         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  4705
  4706     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  4707         16  AT-OLD-INCURRED-DT          PIC XX.
  4708         16  AT-OLD-REPORTED-DT          PIC XX.
  4709         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  4710         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  4711         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
  4712         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  4713         16  AT-OLD-PAID-THRU-DT         PIC XX.
  4714         16  AT-LAST-PMT-MADE-DT         PIC XX.
  4715         16  FILLER                      PIC X(26).
  4716         16  AT-OLD-DIAG-CODE            PIC X(6).
  4717         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  4718         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  4719         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  4720         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  4721         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  4722         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  4723         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  4724         16  AT-OLD-ICD-CODE-1           PIC X(8).
  4725         16  AT-OLD-ICD-CODE-2           PIC X(8).
  4726         16  FILLER                      PIC X(9).
  4727         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  4728
  4729     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  4730         16  AT-FORM-SEND-ON-DT          PIC XX.
  4731         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  4732         16  AT-FORM-RE-SEND-DT          PIC XX.
  4733         16  AT-FORM-ANSWERED-DT         PIC XX.
  4734         16  AT-FORM-PRINTED-DT          PIC XX.
  4735         16  AT-FORM-REPRINT-DT          PIC XX.
  4736         16  AT-FORM-TYPE                PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page  86
* EL131.cbl
  4737             88  INITIAL-FORM                  VALUE '1'.
  4738             88  PROGRESS-FORM                 VALUE '2'.
  4739         16  AT-INSTRUCT-LN-1            PIC X(28).
  4740         16  AT-INSTRUCT-LN-2            PIC X(28).
  4741         16  AT-INSTRUCT-LN-3            PIC X(28).
  4742         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  4743         16  AT-FORM-ADDRESS             PIC X.
  4744             88  FORM-TO-INSURED              VALUE 'I'.
  4745             88  FORM-TO-ACCOUNT              VALUE 'A'.
  4746             88  FORM-TO-OTHER-1              VALUE 'O'.
  4747             88  FORM-TO-OTHER-2              VALUE 'Q'.
  4748         16  AT-RELATED-1.
  4749             20 AT-REL-CARR-1            PIC X.
  4750             20 AT-REL-CLAIM-1           PIC X(7).
  4751             20 AT-REL-CERT-1            PIC X(11).
  4752         16  AT-RELATED-2.
  4753             20 AT-REL-CARR-2            PIC X.
  4754             20 AT-REL-CLAIM-2           PIC X(7).
  4755             20 AT-REL-CERT-2            PIC X(11).
  4756         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  4757         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  4758         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  4759         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  4760         16  AT-FORM-REM-PRINT-DT        PIC XX.
  4761         16  AT-STOP-FORM-DT             PIC X(2).
  4762
  4763         16  FILLER                      PIC X(09).
  4764         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  4765         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
  4766******************************************************************
  4767
  4768*                                COPY ELCCNTL.
  4769******************************************************************
  4770*                                                                *
  4771*                                                                *
  4772*                            ELCCNTL.                            *
  4773*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4774*                            VMOD=2.059                          *
  4775*                                                                *
  4776*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  4777*                                                                *
  4778*   FILE TYPE = VSAM,KSDS                                        *
  4779*   RECORD SIZE = 750  RECFORM = FIXED                           *
  4780*                                                                *
  4781*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  4782*       ALTERNATE INDEX = NONE                                   *
  4783*                                                                *
  4784*   LOG = YES                                                    *
  4785*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4786******************************************************************
  4787*                   C H A N G E   L O G
  4788*
  4789* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4790*-----------------------------------------------------------------
  4791*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4792* EFFECTIVE    NUMBER
  4793*-----------------------------------------------------------------
  4794* 082503                   PEMA  ADD BENEFIT GROUP
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page  87
* EL131.cbl
  4795* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4796* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  4797* 092705    2005050300006  PEMA  ADD SPP LEASES
  4798* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  4799* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  4800* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  4801* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  4802* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  4803* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  4804* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  4805* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  4806* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  4807* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  4808* 102717  CR2017062000003  PEMA  COMM CAP CHANGES
  4809******************************************************************
  4810*
  4811 01  CONTROL-FILE.
  4812     12  CF-RECORD-ID                       PIC XX.
  4813         88  VALID-CF-ID                        VALUE 'CF'.
  4814
  4815     12  CF-CONTROL-PRIMARY.
  4816         16  CF-COMPANY-ID                  PIC XXX.
  4817         16  CF-RECORD-TYPE                 PIC X.
  4818             88  CF-COMPANY-MASTER              VALUE '1'.
  4819             88  CF-PROCESSOR-MASTER            VALUE '2'.
  4820             88  CF-STATE-MASTER                VALUE '3'.
  4821             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  4822             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  4823             88  CF-CARRIER-MASTER              VALUE '6'.
  4824             88  CF-MORTALITY-MASTER            VALUE '7'.
  4825             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  4826             88  CF-TERMINAL-MASTER             VALUE '9'.
  4827             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  4828             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  4829             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  4830             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  4831             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  4832             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  4833             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  4834             88  CF-REMINDERS-MASTER            VALUE 'R'.
  4835             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  4836         16  CF-ACCESS-CD-GENL              PIC X(4).
  4837         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  4838             20  CF-PROCESSOR               PIC X(4).
  4839         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  4840             20  CF-STATE-CODE              PIC XX.
  4841             20  FILLER                     PIC XX.
  4842         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  4843             20  FILLER                     PIC XX.
  4844             20  CF-HI-BEN-IN-REC           PIC XX.
  4845         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  4846             20  FILLER                     PIC XXX.
  4847             20  CF-CARRIER-CNTL            PIC X.
  4848         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  4849             20  FILLER                     PIC XX.
  4850             20  CF-HI-TYPE-IN-REC          PIC 99.
  4851         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  4852             20  CF-CRDB-TABLE-INDICATOR    PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page  88
* EL131.cbl
  4853                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  4854             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  4855             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  4856         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  4857             20  FILLER                     PIC X.
  4858             20  CF-CUSTOM-REPORT-NO        PIC 999.
  4859         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  4860             20  FILLER                     PIC XX.
  4861             20  CF-MORTGAGE-PLAN           PIC XX.
  4862         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  4863
  4864     12  CF-LAST-MAINT-DT                   PIC XX.
  4865     12  CF-LAST-MAINT-BY                   PIC X(4).
  4866     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  4867
  4868     12  CF-RECORD-BODY                     PIC X(728).
  4869
  4870
  4871****************************************************************
  4872*             COMPANY MASTER RECORD                            *
  4873****************************************************************
  4874
  4875     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4876         16  CF-COMPANY-ADDRESS.
  4877             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  4878             20  CF-CL-IN-CARE-OF           PIC X(30).
  4879             20  CF-CL-ADDR-LINE-1          PIC X(30).
  4880             20  CF-CL-ADDR-LINE-2          PIC X(30).
  4881             20  CF-CL-CITY-STATE           PIC X(30).
  4882             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  4883             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  4884         16  CF-COMPANY-CD                  PIC X.
  4885         16  CF-COMPANY-PASSWORD            PIC X(8).
  4886         16  CF-SECURITY-OPTION             PIC X.
  4887             88  ALL-SECURITY                   VALUE '1'.
  4888             88  COMPANY-VERIFY                 VALUE '2'.
  4889             88  PROCESSOR-VERIFY               VALUE '3'.
  4890             88  NO-SECURITY                    VALUE '4'.
  4891             88  ALL-BUT-TERM                   VALUE '5'.
  4892         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  4893             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  4894         16  CF-LGX-INTERFACE-CNTL          PIC X.
  4895             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  4896         16  CF-INFORCE-LOCATION            PIC X.
  4897             88  CERTS-ARE-ONLINE               VALUE '1'.
  4898             88  CERTS-ARE-OFFLINE              VALUE '2'.
  4899             88  NO-CERTS-AVAILABLE             VALUE '3'.
  4900         16  CF-LOWER-CASE-LETTERS          PIC X.
  4901         16  CF-CERT-ACCESS-CONTROL         PIC X.
  4902             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  4903             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  4904             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  4905             88  CF-ACCNT-CNTL                  VALUE '3'.
  4906             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  4907
  4908         16  CF-FORMS-PRINTER-ID            PIC X(4).
  4909         16  CF-CHECK-PRINTER-ID            PIC X(4).
  4910
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page  89
* EL131.cbl
  4911         16  CF-LGX-CREDIT-USER             PIC X.
  4912             88  CO-IS-NOT-USER                 VALUE 'N'.
  4913             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  4914
  4915         16 CF-CREDIT-CALC-CODES.
  4916             20  CF-CR-REM-TERM-CALC PIC X.
  4917               88  CR-EARN-AFTER-15TH           VALUE '1'.
  4918               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  4919               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  4920               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  4921               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  4922               88  CR-EARN-AFTER-14TH           VALUE '6'.
  4923               88  CR-EARN-AFTER-16TH           VALUE '7'.
  4924             20  CF-CR-R78-METHOD           PIC X.
  4925               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  4926               88  DONT-USE-PLUS-ONE            VALUE '1'.
  4927
  4928         16  CF-CLAIM-CONTROL-COUNTS.
  4929             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  4930                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  4931
  4932             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  4933                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  4934
  4935             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  4936                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  4937
  4938             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  4939                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  4940
  4941         16  CF-CURRENT-MONTH-END           PIC XX.
  4942
  4943         16  CF-CO-CALC-QUOTE-TOLERANCE.
  4944             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  4945             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  4946             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  4947             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  4948                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4949                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4950             20  CF-CO-PREM-REJECT-SW       PIC X.
  4951                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  4952                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  4953             20  CF-CO-REF-REJECT-SW        PIC X.
  4954                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  4955                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  4956
  4957         16  CF-CO-REPORTING-DT             PIC XX.
  4958         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  4959         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  4960           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  4961           88  CF-CO-MONTH-END                  VALUE '1'.
  4962
  4963         16  CF-LGX-CLAIM-USER              PIC X.
  4964             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  4965             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  4966
  4967         16  CF-CREDIT-EDIT-CONTROLS.
  4968             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page  90
* EL131.cbl
  4969             20  CF-MIN-AGE                 PIC 99.
  4970             20  CF-DEFAULT-AGE             PIC 99.
  4971             20  CF-MIN-TERM                PIC S999      COMP-3.
  4972             20  CF-MAX-TERM                PIC S999      COMP-3.
  4973             20  CF-DEFAULT-SEX             PIC X.
  4974             20  CF-JOINT-AGE-INPUT         PIC X.
  4975                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  4976             20  CF-BIRTH-DATE-INPUT        PIC X.
  4977                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  4978             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  4979                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  4980                 88  CF-ZERO-CARRIER            VALUE '1'.
  4981                 88  CF-ZERO-GROUPING           VALUE '2'.
  4982                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  4983             20  CF-EDIT-SW                 PIC X.
  4984                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  4985             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  4986             20  CF-CR-PR-METHOD            PIC X.
  4987               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  4988               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  4989             20  FILLER                     PIC X.
  4990
  4991         16  CF-CREDIT-MISC-CONTROLS.
  4992             20  CF-REIN-TABLE-SW           PIC X.
  4993                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  4994             20  CF-COMP-TABLE-SW           PIC X.
  4995                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  4996             20  CF-EXPERIENCE-RETENTION-AGE
  4997                                            PIC S9        COMP-3.
  4998             20  CF-CONVERSION-DT           PIC XX.
  4999             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  5000             20  CF-RUN-FREQUENCY-SW        PIC X.
  5001                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  5002                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  5003
  5004             20  CF-CR-CHECK-NO-CONTROL.
  5005                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  5006                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  5007                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  5008                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  5009                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  5010                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  5011
  5012                 24  CF-CR-CHECK-COUNT       REDEFINES
  5013                     CF-CR-CHECK-COUNTER      PIC X(4).
  5014
  5015                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  5016                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  5017
  5018                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  5019                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  5020                 24  CF-MAIL-PROCESSING       PIC X.
  5021                     88  MAIL-PROCESSING          VALUE 'Y'.
  5022
  5023         16  CF-MISC-SYSTEM-CONTROL.
  5024             20  CF-SYSTEM-C                 PIC X.
  5025                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  5026             20  CF-SYSTEM-D                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page  91
* EL131.cbl
  5027                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  5028             20  CF-SOC-SEC-NO-SW            PIC X.
  5029                 88  SOC-SEC-NO-USED             VALUE '1'.
  5030             20  CF-MEMBER-NO-SW             PIC X.
  5031                 88  MEMBER-NO-USED              VALUE '1'.
  5032             20  CF-TAX-ID-NUMBER            PIC X(11).
  5033             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  5034             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  5035                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  5036                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  5037                 88  CF-ALL-APPROVED             VALUE 'Y'.
  5038                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  5039             20  CF-SYSTEM-E                 PIC X.
  5040                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  5041
  5042         16  CF-LGX-LIFE-USER               PIC X.
  5043             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  5044             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  5045
  5046         16  CF-CR-MONTH-END-DT             PIC XX.
  5047
  5048         16  CF-FILE-MAINT-DATES.
  5049             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  5050                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  5051             20  CF-LAST-BATCH       REDEFINES
  5052                 CF-LAST-BATCH-NO               PIC X(4).
  5053             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  5054             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  5055             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  5056             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  5057             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  5058             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  5059             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  5060             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  5061             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  5062             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  5063
  5064         16  CF-NEXT-COMPANY-ID             PIC XXX.
  5065         16  FILLER                         PIC X.
  5066
  5067         16  CF-ALT-MORT-CODE               PIC X(4).
  5068         16  CF-MEMBER-CAPTION              PIC X(10).
  5069
  5070         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  5071             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  5072             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  5073             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  5074             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  5075             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  5076
  5077         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  5078
  5079         16  CF-LIFE-OVERRIDE-L1            PIC X.
  5080         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  5081         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  5082         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  5083
  5084         16  CF-AH-OVERRIDE-L1              PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page  92
* EL131.cbl
  5085         16  CF-AH-OVERRIDE-L2              PIC XX.
  5086         16  CF-AH-OVERRIDE-L6              PIC X(6).
  5087         16  CF-AH-OVERRIDE-L12             PIC X(12).
  5088
  5089         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  5090         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  5091
  5092         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  5093         16  CF-AR-LAST-EL860-DT            PIC XX.
  5094         16  CF-MP-MONTH-END-DT             PIC XX.
  5095
  5096         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  5097         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  5098             88  CF-CLAIM-PAID-TO               VALUE '1'.
  5099
  5100         16  CF-AR-MONTH-END-DT             PIC XX.
  5101
  5102         16  CF-CRDTCRD-USER                PIC X.
  5103             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  5104             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  5105
  5106         16  CF-CC-MONTH-END-DT             PIC XX.
  5107
  5108         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  5109
  5110         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  5111             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  5112             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  5113             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  5114         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  5115         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  5116         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  5117         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  5118             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  5119             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  5120         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  5121         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  5122         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  5123             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  5124         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  5125
  5126         16  CF-CL-ZIP-CODE.
  5127             20  CF-CL-ZIP-PRIME.
  5128                 24  CF-CL-ZIP-1ST          PIC X.
  5129                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  5130                 24  FILLER                 PIC X(4).
  5131             20  CF-CL-ZIP-PLUS4            PIC X(4).
  5132         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  5133             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  5134             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  5135             20  FILLER                     PIC XXX.
  5136
  5137         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  5138         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  5139         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  5140         16  CF-CO-OPTION-START-DATE        PIC XX.
  5141         16  CF-REM-TRM-CALC-OPTION         PIC X.
  5142           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page  93
* EL131.cbl
  5143                                                      '3' '4'.
  5144           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  5145           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  5146           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  5147           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  5148           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  5149           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  5150
  5151         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  5152
  5153         16  CF-PAYMENT-APPROVAL-LEVELS.
  5154             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  5155             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  5156             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  5157             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  5158             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  5159             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  5160
  5161         16  CF-END-USER-REPORTING-USER     PIC X.
  5162             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  5163             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  5164
  5165         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  5166             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  5167             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  5168
  5169         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  5170
  5171         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  5172         16  FILLER                         PIC X.
  5173
  5174         16  CF-CREDIT-ARCHIVE-CNTL.
  5175             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  5176             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  5177             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  5178
  5179         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  5180
  5181         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  5182             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  5183             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  5184
  5185         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  5186             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  5187             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  5188
  5189         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  5190
  5191         16  CF-CO-ACH-ID-CODE              PIC  X.
  5192             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  5193             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  5194             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  5195         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  5196         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  5197         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  5198         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  5199         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  5200         16  CF-CO-ACH-RECV-NO              PIC X(08).
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page  94
* EL131.cbl
  5201         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  5202         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  5203         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  5204                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  5205         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  5206                 CF-CO-ACH-TRACE-NO         PIC X(4).
  5207
  5208         16  CF-CO-OVER-SHORT.
  5209             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5210             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5211
  5212*         16  FILLER                         PIC X(102).
  5213         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  5214             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  5215             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  5216
  5217         16  CF-AH-APPROVAL-DAYS.
  5218             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  5219             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  5220             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  5221             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  5222
  5223         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  5224
  5225         16  CF-APPROV-LEV-5.
  5226             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  5227             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  5228             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  5229
  5230         16  FILLER                         PIC X(68).
  5231****************************************************************
  5232*             PROCESSOR/USER RECORD                            *
  5233****************************************************************
  5234
  5235     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5236         16  CF-PROCESSOR-NAME              PIC X(30).
  5237         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  5238         16  CF-PROCESSOR-TITLE             PIC X(26).
  5239         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  5240                 88  MESSAGE-YES                VALUE 'Y'.
  5241                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  5242
  5243*****************************************************
  5244****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  5245****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  5246****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  5247****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  5248*****************************************************
  5249
  5250         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  5251             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  5252             20  CF-APPLICATION-FORCE       PIC X.
  5253             20  CF-INDIVIDUAL-APP.
  5254                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  5255                     28  CF-BROWSE-APP      PIC X.
  5256                     28  CF-UPDATE-APP      PIC X.
  5257
  5258         16  CF-CURRENT-TERM-ON             PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page  95
* EL131.cbl
  5259         16  CF-PROCESSOR-LIMITS-CLAIMS.
  5260             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  5261             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  5262             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  5263             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  5264             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  5265             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  5266             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  5267         16  CF-PROCESSOR-CARRIER           PIC X.
  5268             88  NO-CARRIER-SECURITY            VALUE ' '.
  5269         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  5270             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  5271         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  5272             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  5273         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  5274             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  5275
  5276         16  CF-PROC-SYS-ACCESS-SW.
  5277             20  CF-PROC-CREDIT-CLAIMS-SW.
  5278                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  5279                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  5280                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  5281                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  5282             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  5283                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  5284                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  5285             20  CF-PROC-LIFE-GNRLDGR-SW.
  5286                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  5287                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  5288                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  5289                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  5290             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  5291                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  5292                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  5293         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  5294             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  5295             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  5296         16  CF-PROCESSOR-PRINTER               PIC X(4).
  5297
  5298         16  CF-APPROVAL-LEVEL                  PIC X.
  5299             88  APPROVAL-LEVEL-1                   VALUE '1'.
  5300             88  APPROVAL-LEVEL-2                   VALUE '2'.
  5301             88  APPROVAL-LEVEL-3                   VALUE '3'.
  5302             88  APPROVAL-LEVEL-4                   VALUE '4'.
  5303             88  APPROVAL-LEVEL-5                   VALUE '5'.
  5304
  5305         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  5306
  5307         16  CF-LANGUAGE-TYPE                   PIC X.
  5308             88  CF-LANG-IS-ENG                     VALUE 'E'.
  5309             88  CF-LANG-IS-FR                      VALUE 'F'.
  5310
  5311         16  CF-CSR-IND                         PIC X.
  5312         16  FILLER                             PIC X(239).
  5313
  5314****************************************************************
  5315*             PROCESSOR/REMINDERS RECORD                       *
  5316****************************************************************
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page  96
* EL131.cbl
  5317
  5318     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  5319         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  5320             20  CF-START-REMIND-DT         PIC XX.
  5321             20  CF-END-REMIND-DT           PIC XX.
  5322             20  CF-REMINDER-TEXT           PIC X(50).
  5323         16  FILLER                         PIC X(296).
  5324
  5325
  5326****************************************************************
  5327*             STATE MASTER RECORD                              *
  5328****************************************************************
  5329
  5330     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5331         16  CF-STATE-ABBREVIATION          PIC XX.
  5332         16  CF-STATE-NAME                  PIC X(25).
  5333         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  5334         16  CF-ST-CALC-QUOTE-TOLERANCE.
  5335             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  5336             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  5337             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  5338             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  5339                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5340                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5341             20  CF-ST-PREM-REJECT-SW       PIC X.
  5342                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  5343                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  5344             20  CF-ST-REF-REJECT-SW        PIC X.
  5345                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  5346                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  5347         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  5348         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  5349         16  CF-ST-REFUND-RULES.
  5350             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  5351             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  5352             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  5353         16  CF-ST-FST-PMT-EXTENSION.
  5354             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  5355             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  5356                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  5357                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  5358                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  5359                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  5360         16  CF-ST-STATE-CALL.
  5361             20  CF-ST-CALL-UNEARNED        PIC X.
  5362             20  CF-ST-CALL-RPT-CNTL        PIC X.
  5363             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  5364         16  CF-REPLACEMENT-LAW-SW          PIC X.
  5365             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  5366             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  5367         16  CF-REPLACEMENT-LETTER          PIC X(4).
  5368         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  5369         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  5370         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  5371         16  CF-ST-SPLIT-PAYMENT            PIC X.
  5372         16  FILLER                         PIC X.
  5373         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  5374             20  CF-ST-BENEFIT-CD           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page  97
* EL131.cbl
  5375             20  CF-ST-BENEFIT-KIND         PIC X.
  5376                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  5377                 88  CF-ST-AH-KIND              VALUE 'A'.
  5378             20  CF-ST-REM-TERM-CALC        PIC X.
  5379                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  5380                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  5381                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  5382                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  5383                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  5384                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  5385                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  5386                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  5387
  5388             20  CF-ST-REFUND-CALC          PIC X.
  5389                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  5390                 88  ST-REFD-BY-R78             VALUE '1'.
  5391                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  5392                 88  ST-REFD-AS-CALIF           VALUE '3'.
  5393                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  5394                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  5395                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  5396                 88  ST-REFD-UTAH               VALUE '7'.
  5397                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  5398                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  5399                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  5400
  5401             20  CF-ST-EARNING-CALC         PIC X.
  5402                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  5403                 88  ST-EARN-BY-R78             VALUE '1'.
  5404                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  5405                 88  ST-EARN-AS-CALIF           VALUE '3'.
  5406                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  5407                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  5408                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  5409                 88  ST-EARN-MEAN               VALUE '8'.
  5410                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  5411
  5412             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  5413                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  5414                 88  ST-OVRD-BY-R78             VALUE '1'.
  5415                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  5416                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  5417                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  5418                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  5419                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  5420                 88  ST-OVRD-MEAN               VALUE '8'.
  5421                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  5422             20  cf-st-extra-periods        pic 9.
  5423*            20  FILLER                     PIC X.
  5424
  5425         16  CF-ST-COMMISSION-CAPS.
  5426             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  5427             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  5428             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  5429             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  5430         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  5431                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  5432                 88  ST-LIMIT-TO-GA             VALUE 'G'.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page  98
* EL131.cbl
  5433                 88  ST-LIMIT-TO-BOTH           VALUE 'B'.
  5434
  5435         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  5436
  5437         16  CF-ST-STATUTORY-INTEREST.
  5438             20  CF-ST-STAT-DATE-FROM       PIC X.
  5439                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  5440                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  5441             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  5442             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  5443             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  5444             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  5445             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  5446
  5447         16  CF-ST-OVER-SHORT.
  5448             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  5449             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  5450
  5451         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  5452
  5453         16  CF-ST-RT-CALC                  PIC X.
  5454
  5455         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5456         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  5457         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5458         16  CF-ST-RF-LR-CALC               PIC X.
  5459         16  CF-ST-RF-LL-CALC               PIC X.
  5460         16  CF-ST-RF-LN-CALC               PIC X.
  5461         16  CF-ST-RF-AH-CALC               PIC X.
  5462         16  CF-ST-RF-CP-CALC               PIC X.
  5463*        16  FILLER                         PIC X(206).
  5464*CIDMOD         16  FILLER                         PIC X(192).
  5465         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  5466             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  5467         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  5468         16  CF-ST-VFY-2ND-BENE             PIC X.
  5469         16  CF-ST-CAUSAL-STATE             PIC X.
  5470         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  5471         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  5472         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  5473             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  5474         16  CF-ST-NET-ONLY-STATE           PIC X.
  5475             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  5476         16  cf-commission-cap-required     pic x.
  5477         16  CF-ST-GA-COMMISSION-CAPS.
  5478             20  CF-ST-GA-COMM-CAP-SL       PIC S9V9(4) COMP-3.
  5479             20  CF-ST-GA-COMM-CAP-JL       PIC S9V9(4) COMP-3.
  5480             20  CF-ST-GA-COMM-CAP-SA       PIC S9V9(4) COMP-3.
  5481             20  CF-ST-GA-COMM-CAP-JA       PIC S9V9(4) COMP-3.
  5482         16  CF-ST-TOT-COMMISSION-CAPS.
  5483             20  CF-ST-TOT-COMM-CAP-SL      PIC S9V9(4) COMP-3.
  5484             20  CF-ST-TOT-COMM-CAP-JL      PIC S9V9(4) COMP-3.
  5485             20  CF-ST-TOT-COMM-CAP-SA      PIC S9V9(4) COMP-3.
  5486             20  CF-ST-TOT-COMM-CAP-JA      PIC S9V9(4) COMP-3.
  5487         16  FILLER                         PIC X(156).
  5488
  5489****************************************************************
  5490*             BENEFIT MASTER RECORD                            *
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page  99
* EL131.cbl
  5491****************************************************************
  5492
  5493     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5494         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  5495             20  CF-BENEFIT-CODE            PIC XX.
  5496             20  CF-BENEFIT-NUMERIC  REDEFINES
  5497                 CF-BENEFIT-CODE            PIC XX.
  5498             20  CF-BENEFIT-ALPHA           PIC XXX.
  5499             20  CF-BENEFIT-DESCRIP         PIC X(10).
  5500             20  CF-BENEFIT-COMMENT         PIC X(10).
  5501
  5502             20  CF-LF-COVERAGE-TYPE        PIC X.
  5503                 88  CF-REDUCING                VALUE 'R'.
  5504                 88  CF-LEVEL                   VALUE 'L' 'P'.
  5505
  5506             20  CF-SPECIAL-CALC-CD         PIC X.
  5507                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  5508                 88  CF-NP-0-MO-INT             VALUE 'A'.
  5509                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  5510                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  5511                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  5512                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  5513                 88  CF-FARM-PLAN               VALUE 'F'.
  5514                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  5515                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  5516                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  5517                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  5518                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  5519                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  5520                 88  CF-PRUDENTIAL              VALUE 'P'.
  5521                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  5522                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  5523                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  5524                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  5525                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  5526                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  5527
  5528             20  CF-JOINT-INDICATOR         PIC X.
  5529                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  5530
  5531*            20  FILLER                     PIC X(12).
  5532             20  cf-maximum-benefits        pic s999 comp-3.
  5533             20  FILLER                     PIC X(09).
  5534             20  CF-BENEFIT-CATEGORY        PIC X.
  5535             20  CF-LOAN-TYPE               PIC X(8).
  5536
  5537             20  CF-CO-REM-TERM-CALC        PIC X.
  5538                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  5539                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  5540                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  5541                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  5542                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  5543
  5544             20  CF-CO-EARNINGS-CALC        PIC X.
  5545                 88  CO-EARN-BY-R78             VALUE '1'.
  5546                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  5547                 88  CO-EARN-AS-CALIF           VALUE '3'.
  5548                 88  CO-EARN-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 100
* EL131.cbl
  5549                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  5550                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  5551                 88  CO-EARN-AS-MEAN            VALUE '8'.
  5552                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  5553
  5554             20  CF-CO-REFUND-CALC          PIC X.
  5555                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  5556                 88  CO-REFD-BY-R78             VALUE '1'.
  5557                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  5558                 88  CO-REFD-AS-CALIF           VALUE '3'.
  5559                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  5560                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  5561                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  5562                 88  CO-REFD-MEAN               VALUE '8'.
  5563                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  5564                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  5565                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  5566
  5567             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  5568                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  5569                 88  CO-OVRD-BY-R78             VALUE '1'.
  5570                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  5571                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  5572                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  5573                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  5574                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  5575                 88  CO-OVRD-MEAN               VALUE '8'.
  5576                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  5577
  5578             20  CF-CO-BEN-I-G-CD           PIC X.
  5579                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  5580                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  5581                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  5582
  5583         16  FILLER                         PIC X(304).
  5584
  5585
  5586****************************************************************
  5587*             CARRIER MASTER RECORD                            *
  5588****************************************************************
  5589
  5590     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5591         16  CF-ADDRESS-DATA.
  5592             20  CF-MAIL-TO-NAME            PIC X(30).
  5593             20  CF-IN-CARE-OF              PIC X(30).
  5594             20  CF-ADDRESS-LINE-1          PIC X(30).
  5595             20  CF-ADDRESS-LINE-2          PIC X(30).
  5596             20  CF-CITY-STATE              PIC X(30).
  5597             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  5598             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  5599
  5600         16  CF-CLAIM-NO-CONTROL.
  5601             20  CF-CLAIM-NO-METHOD         PIC X.
  5602                 88  CLAIM-NO-MANUAL            VALUE '1'.
  5603                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  5604                 88  CLAIM-NO-SEQ               VALUE '3'.
  5605                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  5606             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 101
* EL131.cbl
  5607                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  5608                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  5609                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  5610
  5611         16  CF-CHECK-NO-CONTROL.
  5612             20  CF-CHECK-NO-METHOD         PIC X.
  5613                 88  CHECK-NO-MANUAL            VALUE '1'.
  5614                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  5615                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  5616                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  5617             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  5618                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  5619
  5620         16  CF-DOMICILE-STATE              PIC XX.
  5621
  5622         16  CF-EXPENSE-CONTROLS.
  5623             20  CF-EXPENSE-METHOD          PIC X.
  5624                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  5625                 88  DOLLARS-PER-PMT            VALUE '2'.
  5626                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  5627                 88  DOLLARS-PER-MONTH          VALUE '4'.
  5628             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  5629             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  5630
  5631         16  CF-CORRESPONDENCE-CONTROL.
  5632             20  CF-LETTER-RESEND-OPT       PIC X.
  5633                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  5634                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  5635             20  FILLER                     PIC X(4).
  5636
  5637         16  CF-RESERVE-CONTROLS.
  5638             20  CF-MANUAL-SW               PIC X.
  5639                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  5640             20  CF-FUTURE-SW               PIC X.
  5641                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  5642             20  CF-PTC-SW                  PIC X.
  5643                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  5644             20  CF-IBNR-SW                 PIC X.
  5645                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  5646             20  CF-PTC-LF-SW               PIC X.
  5647                 88  CF-LF-PTC-USED             VALUE '1'.
  5648             20  CF-CDT-ACCESS-METHOD       PIC X.
  5649                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  5650                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  5651                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  5652             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  5653
  5654         16  CF-CLAIM-CALC-METHOD           PIC X.
  5655             88  360-PLUS-MONTHS                VALUE '1'.
  5656             88  365-PLUS-MONTHS                VALUE '2'.
  5657             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  5658             88  360-DAILY                      VALUE '4'.
  5659             88  365-DAILY                      VALUE '5'.
  5660
  5661         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  5662         16  FILLER                         PIC X(11).
  5663
  5664         16  CF-LIMIT-AMOUNTS.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 102
* EL131.cbl
  5665             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  5666             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  5667             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  5668             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  5669             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  5670             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  5671             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  5672             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  5673             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  5674             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  5675
  5676         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  5677         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  5678         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  5679
  5680         16  CF-ZIP-CODE.
  5681             20  CF-ZIP-PRIME.
  5682                 24  CF-ZIP-1ST             PIC X.
  5683                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5684                 24  FILLER                 PIC X(4).
  5685             20  CF-ZIP-PLUS4               PIC X(4).
  5686         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  5687             20  CF-CAN-POSTAL-1            PIC XXX.
  5688             20  CF-CAN-POSTAL-2            PIC XXX.
  5689             20  FILLER                     PIC XXX.
  5690
  5691         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  5692         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  5693         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  5694
  5695         16  CF-RATING-SWITCH               PIC X.
  5696             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  5697             88  CF-NO-RATING                   VALUE 'N'.
  5698
  5699         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  5700
  5701         16  CF-CARRIER-OVER-SHORT.
  5702             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5703             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5704
  5705         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  5706         16  CF-SECPAY-SWITCH               PIC X.
  5707             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  5708             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  5709         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  5710         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  5711         16  FILLER                         PIC X(444).
  5712*        16  FILLER                         PIC X(452).
  5713
  5714
  5715****************************************************************
  5716*             MORTALITY MASTER RECORD                          *
  5717****************************************************************
  5718
  5719     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5720         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  5721                                INDEXED BY CF-MORT-NDX.
  5722             20  CF-MORT-TABLE              PIC X(5).
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 103
* EL131.cbl
  5723             20  CF-MORT-TABLE-TYPE         PIC X.
  5724                 88  CF-MORT-JOINT              VALUE 'J'.
  5725                 88  CF-MORT-SINGLE             VALUE 'S'.
  5726                 88  CF-MORT-COMBINED           VALUE 'C'.
  5727                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  5728                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  5729             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  5730             20  CF-MORT-AGE-METHOD         PIC XX.
  5731                 88  CF-AGE-LAST                VALUE 'AL'.
  5732                 88  CF-AGE-NEAR                VALUE 'AN'.
  5733             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  5734             20  CF-MORT-ADJUSTMENT-DIRECTION
  5735                                            PIC X.
  5736                 88  CF-MINUS                   VALUE '-'.
  5737                 88  CF-PLUS                    VALUE '+'.
  5738             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  5739             20  CF-MORT-JOINT-CODE         PIC X.
  5740                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  5741             20  CF-MORT-PC-Q               PIC X.
  5742                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  5743             20  CF-MORT-TABLE-CODE         PIC X(4).
  5744             20  CF-MORT-COMMENTS           PIC X(15).
  5745             20  FILLER                     PIC X(14).
  5746
  5747         16  FILLER                         PIC X(251).
  5748
  5749
  5750****************************************************************
  5751*             BUSSINESS TYPE MASTER RECORD                     *
  5752****************************************************************
  5753
  5754     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5755* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  5756* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  5757* AND RECORD 05 IS TYPES 81-99
  5758         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  5759             20  CF-BUSINESS-TITLE          PIC  X(19).
  5760             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  5761                                            PIC S9V9(4) COMP-3.
  5762             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  5763             20  FILLER                     PIC  X.
  5764         16  FILLER                         PIC  X(248).
  5765
  5766
  5767****************************************************************
  5768*             TERMINAL MASTER RECORD                           *
  5769****************************************************************
  5770
  5771     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5772
  5773         16  CF-COMPANY-TERMINALS.
  5774             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  5775                                  PIC X(4).
  5776         16  FILLER               PIC X(248).
  5777
  5778
  5779****************************************************************
  5780*             LIFE EDIT MASTER RECORD                          *
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 104
* EL131.cbl
  5781****************************************************************
  5782
  5783     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5784         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  5785             20  CF-LIFE-CODE-IN            PIC XX.
  5786             20  CF-LIFE-CODE-OUT           PIC XX.
  5787         16  FILLER                         PIC X(248).
  5788
  5789
  5790****************************************************************
  5791*             AH EDIT MASTER RECORD                            *
  5792****************************************************************
  5793
  5794     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5795         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  5796             20  CF-AH-CODE-IN              PIC XXX.
  5797             20  CF-AH-CODE-OUT             PIC XX.
  5798         16  FILLER                         PIC X(248).
  5799
  5800
  5801****************************************************************
  5802*             CREDIBILITY TABLES                               *
  5803****************************************************************
  5804
  5805     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5806         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  5807                             INDEXED BY CF-CRDB-NDX.
  5808             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  5809             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  5810             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  5811         16  FILLER                         PIC  X(332).
  5812
  5813
  5814****************************************************************
  5815*             REPORT CUSTOMIZATION RECORD                      *
  5816****************************************************************
  5817
  5818     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  5819         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  5820             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  5821             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  5822             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  5823**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  5824****       A T-TRANSFER.                                   ****
  5825             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  5826
  5827         16  FILLER                         PIC XX.
  5828
  5829         16  CF-CARRIER-CNTL-OPT.
  5830             20  CF-CARRIER-OPT-SEQ         PIC 9.
  5831                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  5832                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  5833             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  5834                                            PIC X.
  5835         16  CF-GROUP-CNTL-OPT.
  5836             20  CF-GROUP-OPT-SEQ           PIC 9.
  5837                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  5838                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 105
* EL131.cbl
  5839             20  CF-GROUP-SELECT OCCURS 3 TIMES
  5840                                            PIC X(6).
  5841         16  CF-STATE-CNTL-OPT.
  5842             20  CF-STATE-OPT-SEQ           PIC 9.
  5843                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  5844                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  5845             20  CF-STATE-SELECT OCCURS 3 TIMES
  5846                                            PIC XX.
  5847         16  CF-ACCOUNT-CNTL-OPT.
  5848             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  5849                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  5850                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  5851             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  5852                                            PIC X(10).
  5853         16  CF-BUS-TYP-CNTL-OPT.
  5854             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  5855                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  5856                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  5857             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  5858                                            PIC XX.
  5859         16  CF-LF-TYP-CNTL-OPT.
  5860             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  5861                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  5862                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  5863             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  5864                                            PIC XX.
  5865         16  CF-AH-TYP-CNTL-OPT.
  5866             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  5867                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  5868                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  5869             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  5870                                            PIC XX.
  5871         16  CF-REPTCD1-CNTL-OPT.
  5872             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  5873                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  5874                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  5875             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  5876                                            PIC X(10).
  5877         16  CF-REPTCD2-CNTL-OPT.
  5878             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  5879                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  5880                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  5881             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  5882                                            PIC X(10).
  5883         16  CF-USER1-CNTL-OPT.
  5884             20  CF-USER1-OPT-SEQ           PIC 9.
  5885                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  5886                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  5887             20  CF-USER1-SELECT OCCURS 3 TIMES
  5888                                            PIC X(10).
  5889         16  CF-USER2-CNTL-OPT.
  5890             20  CF-USER2-OPT-SEQ           PIC 9.
  5891                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  5892                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  5893             20  CF-USER2-SELECT OCCURS 3 TIMES
  5894                                            PIC X(10).
  5895         16  CF-USER3-CNTL-OPT.
  5896             20  CF-USER3-OPT-SEQ           PIC 9.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 106
* EL131.cbl
  5897                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  5898                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  5899             20  CF-USER3-SELECT OCCURS 3 TIMES
  5900                                            PIC X(10).
  5901         16  CF-USER4-CNTL-OPT.
  5902             20  CF-USER4-OPT-SEQ           PIC 9.
  5903                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  5904                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  5905             20  CF-USER4-SELECT OCCURS 3 TIMES
  5906                                            PIC X(10).
  5907         16  CF-USER5-CNTL-OPT.
  5908             20  CF-USER5-OPT-SEQ           PIC 9.
  5909                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  5910                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  5911             20  CF-USER5-SELECT OCCURS 3 TIMES
  5912                                            PIC X(10).
  5913         16  CF-REINS-CNTL-OPT.
  5914             20  CF-REINS-OPT-SEQ           PIC 9.
  5915                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  5916                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  5917             20  CF-REINS-SELECT OCCURS 3 TIMES.
  5918                 24  CF-REINS-PRIME         PIC XXX.
  5919                 24  CF-REINS-SUB           PIC XXX.
  5920
  5921         16  CF-AGENT-CNTL-OPT.
  5922             20  CF-AGENT-OPT-SEQ           PIC 9.
  5923                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  5924                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  5925             20  CF-AGENT-SELECT OCCURS 3 TIMES
  5926                                            PIC X(10).
  5927
  5928         16  FILLER                         PIC X(43).
  5929
  5930         16  CF-LOSS-RATIO-SELECT.
  5931             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  5932             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  5933         16  CF-ENTRY-DATE-SELECT.
  5934             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  5935             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  5936         16  CF-EFFECTIVE-DATE-SELECT.
  5937             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  5938             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  5939
  5940         16  CF-EXCEPTION-LIST-IND          PIC X.
  5941             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  5942
  5943         16  FILLER                         PIC X(318).
  5944
  5945****************************************************************
  5946*                  EXCEPTION REPORTING RECORD                  *
  5947****************************************************************
  5948
  5949     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  5950         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  5951             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  5952
  5953         16  CF-COMBINED-LIFE-AH-OPT.
  5954             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 107
* EL131.cbl
  5955             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  5956             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  5957             20  CF-CANCELLATION-RATIO      PIC S9(02).
  5958
  5959         16  CF-LIFE-OPT.
  5960             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5961             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5962             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5963             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5964             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5965             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5966             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5967             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5968             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5969             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  5970
  5971         16  CF-AH-OPT.
  5972             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5973             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5974             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5975             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5976             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5977             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5978             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5979             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5980             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5981             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  5982
  5983         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  5984             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  5985             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  5986             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  5987
  5988         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  5989
  5990         16  FILLER                         PIC X(673).
  5991
  5992
  5993****************************************************************
  5994*             MORTGAGE SYSTEM PLAN RECORD                      *
  5995****************************************************************
  5996
  5997     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  5998         16  CF-PLAN-TYPE                   PIC X.
  5999             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  6000             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  6001             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  6002         16  CF-PLAN-ABBREV                 PIC XXX.
  6003         16  CF-PLAN-DESCRIPT               PIC X(10).
  6004         16  CF-PLAN-NOTES                  PIC X(20).
  6005         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  6006         16  CF-PLAN-UNDERWRITING.
  6007             20  CF-PLAN-TERM-DATA.
  6008                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  6009                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  6010             20  CF-PLAN-AGE-DATA.
  6011                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  6012                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 108
* EL131.cbl
  6013                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  6014             20  CF-PLAN-BENEFIT-DATA.
  6015                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6016                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6017                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  6018                                            PIC S9(7)V99  COMP-3.
  6019         16  CF-PLAN-POLICY-FORMS.
  6020             20  CF-POLICY-FORM             PIC X(12).
  6021             20  CF-MASTER-APPLICATION      PIC X(12).
  6022             20  CF-MASTER-POLICY           PIC X(12).
  6023         16  CF-PLAN-RATING.
  6024             20  CF-RATE-CODE               PIC X(5).
  6025             20  CF-SEX-RATING              PIC X.
  6026                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  6027                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  6028             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  6029             20  CF-SUB-STD-TYPE            PIC X.
  6030                 88  CF-PCT-OF-PREM            VALUE '1'.
  6031                 88  CF-PCT-OF-BENE            VALUE '2'.
  6032         16  CF-PLAN-PREM-TOLERANCES.
  6033             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  6034             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  6035         16  CF-PLAN-PYMT-TOLERANCES.
  6036             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  6037             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  6038         16  CF-PLAN-MISC-DATA.
  6039             20  FILLER                     PIC X.
  6040             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  6041             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  6042         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  6043         16  CF-PLAN-IND-GRP                PIC X.
  6044             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  6045                                                     '1'.
  6046             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  6047                                                     '2'.
  6048         16  CF-MIB-SEARCH-SW               PIC X.
  6049             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  6050             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  6051             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  6052             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  6053         16  CF-ALPHA-SEARCH-SW             PIC X.
  6054             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  6055             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  6056             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  6057             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  6058             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  6059             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  6060             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  6061             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  6062             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  6063             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  6064                                                     'A' 'B' 'C'
  6065                                                     'X' 'Y' 'Z'.
  6066         16  CF-EFF-DT-RULE-SW              PIC X.
  6067             88  CF-EFF-DT-ENTER               VALUE 'E'.
  6068             88  CF-EFF-DT-MONTH               VALUE 'M'.
  6069             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  6070             88  CF-EFF-DT-SEMI                VALUE 'S'.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 109
* EL131.cbl
  6071             88  CF-EFF-DT-ANN                 VALUE 'A'.
  6072         16  FILLER                         PIC X(4).
  6073         16  CF-HEALTH-QUESTIONS            PIC X.
  6074             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  6075         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  6076         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  6077         16  CF-PLAN-SNGL-JNT               PIC X.
  6078             88  CF-COMBINED-PLAN              VALUE 'C'.
  6079             88  CF-JNT-PLAN                   VALUE 'J'.
  6080             88  CF-SNGL-PLAN                  VALUE 'S'.
  6081         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  6082         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  6083         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  6084         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  6085         16  CF-RERATE-CNTL                 PIC  X.
  6086             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  6087             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  6088             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  6089             88  CF-AUTO-RECALC                 VALUE '4'.
  6090         16  CF-BENEFIT-TYPE                PIC  X.
  6091             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  6092             88  CF-BENEFIT-REDUCES             VALUE '2'.
  6093         16  CF-POLICY-FEE                  PIC S999V99
  6094                                                    COMP-3.
  6095         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  6096         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  6097         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  6098         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  6099         16  FILLER                         PIC  X(32).
  6100         16  CF-TERMINATION-FORM            PIC  X(04).
  6101         16  FILLER                         PIC  X(08).
  6102         16  CF-CLAIM-CAP                   PIC S9(7)V99
  6103                                                       COMP-3.
  6104         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  6105         16  CF-ISSUE-LETTER                PIC  X(4).
  6106         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  6107         16  CF-DEPENDENT-COVERAGE          PIC  X.
  6108             88  CF-YES-DEP-COV                 VALUE 'Y'.
  6109             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  6110         16  CF-MP-REFUND-CALC              PIC X.
  6111             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  6112             88  CF-MP-REFD-BY-R78              VALUE '1'.
  6113             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  6114             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  6115             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  6116             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  6117             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  6118             88  CF-MP-REFD-MEAN                VALUE '8'.
  6119         16  CF-ALT-RATE-CODE               PIC  X(5).
  6120
  6121
  6122         16  FILLER                         PIC X(498).
  6123****************************************************************
  6124*             MORTGAGE COMPANY MASTER RECORD                   *
  6125****************************************************************
  6126
  6127     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6128         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 110
* EL131.cbl
  6129         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  6130             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  6131             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  6132             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  6133             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  6134             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  6135
  6136         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  6137         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  6138         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  6139         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  6140         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  6141
  6142         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  6143             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  6144         16  CF-MP-RECON-USE-IND            PIC X(1).
  6145             88  CF-MP-USE-RECON             VALUE 'Y'.
  6146         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  6147             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  6148         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  6149             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  6150             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  6151         16  FILLER                         PIC X(1).
  6152         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  6153             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  6154         16  CF-MORTG-MIB-VERSION           PIC X.
  6155             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  6156             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  6157             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  6158         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  6159             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  6160                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  6161             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  6162                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  6163             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  6164                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  6165             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  6166                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  6167             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  6168                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  6169             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  6170                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  6171         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  6172         16  FILLER                         PIC X(7).
  6173         16  CF-MORTG-DESTINATION-SYMBOL.
  6174             20  CF-MORTG-MIB-COMM          PIC X(5).
  6175             20  CF-MORTG-MIB-TERM          PIC X(5).
  6176         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  6177             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  6178         16  FILLER                         PIC X(03).
  6179         16  CF-MP-CHECK-NO-CONTROL.
  6180             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  6181                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  6182                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  6183                                                ' ' LOW-VALUES.
  6184                 88  CF-MP-CHECK-NO-PRE-PRINTED
  6185                                               VALUE '3'.
  6186         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 111
* EL131.cbl
  6187         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  6188         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  6189             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  6190                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  6191             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  6192                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  6193             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  6194                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  6195             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  6196                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  6197             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  6198                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  6199             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  6200                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  6201         16  CF-MORTG-BILLING-AREA.
  6202             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  6203                                            PIC X.
  6204         16  CF-MORTG-MONTH-END-DT          PIC XX.
  6205         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  6206         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  6207         16  CF-MORTG-MIB-DEST-SW           PIC X.
  6208             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  6209             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  6210         16  FILLER                         PIC X.
  6211         16  CF-MORTG-LABEL-CONTROL         PIC X.
  6212             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  6213             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  6214         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  6215         16  FILLER                         PIC X(8).
  6216         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  6217         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  6218         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  6219         16  CF-ACH-COMPANY-ID.
  6220             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  6221                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  6222                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  6223                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  6224             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  6225         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  6226             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  6227         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  6228             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  6229             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  6230         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  6231         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  6232         16  FILLER                         PIC X(536).
  6233
  6234****************************************************************
  6235*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  6236****************************************************************
  6237
  6238     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  6239         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  6240             20  CF-FEMALE-HEIGHT.
  6241                 24  CF-FEMALE-FT           PIC 99.
  6242                 24  CF-FEMALE-IN           PIC 99.
  6243             20  CF-FEMALE-MIN-WT           PIC 999.
  6244             20  CF-FEMALE-MAX-WT           PIC 999.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 112
* EL131.cbl
  6245         16  FILLER                         PIC X(428).
  6246
  6247     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  6248         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  6249             20  CF-MALE-HEIGHT.
  6250                 24  CF-MALE-FT             PIC 99.
  6251                 24  CF-MALE-IN             PIC 99.
  6252             20  CF-MALE-MIN-WT             PIC 999.
  6253             20  CF-MALE-MAX-WT             PIC 999.
  6254         16  FILLER                         PIC X(428).
  6255******************************************************************
  6256*             AUTOMATIC ACTIVITY RECORD                          *
  6257******************************************************************
  6258     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  6259         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  6260             20  CF-SYS-ACTIVE-SW           PIC X(01).
  6261             20  CF-SYS-LETTER-ID           PIC X(04).
  6262             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  6263             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  6264             20  CF-SYS-RESET-SW            PIC X(01).
  6265             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  6266             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  6267
  6268         16  FILLER                         PIC X(50).
  6269
  6270         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  6271             20  CF-USER-ACTIVE-SW          PIC X(01).
  6272             20  CF-USER-LETTER-ID          PIC X(04).
  6273             20  CF-USER-RESEND-DAYS        PIC 9(03).
  6274             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  6275             20  CF-USER-RESET-SW           PIC X(01).
  6276             20  CF-USER-REPORT-DAYS        PIC 9(03).
  6277             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  6278             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  6279
  6280         16  FILLER                         PIC X(246).
  6281
  6282*                                COPY ELCACTQ.
  6283******************************************************************
  6284*                                                                *
  6285*                            ELCACTQ.                            *
  6286*           PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
  6287*                            VMOD=2.004                          *
  6288*                                                                *
  6289*   FILE DESCRIPTION = ACTIVITY QUE FILE                         *
  6290*                                                                *
  6291*   FILE TYPE = VSAM,KSDS                                        *
  6292*   RECORD SIZE = 60     RECFORM = FIXED                         *
  6293*                                                                *
  6294*   BASE CLUSTER NAME = ELACTQ             RKP=2,LEN=20          *
  6295*       ALTERNATE INDEX = NONE                                   *
  6296*                                                                *
  6297*   LOG = YES                                                    *
  6298*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6299*                                                                *
  6300*  NO  CID  MODS  IN  COPYBOOK  ELCACTQ                          *
  6301******************************************************************
  6302
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 113
* EL131.cbl
  6303 01  ACTIVITY-QUE.
  6304     12  AQ-RECORD-ID                PIC XX.
  6305         88  VALID-AQ-ID                VALUE 'AQ'.
  6306
  6307     12  AQ-CONTROL-PRIMARY.
  6308         16  AQ-COMPANY-CD           PIC X.
  6309         16  AQ-CARRIER              PIC X.
  6310         16  AQ-CLAIM-NO             PIC X(7).
  6311         16  AQ-CERT-NO.
  6312             20  AQ-CERT-PRIME       PIC X(10).
  6313             20  AQ-CERT-SFX         PIC X.
  6314
  6315     12  AQ-PENDING-ACTIVITY-FLAGS.
  6316         88  NO-PENDING-ACTIVITY        VALUE SPACES.
  6317         16  AQ-PENDING-PAYMENT-FLAG PIC X.
  6318             88  PENDING-PAYMENTS       VALUE '1'.
  6319         16  AQ-PENDING-STATUS-FLAG  PIC X.
  6320             88  PENDING-FULL-PRINT     VALUE '1'.
  6321             88  PENDING-PART-PRINT     VALUE '2'.
  6322         16  AQ-PENDING-LETTER-FLAG  PIC X.
  6323             88  PENDING-LETTERS        VALUE '1'.
  6324         16  AQ-PENDING-CLAIM-RESTORE PIC X.
  6325             88  PENDING-RESTORE        VALUE 'C'.
  6326             88  PENDING-RESTORE-LETTER VALUE 'L'.
  6327
  6328     12  FILLER                      PIC X(20).
  6329
  6330     12  AQ-RESEND-DATE              PIC XX.
  6331     12  AQ-FOLLOWUP-DATE            PIC XX.
  6332     12  AQ-PAYMENT-COUNTER          PIC S9        COMP-3.
  6333     12  AQ-PMT-UNAPPROVED-COUNT     PIC S9        COMP-3.
  6334     12  AQ-AUTO-LETTER              PIC X(4).
  6335     12  FILLER                      PIC XX.
  6336     12  AQ-LAST-UPDATED-BY          PIC S9(4)     COMP.
  6337*****************************************************************
  6338
  6339*                                COPY ERCACCT.
  6340******************************************************************
  6341*                                                                *
  6342*                                                                *
  6343*                            ERCACCT                             *
  6344*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6345*                            VMOD=2.031                          *
  6346*                                                                *
  6347*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6348*                                                                *
  6349*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6350*   VSAM ACCOUNT MASTER FILES.                                   *
  6351*                                                                *
  6352*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6353*                                                                *
  6354*   FILE TYPE = VSAM,KSDS                                        *
  6355*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6356*                                                                *
  6357*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6358*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6359*                                                                *
  6360*   LOG = NO                                                     *
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 114
* EL131.cbl
  6361*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6362*                                                                *
  6363*                                                                *
  6364******************************************************************
  6365*                   C H A N G E   L O G
  6366*
  6367* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6368*-----------------------------------------------------------------
  6369*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6370* EFFECTIVE    NUMBER
  6371*-----------------------------------------------------------------
  6372* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6373* 092705    2005050300006  PEMA  ADD SPP LEASES
  6374* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6375* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6376* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6377* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6378* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6379* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  6380******************************************************************
  6381
  6382 01  ACCOUNT-MASTER.
  6383     12  AM-RECORD-ID                      PIC XX.
  6384         88  VALID-AM-ID                      VALUE 'AM'.
  6385
  6386     12  AM-CONTROL-PRIMARY.
  6387         16  AM-COMPANY-CD                 PIC X.
  6388         16  AM-MSTR-CNTRL.
  6389             20  AM-CONTROL-A.
  6390                 24  AM-CARRIER            PIC X.
  6391                 24  AM-GROUPING.
  6392                     28 AM-GROUPING-PREFIX PIC XXX.
  6393                     28 AM-GROUPING-PRIME  PIC XXX.
  6394                 24  AM-STATE              PIC XX.
  6395                 24  AM-ACCOUNT.
  6396                     28  AM-ACCOUNT-PREFIX PIC X(4).
  6397                     28  AM-ACCOUNT-PRIME  PIC X(6).
  6398             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6399                                           PIC X(19).
  6400             20  AM-CNTRL-B.
  6401                 24  AM-EXPIRATION-DT      PIC XX.
  6402                 24  FILLER                PIC X(4).
  6403             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6404                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6405
  6406     12  AM-CONTROL-BY-VAR-GRP.
  6407         16  AM-COMPANY-CD-A1              PIC X.
  6408         16  AM-VG-CARRIER                 PIC X.
  6409         16  AM-VG-GROUPING                PIC X(6).
  6410         16  AM-VG-STATE                   PIC XX.
  6411         16  AM-VG-ACCOUNT                 PIC X(10).
  6412         16  AM-VG-DATE.
  6413             20  AM-VG-EXPIRATION-DT       PIC XX.
  6414             20  FILLER                    PIC X(4).
  6415         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6416                                           PIC 9(11)      COMP-3.
  6417     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6418         16  FILLER                        PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 115
* EL131.cbl
  6419         16  AM-VG-KEY3.
  6420             20  AM-VG3-ACCOUNT            PIC X(10).
  6421             20  AM-VG3-EXP-DT             PIC XX.
  6422         16  FILLER                        PIC X(4).
  6423     12  AM-MAINT-INFORMATION.
  6424         16  AM-LAST-MAINT-DT              PIC XX.
  6425         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6426         16  AM-LAST-MAINT-USER            PIC X(4).
  6427         16  FILLER                        PIC XX.
  6428
  6429     12  AM-EFFECTIVE-DT                   PIC XX.
  6430     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6431
  6432     12  AM-PREV-DATES  COMP-3.
  6433         16  AM-PREV-EXP-DT                PIC 9(11).
  6434         16  AM-PREV-EFF-DT                PIC 9(11).
  6435
  6436     12  AM-REPORT-CODE-1                  PIC X(10).
  6437     12  AM-REPORT-CODE-2                  PIC X(10).
  6438
  6439     12  AM-CITY-CODE                      PIC X(4).
  6440     12  AM-COUNTY-PARISH                  PIC X(6).
  6441
  6442     12  AM-NAME                           PIC X(30).
  6443     12  AM-PERSON                         PIC X(30).
  6444     12  AM-ADDRS                          PIC X(30).
  6445     12  AM-CITY.
  6446         16  AM-ADDR-CITY                  PIC X(28).
  6447         16  AM-ADDR-STATE                 PIC XX.
  6448     12  AM-ZIP.
  6449         16  AM-ZIP-PRIME.
  6450             20  AM-ZIP-PRI-1ST            PIC X.
  6451                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6452             20  FILLER                    PIC X(4).
  6453         16  AM-ZIP-PLUS4                  PIC X(4).
  6454     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  6455         16  AM-CAN-POSTAL-1               PIC XXX.
  6456         16  AM-CAN-POSTAL-2               PIC XXX.
  6457         16  FILLER                        PIC XXX.
  6458     12  AM-TEL-NO.
  6459         16  AM-AREA-CODE                  PIC 999.
  6460         16  AM-TEL-PRE                    PIC 999.
  6461         16  AM-TEL-NBR                    PIC 9(4).
  6462     12  AM-TEL-LOC                        PIC X.
  6463         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6464         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6465
  6466     12  AM-COMM-STRUCTURE.
  6467         16  AM-DEFN-1.
  6468             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6469                 24  AM-AGT.
  6470                     28  AM-AGT-PREFIX     PIC X(4).
  6471                     28  AM-AGT-PRIME      PIC X(6).
  6472                 24  AM-COM-TYP            PIC X.
  6473                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6474                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6475                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6476                 24  AM-RECALC-LV-INDIC    PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 116
* EL131.cbl
  6477                 24  AM-RETRO-LV-INDIC     PIC X.
  6478                 24  AM-GL-CODES           PIC X.
  6479                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6480                 24  FILLER                PIC X(01).
  6481         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6482             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6483                 24  FILLER                PIC X(11).
  6484                 24  AM-L-COMA             PIC XXX.
  6485                 24  AM-J-COMA             PIC XXX.
  6486                 24  AM-A-COMA             PIC XXX.
  6487                 24  FILLER                PIC X(6).
  6488
  6489     12  AM-COMM-CHANGE-STATUS             PIC X.
  6490         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6491
  6492     12  AM-CSR-CODE                       PIC X(4).
  6493
  6494     12  AM-BILLING-STATUS                 PIC X.
  6495         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6496         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6497     12  AM-AUTO-REFUND-SW                 PIC X.
  6498         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6499         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6500     12  AM-GPCD                           PIC 99.
  6501     12  AM-IG                             PIC X.
  6502         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6503         88  AM-HAS-GROUP                     VALUE '2'.
  6504     12  AM-STATUS                         PIC X.
  6505         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6506         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6507         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6508         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6509         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6510         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6511         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  6512         88  AM-ACCOUNT-LAPSED                VALUE '7'.
  6513         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  6514         88  AM-ACCOUNT-PENDING               VALUE '9'.
  6515     12  AM-REMIT-TO                       PIC 99.
  6516     12  AM-ID-NO                          PIC X(11).
  6517
  6518     12  AM-CAL-TABLE                      PIC XX.
  6519     12  AM-LF-DEVIATION                   PIC XXX.
  6520     12  AM-AH-DEVIATION                   PIC XXX.
  6521     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6522     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6523     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6524     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6525     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6526     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6527
  6528     12  AM-USER-FIELDS.
  6529         16  AM-FLD-1                      PIC XX.
  6530         16  AM-FLD-2                      PIC XX.
  6531         16  AM-FLD-3                      PIC XX.
  6532         16  AM-FLD-4                      PIC XX.
  6533         16  AM-FLD-5                      PIC XX.
  6534
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 117
* EL131.cbl
  6535     12  AM-1ST-PROD-DATE.
  6536         16  AM-1ST-PROD-YR                PIC XX.
  6537         16  AM-1ST-PROD-MO                PIC XX.
  6538         16  AM-1ST-PROD-DA                PIC XX.
  6539     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6540     12  AM-CERTS-PURGED-DATE.
  6541         16  AM-PUR-YR                     PIC XX.
  6542         16  AM-PUR-MO                     PIC XX.
  6543         16  AM-PUR-DA                     PIC XX.
  6544     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6545     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6546     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6547     12  AM-INACTIVE-DATE.
  6548         16  AM-INA-MO                     PIC 99.
  6549         16  AM-INA-DA                     PIC 99.
  6550         16  AM-INA-YR                     PIC 99.
  6551     12  AM-AR-HI-CERT-DATE                PIC XX.
  6552
  6553     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6554     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6555
  6556     12  AM-OB-PAYMENT-MODE                PIC X.
  6557         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6558         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6559         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6560         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6561
  6562     12  AM-AH-ONLY-INDICATOR              PIC X.
  6563         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6564         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6565
  6566     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6567
  6568     12  AM-OVER-SHORT.
  6569         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6570         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  6571
  6572     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6573     12  AM-DCC-CLP-STATE                  PIC XX.
  6574
  6575     12  AM-RECALC-COMM                    PIC X.
  6576     12  AM-RECALC-REIN                    PIC X.
  6577
  6578     12  AM-REI-TABLE                      PIC XXX.
  6579     12  AM-REI-ET-LF                      PIC X.
  6580     12  AM-REI-ET-AH                      PIC X.
  6581     12  AM-REI-PE-LF                      PIC X.
  6582     12  AM-REI-PE-AH                      PIC X.
  6583     12  AM-REI-PRT-ST                     PIC X.
  6584     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6585     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6586     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6587     12  AM-REI-GROUP-A                    PIC X(6).
  6588     12  AM-REI-MORT                       PIC X(4).
  6589     12  AM-REI-PRT-OW                     PIC X.
  6590     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6591     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6592     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 118
* EL131.cbl
  6593     12  AM-REI-GROUP-B                    PIC X(6).
  6594
  6595     12  AM-TRUST-TYPE                     PIC X(2).
  6596
  6597     12  AM-EMPLOYER-STMT-USED             PIC X.
  6598     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6599
  6600     12  AM-STD-AH-TYPE                    PIC XX.
  6601     12  AM-EARN-METHODS.
  6602         16  AM-EARN-METHOD-R              PIC X.
  6603             88 AM-REF-RL-R78                 VALUE 'R'.
  6604             88 AM-REF-RL-PR                  VALUE 'P'.
  6605             88 AM-REF-RL-MEAN                VALUE 'M'.
  6606             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6607         16  AM-EARN-METHOD-L              PIC X.
  6608             88 AM-REF-LL-R78                 VALUE 'R'.
  6609             88 AM-REF-LL-PR                  VALUE 'P'.
  6610             88 AM-REF-LL-MEAN                VALUE 'M'.
  6611             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6612         16  AM-EARN-METHOD-A              PIC X.
  6613             88 AM-REF-AH-R78                 VALUE 'R'.
  6614             88 AM-REF-AH-PR                  VALUE 'P'.
  6615             88 AM-REF-AH-MEAN                VALUE 'M'.
  6616             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6617             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6618             88 AM-REF-AH-NET                 VALUE 'N'.
  6619
  6620     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6621     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6622     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6623
  6624     12  AM-RET-Y-N                        PIC X.
  6625     12  AM-RET-P-E                        PIC X.
  6626     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6627     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6628     12  AM-RET-GRP                        PIC X(6).
  6629     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6630         16  AM-POOL-PRIME                 PIC XXX.
  6631         16  AM-POOL-SUB                   PIC XXX.
  6632     12  AM-RETRO-EARNINGS.
  6633         16  AM-RET-EARN-R                 PIC X.
  6634         16  AM-RET-EARN-L                 PIC X.
  6635         16  AM-RET-EARN-A                 PIC X.
  6636     12  AM-RET-ST-TAX-USE                 PIC X.
  6637         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6638         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6639     12  AM-RETRO-BEG-EARNINGS.
  6640         16  AM-RET-BEG-EARN-R             PIC X.
  6641         16  AM-RET-BEG-EARN-L             PIC X.
  6642         16  AM-RET-BEG-EARN-A             PIC X.
  6643     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6644     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6645
  6646     12  AM-USER-SELECT-OPTIONS.
  6647         16  AM-USER-SELECT-1              PIC X(10).
  6648         16  AM-USER-SELECT-2              PIC X(10).
  6649         16  AM-USER-SELECT-3              PIC X(10).
  6650         16  AM-USER-SELECT-4              PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 119
* EL131.cbl
  6651         16  AM-USER-SELECT-5              PIC X(10).
  6652
  6653     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6654
  6655     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6656
  6657     12  AM-RPT045A-SWITCH                 PIC X.
  6658         88  RPT045A-OFF                   VALUE 'N'.
  6659
  6660     12  AM-INSURANCE-LIMITS.
  6661         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6662         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6663
  6664     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6665         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6666
  6667     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6668         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6669         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6670
  6671     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6672
  6673     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6674     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6675     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6676     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6677     12  AM-DCC-UEF-STATE                  PIC XX.
  6678     12  FILLER                            PIC XXX.
  6679     12  AM-REPORT-CODE-3                  PIC X(10).
  6680*    12  FILLER                            PIC X(22).
  6681
  6682     12  AM-RESERVE-DATE.
  6683         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6684         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6685         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6686
  6687     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6688     12  AM-NOTIFICATION-TYPES.
  6689         16  AM-NOTIF-OF-LETTERS           PIC X.
  6690         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6691         16  AM-NOTIF-OF-REPORTS           PIC X.
  6692         16  AM-NOTIF-OF-STATUS            PIC X.
  6693
  6694     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6695         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6696         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6697         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6698         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6699
  6700     12  AM-BENEFIT-CONTROLS.
  6701         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6702             20  AM-BENEFIT-CODE           PIC XX.
  6703             20  AM-BENEFIT-TYPE           PIC X.
  6704             20  AM-BENEFIT-REVISION       PIC XXX.
  6705             20  AM-BENEFIT-REM-TERM       PIC X.
  6706             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6707             20  FILLER                    PIC XX.
  6708         16  FILLER                        PIC X(80).
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 120
* EL131.cbl
  6709
  6710     12  AM-TRANSFER-DATA.
  6711         16  AM-TRANSFERRED-FROM.
  6712             20  AM-TRNFROM-CARRIER        PIC X.
  6713             20  AM-TRNFROM-GROUPING.
  6714                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6715                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6716             20  AM-TRNFROM-STATE          PIC XX.
  6717             20  AM-TRNFROM-ACCOUNT.
  6718                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6719                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6720             20  AM-TRNFROM-DTE            PIC XX.
  6721         16  AM-TRANSFERRED-TO.
  6722             20  AM-TRNTO-CARRIER          PIC X.
  6723             20  AM-TRNTO-GROUPING.
  6724                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6725                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6726             20  AM-TRNTO-STATE            PIC XX.
  6727             20  AM-TRNTO-ACCOUNT.
  6728                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6729                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6730             20  AM-TRNTO-DTE              PIC XX.
  6731         16  FILLER                        PIC X(10).
  6732
  6733     12  AM-SAVED-REMIT-TO                 PIC 99.
  6734
  6735     12  AM-COMM-STRUCTURE-SAVED.
  6736         16  AM-DEFN-1-SAVED.
  6737             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  6738                 24  AM-AGT-SV             PIC X(10).
  6739                 24  AM-COM-TYP-SV         PIC X.
  6740                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  6741                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  6742                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  6743                 24  AM-RECALC-LV-INDIC-SV PIC X.
  6744                 24  FILLER                PIC X.
  6745                 24  AM-GL-CODES-SV        PIC X.
  6746                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  6747                 24  FILLER                PIC X.
  6748         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  6749             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  6750                 24  FILLER                PIC X(11).
  6751                 24  AM-L-COMA-SV          PIC XXX.
  6752                 24  AM-J-COMA-SV          PIC XXX.
  6753                 24  AM-A-COMA-SV          PIC XXX.
  6754                 24  FILLER                PIC X(6).
  6755
  6756     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  6757         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  6758            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  6759            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  6760            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  6761
  6762     12  AM-ORIG-DEALER-NO                 PIC X(10).
  6763     12  FILLER                            PIC X(120).
  6764
  6765     12  AM-ACCOUNT-EXECUTIVE-DATA.
  6766         16  AM-CONTROL-NAME               PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 121
* EL131.cbl
  6767         16  AM-EXECUTIVE-ONE.
  6768             20  AM-EXEC1-NAME             PIC X(15).
  6769             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  6770                                                          COMP-3.
  6771             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  6772                                                          COMP-3.
  6773         16  AM-EXECUTIVE-TWO.
  6774             20  AM-EXEC2-NAME             PIC X(15).
  6775             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  6776                                                          COMP-3.
  6777             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  6778                                                          COMP-3.
  6779
  6780     12  AM-RETRO-ADDITIONAL-DATA.
  6781         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  6782         16  AM-RETRO-PREM-P-E             PIC X.
  6783         16  AM-RETRO-CLMS-P-I             PIC X.
  6784         16  AM-RETRO-RET-BRACKET-LF.
  6785             20  AM-RETRO-RET-METHOD-LF    PIC X.
  6786                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  6787                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  6788             20  AM-RETRO-RET-BASIS-LF     PIC X.
  6789                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  6790                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  6791             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  6792                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  6793                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  6794         16  AM-RETRO-RET-BRACKET-AH.
  6795             20  AM-RETRO-RET-METHOD-AH    PIC X.
  6796                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  6797                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  6798                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  6799             20  AM-RETRO-RET-BASIS-AH     PIC X.
  6800                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  6801                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  6802             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  6803                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  6804                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  6805
  6806     12  AM-COMMENTS.
  6807         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  6808
  6809     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  6810         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  6811         16  AM-FLI-BILLING-CODE           PIC X.
  6812         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  6813         16  AM-FLI-UNITED-IDENT           PIC X.
  6814         16  AM-FLI-INTEREST-LOST-DATA.
  6815             20  AM-FLI-BANK-NO            PIC X(5).
  6816             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  6817             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  6818             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  6819         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  6820             20  AM-FLI-AGT                PIC X(9).
  6821             20  AM-FLI-AGT-COMM-ACC       PIC X.
  6822             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  6823         16  FILLER                        PIC X(102).
  6824
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 122
* EL131.cbl
  6825     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  6826         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  6827             20  AM-BENEFIT-DMD-CODE         PIC XX.
  6828             20  AM-BENEFIT-DMD-TYPE         PIC X.
  6829             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  6830             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  6831             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  6832         16  FILLER                          PIC X(10).
  6833******************************************************************
  6834
  6835*                                COPY ELCCHKQ.
  6836******************************************************************
  6837*                                                                *
  6838*                                                                *
  6839*                            ELCCHKQ.                            *
  6840*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6841*                            VMOD=2.007                          *
  6842*                                                                *
  6843*   FILE DESCRIPTION = CHECK QUE FILE                            *
  6844*                                                                *
  6845*   FILE TYPE = VSAM,KSDS                                        *
  6846*   RECORD SIZE = 100  RECFORM = FIXED                           *
  6847*                                                                *
  6848*   BASE CLUSTER = ELCHKQ                         RKP=2,LEN=7    *
  6849*       ALTERNATE PATH1 = ELCHKQ2 (BY PAYEE)      RKP=9,LEN=26   *
  6850*                                                                *
  6851*   LOG = YES                                                    *
  6852*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6853******************************************************************
  6854 01  CHECK-QUE.
  6855     12  CQ-RECORD-ID                PIC XX.
  6856         88  VALID-CQ-ID         VALUE 'CQ'.
  6857
  6858     12  CQ-CONTROL-PRIMARY.
  6859         16  CQ-COMPANY-CD           PIC X.
  6860         16  CQ-CONTROL-NUMBER       PIC S9(8)       COMP.
  6861         16  CQ-SEQUENCE-NUMBER      PIC S9(4)       COMP.
  6862
  6863     12  CQ-CONTROL-BY-PAYEE.
  6864         16  CQ-CONTROL-BY-NUMBER.
  6865             20  CQ-COMPANY-CD-A1     PIC X.
  6866             20  CQ-CONTROL-NUMBER-A1 PIC S9(8)      COMP.
  6867         16  CQ-PAYEE-CARRIER        PIC X.
  6868         16  CQ-PAYEE-GROUPING       PIC X(6).
  6869         16  CQ-PAYEE-STATE          PIC XX.
  6870         16  CQ-PAYEE-BENE-ACCT      PIC X(10).
  6871         16  CQ-SEQUENCE-NUMBER-A1   PIC S9(4)       COMP.
  6872
  6873     12  CQ-DMD-CONTROL  REDEFINES  CQ-CONTROL-BY-PAYEE.
  6874         16  CQ-DMD-COMPANY-CD-A2    PIC X.
  6875         16  CQ-DMD-PAYEE-TYPE-A2    PIC X.
  6876         16  CQ-DMD-BENE-CODE-A2     PIC X(10).
  6877         16  CQ-DMD-CLAIM-NO-A2      PIC X(7).
  6878         16  CQ-DMD-TIME-SEQ-A2      PIC S9(7)       COMP.
  6879         16  FILLER                  PIC X(3).
  6880
  6881     12  CQ-ENTRY-TYPE               PIC X.
  6882             88  CHECK-ON-QUE           VALUE 'Q'.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 123
* EL131.cbl
  6883             88  ALIGNMENT-CHECK        VALUE 'A'.
  6884             88  SPOILED-CHECK          VALUE 'S'.
  6885             88  PAYMENT-ABORTED        VALUE 'X'.
  6886
  6887     12  CQ-CLAIM-MAST-CNTL.
  6888         16  CQ-CARRIER              PIC X.
  6889         16  CQ-CLAIM-NO             PIC X(7).
  6890         16  CQ-CERT-NO.
  6891             20  CQ-CERT-PRIME       PIC X(10).
  6892             20  CQ-CERT-SFX         PIC X.
  6893         16  CQ-CLAIM-TYPE           PIC X.
  6894             88  CQ-LIFE-CLAIM          VALUE 'L'.
  6895             88  CQ-AH-CLAIM            VALUE 'A'.
  6896         16  CQ-CLAIM-SUB-TYPE       PIC X.
  6897             88  CQ-FIXED-COVERAGE      VALUE '1'.
  6898             88  CQ-O-B-COVERAGE        VALUE '2'.
  6899             88  CQ-OPEN-END-COVERAGE   VALUE '3'.
  6900
  6901     12  CQ-PMT-TRLR-SEQUENCE        PIC S9(4)       COMP.
  6902     12  CQ-CHECK-NUMBER             PIC X(7).
  6903     12  CQ-CHECK-AMOUNT             PIC S9(7)V99    COMP-3.
  6904     12  CQ-PAYMENT-TYPE             PIC X.
  6905             88  CQ-PARTIAL-PAYMENT        VALUE '1'.
  6906             88  CQ-FINAL-PAYMENT          VALUE '2'.
  6907             88  CQ-LUMP-SUM-PAYMENT       VALUE '3'.
  6908             88  CQ-ADDITIONAL-PAYMENT     VALUE '4'.
  6909             88  CQ-CHARGEABLE-EXPENSE     VALUE '5'.
  6910             88  CQ-NON-CHARGEABLE-EXPENSE VALUE '6'.
  6911             88  CQ-LIFE-PREMIUM-REFUND    VALUE '7'.
  6912             88  CQ-AH-PREMIUM-REFUND      VALUE '8'.
  6913     12  CQ-VOID-INDICATOR           PIC X.
  6914             88  CHECK-IS-STOPPED          VALUE 'S'.
  6915             88  CHECK-IS-VOID             VALUE 'V'.
  6916     12  CQ-TIMES-PRINTED            PIC S9(4)       COMP.
  6917     12  CQ-PRINT-AT-HHMM            PIC S9(4)       COMP.
  6918     12  CQ-CHECK-BY-USER            PIC X(4).
  6919     12  CQ-PRE-NUMBERING-SW         PIC X.
  6920       88  CHECKS-WERE-NOT-PRE-NUMBERED    VALUE SPACE.
  6921       88  CHECKS-WERE-PRE-NUMBERED        VALUE '1'.
  6922
  6923     12  CQ-CHECK-WRITTEN-DT         PIC XX.
  6924     12  CQ-LAST-UPDATED-BY          PIC S9(4)       COMP.
  6925     12  CQ-LEDGER-FLAG              PIC X(01).
  6926     12  CQ-VOID-AFTER-LEDGER        PIC X(01).
  6927     12  CQ-LAST-UPDATED-DT          PIC XX.
  6928     12  CQ-LAST-UPDATED-HHMMSS      PIC S9(6)       COMP-3.
  6929     12  CQ-APPLIED-TO-RCON-DT       PIC XX.
  6930
  6931     12  FILLER                      PIC X(04).
  6932
  6933******************************************************************
  6934
  6935*                                COPY ELCARCH.
  6936******************************************************************
  6937*                                                                *
  6938*                            ELCARCH.                            *
  6939*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6940*                            VMOD=2.007                          *
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 124
* EL131.cbl
  6941*                                                                *
  6942*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  6943*                                                                *
  6944*   FILE TYPE = VSAM,KSDS                                        *
  6945*   RECORD SIZE = 090  RECFORM = FIXED                           *
  6946*                                                                *
  6947*   BASE CLUSTER = ELARCH                        RKP=2,LEN=8     *
  6948*       ALTERNATE PATH1 = ELARCH2 (RECORD TYPE)  RKP=10,LEN=8    *
  6949*                                                                *
  6950*   LOG = NO                                                     *
  6951*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6952*                                                                *
  6953*  THERE ARE CID MODS IN COPYBOOK ELCARCH                        *
  6954******************************************************************
  6955 01  LETTER-ARCHIVE.
  6956     12  LA-RECORD-ID                PIC XX.
  6957         88  VALID-LA-ID                VALUE 'LA'.
  6958
  6959     12  LA-CONTROL-PRIMARY.
  6960         16  LA-COMPANY-CD           PIC X.
  6961         16  LA-ARCHIVE-NO           PIC S9(8)     COMP.
  6962         16  LA-RECORD-TYPE          PIC X.
  6963             88  LA-HEADER-DATA         VALUE '1'.
  6964             88  LA-ADDRESS-DATA        VALUE '2'.
  6965             88  LA-TEXT-DATA           VALUE '3'.
  6966             88  LA-FORM-CONTROL-HDR    VALUE '4'.
  6967         16  LA-LINE-SEQ-NO          PIC S9(4)     COMP.
  6968
  6969     12  LA-CONTROL-BY-TYPE.
  6970         16  LA-COMPANY-CD-A1        PIC X.
  6971         16  LA-RECORD-TYPE-A1       PIC X.
  6972         16  LA-ARCHIVE-NO-A1        PIC S9(8)     COMP.
  6973         16  LA-LINE-SEQ-NO-A1       PIC S9(4)     COMP.
  6974
  6975     12  LA-TEXT-RECORD.
  6976         16  LA-SKIP-CONTROL         PIC XX.
  6977             88  NO-LINES-SKIPPED       VALUE SPACES.
  6978             88  SKIP-TO-NEXT-PAGE      VALUE '99'.
  6979         16  LA-TEXT-LINE            PIC X(70).
  6980
  6981     12  LA-ADDRESS-RECORD  REDEFINES  LA-TEXT-RECORD.
  6982         16  FILLER                  PIC XX.
  6983         16  LA-ADDRESS-LINE         PIC X(30).
  6984         16  FILLER                  PIC X(40).
  6985
  6986     12  LA-HEADER-RECORD  REDEFINES  LA-TEXT-RECORD.
  6987         16  FILLER                  PIC XX.
  6988         16  LA-CARRIER              PIC X.
  6989         16  LA-CLAIM-NO             PIC X(7).
  6990         16  LA-CERT-NO.
  6991             20  LA-CERT-PRIME       PIC X(10).
  6992             20  LA-CERT-SFX         PIC X.
  6993         16  LA-NO-OF-COPIES         PIC S9.
  6994         16  LA-RESEND-DATE          PIC XX.
  6995         16  LA-PROCESSOR-CD         PIC X(4).
  6996         16  LA-CREATION-DT          PIC XX.
  6997         16  LA-INITIAL-PRINT-DATE   PIC XX.
  6998         16  LA-RESEND-PRINT-DATE    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 125
* EL131.cbl
  6999         16  LA-CORR-TRLR-SEQ        PIC S9(4)    COMP.
  7000         16  LA-1ST-RESEND-PRINT-DT  PIC XX.
  7001*
  7002* -----  16  LA-DMD-ADDITIONAL-FIELDS.
  7003*   I        20  LA-DMD-LETTER-FORM      PIC X(4).
  7004*   I        20  LA-DMD-PROD-CODE        PIC XX.
  7005*   I        20  LA-DMD-RES-ST           PIC XX.
  7006*   I        20  LA-DMD-CORR-TRLR-SEQ    PIC S9(4)    COMP.
  7007*   I        20  LA-DMD-LETTER-STATUS    PIC X.
  7008*  NEW           88  LA-DMD-LETTER-ONLINE   VALUE '1'.
  7009*  DMD           88  LA-DMD-LETTER-PURGED   VALUE '2'.
  7010*  CHGS          88  LA-DMD-LETTER-RELOADED VALUE '3'.
  7011*   I        20  LA-DMD-LETTER-PURGE-DT  PIC XX.
  7012*   I        20  LA-DMD-LETTER-RELOAD-DT PIC XX.
  7013*   I        20  LA-DMD-UND-CODE         PIC XX.
  7014*   I        20  LA-DMD-BEN-CODE         PIC XX.
  7015*   V    16  FILLER                  PIC X(15).
  7016* -----
  7017*
  7018* REINSERTED  CSO  MODS
  7019*
  7020         16  FILLER.
  7021             20  FILLER                  PIC X(29).
  7022             20  LA-CSO-LETTER-STATUS    PIC X.
  7023                 88  LA-CSO-LETTER-ONLINE   VALUE '1'.
  7024                 88  LA-CSO-LETTER-PURGED   VALUE '2'.
  7025                 88  LA-CSO-LETTER-RELOADED VALUE '3'.
  7026             20  LA-CSO-LETTER-PURGE-DT  PIC XX.
  7027             20  LA-CSO-LETTER-RELOAD-DT PIC XX.
  7028*
  7029
  7030     12  LA-FORM-CONTROL-HEADER REDEFINES  LA-TEXT-RECORD.
  7031         16  FILLER                  PIC XX.
  7032         16  LA4-CARRIER             PIC X.
  7033         16  LA4-CLAIM-NO            PIC X(7).
  7034         16  LA4-CERT-NO.
  7035             20  LA4-CERT-PRIME      PIC X(10).
  7036             20  LA4-CERT-SFX        PIC X.
  7037         16  LA4-NO-OF-COPIES        PIC S9.
  7038         16  LA4-RESEND-DATE         PIC XX.
  7039         16  LA4-PROCESSOR-CD        PIC X(4).
  7040         16  LA4-CREATION-DT         PIC XX.
  7041         16  LA4-INITIAL-PRINT-DATE  PIC XX.
  7042         16  LA4-RESEND-PRINT-DATE   PIC XX.
  7043         16  LA4-FORM-TRLR-SEQ       PIC S9(4)    COMP.
  7044         16  LA4-FORM-TYPE           PIC X.
  7045             88  LA4-INITIAL-FORM    VALUE '1'.
  7046             88  LA4-PROGRESS-FORM   VALUE '2'.
  7047         16  LA4-FORM-REM-PRINT-DT   PIC X(02).
  7048         16  LA4-STATE               PIC X(02).
  7049         16  FILLER                  PIC X(31).
  7050******************************************************************
  7051
  7052*                                COPY ELCBENE.
  7053******************************************************************
  7054*                                                                *
  7055*                            ELCBENE.                            *
  7056*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 126
* EL131.cbl
  7057*                            VMOD=2.006                          *
  7058*                                                                *
  7059*   FILE DESCRIPTION = BENEFICIARY FILE                          *
  7060*                                                                *
  7061*   FILE TYPE = VSAM,KSDS                                        *
  7062*   RECORD SIZE = 500   RECFORM = FIX                            *
  7063*                                                                *
  7064*   BASE CLUSTER NAME = ELBENE                   RKP=2,LEN=12    *
  7065*     ALTERNATE PATH1 = ELBENE2 (ALT BY NAME)    RKP=14,LEN=42   *
  7066*                                                                *
  7067*   LOG = YES                                                    *
  7068*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7069*                                                                *
  7070*  NO  CID  MODS  TO  COPYBOOK  ELCBENE                          *
  7071******************************************************************
  7072*                   C H A N G E   L O G
  7073*
  7074* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7075*-----------------------------------------------------------------
  7076*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7077* EFFECTIVE    NUMBER
  7078*-----------------------------------------------------------------
  7079* 013017  CR2016053100001  PEMA  ACH PROCESSING
  7080* 082317  CR2017082100003  PEMA  Add sub type
  7081* 032019  CR2019011400002  PEMA  Add email address for ach report
  7082******************************************************************
  7083
  7084 01  BENEFICIARY-MASTER.
  7085     12  BE-RECORD-ID                PIC XX.
  7086         88  VALID-BE-ID                VALUE 'BE'.
  7087
  7088     12  BE-CONTROL-PRIMARY.
  7089         16  BE-COMPANY-CD           PIC X.
  7090         16  BE-RECORD-TYPE          PIC X.
  7091             88  BENEFICIARY-RECORD  VALUE 'B'.
  7092             88  ADJUSTOR-RECORD     VALUE 'A'.
  7093         16  BE-BENEFICIARY          PIC X(10).
  7094     12  BE-CONTROL-BY-NAME.
  7095         16  BE-COMPANY-CD-A1        PIC X.
  7096         16  BE-RECORD-TYPE-A1       PIC X.
  7097         16  BE-MAIL-TO-NAME-A1      PIC X(30).
  7098         16  BE-ALTERNATE-PRIME-A1   PIC X(10).
  7099
  7100     12  BE-LAST-MAINT-DT            PIC XX.
  7101     12  BE-LAST-MAINT-BY            PIC X(4).
  7102     12  BE-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  7103
  7104     12  BE-ADDRESS-DATA.
  7105         16  BE-MAIL-TO-NAME         PIC X(30).
  7106         16  BE-ADDRESS-LINE-1       PIC X(30).
  7107         16  BE-ADDRESS-LINE-2       PIC X(30).
  7108         16  BE-ADDRESS-LINE-3       PIC X(30).
  7109         16  BE-CITY-STATE.
  7110             20  BE-CITY             PIC X(28).
  7111             20  BE-STATE            PIC XX.
  7112         16  BE-ZIP-CODE.
  7113             20  BE-ZIP-PRIME.
  7114                 24  BE-ZIP-1ST      PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 127
* EL131.cbl
  7115                     88  BE-CANADIAN-POST-CODE
  7116                                         VALUE 'A' THRU 'Z'.
  7117                 24  FILLER          PIC X(4).
  7118             20  BE-ZIP-PLUS4        PIC X(4).
  7119         16  BE-CANADIAN-POSTAL-CODE  REDEFINES  BE-ZIP-CODE.
  7120             20  BE-CAN-POSTAL-1     PIC XXX.
  7121             20  BE-CAN-POSTAL-2     PIC XXX.
  7122             20  FILLER              PIC XXX.
  7123         16  BE-PHONE-NO             PIC 9(11)     COMP-3.
  7124         16  BE-GROUP-CHECKS-Y-N     PIC X.
  7125
  7126******************************************************************
  7127*    THE BE-CARRIER FIELD IS USED BY 'AIG' TO DETERMINE HOW TO   *
  7128*    SET THE CARRIER CODE IN THE PENDING CLAIM FILE.             *
  7129******************************************************************
  7130     12  BE-CARRIER                  PIC X.
  7131
  7132     12  BE-ADDRESS-DATA2.
  7133         16  BE-MAIL-TO-NAME2        PIC X(30).
  7134         16  BE-ADDRESS-LINE-12      PIC X(30).
  7135         16  BE-ADDRESS-LINE-22      PIC X(30).
  7136         16  BE-ADDRESS-LINE-32      PIC X(30).
  7137         16  BE-CITY-STATE2.
  7138             20  BE-CITY2            PIC X(28).
  7139             20  BE-STATE2           PIC XX.
  7140         16  BE-ZIP-CODE2.
  7141             20  BE-ZIP-PRIME2.
  7142                 24  BE-ZIP-1ST2     PIC X.
  7143                     88  BE-CANADIAN-POST-CODE2
  7144                                         VALUE 'A' THRU 'Z'.
  7145                 24  FILLER          PIC X(4).
  7146             20  BE-ZIP-PLUS42       PIC X(4).
  7147         16  BE-CANADIAN-POSTAL-CODE2 REDEFINES  BE-ZIP-CODE2.
  7148             20  BE-CAN-POSTAL-12    PIC XXX.
  7149             20  BE-CAN-POSTAL-22    PIC XXX.
  7150             20  FILLER              PIC XXX.
  7151         16  BE-PHONE-NO2            PIC 9(11)     COMP-3.
  7152         16  BE-ACH-DATA.
  7153             20  BE-ACH-YES-OR-NO    PIC X.
  7154                 88  BE-ON-ACH       VALUE 'Y'.
  7155                 88  BE-NOT-ON-ACH   VALUE 'N' ' '.
  7156             20  BE-ACH-ABA-ROUTING-NUMBER
  7157                                     PIC X(15).
  7158             20  BE-ACH-BANK-ACCOUNT-NUMBER
  7159                                     PIC X(20).
  7160             20  BE-ACH-SUB-TYPE     PIC XX.
  7161             20  BE-ACH-EMAIL-YN     PIC X.
  7162                 88  BE-EMAIL-ACH-RPT  VALUE 'Y'.
  7163             20  be-ach-email-addr   PIC X(40).
  7164         16  BE-BILLING-STMT-DATA.
  7165*            20  BE-BSR-PHONE-NUM    PIC 9(11)     COMP-3.
  7166             20  BE-BSR-FAX-NUM      PIC 9(11)     COMP-3.
  7167             20  BE-OUTPUT-TYPE      PIC X.
  7168                 88  BE-FAX-OUTPUT         VALUE 'F'.
  7169                 88  BE-PRINT-OUTPUT       VALUE 'P' ' '.
  7170
  7171     12  filler                      PIC X(16).
  7172******************************************************************
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 128
* EL131.cbl
  7173
  7174*                                COPY ELCDAR.
  7175******************************************************************
  7176*                                                                *
  7177*   FILE DESC. = DAILY ACTIVITY FILE, FOR PROCESSING NITELY      *
  7178*   FILE TYPE = VSAM,KSDS                                        *
  7179*   RECORD SIZE = 25   RECFORM = FIXED                           *
  7180*   BASE CLUSTER = DLYACTV                                       *
  7181*   LOG = YES                                                    *
  7182*   NARRATIVE - FILE IS BUILT DURING DAYTIME CICS PROCESSING AND *
  7183*               IS THEN PROCESSED BY CYCLE PROCESSING AT NIGHT.  *
  7184*               THIS IS USED TO BUILD THE LOGIC "F" EXTRACT      *
  7185*               RECORDS FOR THOSE CLAIMS WHICH HAVE HAD ACTIVITY *
  7186*               DURING THE DAY. THE EXTRACTS THEN GET READ IN    *
  7187*               BY PROGRAM "LGINFCE".                            *
  7188*                                                                *
  7189******************************************************************
  7190 01  DAILY-ACTIVITY-RECORD.
  7191     05  DA-KEY.
  7192         10  DA-COMP-CD          PIC X.
  7193         10  DA-CARRIER          PIC X.
  7194         10  DA-CLAIM-NO         PIC X(7).
  7195         10  DA-CERT-NO.
  7196             15  DA-CERT-PRIME   PIC X(10).
  7197             15  DA-CERT-SFX     PIC X.
  7198     05  DA-TRAILER-SEQ-NO       PIC S9(4)  COMP.
  7199     05  DA-RECORD-TYPE          PIC X.
  7200     05  FILLER                  PIC X(2).
  7201******************************************************************
  7202
  7203*                                COPY ELCALPH.
  7204******************************************************************
  7205*                                                                *
  7206*                            ELCALPH.                            *
  7207*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7208*                            VMOD=2.003                          *
  7209*                                                                *
  7210*   FILE DESCRIPTION = ALPHA CROSS REFERENCE FILE                *
  7211*                                                                *
  7212*   FILE TYPE = VSAM,KSDS                                        *
  7213*   RECORD SIZE = 128  RECFORM = FIXED                           *
  7214*                                                                *
  7215*   BASE CLUSTER = ELALPH                         RKP=2,LEN=42   *
  7216*       ALTERNATE PATH1 = ELALPH2 (FULL CONTROL)  RKP=44,LEN=57  *
  7217*                                                                *
  7218*   LOG = YES                                                    *
  7219*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7220*                                                                *
  7221*  NO  CID  MODS  IN  COPYBOOK  ELCALPH                          *
  7222******************************************************************
  7223
  7224 01  ALPHA-INDEX.
  7225     12  AI-RECORD-ID                         PIC XX.
  7226         88  VALID-AI-ID                  VALUE 'AI'.
  7227     12  AI-CONTROL-PRIMARY.
  7228         16  AI-COMPANY-CD                     PIC X.
  7229         16  AI-SOURCE                         PIC X.
  7230             88  AI-CLAIM-SYSTEM          VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 129
* EL131.cbl
  7231             88  AI-ADMIN-SYSTEM          VALUE 'A'.
  7232         16  AI-NAME.
  7233             20  AI-LAST-NAME                  PIC X(15).
  7234             20  AI-FIRST-NAME.
  7235                 24  AI-FIRST-INITIAL          PIC X.
  7236                 24  FILLER                    PIC X(11).
  7237             20  AI-MIDDLE-INIT                PIC X.
  7238         16  AI-DATE                           PIC X(8).
  7239         16  AI-TIME                           PIC S9(07) COMP-3.
  7240
  7241     12  AI-CONTROL-BY-ADMIN-KEY.
  7242         16  AI-CM-COMPANY-CD                  PIC X.
  7243         16  AI-CM-SOURCE                      PIC X.
  7244         16  AI-CM-CARRIER                     PIC X.
  7245         16  AI-CM-GROUPING.
  7246             20  AI-CM-GROUPING-PREFIX         PIC X(3).
  7247             20  AI-CM-GROUPING-PRIME          PIC X(3).
  7248         16  AI-CM-STATE                       PIC XX.
  7249         16  AI-CM-PRODUCER.
  7250             20  AI-CM-PRODUCER-PREFIX         PIC X(4).
  7251             20  AI-CM-PRODUCER-PRIME          PIC X(6).
  7252         16  AI-CM-CERT-EFF-DT                 PIC XX.
  7253         16  AI-CM-CERTIFICATE-NUMBER.
  7254             20  AI-CM-CERT-PRIME              PIC X(10).
  7255             20  AI-CM-CERT-SFX                PIC X.
  7256         16  AI-CM-DATE                        PIC X(8).
  7257         16  AI-CM-TIME                        PIC S9(7) COMP-3.
  7258         16  FILLER                            PIC X(11).
  7259
  7260     12  AI-CONTROL-BY-CLAIM-KEY REDEFINES
  7261         AI-CONTROL-BY-ADMIN-KEY.
  7262         16  AI-CL-COMPANY-CD                  PIC X.
  7263         16  AI-CL-SOURCE                      PIC X.
  7264         16  AI-CL-CARRIER                     PIC X.
  7265         16  AI-CL-CLAIM-NUMBER                PIC X(7).
  7266         16  AI-CL-CERTIFICATE-NUMBER.
  7267             20  AI-CL-CERT-PRIME              PIC X(10).
  7268             20  AI-CL-CERT-SFX                PIC X.
  7269         16  AI-CL-DATE                        PIC X(8).
  7270         16  AI-CL-INCURRED-DATE               PIC XX.
  7271         16  AI-CL-CLOSE-DATE                  PIC XX.
  7272         16  AI-CL-TIME                        PIC S9(7)  COMP-3.
  7273         16  AI-CREDIT-CARD-NUMBER.
  7274             20  AI-CCN.
  7275                 24  AI-CCN-PREFIX             PIC X(4).
  7276                 24  AI-CCN-PRIME              PIC X(12).
  7277             20  AI-CCN-FILLER                 PIC X(4).
  7278
  7279     12  AI-MAINT-INFO.
  7280         16  AI-LAST-MAINT-BY                  PIC X(4).
  7281         16  AI-LAST-MAINT-DT                  PIC XX.
  7282         16  AI-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  7283
  7284     12  AI-CLAIM-PAID-THRU-DT                 PIC XX.
  7285
  7286     12  FILLER                                PIC X(15).
  7287
  7288
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 130
* EL131.cbl
  7289*                                COPY ERCDMDNT.
  7290******************************************************************
  7291*                                                                *
  7292*                            ERCDMDNT                            *
  7293*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7294*                            VMOD=2.005                          *
  7295*                                                                *
  7296*        FILE DESCRIPTION = DMD CERTIFICATE NOTES                *
  7297*                                                                *
  7298*        THIS COPYBOOK IS A REDEFINES OF ERCNOTE -               *
  7299*                                                                *
  7300*        FILE TYPE= VSAM,KSDS                                    *
  7301*        RECORD SIZE = 825    RECFORM = FIXED                    *
  7302*                                                                *
  7303*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  7304*                                                                *
  7305*        LOG = YES                                               *
  7306*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7307*                                                                *
  7308******************************************************************
  7309
  7310 01  CERTIFICATE-NOTE.
  7311     12  CN-RECORD-ID                     PIC  XX.
  7312         88  VALID-CN-ID                      VALUE 'CN'.
  7313
  7314     12  CN-CONTROL-PRIMARY.
  7315         16  CN-COMPANY-CD                PIC X.
  7316         16  CN-CERT-KEY.
  7317             20  CN-CARRIER               PIC X.
  7318             20  CN-GROUPING.
  7319                 24  CN-GROUPING-PREFIX   PIC XXX.
  7320                 24  CN-GROUPING-PRIME    PIC XXX.
  7321             20  CN-STATE                 PIC XX.
  7322             20  CN-ACCOUNT.
  7323                 24  CN-ACCOUNT-PREFIX    PIC X(4).
  7324                 24  CN-ACCOUNT-PRIME     PIC X(6).
  7325             20  CN-CERT-EFF-DT           PIC XX.
  7326             20  CN-CERT-NO.
  7327                 24  CN-CERT-PRIME        PIC X(10).
  7328                 24  CN-CERT-SFX          PIC X.
  7329
  7330     12  CN-BILLING-START-LINE-NO         PIC 99.
  7331     12  CN-BILLING-END-LINE-NO           PIC 99.
  7332
  7333     12  CN-LINES.
  7334         16  CN-LINE                      PIC X(77)  OCCURS 10.
  7335
  7336     12  CN-CSI-NOTES REDEFINES CN-LINES.
  7337         16  CN-CSI-TEXT-NOTES            PIC X(77)  OCCURS 6.
  7338         16  CN-CSI-GENERAL-DATA-AREA.
  7339             20  CN-CSI-GENERAL-DATA      PIC X(77)  OCCURS 2.
  7340
  7341         16  CN-CSI-GENERAL-DATA-R REDEFINES
  7342             CN-CSI-GENERAL-DATA-AREA.
  7343             20  CN-CSI-GEN-NOC-KEY           PIC X(11).
  7344             20  CN-CSI-GEN-PRI-INSD-1ST-NAME PIC X(15).
  7345             20  CN-CSI-GEN-SEC-INSD-1ST-NAME PIC X(15).
  7346             20  CN-CSI-GEN-INSD-WORK-PHONE   PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 131
* EL131.cbl
  7347             20  CN-CSI-GEN-INFRM-1ST-NAME    PIC X(15).
  7348             20  CN-CSI-GEN-INFRM-LAST-NAME   PIC X(20).
  7349             20  CN-CSI-GEN-INFRM-MI          PIC X.
  7350             20  CN-CSI-GEN-INFRM-PHONE       PIC X(10).
  7351             20  CN-CSI-GEN-INFRM-REL         PIC X(15).
  7352             20  FILLER                       PIC XX.
  7353             20  CN-CSI-GEN-DATA-SOURCE       PIC XX.
  7354             20  FILLER                       PIC X(38).
  7355
  7356         16  CN-CSI-PRODUCT-DATA-AREA.
  7357             20  CN-CSI-PRODUCT-DATA      PIC X(77)  OCCURS 2.
  7358
  7359         16  CN-CSI-CREDIT-CARD-DATA REDEFINES
  7360             CN-CSI-PRODUCT-DATA-AREA.
  7361             20  CN-CSI-CC-BILL-BANK-ID   PIC X(6).
  7362             20  CN-CSI-CC-CANCEL-CD      PIC XX.
  7363             20  CN-CSI-CC-CANCEL-DT      PIC X(8).
  7364             20  CN-CSI-CC-CARD-TYPE      PIC XX.
  7365             20  CN-CSI-CC-CHANGE-AGE     PIC 999.
  7366             20  CN-CSI-CC-DIAGNOSIS-CD   PIC X(6).
  7367             20  FILLER                   PIC XX.
  7368             20  CN-CSI-CC-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7369             20  CN-CSI-CC-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  7370             20  CN-CSI-CC-INTEREST-PAID  PIC X.
  7371             20  CN-CSI-CC-ISSUE-ST       PIC XX.
  7372             20  CN-CSI-CC-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7373             20  CN-CSI-CC-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7374             20  CN-CSI-CC-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7375             20  CN-CSI-CC-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7376             20  CN-CSI-CC-OLD-ACCT-NO    PIC X(20).
  7377             20  CN-CSI-CC-POLICY-TYPE    PIC XXX.
  7378             20  CN-CSI-CC-PREMIUM-AMT    PIC S999V99   COMP-3.
  7379             20  CN-CSI-CC-PREMIUM-RT     PIC S999V999  COMP-3.
  7380             20  CN-CSI-CC-PREV-CLAIM-NO  PIC X(7).
  7381             20  CN-CSI-CC-SIGNED-DT      PIC X(8).
  7382             20  CN-CSI-CC-SPECIAL-TERM   PIC S999      COMP-3.
  7383             20  CN-CSI-CC-STMNT-DT       PIC X(8).
  7384             20  CN-CSI-CC-TERM-AGE       PIC 999.
  7385             20  CN-CSI-CC-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7386             20  CN-CSI-CC-WAIV-PREM-FLAG PIC X.
  7387             20  CN-CSI-CC-ISSUE-DT       PIC X(8).
  7388             20  CN-CSI-CC-BEN-CALC-SW    PIC X.
  7389             20  CN-CSI-CC-TERM-ROUND-SW  PIC X.
  7390             20  FILLER                   PIC X(25).
  7391
  7392         16  CN-CSI-FAMILY-LEAVE-DATA REDEFINES
  7393             CN-CSI-CREDIT-CARD-DATA.
  7394             20  CN-CSI-FL-BILL-BANK-ID   PIC X(6).
  7395             20  CN-CSI-FL-CANCEL-CD      PIC XX.
  7396             20  CN-CSI-FL-CANCEL-DT      PIC X(8).
  7397             20  CN-CSI-FL-CARD-TYPE      PIC XX.
  7398             20  CN-CSI-FL-CHANGE-AGE     PIC 999.
  7399             20  CN-CSI-FL-DIAGNOSIS-CD   PIC X(6).
  7400             20  FILLER                   PIC XX.
  7401             20  CN-CSI-FL-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7402             20  CN-CSI-FL-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  7403             20  CN-CSI-FL-INTEREST-PAID  PIC X.
  7404             20  CN-CSI-FL-ISSUE-ST       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 132
* EL131.cbl
  7405             20  CN-CSI-FL-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7406             20  CN-CSI-FL-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7407             20  CN-CSI-FL-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7408             20  CN-CSI-FL-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7409             20  CN-CSI-FL-OLD-ACCT-NO    PIC X(20).
  7410             20  CN-CSI-FL-POLICY-TYPE    PIC XXX.
  7411             20  CN-CSI-FL-PREMIUM-AMT    PIC S999V99   COMP-3.
  7412             20  CN-CSI-FL-PREMIUM-RT     PIC S999V999  COMP-3.
  7413             20  CN-CSI-FL-PREV-CLAIM-NO  PIC X(7).
  7414             20  CN-CSI-FL-SIGNED-DT      PIC X(8).
  7415             20  CN-CSI-FL-SPECIAL-TERM   PIC S999      COMP-3.
  7416             20  CN-CSI-FL-STMNT-DT       PIC X(8).
  7417             20  CN-CSI-FL-TERM-AGE       PIC 999.
  7418             20  CN-CSI-FL-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7419             20  CN-CSI-FL-WAIV-PREM-FLAG PIC X.
  7420             20  CN-CSI-FL-ISSUE-DT       PIC X(8).
  7421             20  CN-CSI-FL-BEN-CALC-SW    PIC X.
  7422             20  CN-CSI-FL-TERM-ROUND-SW  PIC X.
  7423             20  CN-CSI-FL-LAST-DAY-WRKED PIC X(8).
  7424             20  FILLER                   PIC X(17).
  7425
  7426         16  CN-CSI-SENIOR-LIFE-DATA REDEFINES
  7427             CN-CSI-FAMILY-LEAVE-DATA.
  7428             20  CN-CSI-SL-BENE-DOB       PIC X(8).
  7429             20  CN-CSI-SL-BENE-NAME      PIC X(27).
  7430             20  CN-CSI-SL-BENE-REL       PIC X(8).
  7431             20  CN-CSI-SL-BENE-SSN       PIC S9(9)     COMP-3.
  7432             20  CN-CSI-SL-BILL-BANK-ID   PIC X(6).
  7433             20  CN-CSI-SL-CANCEL-DT      PIC X(8).
  7434             20  CN-CSI-SL-DIAGNOSIS-CD   PIC X(6).
  7435             20  CN-CSI-SL-INT-CHECK-DT   PIC X(8).
  7436             20  CN-CSI-SL-INT-CHECK-NO   PIC S9(7)     COMP-3.
  7437             20  CN-CSI-SL-INT-ON-PROCEEDS
  7438                                          PIC S9(5)V99  COMP-3.
  7439             20  CN-CSI-SL-ISSUE-DT       PIC X(8).
  7440             20  CN-CSI-SL-ISSUE-ST       PIC XX.
  7441             20  CN-CSI-SL-LIFE-PROCEEDS  PIC S9(5)V99  COMP-3.
  7442             20  CN-CSI-SL-LOAN-INT-DUE   PIC S9(5)V99  COMP-3.
  7443             20  CN-CSI-SL-POLICY-BENEFITS
  7444                                          PIC S9(5)V99  COMP-3.
  7445             20  CN-CSI-SL-POLICY-TYPE    PIC XXX.
  7446             20  CN-CSI-SL-PREM-AMT       PIC S9(5)V99  COMP-3.
  7447             20  CN-CSI-SL-PREM-CHECK-DT  PIC X(8).
  7448             20  CN-CSI-SL-PREM-CHECK-NO  PIC S9(7)     COMP-3.
  7449             20  CN-CSI-SL-PREM-DUE       PIC S9(5)V99  COMP-3.
  7450             20  CN-CSI-SL-PREM-MODE      PIC 99.
  7451             20  CN-CSI-SL-PREM-REFUND    PIC S9(5)V99  COMP-3.
  7452             20  CN-CSI-SL-PREM-SUSP-DT   PIC X(8).
  7453             20  CN-CSI-SL-SIGNED-DT      PIC X(8).
  7454             20  CN-CSI-SL-STATE-NOT      PIC X.
  7455             20  FILLER                   PIC XX.
  7456
  7457         16  CN-CSI-PURCH-PROP-DATA REDEFINES
  7458             CN-CSI-SENIOR-LIFE-DATA.
  7459             20  CN-CSI-PP-CARD-TYPE      PIC XX.
  7460             20  CN-CSI-PP-CHANGE-AGE     PIC 999.
  7461             20  CN-CSI-PP-BEN-PAID-TO-DATE
  7462                                          PIC S9(5)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 133
* EL131.cbl
  7463             20  CN-CSI-PP-BILL-BANK-ID   PIC X(6).
  7464             20  CN-CSI-PP-CANCEL-CD      PIC XX.
  7465             20  CN-CSI-PP-CANCEL-DT      PIC X(8).
  7466             20  CN-CSI-PP-DIAGNOSIS-CD   PIC X(6).
  7467             20  CN-CSI-PP-ISSUE-DT       PIC X(8).
  7468             20  CN-CSI-PP-ISSUE-ST       PIC XX.
  7469             20  CN-CSI-PP-MANUFACTURER   PIC X(17).
  7470             20  CN-CSI-PP-MODEL-NO       PIC X(8).
  7471             20  CN-CSI-PP-OLD-ACCT-NO    PIC X(20).
  7472             20  CN-CSI-PP-POLICY-TYPE    PIC XXX.
  7473             20  CN-CSI-PP-PREMIUM-RT     PIC S999V999  COMP-3.
  7474             20  CN-CSI-PP-PREV-CLAIM-NO  PIC X(7).
  7475             20  CN-CSI-PP-PURCHASE-DT    PIC X(8).
  7476             20  CN-CSI-PP-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7477             20  CN-CSI-PP-REPAIR         PIC X.
  7478             20  CN-CSI-PP-REPLACE        PIC X.
  7479             20  CN-CSI-PP-SERIAL-NO      PIC X(16).
  7480             20  CN-CSI-PP-SIGNED-DT      PIC X(8).
  7481             20  CN-CSI-PP-STMNT-DT       PIC X(8).
  7482             20  CN-CSI-PP-TERM-AGE       PIC 999.
  7483             20  FILLER                   PIC X(5).
  7484
  7485         16  CN-CSI-EXT-WARR-DATA REDEFINES
  7486             CN-CSI-PURCH-PROP-DATA.
  7487             20  CN-CSI-EW-CARD-TYPE      PIC XX.
  7488             20  CN-CSI-EW-CHANGE-AGE     PIC 999.
  7489             20  CN-CSI-EW-BILL-BANK-ID   PIC X(6).
  7490             20  CN-CSI-EW-CANCEL-CD      PIC XX.
  7491             20  CN-CSI-EW-CANCEL-DT      PIC X(8).
  7492             20  CN-CSI-EW-DIAGNOSIS-CD   PIC X(6).
  7493             20  CN-CSI-EW-ISSUE-DT       PIC X(8).
  7494             20  CN-CSI-EW-ISSUE-ST       PIC XX.
  7495             20  CN-CSI-EW-MANUFACTURER   PIC X(17).
  7496             20  CN-CSI-EW-MODEL-NO       PIC X(8).
  7497             20  CN-CSI-EW-OLD-ACCT-NO    PIC X(20).
  7498             20  CN-CSI-EW-POLICY-TYPE    PIC XXX.
  7499             20  CN-CSI-EW-PREMIUM-RT     PIC S999V999  COMP-3.
  7500             20  CN-CSI-EW-PREV-CLAIM-NO  PIC X(7).
  7501             20  CN-CSI-EW-PURCHASE-DT    PIC X(8).
  7502             20  CN-CSI-EW-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7503             20  CN-CSI-EW-REPAIR-COST    PIC S9(5)V99  COMP-3.
  7504             20  CN-CSI-EW-REPLACE        PIC X.
  7505             20  CN-CSI-EW-SERIAL-NO      PIC X(16).
  7506             20  CN-CSI-EW-SIGNED-DT      PIC X(8).
  7507             20  CN-CSI-EW-STMNT-DT       PIC X(8).
  7508             20  CN-CSI-EW-TERM-AGE       PIC 999.
  7509             20  CN-CSI-EW-WARRANTY-NO    PIC 99.
  7510             20  FILLER                   PIC X(4).
  7511
  7512     12  CN-LAST-MAINT-DT                 PIC XX.
  7513     12  CN-LAST-MAINT-HHMMSS             PIC S9(7)     COMP-3.
  7514     12  CN-LAST-MAINT-USER               PIC X(4).
  7515     12  FILLER                           PIC X(6).
  7516
  7517******************************************************************
  7518
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 134
* EL131.cbl
  7520 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CLAIM-MASTER
  7521                          CERTIFICATE-MASTER ACTIVITY-TRAILERS
  7522                          CONTROL-FILE ACTIVITY-QUE
  7523                          ACCOUNT-MASTER CHECK-QUE
  7524                          LETTER-ARCHIVE BENEFICIARY-MASTER
  7525                          DAILY-ACTIVITY-RECORD ALPHA-INDEX
  7526                          CERTIFICATE-NOTE.
  7527 0000-DFHEXIT SECTION.
  7528     MOVE '9#                    $   ' TO DFHEIV0.
  7529     MOVE 'EL131' TO DFHEIV1.
  7530     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7531
  7532     IF EIBCALEN = ZERO
  7533         GO TO 8800-UNAUTHORIZED-ACCESS.
  7534
  7535     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  7536     MOVE '5'                    TO DC-OPTION-CODE.
  7537     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  7538     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  7539     MOVE DC-GREG-DATE-1-YMD     TO  SAVE-DATE-YMD.
  7540     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  7541
  7542     IF SAVE-DATE-YY GREATER 70
  7543         MOVE 19                 TO SAVE-DATE-CC
  7544      ELSE
  7545         MOVE 20                 TO SAVE-DATE-CC.
  7546
  7547
  7548* EXEC CICS HANDLE CONDITION
  7549*        PGMIDERR (8820-XCTL-ERROR)
  7550*        NOTFND   (8150-ENTERED-CLAIM-NOTFOUND)
  7551*        ERROR    (9990-ABEND)
  7552*    END-EXEC.
  7553*    MOVE '"$LI.                 ! " #00007543' TO DFHEIV0
  7554     MOVE X'22244C492E20202020202020' TO DFHEIV0(1:12)
  7555     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7556     MOVE X'2220233030303037353433' TO DFHEIV0(25:11)
  7557     CALL 'kxdfhei1' USING DFHEIV0
  7558     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7559
  7560
  7561     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  7562     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  7563     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  7564
  7565     INITIALIZE    EDIT-WORK-AREA.
  7566     MOVE '/'                    TO WORK-SLASH.
  7567     MOVE SPACES                 TO ERROR-SWITCHES.
  7568
  7569     MOVE TRAN-ID                TO TRANS-ID.
  7570     MOVE EIBTRMID               TO PI-TERM.
  7571     MOVE MAP-ID                 TO PI-QUAL.
  7572
  7573     MOVE 2                      TO EMI-NUMBER-OF-LINES.
  7574
  7575     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  7576         MOVE LOW-VALUES         TO EL131AO
  7577         MOVE ER-0008            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 135
* EL131.cbl
  7578         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7579         MOVE -1                 TO MAINTL
  7580         GO TO 8110-SEND-DATA.
  7581
  7582     IF THIS-PGM NOT = PI-CALLING-PROGRAM
  7583         MOVE LOW-VALUES         TO EL131AO
  7584         MOVE PI-CALLING-PROGRAM TO WS-RETURNED-FROM
  7585         PERFORM 0100-UPDATE-PI THRU 0120-UPDATE-PI-EXIT
  7586         MOVE 'X'                TO PI-RETURN-CD-1
  7587         PERFORM 5000-BUILD-MAP THRU 5000-EXIT
  7588         MOVE -1                 TO MAINTL
  7589         IF WS-RETURNED-FROM = XCTL-EL114
  7590             PERFORM 4200-LOAD-CHANGES THRU 4200-EXIT
  7591         END-IF
  7592         GO TO 8100-SEND-MAP.
  7593
  7594     IF EIBAID = DFHCLEAR
  7595         GO TO 8200-RETURN-PRIOR.
  7596
  7597     IF PI-PROCESSOR-ID = 'LGXX'
  7598         NEXT SENTENCE
  7599     ELSE
  7600
  7601* EXEC CICS READQ TS
  7602*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  7603*            INTO    (SECURITY-CONTROL)
  7604*            LENGTH  (SC-COMM-LENGTH)
  7605*            ITEM    (SC-ITEM)
  7606*        END-EXEC
  7607*    MOVE '*$II   L              ''   #00007588' TO DFHEIV0
  7608     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  7609     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7610     MOVE X'2020233030303037353838' TO DFHEIV0(25:11)
  7611     CALL 'kxdfhei1' USING DFHEIV0,
  7612           PI-SECURITY-TEMP-STORE-ID,
  7613           SECURITY-CONTROL,
  7614           SC-COMM-LENGTH,
  7615           SC-ITEM,
  7616           DFHEIV99,
  7617           DFHEIV99
  7618     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7619         MOVE SC-CLAIMS-DISPLAY (5)    TO  PI-DISPLAY-CAP
  7620         MOVE SC-CLAIMS-UPDATE  (5)    TO  PI-MODIFY-CAP
  7621         IF NOT DISPLAY-CAP
  7622             MOVE 'READ'               TO  SM-READ
  7623             PERFORM 9995-SECURITY-VIOLATION
  7624             MOVE ER-0070              TO  EMI-ERROR
  7625             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7626             GO TO 8100-SEND-MAP.
  7627
  7628
  7629* EXEC CICS RECEIVE
  7630*        MAP    ('EL131A')
  7631*        MAPSET ('EL131S')
  7632*    END-EXEC.
  7633     MOVE 'EL131A' TO DFHEIV1
  7634     MOVE 'EL131S' TO DFHEIV2
  7635*    MOVE '8"T                   ''   #00007603' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 136
* EL131.cbl
  7636     MOVE X'382254202020202020202020' TO DFHEIV0(1:12)
  7637     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7638     MOVE X'2020233030303037363033' TO DFHEIV0(25:11)
  7639     CALL 'kxdfhei1' USING DFHEIV0,
  7640           DFHEIV1,
  7641           EL131AI,
  7642           DFHEIV99,
  7643           DFHEIV2,
  7644           DFHEIV99,
  7645           DFHEIV99
  7646     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7647
  7648
  7649     IF PFKEYL GREATER THAN ZERO
  7650         PERFORM 0200-TRANS-PF THRU 0210-EXIT.
  7651
  7652     IF SCREEN-ERROR
  7653         MOVE ER-0004 TO EMI-ERROR
  7654         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7655         MOVE -1 TO MAINTL
  7656         GO TO 8110-SEND-DATA.
  7657
  7658     IF EIBAID = DFHPF3
  7659         GO TO 8500-TRLR-MNT.
  7660
  7661     IF EIBAID = DFHPF4
  7662         GO TO 8600-ADDR-MNT.
  7663
  7664     IF EIBAID = DFHPF5
  7665         GO TO 8700-CERT-MNT.
  7666
  7667     IF PI-COMPANY-ID = 'DMD'
  7668       IF EIBAID = DFHPF6
  7669         GO TO 8750-DMD-CLM-FIX.
  7670
  7671     IF EIBAID = DFHPF7
  7672         GO TO 4000-FORCE-ERRORS.
  7673
  7674     IF EIBAID = DFHPF12
  7675         GO TO 8300-GET-HELP.
  7676
  7677     IF EIBAID = DFHPF15
  7678         GO TO 8725-BENEFICIARY-MNT
  7679     END-IF.
  7680
  7681     IF EIBAID = DFHPF23
  7682         GO TO 8810-PF23-ENTERED.
  7683
  7684     IF EIBAID = DFHPF24
  7685         GO TO 8400-RETURN-MASTER.
  7686
  7687     IF EIBAID NOT = DFHENTER
  7688         MOVE ER-0029            TO EMI-ERROR
  7689         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7690         MOVE -1                 TO MAINTL
  7691         GO TO 8110-SEND-DATA.
  7692
  7693     IF PI-RETURN-CD-1 =  'X'
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 137
* EL131.cbl
  7694         MOVE ER-0311            TO EMI-ERROR
  7695         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7696         MOVE -1                 TO MAINTL
  7697         GO TO 8110-SEND-DATA.
  7698
  7699     IF MAINTI = 'A'
  7700         GO TO 0500-ADD-ALPHA-ONLY.
  7701
  7702     IF MAINTI = 'N'
  7703         GO TO 0600-CHANGE-NAME.
  7704
  7705     PERFORM 1000-EDIT-SCREEN THRU 1010-EXIT.
  7706     PERFORM 1030-EDIT-NAME THRU 1030-EXIT.
  7707
  7708     IF SCREEN-ERROR
  7709         GO TO 8110-SEND-DATA.
  7710
  7711     IF NOT UPDATES-PRESENT AND NOT DELETE-CLAIM
  7712         MOVE ER-0276            TO EMI-ERROR
  7713         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7714         MOVE -1                 TO MAINTL
  7715         GO TO 8110-SEND-DATA.
  7716
  7717     PERFORM 2000-UPDATE-CLAIM THRU 2000-EXIT.
  7718
  7719     IF SCREEN-ERROR
  7720         GO TO 8110-SEND-DATA.
  7721
  7722     MOVE 'W'                    TO EMI-ACTION-SWITCH.
  7723
  7724     PERFORM 5000-BUILD-MAP THRU 5000-EXIT.
  7725
  7726     IF EMI-FORCABLE-CTR GREATER THAN ZERO
  7727         GO TO 8110-SEND-DATA.
  7728
  7729     IF EMI-FATAL-CTR GREATER THAN ZERO
  7730         GO TO 8110-SEND-DATA.
  7731
  7732     MOVE SPACE                  TO EMI-ACTION-SWITCH.
  7733
  7734     IF WS-OPEN-CLOSE-SW = 'Y'
  7735         IF PI-LETTER-SW = 'Y'
  7736             MOVE PI-COMPANY-ID  TO  CNTL-CO-ID
  7737             MOVE 'T'            TO  CNTL-REC-TYPE
  7738             MOVE SPACES         TO  CNTL-PROC-ID
  7739             MOVE +0             TO  CNTL-SEQ-NO
  7740
  7741* EXEC CICS READ
  7742*                DATASET   (CNTL-FILE-ID)
  7743*                RIDFLD    (CNTL-KEY)
  7744*                SET       (ADDRESS OF CONTROL-FILE)
  7745*            END-EXEC
  7746*    MOVE '&"S        E          (   #00007699' TO DFHEIV0
  7747     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7748     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7749     MOVE X'2020233030303037363939' TO DFHEIV0(25:11)
  7750     CALL 'kxdfhei1' USING DFHEIV0,
  7751           CNTL-FILE-ID,
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 138
* EL131.cbl
  7752           DFHEIV20,
  7753           DFHEIV99,
  7754           CNTL-KEY,
  7755           DFHEIV99,
  7756           DFHEIV99,
  7757           DFHEIV99
  7758     SET ADDRESS OF CONTROL-FILE TO
  7759         DFHEIV20
  7760     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7761             PERFORM 7850-AUTO-LETTER-WRITER THRU 7850-EXIT.
  7762
  7763     MOVE ER-0000                TO EMI-ERROR.
  7764     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7765
  7766     MOVE SPACE                  TO MAINTO.
  7767     MOVE -1                     TO MAINTL.
  7768     GO TO 8100-SEND-MAP.
  7769
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 139
* EL131.cbl
  7771 0100-UPDATE-PI.
  7772
  7773     MOVE LOW-VALUES             TO WS-SAVE-BENEFICIARY.
  7774     IF WS-RETURNED-FROM = XCTL-EL114
  7775***sometimes there is crap in positions 7-10 when no code was sele
  7776        IF PI-PROGRAM-WORK-AREA (1:5) > SPACES
  7777          MOVE PI-PROGRAM-WORK-AREA (1:10) TO WS-SAVE-BENEFICIARY
  7778        END-IF
  7779     END-IF.
  7780
  7781     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  7782         GO TO 0110-UPDATE-UP.
  7783
  7784     MOVE PI-SAVED-PROGRAM-5     TO PI-SAVED-PROGRAM-6.
  7785     MOVE PI-SAVED-PROGRAM-4     TO PI-SAVED-PROGRAM-5.
  7786     MOVE PI-SAVED-PROGRAM-3     TO PI-SAVED-PROGRAM-4.
  7787     MOVE PI-SAVED-PROGRAM-2     TO PI-SAVED-PROGRAM-3.
  7788     MOVE PI-SAVED-PROGRAM-1     TO PI-SAVED-PROGRAM-2.
  7789     MOVE PI-RETURN-TO-PROGRAM   TO PI-SAVED-PROGRAM-1.
  7790     MOVE PI-CALLING-PROGRAM     TO PI-RETURN-TO-PROGRAM.
  7791     MOVE THIS-PGM               TO PI-CALLING-PROGRAM.
  7792     GO TO 0120-UPDATE-PI-EXIT.
  7793
  7794 0110-UPDATE-UP.
  7795     MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM.
  7796     MOVE PI-SAVED-PROGRAM-1 TO PI-RETURN-TO-PROGRAM.
  7797     MOVE PI-SAVED-PROGRAM-2 TO PI-SAVED-PROGRAM-1.
  7798     MOVE PI-SAVED-PROGRAM-3 TO PI-SAVED-PROGRAM-2.
  7799     MOVE PI-SAVED-PROGRAM-4 TO PI-SAVED-PROGRAM-3.
  7800     MOVE PI-SAVED-PROGRAM-5 TO PI-SAVED-PROGRAM-4.
  7801     MOVE PI-SAVED-PROGRAM-6 TO PI-SAVED-PROGRAM-5.
  7802     MOVE SPACES             TO PI-SAVED-PROGRAM-6.
  7803
  7804
  7805* EXEC CICS HANDLE CONDITION
  7806*         QIDERR    (0130-TS-ERROR)
  7807*         ITEMERR   (0130-TS-ERROR)
  7808*    END-EXEC.
  7809*    MOVE '"$N<                  ! # #00007747' TO DFHEIV0
  7810     MOVE X'22244E3C2020202020202020' TO DFHEIV0(1:12)
  7811     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7812     MOVE X'2320233030303037373437' TO DFHEIV0(25:11)
  7813     CALL 'kxdfhei1' USING DFHEIV0
  7814     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7815
  7816
  7817     IF WS-RETURNED-FROM = XCTL-EL114
  7818
  7819* EXEC CICS READQ TS
  7820*            QUEUE    (PI-KEY)
  7821*            INTO     (EL131AI)
  7822*            LENGTH   (MAP-LENGTH)
  7823*       END-EXEC
  7824*    MOVE '*$I    L              ''   #00007753' TO DFHEIV0
  7825     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7826     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7827     MOVE X'2020233030303037373533' TO DFHEIV0(25:11)
  7828     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 140
* EL131.cbl
  7829           PI-KEY,
  7830           EL131AI,
  7831           MAP-LENGTH,
  7832           DFHEIV99,
  7833           DFHEIV99,
  7834           DFHEIV99
  7835     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7836
  7837        IF WS-SAVE-BENEFICIARY > SPACES
  7838            MOVE WS-SAVE-BENEFICIARY TO BENEI
  7839            MOVE +10            TO BENEL
  7840            MOVE LOW-VALUES TO WS-SAVE-BENEFICIARY
  7841        END-IF
  7842        PERFORM 4100-SAVE-CHANGES THRU 4100-EXIT
  7843     END-IF.
  7844
  7845
  7846* EXEC CICS READQ TS
  7847*         QUEUE    (PI-KEY)
  7848*         INTO     (PROGRAM-INTERFACE-BLOCK)
  7849*         LENGTH   (PI-COMM-LENGTH)
  7850*    END-EXEC.
  7851*    MOVE '*$I    L              ''   #00007767' TO DFHEIV0
  7852     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7853     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7854     MOVE X'2020233030303037373637' TO DFHEIV0(25:11)
  7855     CALL 'kxdfhei1' USING DFHEIV0,
  7856           PI-KEY,
  7857           PROGRAM-INTERFACE-BLOCK,
  7858           PI-COMM-LENGTH,
  7859           DFHEIV99,
  7860           DFHEIV99,
  7861           DFHEIV99
  7862     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7863
  7864
  7865
  7866* EXEC CICS DELETEQ TS
  7867*         QUEUE    (PI-KEY)
  7868*    END-EXEC.
  7869*    MOVE '*&                    #   #00007773' TO DFHEIV0
  7870     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  7871     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7872     MOVE X'2020233030303037373733' TO DFHEIV0(25:11)
  7873     CALL 'kxdfhei1' USING DFHEIV0,
  7874           PI-KEY,
  7875           DFHEIV99
  7876     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7877
  7878
  7879 0120-UPDATE-PI-EXIT.
  7880     EXIT.
  7881
  7882 0130-TS-ERROR.
  7883     MOVE LOW-VALUES             TO EL131AO.
  7884     MOVE ER-0192                TO EMI-ERROR.
  7885
  7886     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 141
* EL131.cbl
  7887
  7888     GO TO 8100-SEND-MAP.
  7889
  7890 0200-TRANS-PF.
  7891     IF EIBAID NOT = DFHENTER
  7892         MOVE 'X'                TO ERROR-SWITCH
  7893         GO TO 0210-EXIT.
  7894
  7895     IF PFKEYI NOT NUMERIC
  7896         MOVE 'X'                TO ERROR-SWITCH
  7897         GO TO 0210-EXIT.
  7898
  7899     MOVE PFKEYI                 TO CHECK-PFKEYS.
  7900
  7901     IF CHECK-PFKEYS LESS 1 OR GREATER 24
  7902         MOVE 'X' TO ERROR-SWITCH
  7903         GO TO 0210-EXIT.
  7904
  7905     MOVE AID-KEYS (CHECK-PFKEYS) TO EIBAID.
  7906
  7907 0210-EXIT.
  7908     EXIT.
  7909
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 142
* EL131.cbl
  7911 0500-ADD-ALPHA-ONLY.
  7912******************************************************************
  7913*    ADD NAME TO ALPHA FILE.  NO CHANGES ARE MADE TO THE CLAIM   *
  7914*    RECORD.                                                     *
  7915******************************************************************
  7916
  7917     IF MLNAMEL = +0 AND
  7918        MFNAMEL = +0 AND
  7919        MMINITL = +0
  7920         MOVE ER-0797                TO  EMI-ERROR
  7921         MOVE -1                     TO  MAINTL
  7922         MOVE AL-UABON               TO  MAINTA
  7923         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7924         GO TO 8110-SEND-DATA.
  7925
  7926     MOVE PI-COMPANY-CD              TO  COMPANY-CODE.
  7927     MOVE PI-CARRIER                 TO  CARRIER-CODE.
  7928     MOVE PI-CLAIM-NO                TO  CLAIM-NO.
  7929     MOVE PI-CERT-NO                 TO  CERT-NO.
  7930
  7931
  7932* EXEC CICS READ
  7933*        DATASET   (CLMS-FILE-ID)
  7934*        RIDFLD    (MSTR-KEY)
  7935*        SET       (ADDRESS OF CLAIM-MASTER)
  7936*    END-EXEC.
  7937*    MOVE '&"S        E          (   #00007829' TO DFHEIV0
  7938     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7939     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7940     MOVE X'2020233030303037383239' TO DFHEIV0(25:11)
  7941     CALL 'kxdfhei1' USING DFHEIV0,
  7942           CLMS-FILE-ID,
  7943           DFHEIV20,
  7944           DFHEIV99,
  7945           MSTR-KEY,
  7946           DFHEIV99,
  7947           DFHEIV99,
  7948           DFHEIV99
  7949     SET ADDRESS OF CLAIM-MASTER TO
  7950         DFHEIV20
  7951     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7952
  7953
  7954
  7955* EXEC CICS GETMAIN
  7956*        SET       (ADDRESS OF ALPHA-INDEX)
  7957*        LENGTH    (ALPH-LENGTH)
  7958*        INITIMG   (GETMAIN-SPACE)
  7959*    END-EXEC.
  7960*    MOVE ',"IL                  $   #00007835' TO DFHEIV0
  7961     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7962     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7963     MOVE X'2020233030303037383335' TO DFHEIV0(25:11)
  7964     CALL 'kxdfhei1' USING DFHEIV0,
  7965           DFHEIV20,
  7966           ALPH-LENGTH,
  7967           GETMAIN-SPACE
  7968     SET ADDRESS OF ALPHA-INDEX TO
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 143
* EL131.cbl
  7969         DFHEIV20
  7970     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7971
  7972
  7973     MOVE 'AI'                       TO  AI-RECORD-ID.
  7974     MOVE CL-COMPANY-CD              TO  AI-COMPANY-CD
  7975                                         AI-CL-COMPANY-CD.
  7976     MOVE 'C'                        TO  AI-SOURCE
  7977                                         AI-CL-SOURCE.
  7978
  7979     IF MLNAMEL IS GREATER THAN +0
  7980         MOVE MLNAMEI                TO  AI-LAST-NAME
  7981     ELSE
  7982         MOVE CL-INSURED-LAST-NAME   TO  AI-LAST-NAME.
  7983
  7984     IF MFNAMEL IS GREATER THAN +0
  7985         MOVE MFNAMEI                TO  AI-FIRST-NAME
  7986     ELSE
  7987         MOVE CL-INSURED-1ST-NAME    TO  AI-FIRST-NAME.
  7988
  7989     IF MMINITL IS GREATER THAN +0
  7990         MOVE MMINITI                TO  AI-MIDDLE-INIT
  7991     ELSE
  7992         MOVE CL-INSURED-MID-INIT    TO  AI-MIDDLE-INIT.
  7993
  7994     MOVE EIBDATE                    TO  DC-JULIAN-YYDDD.
  7995     MOVE '5'                        TO  DC-OPTION-CODE.
  7996     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  7997     MOVE DC-GREG-DATE-1-MDY         TO  BUILD-VALID-DATE.
  7998     IF BUILD-YEAR IS GREATER THAN 50
  7999         MOVE '19'                   TO  WS-ALPHA-YY-1
  8000         MOVE BUILD-YEAR             TO  WS-ALPHA-YY-2
  8001         MOVE BUILD-MONTH            TO  WS-ALPHA-MM
  8002         MOVE BUILD-DAY              TO  WS-ALPHA-DD
  8003     ELSE
  8004         MOVE '20'                   TO  WS-ALPHA-YY-1
  8005         MOVE BUILD-YEAR             TO  WS-ALPHA-YY-2
  8006         MOVE BUILD-MONTH            TO  WS-ALPHA-MM
  8007         MOVE BUILD-DAY              TO  WS-ALPHA-DD.
  8008
  8009     MOVE WS-ALPHA-DATE              TO  AI-DATE
  8010                                         AI-CL-DATE.
  8011
  8012     MOVE EIBTIME                    TO  AI-TIME
  8013                                         AI-CL-TIME.
  8014
  8015     MOVE CL-COMPANY-CD              TO  AI-CL-COMPANY-CD.
  8016     MOVE 'C'                        TO  AI-CL-SOURCE.
  8017     MOVE CL-CARRIER                 TO  AI-CL-CARRIER.
  8018     MOVE CL-CLAIM-NO                TO  AI-CL-CLAIM-NUMBER.
  8019     MOVE CL-CERT-NO                 TO  AI-CL-CERTIFICATE-NUMBER.
  8020     MOVE CL-INCURRED-DT             TO  AI-CL-INCURRED-DATE.
  8021     MOVE LOW-VALUES                 TO  AI-CL-CLOSE-DATE.
  8022
  8023     MOVE PI-PROCESSOR-ID            TO  AI-LAST-MAINT-BY.
  8024     MOVE SAVE-BIN-DATE              TO  AI-LAST-MAINT-DT.
  8025     MOVE EIBTIME                    TO  AI-LAST-MAINT-HHMMSS.
  8026
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 144
* EL131.cbl
  8027
  8028* EXEC CICS WRITE
  8029*        DATASET   (ALPH-FILE-ID)
  8030*        RIDFLD    (AI-CONTROL-PRIMARY)
  8031*        FROM      (ALPHA-INDEX)
  8032*    END-EXEC.
  8033     MOVE LENGTH OF
  8034      ALPHA-INDEX
  8035       TO DFHEIV11
  8036*    MOVE '&$ L                  ''   #00007895' TO DFHEIV0
  8037     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  8038     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8039     MOVE X'2020233030303037383935' TO DFHEIV0(25:11)
  8040     CALL 'kxdfhei1' USING DFHEIV0,
  8041           ALPH-FILE-ID,
  8042           ALPHA-INDEX,
  8043           DFHEIV11,
  8044           AI-CONTROL-PRIMARY,
  8045           DFHEIV99,
  8046           DFHEIV99
  8047     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8048
  8049
  8050     MOVE LOW-VALUES                 TO  EL131AO.
  8051     PERFORM 5000-BUILD-MAP THRU 5000-EXIT.
  8052     MOVE ER-0000                    TO  EMI-ERROR.
  8053     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8054     MOVE -1                         TO  MAINTL.
  8055     GO TO 8100-SEND-MAP.
  8056
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 145
* EL131.cbl
  8058 0600-CHANGE-NAME.
  8059******************************************************************
  8060*    MOVE NAME IN THE CLAIM RECORD TO THE ALPHA FILE AND REPLACE *
  8061*    IT WITH THE NAME THAT IS KEYED ON THE SCREEN.               *
  8062******************************************************************
  8063
  8064     IF MLNAMEL = +0 AND
  8065        MFNAMEL = +0 AND
  8066        MMINITL = +0
  8067         MOVE ER-0276                TO  EMI-ERROR
  8068         MOVE -1                     TO  MAINTL
  8069         MOVE AL-UABON               TO  MAINTA
  8070         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8071         GO TO 8110-SEND-DATA.
  8072
  8073     MOVE PI-COMPANY-CD              TO  COMPANY-CODE.
  8074     MOVE PI-CARRIER                 TO  CARRIER-CODE.
  8075     MOVE PI-CLAIM-NO                TO  CLAIM-NO.
  8076     MOVE PI-CERT-NO                 TO  CERT-NO.
  8077
  8078
  8079* EXEC CICS READ
  8080*        DATASET   (CLMS-FILE-ID)
  8081*        RIDFLD    (MSTR-KEY)
  8082*        SET       (ADDRESS OF CLAIM-MASTER)
  8083*    END-EXEC.
  8084*    MOVE '&"S        E          (   #00007929' TO DFHEIV0
  8085     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8086     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8087     MOVE X'2020233030303037393239' TO DFHEIV0(25:11)
  8088     CALL 'kxdfhei1' USING DFHEIV0,
  8089           CLMS-FILE-ID,
  8090           DFHEIV20,
  8091           DFHEIV99,
  8092           MSTR-KEY,
  8093           DFHEIV99,
  8094           DFHEIV99,
  8095           DFHEIV99
  8096     SET ADDRESS OF CLAIM-MASTER TO
  8097         DFHEIV20
  8098     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8099
  8100
  8101
  8102* EXEC CICS GETMAIN
  8103*        SET       (ADDRESS OF ALPHA-INDEX)
  8104*        LENGTH    (ALPH-LENGTH)
  8105*        INITIMG   (GETMAIN-SPACE)
  8106*    END-EXEC.
  8107*    MOVE ',"IL                  $   #00007935' TO DFHEIV0
  8108     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  8109     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8110     MOVE X'2020233030303037393335' TO DFHEIV0(25:11)
  8111     CALL 'kxdfhei1' USING DFHEIV0,
  8112           DFHEIV20,
  8113           ALPH-LENGTH,
  8114           GETMAIN-SPACE
  8115     SET ADDRESS OF ALPHA-INDEX TO
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 146
* EL131.cbl
  8116         DFHEIV20
  8117     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8118
  8119
  8120     MOVE CL-COMPANY-CD          TO CERT-COMPANY-CODE
  8121     MOVE CL-CERT-CARRIER        TO CERT-CARRIER
  8122     MOVE CL-CERT-GROUPING       TO CERT-GROUP
  8123     MOVE CL-CERT-STATE          TO CERT-STATE
  8124     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT
  8125     MOVE CL-CERT-EFF-DT         TO CERT-DATE
  8126     MOVE CL-CERT-NO             TO CERT-CERT
  8127
  8128
  8129* EXEC CICS READ
  8130*       DATASET   (CERT-FILE-ID)
  8131*       RIDFLD    (CERT-KEY)
  8132*       SET       (ADDRESS OF CERTIFICATE-MASTER)
  8133*       RESP      (WS-RESPONSE)
  8134*    END-EXEC
  8135*    MOVE '&"S        E          (  N#00007949' TO DFHEIV0
  8136     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8137     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8138     MOVE X'204E233030303037393439' TO DFHEIV0(25:11)
  8139     CALL 'kxdfhei1' USING DFHEIV0,
  8140           CERT-FILE-ID,
  8141           DFHEIV20,
  8142           DFHEIV99,
  8143           CERT-KEY,
  8144           DFHEIV99,
  8145           DFHEIV99,
  8146           DFHEIV99
  8147     SET ADDRESS OF CERTIFICATE-MASTER TO
  8148         DFHEIV20
  8149     MOVE EIBRESP  TO WS-RESPONSE
  8150     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8151
  8152     IF INSTYPEL > ZEROS
  8153        MOVE INSTYPEI TO CL-INSURED-TYPE
  8154     END-IF
  8155
  8156     IF MFNAMEL > +0
  8157        IF CL-INSURED-TYPE = 'C'
  8158          AND (CM-INSURED-FIRST-NAME = MFNAMEI(1:10))
  8159           MOVE ER-1675             TO EMI-ERROR
  8160           MOVE -1                  TO MFNAMEL
  8161           MOVE AL-UABON            TO MFNAMEA
  8162           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8163           GO TO 8110-SEND-DATA
  8164        ELSE
  8165          IF CL-INSURED-TYPE = 'P'
  8166            AND (CM-INSURED-FIRST-NAME <> MFNAMEI(1:10))
  8167             MOVE ER-1676             TO EMI-ERROR
  8168             MOVE -1                  TO MFNAMEL
  8169             MOVE AL-UABON            TO MFNAMEA
  8170             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8171             GO TO 8110-SEND-DATA
  8172          END-IF
  8173        END-IF
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 147
* EL131.cbl
  8174     END-IF
  8175     MOVE 'AI'                       TO  AI-RECORD-ID.
  8176     MOVE CL-COMPANY-CD              TO  AI-COMPANY-CD
  8177                                         AI-CL-COMPANY-CD.
  8178     MOVE 'C'                        TO  AI-SOURCE
  8179                                         AI-CL-SOURCE.
  8180
  8181     MOVE CL-INSURED-LAST-NAME       TO  AI-LAST-NAME.
  8182     MOVE CL-INSURED-1ST-NAME        TO  AI-FIRST-NAME.
  8183     MOVE CL-INSURED-MID-INIT        TO  AI-MIDDLE-INIT.
  8184
  8185     MOVE EIBDATE                    TO  DC-JULIAN-YYDDD.
  8186     MOVE '5'                        TO  DC-OPTION-CODE.
  8187     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  8188     MOVE DC-GREG-DATE-1-MDY         TO  BUILD-VALID-DATE.
  8189     IF BUILD-YEAR IS GREATER THAN 50
  8190         MOVE '19'                   TO  WS-ALPHA-YY-1
  8191         MOVE BUILD-YEAR             TO  WS-ALPHA-YY-2
  8192         MOVE BUILD-MONTH            TO  WS-ALPHA-MM
  8193         MOVE BUILD-DAY              TO  WS-ALPHA-DD
  8194     ELSE
  8195         MOVE '20'                   TO  WS-ALPHA-YY-1
  8196         MOVE BUILD-YEAR             TO  WS-ALPHA-YY-2
  8197         MOVE BUILD-MONTH            TO  WS-ALPHA-MM
  8198         MOVE BUILD-DAY              TO  WS-ALPHA-DD.
  8199
  8200     MOVE WS-ALPHA-DATE              TO  AI-DATE
  8201                                         AI-CL-DATE.
  8202
  8203     MOVE EIBTIME                    TO  AI-TIME
  8204                                         AI-CL-TIME.
  8205
  8206     MOVE CL-COMPANY-CD              TO  AI-CL-COMPANY-CD.
  8207     MOVE 'C'                        TO  AI-CL-SOURCE.
  8208     MOVE CL-CARRIER                 TO  AI-CL-CARRIER.
  8209     MOVE CL-CLAIM-NO                TO  AI-CL-CLAIM-NUMBER.
  8210     MOVE CL-CERT-NO                 TO  AI-CL-CERTIFICATE-NUMBER.
  8211     MOVE CL-INCURRED-DT             TO  AI-CL-INCURRED-DATE.
  8212     MOVE LOW-VALUES                 TO  AI-CL-CLOSE-DATE.
  8213
  8214     MOVE PI-PROCESSOR-ID            TO  AI-LAST-MAINT-BY.
  8215     MOVE SAVE-BIN-DATE              TO  AI-LAST-MAINT-DT.
  8216     MOVE EIBTIME                    TO  AI-LAST-MAINT-HHMMSS.
  8217
  8218     IF PI-COMPANY-ID = 'CID' or 'AHL'
  8219         MOVE 'Y'                TO CL-YESNOSW
  8220     END-IF.
  8221
  8222
  8223* EXEC CICS WRITE
  8224*        DATASET   (ALPH-FILE-ID)
  8225*        RIDFLD    (AI-CONTROL-PRIMARY)
  8226*        FROM      (ALPHA-INDEX)
  8227*    END-EXEC.
  8228     MOVE LENGTH OF
  8229      ALPHA-INDEX
  8230       TO DFHEIV11
  8231*    MOVE '&$ L                  ''   #00008026' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 148
* EL131.cbl
  8232     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  8233     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8234     MOVE X'2020233030303038303236' TO DFHEIV0(25:11)
  8235     CALL 'kxdfhei1' USING DFHEIV0,
  8236           ALPH-FILE-ID,
  8237           ALPHA-INDEX,
  8238           DFHEIV11,
  8239           AI-CONTROL-PRIMARY,
  8240           DFHEIV99,
  8241           DFHEIV99
  8242     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8243
  8244
  8245
  8246* EXEC CICS READ
  8247*        DATASET   (CLMS-FILE-ID)
  8248*        RIDFLD    (MSTR-KEY)
  8249*        SET       (ADDRESS OF CLAIM-MASTER)
  8250*        UPDATE
  8251*    END-EXEC.
  8252*    MOVE '&"S        EU         (   #00008032' TO DFHEIV0
  8253     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8254     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8255     MOVE X'2020233030303038303332' TO DFHEIV0(25:11)
  8256     CALL 'kxdfhei1' USING DFHEIV0,
  8257           CLMS-FILE-ID,
  8258           DFHEIV20,
  8259           DFHEIV99,
  8260           MSTR-KEY,
  8261           DFHEIV99,
  8262           DFHEIV99,
  8263           DFHEIV99
  8264     SET ADDRESS OF CLAIM-MASTER TO
  8265         DFHEIV20
  8266     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8267
  8268
  8269     if (cl-priority-cd = '8')
  8270        and (pi-processor-id not = 'PEMA'and 'JMS '
  8271             AND 'AMWA' AND 'KMSB')
  8272        MOVE ER-8003             TO EMI-ERROR
  8273        PERFORM 9900-ERROR-FORMAT
  8274                                 THRU 9900-EXIT
  8275        MOVE -1                  TO MAINTL
  8276        GO TO 8110-SEND-DATA
  8277     end-if
  8278
  8279     IF MLNAMEL IS GREATER THAN +0
  8280         MOVE MLNAMEI                TO  CL-INSURED-LAST-NAME.
  8281
  8282     IF MFNAMEL IS GREATER THAN +0
  8283         MOVE MFNAMEI                TO  CL-INSURED-1ST-NAME.
  8284
  8285     IF MMINITL IS GREATER THAN +0
  8286         MOVE MMINITI                TO  CL-INSURED-MID-INIT.
  8287
  8288     MOVE PI-PROCESSOR-ID            TO  CL-LAST-MAINT-USER.
  8289     MOVE SAVE-BIN-DATE              TO  CL-LAST-MAINT-DT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 149
* EL131.cbl
  8290     MOVE EIBTIME                    TO  CL-LAST-MAINT-HHMMSS.
  8291     MOVE '3'                        TO  CL-LAST-MAINT-TYPE.
  8292
  8293     IF PI-COMPANY-ID = 'CID' or 'AHL'
  8294         MOVE 'Y'                TO CL-YESNOSW
  8295     END-IF.
  8296
  8297
  8298* EXEC CICS HANDLE CONDITION
  8299*        DUPKEY   (0600-CONTINUE-NAME-UPDATE)
  8300*    END-EXEC.
  8301*    MOVE '"$$                   ! $ #00008067' TO DFHEIV0
  8302     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  8303     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8304     MOVE X'2420233030303038303637' TO DFHEIV0(25:11)
  8305     CALL 'kxdfhei1' USING DFHEIV0
  8306     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8307
  8308
  8309
  8310* EXEC CICS REWRITE
  8311*        DATASET   (CLMS-FILE-ID)
  8312*        FROM      (CLAIM-MASTER)
  8313*    END-EXEC.
  8314     MOVE LENGTH OF
  8315      CLAIM-MASTER
  8316       TO DFHEIV11
  8317*    MOVE '&& L                  %   #00008071' TO DFHEIV0
  8318     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8319     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8320     MOVE X'2020233030303038303731' TO DFHEIV0(25:11)
  8321     CALL 'kxdfhei1' USING DFHEIV0,
  8322           CLMS-FILE-ID,
  8323           CLAIM-MASTER,
  8324           DFHEIV11,
  8325           DFHEIV99
  8326     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8327
  8328
  8329 0600-CONTINUE-NAME-UPDATE.
  8330
  8331     MOVE LOW-VALUES                 TO  EL131AO.
  8332     PERFORM 5000-BUILD-MAP THRU 5000-EXIT.
  8333     MOVE ER-0000                    TO  EMI-ERROR.
  8334     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8335     MOVE -1                         TO  MAINTL.
  8336     GO TO 8100-SEND-MAP.
  8337
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 150
* EL131.cbl
  8339 1000-EDIT-SCREEN.
  8340
  8341     MOVE MAINTI                 TO CHECK-MAINT.
  8342
  8343     IF NOT VALID-OPTIONS
  8344         MOVE 'X'                TO ERROR-SWITCH
  8345         MOVE -1                 TO MAINTL
  8346         MOVE AL-UABON           TO MAINTA
  8347         MOVE ER-0023            TO EMI-ERROR
  8348         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8349         GO TO 1010-EXIT.
  8350
  8351     IF NOT MODIFY-CAP
  8352         MOVE 'UPDATE'           TO  SM-READ
  8353         PERFORM 9995-SECURITY-VIOLATION
  8354         MOVE ER-0070               TO  EMI-ERROR
  8355         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8356         GO TO 8100-SEND-MAP.
  8357
  8358     IF DELETE-CLAIM
  8359         MOVE AL-UANON TO MAINTA
  8360         GO TO 1010-EXIT.
  8361
  8362     MOVE AL-UANON               TO MAINTA.
  8363
  8364     IF CCNOI GREATER THAN LOW-VALUES
  8365         MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH.
  8366
  8367     IF PI-COMPANY-ID = 'CSL'
  8368        CONTINUE
  8369     ELSE
  8370        IF TYPEL > ZERO
  8371           IF ((PI-COMPANY-ID = 'CID' or 'AHL')
  8372              AND (TYPEI = PI-AH-OVERRIDE-L1 OR
  8373                    PI-LIFE-OVERRIDE-L1 OR 'O'))
  8374                       OR
  8375              ((PI-COMPANY-ID = 'DCC' OR 'VPP')
  8376              AND (TYPEI = PI-AH-OVERRIDE-L1 OR
  8377                PI-LIFE-OVERRIDE-L1 OR 'I' OR 'G' OR 'F' OR 'O'))
  8378              MOVE AL-UANON      TO TYPEA
  8379              MOVE 'X'           TO UPDATE-SWITCH MSTR-SWITCH
  8380           ELSE
  8381              MOVE ER-0199       TO EMI-ERROR
  8382              PERFORM 9900-ERROR-FORMAT
  8383                                 THRU 9900-EXIT
  8384              MOVE AL-UABON      TO TYPEA
  8385              MOVE -1            TO TYPEL
  8386              MOVE 'X'           TO ERROR-SWITCH
  8387           END-IF
  8388        ELSE
  8389           MOVE AL-UANOF         TO TYPEA
  8390        END-IF
  8391     END-IF
  8392     IF STATUSI GREATER THAN LOW-VALUES
  8393         IF STATUSI = 'OPEN' OR 'CLOSED' OR 'O' OR 'C'
  8394             MOVE 'Y'            TO WS-OPEN-CLOSE-SW
  8395             MOVE AL-UANON       TO STATUSA
  8396             MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH TRLR-SWITCH
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 151
* EL131.cbl
  8397             MOVE 'Y'            TO DLYACTV-SW
  8398         ELSE
  8399             MOVE ER-0333        TO EMI-ERROR
  8400             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8401             MOVE AL-UABON       TO STATUSA
  8402             MOVE -1             TO STATUSL
  8403             MOVE 'X'            TO ERROR-SWITCH
  8404         END-IF
  8405     ELSE
  8406         MOVE SPACE              TO TRLR-SWITCH
  8407         MOVE 'N'                TO DLYACTV-SW
  8408         MOVE AL-UANOF           TO STATUSA.
  8409
  8410     IF PROCI GREATER THAN LOW-VALUES
  8411         PERFORM 1120-EDIT-PROC THRU 1120-EXIT
  8412     ELSE
  8413         MOVE AL-UANOF TO PROCA.
  8414
  8415     IF SEXI GREATER THAN LOW-VALUES
  8416         IF SEXI = 'F' OR 'M'
  8417             MOVE AL-UANON       TO SEXA
  8418             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8419           ELSE
  8420             MOVE ER-0219        TO EMI-ERROR
  8421             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8422             MOVE AL-UABON       TO SEXA
  8423             MOVE -1             TO SEXL
  8424             MOVE 'X'            TO ERROR-SWITCH
  8425       ELSE
  8426         MOVE AL-UANOF           TO SEXA.
  8427
  8428     IF BIRTHL = +0
  8429         MOVE LOW-VALUES         TO  HOLD-BIRTH
  8430         MOVE AL-UANOF           TO  BIRTHA
  8431         GO TO 1000-CONTINUE-EDITS.
  8432
  8433     IF BIRTHI = SPACES
  8434         MOVE LOW-VALUES         TO  HOLD-BIRTH
  8435         MOVE 'X'                TO  UPDATE-SWITCH
  8436                                     MSTR-SWITCH
  8437         GO TO 1000-CONTINUE-EDITS.
  8438
  8439     MOVE BIRTHI                 TO  DEEDIT-DATE-INPUT.
  8440     PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT.
  8441     MOVE DEEDIT-DATE            TO  DC-GREG-DATE-1-MDY.
  8442     MOVE '4'                    TO  DC-OPTION-CODE.
  8443     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  8444     IF DATE-CONVERSION-ERROR
  8445         MOVE ER-0220            TO  EMI-ERROR
  8446         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8447         MOVE AL-UABON           TO  BIRTHA
  8448         MOVE -1                 TO  BIRTHL
  8449         MOVE 'X'                TO  ERROR-SWITCH
  8450         GO TO 1000-CONTINUE-EDITS.
  8451
  8452******************************************************************
  8453**   IF CALCULATED BIRTH DATE IS GREATER THAN TODAYS DATE       **
  8454**   USE THE CENTURY ADJUSTMENT SWITCH IN THE DATE ROUTINE      **
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 152
* EL131.cbl
  8455**   TO SUBTRACT 100 YEARS TO OBTAIN THE CORRECT BIRTH DATE.    **
  8456******************************************************************
  8457     IF DC-BIN-DATE-1 IS GREATER THAN SAVE-BIN-DATE
  8458         MOVE BIRTHI             TO  DEEDIT-DATE-INPUT
  8459         PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT
  8460         MOVE DEEDIT-DATE        TO  DC-GREG-DATE-1-MDY
  8461         MOVE '4'                TO  DC-OPTION-CODE
  8462         MOVE '1'                TO  DC-CENTURY-ADJUSTMENT
  8463         MOVE +0                 TO  DC-ELAPSED-MONTHS
  8464                                     DC-ELAPSED-DAYS
  8465         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8466         IF DATE-CONVERSION-ERROR
  8467             MOVE ER-0220        TO  EMI-ERROR
  8468             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8469             MOVE AL-UABON       TO  BIRTHA
  8470             MOVE -1             TO  BIRTHL
  8471             MOVE 'X'            TO  ERROR-SWITCH
  8472             GO TO 1000-CONTINUE-EDITS.
  8473
  8474     MOVE AL-UANON               TO  BIRTHA.
  8475     MOVE 'X'                    TO  UPDATE-SWITCH
  8476                                     MSTR-SWITCH.
  8477     MOVE DC-GREG-DATE-1-EDIT    TO  BIRTHO.
  8478     MOVE DC-BIN-DATE-1          TO  HOLD-BIRTH.
  8479     MOVE ' '                    TO  DC-CENTURY-ADJUSTMENT.
  8480
  8481 1000-CONTINUE-EDITS.
  8482
  8483     IF SOCIALI GREATER THAN LOW-VALUES
  8484         MOVE SOCIALI TO WS-SOC-SEC-NUMBER
  8485         IF WS-SOC-SEC-NO NUMERIC AND
  8486           (WS-SOC-SEC-BLANK = SPACES OR LOW-VALUES)
  8487             NEXT SENTENCE
  8488         ELSE
  8489            IF WS-SSN-1-3 NUMERIC AND WS-SSN-4-5 NUMERIC AND
  8490               WS-SSN-6-9 NUMERIC AND WS-SSN-DASH1 = '-' AND
  8491               WS-SSN-DASH2 = '-'
  8492                 NEXT SENTENCE
  8493            ELSE
  8494                 MOVE ER-0887        TO  EMI-ERROR
  8495                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8496                 MOVE AL-UABON       TO  SOCIALA
  8497                 MOVE -1             TO  SOCIALL
  8498                 MOVE 'X'            TO  ERROR-SWITCH
  8499            END-IF
  8500        END-IF
  8501     END-IF.
  8502     if critpl > zeros
  8503        and critpi numeric
  8504        move al-uanon            to critpa
  8505        move 'X'                 to update-switch
  8506     end-if
  8507     IF SOCIALI GREATER THAN LOW-VALUES
  8508         MOVE AL-UANON           TO SOCIALA
  8509         MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH MSTR-KEY-SWITCH
  8510     ELSE
  8511         MOVE AL-UANOF           TO SOCIALA.
  8512
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 153
* EL131.cbl
  8513     IF OCCI GREATER THAN LOW-VALUES
  8514         MOVE AL-UANON           TO OCCA
  8515         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8516     ELSE
  8517         MOVE AL-UANOF           TO OCCA.
  8518
  8519     IF BENEL NOT GREATER THAN ZERO
  8520            GO TO 1005-CONTINUE-EDITS.
  8521
  8522     IF BENEI = SPACES
  8523        IF PI-AUTO-PAY-SEQ NOT = ZEROS
  8524           MOVE 'N'             TO AUTO-PAY-TO-BENE
  8525           PERFORM 2800-CHECK-AUTO-PAY THRU 2800-EXIT
  8526           IF AUTO-PAY-TO-BENE = 'Y'
  8527               MOVE ER-1773      TO  EMI-ERROR
  8528               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8529               MOVE 'X'          TO ERROR-SWITCH
  8530               MOVE AL-UABON     TO BENEA
  8531               MOVE -1           TO BENEL
  8532           ELSE
  8533               MOVE 'X'          TO UPDATE-SWITCH MSTR-SWITCH
  8534           END-IF
  8535        ELSE
  8536           PERFORM 1050-EDIT-BENE THRU 1050-EXIT
  8537           IF PAYMENT-PENDING
  8538               MOVE ER-1772      TO  EMI-ERROR
  8539               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8540               MOVE 'X'          TO ERROR-SWITCH
  8541               MOVE AL-UABON     TO BENEA
  8542               MOVE -1           TO BENEL
  8543           END-IF
  8544           MOVE 'X'              TO UPDATE-SWITCH MSTR-SWITCH
  8545        END-IF
  8546        GO TO 1005-CONTINUE-EDITS.
  8547
  8548
  8549* EXEC CICS HANDLE CONDITION
  8550*        NOTFND (1004-BENE-NOT-FOUND)
  8551*    END-EXEC.
  8552*    MOVE '"$I                   ! % #00008295' TO DFHEIV0
  8553     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8554     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8555     MOVE X'2520233030303038323935' TO DFHEIV0(25:11)
  8556     CALL 'kxdfhei1' USING DFHEIV0
  8557     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8558
  8559
  8560     MOVE PI-COMPANY-CD          TO  WS-ELBENE-COMPANY-CD.
  8561     MOVE 'B'                    TO  WS-ELBENE-RECORD-TYPE.
  8562     MOVE BENEI                  TO  WS-ELBENE-ID.
  8563
  8564
  8565* EXEC CICS READ
  8566*        DATASET ('ELBENE')
  8567*        RIDFLD  (WS-ELBENE-KEY)
  8568*        SET     (ADDRESS OF BENEFICIARY-MASTER)
  8569*    END-EXEC.
  8570     MOVE 'ELBENE' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 154
* EL131.cbl
  8571*    MOVE '&"S        E          (   #00008303' TO DFHEIV0
  8572     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8573     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8574     MOVE X'2020233030303038333033' TO DFHEIV0(25:11)
  8575     CALL 'kxdfhei1' USING DFHEIV0,
  8576           DFHEIV1,
  8577           DFHEIV20,
  8578           DFHEIV99,
  8579           WS-ELBENE-KEY,
  8580           DFHEIV99,
  8581           DFHEIV99,
  8582           DFHEIV99
  8583     SET ADDRESS OF BENEFICIARY-MASTER TO
  8584         DFHEIV20
  8585     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8586
  8587
  8588     MOVE AL-UANON               TO  BENEA.
  8589     MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH.
  8590
  8591     GO TO 1005-CONTINUE-EDITS.
  8592
  8593 1004-BENE-NOT-FOUND.
  8594     MOVE ER-0565                TO  EMI-ERROR.
  8595
  8596     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8597     MOVE 'X'                    TO ERROR-SWITCH.
  8598     MOVE AL-UABON               TO BENEA.
  8599     MOVE -1                     TO BENEL.
  8600
  8601 1005-CONTINUE-EDITS.
  8602
  8603     IF DIAGI GREATER THAN LOW-VALUES
  8604         MOVE AL-UANON           TO DIAGA
  8605         MOVE 'X'                TO UPDATE-SWITCH
  8606                                    NINETY-TRLR-SWITCH
  8607     ELSE
  8608         MOVE AL-UANOF           TO DIAGA.
  8609
  8610     IF ICD1I GREATER THAN LOW-VALUES
  8611         IF (ICD1I GREATER THAN SPACES) AND
  8612            (ICD1I(4:1) NOT = '.')
  8613             IF ICD1I(4:1) = ' '
  8614                 MOVE '.' TO ICD1I(4:1)
  8615             ELSE
  8616                 IF ICD1I(8:1) = ' '
  8617                     MOVE ICD1I(7:1) TO ICD1I(8:1)
  8618                     MOVE ICD1I(6:1) TO ICD1I(7:1)
  8619                     MOVE ICD1I(5:1) TO ICD1I(6:1)
  8620                     MOVE ICD1I(4:1) TO ICD1I(5:1)
  8621                     MOVE '.'        TO ICD1I(4:1)
  8622                 END-IF
  8623             END-IF
  8624         END-IF
  8625         IF (ICD1I GREATER THAN SPACES) AND
  8626            (ICD1I(1:1) NOT > ' ' OR
  8627             ICD1I(2:1) NOT > ' ' OR
  8628             ICD1I(3:1) NOT > ' ' OR
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 155
* EL131.cbl
  8629             ICD1I(4:1) NOT = '.')
  8630              MOVE ER-0992        TO  EMI-ERROR
  8631              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8632              MOVE 'X'            TO ERROR-SWITCH
  8633              MOVE AL-UABON       TO ICD1A
  8634              MOVE -1             TO ICD1L
  8635         ELSE
  8636             MOVE AL-UANON       TO ICD1A
  8637             MOVE 'X'            TO UPDATE-SWITCH
  8638                                    NINETY-TRLR-SWITCH
  8639         END-IF
  8640     ELSE
  8641         MOVE AL-UANOF           TO ICD1A
  8642     END-IF.
  8643
  8644     IF ICD2I GREATER THAN LOW-VALUES
  8645         IF (ICD2I GREATER THAN SPACES) AND
  8646            (ICD2I(4:1) NOT = '.')
  8647             IF ICD2I(4:1) = ' '
  8648                 MOVE '.' TO ICD2I(4:1)
  8649             ELSE
  8650                 IF ICD2I(8:1) = ' '
  8651                     MOVE ICD2I(7:1) TO ICD2I(8:1)
  8652                     MOVE ICD2I(6:1) TO ICD2I(7:1)
  8653                     MOVE ICD2I(5:1) TO ICD2I(6:1)
  8654                     MOVE ICD2I(4:1) TO ICD2I(5:1)
  8655                     MOVE '.'        TO ICD2I(4:1)
  8656                 END-IF
  8657             END-IF
  8658         END-IF
  8659         IF (ICD2I GREATER THAN SPACES) AND
  8660            (ICD2I(1:1) NOT > ' ' OR
  8661             ICD2I(2:1) NOT > ' ' OR
  8662             ICD2I(3:1) NOT > ' ' OR
  8663             ICD2I(4:1) NOT = '.')
  8664              MOVE ER-0992        TO EMI-ERROR
  8665              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8666              MOVE 'X'            TO ERROR-SWITCH
  8667              MOVE AL-UABON       TO ICD2A
  8668              MOVE -1             TO ICD2L
  8669         ELSE
  8670             MOVE AL-UANON       TO ICD2A
  8671             MOVE 'X'            TO UPDATE-SWITCH
  8672                                    NINETY-TRLR-SWITCH
  8673         END-IF
  8674     ELSE
  8675         MOVE AL-UANOF           TO ICD2A
  8676     END-IF.
  8677
  8678*    IF CAUSEI GREATER THAN LOW-VALUES
  8679*        MOVE AL-UANON           TO CAUSEA
  8680*        MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8681*    ELSE
  8682*        MOVE AL-UANOF           TO CAUSEA.
  8683
  8684*    IF ENDL GREATER THAN ZERO
  8685*        MOVE LOW-VALUES         TO HOLD-END
  8686*        IF ENDI = SPACES
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 156
* EL131.cbl
  8687*            MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8688*        ELSE
  8689*            MOVE ENDI           TO DEEDIT-DATE-INPUT
  8690*            EXEC CICS BIF DEEDIT
  8691*                FIELD    (DEEDIT-DATE-INPUT)
  8692*                LENGTH   (DATE-LENGTH)
  8693*            END-EXEC
  8694*            MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8695*            MOVE '4'            TO DC-OPTION-CODE
  8696*            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8697*            IF NOT DATE-CONVERSION-ERROR
  8698*                MOVE DC-BIN-DATE-1      TO HOLD-END
  8699*                MOVE AL-UANON   TO ENDA
  8700*                MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8701*                MOVE DC-GREG-DATE-1-EDIT TO ENDO
  8702*            ELSE
  8703*                MOVE ER-0224    TO EMI-ERROR
  8704*                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8705*                MOVE AL-UABON   TO ENDA
  8706*                MOVE -1         TO ENDL
  8707*                MOVE 'X'        TO ERROR-SWITCH
  8708*      ELSE
  8709*          MOVE AL-UANOF         TO ENDA.
  8710
  8711     IF INCL GREATER THAN ZERO
  8712         MOVE LOW-VALUES         TO HOLD-INCUR
  8713         IF INCI = SPACES
  8714             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8715         ELSE
  8716             MOVE INCI           TO DEEDIT-DATE-INPUT
  8717
  8718* EXEC CICS BIF DEEDIT
  8719*                FIELD    (DEEDIT-DATE-INPUT)
  8720*                LENGTH   (DATE-LENGTH)
  8721*            END-EXEC
  8722*    MOVE '@"L                   #   #00008438' TO DFHEIV0
  8723     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8724     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8725     MOVE X'2020233030303038343338' TO DFHEIV0(25:11)
  8726     CALL 'kxdfhei1' USING DFHEIV0,
  8727           DEEDIT-DATE-INPUT,
  8728           DATE-LENGTH
  8729     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8730             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8731             MOVE '4'            TO DC-OPTION-CODE
  8732             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8733             IF NOT DATE-CONVERSION-ERROR
  8734                 MOVE DC-BIN-DATE-1      TO HOLD-INCUR
  8735                 MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8736                 MOVE AL-UANON           TO INCA
  8737                 MOVE DC-GREG-DATE-1-EDIT TO INCO
  8738             ELSE
  8739                 MOVE ER-0222    TO EMI-ERROR
  8740                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8741                 MOVE AL-UABON   TO INCA
  8742                 MOVE -1         TO INCL
  8743                 MOVE 'X'        TO ERROR-SWITCH
  8744       ELSE
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 157
* EL131.cbl
  8745           IF PI-NO-PMTS = ZEROS
  8746               MOVE AL-UANOF     TO INCA.
  8747
  8748     IF REPL GREATER THAN ZERO
  8749         MOVE LOW-VALUES         TO HOLD-REPORTED
  8750         IF REPI = SPACES
  8751             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8752         ELSE
  8753             MOVE REPI           TO DEEDIT-DATE-INPUT
  8754
  8755* EXEC CICS BIF DEEDIT
  8756*                FIELD    (DEEDIT-DATE-INPUT)
  8757*                LENGTH   (DATE-LENGTH)
  8758*            END-EXEC
  8759*    MOVE '@"L                   #   #00008466' TO DFHEIV0
  8760     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8761     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8762     MOVE X'2020233030303038343636' TO DFHEIV0(25:11)
  8763     CALL 'kxdfhei1' USING DFHEIV0,
  8764           DEEDIT-DATE-INPUT,
  8765           DATE-LENGTH
  8766     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8767             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8768             MOVE '4'            TO DC-OPTION-CODE
  8769             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8770             IF NOT DATE-CONVERSION-ERROR
  8771                 MOVE DC-BIN-DATE-1      TO HOLD-REPORTED
  8772                 MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8773                 MOVE AL-UANON   TO REPA
  8774                 MOVE DC-GREG-DATE-1-EDIT TO REPO
  8775             ELSE
  8776                 MOVE ER-0223    TO EMI-ERROR
  8777                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8778                 MOVE AL-UABON   TO REPA
  8779                 MOVE -1         TO REPL
  8780                 MOVE 'X'        TO ERROR-SWITCH
  8781       ELSE
  8782         MOVE AL-UANOF TO REPA.
  8783
  8784     IF PDTHRUI GREATER THAN LOW-VALUES
  8785        MOVE LOW-VALUES         TO HOLD-PDTHRU
  8786        IF PDTHRUI = SPACES
  8787           MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8788        ELSE
  8789           MOVE PDTHRUI        TO DEEDIT-DATE-INPUT
  8790
  8791* EXEC CICS BIF DEEDIT
  8792*               FIELD    (DEEDIT-DATE-INPUT)
  8793*               LENGTH   (DATE-LENGTH)
  8794*          END-EXEC
  8795*    MOVE '@"L                   #   #00008493' TO DFHEIV0
  8796     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8797     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8798     MOVE X'2020233030303038343933' TO DFHEIV0(25:11)
  8799     CALL 'kxdfhei1' USING DFHEIV0,
  8800           DEEDIT-DATE-INPUT,
  8801           DATE-LENGTH
  8802     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 158
* EL131.cbl
  8803           MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8804           MOVE '4'            TO DC-OPTION-CODE
  8805           PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8806           IF NOT DATE-CONVERSION-ERROR
  8807              MOVE DC-BIN-DATE-1      TO HOLD-PDTHRU
  8808              MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8809              MOVE AL-UANON   TO PDTHRUA
  8810              MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
  8811              IF PI-USES-PAID-TO
  8812                 MOVE '6'            TO DC-OPTION-CODE
  8813                 MOVE -1             TO DC-ELAPSED-DAYS
  8814                 MOVE +0             TO DC-ELAPSED-MONTHS
  8815                 PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8816                 IF NO-CONVERSION-ERROR
  8817                    MOVE DC-BIN-DATE-2 TO HOLD-PDTHRU
  8818                 ELSE
  8819                    NEXT SENTENCE
  8820              ELSE
  8821                 NEXT SENTENCE
  8822           ELSE
  8823              MOVE ER-0475    TO EMI-ERROR
  8824              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8825              MOVE AL-UABON   TO PDTHRUA
  8826              MOVE -1         TO PDTHRUL
  8827              MOVE 'X'        TO ERROR-SWITCH
  8828     ELSE
  8829        IF MODIFY-CAP
  8830           MOVE AL-UANOF        TO PDTHRUA.
  8831
  8832     IF PDAMTL GREATER THAN +0
  8833         MOVE ZEROS              TO HOLD-PDAMT
  8834
  8835* EXEC CICS BIF DEEDIT
  8836*            FIELD    (PDAMTI)
  8837*            LENGTH   (9)
  8838*        END-EXEC
  8839     MOVE 9
  8840       TO DFHEIV11
  8841*    MOVE '@"L                   #   #00008528' TO DFHEIV0
  8842     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8843     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8844     MOVE X'2020233030303038353238' TO DFHEIV0(25:11)
  8845     CALL 'kxdfhei1' USING DFHEIV0,
  8846           PDAMTI,
  8847           DFHEIV11
  8848     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8849         IF PDAMTI NUMERIC
  8850             MOVE PDAMTI         TO HOLD-PDAMT PDAMTO
  8851             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8852             MOVE AL-UNNON       TO PDAMTA
  8853         ELSE
  8854             MOVE ER-0547        TO EMI-ERROR
  8855             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8856             MOVE AL-UNBON       TO PDAMTA
  8857             MOVE -1             TO PDAMTL
  8858             MOVE 'X'            TO ERROR-SWITCH
  8859     ELSE
  8860         IF MODIFY-CAP
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 159
* EL131.cbl
  8861            MOVE AL-UNNOF        TO PDAMTA.
  8862
  8863     IF NODAYSI GREATER THAN LOW-VALUES
  8864         MOVE ZEROS              TO HOLD-NODAYS
  8865
  8866* EXEC CICS BIF DEEDIT
  8867*            FIELD (NODAYSI)
  8868*            LENGTH (5)
  8869*        END-EXEC
  8870     MOVE 5
  8871       TO DFHEIV11
  8872*    MOVE '@"L                   #   #00008548' TO DFHEIV0
  8873     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8874     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8875     MOVE X'2020233030303038353438' TO DFHEIV0(25:11)
  8876     CALL 'kxdfhei1' USING DFHEIV0,
  8877           NODAYSI,
  8878           DFHEIV11
  8879     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8880         IF NODAYSI NUMERIC
  8881             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8882             MOVE AL-UNNON       TO NODAYSA
  8883             MOVE NODAYSI        TO  HOLD-NODAYS  NODAYSO
  8884         ELSE
  8885             MOVE ER-0491        TO EMI-ERROR
  8886             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8887             MOVE AL-UNBON       TO NODAYSA
  8888             MOVE -1             TO NODAYSL
  8889             MOVE 'X'            TO ERROR-SWITCH
  8890     ELSE
  8891         IF MODIFY-CAP
  8892            MOVE AL-UNNOF        TO NODAYSA.
  8893
  8894     IF NOPMTSI GREATER THAN LOW-VALUES
  8895         MOVE ZEROS              TO HOLD-NOPMTS
  8896
  8897* EXEC CICS BIF DEEDIT
  8898*            FIELD (NOPMTSI)
  8899*            LENGTH (4)
  8900*        END-EXEC
  8901     MOVE 4
  8902       TO DFHEIV11
  8903*    MOVE '@"L                   #   #00008568' TO DFHEIV0
  8904     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8905     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8906     MOVE X'2020233030303038353638' TO DFHEIV0(25:11)
  8907     CALL 'kxdfhei1' USING DFHEIV0,
  8908           NOPMTSI,
  8909           DFHEIV11
  8910     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8911         IF NOPMTSI NUMERIC
  8912             MOVE NOPMTSI        TO HOLD-NOPMTS  NOPMTSO
  8913             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8914             MOVE AL-UNNON       TO NOPMTSA
  8915           ELSE
  8916             MOVE ER-0548        TO EMI-ERROR
  8917             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8918             MOVE AL-UNBON       TO NOPMTSA
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 160
* EL131.cbl
  8919             MOVE -1             TO NOPMTSL
  8920             MOVE 'X'            TO ERROR-SWITCH
  8921       ELSE
  8922         IF MODIFY-CAP
  8923            MOVE AL-UNNOF        TO NOPMTSA.
  8924
  8925     IF FORMTYPI GREATER THAN LOW-VALUES
  8926         IF FORMTYPI = ' ' OR 'L' OR 'S'
  8927             MOVE AL-UANON       TO FORMTYPA
  8928             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8929           ELSE
  8930             MOVE ER-7650        TO EMI-ERROR
  8931             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8932             MOVE AL-UABON       TO FORMTYPA
  8933             MOVE -1             TO FORMTYPL
  8934             MOVE 'X'            TO ERROR-SWITCH
  8935       ELSE
  8936         MOVE AL-UANOF           TO FORMTYPA.
  8937
  8938     IF PRICDL GREATER THAN ZERO
  8939         IF (PRICDI = ' ') OR
  8940            (PRICDI GREATER THAN ZERO   AND
  8941             PRICDI NOT GREATER THAN '9')
  8942             MOVE AL-UANON       TO PRICDA
  8943             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8944         ELSE
  8945             MOVE ER-0274        TO EMI-ERROR
  8946             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8947             MOVE AL-UABON       TO PRICDA
  8948             MOVE -1             TO PRICDL
  8949             MOVE 'X'            TO ERROR-SWITCH
  8950     ELSE
  8951         MOVE AL-UANOF TO PRICDA.
  8952
  8953     IF PI-COMPANY-ID = 'DMD'
  8954     IF PRICDL GREATER THAN ZERO
  8955       IF SYSTEM-MODIFY-CAP  OR
  8956          PI-PROCESSOR-ID = 'LGXX'
  8957             NEXT SENTENCE
  8958           ELSE
  8959            IF CL-PRIORITY-CD = '9'  OR
  8960               PRICDI         = '9'
  8961                  MOVE ER-0938        TO EMI-ERROR
  8962                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8963                  MOVE AL-UABON       TO PRICDA
  8964                  MOVE -1             TO PRICDL
  8965                  MOVE 'X'            TO ERROR-SWITCH.
  8966
  8967     IF FILETOL GREATER THAN ZERO
  8968         MOVE AL-UANON           TO FILETOA
  8969         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8970     ELSE
  8971         MOVE AL-UANOF TO FILETOA.
  8972
  8973     IF SUPVL GREATER THAN ZERO
  8974         IF SUPVI = 'Y' OR 'N' OR SPACE
  8975             MOVE AL-UANON       TO SUPVA
  8976             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 161
* EL131.cbl
  8977         ELSE
  8978             MOVE ER-0230        TO EMI-ERROR
  8979             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8980             MOVE AL-UABON       TO SUPVA
  8981             MOVE -1             TO SUPVL
  8982             MOVE 'X'            TO ERROR-SWITCH
  8983     ELSE
  8984         MOVE AL-UANOF           TO SUPVA.
  8985
  8986     IF MLNAMEL GREATER THAN ZERO
  8987         IF MLNAMEI GREATER THAN SPACES
  8988            MOVE AL-UANON        TO MLNAMEA
  8989            MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH
  8990                                     MSTR-KEY-SWITCH
  8991         ELSE
  8992            MOVE ER-0236         TO EMI-ERROR
  8993            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8994            MOVE AL-UABON        TO MLNAMEA
  8995            MOVE -1              TO MLNAMEL
  8996            MOVE 'X'             TO ERROR-SWITCH
  8997     ELSE
  8998         MOVE AL-UANOF           TO MLNAMEA.
  8999
  9000     IF MFNAMEI GREATER THAN LOW-VALUES
  9001         MOVE AL-UANON           TO MFNAMEA
  9002         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  9003     ELSE
  9004         MOVE AL-UANOF           TO MFNAMEA.
  9005
  9006     IF MMINITI GREATER THAN LOW-VALUES
  9007         MOVE AL-UANON           TO MMINITA
  9008         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  9009     ELSE
  9010         MOVE AL-UANOF           TO MMINITA.
  9011
  9012     IF CRTLNMEI GREATER THAN LOW-VALUES
  9013         IF CRTLNMEI NOT = SPACES
  9014            MOVE AL-UANON        TO CRTLNMEA
  9015            MOVE 'X'             TO  UPDATE-SWITCH CERT-SWITCH
  9016                                     CERT-KEY-SWITCH
  9017        ELSE
  9018            MOVE ER-0236         TO EMI-ERROR
  9019            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9020            MOVE AL-UABON        TO CRTLNMEA
  9021            MOVE -1              TO CRTLNMEL
  9022            MOVE 'X'             TO ERROR-SWITCH
  9023     ELSE
  9024         MOVE AL-UANOF           TO CRTLNMEA.
  9025
  9026     IF CRTFNMEI GREATER THAN LOW-VALUES
  9027         MOVE AL-UANON           TO CRTFNMEA
  9028         MOVE 'X'                TO UPDATE-SWITCH CERT-SWITCH
  9029     ELSE
  9030         MOVE AL-UANOF           TO CRTFNMEA.
  9031
  9032     IF CRTINITI GREATER THAN LOW-VALUES
  9033         MOVE AL-UANON           TO CRTINITA
  9034         MOVE 'X' TO UPDATE-SWITCH CERT-SWITCH CERT-KEY-SWITCH
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 162
* EL131.cbl
  9035     ELSE
  9036         MOVE AL-UANOF           TO CRTINITA.
  9037
  9038     IF ISSAGEL GREATER THAN ZERO
  9039         IF ISSAGEI NUMERIC
  9040            MOVE AL-UANON        TO ISSAGEA
  9041            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  9042         ELSE
  9043            MOVE ER-0237         TO EMI-ERROR
  9044            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9045            MOVE AL-UABON        TO ISSAGEA
  9046            MOVE -1              TO ISSAGEL
  9047            MOVE 'X'             TO ERROR-SWITCH
  9048     ELSE
  9049         MOVE AL-UANOF           TO ISSAGEA.
  9050
  9051     IF JNTFNMEI GREATER THAN LOW-VALUES
  9052         MOVE AL-UANON           TO JNTFNMEA
  9053         MOVE 'X'                TO UPDATE-SWITCH CERT-SWITCH
  9054     ELSE
  9055         MOVE AL-UANOF           TO JNTFNMEA.
  9056
  9057     IF JNTLNMEI GREATER THAN LOW-VALUES
  9058         MOVE AL-UANON           TO JNTLNMEA
  9059         MOVE 'X'                TO UPDATE-SWITCH CERT-SWITCH
  9060     ELSE
  9061         MOVE AL-UANOF           TO JNTLNMEA.
  9062
  9063     IF JNTINITI GREATER THAN LOW-VALUES
  9064         MOVE AL-UANON           TO JNTINITA
  9065         MOVE 'X'                TO UPDATE-SWITCH CERT-SWITCH
  9066     ELSE
  9067         MOVE AL-UANOF           TO JNTINITA.
  9068
  9069     IF JNTAGEL GREATER THAN ZERO
  9070         IF JNTAGEI NUMERIC
  9071            MOVE AL-UANON        TO JNTAGEA
  9072            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  9073         ELSE
  9074            MOVE ER-0238         TO EMI-ERROR
  9075            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9076            MOVE AL-UABON        TO JNTAGEA
  9077            MOVE -1              TO JNTAGEL
  9078            MOVE 'X'             TO ERROR-SWITCH
  9079     ELSE
  9080         MOVE AL-UANOF           TO JNTAGEA.
  9081
  9082     IF ADDONDTI GREATER THAN LOW-VALUES
  9083         MOVE LOW-VALUES         TO HOLD-ADDON
  9084         IF ADDONDTI = SPACES
  9085             MOVE 'X'  TO UPDATE-SWITCH MSTR-SWITCH CERT-SWITCH
  9086         ELSE
  9087             MOVE ADDONDTI       TO DEEDIT-DATE-INPUT
  9088
  9089* EXEC CICS BIF DEEDIT
  9090*                FIELD    (DEEDIT-DATE-INPUT)
  9091*                LENGTH   (DATE-LENGTH)
  9092*            END-EXEC
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 163
* EL131.cbl
  9093*    MOVE '@"L                   #   #00008749' TO DFHEIV0
  9094     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9095     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9096     MOVE X'2020233030303038373439' TO DFHEIV0(25:11)
  9097     CALL 'kxdfhei1' USING DFHEIV0,
  9098           DEEDIT-DATE-INPUT,
  9099           DATE-LENGTH
  9100     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9101             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  9102             MOVE '4'            TO DC-OPTION-CODE
  9103             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  9104             IF NOT DATE-CONVERSION-ERROR
  9105                 MOVE DC-BIN-DATE-1      TO HOLD-ADDON
  9106                 MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  9107                                                  CERT-SWITCH
  9108                 MOVE AL-UANON   TO ADDONDTA
  9109                 MOVE DC-GREG-DATE-1-EDIT TO ADDONDTO
  9110             ELSE
  9111                 MOVE ER-7651    TO EMI-ERROR
  9112                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9113                 MOVE AL-UABON   TO ADDONDTA
  9114                 MOVE -1         TO ADDONDTL
  9115                 MOVE 'X'        TO ERROR-SWITCH
  9116       ELSE
  9117         MOVE AL-UANOF TO ADDONDTA.
  9118
  9119     IF LCVCDI GREATER THAN LOW-VALUES
  9120         MOVE LCVCDI             TO WS-EDIT-BEN-CODE
  9121         PERFORM 1240-EDIT-LIFE-CODE THRU 1240-EXIT
  9122     ELSE
  9123         MOVE AL-UANOF           TO LCVCDA.
  9124
  9125     IF ACVCDI GREATER THAN LOW-VALUES
  9126         MOVE ACVCDI             TO WS-EDIT-BEN-CODE
  9127         PERFORM 1310-EDIT-AH-CODE THRU 1310-EXIT
  9128     ELSE
  9129         MOVE AL-UANOF           TO ACVCDA.
  9130
  9131     IF LCVOTRMI GREATER THAN LOW-VALUES
  9132
  9133* EXEC CICS BIF DEEDIT
  9134*            FIELD (LCVOTRMI)
  9135*            LENGTH(3)
  9136*        END-EXEC
  9137     MOVE 3
  9138       TO DFHEIV11
  9139*    MOVE '@"L                   #   #00008784' TO DFHEIV0
  9140     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9141     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9142     MOVE X'2020233030303038373834' TO DFHEIV0(25:11)
  9143     CALL 'kxdfhei1' USING DFHEIV0,
  9144           LCVOTRMI,
  9145           DFHEIV11
  9146     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9147         IF LCVOTRMI IS NUMERIC
  9148             MOVE LCVOTRMI       TO LCVOTRMO
  9149             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  9150             MOVE AL-UANON       TO LCVOTRMA
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 164
* EL131.cbl
  9151         ELSE
  9152             MOVE ER-0241        TO EMI-ERROR
  9153             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9154             MOVE AL-UNBON       TO LCVOTRMA
  9155             MOVE 'X'            TO ERROR-SWITCH
  9156             MOVE -1             TO LCVOTRML
  9157     ELSE
  9158         MOVE AL-UANOF           TO LCVOTRMA.
  9159
  9160     IF ACVOTRMI GREATER THAN LOW-VALUES
  9161
  9162* EXEC CICS BIF DEEDIT
  9163*            FIELD (ACVOTRMI)
  9164*            LENGTH(3)
  9165*        END-EXEC
  9166     MOVE 3
  9167       TO DFHEIV11
  9168*    MOVE '@"L                   #   #00008802' TO DFHEIV0
  9169     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9170     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9171     MOVE X'2020233030303038383032' TO DFHEIV0(25:11)
  9172     CALL 'kxdfhei1' USING DFHEIV0,
  9173           ACVOTRMI,
  9174           DFHEIV11
  9175     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9176         IF ACVOTRMI IS NUMERIC
  9177             MOVE ACVOTRMI       TO ACVOTRMO
  9178             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  9179             MOVE AL-UANON       TO ACVOTRMA
  9180         ELSE
  9181             MOVE ER-0241        TO EMI-ERROR
  9182             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9183             MOVE AL-UNBON       TO ACVOTRMA
  9184             MOVE 'X'            TO ERROR-SWITCH
  9185             MOVE -1             TO ACVOTRML
  9186     ELSE
  9187         MOVE AL-UANOF           TO ACVOTRMA.
  9188
  9189     IF LCVRATEL GREATER THAN +0
  9190
  9191* EXEC CICS BIF DEEDIT
  9192*            FIELD (LCVRATEI)
  9193*            LENGTH(6)
  9194*        END-EXEC
  9195     MOVE 6
  9196       TO DFHEIV11
  9197*    MOVE '@"L                   #   #00008820' TO DFHEIV0
  9198     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9199     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9200     MOVE X'2020233030303038383230' TO DFHEIV0(25:11)
  9201     CALL 'kxdfhei1' USING DFHEIV0,
  9202           LCVRATEI,
  9203           DFHEIV11
  9204     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9205         IF LCVRATEI IS NUMERIC
  9206             MOVE LCVRATEI       TO HOLD-LF-RATE  LCVRATEO
  9207             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  9208             MOVE AL-UNNON       TO LCVRATEA
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 165
* EL131.cbl
  9209         ELSE
  9210             MOVE ER-2280        TO EMI-ERROR
  9211             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9212             MOVE AL-UNBON       TO LCVRATEA
  9213             MOVE 'X'            TO ERROR-SWITCH
  9214             MOVE -1             TO LCVRATEL
  9215     ELSE
  9216         MOVE AL-UNNOF           TO LCVRATEA.
  9217
  9218     IF ACVRATEL GREATER THAN +0
  9219
  9220* EXEC CICS BIF DEEDIT
  9221*            FIELD (ACVRATEI)
  9222*            LENGTH(6)
  9223*        END-EXEC
  9224     MOVE 6
  9225       TO DFHEIV11
  9226*    MOVE '@"L                   #   #00008838' TO DFHEIV0
  9227     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9228     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9229     MOVE X'2020233030303038383338' TO DFHEIV0(25:11)
  9230     CALL 'kxdfhei1' USING DFHEIV0,
  9231           ACVRATEI,
  9232           DFHEIV11
  9233     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9234         IF ACVRATEI IS NUMERIC
  9235             MOVE ACVRATEI       TO HOLD-AH-RATE  ACVRATEO
  9236             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  9237             MOVE AL-UNNON       TO ACVRATEA
  9238         ELSE
  9239             MOVE ER-2280        TO EMI-ERROR
  9240             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9241             MOVE AL-UNBON       TO ACVRATEA
  9242             MOVE 'X'            TO ERROR-SWITCH
  9243             MOVE -1             TO ACVRATEL
  9244     ELSE
  9245         MOVE AL-UNNOF           TO ACVRATEA.
  9246
  9247     IF LCVBENEL GREATER THAN ZERO
  9248
  9249* EXEC CICS BIF DEEDIT
  9250*            FIELD (LCVBENEI)
  9251*            LENGTH (11)
  9252*        END-EXEC
  9253     MOVE 11
  9254       TO DFHEIV11
  9255*    MOVE '@"L                   #   #00008856' TO DFHEIV0
  9256     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9257     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9258     MOVE X'2020233030303038383536' TO DFHEIV0(25:11)
  9259     CALL 'kxdfhei1' USING DFHEIV0,
  9260           LCVBENEI,
  9261           DFHEIV11
  9262     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9263         IF LCVBENEI IS NUMERIC
  9264            MOVE LCVBENEI        TO HOLD-LF-CV-BEN  LCVBENEO
  9265            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  9266            MOVE AL-UNNON        TO LCVBENEA
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 166
* EL131.cbl
  9267         ELSE
  9268            MOVE ER-0243         TO EMI-ERROR
  9269            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9270            MOVE AL-UNBON        TO LCVBENEA
  9271            MOVE -1              TO LCVBENEL
  9272            MOVE 'X'             TO ERROR-SWITCH
  9273     ELSE
  9274         MOVE AL-UANOF           TO LCVBENEA.
  9275
  9276     IF ACVBENEL GREATER THAN ZERO
  9277
  9278* EXEC CICS BIF DEEDIT
  9279*            FIELD (ACVBENEI)
  9280*            LENGTH (11)
  9281*        END-EXEC
  9282     MOVE 11
  9283       TO DFHEIV11
  9284*    MOVE '@"L                   #   #00008874' TO DFHEIV0
  9285     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9286     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9287     MOVE X'2020233030303038383734' TO DFHEIV0(25:11)
  9288     CALL 'kxdfhei1' USING DFHEIV0,
  9289           ACVBENEI,
  9290           DFHEIV11
  9291     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9292         IF ACVBENEI IS NUMERIC
  9293            MOVE ACVBENEI        TO HOLD-AH-CV-BEN  ACVBENEO
  9294            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  9295            MOVE AL-UNNON        TO ACVBENEA
  9296         ELSE
  9297            MOVE ER-0243         TO EMI-ERROR
  9298            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9299            MOVE AL-UNBON        TO ACVBENEA
  9300            MOVE -1              TO ACVBENEL
  9301            MOVE 'X'             TO ERROR-SWITCH
  9302     ELSE
  9303         MOVE AL-UANOF           TO ACVBENEA.
  9304
  9305     IF LCVFORMI GREATER THAN LOW-VALUES
  9306        MOVE 'X'                 TO UPDATE-SWITCH CERT-SWITCH
  9307        MOVE AL-UANON            TO LCVFORMA
  9308     ELSE
  9309        MOVE AL-UANOF            TO LCVFORMA.
  9310
  9311     IF ACVFORMI GREATER THAN LOW-VALUES
  9312        MOVE 'X'                 TO UPDATE-SWITCH CERT-SWITCH
  9313        MOVE AL-UANON            TO ACVFORMA
  9314     ELSE
  9315        MOVE AL-UANOF            TO ACVFORMA.
  9316
  9317     IF LCVCNDTL GREATER THAN ZERO
  9318         MOVE LOW-VALUES         TO HOLD-LF-CV-CAN
  9319         IF LCVCNDTI = SPACES
  9320             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  9321         ELSE
  9322             MOVE LCVCNDTI       TO DEEDIT-DATE-INPUT
  9323             PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT
  9324             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 167
* EL131.cbl
  9325             MOVE '4'            TO DC-OPTION-CODE
  9326             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  9327             IF NOT DATE-CONVERSION-ERROR
  9328                 MOVE DC-BIN-DATE-1      TO HOLD-LF-CV-CAN
  9329                 MOVE AL-UANON   TO LCVCNDTA
  9330                 MOVE 'X'        TO UPDATE-SWITCH CERT-SWITCH
  9331                 MOVE DC-GREG-DATE-1-EDIT TO LCVCNDTO
  9332             ELSE
  9333                 MOVE ER-0246    TO EMI-ERROR
  9334                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9335                 MOVE AL-UABON   TO LCVCNDTA
  9336                 MOVE -1         TO LCVCNDTL
  9337                 MOVE 'X'        TO ERROR-SWITCH
  9338     ELSE
  9339         MOVE LOW-VALUES         TO HOLD-LF-CV-CAN
  9340         MOVE AL-UANOF           TO LCVCNDTA.
  9341
  9342     IF ACVCNDTL GREATER THAN ZERO
  9343         MOVE LOW-VALUES         TO HOLD-AH-CV-CAN
  9344         IF ACVCNDTI = SPACES
  9345             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  9346         ELSE
  9347             MOVE ACVCNDTI       TO DEEDIT-DATE-INPUT
  9348             PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT
  9349             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  9350             MOVE '4'            TO DC-OPTION-CODE
  9351             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  9352             IF NOT DATE-CONVERSION-ERROR
  9353                 MOVE DC-BIN-DATE-1      TO HOLD-AH-CV-CAN
  9354                 MOVE AL-UANON   TO ACVCNDTA
  9355                 MOVE 'X'        TO UPDATE-SWITCH CERT-SWITCH
  9356                 MOVE DC-GREG-DATE-1-EDIT TO ACVCNDTO
  9357             ELSE
  9358                 MOVE ER-0246    TO EMI-ERROR
  9359                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9360                 MOVE AL-UABON   TO ACVCNDTA
  9361                 MOVE -1         TO ACVCNDTL
  9362                 MOVE 'X'        TO ERROR-SWITCH
  9363     ELSE
  9364         MOVE LOW-VALUES         TO HOLD-AH-CV-CAN
  9365         MOVE AL-UANOF           TO ACVCNDTA.
  9366
  9367     IF APRL GREATER THAN +0
  9368
  9369* EXEC CICS BIF DEEDIT
  9370*            FIELD    (APRI)
  9371*            LENGTH   (8)
  9372*        END-EXEC
  9373     MOVE 8
  9374       TO DFHEIV11
  9375*    MOVE '@"L                   #   #00008954' TO DFHEIV0
  9376     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9377     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9378     MOVE X'2020233030303038393534' TO DFHEIV0(25:11)
  9379     CALL 'kxdfhei1' USING DFHEIV0,
  9380           APRI,
  9381           DFHEIV11
  9382     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 168
* EL131.cbl
  9383         IF APRI NUMERIC
  9384            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  9385            MOVE APRI            TO HOLD-APR APRO
  9386            MOVE AL-UANON        TO APRA
  9387          ELSE
  9388            MOVE ER-0259         TO EMI-ERROR
  9389            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9390            MOVE AL-UABON        TO APRA
  9391            MOVE -1              TO APRL
  9392            MOVE 'X'             TO ERROR-SWITCH
  9393     ELSE
  9394         MOVE AL-UANOF           TO APRA.
  9395
  9396     IF PMTFREQL GREATER THAN ZERO
  9397
  9398* EXEC CICS BIF DEEDIT
  9399*            FIELD    (PMTFREQI)
  9400*            LENGTH   (2)
  9401*        END-EXEC
  9402     MOVE 2
  9403       TO DFHEIV11
  9404*    MOVE '@"L                   #   #00008972' TO DFHEIV0
  9405     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9406     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9407     MOVE X'2020233030303038393732' TO DFHEIV0(25:11)
  9408     CALL 'kxdfhei1' USING DFHEIV0,
  9409           PMTFREQI,
  9410           DFHEIV11
  9411     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9412         IF PMTFREQI NUMERIC
  9413            MOVE PMTFREQI        TO  HOLD-FREQ PMTFREQO
  9414            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  9415            MOVE AL-UANON        TO PMTFREQA
  9416          ELSE
  9417            MOVE ER-0427         TO EMI-ERROR
  9418            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9419            MOVE AL-UABON        TO PMTFREQA
  9420            MOVE -1              TO PMTFREQL
  9421            MOVE 'X'             TO ERROR-SWITCH
  9422     ELSE
  9423         MOVE AL-UANOF           TO PMTFREQA.
  9424
  9425     IF INDGRPL GREATER THAN ZERO
  9426         IF INDGRPI = 'I' OR 'G' OR SPACE
  9427             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  9428             MOVE AL-UANON       TO INDGRPA
  9429          ELSE
  9430             MOVE ER-0260        TO EMI-ERROR
  9431             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9432             MOVE AL-UABON       TO INDGRPA
  9433             MOVE -1             TO INDGRPL
  9434             MOVE 'X'            TO ERROR-SWITCH
  9435     ELSE
  9436         MOVE AL-UANOF           TO INDGRPA.
  9437
  9438     IF PREMTYPL GREATER THAN ZERO
  9439         IF PREMTYPI = '1' OR '2' OR '3'
  9440            MOVE PREMTYPI        TO PI-PREM-TYPE
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 169
* EL131.cbl
  9441            MOVE AL-UNNON        TO PREMTYPA
  9442            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  9443          ELSE
  9444            MOVE ER-0227         TO EMI-ERROR
  9445            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9446            MOVE AL-UNBON        TO PREMTYPA
  9447            MOVE -1              TO PREMTYPL
  9448            MOVE 'X'             TO ERROR-SWITCH
  9449     ELSE
  9450         MOVE AL-UANOF           TO PREMTYPA.
  9451
  9452     IF LOANBALL GREATER THAN ZERO
  9453
  9454* EXEC CICS BIF DEEDIT
  9455*             FIELD    (LOANBALI)
  9456*             LENGTH   (9)
  9457*        END-EXEC
  9458     MOVE 9
  9459       TO DFHEIV11
  9460*    MOVE '@"L                   #   #00009017' TO DFHEIV0
  9461     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9462     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9463     MOVE X'2020233030303039303137' TO DFHEIV0(25:11)
  9464     CALL 'kxdfhei1' USING DFHEIV0,
  9465           LOANBALI,
  9466           DFHEIV11
  9467     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9468         IF LOANBALI NUMERIC
  9469             MOVE LOANBALI       TO  HOLD-LOANBAL LOANBALO
  9470             MOVE 'X' TO UPDATE-SWITCH CERT-SWITCH MSTR-SWITCH
  9471             MOVE AL-UNNON TO LOANBALA
  9472         ELSE
  9473             MOVE ER-0639        TO EMI-ERROR
  9474             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9475             MOVE AL-UNBON       TO LOANBALA
  9476             MOVE -1             TO LOANBALL
  9477             MOVE 'X'            TO ERROR-SWITCH
  9478     ELSE
  9479         MOVE AL-UNNOF           TO LOANBALA.
  9480
  9481*    IF LOANNOL GREATER THAN ZERO
  9482*          MOVE 'X'                 TO UPDATE-SWITCH CERT-SWITCH
  9483*          MOVE AL-UANON            TO LOANNOA
  9484*       ELSE
  9485*          MOVE AL-UANOF            TO LOANNOA.
  9486
  9487     IF REINCDI GREATER THAN LOW-VALUES
  9488        MOVE 'X'                 TO UPDATE-SWITCH CERT-SWITCH
  9489        MOVE AL-UANON            TO REINCDA
  9490     ELSE
  9491        MOVE AL-UANOF            TO REINCDA.
  9492
  9493     IF CERTI GREATER THAN LOW-VALUES
  9494         PERFORM 1460-EDIT-CERT-NO THRU 1460-EXIT
  9495     ELSE
  9496         MOVE AL-UANOF           TO CERTA.
  9497
  9498     IF CERTEFFI GREATER THAN LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 170
* EL131.cbl
  9499         PERFORM 1470-EDIT-EFF THRU 1470-EXIT
  9500     ELSE
  9501         MOVE AL-UANOF           TO CERTEFFA.
  9502
  9503     IF CERTACTI GREATER THAN LOW-VALUES
  9504         PERFORM 1480-EDIT-ACCT THRU 1480-EXIT
  9505     ELSE
  9506         MOVE AL-UANOF           TO CERTACTA.
  9507
  9508     IF CERTSTI GREATER THAN LOW-VALUES
  9509         PERFORM 1490-EDIT-STATE THRU 1490-EXIT
  9510     ELSE
  9511         MOVE AL-UANOF           TO CERTSTA.
  9512
  9513     IF CERTCARI GREATER THAN LOW-VALUES
  9514         PERFORM 1500-EDIT-CARR THRU 1500-EXIT
  9515     ELSE
  9516         MOVE AL-UANOF           TO CERTCARA.
  9517
  9518     IF DLYACTV-RECORD-NEEDED
  9519         PERFORM 1150-OUTPUT-ACTIVITY-RECORD THRU
  9520                 1150-EXIT
  9521     END-IF.
  9522
  9523     IF CERTEFFI GREATER LOW-VALUES OR
  9524        CERTACTI GREATER LOW-VALUES OR
  9525        CERTSTI  GREATER LOW-VALUES OR
  9526        CERTCARI GREATER LOW-VALUES OR
  9527        CERTGRPI GREATER LOW-VALUES
  9528        PERFORM 1620-VERIFY-ACCT THRU 1620-EXIT.
  9529
  9530*    IF PI-COMPANY-ID = 'CRI' OR 'PEM' OR 'NCL'
  9531*      IF PI-PREM-TYPE NOT = '1'  AND
  9532*         PI-NO-PMTS = ZEROS
  9533*          IF LOANBALL GREATER +0 OR
  9534*             ACVBENEL GREATER +0
  9535*               PERFORM 1620-VERIFY-ACCT THRU 1620-EXIT.
  9536     if not acct-found
  9537        perform 1620-VERIFY-ACCT THRU 1620-EXIT
  9538     end-if
  9539     MOVE PI-COMPANY-CD          TO COMPANY-CODE
  9540     MOVE PI-CARRIER             TO CARRIER-CODE
  9541     MOVE PI-CLAIM-NO            TO CLAIM-NO
  9542     MOVE PI-CERT-NO             TO CERT-NO
  9543
  9544* EXEC CICS READ
  9545*        DATASET   (CLMS-FILE-ID)
  9546*        RIDFLD    (MSTR-KEY)
  9547*        SET       (ADDRESS OF CLAIM-MASTER)
  9548*        RESP      (WS-RESPONSE)
  9549*    END-EXEC
  9550*    MOVE '&"S        E          (  N#00009096' TO DFHEIV0
  9551     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9552     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9553     MOVE X'204E233030303039303936' TO DFHEIV0(25:11)
  9554     CALL 'kxdfhei1' USING DFHEIV0,
  9555           CLMS-FILE-ID,
  9556           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 171
* EL131.cbl
  9557           DFHEIV99,
  9558           MSTR-KEY,
  9559           DFHEIV99,
  9560           DFHEIV99,
  9561           DFHEIV99
  9562     SET ADDRESS OF CLAIM-MASTER TO
  9563         DFHEIV20
  9564     MOVE EIBRESP  TO WS-RESPONSE
  9565     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9566     MOVE CL-COMPANY-CD          TO CERT-COMPANY-CODE
  9567     MOVE CL-CERT-CARRIER        TO CERT-CARRIER
  9568     MOVE CL-CERT-GROUPING       TO CERT-GROUP
  9569     MOVE CL-CERT-STATE          TO CERT-STATE
  9570     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT
  9571     MOVE CL-CERT-EFF-DT         TO CERT-DATE
  9572     MOVE CL-CERT-NO             TO CERT-CERT
  9573
  9574* EXEC CICS READ
  9575*       DATASET   (CERT-FILE-ID)
  9576*       RIDFLD    (CERT-KEY)
  9577*       SET       (ADDRESS OF CERTIFICATE-MASTER)
  9578*       RESP      (WS-RESPONSE)
  9579*    END-EXEC
  9580*    MOVE '&"S        E          (  N#00009109' TO DFHEIV0
  9581     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9582     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9583     MOVE X'204E233030303039313039' TO DFHEIV0(25:11)
  9584     CALL 'kxdfhei1' USING DFHEIV0,
  9585           CERT-FILE-ID,
  9586           DFHEIV20,
  9587           DFHEIV99,
  9588           CERT-KEY,
  9589           DFHEIV99,
  9590           DFHEIV99,
  9591           DFHEIV99
  9592     SET ADDRESS OF CERTIFICATE-MASTER TO
  9593         DFHEIV20
  9594     MOVE EIBRESP  TO WS-RESPONSE
  9595     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9596     if mfnamei > low-values
  9597        move mfnamei to w-name-first
  9598     else
  9599        move cl-insured-1st-name to w-name-first
  9600     end-if
  9601     if mlnamei > low-values
  9602        move mlnamei to w-name-last
  9603     else
  9604        move cl-insured-last-name to w-name-last
  9605     end-if
  9606     if instypel > zeros
  9607        evaluate true
  9608           when cl-no-of-days-paid > zeros
  9609              move er-1668       to emi-error
  9610              perform 9900-error-format
  9611                                 thru 9900-exit
  9612              move al-uabon      to instypea
  9613              move -1            to instypel
  9614              move 'X'           to error-switch
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 172
* EL131.cbl
  9615           when instypei = 'C'
  9616              if (w-name-first (1:10) = cm-insured-first-name)
  9617                 and (w-name-last = cm-insured-last-name)
  9618                 move er-1666    to emi-error
  9619                 PERFORM 9900-ERROR-FORMAT
  9620                                 THRU 9900-EXIT
  9621                 move al-uabon   to instypea
  9622                 move -1         to instypel
  9623                 move 'X'        to error-switch
  9624              end-if
  9625           when instypei = 'P'
  9626              if (w-name-first (1:10) <> cm-insured-first-name)
  9627                 or (w-name-last <> cm-insured-last-name)
  9628                 move er-1676    to emi-error
  9629                 PERFORM 9900-ERROR-FORMAT
  9630                                 THRU 9900-EXIT
  9631                 move al-uabon   to instypea
  9632                 move -1         to instypel
  9633                 move 'X'        to error-switch
  9634              end-if
  9635        end-evaluate
  9636     end-if
  9637*    if (instypel > zeros)
  9638*       and (cl-no-of-days-paid > zero)
  9639*       move er-1668             to emi-error
  9640*       perform 9900-error-format thru 9900-exit
  9641*       move al-uabon            to instypea
  9642*       move -1                  to instypel
  9643*       move 'X'                 to error-switch
  9644*    end-if
  9645*
  9646*    if instypel > zero
  9647*       if instypei = 'C'
  9648*          if w-name-first (1:10) = cm-insured-first-name
  9649*             move er-1666          to emi-error
  9650*             PERFORM 9900-ERROR-FORMAT
  9651*                                   THRU 9900-EXIT
  9652*             move al-uabon         to instypea
  9653*             move -1               to instypel
  9654*             move 'X'              to error-switch
  9655*          end-if
  9656*       end-if
  9657*    end-if
  9658     if (pi-company-id = 'DCC' OR 'VPP')
  9659        and (acct-found)
  9660        perform 2120-check-pdef  thru 2120-exit
  9661        IF EXTENSL > ZERO
  9662           IF EXTENSI NUMERIC
  9663              IF EXTENSI >  WS-MAX-EXTENSION
  9664                AND ERPDEF-FOUND
  9665                 MOVE ER-1678          TO EMI-ERROR
  9666                 PERFORM 9900-ERROR-FORMAT
  9667                                       THRU 9900-EXIT
  9668                 MOVE AL-UABON         TO EXTENSA
  9669                 MOVE -1               TO EXTENSL
  9670                 MOVE 'X'              TO ERROR-SWITCH
  9671              ELSE
  9672                 MOVE 'X'              TO UPDATE-SWITCH
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 173
* EL131.cbl
  9673              END-IF
  9674           ELSE
  9675              MOVE ER-1778          TO EMI-ERROR
  9676              PERFORM 9900-ERROR-FORMAT
  9677                                    THRU 9900-EXIT
  9678              MOVE AL-UABON         TO EXTENSA
  9679              MOVE -1               TO EXTENSL
  9680              MOVE 'X'              TO ERROR-SWITCH
  9681           END-IF
  9682        END-IF
  9683     end-if
  9684     if benperl > zeros
  9685        move al-uanon            to benpera
  9686     end-if
  9687     if benperl > zeros
  9688        if benperi numeric
  9689           perform 1015-edit-benefit-period
  9690                                 thru 1015-exit
  9691        else
  9692           move er-1669          to emi-error
  9693           PERFORM 9900-ERROR-FORMAT
  9694                                 THRU 9900-EXIT
  9695           move al-uabon         to benpera
  9696           move -1               to benperl
  9697           move 'X'              to error-switch
  9698        end-if
  9699    end-if
  9700     if instypel > zeros
  9701        if instypei = 'P' OR 'C'
  9702           move 'X'              to update-switch
  9703                                    mstr-switch
  9704           move al-uanon         to instypea
  9705        else
  9706            move er-1654          to emi-error
  9707           PERFORM 9900-ERROR-FORMAT
  9708                                 THRU 9900-EXIT
  9709           move al-uabon         to instypea
  9710           move -1               to instypel
  9711           move 'X'              to error-switch
  9712        end-if
  9713    end-if
  9714     if accswl > zeros
  9715        if accswi = 'Y' OR 'N'
  9716           MOVE 'X'              TO UPDATE-SWITCH
  9717                                    MSTR-SWITCH
  9718           MOVE AL-UANON         TO accswa
  9719*       else
  9720*          move er-1656          to emi-error
  9721*          PERFORM 9900-ERROR-FORMAT
  9722*                                THRU 9900-EXIT
  9723*          move al-uabon         to accswa
  9724*          move -1               to accswl
  9725*          move 'X'              to error-switch
  9726*          move al-uanof         to accswa
  9727        end-if
  9728     end-if
  9729     IF CERTL = ZEROS AND
  9730        SUFXL = ZEROS
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 174
* EL131.cbl
  9731          GO TO 1010-EXIT.
  9732
  9733     IF CERTL GREATER THAN ZEROS
  9734         IF CERTI NOT = PI-SAVE-CERT-NO-PRIME
  9735             MOVE CERTI          TO PI-SAVE-CERT-NO-PRIME
  9736             MOVE 'Y'            TO SKIP-ATTRIBUTE
  9737             MOVE 'X'            TO ERROR-SWITCH
  9738             PERFORM 7000-RESET-ATTRIBUTE THRU 7000-EXIT.
  9739
  9740     IF SUFXL GREATER THAN ZEROS
  9741         IF SUFXI NOT = PI-SAVE-CERT-NO-SUFX
  9742             MOVE SUFXI          TO PI-SAVE-CERT-NO-SUFX
  9743             MOVE 'Y'            TO SKIP-ATTRIBUTE
  9744             MOVE 'X'            TO ERROR-SWITCH
  9745             PERFORM 7000-RESET-ATTRIBUTE THRU 7000-EXIT.
  9746
  9747 1010-EXIT.
  9748     EXIT.
  9749
  9750 1015-edit-benefit-period.
  9751     move ' '                    to ws-benper-sw
  9752     evaluate true
  9753        when not erpdef-found
  9754           set good-benper       to true
  9755        when pd-recurring-yn (a1) = 'Y'
  9756           set good-benper       to true
  9757        when pd-recurring-yn (a1) = 'N'
  9758           if benperi < 02
  9759              set good-benper    to true
  9760           end-if
  9761        when pd-rec-crit-period (a1) numeric
  9762           if benperi <= pd-rec-crit-period (a1)
  9763              set good-benper    to true
  9764           end-if
  9765     end-evaluate
  9766     MOVE CERT-KEY               TO ELCRTT-KEY
  9767     MOVE 'B'                    TO CTRLR-REC-TYPE
  9768
  9769* EXEC CICS READ
  9770*       DATASET   ('ELCRTT')
  9771*       RIDFLD    (ELCRTT-KEY)
  9772*       INTO      (CERTIFICATE-TRAILERS)
  9773*       RESP      (WS-RESPONSE)
  9774*    END-EXEC
  9775     MOVE LENGTH OF
  9776      CERTIFICATE-TRAILERS
  9777       TO DFHEIV11
  9778     MOVE 'ELCRTT' TO DFHEIV1
  9779*    MOVE '&"IL       E          (  N#00009287' TO DFHEIV0
  9780     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  9781     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9782     MOVE X'204E233030303039323837' TO DFHEIV0(25:11)
  9783     CALL 'kxdfhei1' USING DFHEIV0,
  9784           DFHEIV1,
  9785           CERTIFICATE-TRAILERS,
  9786           DFHEIV11,
  9787           ELCRTT-KEY,
  9788           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 175
* EL131.cbl
  9789           DFHEIV99,
  9790           DFHEIV99
  9791     MOVE EIBRESP  TO WS-RESPONSE
  9792     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9793     IF WS-RESP-NORMAL
  9794        perform varying s1 from +1 by +1 until
  9795           (s1 > +24)
  9796           or ((cs-claim-type (s1) = cl-claim-type)
  9797           and (cs-insured-type (s1) = cl-insured-type)
  9798           and (cs-benefit-period (s1) > benperi))
  9799        end-perform
  9800        if s1 < +25
  9801           move er-1665          to emi-error
  9802           PERFORM 9900-ERROR-FORMAT
  9803                                 THRU 9900-EXIT
  9804           move al-uabon         to benpera
  9805           move -1               to benperl
  9806           move 'X'              to error-switch
  9807           go to 1015-exit
  9808*       else
  9809*          set good-benper       to true
  9810        end-if
  9811     end-if
  9812     if good-benper
  9813        move 'X'                 to update-switch
  9814                                    mstr-switch
  9815        move al-uanon            to benpera
  9816     else
  9817        move er-1669             to emi-error
  9818        PERFORM 9900-ERROR-FORMAT
  9819                                 THRU 9900-EXIT
  9820        move al-uabon            to benpera
  9821        move -1                  to benperl
  9822        move 'X'                 to error-switch
  9823     end-if
  9824     .
  9825 1015-exit.
  9826     exit.
  9827 1030-EDIT-NAME.
  9828     IF INSTYPEL > ZEROS
  9829        MOVE INSTYPEI TO CL-INSURED-TYPE
  9830     END-IF
  9831     IF MFNAMEL > +0
  9832        IF CL-INSURED-TYPE = 'C'
  9833          AND (CM-INSURED-FIRST-NAME = MFNAMEI(1:10))
  9834           MOVE ER-1675             TO EMI-ERROR
  9835           MOVE -1                  TO MFNAMEL
  9836           MOVE AL-UABON            TO MFNAMEA
  9837           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9838           MOVE 'X'                 TO ERROR-SWITCH
  9839        ELSE
  9840          IF CL-INSURED-TYPE = 'P'
  9841            AND (CM-INSURED-FIRST-NAME <> MFNAMEI(1:10))
  9842             MOVE ER-1676             TO EMI-ERROR
  9843             MOVE -1                  TO MFNAMEL
  9844             MOVE AL-UABON            TO MFNAMEA
  9845             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9846             MOVE 'X'                 TO ERROR-SWITCH
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 176
* EL131.cbl
  9847          END-IF
  9848        END-IF
  9849     END-IF.
  9850
  9851 1030-EXIT.
  9852     EXIT.
  9853 1050-EDIT-BENE.
  9854     MOVE PI-COMPANY-CD      TO TRLR-COMPANY-CD.
  9855     MOVE PI-CARRIER         TO TRLR-CARRIER.
  9856     MOVE PI-CLAIM-NO        TO TRLR-CLAIM-NO.
  9857     MOVE PI-CERT-NO         TO TRLR-CERT-NO.
  9858     MOVE 1000               TO TRLR-SEQ-NO.
  9859
  9860
  9861* EXEC CICS HANDLE CONDITION
  9862*         NOTFND    (1052-DONE)
  9863*         ENDFILE   (1052-DONE)
  9864*    END-EXEC.
  9865*    MOVE '"$I''                  ! & #00009360' TO DFHEIV0
  9866     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  9867     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9868     MOVE X'2620233030303039333630' TO DFHEIV0(25:11)
  9869     CALL 'kxdfhei1' USING DFHEIV0
  9870     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9871
  9872
  9873
  9874* EXEC CICS STARTBR
  9875*        DATASET (TRLR-FILE-ID)
  9876*        RIDFLD  (TRLR-KEY)
  9877*    END-EXEC
  9878     MOVE 0
  9879       TO DFHEIV11
  9880*    MOVE '&,         G          &   #00009365' TO DFHEIV0
  9881     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9882     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9883     MOVE X'2020233030303039333635' TO DFHEIV0(25:11)
  9884     CALL 'kxdfhei1' USING DFHEIV0,
  9885           TRLR-FILE-ID,
  9886           TRLR-KEY,
  9887           DFHEIV99,
  9888           DFHEIV11,
  9889           DFHEIV99
  9890     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9891
  9892
  9893     MOVE SPACES TO WS-TRLR-FILE-EOF
  9894                    WS-PAYMENT-PENDING
  9895     PERFORM 1052-READ-TRLR THRU 1052-EXIT
  9896       UNTIL  TRLR-FILE-EOF
  9897         OR PAYMENT-PENDING
  9898
  9899
  9900* EXEC CICS ENDBR
  9901*        DATASET (TRLR-FILE-ID)
  9902*    END-EXEC.
  9903     MOVE 0
  9904       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 177
* EL131.cbl
  9905*    MOVE '&2                    $   #00009377' TO DFHEIV0
  9906     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9907     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9908     MOVE X'2020233030303039333737' TO DFHEIV0(25:11)
  9909     CALL 'kxdfhei1' USING DFHEIV0,
  9910           TRLR-FILE-ID,
  9911           DFHEIV11,
  9912           DFHEIV99
  9913     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9914
  9915 1050-EXIT.
  9916     EXIT.
  9917
  9918 1052-READ-TRLR.
  9919
  9920* EXEC CICS READNEXT
  9921*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
  9922*         DATASET  (TRLR-FILE-ID)
  9923*         RIDFLD   (TRLR-KEY)
  9924*    END-EXEC.
  9925     MOVE 0
  9926       TO DFHEIV11
  9927*    MOVE '&.S                   )   #00009384' TO DFHEIV0
  9928     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9929     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  9930     MOVE X'2020233030303039333834' TO DFHEIV0(25:11)
  9931     CALL 'kxdfhei1' USING DFHEIV0,
  9932           TRLR-FILE-ID,
  9933           DFHEIV20,
  9934           DFHEIV99,
  9935           TRLR-KEY,
  9936           DFHEIV99,
  9937           DFHEIV11,
  9938           DFHEIV99,
  9939           DFHEIV99
  9940     SET ADDRESS OF ACTIVITY-TRAILERS TO
  9941         DFHEIV20
  9942     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9943
  9944
  9945     IF PI-COMPANY-CD   = TRLR-COMPANY-CD
  9946       AND PI-CARRIER  = TRLR-CARRIER
  9947       AND PI-CLAIM-NO = TRLR-CLAIM-NO
  9948       AND PI-CERT-NO  = TRLR-CERT-NO
  9949        CONTINUE
  9950     ELSE
  9951        GO TO 1052-DONE
  9952     END-IF.
  9953
  9954     IF PAYMENT-TR
  9955       AND BENEFICIARY-PAID
  9956       AND AT-VOID-DT = LOW-VALUES
  9957       AND AT-CHECK-WRITTEN-DT NOT > SPACES
  9958         SET PAYMENT-PENDING TO TRUE
  9959     END-IF.
  9960
  9961     IF CORRESPONDENCE-TR
  9962        IF AT-AUTH-RCVD = 'Y'
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 178
* EL131.cbl
  9963           SET AUTH-RCVD TO TRUE
  9964        ELSE
  9965        IF AT-AUTH-RCVD = 'N'
  9966           SET NO-AUTH-RCVD TO TRUE
  9967        END-IF
  9968        END-IF
  9969     END-IF.
  9970
  9971     GO TO 1052-EXIT.
  9972
  9973 1052-DONE.
  9974     SET TRLR-FILE-EOF TO TRUE.
  9975 1052-EXIT.
  9976     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 179
* EL131.cbl
  9978 1120-EDIT-PROC.
  9979     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
  9980     MOVE '2'                    TO CNTL-REC-TYPE.
  9981     MOVE PROCI                  TO CNTL-PROC-ID.
  9982     MOVE ZERO                   TO CNTL-SEQ-NO.
  9983
  9984
  9985* EXEC CICS HANDLE CONDITION
  9986*         NOTFND    (1120-CNTL-NOTFND)
  9987*    END-EXEC.
  9988*    MOVE '"$I                   ! '' #00009429' TO DFHEIV0
  9989     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9990     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9991     MOVE X'2720233030303039343239' TO DFHEIV0(25:11)
  9992     CALL 'kxdfhei1' USING DFHEIV0
  9993     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9994
  9995
  9996
  9997* EXEC CICS READ
  9998*         SET      (ADDRESS OF CONTROL-FILE)
  9999*         DATASET  (CNTL-FILE-ID)
 10000*         RIDFLD   (CNTL-KEY)
 10001*    END-EXEC.
 10002*    MOVE '&"S        E          (   #00009433' TO DFHEIV0
 10003     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10004     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10005     MOVE X'2020233030303039343333' TO DFHEIV0(25:11)
 10006     CALL 'kxdfhei1' USING DFHEIV0,
 10007           CNTL-FILE-ID,
 10008           DFHEIV20,
 10009           DFHEIV99,
 10010           CNTL-KEY,
 10011           DFHEIV99,
 10012           DFHEIV99,
 10013           DFHEIV99
 10014     SET ADDRESS OF CONTROL-FILE TO
 10015         DFHEIV20
 10016     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10017
 10018
 10019     MOVE AL-UANON               TO PROCA.
 10020     MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH MSTR-KEY-SWITCH.
 10021     GO TO 1120-EXIT.
 10022
 10023 1120-CNTL-NOTFND.
 10024     MOVE ER-0273                TO EMI-ERROR.
 10025     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10026     MOVE AL-UABON               TO PROCA.
 10027     MOVE -1                     TO PROCL.
 10028     MOVE 'X'                    TO ERROR-SWITCH.
 10029
 10030 1120-EXIT.
 10031     EXIT.
 10032
 10033*************************************************************
 10034*****    BEGIN PROCESSING FOR OUTPUTTING DLYACTV RECORD    **
 10035*************************************************************
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 180
* EL131.cbl
 10036
 10037 1150-OUTPUT-ACTIVITY-RECORD.
 10038
 10039
 10040* EXEC CICS GETMAIN
 10041*        SET (ADDRESS OF DAILY-ACTIVITY-RECORD)
 10042*        LENGTH (25)
 10043*        INITIMG (WS-BLANK)
 10044*    END-EXEC.
 10045     MOVE 25
 10046       TO DFHEIV11
 10047*    MOVE ',"IL                  $   #00009459' TO DFHEIV0
 10048     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 10049     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10050     MOVE X'2020233030303039343539' TO DFHEIV0(25:11)
 10051     CALL 'kxdfhei1' USING DFHEIV0,
 10052           DFHEIV20,
 10053           DFHEIV11,
 10054           WS-BLANK
 10055     SET ADDRESS OF DAILY-ACTIVITY-RECORD TO
 10056         DFHEIV20
 10057     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10058
 10059
 10060     MOVE SPACES                 TO DAILY-ACTIVITY-RECORD.
 10061     MOVE PI-COMPANY-CD          TO DA-COMP-CD.
 10062     MOVE PI-CARRIER             TO DA-CARRIER.
 10063     MOVE PI-CLAIM-NO            TO DA-CLAIM-NO.
 10064     MOVE PI-CERT-NO             TO DA-CERT-NO.
 10065     MOVE ZEROS                  TO DA-TRAILER-SEQ-NO.
 10066     MOVE WS-HOLD-CLAIM-STATUS   TO DA-RECORD-TYPE.
 10067
 10068
 10069* EXEC CICS HANDLE CONDITION
 10070*        NOTOPEN (1150-NOTOPEN-ERROR)
 10071*        DUPREC (1150-EXIT)
 10072*    END-EXEC.
 10073*    MOVE '"$J%                  ! ( #00009473' TO DFHEIV0
 10074     MOVE X'22244A252020202020202020' TO DFHEIV0(1:12)
 10075     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10076     MOVE X'2820233030303039343733' TO DFHEIV0(25:11)
 10077     CALL 'kxdfhei1' USING DFHEIV0
 10078     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10079
 10080     MOVE DAILY-ACTIVITY-RECORD  TO JP-RECORD-AREA.
 10081     MOVE 'DLYACTV'              TO JP-FILE-ID.
 10082     MOVE 'A'                    TO JP-RECORD-TYPE.
 10083     MOVE +48                    TO JOURNAL-LENGTH.
 10084
 10085
 10086* EXEC CICS WRITE
 10087*        DATASET ('DLYACTV')
 10088*        RIDFLD (DA-KEY)
 10089*        FROM (DAILY-ACTIVITY-RECORD)
 10090*        LENGTH (25)
 10091*    END-EXEC.
 10092     MOVE 'DLYACTV' TO DFHEIV1
 10093     MOVE 25
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 181
* EL131.cbl
 10094       TO DFHEIV11
 10095*    MOVE '&$ L                  ''   #00009482' TO DFHEIV0
 10096     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10097     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10098     MOVE X'2020233030303039343832' TO DFHEIV0(25:11)
 10099     CALL 'kxdfhei1' USING DFHEIV0,
 10100           DFHEIV1,
 10101           DAILY-ACTIVITY-RECORD,
 10102           DFHEIV11,
 10103           DA-KEY,
 10104           DFHEIV99,
 10105           DFHEIV99
 10106     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10107
 10108
 10109     GO TO 1150-EXIT.
 10110
 10111 1150-NOTOPEN-ERROR.
 10112
 10113     MOVE '2955'                 TO EMI-ERROR.
 10114     MOVE -1                     TO MAINTL.
 10115     MOVE AL-UANON               TO MAINTA.
 10116     MOVE 'X'                    TO ERROR-SWITCH.
 10117     PERFORM 9900-ERROR-FORMAT THRU
 10118             9900-EXIT.
 10119
 10120 1150-EXIT.
 10121     EXIT.
 10122
 10123*************************************************************
 10124*****    END OF PROCESSING FOR OUTPUTTING DLYACTV RECORD    *
 10125*************************************************************
 10126
 10127 1240-EDIT-LIFE-CODE.
 10128
 10129     IF INVALID-BENEFIT-CODE
 10130         GO TO 1240-SET-ERROR.
 10131
 10132     MOVE SPACES                 TO BENEFIT-KEY.
 10133     MOVE PI-COMPANY-ID          TO BEN-CO-ID.
 10134     MOVE '4'                    TO BEN-REC-TYPE.
 10135     MOVE LCVCDI                 TO BEN-ACC-CD HOLD-BENEFIT.
 10136     MOVE ZERO                   TO BEN-SEQ-NO.
 10137
 10138
 10139* EXEC CICS READ GTEQ
 10140*         DATASET  (CNTL-FILE-ID)
 10141*         RIDFLD   (BENEFIT-KEY)
 10142*         SET      (ADDRESS OF CONTROL-FILE)
 10143*    END-EXEC.
 10144*    MOVE '&"S        G          (   #00009518' TO DFHEIV0
 10145     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 10146     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10147     MOVE X'2020233030303039353138' TO DFHEIV0(25:11)
 10148     CALL 'kxdfhei1' USING DFHEIV0,
 10149           CNTL-FILE-ID,
 10150           DFHEIV20,
 10151           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 182
* EL131.cbl
 10152           BENEFIT-KEY,
 10153           DFHEIV99,
 10154           DFHEIV99,
 10155           DFHEIV99
 10156     SET ADDRESS OF CONTROL-FILE TO
 10157         DFHEIV20
 10158     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10159
 10160
 10161     IF CF-COMPANY-ID  NOT = PI-COMPANY-ID OR
 10162        CF-RECORD-TYPE NOT = '4'
 10163         GO TO 1240-SET-ERROR.
 10164
 10165     MOVE ZERO                   TO COUNT-2.
 10166     PERFORM 5040-FIND-BENEFIT THRU 5060-EXIT.
 10167
 10168     IF SCREEN-ERROR
 10169         GO TO 1240-SET-ERROR.
 10170
 10171 1240-SET-CODE-SWITCHES.
 10172     MOVE 'X'                    TO UPDATE-SWITCH CERT-SWITCH.
 10173     MOVE AL-UANON               TO LCVCDA.
 10174     GO TO 1240-EXIT.
 10175
 10176 1240-SET-ERROR.
 10177     MOVE ER-0240                TO EMI-ERROR.
 10178     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10179     MOVE 'X'                    TO ERROR-SWITCH.
 10180     MOVE AL-UABON               TO LCVCDA.
 10181     MOVE -1                     TO LCVCDL.
 10182
 10183 1240-EXIT.
 10184     EXIT.
 10185
 10186 1310-EDIT-AH-CODE.
 10187     IF INVALID-BENEFIT-CODE
 10188         GO TO 1310-SET-ERROR.
 10189
 10190     MOVE SPACES                 TO BENEFIT-KEY.
 10191     MOVE PI-COMPANY-ID          TO BEN-CO-ID.
 10192     MOVE '5'                    TO BEN-REC-TYPE.
 10193     MOVE ACVCDI                 TO BEN-ACC-CD HOLD-BENEFIT.
 10194     MOVE ZERO                   TO BEN-SEQ-NO.
 10195
 10196
 10197* EXEC CICS READ GTEQ
 10198*         DATASET  (CNTL-FILE-ID)
 10199*         RIDFLD   (BENEFIT-KEY)
 10200*         SET      (ADDRESS OF CONTROL-FILE)
 10201*    END-EXEC.
 10202*    MOVE '&"S        G          (   #00009559' TO DFHEIV0
 10203     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 10204     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10205     MOVE X'2020233030303039353539' TO DFHEIV0(25:11)
 10206     CALL 'kxdfhei1' USING DFHEIV0,
 10207           CNTL-FILE-ID,
 10208           DFHEIV20,
 10209           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 183
* EL131.cbl
 10210           BENEFIT-KEY,
 10211           DFHEIV99,
 10212           DFHEIV99,
 10213           DFHEIV99
 10214     SET ADDRESS OF CONTROL-FILE TO
 10215         DFHEIV20
 10216     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10217
 10218
 10219     IF CF-COMPANY-ID  NOT = PI-COMPANY-ID OR
 10220        CF-RECORD-TYPE NOT = '5'
 10221         GO TO 1310-SET-ERROR.
 10222
 10223     MOVE ZERO                   TO COUNT-2.
 10224     PERFORM 5040-FIND-BENEFIT THRU 5060-EXIT.
 10225     IF SCREEN-ERROR
 10226         GO TO 1310-SET-ERROR.
 10227
 10228 1310-SET-CODE-SWITCHES.
 10229     MOVE 'X'                    TO UPDATE-SWITCH CERT-SWITCH.
 10230     MOVE AL-UANON               TO ACVCDA.
 10231     GO TO 1310-EXIT.
 10232
 10233 1310-SET-ERROR.
 10234     MOVE ER-0250                TO EMI-ERROR.
 10235     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10236     MOVE AL-UABON               TO ACVCDA.
 10237     MOVE 'X'                    TO ERROR-SWITCH.
 10238     MOVE -1                     TO ACVCDL.
 10239
 10240 1310-EXIT.
 10241     EXIT.
 10242
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 184
* EL131.cbl
 10244 1460-EDIT-CERT-NO.
 10245     MOVE CERTI                  TO WS-CERT-NO-PRIME.
 10246     MOVE SUFXI                  TO WS-CERT-NO-SUFX.
 10247
 10248     IF WS-SAVE-CERT-NO = SPACES
 10249         MOVE ER-0203            TO EMI-ERROR
 10250         GO TO 1460-CERT-NO-ERROR.
 10251
 10252     IF WS-CERT-NO-PRIME = SPACES AND
 10253        WS-CERT-NO-SUFX GREATER THAN SPACE
 10254            MOVE ER-0210         TO EMI-ERROR
 10255            GO TO 1460-CERT-NO-ERROR.
 10256
 10257     MOVE 'X'                    TO UPDATE-SWITCH.
 10258     MOVE 'Y'                    TO CERT-KEY-SWITCH.
 10259     MOVE AL-UANON               TO CERTA.
 10260
 10261     IF SUFXL IS GREATER THAN 0
 10262         MOVE AL-UANON           TO SUFXA.
 10263
 10264     GO TO 1460-EXIT.
 10265
 10266 1460-CERT-NO-ERROR.
 10267     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10268     MOVE AL-UABON               TO SUFXA.
 10269     MOVE AL-UABON               TO CERTA.
 10270     MOVE -1                     TO CERTL.
 10271     MOVE 'X'                    TO ERROR-SWITCH.
 10272
 10273 1460-EXIT.
 10274     EXIT.
 10275
 10276 1470-EDIT-EFF.
 10277     IF CERTEFFI = SPACES
 10278         GO TO 1470-DATE-ERROR.
 10279
 10280     MOVE CERTEFFI               TO DEEDIT-DATE-INPUT.
 10281     PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT.
 10282     IF DEEDIT-DATE = ZERO
 10283         GO TO 1470-DATE-ERROR.
 10284
 10285     MOVE DEEDIT-DATE            TO DC-GREG-DATE-1-MDY.
 10286     MOVE '4'                    TO DC-OPTION-CODE.
 10287     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
 10288     IF NOT DATE-CONVERSION-ERROR
 10289         MOVE DC-BIN-DATE-1      TO HOLD-EFF
 10290         MOVE AL-UANON           TO CERTEFFA
 10291         MOVE 'X'                TO UPDATE-SWITCH
 10292         MOVE 'Y'                TO CERT-KEY-SWITCH
 10293         MOVE DC-GREG-DATE-1-EDIT TO CERTEFFO
 10294         GO TO 1470-EXIT.
 10295
 10296 1470-DATE-ERROR.
 10297     MOVE ER-0215                TO EMI-ERROR.
 10298     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10299     MOVE AL-UABON               TO CERTEFFA.
 10300     MOVE -1                     TO CERTEFFL.
 10301     MOVE 'X'                    TO ERROR-SWITCH.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 185
* EL131.cbl
 10302
 10303 1470-EXIT.
 10304     EXIT.
 10305
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 186
* EL131.cbl
 10307 1480-EDIT-ACCT.
 10308     IF CERTACTI = SPACES
 10309         MOVE ER-0232            TO EMI-ERROR
 10310         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10311         MOVE AL-UABON           TO CERTACTA
 10312         MOVE -1                 TO CERTACTL
 10313         MOVE 'X'                TO ERROR-SWITCH
 10314     ELSE
 10315         MOVE 'X'                TO UPDATE-SWITCH
 10316         MOVE 'Y'                TO CERT-KEY-SWITCH.
 10317
 10318 1480-EXIT.
 10319     EXIT.
 10320
 10321 1490-EDIT-STATE.
 10322     IF CERTSTI = SPACES
 10323         MOVE ER-0233            TO EMI-ERROR
 10324         GO TO 1490-STATE-ERROR.
 10325
 10326     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
 10327     MOVE '3'                    TO CNTL-REC-TYPE.
 10328     MOVE SPACES                 TO CNTL-STATE-ACCESS.
 10329     MOVE CERTSTI                TO CNTL-STATE-NUMBER.
 10330     MOVE ZERO                   TO CNTL-SEQ-NO.
 10331
 10332
 10333* EXEC CICS HANDLE CONDITION
 10334*         NOTFND (1490-STATE-NOTFND)
 10335*    END-EXEC.
 10336*    MOVE '"$I                   ! ) #00009678' TO DFHEIV0
 10337     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10338     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10339     MOVE X'2920233030303039363738' TO DFHEIV0(25:11)
 10340     CALL 'kxdfhei1' USING DFHEIV0
 10341     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10342
 10343
 10344
 10345* EXEC CICS READ
 10346*         SET        (ADDRESS OF CONTROL-FILE)
 10347*         DATASET    ('ELCNTL')
 10348*         RIDFLD     (CNTL-KEY)
 10349*         KEYLENGTH  (CNTL-GENERIC-LENGTH)
 10350*         GENERIC
 10351*    END-EXEC.
 10352     MOVE 'ELCNTL' TO DFHEIV1
 10353*    MOVE '&"S  KG    E          (   #00009682' TO DFHEIV0
 10354     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 10355     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10356     MOVE X'2020233030303039363832' TO DFHEIV0(25:11)
 10357     CALL 'kxdfhei1' USING DFHEIV0,
 10358           DFHEIV1,
 10359           DFHEIV20,
 10360           DFHEIV99,
 10361           CNTL-KEY,
 10362           CNTL-GENERIC-LENGTH,
 10363           DFHEIV99,
 10364           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 187
* EL131.cbl
 10365     SET ADDRESS OF CONTROL-FILE TO
 10366         DFHEIV20
 10367     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10368
 10369
 10370     MOVE AL-UANON               TO CERTSTA.
 10371     MOVE 'X'                    TO UPDATE-SWITCH.
 10372     MOVE 'Y'                    TO CERT-KEY-SWITCH.
 10373     GO TO 1490-EXIT.
 10374
 10375 1490-STATE-NOTFND.
 10376     MOVE ER-0149                TO EMI-ERROR.
 10377
 10378 1490-STATE-ERROR.
 10379     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10380     MOVE AL-UABON               TO CERTSTA.
 10381     MOVE -1                     TO CERTSTL.
 10382     MOVE 'X'                    TO ERROR-SWITCH.
 10383
 10384 1490-EXIT.
 10385     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 188
* EL131.cbl
 10387 1500-EDIT-CARR.
 10388     IF CERTCARI = SPACES
 10389         GO TO 1500-CARR-NOTFND.
 10390
 10391     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
 10392     MOVE '6'                    TO CNTL-REC-TYPE.
 10393     MOVE SPACES                 TO CNTL-CARRIER-ACCESS.
 10394     MOVE CERTCARI               TO CNTL-CARRIER.
 10395     MOVE ZERO                   TO CNTL-SEQ-NO.
 10396
 10397
 10398* EXEC CICS HANDLE CONDITION
 10399*         NOTFND   (1500-CARR-NOTFND)
 10400*    END-EXEC.
 10401*    MOVE '"$I                   ! * #00009717' TO DFHEIV0
 10402     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10403     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10404     MOVE X'2A20233030303039373137' TO DFHEIV0(25:11)
 10405     CALL 'kxdfhei1' USING DFHEIV0
 10406     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10407
 10408
 10409
 10410* EXEC CICS READ
 10411*         SET        (ADDRESS OF CONTROL-FILE)
 10412*         DATASET    ('ELCNTL')
 10413*         RIDFLD     (CNTL-KEY)
 10414*         KEYLENGTH  (CNTL-GENERIC-LENGTH)
 10415*         GENERIC
 10416*    END-EXEC.
 10417     MOVE 'ELCNTL' TO DFHEIV1
 10418*    MOVE '&"S  KG    E          (   #00009721' TO DFHEIV0
 10419     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 10420     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10421     MOVE X'2020233030303039373231' TO DFHEIV0(25:11)
 10422     CALL 'kxdfhei1' USING DFHEIV0,
 10423           DFHEIV1,
 10424           DFHEIV20,
 10425           DFHEIV99,
 10426           CNTL-KEY,
 10427           CNTL-GENERIC-LENGTH,
 10428           DFHEIV99,
 10429           DFHEIV99
 10430     SET ADDRESS OF CONTROL-FILE TO
 10431         DFHEIV20
 10432     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10433
 10434
 10435     MOVE AL-UANON               TO CERTCARA.
 10436     MOVE 'X'                    TO UPDATE-SWITCH.
 10437     MOVE 'Y'                    TO CERT-KEY-SWITCH.
 10438     GO TO 1500-EXIT.
 10439
 10440 1500-CARR-NOTFND.
 10441     MOVE ER-0360                TO EMI-ERROR.
 10442     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10443     MOVE AL-UABON               TO CERTCARA.
 10444     MOVE -1                     TO CERTCARL.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 189
* EL131.cbl
 10445     MOVE 'X'                    TO ERROR-SWITCH.
 10446
 10447 1500-EXIT.
 10448     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 190
* EL131.cbl
 10450 1510-DEEDIT-DATE.
 10451
 10452* EXEC CICS BIF DEEDIT
 10453*         FIELD    (DEEDIT-DATE-INPUT)
 10454*         LENGTH   (DATE-LENGTH)
 10455*    END-EXEC.
 10456*    MOVE '@"L                   #   #00009745' TO DFHEIV0
 10457     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10458     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10459     MOVE X'2020233030303039373435' TO DFHEIV0(25:11)
 10460     CALL 'kxdfhei1' USING DFHEIV0,
 10461           DEEDIT-DATE-INPUT,
 10462           DATE-LENGTH
 10463     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10464
 10465
 10466 1510-EXIT.
 10467     EXIT.
 10468
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 191
* EL131.cbl
 10470 1620-VERIFY-ACCT.
 10471
 10472     move ' '                    to ws-eracct-sw
 10473     MOVE PI-COMPANY-CD          TO ACCT-COMPANY-CODE.
 10474     MOVE PI-CARRIER             TO ACCT-CARRIER.
 10475     MOVE PI-GROUPING            TO ACCT-GROUP.
 10476     MOVE PI-STATE               TO ACCT-STATE.
 10477     MOVE PI-ACCOUNT             TO ACCT-ACCOUNT.
 10478
 10479     IF CERTEFFI GREATER THAN LOW-VALUES
 10480         MOVE HOLD-EFF           TO ACCT-DATE
 10481     ELSE
 10482         MOVE PI-CERT-EFF-DT     TO HOLD-EFF ACCT-DATE.
 10483
 10484     IF CERTACTI GREATER THAN LOW-VALUES
 10485         MOVE CERTACTI           TO  ACCT-ACCOUNT.
 10486     IF CERTSTI GREATER THAN LOW-VALUES
 10487         MOVE CERTSTI            TO  ACCT-STATE.
 10488     IF CERTCARI GREATER THAN LOW-VALUES
 10489         MOVE CERTCARI           TO  ACCT-CARRIER.
 10490     IF CERTGRPI GREATER THAN LOW-VALUES
 10491         MOVE CERTGRPI           TO ACCT-GROUP.
 10492
 10493     MOVE ACCT-PARTIAL-KEY       TO SAVE-ACCT-KEY.
 10494
 10495
 10496* EXEC CICS HANDLE CONDITION
 10497*         NOTFND  (1620-ACCT-NOTFND)
 10498*    END-EXEC.
 10499*    MOVE '"$I                   ! + #00009779' TO DFHEIV0
 10500     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10501     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10502     MOVE X'2B20233030303039373739' TO DFHEIV0(25:11)
 10503     CALL 'kxdfhei1' USING DFHEIV0
 10504     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10505
 10506
 10507
 10508* EXEC CICS STARTBR
 10509*         DATASET   (ACCT-FILE-ID)
 10510*         RIDFLD    (ACCT-KEY)
 10511*    END-EXEC.
 10512     MOVE 0
 10513       TO DFHEIV11
 10514*    MOVE '&,         G          &   #00009783' TO DFHEIV0
 10515     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 10516     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10517     MOVE X'2020233030303039373833' TO DFHEIV0(25:11)
 10518     CALL 'kxdfhei1' USING DFHEIV0,
 10519           ACCT-FILE-ID,
 10520           ACCT-KEY,
 10521           DFHEIV99,
 10522           DFHEIV11,
 10523           DFHEIV99
 10524     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10525
 10526
 10527 1620-ACCT-LOOP.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 192
* EL131.cbl
 10528
 10529
 10530* EXEC CICS READNEXT
 10531*         DATASET  (ACCT-FILE-ID)
 10532*         RIDFLD   (ACCT-KEY)
 10533*         SET      (ADDRESS OF ACCOUNT-MASTER)
 10534*    END-EXEC.
 10535     MOVE 0
 10536       TO DFHEIV11
 10537*    MOVE '&.S                   )   #00009790' TO DFHEIV0
 10538     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 10539     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 10540     MOVE X'2020233030303039373930' TO DFHEIV0(25:11)
 10541     CALL 'kxdfhei1' USING DFHEIV0,
 10542           ACCT-FILE-ID,
 10543           DFHEIV20,
 10544           DFHEIV99,
 10545           ACCT-KEY,
 10546           DFHEIV99,
 10547           DFHEIV11,
 10548           DFHEIV99,
 10549           DFHEIV99
 10550     SET ADDRESS OF ACCOUNT-MASTER TO
 10551         DFHEIV20
 10552     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10553
 10554
 10555     IF SAVE-ACCT-KEY NOT = ACCT-PARTIAL-KEY
 10556         GO TO 1620-ACCT-NOTFND.
 10557
 10558     IF HOLD-EFF NOT LESS AM-EFFECTIVE-DT  AND
 10559        HOLD-EFF     LESS AM-EXPIRATION-DT
 10560         NEXT SENTENCE
 10561     ELSE
 10562         GO TO 1620-ACCT-LOOP.
 10563
 10564     set acct-found to true
 10565     IF PI-COMPANY-ID NOT = 'CRI' AND 'PEM' AND 'NCL'
 10566         GO TO 1620-ACCT-END-BROWSE.
 10567
 10568     IF LOANBALL GREATER THAN +0
 10569         IF AM-MAX-TOT-BEN NUMERIC  AND
 10570            AM-MAX-TOT-BEN GREATER THAN ZERO
 10571             IF HOLD-LOANBAL GREATER THAN AM-MAX-TOT-BEN
 10572                 MOVE AL-UNBON     TO LOANBALA
 10573                 MOVE -1           TO LOANBALL
 10574                 MOVE 'X'          TO ERROR-SWITCH
 10575                 MOVE ER-7641      TO EMI-ERROR
 10576                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10577
 10578     IF ACVBENEL GREATER THAN +0
 10579         IF AM-MAX-MON-BEN NUMERIC  AND
 10580            AM-MAX-MON-BEN GREATER THAN ZERO
 10581             IF HOLD-AH-CV-BEN GREATER THAN AM-MAX-MON-BEN
 10582                 MOVE AL-UNBON     TO ACVBENEA
 10583                 MOVE -1           TO ACVBENEL
 10584                 MOVE 'X'          TO ERROR-SWITCH
 10585                 MOVE ER-7642      TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 193
* EL131.cbl
 10586                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10587
 10588 1620-ACCT-END-BROWSE.
 10589
 10590
 10591* EXEC CICS ENDBR
 10592*         DATASET (ACCT-FILE-ID)
 10593*    END-EXEC.
 10594     MOVE 0
 10595       TO DFHEIV11
 10596*    MOVE '&2                    $   #00009831' TO DFHEIV0
 10597     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 10598     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10599     MOVE X'2020233030303039383331' TO DFHEIV0(25:11)
 10600     CALL 'kxdfhei1' USING DFHEIV0,
 10601           ACCT-FILE-ID,
 10602           DFHEIV11,
 10603           DFHEIV99
 10604     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10605
 10606
 10607     GO TO 1620-EXIT.
 10608
 10609 1620-ACCT-NOTFND.
 10610
 10611     MOVE -1                     TO MAINTL.
 10612     MOVE 'X'                    TO ERROR-SWITCH.
 10613     MOVE ER-0426                TO EMI-ERROR.
 10614     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10615
 10616 1620-EXIT.
 10617     EXIT.
 10618
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 194
* EL131.cbl
 10620 2000-UPDATE-CLAIM.
 10621
 10622     MOVE SPACES                 TO ERROR-SWITCH.
 10623     MOVE PI-COMPANY-CD          TO COMPANY-CODE.
 10624     MOVE PI-CARRIER             TO CARRIER-CODE.
 10625     MOVE PI-CLAIM-NO            TO CLAIM-NO.
 10626     MOVE PI-CERT-NO             TO CERT-NO.
 10627
 10628     IF DELETE-CLAIM
 10629         GO TO 3000-DELETE-CLAIM.
 10630
 10631     IF  NOT MODIFY-CAP
 10632         MOVE ER-0070            TO EMI-ERROR
 10633         MOVE 'X'                TO ERROR-SWITCH
 10634         MOVE -1                 TO MAINTL
 10635         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10636         GO TO 2000-EXIT.
 10637
 10638     MOVE MSTR-KEY               TO TRLR-MAIN-KEY ACTQ-KEY.
 10639     MOVE ZERO                   TO TRLR-SEQ-NO.
 10640
 10641
 10642* EXEC CICS READ UPDATE
 10643*         SET       (ADDRESS OF CLAIM-MASTER)
 10644*         DATASET   (CLMS-FILE-ID)
 10645*         RIDFLD    (MSTR-KEY)
 10646*    END-EXEC.
 10647*    MOVE '&"S        EU         (   #00009869' TO DFHEIV0
 10648     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10649     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10650     MOVE X'2020233030303039383639' TO DFHEIV0(25:11)
 10651     CALL 'kxdfhei1' USING DFHEIV0,
 10652           CLMS-FILE-ID,
 10653           DFHEIV20,
 10654           DFHEIV99,
 10655           MSTR-KEY,
 10656           DFHEIV99,
 10657           DFHEIV99,
 10658           DFHEIV99
 10659     SET ADDRESS OF CLAIM-MASTER TO
 10660         DFHEIV20
 10661     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10662
 10663
 10664     if (incl > zeros)
 10665        and (cl-no-of-pmts-made > 0)
 10666        and (hold-incur > low-values)
 10667        and (hold-incur not = cl-incurred-dt)
 10668        if hold-incur > cl-incurred-dt
 10669           move cl-incurred-dt   to dc-bin-date-1
 10670           move hold-incur       to dc-bin-date-2
 10671        else
 10672           move hold-incur       to dc-bin-date-1
 10673           move cl-incurred-dt   to dc-bin-date-2
 10674        end-if
 10675        move '1'                 to dc-option-code
 10676        PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 10677        if dc-elapsed-days > +180
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 195
* EL131.cbl
 10678           MOVE ER-1663             TO EMI-ERROR
 10679           PERFORM 9900-ERROR-FORMAT
 10680                                 THRU 9900-EXIT
 10681           MOVE -1                  TO MAINTL
 10682           GO TO 8110-SEND-DATA
 10683        end-if
 10684     end-if
 10685     IF (CL-PRIORITY-CD = '8')
 10686        AND (PI-PROCESSOR-ID NOT = 'PEMA' AND 'JMS '
 10687             AND 'AMWA' AND 'KMSB')
 10688        MOVE ER-8003             TO EMI-ERROR
 10689        PERFORM 9900-ERROR-FORMAT
 10690                                 THRU 9900-EXIT
 10691        MOVE -1                  TO MAINTL
 10692        GO TO 8110-SEND-DATA
 10693     END-IF
 10694
 10695     IF PI-UPDATE-BY NOT = CL-LAST-MAINT-USER
 10696         MOVE ER-0068            TO EMI-ERROR
 10697         PERFORM 2010-RELEASE-REC THRU 2010-EXIT
 10698         GO TO 2000-EXIT.
 10699
 10700     IF PI-UPDATE-HHMMSS NOT = CL-LAST-MAINT-HHMMSS
 10701         MOVE ER-0068            TO EMI-ERROR
 10702         PERFORM 2010-RELEASE-REC THRU 2010-EXIT
 10703         GO TO 2000-EXIT.
 10704
 10705     IF CL-CLAIM-PAYMENT-STATUS NOT NUMERIC
 10706         MOVE ZEROS              TO CL-CLAIM-PAYMENT-STATUS.
 10707
 10708     IF CL-PURGED-DT NOT = LOW-VALUES
 10709         MOVE ER-7691            TO EMI-ERROR
 10710         PERFORM 2010-RELEASE-REC THRU 2010-EXIT
 10711         GO TO 2000-EXIT.
 10712
 10713     IF CERT-KEY-CHANGED
 10714         PERFORM 2060-CHANGE-CERT THRU 2060-EXIT.
 10715
 10716     IF SCREEN-ERROR
 10717         MOVE ER-0068            TO EMI-ERROR
 10718         PERFORM 2010-RELEASE-REC THRU 2010-EXIT
 10719         GO TO 2000-EXIT.
 10720
 10721     IF NINETY-TRLR-UPDATED
 10722         PERFORM 2425-UPDATE-NINETY-TRLR THRU 2425-EXIT.
 10723
 10724     IF MSTR-KEY-CHANGED
 10725         PERFORM 2030-KEY-UPDATE THRU 2030-EXIT
 10726        ELSE
 10727         PERFORM 2020-NORMAL-UPDATE THRU 2020-EXIT.
 10728
 10729     IF TRLR-UPDATE-REQUIRED
 10730         PERFORM 2300-UPDATE-TRLR THRU 2300-EXIT.
 10731
 10732 2000-CHECK-CERT.
 10733     IF NOT CERT-UPDATES
 10734         GO TO 2000-EXIT.
 10735
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 196
* EL131.cbl
 10736     MOVE PI-COMPANY-CD          TO CERT-COMPANY-CODE.
 10737     MOVE PI-CARRIER             TO CERT-CARRIER.
 10738     MOVE PI-GROUPING            TO CERT-GROUP.
 10739     MOVE PI-STATE               TO CERT-STATE.
 10740     MOVE PI-ACCOUNT             TO CERT-ACCOUNT.
 10741     MOVE PI-CERT-EFF-DT         TO CERT-DATE.
 10742     MOVE PI-CERT-NO             TO CERT-CERT.
 10743
 10744     IF CERT-ALT-KEY-CHANGED
 10745         PERFORM 2050-KEY-UPDATE THRU 2050-EXIT
 10746     ELSE
 10747         PERFORM 2040-NORMAL-UPDATE THRU 2040-EXIT.
 10748
 10749 2000-EXIT.
 10750     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 197
* EL131.cbl
 10752 2010-RELEASE-REC.
 10753
 10754* EXEC CICS UNLOCK
 10755*         DATASET  (CLMS-FILE-ID)
 10756*    END-EXEC
 10757*    MOVE '&*                    #   #00009964' TO DFHEIV0
 10758     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 10759     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10760     MOVE X'2020233030303039393634' TO DFHEIV0(25:11)
 10761     CALL 'kxdfhei1' USING DFHEIV0,
 10762           CLMS-FILE-ID,
 10763           DFHEIV99
 10764     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10765
 10766     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10767     MOVE 'X'                    TO ERROR-SWITCH.
 10768
 10769 2010-EXIT.
 10770     EXIT.
 10771
 10772 2020-NORMAL-UPDATE.
 10773     PERFORM 2600-CREATE-MAINT-NOTE THRU 2600-EXIT.
 10774
 10775     PERFORM 2100-MOVE-MSTR THRU 2100-EXIT.
 10776
 10777     IF WS-OPEN-CLOSE-SW = 'Y'
 10778       PERFORM  7800-CHECK-AUTO-ACTIVITY THRU 7800-EXIT
 10779       IF PI-REC-FOUND-SW = 'Y'
 10780         IF CL-ACTIVITY-CODE = 09
 10781           NEXT SENTENCE
 10782         ELSE
 10783           IF WS-RESET-SW = 'Y'
 10784             IF CL-CLAIM-STATUS = 'C'
 10785               MOVE 07               TO  CL-ACTIVITY-CODE
 10786               MOVE SAVE-BIN-DATE    TO  CL-ACTIVITY-MAINT-DT
 10787               MOVE 'CLOS'           TO  CL-ACTIVITY-MAINT-TYPE
 10788             ELSE
 10789               MOVE 08               TO  CL-ACTIVITY-CODE
 10790               MOVE SAVE-BIN-DATE    TO  CL-ACTIVITY-MAINT-DT
 10791               MOVE 'OPEN'           TO  CL-ACTIVITY-MAINT-TYPE.
 10792
 10793     IF PI-COMPANY-ID = 'CID' or 'AHL'
 10794         MOVE 'Y'                TO CL-YESNOSW
 10795     END-IF.
 10796
 10797     if pi-company-id = 'DCC' OR 'VPP'
 10798        perform 1620-VERIFY-ACCT THRU 1620-EXIT
 10799        perform 2120-check-pdef  thru 2120-exit
 10800     end-if
 10801     if ((benperl <> zeros)
 10802        and (benperi numeric))
 10803                  or
 10804            (instypel <> zeros)
 10805        perform 2140-update-elcrtt thru 2140-exit
 10806     end-if
 10807
 10808* EXEC CICS HANDLE CONDITION
 10809*         DUPKEY   (2020-EXIT)
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 198
* EL131.cbl
 10810*    END-EXEC.
 10811*    MOVE '"$$                   ! , #00010009' TO DFHEIV0
 10812     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10813     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10814     MOVE X'2C20233030303130303039' TO DFHEIV0(25:11)
 10815     CALL 'kxdfhei1' USING DFHEIV0
 10816     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10817
 10818
 10819
 10820* EXEC CICS REWRITE
 10821*         DATASET   (CLMS-FILE-ID)
 10822*         FROM      (CLAIM-MASTER)
 10823*    END-EXEC.
 10824     MOVE LENGTH OF
 10825      CLAIM-MASTER
 10826       TO DFHEIV11
 10827*    MOVE '&& L                  %   #00010013' TO DFHEIV0
 10828     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10829     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10830     MOVE X'2020233030303130303133' TO DFHEIV0(25:11)
 10831     CALL 'kxdfhei1' USING DFHEIV0,
 10832           CLMS-FILE-ID,
 10833           CLAIM-MASTER,
 10834           DFHEIV11,
 10835           DFHEIV99
 10836     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10837
 10838
 10839 2020-EXIT.
 10840     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 199
* EL131.cbl
 10842 2030-KEY-UPDATE.
 10843     MOVE CLAIM-MASTER           TO JP-RECORD-AREA.
 10844
 10845
 10846* EXEC CICS DELETE
 10847*        DATASET  (CLMS-FILE-ID)
 10848*    END-EXEC.
 10849*    MOVE '&(                    &   #00010024' TO DFHEIV0
 10850     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 10851     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10852     MOVE X'2020233030303130303234' TO DFHEIV0(25:11)
 10853     CALL 'kxdfhei1' USING DFHEIV0,
 10854           CLMS-FILE-ID,
 10855           DFHEIV99,
 10856           DFHEIV99,
 10857           DFHEIV99,
 10858           DFHEIV99
 10859     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10860
 10861
 10862
 10863* EXEC CICS GETMAIN
 10864*         SET      (ADDRESS OF CLAIM-MASTER)
 10865*         LENGTH   (MSTR-LENGTH)
 10866*         INITIMG  (GETMAIN-SPACE)
 10867*    END-EXEC.
 10868*    MOVE ',"IL                  $   #00010028' TO DFHEIV0
 10869     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 10870     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10871     MOVE X'2020233030303130303238' TO DFHEIV0(25:11)
 10872     CALL 'kxdfhei1' USING DFHEIV0,
 10873           DFHEIV20,
 10874           MSTR-LENGTH,
 10875           GETMAIN-SPACE
 10876     SET ADDRESS OF CLAIM-MASTER TO
 10877         DFHEIV20
 10878     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10879
 10880
 10881     MOVE JP-RECORD-AREA         TO CLAIM-MASTER.
 10882
 10883     PERFORM 2600-CREATE-MAINT-NOTE THRU 2600-EXIT.
 10884
 10885     PERFORM 2100-MOVE-MSTR THRU 2100-EXIT.
 10886
 10887     IF WS-OPEN-CLOSE-SW = 'Y'
 10888       PERFORM 7800-CHECK-AUTO-ACTIVITY THRU 7800-EXIT
 10889         IF PI-REC-FOUND-SW = 'Y'
 10890           IF CL-ACTIVITY-CODE = 09
 10891             NEXT SENTENCE
 10892           ELSE
 10893             IF WS-RESET-SW = 'Y'
 10894               IF CL-CLAIM-STATUS = 'C'
 10895                 MOVE 07             TO  CL-ACTIVITY-CODE
 10896                 MOVE SAVE-BIN-DATE  TO  CL-ACTIVITY-MAINT-DT
 10897                 MOVE 'CLOS'         TO  CL-ACTIVITY-MAINT-TYPE
 10898               ELSE
 10899                 MOVE 08             TO  CL-ACTIVITY-CODE
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 200
* EL131.cbl
 10900                 MOVE SAVE-BIN-DATE  TO  CL-ACTIVITY-MAINT-DT
 10901                 MOVE 'OPEN'         TO  CL-ACTIVITY-MAINT-TYPE.
 10902
 10903
 10904* EXEC CICS HANDLE CONDITION
 10905*         DUPKEY    (2030-EXIT)
 10906*    END-EXEC.
 10907*    MOVE '"$$                   ! - #00010056' TO DFHEIV0
 10908     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10909     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10910     MOVE X'2D20233030303130303536' TO DFHEIV0(25:11)
 10911     CALL 'kxdfhei1' USING DFHEIV0
 10912     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10913
 10914
 10915** POPULATE THE CREDIT-CARD NO WITH THE CERT NO.
 10916*    MOVE CL-CERT-NO             TO CL-CCN-A5.
 10917
 10918     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 10919         MOVE 'Y'                TO CL-YESNOSW
 10920     END-IF.
 10921
 10922
 10923* EXEC CICS WRITE
 10924*         DATASET   (CLMS-FILE-ID)
 10925*         RIDFLD    (MSTR-KEY)
 10926*         FROM      (CLAIM-MASTER)
 10927*    END-EXEC.
 10928     MOVE LENGTH OF
 10929      CLAIM-MASTER
 10930       TO DFHEIV11
 10931*    MOVE '&$ L                  ''   #00010067' TO DFHEIV0
 10932     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10933     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10934     MOVE X'2020233030303130303637' TO DFHEIV0(25:11)
 10935     CALL 'kxdfhei1' USING DFHEIV0,
 10936           CLMS-FILE-ID,
 10937           CLAIM-MASTER,
 10938           DFHEIV11,
 10939           MSTR-KEY,
 10940           DFHEIV99,
 10941           DFHEIV99
 10942     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10943
 10944
 10945 2030-EXIT.
 10946     EXIT.
 10947
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 201
* EL131.cbl
 10949 2040-NORMAL-UPDATE.
 10950
 10951* EXEC CICS READ UPDATE
 10952*         DATASET  (CERT-FILE-ID)
 10953*         RIDFLD   (CERT-KEY)
 10954*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 10955*    END-EXEC.
 10956*    MOVE '&"S        EU         (   #00010078' TO DFHEIV0
 10957     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10958     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10959     MOVE X'2020233030303130303738' TO DFHEIV0(25:11)
 10960     CALL 'kxdfhei1' USING DFHEIV0,
 10961           CERT-FILE-ID,
 10962           DFHEIV20,
 10963           DFHEIV99,
 10964           CERT-KEY,
 10965           DFHEIV99,
 10966           DFHEIV99,
 10967           DFHEIV99
 10968     SET ADDRESS OF CERTIFICATE-MASTER TO
 10969         DFHEIV20
 10970     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10971
 10972
 10973     PERFORM 2200-MOVE-CERT THRU 2200-EXIT.
 10974
 10975
 10976* EXEC CICS HANDLE CONDITION
 10977*         DUPKEY   (2040-EXIT)
 10978*    END-EXEC.
 10979*    MOVE '"$$                   ! . #00010086' TO DFHEIV0
 10980     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10981     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10982     MOVE X'2E20233030303130303836' TO DFHEIV0(25:11)
 10983     CALL 'kxdfhei1' USING DFHEIV0
 10984     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10985
 10986
 10987
 10988* EXEC CICS REWRITE
 10989*         DATASET  (CERT-FILE-ID)
 10990*         FROM     (CERTIFICATE-MASTER)
 10991*    END-EXEC.
 10992     MOVE LENGTH OF
 10993      CERTIFICATE-MASTER
 10994       TO DFHEIV11
 10995*    MOVE '&& L                  %   #00010090' TO DFHEIV0
 10996     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10997     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10998     MOVE X'2020233030303130303930' TO DFHEIV0(25:11)
 10999     CALL 'kxdfhei1' USING DFHEIV0,
 11000           CERT-FILE-ID,
 11001           CERTIFICATE-MASTER,
 11002           DFHEIV11,
 11003           DFHEIV99
 11004     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11005
 11006
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 202
* EL131.cbl
 11007 2040-EXIT.
 11008     EXIT.
 11009
 11010 2050-KEY-UPDATE.
 11011
 11012* EXEC CICS READ UPDATE
 11013*         DATASET  (CERT-FILE-ID)
 11014*         RIDFLD   (CERT-KEY)
 11015*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 11016*    END-EXEC.
 11017*    MOVE '&"S        EU         (   #00010099' TO DFHEIV0
 11018     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11019     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11020     MOVE X'2020233030303130303939' TO DFHEIV0(25:11)
 11021     CALL 'kxdfhei1' USING DFHEIV0,
 11022           CERT-FILE-ID,
 11023           DFHEIV20,
 11024           DFHEIV99,
 11025           CERT-KEY,
 11026           DFHEIV99,
 11027           DFHEIV99,
 11028           DFHEIV99
 11029     SET ADDRESS OF CERTIFICATE-MASTER TO
 11030         DFHEIV20
 11031     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11032
 11033
 11034     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 11035
 11036
 11037* EXEC CICS DELETE
 11038*         DATASET   (CERT-FILE-ID)
 11039*    END-EXEC.
 11040*    MOVE '&(                    &   #00010107' TO DFHEIV0
 11041     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 11042     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11043     MOVE X'2020233030303130313037' TO DFHEIV0(25:11)
 11044     CALL 'kxdfhei1' USING DFHEIV0,
 11045           CERT-FILE-ID,
 11046           DFHEIV99,
 11047           DFHEIV99,
 11048           DFHEIV99,
 11049           DFHEIV99
 11050     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11051
 11052
 11053
 11054* EXEC CICS GETMAIN
 11055*         SET       (ADDRESS OF CERTIFICATE-MASTER)
 11056*         LENGTH    (CERT-LENGTH)
 11057*         INITIMG   (GETMAIN-SPACE)
 11058*    END-EXEC.
 11059*    MOVE ',"IL                  $   #00010111' TO DFHEIV0
 11060     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11061     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11062     MOVE X'2020233030303130313131' TO DFHEIV0(25:11)
 11063     CALL 'kxdfhei1' USING DFHEIV0,
 11064           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 203
* EL131.cbl
 11065           CERT-LENGTH,
 11066           GETMAIN-SPACE
 11067     SET ADDRESS OF CERTIFICATE-MASTER TO
 11068         DFHEIV20
 11069     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11070
 11071
 11072     MOVE JP-RECORD-AREA         TO CERTIFICATE-MASTER.
 11073
 11074     PERFORM 2200-MOVE-CERT THRU 2200-EXIT.
 11075
 11076
 11077* EXEC CICS HANDLE CONDITION
 11078*         DUPKEY (2050-EXIT)
 11079*    END-EXEC.
 11080*    MOVE '"$$                   ! / #00010121' TO DFHEIV0
 11081     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 11082     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11083     MOVE X'2F20233030303130313231' TO DFHEIV0(25:11)
 11084     CALL 'kxdfhei1' USING DFHEIV0
 11085     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11086
 11087
 11088
 11089* EXEC CICS WRITE
 11090*         DATASET  (CERT-FILE-ID)
 11091*         RIDFLD   (CERT-KEY)
 11092*         FROM     (CERTIFICATE-MASTER)
 11093*    END-EXEC.
 11094     MOVE LENGTH OF
 11095      CERTIFICATE-MASTER
 11096       TO DFHEIV11
 11097*    MOVE '&$ L                  ''   #00010125' TO DFHEIV0
 11098     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11099     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11100     MOVE X'2020233030303130313235' TO DFHEIV0(25:11)
 11101     CALL 'kxdfhei1' USING DFHEIV0,
 11102           CERT-FILE-ID,
 11103           CERTIFICATE-MASTER,
 11104           DFHEIV11,
 11105           CERT-KEY,
 11106           DFHEIV99,
 11107           DFHEIV99
 11108     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11109
 11110
 11111 2050-EXIT.
 11112     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 204
* EL131.cbl
 11114 2060-CHANGE-CERT.
 11115     MOVE PI-COMPANY-CD          TO CERT-COMPANY-CODE.
 11116     MOVE PI-CARRIER             TO CERT-CARRIER.
 11117     MOVE PI-GROUPING            TO CERT-GROUP.
 11118     MOVE PI-STATE               TO CERT-STATE.
 11119     MOVE PI-ACCOUNT             TO CERT-ACCOUNT.
 11120     MOVE PI-CERT-EFF-DT         TO CERT-DATE.
 11121     MOVE PI-CERT-NO             TO CERT-CERT.
 11122     IF CERTEFFI GREATER THAN LOW-VALUES
 11123         MOVE HOLD-EFF           TO CERT-DATE.
 11124     IF CERTACTI GREATER THAN LOW-VALUES
 11125         MOVE CERTACTI           TO CERT-ACCOUNT.
 11126     IF CERTSTI GREATER THAN LOW-VALUES
 11127         MOVE CERTSTI            TO CERT-STATE.
 11128     IF CERTCARI GREATER THAN LOW-VALUES
 11129         MOVE CERTCARI           TO CERT-CARRIER.
 11130     IF CERTGRPI GREATER THAN LOW-VALUES
 11131         MOVE CERTGRPI           TO CERT-GROUP.
 11132     IF CERTI GREATER THAN LOW-VALUES
 11133         MOVE CERTI              TO CERT-CERT-PRIME.
 11134     IF SUFXI GREATER THAN LOW-VALUES
 11135         MOVE SUFXI              TO CERT-CERT-SUFX.
 11136
 11137
 11138* EXEC CICS HANDLE CONDITION
 11139*         NOTFND   (2060-CERT-NOTFND)
 11140*    END-EXEC.
 11141*    MOVE '"$I                   ! 0 #00010157' TO DFHEIV0
 11142     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11143     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11144     MOVE X'3020233030303130313537' TO DFHEIV0(25:11)
 11145     CALL 'kxdfhei1' USING DFHEIV0
 11146     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11147
 11148
 11149
 11150* EXEC CICS READ UPDATE
 11151*         DATASET  (CERT-FILE-ID)
 11152*         RIDFLD   (CERT-KEY)
 11153*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 11154*    END-EXEC.
 11155*    MOVE '&"S        EU         (   #00010161' TO DFHEIV0
 11156     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11157     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11158     MOVE X'2020233030303130313631' TO DFHEIV0(25:11)
 11159     CALL 'kxdfhei1' USING DFHEIV0,
 11160           CERT-FILE-ID,
 11161           DFHEIV20,
 11162           DFHEIV99,
 11163           CERT-KEY,
 11164           DFHEIV99,
 11165           DFHEIV99,
 11166           DFHEIV99
 11167     SET ADDRESS OF CERTIFICATE-MASTER TO
 11168         DFHEIV20
 11169     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11170
 11171
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 205
* EL131.cbl
 11172     ADD 1                       TO CM-CLAIM-ATTACHED-COUNT.
 11173
 11174     IF CM-CLAIM-INTERFACE-SW = SPACES
 11175        MOVE '1'   TO CM-CLAIM-INTERFACE-SW PI-CERT-SWITCH.
 11176
 11177
 11178* EXEC CICS HANDLE CONDITION
 11179*         DUPKEY   (2060-DUPKEY)
 11180*    END-EXEC.
 11181*    MOVE '"$$                   ! 1 #00010172' TO DFHEIV0
 11182     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 11183     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11184     MOVE X'3120233030303130313732' TO DFHEIV0(25:11)
 11185     CALL 'kxdfhei1' USING DFHEIV0
 11186     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11187
 11188
 11189
 11190* EXEC CICS REWRITE
 11191*         DATASET  (CERT-FILE-ID)
 11192*         FROM     (CERTIFICATE-MASTER)
 11193*    END-EXEC.
 11194     MOVE LENGTH OF
 11195      CERTIFICATE-MASTER
 11196       TO DFHEIV11
 11197*    MOVE '&& L                  %   #00010176' TO DFHEIV0
 11198     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11199     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11200     MOVE X'2020233030303130313736' TO DFHEIV0(25:11)
 11201     CALL 'kxdfhei1' USING DFHEIV0,
 11202           CERT-FILE-ID,
 11203           CERTIFICATE-MASTER,
 11204           DFHEIV11,
 11205           DFHEIV99
 11206     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11207
 11208
 11209 2060-DUPKEY.
 11210
 11211     PERFORM 2070-CHECK-OLD THRU 2070-EXIT.
 11212
 11213 2060-CHANGE-TRLR-ACTQ.
 11214     IF SCREEN-ERROR
 11215         GO TO 2060-EXIT.
 11216
 11217     IF CERTI    GREATER LOW-VALUES OR
 11218        SUFXI    GREATER LOW-VALUES OR
 11219        CERTCARI GREATER LOW-VALUES
 11220         PERFORM 2400-UPDATE-TRLR THRU 2400-EXIT
 11221         PERFORM 2430-UPDATE-ACTQ THRU 2430-EXIT.
 11222
 11223     MOVE SPACES                 TO CERT-KEY-SWITCH
 11224                                    CERT-SWITCH
 11225                                    TRLR-SWITCH
 11226                                    NINETY-TRLR-SWITCH.
 11227     MOVE 'X' TO MSTR-KEY-SWITCH MSTR-SWITCH.
 11228     GO TO 2060-EXIT.
 11229
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 206
* EL131.cbl
 11230 2060-CERT-NOTFND.
 11231     PERFORM 2070-CHECK-OLD THRU 2070-EXIT.
 11232
 11233     IF WS-REC-FOUND-SW = 'N'
 11234         MOVE ER-0206            TO  EMI-ERROR
 11235         MOVE -1                 TO  MAINTL
 11236         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11237
 11238* EXEC CICS UNLOCK
 11239*            DATASET   (CLMS-FILE-ID)
 11240*        END-EXEC
 11241*    MOVE '&*                    #   #00010209' TO DFHEIV0
 11242     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 11243     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 11244     MOVE X'2020233030303130323039' TO DFHEIV0(25:11)
 11245     CALL 'kxdfhei1' USING DFHEIV0,
 11246           CLMS-FILE-ID,
 11247           DFHEIV99
 11248     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11249         GO TO 8110-SEND-DATA.
 11250
 11251     PERFORM 2080-CREATE-CERT THRU 2080-EXIT.
 11252
 11253     GO TO 2060-CHANGE-TRLR-ACTQ.
 11254
 11255 2060-EXIT.
 11256     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 207
* EL131.cbl
 11258 2070-CHECK-OLD.
 11259
 11260
 11261* EXEC CICS HANDLE CONDITION
 11262*        NOTFND   (2070-NOT-FOUND)
 11263*    END-EXEC.
 11264*    MOVE '"$I                   ! 2 #00010223' TO DFHEIV0
 11265     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11266     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11267     MOVE X'3220233030303130323233' TO DFHEIV0(25:11)
 11268     CALL 'kxdfhei1' USING DFHEIV0
 11269     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11270
 11271
 11272     MOVE PI-COMPANY-CD          TO CERT-COMPANY-CODE.
 11273     MOVE PI-CARRIER             TO CERT-CARRIER.
 11274     MOVE PI-GROUPING            TO CERT-GROUP.
 11275     MOVE PI-STATE               TO CERT-STATE.
 11276     MOVE PI-ACCOUNT             TO CERT-ACCOUNT.
 11277     MOVE PI-CERT-EFF-DT         TO CERT-DATE.
 11278     MOVE PI-CERT-NO             TO CERT-CERT.
 11279
 11280
 11281* EXEC CICS READ UPDATE
 11282*         DATASET  (CERT-FILE-ID)
 11283*         RIDFLD   (CERT-KEY)
 11284*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 11285*    END-EXEC.
 11286*    MOVE '&"S        EU         (   #00010235' TO DFHEIV0
 11287     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11288     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11289     MOVE X'2020233030303130323335' TO DFHEIV0(25:11)
 11290     CALL 'kxdfhei1' USING DFHEIV0,
 11291           CERT-FILE-ID,
 11292           DFHEIV20,
 11293           DFHEIV99,
 11294           CERT-KEY,
 11295           DFHEIV99,
 11296           DFHEIV99,
 11297           DFHEIV99
 11298     SET ADDRESS OF CERTIFICATE-MASTER TO
 11299         DFHEIV20
 11300     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11301
 11302
 11303     MOVE 'Y'                    TO WS-REC-FOUND-SW.
 11304     MOVE CERTIFICATE-MASTER     TO SAVE-RECORD.
 11305     SUBTRACT 1                  FROM CM-CLAIM-ATTACHED-COUNT.
 11306
 11307     IF CM-CLAIM-ATTACHED-COUNT LESS THAN ZERO
 11308         MOVE ZERO               TO CM-CLAIM-ATTACHED-COUNT.
 11309
 11310     IF CM-CLAIM-ATTACHED-COUNT = ZERO
 11311       AND
 11312        CERT-WAS-CREATED-FOR-CLAIM
 11313         MOVE CERTIFICATE-MASTER TO JP-RECORD-AREA
 11314
 11315* EXEC CICS DELETE
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 208
* EL131.cbl
 11316*             DATASET   (CERT-FILE-ID)
 11317*        END-EXEC
 11318*    MOVE '&(                    &   #00010252' TO DFHEIV0
 11319     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 11320     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11321     MOVE X'2020233030303130323532' TO DFHEIV0(25:11)
 11322     CALL 'kxdfhei1' USING DFHEIV0,
 11323           CERT-FILE-ID,
 11324           DFHEIV99,
 11325           DFHEIV99,
 11326           DFHEIV99,
 11327           DFHEIV99
 11328     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11329         GO TO 2070-EXIT.
 11330
 11331     IF CM-CLAIM-ATTACHED-COUNT = ZERO
 11332         MOVE SPACE TO CM-CLAIM-INTERFACE-SW PI-CERT-SWITCH.
 11333
 11334
 11335* EXEC CICS HANDLE CONDITION
 11336*         DUPKEY   (2070-EXIT)
 11337*    END-EXEC.
 11338*    MOVE '"$$                   ! 3 #00010260' TO DFHEIV0
 11339     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 11340     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11341     MOVE X'3320233030303130323630' TO DFHEIV0(25:11)
 11342     CALL 'kxdfhei1' USING DFHEIV0
 11343     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11344
 11345
 11346
 11347* EXEC CICS REWRITE
 11348*         DATASET  (CERT-FILE-ID)
 11349*         FROM     (CERTIFICATE-MASTER)
 11350*    END-EXEC.
 11351     MOVE LENGTH OF
 11352      CERTIFICATE-MASTER
 11353       TO DFHEIV11
 11354*    MOVE '&& L                  %   #00010264' TO DFHEIV0
 11355     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11356     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11357     MOVE X'2020233030303130323634' TO DFHEIV0(25:11)
 11358     CALL 'kxdfhei1' USING DFHEIV0,
 11359           CERT-FILE-ID,
 11360           CERTIFICATE-MASTER,
 11361           DFHEIV11,
 11362           DFHEIV99
 11363     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11364
 11365
 11366     GO TO 2070-EXIT.
 11367
 11368 2070-NOT-FOUND.
 11369     MOVE 'N'                        TO  WS-REC-FOUND-SW.
 11370
 11371 2070-EXIT.
 11372     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 209
* EL131.cbl
 11374 2080-CREATE-CERT.
 11375
 11376* EXEC CICS GETMAIN
 11377*         SET       (ADDRESS OF CERTIFICATE-MASTER)
 11378*         LENGTH    (CERT-LENGTH)
 11379*         INITIMG   (GETMAIN-SPACE)
 11380*    END-EXEC.
 11381*    MOVE ',"IL                  $   #00010278' TO DFHEIV0
 11382     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11383     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11384     MOVE X'2020233030303130323738' TO DFHEIV0(25:11)
 11385     CALL 'kxdfhei1' USING DFHEIV0,
 11386           DFHEIV20,
 11387           CERT-LENGTH,
 11388           GETMAIN-SPACE
 11389     SET ADDRESS OF CERTIFICATE-MASTER TO
 11390         DFHEIV20
 11391     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11392
 11393
 11394     MOVE SAVE-RECORD            TO CERTIFICATE-MASTER.
 11395
 11396     IF CERTEFFI GREATER THAN LOW-VALUES
 11397         MOVE HOLD-EFF           TO CERT-DATE CM-CERT-EFF-DT
 11398                                    DC-BIN-DATE-1
 11399         MOVE '6'                TO DC-OPTION-CODE
 11400         MOVE +1                 TO DC-ELAPSED-MONTHS
 11401         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 11402         IF NO-CONVERSION-ERROR
 11403             MOVE DC-BIN-DATE-2  TO CM-LOAN-1ST-PMT-DT.
 11404
 11405     IF CERTACTI GREATER THAN LOW-VALUES
 11406         MOVE CERTACTI           TO CERT-ACCOUNT CM-ACCOUNT.
 11407     IF CERTSTI GREATER THAN LOW-VALUES
 11408         MOVE CERTSTI            TO CERT-STATE CM-STATE.
 11409     IF CERTCARI GREATER THAN LOW-VALUES
 11410         MOVE CERTCARI           TO CERT-CARRIER CM-CARRIER.
 11411     IF CERTGRPI GREATER THAN LOW-VALUES
 11412         MOVE CERTGRPI           TO CERT-GROUP CM-GROUPING.
 11413     IF CERTI GREATER THAN LOW-VALUES
 11414         MOVE CERTI              TO CERT-CERT-PRIME
 11415                                    CM-CERT-PRIME
 11416         MOVE CM-CERT-NO         TO CM-CERT-NO-A4.
 11417
 11418     IF SUFXI GREATER THAN LOW-VALUES
 11419         MOVE SUFXI              TO CERT-CERT-SUFX
 11420                                    CM-CERT-SFX
 11421         MOVE CM-CERT-NO         TO CM-CERT-NO-A4.
 11422
 11423     PERFORM 2200-MOVE-CERT THRU 2200-EXIT.
 11424
 11425     MOVE LOW-VALUES             TO CM-LAST-MONTH-END.
 11426
 11427     MOVE SPACES                 TO CM-ENTRY-BATCH
 11428                                    CM-LF-EXIT-BATCH
 11429                                    CM-AH-EXIT-BATCH
 11430                                    CM-CREDIT-INTERFACE-SW-1
 11431                                    CM-CREDIT-INTERFACE-SW-2.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 210
* EL131.cbl
 11432
 11433     IF CM-LF-CURRENT-STATUS = '2' OR '3' OR '4' OR '5' OR
 11434                               '9' OR 'D' OR 'V'
 11435         MOVE '1'                TO CM-LF-CURRENT-STATUS.
 11436
 11437     IF CM-AH-CURRENT-STATUS = '2' OR '3' OR '4' OR '5' OR
 11438                               '9' OR 'D' OR 'V'
 11439         MOVE '1'                TO CM-AH-CURRENT-STATUS.
 11440
 11441     MOVE '2'                    TO CM-CLAIM-INTERFACE-SW
 11442                                    CL-CERT-ORIGIN PI-CERT-SWITCH.
 11443     MOVE 1                      TO CM-CLAIM-ATTACHED-COUNT.
 11444
 11445
 11446* EXEC CICS HANDLE CONDITION
 11447*         DUPKEY (2080-EXIT)
 11448*    END-EXEC.
 11449*    MOVE '"$$                   ! 4 #00010335' TO DFHEIV0
 11450     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 11451     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11452     MOVE X'3420233030303130333335' TO DFHEIV0(25:11)
 11453     CALL 'kxdfhei1' USING DFHEIV0
 11454     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11455
 11456
 11457
 11458* EXEC CICS WRITE
 11459*         DATASET  (CERT-FILE-ID)
 11460*         RIDFLD   (CERT-KEY)
 11461*         FROM     (CERTIFICATE-MASTER)
 11462*    END-EXEC.
 11463     MOVE LENGTH OF
 11464      CERTIFICATE-MASTER
 11465       TO DFHEIV11
 11466*    MOVE '&$ L                  ''   #00010339' TO DFHEIV0
 11467     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11468     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11469     MOVE X'2020233030303130333339' TO DFHEIV0(25:11)
 11470     CALL 'kxdfhei1' USING DFHEIV0,
 11471           CERT-FILE-ID,
 11472           CERTIFICATE-MASTER,
 11473           DFHEIV11,
 11474           CERT-KEY,
 11475           DFHEIV99,
 11476           DFHEIV99
 11477     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11478
 11479
 11480 2080-EXIT.
 11481     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 211
* EL131.cbl
 11483 2100-MOVE-MSTR.
 11484     IF TYPEI GREATER THAN LOW-VALUES
 11485         MOVE TYPEI              TO CL-CLAIM-TYPE.
 11486
 11487     IF STATUSI = LOW-VALUES
 11488         GO TO 2100-NO-STATUS-CHANGE.
 11489
 11490     IF STATUSI = 'OPEN' OR 'O'
 11491         IF CL-CLAIM-STATUS = 'O'
 11492             MOVE SPACES         TO TRLR-SWITCH
 11493                 GO TO 2100-NO-STATUS-CHANGE.
 11494
 11495     IF STATUSI = 'CLOSED' OR 'C'
 11496         IF CL-CLAIM-STATUS = 'C'
 11497             MOVE SPACES         TO TRLR-SWITCH
 11498                 GO TO 2100-NO-STATUS-CHANGE.
 11499
 11500     IF PI-COMPANY-ID = 'DMD'
 11501        IF STATUSI = 'OPEN' OR 'O'
 11502           IF CL-LAST-CLOSE-REASON = 'C' OR 'E'
 11503              MOVE ZERO       TO STATUSL
 11504              MOVE LOW-VALUES TO STATUSI
 11505              GO TO 2100-NO-STATUS-CHANGE.
 11506
 11507     IF PI-COMPANY-ID = 'DMD'
 11508         PERFORM 8000-CREATE-DMO-REC THRU 8000-EXIT.
 11509
 11510     MOVE STATUSI                TO CL-CLAIM-STATUS.
 11511
 11512 2100-NO-STATUS-CHANGE.
 11513
 11514     IF CCNOI GREATER THAN LOW-VALUES
 11515         MOVE CCNOI              TO CL-CCN.
 11516
 11517     IF PROCI GREATER THAN LOW-VALUES
 11518         MOVE PROCI              TO CL-PROCESSOR-ID.
 11519
 11520     if (accswi > low-values)
 11521        and (accswi = 'Y' OR 'N')
 11522        move accswi              to cl-accident-claim-sw
 11523     end-if
 11524     if benperi > low-values
 11525        and benperi numeric
 11526        move benperi             to cl-benefit-period
 11527     end-if
 11528     if instypei > low-values
 11529        move instypei            to cl-insured-type
 11530     end-if
 11531     IF SEXI GREATER THAN LOW-VALUES
 11532         MOVE SEXI               TO CL-INSURED-SEX-CD.
 11533
 11534     IF BIRTHI GREATER THAN LOW-VALUES
 11535         MOVE HOLD-BIRTH         TO CL-INSURED-BIRTH-DT.
 11536
 11537     IF SOCIALI GREATER THAN LOW-VALUES
 11538       AND
 11539        SOCIALI = SPACES
 11540         MOVE CL-CERT-STATE      TO CL-SSN-STATE
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 212
* EL131.cbl
 11541         MOVE CL-CERT-ACCOUNT-PRIME   TO CL-SSN-ACCOUNT
 11542         MOVE CL-INSURED-LAST-NAME   TO CL-SSN-LN3
 11543     ELSE
 11544         IF SOCIALI GREATER THAN LOW-VALUES
 11545             MOVE SOCIALI        TO CL-SOC-SEC-NO.
 11546
 11547     IF OCCI GREATER THAN LOW-VALUES
 11548         MOVE OCCI               TO CL-INSURED-OCC-CD.
 11549
 11550     IF BENEL GREATER THAN ZERO
 11551         MOVE BENEI              TO CL-BENEFICIARY.
 11552
 11553     IF DIAGI GREATER THAN LOW-VALUES
 11554         MOVE DIAGI              TO WS-DIAGNOSIS.
 11555
 11556     IF ICD1I GREATER THAN LOW-VALUES
 11557         MOVE ICD1I              TO WS-ICD-CODE-1
 11558     END-IF.
 11559
 11560     IF ICD2I GREATER THAN LOW-VALUES
 11561         MOVE ICD2I              TO WS-ICD-CODE-2
 11562     END-IF.
 11563
 11564     IF PREMTYPI GREATER THAN LOW-VALUES
 11565         MOVE PREMTYPI           TO CL-CLAIM-PREM-TYPE.
 11566
 11567*    IF CAUSEI GREATER THAN LOW-VALUES
 11568*        MOVE CAUSEI             TO CL-CAUSE-CD.
 11569
 11570*    IF ENDI GREATER THAN LOW-VALUES
 11571*        MOVE HOLD-END           TO CL-EST-END-OF-DISAB-DT.
 11572
 11573     IF PDTHRUI GREATER THAN LOW-VALUES
 11574        MOVE HOLD-PDTHRU         TO CL-PAID-THRU-DT.
 11575
 11576     IF PDAMTL GREATER THAN +0
 11577        MOVE HOLD-PDAMT          TO CL-TOTAL-PAID-AMT.
 11578
 11579     IF NODAYSI GREATER THAN LOW-VALUES
 11580        MOVE HOLD-NODAYS         TO CL-NO-OF-DAYS-PAID.
 11581
 11582     IF NOPMTSI GREATER THAN LOW-VALUES
 11583        MOVE HOLD-NOPMTS         TO CL-NO-OF-PMTS-MADE.
 11584
 11585     IF FORMTYPI GREATER THAN LOW-VALUES
 11586        MOVE FORMTYPI            TO CL-PROG-FORM-TYPE.
 11587
 11588     IF INCI GREATER THAN LOW-VALUES
 11589        MOVE HOLD-INCUR          TO CL-INCURRED-DT.
 11590
 11591     IF REPI GREATER THAN LOW-VALUES
 11592        MOVE HOLD-REPORTED       TO CL-REPORTED-DT.
 11593
 11594     IF ADDONDTI GREATER THAN LOW-VALUES
 11595        MOVE HOLD-ADDON          TO CL-LAST-ADD-ON-DT.
 11596
 11597     IF PRICDI GREATER THAN LOW-VALUES
 11598         MOVE PRICDI             TO CL-PRIORITY-CD.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 213
* EL131.cbl
 11599
 11600     IF CRITPL  > ZEROS
 11601        MOVE CRITPI              TO CL-CRITICAL-PERIOD
 11602     END-IF
 11603
 11604     IF EXTENSL  > ZEROS
 11605        MOVE EXTENSI             TO CL-NO-OF-EXTENSIONS
 11606     END-IF
 11607*    IF CRITPTL > ZEROS
 11608*       MOVE CRITPTI             TO CL-CRIT-PER-RECURRENT
 11609*    END-IF
 11610
 11611*    IF RTWMOSL > ZEROS
 11612*       MOVE RTWMOSI             TO CL-CRIT-PER-RTW-MOS
 11613*    END-IF
 11614     IF FILETOI GREATER THAN LOW-VALUES
 11615         MOVE FILETOI            TO CL-FILE-LOCATION.
 11616
 11617     IF SUPVI GREATER THAN LOW-VALUES
 11618         MOVE SUPVI              TO CL-SUPV-ATTN-CD.
 11619
 11620     IF MLNAMEI GREATER THAN LOW-VALUES
 11621         MOVE MLNAMEI            TO CL-INSURED-LAST-NAME.
 11622
 11623     IF MFNAMEI GREATER THAN LOW-VALUES
 11624         MOVE MFNAMEI            TO CL-INSURED-1ST-NAME.
 11625
 11626     IF MMINITI GREATER THAN LOW-VALUES
 11627         MOVE MMINITI            TO CL-INSURED-MID-INIT.
 11628
 11629     IF CERTEFFI GREATER THAN LOW-VALUES
 11630         MOVE HOLD-EFF           TO CL-CERT-EFF-DT.
 11631
 11632     IF CERTACTI GREATER THAN LOW-VALUES
 11633         MOVE CERTACTI           TO CL-CERT-ACCOUNT.
 11634
 11635     IF CERTSTI GREATER THAN LOW-VALUES
 11636         MOVE CERTSTI            TO CL-CERT-STATE.
 11637
 11638     IF CERTCARI GREATER THAN LOW-VALUES
 11639         MOVE CERTCARI           TO CL-CERT-CARRIER CARRIER-CODE
 11640                                    CL-CARRIER.
 11641
 11642     IF CERTGRPI GREATER THAN LOW-VALUES
 11643         MOVE CERTGRPI           TO CL-CERT-GROUPING.
 11644
 11645     IF CERTI GREATER THAN LOW-VALUES
 11646         MOVE CERTI              TO CERT-NO-PRIME.
 11647
 11648     IF SUFXI GREATER THAN LOW-VALUES
 11649         MOVE SUFXI              TO CERT-NO-SUFX.
 11650
 11651     MOVE CERT-NO                TO CL-CERT-NO
 11652                                    CL-CERT-NO-A4.
 11653
 11654     IF PI-COMPANY-ID = 'FLA'
 11655          NEXT SENTENCE
 11656     ELSE
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 214
* EL131.cbl
 11657         MOVE SAVE-BIN-DATE      TO CL-LAST-MAINT-DT
 11658         MOVE PI-PROCESSOR-ID    TO CL-LAST-MAINT-USER
 11659         MOVE EIBTIME            TO CL-LAST-MAINT-HHMMSS
 11660         MOVE '3'                TO CL-LAST-MAINT-TYPE.
 11661
 11662     IF TRLR-UPDATE-REQUIRED
 11663        MOVE CL-CONTROL-PRIMARY TO TRLR-KEY
 11664        MOVE ZEROS              TO TRLR-SEQ-NO
 11665
 11666* EXEC CICS READ
 11667*            DATASET   (TRLR-FILE-ID)
 11668*            RIDFLD    (TRLR-KEY)
 11669*            SET       (ADDRESS OF ACTIVITY-TRAILERS)
 11670*       END-EXEC
 11671*    MOVE '&"S        E          (   #00010530' TO DFHEIV0
 11672     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11673     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11674     MOVE X'2020233030303130353330' TO DFHEIV0(25:11)
 11675     CALL 'kxdfhei1' USING DFHEIV0,
 11676           TRLR-FILE-ID,
 11677           DFHEIV20,
 11678           DFHEIV99,
 11679           TRLR-KEY,
 11680           DFHEIV99,
 11681           DFHEIV99,
 11682           DFHEIV99
 11683     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11684         DFHEIV20
 11685     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11686        IF AT-TRAILER-TYPE = '1'
 11687           MOVE +1 TO MISC-SUB
 11688           PERFORM 2100-BUMP-OPEN-CLOSE-HIST UNTIL
 11689           MISC-SUB GREATER THAN +6 OR
 11690           AT-OPEN-CLOSE-TYPE (MISC-SUB) = SPACES
 11691           IF MISC-SUB GREATER THAN +1
 11692              SUBTRACT +1 FROM MISC-SUB
 11693              IF AT-OPEN-CLOSE-TYPE (MISC-SUB) = STATUSI
 11694                 GO TO 2100-BYPASS-LAST-UPDATE.
 11695
 11696     IF TRLR-UPDATE-REQUIRED AND
 11697        CLAIM-IS-OPEN
 11698         MOVE SAVE-BIN-DATE      TO CL-LAST-REOPEN-DT
 11699     ELSE
 11700         IF TRLR-UPDATE-REQUIRED AND
 11701            CLAIM-IS-CLOSED
 11702             MOVE SAVE-BIN-DATE  TO CL-LAST-CLOSE-DT
 11703             MOVE '4'            TO CL-LAST-CLOSE-REASON.
 11704
 11705 2100-BYPASS-LAST-UPDATE.
 11706     MOVE EMI-FORCABLE-CTR       TO CL-FORCEABLE-ERROR-CNT.
 11707     MOVE EMI-FATAL-CTR          TO CL-FATAL-ERROR-CNT.
 11708
 11709     GO TO 2100-EXIT.
 11710
 11711 2100-BUMP-OPEN-CLOSE-HIST.
 11712     ADD +1                      TO MISC-SUB.
 11713
 11714 2100-EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 215
* EL131.cbl
 11715     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 216
* EL131.cbl
 11717 2120-check-pdef.
 11718     move +0                     to s1
 11719     MOVE ZEROS                  TO WS-MONTHS-BETWEEN
 11720     move spaces                 to ws-dcc-error-line
 11721     PERFORM 3997-GET-ERPDEF  THRU 3997-EXIT
 11722     IF ERPDEF-FOUND
 11723        perform 2130-check-trlr  thru 2130-exit
 11724        move +1                  to s1
 11725*       if cl-accident-claim-sw = ' '
 11726*          move er-1655             to ws-error-no (s1)
 11727*          add +1 to s1
 11728*       end-if
 11729        MOVE CL-CERT-EFF-DT      TO DC-BIN-DATE-1
 11730        MOVE cl-incurred-dt      TO DC-BIN-DATE-2
 11731        if (hold-incur > low-values)
 11732           and (incl > zeros)
 11733           and (hold-incur not = cl-incurred-dt)
 11734           move hold-incur       to dc-bin-date-2
 11735        end-if
 11736        MOVE '1'                 TO DC-OPTION-CODE
 11737        MOVE +0                  TO DC-ELAPSED-MONTHS
 11738                                    DC-ELAPSED-DAYS
 11739        PERFORM 9800-CONVERT-DATE
 11740                                 THRU 9800-EXIT
 11741        IF NO-CONVERSION-ERROR
 11742           MOVE DC-ELAPSED-MONTHS
 11743                                 TO WS-MONTHS-BETWEEN
 11744           IF DC-ELAPSED-DAYS > 1
 11745              ADD 1 TO WS-MONTHS-BETWEEN
 11746           END-IF
 11747        ELSE
 11748           display ' dte conv error ' dc-error-code
 11749           MOVE ZEROS            TO WS-MONTHS-BETWEEN
 11750        END-IF
 11751        IF (WS-EXCL-PERIOD = ZEROS)
 11752           OR (WS-MONTHS-BETWEEN = ZEROS)
 11753           CONTINUE
 11754        ELSE
 11755           IF WS-MONTHS-BETWEEN  <= WS-EXCL-PERIOD
 11756              MOVE ER-1651       TO ws-error-no (s1)
 11757              add +1             to s1
 11758           END-IF
 11759        END-IF
 11760        IF (WS-COV-ENDS = ZEROS)
 11761           OR (WS-MONTHS-BETWEEN = ZEROS)
 11762           CONTINUE
 11763        ELSE
 11764           IF WS-MONTHS-BETWEEN > WS-COV-ENDS
 11765              MOVE -1            TO MAINTL
 11766              MOVE ER-1653       TO ws-error-no (s1)
 11767              add +1 to s1
 11768           END-IF
 11769        END-IF
 11770        IF (WS-ACC-PERIOD = ZEROS)
 11771           OR (WS-MONTHS-BETWEEN = ZEROS)
 11772           CONTINUE
 11773        ELSE
 11774           IF (WS-MONTHS-BETWEEN <= WS-ACC-PERIOD)
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 217
* EL131.cbl
 11775              and (accswi = spaces or low-values)
 11776*             and (cl-accident-claim-sw = ' ')
 11777              move er-1655       to ws-error-no (s1)
 11778              add +1             to s1
 11779           end-if
 11780           IF WS-MONTHS-BETWEEN <= WS-ACC-PERIOD
 11781*             if (cl-accident-claim-sw not = 'Y')
 11782              if (accswi not = 'Y')
 11783                 MOVE ER-1652    TO ws-error-no (s1)
 11784              else
 11785                 move er-1662    to ws-error-no (s1)
 11786              end-if
 11787              MOVE -1            TO MAINTL
 11788              add +1             to s1
 11789           END-IF
 11790        END-IF
 11791        if cl-claim-type  = 'I'
 11792           move er-1661          to ws-error-no (s1)
 11793           add +1                to s1
 11794        end-if
 11795        perform 2130-check-trlr  thru 2130-exit
 11796     END-IF
 11797
 11798     .
 11799 2120-exit.
 11800     exit.
 11801
 11802 2130-check-trlr.
 11803
 11804     evaluate true
 11805        when s1 = +0
 11806           move cl-control-primary
 11807                                 to trlr-key
 11808           MOVE +95              TO TRLR-SEQ-NO
 11809
 11810* EXEC CICS READ
 11811*             update
 11812*             DATASET  ('ELTRLR')
 11813*             SET      (ADDRESS OF ACTIVITY-TRAILERS)
 11814*             RIDFLD   (TRLR-KEY)
 11815*             RESP     (WS-RESPONSE)
 11816*          END-EXEC
 11817     MOVE 'ELTRLR' TO DFHEIV1
 11818*    MOVE '&"S        EU         (  N#00010658' TO DFHEIV0
 11819     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11820     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11821     MOVE X'204E233030303130363538' TO DFHEIV0(25:11)
 11822     CALL 'kxdfhei1' USING DFHEIV0,
 11823           DFHEIV1,
 11824           DFHEIV20,
 11825           DFHEIV99,
 11826           TRLR-KEY,
 11827           DFHEIV99,
 11828           DFHEIV99,
 11829           DFHEIV99
 11830     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11831         DFHEIV20
 11832     MOVE EIBRESP  TO WS-RESPONSE
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 218
* EL131.cbl
 11833     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11834           if ws-resp-normal
 11835              move spaces        to at-info-line-1
 11836           end-if
 11837        when s1 = +1
 11838           if ws-resp-normal
 11839
 11840* exec cics rewrite
 11841*                dataset   ('ELTRLR')
 11842*                from      (activity-trailers)
 11843*             end-exec
 11844     MOVE LENGTH OF
 11845      activity-trailers
 11846       TO DFHEIV11
 11847     MOVE 'ELTRLR' TO DFHEIV1
 11848*    MOVE '&& L                  %   #00010670' TO DFHEIV0
 11849     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11850     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11851     MOVE X'2020233030303130363730' TO DFHEIV0(25:11)
 11852     CALL 'kxdfhei1' USING DFHEIV0,
 11853           DFHEIV1,
 11854           activity-trailers,
 11855           DFHEIV11,
 11856           DFHEIV99
 11857     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11858           end-if
 11859        when s1 > +1
 11860           if ws-resp-normal
 11861              move ws-dcc-error-line
 11862                                 to at-info-line-1
 11863
 11864* exec cics rewrite
 11865*                dataset   ('ELTRLR')
 11866*                from      (activity-trailers)
 11867*             end-exec
 11868     MOVE LENGTH OF
 11869      activity-trailers
 11870       TO DFHEIV11
 11871     MOVE 'ELTRLR' TO DFHEIV1
 11872*    MOVE '&& L                  %   #00010679' TO DFHEIV0
 11873     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11874     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11875     MOVE X'2020233030303130363739' TO DFHEIV0(25:11)
 11876     CALL 'kxdfhei1' USING DFHEIV0,
 11877           DFHEIV1,
 11878           activity-trailers,
 11879           DFHEIV11,
 11880           DFHEIV99
 11881     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11882           else
 11883
 11884* EXEC CICS GETMAIN
 11885*                SET      (ADDRESS OF ACTIVITY-TRAILERS)
 11886*                LENGTH   (TRLR-LENGTH)
 11887*                INITIMG  (GETMAIN-SPACE)
 11888*             END-EXEC
 11889*    MOVE ',"IL                  $   #00010684' TO DFHEIV0
 11890     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 219
* EL131.cbl
 11891     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11892     MOVE X'2020233030303130363834' TO DFHEIV0(25:11)
 11893     CALL 'kxdfhei1' USING DFHEIV0,
 11894           DFHEIV20,
 11895           TRLR-LENGTH,
 11896           GETMAIN-SPACE
 11897     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11898         DFHEIV20
 11899     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11900              move 'AT'          to at-record-id
 11901              move cl-control-primary
 11902                                 to at-control-primary
 11903              move +95           to at-sequence-no
 11904              move '6'           to at-trailer-type
 11905              move ws-dcc-error-line
 11906                                 to at-info-line-1
 11907              move 'E'           to at-info-trailer-type
 11908              move save-bin-date to at-recorded-dt
 11909                                    at-gen-info-last-maint-dt
 11910              move pi-processor-id
 11911                                 to at-recorded-by
 11912                                    at-gen-info-last-updated-by
 11913              move eibtime       to at-last-maint-hhmmss
 11914
 11915* exec cics write
 11916*                dataset   ('ELTRLR')
 11917*                from      (activity-trailers)
 11918*                ridfld    (trlr-key)
 11919*             end-exec
 11920     MOVE LENGTH OF
 11921      activity-trailers
 11922       TO DFHEIV11
 11923     MOVE 'ELTRLR' TO DFHEIV1
 11924*    MOVE '&$ L                  ''   #00010703' TO DFHEIV0
 11925     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11926     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11927     MOVE X'2020233030303130373033' TO DFHEIV0(25:11)
 11928     CALL 'kxdfhei1' USING DFHEIV0,
 11929           DFHEIV1,
 11930           activity-trailers,
 11931           DFHEIV11,
 11932           trlr-key,
 11933           DFHEIV99,
 11934           DFHEIV99
 11935     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11936              perform varying s1 from +1 by +1 until
 11937                 ws-error-no (s1) = spaces
 11938                 move ws-error-no (s1)
 11939                                 to emi-error
 11940                 PERFORM 9900-ERROR-FORMAT
 11941                                 THRU 9900-EXIT
 11942              end-perform
 11943           end-if
 11944     end-evaluate
 11945
 11946     .
 11947 2130-exit.
 11948     exit.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 220
* EL131.cbl
 11949 2140-update-elcrtt.
 11950     move ' '                    to crtt-switch
 11951     MOVE CERT-KEY               TO ELCRTT-KEY
 11952     MOVE 'B'                    TO CTRLR-REC-TYPE
 11953
 11954* EXEC CICS READ
 11955*       UPDATE
 11956*       DATASET   ('ELCRTT')
 11957*       RIDFLD    (ELCRTT-KEY)
 11958*       INTO      (CERTIFICATE-TRAILERS)
 11959*       RESP      (WS-RESPONSE)
 11960*    END-EXEC
 11961     MOVE LENGTH OF
 11962      CERTIFICATE-TRAILERS
 11963       TO DFHEIV11
 11964     MOVE 'ELCRTT' TO DFHEIV1
 11965*    MOVE '&"IL       EU         (  N#00010725' TO DFHEIV0
 11966     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11967     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11968     MOVE X'204E233030303130373235' TO DFHEIV0(25:11)
 11969     CALL 'kxdfhei1' USING DFHEIV0,
 11970           DFHEIV1,
 11971           CERTIFICATE-TRAILERS,
 11972           DFHEIV11,
 11973           ELCRTT-KEY,
 11974           DFHEIV99,
 11975           DFHEIV99,
 11976           DFHEIV99
 11977     MOVE EIBRESP  TO WS-RESPONSE
 11978     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11979     IF WS-RESP-NORMAL
 11980        perform varying s1 from +1 by +1 until
 11981           (s1 > +24)
 11982           or (cs-claim-no (s1) = cl-claim-no)
 11983        end-perform
 11984        if (s1 < +25)
 11985           if (benperl <> zeros)
 11986              and (cs-benefit-period (s1) not = benperi)
 11987              move benperi       to cs-benefit-period (s1)
 11988              set crtt-update    to true
 11989          end-if
 11990          if (instypel <> zeros)
 11991             and (instypei not = cs-insured-type (s1))
 11992             move instypei      to cs-insured-type (s1)
 11993             set crtt-update    to true
 11994          end-if
 11995          move cs-claim-type (s1) to ws-claim-type
 11996          move cs-benefit-period (s1) to ws-ben-per
 11997        end-if
 11998        if crtt-update
 11999           perform 2150-accum    thru 2150-exit
 12000
 12001* EXEC CICS REWRITE
 12002*             DATASET   ('ELCRTT')
 12003*             FROM      (CERTIFICATE-TRAILERS)
 12004*          END-EXEC
 12005     MOVE LENGTH OF
 12006      CERTIFICATE-TRAILERS
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 221
* EL131.cbl
 12007       TO DFHEIV11
 12008     MOVE 'ELCRTT' TO DFHEIV1
 12009*    MOVE '&& L                  %   #00010753' TO DFHEIV0
 12010     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12011     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12012     MOVE X'2020233030303130373533' TO DFHEIV0(25:11)
 12013     CALL 'kxdfhei1' USING DFHEIV0,
 12014           DFHEIV1,
 12015           CERTIFICATE-TRAILERS,
 12016           DFHEIV11,
 12017           DFHEIV99
 12018     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12019        else
 12020
 12021* exec cics unlock
 12022*             dataset   ('ELCRTT')
 12023*          end-exec
 12024     MOVE 'ELCRTT' TO DFHEIV1
 12025*    MOVE '&*                    #   #00010758' TO DFHEIV0
 12026     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 12027     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12028     MOVE X'2020233030303130373538' TO DFHEIV0(25:11)
 12029     CALL 'kxdfhei1' USING DFHEIV0,
 12030           DFHEIV1,
 12031           DFHEIV99
 12032     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12033        end-if
 12034     end-if
 12035     .
 12036 2140-exit.
 12037     exit.
 12038 2150-accum.
 12039     if not erpdef-found
 12040        perform 3997-get-erpdef  thru 3997-exit
 12041     end-if
 12042     if (erpdef-found)
 12043        and (ws-max-moben not = zeros)
 12044        and (ws-max-moben < cm-ah-benefit-amt)
 12045        continue
 12046     else
 12047        move cm-ah-benefit-amt   to ws-max-moben
 12048     end-if
 12049     move cm-ah-orig-term        to ws-max-bens
 12050     if cl-critical-period not = zeros and spaces
 12051        move cl-critical-period  to ws-max-bens
 12052     end-if
 12053     move zeros to ws-tot-days-paid ws-tot-amt-paid
 12054     perform varying s2 from +1 by +1 until
 12055        (s2 > +24)
 12056        or (cs-claim-no (s2) = spaces)
 12057        if (cs-benefit-period (s2) = ws-ben-per)
 12058           and (cs-claim-type (s2) = ws-claim-type)
 12059           and (cs-insured-type (s2) = cl-insured-type)
 12060*          compute ws-tot-days-paid =
 12061*             ws-tot-days-paid + cs-days-paid (s2)
 12062           compute ws-tot-amt-paid =
 12063              ws-tot-amt-paid + cs-total-paid (s2)
 12064        end-if
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 222
* EL131.cbl
 12065     end-perform
 12066     if s2 < +25
 12067        compute ws-pd-bens rounded =
 12068           ws-tot-amt-paid / ws-max-moben
 12069        compute cs-remaining-bens (s1) =
 12070           ws-max-bens - ws-pd-bens
 12071        if cs-remaining-bens (s1) < zeros
 12072           move zeros            to cs-remaining-bens (s1)
 12073        end-if
 12074     end-if
 12075     .
 12076 2150-exit.
 12077     exit.
 12078 2200-MOVE-CERT.
 12079     IF CRTLNMEI GREATER THAN LOW-VALUES
 12080         MOVE CRTLNMEI           TO CM-INSURED-LAST-NAME.
 12081
 12082     IF CRTFNMEI GREATER THAN LOW-VALUES
 12083         MOVE CRTFNMEI           TO CM-INSURED-FIRST-NAME
 12084         MOVE CM-INSURED-1ST-INIT TO CM-INSURED-INITIAL1.
 12085
 12086     IF CRTINITI GREATER THAN LOW-VALUES
 12087         MOVE CRTINITI           TO CM-INSURED-INITIAL2.
 12088
 12089     IF CM-INSURED-INITIALS = SPACES
 12090         MOVE '**'               TO CM-INSURED-INITIALS.
 12091
 12092     IF ISSAGEI GREATER THAN LOW-VALUES
 12093         MOVE ISSAGEI            TO CM-INSURED-ISSUE-AGE.
 12094
 12095     IF JNTFNMEI GREATER THAN LOW-VALUES
 12096         MOVE JNTFNMEI           TO CM-JT-FIRST-NAME.
 12097
 12098     IF JNTLNMEI GREATER THAN LOW-VALUES
 12099         MOVE JNTLNMEI           TO CM-JT-LAST-NAME.
 12100
 12101     IF JNTINITI GREATER THAN LOW-VALUES
 12102         MOVE JNTINITI           TO CM-JT-INITIAL.
 12103
 12104     IF JNTAGEI GREATER THAN LOW-VALUES
 12105         MOVE JNTAGEI            TO CM-INSURED-JOINT-AGE.
 12106
 12107     IF ADDONDTI GREATER THAN LOW-VALUES
 12108        MOVE HOLD-ADDON          TO CM-LAST-ADD-ON-DT.
 12109
 12110     IF LCVCDI GREATER THAN LOW-VALUES
 12111        IF LCVCDI = SPACES OR ZEROS
 12112           MOVE ZEROS            TO CM-LF-BENEFIT-CD
 12113        ELSE
 12114           MOVE LCVCDI           TO CM-LF-BENEFIT-CD.
 12115
 12116     IF LCVOTRMI GREATER THAN LOW-VALUES
 12117         MOVE LCVOTRMI           TO CM-LF-ORIG-TERM.
 12118
 12119     IF LCVRATEL GREATER THAN +0
 12120         MOVE HOLD-LF-RATE       TO CM-LF-PREMIUM-RATE.
 12121
 12122     IF LCVBENEL GREATER THAN +0
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 223
* EL131.cbl
 12123         MOVE HOLD-LF-CV-BEN     TO CM-LF-BENEFIT-AMT.
 12124
 12125     IF LCVFORMI GREATER THAN LOW-VALUES
 12126         MOVE LCVFORMI           TO CM-POLICY-FORM-NO.
 12127
 12128     IF LCVCNDTI = LOW-VALUES
 12129        GO TO 2210-SET-STATUS.
 12130
 12131     IF HOLD-LF-CV-CAN NOT = LOW-VALUES
 12132        MOVE '8'                 TO CM-LF-CURRENT-STATUS
 12133        MOVE HOLD-LF-CV-CAN      TO CM-LF-CANCEL-DT
 12134        GO TO 2210-SET-STATUS.
 12135
 12136     IF CM-LF-CURRENT-STATUS = '7'
 12137        MOVE CM-LF-STATUS-AT-DEATH   TO CM-LF-CURRENT-STATUS
 12138        MOVE SPACES              TO CM-LF-STATUS-AT-DEATH
 12139        MOVE LOW-VALUES          TO CM-LF-DEATH-EXIT-DT
 12140                                    CM-LF-DEATH-DT
 12141        GO TO 2210-SET-STATUS.
 12142
 12143     IF CM-LF-CURRENT-STATUS = '8'
 12144        MOVE '1'                 TO CM-LF-CURRENT-STATUS
 12145        MOVE LOW-VALUES          TO CM-LF-DEATH-EXIT-DT
 12146                                    CM-LF-CANCEL-DT.
 12147
 12148 2210-SET-STATUS.
 12149
 12150     IF CM-LF-CURRENT-STATUS = SPACES
 12151         MOVE '1'                TO CM-LF-CURRENT-STATUS.
 12152
 12153     IF CM-LF-ORIG-TERM GREATER THAN ZERO
 12154         MOVE '6'                TO DC-OPTION-CODE
 12155         MOVE CM-LF-ORIG-TERM    TO DC-ELAPSED-MONTHS
 12156         MOVE CM-CERT-EFF-DT     TO DC-BIN-DATE-1
 12157         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12158         IF NO-CONVERSION-ERROR
 12159             MOVE DC-BIN-DATE-2  TO CM-LF-LOAN-EXPIRE-DT
 12160         ELSE
 12161             MOVE LOW-VALUES     TO CM-LF-LOAN-EXPIRE-DT
 12162     ELSE
 12163         MOVE LOW-VALUES         TO CM-LF-LOAN-EXPIRE-DT.
 12164
 12165 2215-PROCESS-AH-SIDE.
 12166
 12167     IF ACVCDI GREATER THAN LOW-VALUES
 12168        IF ACVCDI = SPACES OR ZEROS
 12169           MOVE ZEROS            TO CM-AH-BENEFIT-CD
 12170        ELSE
 12171           MOVE ACVCDI           TO CM-AH-BENEFIT-CD.
 12172
 12173     IF ACVOTRMI GREATER THAN LOW-VALUES
 12174         MOVE ACVOTRMI           TO CM-AH-ORIG-TERM.
 12175
 12176     IF ACVRATEL GREATER THAN +0
 12177         MOVE HOLD-AH-RATE       TO CM-AH-PREMIUM-RATE.
 12178
 12179     IF ACVBENEL GREATER THAN +0
 12180         MOVE HOLD-AH-CV-BEN     TO CM-AH-BENEFIT-AMT
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 224
* EL131.cbl
 12181                                    PI-PAYMENT-AMT.
 12182
 12183     IF ACVFORMI GREATER THAN LOW-VALUES
 12184         MOVE ACVFORMI           TO CM-POLICY-FORM-NO.
 12185
 12186     IF ACVCNDTI = LOW-VALUES
 12187        GO TO 2220-SET-STATUS.
 12188
 12189     IF HOLD-AH-CV-CAN NOT = LOW-VALUES
 12190        MOVE '8'                 TO CM-AH-CURRENT-STATUS
 12191        MOVE HOLD-AH-CV-CAN      TO CM-AH-CANCEL-DT
 12192        GO TO 2220-SET-STATUS.
 12193
 12194     IF CM-AH-CURRENT-STATUS = '6'
 12195        MOVE CM-AH-STATUS-AT-SETTLEMENT
 12196                                 TO CM-AH-CURRENT-STATUS
 12197        MOVE SPACES              TO CM-AH-STATUS-AT-SETTLEMENT
 12198        MOVE LOW-VALUES          TO CM-AH-SETTLEMENT-EXIT-DT
 12199                                    CM-AH-SETTLEMENT-DT
 12200        GO TO 2220-SET-STATUS.
 12201
 12202     IF CM-AH-CURRENT-STATUS = '8'
 12203        MOVE '1'                 TO CM-AH-CURRENT-STATUS
 12204        MOVE LOW-VALUES          TO CM-AH-SETTLEMENT-EXIT-DT
 12205                                    CM-AH-CANCEL-DT.
 12206
 12207 2220-SET-STATUS.
 12208     IF CM-AH-CURRENT-STATUS = SPACES
 12209         MOVE '1'                TO CM-AH-CURRENT-STATUS.
 12210
 12211     IF CM-AH-ORIG-TERM GREATER THAN ZERO
 12212         MOVE '6'                TO DC-OPTION-CODE
 12213         MOVE CM-AH-ORIG-TERM    TO DC-ELAPSED-MONTHS
 12214         MOVE CM-CERT-EFF-DT     TO DC-BIN-DATE-1
 12215         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12216         IF NO-CONVERSION-ERROR
 12217             MOVE DC-BIN-DATE-2  TO CM-AH-LOAN-EXPIRE-DT
 12218         ELSE
 12219             MOVE LOW-VALUES     TO CM-AH-LOAN-EXPIRE-DT
 12220     ELSE
 12221         MOVE LOW-VALUES         TO CM-AH-LOAN-EXPIRE-DT.
 12222
 12223 2225-FINISH-CERT.
 12224     IF APRL GREATER THAN +0
 12225         MOVE HOLD-APR           TO CM-LOAN-APR.
 12226
 12227     IF PMTFREQI GREATER THAN LOW-VALUES
 12228         MOVE PMTFREQI           TO CM-PAY-FREQUENCY.
 12229
 12230     IF INDGRPI GREATER THAN LOW-VALUES
 12231         MOVE INDGRPI            TO CM-IND-GRP-TYPE.
 12232
 12233*    IF LOANNOI GREATER THAN LOW-VALUES
 12234*       MOVE LOANNOI             TO CM-LOAN-NUMBER.
 12235
 12236     IF LOANBALL GREATER THAN +0
 12237        MOVE HOLD-LOANBAL        TO CM-LOAN-BALANCE.
 12238
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 225
* EL131.cbl
 12239     IF PREMTYPI GREATER THAN LOW-VALUES
 12240         MOVE PREMTYPI           TO CM-PREMIUM-TYPE.
 12241
 12242     IF REINCDI GREATER THAN LOW-VALUES
 12243         MOVE REINCDI            TO CM-SPECIAL-REIN-CODE
 12244                                    WS-REIN-1
 12245                                    WS-REIN-2
 12246                                    WS-REIN-3
 12247         MOVE WS-REIN-TABLE      TO CM-REIN-TABLE.
 12248
 12249     MOVE LOW-VALUES             TO CM-AH-PAID-THRU-DT.
 12250
 12251     MOVE ZEROS                  TO CM-LOAN-TERM
 12252                                    CM-LIFE-COMM-PCT
 12253                                    CM-AH-COMM-PCT.
 12254
 12255*    IF PI-COMPANY-ID = 'CRI' OR 'PEM' OR 'NCL'
 12256*      IF CM-PREMIUM-TYPE NOT = '1'  AND
 12257*         PI-NO-PMTS = ZEROS
 12258*          IF LOANBALL GREATER THAN +0          OR
 12259*             ACVBENEL GREATER THAN +0          OR
 12260*             APRL     GREATER THAN +0          OR
 12261*             LCVRATEL GREATER THAN +0          OR
 12262*             ACVRATEL GREATER THAN +0
 12263*               PERFORM 6000-CALCULATE-CERT-TERM THRU 6000-EXIT.
 12264
 12265 2200-EXIT.
 12266     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 226
* EL131.cbl
 12268 2300-UPDATE-TRLR.
 12269     MOVE ZERO                   TO TRLR-SEQ-NO.
 12270
 12271* EXEC CICS READ UPDATE
 12272*         DATASET  (TRLR-FILE-ID)
 12273*         RIDFLD   (TRLR-KEY)
 12274*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 12275*    END-EXEC.
 12276*    MOVE '&"S        EU         (   #00010998' TO DFHEIV0
 12277     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12278     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12279     MOVE X'2020233030303130393938' TO DFHEIV0(25:11)
 12280     CALL 'kxdfhei1' USING DFHEIV0,
 12281           TRLR-FILE-ID,
 12282           DFHEIV20,
 12283           DFHEIV99,
 12284           TRLR-KEY,
 12285           DFHEIV99,
 12286           DFHEIV99,
 12287           DFHEIV99
 12288     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12289         DFHEIV20
 12290     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12291
 12292
 12293     MOVE ZERO                   TO COUNT-2.
 12294
 12295     PERFORM 2310-INS-STATUS THRU 2310-EXIT
 12296         UNTIL UPDATE-MADE OR COUNT-2 GREATER THAN 6.
 12297
 12298     IF NOT UPDATE-MADE
 12299         PERFORM 2320-SHIFT-STATUS THRU 2320-EXIT.
 12300
 12301
 12302* EXEC CICS REWRITE
 12303*         DATASET  (TRLR-FILE-ID)
 12304*         FROM     (ACTIVITY-TRAILERS)
 12305*    END-EXEC.
 12306     MOVE LENGTH OF
 12307      ACTIVITY-TRAILERS
 12308       TO DFHEIV11
 12309*    MOVE '&& L                  %   #00011012' TO DFHEIV0
 12310     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12311     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12312     MOVE X'2020233030303131303132' TO DFHEIV0(25:11)
 12313     CALL 'kxdfhei1' USING DFHEIV0,
 12314           TRLR-FILE-ID,
 12315           ACTIVITY-TRAILERS,
 12316           DFHEIV11,
 12317           DFHEIV99
 12318     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12319
 12320
 12321 2300-EXIT.
 12322     EXIT.
 12323
 12324 2310-INS-STATUS.
 12325     ADD 1                       TO COUNT-2.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 227
* EL131.cbl
 12326     IF AT-OPEN-CLOSE-TYPE (COUNT-2) = SPACE
 12327         PERFORM 2330-ADD-UPDATE THRU 2330-EXIT
 12328         MOVE 'Y'                TO TRLR-SWITCH.
 12329
 12330 2310-EXIT.
 12331     EXIT.
 12332
 12333 2320-SHIFT-STATUS.
 12334     IF AT-OPEN-CLOSE-TYPE (6) = STATUSI
 12335        MOVE 6                   TO COUNT-2
 12336        GO TO 2320-EXIT.
 12337
 12338     MOVE AT-OPEN-CLOSE-HISTORY (2) TO AT-OPEN-CLOSE-HISTORY (1).
 12339     MOVE AT-OPEN-CLOSE-HISTORY (3) TO AT-OPEN-CLOSE-HISTORY (2).
 12340     MOVE AT-OPEN-CLOSE-HISTORY (4) TO AT-OPEN-CLOSE-HISTORY (3).
 12341     MOVE AT-OPEN-CLOSE-HISTORY (5) TO AT-OPEN-CLOSE-HISTORY (4).
 12342     MOVE AT-OPEN-CLOSE-HISTORY (6) TO AT-OPEN-CLOSE-HISTORY (5).
 12343     MOVE 6       TO COUNT-2.
 12344     PERFORM 2330-ADD-UPDATE THRU 2330-EXIT.
 12345
 12346 2320-EXIT.
 12347     EXIT.
 12348
 12349 2330-ADD-UPDATE.
 12350
 12351     IF COUNT-2 GREATER THAN 1
 12352        COMPUTE MISC-SUB = (COUNT-2 - 1)
 12353        IF AT-OPEN-CLOSE-TYPE (MISC-SUB) = STATUSI
 12354           GO TO 2330-EXIT.
 12355
 12356     MOVE SAVE-BIN-DATE         TO AT-OPEN-CLOSE-DATE (COUNT-2)
 12357                                   AT-RESERVES-LAST-MAINT-DT
 12358
 12359     MOVE PI-PROCESSOR-ID       TO AT-RESERVES-LAST-UPDATED-BY
 12360     MOVE EIBTIME               TO AT-LAST-MAINT-HHMMSS
 12361     MOVE STATUSI               TO AT-OPEN-CLOSE-TYPE (COUNT-2)
 12362     MOVE 'ALTER'               TO AT-OPEN-CLOSE-REASON (COUNT-2).
 12363
 12364 2330-EXIT.
 12365     EXIT.
 12366
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 228
* EL131.cbl
 12368 2400-UPDATE-TRLR.
 12369
 12370* EXEC CICS HANDLE CONDITION
 12371*         NOTFND    (2400-TRLR-NOTFND)
 12372*         ENDFILE   (2410-EXIT)
 12373*    END-EXEC.
 12374*    MOVE '"$I''                  ! 5 #00011065' TO DFHEIV0
 12375     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 12376     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12377     MOVE X'3520233030303131303635' TO DFHEIV0(25:11)
 12378     CALL 'kxdfhei1' USING DFHEIV0
 12379     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12380
 12381
 12382
 12383* EXEC CICS STARTBR
 12384*        DATASET (TRLR-FILE-ID)
 12385*        RIDFLD  (TRLR-KEY)
 12386*    END-EXEC.
 12387     MOVE 0
 12388       TO DFHEIV11
 12389*    MOVE '&,         G          &   #00011070' TO DFHEIV0
 12390     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 12391     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12392     MOVE X'2020233030303131303730' TO DFHEIV0(25:11)
 12393     CALL 'kxdfhei1' USING DFHEIV0,
 12394           TRLR-FILE-ID,
 12395           TRLR-KEY,
 12396           DFHEIV99,
 12397           DFHEIV11,
 12398           DFHEIV99
 12399     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12400
 12401
 12402
 12403* EXEC CICS GETMAIN
 12404*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 12405*         LENGTH    (TRLR-LENGTH)
 12406*         INITIMG   (GETMAIN-SPACE)
 12407*    END-EXEC.
 12408*    MOVE ',"IL                  $   #00011075' TO DFHEIV0
 12409     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12410     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12411     MOVE X'2020233030303131303735' TO DFHEIV0(25:11)
 12412     CALL 'kxdfhei1' USING DFHEIV0,
 12413           DFHEIV20,
 12414           TRLR-LENGTH,
 12415           GETMAIN-SPACE
 12416     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12417         DFHEIV20
 12418     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12419
 12420
 12421     PERFORM 2410-CHANGE-TRLR THRU 2410-EXIT.
 12422
 12423
 12424* EXEC CICS ENDBR
 12425*        DATASET (TRLR-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 229
* EL131.cbl
 12426*    END-EXEC.
 12427     MOVE 0
 12428       TO DFHEIV11
 12429*    MOVE '&2                    $   #00011083' TO DFHEIV0
 12430     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 12431     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12432     MOVE X'2020233030303131303833' TO DFHEIV0(25:11)
 12433     CALL 'kxdfhei1' USING DFHEIV0,
 12434           TRLR-FILE-ID,
 12435           DFHEIV11,
 12436           DFHEIV99
 12437     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12438
 12439
 12440     GO TO 2400-EXIT.
 12441
 12442 2400-TRLR-NOTFND.
 12443     MOVE ER-0205                TO EMI-ERROR.
 12444     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12445     MOVE 'X'                    TO ERROR-SWITCH.
 12446
 12447 2400-EXIT.
 12448     EXIT.
 12449
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 230
* EL131.cbl
 12451 2410-CHANGE-TRLR.
 12452
 12453* EXEC CICS READNEXT
 12454*        DATASET (TRLR-FILE-ID)
 12455*        RIDFLD  (TRLR-KEY)
 12456*        INTO    (ACTIVITY-TRAILERS)
 12457*    END-EXEC.
 12458     MOVE LENGTH OF
 12459      ACTIVITY-TRAILERS
 12460       TO DFHEIV12
 12461     MOVE 0
 12462       TO DFHEIV11
 12463*    MOVE '&.IL                  )   #00011099' TO DFHEIV0
 12464     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 12465     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 12466     MOVE X'2020233030303131303939' TO DFHEIV0(25:11)
 12467     CALL 'kxdfhei1' USING DFHEIV0,
 12468           TRLR-FILE-ID,
 12469           ACTIVITY-TRAILERS,
 12470           DFHEIV12,
 12471           TRLR-KEY,
 12472           DFHEIV99,
 12473           DFHEIV11,
 12474           DFHEIV99,
 12475           DFHEIV99
 12476     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12477
 12478
 12479     IF AT-CONTROL-PRIMARY = WS-LAST-TRLR-KEY
 12480        GO TO 2410-CHANGE-TRLR.
 12481
 12482     MOVE AT-CONTROL-PRIMARY     TO WS-LAST-TRLR-KEY
 12483                                    CHECK-KEY.
 12484
 12485     IF CHECK-KEY NOT = MSTR-KEY
 12486         GO TO 2410-EXIT.
 12487
 12488
 12489* EXEC CICS ENDBR
 12490*        DATASET (TRLR-FILE-ID)
 12491*    END-EXEC.
 12492     MOVE 0
 12493       TO DFHEIV11
 12494*    MOVE '&2                    $   #00011114' TO DFHEIV0
 12495     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 12496     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12497     MOVE X'2020233030303131313134' TO DFHEIV0(25:11)
 12498     CALL 'kxdfhei1' USING DFHEIV0,
 12499           TRLR-FILE-ID,
 12500           DFHEIV11,
 12501           DFHEIV99
 12502     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12503
 12504
 12505
 12506* EXEC CICS READ UPDATE
 12507*        DATASET (TRLR-FILE-ID)
 12508*        RIDFLD  (TRLR-KEY)
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 231
* EL131.cbl
 12509*        INTO    (ACTIVITY-TRAILERS)
 12510*    END-EXEC.
 12511     MOVE LENGTH OF
 12512      ACTIVITY-TRAILERS
 12513       TO DFHEIV11
 12514*    MOVE '&"IL       EU         (   #00011118' TO DFHEIV0
 12515     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12516     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12517     MOVE X'2020233030303131313138' TO DFHEIV0(25:11)
 12518     CALL 'kxdfhei1' USING DFHEIV0,
 12519           TRLR-FILE-ID,
 12520           ACTIVITY-TRAILERS,
 12521           DFHEIV11,
 12522           TRLR-KEY,
 12523           DFHEIV99,
 12524           DFHEIV99,
 12525           DFHEIV99
 12526     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12527
 12528
 12529
 12530* EXEC CICS DELETE
 12531*        DATASET (TRLR-FILE-ID)
 12532*    END-EXEC.
 12533*    MOVE '&(                    &   #00011124' TO DFHEIV0
 12534     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12535     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12536     MOVE X'2020233030303131313234' TO DFHEIV0(25:11)
 12537     CALL 'kxdfhei1' USING DFHEIV0,
 12538           TRLR-FILE-ID,
 12539           DFHEIV99,
 12540           DFHEIV99,
 12541           DFHEIV99,
 12542           DFHEIV99
 12543     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12544
 12545
 12546     IF AT-SEQUENCE-NO = ZERO AND
 12547        TRLR-UPDATE-REQUIRED
 12548         PERFORM 2420-UPDATE-TRLR THRU 2420-EXIT.
 12549
 12550     IF CERTI GREATER THAN LOW-VALUES
 12551        MOVE CERTI               TO AT-CERT-PRIME.
 12552
 12553     IF SUFXI GREATER THAN LOW-VALUES
 12554        MOVE SUFXI               TO AT-CERT-SFX.
 12555
 12556     IF CERTCARI GREATER THAN LOW-VALUES
 12557        MOVE CERTCARI            TO AT-CARRIER.
 12558
 12559     IF PAYMENT-TR
 12560        IF AT-CHECK-QUE-CONTROL NOT = ZEROS
 12561           AND AT-CHECK-QUE-CONTROL NOT = 99999999
 12562              PERFORM 2460-UPDATE-CHECKQ THRU 2460-EXIT.
 12563
 12564     IF CORRESPONDENCE-TR
 12565        AND AT-LETTER-ARCHIVE-NO NOT = ZEROS
 12566           PERFORM 2475-UPDATE-LETTER THRU 2475-EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 232
* EL131.cbl
 12567
 12568
 12569* EXEC CICS WRITE
 12570*         DATASET  (TRLR-FILE-ID)
 12571*         RIDFLD   (AT-CONTROL-PRIMARY)
 12572*         FROM     (ACTIVITY-TRAILERS)
 12573*    END-EXEC.
 12574     MOVE LENGTH OF
 12575      ACTIVITY-TRAILERS
 12576       TO DFHEIV11
 12577*    MOVE '&$ L                  ''   #00011150' TO DFHEIV0
 12578     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12579     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12580     MOVE X'2020233030303131313530' TO DFHEIV0(25:11)
 12581     CALL 'kxdfhei1' USING DFHEIV0,
 12582           TRLR-FILE-ID,
 12583           ACTIVITY-TRAILERS,
 12584           DFHEIV11,
 12585           AT-CONTROL-PRIMARY,
 12586           DFHEIV99,
 12587           DFHEIV99
 12588     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12589
 12590
 12591
 12592* EXEC CICS STARTBR
 12593*         DATASET  (TRLR-FILE-ID)
 12594*         RIDFLD   (TRLR-KEY)
 12595*    END-EXEC.
 12596     MOVE 0
 12597       TO DFHEIV11
 12598*    MOVE '&,         G          &   #00011156' TO DFHEIV0
 12599     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 12600     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12601     MOVE X'2020233030303131313536' TO DFHEIV0(25:11)
 12602     CALL 'kxdfhei1' USING DFHEIV0,
 12603           TRLR-FILE-ID,
 12604           TRLR-KEY,
 12605           DFHEIV99,
 12606           DFHEIV11,
 12607           DFHEIV99
 12608     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12609
 12610
 12611     GO TO 2410-CHANGE-TRLR.
 12612
 12613 2410-EXIT.
 12614     EXIT.
 12615
 12616 2420-UPDATE-TRLR.
 12617     MOVE ZERO TO COUNT-2.
 12618     PERFORM 2310-INS-STATUS THRU 2310-EXIT
 12619         UNTIL UPDATE-MADE OR COUNT-2 GREATER THAN 6.
 12620
 12621     IF NOT UPDATE-MADE
 12622         PERFORM 2320-SHIFT-STATUS THRU 2320-EXIT.
 12623
 12624 2420-EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 233
* EL131.cbl
 12625     EXIT.
 12626
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 234
* EL131.cbl
 12628 2425-UPDATE-NINETY-TRLR.
 12629
 12630     MOVE +90                    TO TRLR-SEQ-NO.
 12631
 12632
 12633* EXEC CICS HANDLE CONDITION
 12634*         NOTFND    (2425-NINETY-NOTFND)
 12635*         ENDFILE   (2425-NINETY-NOTFND)
 12636*    END-EXEC.
 12637*    MOVE '"$I''                  ! 6 #00011182' TO DFHEIV0
 12638     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 12639     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12640     MOVE X'3620233030303131313832' TO DFHEIV0(25:11)
 12641     CALL 'kxdfhei1' USING DFHEIV0
 12642     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12643
 12644
 12645
 12646* EXEC CICS READ UPDATE
 12647*        DATASET (TRLR-FILE-ID)
 12648*        SET     (ADDRESS OF ACTIVITY-TRAILERS)
 12649*        RIDFLD  (TRLR-KEY)
 12650*    END-EXEC.
 12651*    MOVE '&"S        EU         (   #00011187' TO DFHEIV0
 12652     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12653     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12654     MOVE X'2020233030303131313837' TO DFHEIV0(25:11)
 12655     CALL 'kxdfhei1' USING DFHEIV0,
 12656           TRLR-FILE-ID,
 12657           DFHEIV20,
 12658           DFHEIV99,
 12659           TRLR-KEY,
 12660           DFHEIV99,
 12661           DFHEIV99,
 12662           DFHEIV99
 12663     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12664         DFHEIV20
 12665     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12666
 12667     if (diagi > low-values)
 12668        and (diagi not = at-info-line-1)
 12669        and (cl-total-paid-amt > zeros)
 12670        move cl-cert-eff-dt      to dc-bin-date-1
 12671        move cl-paid-thru-dt     to dc-bin-date-2
 12672        move '1'                 to dc-option-code
 12673        perform 9800-convert-date
 12674                                 thru 9800-exit
 12675        if no-conversion-error
 12676           and dc-elapsed-months < +24
 12677           and (not emi-bypass-forcables)
 12678           move er-1581          to emi-error
 12679           perform 9900-error-format
 12680                                thru 9900-exit
 12681           move -1              to diagl
 12682           go to 8110-send-data
 12683        end-if
 12684     end-if
 12685     MOVE AT-INFO-LINE-1        TO WS-DIAGNOSIS.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 235
* EL131.cbl
 12686     MOVE AT-ICD-CODE-1         TO WS-ICD-CODE-1.
 12687     MOVE AT-ICD-CODE-2         TO WS-ICD-CODE-2.
 12688
 12689     IF DIAGI GREATER THAN LOW-VALUES
 12690         MOVE DIAGI             TO AT-INFO-LINE-1
 12691     END-IF.
 12692
 12693     IF ICD1I GREATER THAN LOW-VALUES
 12694         MOVE ICD1I             TO AT-ICD-CODE-1
 12695     END-IF.
 12696
 12697     IF ICD2I GREATER THAN LOW-VALUES
 12698         MOVE ICD2I             TO AT-ICD-CODE-2
 12699     END-IF.
 12700
 12701
 12702* EXEC CICS REWRITE
 12703*        DATASET (TRLR-FILE-ID)
 12704*        FROM    (ACTIVITY-TRAILERS)
 12705*    END-EXEC.
 12706     MOVE LENGTH OF
 12707      ACTIVITY-TRAILERS
 12708       TO DFHEIV11
 12709*    MOVE '&& L                  %   #00011226' TO DFHEIV0
 12710     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12711     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12712     MOVE X'2020233030303131323236' TO DFHEIV0(25:11)
 12713     CALL 'kxdfhei1' USING DFHEIV0,
 12714           TRLR-FILE-ID,
 12715           ACTIVITY-TRAILERS,
 12716           DFHEIV11,
 12717           DFHEIV99
 12718     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12719
 12720
 12721     IF DIAGI GREATER THAN LOW-VALUES
 12722       AND DIAGI NOT = WS-DIAGNOSIS
 12723         MOVE 'DIAGNOSIS'          TO SPLIT-INFO-DESC
 12724         MOVE WS-DIAGNOSIS         TO SPLIT-INFO-OLD
 12725         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12726
 12727     IF ICD1I GREATER THAN LOW-VALUES
 12728       AND ICD1I NOT = WS-ICD-CODE-1
 12729         MOVE 'ICD CODE 1'         TO SPLIT-INFO-DESC
 12730         MOVE WS-ICD-CODE-1        TO SPLIT-INFO-OLD
 12731         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT
 12732     END-IF.
 12733
 12734     IF ICD2I GREATER THAN LOW-VALUES
 12735       AND ICD2I NOT = WS-ICD-CODE-2
 12736         MOVE 'ICD CODE 2'         TO SPLIT-INFO-DESC
 12737         MOVE WS-ICD-CODE-2        TO SPLIT-INFO-OLD
 12738         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT
 12739     END-IF.
 12740
 12741     GO TO 2425-EXIT.
 12742
 12743 2425-NINETY-NOTFND.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 236
* EL131.cbl
 12744
 12745
 12746* EXEC CICS GETMAIN
 12747*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 12748*         LENGTH    (TRLR-LENGTH)
 12749*         INITIMG   (GETMAIN-SPACE)
 12750*    END-EXEC.
 12751*    MOVE ',"IL                  $   #00011255' TO DFHEIV0
 12752     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12753     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12754     MOVE X'2020233030303131323535' TO DFHEIV0(25:11)
 12755     CALL 'kxdfhei1' USING DFHEIV0,
 12756           DFHEIV20,
 12757           TRLR-LENGTH,
 12758           GETMAIN-SPACE
 12759     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12760         DFHEIV20
 12761     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12762
 12763
 12764     MOVE +90                  TO TRLR-SEQ-NO.
 12765     MOVE TRLR-KEY             TO AT-CONTROL-PRIMARY.
 12766
 12767     MOVE 'AT'                 TO AT-RECORD-ID
 12768     MOVE '6'                  TO AT-TRAILER-TYPE
 12769     MOVE SAVE-BIN-DATE        TO AT-RECORDED-DT
 12770                                  AT-GEN-INFO-LAST-MAINT-DT
 12771     MOVE PI-PROCESSOR-ID      TO AT-RECORDED-BY
 12772                                  AT-GEN-INFO-LAST-UPDATED-BY
 12773     MOVE EIBTIME              TO AT-LAST-MAINT-HHMMSS
 12774     MOVE DIAGI                TO AT-INFO-LINE-1.
 12775     MOVE ICD1I                TO AT-ICD-CODE-1.
 12776     MOVE ICD2I                TO AT-ICD-CODE-2.
 12777
 12778
 12779* EXEC CICS WRITE
 12780*        DATASET (TRLR-FILE-ID)
 12781*        FROM    (ACTIVITY-TRAILERS)
 12782*        RIDFLD  (TRLR-KEY)
 12783*    END-EXEC.
 12784     MOVE LENGTH OF
 12785      ACTIVITY-TRAILERS
 12786       TO DFHEIV11
 12787*    MOVE '&$ L                  ''   #00011275' TO DFHEIV0
 12788     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12789     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12790     MOVE X'2020233030303131323735' TO DFHEIV0(25:11)
 12791     CALL 'kxdfhei1' USING DFHEIV0,
 12792           TRLR-FILE-ID,
 12793           ACTIVITY-TRAILERS,
 12794           DFHEIV11,
 12795           TRLR-KEY,
 12796           DFHEIV99,
 12797           DFHEIV99
 12798     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12799
 12800
 12801 2425-EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 237
* EL131.cbl
 12802     EXIT.
 12803
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 238
* EL131.cbl
 12805 2430-UPDATE-ACTQ.
 12806
 12807* EXEC CICS HANDLE CONDITION
 12808*         NOTFND    (2430-EXIT)
 12809*         ENDFILE   (2440-EXIT)
 12810*    END-EXEC.
 12811*    MOVE '"$I''                  ! 7 #00011286' TO DFHEIV0
 12812     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 12813     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12814     MOVE X'3720233030303131323836' TO DFHEIV0(25:11)
 12815     CALL 'kxdfhei1' USING DFHEIV0
 12816     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12817
 12818
 12819
 12820* EXEC CICS STARTBR
 12821*         DATASET  (ACTQ-FILE-ID)
 12822*         RIDFLD   (ACTQ-KEY)
 12823*    END-EXEC.
 12824     MOVE 0
 12825       TO DFHEIV11
 12826*    MOVE '&,         G          &   #00011291' TO DFHEIV0
 12827     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 12828     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12829     MOVE X'2020233030303131323931' TO DFHEIV0(25:11)
 12830     CALL 'kxdfhei1' USING DFHEIV0,
 12831           ACTQ-FILE-ID,
 12832           ACTQ-KEY,
 12833           DFHEIV99,
 12834           DFHEIV11,
 12835           DFHEIV99
 12836     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12837
 12838
 12839
 12840* EXEC CICS GETMAIN
 12841*         SET      (ADDRESS OF ACTIVITY-QUE)
 12842*         LENGTH   (ACTQ-LENGTH)
 12843*         INITIMG  (GETMAIN-SPACE)
 12844*    END-EXEC.
 12845*    MOVE ',"IL                  $   #00011296' TO DFHEIV0
 12846     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12847     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12848     MOVE X'2020233030303131323936' TO DFHEIV0(25:11)
 12849     CALL 'kxdfhei1' USING DFHEIV0,
 12850           DFHEIV20,
 12851           ACTQ-LENGTH,
 12852           GETMAIN-SPACE
 12853     SET ADDRESS OF ACTIVITY-QUE TO
 12854         DFHEIV20
 12855     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12856
 12857
 12858     PERFORM 2440-CHANGE-ACTQ THRU 2440-EXIT.
 12859
 12860 2430-EXIT.
 12861     EXIT.
 12862
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 239
* EL131.cbl
 12863 2440-CHANGE-ACTQ.
 12864
 12865
 12866* EXEC CICS READNEXT
 12867*         DATASET  (ACTQ-FILE-ID)
 12868*         RIDFLD   (ACTQ-KEY)
 12869*         INTO     (ACTIVITY-QUE)
 12870*    END-EXEC.
 12871     MOVE LENGTH OF
 12872      ACTIVITY-QUE
 12873       TO DFHEIV12
 12874     MOVE 0
 12875       TO DFHEIV11
 12876*    MOVE '&.IL                  )   #00011309' TO DFHEIV0
 12877     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 12878     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 12879     MOVE X'2020233030303131333039' TO DFHEIV0(25:11)
 12880     CALL 'kxdfhei1' USING DFHEIV0,
 12881           ACTQ-FILE-ID,
 12882           ACTIVITY-QUE,
 12883           DFHEIV12,
 12884           ACTQ-KEY,
 12885           DFHEIV99,
 12886           DFHEIV11,
 12887           DFHEIV99,
 12888           DFHEIV99
 12889     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12890
 12891
 12892
 12893* EXEC CICS ENDBR
 12894*         DATASET (ACTQ-FILE-ID)
 12895*    END-EXEC.
 12896     MOVE 0
 12897       TO DFHEIV11
 12898*    MOVE '&2                    $   #00011315' TO DFHEIV0
 12899     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 12900     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12901     MOVE X'2020233030303131333135' TO DFHEIV0(25:11)
 12902     CALL 'kxdfhei1' USING DFHEIV0,
 12903           ACTQ-FILE-ID,
 12904           DFHEIV11,
 12905           DFHEIV99
 12906     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12907
 12908
 12909     IF ACTQ-KEY NOT = MSTR-KEY
 12910         GO TO 2440-EXIT.
 12911
 12912
 12913* EXEC CICS READ UPDATE
 12914*         DATASET  (ACTQ-FILE-ID)
 12915*         RIDFLD   (AQ-CONTROL-PRIMARY)
 12916*         SET      (ADDRESS OF ACTIVITY-QUE)
 12917*    END-EXEC.
 12918*    MOVE '&"S        EU         (   #00011322' TO DFHEIV0
 12919     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12920     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 240
* EL131.cbl
 12921     MOVE X'2020233030303131333232' TO DFHEIV0(25:11)
 12922     CALL 'kxdfhei1' USING DFHEIV0,
 12923           ACTQ-FILE-ID,
 12924           DFHEIV20,
 12925           DFHEIV99,
 12926           AQ-CONTROL-PRIMARY,
 12927           DFHEIV99,
 12928           DFHEIV99,
 12929           DFHEIV99
 12930     SET ADDRESS OF ACTIVITY-QUE TO
 12931         DFHEIV20
 12932     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12933
 12934
 12935     MOVE ACTIVITY-QUE           TO JP-RECORD-AREA
 12936
 12937
 12938* EXEC CICS DELETE
 12939*         DATASET (ACTQ-FILE-ID)
 12940*    END-EXEC.
 12941*    MOVE '&(                    &   #00011330' TO DFHEIV0
 12942     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12943     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12944     MOVE X'2020233030303131333330' TO DFHEIV0(25:11)
 12945     CALL 'kxdfhei1' USING DFHEIV0,
 12946           ACTQ-FILE-ID,
 12947           DFHEIV99,
 12948           DFHEIV99,
 12949           DFHEIV99,
 12950           DFHEIV99
 12951     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12952
 12953
 12954     MOVE JP-RECORD-AREA         TO ACTIVITY-QUE.
 12955     IF CERTI GREATER THAN LOW-VALUES
 12956        MOVE CERTI               TO AQ-CERT-PRIME.
 12957     IF SUFXI GREATER THAN LOW-VALUES
 12958        MOVE SUFXI               TO AQ-CERT-SFX.
 12959     IF CERTCARI GREATER THAN LOW-VALUES
 12960        MOVE CERTCARI            TO AQ-CARRIER.
 12961
 12962
 12963* EXEC CICS HANDLE CONDITION
 12964*         DUPREC   (2440-EXIT)
 12965*    END-EXEC.
 12966*    MOVE '"$%                   ! 8 #00011342' TO DFHEIV0
 12967     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 12968     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12969     MOVE X'3820233030303131333432' TO DFHEIV0(25:11)
 12970     CALL 'kxdfhei1' USING DFHEIV0
 12971     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12972
 12973
 12974
 12975* EXEC CICS WRITE
 12976*         DATASET  (ACTQ-FILE-ID)
 12977*         RIDFLD   (AQ-CONTROL-PRIMARY)
 12978*         FROM     (ACTIVITY-QUE)
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 241
* EL131.cbl
 12979*    END-EXEC.
 12980     MOVE LENGTH OF
 12981      ACTIVITY-QUE
 12982       TO DFHEIV11
 12983*    MOVE '&$ L                  ''   #00011346' TO DFHEIV0
 12984     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12985     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12986     MOVE X'2020233030303131333436' TO DFHEIV0(25:11)
 12987     CALL 'kxdfhei1' USING DFHEIV0,
 12988           ACTQ-FILE-ID,
 12989           ACTIVITY-QUE,
 12990           DFHEIV11,
 12991           AQ-CONTROL-PRIMARY,
 12992           DFHEIV99,
 12993           DFHEIV99
 12994     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12995
 12996
 12997 2440-EXIT.
 12998     EXIT.
 12999
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 242
* EL131.cbl
 13001 2460-UPDATE-CHECKQ.
 13002
 13003* EXEC CICS HANDLE CONDITION
 13004*         NOTFND   (2460-EXIT)
 13005*    END-EXEC.
 13006*    MOVE '"$I                   ! 9 #00011357' TO DFHEIV0
 13007     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13008     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13009     MOVE X'3920233030303131333537' TO DFHEIV0(25:11)
 13010     CALL 'kxdfhei1' USING DFHEIV0
 13011     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13012
 13013
 13014     MOVE AT-CHECK-QUE-CONTROL   TO CHKQ-CONTROL-NO.
 13015     MOVE AT-CHECK-QUE-SEQUENCE  TO CHKQ-SEQ-NO.
 13016     MOVE PI-COMPANY-CD          TO CHKQ-COMPANY-CODE.
 13017
 13018
 13019* EXEC CICS READ UPDATE
 13020*         DATASET   (CHKQ-FILE-ID)
 13021*         RIDFLD    (CHKQ-KEY)
 13022*         SET       (ADDRESS OF CHECK-QUE)
 13023*    END-EXEC.
 13024*    MOVE '&"S        EU         (   #00011365' TO DFHEIV0
 13025     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13026     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13027     MOVE X'2020233030303131333635' TO DFHEIV0(25:11)
 13028     CALL 'kxdfhei1' USING DFHEIV0,
 13029           CHKQ-FILE-ID,
 13030           DFHEIV20,
 13031           DFHEIV99,
 13032           CHKQ-KEY,
 13033           DFHEIV99,
 13034           DFHEIV99,
 13035           DFHEIV99
 13036     SET ADDRESS OF CHECK-QUE TO
 13037         DFHEIV20
 13038     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13039
 13040
 13041     IF CERTI GREATER THAN LOW-VALUES
 13042        MOVE CERTI               TO CQ-CERT-PRIME.
 13043     IF SUFXI GREATER THAN LOW-VALUES
 13044        MOVE SUFXI               TO CQ-CERT-SFX.
 13045     IF CERTCARI GREATER THAN LOW-VALUES
 13046        MOVE CERTCARI            TO CQ-CARRIER.
 13047
 13048
 13049* EXEC CICS REWRITE
 13050*         DATASET  (CHKQ-FILE-ID)
 13051*         FROM     (CHECK-QUE)
 13052*    END-EXEC.
 13053     MOVE LENGTH OF
 13054      CHECK-QUE
 13055       TO DFHEIV11
 13056*    MOVE '&& L                  %   #00011378' TO DFHEIV0
 13057     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13058     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 243
* EL131.cbl
 13059     MOVE X'2020233030303131333738' TO DFHEIV0(25:11)
 13060     CALL 'kxdfhei1' USING DFHEIV0,
 13061           CHKQ-FILE-ID,
 13062           CHECK-QUE,
 13063           DFHEIV11,
 13064           DFHEIV99
 13065     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13066
 13067
 13068 2460-EXIT.
 13069     EXIT.
 13070
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 244
* EL131.cbl
 13072 2475-UPDATE-LETTER.
 13073
 13074* EXEC CICS HANDLE CONDITION
 13075*         NOTFND   (2475-EXIT)
 13076*    END-EXEC.
 13077*    MOVE '"$I                   ! : #00011388' TO DFHEIV0
 13078     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13079     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13080     MOVE X'3A20233030303131333838' TO DFHEIV0(25:11)
 13081     CALL 'kxdfhei1' USING DFHEIV0
 13082     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13083
 13084
 13085     MOVE AT-LETTER-ARCHIVE-NO   TO ARCH-ARCHIVE-NO.
 13086     MOVE '1'                    TO ARCH-RECORD-TYPE.
 13087     MOVE ZEROS                  TO ARCH-SEQ-NO.
 13088     MOVE PI-COMPANY-CD          TO ARCH-COMPANY-CODE.
 13089
 13090
 13091* EXEC CICS READ UPDATE
 13092*         DATASET   (ARCH-FILE-ID)
 13093*         RIDFLD    (ARCH-KEY)
 13094*         SET       (ADDRESS OF LETTER-ARCHIVE)
 13095*    END-EXEC.
 13096*    MOVE '&"S        EU         (   #00011397' TO DFHEIV0
 13097     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13098     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13099     MOVE X'2020233030303131333937' TO DFHEIV0(25:11)
 13100     CALL 'kxdfhei1' USING DFHEIV0,
 13101           ARCH-FILE-ID,
 13102           DFHEIV20,
 13103           DFHEIV99,
 13104           ARCH-KEY,
 13105           DFHEIV99,
 13106           DFHEIV99,
 13107           DFHEIV99
 13108     SET ADDRESS OF LETTER-ARCHIVE TO
 13109         DFHEIV20
 13110     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13111
 13112
 13113* COMPARE LETTER HEADER INFORMATION TO ASSURE THAT IT BELONGS
 13114* TO THIS MASTER-KEY INFORMATION.
 13115
 13116     IF LA-CARRIER  = CARRIER-CODE AND
 13117        LA-CLAIM-NO = CLAIM-NO     AND
 13118        LA-CERT-NO  = CERT-NO
 13119        NEXT SENTENCE
 13120     ELSE
 13121        GO TO 2475-UNLOCK.
 13122
 13123     IF CERTI GREATER THAN LOW-VALUES
 13124        MOVE CERTI               TO LA-CERT-PRIME.
 13125     IF SUFXI GREATER THAN LOW-VALUES
 13126        MOVE SUFXI               TO LA-CERT-SFX.
 13127     IF CERTCARI GREATER THAN LOW-VALUES
 13128        MOVE CERTCARI            TO LA-CARRIER.
 13129
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 245
* EL131.cbl
 13130
 13131* EXEC CICS REWRITE
 13132*         DATASET  (ARCH-FILE-ID)
 13133*         FROM     (LETTER-ARCHIVE)
 13134*    END-EXEC.
 13135     MOVE LENGTH OF
 13136      LETTER-ARCHIVE
 13137       TO DFHEIV11
 13138*    MOVE '&& L                  %   #00011420' TO DFHEIV0
 13139     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13140     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13141     MOVE X'2020233030303131343230' TO DFHEIV0(25:11)
 13142     CALL 'kxdfhei1' USING DFHEIV0,
 13143           ARCH-FILE-ID,
 13144           LETTER-ARCHIVE,
 13145           DFHEIV11,
 13146           DFHEIV99
 13147     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13148
 13149
 13150     GO TO 2475-EXIT.
 13151
 13152 2475-UNLOCK.
 13153
 13154* EXEC CICS UNLOCK
 13155*         DATASET  (ARCH-FILE-ID)
 13156*    END-EXEC.
 13157*    MOVE '&*                    #   #00011428' TO DFHEIV0
 13158     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 13159     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13160     MOVE X'2020233030303131343238' TO DFHEIV0(25:11)
 13161     CALL 'kxdfhei1' USING DFHEIV0,
 13162           ARCH-FILE-ID,
 13163           DFHEIV99
 13164     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13165
 13166
 13167 2475-EXIT.
 13168     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 246
* EL131.cbl
 13170 2600-CREATE-MAINT-NOTE.
 13171     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
 13172     MOVE '1'                    TO CNTL-REC-TYPE.
 13173     MOVE SPACES                 TO CNTL-PROC-ID.
 13174     MOVE ZERO                   TO CNTL-SEQ-NO.
 13175
 13176
 13177* EXEC CICS READ
 13178*         SET        (ADDRESS OF CONTROL-FILE)
 13179*         DATASET    ('ELCNTL')
 13180*         RIDFLD     (CNTL-KEY)
 13181*    END-EXEC.
 13182     MOVE 'ELCNTL' TO DFHEIV1
 13183*    MOVE '&"S        E          (   #00011441' TO DFHEIV0
 13184     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13185     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13186     MOVE X'2020233030303131343431' TO DFHEIV0(25:11)
 13187     CALL 'kxdfhei1' USING DFHEIV0,
 13188           DFHEIV1,
 13189           DFHEIV20,
 13190           DFHEIV99,
 13191           CNTL-KEY,
 13192           DFHEIV99,
 13193           DFHEIV99,
 13194           DFHEIV99
 13195     SET ADDRESS OF CONTROL-FILE TO
 13196         DFHEIV20
 13197     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13198
 13199
 13200     IF CO-NO-USE-AUDIT-CHANGES
 13201         GO TO 2600-EXIT.
 13202
 13203     IF PROCL GREATER ZERO
 13204     IF PROCI NOT = LOW-VALUES
 13205     IF PROCI NOT = CL-PROCESSOR-ID
 13206         MOVE 'PROCESSOR'          TO SPLIT-INFO-DESC
 13207         MOVE CL-PROCESSOR-ID      TO SPLIT-INFO-OLD
 13208         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13209
 13210     IF SEXL GREATER ZERO
 13211     IF SEXI NOT = LOW-VALUES
 13212     IF SEXI NOT = CL-INSURED-SEX-CD
 13213         MOVE 'SEX'                TO SPLIT-INFO-DESC
 13214         MOVE CL-INSURED-SEX-CD    TO SPLIT-INFO-OLD
 13215         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13216
 13217     IF BIRTHL GREATER ZERO
 13218     IF HOLD-BIRTH NOT = LOW-VALUES
 13219     IF HOLD-BIRTH NOT = CL-INSURED-BIRTH-DT
 13220         MOVE 'BIRTH'              TO SPLIT-INFO-DESC
 13221         MOVE CL-INSURED-BIRTH-DT  TO DC-BIN-DATE-1
 13222         MOVE SPACES               TO DC-OPTION-CODE
 13223         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13224         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 13225         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13226
 13227     IF SOCIALL GREATER ZERO
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 247
* EL131.cbl
 13228     IF SOCIALI NOT = LOW-VALUES
 13229     IF SOCIALI NOT = CL-SOC-SEC-NO
 13230         MOVE 'SOC SEC NO'         TO SPLIT-INFO-DESC
 13231         MOVE CL-SOC-SEC-NO        TO SPLIT-INFO-OLD
 13232         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13233
 13234     IF OCCL GREATER ZERO
 13235     IF OCCI NOT = LOW-VALUES
 13236     IF OCCI NOT = CL-INSURED-OCC-CD
 13237         MOVE 'OCCUPATION'         TO SPLIT-INFO-DESC
 13238         MOVE CL-INSURED-OCC-CD    TO SPLIT-INFO-OLD
 13239         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13240
 13241     IF BENEL GREATER ZERO
 13242     IF BENEI NOT = LOW-VALUES
 13243     IF BENEI NOT = CL-BENEFICIARY
 13244         MOVE 'BENEFICIARY'        TO SPLIT-INFO-DESC
 13245         MOVE CL-BENEFICIARY      TO SPLIT-INFO-OLD
 13246         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13247
 13248     IF PREMTYPL GREATER ZERO
 13249     IF PREMTYPI NOT = LOW-VALUES
 13250     IF PREMTYPI NOT = CL-CLAIM-PREM-TYPE
 13251         MOVE 'PREM TYPE'          TO SPLIT-INFO-DESC
 13252         MOVE CL-CLAIM-PREM-TYPE   TO SPLIT-INFO-OLD
 13253         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13254
 13255*    IF CAUSEL GREATER ZERO
 13256*    IF CAUSEI NOT = LOW-VALUES
 13257*    IF CAUSEI NOT = CL-CAUSE-CD
 13258*        MOVE 'CAUSE CD'           TO SPLIT-INFO-DESC
 13259*        MOVE CL-CAUSE-CD          TO SPLIT-INFO-OLD
 13260*        PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13261
 13262*    IF ENDL GREATER ZERO
 13263*    IF HOLD-END NOT = LOW-VALUES
 13264*    IF HOLD-END NOT = CL-EST-END-OF-DISAB-DT
 13265*        MOVE 'END DT'             TO SPLIT-INFO-DESC
 13266*        MOVE CL-EST-END-OF-DISAB-DT
 13267*                                  TO DC-BIN-DATE-1
 13268*        MOVE SPACES               TO DC-OPTION-CODE
 13269*        PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13270*        MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 13271*        PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13272
 13273     IF PDTHRUL GREATER ZERO
 13274     IF HOLD-PDTHRU NOT = LOW-VALUES
 13275     IF HOLD-PDTHRU NOT = CL-PAID-THRU-DT
 13276         MOVE 'PAID THRU'          TO SPLIT-INFO-DESC
 13277         MOVE CL-PAID-THRU-DT      TO DC-BIN-DATE-1
 13278         MOVE SPACES               TO DC-OPTION-CODE
 13279         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13280         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 13281         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13282
 13283     IF PDAMTL GREATER ZERO
 13284     IF HOLD-PDAMT NOT = ZEROS
 13285     IF HOLD-PDAMT NOT = CL-TOTAL-PAID-AMT
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 248
* EL131.cbl
 13286         MOVE 'PAID AMOUNT'        TO SPLIT-INFO-DESC
 13287         MOVE CL-TOTAL-PAID-AMT    TO WS-EDIT-AMT
 13288         MOVE WS-EDIT-AMT          TO SPLIT-INFO-OLD
 13289         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13290
 13291     IF NODAYSL GREATER ZERO
 13292     IF HOLD-NODAYS NOT = ZEROS
 13293     IF HOLD-NODAYS NOT = CL-NO-OF-DAYS-PAID
 13294         MOVE 'DAYS PAID'          TO SPLIT-INFO-DESC
 13295         MOVE CL-NO-OF-DAYS-PAID   TO WS-EDIT-NUMBER
 13296         MOVE WS-EDIT-NUMBER       TO SPLIT-INFO-OLD
 13297         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13298
 13299     IF NOPMTSL GREATER ZERO
 13300     IF HOLD-NOPMTS NOT = ZEROS
 13301     IF HOLD-NOPMTS NOT = CL-NO-OF-PMTS-MADE
 13302         MOVE 'PMTS MADE'          TO SPLIT-INFO-DESC
 13303         MOVE CL-NO-OF-PMTS-MADE   TO WS-EDIT-NUMBER
 13304         MOVE WS-EDIT-NUMBER       TO SPLIT-INFO-OLD
 13305         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13306
 13307     IF FORMTYPL GREATER ZERO
 13308     IF FORMTYPI NOT = LOW-VALUES
 13309     IF FORMTYPI NOT = CL-PROG-FORM-TYPE
 13310         MOVE 'FORM TYPE'          TO SPLIT-INFO-DESC
 13311         MOVE CL-PROG-FORM-TYPE    TO SPLIT-INFO-OLD
 13312         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13313
 13314     IF REPL GREATER ZERO
 13315     IF HOLD-REPORTED NOT = LOW-VALUES
 13316     IF HOLD-REPORTED NOT = CL-REPORTED-DT
 13317         MOVE 'REPORTED DT'        TO SPLIT-INFO-DESC
 13318         MOVE CL-REPORTED-DT       TO DC-BIN-DATE-1
 13319         MOVE SPACES               TO DC-OPTION-CODE
 13320         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13321         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 13322         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13323
 13324     IF ADDONDTL GREATER ZERO
 13325     IF HOLD-ADDON NOT = LOW-VALUES
 13326     IF HOLD-ADDON NOT = CL-LAST-ADD-ON-DT
 13327         MOVE 'ADD ON DT'          TO SPLIT-INFO-DESC
 13328         MOVE CL-LAST-ADD-ON-DT    TO DC-BIN-DATE-1
 13329         MOVE SPACES               TO DC-OPTION-CODE
 13330         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13331         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 13332         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13333
 13334     IF PRICDL GREATER ZERO
 13335     IF PRICDI NOT = LOW-VALUES
 13336     IF PRICDI NOT = CL-PRIORITY-CD
 13337         MOVE 'PRIORITY CODE'      TO SPLIT-INFO-DESC
 13338         MOVE CL-PRIORITY-CD       TO SPLIT-INFO-OLD
 13339         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13340
 13341     IF FILETOL GREATER ZERO
 13342     IF FILETOI NOT = LOW-VALUES
 13343     IF FILETOI NOT = CL-FILE-LOCATION
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 249
* EL131.cbl
 13344         MOVE 'FILE TO'            TO SPLIT-INFO-DESC
 13345         MOVE CL-FILE-LOCATION     TO SPLIT-INFO-OLD
 13346         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13347
 13348     IF SUPVL GREATER ZERO
 13349     IF SUPVI NOT = LOW-VALUES
 13350     IF SUPVI NOT = CL-SUPV-ATTN-CD
 13351         MOVE 'SUPV (Y/N)'         TO SPLIT-INFO-DESC
 13352         MOVE CL-SUPV-ATTN-CD      TO SPLIT-INFO-OLD
 13353         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13354*    IF (CRITPTL > ZERO)
 13355*       AND (CRITPTI NOT = LOW-VALUES)
 13356*       AND (CRITPTI NOT = CL-CRIT-PER-RECURRENT)
 13357*       MOVE 'CRIT PER RECURR'   TO SPLIT-INFO-DESC
 13358*       MOVE CL-CRIT-PER-RECURRENT
 13359*                                TO SPLIT-INFO-OLD
 13360*       PERFORM 2650-WRITE-MAINT-NOTE
 13361*                                THRU 2650-EXIT
 13362*    END-IF
 13363
 13364*    IF (RTWMOSL > ZERO)
 13365*       AND (RTWMOSI NOT = LOW-VALUES)
 13366*       AND (RTWMOSI NOT = CL-CRIT-PER-RTW-MOS)
 13367*       MOVE 'CRIT PER RTW MO'   TO SPLIT-INFO-DESC
 13368*       MOVE CL-CRIT-PER-RTW-MOS TO SPLIT-INFO-OLD
 13369*       PERFORM 2650-WRITE-MAINT-NOTE
 13370*                                THRU 2650-EXIT
 13371*    END-IF
 13372     IF MLNAMEL GREATER ZERO
 13373     IF MLNAMEI NOT = LOW-VALUES
 13374     IF MLNAMEI NOT = CL-INSURED-LAST-NAME
 13375         MOVE 'INS LAST NAME'      TO SPLIT-INFO-DESC
 13376         MOVE CL-INSURED-LAST-NAME TO SPLIT-INFO-OLD
 13377         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13378
 13379     IF MFNAMEL GREATER ZERO
 13380     IF MFNAMEI NOT = LOW-VALUES
 13381     IF MFNAMEI NOT = CL-INSURED-1ST-NAME
 13382         MOVE 'INS 1ST NAME'       TO SPLIT-INFO-DESC
 13383         MOVE CL-INSURED-1ST-NAME  TO SPLIT-INFO-OLD
 13384         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13385
 13386     IF MMINITL GREATER ZERO
 13387     IF MMINITI NOT = LOW-VALUES
 13388     IF MMINITI NOT = CL-INSURED-MID-INIT
 13389         MOVE 'INS MID INITL'      TO SPLIT-INFO-DESC
 13390         MOVE CL-INSURED-MID-INIT  TO SPLIT-INFO-OLD
 13391         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13392
 13393     IF CERTEFFL GREATER ZERO
 13394     IF HOLD-EFF NOT = LOW-VALUES
 13395     IF HOLD-EFF NOT = CL-CERT-EFF-DT
 13396         MOVE 'CERT EFF DT'        TO SPLIT-INFO-DESC
 13397         MOVE CL-CERT-EFF-DT       TO DC-BIN-DATE-1
 13398         MOVE SPACES               TO DC-OPTION-CODE
 13399         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13400         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 13401         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 250
* EL131.cbl
 13402
 13403     IF CERTACTL GREATER ZERO
 13404     IF CERTACTI NOT = LOW-VALUES
 13405     IF CERTACTI NOT = CL-CERT-ACCOUNT
 13406         MOVE 'CERT ACCOUNT'       TO SPLIT-INFO-DESC
 13407         MOVE CL-CERT-ACCOUNT      TO SPLIT-INFO-OLD
 13408         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13409
 13410     IF CERTSTL GREATER ZERO
 13411     IF CERTSTI NOT = LOW-VALUES
 13412     IF CERTSTI NOT = CL-CERT-STATE
 13413         MOVE 'CERT STATE'         TO SPLIT-INFO-DESC
 13414         MOVE CL-CERT-STATE        TO SPLIT-INFO-OLD
 13415         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13416
 13417     IF CERTCARL GREATER ZERO
 13418     IF CERTCARI NOT = LOW-VALUES
 13419     IF CERTCARI NOT = CL-CERT-CARRIER
 13420         MOVE 'CERT CARRIER'       TO SPLIT-INFO-DESC
 13421         MOVE CL-CERT-CARRIER      TO SPLIT-INFO-OLD
 13422         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13423
 13424     IF CERTGRPL GREATER ZERO
 13425     IF CERTGRPI NOT = LOW-VALUES
 13426     IF CERTGRPI NOT = CL-CERT-GROUPING
 13427         MOVE 'CERT GROUPING'      TO SPLIT-INFO-DESC
 13428         MOVE CL-CERT-GROUPING     TO SPLIT-INFO-OLD
 13429         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13430
 13431     IF CERTL GREATER ZERO OR
 13432        SUFXL GREATER ZERO
 13433     IF (CERTI NOT = LOW-VALUES AND
 13434                     CL-CERT-PRIME)
 13435                OR
 13436        (SUFXI NOT = LOW-VALUES AND
 13437                     CL-CERT-SFX)
 13438         MOVE 'CERT NO'            TO SPLIT-INFO-DESC
 13439         MOVE CL-CERT-NO           TO SPLIT-INFO-OLD
 13440         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13441     IF incl > zeros
 13442        IF (HOLD-INCUR NOT = LOW-VALUES)
 13443           AND (HOLD-INCUR NOT = CL-INCURRED-DT)
 13444           MOVE 'INC DTE'        TO SPLIT-INFO-DESC
 13445           MOVE CL-INCURRED-DT   TO DC-BIN-DATE-1
 13446           MOVE SPACES           TO DC-OPTION-CODE
 13447           PERFORM 9800-CONVERT-DATE
 13448                                 THRU 9800-EXIT
 13449           MOVE DC-GREG-DATE-1-EDIT
 13450                                 TO SPLIT-INFO-OLD
 13451           PERFORM 2650-WRITE-MAINT-NOTE
 13452                                 THRU 2650-EXIT
 13453        END-IF
 13454     END-IF
 13455     IF PI-STATE = 'VA' OR 'PA' OR 'GA'
 13456       IF (REPL GREATER ZERO
 13457         AND HOLD-REPORTED NOT = LOW-VALUES
 13458         AND HOLD-REPORTED NOT = CL-REPORTED-DT)
 13459        OR (incl > zeros
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 251
* EL131.cbl
 13460          AND (HOLD-INCUR NOT = LOW-VALUES)
 13461             AND (HOLD-INCUR NOT = CL-INCURRED-DT))
 13462          PERFORM 2610-CHECK-2-YEAR-CONTESTABLE THRU 2610-EXIT
 13463       END-IF
 13464     END-IF
 13465     IF incl > zeros
 13466       AND PI-COMPANY-ID = 'CID'
 13467        IF (HOLD-INCUR NOT = LOW-VALUES)
 13468           AND (HOLD-INCUR NOT = CL-INCURRED-DT)
 13469           IF TYPEI = PI-AH-OVERRIDE-L1
 13470              SET ELAPSED-BETWEEN-BIN TO TRUE
 13471              MOVE ZERO               TO DC-ELAPSED-MONTHS
 13472                                         DC-ELAPSED-DAYS
 13473
 13474              MOVE HOLD-INCUR  TO DC-BIN-DATE-1
 13475              MOVE SAVE-BIN-DATE TO DC-BIN-DATE-2
 13476              PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13477              IF DC-ODD-DAYS-OVER > ZERO
 13478                 ADD 1 TO DC-ELAPSED-MONTHS
 13479              END-IF
 13480
 13481              IF PI-STATE = 'HI'
 13482                AND DC-ELAPSED-MONTHS <= 18
 13483                 CONTINUE
 13484              ELSE
 13485                 IF DC-ELAPSED-MONTHS > 15
 13486                    MOVE ER-7572            TO EMI-ERROR
 13487                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13488                 END-IF
 13489              END-IF
 13490              PERFORM 2620-CHECK-TRLR THRU 2620-EXIT
 13491           END-IF
 13492        END-IF
 13493     END-IF
 13494     .
 13495 2600-EXIT.
 13496      EXIT.
 13497 2610-CHECK-2-YEAR-CONTESTABLE.
 13498     SET ELAPSED-BETWEEN-BIN TO TRUE
 13499     MOVE ZERO               TO DC-ELAPSED-MONTHS
 13500                                DC-ELAPSED-DAYS
 13501
 13502     MOVE HOLD-EFF TO DC-BIN-DATE-1.
 13503     IF HOLD-INCUR > SPACES
 13504        MOVE HOLD-INCUR TO DC-BIN-DATE-2
 13505     ELSE
 13506        MOVE CL-INCURRED-DT TO DC-BIN-DATE-2
 13507     END-IF
 13508     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
 13509     IF DC-ODD-DAYS-OVER > ZERO
 13510        ADD 1 TO DC-ELAPSED-MONTHS
 13511     END-IF
 13512
 13513     IF DC-ELAPSED-MONTHS <= 24
 13514        IF HOLD-REPORTED > SPACES
 13515           MOVE HOLD-REPORTED TO DC-BIN-DATE-2
 13516        ELSE
 13517           MOVE CL-REPORTED-DT TO DC-BIN-DATE-2
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 252
* EL131.cbl
 13518        END-IF
 13519        MOVE ZERO           TO DC-ELAPSED-MONTHS
 13520                               DC-ELAPSED-DAYS
 13521        PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13522        IF DC-ODD-DAYS-OVER > ZERO
 13523           ADD 1 TO DC-ELAPSED-MONTHS
 13524        END-IF
 13525        IF DC-ELAPSED-MONTHS > 24
 13526           MOVE ER-1679            TO EMI-ERROR
 13527           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13528        ELSE
 13529           MOVE 1                  TO EMI-ERROR
 13530        END-IF
 13531     END-IF.
 13532
 13533     PERFORM 2615-CHECK-TRLR THRU 2615-EXIT.
 13534
 13535 2610-EXIT.
 13536     EXIT.
 13537 2615-CHECK-TRLR.
 13538
 13539     MOVE CL-CONTROL-PRIMARY   TO TRLR-KEY
 13540     MOVE +96              TO TRLR-SEQ-NO
 13541
 13542* EXEC CICS READ
 13543*       UPDATE
 13544*       DATASET  ('ELTRLR')
 13545*       SET      (ADDRESS OF ACTIVITY-TRAILERS)
 13546*       RIDFLD   (TRLR-KEY)
 13547*       RESP     (WS-RESPONSE)
 13548*    END-EXEC
 13549     MOVE 'ELTRLR' TO DFHEIV1
 13550*    MOVE '&"S        EU         (  N#00011788' TO DFHEIV0
 13551     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13552     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13553     MOVE X'204E233030303131373838' TO DFHEIV0(25:11)
 13554     CALL 'kxdfhei1' USING DFHEIV0,
 13555           DFHEIV1,
 13556           DFHEIV20,
 13557           DFHEIV99,
 13558           TRLR-KEY,
 13559           DFHEIV99,
 13560           DFHEIV99,
 13561           DFHEIV99
 13562     SET ADDRESS OF ACTIVITY-TRAILERS TO
 13563         DFHEIV20
 13564     MOVE EIBRESP  TO WS-RESPONSE
 13565     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13566     IF WS-RESP-NORMAL
 13567        IF EMI-ERROR =  ER-1679
 13568           IF EMI-ERROR-NUMBER(1) = ER-1679
 13569              MOVE EMI-LINE1 TO AT-INFO-LINE-1
 13570           ELSE
 13571           IF EMI-ERROR-NUMBER(2) = ER-1679
 13572              MOVE EMI-LINE2 TO AT-INFO-LINE-1
 13573           ELSE
 13574           IF EMI-ERROR-NUMBER(3) = ER-1679
 13575              MOVE EMI-LINE3 TO AT-INFO-LINE-1
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 253
* EL131.cbl
 13576           END-IF
 13577           END-IF
 13578           END-IF
 13579
 13580* EXEC CICS REWRITE
 13581*             DATASET   ('ELTRLR')
 13582*             FROM      (ACTIVITY-TRAILERS)
 13583*          END-EXEC
 13584     MOVE LENGTH OF
 13585      ACTIVITY-TRAILERS
 13586       TO DFHEIV11
 13587     MOVE 'ELTRLR' TO DFHEIV1
 13588*    MOVE '&& L                  %   #00011808' TO DFHEIV0
 13589     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13590     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13591     MOVE X'2020233030303131383038' TO DFHEIV0(25:11)
 13592     CALL 'kxdfhei1' USING DFHEIV0,
 13593           DFHEIV1,
 13594           ACTIVITY-TRAILERS,
 13595           DFHEIV11,
 13596           DFHEIV99
 13597     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13598        ELSE
 13599           IF EMI-ERROR = 1
 13600              MOVE WS-CONTEST-NOTE TO AT-INFO-LINE-1
 13601              MOVE ZERO TO EMI-ERROR
 13602
 13603* EXEC CICS REWRITE
 13604*                DATASET   ('ELTRLR')
 13605*                FROM      (ACTIVITY-TRAILERS)
 13606*             END-EXEC
 13607     MOVE LENGTH OF
 13608      ACTIVITY-TRAILERS
 13609       TO DFHEIV11
 13610     MOVE 'ELTRLR' TO DFHEIV1
 13611*    MOVE '&& L                  %   #00011816' TO DFHEIV0
 13612     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13613     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13614     MOVE X'2020233030303131383136' TO DFHEIV0(25:11)
 13615     CALL 'kxdfhei1' USING DFHEIV0,
 13616           DFHEIV1,
 13617           ACTIVITY-TRAILERS,
 13618           DFHEIV11,
 13619           DFHEIV99
 13620     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13621           ELSE
 13622
 13623* EXEC CICS DELETE
 13624*                DATASET   ('ELTRLR')
 13625*             END-EXEC
 13626     MOVE 'ELTRLR' TO DFHEIV1
 13627*    MOVE '&(                    &   #00011821' TO DFHEIV0
 13628     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13629     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13630     MOVE X'2020233030303131383231' TO DFHEIV0(25:11)
 13631     CALL 'kxdfhei1' USING DFHEIV0,
 13632           DFHEIV1,
 13633           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 254
* EL131.cbl
 13634           DFHEIV99,
 13635           DFHEIV99,
 13636           DFHEIV99
 13637     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13638           END-IF
 13639        END-IF
 13640     ELSE
 13641     IF EMI-ERROR =  ER-1679
 13642
 13643* EXEC CICS GETMAIN
 13644*          SET      (ADDRESS OF ACTIVITY-TRAILERS)
 13645*          LENGTH   (TRLR-LENGTH)
 13646*          INITIMG  (GETMAIN-SPACE)
 13647*       END-EXEC
 13648*    MOVE ',"IL                  $   #00011828' TO DFHEIV0
 13649     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13650     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13651     MOVE X'2020233030303131383238' TO DFHEIV0(25:11)
 13652     CALL 'kxdfhei1' USING DFHEIV0,
 13653           DFHEIV20,
 13654           TRLR-LENGTH,
 13655           GETMAIN-SPACE
 13656     SET ADDRESS OF ACTIVITY-TRAILERS TO
 13657         DFHEIV20
 13658     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13659        MOVE 'AT'          TO AT-RECORD-ID
 13660        MOVE CL-CONTROL-PRIMARY
 13661                           TO AT-CONTROL-PRIMARY
 13662        MOVE +96           TO AT-SEQUENCE-NO
 13663        MOVE '6'           TO AT-TRAILER-TYPE
 13664        MOVE SPACES             TO AT-GENERAL-INFO-TR
 13665        INITIALIZE AT-GENERAL-INFO-TR
 13666        IF EMI-ERROR-NUMBER(1) = ER-1679
 13667           MOVE EMI-LINE1 TO AT-INFO-LINE-1
 13668        ELSE
 13669        IF EMI-ERROR-NUMBER(2) = ER-1679
 13670           MOVE EMI-LINE2 TO AT-INFO-LINE-1
 13671        ELSE
 13672        IF EMI-ERROR-NUMBER(3) = ER-1679
 13673           MOVE EMI-LINE3 TO AT-INFO-LINE-1
 13674        END-IF
 13675        END-IF
 13676        END-IF
 13677        MOVE SPACE           TO AT-INFO-TRAILER-TYPE
 13678        MOVE SAVE-BIN-DATE TO AT-RECORDED-DT
 13679                              AT-GEN-INFO-LAST-MAINT-DT
 13680        MOVE PI-PROCESSOR-ID
 13681                           TO AT-RECORDED-BY
 13682                              AT-GEN-INFO-LAST-UPDATED-BY
 13683        MOVE EIBTIME       TO AT-LAST-MAINT-HHMMSS
 13684
 13685* EXEC CICS WRITE
 13686*          DATASET   ('ELTRLR')
 13687*          FROM      (ACTIVITY-TRAILERS)
 13688*          RIDFLD    (TRLR-KEY)
 13689*       END-EXEC
 13690     MOVE LENGTH OF
 13691      ACTIVITY-TRAILERS
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 255
* EL131.cbl
 13692       TO DFHEIV11
 13693     MOVE 'ELTRLR' TO DFHEIV1
 13694*    MOVE '&$ L                  ''   #00011858' TO DFHEIV0
 13695     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13696     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13697     MOVE X'2020233030303131383538' TO DFHEIV0(25:11)
 13698     CALL 'kxdfhei1' USING DFHEIV0,
 13699           DFHEIV1,
 13700           ACTIVITY-TRAILERS,
 13701           DFHEIV11,
 13702           TRLR-KEY,
 13703           DFHEIV99,
 13704           DFHEIV99
 13705     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13706     END-IF
 13707     END-IF
 13708     .
 13709 2615-EXIT.
 13710     EXIT.
 13711
 13712 2620-CHECK-TRLR.
 13713
 13714     MOVE CL-CONTROL-PRIMARY   TO TRLR-KEY
 13715     MOVE +97                  TO TRLR-SEQ-NO
 13716
 13717* EXEC CICS READ
 13718*       UPDATE
 13719*       DATASET  ('ELTRLR')
 13720*       SET      (ADDRESS OF ACTIVITY-TRAILERS)
 13721*       RIDFLD   (TRLR-KEY)
 13722*       RESP     (WS-RESPONSE)
 13723*    END-EXEC
 13724     MOVE 'ELTRLR' TO DFHEIV1
 13725*    MOVE '&"S        EU         (  N#00011873' TO DFHEIV0
 13726     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13727     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13728     MOVE X'204E233030303131383733' TO DFHEIV0(25:11)
 13729     CALL 'kxdfhei1' USING DFHEIV0,
 13730           DFHEIV1,
 13731           DFHEIV20,
 13732           DFHEIV99,
 13733           TRLR-KEY,
 13734           DFHEIV99,
 13735           DFHEIV99,
 13736           DFHEIV99
 13737     SET ADDRESS OF ACTIVITY-TRAILERS TO
 13738         DFHEIV20
 13739     MOVE EIBRESP  TO WS-RESPONSE
 13740     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13741     IF WS-RESP-NORMAL
 13742        IF EMI-ERROR =  ER-7572
 13743           MOVE WS-FILING-NOTE TO AT-INFO-LINE-1
 13744
 13745* EXEC CICS REWRITE
 13746*             DATASET   ('ELTRLR')
 13747*             FROM      (ACTIVITY-TRAILERS)
 13748*          END-EXEC
 13749     MOVE LENGTH OF
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 256
* EL131.cbl
 13750      ACTIVITY-TRAILERS
 13751       TO DFHEIV11
 13752     MOVE 'ELTRLR' TO DFHEIV1
 13753*    MOVE '&& L                  %   #00011883' TO DFHEIV0
 13754     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13755     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13756     MOVE X'2020233030303131383833' TO DFHEIV0(25:11)
 13757     CALL 'kxdfhei1' USING DFHEIV0,
 13758           DFHEIV1,
 13759           ACTIVITY-TRAILERS,
 13760           DFHEIV11,
 13761           DFHEIV99
 13762     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13763        ELSE
 13764           MOVE WS-FILE-LIM-NOTE TO AT-INFO-LINE-1
 13765
 13766* EXEC CICS REWRITE
 13767*                DATASET   ('ELTRLR')
 13768*                FROM      (ACTIVITY-TRAILERS)
 13769*             END-EXEC
 13770     MOVE LENGTH OF
 13771      ACTIVITY-TRAILERS
 13772       TO DFHEIV11
 13773     MOVE 'ELTRLR' TO DFHEIV1
 13774*    MOVE '&& L                  %   #00011889' TO DFHEIV0
 13775     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13776     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13777     MOVE X'2020233030303131383839' TO DFHEIV0(25:11)
 13778     CALL 'kxdfhei1' USING DFHEIV0,
 13779           DFHEIV1,
 13780           ACTIVITY-TRAILERS,
 13781           DFHEIV11,
 13782           DFHEIV99
 13783     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13784        END-IF
 13785     ELSE
 13786        IF EMI-ERROR =  ER-7572
 13787
 13788* EXEC CICS GETMAIN
 13789*             SET      (ADDRESS OF ACTIVITY-TRAILERS)
 13790*             LENGTH   (TRLR-LENGTH)
 13791*             INITIMG  (GETMAIN-SPACE)
 13792*          END-EXEC
 13793*    MOVE ',"IL                  $   #00011896' TO DFHEIV0
 13794     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13795     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13796     MOVE X'2020233030303131383936' TO DFHEIV0(25:11)
 13797     CALL 'kxdfhei1' USING DFHEIV0,
 13798           DFHEIV20,
 13799           TRLR-LENGTH,
 13800           GETMAIN-SPACE
 13801     SET ADDRESS OF ACTIVITY-TRAILERS TO
 13802         DFHEIV20
 13803     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13804           MOVE 'AT'          TO AT-RECORD-ID
 13805           MOVE CL-CONTROL-PRIMARY
 13806                              TO AT-CONTROL-PRIMARY
 13807           MOVE +97           TO AT-SEQUENCE-NO
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 257
* EL131.cbl
 13808           MOVE '6'           TO AT-TRAILER-TYPE
 13809           MOVE SPACES             TO AT-GENERAL-INFO-TR
 13810           INITIALIZE AT-GENERAL-INFO-TR
 13811           MOVE WS-FILING-NOTE TO AT-INFO-LINE-1
 13812           MOVE SPACE           TO AT-INFO-TRAILER-TYPE
 13813           MOVE SAVE-BIN-DATE TO AT-RECORDED-DT
 13814                                 AT-GEN-INFO-LAST-MAINT-DT
 13815           MOVE PI-PROCESSOR-ID
 13816                              TO AT-RECORDED-BY
 13817                                 AT-GEN-INFO-LAST-UPDATED-BY
 13818           MOVE EIBTIME       TO AT-LAST-MAINT-HHMMSS
 13819
 13820* EXEC CICS WRITE
 13821*             DATASET   ('ELTRLR')
 13822*             FROM      (ACTIVITY-TRAILERS)
 13823*             RIDFLD    (TRLR-KEY)
 13824*          END-EXEC
 13825     MOVE LENGTH OF
 13826      ACTIVITY-TRAILERS
 13827       TO DFHEIV11
 13828     MOVE 'ELTRLR' TO DFHEIV1
 13829*    MOVE '&$ L                  ''   #00011916' TO DFHEIV0
 13830     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13831     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13832     MOVE X'2020233030303131393136' TO DFHEIV0(25:11)
 13833     CALL 'kxdfhei1' USING DFHEIV0,
 13834           DFHEIV1,
 13835           ACTIVITY-TRAILERS,
 13836           DFHEIV11,
 13837           TRLR-KEY,
 13838           DFHEIV99,
 13839           DFHEIV99
 13840     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13841        END-IF
 13842     END-IF
 13843     .
 13844 2620-EXIT.
 13845     EXIT.
 13846
 13847 2650-WRITE-MAINT-NOTE.
 13848
 13849* EXEC CICS GETMAIN
 13850*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 13851*         LENGTH   (TRLR-LENGTH)
 13852*         INITIMG  (GETMAIN-SPACE)
 13853*    END-EXEC.
 13854*    MOVE ',"IL                  $   #00011928' TO DFHEIV0
 13855     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13856     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13857     MOVE X'2020233030303131393238' TO DFHEIV0(25:11)
 13858     CALL 'kxdfhei1' USING DFHEIV0,
 13859           DFHEIV20,
 13860           TRLR-LENGTH,
 13861           GETMAIN-SPACE
 13862     SET ADDRESS OF ACTIVITY-TRAILERS TO
 13863         DFHEIV20
 13864     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13865
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 258
* EL131.cbl
 13866
 13867
 13868* EXEC CICS HANDLE CONDITION
 13869*         DUPREC   (2650-EXIT)
 13870*    END-EXEC.
 13871*    MOVE '"$%                   ! ; #00011934' TO DFHEIV0
 13872     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 13873     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13874     MOVE X'3B20233030303131393334' TO DFHEIV0(25:11)
 13875     CALL 'kxdfhei1' USING DFHEIV0
 13876     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13877
 13878
 13879     MOVE SPACES             TO ACTIVITY-TRAILERS.
 13880
 13881     IF CERTL GREATER ZERO
 13882         MOVE CERTI          TO CL-CERT-PRIME.
 13883
 13884     IF SUFXL GREATER ZERO
 13885         MOVE SUFXI          TO CL-CERT-SFX.
 13886
 13887     MOVE CL-CONTROL-PRIMARY TO AT-CONTROL-PRIMARY.
 13888
 13889     SUBTRACT 1 FROM  CL-TRAILER-SEQ-CNT.
 13890     MOVE CL-TRAILER-SEQ-CNT TO AT-SEQUENCE-NO.
 13891
 13892     MOVE 'AT'               TO AT-RECORD-ID.
 13893
 13894     MOVE '6'                TO AT-TRAILER-TYPE.
 13895     MOVE SAVE-BIN-DATE      TO AT-RECORDED-DT
 13896                                AT-GEN-INFO-LAST-MAINT-DT.
 13897     MOVE PI-PROCESSOR-ID    TO AT-RECORDED-BY
 13898                                AT-GEN-INFO-LAST-UPDATED-BY.
 13899     MOVE EIBTIME            TO AT-LAST-MAINT-HHMMSS.
 13900     MOVE SPLIT-INFO-LINE-1  TO AT-INFO-LINE-1.
 13901     MOVE 'M'                TO AT-INFO-TRAILER-TYPE.
 13902
 13903
 13904* EXEC CICS WRITE
 13905*         DATASET  (TRLR-FILE-ID)
 13906*         RIDFLD   (AT-CONTROL-PRIMARY)
 13907*         FROM     (ACTIVITY-TRAILERS)
 13908*    END-EXEC.
 13909     MOVE LENGTH OF
 13910      ACTIVITY-TRAILERS
 13911       TO DFHEIV11
 13912*    MOVE '&$ L                  ''   #00011962' TO DFHEIV0
 13913     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13914     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13915     MOVE X'2020233030303131393632' TO DFHEIV0(25:11)
 13916     CALL 'kxdfhei1' USING DFHEIV0,
 13917           TRLR-FILE-ID,
 13918           ACTIVITY-TRAILERS,
 13919           DFHEIV11,
 13920           AT-CONTROL-PRIMARY,
 13921           DFHEIV99,
 13922           DFHEIV99
 13923     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 259
* EL131.cbl
 13924
 13925
 13926 2650-EXIT.
 13927      EXIT.
 13928
 13929 2800-CHECK-AUTO-PAY.
 13930
 13931     MOVE PI-COMPANY-CD      TO TRLR-COMPANY-CD.
 13932     MOVE PI-CARRIER         TO TRLR-CARRIER.
 13933     MOVE PI-CLAIM-NO        TO TRLR-CLAIM-NO.
 13934     MOVE PI-CERT-NO         TO TRLR-CERT-NO.
 13935     MOVE PI-AUTO-PAY-SEQ    TO TRLR-SEQ-NO.
 13936
 13937
 13938* EXEC CICS HANDLE CONDITION
 13939*         NOTFND    (2800-EXIT)
 13940*         ENDFILE   (2800-EXIT)
 13941*    END-EXEC.
 13942*    MOVE '"$I''                  ! < #00011979' TO DFHEIV0
 13943     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 13944     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13945     MOVE X'3C20233030303131393739' TO DFHEIV0(25:11)
 13946     CALL 'kxdfhei1' USING DFHEIV0
 13947     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13948
 13949
 13950
 13951* EXEC CICS READ
 13952*        DATASET (TRLR-FILE-ID)
 13953*        SET     (ADDRESS OF ACTIVITY-TRAILERS)
 13954*        RIDFLD  (TRLR-KEY)
 13955*    END-EXEC.
 13956*    MOVE '&"S        E          (   #00011984' TO DFHEIV0
 13957     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13958     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13959     MOVE X'2020233030303131393834' TO DFHEIV0(25:11)
 13960     CALL 'kxdfhei1' USING DFHEIV0,
 13961           TRLR-FILE-ID,
 13962           DFHEIV20,
 13963           DFHEIV99,
 13964           TRLR-KEY,
 13965           DFHEIV99,
 13966           DFHEIV99,
 13967           DFHEIV99
 13968     SET ADDRESS OF ACTIVITY-TRAILERS TO
 13969         DFHEIV20
 13970     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13971
 13972
 13973     IF BENEFICIARY-PAID-AUTO
 13974         MOVE 'Y'              TO AUTO-PAY-TO-BENE
 13975     END-IF.
 13976
 13977 2800-EXIT.
 13978      EXIT.
 13979
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 260
* EL131.cbl
 13981 3000-DELETE-CLAIM.
 13982     IF  NOT MODIFY-CAP
 13983         MOVE ER-0070            TO EMI-ERROR
 13984         MOVE -1                 TO MAINTL
 13985         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13986         GO TO 8110-SEND-DATA.
 13987
 13988
 13989* EXEC CICS READ
 13990*         SET      (ADDRESS OF CLAIM-MASTER)
 13991*         DATASET  (CLMS-FILE-ID)
 13992*         RIDFLD   (MSTR-KEY)
 13993*    END-EXEC.
 13994*    MOVE '&"S        E          (   #00012005' TO DFHEIV0
 13995     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13996     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13997     MOVE X'2020233030303132303035' TO DFHEIV0(25:11)
 13998     CALL 'kxdfhei1' USING DFHEIV0,
 13999           CLMS-FILE-ID,
 14000           DFHEIV20,
 14001           DFHEIV99,
 14002           MSTR-KEY,
 14003           DFHEIV99,
 14004           DFHEIV99,
 14005           DFHEIV99
 14006     SET ADDRESS OF CLAIM-MASTER TO
 14007         DFHEIV20
 14008     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14009
 14010
 14011     IF CL-1ST-TRL-AVAIL
 14012         PERFORM 3010-DEL-MSTR-TRLR THRU 3010-EXIT
 14013     ELSE
 14014        MOVE MSTR-KEY            TO TRLR-MAIN-KEY
 14015        MOVE 0                   TO TRLR-SEQ-NO
 14016
 14017* EXEC CICS STARTBR
 14018*            DATASET (TRLR-FILE-ID)
 14019*            RIDFLD  (TRLR-KEY)
 14020*        END-EXEC
 14021     MOVE 0
 14022       TO DFHEIV11
 14023*    MOVE '&,         G          &   #00012016' TO DFHEIV0
 14024     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 14025     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14026     MOVE X'2020233030303132303136' TO DFHEIV0(25:11)
 14027     CALL 'kxdfhei1' USING DFHEIV0,
 14028           TRLR-FILE-ID,
 14029           TRLR-KEY,
 14030           DFHEIV99,
 14031           DFHEIV11,
 14032           DFHEIV99
 14033     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14034         PERFORM 3060-READ-TRLR THRU 3060-EXIT
 14035
 14036* EXEC CICS ENDBR
 14037*            DATASET (TRLR-FILE-ID)
 14038*        END-EXEC
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 261
* EL131.cbl
 14039     MOVE 0
 14040       TO DFHEIV11
 14041*    MOVE '&2                    $   #00012021' TO DFHEIV0
 14042     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 14043     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14044     MOVE X'2020233030303132303231' TO DFHEIV0(25:11)
 14045     CALL 'kxdfhei1' USING DFHEIV0,
 14046           TRLR-FILE-ID,
 14047           DFHEIV11,
 14048           DFHEIV99
 14049     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14050        IF SCREEN-ERROR
 14051            MOVE ER-0208         TO EMI-ERROR
 14052            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14053            MOVE -1              TO MAINTL
 14054            GO TO 8110-SEND-DATA
 14055        ELSE
 14056            PERFORM 3010-DEL-MSTR-TRLR THRU 3010-EXIT.
 14057
 14058     IF SCREEN-ERROR
 14059         MOVE -1                 TO MAINTL
 14060         GO TO 8110-SEND-DATA.
 14061
 14062     MOVE -1                     TO ONE-OR-MIN1.
 14063     PERFORM 7700-CHECK-SEQUENCE THRU 7799-EXIT.
 14064
 14065     IF WS-ASSOC-CERT-TOTAL NOT = ZERO
 14066         MOVE CL-CONTROL-PRIMARY TO MSTR-KEY
 14067                                    WS-SAVE-CLAIM-KEY
 14068         MOVE +1                 TO ONE-OR-MIN1
 14069         PERFORM 7710-RESEQUENCE-CLAIMS THRU 7799-EXIT.
 14070
 14071     MOVE 'D'                    TO PI-CLAIM-DELETED-SWITCH.
 14072
 14073     MOVE LOW-VALUES             TO EL131AO.
 14074     MOVE ER-0000                TO EMI-ERROR.
 14075     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14076     MOVE 'X'                    TO PI-RETURN-CD-1.
 14077     MOVE -1                     TO MAINTL.
 14078     GO TO 8100-SEND-MAP.
 14079
 14080 3010-DEL-MSTR-TRLR.
 14081
 14082* EXEC CICS READ UPDATE
 14083*         SET       (ADDRESS OF CLAIM-MASTER)
 14084*         DATASET   (CLMS-FILE-ID)
 14085*         RIDFLD    (MSTR-KEY)
 14086*    END-EXEC.
 14087*    MOVE '&"S        EU         (   #00012055' TO DFHEIV0
 14088     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14089     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14090     MOVE X'2020233030303132303535' TO DFHEIV0(25:11)
 14091     CALL 'kxdfhei1' USING DFHEIV0,
 14092           CLMS-FILE-ID,
 14093           DFHEIV20,
 14094           DFHEIV99,
 14095           MSTR-KEY,
 14096           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 262
* EL131.cbl
 14097           DFHEIV99,
 14098           DFHEIV99
 14099     SET ADDRESS OF CLAIM-MASTER TO
 14100         DFHEIV20
 14101     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14102
 14103
 14104     if (cl-priority-cd = '8')
 14105        and (pi-processor-id not = 'PEMA' and 'JMS '
 14106             AND 'AMWA')
 14107        MOVE ER-8003             TO EMI-ERROR
 14108        PERFORM 9900-ERROR-FORMAT
 14109                                 THRU 9900-EXIT
 14110        MOVE -1                  TO MAINTL
 14111        GO TO 8110-SEND-DATA
 14112     end-if
 14113
 14114     MOVE MSTR-KEY               TO TRLR-MAIN-KEY ACTQ-KEY.
 14115     MOVE ZERO                   TO TRLR-SEQ-NO.
 14116
 14117
 14118* EXEC CICS HANDLE CONDITION
 14119*         NOTFND    (3010-DEL-ACTQ)
 14120*         ENDFILE   (3040-EXIT)
 14121*    END-EXEC.
 14122*    MOVE '"$I''                  ! = #00012074' TO DFHEIV0
 14123     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 14124     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14125     MOVE X'3D20233030303132303734' TO DFHEIV0(25:11)
 14126     CALL 'kxdfhei1' USING DFHEIV0
 14127     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14128
 14129
 14130     PERFORM 3040-DELETE-TRLR THRU 3040-EXIT.
 14131
 14132 3010-DEL-ACTQ.
 14133
 14134
 14135* EXEC CICS HANDLE CONDITION
 14136*         NOTFND    (3010-NO-ACTIVITY)
 14137*         ENDFILE   (3050-EXIT)
 14138*    END-EXEC.
 14139*    MOVE '"$I''                  ! > #00012083' TO DFHEIV0
 14140     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 14141     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14142     MOVE X'3E20233030303132303833' TO DFHEIV0(25:11)
 14143     CALL 'kxdfhei1' USING DFHEIV0
 14144     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14145
 14146
 14147
 14148* EXEC CICS STARTBR
 14149*         DATASET  (ACTQ-FILE-ID)
 14150*         RIDFLD   (ACTQ-KEY)
 14151*    END-EXEC.
 14152     MOVE 0
 14153       TO DFHEIV11
 14154*    MOVE '&,         G          &   #00012088' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 263
* EL131.cbl
 14155     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 14156     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14157     MOVE X'2020233030303132303838' TO DFHEIV0(25:11)
 14158     CALL 'kxdfhei1' USING DFHEIV0,
 14159           ACTQ-FILE-ID,
 14160           ACTQ-KEY,
 14161           DFHEIV99,
 14162           DFHEIV11,
 14163           DFHEIV99
 14164     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14165
 14166
 14167
 14168* EXEC CICS GETMAIN
 14169*         SET      (ADDRESS OF ACTIVITY-QUE)
 14170*         LENGTH   (ACTQ-LENGTH)
 14171*         INITIMG  (GETMAIN-SPACE)
 14172*    END-EXEC.
 14173*    MOVE ',"IL                  $   #00012093' TO DFHEIV0
 14174     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 14175     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14176     MOVE X'2020233030303132303933' TO DFHEIV0(25:11)
 14177     CALL 'kxdfhei1' USING DFHEIV0,
 14178           DFHEIV20,
 14179           ACTQ-LENGTH,
 14180           GETMAIN-SPACE
 14181     SET ADDRESS OF ACTIVITY-QUE TO
 14182         DFHEIV20
 14183     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14184
 14185
 14186     PERFORM 3050-DELETE-ACTQ THRU 3050-EXIT.
 14187
 14188
 14189* EXEC CICS ENDBR
 14190*         DATASET (ACTQ-FILE-ID)
 14191*    END-EXEC.
 14192     MOVE 0
 14193       TO DFHEIV11
 14194*    MOVE '&2                    $   #00012101' TO DFHEIV0
 14195     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 14196     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14197     MOVE X'2020233030303132313031' TO DFHEIV0(25:11)
 14198     CALL 'kxdfhei1' USING DFHEIV0,
 14199           ACTQ-FILE-ID,
 14200           DFHEIV11,
 14201           DFHEIV99
 14202     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14203
 14204
 14205 3010-NO-ACTIVITY.
 14206
 14207
 14208* EXEC CICS HANDLE CONDITION
 14209*        NOTFND   (3010-CERT-NOT-FOUND)
 14210*    END-EXEC.
 14211*    MOVE '"$I                   ! ? #00012107' TO DFHEIV0
 14212     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 264
* EL131.cbl
 14213     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14214     MOVE X'3F20233030303132313037' TO DFHEIV0(25:11)
 14215     CALL 'kxdfhei1' USING DFHEIV0
 14216     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14217
 14218
 14219     MOVE CL-COMPANY-CD          TO CERT-COMPANY-CODE.
 14220     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
 14221     MOVE CL-CERT-GROUPING       TO CERT-GROUP.
 14222     MOVE CL-CERT-STATE          TO CERT-STATE.
 14223     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
 14224     MOVE CL-CERT-EFF-DT         TO CERT-DATE.
 14225     MOVE CL-CERT-NO             TO CERT-CERT.
 14226
 14227
 14228* EXEC CICS READ
 14229*        DATASET   (CERT-FILE-ID)
 14230*        RIDFLD    (CERT-KEY)
 14231*        SET       (ADDRESS OF CERTIFICATE-MASTER)
 14232*    END-EXEC.
 14233*    MOVE '&"S        E          (   #00012119' TO DFHEIV0
 14234     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14235     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14236     MOVE X'2020233030303132313139' TO DFHEIV0(25:11)
 14237     CALL 'kxdfhei1' USING DFHEIV0,
 14238           CERT-FILE-ID,
 14239           DFHEIV20,
 14240           DFHEIV99,
 14241           CERT-KEY,
 14242           DFHEIV99,
 14243           DFHEIV99,
 14244           DFHEIV99
 14245     SET ADDRESS OF CERTIFICATE-MASTER TO
 14246         DFHEIV20
 14247     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14248
 14249
 14250     IF CERT-WAS-CREATED AND CM-CLAIM-ATTACHED-COUNT = 1
 14251       AND PI-COMPANY-ID NOT EQUAL 'AHL'
 14252         PERFORM 3030-DELETE-CERT THRU 3030-EXIT
 14253     ELSE
 14254         PERFORM 3020-UPDATE-CERT THRU 3020-EXIT.
 14255
 14256 3010-UPDATE-CERT-TRLR.
 14257
 14258     MOVE CERT-KEY               TO ELCRTT-KEY
 14259     MOVE 'B'                    TO CTRLR-REC-TYPE
 14260
 14261* EXEC CICS READ
 14262*       UPDATE
 14263*       DATASET   ('ELCRTT')
 14264*       RIDFLD    (ELCRTT-KEY)
 14265*       INTO      (CERTIFICATE-TRAILERS)
 14266*       RESP      (WS-RESPONSE)
 14267*    END-EXEC
 14268     MOVE LENGTH OF
 14269      CERTIFICATE-TRAILERS
 14270       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 265
* EL131.cbl
 14271     MOVE 'ELCRTT' TO DFHEIV1
 14272*    MOVE '&"IL       EU         (  N#00012135' TO DFHEIV0
 14273     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 14274     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14275     MOVE X'204E233030303132313335' TO DFHEIV0(25:11)
 14276     CALL 'kxdfhei1' USING DFHEIV0,
 14277           DFHEIV1,
 14278           CERTIFICATE-TRAILERS,
 14279           DFHEIV11,
 14280           ELCRTT-KEY,
 14281           DFHEIV99,
 14282           DFHEIV99,
 14283           DFHEIV99
 14284     MOVE EIBRESP  TO WS-RESPONSE
 14285     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14286     IF WS-RESP-NORMAL
 14287        perform varying s1 from +1 by +1 until
 14288           (s1 > +24)
 14289           or (cs-claim-no (s1) = cl-claim-no)
 14290        end-perform
 14291        if s1 < +25
 14292           move spaces           to cs-claim-no (s1)
 14293                                    cs-claim-type (s1)
 14294                                    cs-insured-type (s1)
 14295           move zeros            to cs-days-paid (s1)
 14296                                    cs-total-paid (s1)
 14297                                    cs-benefit-period (s1)
 14298           if s1 not = +24
 14299              compute s2 = s1 + +1
 14300              perform 3015-bump  thru 3015-exit
 14301           end-if
 14302
 14303* EXEC CICS REWRITE
 14304*             DATASET   ('ELCRTT')
 14305*             FROM      (CERTIFICATE-TRAILERS)
 14306*          END-EXEC
 14307     MOVE LENGTH OF
 14308      CERTIFICATE-TRAILERS
 14309       TO DFHEIV11
 14310     MOVE 'ELCRTT' TO DFHEIV1
 14311*    MOVE '&& L                  %   #00012158' TO DFHEIV0
 14312     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 14313     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 14314     MOVE X'2020233030303132313538' TO DFHEIV0(25:11)
 14315     CALL 'kxdfhei1' USING DFHEIV0,
 14316           DFHEIV1,
 14317           CERTIFICATE-TRAILERS,
 14318           DFHEIV11,
 14319           DFHEIV99
 14320     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14321        end-if
 14322     end-if
 14323     .
 14324 3010-CERT-NOT-FOUND.
 14325
 14326
 14327* EXEC CICS DELETE
 14328*        DATASET  (CLMS-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 266
* EL131.cbl
 14329*    END-EXEC.
 14330*    MOVE '&(                    &   #00012167' TO DFHEIV0
 14331     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 14332     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14333     MOVE X'2020233030303132313637' TO DFHEIV0(25:11)
 14334     CALL 'kxdfhei1' USING DFHEIV0,
 14335           CLMS-FILE-ID,
 14336           DFHEIV99,
 14337           DFHEIV99,
 14338           DFHEIV99,
 14339           DFHEIV99
 14340     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14341
 14342
 14343 3010-EXIT.
 14344      EXIT.
 14345
 14346 3015-bump.
 14347     perform varying s2 from s2 by +1 until s2 > +24
 14348        move cs-mb-claim-data (s2)
 14349                                 to cs-mb-claim-data (s1)
 14350        move spaces              to cs-mb-claim-data (s2)
 14351        add +1 to s1
 14352     end-perform
 14353     .
 14354 3015-exit.
 14355     exit.
 14356 3020-UPDATE-CERT.
 14357
 14358* EXEC CICS READ UPDATE
 14359*         DATASET  (CERT-FILE-ID)
 14360*         RIDFLD   (CERT-KEY)
 14361*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 14362*    END-EXEC.
 14363*    MOVE '&"S        EU         (   #00012185' TO DFHEIV0
 14364     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14365     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14366     MOVE X'2020233030303132313835' TO DFHEIV0(25:11)
 14367     CALL 'kxdfhei1' USING DFHEIV0,
 14368           CERT-FILE-ID,
 14369           DFHEIV20,
 14370           DFHEIV99,
 14371           CERT-KEY,
 14372           DFHEIV99,
 14373           DFHEIV99,
 14374           DFHEIV99
 14375     SET ADDRESS OF CERTIFICATE-MASTER TO
 14376         DFHEIV20
 14377     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14378
 14379
 14380     SUBTRACT 1       FROM CM-CLAIM-ATTACHED-COUNT.
 14381
 14382
 14383* EXEC CICS HANDLE CONDITION
 14384*         DUPKEY   (3020-EXIT)
 14385*    END-EXEC.
 14386*    MOVE '"$$                   ! @ #00012193' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 267
* EL131.cbl
 14387     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 14388     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14389     MOVE X'4020233030303132313933' TO DFHEIV0(25:11)
 14390     CALL 'kxdfhei1' USING DFHEIV0
 14391     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14392
 14393
 14394
 14395* EXEC CICS REWRITE
 14396*         DATASET  (CERT-FILE-ID)
 14397*         FROM     (CERTIFICATE-MASTER)
 14398*    END-EXEC.
 14399     MOVE LENGTH OF
 14400      CERTIFICATE-MASTER
 14401       TO DFHEIV11
 14402*    MOVE '&& L                  %   #00012197' TO DFHEIV0
 14403     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 14404     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 14405     MOVE X'2020233030303132313937' TO DFHEIV0(25:11)
 14406     CALL 'kxdfhei1' USING DFHEIV0,
 14407           CERT-FILE-ID,
 14408           CERTIFICATE-MASTER,
 14409           DFHEIV11,
 14410           DFHEIV99
 14411     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14412
 14413
 14414 3020-EXIT.
 14415     EXIT.
 14416
 14417 3030-DELETE-CERT.
 14418
 14419* EXEC CICS READ UPDATE
 14420*         DATASET  (CERT-FILE-ID)
 14421*         RIDFLD   (CERT-KEY)
 14422*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 14423*    END-EXEC.
 14424*    MOVE '&"S        EU         (   #00012206' TO DFHEIV0
 14425     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14426     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14427     MOVE X'2020233030303132323036' TO DFHEIV0(25:11)
 14428     CALL 'kxdfhei1' USING DFHEIV0,
 14429           CERT-FILE-ID,
 14430           DFHEIV20,
 14431           DFHEIV99,
 14432           CERT-KEY,
 14433           DFHEIV99,
 14434           DFHEIV99,
 14435           DFHEIV99
 14436     SET ADDRESS OF CERTIFICATE-MASTER TO
 14437         DFHEIV20
 14438     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14439
 14440
 14441
 14442* EXEC CICS DELETE
 14443*         DATASET   (CERT-FILE-ID)
 14444*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 268
* EL131.cbl
 14445*    MOVE '&(                    &   #00012212' TO DFHEIV0
 14446     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 14447     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14448     MOVE X'2020233030303132323132' TO DFHEIV0(25:11)
 14449     CALL 'kxdfhei1' USING DFHEIV0,
 14450           CERT-FILE-ID,
 14451           DFHEIV99,
 14452           DFHEIV99,
 14453           DFHEIV99,
 14454           DFHEIV99
 14455     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14456
 14457
 14458 3030-EXIT.
 14459     EXIT.
 14460
 14461 3040-DELETE-TRLR.
 14462
 14463* EXEC CICS READ
 14464*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 14465*         DATASET  (TRLR-FILE-ID)
 14466*         RIDFLD   (TRLR-KEY)
 14467*         GTEQ
 14468*    END-EXEC.
 14469*    MOVE '&"S        G          (   #00012220' TO DFHEIV0
 14470     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 14471     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14472     MOVE X'2020233030303132323230' TO DFHEIV0(25:11)
 14473     CALL 'kxdfhei1' USING DFHEIV0,
 14474           TRLR-FILE-ID,
 14475           DFHEIV20,
 14476           DFHEIV99,
 14477           TRLR-KEY,
 14478           DFHEIV99,
 14479           DFHEIV99,
 14480           DFHEIV99
 14481     SET ADDRESS OF ACTIVITY-TRAILERS TO
 14482         DFHEIV20
 14483     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14484
 14485
 14486     IF PI-COMPANY-CD = AT-COMPANY-CD
 14487        MOVE AT-CONTROL-PRIMARY  TO TRLR-KEY
 14488        IF TRLR-MAIN-KEY GREATER THAN CL-CONTROL-PRIMARY
 14489           GO TO 3040-EXIT
 14490        ELSE
 14491           NEXT SENTENCE
 14492     ELSE
 14493        GO TO 3040-EXIT.
 14494
 14495
 14496* EXEC CICS DELETE
 14497*         DATASET  (TRLR-FILE-ID)
 14498*         RIDFLD   (TRLR-KEY)
 14499*    END-EXEC.
 14500*    MOVE '&(  R                 &   #00012236' TO DFHEIV0
 14501     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
 14502     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 269
* EL131.cbl
 14503     MOVE X'2020233030303132323336' TO DFHEIV0(25:11)
 14504     CALL 'kxdfhei1' USING DFHEIV0,
 14505           TRLR-FILE-ID,
 14506           TRLR-KEY,
 14507           DFHEIV99,
 14508           DFHEIV99,
 14509           DFHEIV99
 14510     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14511
 14512
 14513     GO TO 3040-DELETE-TRLR.
 14514
 14515 3040-EXIT.
 14516     EXIT.
 14517
 14518 3050-DELETE-ACTQ.
 14519
 14520* EXEC CICS READNEXT
 14521*         DATASET  (ACTQ-FILE-ID)
 14522*         RIDFLD   (ACTQ-KEY)
 14523*         INTO     (ACTIVITY-QUE)
 14524*    END-EXEC.
 14525     MOVE LENGTH OF
 14526      ACTIVITY-QUE
 14527       TO DFHEIV12
 14528     MOVE 0
 14529       TO DFHEIV11
 14530*    MOVE '&.IL                  )   #00012247' TO DFHEIV0
 14531     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 14532     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 14533     MOVE X'2020233030303132323437' TO DFHEIV0(25:11)
 14534     CALL 'kxdfhei1' USING DFHEIV0,
 14535           ACTQ-FILE-ID,
 14536           ACTIVITY-QUE,
 14537           DFHEIV12,
 14538           ACTQ-KEY,
 14539           DFHEIV99,
 14540           DFHEIV11,
 14541           DFHEIV99,
 14542           DFHEIV99
 14543     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14544
 14545
 14546     IF ACTQ-KEY GREATER THAN CL-CONTROL-PRIMARY
 14547         GO TO 3050-EXIT.
 14548
 14549
 14550* EXEC CICS ENDBR
 14551*         DATASET  (ACTQ-FILE-ID)
 14552*    END-EXEC.
 14553     MOVE 0
 14554       TO DFHEIV11
 14555*    MOVE '&2                    $   #00012256' TO DFHEIV0
 14556     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 14557     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14558     MOVE X'2020233030303132323536' TO DFHEIV0(25:11)
 14559     CALL 'kxdfhei1' USING DFHEIV0,
 14560           ACTQ-FILE-ID,
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 270
* EL131.cbl
 14561           DFHEIV11,
 14562           DFHEIV99
 14563     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14564
 14565
 14566
 14567* EXEC CICS DELETE
 14568*         DATASET   (ACTQ-FILE-ID)
 14569*         RIDFLD    (ACTQ-KEY)
 14570*    END-EXEC.
 14571*    MOVE '&(  R                 &   #00012260' TO DFHEIV0
 14572     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
 14573     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14574     MOVE X'2020233030303132323630' TO DFHEIV0(25:11)
 14575     CALL 'kxdfhei1' USING DFHEIV0,
 14576           ACTQ-FILE-ID,
 14577           ACTQ-KEY,
 14578           DFHEIV99,
 14579           DFHEIV99,
 14580           DFHEIV99
 14581     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14582
 14583
 14584
 14585* EXEC CICS STARTBR
 14586*         DATASET   (ACTQ-FILE-ID)
 14587*         RIDFLD    (ACTQ-KEY)
 14588*    END-EXEC.
 14589     MOVE 0
 14590       TO DFHEIV11
 14591*    MOVE '&,         G          &   #00012265' TO DFHEIV0
 14592     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 14593     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14594     MOVE X'2020233030303132323635' TO DFHEIV0(25:11)
 14595     CALL 'kxdfhei1' USING DFHEIV0,
 14596           ACTQ-FILE-ID,
 14597           ACTQ-KEY,
 14598           DFHEIV99,
 14599           DFHEIV11,
 14600           DFHEIV99
 14601     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14602
 14603
 14604     GO TO 3050-DELETE-ACTQ.
 14605
 14606 3050-EXIT.
 14607     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 271
* EL131.cbl
 14609 3060-READ-TRLR.
 14610
 14611* EXEC CICS HANDLE CONDITION
 14612*         NOTFND    (3060-EXIT)
 14613*         ENDFILE   (3060-EXIT)
 14614*    END-EXEC.
 14615*    MOVE '"$I''                  ! A #00012276' TO DFHEIV0
 14616     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 14617     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14618     MOVE X'4120233030303132323736' TO DFHEIV0(25:11)
 14619     CALL 'kxdfhei1' USING DFHEIV0
 14620     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14621
 14622
 14623 3060-LOOP.
 14624
 14625* EXEC CICS READNEXT
 14626*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 14627*         DATASET  (TRLR-FILE-ID)
 14628*         RIDFLD   (TRLR-KEY)
 14629*    END-EXEC.
 14630     MOVE 0
 14631       TO DFHEIV11
 14632*    MOVE '&.S                   )   #00012282' TO DFHEIV0
 14633     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 14634     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 14635     MOVE X'2020233030303132323832' TO DFHEIV0(25:11)
 14636     CALL 'kxdfhei1' USING DFHEIV0,
 14637           TRLR-FILE-ID,
 14638           DFHEIV20,
 14639           DFHEIV99,
 14640           TRLR-KEY,
 14641           DFHEIV99,
 14642           DFHEIV11,
 14643           DFHEIV99,
 14644           DFHEIV99
 14645     SET ADDRESS OF ACTIVITY-TRAILERS TO
 14646         DFHEIV20
 14647     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14648
 14649
 14650     IF TRLR-MAIN-KEY GREATER THAN CL-CONTROL-PRIMARY
 14651         GO TO 3060-EXIT.
 14652
 14653     IF FORM-CONTROL-TR
 14654         IF AT-RECORDED-DT = SAVE-BIN-DATE
 14655             NEXT SENTENCE
 14656         ELSE
 14657             MOVE 'X'            TO ERROR-SWITCH
 14658             GO TO 3060-EXIT
 14659     ELSE
 14660         IF PAYMENT-TR OR CORRESPONDENCE-TR
 14661            MOVE 'X'                 TO ERROR-SWITCH
 14662            GO TO 3060-EXIT.
 14663
 14664     GO TO 3060-LOOP.
 14665
 14666 3060-EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 272
* EL131.cbl
 14667     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 273
* EL131.cbl
 14669 3997-GET-ERPDEF.
 14670
 14671     move cl-company-cd          to cert-company-code
 14672     move cl-cert-key-data       to cert-key (2:21)
 14673     move cl-cert-no             to cert-cert
 14674
 14675
 14676* EXEC CICS READ
 14677*        DATASET   (CERT-FILE-ID)
 14678*        RIDFLD    (CERT-KEY)
 14679*        SET       (ADDRESS OF CERTIFICATE-MASTER)
 14680*        resp      (ws-response)
 14681*    END-EXEC
 14682*    MOVE '&"S        E          (  N#00012313' TO DFHEIV0
 14683     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14684     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14685     MOVE X'204E233030303132333133' TO DFHEIV0(25:11)
 14686     CALL 'kxdfhei1' USING DFHEIV0,
 14687           CERT-FILE-ID,
 14688           DFHEIV20,
 14689           DFHEIV99,
 14690           CERT-KEY,
 14691           DFHEIV99,
 14692           DFHEIV99,
 14693           DFHEIV99
 14694     SET ADDRESS OF CERTIFICATE-MASTER TO
 14695         DFHEIV20
 14696     MOVE EIBRESP  TO ws-response
 14697     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14698
 14699     MOVE SPACES                 TO WS-CRIT-PER-ALPHA
 14700                                    WS-ERPDEF-SW
 14701     MOVE ZEROS                  TO WS-CRITICAL-PERIOD
 14702                                    WS-CRIT-PER-RTW-MOS
 14703
 14704     if cm-clp-state = spaces or low-values or zeros
 14705        move cm-state            to cm-clp-state
 14706     end-if
 14707     MOVE PI-COMPANY-CD          TO ERPDEF-KEY
 14708     MOVE CM-clp-state           TO ERPDEF-STATE
 14709     MOVE am-dcc-product-code    TO ERPDEF-PROD-CD
 14710     evaluate true
 14711        when (cl-claim-type = 'L' or 'P' OR 'O')
 14712           and (cm-lf-benefit-cd not = '00' and '  ' and 'DD'
 14713             and 'CU')
 14714           move 'L'              to erpdef-ben-type
 14715           move cm-lf-benefit-cd to erpdef-ben-code
 14716        when (cl-claim-type not = 'L' and 'P' AND 'O')
 14717           and (cm-ah-benefit-cd not = '00' and '  ')
 14718           move 'A'              to erpdef-ben-type
 14719           move cm-ah-benefit-cd to erpdef-ben-code
 14720        when (cl-claim-type not = 'L' and 'P' AND 'O')
 14721           and (cm-ah-benefit-cd = '00' or '  ')
 14722           move 'L'              to erpdef-ben-type
 14723           move cm-lf-benefit-cd to erpdef-ben-code
 14724        when (cl-claim-type = 'L' or 'P' OR 'O')
 14725           and (cm-lf-benefit-cd = '00' or '  ' or 'DD' or 'CU')
 14726           move 'A'              to erpdef-ben-type
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 274
* EL131.cbl
 14727           move cm-ah-benefit-cd to erpdef-ben-code
 14728        when other
 14729           move 'A'              to erpdef-ben-type
 14730           move cm-ah-benefit-cd to erpdef-ben-code
 14731     end-evaluate
 14732
 14733*    if (cl-claim-type = 'L' or 'P')
 14734*       and (cm-lf-benefit-cd not = '00' and '  ' and 'DD'
 14735*          and 'CU')
 14736*       move 'L'                 to erpdef-ben-type
 14737*       move cm-lf-benefit-cd    to erpdef-ben-code
 14738*    else
 14739*       MOVE 'A'                 TO ERPDEF-BEN-TYPE
 14740*       MOVE CM-AH-BENEFIT-CD    TO ERPDEF-BEN-CODE
 14741*    end-if
 14742     MOVE CM-CERT-EFF-DT         TO ERPDEF-EXP-DT
 14743     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
 14744
 14745
 14746* EXEC CICS STARTBR
 14747*        DATASET  ('ERPDEF')
 14748*        RIDFLD   (ERPDEF-KEY)
 14749*        GTEQ
 14750*        RESP     (WS-RESPONSE)
 14751*    END-EXEC
 14752     MOVE 'ERPDEF' TO DFHEIV1
 14753     MOVE 0
 14754       TO DFHEIV11
 14755*    MOVE '&,         G          &  N#00012366' TO DFHEIV0
 14756     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 14757     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14758     MOVE X'204E233030303132333636' TO DFHEIV0(25:11)
 14759     CALL 'kxdfhei1' USING DFHEIV0,
 14760           DFHEIV1,
 14761           ERPDEF-KEY,
 14762           DFHEIV99,
 14763           DFHEIV11,
 14764           DFHEIV99
 14765     MOVE EIBRESP  TO WS-RESPONSE
 14766     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14767
 14768     IF WS-RESP-NORMAL
 14769
 14770* EXEC CICS READNEXT
 14771*          DATASET  ('ERPDEF')
 14772*          INTO     (PRODUCT-MASTER)
 14773*          RIDFLD   (ERPDEF-KEY)
 14774*          RESP     (WS-RESPONSE)
 14775*       END-EXEC
 14776     MOVE LENGTH OF
 14777      PRODUCT-MASTER
 14778       TO DFHEIV12
 14779     MOVE 'ERPDEF' TO DFHEIV1
 14780     MOVE 0
 14781       TO DFHEIV11
 14782*    MOVE '&.IL                  )  N#00012374' TO DFHEIV0
 14783     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 14784     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 275
* EL131.cbl
 14785     MOVE X'204E233030303132333734' TO DFHEIV0(25:11)
 14786     CALL 'kxdfhei1' USING DFHEIV0,
 14787           DFHEIV1,
 14788           PRODUCT-MASTER,
 14789           DFHEIV12,
 14790           ERPDEF-KEY,
 14791           DFHEIV99,
 14792           DFHEIV11,
 14793           DFHEIV99,
 14794           DFHEIV99
 14795     MOVE EIBRESP  TO WS-RESPONSE
 14796     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14797        IF WS-RESP-NORMAL
 14798           IF (ERPDEF-KEY-SAVE (1:16) =
 14799              PD-CONTROL-PRIMARY (1:16))
 14800              AND (CM-CERT-EFF-DT < PD-PROD-EXP-DT)
 14801              PERFORM VARYING A1 FROM +1 BY +1 UNTIL
 14802                 (A1 > +8)
 14803                 OR (PD-PROD-CODE (A1) = cl-claim-type)
 14804              END-PERFORM
 14805              IF A1 < +9
 14806                 SET ERPDEF-FOUND TO TRUE
 14807                 MOVE PD-CRIT-PERIOD (A1)
 14808                              TO WS-CRITICAL-PERIOD
 14809                 MOVE PD-REC-CRIT-PERIOD (A1)
 14810                              TO WS-CRIT-PER-RECURRENT
 14811                 IF PD-RTW-MOS (A1) NUMERIC
 14812                    MOVE PD-RTW-MOS (A1)
 14813                              TO WS-CRIT-PER-RTW-MOS
 14814                 ELSE
 14815                    MOVE 0    TO WS-CRIT-PER-RTW-MOS
 14816                 END-IF
 14817                 IF PD-EXCLUSION-PERIOD-DAYS (A1) NUMERIC
 14818                    MOVE PD-EXCLUSION-PERIOD-DAYS (A1)
 14819                                 TO WS-EXCL-PERIOD
 14820                 END-IF
 14821                 IF PD-COVERAGE-ENDS-MOS (A1) NUMERIC
 14822                    MOVE PD-COVERAGE-ENDS-MOS (A1)
 14823                                 TO WS-COV-ENDS
 14824                 END-IF
 14825                 IF PD-ACCIDENT-ONLY-MOS (A1) NUMERIC
 14826                    MOVE PD-ACCIDENT-ONLY-MOS (A1)
 14827                                 TO WS-ACC-PERIOD
 14828                 END-IF
 14829                 if pd-max-extension (a1) numeric
 14830                    move pd-max-extension (a1)
 14831                                 to ws-max-extension
 14832                 end-if
 14833                 if pd-max-amt (a1) numeric
 14834                    move pd-max-amt (a1)
 14835                                 to ws-max-moben
 14836                 end-if
 14837              END-IF
 14838           END-IF
 14839        END-IF
 14840     END-IF
 14841
 14842     .
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 276
* EL131.cbl
 14843 3997-EXIT.
 14844     EXIT.
 14845 4000-FORCE-ERRORS.
 14846     IF PI-RETURN-CD-1 = 'X'
 14847         MOVE ER-0311            TO EMI-ERROR
 14848         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14849         MOVE -1                 TO MAINTL
 14850         GO TO 8110-SEND-DATA.
 14851
 14852     IF NOT FORCE-CAP
 14853         MOVE ER-0416            TO EMI-ERROR
 14854         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14855         MOVE -1                 TO MAINTL
 14856         GO TO 8110-SEND-DATA.
 14857
 14858     MOVE 'F'                    TO EMI-ACTION-SWITCH.
 14859     PERFORM 1000-EDIT-SCREEN THRU 1010-EXIT.
 14860     IF EMI-FATAL-CTR GREATER THAN ZERO
 14861         GO TO 4000-FATAL-ERRORS.
 14862
 14863     PERFORM 2000-UPDATE-CLAIM THRU 2000-EXIT.
 14864
 14865     IF EMI-FATAL-CTR GREATER THAN ZERO
 14866         GO TO 4000-FATAL-ERRORS.
 14867
 14868     PERFORM 5000-BUILD-MAP THRU 5000-EXIT.
 14869
 14870     IF EMI-FATAL-CTR GREATER THAN ZERO
 14871         GO TO 4000-FATAL-ERRORS.
 14872
 14873     MOVE SPACE                  TO EMI-ACTION-SWITCH MAINTO.
 14874     MOVE AL-UANOF               TO CERTA.
 14875     MOVE ER-0000 TO EMI-ERROR.
 14876     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14877
 14878 4000-FATAL-ERRORS.
 14879     MOVE -1                     TO MAINTL.
 14880     GO TO 8110-SEND-DATA.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 277
* EL131.cbl
 14882
 14883 4100-SAVE-CHANGES.
 14884     IF MAINTL > 0
 14885         MOVE MAINTI  TO WS-SAVE-MAINTI
 14886         MOVE MAINTL  TO WS-SAVE-MAINTL
 14887     END-IF
 14888     IF STATUSL > 0
 14889         MOVE STATUSI  TO WS-SAVE-STATUSI
 14890         MOVE STATUSL  TO WS-SAVE-STATUSL
 14891     END-IF
 14892     IF REPL > 0
 14893         MOVE REPI  TO WS-SAVE-REPI
 14894         MOVE REPL  TO WS-SAVE-REPL
 14895     END-IF
 14896*    IF CAUSEL > 0
 14897*        MOVE CAUSEI  TO WS-SAVE-CAUSEI
 14898*        MOVE CAUSEL  TO WS-SAVE-CAUSEL
 14899*    END-IF
 14900*    IF ENDL > 0
 14901*        MOVE ENDI  TO WS-SAVE-ENDI
 14902*        MOVE ENDL  TO WS-SAVE-ENDL
 14903*    END-IF
 14904     IF DIAGL > 0
 14905         MOVE DIAGI  TO WS-SAVE-DIAGI
 14906         MOVE DIAGL  TO WS-SAVE-DIAGL
 14907     END-IF
 14908     IF ICD1L > 0
 14909         MOVE ICD1I  TO WS-SAVE-ICD1I
 14910         MOVE ICD1L  TO WS-SAVE-ICD1L
 14911     END-IF
 14912     IF ICD2L > 0
 14913         MOVE ICD2I  TO WS-SAVE-ICD2I
 14914         MOVE ICD2L  TO WS-SAVE-ICD2L
 14915     END-IF
 14916     IF BENEL > 0
 14917         MOVE BENEI  TO WS-SAVE-BENEI
 14918         MOVE BENEL  TO WS-SAVE-BENEL
 14919     END-IF
 14920     IF BIRTHL > 0
 14921         MOVE BIRTHI  TO WS-SAVE-BIRTHI
 14922         MOVE BIRTHL  TO WS-SAVE-BIRTHL
 14923     END-IF
 14924     IF SOCIALL > 0
 14925         MOVE SOCIALI  TO WS-SAVE-SOCIALI
 14926         MOVE SOCIALL  TO WS-SAVE-SOCIALL
 14927     END-IF
 14928     IF SEXL > 0
 14929         MOVE SEXI  TO WS-SAVE-SEXI
 14930         MOVE SEXL  TO WS-SAVE-SEXL
 14931     END-IF
 14932     IF MLNAMEL > 0
 14933         MOVE MLNAMEI  TO WS-SAVE-MLNAMEI
 14934         MOVE MLNAMEL  TO WS-SAVE-MLNAMEL
 14935     END-IF
 14936     IF MFNAMEL > 0
 14937         MOVE MFNAMEI  TO WS-SAVE-MFNAMEI
 14938         MOVE MFNAMEL  TO WS-SAVE-MFNAMEL
 14939     END-IF
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 278
* EL131.cbl
 14940     IF MMINITL > 0
 14941         MOVE MMINITI  TO WS-SAVE-MMINITI
 14942         MOVE MMINITL  TO WS-SAVE-MMINITL
 14943     END-IF
 14944*    IF LOANNOL > 0
 14945*        MOVE LOANNOI  TO WS-SAVE-LOANNOI
 14946*        MOVE LOANNOL  TO WS-SAVE-LOANNOL
 14947*    END-IF
 14948     IF LOANBALL > 0
 14949         MOVE LOANBALI  TO WS-SAVE-LOANBALI
 14950         MOVE LOANBALL  TO WS-SAVE-LOANBALL
 14951     END-IF
 14952     IF PROCL > 0
 14953         MOVE PROCI  TO WS-SAVE-PROCI
 14954         MOVE PROCL  TO WS-SAVE-PROCL
 14955     END-IF
 14956     IF SUPVL > 0
 14957         MOVE SUPVI  TO WS-SAVE-SUPVI
 14958         MOVE SUPVL  TO WS-SAVE-SUPVL
 14959     END-IF
 14960     IF PRICDL > 0
 14961         MOVE PRICDI  TO WS-SAVE-PRICDI
 14962         MOVE PRICDL  TO WS-SAVE-PRICDL
 14963     END-IF
 14964     IF FILETOL > 0
 14965         MOVE FILETOI  TO WS-SAVE-FILETOI
 14966         MOVE FILETOL  TO WS-SAVE-FILETOL
 14967     END-IF
 14968     IF PDTHRUL > 0
 14969         MOVE PDTHRUI  TO WS-SAVE-PDTHRUI
 14970         MOVE PDTHRUL  TO WS-SAVE-PDTHRUL
 14971     END-IF
 14972     IF PDAMTL > 0
 14973         MOVE PDAMTI  TO WS-SAVE-PDAMTI
 14974         MOVE PDAMTL  TO WS-SAVE-PDAMTL
 14975     END-IF
 14976     IF NODAYSL > 0
 14977         MOVE NODAYSI  TO WS-SAVE-NODAYSI
 14978         MOVE NODAYSL  TO WS-SAVE-NODAYSL
 14979     END-IF
 14980     IF NOPMTSL > 0
 14981         MOVE NOPMTSI  TO WS-SAVE-NOPMTSI
 14982         MOVE NOPMTSL  TO WS-SAVE-NOPMTSL
 14983     END-IF
 14984     IF FORMTYPL > 0
 14985         MOVE FORMTYPI  TO WS-SAVE-FORMTYPI
 14986         MOVE FORMTYPL  TO WS-SAVE-FORMTYPL
 14987     END-IF
 14988     IF OCCL > 0
 14989         MOVE OCCI  TO WS-SAVE-OCCI
 14990         MOVE OCCL  TO WS-SAVE-OCCL
 14991     END-IF.
 14992 4100-EXIT.
 14993      EXIT.
 14994
 14995 4200-LOAD-CHANGES.
 14996     IF WS-SAVE-MAINTL > 0
 14997         MOVE WS-SAVE-MAINTI  TO MAINTI
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 279
* EL131.cbl
 14998         MOVE WS-SAVE-MAINTL  TO MAINTL
 14999         MOVE AL-UANON        TO MAINTA
 15000     END-IF
 15001     IF WS-SAVE-STATUSL > 0
 15002         MOVE WS-SAVE-STATUSI  TO STATUSI
 15003         MOVE WS-SAVE-STATUSL  TO STATUSL
 15004         MOVE AL-UANON         TO STATUSA
 15005     END-IF
 15006     IF WS-SAVE-REPL > 0
 15007         MOVE WS-SAVE-REPI  TO REPI
 15008         MOVE WS-SAVE-REPL  TO REPL
 15009         MOVE AL-UANON      TO REPA
 15010     END-IF
 15011*    IF WS-SAVE-CAUSEL > 0
 15012*        MOVE WS-SAVE-CAUSEI  TO CAUSEI
 15013*        MOVE WS-SAVE-CAUSEL  TO CAUSEL
 15014*        MOVE AL-UANON        TO CAUSEA
 15015*    END-IF
 15016*    IF WS-SAVE-ENDL > 0
 15017*        MOVE WS-SAVE-ENDI  TO ENDI
 15018*        MOVE WS-SAVE-ENDL  TO ENDL
 15019*        MOVE AL-UANON      TO ENDA
 15020*    END-IF
 15021     IF WS-SAVE-DIAGL > 0
 15022         MOVE WS-SAVE-DIAGI  TO DIAGI
 15023         MOVE WS-SAVE-DIAGL  TO DIAGL
 15024         MOVE AL-UANON       TO DIAGA
 15025     END-IF
 15026     IF WS-SAVE-ICD1L > 0
 15027         MOVE WS-SAVE-ICD1I  TO ICD1I
 15028         MOVE WS-SAVE-ICD1L  TO ICD1L
 15029         MOVE AL-UANON       TO ICD1A
 15030     END-IF
 15031     IF WS-SAVE-ICD2L > 0
 15032         MOVE WS-SAVE-ICD2I  TO ICD2I
 15033         MOVE WS-SAVE-ICD2L  TO ICD2L
 15034         MOVE AL-UANON       TO ICD2A
 15035     END-IF
 15036     IF WS-SAVE-BENEL > 0
 15037         MOVE WS-SAVE-BENEI  TO BENEI
 15038         MOVE WS-SAVE-BENEL  TO BENEL
 15039         MOVE AL-UANON       TO BENEA
 15040     END-IF
 15041     IF WS-SAVE-BIRTHL > 0
 15042         MOVE WS-SAVE-BIRTHI  TO BIRTHI
 15043         MOVE WS-SAVE-BIRTHL  TO BIRTHL
 15044         MOVE AL-UANON        TO BIRTHA
 15045     END-IF
 15046     IF WS-SAVE-SOCIALL > 0
 15047         MOVE WS-SAVE-SOCIALI  TO SOCIALI
 15048         MOVE WS-SAVE-SOCIALL  TO SOCIALL
 15049         MOVE AL-UANON         TO SOCIALA
 15050     END-IF
 15051     IF WS-SAVE-SEXL > 0
 15052         MOVE WS-SAVE-SEXI  TO SEXI
 15053         MOVE WS-SAVE-SEXL  TO SEXL
 15054         MOVE AL-UANON      TO SEXA
 15055     END-IF
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 280
* EL131.cbl
 15056     IF WS-SAVE-MLNAMEL > 0
 15057         MOVE WS-SAVE-MLNAMEI  TO MLNAMEI
 15058         MOVE WS-SAVE-MLNAMEL  TO MLNAMEL
 15059         MOVE AL-UANON         TO MLNAMEA
 15060     END-IF
 15061     IF WS-SAVE-MFNAMEL > 0
 15062         MOVE WS-SAVE-MFNAMEI  TO MFNAMEI
 15063         MOVE WS-SAVE-MFNAMEL  TO MFNAMEL
 15064         MOVE AL-UANON         TO MFNAMEA
 15065     END-IF
 15066     IF WS-SAVE-MMINITL > 0
 15067         MOVE WS-SAVE-MMINITI  TO MMINITI
 15068         MOVE WS-SAVE-MMINITL  TO MMINITL
 15069         MOVE AL-UANON         TO MMINITA
 15070     END-IF
 15071*    IF WS-SAVE-LOANNOL > 0
 15072*        MOVE WS-SAVE-LOANNOI  TO LOANNOI
 15073*        MOVE WS-SAVE-LOANNOL  TO LOANNOL
 15074*        MOVE AL-UANON         TO LOANNOA
 15075*    END-IF
 15076     IF WS-SAVE-LOANBALL > 0
 15077         MOVE WS-SAVE-LOANBALI  TO LOANBALI
 15078         MOVE WS-SAVE-LOANBALL  TO LOANBALL
 15079         MOVE AL-UANON          TO LOANBALA
 15080     END-IF
 15081     IF WS-SAVE-PROCL > 0
 15082         MOVE WS-SAVE-PROCI  TO PROCI
 15083         MOVE WS-SAVE-PROCL  TO PROCL
 15084         MOVE AL-UANON       TO PROCA
 15085     END-IF
 15086     IF WS-SAVE-SUPVL > 0
 15087         MOVE WS-SAVE-SUPVI  TO SUPVI
 15088         MOVE WS-SAVE-SUPVL  TO SUPVL
 15089         MOVE AL-UANON       TO SUPVA
 15090     END-IF
 15091     IF WS-SAVE-PRICDL > 0
 15092         MOVE WS-SAVE-PRICDI  TO PRICDI
 15093         MOVE WS-SAVE-PRICDL  TO PRICDL
 15094         MOVE AL-UANON        TO PRICDA
 15095     END-IF
 15096     IF WS-SAVE-FILETOL > 0
 15097         MOVE WS-SAVE-FILETOI  TO FILETOI
 15098         MOVE WS-SAVE-FILETOL  TO FILETOL
 15099         MOVE AL-UANON         TO FILETOA
 15100     END-IF
 15101     IF WS-SAVE-PDTHRUL > 0
 15102         MOVE WS-SAVE-PDTHRUI  TO PDTHRUI
 15103         MOVE WS-SAVE-PDTHRUL  TO PDTHRUL
 15104         MOVE AL-UANON         TO PDTHRUA
 15105     END-IF
 15106     IF WS-SAVE-PDAMTL > 0
 15107         MOVE WS-SAVE-PDAMTI  TO PDAMTI
 15108         MOVE WS-SAVE-PDAMTL  TO PDAMTL
 15109         MOVE AL-UANON        TO PDAMTA
 15110     END-IF
 15111     IF WS-SAVE-NODAYSL > 0
 15112         MOVE WS-SAVE-NODAYSI  TO NODAYSI
 15113         MOVE WS-SAVE-NODAYSL  TO NODAYSL
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 281
* EL131.cbl
 15114         MOVE AL-UANON         TO NODAYSA
 15115     END-IF
 15116     IF WS-SAVE-NOPMTSL > 0
 15117         MOVE WS-SAVE-NOPMTSI  TO NOPMTSI
 15118         MOVE WS-SAVE-NOPMTSL  TO NOPMTSL
 15119         MOVE AL-UANON         TO NOPMTSA
 15120     END-IF
 15121     IF WS-SAVE-FORMTYPL > 0
 15122         MOVE WS-SAVE-FORMTYPI  TO FORMTYPI
 15123         MOVE WS-SAVE-FORMTYPL  TO FORMTYPL
 15124         MOVE AL-UANON          TO FORMTYPA
 15125     END-IF
 15126     IF WS-SAVE-OCCL > 0
 15127         MOVE WS-SAVE-OCCI  TO OCCI
 15128         MOVE WS-SAVE-OCCL  TO OCCL
 15129         MOVE AL-UANON      TO OCCA
 15130     END-IF.
 15131 4200-EXIT.
 15132      EXIT.
 15133
 15134 5000-BUILD-MAP.
 15135     IF PI-RETURN-CD-1 = SPACE
 15136         PERFORM 5010-RESET-PI-AREA THRU 5010-EXIT.
 15137
 15138     MOVE SPACE                  TO PI-RETURN-CD-1.
 15139
 15140     MOVE LOW-VALUES             TO EL131AI.
 15141
 15142     MOVE PI-COMPANY-CD          TO COMPANY-CODE.
 15143     MOVE PI-CARRIER             TO CARRIER-CODE.
 15144     MOVE PI-CLAIM-NO            TO CLAIM-NO.
 15145     MOVE PI-CERT-NO             TO CERT-NO.
 15146
 15147 5000-READ-CLAIM-MASTER.
 15148
 15149
 15150* EXEC CICS READ
 15151*         SET      (ADDRESS OF CLAIM-MASTER)
 15152*         DATASET  (CLMS-FILE-ID)
 15153*         RIDFLD   (MSTR-KEY)
 15154*    END-EXEC.
 15155*    MOVE '&"S        E          (   #00012732' TO DFHEIV0
 15156     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15157     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15158     MOVE X'2020233030303132373332' TO DFHEIV0(25:11)
 15159     CALL 'kxdfhei1' USING DFHEIV0,
 15160           CLMS-FILE-ID,
 15161           DFHEIV20,
 15162           DFHEIV99,
 15163           MSTR-KEY,
 15164           DFHEIV99,
 15165           DFHEIV99,
 15166           DFHEIV99
 15167     SET ADDRESS OF CLAIM-MASTER TO
 15168         DFHEIV20
 15169     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15170
 15171
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 282
* EL131.cbl
 15172     PERFORM 5020-MOVE-MSTR THRU 5020-EXIT.
 15173
 15174 5000-READ-DIAGNOSIS-TRAILER.
 15175
 15176
 15177* EXEC CICS HANDLE CONDITION
 15178*         NOTFND (5000-TRLR-NOT-FOUND)
 15179*    END-EXEC.
 15180*    MOVE '"$I                   ! B #00012742' TO DFHEIV0
 15181     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15182     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15183     MOVE X'4220233030303132373432' TO DFHEIV0(25:11)
 15184     CALL 'kxdfhei1' USING DFHEIV0
 15185     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15186
 15187
 15188     MOVE MSTR-KEY               TO TRLR-KEY.
 15189     MOVE NINETY                 TO TRLR-SEQ-NO.
 15190
 15191
 15192* EXEC CICS READ
 15193*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 15194*         DATASET  (TRLR-FILE-ID)
 15195*         RIDFLD   (TRLR-KEY)
 15196*    END-EXEC.
 15197*    MOVE '&"S        E          (   #00012749' TO DFHEIV0
 15198     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15199     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15200     MOVE X'2020233030303132373439' TO DFHEIV0(25:11)
 15201     CALL 'kxdfhei1' USING DFHEIV0,
 15202           TRLR-FILE-ID,
 15203           DFHEIV20,
 15204           DFHEIV99,
 15205           TRLR-KEY,
 15206           DFHEIV99,
 15207           DFHEIV99,
 15208           DFHEIV99
 15209     SET ADDRESS OF ACTIVITY-TRAILERS TO
 15210         DFHEIV20
 15211     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15212
 15213
 15214     MOVE AT-INFO-LINE-1         TO DIAGO.
 15215     MOVE AT-ICD-CODE-1          TO ICD1O.
 15216     MOVE AT-ICD-CODE-2          TO ICD2O.
 15217
 15218 5000-READ-CERTIFICATE-MASTER.
 15219
 15220     MOVE PI-COMPANY-CD          TO CERT-COMPANY-CODE.
 15221     MOVE CL-CERT-CARRIER        TO CERT-CARRIER
 15222     MOVE CL-CERT-GROUPING       TO CERT-GROUP PI-GROUPING.
 15223     MOVE CL-CERT-STATE          TO CERT-STATE PI-STATE.
 15224     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT PI-ACCOUNT.
 15225     MOVE CL-CERT-NO             TO CERT-CERT PI-CERT-NO.
 15226     MOVE CL-CERT-EFF-DT         TO CERT-DATE PI-CERT-EFF-DT.
 15227
 15228
 15229* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 283
* EL131.cbl
 15230*         NOTFND (5000-CERT-NOT-FOUND)
 15231*    END-EXEC.
 15232*    MOVE '"$I                   ! C #00012769' TO DFHEIV0
 15233     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15234     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15235     MOVE X'4320233030303132373639' TO DFHEIV0(25:11)
 15236     CALL 'kxdfhei1' USING DFHEIV0
 15237     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15238
 15239
 15240
 15241* EXEC CICS READ
 15242*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 15243*         DATASET  (CERT-FILE-ID)
 15244*         RIDFLD   (CERT-KEY)
 15245*    END-EXEC.
 15246*    MOVE '&"S        E          (   #00012773' TO DFHEIV0
 15247     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15248     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15249     MOVE X'2020233030303132373733' TO DFHEIV0(25:11)
 15250     CALL 'kxdfhei1' USING DFHEIV0,
 15251           CERT-FILE-ID,
 15252           DFHEIV20,
 15253           DFHEIV99,
 15254           CERT-KEY,
 15255           DFHEIV99,
 15256           DFHEIV99,
 15257           DFHEIV99
 15258     SET ADDRESS OF CERTIFICATE-MASTER TO
 15259         DFHEIV20
 15260     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15261
 15262
 15263     PERFORM 5030-MOVE-CERT THRU 5030-EXIT.
 15264     PERFORM 5100-LOAD-CORR-TRLR THRU 5100-EXIT.
 15265     PERFORM 7600-BROWSE-CLAIM THRU 7699-EXIT.
 15266
 15267     GO TO 5000-EXIT.
 15268
 15269 5000-TRLR-NOT-FOUND.
 15270     MOVE ER-7687                TO EMI-ERROR.
 15271     MOVE -1                     TO DIAGL.
 15272     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15273     GO TO 5000-EXIT.
 15274
 15275 5000-CERT-NOT-FOUND.
 15276     MOVE ER-0206                TO EMI-ERROR.
 15277     MOVE -1                     TO CERTL.
 15278     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15279
 15280 5000-EXIT.
 15281     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 284
* EL131.cbl
 15283 5010-RESET-PI-AREA.
 15284     IF CERTI GREATER THAN LOW-VALUES
 15285         MOVE CERTI              TO PI-CERT-PRIME.
 15286
 15287     IF SUFXI GREATER THAN LOW-VALUES
 15288         MOVE SUFXI              TO PI-CERT-SFX.
 15289
 15290     IF CERTEFFI GREATER THAN LOW-VALUES
 15291         MOVE HOLD-EFF           TO PI-CERT-EFF-DT.
 15292
 15293     IF CERTACTI GREATER THAN LOW-VALUES
 15294         MOVE CERTACTI           TO PI-ACCOUNT.
 15295
 15296     IF CERTSTI GREATER THAN LOW-VALUES
 15297         MOVE CERTSTI            TO PI-STATE.
 15298
 15299     IF CERTCARI GREATER THAN LOW-VALUES
 15300         MOVE CERTCARI           TO PI-CARRIER.
 15301
 15302     IF CERTGRPI GREATER THAN LOW-VALUES
 15303         MOVE CERTGRPI           TO PI-GROUPING.
 15304
 15305 5010-EXIT.
 15306     EXIT.
 15307
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 285
* EL131.cbl
 15309 5020-MOVE-MSTR.
 15310
 15311     MOVE CL-ASSOC-CERT-SEQU     TO WS-CURRENT-SEQU.
 15312     MOVE CL-ASSOC-CERT-TOTAL    TO WS-OF-SEQU.
 15313     MOVE WS-CLAIM-SEQU          TO SEQUO.
 15314     MOVE AL-SABON               TO SEQUA.
 15315     MOVE CL-CLAIM-NO            TO CLAIMO PI-CLAIM-NO.
 15316     MOVE CL-CLAIM-TYPE          TO TYPEO
 15317                                    pi-claim-type
 15318
 15319     IF CL-TOTAL-PAID-AMT  = +0 AND
 15320        CL-LAST-PMT-AMT    = +0 AND
 15321        CL-NO-OF-PMTS-MADE = +0
 15322          MOVE AL-UANON          TO TYPEA.
 15323
 15324     MOVE CL-PRIME-CERT-PRIME    TO PCERTNOO.
 15325     MOVE CL-PRIME-CERT-SFX      TO PSUFXO.
 15326     MOVE CL-CERT-PRIME          TO CERTO.
 15327     MOVE CL-CERT-SFX            TO SUFXO.
 15328     MOVE CL-CERT-CARRIER        TO CARRO.
 15329
 15330     IF CL-CLAIM-STATUS = 'C'
 15331         MOVE 'CLOSED'           TO STATUSO
 15332     ELSE
 15333         MOVE 'OPEN  '           TO STATUSO.
 15334
 15335     move cl-accident-claim-sw   to accswo
 15336     if cl-benefit-period not numeric
 15337        move zeros               to cl-benefit-period
 15338     end-if
 15339     move cl-benefit-period      to benpero
 15340     move cl-insured-type        to instypeo
 15341     MOVE CL-PROCESSOR-ID        TO PROCO.
 15342
 15343     MOVE CL-FILE-ESTABLISHED-BY TO AUIDO.
 15344     MOVE CL-CCN                 TO CCNOO.
 15345
 15346     MOVE CL-INSURED-LAST-NAME   TO MLNAMEO.
 15347     MOVE CL-INSURED-1ST-NAME    TO MFNAMEO.
 15348     MOVE CL-INSURED-MID-INIT    TO MMINITO.
 15349     MOVE CL-INSURED-SEX-CD      TO SEXO.
 15350
 15351     IF CL-INSURED-BIRTH-DT GREATER THAN LOW-VALUES
 15352         MOVE CL-INSURED-BIRTH-DT TO DC-BIN-DATE-1
 15353         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 15354         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15355         MOVE DC-GREG-DATE-1-EDIT TO BIRTHO
 15356     ELSE
 15357         MOVE SPACES             TO BIRTHO.
 15358
 15359     IF CL-SSN-STATE   = CL-CERT-STATE  AND
 15360        CL-SSN-ACCOUNT = CL-CERT-ACCOUNT-PRIME
 15361         NEXT SENTENCE
 15362       ELSE
 15363         MOVE CL-SOC-SEC-NO      TO SOCIALO.
 15364
 15365     IF PI-COMPANY-ID = 'DMD'
 15366       IF CL-CERT-PRIME (4:1) = 'U' OR 'F'
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 286
* EL131.cbl
 15367          IF SOCIALO = SPACES OR LOW-VALUES
 15368            MOVE ER-0885         TO EMI-ERROR
 15369            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15370
 15371     MOVE CL-INSURED-OCC-CD      TO OCCO.
 15372*    MOVE CL-CAUSE-CD            TO CAUSEO.
 15373
 15374*    IF CL-EST-END-OF-DISAB-DT GREATER THAN LOW-VALUES
 15375*        MOVE CL-EST-END-OF-DISAB-DT TO DC-BIN-DATE-1
 15376*        MOVE SPACES                 TO DC-OPTION-CODE
 15377*        PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15378*        MOVE DC-GREG-DATE-1-EDIT TO ENDO
 15379*    ELSE
 15380*        MOVE SPACES             TO ENDO.
 15381
 15382     IF CL-PAID-THRU-DT GREATER THAN LOW-VALUES
 15383        MOVE CL-PAID-THRU-DT    TO DC-BIN-DATE-1
 15384        MOVE SPACES             TO DC-OPTION-CODE
 15385        PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15386        MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
 15387        IF PI-USES-PAID-TO
 15388           MOVE CL-PAID-THRU-DT    TO DC-BIN-DATE-1
 15389           MOVE '6'                TO DC-OPTION-CODE
 15390           MOVE +1                 TO DC-ELAPSED-DAYS
 15391           MOVE +0                 TO DC-ELAPSED-MONTHS
 15392           PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15393           MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
 15394        ELSE
 15395           NEXT SENTENCE
 15396     ELSE
 15397        MOVE SPACES             TO PDTHRUO.
 15398
 15399     MOVE CL-TOTAL-PAID-AMT      TO PDAMTO.
 15400     MOVE CL-NO-OF-DAYS-PAID     TO NODAYSO.
 15401     MOVE CL-NO-OF-PMTS-MADE     TO NOPMTSO.
 15402     MOVE CL-PROG-FORM-TYPE      TO FORMTYPO.
 15403
 15404     IF MODIFY-CAP
 15405        MOVE AL-UNNOF            TO PDAMTA
 15406                                    NODAYSA
 15407                                    NOPMTSA
 15408        MOVE AL-UANOF            TO PDTHRUA.
 15409     MOVE PI-COMPANY-ID          TO CNTL-CO-ID
 15410     MOVE '2'                    TO CNTL-REC-TYPE
 15411     MOVE +0                     TO CNTL-SEQ-NO
 15412     MOVE PI-PROCESSOR-ID        TO CNTL-PROC-ID
 15413
 15414
 15415* EXEC CICS READ
 15416*         DATASET  (CNTL-FILE-ID)
 15417*         SET      (ADDRESS OF CONTROL-FILE)
 15418*         RIDFLD   (CNTL-KEY)
 15419*         RESP     (WS-RESPONSE)
 15420*    END-EXEC
 15421*    MOVE '&"S        E          (  N#00012930' TO DFHEIV0
 15422     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15423     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15424     MOVE X'204E233030303132393330' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 287
* EL131.cbl
 15425     CALL 'kxdfhei1' USING DFHEIV0,
 15426           CNTL-FILE-ID,
 15427           DFHEIV20,
 15428           DFHEIV99,
 15429           CNTL-KEY,
 15430           DFHEIV99,
 15431           DFHEIV99,
 15432           DFHEIV99
 15433     SET ADDRESS OF CONTROL-FILE TO
 15434         DFHEIV20
 15435     MOVE EIBRESP  TO WS-RESPONSE
 15436     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15437
 15438     IF WS-RESP-NORMAL
 15439        MOVE CF-APPROVAL-LEVEL   TO PI-APPROVAL-LEVEL
 15440     end-if
 15441     IF CL-INCURRED-DT GREATER THAN LOW-VALUES
 15442         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 15443         MOVE SPACES             TO DC-OPTION-CODE
 15444         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15445         MOVE DC-GREG-DATE-1-EDIT TO INCO
 15446     ELSE
 15447         MOVE SPACES             TO INCO.
 15448
 15449     IF (CL-NO-OF-PMTS-MADE = ZEROS)
 15450        OR (PI-APPROVAL-LEVEL = '4' OR '5')
 15451        MOVE AL-UANOF            TO INCA
 15452     end-if
 15453     MOVE CL-NO-OF-PMTS-MADE     TO PI-NO-PMTS.
 15454
 15455     IF CL-REPORTED-DT GREATER THAN LOW-VALUES
 15456         MOVE CL-REPORTED-DT     TO DC-BIN-DATE-1
 15457         MOVE SPACES             TO DC-OPTION-CODE
 15458         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15459         MOVE DC-GREG-DATE-1-EDIT TO REPO
 15460     ELSE
 15461         MOVE SPACES             TO REPO.
 15462
 15463     IF CL-FILE-ESTABLISH-DT GREATER THAN LOW-VALUES
 15464         MOVE CL-FILE-ESTABLISH-DT TO DC-BIN-DATE-1
 15465         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 15466         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15467         MOVE DC-GREG-DATE-1-EDIT TO ESTO
 15468     ELSE
 15469         MOVE SPACES             TO ESTO.
 15470
 15471     IF CL-LAST-MAINT-DT GREATER THAN LOW-VALUES
 15472         MOVE CL-LAST-MAINT-DT   TO DC-BIN-DATE-1
 15473         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 15474         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15475         MOVE DC-GREG-DATE-1-EDIT TO MNTDTO
 15476     ELSE
 15477         MOVE SPACES             TO MNTDTO.
 15478
 15479
 15480     IF CL-LAST-MAINT-TYPE = SPACE
 15481         MOVE 'SET-UP'           TO MNTTYPEO
 15482     ELSE
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 288
* EL131.cbl
 15483     IF CL-LAST-MAINT-TYPE = '1'
 15484         MOVE 'PAYMNT'           TO MNTTYPEO
 15485     ELSE
 15486     IF CL-LAST-MAINT-TYPE = '2'
 15487         MOVE 'LETTER'           TO MNTTYPEO
 15488     ELSE
 15489     IF CL-LAST-MAINT-TYPE = '3'
 15490         MOVE 'UPDATE'           TO MNTTYPEO
 15491     ELSE
 15492     IF CL-LAST-MAINT-TYPE = '4'
 15493         MOVE 'RESTOR'           TO MNTTYPEO
 15494     ELSE
 15495     IF CL-LAST-MAINT-TYPE = '5'
 15496         MOVE 'INC DT'           TO MNTTYPEO
 15497     ELSE
 15498     IF CL-LAST-MAINT-TYPE = '6'
 15499         MOVE ' CONV'            TO MNTTYPEO
 15500     ELSE
 15501     IF CL-LAST-MAINT-TYPE = 'C'
 15502         MOVE 'CHGBEN'           TO MNTTYPEO
 15503     ELSE
 15504     IF CL-LAST-MAINT-TYPE = 'E'
 15505         MOVE 'ERRCOR'           TO MNTTYPEO
 15506     ELSE
 15507         MOVE SPACES             TO MNTTYPEO.
 15508
 15509     MOVE CL-BENEFICIARY         TO BENEO.
 15510     MOVE CL-FILE-LOCATION       TO FILETOO.
 15511     IF CL-CRITICAL-PERIOD NOT NUMERIC
 15512        MOVE ZEROS               TO CL-CRITICAL-PERIOD
 15513     END-IF
 15514     MOVE CL-CRITICAL-PERIOD     TO CRITPO
 15515     IF CL-NO-OF-EXTENSIONS NOT NUMERIC
 15516        MOVE ZEROS               TO CL-NO-OF-EXTENSIONS
 15517     END-IF
 15518     MOVE CL-NO-OF-EXTENSIONS    TO EXTENSO
 15519*    MOVE CL-CRIT-PER-RECURRENT
 15520*                                TO CRITPTO
 15521*    IF CL-CRIT-PER-RTW-MOS NOT NUMERIC
 15522*       MOVE ZEROS               TO CL-CRIT-PER-RTW-MOS
 15523*    END-IF
 15524*    MOVE CL-CRIT-PER-RTW-MOS    TO RTWMOSO
 15525     MOVE CL-PRIORITY-CD         TO PRICDO.
 15526     MOVE CL-SUPV-ATTN-CD        TO SUPVO.
 15527     MOVE CL-LAST-MAINT-USER     TO PI-UPDATE-BY.
 15528     MOVE CL-LAST-MAINT-HHMMSS   TO PI-UPDATE-HHMMSS.
 15529     MOVE CL-AUTO-PAY-SEQ        TO PI-AUTO-PAY-SEQ.
 15530
 15531 5020-EXIT.
 15532     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 289
* EL131.cbl
 15534 5030-MOVE-CERT.
 15535
 15536     IF CM-CERT-EFF-DT GREATER THAN LOW-VALUES
 15537         MOVE CM-CERT-EFF-DT     TO DC-BIN-DATE-1
 15538         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 15539         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15540         MOVE DC-GREG-DATE-1-EDIT    TO CERTEFFO HOLD-DATE
 15541       ELSE
 15542         MOVE SPACES             TO CERTEFFO
 15543         MOVE ZERO               TO HOLD-DATE.
 15544
 15545     MOVE CM-ACCOUNT             TO CERTACTO.
 15546     MOVE CM-STATE               TO CERTSTO PI-STATE.
 15547     MOVE CM-GROUPING            TO CERTGRPO.
 15548     MOVE CM-CARRIER             TO CERTCARO.
 15549     MOVE CM-INSURED-LAST-NAME   TO CRTLNMEO.
 15550     MOVE CM-INSURED-INITIAL2    TO CRTINITO.
 15551     MOVE CM-INSURED-FIRST-NAME  TO CRTFNMEO.
 15552     MOVE CM-INSURED-ISSUE-AGE   TO ISSAGEO.
 15553     MOVE CM-JT-LAST-NAME        TO JNTLNMEO.
 15554     MOVE CM-JT-FIRST-NAME       TO JNTFNMEO.
 15555     MOVE CM-JT-INITIAL          TO JNTINITO.
 15556     MOVE CM-INSURED-JOINT-AGE   TO JNTAGEO.
 15557
 15558*** READ STATE MASTER RECORD FOR FREE LOOK PERIOD ***
 15559     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
 15560     MOVE '3'                    TO CNTL-REC-TYPE.
 15561     MOVE SPACES                 TO CNTL-STATE-ACCESS.
 15562     MOVE CM-STATE               TO CNTL-STATE-NUMBER.
 15563     MOVE ZERO                   TO CNTL-SEQ-NO.
 15564
 15565
 15566* EXEC CICS READ
 15567*         SET        (ADDRESS OF CONTROL-FILE)
 15568*         DATASET    ('ELCNTL')
 15569*         RIDFLD     (CNTL-KEY)
 15570*         RESP       (WS-RESPONSE)
 15571*    END-EXEC.
 15572     MOVE 'ELCNTL' TO DFHEIV1
 15573*    MOVE '&"S        E          (  N#00013064' TO DFHEIV0
 15574     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15575     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15576     MOVE X'204E233030303133303634' TO DFHEIV0(25:11)
 15577     CALL 'kxdfhei1' USING DFHEIV0,
 15578           DFHEIV1,
 15579           DFHEIV20,
 15580           DFHEIV99,
 15581           CNTL-KEY,
 15582           DFHEIV99,
 15583           DFHEIV99,
 15584           DFHEIV99
 15585     SET ADDRESS OF CONTROL-FILE TO
 15586         DFHEIV20
 15587     MOVE EIBRESP  TO WS-RESPONSE
 15588     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15589
 15590
 15591     IF WS-RESP-NOTFND
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 290
* EL131.cbl
 15592        MOVE ZERO                TO CP-FREE-LOOK
 15593     ELSE
 15594        MOVE CF-ST-FREE-LOOK-PERIOD
 15595                                 TO CP-FREE-LOOK.
 15596
 15597     IF CM-LF-BENEFIT-CD = '00'
 15598        GO TO 5030-MOVE-CERT-AH.
 15599
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 291
* EL131.cbl
 15601     MOVE EIBDATE                TO DC-JULIAN-YYDDD
 15602     MOVE '5'                    TO DC-OPTION-CODE
 15603     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15604     MOVE DC-BIN-DATE-1          TO WS-BIN-CURRENT-DT.
 15605     MOVE PI-LIFE-OVERRIDE-L6    TO LCVDSCRO.
 15606     MOVE CM-LF-BENEFIT-CD       TO LCVCDO HOLD-BENEFIT.
 15607     MOVE CM-LF-ORIG-TERM        TO LCVOTRMO  CP-ORIGINAL-TERM.
 15608     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT
 15609     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 15610     MOVE CL-INCURRED-DT         TO CP-VALUATION-DT
 15611     MOVE '4'                    TO CP-REM-TERM-METHOD
 15612     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID
 15613     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 15614     PERFORM 9700-LINK-RTRM-FILE-ID THRU 9700-EXIT.
 15615
 15616     MOVE CP-REMAINING-TERM-3    TO LCVRTRMO.
 15617     IF CM-LF-PREMIUM-RATE NUMERIC
 15618         MOVE CM-LF-PREMIUM-RATE TO LCVRATEO
 15619     ELSE
 15620         MOVE ZEROS              TO LCVRATEO.
 15621
 15622     IF CM-LF-ALT-BENEFIT-AMT NOT NUMERIC
 15623         MOVE ZEROS              TO CM-LF-ALT-BENEFIT-AMT.
 15624
 15625     COMPUTE LCVBENEO = CM-LF-BENEFIT-AMT + CM-LF-ALT-BENEFIT-AMT.
 15626
 15627     MOVE CM-POLICY-FORM-NO      TO LCVFORMO.
 15628
 15629     IF CM-LF-CURRENT-STATUS = '8'
 15630        IF CM-LF-CANCEL-DT NOT = LOW-VALUES
 15631            MOVE CM-LF-CANCEL-DT TO DC-BIN-DATE-1
 15632            MOVE ' '             TO DC-OPTION-CODE
 15633            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15634            IF NOT DATE-CONVERSION-ERROR
 15635                MOVE DC-GREG-DATE-1-EDIT     TO LCVCNDTO.
 15636
 15637     IF CM-LF-CURRENT-STATUS = '7'
 15638        IF CM-LF-DEATH-DT NOT = LOW-VALUES
 15639            MOVE CM-LF-DEATH-DT  TO DC-BIN-DATE-1
 15640            MOVE ' '             TO DC-OPTION-CODE
 15641            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15642            IF NOT DATE-CONVERSION-ERROR
 15643                MOVE DC-GREG-DATE-1-EDIT     TO LCVCNDTO.
 15644
 15645     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
 15646         MOVE ' '                TO DC-OPTION-CODE
 15647         MOVE CM-LF-DEATH-EXIT-DT TO DC-BIN-DATE-1
 15648         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15649         IF NOT DATE-CONVERSION-ERROR
 15650             MOVE DC-GREG-DATE-1-EDIT TO HOLD-DATE
 15651             MOVE HOLD-MONTH     TO WORK-MONTH
 15652             MOVE HOLD-YEAR      TO WORK-YEAR
 15653             MOVE WORK-DATE-MY   TO LCVEXITO.
 15654
 15655     IF CM-LF-CURRENT-STATUS = '1' OR = '4'
 15656        IF CP-REMAINING-TERM-3 = ZEROS
 15657           MOVE 'EXPIRED'        TO LCVSTATO
 15658        ELSE
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 292
* EL131.cbl
 15659           MOVE 'ACTIVE'         TO LCVSTATO.
 15660
 15661     IF CM-LF-CURRENT-STATUS = '2'
 15662        MOVE 'PEND   '           TO LCVSTATO.
 15663     IF CM-LF-CURRENT-STATUS = '3'
 15664        MOVE 'RESTORE'           TO LCVSTATO.
 15665     IF CM-LF-CURRENT-STATUS = '5'
 15666        MOVE 'REISSUE'           TO LCVSTATO.
 15667     IF CM-LF-CURRENT-STATUS = '6'
 15668        MOVE 'LMPBEN'            TO LCVSTATO.
 15669     IF CM-LF-CURRENT-STATUS = '7'
 15670        MOVE 'DEATH  '           TO LCVSTATO.
 15671     IF CM-LF-CURRENT-STATUS = '8'
 15672        MOVE 'CANCEL '           TO LCVSTATO.
 15673     IF CM-LF-CURRENT-STATUS = '9'
 15674        MOVE 'RE-ONLY'           TO LCVSTATO.
 15675     IF CM-LF-CURRENT-STATUS = 'V'
 15676        MOVE 'VOID   '           TO LCVSTATO.
 15677     IF CM-LF-CURRENT-STATUS = 'D'
 15678        MOVE 'DECLINE'           TO LCVSTATO.
 15679
 15680     MOVE SPACES                 TO BENEFIT-KEY ERROR-SWITCH.
 15681     MOVE PI-COMPANY-ID          TO BEN-CO-ID.
 15682     MOVE '4'                    TO BEN-REC-TYPE.
 15683     MOVE CM-LF-BENEFIT-CD       TO BEN-ACC-CD.
 15684     MOVE ZERO                   TO BEN-SEQ-NO.
 15685
 15686
 15687* EXEC CICS READ GTEQ
 15688*         DATASET  (CNTL-FILE-ID)
 15689*         RIDFLD   (BENEFIT-KEY)
 15690*         SET      (ADDRESS OF CONTROL-FILE)
 15691*    END-EXEC.
 15692*    MOVE '&"S        G          (   #00013166' TO DFHEIV0
 15693     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 15694     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15695     MOVE X'2020233030303133313636' TO DFHEIV0(25:11)
 15696     CALL 'kxdfhei1' USING DFHEIV0,
 15697           CNTL-FILE-ID,
 15698           DFHEIV20,
 15699           DFHEIV99,
 15700           BENEFIT-KEY,
 15701           DFHEIV99,
 15702           DFHEIV99,
 15703           DFHEIV99
 15704     SET ADDRESS OF CONTROL-FILE TO
 15705         DFHEIV20
 15706     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15707
 15708
 15709     IF CF-COMPANY-ID NOT = PI-COMPANY-ID OR
 15710        CF-RECORD-TYPE NOT = '4'
 15711         MOVE ER-0240            TO EMI-ERROR
 15712         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15713         GO TO 5030-MOVE-CERT-FINISH.
 15714
 15715     MOVE ZERO                   TO COUNT-2.
 15716     PERFORM 5040-FIND-BENEFIT THRU 5060-EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 293
* EL131.cbl
 15717
 15718     IF SCREEN-ERROR
 15719         MOVE ER-0282            TO EMI-ERROR
 15720         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15721        ELSE
 15722         MOVE CF-BENEFIT-ALPHA (COUNT-2) TO LCVKINDO.
 15723
 15724 5030-MOVE-CERT-AH.
 15725
 15726     IF CM-LF-BENEFIT-CD = '00'
 15727         IF CM-AH-BENEFIT-CD = '00'
 15728             GO TO 5030-MOVE-CERT-FINISH.
 15729
 15730     IF CM-AH-BENEFIT-CD = '00'
 15731        MOVE SPACES             TO ACVKINDO
 15732        COMPUTE PI-PAYMENT-AMT =
 15733                    CM-LF-BENEFIT-AMT / CM-LF-ORIG-TERM
 15734        GO TO 5030-MOVE-CERT-FINISH.
 15735
 15736     MOVE PI-AH-OVERRIDE-L6      TO ACVDSCRO.
 15737     MOVE CM-AH-BENEFIT-CD       TO ACVCDO HOLD-BENEFIT.
 15738     MOVE DC-GREG-DATE-1-EDIT    TO HOLD-DATE.
 15739     MOVE CM-AH-ORIG-TERM        TO ACVOTRMO CP-ORIGINAL-TERM.
 15740     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT
 15741     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 15742     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 15743     MOVE SAVE-BIN-DATE          TO CP-VALUATION-DT.
 15744
 15745**DMD **********************************************
 15746     IF PI-COMPANY-ID = 'DMD'
 15747         COMPUTE WS-TERM-IN-DAYS = CM-AH-ORIG-TERM * 30 +
 15748                                   CM-PMT-EXTENSION-DAYS
 15749         COMPUTE WS-REM-TERM-IN-DAYS = WS-TERM-IN-DAYS -
 15750                                      CL-NO-OF-DAYS-PAID
 15751         DIVIDE WS-REM-TERM-IN-DAYS BY +30
 15752             GIVING WS-REM-MOS REMAINDER WS-REM-DAYS
 15753         MOVE WS-REM-MOS         TO ACVRTRMO
 15754                                    CP-REMAINING-TERM-3
 15755*        MOVE WS-REM-DAYS        TO DAYSPO
 15756         GO TO 5030-SKIP-RTRM.
 15757**DMD **********************************************
 15758
 15759     MOVE '4'                    TO CP-REM-TERM-METHOD.
 15760     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 15761     PERFORM 9700-LINK-RTRM-FILE-ID THRU 9700-EXIT.
 15762     MOVE CP-REMAINING-TERM-3    TO ACVRTRMO.
 15763
 15764 5030-SKIP-RTRM.
 15765     IF CM-AH-PREMIUM-RATE NUMERIC
 15766         MOVE CM-AH-PREMIUM-RATE TO ACVRATEO
 15767     ELSE
 15768         MOVE ZEROS              TO ACVRATEO.
 15769
 15770     MOVE CM-AH-BENEFIT-AMT      TO ACVBENEO  PI-PAYMENT-AMT.
 15771     MOVE CM-POLICY-FORM-NO      TO ACVFORMO.
 15772
 15773     IF CM-AH-CURRENT-STATUS = '8'
 15774        IF CM-AH-CANCEL-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 294
* EL131.cbl
 15775            MOVE CM-AH-CANCEL-DT TO DC-BIN-DATE-1
 15776            MOVE ' '             TO DC-OPTION-CODE
 15777            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15778            IF NOT DATE-CONVERSION-ERROR
 15779                MOVE DC-GREG-DATE-1-EDIT     TO ACVCNDTO.
 15780
 15781     IF CM-AH-CURRENT-STATUS = '6' OR '7'
 15782        IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
 15783            MOVE CM-AH-SETTLEMENT-DT         TO DC-BIN-DATE-1
 15784            MOVE ' '             TO DC-OPTION-CODE
 15785            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15786            IF NOT DATE-CONVERSION-ERROR
 15787                MOVE DC-GREG-DATE-1-EDIT     TO ACVCNDTO.
 15788
 15789     IF CM-AH-CURRENT-STATUS = '1' OR = '4'
 15790        IF CP-REMAINING-TERM-3 = ZEROS
 15791           MOVE 'EXPIRED'        TO ACVSTATO
 15792        ELSE
 15793           MOVE 'ACTIVE'         TO ACVSTATO.
 15794
 15795     IF CM-AH-CURRENT-STATUS = '2'
 15796        MOVE 'PEND   '           TO ACVSTATO.
 15797     IF CM-AH-CURRENT-STATUS = '3'
 15798        MOVE 'RESTORE'           TO ACVSTATO.
 15799     IF CM-AH-CURRENT-STATUS = '5'
 15800        MOVE 'REISSUE'           TO ACVSTATO.
 15801     IF CM-AH-CURRENT-STATUS = '6'
 15802        MOVE 'LMP DIS'           TO ACVSTATO.
 15803     IF CM-AH-CURRENT-STATUS = '7'
 15804        MOVE 'DEATH  '           TO ACVSTATO.
 15805     IF CM-AH-CURRENT-STATUS = '8'
 15806        MOVE 'CANCEL '           TO ACVSTATO.
 15807     IF CM-AH-CURRENT-STATUS = '9'
 15808        MOVE 'RE-ONLY'           TO ACVSTATO.
 15809     IF CM-AH-CURRENT-STATUS = 'V'
 15810        MOVE 'VOID   '           TO ACVSTATO.
 15811     IF CM-AH-CURRENT-STATUS = '9'
 15812        MOVE 'DECLINE'           TO ACVSTATO.
 15813
 15814     IF CM-AH-SETTLEMENT-EXIT-DT NOT = LOW-VALUES
 15815         MOVE ' '                TO DC-OPTION-CODE
 15816         MOVE CM-AH-SETTLEMENT-EXIT-DT TO DC-BIN-DATE-1
 15817         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15818         IF NOT DATE-CONVERSION-ERROR
 15819             MOVE DC-GREG-DATE-1-EDIT     TO HOLD-DATE
 15820             MOVE HOLD-MONTH     TO WORK-MONTH
 15821             MOVE HOLD-YEAR      TO WORK-YEAR
 15822             MOVE WORK-DATE-MY   TO ACVEXITO.
 15823
 15824     MOVE SPACES                 TO BENEFIT-KEY ERROR-SWITCH.
 15825
 15826     MOVE PI-COMPANY-ID          TO BEN-CO-ID.
 15827     MOVE '5'                    TO BEN-REC-TYPE.
 15828     MOVE CM-AH-BENEFIT-CD       TO BEN-ACC-CD.
 15829     MOVE ZERO                   TO BEN-SEQ-NO.
 15830
 15831
 15832* EXEC CICS READ GTEQ
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 295
* EL131.cbl
 15833*         DATASET  (CNTL-FILE-ID)
 15834*         RIDFLD   (BENEFIT-KEY)
 15835*         SET      (ADDRESS OF CONTROL-FILE)
 15836*    END-EXEC.
 15837*    MOVE '&"S        G          (   #00013294' TO DFHEIV0
 15838     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 15839     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15840     MOVE X'2020233030303133323934' TO DFHEIV0(25:11)
 15841     CALL 'kxdfhei1' USING DFHEIV0,
 15842           CNTL-FILE-ID,
 15843           DFHEIV20,
 15844           DFHEIV99,
 15845           BENEFIT-KEY,
 15846           DFHEIV99,
 15847           DFHEIV99,
 15848           DFHEIV99
 15849     SET ADDRESS OF CONTROL-FILE TO
 15850         DFHEIV20
 15851     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15852
 15853
 15854     IF CF-COMPANY-ID NOT = PI-COMPANY-ID OR
 15855        CF-RECORD-TYPE NOT = '5'
 15856         MOVE ER-0250            TO EMI-ERROR
 15857         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15858         GO TO 5030-MOVE-CERT-FINISH.
 15859
 15860     MOVE ZERO                   TO COUNT-2.
 15861     PERFORM 5040-FIND-BENEFIT THRU 5060-EXIT.
 15862
 15863     IF SCREEN-ERROR
 15864         MOVE ER-0283            TO EMI-ERROR
 15865         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15866       ELSE
 15867         MOVE CF-BENEFIT-ALPHA (COUNT-2) TO ACVKINDO.
 15868
 15869 5030-MOVE-CERT-FINISH.
 15870
 15871     MOVE CM-LOAN-APR            TO APRO.
 15872     MOVE CM-PAY-FREQUENCY       TO PMTFREQO.
 15873     MOVE CM-IND-GRP-TYPE        TO INDGRPO.
 15874     MOVE CM-PREMIUM-TYPE        TO PREMTYPO  PI-PREM-TYPE.
 15875*    MOVE CM-LOAN-NUMBER         TO LOANNOO
 15876     MOVE CM-LOAN-BALANCE        TO LOANBALO.
 15877     MOVE CM-SPECIAL-REIN-CODE   TO REINCDO.
 15878
 15879     IF CM-LAST-ADD-ON-DT NOT = SPACES  AND  ZEROS
 15880         MOVE CM-LAST-ADD-ON-DT  TO DC-BIN-DATE-1
 15881         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 15882         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15883         MOVE DC-GREG-DATE-1-EDIT  TO ADDONDTO
 15884     ELSE
 15885         MOVE SPACES               TO ADDONDTO.
 15886
 15887     MOVE CM-CLAIM-INTERFACE-SW  TO PI-CERT-SWITCH.
 15888
 15889 5030-EXIT.
 15890     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 296
* EL131.cbl
 15892 5040-FIND-BENEFIT.
 15893     ADD 1                       TO COUNT-2.
 15894     IF COUNT-2 GREATER THAN 8
 15895         GO TO 5050-BENEFIT-NOTFND.
 15896
 15897     IF CF-BENEFIT-CODE (COUNT-2) = HOLD-BENEFIT
 15898         GO TO 5060-EXIT.
 15899
 15900     IF CF-BENEFIT-CODE (COUNT-2) GREATER THAN HOLD-BENEFIT
 15901         GO TO 5050-BENEFIT-NOTFND.
 15902
 15903     GO TO 5040-FIND-BENEFIT.
 15904
 15905 5050-BENEFIT-NOTFND.
 15906     MOVE 'X'                    TO ERROR-SWITCH.
 15907
 15908 5060-EXIT.
 15909     EXIT.
 15910 5100-LOAD-CORR-TRLR.
 15911     MOVE PI-COMPANY-CD      TO TRLR-COMPANY-CD.
 15912     MOVE PI-CARRIER         TO TRLR-CARRIER.
 15913     MOVE PI-CLAIM-NO        TO TRLR-CLAIM-NO.
 15914     MOVE PI-CERT-NO         TO TRLR-CERT-NO.
 15915     MOVE 1000               TO TRLR-SEQ-NO.
 15916
 15917
 15918* EXEC CICS HANDLE CONDITION
 15919*         NOTFND    (1052-DONE)
 15920*         ENDFILE   (1052-DONE)
 15921*    END-EXEC.
 15922*    MOVE '"$I''                  ! D #00013363' TO DFHEIV0
 15923     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 15924     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15925     MOVE X'4420233030303133333633' TO DFHEIV0(25:11)
 15926     CALL 'kxdfhei1' USING DFHEIV0
 15927     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15928
 15929
 15930
 15931* EXEC CICS STARTBR
 15932*        DATASET (TRLR-FILE-ID)
 15933*        RIDFLD  (TRLR-KEY)
 15934*    END-EXEC
 15935     MOVE 0
 15936       TO DFHEIV11
 15937*    MOVE '&,         G          &   #00013368' TO DFHEIV0
 15938     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 15939     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 15940     MOVE X'2020233030303133333638' TO DFHEIV0(25:11)
 15941     CALL 'kxdfhei1' USING DFHEIV0,
 15942           TRLR-FILE-ID,
 15943           TRLR-KEY,
 15944           DFHEIV99,
 15945           DFHEIV11,
 15946           DFHEIV99
 15947     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15948
 15949
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 297
* EL131.cbl
 15950     MOVE SPACES TO WS-TRLR-FILE-EOF
 15951                    WS-AUTH-RCVD
 15952     PERFORM 1052-READ-TRLR THRU 1052-EXIT
 15953       UNTIL  TRLR-FILE-EOF
 15954         OR WS-AUTH-RCVD > SPACES.
 15955
 15956
 15957* EXEC CICS ENDBR
 15958*        DATASET (TRLR-FILE-ID)
 15959*    END-EXEC.
 15960     MOVE 0
 15961       TO DFHEIV11
 15962*    MOVE '&2                    $   #00013380' TO DFHEIV0
 15963     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 15964     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15965     MOVE X'2020233030303133333830' TO DFHEIV0(25:11)
 15966     CALL 'kxdfhei1' USING DFHEIV0,
 15967           TRLR-FILE-ID,
 15968           DFHEIV11,
 15969           DFHEIV99
 15970     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15971
 15972
 15973     IF AUTH-RCVD
 15974        MOVE 'Y' TO AUTHRCVO
 15975     ELSE
 15976        MOVE 'N' TO AUTHRCVO
 15977     END-IF.
 15978
 15979
 15980 5100-EXIT.
 15981     EXIT.
 15982
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 298
* EL131.cbl
 15984 6000-CALCULATE-CERT-TERM.
 15985
 15986     IF CM-LF-PREMIUM-RATE NOT NUMERIC
 15987         MOVE ZEROS              TO CM-LF-PREMIUM-RATE.
 15988     IF CM-AH-PREMIUM-RATE NOT NUMERIC
 15989         MOVE ZEROS              TO CM-AH-PREMIUM-RATE.
 15990     IF CM-LOAN-APR NOT NUMERIC
 15991         MOVE ZEROS              TO CM-LOAN-APR.
 15992
 15993*    IF WS-CALC-METHOD  = 'G'
 15994         PERFORM 6100-CALC-GROSS-TERM THRU 6200-EXIT
 15995*     ELSE
 15996*        PERFORM 6500-CALC-NET-TERM   THRU 6700-EXIT.
 15997
 15998     IF N GREATER 120
 15999         MOVE 120                TO N.
 16000
 16001     MOVE '6'                    TO DC-OPTION-CODE.
 16002     MOVE N                      TO DC-ELAPSED-MONTHS.
 16003     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1.
 16004     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
 16005
 16006     IF CM-LF-BENEFIT-CD NOT = ZERO
 16007         MOVE N                  TO CM-LF-ORIG-TERM
 16008         COMPUTE CM-LF-BENEFIT-AMT = PI-PAYMENT-AMT * N
 16009         IF NO-CONVERSION-ERROR
 16010             MOVE DC-BIN-DATE-2  TO CM-LF-LOAN-EXPIRE-DT.
 16011
 16012     IF CM-AH-BENEFIT-CD NOT = ZERO
 16013         MOVE N                  TO CM-AH-ORIG-TERM
 16014         IF NO-CONVERSION-ERROR
 16015             MOVE DC-BIN-DATE-2  TO CM-AH-LOAN-EXPIRE-DT.
 16016
 16017 6000-EXIT.
 16018      EXIT.
 16019
 16020 6100-CALC-GROSS-TERM.
 16021     MOVE CM-LOAN-BALANCE         TO L.
 16022     MOVE PI-PAYMENT-AMT          TO M.
 16023
 16024     COMPUTE N = L / M.
 16025     IF N LESS 1
 16026         MOVE 1  TO N.
 16027
 16028     IF CM-LF-BENEFIT-CD NOT = ZERO
 16029         COMPUTE WS-LF-RATE = CM-LF-PREMIUM-RATE / +1000
 16030     ELSE
 16031         MOVE ZEROS               TO WS-LF-RATE.
 16032
 16033     IF CM-AH-BENEFIT-CD NOT = ZERO
 16034         COMPUTE WS-AH-RATE = CM-AH-PREMIUM-RATE / +1000
 16035     ELSE
 16036         MOVE ZEROS               TO WS-AH-RATE.
 16037
 16038     COMPUTE I = CM-LOAN-APR / +1200.
 16039
 16040 6105-LOOP.
 16041     IF N GREATER 240
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 299
* EL131.cbl
 16042         GO TO 6200-EXIT.
 16043     PERFORM 6210-CALC-LEFT-RIGHTONE THRU 6220-EXIT.
 16044     IF LEFT-TOT-1 GREATER RIGHT-TOT-1
 16045         ADD 1 TO N
 16046         GO TO 6105-LOOP.
 16047
 16048 6200-EXIT.
 16049      EXIT.
 16050
 16051 6210-CALC-LEFT-RIGHTONE.
 16052      MOVE L         TO LEFT-TOT-1.
 16053      SUBTRACT 1 FROM N.
 16054      PERFORM 6300-CALC-A-N THRU 6300-EXIT.
 16055      PERFORM 6350-CALC-IA-N THRU 6400-EXIT.
 16056      ADD 1 TO N.
 16057 6211-CALC-TERM1.
 16058      MOVE N         TO TERM1.
 16059      MULTIPLY M BY TERM1.
 16060 6212-LOOP.
 16061      COMPUTE TERM1 = (WS-AH-RATE + WS-LF-RATE) * TERM1.
 16062      ADD 1 TO A-N.
 16063      MULTIPLY A-N BY TERM1.
 16064      SUBTRACT 1 FROM A-N.
 16065      ADD TERM1 TO LEFT-TOT-1.
 16066 6213-CALC-TERM2.
 16067      MOVE M         TO TERM2.
 16068      COMPUTE TERM2 = (WS-AH-RATE + WS-LF-RATE) * TERM2.
 16069      MULTIPLY IA-N BY TERM2.
 16070      SUBTRACT TERM2 FROM LEFT-TOT-1.
 16071 6215-CALC-RIGHTONE.
 16072      MOVE M         TO RIGHT-TOT-1.
 16073      PERFORM 6300-CALC-A-N THRU 6300-EXIT.
 16074      MULTIPLY A-N BY RIGHT-TOT-1.
 16075 6220-EXIT.
 16076      EXIT.
 16077
 16078 6300-CALC-A-N.
 16079     IF N LESS 1
 16080         MOVE 0     TO A-N
 16081         GO TO 6300-EXIT.
 16082     IF I = 0
 16083         MOVE .00001 TO I.
 16084     ADD 1 TO I.
 16085     DIVIDE I INTO 1 GIVING V.
 16086     SUBTRACT 1 FROM I.
 16087     PERFORM 6450-CALC-V-EX-N THRU 6490-EXIT.
 16088     SUBTRACT V-EX-N FROM 1 GIVING TERM3.
 16089     DIVIDE I INTO TERM3 GIVING A-N.
 16090 6300-EXIT.
 16091      EXIT.
 16092
 16093 6350-CALC-IA-N.
 16094     IF N LESS 1
 16095         MOVE 0      TO IA-N
 16096         GO TO 6400-EXIT.
 16097     ADD 1 TO N.
 16098     PERFORM 6450-CALC-V-EX-N THRU 6490-EXIT.
 16099     SUBTRACT 1 FROM N.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 300
* EL131.cbl
 16100     MULTIPLY N BY V-EX-N GIVING TERM3.
 16101     SUBTRACT TERM3 FROM A-N GIVING TERM3.
 16102     SUBTRACT V FROM 1 GIVING TERM4.
 16103     DIVIDE TERM4 INTO TERM3 GIVING IA-N.
 16104 6400-EXIT.
 16105      EXIT.
 16106
 16107 6450-CALC-V-EX-N.
 16108     IF N LESS 1
 16109         MOVE 1    TO V-EX-N
 16110         GO TO 6490-EXIT.
 16111     MOVE N        TO NV-STORE.
 16112     IF V-EX-ONETIME = 1  OR
 16113        V NOT = V-EXPONENT (1)
 16114          PERFORM 6470-BUILD-V-EX-TABLE THRU 6480-EXIT.
 16115 6460-LOOP.
 16116     IF N GREATER 248
 16117         MOVE 248 TO N.
 16118     IF N = 1
 16119         MOVE V               TO V-EX-N
 16120      ELSE
 16121         MOVE V-EXPONENT (N)  TO V-EX-N.
 16122     GO TO 6490-EXIT.
 16123
 16124 6470-BUILD-V-EX-TABLE.
 16125     MOVE 2      TO N.
 16126     MOVE V      TO V-EXPONENT (1)
 16127                    V-EX-N.
 16128 6471-LOOP.
 16129     MULTIPLY V BY V-EX-N.
 16130     MOVE V-EX-N   TO V-EXPONENT (N).
 16131     ADD 1 TO N.
 16132     IF N LESS 248
 16133         GO TO 6471-LOOP.
 16134     MOVE NV-STORE     TO N.
 16135     MOVE 0            TO V-EX-ONETIME.
 16136 6480-EXIT.
 16137      EXIT.
 16138
 16139 6490-EXIT.
 16140      EXIT.
 16141
 16142 6500-CALC-NET-TERM.
 16143     MOVE CM-LOAN-BALANCE         TO L.
 16144     MOVE PI-PAYMENT-AMT          TO M.
 16145
 16146     DIVIDE L BY M GIVING N REMAINDER WS-REMAIN.
 16147     IF WS-REMAIN GREATER ZERO
 16148         ADD 1 TO N.
 16149     IF N = 0
 16150         MOVE 1 TO N.
 16151
 16152 6700-EXIT.
 16153      EXIT.
 16154
 16155 6999-CALC-TERM-EXIT.
 16156     EXIT.
 16157
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 301
* EL131.cbl
 16159 7000-RESET-ATTRIBUTE.
 16160
 16161     MOVE AL-UANON               TO CERTEFFA  CERTACTA
 16162                                    CERTSTA   CERTCARA
 16163                                    CERTGRPA.
 16164     MOVE -1                     TO CERTCARL.
 16165
 16166 7000-EXIT.
 16167     EXIT.
 16168
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 302
* EL131.cbl
 16170 7600-BROWSE-CLAIM.
 16171
 16172
 16173* EXEC CICS READ
 16174*        DATASET(CLMS-FILE-ID)
 16175*        SET    (ADDRESS OF CLAIM-MASTER)
 16176*        RIDFLD (MSTR-KEY)
 16177*        GENERIC
 16178*        EQUAL
 16179*        KEYLENGTH(ELMSTR-GENERIC-LENGTH)
 16180*    END-EXEC.
 16181*    MOVE '&"S  KG    E          (   #00013583' TO DFHEIV0
 16182     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 16183     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16184     MOVE X'2020233030303133353833' TO DFHEIV0(25:11)
 16185     CALL 'kxdfhei1' USING DFHEIV0,
 16186           CLMS-FILE-ID,
 16187           DFHEIV20,
 16188           DFHEIV99,
 16189           MSTR-KEY,
 16190           ELMSTR-GENERIC-LENGTH,
 16191           DFHEIV99,
 16192           DFHEIV99
 16193     SET ADDRESS OF CLAIM-MASTER TO
 16194         DFHEIV20
 16195     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16196
 16197
 16198     MOVE CL-CONTROL-PRIMARY     TO MSTR-KEY.
 16199
 16200     if cl-assoc-cert-total = 0
 16201        move 1 to cl-assoc-cert-total
 16202     end-if
 16203     IF CL-ASSOC-CERT-SEQU = 0
 16204        MOVE 1 TO CL-ASSOC-CERT-SEQU
 16205     END-IF
 16206
 16207     IF CL-ASSOC-CERT-TOTAL = 1
 16208         MOVE AL-SADOF           TO BCERT1A
 16209                                    BSUFX1A
 16210                                    BCERT2A
 16211                                    BSUFX2A
 16212                                    BCERT3A
 16213                                    BSUFX3A
 16214                                    BCERT4A
 16215                                    BSUFX4A
 16216                                    BCERT5A
 16217                                    BSUFX5A
 16218                                    PCERTNOA
 16219                                    PSUFXA
 16220                                    LABEL1A
 16221                                    LABEL2A
 16222         GO TO 7699-EXIT.
 16223
 16224 7610-BROWSE-CLAIM-LOOP.
 16225
 16226     MOVE LOW-VALUES             TO BCERT1O
 16227                                    BSUFX1O
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 303
* EL131.cbl
 16228                                    BCERT2O
 16229                                    BSUFX2O
 16230                                    BCERT3O
 16231                                    BSUFX3O
 16232                                    BCERT4O
 16233                                    BSUFX4O
 16234                                    BCERT5O
 16235                                    BSUFX5O.
 16236
 16237
 16238* EXEC CICS HANDLE CONDITION
 16239*        ENDFILE  (7630-END-BROWSE)
 16240*    END-EXEC.
 16241*    MOVE '"$''                   ! E #00013631' TO DFHEIV0
 16242     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 16243     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16244     MOVE X'4520233030303133363331' TO DFHEIV0(25:11)
 16245     CALL 'kxdfhei1' USING DFHEIV0
 16246     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16247
 16248
 16249
 16250* EXEC CICS STARTBR
 16251*        DATASET    (CLMS-FILE-ID)
 16252*        RIDFLD     (MSTR-KEY)
 16253*    END-EXEC.
 16254     MOVE 0
 16255       TO DFHEIV11
 16256*    MOVE '&,         G          &   #00013635' TO DFHEIV0
 16257     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 16258     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16259     MOVE X'2020233030303133363335' TO DFHEIV0(25:11)
 16260     CALL 'kxdfhei1' USING DFHEIV0,
 16261           CLMS-FILE-ID,
 16262           MSTR-KEY,
 16263           DFHEIV99,
 16264           DFHEIV11,
 16265           DFHEIV99
 16266     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16267
 16268
 16269     MOVE +1                     TO WS-ASSOCIATED-CERTS.
 16270
 16271 7620-READ-CLAIM-LOOP.
 16272
 16273
 16274* EXEC CICS READNEXT
 16275*        DATASET   (CLMS-FILE-ID)
 16276*        SET       (ADDRESS OF CLAIM-MASTER)
 16277*        RIDFLD    (MSTR-KEY)
 16278*    END-EXEC.
 16279     MOVE 0
 16280       TO DFHEIV11
 16281*    MOVE '&.S                   )   #00013644' TO DFHEIV0
 16282     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 16283     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 16284     MOVE X'2020233030303133363434' TO DFHEIV0(25:11)
 16285     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 304
* EL131.cbl
 16286           CLMS-FILE-ID,
 16287           DFHEIV20,
 16288           DFHEIV99,
 16289           MSTR-KEY,
 16290           DFHEIV99,
 16291           DFHEIV11,
 16292           DFHEIV99,
 16293           DFHEIV99
 16294     SET ADDRESS OF CLAIM-MASTER TO
 16295         DFHEIV20
 16296     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16297
 16298
 16299     IF CL-COMPANY-CD  NOT = PI-COMPANY-CD   OR
 16300        CL-CARRIER     NOT = CARRI           OR
 16301        CL-CLAIM-NO    NOT = CLAIMI
 16302        GO TO 7630-END-BROWSE.
 16303
 16304     IF WS-ASSOCIATED-CERTS = 1
 16305         MOVE CL-CERT-PRIME      TO BCERT1O
 16306         MOVE CL-CERT-SFX        TO BSUFX1O.
 16307
 16308     IF WS-ASSOCIATED-CERTS = 2
 16309         MOVE CL-CERT-PRIME      TO BCERT2O
 16310         MOVE CL-CERT-SFX        TO BSUFX2O.
 16311
 16312     IF WS-ASSOCIATED-CERTS = 3
 16313         MOVE CL-CERT-PRIME      TO BCERT3O
 16314         MOVE CL-CERT-SFX        TO BSUFX3O.
 16315
 16316     IF WS-ASSOCIATED-CERTS = 4
 16317         MOVE CL-CERT-PRIME      TO BCERT4O
 16318         MOVE CL-CERT-SFX        TO BSUFX4O.
 16319
 16320     IF WS-ASSOCIATED-CERTS = 5
 16321         MOVE CL-CERT-PRIME      TO BCERT5O
 16322         MOVE CL-CERT-SFX        TO BSUFX5O
 16323     ELSE
 16324         ADD +1                  TO WS-ASSOCIATED-CERTS
 16325         GO TO 7620-READ-CLAIM-LOOP.
 16326
 16327 7630-END-BROWSE.
 16328
 16329
 16330* EXEC CICS ENDBR
 16331*        DATASET   (CLMS-FILE-ID)
 16332*    END-EXEC.
 16333     MOVE 0
 16334       TO DFHEIV11
 16335*    MOVE '&2                    $   #00013680' TO DFHEIV0
 16336     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 16337     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16338     MOVE X'2020233030303133363830' TO DFHEIV0(25:11)
 16339     CALL 'kxdfhei1' USING DFHEIV0,
 16340           CLMS-FILE-ID,
 16341           DFHEIV11,
 16342           DFHEIV99
 16343     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 305
* EL131.cbl
 16344
 16345
 16346 7640-HIGHLIGHT-CERT-DISPLAYED.
 16347
 16348     MOVE AL-SANON               TO BCERT1A
 16349                                    BSUFX1A
 16350                                    BCERT2A
 16351                                    BSUFX2A
 16352                                    BCERT3A
 16353                                    BSUFX3A
 16354                                    BCERT4A
 16355                                    BSUFX4A
 16356                                    BCERT5A
 16357                                    BSUFX5A.
 16358
 16359     IF BCERT1O = CERTI AND
 16360        BSUFX1O = SUFXI
 16361            MOVE AL-SABON        TO BCERT1A
 16362                                    BSUFX1A.
 16363
 16364     IF BCERT2O = CERTI AND
 16365        BSUFX2O = SUFXI
 16366            MOVE AL-SABON        TO BCERT2A
 16367                                    BSUFX2A.
 16368
 16369     IF BCERT3O = CERTI AND
 16370        BSUFX3O = SUFXI
 16371            MOVE AL-SABON        TO BCERT3A
 16372                                    BSUFX3A.
 16373
 16374     IF BCERT4O = CERTI AND
 16375        BSUFX4O = SUFXI
 16376            MOVE AL-SABON        TO BCERT4A
 16377                                    BSUFX4A.
 16378
 16379     IF BCERT5O = CERTI AND
 16380        BSUFX5O = SUFXI
 16381            MOVE AL-SABON        TO BCERT5A
 16382                                    BSUFX5A.
 16383
 16384 7699-EXIT.
 16385     EXIT.
 16386
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 306
* EL131.cbl
 16388 7700-CHECK-SEQUENCE.
 16389
 16390
 16391* EXEC CICS HANDLE CONDITION
 16392*        ENDFILE  (7799-EXIT)
 16393*        NOTFND   (7799-EXIT)
 16394*    END-EXEC.
 16395*    MOVE '"$''I                  ! F #00013728' TO DFHEIV0
 16396     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 16397     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16398     MOVE X'4620233030303133373238' TO DFHEIV0(25:11)
 16399     CALL 'kxdfhei1' USING DFHEIV0
 16400     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16401
 16402
 16403
 16404* EXEC CICS READ
 16405*        DATASET(CLMS-FILE-ID)
 16406*        SET    (ADDRESS OF CLAIM-MASTER)
 16407*        RIDFLD (MSTR-KEY)
 16408*        GENERIC
 16409*        KEYLENGTH(ELMSTR-GENERIC-LENGTH)
 16410*    END-EXEC.
 16411*    MOVE '&"S  KG    E          (   #00013733' TO DFHEIV0
 16412     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 16413     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16414     MOVE X'2020233030303133373333' TO DFHEIV0(25:11)
 16415     CALL 'kxdfhei1' USING DFHEIV0,
 16416           CLMS-FILE-ID,
 16417           DFHEIV20,
 16418           DFHEIV99,
 16419           MSTR-KEY,
 16420           ELMSTR-GENERIC-LENGTH,
 16421           DFHEIV99,
 16422           DFHEIV99
 16423     SET ADDRESS OF CLAIM-MASTER TO
 16424         DFHEIV20
 16425     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16426
 16427
 16428     COMPUTE WS-ASSOC-CERT-TOTAL =
 16429             CL-ASSOC-CERT-TOTAL + ONE-OR-MIN1.
 16430
 16431     GO TO 7799-EXIT.
 16432
 16433 7710-RESEQUENCE-CLAIMS.
 16434
 16435
 16436* EXEC CICS HANDLE CONDITION
 16437*        ENDFILE  (7799-EXIT)
 16438*    END-EXEC.
 16439*    MOVE '"$''                   ! G #00013748' TO DFHEIV0
 16440     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 16441     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16442     MOVE X'4720233030303133373438' TO DFHEIV0(25:11)
 16443     CALL 'kxdfhei1' USING DFHEIV0
 16444     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16445
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 307
* EL131.cbl
 16446
 16447
 16448* EXEC CICS STARTBR
 16449*        DATASET(CLMS-FILE-ID)
 16450*        RIDFLD (MSTR-KEY)
 16451*    END-EXEC.
 16452     MOVE 0
 16453       TO DFHEIV11
 16454*    MOVE '&,         G          &   #00013752' TO DFHEIV0
 16455     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 16456     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16457     MOVE X'2020233030303133373532' TO DFHEIV0(25:11)
 16458     CALL 'kxdfhei1' USING DFHEIV0,
 16459           CLMS-FILE-ID,
 16460           MSTR-KEY,
 16461           DFHEIV99,
 16462           DFHEIV11,
 16463           DFHEIV99
 16464     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16465
 16466
 16467     COMPUTE WS-ASSOC-CERT-SEQU =
 16468             WS-ASSOC-CERT-SEQU + 1.
 16469
 16470     COMPUTE WS-READNEXT-SWITCH =
 16471             WS-READNEXT-SWITCH + 1.
 16472
 16473 7720-READ-CLAIM-LOOP.
 16474
 16475
 16476* EXEC CICS READNEXT
 16477*        DATASET(CLMS-FILE-ID)
 16478*        SET    (ADDRESS OF CLAIM-MASTER)
 16479*        RIDFLD (MSTR-KEY)
 16480*    END-EXEC.
 16481     MOVE 0
 16482       TO DFHEIV11
 16483*    MOVE '&.S                   )   #00013765' TO DFHEIV0
 16484     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 16485     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 16486     MOVE X'2020233030303133373635' TO DFHEIV0(25:11)
 16487     CALL 'kxdfhei1' USING DFHEIV0,
 16488           CLMS-FILE-ID,
 16489           DFHEIV20,
 16490           DFHEIV99,
 16491           MSTR-KEY,
 16492           DFHEIV99,
 16493           DFHEIV11,
 16494           DFHEIV99,
 16495           DFHEIV99
 16496     SET ADDRESS OF CLAIM-MASTER TO
 16497         DFHEIV20
 16498     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16499
 16500
 16501     IF WS-READNEXT-SWITCH = 1
 16502         ADD 1                   TO WS-READNEXT-SWITCH
 16503         GO TO 7720-READ-CLAIM-LOOP.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 308
* EL131.cbl
 16504
 16505 7730-END-BROWSE.
 16506
 16507
 16508* EXEC CICS ENDBR
 16509*        DATASET(CLMS-FILE-ID)
 16510*    END-EXEC.
 16511     MOVE 0
 16512       TO DFHEIV11
 16513*    MOVE '&2                    $   #00013777' TO DFHEIV0
 16514     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 16515     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16516     MOVE X'2020233030303133373737' TO DFHEIV0(25:11)
 16517     CALL 'kxdfhei1' USING DFHEIV0,
 16518           CLMS-FILE-ID,
 16519           DFHEIV11,
 16520           DFHEIV99
 16521     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16522
 16523
 16524 7740-READ-CLAIM-UPDATE.
 16525
 16526     IF CL-COMPANY-CD  NOT = WS-SAVE-COMPANY-CD  OR
 16527        CL-CARRIER     NOT = WS-SAVE-CARRIER     OR
 16528        CL-CLAIM-NO    NOT = WS-SAVE-CLAIM-NO
 16529        GO TO 7799-EXIT
 16530     ELSE
 16531        MOVE ZERO                TO WS-READNEXT-SWITCH.
 16532
 16533
 16534* EXEC CICS READ
 16535*        DATASET(CLMS-FILE-ID)
 16536*        SET    (ADDRESS OF CLAIM-MASTER)
 16537*        RIDFLD (MSTR-KEY)
 16538*        UPDATE
 16539*    END-EXEC.
 16540*    MOVE '&"S        EU         (   #00013790' TO DFHEIV0
 16541     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16542     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16543     MOVE X'2020233030303133373930' TO DFHEIV0(25:11)
 16544     CALL 'kxdfhei1' USING DFHEIV0,
 16545           CLMS-FILE-ID,
 16546           DFHEIV20,
 16547           DFHEIV99,
 16548           MSTR-KEY,
 16549           DFHEIV99,
 16550           DFHEIV99,
 16551           DFHEIV99
 16552     SET ADDRESS OF CLAIM-MASTER TO
 16553         DFHEIV20
 16554     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16555
 16556
 16557     if (cl-priority-cd = '8')
 16558        and (pi-processor-id not = 'PEMA' and 'JMS '
 16559             AND 'AMWA')
 16560        MOVE ER-8003             TO EMI-ERROR
 16561        PERFORM 9900-ERROR-FORMAT
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 309
* EL131.cbl
 16562                                 THRU 9900-EXIT
 16563        MOVE -1                  TO MAINTL
 16564        GO TO 8110-SEND-DATA
 16565     end-if
 16566
 16567     IF PI-COMPANY-ID = 'CID' or 'AHL'
 16568         MOVE 'Y'                TO CL-YESNOSW
 16569     END-IF.
 16570
 16571     MOVE WS-ASSOC-CERT-TOTAL    TO CL-ASSOC-CERT-TOTAL.
 16572     MOVE WS-ASSOC-CERT-SEQU     TO CL-ASSOC-CERT-SEQU.
 16573
 16574
 16575* EXEC CICS REWRITE
 16576*         DATASET(CLMS-FILE-ID)
 16577*         FROM   (CLAIM-MASTER)
 16578*    END-EXEC.
 16579     MOVE LENGTH OF
 16580      CLAIM-MASTER
 16581       TO DFHEIV11
 16582*    MOVE '&& L                  %   #00013814' TO DFHEIV0
 16583     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16584     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16585     MOVE X'2020233030303133383134' TO DFHEIV0(25:11)
 16586     CALL 'kxdfhei1' USING DFHEIV0,
 16587           CLMS-FILE-ID,
 16588           CLAIM-MASTER,
 16589           DFHEIV11,
 16590           DFHEIV99
 16591     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16592
 16593
 16594     GO TO 7710-RESEQUENCE-CLAIMS.
 16595
 16596 7799-EXIT.
 16597     EXIT.
 16598
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 310
* EL131.cbl
 16600 7800-CHECK-AUTO-ACTIVITY.
 16601
 16602
 16603* EXEC CICS HANDLE CONDITION
 16604*        NOTFND   (7800-NOT-FOUND)
 16605*    END-EXEC.
 16606*    MOVE '"$I                   ! H #00013827' TO DFHEIV0
 16607     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16608     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16609     MOVE X'4820233030303133383237' TO DFHEIV0(25:11)
 16610     CALL 'kxdfhei1' USING DFHEIV0
 16611     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16612
 16613
 16614     MOVE PI-COMPANY-ID              TO  CNTL-CO-ID.
 16615     MOVE 'T'                        TO  CNTL-REC-TYPE.
 16616     MOVE SPACES                     TO  CNTL-PROC-ID.
 16617     MOVE +0                         TO  CNTL-SEQ-NO.
 16618
 16619
 16620* EXEC CICS READ
 16621*        DATASET   (CNTL-FILE-ID)
 16622*        RIDFLD    (CNTL-KEY)
 16623*        SET       (ADDRESS OF CONTROL-FILE)
 16624*    END-EXEC.
 16625*    MOVE '&"S        E          (   #00013836' TO DFHEIV0
 16626     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16627     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16628     MOVE X'2020233030303133383336' TO DFHEIV0(25:11)
 16629     CALL 'kxdfhei1' USING DFHEIV0,
 16630           CNTL-FILE-ID,
 16631           DFHEIV20,
 16632           DFHEIV99,
 16633           CNTL-KEY,
 16634           DFHEIV99,
 16635           DFHEIV99,
 16636           DFHEIV99
 16637     SET ADDRESS OF CONTROL-FILE TO
 16638         DFHEIV20
 16639     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16640
 16641
 16642     IF CL-ACTIVITY-CODE IS NOT NUMERIC
 16643         MOVE ZEROS                  TO  CL-ACTIVITY-CODE.
 16644
 16645     IF CL-ACTIVITY-CODE NOT = ZEROS
 16646         MOVE CL-ACTIVITY-CODE                 TO  MISC-SUB
 16647         IF MISC-SUB IS GREATER THAN +9
 16648             SUBTRACT +9 FROM MISC-SUB
 16649             MOVE CF-USER-RESET-SW (MISC-SUB)  TO  WS-RESET-SW
 16650         ELSE
 16651             MOVE CF-SYS-RESET-SW  (MISC-SUB)  TO  WS-RESET-SW
 16652     ELSE
 16653         MOVE 'Y'                              TO  WS-RESET-SW.
 16654
 16655     IF STATUSI = 'C' OR 'CLOSED'
 16656         IF CF-SYS-ACTIVE-SW (7) = ' ' OR 'N'
 16657             MOVE 'N'                TO  PI-REC-FOUND-SW
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 311
* EL131.cbl
 16658                                         PI-LETTER-SW
 16659             GO TO 7800-EXIT.
 16660
 16661     IF STATUSI = 'C' OR 'CLOSED'
 16662         IF CF-SYS-LETTER-ID (7) = SPACES OR LOW-VALUES
 16663             MOVE 'N'                TO  PI-LETTER-SW
 16664         ELSE
 16665             MOVE 'Y'                TO  PI-LETTER-SW.
 16666
 16667     IF STATUSI = 'O' OR 'OPEN'
 16668         IF CF-SYS-ACTIVE-SW (8) = ' ' OR 'N'
 16669             MOVE 'N'                TO  PI-REC-FOUND-SW
 16670                                         PI-LETTER-SW
 16671             GO TO 7800-EXIT.
 16672
 16673     IF STATUSI = 'O' OR 'OPEN'
 16674         IF CF-SYS-LETTER-ID (8) = SPACES OR LOW-VALUES
 16675             MOVE 'N'                TO  PI-LETTER-SW
 16676         ELSE
 16677             MOVE 'Y'                TO  PI-LETTER-SW.
 16678
 16679     MOVE 'Y'                        TO  PI-REC-FOUND-SW.
 16680     GO TO 7800-EXIT.
 16681
 16682 7800-NOT-FOUND.
 16683
 16684     MOVE 'N'                        TO  PI-REC-FOUND-SW
 16685                                         PI-LETTER-SW.
 16686
 16687 7800-EXIT.
 16688     EXIT.
 16689
 16690 7850-AUTO-LETTER-WRITER.
 16691
 16692     MOVE LOW-VALUES                 TO  W-1523-LINKDATA.
 16693     MOVE PROGRAM-INTERFACE-BLOCK    TO  W-1523-COMMON-PI-DATA.
 16694
 16695     IF STATUSI = 'C' OR 'CLOSED'
 16696         MOVE CF-SYS-LETTER-ID (7)   TO  W-1523-FORM-NUMBER
 16697     ELSE
 16698         MOVE CF-SYS-LETTER-ID (8)   TO  W-1523-FORM-NUMBER.
 16699
 16700     IF STATUSI = 'C' OR 'CLOSED'
 16701         IF CF-SYS-RESEND-DAYS (7) NOT = ZEROS
 16702             MOVE SAVE-BIN-DATE      TO  DC-BIN-DATE-1
 16703             MOVE '6'                TO  DC-OPTION-CODE
 16704             MOVE CF-SYS-RESEND-DAYS (7) TO  DC-ELAPSED-DAYS
 16705             MOVE +0                 TO  DC-ELAPSED-MONTHS
 16706             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 16707             IF NO-CONVERSION-ERROR
 16708                 MOVE DC-BIN-DATE-2  TO  W-1523-RESEND-DATE
 16709             ELSE
 16710                 MOVE LOW-VALUES     TO  W-1523-RESEND-DATE.
 16711
 16712     IF STATUSI = 'C' OR 'CLOSED'
 16713         IF CF-SYS-FOLLOW-UP-DAYS (7) NOT = ZEROS
 16714             MOVE SAVE-BIN-DATE      TO  DC-BIN-DATE-1
 16715             MOVE '6'                TO  DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 312
* EL131.cbl
 16716             MOVE CF-SYS-FOLLOW-UP-DAYS (7) TO  DC-ELAPSED-DAYS
 16717             MOVE +0                 TO  DC-ELAPSED-MONTHS
 16718             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 16719             IF NO-CONVERSION-ERROR
 16720                 MOVE DC-BIN-DATE-2  TO  W-1523-FOLLOW-UP-DATE
 16721             ELSE
 16722                 MOVE LOW-VALUES     TO  W-1523-FOLLOW-UP-DATE.
 16723
 16724     IF STATUSI = 'O' OR 'OPEN'
 16725         IF CF-SYS-RESEND-DAYS (8) NOT = ZEROS
 16726             MOVE SAVE-BIN-DATE      TO  DC-BIN-DATE-1
 16727             MOVE '6'                TO  DC-OPTION-CODE
 16728             MOVE CF-SYS-RESEND-DAYS (8) TO  DC-ELAPSED-DAYS
 16729             MOVE +0                 TO  DC-ELAPSED-MONTHS
 16730             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 16731             IF NO-CONVERSION-ERROR
 16732                 MOVE DC-BIN-DATE-2  TO  W-1523-RESEND-DATE
 16733             ELSE
 16734                 MOVE LOW-VALUES     TO  W-1523-RESEND-DATE.
 16735
 16736     IF STATUSI = 'O' OR 'OPEN'
 16737         IF CF-SYS-FOLLOW-UP-DAYS (8) NOT = ZEROS
 16738             MOVE SAVE-BIN-DATE      TO  DC-BIN-DATE-1
 16739             MOVE '6'                TO  DC-OPTION-CODE
 16740             MOVE CF-SYS-FOLLOW-UP-DAYS (8) TO  DC-ELAPSED-DAYS
 16741             MOVE +0                 TO  DC-ELAPSED-MONTHS
 16742             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 16743             IF NO-CONVERSION-ERROR
 16744                 MOVE DC-BIN-DATE-2  TO  W-1523-FOLLOW-UP-DATE
 16745             ELSE
 16746                 MOVE LOW-VALUES     TO  W-1523-FOLLOW-UP-DATE.
 16747
 16748
 16749* EXEC CICS LINK
 16750*        PROGRAM    (LINK-1523)
 16751*        COMMAREA   (W-1523-LINKDATA)
 16752*        LENGTH     (W-1523-COMM-LENGTH)
 16753*    END-EXEC.
 16754*    MOVE '."C                   (   #00013948' TO DFHEIV0
 16755     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16756     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16757     MOVE X'2020233030303133393438' TO DFHEIV0(25:11)
 16758     CALL 'kxdfhei1' USING DFHEIV0,
 16759           LINK-1523,
 16760           W-1523-LINKDATA,
 16761           W-1523-COMM-LENGTH,
 16762           DFHEIV99,
 16763           DFHEIV99,
 16764           DFHEIV99,
 16765           DFHEIV99
 16766     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16767
 16768
 16769     IF W-1523-ERROR-CODE = ZEROS
 16770         GO TO 7850-EXIT.
 16771
 16772     IF W-1523-FATAL-ERROR
 16773         MOVE ER-0802                TO  EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 313
* EL131.cbl
 16774         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16775
 16776     IF W-1523-ERROR-CODE = 0191
 16777         MOVE ER-0803                TO  EMI-ERROR
 16778         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16779
 16780 7850-EXIT.
 16781     EXIT.
 16782
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 314
* EL131.cbl
 16784 8000-CREATE-DMO-REC.
 16785     MOVE PI-COMPANY-CD          TO NOTE-COMP-CD.
 16786     MOVE CL-CERT-KEY-DATA       TO NOTE-CERT-KEY.
 16787     MOVE CL-CERT-NO             TO NOTE-CERT-NO.
 16788
 16789
 16790* EXEC CICS HANDLE CONDITION
 16791*         NOTFND   (8000-NOTE-NOT-FOUND)
 16792*    END-EXEC.
 16793*    MOVE '"$I                   ! I #00013974' TO DFHEIV0
 16794     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16795     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16796     MOVE X'4920233030303133393734' TO DFHEIV0(25:11)
 16797     CALL 'kxdfhei1' USING DFHEIV0
 16798     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16799
 16800
 16801
 16802* EXEC CICS READ
 16803*         DATASET(NOTE-FILE-ID)
 16804*         SET    (ADDRESS OF CERTIFICATE-NOTE)
 16805*         RIDFLD (NOTE-KEY)
 16806*    END-EXEC.
 16807*    MOVE '&"S        E          (   #00013978' TO DFHEIV0
 16808     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16809     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16810     MOVE X'2020233030303133393738' TO DFHEIV0(25:11)
 16811     CALL 'kxdfhei1' USING DFHEIV0,
 16812           NOTE-FILE-ID,
 16813           DFHEIV20,
 16814           DFHEIV99,
 16815           NOTE-KEY,
 16816           DFHEIV99,
 16817           DFHEIV99,
 16818           DFHEIV99
 16819     SET ADDRESS OF CERTIFICATE-NOTE TO
 16820         DFHEIV20
 16821     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16822
 16823
 16824     MOVE SPACES                 TO DCT-COMMUNICATION-AREA.
 16825     MOVE CL-BENEFICIARY         TO DCT-LOGIC-BENEFICIARY-ID.
 16826     MOVE CL-CCN                 TO DCT-CREDIT-CARD-NUMBER.
 16827
 16828     IF CL-CERT-GROUPING (5:2) = SPACES OR ZEROS
 16829         MOVE 'CC'               TO DCT-PRODUCT-CODE
 16830     ELSE
 16831         MOVE CL-CERT-GROUPING (5:2) TO DCT-PRODUCT-CODE.
 16832
 16833     MOVE CN-CSI-CC-BILL-BANK-ID TO DCT-BILLING-BANK-ID.
 16834     MOVE '02'                   TO DCT-COLUMN-ID-REQUESTED.
 16835
 16836
 16837* EXEC CICS LINK
 16838*        PROGRAM    ('DLO006')
 16839*        COMMAREA   (DCT-COMMUNICATION-AREA)
 16840*        LENGTH     (WS-DCT-LENGTH)
 16841*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 315
* EL131.cbl
 16842     MOVE 'DLO006' TO DFHEIV1
 16843*    MOVE '."C                   (   #00013996' TO DFHEIV0
 16844     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16845     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16846     MOVE X'2020233030303133393936' TO DFHEIV0(25:11)
 16847     CALL 'kxdfhei1' USING DFHEIV0,
 16848           DFHEIV1,
 16849           DCT-COMMUNICATION-AREA,
 16850           WS-DCT-LENGTH,
 16851           DFHEIV99,
 16852           DFHEIV99,
 16853           DFHEIV99,
 16854           DFHEIV99
 16855     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16856
 16857
 16858     IF  DCT-RETURN-CODE = 'OK'
 16859         GO TO 8000-CONT.
 16860
 16861     IF DCT-RETURN-CODE = '01' OR '02'
 16862         GO TO 8000-EXIT.
 16863
 16864     IF DCT-RETURN-CODE = '03'
 16865         MOVE ER-0951            TO EMI-ERROR
 16866         MOVE -1                 TO MAINTL
 16867         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16868         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16869         GO TO 8110-SEND-DATA.
 16870
 16871     IF DCT-RETURN-CODE = '04'
 16872         MOVE ER-0946            TO EMI-ERROR
 16873         MOVE -1                 TO MAINTL
 16874         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16875         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16876         GO TO 8110-SEND-DATA.
 16877
 16878     IF DCT-RETURN-CODE = '05'
 16879         MOVE ER-0947            TO EMI-ERROR
 16880         MOVE -1                 TO MAINTL
 16881         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16882         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16883         GO TO 8110-SEND-DATA.
 16884
 16885     IF DCT-RETURN-CODE = '06'
 16886         MOVE ER-0921            TO EMI-ERROR
 16887         MOVE -1                 TO MAINTL
 16888         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16889         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16890         GO TO 8110-SEND-DATA.
 16891
 16892     IF DCT-RETURN-CODE = '07'
 16893         MOVE ER-0919            TO EMI-ERROR
 16894         MOVE -1                 TO MAINTL
 16895         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16896         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16897         GO TO 8110-SEND-DATA.
 16898
 16899     IF DCT-RETURN-CODE = '08'
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 316
* EL131.cbl
 16900         MOVE ER-0948            TO EMI-ERROR
 16901         MOVE -1                 TO MAINTL
 16902         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16903         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16904         GO TO 8110-SEND-DATA.
 16905
 16906     IF DCT-RETURN-CODE = 'N1'
 16907         MOVE ER-0950            TO EMI-ERROR
 16908         MOVE -1                 TO MAINTL
 16909         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16910         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16911         GO TO 8110-SEND-DATA.
 16912
 16913     IF DCT-RETURN-CODE = 'E1'
 16914         MOVE ER-0974            TO EMI-ERROR
 16915         MOVE -1                 TO MAINTL
 16916         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16917         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16918         GO TO 8110-SEND-DATA.
 16919
 16920     IF DCT-RETURN-CODE = 'E2'
 16921         MOVE ER-0975            TO EMI-ERROR
 16922         MOVE -1                 TO MAINTL
 16923         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16924         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16925         GO TO 8110-SEND-DATA.
 16926
 16927     IF DCT-RETURN-CODE NOT = 'OK'
 16928         MOVE ER-0949            TO EMI-ERROR
 16929         MOVE -1                 TO MAINTL
 16930         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16931         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16932         GO TO 8110-SEND-DATA.
 16933
 16934 8000-CONT.
 16935
 16936     MOVE SPACES                 TO DMO-COMMUNICATION-AREA.
 16937     MOVE 'CS'                   TO DM-RECORD-TYPE.
 16938     MOVE DCT-DISTRIBUTION-CODE  TO DM-DIST-CODE.
 16939     MOVE DCT-MAIL-CODE          TO DM-MAIL-CODE.
 16940     MOVE CL-CLAIM-NO            TO DM-CLAIM-NO.
 16941     MOVE CL-CERT-NO (4:1)       TO DM-CLAIM-TYPE.
 16942     MOVE CL-CCN                 TO DM-CREDIT-CARD-NUMBER.
 16943     MOVE SAVE-DATE-CCYYMMDD     TO DM-STATUS-DATE.
 16944
 16945     MOVE CL-INSURED-LAST-NAME   TO W-NAME-LAST.
 16946     MOVE CL-INSURED-1ST-NAME    TO W-NAME-FIRST.
 16947     MOVE CL-INSURED-MID-INIT    TO W-NAME-MIDDLE.
 16948     PERFORM 8050-FORMAT-LAST-NAME-1ST THRU 8050-EXIT.
 16949     MOVE WS-NAME-WORK           TO DM-INSURED-NAME.
 16950
 16951     IF STATUSI = 'OPEN' OR 'O'
 16952         MOVE 'R'                TO DM-STAT-CHANGE-TYPE
 16953      ELSE
 16954         MOVE 'C'                TO DM-STAT-CHANGE-TYPE.
 16955
 16956     IF STATUSI = 'OPEN' OR 'O'
 16957        IF CL-NO-OF-PMTS-MADE = 0
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 317
* EL131.cbl
 16958         MOVE '1'                TO DM-CLAIM-STATUS
 16959      ELSE
 16960         MOVE '2'                TO DM-CLAIM-STATUS.
 16961
 16962     IF STATUSI = 'CLOSED' OR 'C'
 16963        IF NOT FINAL-PAID
 16964         MOVE '3'                TO DM-CLAIM-STATUS
 16965      ELSE
 16966         MOVE '4'                TO DM-CLAIM-STATUS.
 16967
 16968     MOVE CL-CARRIER             TO DM-STAT-CARRIER.
 16969
 16970
 16971* EXEC CICS LINK
 16972*        PROGRAM    ('DLO025')
 16973*        COMMAREA   (DMO-COMMUNICATION-AREA)
 16974*        LENGTH     (WS-DMO-LENGTH)
 16975*    END-EXEC.
 16976     MOVE 'DLO025' TO DFHEIV1
 16977*    MOVE '."C                   (   #00014114' TO DFHEIV0
 16978     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16979     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16980     MOVE X'2020233030303134313134' TO DFHEIV0(25:11)
 16981     CALL 'kxdfhei1' USING DFHEIV0,
 16982           DFHEIV1,
 16983           DMO-COMMUNICATION-AREA,
 16984           WS-DMO-LENGTH,
 16985           DFHEIV99,
 16986           DFHEIV99,
 16987           DFHEIV99,
 16988           DFHEIV99
 16989     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16990
 16991
 16992     IF  DM-RETURN-CODE = 'OK'
 16993         GO TO 8000-EXIT.
 16994
 16995     IF DM-RETURN-CODE = '01'
 16996         MOVE ER-8051            TO EMI-ERROR
 16997         MOVE -1                 TO MAINTL
 16998         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16999         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 17000         GO TO 8110-SEND-DATA.
 17001
 17002     IF DM-RETURN-CODE = '02'
 17003         MOVE ER-8052            TO EMI-ERROR
 17004         MOVE -1                 TO MAINTL
 17005         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17006         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 17007         GO TO 8110-SEND-DATA.
 17008
 17009     IF DM-RETURN-CODE = '03'
 17010         MOVE ER-8053            TO EMI-ERROR
 17011         MOVE -1                 TO MAINTL
 17012         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17013         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 17014         GO TO 8110-SEND-DATA.
 17015
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 318
* EL131.cbl
 17016     IF DM-RETURN-CODE = '04'
 17017         MOVE ER-8054            TO EMI-ERROR
 17018         MOVE -1                 TO MAINTL
 17019         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17020         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 17021         GO TO 8110-SEND-DATA.
 17022
 17023     IF DM-RETURN-CODE = '05'
 17024         MOVE ER-8055            TO EMI-ERROR
 17025         MOVE -1                 TO MAINTL
 17026         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17027         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 17028         GO TO 8110-SEND-DATA.
 17029
 17030     IF DM-RETURN-CODE = '06'
 17031         MOVE ER-8056            TO EMI-ERROR
 17032         MOVE -1                 TO MAINTL
 17033         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17034         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 17035         GO TO 8110-SEND-DATA.
 17036
 17037     IF DM-RETURN-CODE = '07'
 17038         MOVE ER-8057            TO EMI-ERROR
 17039         MOVE -1                 TO MAINTL
 17040         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17041         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 17042         GO TO 8110-SEND-DATA.
 17043
 17044     IF DM-RETURN-CODE = '08'
 17045         MOVE ER-8058            TO EMI-ERROR
 17046         MOVE -1                 TO MAINTL
 17047         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17048         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 17049         GO TO 8110-SEND-DATA.
 17050
 17051     IF DM-RETURN-CODE = '09'
 17052         MOVE ER-8059            TO EMI-ERROR
 17053         MOVE -1                 TO MAINTL
 17054         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17055         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 17056         GO TO 8110-SEND-DATA.
 17057
 17058     IF DM-RETURN-CODE = '10'
 17059         MOVE ER-8060            TO EMI-ERROR
 17060         MOVE -1                 TO MAINTL
 17061         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17062         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 17063         GO TO 8110-SEND-DATA.
 17064
 17065     IF DM-RETURN-CODE = '11'
 17066         MOVE ER-8061            TO EMI-ERROR
 17067         MOVE -1                 TO MAINTL
 17068         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17069         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 17070         GO TO 8110-SEND-DATA.
 17071
 17072     IF DM-RETURN-CODE = '12'
 17073         MOVE ER-8062            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 319
* EL131.cbl
 17074         MOVE -1                 TO MAINTL
 17075         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17076         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 17077         GO TO 8110-SEND-DATA.
 17078
 17079     IF DM-RETURN-CODE = '13'
 17080         MOVE ER-8063            TO EMI-ERROR
 17081         MOVE -1                 TO MAINTL
 17082         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17083         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 17084         GO TO 8110-SEND-DATA.
 17085
 17086     IF DM-RETURN-CODE = '14'
 17087         MOVE ER-8064            TO EMI-ERROR
 17088         MOVE -1                 TO MAINTL
 17089         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17090         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 17091         GO TO 8110-SEND-DATA.
 17092
 17093     IF DM-RETURN-CODE = '15'
 17094         MOVE ER-8065            TO EMI-ERROR
 17095         MOVE -1                 TO MAINTL
 17096         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17097         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 17098         GO TO 8110-SEND-DATA.
 17099
 17100     IF DM-RETURN-CODE = '16'
 17101         MOVE ER-8154            TO EMI-ERROR
 17102         MOVE -1                 TO MAINTL
 17103         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17104         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 17105         GO TO 8110-SEND-DATA.
 17106
 17107     IF DM-RETURN-CODE = '17'
 17108         MOVE ER-8155            TO EMI-ERROR
 17109         MOVE -1                 TO MAINTL
 17110         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17111         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 17112         GO TO 8110-SEND-DATA.
 17113
 17114     IF DM-RETURN-CODE = 'N1'
 17115         MOVE ER-8152            TO EMI-ERROR
 17116         MOVE -1                 TO MAINTL
 17117         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17118         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 17119         GO TO 8110-SEND-DATA.
 17120
 17121     IF DM-RETURN-CODE = 'E1'
 17122         MOVE ER-8153            TO EMI-ERROR
 17123         MOVE -1                 TO MAINTL
 17124         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17125         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 17126         GO TO 8110-SEND-DATA.
 17127
 17128     MOVE ER-8066                TO EMI-ERROR.
 17129     MOVE -1                     TO MAINTL.
 17130     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17131     PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 320
* EL131.cbl
 17132     GO TO 8110-SEND-DATA.
 17133
 17134 8000-NOTE-NOT-FOUND.
 17135
 17136* EXEC CICS SYNCPOINT ROLLBACK END-EXEC.
 17137*    MOVE '6"R                   !   #00014263' TO DFHEIV0
 17138     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17139     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17140     MOVE X'2020233030303134323633' TO DFHEIV0(25:11)
 17141     CALL 'kxdfhei1' USING DFHEIV0
 17142     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17143
 17144     MOVE ER-0954                TO EMI-ERROR.
 17145     MOVE -1                     TO MAINTL.
 17146     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17147     GO TO 8110-SEND-DATA.
 17148
 17149 8000-EXIT.
 17150     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 321
* EL131.cbl
 17152 8050-FORMAT-LAST-NAME-1ST.
 17153*****************************************************************
 17154*             M O V E   N A M E   R O U T I N E                 *
 17155*                                                               *
 17156*     THE FOLLOWING ROUTINE REARRANGES A GIVEN NAME SO          *
 17157*     THAT IT READS LAST, FIRST, MIDDLE.  PLACE NAME            *
 17158*     FIELDS IN THE FOLLOWING WORKING-STORAGE FIELDS.           *
 17159*                                                               *
 17160*                  FIELD               VALUE                    *
 17161*                  -----               -----                    *
 17162*           W-NAME-LAST    (CL15)      SMITH                    *
 17163*           W-NAME-FIRST   (CL15)      JOHN                     *
 17164*           W-NAME-MIDDLE  (CL15)      ALLEN/A                  *
 17165*                                                               *
 17166*     AFTER NAME HAS BEEN MOVED WS-NAME-WORK WILL CONTAIN       *
 17167*                SMITH, JOHN ALLEN                              *
 17168*                     OR                                        *
 17169*                SMITH, JOHN A.                                 *
 17170*                                                               *
 17171*     TO USE THIS ROUTINE YOU NEED THE WORKING-STORAGE          *
 17172*     COPYBOOK, ELCNWA.                                         *
 17173*****************************************************************.
 17174
 17175     MOVE SPACES                 TO WS-NAME-WORK-AREA.
 17176     MOVE ZERO                   TO WS-NAME-SW.
 17177     SET NWA-INDEX               TO +1.
 17178
 17179     IF W-NAME-LAST   = SPACES  AND
 17180        W-NAME-MIDDLE = SPACES
 17181          MOVE +1                TO WS-NAME-SW.
 17182
 17183     MOVE W-NAME-LAST            TO WS-NAME-WORK2.
 17184     PERFORM 8060-MOVE-NAME THRU 8060-EXIT.
 17185
 17186     MOVE W-NAME-FIRST           TO WS-NAME-WORK2.
 17187     PERFORM 8060-MOVE-NAME THRU 8060-EXIT.
 17188
 17189     SET NWA-INDEX UP BY +1.
 17190
 17191     IF W-NAME-MIDDLE NOT = SPACES
 17192         IF W-NAME-MIDDLE-2 = SPACES
 17193             MOVE W-NAME-MIDDLE  TO WS-NW (NWA-INDEX)
 17194             SET NWA-INDEX UP BY +1
 17195             MOVE '.'            TO WS-NW (NWA-INDEX)
 17196             SET NWA-INDEX UP BY +2
 17197         ELSE
 17198             MOVE W-NAME-MIDDLE  TO WS-NAME-WORK2
 17199             PERFORM 8060-MOVE-NAME THRU 8060-EXIT.
 17200
 17201 8050-EXIT.
 17202     EXIT.
 17203
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 322
* EL131.cbl
 17205 8060-MOVE-NAME.
 17206     IF WS-NAME-SW GREATER THAN +1
 17207         GO TO 8060-EXIT.
 17208
 17209     IF WS-NAME-WORK2 = SPACES
 17210         GO TO 8060-EXIT.
 17211
 17212     SET NWA-INDEX2            TO +1.
 17213     SET NWA-INDEX3            TO +2.
 17214
 17215 8060-MOVE-NAME-CYCLE.
 17216     MOVE WS-NW2 (NWA-INDEX2)  TO WS-NW (NWA-INDEX).
 17217
 17218     IF NWA-INDEX LESS THAN +30
 17219         SET NWA-INDEX UP BY +1
 17220     ELSE
 17221         ADD +2 TO  WS-NAME-SW
 17222         GO TO 8060-EXIT.
 17223
 17224     IF NWA-INDEX2 LESS THAN +20
 17225         SET NWA-INDEX3 UP BY +1
 17226         SET NWA-INDEX2 UP BY +1.
 17227
 17228     IF WS-NW2 (NWA-INDEX2) = SPACES  AND
 17229        WS-NW2 (NWA-INDEX3) = SPACES
 17230         IF WS-NAME-SW = ZERO
 17231             MOVE ','            TO WS-NW (NWA-INDEX)
 17232             SET NWA-INDEX UP BY +2
 17233             MOVE +1             TO WS-NAME-SW
 17234             GO TO 8060-EXIT
 17235         ELSE
 17236             GO TO 8060-EXIT.
 17237
 17238     GO TO 8060-MOVE-NAME-CYCLE.
 17239
 17240 8060-EXIT.
 17241     EXIT.
 17242
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 323
* EL131.cbl
 17244
 17245 8070-UNLOCK-CLAIM-MSTR.
 17246
 17247* EXEC CICS UNLOCK
 17248*        DATASET   (CLMS-FILE-ID)
 17249*    END-EXEC.
 17250*    MOVE '&*                    #   #00014366' TO DFHEIV0
 17251     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 17252     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 17253     MOVE X'2020233030303134333636' TO DFHEIV0(25:11)
 17254     CALL 'kxdfhei1' USING DFHEIV0,
 17255           CLMS-FILE-ID,
 17256           DFHEIV99
 17257     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17258
 17259
 17260 8070-EXIT.
 17261      EXIT.
 17262
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 324
* EL131.cbl
 17264 8100-SEND-MAP.
 17265     PERFORM 8120-FORMAT-TIME-DATE THRU 8130-EXIT.
 17266
 17267     move al-uanon               to accswa
 17268     IF NOT PI-NO-CARRIER-SECURITY
 17269        MOVE AL-SANOF            TO CERTCARA.
 17270     IF NOT PI-NO-ACCOUNT-SECURITY
 17271        MOVE AL-SANOF            TO CERTACTA.
 17272
 17273     IF PI-PROCESSOR-ID = 'LGXX'
 17274        MOVE AL-UANON            TO CCNOA.
 17275
 17276     IF PI-COMPANY-ID = 'DMD'
 17277        NEXT SENTENCE
 17278     ELSE
 17279        MOVE AL-SADOF            TO PFKEY6A.
 17280     IF NOT (PI-COMPANY-ID = 'DCC' OR 'VPP')
 17281        MOVE AL-SANOF TO EXTENSA
 17282     END-IF
 17283
 17284     IF PI-USES-PAID-TO
 17285        MOVE 'PAID TO  :' TO PTHRHDGO.
 17286
 17287
 17288* EXEC CICS SEND
 17289*         MAP     ('EL131A')
 17290*         MAPSET  ('EL131S')
 17291*         ERASE
 17292*         FREEKB
 17293*         CURSOR
 17294*    END-EXEC.
 17295     MOVE 'EL131A' TO DFHEIV1
 17296     MOVE -1
 17297       TO DFHEIV11
 17298     MOVE 'EL131S' TO DFHEIV2
 17299*    MOVE '8$     CT  E F  H     ,   #00014397' TO DFHEIV0
 17300     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 17301     MOVE X'204620204820202020202C20' TO DFHEIV0(13:12)
 17302     MOVE X'2020233030303134333937' TO DFHEIV0(25:11)
 17303     CALL 'kxdfhei1' USING DFHEIV0,
 17304           DFHEIV1,
 17305           EL131AO,
 17306           DFHEIV99,
 17307           DFHEIV2,
 17308           DFHEIV99,
 17309           DFHEIV99,
 17310           DFHEIV99,
 17311           DFHEIV11,
 17312           DFHEIV99,
 17313           DFHEIV99,
 17314           DFHEIV99
 17315     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17316
 17317
 17318     GO TO 9000-RETURN-TRANS.
 17319
 17320 8110-SEND-DATA.
 17321     PERFORM 8120-FORMAT-TIME-DATE THRU 8130-EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 325
* EL131.cbl
 17322
 17323     IF PI-USES-PAID-TO
 17324        MOVE 'PAID TO  :' TO PTHRHDGO.
 17325
 17326     IF PI-PROCESSOR-ID = 'LGXX'
 17327        MOVE AL-UANON            TO CCNOA.
 17328
 17329     IF PI-COMPANY-ID = 'DMD'
 17330        NEXT SENTENCE
 17331     ELSE
 17332        MOVE AL-SADOF            TO PFKEY6A.
 17333
 17334
 17335* EXEC CICS SEND
 17336*         MAP      ('EL131A')
 17337*         MAPSET   ('EL131S')
 17338*         DATAONLY
 17339*         FREEKB
 17340*         CURSOR
 17341*    END-EXEC.
 17342     MOVE 'EL131A' TO DFHEIV1
 17343     MOVE -1
 17344       TO DFHEIV11
 17345     MOVE 'EL131S' TO DFHEIV2
 17346*    MOVE '8$D    CT    F  H     ,   #00014421' TO DFHEIV0
 17347     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 17348     MOVE X'204620204820202020202C20' TO DFHEIV0(13:12)
 17349     MOVE X'2020233030303134343231' TO DFHEIV0(25:11)
 17350     CALL 'kxdfhei1' USING DFHEIV0,
 17351           DFHEIV1,
 17352           EL131AO,
 17353           DFHEIV99,
 17354           DFHEIV2,
 17355           DFHEIV99,
 17356           DFHEIV99,
 17357           DFHEIV99,
 17358           DFHEIV11,
 17359           DFHEIV99,
 17360           DFHEIV99,
 17361           DFHEIV99
 17362     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17363
 17364
 17365     GO TO 9000-RETURN-TRANS.
 17366
 17367 8120-FORMAT-TIME-DATE.
 17368     perform 8140-check-for-prev-errors
 17369                                 thru 8140-exit
 17370     IF SKIP-ATTRIBUTE = 'Y'
 17371        MOVE SPACES              TO SKIP-ATTRIBUTE
 17372        MOVE ER-0598             TO EMI-ERROR
 17373        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17374        GO TO 8125-SKIP-ATTRIBUTE.
 17375
 17376*     IF PI-COMPANY-ID = 'DMD'
 17377      IF PI-PROCESSOR-ID <> 'EMER'
 17378         MOVE AL-PANOF           TO CERTEFFA  CERTACTA  CERTSTA
 17379                                    CERTCARA  CERTGRPA CERTA SUFXA
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 326
* EL131.cbl
 17380
 17381     MOVE AL-PANOF               TO CRTLNMEA  CRTFNMEA  CRTINITA
 17382                                    ISSAGEA   JNTLNMEA  JNTFNMEA
 17383                                    JNTINITA  JNTAGEA   APRA
 17384                                    LCVCDA    LCVOTRMA  LCVRTRMA
 17385                                    LCVBENEA  LCVFORMA  LCVCNDTA
 17386                                    LCVEXITA  LCVSTATA  LCVKINDA
 17387                                    ACVCDA    ACVOTRMA  ACVRTRMA
 17388                                    ACVBENEA  ACVFORMA  ACVCNDTA
 17389                                    ACVEXITA  ACVSTATA  ACVKINDA
 17390                                    PMTFREQA  INDGRPA   PREMTYPA
 17391                                    REINCDA   LCVRATEA  ACVRATEA
 17392                                    ADDONDTA.
 17393
 17394*    IF PI-PROCESSOR-ID NOT = 'LGXX'
 17395*       IF PI-COMPANY-ID = 'DMD'
 17396*          MOVE AL-SANOF         TO TYPEA     CERTA     CERTSTA
 17397*                                   SUFXA
 17398*                                   PDAMTA    NODAYSA   NOPMTSA
 17399*                                   INCA      OCCA
 17400*          IF NOT SYSTEM-MODIFY-CAP
 17401*              MOVE AL-SANOF         TO PDTHRUA.
 17402
 17403     IF PI-COMPANY-ID NOT = 'CRI' AND 'PEM' AND 'NCL'
 17404         MOVE AL-SANOF           TO LCVRATEA  ACVRATEA.
 17405
 17406 8125-SKIP-ATTRIBUTE.
 17407
 17408     MOVE SAVE-DATE              TO DATEO.
 17409
 17410* EXEC CICS ASKTIME ABSTIME(LCP-CICS-TIME)
 17411*    END-EXEC
 17412*    MOVE '0"A                   "   #00014473' TO DFHEIV0
 17413     MOVE X'302241202020202020202020' TO DFHEIV0(1:12)
 17414     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 17415     MOVE X'2020233030303134343733' TO DFHEIV0(25:11)
 17416     CALL 'kxdfhei1' USING DFHEIV0,
 17417           LCP-CICS-TIME
 17418     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17419
 17420* EXEC CICS FORMATTIME
 17421*              ABSTIME(LCP-CICS-TIME)
 17422*              TIME(LCP-TIME-OF-DAY-XX)
 17423*    END-EXEC
 17424*    MOVE 'j$(     (             #   #00014475' TO DFHEIV0
 17425     MOVE X'6A2428202020202028202020' TO DFHEIV0(1:12)
 17426     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 17427     MOVE X'2020233030303134343735' TO DFHEIV0(25:11)
 17428     CALL 'kxdfhei1' USING DFHEIV0,
 17429           LCP-CICS-TIME,
 17430           LCP-TIME-OF-DAY-XX
 17431     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17432     MOVE  LCP-TIME-OF-DAY-68 TO TIME-IN.
 17433     MOVE UN-HOURS               TO FOR-HOURS.
 17434     MOVE UN-MINUTES             TO FOR-MINUTES.
 17435     MOVE TIME-OUT               TO TIMEO.
 17436     MOVE PI-COMPANY-ID          TO COMPO.
 17437     MOVE PI-PROCESSOR-ID        TO USERIDO.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 327
* EL131.cbl
 17438     MOVE MAP-ID                 TO PI-CURRENT-SCREEN-NO.
 17439     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 17440     MOVE EMI-MESSAGE-AREA (1)   TO MSG1O.
 17441     MOVE EMI-MESSAGE-AREA (2)   TO MSG2O.
 17442
 17443 8130-EXIT.
 17444     EXIT.
 17445
 17446 8140-check-for-prev-errors.
 17447
 17448     MOVE PI-COMPANY-CD          TO trlr-company-cd
 17449     MOVE PI-CARRIER             TO trlr-carrier
 17450     MOVE PI-CLAIM-NO            TO trlr-claim-no
 17451     MOVE PI-CERT-NO             TO trlr-cert-no
 17452     MOVE +95                    TO TRLR-SEQ-NO
 17453
 17454
 17455* EXEC CICS READ
 17456*       DATASET  ('ELTRLR')
 17457*       SET      (ADDRESS OF ACTIVITY-TRAILERS)
 17458*       RIDFLD   (TRLR-KEY)
 17459*       RESP     (WS-RESPONSE)
 17460*    END-EXEC
 17461     MOVE 'ELTRLR' TO DFHEIV1
 17462*    MOVE '&"S        E          (  N#00014501' TO DFHEIV0
 17463     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17464     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17465     MOVE X'204E233030303134353031' TO DFHEIV0(25:11)
 17466     CALL 'kxdfhei1' USING DFHEIV0,
 17467           DFHEIV1,
 17468           DFHEIV20,
 17469           DFHEIV99,
 17470           TRLR-KEY,
 17471           DFHEIV99,
 17472           DFHEIV99,
 17473           DFHEIV99
 17474     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17475         DFHEIV20
 17476     MOVE EIBRESP  TO WS-RESPONSE
 17477     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17478
 17479     if ws-resp-normal
 17480        perform varying s1 from +1 by +1 until
 17481           at-note-error-no (s1) = spaces
 17482           if at-note-error-no (s1) = '1652'
 17483              continue
 17484           else
 17485              move at-note-error-no (s1)
 17486                                 to emi-error
 17487              move -1 to maintl
 17488              if at-note-error-no (s1) = '1653'
 17489                 evaluate true
 17490                    when pi-claim-type = 'L'
 17491                       move '  LF  '
 17492                        to emi-claim-type
 17493                    when pi-claim-type = 'I'
 17494                       move '  IU  '
 17495                        to emi-claim-type
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 328
* EL131.cbl
 17496                    WHEN PI-CLAIM-TYPE = 'F'
 17497                       MOVE '  FL  '
 17498                        TO EMI-CLAIM-TYPE
 17499                    WHEN PI-CLAIM-TYPE = 'O'
 17500                       MOVE '  OT  '
 17501                        TO EMI-CLAIM-TYPE
 17502                    when other
 17503                       move '  AH  '
 17504                        to emi-claim-type
 17505                 end-evaluate
 17506              end-if
 17507              PERFORM 9900-ERROR-FORMAT
 17508                                 THRU 9900-EXIT
 17509           end-if
 17510*          if at-note-error-no (s1) = '1653'
 17511*             perform varying emi-sub from 1 by 1 until
 17512*                emi-sub > 3
 17513*                if emi-error-number (emi-sub) = '1653'
 17514*                   evaluate true
 17515*                      when pi-claim-type = 'L'
 17516*                         move '  LF  '
 17517*                          to emi-claim-type
 17518*                      when pi-claim-type = 'I'
 17519*                         move '  IU  '
 17520*                          to emi-claim-type
 17521*                      when other
 17522*                         move '  AH  '
 17523*                          to emi-claim-type
 17524*                   end-evaluate
 17525*                end-if
 17526*             end-perform
 17527*          end-if
 17528        end-perform
 17529     else
 17530        display ' resp not normal ' ws-response ' '
 17531        trlr-key (2:19)
 17532     end-if
 17533
 17534     .
 17535 8140-exit.
 17536     exit.
 17537 8150-ENTERED-CLAIM-NOTFOUND.
 17538
 17539     MOVE ER-0204                TO EMI-ERROR.
 17540     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17541     MOVE -1                     TO MAINTL.
 17542     GO TO 8100-SEND-MAP.
 17543
 17544 8200-RETURN-PRIOR.
 17545     MOVE SPACE                  TO PI-RETURN-CD-1.
 17546     MOVE PI-RETURN-TO-PROGRAM   TO CALL-PGM.
 17547     GO TO 9200-XCTL.
 17548
 17549 8300-GET-HELP.
 17550     MOVE XCTL-EL010             TO CALL-PGM.
 17551     GO TO 9200-XCTL.
 17552
 17553 8400-RETURN-MASTER.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 329
* EL131.cbl
 17554     MOVE SPACE                  TO PI-RETURN-CD-1.
 17555     MOVE XCTL-EL126             TO CALL-PGM.
 17556     GO TO 9200-XCTL.
 17557
 17558 8500-TRLR-MNT.
 17559     IF PI-RETURN-CD-1 = 'X'
 17560         MOVE ER-0311            TO EMI-ERROR
 17561         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17562         MOVE -1                 TO MAINTL
 17563         GO TO 8110-SEND-DATA.
 17564
 17565
 17566* EXEC CICS WRITEQ TS
 17567*         QUEUE     (PI-KEY)
 17568*         FROM      (PROGRAM-INTERFACE-BLOCK)
 17569*         LENGTH    (PI-COMM-LENGTH)
 17570*    END-EXEC.
 17571*    MOVE '*"     L              ''   #00014594' TO DFHEIV0
 17572     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
 17573     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17574     MOVE X'2020233030303134353934' TO DFHEIV0(25:11)
 17575     CALL 'kxdfhei1' USING DFHEIV0,
 17576           PI-KEY,
 17577           PROGRAM-INTERFACE-BLOCK,
 17578           PI-COMM-LENGTH,
 17579           DFHEIV99,
 17580           DFHEIV99,
 17581           DFHEIV99
 17582     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17583
 17584
 17585     MOVE XCTL-EL142             TO CALL-PGM.
 17586     GO TO 9200-XCTL.
 17587
 17588 8600-ADDR-MNT.
 17589     IF PI-RETURN-CD-1 = 'X'
 17590         MOVE ER-0311            TO EMI-ERROR
 17591         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17592         MOVE -1                 TO MAINTL
 17593         GO TO 8110-SEND-DATA.
 17594
 17595
 17596* EXEC CICS WRITEQ TS
 17597*         QUEUE     (PI-KEY)
 17598*         FROM      (PROGRAM-INTERFACE-BLOCK)
 17599*         LENGTH    (PI-COMM-LENGTH)
 17600*    END-EXEC.
 17601*    MOVE '*"     L              ''   #00014610' TO DFHEIV0
 17602     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
 17603     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17604     MOVE X'2020233030303134363130' TO DFHEIV0(25:11)
 17605     CALL 'kxdfhei1' USING DFHEIV0,
 17606           PI-KEY,
 17607           PROGRAM-INTERFACE-BLOCK,
 17608           PI-COMM-LENGTH,
 17609           DFHEIV99,
 17610           DFHEIV99,
 17611           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 330
* EL131.cbl
 17612     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17613
 17614
 17615     MOVE XCTL-EL141             TO CALL-PGM.
 17616     GO TO 9200-XCTL.
 17617
 17618 8700-CERT-MNT.
 17619     IF PI-RETURN-CD-1 = 'X'
 17620         MOVE ER-7690            TO EMI-ERROR
 17621         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17622         MOVE -1                 TO MAINTL
 17623         GO TO 8110-SEND-DATA.
 17624
 17625
 17626* EXEC CICS WRITEQ TS
 17627*         QUEUE     (PI-KEY)
 17628*         FROM      (PROGRAM-INTERFACE-BLOCK)
 17629*         LENGTH    (PI-COMM-LENGTH)
 17630*    END-EXEC.
 17631*    MOVE '*"     L              ''   #00014626' TO DFHEIV0
 17632     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
 17633     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17634     MOVE X'2020233030303134363236' TO DFHEIV0(25:11)
 17635     CALL 'kxdfhei1' USING DFHEIV0,
 17636           PI-KEY,
 17637           PROGRAM-INTERFACE-BLOCK,
 17638           PI-COMM-LENGTH,
 17639           DFHEIV99,
 17640           DFHEIV99,
 17641           DFHEIV99
 17642     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17643
 17644
 17645     MOVE XCTL-EL1273            TO CALL-PGM.
 17646     GO TO 9200-XCTL.
 17647
 17648 8725-BENEFICIARY-MNT.
 17649     IF PI-RETURN-CD-1 = 'X'
 17650         MOVE ER-0311            TO EMI-ERROR
 17651         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17652         MOVE -1                 TO MAINTL
 17653         GO TO 8110-SEND-DATA.
 17654
 17655
 17656* EXEC CICS WRITEQ TS
 17657*         QUEUE     (PI-KEY)
 17658*         FROM      (EL131AI)
 17659*         LENGTH    (MAP-LENGTH)
 17660*    END-EXEC.
 17661*    MOVE '*"     L              ''   #00014642' TO DFHEIV0
 17662     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
 17663     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17664     MOVE X'2020233030303134363432' TO DFHEIV0(25:11)
 17665     CALL 'kxdfhei1' USING DFHEIV0,
 17666           PI-KEY,
 17667           EL131AI,
 17668           MAP-LENGTH,
 17669           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 331
* EL131.cbl
 17670           DFHEIV99,
 17671           DFHEIV99
 17672     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17673
 17674
 17675
 17676* EXEC CICS WRITEQ TS
 17677*         QUEUE     (PI-KEY)
 17678*         FROM      (PROGRAM-INTERFACE-BLOCK)
 17679*         LENGTH    (PI-COMM-LENGTH)
 17680*    END-EXEC.
 17681*    MOVE '*"     L              ''   #00014648' TO DFHEIV0
 17682     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
 17683     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17684     MOVE X'2020233030303134363438' TO DFHEIV0(25:11)
 17685     CALL 'kxdfhei1' USING DFHEIV0,
 17686           PI-KEY,
 17687           PROGRAM-INTERFACE-BLOCK,
 17688           PI-COMM-LENGTH,
 17689           DFHEIV99,
 17690           DFHEIV99,
 17691           DFHEIV99
 17692     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17693
 17694
 17695     MOVE XCTL-EL114             TO CALL-PGM.
 17696     GO TO 9200-XCTL.
 17697
 17698 8750-DMD-CLM-FIX.
 17699
 17700* EXEC CICS WRITEQ TS
 17701*         QUEUE     (PI-KEY)
 17702*         FROM      (PROGRAM-INTERFACE-BLOCK)
 17703*         LENGTH    (PI-COMM-LENGTH)
 17704*    END-EXEC.
 17705*    MOVE '*"     L              ''   #00014658' TO DFHEIV0
 17706     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
 17707     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17708     MOVE X'2020233030303134363538' TO DFHEIV0(25:11)
 17709     CALL 'kxdfhei1' USING DFHEIV0,
 17710           PI-KEY,
 17711           PROGRAM-INTERFACE-BLOCK,
 17712           PI-COMM-LENGTH,
 17713           DFHEIV99,
 17714           DFHEIV99,
 17715           DFHEIV99
 17716     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17717
 17718
 17719     MOVE XCTL-EL400DMD          TO CALL-PGM.
 17720     GO TO 9200-XCTL.
 17721
 17722 8800-UNAUTHORIZED-ACCESS.
 17723     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 17724     GO TO 8990-SEND-TEXT.
 17725
 17726 8810-PF23-ENTERED.
 17727     MOVE EIBAID                 TO PI-ENTRY-CD-1.
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 332
* EL131.cbl
 17728     MOVE XCTL-EL005             TO CALL-PGM.
 17729     GO TO 9200-XCTL.
 17730
 17731 8820-XCTL-ERROR.
 17732
 17733* EXEC CICS HANDLE CONDITION
 17734*        PGMIDERR (8990-SEND-TEXT)
 17735*    END-EXEC.
 17736*    MOVE '"$L                   ! J #00014677' TO DFHEIV0
 17737     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 17738     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17739     MOVE X'4A20233030303134363737' TO DFHEIV0(25:11)
 17740     CALL 'kxdfhei1' USING DFHEIV0
 17741     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17742
 17743
 17744     MOVE SPACE                 TO PI-ENTRY-CD-1.
 17745     MOVE CALL-PGM              TO PI-CALLING-PROGRAM  LOGOFF-PGM
 17746     MOVE PGMIDERR-MSG          TO LOGOFF-FILL.
 17747     MOVE XCTL-EL005            TO CALL-PGM.
 17748     GO TO 9200-XCTL.
 17749
 17750 8990-SEND-TEXT.
 17751
 17752* EXEC CICS SEND TEXT
 17753*         FROM      (LOGOFF-TEXT)
 17754*         LENGTH    (LOGOFF-LENGTH)
 17755*         ERASE
 17756*         FREEKB
 17757*    END-EXEC.
 17758*    MOVE '8&      T  E F  H   F -   #00014688' TO DFHEIV0
 17759     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 17760     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 17761     MOVE X'2020233030303134363838' TO DFHEIV0(25:11)
 17762     CALL 'kxdfhei1' USING DFHEIV0,
 17763           LOGOFF-TEXT,
 17764           LOGOFF-LENGTH,
 17765           DFHEIV99,
 17766           DFHEIV99,
 17767           DFHEIV99,
 17768           DFHEIV99,
 17769           DFHEIV99,
 17770           DFHEIV99,
 17771           DFHEIV99,
 17772           DFHEIV99,
 17773           DFHEIV99,
 17774           DFHEIV99
 17775     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17776
 17777
 17778     GO TO 9100-RETURN-CICS.
 17779
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 333
* EL131.cbl
 17781 9000-RETURN-TRANS.
 17782
 17783* EXEC CICS RETURN
 17784*         TRANSID   (TRANS-ID)
 17785*         COMMAREA  (PROGRAM-INTERFACE-BLOCK)
 17786*         LENGTH    (PI-COMM-LENGTH)
 17787*    END-EXEC.
 17788*    MOVE '.(CT                  ''   #00014699' TO DFHEIV0
 17789     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 17790     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17791     MOVE X'2020233030303134363939' TO DFHEIV0(25:11)
 17792     CALL 'kxdfhei1' USING DFHEIV0,
 17793           TRANS-ID,
 17794           PROGRAM-INTERFACE-BLOCK,
 17795           PI-COMM-LENGTH,
 17796           DFHEIV99,
 17797           DFHEIV99,
 17798           DFHEIV99
 17799     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17800
 17801
 17802
 17803* GOBACK.
 17804     MOVE '9%                    "   ' TO DFHEIV0
 17805     MOVE 'EL131' TO DFHEIV1
 17806     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 17807     GOBACK.
 17808
 17809 9100-RETURN-CICS.
 17810
 17811* EXEC CICS RETURN
 17812*    END-EXEC.
 17813*    MOVE '.(                    ''   #00014708' TO DFHEIV0
 17814     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 17815     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17816     MOVE X'2020233030303134373038' TO DFHEIV0(25:11)
 17817     CALL 'kxdfhei1' USING DFHEIV0,
 17818           DFHEIV99,
 17819           DFHEIV99,
 17820           DFHEIV99,
 17821           DFHEIV99,
 17822           DFHEIV99,
 17823           DFHEIV99
 17824     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17825
 17826
 17827
 17828* GOBACK.
 17829     MOVE '9%                    "   ' TO DFHEIV0
 17830     MOVE 'EL131' TO DFHEIV1
 17831     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 17832     GOBACK.
 17833
 17834 9200-XCTL.
 17835
 17836* EXEC CICS XCTL
 17837*         PROGRAM    (CALL-PGM)
 17838*         COMMAREA   (PROGRAM-INTERFACE-BLOCK)
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 334
* EL131.cbl
 17839*         LENGTH     (PI-COMM-LENGTH)
 17840*    END-EXEC.
 17841*    MOVE '.$C                   %   #00014714' TO DFHEIV0
 17842     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 17843     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17844     MOVE X'2020233030303134373134' TO DFHEIV0(25:11)
 17845     CALL 'kxdfhei1' USING DFHEIV0,
 17846           CALL-PGM,
 17847           PROGRAM-INTERFACE-BLOCK,
 17848           PI-COMM-LENGTH,
 17849           DFHEIV99
 17850     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17851
 17852
 17853 9700-LINK-RTRM-FILE-ID.
 17854
 17855* EXEC CICS LINK
 17856*        PROGRAM  (RTRM-FILE-ID)
 17857*        COMMAREA (CALCULATION-PASS-AREA)
 17858*        LENGTH   (CP-COMM-LENGTH)
 17859*    END-EXEC.
 17860*    MOVE '."C                   (   #00014721' TO DFHEIV0
 17861     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17862     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17863     MOVE X'2020233030303134373231' TO DFHEIV0(25:11)
 17864     CALL 'kxdfhei1' USING DFHEIV0,
 17865           RTRM-FILE-ID,
 17866           CALCULATION-PASS-AREA,
 17867           CP-COMM-LENGTH,
 17868           DFHEIV99,
 17869           DFHEIV99,
 17870           DFHEIV99,
 17871           DFHEIV99
 17872     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17873
 17874
 17875 9700-EXIT.
 17876      EXIT.
 17877
 17878 9800-CONVERT-DATE.
 17879     MOVE SPACES TO DC-ERROR-CODE.
 17880
 17881* EXEC CICS LINK
 17882*         PROGRAM    (DATE-CONV)
 17883*         COMMAREA   (DATE-CONVERSION-DATA)
 17884*         LENGTH     (DC-COMM-LENGTH)
 17885*    END-EXEC.
 17886*    MOVE '."C                   (   #00014732' TO DFHEIV0
 17887     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17888     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17889     MOVE X'2020233030303134373332' TO DFHEIV0(25:11)
 17890     CALL 'kxdfhei1' USING DFHEIV0,
 17891           DATE-CONV,
 17892           DATE-CONVERSION-DATA,
 17893           DC-COMM-LENGTH,
 17894           DFHEIV99,
 17895           DFHEIV99,
 17896           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 335
* EL131.cbl
 17897           DFHEIV99
 17898     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17899
 17900
 17901 9800-EXIT.
 17902     EXIT.
 17903
 17904 9900-ERROR-FORMAT.
 17905
 17906* EXEC CICS LINK
 17907*         PROGRAM    (XCTL-EL001)
 17908*         COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 17909*         LENGTH     (EMI-COMM-LENGTH)
 17910*    END-EXEC.
 17911*    MOVE '."C                   (   #00014742' TO DFHEIV0
 17912     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17913     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17914     MOVE X'2020233030303134373432' TO DFHEIV0(25:11)
 17915     CALL 'kxdfhei1' USING DFHEIV0,
 17916           XCTL-EL001,
 17917           ERROR-MESSAGE-INTERFACE-BLOCK,
 17918           EMI-COMM-LENGTH,
 17919           DFHEIV99,
 17920           DFHEIV99,
 17921           DFHEIV99,
 17922           DFHEIV99
 17923     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17924
 17925
 17926 9900-EXIT.
 17927     EXIT.
 17928
 17929 9990-ABEND.
 17930     MOVE DFHEIBLK               TO EMI-LINE1.
 17931
 17932* EXEC CICS LINK
 17933*         PROGRAM   (XCTL-EL004)
 17934*         COMMAREA  (EMI-LINE1)
 17935*         LENGTH    (72)
 17936*     END-EXEC.
 17937     MOVE 72
 17938       TO DFHEIV11
 17939*    MOVE '."C                   (   #00014753' TO DFHEIV0
 17940     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17941     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17942     MOVE X'2020233030303134373533' TO DFHEIV0(25:11)
 17943     CALL 'kxdfhei1' USING DFHEIV0,
 17944           XCTL-EL004,
 17945           EMI-LINE1,
 17946           DFHEIV11,
 17947           DFHEIV99,
 17948           DFHEIV99,
 17949           DFHEIV99,
 17950           DFHEIV99
 17951     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17952
 17953
 17954     MOVE -1                     TO  MAINTL
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 336
* EL131.cbl
 17955
 17956     GO TO 8110-SEND-DATA.
 17957
 17958 9995-SECURITY-VIOLATION.
 17959*           COPY ELCSCTP.
 17960******************************************************************
 17961*                                                                *
 17962*                            ELCSCTP                             *
 17963*                            VMOD=2.001                          *
 17964*                                                                *
 17965*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 17966******************************************************************
 17967
 17968
 17969     MOVE EIBDATE          TO SM-JUL-DATE.
 17970     MOVE EIBTRMID         TO SM-TERMID.
 17971     MOVE THIS-PGM         TO SM-PGM.
 17972     MOVE EIBTIME          TO TIME-IN.
 17973     MOVE TIME-OUT         TO SM-TIME.
 17974     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 17975
 17976
 17977* EXEC CICS LINK
 17978*         PROGRAM  ('EL003')
 17979*         COMMAREA (SECURITY-MESSAGE)
 17980*         LENGTH   (80)
 17981*    END-EXEC.
 17982     MOVE 'EL003' TO DFHEIV1
 17983     MOVE 80
 17984       TO DFHEIV11
 17985*    MOVE '."C                   (   #00014781' TO DFHEIV0
 17986     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17987     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17988     MOVE X'2020233030303134373831' TO DFHEIV0(25:11)
 17989     CALL 'kxdfhei1' USING DFHEIV0,
 17990           DFHEIV1,
 17991           SECURITY-MESSAGE,
 17992           DFHEIV11,
 17993           DFHEIV99,
 17994           DFHEIV99,
 17995           DFHEIV99,
 17996           DFHEIV99
 17997     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17998
 17999
 18000******************************************************************
 18001
 18002
 18003
 18004 9999-DFHBACK SECTION.
 18005     MOVE '9%                    "   ' TO DFHEIV0
 18006     MOVE 'EL131' TO DFHEIV1
 18007     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 18008     GOBACK.
 18009 9999-DFHEXIT.
 18010     IF DFHEIGDJ EQUAL 0001
 18011         NEXT SENTENCE
 18012     ELSE IF DFHEIGDJ EQUAL 2
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 337
* EL131.cbl
 18013         GO TO 8820-XCTL-ERROR,
 18014               8150-ENTERED-CLAIM-NOTFOUND,
 18015               9990-ABEND
 18016         DEPENDING ON DFHEIGDI
 18017     ELSE IF DFHEIGDJ EQUAL 3
 18018         GO TO 0130-TS-ERROR,
 18019               0130-TS-ERROR
 18020         DEPENDING ON DFHEIGDI
 18021     ELSE IF DFHEIGDJ EQUAL 4
 18022         GO TO 0600-CONTINUE-NAME-UPDATE
 18023         DEPENDING ON DFHEIGDI
 18024     ELSE IF DFHEIGDJ EQUAL 5
 18025         GO TO 1004-BENE-NOT-FOUND
 18026         DEPENDING ON DFHEIGDI
 18027     ELSE IF DFHEIGDJ EQUAL 6
 18028         GO TO 1052-DONE,
 18029               1052-DONE
 18030         DEPENDING ON DFHEIGDI
 18031     ELSE IF DFHEIGDJ EQUAL 7
 18032         GO TO 1120-CNTL-NOTFND
 18033         DEPENDING ON DFHEIGDI
 18034     ELSE IF DFHEIGDJ EQUAL 8
 18035         GO TO 1150-NOTOPEN-ERROR,
 18036               1150-EXIT
 18037         DEPENDING ON DFHEIGDI
 18038     ELSE IF DFHEIGDJ EQUAL 9
 18039         GO TO 1490-STATE-NOTFND
 18040         DEPENDING ON DFHEIGDI
 18041     ELSE IF DFHEIGDJ EQUAL 10
 18042         GO TO 1500-CARR-NOTFND
 18043         DEPENDING ON DFHEIGDI
 18044     ELSE IF DFHEIGDJ EQUAL 11
 18045         GO TO 1620-ACCT-NOTFND
 18046         DEPENDING ON DFHEIGDI
 18047     ELSE IF DFHEIGDJ EQUAL 12
 18048         GO TO 2020-EXIT
 18049         DEPENDING ON DFHEIGDI
 18050     ELSE IF DFHEIGDJ EQUAL 13
 18051         GO TO 2030-EXIT
 18052         DEPENDING ON DFHEIGDI
 18053     ELSE IF DFHEIGDJ EQUAL 14
 18054         GO TO 2040-EXIT
 18055         DEPENDING ON DFHEIGDI
 18056     ELSE IF DFHEIGDJ EQUAL 15
 18057         GO TO 2050-EXIT
 18058         DEPENDING ON DFHEIGDI
 18059     ELSE IF DFHEIGDJ EQUAL 16
 18060         GO TO 2060-CERT-NOTFND
 18061         DEPENDING ON DFHEIGDI
 18062     ELSE IF DFHEIGDJ EQUAL 17
 18063         GO TO 2060-DUPKEY
 18064         DEPENDING ON DFHEIGDI
 18065     ELSE IF DFHEIGDJ EQUAL 18
 18066         GO TO 2070-NOT-FOUND
 18067         DEPENDING ON DFHEIGDI
 18068     ELSE IF DFHEIGDJ EQUAL 19
 18069         GO TO 2070-EXIT
 18070         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 338
* EL131.cbl
 18071     ELSE IF DFHEIGDJ EQUAL 20
 18072         GO TO 2080-EXIT
 18073         DEPENDING ON DFHEIGDI
 18074     ELSE IF DFHEIGDJ EQUAL 21
 18075         GO TO 2400-TRLR-NOTFND,
 18076               2410-EXIT
 18077         DEPENDING ON DFHEIGDI
 18078     ELSE IF DFHEIGDJ EQUAL 22
 18079         GO TO 2425-NINETY-NOTFND,
 18080               2425-NINETY-NOTFND
 18081         DEPENDING ON DFHEIGDI
 18082     ELSE IF DFHEIGDJ EQUAL 23
 18083         GO TO 2430-EXIT,
 18084               2440-EXIT
 18085         DEPENDING ON DFHEIGDI
 18086     ELSE IF DFHEIGDJ EQUAL 24
 18087         GO TO 2440-EXIT
 18088         DEPENDING ON DFHEIGDI
 18089     ELSE IF DFHEIGDJ EQUAL 25
 18090         GO TO 2460-EXIT
 18091         DEPENDING ON DFHEIGDI
 18092     ELSE IF DFHEIGDJ EQUAL 26
 18093         GO TO 2475-EXIT
 18094         DEPENDING ON DFHEIGDI
 18095     ELSE IF DFHEIGDJ EQUAL 27
 18096         GO TO 2650-EXIT
 18097         DEPENDING ON DFHEIGDI
 18098     ELSE IF DFHEIGDJ EQUAL 28
 18099         GO TO 2800-EXIT,
 18100               2800-EXIT
 18101         DEPENDING ON DFHEIGDI
 18102     ELSE IF DFHEIGDJ EQUAL 29
 18103         GO TO 3010-DEL-ACTQ,
 18104               3040-EXIT
 18105         DEPENDING ON DFHEIGDI
 18106     ELSE IF DFHEIGDJ EQUAL 30
 18107         GO TO 3010-NO-ACTIVITY,
 18108               3050-EXIT
 18109         DEPENDING ON DFHEIGDI
 18110     ELSE IF DFHEIGDJ EQUAL 31
 18111         GO TO 3010-CERT-NOT-FOUND
 18112         DEPENDING ON DFHEIGDI
 18113     ELSE IF DFHEIGDJ EQUAL 32
 18114         GO TO 3020-EXIT
 18115         DEPENDING ON DFHEIGDI
 18116     ELSE IF DFHEIGDJ EQUAL 33
 18117         GO TO 3060-EXIT,
 18118               3060-EXIT
 18119         DEPENDING ON DFHEIGDI
 18120     ELSE IF DFHEIGDJ EQUAL 34
 18121         GO TO 5000-TRLR-NOT-FOUND
 18122         DEPENDING ON DFHEIGDI
 18123     ELSE IF DFHEIGDJ EQUAL 35
 18124         GO TO 5000-CERT-NOT-FOUND
 18125         DEPENDING ON DFHEIGDI
 18126     ELSE IF DFHEIGDJ EQUAL 36
 18127         GO TO 1052-DONE,
 18128               1052-DONE
* Micro Focus Server Express         V5.1 revision 000 15-Jan-20 10:29 Page 339
* EL131.cbl
 18129         DEPENDING ON DFHEIGDI
 18130     ELSE IF DFHEIGDJ EQUAL 37
 18131         GO TO 7630-END-BROWSE
 18132         DEPENDING ON DFHEIGDI
 18133     ELSE IF DFHEIGDJ EQUAL 38
 18134         GO TO 7799-EXIT,
 18135               7799-EXIT
 18136         DEPENDING ON DFHEIGDI
 18137     ELSE IF DFHEIGDJ EQUAL 39
 18138         GO TO 7799-EXIT
 18139         DEPENDING ON DFHEIGDI
 18140     ELSE IF DFHEIGDJ EQUAL 40
 18141         GO TO 7800-NOT-FOUND
 18142         DEPENDING ON DFHEIGDI
 18143     ELSE IF DFHEIGDJ EQUAL 41
 18144         GO TO 8000-NOTE-NOT-FOUND
 18145         DEPENDING ON DFHEIGDI
 18146     ELSE IF DFHEIGDJ EQUAL 42
 18147         GO TO 8990-SEND-TEXT
 18148         DEPENDING ON DFHEIGDI.
 18149     MOVE '9%                    "   ' TO DFHEIV0
 18150     MOVE 'EL131' TO DFHEIV1
 18151     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 18152     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       14268     Code:       64143
