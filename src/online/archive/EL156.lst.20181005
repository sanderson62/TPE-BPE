* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page   1
* EL156.cbl
* Options: int("EL156.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL156.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL156.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL156.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL156 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 05/17/94 13:55:56.
     7*                            VMOD=2.098
     8*
     9*
    10*AUTHOR.     LOGIC,INC.
    11*            DALLAS, TEXAS.
    12
    13*REMARKS.    TRANSACTION - EX29 - PAYMENT PROCESSING
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page   2
* EL156.cbl
    14******************************************************************
    15*                   C H A N G E   L O G
    16*
    17* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    18*-----------------------------------------------------------------
    19*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    20* EFFECTIVE    NUMBER
    21*-----------------------------------------------------------------
    22* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    23* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST CALC
    24* 052506    2006030600001  AJRA  ADD PROOF DATE
    25* 071806    2004040700004  PEMA  ADD TONYS PROOF DATE TO INT CALC
    26* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
    27* 110807  IR2007110700001  AJRA  DO NOT CALC INT ON MANUAL PMTS
    28* 022208    2008021500001  AJRA  DO NOT DEFAULT PROOF DATE,FORCE E
    29* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
    30* 060608    2008040300002  PEMA  ADD EFF DT TO ELCLMI PASS AREA
    31* 091808    2008022800002  AJRA  GET CHECK NUMBER FROM STATE CNTL
    32* 012810    2007111300001  AJRA  EXPAND EDIT PATTERN
    33* 041710    2007111300001  AJRA  ADD MSG AND CALC PMT FOR SC NET P
    34* 092310  IR2010090900001  PEMA  CHANGE CRIT PERIOD EDIT
    35* 112210    2010091000003  AJRA  MICHIGAN FULL MONTH ON 1ST PAYMEN
    36* 042011  CR2011040600001  PEMA  ADD EOB PROCESSING FOR DCC
    37* 061511    2011042000002  AJRA  VERIFY 2ND BENEFICIARY SSN
    38* 030512    2011120900003  AJRA  ADD AHL COMPANY CODE
    39* 041812  IR2012041800001  AJRA  FIX TERM/REM ON SCREEN
    40* 013013    2012092400003  AJRA  SPECIAL EOB FOR ACCELERATED DEATH
    41* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
    42* 020513    2012092400005  AJRA  LIFE PAYEE NAME SHOULD NOT = INS
    43* 032813    2011013100001  AJRA  SELECT CLAIM PAYMENTS FOR REAUDIT
    44* 061013    2012113000002  PEMA  ADD SPECIAL STUFF FOR SPP DDF
    45* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
    46* 110513    2013102900002  AJRA  FIX AK PAYEE STATE CODE ROUTINE
    47* 102413    2013100800001  AJRA  ADD SPECIAL RELEASE IND
    48* 111113    2013110600002  AJRA  CHG LEVEL 5 RESTRICTIONS TO LEVEL
    49* 030514    2014021300001  AJRA  FORCE LF PAYMENT > BENEFIT AMT
    50* 032414    2013092400002  AJRA  LIFE ADDIT PMTS TO ESTATE SHOULD
    51* 032514    2013111100001  AJRA  VERIFY SSN FOR DISAB PMTS
    52* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
    53* 052814  CR2014041800001  AJRA  SET APPROVAL FLAG FOR 3550 MESSAG
    54* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
    55* 070714    2014052800001  PEMA  correct read on erpdef for DCC
    56* 100314  CR2014061900001  PEMA  Add pct of benefit funcionality
    57* 111714  CR2014073000001  PEMA  DRAFTS TO CHECKS
    58* 032015  CR2014121000003  TANA  Default prnt survey to 'N'for DCC
    59* 110515  IR2015103000001  TANA  Check app level for 3550 message
    60* 120115  CR2015082700002  PEMA  ADD JNT BORROWER PROCESSING
    61* 012016  IR2016011800003  PEMA  FIXED LENGTH OF PAYEE NAME
    62* 050616  CR2015030200004  TANA  Additional pmt Pd thru exp date
    63* 013017  CR2016053100001  PEMA  ACH PROCESSING
    64* 081817    2016100700001  TANA  ADD NBR OF EXTENSIONS
    65* 102617    2017101800003  TANA  Fix family leave auth level
    66* 022718    2017100200004  TANA  Set hold & pays > than 30 days
    67* 031218    2018030800002  TANA  Handle offline pmts w/ hold & pay
    68* 082218  CR2018051400001  TANA  Hold and Pay
    69******************************************************************
    70
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page   3
* EL156.cbl
    72 ENVIRONMENT DIVISION.
    73
    74 DATA DIVISION.
    75
    76 WORKING-STORAGE SECTION.
    77 01  DFH-START PIC X(04).
    78
    79 77  FILLER  PIC X(32)  VALUE '********************************'.
    80 77  FILLER  PIC X(32)  VALUE '*    EL156 WORKING STORAGE     *'.
    81 77  FILLER  PIC X(32)  VALUE '********** VMOD=2.098 **********'.
    82 77  WS-SSN  PIC X(9) VALUE ZEROS.
    83 77  WS-SET-NOTE2-MDT            PIC X  VALUE SPACES.
    84 77  C0                          PIC S999 COMP-3 VALUE +0.
    85 77  C1                          PIC S999 COMP-3 VALUE +0.
    86 77  C2                          PIC S999 COMP-3 VALUE +0.
    87 77  C3                          PIC S999 COMP-3 VALUE +0.
    88 77  s1                          PIC S999 COMP-3 VALUE +0.
    89 77  s2                          pic s999 comp-3 value +0.
    90 77  P1                          PIC S999 COMP-3 VALUE +0.
    91 77  WS-DDF-COMM-AND-MFEE        PIC S9(5)V99 VALUE +0 COMP-3.
    92 77  WS-DDF-ADMIN-FEES           PIC S9(5)V99 VALUE +0 COMP-3.
    93 77  WS-DDF-CSO-ADMIN-FEE        PIC S9(5)V99 VALUE +0 COMP-3.
    94 77  WS-DDF-1ST-YR-TOT-EXP       PIC S9(5)V99 VALUE +0 COMP-3.
    95 77  WS-STATE-EXT-DAYS-CHG       PIC X  VALUE ' '.
    96 77  TEX-FACT-8                  PIC S9V9(6)     COMP-3.
    97 77  WS-COMM-PCT                 PIC S9(5)V9(5)  COMP-3 VALUE +0.
    98 77  WS-TERM                     PIC S999 COMP-3 VALUE +0.
    99 77  ws-monthly-benefit          pic s9(11)v99 comp-3 value +0.
   100 77  ws-max-bens                 pic s999 comp-3 value +0.
   101 77  ws-prev-days-paid           pic s9(5) comp-3 value +0.
   102 77  ws-prev-amt-paid            pic s9(9)v99 comp-3 value +0.
   103 77  ws-tot-days-paid            pic s9(5) comp-3 value +0.
   104 77  ws-tot-amt-paid             pic s9(9)v99 comp-3 value +0.
   105 77  ws-pd-bens                  pic s9(5) comp-3 value +0.
   106 77  ws-work-ben-pct             pic s9v999 comp-3 value +0.
   107
   108*    COPY ELCSCTM.
   109******************************************************************
   110*                                                                *
   111*                                                                *
   112*                            ELCSCTM                             *
   113*                            VMOD=2.001                          *
   114*                                                                *
   115*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   116*                                                                *
   117******************************************************************
   118 01  SECURITY-MESSAGE.
   119     12  FILLER                          PIC X(30)
   120            VALUE '** LOGIC SECURITY VIOLATION -'.
   121     12  SM-READ                         PIC X(6).
   122     12  FILLER                          PIC X(5)
   123            VALUE ' PGM='.
   124     12  SM-PGM                          PIC X(6).
   125     12  FILLER                          PIC X(5)
   126            VALUE ' OPR='.
   127     12  SM-PROCESSOR-ID                 PIC X(4).
   128     12  FILLER                          PIC X(6)
   129            VALUE ' TERM='.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page   4
* EL156.cbl
   130     12  SM-TERMID                       PIC X(4).
   131     12  FILLER                          PIC XX   VALUE SPACE.
   132     12  SM-JUL-DATE                     PIC 9(5).
   133     12  FILLER                          PIC X    VALUE SPACE.
   134     12  SM-TIME                         PIC 99.99.
   135
   136
   137*    COPY ELCSCRTY.
   138******************************************************************
   139*                                                                *
   140*                                                                *
   141*                            ELCSCRTY                            *
   142*                            VMOD=2.001                          *
   143*                                                                *
   144*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   145*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   146*        SAVED IN PI-SECURITY-ADDRESS.                           *
   147*                                                                *
   148******************************************************************
   149 01  SECURITY-CONTROL.
   150     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   151     12  FILLER                       PIC XX    VALUE 'SC'.
   152     12  SC-CREDIT-CODES.
   153         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   154             20  SC-CREDIT-DISPLAY    PIC X.
   155             20  SC-CREDIT-UPDATE     PIC X.
   156     12  SC-CLAIMS-CODES.
   157         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   158             20  SC-CLAIMS-DISPLAY    PIC X.
   159             20  SC-CLAIMS-UPDATE     PIC X.
   160
   161 01  WS-BIN-PROOF-DT             PIC XX  VALUE LOW-VALUES.
   162 01  WS-DATE-AREA.
   163     12  SAVE-DATE           PIC X(8)    VALUE SPACES.
   164     12  SAVE-BIN-DATE       PIC XX      VALUE SPACES.
   165     12  SAVE-DATE-CCYYMMDD.
   166         16  SAVE-DATE-CC            PIC XX      VALUE SPACES.
   167         16  SAVE-DATE-YMD.
   168             20  SAVE-DATE-YY        PIC XX      VALUE SPACES.
   169             20  FILLER              PIC X(04)   VALUE SPACES.
   170
   171 01  WS-SAVED-EOB-CODES          PIC X(60) VALUE SPACES.
   172 01  STANDARD-AREAS.
   173     12  WS-RESPONSE         PIC S9(8)   COMP.
   174         88  WS-RESP-NORMAL              VALUE +00.
   175         88  WS-RESP-ERROR               VALUE +01.
   176         88  WS-RESP-NOTFND              VALUE +13.
   177         88  WS-RESP-DUPREC              VALUE +14.
   178         88  WS-RESP-ENDFILE             VALUE +20.
   179     12  PMT-HEAD-A.
   180         16  FILLER          PIC X(09)   VALUE 'PAY-FROM '.
   181         16  HDGA-VRBLE      PIC X(10)   VALUE 'PAY THRU  '.
   182         16  FILLER          PIC X(47)   VALUE 'DAYS   PAYMENT AMT
   183-        '     RESERVES  TYPE    AMOUNT'.
   184     12  PMT-HEAD-B.
   185         16  FILLER          PIC X(12)   VALUE 'PAYS FROM   '.
   186         16  HDGB-VRBLE      PIC X(12)   VALUE 'PAYS THRU   '.
   187         16  FILLER          PIC X(10)   VALUE 'DAYS   BY '.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page   5
* EL156.cbl
   188     12  SC-ITEM             PIC S9(4)   VALUE +0001  COMP.
   189     12  GETMAIN-SPACE       PIC X       VALUE SPACE.
   190     12  MAP-NAME            PIC X(8)    VALUE 'EL156A'.
   191     12  MAP-NAMEA           PIC X(8)    VALUE 'EL156A'.
   192     12  MAP-NAMEB           PIC X(8)    VALUE 'EL156B'.
   193     12  MAPSET-NAME         PIC X(8)    VALUE 'EL156S'.
   194     12  TRANS-ID            PIC X(4)    VALUE 'EX29'.
   195     12  THIS-PGM            PIC X(8)    VALUE 'EL156'.
   196     12  PGM-NAME            PIC X(8).
   197     12  TIME-IN             PIC S9(7).
   198     12  TIME-OUT-R  REDEFINES TIME-IN.
   199         16  FILLER          PIC X.
   200         16  TIME-OUT        PIC 99V99.
   201         16  FILLER          PIC XX.
   202     12  XCTL-005            PIC X(8)    VALUE 'EL005'.
   203     12  XCTL-010            PIC X(8)    VALUE 'EL010'.
   204     12  XCTL-126            PIC X(8)    VALUE 'EL126'.
   205     12  XCTL-141            PIC X(8)    VALUE 'EL141'.
   206     12  XCTL-157            PIC X(8)    VALUE 'EL157'.
   207     12  XCTL-155            PIC X(8)    VALUE 'EL155'.
   208     12  XCTL-130            PIC X(8)    VALUE 'EL130'.
   209     12  XCTL-132            PIC X(8)    VALUE 'EL132'.
   210     12  LINK-001            PIC X(8)    VALUE 'EL001'.
   211     12  LINK-004            PIC X(8)    VALUE 'EL004'.
   212     12  LINK-1523           PIC X(8)    VALUE 'EL1523'.
   213     12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
   214     12  LINK-REMTERM        PIC X(8)    VALUE 'ELRTRM'.
   215     12  LINK-REMAMT         PIC X(8)    VALUE 'ELRAMT'.
   216     12  ELARCH-LENGTH       PIC S9(4)   VALUE +90     COMP.
   217     12  WS-BLANK            PIC X       VALUE ' '.
   218
   219 01  MISC-WORK-AREAS.
   220     12  W-INTEREST              PIC S9(7)V99  COMP-3 VALUE +0.
   221     12  W-PAYMENT-TOTAL         PIC S9(7)V99  COMP-3 VALUE +0.
   222     12  W-PERCENT               PIC S9V9(4)   COMP-3 VALUE +0.
   223     12  W-TOTAL-INTEREST        PIC S9(7)V99  COMP-3 VALUE +0.
   224     12  W-PAID-DAYS             PIC S999      COMP-3 VALUE +0.
   225     12  W-PAID-MONTHS           PIC S999      COMP-3 VALUE +0.
   226     12  W-REM                   PIC S999      COMP-3 VALUE +0.
   227     12  W-REM-DAYS              PIC S999      COMP-3 VALUE +0.
   228     12  W-TERM-IN-DAYS          PIC S9(4)     COMP-3.
   229     12  W-REM-TERM-IN-DAYS      PIC S9(4)     COMP-3.
   230     12  W-CALLED-NAME           PIC X(08).
   231     12  W-EOB-CODES.
   232         16  W-EOB-CODE-GRP OCCURS 5 TIMES.
   233             20  W-EOB-CODE      PIC XXX.
   234             20  W-EOB-FILLER    PIC X.
   235     12  W-EOB-NDX               PIC S9        VALUE ZERO.
   236     12  W-NAME-LAST             PIC X(15).
   237     12  W-NAME-FIRST            PIC X(15).
   238     12  W-NAME-MIDDLE.
   239         16  FILLER              PIC X.
   240         16  W-NAME-MIDDLE-2     PIC X.
   241         16  FILLER              PIC X(13).
   242     12  W-DMD-CHECK-NO.
   243         16  W-DMD-CHECK-NO-1    PIC X(4).
   244         16  W-DMD-CHECK-NO-2    PIC X.
   245         16  W-DMD-CHECK-NO-3    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page   6
* EL156.cbl
   246
   247     12  WS-COMPUTE-FROM-DT  PIC XX.
   248     12  WS-PMT-MOS          PIC 999V99        VALUE ZEROS.
   249     12  WS-HER-PART-DAYS    PIC 999V99        VALUE ZEROS.
   250     12  WS-HER-MO-PMT-AMT   PIC 9(07)V99      VALUE ZEROS.
   251     12  WS-FORM-CTL-SEQ-NO  PIC S9(4)   COMP  VALUE +0.
   252     12  WS-HOLD-ELMSTR-KEY  PIC X(20) VALUE LOW-VALUES.
   253     12  WS-PRINTED-SW       PIC X VALUE SPACES.
   254         88  PAYMENT-HAS-BEEN-PRINTED  VALUE 'Y'.
   255         88  PAYMENT-NOT-PRINTED       VALUE 'N'.
   256     12  WS-RELEASED-SW      PIC X VALUE SPACES.
   257         88  PAYMENT-NOT-RELEASED      VALUE 'N'.
   258     12  WS-UPDATE-SW        PIC X VALUE ' '.
   259     12  WS-GROUPING.
   260         16  WS-GROUP-1      PIC X VALUE SPACES.
   261         16  FILLER          PIC X(05) VALUE SPACES.
   262     12  WS-BROWSE-TRLR-SW   PIC X VALUE ' '.
   263     12  WS-BROWSE-START-SW  PIC X VALUE ' '.
   264     12  WS-WORK-STATE-ACCT.
   265         16  WS-WORK-ACCT    PIC X(10)   VALUE SPACES.
   266         16  FILLER          PIC X       VALUE '/'.
   267         16  WS-WORK-STATE   PIC XX      VALUE SPACES.
   268     12  WS-CHECK-WRITTEN-DT PIC XX      VALUE LOW-VALUES.
   269     12  WS-PMT-APPROVAL-SW  PIC X       VALUE SPACES.
   270     12  WS-SPECIAL-CALC-CD  PIC X       VALUE SPACES.
   271     12  QID.
   272         16  QID-TERM        PIC X(4)    VALUE SPACES.
   273         16  FILLER          PIC X(4)    VALUE '156A'.
   274     12  MAP-LENGTH          PIC S9(4)   VALUE +1098 COMP.
   275     12  SUB-1               PIC S9(4)   VALUE +0     COMP.
   276     12  FIRST-ENTRY         PIC X       VALUE 'N'.
   277     12  FILE-SWITCH         PIC X(4)    VALUE SPACES.
   278     12  BENE-FOUND-SW       PIC X       VALUE SPACE.
   279     12  FOUND-TOL-SW        PIC X       VALUE 'N'.
   280     12  RETURNED-FROM-B     PIC X       VALUE 'N'.
   281     12  RETURNED-FROM       PIC X(8)    VALUE SPACES.
   282     12  WS-STATUS           PIC X       VALUE SPACES.
   283     12  WS-TODAY-DATE       PIC XX      VALUE LOW-VALUES.
   284     12  WS-RETRO-ELIM-DATE  PIC XX      VALUE LOW-VALUES.
   285     12  WS-EXP-DT           PIC XX      VALUE LOW-VALUES.
   286     12  ws-extended-exp-dt  pic xx      value low-values.
   287     12  WS-SV-EPYFROM       PIC XX      VALUE LOW-VALUES.
   288     12  WS-SV-AIGFROM       PIC XX      VALUE LOW-VALUES.
   289     12  WS-SV-EPYTHRU       PIC XX      VALUE LOW-VALUES.
   290     12  WS-SV-PREV-PD-THRU  PIC XX      VALUE LOW-VALUES.
   291     12  WS-STATE-ABBREV     PIC XX      VALUE SPACES.
   292     12  WS-BEN-DAYS         PIC 99      VALUE ZEROS.
   293     12  WS-PMT-UNAPPROVED-CNT PIC S9(3)   VALUE +0      COMP-3.
   294     12  WS-DAYS-TOL         PIC S9(3)     VALUE +0      COMP-3.
   295     12  WS-PMT-TOL          PIC S9(3)V99  VALUE +0      COMP-3.
   296     12  WS-MAX-DAYS-TOL     PIC S9(3)     VALUE +0      COMP-3.
   297     12  WS-MAX-PMT-TOL      PIC S9(7)V99  VALUE +0      COMP-3.
   298     12  WS-MAX-LF-PMT-TOL   PIC S9(7)V99  VALUE +0      COMP-3.
   299     12  WS-AH-BEN-AMT       PIC S9(7)V999 VALUE +0      COMP-3.
   300     12  WS-LF-BEN-AMT       PIC S9(9)V99  VALUE +0      COMP-3.
   301     12  WS-BEN-AMT-LEFT     PIC S9(7)V99  VALUE +0.
   302     12  WS-REMAINING-AMT    PIC S9(9)V99  VALUE +0.
   303     12  WS-TOL-SEVERITY     PIC X         VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page   7
* EL156.cbl
   304     12  WS-LF-COVERAGE-TYPE PIC X         VALUE ' '.
   305     12  WS-EARNING-METHOD   PIC X         VALUE ' '.
   306     12  WS-CALC-METHOD      PIC X         VALUE ' '.
   307     12  WS-PAY-TYPE         PIC X         VALUE ' '.
   308     12  EXPENSE-MONTH-SAVE      PIC S9(4)     COMP-3 VALUE +0.
   309     12  WS-RESERVE-WORK         PIC S9(6)V99  COMP-3 VALUE +0.
   310     12  WS-EDIT-PATTERN         PIC Z(7).99  VALUE ZEROS.
   311     12  WS-EDIT REDEFINES WS-EDIT-PATTERN PIC X(10).
   312     12  WORK-DATE-FROM.
   313         16  WDF-MONTH       PIC 99        VALUE ZERO.
   314         16  WDF-DAY         PIC 99        VALUE ZERO.
   315         16  WDF-YEAR        PIC 99        VALUE ZERO.
   316     12  WORK-DATE-THRU.
   317         16  WDT-MONTH       PIC 99        VALUE ZERO.
   318         16  WDT-DAY         PIC 99        VALUE ZERO.
   319         16  WDT-YEAR        PIC 99        VALUE ZERO.
   320     12  FROM-DAYS-IN-MONTH  PIC 99        VALUE ZERO.
   321     12  THRU-DAYS-IN-MONTH  PIC 99        VALUE ZERO.
   322     12  FROM-PMT-DAYS       PIC 99        VALUE ZERO.
   323     12  THRU-PMT-DAYS       PIC 99        VALUE ZERO.
   324     12  SAVE-ELAPSED-MONTHS PIC 999       VALUE ZERO.
   325     12  SAVE-ELAPSED-DAYS   PIC 9(04)     VALUE ZERO.
   326     12  WS-SAVE-ODD-DAYS    PIC S9(04)    VALUE ZERO.
   327     12  SAVE-ODD-DAYS-OVER  PIC 999       VALUE ZERO.
   328     12  WS-DAILY-RATE       PIC S999V99999  VALUE +0.
   329     12  WS-PY-WORK          PIC S9(8)V99 VALUE +0.
   330     12  WS-PY-WK REDEFINES WS-PY-WORK.
   331         16  WS-PY-NUM       PIC S9(7)V99.
   332         16  WS-PY-SIGN      PIC X.
   333     12  WS-DY-WORK          PIC S9(5).
   334     12  WS-DY-WK REDEFINES WS-DY-WORK.
   335         16  WS-DY-NUM       PIC S9(4).
   336         16  WS-DY-SIGN      PIC X.
   337     12  WS-COMP-MSTR-SW     PIC X       VALUE 'N'.
   338         88  COMP-REC-FOUND              VALUE 'Y'.
   339     12  WS-BEN-SEARCH-SW    PIC X       VALUE 'N'.
   340         88  BENEFIT-FOUND       VALUE 'Y'.
   341         88  NO-BENEFIT-FOUND    VALUE 'N'.
   342     12  WS-TERMS.
   343         16  WST-ORIG        PIC ZZ9     VALUE ZEROS.
   344         16  FILLER          PIC X       VALUE '/'.
   345         16  WST-REM         PIC ZZ9     VALUE ZEROS.
   346         16  WST-REM-DAYS-GRP.
   347             20  WST-SLASH   PIC X       VALUE '/'.
   348             20  WST-REM-DAYS
   349                             PIC --9.
   350     12  WS-ACCESS.
   351         16  FILLER          PIC XX      VALUE SPACES.
   352         16  WS-BEN-CD       PIC XX      VALUE SPACES.
   353     12  WS-STATE-ACCESS.
   354         16  WS-ST-ACCESS    PIC XX      VALUE SPACES.
   355         16  FILLER          PIC XX      VALUE SPACES.
   356     12  WS-CARR-ACCESS.
   357         16  FILLER          PIC X(3)    VALUE SPACES.
   358         16  WS-CARR         PIC X       VALUE SPACES.
   359     12  DATE-WORK.
   360         16  FILLER          PIC XX      VALUE SPACES.
   361         16  NUM-WORK        PIC X(6)    VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page   8
* EL156.cbl
   362     12  WS-SAVE-INPUT.
   363         16  WS-PMTTYPE      PIC X       VALUE SPACE.
   364         16  WS-PAYEE        PIC XX      VALUE SPACE.
   365         16  WS-PMTNOTE1     PIC X(60)   VALUE SPACES.
   366         16  WS-PMTNOTE2     PIC X(60)   VALUE SPACES.
   367         16  WS-OFFLINE      PIC X       VALUE SPACE.
   368         16  WS-CHECKNO      PIC X(7)    VALUE SPACES.
   369         16  WS-HOLDTIL      PIC 9(6)    VALUE 0.
   370         16  WS-EPYFROM      PIC 9(6)    VALUE 0.
   371         16  WS-EPYTHRU      PIC 9(6)    VALUE 0.
   372         16  WS-EDAYS        PIC S9(5)    VALUE +0.
   373         16  WS-EPYAMT       PIC S9(7)V99 VALUE +0.
   374         16  WS-ERESV        PIC S9(7)V99 VALUE +0.
   375         16  WS-EEXPENS      PIC 9(6)V99  VALUE 0.
   376         16  WS-ETYPE        PIC X       VALUE SPACE.
   377         16  WS-CASH         PIC X       VALUE SPACE.
   378         16  WS-GROUPED      PIC X       VALUE SPACE.
   379         16  WS-INT-RATE     PIC S99V9(5) VALUE +0.
   380         16  WS-AIGFROM      PIC 9(6)    VALUE 0.
   381         16  WS-LOAN-NO      PIC X(20)   VALUE SPACES.
   382         16  WS-PROOF-DATE   PIC 9(6)    VALUE 0.
   383         16  WS-PRINT-EOB-YN PIC X       VALUE ' '.
   384         16  WS-PRINT-CLM-FRM-YN PIC X   VALUE SPACE.
   385         16  WS-PRINT-SURVEY-YN PIC X    VALUE SPACE.
   386         16  WS-SPECIAL-RELEASE-YN PIC X VALUE SPACE.
   387         16  ws-int-to-rem-borr pic x value spaces.
   388     12  LAST-ERROR-LINE.
   389         16  WS-FATAL-CTR        PIC ZZ9  VALUE ZEROS.
   390         16  FILLER              PIC X(30)
   391             VALUE ' FATAL ERRORS ENCOUNTERED'.
   392         16  WS-FORCE-CTR        PIC ZZ9   VALUE ZEROS.
   393         16  FILLER              PIC X(28)
   394             VALUE ' FORCIBLE ERRORS ENCOUNTERED'.
   395     12  WS-CHECK-AREA.
   396         16  WS-CHECK-CARR       PIC X   VALUE SPACES.
   397         16  WS-CHECK-NUM        PIC 9(6) VALUE ZEROS.
   398     12  WS-CHECK-NUMERIC REDEFINES WS-CHECK-AREA PIC 9(7).
   399     12  WS-CHECK-AREA-RDF REDEFINES WS-CHECK-AREA.
   400         16  FILLER              PIC XX.
   401         16  WS-A-CHECK-NUM-5    PIC 9(5).
   402     12  WS-CHECK-AREA-RDF1 REDEFINES WS-CHECK-AREA.
   403         16  FILLER              PIC X.
   404         16  WS-A-CHECK-NUM-6    PIC 9(6).
   405     12  OPTION-1-SAVE-AREA.
   406         16  SAVE1-FROM-DAYS-IN-MONTH    PIC 999  VALUE ZEROS.
   407         16  SAVE1-THRU-DAYS-IN-MONTH    PIC 999  VALUE ZEROS.
   408     12  WS-WORK-ZIP.
   409         16  WS-ZIP              PIC X(5)  VALUE ZEROS.
   410         16  WS-ZIP-EXT          PIC X(4)  VALUE ZEROS.
   411     12  WS-NUMERIC-ZIP REDEFINES WS-WORK-ZIP
   412                                 PIC 9(9).
   413     12  WS-FLI-PMTNOTE.
   414         16  WS-PMTOPTION        PIC XX.
   415         16  WS-DOCNAME          PIC X(28).
   416         16  WS-AMOUNT-LINE REDEFINES WS-DOCNAME.
   417             20  WS-AMOUNT       PIC X(8).
   418             20  FILLER          PIC X(20).
   419         16  WS-NUMERIC-LINE REDEFINES WS-DOCNAME.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page   9
* EL156.cbl
   420             20  WS-NUM-AMT      PIC 9(6)V99.
   421             20  FILLER          PIC X(20).
   422
   423     12  WS-HAN-PMTNOTE.
   424         16  WS-HAN-PMT-CODE     PIC X.
   425         16  WS-HAN-PMT-NOTE     PIC X(39).
   426
   427     12  WS-NCL-PMT-OPTION       PIC XX.
   428         88  WS-VALID-NCL-OPTION           VALUE '00' THRU '19'.
   429
   430     12  WS-CLAIM-SEQUENCE.
   431         16  FILLER              PIC X VALUE '('.
   432         16  WS-CUR-SEQU         PIC Z9    VALUE ZEROS.
   433         16  FILLER              PIC X(04) VALUE ' OF '.
   434         16  WS-OF-SEQU          PIC Z9    VALUE ZEROS.
   435         16  FILLER              PIC X VALUE ')'.
   436
   437     12  WS-REFUND-AMT           PIC Z(7).99.
   438     12  WS-CALC-INT             PIC S9(7)V99.
   439     12  ws-benefits-paid     PIC S9(4)V999 VALUE +0  COMP-3.
   440
   441     12  SUB                     PIC 99 VALUE ZEROS.
   442
   443     12  WS-BOANOTE1.
   444         16  WS-BOANOTE1-DESC    PIC X(11).
   445         16  WS-BOANOTE1-EPYAMT  PIC Z,ZZZ,ZZZ.99.
   446         16  FILLER              PIC X(17).
   447     12  WS-BOANOTE2.
   448         16  WS-BOANOTE2-DESC    PIC X(11).
   449         16  WS-BOANOTE2-INT     PIC Z,ZZZ,ZZZ.99.
   450         16  FILLER              PIC X(17).
   451
   452     12  WS-NCLNOTE1.
   453         16  WS-NCLNOTE1-DESC    PIC X(11).
   454         16  WS-NCLNOTE1-CPYAMT  PIC Z,ZZZ,ZZZ.99.
   455         16  FILLER              PIC X(17).
   456     12  WS-NCLNOTE2.
   457         16  WS-NCLNOTE2-DESC    PIC X(11).
   458         16  WS-NCLNOTE2-INT     PIC Z,ZZZ,ZZZ.99.
   459         16  FILLER              PIC X(17).
   460
   461     12  WS-MAX-LETTER-ANSWER-DT PIC XX         VALUE LOW-VALUES.
   462     12  WS-SAVE-APPROVAL-LEVEL-REQD  PIC X.
   463     12  WS-SAVE-APPROVED-LEVEL  PIC X.
   464     12  WS-MAX-EXP-PMT          PIC S9(07)V99  VALUE +0.
   465     12  WS-ACTIVITY-CODE        PIC 99         VALUE ZEROS.
   466     12  WS-LETTER-SW            PIC X          VALUE 'N'.
   467     12  WS-ACT-REC-FOUND-SW     PIC X          VALUE 'N'.
   468     12  WS-BROWSE-SW            PIC X          VALUE 'N'.
   469     12  WS-APPROVAL-LEVEL       PIC X          VALUE ' '.
   470     12  WS-OPEN-CLOSE-SW        PIC X          VALUE ' '.
   471
   472     12  WS-AIG-WORK-AREAS.
   473         16  WS-RECALC-PAYFROM-SW  PIC X VALUE 'N'.
   474             88  WS-AIG-RECALC-PAYFROM   VALUE 'Y'.
   475         16  WS-AIG-PAYFROM-SW PIC X     VALUE 'N'.
   476             88  WS-USE-AIG-PAYFROM      VALUE 'Y'.
   477         16  WS-FROM-DATE-MDY.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page  10
* EL156.cbl
   478             20  WS-FROM-MO      PIC 99.
   479             20  WS-FROM-DA      PIC 99.
   480             20  WS-FROM-YR      PIC 99.
   481         16  WS-TEMP-DATE-MDY.
   482             20  WS-TEMP-MO      PIC 99.
   483             20  WS-TEMP-DA      PIC 99.
   484             20  WS-TEMP-YR      PIC 99.
   485         16  WS-BIN-FROM-DT      PIC XX.
   486         16  WS-TEMP-INC-MDY.
   487             20  WS-TEMP-INC-MO  PIC 99.
   488             20  WS-TEMP-INC-DA  PIC 99.
   489             20  WS-TEMP-INC-YR  PIC 99.
   490         16  WS-PMT-DUE-MDY.
   491             20  WS-PMT-DUE-MO   PIC 99.
   492             20  WS-PMT-DUE-DA   PIC 99.
   493             20  WS-PMT-DUE-YR   PIC 99.
   494         16  WS-PMT-DUE-DT       PIC XX.
   495         16  WS-NEXT-PMT-DUE-DT  PIC XX.
   496         16  WS-RETRO-ELIM-DT    PIC XX.
   497         16  WS-DUE-DAY-SW               PIC X       VALUE 'N'.
   498             88 WS-RESTORE-DUE-DAY                   VALUE 'Y'.
   499         16  WS-SAVE-DUE-DA      PIC 99.
   500         16  WS-CDAYS            PIC S9(05).
   501         16  WS-DAYS-OFF         PIC S9(05).
   502         16  WS-ELIMINATION-SW   PIC X     VALUE 'N'.
   503             88  ELIM-SATISFIED            VALUE 'Y'.
   504         16  WS-AIG-CHECKNO.
   505             20  WS-A-CHECKNO-1-2        PIC XX      VALUE SPACES.
   506             20  WS-A-CHECKNO-3-7.
   507                 24  FILLER              PIC X(3)    VALUE SPACES.
   508                 24  WS-A-CHECKNO-6-7    PIC XX      VALUE SPACES.
   509                     88  WS-AIG-CREDIT-ENTERED       VALUE 'CR'.
   510         16  WS-AIG-GROUPING.
   511             20  WS-A-BENE               PIC XXX.
   512             20  FILLER                  PIC XXX.
   513         16  WS-PAYMENT-TRAILER-SW       PIC X       VALUE ' '.
   514             88  WS-1ST-SPECIAL-PMT                  VALUE '1'.
   515             88  WS-2ND-SPECIAL-PMT                  VALUE '2'.
   516         16  WS-AIG-UNEMPLY-DESC         PIC X(60)
   517                 VALUE 'UNEMPLOYMENT PAYMENT'.
   518         16  WS-CHK-THRU-DT              PIC XX.
   519         16  WS-HOLD-BIN-DATE-1          PIC XX.
   520
   521 01  MISC-CSO-AREA.
   522     12  ELCRTT-LENGTH       PIC S9(04)    COMP     VALUE +552.
   523     12  ELCRTT-DSID         PIC X(8)    VALUE 'ELCRTT'.
   524     12  WS-NEED-APPROVAL                PIC X(1)   VALUE 'N'.
   525         88  APPROVAL-NEEDED                        VALUE 'Y'.
   526     12  WS-APPROV-NOTE                  PIC X(43)
   527         VALUE 'REFERRED FOR CLAIM PAYMENT APPROVAL REVIEW.'.
   528     12  WS-3550-APPROV-NOTE             PIC X(43)
   529         VALUE 'APPROVL NEEDED-DOES CLAIMANT HAVE COVERAGE?'.
   530     12  WS-REAUDIT-NOTE                 PIC X(43)
   531         VALUE 'REFERRED FOR RANDOM AUDIT APPROVAL REVIEW. '.
   532     12  WS-CALC-PMT-MONTHS      PIC S9(2)V9(8)  VALUE +0.
   533     12  WS-CALC-MO-AH-AMT       PIC S9(07)V99   VALUE +0.
   534     12  WS-SUB                  PIC S9(3) COMP-3 VALUE +0.
   535     12  WS-BEG-SUB              PIC S9(3) COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page  11
* EL156.cbl
   536     12  WS-END-SUB              PIC S9(3) COMP-3 VALUE +0.
   537     12  WS-STATE-LENGTH         PIC S9(3) COMP-3 VALUE +0.
   538     12  WS-PAYEE-STATE-FOUND    PIC X(01)        VALUE 'N'.
   539         88 PAYEE-STATE-FOUND                     VALUE 'Y'.
   540     12  WS-PAYEE-CITY-STATE     PIC X(30).
   541     12  FILLER  REDEFINES WS-PAYEE-CITY-STATE.
   542         16  WS-PAYEE-CITY-ST OCCURS 30 TIMES PIC X(1).
   543     12  WS-PD-DAYS              PIC S9(5) VALUE +0.
   544     12  WS-SUB2                 PIC S9(3) COMP-3 VALUE +0.
   545     12  WS-WORK-NAME            PIC X(30).
   546     12  FILLER  REDEFINES WS-WORK-NAME.
   547         16  WS-WORK-NAME-X OCCURS 30 TIMES PIC X(1).
   548     12  WS-INSURED-NAME         PIC X(30).
   549     12  FILLER  REDEFINES WS-INSURED-NAME.
   550         16  WS-INSURED-NAME-X OCCURS 30 TIMES PIC X(1).
   551     12  WS-PAYEE-NAME           PIC X(30).
   552     12  FILLER  REDEFINES WS-PAYEE-NAME.
   553         16  WS-PAYEE-NAME-X OCCURS 30 TIMES PIC X(1).
   554     12  WS-HOLD-UNTIL-SW        PIC X VALUE SPACES.
   555         88  HOLD-UNTIL-CHK            VALUE 'Y'.
   556         88  HOLD-UNTIL-PMT            VALUE 'P'.
   557     12  WS-HOLD-UNTIL-DT        PIC X(02) VALUE ZERO.
   558
   559 01  ERROR-MESSAGES.
   560     12  ER-0000                 PIC X(4)  VALUE '0000'.
   561     12  ER-0004                 PIC X(4)  VALUE '0004'.
   562     12  ER-0008                 PIC X(4)  VALUE '0008'.
   563     12  ER-0019                 PIC X(4)  VALUE '0019'.
   564     12  ER-0029                 PIC X(4)  VALUE '0029'.
   565     12  ER-0042                 PIC X(4)  VALUE '0042'.
   566     12  ER-0070                 PIC X(4)  VALUE '0070'.
   567     12  ER-0130                 PIC X(4)  VALUE '0130'.
   568     12  ER-0149                 PIC X(4)  VALUE '0149'.
   569     12  ER-0154                 PIC X(4)  VALUE '0154'.
   570     12  ER-0168                 PIC X(4)  VALUE '0168'.
   571     12  ER-0169                 PIC X(4)  VALUE '0169'.
   572     12  ER-0172                 PIC X(4)  VALUE '0174'.
   573     12  ER-0198                 PIC X(4)  VALUE '0198'.
   574     12  ER-0204                 PIC X(4)  VALUE '0204'.
   575     12  ER-0206                 PIC X(4)  VALUE '0206'.
   576     12  ER-0252                 PIC X(4)  VALUE '0252'.
   577     12  ER-0254                 PIC X(4)  VALUE '0254'.
   578     12  ER-0282                 PIC X(4)  VALUE '0282'.
   579     12  ER-0283                 PIC X(4)  VALUE '0283'.
   580     12  ER-0294                 PIC X(4)  VALUE '0294'.
   581     12  ER-0338                 PIC X(4)  VALUE '0338'.
   582     12  ER-0419                 PIC X(4)  VALUE '0419'.
   583     12  ER-0420                 PIC X(4)  VALUE '0420'.
   584     12  ER-0421                 PIC X(4)  VALUE '0421'.
   585     12  ER-0422                 PIC X(4)  VALUE '0422'.
   586     12  ER-0433                 PIC X(4)  VALUE '0433'.
   587     12  ER-0436                 PIC X(4)  VALUE '0436'.
   588     12  ER-0437                 PIC X(4)  VALUE '0437'.
   589     12  ER-0438                 PIC X(4)  VALUE '0438'.
   590     12  ER-0439                 PIC X(4)  VALUE '0439'.
   591     12  ER-0440                 PIC X(4)  VALUE '0440'.
   592     12  ER-0441                 PIC X(4)  VALUE '0441'.
   593     12  ER-0442                 PIC X(4)  VALUE '0442'.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page  12
* EL156.cbl
   594     12  ER-0443                 PIC X(4)  VALUE '0443'.
   595     12  ER-0444                 PIC X(4)  VALUE '0444'.
   596     12  ER-0445                 PIC X(4)  VALUE '0445'.
   597     12  ER-0446                 PIC X(4)  VALUE '0446'.
   598     12  ER-0447                 PIC X(4)  VALUE '0447'.
   599     12  ER-0448                 PIC X(4)  VALUE '0448'.
   600     12  ER-0449                 PIC X(4)  VALUE '0449'.
   601     12  ER-0452                 PIC X(4)  VALUE '0452'.
   602     12  ER-0458                 PIC X(4)  VALUE '0458'.
   603     12  ER-0459                 PIC X(4)  VALUE '0459'.
   604     12  ER-0460                 PIC X(4)  VALUE '0460'.
   605     12  ER-0461                 PIC X(4)  VALUE '0461'.
   606     12  ER-0462                 PIC X(4)  VALUE '0462'.
   607     12  ER-0463                 PIC X(4)  VALUE '0463'.
   608     12  ER-0464                 PIC X(4)  VALUE '0464'.
   609     12  ER-0465                 PIC X(4)  VALUE '0465'.
   610     12  ER-0466                 PIC X(4)  VALUE '0466'.
   611     12  ER-0467                 PIC X(4)  VALUE '0467'.
   612     12  ER-0468                 PIC X(4)  VALUE '0468'.
   613     12  ER-0469                 PIC X(4)  VALUE '0469'.
   614     12  ER-0473                 PIC X(4)  VALUE '0473'.
   615     12  ER-0474                 PIC X(4)  VALUE '0474'.
   616     12  ER-0475                 PIC X(4)  VALUE '0475'.
   617     12  ER-0476                 PIC X(4)  VALUE '0476'.
   618     12  ER-0477                 PIC X(4)  VALUE '0477'.
   619     12  ER-0478                 PIC X(4)  VALUE '0478'.
   620     12  ER-0479                 PIC X(4)  VALUE '0479'.
   621     12  ER-0481                 PIC X(4)  VALUE '0481'.
   622     12  ER-0491                 PIC X(4)  VALUE '0491'.
   623     12  ER-0492                 PIC X(4)  VALUE '0492'.
   624     12  ER-0493                 PIC X(4)  VALUE '0493'.
   625     12  ER-0494                 PIC X(4)  VALUE '0494'.
   626     12  ER-0495                 PIC X(4)  VALUE '0495'.
   627     12  ER-0499                 PIC X(4)  VALUE '0499'.
   628     12  ER-0500                 PIC X(4)  VALUE '0500'.
   629     12  ER-0501                 PIC X(4)  VALUE '0501'.
   630     12  ER-0502                 PIC X(4)  VALUE '0502'.
   631     12  ER-0508                 PIC X(4)  VALUE '0508'.
   632     12  ER-0513                 PIC X(4)  VALUE '0513'.
   633     12  ER-0518                 PIC X(4)  VALUE '0518'.
   634     12  ER-0524                 PIC X(4)  VALUE '0524'.
   635     12  ER-0525                 PIC X(4)  VALUE '0525'.
   636     12  ER-0526                 PIC X(4)  VALUE '0526'.
   637     12  ER-0530                 PIC X(4)  VALUE '0530'.
   638     12  ER-0540                 PIC X(4)  VALUE '0540'.
   639     12  ER-0541                 PIC X(4)  VALUE '0541'.
   640     12  ER-0542                 PIC X(4)  VALUE '0542'.
   641     12  ER-0543                 PIC X(4)  VALUE '0543'.
   642     12  ER-0545                 PIC X(4)  VALUE '0545'.
   643     12  ER-0552                 PIC X(4)  VALUE '0552'.
   644     12  ER-0555                 PIC X(4)  VALUE '0555'.
   645     12  ER-0556                 PIC X(4)  VALUE '0556'.
   646     12  ER-0557                 PIC X(4)  VALUE '0557'.
   647     12  ER-0572                 PIC X(4)  VALUE '0572'.
   648     12  ER-0573                 PIC X(4)  VALUE '0573'.
   649     12  ER-0594                 PIC X(4)  VALUE '0594'.
   650     12  ER-0616                 PIC X(4)  VALUE '0616'.
   651     12  ER-0617                 PIC X(4)  VALUE '0617'.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page  13
* EL156.cbl
   652     12  ER-0618                 PIC X(4)  VALUE '0618'.
   653     12  ER-0657                 PIC X(4)  VALUE '0657'.
   654     12  ER-0658                 PIC X(4)  VALUE '0658'.
   655     12  ER-0699                 PIC X(4)  VALUE '0699'.
   656     12  ER-0730                 PIC X(4)  VALUE '0730'.
   657     12  ER-0737                 PIC X(4)  VALUE '0737'.
   658     12  ER-0760                 PIC X(4)  VALUE '0760'.
   659     12  ER-0768                 PIC X(4)  VALUE '0768'.
   660     12  ER-0769                 PIC X(4)  VALUE '0769'.
   661     12  ER-0770                 PIC X(4)  VALUE '0770'.
   662     12  ER-0802                 PIC X(4)  VALUE '0802'.
   663     12  ER-0803                 PIC X(4)  VALUE '0803'.
   664     12  ER-0819                 PIC X(4)  VALUE '0819'.
   665     12  ER-0834                 PIC X(4)  VALUE '0834'.
   666     12  ER-0836                 PIC X(4)  VALUE '0836'.
   667     12  ER-0844                 PIC X(4)  VALUE '0844'.
   668     12  ER-0845                 PIC X(4)  VALUE '0845'.
   669     12  ER-0846                 PIC X(4)  VALUE '0846'.
   670     12  ER-0849                 PIC X(4)  VALUE '0849'.
   671     12  ER-0851                 PIC X(4)  VALUE '0851'.
   672     12  ER-0872                 PIC X(4)  VALUE '0872'.
   673     12  ER-0873                 PIC X(4)  VALUE '0873'.
   674     12  ER-0874                 PIC X(4)  VALUE '0874'.
   675     12  ER-0879                 PIC X(4)  VALUE '0879'.
   676     12  ER-0919                 PIC X(4)  VALUE '0919'.
   677     12  ER-0921                 PIC X(4)  VALUE '0921'.
   678     12  ER-0923                 PIC X(4)  VALUE '0923'.
   679     12  ER-0925                 PIC X(4)  VALUE '0925'.
   680     12  ER-0944                 PIC X(4)  VALUE '0944'.
   681     12  ER-0945                 PIC X(4)  VALUE '0945'.
   682     12  ER-0946                 PIC X(4)  VALUE '0946'.
   683     12  ER-0947                 PIC X(4)  VALUE '0947'.
   684     12  ER-0948                 PIC X(4)  VALUE '0948'.
   685     12  ER-0949                 PIC X(4)  VALUE '0949'.
   686     12  ER-0950                 PIC X(4)  VALUE '0950'.
   687     12  ER-0951                 PIC X(4)  VALUE '0951'.
   688     12  ER-0954                 PIC X(4)  VALUE '0954'.
   689     12  ER-0956                 PIC X(4)  VALUE '0956'.
   690     12  ER-0967                 PIC X(4)  VALUE '0967'.
   691     12  ER-0968                 PIC X(4)  VALUE '0968'.
   692     12  ER-0974                 PIC X(4)  VALUE '0974'.
   693     12  ER-0975                 PIC X(4)  VALUE '0975'.
   694     12  ER-1561                 PIC X(4)  VALUE '1561'.
   695     12  ER-1566                 PIC X(4)  VALUE '1566'.
   696     12  ER-1567                 PIC X(4)  VALUE '1567'.
   697     12  ER-1569                 PIC X(4)  VALUE '1569'.
   698     12  er-1582                 pic x(4)  value '1582'.
   699     12  er-1657                 pic x(4)  value '1657'.
   700     12  er-1658                 pic x(4)  value '1658'.
   701     12  er-1667                 pic x(4)  value '1667'.
   702     12  er-1670                 pic x(4)  value '1670'.
   703     12  er-1671                 pic x(4)  value '1671'.
   704     12  er-1672                 pic x(4)  value '1672'.
   705     12  er-1673                 pic x(4)  value '1673'.
   706     12  er-1674                 pic x(4)  value '1674'.
   707     12  er-1677                 pic x(4)  value '1677'.
   708     12  ER-1775                 PIC X(4)  VALUE '1775'.
   709     12  ER-1880                 PIC X(4)  VALUE '1880'.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page  14
* EL156.cbl
   710     12  ER-2044                 PIC X(4)  VALUE '2044'.
   711     12  ER-3140                 PIC X(4)  VALUE '3140'.
   712     12  ER-3141                 PIC X(4)  VALUE '3141'.
   713     12  ER-3255                 PIC X(4)  VALUE '3255'.
   714     12  ER-3272                 PIC X(4)  VALUE '3272'.
   715     12  ER-3516                 PIC X(4)  VALUE '3516'.
   716     12  ER-3527                 PIC X(4)  VALUE '3527'.
   717     12  ER-3528                 PIC X(4)  VALUE '3528'.
   718     12  ER-3529                 PIC X(4)  VALUE '3529'.
   719     12  ER-3530                 PIC X(4)  VALUE '3530'.
   720     12  ER-3531                 PIC X(4)  VALUE '3531'.
   721     12  ER-3532                 PIC X(4)  VALUE '3532'.
   722     12  ER-3533                 PIC X(4)  VALUE '3533'.
   723     12  ER-3534                 PIC X(4)  VALUE '3534'.
   724     12  ER-3535                 PIC X(4)  VALUE '3535'.
   725     12  ER-3536                 PIC X(4)  VALUE '3536'.
   726     12  ER-3537                 PIC X(4)  VALUE '3537'.
   727     12  ER-3538                 PIC X(4)  VALUE '3538'.
   728     12  ER-3539                 PIC X(4)  VALUE '3539'.
   729     12  ER-3540                 PIC X(4)  VALUE '3540'.
   730     12  ER-3541                 PIC X(4)  VALUE '3541'.
   731     12  ER-3542                 PIC X(4)  VALUE '3542'.
   732     12  ER-3543                 PIC X(4)  VALUE '3543'.
   733     12  ER-3546                 PIC X(4)  VALUE '3546'.
   734     12  ER-3549                 PIC X(4)  VALUE '3549'.
   735     12  ER-3818                 PIC X(4)  VALUE '3818'.
   736     12  ER-7540                 PIC X(4)  VALUE '7540'.
   737     12  ER-7576                 PIC X(4)  VALUE '7576'.
   738     12  ER-7579                 PIC X(4)  VALUE '7579'.
   739     12  ER-7580                 PIC X(4)  VALUE '7580'.
   740     12  ER-7583                 PIC X(4)  VALUE '7583'.
   741     12  ER-7830                 PIC X(4)  VALUE '7830'.
   742     12  ER-7831                 PIC X(4)  VALUE '7831'.
   743     12  ER-7832                 PIC X(4)  VALUE '7832'.
   744     12  ER-7833                 PIC X(4)  VALUE '7833'.
   745     12  ER-7834                 PIC X(4)  VALUE '7834'.
   746     12  ER-7835                 PIC X(4)  VALUE '7835'.
   747     12  ER-7836                 PIC X(4)  VALUE '7836'.
   748     12  ER-7837                 PIC X(4)  VALUE '7837'.
   749     12  ER-7838                 PIC X(4)  VALUE '7838'.
   750     12  ER-7841                 PIC X(4)  VALUE '7841'.
   751     12  ER-7844                 PIC X(4)  VALUE '7844'.
   752     12  ER-7845                 PIC X(4)  VALUE '7845'.
   753     12  ER-8000                 PIC X(4)  VALUE '8000'.
   754     12  ER-8051                 PIC X(4)  VALUE '8051'.
   755     12  ER-8052                 PIC X(4)  VALUE '8052'.
   756     12  ER-8053                 PIC X(4)  VALUE '8053'.
   757     12  ER-8054                 PIC X(4)  VALUE '8054'.
   758     12  ER-8055                 PIC X(4)  VALUE '8055'.
   759     12  ER-8056                 PIC X(4)  VALUE '8056'.
   760     12  ER-8057                 PIC X(4)  VALUE '8057'.
   761     12  ER-8058                 PIC X(4)  VALUE '8058'.
   762     12  ER-8059                 PIC X(4)  VALUE '8059'.
   763     12  ER-8060                 PIC X(4)  VALUE '8060'.
   764     12  ER-8061                 PIC X(4)  VALUE '8061'.
   765     12  ER-8062                 PIC X(4)  VALUE '8062'.
   766     12  ER-8063                 PIC X(4)  VALUE '8063'.
   767     12  ER-8064                 PIC X(4)  VALUE '8064'.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page  15
* EL156.cbl
   768     12  ER-8065                 PIC X(4)  VALUE '8065'.
   769     12  ER-8066                 PIC X(4)  VALUE '8066'.
   770     12  ER-8146                 PIC X(4)  VALUE '8146'.
   771     12  ER-8147                 PIC X(4)  VALUE '8147'.
   772     12  ER-8152                 PIC X(4)  VALUE '8152'.
   773     12  ER-8153                 PIC X(4)  VALUE '8153'.
   774     12  ER-8154                 PIC X(4)  VALUE '8154'.
   775     12  ER-8155                 PIC X(4)  VALUE '8155'.
   776     12  ER-8310                 PIC X(4)  VALUE '8310'.
   777     12  ER-8311                 PIC X(4)  VALUE '8311'.
   778     12  ER-8312                 PIC X(4)  VALUE '8312'.
   779     12  ER-8313                 PIC X(4)  VALUE '8313'.
   780     12  ER-8314                 PIC X(4)  VALUE '8314'.
   781     12  ER-8315                 PIC X(4)  VALUE '8315'.
   782     12  ER-8316                 PIC X(4)  VALUE '8316'.
   783     12  ER-8317                 PIC X(4)  VALUE '8317'.
   784
   785 01  CSO-WORK-FIELDS.
   786     05  ERROR-ON-OUTPUT-SW  PIC X     VALUE 'N'.
   787       88  ERROR-ON-OUTPUT             VALUE 'Y'.
   788
   789     05  WRK-6MO                 PIC S9(7)V99 VALUE +0.
   790     05  WRK-CERT-NOTE-ADD       PIC X VALUE SPACES.
   791         88  CERT-NOTE-ADDED           VALUE 'Y'.
   792     05  WRK-ORIG-NOTE-ADD       PIC X VALUE SPACES.
   793         88  ORIG-NOTE-ADDED           VALUE 'Y'.
   794     05  WRK-NOTE-SEQ            PIC S9(4) COMP  VALUE +0.
   795
   796     05  WRK-NEXT-AUDIT-CHK-NO   PIC S9(8) COMP  VALUE +0.
   797
   798 01  SC-NP6-CERT-NOTE.
   799     12  FILLER                  PIC X(12)
   800               VALUE 'REM BENEFIT '.
   801     12  SC-NP6-REM-BEN          PIC ZZZ,ZZZ.99.
   802     12  SC-NP6-COMM             PIC X(8)
   803               VALUE ' + 6 MO '.
   804     12  SC-NP6-6-MO             PIC ZZZ,ZZZ.99.
   805     12  FILLER                  PIC X(12)
   806               VALUE ' = AMT PAID '.
   807     12  SC-NP6-AMT-PAID         PIC ZZZ,ZZZ.99.
   808
   809 01  SC-NP6-ORIG-NOTE.
   810     12  FILLER                  PIC X(63)  VALUE
   811         'BENEFITS PAID CANNOT EXCEED ORIGINAL LIFE BENEFIT'.
   812 01  WS-PDEF-RECORD-SW           PIC X  VALUE ' '.
   813     88  PDEF-FOUND                   VALUE 'Y'.
   814 01  WS-ACCT-RECORD-SW           PIC X  VALUE ' '.
   815     88  ACCT-FOUND                   VALUE 'Y'.
   816 01  CTBL-KEY-SAVE               PIC X(5).
   817 01  CTBL-KEY.
   818     05  CTBL-COMPANY-CD         PIC X.
   819     05  CTBL-TABLE              PIC XXX.
   820     05  CTBL-BEN-TYPE           PIC X.
   821     05  CTBL-BEN-CODE           PIC XX.
   822 01  ERPDEF-KEY-SAVE             PIC X(18).
   823 01  ERPDEF-KEY.
   824     12  ERPDEF-COMPANY-CD       PIC X.
   825     12  ERPDEF-STATE            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page  16
* EL156.cbl
   826     12  ERPDEF-PROD-CD          PIC XXX.
   827     12  F                       PIC X(7).
   828     12  ERPDEF-BEN-TYPE         PIC X.
   829     12  ERPDEF-BEN-CODE         PIC XX.
   830     12  ERPDEF-EXP-DT           PIC XX.
   831 01  ELCRTT-KEY.
   832     05  CTRLR-COMP-CD       PIC X.
   833     05  CTRLR-CARRIER       PIC X.
   834     05  CTRLR-GROUPING      PIC X(6).
   835     05  CTRLR-STATE         PIC X(2).
   836     05  CTRLR-ACCOUNT       PIC X(10).
   837     05  CTRLR-EFF-DT        PIC XX.
   838     05  CTRLR-CERT-NO       PIC X(11).
   839     05  CTRLR-REC-TYPE      PIC X.
   840 01  ACCESS-KEYS.
   841     12  ELARCH-KEY.
   842         16  ARCH-CO             PIC X.
   843         16  ARCH-NUMBER         PIC S9(08) COMP.
   844         16  ARCH-REC-TYPE       PIC X.
   845         16  ARCH-SEQ            PIC S9(04) COMP.
   846     12  ELMSTR-KEY.
   847         16  MSTR-COMP-CD        PIC X.
   848         16  MSTR-CARRIER        PIC X.
   849         16  MSTR-CLAIM-NO       PIC X(7).
   850         16  MSTR-CERT-NO        PIC X(11).
   851     12  ELCNTL-KEY.
   852         16  CNTL-COMP-ID        PIC X(3).
   853         16  CNTL-REC-TYPE       PIC X.
   854         16  CNTL-ACCESS         PIC X(4).
   855         16  CNTL-SEQ-NO         PIC S9(4)    COMP.
   856     12  ELCERT-KEY.
   857         16  CERT-COMP-CD        PIC X.
   858         16  CERT-CARRIER        PIC X.
   859         16  CERT-GROUPING       PIC X(6).
   860         16  CERT-STATE          PIC XX.
   861         16  CERT-ACCOUNT        PIC X(10).
   862         16  CERT-EFF-DT         PIC XX.
   863         16  CERT-CERT-NO        PIC X(11).
   864     12  ELTRLR-KEY.
   865         16  TRLR-COMP-CD        PIC X.
   866         16  TRLR-CARRIER        PIC X.
   867         16  TRLR-CLAIM-NO       PIC X(7).
   868         16  TRLR-CERT-NO        PIC X(11).
   869         16  TRLR-SEQ-NO         PIC S9(4)   COMP.
   870     12  ELACTQ-KEY.
   871         16  ACTQ-COMP-CD        PIC X.
   872         16  ACTQ-CARRIER        PIC X.
   873         16  ACTQ-CLAIM-NO       PIC X(7).
   874         16  ACTQ-CERT-NO        PIC X(11).
   875     12  W-NOTE-KEY.
   876         16  W-NOTE-COMP-CD      PIC X.
   877         16  W-NOTE-CERT-KEY.
   878             20  W-NOTE-CARRIER  PIC X.
   879             20  W-NOTE-GROUPING PIC X(6).
   880             20  W-NOTE-STATE    PIC XX.
   881             20  W-NOTE-ACCOUNT  PIC X(10).
   882             20  W-NOTE-EFF-DT   PIC XX.
   883             20  W-NOTE-CERT-NO  PIC X(11).
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page  17
* EL156.cbl
   884     12  WS-ERACCT-SAVE-KEY      PIC X(20).
   885     12  WS-ERACCT-HOLD-RECORD   PIC X(2000).
   886     12  ERACCT-KEY.
   887         16  ERACCT-PARTIAL-KEY.
   888             20  ACCT-COMP-CD    PIC X.
   889             20  ACCT-CARRIER    PIC X.
   890             20  ACCT-GROUPING   PIC X(6).
   891             20  ACCT-STATE      PIC XX.
   892             20  ACCT-ACCOUNT    PIC X(10).
   893         16  ACCT-EXP-DT         PIC XX.
   894         16  FILLER              PIC X(4) VALUE SPACES.
   895     12  ELCHKQ-KEY.
   896         16  CHKQ-COMP-CD        PIC X.
   897         16  CHKQ-CONTROL        PIC S9(8) COMP.
   898         16  CHKQ-SEQ-NO         PIC S9(4) COMP.
   899     12  ELBENE-KEY.
   900         16  BENE-COMP-CD         PIC X.
   901         16  BENE-RECORD-TYPE     PIC X.
   902         16  BENE-NUMBER          PIC X(10).
   903     12  ERCOMP-KEY.
   904         16  COMP-COMP-CD        PIC X.
   905         16  COMP-CARRIER        PIC X.
   906         16  COMP-GROUP          PIC X(06).
   907         16  COMP-FIN-RESP       PIC X(10).
   908         16  COMP-ACCOUNT        PIC X(10).
   909         16  COMP-TYPE           PIC X.
   910
   911     12  DLO035-KEY.
   912         16  DL35-PROCESS-TYPE   PIC X.
   913         16  DL35-CREDIT-CARD    PIC X(20).
   914         16  DL35-BEN-TYPE       PIC XX.
   915         16  DL35-PAYMENT-AMT    PIC 9(7)V99.
   916         16  DL35-RETURN-CODE    PIC XX.
   917
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page  18
* EL156.cbl
   919*    COPY ELCDATE.
   920******************************************************************
   921*                                                                *
   922*                                                                *
   923*                            ELCDATE.                            *
   924*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   925*                            VMOD=2.003
   926*                                                                *
   927*                                                                *
   928*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   929*                 LENGTH = 200                                   *
   930******************************************************************
   931
   932 01  DATE-CONVERSION-DATA.
   933     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   934     12  DC-OPTION-CODE                PIC X.
   935         88  BIN-TO-GREG                VALUE ' '.
   936         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   937         88  EDIT-GREG-TO-BIN           VALUE '2'.
   938         88  YMD-GREG-TO-BIN            VALUE '3'.
   939         88  MDY-GREG-TO-BIN            VALUE '4'.
   940         88  JULIAN-TO-BIN              VALUE '5'.
   941         88  BIN-PLUS-ELAPSED           VALUE '6'.
   942         88  FIND-CENTURY               VALUE '7'.
   943         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   944         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   945         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   946         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   947         88  JULIAN-TO-BIN-3            VALUE 'C'.
   948         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   949         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   950         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   951         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   952         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   953         88  CHECK-LEAP-YEAR            VALUE 'H'.
   954         88  BIN-3-TO-GREG              VALUE 'I'.
   955         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   956         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   957         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   958         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   959         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   960         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   961         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   962         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   963         88  THREE-CHARACTER-BIN
   964                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   965         88  GREGORIAN-TO-BIN
   966                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   967         88  BIN-TO-GREGORIAN
   968                  VALUES ' ' '1' 'I' '8' 'G'.
   969         88  JULIAN-TO-BINARY
   970                  VALUES '5' 'C' 'E' 'F'.
   971     12  DC-ERROR-CODE                 PIC X.
   972         88  NO-CONVERSION-ERROR        VALUE ' '.
   973         88  DATE-CONVERSION-ERROR
   974                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   975         88  DATE-IS-ZERO               VALUE '1'.
   976         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page  19
* EL156.cbl
   977         88  DATE-IS-INVALID            VALUE '3'.
   978         88  DATE1-GREATER-DATE2        VALUE '4'.
   979         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   980         88  DATE-INVALID-OPTION        VALUE '9'.
   981         88  INVALID-CENTURY            VALUE 'A'.
   982         88  ONLY-CENTURY               VALUE 'B'.
   983         88  ONLY-LEAP-YEAR             VALUE 'C'.
   984         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   985     12  DC-END-OF-MONTH               PIC X.
   986         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   987     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   988         88  USE-NORMAL-PROCESS         VALUE ' '.
   989         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   990         88  ADJUST-UP-100-YRS          VALUE '2'.
   991     12  FILLER                        PIC X.
   992     12  DC-CONVERSION-DATES.
   993         16  DC-BIN-DATE-1             PIC XX.
   994         16  DC-BIN-DATE-2             PIC XX.
   995         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   996         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   997                       DC-GREG-DATE-1-EDIT.
   998             20  DC-EDIT1-MONTH        PIC 99.
   999             20  SLASH1-1              PIC X.
  1000             20  DC-EDIT1-DAY          PIC 99.
  1001             20  SLASH1-2              PIC X.
  1002             20  DC-EDIT1-YEAR         PIC 99.
  1003         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  1004         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  1005                     DC-GREG-DATE-2-EDIT.
  1006             20  DC-EDIT2-MONTH        PIC 99.
  1007             20  SLASH2-1              PIC X.
  1008             20  DC-EDIT2-DAY          PIC 99.
  1009             20  SLASH2-2              PIC X.
  1010             20  DC-EDIT2-YEAR         PIC 99.
  1011         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  1012         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  1013                     DC-GREG-DATE-1-YMD.
  1014             20  DC-YMD-YEAR           PIC 99.
  1015             20  DC-YMD-MONTH          PIC 99.
  1016             20  DC-YMD-DAY            PIC 99.
  1017         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  1018         16  DC-GREG-DATE-1-MDY-R REDEFINES
  1019                      DC-GREG-DATE-1-MDY.
  1020             20  DC-MDY-MONTH          PIC 99.
  1021             20  DC-MDY-DAY            PIC 99.
  1022             20  DC-MDY-YEAR           PIC 99.
  1023         16  DC-GREG-DATE-1-ALPHA.
  1024             20  DC-ALPHA-MONTH        PIC X(10).
  1025             20  DC-ALPHA-DAY          PIC 99.
  1026             20  FILLER                PIC XX.
  1027             20  DC-ALPHA-CENTURY.
  1028                 24 DC-ALPHA-CEN-N     PIC 99.
  1029             20  DC-ALPHA-YEAR         PIC 99.
  1030         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  1031         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  1032         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  1033         16  DC-JULIAN-DATE            PIC 9(05).
  1034         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page  20
* EL156.cbl
  1035                                       PIC 9(05).
  1036         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  1037             20  DC-JULIAN-YEAR        PIC 99.
  1038             20  DC-JULIAN-DAYS        PIC 999.
  1039         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  1040         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  1041         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  1042     12  DATE-CONVERSION-VARIBLES.
  1043         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  1044         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  1045             20  FILLER                PIC 9(3).
  1046             20  HOLD-CEN-1-CCYY.
  1047                 24  HOLD-CEN-1-CC     PIC 99.
  1048                 24  HOLD-CEN-1-YY     PIC 99.
  1049             20  HOLD-CEN-1-MO         PIC 99.
  1050             20  HOLD-CEN-1-DA         PIC 99.
  1051         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  1052             20  HOLD-CEN-1-R-MO       PIC 99.
  1053             20  HOLD-CEN-1-R-DA       PIC 99.
  1054             20  HOLD-CEN-1-R-CCYY.
  1055                 24  HOLD-CEN-1-R-CC   PIC 99.
  1056                 24  HOLD-CEN-1-R-YY   PIC 99.
  1057             20  FILLER                PIC 9(3).
  1058         16  HOLD-CENTURY-1-X.
  1059             20  FILLER                PIC X(3)  VALUE SPACES.
  1060             20  HOLD-CEN-1-X-CCYY.
  1061                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  1062                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  1063             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  1064             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  1065         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  1066             20  HOLD-CEN-1-R-X-MO     PIC XX.
  1067             20  HOLD-CEN-1-R-X-DA     PIC XX.
  1068             20  HOLD-CEN-1-R-X-CCYY.
  1069                 24  HOLD-CEN-1-R-X-CC PIC XX.
  1070                 24  HOLD-CEN-1-R-X-YY PIC XX.
  1071             20  FILLER                PIC XXX.
  1072         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  1073         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  1074         16  DC-JULIAN-DATE-1          PIC 9(07).
  1075         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  1076             20  DC-JULIAN-1-CCYY.
  1077                 24  DC-JULIAN-1-CC    PIC 99.
  1078                 24  DC-JULIAN-1-YR    PIC 99.
  1079             20  DC-JULIAN-DA-1        PIC 999.
  1080         16  DC-JULIAN-DATE-2          PIC 9(07).
  1081         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  1082             20  DC-JULIAN-2-CCYY.
  1083                 24  DC-JULIAN-2-CC    PIC 99.
  1084                 24  DC-JULIAN-2-YR    PIC 99.
  1085             20  DC-JULIAN-DA-2        PIC 999.
  1086         16  DC-GREG-DATE-A-EDIT.
  1087             20  DC-EDITA-MONTH        PIC 99.
  1088             20  SLASHA-1              PIC X VALUE '/'.
  1089             20  DC-EDITA-DAY          PIC 99.
  1090             20  SLASHA-2              PIC X VALUE '/'.
  1091             20  DC-EDITA-CCYY.
  1092                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page  21
* EL156.cbl
  1093                 24  DC-EDITA-YEAR     PIC 99.
  1094         16  DC-GREG-DATE-B-EDIT.
  1095             20  DC-EDITB-MONTH        PIC 99.
  1096             20  SLASHB-1              PIC X VALUE '/'.
  1097             20  DC-EDITB-DAY          PIC 99.
  1098             20  SLASHB-2              PIC X VALUE '/'.
  1099             20  DC-EDITB-CCYY.
  1100                 24  DC-EDITB-CENT     PIC 99.
  1101                 24  DC-EDITB-YEAR     PIC 99.
  1102         16  DC-GREG-DATE-CYMD         PIC 9(08).
  1103         16  DC-GREG-DATE-CYMD-R REDEFINES
  1104                              DC-GREG-DATE-CYMD.
  1105             20  DC-CYMD-CEN           PIC 99.
  1106             20  DC-CYMD-YEAR          PIC 99.
  1107             20  DC-CYMD-MONTH         PIC 99.
  1108             20  DC-CYMD-DAY           PIC 99.
  1109         16  DC-GREG-DATE-MDCY         PIC 9(08).
  1110         16  DC-GREG-DATE-MDCY-R REDEFINES
  1111                              DC-GREG-DATE-MDCY.
  1112             20  DC-MDCY-MONTH         PIC 99.
  1113             20  DC-MDCY-DAY           PIC 99.
  1114             20  DC-MDCY-CEN           PIC 99.
  1115             20  DC-MDCY-YEAR          PIC 99.
  1116    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  1117        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  1118    12  DC-EL310-DATE                  PIC X(21).
  1119    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page  22
* EL156.cbl
  1121*    COPY ELCLOGOF.
  1122******************************************************************
  1123*                                                                *
  1124*                                                                *
  1125*                            ELCLOGOF.                           *
  1126*                            VMOD=2.001                          *
  1127*                                                                *
  1128*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  1129*                                                                *
  1130******************************************************************
  1131 01  CLASIC-LOGOFF.
  1132     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  1133     12  LOGOFF-TEXT.
  1134         16  FILLER          PIC X(5)    VALUE SPACES.
  1135         16  LOGOFF-MSG.
  1136             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  1137             20  FILLER      PIC X       VALUE SPACES.
  1138             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  1139         16  FILLER          PIC X(80)
  1140           VALUE '* YOU ARE NOW LOGGED OFF'.
  1141         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  1142         16  FILLER          PIC X       VALUE QUOTE.
  1143         16  LOGOFF-SYS-MSG  PIC X(17)
  1144           VALUE 'S CLAS-IC SYSTEM '.
  1145     12  TEXT-MESSAGES.
  1146         16  UNACCESS-MSG    PIC X(29)
  1147             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  1148         16  PGMIDERR-MSG    PIC X(17)
  1149             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page  23
* EL156.cbl
  1151*    COPY ELCCALC.
  1152******************************************************************
  1153*                                                                *
  1154*                           ELCCALC.                            *
  1155*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1156*                            VMOD=2.025                          *
  1157*                                                                *
  1158*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  1159*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  1160*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  1161*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  1162*                                                                *
  1163*  PASSED TO ELRTRM                                              *
  1164*  -----------------                                             *
  1165*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  1166*  ORIGINAL TERM                                                 *
  1167*  BEGINNING DATE                                                *
  1168*  ENDING DATE                                                   *
  1169*  COMPANY I.D.                                                  *
  1170*  ACCOUNT MASTER USER FIELD                                     *
  1171*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  1172*  FREE LOOK DAYS                                                *
  1173*                                                                *
  1174*  RETURNED FROM ELRTRM                                          *
  1175*  ---------------------                                         *
  1176*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  1177*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  1178*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  1179*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  1180*----------------------------------------------------------------*
  1181*  PASSED TO ELRAMT                                              *
  1182*  ----------------                                              *
  1183*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  1184*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1185*  ORIGINAL AMOUNT                                               *
  1186*  ALTERNATE BENEFIT (BALLON)                                    *
  1187*  A.P.R. - NET PAY ONLY                                         *
  1188*  METHOD
  1189*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  1190*  COMPANY I.D.                                                  *
  1191*  BENEFIT TYPE                                                  *
  1192*                                                                *
  1193*  RETURNED FROM ELRAMT                                          *
  1194*  --------------------                                          *
  1195*  REMAINING AMOUNT 1 - CURRENT                                  *
  1196*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  1197*  REMAINING AMOUNT FACTOR
  1198*----------------------------------------------------------------*
  1199*  PASSED TO ELRESV                                              *
  1200*  -----------------                                             *
  1201*  CERTIFICATE EFFECTIVE DATE                                    *
  1202*  VALUATION DATE                                                *
  1203*  PAID THRU DATE                                                *
  1204*  BENEFIT                                                       *
  1205*  INCURRED DATE                                                 *
  1206*  REPORTED DATE                                                 *
  1207*  ISSUE AGE                                                     *
  1208*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page  24
* EL156.cbl
  1209*  CDT PERCENT                                                   *
  1210*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  1211* *CLAIM TYPE (LIFE, A/H)                                        *
  1212* *REMAINING BENEFIT (FROM ELRAMT)                               *
  1213* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  1214*                                                                *
  1215*  RETURNED FROM ELRESV                                          *
  1216*  --------------------                                          *
  1217*  CDT TABLE USED                                                *
  1218*  CDT FACTOR USED                                               *
  1219*  PAY TO CURRENT RESERVE                                        *
  1220*  I.B.N.R. - A/H ONLY                                           *
  1221*  FUTURE (ACCRUED) AH ONLY                                      *
  1222*----------------------------------------------------------------*
  1223*  PASSED TO ELRATE                                              *
  1224*  ----------------                                              *
  1225*  CERT ISSUE DATE                                               *
  1226*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1227*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  1228*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  1229*  STATE CODE (CLIENT DEFINED)                                   *
  1230*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1231*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1232*  DEVIATION CODE                                                *
  1233*  ISSUE AGE                                                     *
  1234*  ORIGINAL BENEFIT AMOUNT                                       *
  1235*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  1236*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  1237*  BENEFIT KIND (LIFE OR A/H)                                    *
  1238*  A.P.R.                                                        *
  1239*  METHOD
  1240*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1241*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1242*  COMPANY I.D. (3 CHARACTER)                                    *
  1243*  BENEFIT CODE                                                  *
  1244*  BENEFIT OVERRIDE CODE                                         *
  1245*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  1246*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  1247*  JOINT INDICATOR (CSL ONLY)                                    *
  1248*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  1249*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  1250*                                                                *
  1251*  RETURNED FROM ELRATE                                          *
  1252*  --------------------                                          *
  1253*  CALCULATED PREMIUM                                            *
  1254*  PREMIUM RATE                                                  *
  1255*  MORTALITY CODE                                                *
  1256*  MAX ATTAINED AGE                                              *
  1257*  MAX AGE                                                       *
  1258*  MAX TERM                                                      *
  1259*  MAX MONTHLY BENEFIT                                           *
  1260*  MAX TOTAL BENIFIT                                             *
  1261*  COMPOSITE RATE (OPEN-END ONLY)                                *
  1262*----------------------------------------------------------------*
  1263*  PASSED TO ELRFND                                              *
  1264*  ----------------                                              *
  1265*  CERT ISSUE DATE                                               *
  1266*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page  25
* EL156.cbl
  1267*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  1268*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1269*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  1270*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  1271*  STATE CODE (CLIENT DEFINED)                                   *
  1272*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1273*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1274*  DEVIATION CODE                                                *
  1275*  ISSUE AGE                                                     *
  1276*  ORIGINAL BENEFIT AMOUNT                                       *
  1277*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  1278*  PROCESS TYPE (CANCEL)                                         *
  1279*  BENEFIT KIND (LIFE OR A/H)                                    *
  1280*  A.P.R.                                                        *
  1281*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  1282*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  1283*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1284*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1285*  COMPANY I.D. (3 CHARACTER)                                    *
  1286*  BENEFIT CODE                                                  *
  1287*  BENEFIT OVERRIDE CODE                                         *
  1288*                                                                *
  1289*  RETURNED FROM ELRFND                                          *
  1290*  --------------------                                          *
  1291*  CALCULATED REFUND                                             *
  1292*----------------------------------------------------------------*
  1293*  PASSED TO ELEARN                                              *
  1294*  ----------------                                              *
  1295*  CERT ISSUE DATE                                               *
  1296*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1297*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  1298*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  1299*  STATE CODE (CLIENT DEFINED)                                   *
  1300*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1301*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1302*  DEVIATION CODE                                                *
  1303*  ISSUE AGE                                                     *
  1304*  ORIGINAL BENEFIT AMOUNT                                       *
  1305*  BENEFIT KIND (LIFE OR A/H)                                    *
  1306*  A.P.R.                                                        *
  1307*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  1308*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1309*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1310*  COMPANY I.D. (3 CHARACTER)                                    *
  1311*  BENEFIT CODE                                                  *
  1312*  BENEFIT OVERRIDE CODE                                         *
  1313*                                                                *
  1314*  RETURNED FROM ELEARN                                          *
  1315*  --------------------                                          *
  1316*  INDICATED  EARNINGS                                           *
  1317*----------------------------------------------------------------*
  1318*                 LENGTH = 450                                   *
  1319*                                                                *
  1320******************************************************************
  1321******************************************************************
  1322*                   C H A N G E   L O G
  1323*
  1324* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page  26
* EL156.cbl
  1325*-----------------------------------------------------------------
  1326*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1327* EFFECTIVE    NUMBER
  1328*-----------------------------------------------------------------
  1329* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  1330* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  1331* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  1332* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  1333* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  1334* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  1335* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  1336* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  1337* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1338* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
  1339* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  1340******************************************************************
  1341
  1342 01  CALCULATION-PASS-AREA.
  1343     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  1344                                     COMP.
  1345
  1346     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  1347       88  NO-CP-ERROR                             VALUE ZERO.
  1348       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  1349                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  1350       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  1351       88  CP-ERROR-IN-DATES                       VALUE '2'.
  1352       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  1353       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  1354       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  1355       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  1356       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  1357       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  1358       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  1359       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  1360       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  1361       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  1362       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  1363       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  1364       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  1365       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  1366       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  1367
  1368     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  1369       88  NO-CP-ERROR-2                           VALUE ZERO.
  1370***********************  INPUT AREAS ****************************
  1371
  1372     12  CP-CALCULATION-AREA.
  1373         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  1374         16  CP-CERT-EFF-DT        PIC XX.
  1375         16  CP-VALUATION-DT       PIC XX.
  1376         16  CP-PAID-THRU-DT       PIC XX.
  1377         16  CP-BENEFIT-TYPE       PIC X.
  1378           88  CP-AH                               VALUE 'A' 'D'
  1379                                                   'I' 'U'.
  1380           88  CP-REDUCING-LIFE                    VALUE 'R'.
  1381           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  1382         16  CP-INCURRED-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page  27
* EL156.cbl
  1383         16  CP-REPORTED-DT        PIC XX.
  1384         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  1385         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  1386         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  1387                                     COMP-3.
  1388         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  1389                                     COMP-3.
  1390         16  CP-CDT-METHOD         PIC X.
  1391           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  1392           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  1393           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  1394         16  CP-CLAIM-TYPE         PIC X.
  1395           88  CP-AH-CLAIM                         VALUE 'A'.
  1396           88  CP-LIFE-CLAIM                       VALUE 'L'.
  1397         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  1398                                     COMP-3.
  1399         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  1400                                     COMP-3.
  1401         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  1402                                     COMP-3.
  1403         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  1404                                     COMP-3.
  1405         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  1406                                     COMP-3.
  1407         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  1408                                     COMP-3.
  1409         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  1410                                     COMP-3.
  1411         16  CP-REM-TERM-METHOD    PIC X.
  1412           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  1413           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  1414           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  1415           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  1416           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  1417           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  1418           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  1419         16  CP-EARNING-METHOD     PIC X.
  1420           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  1421           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  1422           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  1423           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  1424           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  1425           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  1426           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  1427           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  1428           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  1429           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  1430           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  1431           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  1432           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  1433           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  1434         16  CP-PROCESS-TYPE       PIC X.
  1435           88  CP-CLAIM                            VALUE '1'.
  1436           88  CP-CANCEL                           VALUE '2'.
  1437           88  CP-ISSUE                            VALUE '3'.
  1438         16  CP-SPECIAL-CALC-CD    PIC X.
  1439           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  1440           88  CP-1-MTH-INTEREST               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page  28
* EL156.cbl
  1441           88  CP-0-MTH-INTEREST               VALUE 'A'.
  1442           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  1443           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  1444           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  1445           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  1446           88  CP-FARM-PLAN                    VALUE 'F'.
  1447           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  1448           88  CP-2-MTH-INTEREST               VALUE 'I'.
  1449           88  CP-3-MTH-INTEREST               VALUE 'J'.
  1450           88  CP-4-MTH-INTEREST               VALUE 'K'.
  1451           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  1452           88  CP-MORTGAGE-REC                 VALUE 'M'.
  1453           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  1454           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  1455           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  1456           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  1457                                                     'W' 'X'.
  1458           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  1459           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  1460           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  1461           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  1462           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  1463           88  CP-SUMMARY-REC                  VALUE 'Z'.
  1464           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  1465           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  1466           88  CP-AD-D-BENEFIT                 VALUE '4'.
  1467           88  CP-CSL-METH-1                   VALUE '5'.
  1468           88  CP-CSL-METH-2                   VALUE '6'.
  1469           88  CP-CSL-METH-3                   VALUE '7'.
  1470           88  CP-CSL-METH-4                   VALUE '8'.
  1471
  1472         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  1473                                     COMP-3.
  1474         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  1475         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  1476         16  CP-STATE              PIC XX          VALUE SPACE.
  1477         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  1478         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  1479           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  1480               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  1481         16  CP-R78-OPTION         PIC X.
  1482           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  1483           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  1484
  1485         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  1486         16  CP-IBNR-RESERVE-SW    PIC X.
  1487         16  CP-CLAIM-STATUS       PIC X.
  1488         16  CP-RATE-FILE          PIC X.
  1489         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  1490                                     COMP-3.
  1491
  1492         16  CP-LIFE-OVERRIDE-CODE PIC X.
  1493         16  CP-AH-OVERRIDE-CODE   PIC X.
  1494
  1495         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  1496                                     COMP-3.
  1497         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  1498                                   PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page  29
* EL156.cbl
  1499         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  1500                                     COMP-3.
  1501         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  1502                                     COMP-3.
  1503         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  1504                                     COMP-3.
  1505         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  1506                                  PIC S9(7)V99 COMP-3.
  1507
  1508         16  CP-PAID-FROM-DATE     PIC X(02).
  1509         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  1510         16  CP-EXT-DAYS-CALC      PIC X.
  1511           88  CP-EXT-NO-CHG                   VALUE ' '.
  1512           88  CP-EXT-CHG-LF                   VALUE '1'.
  1513           88  CP-EXT-CHG-AH                   VALUE '2'.
  1514           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  1515         16  CP-DOMICILE-STATE     PIC XX.
  1516         16  CP-CARRIER            PIC X.
  1517         16  CP-REIN-FLAG          PIC X.
  1518         16  CP-REM-TRM-CALC-OPTION PIC X.
  1519           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  1520                      '2' '3' '4' '5'.
  1521           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  1522           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  1523           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  1524           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  1525           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  1526           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  1527           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  1528           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  1529         16  CP-SIG-SWITCH         PIC X.
  1530         16  CP-RATING-METHOD      PIC X.
  1531           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  1532           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  1533           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  1534           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  1535           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  1536           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  1537           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  1538           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  1539           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  1540         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  1541                                     COMP-3.
  1542         16  CP-BEN-CATEGORY       PIC X.
  1543         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  1544         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  1545                                   PIC S99V9(5) COMP-3.
  1546         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  1547         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  1548                                   PIC S99V9(5) COMP-3.
  1549         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  1550         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  1551         16  CP-EXPIRE-DT          PIC XX.
  1552         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  1553         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  1554         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  1555         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  1556         16  CP-DDF-SPEC-CALC      PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page  30
* EL156.cbl
  1557             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  1558             88  CP-CALC-CLP              VALUE 'C'.
  1559         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  1560         16  CP-CANCEL-REASON      PIC X.
  1561         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  1562         16  CP-PMT-MODE           PIC X.
  1563         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  1564         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  1565         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  1566         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  1567         16  FILLER                PIC X.
  1568
  1569***************    OUTPUT FROM ELRESV   ************************
  1570
  1571         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  1572
  1573         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  1574                                     COMP-3.
  1575         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  1576                                     COMP-3.
  1577         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  1578                                     COMP-3.
  1579         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  1580                                     COMP-3.
  1581         16  FILLER                PIC X(09).
  1582***************    OUTPUT FROM ELRTRM   *************************
  1583
  1584         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  1585                                     COMP-3.
  1586         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  1587                                     COMP-3.
  1588         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  1589                                     COMP-3.
  1590         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  1591                                     COMP-3.
  1592         16  FILLER                PIC X(12).
  1593
  1594***************    OUTPUT FROM ELRAMT   *************************
  1595
  1596         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  1597                                     COMP-3.
  1598         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  1599                                     COMP-3.
  1600         16  FILLER                PIC X(12).
  1601
  1602***************    OUTPUT FROM ELRATE   *************************
  1603
  1604         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  1605                                     COMP-3.
  1606         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  1607                                     COMP-3.
  1608         16  CP-MORTALITY-CODE     PIC X(4).
  1609         16  CP-RATE-EDIT-FLAG     PIC X.
  1610             88  CP-RATES-NEED-APR                  VALUE '1'.
  1611         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  1612                                     COMP-3.
  1613         16  CP-CANCEL-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  1614         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page  31
* EL156.cbl
  1615         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  1616                                   PIC S9(7)V99 COMP-3.
  1617         16  FILLER                PIC X(07).
  1618
  1619***************    OUTPUT FROM ELRFND   *************************
  1620
  1621         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  1622                                     COMP-3.
  1623         16  CP-REFUND-TYPE-USED   PIC X.
  1624           88  CP-R-AS-R78                         VALUE '1'.
  1625           88  CP-R-AS-PRORATA                     VALUE '2'.
  1626           88  CP-R-AS-CALIF                       VALUE '3'.
  1627           88  CP-R-AS-TEXAS                       VALUE '4'.
  1628           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  1629           88  CP-R-AS-NET-PAY                     VALUE '5'.
  1630           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  1631           88  CP-R-AS-MEAN                        VALUE '8'.
  1632           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  1633           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  1634           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  1635           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  1636           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  1637           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  1638         16  FILLER                PIC X(12).
  1639
  1640***************    OUTPUT FROM ELEARN   *************************
  1641
  1642         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  1643                                     COMP-3.
  1644         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  1645                                     COMP-3.
  1646         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  1647                                     COMP-3.
  1648         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  1649                                     COMP-3.
  1650         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  1651                                     COMP-3.
  1652         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  1653                                     COMP-3.
  1654         16  CP-EARNING-TYPE-USED  PIC X.
  1655           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  1656           88  CP-E-AS-R78                         VALUE '1'.
  1657           88  CP-E-AS-PRORATA                     VALUE '2'.
  1658           88  CP-E-AS-TEXAS                       VALUE '4'.
  1659           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  1660           88  CP-E-AS-NET-PAY                     VALUE '5'.
  1661           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  1662           88  CP-E-AS-MEAN                        VALUE '8'.
  1663           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  1664         16  FILLER                PIC X(12).
  1665
  1666***************    OUTPUT FROM ELPMNT   *************************
  1667
  1668         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  1669                                     COMP-3.
  1670         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  1671                                     COMP-3.
  1672         16  FILLER                PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page  32
* EL156.cbl
  1673
  1674***************   MISC WORK AREAS    *****************************
  1675         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  1676                                     COMP-3.
  1677         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  1678                                     COMP-3.
  1679         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  1680                                     COMP-3.
  1681         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  1682                                     COMP-3.
  1683         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  1684                                     COMP-3.
  1685         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  1686                                     COMP-3.
  1687         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  1688             88  OPEN-RATE-FILE                   VALUE 'O'.
  1689             88  CLOSE-RATE-FILE                  VALUE 'C'.
  1690             88  IO-ERROR                         VALUE 'E'.
  1691
  1692         16  CP-FIRST-PAY-DATE     PIC XX.
  1693
  1694         16  CP-JOINT-INDICATOR    PIC X.
  1695
  1696         16  CP-RESERVE-REMAINING-TERM
  1697                                   PIC S9(4)V9    VALUE ZERO
  1698                                     COMP-3.
  1699
  1700         16  CP-INSURED-BIRTH-DT   PIC XX.
  1701
  1702         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  1703                                     COMP-3.
  1704
  1705         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  1706                                     COMP-3.
  1707
  1708         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  1709                                     COMP-3.
  1710
  1711         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  1712                                     COMP-3.
  1713
  1714         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  1715                                     COMP-3.
  1716
  1717         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  1718                                     COMP-3.
  1719
  1720         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  1721                                     COMP-3.
  1722
  1723         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  1724             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  1725
  1726         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  1727                                     COMP-3.
  1728         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  1729                                     COMP-3.
  1730         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page  33
* EL156.cbl
  1731         16  cp-extra-periods      pic 9 value zeros.
  1732         16  cp-net-only-state     pic x value spaces.
  1733         16  FILLER                PIC X(13).
  1734******************************************************************
  1735*    COPY ELCICALC.
  1736******************************************************************
  1737*                                                                *
  1738*                           ELCCICALC.                           *
  1739*                            VMOD=2.001                          *
  1740*                                                                *
  1741*   DESCRIPTION:  DATA TO BE PASSED TO THE CLAIM INTEREST        *
  1742*                 CALCULATION MODULE                             *
  1743*                                                                *
  1744*  PASSED TO ELCLMI                                              *
  1745*  -----------------                                             *
  1746*  STATE                                                         *
  1747*  PRODUCT                                                       *
  1748*  COVERAGE                                                      *
  1749*  EFFECTIVE DATE                                                *
  1750*  INCURRED DATE                                                 *
  1751*  ESTABLISHED DATE                                              *
  1752*  LAST PAID DATE                                                *
  1753*  REPORTED DATE                                                 *
  1754*  CLAIM PAYMENT AMOUNT                                          *
  1755*                                                                *
  1756*  RETURNED FROM ELRTRM                                          *
  1757*  ---------------------                                         *
  1758*  RETURN CODE                                                   *
  1759*  CLAIM INTEREST DUE SWITCH Y/N                                 *
  1760*  CLAIM INTEREST AMOUNT                                         *
  1761*----------------------------------------------------------------*
  1762*----------------------------------------------------------------*
  1763*                 LENGTH = 100                                   *
  1764*                                                                *
  1765******************************************************************
  1766******************************************************************
  1767*                   C H A N G E   L O G
  1768*
  1769* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1770*-----------------------------------------------------------------
  1771*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1772* EFFECTIVE    NUMBER
  1773*-----------------------------------------------------------------
  1774* 120905    2004040700004  PEMA  NEW COPYBOOK
  1775* 060608    2008040300002  PEMA  ADD EFF DT TO ELCLMI PASS AREA
  1776******************************************************************
  1777
  1778 01  CLAIM-INT-PASS-AREA.
  1779     12  CP-CLAIM-LENGTH           PIC S9(4)         VALUE +100
  1780                                     COMP.
  1781
  1782     12  CI-RETURN-CODE            PIC X             VALUE ZERO.
  1783       88  NO-CI-ERROR                             VALUE ZERO.
  1784       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'.
  1785       88  CP-ERROR-IN-SEL-CRITERIA                VALUE '1'.
  1786       88  CP-NOT-QUAL-LEVEL-1                     VALUE '2'.
  1787       88  CP-NOT-QUAL-LEVEL-2                     VALUE '3'.
  1788       88  CP-AMT-LT-5000                          VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page  34
* EL156.cbl
  1789       88  CP-ERROR-IN-DATES                       VALUE '5'.
  1790       88  CP-ERROR-IN-ST-BREAKOUT                 VALUE '6'.
  1791       88  CP-ERROR-IN-SCHEDULES                   VALUE '7'.
  1792       88  CP-INTEREST-RATE-IS-ZERO                VALUE '8'.
  1793***********************  INPUT AREAS ****************************
  1794
  1795     12  CP-CALCULATION-AREA.
  1796         16  CP-COMPANY-CD         PIC X.
  1797         16  CP-STATE              PIC XX.
  1798         16  CP-PRODUCT            PIC XX.
  1799         16  CP-COVERAGE           PIC XX.
  1800         16  CP-INC-DT             PIC XX.
  1801         16  CP-EST-DT             PIC XX.
  1802         16  CP-LSTPD-DT           PIC XX.
  1803         16  CP-RPT-DT             PIC XX.
  1804         16  CP-PRF-DT             PIC XX.
  1805         16  CP-EFF-DT             PIC XX.
  1806         16  CP-CLAIM-AMT          PIC S9(7)V99 COMP-3.
  1807         16  CP-INT-RATE           PIC S99V9(5) COMP-3.
  1808         16  FILLER                PIC X(37).
  1809
  1810***************    OUTPUT FROM ELCLMI   ************************
  1811
  1812         16  CP-CLM-INT-SW         PIC X         VALUE SPACES.
  1813
  1814         16  CP-CLM-INT-AMT        PIC S9(7)V99  VALUE +0 COMP-3.
  1815         16  CP-CLM-INT-RATE       PIC S99V9(5)  VALUE +0 COMP-3.
  1816         16  CP-CLM-INT-NODAYS     PIC S9(5)     VALUE +0 COMP-3.
  1817         16  FILLER                PIC X(19).
  1818******************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page  35
* EL156.cbl
  1820*    COPY ELCATTR.
  1821******************************************************************
  1822*                                                                *
  1823*                            ELCATTR.                            *
  1824*                            VMOD=2.001                          *
  1825*                                                                *
  1826*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  1827*                                                                *
  1828*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  1829*                                                                *
  1830*                   POS 1   P=PROTECTED                          *
  1831*                           U=UNPROTECTED                        *
  1832*                           S=ASKIP                              *
  1833*                   POS 2   A=ALPHA/NUMERIC                      *
  1834*                           N=NUMERIC                            *
  1835*                   POS 3   N=NORMAL                             *
  1836*                           B=BRIGHT                             *
  1837*                           D=DARK                               *
  1838*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  1839*                           OF=MODIFIED DATA TAG OFF             *
  1840*                                                                *
  1841*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  1842******************************************************************
  1843 01  ATTRIBUTE-LIST.
  1844     12  AL-PABOF            PIC X       VALUE 'Y'.
  1845     12  AL-PABON            PIC X       VALUE 'Z'.
  1846     12  AL-PADOF            PIC X       VALUE '%'.
  1847     12  AL-PADON            PIC X       VALUE '_'.
  1848     12  AL-PANOF            PIC X       VALUE '-'.
  1849     12  AL-PANON            PIC X       VALUE '/'.
  1850     12  AL-SABOF            PIC X       VALUE '8'.
  1851     12  AL-SABON            PIC X       VALUE '9'.
  1852     12  AL-SADOF            PIC X       VALUE '@'.
  1853     12  AL-SADON            PIC X       VALUE QUOTE.
  1854     12  AL-SANOF            PIC X       VALUE '0'.
  1855     12  AL-SANON            PIC X       VALUE '1'.
  1856     12  AL-UABOF            PIC X       VALUE 'H'.
  1857     12  AL-UABON            PIC X       VALUE 'I'.
  1858     12  AL-UADOF            PIC X       VALUE '<'.
  1859     12  AL-UADON            PIC X       VALUE '('.
  1860     12  AL-UANOF            PIC X       VALUE ' '.
  1861     12  AL-UANON            PIC X       VALUE 'A'.
  1862     12  AL-UNBOF            PIC X       VALUE 'Q'.
  1863     12  AL-UNBON            PIC X       VALUE 'R'.
  1864     12  AL-UNDOF            PIC X       VALUE '*'.
  1865     12  AL-UNDON            PIC X       VALUE ')'.
  1866     12  AL-UNNOF            PIC X       VALUE '&'.
  1867     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page  36
* EL156.cbl
  1869*    COPY ELCEMIB.
  1870******************************************************************
  1871*                                                                *
  1872*                                                                *
  1873*                            ELCEMIB.                            *
  1874*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1875*                            VMOD=2.005                          *
  1876*                                                                *
  1877*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  1878*                                                                *
  1879******************************************************************
  1880 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  1881     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  1882     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  1883     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  1884     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  1885     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  1886     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  1887     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  1888     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  1889     12  EMI-SWITCH1             PIC X        VALUE '1'.
  1890         88  EMI-NO-ERRORS                    VALUE '1'.
  1891         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  1892         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  1893     12  EMI-SWITCH2             PIC X        VALUE '1'.
  1894         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  1895     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  1896         88  EMI-AREA1-EMPTY                  VALUE '1'.
  1897         88  EMI-AREA1-FULL                   VALUE '2'.
  1898     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  1899         88  EMI-AREA2-EMPTY                  VALUE '1'.
  1900         88  EMI-AREA2-FULL                   VALUE '2'.
  1901     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  1902         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  1903         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  1904         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  1905         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  1906         88  EMI-BYPASS-FATALS                VALUE 'X'.
  1907     12  EMI-ERROR-LINES.
  1908         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  1909         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  1910         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  1911         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  1912             20  EMI-ERR-CODES OCCURS 10 TIMES.
  1913                 24  EMI-ERR-NUM         PIC X(4).
  1914                 24  EMI-FILLER          PIC X.
  1915                 24  EMI-SEV             PIC X.
  1916                 24  FILLER              PIC X.
  1917             20  FILLER                  PIC X(02).
  1918     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  1919         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  1920             20  EMI-ERROR-NUMBER    PIC X(4).
  1921             20  EMI-FILL            PIC X.
  1922             20  EMI-SEVERITY        PIC X.
  1923             20  FILLER              PIC X.
  1924             20  EMI-ERROR-TEXT.
  1925                 24  EMI-TEXT-VARIABLE   PIC X(10).
  1926                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page  37
* EL156.cbl
  1927     12  EMI-SEVERITY-SAVE           PIC X.
  1928         88  EMI-NOTE                    VALUE 'N'.
  1929         88  EMI-WARNING                 VALUE 'W'.
  1930         88  EMI-FORCABLE                VALUE 'F'.
  1931         88  EMI-FATAL                   VALUE 'X'.
  1932     12  EMI-MESSAGE-FLAG            PIC X.
  1933         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  1934         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  1935     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  1936     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  1937         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  1938         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  1939         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  1940     12  emi-claim-no                pic x(7).
  1941     12  emi-claim-type              pic x(6).
  1942     12  FILLER                      PIC X(124)  VALUE SPACES.
  1943     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  1944     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  1945     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  1946     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page  38
* EL156.cbl
  1948*    COPY ELCLNKLT.
  1949******************************************************************
  1950*                                                                *
  1951*                                                                *
  1952*                           ELCLNKLT                             *
  1953*                            VMOD=2.003                          *
  1954*                                                                *
  1955*   THIS COPY BOOK IS USED TO PASS DATA TO THE LETTER GENERATOR  *
  1956*   PROGRAM (EL1523). THE AREA SHOULD BE INITIALIZED TO LOW-     *
  1957*   VALUES BEFORE ENTERING YOUR INFORMATION.                     *
  1958*                                                                *
  1959*   MOVE THE PROGRAM-INTERFACE-BLOCK TO W-1523-LINK-DATA BEFORE  *
  1960*   COMPLETING THE REQUIRED FIELDS.                              *
  1961*                                                                *
  1962*   THE CALLING PROGRAM SHOULD CHECK:                            *
  1963*   1. W-1523-ERROR-CODE WHERE 0000 INDICATES NO ERROR DETECTED. *
  1964*                              9999 INDICATES AN UNKNOWN ABEND   *
  1965*                                   WAS DETECTED.                *
  1966*                              ALL OTHER VALUES ARE NORMAL ERROR *
  1967*                              CODES FOUND IN THE ERROR FILE.    *
  1968******************************************************************
  1969 01  W-1523-LINKDATA.
  1970     12  W-1523-COMMON-PI-DATA.
  1971         16  W-1523-COMM-LENGTH  PIC S9(04) COMP   VALUE +1024.
  1972         16  FILLER              PIC  X(67).
  1973         16  W-1523-COMPANY-CD   PIC  X(01).
  1974         16  FILLER              PIC  X(10).
  1975         16  W-1523-CONTROL-IN-PROGRESS.
  1976             20  W-1523-CARRIER  PIC  X(01).
  1977             20  W-1523-GROUPING PIC  X(06).
  1978             20  W-1523-STATE    PIC  X(02).
  1979             20  W-1523-ACCOUNT  PIC  X(10).
  1980             20  W-1523-CLAIM-CERT-GRP.
  1981                 24  W-1523-CLAIM-NO
  1982                                 PIC  X(07).
  1983                 24  W-1523-CERT-NO.
  1984                     28  W-1523-CERT-PRIME
  1985                                 PIC  X(10).
  1986                     28  W-1523-CERT-SFX
  1987                                 PIC  X(01).
  1988                 24  W-1523-CERT-EFF-DT
  1989                                 PIC  X(02).
  1990         16  FILLER              PIC X(265).
  1991
  1992     12  W-1523-WORK-AREA.
  1993         16  W-1523-FORM-NUMBER  PIC  X(04).
  1994         16  W-1523-NUMBER-COPIES
  1995                                 PIC  9(01).
  1996         16  W-1523-ADDR-TYPE    PIC  X(02).
  1997         16  W-1523-FOLLOW-UP-DATE
  1998                                 PIC  X(02).
  1999         16  W-1523-RESEND-DATE  PIC  X(02).
  2000         16  W-1523-ERROR-CODE   PIC  9(04).
  2001             88  W-1523-NO-ERRORS-DETECTED VALUE 0000.
  2002             88  W-1523-FATAL-ERROR
  2003                                    VALUES  0006 0013 0042
  2004                                            0154 0168 0169
  2005                                            0176 9999 0172
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page  39
* EL156.cbl
  2006                                            0179 0186 0281
  2007                                            0332 2055 3697
  2008                                            3698 3699 3770
  2009                                            3771 3772 7675
  2010                                            9106 9808 9883
  2011                                            9887.
  2012             88  W-1523-STOP-ERRORS
  2013                                    VALUES  0013 0042 0154
  2014                                            0168 0169 0172
  2015                                            0281 0332 2055
  2016                                            3698 3699 7675
  2017                                            9106 9808 9883
  2018                                            9999.
  2019         16  W-1523-REASON       PIC  X(70).
  2020         16  W-1523-ARCHIVE-NUMBER
  2021                                 PIC  9(08).
  2022     12  W-1523-POINTER-AREA.
  2023         16  W-1523-ACCT-POINTER PIC S9(08) COMP.
  2024         16  W-1523-ACTY-POINTER PIC S9(08) COMP.
  2025         16  W-1523-ARCH-POINTER PIC S9(08) COMP.
  2026         16  W-1523-VAR-POINTER  PIC S9(08) COMP.
  2027         16  W-1523-PROD-POINTER PIC S9(08) COMP.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page  40
* EL156.cbl
  2029*    COPY ELCNWA.
  2030*****************************************************************
  2031*                                                               *
  2032*                                                               *
  2033*                            ELCNWA.                            *
  2034*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2035*                            VMOD=2.003                         *
  2036*                                                               *
  2037*            M O V E   N A M E   W O R K   A R E A.             *
  2038*                                                               *
  2039*****************************************************************.
  2040
  2041 01  WS-NAME-WORK-AREA.
  2042     05  WS-INSURED-LAST-NAME        PIC X(15).
  2043     05  WS-INSURED-1ST-NAME         PIC X(12).
  2044     05  WS-INSURED-MID-INIT         PIC X.
  2045
  2046     05  WS-NAME-WORK.
  2047         10  WS-NW                   PIC X
  2048             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
  2049
  2050     05  WS-NAME-WORK2.
  2051         10  WS-NW2                  PIC X
  2052             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
  2053                                        NWA-INDEX0.
  2054
  2055     05  WS-NAME-SW                  PIC S9          VALUE ZERO
  2056                                     COMP-3.
  2057
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page  41
* EL156.cbl
  2059*    COPY ELCDMO.
  2060******************************************************************
  2061*                                                                *
  2062*                                                                *
  2063*                            ELCDMO.                             *
  2064*                            VMOD=2.004                          *
  2065*                                                                *
  2066*   FILE DESCRIPTION = DLO025 (DMO FILE MAINTENANCE PGRM)        *
  2067*        COMMUNICATION AREA                                      *
  2068*   FILE TYPE = NA                                               *
  2069*   RECORD SIZE = 110    RECFORM = FIXED                         *
  2070*                                                                *
  2071******************************************************************
  2072 01  DMO-COMMUNICATION-AREA.
  2073     12  DM-RECORD-TYPE                  PIC  X(02).
  2074             88  DM-ISSUE-TRAN                VALUE 'CC'.
  2075             88  DM-CLAIM-STATUS-CHANGE       VALUE 'CS'.
  2076             88  DM-CLAIM-PAYMENT             VALUE 'DR'.
  2077     12  DM-DIST-CODE                    PIC  X(04).
  2078     12  DM-MAIL-CODE                    PIC  X(05).
  2079     12  DM-CREDIT-CARD-NUMBER           PIC  X(16).
  2080     12  DM-INSURED-NAME                 PIC  X(30).
  2081     12  DM-CLAIM-NO                     PIC  X(07).
  2082     12  DM-CLAIM-TYPE                   PIC  X.
  2083
  2084     12  DM-STATUS-DATA-AREA.
  2085         16  DM-CLAIM-STATUS             PIC  X.
  2086             88  DM-OPEN-NO-PAYMENTS              VALUE '1'.
  2087             88  DM-OPEN-WITH-PAYMENTS            VALUE '2'.
  2088             88  DM-CLOSED                        VALUE '3'.
  2089             88  DM-CLOSE-SETTLE-FINAL            VALUE '4'.
  2090             88  DM-DEFAULT                       VALUE '9'.
  2091         16  DM-STATUS-DATE              PIC  X(08).
  2092******YYYYMMDD
  2093         16  DM-STAT-CHANGE-TYPE         PIC  X.
  2094             88  DM-MANUAL-CLOSE                  VALUE 'C'.
  2095             88  DM-CLAIM-DENIED                  VALUE 'D'.
  2096             88  DM-FINAL-PAYMENT                 VALUE 'F'.
  2097             88  DM-INITIAL-PAYMENT               VALUE 'I'.
  2098             88  DM-AUTO-CLOSE                    VALUE 'Q'.
  2099             88  DM-RE-OPENED                     VALUE 'R'.
  2100             88  DM-NEW-CLAIM-SETUP               VALUE 'S'.
  2101             88  DM-VOIDED-PAYMENT                VALUE 'V'.
  2102             88  DM-CLAIM-DELETED                 VALUE 'X'.
  2103         16  DM-STAT-CARRIER             PIC X.
  2104
  2105     12  DM-DRAFT-DATA-AREA.
  2106         16  DM-PAYMENT-TYPE             PIC  X.
  2107             88  DM-VALID-CLAIM-TYPES VALUES 'L' 'D' 'U' 'A'.
  2108         16  DM-PAYMENT-AMT              PIC  9(05)V9(02).
  2109         16  DM-PAYMENT-DATE             PIC  X(08).
  2110******YYYYMMDD
  2111         16  DM-CERT-NO                  PIC  X(11).
  2112         16  DM-TRLR-SEQ-NO              PIC  9(04).
  2113         16  DM-CARRIER                  PIC  X.
  2114
  2115     12  DM-RETURN-CODE                  PIC  XX.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page  42
* EL156.cbl
  2117*    COPY ELCDMDCD.
  2118******************************************************************
  2119*                                                                *
  2120*                                                                *
  2121*                            ELCDMDCD.                           *
  2122*                            VMOD=2.001                          *
  2123*                                                                *
  2124*   DESCRIPTION = CODES VALIDATION PROGRAM (DLO023)              *
  2125*       COMMUNICATIONS AREA                                      *
  2126*                                                                *
  2127******************************************************************
  2128 01  CD-COMMUNICATION-AREA.
  2129     12  CD-SYSTEM-ID            PIC  X(02).
  2130         88 CD-CLAIMS                      VALUE 'CL'.
  2131         88 CD-CREDIT                      VALUE 'CR'.
  2132     12  CD-RECORD-TYPE          PIC  X(02).
  2133         88 CD-DENIAL-CODE                 VALUE 'DN'.
  2134         88 CD-EOB-CODE                    VALUE 'EO'.
  2135         88 CD-ICD9-CODE                   VALUE 'I9'.
  2136         88 CD-OCCUPATION-CODE             VALUE 'OC'.
  2137         88 CD-PAYMENT-NOT-CODE            VALUE 'PN'.
  2138         88 CD-CAUSE-CODE                  VALUE 'CS'.
  2139         88 CD-COVERAGE-CAT-CODE           VALUE 'CV'.
  2140         88 CD-RESIDENT-STATE-CODE         VALUE 'RS'.
  2141     12  CD-RECORD-KEY           PIC  X(06).
  2142         88 CD-SUCCESSFUL                  VALUE 'OK'.
  2143     12  CD-RETURN-CODE          PIC  X(02).
  2144     12  CD-CODE-DESCRIPTION     PIC  X(60).
  2145     12  CD-GENERAL-DESCRIPTION1 PIC  X(20).
  2146     12  CD-GENERAL-DESCRIPTION2 PIC  X(20).
  2147     12  CD-GENERAL-DESCRIPTION3 PIC  X(20).
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page  43
* EL156.cbl
  2149*    COPY ELCDCTB.
  2150******************************************************************
  2151*                                                                *
  2152*                                                                *
  2153*                            ELCDCTB.                            *
  2154*                            VMOD=2.002                          *
  2155*                                                                *
  2156*   DESCRIPTION = DISTRIBUTION CONTROL TABLE MAINTENANCE PROGRAM *
  2157*       COMMUNICATIONS AREA                                      *
  2158*                                                                *
  2159******************************************************************
  2160 01  DCT-COMMUNICATION-AREA.
  2161     12  DCT-BILLING-BANK-ID      PIC  X(05).
  2162     12  DCT-LOGIC-BENEFICIARY-ID PIC  X(10).
  2163     12  DCT-CREDIT-CARD-NUMBER   PIC  X(16).
  2164     12  DCT-PRODUCT-CODE         PIC  X(02).
  2165     12  DCT-COLUMN-ID-REQUESTED  PIC  X(02).
  2166     12  DCT-RETURN-CODE          PIC  X(02).
  2167     12  DCT-MAIL-CODE            PIC  X(05).
  2168     12  DCT-DISTRIBUTION-CODE    PIC  X(04).
  2169     12  DCT-MSA-ACCT-NO          PIC  X(07).
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page  44
* EL156.cbl
  2171 01  CD-RCRD-LENGTH                  PIC S9(4)  COMP VALUE +132.
  2172 01  DCT-RCRD-LENGTH                 PIC S9(4)  COMP VALUE +53.
  2173 01  DM-DMO-LENGTH                   PIC S9(4)  COMP VALUE +108.
  2174 01  DL35-LENGTH                     PIC S9(4)  COMP VALUE +34.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page  45
* EL156.cbl
  2176*    COPY ELCINTF.
  2177******************************************************************
  2178*                                                                *
  2179*                                                                *
  2180*                            ELCINTF.                            *
  2181*                            VMOD=2.017                          *
  2182*                                                                *
  2183*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  2184*                                                                *
  2185*       LENGTH = 1024                                            *
  2186*                                                                *
  2187******************************************************************
  2188*                   C H A N G E   L O G
  2189*
  2190* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2191*-----------------------------------------------------------------
  2192*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2193* EFFECTIVE    NUMBER
  2194*-----------------------------------------------------------------
  2195* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2196******************************************************************
  2197 01  PROGRAM-INTERFACE-BLOCK.
  2198     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  2199     12  PI-CALLING-PROGRAM              PIC X(8).
  2200     12  PI-SAVED-PROGRAM-1              PIC X(8).
  2201     12  PI-SAVED-PROGRAM-2              PIC X(8).
  2202     12  PI-SAVED-PROGRAM-3              PIC X(8).
  2203     12  PI-SAVED-PROGRAM-4              PIC X(8).
  2204     12  PI-SAVED-PROGRAM-5              PIC X(8).
  2205     12  PI-SAVED-PROGRAM-6              PIC X(8).
  2206     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  2207     12  PI-COMPANY-ID                   PIC XXX.
  2208     12  PI-COMPANY-CD                   PIC X.
  2209
  2210     12  PI-COMPANY-PASSWORD             PIC X(8).
  2211
  2212     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  2213
  2214     12  PI-CONTROL-IN-PROGRESS.
  2215         16  PI-CARRIER                  PIC X.
  2216         16  PI-GROUPING                 PIC X(6).
  2217         16  PI-STATE                    PIC XX.
  2218         16  PI-ACCOUNT                  PIC X(10).
  2219         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  2220                                         PIC X(10).
  2221         16  PI-CLAIM-CERT-GRP.
  2222             20  PI-CLAIM-NO             PIC X(7).
  2223             20  PI-CERT-NO.
  2224                 25  PI-CERT-PRIME       PIC X(10).
  2225                 25  PI-CERT-SFX         PIC X.
  2226             20  PI-CERT-EFF-DT          PIC XX.
  2227         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  2228             20  PI-PLAN-CODE            PIC X(2).
  2229             20  PI-REVISION-NUMBER      PIC X(3).
  2230             20  PI-PLAN-EFF-DT          PIC X(2).
  2231             20  PI-PLAN-EXP-DT          PIC X(2).
  2232             20  FILLER                  PIC X(11).
  2233         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page  46
* EL156.cbl
  2234             20  PI-OE-REFERENCE-1.
  2235                 25  PI-OE-REF-1-PRIME   PIC X(18).
  2236                 25  PI-OE-REF-1-SUFF    PIC XX.
  2237
  2238     12  PI-SESSION-IN-PROGRESS          PIC X.
  2239         88  CLAIM-SESSION                   VALUE '1'.
  2240         88  CREDIT-SESSION                  VALUE '2'.
  2241         88  WARRANTY-SESSION                VALUE '3'.
  2242         88  MORTGAGE-SESSION                VALUE '4'.
  2243         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  2244
  2245
  2246*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  2247
  2248     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  2249     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  2250
  2251     12  PI-CREDIT-USER                  PIC X.
  2252         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  2253         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  2254
  2255     12  PI-CLAIM-USER                   PIC X.
  2256         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  2257         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  2258
  2259     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  2260         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  2261         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  2262         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  2263         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  2264         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  2265
  2266     12  PI-PROCESSOR-ID                 PIC X(4).
  2267
  2268     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  2269
  2270     12  PI-MEMBER-CAPTION               PIC X(10).
  2271
  2272     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  2273         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  2274
  2275     12  PI-LIFE-OVERRIDE-L1             PIC X.
  2276     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  2277     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  2278     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  2279
  2280     12  PI-AH-OVERRIDE-L1               PIC X.
  2281     12  PI-AH-OVERRIDE-L2               PIC XX.
  2282     12  PI-AH-OVERRIDE-L6               PIC X(6).
  2283     12  PI-AH-OVERRIDE-L12              PIC X(12).
  2284
  2285     12  PI-NEW-SYSTEM                   PIC X(2).
  2286
  2287     12  PI-PRIMARY-CERT-NO              PIC X(11).
  2288     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  2289         88  PI-USES-PAID-TO                 VALUE '1'.
  2290     12  PI-CRDTCRD-SYSTEM.
  2291         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page  47
* EL156.cbl
  2292             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  2293             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  2294         16  PI-CC-MONTH-END-DT          PIC XX.
  2295     12  PI-PROCESSOR-PRINTER            PIC X(4).
  2296
  2297     12  PI-OE-REFERENCE-2.
  2298         16  PI-OE-REF-2-PRIME           PIC X(10).
  2299         16  PI-OE-REF-2-SUFF            PIC X.
  2300
  2301     12  PI-REM-TRM-CALC-OPTION          PIC X.
  2302
  2303     12  PI-LANGUAGE-TYPE                PIC X.
  2304             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  2305             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  2306             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  2307
  2308     12  PI-POLICY-LINKAGE-IND           PIC X.
  2309         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  2310         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  2311                                                   LOW-VALUES.
  2312
  2313     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  2314     12  PI-CLAIM-PW-SESSION             PIC X(1).
  2315         88  PI-CLAIM-CREDIT                 VALUE '1'.
  2316         88  PI-CLAIM-CONVEN                 VALUE '2'.
  2317
  2318     12  PI-PROCESSOR-CSR-IND            PIC X.
  2319         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  2320         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  2321
  2322     12  FILLER                          PIC X(3).
  2323
  2324     12  PI-SYSTEM-LEVEL                 PIC X(145).
  2325
  2326     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  2327         PI-SYSTEM-LEVEL.
  2328
  2329         16  PI-ENTRY-CODES.
  2330             20  PI-ENTRY-CD-1           PIC X.
  2331             20  PI-ENTRY-CD-2           PIC X.
  2332
  2333         16  PI-RETURN-CODES.
  2334             20  PI-RETURN-CD-1          PIC X.
  2335             20  PI-RETURN-CD-2          PIC X.
  2336
  2337         16  PI-UPDATE-STATUS-SAVE.
  2338             20  PI-UPDATE-BY            PIC X(4).
  2339             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  2340
  2341         16  PI-LOWER-CASE-LETTERS       PIC X.
  2342             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  2343
  2344*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  2345*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  2346*            88  CARRIER-CLM-CNTL            VALUE '2'.
  2347
  2348         16  PI-CERT-ACCESS-CONTROL      PIC X.
  2349             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page  48
* EL156.cbl
  2350             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2351             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  2352             88  ACCNT-CNTL                  VALUE '3'.
  2353             88  CARR-ACCNT-CNTL             VALUE '4'.
  2354
  2355         16  PI-PROCESSOR-CAP-LIST.
  2356             20  PI-SYSTEM-CONTROLS.
  2357                24 PI-SYSTEM-DISPLAY     PIC X.
  2358                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  2359                24 PI-SYSTEM-MODIFY      PIC X.
  2360                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  2361             20  FILLER                  PIC XX.
  2362             20  PI-DISPLAY-CAP          PIC X.
  2363                 88  DISPLAY-CAP             VALUE 'Y'.
  2364             20  PI-MODIFY-CAP           PIC X.
  2365                 88  MODIFY-CAP              VALUE 'Y'.
  2366             20  PI-MSG-AT-LOGON-CAP     PIC X.
  2367                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  2368             20  PI-FORCE-CAP            PIC X.
  2369                 88  FORCE-CAP               VALUE 'Y'.
  2370
  2371         16  PI-PROGRAM-CONTROLS.
  2372             20  PI-PGM-PRINT-OPT        PIC X.
  2373             20  PI-PGM-FORMAT-OPT       PIC X.
  2374             20  PI-PGM-PROCESS-OPT      PIC X.
  2375             20  PI-PGM-TOTALS-OPT       PIC X.
  2376
  2377         16  PI-HELP-INTERFACE.
  2378             20  PI-LAST-ERROR-NO        PIC X(4).
  2379             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  2380
  2381         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  2382             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  2383
  2384         16  PI-CR-CONTROL-IN-PROGRESS.
  2385             20  PI-CR-CARRIER           PIC X.
  2386             20  PI-CR-GROUPING          PIC X(6).
  2387             20  PI-CR-STATE             PIC XX.
  2388             20  PI-CR-ACCOUNT           PIC X(10).
  2389             20  PI-CR-FIN-RESP          PIC X(10).
  2390             20  PI-CR-TYPE              PIC X.
  2391
  2392         16  PI-CR-BATCH-NUMBER          PIC X(6).
  2393
  2394         16  PI-CR-MONTH-END-DT          PIC XX.
  2395
  2396         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  2397             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  2398             88  PI-ZERO-CARRIER             VALUE '1'.
  2399             88  PI-ZERO-GROUPING            VALUE '2'.
  2400             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  2401
  2402         16  PI-CARRIER-SECURITY         PIC X.
  2403             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  2404
  2405         16  PI-ACCOUNT-SECURITY         PIC X(10).
  2406             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  2407             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page  49
* EL156.cbl
  2408
  2409         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  2410             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  2411                                         INDEXED BY PI-ACCESS-NDX
  2412                                         PIC X.
  2413
  2414         16  PI-GA-BILLING-CONTROL       PIC X.
  2415             88  PI-GA-BILLING               VALUE '1'.
  2416
  2417         16  PI-MAIL-PROCESSING          PIC X.
  2418             88  PI-MAIL-YES                 VALUE 'Y'.
  2419
  2420         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  2421
  2422         16  PI-AR-SYSTEM.
  2423             20  PI-AR-PROCESSING-CNTL   PIC X.
  2424                 88  PI-AR-PROCESSING        VALUE 'Y'.
  2425             20  PI-AR-SUMMARY-CODE      PIC X(6).
  2426             20  PI-AR-MONTH-END-DT      PIC XX.
  2427
  2428         16  PI-MP-SYSTEM.
  2429             20  PI-MORTGAGE-USER            PIC X.
  2430                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  2431                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  2432             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  2433                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  2434                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  2435                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  2436                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  2437                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  2438             20  PI-MP-MONTH-END-DT          PIC XX.
  2439             20  PI-MP-REFERENCE-NO.
  2440                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  2441                 24  PI-MP-REFERENCE-SFX     PIC XX.
  2442
  2443         16  PI-LABEL-CONTROL            PIC X(01).
  2444             88  PI-CREATE-LABELS                    VALUE 'Y'.
  2445             88  PI-BYPASS-LABELS                    VALUE 'N'.
  2446
  2447         16  PI-BILL-GROUPING-CODE       PIC X(01).
  2448             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  2449
  2450         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  2451             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  2452             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  2453
  2454         16  FILLER                      PIC X(14).
  2455
  2456     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  2457******************************************************************
  2458     12  PI-REDEF     REDEFINES PI-PROGRAM-WORK-AREA.
  2459         16  PI-SAVE-FORM        PIC X(12).
  2460         16  PI-ACCT-KEY         PIC X(26).
  2461         16  PI-PAYEE-NAME       PIC X(30).
  2462         16  PI-DAILY-RATE       PIC S9(3)V99.
  2463         16  PI-MONTH-END-SAVE   PIC XX.
  2464         16  PI-BENEFIT-SAVE.
  2465             20  PI-BEN-DAYS     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page  50
* EL156.cbl
  2466             20  PI-BEN-TYPE     PIC X.
  2467         16  PI-MANUAL-SW        PIC 9.
  2468         16  PI-SAVE-CURSOR      PIC S9(4) COMP.
  2469         16  PI-PASS-SW          PIC X.
  2470         16  PI-PFKEY-USED       PIC X.
  2471         16  PI-CK-ASSIGN        PIC X.
  2472         16  PI-FATAL-COUNT      PIC 99.
  2473         16  PI-FORCE-COUNT      PIC 99.
  2474         16  PI-SAVE-INPUT.
  2475             20  PI-PMTTYPE      PIC X.
  2476             20  PI-PAYEE.
  2477                 24  PI-PAYEE-TYPE PIC X.
  2478                 24  PI-PAYEE-SEQ  PIC X.
  2479                 24  PI-PAYEE-SEQ-NUM REDEFINES
  2480                   PI-PAYEE-SEQ    PIC S9.
  2481             20  PI-PMTNOTE1     PIC X(60).
  2482             20  PI-PMTNOTE2     PIC X(60).
  2483             20  PI-OFFLINE      PIC X.
  2484             20  PI-ECHECKNO     PIC X(7).
  2485             20  PI-ECHECKNO-RDF REDEFINES PI-ECHECKNO.
  2486                 28  PI-ECHECKNO-N     PIC X.
  2487                 28  PI-ECHECKNO-6     PIC X(6).
  2488             20  PI-ECHECKNO-RDF1 REDEFINES PI-ECHECKNO.
  2489                 24  PI-ECHECKNO-CR    PIC XX.
  2490                 24  PI-ECHECKNO-5     PIC X(5).
  2491             20  PI-HOLDTIL      PIC 9(6).
  2492             20  PI-EPYFROM      PIC 9(6).
  2493             20  PI-EPYTHRU      PIC 9(6).
  2494             20  PI-EDAYS        PIC S9(5).
  2495             20  PI-EPYAMT       PIC S9(7)V99.
  2496             20  PI-ERESV        PIC S9(7)V99.
  2497             20  PI-EEXPENS      PIC 9(6)V99.
  2498             20  PI-ETYPE        PIC X.
  2499             20  PI-CASH         PIC X.
  2500             20  PI-GROUPED      PIC X.
  2501             20  PI-INT-RATE     PIC S99V9(5).
  2502             20  PI-AIGFROM      PIC 9(6).
  2503             20  PI-LOAN-NO      PIC X(20).
  2504             20  PI-PROOF-DATE   PIC 9(6).
  2505             20  PI-PRINT-EOB-YN PIC X.
  2506             20  PI-PRINT-CLM-FRM-YN PIC X.
  2507             20  PI-PRINT-SURVEY-YN PIC X.
  2508             20  PI-SPECIAL-RELEASE-YN PIC X.
  2509             20  pi-int-to-rem-borr pic x.
  2510         16  PI-SAVE-COMPUTED.
  2511             20  PI-CCHECKNO     PIC X(7).
  2512             20  PI-CCHECKNO-RDF REDEFINES PI-CCHECKNO.
  2513                 28  PI-CCHECKNO-N     PIC X.
  2514                 28  PI-CCHECKNO-6     PIC X(6).
  2515             20  PI-CCHECKNO-RDF1 REDEFINES PI-CCHECKNO.
  2516                 24  PI-CCHECKNO-CR    PIC XX.
  2517                 24  PI-CCHECKNO-5     PIC X(5).
  2518             20  PI-CPYFROM      PIC XX.
  2519             20  PI-CPYTHRU      PIC XX.
  2520             20  PI-CDAYS        PIC S9(5).
  2521             20  PI-CPYAMT       PIC S9(7)V99.
  2522             20  PI-CRESV        PIC 9(6)V99.
  2523             20  PI-CEXPENS      PIC 9(6)V99.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page  51
* EL156.cbl
  2524             20  PI-PMT-APPR-SW  PIC X.
  2525                 88 PI-PMT-APPROVED    VALUE 'G' 'Y'.
  2526                 88 PI-PMT-GRADUATED   VALUE 'G'.
  2527                 88 PI-PMT-NO-APPROVAL VALUE ' ' 'N'.
  2528         16  PI-PREV-CLMNO       PIC X(7).
  2529         16  PI-LF-COVERAGE-TYPE PIC X.
  2530         16  PI-MAX-PMT-TOL      PIC S9(7)V99  COMP-3.
  2531         16  PI-MAX-LF-PMT-TOL   PIC S9(7)V99  COMP-3.
  2532         16  PI-PROVISIONAL-IND  PIC X.
  2533             88 PI-PROV-PMT      VALUE 'P'.
  2534         16  PI-PREV-TRLR-KEY    PIC X(22).
  2535         16  PI-SPLIT-PMT-SW     PIC X.
  2536         16  PI-MAX-EXP-PMT      PIC S9(7)V99 COMP-3.
  2537         16  PI-ACTIVITY-CODE    PIC 99.
  2538         16  PI-RESET-SW         PIC X.
  2539         16  PI-SPECIAL-BEN-SW   PIC X.
  2540             88 PI-AIG-SPECIAL-BENEFIT VALUE 'Y'.
  2541         16  PI-REDUND-PMTAMT    PIC S9(7)V99.
  2542         16  PI-EXP-DT           PIC XX.
  2543         16  PI-LOAN-DUE-DAY     PIC 99.
  2544         16  PI-3RD-PARTY-SW     PIC X.
  2545         16  PI-LOAN-UPDATE-SW   PIC X.
  2546
  2547         16  PI-DMD-DATA.
  2548             20  PI-SV-CERT-KEY       PIC X(21).
  2549             20  PI-SV-CERT-NO        PIC X(11).
  2550             20  PI-SV-BEN            PIC X(10).
  2551             20  PI-SV-CCN            PIC X(16).
  2552             20  PI-INTEREST-PAID-IND PIC X.
  2553                 88  PI-INTEREST-PAID  VALUE 'Y'.
  2554             20  PI-MAX-BENEFIT-AMT   PIC S9(5)V99 COMP-3.
  2555             20  PI-MAX-BENEFIT-PYMT  PIC S9(5)V99 COMP-3.
  2556             20  PI-MIN-PAYMENT-AMT   PIC S9(5)V99 COMP-3.
  2557             20  PI-TIME-OF-LOSS-BAL  PIC S9(5)V99 COMP-3.
  2558         16  PI-AT-EOB-CODES.
  2559             20 PI-AT-EOB-CODE        PIC XXX   OCCURS 5.
  2560         16  PI-INT-AMT               PIC S9(5)V99 COMP-3.
  2561         16  PI-INT-DAYS              PIC S9(5) COMP-3.
  2562         16  PI-INT-RATE-USED         PIC S99V9(5) COMP-3.
  2563         16  PI-SAVE-ELAPSED-MONTHS   PIC 9(03).
  2564         16  PI-SAVE-ODD-DAYS-OVER    PIC S9(04).
  2565         16  PI-CHECK-STATE-FOR-AK    PIC X(02).
  2566         16  PI-ORIG-BEN-AMT          PIC S9(7)V99 COMP-3.
  2567         16  PI-REM-BEN-AMT           PIC S9(7)V99 COMP-3.
  2568         16  PI-MO-BEN-AMT            PIC S9(7)V99 COMP-3.
  2569         16  PI-LF-BENEFIT-CD         PIC X(2).
  2570         16  PI-EOB-CODES-EXIST PIC X.
  2571         16  PI-SET-NOTE2-MDT   PIC X.
  2572         16  PI-VFY-2ND-BENE          PIC X.
  2573         16  PI-CLM-TYPE              PIC X.
  2574         16  PI-APPROVAL-LEVEL        PIC X.
  2575         16  PI-REAUDIT-INTERVAL      PIC S9(5) COMP-3.
  2576         16  PI-REAUDIT-NEEDED        PIC X.
  2577         16  PI-DCC-PRODUCT-CODE      PIC XXX.
  2578         16  PI-AH-BENEFIT-CD         PIC XX.
  2579         16  pi-ah-term               pic s999 comp-3.
  2580         16  pi-ah-benefit-amt        pic s9(7)v99 comp-3.
  2581         16  pi-max-ext               pic 999.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page  52
* EL156.cbl
  2582         16  pi-max-ext-used          pic x.
  2583         16  PI-APPROVAL-3550-NEEDED  PIC X.
  2584         16  PI-JOINT-COV-IND         PIC X.
  2585             88  PI-JOINT-COVERAGE       VALUE 'J'.
  2586             88  PI-SINGLE-COVERAGE      VALUE ' '.
  2587         16  PI-JOINT-INSURED-IND     PIC X.
  2588             88  PI-JOINT-INSURED        VALUE 'Y'.
  2589             88  PI-PRIMARY-INSURED      VALUE 'N'.
  2590         16  pi-int-payees-name       pic x(30).
  2591         16  PI-RB-JOINT-COV-IND      PIC X.
  2592             88  PI-RB-JOINT-COVERAGE    VALUE 'J'.
  2593             88  PI-RB-SINGLE-COVERAGE   VALUE ' '.
  2594         16  pi-ach-payment           pic x.
  2595*00781          16  FILLER                   PIC X(176).
  2596*052506         16  FILLER                   PIC X(161).
  2597*031808         16  FILLER                   PIC X(154).
  2598*091808         16  FILLER                   PIC X(152).
  2599*041710         16  FILLER                   PIC X(94).
  2600         16  FILLER                   PIC X(34).
  2601
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page  53
* EL156.cbl
  2603*    COPY ELCJPFX.
  2604******************************************************************
  2605*                                                                *
  2606*                                                                *
  2607*                            ELCJPFX.                            *
  2608*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2609*                            VMOD=2.002                          *
  2610*                                                                *
  2611*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  2612*                                                                *
  2613*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  2614*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  2615*        ELCNTL - CONTROL FILE                                   *
  2616*        ELMSTR - CLAIM MASTERS                                  *
  2617*        ELTRLR - ACTIVITY TRAILERS                              *
  2618*        ELCHKQ - CHECK QUE                                      *
  2619******************************************************************
  2620 01  JOURNAL-RECORD.
  2621     12  jp-date                     pic s9(5) comp-3.
  2622     12  jp-time                     pic s9(7) comp-3.
  2623     12  JP-USER-ID                  PIC X(4).
  2624     12  JP-FILE-ID                  PIC X(8).
  2625     12  JP-PROGRAM-ID               PIC X(8).
  2626     12  JP-RECORD-TYPE              PIC X.
  2627         88 JP-ADD              VALUE 'A'.
  2628         88 JP-BEFORE-CHANGE    VALUE 'B'.
  2629         88 JP-AFTER-CHANGE     VALUE 'C'.
  2630         88 JP-DELETE           VALUE 'D'.
  2631         88 JP-GENERIC-DELETE   VALUE 'G'.
  2632         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  2633         88 JP-KEY-CHG-ADD      VALUE 'N'.
  2634     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  2635     12  JP-RECORD-AREA
  2636
  2637
  2638                             PIC X(750).
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page  54
* EL156.cbl
  2640*    COPY ELCAID.
  2641******************************************************************
  2642*                                                                *
  2643*                            ELCAID.                             *
  2644*                            VMOD=2.001                          *
  2645*                                                                *
  2646*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  2647*                                                                *
  2648*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  2649*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  2650******************************************************************
  2651
  2652 01  DFHAID.
  2653   02  DFHNULL   PIC  X  VALUE  ' '.
  2654   02  DFHENTER  PIC  X  VALUE  QUOTE.
  2655   02  DFHCLEAR  PIC  X  VALUE  '_'.
  2656   02  DFHPEN    PIC  X  VALUE  '='.
  2657   02  DFHOPID   PIC  X  VALUE  'W'.
  2658   02  DFHPA1    PIC  X  VALUE  '%'.
  2659   02  DFHPA2    PIC  X  VALUE  '>'.
  2660   02  DFHPA3    PIC  X  VALUE  ','.
  2661   02  DFHPF1    PIC  X  VALUE  '1'.
  2662   02  DFHPF2    PIC  X  VALUE  '2'.
  2663   02  DFHPF3    PIC  X  VALUE  '3'.
  2664   02  DFHPF4    PIC  X  VALUE  '4'.
  2665   02  DFHPF5    PIC  X  VALUE  '5'.
  2666   02  DFHPF6    PIC  X  VALUE  '6'.
  2667   02  DFHPF7    PIC  X  VALUE  '7'.
  2668   02  DFHPF8    PIC  X  VALUE  '8'.
  2669   02  DFHPF9    PIC  X  VALUE  '9'.
  2670   02  DFHPF10   PIC  X  VALUE  ':'.
  2671   02  DFHPF11   PIC  X  VALUE  '#'.
  2672   02  DFHPF12   PIC  X  VALUE  '@'.
  2673   02  DFHPF13   PIC  X  VALUE  'A'.
  2674   02  DFHPF14   PIC  X  VALUE  'B'.
  2675   02  DFHPF15   PIC  X  VALUE  'C'.
  2676   02  DFHPF16   PIC  X  VALUE  'D'.
  2677   02  DFHPF17   PIC  X  VALUE  'E'.
  2678   02  DFHPF18   PIC  X  VALUE  'F'.
  2679   02  DFHPF19   PIC  X  VALUE  'G'.
  2680   02  DFHPF20   PIC  X  VALUE  'H'.
  2681   02  DFHPF21   PIC  X  VALUE  'I'.
  2682*00039    02  DFHPF22   PIC  X  VALUE  ''.
  2683   02  DFHPF22   PIC  X  VALUE  '['.
  2684   02  DFHPF23   PIC  X  VALUE  '.'.
  2685   02  DFHPF24   PIC  X  VALUE  '<'.
  2686   02  DFHMSRE   PIC  X  VALUE  'X'.
  2687   02  DFHSTRF   PIC  X  VALUE  'h'.
  2688   02  DFHTRIG   PIC  X  VALUE  '"'.
  2689 01  FILLER    REDEFINES DFHAID.
  2690     12  FILLER              PIC X(8).
  2691     12  PF-VALUES           PIC X       OCCURS 2.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page  55
* EL156.cbl
  2693*    COPY EL156S.
  2694 01  EL156AI.
  2695     05  FILLER            PIC  X(0012).
  2696*    -------------------------------
  2697     05  RUNDTEAL PIC S9(0004) COMP.
  2698     05  RUNDTEAF PIC  X(0001).
  2699     05  FILLER REDEFINES RUNDTEAF.
  2700         10  RUNDTEAA PIC  X(0001).
  2701     05  RUNDTEAI PIC  X(0008).
  2702*    -------------------------------
  2703     05  RUNTIMAL PIC S9(0004) COMP.
  2704     05  RUNTIMAF PIC  X(0001).
  2705     05  FILLER REDEFINES RUNTIMAF.
  2706         10  RUNTIMAA PIC  X(0001).
  2707     05  RUNTIMAI PIC  X(0005).
  2708*    -------------------------------
  2709     05  SEQUL PIC S9(0004) COMP.
  2710     05  SEQUF PIC  X(0001).
  2711     05  FILLER REDEFINES SEQUF.
  2712         10  SEQUA PIC  X(0001).
  2713     05  SEQUI PIC  X(0010).
  2714*    -------------------------------
  2715     05  CLMNOL PIC S9(0004) COMP.
  2716     05  CLMNOF PIC  X(0001).
  2717     05  FILLER REDEFINES CLMNOF.
  2718         10  CLMNOA PIC  X(0001).
  2719     05  CLMNOI PIC  X(0007).
  2720*    -------------------------------
  2721     05  CARRL PIC S9(0004) COMP.
  2722     05  CARRF PIC  X(0001).
  2723     05  FILLER REDEFINES CARRF.
  2724         10  CARRA PIC  X(0001).
  2725     05  CARRI PIC  X(0001).
  2726*    -------------------------------
  2727     05  CERTNOL PIC S9(0004) COMP.
  2728     05  CERTNOF PIC  X(0001).
  2729     05  FILLER REDEFINES CERTNOF.
  2730         10  CERTNOA PIC  X(0001).
  2731     05  CERTNOI PIC  X(0010).
  2732*    -------------------------------
  2733     05  SUFXL PIC S9(0004) COMP.
  2734     05  SUFXF PIC  X(0001).
  2735     05  FILLER REDEFINES SUFXF.
  2736         10  SUFXA PIC  X(0001).
  2737     05  SUFXI PIC  X(0001).
  2738*    -------------------------------
  2739     05  CLMTYPL PIC S9(0004) COMP.
  2740     05  CLMTYPF PIC  X(0001).
  2741     05  FILLER REDEFINES CLMTYPF.
  2742         10  CLMTYPA PIC  X(0001).
  2743     05  CLMTYPI PIC  X(0006).
  2744*    -------------------------------
  2745     05  CLMSTATL PIC S9(0004) COMP.
  2746     05  CLMSTATF PIC  X(0001).
  2747     05  FILLER REDEFINES CLMSTATF.
  2748         10  CLMSTATA PIC  X(0001).
  2749     05  CLMSTATI PIC  X(0006).
  2750*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page  56
* EL156.cbl
  2751     05  LSTNMEL PIC S9(0004) COMP.
  2752     05  LSTNMEF PIC  X(0001).
  2753     05  FILLER REDEFINES LSTNMEF.
  2754         10  LSTNMEA PIC  X(0001).
  2755     05  LSTNMEI PIC  X(0015).
  2756*    -------------------------------
  2757     05  FSTNMEL PIC S9(0004) COMP.
  2758     05  FSTNMEF PIC  X(0001).
  2759     05  FILLER REDEFINES FSTNMEF.
  2760         10  FSTNMEA PIC  X(0001).
  2761     05  FSTNMEI PIC  X(0012).
  2762*    -------------------------------
  2763     05  MINITL PIC S9(0004) COMP.
  2764     05  MINITF PIC  X(0001).
  2765     05  FILLER REDEFINES MINITF.
  2766         10  MINITA PIC  X(0001).
  2767     05  MINITI PIC  X(0001).
  2768*    -------------------------------
  2769     05  PRIMHDGL PIC S9(0004) COMP.
  2770     05  PRIMHDGF PIC  X(0001).
  2771     05  FILLER REDEFINES PRIMHDGF.
  2772         10  PRIMHDGA PIC  X(0001).
  2773     05  PRIMHDGI PIC  X(0012).
  2774*    -------------------------------
  2775     05  PCERTNOL PIC S9(0004) COMP.
  2776     05  PCERTNOF PIC  X(0001).
  2777     05  FILLER REDEFINES PCERTNOF.
  2778         10  PCERTNOA PIC  X(0001).
  2779     05  PCERTNOI PIC  X(0010).
  2780*    -------------------------------
  2781     05  PSUFXL PIC S9(0004) COMP.
  2782     05  PSUFXF PIC  X(0001).
  2783     05  FILLER REDEFINES PSUFXF.
  2784         10  PSUFXA PIC  X(0001).
  2785     05  PSUFXI PIC  X(0001).
  2786*    -------------------------------
  2787     05  STATUSL PIC S9(0004) COMP.
  2788     05  STATUSF PIC  X(0001).
  2789     05  FILLER REDEFINES STATUSF.
  2790         10  STATUSA PIC  X(0001).
  2791     05  STATUSI PIC  X(0010).
  2792*    -------------------------------
  2793     05  LOANHL PIC S9(0004) COMP.
  2794     05  LOANHF PIC  X(0001).
  2795     05  FILLER REDEFINES LOANHF.
  2796         10  LOANHA PIC  X(0001).
  2797     05  LOANHI PIC  X(0014).
  2798*    -------------------------------
  2799     05  LOANNOL PIC S9(0004) COMP.
  2800     05  LOANNOF PIC  X(0001).
  2801     05  FILLER REDEFINES LOANNOF.
  2802         10  LOANNOA PIC  X(0001).
  2803     05  LOANNOI PIC  X(0025).
  2804*    -------------------------------
  2805     05  DUEDAYHL PIC S9(0004) COMP.
  2806     05  DUEDAYHF PIC  X(0001).
  2807     05  FILLER REDEFINES DUEDAYHF.
  2808         10  DUEDAYHA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page  57
* EL156.cbl
  2809     05  DUEDAYHI PIC  X(0008).
  2810*    -------------------------------
  2811     05  DUEDAYL PIC S9(0004) COMP.
  2812     05  DUEDAYF PIC  X(0001).
  2813     05  FILLER REDEFINES DUEDAYF.
  2814         10  DUEDAYA PIC  X(0001).
  2815     05  DUEDAYI PIC  X(0002).
  2816*    -------------------------------
  2817     05  ZINTHL PIC S9(0004) COMP.
  2818     05  ZINTHF PIC  X(0001).
  2819     05  FILLER REDEFINES ZINTHF.
  2820         10  ZINTHA PIC  X(0001).
  2821     05  ZINTHI PIC  X(0009).
  2822*    -------------------------------
  2823     05  ZINTL PIC S9(0004) COMP.
  2824     05  ZINTF PIC  X(0001).
  2825     05  FILLER REDEFINES ZINTF.
  2826         10  ZINTA PIC  X(0001).
  2827     05  ZINTI PIC  99V99999.
  2828*    -------------------------------
  2829     05  PTHRHDGL PIC S9(0004) COMP.
  2830     05  PTHRHDGF PIC  X(0001).
  2831     05  FILLER REDEFINES PTHRHDGF.
  2832         10  PTHRHDGA PIC  X(0001).
  2833     05  PTHRHDGI PIC  X(0014).
  2834*    -------------------------------
  2835     05  PDTHRUL PIC S9(0004) COMP.
  2836     05  PDTHRUF PIC  X(0001).
  2837     05  FILLER REDEFINES PDTHRUF.
  2838         10  PDTHRUA PIC  X(0001).
  2839     05  PDTHRUI PIC  X(0008).
  2840*    -------------------------------
  2841     05  TOTPAIDL PIC S9(0004) COMP.
  2842     05  TOTPAIDF PIC  X(0001).
  2843     05  FILLER REDEFINES TOTPAIDF.
  2844         10  TOTPAIDA PIC  X(0001).
  2845     05  TOTPAIDI PIC  X(0010).
  2846*    -------------------------------
  2847     05  COVERL PIC S9(0004) COMP.
  2848     05  COVERF PIC  X(0001).
  2849     05  FILLER REDEFINES COVERF.
  2850         10  COVERA PIC  X(0001).
  2851     05  COVERI PIC  X(0010).
  2852*    -------------------------------
  2853     05  INCURL PIC S9(0004) COMP.
  2854     05  INCURF PIC  X(0001).
  2855     05  FILLER REDEFINES INCURF.
  2856         10  INCURA PIC  X(0001).
  2857     05  INCURI PIC  X(0008).
  2858*    -------------------------------
  2859     05  LSTDTEL PIC S9(0004) COMP.
  2860     05  LSTDTEF PIC  X(0001).
  2861     05  FILLER REDEFINES LSTDTEF.
  2862         10  LSTDTEA PIC  X(0001).
  2863     05  LSTDTEI PIC  X(0008).
  2864*    -------------------------------
  2865     05  CRTSTATL PIC S9(0004) COMP.
  2866     05  CRTSTATF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page  58
* EL156.cbl
  2867     05  FILLER REDEFINES CRTSTATF.
  2868         10  CRTSTATA PIC  X(0001).
  2869     05  CRTSTATI PIC  X(0010).
  2870*    -------------------------------
  2871     05  EFFECTL PIC S9(0004) COMP.
  2872     05  EFFECTF PIC  X(0001).
  2873     05  FILLER REDEFINES EFFECTF.
  2874         10  EFFECTA PIC  X(0001).
  2875     05  EFFECTI PIC  X(0008).
  2876*    -------------------------------
  2877     05  TERMSL PIC S9(0004) COMP.
  2878     05  TERMSF PIC  X(0001).
  2879     05  FILLER REDEFINES TERMSF.
  2880         10  TERMSA PIC  X(0001).
  2881     05  TERMSI PIC  X(0011).
  2882*    -------------------------------
  2883     05  STACCTL PIC S9(0004) COMP.
  2884     05  STACCTF PIC  X(0001).
  2885     05  FILLER REDEFINES STACCTF.
  2886         10  STACCTA PIC  X(0001).
  2887     05  STACCTI PIC  X(0013).
  2888*    -------------------------------
  2889     05  EXPDTEHL PIC S9(0004) COMP.
  2890     05  EXPDTEHF PIC  X(0001).
  2891     05  FILLER REDEFINES EXPDTEHF.
  2892         10  EXPDTEHA PIC  X(0001).
  2893     05  EXPDTEHI PIC  X(0014).
  2894*    -------------------------------
  2895     05  EXPDTEL PIC S9(0004) COMP.
  2896     05  EXPDTEF PIC  X(0001).
  2897     05  FILLER REDEFINES EXPDTEF.
  2898         10  EXPDTEA PIC  X(0001).
  2899     05  EXPDTEI PIC  X(0008).
  2900*    -------------------------------
  2901     05  BENECAPL PIC S9(0004) COMP.
  2902     05  BENECAPF PIC  X(0001).
  2903     05  FILLER REDEFINES BENECAPF.
  2904         10  BENECAPA PIC  X(0001).
  2905     05  BENECAPI PIC  X(0013).
  2906*    -------------------------------
  2907     05  BENEL PIC S9(0004) COMP.
  2908     05  BENEF PIC  X(0001).
  2909     05  FILLER REDEFINES BENEF.
  2910         10  BENEA PIC  X(0001).
  2911     05  BENEI PIC  X(0009).
  2912*    -------------------------------
  2913     05  FORMTYPL PIC S9(0004) COMP.
  2914     05  FORMTYPF PIC  X(0001).
  2915     05  FILLER REDEFINES FORMTYPF.
  2916         10  FORMTYPA PIC  X(0001).
  2917     05  FORMTYPI PIC  X(0001).
  2918*    -------------------------------
  2919     05  PMTTYPEL PIC S9(0004) COMP.
  2920     05  PMTTYPEF PIC  X(0001).
  2921     05  FILLER REDEFINES PMTTYPEF.
  2922         10  PMTTYPEA PIC  X(0001).
  2923     05  PMTTYPEI PIC  X(0001).
  2924*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page  59
* EL156.cbl
  2925     05  PAYEEL PIC S9(0004) COMP.
  2926     05  PAYEEF PIC  X(0001).
  2927     05  FILLER REDEFINES PAYEEF.
  2928         10  PAYEEA PIC  X(0001).
  2929     05  PAYEEI PIC  X(0002).
  2930*    -------------------------------
  2931     05  CHECKNOL PIC S9(0004) COMP.
  2932     05  CHECKNOF PIC  X(0001).
  2933     05  FILLER REDEFINES CHECKNOF.
  2934         10  CHECKNOA PIC  X(0001).
  2935     05  CHECKNOI PIC  X(0007).
  2936*    -------------------------------
  2937     05  OFFLINEL PIC S9(0004) COMP.
  2938     05  OFFLINEF PIC  X(0001).
  2939     05  FILLER REDEFINES OFFLINEF.
  2940         10  OFFLINEA PIC  X(0001).
  2941     05  OFFLINEI PIC  X(0001).
  2942*    -------------------------------
  2943     05  HOLDTILL PIC S9(0004) COMP.
  2944     05  HOLDTILF PIC  X(0001).
  2945     05  FILLER REDEFINES HOLDTILF.
  2946         10  HOLDTILA PIC  X(0001).
  2947     05  HOLDTILI PIC  X(0008).
  2948*    -------------------------------
  2949     05  NOTE1L PIC S9(0004) COMP.
  2950     05  NOTE1F PIC  X(0001).
  2951     05  FILLER REDEFINES NOTE1F.
  2952         10  NOTE1A PIC  X(0001).
  2953     05  NOTE1I PIC  X(0060).
  2954*    -------------------------------
  2955     05  ITRB1L PIC S9(0004) COMP.
  2956     05  ITRB1F PIC  X(0001).
  2957     05  FILLER REDEFINES ITRB1F.
  2958         10  ITRB1A PIC  X(0001).
  2959     05  ITRB1I PIC  X(0008).
  2960*    -------------------------------
  2961     05  NOTE2L PIC S9(0004) COMP.
  2962     05  NOTE2F PIC  X(0001).
  2963     05  FILLER REDEFINES NOTE2F.
  2964         10  NOTE2A PIC  X(0001).
  2965     05  NOTE2I PIC  X(0060).
  2966*    -------------------------------
  2967     05  ITRB2L PIC S9(0004) COMP.
  2968     05  ITRB2F PIC  X(0001).
  2969     05  FILLER REDEFINES ITRB2F.
  2970         10  ITRB2A PIC  X(0001).
  2971     05  ITRB2I PIC  X(0010).
  2972*    -------------------------------
  2973     05  EOBYNL PIC S9(0004) COMP.
  2974     05  EOBYNF PIC  X(0001).
  2975     05  FILLER REDEFINES EOBYNF.
  2976         10  EOBYNA PIC  X(0001).
  2977     05  EOBYNI PIC  X(0001).
  2978*    -------------------------------
  2979     05  CLMFMYNL PIC S9(0004) COMP.
  2980     05  CLMFMYNF PIC  X(0001).
  2981     05  FILLER REDEFINES CLMFMYNF.
  2982         10  CLMFMYNA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page  60
* EL156.cbl
  2983     05  CLMFMYNI PIC  X(0001).
  2984*    -------------------------------
  2985     05  SURVYYNL PIC S9(0004) COMP.
  2986     05  SURVYYNF PIC  X(0001).
  2987     05  FILLER REDEFINES SURVYYNF.
  2988         10  SURVYYNA PIC  X(0001).
  2989     05  SURVYYNI PIC  X(0001).
  2990*    -------------------------------
  2991     05  SPRELYNL PIC S9(0004) COMP.
  2992     05  SPRELYNF PIC  X(0001).
  2993     05  FILLER REDEFINES SPRELYNF.
  2994         10  SPRELYNA PIC  X(0001).
  2995     05  SPRELYNI PIC  X(0001).
  2996*    -------------------------------
  2997     05  PINTHL PIC S9(0004) COMP.
  2998     05  PINTHF PIC  X(0001).
  2999     05  FILLER REDEFINES PINTHF.
  3000         10  PINTHA PIC  X(0001).
  3001     05  PINTHI PIC  X(0004).
  3002*    -------------------------------
  3003     05  PINTL PIC S9(0004) COMP.
  3004     05  PINTF PIC  X(0001).
  3005     05  FILLER REDEFINES PINTF.
  3006         10  PINTA PIC  X(0001).
  3007     05  PINTI PIC  X(0008).
  3008*    -------------------------------
  3009     05  ITRBYNL PIC S9(0004) COMP.
  3010     05  ITRBYNF PIC  X(0001).
  3011     05  FILLER REDEFINES ITRBYNF.
  3012         10  ITRBYNA PIC  X(0001).
  3013     05  ITRBYNI PIC  X(0001).
  3014*    -------------------------------
  3015     05  PROOFDTL PIC S9(0004) COMP.
  3016     05  PROOFDTF PIC  X(0001).
  3017     05  FILLER REDEFINES PROOFDTF.
  3018         10  PROOFDTA PIC  X(0001).
  3019     05  PROOFDTI PIC  X(0008).
  3020*    -------------------------------
  3021     05  AIGFRMHL PIC S9(0004) COMP.
  3022     05  AIGFRMHF PIC  X(0001).
  3023     05  FILLER REDEFINES AIGFRMHF.
  3024         10  AIGFRMHA PIC  X(0001).
  3025     05  AIGFRMHI PIC  X(0012).
  3026*    -------------------------------
  3027     05  AIGFROML PIC S9(0004) COMP.
  3028     05  AIGFROMF PIC  X(0001).
  3029     05  FILLER REDEFINES AIGFROMF.
  3030         10  AIGFROMA PIC  X(0001).
  3031     05  AIGFROMI PIC  X(0008).
  3032*    -------------------------------
  3033     05  PMTHDGAL PIC S9(0004) COMP.
  3034     05  PMTHDGAF PIC  X(0001).
  3035     05  FILLER REDEFINES PMTHDGAF.
  3036         10  PMTHDGAA PIC  X(0001).
  3037     05  PMTHDGAI PIC  X(0066).
  3038*    -------------------------------
  3039     05  EPYFROML PIC S9(0004) COMP.
  3040     05  EPYFROMF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page  61
* EL156.cbl
  3041     05  FILLER REDEFINES EPYFROMF.
  3042         10  EPYFROMA PIC  X(0001).
  3043     05  EPYFROMI PIC  X(0008).
  3044*    -------------------------------
  3045     05  EPYTHRUL PIC S9(0004) COMP.
  3046     05  EPYTHRUF PIC  X(0001).
  3047     05  FILLER REDEFINES EPYTHRUF.
  3048         10  EPYTHRUA PIC  X(0001).
  3049     05  EPYTHRUI PIC  X(0008).
  3050*    -------------------------------
  3051     05  EDAYSL PIC S9(0004) COMP.
  3052     05  EDAYSF PIC  X(0001).
  3053     05  FILLER REDEFINES EDAYSF.
  3054         10  EDAYSA PIC  X(0001).
  3055     05  EDAYSI PIC  S9(6).
  3056*    -------------------------------
  3057     05  EPYAMTL PIC S9(0004) COMP.
  3058     05  EPYAMTF PIC  X(0001).
  3059     05  FILLER REDEFINES EPYAMTF.
  3060         10  EPYAMTA PIC  X(0001).
  3061     05  EPYAMTI PIC  S9(8)V99.
  3062*    -------------------------------
  3063     05  ERESVL PIC S9(0004) COMP.
  3064     05  ERESVF PIC  X(0001).
  3065     05  FILLER REDEFINES ERESVF.
  3066         10  ERESVA PIC  X(0001).
  3067     05  ERESVI PIC  S9(7)V99.
  3068*    -------------------------------
  3069     05  ETYPEL PIC S9(0004) COMP.
  3070     05  ETYPEF PIC  X(0001).
  3071     05  FILLER REDEFINES ETYPEF.
  3072         10  ETYPEA PIC  X(0001).
  3073     05  ETYPEI PIC  X(0001).
  3074*    -------------------------------
  3075     05  EEXPENSL PIC S9(0004) COMP.
  3076     05  EEXPENSF PIC  X(0001).
  3077     05  FILLER REDEFINES EEXPENSF.
  3078         10  EEXPENSA PIC  X(0001).
  3079     05  EEXPENSI PIC  9(6)V99.
  3080*    -------------------------------
  3081     05  CPYFROML PIC S9(0004) COMP.
  3082     05  CPYFROMF PIC  X(0001).
  3083     05  FILLER REDEFINES CPYFROMF.
  3084         10  CPYFROMA PIC  X(0001).
  3085     05  CPYFROMI PIC  X(0008).
  3086*    -------------------------------
  3087     05  CPYTHRUL PIC S9(0004) COMP.
  3088     05  CPYTHRUF PIC  X(0001).
  3089     05  FILLER REDEFINES CPYTHRUF.
  3090         10  CPYTHRUA PIC  X(0001).
  3091     05  CPYTHRUI PIC  X(0008).
  3092*    -------------------------------
  3093     05  CDAYSL PIC S9(0004) COMP.
  3094     05  CDAYSF PIC  X(0001).
  3095     05  FILLER REDEFINES CDAYSF.
  3096         10  CDAYSA PIC  X(0001).
  3097     05  CDAYSI PIC  9(6).
  3098*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page  62
* EL156.cbl
  3099     05  CPYAMTL PIC S9(0004) COMP.
  3100     05  CPYAMTF PIC  X(0001).
  3101     05  FILLER REDEFINES CPYAMTF.
  3102         10  CPYAMTA PIC  X(0001).
  3103     05  CPYAMTI PIC  S9(8)V99.
  3104*    -------------------------------
  3105     05  CRESVL PIC S9(0004) COMP.
  3106     05  CRESVF PIC  X(0001).
  3107     05  FILLER REDEFINES CRESVF.
  3108         10  CRESVA PIC  X(0001).
  3109     05  CRESVI PIC  9(6)V99.
  3110*    -------------------------------
  3111     05  CEXPENSL PIC S9(0004) COMP.
  3112     05  CEXPENSF PIC  X(0001).
  3113     05  FILLER REDEFINES CEXPENSF.
  3114         10  CEXPENSA PIC  X(0001).
  3115     05  CEXPENSI PIC  9(6)V99.
  3116*    -------------------------------
  3117     05  ERRMSG0L PIC S9(0004) COMP.
  3118     05  ERRMSG0F PIC  X(0001).
  3119     05  FILLER REDEFINES ERRMSG0F.
  3120         10  ERRMSG0A PIC  X(0001).
  3121     05  ERRMSG0I PIC  X(0072).
  3122*    -------------------------------
  3123     05  ERRMSG1L PIC S9(0004) COMP.
  3124     05  ERRMSG1F PIC  X(0001).
  3125     05  FILLER REDEFINES ERRMSG1F.
  3126         10  ERRMSG1A PIC  X(0001).
  3127     05  ERRMSG1I PIC  X(0072).
  3128*    -------------------------------
  3129     05  ERRMSG2L PIC S9(0004) COMP.
  3130     05  ERRMSG2F PIC  X(0001).
  3131     05  FILLER REDEFINES ERRMSG2F.
  3132         10  ERRMSG2A PIC  X(0001).
  3133     05  ERRMSG2I PIC  X(0072).
  3134*    -------------------------------
  3135     05  ENTERPFL PIC S9(0004) COMP.
  3136     05  ENTERPFF PIC  X(0001).
  3137     05  FILLER REDEFINES ENTERPFF.
  3138         10  ENTERPFA PIC  X(0001).
  3139     05  ENTERPFI PIC  99.
  3140*    -------------------------------
  3141     05  PF6TITL PIC S9(0004) COMP.
  3142     05  PF6TITF PIC  X(0001).
  3143     05  FILLER REDEFINES PF6TITF.
  3144         10  PF6TITA PIC  X(0001).
  3145     05  PF6TITI PIC  X(0016).
  3146 01  EL156AO REDEFINES EL156AI.
  3147     05  FILLER            PIC  X(0012).
  3148*    -------------------------------
  3149     05  FILLER            PIC  X(0003).
  3150     05  RUNDTEAO PIC  X(0008).
  3151*    -------------------------------
  3152     05  FILLER            PIC  X(0003).
  3153     05  RUNTIMAO PIC  99.99.
  3154*    -------------------------------
  3155     05  FILLER            PIC  X(0003).
  3156     05  SEQUO PIC  X(0010).
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page  63
* EL156.cbl
  3157*    -------------------------------
  3158     05  FILLER            PIC  X(0003).
  3159     05  CLMNOO PIC  X(0007).
  3160*    -------------------------------
  3161     05  FILLER            PIC  X(0003).
  3162     05  CARRO PIC  X(0001).
  3163*    -------------------------------
  3164     05  FILLER            PIC  X(0003).
  3165     05  CERTNOO PIC  X(0010).
  3166*    -------------------------------
  3167     05  FILLER            PIC  X(0003).
  3168     05  SUFXO PIC  X(0001).
  3169*    -------------------------------
  3170     05  FILLER            PIC  X(0003).
  3171     05  CLMTYPO PIC  X(0006).
  3172*    -------------------------------
  3173     05  FILLER            PIC  X(0003).
  3174     05  CLMSTATO PIC  X(0006).
  3175*    -------------------------------
  3176     05  FILLER            PIC  X(0003).
  3177     05  LSTNMEO PIC  X(0015).
  3178*    -------------------------------
  3179     05  FILLER            PIC  X(0003).
  3180     05  FSTNMEO PIC  X(0012).
  3181*    -------------------------------
  3182     05  FILLER            PIC  X(0003).
  3183     05  MINITO PIC  X(0001).
  3184*    -------------------------------
  3185     05  FILLER            PIC  X(0003).
  3186     05  PRIMHDGO PIC  X(0012).
  3187*    -------------------------------
  3188     05  FILLER            PIC  X(0003).
  3189     05  PCERTNOO PIC  X(0010).
  3190*    -------------------------------
  3191     05  FILLER            PIC  X(0003).
  3192     05  PSUFXO PIC  X(0001).
  3193*    -------------------------------
  3194     05  FILLER            PIC  X(0003).
  3195     05  STATUSO PIC  X(0010).
  3196*    -------------------------------
  3197     05  FILLER            PIC  X(0003).
  3198     05  LOANHO PIC  X(0014).
  3199*    -------------------------------
  3200     05  FILLER            PIC  X(0003).
  3201     05  LOANNOO PIC  X(0025).
  3202*    -------------------------------
  3203     05  FILLER            PIC  X(0003).
  3204     05  DUEDAYHO PIC  X(0008).
  3205*    -------------------------------
  3206     05  FILLER            PIC  X(0003).
  3207     05  DUEDAYO PIC  X(0002).
  3208*    -------------------------------
  3209     05  FILLER            PIC  X(0003).
  3210     05  ZINTHO PIC  X(0009).
  3211*    -------------------------------
  3212     05  FILLER            PIC  X(0003).
  3213     05  ZINTO PIC  9.99999.
  3214*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page  64
* EL156.cbl
  3215     05  FILLER            PIC  X(0003).
  3216     05  PTHRHDGO PIC  X(0014).
  3217*    -------------------------------
  3218     05  FILLER            PIC  X(0003).
  3219     05  PDTHRUO PIC  X(0008).
  3220*    -------------------------------
  3221     05  FILLER            PIC  X(0003).
  3222     05  TOTPAIDO PIC  Z(6).99-.
  3223*    -------------------------------
  3224     05  FILLER            PIC  X(0003).
  3225     05  COVERO PIC  X(0010).
  3226*    -------------------------------
  3227     05  FILLER            PIC  X(0003).
  3228     05  INCURO PIC  X(0008).
  3229*    -------------------------------
  3230     05  FILLER            PIC  X(0003).
  3231     05  LSTDTEO PIC  X(0008).
  3232*    -------------------------------
  3233     05  FILLER            PIC  X(0003).
  3234     05  CRTSTATO PIC  X(0010).
  3235*    -------------------------------
  3236     05  FILLER            PIC  X(0003).
  3237     05  EFFECTO PIC  X(0008).
  3238*    -------------------------------
  3239     05  FILLER            PIC  X(0003).
  3240     05  TERMSO PIC  X(0011).
  3241*    -------------------------------
  3242     05  FILLER            PIC  X(0003).
  3243     05  STACCTO PIC  X(0013).
  3244*    -------------------------------
  3245     05  FILLER            PIC  X(0003).
  3246     05  EXPDTEHO PIC  X(0014).
  3247*    -------------------------------
  3248     05  FILLER            PIC  X(0003).
  3249     05  EXPDTEO PIC  X(0008).
  3250*    -------------------------------
  3251     05  FILLER            PIC  X(0003).
  3252     05  BENECAPO PIC  X(0013).
  3253*    -------------------------------
  3254     05  FILLER            PIC  X(0003).
  3255     05  BENEO PIC  Z(6).99.
  3256*    -------------------------------
  3257     05  FILLER            PIC  X(0003).
  3258     05  FORMTYPO PIC  X(0001).
  3259*    -------------------------------
  3260     05  FILLER            PIC  X(0003).
  3261     05  PMTTYPEO PIC  X(0001).
  3262*    -------------------------------
  3263     05  FILLER            PIC  X(0003).
  3264     05  PAYEEO PIC  X(0002).
  3265*    -------------------------------
  3266     05  FILLER            PIC  X(0003).
  3267     05  CHECKNOO PIC  X(0007).
  3268*    -------------------------------
  3269     05  FILLER            PIC  X(0003).
  3270     05  OFFLINEO PIC  X(0001).
  3271*    -------------------------------
  3272     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page  65
* EL156.cbl
  3273     05  HOLDTILO PIC  99B99B99.
  3274*    -------------------------------
  3275     05  FILLER            PIC  X(0003).
  3276     05  NOTE1O PIC  X(0060).
  3277*    -------------------------------
  3278     05  FILLER            PIC  X(0003).
  3279     05  ITRB1O PIC  X(0008).
  3280*    -------------------------------
  3281     05  FILLER            PIC  X(0003).
  3282     05  NOTE2O PIC  X(0060).
  3283*    -------------------------------
  3284     05  FILLER            PIC  X(0003).
  3285     05  ITRB2O PIC  X(0010).
  3286*    -------------------------------
  3287     05  FILLER            PIC  X(0003).
  3288     05  EOBYNO PIC  X(0001).
  3289*    -------------------------------
  3290     05  FILLER            PIC  X(0003).
  3291     05  CLMFMYNO PIC  X(0001).
  3292*    -------------------------------
  3293     05  FILLER            PIC  X(0003).
  3294     05  SURVYYNO PIC  X(0001).
  3295*    -------------------------------
  3296     05  FILLER            PIC  X(0003).
  3297     05  SPRELYNO PIC  X(0001).
  3298*    -------------------------------
  3299     05  FILLER            PIC  X(0003).
  3300     05  PINTHO PIC  X(0004).
  3301*    -------------------------------
  3302     05  FILLER            PIC  X(0003).
  3303     05  PINTO PIC  Z,ZZ9.99.
  3304*    -------------------------------
  3305     05  FILLER            PIC  X(0003).
  3306     05  ITRBYNO PIC  X(0001).
  3307*    -------------------------------
  3308     05  FILLER            PIC  X(0003).
  3309     05  PROOFDTO PIC  99B99B99.
  3310*    -------------------------------
  3311     05  FILLER            PIC  X(0003).
  3312     05  AIGFRMHO PIC  X(0012).
  3313*    -------------------------------
  3314     05  FILLER            PIC  X(0003).
  3315     05  AIGFROMO PIC  99B99B99.
  3316*    -------------------------------
  3317     05  FILLER            PIC  X(0003).
  3318     05  PMTHDGAO PIC  X(0066).
  3319*    -------------------------------
  3320     05  FILLER            PIC  X(0003).
  3321     05  EPYFROMO PIC  99B99B99.
  3322*    -------------------------------
  3323     05  FILLER            PIC  X(0003).
  3324     05  EPYTHRUO PIC  99B99B99.
  3325*    -------------------------------
  3326     05  FILLER            PIC  X(0003).
  3327     05  EDAYSO PIC  Z(4)9-.
  3328*    -------------------------------
  3329     05  FILLER            PIC  X(0003).
  3330     05  EPYAMTO PIC  Z(6).99-.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page  66
* EL156.cbl
  3331*    -------------------------------
  3332     05  FILLER            PIC  X(0003).
  3333     05  ERESVO PIC  Z(5).99-.
  3334*    -------------------------------
  3335     05  FILLER            PIC  X(0003).
  3336     05  ETYPEO PIC  X(0001).
  3337*    -------------------------------
  3338     05  FILLER            PIC  X(0003).
  3339     05  EEXPENSO PIC  Z(5).99.
  3340*    -------------------------------
  3341     05  FILLER            PIC  X(0003).
  3342     05  CPYFROMO PIC  99B99B99.
  3343*    -------------------------------
  3344     05  FILLER            PIC  X(0003).
  3345     05  CPYTHRUO PIC  99B99B99.
  3346*    -------------------------------
  3347     05  FILLER            PIC  X(0003).
  3348     05  CDAYSO PIC  Z(4)9-.
  3349*    -------------------------------
  3350     05  FILLER            PIC  X(0003).
  3351     05  CPYAMTO PIC  Z(6).99-.
  3352*    -------------------------------
  3353     05  FILLER            PIC  X(0003).
  3354     05  CRESVO PIC  Z(5).99.
  3355*    -------------------------------
  3356     05  FILLER            PIC  X(0003).
  3357     05  CEXPENSO PIC  Z(5).99.
  3358*    -------------------------------
  3359     05  FILLER            PIC  X(0003).
  3360     05  ERRMSG0O PIC  X(0072).
  3361*    -------------------------------
  3362     05  FILLER            PIC  X(0003).
  3363     05  ERRMSG1O PIC  X(0072).
  3364*    -------------------------------
  3365     05  FILLER            PIC  X(0003).
  3366     05  ERRMSG2O PIC  X(0072).
  3367*    -------------------------------
  3368     05  FILLER            PIC  X(0003).
  3369     05  ENTERPFO PIC  X(0002).
  3370*    -------------------------------
  3371     05  FILLER            PIC  X(0003).
  3372     05  PF6TITO PIC  X(0016).
  3373*    -------------------------------
  3374 01  EL156BI REDEFINES EL156AI.
  3375     05  FILLER            PIC  X(0012).
  3376*    -------------------------------
  3377     05  RUNDTEBL PIC S9(0004) COMP.
  3378     05  RUNDTEBF PIC  X(0001).
  3379     05  FILLER REDEFINES RUNDTEBF.
  3380         10  RUNDTEBA PIC  X(0001).
  3381     05  RUNDTEBI PIC  X(0008).
  3382*    -------------------------------
  3383     05  RUNTIMBL PIC S9(0004) COMP.
  3384     05  RUNTIMBF PIC  X(0001).
  3385     05  FILLER REDEFINES RUNTIMBF.
  3386         10  RUNTIMBA PIC  X(0001).
  3387     05  RUNTIMBI PIC  X(0005).
  3388*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page  67
* EL156.cbl
  3389     05  PAYDTBL PIC S9(0004) COMP.
  3390     05  PAYDTBF PIC  X(0001).
  3391     05  FILLER REDEFINES PAYDTBF.
  3392         10  PAYDTBA PIC  X(0001).
  3393     05  PAYDTBI PIC  X(0008).
  3394*    -------------------------------
  3395     05  PAYTYPBL PIC S9(0004) COMP.
  3396     05  PAYTYPBF PIC  X(0001).
  3397     05  FILLER REDEFINES PAYTYPBF.
  3398         10  PAYTYPBA PIC  X(0001).
  3399     05  PAYTYPBI PIC  X(0015).
  3400*    -------------------------------
  3401     05  PAYAMTBL PIC S9(0004) COMP.
  3402     05  PAYAMTBF PIC  X(0001).
  3403     05  FILLER REDEFINES PAYAMTBF.
  3404         10  PAYAMTBA PIC  X(0001).
  3405     05  PAYAMTBI PIC  X(0011).
  3406*    -------------------------------
  3407     05  LOANHBL PIC S9(0004) COMP.
  3408     05  LOANHBF PIC  X(0001).
  3409     05  FILLER REDEFINES LOANHBF.
  3410         10  LOANHBA PIC  X(0001).
  3411     05  LOANHBI PIC  X(0012).
  3412*    -------------------------------
  3413     05  LOANNBL PIC S9(0004) COMP.
  3414     05  LOANNBF PIC  X(0001).
  3415     05  FILLER REDEFINES LOANNBF.
  3416         10  LOANNBA PIC  X(0001).
  3417     05  LOANNBI PIC  X(0025).
  3418*    -------------------------------
  3419     05  CKNUMHDL PIC S9(0004) COMP.
  3420     05  CKNUMHDF PIC  X(0001).
  3421     05  FILLER REDEFINES CKNUMHDF.
  3422         10  CKNUMHDA PIC  X(0001).
  3423     05  CKNUMHDI PIC  X(0012).
  3424*    -------------------------------
  3425     05  CKNUMBL PIC S9(0004) COMP.
  3426     05  CKNUMBF PIC  X(0001).
  3427     05  FILLER REDEFINES CKNUMBF.
  3428         10  CKNUMBA PIC  X(0001).
  3429     05  CKNUMBI PIC  X(0007).
  3430*    -------------------------------
  3431     05  AGTHDGL PIC S9(0004) COMP.
  3432     05  AGTHDGF PIC  X(0001).
  3433     05  FILLER REDEFINES AGTHDGF.
  3434         10  AGTHDGA PIC  X(0001).
  3435     05  AGTHDGI PIC  X(0016).
  3436*    -------------------------------
  3437     05  NAMEBL PIC S9(0004) COMP.
  3438     05  NAMEBF PIC  X(0001).
  3439     05  FILLER REDEFINES NAMEBF.
  3440         10  NAMEBA PIC  X(0001).
  3441     05  NAMEBI PIC  X(0030).
  3442*    -------------------------------
  3443     05  NAMEB2L PIC S9(0004) COMP.
  3444     05  NAMEB2F PIC  X(0001).
  3445     05  FILLER REDEFINES NAMEB2F.
  3446         10  NAMEB2A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page  68
* EL156.cbl
  3447     05  NAMEB2I PIC  X(0030).
  3448*    -------------------------------
  3449     05  ADDR1BL PIC S9(0004) COMP.
  3450     05  ADDR1BF PIC  X(0001).
  3451     05  FILLER REDEFINES ADDR1BF.
  3452         10  ADDR1BA PIC  X(0001).
  3453     05  ADDR1BI PIC  X(0030).
  3454*    -------------------------------
  3455     05  ADDR1B2L PIC S9(0004) COMP.
  3456     05  ADDR1B2F PIC  X(0001).
  3457     05  FILLER REDEFINES ADDR1B2F.
  3458         10  ADDR1B2A PIC  X(0001).
  3459     05  ADDR1B2I PIC  X(0030).
  3460*    -------------------------------
  3461     05  ADDR2BL PIC S9(0004) COMP.
  3462     05  ADDR2BF PIC  X(0001).
  3463     05  FILLER REDEFINES ADDR2BF.
  3464         10  ADDR2BA PIC  X(0001).
  3465     05  ADDR2BI PIC  X(0030).
  3466*    -------------------------------
  3467     05  ADDR2B2L PIC S9(0004) COMP.
  3468     05  ADDR2B2F PIC  X(0001).
  3469     05  FILLER REDEFINES ADDR2B2F.
  3470         10  ADDR2B2A PIC  X(0001).
  3471     05  ADDR2B2I PIC  X(0030).
  3472*    -------------------------------
  3473     05  CITYSTBL PIC S9(0004) COMP.
  3474     05  CITYSTBF PIC  X(0001).
  3475     05  FILLER REDEFINES CITYSTBF.
  3476         10  CITYSTBA PIC  X(0001).
  3477     05  CITYSTBI PIC  X(0030).
  3478*    -------------------------------
  3479     05  CITYST2L PIC S9(0004) COMP.
  3480     05  CITYST2F PIC  X(0001).
  3481     05  FILLER REDEFINES CITYST2F.
  3482         10  CITYST2A PIC  X(0001).
  3483     05  CITYST2I PIC  X(0030).
  3484*    -------------------------------
  3485     05  ZIPBL PIC S9(0004) COMP.
  3486     05  ZIPBF PIC  X(0001).
  3487     05  FILLER REDEFINES ZIPBF.
  3488         10  ZIPBA PIC  X(0001).
  3489     05  ZIPBI PIC  X(0009).
  3490*    -------------------------------
  3491     05  ZIPB2L PIC S9(0004) COMP.
  3492     05  ZIPB2F PIC  X(0001).
  3493     05  FILLER REDEFINES ZIPB2F.
  3494         10  ZIPB2A PIC  X(0001).
  3495     05  ZIPB2I PIC  X(0009).
  3496*    -------------------------------
  3497     05  INTHDBL PIC S9(0004) COMP.
  3498     05  INTHDBF PIC  X(0001).
  3499     05  FILLER REDEFINES INTHDBF.
  3500         10  INTHDBA PIC  X(0001).
  3501     05  INTHDBI PIC  X(0012).
  3502*    -------------------------------
  3503     05  INTAMTBL PIC S9(0004) COMP.
  3504     05  INTAMTBF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page  69
* EL156.cbl
  3505     05  FILLER REDEFINES INTAMTBF.
  3506         10  INTAMTBA PIC  X(0001).
  3507     05  INTAMTBI PIC  X(0011).
  3508*    -------------------------------
  3509     05  PMTHDGBL PIC S9(0004) COMP.
  3510     05  PMTHDGBF PIC  X(0001).
  3511     05  FILLER REDEFINES PMTHDGBF.
  3512         10  PMTHDGBA PIC  X(0001).
  3513     05  PMTHDGBI PIC  X(0034).
  3514*    -------------------------------
  3515     05  CLMNOBL PIC S9(0004) COMP.
  3516     05  CLMNOBF PIC  X(0001).
  3517     05  FILLER REDEFINES CLMNOBF.
  3518         10  CLMNOBA PIC  X(0001).
  3519     05  CLMNOBI PIC  X(0007).
  3520*    -------------------------------
  3521     05  CARRBL PIC S9(0004) COMP.
  3522     05  CARRBF PIC  X(0001).
  3523     05  FILLER REDEFINES CARRBF.
  3524         10  CARRBA PIC  X(0001).
  3525     05  CARRBI PIC  X(0001).
  3526*    -------------------------------
  3527     05  CERTNOBL PIC S9(0004) COMP.
  3528     05  CERTNOBF PIC  X(0001).
  3529     05  FILLER REDEFINES CERTNOBF.
  3530         10  CERTNOBA PIC  X(0001).
  3531     05  CERTNOBI PIC  X(0010).
  3532*    -------------------------------
  3533     05  SUFXBL PIC S9(0004) COMP.
  3534     05  SUFXBF PIC  X(0001).
  3535     05  FILLER REDEFINES SUFXBF.
  3536         10  SUFXBA PIC  X(0001).
  3537     05  SUFXBI PIC  X(0001).
  3538*    -------------------------------
  3539     05  CLMTYPBL PIC S9(0004) COMP.
  3540     05  CLMTYPBF PIC  X(0001).
  3541     05  FILLER REDEFINES CLMTYPBF.
  3542         10  CLMTYPBA PIC  X(0001).
  3543     05  CLMTYPBI PIC  X(0006).
  3544*    -------------------------------
  3545     05  INCURBL PIC S9(0004) COMP.
  3546     05  INCURBF PIC  X(0001).
  3547     05  FILLER REDEFINES INCURBF.
  3548         10  INCURBA PIC  X(0001).
  3549     05  INCURBI PIC  X(0008).
  3550*    -------------------------------
  3551     05  PYFROMBL PIC S9(0004) COMP.
  3552     05  PYFROMBF PIC  X(0001).
  3553     05  FILLER REDEFINES PYFROMBF.
  3554         10  PYFROMBA PIC  X(0001).
  3555     05  PYFROMBI PIC  X(0008).
  3556*    -------------------------------
  3557     05  PYTHRUBL PIC S9(0004) COMP.
  3558     05  PYTHRUBF PIC  X(0001).
  3559     05  FILLER REDEFINES PYTHRUBF.
  3560         10  PYTHRUBA PIC  X(0001).
  3561     05  PYTHRUBI PIC  X(0008).
  3562*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page  70
* EL156.cbl
  3563     05  DAYSBL PIC S9(0004) COMP.
  3564     05  DAYSBF PIC  X(0001).
  3565     05  FILLER REDEFINES DAYSBF.
  3566         10  DAYSBA PIC  X(0001).
  3567     05  DAYSBI PIC  X(0005).
  3568*    -------------------------------
  3569     05  BYBL PIC S9(0004) COMP.
  3570     05  BYBF PIC  X(0001).
  3571     05  FILLER REDEFINES BYBF.
  3572         10  BYBA PIC  X(0001).
  3573     05  BYBI PIC  X(0004).
  3574*    -------------------------------
  3575     05  PROOFDBL PIC S9(0004) COMP.
  3576     05  PROOFDBF PIC  X(0001).
  3577     05  FILLER REDEFINES PROOFDBF.
  3578         10  PROOFDBA PIC  X(0001).
  3579     05  PROOFDBI PIC  X(0008).
  3580*    -------------------------------
  3581     05  ACCTBL PIC S9(0004) COMP.
  3582     05  ACCTBF PIC  X(0001).
  3583     05  FILLER REDEFINES ACCTBF.
  3584         10  ACCTBA PIC  X(0001).
  3585     05  ACCTBI PIC  X(0010).
  3586*    -------------------------------
  3587     05  STATEBL PIC S9(0004) COMP.
  3588     05  STATEBF PIC  X(0001).
  3589     05  FILLER REDEFINES STATEBF.
  3590         10  STATEBA PIC  X(0001).
  3591     05  STATEBI PIC  X(0002).
  3592*    -------------------------------
  3593     05  GROUPBL PIC S9(0004) COMP.
  3594     05  GROUPBF PIC  X(0001).
  3595     05  FILLER REDEFINES GROUPBF.
  3596         10  GROUPBA PIC  X(0001).
  3597     05  GROUPBI PIC  X(0006).
  3598*    -------------------------------
  3599     05  ACARRBL PIC S9(0004) COMP.
  3600     05  ACARRBF PIC  X(0001).
  3601     05  FILLER REDEFINES ACARRBF.
  3602         10  ACARRBA PIC  X(0001).
  3603     05  ACARRBI PIC  X(0001).
  3604*    -------------------------------
  3605     05  ACCTNMBL PIC S9(0004) COMP.
  3606     05  ACCTNMBF PIC  X(0001).
  3607     05  FILLER REDEFINES ACCTNMBF.
  3608         10  ACCTNMBA PIC  X(0001).
  3609     05  ACCTNMBI PIC  X(0030).
  3610*    -------------------------------
  3611     05  UNDISBL PIC S9(0004) COMP.
  3612     05  UNDISBF PIC  X(0001).
  3613     05  FILLER REDEFINES UNDISBF.
  3614         10  UNDISBA PIC  X(0001).
  3615     05  UNDISBI PIC  X(0010).
  3616*    -------------------------------
  3617     05  RATEBL PIC S9(0004) COMP.
  3618     05  RATEBF PIC  X(0001).
  3619     05  FILLER REDEFINES RATEBF.
  3620         10  RATEBA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page  71
* EL156.cbl
  3621     05  RATEBI PIC  X(0006).
  3622*    -------------------------------
  3623     05  ERMSG1BL PIC S9(0004) COMP.
  3624     05  ERMSG1BF PIC  X(0001).
  3625     05  FILLER REDEFINES ERMSG1BF.
  3626         10  ERMSG1BA PIC  X(0001).
  3627     05  ERMSG1BI PIC  X(0072).
  3628*    -------------------------------
  3629     05  ENTPFBL PIC S9(0004) COMP.
  3630     05  ENTPFBF PIC  X(0001).
  3631     05  FILLER REDEFINES ENTPFBF.
  3632         10  ENTPFBA PIC  X(0001).
  3633     05  ENTPFBI PIC  99.
  3634 01  EL156BO REDEFINES EL156AI.
  3635     05  FILLER            PIC  X(0012).
  3636*    -------------------------------
  3637     05  FILLER            PIC  X(0003).
  3638     05  RUNDTEBO PIC  X(0008).
  3639*    -------------------------------
  3640     05  FILLER            PIC  X(0003).
  3641     05  RUNTIMBO PIC  99.99.
  3642*    -------------------------------
  3643     05  FILLER            PIC  X(0003).
  3644     05  PAYDTBO PIC  99B99B99.
  3645*    -------------------------------
  3646     05  FILLER            PIC  X(0003).
  3647     05  PAYTYPBO PIC  X(0015).
  3648*    -------------------------------
  3649     05  FILLER            PIC  X(0003).
  3650     05  PAYAMTBO PIC  ZZZZ,ZZ9.99.
  3651*    -------------------------------
  3652     05  FILLER            PIC  X(0003).
  3653     05  LOANHBO PIC  X(0012).
  3654*    -------------------------------
  3655     05  FILLER            PIC  X(0003).
  3656     05  LOANNBO PIC  X(0025).
  3657*    -------------------------------
  3658     05  FILLER            PIC  X(0003).
  3659     05  CKNUMHDO PIC  X(0012).
  3660*    -------------------------------
  3661     05  FILLER            PIC  X(0003).
  3662     05  CKNUMBO PIC  X(0007).
  3663*    -------------------------------
  3664     05  FILLER            PIC  X(0003).
  3665     05  AGTHDGO PIC  X(0016).
  3666*    -------------------------------
  3667     05  FILLER            PIC  X(0003).
  3668     05  NAMEBO PIC  X(0030).
  3669*    -------------------------------
  3670     05  FILLER            PIC  X(0003).
  3671     05  NAMEB2O PIC  X(0030).
  3672*    -------------------------------
  3673     05  FILLER            PIC  X(0003).
  3674     05  ADDR1BO PIC  X(0030).
  3675*    -------------------------------
  3676     05  FILLER            PIC  X(0003).
  3677     05  ADDR1B2O PIC  X(0030).
  3678*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page  72
* EL156.cbl
  3679     05  FILLER            PIC  X(0003).
  3680     05  ADDR2BO PIC  X(0030).
  3681*    -------------------------------
  3682     05  FILLER            PIC  X(0003).
  3683     05  ADDR2B2O PIC  X(0030).
  3684*    -------------------------------
  3685     05  FILLER            PIC  X(0003).
  3686     05  CITYSTBO PIC  X(0030).
  3687*    -------------------------------
  3688     05  FILLER            PIC  X(0003).
  3689     05  CITYST2O PIC  X(0030).
  3690*    -------------------------------
  3691     05  FILLER            PIC  X(0003).
  3692     05  ZIPBO PIC  ZZZZ99999.
  3693*    -------------------------------
  3694     05  FILLER            PIC  X(0003).
  3695     05  ZIPB2O PIC  ZZZZZZZZZ.
  3696*    -------------------------------
  3697     05  FILLER            PIC  X(0003).
  3698     05  INTHDBO PIC  X(0012).
  3699*    -------------------------------
  3700     05  FILLER            PIC  X(0003).
  3701     05  INTAMTBO PIC  ZZZZ,ZZZ.ZZ.
  3702*    -------------------------------
  3703     05  FILLER            PIC  X(0003).
  3704     05  PMTHDGBO PIC  X(0034).
  3705*    -------------------------------
  3706     05  FILLER            PIC  X(0003).
  3707     05  CLMNOBO PIC  X(0007).
  3708*    -------------------------------
  3709     05  FILLER            PIC  X(0003).
  3710     05  CARRBO PIC  X(0001).
  3711*    -------------------------------
  3712     05  FILLER            PIC  X(0003).
  3713     05  CERTNOBO PIC  X(0010).
  3714*    -------------------------------
  3715     05  FILLER            PIC  X(0003).
  3716     05  SUFXBO PIC  X(0001).
  3717*    -------------------------------
  3718     05  FILLER            PIC  X(0003).
  3719     05  CLMTYPBO PIC  X(0006).
  3720*    -------------------------------
  3721     05  FILLER            PIC  X(0003).
  3722     05  INCURBO PIC  X(0008).
  3723*    -------------------------------
  3724     05  FILLER            PIC  X(0003).
  3725     05  PYFROMBO PIC  99B99B99.
  3726*    -------------------------------
  3727     05  FILLER            PIC  X(0003).
  3728     05  PYTHRUBO PIC  99B99B99.
  3729*    -------------------------------
  3730     05  FILLER            PIC  X(0003).
  3731     05  DAYSBO PIC  X(0005).
  3732*    -------------------------------
  3733     05  FILLER            PIC  X(0003).
  3734     05  BYBO PIC  X(0004).
  3735*    -------------------------------
  3736     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page  73
* EL156.cbl
  3737     05  PROOFDBO PIC  99B99B99.
  3738*    -------------------------------
  3739     05  FILLER            PIC  X(0003).
  3740     05  ACCTBO PIC  X(0010).
  3741*    -------------------------------
  3742     05  FILLER            PIC  X(0003).
  3743     05  STATEBO PIC  X(0002).
  3744*    -------------------------------
  3745     05  FILLER            PIC  X(0003).
  3746     05  GROUPBO PIC  X(0006).
  3747*    -------------------------------
  3748     05  FILLER            PIC  X(0003).
  3749     05  ACARRBO PIC  X(0001).
  3750*    -------------------------------
  3751     05  FILLER            PIC  X(0003).
  3752     05  ACCTNMBO PIC  X(0030).
  3753*    -------------------------------
  3754     05  FILLER            PIC  X(0003).
  3755     05  UNDISBO PIC  ZZZ,Z99.99.
  3756*    -------------------------------
  3757     05  FILLER            PIC  X(0003).
  3758     05  RATEBO PIC  ZZZ.99.
  3759*    -------------------------------
  3760     05  FILLER            PIC  X(0003).
  3761     05  ERMSG1BO PIC  X(0072).
  3762*    -------------------------------
  3763     05  FILLER            PIC  X(0003).
  3764     05  ENTPFBO PIC  X(0002).
  3765*    -------------------------------
  3766****************************************************************
  3767*
  3768* Copyright (c) 2007-2013 Dell Inc.
  3769* All rights reserved.
  3770*
  3771****************************************************************
  3772 01  DFHEIV.
  3773   02  DFHEIV0               PIC X(35).
  3774   02  DFHEIV1               PIC X(08).
  3775   02  DFHEIV2               PIC X(08).
  3776   02  DFHEIV3               PIC X(08).
  3777   02  DFHEIV4               PIC X(06).
  3778   02  DFHEIV5               PIC X(04).
  3779   02  DFHEIV6               PIC X(04).
  3780   02  DFHEIV7               PIC X(02).
  3781   02  DFHEIV8               PIC X(02).
  3782   02  DFHEIV9               PIC X(01).
  3783   02  DFHEIV10              PIC S9(7) COMP-3.
  3784   02  DFHEIV11              PIC S9(4) COMP SYNC.
  3785   02  DFHEIV12              PIC S9(4) COMP SYNC.
  3786   02  DFHEIV13              PIC S9(4) COMP SYNC.
  3787   02  DFHEIV14              PIC S9(4) COMP SYNC.
  3788   02  DFHEIV15              PIC S9(4) COMP SYNC.
  3789   02  DFHEIV16              PIC S9(9) COMP SYNC.
  3790   02  DFHEIV17              PIC X(04).
  3791   02  DFHEIV18              PIC X(04).
  3792   02  DFHEIV19              PIC X(04).
  3793   02  DFHEIV20              USAGE IS POINTER.
  3794   02  DFHEIV21              USAGE IS POINTER.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page  74
* EL156.cbl
  3795   02  DFHEIV22              USAGE IS POINTER.
  3796   02  DFHEIV23              USAGE IS POINTER.
  3797   02  DFHEIV24              USAGE IS POINTER.
  3798   02  DFHEIV25              PIC S9(9) COMP SYNC.
  3799   02  DFHEIV26              PIC S9(9) COMP SYNC.
  3800   02  DFHEIV27              PIC S9(9) COMP SYNC.
  3801   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3802   02  DFHEIV29              PIC S9(9) COMP SYNC.
  3803   02  DFHEIV30              PIC S9(9) COMP SYNC.
  3804   02  DFHEIV31              PIC S9(9) COMP SYNC.
  3805   02  DFHEIV32              PIC S9(4) COMP SYNC.
  3806   02  DFHEIV33              PIC S9(4) COMP SYNC.
  3807   02  DFHEIV34              PIC S9(4) COMP SYNC.
  3808   02  DFHEIV35              PIC S9(4) COMP SYNC.
  3809   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3810   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3811   02  FILLER                PIC X(02).
  3812   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3813   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  3814   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3815   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3816   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3817   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  3818   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  3819 LINKAGE  SECTION.
  3820*****************************************************************
  3821*                                                               *
  3822* Copyright (c) 2007-2013 Dell Inc.                             *
  3823* All rights reserved.                                          *
  3824*                                                               *
  3825*****************************************************************
  3826 01  dfheiblk.
  3827     02  eibtime          pic s9(7) comp-3.
  3828     02  eibdate          pic s9(7) comp-3.
  3829     02  eibtrnid         pic x(4).
  3830     02  eibtaskn         pic s9(7) comp-3.
  3831     02  eibtrmid         pic x(4).
  3832     02  dfheigdi         pic s9(4) comp.
  3833     02  eibcposn         pic s9(4) comp.
  3834     02  eibcalen         pic s9(4) comp.
  3835     02  eibaid           pic x(1).
  3836     02  eibfiller1       pic x(1).
  3837     02  eibfn            pic x(2).
  3838     02  eibfiller2       pic x(2).
  3839     02  eibrcode         pic x(6).
  3840     02  eibfiller3       pic x(2).
  3841     02  eibds            pic x(8).
  3842     02  eibreqid         pic x(8).
  3843     02  eibrsrce         pic x(8).
  3844     02  eibsync          pic x(1).
  3845     02  eibfree          pic x(1).
  3846     02  eibrecv          pic x(1).
  3847     02  eibsend          pic x(1).
  3848     02  eibatt           pic x(1).
  3849     02  eibeoc           pic x(1).
  3850     02  eibfmh           pic x(1).
  3851     02  eibcompl         pic x(1).
  3852     02  eibsig           pic x(1).
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page  75
* EL156.cbl
  3853     02  eibconf          pic x(1).
  3854     02  eiberr           pic x(1).
  3855     02  eibrldbk         pic x(1).
  3856     02  eiberrcd         pic x(4).
  3857     02  eibsynrb         pic x(1).
  3858     02  eibnodat         pic x(1).
  3859     02  eibfiller5       pic x(2).
  3860     02  eibresp          pic s9(8) comp.
  3861     02  eibresp2         pic s9(8) comp.
  3862     02  dfheigdj         pic s9(4) comp.
  3863     02  dfheigdk         pic s9(4) comp.
  3864 01  DFHCOMMAREA             PIC X(1024).
  3865
  3866*    COPY ELCMSTR.
  3867******************************************************************
  3868*                                                                *
  3869*                            ELCMSTR.                            *
  3870*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3871*                            VMOD=2.012                          *
  3872*                                                                *
  3873*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  3874*                                                                *
  3875*   FILE TYPE = VSAM,KSDS                                        *
  3876*   RECORD SIZE = 350  RECFORM = FIXED                           *
  3877*                                                                *
  3878*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  3879*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  3880*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  3881*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  3882*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  3883*                                                 RKP=75,LEN=21  *
  3884*                                                                *
  3885*   **** NOTE ****                                               *
  3886*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  3887*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  3888*                                                                *
  3889*   LOG = YES                                                    *
  3890*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3891******************************************************************
  3892*                   C H A N G E   L O G
  3893*
  3894* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3895*-----------------------------------------------------------------
  3896*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3897* EFFECTIVE    NUMBER
  3898*-----------------------------------------------------------------
  3899* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  3900* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  3901* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  3902* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3903* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  3904* 081817    2016100700001  TANA  ADD NBR OF EXTENSIONS
  3905******************************************************************
  3906 01  CLAIM-MASTER.
  3907     12  CL-RECORD-ID                PIC XX.
  3908         88  VALID-CL-ID         VALUE 'CL'.
  3909
  3910     12  CL-CONTROL-PRIMARY.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page  76
* EL156.cbl
  3911         16  CL-COMPANY-CD           PIC X.
  3912         16  CL-CARRIER              PIC X.
  3913         16  CL-CLAIM-NO             PIC X(7).
  3914         16  CL-CERT-NO.
  3915             20  CL-CERT-PRIME       PIC X(10).
  3916             20  CL-CERT-SFX         PIC X.
  3917
  3918     12  CL-CONTROL-BY-NAME.
  3919         16  CL-COMPANY-CD-A1        PIC X.
  3920         16  CL-INSURED-LAST-NAME    PIC X(15).
  3921         16  CL-INSURED-NAME.
  3922             20  CL-INSURED-1ST-NAME PIC X(12).
  3923             20  CL-INSURED-MID-INIT PIC X.
  3924
  3925     12  CL-CONTROL-BY-SSN.
  3926         16  CL-COMPANY-CD-A2        PIC X.
  3927         16  CL-SOC-SEC-NO.
  3928             20  CL-SSN-STATE        PIC XX.
  3929             20  CL-SSN-ACCOUNT      PIC X(6).
  3930             20  CL-SSN-LN3          PIC X(3).
  3931
  3932     12  CL-CONTROL-BY-CERT-NO.
  3933         16  CL-COMPANY-CD-A4        PIC X.
  3934         16  CL-CERT-NO-A4.
  3935             20  CL-CERT-A4-PRIME    PIC X(10).
  3936             20  CL-CERT-A4-SFX      PIC X.
  3937
  3938     12  CL-CONTROL-BY-CCN.
  3939         16  CL-COMPANY-CD-A5        PIC X.
  3940         16  CL-CCN-A5.
  3941             20  CL-CCN.
  3942                 24  CL-CCN-PREFIX-A5 PIC X(4).
  3943                 24  CL-CCN-PRIME-A5 PIC X(12).
  3944             20  CL-CCN-FILLER-A5    PIC X(4).
  3945
  3946     12  CL-INSURED-PROFILE-DATA.
  3947         16  CL-INSURED-BIRTH-DT     PIC XX.
  3948         16  CL-INSURED-SEX-CD       PIC X.
  3949             88  INSURED-IS-MALE        VALUE 'M'.
  3950             88  INSURED-IS-FEMALE      VALUE 'F'.
  3951             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  3952         16  CL-INSURED-OCC-CD       PIC X(6).
  3953         16  FILLER                  PIC X(5).
  3954
  3955     12  CL-PROCESSING-INFO.
  3956         16  CL-PROCESSOR-ID         PIC X(4).
  3957         16  CL-CLAIM-STATUS         PIC X.
  3958             88  CLAIM-IS-OPEN          VALUE 'O'.
  3959             88  CLAIM-IS-CLOSED        VALUE 'C'.
  3960         16  CL-CLAIM-TYPE           PIC X.
  3961*            88  AH-CLAIM               VALUE 'A'.
  3962*            88  LIFE-CLAIM             VALUE 'L'.
  3963*            88  PROPERTY-CLAIM         VALUE 'P'.
  3964*            88  IUI-CLAIM              VALUE 'I'.
  3965*            88  GAP-CLAIM              VALUE 'G'.
  3966*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  3967         16  CL-CLAIM-PREM-TYPE      PIC X.
  3968             88  SINGLE-PREMIUM         VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page  77
* EL156.cbl
  3969             88  O-B-COVERAGE           VALUE '2'.
  3970             88  OPEN-END-COVERAGE      VALUE '3'.
  3971         16  CL-INCURRED-DT          PIC XX.
  3972         16  CL-REPORTED-DT          PIC XX.
  3973         16  CL-FILE-ESTABLISH-DT    PIC XX.
  3974         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  3975         16  CL-LAST-PMT-DT          PIC XX.
  3976         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  3977         16  CL-PAID-THRU-DT         PIC XX.
  3978         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  3979         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  3980         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  3981         16  CL-PMT-CALC-METHOD      PIC X.
  3982             88  CL-360-DAY-YR          VALUE '1'.
  3983             88  CL-365-DAY-YR          VALUE '2'.
  3984             88  CL-FULL-MONTHS         VALUE '3'.
  3985         16  CL-CAUSE-CD             PIC X(6).
  3986
  3987         16  CL-PRIME-CERT-NO.
  3988             20  CL-PRIME-CERT-PRIME PIC X(10).
  3989             20  CL-PRIME-CERT-SFX   PIC X.
  3990
  3991         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  3992             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  3993             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  3994
  3995         16  CL-MICROFILM-NO         PIC X(10).
  3996         16  FILLER REDEFINES CL-MICROFILM-NO.
  3997             20  CL-BENEFIT-PERIOD   PIC 99.
  3998             20  FILLER              PIC X(8).
  3999         16  CL-PROG-FORM-TYPE       PIC X.
  4000         16  CL-LAST-ADD-ON-DT       PIC XX.
  4001
  4002         16  CL-LAST-REOPEN-DT       PIC XX.
  4003         16  CL-LAST-CLOSE-DT        PIC XX.
  4004         16  CL-LAST-CLOSE-REASON    PIC X(01).
  4005             88  FINAL-PAID             VALUE '1'.
  4006             88  CLAIM-DENIED           VALUE '2'.
  4007             88  AUTO-CLOSE             VALUE '3'.
  4008             88  MANUAL-CLOSE           VALUE '4'.
  4009             88  BENEFITS-CHANGED       VALUE 'C'.
  4010             88  SETUP-ERRORS           VALUE 'E'.
  4011         16  CL-ASSOC-CERT-SEQU      PIC S99.
  4012         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  4013         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  4014             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  4015         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  4016         16  FILLER                  PIC X.
  4017
  4018     12  CL-CERTIFICATE-DATA.
  4019         16  CL-CERT-ORIGIN          PIC X.
  4020             88  CERT-WAS-ONLINE        VALUE '1'.
  4021             88  CERT-WAS-CREATED       VALUE '2'.
  4022             88  COVERAGE-WAS-ADDED     VALUE '3'.
  4023         16  CL-CERT-KEY-DATA.
  4024             20  CL-CERT-CARRIER     PIC X.
  4025             20  CL-CERT-GROUPING    PIC X(6).
  4026             20  CL-CERT-STATE       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page  78
* EL156.cbl
  4027             20  CL-CERT-ACCOUNT.
  4028                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  4029                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  4030             20  CL-CERT-EFF-DT      PIC XX.
  4031
  4032     12  CL-STATUS-CONTROLS.
  4033         16  CL-PRIORITY-CD          PIC X.
  4034             88  CONFIDENTIAL-DATA      VALUE '8'.
  4035             88  HIGHEST-PRIORITY       VALUE '9'.
  4036         16  CL-SUPV-ATTN-CD         PIC X.
  4037             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  4038             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  4039         16  CL-PURGED-DT            PIC XX.
  4040         16  CL-RESTORED-DT          PIC XX.
  4041         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  4042         16  CL-NEXT-RESEND-DT       PIC XX.
  4043         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  4044         16  CL-CRITICAL-PERIOD      PIC 99.
  4045*        16  FILLER                  PIC XX.
  4046         16  CL-LAST-MAINT-DT        PIC XX.
  4047         16  CL-LAST-MAINT-USER      PIC X(4).
  4048         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  4049         16  CL-LAST-MAINT-TYPE      PIC X.
  4050             88  CLAIM-SET-UP           VALUE ' '.
  4051             88  PAYMENT-MADE           VALUE '1'.
  4052             88  LETTER-SENT            VALUE '2'.
  4053             88  MASTER-WAS-ALTERED     VALUE '3'.
  4054             88  MASTER-WAS-RESTORED    VALUE '4'.
  4055             88  INCURRED-DATE-CHANGED  VALUE '5'.
  4056             88  FILE-CONVERTED         VALUE '6'.
  4057             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  4058             88  ERROR-CORRECTION       VALUE 'E'.
  4059         16  CL-RELATED-CLAIM-NO     PIC X(7).
  4060         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  4061         16  CL-BENEFICIARY          PIC X(10).
  4062         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  4063         16  CL-DENIAL-TYPE          PIC X.
  4064             88  CL-TYPE-DENIAL          VALUE '1'.
  4065             88  CL-TYPE-RESCISSION      VALUE '2'.
  4066             88  CL-TYPE-REFORMATION     VALUE '3'.
  4067             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  4068             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  4069         16  CL-NO-OF-EXTENSIONS     PIC 99.
  4070         16  filler                  pic x(3).
  4071*        16  CL-CRIT-PER-RECURRENT   PIC X.
  4072*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  4073*        16  CL-RTW-DT               PIC XX.
  4074
  4075     12  CL-TRAILER-CONTROLS.
  4076         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  4077             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  4078             88  CL-LAST-TRL-AVAIL      VALUE +100.
  4079             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  4080         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  4081         16  FILLER                  PIC XX.
  4082         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  4083         16  CL-ADDRESS-TRAILER-CNT.
  4084             20  CL-INSURED-ADDR-CNT  PIC S9(1).
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page  79
* EL156.cbl
  4085                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  4086             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  4087                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  4088             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  4089                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  4090             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  4091                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  4092             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  4093                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  4094             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  4095                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  4096             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  4097                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  4098
  4099     12  CL-CV-REFERENCE-NO.
  4100         16  CL-CV-REFNO-PRIME       PIC X(18).
  4101         16  CL-CV-REFNO-SFX         PIC XX.
  4102
  4103     12  CL-FILE-LOCATION            PIC X(4).
  4104
  4105     12  CL-PROCESS-ERRORS.
  4106         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  4107             88  NO-FATAL-ERRORS        VALUE ZERO.
  4108         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  4109             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  4110
  4111     12  CL-PRODUCT-CD               PIC X.
  4112
  4113     12  CL-CURRENT-KEY-DATA.
  4114         16  CL-CURRENT-CARRIER      PIC X.
  4115         16  CL-CURRENT-GROUPING     PIC X(6).
  4116         16  CL-CURRENT-STATE        PIC XX.
  4117         16  CL-CURRENT-ACCOUNT      PIC X(10).
  4118
  4119     12  CL-ASSOCIATES               PIC X.
  4120         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  4121         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  4122         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  4123         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  4124
  4125     12  CL-ACTIVITY-CODE            PIC 99.
  4126     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  4127     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  4128
  4129     12  CL-LAPSE-REPORT-CODE        PIC 9.
  4130     12  CL-LAG-REPORT-CODE          PIC 9.
  4131     12  CL-LOAN-TYPE                PIC XX.
  4132     12  CL-LEGAL-STATE              PIC XX.
  4133
  4134     12  CL-YESNOSW                  PIC X.
  4135     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  4136         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  4137         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  4138         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  4139     12  cl-insured-type             pic x.
  4140         88  cl-claim-on-primary         value 'P'.
  4141         88  cl-claim-on-co-borrower     value 'C'.
  4142     12  cl-benefit-expiration-dt    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page  80
* EL156.cbl
  4144*    COPY ELCCNTL.
  4145******************************************************************
  4146*                                                                *
  4147*                                                                *
  4148*                            ELCCNTL.                            *
  4149*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4150*                            VMOD=2.059                          *
  4151*                                                                *
  4152*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  4153*                                                                *
  4154*   FILE TYPE = VSAM,KSDS                                        *
  4155*   RECORD SIZE = 750  RECFORM = FIXED                           *
  4156*                                                                *
  4157*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  4158*       ALTERNATE INDEX = NONE                                   *
  4159*                                                                *
  4160*   LOG = YES                                                    *
  4161*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4162******************************************************************
  4163*                   C H A N G E   L O G
  4164*
  4165* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4166*-----------------------------------------------------------------
  4167*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4168* EFFECTIVE    NUMBER
  4169*-----------------------------------------------------------------
  4170* 082503                   PEMA  ADD BENEFIT GROUP
  4171* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4172* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  4173* 092705    2005050300006  PEMA  ADD SPP LEASES
  4174* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  4175* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  4176* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  4177* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  4178* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  4179* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  4180* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  4181* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  4182* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  4183* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  4184* 102717  CR2017062000003  PEMA  COMM CAP CHANGES
  4185******************************************************************
  4186*
  4187 01  CONTROL-FILE.
  4188     12  CF-RECORD-ID                       PIC XX.
  4189         88  VALID-CF-ID                        VALUE 'CF'.
  4190
  4191     12  CF-CONTROL-PRIMARY.
  4192         16  CF-COMPANY-ID                  PIC XXX.
  4193         16  CF-RECORD-TYPE                 PIC X.
  4194             88  CF-COMPANY-MASTER              VALUE '1'.
  4195             88  CF-PROCESSOR-MASTER            VALUE '2'.
  4196             88  CF-STATE-MASTER                VALUE '3'.
  4197             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  4198             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  4199             88  CF-CARRIER-MASTER              VALUE '6'.
  4200             88  CF-MORTALITY-MASTER            VALUE '7'.
  4201             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page  81
* EL156.cbl
  4202             88  CF-TERMINAL-MASTER             VALUE '9'.
  4203             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  4204             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  4205             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  4206             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  4207             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  4208             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  4209             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  4210             88  CF-REMINDERS-MASTER            VALUE 'R'.
  4211             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  4212         16  CF-ACCESS-CD-GENL              PIC X(4).
  4213         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  4214             20  CF-PROCESSOR               PIC X(4).
  4215         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  4216             20  CF-STATE-CODE              PIC XX.
  4217             20  FILLER                     PIC XX.
  4218         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  4219             20  FILLER                     PIC XX.
  4220             20  CF-HI-BEN-IN-REC           PIC XX.
  4221         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  4222             20  FILLER                     PIC XXX.
  4223             20  CF-CARRIER-CNTL            PIC X.
  4224         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  4225             20  FILLER                     PIC XX.
  4226             20  CF-HI-TYPE-IN-REC          PIC 99.
  4227         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  4228             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  4229                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  4230             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  4231             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  4232         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  4233             20  FILLER                     PIC X.
  4234             20  CF-CUSTOM-REPORT-NO        PIC 999.
  4235         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  4236             20  FILLER                     PIC XX.
  4237             20  CF-MORTGAGE-PLAN           PIC XX.
  4238         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  4239
  4240     12  CF-LAST-MAINT-DT                   PIC XX.
  4241     12  CF-LAST-MAINT-BY                   PIC X(4).
  4242     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  4243
  4244     12  CF-RECORD-BODY                     PIC X(728).
  4245
  4246
  4247****************************************************************
  4248*             COMPANY MASTER RECORD                            *
  4249****************************************************************
  4250
  4251     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4252         16  CF-COMPANY-ADDRESS.
  4253             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  4254             20  CF-CL-IN-CARE-OF           PIC X(30).
  4255             20  CF-CL-ADDR-LINE-1          PIC X(30).
  4256             20  CF-CL-ADDR-LINE-2          PIC X(30).
  4257             20  CF-CL-CITY-STATE           PIC X(30).
  4258             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  4259             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page  82
* EL156.cbl
  4260         16  CF-COMPANY-CD                  PIC X.
  4261         16  CF-COMPANY-PASSWORD            PIC X(8).
  4262         16  CF-SECURITY-OPTION             PIC X.
  4263             88  ALL-SECURITY                   VALUE '1'.
  4264             88  COMPANY-VERIFY                 VALUE '2'.
  4265             88  PROCESSOR-VERIFY               VALUE '3'.
  4266             88  NO-SECURITY                    VALUE '4'.
  4267             88  ALL-BUT-TERM                   VALUE '5'.
  4268         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  4269             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  4270         16  CF-LGX-INTERFACE-CNTL          PIC X.
  4271             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  4272         16  CF-INFORCE-LOCATION            PIC X.
  4273             88  CERTS-ARE-ONLINE               VALUE '1'.
  4274             88  CERTS-ARE-OFFLINE              VALUE '2'.
  4275             88  NO-CERTS-AVAILABLE             VALUE '3'.
  4276         16  CF-LOWER-CASE-LETTERS          PIC X.
  4277         16  CF-CERT-ACCESS-CONTROL         PIC X.
  4278             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  4279             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  4280             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  4281             88  CF-ACCNT-CNTL                  VALUE '3'.
  4282             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  4283
  4284         16  CF-FORMS-PRINTER-ID            PIC X(4).
  4285         16  CF-CHECK-PRINTER-ID            PIC X(4).
  4286
  4287         16  CF-LGX-CREDIT-USER             PIC X.
  4288             88  CO-IS-NOT-USER                 VALUE 'N'.
  4289             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  4290
  4291         16 CF-CREDIT-CALC-CODES.
  4292             20  CF-CR-REM-TERM-CALC PIC X.
  4293               88  CR-EARN-AFTER-15TH           VALUE '1'.
  4294               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  4295               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  4296               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  4297               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  4298               88  CR-EARN-AFTER-14TH           VALUE '6'.
  4299               88  CR-EARN-AFTER-16TH           VALUE '7'.
  4300             20  CF-CR-R78-METHOD           PIC X.
  4301               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  4302               88  DONT-USE-PLUS-ONE            VALUE '1'.
  4303
  4304         16  CF-CLAIM-CONTROL-COUNTS.
  4305             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  4306                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  4307
  4308             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  4309                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  4310
  4311             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  4312                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  4313
  4314             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  4315                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  4316
  4317         16  CF-CURRENT-MONTH-END           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page  83
* EL156.cbl
  4318
  4319         16  CF-CO-CALC-QUOTE-TOLERANCE.
  4320             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  4321             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  4322             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  4323             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  4324                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4325                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4326             20  CF-CO-PREM-REJECT-SW       PIC X.
  4327                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  4328                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  4329             20  CF-CO-REF-REJECT-SW        PIC X.
  4330                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  4331                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  4332
  4333         16  CF-CO-REPORTING-DT             PIC XX.
  4334         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  4335         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  4336           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  4337           88  CF-CO-MONTH-END                  VALUE '1'.
  4338
  4339         16  CF-LGX-CLAIM-USER              PIC X.
  4340             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  4341             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  4342
  4343         16  CF-CREDIT-EDIT-CONTROLS.
  4344             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  4345             20  CF-MIN-AGE                 PIC 99.
  4346             20  CF-DEFAULT-AGE             PIC 99.
  4347             20  CF-MIN-TERM                PIC S999      COMP-3.
  4348             20  CF-MAX-TERM                PIC S999      COMP-3.
  4349             20  CF-DEFAULT-SEX             PIC X.
  4350             20  CF-JOINT-AGE-INPUT         PIC X.
  4351                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  4352             20  CF-BIRTH-DATE-INPUT        PIC X.
  4353                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  4354             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  4355                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  4356                 88  CF-ZERO-CARRIER            VALUE '1'.
  4357                 88  CF-ZERO-GROUPING           VALUE '2'.
  4358                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  4359             20  CF-EDIT-SW                 PIC X.
  4360                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  4361             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  4362             20  CF-CR-PR-METHOD            PIC X.
  4363               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  4364               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  4365             20  FILLER                     PIC X.
  4366
  4367         16  CF-CREDIT-MISC-CONTROLS.
  4368             20  CF-REIN-TABLE-SW           PIC X.
  4369                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  4370             20  CF-COMP-TABLE-SW           PIC X.
  4371                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  4372             20  CF-EXPERIENCE-RETENTION-AGE
  4373                                            PIC S9        COMP-3.
  4374             20  CF-CONVERSION-DT           PIC XX.
  4375             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page  84
* EL156.cbl
  4376             20  CF-RUN-FREQUENCY-SW        PIC X.
  4377                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  4378                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  4379
  4380             20  CF-CR-CHECK-NO-CONTROL.
  4381                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  4382                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  4383                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  4384                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  4385                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  4386                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  4387
  4388                 24  CF-CR-CHECK-COUNT       REDEFINES
  4389                     CF-CR-CHECK-COUNTER      PIC X(4).
  4390
  4391                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  4392                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  4393
  4394                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  4395                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  4396                 24  CF-MAIL-PROCESSING       PIC X.
  4397                     88  MAIL-PROCESSING          VALUE 'Y'.
  4398
  4399         16  CF-MISC-SYSTEM-CONTROL.
  4400             20  CF-SYSTEM-C                 PIC X.
  4401                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  4402             20  CF-SYSTEM-D                 PIC X.
  4403                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  4404             20  CF-SOC-SEC-NO-SW            PIC X.
  4405                 88  SOC-SEC-NO-USED             VALUE '1'.
  4406             20  CF-MEMBER-NO-SW             PIC X.
  4407                 88  MEMBER-NO-USED              VALUE '1'.
  4408             20  CF-TAX-ID-NUMBER            PIC X(11).
  4409             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  4410             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  4411                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  4412                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  4413                 88  CF-ALL-APPROVED             VALUE 'Y'.
  4414                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  4415             20  CF-SYSTEM-E                 PIC X.
  4416                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  4417
  4418         16  CF-LGX-LIFE-USER               PIC X.
  4419             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  4420             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  4421
  4422         16  CF-CR-MONTH-END-DT             PIC XX.
  4423
  4424         16  CF-FILE-MAINT-DATES.
  4425             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  4426                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  4427             20  CF-LAST-BATCH       REDEFINES
  4428                 CF-LAST-BATCH-NO               PIC X(4).
  4429             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  4430             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  4431             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  4432             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  4433             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page  85
* EL156.cbl
  4434             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  4435             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  4436             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  4437             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  4438             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  4439
  4440         16  CF-NEXT-COMPANY-ID             PIC XXX.
  4441         16  FILLER                         PIC X.
  4442
  4443         16  CF-ALT-MORT-CODE               PIC X(4).
  4444         16  CF-MEMBER-CAPTION              PIC X(10).
  4445
  4446         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  4447             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  4448             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  4449             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  4450             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  4451             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  4452
  4453         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  4454
  4455         16  CF-LIFE-OVERRIDE-L1            PIC X.
  4456         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  4457         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  4458         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  4459
  4460         16  CF-AH-OVERRIDE-L1              PIC X.
  4461         16  CF-AH-OVERRIDE-L2              PIC XX.
  4462         16  CF-AH-OVERRIDE-L6              PIC X(6).
  4463         16  CF-AH-OVERRIDE-L12             PIC X(12).
  4464
  4465         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  4466         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  4467
  4468         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  4469         16  CF-AR-LAST-EL860-DT            PIC XX.
  4470         16  CF-MP-MONTH-END-DT             PIC XX.
  4471
  4472         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  4473         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  4474             88  CF-CLAIM-PAID-TO               VALUE '1'.
  4475
  4476         16  CF-AR-MONTH-END-DT             PIC XX.
  4477
  4478         16  CF-CRDTCRD-USER                PIC X.
  4479             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  4480             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  4481
  4482         16  CF-CC-MONTH-END-DT             PIC XX.
  4483
  4484         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  4485
  4486         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  4487             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  4488             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  4489             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  4490         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  4491         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page  86
* EL156.cbl
  4492         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  4493         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  4494             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  4495             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  4496         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  4497         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  4498         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  4499             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  4500         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  4501
  4502         16  CF-CL-ZIP-CODE.
  4503             20  CF-CL-ZIP-PRIME.
  4504                 24  CF-CL-ZIP-1ST          PIC X.
  4505                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  4506                 24  FILLER                 PIC X(4).
  4507             20  CF-CL-ZIP-PLUS4            PIC X(4).
  4508         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  4509             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  4510             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  4511             20  FILLER                     PIC XXX.
  4512
  4513         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  4514         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  4515         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  4516         16  CF-CO-OPTION-START-DATE        PIC XX.
  4517         16  CF-REM-TRM-CALC-OPTION         PIC X.
  4518           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  4519                                                      '3' '4'.
  4520           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  4521           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  4522           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  4523           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  4524           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  4525           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  4526
  4527         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  4528
  4529         16  CF-PAYMENT-APPROVAL-LEVELS.
  4530             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  4531             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  4532             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  4533             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  4534             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  4535             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  4536
  4537         16  CF-END-USER-REPORTING-USER     PIC X.
  4538             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  4539             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  4540
  4541         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  4542             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  4543             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  4544
  4545         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  4546
  4547         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  4548         16  FILLER                         PIC X.
  4549
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page  87
* EL156.cbl
  4550         16  CF-CREDIT-ARCHIVE-CNTL.
  4551             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  4552             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  4553             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  4554
  4555         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  4556
  4557         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  4558             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  4559             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  4560
  4561         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  4562             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  4563             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  4564
  4565         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  4566
  4567         16  CF-CO-ACH-ID-CODE              PIC  X.
  4568             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  4569             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  4570             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  4571         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  4572         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  4573         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  4574         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  4575         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  4576         16  CF-CO-ACH-RECV-NO              PIC X(08).
  4577         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  4578         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  4579         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  4580                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  4581         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  4582                 CF-CO-ACH-TRACE-NO         PIC X(4).
  4583
  4584         16  CF-CO-OVER-SHORT.
  4585             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  4586             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  4587
  4588*         16  FILLER                         PIC X(102).
  4589         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  4590             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  4591             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  4592
  4593         16  CF-AH-APPROVAL-DAYS.
  4594             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  4595             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  4596             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  4597             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  4598
  4599         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  4600
  4601         16  CF-APPROV-LEV-5.
  4602             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  4603             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  4604             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  4605
  4606         16  FILLER                         PIC X(68).
  4607****************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page  88
* EL156.cbl
  4608*             PROCESSOR/USER RECORD                            *
  4609****************************************************************
  4610
  4611     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4612         16  CF-PROCESSOR-NAME              PIC X(30).
  4613         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  4614         16  CF-PROCESSOR-TITLE             PIC X(26).
  4615         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  4616                 88  MESSAGE-YES                VALUE 'Y'.
  4617                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  4618
  4619*****************************************************
  4620****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  4621****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  4622****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  4623****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  4624*****************************************************
  4625
  4626         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  4627             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  4628             20  CF-APPLICATION-FORCE       PIC X.
  4629             20  CF-INDIVIDUAL-APP.
  4630                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  4631                     28  CF-BROWSE-APP      PIC X.
  4632                     28  CF-UPDATE-APP      PIC X.
  4633
  4634         16  CF-CURRENT-TERM-ON             PIC X(4).
  4635         16  CF-PROCESSOR-LIMITS-CLAIMS.
  4636             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  4637             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  4638             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  4639             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  4640             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  4641             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  4642             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  4643         16  CF-PROCESSOR-CARRIER           PIC X.
  4644             88  NO-CARRIER-SECURITY            VALUE ' '.
  4645         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  4646             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  4647         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  4648             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  4649         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  4650             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  4651
  4652         16  CF-PROC-SYS-ACCESS-SW.
  4653             20  CF-PROC-CREDIT-CLAIMS-SW.
  4654                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  4655                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  4656                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  4657                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  4658             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  4659                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  4660                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  4661             20  CF-PROC-LIFE-GNRLDGR-SW.
  4662                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  4663                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  4664                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  4665                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page  89
* EL156.cbl
  4666             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  4667                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  4668                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  4669         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  4670             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  4671             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  4672         16  CF-PROCESSOR-PRINTER               PIC X(4).
  4673
  4674         16  CF-APPROVAL-LEVEL                  PIC X.
  4675             88  APPROVAL-LEVEL-1                   VALUE '1'.
  4676             88  APPROVAL-LEVEL-2                   VALUE '2'.
  4677             88  APPROVAL-LEVEL-3                   VALUE '3'.
  4678             88  APPROVAL-LEVEL-4                   VALUE '4'.
  4679             88  APPROVAL-LEVEL-5                   VALUE '5'.
  4680
  4681         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  4682
  4683         16  CF-LANGUAGE-TYPE                   PIC X.
  4684             88  CF-LANG-IS-ENG                     VALUE 'E'.
  4685             88  CF-LANG-IS-FR                      VALUE 'F'.
  4686
  4687         16  CF-CSR-IND                         PIC X.
  4688         16  FILLER                             PIC X(239).
  4689
  4690****************************************************************
  4691*             PROCESSOR/REMINDERS RECORD                       *
  4692****************************************************************
  4693
  4694     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  4695         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  4696             20  CF-START-REMIND-DT         PIC XX.
  4697             20  CF-END-REMIND-DT           PIC XX.
  4698             20  CF-REMINDER-TEXT           PIC X(50).
  4699         16  FILLER                         PIC X(296).
  4700
  4701
  4702****************************************************************
  4703*             STATE MASTER RECORD                              *
  4704****************************************************************
  4705
  4706     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4707         16  CF-STATE-ABBREVIATION          PIC XX.
  4708         16  CF-STATE-NAME                  PIC X(25).
  4709         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  4710         16  CF-ST-CALC-QUOTE-TOLERANCE.
  4711             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  4712             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  4713             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  4714             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  4715                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4716                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4717             20  CF-ST-PREM-REJECT-SW       PIC X.
  4718                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  4719                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  4720             20  CF-ST-REF-REJECT-SW        PIC X.
  4721                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  4722                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  4723         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page  90
* EL156.cbl
  4724         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  4725         16  CF-ST-REFUND-RULES.
  4726             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  4727             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  4728             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  4729         16  CF-ST-FST-PMT-EXTENSION.
  4730             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  4731             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  4732                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  4733                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  4734                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  4735                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  4736         16  CF-ST-STATE-CALL.
  4737             20  CF-ST-CALL-UNEARNED        PIC X.
  4738             20  CF-ST-CALL-RPT-CNTL        PIC X.
  4739             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  4740         16  CF-REPLACEMENT-LAW-SW          PIC X.
  4741             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  4742             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  4743         16  CF-REPLACEMENT-LETTER          PIC X(4).
  4744         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  4745         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  4746         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  4747         16  CF-ST-SPLIT-PAYMENT            PIC X.
  4748         16  FILLER                         PIC X.
  4749         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  4750             20  CF-ST-BENEFIT-CD           PIC XX.
  4751             20  CF-ST-BENEFIT-KIND         PIC X.
  4752                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  4753                 88  CF-ST-AH-KIND              VALUE 'A'.
  4754             20  CF-ST-REM-TERM-CALC        PIC X.
  4755                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  4756                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  4757                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  4758                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  4759                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  4760                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  4761                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  4762                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  4763
  4764             20  CF-ST-REFUND-CALC          PIC X.
  4765                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  4766                 88  ST-REFD-BY-R78             VALUE '1'.
  4767                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  4768                 88  ST-REFD-AS-CALIF           VALUE '3'.
  4769                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  4770                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  4771                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  4772                 88  ST-REFD-UTAH               VALUE '7'.
  4773                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  4774                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  4775                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  4776
  4777             20  CF-ST-EARNING-CALC         PIC X.
  4778                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  4779                 88  ST-EARN-BY-R78             VALUE '1'.
  4780                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  4781                 88  ST-EARN-AS-CALIF           VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page  91
* EL156.cbl
  4782                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  4783                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  4784                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  4785                 88  ST-EARN-MEAN               VALUE '8'.
  4786                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  4787
  4788             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  4789                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  4790                 88  ST-OVRD-BY-R78             VALUE '1'.
  4791                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  4792                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  4793                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  4794                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  4795                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  4796                 88  ST-OVRD-MEAN               VALUE '8'.
  4797                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  4798             20  cf-st-extra-periods        pic 9.
  4799*            20  FILLER                     PIC X.
  4800
  4801         16  CF-ST-COMMISSION-CAPS.
  4802             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  4803             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  4804             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  4805             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  4806         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  4807                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  4808                 88  ST-LIMIT-TO-GA             VALUE 'G'.
  4809                 88  ST-LIMIT-TO-BOTH           VALUE 'B'.
  4810
  4811         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  4812
  4813         16  CF-ST-STATUTORY-INTEREST.
  4814             20  CF-ST-STAT-DATE-FROM       PIC X.
  4815                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  4816                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  4817             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  4818             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  4819             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  4820             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  4821             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  4822
  4823         16  CF-ST-OVER-SHORT.
  4824             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  4825             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  4826
  4827         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  4828
  4829         16  CF-ST-RT-CALC                  PIC X.
  4830
  4831         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  4832         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  4833         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  4834         16  CF-ST-RF-LR-CALC               PIC X.
  4835         16  CF-ST-RF-LL-CALC               PIC X.
  4836         16  CF-ST-RF-LN-CALC               PIC X.
  4837         16  CF-ST-RF-AH-CALC               PIC X.
  4838         16  CF-ST-RF-CP-CALC               PIC X.
  4839*        16  FILLER                         PIC X(206).
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page  92
* EL156.cbl
  4840*CIDMOD         16  FILLER                         PIC X(192).
  4841         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  4842             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  4843         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  4844         16  CF-ST-VFY-2ND-BENE             PIC X.
  4845         16  CF-ST-CAUSAL-STATE             PIC X.
  4846         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  4847         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  4848         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  4849             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  4850         16  CF-ST-NET-ONLY-STATE           PIC X.
  4851             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  4852         16  cf-commission-cap-required     pic x.
  4853         16  CF-ST-GA-COMMISSION-CAPS.
  4854             20  CF-ST-GA-COMM-CAP-SL       PIC S9V9(4) COMP-3.
  4855             20  CF-ST-GA-COMM-CAP-JL       PIC S9V9(4) COMP-3.
  4856             20  CF-ST-GA-COMM-CAP-SA       PIC S9V9(4) COMP-3.
  4857             20  CF-ST-GA-COMM-CAP-JA       PIC S9V9(4) COMP-3.
  4858         16  CF-ST-TOT-COMMISSION-CAPS.
  4859             20  CF-ST-TOT-COMM-CAP-SL      PIC S9V9(4) COMP-3.
  4860             20  CF-ST-TOT-COMM-CAP-JL      PIC S9V9(4) COMP-3.
  4861             20  CF-ST-TOT-COMM-CAP-SA      PIC S9V9(4) COMP-3.
  4862             20  CF-ST-TOT-COMM-CAP-JA      PIC S9V9(4) COMP-3.
  4863         16  FILLER                         PIC X(156).
  4864
  4865****************************************************************
  4866*             BENEFIT MASTER RECORD                            *
  4867****************************************************************
  4868
  4869     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4870         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  4871             20  CF-BENEFIT-CODE            PIC XX.
  4872             20  CF-BENEFIT-NUMERIC  REDEFINES
  4873                 CF-BENEFIT-CODE            PIC XX.
  4874             20  CF-BENEFIT-ALPHA           PIC XXX.
  4875             20  CF-BENEFIT-DESCRIP         PIC X(10).
  4876             20  CF-BENEFIT-COMMENT         PIC X(10).
  4877
  4878             20  CF-LF-COVERAGE-TYPE        PIC X.
  4879                 88  CF-REDUCING                VALUE 'R'.
  4880                 88  CF-LEVEL                   VALUE 'L' 'P'.
  4881
  4882             20  CF-SPECIAL-CALC-CD         PIC X.
  4883                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  4884                 88  CF-NP-0-MO-INT             VALUE 'A'.
  4885                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  4886                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  4887                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  4888                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  4889                 88  CF-FARM-PLAN               VALUE 'F'.
  4890                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  4891                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  4892                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  4893                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  4894                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  4895                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  4896                 88  CF-PRUDENTIAL              VALUE 'P'.
  4897                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page  93
* EL156.cbl
  4898                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  4899                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  4900                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  4901                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  4902                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  4903
  4904             20  CF-JOINT-INDICATOR         PIC X.
  4905                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  4906
  4907*            20  FILLER                     PIC X(12).
  4908             20  cf-maximum-benefits        pic s999 comp-3.
  4909             20  FILLER                     PIC X(09).
  4910             20  CF-BENEFIT-CATEGORY        PIC X.
  4911             20  CF-LOAN-TYPE               PIC X(8).
  4912
  4913             20  CF-CO-REM-TERM-CALC        PIC X.
  4914                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  4915                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  4916                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  4917                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  4918                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  4919
  4920             20  CF-CO-EARNINGS-CALC        PIC X.
  4921                 88  CO-EARN-BY-R78             VALUE '1'.
  4922                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  4923                 88  CO-EARN-AS-CALIF           VALUE '3'.
  4924                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  4925                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  4926                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  4927                 88  CO-EARN-AS-MEAN            VALUE '8'.
  4928                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  4929
  4930             20  CF-CO-REFUND-CALC          PIC X.
  4931                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  4932                 88  CO-REFD-BY-R78             VALUE '1'.
  4933                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  4934                 88  CO-REFD-AS-CALIF           VALUE '3'.
  4935                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  4936                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  4937                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  4938                 88  CO-REFD-MEAN               VALUE '8'.
  4939                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  4940                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  4941                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  4942
  4943             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  4944                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  4945                 88  CO-OVRD-BY-R78             VALUE '1'.
  4946                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  4947                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  4948                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  4949                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  4950                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  4951                 88  CO-OVRD-MEAN               VALUE '8'.
  4952                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  4953
  4954             20  CF-CO-BEN-I-G-CD           PIC X.
  4955                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page  94
* EL156.cbl
  4956                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  4957                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  4958
  4959         16  FILLER                         PIC X(304).
  4960
  4961
  4962****************************************************************
  4963*             CARRIER MASTER RECORD                            *
  4964****************************************************************
  4965
  4966     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4967         16  CF-ADDRESS-DATA.
  4968             20  CF-MAIL-TO-NAME            PIC X(30).
  4969             20  CF-IN-CARE-OF              PIC X(30).
  4970             20  CF-ADDRESS-LINE-1          PIC X(30).
  4971             20  CF-ADDRESS-LINE-2          PIC X(30).
  4972             20  CF-CITY-STATE              PIC X(30).
  4973             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  4974             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  4975
  4976         16  CF-CLAIM-NO-CONTROL.
  4977             20  CF-CLAIM-NO-METHOD         PIC X.
  4978                 88  CLAIM-NO-MANUAL            VALUE '1'.
  4979                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  4980                 88  CLAIM-NO-SEQ               VALUE '3'.
  4981                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  4982             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  4983                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  4984                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  4985                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  4986
  4987         16  CF-CHECK-NO-CONTROL.
  4988             20  CF-CHECK-NO-METHOD         PIC X.
  4989                 88  CHECK-NO-MANUAL            VALUE '1'.
  4990                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  4991                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  4992                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  4993             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  4994                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  4995
  4996         16  CF-DOMICILE-STATE              PIC XX.
  4997
  4998         16  CF-EXPENSE-CONTROLS.
  4999             20  CF-EXPENSE-METHOD          PIC X.
  5000                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  5001                 88  DOLLARS-PER-PMT            VALUE '2'.
  5002                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  5003                 88  DOLLARS-PER-MONTH          VALUE '4'.
  5004             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  5005             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  5006
  5007         16  CF-CORRESPONDENCE-CONTROL.
  5008             20  CF-LETTER-RESEND-OPT       PIC X.
  5009                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  5010                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  5011             20  FILLER                     PIC X(4).
  5012
  5013         16  CF-RESERVE-CONTROLS.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page  95
* EL156.cbl
  5014             20  CF-MANUAL-SW               PIC X.
  5015                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  5016             20  CF-FUTURE-SW               PIC X.
  5017                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  5018             20  CF-PTC-SW                  PIC X.
  5019                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  5020             20  CF-IBNR-SW                 PIC X.
  5021                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  5022             20  CF-PTC-LF-SW               PIC X.
  5023                 88  CF-LF-PTC-USED             VALUE '1'.
  5024             20  CF-CDT-ACCESS-METHOD       PIC X.
  5025                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  5026                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  5027                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  5028             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  5029
  5030         16  CF-CLAIM-CALC-METHOD           PIC X.
  5031             88  360-PLUS-MONTHS                VALUE '1'.
  5032             88  365-PLUS-MONTHS                VALUE '2'.
  5033             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  5034             88  360-DAILY                      VALUE '4'.
  5035             88  365-DAILY                      VALUE '5'.
  5036
  5037         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  5038         16  FILLER                         PIC X(11).
  5039
  5040         16  CF-LIMIT-AMOUNTS.
  5041             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  5042             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  5043             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  5044             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  5045             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  5046             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  5047             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  5048             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  5049             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  5050             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  5051
  5052         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  5053         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  5054         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  5055
  5056         16  CF-ZIP-CODE.
  5057             20  CF-ZIP-PRIME.
  5058                 24  CF-ZIP-1ST             PIC X.
  5059                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5060                 24  FILLER                 PIC X(4).
  5061             20  CF-ZIP-PLUS4               PIC X(4).
  5062         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  5063             20  CF-CAN-POSTAL-1            PIC XXX.
  5064             20  CF-CAN-POSTAL-2            PIC XXX.
  5065             20  FILLER                     PIC XXX.
  5066
  5067         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  5068         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  5069         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  5070
  5071         16  CF-RATING-SWITCH               PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page  96
* EL156.cbl
  5072             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  5073             88  CF-NO-RATING                   VALUE 'N'.
  5074
  5075         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  5076
  5077         16  CF-CARRIER-OVER-SHORT.
  5078             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5079             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5080
  5081         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  5082         16  CF-SECPAY-SWITCH               PIC X.
  5083             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  5084             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  5085         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  5086         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  5087         16  FILLER                         PIC X(444).
  5088*        16  FILLER                         PIC X(452).
  5089
  5090
  5091****************************************************************
  5092*             MORTALITY MASTER RECORD                          *
  5093****************************************************************
  5094
  5095     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5096         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  5097                                INDEXED BY CF-MORT-NDX.
  5098             20  CF-MORT-TABLE              PIC X(5).
  5099             20  CF-MORT-TABLE-TYPE         PIC X.
  5100                 88  CF-MORT-JOINT              VALUE 'J'.
  5101                 88  CF-MORT-SINGLE             VALUE 'S'.
  5102                 88  CF-MORT-COMBINED           VALUE 'C'.
  5103                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  5104                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  5105             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  5106             20  CF-MORT-AGE-METHOD         PIC XX.
  5107                 88  CF-AGE-LAST                VALUE 'AL'.
  5108                 88  CF-AGE-NEAR                VALUE 'AN'.
  5109             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  5110             20  CF-MORT-ADJUSTMENT-DIRECTION
  5111                                            PIC X.
  5112                 88  CF-MINUS                   VALUE '-'.
  5113                 88  CF-PLUS                    VALUE '+'.
  5114             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  5115             20  CF-MORT-JOINT-CODE         PIC X.
  5116                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  5117             20  CF-MORT-PC-Q               PIC X.
  5118                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  5119             20  CF-MORT-TABLE-CODE         PIC X(4).
  5120             20  CF-MORT-COMMENTS           PIC X(15).
  5121             20  FILLER                     PIC X(14).
  5122
  5123         16  FILLER                         PIC X(251).
  5124
  5125
  5126****************************************************************
  5127*             BUSSINESS TYPE MASTER RECORD                     *
  5128****************************************************************
  5129
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page  97
* EL156.cbl
  5130     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5131* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  5132* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  5133* AND RECORD 05 IS TYPES 81-99
  5134         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  5135             20  CF-BUSINESS-TITLE          PIC  X(19).
  5136             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  5137                                            PIC S9V9(4) COMP-3.
  5138             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  5139             20  FILLER                     PIC  X.
  5140         16  FILLER                         PIC  X(248).
  5141
  5142
  5143****************************************************************
  5144*             TERMINAL MASTER RECORD                           *
  5145****************************************************************
  5146
  5147     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5148
  5149         16  CF-COMPANY-TERMINALS.
  5150             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  5151                                  PIC X(4).
  5152         16  FILLER               PIC X(248).
  5153
  5154
  5155****************************************************************
  5156*             LIFE EDIT MASTER RECORD                          *
  5157****************************************************************
  5158
  5159     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5160         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  5161             20  CF-LIFE-CODE-IN            PIC XX.
  5162             20  CF-LIFE-CODE-OUT           PIC XX.
  5163         16  FILLER                         PIC X(248).
  5164
  5165
  5166****************************************************************
  5167*             AH EDIT MASTER RECORD                            *
  5168****************************************************************
  5169
  5170     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5171         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  5172             20  CF-AH-CODE-IN              PIC XXX.
  5173             20  CF-AH-CODE-OUT             PIC XX.
  5174         16  FILLER                         PIC X(248).
  5175
  5176
  5177****************************************************************
  5178*             CREDIBILITY TABLES                               *
  5179****************************************************************
  5180
  5181     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5182         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  5183                             INDEXED BY CF-CRDB-NDX.
  5184             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  5185             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  5186             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  5187         16  FILLER                         PIC  X(332).
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page  98
* EL156.cbl
  5188
  5189
  5190****************************************************************
  5191*             REPORT CUSTOMIZATION RECORD                      *
  5192****************************************************************
  5193
  5194     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  5195         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  5196             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  5197             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  5198             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  5199**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  5200****       A T-TRANSFER.                                   ****
  5201             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  5202
  5203         16  FILLER                         PIC XX.
  5204
  5205         16  CF-CARRIER-CNTL-OPT.
  5206             20  CF-CARRIER-OPT-SEQ         PIC 9.
  5207                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  5208                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  5209             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  5210                                            PIC X.
  5211         16  CF-GROUP-CNTL-OPT.
  5212             20  CF-GROUP-OPT-SEQ           PIC 9.
  5213                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  5214                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  5215             20  CF-GROUP-SELECT OCCURS 3 TIMES
  5216                                            PIC X(6).
  5217         16  CF-STATE-CNTL-OPT.
  5218             20  CF-STATE-OPT-SEQ           PIC 9.
  5219                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  5220                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  5221             20  CF-STATE-SELECT OCCURS 3 TIMES
  5222                                            PIC XX.
  5223         16  CF-ACCOUNT-CNTL-OPT.
  5224             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  5225                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  5226                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  5227             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  5228                                            PIC X(10).
  5229         16  CF-BUS-TYP-CNTL-OPT.
  5230             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  5231                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  5232                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  5233             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  5234                                            PIC XX.
  5235         16  CF-LF-TYP-CNTL-OPT.
  5236             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  5237                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  5238                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  5239             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  5240                                            PIC XX.
  5241         16  CF-AH-TYP-CNTL-OPT.
  5242             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  5243                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  5244                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  5245             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page  99
* EL156.cbl
  5246                                            PIC XX.
  5247         16  CF-REPTCD1-CNTL-OPT.
  5248             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  5249                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  5250                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  5251             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  5252                                            PIC X(10).
  5253         16  CF-REPTCD2-CNTL-OPT.
  5254             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  5255                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  5256                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  5257             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  5258                                            PIC X(10).
  5259         16  CF-USER1-CNTL-OPT.
  5260             20  CF-USER1-OPT-SEQ           PIC 9.
  5261                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  5262                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  5263             20  CF-USER1-SELECT OCCURS 3 TIMES
  5264                                            PIC X(10).
  5265         16  CF-USER2-CNTL-OPT.
  5266             20  CF-USER2-OPT-SEQ           PIC 9.
  5267                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  5268                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  5269             20  CF-USER2-SELECT OCCURS 3 TIMES
  5270                                            PIC X(10).
  5271         16  CF-USER3-CNTL-OPT.
  5272             20  CF-USER3-OPT-SEQ           PIC 9.
  5273                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  5274                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  5275             20  CF-USER3-SELECT OCCURS 3 TIMES
  5276                                            PIC X(10).
  5277         16  CF-USER4-CNTL-OPT.
  5278             20  CF-USER4-OPT-SEQ           PIC 9.
  5279                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  5280                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  5281             20  CF-USER4-SELECT OCCURS 3 TIMES
  5282                                            PIC X(10).
  5283         16  CF-USER5-CNTL-OPT.
  5284             20  CF-USER5-OPT-SEQ           PIC 9.
  5285                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  5286                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  5287             20  CF-USER5-SELECT OCCURS 3 TIMES
  5288                                            PIC X(10).
  5289         16  CF-REINS-CNTL-OPT.
  5290             20  CF-REINS-OPT-SEQ           PIC 9.
  5291                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  5292                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  5293             20  CF-REINS-SELECT OCCURS 3 TIMES.
  5294                 24  CF-REINS-PRIME         PIC XXX.
  5295                 24  CF-REINS-SUB           PIC XXX.
  5296
  5297         16  CF-AGENT-CNTL-OPT.
  5298             20  CF-AGENT-OPT-SEQ           PIC 9.
  5299                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  5300                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  5301             20  CF-AGENT-SELECT OCCURS 3 TIMES
  5302                                            PIC X(10).
  5303
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 100
* EL156.cbl
  5304         16  FILLER                         PIC X(43).
  5305
  5306         16  CF-LOSS-RATIO-SELECT.
  5307             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  5308             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  5309         16  CF-ENTRY-DATE-SELECT.
  5310             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  5311             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  5312         16  CF-EFFECTIVE-DATE-SELECT.
  5313             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  5314             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  5315
  5316         16  CF-EXCEPTION-LIST-IND          PIC X.
  5317             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  5318
  5319         16  FILLER                         PIC X(318).
  5320
  5321****************************************************************
  5322*                  EXCEPTION REPORTING RECORD                  *
  5323****************************************************************
  5324
  5325     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  5326         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  5327             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  5328
  5329         16  CF-COMBINED-LIFE-AH-OPT.
  5330             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  5331             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  5332             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  5333             20  CF-CANCELLATION-RATIO      PIC S9(02).
  5334
  5335         16  CF-LIFE-OPT.
  5336             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5337             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5338             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5339             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5340             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5341             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5342             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5343             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5344             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5345             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  5346
  5347         16  CF-AH-OPT.
  5348             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5349             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5350             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5351             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5352             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5353             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5354             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5355             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5356             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5357             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  5358
  5359         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  5360             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  5361             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 101
* EL156.cbl
  5362             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  5363
  5364         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  5365
  5366         16  FILLER                         PIC X(673).
  5367
  5368
  5369****************************************************************
  5370*             MORTGAGE SYSTEM PLAN RECORD                      *
  5371****************************************************************
  5372
  5373     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  5374         16  CF-PLAN-TYPE                   PIC X.
  5375             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  5376             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  5377             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  5378         16  CF-PLAN-ABBREV                 PIC XXX.
  5379         16  CF-PLAN-DESCRIPT               PIC X(10).
  5380         16  CF-PLAN-NOTES                  PIC X(20).
  5381         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  5382         16  CF-PLAN-UNDERWRITING.
  5383             20  CF-PLAN-TERM-DATA.
  5384                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  5385                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  5386             20  CF-PLAN-AGE-DATA.
  5387                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  5388                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  5389                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  5390             20  CF-PLAN-BENEFIT-DATA.
  5391                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5392                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5393                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  5394                                            PIC S9(7)V99  COMP-3.
  5395         16  CF-PLAN-POLICY-FORMS.
  5396             20  CF-POLICY-FORM             PIC X(12).
  5397             20  CF-MASTER-APPLICATION      PIC X(12).
  5398             20  CF-MASTER-POLICY           PIC X(12).
  5399         16  CF-PLAN-RATING.
  5400             20  CF-RATE-CODE               PIC X(5).
  5401             20  CF-SEX-RATING              PIC X.
  5402                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  5403                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  5404             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  5405             20  CF-SUB-STD-TYPE            PIC X.
  5406                 88  CF-PCT-OF-PREM            VALUE '1'.
  5407                 88  CF-PCT-OF-BENE            VALUE '2'.
  5408         16  CF-PLAN-PREM-TOLERANCES.
  5409             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  5410             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  5411         16  CF-PLAN-PYMT-TOLERANCES.
  5412             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  5413             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  5414         16  CF-PLAN-MISC-DATA.
  5415             20  FILLER                     PIC X.
  5416             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  5417             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  5418         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  5419         16  CF-PLAN-IND-GRP                PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 102
* EL156.cbl
  5420             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  5421                                                     '1'.
  5422             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  5423                                                     '2'.
  5424         16  CF-MIB-SEARCH-SW               PIC X.
  5425             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  5426             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  5427             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  5428             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  5429         16  CF-ALPHA-SEARCH-SW             PIC X.
  5430             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  5431             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  5432             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  5433             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  5434             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  5435             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  5436             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  5437             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  5438             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  5439             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  5440                                                     'A' 'B' 'C'
  5441                                                     'X' 'Y' 'Z'.
  5442         16  CF-EFF-DT-RULE-SW              PIC X.
  5443             88  CF-EFF-DT-ENTER               VALUE 'E'.
  5444             88  CF-EFF-DT-MONTH               VALUE 'M'.
  5445             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  5446             88  CF-EFF-DT-SEMI                VALUE 'S'.
  5447             88  CF-EFF-DT-ANN                 VALUE 'A'.
  5448         16  FILLER                         PIC X(4).
  5449         16  CF-HEALTH-QUESTIONS            PIC X.
  5450             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  5451         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  5452         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  5453         16  CF-PLAN-SNGL-JNT               PIC X.
  5454             88  CF-COMBINED-PLAN              VALUE 'C'.
  5455             88  CF-JNT-PLAN                   VALUE 'J'.
  5456             88  CF-SNGL-PLAN                  VALUE 'S'.
  5457         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  5458         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  5459         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  5460         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  5461         16  CF-RERATE-CNTL                 PIC  X.
  5462             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  5463             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  5464             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  5465             88  CF-AUTO-RECALC                 VALUE '4'.
  5466         16  CF-BENEFIT-TYPE                PIC  X.
  5467             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  5468             88  CF-BENEFIT-REDUCES             VALUE '2'.
  5469         16  CF-POLICY-FEE                  PIC S999V99
  5470                                                    COMP-3.
  5471         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  5472         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  5473         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  5474         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  5475         16  FILLER                         PIC  X(32).
  5476         16  CF-TERMINATION-FORM            PIC  X(04).
  5477         16  FILLER                         PIC  X(08).
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 103
* EL156.cbl
  5478         16  CF-CLAIM-CAP                   PIC S9(7)V99
  5479                                                       COMP-3.
  5480         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  5481         16  CF-ISSUE-LETTER                PIC  X(4).
  5482         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  5483         16  CF-DEPENDENT-COVERAGE          PIC  X.
  5484             88  CF-YES-DEP-COV                 VALUE 'Y'.
  5485             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  5486         16  CF-MP-REFUND-CALC              PIC X.
  5487             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  5488             88  CF-MP-REFD-BY-R78              VALUE '1'.
  5489             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  5490             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  5491             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  5492             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  5493             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  5494             88  CF-MP-REFD-MEAN                VALUE '8'.
  5495         16  CF-ALT-RATE-CODE               PIC  X(5).
  5496
  5497
  5498         16  FILLER                         PIC X(498).
  5499****************************************************************
  5500*             MORTGAGE COMPANY MASTER RECORD                   *
  5501****************************************************************
  5502
  5503     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5504         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  5505         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  5506             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  5507             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  5508             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  5509             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  5510             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  5511
  5512         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  5513         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  5514         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  5515         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  5516         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  5517
  5518         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  5519             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  5520         16  CF-MP-RECON-USE-IND            PIC X(1).
  5521             88  CF-MP-USE-RECON             VALUE 'Y'.
  5522         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  5523             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  5524         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  5525             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  5526             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  5527         16  FILLER                         PIC X(1).
  5528         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  5529             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  5530         16  CF-MORTG-MIB-VERSION           PIC X.
  5531             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  5532             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  5533             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  5534         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  5535             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 104
* EL156.cbl
  5536                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  5537             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  5538                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  5539             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  5540                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  5541             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  5542                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  5543             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  5544                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  5545             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  5546                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  5547         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  5548         16  FILLER                         PIC X(7).
  5549         16  CF-MORTG-DESTINATION-SYMBOL.
  5550             20  CF-MORTG-MIB-COMM          PIC X(5).
  5551             20  CF-MORTG-MIB-TERM          PIC X(5).
  5552         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  5553             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  5554         16  FILLER                         PIC X(03).
  5555         16  CF-MP-CHECK-NO-CONTROL.
  5556             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  5557                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  5558                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  5559                                                ' ' LOW-VALUES.
  5560                 88  CF-MP-CHECK-NO-PRE-PRINTED
  5561                                               VALUE '3'.
  5562         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  5563         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  5564         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  5565             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  5566                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  5567             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  5568                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  5569             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  5570                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  5571             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  5572                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  5573             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  5574                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  5575             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  5576                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  5577         16  CF-MORTG-BILLING-AREA.
  5578             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  5579                                            PIC X.
  5580         16  CF-MORTG-MONTH-END-DT          PIC XX.
  5581         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  5582         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  5583         16  CF-MORTG-MIB-DEST-SW           PIC X.
  5584             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  5585             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  5586         16  FILLER                         PIC X.
  5587         16  CF-MORTG-LABEL-CONTROL         PIC X.
  5588             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  5589             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  5590         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  5591         16  FILLER                         PIC X(8).
  5592         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  5593         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 105
* EL156.cbl
  5594         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  5595         16  CF-ACH-COMPANY-ID.
  5596             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  5597                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  5598                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  5599                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  5600             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  5601         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  5602             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  5603         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  5604             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  5605             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  5606         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  5607         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  5608         16  FILLER                         PIC X(536).
  5609
  5610****************************************************************
  5611*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  5612****************************************************************
  5613
  5614     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  5615         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  5616             20  CF-FEMALE-HEIGHT.
  5617                 24  CF-FEMALE-FT           PIC 99.
  5618                 24  CF-FEMALE-IN           PIC 99.
  5619             20  CF-FEMALE-MIN-WT           PIC 999.
  5620             20  CF-FEMALE-MAX-WT           PIC 999.
  5621         16  FILLER                         PIC X(428).
  5622
  5623     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  5624         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  5625             20  CF-MALE-HEIGHT.
  5626                 24  CF-MALE-FT             PIC 99.
  5627                 24  CF-MALE-IN             PIC 99.
  5628             20  CF-MALE-MIN-WT             PIC 999.
  5629             20  CF-MALE-MAX-WT             PIC 999.
  5630         16  FILLER                         PIC X(428).
  5631******************************************************************
  5632*             AUTOMATIC ACTIVITY RECORD                          *
  5633******************************************************************
  5634     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  5635         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  5636             20  CF-SYS-ACTIVE-SW           PIC X(01).
  5637             20  CF-SYS-LETTER-ID           PIC X(04).
  5638             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  5639             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  5640             20  CF-SYS-RESET-SW            PIC X(01).
  5641             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  5642             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  5643
  5644         16  FILLER                         PIC X(50).
  5645
  5646         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  5647             20  CF-USER-ACTIVE-SW          PIC X(01).
  5648             20  CF-USER-LETTER-ID          PIC X(04).
  5649             20  CF-USER-RESEND-DAYS        PIC 9(03).
  5650             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  5651             20  CF-USER-RESET-SW           PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 106
* EL156.cbl
  5652             20  CF-USER-REPORT-DAYS        PIC 9(03).
  5653             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  5654             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  5655
  5656         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 107
* EL156.cbl
  5658*    COPY ELCCERT.
  5659******************************************************************
  5660*                                                                *
  5661*                            ELCCERT.                            *
  5662*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5663*                            VMOD=2.013                          *
  5664*                                                                *
  5665*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  5666*                                                                *
  5667*   FILE TYPE = VSAM,KSDS                                        *
  5668*   RECORD SIZE = 450  RECFORM = FIXED                           *
  5669*                                                                *
  5670*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  5671*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  5672*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  5673*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  5674*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  5675*                                                                *
  5676*   LOG = YES                                                    *
  5677*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5678******************************************************************
  5679*                   C H A N G E   L O G
  5680*
  5681* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5682*-----------------------------------------------------------------
  5683*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5684* EFFECTIVE    NUMBER
  5685*-----------------------------------------------------------------
  5686* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  5687* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  5688* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  5689* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  5690* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  5691* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  5692* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5693* 032612  CR2011110200001  PEMA  AHL CHANGES
  5694* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  5695* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  5696* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
  5697******************************************************************
  5698
  5699 01  CERTIFICATE-MASTER.
  5700     12  CM-RECORD-ID                      PIC XX.
  5701         88  VALID-CM-ID                      VALUE 'CM'.
  5702
  5703     12  CM-CONTROL-PRIMARY.
  5704         16  CM-COMPANY-CD                 PIC X.
  5705         16  CM-CARRIER                    PIC X.
  5706         16  CM-GROUPING.
  5707             20  CM-GROUPING-PREFIX        PIC X(3).
  5708             20  CM-GROUPING-PRIME         PIC X(3).
  5709         16  CM-STATE                      PIC XX.
  5710         16  CM-ACCOUNT.
  5711             20  CM-ACCOUNT-PREFIX         PIC X(4).
  5712             20  CM-ACCOUNT-PRIME          PIC X(6).
  5713         16  CM-CERT-EFF-DT                PIC XX.
  5714         16  CM-CERT-NO.
  5715             20  CM-CERT-PRIME             PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 108
* EL156.cbl
  5716             20  CM-CERT-SFX               PIC X.
  5717
  5718     12  CM-CONTROL-BY-NAME.
  5719         16  CM-COMPANY-CD-A1              PIC X.
  5720         16  CM-INSURED-LAST-NAME          PIC X(15).
  5721         16  CM-INSURED-INITIALS.
  5722             20  CM-INSURED-INITIAL1       PIC X.
  5723             20  CM-INSURED-INITIAL2       PIC X.
  5724
  5725     12  CM-CONTROL-BY-SSN.
  5726         16  CM-COMPANY-CD-A2              PIC X.
  5727         16  CM-SOC-SEC-NO.
  5728             20  CM-SSN-STATE              PIC XX.
  5729             20  CM-SSN-ACCOUNT            PIC X(6).
  5730             20  CM-SSN-LN3.
  5731                 25  CM-INSURED-INITIALS-A2.
  5732                     30 CM-INSURED-INITIAL1-A2   PIC X.
  5733                     30 CM-INSURED-INITIAL2-A2   PIC X.
  5734                 25 CM-PART-LAST-NAME-A2         PIC X.
  5735
  5736     12  CM-CONTROL-BY-CERT-NO.
  5737         16  CM-COMPANY-CD-A4              PIC X.
  5738         16  CM-CERT-NO-A4                 PIC X(11).
  5739
  5740     12  CM-CONTROL-BY-MEMB.
  5741         16  CM-COMPANY-CD-A5              PIC X.
  5742         16  CM-MEMBER-NO.
  5743             20  CM-MEMB-STATE             PIC XX.
  5744             20  CM-MEMB-ACCOUNT           PIC X(6).
  5745             20  CM-MEMB-LN4.
  5746                 25  CM-INSURED-INITIALS-A5.
  5747                     30 CM-INSURED-INITIAL1-A5   PIC X.
  5748                     30 CM-INSURED-INITIAL2-A5   PIC X.
  5749                 25 CM-PART-LAST-NAME-A5         PIC XX.
  5750
  5751     12  CM-INSURED-PROFILE-DATA.
  5752         16  CM-INSURED-FIRST-NAME.
  5753             20  CM-INSURED-1ST-INIT       PIC X.
  5754             20  FILLER                    PIC X(9).
  5755         16  CM-INSURED-ISSUE-AGE          PIC 99.
  5756         16  CM-INSURED-SEX                PIC X.
  5757             88  CM-SEX-MALE                  VALUE 'M'.
  5758             88  CM-SEX-FEMAL                 VALUE 'F'.
  5759         16  CM-INSURED-JOINT-AGE          PIC 99.
  5760         16  CM-JOINT-INSURED-NAME.
  5761             20  CM-JT-LAST-NAME           PIC X(15).
  5762             20  CM-JT-FIRST-NAME.
  5763                 24  CM-JT-1ST-INIT        PIC X.
  5764                 24  FILLER                PIC X(9).
  5765             20  CM-JT-INITIAL             PIC X.
  5766
  5767     12  CM-LIFE-DATA.
  5768         16  CM-LF-BENEFIT-CD              PIC XX.
  5769         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  5770         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  5771         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  5772         16  CM-LF-DEV-CODE                PIC XXX.
  5773         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 109
* EL156.cbl
  5774         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  5775         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  5776         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  5777         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5778         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5779         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  5780         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5781         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  5782         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  5783         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  5784         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  5785         16  cm-temp-epiq                  pic xx.
  5786             88  EPIQ-CLASS                  value 'EQ'.
  5787*        16  FILLER                        PIC XX.
  5788
  5789     12  CM-AH-DATA.
  5790         16  CM-AH-BENEFIT-CD              PIC XX.
  5791         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  5792         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  5793         16  CM-AH-DEV-CODE                PIC XXX.
  5794         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  5795         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  5796         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  5797         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5798         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5799         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  5800         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  5801         16  CM-AH-PAID-THRU-DT            PIC XX.
  5802             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  5803         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  5804         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  5805         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  5806         16  FILLER                        PIC X.
  5807
  5808     12  CM-LOAN-INFORMATION.
  5809         16  CM-LIVES                      PIC S9(7)     COMP-3.
  5810         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  5811                                           PIC S9(5)V99  COMP-3.
  5812         16  CM-BILLED                     PIC S9(7)     COMP-3.
  5813         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  5814         16  CM-PAY-FREQUENCY              PIC S99.
  5815         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  5816         16  CM-RATE-CLASS                 PIC XX.
  5817         16  CM-BENEFICIARY                PIC X(25).
  5818         16  CM-POLICY-FORM-NO             PIC X(12).
  5819         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  5820         16  CM-LAST-ADD-ON-DT             PIC XX.
  5821         16  CM-DEDUCTIBLE-AMOUNTS.
  5822             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  5823             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  5824         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  5825             20  CM-RESIDENT-STATE         PIC XX.
  5826             20  CM-RATE-CODE              PIC X(4).
  5827             20  FILLER                    PIC XX.
  5828         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  5829             20  CM-LOAN-OFFICER           PIC X(5).
  5830             20  FILLER                    PIC XXX.
  5831         16  CM-CSR-CODE                   PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 110
* EL156.cbl
  5832         16  CM-UNDERWRITING-CODE          PIC X.
  5833             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  5834         16  CM-POST-CARD-IND              PIC X.
  5835         16  CM-REF-INTERFACE-SW           PIC X.
  5836         16  CM-PREMIUM-TYPE               PIC X.
  5837             88  CM-SING-PRM                  VALUE '1'.
  5838             88  CM-O-B-COVERAGE              VALUE '2'.
  5839             88  CM-OPEN-END                  VALUE '3'.
  5840         16  CM-IND-GRP-TYPE               PIC X.
  5841             88  CM-INDIVIDUAL                VALUE 'I'.
  5842             88  CM-GROUP                     VALUE 'G'.
  5843         16  CM-SKIP-CODE                  PIC X.
  5844             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  5845             88  SKIP-JULY                    VALUE '1'.
  5846             88  SKIP-AUGUST                  VALUE '2'.
  5847             88  SKIP-SEPTEMBER               VALUE '3'.
  5848             88  SKIP-JULY-AUG                VALUE '4'.
  5849             88  SKIP-AUG-SEPT                VALUE '5'.
  5850             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  5851             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  5852             88  SKIP-JUNE                    VALUE '8'.
  5853             88  SKIP-JUNE-JULY               VALUE '9'.
  5854             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  5855             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  5856         16  CM-PAYMENT-MODE               PIC X.
  5857             88  PAY-MONTHLY                  VALUE SPACE.
  5858             88  PAY-WEEKLY                   VALUE '1'.
  5859             88  PAY-SEMI-MONTHLY             VALUE '2'.
  5860             88  PAY-BI-WEEKLY                VALUE '3'.
  5861             88  PAY-SEMI-ANUALLY             VALUE '4'.
  5862         16  CM-LOAN-NUMBER                PIC X(8).
  5863         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  5864         16  CM-OLD-LOF                    PIC XXX.
  5865*        16  CM-LOAN-OFFICER               PIC XXX.
  5866         16  CM-REIN-TABLE                 PIC XXX.
  5867         16  CM-SPECIAL-REIN-CODE          PIC X.
  5868         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  5869         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  5870         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  5871
  5872     12  CM-STATUS-DATA.
  5873         16  CM-ENTRY-STATUS               PIC X.
  5874         16  CM-ENTRY-DT                   PIC XX.
  5875
  5876         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  5877         16  CM-LF-CANCEL-DT               PIC XX.
  5878         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  5879
  5880         16  CM-LF-STATUS-AT-DEATH         PIC X.
  5881         16  CM-LF-DEATH-DT                PIC XX.
  5882         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  5883
  5884         16  CM-LF-CURRENT-STATUS          PIC X.
  5885             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5886                                                'M' '4' '5' '9'.
  5887             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  5888             88  CM-LF-POLICY-PENDING         VALUE '2'.
  5889             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 111
* EL156.cbl
  5890             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  5891             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  5892             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  5893             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  5894             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  5895             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  5896             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  5897             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  5898             88  CM-LF-DECLINED               VALUE 'D'.
  5899             88  CM-LF-VOIDED                 VALUE 'V'.
  5900
  5901         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  5902         16  CM-AH-CANCEL-DT               PIC XX.
  5903         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  5904
  5905         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  5906         16  CM-AH-SETTLEMENT-DT           PIC XX.
  5907         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  5908
  5909         16  CM-AH-CURRENT-STATUS          PIC X.
  5910             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5911                                                'M' '4' '5' '9'.
  5912             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  5913             88  CM-AH-POLICY-PENDING         VALUE '2'.
  5914             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  5915             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  5916             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  5917             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  5918             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  5919             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  5920             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  5921             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  5922             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  5923             88  CM-AH-DECLINED               VALUE 'D'.
  5924             88  CM-AH-VOIDED                 VALUE 'V'.
  5925
  5926         16  CM-CLAIM-INTERFACE-SW         PIC X.
  5927             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  5928             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  5929             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  5930         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  5931
  5932         16  CM-ENTRY-BATCH                PIC X(6).
  5933         16  CM-LF-EXIT-BATCH              PIC X(6).
  5934         16  CM-AH-EXIT-BATCH              PIC X(6).
  5935         16  CM-LAST-MONTH-END             PIC XX.
  5936
  5937     12  CM-NOTE-SW                        PIC X.
  5938         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  5939         88  CERT-NOTES-PRESENT               VALUE '1'.
  5940         88  BILLING-NOTES-PRESENT            VALUE '2'.
  5941         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  5942         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  5943         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  5944         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  5945         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  5946     12  CM-COMP-EXCP-SW                   PIC X.
  5947         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 112
* EL156.cbl
  5948         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  5949     12  CM-INSURED-ADDRESS-SW             PIC X.
  5950         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  5951         88  INSURED-ADDR-PRESENT             VALUE '1'.
  5952
  5953*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  5954     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  5955     12  FILLER                            PIC X.
  5956
  5957*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  5958     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  5959     12  FILLER                            PIC X.
  5960*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  5961     12  CM-INT-ON-REFS                    PIC S9(7)V99   COMP-3.
  5962
  5963     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  5964         88  CERT-ADDED-BATCH                 VALUE ' '.
  5965         88  CERT-ADDED-ONLINE                VALUE '1'.
  5966         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  5967         88  CERT-PURGED-OFFLINE              VALUE '3'.
  5968         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  5969     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  5970         88  CERT-AS-LOADED                   VALUE ' '.
  5971         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  5972         88  CERT-CLAIM-ONLINE                VALUE '2'.
  5973         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  5974         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  5975         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  5976         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  5977         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  5978
  5979     12  CM-ACCOUNT-COMM-PCTS.
  5980         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  5981         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  5982
  5983     12  CM-USER-FIELD                     PIC X.
  5984     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  5985     12  CM-CLP-STATE                      PIC XX.
  5986     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  5987     12  CM-USER-RESERVED                  PIC XXX.
  5988     12  FILLER REDEFINES CM-USER-RESERVED.
  5989         16  CM-AH-CLASS-CD                PIC XX.
  5990         16  F                             PIC X.
  5991******************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 113
* EL156.cbl
  5993*    COPY ELCTRLR.
  5994******************************************************************
  5995*                                                                *
  5996*                            ELCTRLR.                            *
  5997*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5998*                            VMOD=2.014                          *
  5999*                                                                *
  6000*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  6001*                                                                *
  6002*   FILE TYPE = VSAM,KSDS                                        *
  6003*   RECORD SIZE = 200    RECFORM = FIXED                         *
  6004*                                                                *
  6005*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  6006*       ALTERNATE INDEX = NONE                                   *
  6007*                                                                *
  6008*   LOG = YES                                                    *
  6009*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6010******************************************************************
  6011*                   C H A N G E   L O G
  6012*
  6013* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6014*-----------------------------------------------------------------
  6015*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6016* EFFECTIVE    NUMBER
  6017*-----------------------------------------------------------------
  6018* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  6019* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
  6020* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
  6021* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
  6022* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  6023* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  6024* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  6025* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
  6026* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  6027* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  6028* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  6029* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  6030* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAIL
  6031* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
  6032* 021213    2012092400007  AJRA  CAUSAL STATE SEQUENCE NO
  6033* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  6034* 102413  CR2013100800001  AJRA  ADD SPECIAL RELEASE IND
  6035* 022614    2013050100003  AJRA  ADD CERT CANCELLED NOTE TYPE - T
  6036* 040814    2014030500002  AJRA  ADD ICD CODES
  6037* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  6038* 013017  CR2016053100001  PEMA  ACH PROCESSING
  6039* 062217  CR2017050300002  TANA  ADD AUTH RCVD
  6040******************************************************************
  6041 01  ACTIVITY-TRAILERS.
  6042     12  AT-RECORD-ID                    PIC XX.
  6043         88  VALID-AT-ID                       VALUE 'AT'.
  6044
  6045     12  AT-CONTROL-PRIMARY.
  6046         16  AT-COMPANY-CD               PIC X.
  6047         16  AT-CARRIER                  PIC X.
  6048         16  AT-CLAIM-NO                 PIC X(7).
  6049         16  AT-CERT-NO.
  6050             20  AT-CERT-PRIME           PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 114
* EL156.cbl
  6051             20  AT-CERT-SFX             PIC X.
  6052         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
  6053             88  AT-1ST-TRL-AVAIL             VALUE +4095.
  6054             88  AT-LAST-TRL-AVAIL            VALUE +100.
  6055             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
  6056             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
  6057             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
  6058             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  6059             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
  6060             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
  6061             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  6062             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  6063             88  AT-DIAGNOSIS-TRL             VALUE +90.
  6064             88  AT-BENEFICIARY-TRL           VALUE +91.
  6065             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  6066             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
  6067             88  AT-VFY-CAUSAL-STATE          VALUE +94.
  6068             88  AT-ERROR-MSGS-TRL            VALUE +95.
  6069
  6070     12  AT-TRAILER-TYPE                 PIC X.
  6071         88  RESERVE-EXPENSE-TR               VALUE '1'.
  6072         88  PAYMENT-TR                       VALUE '2'.
  6073         88  AUTO-PAY-TR                      VALUE '3'.
  6074         88  CORRESPONDENCE-TR                VALUE '4'.
  6075         88  ADDRESS-TR                       VALUE '5'.
  6076         88  GENERAL-INFO-TR                  VALUE '6'.
  6077         88  AUTO-PROMPT-TR                   VALUE '7'.
  6078         88  DENIAL-TR                        VALUE '8'.
  6079         88  INCURRED-CHG-TR                  VALUE '9'.
  6080         88  FORM-CONTROL-TR                  VALUE 'A'.
  6081
  6082     12  AT-RECORDED-DT                  PIC XX.
  6083     12  AT-RECORDED-BY                  PIC X(4).
  6084     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  6085
  6086     12  AT-TRAILER-BODY                 PIC X(165).
  6087
  6088     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  6089         16  AT-RESERVE-CONTROLS.
  6090             20  AT-MANUAL-SW            PIC X.
  6091                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  6092             20  AT-FUTURE-SW            PIC X.
  6093                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  6094             20  AT-PTC-SW               PIC X.
  6095                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  6096             20  AT-IBNR-SW              PIC X.
  6097                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  6098             20  AT-PTC-LF-SW            PIC X.
  6099                 88  AT-LF-PTC-USED          VALUE '1'.
  6100             20  AT-CDT-ACCESS-METHOD    PIC X.
  6101                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  6102                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  6103                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  6104             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
  6105         16  AT-LAST-COMPUTED-DT         PIC XX.
  6106         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
  6107         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
  6108         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 115
* EL156.cbl
  6109         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  6110         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  6111         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
  6112         16  AT-EXPENSE-CONTROLS.
  6113             20  AT-EXPENSE-METHOD       PIC X.
  6114                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
  6115                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  6116                 88  PERCENT-OF-PMT           VALUE '3'.
  6117                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  6118             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  6119             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
  6120         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  6121         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
  6122
  6123         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  6124         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  6125
  6126*        16  FILLER                      PIC X(53).
  6127         16  FILLER                      PIC X(47).
  6128
  6129         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  6130         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  6131
  6132         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  6133             20  AT-OPEN-CLOSE-DATE      PIC XX.
  6134             20  AT-OPEN-CLOSE-TYPE      PIC X.
  6135*                    C = CLOSED
  6136*                    O = OPEN
  6137             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  6138*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  6139
  6140     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  6141         16  AT-PAYMENT-TYPE             PIC X.
  6142             88  PARTIAL-PAYMENT                VALUE '1'.
  6143             88  FINAL-PAYMENT                  VALUE '2'.
  6144             88  LUMP-SUM-PAYMENT               VALUE '3'.
  6145             88  ADDITIONAL-PAYMENT             VALUE '4'.
  6146             88  CHARGEABLE-EXPENSE             VALUE '5'.
  6147             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  6148             88  VOIDED-PAYMENT                 VALUE '9'.
  6149             88  TRANSFER                       VALUE 'T'.
  6150             88  LIFE-INTEREST                  VALUE 'I'.
  6151
  6152         16  AT-CLAIM-TYPE               PIC X.
  6153             88  PAID-FOR-AH                    VALUE 'A'.
  6154             88  PAID-FOR-LIFE                  VALUE 'L'.
  6155             88  PAID-FOR-IUI                   VALUE 'I'.
  6156             88  PAID-FOR-GAP                   VALUE 'G'.
  6157             88  PAID-FOR-FAM                   VALUE 'F'.
  6158         16  AT-CLAIM-PREM-TYPE          PIC X.
  6159             88  AT-SINGLE-PREMIUM              VALUE '1'.
  6160             88  AT-O-B-COVERAGE                VALUE '2'.
  6161             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  6162         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
  6163         16  AT-CHECK-NO                 PIC X(7).
  6164         16  AT-PAID-FROM-DT             PIC XX.
  6165         16  AT-PAID-THRU-DT             PIC XX.
  6166         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 116
* EL156.cbl
  6167         16  AT-ACH-PAYMENT              PIC X.
  6168*        16  FILLER                      PIC X.
  6169         16  AT-PAYEES-NAME              PIC X(30).
  6170         16  AT-PAYMENT-ORIGIN           PIC X.
  6171             88  ONLINE-MANUAL-PMT              VALUE '1'.
  6172             88  ONLINE-AUTO-PMT                VALUE '2'.
  6173             88  OFFLINE-PMT                    VALUE '3'.
  6174         16  AT-CHECK-WRITTEN-DT         PIC XX.
  6175         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  6176         16  AT-VOID-DATA.
  6177             20  AT-VOID-DT              PIC XX.
  6178*00144       20  AT-VOID-REASON          PIC X(30).
  6179             20  AT-VOID-REASON          PIC X(26).
  6180         16  AT-PMT-APPROVED-BY          PIC X(04).
  6181         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
  6182         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  6183         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  6184                                         PIC S99V9(5)  COMP-3.
  6185         16  AT-CREDIT-INTERFACE.
  6186             20  AT-PMT-SELECT-DT        PIC XX.
  6187                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  6188             20  AT-PMT-ACCEPT-DT        PIC XX.
  6189                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  6190             20  AT-VOID-SELECT-DT       PIC XX.
  6191                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  6192             20  AT-VOID-ACCEPT-DT       PIC XX.
  6193                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
  6194
  6195         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
  6196                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  6197                 88  CONVERSION-PAYMENT           VALUE +99999999.
  6198         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  6199
  6200         16  AT-FORCE-CONTROL            PIC X.
  6201             88  PAYMENT-WAS-FORCED           VALUE '1'.
  6202         16  AT-PREV-LAST-PMT-DT         PIC XX.
  6203         16  AT-PREV-PAID-THRU-DT        PIC XX.
  6204         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  6205         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  6206         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  6207         16  AT-BENEFIT-TYPE             PIC X.
  6208
  6209         16  AT-EXPENSE-TYPE             PIC X.
  6210         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  6211
  6212         16  AT-PAYEE-TYPE-CD.
  6213             20  AT-PAYEE-TYPE           PIC X.
  6214                 88  INSURED-PAID           VALUE 'I'.
  6215                 88  BENEFICIARY-PAID       VALUE 'B'.
  6216                 88  ACCOUNT-PAID           VALUE 'A'.
  6217                 88  OTHER-1-PAID           VALUE 'O'.
  6218                 88  OTHER-2-PAID           VALUE 'Q'.
  6219                 88  DOCTOR-PAID            VALUE 'P'.
  6220                 88  EMPLOYER-PAID          VALUE 'E'.
  6221             20  AT-PAYEE-SEQ            PIC X.
  6222
  6223         16  AT-CASH-PAYMENT             PIC X.
  6224         16  AT-GROUPED-PAYMENT          PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 117
* EL156.cbl
  6225         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
  6226         16  AT-APPROVAL-LEVEL-REQD      PIC X.
  6227         16  AT-APPROVED-LEVEL           PIC X.
  6228         16  AT-VOID-TYPE                PIC X.
  6229             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
  6230             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
  6231         16  AT-AIG-UNEMP-IND            PIC X.
  6232             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
  6233         16  AT-ASSOCIATES               PIC X.
  6234             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
  6235             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  6236
  6237         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
  6238         16  AT-CV-PMT-CODE              PIC X.
  6239             88  FULL-DEATH-PAYMENT         VALUE '1'.
  6240             88  HALF-DEATH-PAYMENT         VALUE '2'.
  6241             88  FULL-ADD-PAYMENT           VALUE '3'.
  6242             88  HALF-ADD-PAYMENT           VALUE '4'.
  6243             88  FULL-RIDER-PAYMENT         VALUE '5'.
  6244             88  HALF-RIDER-PAYMENT         VALUE '6'.
  6245             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  6246             88  ADDL-PAYMENT               VALUE '8'.
  6247
  6248         16  AT-EOB-CODE1                PIC XXX.
  6249         16  AT-EOB-CODE2                PIC XXX.
  6250         16  AT-EOB-CODE3                PIC XXX.
  6251         16  FILLER REDEFINES AT-EOB-CODE3.
  6252             20  AT-PRINT-CLM-FORM       PIC X.
  6253             20  AT-PRINT-SURVEY         PIC X.
  6254             20  AT-SPECIAL-RELEASE      PIC X.
  6255         16  AT-EOB-CODE4                PIC XXX.
  6256         16  FILLER REDEFINES AT-EOB-CODE4.
  6257             20  AT-INT-PMT-SELECT-DT    PIC XX.
  6258             20  FILLER                  PIC X.
  6259         16  AT-EOB-CODE5                PIC XXX.
  6260         16  FILLER REDEFINES AT-EOB-CODE5.
  6261             20  AT-PMT-PROOF-DT         PIC XX.
  6262             20  FILLER                  PIC X.
  6263
  6264         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  6265             88  AT-PRINT-EOB            VALUE 'Y'.
  6266
  6267         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  6268         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  6269
  6270     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  6271         16  AT-SCHEDULE-START-DT        PIC XX.
  6272         16  AT-SCHEDULE-END-DT          PIC XX.
  6273         16  AT-TERMINATED-DT            PIC XX.
  6274         16  AT-LAST-PMT-TYPE            PIC X.
  6275             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  6276             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  6277         16  AT-FIRST-PMT-DATA.
  6278             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
  6279             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
  6280             20  AT-1ST-PAY-THRU-DT      PIC XX.
  6281         16  AT-REGULAR-PMT-DATA.
  6282             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 118
* EL156.cbl
  6283             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
  6284             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
  6285         16  AT-AUTO-PAYEE-CD.
  6286             20  AT-AUTO-PAYEE-TYPE      PIC X.
  6287                 88  INSURED-PAID-AUTO      VALUE 'I'.
  6288                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
  6289                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
  6290                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
  6291                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  6292             20  AT-AUTO-PAYEE-SEQ       PIC X.
  6293         16  AT-AUTO-PAY-DAY             PIC 99.
  6294         16  AT-AUTO-CASH                PIC X.
  6295             88  AT-CASH                      VALUE 'Y'.
  6296             88  AT-NON-CASH                  VALUE 'N'.
  6297*        16  FILLER                      PIC X(129).
  6298         16  AT-AUTO-END-LETTER          PIC X(4).
  6299         16  FILLER                      PIC X(125).
  6300
  6301         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
  6302         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  6303
  6304     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  6305         16  AT-LETTER-SENT-DT           PIC XX.
  6306         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  6307         16  AT-AUTO-RE-SEND-DT          PIC XX.
  6308         16  AT-LETTER-ANSWERED-DT       PIC XX.
  6309         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  6310         16  AT-LETTER-ORIGIN            PIC X.
  6311             88  ONLINE-CREATION              VALUE '1' '3'.
  6312             88  OFFLINE-CREATION             VALUE '2' '4'.
  6313             88  NAPER-ONLINE-CREATION        VALUE '3'.
  6314             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  6315         16  AT-STD-LETTER-FORM          PIC X(4).
  6316         16  AT-REASON-TEXT              PIC X(70).
  6317         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  6318         16  AT-ADDRESEE-TYPE            PIC X.
  6319              88  INSURED-ADDRESEE            VALUE 'I'.
  6320              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  6321              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  6322              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  6323              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  6324              88  OTHER-ADDRESEE-1            VALUE 'O'.
  6325              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  6326         16  AT-ADDRESSEE-NAME           PIC X(30).
  6327         16  AT-INITIAL-PRINT-DATE       PIC XX.
  6328         16  AT-RESEND-PRINT-DATE        PIC XX.
  6329         16  AT-CORR-SOL-UNSOL           PIC X.
  6330         16  AT-LETTER-PURGED-DT         PIC XX.
  6331*
  6332*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  6333*
  6334         16  AT-CSO-REDEFINITION.
  6335             20  AT-RESEND-LETTER-FORM   PIC X(4).
  6336             20  AT-AUTO-CLOSE-IND       PIC X(1).
  6337             20  AT-LETTER-TO-BENE       PIC X(1).
  6338             20  AT-STOP-LETTER-DT       PIC X(2).
  6339             20  AT-AUTH-RCVD            PIC X(1).
  6340             20  FILLER                  PIC X(18).
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 119
* EL156.cbl
  6341*             20  FILLER                  PIC X(27).
  6342             20  AT-CSO-LETTER-STATUS    PIC X.
  6343                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  6344                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
  6345                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  6346             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
  6347             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  6348*
  6349*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  6350*
  6351*        16  FILLER                      PIC X(26).
  6352*
  6353*        16  AT-DMD-BSR-CODE             PIC X.
  6354*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  6355*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  6356*
  6357*        16  AT-DMD-LETTER-STATUS        PIC X.
  6358*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
  6359*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  6360*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
  6361*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  6362*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  6363
  6364         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  6365         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  6366
  6367     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  6368         16  AT-ADDRESS-TYPE             PIC X.
  6369             88  INSURED-ADDRESS               VALUE 'I'.
  6370             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  6371             88  ACCOUNT-ADDRESS               VALUE 'A'.
  6372             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  6373             88  EMPLOYER-ADDRESS              VALUE 'E'.
  6374             88  OTHER-ADDRESS-1               VALUE 'O'.
  6375             88  OTHER-ADDRESS-2               VALUE 'Q'.
  6376         16  AT-MAIL-TO-NAME             PIC X(30).
  6377         16  AT-ADDRESS-LINE-1           PIC X(30).
  6378         16  AT-ADDRESS-LINE-2           PIC X(30).
  6379         16  AT-CITY-STATE.
  6380             20  AT-CITY                 PIC X(28).
  6381             20  AT-STATE                PIC XX.
  6382         16  AT-ZIP.
  6383             20  AT-ZIP-CODE.
  6384                 24  AT-ZIP-1ST          PIC X.
  6385                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6386                 24  FILLER              PIC X(4).
  6387             20  AT-ZIP-PLUS4            PIC X(4).
  6388         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  6389             20  AT-CAN-POSTAL-1         PIC XXX.
  6390             20  AT-CAN-POSTAL-2         PIC XXX.
  6391             20  FILLER                  PIC XXX.
  6392         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  6393*         16  FILLER                      PIC X(23).
  6394         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
  6395         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
  6396         16  FILLER                      PIC X(13).
  6397         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  6398         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 120
* EL156.cbl
  6399
  6400     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6401         16  AT-INFO-LINE-1              PIC X(60).
  6402         16  FILLER REDEFINES AT-INFO-LINE-1.
  6403             20  AT-NOTE-ERROR-NO OCCURS 15
  6404                                         PIC X(4).
  6405         16  AT-INFO-LINE-2              PIC X(60).
  6406         16  FILLER REDEFINES AT-INFO-LINE-2.
  6407             20  AT-ICD-CODE-1           PIC X(8).
  6408             20  AT-ICD-CODE-2           PIC X(8).
  6409             20  FILLER                  PIC X(44).
  6410         16  AT-INFO-TRAILER-TYPE        PIC X.
  6411             88  AT-ERRORS-NOTE          VALUE 'E'.
  6412             88  AT-PAYMENT-NOTE         VALUE 'P'.
  6413             88  AT-CALL-NOTE            VALUE 'C'.
  6414             88  AT-MAINT-NOTE           VALUE 'M'.
  6415             88  AT-CERT-CHANGE          VALUE 'X'.
  6416             88  AT-APPROVAL-NOTE        VALUE 'R'.
  6417             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  6418             88  AT-CERT-CANCELLED       VALUE 'T'.
  6419         16  AT-CALL-TYPE                PIC X.
  6420             88  AT-PHONE-CALL-IN        VALUE 'I'.
  6421             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  6422         16  AT-NOTE-CONTINUATION        PIC X.
  6423             88  AT-CONTINUED-NOTE       VALUE 'X'.
  6424         16  AT-EOB-CODES-EXIST          PIC X.
  6425             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
  6426         16  FILLER                      PIC X(35).
  6427         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  6428         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  6429
  6430     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
  6431         16  AT-PROMPT-LINE-1            PIC X(60).
  6432         16  AT-PROMPT-LINE-2            PIC X(60).
  6433         16  AT-PROMPT-START-DT          PIC XX.
  6434         16  AT-PROMPT-END-DT            PIC XX.
  6435         16  FILLER                      PIC X(35).
  6436         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  6437         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  6438
  6439     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6440         16  AT-DENIAL-INFO-1            PIC X(60).
  6441         16  AT-DENIAL-INFO-2            PIC X(60).
  6442         16  AT-DENIAL-DT                PIC XX.
  6443         16  AT-RETRACTION-DT            PIC XX.
  6444         16  AT-DENIAL-REASON-CODE       PIC X(4).
  6445*         16  FILLER                      PIC X(31).
  6446         16  AT-DENIAL-PROOF-DT          PIC XX.
  6447         16  FILLER                      PIC X(29).
  6448         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  6449         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  6450
  6451     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  6452         16  AT-OLD-INCURRED-DT          PIC XX.
  6453         16  AT-OLD-REPORTED-DT          PIC XX.
  6454         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  6455         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  6456         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 121
* EL156.cbl
  6457         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  6458         16  AT-OLD-PAID-THRU-DT         PIC XX.
  6459         16  AT-LAST-PMT-MADE-DT         PIC XX.
  6460         16  FILLER                      PIC X(26).
  6461         16  AT-OLD-DIAG-CODE            PIC X(6).
  6462         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  6463         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  6464         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  6465         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  6466         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  6467         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  6468         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  6469         16  AT-OLD-ICD-CODE-1           PIC X(8).
  6470         16  AT-OLD-ICD-CODE-2           PIC X(8).
  6471         16  FILLER                      PIC X(9).
  6472         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  6473
  6474     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  6475         16  AT-FORM-SEND-ON-DT          PIC XX.
  6476         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  6477         16  AT-FORM-RE-SEND-DT          PIC XX.
  6478         16  AT-FORM-ANSWERED-DT         PIC XX.
  6479         16  AT-FORM-PRINTED-DT          PIC XX.
  6480         16  AT-FORM-REPRINT-DT          PIC XX.
  6481         16  AT-FORM-TYPE                PIC X.
  6482             88  INITIAL-FORM                  VALUE '1'.
  6483             88  PROGRESS-FORM                 VALUE '2'.
  6484         16  AT-INSTRUCT-LN-1            PIC X(28).
  6485         16  AT-INSTRUCT-LN-2            PIC X(28).
  6486         16  AT-INSTRUCT-LN-3            PIC X(28).
  6487         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  6488         16  AT-FORM-ADDRESS             PIC X.
  6489             88  FORM-TO-INSURED              VALUE 'I'.
  6490             88  FORM-TO-ACCOUNT              VALUE 'A'.
  6491             88  FORM-TO-OTHER-1              VALUE 'O'.
  6492             88  FORM-TO-OTHER-2              VALUE 'Q'.
  6493         16  AT-RELATED-1.
  6494             20 AT-REL-CARR-1            PIC X.
  6495             20 AT-REL-CLAIM-1           PIC X(7).
  6496             20 AT-REL-CERT-1            PIC X(11).
  6497         16  AT-RELATED-2.
  6498             20 AT-REL-CARR-2            PIC X.
  6499             20 AT-REL-CLAIM-2           PIC X(7).
  6500             20 AT-REL-CERT-2            PIC X(11).
  6501         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  6502         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  6503         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  6504         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  6505         16  AT-FORM-REM-PRINT-DT        PIC XX.
  6506         16  AT-STOP-FORM-DT             PIC X(2).
  6507
  6508         16  FILLER                      PIC X(09).
  6509         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  6510         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
  6511******************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 122
* EL156.cbl
  6513*    COPY ELCACTQ.
  6514******************************************************************
  6515*                                                                *
  6516*                            ELCACTQ.                            *
  6517*           PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
  6518*                            VMOD=2.004                          *
  6519*                                                                *
  6520*   FILE DESCRIPTION = ACTIVITY QUE FILE                         *
  6521*                                                                *
  6522*   FILE TYPE = VSAM,KSDS                                        *
  6523*   RECORD SIZE = 60     RECFORM = FIXED                         *
  6524*                                                                *
  6525*   BASE CLUSTER NAME = ELACTQ             RKP=2,LEN=20          *
  6526*       ALTERNATE INDEX = NONE                                   *
  6527*                                                                *
  6528*   LOG = YES                                                    *
  6529*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6530*                                                                *
  6531*  NO  CID  MODS  IN  COPYBOOK  ELCACTQ                          *
  6532******************************************************************
  6533
  6534 01  ACTIVITY-QUE.
  6535     12  AQ-RECORD-ID                PIC XX.
  6536         88  VALID-AQ-ID                VALUE 'AQ'.
  6537
  6538     12  AQ-CONTROL-PRIMARY.
  6539         16  AQ-COMPANY-CD           PIC X.
  6540         16  AQ-CARRIER              PIC X.
  6541         16  AQ-CLAIM-NO             PIC X(7).
  6542         16  AQ-CERT-NO.
  6543             20  AQ-CERT-PRIME       PIC X(10).
  6544             20  AQ-CERT-SFX         PIC X.
  6545
  6546     12  AQ-PENDING-ACTIVITY-FLAGS.
  6547         88  NO-PENDING-ACTIVITY        VALUE SPACES.
  6548         16  AQ-PENDING-PAYMENT-FLAG PIC X.
  6549             88  PENDING-PAYMENTS       VALUE '1'.
  6550         16  AQ-PENDING-STATUS-FLAG  PIC X.
  6551             88  PENDING-FULL-PRINT     VALUE '1'.
  6552             88  PENDING-PART-PRINT     VALUE '2'.
  6553         16  AQ-PENDING-LETTER-FLAG  PIC X.
  6554             88  PENDING-LETTERS        VALUE '1'.
  6555         16  AQ-PENDING-CLAIM-RESTORE PIC X.
  6556             88  PENDING-RESTORE        VALUE 'C'.
  6557             88  PENDING-RESTORE-LETTER VALUE 'L'.
  6558
  6559     12  FILLER                      PIC X(20).
  6560
  6561     12  AQ-RESEND-DATE              PIC XX.
  6562     12  AQ-FOLLOWUP-DATE            PIC XX.
  6563     12  AQ-PAYMENT-COUNTER          PIC S9        COMP-3.
  6564     12  AQ-PMT-UNAPPROVED-COUNT     PIC S9        COMP-3.
  6565     12  AQ-AUTO-LETTER              PIC X(4).
  6566     12  FILLER                      PIC XX.
  6567     12  AQ-LAST-UPDATED-BY          PIC S9(4)     COMP.
  6568*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 123
* EL156.cbl
  6570*    COPY ERCACCT.
  6571******************************************************************
  6572*                                                                *
  6573*                                                                *
  6574*                            ERCACCT                             *
  6575*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6576*                            VMOD=2.031                          *
  6577*                                                                *
  6578*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6579*                                                                *
  6580*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6581*   VSAM ACCOUNT MASTER FILES.                                   *
  6582*                                                                *
  6583*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6584*                                                                *
  6585*   FILE TYPE = VSAM,KSDS                                        *
  6586*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6587*                                                                *
  6588*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6589*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6590*                                                                *
  6591*   LOG = NO                                                     *
  6592*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6593*                                                                *
  6594*                                                                *
  6595******************************************************************
  6596*                   C H A N G E   L O G
  6597*
  6598* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6599*-----------------------------------------------------------------
  6600*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6601* EFFECTIVE    NUMBER
  6602*-----------------------------------------------------------------
  6603* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6604* 092705    2005050300006  PEMA  ADD SPP LEASES
  6605* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6606* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6607* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6608* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6609* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6610* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  6611******************************************************************
  6612
  6613 01  ACCOUNT-MASTER.
  6614     12  AM-RECORD-ID                      PIC XX.
  6615         88  VALID-AM-ID                      VALUE 'AM'.
  6616
  6617     12  AM-CONTROL-PRIMARY.
  6618         16  AM-COMPANY-CD                 PIC X.
  6619         16  AM-MSTR-CNTRL.
  6620             20  AM-CONTROL-A.
  6621                 24  AM-CARRIER            PIC X.
  6622                 24  AM-GROUPING.
  6623                     28 AM-GROUPING-PREFIX PIC XXX.
  6624                     28 AM-GROUPING-PRIME  PIC XXX.
  6625                 24  AM-STATE              PIC XX.
  6626                 24  AM-ACCOUNT.
  6627                     28  AM-ACCOUNT-PREFIX PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 124
* EL156.cbl
  6628                     28  AM-ACCOUNT-PRIME  PIC X(6).
  6629             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6630                                           PIC X(19).
  6631             20  AM-CNTRL-B.
  6632                 24  AM-EXPIRATION-DT      PIC XX.
  6633                 24  FILLER                PIC X(4).
  6634             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6635                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6636
  6637     12  AM-CONTROL-BY-VAR-GRP.
  6638         16  AM-COMPANY-CD-A1              PIC X.
  6639         16  AM-VG-CARRIER                 PIC X.
  6640         16  AM-VG-GROUPING                PIC X(6).
  6641         16  AM-VG-STATE                   PIC XX.
  6642         16  AM-VG-ACCOUNT                 PIC X(10).
  6643         16  AM-VG-DATE.
  6644             20  AM-VG-EXPIRATION-DT       PIC XX.
  6645             20  FILLER                    PIC X(4).
  6646         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6647                                           PIC 9(11)      COMP-3.
  6648     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6649         16  FILLER                        PIC X(10).
  6650         16  AM-VG-KEY3.
  6651             20  AM-VG3-ACCOUNT            PIC X(10).
  6652             20  AM-VG3-EXP-DT             PIC XX.
  6653         16  FILLER                        PIC X(4).
  6654     12  AM-MAINT-INFORMATION.
  6655         16  AM-LAST-MAINT-DT              PIC XX.
  6656         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6657         16  AM-LAST-MAINT-USER            PIC X(4).
  6658         16  FILLER                        PIC XX.
  6659
  6660     12  AM-EFFECTIVE-DT                   PIC XX.
  6661     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6662
  6663     12  AM-PREV-DATES  COMP-3.
  6664         16  AM-PREV-EXP-DT                PIC 9(11).
  6665         16  AM-PREV-EFF-DT                PIC 9(11).
  6666
  6667     12  AM-REPORT-CODE-1                  PIC X(10).
  6668     12  AM-REPORT-CODE-2                  PIC X(10).
  6669
  6670     12  AM-CITY-CODE                      PIC X(4).
  6671     12  AM-COUNTY-PARISH                  PIC X(6).
  6672
  6673     12  AM-NAME                           PIC X(30).
  6674     12  AM-PERSON                         PIC X(30).
  6675     12  AM-ADDRS                          PIC X(30).
  6676     12  AM-CITY.
  6677         16  AM-ADDR-CITY                  PIC X(28).
  6678         16  AM-ADDR-STATE                 PIC XX.
  6679     12  AM-ZIP.
  6680         16  AM-ZIP-PRIME.
  6681             20  AM-ZIP-PRI-1ST            PIC X.
  6682                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6683             20  FILLER                    PIC X(4).
  6684         16  AM-ZIP-PLUS4                  PIC X(4).
  6685     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 125
* EL156.cbl
  6686         16  AM-CAN-POSTAL-1               PIC XXX.
  6687         16  AM-CAN-POSTAL-2               PIC XXX.
  6688         16  FILLER                        PIC XXX.
  6689     12  AM-TEL-NO.
  6690         16  AM-AREA-CODE                  PIC 999.
  6691         16  AM-TEL-PRE                    PIC 999.
  6692         16  AM-TEL-NBR                    PIC 9(4).
  6693     12  AM-TEL-LOC                        PIC X.
  6694         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6695         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6696
  6697     12  AM-COMM-STRUCTURE.
  6698         16  AM-DEFN-1.
  6699             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6700                 24  AM-AGT.
  6701                     28  AM-AGT-PREFIX     PIC X(4).
  6702                     28  AM-AGT-PRIME      PIC X(6).
  6703                 24  AM-COM-TYP            PIC X.
  6704                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6705                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6706                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6707                 24  AM-RECALC-LV-INDIC    PIC X.
  6708                 24  AM-RETRO-LV-INDIC     PIC X.
  6709                 24  AM-GL-CODES           PIC X.
  6710                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6711                 24  FILLER                PIC X(01).
  6712         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6713             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6714                 24  FILLER                PIC X(11).
  6715                 24  AM-L-COMA             PIC XXX.
  6716                 24  AM-J-COMA             PIC XXX.
  6717                 24  AM-A-COMA             PIC XXX.
  6718                 24  FILLER                PIC X(6).
  6719
  6720     12  AM-COMM-CHANGE-STATUS             PIC X.
  6721         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6722
  6723     12  AM-CSR-CODE                       PIC X(4).
  6724
  6725     12  AM-BILLING-STATUS                 PIC X.
  6726         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6727         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6728     12  AM-AUTO-REFUND-SW                 PIC X.
  6729         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6730         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6731     12  AM-GPCD                           PIC 99.
  6732     12  AM-IG                             PIC X.
  6733         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6734         88  AM-HAS-GROUP                     VALUE '2'.
  6735     12  AM-STATUS                         PIC X.
  6736         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6737         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6738         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6739         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6740         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6741         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6742         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  6743         88  AM-ACCOUNT-LAPSED                VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 126
* EL156.cbl
  6744         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  6745         88  AM-ACCOUNT-PENDING               VALUE '9'.
  6746     12  AM-REMIT-TO                       PIC 99.
  6747     12  AM-ID-NO                          PIC X(11).
  6748
  6749     12  AM-CAL-TABLE                      PIC XX.
  6750     12  AM-LF-DEVIATION                   PIC XXX.
  6751     12  AM-AH-DEVIATION                   PIC XXX.
  6752     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6753     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6754     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6755     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6756     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6757     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6758
  6759     12  AM-USER-FIELDS.
  6760         16  AM-FLD-1                      PIC XX.
  6761         16  AM-FLD-2                      PIC XX.
  6762         16  AM-FLD-3                      PIC XX.
  6763         16  AM-FLD-4                      PIC XX.
  6764         16  AM-FLD-5                      PIC XX.
  6765
  6766     12  AM-1ST-PROD-DATE.
  6767         16  AM-1ST-PROD-YR                PIC XX.
  6768         16  AM-1ST-PROD-MO                PIC XX.
  6769         16  AM-1ST-PROD-DA                PIC XX.
  6770     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6771     12  AM-CERTS-PURGED-DATE.
  6772         16  AM-PUR-YR                     PIC XX.
  6773         16  AM-PUR-MO                     PIC XX.
  6774         16  AM-PUR-DA                     PIC XX.
  6775     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6776     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6777     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6778     12  AM-INACTIVE-DATE.
  6779         16  AM-INA-MO                     PIC 99.
  6780         16  AM-INA-DA                     PIC 99.
  6781         16  AM-INA-YR                     PIC 99.
  6782     12  AM-AR-HI-CERT-DATE                PIC XX.
  6783
  6784     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6785     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6786
  6787     12  AM-OB-PAYMENT-MODE                PIC X.
  6788         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6789         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6790         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6791         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6792
  6793     12  AM-AH-ONLY-INDICATOR              PIC X.
  6794         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6795         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6796
  6797     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6798
  6799     12  AM-OVER-SHORT.
  6800         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6801         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 127
* EL156.cbl
  6802
  6803     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6804     12  AM-DCC-CLP-STATE                  PIC XX.
  6805
  6806     12  AM-RECALC-COMM                    PIC X.
  6807     12  AM-RECALC-REIN                    PIC X.
  6808
  6809     12  AM-REI-TABLE                      PIC XXX.
  6810     12  AM-REI-ET-LF                      PIC X.
  6811     12  AM-REI-ET-AH                      PIC X.
  6812     12  AM-REI-PE-LF                      PIC X.
  6813     12  AM-REI-PE-AH                      PIC X.
  6814     12  AM-REI-PRT-ST                     PIC X.
  6815     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6816     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6817     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6818     12  AM-REI-GROUP-A                    PIC X(6).
  6819     12  AM-REI-MORT                       PIC X(4).
  6820     12  AM-REI-PRT-OW                     PIC X.
  6821     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6822     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6823     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6824     12  AM-REI-GROUP-B                    PIC X(6).
  6825
  6826     12  AM-TRUST-TYPE                     PIC X(2).
  6827
  6828     12  AM-EMPLOYER-STMT-USED             PIC X.
  6829     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6830
  6831     12  AM-STD-AH-TYPE                    PIC XX.
  6832     12  AM-EARN-METHODS.
  6833         16  AM-EARN-METHOD-R              PIC X.
  6834             88 AM-REF-RL-R78                 VALUE 'R'.
  6835             88 AM-REF-RL-PR                  VALUE 'P'.
  6836             88 AM-REF-RL-MEAN                VALUE 'M'.
  6837             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6838         16  AM-EARN-METHOD-L              PIC X.
  6839             88 AM-REF-LL-R78                 VALUE 'R'.
  6840             88 AM-REF-LL-PR                  VALUE 'P'.
  6841             88 AM-REF-LL-MEAN                VALUE 'M'.
  6842             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6843         16  AM-EARN-METHOD-A              PIC X.
  6844             88 AM-REF-AH-R78                 VALUE 'R'.
  6845             88 AM-REF-AH-PR                  VALUE 'P'.
  6846             88 AM-REF-AH-MEAN                VALUE 'M'.
  6847             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6848             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6849             88 AM-REF-AH-NET                 VALUE 'N'.
  6850
  6851     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6852     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6853     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6854
  6855     12  AM-RET-Y-N                        PIC X.
  6856     12  AM-RET-P-E                        PIC X.
  6857     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6858     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6859     12  AM-RET-GRP                        PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 128
* EL156.cbl
  6860     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6861         16  AM-POOL-PRIME                 PIC XXX.
  6862         16  AM-POOL-SUB                   PIC XXX.
  6863     12  AM-RETRO-EARNINGS.
  6864         16  AM-RET-EARN-R                 PIC X.
  6865         16  AM-RET-EARN-L                 PIC X.
  6866         16  AM-RET-EARN-A                 PIC X.
  6867     12  AM-RET-ST-TAX-USE                 PIC X.
  6868         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6869         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6870     12  AM-RETRO-BEG-EARNINGS.
  6871         16  AM-RET-BEG-EARN-R             PIC X.
  6872         16  AM-RET-BEG-EARN-L             PIC X.
  6873         16  AM-RET-BEG-EARN-A             PIC X.
  6874     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6875     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6876
  6877     12  AM-USER-SELECT-OPTIONS.
  6878         16  AM-USER-SELECT-1              PIC X(10).
  6879         16  AM-USER-SELECT-2              PIC X(10).
  6880         16  AM-USER-SELECT-3              PIC X(10).
  6881         16  AM-USER-SELECT-4              PIC X(10).
  6882         16  AM-USER-SELECT-5              PIC X(10).
  6883
  6884     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6885
  6886     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6887
  6888     12  AM-RPT045A-SWITCH                 PIC X.
  6889         88  RPT045A-OFF                   VALUE 'N'.
  6890
  6891     12  AM-INSURANCE-LIMITS.
  6892         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6893         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6894
  6895     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6896         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6897
  6898     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6899         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6900         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6901
  6902     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6903
  6904     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6905     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6906     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6907     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6908     12  AM-DCC-UEF-STATE                  PIC XX.
  6909     12  FILLER                            PIC XXX.
  6910     12  AM-REPORT-CODE-3                  PIC X(10).
  6911*    12  FILLER                            PIC X(22).
  6912
  6913     12  AM-RESERVE-DATE.
  6914         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6915         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6916         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6917
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 129
* EL156.cbl
  6918     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6919     12  AM-NOTIFICATION-TYPES.
  6920         16  AM-NOTIF-OF-LETTERS           PIC X.
  6921         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6922         16  AM-NOTIF-OF-REPORTS           PIC X.
  6923         16  AM-NOTIF-OF-STATUS            PIC X.
  6924
  6925     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6926         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6927         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6928         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6929         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6930
  6931     12  AM-BENEFIT-CONTROLS.
  6932         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6933             20  AM-BENEFIT-CODE           PIC XX.
  6934             20  AM-BENEFIT-TYPE           PIC X.
  6935             20  AM-BENEFIT-REVISION       PIC XXX.
  6936             20  AM-BENEFIT-REM-TERM       PIC X.
  6937             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6938             20  FILLER                    PIC XX.
  6939         16  FILLER                        PIC X(80).
  6940
  6941     12  AM-TRANSFER-DATA.
  6942         16  AM-TRANSFERRED-FROM.
  6943             20  AM-TRNFROM-CARRIER        PIC X.
  6944             20  AM-TRNFROM-GROUPING.
  6945                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6946                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6947             20  AM-TRNFROM-STATE          PIC XX.
  6948             20  AM-TRNFROM-ACCOUNT.
  6949                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6950                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6951             20  AM-TRNFROM-DTE            PIC XX.
  6952         16  AM-TRANSFERRED-TO.
  6953             20  AM-TRNTO-CARRIER          PIC X.
  6954             20  AM-TRNTO-GROUPING.
  6955                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6956                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6957             20  AM-TRNTO-STATE            PIC XX.
  6958             20  AM-TRNTO-ACCOUNT.
  6959                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6960                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6961             20  AM-TRNTO-DTE              PIC XX.
  6962         16  FILLER                        PIC X(10).
  6963
  6964     12  AM-SAVED-REMIT-TO                 PIC 99.
  6965
  6966     12  AM-COMM-STRUCTURE-SAVED.
  6967         16  AM-DEFN-1-SAVED.
  6968             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  6969                 24  AM-AGT-SV             PIC X(10).
  6970                 24  AM-COM-TYP-SV         PIC X.
  6971                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  6972                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  6973                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  6974                 24  AM-RECALC-LV-INDIC-SV PIC X.
  6975                 24  FILLER                PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 130
* EL156.cbl
  6976                 24  AM-GL-CODES-SV        PIC X.
  6977                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  6978                 24  FILLER                PIC X.
  6979         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  6980             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  6981                 24  FILLER                PIC X(11).
  6982                 24  AM-L-COMA-SV          PIC XXX.
  6983                 24  AM-J-COMA-SV          PIC XXX.
  6984                 24  AM-A-COMA-SV          PIC XXX.
  6985                 24  FILLER                PIC X(6).
  6986
  6987     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  6988         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  6989            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  6990            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  6991            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  6992
  6993     12  AM-ORIG-DEALER-NO                 PIC X(10).
  6994     12  FILLER                            PIC X(120).
  6995
  6996     12  AM-ACCOUNT-EXECUTIVE-DATA.
  6997         16  AM-CONTROL-NAME               PIC X(30).
  6998         16  AM-EXECUTIVE-ONE.
  6999             20  AM-EXEC1-NAME             PIC X(15).
  7000             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  7001                                                          COMP-3.
  7002             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  7003                                                          COMP-3.
  7004         16  AM-EXECUTIVE-TWO.
  7005             20  AM-EXEC2-NAME             PIC X(15).
  7006             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  7007                                                          COMP-3.
  7008             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  7009                                                          COMP-3.
  7010
  7011     12  AM-RETRO-ADDITIONAL-DATA.
  7012         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  7013         16  AM-RETRO-PREM-P-E             PIC X.
  7014         16  AM-RETRO-CLMS-P-I             PIC X.
  7015         16  AM-RETRO-RET-BRACKET-LF.
  7016             20  AM-RETRO-RET-METHOD-LF    PIC X.
  7017                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  7018                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  7019             20  AM-RETRO-RET-BASIS-LF     PIC X.
  7020                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  7021                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  7022             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  7023                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  7024                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  7025         16  AM-RETRO-RET-BRACKET-AH.
  7026             20  AM-RETRO-RET-METHOD-AH    PIC X.
  7027                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  7028                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  7029                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  7030             20  AM-RETRO-RET-BASIS-AH     PIC X.
  7031                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  7032                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  7033             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 131
* EL156.cbl
  7034                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  7035                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  7036
  7037     12  AM-COMMENTS.
  7038         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  7039
  7040     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  7041         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  7042         16  AM-FLI-BILLING-CODE           PIC X.
  7043         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  7044         16  AM-FLI-UNITED-IDENT           PIC X.
  7045         16  AM-FLI-INTEREST-LOST-DATA.
  7046             20  AM-FLI-BANK-NO            PIC X(5).
  7047             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  7048             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  7049             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  7050         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  7051             20  AM-FLI-AGT                PIC X(9).
  7052             20  AM-FLI-AGT-COMM-ACC       PIC X.
  7053             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  7054         16  FILLER                        PIC X(102).
  7055
  7056     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  7057         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  7058             20  AM-BENEFIT-DMD-CODE         PIC XX.
  7059             20  AM-BENEFIT-DMD-TYPE         PIC X.
  7060             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  7061             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  7062             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  7063         16  FILLER                          PIC X(10).
  7064******************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 132
* EL156.cbl
  7066*    COPY ELCCHKQ.
  7067******************************************************************
  7068*                                                                *
  7069*                                                                *
  7070*                            ELCCHKQ.                            *
  7071*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7072*                            VMOD=2.007                          *
  7073*                                                                *
  7074*   FILE DESCRIPTION = CHECK QUE FILE                            *
  7075*                                                                *
  7076*   FILE TYPE = VSAM,KSDS                                        *
  7077*   RECORD SIZE = 100  RECFORM = FIXED                           *
  7078*                                                                *
  7079*   BASE CLUSTER = ELCHKQ                         RKP=2,LEN=7    *
  7080*       ALTERNATE PATH1 = ELCHKQ2 (BY PAYEE)      RKP=9,LEN=26   *
  7081*                                                                *
  7082*   LOG = YES                                                    *
  7083*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7084******************************************************************
  7085 01  CHECK-QUE.
  7086     12  CQ-RECORD-ID                PIC XX.
  7087         88  VALID-CQ-ID         VALUE 'CQ'.
  7088
  7089     12  CQ-CONTROL-PRIMARY.
  7090         16  CQ-COMPANY-CD           PIC X.
  7091         16  CQ-CONTROL-NUMBER       PIC S9(8)       COMP.
  7092         16  CQ-SEQUENCE-NUMBER      PIC S9(4)       COMP.
  7093
  7094     12  CQ-CONTROL-BY-PAYEE.
  7095         16  CQ-CONTROL-BY-NUMBER.
  7096             20  CQ-COMPANY-CD-A1     PIC X.
  7097             20  CQ-CONTROL-NUMBER-A1 PIC S9(8)      COMP.
  7098         16  CQ-PAYEE-CARRIER        PIC X.
  7099         16  CQ-PAYEE-GROUPING       PIC X(6).
  7100         16  CQ-PAYEE-STATE          PIC XX.
  7101         16  CQ-PAYEE-BENE-ACCT      PIC X(10).
  7102         16  CQ-SEQUENCE-NUMBER-A1   PIC S9(4)       COMP.
  7103
  7104     12  CQ-DMD-CONTROL  REDEFINES  CQ-CONTROL-BY-PAYEE.
  7105         16  CQ-DMD-COMPANY-CD-A2    PIC X.
  7106         16  CQ-DMD-PAYEE-TYPE-A2    PIC X.
  7107         16  CQ-DMD-BENE-CODE-A2     PIC X(10).
  7108         16  CQ-DMD-CLAIM-NO-A2      PIC X(7).
  7109         16  CQ-DMD-TIME-SEQ-A2      PIC S9(7)       COMP.
  7110         16  FILLER                  PIC X(3).
  7111
  7112     12  CQ-ENTRY-TYPE               PIC X.
  7113             88  CHECK-ON-QUE           VALUE 'Q'.
  7114             88  ALIGNMENT-CHECK        VALUE 'A'.
  7115             88  SPOILED-CHECK          VALUE 'S'.
  7116             88  PAYMENT-ABORTED        VALUE 'X'.
  7117
  7118     12  CQ-CLAIM-MAST-CNTL.
  7119         16  CQ-CARRIER              PIC X.
  7120         16  CQ-CLAIM-NO             PIC X(7).
  7121         16  CQ-CERT-NO.
  7122             20  CQ-CERT-PRIME       PIC X(10).
  7123             20  CQ-CERT-SFX         PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 133
* EL156.cbl
  7124         16  CQ-CLAIM-TYPE           PIC X.
  7125             88  CQ-LIFE-CLAIM          VALUE 'L'.
  7126             88  CQ-AH-CLAIM            VALUE 'A'.
  7127         16  CQ-CLAIM-SUB-TYPE       PIC X.
  7128             88  CQ-FIXED-COVERAGE      VALUE '1'.
  7129             88  CQ-O-B-COVERAGE        VALUE '2'.
  7130             88  CQ-OPEN-END-COVERAGE   VALUE '3'.
  7131
  7132     12  CQ-PMT-TRLR-SEQUENCE        PIC S9(4)       COMP.
  7133     12  CQ-CHECK-NUMBER             PIC X(7).
  7134     12  CQ-CHECK-AMOUNT             PIC S9(7)V99    COMP-3.
  7135     12  CQ-PAYMENT-TYPE             PIC X.
  7136             88  CQ-PARTIAL-PAYMENT        VALUE '1'.
  7137             88  CQ-FINAL-PAYMENT          VALUE '2'.
  7138             88  CQ-LUMP-SUM-PAYMENT       VALUE '3'.
  7139             88  CQ-ADDITIONAL-PAYMENT     VALUE '4'.
  7140             88  CQ-CHARGEABLE-EXPENSE     VALUE '5'.
  7141             88  CQ-NON-CHARGEABLE-EXPENSE VALUE '6'.
  7142             88  CQ-LIFE-PREMIUM-REFUND    VALUE '7'.
  7143             88  CQ-AH-PREMIUM-REFUND      VALUE '8'.
  7144     12  CQ-VOID-INDICATOR           PIC X.
  7145             88  CHECK-IS-STOPPED          VALUE 'S'.
  7146             88  CHECK-IS-VOID             VALUE 'V'.
  7147     12  CQ-TIMES-PRINTED            PIC S9(4)       COMP.
  7148     12  CQ-PRINT-AT-HHMM            PIC S9(4)       COMP.
  7149     12  CQ-CHECK-BY-USER            PIC X(4).
  7150     12  CQ-PRE-NUMBERING-SW         PIC X.
  7151       88  CHECKS-WERE-NOT-PRE-NUMBERED    VALUE SPACE.
  7152       88  CHECKS-WERE-PRE-NUMBERED        VALUE '1'.
  7153
  7154     12  CQ-CHECK-WRITTEN-DT         PIC XX.
  7155     12  CQ-LAST-UPDATED-BY          PIC S9(4)       COMP.
  7156     12  CQ-LEDGER-FLAG              PIC X(01).
  7157     12  CQ-VOID-AFTER-LEDGER        PIC X(01).
  7158     12  CQ-LAST-UPDATED-DT          PIC XX.
  7159     12  CQ-LAST-UPDATED-HHMMSS      PIC S9(6)       COMP-3.
  7160     12  CQ-APPLIED-TO-RCON-DT       PIC XX.
  7161
  7162     12  FILLER                      PIC X(04).
  7163
  7164******************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 134
* EL156.cbl
  7166*    COPY ELCBENE.
  7167******************************************************************
  7168*                                                                *
  7169*                            ELCBENE.                            *
  7170*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7171*                            VMOD=2.006                          *
  7172*                                                                *
  7173*   FILE DESCRIPTION = BENEFICIARY FILE                          *
  7174*                                                                *
  7175*   FILE TYPE = VSAM,KSDS                                        *
  7176*   RECORD SIZE = 500   RECFORM = FIX                            *
  7177*                                                                *
  7178*   BASE CLUSTER NAME = ELBENE                   RKP=2,LEN=12    *
  7179*     ALTERNATE PATH1 = ELBENE2 (ALT BY NAME)    RKP=14,LEN=42   *
  7180*                                                                *
  7181*   LOG = YES                                                    *
  7182*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7183*                                                                *
  7184*  NO  CID  MODS  TO  COPYBOOK  ELCBENE                          *
  7185******************************************************************
  7186*                   C H A N G E   L O G
  7187*
  7188* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7189*-----------------------------------------------------------------
  7190*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7191* EFFECTIVE    NUMBER
  7192*-----------------------------------------------------------------
  7193* 013017  CR2016053100001  PEMA  ACH PROCESSING
  7194* 082317  CR2017082100003  PEMA  Add sub type
  7195******************************************************************
  7196
  7197 01  BENEFICIARY-MASTER.
  7198     12  BE-RECORD-ID                PIC XX.
  7199         88  VALID-BE-ID                VALUE 'BE'.
  7200
  7201     12  BE-CONTROL-PRIMARY.
  7202         16  BE-COMPANY-CD           PIC X.
  7203         16  BE-RECORD-TYPE          PIC X.
  7204             88  BENEFICIARY-RECORD  VALUE 'B'.
  7205             88  ADJUSTOR-RECORD     VALUE 'A'.
  7206         16  BE-BENEFICIARY          PIC X(10).
  7207     12  BE-CONTROL-BY-NAME.
  7208         16  BE-COMPANY-CD-A1        PIC X.
  7209         16  BE-RECORD-TYPE-A1       PIC X.
  7210         16  BE-MAIL-TO-NAME-A1      PIC X(30).
  7211         16  BE-ALTERNATE-PRIME-A1   PIC X(10).
  7212
  7213     12  BE-LAST-MAINT-DT            PIC XX.
  7214     12  BE-LAST-MAINT-BY            PIC X(4).
  7215     12  BE-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  7216
  7217     12  BE-ADDRESS-DATA.
  7218         16  BE-MAIL-TO-NAME         PIC X(30).
  7219         16  BE-ADDRESS-LINE-1       PIC X(30).
  7220         16  BE-ADDRESS-LINE-2       PIC X(30).
  7221         16  BE-ADDRESS-LINE-3       PIC X(30).
  7222         16  BE-CITY-STATE.
  7223             20  BE-CITY             PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 135
* EL156.cbl
  7224             20  BE-STATE            PIC XX.
  7225         16  BE-ZIP-CODE.
  7226             20  BE-ZIP-PRIME.
  7227                 24  BE-ZIP-1ST      PIC X.
  7228                     88  BE-CANADIAN-POST-CODE
  7229                                         VALUE 'A' THRU 'Z'.
  7230                 24  FILLER          PIC X(4).
  7231             20  BE-ZIP-PLUS4        PIC X(4).
  7232         16  BE-CANADIAN-POSTAL-CODE  REDEFINES  BE-ZIP-CODE.
  7233             20  BE-CAN-POSTAL-1     PIC XXX.
  7234             20  BE-CAN-POSTAL-2     PIC XXX.
  7235             20  FILLER              PIC XXX.
  7236         16  BE-PHONE-NO             PIC 9(11)     COMP-3.
  7237         16  BE-GROUP-CHECKS-Y-N     PIC X.
  7238
  7239******************************************************************
  7240*    THE BE-CARRIER FIELD IS USED BY 'AIG' TO DETERMINE HOW TO   *
  7241*    SET THE CARRIER CODE IN THE PENDING CLAIM FILE.             *
  7242******************************************************************
  7243     12  BE-CARRIER                  PIC X.
  7244
  7245     12  BE-ADDRESS-DATA2.
  7246         16  BE-MAIL-TO-NAME2        PIC X(30).
  7247         16  BE-ADDRESS-LINE-12      PIC X(30).
  7248         16  BE-ADDRESS-LINE-22      PIC X(30).
  7249         16  BE-ADDRESS-LINE-32      PIC X(30).
  7250         16  BE-CITY-STATE2.
  7251             20  BE-CITY2            PIC X(28).
  7252             20  BE-STATE2           PIC XX.
  7253         16  BE-ZIP-CODE2.
  7254             20  BE-ZIP-PRIME2.
  7255                 24  BE-ZIP-1ST2     PIC X.
  7256                     88  BE-CANADIAN-POST-CODE2
  7257                                         VALUE 'A' THRU 'Z'.
  7258                 24  FILLER          PIC X(4).
  7259             20  BE-ZIP-PLUS42       PIC X(4).
  7260         16  BE-CANADIAN-POSTAL-CODE2 REDEFINES  BE-ZIP-CODE2.
  7261             20  BE-CAN-POSTAL-12    PIC XXX.
  7262             20  BE-CAN-POSTAL-22    PIC XXX.
  7263             20  FILLER              PIC XXX.
  7264         16  BE-PHONE-NO2            PIC 9(11)     COMP-3.
  7265         16  BE-ACH-DATA.
  7266             20  BE-ACH-YES-OR-NO    PIC X.
  7267                 88  BE-ON-ACH       VALUE 'Y'.
  7268                 88  BE-NOT-ON-ACH   VALUE 'N' ' '.
  7269             20  BE-ACH-ABA-ROUTING-NUMBER
  7270                                     PIC X(15).
  7271             20  BE-ACH-BANK-ACCOUNT-NUMBER
  7272                                     PIC X(20).
  7273             20  BE-ACH-SUB-TYPE     PIC XX.
  7274             20  FILLER              PIC X(23).
  7275         16  BE-BILLING-STMT-DATA.
  7276*            20  BE-BSR              PIC X.
  7277*                88  BE-AUTOMATED-BSR      VALUE 'A'.
  7278*                88  BE-NOT-AUTOMATED-BSR  VALUE ' '.
  7279*            20  BE-BSR-FROM         PIC X(30).
  7280*            20  BE-BSR-DEPT         PIC X(30).
  7281             20  BE-BSR-PHONE-NUM    PIC 9(11)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 136
* EL156.cbl
  7282             20  BE-BSR-FAX-NUM      PIC 9(11)     COMP-3.
  7283             20  BE-OUTPUT-TYPE      PIC X.
  7284                 88  BE-FAX-OUTPUT         VALUE 'F'.
  7285                 88  BE-PRINT-OUTPUT       VALUE 'P' ' '.
  7286
  7287     12  FILLER                      PIC X(28).
  7288******************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 137
* EL156.cbl
  7290*    COPY ELCARCH.
  7291******************************************************************
  7292*                                                                *
  7293*                            ELCARCH.                            *
  7294*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7295*                            VMOD=2.007                          *
  7296*                                                                *
  7297*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  7298*                                                                *
  7299*   FILE TYPE = VSAM,KSDS                                        *
  7300*   RECORD SIZE = 090  RECFORM = FIXED                           *
  7301*                                                                *
  7302*   BASE CLUSTER = ELARCH                        RKP=2,LEN=8     *
  7303*       ALTERNATE PATH1 = ELARCH2 (RECORD TYPE)  RKP=10,LEN=8    *
  7304*                                                                *
  7305*   LOG = NO                                                     *
  7306*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7307*                                                                *
  7308*  THERE ARE CID MODS IN COPYBOOK ELCARCH                        *
  7309******************************************************************
  7310 01  LETTER-ARCHIVE.
  7311     12  LA-RECORD-ID                PIC XX.
  7312         88  VALID-LA-ID                VALUE 'LA'.
  7313
  7314     12  LA-CONTROL-PRIMARY.
  7315         16  LA-COMPANY-CD           PIC X.
  7316         16  LA-ARCHIVE-NO           PIC S9(8)     COMP.
  7317         16  LA-RECORD-TYPE          PIC X.
  7318             88  LA-HEADER-DATA         VALUE '1'.
  7319             88  LA-ADDRESS-DATA        VALUE '2'.
  7320             88  LA-TEXT-DATA           VALUE '3'.
  7321             88  LA-FORM-CONTROL-HDR    VALUE '4'.
  7322         16  LA-LINE-SEQ-NO          PIC S9(4)     COMP.
  7323
  7324     12  LA-CONTROL-BY-TYPE.
  7325         16  LA-COMPANY-CD-A1        PIC X.
  7326         16  LA-RECORD-TYPE-A1       PIC X.
  7327         16  LA-ARCHIVE-NO-A1        PIC S9(8)     COMP.
  7328         16  LA-LINE-SEQ-NO-A1       PIC S9(4)     COMP.
  7329
  7330     12  LA-TEXT-RECORD.
  7331         16  LA-SKIP-CONTROL         PIC XX.
  7332             88  NO-LINES-SKIPPED       VALUE SPACES.
  7333             88  SKIP-TO-NEXT-PAGE      VALUE '99'.
  7334         16  LA-TEXT-LINE            PIC X(70).
  7335
  7336     12  LA-ADDRESS-RECORD  REDEFINES  LA-TEXT-RECORD.
  7337         16  FILLER                  PIC XX.
  7338         16  LA-ADDRESS-LINE         PIC X(30).
  7339         16  FILLER                  PIC X(40).
  7340
  7341     12  LA-HEADER-RECORD  REDEFINES  LA-TEXT-RECORD.
  7342         16  FILLER                  PIC XX.
  7343         16  LA-CARRIER              PIC X.
  7344         16  LA-CLAIM-NO             PIC X(7).
  7345         16  LA-CERT-NO.
  7346             20  LA-CERT-PRIME       PIC X(10).
  7347             20  LA-CERT-SFX         PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 138
* EL156.cbl
  7348         16  LA-NO-OF-COPIES         PIC S9.
  7349         16  LA-RESEND-DATE          PIC XX.
  7350         16  LA-PROCESSOR-CD         PIC X(4).
  7351         16  LA-CREATION-DT          PIC XX.
  7352         16  LA-INITIAL-PRINT-DATE   PIC XX.
  7353         16  LA-RESEND-PRINT-DATE    PIC XX.
  7354         16  LA-CORR-TRLR-SEQ        PIC S9(4)    COMP.
  7355         16  LA-1ST-RESEND-PRINT-DT  PIC XX.
  7356*
  7357* -----  16  LA-DMD-ADDITIONAL-FIELDS.
  7358*   I        20  LA-DMD-LETTER-FORM      PIC X(4).
  7359*   I        20  LA-DMD-PROD-CODE        PIC XX.
  7360*   I        20  LA-DMD-RES-ST           PIC XX.
  7361*   I        20  LA-DMD-CORR-TRLR-SEQ    PIC S9(4)    COMP.
  7362*   I        20  LA-DMD-LETTER-STATUS    PIC X.
  7363*  NEW           88  LA-DMD-LETTER-ONLINE   VALUE '1'.
  7364*  DMD           88  LA-DMD-LETTER-PURGED   VALUE '2'.
  7365*  CHGS          88  LA-DMD-LETTER-RELOADED VALUE '3'.
  7366*   I        20  LA-DMD-LETTER-PURGE-DT  PIC XX.
  7367*   I        20  LA-DMD-LETTER-RELOAD-DT PIC XX.
  7368*   I        20  LA-DMD-UND-CODE         PIC XX.
  7369*   I        20  LA-DMD-BEN-CODE         PIC XX.
  7370*   V    16  FILLER                  PIC X(15).
  7371* -----
  7372*
  7373* REINSERTED  CSO  MODS
  7374*
  7375         16  FILLER.
  7376             20  FILLER                  PIC X(29).
  7377             20  LA-CSO-LETTER-STATUS    PIC X.
  7378                 88  LA-CSO-LETTER-ONLINE   VALUE '1'.
  7379                 88  LA-CSO-LETTER-PURGED   VALUE '2'.
  7380                 88  LA-CSO-LETTER-RELOADED VALUE '3'.
  7381             20  LA-CSO-LETTER-PURGE-DT  PIC XX.
  7382             20  LA-CSO-LETTER-RELOAD-DT PIC XX.
  7383*
  7384
  7385     12  LA-FORM-CONTROL-HEADER REDEFINES  LA-TEXT-RECORD.
  7386         16  FILLER                  PIC XX.
  7387         16  LA4-CARRIER             PIC X.
  7388         16  LA4-CLAIM-NO            PIC X(7).
  7389         16  LA4-CERT-NO.
  7390             20  LA4-CERT-PRIME      PIC X(10).
  7391             20  LA4-CERT-SFX        PIC X.
  7392         16  LA4-NO-OF-COPIES        PIC S9.
  7393         16  LA4-RESEND-DATE         PIC XX.
  7394         16  LA4-PROCESSOR-CD        PIC X(4).
  7395         16  LA4-CREATION-DT         PIC XX.
  7396         16  LA4-INITIAL-PRINT-DATE  PIC XX.
  7397         16  LA4-RESEND-PRINT-DATE   PIC XX.
  7398         16  LA4-FORM-TRLR-SEQ       PIC S9(4)    COMP.
  7399         16  LA4-FORM-TYPE           PIC X.
  7400             88  LA4-INITIAL-FORM    VALUE '1'.
  7401             88  LA4-PROGRESS-FORM   VALUE '2'.
  7402         16  LA4-FORM-REM-PRINT-DT   PIC X(02).
  7403         16  LA4-STATE               PIC X(02).
  7404         16  FILLER                  PIC X(31).
  7405******************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 139
* EL156.cbl
  7407*    COPY ELCDAR.
  7408******************************************************************
  7409*                                                                *
  7410*   FILE DESC. = DAILY ACTIVITY FILE, FOR PROCESSING NITELY      *
  7411*   FILE TYPE = VSAM,KSDS                                        *
  7412*   RECORD SIZE = 25   RECFORM = FIXED                           *
  7413*   BASE CLUSTER = DLYACTV                                       *
  7414*   LOG = YES                                                    *
  7415*   NARRATIVE - FILE IS BUILT DURING DAYTIME CICS PROCESSING AND *
  7416*               IS THEN PROCESSED BY CYCLE PROCESSING AT NIGHT.  *
  7417*               THIS IS USED TO BUILD THE LOGIC "F" EXTRACT      *
  7418*               RECORDS FOR THOSE CLAIMS WHICH HAVE HAD ACTIVITY *
  7419*               DURING THE DAY. THE EXTRACTS THEN GET READ IN    *
  7420*               BY PROGRAM "LGINFCE".                            *
  7421*                                                                *
  7422******************************************************************
  7423 01  DAILY-ACTIVITY-RECORD.
  7424     05  DA-KEY.
  7425         10  DA-COMP-CD          PIC X.
  7426         10  DA-CARRIER          PIC X.
  7427         10  DA-CLAIM-NO         PIC X(7).
  7428         10  DA-CERT-NO.
  7429             15  DA-CERT-PRIME   PIC X(10).
  7430             15  DA-CERT-SFX     PIC X.
  7431     05  DA-TRAILER-SEQ-NO       PIC S9(4)  COMP.
  7432     05  DA-RECORD-TYPE          PIC X.
  7433     05  FILLER                  PIC X(2).
  7434******************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 140
* EL156.cbl
  7436*    COPY ERCCOMP.
  7437******************************************************************
  7438*                                                                *
  7439*                                                                *
  7440*                            ERCCOMP                             *
  7441*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7442*                            VMOD=2.019                          *
  7443*                                                                *
  7444*   ONLINE CREDIT SYSTEM                                         *
  7445*                                                                *
  7446*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  7447*                                                                *
  7448*   FILE TYPE = VSAM,KSDS                                        *
  7449*   RECORD SIZE = 700   RECFORM = FIXED                          *
  7450*                                                                *
  7451*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  7452*       ALTERNATE PATH = NONE                                    *
  7453*                                                                *
  7454*   LOG = NO                                                     *
  7455*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7456*                                                                *
  7457******************************************************************
  7458*                   C H A N G E   L O G
  7459*
  7460* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7461*-----------------------------------------------------------------
  7462*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7463* EFFECTIVE    NUMBER
  7464*-----------------------------------------------------------------
  7465* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  7466* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  7467* 092205    2005050300006  PEMA  ADD LEASE FEE
  7468* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  7469* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  7470* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  7471* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7472* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  7473* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  7474******************************************************************
  7475
  7476 01  COMPENSATION-MASTER.
  7477     12  CO-RECORD-ID                          PIC XX.
  7478         88  VALID-CO-ID                          VALUE 'CO'.
  7479
  7480     12  CO-CONTROL-PRIMARY.
  7481         16  CO-COMPANY-CD                     PIC X.
  7482         16  CO-CONTROL.
  7483             20  CO-CTL-1.
  7484                 24  CO-CARR-GROUP.
  7485                     28  CO-CARRIER            PIC X.
  7486                     28  CO-GROUPING.
  7487                         32  CO-GROUP-PREFIX   PIC XXX.
  7488                         32  CO-GROUP-PRIME    PIC XXX.
  7489                 24  CO-RESP-NO.
  7490                     28  CO-RESP-PREFIX        PIC X(4).
  7491                     28  CO-RESP-PRIME         PIC X(6).
  7492             20  CO-CTL-2.
  7493                 24  CO-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 141
* EL156.cbl
  7494                     28  CO-ACCT-PREFIX        PIC X(4).
  7495                     28  CO-ACCT-PRIME         PIC X(6).
  7496         16  CO-TYPE                           PIC X.
  7497             88  CO-COMPANY-TYPE                  VALUE 'C'.
  7498             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  7499             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  7500
  7501     12  CO-MAINT-INFORMATION.
  7502         16  CO-LAST-MAINT-DT                  PIC XX.
  7503         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  7504         16  CO-LAST-MAINT-USER                PIC X(4).
  7505     12  FILLER                                PIC XX.
  7506     12  CO-STMT-TYPE                          PIC XXX.
  7507     12  CO-COMP-TYPE                          PIC X.
  7508         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  7509     12  CO-STMT-OWNER                         PIC X(4).
  7510     12  CO-BALANCE-CONTROL                    PIC X.
  7511         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  7512         88  CO-NO-BALANCE                        VALUE 'N'.
  7513
  7514     12  CO-INTERNAL-CONTROL-1                 PIC X.
  7515         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  7516         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  7517         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  7518
  7519     12  CO-INTERNAL-CONTROL-2                 PIC X.
  7520         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  7521         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  7522
  7523     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  7524     12  CO-GA-DIRECT-DEP                      PIC X.
  7525     12  CO-FUTURE-SPACE                       PIC X.
  7526         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  7527
  7528     12  CO-ACCT-NAME                          PIC X(30).
  7529     12  CO-MAIL-NAME                          PIC X(30).
  7530     12  CO-ADDR-1                             PIC X(30).
  7531     12  CO-ADDR-2                             PIC X(30).
  7532     12  CO-ADDR-3.
  7533         16  CO-ADDR-CITY                      PIC X(27).
  7534         16  CO-ADDR-STATE                     PIC XX.
  7535     12  CO-CSO-1099                           PIC X.
  7536     12  CO-ZIP.
  7537         16  CO-ZIP-PRIME.
  7538             20  CO-ZIP-PRI-1ST                PIC X.
  7539                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  7540             20  FILLER                        PIC X(4).
  7541         16  CO-ZIP-PLUS4                      PIC X(4).
  7542     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  7543         16  CO-CAN-POSTAL-1                   PIC XXX.
  7544         16  CO-CAN-POSTAL-2                   PIC XXX.
  7545         16  FILLER                            PIC XXX.
  7546     12  CO-SOC-SEC                            PIC X(13).
  7547     12  CO-TELEPHONE.
  7548         16  CO-AREA-CODE                      PIC XXX.
  7549         16  CO-PREFIX                         PIC XXX.
  7550         16  CO-PHONE                          PIC X(4).
  7551
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 142
* EL156.cbl
  7552     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  7553
  7554     12  CO-AR-BAL-LEVEL                       PIC X.
  7555         88  CO-AR-REF-LVL                        VALUE '1'.
  7556         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  7557         88  CO-AR-BILL-LVL                       VALUE '2'.
  7558         88  CO-AR-AGT-LVL                        VALUE '3'.
  7559         88  CO-AR-FR-LVL                         VALUE '4'.
  7560
  7561     12  CO-AR-NORMAL-PRINT                    PIC X.
  7562         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  7563         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  7564
  7565     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  7566
  7567     12  CO-AR-REPORTING                       PIC X.
  7568         88  CO-AR-NET-REPORT                     VALUE 'N'.
  7569         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  7570
  7571     12  CO-AR-PULL-CHECK                      PIC X.
  7572         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  7573         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  7574
  7575     12  CO-AR-BALANCE-PRINT                   PIC X.
  7576         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  7577
  7578     12  CO-AR-LAST-RUN-CODE                   PIC X.
  7579         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  7580         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  7581         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  7582
  7583     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  7584
  7585     12  CO-USER-CODE                          PIC X.
  7586     12  CO-REPORT-GROUP-ID                    PIC X(12).
  7587
  7588******************************************************************
  7589*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  7590*    THE LAST MONTH END RUN.
  7591******************************************************************
  7592
  7593     12  CO-LAST-ACTIVITY-DATE.
  7594         16  CO-ACT-YEAR                       PIC 99.
  7595         16  CO-ACT-MONTH                      PIC 99.
  7596         16  CO-ACT-DAY                        PIC 99.
  7597
  7598     12  CO-LAST-STMT-DT.
  7599         16  CO-LAST-STMT-YEAR                 PIC 99.
  7600         16  CO-LAST-STMT-MONTH                PIC 99.
  7601         16  CO-LAST-STMT-DAY                  PIC 99.
  7602
  7603     12  CO-MO-END-TOTALS.
  7604         16  CO-MONTHLY-TOTALS.
  7605             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  7606             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  7607             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  7608             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  7609             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 143
* EL156.cbl
  7610
  7611         16  CO-AGING-TOTALS.
  7612             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  7613             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  7614             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  7615             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  7616
  7617         16  CO-YTD-TOTALS.
  7618             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  7619             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  7620
  7621         16  CO-OVER-UNDER-TOTALS.
  7622             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  7623             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  7624
  7625     12  CO-MISCELLANEOUS-TOTALS.
  7626         16  CO-FICA-TOTALS.
  7627             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  7628             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  7629
  7630         16  CO-CLAIM-TOTALS.
  7631             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  7632             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  7633
  7634******************************************************************
  7635*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  7636*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  7637******************************************************************
  7638
  7639     12  CO-CURRENT-TOTALS.
  7640         16  CO-CURRENT-LAST-STMT-DT.
  7641             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  7642             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  7643             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  7644
  7645         16  CO-CURRENT-MONTHLY-TOTALS.
  7646             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  7647             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  7648             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  7649             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  7650             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  7651
  7652         16  CO-CURRENT-AGING-TOTALS.
  7653             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  7654             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  7655             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  7656             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  7657
  7658         16  CO-CURRENT-YTD-TOTALS.
  7659             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  7660             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  7661
  7662     12  CO-PAID-COMM-TOTALS.
  7663         16  CO-YTD-PAID-COMMS.
  7664             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  7665             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  7666
  7667     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 144
* EL156.cbl
  7668         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  7669         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  7670
  7671     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  7672         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  7673         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  7674         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  7675         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  7676         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  7677         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  7678         88  CO-FINAL-LETTER                  VALUE 'F'.
  7679         88  CO-RECONCILING                   VALUE 'R'.
  7680         88  CO-PHONE-CALL                    VALUE 'P'.
  7681         88  CO-LEGAL                         VALUE 'L'.
  7682         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  7683         88  CO-WRITE-OFF                     VALUE 'W'.
  7684         88  CO-NO-ACTION                     VALUE 'N' ' '.
  7685
  7686     12  CO-CSR-CODE                       PIC X(4).
  7687
  7688     12  CO-GA-STATUS-INFO.
  7689         16  CO-GA-EFFECTIVE-DT            PIC XX.
  7690         16  CO-GA-TERMINATION-DT          PIC XX.
  7691         16  CO-GA-STATUS-CODE             PIC X.
  7692             88  CO-GA-ACTIVE                 VALUE 'A'.
  7693             88  CO-GA-INACTIVE               VALUE 'I'.
  7694             88  CO-GA-PENDING                VALUE 'P'.
  7695         16  CO-GA-COMMENTS.
  7696             20  CO-GA-COMMENT-1           PIC X(40).
  7697             20  CO-GA-COMMENT-2           PIC X(40).
  7698             20  CO-GA-COMMENT-3           PIC X(40).
  7699             20  CO-GA-COMMENT-4           PIC X(40).
  7700
  7701     12  CO-RPTCD2                         PIC X(10).
  7702     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  7703         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  7704         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  7705
  7706     12  CO-TYPE-AGENT                     PIC X(01).
  7707         88  CO-CORPORATION                   VALUE 'C'.
  7708         88  CO-PARTNERSHIP                   VALUE 'P'.
  7709         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  7710         88  CO-TRUST                         VALUE 'T'.
  7711         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  7712
  7713     12  CO-FAXNO.
  7714         16  CO-FAX-AREA-CODE                  PIC XXX.
  7715         16  CO-FAX-PREFIX                     PIC XXX.
  7716         16  CO-FAX-PHONE                      PIC X(4).
  7717
  7718     12  CO-BANK-INFORMATION.
  7719         16  CO-BANK-TRANSIT-NO                PIC X(8).
  7720         16  CO-BANK-TRANSIT-NON REDEFINES
  7721             CO-BANK-TRANSIT-NO                PIC 9(8).
  7722
  7723         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  7724     12  CO-MISC-DEDUCT-INFO REDEFINES
  7725                  CO-BANK-INFORMATION.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 145
* EL156.cbl
  7726         16  CO-MD-GL-ACCT                     PIC X(10).
  7727         16  CO-MD-DIV                         PIC XX.
  7728         16  CO-MD-CENTER                      PIC X(4).
  7729         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  7730         16  CO-CREATE-AP-CHECK                PIC X.
  7731         16  CO-DELIVER-CK-TO-MEL              PIC X.
  7732         16  FILLER                            PIC XXX.
  7733     12  CO-ACH-STATUS                         PIC X.
  7734         88  CO-ACH-ACTIVE                         VALUE 'A'.
  7735         88  CO-ACH-PENDING                        VALUE 'P'.
  7736
  7737     12  CO-BILL-SW                            PIC X.
  7738     12  CO-CONTROL-NAME                       PIC X(30).
  7739     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  7740     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  7741     12  CO-CLP-STATE                          PIC XX.
  7742     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  7743     12  CO-SPP-REFUND-EDIT                    PIC X.
  7744
  7745******************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 146
* EL156.cbl
  7747*    COPY ERCDMDNT.
  7748******************************************************************
  7749*                                                                *
  7750*                            ERCDMDNT                            *
  7751*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7752*                            VMOD=2.005                          *
  7753*                                                                *
  7754*        FILE DESCRIPTION = DMD CERTIFICATE NOTES                *
  7755*                                                                *
  7756*        THIS COPYBOOK IS A REDEFINES OF ERCNOTE -               *
  7757*                                                                *
  7758*        FILE TYPE= VSAM,KSDS                                    *
  7759*        RECORD SIZE = 825    RECFORM = FIXED                    *
  7760*                                                                *
  7761*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  7762*                                                                *
  7763*        LOG = YES                                               *
  7764*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7765*                                                                *
  7766******************************************************************
  7767
  7768 01  CERTIFICATE-NOTE.
  7769     12  CN-RECORD-ID                     PIC  XX.
  7770         88  VALID-CN-ID                      VALUE 'CN'.
  7771
  7772     12  CN-CONTROL-PRIMARY.
  7773         16  CN-COMPANY-CD                PIC X.
  7774         16  CN-CERT-KEY.
  7775             20  CN-CARRIER               PIC X.
  7776             20  CN-GROUPING.
  7777                 24  CN-GROUPING-PREFIX   PIC XXX.
  7778                 24  CN-GROUPING-PRIME    PIC XXX.
  7779             20  CN-STATE                 PIC XX.
  7780             20  CN-ACCOUNT.
  7781                 24  CN-ACCOUNT-PREFIX    PIC X(4).
  7782                 24  CN-ACCOUNT-PRIME     PIC X(6).
  7783             20  CN-CERT-EFF-DT           PIC XX.
  7784             20  CN-CERT-NO.
  7785                 24  CN-CERT-PRIME        PIC X(10).
  7786                 24  CN-CERT-SFX          PIC X.
  7787
  7788     12  CN-BILLING-START-LINE-NO         PIC 99.
  7789     12  CN-BILLING-END-LINE-NO           PIC 99.
  7790
  7791     12  CN-LINES.
  7792         16  CN-LINE                      PIC X(77)  OCCURS 10.
  7793
  7794     12  CN-CSI-NOTES REDEFINES CN-LINES.
  7795         16  CN-CSI-TEXT-NOTES            PIC X(77)  OCCURS 6.
  7796         16  CN-CSI-GENERAL-DATA-AREA.
  7797             20  CN-CSI-GENERAL-DATA      PIC X(77)  OCCURS 2.
  7798
  7799         16  CN-CSI-GENERAL-DATA-R REDEFINES
  7800             CN-CSI-GENERAL-DATA-AREA.
  7801             20  CN-CSI-GEN-NOC-KEY           PIC X(11).
  7802             20  CN-CSI-GEN-PRI-INSD-1ST-NAME PIC X(15).
  7803             20  CN-CSI-GEN-SEC-INSD-1ST-NAME PIC X(15).
  7804             20  CN-CSI-GEN-INSD-WORK-PHONE   PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 147
* EL156.cbl
  7805             20  CN-CSI-GEN-INFRM-1ST-NAME    PIC X(15).
  7806             20  CN-CSI-GEN-INFRM-LAST-NAME   PIC X(20).
  7807             20  CN-CSI-GEN-INFRM-MI          PIC X.
  7808             20  CN-CSI-GEN-INFRM-PHONE       PIC X(10).
  7809             20  CN-CSI-GEN-INFRM-REL         PIC X(15).
  7810             20  FILLER                       PIC XX.
  7811             20  CN-CSI-GEN-DATA-SOURCE       PIC XX.
  7812             20  FILLER                       PIC X(38).
  7813
  7814         16  CN-CSI-PRODUCT-DATA-AREA.
  7815             20  CN-CSI-PRODUCT-DATA      PIC X(77)  OCCURS 2.
  7816
  7817         16  CN-CSI-CREDIT-CARD-DATA REDEFINES
  7818             CN-CSI-PRODUCT-DATA-AREA.
  7819             20  CN-CSI-CC-BILL-BANK-ID   PIC X(6).
  7820             20  CN-CSI-CC-CANCEL-CD      PIC XX.
  7821             20  CN-CSI-CC-CANCEL-DT      PIC X(8).
  7822             20  CN-CSI-CC-CARD-TYPE      PIC XX.
  7823             20  CN-CSI-CC-CHANGE-AGE     PIC 999.
  7824             20  CN-CSI-CC-DIAGNOSIS-CD   PIC X(6).
  7825             20  FILLER                   PIC XX.
  7826             20  CN-CSI-CC-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7827             20  CN-CSI-CC-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  7828             20  CN-CSI-CC-INTEREST-PAID  PIC X.
  7829             20  CN-CSI-CC-ISSUE-ST       PIC XX.
  7830             20  CN-CSI-CC-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7831             20  CN-CSI-CC-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7832             20  CN-CSI-CC-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7833             20  CN-CSI-CC-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7834             20  CN-CSI-CC-OLD-ACCT-NO    PIC X(20).
  7835             20  CN-CSI-CC-POLICY-TYPE    PIC XXX.
  7836             20  CN-CSI-CC-PREMIUM-AMT    PIC S999V99   COMP-3.
  7837             20  CN-CSI-CC-PREMIUM-RT     PIC S999V999  COMP-3.
  7838             20  CN-CSI-CC-PREV-CLAIM-NO  PIC X(7).
  7839             20  CN-CSI-CC-SIGNED-DT      PIC X(8).
  7840             20  CN-CSI-CC-SPECIAL-TERM   PIC S999      COMP-3.
  7841             20  CN-CSI-CC-STMNT-DT       PIC X(8).
  7842             20  CN-CSI-CC-TERM-AGE       PIC 999.
  7843             20  CN-CSI-CC-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7844             20  CN-CSI-CC-WAIV-PREM-FLAG PIC X.
  7845             20  CN-CSI-CC-ISSUE-DT       PIC X(8).
  7846             20  CN-CSI-CC-BEN-CALC-SW    PIC X.
  7847             20  CN-CSI-CC-TERM-ROUND-SW  PIC X.
  7848             20  FILLER                   PIC X(25).
  7849
  7850         16  CN-CSI-FAMILY-LEAVE-DATA REDEFINES
  7851             CN-CSI-CREDIT-CARD-DATA.
  7852             20  CN-CSI-FL-BILL-BANK-ID   PIC X(6).
  7853             20  CN-CSI-FL-CANCEL-CD      PIC XX.
  7854             20  CN-CSI-FL-CANCEL-DT      PIC X(8).
  7855             20  CN-CSI-FL-CARD-TYPE      PIC XX.
  7856             20  CN-CSI-FL-CHANGE-AGE     PIC 999.
  7857             20  CN-CSI-FL-DIAGNOSIS-CD   PIC X(6).
  7858             20  FILLER                   PIC XX.
  7859             20  CN-CSI-FL-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7860             20  CN-CSI-FL-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  7861             20  CN-CSI-FL-INTEREST-PAID  PIC X.
  7862             20  CN-CSI-FL-ISSUE-ST       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 148
* EL156.cbl
  7863             20  CN-CSI-FL-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7864             20  CN-CSI-FL-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7865             20  CN-CSI-FL-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7866             20  CN-CSI-FL-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7867             20  CN-CSI-FL-OLD-ACCT-NO    PIC X(20).
  7868             20  CN-CSI-FL-POLICY-TYPE    PIC XXX.
  7869             20  CN-CSI-FL-PREMIUM-AMT    PIC S999V99   COMP-3.
  7870             20  CN-CSI-FL-PREMIUM-RT     PIC S999V999  COMP-3.
  7871             20  CN-CSI-FL-PREV-CLAIM-NO  PIC X(7).
  7872             20  CN-CSI-FL-SIGNED-DT      PIC X(8).
  7873             20  CN-CSI-FL-SPECIAL-TERM   PIC S999      COMP-3.
  7874             20  CN-CSI-FL-STMNT-DT       PIC X(8).
  7875             20  CN-CSI-FL-TERM-AGE       PIC 999.
  7876             20  CN-CSI-FL-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7877             20  CN-CSI-FL-WAIV-PREM-FLAG PIC X.
  7878             20  CN-CSI-FL-ISSUE-DT       PIC X(8).
  7879             20  CN-CSI-FL-BEN-CALC-SW    PIC X.
  7880             20  CN-CSI-FL-TERM-ROUND-SW  PIC X.
  7881             20  CN-CSI-FL-LAST-DAY-WRKED PIC X(8).
  7882             20  FILLER                   PIC X(17).
  7883
  7884         16  CN-CSI-SENIOR-LIFE-DATA REDEFINES
  7885             CN-CSI-FAMILY-LEAVE-DATA.
  7886             20  CN-CSI-SL-BENE-DOB       PIC X(8).
  7887             20  CN-CSI-SL-BENE-NAME      PIC X(27).
  7888             20  CN-CSI-SL-BENE-REL       PIC X(8).
  7889             20  CN-CSI-SL-BENE-SSN       PIC S9(9)     COMP-3.
  7890             20  CN-CSI-SL-BILL-BANK-ID   PIC X(6).
  7891             20  CN-CSI-SL-CANCEL-DT      PIC X(8).
  7892             20  CN-CSI-SL-DIAGNOSIS-CD   PIC X(6).
  7893             20  CN-CSI-SL-INT-CHECK-DT   PIC X(8).
  7894             20  CN-CSI-SL-INT-CHECK-NO   PIC S9(7)     COMP-3.
  7895             20  CN-CSI-SL-INT-ON-PROCEEDS
  7896                                          PIC S9(5)V99  COMP-3.
  7897             20  CN-CSI-SL-ISSUE-DT       PIC X(8).
  7898             20  CN-CSI-SL-ISSUE-ST       PIC XX.
  7899             20  CN-CSI-SL-LIFE-PROCEEDS  PIC S9(5)V99  COMP-3.
  7900             20  CN-CSI-SL-LOAN-INT-DUE   PIC S9(5)V99  COMP-3.
  7901             20  CN-CSI-SL-POLICY-BENEFITS
  7902                                          PIC S9(5)V99  COMP-3.
  7903             20  CN-CSI-SL-POLICY-TYPE    PIC XXX.
  7904             20  CN-CSI-SL-PREM-AMT       PIC S9(5)V99  COMP-3.
  7905             20  CN-CSI-SL-PREM-CHECK-DT  PIC X(8).
  7906             20  CN-CSI-SL-PREM-CHECK-NO  PIC S9(7)     COMP-3.
  7907             20  CN-CSI-SL-PREM-DUE       PIC S9(5)V99  COMP-3.
  7908             20  CN-CSI-SL-PREM-MODE      PIC 99.
  7909             20  CN-CSI-SL-PREM-REFUND    PIC S9(5)V99  COMP-3.
  7910             20  CN-CSI-SL-PREM-SUSP-DT   PIC X(8).
  7911             20  CN-CSI-SL-SIGNED-DT      PIC X(8).
  7912             20  CN-CSI-SL-STATE-NOT      PIC X.
  7913             20  FILLER                   PIC XX.
  7914
  7915         16  CN-CSI-PURCH-PROP-DATA REDEFINES
  7916             CN-CSI-SENIOR-LIFE-DATA.
  7917             20  CN-CSI-PP-CARD-TYPE      PIC XX.
  7918             20  CN-CSI-PP-CHANGE-AGE     PIC 999.
  7919             20  CN-CSI-PP-BEN-PAID-TO-DATE
  7920                                          PIC S9(5)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 149
* EL156.cbl
  7921             20  CN-CSI-PP-BILL-BANK-ID   PIC X(6).
  7922             20  CN-CSI-PP-CANCEL-CD      PIC XX.
  7923             20  CN-CSI-PP-CANCEL-DT      PIC X(8).
  7924             20  CN-CSI-PP-DIAGNOSIS-CD   PIC X(6).
  7925             20  CN-CSI-PP-ISSUE-DT       PIC X(8).
  7926             20  CN-CSI-PP-ISSUE-ST       PIC XX.
  7927             20  CN-CSI-PP-MANUFACTURER   PIC X(17).
  7928             20  CN-CSI-PP-MODEL-NO       PIC X(8).
  7929             20  CN-CSI-PP-OLD-ACCT-NO    PIC X(20).
  7930             20  CN-CSI-PP-POLICY-TYPE    PIC XXX.
  7931             20  CN-CSI-PP-PREMIUM-RT     PIC S999V999  COMP-3.
  7932             20  CN-CSI-PP-PREV-CLAIM-NO  PIC X(7).
  7933             20  CN-CSI-PP-PURCHASE-DT    PIC X(8).
  7934             20  CN-CSI-PP-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7935             20  CN-CSI-PP-REPAIR         PIC X.
  7936             20  CN-CSI-PP-REPLACE        PIC X.
  7937             20  CN-CSI-PP-SERIAL-NO      PIC X(16).
  7938             20  CN-CSI-PP-SIGNED-DT      PIC X(8).
  7939             20  CN-CSI-PP-STMNT-DT       PIC X(8).
  7940             20  CN-CSI-PP-TERM-AGE       PIC 999.
  7941             20  FILLER                   PIC X(5).
  7942
  7943         16  CN-CSI-EXT-WARR-DATA REDEFINES
  7944             CN-CSI-PURCH-PROP-DATA.
  7945             20  CN-CSI-EW-CARD-TYPE      PIC XX.
  7946             20  CN-CSI-EW-CHANGE-AGE     PIC 999.
  7947             20  CN-CSI-EW-BILL-BANK-ID   PIC X(6).
  7948             20  CN-CSI-EW-CANCEL-CD      PIC XX.
  7949             20  CN-CSI-EW-CANCEL-DT      PIC X(8).
  7950             20  CN-CSI-EW-DIAGNOSIS-CD   PIC X(6).
  7951             20  CN-CSI-EW-ISSUE-DT       PIC X(8).
  7952             20  CN-CSI-EW-ISSUE-ST       PIC XX.
  7953             20  CN-CSI-EW-MANUFACTURER   PIC X(17).
  7954             20  CN-CSI-EW-MODEL-NO       PIC X(8).
  7955             20  CN-CSI-EW-OLD-ACCT-NO    PIC X(20).
  7956             20  CN-CSI-EW-POLICY-TYPE    PIC XXX.
  7957             20  CN-CSI-EW-PREMIUM-RT     PIC S999V999  COMP-3.
  7958             20  CN-CSI-EW-PREV-CLAIM-NO  PIC X(7).
  7959             20  CN-CSI-EW-PURCHASE-DT    PIC X(8).
  7960             20  CN-CSI-EW-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7961             20  CN-CSI-EW-REPAIR-COST    PIC S9(5)V99  COMP-3.
  7962             20  CN-CSI-EW-REPLACE        PIC X.
  7963             20  CN-CSI-EW-SERIAL-NO      PIC X(16).
  7964             20  CN-CSI-EW-SIGNED-DT      PIC X(8).
  7965             20  CN-CSI-EW-STMNT-DT       PIC X(8).
  7966             20  CN-CSI-EW-TERM-AGE       PIC 999.
  7967             20  CN-CSI-EW-WARRANTY-NO    PIC 99.
  7968             20  FILLER                   PIC X(4).
  7969
  7970     12  CN-LAST-MAINT-DT                 PIC XX.
  7971     12  CN-LAST-MAINT-HHMMSS             PIC S9(7)     COMP-3.
  7972     12  CN-LAST-MAINT-USER               PIC X(4).
  7973     12  FILLER                           PIC X(6).
  7974
  7975******************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 150
* EL156.cbl
  7977*    COPY ERCCNOT.
  7978******************************************************************
  7979*                                                                *
  7980*                            ERCCNOT                             *
  7981*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7982*                            VMOD=2.003                          *
  7983*                                                                *
  7984*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  7985*                                                                *
  7986*        FILE TYPE= VSAM,KSDS                                    *
  7987*        RECORD SIZE = 150    RECFORM = FIXED                    *
  7988*                                                                *
  7989*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  7990*                                                                *
  7991*        LOG = YES                                               *
  7992*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7993*                                                                *
  7994******************************************************************
  7995*                   C H A N G E   L O G
  7996*
  7997* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7998*-----------------------------------------------------------------
  7999*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  8000* EFFECTIVE    NUMBER
  8001*-----------------------------------------------------------------
  8002* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  8003******************************************************************
  8004
  8005 01  CERT-NOTE-FILE.
  8006     12  CZ-RECORD-ID                PIC  XX.
  8007         88  VALID-CZ-ID                  VALUE 'CZ'.
  8008
  8009     12  CZ-CONTROL-PRIMARY.
  8010         16  CZ-COMPANY-CD           PIC X.
  8011         16  CZ-CARRIER              PIC X.
  8012         16  CZ-GROUPING.
  8013             20 CZ-GROUPING-PREFIX   PIC XXX.
  8014             20 CZ-GROUPING-PRIME    PIC XXX.
  8015         16  CZ-STATE                PIC XX.
  8016         16  CZ-ACCOUNT.
  8017             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  8018             20 CZ-ACCOUNT-PRIME     PIC X(6).
  8019         16  CZ-CERT-EFF-DT          PIC XX.
  8020         16  CZ-CERT-NO.
  8021             20  CZ-CERT-PRIME       PIC X(10).
  8022             20  CZ-CERT-SFX         PIC X.
  8023         16  CZ-RECORD-TYPE          PIC X.
  8024             88  CERT-NOTE           VALUE '1'.
  8025             88  CLAIM-CERT-NOTE     VALUE '2'.
  8026         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  8027
  8028     12  CZ-LAST-MAINT-DT            PIC XX.
  8029     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  8030     12  CZ-LAST-MAINT-USER          PIC X(4).
  8031
  8032     12  CZ-NOTE-INFORMATION.
  8033         16  CZ-NOTE                 PIC X(63).
  8034         16  FILLER                  PIC X(39).
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 151
* EL156.cbl
  8035******************************************************************
  8036*                            COPY ERCPDEF.
  8037******************************************************************
  8038*                                                                *
  8039*                                                                *
  8040*                            ERCPDEF.                            *
  8041*                                                                *
  8042*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  8043*                                                                *
  8044*    FILE TYPE = VSAM,KSDS                                       *
  8045*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  8046*                                                                *
  8047*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  8048*                                                                *
  8049*    LOG = YES                                                   *
  8050*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  8051******************************************************************
  8052*                   C H A N G E   L O G
  8053*
  8054* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  8055*-----------------------------------------------------------------
  8056*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  8057* EFFECTIVE    NUMBER
  8058*-----------------------------------------------------------------
  8059* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  8060* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  8061* 100314  CR2014061900001  PEMA  ADD PCT OF BENEFIT
  8062******************************************************************
  8063 01  PRODUCT-MASTER.
  8064    12  PD-RECORD-ID                 PIC X(02).
  8065        88  VALID-PD-ID                  VALUE 'PD'.
  8066    12  PD-CONTROL-PRIMARY.
  8067        16  PD-COMPANY-CD            PIC X.
  8068        16  PD-STATE                 PIC XX.
  8069        16  PD-PRODUCT-CD            PIC XXX.
  8070        16  PD-FILLER                PIC X(7).
  8071        16  PD-BEN-TYPE              PIC X.
  8072        16  PD-BEN-CODE              PIC XX.
  8073        16  PD-PROD-EXP-DT           PIC XX.
  8074    12  FILLER                       PIC X(50).
  8075    12  PD-PRODUCT-DATA OCCURS 8.
  8076        16  PD-PROD-CODE             PIC X.
  8077            88  PD-PROD-LIFE           VALUE 'L'.
  8078            88  PD-PROD-PROP           VALUE 'P'.
  8079            88  PD-PROD-AH             VALUE 'A'.
  8080            88  PD-PROD-IU             VALUE 'I'.
  8081            88  PD-PROD-GAP            VALUE 'G'.
  8082            88  PD-PROD-FAML           VALUE 'F'.
  8083        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  8084        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  8085        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  8086        16  PD-MAX-TERM              PIC S999        COMP-3.
  8087        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  8088        16  FILLER                   PIC X.
  8089        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  8090        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  8091        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  8092        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 152
* EL156.cbl
  8093        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  8094        16  PD-REC-CRIT-PERIOD       PIC 99.
  8095        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  8096            20  PD-RECURRING-YN      PIC X.
  8097            20  FILLER               PIC X.
  8098        16  PD-RTW-MOS               PIC 99.
  8099        16  PD-MAX-EXTENSION         PIC 99.
  8100        16  pd-ben-pct               pic sv999 comp-3.
  8101*       16  FILLER                   PIC XX.
  8102    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  8103    12  PD-TERM-LIMITS OCCURS 15.
  8104        16  PD-LOW-TERM              PIC S999        COMP-3.
  8105        16  PD-HI-TERM               PIC S999        COMP-3.
  8106*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  8107    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  8108        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  8109        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  8110    12  PD-EARN-FACTORS.
  8111        16  FILLER OCCURS 15.
  8112            20  FILLER OCCURS 15.
  8113                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  8114    12  PD-PRODUCT-DESC              PIC X(80).
  8115    12  PD-TRUNCATED                 PIC X.
  8116    12  FILLER                       PIC X(59).
  8117    12  PD-MAINT-INFORMATION.
  8118        16  PD-LAST-MAINT-DT         PIC X(02).
  8119        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  8120        16  PD-LAST-MAINT-BY         PIC X(04).
  8121*                            COPY ELCCRTT.
  8122******************************************************************
  8123*                                                                *
  8124*                            ELCCRTT.                            *
  8125*                                                                *
  8126*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  8127*                                                                *
  8128*   FILE TYPE = VSAM,KSDS                                        *
  8129*   RECORD SIZE = 552  RECFORM = FIXED                           *
  8130*                                                                *
  8131*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  8132*                                                                *
  8133*   LOG = YES                                                    *
  8134*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  8135******************************************************************
  8136*                   C H A N G E   L O G
  8137*
  8138* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  8139*-----------------------------------------------------------------
  8140*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  8141* EFFECTIVE    NUMBER
  8142*-----------------------------------------------------------------
  8143* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  8144* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  8145* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  8146* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  8147* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  8148* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  8149* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  8150* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 153
* EL156.cbl
  8151* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  8152* 012918  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
  8153******************************************************************
  8154
  8155 01  CERTIFICATE-TRAILERS.
  8156     12  CS-RECORD-ID                      PIC XX.
  8157         88  VALID-CS-ID                      VALUE 'CS'.
  8158
  8159     12  CS-CONTROL-PRIMARY.
  8160         16  CS-COMPANY-CD                 PIC X.
  8161         16  CS-CARRIER                    PIC X.
  8162         16  CS-GROUPING                   PIC X(6).
  8163         16  CS-STATE                      PIC XX.
  8164         16  CS-ACCOUNT                    PIC X(10).
  8165         16  CS-CERT-EFF-DT                PIC XX.
  8166         16  CS-CERT-NO.
  8167             20  CS-CERT-PRIME             PIC X(10).
  8168             20  CS-CERT-SFX               PIC X.
  8169         16  CS-TRAILER-TYPE               PIC X.
  8170             88  COMM-TRLR           VALUE 'A'.
  8171             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  8172             88  CERT-DATA-TRLR      VALUE 'C'.
  8173
  8174     12  CS-DATA-AREA                      PIC X(516).
  8175
  8176     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  8177         16  CS-BANK-COMMISSION-AREA.
  8178             20  CS-BANK-COMMS       OCCURS 10.
  8179                 24  CS-AGT                PIC X(10).
  8180                 24  CS-COM-TYP            PIC X.
  8181                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  8182                 24  CS-RECALC-LV-INDIC    PIC X.
  8183                 24  FILLER                PIC X(10).
  8184         16  FILLER                        PIC X(256).
  8185
  8186     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  8187****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  8188         16  CS-MB-CLAIM-DATA OCCURS 24.
  8189             20  CS-CLAIM-NO               PIC X(7).
  8190             20  CS-CLAIM-TYPE             PIC X.
  8191                 88  CS-AH-CLM               VALUE 'A'.
  8192                 88  CS-IU-CLM               VALUE 'I'.
  8193                 88  CS-GP-CLM               VALUE 'G'.
  8194                 88  CS-LF-CLM               VALUE 'L'.
  8195                 88  CS-PR-CLM               VALUE 'P'.
  8196                 88  CS-FL-CLM               VALUE 'F'.
  8197             20  CS-INSURED-TYPE           PIC X.
  8198                 88  CS-PRIM-INSURED          VALUE 'P'.
  8199                 88  CS-CO-BORROWER           VALUE 'C'.
  8200             20  CS-BENEFIT-PERIOD         PIC 99.
  8201             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  8202             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  8203             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  8204         16  FILLER                        PIC X(12).
  8205     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  8206         16  CS-VIN-NUMBER                 PIC X(17).
  8207         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  8208         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 154
* EL156.cbl
  8209         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  8210         16  cs-agent-name.
  8211             20  cs-agent-fname            pic x(20).
  8212             20  cs-agent-mi               pic x.
  8213             20  cs-agent-lname            pic x(25).
  8214         16  cs-license-no                 pic x(15).
  8215         16  cs-npn-number                 pic x(10).
  8216         16  cs-agent-edit-status          pic x.
  8217             88  cs-ae-refer-to-manager      value 'M'.
  8218             88  cs-ae-cover-sheet           value 'C'.
  8219             88  cs-ae-sig-form              value 'S'.
  8220             88  cs-ae-verified              value 'V'.
  8221             88  cs-unidentified-signature   value 'U'.
  8222             88  cs-cert-returned            value 'R'.
  8223             88  cs-accept-no-commission     value 'N'.
  8224         16  cs-year                       pic 9999.
  8225         16  cs-make                       pic x(20).
  8226         16  cs-model                      pic x(20).
  8227         16  cs-future                     pic x(20).
  8228         16  cs-vehicle-odometer           pic s9(7) comp-3.
  8229         16  cs-claim-verification-status  pic x.
  8230             88  cs-clm-ver-eligible         value 'A'.
  8231             88  cs-clm-ver-partial-elig     value 'B'.
  8232             88  cs-clm-ver-not-eligible     value 'C'.
  8233             88  cs-clm-ver-not-elig-opn-clm value 'D'.
  8234             88  cs-clm-ver-not-part-elig-rw value 'E'.
  8235             88  cs-clm-ver-ND-CERT          value 'F'.
  8236             88  cs-clm-ver-spec-other       value 'G'.
  8237             88  cs-clam-ver-pratial-corrected
  8238                                             value 'H'.
  8239             88  cs-clm-ver-no-matches       value 'I'.
  8240             88  cs-clm-ver-not-elig-corrected
  8241                                             value 'J'.
  8242             88  cs-clm-ver-needs-review     value 'R'.
  8243             88  cs-clm-ver-sent-to-claims   value 'W'.
  8244         16  FILLER                        PIC X(355). *> was 420
  8245*        16  FILLER                        PIC X(496).
  8246 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CLAIM-MASTER
  8247                          CONTROL-FILE CERTIFICATE-MASTER
  8248                          ACTIVITY-TRAILERS ACTIVITY-QUE
  8249                          ACCOUNT-MASTER CHECK-QUE
  8250                          BENEFICIARY-MASTER LETTER-ARCHIVE
  8251                          DAILY-ACTIVITY-RECORD
  8252                          COMPENSATION-MASTER CERTIFICATE-NOTE
  8253                          CERT-NOTE-FILE PRODUCT-MASTER
  8254                          CERTIFICATE-TRAILERS.
  8255 0000-DFHEXIT SECTION.
  8256     MOVE '9#                    $   ' TO DFHEIV0.
  8257     MOVE 'EL156' TO DFHEIV1.
  8258     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  8259
  8260     IF EIBCALEN = 0
  8261         GO TO 8800-UNAUTHORIZED-ACCESS.
  8262
  8263     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  8264     MOVE EIBTRMID               TO QID-TERM.
  8265     MOVE 2                      TO EMI-NUMBER-OF-LINES.
  8266     MOVE '2'                    TO EMI-SWITCH2.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 155
* EL156.cbl
  8267     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  8268     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  8269
  8270     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  8271     MOVE '5'                    TO DC-OPTION-CODE.
  8272     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  8273     MOVE DC-BIN-DATE-1          TO WS-TODAY-DATE
  8274                                    SAVE-BIN-DATE.
  8275     MOVE DC-GREG-DATE-1-EDIT    TO SAVE-DATE.
  8276     MOVE DC-GREG-DATE-1-YMD     TO SAVE-DATE-YMD.
  8277
  8278     IF SAVE-DATE-YY > 70
  8279         MOVE 19                 TO SAVE-DATE-CC
  8280     ELSE
  8281         MOVE 20                 TO SAVE-DATE-CC.
  8282
  8283     IF PI-PROOF-DATE NOT = 0 AND LOW-VALUES
  8284         MOVE PI-PROOF-DATE TO WS-PROOF-DATE
  8285     END-IF.
  8286
  8287     IF PI-PRINT-EOB-YN = 'Y' OR 'S'
  8288        MOVE PI-PRINT-EOB-YN     TO WS-PRINT-EOB-YN
  8289     ELSE
  8290        MOVE 'N'                 TO WS-PRINT-EOB-YN
  8291     END-IF
  8292
  8293     IF PI-PRINT-CLM-FRM-YN = 'N'
  8294         MOVE PI-PRINT-CLM-FRM-YN TO WS-PRINT-CLM-FRM-YN
  8295     ELSE
  8296         MOVE 'Y'                TO WS-PRINT-CLM-FRM-YN
  8297     END-IF
  8298
  8299     IF PI-PRINT-SURVEY-YN = 'N'
  8300         MOVE PI-PRINT-SURVEY-YN TO WS-PRINT-SURVEY-YN
  8301     ELSE
  8302         MOVE 'Y'                TO WS-PRINT-SURVEY-YN
  8303     END-IF
  8304
  8305     IF PI-SPECIAL-RELEASE-YN = 'Y'
  8306         MOVE PI-SPECIAL-RELEASE-YN TO WS-SPECIAL-RELEASE-YN
  8307     ELSE
  8308         MOVE 'N'                TO WS-SPECIAL-RELEASE-YN
  8309     END-IF
  8310
  8311* EXEC CICS HANDLE CONDITION
  8312*        NOTOPEN   (9990-ABEND)
  8313*        PGMIDERR  (8600-PGRM-NOT-FOUND)
  8314*        MAPFAIL   (0400-FIRST-TIME)
  8315*        DUPREC    (6180-DUPREC)
  8316*        ERROR     (9990-ABEND)
  8317*    END-EXEC.
  8318*    MOVE '"$JL?%.               ! " #00008306' TO DFHEIV0
  8319     MOVE X'22244A4C3F252E2020202020' TO DFHEIV0(1:12)
  8320     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8321     MOVE X'2220233030303038333036' TO DFHEIV0(25:11)
  8322     CALL 'kxdfhei1' USING DFHEIV0
  8323     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8324
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 156
* EL156.cbl
  8325
  8326     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  8327         MOVE PI-CALLING-PROGRAM TO RETURNED-FROM.
  8328
  8329     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  8330         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  8331             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  8332             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  8333             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  8334             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  8335             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  8336             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  8337             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  8338             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  8339             MOVE LOW-VALUES           TO EL156AI
  8340             MOVE 'Y'                  TO FIRST-ENTRY
  8341         ELSE
  8342             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  8343             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  8344             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  8345             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  8346             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  8347             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  8348             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  8349             MOVE SPACES               TO PI-SAVED-PROGRAM-6.
  8350
  8351     IF RETURNED-FROM NOT = SPACES
  8352        IF (RETURNED-FROM = 'EL614')
  8353           MOVE PI-PROGRAM-WORK-AREA (1:60) TO WS-SAVED-EOB-CODES
  8354           IF WS-SAVED-EOB-CODES NOT = SPACES
  8355              MOVE 'Y'                TO WS-SET-NOTE2-MDT
  8356           ELSE
  8357              MOVE 'N'                TO WS-SET-NOTE2-MDT
  8358           END-IF
  8359        END-IF
  8360         PERFORM 0600-RECOVER-TEMP-STORAGE THRU 0699-EXIT
  8361            MOVE 'Y'             TO FIRST-ENTRY
  8362            IF RETURNED-FROM = 'EL614'
  8363               AND (PI-PASS-SW NOT = 'C')
  8364               IF WS-SAVED-EOB-CODES NOT = SPACES
  8365                  MOVE WS-SAVED-EOB-CODES
  8366                                 TO PI-PMTNOTE2
  8367                                    WS-PMTNOTE2
  8368                  MOVE 'Y'       TO PI-EOB-CODES-EXIST
  8369               ELSE
  8370                  MOVE SPACES    TO PI-PMTNOTE2
  8371                                    WS-PMTNOTE2
  8372                                    PI-EOB-CODES-EXIST
  8373               END-IF
  8374            END-IF
  8375            PERFORM 3050-REBUILD-ENTERED THRU 3059-EXIT
  8376            PERFORM 7010-BUILD-MAP THRU 7023-BYPASS-REMAINING-TERM
  8377            IF RETURNED-FROM = 'EL614'
  8378               GO TO 1000-EDIT-DATA
  8379            END-IF
  8380            IF (PMTTYPEI = LOW-VALUES OR SPACES) AND
  8381               (PAYEEI   = LOW-VALUES OR SPACES)
  8382               GO TO 8100-SEND-INITIAL-MAP
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 157
* EL156.cbl
  8383            ELSE
  8384               GO TO 1000-EDIT-DATA.
  8385
  8386     IF EIBTRNID NOT = TRANS-ID
  8387         GO TO 0400-FIRST-TIME.
  8388
  8389     IF EIBAID = DFHCLEAR
  8390        IF PI-PASS-SW = 'C'
  8391           PERFORM 0600-RECOVER-TEMP-STORAGE THRU 0699-EXIT
  8392           PERFORM 3050-REBUILD-ENTERED      THRU 3059-EXIT
  8393           PERFORM 7010-BUILD-MAP THRU 7020-BYPASS-BENEFIT
  8394           MOVE 'Y'            TO RETURNED-FROM-B
  8395           GO TO 1000-EDIT-DATA
  8396        ELSE
  8397           GO TO 9400-CLEAR.
  8398
  8399     IF PI-PASS-SW = 'C'
  8400         MOVE MAP-NAMEB          TO MAP-NAME
  8401         IF EIBAID = DFHPF1 OR DFHPF13
  8402             GO TO 5000-UPDATE
  8403           ELSE
  8404             IF EIBAID NOT = DFHENTER
  8405                 MOVE LOW-VALUES TO EL156BI
  8406                 MOVE MAP-NAMEB  TO MAP-NAME
  8407                 MOVE ER-0029    TO EMI-ERROR
  8408                 MOVE -1         TO  ENTPFBL
  8409                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8410                 GO TO 8200-SEND-DATAONLY.
  8411
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 158
* EL156.cbl
  8413 0200-RECEIVE.
  8414     MOVE LOW-VALUES             TO EL156AI.
  8415     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  8416         MOVE ER-0008            TO EMI-ERROR
  8417         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8418         IF PI-PASS-SW = 'C'
  8419             MOVE -1             TO ENTPFBL
  8420             GO TO 8200-SEND-DATAONLY
  8421         ELSE
  8422             MOVE -1             TO PMTTYPEL
  8423             GO TO 8200-SEND-DATAONLY.
  8424
  8425     IF PI-COMPANY-ID = 'DMD'
  8426         PERFORM 7700-GET-DCT THRU 7700-EXIT.
  8427
  8428     IF PI-PASS-SW = 'C'
  8429         MOVE MAP-NAMEB          TO MAP-NAME.
  8430
  8431
  8432* EXEC CICS RECEIVE
  8433*        MAP   (MAP-NAME)
  8434*        MAPSET(MAPSET-NAME)
  8435*        ASIS
  8436*        INTO  (EL156AI)
  8437*    END-EXEC.
  8438     MOVE LENGTH OF
  8439      EL156AI
  8440       TO DFHEIV11
  8441*    MOVE '8"TAI  L              ''   #00008419' TO DFHEIV0
  8442     MOVE X'382254414920204C20202020' TO DFHEIV0(1:12)
  8443     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8444     MOVE X'2020233030303038343139' TO DFHEIV0(25:11)
  8445     CALL 'kxdfhei1' USING DFHEIV0,
  8446           MAP-NAME,
  8447           EL156AI,
  8448           DFHEIV11,
  8449           MAPSET-NAME,
  8450           DFHEIV99,
  8451           DFHEIV99
  8452     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8453
  8454
  8455     IF PI-PASS-SW NOT = 'C'
  8456         GO TO 0250-MAPA.
  8457
  8458     IF ENTPFBL NOT > ZERO
  8459         MOVE MAP-NAMEB          TO MAP-NAME
  8460         MOVE ER-0029            TO EMI-ERROR
  8461         MOVE -1                 TO  ENTPFBL
  8462         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8463         GO TO 8200-SEND-DATAONLY.
  8464
  8465     IF (ENTPFBI NUMERIC) AND (ENTPFBI > 0 AND < 25)
  8466         MOVE PF-VALUES (ENTPFBI) TO EIBAID
  8467       ELSE
  8468         MOVE MAP-NAMEB           TO MAP-NAME
  8469         MOVE ER-0029             TO EMI-ERROR
  8470         MOVE -1                  TO ENTPFBL
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 159
* EL156.cbl
  8471         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8472         GO TO 8200-SEND-DATAONLY.
  8473
  8474     IF EIBAID = DFHPF1 OR DFHPF13
  8475         IF MODIFY-CAP
  8476            GO TO 5000-UPDATE
  8477          ELSE
  8478            MOVE 'UPDATE'           TO SM-READ
  8479            PERFORM 9995-SECURITY-VIOLATION
  8480            MOVE MAP-NAMEB          TO MAP-NAME
  8481            MOVE ER-0070            TO EMI-ERROR
  8482            MOVE -1                 TO  ENTPFBL
  8483            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8484            GO TO 8200-SEND-DATAONLY.
  8485
  8486 0250-MAPA.
  8487     IF ENTERPFL = 0
  8488         GO TO 0300-CHECK-PFKEYS.
  8489
  8490     IF EIBAID NOT = DFHENTER
  8491         MOVE ER-0004            TO EMI-ERROR
  8492         GO TO 0320-INPUT-ERROR.
  8493
  8494     IF (ENTERPFI NUMERIC) AND (ENTERPFI > 0 AND < 25)
  8495         MOVE PF-VALUES (ENTERPFI) TO EIBAID
  8496     ELSE
  8497         MOVE ER-0029            TO EMI-ERROR
  8498         GO TO 0320-INPUT-ERROR.
  8499
  8500 0300-CHECK-PFKEYS.
  8501     IF EIBAID = DFHPF7 OR DFHPF8
  8502         GO TO 8820-PF7-8.
  8503
  8504     IF EIBAID = DFHPF23
  8505         GO TO 8810-PF23.
  8506
  8507     IF EIBAID = DFHPF24
  8508         GO TO 9200-RETURN-MAIN-MENU.
  8509
  8510     IF EIBAID = DFHPF12
  8511         GO TO 9500-PF12.
  8512
  8513     IF EIBAID = DFHPF1
  8514        IF PI-PASS-SW = 'A' OR 'B'
  8515          GO TO 0330-BROWSE-FORWARD.
  8516
  8517     IF EIBAID = DFHPF2
  8518        IF PI-PASS-SW = 'A' OR 'B'
  8519          GO TO 0350-BROWSE-BACKWARD.
  8520
  8521     IF EIBAID = DFHPF6
  8522        IF PI-EOB-CODES-EXIST = 'Y'
  8523           MOVE PI-PMTNOTE2         TO WS-PMTNOTE2
  8524        ELSE
  8525           MOVE SPACES              TO WS-PMTNOTE2
  8526        END-IF
  8527         PERFORM 3000-MOVE-INPUT-TO-SAVE-AREA THRU 3000-EXIT
  8528         IF WS-SAVE-INPUT NOT = PI-SAVE-INPUT
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 160
* EL156.cbl
  8529            MOVE WS-SAVE-INPUT   TO PI-SAVE-INPUT
  8530         END-IF
  8531         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  8532         IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP'
  8533             MOVE 'EL614'        TO PGM-NAME
  8534             MOVE WS-PMTNOTE2    TO PI-PROGRAM-WORK-AREA
  8535             GO TO 9300-XCTL
  8536         ELSE
  8537             MOVE XCTL-157       TO PGM-NAME
  8538             GO TO 9300-XCTL.
  8539
  8540     IF EIBAID = DFHPF9
  8541        PERFORM 0500-CREATE-TEMP-STORAGE  THRU 0599-EXIT
  8542        MOVE XCTL-141            TO PGM-NAME
  8543        GO TO 9300-XCTL.
  8544
  8545     IF EIBAID = DFHPF10
  8546        PERFORM 0500-CREATE-TEMP-STORAGE  THRU 0599-EXIT
  8547        MOVE XCTL-155            TO PGM-NAME
  8548        GO TO 9300-XCTL.
  8549
  8550     MOVE SPACES                 TO ERRMSG0O
  8551                                    ERRMSG1O
  8552                                    ERRMSG2O.
  8553
  8554     IF EIBAID = DFHPF3 OR DFHPF4 OR DFHPF5
  8555         IF PI-PASS-SW NOT = 'B'
  8556             MOVE ER-0422        TO EMI-ERROR
  8557             GO TO 0320-INPUT-ERROR
  8558           ELSE
  8559             GO TO 0700-TEST-FOR-CHANGES.
  8560
  8561     IF EIBAID = DFHPF11
  8562        IF PI-PASS-SW = 'C'
  8563           MOVE ER-0029          TO EMI-ERROR
  8564           GO TO 0320-INPUT-ERROR.
  8565
  8566     IF EIBAID = DFHENTER OR DFHPF11
  8567        NEXT SENTENCE
  8568     ELSE
  8569        MOVE ER-0029             TO EMI-ERROR
  8570        GO TO 0320-INPUT-ERROR.
  8571
  8572     PERFORM 3000-MOVE-INPUT-TO-SAVE-AREA THRU 3000-EXIT.
  8573
  8574     if pi-epyfrom not = zeros
  8575        if pi-epyfrom not = ws-epyfrom
  8576           move zeros        to ws-edays
  8577        end-if
  8578     end-if
  8579
  8580     if pi-epythru not = zeros
  8581        if pi-epythru not = ws-epythru
  8582           move zeros        to ws-edays
  8583        end-if
  8584     end-if
  8585
  8586     IF WS-SAVE-INPUT NOT = PI-SAVE-INPUT
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 161
* EL156.cbl
  8587         MOVE WS-SAVE-INPUT      TO PI-SAVE-INPUT
  8588         GO TO 1000-EDIT-DATA
  8589     ELSE
  8590         IF PI-FATAL-COUNT NOT = 0 OR
  8591            PI-FORCE-COUNT NOT = 0
  8592             GO TO 1000-EDIT-DATA
  8593         ELSE
  8594             GO TO 2000-EDIT-DONE.
  8595
  8596 0320-INPUT-ERROR.
  8597     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8598
  8599     IF ENTERPFL = 0
  8600         MOVE -1                 TO PMTTYPEL
  8601     ELSE
  8602         MOVE AL-UNBON           TO ENTERPFA
  8603         MOVE -1                 TO ENTERPFL.
  8604
  8605     GO TO 8200-SEND-DATAONLY.
  8606
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 162
* EL156.cbl
  8608 0330-BROWSE-FORWARD.
  8609
  8610     MOVE CLMNOI            TO PI-CLAIM-NO.
  8611     MOVE CARRI             TO PI-CARRIER.
  8612     MOVE CERTNOI           TO PI-CERT-PRIME.
  8613     MOVE SUFXI             TO PI-CERT-SFX.
  8614
  8615     MOVE PI-CARRIER        TO MSTR-CARRIER.
  8616     MOVE PI-COMPANY-CD     TO MSTR-COMP-CD.
  8617     MOVE PI-CLAIM-NO       TO MSTR-CLAIM-NO.
  8618     MOVE PI-CERT-NO        TO MSTR-CERT-NO.
  8619
  8620     MOVE ELMSTR-KEY        TO WS-HOLD-ELMSTR-KEY.
  8621
  8622
  8623* EXEC CICS HANDLE CONDITION
  8624*         NOTFND   (0380-CLAIM-END-FILE)
  8625*         ENDFILE  (0380-CLAIM-END-FILE)
  8626*    END-EXEC.
  8627*    MOVE '"$I''                  ! # #00008593' TO DFHEIV0
  8628     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8629     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8630     MOVE X'2320233030303038353933' TO DFHEIV0(25:11)
  8631     CALL 'kxdfhei1' USING DFHEIV0
  8632     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8633
  8634
  8635
  8636* EXEC CICS STARTBR
  8637*         DATASET    ('ELMSTR')
  8638*         RIDFLD     (ELMSTR-KEY)
  8639*         GTEQ
  8640*    END-EXEC.
  8641     MOVE 'ELMSTR' TO DFHEIV1
  8642     MOVE 0
  8643       TO DFHEIV11
  8644*    MOVE '&,         G          &   #00008598' TO DFHEIV0
  8645     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8646     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8647     MOVE X'2020233030303038353938' TO DFHEIV0(25:11)
  8648     CALL 'kxdfhei1' USING DFHEIV0,
  8649           DFHEIV1,
  8650           ELMSTR-KEY,
  8651           DFHEIV99,
  8652           DFHEIV11,
  8653           DFHEIV99
  8654     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8655
  8656
  8657     MOVE 'Y' TO WS-BROWSE-START-SW.
  8658
  8659 0335-READNEXT.
  8660
  8661
  8662* EXEC CICS READNEXT
  8663*         DATASET    ('ELMSTR')
  8664*         RIDFLD     (ELMSTR-KEY)
  8665*         SET        (ADDRESS OF CLAIM-MASTER)
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 163
* EL156.cbl
  8666*    END-EXEC.
  8667     MOVE 'ELMSTR' TO DFHEIV1
  8668     MOVE 0
  8669       TO DFHEIV11
  8670*    MOVE '&.S                   )   #00008608' TO DFHEIV0
  8671     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8672     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8673     MOVE X'2020233030303038363038' TO DFHEIV0(25:11)
  8674     CALL 'kxdfhei1' USING DFHEIV0,
  8675           DFHEIV1,
  8676           DFHEIV20,
  8677           DFHEIV99,
  8678           ELMSTR-KEY,
  8679           DFHEIV99,
  8680           DFHEIV11,
  8681           DFHEIV99,
  8682           DFHEIV99
  8683     SET ADDRESS OF CLAIM-MASTER TO
  8684         DFHEIV20
  8685     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8686
  8687
  8688     IF PI-COMPANY-CD NOT = MSTR-COMP-CD
  8689        GO TO 0380-CLAIM-END-FILE.
  8690
  8691     IF ELMSTR-KEY = WS-HOLD-ELMSTR-KEY
  8692        MOVE CL-CLAIM-NO         TO  PI-PREV-CLMNO
  8693        GO TO 0335-READNEXT.
  8694
  8695     IF PI-COMPANY-ID = 'CRI'
  8696         IF CL-CLAIM-NO  NOT =  PI-PREV-CLMNO
  8697            GO TO 0380-CLAIM-END-FILE.
  8698
  8699     IF CL-SYSTEM-IDENTIFIER = 'CV'
  8700         GO TO 0335-READNEXT.
  8701
  8702     IF PI-CARRIER-SECURITY > SPACES
  8703         IF CL-CARRIER = PI-CARRIER-SECURITY
  8704             NEXT SENTENCE
  8705         ELSE
  8706             GO TO 0335-READNEXT.
  8707
  8708     IF PI-ACCOUNT-SECURITY > SPACES
  8709         IF CL-CERT-ACCOUNT = PI-ACCOUNT-SECURITY
  8710             NEXT SENTENCE
  8711         ELSE
  8712             GO TO 0335-READNEXT.
  8713
  8714     MOVE MSTR-CARRIER      TO PI-CARRIER.
  8715     MOVE MSTR-CLAIM-NO     TO PI-CLAIM-NO.
  8716     MOVE MSTR-CERT-NO      TO PI-CERT-NO.
  8717
  8718     GO TO 0400-FIRST-TIME.
  8719
  8720 0350-BROWSE-BACKWARD.
  8721
  8722     MOVE CLMNOI            TO PI-CLAIM-NO
  8723                               PI-PREV-CLMNO.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 164
* EL156.cbl
  8724     MOVE CARRI             TO PI-CARRIER.
  8725     MOVE CERTNOI           TO PI-CERT-PRIME.
  8726     MOVE SUFXI             TO PI-CERT-SFX.
  8727
  8728     MOVE PI-CARRIER        TO MSTR-CARRIER.
  8729
  8730     MOVE PI-COMPANY-CD     TO MSTR-COMP-CD.
  8731     MOVE PI-CLAIM-NO       TO MSTR-CLAIM-NO.
  8732     MOVE PI-CERT-NO        TO MSTR-CERT-NO.
  8733
  8734
  8735* EXEC CICS HANDLE CONDITION
  8736*         NOTFND   (0380-CLAIM-END-FILE)
  8737*         ENDFILE  (0380-CLAIM-END-FILE)
  8738*    END-EXEC.
  8739*    MOVE '"$I''                  ! $ #00008660' TO DFHEIV0
  8740     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8741     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8742     MOVE X'2420233030303038363630' TO DFHEIV0(25:11)
  8743     CALL 'kxdfhei1' USING DFHEIV0
  8744     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8745
  8746
  8747
  8748* EXEC CICS STARTBR
  8749*         DATASET    ('ELMSTR')
  8750*         RIDFLD     (ELMSTR-KEY)
  8751*         GTEQ
  8752*    END-EXEC.
  8753     MOVE 'ELMSTR' TO DFHEIV1
  8754     MOVE 0
  8755       TO DFHEIV11
  8756*    MOVE '&,         G          &   #00008665' TO DFHEIV0
  8757     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8758     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8759     MOVE X'2020233030303038363635' TO DFHEIV0(25:11)
  8760     CALL 'kxdfhei1' USING DFHEIV0,
  8761           DFHEIV1,
  8762           ELMSTR-KEY,
  8763           DFHEIV99,
  8764           DFHEIV11,
  8765           DFHEIV99
  8766     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8767
  8768
  8769     MOVE 'Y' TO WS-BROWSE-START-SW.
  8770
  8771
  8772* EXEC CICS READNEXT
  8773*         DATASET    ('ELMSTR')
  8774*         RIDFLD     (ELMSTR-KEY)
  8775*         SET        (ADDRESS OF CLAIM-MASTER)
  8776*    END-EXEC.
  8777     MOVE 'ELMSTR' TO DFHEIV1
  8778     MOVE 0
  8779       TO DFHEIV11
  8780*    MOVE '&.S                   )   #00008673' TO DFHEIV0
  8781     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 165
* EL156.cbl
  8782     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8783     MOVE X'2020233030303038363733' TO DFHEIV0(25:11)
  8784     CALL 'kxdfhei1' USING DFHEIV0,
  8785           DFHEIV1,
  8786           DFHEIV20,
  8787           DFHEIV99,
  8788           ELMSTR-KEY,
  8789           DFHEIV99,
  8790           DFHEIV11,
  8791           DFHEIV99,
  8792           DFHEIV99
  8793     SET ADDRESS OF CLAIM-MASTER TO
  8794         DFHEIV20
  8795     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8796
  8797
  8798
  8799* EXEC CICS READPREV
  8800*         DATASET    ('ELMSTR')
  8801*         RIDFLD     (ELMSTR-KEY)
  8802*         SET        (ADDRESS OF CLAIM-MASTER)
  8803*    END-EXEC.
  8804     MOVE 'ELMSTR' TO DFHEIV1
  8805     MOVE 0
  8806       TO DFHEIV11
  8807*    MOVE '&0S                   )   #00008679' TO DFHEIV0
  8808     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8809     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8810     MOVE X'2020233030303038363739' TO DFHEIV0(25:11)
  8811     CALL 'kxdfhei1' USING DFHEIV0,
  8812           DFHEIV1,
  8813           DFHEIV20,
  8814           DFHEIV99,
  8815           ELMSTR-KEY,
  8816           DFHEIV99,
  8817           DFHEIV11,
  8818           DFHEIV99,
  8819           DFHEIV99
  8820     SET ADDRESS OF CLAIM-MASTER TO
  8821         DFHEIV20
  8822     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8823
  8824
  8825 0360-BROWSE-BACKWARD.
  8826
  8827
  8828* EXEC CICS READPREV
  8829*         DATASET    ('ELMSTR')
  8830*         RIDFLD     (ELMSTR-KEY)
  8831*         SET        (ADDRESS OF CLAIM-MASTER)
  8832*    END-EXEC.
  8833     MOVE 'ELMSTR' TO DFHEIV1
  8834     MOVE 0
  8835       TO DFHEIV11
  8836*    MOVE '&0S                   )   #00008687' TO DFHEIV0
  8837     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8838     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8839     MOVE X'2020233030303038363837' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 166
* EL156.cbl
  8840     CALL 'kxdfhei1' USING DFHEIV0,
  8841           DFHEIV1,
  8842           DFHEIV20,
  8843           DFHEIV99,
  8844           ELMSTR-KEY,
  8845           DFHEIV99,
  8846           DFHEIV11,
  8847           DFHEIV99,
  8848           DFHEIV99
  8849     SET ADDRESS OF CLAIM-MASTER TO
  8850         DFHEIV20
  8851     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8852
  8853
  8854     IF PI-COMPANY-CD NOT = MSTR-COMP-CD
  8855        GO TO 0380-CLAIM-END-FILE.
  8856
  8857     IF PI-COMPANY-ID = 'CRI'
  8858         IF CL-CLAIM-NO  NOT =  PI-PREV-CLMNO
  8859            GO TO 0380-CLAIM-END-FILE.
  8860
  8861     IF CL-SYSTEM-IDENTIFIER = 'CV'
  8862         GO TO 0360-BROWSE-BACKWARD.
  8863
  8864     IF PI-CARRIER-SECURITY > SPACES
  8865         IF CL-CARRIER = PI-CARRIER-SECURITY
  8866             NEXT SENTENCE
  8867         ELSE
  8868             GO TO 0360-BROWSE-BACKWARD.
  8869
  8870     IF PI-ACCOUNT-SECURITY > SPACES
  8871         IF CL-CERT-ACCOUNT = PI-ACCOUNT-SECURITY
  8872             NEXT SENTENCE
  8873         ELSE
  8874             GO TO 0360-BROWSE-BACKWARD.
  8875
  8876     MOVE MSTR-CARRIER      TO PI-CARRIER.
  8877     MOVE MSTR-CLAIM-NO     TO PI-CLAIM-NO.
  8878     MOVE MSTR-CERT-NO      TO PI-CERT-NO.
  8879
  8880     GO TO 0400-FIRST-TIME.
  8881
  8882 0380-CLAIM-END-FILE.
  8883
  8884     MOVE ER-0130     TO EMI-ERROR.
  8885     MOVE -1          TO CLMNOL.
  8886     MOVE AL-UABON    TO CARRA
  8887                         CLMNOA
  8888                         CERTNOA
  8889                         SUFXA.
  8890
  8891     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8892
  8893     GO TO 8200-SEND-DATAONLY.
  8894
  8895 0400-FIRST-TIME.
  8896
  8897     IF WS-BROWSE-START-SW = 'Y'
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 167
* EL156.cbl
  8898        MOVE 'N'         TO WS-BROWSE-START-SW
  8899
  8900* EXEC CICS ENDBR
  8901*            DATASET    ('ELMSTR')
  8902*       END-EXEC.
  8903     MOVE 'ELMSTR' TO DFHEIV1
  8904     MOVE 0
  8905       TO DFHEIV11
  8906*    MOVE '&2                    $   #00008738' TO DFHEIV0
  8907     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8908     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8909     MOVE X'2020233030303038373338' TO DFHEIV0(25:11)
  8910     CALL 'kxdfhei1' USING DFHEIV0,
  8911           DFHEIV1,
  8912           DFHEIV11,
  8913           DFHEIV99
  8914     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8915
  8916
  8917     IF PI-PROCESSOR-ID = 'LGXX'
  8918         NEXT SENTENCE
  8919     ELSE
  8920
  8921* EXEC CICS READQ TS
  8922*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  8923*            INTO    (SECURITY-CONTROL)
  8924*            LENGTH  (SC-COMM-LENGTH)
  8925*            ITEM    (SC-ITEM)
  8926*        END-EXEC
  8927*    MOVE '*$II   L              ''   #00008745' TO DFHEIV0
  8928     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  8929     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8930     MOVE X'2020233030303038373435' TO DFHEIV0(25:11)
  8931     CALL 'kxdfhei1' USING DFHEIV0,
  8932           PI-SECURITY-TEMP-STORE-ID,
  8933           SECURITY-CONTROL,
  8934           SC-COMM-LENGTH,
  8935           SC-ITEM,
  8936           DFHEIV99,
  8937           DFHEIV99
  8938     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8939         MOVE SC-CLAIMS-DISPLAY (10)  TO  PI-DISPLAY-CAP
  8940         MOVE SC-CLAIMS-UPDATE  (10)  TO  PI-MODIFY-CAP.
  8941
  8942     MOVE LOW-VALUES             TO EL156AI.
  8943     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
  8944     MOVE 'Y'                    TO FIRST-ENTRY.
  8945     GO TO 7000-SHOW-CLAIM.
  8946
  8947 0500-CREATE-TEMP-STORAGE.
  8948     MOVE EIBCPOSN               TO PI-SAVE-CURSOR.
  8949
  8950
  8951* EXEC CICS WRITEQ TS
  8952*        QUEUE (QID)
  8953*        FROM  (PROGRAM-INTERFACE-BLOCK)
  8954*        LENGTH(PI-COMM-LENGTH)
  8955*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 168
* EL156.cbl
  8956*    MOVE '*"     L              ''   #00008762' TO DFHEIV0
  8957     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
  8958     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8959     MOVE X'2020233030303038373632' TO DFHEIV0(25:11)
  8960     CALL 'kxdfhei1' USING DFHEIV0,
  8961           QID,
  8962           PROGRAM-INTERFACE-BLOCK,
  8963           PI-COMM-LENGTH,
  8964           DFHEIV99,
  8965           DFHEIV99,
  8966           DFHEIV99
  8967     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8968
  8969
  8970
  8971* EXEC CICS WRITEQ TS
  8972*        QUEUE (QID)
  8973*        FROM  (EL156AI)
  8974*        LENGTH(MAP-LENGTH)
  8975*    END-EXEC.
  8976*    MOVE '*"     L              ''   #00008768' TO DFHEIV0
  8977     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
  8978     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8979     MOVE X'2020233030303038373638' TO DFHEIV0(25:11)
  8980     CALL 'kxdfhei1' USING DFHEIV0,
  8981           QID,
  8982           EL156AI,
  8983           MAP-LENGTH,
  8984           DFHEIV99,
  8985           DFHEIV99,
  8986           DFHEIV99
  8987     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8988
  8989
  8990 0599-EXIT.
  8991      EXIT.
  8992
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 169
* EL156.cbl
  8994 0600-RECOVER-TEMP-STORAGE.
  8995
  8996* EXEC CICS READQ TS
  8997*        QUEUE (QID)
  8998*        INTO  (PROGRAM-INTERFACE-BLOCK)
  8999*        LENGTH(PI-COMM-LENGTH)
  9000*    END-EXEC.
  9001*    MOVE '*$I    L              ''   #00008779' TO DFHEIV0
  9002     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  9003     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9004     MOVE X'2020233030303038373739' TO DFHEIV0(25:11)
  9005     CALL 'kxdfhei1' USING DFHEIV0,
  9006           QID,
  9007           PROGRAM-INTERFACE-BLOCK,
  9008           PI-COMM-LENGTH,
  9009           DFHEIV99,
  9010           DFHEIV99,
  9011           DFHEIV99
  9012     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9013
  9014
  9015
  9016* EXEC CICS READQ TS
  9017*        QUEUE (QID)
  9018*        INTO  (EL156AI)
  9019*        LENGTH(MAP-LENGTH)
  9020*    END-EXEC.
  9021*    MOVE '*$I    L              ''   #00008785' TO DFHEIV0
  9022     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  9023     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9024     MOVE X'2020233030303038373835' TO DFHEIV0(25:11)
  9025     CALL 'kxdfhei1' USING DFHEIV0,
  9026           QID,
  9027           EL156AI,
  9028           MAP-LENGTH,
  9029           DFHEIV99,
  9030           DFHEIV99,
  9031           DFHEIV99
  9032     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9033
  9034
  9035     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
  9036
  9037     IF PMTTYPEI NOT = LOW-VALUES
  9038         MOVE AL-UANON           TO PMTTYPEA.
  9039
  9040     IF PAYEEI NOT = LOW-VALUES
  9041         MOVE AL-UANON           TO PAYEEA.
  9042
  9043     IF NOTE1I NOT = LOW-VALUES
  9044         MOVE AL-UANON           TO NOTE1A.
  9045
  9046     IF (RETURNED-FROM = 'EL614')
  9047        MOVE WS-SET-NOTE2-MDT    TO PI-SET-NOTE2-MDT
  9048     END-IF
  9049*    IF (NOTE2I NOT = LOW-VALUES AND SPACES)
  9050*       AND (PI-EOB-CODES-EXIST = 'Y')
  9051*       AND (PI-SET-NOTE2-MDT = 'Y')
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 170
* EL156.cbl
  9052*       MOVE ' '                 TO PI-SET-NOTE2-MDT
  9053     IF PI-SET-NOTE2-MDT = 'Y'
  9054         MOVE AL-SANON           TO NOTE2A
  9055     END-IF
  9056
  9057     IF OFFLINEI NOT = LOW-VALUES
  9058         MOVE AL-UANON           TO OFFLINEA.
  9059
  9060*    IF GROUPEDI NOT = LOW-VALUES
  9061*        MOVE AL-UANON           TO GROUPEDA.
  9062
  9063*    IF CASHI NOT = LOW-VALUES
  9064*        MOVE AL-UANON           TO CASHA.
  9065
  9066     IF CHECKNOI NOT = LOW-VALUES
  9067         MOVE AL-UANON           TO CHECKNOA.
  9068
  9069     IF HOLDTILI NOT = LOW-VALUES
  9070         MOVE AL-UANON           TO HOLDTILA.
  9071
  9072     IF EPYFROMI NOT = LOW-VALUES
  9073         MOVE AL-UANON           TO EPYFROMA.
  9074
  9075     IF AIGFROMI NOT = LOW-VALUES
  9076         MOVE AL-UANON           TO AIGFROMA.
  9077
  9078     IF EPYTHRUI NOT = LOW-VALUES
  9079         MOVE AL-UANON           TO EPYTHRUA.
  9080
  9081     IF EDAYSI NOT = LOW-VALUES
  9082         MOVE AL-UNNON           TO EDAYSA.
  9083
  9084     IF EPYAMTL NOT = +0
  9085         MOVE AL-UNNON           TO EPYAMTA.
  9086
  9087     IF ERESVL NOT = +0
  9088         MOVE AL-UNNON           TO ERESVA.
  9089
  9090     IF EEXPENSL NOT = +0
  9091         MOVE AL-UNNON           TO EEXPENSA.
  9092
  9093     IF ETYPEI NOT = LOW-VALUES
  9094         MOVE AL-UNNON           TO ETYPEA.
  9095
  9096     IF PROOFDTI NOT = 0
  9097         MOVE AL-UNNON           TO PROOFDTA.
  9098
  9099     IF EOBYNI = 'Y' OR 'N' OR 'S'
  9100        MOVE AL-UANON            TO EOBYNA
  9101     END-IF
  9102     IF CLMFMYNI = 'Y' OR 'N'
  9103        MOVE AL-UANON            TO CLMFMYNA
  9104     END-IF
  9105
  9106     IF SURVYYNI = 'Y' OR 'N'
  9107        IF PI-APPROVAL-LEVEL = '4' OR '5'
  9108           MOVE AL-UANON         TO SURVYYNA
  9109        END-IF
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 171
* EL156.cbl
  9110     END-IF
  9111
  9112     IF SPRELYNI = 'Y' OR 'N'
  9113        MOVE AL-UANON            TO SPRELYNA
  9114     END-IF
  9115
  9116     .
  9117 0699-EXIT.
  9118      EXIT.
  9119
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 172
* EL156.cbl
  9121 0700-TEST-FOR-CHANGES.
  9122     IF (EIBAID = DFHPF4) AND (NOT FORCE-CAP)
  9123         MOVE ER-0433            TO EMI-ERROR
  9124         GO TO 0750-FUNCTION-ERROR.
  9125
  9126     PERFORM 3000-MOVE-INPUT-TO-SAVE-AREA THRU 3000-EXIT.
  9127
  9128     IF WS-SAVE-INPUT NOT = PI-SAVE-INPUT
  9129         MOVE WS-SAVE-INPUT      TO PI-SAVE-INPUT
  9130         MOVE 'A'                TO PI-PASS-SW
  9131         GO TO 1000-EDIT-DATA.
  9132
  9133     IF PI-FATAL-COUNT NOT = 0
  9134         MOVE ER-0499            TO EMI-ERROR
  9135         GO TO 0750-FUNCTION-ERROR.
  9136
  9137     IF (PI-FORCE-COUNT NOT = 0) AND (EIBAID NOT = DFHPF4)
  9138         MOVE ER-0500            TO EMI-ERROR
  9139         GO TO 0750-FUNCTION-ERROR.
  9140
  9141     IF (EIBAID  = DFHPF5 AND PI-CPYAMT = ZEROS) OR
  9142        ((EIBAID = DFHPF3 OR DFHPF4) AND PI-EPYAMT = ZEROS)
  9143           MOVE ER-0542          TO EMI-ERROR
  9144           MOVE -1               TO EPYAMTL
  9145           GO TO 0750-FUNCTION-ERROR.
  9146
  9147     IF PI-OFFLINE = 'Y'  OR
  9148        (PI-PMTTYPE = '4' AND PI-EPYAMT NEGATIVE)
  9149        MOVE EIBAID              TO PI-PFKEY-USED
  9150        GO TO 5000-UPDATE.
  9151
  9152     GO TO 6000-BUILD-SCREEN-B.
  9153
  9154 0750-FUNCTION-ERROR.
  9155     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9156
  9157     IF ENTERPFL > 0
  9158         MOVE -1                 TO ENTERPFL
  9159         MOVE AL-UNBON           TO ENTERPFA
  9160         GO TO 8200-SEND-DATAONLY
  9161     ELSE
  9162         MOVE -1                 TO ENTERPFL
  9163         MOVE AL-UNNOF           TO ENTERPFA
  9164         GO TO 8200-SEND-DATAONLY.
  9165
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 173
* EL156.cbl
  9167 0800-DELETE-TS.
  9168
  9169* EXEC CICS HANDLE CONDITION
  9170*        QIDERR(0800-EXIT)
  9171*    END-EXEC.
  9172*    MOVE '"$N                   ! % #00008924' TO DFHEIV0
  9173     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  9174     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9175     MOVE X'2520233030303038393234' TO DFHEIV0(25:11)
  9176     CALL 'kxdfhei1' USING DFHEIV0
  9177     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9178
  9179
  9180
  9181* EXEC CICS DELETEQ TS
  9182*        QUEUE(QID)
  9183*    END-EXEC.
  9184*    MOVE '*&                    #   #00008928' TO DFHEIV0
  9185     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  9186     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9187     MOVE X'2020233030303038393238' TO DFHEIV0(25:11)
  9188     CALL 'kxdfhei1' USING DFHEIV0,
  9189           QID,
  9190           DFHEIV99
  9191     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9192
  9193
  9194 0800-EXIT.
  9195      EXIT.
  9196 0900-GET-DDF-LIMITS.
  9197
  9198     if cm-clp-state = zeros or spaces or low-values
  9199        move cm-state            to cm-clp-state
  9200     end-if
  9201     MOVE ' '                    TO WS-PDEF-RECORD-SW
  9202     MOVE PI-COMPANY-CD          TO ERPDEF-KEY
  9203     MOVE cm-clp-state           TO ERPDEF-STATE
  9204     MOVE PI-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  9205     evaluate true
  9206        when (cl-claim-type = 'L' or 'P')
  9207           and (pi-lf-benefit-cd not = '00' and '  ' and 'DD'
  9208             and 'CU')
  9209           move 'L'              to erpdef-ben-type
  9210           move pi-lf-benefit-cd to erpdef-ben-code
  9211        when (cl-claim-type not = 'L' and 'P')
  9212           and (pi-ah-benefit-cd not = '00' and '  ')
  9213           move 'A'              to erpdef-ben-type
  9214           move pi-ah-benefit-cd to erpdef-ben-code
  9215        when (cl-claim-type not = 'L' and 'P')
  9216           and (pi-ah-benefit-cd = '00' or '  ')
  9217           move 'L'              to erpdef-ben-type
  9218           move pi-lf-benefit-cd to erpdef-ben-code
  9219        when (cl-claim-type = 'L' or 'P')
  9220           and (pi-lf-benefit-cd = '00' or '  ' or 'DD' or 'CU')
  9221           move 'A'              to erpdef-ben-type
  9222           move pi-ah-benefit-cd to erpdef-ben-code
  9223        when other
  9224           move 'A'              to erpdef-ben-type
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 174
* EL156.cbl
  9225           move pi-ah-benefit-cd to erpdef-ben-code
  9226     end-evaluate
  9227*    if (cl-claim-type = 'L' or 'P')
  9228*       and (pi-lf-benefit-cd not = '00' and '  ' and 'DD'
  9229*          and 'CU')
  9230*       move 'L'                 to erpdef-ben-type
  9231*       move pi-lf-benefit-cd    to erpdef-ben-code
  9232*    else
  9233*       MOVE 'A'                 TO ERPDEF-BEN-TYPE
  9234*       MOVE PI-AH-BENEFIT-CD    TO ERPDEF-BEN-CODE
  9235*    end-if
  9236     MOVE CL-CERT-EFF-DT         TO ERPDEF-EXP-DT
  9237
  9238     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  9239
  9240
  9241* EXEC CICS STARTBR
  9242*        DATASET  ('ERPDEF')
  9243*        RIDFLD   (ERPDEF-KEY)
  9244*        GTEQ
  9245*        RESP     (WS-RESPONSE)
  9246*    END-EXEC
  9247     MOVE 'ERPDEF' TO DFHEIV1
  9248     MOVE 0
  9249       TO DFHEIV11
  9250*    MOVE '&,         G          &  N#00008978' TO DFHEIV0
  9251     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9252     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9253     MOVE X'204E233030303038393738' TO DFHEIV0(25:11)
  9254     CALL 'kxdfhei1' USING DFHEIV0,
  9255           DFHEIV1,
  9256           ERPDEF-KEY,
  9257           DFHEIV99,
  9258           DFHEIV11,
  9259           DFHEIV99
  9260     MOVE EIBRESP  TO WS-RESPONSE
  9261     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9262
  9263     IF NOT WS-RESP-NORMAL
  9264        GO TO 0900-EXIT
  9265     END-IF
  9266
  9267     .
  9268 0900-READNEXT.
  9269
  9270
  9271* EXEC CICS READNEXT
  9272*       DATASET  ('ERPDEF')
  9273*       SET      (ADDRESS OF PRODUCT-MASTER)
  9274*       RIDFLD   (ERPDEF-KEY)
  9275*       RESP     (WS-RESPONSE)
  9276*    END-EXEC
  9277     MOVE 'ERPDEF' TO DFHEIV1
  9278     MOVE 0
  9279       TO DFHEIV11
  9280*    MOVE '&.S                   )  N#00008992' TO DFHEIV0
  9281     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9282     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 175
* EL156.cbl
  9283     MOVE X'204E233030303038393932' TO DFHEIV0(25:11)
  9284     CALL 'kxdfhei1' USING DFHEIV0,
  9285           DFHEIV1,
  9286           DFHEIV20,
  9287           DFHEIV99,
  9288           ERPDEF-KEY,
  9289           DFHEIV99,
  9290           DFHEIV11,
  9291           DFHEIV99,
  9292           DFHEIV99
  9293     SET ADDRESS OF PRODUCT-MASTER TO
  9294         DFHEIV20
  9295     MOVE EIBRESP  TO WS-RESPONSE
  9296     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9297
  9298     IF NOT WS-RESP-NORMAL
  9299        GO TO 0900-ENDBR
  9300     END-IF
  9301
  9302     IF (ERPDEF-KEY-SAVE (1:16) = PD-CONTROL-PRIMARY (1:16))
  9303        IF (CM-CERT-EFF-DT < PD-PROD-EXP-DT)
  9304           MOVE 'Y'              TO WS-PDEF-RECORD-SW
  9305        ELSE
  9306           GO TO 0900-READNEXT
  9307        END-IF
  9308     ELSE
  9309        GO TO 0900-ENDBR
  9310     END-IF
  9311
  9312     IF CM-LOAN-TERM = ZEROS
  9313        MOVE CP-ORIGINAL-TERM    TO CP-LOAN-TERM
  9314     END-IF
  9315
  9316     .
  9317 0900-ENDBR.
  9318
  9319
  9320* EXEC CICS ENDBR
  9321*       DATASET  ('ERPDEF')
  9322*    END-EXEC
  9323     MOVE 'ERPDEF' TO DFHEIV1
  9324     MOVE 0
  9325       TO DFHEIV11
  9326*    MOVE '&2                    $   #00009020' TO DFHEIV0
  9327     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9328     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9329     MOVE X'2020233030303039303230' TO DFHEIV0(25:11)
  9330     CALL 'kxdfhei1' USING DFHEIV0,
  9331           DFHEIV1,
  9332           DFHEIV11,
  9333           DFHEIV99
  9334     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9335
  9336     .
  9337 0900-EXIT.
  9338     EXIT.
  9339 1000-EDIT-DATA.
  9340
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 176
* EL156.cbl
  9341     MOVE 0 TO PI-FATAL-COUNT  PI-FORCE-COUNT  PI-BEN-DAYS
  9342         PI-CDAYS  PI-CPYAMT  PI-CRESV  PI-CEXPENS PI-MANUAL-SW
  9343         PI-INT-AMT PI-INT-DAYS PI-INT-RATE-USED
  9344
  9345     MOVE LOW-VALUES TO PI-CPYFROM  PI-CPYTHRU.
  9346
  9347     IF NOT MODIFY-CAP
  9348         MOVE ER-0070            TO EMI-ERROR
  9349         MOVE -1                 TO PMTTYPEL
  9350         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9351         GO TO 2000-EDIT-DONE.
  9352
  9353     IF PI-PMTTYPE NOT = '1' AND '2' AND '3' AND '4' AND
  9354                         '5' AND '6'
  9355         MOVE ER-0420            TO EMI-ERROR
  9356         MOVE -1                 TO PMTTYPEL
  9357         MOVE AL-UABON           TO PMTTYPEA
  9358         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9359     ELSE
  9360         MOVE AL-UANON           TO PMTTYPEA.
  9361
  9362*    IF PI-OFFLINE = 'Y'
  9363*       IF PI-GROUPED = 'Y'
  9364*          MOVE ER-1880         TO EMI-ERROR
  9365*          MOVE -1              TO GROUPEDL
  9366*          MOVE AL-UABON        TO GROUPEDA
  9367*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9368*
  9369*    IF GROUPEDL > +0
  9370*       IF PI-GROUPED = 'Y' OR 'N'
  9371*          MOVE AL-UANON TO GROUPEDA
  9372*       ELSE
  9373*          MOVE ER-3140            TO EMI-ERROR
  9374*          MOVE -1                 TO GROUPEDL
  9375*          MOVE AL-UABON           TO GROUPEDA
  9376*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9377*
  9378*    IF CASHL > +0
  9379*       IF PI-CASH = 'Y' OR 'N'
  9380*          MOVE AL-UANON           TO CASHA
  9381*       ELSE
  9382*          MOVE ER-3141            TO EMI-ERROR
  9383*          MOVE -1                 TO CASHL
  9384*          MOVE AL-UABON           TO CASHA
  9385*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9386
  9387     IF LOANNOL > +0
  9388         MOVE 'Y'                TO  PI-LOAN-UPDATE-SW.
  9389
  9390 1000-EDIT-PAYEE.
  9391
  9392     IF PI-PAYEE-SEQ NOT NUMERIC
  9393         MOVE ER-0294            TO  EMI-ERROR
  9394         MOVE -1                 TO  PAYEEL
  9395         MOVE AL-UABON           TO  PAYEEA
  9396         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9397         GO TO 1000-CONT-EDIT.
  9398
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 177
* EL156.cbl
  9399     IF PI-PAYEE-TYPE =  'I' OR 'B' OR 'A' OR 'P' OR
  9400                         'E' OR 'O' OR 'Q'
  9401         NEXT SENTENCE
  9402     ELSE
  9403         MOVE ER-0294            TO  EMI-ERROR
  9404         MOVE -1                 TO  PAYEEL
  9405         MOVE AL-UABON           TO  PAYEEA
  9406         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9407         GO TO 1000-CONT-EDIT.
  9408
  9409     IF ((PI-PAYEE-TYPE = 'I' OR 'E' OR 'O' OR 'P' OR 'Q')  AND
  9410        (PI-PAYEE-SEQ NOT < '1' AND
  9411         PI-PAYEE-SEQ NOT > '9'))
  9412      OR
  9413        ((PI-PAYEE-TYPE = 'A' OR 'B')  AND
  9414         (PI-PAYEE-SEQ NOT > '9'))
  9415         MOVE AL-UANON            TO PAYEEA
  9416     ELSE
  9417         MOVE ER-0294            TO EMI-ERROR
  9418         MOVE -1                 TO PAYEEL
  9419         MOVE AL-UABON           TO PAYEEA
  9420         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9421
  9422     IF PI-COMPANY-ID = 'DMD'
  9423         IF PI-PAYEE-TYPE = 'B' AND
  9424            PI-PAYEE-SEQ NOT = '0'
  9425               MOVE ER-7841            TO EMI-ERROR
  9426               MOVE -1                 TO PAYEEL
  9427               MOVE AL-UABON           TO PAYEEA
  9428               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9429
  9430     IF PI-COMPANY-ID = 'JHL'
  9431         IF PI-PAYEE = 'B0'
  9432             NEXT SENTENCE
  9433           ELSE
  9434
  9435* EXEC CICS HANDLE CONDITION
  9436*            ENDFILE(1950-NOT-FOUND)
  9437*            NOTFND (1950-NOT-FOUND)
  9438*        END-EXEC
  9439*    MOVE '"$''I                  ! & #00009122' TO DFHEIV0
  9440     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  9441     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9442     MOVE X'2620233030303039313232' TO DFHEIV0(25:11)
  9443     CALL 'kxdfhei1' USING DFHEIV0
  9444     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9445         MOVE 'N'                    TO FOUND-TOL-SW
  9446         MOVE PI-COMPANY-ID          TO CNTL-COMP-ID
  9447         MOVE '2'                    TO CNTL-REC-TYPE
  9448         MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS
  9449         MOVE +0                     TO CNTL-SEQ-NO
  9450         MOVE 'PROC'                 TO FILE-SWITCH
  9451         PERFORM 7930-READ-CONTROL THRU 7930-EXIT
  9452         IF PI-PAYEE = 'I1' AND
  9453            APPROVAL-LEVEL-2
  9454             NEXT SENTENCE
  9455           ELSE
  9456         IF NOT PI-USER-ALMIGHTY-YES
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 178
* EL156.cbl
  9457             MOVE ER-3546        TO EMI-ERROR
  9458             MOVE -1             TO PAYEEL
  9459             MOVE AL-UABON       TO PAYEEA
  9460             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9461
  9462     IF PI-PAYEE-TYPE = 'E'
  9463        IF PI-PMTTYPE = '5' OR '6'
  9464            NEXT SENTENCE
  9465        ELSE
  9466            MOVE ER-3539            TO EMI-ERROR
  9467            MOVE -1                 TO PAYEEL
  9468            MOVE AL-UABON           TO PAYEEA
  9469            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9470
  9471 1000-CONT-EDIT.
  9472
  9473     IF PI-OFFLINE NOT = 'Y' AND 'N'
  9474        IF PI-EPYAMT NOT NEGATIVE
  9475            MOVE ER-0421         TO EMI-ERROR
  9476            MOVE -1              TO OFFLINEL
  9477            MOVE AL-UABON        TO OFFLINEA
  9478            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9479        ELSE
  9480            MOVE AL-UANON        TO OFFLINEA.
  9481
  9482     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP'
  9483        IF PI-PRINT-EOB-YN = 'Y' OR 'N'
  9484           CONTINUE
  9485        ELSE
  9486           IF PI-PRINT-EOB-YN = 'S' AND
  9487              PI-CLM-TYPE = PI-LIFE-OVERRIDE-L1
  9488                CONTINUE
  9489           ELSE
  9490              MOVE ER-1561       TO EMI-ERROR
  9491              MOVE -1            TO EOBYNL
  9492              MOVE AL-UABON      TO EOBYNA
  9493              PERFORM 9900-ERROR-FORMAT
  9494                                 THRU 9900-EXIT
  9495           END-IF
  9496        END-IF
  9497
  9498        IF PI-PRINT-CLM-FRM-YN NOT = 'Y' AND 'N'
  9499            MOVE ER-1566        TO EMI-ERROR
  9500            MOVE -1             TO CLMFMYNL
  9501            MOVE AL-UABON       TO CLMFMYNA
  9502            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9503        END-IF
  9504
  9505        IF PI-PRINT-SURVEY-YN NOT = 'Y' AND 'N'
  9506            MOVE ER-1567        TO EMI-ERROR
  9507            MOVE -1             TO SURVYYNL
  9508            MOVE AL-UABON       TO SURVYYNA
  9509            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9510        END-IF
  9511
  9512        IF PI-SPECIAL-RELEASE-YN NOT = 'Y' AND 'N'
  9513            MOVE ER-1569        TO EMI-ERROR
  9514            MOVE -1             TO SPRELYNL
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 179
* EL156.cbl
  9515            MOVE AL-UABON       TO SPRELYNA
  9516            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9517        END-IF
  9518
  9519     END-IF
  9520     IF PI-EPYAMT IS NEGATIVE
  9521         IF PI-OFFLINE NOT = 'Y'
  9522             MOVE ER-0836        TO  EMI-ERROR
  9523             MOVE -1             TO  OFFLINEL
  9524             MOVE AL-UABON       TO  OFFLINEA
  9525             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9526
  9527     IF PI-PROOF-DATE = ZEROS OR LOW-VALUES OR SPACES
  9528        MOVE ER-0872             TO EMI-ERROR
  9529        MOVE -1                  TO PROOFDTL
  9530        MOVE AL-UABON            TO PROOFDTA
  9531        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9532     ELSE
  9533        MOVE '4'                TO DC-OPTION-CODE
  9534        MOVE PI-PROOF-DATE      TO DC-GREG-DATE-1-MDY
  9535        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  9536        IF DATE-CONVERSION-ERROR
  9537            MOVE ER-0873        TO EMI-ERROR
  9538            MOVE -1                  TO PROOFDTL
  9539            MOVE AL-UABON            TO PROOFDTA
  9540            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9541        ELSE
  9542            MOVE DC-BIN-DATE-1   TO WS-BIN-PROOF-DT
  9543            IF DC-BIN-DATE-1 > WS-TODAY-DATE
  9544                MOVE ER-0873    TO EMI-ERROR
  9545                MOVE -1                  TO PROOFDTL
  9546                MOVE AL-UABON            TO PROOFDTA
  9547                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9548            END-IF
  9549        END-IF
  9550     END-IF.
  9551
  9552     IF PI-COMPANY-ID = 'DMD'
  9553        IF NOTE1L NOT = ZEROS
  9554            MOVE ER-7844        TO  EMI-ERROR
  9555            MOVE -1             TO  NOTE1L
  9556            MOVE AL-UABON       TO  NOTE1A
  9557            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9558
  9559     IF PI-COMPANY-ID = 'DMD'
  9560        IF NOTE2L NOT = ZEROS
  9561          GO TO 1004-DMD-EOB-CHECKS.
  9562
  9563     IF NOTE1L NOT > +0
  9564         GO TO 1005-CHECK-ERRORS.
  9565
  9566     IF PI-COMPANY-ID NOT = 'FLI' AND 'FLU' AND 'HAN' AND 'JHL'
  9567         GO TO 1005-CHECK-ERRORS.
  9568
  9569     IF PI-COMPANY-ID = 'HAN' OR 'JHL'
  9570         GO TO 1003-HAN-PMT-NOTES.
  9571
  9572     MOVE NOTE1I                 TO WS-FLI-PMTNOTE.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 180
* EL156.cbl
  9573
  9574     IF WS-PMTOPTION NUMERIC
  9575        IF WS-PMTOPTION > '00' AND < '17'
  9576           NEXT SENTENCE
  9577        ELSE
  9578           MOVE ER-0618          TO EMI-ERROR
  9579           MOVE -1               TO NOTE1L
  9580           MOVE AL-UABON         TO NOTE1A
  9581           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9582     ELSE
  9583        GO TO 1005-CHECK-ERRORS.
  9584
  9585     IF WS-PMTOPTION = '05' AND
  9586        WS-DOCNAME = SPACES
  9587          MOVE ER-0616             TO EMI-ERROR
  9588          MOVE -1                  TO NOTE1L
  9589          MOVE AL-UABON            TO NOTE1A
  9590          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9591
  9592     IF WS-PMTOPTION = '15' OR '16'
  9593
  9594* EXEC CICS BIF DEEDIT
  9595*            FIELD (WS-AMOUNT)
  9596*            LENGTH(08)
  9597*        END-EXEC
  9598     MOVE 08
  9599       TO DFHEIV11
  9600*    MOVE '@"L                   #   #00009274' TO DFHEIV0
  9601     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9602     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9603     MOVE X'2020233030303039323734' TO DFHEIV0(25:11)
  9604     CALL 'kxdfhei1' USING DFHEIV0,
  9605           WS-AMOUNT,
  9606           DFHEIV11
  9607     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9608        IF (WS-NUM-AMT = ZEROS) OR
  9609           (WS-AMOUNT NOT NUMERIC)
  9610           MOVE ER-0617          TO EMI-ERROR
  9611           MOVE -1               TO NOTE1L
  9612           MOVE AL-UABON         TO NOTE1A
  9613           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9614
  9615     MOVE WS-FLI-PMTNOTE TO NOTE1I WS-PMTNOTE1 PI-PMTNOTE1.
  9616
  9617     GO TO 1005-CHECK-ERRORS.
  9618
  9619 1003-HAN-PMT-NOTES.
  9620
  9621     MOVE NOTE1I                 TO WS-HAN-PMTNOTE.
  9622
  9623     IF WS-HAN-PMT-CODE = SPACE
  9624         MOVE SPACES             TO WS-HAN-PMT-NOTE
  9625     ELSE
  9626     IF WS-HAN-PMT-CODE = 'A'
  9627         MOVE ':FINAL PAYMENT / MAXIMUM BENEFIT-PAID'
  9628                                 TO WS-HAN-PMT-NOTE
  9629     ELSE
  9630     IF WS-HAN-PMT-CODE = 'B'
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 181
* EL156.cbl
  9631         MOVE ':FINAL PAYMENT / DECEASED'
  9632                                 TO WS-HAN-PMT-NOTE
  9633     ELSE
  9634     IF WS-HAN-PMT-CODE = 'C'
  9635         MOVE ':FINAL PAYMENT / NO LONGER DISABLED'
  9636                                 TO WS-HAN-PMT-NOTE
  9637     ELSE
  9638     IF WS-HAN-PMT-CODE = 'D'
  9639         MOVE ':FINAL PAYMENT / ADDL INFO NOT PROVIDED'
  9640                                 TO WS-HAN-PMT-NOTE
  9641     ELSE
  9642     IF WS-HAN-PMT-CODE = 'E'
  9643         MOVE ':FINAL PAYMENT / RETURNED TO WORK'
  9644                                 TO WS-HAN-PMT-NOTE
  9645     ELSE
  9646     IF WS-HAN-PMT-CODE = 'F'
  9647         MOVE ':FINAL PAYMENT / PAID TO MATURITY DATE'
  9648                                 TO WS-HAN-PMT-NOTE
  9649     ELSE
  9650     IF WS-HAN-PMT-CODE = 'P'
  9651         MOVE ':PARTIAL PAYMENT' TO WS-HAN-PMT-NOTE.
  9652
  9653     MOVE WS-HAN-PMTNOTE TO NOTE1I WS-PMTNOTE1 PI-PMTNOTE1.
  9654     GO TO 1005-CHECK-ERRORS.
  9655
  9656 1004-DMD-EOB-CHECKS.
  9657
  9658     INITIALIZE PI-AT-EOB-CODES.
  9659
  9660     IF NOTE2I (20:21) > SPACES
  9661         MOVE ER-7845          TO EMI-ERROR
  9662         MOVE -1               TO NOTE2L
  9663         MOVE AL-UABON         TO NOTE2A
  9664         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9665         GO TO 1005-CHECK-ERRORS
  9666      ELSE
  9667         MOVE NOTE2I             TO W-EOB-CODES.
  9668
  9669     MOVE +1                     TO W-EOB-NDX.
  9670
  9671 1004-CHECK-EACH-EOB.
  9672
  9673     IF W-EOB-NDX > +5
  9674             OR
  9675        W-EOB-CODE (W-EOB-NDX) = SPACES
  9676         GO TO 1004-CHECK-DUP-EOB.
  9677
  9678     IF W-EOB-FILLER (W-EOB-NDX) NOT = SPACES
  9679         MOVE ER-0956            TO EMI-ERROR
  9680         MOVE -1                 TO NOTE2L
  9681         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9682         GO TO 1005-CHECK-ERRORS.
  9683
  9684     MOVE 'CL'                   TO CD-SYSTEM-ID.
  9685     MOVE 'EO'                   TO CD-RECORD-TYPE.
  9686     MOVE W-EOB-CODE (W-EOB-NDX) TO CD-RECORD-KEY.
  9687     MOVE 'DLO023'               TO PGM-NAME.
  9688
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 182
* EL156.cbl
  9689
  9690* EXEC CICS LINK
  9691*        PROGRAM    (PGM-NAME)
  9692*        COMMAREA   (CD-COMMUNICATION-AREA)
  9693*        LENGTH     (CD-RCRD-LENGTH)
  9694*    END-EXEC.
  9695*    MOVE '."C                   (   #00009359' TO DFHEIV0
  9696     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9697     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9698     MOVE X'2020233030303039333539' TO DFHEIV0(25:11)
  9699     CALL 'kxdfhei1' USING DFHEIV0,
  9700           PGM-NAME,
  9701           CD-COMMUNICATION-AREA,
  9702           CD-RCRD-LENGTH,
  9703           DFHEIV99,
  9704           DFHEIV99,
  9705           DFHEIV99,
  9706           DFHEIV99
  9707     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9708
  9709
  9710     IF CD-RETURN-CODE = 'OK'
  9711         GO TO 1004-CONT.
  9712
  9713     MOVE -1                     TO NOTE2L.
  9714
  9715     IF CD-RETURN-CODE = '01'
  9716         MOVE ER-8310            TO EMI-ERROR
  9717         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9718         GO TO 1005-CHECK-ERRORS.
  9719
  9720     IF CD-RETURN-CODE = '02'
  9721         MOVE ER-8311            TO EMI-ERROR
  9722         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9723         GO TO 1005-CHECK-ERRORS.
  9724
  9725     IF CD-RETURN-CODE = '03'
  9726         MOVE ER-8312            TO EMI-ERROR
  9727         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9728         GO TO 1005-CHECK-ERRORS.
  9729
  9730     IF CD-RETURN-CODE = '04'
  9731         MOVE ER-8313            TO EMI-ERROR
  9732         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9733         GO TO 1005-CHECK-ERRORS.
  9734
  9735     IF CD-RETURN-CODE = '05'
  9736         MOVE ER-8314            TO EMI-ERROR
  9737         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9738         GO TO 1005-CHECK-ERRORS.
  9739
  9740     IF CD-RETURN-CODE = '06'
  9741         MOVE ER-8315            TO EMI-ERROR
  9742         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9743         GO TO 1005-CHECK-ERRORS.
  9744
  9745     IF CD-RETURN-CODE = 'E1'
  9746         MOVE ER-8316            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 183
* EL156.cbl
  9747         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9748         GO TO 1005-CHECK-ERRORS.
  9749
  9750     IF CD-RETURN-CODE = 'N1'
  9751         MOVE ER-8317            TO EMI-ERROR
  9752         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9753         GO TO 1005-CHECK-ERRORS.
  9754
  9755 1004-CONT.
  9756     MOVE W-EOB-CODE (W-EOB-NDX) TO PI-AT-EOB-CODE (W-EOB-NDX).
  9757
  9758     ADD +1 TO W-EOB-NDX.
  9759     GO TO 1004-CHECK-EACH-EOB.
  9760
  9761 1004-CHECK-DUP-EOB.
  9762     IF ((PI-AT-EOB-CODE (1) NOT = SPACE) AND
  9763         (PI-AT-EOB-CODE (1) = PI-AT-EOB-CODE (2) OR
  9764                               PI-AT-EOB-CODE (3) OR
  9765                               PI-AT-EOB-CODE (4) OR
  9766                               PI-AT-EOB-CODE (5)))
  9767                  OR
  9768        ((PI-AT-EOB-CODE (2) NOT = SPACE) AND
  9769         (PI-AT-EOB-CODE (2) = PI-AT-EOB-CODE (3) OR
  9770                               PI-AT-EOB-CODE (4) OR
  9771                               PI-AT-EOB-CODE (5)))
  9772                  OR
  9773        ((PI-AT-EOB-CODE (3) NOT = SPACE) AND
  9774         (PI-AT-EOB-CODE (3) = PI-AT-EOB-CODE (4) OR
  9775                               PI-AT-EOB-CODE (5)))
  9776                  OR
  9777        ((PI-AT-EOB-CODE (4) NOT = SPACE) AND
  9778         (PI-AT-EOB-CODE (4) = PI-AT-EOB-CODE (5)))
  9779            MOVE ER-8000            TO EMI-ERROR
  9780            MOVE AL-UABON           TO NOTE2A
  9781            MOVE -1                 TO NOTE2L
  9782            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9783            GO TO 1005-CHECK-ERRORS.
  9784
  9785 1005-CHECK-ERRORS.
  9786*    IF PI-COMPANY-ID NOT = 'DMD'
  9787        GO TO 1006-CHECK-ERRORS.
  9788
  9789*********  DMD CODE START ******************
  9790*    IF CL-CLAIM-TYPE NOT = PI-AH-OVERRIDE-L1 AND 'I' AND 'G'
  9791*       GO TO 1006-CHECK-ERRORS.
  9792*
  9793*    PERFORM 7700-GET-DCT THRU 7700-EXIT.
  9794*
  9795*    COMPUTE W-PAYMENT-TOTAL
  9796*         = CL-TOTAL-PAID-AMT + PI-EPYAMT
  9797*    IF (W-PAYMENT-TOTAL > PI-MAX-BENEFIT-PYMT)
  9798*               AND
  9799*       (PI-MAX-BENEFIT-PYMT > ZEROS)
  9800*          EXEC CICS SYNCPOINT ROLLBACK END-EXEC
  9801*          MOVE ER-0967    TO EMI-ERROR
  9802*          MOVE -1         TO PMTTYPEL
  9803*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9804*
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 184
* EL156.cbl
  9805*    GO TO 1006-CHECK-ERRORS.
  9806*********  DMD CODE END ******************
  9807
  9808 1006-CHECK-ERRORS.
  9809     if emi-forcable-ctr = zeros
  9810        and emi-fatal-ctr = zeros
  9811        continue
  9812     else
  9813        IF NOT EMI-NO-ERRORS
  9814           GO TO 2000-EDIT-DONE
  9815        end-if
  9816     end-if
  9817
  9818* EXEC CICS HANDLE CONDITION
  9819*        NOTFND(1950-NOT-FOUND)
  9820*    END-EXEC.
  9821*    MOVE '"$I                   ! '' #00009472' TO DFHEIV0
  9822     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9823     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9824     MOVE X'2720233030303039343732' TO DFHEIV0(25:11)
  9825     CALL 'kxdfhei1' USING DFHEIV0
  9826     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9827
  9828
  9829     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  9830     MOVE PI-CARRIER             TO MSTR-CARRIER.
  9831     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
  9832     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
  9833     MOVE 'MSTR'                 TO FILE-SWITCH.
  9834
  9835     PERFORM 7900-READ-CLAIM THRU 7900-EXIT.
  9836
  9837     IF PI-COMPANY-ID = 'DMD'
  9838         PERFORM 8010-DMD-ERROR-CHECKS THRU 8090-EXIT.
  9839
  9840     IF WS-BIN-PROOF-DT NOT = LOW-VALUES
  9841        IF WS-BIN-PROOF-DT < CL-INCURRED-DT
  9842           MOVE ER-0873    TO EMI-ERROR
  9843           MOVE -1                  TO PROOFDTL
  9844           MOVE AL-UABON            TO PROOFDTA
  9845           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9846        END-IF
  9847     END-IF
  9848     if cl-benefit-period = zeros
  9849        move er-1667             to emi-error
  9850        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9851     end-if
  9852     MOVE ELMSTR-KEY             TO ELTRLR-KEY
  9853     MOVE +95                    TO TRLR-SEQ-NO
  9854
  9855* EXEC CICS READ
  9856*       DATASET  ('ELTRLR')
  9857*       SET      (ADDRESS OF ACTIVITY-TRAILERS)
  9858*       RIDFLD   (ELTRLR-KEY)
  9859*       RESP     (WS-RESPONSE)
  9860*    END-EXEC
  9861     MOVE 'ELTRLR' TO DFHEIV1
  9862*    MOVE '&"S        E          (  N#00009501' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 185
* EL156.cbl
  9863     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9864     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9865     MOVE X'204E233030303039353031' TO DFHEIV0(25:11)
  9866     CALL 'kxdfhei1' USING DFHEIV0,
  9867           DFHEIV1,
  9868           DFHEIV20,
  9869           DFHEIV99,
  9870           ELTRLR-KEY,
  9871           DFHEIV99,
  9872           DFHEIV99,
  9873           DFHEIV99
  9874     SET ADDRESS OF ACTIVITY-TRAILERS TO
  9875         DFHEIV20
  9876     MOVE EIBRESP  TO WS-RESPONSE
  9877     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9878
  9879     if ws-resp-normal
  9880        perform varying s1 from +1 by +1 until
  9881           at-note-error-no (s1) = spaces
  9882           if at-note-error-no (s1) = '1662'
  9883              continue
  9884           else
  9885              move at-note-error-no (s1)
  9886                                 to emi-error
  9887              if at-note-error-no (s1) = '1653'
  9888                 evaluate true
  9889                    when cl-claim-type = 'L'
  9890                       move '  LF  '
  9891                                 to emi-claim-type
  9892                    when cl-claim-type = 'I'
  9893                       move '  IU  '
  9894                                 to emi-claim-type
  9895                    when cl-claim-type = 'A'
  9896                       move '  AH  '
  9897                                 to emi-claim-type
  9898                    when other
  9899                       move ' FMLA '
  9900                                 to emi-claim-type
  9901                 end-evaluate
  9902              end-if
  9903              PERFORM 9900-ERROR-FORMAT
  9904                                 THRU 9900-EXIT
  9905           end-if
  9906        end-perform
  9907     end-if
  9908     IF CL-AUTO-PAY-SEQ NOT = ZEROS
  9909         IF PI-PMTTYPE = '5' OR '6'
  9910             NEXT SENTENCE
  9911         ELSE
  9912             MOVE ER-0555             TO EMI-ERROR
  9913             MOVE -1                  TO PMTTYPEL
  9914             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9915
  9916     IF CL-LAST-CLOSE-REASON = '2'
  9917         IF CL-CLAIM-STATUS = 'C'
  9918             MOVE ER-0760        TO  EMI-ERROR
  9919             MOVE -1             TO  PMTTYPEL
  9920             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 186
* EL156.cbl
  9921
  9922     IF PI-ACTIVITY-CODE = 9
  9923         MOVE ER-3538            TO  EMI-ERROR
  9924         MOVE -1                 TO  PMTTYPEL
  9925         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9926
  9927     IF PI-COMPANY-ID NOT = 'AIG' AND 'AUK'
  9928         GO TO 1008-READ-CERT.
  9929**********************AIG LOGIC STARTS *********************
  9930     IF CL-CERT-PRIME = 'INCOMPLETE'
  9931         MOVE ER-3540            TO  EMI-ERROR
  9932         MOVE -1                 TO  PMTTYPEL
  9933         MOVE AL-UABON           TO  PMTTYPEA
  9934         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9935         GO TO 2000-EDIT-DONE.
  9936
  9937     IF PI-PMTTYPE = '4'
  9938         IF PI-EPYAMT IS NEGATIVE
  9939             IF PI-ECHECKNO-CR = 'CR'
  9940                 NEXT SENTENCE
  9941             ELSE
  9942                 MOVE 'CR'       TO  PI-ECHECKNO-CR.
  9943
  9944     IF PI-PMTTYPE = '4'
  9945         IF PI-ECHECKNO-CR = 'CR'
  9946             IF PI-EPYAMT IS NEGATIVE
  9947                 NEXT SENTENCE
  9948             ELSE
  9949                 MOVE ER-0834    TO  EMI-ERROR
  9950                 MOVE -1         TO  EPYAMTL
  9951                 MOVE AL-UNBON   TO  EPYAMTA
  9952                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9953
  9954     IF PI-PMTTYPE = '4'
  9955         IF PI-EPYAMT IS NEGATIVE
  9956             IF PI-OFFLINE = 'Y'
  9957                 NEXT SENTENCE
  9958             ELSE
  9959                 MOVE 'Y'        TO  PI-OFFLINE
  9960                                     WS-OFFLINE
  9961                                     OFFLINEO
  9962                 MOVE AL-UANON   TO  OFFLINEA.
  9963
  9964*    IF PI-PMTTYPE = '4'
  9965*        IF PI-EPYAMT IS NEGATIVE
  9966*            IF PI-CASH = 'Y'
  9967*                NEXT SENTENCE
  9968*            ELSE
  9969*                MOVE 'Y'        TO  CASHI PI-CASH WS-CASH
  9970*                MOVE AL-UANON   TO  CASHA
  9971*                GO TO 1007-DEFAULT-AIG-CHECKNO.
  9972*
  9973*    IF PI-CASH NOT = 'Y' AND 'N'
  9974*         IF PI-OFFLINE = 'Y'  AND
  9975*            PI-ECHECKNO-CR = 'CR'
  9976*              MOVE 'Y'          TO  CASHI PI-CASH WS-CASH
  9977*              MOVE AL-UANON     TO  CASHA
  9978*              GO TO 1007-DEFAULT-AIG-CHECKNO.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 187
* EL156.cbl
  9979*
  9980*    IF PI-CASH NOT = 'Y' AND 'N'
  9981*        IF PI-PMTTYPE = '5' OR '6'
  9982*            MOVE 'Y'            TO  CASHI PI-CASH WS-CASH
  9983*            MOVE AL-UANON       TO  CASHA
  9984*            GO TO 1007-DEFAULT-AIG-CHECKNO.
  9985*
  9986*    IF PI-CASH NOT = 'Y' AND 'N'
  9987*       IF CL-ASSOCIATES = 'N' OR 'A'
  9988*           MOVE 'Y'             TO  CASHI PI-CASH WS-CASH
  9989*           MOVE AL-UANON        TO  CASHA
  9990*       ELSE
  9991*           MOVE 'N'             TO  CASHI PI-CASH WS-CASH
  9992*           MOVE AL-UANON        TO  CASHA.
  9993*
  9994*    IF PI-PMTTYPE = '5' OR '6'
  9995*        IF PI-CASH = 'N'
  9996*            MOVE ER-0819        TO  EMI-ERROR
  9997*            MOVE AL-UANON       TO  CASHA
  9998*            MOVE -1             TO  CASHL
  9999*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10000*
 10001*    IF CL-ASSOCIATES = 'N' OR 'A'
 10002*       IF CASHI = 'N'
 10003*        MOVE ER-3537            TO  EMI-ERROR
 10004*        MOVE AL-UANON           TO  CASHA
 10005*        MOVE -1                 TO  CASHL
 10006*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10007
 10008 1007-DEFAULT-AIG-CHECKNO.
 10009
 10010     IF CL-CAUSE-CD = SPACES OR LOW-VALUES
 10011         MOVE ER-3532            TO  EMI-ERROR
 10012         MOVE -1                 TO  PMTTYPEL
 10013         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10014**********************AIG LOGIC ENDS ***********************
 10015
 10016 1008-READ-CERT.
 10017
 10018     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
 10019     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
 10020     MOVE CL-CERT-GROUPING       TO CERT-GROUPING.
 10021     MOVE CL-CERT-STATE          TO CERT-STATE.
 10022     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
 10023     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
 10024     MOVE CL-CERT-NO             TO CERT-CERT-NO.
 10025     MOVE 'CERT'                 TO FILE-SWITCH.
 10026
 10027     PERFORM 7970-READ-CERT THRU 7970-EXIT.
 10028
 10029     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 10030        MOVE CM-LF-LOAN-EXPIRE-DT
 10031                                 TO WS-EXP-DT PI-EXP-DT
 10032                                    ws-extended-exp-dt
 10033     ELSE
 10034        MOVE CM-AH-LOAN-EXPIRE-DT
 10035                                 TO WS-EXP-DT PI-EXP-DT
 10036                                    ws-extended-exp-dt
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 188
* EL156.cbl
 10037     end-if
 10038     MOVE '6'           TO DC-OPTION-CODE
 10039     if pi-dcc-product-code not = spaces
 10040        move cm-ah-benefit-cd    to pi-ah-benefit-cd
 10041        move cm-lf-benefit-cd    to pi-lf-benefit-cd
 10042        PERFORM 0900-GET-DDF-limits
 10043                                 THRU 0900-EXIT
 10044        IF PDEF-FOUND
 10045         AND CL-CLAIM-TYPE NOT = PI-LIFE-OVERRIDE-L1
 10046           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 10047              (P1 > +8)
 10048              OR (PD-PROD-CODE (P1) = CL-CLAIM-TYPE)
 10049           END-PERFORM
 10050           IF P1 < +9
 10051              MOVE '6'           TO DC-OPTION-CODE
 10052              MOVE WS-EXP-DT     TO DC-BIN-DATE-1
 10053              IF CL-NO-OF-EXTENSIONS NUMERIC
 10054               display ' 156 - no of ext ' CL-NO-OF-EXTENSIONS
 10055                 MOVE CL-NO-OF-EXTENSIONS TO DC-ELAPSED-MONTHS
 10056                                             PI-MAX-EXT
 10057              ELSE
 10058                 MOVE PD-MAX-EXTENSION (P1)
 10059                                 TO DC-ELAPSED-MONTHS
 10060              END-IF
 10061              PERFORM 9700-LINK-DATE-CONVERT
 10062                                 THRU 9700-EXIT
 10063              if no-conversion-error
 10064                 move dc-bin-date-2 to ws-extended-exp-dt
 10065              end-if
 10066           else
 10067              move er-1674       to emi-error
 10068              PERFORM 9900-ERROR-FORMAT
 10069                                 THRU 9900-EXIT
 10070           end-if
 10071        ELSE
 10072           IF CL-NO-OF-EXTENSIONS NUMERIC
 10073              MOVE CL-NO-OF-EXTENSIONS TO DC-ELAPSED-MONTHS
 10074                                          PI-MAX-EXT
 10075           ELSE
 10076              MOVE ZERO  TO DC-ELAPSED-MONTHS
 10077           END-IF
 10078           MOVE WS-EXP-DT     TO DC-BIN-DATE-1
 10079           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10080           if no-conversion-error
 10081              move dc-bin-date-2 to ws-extended-exp-dt
 10082           end-if
 10083        end-if
 10084     ELSE
 10085        IF CL-NO-OF-EXTENSIONS NUMERIC
 10086           MOVE CL-NO-OF-EXTENSIONS TO DC-ELAPSED-MONTHS
 10087                                       PI-MAX-EXT
 10088        ELSE
 10089           MOVE ZERO  TO DC-ELAPSED-MONTHS
 10090        END-IF
 10091        MOVE WS-EXP-DT     TO DC-BIN-DATE-1
 10092        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10093        if no-conversion-error
 10094           move dc-bin-date-2 to ws-extended-exp-dt
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 189
* EL156.cbl
 10095        end-if
 10096     end-if
 10097*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10098*        PERFORM 3400-COMPUTE-EXPIRY THRU 3499-EXIT.
 10099
 10100     IF CL-INCURRED-DT < CM-CERT-EFF-DT
 10101         MOVE ER-0458            TO EMI-ERROR
 10102         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
 10103
 10104     IF (CL-INCURRED-DT > WS-EXP-DT)
 10105        AND (CL-INCURRED-DT < WS-EXTENDED-EXP-DT)
 10106        MOVE ER-1677             TO EMI-ERROR
 10107        PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT
 10108     END-IF
 10109     move ws-extended-exp-dt     to ws-exp-dt pi-exp-dt
 10110     IF CL-INCURRED-DT NOT < WS-EXTENDED-EXP-DT
 10111         MOVE ER-0459            TO EMI-ERROR
 10112         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
 10113
 10114     IF CL-REPORTED-DT = LOW-VALUES
 10115        MOVE ER-0530             TO EMI-ERROR
 10116        PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
 10117
 10118     IF PI-COMPANY-ID = 'NCL'
 10119        IF CM-CREDIT-INTERFACE-SW-1 = '2'
 10120            MOVE ER-0770            TO EMI-ERROR
 10121            PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
 10122
 10123     IF PI-COMPANY-ID = 'NCL'
 10124        IF (CM-SING-PRM AND CERT-WAS-CREATED-FOR-CLAIM)
 10125            MOVE ER-0737            TO EMI-ERROR
 10126            PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
 10127
 10128     IF CM-ENTRY-STATUS = 'D' OR 'V'
 10129         MOVE ER-0768            TO  EMI-ERROR
 10130         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
 10131
 10132     IF CM-CREDIT-INTERFACE-SW-1 = '4'
 10133         MOVE ER-0769            TO  EMI-ERROR
 10134         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
 10135
 10136     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 10137         GO TO 1020-DO-LIFE-EDITS
 10138     ELSE
 10139         GO TO 1030-DO-AH-EDITS.
 10140
 10141 1010-GENERAL-ERROR.
 10142     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10143
 10144     IF EMI-MESSAGE-FORMATTED
 10145         MOVE -1                 TO PMTTYPEL.
 10146
 10147 1010-EXIT.
 10148     EXIT.
 10149
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 190
* EL156.cbl
 10151 1020-DO-LIFE-EDITS.
 10152     IF CM-LF-BENEFIT-CD = '00'
 10153         IF PI-PMTTYPE = '5' OR '6'
 10154             MOVE ER-0658        TO EMI-ERROR
 10155             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10156         ELSE
 10157            if (pi-company-id = 'DCC' or 'VPP')
 10158               and (pi-dcc-product-code not = spaces)
 10159               continue
 10160            else
 10161               MOVE ER-1775      TO EMI-ERROR
 10162               PERFORM 1040-PMTTYPE-ERROR
 10163                                 THRU 1040-EXIT
 10164            end-if
 10165         end-if
 10166     end-if
 10167
 10168     move cm-ah-benefit-cd to pi-ah-benefit-cd
 10169     IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
 10170         MOVE ER-0460            TO EMI-ERROR
 10171         PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10172
 10173     MOVE CM-LF-BENEFIT-CD      TO PI-LF-BENEFIT-CD.
 10174     MOVE CM-LF-BENEFIT-CD       TO  WS-BEN-CD.
 10175     MOVE WS-ACCESS              TO  CNTL-ACCESS.
 10176     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
 10177     MOVE '4'                    TO  CNTL-REC-TYPE.
 10178     MOVE ZEROS                  TO  CNTL-SEQ-NO.
 10179     MOVE 'BENE'                 TO  FILE-SWITCH.
 10180     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 10181     IF NO-BENEFIT-FOUND
 10182         GO TO 1950-NOT-FOUND.
 10183
 10184     MOVE CF-LF-COVERAGE-TYPE (SUB-1)   TO  PI-LF-COVERAGE-TYPE.
 10185
 10186     IF CM-LF-DEATH-EXIT-DT = LOW-VALUES
 10187         IF PI-PMTTYPE = '4'
 10188             IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 10189                PI-LF-COVERAGE-TYPE = 'P'
 10190                 NEXT SENTENCE
 10191             ELSE
 10192                 MOVE ER-0461        TO EMI-ERROR
 10193                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10194         ELSE
 10195            NEXT SENTENCE
 10196     ELSE
 10197         IF PI-PMTTYPE = '2'
 10198            IF NOT CM-O-B-COVERAGE
 10199              AND CM-LF-CURRENT-STATUS = '7'
 10200                MOVE ER-0462     TO EMI-ERROR
 10201                PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10202
 10203     IF PI-PMTTYPE = '2'
 10204         IF (CM-LF-CANCEL-DT      NOT = LOW-VALUES AND SPACES) OR
 10205            (CM-LF-CANCEL-EXIT-DT NOT = LOW-VALUES AND SPACES)
 10206             MOVE CM-LF-ITD-CANCEL-AMT  TO  WS-REFUND-AMT
 10207             MOVE ER-0730            TO  EMI-ERROR
 10208             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 191
* EL156.cbl
 10209             MOVE WS-REFUND-AMT      TO  EMI-TEXT-VARIABLE (1).
 10210
 10211     IF PI-PMTTYPE = '2'
 10212         IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 10213            PI-LF-COVERAGE-TYPE = 'P'
 10214             IF CL-PAID-THRU-DT = CL-INCURRED-DT
 10215                 MOVE ER-0462    TO  EMI-ERROR
 10216                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10217
 10218     IF CM-LF-CANCEL-DT NOT = LOW-VALUES
 10219       AND CL-INCURRED-DT > CM-LF-CANCEL-DT
 10220         MOVE ER-0466            TO EMI-ERROR
 10221         PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10222
 10223     IF PI-COMPANY-ID = 'FLI' OR 'FLU'
 10224         IF PI-PMTTYPE = '3'
 10225             MOVE 0436           TO EMI-ERROR
 10226             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10227             GO TO 1045-EDIT-PAYEE-ADDR
 10228         ELSE
 10229             GO TO 1045-EDIT-PAYEE-ADDR.
 10230
 10231     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 10232        PI-LF-COVERAGE-TYPE = 'P'
 10233         IF PI-PMTTYPE = '3'
 10234             MOVE ER-0436          TO  EMI-ERROR
 10235             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10236         ELSE
 10237             NEXT SENTENCE
 10238     ELSE
 10239         IF PI-PMTTYPE = '1' OR '3'
 10240             MOVE ER-0436            TO EMI-ERROR
 10241             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10242*
 10243     IF PI-COMPANY-ID = 'CID' AND
 10244        CL-CERT-STATE = 'SC'  AND
 10245        (CM-LF-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
 10246           MOVE ER-0879    TO  EMI-ERROR
 10247           PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10248           move 'NET PAY + 6'    TO EMI-ERROR-TEXT (1) (18:11)
 10249     END-IF.
 10250     IF PI-COMPANY-ID = 'AHL'
 10251        evaluate true
 10252           when CM-LF-BENEFIT-CD = '5I' OR '6J'
 10253              MOVE ER-0879       TO  EMI-ERROR
 10254              PERFORM 1040-PMTTYPE-ERROR
 10255                                 THRU 1040-EXIT
 10256              move 'NET PAY + 6' TO EMI-ERROR-TEXT (1) (18:11)
 10257           when CM-LF-BENEFIT-CD = '5G' OR '5J' OR '5S' OR
 10258                 '6D' OR '6H' OR '6R'
 10259              MOVE ER-0879       TO  EMI-ERROR
 10260              PERFORM 1040-PMTTYPE-ERROR
 10261                                 THRU 1040-EXIT
 10262              move 'NET PAY + 2' TO EMI-ERROR-TEXT (1) (18:11)
 10263           when CM-LF-BENEFIT-CD = '5M' OR '6M'
 10264              MOVE ER-0879       TO  EMI-ERROR
 10265              PERFORM 1040-PMTTYPE-ERROR
 10266                                 THRU 1040-EXIT
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 192
* EL156.cbl
 10267              move 'NET PAY + 1' TO EMI-ERROR-TEXT (1) (18:11)
 10268        end-evaluate
 10269     END-IF
 10270     GO TO 1045-EDIT-PAYEE-ADDR.
 10271
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 193
* EL156.cbl
 10273 1030-DO-AH-EDITS.
 10274     MOVE CM-AH-BENEFIT-CD       TO PI-AH-BENEFIT-CD
 10275     IF CM-AH-BENEFIT-CD = '00'
 10276         IF PI-PMTTYPE = '5' OR '6'
 10277             MOVE ER-0658        TO EMI-ERROR
 10278             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10279         ELSE
 10280             MOVE ER-1775        TO EMI-ERROR
 10281             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10282
 10283     IF CL-TOTAL-PAID-AMT = ZEROS
 10284         IF PI-PMTTYPE = '4'
 10285             MOVE ER-0438        TO EMI-ERROR
 10286             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10287
 10288     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
 10289         IF PI-PMTTYPE = '3'
 10290             MOVE ER-0463        TO EMI-ERROR
 10291             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10292         ELSE
 10293             IF (CL-INCURRED-DT NOT < CM-LF-DEATH-EXIT-DT)
 10294              AND CM-LF-CURRENT-STATUS = '7'
 10295                 MOVE ER-0465    TO EMI-ERROR
 10296                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10297
 10298     IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
 10299         IF PI-PMTTYPE = '3'
 10300             MOVE ER-0464        TO EMI-ERROR
 10301             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10302         ELSE
 10303             IF CL-INCURRED-DT > CM-AH-SETTLEMENT-DT
 10304                 MOVE ER-0469    TO EMI-ERROR
 10305                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10306
 10307     IF CM-AH-CANCEL-DT NOT = LOW-VALUES
 10308         IF PI-PMTTYPE = '3'
 10309             IF CL-INCURRED-DT NOT = CM-AH-CANCEL-DT
 10310                 MOVE ER-0467    TO EMI-ERROR
 10311                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10312             ELSE
 10313                 NEXT SENTENCE
 10314         ELSE
 10315             IF CL-INCURRED-DT NOT < CM-AH-CANCEL-DT
 10316                 MOVE ER-0468    TO EMI-ERROR
 10317                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10318
 10319     GO TO 1045-EDIT-PAYEE-ADDR.
 10320
 10321 1040-PMTTYPE-ERROR.
 10322     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10323
 10324     IF EMI-MESSAGE-FORMATTED
 10325         MOVE -1                 TO PMTTYPEL
 10326         MOVE AL-UABON           TO PMTTYPEA.
 10327
 10328 1040-EXIT.
 10329     EXIT.
 10330
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 194
* EL156.cbl
 10332 1045-EDIT-PAYEE-ADDR.
 10333
 10334     IF PI-OFFLINE = 'N' AND
 10335        ((PI-PAYEE-TYPE = 'A' AND CL-ACCOUNT-ADDR-CNT
 10336           < PI-PAYEE-SEQ-NUM)
 10337        OR
 10338         (PI-COMPANY-ID NOT = 'AIG' AND 'AUK') AND
 10339         (PI-PAYEE-TYPE = 'B')                 AND
 10340         (CL-BENIF-ADDR-CNT < PI-PAYEE-SEQ-NUM)
 10341        OR
 10342         (PI-PAYEE-TYPE = 'I' AND CL-INSURED-ADDR-CNT
 10343           < PI-PAYEE-SEQ-NUM)
 10344        OR
 10345         (PI-PAYEE-TYPE = 'O' AND CL-OTHER-1-ADDR-CNT
 10346           < PI-PAYEE-SEQ-NUM)
 10347        OR
 10348         (PI-PAYEE-TYPE = 'Q' AND CL-OTHER-2-ADDR-CNT
 10349           < PI-PAYEE-SEQ-NUM)
 10350        OR
 10351         (PI-PAYEE-TYPE = 'P' AND CL-DOCTOR-ADDR-CNT
 10352           < PI-PAYEE-SEQ-NUM)
 10353        OR
 10354         (PI-PAYEE-TYPE = 'E' AND CL-EMPLOYER-ADDR-CNT
 10355           < PI-PAYEE-SEQ-NUM))
 10356             MOVE ER-0437        TO EMI-ERROR
 10357             MOVE -1             TO PAYEEL
 10358             MOVE AL-UABON       TO PAYEEA
 10359             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10360
 10361     IF PI-OFFLINE    = 'N' AND
 10362        PI-PAYEE-TYPE = 'B' AND
 10363        PI-PAYEE-SEQ  = '0'
 10364         PERFORM 7920-READ-BENE THRU 7920-EXIT
 10365         IF BENE-FOUND-SW = 'N'
 10366             MOVE ER-0437        TO EMI-ERROR
 10367             MOVE -1             TO PAYEEL
 10368             MOVE AL-UABON       TO PAYEEA
 10369             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10370
 10371     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10372        IF PI-OFFLINE    = 'N'  AND
 10373           PI-PAYEE-TYPE = 'B'  AND
 10374           PI-PAYEE-SEQ  = '9'
 10375             PERFORM 7920-READ-BENE THRU 7920-EXIT
 10376             IF BENE-FOUND-SW = 'N'
 10377                MOVE ER-0437        TO EMI-ERROR
 10378                MOVE -1             TO PAYEEL
 10379                MOVE AL-UABON       TO PAYEEA
 10380                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10381
 10382*    IF PI-COMPANY-ID = 'CRI'
 10383*        IF CL-CLAIM-TYPE = 'L'
 10384*            MOVE 'N'                TO  WS-GROUPED
 10385*                                        PI-GROUPED
 10386*                                        GROUPEDI
 10387*            MOVE AL-UANON           TO  GROUPEDA
 10388*            GO TO 1050-EDIT-CHECK-NO
 10389*        ELSE
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 195
* EL156.cbl
 10390*            MOVE CL-CERT-GROUPING   TO  WS-GROUPING
 10391*            IF WS-GROUP-1 = 'C'
 10392*                NEXT SENTENCE
 10393*            ELSE
 10394*                MOVE 'N'            TO  WS-GROUPED
 10395*                                        PI-GROUPED
 10396*                                        GROUPEDI
 10397*                MOVE AL-UANON       TO  GROUPEDA
 10398*                GO TO 1050-EDIT-CHECK-NO.
 10399
 10400*     IF PI-GROUPED = 'Y'
 10401*        IF PI-PAYEE-TYPE = 'B' OR 'A'
 10402*           NEXT SENTENCE
 10403*        ELSE
 10404*           MOVE ER-0437        TO EMI-ERROR
 10405*           MOVE -1             TO PAYEEL
 10406**02180            MOVE AL-UABON       TO PAYEEA
 10407*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10408*
 10409*     IF (PI-PAYEE-TYPE = 'B' OR 'A') AND
 10410*        (PI-GROUPED    = ' ')
 10411*        NEXT SENTENCE
 10412*     ELSE
 10413*
 10414     GO TO 1050-EDIT-CHECK-NO.
 10415*     IF PI-COMPANY-ID = 'CRI'
 10416*        MOVE 'N'           TO GROUPEDI
 10417*                              PI-GROUPED
 10418*                              WS-GROUPED
 10419*        MOVE AL-UANON      TO GROUPEDA.
 10420*
 10421*     IF PI-COMPANY-ID = 'CRI'
 10422*        IF PI-PAYEE-TYPE = 'B'
 10423*           IF BENE-FOUND-SW = 'Y'
 10424*              IF BE-GROUP-CHECKS-Y-N = 'Y'
 10425*                 MOVE 'Y'           TO GROUPEDI
 10426*                                       PI-GROUPED
 10427*                                       WS-GROUPED
 10428*                 MOVE AL-UANON      TO GROUPEDA
 10429*              ELSE
 10430*                 NEXT SENTENCE
 10431*           ELSE
 10432*              PERFORM 7920-READ-BENE THRU 7920-EXIT
 10433*              IF BENE-FOUND-SW = 'Y'
 10434*                 IF BE-GROUP-CHECKS-Y-N = 'Y'
 10435*                    MOVE 'Y'      TO GROUPEDI
 10436*                                     PI-GROUPED
 10437*                                     WS-GROUPED
 10438*                    MOVE AL-UANON TO GROUPEDA.
 10439*
 10440
 10441     IF PI-COMPANY-ID NOT = 'CRI'
 10442        GO TO 1050-EDIT-CHECK-NO.
 10443
 10444*************** CRI CODE START ******************
 10445     IF PI-PAYEE-TYPE NOT = 'A'
 10446        GO TO 1050-EDIT-CHECK-NO.
 10447
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 196
* EL156.cbl
 10448     MOVE LOW-VALUES             TO ERACCT-KEY.
 10449     MOVE PI-COMPANY-CD          TO ACCT-COMP-CD.
 10450     MOVE PI-CARRIER             TO ACCT-CARRIER.
 10451     MOVE PI-GROUPING            TO ACCT-GROUPING.
 10452     MOVE PI-STATE               TO ACCT-STATE.
 10453     MOVE PI-ACCOUNT             TO ACCT-ACCOUNT.
 10454     MOVE PI-CERT-EFF-DT         TO ACCT-EXP-DT.
 10455     MOVE 'ACCT'                 TO FILE-SWITCH.
 10456
 10457     MOVE ERACCT-PARTIAL-KEY     TO WS-ERACCT-SAVE-KEY.
 10458     MOVE SPACES                 TO WS-ERACCT-HOLD-RECORD.
 10459
 10460
 10461* EXEC CICS HANDLE CONDITION
 10462*         NOTFND   (1950-NOT-FOUND)
 10463*         ENDFILE  (1950-NOT-FOUND)
 10464*    END-EXEC.
 10465*    MOVE '"$I''                  ! ( #00010089' TO DFHEIV0
 10466     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 10467     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10468     MOVE X'2820233030303130303839' TO DFHEIV0(25:11)
 10469     CALL 'kxdfhei1' USING DFHEIV0
 10470     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10471
 10472
 10473
 10474* EXEC CICS STARTBR
 10475*         DATASET   ('ERACCT')
 10476*         RIDFLD    (ERACCT-KEY)
 10477*         GTEQ
 10478*    END-EXEC.
 10479     MOVE 'ERACCT' TO DFHEIV1
 10480     MOVE 0
 10481       TO DFHEIV11
 10482*    MOVE '&,         G          &   #00010094' TO DFHEIV0
 10483     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 10484     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10485     MOVE X'2020233030303130303934' TO DFHEIV0(25:11)
 10486     CALL 'kxdfhei1' USING DFHEIV0,
 10487           DFHEIV1,
 10488           ERACCT-KEY,
 10489           DFHEIV99,
 10490           DFHEIV11,
 10491           DFHEIV99
 10492     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10493
 10494
 10495 1046-READNEXT-ERACCT.
 10496
 10497
 10498* EXEC CICS READNEXT
 10499*         DATASET   ('ERACCT')
 10500*         RIDFLD    (ERACCT-KEY)
 10501*         SET       (ADDRESS OF ACCOUNT-MASTER)
 10502*    END-EXEC.
 10503     MOVE 'ERACCT' TO DFHEIV1
 10504     MOVE 0
 10505       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 197
* EL156.cbl
 10506*    MOVE '&.S                   )   #00010102' TO DFHEIV0
 10507     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 10508     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 10509     MOVE X'2020233030303130313032' TO DFHEIV0(25:11)
 10510     CALL 'kxdfhei1' USING DFHEIV0,
 10511           DFHEIV1,
 10512           DFHEIV20,
 10513           DFHEIV99,
 10514           ERACCT-KEY,
 10515           DFHEIV99,
 10516           DFHEIV11,
 10517           DFHEIV99,
 10518           DFHEIV99
 10519     SET ADDRESS OF ACCOUNT-MASTER TO
 10520         DFHEIV20
 10521     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10522
 10523
 10524     IF WS-ERACCT-SAVE-KEY NOT = ERACCT-PARTIAL-KEY
 10525        IF WS-ERACCT-HOLD-RECORD = SPACES
 10526           GO TO 1950-NOT-FOUND
 10527        ELSE
 10528           MOVE WS-ERACCT-HOLD-RECORD TO ACCOUNT-MASTER
 10529           GO TO 1048-CONTINUE.
 10530
 10531     IF ACCT-EXP-DT = HIGH-VALUES
 10532        NEXT SENTENCE
 10533     ELSE
 10534        MOVE ACCOUNT-MASTER TO WS-ERACCT-HOLD-RECORD
 10535        GO TO 1046-READNEXT-ERACCT.
 10536
 10537 1048-CONTINUE.
 10538
 10539*    IF AM-GROUPED-CHECKS-Y-N = 'Y'
 10540*       MOVE 'Y'                 TO GROUPEDI
 10541*                                   PI-GROUPED
 10542*                                   WS-GROUPED
 10543*       MOVE AL-UANON            TO GROUPEDA.
 10544*************** CRI CODE END ******************
 10545
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 198
* EL156.cbl
 10547 1050-EDIT-CHECK-NO.
 10548
 10549     IF PI-OFFLINE = 'Y'
 10550         IF PI-ECHECKNO = SPACES
 10551              MOVE ER-0439        TO EMI-ERROR
 10552              GO TO 1090-CHECK-NO-ERROR
 10553           ELSE
 10554*        IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10555*           IF PI-ECHECKNO-N = 'N' AND
 10556*              PI-CASH       = 'Y'
 10557*                MOVE ER-3535        TO EMI-ERROR
 10558*                GO TO 1090-CHECK-NO-ERROR
 10559*             ELSE
 10560*                MOVE AL-UANON    TO CHECKNOA
 10561*                GO TO 1100-EDIT-HOLDTIL
 10562*         ELSE
 10563            MOVE AL-UANON    TO CHECKNOA
 10564            GO TO 1100-EDIT-HOLDTIL.
 10565
 10566     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10567     MOVE '6'                    TO CNTL-REC-TYPE.
 10568
 10569     IF CONTROL-IS-ACTUAL-CARRIER
 10570         MOVE PI-CARRIER         TO WS-CARR
 10571     ELSE
 10572         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 10573
 10574     IF PI-COMPANY-ID = 'FIA'
 10575         MOVE PI-CARRIER         TO WS-CARR.
 10576
 10577     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 10578     MOVE 0                      TO CNTL-SEQ-NO.
 10579     MOVE 'CARR'                 TO FILE-SWITCH.
 10580
 10581     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 10582
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 199
* EL156.cbl
 10584     IF PI-COMPANY-ID NOT = 'AIG' AND 'AUK'
 10585         GO TO 1051-EDIT-CHECKNO-CONT.
 10586
 10587**********************AIG LOGIC STARTS**********************
 10588     IF PI-ECHECKNO = SPACES
 10589         IF CHECK-NO-MANUAL
 10590             MOVE ER-0441        TO EMI-ERROR
 10591             GO TO 1090-CHECK-NO-ERROR
 10592         ELSE
 10593             MOVE AL-UANOF       TO CHECKNOA
 10594             GO TO 1100-EDIT-HOLDTIL.
 10595
 10596     IF PI-ECHECKNO NOT = SPACES
 10597         IF CHECK-NO-MANUAL
 10598             MOVE AL-UANON       TO CHECKNOA
 10599             GO TO 1100-EDIT-HOLDTIL.
 10600
 10601     IF PI-ECHECKNO-CR = 'CR'
 10602        IF PI-OFFLINE = 'Y'
 10603            MOVE AL-UANON       TO CHECKNOA
 10604            GO TO 1100-EDIT-HOLDTIL
 10605        ELSE
 10606            MOVE ER-3534        TO EMI-ERROR
 10607            GO TO 1090-CHECK-NO-ERROR.
 10608
 10609     IF PI-ECHECKNO-N = 'N'
 10610        IF PI-CASH = 'N'
 10611            MOVE AL-UANON       TO CHECKNOA
 10612            GO TO 1100-EDIT-HOLDTIL
 10613        ELSE
 10614            MOVE ER-3535          TO EMI-ERROR
 10615            GO TO 1090-CHECK-NO-ERROR.
 10616
 10617     MOVE ER-0442        TO EMI-ERROR
 10618     GO TO 1090-CHECK-NO-ERROR.
 10619**********************AIG LOGIC ENDS************************
 10620
 10621 1051-EDIT-CHECKNO-CONT.
 10622
 10623     IF PI-COMPANY-ID = 'DMD'
 10624        IF PI-ECHECKNO NOT = SPACES
 10625           IF PI-ECHECKNO (6:2) NOT = 'TP'
 10626              MOVE ER-0442        TO EMI-ERROR
 10627              GO TO 1090-CHECK-NO-ERROR
 10628            ELSE
 10629              GO TO 1100-EDIT-HOLDTIL
 10630          ELSE
 10631           GO TO 1100-EDIT-HOLDTIL.
 10632
 10633     IF PI-ECHECKNO = SPACES
 10634         IF CHECK-NO-MANUAL
 10635             MOVE ER-0441        TO EMI-ERROR
 10636             GO TO 1090-CHECK-NO-ERROR
 10637         ELSE
 10638             MOVE AL-UANOF       TO CHECKNOA
 10639             GO TO 1100-EDIT-HOLDTIL
 10640     ELSE
 10641         IF CHECK-NO-MANUAL
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 200
* EL156.cbl
 10642             MOVE AL-UANON       TO CHECKNOA
 10643             GO TO 1100-EDIT-HOLDTIL
 10644         ELSE
 10645             MOVE ER-0442        TO EMI-ERROR
 10646             GO TO 1090-CHECK-NO-ERROR.
 10647
 10648 1090-CHECK-NO-ERROR.
 10649     MOVE -1                     TO CHECKNOL.
 10650     MOVE AL-UABON               TO CHECKNOA.
 10651     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10652
 10653     GO TO 2000-EDIT-DONE.
 10654
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 201
* EL156.cbl
 10656 1100-EDIT-HOLDTIL.
 10657     MOVE AL-UANON               TO HOLDTILA.
 10658
 10659     IF PI-HOLDTIL = ZEROS
 10660        IF PI-OFFLINE = 'Y'
 10661           MOVE ER-0572          TO EMI-ERROR
 10662           GO TO 1105-HOLDTIL-ERROR
 10663        ELSE
 10664           GO TO 1110-EDIT-PAID-FROM.
 10665
 10666     MOVE '4'                    TO DC-OPTION-CODE.
 10667     MOVE PI-HOLDTIL             TO DC-GREG-DATE-1-MDY.
 10668     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10669
 10670     IF DATE-CONVERSION-ERROR
 10671         MOVE ER-0446            TO EMI-ERROR
 10672         GO TO 1105-HOLDTIL-ERROR
 10673     END-IF
 10674     IF PI-OFFLINE = 'Y'
 10675        IF DC-BIN-DATE-1 < SAVE-BIN-DATE
 10676           MOVE ER-0446            TO EMI-ERROR
 10677           GO TO 1105-HOLDTIL-ERROR
 10678        END-IF
 10679     END-IF
 10680
 10681     IF PI-OFFLINE = 'Y'
 10682        GO TO 1110-EDIT-PAID-FROM.
 10683
 10684     MOVE DC-BIN-DATE-1          TO DC-BIN-DATE-2.
 10685     MOVE WS-TODAY-DATE          TO DC-BIN-DATE-1.
 10686     MOVE '1'                    TO DC-OPTION-CODE.
 10687     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10688
 10689*    IF DC-ELAPSED-DAYS > 30 OR DATE-CONVERSION-ERROR
 10690     IF DC-ELAPSED-DAYS > 60 OR DATE-CONVERSION-ERROR
 10691         MOVE ER-0447            TO EMI-ERROR
 10692         GO TO 1105-HOLDTIL-ERROR.
 10693
 10694     GO TO 1110-EDIT-PAID-FROM.
 10695
 10696 1105-HOLDTIL-ERROR.
 10697     MOVE -1                     TO HOLDTILL.
 10698     MOVE AL-UNBON               TO HOLDTILA.
 10699     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10700
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 202
* EL156.cbl
 10702 1110-EDIT-PAID-FROM.
 10703     MOVE AL-UANON               TO EPYFROMA.
 10704
 10705     IF PI-EPYFROM = ZEROS
 10706         GO TO 1120-CALCULATE-PAID-FROM.
 10707
 10708     IF PI-PMTTYPE = '5' OR '6'
 10709         MOVE ER-0448            TO EMI-ERROR
 10710         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10711         MOVE AL-UNBON           TO EPYFROMA
 10712         MOVE -1                 TO EPYFROML
 10713         GO TO 1150-EDIT-PAID-THRU.
 10714
 10715     MOVE '4'                    TO DC-OPTION-CODE.
 10716     MOVE PI-EPYFROM             TO DC-GREG-DATE-1-MDY.
 10717     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10718
 10719     IF DATE-CONVERSION-ERROR
 10720         MOVE ER-0449            TO EMI-ERROR
 10721         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10722         MOVE AL-UNBON           TO EPYFROMA
 10723         MOVE -1                 TO EPYFROML
 10724     ELSE
 10725         MOVE DC-BIN-DATE-1      TO WS-SV-EPYFROM.
 10726
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 203
* EL156.cbl
 10728 1120-CALCULATE-PAID-FROM.
 10729     IF PI-PMTTYPE = '5' OR '6'
 10730         GO TO 1150-EDIT-PAID-THRU.
 10731
 10732*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10733*       IF PI-PMTTYPE = '4'
 10734*         GO TO 1150-EDIT-PAID-THRU.
 10735
 10736     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 10737         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 10738         MOVE ' '                TO DC-OPTION-CODE
 10739         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10740         MOVE DC-BIN-DATE-1      TO PI-CPYFROM
 10741         GO TO 1145-TEST-PAID-FROM.
 10742
 10743     IF PI-PMTTYPE = '4'
 10744        GO TO 1150-EDIT-PAID-THRU.
 10745
 10746     MOVE CM-AH-BENEFIT-CD       TO WS-BEN-CD.
 10747     MOVE WS-ACCESS              TO CNTL-ACCESS.
 10748     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10749     MOVE '5'                    TO CNTL-REC-TYPE.
 10750     MOVE ZEROS                  TO CNTL-SEQ-NO.
 10751     MOVE 'BENE'                 TO FILE-SWITCH.
 10752
 10753     IF WS-BEN-CD = ZEROS
 10754         GO TO 1950-NOT-FOUND.
 10755
 10756     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 10757
 10758     IF NO-BENEFIT-FOUND
 10759         GO TO 1950-NOT-FOUND.
 10760
 10761     MOVE CF-BENEFIT-ALPHA   (SUB-1) TO PI-BENEFIT-SAVE.
 10762     MOVE CF-SPECIAL-CALC-CD (SUB-1) TO WS-SPECIAL-CALC-CD.
 10763
 10764     IF PI-BEN-DAYS NOT NUMERIC
 10765        MOVE ZEROS               TO PI-BEN-DAYS.
 10766
 10767     MOVE PI-BEN-DAYS            TO WS-BEN-DAYS.
 10768
 10769     SET HOLD-UNTIL-CHK TO TRUE
 10770     MOVE CL-PAID-THRU-DT TO WS-HOLD-UNTIL-DT
 10771     PERFORM 1166-CHECK-ALL-TRLRS THRU 1166-TRLR-EXIT.
 10772     MOVE SPACE TO WS-HOLD-UNTIL-SW
 10773     IF WS-HOLD-UNTIL-DT > CL-PAID-THRU-DT
 10774         MOVE WS-HOLD-UNTIL-DT     TO DC-BIN-DATE-1
 10775         MOVE '6'                 TO DC-OPTION-CODE
 10776         MOVE +0                  TO DC-ELAPSED-MONTHS
 10777         MOVE +1                  TO DC-ELAPSED-DAYS
 10778         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10779         MOVE DC-BIN-DATE-2       TO PI-CPYFROM
 10780         GO TO 1145-TEST-PAID-FROM.
 10781
 10782     IF (CL-PAID-THRU-DT NOT = LOW-VALUES AND SPACES)  AND
 10783        (CL-TOTAL-PAID-AMT > ZEROS)
 10784         MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 10785         MOVE '6'                 TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 204
* EL156.cbl
 10786         MOVE +0                  TO DC-ELAPSED-MONTHS
 10787         MOVE +1                  TO DC-ELAPSED-DAYS
 10788         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10789         MOVE DC-BIN-DATE-2       TO PI-CPYFROM
 10790         GO TO 1145-TEST-PAID-FROM.
 10791
 10792******************************************************************
 10793****** ON FIRST PAYMENTS, ELIM/RETRO EDITS TO BE MADE AGAINST THE
 10794****** SPECIAL ENTERED DATE.
 10795******************************************************************
 10796
 10797     IF PI-AIGFROM = ZEROS
 10798         GO TO 1130-CONTINUE-PAID-FROM.
 10799
 10800     MOVE AL-UANON TO AIGFROMA.
 10801
 10802     MOVE '4'                    TO DC-OPTION-CODE.
 10803     MOVE PI-AIGFROM             TO DC-GREG-DATE-1-MDY.
 10804     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10805
 10806     IF DATE-CONVERSION-ERROR
 10807         MOVE ER-0449            TO EMI-ERROR
 10808         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10809         MOVE AL-UNBON           TO AIGFROMA
 10810         MOVE -1                 TO AIGFROML
 10811         MOVE CL-INCURRED-DT TO DC-BIN-DATE-1
 10812     ELSE
 10813         MOVE 'Y'                TO WS-AIG-PAYFROM-SW
 10814         MOVE DC-BIN-DATE-1      TO WS-SV-AIGFROM.
 10815
 10816     GO TO 1140-CONTINUE-PAID-FROM.
 10817
 10818 1130-CONTINUE-PAID-FROM.
 10819
 10820     IF (CL-PAID-THRU-DT   = LOW-VALUES OR SPACES) OR
 10821        (CL-TOTAL-PAID-AMT = ZEROS)
 10822           MOVE CL-INCURRED-DT TO DC-BIN-DATE-1.
 10823
 10824 1140-CONTINUE-PAID-FROM.
 10825
 10826     IF PI-BEN-TYPE = 'R'
 10827         IF PI-BEN-DAYS = ZEROS
 10828             NEXT SENTENCE
 10829         ELSE
 10830         IF PI-COMPANY-ID NOT = 'DMD'
 10831             SUBTRACT 1 FROM PI-BEN-DAYS.
 10832
 10833     MOVE DC-BIN-DATE-1          TO WS-HOLD-BIN-DATE-1.
 10834
 10835     IF PI-COMPANY-ID = 'DMD'
 10836         MOVE -1                 TO DC-ELAPSED-DAYS
 10837         MOVE +0                 TO DC-ELAPSED-MONTHS
 10838         MOVE '6'                TO DC-OPTION-CODE
 10839         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10840         MOVE DC-BIN-DATE-2      TO DC-BIN-DATE-1
 10841         DIVIDE PI-BEN-DAYS BY 30 GIVING DC-ELAPSED-MONTHS
 10842                               REMAINDER DC-ELAPSED-DAYS
 10843      ELSE
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 205
* EL156.cbl
 10844         MOVE PI-BEN-DAYS        TO DC-ELAPSED-DAYS
 10845         MOVE +0                 TO DC-ELAPSED-MONTHS.
 10846
 10847     MOVE '6'                    TO DC-OPTION-CODE.
 10848     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10849     MOVE DC-BIN-DATE-2          TO WS-RETRO-ELIM-DATE.
 10850
 10851     MOVE WS-HOLD-BIN-DATE-1     TO DC-BIN-DATE-1.
 10852
 10853     IF WS-RETRO-ELIM-DATE > WS-TODAY-DATE
 10854         MOVE ER-0541            TO EMI-ERROR
 10855         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10856         MOVE -1                 TO EPYFROML
 10857         MOVE AL-UNBON           TO EPYFROMA.
 10858
 10859     IF (PI-COMPANY-ID = 'AIG' OR 'AUK')  AND
 10860        (PI-BENEFIT-SAVE = '60E')
 10861        IF (CL-PAID-THRU-DT   = LOW-VALUES OR SPACES) OR
 10862           (CL-TOTAL-PAID-AMT = ZEROS)
 10863             MOVE WS-HOLD-BIN-DATE-1  TO DC-BIN-DATE-1
 10864             MOVE 30                  TO DC-ELAPSED-DAYS
 10865             MOVE +0                  TO DC-ELAPSED-MONTHS
 10866             MOVE '6'                 TO DC-OPTION-CODE
 10867             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10868
 10869     IF PI-BEN-TYPE = 'R'
 10870         MOVE DC-BIN-DATE-1      TO PI-CPYFROM
 10871     ELSE
 10872         MOVE DC-BIN-DATE-2      TO PI-CPYFROM
 10873         IF WS-SV-EPYFROM = LOW-VALUES
 10874            MOVE DC-BIN-DATE-2   TO WS-SV-EPYFROM.
 10875
 10876     IF CL-PAID-THRU-DT = LOW-VALUES OR SPACES
 10877         IF WS-USE-AIG-PAYFROM   OR
 10878            WS-AIG-RECALC-PAYFROM
 10879              MOVE PI-CPYFROM     TO  WS-SV-EPYFROM
 10880                                      DC-BIN-DATE-1
 10881              MOVE ' '            TO  DC-OPTION-CODE
 10882              MOVE +0             TO  DC-ELAPSED-MONTHS
 10883                                      DC-ELAPSED-DAYS
 10884              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10885              IF NO-CONVERSION-ERROR
 10886                  MOVE DC-GREG-DATE-1-MDY TO PI-EPYFROM.
 10887
 10888     IF PI-CPYFROM < CL-INCURRED-DT
 10889        MOVE -1                  TO EPYFROML
 10890        MOVE ER-3542             TO EMI-ERROR
 10891        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10892
 10893     IF CM-ENTRY-DT < CL-INCURRED-DT
 10894        MOVE CM-ENTRY-DT            TO DC-BIN-DATE-1
 10895        MOVE CL-INCURRED-DT         TO DC-BIN-DATE-2
 10896        MOVE +0                     TO DC-ELAPSED-DAYS
 10897        MOVE +0                     TO DC-ELAPSED-MONTHS
 10898        MOVE '1'                    TO DC-OPTION-CODE
 10899        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10900        ELSE
 10901        MOVE ZEROS TO DC-ELAPSED-MONTHS.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 206
* EL156.cbl
 10902
 10903     IF PI-COMPANY-ID = 'AIG' OR 'AUK' OR 'DMD'
 10904         NEXT SENTENCE
 10905     ELSE
 10906         IF DC-ELAPSED-MONTHS < 2
 10907             MOVE ER-3255        TO EMI-ERROR
 10908             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10909
 10910 1145-TEST-PAID-FROM.
 10911     IF LOW-VALUES = WS-SV-EPYFROM OR PI-CPYFROM
 10912         GO TO 1150-EDIT-PAID-THRU.
 10913
 10914     IF WS-SV-EPYFROM NOT = PI-CPYFROM
 10915         MOVE PI-CPYFROM         TO DC-BIN-DATE-1
 10916         MOVE ' '                TO DC-OPTION-CODE
 10917         MOVE +0                 TO DC-ELAPSED-MONTHS
 10918                                    DC-ELAPSED-DAYS
 10919         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10920         IF NO-CONVERSION-ERROR
 10921             MOVE DC-GREG-DATE-1-MDY TO EMI-DATE-FIELD
 10922         ELSE
 10923             MOVE SPACES             TO EMI-DATE-FIELD.
 10924
 10925     IF PI-HOLDTIL NOT = ZEROS
 10926        CONTINUE
 10927     ELSE
 10928     IF WS-SV-EPYFROM NOT = PI-CPYFROM
 10929         IF CL-TOTAL-PAID-AMT = ZEROS
 10930             MOVE ER-3543            TO EMI-ERROR
 10931             MOVE WS-SV-EPYFROM      TO PI-CPYFROM
 10932             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10933             IF EMI-MESSAGE-FORMATTED
 10934                MOVE -1             TO EPYFROML
 10935                MOVE AL-UNBON       TO EPYFROMA
 10936             ELSE
 10937                NEXT SENTENCE
 10938         ELSE
 10939             MOVE ER-0452            TO EMI-ERROR
 10940             MOVE WS-SV-EPYFROM      TO PI-CPYFROM
 10941             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10942             IF EMI-MESSAGE-FORMATTED
 10943                MOVE -1             TO EPYFROML
 10944                MOVE AL-UNBON       TO EPYFROMA.
 10945
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 207
* EL156.cbl
 10947 1150-EDIT-PAID-THRU.
 10948
 10949     MOVE AL-UANON               TO EPYTHRUA.
 10950
 10951     IF PI-EPYTHRU = ZEROS
 10952*        IF PI-PMTTYPE = '4' OR '5' OR '6'
 10953         IF PI-PMTTYPE = '5' OR '6'
 10954           OR (CL-CLAIM-TYPE NOT = 'L' AND PI-PMTTYPE = '4')
 10955             GO TO 1200-EDIT-FIND-TOLERANCES
 10956         ELSE
 10957            IF (PI-PMTTYPE = '3') OR (PI-PMTTYPE = '4') OR
 10958               (PI-PMTTYPE = '2' AND
 10959                PI-LIFE-OVERRIDE-L1 = CL-CLAIM-TYPE)
 10960               GO TO 1152-CHECK-TYPE
 10961            ELSE
 10962               MOVE ER-0473      TO EMI-ERROR
 10963               GO TO 1170-PAID-THRU-FATAL-ERROR
 10964     ELSE
 10965         IF PI-PMTTYPE = '5' OR '6'
 10966             MOVE ER-0474        TO EMI-ERROR
 10967             GO TO 1170-PAID-THRU-FATAL-ERROR.
 10968
 10969     MOVE '4'                    TO DC-OPTION-CODE.
 10970     MOVE PI-EPYTHRU             TO DC-GREG-DATE-1-MDY.
 10971     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10972
 10973     IF DATE-CONVERSION-ERROR
 10974         MOVE ER-0475            TO EMI-ERROR
 10975         GO TO 1170-PAID-THRU-FATAL-ERROR.
 10976
 10977     MOVE DC-BIN-DATE-1       TO WS-SV-EPYTHRU.
 10978
 10979     IF PI-COMPANY-ID = 'DMD'
 10980         IF PI-PMTTYPE NOT = '2'
 10981                 AND
 10982            WS-EXP-DT > WS-SV-EPYTHRU
 10983             MOVE WS-SV-EPYTHRU    TO DC-BIN-DATE-1
 10984             MOVE WS-EXP-DT        TO DC-BIN-DATE-2
 10985             MOVE '1'              TO DC-OPTION-CODE
 10986             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10987             IF DATE-CONVERSION-ERROR
 10988                 MOVE ER-0944      TO EMI-ERROR
 10989                 GO TO 1170-PAID-THRU-FATAL-ERROR
 10990             ELSE
 10991                 IF DC-ELAPSED-MONTHS = ZEROS AND
 10992                    DC-ELAPSED-DAYS   = 1
 10993                     MOVE ER-0945  TO EMI-ERROR
 10994                     MOVE -1       TO EPYTHRUL
 10995                     MOVE AL-UABON TO EPYTHRUA
 10996                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10997
 10998     IF PI-PMTTYPE = '4'
 10999         NEXT SENTENCE
 11000     ELSE
 11001         IF WS-SV-EPYTHRU = WS-EXP-DT
 11002             IF PI-PMTTYPE NOT = '2' AND '3'
 11003                 MOVE ER-3541    TO EMI-ERROR
 11004                 MOVE -1         TO PMTTYPEL
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 208
* EL156.cbl
 11005                 MOVE AL-UABON   TO PMTTYPEA
 11006                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11007
 11008     IF WS-SV-EPYTHRU < WS-SV-EPYFROM
 11009         MOVE ER-0501            TO EMI-ERROR
 11010         GO TO 1170-PAID-THRU-FATAL-ERROR.
 11011
 11012     IF WS-SV-EPYTHRU > WS-TODAY-DATE
 11013        IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 11014*          IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11015*              MOVE ER-0540         TO EMI-ERROR
 11016*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11017*              MOVE -1              TO EPYTHRUL
 11018*              MOVE AL-UNBON        TO EPYTHRUA
 11019*          ELSE
 11020*          IF PI-COMPANY-ID = 'DMD'
 11021*              MOVE ER-7540         TO EMI-ERROR
 11022*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11023*              MOVE -1              TO EPYTHRUL
 11024*              MOVE AL-UNBON        TO EPYTHRUA
 11025*          ELSE
 11026               IF PI-PMTTYPE NOT = '2' AND '3'
 11027                  IF PI-COMPANY-ID = '???'
 11028                      MOVE ER-7540  TO EMI-ERROR
 11029                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11030                      MOVE -1       TO EPYTHRUL
 11031                      MOVE AL-UNBON TO EPYTHRUA
 11032                  ELSE
 11033                      MOVE ER-0540  TO EMI-ERROR
 11034                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11035                      MOVE -1       TO EPYTHRUL
 11036                      MOVE AL-UNBON TO EPYTHRUA.
 11037
 11038     IF (WS-SV-EPYTHRU < CL-PAID-THRU-DT)
 11039            OR
 11040        (WS-SV-EPYTHRU NOT = LOW-VALUES AND
 11041         WS-SV-EPYTHRU < CL-PAID-THRU-DT)
 11042            OR
 11043        (PI-CPYFROM NOT = LOW-VALUES AND
 11044         PI-CPYFROM < CL-PAID-THRU-DT)
 11045        PERFORM 1166-CHECK-ALL-TRLRS THRU 1166-TRLR-EXIT.
 11046
 11047 1152-CHECK-TYPE.
 11048     IF (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F')
 11049        OR (PI-PMTTYPE = '5' OR '6')
 11050         GO TO 1160-EDIT-PAID-THRU-AH.
 11051
 11052 1155-EDIT-PAID-THRU-LIFE.
 11053     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 11054     MOVE WS-ACCESS              TO CNTL-ACCESS.
 11055     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11056     MOVE '4'                    TO CNTL-REC-TYPE.
 11057     MOVE ZEROS                  TO CNTL-SEQ-NO.
 11058     MOVE 'BENE'                 TO FILE-SWITCH.
 11059
 11060     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 11061
 11062     IF NO-BENEFIT-FOUND
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 209
* EL156.cbl
 11063         GO TO 1950-NOT-FOUND.
 11064
 11065     MOVE CF-SPECIAL-CALC-CD (SUB-1) TO WS-SPECIAL-CALC-CD.
 11066
 11067     MOVE WS-EXP-DT              TO PI-CPYTHRU.
 11068
 11069     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 11070        PI-LF-COVERAGE-TYPE = 'P'
 11071         MOVE CL-INCURRED-DT     TO  PI-CPYTHRU
 11072         GO TO 1200-EDIT-FIND-TOLERANCES.
 11073
 11074     IF PI-EPYTHRU = ZEROS
 11075        MOVE PI-CPYTHRU          TO WS-SV-EPYTHRU.
 11076
 11077     IF WS-SV-EPYTHRU NOT = WS-EXP-DT
 11078         MOVE ER-0476            TO EMI-ERROR
 11079         PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11080
 11081     MOVE CM-CERT-EFF-DT        TO DC-BIN-DATE-1.
 11082*    MOVE CM-LF-CRITICAL-PERIOD TO DC-ELAPSED-MONTHS.
 11083     move cl-critical-period    to dc-elapsed-months
 11084     MOVE +0                    TO DC-ELAPSED-DAYS.
 11085     MOVE '6'                   TO DC-OPTION-CODE.
 11086     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11087
 11088     IF (NO-CONVERSION-ERROR AND
 11089         WS-SPECIAL-CALC-CD = 'C')
 11090        IF CL-INCURRED-DT > DC-BIN-DATE-2
 11091            MOVE ER-0657 TO EMI-ERROR
 11092            PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11093
 11094     IF PI-COMPANY-ID = 'NCL'
 11095         IF WS-SPECIAL-CALC-CD = 'C' AND
 11096            cl-critical-period = zeros
 11097*           CM-LF-CRITICAL-PERIOD = +0
 11098             MOVE ER-0844       TO EMI-ERROR
 11099             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11100
 11101     GO TO 1200-EDIT-FIND-TOLERANCES.
 11102
 11103 1160-EDIT-PAID-THRU-AH.
 11104     IF PI-EPYTHRU = ZEROS
 11105        MOVE WS-EXP-DT           TO PI-CPYTHRU
 11106                                    WS-SV-EPYTHRU
 11107     ELSE
 11108        MOVE WS-SV-EPYTHRU       TO PI-CPYTHRU.
 11109
 11110     IF WS-SV-EPYTHRU < PI-CPYFROM
 11111         MOVE ER-0508            TO EMI-ERROR
 11112         GO TO 1170-PAID-THRU-FATAL-ERROR.
 11113
 11114     perform 7975-read-acct      thru 7975-exit
 11115     move zeros                  to pi-max-ext
 11116     if PI-DCC-PRODUCT-CODE NOT = SPACES
 11117        PERFORM 0900-GET-DDF-LIMITS
 11118                                 THRU 0900-EXIT
 11119        IF PDEF-FOUND
 11120           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 210
* EL156.cbl
 11121              (P1 > +8)
 11122              OR (PD-PROD-CODE (P1) = CL-CLAIM-TYPE)
 11123           END-PERFORM
 11124           IF P1 < +9
 11125              MOVE PD-MAX-extension (P1)
 11126                                 TO pi-max-ext
 11127           else
 11128              move er-1674       to emi-error
 11129              PERFORM 9900-ERROR-FORMAT
 11130                                 THRU 9900-EXIT
 11131           END-IF
 11132        else
 11133           move er-1672          to emi-error
 11134           PERFORM 9900-ERROR-FORMAT
 11135                                 THRU 9900-EXIT
 11136        END-IF
 11137     end-if
 11138     move spaces                 to pi-max-ext-used
 11139     IF PI-PMTTYPE = '3'
 11140        MOVE WS-EXP-DT           TO PI-CPYTHRU
 11141        IF WS-SV-EPYTHRU NOT = WS-EXP-DT
 11142           MOVE ER-0477          TO EMI-ERROR
 11143           PERFORM 1165-PAID-THRU-ERROR
 11144                                 THRU 1165-EXIT
 11145        ELSE
 11146           continue
 11147        end-if
 11148     ELSE
 11149        IF WS-SV-EPYTHRU > WS-EXP-DT
 11150         IF PI-DCC-PRODUCT-CODE NOT > SPACES
 11151           move ws-exp-dt        to dc-bin-date-1
 11152           move ws-sv-epythru    to dc-bin-date-2
 11153           MOVE '1'              TO DC-OPTION-CODE
 11154           MOVE +0               TO DC-ELAPSED-DAYS
 11155                                    DC-ELAPSED-MONTHS
 11156           PERFORM 9700-LINK-DATE-CONVERT
 11157                                 THRU 9700-EXIT
 11158           if no-conversion-error
 11159              if dc-elapsed-days > zeros
 11160                 add +1 to dc-elapsed-months
 11161              end-if
 11162              if dc-elapsed-months > pi-max-ext
 11163                 MOVE ER-0557    TO EMI-ERROR
 11164                 PERFORM 1165-PAID-THRU-ERROR
 11165                                 THRU 1165-EXIT
 11166              else
 11167                 move 'Y'        to pi-max-ext-used
 11168                 move er-1670    to emi-error
 11169                 perform 9900-error-format
 11170                                 thru 9900-exit
 11171              end-if
 11172           end-if
 11173         ELSE
 11174            MOVE ER-0557    TO EMI-ERROR
 11175            PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT
 11176         END-IF
 11177        end-if
 11178     end-if
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 211
* EL156.cbl
 11179
 11180     IF (WS-RETRO-ELIM-DATE > WS-SV-EPYTHRU) AND
 11181         PI-PMTTYPE NOT = '3'
 11182         MOVE ER-0541        TO EMI-ERROR
 11183         PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11184
 11185     IF (CM-AH-CANCEL-DT NOT = LOW-VALUES) AND
 11186        (PI-PMTTYPE NOT = '3')
 11187         IF WS-SV-EPYTHRU > CM-AH-CANCEL-DT
 11188             MOVE ER-0478        TO EMI-ERROR
 11189             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11190
 11191     IF (CM-AH-SETTLEMENT-DT NOT = LOW-VALUES) AND
 11192        (PI-PMTTYPE NOT = '4')
 11193         IF WS-SV-EPYTHRU > CM-AH-SETTLEMENT-DT
 11194             MOVE ER-0479        TO EMI-ERROR
 11195             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11196
 11197     IF (CL-EST-END-OF-DISAB-DT NOT = LOW-VALUES) AND
 11198         WS-SV-EPYTHRU > CL-EST-END-OF-DISAB-DT
 11199             MOVE ER-0545        TO EMI-ERROR
 11200             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11201
 11202     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
 11203         IF WS-SV-EPYTHRU > CM-LF-DEATH-EXIT-DT
 11204             MOVE ER-0481        TO EMI-ERROR
 11205             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11206
 11207*    IF PI-COMPANY-ID = 'NCL'
 11208*        IF WS-SPECIAL-CALC-CD = 'C' AND
 11209*           CM-AH-CRITICAL-PERIOD = +0
 11210*            MOVE ER-0844        TO  EMI-ERROR
 11211*            PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11212
 11213*    IF (CM-AH-CRITICAL-PERIOD = ZEROS) OR
 11214     if (cl-critical-period = zeros)
 11215        or (WS-SPECIAL-CALC-CD NOT = 'C')
 11216          GO TO 1200-EDIT-FIND-TOLERANCES.
 11217
 11218     MOVE PI-CPYFROM TO DC-BIN-DATE-1.
 11219     MOVE PI-CPYTHRU TO DC-BIN-DATE-2.
 11220     MOVE '1'        TO DC-OPTION-CODE.
 11221     MOVE +0         TO DC-ELAPSED-DAYS
 11222                        DC-ELAPSED-MONTHS.
 11223     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11224
 11225*    IF NO-CONVERSION-ERROR
 11226*       COMPUTE ws-benefits-paid =
 11227*           (DC-ELAPSED-DAYS + CL-NO-OF-DAYS-PAID) / 30.5
 11228*       IF ws-benefits-paid > CM-AH-CRITICAL-PERIOD
 11229*           MOVE ER-0657 TO EMI-ERROR
 11230*           PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11231
 11232     GO TO 1200-EDIT-FIND-TOLERANCES.
 11233
 11234 1165-PAID-THRU-ERROR.
 11235     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11236
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 212
* EL156.cbl
 11237     IF EMI-MESSAGE-FORMATTED
 11238         MOVE -1                 TO EPYTHRUL
 11239         MOVE AL-UNBON           TO EPYTHRUA.
 11240
 11241 1165-EXIT.
 11242     EXIT.
 11243
 11244 1166-CHECK-ALL-TRLRS.
 11245
 11246     IF PI-PMTTYPE = '4'
 11247        GO TO 1166-TRLR-EXIT.
 11248
 11249     MOVE ' ' TO WS-BROWSE-TRLR-SW.
 11250
 11251     IF HOLD-UNTIL-CHK
 11252        CONTINUE
 11253     ELSE
 11254     IF WS-SV-EPYTHRU = LOW-VALUES  AND
 11255        WS-SV-EPYFROM = LOW-VALUES
 11256          GO TO 1166-END-CHECK.
 11257
 11258
 11259* EXEC CICS HANDLE CONDITION
 11260*        ENDFILE   (1166-END-CHECK)
 11261*        NOTFND    (1166-END-CHECK)
 11262*    END-EXEC.
 11263*    MOVE '"$''I                  ! ) #00010842' TO DFHEIV0
 11264     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 11265     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11266     MOVE X'2920233030303130383432' TO DFHEIV0(25:11)
 11267     CALL 'kxdfhei1' USING DFHEIV0
 11268     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11269
 11270
 11271     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 11272     MOVE +100                   TO TRLR-SEQ-NO.
 11273
 11274
 11275* EXEC CICS STARTBR
 11276*         DATASET    ('ELTRLR')
 11277*         RIDFLD     (ELTRLR-KEY)
 11278*         GTEQ
 11279*    END-EXEC.
 11280     MOVE 'ELTRLR' TO DFHEIV1
 11281     MOVE 0
 11282       TO DFHEIV11
 11283*    MOVE '&,         G          &   #00010850' TO DFHEIV0
 11284     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11285     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11286     MOVE X'2020233030303130383530' TO DFHEIV0(25:11)
 11287     CALL 'kxdfhei1' USING DFHEIV0,
 11288           DFHEIV1,
 11289           ELTRLR-KEY,
 11290           DFHEIV99,
 11291           DFHEIV11,
 11292           DFHEIV99
 11293     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11294
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 213
* EL156.cbl
 11295
 11296     MOVE 'Y' TO WS-BROWSE-TRLR-SW.
 11297
 11298 1166-READ-TRLR-NEXT.
 11299
 11300
 11301* EXEC CICS READNEXT
 11302*         DATASET    ('ELTRLR')
 11303*         RIDFLD     (ELTRLR-KEY)
 11304*         SET        (ADDRESS OF ACTIVITY-TRAILERS)
 11305*    END-EXEC.
 11306     MOVE 'ELTRLR' TO DFHEIV1
 11307     MOVE 0
 11308       TO DFHEIV11
 11309*    MOVE '&.S                   )   #00010860' TO DFHEIV0
 11310     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 11311     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 11312     MOVE X'2020233030303130383630' TO DFHEIV0(25:11)
 11313     CALL 'kxdfhei1' USING DFHEIV0,
 11314           DFHEIV1,
 11315           DFHEIV20,
 11316           DFHEIV99,
 11317           ELTRLR-KEY,
 11318           DFHEIV99,
 11319           DFHEIV11,
 11320           DFHEIV99,
 11321           DFHEIV99
 11322     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11323         DFHEIV20
 11324     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11325
 11326
 11327     IF TRLR-COMP-CD  = MSTR-COMP-CD  AND
 11328        TRLR-CARRIER  = MSTR-CARRIER  AND
 11329        TRLR-CLAIM-NO = MSTR-CLAIM-NO AND
 11330        TRLR-CERT-NO  = MSTR-CERT-NO
 11331          NEXT SENTENCE
 11332      ELSE
 11333          GO TO 1166-END-CHECK.
 11334
 11335* **  BYPASS ALL NON-PAYMENT TRAILERS
 11336
 11337     IF AT-TRAILER-TYPE = '2'
 11338        NEXT SENTENCE
 11339     ELSE
 11340        GO TO 1166-READ-TRLR-NEXT.
 11341
 11342* **  BYPASS ALL NON-PARTIAL PAYMENTS
 11343
 11344     IF AT-PAYMENT-TYPE = '1' OR '2'
 11345        NEXT SENTENCE
 11346     ELSE
 11347        GO TO 1166-READ-TRLR-NEXT.
 11348
 11349* **  BYPASS ALL VOID PAYMENTS
 11350
 11351     IF AT-VOID-DT NOT = LOW-VALUES
 11352        GO TO 1166-READ-TRLR-NEXT.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 214
* EL156.cbl
 11353
 11354     IF (AT-PAID-FROM-DT = LOW-VALUES OR SPACES) OR
 11355        (AT-PAID-THRU-DT = LOW-VALUES OR SPACES)
 11356          GO TO 1166-READ-TRLR-NEXT.
 11357     IF HOLD-UNTIL-CHK
 11358        IF AT-PAID-THRU-DT > WS-HOLD-UNTIL-DT
 11359          AND AT-TO-BE-WRITTEN-DT > ZERO
 11360           MOVE AT-PAID-THRU-DT TO WS-HOLD-UNTIL-DT
 11361        END-IF
 11362     END-IF
 11363
 11364     IF HOLD-UNTIL-CHK
 11365        CONTINUE
 11366     ELSE
 11367     IF ((WS-SV-EPYTHRU < AT-PAID-FROM-DT) AND
 11368         (WS-SV-EPYFROM < AT-PAID-FROM-DT))
 11369            OR
 11370        ((WS-SV-EPYTHRU > AT-PAID-THRU-DT) AND
 11371         (WS-SV-EPYFROM > AT-PAID-THRU-DT))
 11372        NEXT SENTENCE
 11373     ELSE
 11374         IF CL-TOTAL-PAID-AMT > ZEROS
 11375             MOVE ER-0502            TO EMI-ERROR
 11376             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11377             MOVE -1                 TO EPYTHRUL
 11378             MOVE AL-UNBON           TO EPYTHRUA.
 11379
 11380     GO TO 1166-READ-TRLR-NEXT.
 11381
 11382 1166-END-CHECK.
 11383
 11384     IF WS-BROWSE-TRLR-SW = 'Y'
 11385
 11386* EXEC CICS ENDBR
 11387*            DATASET   ('ELTRLR')
 11388*       END-EXEC.
 11389     MOVE 'ELTRLR' TO DFHEIV1
 11390     MOVE 0
 11391       TO DFHEIV11
 11392*    MOVE '&2                    $   #00010924' TO DFHEIV0
 11393     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 11394     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11395     MOVE X'2020233030303130393234' TO DFHEIV0(25:11)
 11396     CALL 'kxdfhei1' USING DFHEIV0,
 11397           DFHEIV1,
 11398           DFHEIV11,
 11399           DFHEIV99
 11400     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11401
 11402
 11403     MOVE 'Y' TO WS-BROWSE-TRLR-SW.
 11404
 11405 1166-TRLR-EXIT.
 11406     EXIT.
 11407
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 215
* EL156.cbl
 11409 1170-PAID-THRU-FATAL-ERROR.
 11410     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11411
 11412     MOVE -1                     TO EPYTHRUL.
 11413     MOVE AL-UNBON               TO EPYTHRUA.
 11414
 11415 1200-EDIT-FIND-TOLERANCES.
 11416
 11417* EXEC CICS HANDLE CONDITION
 11418*        ENDFILE(1950-NOT-FOUND)
 11419*        NOTFND (1950-NOT-FOUND)
 11420*    END-EXEC.
 11421*    MOVE '"$''I                  ! * #00010941' TO DFHEIV0
 11422     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 11423     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11424     MOVE X'2A20233030303130393431' TO DFHEIV0(25:11)
 11425     CALL 'kxdfhei1' USING DFHEIV0
 11426     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11427
 11428
 11429     IF PI-PROCESSOR-ID = 'LGXX'
 11430        GO TO 1240-FIND-ACCT-TOLERANCES.
 11431
 11432     MOVE 'N'                    TO FOUND-TOL-SW.
 11433     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11434     MOVE '2'                    TO CNTL-REC-TYPE.
 11435     MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS.
 11436     MOVE +0                     TO CNTL-SEQ-NO.
 11437     MOVE 'PROC'                 TO FILE-SWITCH.
 11438
 11439     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 11440
 11441     MOVE CF-PROC-CALC-AMT-TOL   TO WS-PMT-TOL.
 11442     MOVE CF-PROC-MAX-REG-PMT    TO WS-MAX-PMT-TOL
 11443                                    PI-MAX-PMT-TOL.
 11444     MOVE CF-PROC-MAX-REG-DAYS   TO WS-MAX-DAYS-TOL.
 11445
 11446     IF PI-COMPANY-ID = 'HER' OR 'KSM'
 11447         MOVE CF-PROC-MAX-REG-PMT   TO  WS-HER-MO-PMT-AMT.
 11448
 11449     MOVE CF-PROC-CALC-DAYS-TOL  TO WS-DAYS-TOL.
 11450     MOVE CF-PROC-MAX-LF-PMT     TO WS-MAX-LF-PMT-TOL
 11451                                    PI-MAX-LF-PMT-TOL.
 11452
 11453     IF CF-PROC-MAX-EXP-PMT NOT NUMERIC
 11454         MOVE ZEROS              TO CF-PROC-MAX-EXP-PMT.
 11455
 11456     MOVE CF-PROC-MAX-EXP-PMT    TO WS-MAX-EXP-PMT
 11457                                    PI-MAX-EXP-PMT.
 11458
 11459 1240-FIND-ACCT-TOLERANCES.
 11460
 11461     IF WS-PMT-TOL NOT = +0
 11462         MOVE 'Y'                TO FOUND-TOL-SW.
 11463
 11464     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11465         MOVE PI-COMPANY-CD          TO ACCT-COMP-CD
 11466         MOVE CL-CURRENT-CARRIER     TO ACCT-CARRIER
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 216
* EL156.cbl
 11467         MOVE CL-CURRENT-GROUPING    TO ACCT-GROUPING
 11468         MOVE CL-CURRENT-STATE       TO ACCT-STATE
 11469         MOVE CL-CURRENT-ACCOUNT     TO ACCT-ACCOUNT
 11470         MOVE CL-CERT-EFF-DT         TO ACCT-EXP-DT
 11471     ELSE
 11472         MOVE PI-COMPANY-CD          TO ACCT-COMP-CD
 11473         MOVE PI-CARRIER             TO ACCT-CARRIER
 11474         MOVE PI-GROUPING            TO ACCT-GROUPING
 11475         MOVE PI-STATE               TO ACCT-STATE
 11476         MOVE PI-ACCOUNT             TO ACCT-ACCOUNT
 11477         MOVE PI-CERT-EFF-DT         TO ACCT-EXP-DT.
 11478
 11479     MOVE 'ACCT'                 TO FILE-SWITCH.
 11480
 11481     MOVE ERACCT-PARTIAL-KEY     TO WS-ERACCT-SAVE-KEY.
 11482     MOVE SPACES                 TO WS-ERACCT-HOLD-RECORD.
 11483
 11484
 11485* EXEC CICS HANDLE CONDITION
 11486*         NOTFND   (1950-NOT-FOUND)
 11487*         ENDFILE  (1950-NOT-FOUND)
 11488*    END-EXEC.
 11489*    MOVE '"$I''                  ! + #00011001' TO DFHEIV0
 11490     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 11491     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11492     MOVE X'2B20233030303131303031' TO DFHEIV0(25:11)
 11493     CALL 'kxdfhei1' USING DFHEIV0
 11494     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11495
 11496
 11497
 11498* EXEC CICS STARTBR
 11499*        DATASET('ERACCT')
 11500*        RIDFLD (ERACCT-KEY)
 11501*        GTEQ
 11502*    END-EXEC.
 11503     MOVE 'ERACCT' TO DFHEIV1
 11504     MOVE 0
 11505       TO DFHEIV11
 11506*    MOVE '&,         G          &   #00011006' TO DFHEIV0
 11507     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11508     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11509     MOVE X'2020233030303131303036' TO DFHEIV0(25:11)
 11510     CALL 'kxdfhei1' USING DFHEIV0,
 11511           DFHEIV1,
 11512           ERACCT-KEY,
 11513           DFHEIV99,
 11514           DFHEIV11,
 11515           DFHEIV99
 11516     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11517
 11518
 11519 1245-FIND-ACCT-TOLERANCES-LOOP.
 11520
 11521
 11522* EXEC CICS READNEXT
 11523*        DATASET('ERACCT')
 11524*        SET    (ADDRESS OF ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 217
* EL156.cbl
 11525*        RIDFLD (ERACCT-KEY)
 11526*    END-EXEC.
 11527     MOVE 'ERACCT' TO DFHEIV1
 11528     MOVE 0
 11529       TO DFHEIV11
 11530*    MOVE '&.S                   )   #00011014' TO DFHEIV0
 11531     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 11532     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 11533     MOVE X'2020233030303131303134' TO DFHEIV0(25:11)
 11534     CALL 'kxdfhei1' USING DFHEIV0,
 11535           DFHEIV1,
 11536           DFHEIV20,
 11537           DFHEIV99,
 11538           ERACCT-KEY,
 11539           DFHEIV99,
 11540           DFHEIV11,
 11541           DFHEIV99,
 11542           DFHEIV99
 11543     SET ADDRESS OF ACCOUNT-MASTER TO
 11544         DFHEIV20
 11545     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11546
 11547
 11548     IF WS-ERACCT-SAVE-KEY NOT = ERACCT-PARTIAL-KEY
 11549        IF WS-ERACCT-HOLD-RECORD = SPACES
 11550           GO TO 1950-NOT-FOUND
 11551        ELSE
 11552           MOVE WS-ERACCT-HOLD-RECORD TO ACCOUNT-MASTER
 11553           GO TO 1250-CONTINUE.
 11554
 11555     IF ACCT-EXP-DT = HIGH-VALUES
 11556        NEXT SENTENCE
 11557     ELSE
 11558        MOVE ACCOUNT-MASTER TO WS-ERACCT-HOLD-RECORD
 11559        GO TO 1245-FIND-ACCT-TOLERANCES-LOOP.
 11560
 11561 1250-CONTINUE.
 11562
 11563     MOVE AM-CONTROL-PRIMARY     TO PI-ACCT-KEY.
 11564
 11565     IF FOUND-TOL-SW = 'N'
 11566         MOVE AM-TOL-CLM         TO WS-PMT-TOL.
 11567
 11568********* 1260-FIND-STATE-TOLERANCES.
 11569
 11570     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11571     MOVE PI-STATE               TO WS-ST-ACCESS.
 11572     MOVE WS-STATE-ACCESS        TO CNTL-ACCESS.
 11573     MOVE '3'                    TO CNTL-REC-TYPE.
 11574     MOVE +0                     TO CNTL-SEQ-NO.
 11575     MOVE 'STAT'                 TO FILE-SWITCH.
 11576
 11577     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 11578
 11579     IF WS-PMT-TOL = +0
 11580         MOVE CF-ST-TOL-CLAIM    TO WS-PMT-TOL.
 11581
 11582     MOVE CF-ST-CLAIM-REJECT-SW  TO WS-TOL-SEVERITY.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 218
* EL156.cbl
 11583     MOVE CF-ST-SPLIT-PAYMENT    TO PI-SPLIT-PMT-SW.
 11584     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREV.
 11585     MOVE CF-ST-FREE-LOOK-PERIOD TO CP-FREE-LOOK.
 11586     MOVE CF-ST-VFY-2ND-BENE     TO PI-VFY-2ND-BENE.
 11587
 11588****FOR ANY PAYMENT NOT MADE TO BENEFICIARY, CHECK FOR VERIFY IND
 11589****AND FOR LIFE PAYMENTS CHECK PAYEE NAME NOT EQUAL TO DECEASED
 11590     IF PI-PAYEE-TYPE <> 'B'
 11591           PERFORM 3600-CHECK-VERIFICATION THRU 3600-EXIT
 11592     END-IF.
 11593
 11594     IF PI-PMTTYPE      = '2'  AND
 11595        PI-SPLIT-PMT-SW = 'Y'  AND
 11596        CL-CLAIM-TYPE   = PI-LIFE-OVERRIDE-L1
 11597          MOVE ER-3530                TO EMI-ERROR
 11598          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11599
 11600********* 1280-FIND-BENEFIT-TOLERANCES.
 11601
 11602     IF (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F')
 11603        OR (PI-PMTTYPE = '5' OR '6')
 11604         GO TO 1300-FIND-CARR-TOLERANCES.
 11605
 11606     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11607     MOVE '4'                    TO CNTL-REC-TYPE.
 11608     MOVE +0                     TO CNTL-SEQ-NO.
 11609     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 11610     MOVE WS-ACCESS              TO CNTL-ACCESS.
 11611     MOVE 'BENE'                 TO FILE-SWITCH.
 11612
 11613     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 11614
 11615     IF NO-BENEFIT-FOUND
 11616         GO TO 1950-NOT-FOUND.
 11617
 11618     MOVE CF-CO-EARNINGS-CALC (SUB-1)    TO  WS-EARNING-METHOD.
 11619     MOVE CF-SPECIAL-CALC-CD  (SUB-1)    TO  WS-SPECIAL-CALC-CD.
 11620     MOVE CF-LF-COVERAGE-TYPE (SUB-1)    TO  WS-LF-COVERAGE-TYPE.
 11621
 11622
 11623* EXEC CICS HANDLE CONDITION
 11624*        NOTFND(1950-NOT-FOUND)
 11625*    END-EXEC.
 11626*    MOVE '"$I                   ! , #00011094' TO DFHEIV0
 11627     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11628     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11629     MOVE X'2C20233030303131303934' TO DFHEIV0(25:11)
 11630     CALL 'kxdfhei1' USING DFHEIV0
 11631     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11632
 11633
 11634 1300-FIND-CARR-TOLERANCES.
 11635     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11636     MOVE '6'                    TO CNTL-REC-TYPE.
 11637
 11638     IF CONTROL-IS-ACTUAL-CARRIER
 11639         MOVE PI-CARRIER               TO WS-CARR
 11640     ELSE
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 219
* EL156.cbl
 11641         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 11642
 11643     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 11644     MOVE +0                     TO CNTL-SEQ-NO.
 11645     MOVE 'CARR'                 TO FILE-SWITCH.
 11646
 11647     PERFORM 7930-READ-CONTROL   THRU 7930-EXIT.
 11648
 11649     IF WS-DAYS-TOL = +0
 11650         MOVE CF-CALC-DAYS-TOL   TO WS-DAYS-TOL.
 11651
 11652     IF WS-PMT-TOL = +0
 11653         MOVE CF-CALC-AMT-TOL    TO WS-PMT-TOL.
 11654
 11655     IF WS-MAX-DAYS-TOL = +0
 11656         MOVE CF-MAX-REG-DAYS    TO WS-MAX-DAYS-TOL.
 11657
 11658     IF WS-MAX-PMT-TOL = +0
 11659         MOVE CF-MAX-REG-PMT     TO WS-MAX-PMT-TOL
 11660                                    PI-MAX-PMT-TOL.
 11661
 11662     IF WS-MAX-LF-PMT-TOL = +0
 11663        MOVE CF-MAX-REG-PMT      TO WS-MAX-LF-PMT-TOL
 11664                                    PI-MAX-LF-PMT-TOL.
 11665
 11666     MOVE CF-CLAIM-CALC-METHOD   TO WS-CALC-METHOD.
 11667
 11668********* 1320-FIND-COMP-TOLERANCES.
 11669
 11670     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11671     MOVE '1'                    TO CNTL-REC-TYPE.
 11672     MOVE SPACES                 TO CNTL-ACCESS.
 11673     MOVE +0                     TO CNTL-SEQ-NO.
 11674     MOVE 'COMP'                 TO FILE-SWITCH.
 11675
 11676     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 11677
 11678     MOVE CF-CURRENT-MONTH-END   TO PI-MONTH-END-SAVE.
 11679     MOVE CF-PAYMENT-APPROVAL-SW TO PI-PMT-APPR-SW.
 11680
 11681     IF WS-PMT-TOL NOT = +0
 11682        IF WS-TOL-SEVERITY NOT = ' '
 11683         GO TO 1360-EDIT-DAYS.
 11684
 11685     IF WS-PMT-TOL = +0
 11686         MOVE CF-CO-TOL-CLAIM    TO WS-PMT-TOL.
 11687
 11688     IF WS-TOL-SEVERITY = ' '
 11689         MOVE CF-CO-CLAIM-REJECT-SW TO WS-TOL-SEVERITY.
 11690
 11691 1360-EDIT-DAYS.
 11692     IF PI-PMTTYPE NOT = '4'
 11693        IF PI-EDAYS NEGATIVE OR
 11694           PI-EPYAMT NEGATIVE
 11695          MOVE ER-0513             TO EMI-ERROR
 11696          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11697          MOVE -1                  TO PMTTYPEL.
 11698
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 220
* EL156.cbl
 11699     IF PI-PMTTYPE = '5' OR '6'
 11700        GO TO 1380-EDIT-EXPENSE-PMT-AMT.
 11701
 11702     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11703        IF PI-PMTTYPE = '4'
 11704          MOVE PI-EDAYS          TO PI-CDAYS.
 11705
 11706     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 11707         GO TO 1440-COMPUTE-LIFE-REMAINING.
 11708
 11709     IF PI-PMTTYPE = '4'
 11710        MOVE PI-EDAYS            TO PI-CDAYS
 11711        GO TO 1400-EDIT-PAYMENT.
 11712
 11713     IF LOW-VALUES = PI-CPYFROM OR PI-CPYTHRU
 11714        GO TO 1500-EDIT-EXPENSES.
 11715
 11716*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11717*       IF CL-CLAIM-TYPE    = PI-AH-OVERRIDE-L1 AND
 11718*          CM-AH-BENEFIT-CD = '23'              AND
 11719*          CL-CERT-STATE    = '04'              AND
 11720*         (PI-PMTTYPE = '1' OR '2' OR '3')
 11721*            PERFORM 3200-CALC-AIG-DAYS THRU 3299-EXIT
 11722*            GO TO 1362-CHECK-MAX-DAYS.
 11723
 11724     IF PI-EDAYS = ZEROS
 11725*        IF PI-COMPANY-ID = 'DMD'
 11726*            MOVE WS-SV-EPYFROM  TO DC-BIN-DATE-1
 11727*            MOVE -1             TO DC-ELAPSED-DAYS
 11728*            MOVE ZEROS          TO DC-ELAPSED-MONTHS
 11729*            MOVE '6'            TO DC-OPTION-CODE
 11730*            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11731*            MOVE DC-BIN-DATE-2  TO DC-BIN-DATE-1
 11732*            MOVE WS-SV-EPYTHRU  TO DC-BIN-DATE-2
 11733*            MOVE '1'            TO DC-OPTION-CODE
 11734*            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11735*            IF NO-CONVERSION-ERROR
 11736*                COMPUTE PI-EDAYS = DC-ELAPSED-MONTHS * 30
 11737*                                 + DC-ODD-DAYS-OVER
 11738*               MOVE 6           TO EDAYSL
 11739*               MOVE AL-UNNON    TO EDAYSA
 11740*            ELSE
 11741*                NEXT SENTENCE
 11742*       ELSE
 11743            MOVE WS-SV-EPYFROM   TO DC-BIN-DATE-1
 11744            MOVE WS-SV-EPYTHRU   TO DC-BIN-DATE-2
 11745            MOVE '1'             TO DC-OPTION-CODE
 11746            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11747            IF NO-CONVERSION-ERROR
 11748                MOVE DC-ELAPSED-DAYS  TO PI-EDAYS
 11749                ADD 1                 TO PI-EDAYS
 11750                MOVE AL-UNNON         TO EDAYSA.
 11751
 11752*    IF PI-COMPANY-ID = 'DMD'
 11753*        MOVE PI-CPYFROM         TO DC-BIN-DATE-1
 11754*        MOVE -1                 TO DC-ELAPSED-DAYS
 11755*        MOVE ZEROS              TO DC-ELAPSED-MONTHS
 11756*        MOVE '6'                TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 221
* EL156.cbl
 11757*        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11758*        MOVE DC-BIN-DATE-2      TO DC-BIN-DATE-1
 11759*        MOVE PI-CPYTHRU         TO DC-BIN-DATE-2
 11760*        MOVE '1'                TO DC-OPTION-CODE
 11761*        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11762*    ELSE
 11763         MOVE PI-CPYFROM         TO DC-BIN-DATE-1.
 11764         MOVE PI-CPYTHRU         TO DC-BIN-DATE-2.
 11765         MOVE '1'                TO DC-OPTION-CODE.
 11766         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11767
 11768     IF NO-CONVERSION-ERROR
 11769        IF PI-COMPANY-ID = 'DMD'
 11770            COMPUTE PI-CDAYS = DC-ELAPSED-MONTHS * 30
 11771                             + DC-ODD-DAYS-OVER
 11772        ELSE
 11773            MOVE DC-ELAPSED-DAYS TO PI-CDAYS
 11774            ADD 1                TO PI-CDAYS.
 11775
 11776     IF DC-ODD-DAYS-OVER NOT = ZEROS
 11777        MOVE DC-ELAPSED-MONTHS   TO EXPENSE-MONTH-SAVE
 11778        ADD 1                    TO EXPENSE-MONTH-SAVE.
 11779
 11780     IF PI-EDAYS NOT NUMERIC
 11781         MOVE ER-0491            TO EMI-ERROR
 11782         GO TO 1370-DAYS-ERROR.
 11783
 11784     IF CL-NO-OF-PMTS-MADE = 0
 11785        AND (PI-COMPANY-ID = 'CID' OR 'AHL')
 11786        AND CL-CERT-STATE = 'MI'
 11787        AND (CM-AH-BENEFIT-CD = '20' OR '21' OR '22' OR '23')
 11788            PERFORM 1390-CHECK-PAYMENT-DAYS THRU 1390-EXIT
 11789     END-IF.
 11790
 11791 1362-CHECK-MAX-DAYS.
 11792
 11793     IF WS-MAX-DAYS-TOL = +999
 11794         GO TO 1365-SKIP-MAX-DAYS-EDIT.
 11795
 11796     IF PI-COMPANY-ID = 'HER' OR 'KSM'
 11797         IF PI-EDAYS = ZEROS
 11798             COMPUTE WS-PMT-MOS ROUNDED = (PI-CDAYS / +30) + .005
 11799         ELSE
 11800             COMPUTE WS-PMT-MOS ROUNDED = (PI-EDAYS / +30) + .005.
 11801
 11802     IF WS-MAX-DAYS-TOL NOT = ZERO
 11803        IF PI-EDAYS > WS-MAX-DAYS-TOL OR
 11804           PI-CDAYS > WS-MAX-DAYS-TOL
 11805             MOVE ER-0492          TO EMI-ERROR
 11806             GO TO 1370-DAYS-ERROR.
 11807
 11808 1365-SKIP-MAX-DAYS-EDIT.
 11809     IF PI-EDAYS = ZEROS
 11810        GO TO 1400-EDIT-PAYMENT.
 11811
 11812     IF WS-DAYS-TOL NOT = ZERO
 11813        IF ((PI-CDAYS - WS-DAYS-TOL) > PI-EDAYS) OR
 11814           ((PI-CDAYS + WS-DAYS-TOL) < PI-EDAYS)
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 222
* EL156.cbl
 11815                MOVE ER-0493     TO EMI-ERROR
 11816                GO TO 1370-DAYS-ERROR.
 11817
 11818     GO TO 1400-EDIT-PAYMENT.
 11819
 11820 1370-DAYS-ERROR.
 11821     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11822
 11823     IF EMI-MESSAGE-FORMATTED
 11824         MOVE -1                 TO EDAYSL
 11825         MOVE AL-UABON           TO EDAYSA.
 11826
 11827     GO TO 1400-EDIT-PAYMENT.
 11828
 11829 1380-EDIT-EXPENSE-PMT-AMT.
 11830     IF PI-PMTTYPE = '5' OR '6'
 11831         NEXT SENTENCE
 11832     ELSE
 11833         GO TO 1400-EDIT-PAYMENT.
 11834
 11835     IF WS-MAX-EXP-PMT NOT = ZEROS
 11836        IF PI-EPYAMT > WS-MAX-EXP-PMT
 11837            MOVE ER-3529            TO EMI-ERROR
 11838            PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 11839
 11840     GO TO 1500-EDIT-EXPENSES.
 11841
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 223
* EL156.cbl
 11843
 11844 1390-CHECK-PAYMENT-DAYS.
 11845
 11846     IF PI-EDAYS = 0
 11847         MOVE PI-CDAYS TO WS-PD-DAYS
 11848     ELSE
 11849         MOVE PI-EDAYS TO WS-PD-DAYS
 11850     END-IF.
 11851
 11852     IF CM-AH-BENEFIT-CD = '20' OR '21'
 11853         IF WS-PD-DAYS = 14
 11854            GO TO 1390-EXIT
 11855         END-IF
 11856     END-IF.
 11857
 11858     IF PI-COMPANY-ID = 'AHL'  AND
 11859        CM-AH-BENEFIT-CD = '1K'
 11860         IF WS-PD-DAYS = 14
 11861            GO TO 1390-EXIT
 11862         END-IF
 11863     END-IF.
 11864
 11865     IF WS-PD-DAYS < 30
 11866         MOVE ER-3549              TO EMI-ERROR
 11867         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11868     END-IF.
 11869
 11870 1390-EXIT.
 11871      EXIT.
 11872
 11873 1400-EDIT-PAYMENT.
 11874*    IF PI-COMPANY-ID = 'DMD'
 11875*       IF CL-CERT-NO (5:2) = '69' OR '70'
 11876*           PERFORM 6500-READ-DLO035 THRU 6500-EXIT.
 11877
 11878     IF PI-COMPANY-ID = 'DCC' or 'VPP'
 11879        MOVE PI-COMPANY-CD       TO ACCT-COMP-CD
 11880        MOVE PI-CARRIER          TO ACCT-CARRIER
 11881        MOVE PI-GROUPING         TO ACCT-GROUPING
 11882        MOVE PI-STATE            TO ACCT-STATE
 11883        MOVE PI-ACCOUNT          TO ACCT-ACCOUNT
 11884        MOVE PI-CERT-EFF-DT      TO ACCT-EXP-DT
 11885        MOVE ERACCT-PARTIAL-KEY  TO WS-ERACCT-SAVE-KEY
 11886        MOVE SPACES              TO WS-ERACCT-HOLD-RECORD
 11887
 11888
 11889* EXEC CICS READ
 11890*          DATASET ('ERACCT')
 11891*          RIDFLD  (ERACCT-KEY)
 11892*          SET     (ADDRESS OF ACCOUNT-MASTER)
 11893*          GTEQ
 11894*          resp    (WS-RESPONSE)
 11895*       END-EXEC
 11896     MOVE 'ERACCT' TO DFHEIV1
 11897*    MOVE '&"S        G          (  N#00011352' TO DFHEIV0
 11898     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 11899     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11900     MOVE X'204E233030303131333532' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 224
* EL156.cbl
 11901     CALL 'kxdfhei1' USING DFHEIV0,
 11902           DFHEIV1,
 11903           DFHEIV20,
 11904           DFHEIV99,
 11905           ERACCT-KEY,
 11906           DFHEIV99,
 11907           DFHEIV99,
 11908           DFHEIV99
 11909     SET ADDRESS OF ACCOUNT-MASTER TO
 11910         DFHEIV20
 11911     MOVE EIBRESP  TO WS-RESPONSE
 11912     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11913        IF WS-RESP-NORMAL
 11914           AND WS-ERACCT-SAVE-KEY = AM-CONTROL-PRIMARY (1:20)
 11915           and pi-cert-eff-dt < am-expiration-dt
 11916           and pi-cert-eff-dt >= am-effective-dt
 11917           move am-dcc-product-code to pi-dcc-product-code
 11918        else
 11919           move spaces           to pi-dcc-product-code
 11920        end-if
 11921        if PI-DCC-PRODUCT-CODE NOT = SPACES
 11922           PERFORM 0900-GET-DDF-LIMITS
 11923                                 THRU 0900-EXIT
 11924           IF PDEF-FOUND
 11925              PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 11926                 (P1 > +8)
 11927                 OR (PD-PROD-CODE (P1) = CL-CLAIM-TYPE)
 11928              END-PERFORM
 11929              IF P1 < +9
 11930                 if pd-ben-pct (p1) not numeric
 11931                    move zeros   to pd-ben-pct (p1)
 11932                 end-if
 11933                 if pd-ben-pct (p1) = zeros
 11934                    move +1      to ws-work-ben-pct
 11935                 else
 11936                    move pd-ben-pct (p1)
 11937                                 to ws-work-ben-pct
 11938                 end-if
 11939                 compute cm-ah-benefit-amt =
 11940                    cm-ah-benefit-amt * ws-work-ben-pct
 11941                 if cm-ah-benefit-amt > pd-max-amt (p1)
 11942                    move pd-max-amt (p1) to cm-ah-benefit-amt
 11943                 end-if
 11944              else
 11945                 move er-1674    to emi-error
 11946                 PERFORM 9900-ERROR-FORMAT
 11947                                 THRU 9900-EXIT
 11948              END-IF
 11949           else
 11950              move er-1672       to emi-error
 11951              PERFORM 9900-ERROR-FORMAT
 11952                                 THRU 9900-EXIT
 11953           END-IF
 11954        end-if
 11955     END-IF
 11956     IF PI-PMTTYPE NOT = '4'
 11957        GO TO 1405-CALC-PAYMENT.
 11958     IF PI-EDAYS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 225
* EL156.cbl
 11959         MOVE PI-EPYAMT           TO PI-CPYAMT
 11960         MOVE SPACES              TO PI-SPECIAL-BEN-SW
 11961         GO TO 1430-CHECK-AH-TOLERANCE.
 11962
 11963*    IF PI-COMPANY-ID = 'FIA'
 11964*       IF CERT-ACCOUNT = '0000011043'
 11965*        COMPUTE PI-DAILY-RATE ROUNDED =
 11966*                      (CM-AH-BENEFIT-AMT * 13) / 365
 11967*        COMPUTE PI-CPYAMT ROUNDED =
 11968*                          PI-DAILY-RATE * PI-EDAYS
 11969*        MOVE SPACES TO PI-SPECIAL-BEN-SW
 11970*        GO TO 1430-CHECK-AH-TOLERANCE.
 11971
 11972     IF WS-CALC-METHOD = '1' OR '4' OR '6'
 11973         COMPUTE PI-DAILY-RATE ROUNDED = CM-AH-BENEFIT-AMT / 30
 11974         COMPUTE PI-CPYAMT     ROUNDED = PI-DAILY-RATE * PI-EDAYS
 11975         GO TO 1420-CHECK-AIG-BENEFIT.
 11976
 11977     IF WS-CALC-METHOD = '2' OR  '5'
 11978         COMPUTE PI-DAILY-RATE ROUNDED =
 11979                        (CM-AH-BENEFIT-AMT * 12) / 365
 11980         COMPUTE PI-CPYAMT ROUNDED =
 11981                           PI-DAILY-RATE * PI-EDAYS
 11982        GO TO 1420-CHECK-AIG-BENEFIT.
 11983
 11984     IF WS-CALC-METHOD = '3'
 11985         COMPUTE PI-DAILY-RATE =
 11986                         (CM-AH-BENEFIT-AMT * 12) / 365
 11987         COMPUTE PI-CPYAMT ROUNDED =
 11988                           PI-DAILY-RATE * PI-EDAYS
 11989        GO TO 1420-CHECK-AIG-BENEFIT.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 226
* EL156.cbl
 11991*    SAMPLE DATE RANGES AND DAYS PAID FOR OPTION 1 AND 6
 11992
 11993****************************************************************
 11994****************************************************************
 11995*                  CALCULATED FROM      PAYMENT      PAYMENT
 11996*   DATES           DATE ROUTINE        OPT  1       OPT  6
 11997* FROM    THRU    MONTHS ODD ELAPSED   DAYS-PAID    DAYS-PAID
 11998*1-01-83  1-15-83    0    15     15        15           15
 11999*1-01-83  1-30-83    0    30     30        30           30
 12000*1-01-83  1-31-83    1     0     31        30           30
 12001*1-01-83  2-01-83    1     1     32        31           31
 12002*1-01-83  2-15-83    1    15     46        45           45
 12003*1-01-83  2-28-83    2     0     59        60           60
 12004*1-01-83  3-01-83    2     1     60        61           61
 12005*1-01-83  3-31-83    3     0     90        90           90
 12006*1-15-83  1-31-83    0    17     17        17           16
 12007*1-15-83  2-01-83    0    18     18        18           17
 12008*1-15-83  2-28-83    1    14     45        44           46
 12009*1-21-83  3-09-83    1    20     48        50           49
 12010*2-05-83  3-06-83    1     2     30        32           32
 12011*2-05-83  3-23-83    1    19     47        49           49
 12012*2-15-83  2-28-83    0    14     14        14           16
 12013*2-15-83  3-01-83    0    15     15        15           17
 12014*2-21-83  3-19-83    0    27     27        27           29
 12015*2-21-83  3-20-83    1     0     28        30           30
 12016*2-21-83  4-10-83    1    18     49        30           50
 12017*2-21-83  5-19-83    2    27     88        87           89
 12018*2-21-83  5-22-83    3     2     91        92           92
 12019*3-21-83  5-19-83    1    30     60        60           59
 12020****************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 227
* EL156.cbl
 12022 1405-CALC-PAYMENT.
 12023     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 12024     MOVE ' '                    TO DC-OPTION-CODE.
 12025     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12026     MOVE DC-DAYS-IN-MONTH       TO FROM-DAYS-IN-MONTH.
 12027     MOVE DC-GREG-DATE-1-MDY     TO WORK-DATE-FROM.
 12028
 12029     MOVE PI-CPYTHRU             TO DC-BIN-DATE-1.
 12030     MOVE ' '                    TO DC-OPTION-CODE.
 12031     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12032     MOVE DC-GREG-DATE-1-MDY     TO WORK-DATE-THRU.
 12033     MOVE DC-DAYS-IN-MONTH       TO THRU-DAYS-IN-MONTH.
 12034
 12035     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 12036     MOVE -1                     TO DC-ELAPSED-DAYS.
 12037     MOVE ZEROS                  TO DC-ELAPSED-MONTHS.
 12038     MOVE '6'                    TO DC-OPTION-CODE.
 12039     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12040     MOVE DC-DAYS-IN-MONTH       TO SAVE1-FROM-DAYS-IN-MONTH.
 12041
 12042     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1.
 12043     MOVE PI-CPYTHRU             TO DC-BIN-DATE-2.
 12044     MOVE '1'                    TO DC-OPTION-CODE.
 12045     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12046
 12047     MOVE DC-ELAPSED-MONTHS      TO SAVE-ELAPSED-MONTHS.
 12048     MOVE DC-ODD-DAYS-OVER       TO SAVE-ODD-DAYS-OVER.
 12049     MOVE DC-ELAPSED-DAYS        TO SAVE-ELAPSED-DAYS.
 12050
 12051******************************************************************
 12052*   THE FOLLOWING STATEMENT ADJUSTS THE ODD DAYS OVER BY THE     *
 12053*     DIFFERENCE BETWEEN DAYS IN MONTH (FROM MONTH) AND          *
 12054*     DAYS IN MONTH (ONE MONTH PRIOR TO THRU MONTH)              *
 12055******************************************************************
 12056
 12057     IF WS-CALC-METHOD = '1'           AND
 12058        DC-ELAPSED-MONTHS > ZERO AND
 12059        DC-ODD-DAYS-OVER NOT = ZEROS   AND
 12060        WDF-DAY > WDT-DAY
 12061          MOVE PI-CPYTHRU          TO DC-BIN-DATE-1
 12062          MOVE ZEROS               TO DC-ELAPSED-DAYS
 12063          MOVE -1                  TO DC-ELAPSED-MONTHS
 12064          MOVE '6'                 TO DC-OPTION-CODE
 12065          PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12066          MOVE DC-DAYS-IN-MONTH    TO SAVE1-THRU-DAYS-IN-MONTH
 12067          COMPUTE WS-SAVE-ODD-DAYS =
 12068          (SAVE1-THRU-DAYS-IN-MONTH - SAVE1-FROM-DAYS-IN-MONTH)
 12069          ADD WS-SAVE-ODD-DAYS     TO SAVE-ODD-DAYS-OVER.
 12070
 12071     MOVE SAVE-ELAPSED-MONTHS    TO DC-ELAPSED-MONTHS.
 12072     MOVE SAVE-ODD-DAYS-OVER     TO DC-ODD-DAYS-OVER
 12073     MOVE SAVE-ELAPSED-DAYS      TO DC-ELAPSED-DAYS.
 12074
 12075     MOVE SAVE-ELAPSED-MONTHS TO PI-SAVE-ELAPSED-MONTHS.
 12076     MOVE SAVE-ODD-DAYS-OVER  TO PI-SAVE-ODD-DAYS-OVER.
 12077
 12078*    IF PI-COMPANY-ID = 'FIA'
 12079*       IF CERT-ACCOUNT = '0000011043'
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 228
* EL156.cbl
 12080*        COMPUTE PI-DAILY-RATE ROUNDED =
 12081*                          (CM-AH-BENEFIT-AMT * 13) / 365
 12082*        COMPUTE PI-CPYAMT ROUNDED =
 12083*                          PI-DAILY-RATE * DC-ELAPSED-DAYS
 12084*        GO TO 1420-CHECK-AIG-BENEFIT.
 12085
 12086*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 12087*       IF CL-CLAIM-TYPE    = PI-AH-OVERRIDE-L1  AND
 12088*          CM-AH-BENEFIT-CD = '23'               AND
 12089*          CL-CERT-STATE    = '04'               AND
 12090*         (PI-PMTTYPE = '1' OR '2' OR '3')
 12091*            COMPUTE WS-DAILY-RATE ROUNDED =
 12092*                               CM-AH-BENEFIT-AMT / 30
 12093*            COMPUTE PI-CPYAMT ROUNDED =
 12094*                               (WS-DAILY-RATE * PI-CDAYS)
 12095*            MOVE WS-DAILY-RATE TO PI-DAILY-RATE
 12096*            GO TO 1420-CHECK-AIG-BENEFIT.
 12097
 12098     IF WS-CALC-METHOD = '1'
 12099         COMPUTE WS-DAILY-RATE ROUNDED = CM-AH-BENEFIT-AMT / 30
 12100         COMPUTE PI-CPYAMT ROUNDED =
 12101             (CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS) +
 12102             (WS-DAILY-RATE     * DC-ODD-DAYS-OVER)
 12103         MOVE WS-DAILY-RATE    TO PI-DAILY-RATE
 12104         GO TO 1420-CHECK-AIG-BENEFIT.
 12105
 12106     IF WS-CALC-METHOD = '2'
 12107         COMPUTE PI-DAILY-RATE ROUNDED =
 12108                          (CM-AH-BENEFIT-AMT * 12) / 365
 12109         COMPUTE PI-CPYAMT ROUNDED =
 12110             (CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS) +
 12111             (PI-DAILY-RATE     * DC-ODD-DAYS-OVER)
 12112         GO TO 1420-CHECK-AIG-BENEFIT.
 12113
 12114     IF WS-CALC-METHOD = '4'
 12115         MOVE CM-AH-BENEFIT-AMT   TO  WS-AH-BEN-AMT
 12116         COMPUTE WS-DAILY-RATE ROUNDED = (WS-AH-BEN-AMT / 30)
 12117         MOVE WS-DAILY-RATE TO PI-DAILY-RATE
 12118         COMPUTE PI-CPYAMT ROUNDED =
 12119                           WS-DAILY-RATE * DC-ELAPSED-DAYS
 12120         GO TO 1420-CHECK-AIG-BENEFIT.
 12121
 12122     IF WS-CALC-METHOD = '5'
 12123         COMPUTE PI-DAILY-RATE ROUNDED =
 12124                            (CM-AH-BENEFIT-AMT * 12) / 365
 12125         COMPUTE PI-CPYAMT ROUNDED =
 12126                           PI-DAILY-RATE * DC-ELAPSED-DAYS
 12127         GO TO 1420-CHECK-AIG-BENEFIT.
 12128
 12129     IF WS-CALC-METHOD NOT = '3'
 12130        GO TO 1410-CHECK-PAYMENT.
 12131
 12132******   CALCULATION METHOD  3  ROUTINE
 12133     COMPUTE PI-DAILY-RATE =
 12134                 CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH.
 12135
 12136******CHECK TO SEE IF WITHIN SAME MONTH
 12137     IF (WDF-MONTH = WDT-MONTH) AND (WDF-YEAR = WDT-YEAR)
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 229
* EL156.cbl
 12138        COMPUTE PI-CPYAMT ROUNDED = SAVE-ELAPSED-DAYS    *
 12139                     (CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH)
 12140         GO TO 1420-CHECK-AIG-BENEFIT.
 12141
 12142******CHECK TO SEE IF EVEN MONTHS AND NO ODD DAYS
 12143     IF SAVE-ELAPSED-MONTHS NOT = ZEROS   AND
 12144             SAVE-ODD-DAYS-OVER = ZEROS
 12145      COMPUTE PI-CPYAMT  ROUNDED =
 12146                  CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS
 12147      GO TO 1420-CHECK-AIG-BENEFIT.
 12148
 12149******BUMP THE FROM DATE WITH THE NUMBER OF MONTHS
 12150******AND FIND THE NUMBER OF DAYS LEFT IN THIS MONTH.
 12151     IF SAVE-ELAPSED-MONTHS NOT = ZERO
 12152        ADD SAVE-ELAPSED-MONTHS  TO WDF-MONTH
 12153        IF WDF-MONTH > 12
 12154           ADD 1                 TO WDF-YEAR
 12155           SUBTRACT 12         FROM WDF-MONTH.
 12156
 12157******CONVERT THE NEW FROM MONTH TO BINARY
 12158     IF SAVE-ELAPSED-MONTHS NOT = ZERO
 12159        MOVE WORK-DATE-FROM   TO DC-GREG-DATE-1-MDY
 12160        MOVE '4'              TO DC-OPTION-CODE
 12161        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12162        MOVE DC-DAYS-IN-MONTH TO FROM-DAYS-IN-MONTH.
 12163
 12164     IF WDF-MONTH = WDT-MONTH AND
 12165        WDF-YEAR  = WDT-YEAR
 12166          COMPUTE PI-CPYAMT ROUNDED = ((WDT-DAY  -  WDF-DAY)  *
 12167                    (CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH)) +
 12168                    (CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS)
 12169        ELSE
 12170          COMPUTE FROM-PMT-DAYS = FROM-DAYS-IN-MONTH - WDF-DAY
 12171          MOVE WDT-DAY              TO THRU-PMT-DAYS
 12172          COMPUTE PI-CPYAMT ROUNDED =
 12173       (FROM-PMT-DAYS * (CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH))
 12174       +
 12175       (THRU-PMT-DAYS * (CM-AH-BENEFIT-AMT / THRU-DAYS-IN-MONTH))
 12176       +
 12177       (CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS).
 12178
 12179     GO TO 1420-CHECK-AIG-BENEFIT.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 230
* EL156.cbl
 12181 1410-CHECK-PAYMENT.
 12182******PAYMENT OPTION 6
 12183******CHECK TO SEE IF LESS THAN 1 MONTH AND WITHIN SAME MONTH
 12184     IF SAVE-ELAPSED-MONTHS > ZERO
 12185        IF SAVE-ODD-DAYS-OVER = ZEROS
 12186           GO TO 1412-CHECK-TO-DAY
 12187        ELSE
 12188           IF WDF-DAY > WDT-DAY
 12189              IF WDF-MONTH = 02
 12190                  PERFORM 1415-CHECK-LEAP-YEAR THRU 1415-EXIT
 12191                  ADD 2  TO  SAVE-ODD-DAYS-OVER
 12192                  GO TO 1412-CHECK-TO-DAY
 12193              ELSE
 12194                  IF FROM-DAYS-IN-MONTH = 31
 12195                     SUBTRACT 1 FROM SAVE-ODD-DAYS-OVER
 12196                     GO TO 1412-CHECK-TO-DAY
 12197                  ELSE
 12198                     GO TO 1412-CHECK-TO-DAY
 12199           ELSE
 12200               GO TO 1412-CHECK-TO-DAY.
 12201
 12202     IF WDF-MONTH NOT = WDT-MONTH
 12203        IF WDF-MONTH = 02
 12204           PERFORM 1415-CHECK-LEAP-YEAR THRU 1415-EXIT
 12205           IF WDF-DAY = 29
 12206              ADD 1              TO SAVE-ODD-DAYS-OVER
 12207           ELSE
 12208              ADD 2              TO SAVE-ODD-DAYS-OVER
 12209        ELSE
 12210           IF FROM-DAYS-IN-MONTH = 31
 12211              SUBTRACT 1         FROM SAVE-ODD-DAYS-OVER.
 12212
 12213 1412-CHECK-TO-DAY.
 12214        IF WDT-MONTH = 02 AND SAVE-ODD-DAYS-OVER NOT = 0
 12215           IF WDT-DAY = 28
 12216              ADD 2              TO SAVE-ODD-DAYS-OVER
 12217           ELSE
 12218              IF WDT-DAY = 29
 12219                 ADD 1           TO SAVE-ODD-DAYS-OVER
 12220              ELSE
 12221                 NEXT SENTENCE
 12222        ELSE
 12223           IF WDT-DAY = 31 AND SAVE-ODD-DAYS-OVER NOT = 0
 12224              SUBTRACT 1         FROM SAVE-ODD-DAYS-OVER.
 12225
 12226     COMPUTE WS-DAILY-RATE ROUNDED = CM-AH-BENEFIT-AMT / 30.
 12227     MOVE WS-DAILY-RATE          TO PI-DAILY-RATE.
 12228     COMPUTE PI-CPYAMT ROUNDED =
 12229         (CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS) +
 12230         (WS-DAILY-RATE     * SAVE-ODD-DAYS-OVER).
 12231
 12232     GO TO 1420-CHECK-AIG-BENEFIT.
 12233
 12234 1415-CHECK-LEAP-YEAR.
 12235     IF FROM-DAYS-IN-MONTH = 29
 12236        SUBTRACT 1 FROM SAVE-ODD-DAYS-OVER.
 12237
 12238 1415-EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 231
* EL156.cbl
 12239     EXIT.
 12240
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 232
* EL156.cbl
 12242 1420-CHECK-AIG-BENEFIT.
 12243
 12244     IF WS-SPECIAL-CALC-CD = 'Q'
 12245         GO TO 1425-CHECK-WHOLE-MONTH.
 12246
 12247*    IF (PI-COMPANY-ID = 'AIG' OR 'AUK')   AND
 12248*       (CM-AH-BENEFIT-CD = '63' OR '66')  AND
 12249*       (CL-NO-OF-PMTS-MADE < +6)          AND
 12250*       (PI-PMTTYPE = '1' OR '2')
 12251*        NEXT SENTENCE
 12252*    ELSE
 12253         MOVE SPACES TO PI-SPECIAL-BEN-SW.
 12254         GO TO 1430-CHECK-AH-TOLERANCE.
 12255
 12256******************AIG LOGIC STARTS**********************
 12257*    MOVE 'Y'          TO PI-SPECIAL-BEN-SW.
 12258*    COMPUTE PI-CPYAMT = PI-CPYAMT * 1.5.
 12259*    MOVE ER-3533      TO EMI-ERROR.
 12260*    PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 12261*    GO TO 1430-CHECK-AH-TOLERANCE.
 12262******************AIG LOGIC ENDS************************
 12263
 12264 1425-CHECK-WHOLE-MONTH.
 12265******************************************************************
 12266****    THIS PARAGRAPH COMPUTES THE 1ST PAYMENT FOR WHOLE     ****
 12267****    MONTH DISABILITY CLAIMS.  THE PROCESS IS AS FOLLOWS:  ****
 12268****      1.  IF THE PERIOD BEING PAID IS THE RETRO PERIOD    ****
 12269****          A WHOLE MONTHS BENEFIT IS PAID.                 ****
 12270****      2.  IF MORE THAN THE RETRO PERIOD IS BEING PAID THE ****
 12271****          ADDITIONAL DAYS MUST BE IN WHOLE CALENDAR       ****
 12272****          MONTHS.  PAYMENT = 1 MONTH (RETRO               ****
 12273****          PERIOD) + NUMBER OF ADDITIONAL MONTHS BEING     ****
 12274****          PAID * MONTHLY BENEFIT.                         ****
 12275******************************************************************
 12276
 12277     MOVE SPACES                     TO  PI-SPECIAL-BEN-SW.
 12278
 12279     IF CL-NO-OF-PMTS-MADE > +0
 12280         GO TO 1425-CONT-WHOLE-MONTH-PMTS.
 12281
 12282     IF PI-CDAYS < WS-BEN-DAYS
 12283         GO TO 1430-CHECK-AH-TOLERANCE.
 12284
 12285     IF PI-CDAYS = WS-BEN-DAYS
 12286         MOVE CM-AH-BENEFIT-AMT      TO  PI-CPYAMT
 12287         GO TO 1430-CHECK-AH-TOLERANCE.
 12288
 12289*    IF PI-COMPANY-ID = 'ACM'
 12290*       NEXT SENTENCE
 12291*    ELSE
 12292        GO TO 1425-NOT-ACM-W15C.
 12293
 12294*    MOVE PI-CPYFROM             TO  DC-BIN-DATE-1.
 12295*    MOVE -1                     TO  DC-ELAPSED-DAYS.
 12296*    MOVE +0                     TO  DC-ELAPSED-MONTHS.
 12297*    MOVE '6'                    TO  DC-OPTION-CODE.
 12298*    PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12299*    IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 233
* EL156.cbl
 12300*       MOVE DC-BIN-DATE-2       TO  DC-BIN-DATE-1
 12301*       MOVE PI-CPYTHRU          TO  DC-BIN-DATE-2
 12302*       MOVE '1'                 TO  DC-OPTION-CODE
 12303*       MOVE +0                  TO  DC-ELAPSED-DAYS
 12304*       MOVE +0                  TO  DC-ELAPSED-MONTHS
 12305*       PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12306*       IF NO-CONVERSION-ERROR
 12307*          IF (DC-ELAPSED-MONTHS > +0) OR
 12308*             (DC-ELAPSED-DAYS NOT < WS-BEN-DAYS)
 12309*             NEXT SENTENCE
 12310*          ELSE
 12311*             MOVE +0            TO  PI-CPYAMT
 12312*             MOVE ER-0846       TO  EMI-ERROR
 12313*             PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12314*             GO TO 1430-CHECK-AH-TOLERANCE
 12315*       ELSE
 12316*           MOVE ER-0846         TO  EMI-ERROR
 12317*           PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12318*           GO TO 1430-CHECK-AH-TOLERANCE.
 12319*
 12320*    IF DC-ODD-DAYS-OVER NOT < WS-BEN-DAYS
 12321*       ADD +1 TO DC-ELAPSED-MONTHS.
 12322*
 12323*    COMPUTE PI-CPYAMT ROUNDED =
 12324*                CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS.
 12325*
 12326*    GO TO 1430-CHECK-AH-TOLERANCE.
 12327
 12328 1425-NOT-ACM-W15C.
 12329
 12330     MOVE PI-CPYFROM                 TO  DC-BIN-DATE-1.
 12331     MOVE '6'                        TO  DC-OPTION-CODE.
 12332     MOVE +0                         TO  DC-ELAPSED-MONTHS.
 12333     COMPUTE DC-ELAPSED-DAYS = WS-BEN-DAYS - 1.
 12334
 12335     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12336     IF NO-CONVERSION-ERROR
 12337         MOVE DC-BIN-DATE-2          TO  DC-BIN-DATE-1
 12338     ELSE
 12339         MOVE ER-0846                TO  EMI-ERROR
 12340         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12341         GO TO 1430-CHECK-AH-TOLERANCE.
 12342
 12343     MOVE PI-CPYTHRU                 TO  DC-BIN-DATE-2.
 12344     MOVE '1'                        TO  DC-OPTION-CODE.
 12345     MOVE +0                         TO  DC-ELAPSED-MONTHS.
 12346     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12347     IF NO-CONVERSION-ERROR
 12348         IF DC-ODD-DAYS-OVER = +0
 12349             NEXT SENTENCE
 12350         ELSE
 12351             MOVE ER-0846            TO  EMI-ERROR
 12352             PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12353             GO TO 1430-CHECK-AH-TOLERANCE
 12354     ELSE
 12355         MOVE ER-0846                TO  EMI-ERROR
 12356         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12357         GO TO 1430-CHECK-AH-TOLERANCE.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 234
* EL156.cbl
 12358
 12359     COMPUTE PI-CPYAMT ROUNDED = CM-AH-BENEFIT-AMT +
 12360         (CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS).
 12361
 12362     GO TO 1430-CHECK-AH-TOLERANCE.
 12363
 12364 1425-CONT-WHOLE-MONTH-PMTS.
 12365******************************************************************
 12366****    WHOLE MONTH DISABILITY EDIT.  IN ORDER TO QUALIFY     ****
 12367****    FOR A PAYMENT TO BE MADE THE PAYMENT PERIOD MUST      ****
 12368****    BE IN CALENDAR MONTH INCREMENTS.                      ****
 12369******************************************************************
 12370
 12371     IF PI-COMPANY-ID = 'ACM'
 12372        NEXT SENTENCE
 12373     ELSE
 12374        IF DC-ODD-DAYS-OVER = +0
 12375            NEXT SENTENCE
 12376        ELSE
 12377            MOVE ER-0845            TO  EMI-ERROR
 12378            PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12379            GO TO 1430-CHECK-AH-TOLERANCE.
 12380
 12381     COMPUTE PI-CPYAMT ROUNDED =
 12382                CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS.
 12383
 12384 1430-CHECK-AH-TOLERANCE.
 12385     IF PI-PMT-APPR-SW = 'G'
 12386         GO TO 1430-CONT-CHECK-AH-TOLERANCE.
 12387
 12388*    IF PI-COMPANY-ID = 'HER' OR 'KSM'
 12389*        COMPUTE WS-MAX-PMT-TOL = WS-MAX-PMT-TOL * WS-PMT-MOS
 12390*        MOVE WS-MAX-PMT-TOL         TO  PI-MAX-PMT-TOL.
 12391*
 12392*    IF PI-COMPANY-ID = 'HER' OR 'KSM'
 12393*      IF WDF-MONTH = 02
 12394*        IF SAVE-ELAPSED-MONTHS = 0
 12395*          NEXT SENTENCE
 12396*        ELSE
 12397*          IF SAVE-ODD-DAYS-OVER > 0
 12398*            MOVE +0                     TO  WS-MAX-PMT-TOL
 12399*            COMPUTE WS-PMT-MOS ROUNDED =
 12400*                (SAVE-ODD-DAYS-OVER / +30) + .005
 12401*            COMPUTE WS-MAX-PMT-TOL = WS-HER-MO-PMT-AMT *
 12402*                                     WS-PMT-MOS
 12403*            COMPUTE WS-MAX-PMT-TOL = WS-MAX-PMT-TOL +
 12404*                (WS-HER-MO-PMT-AMT * SAVE-ELAPSED-MONTHS)
 12405*          ELSE
 12406*            MOVE +0                     TO  WS-MAX-PMT-TOL
 12407*            MOVE SAVE-ELAPSED-MONTHS    TO  WS-PMT-MOS
 12408*            COMPUTE WS-MAX-PMT-TOL = WS-HER-MO-PMT-AMT *
 12409*                                     WS-PMT-MOS.
 12410
 12411     IF WS-MAX-PMT-TOL NOT = ZERO
 12412        IF (PI-EPYAMT > WS-MAX-PMT-TOL) OR
 12413           (PI-CPYAMT > WS-MAX-PMT-TOL)
 12414            MOVE ER-0494         TO  EMI-ERROR
 12415            PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 235
* EL156.cbl
 12416            GO TO 1500-EDIT-EXPENSES.
 12417
 12418 1430-CONT-CHECK-AH-TOLERANCE.
 12419
 12420     IF PI-EPYAMT = ZEROS OR   PI-EPYAMT NEGATIVE
 12421        GO TO 1500-EDIT-EXPENSES.
 12422
 12423     IF CM-O-B-COVERAGE
 12424        GO TO 1500-EDIT-EXPENSES.
 12425
 12426     IF PI-COMPANY-ID = 'NCL'
 12427       IF FOUND-TOL-SW = 'Y'
 12428         IF WS-PMT-TOL NOT = ZERO
 12429           IF ((PI-CPYAMT - WS-PMT-TOL) > PI-EPYAMT) OR
 12430              ((PI-CPYAMT + WS-PMT-TOL) < PI-EPYAMT)
 12431                  MOVE PI-PMTNOTE1 TO WS-NCL-PMT-OPTION
 12432                  IF WS-NCL-PMT-OPTION = SPACES
 12433                      MOVE ER-0699 TO EMI-ERROR
 12434                      PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12435                  ELSE
 12436                  IF WS-NCL-PMT-OPTION ALPHABETIC-UPPER
 12437                      NEXT SENTENCE
 12438                  ELSE
 12439                  IF NOT WS-VALID-NCL-OPTION
 12440                      MOVE ER-0699 TO EMI-ERROR
 12441                      PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 12442
 12443     IF WS-PMT-TOL NOT = ZERO
 12444        IF ((PI-CPYAMT - WS-PMT-TOL) > PI-EPYAMT)
 12445           or ((PI-CPYAMT + WS-PMT-TOL) < PI-EPYAMT)
 12446           MOVE ER-0495          TO EMI-ERROR
 12447           PERFORM 1490-PAYMENT-ERROR
 12448                                 THRU 1490-EXIT
 12449        end-if
 12450     end-if
 12451
 12452     GO TO 1500-EDIT-EXPENSES.
 12453
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 236
* EL156.cbl
 12455 1440-COMPUTE-LIFE-REMAINING.
 12456
 12457     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 12458        IF PI-PMTTYPE = '4'
 12459          MOVE PI-EPYAMT TO PI-CPYAMT
 12460          GO TO 1460-TEST-TYPE.
 12461
 12462     IF WS-LF-COVERAGE-TYPE = 'L'
 12463        COMPUTE PI-CPYAMT = CM-LF-BENEFIT-AMT
 12464                          - CL-TOTAL-PAID-AMT
 12465        GO TO 1450-CHECK-MAX.
 12466
 12467     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 12468        PI-LF-COVERAGE-TYPE = 'P'
 12469          COMPUTE PI-CPYAMT = CM-LF-BENEFIT-AMT -
 12470                              CM-LF-ITD-DEATH-AMT
 12471          GO TO 1450-CHECK-MAX.
 12472
 12473     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 12474     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 12475     MOVE CL-INCURRED-DT         TO CP-VALUATION-DT.
 12476     MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM.
 12477     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 12478     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 12479     MOVE '4'                    TO CP-REM-TERM-METHOD.
 12480     MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD.
 12481     MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD.
 12482
 12483     PERFORM 9800-LINK-REM-TERM.
 12484
 12485     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 12486     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 12487     MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM.
 12488     MOVE CM-LF-BENEFIT-AMT      TO CP-ORIGINAL-BENEFIT.
 12489     MOVE CM-LF-ALT-BENEFIT-AMT  TO CP-ALTERNATE-BENEFIT.
 12490     MOVE CP-REMAINING-TERM-3    TO CP-REMAINING-TERM.
 12491     MOVE CM-LOAN-APR            TO CP-LOAN-APR.
 12492     MOVE CM-LOAN-TERM           TO CP-LOAN-TERM.
 12493     MOVE CM-PAY-FREQUENCY       TO CP-PAY-FREQUENCY.
 12494     MOVE WS-STATE-ABBREV        TO CP-STATE-STD-ABBRV.
 12495     MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD.
 12496     MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD.
 12497     MOVE CM-RATE-CLASS          TO CP-CLASS-CODE
 12498     MOVE CM-LF-BENEFIT-CD       TO CP-BENEFIT-CD.
 12499     MOVE CM-PMT-EXTENSION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 12500     MOVE 'Y'                    TO CP-LF-CLAIM-CALC-SW.
 12501     IF PI-COMPANY-ID = 'DCC' or 'VPP'
 12502        MOVE PI-COMPANY-CD       TO ACCT-COMP-CD
 12503        MOVE PI-CARRIER          TO ACCT-CARRIER
 12504        MOVE PI-GROUPING         TO ACCT-GROUPING
 12505        MOVE PI-STATE            TO ACCT-STATE
 12506        MOVE PI-ACCOUNT          TO ACCT-ACCOUNT
 12507        MOVE PI-CERT-EFF-DT      TO ACCT-EXP-DT
 12508        MOVE ERACCT-PARTIAL-KEY  TO WS-ERACCT-SAVE-KEY
 12509        MOVE SPACES              TO WS-ERACCT-HOLD-RECORD
 12510
 12511
 12512* EXEC CICS READ
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 237
* EL156.cbl
 12513*          DATASET ('ERACCT')
 12514*          RIDFLD  (ERACCT-KEY)
 12515*          SET     (ADDRESS OF ACCOUNT-MASTER)
 12516*          GTEQ
 12517*          resp    (WS-RESPONSE)
 12518*       END-EXEC
 12519     MOVE 'ERACCT' TO DFHEIV1
 12520*    MOVE '&"S        G          (  N#00011957' TO DFHEIV0
 12521     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 12522     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12523     MOVE X'204E233030303131393537' TO DFHEIV0(25:11)
 12524     CALL 'kxdfhei1' USING DFHEIV0,
 12525           DFHEIV1,
 12526           DFHEIV20,
 12527           DFHEIV99,
 12528           ERACCT-KEY,
 12529           DFHEIV99,
 12530           DFHEIV99,
 12531           DFHEIV99
 12532     SET ADDRESS OF ACCOUNT-MASTER TO
 12533         DFHEIV20
 12534     MOVE EIBRESP  TO WS-RESPONSE
 12535     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12536        IF WS-RESP-NORMAL
 12537           AND (WS-ERACCT-SAVE-KEY = AM-CONTROL-PRIMARY (1:20))
 12538           and (pi-cert-eff-dt < am-expiration-dt)
 12539           and (pi-cert-eff-dt >= am-effective-dt)
 12540           move am-dcc-product-code to pi-dcc-product-code
 12541        else
 12542           move spaces           to pi-dcc-product-code
 12543        end-if
 12544        if pi-dcc-product-code not = spaces
 12545           move cm-ah-benefit-cd to pi-ah-benefit-cd
 12546           move cm-lf-benefit-cd to pi-lf-benefit-cd
 12547           PERFORM 0900-GET-DDF-limits
 12548                                 THRU 0900-EXIT
 12549           IF PDEF-FOUND
 12550              PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 12551                 (P1 > +8)
 12552                 OR (PD-PROD-CODE (P1) = 'L')
 12553              END-PERFORM
 12554              IF P1 < +9
 12555                 MOVE PD-MAX-AMT (P1)
 12556                                 TO CP-R-MAX-TOT-BEN
 12557              else
 12558                 move er-1674    to emi-error
 12559                 PERFORM 9900-ERROR-FORMAT
 12560                                 THRU 9900-EXIT
 12561              END-IF
 12562           else
 12563              move er-1672       to emi-error
 12564              PERFORM 9900-ERROR-FORMAT
 12565                                 THRU 9900-EXIT
 12566           END-IF
 12567        end-if
 12568     END-IF
 12569
 12570* EXEC CICS LINK
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 238
* EL156.cbl
 12571*       PROGRAM  (LINK-REMAMT)
 12572*       COMMAREA (CALCULATION-PASS-AREA)
 12573*       LENGTH   (CP-COMM-LENGTH)
 12574*    END-EXEC.
 12575*    MOVE '."C                   (   #00011997' TO DFHEIV0
 12576     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 12577     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12578     MOVE X'2020233030303131393937' TO DFHEIV0(25:11)
 12579     CALL 'kxdfhei1' USING DFHEIV0,
 12580           LINK-REMAMT,
 12581           CALCULATION-PASS-AREA,
 12582           CP-COMM-LENGTH,
 12583           DFHEIV99,
 12584           DFHEIV99,
 12585           DFHEIV99,
 12586           DFHEIV99
 12587     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12588
 12589
 12590     COMPUTE PI-CPYAMT = CP-REMAINING-AMT - CL-TOTAL-PAID-AMT.
 12591
 12592     MOVE ' '                    TO CP-LF-CLAIM-CALC-SW.
 12593     MOVE CP-SCNP-6MO-AMT        TO PI-MO-BEN-AMT.
 12594
 12595     IF PI-COMPANY-ID = 'BOA' AND
 12596        PI-PMTTYPE    = '2'   AND
 12597        PI-OFFLINE    = 'N'
 12598           GO TO 1441-COMPUTE-BOA-INTEREST.
 12599
 12600     IF PI-COMPANY-ID = 'NCL' AND
 12601        PI-PMTTYPE    = '2'   AND
 12602        PI-OFFLINE    = 'N'
 12603          GO TO 1442-COMPUTE-NCL-INTEREST
 12604       ELSE
 12605          GO TO 1445-CONTINUE.
 12606
 12607 1441-COMPUTE-BOA-INTEREST.
 12608     MOVE +0             TO WS-CALC-INT.
 12609
 12610     MOVE CL-INCURRED-DT TO DC-BIN-DATE-1.
 12611     MOVE WS-TODAY-DATE  TO DC-BIN-DATE-2.
 12612     MOVE +0             TO DC-ELAPSED-MONTHS
 12613                            DC-ELAPSED-DAYS.
 12614     MOVE '1'            TO DC-OPTION-CODE.
 12615     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12616     IF NO-CONVERSION-ERROR
 12617         NEXT SENTENCE
 12618     ELSE
 12619         GO TO 1445-CONTINUE.
 12620
 12621     IF (PI-INT-RATE NOT > ZEROS)  AND
 12622        (DC-ELAPSED-DAYS > +30)
 12623         MOVE ER-3531            TO EMI-ERROR
 12624         MOVE -1                 TO PINTL
 12625         MOVE AL-UNBON           TO PINTA
 12626         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12627
 12628     IF PI-EPYAMT NOT > ZEROS
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 239
* EL156.cbl
 12629         GO TO 1445-CONTINUE.
 12630
 12631     IF (PI-INT-RATE NOT > ZEROS)  OR
 12632        (DC-ELAPSED-DAYS NOT > +30)
 12633         MOVE PI-EPYAMT TO PI-CPYAMT
 12634         GO TO 1441-FORMAT-NOTE.
 12635
 12636     COMPUTE WS-CALC-INT ROUNDED =  PI-EPYAMT
 12637                                 *  PI-INT-RATE
 12638                                 *  DC-ELAPSED-DAYS
 12639                                 /  365
 12640                                 /  100.
 12641
 12642     COMPUTE PI-CPYAMT = PI-EPYAMT + WS-CALC-INT.
 12643
 12644 1441-FORMAT-NOTE.
 12645
 12646     MOVE SPACES        TO WS-BOANOTE1.
 12647     MOVE 'BENEFIT -  ' TO WS-BOANOTE1-DESC.
 12648     MOVE PI-EPYAMT     TO WS-BOANOTE1-EPYAMT.
 12649     MOVE WS-BOANOTE1   TO WS-PMTNOTE1 PI-PMTNOTE1 NOTE1I.
 12650     MOVE AL-UANON      TO NOTE1A.
 12651
 12652     IF WS-CALC-INT > ZEROS
 12653         MOVE SPACES        TO WS-BOANOTE2
 12654         MOVE 'INTEREST - ' TO WS-BOANOTE2-DESC
 12655         MOVE WS-CALC-INT   TO WS-BOANOTE2-INT
 12656         MOVE WS-BOANOTE2   TO WS-PMTNOTE2 PI-PMTNOTE2 NOTE2I
 12657         MOVE AL-UANON      TO NOTE2A.
 12658
 12659     GO TO 1445-CONTINUE.
 12660
 12661 1442-COMPUTE-NCL-INTEREST.
 12662     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 12663     MOVE PI-STATE               TO WS-ST-ACCESS.
 12664     MOVE WS-STATE-ACCESS        TO CNTL-ACCESS.
 12665     MOVE '3'                    TO CNTL-REC-TYPE.
 12666     MOVE +0                     TO CNTL-SEQ-NO.
 12667     MOVE 'STAT'                 TO FILE-SWITCH.
 12668
 12669     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 12670
 12671     MOVE +0                 TO WS-CALC-INT.
 12672
 12673     IF ST-STAT-FROM-INCURRED
 12674         MOVE CL-INCURRED-DT TO WS-COMPUTE-FROM-DT
 12675       ELSE
 12676     IF ST-STAT-FROM-REPORTED
 12677         MOVE CL-REPORTED-DT TO WS-COMPUTE-FROM-DT
 12678       ELSE
 12679         GO TO 1445-CONTINUE.
 12680
 12681     MOVE WS-COMPUTE-FROM-DT TO DC-BIN-DATE-1.
 12682     MOVE WS-TODAY-DATE      TO DC-BIN-DATE-2.
 12683     MOVE +0                 TO DC-ELAPSED-MONTHS
 12684                                DC-ELAPSED-DAYS.
 12685     MOVE '1'                TO DC-OPTION-CODE.
 12686     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 240
* EL156.cbl
 12687     IF NO-CONVERSION-ERROR
 12688         NEXT SENTENCE
 12689     ELSE
 12690         GO TO 1445-CONTINUE.
 12691
 12692     IF (CF-ST-STAT-INTEREST NOT > ZEROS) OR
 12693        (DC-ELAPSED-DAYS NOT > CF-ST-NO-DAYS-ELAPSED)
 12694         GO TO 1445-CONTINUE.
 12695
 12696     COMPUTE WS-CALC-INT ROUNDED =  PI-CPYAMT
 12697                                 *  CF-ST-STAT-INTEREST.
 12698
 12699     MOVE SPACES              TO WS-NCLNOTE1.
 12700     MOVE 'BENEFIT -  '       TO WS-NCLNOTE1-DESC.
 12701     MOVE PI-CPYAMT           TO WS-NCLNOTE1-CPYAMT.
 12702     MOVE WS-NCLNOTE1         TO WS-PMTNOTE1
 12703                                 PI-PMTNOTE1
 12704                                 NOTE1I.
 12705     MOVE AL-UANON            TO NOTE1A.
 12706
 12707     IF WS-CALC-INT > ZEROS
 12708         MOVE SPACES          TO WS-NCLNOTE2
 12709         MOVE 'INTEREST - '   TO WS-NCLNOTE2-DESC
 12710         MOVE WS-CALC-INT     TO WS-NCLNOTE2-INT
 12711         MOVE WS-NCLNOTE2     TO WS-PMTNOTE2
 12712                                 PI-PMTNOTE2
 12713                                 NOTE2I
 12714         MOVE AL-UANON        TO NOTE2A.
 12715
 12716     COMPUTE PI-CPYAMT = PI-CPYAMT + WS-CALC-INT.
 12717
 12718 1445-CONTINUE.
 12719
 12720     IF PI-EPYAMT = ZEROS OR PI-PMTTYPE = '4'
 12721        GO TO 1460-TEST-TYPE.
 12722
 12723     IF CM-O-B-COVERAGE
 12724        GO TO 1460-TEST-TYPE.
 12725
 12726     IF PI-COMPANY-ID = 'BOA' OR 'NCL'
 12727         GO TO 1450-CHECK-MAX.
 12728
 12729     if (pi-company-id = 'DCC' or 'VPP')
 12730        and (pdef-found)
 12731        if pi-epyamt > pd-max-amt (p1)
 12732           move er-1657          to emi-error
 12733           perform 1490-payment-error
 12734                                 thru 1490-exit
 12735           go to 1460-test-type
 12736        end-if
 12737     else
 12738        IF (PI-CPYAMT - (CP-REMAINING-AMT-PRV - CP-REMAINING-AMT)
 12739           > PI-EPYAMT)
 12740                         OR
 12741           (PI-CPYAMT + (CP-REMAINING-AMT-PRV - CP-REMAINING-AMT)
 12742           < PI-EPYAMT)
 12743           MOVE ER-0594          TO EMI-ERROR
 12744           PERFORM 1490-PAYMENT-ERROR
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 241
* EL156.cbl
 12745                                 THRU 1490-EXIT
 12746           GO TO 1460-TEST-TYPE
 12747        end-if
 12748     end-if
 12749     .
 12750 1450-CHECK-MAX.
 12751
 12752     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 12753        PI-LF-COVERAGE-TYPE = 'P'
 12754         COMPUTE WS-BEN-AMT-LEFT = CM-LF-BENEFIT-AMT -
 12755                                   CM-LF-ITD-DEATH-AMT
 12756     ELSE
 12757         COMPUTE WS-BEN-AMT-LEFT = CM-LF-BENEFIT-AMT -
 12758                                   CL-TOTAL-PAID-AMT.
 12759
 12760     IF PI-EPYAMT > WS-BEN-AMT-LEFT
 12761          MOVE ER-0543           TO EMI-ERROR
 12762          PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 12763
 12764 1460-TEST-TYPE.
 12765
 12766     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 12767        IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 12768           COMPUTE WS-LF-BEN-AMT = CM-LF-BENEFIT-AMT +
 12769                                   CM-LF-ALT-BENEFIT-AMT -
 12770                                   CL-TOTAL-PAID-AMT
 12771           IF PI-EPYAMT > WS-LF-BEN-AMT
 12772               MOVE ER-0543      TO EMI-ERROR
 12773               PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12774           END-IF
 12775        END-IF
 12776     END-IF
 12777
 12778     IF PI-PMT-APPR-SW = 'G'
 12779       NEXT SENTENCE
 12780     ELSE
 12781       IF WS-MAX-LF-PMT-TOL NOT = ZERO
 12782         IF PI-EPYAMT = ZERO
 12783             IF PI-CPYAMT > WS-MAX-LF-PMT-TOL
 12784                 MOVE ER-0494    TO  EMI-ERROR
 12785                 PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12786                 GO TO 1500-EDIT-EXPENSES
 12787             ELSE
 12788                 NEXT SENTENCE
 12789         ELSE
 12790             IF PI-EPYAMT > WS-MAX-LF-PMT-TOL
 12791                 MOVE ER-0494    TO  EMI-ERROR
 12792                 PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12793                 GO TO 1500-EDIT-EXPENSES.
 12794
 12795     IF PI-PMTTYPE NOT = '2' OR
 12796        (WS-LF-COVERAGE-TYPE = 'L' OR 'P')
 12797         GO TO 1500-EDIT-EXPENSES.
 12798
 12799     MOVE CP-REMAINING-AMT-PRV   TO WS-EDIT-PATTERN.
 12800     MOVE ER-0526                TO EMI-ERROR.
 12801     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12802
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 242
* EL156.cbl
 12803     IF EMI-ERROR-NUMBER (1) = '0526'
 12804        MOVE WS-EDIT             TO EMI-TEXT-VARIABLE (1).
 12805
 12806     IF EMI-ERROR-NUMBER (2) = '0526'
 12807        MOVE WS-EDIT             TO EMI-TEXT-VARIABLE (2).
 12808
 12809     GO TO 1500-EDIT-EXPENSES.
 12810
 12811 1490-PAYMENT-ERROR.
 12812     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12813
 12814     IF EMI-MESSAGE-FORMATTED
 12815         MOVE -1                 TO EPYAMTL
 12816         MOVE AL-UNBON           TO EPYAMTA.
 12817
 12818 1490-EXIT.
 12819      EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 243
* EL156.cbl
 12821 1500-EDIT-EXPENSES.
 12822     IF PI-COMPANY-ID = 'MET' OR 'AIG' OR 'AUK' OR 'DMD'
 12823         GO TO 1500-SKIP-ERROR-0556.
 12824
 12825 1500-CONTINUE-ON.
 12826
 12827     IF CM-O-B-COVERAGE
 12828        MOVE ER-0556             TO EMI-ERROR
 12829        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12830
 12831 1500-SKIP-ERROR-0556.
 12832     IF PI-PMTTYPE = '4' OR '5' OR '6'
 12833        IF PI-EEXPENS NOT = ZEROS
 12834           MOVE ER-0524          TO EMI-ERROR
 12835           GO TO 1590-EXPENSE-ERROR
 12836        ELSE
 12837           GO TO 1600-EDIT-RESERVES.
 12838
 12839     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 12840     MOVE '6'                    TO CNTL-REC-TYPE.
 12841
 12842     IF CONTROL-IS-ACTUAL-CARRIER
 12843         MOVE PI-CARRIER         TO WS-CARR
 12844     ELSE
 12845         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 12846
 12847     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 12848     MOVE +0                     TO CNTL-SEQ-NO.
 12849     MOVE 'CARR'                 TO FILE-SWITCH.
 12850
 12851     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 12852
 12853     IF EXPENSE-CALC-MANUAL
 12854        GO TO 1600-EDIT-RESERVES.
 12855
 12856     IF DOLLARS-PER-PMT
 12857        MOVE CF-EXPENSE-DOLLAR   TO PI-CEXPENS
 12858        GO TO 1600-EDIT-RESERVES.
 12859
 12860     IF DOLLARS-PER-MONTH AND
 12861        (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F')
 12862       COMPUTE PI-CEXPENS = CF-EXPENSE-DOLLAR * EXPENSE-MONTH-SAVE
 12863       GO TO 1600-EDIT-RESERVES.
 12864
 12865     IF PERCENT-OF-PAYMENT
 12866        COMPUTE PI-CEXPENS = PI-CPYAMT * CF-EXPENSE-PERCENT.
 12867
 12868     GO TO 1600-EDIT-RESERVES.
 12869
 12870 1590-EXPENSE-ERROR.
 12871     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12872
 12873     IF EMI-MESSAGE-FORMATTED
 12874        MOVE -1                  TO EEXPENSL
 12875        MOVE AL-UNBON            TO EEXPENSA.
 12876
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 244
* EL156.cbl
 12878 1600-EDIT-RESERVES.
 12879     IF PI-PMTTYPE = '4' OR '5' OR '6'
 12880        IF PI-ERESV = ZEROS
 12881           GO TO 1700-EDIT-EXPENSE-TYPE
 12882        ELSE
 12883           MOVE ER-0525          TO EMI-ERROR
 12884           PERFORM 1690-RESERVE-ERROR THRU 1690-EXIT
 12885           GO TO 1700-EDIT-EXPENSE-TYPE.
 12886
 12887     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 12888     MOVE ZEROS                  TO TRLR-SEQ-NO.
 12889     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 12890
 12891     IF NOT AT-MANUAL-RESERVES-USED
 12892        IF PI-ERESV NOT = ZEROS
 12893           MOVE ER-0518          TO EMI-ERROR
 12894           PERFORM 1690-RESERVE-ERROR THRU 1690-EXIT.
 12895
 12896     IF AT-MANUAL-RESERVES-USED
 12897        MOVE AT-CURRENT-MANUAL-RESERVE  TO PI-CRESV
 12898        GO TO 1700-EDIT-EXPENSE-TYPE.
 12899
 12900     IF AT-FUTURE-RESERVES-USED
 12901        ADD AT-CURRENT-MANUAL-RESERVE   TO WS-RESERVE-WORK.
 12902
 12903     IF AT-FUTURE-RESERVES-USED
 12904        ADD AT-FUTURE-RESERVE    TO WS-RESERVE-WORK.
 12905
 12906     IF AT-PAY-TO-CURRENT-USED OR AT-LF-PTC-USED
 12907        ADD AT-PAY-CURRENT-RESERVE TO WS-RESERVE-WORK.
 12908
 12909     IF AT-IBNR-RESERVES-USED
 12910        ADD AT-IBNR-RESERVE      TO WS-RESERVE-WORK.
 12911
 12912     MOVE WS-RESERVE-WORK        TO PI-CRESV.
 12913     GO TO 1700-EDIT-EXPENSE-TYPE.
 12914
 12915 1690-RESERVE-ERROR.
 12916     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12917
 12918     IF EMI-MESSAGE-FORMATTED
 12919        MOVE AL-UNBON            TO ERESVA
 12920        MOVE -1                  TO ERESVL.
 12921
 12922 1690-EXIT.
 12923      EXIT.
 12924
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 245
* EL156.cbl
 12926 1700-EDIT-EXPENSE-TYPE.
 12927     IF PI-PMTTYPE NOT = '5' AND '6'
 12928        GO TO 2000-EDIT-DONE.
 12929
 12930     IF PI-ETYPE = ' ' OR '1' OR '2' OR '3' OR '4' OR '5' OR
 12931                   '6' OR '7' OR '8' OR '9'
 12932        GO TO 2000-EDIT-DONE.
 12933
 12934 1705-EXPENSE-ERROR.
 12935     MOVE ER-0573                TO EMI-ERROR.
 12936     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12937
 12938     IF EMI-MESSAGE-FORMATTED
 12939        MOVE AL-UABON            TO ETYPEA
 12940        MOVE -1                  TO ETYPEL.
 12941
 12942     GO TO 2000-EDIT-DONE.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 246
* EL156.cbl
 12944 1950-NOT-FOUND.
 12945     IF FILE-SWITCH = 'MSTR'
 12946        MOVE ER-0204             TO EMI-ERROR.
 12947
 12948     IF FILE-SWITCH = 'CARR'
 12949        MOVE ER-0252             TO EMI-ERROR.
 12950
 12951     IF FILE-SWITCH = 'COMP'
 12952        MOVE ER-0254             TO EMI-ERROR.
 12953
 12954     IF FILE-SWITCH = 'STAT'
 12955        MOVE ER-0149             TO EMI-ERROR.
 12956
 12957     IF FILE-SWITCH = 'PROC'
 12958        MOVE ER-0019             TO EMI-ERROR.
 12959
 12960     IF FILE-SWITCH = 'ACCT'
 12961        MOVE ER-0198             TO EMI-ERROR.
 12962
 12963     IF FILE-SWITCH = 'BENE'
 12964        IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 12965           MOVE ER-0282          TO EMI-ERROR
 12966        ELSE
 12967           MOVE ER-0283          TO EMI-ERROR.
 12968
 12969     MOVE -1                     TO PMTTYPEL.
 12970     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12971
 12972     MOVE EMI-FORCABLE-CTR       TO  PI-FORCE-COUNT
 12973                                     WS-FORCE-CTR.
 12974
 12975     MOVE EMI-FATAL-CTR          TO  PI-FATAL-COUNT
 12976                                     WS-FATAL-CTR.
 12977
 12978     GO TO 8200-SEND-DATAONLY.
 12979
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 247
* EL156.cbl
 12981 2000-EDIT-DONE.
 12982     perform 2210-dcc-max-benes thru 2210-exit
 12983     if pi-company-id not = 'DCC' and 'VPP'
 12984        IF (WS-SPECIAL-CALC-CD = 'C')
 12985           and (cl-critical-period > 0)
 12986           IF CM-AH-BENEFIT-AMT NOT = ZERO
 12987              IF PI-EPYAMT > ZEROS
 12988                 COMPUTE ws-benefits-paid = (CL-TOTAL-PAID-AMT +
 12989                    PI-EPYAMT) / CM-AH-BENEFIT-AMT
 12990              ELSE
 12991                 COMPUTE ws-benefits-paid = (CL-TOTAL-PAID-AMT +
 12992                    PI-CPYAMT) / CM-AH-BENEFIT-AMT
 12993              END-IF
 12994              if ws-benefits-paid > cl-critical-period
 12995                 MOVE ER-0657          TO EMI-ERROR
 12996                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12997              END-IF
 12998           END-IF
 12999        END-IF
 13000     end-if
 13001     IF PI-HOLDTIL NOT = ZEROS
 13002        MOVE PI-HOLDTIL          TO HOLDTILO
 13003        INSPECT HOLDTILO REPLACING ALL SPACES BY '/'
 13004        MOVE ER-3272          TO EMI-ERROR
 13005        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13006     END-IF
 13007
 13008     IF PI-EPYFROM NOT = ZEROS
 13009        MOVE PI-EPYFROM          TO EPYFROMO
 13010        INSPECT EPYFROMI REPLACING ALL SPACES BY '/'.
 13011
 13012     IF PI-EPYTHRU NOT = ZEROS
 13013        MOVE PI-EPYTHRU            TO EPYTHRUO
 13014        INSPECT EPYTHRUI REPLACING ALL SPACES BY '/'
 13015        IF PI-USES-PAID-TO
 13016           MOVE PI-EPYTHRU         TO DC-GREG-DATE-1-MDY
 13017           MOVE '4'                TO DC-OPTION-CODE
 13018           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13019           IF NO-CONVERSION-ERROR
 13020              MOVE +1              TO DC-ELAPSED-DAYS
 13021              MOVE +0              TO DC-ELAPSED-MONTHS
 13022              MOVE '6'             TO DC-OPTION-CODE
 13023              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13024              IF NO-CONVERSION-ERROR
 13025                 MOVE DC-GREG-DATE-1-EDIT TO EPYTHRUI.
 13026
 13027     MOVE PI-EDAYS               TO EDAYSO.
 13028
 13029     IF PI-AIGFROM NOT = ZEROS
 13030        MOVE PI-AIGFROM          TO AIGFROMO
 13031        INSPECT AIGFROMO REPLACING ALL SPACES BY '/'.
 13032
 13033     MOVE PI-EPYAMT              TO EPYAMTO.
 13034     MOVE PI-ERESV               TO ERESVO.
 13035     MOVE PI-EEXPENS             TO EEXPENSO.
 13036
 13037     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 13038     MOVE SPACES                 TO DC-OPTION-CODE.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 248
* EL156.cbl
 13039     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13040
 13041     IF DATE-CONVERSION-ERROR
 13042        MOVE SPACES              TO CPYFROMI
 13043     ELSE
 13044        MOVE DC-GREG-DATE-1-EDIT TO CPYFROMI
 13045        IF PI-EPYFROM = ZEROS
 13046           MOVE AL-UANON             TO EPYFROMA
 13047           MOVE DC-GREG-DATE-1-MDY   TO PI-EPYFROM
 13048           MOVE DC-GREG-DATE-1-EDIT  TO EPYFROMI.
 13049
 13050     IF PI-USES-PAID-TO
 13051        MOVE PI-CPYTHRU                    TO DC-BIN-DATE-1
 13052        MOVE +1                            TO DC-ELAPSED-DAYS
 13053        MOVE +0                            TO DC-ELAPSED-MONTHS
 13054        MOVE '6'                           TO DC-OPTION-CODE
 13055        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13056        IF NO-CONVERSION-ERROR
 13057           MOVE DC-GREG-DATE-1-EDIT        TO CPYTHRUI
 13058           IF PI-EPYTHRU = ZEROS
 13059              MOVE AL-UANON                TO EPYTHRUA
 13060              MOVE DC-GREG-DATE-1-EDIT     TO EPYTHRUI
 13061              MOVE ' '                     TO DC-OPTION-CODE
 13062              MOVE +0                      TO DC-ELAPSED-DAYS
 13063                                              DC-ELAPSED-MONTHS
 13064              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13065              IF NO-CONVERSION-ERROR
 13066                  MOVE DC-GREG-DATE-1-MDY  TO  PI-EPYTHRU
 13067                  GO TO 2001-CONTINUE
 13068              ELSE
 13069                  GO TO 2001-CONTINUE
 13070           ELSE
 13071              GO TO 2001-CONTINUE.
 13072
 13073     MOVE PI-CPYTHRU             TO DC-BIN-DATE-1.
 13074     MOVE SPACES                 TO DC-OPTION-CODE.
 13075     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13076
 13077     IF DATE-CONVERSION-ERROR
 13078        MOVE SPACES              TO CPYTHRUI
 13079     ELSE
 13080        MOVE DC-GREG-DATE-1-EDIT TO CPYTHRUI
 13081        IF PI-EPYTHRU = ZEROS
 13082           MOVE AL-UANON TO EPYTHRUA
 13083           MOVE DC-GREG-DATE-1-MDY   TO PI-EPYTHRU
 13084           MOVE DC-GREG-DATE-1-EDIT  TO EPYTHRUI.
 13085
 13086 2001-CONTINUE.
 13087
 13088     MOVE PI-CDAYS               TO CDAYSO.
 13089
 13090     IF PI-EDAYS = ZEROS
 13091        MOVE AL-UNNON TO EDAYSA
 13092        MOVE PI-CDAYS            TO EDAYSO PI-EDAYS.
 13093
 13094     MOVE PI-CPYAMT              TO CPYAMTO.
 13095
 13096     IF PI-EPYAMT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 249
* EL156.cbl
 13097        MOVE AL-UNNON            TO EPYAMTA
 13098        MOVE PI-CPYAMT           TO EPYAMTO  PI-EPYAMT.
 13099
 13100     MOVE PI-CRESV               TO CRESVO.
 13101     MOVE PI-CEXPENS             TO CEXPENSO.
 13102
 13103     IF PI-EEXPENS = ZEROS
 13104        MOVE AL-UNNON TO EEXPENSA
 13105        MOVE PI-CEXPENS          TO EEXPENSO  PI-EEXPENS.
 13106
 13107     IF (PI-COMPANY-ID = 'CID' OR 'AHL')
 13108        AND (CL-CLAIM-TYPE = 'L')
 13109        AND (PI-OFFLINE NOT EQUAL 'Y')
 13110        IF PI-PMTTYPE = '2' OR '4'
 13111           PERFORM 2200-CALC-INTEREST
 13112                                 THRU 2200-EXIT
 13113        END-IF
 13114     END-IF
 13115     MOVE EMI-FORCABLE-CTR       TO PI-FORCE-COUNT WS-FORCE-CTR.
 13116     MOVE EMI-FATAL-CTR          TO PI-FATAL-COUNT WS-FATAL-CTR.
 13117     MOVE LAST-ERROR-LINE        TO ERRMSG0O.
 13118
 13119     IF EMI-FATAL-CTR = ZEROS
 13120        MOVE 'B'                 TO PI-PASS-SW.
 13121
 13122     IF NOT EMI-MESSAGE-FORMATTED
 13123         MOVE -1                 TO EPYFROML
 13124     ELSE
 13125         IF EMI-ERROR-NUMBER (1) = '0526' AND
 13126            EMI-ERROR-NUMBER (2) = SPACES
 13127             MOVE -1             TO EPYFROML.
 13128
 13129     GO TO 8200-SEND-DATAONLY.
 13130
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 250
* EL156.cbl
 13132 2200-CALC-INTEREST.
 13133     IF PI-PROOF-DATE NOT = ZEROS AND LOW-VALUES
 13134        MOVE PI-PROOF-DATE       TO DC-GREG-DATE-1-MDY
 13135        MOVE '4'                 TO DC-OPTION-CODE
 13136        PERFORM 9700-LINK-DATE-CONVERT
 13137        IF DATE-CONVERSION-ERROR
 13138            MOVE LOW-VALUES      TO CP-PRF-DT
 13139        ELSE
 13140           MOVE DC-BIN-DATE-1    TO CP-PRF-DT
 13141        END-IF
 13142     END-IF
 13143     if (pi-int-to-rem-borr <> 'Y' and 'N')
 13144        if pi-rb-joint-coverage
 13145           move 'Y'              to pi-int-to-rem-borr
 13146        end-if
 13147     end-if
 13148     MOVE PI-COMPANY-CD          TO CP-COMPANY-CD
 13149        IN CLAIM-INT-PASS-AREA
 13150     MOVE CL-CERT-STATE          TO CP-STATE
 13151        IN CLAIM-INT-PASS-AREA
 13152     MOVE CM-LF-BENEFIT-CD       TO CP-PRODUCT
 13153     MOVE 'LF'                   TO CP-COVERAGE
 13154     MOVE CL-INCURRED-DT         TO CP-INC-DT
 13155     MOVE CL-FILE-ESTABLISH-DT   TO CP-EST-DT
 13156     MOVE LOW-VALUES             TO CP-LSTPD-DT
 13157     MOVE CL-REPORTED-DT         TO CP-RPT-DT
 13158     MOVE CL-CERT-EFF-DT         TO CP-EFF-DT
 13159     MOVE PI-EPYAMT              TO CP-CLAIM-AMT
 13160
 13161* EXEC CICS LINK
 13162*       PROGRAM   ('ELCLMI')
 13163*       COMMAREA  (CLAIM-INT-PASS-AREA)
 13164*       LENGTH    (CP-CLAIM-LENGTH)
 13165*    END-EXEC
 13166     MOVE 'ELCLMI' TO DFHEIV1
 13167*    MOVE '."C                   (   #00012573' TO DFHEIV0
 13168     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 13169     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13170     MOVE X'2020233030303132353733' TO DFHEIV0(25:11)
 13171     CALL 'kxdfhei1' USING DFHEIV0,
 13172           DFHEIV1,
 13173           CLAIM-INT-PASS-AREA,
 13174           CP-CLAIM-LENGTH,
 13175           DFHEIV99,
 13176           DFHEIV99,
 13177           DFHEIV99,
 13178           DFHEIV99
 13179     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13180     MOVE AL-PANOF               TO PINTHA
 13181                                    PINTA
 13182     if cp-clm-int-amt = zeros
 13183        move ' ' to pi-int-to-rem-borr
 13184     end-if
 13185     IF NO-CI-ERROR
 13186        MOVE CP-CLM-INT-AMT      TO PINTO
 13187                                    PI-INT-AMT
 13188        MOVE CP-CLM-INT-NODAYS   TO PI-INT-DAYS
 13189        MOVE CP-CLM-INT-RATE     TO PI-INT-RATE-USED
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 251
* EL156.cbl
 13190        MOVE AL-PANOF            TO PINTHA
 13191                                    PINTA
 13192        if pi-rb-joint-coverage
 13193           and pi-int-amt > zeros
 13194           move '  INT TO'       to itrb1o
 13195           move ' REM BORR?'     to itrb2o
 13196           move pi-int-to-rem-borr
 13197                                 to itrbyno
 13198           move al-uanon         to itrbyna
 13199           move +1               to itrbynl
 13200        else
 13201           move ' '              to pi-int-to-rem-borr
 13202        end-if
 13203     ELSE
 13204        IF CI-RETURN-CODE = '8'
 13205           MOVE ER-3818          TO EMI-ERROR
 13206           MOVE -1               TO ZINTL
 13207           PERFORM 9900-ERROR-FORMAT
 13208                                 THRU 9900-EXIT
 13209           GO TO 2200-EXIT
 13210        ELSE
 13211           MOVE ZEROS            TO PINTO
 13212                                    PI-INT-AMT
 13213                                    PI-INT-DAYS
 13214                                    PI-INT-RATE-USED
 13215        END-IF
 13216     END-IF
 13217     IF PI-INT-AMT NOT = ZEROS
 13218        IF (CL-SOC-SEC-NO (1:9) NUMERIC)
 13219           AND (CL-SOC-SEC-NO NOT = ZEROS)
 13220           CONTINUE
 13221        ELSE
 13222           MOVE CL-SOC-SEC-NO (1:3)
 13223                                 TO WS-SSN (1:3)
 13224           MOVE CL-SOC-SEC-NO (5:2)
 13225                                 TO WS-SSN (4:2)
 13226           MOVE CL-SOC-SEC-NO (8:4)
 13227                                 TO WS-SSN (6:4)
 13228           IF (WS-SSN NUMERIC)
 13229              AND (WS-SSN NOT = ZEROS)
 13230              CONTINUE
 13231           ELSE
 13232              MOVE ER-2044       TO EMI-ERROR
 13233              PERFORM 9900-ERROR-FORMAT
 13234                                 THRU 9900-EXIT
 13235           END-IF
 13236        END-IF
 13237        MOVE ELMSTR-KEY          TO ELTRLR-KEY
 13238        if pi-int-to-rem-borr = 'Y'
 13239           move +61              to trlr-seq-no
 13240        else
 13241           MOVE +51              TO TRLR-SEQ-NO
 13242        end-if
 13243
 13244* EXEC CICS READ
 13245*          DATASET  ('ELTRLR')
 13246*          SET      (ADDRESS OF ACTIVITY-TRAILERS)
 13247*          RIDFLD   (ELTRLR-KEY)
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 252
* EL156.cbl
 13248*          RESP     (WS-RESPONSE)
 13249*       END-EXEC
 13250     MOVE 'ELTRLR' TO DFHEIV1
 13251*    MOVE '&"S        E          (  N#00012641' TO DFHEIV0
 13252     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13253     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13254     MOVE X'204E233030303132363431' TO DFHEIV0(25:11)
 13255     CALL 'kxdfhei1' USING DFHEIV0,
 13256           DFHEIV1,
 13257           DFHEIV20,
 13258           DFHEIV99,
 13259           ELTRLR-KEY,
 13260           DFHEIV99,
 13261           DFHEIV99,
 13262           DFHEIV99
 13263     SET ADDRESS OF ACTIVITY-TRAILERS TO
 13264         DFHEIV20
 13265     MOVE EIBRESP  TO WS-RESPONSE
 13266     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13267        IF (NOT WS-RESP-NORMAL)
 13268                    OR
 13269           ((WS-RESP-NORMAL)
 13270           AND ((AT-ADDRESS-LINE-1 = SPACES)
 13271           OR (AT-CITY-STATE = SPACES)))
 13272           MOVE ER-0874          TO EMI-ERROR
 13273           if pi-rb-joint-coverage
 13274              move -1            to itrbynl
 13275           end-if
 13276           PERFORM 9900-ERROR-FORMAT
 13277                                 THRU 9900-EXIT
 13278        else
 13279           move at-mail-to-name  to pi-int-payees-name
 13280        END-IF
 13281     END-IF
 13282     .
 13283 2200-EXIT.
 13284     EXIT.
 13285 2210-dcc-max-benes.
 13286
 13287     move pi-ah-term             to ws-max-bens
 13288     if cl-critical-period not = zeros and spaces
 13289        move cl-critical-period  to ws-max-bens
 13290     end-if
 13291     move cm-ah-benefit-amt      to ws-monthly-benefit
 13292     if pdef-found
 13293        and (pd-max-amt (p1) not = zeros)
 13294        if pd-ben-pct (p1) not numeric
 13295           move zeros            to pd-ben-pct (p1)
 13296        end-if
 13297        if pd-ben-pct (p1) = zeros
 13298           move +1               to ws-work-ben-pct
 13299        else
 13300           move pd-ben-pct (p1)  to ws-work-ben-pct
 13301        end-if
 13302*       compute ws-monthly-benefit =
 13303*          ws-monthly-benefit * ws-work-ben-pct
 13304*       if ws-monthly-benefit > pd-max-amt (p1)
 13305*          move pd-max-amt (p1) to ws-monthly-benefit
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 253
* EL156.cbl
 13306*       end-if
 13307     end-if
 13308
 13309     move cl-cert-key-data       to elcrtt-key (2:21)
 13310     move cl-company-cd          to ctrlr-comp-cd
 13311     move cl-cert-no             to ctrlr-cert-no
 13312     move 'B'                    to ctrlr-rec-type
 13313
 13314
 13315* EXEC CICS READ
 13316*       DATASET  ('ELCRTT')
 13317*       set      (address of CERTIFICATE-TRAILERS)
 13318*       RIDFLD   (ELCRTT-KEY)
 13319*       RESP     (WS-RESPONSE)
 13320*    END-EXEC
 13321     MOVE 'ELCRTT' TO DFHEIV1
 13322*    MOVE '&"S        E          (  N#00012694' TO DFHEIV0
 13323     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13324     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13325     MOVE X'204E233030303132363934' TO DFHEIV0(25:11)
 13326     CALL 'kxdfhei1' USING DFHEIV0,
 13327           DFHEIV1,
 13328           DFHEIV20,
 13329           DFHEIV99,
 13330           ELCRTT-KEY,
 13331           DFHEIV99,
 13332           DFHEIV99,
 13333           DFHEIV99
 13334     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 13335         DFHEIV20
 13336     MOVE EIBRESP  TO WS-RESPONSE
 13337     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13338     IF not WS-RESP-NORMAL
 13339        go to 2210-exit
 13340     end-if
 13341
 13342*    if instypei = 'P'
 13343*       move +1 to s1
 13344*    else
 13345*       MOVE +2 to s1
 13346*    end-if
 13347
 13348*    move +1 to s1
 13349*    evaluate cl-claim-type
 13350*       when 'A'
 13351*          move +1 to s2
 13352*       when 'I'
 13353*          move +2 to s2
 13354*       when 'G'
 13355*          move +3 to s2
 13356*       when 'L'
 13357*          move +4 to s2
 13358*       when 'P'
 13359*          move +5 to s2
 13360*    end-evaluate
 13361
 13362     move zeros                  to ws-prev-days-paid
 13363                                    ws-benefits-paid
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 254
* EL156.cbl
 13364                                    ws-prev-amt-paid
 13365     perform varying s1 from +1 by +1 until
 13366        (s1 > +24)
 13367        or (cs-claim-type (s1) = spaces)
 13368        if pi-company-id not = 'DCC' and 'VPP'
 13369           if cs-claim-type (s1) = cl-claim-type
 13370              compute ws-prev-days-paid =
 13371                 ws-prev-days-paid + cs-days-paid (s1)
 13372              compute ws-prev-amt-paid =
 13373                 ws-prev-amt-paid + cs-total-paid (s1)
 13374           end-if
 13375        else
 13376           if (cs-claim-type (s1) = cl-claim-type)
 13377              and (cs-benefit-period (s1) = cl-benefit-period)
 13378              and (cs-insured-type (s1) = cl-insured-type)
 13379              compute ws-prev-days-paid =
 13380                 ws-prev-days-paid + cs-days-paid (s1)
 13381              compute ws-prev-amt-paid =
 13382                 ws-prev-amt-paid + cs-total-paid (s1)
 13383           end-if
 13384        end-if
 13385     end-perform
 13386     if pi-epyamt > zeros
 13387        compute ws-benefits-paid =
 13388           (ws-prev-amt-paid + pi-epyamt)
 13389           / ws-monthly-benefit
 13390     else
 13391        compute ws-benefits-paid =
 13392           (ws-prev-amt-paid + pi-cpyamt)
 13393           / ws-monthly-benefit
 13394     end-if
 13395*    if pi-company-id = 'DCC'
 13396     if cl-claim-type not = 'L' and 'P'
 13397        if ws-benefits-paid > ws-max-bens
 13398           move er-1658          to emi-error
 13399           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13400        end-if
 13401     end-if
 13402*    end-if
 13403*     if s1 < +25
 13404*        if pi-epyamt > zeros
 13405*           compute ws-benefits-paid =
 13406*              (cs-total-paid (s1) + PI-EPYAMT)
 13407*              / ws-monthly-benefit
 13408*        else
 13409*           compute ws-benefits-paid =
 13410*              (cs-total-paid (s1) + PI-CPYAMT)
 13411*              / ws-monthly-benefit
 13412*        end-if
 13413
 13414*       if ws-benefits-paid > pd-crit-period (p1)
 13415*        if ws-benefits-paid > ws-max-bens
 13416*           move er-1658          to emi-error
 13417*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13418*        end-if
 13419*     end-if
 13420     .
 13421 2210-exit.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 255
* EL156.cbl
 13422     exit.
 13423
 13424 2220-update-elcrtt.
 13425
 13426
 13427* EXEC CICS GETMAIN
 13428*       SET      (ADDRESS OF CERTIFICATE-TRAILERS)
 13429*       LENGTH   (ELCRTT-LENGTH)
 13430*       INITIMG  (GETMAIN-SPACE)
 13431*    END-EXEC
 13432*    MOVE ',"IL                  $   #00012788' TO DFHEIV0
 13433     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13434     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13435     MOVE X'2020233030303132373838' TO DFHEIV0(25:11)
 13436     CALL 'kxdfhei1' USING DFHEIV0,
 13437           DFHEIV20,
 13438           ELCRTT-LENGTH,
 13439           GETMAIN-SPACE
 13440     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 13441         DFHEIV20
 13442     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13443
 13444     move cl-cert-key-data       to elcrtt-key (2:21)
 13445     move cl-company-cd          to ctrlr-comp-cd
 13446     move cl-cert-no             to ctrlr-cert-no
 13447     move 'B'                    to ctrlr-rec-type
 13448
 13449
 13450* EXEC CICS READ
 13451*       UPDATE
 13452*       DATASET  (ELCRTT-DSID)
 13453*       into     (CERTIFICATE-TRAILERS)
 13454*       RIDFLD   (ELCRTT-KEY)
 13455*       RESP     (WS-RESPONSE)
 13456*    END-EXEC
 13457     MOVE LENGTH OF
 13458      CERTIFICATE-TRAILERS
 13459       TO DFHEIV11
 13460*    MOVE '&"IL       EU         (  N#00012799' TO DFHEIV0
 13461     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 13462     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13463     MOVE X'204E233030303132373939' TO DFHEIV0(25:11)
 13464     CALL 'kxdfhei1' USING DFHEIV0,
 13465           ELCRTT-DSID,
 13466           CERTIFICATE-TRAILERS,
 13467           DFHEIV11,
 13468           ELCRTT-KEY,
 13469           DFHEIV99,
 13470           DFHEIV99,
 13471           DFHEIV99
 13472     MOVE EIBRESP  TO WS-RESPONSE
 13473     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13474
 13475     IF WS-RESP-NORMAL
 13476        perform 2225-upd-crt-trlr thru 2225-exit
 13477
 13478* EXEC CICS REWRITE
 13479*          DATASET  (ELCRTT-DSID)
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 256
* EL156.cbl
 13480*          from     (CERTIFICATE-TRAILERS)
 13481*          RESP     (WS-RESPONSE)
 13482*       END-EXEC
 13483     MOVE LENGTH OF
 13484      CERTIFICATE-TRAILERS
 13485       TO DFHEIV11
 13486*    MOVE '&& L                  %  N#00012809' TO DFHEIV0
 13487     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13488     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13489     MOVE X'204E233030303132383039' TO DFHEIV0(25:11)
 13490     CALL 'kxdfhei1' USING DFHEIV0,
 13491           ELCRTT-DSID,
 13492           CERTIFICATE-TRAILERS,
 13493           DFHEIV11,
 13494           DFHEIV99
 13495     MOVE EIBRESP  TO WS-RESPONSE
 13496     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13497     else
 13498        if ws-resp-notfnd
 13499           move 'CS'             to certificate-trailers
 13500           move cl-company-cd    to cs-company-cd
 13501           move cl-cert-key-data to cs-control-primary (2:21)
 13502           move cl-cert-no       to cs-cert-no
 13503           move 'B'              to cs-trailer-type
 13504           perform varying s1 from +1 by +1 until s1 > +24
 13505              move zeros         to cs-benefit-period (s1)
 13506                                    cs-days-paid (s1)
 13507                                    cs-total-paid (s1)
 13508                                    cs-remaining-bens (s1)
 13509           end-perform
 13510           perform 2225-upd-crt-trlr
 13511                                 thru 2225-exit
 13512
 13513* EXEC CICS WRITE
 13514*             DATASET  (ELCRTT-DSID)
 13515*             from     (CERTIFICATE-TRAILERS)
 13516*             RIDFLD   (cs-control-primary)
 13517*             RESP     (WS-RESPONSE)
 13518*          END-EXEC
 13519     MOVE LENGTH OF
 13520      CERTIFICATE-TRAILERS
 13521       TO DFHEIV11
 13522*    MOVE '&$ L                  ''  N#00012829' TO DFHEIV0
 13523     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13524     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13525     MOVE X'204E233030303132383239' TO DFHEIV0(25:11)
 13526     CALL 'kxdfhei1' USING DFHEIV0,
 13527           ELCRTT-DSID,
 13528           CERTIFICATE-TRAILERS,
 13529           DFHEIV11,
 13530           cs-control-primary,
 13531           DFHEIV99,
 13532           DFHEIV99
 13533     MOVE EIBRESP  TO WS-RESPONSE
 13534     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13535        end-if
 13536     END-IF
 13537
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 257
* EL156.cbl
 13538     .
 13539 2220-exit.
 13540     exit.
 13541
 13542 2225-upd-crt-trlr.
 13543
 13544*    if instypei = 'P'
 13545*       move +1 to s1
 13546*    else
 13547*       MOVE +2 to s1
 13548*    end-if
 13549
 13550*    move +1 to s1
 13551*    evaluate cl-claim-type
 13552*       when 'A'
 13553*          move +1 to s2
 13554*       when 'I'
 13555*          move +2 to s2
 13556*       when 'G'
 13557*          move +3 to s2
 13558*       when 'L'
 13559*          move +4 to s2
 13560*       when 'P'
 13561*          move +5 to s2
 13562*    end-evaluate
 13563     perform varying s1 from +1 by +1 until
 13564        (s1 > +24)
 13565        or (cl-claim-no = cs-claim-no (s1))
 13566     end-perform
 13567     if s1 < +25
 13568        compute cs-total-paid (s1) =
 13569           cs-total-paid (s1) + at-amount-paid
 13570        compute cs-days-paid (s1) =
 13571           cs-days-paid (s1) +  at-days-in-period
 13572*       compute cs-remaining-bens (s1) =
 13573*          cs-remaining-bens (s1) - (cs-days-paid (s1) / 30)
 13574        perform 2230-accum-bens-paid thru 2230-exit
 13575     end-if
 13576
 13577     .
 13578 2225-exit.
 13579     exit.
 13580 2230-accum-bens-paid.
 13581     if cl-claim-type not = 'L' and 'P'
 13582        move pi-ah-term          to ws-max-bens
 13583        if cl-critical-period not = zeros and spaces
 13584           move cl-critical-period
 13585                                 to ws-max-bens
 13586        end-if
 13587     else
 13588        move 01                  to ws-max-bens
 13589     end-if
 13590     move zeros to ws-tot-days-paid ws-tot-amt-paid
 13591     perform varying s2 from +1 by +1 until
 13592        (s2 > +24)
 13593        or (cs-claim-no (s2) = spaces)
 13594        if pi-company-id not = 'DCC' and 'VPP'
 13595           if cs-claim-type (s2) = cl-claim-type
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 258
* EL156.cbl
 13596              compute ws-tot-days-paid =
 13597                 ws-tot-days-paid + cs-days-paid (s2)
 13598              compute ws-tot-amt-paid =
 13599                 ws-tot-amt-paid + cs-total-paid (s2)
 13600           end-if
 13601        else
 13602           if (cs-benefit-period (s2) = cl-benefit-period)
 13603              and (cs-claim-type (s2) = cl-claim-type)
 13604              and (cs-insured-type (s2) = cl-insured-type)
 13605              compute ws-tot-days-paid =
 13606                 ws-tot-days-paid + cs-days-paid (s2)
 13607              compute ws-tot-amt-paid =
 13608                 ws-tot-amt-paid + cs-total-paid (s2)
 13609           end-if
 13610        end-if
 13611     end-perform
 13612     if cl-claim-type = 'L' and 'P'
 13613        if ws-tot-amt-paid > zeros
 13614           move zeros            to cs-remaining-bens (s1)
 13615        else
 13616           move 01               to cs-remaining-bens (s1)
 13617        end-if
 13618     else
 13619        compute ws-pd-bens rounded =
 13620           ws-tot-amt-paid / pi-ah-benefit-amt
 13621        compute cs-remaining-bens (s1) =
 13622           ws-max-bens - ws-pd-bens
 13623        if cs-remaining-bens (s1) < zeros
 13624           move zeros            to cs-remaining-bens (s1)
 13625        end-if
 13626     end-if
 13627     .
 13628 2230-exit.
 13629     exit.
 13630 3000-MOVE-INPUT-TO-SAVE-AREA.
 13631     IF PMTTYPEL > 0
 13632         MOVE PMTTYPEI           TO WS-PMTTYPE.
 13633
 13634     if ws-pmttype = '4'
 13635        if pi-rb-joint-coverage
 13636           if payeel = +0
 13637              move +2            to payeel
 13638              move al-uanon      to payeea
 13639              move 'Q1'          to payeeo
 13640           else
 13641              if payeei not = 'Q1' and 'q1'
 13642                 move er-1582    to emi-error
 13643                 PERFORM 9900-ERROR-FORMAT thru 9900-exit
 13644              end-if
 13645           end-if
 13646        end-if
 13647     end-if
 13648     MOVE SPACES                 TO PI-PROVISIONAL-IND.
 13649
 13650     IF WS-PMTTYPE = '9'
 13651         MOVE 'P'                TO PI-PROVISIONAL-IND
 13652         MOVE '1'                TO WS-PMTTYPE.
 13653
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 259
* EL156.cbl
 13654     IF PAYEEL > 0
 13655         MOVE FUNCTION UPPER-CASE(PAYEEI) TO PAYEEI
 13656         MOVE PAYEEI             TO WS-PAYEE.
 13657
 13658     IF NOTE1L > +0
 13659         MOVE NOTE1I             TO WS-PMTNOTE1
 13660                                    WS-FLI-PMTNOTE
 13661                                    WS-HAN-PMTNOTE.
 13662
 13663     IF NOTE2L > +0
 13664         MOVE NOTE2I             TO WS-PMTNOTE2.
 13665
 13666     IF OFFLINEL > 0
 13667         MOVE OFFLINEI           TO WS-OFFLINE.
 13668
 13669     IF PROOFDTL > 0
 13670         MOVE PROOFDTI            TO DATE-WORK
 13671         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13672         MOVE NUM-WORK            TO DC-GREG-DATE-1-MDY
 13673         MOVE '4'                 TO DC-OPTION-CODE
 13674         PERFORM 9700-LINK-DATE-CONVERT THRU  9700-EXIT
 13675         IF NO-CONVERSION-ERROR
 13676            MOVE NUM-WORK         TO PROOFDTO
 13677            INSPECT PROOFDTI REPLACING ALL ' ' BY '/'
 13678            MOVE NUM-WORK         TO WS-PROOF-DATE
 13679         ELSE
 13680            MOVE ZEROS            TO WS-PROOF-DATE
 13681         END-IF
 13682     END-IF.
 13683
 13684     IF EOBYNL > +0
 13685         MOVE FUNCTION UPPER-CASE(EOBYNI) TO EOBYNI
 13686         MOVE EOBYNI              TO WS-PRINT-EOB-YN
 13687     END-IF
 13688
 13689     IF CLMFMYNL > +0
 13690         MOVE FUNCTION UPPER-CASE(CLMFMYNI) TO CLMFMYNI
 13691         MOVE CLMFMYNI            TO WS-PRINT-CLM-FRM-YN
 13692     END-IF
 13693
 13694     IF SURVYYNL > +0
 13695         MOVE FUNCTION UPPER-CASE(SURVYYNI) TO SURVYYNI
 13696         MOVE SURVYYNI            TO WS-PRINT-SURVEY-YN
 13697     END-IF
 13698
 13699     IF SPRELYNL > +0
 13700         MOVE FUNCTION UPPER-CASE(SPRELYNI) TO SPRELYNI
 13701         MOVE SPRELYNI            TO WS-SPECIAL-RELEASE-YN
 13702     END-IF
 13703     if itrbynl <> +0
 13704        move function upper-case(itrbyni) to itrbyni
 13705        move itrbyni             to ws-int-to-rem-borr
 13706     end-if
 13707*    IF GROUPEDL > +0
 13708*        MOVE GROUPEDI           TO WS-GROUPED.
 13709*
 13710*    IF CASHL > +0
 13711*       MOVE CASHI               TO WS-CASH.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 260
* EL156.cbl
 13712     IF LOANNOL > +0
 13713         MOVE LOANNOI            TO WS-LOAN-NO.
 13714
 13715     IF CHECKNOL > 0
 13716         MOVE CHECKNOI           TO WS-CHECKNO, WS-AIG-CHECKNO.
 13717
 13718     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 13719         IF WS-AIG-CREDIT-ENTERED
 13720             MOVE WS-A-CHECKNO-6-7 TO WS-A-CHECKNO-1-2
 13721             MOVE ZEROS            TO WS-A-CHECKNO-3-7
 13722             MOVE WS-AIG-CHECKNO   TO WS-CHECKNO CHECKNOO
 13723             MOVE AL-UANON         TO CHECKNOA.
 13724
 13725     IF HOLDTILL > 0
 13726         MOVE HOLDTILI           TO DATE-WORK
 13727         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13728         MOVE NUM-WORK           TO WS-HOLDTIL.
 13729
 13730     IF ZINTL > +0
 13731
 13732* EXEC CICS BIF DEEDIT
 13733*           FIELD   (ZINTI)
 13734*           LENGTH  (07)
 13735*       END-EXEC
 13736     MOVE 07
 13737       TO DFHEIV11
 13738*    MOVE '@"L                   #   #00013031' TO DFHEIV0
 13739     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13740     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13741     MOVE X'2020233030303133303331' TO DFHEIV0(25:11)
 13742     CALL 'kxdfhei1' USING DFHEIV0,
 13743           ZINTI,
 13744           DFHEIV11
 13745     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13746        IF ZINTI NOT NUMERIC
 13747           MOVE ER-0419          TO EMI-ERROR
 13748           PERFORM 9900-ERROR-FORMAT
 13749           MOVE AL-UABON         TO ZINTA
 13750           MOVE -1               TO ZINTL
 13751        ELSE
 13752           MOVE ZINTI            TO CP-INT-RATE
 13753                                    WS-INT-RATE
 13754           MOVE CP-INT-RATE      TO ZINTO
 13755           MOVE AL-UNNON         TO ZINTA
 13756        END-IF
 13757     ELSE
 13758        MOVE ZEROS               TO CP-INT-RATE
 13759     END-IF
 13760     IF EPYFROML > 0
 13761         MOVE EPYFROMI           TO DATE-WORK
 13762         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13763         MOVE NUM-WORK           TO WS-EPYFROM.
 13764
 13765     IF AIGFROML > 0
 13766         MOVE AIGFROMI           TO DATE-WORK
 13767         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13768         MOVE NUM-WORK           TO WS-AIGFROM
 13769     ELSE
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 261
* EL156.cbl
 13770         IF (AIGFROMI = LOW-VALUES) AND
 13771            (PI-AIGFROM NOT = ZEROS)
 13772              MOVE 'Y' TO WS-RECALC-PAYFROM-SW.
 13773
 13774     IF EPYTHRUL > +0
 13775        MOVE EPYTHRUI           TO DATE-WORK
 13776        PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13777        MOVE NUM-WORK           TO WS-EPYTHRU
 13778        MOVE WS-EPYTHRU         TO DC-GREG-DATE-1-MDY
 13779        MOVE '4'                TO DC-OPTION-CODE
 13780        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13781        IF NO-CONVERSION-ERROR
 13782           IF PI-USES-PAID-TO
 13783              MOVE '6'                TO DC-OPTION-CODE
 13784              MOVE -1                 TO DC-ELAPSED-DAYS
 13785              MOVE +0                 TO DC-ELAPSED-MONTHS
 13786              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13787              IF NO-CONVERSION-ERROR
 13788                 MOVE DC-BIN-DATE-2   TO DC-BIN-DATE-1
 13789                 MOVE ' '             TO DC-OPTION-CODE
 13790                 MOVE +0              TO DC-ELAPSED-DAYS
 13791                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13792              IF NO-CONVERSION-ERROR
 13793                 MOVE DC-GREG-DATE-1-MDY TO WS-EPYTHRU.
 13794
 13795*****DEEDIT DAYS AND ADD ZERO IN ORDER TO SET A 'C' SIGN
 13796*****THAT WILL BE NEEDED LATER FOR A GROUP TEST.
 13797     IF EDAYSL > 0
 13798
 13799* EXEC CICS BIF DEEDIT
 13800*            FIELD(EDAYSI)
 13801*            LENGTH(6)
 13802*        END-EXEC
 13803     MOVE 6
 13804       TO DFHEIV11
 13805*    MOVE '@"L                   #   #00013087' TO DFHEIV0
 13806     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13807     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13808     MOVE X'2020233030303133303837' TO DFHEIV0(25:11)
 13809     CALL 'kxdfhei1' USING DFHEIV0,
 13810           EDAYSI,
 13811           DFHEIV11
 13812     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13813         MOVE EDAYSI             TO WS-DY-WORK
 13814         IF WS-DY-SIGN = SPACES
 13815            MOVE WS-DY-NUM       TO WS-EDAYS
 13816            ADD 0                TO WS-EDAYS
 13817         ELSE
 13818            MOVE EDAYSI          TO WS-EDAYS
 13819            ADD 0                TO WS-EDAYS.
 13820
 13821*****DEEDIT PAYMENT AND ADD ZERO IN ORDER TO SET A 'C' SIGN
 13822*****THAT WILL BE NEEDED LATER FOR A GROUP TEST.
 13823     IF EPYAMTL > 0
 13824
 13825* EXEC CICS BIF DEEDIT
 13826*            FIELD(EPYAMTI)
 13827*            LENGTH(10)
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 262
* EL156.cbl
 13828*        END-EXEC
 13829     MOVE 10
 13830       TO DFHEIV11
 13831*    MOVE '@"L                   #   #00013102' TO DFHEIV0
 13832     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13833     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13834     MOVE X'2020233030303133313032' TO DFHEIV0(25:11)
 13835     CALL 'kxdfhei1' USING DFHEIV0,
 13836           EPYAMTI,
 13837           DFHEIV11
 13838     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13839         MOVE EPYAMTI            TO WS-PY-WORK
 13840         IF WS-PY-SIGN = SPACES
 13841            MOVE WS-PY-NUM       TO WS-EPYAMT
 13842            ADD 0                TO WS-EPYAMT
 13843         ELSE
 13844            MOVE EPYAMTI         TO WS-EPYAMT
 13845            ADD 0                TO WS-EPYAMT.
 13846
 13847     IF ERESVL > 0
 13848
 13849* EXEC CICS BIF DEEDIT
 13850*            FIELD(ERESVI)
 13851*            LENGTH(9)
 13852*        END-EXEC
 13853     MOVE 9
 13854       TO DFHEIV11
 13855*    MOVE '@"L                   #   #00013115' TO DFHEIV0
 13856     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13857     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13858     MOVE X'2020233030303133313135' TO DFHEIV0(25:11)
 13859     CALL 'kxdfhei1' USING DFHEIV0,
 13860           ERESVI,
 13861           DFHEIV11
 13862     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13863         MOVE ERESVI TO WS-ERESV.
 13864
 13865     IF EEXPENSL > 0
 13866
 13867* EXEC CICS BIF DEEDIT
 13868*            FIELD(EEXPENSI)
 13869*            LENGTH(8)
 13870*        END-EXEC
 13871     MOVE 8
 13872       TO DFHEIV11
 13873*    MOVE '@"L                   #   #00013122' TO DFHEIV0
 13874     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13875     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13876     MOVE X'2020233030303133313232' TO DFHEIV0(25:11)
 13877     CALL 'kxdfhei1' USING DFHEIV0,
 13878           EEXPENSI,
 13879           DFHEIV11
 13880     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13881         MOVE EEXPENSI           TO WS-EEXPENS.
 13882
 13883     IF ETYPEL > ZEROS
 13884         MOVE ETYPEI             TO WS-ETYPE.
 13885
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 263
* EL156.cbl
 13886     IF PI-COMPANY-ID = 'BOA'
 13887        IF PINTL > ZEROS
 13888
 13889* EXEC CICS BIF DEEDIT
 13890*            FIELD (PINTI)
 13891*            LENGTH(05)
 13892*          END-EXEC
 13893     MOVE 05
 13894       TO DFHEIV11
 13895*    MOVE '@"L                   #   #00013133' TO DFHEIV0
 13896     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13897     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13898     MOVE X'2020233030303133313333' TO DFHEIV0(25:11)
 13899     CALL 'kxdfhei1' USING DFHEIV0,
 13900           PINTI,
 13901           DFHEIV11
 13902     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13903           IF PINTI NUMERIC
 13904               MOVE AL-UNNON     TO PINTA
 13905               MOVE PINTI        TO WS-INT-RATE
 13906               MOVE WS-INT-RATE  TO PINTO.
 13907
 13908 3000-EXIT.
 13909     EXIT.
 13910
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 264
* EL156.cbl
 13912 3050-REBUILD-ENTERED.
 13913
 13914     MOVE PI-SAVE-INPUT TO WS-SAVE-INPUT.
 13915
 13916     IF PI-PROV-PMT
 13917         MOVE '9'           TO PMTTYPEO
 13918     ELSE
 13919         MOVE PI-PMTTYPE    TO PMTTYPEO.
 13920
 13921     MOVE PI-PAYEE          TO PAYEEO.
 13922     MOVE PI-PMTNOTE1       TO NOTE1O.
 13923     MOVE PI-PMTNOTE2       TO NOTE2O.
 13924     MOVE PI-OFFLINE        TO OFFLINEO.
 13925     IF PI-PROOF-DATE NOT = ZEROS
 13926         MOVE PI-PROOF-DATE TO PROOFDTO
 13927         INSPECT PROOFDTI REPLACING ALL SPACES BY '/'
 13928     END-IF.
 13929*    MOVE PI-GROUPED        TO GROUPEDO.
 13930
 13931*    MOVE PI-CASH           TO CASHO.
 13932
 13933     IF PI-INT-RATE > ZEROS
 13934        MOVE PI-INT-RATE         TO PINTO
 13935     end-if
 13936     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 13937        IF PI-INT-AMT > ZEROS
 13938           MOVE PI-INT-AMT       TO PINTO
 13939           MOVE AL-PANOF         TO PINTA
 13940                                    PINTHA
 13941           if pi-rb-joint-coverage
 13942              move '  INT TO'    to itrb1o
 13943              move ' REM BORR?'  to itrb2o
 13944              move 'Y'           to itrbyno
 13945              move al-uanon      to itrbyna
 13946              move +1            to itrbynl
 13947           end-if
 13948        END-IF
 13949     END-IF
 13950     MOVE PI-PRINT-EOB-YN        TO EOBYNI
 13951     MOVE PI-PRINT-CLM-FRM-YN    TO CLMFMYNI
 13952     MOVE PI-PRINT-SURVEY-YN     TO SURVYYNI
 13953     MOVE PI-SPECIAL-RELEASE-YN  TO SPRELYNI
 13954     IF PI-HOLDTIL NOT = ZEROS
 13955        MOVE PI-HOLDTIL          TO HOLDTILO
 13956        INSPECT HOLDTILO REPLACING ALL SPACES BY '/'.
 13957
 13958     IF PI-EPYFROM NOT = ZEROS
 13959        MOVE PI-EPYFROM          TO EPYFROMO
 13960        INSPECT EPYFROMO REPLACING ALL SPACES BY '/'.
 13961
 13962     IF PI-AIGFROM NOT = ZEROS
 13963        MOVE PI-AIGFROM          TO AIGFROMO
 13964        INSPECT AIGFROMO REPLACING ALL SPACES BY '/'.
 13965
 13966     IF PI-EPYTHRU NOT = ZEROS
 13967        MOVE PI-EPYTHRU          TO EPYTHRUO
 13968        INSPECT EPYTHRUO REPLACING ALL SPACES BY '/'
 13969        IF PI-USES-PAID-TO
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 265
* EL156.cbl
 13970           MOVE PI-EPYTHRU         TO DC-GREG-DATE-1-MDY
 13971           MOVE '4'                TO DC-OPTION-CODE
 13972           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13973           IF NO-CONVERSION-ERROR
 13974              MOVE +1 TO DC-ELAPSED-DAYS
 13975              MOVE +0 TO DC-ELAPSED-MONTHS
 13976              MOVE '6' TO DC-OPTION-CODE
 13977              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13978              IF NO-CONVERSION-ERROR
 13979                 MOVE DC-GREG-DATE-1-EDIT TO EPYTHRUI.
 13980
 13981     IF PI-EDAYS NOT = ZEROS
 13982        MOVE PI-EDAYS TO EDAYSO.
 13983
 13984     IF PI-EPYAMT NOT = ZEROS
 13985        MOVE PI-EPYAMT TO EPYAMTO.
 13986
 13987     IF PI-ERESV NOT = ZEROS
 13988        MOVE PI-ERESV TO ERESVO.
 13989
 13990     IF PI-EEXPENS NOT = ZEROS
 13991        MOVE PI-EEXPENS TO EEXPENSO.
 13992
 13993     MOVE PI-ETYPE TO ETYPEO.
 13994
 13995     IF PI-ECHECKNO NOT = SPACES
 13996        MOVE PI-ECHECKNO         TO CHECKNOO
 13997     ELSE
 13998        MOVE PI-CCHECKNO         TO CHECKNOO.
 13999
 14000     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 14001     MOVE SPACES                 TO DC-OPTION-CODE.
 14002     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14003
 14004     IF DATE-CONVERSION-ERROR
 14005        MOVE SPACES              TO CPYFROMI
 14006     ELSE
 14007        MOVE DC-GREG-DATE-1-EDIT TO CPYFROMI.
 14008
 14009     IF PI-USES-PAID-TO
 14010        MOVE PI-CPYTHRU          TO DC-BIN-DATE-1
 14011        MOVE +1                  TO DC-ELAPSED-DAYS
 14012        MOVE +0                  TO DC-ELAPSED-MONTHS
 14013        MOVE '6'                 TO DC-OPTION-CODE
 14014        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14015        IF NO-CONVERSION-ERROR
 14016           MOVE DC-GREG-DATE-1-EDIT TO CPYTHRUI
 14017           GO TO 3051-CONTINUE.
 14018
 14019     MOVE PI-CPYTHRU             TO DC-BIN-DATE-1.
 14020     MOVE SPACES                 TO DC-OPTION-CODE.
 14021     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14022
 14023     IF DATE-CONVERSION-ERROR
 14024        MOVE SPACES              TO CPYTHRUI
 14025     ELSE
 14026        MOVE DC-GREG-DATE-1-EDIT TO CPYTHRUI.
 14027
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 266
* EL156.cbl
 14028 3051-CONTINUE.
 14029
 14030     IF PI-CDAYS NOT = ZEROS
 14031        MOVE PI-CDAYS TO CDAYSO.
 14032
 14033     IF PI-CPYAMT NOT = ZEROS
 14034        MOVE PI-CPYAMT TO CPYAMTO.
 14035
 14036     IF PI-CRESV NOT = ZEROS
 14037        MOVE PI-CRESV TO CRESVO.
 14038
 14039     IF PI-CEXPENS NOT = ZEROS
 14040        MOVE PI-CEXPENS TO CEXPENSO.
 14041
 14042 3059-EXIT.
 14043     EXIT.
 14044
 14045 3100-DEEDIT-DATE.
 14046
 14047* EXEC CICS BIF DEEDIT
 14048*        FIELD(DATE-WORK)
 14049*        LENGTH(8)
 14050*    END-EXEC.
 14051     MOVE 8
 14052       TO DFHEIV11
 14053*    MOVE '@"L                   #   #00013280' TO DFHEIV0
 14054     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 14055     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14056     MOVE X'2020233030303133323830' TO DFHEIV0(25:11)
 14057     CALL 'kxdfhei1' USING DFHEIV0,
 14058           DATE-WORK,
 14059           DFHEIV11
 14060     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14061
 14062
 14063 3100-EXIT.
 14064     EXIT.
 14065
 14066 3200-CALC-AIG-DAYS.
 14067
 14068     MOVE 'N'                    TO WS-DUE-DAY-SW.
 14069
 14070     MOVE CL-INCURRED-DT         TO DC-BIN-DATE-1.
 14071     MOVE ' '                    TO DC-OPTION-CODE.
 14072     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14073     IF NO-CONVERSION-ERROR
 14074         MOVE DC-GREG-DATE-1-MDY     TO WS-TEMP-INC-MDY
 14075     ELSE
 14076         GO TO 3290-ERROR.
 14077
 14078     IF WS-SV-AIGFROM NOT = LOW-VALUES
 14079         MOVE WS-SV-AIGFROM  TO DC-BIN-DATE-1
 14080                                WS-BIN-FROM-DT
 14081     ELSE
 14082         IF CL-TOTAL-PAID-AMT > ZEROS
 14083             IF WS-SV-EPYFROM = LOW-VALUES
 14084                 MOVE PI-CPYFROM     TO DC-BIN-DATE-1
 14085                                        WS-BIN-FROM-DT
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 267
* EL156.cbl
 14086             ELSE
 14087                 MOVE WS-SV-EPYFROM  TO DC-BIN-DATE-1
 14088                                        WS-BIN-FROM-DT
 14089         ELSE
 14090             MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 14091                                        WS-BIN-FROM-DT.
 14092
 14093 3210-CONTINUE.
 14094
 14095     MOVE ' '                    TO DC-OPTION-CODE.
 14096     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14097     IF DATE-CONVERSION-ERROR
 14098         GO TO 3290-ERROR.
 14099
 14100     MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY.
 14101
 14102     IF PI-LOAN-DUE-DAY = 31
 14103         MOVE 30              TO WS-PMT-DUE-DA
 14104                                 WS-SAVE-DUE-DA
 14105     ELSE
 14106         MOVE PI-LOAN-DUE-DAY TO WS-PMT-DUE-DA
 14107                                 WS-SAVE-DUE-DA.
 14108
 14109     IF (PI-LOAN-DUE-DAY > 28) AND
 14110        (WS-PMT-DUE-MO = 2)
 14111         MOVE 'Y'                TO WS-DUE-DAY-SW
 14112         MOVE 28                 TO WS-PMT-DUE-DA.
 14113
 14114     MOVE WS-PMT-DUE-MDY         TO DC-GREG-DATE-1-MDY.
 14115     MOVE '4'                    TO DC-OPTION-CODE.
 14116     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14117     IF NO-CONVERSION-ERROR
 14118         MOVE DC-BIN-DATE-1      TO WS-PMT-DUE-DT
 14119     ELSE
 14120         GO TO 3290-ERROR.
 14121
 14122*--------------------------------------------------------------*
 14123*    IF THE 1ST LOAN PMT DATE LESS THAN INCURRED DATE          *
 14124*    AND THE EFFECTIVE DAY LESS THAN INCURRED DAY              *
 14125*    ADD ONE MONTH TO THE CURRENT PAYMENT DUE DATE             *
 14126*                                                              *
 14127*    EXAMPLE: CERT LOAN PMT DUE  - 05/03/87                    *
 14128*             INCURRED DATE      - 04/15/91                    *
 14129*             PMT DUE DATE       - 04/03/91                    *
 14130*             PMT DUE DATE       - 05/03/91                    *
 14131*--------------------------------------------------------------*
 14132
 14133     IF (CL-TOTAL-PAID-AMT NOT > ZEROS)  AND
 14134        (WS-SV-AIGFROM = LOW-VALUES)
 14135         IF (WS-PMT-DUE-MO = WS-TEMP-INC-MO) AND
 14136            (WS-PMT-DUE-DA < WS-TEMP-INC-DA)
 14137             MOVE WS-PMT-DUE-DT      TO DC-BIN-DATE-1
 14138             PERFORM 3300-BUMP-DATE THRU 3399-EXIT
 14139             IF NO-CONVERSION-ERROR
 14140                 MOVE DC-BIN-DATE-2      TO WS-PMT-DUE-DT
 14141                 MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 14142             ELSE
 14143                 GO TO 3290-ERROR.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 268
* EL156.cbl
 14144
 14145     IF (CL-TOTAL-PAID-AMT NOT > ZEROS)  AND
 14146        (WS-SV-AIGFROM = LOW-VALUES)
 14147         GO TO 3205-CONT-CALC-PMT.
 14148
 14149     MOVE WS-BIN-FROM-DT         TO DC-BIN-DATE-1.
 14150     MOVE ' '                    TO DC-OPTION-CODE.
 14151     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14152     IF NO-CONVERSION-ERROR
 14153         MOVE DC-GREG-DATE-1-MDY     TO WS-FROM-DATE-MDY
 14154     ELSE
 14155         GO TO 3290-ERROR.
 14156
 14157     IF (WS-PMT-DUE-MO = WS-FROM-MO) AND
 14158        (WS-PMT-DUE-DA < WS-FROM-DA)
 14159          MOVE WS-PMT-DUE-DT      TO DC-BIN-DATE-1
 14160          PERFORM 3300-BUMP-DATE THRU 3399-EXIT
 14161          IF NO-CONVERSION-ERROR
 14162              MOVE DC-BIN-DATE-2      TO WS-PMT-DUE-DT
 14163              MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 14164          ELSE
 14165              GO TO 3290-ERROR.
 14166
 14167 3205-CONT-CALC-PMT.
 14168
 14169*--------------------------------------------------------------*
 14170*    VERIFY THAT THE SYSTEM CALCULATED LOAN PAYMENT DATE FALLS *
 14171*    BETWEEN THE PAY FROM / THRU DATES.                        *
 14172*--------------------------------------------------------------*
 14173
 14174     IF CL-TOTAL-PAID-AMT = ZEROS AND
 14175        PI-PMTTYPE = '2'
 14176          NEXT SENTENCE
 14177     ELSE
 14178        IF (WS-PMT-DUE-DT < WS-BIN-FROM-DT) OR
 14179           (WS-PMT-DUE-DT > WS-SV-EPYTHRU)
 14180             MOVE WS-PMT-DUE-MDY     TO EMI-DATE-FIELD
 14181             MOVE ER-3527            TO EMI-ERROR
 14182             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14183             MOVE -1                 TO EPYTHRUL
 14184             MOVE AL-UNBON           TO EPYTHRUA
 14185                                        EPYFROMA
 14186             GO TO 3299-EXIT.
 14187
 14188*--------------------------------------------------------------*
 14189*    CALCULATE RETRO ELIMINATION DATE                          *
 14190*--------------------------------------------------------------*
 14191
 14192     IF WS-SV-AIGFROM NOT = LOW-VALUES
 14193         MOVE WS-SV-AIGFROM  TO DC-BIN-DATE-1
 14194     ELSE
 14195         MOVE CL-INCURRED-DT TO DC-BIN-DATE-1.
 14196
 14197     MOVE PI-BEN-DAYS    TO DC-ELAPSED-DAYS.
 14198     MOVE +0             TO DC-ELAPSED-MONTHS.
 14199     MOVE '6'            TO DC-OPTION-CODE.
 14200     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14201     IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 269
* EL156.cbl
 14202         MOVE DC-BIN-DATE-2 TO WS-RETRO-ELIM-DT
 14203     ELSE
 14204         GO TO 3290-ERROR.
 14205
 14206 3210-CHECK-PMT-DATE.
 14207
 14208*--------------------------------------------------------------*
 14209*    VERIFY THAT THE CALCULATED LOAN DUE DATE FALLS AFTER      *
 14210*    THE ENTERED PAY FROM DATE                                 *
 14211*--------------------------------------------------------------*
 14212
 14213     IF WS-PMT-DUE-DT < WS-SV-EPYFROM
 14214         NEXT SENTENCE
 14215     ELSE
 14216         GO TO 3220-COMPUTE-DAYS.
 14217
 14218     MOVE WS-PMT-DUE-DT      TO DC-BIN-DATE-1.
 14219     PERFORM 3300-BUMP-DATE THRU 3399-EXIT.
 14220     IF NO-CONVERSION-ERROR
 14221         MOVE DC-BIN-DATE-2      TO WS-PMT-DUE-DT
 14222         MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 14223         GO TO 3210-CHECK-PMT-DATE
 14224     ELSE
 14225         GO TO 3290-ERROR.
 14226
 14227 3220-COMPUTE-DAYS.
 14228
 14229     MOVE WS-PMT-DUE-DT TO WS-NEXT-PMT-DUE-DT.
 14230     MOVE ZEROS         TO WS-CDAYS.
 14231     MOVE 'N'           TO WS-ELIMINATION-SW.
 14232
 14233*--------------------------------------------------------------*
 14234*    COMPUTE CALIFORNIA DUE DAYS                               *
 14235*--------------------------------------------------------------*
 14236
 14237     IF CL-TOTAL-PAID-AMT > ZEROS
 14238         MOVE 'Y' TO WS-ELIMINATION-SW
 14239         GO TO 3240-FIRST-PMT-DUE
 14240     ELSE
 14241        IF WS-RETRO-ELIM-DT > WS-PMT-DUE-DT
 14242            NEXT SENTENCE
 14243        ELSE
 14244            GO TO 3240-FIRST-PMT-DUE.
 14245
 14246 3230-NEXT-PMT-DUE.
 14247
 14248     MOVE WS-NEXT-PMT-DUE-DT TO DC-BIN-DATE-1.
 14249     PERFORM 3300-BUMP-DATE THRU 3399-EXIT.
 14250     IF NO-CONVERSION-ERROR
 14251         MOVE DC-BIN-DATE-2 TO WS-NEXT-PMT-DUE-DT
 14252         MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 14253     ELSE
 14254         GO TO 3290-ERROR.
 14255
 14256 3240-FIRST-PMT-DUE.
 14257
 14258     IF CL-TOTAL-PAID-AMT > ZEROS
 14259         NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 270
* EL156.cbl
 14260     ELSE
 14261        IF WS-RETRO-ELIM-DT > WS-NEXT-PMT-DUE-DT
 14262            GO TO 3230-NEXT-PMT-DUE.
 14263
 14264     IF WS-NEXT-PMT-DUE-DT > WS-SV-EPYTHRU
 14265         GO TO 3250-VERIFY-ELIMINATION.
 14266
 14267     ADD +30 TO WS-CDAYS.
 14268     MOVE 'Y' TO WS-ELIMINATION-SW.
 14269     GO TO 3230-NEXT-PMT-DUE.
 14270
 14271 3250-VERIFY-ELIMINATION.
 14272
 14273     IF ELIM-SATISFIED
 14274         GO TO 3260-END-CALC.
 14275
 14276     IF PI-PMTTYPE = '1'
 14277         MOVE ZEROS TO WS-CDAYS
 14278         GO TO 3260-END-CALC.
 14279
 14280     IF WS-SV-AIGFROM NOT = LOW-VALUES
 14281         MOVE WS-SV-AIGFROM  TO DC-BIN-DATE-1
 14282     ELSE
 14283         IF CL-TOTAL-PAID-AMT > ZEROS
 14284             IF WS-SV-EPYFROM = LOW-VALUES
 14285                 MOVE PI-CPYFROM     TO DC-BIN-DATE-1
 14286             ELSE
 14287                 MOVE WS-SV-EPYFROM  TO DC-BIN-DATE-1
 14288         ELSE
 14289             MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1.
 14290
 14291     MOVE WS-SV-EPYTHRU          TO DC-BIN-DATE-2.
 14292     MOVE '1'                    TO DC-OPTION-CODE.
 14293     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14294     IF NO-CONVERSION-ERROR
 14295         COMPUTE WS-DAYS-OFF =  DC-ELAPSED-DAYS + 1
 14296     ELSE
 14297         GO TO 3290-ERROR.
 14298
 14299     IF CL-TOTAL-PAID-AMT > ZEROS
 14300         MOVE WS-DAYS-OFF TO WS-CDAYS
 14301     ELSE
 14302         IF PI-BEN-DAYS > WS-DAYS-OFF
 14303             MOVE ZEROS TO WS-CDAYS
 14304         ELSE
 14305             COMPUTE WS-CDAYS = WS-DAYS-OFF - PI-BEN-DAYS.
 14306
 14307 3260-END-CALC.
 14308
 14309     MOVE WS-CDAYS TO PI-CDAYS.
 14310
 14311     IF PI-EDAYS = ZEROS
 14312         MOVE PI-CDAYS TO PI-EDAYS
 14313         MOVE AL-UNNON TO EDAYSA.
 14314
 14315     GO TO 3299-EXIT.
 14316
 14317 3290-ERROR.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 271
* EL156.cbl
 14318
 14319     MOVE ER-3528            TO EMI-ERROR.
 14320     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14321     MOVE -1                 TO CDAYSL.
 14322     MOVE AL-UNBON           TO CDAYSA.
 14323
 14324 3299-EXIT.
 14325     EXIT.
 14326
 14327 3300-BUMP-DATE.
 14328
 14329     IF WS-RESTORE-DUE-DAY
 14330         MOVE 'N'              TO WS-DUE-DAY-SW
 14331         MOVE WS-SAVE-DUE-DA   TO WS-PMT-DUE-DA
 14332         ADD 1                 TO WS-PMT-DUE-MO
 14333         MOVE WS-PMT-DUE-MDY   TO DC-GREG-DATE-1-MDY
 14334         MOVE '4'              TO DC-OPTION-CODE
 14335         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14336         IF NO-CONVERSION-ERROR
 14337             MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 14338             MOVE DC-BIN-DATE-1      TO DC-BIN-DATE-2
 14339             GO TO 3399-EXIT
 14340         ELSE
 14341             MOVE '9'          TO DC-ERROR-CODE
 14342             GO TO 3399-EXIT.
 14343
 14344     IF (WS-PMT-DUE-MO = 1) AND
 14345        (WS-SAVE-DUE-DA > 28)
 14346           MOVE 'Y' TO WS-DUE-DAY-SW.
 14347
 14348     MOVE +0                 TO DC-ELAPSED-DAYS.
 14349     MOVE +1                 TO DC-ELAPSED-MONTHS.
 14350     MOVE '6'                TO DC-OPTION-CODE.
 14351     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14352
 14353 3399-EXIT.
 14354     EXIT.
 14355
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 272
* EL156.cbl
 14357 3400-COMPUTE-EXPIRY.
 14358
 14359     MOVE CM-LOAN-1ST-PMT-DT    TO DC-BIN-DATE-1.
 14360     MOVE +0                    TO DC-ELAPSED-DAYS
 14361                                   DC-ODD-DAYS-OVER.
 14362     MOVE '1'                   TO DC-END-OF-MONTH.
 14363     MOVE '6'                   TO DC-OPTION-CODE.
 14364
 14365     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 14366         COMPUTE DC-ELAPSED-MONTHS = CM-LF-ORIG-TERM - +1
 14367     ELSE
 14368         COMPUTE DC-ELAPSED-MONTHS = CM-AH-ORIG-TERM - +1.
 14369
 14370     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14371     IF NO-CONVERSION-ERROR
 14372         MOVE DC-BIN-DATE-2  TO WS-EXP-DT PI-EXP-DT
 14373     ELSE
 14374         GO TO 3390-CONTINUE.
 14375
 14376     IF CL-CLAIM-TYPE NOT = PI-LIFE-OVERRIDE-L1
 14377         GO TO 3390-CONTINUE.
 14378
 14379     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 14380     MOVE '4'                    TO CNTL-REC-TYPE.
 14381     MOVE +0                     TO CNTL-SEQ-NO.
 14382     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 14383     MOVE WS-ACCESS              TO CNTL-ACCESS.
 14384     MOVE 'BENE'                 TO FILE-SWITCH.
 14385
 14386     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 14387
 14388     IF NO-BENEFIT-FOUND
 14389         GO TO 3390-CONTINUE.
 14390
 14391     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP'
 14392        IF (PI-OFFLINE = 'Y') OR
 14393           (PI-PMTTYPE = '7')
 14394           PERFORM 9870-OUTPUT-ACTIVITY-RECORD
 14395                                     THRU 9870-EXIT
 14396           IF ERROR-ON-OUTPUT
 14397             MOVE -1                 TO ENTERPFL
 14398             MOVE AL-UANON           TO ENTERPFA
 14399             MOVE MAP-NAMEA          TO MAP-NAME
 14400             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14401             GO TO 8200-SEND-DATAONLY.
 14402
 14403     IF (CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1)  AND
 14404        (CF-CO-EARNINGS-CALC (SUB-1) = 'B' OR 'K' OR 'L') AND
 14405        (CF-SPECIAL-CALC-CD  (SUB-1) = 'L')
 14406          MOVE WS-EXP-DT TO DC-BIN-DATE-1
 14407          MOVE +0        TO DC-ELAPSED-DAYS
 14408          MOVE +1        TO DC-ELAPSED-MONTHS
 14409          MOVE 6         TO DC-OPTION-CODE
 14410          PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14411          IF NO-CONVERSION-ERROR
 14412              MOVE DC-BIN-DATE-2  TO WS-EXP-DT PI-EXP-DT.
 14413
 14414 3390-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 273
* EL156.cbl
 14415
 14416      IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 14417         MOVE CM-AH-LOAN-EXPIRE-DT
 14418                                 TO DC-BIN-DATE-1
 14419      ELSE
 14420         MOVE CM-LF-LOAN-EXPIRE-DT
 14421                                 TO DC-BIN-DATE-1
 14422      END-IF
 14423
 14424      MOVE ' '                    TO DC-OPTION-CODE.
 14425      PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14426      MOVE DC-GREG-DATE-1-MDY     TO WS-TEMP-DATE-MDY.
 14427      MOVE WS-TEMP-DA             TO PI-LOAN-DUE-DAY.
 14428
 14429 3499-EXIT.
 14430     EXIT.
 14431
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 274
* EL156.cbl
 14433
 14434 3600-CHECK-VERIFICATION.
 14435
 14436     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 14437
 14438     MOVE PI-PAYEE-SEQ-NUM       TO TRLR-SEQ-NO.
 14439
 14440     IF PI-PAYEE-TYPE = 'I'
 14441        GO TO 3600-READ-TRAILER.
 14442
 14443     IF PI-PAYEE-TYPE = 'B'
 14444        ADD +10                  TO TRLR-SEQ-NO
 14445        GO TO 3600-READ-TRAILER.
 14446
 14447     IF PI-PAYEE-TYPE = 'A'
 14448        ADD +20                  TO TRLR-SEQ-NO
 14449        GO TO 3600-READ-TRAILER.
 14450
 14451     IF PI-PAYEE-TYPE = 'O'
 14452        ADD +50                  TO TRLR-SEQ-NO
 14453        GO TO 3600-READ-TRAILER.
 14454
 14455     IF PI-PAYEE-TYPE = 'Q'
 14456        ADD +60                  TO TRLR-SEQ-NO
 14457        GO TO 3600-READ-TRAILER.
 14458
 14459     IF PI-PAYEE-TYPE = 'P'
 14460        ADD +30                  TO TRLR-SEQ-NO
 14461        GO TO 3600-READ-TRAILER.
 14462
 14463     IF PI-PAYEE-TYPE = 'E'
 14464        ADD +40                  TO TRLR-SEQ-NO.
 14465
 14466 3600-READ-TRAILER.
 14467
 14468
 14469* EXEC CICS HANDLE CONDITION
 14470*         NOTFND(3600-CONTINUE)
 14471*    END-EXEC.
 14472*    MOVE '"$I                   ! - #00013690' TO DFHEIV0
 14473     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14474     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14475     MOVE X'2D20233030303133363930' TO DFHEIV0(25:11)
 14476     CALL 'kxdfhei1' USING DFHEIV0
 14477     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14478
 14479
 14480     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 14481
 14482 3600-CONTINUE.
 14483
 14484     IF CL-CLAIM-TYPE NOT = PI-LIFE-OVERRIDE-L1
 14485         GO TO 3600-AH-VERIFY
 14486     END-IF.
 14487
 14488     IF PI-VFY-2ND-BENE = 'L' OR 'B'
 14489       IF AT-MAIL-TO-NAME (1:9) <> 'ESTATE OF'
 14490         IF AT-VFY-2ND-BENE-VERIFIED <> 'Y'
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 275
* EL156.cbl
 14491           MOVE ER-7576            TO EMI-ERROR
 14492           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14493           MOVE -1                 TO PAYEEL
 14494           MOVE AL-UABON           TO PAYEEA
 14495           GO TO 3600-EXIT
 14496         END-IF
 14497       END-IF
 14498     END-IF.
 14499
 14500     MOVE AT-MAIL-TO-NAME TO WS-WORK-NAME.
 14501     MOVE 1 TO WS-SUB2
 14502     MOVE SPACES TO WS-PAYEE-NAME
 14503     PERFORM VARYING WS-SUB FROM 1 BY 1
 14504             UNTIL WS-SUB > 30
 14505         IF WS-WORK-NAME-X (WS-SUB) > SPACES
 14506            MOVE WS-WORK-NAME-X (WS-SUB) TO
 14507                 WS-PAYEE-NAME-X (WS-SUB2)
 14508            ADD +1 TO WS-SUB2
 14509         END-IF
 14510     END-PERFORM.
 14511
 14512     STRING CL-INSURED-1ST-NAME
 14513            CL-INSURED-MID-INIT
 14514            CL-INSURED-LAST-NAME INTO WS-WORK-NAME.
 14515     MOVE 1 TO WS-SUB2
 14516     MOVE SPACES TO WS-INSURED-NAME
 14517     PERFORM VARYING WS-SUB FROM 1 BY 1
 14518             UNTIL WS-SUB > 30
 14519         IF WS-WORK-NAME-X (WS-SUB) > SPACES
 14520            MOVE WS-WORK-NAME-X (WS-SUB) TO
 14521                 WS-INSURED-NAME-X (WS-SUB2)
 14522            ADD +1 TO WS-SUB2
 14523         END-IF
 14524     END-PERFORM.
 14525
 14526     IF WS-PAYEE-NAME = WS-INSURED-NAME
 14527        MOVE ER-7579            TO EMI-ERROR
 14528        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14529        MOVE -1                 TO PAYEEL
 14530        MOVE AL-UABON           TO PAYEEA
 14531     END-IF.
 14532
 14533     IF PI-PMTTYPE = '4'  AND
 14534        WS-PAYEE-NAME (1:8) = 'ESTATEOF'  AND
 14535        PI-PAYEE-TYPE <> 'I'
 14536          MOVE ER-7580          TO EMI-ERROR
 14537          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14538          MOVE -1               TO PAYEEL
 14539          MOVE AL-UABON         TO PAYEEA
 14540     END-IF.
 14541
 14542     GO TO 3600-EXIT.
 14543
 14544 3600-AH-VERIFY.
 14545
 14546     IF PI-VFY-2ND-BENE = 'A' OR 'B'
 14547        IF AT-VFY-2ND-BENE-VERIFIED <> 'Y'
 14548           MOVE ER-7583            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 276
* EL156.cbl
 14549           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14550           MOVE -1                 TO PAYEEL
 14551           MOVE AL-UABON           TO PAYEEA
 14552        END-IF
 14553     END-IF.
 14554
 14555
 14556 3600-EXIT.
 14557     EXIT.
 14558
 14559 5000-UPDATE.
 14560
 14561     PERFORM 7300-CHECK-AUTO-ACTIVITY THRU 7399-EXIT.
 14562
 14563     PERFORM 6200-UPDATE-CLAIM-MSTR THRU 6299-EXIT.
 14564
 14565     IF PI-PMTTYPE = '4' AND PI-EPYAMT NEGATIVE  OR
 14566        PI-OFFLINE = 'Y'
 14567        NEXT SENTENCE
 14568     ELSE
 14569        PERFORM 6700-UPDATE-ACTQ THRU 6799-EXIT.
 14570
 14571*    IF PI-COMPANY-ID = 'CRI'
 14572*       IF PI-PMTTYPE = '1' OR  '2'
 14573*          IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 14574*             PERFORM 6800-BUILD-FORM-TRAILER   THRU 6899-EXIT
 14575*             PERFORM 6900-BUILD-ARCHIVE-HEADER THRU 6999-EXIT.
 14576
 14577*    IF PI-COMPANY-ID = 'RMC' OR 'LAP'
 14578*       IF PI-PMTTYPE = '1'
 14579*          IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 14580*             PERFORM 6800-BUILD-FORM-TRAILER THRU 6899-EXIT.
 14581
 14582     IF PI-PMTTYPE      = '2' AND
 14583        PI-SPLIT-PMT-SW = 'Y' AND
 14584        CL-CLAIM-TYPE   = PI-LIFE-OVERRIDE-L1
 14585          MOVE ER-3530                TO EMI-ERROR
 14586          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14587
 14588     IF (PI-COMPANY-ID = 'CID' OR 'AHL')
 14589        AND (CL-CLAIM-TYPE = 'L')
 14590        IF PI-PMTTYPE = '2' OR '4'
 14591           IF PI-INT-AMT NOT = ZEROS
 14592              PERFORM 7110-BUILD-PMT-TRLR
 14593                                 THRU 7130-EXIT
 14594           ELSE
 14595              IF PI-PMTTYPE = '2'
 14596                 PERFORM 7140-BUILD-NOTE-TRLR
 14597                                 THRU 7170-EXIT
 14598              END-IF
 14599           END-IF
 14600        END-IF
 14601     END-IF
 14602*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 14603*        IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 14604*            MOVE 'N'                 TO  WS-LETTER-SW.
 14605
 14606*    IF PI-COMPANY-ID = 'DMD'
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 277
* EL156.cbl
 14607*        IF CL-NO-OF-PMTS-MADE = +1
 14608*                OR
 14609*           PI-PMTTYPE = '2'
 14610*            PERFORM 5300-CREATE-DMO THRU 5300-EXIT.
 14611
 14612     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
 14613
 14614*    IF PI-COMPANY-ID = 'DMD'
 14615*       IF CL-CERT-NO (5:2) = '69' OR '70'
 14616*           PERFORM 6600-UPDATE-DLO035 THRU 6600-EXIT.
 14617
 14618
 14619* EXEC CICS REWRITE
 14620*         DATASET('ELMSTR')
 14621*         FROM(CLAIM-MASTER)
 14622*     END-EXEC.
 14623     MOVE LENGTH OF
 14624      CLAIM-MASTER
 14625       TO DFHEIV11
 14626     MOVE 'ELMSTR' TO DFHEIV1
 14627*    MOVE '&& L                  %   #00013832' TO DFHEIV0
 14628     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 14629     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 14630     MOVE X'2020233030303133383332' TO DFHEIV0(25:11)
 14631     CALL 'kxdfhei1' USING DFHEIV0,
 14632           DFHEIV1,
 14633           CLAIM-MASTER,
 14634           DFHEIV11,
 14635           DFHEIV99
 14636     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14637
 14638
 14639     IF WS-LETTER-SW = 'N'
 14640         GO TO 5000-END-UPDATE.
 14641
 14642 5000-GENERATE-AUTO-LETTER.
 14643
 14644
 14645* EXEC CICS LINK
 14646*        PROGRAM    (LINK-1523)
 14647*        COMMAREA   (W-1523-LINKDATA)
 14648*        LENGTH     (W-1523-COMM-LENGTH)
 14649*    END-EXEC.
 14650*    MOVE '."C                   (   #00013842' TO DFHEIV0
 14651     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14652     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14653     MOVE X'2020233030303133383432' TO DFHEIV0(25:11)
 14654     CALL 'kxdfhei1' USING DFHEIV0,
 14655           LINK-1523,
 14656           W-1523-LINKDATA,
 14657           W-1523-COMM-LENGTH,
 14658           DFHEIV99,
 14659           DFHEIV99,
 14660           DFHEIV99,
 14661           DFHEIV99
 14662     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14663
 14664
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 278
* EL156.cbl
 14665     IF W-1523-FATAL-ERROR
 14666         MOVE W-1523-ERROR-CODE      TO  EMI-ERROR
 14667         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14668         MOVE ER-0802                TO  EMI-ERROR
 14669         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14670
 14671     IF W-1523-ERROR-CODE = 0191
 14672         MOVE ER-0803                TO  EMI-ERROR
 14673         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14674
 14675     IF PI-COMPANY-ID      = 'HAN' AND
 14676        PI-PMTTYPE         = '1'   AND
 14677        PI-3RD-PARTY-SW    = 'Y'   AND
 14678        W-1523-FORM-NUMBER = 'EOB1'
 14679           MOVE LOW-VALUES              TO W-1523-LINKDATA
 14680           MOVE PROGRAM-INTERFACE-BLOCK TO W-1523-COMMON-PI-DATA
 14681           MOVE 'EOB3'                  TO W-1523-FORM-NUMBER
 14682           GO TO 5000-GENERATE-AUTO-LETTER.
 14683
 14684 5000-END-UPDATE.
 14685
 14686     MOVE ER-0000                TO EMI-ERROR.
 14687     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14688     GO TO 7000-SHOW-CLAIM.
 14689
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 279
* EL156.cbl
 14691 5000-MOVE-NAME.
 14692     MOVE CL-INSURED-LAST-NAME   TO LSTNMEO.
 14693     MOVE CL-INSURED-1ST-NAME    TO FSTNMEO.
 14694     MOVE CL-INSURED-MID-INIT    TO MINITO.
 14695
 14696 5000-EXIT.
 14697     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 280
* EL156.cbl
 14699 5300-CREATE-DMO.
 14700
 14701     MOVE CL-CERT-KEY-DATA       TO W-NOTE-CERT-KEY.
 14702     MOVE PI-COMPANY-CD          TO W-NOTE-COMP-CD.
 14703     MOVE CL-CERT-NO             TO W-NOTE-CERT-NO.
 14704
 14705
 14706* EXEC CICS HANDLE CONDITION
 14707*         NOTFND   (5300-NOTE-NOT-FOUND)
 14708*    END-EXEC.
 14709*    MOVE '"$I                   ! . #00013888' TO DFHEIV0
 14710     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14711     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14712     MOVE X'2E20233030303133383838' TO DFHEIV0(25:11)
 14713     CALL 'kxdfhei1' USING DFHEIV0
 14714     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14715
 14716
 14717
 14718* EXEC CICS READ
 14719*         DATASET('ERNOTE')
 14720*         SET    (ADDRESS OF CERTIFICATE-NOTE)
 14721*         RIDFLD (W-NOTE-KEY)
 14722*    END-EXEC.
 14723     MOVE 'ERNOTE' TO DFHEIV1
 14724*    MOVE '&"S        E          (   #00013892' TO DFHEIV0
 14725     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14726     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14727     MOVE X'2020233030303133383932' TO DFHEIV0(25:11)
 14728     CALL 'kxdfhei1' USING DFHEIV0,
 14729           DFHEIV1,
 14730           DFHEIV20,
 14731           DFHEIV99,
 14732           W-NOTE-KEY,
 14733           DFHEIV99,
 14734           DFHEIV99,
 14735           DFHEIV99
 14736     SET ADDRESS OF CERTIFICATE-NOTE TO
 14737         DFHEIV20
 14738     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14739
 14740
 14741     MOVE SPACES                 TO DCT-COMMUNICATION-AREA.
 14742     MOVE CL-BENEFICIARY         TO DCT-LOGIC-BENEFICIARY-ID.
 14743     MOVE CL-CCN                 TO DCT-CREDIT-CARD-NUMBER.
 14744
 14745     IF CL-CERT-GROUPING (5:2) = ZEROS OR SPACES
 14746         MOVE 'CC'                   TO DCT-PRODUCT-CODE
 14747     ELSE
 14748         MOVE CL-CERT-GROUPING (5:2) TO DCT-PRODUCT-CODE.
 14749
 14750     MOVE CN-CSI-CC-BILL-BANK-ID TO DCT-BILLING-BANK-ID.
 14751     MOVE '02'                   TO DCT-COLUMN-ID-REQUESTED.
 14752     MOVE 'DLO006'               TO PGM-NAME.
 14753
 14754
 14755* EXEC CICS LINK
 14756*        PROGRAM    (PGM-NAME)
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 281
* EL156.cbl
 14757*        COMMAREA   (DCT-COMMUNICATION-AREA)
 14758*        LENGTH     (DCT-RCRD-LENGTH)
 14759*    END-EXEC.
 14760*    MOVE '."C                   (   #00013911' TO DFHEIV0
 14761     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14762     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14763     MOVE X'2020233030303133393131' TO DFHEIV0(25:11)
 14764     CALL 'kxdfhei1' USING DFHEIV0,
 14765           PGM-NAME,
 14766           DCT-COMMUNICATION-AREA,
 14767           DCT-RCRD-LENGTH,
 14768           DFHEIV99,
 14769           DFHEIV99,
 14770           DFHEIV99,
 14771           DFHEIV99
 14772     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14773
 14774
 14775     IF DCT-RETURN-CODE = 'OK'
 14776         GO TO 5300-CONT.
 14777
 14778     IF DCT-RETURN-CODE = '01' OR '02'
 14779         GO TO 5300-EXIT.
 14780
 14781     IF DCT-RETURN-CODE = '03'
 14782         MOVE ER-0951            TO EMI-ERROR
 14783         GO TO 5300-BAD-EXIT.
 14784
 14785     IF DCT-RETURN-CODE = '04'
 14786         MOVE ER-0946            TO EMI-ERROR
 14787         GO TO 5300-BAD-EXIT.
 14788
 14789     IF DCT-RETURN-CODE = '05'
 14790         MOVE ER-0947            TO EMI-ERROR
 14791         GO TO 5300-BAD-EXIT.
 14792
 14793     IF DCT-RETURN-CODE = '06'
 14794         MOVE ER-0921            TO EMI-ERROR
 14795         GO TO 5300-BAD-EXIT.
 14796
 14797     IF DCT-RETURN-CODE = '07'
 14798         MOVE ER-0849            TO EMI-ERROR
 14799         GO TO 5300-BAD-EXIT.
 14800
 14801     IF DCT-RETURN-CODE = '08'
 14802         MOVE ER-0948            TO EMI-ERROR
 14803         GO TO 5300-BAD-EXIT.
 14804
 14805     IF DCT-RETURN-CODE = 'N1'
 14806         MOVE ER-0950            TO EMI-ERROR
 14807         GO TO 5300-BAD-EXIT.
 14808
 14809     IF DCT-RETURN-CODE = 'E1'
 14810         MOVE ER-0974            TO EMI-ERROR
 14811         GO TO 5300-BAD-EXIT.
 14812
 14813     IF DCT-RETURN-CODE = 'E2'
 14814         MOVE ER-0975            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 282
* EL156.cbl
 14815         GO TO 5300-BAD-EXIT.
 14816
 14817     IF DCT-RETURN-CODE NOT = 'OK'
 14818         MOVE ER-0949            TO EMI-ERROR
 14819         GO TO 5300-BAD-EXIT.
 14820
 14821 5300-CONT.
 14822
 14823     MOVE SPACES                 TO DMO-COMMUNICATION-AREA.
 14824     MOVE 'CS'                   TO DM-RECORD-TYPE.
 14825     MOVE DCT-DISTRIBUTION-CODE  TO DM-DIST-CODE.
 14826     MOVE DCT-MAIL-CODE          TO DM-MAIL-CODE.
 14827     MOVE CL-CLAIM-NO            TO DM-CLAIM-NO.
 14828     MOVE CL-CERT-NO (4:1)       TO DM-CLAIM-TYPE.
 14829     MOVE CL-CCN                 TO DM-CREDIT-CARD-NUMBER.
 14830     MOVE SAVE-DATE-CCYYMMDD     TO DM-STATUS-DATE.
 14831
 14832     MOVE CL-INSURED-LAST-NAME   TO W-NAME-LAST.
 14833     MOVE CL-INSURED-1ST-NAME    TO W-NAME-FIRST.
 14834     MOVE CL-INSURED-MID-INIT    TO W-NAME-MIDDLE.
 14835     PERFORM 5350-FORMAT-LAST-NAME-1ST THRU 5350-EXIT.
 14836     MOVE WS-NAME-WORK           TO DM-INSURED-NAME.
 14837
 14838     MOVE CL-CARRIER             TO DM-STAT-CARRIER.
 14839
 14840     IF PI-PMTTYPE = '2'
 14841         MOVE 'F'                TO DM-STAT-CHANGE-TYPE
 14842         MOVE '4'                TO DM-CLAIM-STATUS
 14843     ELSE
 14844         MOVE 'I'                TO DM-STAT-CHANGE-TYPE
 14845         MOVE '2'                TO DM-CLAIM-STATUS.
 14846
 14847     MOVE 'DLO025'               TO PGM-NAME.
 14848
 14849
 14850* EXEC CICS LINK
 14851*        PROGRAM    (PGM-NAME)
 14852*        COMMAREA   (DMO-COMMUNICATION-AREA)
 14853*        LENGTH     (DM-DMO-LENGTH)
 14854*    END-EXEC.
 14855*    MOVE '."C                   (   #00013991' TO DFHEIV0
 14856     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14857     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14858     MOVE X'2020233030303133393931' TO DFHEIV0(25:11)
 14859     CALL 'kxdfhei1' USING DFHEIV0,
 14860           PGM-NAME,
 14861           DMO-COMMUNICATION-AREA,
 14862           DM-DMO-LENGTH,
 14863           DFHEIV99,
 14864           DFHEIV99,
 14865           DFHEIV99,
 14866           DFHEIV99
 14867     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14868
 14869
 14870     IF DM-RETURN-CODE = 'OK'
 14871         GO TO 5300-EXIT.
 14872
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 283
* EL156.cbl
 14873     IF DM-RETURN-CODE = '01'
 14874         MOVE ER-8051            TO EMI-ERROR
 14875         GO TO 5300-BAD-EXIT.
 14876
 14877     IF DM-RETURN-CODE = '02'
 14878         MOVE ER-8052            TO EMI-ERROR
 14879         GO TO 5300-BAD-EXIT.
 14880
 14881     IF DM-RETURN-CODE = '03'
 14882         MOVE ER-8053            TO EMI-ERROR
 14883         GO TO 5300-BAD-EXIT.
 14884
 14885     IF DM-RETURN-CODE = '04'
 14886         MOVE ER-8054            TO EMI-ERROR
 14887         GO TO 5300-BAD-EXIT.
 14888
 14889     IF DM-RETURN-CODE = '05'
 14890         MOVE ER-8055            TO EMI-ERROR
 14891         GO TO 5300-BAD-EXIT.
 14892
 14893     IF DM-RETURN-CODE = '06'
 14894         MOVE ER-8056            TO EMI-ERROR
 14895         GO TO 5300-BAD-EXIT.
 14896
 14897     IF DM-RETURN-CODE = '07'
 14898         MOVE ER-8057            TO EMI-ERROR
 14899         GO TO 5300-BAD-EXIT.
 14900
 14901     IF DM-RETURN-CODE = '08'
 14902         MOVE ER-8058            TO EMI-ERROR
 14903         GO TO 5300-BAD-EXIT.
 14904
 14905     IF DM-RETURN-CODE = '09'
 14906         MOVE ER-8059            TO EMI-ERROR
 14907         GO TO 5300-BAD-EXIT.
 14908
 14909     IF DM-RETURN-CODE = '10'
 14910         MOVE ER-8060            TO EMI-ERROR
 14911         GO TO 5300-BAD-EXIT.
 14912
 14913     IF DM-RETURN-CODE = '11'
 14914         MOVE ER-8061            TO EMI-ERROR
 14915         GO TO 5300-BAD-EXIT.
 14916
 14917     IF DM-RETURN-CODE = '12'
 14918         MOVE ER-8062            TO EMI-ERROR
 14919         GO TO 5300-BAD-EXIT.
 14920
 14921     IF DM-RETURN-CODE = '13'
 14922         MOVE ER-8063            TO EMI-ERROR
 14923         GO TO 5300-BAD-EXIT.
 14924
 14925     IF DM-RETURN-CODE = '14'
 14926         MOVE ER-8064            TO EMI-ERROR
 14927         GO TO 5300-BAD-EXIT.
 14928
 14929     IF DM-RETURN-CODE = '15'
 14930         MOVE ER-8065            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 284
* EL156.cbl
 14931         GO TO 5300-BAD-EXIT.
 14932
 14933     IF DM-RETURN-CODE = '16'
 14934         MOVE ER-8154            TO EMI-ERROR
 14935         GO TO 5300-BAD-EXIT.
 14936
 14937     IF DM-RETURN-CODE = '17'
 14938         MOVE ER-8155            TO EMI-ERROR
 14939         GO TO 5300-BAD-EXIT.
 14940
 14941     IF DM-RETURN-CODE = 'N1'
 14942         MOVE ER-8152            TO EMI-ERROR
 14943         GO TO 5300-BAD-EXIT.
 14944
 14945     IF DM-RETURN-CODE = 'E1'
 14946         MOVE ER-8153            TO EMI-ERROR
 14947         GO TO 5300-BAD-EXIT.
 14948
 14949     MOVE ER-8066            TO EMI-ERROR.
 14950     GO TO 5300-BAD-EXIT.
 14951
 14952 5300-NOTE-NOT-FOUND.
 14953
 14954     MOVE ER-0954                TO EMI-ERROR.
 14955     GO TO 5300-BAD-EXIT.
 14956
 14957 5300-BAD-EXIT.
 14958
 14959* EXEC CICS SYNCPOINT ROLLBACK END-EXEC.
 14960*    MOVE '6"R                   !   #00014085' TO DFHEIV0
 14961     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 14962     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14963     MOVE X'2020233030303134303835' TO DFHEIV0(25:11)
 14964     CALL 'kxdfhei1' USING DFHEIV0
 14965     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14966
 14967     IF MAP-NAME = 'EL156A'
 14968         MOVE -1             TO ENTERPFL
 14969       ELSE
 14970         MOVE LOW-VALUES     TO EL156BI
 14971         MOVE -1             TO ENTPFBL.
 14972
 14973     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14974     GO TO 8200-SEND-DATAONLY.
 14975
 14976 5300-EXIT.
 14977     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 285
* EL156.cbl
 14979 5350-FORMAT-LAST-NAME-1ST.
 14980*****************************************************************
 14981*             M O V E   N A M E   R O U T I N E                 *
 14982*     THE FOLLOWING ROUTINE REARRANGES A GIVEN NAME SO          *
 14983*     THAT IT READS LAST, FIRST, MIDDLE.  PLACE NAME            *
 14984*     FIELDS IN THE FOLLOWING WORKING STORAGE FIELDS.           *
 14985*                  FIELD                   VALUE                *
 14986*           W-NAME-LAST    (CL15)      SMITH                    *
 14987*           W-NAME-FIRST   (CL15)      JOHN                     *
 14988*           W-NAME-MIDDLE  (CL15)      ALLEN                    *
 14989*     AFTER NAME HAS BEEN MOVED WS-NAME-WORK (CL30) WILL        *
 14990*     CONTAIN                                                   *
 14991*                SMITH, JOHN ALLEN                              *
 14992*     OR                                                        *
 14993*                SMITH, JOHN A.                                 *
 14994*     TO USE THIS ROUTINE YOU NEED THE WORKING STORAGE          *
 14995*     COPYBOOK, ELCNWA.                                         *
 14996*****************************************************************.
 14997
 14998     MOVE SPACES                 TO  WS-NAME-WORK-AREA.
 14999     MOVE ZERO                   TO  WS-NAME-SW.
 15000     SET NWA-INDEX               TO +1.
 15001
 15002     IF W-NAME-LAST   = SPACES AND
 15003        W-NAME-MIDDLE = SPACES
 15004         MOVE +1                 TO WS-NAME-SW.
 15005
 15006     MOVE W-NAME-LAST            TO WS-NAME-WORK2.
 15007     PERFORM 5360-MOVE-NAME THRU 5360-EXIT.
 15008
 15009     MOVE W-NAME-FIRST           TO WS-NAME-WORK2.
 15010     PERFORM 5360-MOVE-NAME THRU 5360-EXIT.
 15011
 15012     SET NWA-INDEX UP BY +1.
 15013
 15014     IF W-NAME-MIDDLE NOT = SPACES
 15015         IF W-NAME-MIDDLE-2 = SPACES
 15016             MOVE W-NAME-MIDDLE  TO WS-NW (NWA-INDEX)
 15017             SET NWA-INDEX UP BY +1
 15018             MOVE '.'            TO WS-NW (NWA-INDEX)
 15019             SET NWA-INDEX UP BY +2
 15020         ELSE
 15021             MOVE W-NAME-MIDDLE  TO WS-NAME-WORK2
 15022             PERFORM 5360-MOVE-NAME THRU 5360-EXIT.
 15023
 15024 5350-EXIT.
 15025     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 286
* EL156.cbl
 15027 5360-MOVE-NAME.
 15028
 15029     IF WS-NAME-SW > +1
 15030         GO TO 5360-EXIT.
 15031
 15032     IF WS-NAME-WORK2 = SPACES
 15033         GO TO 5360-EXIT.
 15034
 15035     SET NWA-INDEX2            TO +1.
 15036     SET NWA-INDEX3            TO +2.
 15037
 15038 5360-MOVE-NAME-CYCLE.
 15039
 15040     MOVE WS-NW2 (NWA-INDEX2)  TO  WS-NW (NWA-INDEX).
 15041
 15042     IF NWA-INDEX < +30
 15043         SET NWA-INDEX UP BY +1
 15044     ELSE
 15045         ADD +2                TO  WS-NAME-SW
 15046         GO TO 5360-EXIT.
 15047
 15048     IF NWA-INDEX2 < +20
 15049         SET NWA-INDEX3 UP BY +1
 15050         SET NWA-INDEX2 UP BY +1.
 15051
 15052     IF WS-NW2 (NWA-INDEX2) = SPACES AND
 15053        WS-NW2 (NWA-INDEX3) = SPACES
 15054         IF WS-NAME-SW = ZERO
 15055             MOVE ','            TO  WS-NW (NWA-INDEX)
 15056             SET NWA-INDEX UP BY +2
 15057             MOVE +1             TO  WS-NAME-SW
 15058             GO TO 5360-EXIT
 15059         ELSE
 15060             GO TO 5360-EXIT.
 15061
 15062     GO TO 5360-MOVE-NAME-CYCLE.
 15063
 15064 5360-EXIT.
 15065     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 287
* EL156.cbl
 15067 6000-BUILD-SCREEN-B.
 15068     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 15069     MOVE PI-CARRIER             TO MSTR-CARRIER.
 15070     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
 15071     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
 15072
 15073     PERFORM 7900-READ-CLAIM THRU 7900-EXIT.
 15074
 15075 6050-BUILD-SCREEN.
 15076     PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT.
 15077     MOVE LOW-VALUES             TO EL156BI.
 15078     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 15079
 15080     MOVE PI-PAYEE-SEQ-NUM       TO TRLR-SEQ-NO.
 15081
 15082     IF PI-PAYEE-TYPE = 'I'
 15083        GO TO 6060-READ-TRAILER.
 15084
 15085     IF PI-PAYEE-TYPE = 'B'
 15086        ADD +10                  TO TRLR-SEQ-NO
 15087        GO TO 6060-READ-TRAILER.
 15088
 15089     IF PI-PAYEE-TYPE = 'A'
 15090        ADD +20                  TO TRLR-SEQ-NO
 15091        GO TO 6060-READ-TRAILER.
 15092
 15093     IF PI-PAYEE-TYPE = 'O'
 15094        ADD +50                  TO TRLR-SEQ-NO
 15095        GO TO 6060-READ-TRAILER.
 15096
 15097     IF PI-PAYEE-TYPE = 'Q'
 15098        ADD +60                  TO TRLR-SEQ-NO
 15099        GO TO 6060-READ-TRAILER.
 15100
 15101     IF PI-PAYEE-TYPE = 'P'
 15102        ADD +30                  TO TRLR-SEQ-NO
 15103        GO TO 6060-READ-TRAILER.
 15104
 15105     IF PI-PAYEE-TYPE = 'E'
 15106        ADD +40                  TO TRLR-SEQ-NO.
 15107
 15108 6060-READ-TRAILER.
 15109
 15110     IF PI-PAYEE-TYPE    = 'A' AND
 15111        PI-PAYEE-SEQ-NUM = 0
 15112          GO TO 6061-READ-ACCOUNT.
 15113
 15114     IF (PI-COMPANY-ID    = 'AIG' OR 'AUK')  AND
 15115        (PI-PAYEE-TYPE    = 'B')             AND
 15116        (PI-PAYEE-SEQ-NUM = 9)
 15117          PERFORM 7920-READ-BENE THRU 7920-EXIT
 15118          IF BENE-FOUND-SW = 'N'
 15119            GO TO 6065-NOT-FOUND
 15120          ELSE
 15121            MOVE BE-MAIL-TO-NAME   TO PI-PAYEE-NAME  NAMEBO
 15122            MOVE BE-ADDRESS-LINE-1 TO ADDR1BO
 15123            MOVE BE-ADDRESS-LINE-2 TO ADDR2BO
 15124*           MOVE BE-CITY-STATE     TO CITYSTBO
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 288
* EL156.cbl
 15125            STRING BE-CITY ' ' BE-STATE
 15126               DELIMITED BY '  ' INTO CITYSTBO
 15127            END-STRING
 15128            MOVE BE-ZIP-CODE       TO ZIPBO
 15129            GO TO 6061-READ-ACCOUNT.
 15130
 15131     IF PI-PAYEE-TYPE    = 'B' AND
 15132        PI-PAYEE-SEQ-NUM = 0
 15133          PERFORM 7920-READ-BENE THRU 7920-EXIT
 15134          IF BENE-FOUND-SW = 'N'
 15135            GO TO 6065-NOT-FOUND
 15136          ELSE
 15137            MOVE BE-MAIL-TO-NAME   TO PI-PAYEE-NAME  NAMEBO
 15138            MOVE BE-ADDRESS-LINE-1 TO ADDR1BO
 15139            MOVE BE-ADDRESS-LINE-2 TO ADDR2BO
 15140*           MOVE BE-CITY-STATE     TO CITYSTBO
 15141            STRING BE-CITY ' ' BE-STATE
 15142               DELIMITED BY '  ' INTO CITYSTBO
 15143            END-STRING
 15144            MOVE BE-ZIP-CODE       TO ZIPBO
 15145            if be-ach-yes-or-no = 'Y'
 15146               move 'Y'          to pi-ach-payment
 15147            else
 15148               move 'N'          to pi-ach-payment
 15149            end-if
 15150            GO TO 6061-READ-ACCOUNT.
 15151
 15152
 15153* EXEC CICS HANDLE CONDITION
 15154*         NOTFND(6065-NOT-FOUND)
 15155*     END-EXEC.
 15156*    MOVE '"$I                   ! / #00014271' TO DFHEIV0
 15157     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15158     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15159     MOVE X'2F20233030303134323731' TO DFHEIV0(25:11)
 15160     CALL 'kxdfhei1' USING DFHEIV0
 15161     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15162
 15163
 15164     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 15165
 15166     MOVE AT-MAIL-TO-NAME        TO PI-PAYEE-NAME.
 15167     MOVE AT-MAIL-TO-NAME        TO NAMEBO.
 15168     MOVE AT-ADDRESS-LINE-1      TO ADDR1BO.
 15169     MOVE AT-ADDRESS-LINE-2      TO ADDR2BO.
 15170*    MOVE AT-CITY-STATE          TO CITYSTBO.
 15171     STRING AT-CITY ' ' AT-STATE
 15172        DELIMITED BY '  ' INTO CITYSTBO
 15173     END-STRING
 15174     MOVE AT-ZIP-CODE            TO ZIPBO.
 15175
 15176 6061-READ-ACCOUNT.
 15177
 15178* EXEC CICS HANDLE CONDITION
 15179*         NOTFND(6068-ACCT-NOT-FND)
 15180*     END-EXEC.
 15181*    MOVE '"$I                   ! 0 #00014288' TO DFHEIV0
 15182     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 289
* EL156.cbl
 15183     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15184     MOVE X'3020233030303134323838' TO DFHEIV0(25:11)
 15185     CALL 'kxdfhei1' USING DFHEIV0
 15186     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15187
 15188
 15189
 15190* EXEC CICS READ
 15191*         DATASET('ERACCT')
 15192*         SET    (ADDRESS OF ACCOUNT-MASTER)
 15193*         RIDFLD (PI-ACCT-KEY)
 15194*     END-EXEC.
 15195     MOVE 'ERACCT' TO DFHEIV1
 15196*    MOVE '&"S        E          (   #00014292' TO DFHEIV0
 15197     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15198     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15199     MOVE X'2020233030303134323932' TO DFHEIV0(25:11)
 15200     CALL 'kxdfhei1' USING DFHEIV0,
 15201           DFHEIV1,
 15202           DFHEIV20,
 15203           DFHEIV99,
 15204           PI-ACCT-KEY,
 15205           DFHEIV99,
 15206           DFHEIV99,
 15207           DFHEIV99
 15208     SET ADDRESS OF ACCOUNT-MASTER TO
 15209         DFHEIV20
 15210     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15211
 15212
 15213     MOVE AM-CARRIER             TO ACARRBO.
 15214     MOVE AM-GROUPING            TO GROUPBO.
 15215     MOVE AM-STATE               TO STATEBO.
 15216     MOVE AM-ACCOUNT             TO ACCTBO.
 15217     MOVE AM-NAME                TO ACCTNMBO.
 15218
 15219     IF PI-PAYEE-TYPE = 'A' AND
 15220        PI-PAYEE-SEQ-NUM = 0
 15221          MOVE AM-NAME             TO NAMEBO
 15222                                      PI-PAYEE-NAME
 15223          MOVE AM-ADDRS            TO ADDR1BO
 15224          MOVE SPACES              TO ADDR2BO
 15225*         MOVE AM-CITY             TO CITYSTBO
 15226          STRING AM-ADDR-CITY ' ' AM-ADDR-STATE
 15227             DELIMITED BY '  ' INTO CITYSTBO
 15228          END-STRING
 15229          MOVE AM-ZIP-PRIME        TO WS-ZIP
 15230          MOVE AM-ZIP-PLUS4        TO WS-ZIP-EXT
 15231          INSPECT WS-WORK-ZIP REPLACING ALL SPACES BY '0'
 15232          MOVE WS-NUMERIC-ZIP      TO ZIPBO.
 15233
 15234***  We don't really need the code below because we don't do the
 15235***  AK thing anymore.  However, we may have a state special
 15236***  of some sort in the future so why not just leave it??
 15237     IF CITYSTBO EQUAL SPACES
 15238         MOVE 'XX' TO PI-CHECK-STATE-FOR-AK
 15239         GO TO 6070-FORMAT-DATA
 15240     END-IF.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 290
* EL156.cbl
 15241
 15242     MOVE CITYSTBO TO WS-PAYEE-CITY-STATE.
 15243     MOVE 'N' TO WS-PAYEE-STATE-FOUND.
 15244     MOVE 0 TO WS-BEG-SUB WS-END-SUB.
 15245     PERFORM VARYING WS-SUB FROM 30 BY -1
 15246          UNTIL WS-SUB = 0 OR PAYEE-STATE-FOUND
 15247        IF WS-END-SUB = 0  AND
 15248           (WS-PAYEE-CITY-ST (WS-SUB) EQUAL SPACES
 15249              OR LOW-VALUES  OR '.')
 15250            CONTINUE
 15251        ELSE
 15252            IF WS-END-SUB = 0
 15253                MOVE WS-SUB TO WS-END-SUB
 15254            ELSE
 15255                IF WS-PAYEE-CITY-ST (WS-SUB) = SPACES
 15256                    COMPUTE WS-BEG-SUB = WS-SUB + 1
 15257                    MOVE 'Y' TO WS-PAYEE-STATE-FOUND
 15258                END-IF
 15259            END-IF
 15260        END-IF
 15261        IF WS-PAYEE-CITY-ST (WS-SUB) EQUAL ','
 15262            COMPUTE WS-BEG-SUB = WS-SUB + 1
 15263            MOVE 'Y' TO WS-PAYEE-STATE-FOUND
 15264        END-IF
 15265     END-PERFORM.
 15266
 15267     IF WS-BEG-SUB > 0
 15268         COMPUTE WS-STATE-LENGTH = WS-END-SUB - WS-BEG-SUB + 1
 15269         IF WS-STATE-LENGTH = 2
 15270             MOVE WS-PAYEE-CITY-STATE (WS-BEG-SUB:WS-STATE-LENGTH)
 15271                  TO PI-CHECK-STATE-FOR-AK
 15272         ELSE
 15273             IF WS-PAYEE-CITY-STATE (WS-BEG-SUB:WS-STATE-LENGTH) =
 15274                'ALASKA'
 15275                 MOVE 'AK' TO PI-CHECK-STATE-FOR-AK
 15276             ELSE
 15277                 MOVE 'XX' TO PI-CHECK-STATE-FOR-AK
 15278             END-IF
 15279         END-IF
 15280     ELSE
 15281         MOVE 'XX' TO PI-CHECK-STATE-FOR-AK
 15282     END-IF.
 15283
 15284     GO TO 6070-FORMAT-DATA.
 15285
 15286 6065-NOT-FOUND.
 15287     MOVE 'NO ADDRESS RECORD FOUND'  TO ADDR1BO.
 15288     GO TO 6061-READ-ACCOUNT.
 15289
 15290 6068-ACCT-NOT-FND.
 15291     MOVE 'NO ACCOUNT RECORD FOUND'  TO ACCTNMBO.
 15292
 15293 6070-FORMAT-DATA.
 15294     IF PI-HOLDTIL = ZEROS
 15295        MOVE SAVE-DATE           TO PAYDTBI
 15296       ELSE
 15297        MOVE PI-HOLDTIL          TO PAYDTBO
 15298        INSPECT PAYDTBI REPLACING ALL SPACES BY '/'.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 291
* EL156.cbl
 15299
 15300     MOVE PI-PROOF-DATE          TO PROOFDBO.
 15301     INSPECT PROOFDBI REPLACING ALL SPACES BY '/'.
 15302
 15303     IF EIBAID = DFHPF3 OR DFHPF4
 15304        NEXT SENTENCE
 15305     ELSE
 15306       GO TO 6071-CONTINUE.
 15307
 15308     MOVE PI-EPYFROM          TO PYFROMBO.
 15309     INSPECT PYFROMBI REPLACING ALL SPACES BY '/'.
 15310
 15311     IF NOT PI-USES-PAID-TO
 15312        MOVE PI-EPYTHRU          TO PYTHRUBO
 15313        INSPECT PYTHRUBI REPLACING ALL SPACES BY '/'
 15314     ELSE
 15315        MOVE PI-EPYTHRU       TO DC-GREG-DATE-1-MDY
 15316        MOVE '4'              TO DC-OPTION-CODE
 15317        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15318        IF NO-CONVERSION-ERROR
 15319           MOVE +1            TO DC-ELAPSED-DAYS
 15320           MOVE +0            TO DC-ELAPSED-MONTHS
 15321           MOVE '6'           TO DC-OPTION-CODE
 15322           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15323           IF NO-CONVERSION-ERROR
 15324              MOVE DC-GREG-DATE-1-EDIT TO PYTHRUBI.
 15325
 15326     MOVE PI-EDAYS            TO DAYSBO.
 15327     MOVE PI-EPYAMT           TO PAYAMTBO.
 15328     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 15329        IF PI-INT-AMT > ZEROS
 15330           MOVE PI-INT-AMT       TO INTAMTBO
 15331        END-IF
 15332     END-IF
 15333     GO TO 6072-SET-TYPE.
 15334
 15335 6071-CONTINUE.
 15336
 15337     IF PI-CPYFROM NOT = LOW-VALUES
 15338        MOVE PI-CPYFROM          TO DC-BIN-DATE-1
 15339        MOVE SPACES              TO DC-OPTION-CODE
 15340        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15341        MOVE DC-GREG-DATE-1-EDIT TO PYFROMBI.
 15342
 15343     IF PI-CPYTHRU NOT = LOW-VALUES
 15344        IF NOT PI-USES-PAID-TO
 15345           MOVE PI-CPYTHRU         TO DC-BIN-DATE-1
 15346           MOVE SPACES             TO DC-OPTION-CODE
 15347           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15348           MOVE DC-GREG-DATE-1-EDIT TO PYTHRUBI
 15349        ELSE
 15350           MOVE PI-CPYTHRU         TO DC-BIN-DATE-1
 15351           MOVE '6'                TO DC-OPTION-CODE
 15352           MOVE +1                 TO DC-ELAPSED-DAYS
 15353           MOVE +0                 TO DC-ELAPSED-MONTHS
 15354           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15355           MOVE DC-GREG-DATE-1-EDIT TO PYTHRUBI.
 15356
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 292
* EL156.cbl
 15357     MOVE PI-CDAYS               TO DAYSBO.
 15358     MOVE PI-CPYAMT              TO PAYAMTBO.
 15359     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 15360        IF PI-INT-AMT > ZEROS
 15361           MOVE PI-INT-AMT       TO INTAMTBO
 15362        END-IF
 15363     END-IF
 15364     .
 15365 6072-SET-TYPE.
 15366     IF PI-PMTTYPE = '1'
 15367        MOVE 'PARTIAL'           TO PAYTYPBO.
 15368
 15369     IF PI-PMTTYPE = '2'
 15370        MOVE 'FINAL'             TO PAYTYPBO.
 15371
 15372     IF PI-PMTTYPE = '3'
 15373        MOVE 'LUMP SUM'          TO PAYTYPBO.
 15374
 15375     IF PI-PMTTYPE = '4'
 15376        MOVE 'ADDITIONAL'        TO PAYTYPBO.
 15377
 15378     IF PI-PMTTYPE = '5'
 15379        MOVE 'CHARGEABLE'        TO PAYTYPBO.
 15380
 15381     IF PI-PMTTYPE = '6'
 15382        MOVE 'NON-CHARGEABLE'    TO PAYTYPBO.
 15383
 15384     IF PI-PROV-PMT
 15385        MOVE 'PROVISIONAL   '    TO PAYTYPBO.
 15386
 15387     IF PI-ECHECKNO NOT = SPACES
 15388        MOVE PI-ECHECKNO         TO CKNUMBO
 15389     ELSE
 15390        MOVE PI-CCHECKNO         TO CKNUMBO.
 15391
 15392     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP'
 15393        MOVE ELMSTR-KEY          TO  ELTRLR-KEY
 15394        MOVE +91                 TO  TRLR-SEQ-NO
 15395
 15396* EXEC CICS READ
 15397*           DATASET  ('ELTRLR')
 15398*           SET      (ADDRESS OF ACTIVITY-TRAILERS)
 15399*           RIDFLD   (ELTRLR-KEY)
 15400*           RESP     (WS-RESPONSE)
 15401*       END-EXEC
 15402     MOVE 'ELTRLR' TO DFHEIV1
 15403*    MOVE '&"S        E          (  N#00014480' TO DFHEIV0
 15404     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15405     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15406     MOVE X'204E233030303134343830' TO DFHEIV0(25:11)
 15407     CALL 'kxdfhei1' USING DFHEIV0,
 15408           DFHEIV1,
 15409           DFHEIV20,
 15410           DFHEIV99,
 15411           ELTRLR-KEY,
 15412           DFHEIV99,
 15413           DFHEIV99,
 15414           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 293
* EL156.cbl
 15415     SET ADDRESS OF ACTIVITY-TRAILERS TO
 15416         DFHEIV20
 15417     MOVE EIBRESP  TO WS-RESPONSE
 15418     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15419
 15420        IF WS-RESP-NORMAL
 15421           MOVE AT-INFO-LINE-1   TO  LOANNBO
 15422        ELSE
 15423           MOVE SPACES           TO  LOANNBO
 15424        END-IF
 15425     END-IF
 15426
 15427*       MOVE PI-LOAN-NO          TO LOANNBO
 15428
 15429     IF CKNUMBO = SPACES
 15430         MOVE SPACES             TO CKNUMHDO.
 15431
 15432     MOVE CL-CLAIM-NO            TO CLMNOBO.
 15433     MOVE CL-CARRIER             TO CARRBO.
 15434     MOVE CL-CERT-PRIME          TO CERTNOBO.
 15435     MOVE CL-CERT-SFX            TO SUFXBO.
 15436
 15437     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 15438        EVALUATE CL-CLAIM-TYPE
 15439           WHEN 'I'
 15440              MOVE '  IU  '      TO CLMTYPBO
 15441           WHEN 'G'
 15442              MOVE ' GAP  '      TO CLMTYPBO
 15443           WHEN 'F'
 15444              MOVE ' FMLA '      TO CLMTYPBO
 15445           WHEN OTHER
 15446              MOVE PI-AH-OVERRIDE-L6
 15447                                 TO CLMTYPBO
 15448        END-EVALUATE
 15449        MOVE ZEROS               TO UNDISBO
 15450*       MOVE PI-AH-OVERRIDE-L6   TO CLMTYPBO
 15451        IF PI-PMTTYPE = '5' OR '6'
 15452           GO TO 6073-GET-NOTIFY-DATA
 15453        ELSE
 15454           MOVE PI-DAILY-RATE    TO RATEBO
 15455           GO TO 6073-GET-NOTIFY-DATA.
 15456
 15457     MOVE PI-LIFE-OVERRIDE-L6    TO CLMTYPBO.
 15458
 15459     IF (PI-PMTTYPE = '5' OR '6') OR EIBAID = DFHPF5
 15460        MOVE ZEROS               TO UNDISBO
 15461     ELSE
 15462        COMPUTE UNDISBO = PI-CPYAMT - PI-EPYAMT.
 15463
 15464 6073-GET-NOTIFY-DATA.
 15465
 15466     MOVE 'N'                    TO  PI-3RD-PARTY-SW.
 15467
 15468     IF AM-NOTIF-OF-PAYMENTS NOT = 'Y'
 15469         MOVE SPACES             TO  NAMEB2O
 15470                                     ADDR1B2O
 15471                                     ADDR2B2O
 15472                                     CITYST2O
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 294
* EL156.cbl
 15473                                     AGTHDGO
 15474         MOVE ZEROS              TO  ZIPB2O
 15475         GO TO 6080-SET-INCURRED.
 15476
 15477     MOVE ELMSTR-KEY             TO  ELTRLR-KEY.
 15478     MOVE +29                    TO  TRLR-SEQ-NO.
 15479
 15480
 15481* EXEC CICS HANDLE CONDITION
 15482*        NOTFND   (6074-GET-COMP-DATA)
 15483*    END-EXEC.
 15484*    MOVE '"$I                   ! 1 #00014547' TO DFHEIV0
 15485     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15486     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15487     MOVE X'3120233030303134353437' TO DFHEIV0(25:11)
 15488     CALL 'kxdfhei1' USING DFHEIV0
 15489     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15490
 15491
 15492     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 15493
 15494     MOVE AT-MAIL-TO-NAME        TO  NAMEB2O.
 15495     MOVE AT-ADDRESS-LINE-1      TO  ADDR1B2O.
 15496     MOVE AT-ADDRESS-LINE-2      TO  ADDR2B2O.
 15497*    MOVE AT-CITY-STATE          TO  CITYST2O.
 15498     STRING AT-CITY ' ' AT-STATE
 15499        DELIMITED BY '  ' INTO CITYST2O
 15500     END-STRING
 15501     MOVE AT-ZIP-CODE            TO  ZIPB2O.
 15502     GO TO 6080-SET-INCURRED.
 15503
 15504 6074-GET-COMP-DATA.
 15505
 15506     IF AM-3RD-PARTY-NOTIF-LEVEL IS NOT NUMERIC
 15507         MOVE ZEROS              TO  AM-3RD-PARTY-NOTIF-LEVEL.
 15508
 15509     IF AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL) = ZEROS OR SPACES
 15510         MOVE 'NO ADDRESS AVAILABLE' TO  NAMEB2O
 15511                                         ADDR1B2O
 15512                                         ADDR2B2O
 15513                                         CITYST2O
 15514         MOVE ZEROS                  TO  ZIPB2O
 15515         GO TO 6080-SET-INCURRED.
 15516
 15517     MOVE 'Y'                    TO  PI-3RD-PARTY-SW.
 15518     MOVE AM-COMPANY-CD          TO  COMP-COMP-CD.
 15519     MOVE AM-CARRIER             TO  COMP-CARRIER.
 15520     MOVE AM-GROUPING            TO  COMP-GROUP.
 15521     MOVE 'A'                    TO  COMP-TYPE.
 15522     MOVE AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL)
 15523                                 TO  COMP-FIN-RESP.
 15524
 15525     IF AM-3RD-PARTY-NOTIF-LEVEL = AM-REMIT-TO
 15526         IF AM-COM-TYP (AM-REMIT-TO) = 'O' OR 'P' OR
 15527                                       'G' OR 'B' or 'S'
 15528             MOVE 'G'            TO  COMP-TYPE
 15529             MOVE LOW-VALUES     TO  COMP-ACCOUNT
 15530         ELSE
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 295
* EL156.cbl
 15531             MOVE AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL)
 15532                                 TO  COMP-ACCOUNT
 15533     ELSE
 15534         MOVE 'G'                TO  COMP-TYPE
 15535         MOVE LOW-VALUES         TO  COMP-ACCOUNT.
 15536
 15537     PERFORM 7800-READ-COMP-MSTR THRU 7800-COMP-EXIT.
 15538
 15539     IF COMP-REC-FOUND
 15540         MOVE CO-ACCT-NAME       TO  NAMEB2O
 15541         MOVE CO-ADDR-1          TO  ADDR1B2O
 15542         MOVE CO-ADDR-2          TO  ADDR2B2O
 15543*        MOVE CO-ADDR-3          TO  CITYST2O
 15544         STRING CO-ADDR-CITY ' ' CO-ADDR-STATE
 15545            DELIMITED BY '  ' INTO CITYST2O
 15546         END-STRING
 15547         MOVE CO-ZIP             TO  ZIPB2O
 15548     ELSE
 15549         MOVE 'NO COMP ADDRESS AVAILABLE'
 15550                                 TO  NAMEB2O
 15551                                     ADDR1B2O
 15552                                     ADDR2B2O
 15553                                     CITYST2O
 15554         MOVE ZEROS               TO ZIPB2O.
 15555
 15556 6080-SET-INCURRED.
 15557     MOVE CL-INCURRED-DT         TO DC-BIN-DATE-1.
 15558     MOVE SPACES                 TO DC-OPTION-CODE.
 15559     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 15560     MOVE DC-GREG-DATE-1-EDIT    TO INCURBO.
 15561     MOVE PI-PROCESSOR-ID        TO BYBO.
 15562     MOVE MAP-NAMEB              TO MAP-NAME.
 15563     MOVE 'C'                    TO PI-PASS-SW.
 15564     MOVE EIBAID                 TO PI-PFKEY-USED.
 15565     MOVE -1                     TO ENTPFBL.
 15566     GO TO 8100-SEND-INITIAL-MAP.
 15567
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 296
* EL156.cbl
 15569 6100-BUILD-PAYMENT-TRAILER.
 15570
 15571     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15572     MOVE '6'                    TO CNTL-REC-TYPE.
 15573
 15574     IF CONTROL-IS-ACTUAL-CARRIER
 15575         MOVE PI-CARRIER         TO WS-CARR
 15576     ELSE
 15577         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 15578
 15579     IF PI-COMPANY-ID = 'FIA'
 15580         MOVE PI-CARRIER         TO  WS-CARR.
 15581
 15582     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 15583     MOVE 0                      TO CNTL-SEQ-NO.
 15584     MOVE 'CARR'                 TO FILE-SWITCH.
 15585
 15586     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 15587
 15588     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 15589         IF PI-OFFLINE     = 'Y' AND
 15590            PI-ECHECKNO-CR = 'CR'
 15591              GO TO 6110-READ-CONTROL
 15592         ELSE
 15593            IF PI-CASH = 'N'
 15594                GO TO 6110-READ-CONTROL.
 15595
 15596     IF CHECK-NO-MANUAL    OR
 15597        CHECK-NO-AT-PRINT  OR
 15598        PI-OFFLINE = 'Y'
 15599          GO TO 6130-BUILD-TRAILER.
 15600     IF PI-COMPANY-ID = 'FIA'
 15601         NEXT SENTENCE
 15602     ELSE
 15603         IF NOT CONTROL-IS-ACTUAL-CARRIER
 15604             GO TO 6110-READ-CONTROL.
 15605
 15606     PERFORM 7940-READ-CONTROL-UPDATE THRU 7940-EXIT.
 15607
 15608     IF CHECK-CNT-RESET-VALUE
 15609        MOVE +1                  TO CF-CHECK-COUNTER
 15610     ELSE
 15611        ADD +1                   TO CF-CHECK-COUNTER.
 15612
 15613     MOVE CF-CHECK-COUNTER       TO WS-CHECK-NUMERIC.
 15614
 15615     IF CHECK-NO-CARR-SEQ
 15616        MOVE PI-CARRIER          TO WS-CHECK-CARR.
 15617
 15618     MOVE WS-CHECK-AREA          TO PI-CCHECKNO.
 15619
 15620     MOVE 'N' TO PI-REAUDIT-NEEDED.
 15621     IF CF-CHECK-COUNTER >= CF-CARRIER-NEXT-AUDIT-CHK-NO  AND
 15622        CF-CARRIER-NEXT-AUDIT-CHK-NO > ZERO
 15623         MOVE 'Y' TO PI-REAUDIT-NEEDED
 15624         COMPUTE WRK-NEXT-AUDIT-CHK-NO =
 15625            CF-CHECK-COUNTER + PI-REAUDIT-INTERVAL
 15626         MOVE WRK-NEXT-AUDIT-CHK-NO TO
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 297
* EL156.cbl
 15627                      CF-CARRIER-NEXT-AUDIT-CHK-NO
 15628     END-IF.
 15629
 15630     GO TO 6120-REWRITE.
 15631
 15632 6105-STATE-CHECK-NUMBER.
 15633     IF CHECK-NO-MANUAL    OR
 15634        CHECK-NO-AT-PRINT  OR
 15635        PI-OFFLINE = 'Y'
 15636           GO TO 6130-BUILD-TRAILER
 15637     END-IF.
 15638
 15639     MOVE PI-COMPANY-ID      TO CNTL-COMP-ID.
 15640     MOVE PI-CHECK-STATE-FOR-AK TO WS-ST-ACCESS.
 15641     MOVE WS-STATE-ACCESS    TO CNTL-ACCESS.
 15642     MOVE '3'                TO CNTL-REC-TYPE.
 15643     MOVE +0                 TO CNTL-SEQ-NO.
 15644     MOVE 'STAT'             TO FILE-SWITCH.
 15645     PERFORM 7940-READ-CONTROL-UPDATE THRU 7940-EXIT.
 15646
 15647     IF CF-ST-CHECK-CNT-RESET
 15648         MOVE +1             TO CF-ST-CHECK-COUNTER
 15649     ELSE
 15650         ADD +1              TO CF-ST-CHECK-COUNTER
 15651     END-IF.
 15652
 15653     MOVE CF-ST-CHECK-COUNTER TO WS-CHECK-NUMERIC.
 15654     MOVE WS-CHECK-AREA       TO PI-CCHECKNO.
 15655     GO TO 6120-REWRITE.
 15656
 15657 6110-READ-CONTROL.
 15658     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15659     MOVE '1'                    TO CNTL-REC-TYPE.
 15660     MOVE SPACES                 TO CNTL-ACCESS.
 15661     MOVE 0                      TO CNTL-SEQ-NO.
 15662
 15663     PERFORM 7940-READ-CONTROL-UPDATE THRU 7940-EXIT.
 15664
 15665     IF CO-CHECK-COUNT-RESET
 15666        MOVE +1                  TO CF-CO-CHECK-COUNTER
 15667     ELSE
 15668        ADD +1                   TO CF-CO-CHECK-COUNTER.
 15669
 15670     MOVE CF-CO-CHECK-COUNTER    TO WS-CHECK-NUMERIC.
 15671
 15672     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 15673         IF PI-OFFLINE     = 'Y'  AND
 15674            PI-ECHECKNO-CR = 'CR'
 15675              MOVE WS-A-CHECK-NUM-5   TO PI-ECHECKNO-5
 15676              MOVE PI-ECHECKNO        TO PI-CCHECKNO CHECKNOO
 15677              MOVE AL-UANON           TO CHECKNOA
 15678              GO TO 6120-REWRITE
 15679         ELSE
 15680         IF PI-CASH = 'N'
 15681             MOVE 'N'                TO PI-ECHECKNO-N
 15682             MOVE WS-A-CHECK-NUM-6   TO PI-ECHECKNO-6
 15683             MOVE PI-ECHECKNO        TO PI-CCHECKNO CHECKNOO
 15684             MOVE AL-UANON           TO CHECKNOA
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 298
* EL156.cbl
 15685             GO TO 6120-REWRITE.
 15686
 15687     MOVE WS-CHECK-NUMERIC       TO PI-CCHECKNO.
 15688
 15689 6120-REWRITE.
 15690
 15691* EXEC CICS REWRITE
 15692*         DATASET('ELCNTL')
 15693*         FROM(CONTROL-FILE)
 15694*     END-EXEC.
 15695     MOVE LENGTH OF
 15696      CONTROL-FILE
 15697       TO DFHEIV11
 15698     MOVE 'ELCNTL' TO DFHEIV1
 15699*    MOVE '&& L                  %   #00014749' TO DFHEIV0
 15700     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15701     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15702     MOVE X'2020233030303134373439' TO DFHEIV0(25:11)
 15703     CALL 'kxdfhei1' USING DFHEIV0,
 15704           DFHEIV1,
 15705           CONTROL-FILE,
 15706           DFHEIV11,
 15707           DFHEIV99
 15708     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15709
 15710
 15711     MOVE 'Y'                    TO PI-CK-ASSIGN.
 15712
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 299
* EL156.cbl
 15714 6130-BUILD-TRAILER.
 15715
 15716
 15717* EXEC CICS GETMAIN
 15718*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 15719*         LENGTH    (200)
 15720*         INITIMG   (GETMAIN-SPACE)
 15721*     END-EXEC.
 15722     MOVE 200
 15723       TO DFHEIV11
 15724*    MOVE ',"IL                  $   #00014759' TO DFHEIV0
 15725     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 15726     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15727     MOVE X'2020233030303134373539' TO DFHEIV0(25:11)
 15728     CALL 'kxdfhei1' USING DFHEIV0,
 15729           DFHEIV20,
 15730           DFHEIV11,
 15731           GETMAIN-SPACE
 15732     SET ADDRESS OF ACTIVITY-TRAILERS TO
 15733         DFHEIV20
 15734     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15735
 15736
 15737     MOVE LOW-VALUES             TO AT-PREV-LAST-PMT-DT
 15738                                    AT-PREV-PAID-THRU-DT.
 15739     MOVE LOW-VALUES             TO AT-PMT-PROOF-DT.
 15740     MOVE ZEROS                  TO AT-PREV-LAST-PMT-AMT.
 15741     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY.
 15742     MOVE 'AT'                   TO AT-RECORD-ID.
 15743     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 15744
 15745     IF (PI-PMTNOTE1 = SPACES OR LOW-VALUES) AND
 15746        (PI-PMTNOTE2 = SPACES OR LOW-VALUES)
 15747           MOVE +0               TO AT-PAYMENT-NOTE-SEQ-NO
 15748     ELSE
 15749           MOVE AT-SEQUENCE-NO   TO AT-PAYMENT-NOTE-SEQ-NO
 15750           SUBTRACT +1         FROM AT-PAYMENT-NOTE-SEQ-NO.
 15751
 15752     IF PI-COMPANY-ID = 'LAP' OR 'RMC'
 15753         IF AT-PAYMENT-NOTE-SEQ-NO = ZERO
 15754             MOVE AT-SEQUENCE-NO TO AT-FORM-CTL-SEQ-NO
 15755             SUBTRACT +1       FROM AT-FORM-CTL-SEQ-NO
 15756           ELSE
 15757             MOVE AT-PAYMENT-NOTE-SEQ-NO TO AT-FORM-CTL-SEQ-NO
 15758             SUBTRACT +1               FROM AT-FORM-CTL-SEQ-NO.
 15759
 15760     MOVE '2'                    TO AT-TRAILER-TYPE.
 15761     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 15762                                    AT-PAYMENT-LAST-MAINT-DT.
 15763     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 15764                                    AT-PAYMENT-LAST-UPDATED-BY.
 15765     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 15766     MOVE PI-PMTTYPE             TO AT-PAYMENT-TYPE.
 15767     MOVE CL-CLAIM-TYPE          TO AT-CLAIM-TYPE.
 15768     MOVE CL-CLAIM-PREM-TYPE     TO AT-CLAIM-PREM-TYPE.
 15769
 15770     IF PI-PMT-APPROVED
 15771        IF PI-OFFLINE  = 'N'
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 300
* EL156.cbl
 15772           MOVE 'U'              TO AT-PAYMENT-APPROVAL-SW.
 15773
 15774     IF PI-PFKEY-USED = DFHPF5
 15775        GO TO 6140-PF5-ENTERED.
 15776
 15777     MOVE PI-EEXPENS             TO AT-EXPENSE-PER-PMT.
 15778     MOVE PI-EPYAMT              TO AT-AMOUNT-PAID.
 15779
 15780     IF PI-AIG-SPECIAL-BENEFIT
 15781         IF WS-1ST-SPECIAL-PMT
 15782             COMPUTE AT-AMOUNT-PAID ROUNDED = PI-EPYAMT / 1.5
 15783             COMPUTE PI-REDUND-PMTAMT = PI-EPYAMT -
 15784                                        AT-AMOUNT-PAID
 15785         ELSE
 15786             MOVE PI-REDUND-PMTAMT TO AT-AMOUNT-PAID.
 15787
 15788     MOVE PI-ETYPE               TO AT-EXPENSE-TYPE.
 15789
 15790     MOVE PI-EPYFROM             TO DC-GREG-DATE-1-MDY.
 15791     MOVE '4'                    TO DC-OPTION-CODE.
 15792     PERFORM 9700-LINK-DATE-CONVERT.
 15793
 15794     IF DATE-CONVERSION-ERROR
 15795        MOVE LOW-VALUES          TO AT-PAID-FROM-DT
 15796     ELSE
 15797        MOVE DC-BIN-DATE-1       TO AT-PAID-FROM-DT.
 15798
 15799     MOVE PI-EPYTHRU             TO DC-GREG-DATE-1-MDY.
 15800     MOVE '4'                    TO DC-OPTION-CODE.
 15801     PERFORM 9700-LINK-DATE-CONVERT.
 15802
 15803     IF DATE-CONVERSION-ERROR
 15804        MOVE LOW-VALUES          TO AT-PAID-THRU-DT
 15805     ELSE
 15806        MOVE DC-BIN-DATE-1       TO AT-PAID-THRU-DT.
 15807
 15808     MOVE PI-EDAYS               TO AT-DAYS-IN-PERIOD
 15809     move pi-ach-payment         to at-ach-payment
 15810     GO TO 6150-FINISH-MOVE.
 15811
 15812 6140-PF5-ENTERED.
 15813     MOVE PI-CEXPENS             TO AT-EXPENSE-PER-PMT.
 15814     MOVE PI-CPYAMT              TO AT-AMOUNT-PAID.
 15815
 15816     IF PI-AIG-SPECIAL-BENEFIT
 15817         IF WS-1ST-SPECIAL-PMT
 15818             COMPUTE AT-AMOUNT-PAID ROUNDED = PI-CPYAMT / 1.5
 15819             COMPUTE PI-REDUND-PMTAMT = PI-CPYAMT -
 15820                                        AT-AMOUNT-PAID
 15821         ELSE
 15822             MOVE PI-REDUND-PMTAMT TO AT-AMOUNT-PAID.
 15823
 15824     MOVE PI-CPYFROM             TO AT-PAID-FROM-DT.
 15825     MOVE PI-CPYTHRU             TO AT-PAID-THRU-DT.
 15826     MOVE PI-CDAYS               TO AT-DAYS-IN-PERIOD.
 15827
 15828 6150-FINISH-MOVE.
 15829
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 301
* EL156.cbl
 15830     IF PI-ECHECKNO = SPACES
 15831         MOVE PI-CCHECKNO    TO AT-CHECK-NO
 15832     ELSE
 15833         MOVE PI-ECHECKNO    TO AT-CHECK-NO.
 15834
 15835     MOVE PI-PAYEE               TO AT-PAYEE-TYPE-CD.
 15836     MOVE PI-PAYEE-NAME          TO AT-PAYEES-NAME.
 15837
 15838*    MOVE PI-GROUPED             TO AT-GROUPED-PAYMENT.
 15839*    MOVE PI-CASH                TO AT-CASH-PAYMENT.
 15840
 15841     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 15842         MOVE CL-ASSOCIATES      TO AT-ASSOCIATES.
 15843
 15844     IF PI-OFFLINE = 'N'
 15845        MOVE '1'                 TO AT-PAYMENT-ORIGIN
 15846        MOVE LOW-VALUES          TO AT-PMT-SELECT-DT
 15847     ELSE
 15848        MOVE PI-MONTH-END-SAVE   TO AT-PMT-SELECT-DT
 15849        MOVE '3'                 TO AT-PAYMENT-ORIGIN.
 15850
 15851     move pi-ach-payment         to at-ach-payment
 15852     MOVE SPACES                 TO AT-AIG-UNEMP-IND.
 15853
 15854     IF WS-2ND-SPECIAL-PMT
 15855         MOVE 'Y'                TO AT-CASH-PAYMENT
 15856         MOVE SPACES             TO AT-CHECK-NO
 15857         MOVE '3'                TO AT-PAYMENT-ORIGIN
 15858         MOVE PI-MONTH-END-SAVE  TO AT-PMT-SELECT-DT
 15859         MOVE 'U'                TO AT-AIG-UNEMP-IND
 15860         MOVE 'I'                TO AT-PAYEE-TYPE-CD.
 15861
 15862     MOVE LOW-VALUES             TO AT-CHECK-WRITTEN-DT
 15863                                    AT-TO-BE-WRITTEN-DT.
 15864
 15865     IF PI-HOLDTIL NOT = ZEROS
 15866        MOVE PI-HOLDTIL          TO DC-GREG-DATE-1-MDY
 15867        MOVE '4'                 TO DC-OPTION-CODE
 15868        PERFORM 9700-LINK-DATE-CONVERT
 15869        IF PI-OFFLINE = 'N'
 15870           MOVE DC-BIN-DATE-1    TO AT-TO-BE-WRITTEN-DT
 15871           MOVE 'P'              TO WS-HOLD-UNTIL-SW
 15872        ELSE
 15873           MOVE DC-BIN-DATE-1    TO AT-CHECK-WRITTEN-DT.
 15874
 15875     MOVE PI-ERESV               TO AT-ADDL-RESERVE.
 15876     MOVE ZEROS                  TO AT-CHECK-QUE-CONTROL
 15877                                    AT-CHECK-QUE-SEQUENCE.
 15878
 15879     IF PI-PFKEY-USED = DFHPF4
 15880        MOVE '1'                 TO AT-FORCE-CONTROL.
 15881
 15882     IF PI-PMTTYPE NOT = '4' AND '5' AND '6'
 15883        MOVE CL-LAST-PMT-DT      TO AT-PREV-LAST-PMT-DT
 15884        MOVE CL-PAID-THRU-DT     TO AT-PREV-PAID-THRU-DT
 15885        MOVE CL-LAST-PMT-AMT     TO AT-PREV-LAST-PMT-AMT.
 15886
 15887     MOVE LOW-VALUES             TO AT-PMT-ACCEPT-DT
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 302
* EL156.cbl
 15888                                    AT-VOID-SELECT-DT
 15889                                    AT-VOID-ACCEPT-DT
 15890                                    AT-VOID-DT.
 15891     IF (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F')
 15892        AND (PI-PMTTYPE NOT = '4' AND '5' AND '6')
 15893        MOVE PI-DAILY-RATE       TO AT-DAILY-RATE
 15894        MOVE PI-BEN-DAYS         TO AT-ELIMINATION-DAYS
 15895        MOVE PI-BEN-TYPE         TO AT-BENEFIT-TYPE
 15896     ELSE
 15897        MOVE ZEROS               TO AT-DAILY-RATE
 15898                                    AT-ELIMINATION-DAYS
 15899        MOVE SPACES              TO AT-BENEFIT-TYPE
 15900     END-IF
 15901     MOVE PI-PROOF-DATE          TO DC-GREG-DATE-1-MDY.
 15902     MOVE '4'                    TO DC-OPTION-CODE.
 15903     PERFORM 9700-LINK-DATE-CONVERT.
 15904     IF DATE-CONVERSION-ERROR
 15905         MOVE LOW-VALUES          TO AT-PMT-PROOF-DT
 15906     ELSE
 15907         MOVE DC-BIN-DATE-1       TO AT-PMT-PROOF-DT
 15908     END-IF.
 15909     MOVE PI-PRINT-EOB-YN        TO AT-PRINT-EOB-WITH-CHECK
 15910     MOVE PI-PRINT-CLM-FRM-YN    TO AT-PRINT-CLM-FORM
 15911     MOVE PI-PRINT-SURVEY-YN     TO AT-PRINT-SURVEY
 15912     MOVE PI-SPECIAL-RELEASE-YN  TO AT-SPECIAL-RELEASE
 15913     IF (PI-REAUDIT-NEEDED = 'Y')
 15914        or (pi-max-ext-used = 'Y')
 15915        OR (PI-APPROVAL-3550-NEEDED = 'Y')
 15916         PERFORM 6155-READ-CONTROL
 15917         PERFORM 6157-SET-APP-LEVEL
 15918         IF AT-APPROVAL-LEVEL-REQD < '4'
 15919            MOVE '4' TO AT-APPROVAL-LEVEL-REQD
 15920         END-IF
 15921         MOVE 'Y' TO WS-NEED-APPROVAL
 15922         GO TO 6170-WRITE
 15923     END-IF.
 15924*******************************************************
 15925     IF NOT PI-PMT-GRADUATED
 15926         GO TO 6170-WRITE.
 15927     PERFORM 6155-READ-CONTROL.
 15928
 15929     IF PAID-FOR-LIFE
 15930         IF AT-AMOUNT-PAID < PI-MAX-LF-PMT-TOL
 15931             MOVE 'A'            TO  AT-PAYMENT-APPROVAL-SW
 15932                                     WS-PMT-APPROVAL-SW
 15933             GO TO 6170-WRITE.
 15934
 15935*05999      IF PAID-FOR-AH
 15936     IF (PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP)
 15937         IF AT-AMOUNT-PAID < PI-MAX-PMT-TOL
 15938             MOVE 'A'            TO  AT-PAYMENT-APPROVAL-SW
 15939                                     WS-PMT-APPROVAL-SW
 15940             GO TO 6170-WRITE.
 15941
 15942     MOVE '1'                    TO AT-APPROVED-LEVEL.
 15943
 15944     PERFORM 6157-SET-APP-LEVEL.
 15945
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 303
* EL156.cbl
 15946     MOVE AT-APPROVAL-LEVEL-REQD TO WS-SAVE-APPROVAL-LEVEL-REQD.
 15947
 15948     IF NOT PI-PMT-GRADUATED
 15949         GO TO 6170-WRITE.
 15950
 15951
 15952* EXEC CICS HANDLE CONDITION
 15953*        NOTFND   (6170-WRITE)
 15954*    END-EXEC.
 15955*    MOVE '"$I                   ! 2 #00014979' TO DFHEIV0
 15956     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15957     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15958     MOVE X'3220233030303134393739' TO DFHEIV0(25:11)
 15959     CALL 'kxdfhei1' USING DFHEIV0
 15960     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15961
 15962
 15963     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15964     MOVE '2'                    TO CNTL-REC-TYPE.
 15965     MOVE +0                     TO CNTL-SEQ-NO.
 15966     MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS.
 15967
 15968
 15969* EXEC CICS READ
 15970*         DATASET  ('ELCNTL')
 15971*         SET      (ADDRESS OF CONTROL-FILE)
 15972*         RIDFLD   (ELCNTL-KEY)
 15973*    END-EXEC.
 15974     MOVE 'ELCNTL' TO DFHEIV1
 15975*    MOVE '&"S        E          (   #00014988' TO DFHEIV0
 15976     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15977     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15978     MOVE X'2020233030303134393838' TO DFHEIV0(25:11)
 15979     CALL 'kxdfhei1' USING DFHEIV0,
 15980           DFHEIV1,
 15981           DFHEIV20,
 15982           DFHEIV99,
 15983           ELCNTL-KEY,
 15984           DFHEIV99,
 15985           DFHEIV99,
 15986           DFHEIV99
 15987     SET ADDRESS OF CONTROL-FILE TO
 15988         DFHEIV20
 15989     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15990
 15991
 15992     MOVE CF-APPROVAL-LEVEL TO WS-APPROVAL-LEVEL.
 15993
 15994     IF WS-APPROVAL-LEVEL = '1' OR '2' OR '3'
 15995                         OR '4' OR '5'
 15996         NEXT SENTENCE
 15997     ELSE
 15998         MOVE 'Y' TO WS-NEED-APPROVAL
 15999         GO TO 6170-WRITE.
 16000
 16001     IF WS-APPROVAL-LEVEL < AT-APPROVAL-LEVEL-REQD
 16002         MOVE 'Y' TO WS-NEED-APPROVAL
 16003         IF WS-APPROVAL-LEVEL = '1'
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 304
* EL156.cbl
 16004             MOVE '2'        TO  AT-APPROVED-LEVEL
 16005                            WS-SAVE-APPROVED-LEVEL
 16006             GO TO 6170-WRITE
 16007         ELSE
 16008             IF WS-APPROVAL-LEVEL = '2'
 16009                 MOVE '3'        TO  AT-APPROVED-LEVEL
 16010                                WS-SAVE-APPROVED-LEVEL
 16011                 GO TO 6170-WRITE
 16012             ELSE IF WS-APPROVAL-LEVEL = '3'
 16013                 MOVE '4'        TO  AT-APPROVED-LEVEL
 16014                                WS-SAVE-APPROVED-LEVEL
 16015                 GO TO 6170-WRITE
 16016             ELSE IF WS-APPROVAL-LEVEL = '4'
 16017                 MOVE '5'        TO  AT-APPROVED-LEVEL
 16018                                WS-SAVE-APPROVED-LEVEL
 16019                 GO TO 6170-WRITE.
 16020
 16021     MOVE 'A'            TO  AT-PAYMENT-APPROVAL-SW
 16022                             WS-PMT-APPROVAL-SW.
 16023     MOVE SPACES         TO  AT-APPROVED-LEVEL
 16024                             AT-APPROVAL-LEVEL-REQD.
 16025
 16026*******************************************************
 16027 6155-READ-CONTROL.
 16028     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 16029     MOVE '1'                    TO CNTL-REC-TYPE.
 16030     MOVE SPACES                 TO CNTL-ACCESS.
 16031     MOVE +0                     TO CNTL-SEQ-NO.
 16032     MOVE 'COMP'                 TO FILE-SWITCH.
 16033
 16034     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 16035 6157-SET-APP-LEVEL.
 16036******A&H Limits are set as a monthly payment.  Calculate the mont
 16037******equivalent of the amount paid today
 16038     IF PI-SAVE-ELAPSED-MONTHS > 0 OR
 16039        PI-SAVE-ODD-DAYS-OVER > 0
 16040           COMPUTE WS-CALC-PMT-MONTHS = (PI-SAVE-ODD-DAYS-OVER
 16041                               / 30) + PI-SAVE-ELAPSED-MONTHS
 16042           COMPUTE WS-CALC-MO-AH-AMT ROUNDED = AT-AMOUNT-PAID /
 16043                                  WS-CALC-PMT-MONTHS
 16044     ELSE
 16045           MOVE AT-AMOUNT-PAID TO WS-CALC-MO-AH-AMT
 16046     END-IF.
 16047*06007      IF ((PAID-FOR-AH) AND
 16048     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP
 16049           OR PAID-FOR-FAM) AND
 16050*06008         (CF-AH-PAY-APP-LEVEL-1 >= AT-AMOUNT-PAID))
 16051        (CF-AH-PAY-APP-LEVEL-1 >= WS-CALC-MO-AH-AMT))
 16052              OR
 16053        ((PAID-FOR-LIFE) AND
 16054        (CF-LIFE-PAY-APP-LEVEL-1 >= AT-AMOUNT-PAID))
 16055            MOVE '1'         TO AT-APPROVAL-LEVEL-REQD
 16056       ELSE
 16057*06014      IF ((PAID-FOR-AH)  AND
 16058         IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP
 16059           OR PAID-FOR-FAM) AND
 16060*06015         (CF-AH-PAY-APP-LEVEL-2 >= AT-AMOUNT-PAID))
 16061           (CF-AH-PAY-APP-LEVEL-2 >= WS-CALC-MO-AH-AMT))
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 305
* EL156.cbl
 16062              OR
 16063        ((PAID-FOR-LIFE) AND
 16064        (CF-LIFE-PAY-APP-LEVEL-2 >= AT-AMOUNT-PAID))
 16065            MOVE '2'         TO AT-APPROVAL-LEVEL-REQD
 16066         ELSE
 16067*06021             MOVE '3'         TO AT-APPROVAL-LEVEL-REQD.
 16068           IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP
 16069                OR PAID-FOR-FAM) AND
 16070               (CF-AH-PAY-APP-LEVEL-3 >= WS-CALC-MO-AH-AMT))
 16071              OR
 16072          ((PAID-FOR-LIFE) AND
 16073          (CF-LIFE-PAY-APP-LEVEL-3 >= AT-AMOUNT-PAID))
 16074            MOVE '3'         TO AT-APPROVAL-LEVEL-REQD
 16075       ELSE
 16076           IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP
 16077                OR PAID-FOR-FAM) AND
 16078               (CF-AH-PAY-APP-LEVEL-4 >= WS-CALC-MO-AH-AMT))
 16079              OR
 16080          ((PAID-FOR-LIFE) AND
 16081          (CF-LIFE-PAY-APP-LEVEL-4 >= AT-AMOUNT-PAID))
 16082            MOVE '4'         TO AT-APPROVAL-LEVEL-REQD
 16083       ELSE
 16084            MOVE '5'         TO AT-APPROVAL-LEVEL-REQD.
 16085
 16086     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP
 16087           OR PAID-FOR-FAM) AND
 16088        (CF-AH-APP-DAY-LEVEL-1 >= AT-DAYS-IN-PERIOD))
 16089        IF ('1' >= AT-APPROVAL-LEVEL-REQD)
 16090            MOVE '1'         TO AT-APPROVAL-LEVEL-REQD
 16091        END-IF
 16092     ELSE
 16093     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP
 16094           OR PAID-FOR-FAM) AND
 16095        (CF-AH-APP-DAY-LEVEL-2 >= AT-DAYS-IN-PERIOD))
 16096        IF ('2' >= AT-APPROVAL-LEVEL-REQD)
 16097            MOVE '2'         TO AT-APPROVAL-LEVEL-REQD
 16098        END-IF
 16099     ELSE
 16100     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP
 16101           OR PAID-FOR-FAM) AND
 16102        (CF-AH-APP-DAY-LEVEL-3 >= AT-DAYS-IN-PERIOD))
 16103        IF ('3' >= AT-APPROVAL-LEVEL-REQD)
 16104            MOVE '3'         TO AT-APPROVAL-LEVEL-REQD
 16105        END-IF
 16106     ELSE
 16107     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP
 16108           OR PAID-FOR-FAM) AND
 16109        (CF-AH-APP-DAY-LEVEL-4 >= AT-DAYS-IN-PERIOD))
 16110        IF ('4' >= AT-APPROVAL-LEVEL-REQD)
 16111            MOVE '4'         TO AT-APPROVAL-LEVEL-REQD
 16112        END-IF
 16113     ELSE
 16114     IF (PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP
 16115           OR PAID-FOR-FAM)
 16116            MOVE '5'         TO AT-APPROVAL-LEVEL-REQD.
 16117
 16118 6170-WRITE.
 16119
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 306
* EL156.cbl
 16120     if pi-company-id = 'DCC' or 'VPP'
 16121        PERFORM 0900-GET-DDF-limits
 16122                                 THRU 0900-EXIT
 16123     end-if
 16124     perform 2220-update-elcrtt  thru 2220-exit
 16125     IF PI-COMPANY-ID = 'DMD'
 16126        IF PI-AT-EOB-CODES NOT = SPACES
 16127           MOVE PI-AT-EOB-CODE (1) TO AT-EOB-CODE1
 16128           MOVE PI-AT-EOB-CODE (2) TO AT-EOB-CODE2
 16129           MOVE PI-AT-EOB-CODE (3) TO AT-EOB-CODE3
 16130           MOVE PI-AT-EOB-CODE (4) TO AT-EOB-CODE4
 16131           MOVE PI-AT-EOB-CODE (5) TO AT-EOB-CODE5.
 16132
 16133
 16134* EXEC CICS HANDLE CONDITION
 16135*        DUPREC    (6180-DUPREC)
 16136*    END-EXEC.
 16137*    MOVE '"$%                   ! 3 #00015135' TO DFHEIV0
 16138     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 16139     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16140     MOVE X'3320233030303135313335' TO DFHEIV0(25:11)
 16141     CALL 'kxdfhei1' USING DFHEIV0
 16142     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16143
 16144
 16145
 16146* EXEC CICS WRITE
 16147*         DATASET       ('ELTRLR')
 16148*         FROM          (ACTIVITY-TRAILERS)
 16149*         RIDFLD        (AT-CONTROL-PRIMARY)
 16150*     END-EXEC.
 16151     MOVE LENGTH OF
 16152      ACTIVITY-TRAILERS
 16153       TO DFHEIV11
 16154     MOVE 'ELTRLR' TO DFHEIV1
 16155*    MOVE '&$ L                  ''   #00015139' TO DFHEIV0
 16156     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16157     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16158     MOVE X'2020233030303135313339' TO DFHEIV0(25:11)
 16159     CALL 'kxdfhei1' USING DFHEIV0,
 16160           DFHEIV1,
 16161           ACTIVITY-TRAILERS,
 16162           DFHEIV11,
 16163           AT-CONTROL-PRIMARY,
 16164           DFHEIV99,
 16165           DFHEIV99
 16166     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16167
 16168
 16169     IF (PI-PMTNOTE1 = SPACES OR LOW-VALUES) AND
 16170        (PI-PMTNOTE2 = SPACES OR LOW-VALUES)
 16171*06088           GO TO 6199-EXIT.
 16172           GO TO 6176-APPROVAL-NOTE.
 16173
 16174
 16175* EXEC CICS GETMAIN
 16176*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 16177*         LENGTH    (200)
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 307
* EL156.cbl
 16178*         INITIMG   (GETMAIN-SPACE)
 16179*     END-EXEC.
 16180     MOVE 200
 16181       TO DFHEIV11
 16182*    MOVE ',"IL                  $   #00015150' TO DFHEIV0
 16183     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16184     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16185     MOVE X'2020233030303135313530' TO DFHEIV0(25:11)
 16186     CALL 'kxdfhei1' USING DFHEIV0,
 16187           DFHEIV20,
 16188           DFHEIV11,
 16189           GETMAIN-SPACE
 16190     SET ADDRESS OF ACTIVITY-TRAILERS TO
 16191         DFHEIV20
 16192     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16193
 16194
 16195     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 16196
 16197     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY.
 16198     MOVE 'AT'                   TO AT-RECORD-ID.
 16199     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 16200     MOVE '6'                    TO AT-TRAILER-TYPE.
 16201     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 16202                                    AT-GEN-INFO-LAST-MAINT-DT
 16203     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 16204                                    AT-GEN-INFO-LAST-UPDATED-BY
 16205     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 16206
 16207     MOVE PI-PMTNOTE1            TO AT-INFO-LINE-1.
 16208     MOVE PI-PMTNOTE2            TO AT-INFO-LINE-2
 16209     MOVE PI-EOB-CODES-EXIST     TO AT-EOB-CODES-EXIST
 16210
 16211     MOVE 'P'                    TO AT-INFO-TRAILER-TYPE.
 16212
 16213 6175-WRITE.
 16214
 16215
 16216* EXEC CICS HANDLE CONDITION
 16217*        DUPREC    (6190-DUPREC)
 16218*    END-EXEC.
 16219*    MOVE '"$%                   ! 4 #00015176' TO DFHEIV0
 16220     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 16221     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16222     MOVE X'3420233030303135313736' TO DFHEIV0(25:11)
 16223     CALL 'kxdfhei1' USING DFHEIV0
 16224     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16225
 16226
 16227
 16228* EXEC CICS WRITE
 16229*         DATASET     ('ELTRLR')
 16230*         FROM        (ACTIVITY-TRAILERS)
 16231*         RIDFLD      (AT-CONTROL-PRIMARY)
 16232*     END-EXEC.
 16233     MOVE LENGTH OF
 16234      ACTIVITY-TRAILERS
 16235       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 308
* EL156.cbl
 16236     MOVE 'ELTRLR' TO DFHEIV1
 16237*    MOVE '&$ L                  ''   #00015180' TO DFHEIV0
 16238     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16239     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16240     MOVE X'2020233030303135313830' TO DFHEIV0(25:11)
 16241     CALL 'kxdfhei1' USING DFHEIV0,
 16242           DFHEIV1,
 16243           ACTIVITY-TRAILERS,
 16244           DFHEIV11,
 16245           AT-CONTROL-PRIMARY,
 16246           DFHEIV99,
 16247           DFHEIV99
 16248     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16249
 16250
 16251 6176-APPROVAL-NOTE.
 16252
 16253     IF NOT APPROVAL-NEEDED
 16254         GO TO 6199-EXIT.
 16255
 16256
 16257* EXEC CICS GETMAIN
 16258*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 16259*        LENGTH    (200)
 16260*        INITIMG   (GETMAIN-SPACE)
 16261*    END-EXEC.
 16262     MOVE 200
 16263       TO DFHEIV11
 16264*    MOVE ',"IL                  $   #00015191' TO DFHEIV0
 16265     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16266     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16267     MOVE X'2020233030303135313931' TO DFHEIV0(25:11)
 16268     CALL 'kxdfhei1' USING DFHEIV0,
 16269           DFHEIV20,
 16270           DFHEIV11,
 16271           GETMAIN-SPACE
 16272     SET ADDRESS OF ACTIVITY-TRAILERS TO
 16273         DFHEIV20
 16274     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16275
 16276
 16277     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT
 16278
 16279     MOVE ELMSTR-KEY         TO AT-CONTROL-PRIMARY
 16280     MOVE 'AT'               TO AT-RECORD-ID
 16281     MOVE CL-TRAILER-SEQ-CNT TO AT-SEQUENCE-NO
 16282     MOVE '6'                TO AT-TRAILER-TYPE
 16283     MOVE WS-TODAY-DATE      TO AT-RECORDED-DT
 16284                                AT-GEN-INFO-LAST-MAINT-DT
 16285     MOVE PI-PROCESSOR-ID    TO AT-RECORDED-BY
 16286                                AT-GEN-INFO-LAST-UPDATED-BY
 16287     MOVE EIBTIME            TO AT-LAST-MAINT-HHMMSS
 16288
 16289     IF PI-REAUDIT-NEEDED = 'Y'
 16290         MOVE WS-REAUDIT-NOTE TO AT-INFO-LINE-1
 16291     ELSE
 16292         MOVE WS-APPROV-NOTE  TO AT-INFO-LINE-1
 16293     END-IF
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 309
* EL156.cbl
 16294     IF PI-APPROVAL-3550-NEEDED = 'Y'
 16295         MOVE WS-3550-APPROV-NOTE TO AT-INFO-LINE-1
 16296     END-IF
 16297     MOVE SPACES             TO AT-INFO-LINE-2
 16298
 16299     MOVE 'R'                TO AT-INFO-TRAILER-TYPE.
 16300 6177-WRITE.
 16301
 16302
 16303* EXEC CICS HANDLE CONDITION
 16304*        DUPREC    (6185-DUPREC)
 16305*    END-EXEC.
 16306*    MOVE '"$%                   ! 5 #00015222' TO DFHEIV0
 16307     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 16308     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16309     MOVE X'3520233030303135323232' TO DFHEIV0(25:11)
 16310     CALL 'kxdfhei1' USING DFHEIV0
 16311     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16312
 16313
 16314
 16315* EXEC CICS WRITE
 16316*         DATASET     ('ELTRLR')
 16317*         FROM        (ACTIVITY-TRAILERS)
 16318*         RIDFLD      (AT-CONTROL-PRIMARY)
 16319*     END-EXEC.
 16320     MOVE LENGTH OF
 16321      ACTIVITY-TRAILERS
 16322       TO DFHEIV11
 16323     MOVE 'ELTRLR' TO DFHEIV1
 16324*    MOVE '&$ L                  ''   #00015226' TO DFHEIV0
 16325     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16326     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16327     MOVE X'2020233030303135323236' TO DFHEIV0(25:11)
 16328     CALL 'kxdfhei1' USING DFHEIV0,
 16329           DFHEIV1,
 16330           ACTIVITY-TRAILERS,
 16331           DFHEIV11,
 16332           AT-CONTROL-PRIMARY,
 16333           DFHEIV99,
 16334           DFHEIV99
 16335     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16336
 16337
 16338
 16339     GO TO 6199-EXIT.
 16340
 16341 6180-DUPREC.
 16342
 16343     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 16344     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO.
 16345     GO TO 6170-WRITE.
 16346
 16347 6185-DUPREC.
 16348     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 16349     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO.
 16350     GO TO 6177-WRITE.
 16351
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 310
* EL156.cbl
 16352 6190-DUPREC.
 16353     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 16354     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO.
 16355     GO TO 6175-WRITE.
 16356
 16357 6199-EXIT.
 16358      EXIT.
 16359
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 311
* EL156.cbl
 16361 6200-UPDATE-CLAIM-MSTR.
 16362     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 16363     MOVE PI-CARRIER             TO MSTR-CARRIER.
 16364     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
 16365     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
 16366
 16367     PERFORM 7910-READ-CLAIM-UPDATE THRU 7910-EXIT.
 16368
 16369     MOVE ZEROS                  TO W-INTEREST.
 16370
 16371     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP'
 16372        IF (PI-OFFLINE = 'Y') OR
 16373           (PI-PMTTYPE = '7')
 16374           PERFORM 9870-OUTPUT-ACTIVITY-RECORD
 16375                                 THRU 9870-EXIT
 16376        END-IF
 16377     END-IF
 16378     IF NOT ERROR-ON-OUTPUT
 16379        CONTINUE
 16380     ELSE
 16381
 16382* EXEC CICS REWRITE
 16383*          DATASET('ELMSTR')
 16384*          FROM(CLAIM-MASTER)
 16385*       END-EXEC
 16386     MOVE LENGTH OF
 16387      CLAIM-MASTER
 16388       TO DFHEIV11
 16389     MOVE 'ELMSTR' TO DFHEIV1
 16390*    MOVE '&& L                  %   #00015275' TO DFHEIV0
 16391     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16392     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16393     MOVE X'2020233030303135323735' TO DFHEIV0(25:11)
 16394     CALL 'kxdfhei1' USING DFHEIV0,
 16395           DFHEIV1,
 16396           CLAIM-MASTER,
 16397           DFHEIV11,
 16398           DFHEIV99
 16399     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16400
 16401        MOVE -1                  TO ENTPFBL
 16402        MOVE AL-UANON            TO ENTPFBA
 16403        MOVE MAP-NAMEB           TO MAP-NAME
 16404        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16405        GO TO 8200-SEND-DATAONLY
 16406     END-IF
 16407
 16408     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT.
 16409
 16410     MOVE SPACES TO WS-PAYMENT-TRAILER-SW.
 16411
 16412     IF PI-AIG-SPECIAL-BENEFIT
 16413         MOVE '1' TO WS-PAYMENT-TRAILER-SW.
 16414
 16415     PERFORM 6100-BUILD-PAYMENT-TRAILER THRU 6199-EXIT.
 16416
 16417     IF PI-SPECIAL-BEN-SW = 'Y'
 16418         MOVE '2' TO WS-PAYMENT-TRAILER-SW
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 312
* EL156.cbl
 16419         PERFORM 6130-BUILD-TRAILER THRU 6199-EXIT.
 16420
 16421     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16422         PERFORM 6400-UPDATE-ZERO-TRAILER THRU 6499-EXIT
 16423     ELSE
 16424         IF PI-PMTTYPE NOT = '4'
 16425            PERFORM 6400-UPDATE-ZERO-TRAILER THRU 6499-EXIT.
 16426
 16427     IF PI-PMTTYPE = '5' OR '6'
 16428        GO TO  6250-SET-MAINT.
 16429
 16430     MOVE ZEROS                      TO  CL-LAPSE-REPORT-CODE
 16431                                         CL-LAG-REPORT-CODE.
 16432
 16433     IF CL-ACTIVITY-CODE = 09
 16434         GO TO 6200-CONT-UPDATE.
 16435
 16436     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16437         IF CL-ACTIVITY-CODE = 11
 16438             GO TO 6200-CONT-UPDATE.
 16439
 16440     IF WS-ACT-REC-FOUND-SW = 'N'
 16441         GO TO 6200-CONT-UPDATE.
 16442
 16443     IF PI-RESET-SW = 'Y' OR PI-PROV-PMT
 16444         MOVE WS-TODAY-DATE          TO  CL-ACTIVITY-MAINT-DT
 16445         MOVE 'PMT'                  TO  CL-ACTIVITY-MAINT-TYPE
 16446         MOVE WS-ACTIVITY-CODE       TO  CL-ACTIVITY-CODE.
 16447
 16448     IF WS-UPDATE-SW = 'Y'
 16449         MOVE LOW-VALUES             TO  CL-NEXT-RESEND-DT
 16450                                         CL-NEXT-FOLLOWUP-DT.
 16451
 16452 6200-CONT-UPDATE.
 16453
 16454     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16455       IF CLAIM-IS-CLOSED
 16456         IF PI-PMTTYPE = '2' OR '3' OR '4'
 16457           IF WS-OPEN-CLOSE-SW = '2'
 16458             MOVE WS-TODAY-DATE     TO  CL-LAST-REOPEN-DT
 16459                                        CL-LAST-CLOSE-DT.
 16460
 16461     IF CLAIM-IS-CLOSED AND PI-PMTTYPE = '1'
 16462        MOVE WS-TODAY-DATE       TO CL-LAST-REOPEN-DT
 16463        MOVE 'O'                 TO CL-CLAIM-STATUS.
 16464
 16465     IF PI-PMTTYPE = ('2' OR '3') AND CLAIM-IS-OPEN
 16466        MOVE WS-TODAY-DATE       TO CL-LAST-CLOSE-DT
 16467        MOVE '1'                 TO CL-LAST-CLOSE-REASON
 16468        MOVE 'C'                 TO CL-CLAIM-STATUS
 16469        IF PI-PMTTYPE = '2'
 16470           AND (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 16471              or 'F')
 16472           CONTINUE
 16473        ELSE
 16474           PERFORM 6300-UPDATE-CERT THRU 6399-EXIT
 16475        END-IF
 16476     ELSE
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 313
* EL156.cbl
 16477        IF PI-PMTTYPE = '2' OR '3'
 16478           IF PI-PMTTYPE = '2' AND
 16479              (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 16480                 or 'F')
 16481              CONTINUE
 16482           ELSE
 16483              PERFORM 6300-UPDATE-CERT THRU 6399-EXIT
 16484           END-IF
 16485        END-IF
 16486     END-IF
 16487
 16488     IF PI-PMTTYPE = '4'
 16489        PERFORM 6300-UPDATE-CERT THRU 6399-EXIT.
 16490
 16491     IF PI-COMPANY-ID = 'CVL'
 16492         IF PI-LOAN-UPDATE-SW = 'Y'
 16493             MOVE PI-COMPANY-CD      TO  CERT-COMP-CD
 16494             MOVE CL-CERT-CARRIER    TO  CERT-CARRIER
 16495             MOVE CL-CERT-GROUPING   TO  CERT-GROUPING
 16496             MOVE CL-CERT-STATE      TO  CERT-STATE
 16497             MOVE CL-CERT-ACCOUNT    TO  CERT-ACCOUNT
 16498             MOVE CL-CERT-EFF-DT     TO  CERT-EFF-DT
 16499             MOVE CL-CERT-NO         TO  CERT-CERT-NO
 16500             MOVE 'CERT'             TO  FILE-SWITCH
 16501             PERFORM 7980-READ-CERT-UPDATE THRU 7980-EXIT
 16502             MOVE PI-LOAN-NO         TO  CM-BENEFICIARY
 16503             PERFORM 6350-REWRITE-CERT THRU 6399-EXIT.
 16504
 16505     IF PI-PFKEY-USED = DFHPF5 AND PI-PROCESSOR-ID NOT = 'FIX '
 16506        GO TO 6220-USE-COMPUTED.
 16507
 16508     IF (PI-PMTTYPE = '4')  AND
 16509        (PI-EPYAMT < ZEROS)
 16510          COMPUTE CL-NO-OF-DAYS-PAID =
 16511                       CL-NO-OF-DAYS-PAID - PI-EDAYS
 16512          IF CL-NO-OF-DAYS-PAID < +0
 16513              MOVE ZEROS TO CL-NO-OF-DAYS-PAID
 16514          ELSE
 16515              NEXT SENTENCE
 16516     ELSE
 16517          ADD PI-EDAYS           TO CL-NO-OF-DAYS-PAID.
 16518
 16519     IF HOLD-UNTIL-PMT
 16520        CONTINUE
 16521     ELSE
 16522     IF PI-PROCESSOR-ID = 'FIX '
 16523        IF CL-TOTAL-PAID-AMT NOT = ZEROS
 16524           NEXT SENTENCE
 16525        ELSE
 16526           ADD PI-EPYAMT         TO CL-TOTAL-PAID-AMT
 16527     ELSE
 16528        ADD PI-EPYAMT            TO CL-TOTAL-PAID-AMT.
 16529
 16530     IF PI-PMTTYPE = '4'
 16531        GO TO 6250-SET-MAINT.
 16532
 16533     MOVE PI-EPYTHRU             TO DC-GREG-DATE-1-MDY.
 16534     MOVE '4'                    TO DC-OPTION-CODE.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 314
* EL156.cbl
 16535     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 16536     IF HOLD-UNTIL-PMT
 16537        CONTINUE
 16538     ELSE
 16539     IF DATE-CONVERSION-ERROR
 16540        MOVE LOW-VALUES          TO CL-PAID-THRU-DT
 16541     ELSE
 16542        ADD 1                 TO CL-NO-OF-PMTS-MADE
 16543        IF DC-BIN-DATE-1 > CL-PAID-THRU-DT
 16544           MOVE DC-BIN-DATE-1    TO CL-PAID-THRU-DT
 16545           IF PI-AIG-SPECIAL-BENEFIT
 16546               COMPUTE CL-LAST-PMT-AMT = PI-EPYAMT / 1.5
 16547           ELSE
 16548               MOVE PI-EPYAMT        TO CL-LAST-PMT-AMT.
 16549
 16550     GO TO 6250-SET-MAINT.
 16551
 16552 6220-USE-COMPUTED.
 16553
 16554     IF (PI-PMTTYPE = '4')  AND
 16555        (PI-CPYAMT < ZEROS)
 16556          COMPUTE CL-NO-OF-DAYS-PAID =
 16557                       CL-NO-OF-DAYS-PAID - PI-CDAYS
 16558          IF CL-NO-OF-DAYS-PAID < +0
 16559              MOVE ZEROS TO CL-NO-OF-DAYS-PAID
 16560          ELSE
 16561              NEXT SENTENCE
 16562     ELSE
 16563          ADD PI-CDAYS           TO CL-NO-OF-DAYS-PAID.
 16564
 16565     IF NOT HOLD-UNTIL-PMT
 16566        ADD 1                    TO CL-NO-OF-PMTS-MADE
 16567        ADD PI-CPYAMT            TO CL-TOTAL-PAID-AMT.
 16568
 16569     IF PI-PMTTYPE = '4'
 16570        GO TO 6250-SET-MAINT.
 16571
 16572     IF PI-AIG-SPECIAL-BENEFIT
 16573         COMPUTE CL-LAST-PMT-AMT = PI-CPYAMT / 1.5
 16574     ELSE
 16575         MOVE PI-CPYAMT        TO CL-LAST-PMT-AMT.
 16576
 16577     IF PI-CPYTHRU > CL-PAID-THRU-DT
 16578       AND NOT HOLD-UNTIL-PMT
 16579        MOVE PI-CPYTHRU          TO CL-PAID-THRU-DT.
 16580
 16581 6250-SET-MAINT.
 16582     MOVE WS-TODAY-DATE          TO CL-LAST-MAINT-DT.
 16583
 16584     IF PI-PROCESSOR-ID = 'FIX '
 16585        IF DC-BIN-DATE-1 = CL-PAID-THRU-DT
 16586           MOVE WS-TODAY-DATE    TO CL-LAST-PMT-DT
 16587        ELSE
 16588           NEXT SENTENCE
 16589     ELSE
 16590        MOVE WS-TODAY-DATE       TO CL-LAST-PMT-DT.
 16591
 16592     MOVE PI-PROCESSOR-ID        TO CL-LAST-MAINT-USER.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 315
* EL156.cbl
 16593     MOVE EIBTIME                TO CL-LAST-MAINT-HHMMSS.
 16594     MOVE '1'                    TO CL-LAST-MAINT-TYPE.
 16595
 16596 6299-EXIT.
 16597      EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 316
* EL156.cbl
 16599 6300-UPDATE-CERT.
 16600
 16601*  ADD CERTNOTE FOR SC NP+6
 16602     IF PI-COMPANY-ID = 'CID' AND
 16603       (PI-PMTTYPE = '2' OR '3') AND
 16604        CL-CERT-STATE = 'SC'  AND
 16605        (PI-LF-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
 16606           PERFORM 7180-ADD-CERT-NOTE THRU 7189-EXIT
 16607     END-IF.
 16608
 16609     IF PI-COMPANY-ID = 'AHL' AND
 16610       (PI-PMTTYPE = '2' OR '3') AND
 16611        (PI-LF-BENEFIT-CD = '5I' OR '6J' OR '5M' OR '6M' OR
 16612           '5G' OR '5J' OR '5S' OR '6D' OR '6H' OR '6R')
 16613           PERFORM 7180-ADD-CERT-NOTE THRU 7189-EXIT
 16614     END-IF.
 16615
 16616     MOVE PI-COMPANY-CD    TO CERT-COMP-CD.
 16617     MOVE CL-CERT-CARRIER  TO CERT-CARRIER.
 16618     MOVE CL-CERT-GROUPING TO CERT-GROUPING.
 16619     MOVE CL-CERT-STATE    TO CERT-STATE.
 16620     MOVE CL-CERT-ACCOUNT  TO CERT-ACCOUNT.
 16621     MOVE CL-CERT-EFF-DT   TO CERT-EFF-DT.
 16622     MOVE CL-CERT-NO       TO CERT-CERT-NO.
 16623     MOVE 'CERT'           TO FILE-SWITCH.
 16624
 16625     PERFORM 7980-READ-CERT-UPDATE THRU 7980-EXIT.
 16626
 16627     IF CERT-NOTE-ADDED
 16628        IF CM-NOTE-SW = ' '
 16629           MOVE '4'             TO CM-NOTE-SW
 16630        ELSE
 16631           IF CM-NOTE-SW = '1'
 16632               MOVE '5'           TO CM-NOTE-SW
 16633           ELSE
 16634              IF CM-NOTE-SW = '2'
 16635                 MOVE '6'         TO CM-NOTE-SW
 16636              ELSE
 16637                 IF CM-NOTE-SW = '3'
 16638                    MOVE '7'      TO CM-NOTE-SW
 16639                 END-IF
 16640              END-IF
 16641           END-IF
 16642        END-IF
 16643     END-IF.
 16644
 16645     IF PI-COMPANY-ID = 'CVL'
 16646         MOVE PI-LOAN-NO   TO  CM-BENEFICIARY
 16647         MOVE 'N'          TO  PI-LOAN-UPDATE-SW.
 16648
 16649     IF PI-PMTTYPE NOT = '4'
 16650        GO TO 6340-UPDATE-CERT.
 16651
 16652     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16653        IF PI-PFKEY-USED = DFHPF5
 16654           ADD PI-CPYAMT         TO CM-LF-ITD-DEATH-AMT
 16655        ELSE
 16656           ADD PI-EPYAMT         TO CM-LF-ITD-DEATH-AMT.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 317
* EL156.cbl
 16657
 16658*    IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16659*        IF PI-COMPANY-ID = 'ACC' OR 'FDL'
 16660*            IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 16661*               PI-LF-COVERAGE-TYPE = 'P'
 16662*                GO TO 6350-REWRITE-CERT.
 16663
 16664     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16665       IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 16666          PI-LF-COVERAGE-TYPE = 'P'
 16667           IF CM-LF-ITD-DEATH-AMT >= CM-LF-BENEFIT-AMT
 16668                MOVE CL-INCURRED-DT       TO CM-LF-DEATH-DT
 16669                MOVE PI-MONTH-END-SAVE    TO CM-LF-DEATH-EXIT-DT
 16670                MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-DEATH
 16671                MOVE '7'                  TO CM-LF-CURRENT-STATUS
 16672                GO TO 6350-REWRITE-CERT
 16673            ELSE
 16674                GO TO 6350-REWRITE-CERT.
 16675
 16676     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16677         GO TO 6350-REWRITE-CERT.
 16678
 16679     IF NOT CM-AH-LUMP-SUM-DISAB
 16680        GO TO 6380-UNLOCK-CERT.
 16681
 16682     IF PI-PFKEY-USED = DFHPF5
 16683        ADD PI-CPYAMT            TO CM-AH-ITD-LUMP-PMT
 16684                                    CM-AH-ITD-AH-PMT
 16685        MOVE PI-EPYTHRU          TO CM-AH-PAID-THRU-DT
 16686        GO TO 6350-REWRITE-CERT
 16687     ELSE
 16688        ADD PI-EPYAMT            TO CM-AH-ITD-LUMP-PMT
 16689                                    CM-AH-ITD-AH-PMT
 16690        MOVE PI-EPYTHRU          TO CM-AH-PAID-THRU-DT
 16691        GO TO 6350-REWRITE-CERT.
 16692
 16693 6340-UPDATE-CERT.
 16694
 16695     IF CL-CLAIM-TYPE = 'L'
 16696         IF PI-PFKEY-USED = DFHPF5
 16697             ADD PI-CPYAMT          TO CM-LF-ITD-DEATH-AMT
 16698         ELSE
 16699             ADD PI-EPYAMT          TO CM-LF-ITD-DEATH-AMT.
 16700
 16701     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16702         IF PI-COMPANY-ID = 'ACC' OR 'FDL'
 16703             IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 16704                PI-LF-COVERAGE-TYPE = 'P'
 16705                 GO TO 6350-REWRITE-CERT.
 16706
 16707     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16708       IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 16709          PI-LF-COVERAGE-TYPE = 'P'
 16710           IF CM-LF-ITD-DEATH-AMT >= CM-LF-BENEFIT-AMT
 16711                MOVE CL-INCURRED-DT       TO CM-LF-DEATH-DT
 16712                MOVE PI-MONTH-END-SAVE    TO CM-LF-DEATH-EXIT-DT
 16713                MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-DEATH
 16714                MOVE '7'                  TO CM-LF-CURRENT-STATUS
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 318
* EL156.cbl
 16715                GO TO 6350-REWRITE-CERT.
 16716
 16717     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16718         IF PI-LIFE-OVERRIDE-L1 = 'L' AND
 16719            PI-LF-COVERAGE-TYPE NOT = 'P'
 16720             MOVE CL-INCURRED-DT         TO CM-LF-DEATH-DT
 16721             MOVE PI-MONTH-END-SAVE      TO CM-LF-DEATH-EXIT-DT
 16722             MOVE CM-LF-CURRENT-STATUS   TO CM-LF-STATUS-AT-DEATH
 16723             MOVE '7'                    TO CM-LF-CURRENT-STATUS
 16724             GO TO 6350-REWRITE-CERT.
 16725
 16726     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 16727         MOVE CL-INCURRED-DT         TO CM-AH-SETTLEMENT-DT
 16728         MOVE PI-MONTH-END-SAVE      TO CM-AH-SETTLEMENT-EXIT-DT
 16729         MOVE CM-AH-CURRENT-STATUS   TO CM-AH-STATUS-AT-SETTLEMENT
 16730         MOVE '6'                    TO CM-AH-CURRENT-STATUS
 16731         MOVE PI-EPYTHRU             TO CM-AH-PAID-THRU-DT
 16732         IF PI-PFKEY-USED = DFHPF5
 16733             ADD PI-CPYAMT           TO CM-AH-ITD-LUMP-PMT
 16734                                        CM-AH-ITD-AH-PMT
 16735             GO TO 6350-REWRITE-CERT
 16736         ELSE
 16737             ADD PI-EPYAMT           TO CM-AH-ITD-LUMP-PMT
 16738                                        CM-AH-ITD-AH-PMT
 16739             GO TO 6350-REWRITE-CERT.
 16740
 16741 6350-REWRITE-CERT.
 16742
 16743
 16744* EXEC CICS REWRITE
 16745*         DATASET  ('ELCERT')
 16746*         FROM(CERTIFICATE-MASTER)
 16747*     END-EXEC.
 16748     MOVE LENGTH OF
 16749      CERTIFICATE-MASTER
 16750       TO DFHEIV11
 16751     MOVE 'ELCERT' TO DFHEIV1
 16752*    MOVE '&& L                  %   #00015622' TO DFHEIV0
 16753     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16754     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16755     MOVE X'2020233030303135363232' TO DFHEIV0(25:11)
 16756     CALL 'kxdfhei1' USING DFHEIV0,
 16757           DFHEIV1,
 16758           CERTIFICATE-MASTER,
 16759           DFHEIV11,
 16760           DFHEIV99
 16761     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16762
 16763
 16764     GO TO 6399-EXIT.
 16765
 16766 6380-UNLOCK-CERT.
 16767
 16768* EXEC CICS UNLOCK
 16769*         DATASET  ('ELCERT')
 16770*     END-EXEC.
 16771     MOVE 'ELCERT' TO DFHEIV1
 16772*    MOVE '&*                    #   #00015630' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 319
* EL156.cbl
 16773     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 16774     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 16775     MOVE X'2020233030303135363330' TO DFHEIV0(25:11)
 16776     CALL 'kxdfhei1' USING DFHEIV0,
 16777           DFHEIV1,
 16778           DFHEIV99
 16779     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16780
 16781
 16782 6399-EXIT.
 16783      EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 320
* EL156.cbl
 16785 6400-UPDATE-ZERO-TRAILER.
 16786     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 16787     MOVE ZEROS                  TO TRLR-SEQ-NO.
 16788
 16789     PERFORM 7960-READ-TRAILER-UPDATE THRU 7960-EXIT.
 16790
 16791     IF PI-EPYAMT NOT = ZEROS
 16792         SUBTRACT PI-EPYAMT    FROM AT-CURRENT-MANUAL-RESERVE
 16793     ELSE
 16794         SUBTRACT PI-CPYAMT    FROM AT-CURRENT-MANUAL-RESERVE.
 16795
 16796     IF PI-ERESV NOT = ZEROS
 16797        ADD PI-ERESV             TO AT-CURRENT-MANUAL-RESERVE.
 16798
 16799     IF AT-CURRENT-MANUAL-RESERVE NEGATIVE
 16800        MOVE ZEROS               TO AT-CURRENT-MANUAL-RESERVE.
 16801
 16802     IF PI-PFKEY-USED = DFHPF3 OR DFHPF4
 16803        ADD PI-EEXPENS           TO AT-ITD-CHARGEABLE-EXPENSE
 16804     ELSE
 16805        ADD PI-CEXPENS           TO AT-ITD-CHARGEABLE-EXPENSE.
 16806
 16807     IF PI-PMTTYPE = '5'
 16808        IF PI-EPYAMT = ZEROS
 16809           ADD PI-CPYAMT         TO AT-ITD-CHARGEABLE-EXPENSE
 16810        ELSE
 16811           ADD PI-EPYAMT         TO AT-ITD-CHARGEABLE-EXPENSE.
 16812
 16813     IF PI-PMTTYPE = '6'
 16814        IF PI-EPYAMT = ZEROS
 16815           ADD PI-CPYAMT         TO AT-ITD-PAID-EXPENSES
 16816        ELSE
 16817           ADD PI-EPYAMT         TO AT-ITD-PAID-EXPENSES.
 16818
 16819 6420-CHECK-OPEN-CLOSE.
 16820     IF PI-PMTTYPE = '5' OR '6'
 16821        GO TO 6450-REWRITE.
 16822
 16823     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16824         IF PI-PMTTYPE = '2' OR '3' OR '4'
 16825             IF CLAIM-IS-CLOSED
 16826                 MOVE '1'        TO  WS-OPEN-CLOSE-SW
 16827                 MOVE 1          TO  SUB-1
 16828                 GO TO 6440-AIG-LOOP.
 16829
 16830     IF (PI-PMTTYPE = '1' OR '4') AND CLAIM-IS-OPEN
 16831        GO TO 6450-REWRITE.
 16832
 16833     IF (PI-PMTTYPE = '2' OR '3') AND CLAIM-IS-CLOSED
 16834        GO TO 6450-REWRITE.
 16835
 16836     MOVE 1                      TO SUB-1.
 16837
 16838 6430-LOOP.
 16839     IF AT-OPEN-CLOSE-TYPE (SUB-1) = SPACES
 16840        MOVE WS-TODAY-DATE       TO AT-OPEN-CLOSE-DATE (SUB-1)
 16841        IF PI-PMTTYPE = '1' OR '4'
 16842           MOVE 'O'              TO AT-OPEN-CLOSE-TYPE (SUB-1)
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 321
* EL156.cbl
 16843           MOVE 'FORCE'          TO AT-OPEN-CLOSE-REASON (SUB-1)
 16844           GO TO 6450-REWRITE
 16845        ELSE
 16846           MOVE 'C'              TO AT-OPEN-CLOSE-TYPE (SUB-1)
 16847           MOVE 'FINAL'          TO AT-OPEN-CLOSE-REASON (SUB-1)
 16848           GO TO 6450-REWRITE.
 16849
 16850     IF SUB-1 = 6
 16851      MOVE AT-OPEN-CLOSE-HISTORY (2) TO AT-OPEN-CLOSE-HISTORY (1)
 16852      MOVE AT-OPEN-CLOSE-HISTORY (3) TO AT-OPEN-CLOSE-HISTORY (2)
 16853      MOVE AT-OPEN-CLOSE-HISTORY (4) TO AT-OPEN-CLOSE-HISTORY (3)
 16854      MOVE AT-OPEN-CLOSE-HISTORY (5) TO AT-OPEN-CLOSE-HISTORY (4)
 16855      MOVE AT-OPEN-CLOSE-HISTORY (6) TO AT-OPEN-CLOSE-HISTORY (5)
 16856      MOVE SPACES                    TO AT-OPEN-CLOSE-HISTORY (6)
 16857      GO TO 6430-LOOP.
 16858
 16859     ADD 1                       TO SUB-1.
 16860     GO TO 6430-LOOP.
 16861
 16862
 16863 6440-AIG-LOOP.
 16864
 16865     IF AT-OPEN-CLOSE-TYPE (SUB-1) = SPACES
 16866       MOVE WS-TODAY-DATE        TO AT-OPEN-CLOSE-DATE (SUB-1)
 16867       IF WS-OPEN-CLOSE-SW = '1'
 16868         MOVE 'O'                TO  AT-OPEN-CLOSE-TYPE (SUB-1)
 16869         IF PI-PMTTYPE = '2'
 16870           MOVE 'FINAL'          TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16871           MOVE '2'              TO  WS-OPEN-CLOSE-SW
 16872         ELSE
 16873           IF PI-PMTTYPE = '3'
 16874             MOVE 'SETTL'        TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16875             MOVE '2'            TO  WS-OPEN-CLOSE-SW
 16876           ELSE
 16877             IF PI-PMTTYPE = '4'
 16878               MOVE 'ADDL'       TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16879               MOVE '2'          TO  WS-OPEN-CLOSE-SW
 16880             ELSE
 16881               MOVE 'UNK '       TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16882               MOVE '2'          TO  WS-OPEN-CLOSE-SW
 16883       ELSE
 16884         MOVE 'C'                TO  AT-OPEN-CLOSE-TYPE (SUB-1)
 16885         MOVE 'FORCE'            TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16886         GO TO 6450-REWRITE.
 16887
 16888     IF SUB-1 = 6
 16889      MOVE AT-OPEN-CLOSE-HISTORY (2) TO AT-OPEN-CLOSE-HISTORY (1)
 16890      MOVE AT-OPEN-CLOSE-HISTORY (3) TO AT-OPEN-CLOSE-HISTORY (2)
 16891      MOVE AT-OPEN-CLOSE-HISTORY (4) TO AT-OPEN-CLOSE-HISTORY (3)
 16892      MOVE AT-OPEN-CLOSE-HISTORY (5) TO AT-OPEN-CLOSE-HISTORY (4)
 16893      MOVE AT-OPEN-CLOSE-HISTORY (6) TO AT-OPEN-CLOSE-HISTORY (5)
 16894      MOVE SPACES                    TO AT-OPEN-CLOSE-HISTORY (6)
 16895      GO TO 6440-AIG-LOOP.
 16896
 16897     ADD 1                       TO SUB-1.
 16898     GO TO 6440-AIG-LOOP.
 16899
 16900 6450-REWRITE.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 322
* EL156.cbl
 16901     MOVE PI-PROCESSOR-ID     TO AT-RESERVES-LAST-UPDATED-BY.
 16902     MOVE EIBTIME             TO AT-LAST-MAINT-HHMMSS.
 16903     MOVE WS-TODAY-DATE       TO AT-RESERVES-LAST-MAINT-DT.
 16904
 16905     IF PI-COMPANY-ID = 'DMD'
 16906         MOVE PI-AT-EOB-CODE (1) TO AT-EOB-CODE1
 16907         MOVE PI-AT-EOB-CODE (2) TO AT-EOB-CODE2
 16908         MOVE PI-AT-EOB-CODE (3) TO AT-EOB-CODE3
 16909         MOVE PI-AT-EOB-CODE (4) TO AT-EOB-CODE4
 16910         MOVE PI-AT-EOB-CODE (5) TO AT-EOB-CODE5.
 16911
 16912
 16913* EXEC CICS REWRITE
 16914*         DATASET  ('ELTRLR')
 16915*         FROM     (ACTIVITY-TRAILERS)
 16916*     END-EXEC.
 16917     MOVE LENGTH OF
 16918      ACTIVITY-TRAILERS
 16919       TO DFHEIV11
 16920     MOVE 'ELTRLR' TO DFHEIV1
 16921*    MOVE '&& L                  %   #00015764' TO DFHEIV0
 16922     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16923     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16924     MOVE X'2020233030303135373634' TO DFHEIV0(25:11)
 16925     CALL 'kxdfhei1' USING DFHEIV0,
 16926           DFHEIV1,
 16927           ACTIVITY-TRAILERS,
 16928           DFHEIV11,
 16929           DFHEIV99
 16930     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16931
 16932
 16933 6499-EXIT.
 16934      EXIT.
 16935
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 323
* EL156.cbl
 16937 6500-READ-DLO035.
 16938     MOVE 'E'                    TO DL35-PROCESS-TYPE.
 16939     MOVE CL-CCN-A5              TO DL35-CREDIT-CARD.
 16940     MOVE CL-CERT-NO (5:2)       TO DL35-BEN-TYPE.
 16941     MOVE PI-EPYAMT              TO DL35-PAYMENT-AMT.
 16942
 16943
 16944* EXEC CICS LINK
 16945*        PROGRAM    ('DLO035')
 16946*        COMMAREA   (DLO035-KEY)
 16947*        LENGTH     (DL35-LENGTH)
 16948*    END-EXEC.
 16949     MOVE 'DLO035' TO DFHEIV1
 16950*    MOVE '."C                   (   #00015779' TO DFHEIV0
 16951     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16952     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16953     MOVE X'2020233030303135373739' TO DFHEIV0(25:11)
 16954     CALL 'kxdfhei1' USING DFHEIV0,
 16955           DFHEIV1,
 16956           DLO035-KEY,
 16957           DL35-LENGTH,
 16958           DFHEIV99,
 16959           DFHEIV99,
 16960           DFHEIV99,
 16961           DFHEIV99
 16962     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16963
 16964
 16965     IF DL35-RETURN-CODE = 'OK'
 16966         GO TO 6500-EXIT.
 16967
 16968     IF DL35-RETURN-CODE = '01'
 16969         MOVE ER-7830            TO EMI-ERROR
 16970         GO TO 6500-BAD-EXIT.
 16971
 16972     IF DL35-RETURN-CODE = '02'
 16973         MOVE ER-7831            TO EMI-ERROR
 16974         GO TO 6500-BAD-EXIT.
 16975
 16976     IF DL35-RETURN-CODE = '03'
 16977         MOVE ER-7832            TO EMI-ERROR
 16978         GO TO 6500-BAD-EXIT.
 16979
 16980     IF DL35-RETURN-CODE = '04'
 16981         MOVE ER-7833            TO EMI-ERROR
 16982         GO TO 6500-BAD-EXIT.
 16983
 16984     IF DL35-RETURN-CODE = '05'
 16985         MOVE ER-7834            TO EMI-ERROR
 16986         GO TO 6500-BAD-EXIT.
 16987
 16988     IF DL35-RETURN-CODE = '06'
 16989         MOVE ER-7835            TO EMI-ERROR
 16990         GO TO 6500-BAD-EXIT.
 16991
 16992     IF DL35-RETURN-CODE = '07'
 16993         MOVE ER-7836            TO EMI-ERROR
 16994         GO TO 6500-BAD-EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 324
* EL156.cbl
 16995
 16996     IF DL35-RETURN-CODE = 'E1'
 16997         MOVE ER-7837            TO EMI-ERROR
 16998         GO TO 6500-BAD-EXIT.
 16999
 17000     IF DL35-RETURN-CODE NOT = 'OK'
 17001         MOVE ER-7838            TO EMI-ERROR
 17002         GO TO 6500-BAD-EXIT.
 17003
 17004 6500-EXIT.
 17005      EXIT.
 17006
 17007 6500-BAD-EXIT.
 17008
 17009* EXEC CICS SYNCPOINT ROLLBACK END-EXEC.
 17010*    MOVE '6"R                   !   #00015828' TO DFHEIV0
 17011     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17012     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17013     MOVE X'2020233030303135383238' TO DFHEIV0(25:11)
 17014     CALL 'kxdfhei1' USING DFHEIV0
 17015     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17016
 17017     MOVE -1                 TO PMTTYPEL.
 17018     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17019     GO TO 8200-SEND-DATAONLY.
 17020
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 325
* EL156.cbl
 17022 6600-UPDATE-DLO035.
 17023     MOVE 'U'                    TO DL35-PROCESS-TYPE.
 17024     MOVE CL-CCN-A5              TO DL35-CREDIT-CARD.
 17025     MOVE CL-CERT-NO (5:2)       TO DL35-BEN-TYPE.
 17026     MOVE PI-EPYAMT              TO DL35-PAYMENT-AMT.
 17027
 17028
 17029* EXEC CICS LINK
 17030*        PROGRAM    ('DLO035')
 17031*        COMMAREA   (DLO035-KEY)
 17032*        LENGTH     (DL35-LENGTH)
 17033*    END-EXEC.
 17034     MOVE 'DLO035' TO DFHEIV1
 17035*    MOVE '."C                   (   #00015840' TO DFHEIV0
 17036     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17037     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17038     MOVE X'2020233030303135383430' TO DFHEIV0(25:11)
 17039     CALL 'kxdfhei1' USING DFHEIV0,
 17040           DFHEIV1,
 17041           DLO035-KEY,
 17042           DL35-LENGTH,
 17043           DFHEIV99,
 17044           DFHEIV99,
 17045           DFHEIV99,
 17046           DFHEIV99
 17047     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17048
 17049
 17050     IF DL35-RETURN-CODE = 'OK'
 17051         GO TO 6600-EXIT.
 17052
 17053     IF DL35-RETURN-CODE = '01'
 17054         MOVE ER-7830            TO EMI-ERROR
 17055         GO TO 6500-BAD-EXIT.
 17056
 17057     IF DL35-RETURN-CODE = '02'
 17058         MOVE ER-7831            TO EMI-ERROR
 17059         GO TO 6500-BAD-EXIT.
 17060
 17061     IF DL35-RETURN-CODE = '03'
 17062         MOVE ER-7832            TO EMI-ERROR
 17063         GO TO 6500-BAD-EXIT.
 17064
 17065     IF DL35-RETURN-CODE = '04'
 17066         MOVE ER-7833            TO EMI-ERROR
 17067         GO TO 6500-BAD-EXIT.
 17068
 17069     IF DL35-RETURN-CODE = '05'
 17070         MOVE ER-7834            TO EMI-ERROR
 17071         GO TO 6500-BAD-EXIT.
 17072
 17073     IF DL35-RETURN-CODE = '06'
 17074         MOVE ER-7835            TO EMI-ERROR
 17075         GO TO 6500-BAD-EXIT.
 17076
 17077     IF DL35-RETURN-CODE = '07'
 17078         MOVE ER-7836            TO EMI-ERROR
 17079         GO TO 6500-BAD-EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 326
* EL156.cbl
 17080
 17081     IF DL35-RETURN-CODE = 'E1'
 17082         MOVE ER-7837            TO EMI-ERROR
 17083         GO TO 6500-BAD-EXIT.
 17084
 17085     IF DL35-RETURN-CODE NOT = 'OK'
 17086         MOVE ER-7838            TO EMI-ERROR
 17087         GO TO 6500-BAD-EXIT.
 17088
 17089 6600-EXIT.
 17090      EXIT.
 17091
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 327
* EL156.cbl
 17093 6700-UPDATE-ACTQ.
 17094***************************************************************
 17095*    THE ACTIVITY QUE FILE IS READ TO GET THE RECORD FOR      *
 17096*    THIS CLAIM.  A NEW RECORD WILL BE BUILT IF THERE ISNT    *
 17097*    ONE ALREADY THERE.                                       *
 17098***************************************************************
 17099
 17100
 17101* EXEC CICS HANDLE CONDITION
 17102*         NOTFND(6720-BUILD-NEW-RECORD)
 17103*     END-EXEC.
 17104*    MOVE '"$I                   ! 6 #00015896' TO DFHEIV0
 17105     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17106     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17107     MOVE X'3620233030303135383936' TO DFHEIV0(25:11)
 17108     CALL 'kxdfhei1' USING DFHEIV0
 17109     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17110
 17111
 17112
 17113* EXEC CICS READ
 17114*         DATASET('ELACTQ')
 17115*         RIDFLD (ELMSTR-KEY)
 17116*         SET    (ADDRESS OF ACTIVITY-QUE)
 17117*         UPDATE
 17118*     END-EXEC.
 17119     MOVE 'ELACTQ' TO DFHEIV1
 17120*    MOVE '&"S        EU         (   #00015900' TO DFHEIV0
 17121     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17122     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17123     MOVE X'2020233030303135393030' TO DFHEIV0(25:11)
 17124     CALL 'kxdfhei1' USING DFHEIV0,
 17125           DFHEIV1,
 17126           DFHEIV20,
 17127           DFHEIV99,
 17128           ELMSTR-KEY,
 17129           DFHEIV99,
 17130           DFHEIV99,
 17131           DFHEIV99
 17132     SET ADDRESS OF ACTIVITY-QUE TO
 17133         DFHEIV20
 17134     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17135
 17136
 17137     MOVE '1'                    TO AQ-PENDING-PAYMENT-FLAG.
 17138
 17139     IF PI-AIG-SPECIAL-BENEFIT AND
 17140        PI-CASH = 'Y'
 17141         ADD 2                   TO AQ-PAYMENT-COUNTER
 17142     ELSE
 17143         ADD 1                   TO AQ-PAYMENT-COUNTER.
 17144
 17145     IF AQ-PMT-UNAPPROVED-COUNT IS NOT NUMERIC
 17146         MOVE +0                 TO  AQ-PMT-UNAPPROVED-COUNT.
 17147
 17148     MOVE +0                     TO  WS-PMT-UNAPPROVED-CNT.
 17149
 17150     IF PI-PMT-GRADUATED
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 328
* EL156.cbl
 17151         IF WS-PMT-APPROVAL-SW = 'A'
 17152             NEXT SENTENCE
 17153         ELSE
 17154            IF PI-AIG-SPECIAL-BENEFIT AND
 17155               PI-CASH = 'Y'
 17156                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 17157                                     WS-PMT-UNAPPROVED-CNT
 17158            ELSE
 17159                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT
 17160                                     WS-PMT-UNAPPROVED-CNT
 17161     ELSE
 17162         IF PI-PMT-APPR-SW = 'Y'
 17163            IF PI-AIG-SPECIAL-BENEFIT AND
 17164               PI-CASH = 'Y'
 17165                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 17166                                     WS-PMT-UNAPPROVED-CNT
 17167            ELSE
 17168                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT
 17169                                     WS-PMT-UNAPPROVED-CNT.
 17170
 17171     IF WS-PMT-UNAPPROVED-CNT > ZERO
 17172         MOVE ER-3536 TO EMI-ERROR
 17173         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17174
 17175     MOVE +156                   TO  AQ-LAST-UPDATED-BY.
 17176
 17177
 17178* EXEC CICS REWRITE
 17179*         DATASET('ELACTQ')
 17180*         FROM   (ACTIVITY-QUE)
 17181*     END-EXEC.
 17182     MOVE LENGTH OF
 17183      ACTIVITY-QUE
 17184       TO DFHEIV11
 17185     MOVE 'ELACTQ' TO DFHEIV1
 17186*    MOVE '&& L                  %   #00015947' TO DFHEIV0
 17187     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17188     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17189     MOVE X'2020233030303135393437' TO DFHEIV0(25:11)
 17190     CALL 'kxdfhei1' USING DFHEIV0,
 17191           DFHEIV1,
 17192           ACTIVITY-QUE,
 17193           DFHEIV11,
 17194           DFHEIV99
 17195     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17196
 17197
 17198     GO TO 6799-EXIT.
 17199
 17200 6720-BUILD-NEW-RECORD.
 17201
 17202* EXEC CICS GETMAIN
 17203*         SET    (ADDRESS OF ACTIVITY-QUE)
 17204*         LENGTH (60)
 17205*         INITIMG(GETMAIN-SPACE)
 17206*     END-EXEC.
 17207     MOVE 60
 17208       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 329
* EL156.cbl
 17209*    MOVE ',"IL                  $   #00015955' TO DFHEIV0
 17210     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17211     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17212     MOVE X'2020233030303135393535' TO DFHEIV0(25:11)
 17213     CALL 'kxdfhei1' USING DFHEIV0,
 17214           DFHEIV20,
 17215           DFHEIV11,
 17216           GETMAIN-SPACE
 17217     SET ADDRESS OF ACTIVITY-QUE TO
 17218         DFHEIV20
 17219     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17220
 17221
 17222     MOVE ZEROS                  TO AQ-PMT-UNAPPROVED-COUNT.
 17223
 17224     IF PI-AIG-SPECIAL-BENEFIT AND
 17225        PI-CASH = 'Y'
 17226         MOVE 2                  TO AQ-PAYMENT-COUNTER
 17227     ELSE
 17228         MOVE 1                  TO AQ-PAYMENT-COUNTER.
 17229
 17230     MOVE ELMSTR-KEY             TO AQ-CONTROL-PRIMARY.
 17231     MOVE 'AQ'                   TO AQ-RECORD-ID.
 17232     MOVE SPACES                 TO AQ-PENDING-ACTIVITY-FLAGS.
 17233     MOVE LOW-VALUES             TO AQ-RESEND-DATE
 17234                                    AQ-FOLLOWUP-DATE.
 17235     MOVE +156                   TO AQ-LAST-UPDATED-BY.
 17236     MOVE '1'                    TO AQ-PENDING-PAYMENT-FLAG.
 17237
 17238     IF PI-PMT-GRADUATED
 17239         IF WS-PMT-APPROVAL-SW = 'A'
 17240             NEXT SENTENCE
 17241         ELSE
 17242            IF PI-AIG-SPECIAL-BENEFIT AND
 17243               PI-CASH = 'Y'
 17244                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 17245            ELSE
 17246                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT
 17247     ELSE
 17248         IF PI-PMT-APPR-SW = 'Y'
 17249            IF PI-AIG-SPECIAL-BENEFIT AND
 17250               PI-CASH = 'Y'
 17251                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 17252            ELSE
 17253                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT.
 17254
 17255     IF AQ-PMT-UNAPPROVED-COUNT > ZERO
 17256         MOVE ER-3536 TO EMI-ERROR
 17257         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17258
 17259
 17260* EXEC CICS WRITE
 17261*         DATASET('ELACTQ')
 17262*         RIDFLD (ELMSTR-KEY)
 17263*         FROM   (ACTIVITY-QUE)
 17264*     END-EXEC.
 17265     MOVE LENGTH OF
 17266      ACTIVITY-QUE
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 330
* EL156.cbl
 17267       TO DFHEIV11
 17268     MOVE 'ELACTQ' TO DFHEIV1
 17269*    MOVE '&$ L                  ''   #00015998' TO DFHEIV0
 17270     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17271     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17272     MOVE X'2020233030303135393938' TO DFHEIV0(25:11)
 17273     CALL 'kxdfhei1' USING DFHEIV0,
 17274           DFHEIV1,
 17275           ACTIVITY-QUE,
 17276           DFHEIV11,
 17277           ELMSTR-KEY,
 17278           DFHEIV99,
 17279           DFHEIV99
 17280     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17281
 17282
 17283 6799-EXIT.
 17284      EXIT.
 17285
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 331
* EL156.cbl
 17287 6800-BUILD-FORM-TRAILER.
 17288
 17289
 17290* EXEC CICS GETMAIN
 17291*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 17292*         LENGTH   (200)
 17293*         INITIMG  (GETMAIN-SPACE)
 17294*    END-EXEC.
 17295     MOVE 200
 17296       TO DFHEIV11
 17297*    MOVE ',"IL                  $   #00016010' TO DFHEIV0
 17298     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17299     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17300     MOVE X'2020233030303136303130' TO DFHEIV0(25:11)
 17301     CALL 'kxdfhei1' USING DFHEIV0,
 17302           DFHEIV20,
 17303           DFHEIV11,
 17304           GETMAIN-SPACE
 17305     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17306         DFHEIV20
 17307     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17308
 17309
 17310     SUBTRACT +1               FROM CL-TRAILER-SEQ-CNT.
 17311
 17312     MOVE CL-CONTROL-PRIMARY     TO AT-CONTROL-PRIMARY.
 17313     MOVE 'AT'                   TO AT-RECORD-ID.
 17314     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 17315
 17316     MOVE 'A'                    TO AT-TRAILER-TYPE.
 17317     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 17318                                    AT-FORM-LAST-MAINT-DT
 17319                                    AT-FORM-SEND-ON-DT.
 17320     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 17321                                    AT-FORM-LAST-UPDATED-BY.
 17322     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 17323     MOVE WS-TODAY-DATE          TO DC-BIN-DATE-1.
 17324     MOVE '6'                    TO DC-OPTION-CODE.
 17325     MOVE +29                    TO DC-ELAPSED-DAYS.
 17326     MOVE +0                     TO DC-ELAPSED-MONTHS.
 17327     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 17328     MOVE DC-BIN-DATE-2          TO AT-FORM-FOLLOW-UP-DT.
 17329
 17330     IF PI-COMPANY-ID = 'RMC' OR 'LAP'
 17331         MOVE  LOW-VALUES        TO AT-FORM-FOLLOW-UP-DT.
 17332
 17333     MOVE LOW-VALUES             TO AT-FORM-ANSWERED-DT
 17334                                    AT-FORM-RE-SEND-DT
 17335                                    AT-EMP-FORM-ANSWERED-DT
 17336                                    AT-PHY-FORM-ANSWERED-DT
 17337                                    AT-EMP-FORM-SEND-ON-DT
 17338                                    AT-PHY-FORM-SEND-ON-DT
 17339                                    AT-FORM-PRINTED-DT
 17340                                    AT-FORM-REPRINT-DT.
 17341     MOVE '2'                    TO AT-FORM-TYPE.
 17342
 17343     MOVE CL-INSURED-ADDR-CNT    TO AT-FORM-ADDR-SEQ-NO.
 17344     MOVE 'I'                    TO AT-FORM-ADDRESS.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 332
* EL156.cbl
 17345
 17346     IF PI-COMPANY-ID = 'RMC' OR 'LAP'
 17347         NEXT SENTENCE
 17348     ELSE
 17349         IF CL-PROG-FORM-TYPE NOT = 'S'
 17350            MOVE WS-TODAY-DATE   TO AT-PHY-FORM-SEND-ON-DT.
 17351
 17352
 17353* EXEC CICS WRITE
 17354*         DATASET  ('ELTRLR')
 17355*         FROM     (ACTIVITY-TRAILERS)
 17356*         RIDFLD   (AT-CONTROL-PRIMARY)
 17357*     END-EXEC.
 17358     MOVE LENGTH OF
 17359      ACTIVITY-TRAILERS
 17360       TO DFHEIV11
 17361     MOVE 'ELTRLR' TO DFHEIV1
 17362*    MOVE '&$ L                  ''   #00016058' TO DFHEIV0
 17363     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17364     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17365     MOVE X'2020233030303136303538' TO DFHEIV0(25:11)
 17366     CALL 'kxdfhei1' USING DFHEIV0,
 17367           DFHEIV1,
 17368           ACTIVITY-TRAILERS,
 17369           DFHEIV11,
 17370           AT-CONTROL-PRIMARY,
 17371           DFHEIV99,
 17372           DFHEIV99
 17373     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17374
 17375
 17376 6899-EXIT.
 17377      EXIT.
 17378
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 333
* EL156.cbl
 17380 6900-BUILD-ARCHIVE-HEADER.
 17381
 17382     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17383     MOVE '1'                    TO CNTL-REC-TYPE.
 17384     MOVE +0                     TO CNTL-SEQ-NO.
 17385     MOVE SPACES                 TO CNTL-ACCESS.
 17386
 17387
 17388* EXEC CICS READ
 17389*         DATASET  ('ELCNTL')
 17390*         SET      (ADDRESS OF CONTROL-FILE)
 17391*         RIDFLD   (ELCNTL-KEY)
 17392*         UPDATE
 17393*    END-EXEC.
 17394     MOVE 'ELCNTL' TO DFHEIV1
 17395*    MOVE '&"S        EU         (   #00016075' TO DFHEIV0
 17396     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17397     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17398     MOVE X'2020233030303136303735' TO DFHEIV0(25:11)
 17399     CALL 'kxdfhei1' USING DFHEIV0,
 17400           DFHEIV1,
 17401           DFHEIV20,
 17402           DFHEIV99,
 17403           ELCNTL-KEY,
 17404           DFHEIV99,
 17405           DFHEIV99,
 17406           DFHEIV99
 17407     SET ADDRESS OF CONTROL-FILE TO
 17408         DFHEIV20
 17409     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17410
 17411
 17412     ADD +1                      TO CF-CO-ARCHIVE-COUNTER.
 17413     MOVE CF-CO-ARCHIVE-COUNTER  TO ARCH-NUMBER.
 17414
 17415
 17416* EXEC CICS REWRITE
 17417*         FROM     (CONTROL-FILE)
 17418*         DATASET  ('ELCNTL')
 17419*    END-EXEC.
 17420     MOVE LENGTH OF
 17421      CONTROL-FILE
 17422       TO DFHEIV11
 17423     MOVE 'ELCNTL' TO DFHEIV1
 17424*    MOVE '&& L                  %   #00016085' TO DFHEIV0
 17425     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17426     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17427     MOVE X'2020233030303136303835' TO DFHEIV0(25:11)
 17428     CALL 'kxdfhei1' USING DFHEIV0,
 17429           DFHEIV1,
 17430           CONTROL-FILE,
 17431           DFHEIV11,
 17432           DFHEIV99
 17433     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17434
 17435
 17436
 17437* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 334
* EL156.cbl
 17438*         DUPKEY   (6900-BUILD-ARCHIVE-HEADER)
 17439*         DUPREC   (6900-BUILD-ARCHIVE-HEADER)
 17440*    END-EXEC.
 17441*    MOVE '"$$%                  ! 7 #00016090' TO DFHEIV0
 17442     MOVE X'222424252020202020202020' TO DFHEIV0(1:12)
 17443     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17444     MOVE X'3720233030303136303930' TO DFHEIV0(25:11)
 17445     CALL 'kxdfhei1' USING DFHEIV0
 17446     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17447
 17448
 17449
 17450* EXEC CICS GETMAIN
 17451*         SET     (ADDRESS OF LETTER-ARCHIVE)
 17452*         LENGTH  (ELARCH-LENGTH)
 17453*         INITIMG (GETMAIN-SPACE)
 17454*    END-EXEC.
 17455*    MOVE ',"IL                  $   #00016095' TO DFHEIV0
 17456     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17457     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17458     MOVE X'2020233030303136303935' TO DFHEIV0(25:11)
 17459     CALL 'kxdfhei1' USING DFHEIV0,
 17460           DFHEIV20,
 17461           ELARCH-LENGTH,
 17462           GETMAIN-SPACE
 17463     SET ADDRESS OF LETTER-ARCHIVE TO
 17464         DFHEIV20
 17465     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17466
 17467
 17468     MOVE 'LA'                   TO LA-RECORD-ID.
 17469     MOVE ARCH-NUMBER            TO LA-ARCHIVE-NO
 17470                                    LA-ARCHIVE-NO-A1.
 17471     MOVE '4'                    TO LA-RECORD-TYPE
 17472                                    LA-RECORD-TYPE-A1.
 17473     MOVE +0                     TO LA-LINE-SEQ-NO
 17474                                    LA-LINE-SEQ-NO-A1.
 17475     MOVE PI-COMPANY-CD          TO LA-COMPANY-CD
 17476                                    LA-COMPANY-CD-A1.
 17477     MOVE CL-CARRIER             TO LA4-CARRIER.
 17478     MOVE CL-CLAIM-NO            TO LA4-CLAIM-NO.
 17479     MOVE CL-CERT-NO             TO LA4-CERT-NO.
 17480     MOVE CL-CERT-STATE          TO LA4-STATE.
 17481     MOVE +0                     TO LA4-NO-OF-COPIES.
 17482     MOVE PI-PROCESSOR-ID        TO LA4-PROCESSOR-CD.
 17483     MOVE WS-TODAY-DATE          TO LA4-CREATION-DT.
 17484     MOVE LOW-VALUES             TO LA4-RESEND-DATE
 17485                                    LA4-INITIAL-PRINT-DATE
 17486                                    LA4-RESEND-PRINT-DATE
 17487                                    LA4-FORM-REM-PRINT-DT.
 17488     MOVE CL-TRAILER-SEQ-CNT     TO LA4-FORM-TRLR-SEQ.
 17489     MOVE '2'                    TO LA4-FORM-TYPE.
 17490
 17491
 17492* EXEC CICS WRITE
 17493*         DATASET  ('ELARCH')
 17494*         FROM     (LETTER-ARCHIVE)
 17495*         RIDFLD   (LA-CONTROL-PRIMARY)
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 335
* EL156.cbl
 17496*    END-EXEC.
 17497     MOVE LENGTH OF
 17498      LETTER-ARCHIVE
 17499       TO DFHEIV11
 17500     MOVE 'ELARCH' TO DFHEIV1
 17501*    MOVE '&$ L                  ''   #00016124' TO DFHEIV0
 17502     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17503     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17504     MOVE X'2020233030303136313234' TO DFHEIV0(25:11)
 17505     CALL 'kxdfhei1' USING DFHEIV0,
 17506           DFHEIV1,
 17507           LETTER-ARCHIVE,
 17508           DFHEIV11,
 17509           LA-CONTROL-PRIMARY,
 17510           DFHEIV99,
 17511           DFHEIV99
 17512     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17513
 17514
 17515 6999-EXIT.
 17516      EXIT.
 17517
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 336
* EL156.cbl
 17519 7000-SHOW-CLAIM.
 17520     MOVE SPACES                 TO PI-PROGRAM-WORK-AREA.
 17521     MOVE 'A'                    TO PI-PASS-SW.
 17522     MOVE LOW-VALUES             TO PI-CPYFROM
 17523                                    PI-MONTH-END-SAVE
 17524                                    PI-CPYTHRU.
 17525
 17526     MOVE ZEROS                  TO PI-FATAL-COUNT
 17527                                    PI-DAILY-RATE
 17528                                    PI-BEN-DAYS
 17529                                    PI-MANUAL-SW
 17530                                    PI-SAVE-CURSOR
 17531                                    PI-FORCE-COUNT
 17532                                    PI-HOLDTIL
 17533                                    PI-EPYFROM
 17534                                    PI-EPYTHRU
 17535                                    PI-EDAYS
 17536                                    PI-EPYAMT
 17537                                    PI-ERESV
 17538                                    PI-EEXPENS
 17539                                    PI-CDAYS
 17540                                    PI-CPYAMT
 17541                                    PI-CRESV
 17542                                    PI-CEXPENS
 17543                                    PI-INT-RATE
 17544                                    PI-AIGFROM.
 17545     MOVE ZEROS                  TO PI-PROOF-DATE.
 17546     MOVE ZEROS                  TO PI-ORIG-BEN-AMT
 17547                                    PI-REM-BEN-AMT
 17548                                    PI-MO-BEN-AMT
 17549                                    pi-ah-term.
 17550
 17551     MOVE LOW-VALUES             TO EL156AI.
 17552     MOVE MAP-NAMEA              TO MAP-NAME.
 17553
 17554* EXEC CICS HANDLE CONDITION
 17555*        NOTFND   (7010-BUILD-MAP)
 17556*    END-EXEC.
 17557*    MOVE '"$I                   ! 8 #00016168' TO DFHEIV0
 17558     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17559     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17560     MOVE X'3820233030303136313638' TO DFHEIV0(25:11)
 17561     CALL 'kxdfhei1' USING DFHEIV0
 17562     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17563
 17564
 17565     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17566     MOVE '2'                    TO CNTL-REC-TYPE.
 17567     MOVE +0                     TO CNTL-SEQ-NO.
 17568     MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS.
 17569
 17570
 17571* EXEC CICS READ
 17572*         DATASET  ('ELCNTL')
 17573*         SET      (ADDRESS OF CONTROL-FILE)
 17574*         RIDFLD   (ELCNTL-KEY)
 17575*    END-EXEC.
 17576     MOVE 'ELCNTL' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 337
* EL156.cbl
 17577*    MOVE '&"S        E          (   #00016177' TO DFHEIV0
 17578     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17579     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17580     MOVE X'2020233030303136313737' TO DFHEIV0(25:11)
 17581     CALL 'kxdfhei1' USING DFHEIV0,
 17582           DFHEIV1,
 17583           DFHEIV20,
 17584           DFHEIV99,
 17585           ELCNTL-KEY,
 17586           DFHEIV99,
 17587           DFHEIV99,
 17588           DFHEIV99
 17589     SET ADDRESS OF CONTROL-FILE TO
 17590         DFHEIV20
 17591     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17592
 17593
 17594     MOVE CF-APPROVAL-LEVEL TO PI-APPROVAL-LEVEL.
 17595
 17596     IF PI-APPROVAL-LEVEL = '4' OR '5'
 17597         MOVE AL-UANON      TO SURVYYNA
 17598     END-IF.
 17599
 17600
 17601     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17602     MOVE '1'                    TO CNTL-REC-TYPE.
 17603     MOVE SPACES                 TO CNTL-ACCESS.
 17604     MOVE +0                     TO CNTL-SEQ-NO.
 17605
 17606
 17607* EXEC CICS READ
 17608*         DATASET  ('ELCNTL')
 17609*         SET      (ADDRESS OF CONTROL-FILE)
 17610*         RIDFLD   (ELCNTL-KEY)
 17611*    END-EXEC.
 17612     MOVE 'ELCNTL' TO DFHEIV1
 17613*    MOVE '&"S        E          (   #00016195' TO DFHEIV0
 17614     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17615     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17616     MOVE X'2020233030303136313935' TO DFHEIV0(25:11)
 17617     CALL 'kxdfhei1' USING DFHEIV0,
 17618           DFHEIV1,
 17619           DFHEIV20,
 17620           DFHEIV99,
 17621           ELCNTL-KEY,
 17622           DFHEIV99,
 17623           DFHEIV99,
 17624           DFHEIV99
 17625     SET ADDRESS OF CONTROL-FILE TO
 17626         DFHEIV20
 17627     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17628
 17629
 17630     MOVE CF-CO-REAUDIT-INTERVAL TO PI-REAUDIT-INTERVAL.
 17631
 17632 7010-BUILD-MAP.
 17633
 17634
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 338
* EL156.cbl
 17635* EXEC CICS HANDLE CONDITION
 17636*        NOTFND(7100-SHOW-RECORD-NOT-FOUND)
 17637*    END-EXEC.
 17638*    MOVE '"$I                   ! 9 #00016205' TO DFHEIV0
 17639     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17640     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17641     MOVE X'3920233030303136323035' TO DFHEIV0(25:11)
 17642     CALL 'kxdfhei1' USING DFHEIV0
 17643     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17644
 17645
 17646     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 17647     MOVE PI-CARRIER             TO MSTR-CARRIER.
 17648     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
 17649     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
 17650     MOVE 'MSTR'                 TO FILE-SWITCH.
 17651
 17652     PERFORM 7900-READ-CLAIM THRU 7900-EXIT.
 17653
 17654     MOVE CL-CERT-KEY-DATA       TO PI-SV-CERT-KEY.
 17655     MOVE CL-CERT-NO             TO PI-SV-CERT-NO.
 17656     MOVE CL-BENEFICIARY         TO PI-SV-BEN.
 17657     MOVE CL-CCN                 TO PI-SV-CCN.
 17658
 17659     MOVE CL-LAST-MAINT-USER     TO PI-UPDATE-BY.
 17660     MOVE CL-LAST-MAINT-HHMMSS   TO PI-UPDATE-HHMMSS.
 17661     MOVE CL-CLAIM-NO            TO CLMNOO.
 17662     MOVE CL-CARRIER             TO CARRO.
 17663     MOVE CL-CERT-PRIME          TO CERTNOO.
 17664     MOVE CL-CERT-SFX            TO SUFXO.
 17665
 17666     IF (PI-COMPANY-ID = 'CID' OR 'AHL')
 17667        AND (CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1)
 17668        CONTINUE
 17669     ELSE
 17670        MOVE AL-SADOF            TO ZINTHA
 17671                                    ZINTA
 17672                                    PINTHA
 17673                                    PINTA
 17674     END-IF
 17675     MOVE CL-CLAIM-TYPE          TO PI-CLM-TYPE
 17676     EVALUATE TRUE
 17677     WHEN CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1
 17678         MOVE PI-AH-OVERRIDE-L6   TO CLMTYPO
 17679     WHEN CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 17680         MOVE PI-LIFE-OVERRIDE-L6 TO CLMTYPO
 17681
 17682     WHEN CL-CLAIM-TYPE = 'I'
 17683         MOVE '  IU  '           TO CLMTYPO
 17684     WHEN CL-CLAIM-TYPE = 'G'
 17685         MOVE ' GAP  '           TO CLMTYPO
 17686     WHEN CL-CLAIM-TYPE = 'F'
 17687         MOVE ' FMLA '           TO CLMTYPO
 17688     END-EVALUATE.
 17689     IF CLAIM-IS-OPEN
 17690         MOVE ' OPEN'            TO CLMSTATO
 17691     ELSE
 17692         MOVE 'CLOSED'           TO CLMSTATO.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 339
* EL156.cbl
 17693
 17694     PERFORM 5000-MOVE-NAME  THRU 5000-EXIT.
 17695
 17696     IF CL-ASSOC-CERT-TOTAL = +0 OR +1
 17697         MOVE SPACES             TO  PCERTNOO
 17698                                     PSUFXO
 17699                                     PRIMHDGO
 17700                                     SEQUO
 17701         MOVE AL-SADOF           TO  PCERTNOA
 17702                                     PSUFXA
 17703                                     PRIMHDGA
 17704                                     SEQUA
 17705     ELSE
 17706         MOVE CL-ASSOC-CERT-SEQU     TO  WS-CUR-SEQU
 17707         MOVE CL-ASSOC-CERT-TOTAL    TO  WS-OF-SEQU
 17708         MOVE WS-CLAIM-SEQUENCE      TO  SEQUO
 17709         MOVE CL-PRIME-CERT-PRIME    TO  PCERTNOO
 17710         MOVE CL-PRIME-CERT-SFX      TO  PSUFXO
 17711         MOVE 'PRIME CERT :'         TO  PRIMHDGO
 17712         MOVE AL-SANON               TO  PCERTNOA
 17713                                         PSUFXA
 17714                                         PRIMHDGA
 17715         MOVE AL-SABON               TO  SEQUA.
 17716
 17717     MOVE CL-ACTIVITY-CODE           TO  PI-ACTIVITY-CODE.
 17718
 17719     IF CL-NO-OF-PMTS-MADE = 0 AND
 17720        CL-TOTAL-PAID-AMT = 0
 17721         NEXT SENTENCE
 17722     ELSE
 17723         IF CL-PAID-THRU-DT NOT = LOW-VALUES
 17724             IF NOT PI-USES-PAID-TO
 17725                 MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 17726                 MOVE ' '                 TO DC-OPTION-CODE
 17727                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17728                 MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
 17729             ELSE
 17730                 MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 17731                 MOVE '6'                 TO DC-OPTION-CODE
 17732                 MOVE +1                  TO DC-ELAPSED-DAYS
 17733                 MOVE +0                  TO DC-ELAPSED-MONTHS
 17734                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17735                 MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO.
 17736
 17737     IF MAP-NAME = 'EL156A'
 17738        IF CL-PAID-THRU-DT NOT = LOW-VALUES AND SPACES
 17739           IF CL-TOTAL-PAID-AMT NOT = ZEROS
 17740             MOVE AL-SADOF TO    AIGFRMHA AIGFROMA
 17741           end-if
 17742        end-if
 17743     end-if
 17744     IF CL-LAST-PMT-DT NOT = LOW-VALUES
 17745         MOVE CL-LAST-PMT-DT     TO DC-BIN-DATE-1
 17746         MOVE ' '                TO DC-OPTION-CODE
 17747         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17748         MOVE DC-GREG-DATE-1-EDIT TO LSTDTEO.
 17749
 17750     IF CL-INCURRED-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 340
* EL156.cbl
 17751         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 17752         MOVE ' '                TO DC-OPTION-CODE
 17753         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17754         MOVE DC-GREG-DATE-1-EDIT    TO INCURO.
 17755
 17756     MOVE CL-TOTAL-PAID-AMT      TO TOTPAIDO.
 17757
 17758     IF CL-CERT-EFF-DT NOT = LOW-VALUES
 17759         MOVE CL-CERT-EFF-DT     TO DC-BIN-DATE-1
 17760         MOVE ' '                TO DC-OPTION-CODE
 17761         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17762         MOVE DC-GREG-DATE-1-EDIT    TO EFFECTO.
 17763
 17764     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17765         MOVE CL-CURRENT-ACCOUNT TO WS-WORK-ACCT
 17766         MOVE CL-CURRENT-STATE   TO WS-WORK-STATE
 17767     ELSE
 17768         MOVE CL-CERT-ACCOUNT    TO WS-WORK-ACCT
 17769         MOVE CL-CERT-STATE      TO WS-WORK-STATE.
 17770
 17771     MOVE WS-WORK-STATE-ACCT     TO STACCTO.
 17772     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
 17773     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
 17774     MOVE CL-CERT-GROUPING       TO CERT-GROUPING
 17775                                    PI-GROUPING.
 17776     MOVE CL-CERT-STATE          TO CERT-STATE
 17777                                    PI-STATE.
 17778     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT
 17779                                    PI-ACCOUNT.
 17780     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
 17781     MOVE CL-CERT-NO             TO CERT-CERT-NO.
 17782     MOVE 'CERT'                 TO FILE-SWITCH.
 17783
 17784     PERFORM 7970-READ-CERT THRU 7970-EXIT.
 17785     IF CM-INSURED-LAST-NAME EQUAL CL-INSURED-LAST-NAME  AND
 17786        CM-INSURED-FIRST-NAME EQUAL CL-INSURED-1ST-NAME  AND
 17787        CM-INSURED-INITIAL2 EQUAL CL-INSURED-MID-INIT
 17788            MOVE 'N' TO PI-JOINT-INSURED-IND
 17789     ELSE
 17790            MOVE 'Y' TO PI-JOINT-INSURED-IND
 17791     END-IF.
 17792
 17793     perform 7975-read-acct      thru 7975-exit
 17794     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17795     MOVE PI-STATE               TO WS-ST-ACCESS.
 17796     MOVE WS-STATE-ACCESS        TO CNTL-ACCESS.
 17797     MOVE '3'                    TO CNTL-REC-TYPE.
 17798     MOVE +0                     TO CNTL-SEQ-NO.
 17799     MOVE 'STAT'                 TO FILE-SWITCH.
 17800
 17801     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 17802
 17803     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREV.
 17804     MOVE CF-ST-FREE-LOOK-PERIOD TO CP-FREE-LOOK.
 17805
 17806     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 17807        GO TO 7020-BYPASS-BENEFIT.
 17808
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 341
* EL156.cbl
 17809     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17810     MOVE '4'                    TO CNTL-REC-TYPE.
 17811     MOVE +0                     TO CNTL-SEQ-NO.
 17812     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 17813     MOVE WS-ACCESS              TO CNTL-ACCESS.
 17814     MOVE 'BENE'                 TO FILE-SWITCH.
 17815
 17816     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 17817
 17818     IF NO-BENEFIT-FOUND
 17819        GO TO 7020-BYPASS-BENEFIT.
 17820
 17821     MOVE CF-CO-EARNINGS-CALC (SUB-1)    TO  WS-EARNING-METHOD.
 17822     MOVE CF-SPECIAL-CALC-CD  (SUB-1)    TO  WS-SPECIAL-CALC-CD.
 17823     MOVE CF-LF-COVERAGE-TYPE (SUB-1)    TO  WS-LF-COVERAGE-TYPE.
 17824
 17825 7020-BYPASS-BENEFIT.
 17826
 17827*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17828*        PERFORM 3400-COMPUTE-EXPIRY THRU 3499-EXIT
 17829*        MOVE PI-LOAN-DUE-DAY TO DUEDAYO.
 17830
 17831     move zeros                  to PI-MAX-BENEFIT-AMT
 17832     move cm-ah-benefit-cd       to pi-ah-benefit-cd
 17833     move cm-ah-orig-term        to pi-ah-term
 17834     move cm-ah-benefit-amt      to pi-ah-benefit-amt
 17835     IF CL-CLAIM-TYPE NOT = PI-AH-OVERRIDE-L1 AND 'I' AND
 17836          'G' and 'F'
 17837         GO TO 7021-GO-TO-LIFE.
 17838
 17839     IF (PI-COMPANY-ID = 'DCC' or 'VPP')
 17840        and (acct-found)
 17841        AND (PI-DCC-PRODUCT-CODE not = '   ')
 17842        PERFORM 0900-GET-DDF-limits
 17843                                 THRU 0900-EXIT
 17844        IF PDEF-FOUND
 17845           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 17846              (P1 > +8)
 17847              OR (PD-PROD-CODE (P1) = cl-claim-type)
 17848           END-PERFORM
 17849           IF P1 < +9
 17850              if pd-ben-pct (p1) not numeric
 17851                 move zeros      to pd-ben-pct (p1)
 17852              end-if
 17853              if pd-ben-pct (p1) = zeros
 17854                 move +1         to ws-work-ben-pct
 17855              else
 17856                 move pd-ben-pct (p1)
 17857                                 to ws-work-ben-pct
 17858              end-if
 17859              compute cm-ah-benefit-amt =
 17860                 cm-ah-benefit-amt * ws-work-ben-pct
 17861              move pd-max-amt (p1) to pi-max-benefit-amt
 17862           END-IF
 17863        END-IF
 17864     end-if
 17865     MOVE 'A'                    TO CP-BENEFIT-TYPE.
 17866     MOVE 'MO. BENEFIT :'        TO BENECAPO.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 342
* EL156.cbl
 17867     if (pi-max-benefit-amt not = zeros)
 17868        and (cm-ah-benefit-amt > pi-max-benefit-amt)
 17869        move pi-max-benefit-amt  to beneo
 17870     else
 17871        MOVE CM-AH-BENEFIT-AMT   TO BENEO
 17872     end-if
 17873     MOVE CM-POLICY-FORM-NO      TO PI-SAVE-FORM.
 17874     MOVE CM-AH-ORIG-TERM        TO WST-ORIG
 17875                                    CP-ORIGINAL-TERM.
 17876     MOVE CM-AH-CURRENT-STATUS   TO WS-STATUS.
 17877
 17878*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17879*        MOVE WS-EXP-DT            TO DC-BIN-DATE-1
 17880*    ELSE
 17881         MOVE CM-AH-LOAN-EXPIRE-DT TO DC-BIN-DATE-1.
 17882
 17883     MOVE ' '                    TO DC-OPTION-CODE.
 17884     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 17885     MOVE DC-GREG-DATE-1-EDIT    TO EXPDTEO.
 17886
 17887     IF PI-COMPANY-ID = 'DMD'
 17888         PERFORM 9830-DMD-REMAINING-TERM THRU 9830-EXIT
 17889         GO TO 7023-BYPASS-REMAINING-TERM.
 17890
 17891     MOVE SPACES                 TO WST-REM-DAYS-GRP.
 17892     MOVE SAVE-BIN-DATE          TO CP-VALUATION-DT.
 17893     GO TO 7022-AROUND-LIFE.
 17894
 17895 7021-GO-TO-LIFE.
 17896
 17897     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 17898     MOVE CM-POLICY-FORM-NO      TO PI-SAVE-FORM.
 17899     MOVE CM-LF-ORIG-TERM        TO WST-ORIG
 17900                                    CP-ORIGINAL-TERM.
 17901     MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD.
 17902     MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD.
 17903     MOVE CL-INCURRED-DT         TO CP-VALUATION-DT.
 17904     MOVE CM-LF-CURRENT-STATUS   TO WS-STATUS.
 17905
 17906     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17907         MOVE WS-EXP-DT            TO DC-BIN-DATE-1
 17908     ELSE
 17909         MOVE CM-LF-LOAN-EXPIRE-DT TO DC-BIN-DATE-1.
 17910
 17911     MOVE ' '                    TO DC-OPTION-CODE.
 17912     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 17913     MOVE DC-GREG-DATE-1-EDIT    TO EXPDTEO.
 17914
 17915 7022-AROUND-LIFE.
 17916
 17917     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 17918     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 17919     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 17920     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 17921     MOVE '4'                    TO CP-REM-TERM-METHOD.
 17922     PERFORM 9800-LINK-REM-TERM THRU 9800-EXIT.
 17923     MOVE CP-REMAINING-TERM-3    TO WST-REM.
 17924
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 343
* EL156.cbl
 17925     MOVE SPACES                 TO WST-REM-DAYS-GRP.
 17926
 17927     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 17928        IF CP-REMAINING-TERM-3 > CM-AH-ORIG-TERM
 17929           MOVE CM-AH-ORIG-TERM  TO WST-REM.
 17930
 17931     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 17932        IF CP-REMAINING-TERM-3 > CM-LF-ORIG-TERM
 17933           MOVE CM-LF-ORIG-TERM  TO WST-REM.
 17934
 17935 7023-BYPASS-REMAINING-TERM.
 17936     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 17937       IF CM-LF-CURRENT-STATUS = '6' OR '7' OR '8'
 17938          MOVE ZEROS                  TO BENEO
 17939       ELSE
 17940          MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE
 17941          MOVE PI-COMPANY-ID          TO CP-COMPANY-ID
 17942          MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM
 17943          MOVE CM-LF-BENEFIT-AMT      TO CP-ORIGINAL-BENEFIT
 17944          MOVE CM-LF-ALT-BENEFIT-AMT  TO CP-ALTERNATE-BENEFIT
 17945          MOVE CP-REMAINING-TERM-3    TO CP-REMAINING-TERM
 17946          MOVE CM-LOAN-APR            TO CP-LOAN-APR
 17947          MOVE CM-LOAN-TERM           TO CP-LOAN-TERM
 17948          MOVE CM-PAY-FREQUENCY       TO CP-PAY-FREQUENCY
 17949          MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD
 17950          MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD
 17951          MOVE WS-STATE-ABBREV        TO CP-STATE-STD-ABBRV
 17952          IF (PI-COMPANY-ID = 'DCC' or 'VPP')
 17953             AND (PI-DCC-PRODUCT-CODE not = '   ')
 17954             PERFORM 0900-GET-DDF-limits
 17955                                 THRU 0900-EXIT
 17956             IF PDEF-FOUND
 17957                PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 17958                   (P1 > +8)
 17959                   OR (PD-PROD-CODE (P1) = 'L')
 17960                END-PERFORM
 17961                IF P1 < +9
 17962                   MOVE PD-MAX-AMT (P1)
 17963                                 TO CP-R-MAX-TOT-BEN
 17964                END-IF
 17965             END-IF
 17966          END-IF
 17967
 17968* EXEC CICS LINK
 17969*            PROGRAM  (LINK-REMAMT)
 17970*            COMMAREA (CALCULATION-PASS-AREA)
 17971*            LENGTH   (CP-COMM-LENGTH)
 17972*         END-EXEC
 17973*    MOVE '."C                   (   #00016530' TO DFHEIV0
 17974     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17975     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17976     MOVE X'2020233030303136353330' TO DFHEIV0(25:11)
 17977     CALL 'kxdfhei1' USING DFHEIV0,
 17978           LINK-REMAMT,
 17979           CALCULATION-PASS-AREA,
 17980           CP-COMM-LENGTH,
 17981           DFHEIV99,
 17982           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 344
* EL156.cbl
 17983           DFHEIV99,
 17984           DFHEIV99
 17985     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17986          MOVE CP-REMAINING-AMT       TO BENEO
 17987       end-if
 17988     end-if
 17989     MOVE ELMSTR-KEY             TO ELTRLR-KEY
 17990     MOVE +95                    TO TRLR-SEQ-NO
 17991
 17992* EXEC CICS READ
 17993*       DATASET  ('ELTRLR')
 17994*       SET      (ADDRESS OF ACTIVITY-TRAILERS)
 17995*       RIDFLD   (ELTRLR-KEY)
 17996*       RESP     (WS-RESPONSE)
 17997*    END-EXEC
 17998     MOVE 'ELTRLR' TO DFHEIV1
 17999*    MOVE '&"S        E          (  N#00016540' TO DFHEIV0
 18000     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18001     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18002     MOVE X'204E233030303136353430' TO DFHEIV0(25:11)
 18003     CALL 'kxdfhei1' USING DFHEIV0,
 18004           DFHEIV1,
 18005           DFHEIV20,
 18006           DFHEIV99,
 18007           ELTRLR-KEY,
 18008           DFHEIV99,
 18009           DFHEIV99,
 18010           DFHEIV99
 18011     SET ADDRESS OF ACTIVITY-TRAILERS TO
 18012         DFHEIV20
 18013     MOVE EIBRESP  TO WS-RESPONSE
 18014     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18015
 18016     if ws-resp-normal
 18017        perform varying s1 from +1 by +1 until
 18018           at-note-error-no (s1) = spaces
 18019           move at-note-error-no (s1)
 18020                                 to emi-error
 18021           if at-note-error-no (s1) = '1653'
 18022              evaluate true
 18023                 when cl-claim-type = 'L'
 18024                    move '  LF  '
 18025                                 to emi-claim-type
 18026                 when cl-claim-type = 'I'
 18027                    move '  IU  '
 18028                                 to emi-claim-type
 18029                 when cl-claim-type = 'F'
 18030                    move ' FMLA '
 18031                                 to emi-claim-type
 18032                 when other
 18033                    move '  AH  '
 18034                                 to emi-claim-type
 18035              end-evaluate
 18036           end-if
 18037           PERFORM 9900-ERROR-FORMAT
 18038                                 THRU 9900-EXIT
 18039        end-perform
 18040     end-if
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 345
* EL156.cbl
 18041     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 18042         IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 18043            WS-LF-COVERAGE-TYPE = 'P'
 18044             COMPUTE WS-REMAINING-AMT = CM-LF-BENEFIT-AMT -
 18045                                        CM-LF-ITD-DEATH-AMT
 18046             MOVE WS-REMAINING-AMT  TO  BENEO.
 18047
 18048     MOVE CM-LF-BENEFIT-AMT      TO PI-ORIG-BEN-AMT.
 18049     MOVE BENEO                  TO PI-REM-BEN-AMT.
 18050     MOVE WS-TERMS               TO TERMSO.
 18051
 18052     IF WS-STATUS = '6' OR '7' OR '8'
 18053         MOVE AL-SABOF           TO CRTSTATA.
 18054
 18055     IF WS-STATUS = '1' OR '4'
 18056        IF CP-REMAINING-TERM-3 = ZEROS
 18057           MOVE 'EXPIRED'        TO CRTSTATO
 18058        ELSE
 18059           MOVE 'ACTIVE  '       TO CRTSTATO.
 18060
 18061     IF WS-STATUS = '2'
 18062         MOVE 'PEND    '         TO CRTSTATO.
 18063
 18064     IF WS-STATUS = '3'
 18065         MOVE 'RESTORE '         TO CRTSTATO.
 18066
 18067     IF WS-STATUS = '5'
 18068         MOVE 'REISSUE '         TO CRTSTATO.
 18069
 18070     IF WS-STATUS = '6'
 18071         MOVE 'LMP DIS'          TO CRTSTATO.
 18072
 18073     IF WS-STATUS = '7'
 18074         MOVE 'DEATH'            TO CRTSTATO.
 18075
 18076     IF WS-STATUS = '8'
 18077         MOVE 'CANCEL'           TO CRTSTATO.
 18078
 18079     IF WS-STATUS = '9'
 18080         MOVE 'RE-ONLY '         TO CRTSTATO.
 18081
 18082     IF WS-STATUS = 'V'
 18083         MOVE 'VOID  '           TO CRTSTATO.
 18084
 18085     IF WS-STATUS = 'D'
 18086         MOVE 'DECLINE '         TO CRTSTATO.
 18087
 18088     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 18089         MOVE CM-AH-BENEFIT-CD   TO WS-BEN-CD
 18090         MOVE '5'                TO CNTL-REC-TYPE
 18091     ELSE
 18092         MOVE CM-LF-BENEFIT-CD   TO WS-BEN-CD
 18093         MOVE '4'                TO CNTL-REC-TYPE.
 18094
 18095     MOVE '** NONE **'           TO COVERO.
 18096     MOVE AL-SABON               TO COVERA.
 18097
 18098     IF PI-COMPANY-ID = 'CVL'
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 346
* EL156.cbl
 18099         IF CM-BENEFICIARY NOT = SPACES AND LOW-VALUES
 18100             MOVE CM-BENEFICIARY TO LOANNOO
 18101             MOVE AL-UANON       TO LOANNOA.
 18102
 18103     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP'
 18104        MOVE ELMSTR-KEY          TO  ELTRLR-KEY
 18105        MOVE +91                 TO  TRLR-SEQ-NO
 18106
 18107* EXEC CICS READ
 18108*           DATASET  ('ELTRLR')
 18109*           SET      (ADDRESS OF ACTIVITY-TRAILERS)
 18110*           RIDFLD   (ELTRLR-KEY)
 18111*           RESP     (WS-RESPONSE)
 18112*       END-EXEC
 18113     MOVE 'ELTRLR' TO DFHEIV1
 18114*    MOVE '&"S        E          (  N#00016637' TO DFHEIV0
 18115     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18116     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18117     MOVE X'204E233030303136363337' TO DFHEIV0(25:11)
 18118     CALL 'kxdfhei1' USING DFHEIV0,
 18119           DFHEIV1,
 18120           DFHEIV20,
 18121           DFHEIV99,
 18122           ELTRLR-KEY,
 18123           DFHEIV99,
 18124           DFHEIV99,
 18125           DFHEIV99
 18126     SET ADDRESS OF ACTIVITY-TRAILERS TO
 18127         DFHEIV20
 18128     MOVE EIBRESP  TO WS-RESPONSE
 18129     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18130
 18131        IF WS-RESP-NORMAL
 18132           MOVE AT-INFO-LINE-1   TO  LOANNOO
 18133        ELSE
 18134           MOVE SPACES           TO  LOANNOO
 18135        END-IF
 18136*052506
 18137*052506        PERFORM 7250-FIND-LETTER-TRLR THRU 7250-EXIT
 18138*052506
 18139     END-IF
 18140
 18141     IF CL-PROG-FORM-TYPE = 'S' OR 'L'
 18142        MOVE CL-PROG-FORM-TYPE   TO FORMTYPO.
 18143
 18144     IF WS-BEN-CD = ZEROS
 18145         GO TO 7050-SHOW-CONTINUE.
 18146
 18147     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 18148     MOVE WS-ACCESS              TO CNTL-ACCESS.
 18149     MOVE +0                     TO CNTL-SEQ-NO.
 18150     MOVE 'BENE'                 TO FILE-SWITCH.
 18151
 18152     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 18153     IF BENEFIT-FOUND
 18154        MOVE CF-JOINT-INDICATOR (SUB-1)
 18155                                 TO PI-JOINT-COV-IND
 18156                                    PI-RB-JOINT-COV-IND
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 347
* EL156.cbl
 18157        MOVE CF-BENEFIT-DESCRIP (SUB-1)
 18158                                 TO COVERO
 18159        MOVE AL-SANON            TO COVERA
 18160     END-IF
 18161     if (cntl-rec-type = '4')   *> Life claim
 18162        and (cm-ah-benefit-cd not = zeros) *> AH coverage
 18163        MOVE PI-COMPANY-ID    TO CNTL-COMP-ID
 18164        MOVE CM-AH-BENEFIT-CD TO WS-BEN-CD
 18165        MOVE '5'              TO CNTL-REC-TYPE
 18166        MOVE WS-ACCESS        TO CNTL-ACCESS
 18167        MOVE +0               TO CNTL-SEQ-NO
 18168        MOVE 'BENE'           TO FILE-SWITCH
 18169        PERFORM 7200-FIND-BENEFIT
 18170                              THRU 7200-EXIT
 18171        IF (BENEFIT-FOUND)
 18172           and (pi-rb-joint-cov-ind) not = 'J'
 18173           MOVE CF-JOINT-INDICATOR (SUB-1)
 18174                              TO PI-rb-JOINT-COV-IND
 18175        end-if
 18176     end-if
 18177     .
 18178 7050-SHOW-CONTINUE.
 18179
 18180     IF PI-JOINT-INSURED AND NOT PI-JOINT-COVERAGE
 18181        AND CL-TOTAL-PAID-AMT NOT GREATER THAN ZERO
 18182            MOVE 'Y' TO PI-APPROVAL-3550-NEEDED
 18183     END-IF
 18184
 18185     IF PI-COMPANY-ID = 'DMD'
 18186         PERFORM 8010-DMD-ERROR-CHECKS THRU 8090-EXIT.
 18187
 18188     MOVE -1                     TO PMTTYPEL.
 18189     GO TO 8100-SEND-INITIAL-MAP.
 18190
 18191 7100-SHOW-RECORD-NOT-FOUND.
 18192     IF FILE-SWITCH = 'MSTR'
 18193         MOVE ER-0204            TO EMI-ERROR.
 18194
 18195     IF FILE-SWITCH = 'CERT'
 18196         MOVE ER-0206            TO EMI-ERROR.
 18197
 18198     IF FILE-SWITCH = 'STAT'
 18199         MOVE ER-0149            TO EMI-ERROR.
 18200
 18201     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18202
 18203     MOVE -1                     TO PMTTYPEL.
 18204     GO TO 8100-SEND-INITIAL-MAP
 18205
 18206     .
 18207 7110-BUILD-PMT-TRLR.
 18208     MOVE ELMSTR-KEY             TO ELTRLR-KEY
 18209     MOVE +51                    TO TRLR-SEQ-NO
 18210
 18211* EXEC CICS READ
 18212*        DATASET  ('ELTRLR')
 18213*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 18214*        RIDFLD   (ELTRLR-KEY)
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 348
* EL156.cbl
 18215*        RESP     (WS-RESPONSE)
 18216*    END-EXEC
 18217     MOVE 'ELTRLR' TO DFHEIV1
 18218*    MOVE '&"S        E          (  N#00016723' TO DFHEIV0
 18219     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18220     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18221     MOVE X'204E233030303136373233' TO DFHEIV0(25:11)
 18222     CALL 'kxdfhei1' USING DFHEIV0,
 18223           DFHEIV1,
 18224           DFHEIV20,
 18225           DFHEIV99,
 18226           ELTRLR-KEY,
 18227           DFHEIV99,
 18228           DFHEIV99,
 18229           DFHEIV99
 18230     SET ADDRESS OF ACTIVITY-TRAILERS TO
 18231         DFHEIV20
 18232     MOVE EIBRESP  TO WS-RESPONSE
 18233     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18234     IF WS-RESP-NORMAL
 18235        MOVE AT-MAIL-TO-NAME     TO PI-PAYEE-NAME
 18236     END-IF
 18237     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT
 18238
 18239* EXEC CICS GETMAIN
 18240*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 18241*         LENGTH    (200)
 18242*         INITIMG   (GETMAIN-SPACE)
 18243*     END-EXEC
 18244     MOVE 200
 18245       TO DFHEIV11
 18246*    MOVE ',"IL                  $   #00016733' TO DFHEIV0
 18247     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 18248     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18249     MOVE X'2020233030303136373333' TO DFHEIV0(25:11)
 18250     CALL 'kxdfhei1' USING DFHEIV0,
 18251           DFHEIV20,
 18252           DFHEIV11,
 18253           GETMAIN-SPACE
 18254     SET ADDRESS OF ACTIVITY-TRAILERS TO
 18255         DFHEIV20
 18256     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18257     MOVE LOW-VALUES             TO AT-PREV-LAST-PMT-DT
 18258                                    AT-PREV-PAID-THRU-DT
 18259     MOVE ZEROS                  TO AT-PREV-LAST-PMT-AMT
 18260     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY
 18261     MOVE 'AT'                   TO AT-RECORD-ID
 18262     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO
 18263     MOVE +0                     TO AT-PAYMENT-NOTE-SEQ-NO
 18264     MOVE '2'                    TO AT-TRAILER-TYPE
 18265     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 18266                                    AT-PAYMENT-LAST-MAINT-DT
 18267     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 18268                                    AT-PAYMENT-LAST-UPDATED-BY
 18269     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS
 18270     MOVE 'I'                    TO AT-PAYMENT-TYPE
 18271     MOVE CL-CLAIM-TYPE          TO AT-CLAIM-TYPE
 18272     MOVE CL-CLAIM-PREM-TYPE     TO AT-CLAIM-PREM-TYPE
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 349
* EL156.cbl
 18273     MOVE +0                     TO AT-EXPENSE-PER-PMT
 18274     MOVE PI-INT-AMT             TO AT-AMOUNT-PAID
 18275     MOVE LOW-VALUES             TO AT-PAID-FROM-DT
 18276     MOVE LOW-VALUES             TO AT-PAID-THRU-DT
 18277     MOVE PI-INT-DAYS            TO AT-DAYS-IN-PERIOD
 18278     MOVE PI-INT-RATE-USED       TO AT-INT-RATE
 18279     if pi-int-to-rem-borr = 'Y'
 18280        move 'Q1'                to at-payee-type-cd
 18281     else
 18282        MOVE 'O1'                TO AT-PAYEE-TYPE-CD
 18283     end-if
 18284     MOVE PI-int-payees-name     TO AT-PAYEES-NAME
 18285     MOVE PI-MONTH-END-SAVE      TO AT-PMT-SELECT-DT
 18286     MOVE '3'                    TO AT-PAYMENT-ORIGIN
 18287     MOVE SPACES                 TO AT-AIG-UNEMP-IND
 18288     MOVE LOW-VALUES             TO AT-CHECK-WRITTEN-DT
 18289                                    AT-TO-BE-WRITTEN-DT
 18290     MOVE ZEROS                  TO AT-CHECK-QUE-CONTROL
 18291                                    AT-CHECK-QUE-SEQUENCE
 18292                                    AT-ADDL-RESERVE
 18293     MOVE LOW-VALUES             TO AT-PMT-ACCEPT-DT
 18294                                    AT-VOID-SELECT-DT
 18295                                    AT-VOID-ACCEPT-DT
 18296                                    AT-VOID-DT
 18297                                    AT-PMT-PROOF-DT
 18298                                    AT-INT-PMT-SELECT-DT
 18299     MOVE ZEROS                  TO AT-DAILY-RATE
 18300                                    AT-ELIMINATION-DAYS
 18301     MOVE SPACES                 TO AT-BENEFIT-TYPE
 18302*    EXEC CICS HANDLE CONDITION
 18303*        DUPREC    (7120-DUPREC)
 18304*    END-EXEC
 18305     .
 18306 7115-WRITE-INT-TRLR.
 18307
 18308* EXEC CICS WRITE
 18309*         DATASET       ('ELTRLR')
 18310*         FROM          (ACTIVITY-TRAILERS)
 18311*         RIDFLD        (AT-CONTROL-PRIMARY)
 18312*         RESP          (WS-RESPONSE)
 18313*     END-EXEC
 18314     MOVE LENGTH OF
 18315      ACTIVITY-TRAILERS
 18316       TO DFHEIV11
 18317     MOVE 'ELTRLR' TO DFHEIV1
 18318*    MOVE '&$ L                  ''  N#00016788' TO DFHEIV0
 18319     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 18320     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18321     MOVE X'204E233030303136373838' TO DFHEIV0(25:11)
 18322     CALL 'kxdfhei1' USING DFHEIV0,
 18323           DFHEIV1,
 18324           ACTIVITY-TRAILERS,
 18325           DFHEIV11,
 18326           AT-CONTROL-PRIMARY,
 18327           DFHEIV99,
 18328           DFHEIV99
 18329     MOVE EIBRESP  TO WS-RESPONSE
 18330     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 350
* EL156.cbl
 18331      IF WS-RESP-DUPREC
 18332         GO TO 7120-DUPREC
 18333      END-IF
 18334     GO TO 7130-EXIT
 18335     .
 18336 7120-DUPREC.
 18337     SUBTRACT +1                 FROM CL-TRAILER-SEQ-CNT
 18338     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO
 18339     GO TO 7115-WRITE-INT-TRLR
 18340     .
 18341 7130-EXIT.
 18342      EXIT.
 18343 7140-BUILD-NOTE-TRLR.
 18344
 18345
 18346* EXEC CICS GETMAIN
 18347*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 18348*         LENGTH    (200)
 18349*         INITIMG   (GETMAIN-SPACE)
 18350*     END-EXEC
 18351     MOVE 200
 18352       TO DFHEIV11
 18353*    MOVE ',"IL                  $   #00016808' TO DFHEIV0
 18354     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 18355     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18356     MOVE X'2020233030303136383038' TO DFHEIV0(25:11)
 18357     CALL 'kxdfhei1' USING DFHEIV0,
 18358           DFHEIV20,
 18359           DFHEIV11,
 18360           GETMAIN-SPACE
 18361     SET ADDRESS OF ACTIVITY-TRAILERS TO
 18362         DFHEIV20
 18363     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18364     SUBTRACT +1                 FROM CL-TRAILER-SEQ-CNT
 18365     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY
 18366     MOVE 'AT'                   TO AT-RECORD-ID
 18367     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO
 18368     MOVE '6'                    TO AT-TRAILER-TYPE
 18369     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 18370                                    AT-GEN-INFO-LAST-MAINT-DT
 18371     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 18372                                    AT-GEN-INFO-LAST-UPDATED-BY
 18373     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS
 18374     MOVE 'NO INTEREST DUE'      TO AT-INFO-LINE-1
 18375     .
 18376 7150-WRITE.
 18377
 18378* EXEC CICS HANDLE CONDITION
 18379*        DUPREC    (7160-DUPREC)
 18380*    END-EXEC
 18381*    MOVE '"$%                   ! : #00016826' TO DFHEIV0
 18382     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 18383     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18384     MOVE X'3A20233030303136383236' TO DFHEIV0(25:11)
 18385     CALL 'kxdfhei1' USING DFHEIV0
 18386     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18387
 18388* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 351
* EL156.cbl
 18389*         DATASET     ('ELTRLR')
 18390*         FROM        (ACTIVITY-TRAILERS)
 18391*         RIDFLD      (AT-CONTROL-PRIMARY)
 18392*         RESP        (WS-RESPONSE)
 18393*     END-EXEC
 18394     MOVE LENGTH OF
 18395      ACTIVITY-TRAILERS
 18396       TO DFHEIV11
 18397     MOVE 'ELTRLR' TO DFHEIV1
 18398*    MOVE '&$ L                  ''  N#00016829' TO DFHEIV0
 18399     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 18400     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18401     MOVE X'204E233030303136383239' TO DFHEIV0(25:11)
 18402     CALL 'kxdfhei1' USING DFHEIV0,
 18403           DFHEIV1,
 18404           ACTIVITY-TRAILERS,
 18405           DFHEIV11,
 18406           AT-CONTROL-PRIMARY,
 18407           DFHEIV99,
 18408           DFHEIV99
 18409     MOVE EIBRESP  TO WS-RESPONSE
 18410     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18411      IF WS-RESP-DUPREC
 18412         GO TO 7160-DUPREC
 18413      END-IF
 18414     GO TO 7170-EXIT
 18415     .
 18416 7160-DUPREC.
 18417     SUBTRACT +1                 FROM CL-TRAILER-SEQ-CNT
 18418     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO
 18419     GO TO 7150-WRITE
 18420     .
 18421 7170-EXIT.
 18422      EXIT.
 18423
 18424 7180-ADD-CERT-NOTE.
 18425*ADD CERT NOTE FOR SC NP+6
 18426
 18427
 18428* EXEC CICS GETMAIN
 18429*         SET       (ADDRESS OF CERT-NOTE-FILE)
 18430*         LENGTH    (150)
 18431*         INITIMG   (GETMAIN-SPACE)
 18432*     END-EXEC.
 18433     MOVE 150
 18434       TO DFHEIV11
 18435*    MOVE ',"IL                  $   #00016851' TO DFHEIV0
 18436     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 18437     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18438     MOVE X'2020233030303136383531' TO DFHEIV0(25:11)
 18439     CALL 'kxdfhei1' USING DFHEIV0,
 18440           DFHEIV20,
 18441           DFHEIV11,
 18442           GETMAIN-SPACE
 18443     SET ADDRESS OF CERT-NOTE-FILE TO
 18444         DFHEIV20
 18445     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18446
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 352
* EL156.cbl
 18447
 18448     MOVE SPACES                 TO WRK-CERT-NOTE-ADD.
 18449     MOVE SPACES                 TO WRK-ORIG-NOTE-ADD.
 18450     MOVE +1                     TO WRK-NOTE-SEQ.
 18451     MOVE LOW-VALUES             TO CERT-NOTE-FILE.
 18452     MOVE PI-COMPANY-CD          TO CZ-COMPANY-CD.
 18453     MOVE CL-CERT-CARRIER        TO CZ-CARRIER.
 18454     MOVE CL-CERT-GROUPING       TO CZ-GROUPING.
 18455     MOVE CL-CERT-STATE          TO CZ-STATE.
 18456     MOVE CL-CERT-ACCOUNT        TO CZ-ACCOUNT.
 18457     MOVE CL-CERT-EFF-DT         TO CZ-CERT-EFF-DT.
 18458     MOVE CL-CERT-NO             TO CZ-CERT-NO.
 18459     MOVE '2'                    TO CZ-RECORD-TYPE.
 18460     MOVE WRK-NOTE-SEQ           TO CZ-NOTE-SEQUENCE.
 18461     MOVE 'CZ'                   TO CZ-RECORD-ID.
 18462     MOVE WS-TODAY-DATE          TO CZ-LAST-MAINT-DT.
 18463     MOVE EIBTIME                TO CZ-LAST-MAINT-HHMMSS.
 18464     MOVE PI-PROCESSOR-ID        TO CZ-LAST-MAINT-USER.
 18465     MOVE PI-REM-BEN-AMT         TO SC-NP6-REM-BEN.
 18466     MOVE PI-MO-BEN-AMT          TO SC-NP6-6-MO.
 18467     MOVE ' + 6 MO '             TO SC-NP6-COMM
 18468     IF PI-COMPANY-ID = 'AHL'
 18469        IF PI-LF-BENEFIT-CD = '5I' OR '6J'
 18470           CONTINUE
 18471        ELSE
 18472           IF PI-LF-BENEFIT-CD = '5M' OR '6M'
 18473              MOVE ' + 1 MO '    TO SC-NP6-COMM
 18474           ELSE
 18475              MOVE ' + 2 MO '    TO SC-NP6-COMM
 18476           END-IF
 18477        END-IF
 18478     END-IF
 18479     MOVE PI-CPYAMT              TO SC-NP6-AMT-PAID.
 18480     MOVE SC-NP6-CERT-NOTE       TO CZ-NOTE.
 18481
 18482 7181-WRITE.
 18483
 18484
 18485* EXEC CICS WRITE
 18486*         DATASET     ('ERCNOT')
 18487*         FROM        (CERT-NOTE-FILE)
 18488*         RIDFLD      (CZ-CONTROL-PRIMARY)
 18489*         RESP        (WS-RESPONSE)
 18490*    END-EXEC.
 18491     MOVE LENGTH OF
 18492      CERT-NOTE-FILE
 18493       TO DFHEIV11
 18494     MOVE 'ERCNOT' TO DFHEIV1
 18495*    MOVE '&$ L                  ''  N#00016893' TO DFHEIV0
 18496     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 18497     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18498     MOVE X'204E233030303136383933' TO DFHEIV0(25:11)
 18499     CALL 'kxdfhei1' USING DFHEIV0,
 18500           DFHEIV1,
 18501           CERT-NOTE-FILE,
 18502           DFHEIV11,
 18503           CZ-CONTROL-PRIMARY,
 18504           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 353
* EL156.cbl
 18505           DFHEIV99
 18506     MOVE EIBRESP  TO WS-RESPONSE
 18507     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18508
 18509
 18510     IF WS-RESP-DUPREC
 18511         GO TO 7182-DUPREC
 18512     END-IF.
 18513
 18514     SET CERT-NOTE-ADDED TO TRUE.
 18515
 18516     IF PI-CPYAMT EQUAL PI-ORIG-BEN-AMT
 18517         PERFORM 7190-ADD-ORIG-NOTE THRU 7199-EXIT
 18518     END-IF.
 18519
 18520     GO TO 7189-EXIT.
 18521
 18522 7182-DUPREC.
 18523
 18524     ADD +1                      TO  WRK-NOTE-SEQ.
 18525     MOVE WRK-NOTE-SEQ           TO  CZ-NOTE-SEQUENCE.
 18526     GO TO 7181-WRITE.
 18527
 18528 7189-EXIT.
 18529      EXIT.
 18530
 18531 7190-ADD-ORIG-NOTE.
 18532
 18533
 18534* EXEC CICS GETMAIN
 18535*         SET       (ADDRESS OF CERT-NOTE-FILE)
 18536*         LENGTH    (150)
 18537*         INITIMG   (GETMAIN-SPACE)
 18538*     END-EXEC.
 18539     MOVE 150
 18540       TO DFHEIV11
 18541*    MOVE ',"IL                  $   #00016923' TO DFHEIV0
 18542     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 18543     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18544     MOVE X'2020233030303136393233' TO DFHEIV0(25:11)
 18545     CALL 'kxdfhei1' USING DFHEIV0,
 18546           DFHEIV20,
 18547           DFHEIV11,
 18548           GETMAIN-SPACE
 18549     SET ADDRESS OF CERT-NOTE-FILE TO
 18550         DFHEIV20
 18551     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18552
 18553
 18554     ADD +1                      TO WRK-NOTE-SEQ.
 18555     MOVE LOW-VALUES             TO CERT-NOTE-FILE.
 18556     MOVE PI-COMPANY-CD          TO CZ-COMPANY-CD.
 18557     MOVE CL-CERT-CARRIER        TO CZ-CARRIER.
 18558     MOVE CL-CERT-GROUPING       TO CZ-GROUPING.
 18559     MOVE CL-CERT-STATE          TO CZ-STATE.
 18560     MOVE CL-CERT-ACCOUNT        TO CZ-ACCOUNT.
 18561     MOVE CL-CERT-EFF-DT         TO CZ-CERT-EFF-DT.
 18562     MOVE CL-CERT-NO             TO CZ-CERT-NO.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 354
* EL156.cbl
 18563     MOVE '2'                    TO CZ-RECORD-TYPE.
 18564     MOVE WRK-NOTE-SEQ           TO CZ-NOTE-SEQUENCE.
 18565     MOVE 'CZ'                   TO CZ-RECORD-ID.
 18566     MOVE WS-TODAY-DATE          TO CZ-LAST-MAINT-DT.
 18567     MOVE EIBTIME                TO CZ-LAST-MAINT-HHMMSS.
 18568     MOVE PI-PROCESSOR-ID        TO CZ-LAST-MAINT-USER.
 18569     MOVE SC-NP6-ORIG-NOTE       TO CZ-NOTE.
 18570
 18571 7191-WRITE.
 18572
 18573
 18574* EXEC CICS WRITE
 18575*         DATASET     ('ERCNOT')
 18576*         FROM        (CERT-NOTE-FILE)
 18577*         RIDFLD      (CZ-CONTROL-PRIMARY)
 18578*         RESP        (WS-RESPONSE)
 18579*    END-EXEC.
 18580     MOVE LENGTH OF
 18581      CERT-NOTE-FILE
 18582       TO DFHEIV11
 18583     MOVE 'ERCNOT' TO DFHEIV1
 18584*    MOVE '&$ L                  ''  N#00016948' TO DFHEIV0
 18585     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 18586     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18587     MOVE X'204E233030303136393438' TO DFHEIV0(25:11)
 18588     CALL 'kxdfhei1' USING DFHEIV0,
 18589           DFHEIV1,
 18590           CERT-NOTE-FILE,
 18591           DFHEIV11,
 18592           CZ-CONTROL-PRIMARY,
 18593           DFHEIV99,
 18594           DFHEIV99
 18595     MOVE EIBRESP  TO WS-RESPONSE
 18596     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18597
 18598
 18599     IF WS-RESP-DUPREC
 18600         GO TO 7192-DUPREC
 18601     END-IF.
 18602
 18603     GO TO 7199-EXIT.
 18604
 18605 7192-DUPREC.
 18606
 18607     ADD +1                      TO  WRK-NOTE-SEQ.
 18608     MOVE WRK-NOTE-SEQ           TO  CZ-NOTE-SEQUENCE.
 18609     GO TO 7191-WRITE.
 18610
 18611 7199-EXIT.
 18612      EXIT.
 18613 7200-FIND-BENEFIT.
 18614     MOVE 'N' TO WS-BEN-SEARCH-SW.
 18615
 18616
 18617* EXEC CICS HANDLE CONDITION
 18618*        ENDFILE(7200-EXIT)
 18619*        NOTFND(7200-EXIT)
 18620*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 355
* EL156.cbl
 18621*    MOVE '"$''I                  ! ; #00016972' TO DFHEIV0
 18622     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 18623     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18624     MOVE X'3B20233030303136393732' TO DFHEIV0(25:11)
 18625     CALL 'kxdfhei1' USING DFHEIV0
 18626     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18627
 18628
 18629
 18630* EXEC CICS READ
 18631*        DATASET('ELCNTL')
 18632*        SET(ADDRESS OF CONTROL-FILE)
 18633*        RIDFLD(ELCNTL-KEY)
 18634*        GTEQ
 18635*    END-EXEC.
 18636     MOVE 'ELCNTL' TO DFHEIV1
 18637*    MOVE '&"S        G          (   #00016977' TO DFHEIV0
 18638     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 18639     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18640     MOVE X'2020233030303136393737' TO DFHEIV0(25:11)
 18641     CALL 'kxdfhei1' USING DFHEIV0,
 18642           DFHEIV1,
 18643           DFHEIV20,
 18644           DFHEIV99,
 18645           ELCNTL-KEY,
 18646           DFHEIV99,
 18647           DFHEIV99,
 18648           DFHEIV99
 18649     SET ADDRESS OF CONTROL-FILE TO
 18650         DFHEIV20
 18651     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18652
 18653
 18654     IF CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
 18655        CNTL-REC-TYPE NOT = CF-RECORD-TYPE
 18656           GO TO 7200-EXIT.
 18657
 18658     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 18659         VARYING SUB-1 FROM 1 BY 1 UNTIL
 18660            ((SUB-1 > 8) OR
 18661            (CF-BENEFIT-CODE (SUB-1) = WS-BEN-CD)).
 18662
 18663     IF SUB-1 NOT = 9
 18664         MOVE 'Y' TO WS-BEN-SEARCH-SW.
 18665
 18666     GO TO 7200-EXIT.
 18667
 18668 7200-BENEFIT-DUMMY.
 18669
 18670 7200-DUMMY-EXIT.
 18671     EXIT.
 18672
 18673 7200-EXIT.
 18674     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 356
* EL156.cbl
 18676*052506
 18677*052506 7250-FIND-LETTER-TRLR.
 18678*052506     EXEC CICS HANDLE CONDITION
 18679*052506         ENDFILE  (7250-END)
 18680*052506         NOTFND   (7250-END)
 18681*052506     END-EXEC.
 18682*052506
 18683*052506     EXEC CICS STARTBR
 18684*052506         DATASET   ('ELTRLR')
 18685*052506         RIDFLD    (ELTRLR-KEY)
 18686*052506         GTEQ
 18687*052506     END-EXEC.
 18688*052506
 18689*052506     MOVE LOW-VALUES TO WS-MAX-LETTER-ANSWER-DT.
 18690*052506
 18691*052506 7250-FIND-LOOP.
 18692*052506     EXEC CICS READNEXT
 18693*052506         DATASET   ('ELTRLR')
 18694*052506         RIDFLD    (ELTRLR-KEY)
 18695*052506         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 18696*052506     END-EXEC.
 18697*052506
 18698*052506     IF PI-COMPANY-CD NOT = TRLR-COMP-CD  OR
 18699*052506        PI-CARRIER    NOT = TRLR-CARRIER  OR
 18700*052506        PI-CLAIM-NO   NOT = TRLR-CLAIM-NO OR
 18701*052506        PI-CERT-NO    NOT = TRLR-CERT-NO
 18702*052506        GO TO 7250-END
 18703*052506     END-IF.
 18704*052506
 18705*052506     IF AT-TRAILER-TYPE NOT = '4'
 18706*052506         GO TO 7250-FIND-LOOP
 18707*052506     END-IF.
 18708*052506
 18709*052506     IF AT-LETTER-ANSWERED-DT GREATER THAN WS-MAX-LETTER-AN
 18710*052506         MOVE AT-LETTER-ANSWERED-DT TO WS-MAX-LETTER-ANSWER
 18711*052506     END-IF.
 18712*052506
 18713*052506     GO TO 7250-FIND-LOOP.
 18714*052506
 18715*052506 7250-END.
 18716*052506
 18717*052506     IF WS-MAX-LETTER-ANSWER-DT NOT = LOW-VALUES AND SPACES
 18718*051506         MOVE SPACES             TO  DC-OPTION-CODE
 18719*052506         MOVE WS-MAX-LETTER-ANSWER-DT TO  DC-BIN-DATE-1
 18720*052506         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18721*052506         MOVE DC-GREG-DATE-1-MDY  TO  PI-PROOF-DATE
 18722*052506         MOVE PI-PROOF-DATE  TO  PROOFDTO
 18723*052506         INSPECT PROOFDTI REPLACING ALL SPACES BY '/'
 18724*052506     END-IF.
 18725*052506
 18726*052506     EXEC CICS ENDBR
 18727*052506          DATASET    ('ELTRLR')
 18728*052506     END-EXEC.
 18729*052506
 18730*052506 7250-EXIT.
 18731*052506     EXIT.
 18732*052506     EJECT
 18733*052506
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 357
* EL156.cbl
 18734 7300-CHECK-AUTO-ACTIVITY.
 18735
 18736     IF PI-PMTTYPE = '1' OR '2' OR '3' OR '4'
 18737         NEXT SENTENCE
 18738     ELSE
 18739         GO TO 7399-EXIT.
 18740
 18741     PERFORM 7400-CHECK-AUTO-ACTIVITY THRU 7400-EXIT.
 18742
 18743     IF WS-ACT-REC-FOUND-SW = 'N'
 18744         GO TO 7399-EXIT.
 18745
 18746     IF PI-ACTIVITY-CODE = 09
 18747         GO TO 7300-CONT-AUTO-ACTIVITY.
 18748
 18749     IF (PI-COMPANY-ID = 'AIG' OR 'AUK') AND
 18750        (PI-ACTIVITY-CODE = 11)
 18751         GO TO 7300-CONT-AUTO-ACTIVITY.
 18752
 18753     IF PI-PROVISIONAL-IND = 'P'
 18754         IF PI-PMTTYPE = '1'
 18755             IF CF-SYS-ACTIVE-SW (9) = ' ' OR 'N'
 18756                 MOVE 'N'    TO  PI-RESET-SW
 18757                 GO TO 7399-EXIT.
 18758
 18759     IF PI-PMTTYPE = '1'
 18760         IF CF-SYS-ACTIVE-SW (2) = ' ' OR 'N'
 18761             MOVE 'N'        TO  PI-RESET-SW
 18762             GO TO 7399-EXIT.
 18763
 18764     IF PI-PMTTYPE = '2' OR '3'
 18765         IF CF-SYS-ACTIVE-SW (3) = ' ' OR 'N'
 18766             MOVE 'N'        TO  PI-RESET-SW
 18767             GO TO 7399-EXIT.
 18768
 18769     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 18770         IF PI-PROVISIONAL-IND = 'P'
 18771             NEXT SENTENCE
 18772         ELSE
 18773             PERFORM 7500-RESET-AUTO-ACTIVITY THRU 7599-EXIT.
 18774
 18775 7300-CONT-AUTO-ACTIVITY.
 18776
 18777     IF PI-PFKEY-USED = DFHPF3 OR DFHPF4
 18778         MOVE PI-EPYTHRU     TO DC-GREG-DATE-1-MDY
 18779         MOVE '4'            TO DC-OPTION-CODE
 18780         MOVE +0             TO DC-ELAPSED-DAYS
 18781                                DC-ELAPSED-MONTHS
 18782         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18783         MOVE DC-BIN-DATE-1  TO WS-CHK-THRU-DT
 18784         IF PI-USES-PAID-TO
 18785             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18786             IF NO-CONVERSION-ERROR
 18787                 MOVE +1     TO DC-ELAPSED-DAYS
 18788                 MOVE +0     TO DC-ELAPSED-MONTHS
 18789                 MOVE '6'    TO DC-OPTION-CODE
 18790                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18791                 IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 358
* EL156.cbl
 18792                     MOVE DC-BIN-DATE-2   TO WS-CHK-THRU-DT.
 18793
 18794     IF PI-PFKEY-USED = DFHPF5
 18795         MOVE PI-CPYTHRU TO WS-CHK-THRU-DT
 18796         IF PI-USES-PAID-TO
 18797             MOVE PI-CPYTHRU          TO DC-BIN-DATE-1
 18798             MOVE +1                  TO DC-ELAPSED-DAYS
 18799             MOVE +0                  TO DC-ELAPSED-MONTHS
 18800             MOVE '6'                 TO DC-OPTION-CODE
 18801             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18802             IF NO-CONVERSION-ERROR
 18803                 MOVE DC-BIN-DATE-2   TO WS-CHK-THRU-DT.
 18804
 18805     IF WS-CHK-THRU-DT < PI-EXP-DT
 18806         NEXT SENTENCE
 18807     ELSE
 18808         MOVE 03                     TO  WS-ACTIVITY-CODE
 18809         GO TO 7390-PROCESS-ACTIVITY.
 18810
 18811     IF PI-PROV-PMT
 18812         MOVE 09                     TO  WS-ACTIVITY-CODE
 18813     ELSE
 18814        IF PI-PMTTYPE = '1'
 18815            MOVE 02                  TO  WS-ACTIVITY-CODE
 18816        ELSE
 18817        IF PI-PMTTYPE = '2' OR '3'
 18818            MOVE 07                  TO  WS-ACTIVITY-CODE
 18819        ELSE
 18820        IF PI-PMTTYPE = '4'
 18821            MOVE 00                  TO  WS-ACTIVITY-CODE
 18822        ELSE
 18823            MOVE 'N'                 TO  PI-RESET-SW
 18824            GO TO 7399-EXIT.
 18825
 18826 7390-PROCESS-ACTIVITY.
 18827
 18828     PERFORM 7450-FORMAT-AUTO-LETTER THRU 7450-EXIT.
 18829
 18830 7399-EXIT.
 18831     EXIT.
 18832
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 359
* EL156.cbl
 18834 7400-CHECK-AUTO-ACTIVITY.
 18835
 18836
 18837* EXEC CICS HANDLE CONDITION
 18838*        NOTFND   (7400-NOT-FOUND)
 18839*    END-EXEC.
 18840*    MOVE '"$I                   ! < #00017166' TO DFHEIV0
 18841     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18842     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18843     MOVE X'3C20233030303137313636' TO DFHEIV0(25:11)
 18844     CALL 'kxdfhei1' USING DFHEIV0
 18845     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18846
 18847
 18848     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
 18849     MOVE 'T'                    TO  CNTL-REC-TYPE.
 18850     MOVE SPACES                 TO  CNTL-ACCESS.
 18851     MOVE +0                     TO  CNTL-SEQ-NO.
 18852
 18853
 18854* EXEC CICS READ
 18855*        DATASET   ('ELCNTL')
 18856*        RIDFLD    (ELCNTL-KEY)
 18857*        SET       (ADDRESS OF CONTROL-FILE)
 18858*    END-EXEC.
 18859     MOVE 'ELCNTL' TO DFHEIV1
 18860*    MOVE '&"S        E          (   #00017175' TO DFHEIV0
 18861     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18862     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18863     MOVE X'2020233030303137313735' TO DFHEIV0(25:11)
 18864     CALL 'kxdfhei1' USING DFHEIV0,
 18865           DFHEIV1,
 18866           DFHEIV20,
 18867           DFHEIV99,
 18868           ELCNTL-KEY,
 18869           DFHEIV99,
 18870           DFHEIV99,
 18871           DFHEIV99
 18872     SET ADDRESS OF CONTROL-FILE TO
 18873         DFHEIV20
 18874     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18875
 18876
 18877     MOVE 'Y'                        TO  WS-ACT-REC-FOUND-SW.
 18878     GO TO 7400-EXIT.
 18879
 18880 7400-NOT-FOUND.
 18881     MOVE 'N'                        TO  PI-RESET-SW
 18882                                         WS-LETTER-SW
 18883                                         WS-ACT-REC-FOUND-SW.
 18884
 18885     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18886
 18887 7400-EXIT.
 18888     EXIT.
 18889
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 360
* EL156.cbl
 18891 7450-FORMAT-AUTO-LETTER.
 18892
 18893     IF PI-ACTIVITY-CODE = ZEROS OR LOW-VALUES OR SPACES
 18894         MOVE 'Y'                    TO PI-RESET-SW
 18895         GO TO 7450-CONTINUE-PROCESS.
 18896
 18897     MOVE PI-ACTIVITY-CODE           TO  SUB.
 18898
 18899     IF SUB > 9
 18900         SUBTRACT 9 FROM SUB
 18901         MOVE CF-USER-RESET-SW (SUB)  TO PI-RESET-SW
 18902     ELSE
 18903         MOVE CF-SYS-RESET-SW (SUB)   TO PI-RESET-SW.
 18904
 18905 7450-CONTINUE-PROCESS.
 18906
 18907     IF WS-ACTIVITY-CODE = ZEROS
 18908         MOVE 'N'                    TO  WS-LETTER-SW
 18909         GO TO 7450-EXIT.
 18910
 18911     MOVE WS-ACTIVITY-CODE           TO  SUB.
 18912
 18913     IF CF-SYS-ACTIVE-SW (SUB) = ' ' OR 'N'
 18914         MOVE 'N'                    TO  PI-RESET-SW
 18915                                         WS-LETTER-SW
 18916         GO TO 7450-EXIT.
 18917
 18918     IF CF-SYS-LETTER-ID (SUB) = SPACES OR LOW-VALUES
 18919         MOVE 'N'                    TO  WS-LETTER-SW
 18920         GO TO 7450-EXIT.
 18921
 18922     MOVE 'Y'                        TO  WS-LETTER-SW.
 18923     MOVE LOW-VALUES                 TO  W-1523-LINKDATA.
 18924     MOVE PROGRAM-INTERFACE-BLOCK    TO  W-1523-COMMON-PI-DATA.
 18925
 18926     MOVE CF-SYS-LETTER-ID  (SUB)    TO W-1523-FORM-NUMBER.
 18927
 18928     IF CF-SYS-RESEND-DAYS (SUB) NOT = ZEROS
 18929         MOVE SAVE-BIN-DATE          TO  DC-BIN-DATE-1
 18930         MOVE '6'                    TO  DC-OPTION-CODE
 18931         MOVE CF-SYS-RESEND-DAYS (SUB)   TO  DC-ELAPSED-DAYS
 18932         MOVE +0                     TO  DC-ELAPSED-MONTHS
 18933         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18934         IF NO-CONVERSION-ERROR
 18935             MOVE DC-BIN-DATE-2      TO  W-1523-RESEND-DATE
 18936         ELSE
 18937              MOVE LOW-VALUES        TO  W-1523-RESEND-DATE.
 18938
 18939     IF CF-SYS-FOLLOW-UP-DAYS (SUB) NOT = ZEROS
 18940         MOVE SAVE-BIN-DATE          TO  DC-BIN-DATE-1
 18941         MOVE '6'                    TO  DC-OPTION-CODE
 18942         MOVE CF-SYS-FOLLOW-UP-DAYS (SUB) TO DC-ELAPSED-DAYS
 18943         MOVE +0                     TO  DC-ELAPSED-MONTHS
 18944         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18945         IF NO-CONVERSION-ERROR
 18946             MOVE DC-BIN-DATE-2      TO  W-1523-FOLLOW-UP-DATE
 18947         ELSE
 18948             MOVE LOW-VALUES         TO  W-1523-FOLLOW-UP-DATE.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 361
* EL156.cbl
 18949
 18950 7450-EXIT.
 18951     EXIT.
 18952
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 362
* EL156.cbl
 18954 7500-RESET-AUTO-ACTIVITY.
 18955
 18956     MOVE PI-COMPANY-CD          TO  TRLR-COMP-CD.
 18957     MOVE PI-CARRIER             TO  TRLR-CARRIER.
 18958     MOVE PI-CLAIM-NO            TO  TRLR-CLAIM-NO.
 18959     MOVE PI-CERT-NO             TO  TRLR-CERT-NO.
 18960     MOVE +100                   TO  TRLR-SEQ-NO.
 18961
 18962 7500-STARTBR-TRLR.
 18963
 18964
 18965* EXEC CICS HANDLE CONDITION
 18966*        ENDFILE  (7590-END)
 18967*        NOTFND   (7590-END)
 18968*    END-EXEC.
 18969*    MOVE '"$''I                  ! = #00017268' TO DFHEIV0
 18970     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 18971     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18972     MOVE X'3D20233030303137323638' TO DFHEIV0(25:11)
 18973     CALL 'kxdfhei1' USING DFHEIV0
 18974     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18975
 18976
 18977
 18978* EXEC CICS STARTBR
 18979*        DATASET   ('ELTRLR')
 18980*        RIDFLD    (ELTRLR-KEY)
 18981*        GTEQ
 18982*    END-EXEC.
 18983     MOVE 'ELTRLR' TO DFHEIV1
 18984     MOVE 0
 18985       TO DFHEIV11
 18986*    MOVE '&,         G          &   #00017273' TO DFHEIV0
 18987     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18988     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18989     MOVE X'2020233030303137323733' TO DFHEIV0(25:11)
 18990     CALL 'kxdfhei1' USING DFHEIV0,
 18991           DFHEIV1,
 18992           ELTRLR-KEY,
 18993           DFHEIV99,
 18994           DFHEIV11,
 18995           DFHEIV99
 18996     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18997
 18998
 18999     MOVE 'Y'                        TO  WS-BROWSE-SW.
 19000
 19001 7500-READ-NEXT.
 19002
 19003
 19004* EXEC CICS READNEXT
 19005*        DATASET   ('ELTRLR')
 19006*        RIDFLD    (ELTRLR-KEY)
 19007*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 19008*    END-EXEC.
 19009     MOVE 'ELTRLR' TO DFHEIV1
 19010     MOVE 0
 19011       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 363
* EL156.cbl
 19012*    MOVE '&.S                   )   #00017283' TO DFHEIV0
 19013     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19014     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19015     MOVE X'2020233030303137323833' TO DFHEIV0(25:11)
 19016     CALL 'kxdfhei1' USING DFHEIV0,
 19017           DFHEIV1,
 19018           DFHEIV20,
 19019           DFHEIV99,
 19020           ELTRLR-KEY,
 19021           DFHEIV99,
 19022           DFHEIV11,
 19023           DFHEIV99,
 19024           DFHEIV99
 19025     SET ADDRESS OF ACTIVITY-TRAILERS TO
 19026         DFHEIV20
 19027     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19028
 19029
 19030     IF PI-COMPANY-CD NOT = TRLR-COMP-CD  OR
 19031        PI-CARRIER    NOT = TRLR-CARRIER  OR
 19032        PI-CLAIM-NO   NOT = TRLR-CLAIM-NO OR
 19033        PI-CERT-NO    NOT = TRLR-CERT-NO
 19034         GO TO 7590-END.
 19035
 19036     IF ELTRLR-KEY = PI-PREV-TRLR-KEY
 19037         GO TO 7500-READ-NEXT.
 19038
 19039     IF AT-TRAILER-TYPE NOT = '4'
 19040         GO TO 7500-READ-NEXT.
 19041
 19042     IF AT-LETTER-ANSWERED-DT NOT = LOW-VALUES AND SPACES
 19043         GO TO 7500-READ-NEXT.
 19044
 19045     IF (AT-AUTO-RE-SEND-DT   = LOW-VALUES OR SPACES) AND
 19046        (AT-RECEIPT-FOLLOW-UP = LOW-VALUES OR SPACES)
 19047         GO TO 7500-READ-NEXT.
 19048
 19049     IF AT-RECEIPT-FOLLOW-UP < SAVE-BIN-DATE AND
 19050        AT-AUTO-RE-SEND-DT   < SAVE-BIN-DATE AND
 19051        AT-RESEND-PRINT-DATE < SAVE-BIN-DATE
 19052         GO TO 7500-READ-NEXT.
 19053
 19054     IF (AT-AUTO-RE-SEND-DT NOT = LOW-VALUES AND SPACES)
 19055                         AND
 19056        (AT-RESEND-PRINT-DATE NOT = LOW-VALUES AND SPACES)
 19057                         AND
 19058        (AT-RECEIPT-FOLLOW-UP = LOW-VALUES)
 19059            GO TO 7500-READ-NEXT.
 19060
 19061     MOVE ELTRLR-KEY                 TO  PI-PREV-TRLR-KEY.
 19062
 19063
 19064* EXEC CICS ENDBR
 19065*        DATASET   ('ELTRLR')
 19066*    END-EXEC.
 19067     MOVE 'ELTRLR' TO DFHEIV1
 19068     MOVE 0
 19069       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 364
* EL156.cbl
 19070*    MOVE '&2                    $   #00017322' TO DFHEIV0
 19071     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19072     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19073     MOVE X'2020233030303137333232' TO DFHEIV0(25:11)
 19074     CALL 'kxdfhei1' USING DFHEIV0,
 19075           DFHEIV1,
 19076           DFHEIV11,
 19077           DFHEIV99
 19078     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19079
 19080
 19081     MOVE 'N'                        TO  WS-BROWSE-SW.
 19082
 19083
 19084* EXEC CICS READ
 19085*        DATASET   ('ELTRLR')
 19086*        RIDFLD    (ELTRLR-KEY)
 19087*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 19088*        UPDATE
 19089*    END-EXEC.
 19090     MOVE 'ELTRLR' TO DFHEIV1
 19091*    MOVE '&"S        EU         (   #00017328' TO DFHEIV0
 19092     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19093     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19094     MOVE X'2020233030303137333238' TO DFHEIV0(25:11)
 19095     CALL 'kxdfhei1' USING DFHEIV0,
 19096           DFHEIV1,
 19097           DFHEIV20,
 19098           DFHEIV99,
 19099           ELTRLR-KEY,
 19100           DFHEIV99,
 19101           DFHEIV99,
 19102           DFHEIV99
 19103     SET ADDRESS OF ACTIVITY-TRAILERS TO
 19104         DFHEIV20
 19105     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19106
 19107
 19108     MOVE 'Y'                        TO  WS-UPDATE-SW.
 19109
 19110     IF AT-AUTO-RE-SEND-DT NOT < SAVE-BIN-DATE
 19111         MOVE LOW-VALUES             TO  AT-AUTO-RE-SEND-DT
 19112     ELSE
 19113         IF AT-RECEIPT-FOLLOW-UP NOT < SAVE-BIN-DATE
 19114             NEXT SENTENCE
 19115         ELSE
 19116             GO TO 7500-REWRITE-TRLR.
 19117
 19118     MOVE LOW-VALUES                 TO  AT-RECEIPT-FOLLOW-UP.
 19119
 19120     MOVE PI-COMPANY-CD              TO  ARCH-CO.
 19121     MOVE AT-LETTER-ARCHIVE-NO       TO  ARCH-NUMBER.
 19122     MOVE '1'                        TO  ARCH-REC-TYPE.
 19123     MOVE +0                         TO  ARCH-SEQ.
 19124
 19125     PERFORM 7600-READ-ARCH-UPDATE THRU 7699-EXIT.
 19126
 19127 7500-REWRITE-TRLR.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 365
* EL156.cbl
 19128
 19129
 19130* EXEC CICS REWRITE
 19131*        DATASET   ('ELTRLR')
 19132*        FROM      (ACTIVITY-TRAILERS)
 19133*    END-EXEC.
 19134     MOVE LENGTH OF
 19135      ACTIVITY-TRAILERS
 19136       TO DFHEIV11
 19137     MOVE 'ELTRLR' TO DFHEIV1
 19138*    MOVE '&& L                  %   #00017356' TO DFHEIV0
 19139     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19140     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19141     MOVE X'2020233030303137333536' TO DFHEIV0(25:11)
 19142     CALL 'kxdfhei1' USING DFHEIV0,
 19143           DFHEIV1,
 19144           ACTIVITY-TRAILERS,
 19145           DFHEIV11,
 19146           DFHEIV99
 19147     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19148
 19149
 19150     GO TO 7500-STARTBR-TRLR.
 19151
 19152 7590-END.
 19153
 19154     IF WS-BROWSE-SW = 'Y'
 19155         MOVE 'N'                    TO  WS-BROWSE-SW
 19156
 19157* EXEC CICS ENDBR
 19158*            DATASET   ('ELTRLR')
 19159*        END-EXEC.
 19160     MOVE 'ELTRLR' TO DFHEIV1
 19161     MOVE 0
 19162       TO DFHEIV11
 19163*    MOVE '&2                    $   #00017367' TO DFHEIV0
 19164     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19165     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19166     MOVE X'2020233030303137333637' TO DFHEIV0(25:11)
 19167     CALL 'kxdfhei1' USING DFHEIV0,
 19168           DFHEIV1,
 19169           DFHEIV11,
 19170           DFHEIV99
 19171     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19172
 19173
 19174 7599-EXIT.
 19175     EXIT.
 19176
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 366
* EL156.cbl
 19178 7600-READ-ARCH-UPDATE.
 19179
 19180
 19181* EXEC CICS HANDLE CONDITION
 19182*        NOTFND   (7699-EXIT)
 19183*    END-EXEC.
 19184*    MOVE '"$I                   ! > #00017377' TO DFHEIV0
 19185     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19186     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19187     MOVE X'3E20233030303137333737' TO DFHEIV0(25:11)
 19188     CALL 'kxdfhei1' USING DFHEIV0
 19189     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19190
 19191
 19192
 19193* EXEC CICS READ
 19194*        DATASET   ('ELARCH')
 19195*        RIDFLD    (ELARCH-KEY)
 19196*        SET       (ADDRESS OF LETTER-ARCHIVE)
 19197*        UPDATE
 19198*    END-EXEC.
 19199     MOVE 'ELARCH' TO DFHEIV1
 19200*    MOVE '&"S        EU         (   #00017381' TO DFHEIV0
 19201     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19202     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19203     MOVE X'2020233030303137333831' TO DFHEIV0(25:11)
 19204     CALL 'kxdfhei1' USING DFHEIV0,
 19205           DFHEIV1,
 19206           DFHEIV20,
 19207           DFHEIV99,
 19208           ELARCH-KEY,
 19209           DFHEIV99,
 19210           DFHEIV99,
 19211           DFHEIV99
 19212     SET ADDRESS OF LETTER-ARCHIVE TO
 19213         DFHEIV20
 19214     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19215
 19216
 19217     MOVE LOW-VALUES                 TO  LA-RESEND-DATE.
 19218
 19219
 19220* EXEC CICS REWRITE
 19221*        DATASET   ('ELARCH')
 19222*        FROM      (LETTER-ARCHIVE)
 19223*    END-EXEC.
 19224     MOVE LENGTH OF
 19225      LETTER-ARCHIVE
 19226       TO DFHEIV11
 19227     MOVE 'ELARCH' TO DFHEIV1
 19228*    MOVE '&& L                  %   #00017390' TO DFHEIV0
 19229     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19230     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19231     MOVE X'2020233030303137333930' TO DFHEIV0(25:11)
 19232     CALL 'kxdfhei1' USING DFHEIV0,
 19233           DFHEIV1,
 19234           LETTER-ARCHIVE,
 19235           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 367
* EL156.cbl
 19236           DFHEIV99
 19237     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19238
 19239
 19240 7699-EXIT.
 19241     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 368
* EL156.cbl
 19243 7700-GET-DCT.
 19244
 19245     MOVE PI-SV-CERT-KEY         TO W-NOTE-CERT-KEY.
 19246     MOVE PI-COMPANY-CD          TO W-NOTE-COMP-CD.
 19247     MOVE PI-SV-CERT-NO          TO W-NOTE-CERT-NO.
 19248     MOVE ZEROS                  TO PI-INTEREST-PAID-IND
 19249                                    PI-MAX-BENEFIT-AMT
 19250                                    PI-MAX-BENEFIT-PYMT
 19251                                    PI-MIN-PAYMENT-AMT
 19252                                    PI-TIME-OF-LOSS-BAL.
 19253
 19254
 19255* EXEC CICS HANDLE CONDITION
 19256*         NOTFND (5300-NOTE-NOT-FOUND)
 19257*     END-EXEC.
 19258*    MOVE '"$I                   ! ? #00017409' TO DFHEIV0
 19259     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19260     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19261     MOVE X'3F20233030303137343039' TO DFHEIV0(25:11)
 19262     CALL 'kxdfhei1' USING DFHEIV0
 19263     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19264
 19265
 19266
 19267* EXEC CICS READ
 19268*         DATASET('ERNOTE')
 19269*         SET    (ADDRESS OF CERTIFICATE-NOTE)
 19270*         RIDFLD (W-NOTE-KEY)
 19271*     END-EXEC.
 19272     MOVE 'ERNOTE' TO DFHEIV1
 19273*    MOVE '&"S        E          (   #00017413' TO DFHEIV0
 19274     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19275     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19276     MOVE X'2020233030303137343133' TO DFHEIV0(25:11)
 19277     CALL 'kxdfhei1' USING DFHEIV0,
 19278           DFHEIV1,
 19279           DFHEIV20,
 19280           DFHEIV99,
 19281           W-NOTE-KEY,
 19282           DFHEIV99,
 19283           DFHEIV99,
 19284           DFHEIV99
 19285     SET ADDRESS OF CERTIFICATE-NOTE TO
 19286         DFHEIV20
 19287     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19288
 19289
 19290     MOVE CN-CSI-CC-INTEREST-PAID TO PI-INTEREST-PAID-IND.
 19291     MOVE CN-CSI-CC-MAX-BEN-LIMIT TO PI-MAX-BENEFIT-AMT.
 19292     MOVE CN-CSI-CC-MAX-BENEFITS  TO PI-MAX-BENEFIT-PYMT.
 19293     MOVE CN-CSI-CC-MIN-PAY-AMT   TO PI-MIN-PAYMENT-AMT.
 19294     MOVE CN-CSI-CC-TOL-BALANCE   TO PI-TIME-OF-LOSS-BAL.
 19295
 19296     IF PI-PAYEE-TYPE NOT = 'B'
 19297         GO TO 7700-EXIT.
 19298
 19299     MOVE SPACES                 TO DCT-COMMUNICATION-AREA.
 19300     MOVE PI-SV-BEN              TO DCT-LOGIC-BENEFICIARY-ID.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 369
* EL156.cbl
 19301     MOVE PI-SV-CCN              TO DCT-CREDIT-CARD-NUMBER.
 19302
 19303     IF PI-SV-CERT-KEY (6:2) = ZERO OR SPACES
 19304         MOVE 'CC'                 TO DCT-PRODUCT-CODE
 19305     ELSE
 19306         MOVE PI-SV-CERT-KEY (6:2) TO DCT-PRODUCT-CODE.
 19307
 19308     MOVE CN-CSI-CC-BILL-BANK-ID TO DCT-BILLING-BANK-ID.
 19309     MOVE '01'                   TO DCT-COLUMN-ID-REQUESTED.
 19310     MOVE 'DLO006'               TO PGM-NAME.
 19311
 19312
 19313* EXEC CICS LINK
 19314*        PROGRAM    (PGM-NAME)
 19315*        COMMAREA   (DCT-COMMUNICATION-AREA)
 19316*        LENGTH     (DCT-RCRD-LENGTH)
 19317*    END-EXEC.
 19318*    MOVE '."C                   (   #00017441' TO DFHEIV0
 19319     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19320     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19321     MOVE X'2020233030303137343431' TO DFHEIV0(25:11)
 19322     CALL 'kxdfhei1' USING DFHEIV0,
 19323           PGM-NAME,
 19324           DCT-COMMUNICATION-AREA,
 19325           DCT-RCRD-LENGTH,
 19326           DFHEIV99,
 19327           DFHEIV99,
 19328           DFHEIV99,
 19329           DFHEIV99
 19330     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19331
 19332
 19333     IF DCT-RETURN-CODE = 'OK'
 19334         GO TO 7700-CONT.
 19335
 19336     IF DCT-RETURN-CODE = '01' OR '02'
 19337         GO TO 7700-SET-TO-YES.
 19338
 19339     IF DCT-RETURN-CODE = '03'
 19340
 19341* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19342*    MOVE '6"R                   !   #00017454' TO DFHEIV0
 19343     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19344     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19345     MOVE X'2020233030303137343534' TO DFHEIV0(25:11)
 19346     CALL 'kxdfhei1' USING DFHEIV0
 19347     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19348         MOVE ER-0951            TO EMI-ERROR
 19349         MOVE -1                 TO PMTTYPEL
 19350         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19351         GO TO 8200-SEND-DATAONLY.
 19352
 19353     IF DCT-RETURN-CODE = '04'
 19354
 19355* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19356*    MOVE '6"R                   !   #00017461' TO DFHEIV0
 19357     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19358     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 370
* EL156.cbl
 19359     MOVE X'2020233030303137343631' TO DFHEIV0(25:11)
 19360     CALL 'kxdfhei1' USING DFHEIV0
 19361     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19362         MOVE ER-0946            TO EMI-ERROR
 19363         MOVE -1                 TO PMTTYPEL
 19364         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19365         GO TO 8200-SEND-DATAONLY.
 19366
 19367     IF DCT-RETURN-CODE = '05'
 19368
 19369* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19370*    MOVE '6"R                   !   #00017468' TO DFHEIV0
 19371     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19372     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19373     MOVE X'2020233030303137343638' TO DFHEIV0(25:11)
 19374     CALL 'kxdfhei1' USING DFHEIV0
 19375     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19376         MOVE ER-0947            TO EMI-ERROR
 19377         MOVE -1                 TO PMTTYPEL
 19378         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19379         GO TO 8200-SEND-DATAONLY.
 19380
 19381     IF DCT-RETURN-CODE = '06'
 19382
 19383* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19384*    MOVE '6"R                   !   #00017475' TO DFHEIV0
 19385     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19386     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19387     MOVE X'2020233030303137343735' TO DFHEIV0(25:11)
 19388     CALL 'kxdfhei1' USING DFHEIV0
 19389     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19390         MOVE ER-0921            TO EMI-ERROR
 19391         MOVE -1                 TO PMTTYPEL
 19392         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19393         GO TO 8200-SEND-DATAONLY.
 19394
 19395     IF DCT-RETURN-CODE = '07'
 19396
 19397* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19398*    MOVE '6"R                   !   #00017482' TO DFHEIV0
 19399     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19400     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19401     MOVE X'2020233030303137343832' TO DFHEIV0(25:11)
 19402     CALL 'kxdfhei1' USING DFHEIV0
 19403     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19404         MOVE ER-0919            TO EMI-ERROR
 19405         MOVE -1                 TO PMTTYPEL
 19406         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19407         GO TO 8200-SEND-DATAONLY.
 19408
 19409     IF DCT-RETURN-CODE = '08'
 19410
 19411* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19412*    MOVE '6"R                   !   #00017489' TO DFHEIV0
 19413     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19414     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19415     MOVE X'2020233030303137343839' TO DFHEIV0(25:11)
 19416     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 371
* EL156.cbl
 19417     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19418         MOVE ER-0948            TO EMI-ERROR
 19419         MOVE -1                 TO PMTTYPEL
 19420         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19421         GO TO 8200-SEND-DATAONLY.
 19422
 19423     IF DCT-RETURN-CODE = 'N1'
 19424
 19425* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19426*    MOVE '6"R                   !   #00017496' TO DFHEIV0
 19427     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19428     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19429     MOVE X'2020233030303137343936' TO DFHEIV0(25:11)
 19430     CALL 'kxdfhei1' USING DFHEIV0
 19431     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19432         MOVE ER-0950            TO EMI-ERROR
 19433         MOVE -1                 TO PMTTYPEL
 19434         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19435         GO TO 8200-SEND-DATAONLY.
 19436
 19437     IF DCT-RETURN-CODE = 'E1'
 19438
 19439* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19440*    MOVE '6"R                   !   #00017503' TO DFHEIV0
 19441     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19442     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19443     MOVE X'2020233030303137353033' TO DFHEIV0(25:11)
 19444     CALL 'kxdfhei1' USING DFHEIV0
 19445     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19446         MOVE ER-0974            TO EMI-ERROR
 19447         MOVE -1                 TO PMTTYPEL
 19448         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19449         GO TO 8200-SEND-DATAONLY.
 19450
 19451     IF DCT-RETURN-CODE = 'E2'
 19452
 19453* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19454*    MOVE '6"R                   !   #00017510' TO DFHEIV0
 19455     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19456     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19457     MOVE X'2020233030303137353130' TO DFHEIV0(25:11)
 19458     CALL 'kxdfhei1' USING DFHEIV0
 19459     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19460         MOVE ER-0975            TO EMI-ERROR
 19461         MOVE -1                 TO PMTTYPEL
 19462         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19463         GO TO 8200-SEND-DATAONLY.
 19464
 19465     IF DCT-RETURN-CODE NOT = 'OK'
 19466
 19467* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19468*    MOVE '6"R                   !   #00017517' TO DFHEIV0
 19469     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19470     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19471     MOVE X'2020233030303137353137' TO DFHEIV0(25:11)
 19472     CALL 'kxdfhei1' USING DFHEIV0
 19473     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19474         MOVE ER-0949            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 372
* EL156.cbl
 19475         MOVE -1                 TO PMTTYPEL
 19476         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19477         GO TO 8200-SEND-DATAONLY.
 19478
 19479 7700-CONT.
 19480
 19481*    MOVE 'N'                    TO CASHO.
 19482*    MOVE +1                     TO CASHL.
 19483*    MOVE AL-UANON               TO CASHA.
 19484
 19485     IF PI-OFFLINE = 'Y'
 19486         GO TO 7700-EXIT.
 19487
 19488     MOVE DCT-DISTRIBUTION-CODE  TO W-DMD-CHECK-NO-1.
 19489     MOVE CL-CERT-NO (4:1)       TO W-DMD-CHECK-NO-2.
 19490     MOVE 'TP'                   TO W-DMD-CHECK-NO-3.
 19491     MOVE W-DMD-CHECK-NO         TO CHECKNOO.
 19492     MOVE +7                     TO CHECKNOL.
 19493     MOVE AL-UANON               TO CHECKNOA.
 19494     GO TO 7700-EXIT.
 19495
 19496 7700-SET-TO-YES.
 19497
 19498*    MOVE 'Y'                    TO CASHO.
 19499*    MOVE +1                     TO CASHL.
 19500*    MOVE AL-UANON               TO CASHA.
 19501
 19502 7700-EXIT.
 19503     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 373
* EL156.cbl
 19505 7800-READ-COMP-MSTR.
 19506
 19507
 19508* EXEC CICS HANDLE CONDITION
 19509*        NOTFND   (7800-COMP-NOTFND)
 19510*    END-EXEC.
 19511*    MOVE '"$I                   ! @ #00017551' TO DFHEIV0
 19512     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19513     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19514     MOVE X'4020233030303137353531' TO DFHEIV0(25:11)
 19515     CALL 'kxdfhei1' USING DFHEIV0
 19516     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19517
 19518
 19519
 19520* EXEC CICS READ
 19521*        DATASET   ('ERCOMP')
 19522*        RIDFLD    (ERCOMP-KEY)
 19523*        SET       (ADDRESS OF COMPENSATION-MASTER)
 19524*    END-EXEC.
 19525     MOVE 'ERCOMP' TO DFHEIV1
 19526*    MOVE '&"S        E          (   #00017555' TO DFHEIV0
 19527     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19528     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19529     MOVE X'2020233030303137353535' TO DFHEIV0(25:11)
 19530     CALL 'kxdfhei1' USING DFHEIV0,
 19531           DFHEIV1,
 19532           DFHEIV20,
 19533           DFHEIV99,
 19534           ERCOMP-KEY,
 19535           DFHEIV99,
 19536           DFHEIV99,
 19537           DFHEIV99
 19538     SET ADDRESS OF COMPENSATION-MASTER TO
 19539         DFHEIV20
 19540     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19541
 19542
 19543     MOVE 'Y'                    TO  WS-COMP-MSTR-SW.
 19544     GO TO 7800-COMP-EXIT.
 19545
 19546 7800-COMP-NOTFND.
 19547     MOVE 'N'                    TO  WS-COMP-MSTR-SW.
 19548
 19549 7800-COMP-EXIT.
 19550     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 374
* EL156.cbl
 19552 7900-READ-CLAIM.
 19553
 19554* EXEC CICS READ
 19555*        DATASET  ('ELMSTR')
 19556*        SET      (ADDRESS OF CLAIM-MASTER)
 19557*        RIDFLD   (ELMSTR-KEY)
 19558*    END-EXEC.
 19559     MOVE 'ELMSTR' TO DFHEIV1
 19560*    MOVE '&"S        E          (   #00017571' TO DFHEIV0
 19561     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19562     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19563     MOVE X'2020233030303137353731' TO DFHEIV0(25:11)
 19564     CALL 'kxdfhei1' USING DFHEIV0,
 19565           DFHEIV1,
 19566           DFHEIV20,
 19567           DFHEIV99,
 19568           ELMSTR-KEY,
 19569           DFHEIV99,
 19570           DFHEIV99,
 19571           DFHEIV99
 19572     SET ADDRESS OF CLAIM-MASTER TO
 19573         DFHEIV20
 19574     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19575
 19576
 19577 7900-EXIT.
 19578      EXIT.
 19579
 19580 7910-READ-CLAIM-UPDATE.
 19581
 19582* EXEC CICS READ
 19583*        DATASET  ('ELMSTR')
 19584*        SET      (ADDRESS OF CLAIM-MASTER)
 19585*        RIDFLD   (ELMSTR-KEY)
 19586*        UPDATE
 19587*    END-EXEC.
 19588     MOVE 'ELMSTR' TO DFHEIV1
 19589*    MOVE '&"S        EU         (   #00017581' TO DFHEIV0
 19590     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19591     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19592     MOVE X'2020233030303137353831' TO DFHEIV0(25:11)
 19593     CALL 'kxdfhei1' USING DFHEIV0,
 19594           DFHEIV1,
 19595           DFHEIV20,
 19596           DFHEIV99,
 19597           ELMSTR-KEY,
 19598           DFHEIV99,
 19599           DFHEIV99,
 19600           DFHEIV99
 19601     SET ADDRESS OF CLAIM-MASTER TO
 19602         DFHEIV20
 19603     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19604
 19605
 19606 7910-EXIT.
 19607      EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 375
* EL156.cbl
 19609 7920-READ-BENE.
 19610     MOVE PI-COMPANY-CD      TO BENE-COMP-CD.
 19611     MOVE 'B'                TO BENE-RECORD-TYPE.
 19612     MOVE CL-BENEFICIARY     TO BENE-NUMBER.
 19613
 19614     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 19615        IF PI-PAYEE-TYPE    = 'B' AND
 19616           PI-PAYEE-SEQ-NUM = 9
 19617             MOVE CL-CURRENT-GROUPING TO WS-AIG-GROUPING
 19618             MOVE WS-A-BENE           TO BENE-NUMBER.
 19619
 19620
 19621* EXEC CICS HANDLE CONDITION
 19622*        NOTFND   (7920-NOT-FOUND)
 19623*    END-EXEC.
 19624*    MOVE '"$I                   ! A #00017602' TO DFHEIV0
 19625     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19626     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19627     MOVE X'4120233030303137363032' TO DFHEIV0(25:11)
 19628     CALL 'kxdfhei1' USING DFHEIV0
 19629     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19630
 19631
 19632
 19633* EXEC CICS READ
 19634*        DATASET  ('ELBENE')
 19635*        SET      (ADDRESS OF BENEFICIARY-MASTER)
 19636*        RIDFLD   (ELBENE-KEY)
 19637*    END-EXEC.
 19638     MOVE 'ELBENE' TO DFHEIV1
 19639*    MOVE '&"S        E          (   #00017606' TO DFHEIV0
 19640     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19641     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19642     MOVE X'2020233030303137363036' TO DFHEIV0(25:11)
 19643     CALL 'kxdfhei1' USING DFHEIV0,
 19644           DFHEIV1,
 19645           DFHEIV20,
 19646           DFHEIV99,
 19647           ELBENE-KEY,
 19648           DFHEIV99,
 19649           DFHEIV99,
 19650           DFHEIV99
 19651     SET ADDRESS OF BENEFICIARY-MASTER TO
 19652         DFHEIV20
 19653     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19654
 19655
 19656     MOVE 'Y' TO BENE-FOUND-SW.
 19657     GO TO 7920-EXIT.
 19658
 19659 7920-NOT-FOUND.
 19660     MOVE 'N'                    TO BENE-FOUND-SW.
 19661
 19662 7920-EXIT.
 19663      EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 376
* EL156.cbl
 19665 7930-READ-CONTROL.
 19666
 19667* EXEC CICS READ
 19668*        DATASET  ('ELCNTL')
 19669*        SET      (ADDRESS OF CONTROL-FILE)
 19670*        RIDFLD   (ELCNTL-KEY)
 19671*    END-EXEC.
 19672     MOVE 'ELCNTL' TO DFHEIV1
 19673*    MOVE '&"S        E          (   #00017622' TO DFHEIV0
 19674     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19675     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19676     MOVE X'2020233030303137363232' TO DFHEIV0(25:11)
 19677     CALL 'kxdfhei1' USING DFHEIV0,
 19678           DFHEIV1,
 19679           DFHEIV20,
 19680           DFHEIV99,
 19681           ELCNTL-KEY,
 19682           DFHEIV99,
 19683           DFHEIV99,
 19684           DFHEIV99
 19685     SET ADDRESS OF CONTROL-FILE TO
 19686         DFHEIV20
 19687     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19688
 19689
 19690 7930-EXIT.
 19691      EXIT.
 19692
 19693 7940-READ-CONTROL-UPDATE.
 19694
 19695* EXEC CICS READ
 19696*        DATASET  ('ELCNTL')
 19697*        SET      (ADDRESS OF CONTROL-FILE)
 19698*        RIDFLD   (ELCNTL-KEY)
 19699*        UPDATE
 19700*    END-EXEC.
 19701     MOVE 'ELCNTL' TO DFHEIV1
 19702*    MOVE '&"S        EU         (   #00017632' TO DFHEIV0
 19703     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19704     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19705     MOVE X'2020233030303137363332' TO DFHEIV0(25:11)
 19706     CALL 'kxdfhei1' USING DFHEIV0,
 19707           DFHEIV1,
 19708           DFHEIV20,
 19709           DFHEIV99,
 19710           ELCNTL-KEY,
 19711           DFHEIV99,
 19712           DFHEIV99,
 19713           DFHEIV99
 19714     SET ADDRESS OF CONTROL-FILE TO
 19715         DFHEIV20
 19716     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19717
 19718
 19719 7940-EXIT.
 19720      EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 377
* EL156.cbl
 19722 7950-READ-TRAILER.
 19723
 19724* EXEC CICS READ
 19725*        DATASET  ('ELTRLR')
 19726*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 19727*        RIDFLD   (ELTRLR-KEY)
 19728*    END-EXEC.
 19729     MOVE 'ELTRLR' TO DFHEIV1
 19730*    MOVE '&"S        E          (   #00017643' TO DFHEIV0
 19731     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19732     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19733     MOVE X'2020233030303137363433' TO DFHEIV0(25:11)
 19734     CALL 'kxdfhei1' USING DFHEIV0,
 19735           DFHEIV1,
 19736           DFHEIV20,
 19737           DFHEIV99,
 19738           ELTRLR-KEY,
 19739           DFHEIV99,
 19740           DFHEIV99,
 19741           DFHEIV99
 19742     SET ADDRESS OF ACTIVITY-TRAILERS TO
 19743         DFHEIV20
 19744     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19745
 19746
 19747 7950-EXIT.
 19748      EXIT.
 19749
 19750 7960-READ-TRAILER-UPDATE.
 19751
 19752* EXEC CICS READ
 19753*        DATASET  ('ELTRLR')
 19754*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 19755*        RIDFLD   (ELTRLR-KEY)
 19756*        UPDATE
 19757*    END-EXEC.
 19758     MOVE 'ELTRLR' TO DFHEIV1
 19759*    MOVE '&"S        EU         (   #00017653' TO DFHEIV0
 19760     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19761     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19762     MOVE X'2020233030303137363533' TO DFHEIV0(25:11)
 19763     CALL 'kxdfhei1' USING DFHEIV0,
 19764           DFHEIV1,
 19765           DFHEIV20,
 19766           DFHEIV99,
 19767           ELTRLR-KEY,
 19768           DFHEIV99,
 19769           DFHEIV99,
 19770           DFHEIV99
 19771     SET ADDRESS OF ACTIVITY-TRAILERS TO
 19772         DFHEIV20
 19773     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19774
 19775
 19776 7960-EXIT.
 19777      EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 378
* EL156.cbl
 19779 7970-READ-CERT.
 19780
 19781* EXEC CICS READ
 19782*        DATASET  ('ELCERT')
 19783*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 19784*        RIDFLD   (ELCERT-KEY)
 19785*    END-EXEC.
 19786     MOVE 'ELCERT' TO DFHEIV1
 19787*    MOVE '&"S        E          (   #00017664' TO DFHEIV0
 19788     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19789     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19790     MOVE X'2020233030303137363634' TO DFHEIV0(25:11)
 19791     CALL 'kxdfhei1' USING DFHEIV0,
 19792           DFHEIV1,
 19793           DFHEIV20,
 19794           DFHEIV99,
 19795           ELCERT-KEY,
 19796           DFHEIV99,
 19797           DFHEIV99,
 19798           DFHEIV99
 19799     SET ADDRESS OF CERTIFICATE-MASTER TO
 19800         DFHEIV20
 19801     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19802
 19803
 19804 7970-EXIT.
 19805      EXIT.
 19806 7975-read-acct.
 19807
 19808     move spaces              to WS-ACCT-RECORD-SW
 19809                                 pi-dcc-product-code
 19810
 19811     MOVE PI-COMPANY-CD       TO ACCT-COMP-CD
 19812     MOVE PI-CARRIER          TO ACCT-CARRIER
 19813     MOVE PI-GROUPING         TO ACCT-GROUPING
 19814     MOVE PI-STATE            TO ACCT-STATE
 19815     MOVE PI-ACCOUNT          TO ACCT-ACCOUNT
 19816     MOVE PI-CERT-EFF-DT      TO ACCT-EXP-DT
 19817     MOVE ERACCT-PARTIAL-KEY  TO WS-ERACCT-SAVE-KEY
 19818     MOVE SPACES              TO WS-ERACCT-HOLD-RECORD
 19819
 19820
 19821* EXEC CICS READ
 19822*       DATASET ('ERACCT')
 19823*       RIDFLD  (ERACCT-KEY)
 19824*       SET     (ADDRESS OF ACCOUNT-MASTER)
 19825*       GTEQ
 19826*       resp    (WS-RESPONSE)
 19827*    END-EXEC
 19828     MOVE 'ERACCT' TO DFHEIV1
 19829*    MOVE '&"S        G          (  N#00017686' TO DFHEIV0
 19830     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 19831     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19832     MOVE X'204E233030303137363836' TO DFHEIV0(25:11)
 19833     CALL 'kxdfhei1' USING DFHEIV0,
 19834           DFHEIV1,
 19835           DFHEIV20,
 19836           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 379
* EL156.cbl
 19837           ERACCT-KEY,
 19838           DFHEIV99,
 19839           DFHEIV99,
 19840           DFHEIV99
 19841     SET ADDRESS OF ACCOUNT-MASTER TO
 19842         DFHEIV20
 19843     MOVE EIBRESP  TO WS-RESPONSE
 19844     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19845     IF WS-RESP-NORMAL
 19846        AND WS-ERACCT-SAVE-KEY = AM-CONTROL-PRIMARY (1:20)
 19847        and pi-cert-eff-dt < am-expiration-dt
 19848        and pi-cert-eff-dt >= am-effective-dt
 19849        move am-dcc-product-code to pi-dcc-product-code
 19850        set acct-found to true
 19851     end-if
 19852
 19853     .
 19854 7975-exit.
 19855     exit.
 19856 7980-READ-CERT-UPDATE.
 19857
 19858* EXEC CICS READ
 19859*        DATASET  ('ELCERT')
 19860*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 19861*        RIDFLD   (ELCERT-KEY)
 19862*        UPDATE
 19863*    END-EXEC.
 19864     MOVE 'ELCERT' TO DFHEIV1
 19865*    MOVE '&"S        EU         (   #00017705' TO DFHEIV0
 19866     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19867     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19868     MOVE X'2020233030303137373035' TO DFHEIV0(25:11)
 19869     CALL 'kxdfhei1' USING DFHEIV0,
 19870           DFHEIV1,
 19871           DFHEIV20,
 19872           DFHEIV99,
 19873           ELCERT-KEY,
 19874           DFHEIV99,
 19875           DFHEIV99,
 19876           DFHEIV99
 19877     SET ADDRESS OF CERTIFICATE-MASTER TO
 19878         DFHEIV20
 19879     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19880
 19881
 19882 7980-EXIT.
 19883      EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 380
* EL156.cbl
 19885 8000-LOAD-ERROR-MESSAGES.
 19886     IF PI-PASS-SW = 'C'
 19887        MOVE EMI-LINE1           TO ERMSG1BO
 19888     ELSE
 19889        MOVE EMI-LINE1           TO ERRMSG1O
 19890        MOVE EMI-LINE2           TO ERRMSG2O.
 19891
 19892 8000-EXIT.
 19893     EXIT.
 19894
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 381
* EL156.cbl
 19896
 19897 8010-DMD-ERROR-CHECKS.
 19898     PERFORM 7700-GET-DCT THRU 7700-EXIT.
 19899
 19900     IF CN-CSI-CC-ISSUE-DT = SPACES OR LOW-VALUES OR ZEROS
 19901         GO TO 8051-ISSUE-ERROR.
 19902
 19903     MOVE CN-CSI-CC-ISSUE-DT     TO SAVE-DATE-CCYYMMDD.
 19904     MOVE SAVE-DATE-YMD          TO DC-GREG-DATE-1-YMD.
 19905     MOVE '3'                    TO DC-OPTION-CODE.
 19906     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 19907     IF DC-BIN-DATE-1 > CL-INCURRED-DT
 19908         GO TO 8051-ISSUE-ERROR.
 19909
 19910     IF CL-CERT-NO (4:1) = 'U' OR 'F'
 19911       IF (CL-SOC-SEC-NO = SPACES OR LOW-VALUES OR ZEROS)
 19912                           OR
 19913          (CL-SSN-STATE   = CL-CERT-STATE  AND
 19914           CL-SSN-ACCOUNT = CL-CERT-ACCOUNT-PRIME)
 19915             MOVE ER-0851         TO EMI-ERROR
 19916             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19917       END-IF
 19918       IF CN-CSI-CC-PREMIUM-AMT = ZERO
 19919             MOVE ER-8147         TO EMI-ERROR
 19920             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19921
 19922     GO TO 8090-EXIT.
 19923
 19924 8051-ISSUE-ERROR.
 19925     MOVE ER-8146            TO EMI-ERROR.
 19926     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19927     GO TO 8090-EXIT.
 19928
 19929 8090-EXIT.
 19930      EXIT.
 19931
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 382
* EL156.cbl
 19933 8100-SEND-INITIAL-MAP.
 19934
 19935     MOVE SAVE-DATE              TO RUNDTEAO.
 19936     MOVE EIBTIME                TO TIME-IN.
 19937     MOVE TIME-OUT               TO RUNTIMAO.
 19938     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 19939
 19940     IF MAP-NAME = 'EL156A'
 19941        IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP'
 19942           MOVE 'PF6=EOB CODES'  TO PF6TITO
 19943        END-IF
 19944        IF PI-COMPANY-ID = 'DCC' or 'VPP'
 19945           MOVE 'N'     TO SURVYYNO
 19946        END-IF
 19947     END-IF
 19948*    IF MAP-NAME = 'EL156A'
 19949*       IF PI-COMPANY-ID = 'CRI'
 19950*          NEXT SENTENCE
 19951*       ELSE
 19952*          MOVE AL-SADOF TO  GROUPHA  GROUPEDA.
 19953
 19954     IF MAP-NAME = 'EL156A'
 19955        IF PI-COMPANY-ID = 'BOA' OR 'CID' OR 'AHL'
 19956           NEXT SENTENCE
 19957        ELSE
 19958           MOVE AL-SADOF TO  PINTA    PINTHA.
 19959
 19960     IF MAP-NAME = 'EL156A'
 19961        IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 19962            NEXT SENTENCE
 19963        ELSE
 19964           MOVE AL-SADOF TO    DUEDAYHA DUEDAYA.
 19965
 19966*    IF MAP-NAME = 'EL156A'
 19967*       IF PI-COMPANY-ID = 'AIG' OR 'AUK' OR 'DMD'
 19968*          NEXT SENTENCE
 19969*       ELSE
 19970*          MOVE AL-SADOF TO CASHHA CASHA.
 19971
 19972     IF MAP-NAME = 'EL156A'
 19973        IF PI-COMPANY-ID = 'CVL' OR 'CID' OR 'DCC' OR 'AHL'
 19974                        or 'VPP'
 19975           NEXT SENTENCE
 19976        ELSE
 19977           MOVE AL-SADOF        TO  LOANHA
 19978                                    LOANNOA.
 19979
 19980     IF MAP-NAME = 'EL156A'
 19981        MOVE -1                 TO  ENTERPFL
 19982        IF PI-USES-PAID-TO
 19983           MOVE 'PAID TO DATE :' TO PTHRHDGO
 19984           MOVE '  PAY TO  '    TO  HDGA-VRBLE
 19985           MOVE PMT-HEAD-A      TO  PMTHDGAO
 19986        ELSE
 19987           NEXT SENTENCE
 19988     ELSE
 19989        IF MAP-NAME = 'EL156B'
 19990           IF PI-USES-PAID-TO
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 383
* EL156.cbl
 19991              MOVE ' PAYS TO    ' TO HDGB-VRBLE
 19992              MOVE PMT-HEAD-B     TO PMTHDGBO.
 19993
 19994
 19995* EXEC CICS SEND
 19996*        MAP   (MAP-NAME)
 19997*        MAPSET(MAPSET-NAME)
 19998*        FROM  (EL156AI)
 19999*        ERASE
 20000*        CURSOR
 20001*    END-EXEC.
 20002     MOVE LENGTH OF
 20003      EL156AI
 20004       TO DFHEIV12
 20005     MOVE -1
 20006       TO DFHEIV11
 20007*    MOVE '8$     CT  E    H L F ,   #00017824' TO DFHEIV0
 20008     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 20009     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 20010     MOVE X'2020233030303137383234' TO DFHEIV0(25:11)
 20011     CALL 'kxdfhei1' USING DFHEIV0,
 20012           MAP-NAME,
 20013           EL156AI,
 20014           DFHEIV12,
 20015           MAPSET-NAME,
 20016           DFHEIV99,
 20017           DFHEIV99,
 20018           DFHEIV99,
 20019           DFHEIV11,
 20020           DFHEIV99,
 20021           DFHEIV99,
 20022           DFHEIV99
 20023     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20024
 20025
 20026     GO TO 9100-RETURN-TRAN.
 20027
 20028 8200-SEND-DATAONLY.
 20029
 20030     IF FIRST-ENTRY = 'Y'
 20031         GO TO 8100-SEND-INITIAL-MAP.
 20032
 20033     IF RETURNED-FROM-B = 'Y'
 20034         GO TO 8100-SEND-INITIAL-MAP.
 20035
 20036     MOVE SAVE-DATE              TO RUNDTEAO.
 20037     MOVE EIBTIME                TO TIME-IN.
 20038     MOVE TIME-OUT               TO RUNTIMAO.
 20039
 20040     IF EIBAID = DFHPF11
 20041        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 20042        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20043        MOVE 'EL001   '          TO RETURNED-FROM
 20044        PERFORM 3050-REBUILD-ENTERED THRU 3059-EXIT
 20045        PERFORM 7010-BUILD-MAP THRU 7020-BYPASS-BENEFIT
 20046        GO TO 8100-SEND-INITIAL-MAP.
 20047
 20048     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 384
* EL156.cbl
 20049
 20050     IF MAP-NAME =  'EL156A'
 20051        MOVE -1                 TO  ENTERPFL
 20052        IF PI-USES-PAID-TO
 20053           MOVE 'PAID TO DATE :' TO PTHRHDGO
 20054           MOVE '  PAY TO  '    TO  HDGA-VRBLE
 20055           MOVE PMT-HEAD-A      TO  PMTHDGAO
 20056        ELSE
 20057           NEXT SENTENCE
 20058     ELSE
 20059        IF MAP-NAME = 'EL156B'
 20060           IF PI-USES-PAID-TO
 20061              MOVE ' PAYS TO    ' TO HDGB-VRBLE
 20062              MOVE PMT-HEAD-B     TO PMTHDGBO.
 20063
 20064     IF MAP-NAME =  'EL156A'
 20065        IF PI-COMPANY-ID = 'BOA'
 20066            IF PI-INT-RATE NUMERIC
 20067                MOVE PI-INT-RATE TO PINTO.
 20068     IF MAP-NAME = 'EL156A'
 20069        IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP'
 20070           MOVE 'PF6=EOB CODES'  TO PF6TITO
 20071*          MOVE 'Y'              TO EOBYNO
 20072        END-IF
 20073     END-IF
 20074
 20075
 20076* EXEC CICS SEND
 20077*        MAP   (MAP-NAME)
 20078*        MAPSET(MAPSET-NAME)
 20079*        FROM  (EL156AI)
 20080*        DATAONLY
 20081*        CURSOR
 20082*    END-EXEC.
 20083     MOVE LENGTH OF
 20084      EL156AI
 20085       TO DFHEIV12
 20086     MOVE -1
 20087       TO DFHEIV11
 20088*    MOVE '8$D    CT       H L F ,   #00017881' TO DFHEIV0
 20089     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 20090     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 20091     MOVE X'2020233030303137383831' TO DFHEIV0(25:11)
 20092     CALL 'kxdfhei1' USING DFHEIV0,
 20093           MAP-NAME,
 20094           EL156AI,
 20095           DFHEIV12,
 20096           MAPSET-NAME,
 20097           DFHEIV99,
 20098           DFHEIV99,
 20099           DFHEIV99,
 20100           DFHEIV11,
 20101           DFHEIV99,
 20102           DFHEIV99,
 20103           DFHEIV99
 20104     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20105
 20106
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 385
* EL156.cbl
 20107     GO TO 9100-RETURN-TRAN.
 20108
 20109 8300-SEND-TEXT.
 20110
 20111* EXEC CICS SEND TEXT
 20112*        FROM(LOGOFF-TEXT)
 20113*        LENGTH(LOGOFF-LENGTH)
 20114*        ERASE
 20115*        FREEKB
 20116*    END-EXEC.
 20117*    MOVE '8&      T  E F  H   F -   #00017892' TO DFHEIV0
 20118     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 20119     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 20120     MOVE X'2020233030303137383932' TO DFHEIV0(25:11)
 20121     CALL 'kxdfhei1' USING DFHEIV0,
 20122           LOGOFF-TEXT,
 20123           LOGOFF-LENGTH,
 20124           DFHEIV99,
 20125           DFHEIV99,
 20126           DFHEIV99,
 20127           DFHEIV99,
 20128           DFHEIV99,
 20129           DFHEIV99,
 20130           DFHEIV99,
 20131           DFHEIV99,
 20132           DFHEIV99,
 20133           DFHEIV99
 20134     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20135
 20136
 20137
 20138* EXEC CICS RETURN
 20139*    END-EXEC.
 20140*    MOVE '.(                    ''   #00017899' TO DFHEIV0
 20141     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 20142     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20143     MOVE X'2020233030303137383939' TO DFHEIV0(25:11)
 20144     CALL 'kxdfhei1' USING DFHEIV0,
 20145           DFHEIV99,
 20146           DFHEIV99,
 20147           DFHEIV99,
 20148           DFHEIV99,
 20149           DFHEIV99,
 20150           DFHEIV99
 20151     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20152
 20153
 20154 8500-FILE-NOTOPEN.
 20155     IF FILE-SWITCH = 'MSTR'
 20156         MOVE ER-0154            TO EMI-ERROR.
 20157     IF FILE-SWITCH = 'TRLR'
 20158         MOVE ER-0172            TO EMI-ERROR.
 20159     IF FILE-SWITCH = 'CERT'
 20160         MOVE ER-0169            TO EMI-ERROR.
 20161     IF FILE-SWITCH = 'CNTL' OR 'CARR' OR 'BENE' OR
 20162                      'PROC' OR 'STAT'
 20163         MOVE ER-0042            TO EMI-ERROR.
 20164     IF FILE-SWITCH = 'ACTQ'
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 386
* EL156.cbl
 20165         MOVE ER-0338            TO EMI-ERROR.
 20166     IF FILE-SWITCH = 'ACCT'
 20167         MOVE ER-0168            TO EMI-ERROR.
 20168
 20169     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20170     MOVE -1                     TO PMTTYPEL.
 20171
 20172     IF FIRST-ENTRY = 'Y'
 20173         GO TO 8100-SEND-INITIAL-MAP.
 20174
 20175     GO TO 8200-SEND-DATAONLY.
 20176
 20177 8600-PGRM-NOT-FOUND.
 20178
 20179     MOVE ER-0923                TO EMI-ERROR.
 20180     MOVE -1                     TO ENTPFBL.
 20181     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20182
 20183     IF FIRST-ENTRY = 'Y'
 20184         GO TO 8100-SEND-INITIAL-MAP
 20185     ELSE
 20186         GO TO 8200-SEND-DATAONLY.
 20187
 20188 8800-UNAUTHORIZED-ACCESS.
 20189     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 20190     GO TO 8300-SEND-TEXT.
 20191
 20192 8810-PF23.
 20193     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 20194     MOVE XCTL-005               TO PGM-NAME.
 20195     GO TO 9300-XCTL.
 20196
 20197 8820-PF7-8.
 20198     MOVE XCTL-126               TO PI-CALLING-PROGRAM.
 20199     MOVE SPACES                 TO PI-SAVED-PROGRAM-1
 20200                                    PI-SAVED-PROGRAM-2
 20201                                    PI-SAVED-PROGRAM-3
 20202                                    PI-SAVED-PROGRAM-4
 20203                                    PI-SAVED-PROGRAM-5
 20204                                    PI-SAVED-PROGRAM-6
 20205                                    PI-RETURN-TO-PROGRAM.
 20206     IF EIBAID = DFHPF8
 20207        MOVE XCTL-132            TO PGM-NAME
 20208     ELSE
 20209        MOVE XCTL-130            TO PGM-NAME.
 20210
 20211     GO TO 9300-XCTL.
 20212
 20213 9100-RETURN-TRAN.
 20214     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 20215     MOVE '156A'                 TO PI-CURRENT-SCREEN-NO.
 20216
 20217
 20218* EXEC CICS RETURN
 20219*        TRANSID(TRANS-ID)
 20220*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
 20221*        LENGTH(PI-COMM-LENGTH)
 20222*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 387
* EL156.cbl
 20223*    MOVE '.(CT                  ''   #00017965' TO DFHEIV0
 20224     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 20225     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20226     MOVE X'2020233030303137393635' TO DFHEIV0(25:11)
 20227     CALL 'kxdfhei1' USING DFHEIV0,
 20228           TRANS-ID,
 20229           PROGRAM-INTERFACE-BLOCK,
 20230           PI-COMM-LENGTH,
 20231           DFHEIV99,
 20232           DFHEIV99,
 20233           DFHEIV99
 20234     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20235
 20236
 20237 9200-RETURN-MAIN-MENU.
 20238     MOVE XCTL-126               TO PGM-NAME.
 20239     GO TO 9300-XCTL.
 20240
 20241 9300-XCTL.
 20242
 20243* EXEC CICS XCTL
 20244*        PROGRAM(PGM-NAME)
 20245*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
 20246*        LENGTH(PI-COMM-LENGTH)
 20247*    END-EXEC.
 20248*    MOVE '.$C                   %   #00017976' TO DFHEIV0
 20249     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 20250     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20251     MOVE X'2020233030303137393736' TO DFHEIV0(25:11)
 20252     CALL 'kxdfhei1' USING DFHEIV0,
 20253           PGM-NAME,
 20254           PROGRAM-INTERFACE-BLOCK,
 20255           PI-COMM-LENGTH,
 20256           DFHEIV99
 20257     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20258
 20259
 20260 9400-CLEAR.
 20261     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
 20262     GO TO 9300-XCTL.
 20263
 20264 9500-PF12.
 20265     MOVE XCTL-010               TO PGM-NAME.
 20266     GO TO 9300-XCTL.
 20267
 20268 9700-LINK-DATE-CONVERT.
 20269     MOVE LINK-ELDATCV           TO PGM-NAME.
 20270
 20271* EXEC CICS LINK
 20272*        PROGRAM   (PGM-NAME)
 20273*        COMMAREA  (DATE-CONVERSION-DATA)
 20274*        LENGTH    (DC-COMM-LENGTH)
 20275*    END-EXEC.
 20276*    MOVE '."C                   (   #00017992' TO DFHEIV0
 20277     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20278     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20279     MOVE X'2020233030303137393932' TO DFHEIV0(25:11)
 20280     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 388
* EL156.cbl
 20281           PGM-NAME,
 20282           DATE-CONVERSION-DATA,
 20283           DC-COMM-LENGTH,
 20284           DFHEIV99,
 20285           DFHEIV99,
 20286           DFHEIV99,
 20287           DFHEIV99
 20288     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20289
 20290
 20291 9700-EXIT.
 20292     EXIT.
 20293
 20294 9800-LINK-REM-TERM.
 20295     MOVE LINK-REMTERM TO PGM-NAME.
 20296
 20297
 20298* EXEC CICS LINK
 20299*        PROGRAM   (PGM-NAME)
 20300*        COMMAREA  (CALCULATION-PASS-AREA)
 20301*        LENGTH    (CP-COMM-LENGTH)
 20302*    END-EXEC.
 20303*    MOVE '."C                   (   #00018004' TO DFHEIV0
 20304     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20305     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20306     MOVE X'2020233030303138303034' TO DFHEIV0(25:11)
 20307     CALL 'kxdfhei1' USING DFHEIV0,
 20308           PGM-NAME,
 20309           CALCULATION-PASS-AREA,
 20310           CP-COMM-LENGTH,
 20311           DFHEIV99,
 20312           DFHEIV99,
 20313           DFHEIV99,
 20314           DFHEIV99
 20315     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20316
 20317
 20318 9800-EXIT.
 20319     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 389
* EL156.cbl
 20321 9830-DMD-REMAINING-TERM.
 20322
 20323     DIVIDE CL-NO-OF-DAYS-PAID BY +30
 20324         GIVING W-PAID-MONTHS REMAINDER W-PAID-DAYS.
 20325
 20326     COMPUTE W-TERM-IN-DAYS = CM-AH-ORIG-TERM * 30 +
 20327                              CM-PMT-EXTENSION-DAYS.
 20328
 20329     COMPUTE W-REM-TERM-IN-DAYS = W-TERM-IN-DAYS -
 20330                                  CL-NO-OF-DAYS-PAID.
 20331
 20332     DIVIDE W-REM-TERM-IN-DAYS BY +30
 20333         GIVING W-REM REMAINDER W-REM-DAYS.
 20334
 20335     MOVE W-REM                  TO WST-REM.
 20336
 20337     IF W-REM-DAYS > ZEROS
 20338         MOVE '/'                TO WST-SLASH
 20339         MOVE W-REM-DAYS         TO WST-REM-DAYS
 20340     ELSE
 20341         MOVE SPACES             TO WST-REM-DAYS-GRP.
 20342
 20343 9830-EXIT.
 20344     EXIT.
 20345
 20346 9870-OUTPUT-ACTIVITY-RECORD.
 20347
 20348
 20349* EXEC CICS GETMAIN
 20350*         SET(ADDRESS OF DAILY-ACTIVITY-RECORD)
 20351*         LENGTH(25)
 20352*         INITIMG(WS-BLANK)
 20353*    END-EXEC.
 20354     MOVE 25
 20355       TO DFHEIV11
 20356*    MOVE ',"IL                  $   #00018040' TO DFHEIV0
 20357     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 20358     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20359     MOVE X'2020233030303138303430' TO DFHEIV0(25:11)
 20360     CALL 'kxdfhei1' USING DFHEIV0,
 20361           DFHEIV20,
 20362           DFHEIV11,
 20363           WS-BLANK
 20364     SET ADDRESS OF DAILY-ACTIVITY-RECORD TO
 20365         DFHEIV20
 20366     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20367
 20368
 20369     MOVE SPACES                 TO DAILY-ACTIVITY-RECORD.
 20370     MOVE ELMSTR-KEY             TO DA-KEY.
 20371     MOVE CL-TRAILER-SEQ-CNT     TO DA-TRAILER-SEQ-NO.
 20372
 20373     IF PI-PMTTYPE EQUAL '7'
 20374         MOVE 'V'                TO DA-RECORD-TYPE
 20375     ELSE
 20376         MOVE 'P'                TO DA-RECORD-TYPE.
 20377
 20378
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 390
* EL156.cbl
 20379* EXEC CICS HANDLE CONDITION
 20380*         NOTOPEN(9870-NOTOPEN)
 20381*         DUPREC(9870-EXIT)
 20382*    END-EXEC.
 20383*    MOVE '"$J%                  ! B #00018055' TO DFHEIV0
 20384     MOVE X'22244A252020202020202020' TO DFHEIV0(1:12)
 20385     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20386     MOVE X'4220233030303138303535' TO DFHEIV0(25:11)
 20387     CALL 'kxdfhei1' USING DFHEIV0
 20388     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20389
 20390
 20391
 20392* EXEC CICS WRITE
 20393*         DATASET('DLYACTV')
 20394*         RIDFLD(DA-KEY)
 20395*         FROM(DAILY-ACTIVITY-RECORD)
 20396*         LENGTH(25)
 20397*    END-EXEC.
 20398     MOVE 'DLYACTV' TO DFHEIV1
 20399     MOVE 25
 20400       TO DFHEIV11
 20401*    MOVE '&$ L                  ''   #00018060' TO DFHEIV0
 20402     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20403     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20404     MOVE X'2020233030303138303630' TO DFHEIV0(25:11)
 20405     CALL 'kxdfhei1' USING DFHEIV0,
 20406           DFHEIV1,
 20407           DAILY-ACTIVITY-RECORD,
 20408           DFHEIV11,
 20409           DA-KEY,
 20410           DFHEIV99,
 20411           DFHEIV99
 20412     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20413
 20414     MOVE 'N'                    TO ERROR-ON-OUTPUT-SW.
 20415     GO TO 9870-EXIT.
 20416
 20417 9870-NOTOPEN.
 20418
 20419     MOVE '2955'                 TO EMI-ERROR.
 20420     MOVE 'Y'                    TO ERROR-ON-OUTPUT-SW.
 20421
 20422 9870-EXIT.
 20423     EXIT.
 20424
 20425 9900-ERROR-FORMAT.
 20426
 20427     IF EMI-ERROR = ER-0923
 20428         MOVE PGM-NAME           TO W-CALLED-NAME.
 20429
 20430     MOVE LINK-001      TO PGM-NAME.
 20431     MOVE PI-COMPANY-ID TO EMI-CLIENT-ID.
 20432
 20433
 20434* EXEC CICS LINK
 20435*        PROGRAM (PGM-NAME)
 20436*        COMMAREA(ERROR-MESSAGE-INTERFACE-BLOCK)
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 391
* EL156.cbl
 20437*        LENGTH  (EMI-COMM-LENGTH)
 20438*    END-EXEC.
 20439*    MOVE '."C                   (   #00018085' TO DFHEIV0
 20440     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20441     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20442     MOVE X'2020233030303138303835' TO DFHEIV0(25:11)
 20443     CALL 'kxdfhei1' USING DFHEIV0,
 20444           PGM-NAME,
 20445           ERROR-MESSAGE-INTERFACE-BLOCK,
 20446           EMI-COMM-LENGTH,
 20447           DFHEIV99,
 20448           DFHEIV99,
 20449           DFHEIV99,
 20450           DFHEIV99
 20451     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20452
 20453
 20454     IF EMI-ERROR = ER-0923
 20455         MOVE W-CALLED-NAME      TO EMI-TEXT-VARIABLE (1).
 20456
 20457 9900-EXIT.
 20458     EXIT.
 20459
 20460 9990-ABEND.
 20461     MOVE LINK-004               TO PGM-NAME.
 20462     MOVE DFHEIBLK               TO EMI-LINE1.
 20463
 20464* EXEC CICS LINK
 20465*        PROGRAM   (PGM-NAME)
 20466*        COMMAREA  (EMI-LINE1)
 20467*        LENGTH    (64)
 20468*    END-EXEC.
 20469     MOVE 64
 20470       TO DFHEIV11
 20471*    MOVE '."C                   (   #00018100' TO DFHEIV0
 20472     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20473     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20474     MOVE X'2020233030303138313030' TO DFHEIV0(25:11)
 20475     CALL 'kxdfhei1' USING DFHEIV0,
 20476           PGM-NAME,
 20477           EMI-LINE1,
 20478           DFHEIV11,
 20479           DFHEIV99,
 20480           DFHEIV99,
 20481           DFHEIV99,
 20482           DFHEIV99
 20483     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20484
 20485
 20486     MOVE 'EL156A'               TO  MAP-NAME.
 20487     MOVE LOW-VALUES             TO  EL156AO.
 20488     GO TO 8100-SEND-INITIAL-MAP.
 20489
 20490 9995-SECURITY-VIOLATION.
 20491*    COPY ELCSCTP.
 20492******************************************************************
 20493*                                                                *
 20494*                            ELCSCTP                             *
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 392
* EL156.cbl
 20495*                            VMOD=2.001                          *
 20496*                                                                *
 20497*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 20498******************************************************************
 20499
 20500
 20501     MOVE EIBDATE          TO SM-JUL-DATE.
 20502     MOVE EIBTRMID         TO SM-TERMID.
 20503     MOVE THIS-PGM         TO SM-PGM.
 20504     MOVE EIBTIME          TO TIME-IN.
 20505     MOVE TIME-OUT         TO SM-TIME.
 20506     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 20507
 20508
 20509* EXEC CICS LINK
 20510*         PROGRAM  ('EL003')
 20511*         COMMAREA (SECURITY-MESSAGE)
 20512*         LENGTH   (80)
 20513*    END-EXEC.
 20514     MOVE 'EL003' TO DFHEIV1
 20515     MOVE 80
 20516       TO DFHEIV11
 20517*    MOVE '."C                   (   #00018128' TO DFHEIV0
 20518     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20519     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20520     MOVE X'2020233030303138313238' TO DFHEIV0(25:11)
 20521     CALL 'kxdfhei1' USING DFHEIV0,
 20522           DFHEIV1,
 20523           SECURITY-MESSAGE,
 20524           DFHEIV11,
 20525           DFHEIV99,
 20526           DFHEIV99,
 20527           DFHEIV99,
 20528           DFHEIV99
 20529     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20530
 20531
 20532******************************************************************
 20533
 20534
 20535
 20536 9999-DFHBACK SECTION.
 20537     MOVE '9%                    "   ' TO DFHEIV0
 20538     MOVE 'EL156' TO DFHEIV1
 20539     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 20540     GOBACK.
 20541 9999-DFHEXIT.
 20542     IF DFHEIGDJ EQUAL 0001
 20543         NEXT SENTENCE
 20544     ELSE IF DFHEIGDJ EQUAL 2
 20545         GO TO 9990-ABEND,
 20546               8600-PGRM-NOT-FOUND,
 20547               0400-FIRST-TIME,
 20548               6180-DUPREC,
 20549               9990-ABEND
 20550         DEPENDING ON DFHEIGDI
 20551     ELSE IF DFHEIGDJ EQUAL 3
 20552         GO TO 0380-CLAIM-END-FILE,
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 393
* EL156.cbl
 20553               0380-CLAIM-END-FILE
 20554         DEPENDING ON DFHEIGDI
 20555     ELSE IF DFHEIGDJ EQUAL 4
 20556         GO TO 0380-CLAIM-END-FILE,
 20557               0380-CLAIM-END-FILE
 20558         DEPENDING ON DFHEIGDI
 20559     ELSE IF DFHEIGDJ EQUAL 5
 20560         GO TO 0800-EXIT
 20561         DEPENDING ON DFHEIGDI
 20562     ELSE IF DFHEIGDJ EQUAL 6
 20563         GO TO 1950-NOT-FOUND,
 20564               1950-NOT-FOUND
 20565         DEPENDING ON DFHEIGDI
 20566     ELSE IF DFHEIGDJ EQUAL 7
 20567         GO TO 1950-NOT-FOUND
 20568         DEPENDING ON DFHEIGDI
 20569     ELSE IF DFHEIGDJ EQUAL 8
 20570         GO TO 1950-NOT-FOUND,
 20571               1950-NOT-FOUND
 20572         DEPENDING ON DFHEIGDI
 20573     ELSE IF DFHEIGDJ EQUAL 9
 20574         GO TO 1166-END-CHECK,
 20575               1166-END-CHECK
 20576         DEPENDING ON DFHEIGDI
 20577     ELSE IF DFHEIGDJ EQUAL 10
 20578         GO TO 1950-NOT-FOUND,
 20579               1950-NOT-FOUND
 20580         DEPENDING ON DFHEIGDI
 20581     ELSE IF DFHEIGDJ EQUAL 11
 20582         GO TO 1950-NOT-FOUND,
 20583               1950-NOT-FOUND
 20584         DEPENDING ON DFHEIGDI
 20585     ELSE IF DFHEIGDJ EQUAL 12
 20586         GO TO 1950-NOT-FOUND
 20587         DEPENDING ON DFHEIGDI
 20588     ELSE IF DFHEIGDJ EQUAL 13
 20589         GO TO 3600-CONTINUE
 20590         DEPENDING ON DFHEIGDI
 20591     ELSE IF DFHEIGDJ EQUAL 14
 20592         GO TO 5300-NOTE-NOT-FOUND
 20593         DEPENDING ON DFHEIGDI
 20594     ELSE IF DFHEIGDJ EQUAL 15
 20595         GO TO 6065-NOT-FOUND
 20596         DEPENDING ON DFHEIGDI
 20597     ELSE IF DFHEIGDJ EQUAL 16
 20598         GO TO 6068-ACCT-NOT-FND
 20599         DEPENDING ON DFHEIGDI
 20600     ELSE IF DFHEIGDJ EQUAL 17
 20601         GO TO 6074-GET-COMP-DATA
 20602         DEPENDING ON DFHEIGDI
 20603     ELSE IF DFHEIGDJ EQUAL 18
 20604         GO TO 6170-WRITE
 20605         DEPENDING ON DFHEIGDI
 20606     ELSE IF DFHEIGDJ EQUAL 19
 20607         GO TO 6180-DUPREC
 20608         DEPENDING ON DFHEIGDI
 20609     ELSE IF DFHEIGDJ EQUAL 20
 20610         GO TO 6190-DUPREC
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 10:45 Page 394
* EL156.cbl
 20611         DEPENDING ON DFHEIGDI
 20612     ELSE IF DFHEIGDJ EQUAL 21
 20613         GO TO 6185-DUPREC
 20614         DEPENDING ON DFHEIGDI
 20615     ELSE IF DFHEIGDJ EQUAL 22
 20616         GO TO 6720-BUILD-NEW-RECORD
 20617         DEPENDING ON DFHEIGDI
 20618     ELSE IF DFHEIGDJ EQUAL 23
 20619         GO TO 6900-BUILD-ARCHIVE-HEADER,
 20620               6900-BUILD-ARCHIVE-HEADER
 20621         DEPENDING ON DFHEIGDI
 20622     ELSE IF DFHEIGDJ EQUAL 24
 20623         GO TO 7010-BUILD-MAP
 20624         DEPENDING ON DFHEIGDI
 20625     ELSE IF DFHEIGDJ EQUAL 25
 20626         GO TO 7100-SHOW-RECORD-NOT-FOUND
 20627         DEPENDING ON DFHEIGDI
 20628     ELSE IF DFHEIGDJ EQUAL 26
 20629         GO TO 7160-DUPREC
 20630         DEPENDING ON DFHEIGDI
 20631     ELSE IF DFHEIGDJ EQUAL 27
 20632         GO TO 7200-EXIT,
 20633               7200-EXIT
 20634         DEPENDING ON DFHEIGDI
 20635     ELSE IF DFHEIGDJ EQUAL 28
 20636         GO TO 7400-NOT-FOUND
 20637         DEPENDING ON DFHEIGDI
 20638     ELSE IF DFHEIGDJ EQUAL 29
 20639         GO TO 7590-END,
 20640               7590-END
 20641         DEPENDING ON DFHEIGDI
 20642     ELSE IF DFHEIGDJ EQUAL 30
 20643         GO TO 7699-EXIT
 20644         DEPENDING ON DFHEIGDI
 20645     ELSE IF DFHEIGDJ EQUAL 31
 20646         GO TO 5300-NOTE-NOT-FOUND
 20647         DEPENDING ON DFHEIGDI
 20648     ELSE IF DFHEIGDJ EQUAL 32
 20649         GO TO 7800-COMP-NOTFND
 20650         DEPENDING ON DFHEIGDI
 20651     ELSE IF DFHEIGDJ EQUAL 33
 20652         GO TO 7920-NOT-FOUND
 20653         DEPENDING ON DFHEIGDI
 20654     ELSE IF DFHEIGDJ EQUAL 34
 20655         GO TO 9870-NOTOPEN,
 20656               9870-EXIT
 20657         DEPENDING ON DFHEIGDI.
 20658     MOVE '9%                    "   ' TO DFHEIV0
 20659     MOVE 'EL156' TO DFHEIV1
 20660     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 20661     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       12772     Code:       76785
