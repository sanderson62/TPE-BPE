* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page   1
* NSRASBL.cbl
* Options: int("NSRASBL.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("NSRASBL.lst")
     1$SET SQL(dbman=ODBC, TARGETDB=MSSQLSERVER, NOAUTOCOMMIT)
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"NSRASBL.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"NSRASBL.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     2 IDENTIFICATION DIVISION.
     3 PROGRAM-ID.   NSRASBL.
     4*AUTHOR.     PABLO
     5*            COLLEYVILLE, TEXAS.
     6*REMARKS.    EXECUTED FROM NSRASLTR
     7******************************************************************
     8*                   C H A N G E   L O G
     9*
    10* ChangeS ARE MARKED BY THE Change EFFECTIVE DATE.
    11*-----------------------------------------------------------------
    12*  Change   Change REQUEST PGMR  DESCRIPTION OF Change
    13* EFFECTIVE    NUMBER
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page   2
* NSRASBL.cbl
    14*-----------------------------------------------------------------
    15* 060611    2011022800001  PEMA  NEW PROGRAM
    16* 122911    2011022800001  AJRA  ADD VA DISCLOSURE TO CERT PRINT
    17* 071212    2011022800001  AJRA  ADD UNDW ID
    18* 072312    2011022800001  AJRA    ADD NEW FIELDS
    19* 090612  IR2012090600001  AJRA  NAPERSOFT
    20* 091112  IR2012091100002  AJRA  FIX AKA
    21* 091312  IR2012091100004  AJRA  FIX JOINT NAME
    22* 092412  IR2012092350004  AJRA  FIX CANCEL AMT
    23* 100112  IR2012100100002  AJRA  FIX ADDRESS WITH 2 SPACES
    24* 100412  IR2012100300002  AJRA  FIX VA DISC FOR DISAB ONLY CERT
    25* 101412    2011022800001  AJRA  POST IMPLEMENTATION ITEMS
    26* 101812    2012101700002  AJRA  READ ENDT BY ARCHIVE NO
    27* 110612    2012101700002  AJRA  ADD NEW FIELDS
    28* 121112    2012101700002  AJRA  HANDLE .01 PREM AND 9999999 BEN
    29* 121712    2012101700002  AJRA  ADD DEFAULT AGE FLAG
    30* 050213    2013050100001  AJRA  FIX AH REFUND ON DEATH CLAIM
    31* 091213    2013090300001  AJRA  NAPERSOFT PHASE 2
    32* 123113    2013090300001  AJRA  USE NEXT BUS DT FOR RESEND DT CAL
    33* 011314  IR2014011300001  AJRA  FIX NEXT BUS DT AND ENDORSEMENT A
    34* 011514    2013090300001  AJRA  CALL SQL STORED PROC FOR NEXT BUS
    35* 021214  IR2014021200002  AJRA  ADD SQL DISCONNECT
    36* 121015  CR2015100900001  TANA  ADD VIN NUMBER
    37* 020916  CR2016010700001  TANA  CALL SQL LOOKUP NAPERSOFT TABLE
    38******************************************************************
    39 ENVIRONMENT DIVISION.
    40 DATA DIVISION.
    41 working-storage section.
    42 01  DFH-START PIC X(04).
    43 77  SAVE-DATE                   PIC X(8)    VALUE SPACES.
    44 77  WS-SAVE-EDIT-A-DATE         PIC X(10)   VALUE SPACES.
    45 77  SAVE-BIN-DATE               PIC XX      VALUE SPACES.
    46 77  SAVE-BIN-NEXT-BUS-DT        PIC XX      VALUE SPACES.
    47 77  SAVE-NEXT-BUS-DT-EDIT-A     PIC X(10)   VALUE SPACES.
    48 77  SAVE-CYCLE-DAY-OF-WEEK      PIC S9   COMP-3 VALUE +0.
    49 77  S1                          PIC S999 COMP-3 VALUE +0.
    50 77  E1                          PIC S999 COMP-3 VALUE +0.
    51 77  A1                          PIC S9(5) COMP-3 VALUE +0.
    52 77  M1                          PIC S9(5) COMP-3 VALUE +0.
    53 77  WS-WORK-FIELD               PIC X(80)    VALUE SPACES.
    54 77  WS-ARCHIVE-NO               PIC S9(8)  COMP VALUE +0.
    55 77  WS-FOLLOW-UP-DT             PIC XX  VALUE LOW-VALUES.
    56 77  WS-RESEND-DT                PIC XX  VALUE LOW-VALUES.
    57 77  WS-AUTO-LAST-SCHED-DT       PIC XX  VALUE LOW-VALUES.
    58 77  WS-LAST-ACT-DT              PIC XX  VALUE LOW-VALUES.
    59 77  WS-ACTIVITY-DT              PIC XX  VALUE LOW-VALUES.
    60 77  WS-FORM                     PIC XXXX  VALUE SPACES.
    61 77  WS-LAST-ACT-TYPE            PIC X   VALUE ' '.
    62 77  WS-FOUND-BENE-SW            PIC X   VALUE ' '.
    63     88  FOUND-BENE                  VALUE 'Y'.
    64 77  WS-TALLY                    PIC S999 COMP-3 VALUE +0.
    65 77  WS-TALLY1                   PIC S999 COMP-3 VALUE +0.
    66 77  NS-LEN                      PIC S9(5) COMP-3 VALUE +0.
    67 77  WS-ERPNDB-SW                PIC X  VALUE ' '.
    68     88  END-OF-ERPNDB              VALUE 'Y'.
    69 77  WS-ERACCT-SW                PIC X  VALUE ' '.
    70     88  ACCT-FOUND                 VALUE 'Y'.
    71 77  WS-ELCERT-SW                PIC X  VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page   3
* NSRASBL.cbl
    72     88  CERT-FOUND                 VALUE 'Y'.
    73     88  CERT-NOT-FOUND             VALUE 'N'.
    74 77  WS-ERENDT-SW                PIC X  VALUE ' '.
    75     88  ENDT-FOUND                 VALUE 'Y'.
    76     88  ENDT-NOT-FOUND             VALUE 'N'.
    77 77  WS-CERT-TRL-REC-NOT-FOUND   PIC S9       VALUE +0.
    78     88  CERT-TRL-REC-NOT-FOUND     VALUE +1.
    79 77  WS-LF-ABBRV                 PIC X(10) VALUE SPACES.
    80 77  WS-LF-DESC                  PIC X(02) VALUE SPACES.
    81 77  WS-LF-EARN                  PIC X     VALUE ' '.
    82 77  WS-WAIT-PER                 PIC X(03) VALUE ZEROS.
    83 77  WS-RET-ELIM                 PIC X(01) VALUE SPACES.
    84 77  WS-AH-DESC                  PIC X(35) VALUE SPACES.
    85 77  WS-BEN-DAYS                 PIC X(02) VALUE ZEROS.
    86 77  WS-CSR-ID                   PIC XXXX  VALUE SPACES.
    87 77  WS-LF-BENCD                 PIC XX    VALUE '00'.
    88 77  WS-AH-BENCD                 PIC XX    VALUE '00'.
    89 77  WS-SAVE-ERACCT-KEY          PIC X(20)  VALUE SPACES.
    90 77  WS-COMPANY-CD               PIC X  VALUE LOW-VALUES.
    91 77  WS-WORK-PREM                PIC S9(9)V99 COMP-3 VALUE +0.
    92 77  WS-WORK-LF-PREM             PIC S9(9)V99 COMP-3 VALUE +0.
    93 77  WS-WORK-ALT-LF-PREM         PIC S9(9)V99 COMP-3 VALUE +0.
    94 77  WS-WORK-CMB-LF-PREM         PIC S9(9)V99 COMP-3 VALUE +0.
    95 77  WS-WORK-AH-PREM             PIC S9(9)V99 COMP-3 VALUE +0.
    96 77  WS-WORK-REF                 PIC S9(9)V99 COMP-3 VALUE +0.
    97 77  WS-WORK-LF-REF              PIC S9(9)V99 COMP-3 VALUE +0.
    98 77  WS-WORK-AH-REF              PIC S9(9)V99 COMP-3 VALUE +0.
    99 77  WS-ISSUE-CANCEL-SW          PIC X  VALUE SPACES.
   100     88  PROCESS-ISSUE               VALUE 'I'.
   101     88  PROCESS-CANCEL              VALUE 'C'.
   102 77  WS-SAVE-OUT-LETTER          PIC X(6)  VALUE SPACES.
   103 77  WS-WORK-COMM                PIC 9(7)V99 VALUE ZEROS.
   104 77  WS-DIFF                     PIC 999 VALUE ZEROS.
   105 77  WS-CHGBACK                  PIC 99  VALUE ZEROS.
   106 77  WS-CHGBK-LIFE-PCT           PIC S9V9(5) COMP-3 VALUE +0.
   107 77  WS-CHGBK-AH-PCT             PIC S9V9(5) COMP-3 VALUE +0.
   108 77  WS-CERT-EFF-DT              PIC XX  VALUE SPACES.
   109 77  LINK-ELVADS                 PIC X(8) VALUE 'ELVADS'.
*  110 EXEC SQL
*  111    INCLUDE SQLDA
*  112 END-EXEC
   113 01 SQLDA sync.
   114    05 SQLDAID               PIC X(8)  VALUE "SQLDA  ".
   115    05 SQLDABC               PIC S9(9) COMP-5 value 0.
   116    05 SQLN                  PIC S9(4) COMP-5 value 0.
   117    05 SQLD                  PIC S9(4) COMP-5 value 0.
   118    05 SQLVAR OCCURS 0 TO 1489 TIMES DEPENDING ON SQLD.
   119       10 SQLTYPE            PIC S9(4) COMP-5.
   120       10 SQLLEN             PIC S9(4) COMP-5.
   121$IF P64 SET
   122X      *> For 64-bit environments, ensure that SQLDATA is
   123X      *> aligned on an 8-byte boundary.
   124X      10 FILLER             PIC S9(9) COMP-5.
   125$END
   126       10 SQLDATA            USAGE POINTER.
   127       10 SQLIND             USAGE POINTER.
   128       10 SQLNAME.
   129          15 SQLNAMEL        PIC S9(4) COMP-5.
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page   4
* NSRASBL.cbl (/opt/lib/cobol/cpylib/sqlda.cpy)
   130          15 SQLNAMEC        PIC X(30).
   131
   132* Values for SQLTYPE
   133
   134 78  ESQL-DATE-CHAR              VALUE 384.
   135 78  ESQL-DATE-CHAR-NULL         VALUE 385.
   136 78  ESQL-DATE-REC               VALUE 386.
   137 78  ESQL-DATE-REC-NULL          VALUE 387.
   138 78  ESQL-TIME-CHAR              VALUE 388.
   139 78  ESQL-TIME-CHAR-NULL         VALUE 389.
   140 78  ESQL-TIME-REC               VALUE 390.
   141 78  ESQL-TIME-REC-NULL          VALUE 391.
   142 78  ESQL-TIMESTAMP-CHAR         VALUE 392.
   143 78  ESQL-TIMESTAMP-CHAR-NULL    VALUE 393.
   144 78  ESQL-TIMESTAMP-REC          VALUE 394.
   145 78  ESQL-TIMESTAMP-REC-NULL     VALUE 395.
   146 78  ESQL-TS-OFFSET-CHAR         VALUE 396. *> added nx51sp1
   147 78  ESQL-TS-OFFSET-CHAR-NULL    VALUE 397.
   148 78  ESQL-TS-OFFSET-REC          VALUE 398.
   149 78  ESQL-TS-OFFSET-REC-NULL     VALUE 399. *> end adds nx51sp1
   150 78  ESQL-LONGVARBINARY          VALUE 404.
   151 78  ESQL-LONGVARBINARY-NULL     VALUE 405.
   152 78  ESQL-LONGVARCHAR            VALUE 408.
   153 78  ESQL-LONGVARCHAR-NULL       VALUE 409.
   154 78  ESQL-BINARY                 VALUE 444.
   155 78  ESQL-BINARY-NULL            VALUE 445.
   156 78  ESQL-VARBINARY              VALUE 446.
   157 78  ESQL-VARBINARY-NULL         VALUE 447.
   158 78  ESQL-VARCHAR                VALUE 448.
   159 78  ESQL-VARCHAR-NULL           VALUE 449.
   160
   161 78  ESQL-CHARVARYING            VALUE 450.  *> added esq03n31
   162 78  ESQL-CHARVARYING-NULL       VALUE 451.  *> added esq03n31
   163
   164 78  ESQL-CHAR                   VALUE 452.
   165 78  ESQL-CHAR-NULL              VALUE 453.
   166
   167 78  ESQL-CHAR-FIXED             VALUE 454.  *> added esq03n31
   168 78  ESQL-CHAR-FIXED-NULL        VALUE 455.  *> added esq03n31
   169
   170 78  ESQL-DOUBLE                 VALUE 480.
   171 78  ESQL-DOUBLE-NULL            VALUE 481.
   172 78  ESQL-REAL                   VALUE 482.
   173 78  ESQL-REAL-NULL              VALUE 483.
   174 78  ESQL-DECIMAL                VALUE 484.
   175 78  ESQL-DECIMAL-NULL           VALUE 485.
   176 78  ESQL-INTEGER                VALUE 496.
   177 78  ESQL-INTEGER-NULL           VALUE 497.
   178 78  ESQL-SMALLINT               VALUE 500.
   179 78  ESQL-SMALLINT-NULL          VALUE 501.
   180 78  ESQL-TINYINT                VALUE 502.
   181 78  ESQL-TINYINT-NULL           VALUE 503.
   182
*  183 EXEC SQL
*  184    INCLUDE SQLCA
*  185 END-EXEC
   186 01 SQLCA.
   187     05  SQLCAID         PIC X(8)         VALUE "SQLCA   ".
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page   5
* NSRASBL.cbl (/opt/lib/cobol/cpylib/sqlca.cpy)
   188     05  SQLCABC         PIC S9(9) COMP-5 VALUE 136.
   189     05  SQLCODE         PIC S9(9) COMP-5 VALUE 0.
   190     05  SQLERRM.
   191         49  SQLERRML    PIC S9(4) COMP-5.
   192         49  SQLERRMC    PIC X(70).
   193     05  SQLERRP         PIC X(8).
   194     05  SQLERRD         PIC S9(9) COMP-5 OCCURS 6 VALUE 0.
   195     05  SQLWARN.
   196         10  SQLWARN0    PIC X.
   197         10  SQLWARN1    PIC X.
   198         10  SQLWARN2    PIC X.
   199         10  SQLWARN3    PIC X.
   200         10  SQLWARN4    PIC X.
   201         10  SQLWARN5    PIC X.
   202         10  SQLWARN6    PIC X.
   203         10  SQLWARN7    PIC X.
   204     05  SQLEXT.
   205         10  SQLWARN8    PIC X.
   206         10  SQLWARN9    PIC X.
   207         10  SQLWARN10   PIC X.
   208         10  SQLWARNA    REDEFINES SQLWARN10 PIC X .
   209     05  SQLSTATE    PIC X(5).
   210
   211 EXEC SQL
   212    BEGIN DECLARE SECTION
   213 END-EXEC
   214
   215 01  SQLCMD                      PIC X(1024).
   216 01  SVR                         PIC X(32).
   217 01  USR                         PIC X(32).
   218 01  PASS                        PIC X(32).
   219 01  USR-PASS                    PIC X(64).
   220
   221 01  WS-SQL-DATA.
   222     05  WS-CYCLE-DATE           PIC X(10).
   223     05  WS-NEXT-BUS-DT          PIC X(10).
   224     05  WS-LOOKUPID             PIC X(4).
   225     05  WS-LOOKUPKEY            PIC X(4).
   226     05  WS-LOOKUP-VALUE         PIC X(100).
   227
   228 EXEC SQL
   229    END DECLARE SECTION
   230 END-EXEC
   231
   232
   233 01  P pointer.
   234 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
   235 01  KIXHOST             pic x(9) value Z"HOSTNAME".
   236 01  var-ptr pointer.
   237 01  env-var-len                 pic 9(4)  binary.
   238 01  rc                          pic 9(9)  binary.
   239
   240 01  WS-KIXHOST                  PIC X(10).
   241 01  WS-KIXSYS.
   242     05  WS-KIX-FIL1             PIC X(10).
   243     05  WS-KIX-APPS             PIC X(10).
   244     05  WS-KIX-ENV              PIC X(10).
   245     05  WS-KIX-MYENV            PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page   6
* NSRASBL.cbl
   246     05  WS-KIX-SYS              PIC X(10).
   247
   248 01  WS-CALC-FIELDS.
   249     12  WS-WRK-AMOUNT           PIC S9(7)V99 COMP-3 VALUE +0.
   250     12  WS-WRK-AMOUNT2          PIC S9(7)V99 COMP-3 VALUE +0.
   251     12  WS-CSO-LF-PORTION       PIC S9(7)V99 COMP-3 VALUE +0.
   252     12  WS-CSO-ALT-LF-PORTION   PIC S9(7)V99 COMP-3 VALUE +0.
   253     12  WS-CSO-CMB-LF-PORTION   PIC S9(7)V99 COMP-3 VALUE +0.
   254     12  WS-CSO-AH-PORTION       PIC S9(7)V99 COMP-3 VALUE +0.
   255     12  WS-CSO-PORTION          PIC S9(7)V99 COMP-3 VALUE +0.
   256     12  WS-ACCT-LF-PORTION      PIC S9(7)V99 COMP-3 VALUE +0.
   257     12  WS-ACCT-ALT-LF-PORTION  PIC S9(7)V99 COMP-3 VALUE +0.
   258     12  WS-ACCT-CMB-LF-PORTION  PIC S9(7)V99 COMP-3 VALUE +0.
   259     12  WS-ACCT-AH-PORTION      PIC S9(7)V99 COMP-3 VALUE +0.
   260     12  WS-ACCT-PORTION         PIC S9(7)V99 COMP-3 VALUE +0.
   261     12  WS-CSO-ORIG-LF-PORT     PIC S9(7)V99 COMP-3 VALUE +0.
   262     12  WS-CSO-ORIG-ALT-LF-PORT PIC S9(7)V99 COMP-3 VALUE +0.
   263     12  WS-CSO-ORIG-CMB-LF-PORT PIC S9(7)V99 COMP-3 VALUE +0.
   264     12  WS-CSO-ORIG-AH-PORT     PIC S9(7)V99 COMP-3 VALUE +0.
   265     12  WS-CSO-ORIG-PORTION     PIC S9(7)V99 COMP-3 VALUE +0.
   266     12  WS-ACCT-ORIG-LF-PORT    PIC S9(7)V99 COMP-3 VALUE +0.
   267     12  WS-ACCT-ORIG-ALT-LF-PORT PIC S9(7)V99 COMP-3 VALUE +0.
   268     12  WS-ACCT-ORIG-CMB-LF-PORT PIC S9(7)V99 COMP-3 VALUE +0.
   269     12  WS-ACCT-ORIG-AH-PORT    PIC S9(7)V99 COMP-3 VALUE +0.
   270     12  WS-ACCT-ORIG-PORTION    PIC S9(7)V99 COMP-3 VALUE +0.
   271     12  WS-CSO-NEW-LF-PORT      PIC S9(7)V99 COMP-3 VALUE +0.
   272     12  WS-CSO-NEW-ALT-LF-PORT  PIC S9(7)V99 COMP-3 VALUE +0.
   273     12  WS-CSO-NEW-CMB-LF-PORT  PIC S9(7)V99 COMP-3 VALUE +0.
   274     12  WS-CSO-NEW-AH-PORT      PIC S9(7)V99 COMP-3 VALUE +0.
   275     12  WS-CSO-NEW-PORTION      PIC S9(7)V99 COMP-3 VALUE +0.
   276     12  WS-ACCT-NEW-LF-PORT     PIC S9(7)V99 COMP-3 VALUE +0.
   277     12  WS-ACCT-NEW-ALT-LF-PORT PIC S9(7)V99 COMP-3 VALUE +0.
   278     12  WS-ACCT-NEW-CMB-LF-PORT PIC S9(7)V99 COMP-3 VALUE +0.
   279     12  WS-ACCT-NEW-AH-PORT     PIC S9(7)V99 COMP-3 VALUE +0.
   280     12  WS-ACCT-NEW-PORTION     PIC S9(7)V99 COMP-3 VALUE +0.
   281     12  WS-CSO-LF-PORT-CHG      PIC S9(7)V99 COMP-3 VALUE +0.
   282     12  WS-CSO-ALT-LF-PORT-CHG  PIC S9(7)V99 COMP-3 VALUE +0.
   283     12  WS-CSO-CMB-LF-PORT-CHG  PIC S9(7)V99 COMP-3 VALUE +0.
   284     12  WS-CSO-AH-PORT-CHG      PIC S9(7)V99 COMP-3 VALUE +0.
   285     12  WS-CSO-PORTION-CHG      PIC S9(7)V99 COMP-3 VALUE +0.
   286     12  WS-ACCT-LF-PORT-CHG     PIC S9(7)V99 COMP-3 VALUE +0.
   287     12  WS-ACCT-ALT-LF-PORT-CHG PIC S9(7)V99 COMP-3 VALUE +0.
   288     12  WS-ACCT-CMB-LF-PORT-CHG PIC S9(7)V99 COMP-3 VALUE +0.
   289     12  WS-ACCT-AH-PORT-CHG     PIC S9(7)V99 COMP-3 VALUE +0.
   290     12  WS-ACCT-PORTION-CHG     PIC S9(7)V99 COMP-3 VALUE +0.
   291 01  WS-SAVE-ERACCT-REC          PIC X(2000).
   292 01  WS-XML-WORK                 PIC X(4200)  VALUE SPACES.
   293 01 response-code         pic s9(8) comp.
   294 01 display-response      pic 9(8).
   295 01 bl-index              pic 9(8) comp.
   296 01 max-last-name         pic x(18).
   297 01 first-initial         pic x.
   298 01 name-in-range-flag    pic 9.
   299 01 max-entries           pic s9(8) comp value 100.
   300 01 WS-PASSED-DT          PIC XX   VALUE LOW-VALUES.
   301 01 lower-case    pic x(26) value
   302            "abcdefghijklmnopqrstuvwxyz".
   303 01 upper-case    pic x(26) value
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page   7
* NSRASBL.cbl
   304            "ABCDEFGHIJKLMNOPQRSTUVWXYZ".
   305
   306*                                COPY ELCVADS.
   307******************************************************************
   308*                                                                *
   309*                                                                *
   310*                            ELCVADS.                            *
   311*                                                                *
   312*   FILE DESCRIPTION = VIRGINIA DISLCOSURE FIELDS PASSED TO      *
   313*   ELVADS                  LENGTH = 350                         *
   314******************************************************************
   315******************************************************************
   316*                   C H A N G E   L O G
   317*
   318* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   319*-----------------------------------------------------------------
   320*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   321* EFFECTIVE    NUMBER
   322*-----------------------------------------------------------------
   323* 100111    2011022800001  AJRA  NAPERSOFT
   324******************************************************************
   325
   326 01  VIRGINIA-DISCLOSURE.
   327     12  VD-COMPANY-CD              PIC X.
   328     12  VD-CARRIER                 PIC X.
   329     12  VD-GROUPING.
   330         20  VD-GROUPING-PREFIX     PIC XXX.
   331         20  VD-GROUPING-PRIME      PIC XXX.
   332     12  VD-STATE                   PIC XX.
   333     12  VD-ACCOUNT.
   334         20  VD-ACCOUNT-PREFIX      PIC X(4).
   335         20  VD-ACCOUNT-PRIME       PIC X(6).
   336     12  VD-CERT-EFF-DT             PIC XX.
   337     12  VD-CERT-NO.
   338         20  VD-CERT-PRIME          PIC X(10).
   339         20  VD-CERT-SFX            PIC X.
   340     12  VD-ENTRY-BATCH             PIC X(6).
   341     12  VD-CSR-ID                  PIC X(4).
   342     12  VD-NAME.
   343         20  VD-INSURED-LAST-NAME   PIC X(15).
   344         20  VD-INSURED-FIRST-NAME.
   345             24  VD-INSURED-1ST-INIT PIC X.
   346             24  FILLER             PIC X(9).
   347         20  VD-INSURED-MIDDLE-INIT PIC X.
   348     12  VD-JOINT-INSURED.
   349         20 VD-JOINT-LAST-NAME      PIC X(15).
   350         20 VD-JOINT-FIRST-NAME.
   351            24  VD-JOINT-FIRST-INIT PIC X.
   352            24  FILLER              PIC X(9).
   353         20 VD-JOINT-MIDDLE-INIT    PIC X.
   354     12  VD-INSURED-ADDRESS-1       PIC X(30).
   355     12  VD-INSURED-ADDRESS-2       PIC X(30).
   356     12  VD-INSURED-CITY-STATE.
   357         20  VD-INSURED-CITY        PIC X(28).
   358         20  VD-INSURED-STATE       PIC XX.
   359     12  VD-INSURED-ZIP-CODE.
   360         20  VD-INSURED-ZIP-PRIME.
   361             24  VD-INSURED-ZIP-1   PIC X.
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page   8
* NSRASBL.cbl
   362                 88  VD-CANADIAN-POST-CODE
   363                                       VALUE 'A' THRU 'Z'.
   364             24  FILLER             PIC X(4).
   365         20  VD-INSURED-ZIP-PLUS4   PIC X(4).
   366     12  VD-BENEFICIARY-NAME        PIC X(30).
   367     12  VD-ACCOUNT-NAME            PIC X(30).
   368     12  VD-LOAN-TERM               PIC S999   COMP-3.
   369     12  VD-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
   370     12  VD-1ST-PMT-DT              PIC XX.
   371     12  VD-LIFE-BENEFIT-CD         PIC XX.
   372         88  VD-VALID-LIFE             VALUE '01' THRU '89'.
   373         88  VD-INVALID-LIFE           VALUE '  ' '00'
   374                                             '90' THRU '99'.
   375     12  VD-LF-BENEFIT-CD   REDEFINES VD-LIFE-BENEFIT-CD
   376                                    PIC XX.
   377     12  VD-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
   378     12  VD-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
   379     12  VD-LF-RATE                 PIC S99V9(5)   COMP-3.
   380     12  VD-LF-TERM                 PIC S999   COMP-3.
   381     12  VD-AH-BENEFIT-CD           PIC XX.
   382         88  VD-VALID-AH               VALUE '01' THRU '89'.
   383         88  VD-INVALID-AH             VALUE '  ' '00'
   384                                             '90' THRU '99'.
   385     12  VD-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
   386     12  VD-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
   387     12  VD-AH-RATE                 PIC S99V9(5)   COMP-3.
   388     12  VD-AH-TERM                 PIC S999   COMP-3.
   389     12  VD-LETTER-ID               PIC X(4).
   390     12  VD-PROC-ID                 PIC X(4).
   391     12  VD-COMP-ID                 PIC X(3).
   392     12  VD-CURRENT-DATE            PIC XX.
   393     12  VD-CURRENT-TIME            PIC S9(6) COMP-3.
   394     12  VD-ARCHIVE-NO              PIC S9(08) COMP VALUE +0.
   395     12  FILLER                     PIC X(32).
   396 01  WS-PASS-AREA.
   397     05  WS-PASS-AREA-LENGTH PIC S9(4) COMP VALUE +352.
   398     05  WS-PASS-VADS-REC    PIC X(350).
   399
   400*** Z CONTROL LAYOUT MOVED TO COPYBOOK ELCZREC
   401*                         COPY ELCZREC.
   402******************************************************************
   403*                                                                *
   404*                                                                *
   405*                            ELCZREC.                            *
   406*                                                                *
   407*   FILE DESCRIPTION = Z CONTROL RECORD LAYOUT                   *
   408*                                                                *
   409******************************************************************
   410*-----------------------------------------------------------------
   411*                   C H A N G E   L O G
   412*
   413* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   414*-----------------------------------------------------------------
   415*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   416* EFFECTIVE    NUMBER
   417*-----------------------------------------------------------------
   418* 122011    2011022800001  AJRA  NEW FILE
   419* 073112    2011022800001  AJRA  ADD ACCT SUMM, CSO SUMM
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page   9
* NSRASBL.cbl
   420* 122712    2012101700002  AJRA  ADD REASON CODE REQUIRED FLAG
   421* 072313    2013062000003  AJRA  ADD IND FOR INSERTION BAR CODE
   422* 091913    2013090300001  AJRA  ADD SIGNATURE FLAG DEFAULT
   423*-----------------------------------------------------------------
   424 01  W-Z-CONTROL-DATA.
   425     05  W-NUMBER-OF-COPIES      PIC  9.
   426     05  FILLER                  PIC  X.
   427     05  W-DAYS-TO-FOLLOW-UP     PIC  999.
   428     05  FILLER                  PIC  X.
   429     05  W-DAYS-TO-RESEND        PIC  999.
   430     05  FILLER                  PIC  X.
   431     05  W-FORM-TO-RESEND        PIC  X(4).
   432     05  W-ADD-BAR-CODE          PIC  X.
   433     05  W-PROMPT-LETTER         PIC  X.
   434     05  W-HAS-RETURN-ENV        PIC  X.
   435     05  W-ENCLOSURE-CD          PIC  XXX.
   436     05  W-SIG-FLAG-DEFAULT      PIC  X.
   437     05  W-AUTO-CLOSE-IND        PIC  X.
   438     05  FILLER                  PIC  X.
   439     05  W-LETTER-TO-BENE        PIC  X.
   440     05  FILLER                  PIC  X.
   441     05  W-LETTER-TO-ACCT        PIC  X.
   442     05  FILLER                  PIC  X.
   443     05  W-LETTER-TYPE           PIC  X.
   444     05  FILLER                  PIC  X.
   445     05  W-PRINT-CERTIFICATE     PIC  X.
   446     05  FILLER                  PIC  X.
   447     05  W-REFUND-REQUIRED       PIC  X.
   448     05  FILLER                  PIC  X.
   449     05  W-ONBASE-CODE           PIC  XX.
   450     05  FILLER                  PIC  X.
   451     05  W-ACCT-SUMM             PIC  X.
   452     05  FILLER                  PIC  X.
   453     05  W-CSO-SUMM              PIC  X.
   454     05  FILLER                  PIC  X.
   455     05  W-REASONS-REQUIRED      PIC  X.
   456     05  FILLER                  PIC  X(29).
   457 01  MISC.
   458     12  WS-RESPONSE             PIC S9(8)   COMP.
   459         88  RESP-NORMAL                  VALUE +00.
   460         88  RESP-NOTFND                  VALUE +13.
   461         88  RESP-DUPREC                  VALUE +14.
   462         88  RESP-DUPKEY                  VALUE +15.
   463         88  RESP-NOTOPEN                 VALUE +19.
   464         88  RESP-ENDFILE                 VALUE +20.
   465
   466     12  WS-EDIT-A-DATE.
   467         16  WS-EDIT-A-MM                 PIC X(2).
   468         16  FILLER                       PIC X(1).
   469         16  WS-EDIT-A-DD                 PIC X(2).
   470         16  FILLER                       PIC X(1).
   471         16  WS-EDIT-A-CCYY.
   472             20  WS-EDIT-A-CC             PIC X(2).
   473             20  WS-EDIT-A-YY             PIC X(2).
   474 01  srch-commarea.
   475*                                copy ELCADLTRSPI.
   476******************************************************************
   477*                   C H A N G E   L O G
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page  10
* NSRASBL.cbl
   478*
   479* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   480*-----------------------------------------------------------------
   481*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   482* EFFECTIVE    NUMBER
   483*-----------------------------------------------------------------
   484* 060611    2011022800001  PEMA  NEW COPYBOOK
   485* 101812    2012101700002  AJRA  ADD ENDT ARCHIVE NO, SCREENID
   486* 110612    2012101700002  AJRA  EXPAND PASSED DATA
   487******************************************************************
   488****************************************
   489*  commarea for NaperSoft On Demand Admin services letters
   490*  (business logic input & output)
   491****************************************
   492     03  BL-INPUT.
   493         05  BL-DATA-SRCE        PIC X.
   494         05  BL-LETTER-ID        PIC XXXX.
   495         05  BL-CARRIER          PIC X.
   496         05  BL-GROUP            PIC X(6).
   497         05  BL-STATE            PIC XX.
   498         05  BL-ACCOUNT          PIC X(10).
   499         05  BL-EFF-DT           PIC X(10).
   500         05  BL-CERT-NO          PIC X(11).
   501         05  BL-BATCH-NO         PIC X(6).
   502         05  BL-BATCH-SEQ        PIC 9(8).
   503         05  BL-RESP-NO          PIC X(10).
   504         05  BL-NO-OF-COPIES     PIC 99.
   505         05  BL-PROC-ID          PIC XXXX.
   506         05  BL-COMP-ID          PIC XXX.
   507         05  BL-PRINT-NOW-SW     PIC X.
   508         05  BL-ENC-CD           PIC XXX.
   509         05  BL-RESEND-DT        PIC X(10).
   510         05  BL-FOLLOW-UP-DT     PIC X(10).
   511         05  BL-ARCHIVE-NO       PIC 9(8).
   512         05  BL-FUNC             PIC X(8).
   513         05  BL-COMMENTS         PIC X(100).
   514         05  FILLER REDEFINES BL-COMMENTS.
   515             10  BL-REASON-CODE OCCURS 12 PIC X(4).
   516             10  BL-LETTER-TO-ACCT PIC X.
   517             10  BL-LETTER-TO-BENE PIC X.
   518             10  BL-WRITE-ERARCH   PIC X.
   519                 88  ERARCH-QWS      VALUE 'Q'.
   520                 88  ERARCH-BATCH    VALUE 'B'.
   521                 88  ERARCH-TEMP     VALUE 'T'.
   522             10  BL-PROCESS-TYPE PIC X(07).
   523             10  BL-CERT-FORM-ID PIC X(05).
   524             10  BL-ENDT-ARCH-NO PIC 9(08) BINARY.
   525             10  BL-SOURCE-SCREEN PIC X(8).
   526             10  FILLER          PIC X(25).
   527     03  BL-OUTPUT.
   528         05  BL-STATUS                   PIC X.
   529             88  BL-OK                      VALUE "P".
   530             88  BL-FAIL                  VALUE "F".
   531         05  BL-MESSAGE          PIC X(50).
   532     03  BL-RECORD-PASSED-DATA   PIC X(6200).
   533     03  FILLER                  PIC X(31).
   534 01  filler                      pic x(500).
   535 01  WS-SAVE-CARRIER-INFO.
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page  11
* NSRASBL.cbl
   536     05  WS-PREV-CARRIER         PIC X      VALUE SPACES.
   537     05  WS-CARR-NAME            PIC X(30)  VALUE SPACES.
   538     05  WS-CARR-ICO             PIC X(30)  VALUE SPACES.
   539     05  WS-CARR-ADDR1           PIC X(30)  VALUE SPACES.
   540     05  WS-CARR-ADDR2           PIC X(30)  VALUE SPACES.
   541     05  WS-CARR-CITYST          PIC X(30)  VALUE SPACES.
   542     05  WS-CARR-ZIP             PIC X(9)   VALUE SPACES.
   543     05  WS-CARR-PHONE           PIC X(11)  VALUE SPACES.
   544 01  WS-SAVE-STATE-INFO.
   545     05  WS-PREV-STATE           PIC XX     VALUE SPACES.
   546     05  WS-STATE-NAME           PIC X(25)  VALUE SPACES.
   547 01  WS-SAVE-LFBEN-INFO.
   548     05  WS-PREV-LFBEN           PIC XX     VALUE SPACES.
   549     05  WS-LFBEN-ALPH           PIC XXX    VALUE SPACES.
   550     05  WS-LFBEN-DESC           PIC X(10)  VALUE SPACES.
   551 01  WS-SAVE-AHBEN-INFO.
   552     05  WS-PREV-AHBEN           PIC XX     VALUE SPACES.
   553     05  WS-AHBEN-DESC           PIC X(10)  VALUE SPACES.
   554     05  WS-AHBEN-RET-ELIM       PIC X      VALUE SPACES.
   555     05  WS-AHBEN-DAYS           PIC XX     VALUE SPACES.
   556 01  WS-ERPNDB-KEY.
   557     05  WS-ERPNDB-COMPANY-CD    PIC X.
   558     05  WS-ERPNDB-BATCH-NO      PIC X(6).
   559     05  WS-ERPNDB-BATCH-SEQ     PIC S9(4) COMP  VALUE +0.
   560     05  WS-ERPNDB-CHG-SEQ       PIC S9(4) COMP  VALUE +0.
   561 01  WS-ELENCC-KEY.
   562     05  WS-ELENCC-COMPANY-CD    PIC X.
   563     05  WS-ELENCC-REC-TYPE      PIC X.
   564     05  WS-ELENCC-ENC-CODE      PIC X(5).
   565     05  F                       PIC X(9).
   566 01  WS-ELCERT-KEY.
   567     05  WS-ELCERT-COMPANY-CD    PIC X.
   568     05  WS-ELCERT-CARRIER       PIC X.
   569     05  WS-ELCERT-GROUP         PIC X(6).
   570     05  WS-ELCERT-STATE         PIC XX.
   571     05  WS-ELCERT-ACCOUNT       PIC X(10).
   572     05  WS-ELCERT-EFF-DT        PIC XX.
   573     05  WS-ELCERT-CERT-NO       PIC X(11).
   574 01  WS-ELCRTT-KEY.
   575     05  WS-ELCRTT-PRIMARY       PIC X(33).
   576     05  WS-ELCRTT-REC-TYPE      PIC X(1).
   577
   578 01  WS-ERENDT-KEY.
   579     05  WS-ERENDT-COMPANY-CD    PIC X.
   580     05  WS-ERENDT-CARRIER       PIC X.
   581     05  WS-ERENDT-GROUP         PIC X(6).
   582     05  WS-ERENDT-STATE         PIC XX.
   583     05  WS-ERENDT-ACCOUNT       PIC X(10).
   584     05  WS-ERENDT-EFF-DT        PIC XX.
   585     05  WS-ERENDT-CERT-NO       PIC X(11).
   586     05  WS-ERENDT-REC-TYPE      PIC X.
   587     05  WS-ERENDT-SEQ-NO        PIC 9(4) BINARY.
   588
   589 01  WS-ERENDT-KEY-BY-ARCH.
   590     05  WS-ERENDT-COMPANY-CD-A1 PIC X.
   591     05  WS-ERENDT-ARCHIVE       PIC 9(8) BINARY.
   592 01  WS-ERCOMP-KEY.
   593     05  WS-ERCOMP-COMPANY-CD    PIC X.
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page  12
* NSRASBL.cbl
   594     05  WS-ERCOMP-CARRIER       PIC X.
   595     05  WS-ERCOMP-GROUP         PIC X(6).
   596     05  WS-ERCOMP-RESP-NO       PIC X(10).
   597     05  WS-ERCOMP-ACCOUNT       PIC X(10).
   598     05  WS-ERCOMP-REC-TYPE      PIC X.
   599 01  WS-ERMAIL-KEY.
   600     05  WS-ERMAIL-COMPANY-CD    PIC X.
   601     05  WS-ERMAIL-CARRIER       PIC X.
   602     05  WS-ERMAIL-GROUP         PIC X(6).
   603     05  WS-ERMAIL-STATE         PIC XX.
   604     05  WS-ERMAIL-ACCOUNT       PIC X(10).
   605     05  WS-ERMAIL-EFF-DT        PIC XX.
   606     05  WS-ERMAIL-CERT-NO       PIC X(11).
   607 01  WS-ERACCT-KEY.
   608     05  WS-ERACCT-COMPANY-CD    PIC X.
   609     05  WS-ERACCT-CARRIER       PIC X.
   610     05  WS-ERACCT-GROUP         PIC X(6).
   611     05  WS-ERACCT-STATE         PIC XX.
   612     05  WS-ERACCT-ACCOUNT       PIC X(10).
   613     05  WS-ERACCT-EXP-DT        PIC XX.
   614     05  FILLER                  PIC XXXX.
   615 01  WS-ELLETR-KEY.
   616     05  WS-ELLETR-COMPANY-CD    PIC X.
   617     05  WS-ELLETR-LETTER-ID     PIC X(12).
   618     05  WS-ELLETR-SEQ-NO        PIC S9(4) COMP VALUE +0.
   619 01  WS-ELCNTL-KEY.
   620     05  WS-ELCNTL-COMPANY-ID    PIC XXX.
   621     05  WS-ELCNTL-REC-TYPE      PIC X.
   622     05  WS-ELCNTL-GENL.
   623         10  WS-ELCNTL-STATE     PIC XX  VALUE SPACES.
   624         10  WS-ELCNTL-BEN-CD.
   625             15  F               PIC X.
   626             15  WS-ELCNTL-CARR  PIC X.
   627     05  WS-ELCNTL-SEQ-NO        PIC S9(4) COMP.
   628*                                COPY ELCDATE.
   629******************************************************************
   630*                                                                *
   631*                                                                *
   632*                            ELCDATE.                            *
   633*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   634*                            VMOD=2.003
   635*                                                                *
   636*                                                                *
   637*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   638*                 LENGTH = 200                                   *
   639******************************************************************
   640
   641 01  DATE-CONVERSION-DATA.
   642     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   643     12  DC-OPTION-CODE                PIC X.
   644         88  BIN-TO-GREG                VALUE ' '.
   645         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   646         88  EDIT-GREG-TO-BIN           VALUE '2'.
   647         88  YMD-GREG-TO-BIN            VALUE '3'.
   648         88  MDY-GREG-TO-BIN            VALUE '4'.
   649         88  JULIAN-TO-BIN              VALUE '5'.
   650         88  BIN-PLUS-ELAPSED           VALUE '6'.
   651         88  FIND-CENTURY               VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page  13
* NSRASBL.cbl
   652         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   653         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   654         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   655         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   656         88  JULIAN-TO-BIN-3            VALUE 'C'.
   657         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   658         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   659         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   660         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   661         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   662         88  CHECK-LEAP-YEAR            VALUE 'H'.
   663         88  BIN-3-TO-GREG              VALUE 'I'.
   664         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   665         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   666         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   667         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   668         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   669         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   670         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   671         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   672         88  THREE-CHARACTER-BIN
   673                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   674         88  GREGORIAN-TO-BIN
   675                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   676         88  BIN-TO-GREGORIAN
   677                  VALUES ' ' '1' 'I' '8' 'G'.
   678         88  JULIAN-TO-BINARY
   679                  VALUES '5' 'C' 'E' 'F'.
   680     12  DC-ERROR-CODE                 PIC X.
   681         88  NO-CONVERSION-ERROR        VALUE ' '.
   682         88  DATE-CONVERSION-ERROR
   683                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   684         88  DATE-IS-ZERO               VALUE '1'.
   685         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   686         88  DATE-IS-INVALID            VALUE '3'.
   687         88  DATE1-GREATER-DATE2        VALUE '4'.
   688         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   689         88  DATE-INVALID-OPTION        VALUE '9'.
   690         88  INVALID-CENTURY            VALUE 'A'.
   691         88  ONLY-CENTURY               VALUE 'B'.
   692         88  ONLY-LEAP-YEAR             VALUE 'C'.
   693         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   694     12  DC-END-OF-MONTH               PIC X.
   695         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   696     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   697         88  USE-NORMAL-PROCESS         VALUE ' '.
   698         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   699         88  ADJUST-UP-100-YRS          VALUE '2'.
   700     12  FILLER                        PIC X.
   701     12  DC-CONVERSION-DATES.
   702         16  DC-BIN-DATE-1             PIC XX.
   703         16  DC-BIN-DATE-2             PIC XX.
   704         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   705         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   706                       DC-GREG-DATE-1-EDIT.
   707             20  DC-EDIT1-MONTH        PIC 99.
   708             20  SLASH1-1              PIC X.
   709             20  DC-EDIT1-DAY          PIC 99.
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page  14
* NSRASBL.cbl
   710             20  SLASH1-2              PIC X.
   711             20  DC-EDIT1-YEAR         PIC 99.
   712         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   713         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   714                     DC-GREG-DATE-2-EDIT.
   715             20  DC-EDIT2-MONTH        PIC 99.
   716             20  SLASH2-1              PIC X.
   717             20  DC-EDIT2-DAY          PIC 99.
   718             20  SLASH2-2              PIC X.
   719             20  DC-EDIT2-YEAR         PIC 99.
   720         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   721         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   722                     DC-GREG-DATE-1-YMD.
   723             20  DC-YMD-YEAR           PIC 99.
   724             20  DC-YMD-MONTH          PIC 99.
   725             20  DC-YMD-DAY            PIC 99.
   726         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   727         16  DC-GREG-DATE-1-MDY-R REDEFINES
   728                      DC-GREG-DATE-1-MDY.
   729             20  DC-MDY-MONTH          PIC 99.
   730             20  DC-MDY-DAY            PIC 99.
   731             20  DC-MDY-YEAR           PIC 99.
   732         16  DC-GREG-DATE-1-ALPHA.
   733             20  DC-ALPHA-MONTH        PIC X(10).
   734             20  DC-ALPHA-DAY          PIC 99.
   735             20  FILLER                PIC XX.
   736             20  DC-ALPHA-CENTURY.
   737                 24 DC-ALPHA-CEN-N     PIC 99.
   738             20  DC-ALPHA-YEAR         PIC 99.
   739         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   740         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   741         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   742         16  DC-JULIAN-DATE            PIC 9(05).
   743         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   744                                       PIC 9(05).
   745         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   746             20  DC-JULIAN-YEAR        PIC 99.
   747             20  DC-JULIAN-DAYS        PIC 999.
   748         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   749         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   750         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   751     12  DATE-CONVERSION-VARIBLES.
   752         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   753         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   754             20  FILLER                PIC 9(3).
   755             20  HOLD-CEN-1-CCYY.
   756                 24  HOLD-CEN-1-CC     PIC 99.
   757                 24  HOLD-CEN-1-YY     PIC 99.
   758             20  HOLD-CEN-1-MO         PIC 99.
   759             20  HOLD-CEN-1-DA         PIC 99.
   760         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   761             20  HOLD-CEN-1-R-MO       PIC 99.
   762             20  HOLD-CEN-1-R-DA       PIC 99.
   763             20  HOLD-CEN-1-R-CCYY.
   764                 24  HOLD-CEN-1-R-CC   PIC 99.
   765                 24  HOLD-CEN-1-R-YY   PIC 99.
   766             20  FILLER                PIC 9(3).
   767         16  HOLD-CENTURY-1-X.
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page  15
* NSRASBL.cbl
   768             20  FILLER                PIC X(3)  VALUE SPACES.
   769             20  HOLD-CEN-1-X-CCYY.
   770                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   771                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   772             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   773             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   774         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   775             20  HOLD-CEN-1-R-X-MO     PIC XX.
   776             20  HOLD-CEN-1-R-X-DA     PIC XX.
   777             20  HOLD-CEN-1-R-X-CCYY.
   778                 24  HOLD-CEN-1-R-X-CC PIC XX.
   779                 24  HOLD-CEN-1-R-X-YY PIC XX.
   780             20  FILLER                PIC XXX.
   781         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   782         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   783         16  DC-JULIAN-DATE-1          PIC 9(07).
   784         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   785             20  DC-JULIAN-1-CCYY.
   786                 24  DC-JULIAN-1-CC    PIC 99.
   787                 24  DC-JULIAN-1-YR    PIC 99.
   788             20  DC-JULIAN-DA-1        PIC 999.
   789         16  DC-JULIAN-DATE-2          PIC 9(07).
   790         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   791             20  DC-JULIAN-2-CCYY.
   792                 24  DC-JULIAN-2-CC    PIC 99.
   793                 24  DC-JULIAN-2-YR    PIC 99.
   794             20  DC-JULIAN-DA-2        PIC 999.
   795         16  DC-GREG-DATE-A-EDIT.
   796             20  DC-EDITA-MONTH        PIC 99.
   797             20  SLASHA-1              PIC X VALUE '/'.
   798             20  DC-EDITA-DAY          PIC 99.
   799             20  SLASHA-2              PIC X VALUE '/'.
   800             20  DC-EDITA-CCYY.
   801                 24  DC-EDITA-CENT     PIC 99.
   802                 24  DC-EDITA-YEAR     PIC 99.
   803         16  DC-GREG-DATE-B-EDIT.
   804             20  DC-EDITB-MONTH        PIC 99.
   805             20  SLASHB-1              PIC X VALUE '/'.
   806             20  DC-EDITB-DAY          PIC 99.
   807             20  SLASHB-2              PIC X VALUE '/'.
   808             20  DC-EDITB-CCYY.
   809                 24  DC-EDITB-CENT     PIC 99.
   810                 24  DC-EDITB-YEAR     PIC 99.
   811         16  DC-GREG-DATE-CYMD         PIC 9(08).
   812         16  DC-GREG-DATE-CYMD-R REDEFINES
   813                              DC-GREG-DATE-CYMD.
   814             20  DC-CYMD-CEN           PIC 99.
   815             20  DC-CYMD-YEAR          PIC 99.
   816             20  DC-CYMD-MONTH         PIC 99.
   817             20  DC-CYMD-DAY           PIC 99.
   818         16  DC-GREG-DATE-MDCY         PIC 9(08).
   819         16  DC-GREG-DATE-MDCY-R REDEFINES
   820                              DC-GREG-DATE-MDCY.
   821             20  DC-MDCY-MONTH         PIC 99.
   822             20  DC-MDCY-DAY           PIC 99.
   823             20  DC-MDCY-CEN           PIC 99.
   824             20  DC-MDCY-YEAR          PIC 99.
   825    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page  16
* NSRASBL.cbl
   826        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   827    12  DC-EL310-DATE                  PIC X(21).
   828    12  FILLER                         PIC X(28).
   829*                                COPY NSCASEXTR.
   830******************************************************************
   831*                                                                *
   832*                                                                *
   833*                            NSCASEXTR.                          *
   834*                            VMOD=2.001                          *
   835*                                                                *
   836*   FILE DESCRIPTION = NAPERSOFT ADMIN SERVICES EXTRACT FILE     *
   837*                                                                *
   838*   FILE TYPE = VSAM,KSDS                                        *
   839*   RECORD SIZE = 4500 RECFORM = FIXED                           *
   840*                                                                *
   841*   BASE CLUSTER = NSASEXTR                       RKP=0,LEN=07   *
   842*                                                                *
   843*   LOG = NO                                                     *
   844*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   845******************************************************************
   846*-----------------------------------------------------------------
   847*                   C H A N G E   L O G
   848*
   849* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   850*-----------------------------------------------------------------
   851*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   852* EFFECTIVE    NUMBER
   853*-----------------------------------------------------------------
   854* 072211    2011022800001  PEMA  NEW FILE
   855*-----------------------------------------------------------------
   856 01 NSAS-EXTRACT-RECORD.
   857    05  NSAS-CONTROL-PRIMARY.
   858        10  NSAS-COMPANY-CD      PIC X.
   859        10  NSAS-ARCHIVE-NO      PIC 9(8) BINARY.
   860        10  NSAS-SEQ-NO          PIC 9(4) BINARY.
   861    05  NSAS-LETTER-VARIABLES    PIC X(4350).
   862    05  FILLER                   PIC X(143).
   863*                                COPY ERCPNDB.
   864******************************************************************
   865*                                                                *
   866*                                                                *
   867*                            ERCPNDB.                            *
   868*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   869*                            VMOD=2.025                          *
   870*                                                                *
   871*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
   872*                                                                *
   873******************************************************************
   874*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
   875*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
   876******************************************************************
   877*                                                                *
   878*                                                                *
   879*   FILE TYPE = VSAM,KSDS                                        *
   880*   RECORD SIZE = 585  RECFORM = FIXED                           *
   881*                                                                *
   882*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
   883*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page  17
* NSRASBL.cbl
   884*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
   885*                                                 RKP=13,LEN=36  *
   886*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
   887*                                      AND CHG-SEQ.)             *
   888*                                                RKP=49,LEN=11   *
   889*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
   890*                                      AND CHG-SEQ.)             *
   891*                                                RKP=60,LEN=15   *
   892*                                                                *
   893*   LOG = NO                                                     *
   894*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   895******************************************************************
   896******************************************************************
   897*                   C H A N G E   L O G
   898*
   899* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   900*-----------------------------------------------------------------
   901*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   902* EFFECTIVE    NUMBER
   903*-----------------------------------------------------------------
   904* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
   905* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
   906* 011904                   PEMA  ADD TOTAL FEE PROCESSING
   907* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   908* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
   909* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
   910* 032306                   PEMA  ADD BOW LOAN NUMBER
   911* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
   912* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
   913* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
   914* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
   915* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
   916* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
   917* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   918* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
   919* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
   920******************************************************************
   921
   922 01  PENDING-BUSINESS.
   923     12  PB-RECORD-ID                     PIC XX.
   924         88  VALID-PB-ID                        VALUE 'PB'.
   925
   926     12  PB-CONTROL-PRIMARY.
   927         16  PB-COMPANY-CD                PIC X.
   928         16  PB-ENTRY-BATCH               PIC X(6).
   929         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
   930         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
   931
   932     12  PB-CONTROL-BY-ACCOUNT.
   933         16  PB-COMPANY-CD-A1             PIC X.
   934         16  PB-CARRIER                   PIC X.
   935         16  PB-GROUPING.
   936             20  PB-GROUPING-PREFIX       PIC XXX.
   937             20  PB-GROUPING-PRIME        PIC XXX.
   938         16  PB-STATE                     PIC XX.
   939         16  PB-ACCOUNT.
   940             20  PB-ACCOUNT-PREFIX        PIC X(4).
   941             20  PB-ACCOUNT-PRIME         PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page  18
* NSRASBL.cbl
   942         16  PB-CERT-EFF-DT               PIC XX.
   943         16  PB-CERT-NO.
   944             20  PB-CERT-PRIME            PIC X(10).
   945             20  PB-CERT-SFX              PIC X.
   946         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
   947
   948         16  PB-RECORD-TYPE               PIC X.
   949             88  PB-MAILING-DATA                VALUE '0'.
   950             88  PB-ISSUE                       VALUE '1'.
   951             88  PB-CANCELLATION                VALUE '2'.
   952             88  PB-BATCH-TRAILER               VALUE '9'.
   953
   954     12  PB-CONTROL-BY-ORIG-BATCH.
   955         16  PB-ORIGINAL-COMPANY-CD       PIC X.
   956         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
   957         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
   958         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
   959
   960     12  PB-CONTROL-BY-CSR.
   961         16  PB-CSR-COMPANY-CD            PIC X.
   962         16  PB-CSR-ID                    PIC X(4).
   963         16  PB-CSR-ENTRY-BATCH           PIC X(6).
   964         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
   965         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
   966******************************************************************
   967*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
   968******************************************************************
   969
   970     12  PB-LAST-MAINT-DT                 PIC XX.
   971     12  PB-LAST-MAINT-BY                 PIC X(4).
   972     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
   973
   974     12  PB-RECORD-BODY                   PIC X(375).
   975
   976     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
   977         16  PB-CERT-ORIGIN               PIC X.
   978             88  CLASIC-CREATED-CERT         VALUE '1'.
   979         16  PB-I-NAME.
   980             20  PB-I-INSURED-LAST-NAME   PIC X(15).
   981             20  PB-I-INSURED-FIRST-NAME.
   982                 24  PB-I-INSURED-1ST-INIT PIC X.
   983                 24  FILLER                PIC X(9).
   984             20  PB-I-INSURED-MIDDLE-INIT PIC X.
   985         16  PB-I-AGE                     PIC S99   COMP-3.
   986         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
   987         16  PB-I-BIRTHDAY                PIC XX.
   988         16  PB-I-INSURED-SEX             PIC X.
   989             88  PB-SEX-MALE     VALUE 'M'.
   990             88  PB-SEX-FEMALE   VALUE 'F'.
   991
   992         16  PB-I-LF-TERM                 PIC S999   COMP-3.
   993         16  PB-I-AH-TERM                 PIC S999   COMP-3.
   994         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
   995         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
   996         16  PB-I-SKIP-CODE               PIC X.
   997             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
   998             88  PB-SKIP-JULY              VALUE '1'.
   999             88  PB-SKIP-AUGUST            VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page  19
* NSRASBL.cbl
  1000             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  1001             88  PB-SKIP-JULY-AUG          VALUE '4'.
  1002             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  1003             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  1004             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  1005             88  PB-SKIP-JUNE              VALUE '8'.
  1006             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  1007             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  1008             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  1009         16  PB-I-TERM-TYPE               PIC X.
  1010             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  1011             88  PB-PAID-WEEKLY            VALUE 'W'.
  1012             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  1013             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  1014             88  PB-PAID-13-YEARLY         VALUE 'T'.
  1015         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  1016         16  PB-I-POLICY-FORM-NO          PIC X(12).
  1017         16  PB-I-DATA-ENTRY-SW           PIC X.
  1018             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  1019             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  1020             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  1021             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  1022         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  1023         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  1024*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  1025         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  1026         16  FILLER                       PIC X.
  1027
  1028         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  1029             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  1030             88  PB-INVALID-LIFE             VALUE '  ' '00'
  1031                                                   '90' THRU '99'.
  1032         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  1033                                          PIC XX.
  1034         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  1035         16  PB-I-AMOUNT-FINANCED REDEFINES
  1036                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  1037         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  1038         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  1039                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  1040         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  1041         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  1042         16  PB-I-CLP-AMOUNT REDEFINES
  1043                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  1044         16  PB-I-LF-CALC-FLAG            PIC X.
  1045             88 PB-COMP-LF-PREM               VALUE '?'.
  1046         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  1047         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  1048         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  1049         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  1050         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  1051         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  1052         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  1053         16  PB-I-LF-ABBR                 PIC XXX.
  1054         16  PB-I-LF-INPUT-CD             PIC XX.
  1055
  1056         16  PB-I-AH-BENEFIT-CD           PIC XX.
  1057             88  PB-VALID-AH                 VALUE '01' THRU '89'.
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page  20
* NSRASBL.cbl
  1058             88  PB-INVALID-AH               VALUE '  ' '00'
  1059                                                   '90' THRU '99'.
  1060         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  1061         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  1062         16  PB-I-AH-CALC-FLAG            PIC X.
  1063             88 PB-COMP-AH-PREM                  VALUE '?'.
  1064         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  1065         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  1066         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  1067         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  1068         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  1069         16  PB-I-AH-ABBR                 PIC XXX.
  1070         16  PB-I-AH-INPUT-CD             PIC XXX.
  1071
  1072         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  1073         16  PB-I-REIN-TABLE              PIC XXX.
  1074         16  PB-I-BUSINESS-TYPE           PIC 99.
  1075         16  PB-I-INDV-GRP-CD             PIC X.
  1076         16  PB-I-MORT-CODE.
  1077             20  PB-I-TABLE               PIC X.
  1078             20  PB-I-INTEREST            PIC XX.
  1079             20  PB-I-MORT-TYP            PIC X.
  1080         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  1081         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  1082         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  1083         16  PB-I-INDV-GRP-OVRD           PIC X.
  1084         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  1085         16  PB-I-SIG-SW                  PIC X.
  1086             88  PB-POLICY-SIGNED             VALUE 'Y'.
  1087         16  PB-I-RATE-CLASS              PIC XX.
  1088         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  1089         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  1090         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  1091         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  1092         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  1093         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  1094         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  1095         16  PB-I-BENEFIT-TYPE            PIC XXX.
  1096         16  PB-I-OB-FLAG                 PIC X.
  1097             88  PB-I-OB                      VALUE 'B'.
  1098             88  PB-I-SUMMARY                 VALUE 'Z'.
  1099         16  PB-I-ENTRY-STATUS            PIC X.
  1100             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  1101                                              'M' '5' '9' '2'.
  1102             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  1103             88  PB-I-POLICY-PENDING          VALUE '2'.
  1104             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  1105             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  1106             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
  1107             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  1108             88  PB-I-REIN-ONLY               VALUE '9'.
  1109             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  1110             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  1111             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  1112             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  1113         16  PB-I-INT-CODE                PIC X.
  1114             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  1115             88  PB-SIMPLE-INTEREST           VALUE 'S'.
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page  21
* NSRASBL.cbl
  1116         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  1117         16  PB-I-SOC-SEC-NO              PIC X(11).
  1118         16  PB-I-MEMBER-NO               PIC X(12).
  1119         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  1120*        16  PB-I-LOAN-OFFICER            PIC XXX.
  1121         16  PB-I-OLD-LOF                 PIC XXX.
  1122         16  PB-I-LF-EXPIRE-DT            PIC XX.
  1123         16  PB-I-AH-EXPIRE-DT            PIC XX.
  1124         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  1125         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  1126         16  PB-I-LIFE-INDICATOR          PIC X.
  1127             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  1128         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  1129         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  1130                                          PIC S9(5)V99    COMP-3.
  1131         16  PB-I-MAIL-ADDRS-SW           PIC X.
  1132             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  1133             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  1134         16  PB-I-1ST-PMT-DT              PIC XX.
  1135         16  PB-I-JOINT-INSURED.
  1136             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  1137             20 PB-I-JOINT-FIRST-NAME.
  1138                24  PB-I-JOINT-FIRST-INIT PIC X.
  1139                24  FILLER                PIC X(9).
  1140             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  1141*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  1142         16  PB-I-BENEFICIARY-NAME.
  1143             20  PB-I-BANK-NUMBER         PIC X(10).
  1144             20  FILLER                   PIC X(15).
  1145         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  1146         16  PB-I-REFERENCE               PIC X(12).
  1147         16  FILLER REDEFINES PB-I-REFERENCE.
  1148             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  1149             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  1150             20  PB-I-CLP-STATE           PIC XX.
  1151         16  PB-I-UNDERWRITING-STATUS     PIC X.
  1152             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  1153             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  1154             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  1155         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  1156         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  1157         16  PB-I-RESIDENT-STATE          PIC XX.
  1158         16  PB-I-RATE-CODE               PIC X(4).
  1159         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  1160         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  1161         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  1162         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  1163         16  PB-I-BANK-NOCHRGB            PIC 99.
  1164         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  1165         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  1166
  1167     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  1168         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  1169             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  1170         16  PB-C-CANCEL-ORIGIN           PIC X.
  1171             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  1172         16  PB-C-LF-CANCEL-DT            PIC XX.
  1173         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page  22
* NSRASBL.cbl
  1174         16  PB-C-LF-CALC-REQ             PIC X.
  1175             88 PB-COMP-LF-CANCEL            VALUE '?'.
  1176         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  1177         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  1178         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  1179             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  1180         16  PB-C-AH-CANCEL-DT            PIC XX.
  1181         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  1182         16  PB-C-AH-CALC-REQ             PIC X.
  1183             88 PB-COMP-AH-CANCEL            VALUE '?'.
  1184         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  1185         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  1186         16  PB-C-LAST-NAME               PIC X(15).
  1187         16  PB-C-REFUND-SW               PIC X.
  1188             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  1189             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  1190         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  1191         16  PB-C-PAYEE-CODE              PIC X(6).
  1192         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  1193         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  1194         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  1195         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  1196         16  PB-C-REFERENCE               PIC X(12).
  1197         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  1198         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  1199         16  PB-C-POST-CARD-IND           PIC X.
  1200         16  PB-C-CANCEL-REASON           PIC X.
  1201         16  PB-C-REF-INTERFACE-SW        PIC X.
  1202         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  1203         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  1204         16  FILLER                       PIC X(01).
  1205*        16  FILLER                       PIC X(18).
  1206         16  PB-C-POLICY-FORM-NO          PIC X(12).
  1207*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  1208         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  1209         16  PB-CANCELED-CERT-DATA.
  1210             20  PB-CI-INSURED-NAME.
  1211                 24  PB-CI-LAST-NAME      PIC X(15).
  1212                 24  PB-CI-INITIALS       PIC XX.
  1213             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  1214             20  PB-CI-INSURED-SEX        PIC X.
  1215             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  1216             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  1217             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  1218             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  1219             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  1220             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  1221             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  1222             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  1223             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  1224             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  1225             20  PB-CI-RATE-CLASS         PIC XX.
  1226             20  PB-CI-RATE-DEV-LF        PIC XXX.
  1227             20  PB-CI-RATE-DEV-AH        PIC XXX.
  1228             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  1229             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  1230             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  1231             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page  23
* NSRASBL.cbl
  1232             20  PB-CI-LF-ABBR            PIC X(3).
  1233             20  PB-CI-AH-ABBR            PIC X(3).
  1234             20  PB-CI-OB-FLAG            PIC X.
  1235                 88  PB-CI-OB                VALUE 'B'.
  1236             20  PB-CI-LF-POLICY-STATUS   PIC X.
  1237                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  1238                                           'M' '4' '5' '9' '2'.
  1239                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  1240                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  1241                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  1242                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  1243                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  1244                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  1245                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  1246                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  1247                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  1248                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  1249                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  1250                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  1251                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  1252             20  PB-CI-AH-POLICY-STATUS   PIC X.
  1253                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  1254                                           'M' '4' '5' '9' '2'.
  1255                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  1256                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  1257                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  1258                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  1259                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  1260                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  1261                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  1262                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  1263                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  1264                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  1265                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  1266                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  1267                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  1268             20  PB-CI-PAY-FREQUENCY      PIC 99.
  1269             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  1270             20  PB-CI-SOC-SEC-NO         PIC X(11).
  1271             20  PB-CI-MEMBER-NO          PIC X(12).
  1272             20  PB-CI-INT-CODE           PIC X.
  1273                 88  PB-CI-ADD-ON                  VALUE 'A'.
  1274                 88  PB-CI-SIMPLE                  VALUE 'S'.
  1275             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  1276             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  1277             20  PB-CI-COMP-EXCP-SW       PIC X.
  1278                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  1279                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  1280             20  PB-CI-ENTRY-STATUS       PIC X.
  1281             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  1282             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  1283             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  1284             20  PB-CI-DEATH-DT           PIC XX.
  1285             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  1286             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  1287             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  1288             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  1289             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page  24
* NSRASBL.cbl
  1290             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  1291             20  PB-CI-ENTRY-DT              PIC XX.
  1292             20  PB-CI-ENTRY-BATCH           PIC X(6).
  1293             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  1294             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  1295             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  1296             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  1297             20  PB-CI-OLD-LOF               PIC XXX.
  1298*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  1299             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  1300             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  1301             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  1302             20  PB-CI-INDV-GRP-CD           PIC X.
  1303             20  PB-CI-BENEFICIARY-NAME.
  1304                 24  PB-CI-BANK-NUMBER       PIC X(10).
  1305                 24  FILLER                  PIC X(15).
  1306             20  PB-CI-NOTE-SW               PIC X.
  1307             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  1308             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  1309             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  1310             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  1311             20  PB-CI-LOAN-OFFICER          PIC X(5).
  1312             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  1313             20  PB-CI-FIRST-NAME            PIC X(10).
  1314             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  1315
  1316         16  FILLER                       PIC X(13).
  1317*032306  16  FILLER                       PIC X(27).
  1318*        16  FILLER                       PIC X(46).
  1319
  1320     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  1321         16  FILLER                       PIC X(10).
  1322         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  1323         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  1324         16  PB-M-INSURED-MID-INIT        PIC X.
  1325         16  PB-M-INSURED-AGE             PIC 99.
  1326         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  1327         16  PB-M-INSURED-SEX             PIC X.
  1328         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  1329         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  1330         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  1331         16  PB-M-INSURED-CITY-STATE.
  1332             20  PB-M-INSURED-CITY        PIC X(28).
  1333             20  PB-M-INSURED-STATE       PIC XX.
  1334         16  PB-M-INSURED-ZIP-CODE.
  1335             20  PB-M-INSURED-ZIP-PRIME.
  1336                 24  PB-M-INSURED-ZIP-1   PIC X.
  1337                     88  PB-M-CANADIAN-POST-CODE
  1338                                             VALUE 'A' THRU 'Z'.
  1339                 24  FILLER               PIC X(4).
  1340             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  1341         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  1342                                        PB-M-INSURED-ZIP-CODE.
  1343             20  PM-M-INS-CAN-POST1       PIC XXX.
  1344             20  PM-M-INS-CAN-POST2       PIC XXX.
  1345             20  FILLER                   PIC XXX.
  1346         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  1347         16  PB-M-JOINT-BIRTHDAY          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page  25
* NSRASBL.cbl
  1348         16  PB-M-CRED-BENE-NAME          PIC X(30).
  1349         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  1350         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  1351         16  PB-M-CRED-BENE-CITYST.
  1352             20  PB-M-CRED-BENE-CITY      PIC X(28).
  1353             20  PB-M-CRED-BENE-STATE     PIC XX.
  1354         16  FILLER                       PIC X(92).
  1355
  1356     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  1357         16  FILLER                       PIC X(10).
  1358         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  1359         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  1360         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  1361         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  1362         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  1363         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  1364         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  1365         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  1366         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  1367         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  1368         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  1369         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  1370         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  1371         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  1372         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  1373         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  1374         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  1375         16  PB-ACCOUNT-NAME              PIC X(30).
  1376         16  PB-PREM-REF-RPT-FLAG         PIC X.
  1377         16  PB-REFERENCE                 PIC X(12).
  1378         16  PB-B-RECEIVED-DT             PIC XX.
  1379         16  FILLER                       PIC X(234).
  1380
  1381     12  PB-RECORD-STATUS.
  1382         16  PB-CREDIT-SELECT-DT          PIC XX.
  1383         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  1384         16  PB-BILLED-DT                 PIC XX.
  1385         16  PB-BILLING-STATUS            PIC X.
  1386             88  PB-ENTRY-REVERSED            VALUE 'R'.
  1387             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  1388             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  1389         16  PB-RECORD-BILL               PIC X.
  1390             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  1391             88  PB-RECORD-RETURNED           VALUE 'R'.
  1392             88  PB-RECORD-ENDORSED           VALUE 'E'.
  1393             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  1394             88  PB-OVERRIDE-AH               VALUE 'A'.
  1395             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  1396         16  PB-BATCH-ENTRY               PIC X.
  1397             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  1398             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  1399             88  PB-REISSUED-CERT             VALUE 'E'.
  1400             88  PB-CASH-CERT                 VALUE 'C'.
  1401             88  PB-MONTHLY-CERT              VALUE 'M'.
  1402             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  1403             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  1404             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  1405         16  PB-FORCE-CODE                PIC X.
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page  26
* NSRASBL.cbl
  1406             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  1407             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  1408             88  PB-CANCEL-FORCE              VALUE '8'.
  1409             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  1410             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  1411             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  1412             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  1413             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  1414             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  1415             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  1416         16  PB-FATAL-FLAG                PIC X.
  1417             88  PB-FATAL-ERRORS              VALUE 'X'.
  1418         16  PB-FORCE-ER-CD               PIC X.
  1419             88  PB-FORCE-ERRORS              VALUE 'F'.
  1420             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  1421         16  PB-WARN-ER-CD                PIC X.
  1422             88  PB-WARNING-ERRORS            VALUE 'W'.
  1423         16  FILLER                       PIC X.
  1424         16  PB-OUT-BAL-CD                PIC X.
  1425             88  PB-OUT-OF-BAL                VALUE 'O'.
  1426         16  PB-LIFE-OVERRIDE-L1          PIC X.
  1427         16  PB-AH-OVERRIDE-L1            PIC X.
  1428         16  PB-INPUT-DT                  PIC XX.
  1429         16  PB-INPUT-BY                  PIC X(4).
  1430         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  1431         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  1432         16  PB-TOLERANCE-REJECT-SW       PIC X.
  1433         16  PB-LF-EARNING-METHOD         PIC X.
  1434         16  PB-AH-EARNING-METHOD         PIC X.
  1435         16  PB-LF-TERM-CALC-METHOD       PIC X.
  1436         16  PB-AH-TERM-CALC-METHOD       PIC X.
  1437         16  PB-REIN-CD                   PIC XXX.
  1438         16  PB-LF-REFUND-TYPE            PIC X.
  1439         16  PB-AH-REFUND-TYPE            PIC X.
  1440         16  PB-ACCT-EFF-DT               PIC XX.
  1441         16  PB-ACCT-EXP-DT               PIC XX.
  1442         16  PB-COMPANY-ID                PIC X(3).
  1443         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  1444         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  1445         16  PB-SV-CARRIER                PIC X.
  1446         16  PB-SV-GROUPING               PIC X(6).
  1447         16  PB-SV-STATE                  PIC XX.
  1448         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  1449         16  PB-GA-BILLING-INFO.
  1450             20  PB-GA-BILL-DT OCCURS 5 TIMES
  1451                                          PIC XX.
  1452         16  PB-SV-REMIT-TO  REDEFINES
  1453             PB-GA-BILLING-INFO           PIC X(10).
  1454         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  1455         16  PB-I-LOAN-OFFICER            PIC X(5).
  1456         16  PB-I-VIN                     PIC X(17).
  1457
  1458         16  FILLER                       PIC X(04).
  1459         16  IMNET-BYPASS-SW              PIC X.
  1460
  1461******************************************************************
  1462*                COMMON EDIT ERRORS                              *
  1463******************************************************************
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page  27
* NSRASBL.cbl
  1464
  1465     12  PB-COMMON-ERRORS.
  1466         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  1467                                           PIC S9(4)     COMP.
  1468
  1469******************************************************************
  1470*                                COPY ERCENDT.
  1471******************************************************************
  1472*                                                                *
  1473*                                                                *
  1474*                            ERCENDT.                            *
  1475*                            VMOD=2.001                          *
  1476*                                                                *
  1477*   FILE DESCRIPTION = ENDORSEMENT FILE                          *
  1478*                                                                *
  1479*   FILE TYPE = VSAM,KSDS                                        *
  1480*   RECORD SIZE = 579  RECFORM = FIXED                           *
  1481*                                                                *
  1482*   BASE CLUSTER = ERENDT                         RKP=02,LEN=36  *
  1483*       ALTERNATE PATH1 = ERENDT2 (BY ARCH NO)    RKP=38,LEN=05  *
  1484*                                                                *
  1485*   LOG = NO                                                     *
  1486*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1487******************************************************************
  1488*-----------------------------------------------------------------
  1489*                   C H A N G E   L O G
  1490*
  1491* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1492*-----------------------------------------------------------------
  1493*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1494* EFFECTIVE    NUMBER
  1495*-----------------------------------------------------------------
  1496* 052307    2006052600001  AJRA  ADDED FLAG FOR CANCELS ON CERTS
  1497*                                WITH OPEN CLAIMS
  1498* 072312    2011022800001  AJRA  ADDED BATCH NUMBER
  1499* 110612    2012101700002  AJRA  ADD NEW FIELDS
  1500* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  1501* 010616  CR2015082000001  PEMA  ADD ENDORSEMENT CHECK PROCESSING
  1502*-----------------------------------------------------------------
  1503 01  ENDORSEMENT-RECORD.
  1504     12  EN-RECORD-ID                PIC XX.
  1505         88  VALID-EN-ID                VALUE 'EN'.
  1506     12  EN-CONTROL-PRIMARY.
  1507         16  EN-COMPANY-CD           PIC X.
  1508         16  EN-CARRIER              PIC X.
  1509         16  EN-GROUPING             PIC X(6).
  1510         16  EN-STATE                PIC XX.
  1511         16  EN-ACCOUNT              PIC X(10).
  1512         16  EN-CERT-EFF-DT          PIC XX.
  1513         16  EN-CERT-NO.
  1514             20  EN-CERT-PRIME       PIC X(10).
  1515             20  EN-CERT-SFX         PIC X.
  1516         16  EN-REC-TYPE             PIC X.
  1517             88  EN-ISSUE               VALUE 'I'.
  1518             88  EN-CANCELLATION        VALUE 'C'.
  1519         16  EN-SEQ-NO               PIC 9(04) BINARY.
  1520     12  EN-CONTROL-BY-ARCH-NO.
  1521         16  EN-COMPANY-CD-A1              PIC X.
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page  28
* NSRASBL.cbl
  1522         16  EN-ARCHIVE-NO                 PIC 9(8) BINARY.
  1523     12  EN-LAST-MAINT-DT            PIC XX.
  1524     12  EN-LAST-MAINT-BY            PIC X(4).
  1525     12  EN-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  1526     12  EN-ENDORSEMENT-RECORD       PIC X(329).
  1527     12  EN-ISSUE-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  1528         16  EN-INS-ORIG-LAST-NAME   PIC X(15).
  1529         16  EN-INS-ORIG-FIRST-NAME  PIC X(10).
  1530         16  EN-INS-ORIG-MIDDLE-INIT PIC X.
  1531         16  EN-INS-ORIG-AGE         PIC S999     COMP-3.
  1532         16  EN-JNT-ORIG-LAST-NAME   PIC X(15).
  1533         16  EN-JNT-ORIG-FIRST-NAME  PIC X(10).
  1534         16  EN-JNT-ORIG-MIDDLE-INIT PIC X.
  1535         16  EN-JNT-ORIG-AGE         PIC S999     COMP-3.
  1536         16  EN-LF-ORIG-BENCD        PIC XX.
  1537         16  EN-LF-ORIG-TERM         PIC S999      COMP-3.
  1538         16  EN-LF-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  1539         16  EN-LF-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  1540         16  EN-LF-ORIG-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
  1541         16  EN-LF-ORIG-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
  1542         16  EN-LF-ORIG-EXP-DT       PIC XX.
  1543*        16  EN-LF-ORIG-COV-TYPE     PIC X(10).
  1544         16  EN-ORIG-CRED-BENE       PIC X(25).
  1545         16  EN-LF-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  1546         16  FILLER                  PIC X.
  1547         16  EN-AH-ORIG-BENCD        PIC XX.
  1548         16  EN-AH-ORIG-TERM         PIC S999      COMP-3.
  1549         16  EN-AH-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  1550         16  EN-AH-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  1551         16  EN-AH-ORIG-EXP-DT       PIC XX.
  1552*        16  EN-AH-ORIG-COV-TYPE     PIC X(10).
  1553*        16  EN-AH-ORIG-WAIT-PER     PIC 99.
  1554         16  EN-AH-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  1555         16  F                       PIC X(09).
  1556         16  EN-AH-ORIG-CP           PIC 99.
  1557         16  EN-INS-NEW-LAST-NAME    PIC X(15).
  1558         16  EN-INS-NEW-FIRST-NAME   PIC X(10).
  1559         16  EN-INS-NEW-MIDDLE-INIT  PIC X.
  1560         16  EN-INS-NEW-AGE          PIC S999     COMP-3.
  1561         16  EN-JNT-NEW-LAST-NAME    PIC X(15).
  1562         16  EN-JNT-NEW-FIRST-NAME   PIC X(10).
  1563         16  EN-JNT-NEW-MIDDLE-INIT  PIC X.
  1564         16  EN-JNT-NEW-AGE          PIC S999     COMP-3.
  1565         16  EN-LF-NEW-BENCD         PIC XX.
  1566         16  EN-LF-NEW-TERM          PIC S999      COMP-3.
  1567         16  EN-LF-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  1568         16  EN-LF-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  1569         16  EN-LF-NEW-ALT-BEN-AMT   PIC S9(9)V99  COMP-3.
  1570         16  EN-LF-NEW-ALT-PRM-AMT   PIC S9(7)V99  COMP-3.
  1571         16  EN-LF-NEW-EXP-DT        PIC XX.
  1572         16  EN-NEW-CRED-BENE        PIC X(25).
  1573         16  EN-LF-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  1574         16  FILLER                  PIC X.
  1575         16  EN-AH-NEW-BENCD         PIC XX.
  1576         16  EN-AH-NEW-TERM          PIC S999      COMP-3.
  1577         16  EN-AH-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  1578         16  EN-AH-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  1579         16  EN-AH-NEW-EXP-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page  29
* NSRASBL.cbl
  1580*        16  EN-AH-NEW-COV-TYPE      PIC X(10).
  1581*        16  EN-AH-NEW-WAIT-PER      PIC 99.
  1582*        16  F                       PIC X(12).
  1583         16  EN-AH-NEW-CP            PIC 99.
  1584         16  EN-SIG-SW               PIC X.
  1585         16  EN-AH-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  1586         16  EN-INS-ORIG-AGE-DEF-FLAG PIC X.
  1587         16  EN-JNT-ORIG-AGE-DEF-FLAG PIC X.
  1588         16  EN-INS-NEW-AGE-DEF-FLAG PIC X.
  1589         16  EN-JNT-NEW-AGE-DEF-FLAG PIC X.
  1590         16  FILLER                  PIC X(33).
  1591     12  EN-CANCEL-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  1592         16  EN-LF-ORIG-REF-DT       PIC XX.
  1593         16  EN-LF-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  1594         16  EN-AH-ORIG-REF-DT       PIC XX.
  1595         16  EN-AH-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  1596         16  EN-LF-NEW-REF-DT        PIC XX.
  1597         16  EN-LF-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  1598         16  EN-AH-NEW-REF-DT        PIC XX.
  1599         16  EN-AH-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  1600         16  EN-FLAG-CERT            PIC X.
  1601         16  EN-INS-LAST-NAME        PIC X(15).
  1602         16  EN-INS-FIRST-NAME       PIC X(10).
  1603         16  EN-INS-MIDDLE-INIT      PIC X.
  1604         16  EN-LF-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  1605         16  EN-AH-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  1606         16  EN-LF-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  1607         16  EN-AH-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  1608         16  FILLER                  PIC X(262).
  1609     12  EN-MONEY-SW             PIC X.
  1610     12  EN-HEALTH-APP           PIC X.
  1611     12  EN-VOUCHER-SW           PIC X.
  1612     12  EN-PAYEE                PIC X(14).
  1613     12  EN-INPUT-DT             PIC XX.
  1614     12  EN-PROCESS-DT           PIC XX.
  1615     12  EN-LF-COMMISSION        PIC SV9(5)    COMP-3.
  1616     12  EN-AH-COMMISSION        PIC SV9(5)    COMP-3.
  1617     12  EN-REASON-CODES.
  1618         16  F OCCURS 12.
  1619             20  EN-REASON-CODE  PIC X(4).
  1620     12  EN-TEMPLATE-USED        PIC X(8).
  1621     12  EN-DOCU-TYPE            PIC X.
  1622         88  EN-VERI-DOCU          VALUE 'V'.
  1623         88  EN-GCE-DOCU           VALUE 'G'.
  1624         88  EN-CANC-DOCU          VALUE 'C'.
  1625     12  EN-COMMENTS1            PIC X(13).
  1626     12  EN-COMMENTS2            PIC X(70).
  1627     12  EN-COMM-CHGBK           PIC X.
  1628         88  EN-DO-NOT-CHG-ACCT    VALUE 'N'.
  1629         88  EN-CHG-ACCT           VALUE 'Y'.
  1630     12  EN-CSO-PORTION          PIC S9(5)V99  COMP-3.
  1631     12  EN-ACCT-PORTION         PIC S9(5)V99  COMP-3.
  1632     12  EN-BATCH-NUMBER         PIC X(6).
  1633     12  EN-ACCT-SUMM            PIC X.
  1634     12  EN-CSO-SUMM             PIC X.
  1635     12  en-check-type           pic x.
  1636     12  FILLER                  PIC X(12).
  1637******************************************************************
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page  30
* NSRASBL.cbl
  1638*                                COPY ERCMAIL.
  1639******************************************************************
  1640*                                                                *
  1641*                                                                *
  1642*                            ERCMAIL                             *
  1643*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1644*                            VMOD=2.003                          *
  1645*                                                                *
  1646*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  1647*                                                                *
  1648*   FILE TYPE = VSAM,KSDS                                        *
  1649*   RECORD SIZE = 374   RECFORM = FIX                            *
  1650*                                                                *
  1651*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  1652*   ALTERNATE PATH    = NOT USED                                 *
  1653*                                                                *
  1654*   LOG = YES                                                    *
  1655*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1656******************************************************************
  1657*                   C H A N G E   L O G
  1658*
  1659* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1660*-----------------------------------------------------------------
  1661*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1662* EFFECTIVE    NUMBER
  1663*-----------------------------------------------------------------
  1664* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  1665* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  1666* 111108                   PEMA  ADD CRED BENE ADDR2
  1667******************************************************************
  1668
  1669 01  MAILING-DATA.
  1670     12  MA-RECORD-ID                      PIC XX.
  1671         88  VALID-MA-ID                       VALUE 'MA'.
  1672
  1673     12  MA-CONTROL-PRIMARY.
  1674         16  MA-COMPANY-CD                 PIC X.
  1675         16  MA-CARRIER                    PIC X.
  1676         16  MA-GROUPING.
  1677             20  MA-GROUPING-PREFIX        PIC XXX.
  1678             20  MA-GROUPING-PRIME         PIC XXX.
  1679         16  MA-STATE                      PIC XX.
  1680         16  MA-ACCOUNT.
  1681             20  MA-ACCOUNT-PREFIX         PIC X(4).
  1682             20  MA-ACCOUNT-PRIME          PIC X(6).
  1683         16  MA-CERT-EFF-DT                PIC XX.
  1684         16  MA-CERT-NO.
  1685             20  MA-CERT-PRIME             PIC X(10).
  1686             20  MA-CERT-SFX               PIC X.
  1687
  1688     12  FILLER                            PIC XX.
  1689
  1690     12  MA-ACCESS-CONTROL.
  1691         16  MA-SOURCE-SYSTEM              PIC XX.
  1692             88  MA-FROM-CREDIT                VALUE 'CR'.
  1693             88  MA-FROM-VSI                   VALUE 'VS'.
  1694             88  MA-FROM-WARRANTY              VALUE 'WA'.
  1695             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page  31
* NSRASBL.cbl
  1696         16  MA-RECORD-ADD-DT              PIC XX.
  1697         16  MA-RECORD-ADDED-BY            PIC XXXX.
  1698         16  MA-LAST-MAINT-DT              PIC XX.
  1699         16  MA-LAST-MAINT-BY              PIC XXXX.
  1700         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  1701
  1702     12  MA-PROFILE-INFO.
  1703         16  MA-QUALIFY-CODE-1             PIC XX.
  1704         16  MA-QUALIFY-CODE-2             PIC XX.
  1705         16  MA-QUALIFY-CODE-3             PIC XX.
  1706         16  MA-QUALIFY-CODE-4             PIC XX.
  1707         16  MA-QUALIFY-CODE-5             PIC XX.
  1708
  1709         16  MA-INSURED-LAST-NAME          PIC X(15).
  1710         16  MA-INSURED-FIRST-NAME         PIC X(10).
  1711         16  MA-INSURED-MIDDLE-INIT        PIC X.
  1712         16  MA-INSURED-ISSUE-AGE          PIC 99.
  1713         16  MA-INSURED-BIRTH-DT           PIC XX.
  1714         16  MA-INSURED-SEX                PIC X.
  1715             88  MA-SEX-MALE                   VALUE 'M'.
  1716             88  MA-SEX-FEMALE                 VALUE 'F'.
  1717         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  1718
  1719         16  MA-ADDRESS-CORRECTED          PIC X.
  1720         16  MA-JOINT-BIRTH-DT             PIC XX.
  1721*        16  FILLER                        PIC X(12).
  1722
  1723         16  MA-ADDRESS-LINE-1             PIC X(30).
  1724         16  MA-ADDRESS-LINE-2             PIC X(30).
  1725         16  MA-CITY-STATE.
  1726             20  MA-CITY                   PIC X(28).
  1727             20  MA-ADDR-STATE             PIC XX.
  1728         16  MA-ZIP.
  1729             20  MA-ZIP-CODE.
  1730                 24  MA-ZIP-CODE-1ST       PIC X(1).
  1731                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  1732                 24  FILLER                PIC X(4).
  1733             20  MA-ZIP-PLUS4              PIC X(4).
  1734         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  1735             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  1736             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  1737             20  FILLER                    PIC X(3).
  1738
  1739         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  1740
  1741         16  FILLER                        PIC XXX.
  1742*        16  FILLER                        PIC X(10).
  1743
  1744     12  MA-CRED-BENE-INFO.
  1745         16  MA-CRED-BENE-NAME                 PIC X(25).
  1746         16  MA-CRED-BENE-ADDR                 PIC X(30).
  1747         16  MA-CRED-BENE-ADDR2                PIC X(30).
  1748         16  MA-CRED-BENE-CTYST.
  1749             20  MA-CRED-BENE-CITY             PIC X(28).
  1750             20  MA-CRED-BENE-STATE            PIC XX.
  1751         16  MA-CRED-BENE-ZIP.
  1752             20  MA-CB-ZIP-CODE.
  1753                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page  32
* NSRASBL.cbl
  1754                     88  MA-CB-CANADIAN-POST-CODE
  1755                                           VALUE 'A' THRU 'Z'.
  1756                 24  FILLER                    PIC X(4).
  1757             20  MA-CB-ZIP-PLUS4               PIC X(4).
  1758         16  MA-CB-CANADIAN-POSTAL-CODE
  1759                            REDEFINES MA-CRED-BENE-ZIP.
  1760             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  1761             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  1762             20  FILLER                        PIC X(3).
  1763     12  MA-POST-CARD-MAIL-DATA.
  1764         16  MA-MAIL-DATA OCCURS 7.
  1765             20  MA-MAIL-TYPE              PIC X.
  1766                 88  MA-12MO-MAILING           VALUE '1'.
  1767                 88  MA-EXP-MAILING            VALUE '2'.
  1768             20  MA-MAIL-STATUS            PIC X.
  1769                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  1770                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  1771                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  1772             20  MA-MAIL-DATE              PIC XX.
  1773     12  FILLER                            PIC XX.
  1774     12  FILLER                            PIC XX.
  1775*    12  FILLER                            PIC X(30).
  1776******************************************************************
  1777*                                COPY ERCCOMP.
  1778******************************************************************
  1779*                                                                *
  1780*                                                                *
  1781*                            ERCCOMP                             *
  1782*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1783*                            VMOD=2.019                          *
  1784*                                                                *
  1785*   ONLINE CREDIT SYSTEM                                         *
  1786*                                                                *
  1787*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  1788*                                                                *
  1789*   FILE TYPE = VSAM,KSDS                                        *
  1790*   RECORD SIZE = 700   RECFORM = FIXED                          *
  1791*                                                                *
  1792*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  1793*       ALTERNATE PATH = NONE                                    *
  1794*                                                                *
  1795*   LOG = NO                                                     *
  1796*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1797*                                                                *
  1798******************************************************************
  1799*                   C H A N G E   L O G
  1800*
  1801* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1802*-----------------------------------------------------------------
  1803*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1804* EFFECTIVE    NUMBER
  1805*-----------------------------------------------------------------
  1806* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1807* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  1808* 092205    2005050300006  PEMA  ADD LEASE FEE
  1809* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  1810* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  1811* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page  33
* NSRASBL.cbl
  1812* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1813* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  1814* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  1815******************************************************************
  1816
  1817 01  COMPENSATION-MASTER.
  1818     12  CO-RECORD-ID                          PIC XX.
  1819         88  VALID-CO-ID                          VALUE 'CO'.
  1820
  1821     12  CO-CONTROL-PRIMARY.
  1822         16  CO-COMPANY-CD                     PIC X.
  1823         16  CO-CONTROL.
  1824             20  CO-CTL-1.
  1825                 24  CO-CARR-GROUP.
  1826                     28  CO-CARRIER            PIC X.
  1827                     28  CO-GROUPING.
  1828                         32  CO-GROUP-PREFIX   PIC XXX.
  1829                         32  CO-GROUP-PRIME    PIC XXX.
  1830                 24  CO-RESP-NO.
  1831                     28  CO-RESP-PREFIX        PIC X(4).
  1832                     28  CO-RESP-PRIME         PIC X(6).
  1833             20  CO-CTL-2.
  1834                 24  CO-ACCOUNT.
  1835                     28  CO-ACCT-PREFIX        PIC X(4).
  1836                     28  CO-ACCT-PRIME         PIC X(6).
  1837         16  CO-TYPE                           PIC X.
  1838             88  CO-COMPANY-TYPE                  VALUE 'C'.
  1839             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  1840             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  1841
  1842     12  CO-MAINT-INFORMATION.
  1843         16  CO-LAST-MAINT-DT                  PIC XX.
  1844         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1845         16  CO-LAST-MAINT-USER                PIC X(4).
  1846     12  FILLER                                PIC XX.
  1847     12  CO-STMT-TYPE                          PIC XXX.
  1848     12  CO-COMP-TYPE                          PIC X.
  1849         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  1850     12  CO-STMT-OWNER                         PIC X(4).
  1851     12  CO-BALANCE-CONTROL                    PIC X.
  1852         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  1853         88  CO-NO-BALANCE                        VALUE 'N'.
  1854
  1855     12  CO-INTERNAL-CONTROL-1                 PIC X.
  1856         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  1857         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  1858         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  1859
  1860     12  CO-INTERNAL-CONTROL-2                 PIC X.
  1861         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  1862         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  1863
  1864     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  1865     12  CO-GA-DIRECT-DEP                      PIC X.
  1866     12  CO-FUTURE-SPACE                       PIC X.
  1867         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  1868
  1869     12  CO-ACCT-NAME                          PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page  34
* NSRASBL.cbl
  1870     12  CO-MAIL-NAME                          PIC X(30).
  1871     12  CO-ADDR-1                             PIC X(30).
  1872     12  CO-ADDR-2                             PIC X(30).
  1873     12  CO-ADDR-3.
  1874         16  CO-ADDR-CITY                      PIC X(27).
  1875         16  CO-ADDR-STATE                     PIC XX.
  1876     12  CO-CSO-1099                           PIC X.
  1877     12  CO-ZIP.
  1878         16  CO-ZIP-PRIME.
  1879             20  CO-ZIP-PRI-1ST                PIC X.
  1880                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1881             20  FILLER                        PIC X(4).
  1882         16  CO-ZIP-PLUS4                      PIC X(4).
  1883     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  1884         16  CO-CAN-POSTAL-1                   PIC XXX.
  1885         16  CO-CAN-POSTAL-2                   PIC XXX.
  1886         16  FILLER                            PIC XXX.
  1887     12  CO-SOC-SEC                            PIC X(13).
  1888     12  CO-TELEPHONE.
  1889         16  CO-AREA-CODE                      PIC XXX.
  1890         16  CO-PREFIX                         PIC XXX.
  1891         16  CO-PHONE                          PIC X(4).
  1892
  1893     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  1894
  1895     12  CO-AR-BAL-LEVEL                       PIC X.
  1896         88  CO-AR-REF-LVL                        VALUE '1'.
  1897         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  1898         88  CO-AR-BILL-LVL                       VALUE '2'.
  1899         88  CO-AR-AGT-LVL                        VALUE '3'.
  1900         88  CO-AR-FR-LVL                         VALUE '4'.
  1901
  1902     12  CO-AR-NORMAL-PRINT                    PIC X.
  1903         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  1904         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  1905
  1906     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  1907
  1908     12  CO-AR-REPORTING                       PIC X.
  1909         88  CO-AR-NET-REPORT                     VALUE 'N'.
  1910         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  1911
  1912     12  CO-AR-PULL-CHECK                      PIC X.
  1913         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  1914         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  1915
  1916     12  CO-AR-BALANCE-PRINT                   PIC X.
  1917         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  1918
  1919     12  CO-AR-LAST-RUN-CODE                   PIC X.
  1920         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  1921         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  1922         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  1923
  1924     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  1925
  1926     12  CO-USER-CODE                          PIC X.
  1927     12  CO-REPORT-GROUP-ID                    PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page  35
* NSRASBL.cbl
  1928
  1929******************************************************************
  1930*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  1931*    THE LAST MONTH END RUN.
  1932******************************************************************
  1933
  1934     12  CO-LAST-ACTIVITY-DATE.
  1935         16  CO-ACT-YEAR                       PIC 99.
  1936         16  CO-ACT-MONTH                      PIC 99.
  1937         16  CO-ACT-DAY                        PIC 99.
  1938
  1939     12  CO-LAST-STMT-DT.
  1940         16  CO-LAST-STMT-YEAR                 PIC 99.
  1941         16  CO-LAST-STMT-MONTH                PIC 99.
  1942         16  CO-LAST-STMT-DAY                  PIC 99.
  1943
  1944     12  CO-MO-END-TOTALS.
  1945         16  CO-MONTHLY-TOTALS.
  1946             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  1947             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  1948             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  1949             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  1950             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  1951
  1952         16  CO-AGING-TOTALS.
  1953             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  1954             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  1955             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  1956             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  1957
  1958         16  CO-YTD-TOTALS.
  1959             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  1960             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  1961
  1962         16  CO-OVER-UNDER-TOTALS.
  1963             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1964             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1965
  1966     12  CO-MISCELLANEOUS-TOTALS.
  1967         16  CO-FICA-TOTALS.
  1968             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  1969             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  1970
  1971         16  CO-CLAIM-TOTALS.
  1972             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  1973             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  1974
  1975******************************************************************
  1976*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  1977*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  1978******************************************************************
  1979
  1980     12  CO-CURRENT-TOTALS.
  1981         16  CO-CURRENT-LAST-STMT-DT.
  1982             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  1983             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  1984             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  1985
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page  36
* NSRASBL.cbl
  1986         16  CO-CURRENT-MONTHLY-TOTALS.
  1987             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  1988             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  1989             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  1990             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  1991             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  1992
  1993         16  CO-CURRENT-AGING-TOTALS.
  1994             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  1995             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  1996             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  1997             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  1998
  1999         16  CO-CURRENT-YTD-TOTALS.
  2000             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  2001             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  2002
  2003     12  CO-PAID-COMM-TOTALS.
  2004         16  CO-YTD-PAID-COMMS.
  2005             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  2006             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  2007
  2008     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  2009         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  2010         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  2011
  2012     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  2013         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  2014         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  2015         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  2016         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  2017         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  2018         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  2019         88  CO-FINAL-LETTER                  VALUE 'F'.
  2020         88  CO-RECONCILING                   VALUE 'R'.
  2021         88  CO-PHONE-CALL                    VALUE 'P'.
  2022         88  CO-LEGAL                         VALUE 'L'.
  2023         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  2024         88  CO-WRITE-OFF                     VALUE 'W'.
  2025         88  CO-NO-ACTION                     VALUE 'N' ' '.
  2026
  2027     12  CO-CSR-CODE                       PIC X(4).
  2028
  2029     12  CO-GA-STATUS-INFO.
  2030         16  CO-GA-EFFECTIVE-DT            PIC XX.
  2031         16  CO-GA-TERMINATION-DT          PIC XX.
  2032         16  CO-GA-STATUS-CODE             PIC X.
  2033             88  CO-GA-ACTIVE                 VALUE 'A'.
  2034             88  CO-GA-INACTIVE               VALUE 'I'.
  2035             88  CO-GA-PENDING                VALUE 'P'.
  2036         16  CO-GA-COMMENTS.
  2037             20  CO-GA-COMMENT-1           PIC X(40).
  2038             20  CO-GA-COMMENT-2           PIC X(40).
  2039             20  CO-GA-COMMENT-3           PIC X(40).
  2040             20  CO-GA-COMMENT-4           PIC X(40).
  2041
  2042     12  CO-RPTCD2                         PIC X(10).
  2043     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page  37
* NSRASBL.cbl
  2044         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  2045         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  2046
  2047     12  CO-TYPE-AGENT                     PIC X(01).
  2048         88  CO-CORPORATION                   VALUE 'C'.
  2049         88  CO-PARTNERSHIP                   VALUE 'P'.
  2050         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  2051         88  CO-TRUST                         VALUE 'T'.
  2052         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  2053
  2054     12  CO-FAXNO.
  2055         16  CO-FAX-AREA-CODE                  PIC XXX.
  2056         16  CO-FAX-PREFIX                     PIC XXX.
  2057         16  CO-FAX-PHONE                      PIC X(4).
  2058
  2059     12  CO-BANK-INFORMATION.
  2060         16  CO-BANK-TRANSIT-NO                PIC X(8).
  2061         16  CO-BANK-TRANSIT-NON REDEFINES
  2062             CO-BANK-TRANSIT-NO                PIC 9(8).
  2063
  2064         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  2065     12  CO-MISC-DEDUCT-INFO REDEFINES
  2066                  CO-BANK-INFORMATION.
  2067         16  CO-MD-GL-ACCT                     PIC X(10).
  2068         16  CO-MD-DIV                         PIC XX.
  2069         16  CO-MD-CENTER                      PIC X(4).
  2070         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  2071         16  CO-CREATE-AP-CHECK                PIC X.
  2072         16  CO-DELIVER-CK-TO-MEL              PIC X.
  2073         16  FILLER                            PIC XXX.
  2074     12  CO-ACH-STATUS                         PIC X.
  2075         88  CO-ACH-ACTIVE                         VALUE 'A'.
  2076         88  CO-ACH-PENDING                        VALUE 'P'.
  2077
  2078     12  CO-BILL-SW                            PIC X.
  2079     12  CO-CONTROL-NAME                       PIC X(30).
  2080     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  2081     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  2082     12  CO-CLP-STATE                          PIC XX.
  2083     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  2084     12  CO-SPP-REFUND-EDIT                    PIC X.
  2085
  2086******************************************************************
  2087*                                COPY ELCCERT.
  2088******************************************************************
  2089*                                                                *
  2090*                            ELCCERT.                            *
  2091*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2092*                            VMOD=2.013                          *
  2093*                                                                *
  2094*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  2095*                                                                *
  2096*   FILE TYPE = VSAM,KSDS                                        *
  2097*   RECORD SIZE = 450  RECFORM = FIXED                           *
  2098*                                                                *
  2099*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  2100*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  2101*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page  38
* NSRASBL.cbl
  2102*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  2103*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  2104*                                                                *
  2105*   LOG = YES                                                    *
  2106*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2107******************************************************************
  2108*                   C H A N G E   L O G
  2109*
  2110* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2111*-----------------------------------------------------------------
  2112*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2113* EFFECTIVE    NUMBER
  2114*-----------------------------------------------------------------
  2115* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2116* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2117* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  2118* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  2119* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  2120* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  2121* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2122* 032612  CR2011110200001  PEMA  AHL CHANGES
  2123* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  2124******************************************************************
  2125
  2126 01  CERTIFICATE-MASTER.
  2127     12  CM-RECORD-ID                      PIC XX.
  2128         88  VALID-CM-ID                      VALUE 'CM'.
  2129
  2130     12  CM-CONTROL-PRIMARY.
  2131         16  CM-COMPANY-CD                 PIC X.
  2132         16  CM-CARRIER                    PIC X.
  2133         16  CM-GROUPING.
  2134             20  CM-GROUPING-PREFIX        PIC X(3).
  2135             20  CM-GROUPING-PRIME         PIC X(3).
  2136         16  CM-STATE                      PIC XX.
  2137         16  CM-ACCOUNT.
  2138             20  CM-ACCOUNT-PREFIX         PIC X(4).
  2139             20  CM-ACCOUNT-PRIME          PIC X(6).
  2140         16  CM-CERT-EFF-DT                PIC XX.
  2141         16  CM-CERT-NO.
  2142             20  CM-CERT-PRIME             PIC X(10).
  2143             20  CM-CERT-SFX               PIC X.
  2144
  2145     12  CM-CONTROL-BY-NAME.
  2146         16  CM-COMPANY-CD-A1              PIC X.
  2147         16  CM-INSURED-LAST-NAME          PIC X(15).
  2148         16  CM-INSURED-INITIALS.
  2149             20  CM-INSURED-INITIAL1       PIC X.
  2150             20  CM-INSURED-INITIAL2       PIC X.
  2151
  2152     12  CM-CONTROL-BY-SSN.
  2153         16  CM-COMPANY-CD-A2              PIC X.
  2154         16  CM-SOC-SEC-NO.
  2155             20  CM-SSN-STATE              PIC XX.
  2156             20  CM-SSN-ACCOUNT            PIC X(6).
  2157             20  CM-SSN-LN3.
  2158                 25  CM-INSURED-INITIALS-A2.
  2159                     30 CM-INSURED-INITIAL1-A2   PIC X.
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page  39
* NSRASBL.cbl
  2160                     30 CM-INSURED-INITIAL2-A2   PIC X.
  2161                 25 CM-PART-LAST-NAME-A2         PIC X.
  2162
  2163     12  CM-CONTROL-BY-CERT-NO.
  2164         16  CM-COMPANY-CD-A4              PIC X.
  2165         16  CM-CERT-NO-A4                 PIC X(11).
  2166
  2167     12  CM-CONTROL-BY-MEMB.
  2168         16  CM-COMPANY-CD-A5              PIC X.
  2169         16  CM-MEMBER-NO.
  2170             20  CM-MEMB-STATE             PIC XX.
  2171             20  CM-MEMB-ACCOUNT           PIC X(6).
  2172             20  CM-MEMB-LN4.
  2173                 25  CM-INSURED-INITIALS-A5.
  2174                     30 CM-INSURED-INITIAL1-A5   PIC X.
  2175                     30 CM-INSURED-INITIAL2-A5   PIC X.
  2176                 25 CM-PART-LAST-NAME-A5         PIC XX.
  2177
  2178     12  CM-INSURED-PROFILE-DATA.
  2179         16  CM-INSURED-FIRST-NAME.
  2180             20  CM-INSURED-1ST-INIT       PIC X.
  2181             20  FILLER                    PIC X(9).
  2182         16  CM-INSURED-ISSUE-AGE          PIC 99.
  2183         16  CM-INSURED-SEX                PIC X.
  2184             88  CM-SEX-MALE                  VALUE 'M'.
  2185             88  CM-SEX-FEMAL                 VALUE 'F'.
  2186         16  CM-INSURED-JOINT-AGE          PIC 99.
  2187         16  CM-JOINT-INSURED-NAME.
  2188             20  CM-JT-LAST-NAME           PIC X(15).
  2189             20  CM-JT-FIRST-NAME.
  2190                 24  CM-JT-1ST-INIT        PIC X.
  2191                 24  FILLER                PIC X(9).
  2192             20  CM-JT-INITIAL             PIC X.
  2193
  2194     12  CM-LIFE-DATA.
  2195         16  CM-LF-BENEFIT-CD              PIC XX.
  2196         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  2197         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  2198         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  2199         16  CM-LF-DEV-CODE                PIC XXX.
  2200         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2201         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  2202         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2203         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  2204         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2205         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2206         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  2207         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2208         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  2209         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2210         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2211         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  2212         16  cm-temp-epiq                  pic xx.
  2213             88  EPIQ-CLASS                  value 'EQ'.
  2214*        16  FILLER                        PIC XX.
  2215
  2216     12  CM-AH-DATA.
  2217         16  CM-AH-BENEFIT-CD              PIC XX.
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page  40
* NSRASBL.cbl
  2218         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  2219         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  2220         16  CM-AH-DEV-CODE                PIC XXX.
  2221         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2222         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  2223         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2224         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2225         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2226         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  2227         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  2228         16  CM-AH-PAID-THRU-DT            PIC XX.
  2229             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  2230         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2231         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2232         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  2233         16  FILLER                        PIC X.
  2234
  2235     12  CM-LOAN-INFORMATION.
  2236         16  CM-LIVES                      PIC S9(7)     COMP-3.
  2237         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  2238                                           PIC S9(5)V99  COMP-3.
  2239         16  CM-BILLED                     PIC S9(7)     COMP-3.
  2240         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  2241         16  CM-PAY-FREQUENCY              PIC S99.
  2242         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  2243         16  CM-RATE-CLASS                 PIC XX.
  2244         16  CM-BENEFICIARY                PIC X(25).
  2245         16  CM-POLICY-FORM-NO             PIC X(12).
  2246         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  2247         16  CM-LAST-ADD-ON-DT             PIC XX.
  2248         16  CM-DEDUCTIBLE-AMOUNTS.
  2249             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  2250             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  2251         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2252             20  CM-RESIDENT-STATE         PIC XX.
  2253             20  CM-RATE-CODE              PIC X(4).
  2254             20  FILLER                    PIC XX.
  2255         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2256             20  CM-LOAN-OFFICER           PIC X(5).
  2257             20  FILLER                    PIC XXX.
  2258         16  CM-CSR-CODE                   PIC XXX.
  2259         16  CM-UNDERWRITING-CODE          PIC X.
  2260             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  2261         16  CM-POST-CARD-IND              PIC X.
  2262         16  CM-NH-INTERFACE-SW            PIC X.
  2263         16  CM-PREMIUM-TYPE               PIC X.
  2264             88  CM-SING-PRM                  VALUE '1'.
  2265             88  CM-O-B-COVERAGE              VALUE '2'.
  2266             88  CM-OPEN-END                  VALUE '3'.
  2267         16  CM-IND-GRP-TYPE               PIC X.
  2268             88  CM-INDIVIDUAL                VALUE 'I'.
  2269             88  CM-GROUP                     VALUE 'G'.
  2270         16  CM-SKIP-CODE                  PIC X.
  2271             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  2272             88  SKIP-JULY                    VALUE '1'.
  2273             88  SKIP-AUGUST                  VALUE '2'.
  2274             88  SKIP-SEPTEMBER               VALUE '3'.
  2275             88  SKIP-JULY-AUG                VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page  41
* NSRASBL.cbl
  2276             88  SKIP-AUG-SEPT                VALUE '5'.
  2277             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  2278             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  2279             88  SKIP-JUNE                    VALUE '8'.
  2280             88  SKIP-JUNE-JULY               VALUE '9'.
  2281             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  2282             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  2283         16  CM-PAYMENT-MODE               PIC X.
  2284             88  PAY-MONTHLY                  VALUE SPACE.
  2285             88  PAY-WEEKLY                   VALUE '1'.
  2286             88  PAY-SEMI-MONTHLY             VALUE '2'.
  2287             88  PAY-BI-WEEKLY                VALUE '3'.
  2288             88  PAY-SEMI-ANUALLY             VALUE '4'.
  2289         16  CM-LOAN-NUMBER                PIC X(8).
  2290         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  2291         16  CM-OLD-LOF                    PIC XXX.
  2292*        16  CM-LOAN-OFFICER               PIC XXX.
  2293         16  CM-REIN-TABLE                 PIC XXX.
  2294         16  CM-SPECIAL-REIN-CODE          PIC X.
  2295         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  2296         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  2297         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  2298
  2299     12  CM-STATUS-DATA.
  2300         16  CM-ENTRY-STATUS               PIC X.
  2301         16  CM-ENTRY-DT                   PIC XX.
  2302
  2303         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  2304         16  CM-LF-CANCEL-DT               PIC XX.
  2305         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  2306
  2307         16  CM-LF-STATUS-AT-DEATH         PIC X.
  2308         16  CM-LF-DEATH-DT                PIC XX.
  2309         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  2310
  2311         16  CM-LF-CURRENT-STATUS          PIC X.
  2312             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2313                                                'M' '4' '5' '9'.
  2314             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  2315             88  CM-LF-POLICY-PENDING         VALUE '2'.
  2316             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  2317             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  2318             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  2319             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  2320             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2321             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  2322             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  2323             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  2324             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  2325             88  CM-LF-DECLINED               VALUE 'D'.
  2326             88  CM-LF-VOIDED                 VALUE 'V'.
  2327
  2328         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  2329         16  CM-AH-CANCEL-DT               PIC XX.
  2330         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  2331
  2332         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  2333         16  CM-AH-SETTLEMENT-DT           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page  42
* NSRASBL.cbl
  2334         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  2335
  2336         16  CM-AH-CURRENT-STATUS          PIC X.
  2337             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2338                                                'M' '4' '5' '9'.
  2339             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  2340             88  CM-AH-POLICY-PENDING         VALUE '2'.
  2341             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  2342             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  2343             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  2344             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  2345             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2346             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  2347             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2348             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  2349             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  2350             88  CM-AH-DECLINED               VALUE 'D'.
  2351             88  CM-AH-VOIDED                 VALUE 'V'.
  2352
  2353         16  CM-CLAIM-INTERFACE-SW         PIC X.
  2354             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  2355             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  2356             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  2357         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  2358
  2359         16  CM-ENTRY-BATCH                PIC X(6).
  2360         16  CM-LF-EXIT-BATCH              PIC X(6).
  2361         16  CM-AH-EXIT-BATCH              PIC X(6).
  2362         16  CM-LAST-MONTH-END             PIC XX.
  2363
  2364     12  CM-NOTE-SW                        PIC X.
  2365         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  2366         88  CERT-NOTES-PRESENT               VALUE '1'.
  2367         88  BILLING-NOTES-PRESENT            VALUE '2'.
  2368         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  2369         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  2370         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  2371         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  2372         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  2373     12  CM-COMP-EXCP-SW                   PIC X.
  2374         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  2375         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  2376     12  CM-INSURED-ADDRESS-SW             PIC X.
  2377         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  2378         88  INSURED-ADDR-PRESENT             VALUE '1'.
  2379
  2380*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  2381     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  2382     12  FILLER                            PIC X.
  2383
  2384*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  2385     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  2386     12  FILLER                            PIC X.
  2387*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  2388     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  2389
  2390     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  2391         88  CERT-ADDED-BATCH                 VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page  43
* NSRASBL.cbl
  2392         88  CERT-ADDED-ONLINE                VALUE '1'.
  2393         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  2394         88  CERT-PURGED-OFFLINE              VALUE '3'.
  2395         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  2396     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  2397         88  CERT-AS-LOADED                   VALUE ' '.
  2398         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  2399         88  CERT-CLAIM-ONLINE                VALUE '2'.
  2400         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  2401         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  2402         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  2403         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  2404         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  2405
  2406     12  CM-ACCOUNT-COMM-PCTS.
  2407         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  2408         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2409
  2410     12  CM-USER-FIELD                     PIC X.
  2411     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  2412     12  CM-CLP-STATE                      PIC XX.
  2413     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  2414     12  CM-USER-RESERVED                  PIC XXX.
  2415     12  FILLER REDEFINES CM-USER-RESERVED.
  2416         16  CM-AH-CLASS-CD                PIC XX.
  2417         16  F                             PIC X.
  2418******************************************************************
  2419*                                COPY ELCCRTO.
  2420******************************************************************
  2421*                                                                *
  2422*                            ELCCRTO.                            *
  2423*                                                                *
  2424*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  2425*                                                                *
  2426*   FILE TYPE = VSAM,KSDS                                        *
  2427*   RECORD SIZE = 524  RECFORM = FIXED                           *
  2428*                                                                *
  2429*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  2430*                                                                *
  2431*   LOG = YES                                                    *
  2432*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2433******************************************************************
  2434*                   C H A N G E   L O G
  2435*
  2436* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2437*-----------------------------------------------------------------
  2438*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2439* EFFECTIVE    NUMBER
  2440*-----------------------------------------------------------------
  2441* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  2442* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  2443* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  2444* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  2445* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  2446******************************************************************
  2447 01  ORIGINAL-CERTIFICATE.
  2448     12  OC-RECORD-ID                      PIC XX.
  2449         88  VALID-OC-ID                      VALUE 'OC'.
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page  44
* NSRASBL.cbl
  2450     12  OC-CONTROL-PRIMARY.
  2451         16  OC-COMPANY-CD                 PIC X.
  2452         16  OC-CARRIER                    PIC X.
  2453         16  OC-GROUPING                   PIC X(6).
  2454         16  OC-STATE                      PIC XX.
  2455         16  OC-ACCOUNT                    PIC X(10).
  2456         16  OC-CERT-EFF-DT                PIC XX.
  2457         16  OC-CERT-NO.
  2458             20  OC-CERT-PRIME             PIC X(10).
  2459             20  OC-CERT-SFX               PIC X.
  2460         16  OC-RECORD-TYPE                PIC X.
  2461         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  2462     12  OC-LAST-MAINT-DT                  PIC XX.
  2463     12  OC-LAST-MAINT-BY                  PIC X(4).
  2464     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  2465     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  2466     12  FILLER                            PIC X(49).
  2467     12  OC-ORIG-REC.
  2468         16  OC-INS-LAST-NAME              PIC X(15).
  2469         16  OC-INS-FIRST-NAME             PIC X(10).
  2470         16  OC-INS-MIDDLE-INIT            PIC X.
  2471         16  OC-INS-AGE                    PIC S999     COMP-3.
  2472         16  OC-JNT-LAST-NAME              PIC X(15).
  2473         16  OC-JNT-FIRST-NAME             PIC X(10).
  2474         16  OC-JNT-MIDDLE-INIT            PIC X.
  2475         16  OC-JNT-AGE                    PIC S999     COMP-3.
  2476         16  OC-LF-BENCD                   PIC XX.
  2477         16  OC-LF-TERM                    PIC S999      COMP-3.
  2478         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  2479         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  2480         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  2481         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  2482         16  OC-LF-EXP-DT                  PIC XX.
  2483         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  2484         16  OC-LF-CANCEL-DT               PIC XX.
  2485         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  2486         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2487         16  OC-AH-BENCD                   PIC XX.
  2488         16  OC-AH-TERM                    PIC S999      COMP-3.
  2489         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  2490         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  2491         16  OC-AH-EXP-DT                  PIC XX.
  2492         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2493         16  OC-AH-CP                      PIC 99.
  2494         16  OC-AH-CANCEL-DT               PIC XX.
  2495         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  2496         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2497         16  OC-CRED-BENE-NAME             PIC X(25).
  2498         16  OC-1ST-PMT-DT                 PIC XX.
  2499         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  2500         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  2501         16  OC-ISSUE-TRAN-IND             PIC X.
  2502         16  OC-CANCEL-TRAN-IND            PIC X.
  2503         16  FILLER                        PIC X(211).
  2504
  2505     12  FILLER                            PIC X(50).
  2506******************************************************************
  2507*                                COPY ERCACCT.
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page  45
* NSRASBL.cbl
  2508******************************************************************
  2509*                                                                *
  2510*                                                                *
  2511*                            ERCACCT                             *
  2512*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2513*                            VMOD=2.031                          *
  2514*                                                                *
  2515*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  2516*                                                                *
  2517*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  2518*   VSAM ACCOUNT MASTER FILES.                                   *
  2519*                                                                *
  2520*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  2521*                                                                *
  2522*   FILE TYPE = VSAM,KSDS                                        *
  2523*   RECORD SIZE = 2000  RECFORM = FIX                            *
  2524*                                                                *
  2525*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  2526*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  2527*                                                                *
  2528*   LOG = NO                                                     *
  2529*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2530*                                                                *
  2531*                                                                *
  2532******************************************************************
  2533*                   C H A N G E   L O G
  2534*
  2535* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2536*-----------------------------------------------------------------
  2537*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2538* EFFECTIVE    NUMBER
  2539*-----------------------------------------------------------------
  2540* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  2541* 092705    2005050300006  PEMA  ADD SPP LEASES
  2542* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  2543* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2544* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  2545* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  2546* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  2547******************************************************************
  2548
  2549 01  ACCOUNT-MASTER.
  2550     12  AM-RECORD-ID                      PIC XX.
  2551         88  VALID-AM-ID                      VALUE 'AM'.
  2552
  2553     12  AM-CONTROL-PRIMARY.
  2554         16  AM-COMPANY-CD                 PIC X.
  2555         16  AM-MSTR-CNTRL.
  2556             20  AM-CONTROL-A.
  2557                 24  AM-CARRIER            PIC X.
  2558                 24  AM-GROUPING.
  2559                     28 AM-GROUPING-PREFIX PIC XXX.
  2560                     28 AM-GROUPING-PRIME  PIC XXX.
  2561                 24  AM-STATE              PIC XX.
  2562                 24  AM-ACCOUNT.
  2563                     28  AM-ACCOUNT-PREFIX PIC X(4).
  2564                     28  AM-ACCOUNT-PRIME  PIC X(6).
  2565             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page  46
* NSRASBL.cbl
  2566                                           PIC X(19).
  2567             20  AM-CNTRL-B.
  2568                 24  AM-EXPIRATION-DT      PIC XX.
  2569                 24  FILLER                PIC X(4).
  2570             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  2571                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  2572
  2573     12  AM-CONTROL-BY-VAR-GRP.
  2574         16  AM-COMPANY-CD-A1              PIC X.
  2575         16  AM-VG-CARRIER                 PIC X.
  2576         16  AM-VG-GROUPING                PIC X(6).
  2577         16  AM-VG-STATE                   PIC XX.
  2578         16  AM-VG-ACCOUNT                 PIC X(10).
  2579         16  AM-VG-DATE.
  2580             20  AM-VG-EXPIRATION-DT       PIC XX.
  2581             20  FILLER                    PIC X(4).
  2582         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  2583                                           PIC 9(11)      COMP-3.
  2584     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  2585         16  FILLER                        PIC X(10).
  2586         16  AM-VG-KEY3.
  2587             20  AM-VG3-ACCOUNT            PIC X(10).
  2588             20  AM-VG3-EXP-DT             PIC XX.
  2589         16  FILLER                        PIC X(4).
  2590     12  AM-MAINT-INFORMATION.
  2591         16  AM-LAST-MAINT-DT              PIC XX.
  2592         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2593         16  AM-LAST-MAINT-USER            PIC X(4).
  2594         16  FILLER                        PIC XX.
  2595
  2596     12  AM-EFFECTIVE-DT                   PIC XX.
  2597     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  2598
  2599     12  AM-PREV-DATES  COMP-3.
  2600         16  AM-PREV-EXP-DT                PIC 9(11).
  2601         16  AM-PREV-EFF-DT                PIC 9(11).
  2602
  2603     12  AM-REPORT-CODE-1                  PIC X(10).
  2604     12  AM-REPORT-CODE-2                  PIC X(10).
  2605
  2606     12  AM-CITY-CODE                      PIC X(4).
  2607     12  AM-COUNTY-PARISH                  PIC X(6).
  2608
  2609     12  AM-NAME                           PIC X(30).
  2610     12  AM-PERSON                         PIC X(30).
  2611     12  AM-ADDRS                          PIC X(30).
  2612     12  AM-CITY.
  2613         16  AM-ADDR-CITY                  PIC X(28).
  2614         16  AM-ADDR-STATE                 PIC XX.
  2615     12  AM-ZIP.
  2616         16  AM-ZIP-PRIME.
  2617             20  AM-ZIP-PRI-1ST            PIC X.
  2618                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  2619             20  FILLER                    PIC X(4).
  2620         16  AM-ZIP-PLUS4                  PIC X(4).
  2621     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  2622         16  AM-CAN-POSTAL-1               PIC XXX.
  2623         16  AM-CAN-POSTAL-2               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page  47
* NSRASBL.cbl
  2624         16  FILLER                        PIC XXX.
  2625     12  AM-TEL-NO.
  2626         16  AM-AREA-CODE                  PIC 999.
  2627         16  AM-TEL-PRE                    PIC 999.
  2628         16  AM-TEL-NBR                    PIC 9(4).
  2629     12  AM-TEL-LOC                        PIC X.
  2630         88  AM-TEL-AT-HOME                   VALUE 'H'.
  2631         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  2632
  2633     12  AM-COMM-STRUCTURE.
  2634         16  AM-DEFN-1.
  2635             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  2636                 24  AM-AGT.
  2637                     28  AM-AGT-PREFIX     PIC X(4).
  2638                     28  AM-AGT-PRIME      PIC X(6).
  2639                 24  AM-COM-TYP            PIC X.
  2640                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  2641                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  2642                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  2643                 24  AM-RECALC-LV-INDIC    PIC X.
  2644                 24  AM-RETRO-LV-INDIC     PIC X.
  2645                 24  AM-GL-CODES           PIC X.
  2646                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  2647                 24  FILLER                PIC X(01).
  2648         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  2649             20  AM-COM-TBLS        OCCURS 10 TIMES.
  2650                 24  FILLER                PIC X(11).
  2651                 24  AM-L-COMA             PIC XXX.
  2652                 24  AM-J-COMA             PIC XXX.
  2653                 24  AM-A-COMA             PIC XXX.
  2654                 24  FILLER                PIC X(6).
  2655
  2656     12  AM-COMM-CHANGE-STATUS             PIC X.
  2657         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  2658
  2659     12  AM-CSR-CODE                       PIC X(4).
  2660
  2661     12  AM-BILLING-STATUS                 PIC X.
  2662         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  2663         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  2664     12  AM-AUTO-REFUND-SW                 PIC X.
  2665         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  2666         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  2667     12  AM-GPCD                           PIC 99.
  2668     12  AM-IG                             PIC X.
  2669         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  2670         88  AM-HAS-GROUP                     VALUE '2'.
  2671     12  AM-STATUS                         PIC X.
  2672         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  2673         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  2674         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  2675         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  2676         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  2677         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  2678     12  AM-REMIT-TO                       PIC 99.
  2679     12  AM-ID-NO                          PIC X(11).
  2680
  2681     12  AM-CAL-TABLE                      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page  48
* NSRASBL.cbl
  2682     12  AM-LF-DEVIATION                   PIC XXX.
  2683     12  AM-AH-DEVIATION                   PIC XXX.
  2684     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2685     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2686     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  2687     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  2688     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2689     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2690
  2691     12  AM-USER-FIELDS.
  2692         16  AM-FLD-1                      PIC XX.
  2693         16  AM-FLD-2                      PIC XX.
  2694         16  AM-FLD-3                      PIC XX.
  2695         16  AM-FLD-4                      PIC XX.
  2696         16  AM-FLD-5                      PIC XX.
  2697
  2698     12  AM-1ST-PROD-DATE.
  2699         16  AM-1ST-PROD-YR                PIC XX.
  2700         16  AM-1ST-PROD-MO                PIC XX.
  2701         16  AM-1ST-PROD-DA                PIC XX.
  2702     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  2703     12  AM-CERTS-PURGED-DATE.
  2704         16  AM-PUR-YR                     PIC XX.
  2705         16  AM-PUR-MO                     PIC XX.
  2706         16  AM-PUR-DA                     PIC XX.
  2707     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  2708     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  2709     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  2710     12  AM-INACTIVE-DATE.
  2711         16  AM-INA-MO                     PIC 99.
  2712         16  AM-INA-DA                     PIC 99.
  2713         16  AM-INA-YR                     PIC 99.
  2714     12  AM-AR-HI-CERT-DATE                PIC XX.
  2715
  2716     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2717     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2718
  2719     12  AM-OB-PAYMENT-MODE                PIC X.
  2720         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  2721         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  2722         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  2723         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  2724
  2725     12  AM-AH-ONLY-INDICATOR              PIC X.
  2726         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  2727         88  AM-NO-AH-ONLY                    VALUE 'N'.
  2728
  2729     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  2730
  2731     12  AM-OVER-SHORT.
  2732         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  2733         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  2734
  2735     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  2736     12  AM-DCC-CLP-STATE                  PIC XX.
  2737
  2738     12  AM-RECALC-COMM                    PIC X.
  2739     12  AM-RECALC-REIN                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page  49
* NSRASBL.cbl
  2740
  2741     12  AM-REI-TABLE                      PIC XXX.
  2742     12  AM-REI-ET-LF                      PIC X.
  2743     12  AM-REI-ET-AH                      PIC X.
  2744     12  AM-REI-PE-LF                      PIC X.
  2745     12  AM-REI-PE-AH                      PIC X.
  2746     12  AM-REI-PRT-ST                     PIC X.
  2747     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  2748     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  2749     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  2750     12  AM-REI-GROUP-A                    PIC X(6).
  2751     12  AM-REI-MORT                       PIC X(4).
  2752     12  AM-REI-PRT-OW                     PIC X.
  2753     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  2754     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  2755     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  2756     12  AM-REI-GROUP-B                    PIC X(6).
  2757
  2758     12  AM-TRUST-TYPE                     PIC X(2).
  2759
  2760     12  AM-EMPLOYER-STMT-USED             PIC X.
  2761     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  2762
  2763     12  AM-STD-AH-TYPE                    PIC XX.
  2764     12  AM-EARN-METHODS.
  2765         16  AM-EARN-METHOD-R              PIC X.
  2766             88 AM-REF-RL-R78                 VALUE 'R'.
  2767             88 AM-REF-RL-PR                  VALUE 'P'.
  2768             88 AM-REF-RL-MEAN                VALUE 'M'.
  2769             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  2770         16  AM-EARN-METHOD-L              PIC X.
  2771             88 AM-REF-LL-R78                 VALUE 'R'.
  2772             88 AM-REF-LL-PR                  VALUE 'P'.
  2773             88 AM-REF-LL-MEAN                VALUE 'M'.
  2774             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  2775         16  AM-EARN-METHOD-A              PIC X.
  2776             88 AM-REF-AH-R78                 VALUE 'R'.
  2777             88 AM-REF-AH-PR                  VALUE 'P'.
  2778             88 AM-REF-AH-MEAN                VALUE 'M'.
  2779             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  2780             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  2781             88 AM-REF-AH-NET                 VALUE 'N'.
  2782
  2783     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  2784     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  2785     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  2786
  2787     12  AM-RET-Y-N                        PIC X.
  2788     12  AM-RET-P-E                        PIC X.
  2789     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  2790     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  2791     12  AM-RET-GRP                        PIC X(6).
  2792     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  2793         16  AM-POOL-PRIME                 PIC XXX.
  2794         16  AM-POOL-SUB                   PIC XXX.
  2795     12  AM-RETRO-EARNINGS.
  2796         16  AM-RET-EARN-R                 PIC X.
  2797         16  AM-RET-EARN-L                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page  50
* NSRASBL.cbl
  2798         16  AM-RET-EARN-A                 PIC X.
  2799     12  AM-RET-ST-TAX-USE                 PIC X.
  2800         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  2801         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  2802     12  AM-RETRO-BEG-EARNINGS.
  2803         16  AM-RET-BEG-EARN-R             PIC X.
  2804         16  AM-RET-BEG-EARN-L             PIC X.
  2805         16  AM-RET-BEG-EARN-A             PIC X.
  2806     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  2807     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  2808
  2809     12  AM-USER-SELECT-OPTIONS.
  2810         16  AM-USER-SELECT-1              PIC X(10).
  2811         16  AM-USER-SELECT-2              PIC X(10).
  2812         16  AM-USER-SELECT-3              PIC X(10).
  2813         16  AM-USER-SELECT-4              PIC X(10).
  2814         16  AM-USER-SELECT-5              PIC X(10).
  2815
  2816     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2817
  2818     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2819
  2820     12  AM-RPT045A-SWITCH                 PIC X.
  2821         88  RPT045A-OFF                   VALUE 'N'.
  2822
  2823     12  AM-INSURANCE-LIMITS.
  2824         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  2825         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  2826
  2827     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  2828         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  2829
  2830     12  AM-DISMBR-COVERAGE-SW             PIC X.
  2831         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  2832         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  2833
  2834     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  2835
  2836     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  2837     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  2838     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  2839     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  2840     12  AM-DCC-UEF-STATE                  PIC XX.
  2841     12  FILLER                            PIC XXX.
  2842     12  AM-REPORT-CODE-3                  PIC X(10).
  2843*    12  FILLER                            PIC X(22).
  2844
  2845     12  AM-RESERVE-DATE.
  2846         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  2847         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  2848         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  2849
  2850     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  2851     12  AM-NOTIFICATION-TYPES.
  2852         16  AM-NOTIF-OF-LETTERS           PIC X.
  2853         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  2854         16  AM-NOTIF-OF-REPORTS           PIC X.
  2855         16  AM-NOTIF-OF-STATUS            PIC X.
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page  51
* NSRASBL.cbl
  2856
  2857     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  2858         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  2859         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  2860         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  2861         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  2862
  2863     12  AM-BENEFIT-CONTROLS.
  2864         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  2865             20  AM-BENEFIT-CODE           PIC XX.
  2866             20  AM-BENEFIT-TYPE           PIC X.
  2867             20  AM-BENEFIT-REVISION       PIC XXX.
  2868             20  AM-BENEFIT-REM-TERM       PIC X.
  2869             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  2870             20  FILLER                    PIC XX.
  2871         16  FILLER                        PIC X(80).
  2872
  2873     12  AM-TRANSFER-DATA.
  2874         16  AM-TRANSFERRED-FROM.
  2875             20  AM-TRNFROM-CARRIER        PIC X.
  2876             20  AM-TRNFROM-GROUPING.
  2877                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  2878                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  2879             20  AM-TRNFROM-STATE          PIC XX.
  2880             20  AM-TRNFROM-ACCOUNT.
  2881                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  2882                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  2883             20  AM-TRNFROM-DTE            PIC XX.
  2884         16  AM-TRANSFERRED-TO.
  2885             20  AM-TRNTO-CARRIER          PIC X.
  2886             20  AM-TRNTO-GROUPING.
  2887                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  2888                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  2889             20  AM-TRNTO-STATE            PIC XX.
  2890             20  AM-TRNTO-ACCOUNT.
  2891                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  2892                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  2893             20  AM-TRNTO-DTE              PIC XX.
  2894         16  FILLER                        PIC X(10).
  2895
  2896     12  AM-SAVED-REMIT-TO                 PIC 99.
  2897
  2898     12  AM-COMM-STRUCTURE-SAVED.
  2899         16  AM-DEFN-1-SAVED.
  2900             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  2901                 24  AM-AGT-SV             PIC X(10).
  2902                 24  AM-COM-TYP-SV         PIC X.
  2903                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  2904                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  2905                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  2906                 24  AM-RECALC-LV-INDIC-SV PIC X.
  2907                 24  FILLER                PIC X.
  2908                 24  AM-GL-CODES-SV        PIC X.
  2909                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  2910                 24  FILLER                PIC X.
  2911         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  2912             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  2913                 24  FILLER                PIC X(11).
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page  52
* NSRASBL.cbl
  2914                 24  AM-L-COMA-SV          PIC XXX.
  2915                 24  AM-J-COMA-SV          PIC XXX.
  2916                 24  AM-A-COMA-SV          PIC XXX.
  2917                 24  FILLER                PIC X(6).
  2918
  2919     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  2920         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  2921            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  2922            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  2923            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  2924
  2925     12  AM-ORIG-DEALER-NO                 PIC X(10).
  2926     12  FILLER                            PIC X(120).
  2927
  2928     12  AM-ACCOUNT-EXECUTIVE-DATA.
  2929         16  AM-CONTROL-NAME               PIC X(30).
  2930         16  AM-EXECUTIVE-ONE.
  2931             20  AM-EXEC1-NAME             PIC X(15).
  2932             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  2933                                                          COMP-3.
  2934             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  2935                                                          COMP-3.
  2936         16  AM-EXECUTIVE-TWO.
  2937             20  AM-EXEC2-NAME             PIC X(15).
  2938             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  2939                                                          COMP-3.
  2940             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  2941                                                          COMP-3.
  2942
  2943     12  AM-RETRO-ADDITIONAL-DATA.
  2944         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  2945         16  AM-RETRO-PREM-P-E             PIC X.
  2946         16  AM-RETRO-CLMS-P-I             PIC X.
  2947         16  AM-RETRO-RET-BRACKET-LF.
  2948             20  AM-RETRO-RET-METHOD-LF    PIC X.
  2949                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  2950                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  2951             20  AM-RETRO-RET-BASIS-LF     PIC X.
  2952                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  2953                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  2954             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  2955                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  2956                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  2957         16  AM-RETRO-RET-BRACKET-AH.
  2958             20  AM-RETRO-RET-METHOD-AH    PIC X.
  2959                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  2960                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  2961                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  2962             20  AM-RETRO-RET-BASIS-AH     PIC X.
  2963                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  2964                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  2965             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  2966                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  2967                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  2968
  2969     12  AM-COMMENTS.
  2970         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  2971
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page  53
* NSRASBL.cbl
  2972     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  2973         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  2974         16  AM-FLI-BILLING-CODE           PIC X.
  2975         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  2976         16  AM-FLI-UNITED-IDENT           PIC X.
  2977         16  AM-FLI-INTEREST-LOST-DATA.
  2978             20  AM-FLI-BANK-NO            PIC X(5).
  2979             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  2980             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  2981             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  2982         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  2983             20  AM-FLI-AGT                PIC X(9).
  2984             20  AM-FLI-AGT-COMM-ACC       PIC X.
  2985             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  2986         16  FILLER                        PIC X(102).
  2987
  2988     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  2989         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  2990             20  AM-BENEFIT-DMD-CODE         PIC XX.
  2991             20  AM-BENEFIT-DMD-TYPE         PIC X.
  2992             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  2993             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  2994             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  2995         16  FILLER                          PIC X(10).
  2996******************************************************************
  2997*                                COPY ELCTEXT.
  2998******************************************************************
  2999*                                                                *
  3000*                                                                *
  3001*                            ELCTEXT.                            *
  3002*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3003*                            VMOD=2.008                          *
  3004*                                                                *
  3005*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
  3006*                                     FORM LETTERS,              *
  3007*                                     CERT FORM DISPLAY.
  3008*                                                                *
  3009*   FILE TYPE = VSAM,KSDS                                        *
  3010*   RECORD SIZE = 100   RECFORM = FIXED                          *
  3011*                                                                *
  3012*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
  3013*       ALTERNATE INDEX = NONE                                   *
  3014*                                                                *
  3015*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
  3016*       ALTERNATE INDEX = NONE                                   *
  3017*                                                                *
  3018*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
  3019*       ALTERNATE INDEX = NONE                                   *
  3020*                                                                *
  3021*   LOG = NO                                                     *
  3022*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3023******************************************************************
  3024 01  TEXT-FILES.
  3025     12  TEXT-FILE-ID                PIC XX.
  3026         88  FORMS-FILE-TEXT            VALUE 'TF'.
  3027         88  LETTER-FILE-TEXT           VALUE 'TL'.
  3028         88  HELP-FILE-TEXT             VALUE 'TH'.
  3029
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page  54
* NSRASBL.cbl
  3030     12  TX-CONTROL-PRIMARY.
  3031         16  TX-COMPANY-CD           PIC X.
  3032             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
  3033         16  TX-ACCESS-CD-GENL       PIC X(12).
  3034
  3035         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  3036             20  TX-LETTER-NO        PIC X(4).
  3037             20  FILLER              PIC X(8).
  3038
  3039         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  3040             20  TX-FORM-NO          PIC X(12).
  3041
  3042         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  3043             20  TX-HELP-TYPE        PIC X.
  3044                 88  HELP-FOR-GENERAL   VALUE ' '.
  3045                 88  HELP-BY-SCREEN     VALUE 'S'.
  3046                 88  HELP-BY-ERROR      VALUE 'E'.
  3047             20  TX-SCREEN-OR-ERROR  PIC X(4).
  3048                 88  GENERAL-INFO-HELP  VALUE '0000'.
  3049             20  TX-HELP-FOR-COMPANY  PIC XXX.
  3050                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
  3051             20  FILLER              PIC X(4).
  3052
  3053         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
  3054
  3055     12  TX-PROCESS-CONTROL          PIC XX.
  3056         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
  3057
  3058     12  TX-TEXT-LINE                PIC X(70).
  3059
  3060     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
  3061         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
  3062         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
  3063         88  TX-VALID-FORM-SQUEEZE-VALUE
  3064                                        VALUE 'Y' ' '.
  3065
  3066     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
  3067         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
  3068         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
  3069         88  TX-DO-NOT-ADJUST           VALUE 'N'.
  3070         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
  3071         88  TX-NEW-PARAGRAPH           VALUE 'P'.
  3072         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
  3073         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
  3074                                              'K' 'N' ' '
  3075                                              'Z'.
  3076
  3077     12  TX-ARCHIVE-SW               PIC X.
  3078         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
  3079         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
  3080         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
  3081
  3082     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
  3083     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
  3084
  3085     12  TX-BSR-CODE                 PIC X.
  3086         88  TX-BSR-LETTER              VALUE 'B'.
  3087         88  TX-NON-BSR-LETTER          VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page  55
* NSRASBL.cbl
  3088
  3089     12  FILLER                      PIC X.
  3090*****************************************************************
  3091*                                COPY ELCCNTL.
  3092******************************************************************
  3093*                                                                *
  3094*                                                                *
  3095*                            ELCCNTL.                            *
  3096*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3097*                            VMOD=2.059                          *
  3098*                                                                *
  3099*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  3100*                                                                *
  3101*   FILE TYPE = VSAM,KSDS                                        *
  3102*   RECORD SIZE = 750  RECFORM = FIXED                           *
  3103*                                                                *
  3104*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  3105*       ALTERNATE INDEX = NONE                                   *
  3106*                                                                *
  3107*   LOG = YES                                                    *
  3108*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3109******************************************************************
  3110*                   C H A N G E   L O G
  3111*
  3112* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3113*-----------------------------------------------------------------
  3114*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3115* EFFECTIVE    NUMBER
  3116*-----------------------------------------------------------------
  3117* 082503                   PEMA  ADD BENEFIT GROUP
  3118* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3119* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3120* 092705    2005050300006  PEMA  ADD SPP LEASES
  3121* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  3122* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  3123* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  3124* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  3125* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  3126* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  3127* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  3128* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  3129* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  3130* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3131******************************************************************
  3132*
  3133 01  CONTROL-FILE.
  3134     12  CF-RECORD-ID                       PIC XX.
  3135         88  VALID-CF-ID                        VALUE 'CF'.
  3136
  3137     12  CF-CONTROL-PRIMARY.
  3138         16  CF-COMPANY-ID                  PIC XXX.
  3139         16  CF-RECORD-TYPE                 PIC X.
  3140             88  CF-COMPANY-MASTER              VALUE '1'.
  3141             88  CF-PROCESSOR-MASTER            VALUE '2'.
  3142             88  CF-STATE-MASTER                VALUE '3'.
  3143             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  3144             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  3145             88  CF-CARRIER-MASTER              VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page  56
* NSRASBL.cbl
  3146             88  CF-MORTALITY-MASTER            VALUE '7'.
  3147             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  3148             88  CF-TERMINAL-MASTER             VALUE '9'.
  3149             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  3150             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  3151             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  3152             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  3153             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  3154             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  3155             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  3156             88  CF-REMINDERS-MASTER            VALUE 'R'.
  3157             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  3158         16  CF-ACCESS-CD-GENL              PIC X(4).
  3159         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  3160             20  CF-PROCESSOR               PIC X(4).
  3161         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  3162             20  CF-STATE-CODE              PIC XX.
  3163             20  FILLER                     PIC XX.
  3164         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  3165             20  FILLER                     PIC XX.
  3166             20  CF-HI-BEN-IN-REC           PIC XX.
  3167         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  3168             20  FILLER                     PIC XXX.
  3169             20  CF-CARRIER-CNTL            PIC X.
  3170         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  3171             20  FILLER                     PIC XX.
  3172             20  CF-HI-TYPE-IN-REC          PIC 99.
  3173         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  3174             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  3175                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  3176             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  3177             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  3178         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  3179             20  FILLER                     PIC X.
  3180             20  CF-CUSTOM-REPORT-NO        PIC 999.
  3181         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  3182             20  FILLER                     PIC XX.
  3183             20  CF-MORTGAGE-PLAN           PIC XX.
  3184         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  3185
  3186     12  CF-LAST-MAINT-DT                   PIC XX.
  3187     12  CF-LAST-MAINT-BY                   PIC X(4).
  3188     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  3189
  3190     12  CF-RECORD-BODY                     PIC X(728).
  3191
  3192
  3193****************************************************************
  3194*             COMPANY MASTER RECORD                            *
  3195****************************************************************
  3196
  3197     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3198         16  CF-COMPANY-ADDRESS.
  3199             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  3200             20  CF-CL-IN-CARE-OF           PIC X(30).
  3201             20  CF-CL-ADDR-LINE-1          PIC X(30).
  3202             20  CF-CL-ADDR-LINE-2          PIC X(30).
  3203             20  CF-CL-CITY-STATE           PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page  57
* NSRASBL.cbl
  3204             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  3205             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  3206         16  CF-COMPANY-CD                  PIC X.
  3207         16  CF-COMPANY-PASSWORD            PIC X(8).
  3208         16  CF-SECURITY-OPTION             PIC X.
  3209             88  ALL-SECURITY                   VALUE '1'.
  3210             88  COMPANY-VERIFY                 VALUE '2'.
  3211             88  PROCESSOR-VERIFY               VALUE '3'.
  3212             88  NO-SECURITY                    VALUE '4'.
  3213             88  ALL-BUT-TERM                   VALUE '5'.
  3214         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  3215             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  3216         16  CF-LGX-INTERFACE-CNTL          PIC X.
  3217             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  3218         16  CF-INFORCE-LOCATION            PIC X.
  3219             88  CERTS-ARE-ONLINE               VALUE '1'.
  3220             88  CERTS-ARE-OFFLINE              VALUE '2'.
  3221             88  NO-CERTS-AVAILABLE             VALUE '3'.
  3222         16  CF-LOWER-CASE-LETTERS          PIC X.
  3223         16  CF-CERT-ACCESS-CONTROL         PIC X.
  3224             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  3225             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  3226             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  3227             88  CF-ACCNT-CNTL                  VALUE '3'.
  3228             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  3229
  3230         16  CF-FORMS-PRINTER-ID            PIC X(4).
  3231         16  CF-CHECK-PRINTER-ID            PIC X(4).
  3232
  3233         16  CF-LGX-CREDIT-USER             PIC X.
  3234             88  CO-IS-NOT-USER                 VALUE 'N'.
  3235             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  3236
  3237         16 CF-CREDIT-CALC-CODES.
  3238             20  CF-CR-REM-TERM-CALC PIC X.
  3239               88  CR-EARN-AFTER-15TH           VALUE '1'.
  3240               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  3241               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  3242               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  3243               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  3244               88  CR-EARN-AFTER-14TH           VALUE '6'.
  3245               88  CR-EARN-AFTER-16TH           VALUE '7'.
  3246             20  CF-CR-R78-METHOD           PIC X.
  3247               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  3248               88  DONT-USE-PLUS-ONE            VALUE '1'.
  3249
  3250         16  CF-CLAIM-CONTROL-COUNTS.
  3251             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  3252                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  3253
  3254             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  3255                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  3256
  3257             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  3258                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  3259
  3260             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  3261                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page  58
* NSRASBL.cbl
  3262
  3263         16  CF-CURRENT-MONTH-END           PIC XX.
  3264
  3265         16  CF-CO-CALC-QUOTE-TOLERANCE.
  3266             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  3267             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  3268             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  3269             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  3270                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3271                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3272             20  CF-CO-PREM-REJECT-SW       PIC X.
  3273                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  3274                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  3275             20  CF-CO-REF-REJECT-SW        PIC X.
  3276                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  3277                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  3278
  3279         16  CF-CO-REPORTING-DT             PIC XX.
  3280         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  3281         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  3282           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  3283           88  CF-CO-MONTH-END                  VALUE '1'.
  3284
  3285         16  CF-LGX-CLAIM-USER              PIC X.
  3286             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  3287             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  3288
  3289         16  CF-CREDIT-EDIT-CONTROLS.
  3290             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  3291             20  CF-MIN-AGE                 PIC 99.
  3292             20  CF-DEFAULT-AGE             PIC 99.
  3293             20  CF-MIN-TERM                PIC S999      COMP-3.
  3294             20  CF-MAX-TERM                PIC S999      COMP-3.
  3295             20  CF-DEFAULT-SEX             PIC X.
  3296             20  CF-JOINT-AGE-INPUT         PIC X.
  3297                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  3298             20  CF-BIRTH-DATE-INPUT        PIC X.
  3299                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  3300             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  3301                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  3302                 88  CF-ZERO-CARRIER            VALUE '1'.
  3303                 88  CF-ZERO-GROUPING           VALUE '2'.
  3304                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  3305             20  CF-EDIT-SW                 PIC X.
  3306                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  3307             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  3308             20  CF-CR-PR-METHOD            PIC X.
  3309               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  3310               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  3311             20  FILLER                     PIC X.
  3312
  3313         16  CF-CREDIT-MISC-CONTROLS.
  3314             20  CF-REIN-TABLE-SW           PIC X.
  3315                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  3316             20  CF-COMP-TABLE-SW           PIC X.
  3317                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  3318             20  CF-EXPERIENCE-RETENTION-AGE
  3319                                            PIC S9        COMP-3.
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page  59
* NSRASBL.cbl
  3320             20  CF-CONVERSION-DT           PIC XX.
  3321             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  3322             20  CF-RUN-FREQUENCY-SW        PIC X.
  3323                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  3324                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  3325
  3326             20  CF-CR-CHECK-NO-CONTROL.
  3327                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  3328                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  3329                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  3330                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  3331                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  3332                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  3333
  3334                 24  CF-CR-CHECK-COUNT       REDEFINES
  3335                     CF-CR-CHECK-COUNTER      PIC X(4).
  3336
  3337                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  3338                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  3339
  3340                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  3341                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  3342                 24  CF-MAIL-PROCESSING       PIC X.
  3343                     88  MAIL-PROCESSING          VALUE 'Y'.
  3344
  3345         16  CF-MISC-SYSTEM-CONTROL.
  3346             20  CF-SYSTEM-C                 PIC X.
  3347                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  3348             20  CF-SYSTEM-D                 PIC X.
  3349                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  3350             20  CF-SOC-SEC-NO-SW            PIC X.
  3351                 88  SOC-SEC-NO-USED             VALUE '1'.
  3352             20  CF-MEMBER-NO-SW             PIC X.
  3353                 88  MEMBER-NO-USED              VALUE '1'.
  3354             20  CF-TAX-ID-NUMBER            PIC X(11).
  3355             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  3356             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  3357                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  3358                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  3359                 88  CF-ALL-APPROVED             VALUE 'Y'.
  3360                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  3361             20  CF-SYSTEM-E                 PIC X.
  3362                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  3363
  3364         16  CF-LGX-LIFE-USER               PIC X.
  3365             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  3366             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  3367
  3368         16  CF-CR-MONTH-END-DT             PIC XX.
  3369
  3370         16  CF-FILE-MAINT-DATES.
  3371             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  3372                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  3373             20  CF-LAST-BATCH       REDEFINES
  3374                 CF-LAST-BATCH-NO               PIC X(4).
  3375             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  3376             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  3377             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page  60
* NSRASBL.cbl
  3378             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  3379             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  3380             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  3381             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  3382             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  3383             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  3384             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  3385
  3386         16  CF-NEXT-COMPANY-ID             PIC XXX.
  3387         16  FILLER                         PIC X.
  3388
  3389         16  CF-ALT-MORT-CODE               PIC X(4).
  3390         16  CF-MEMBER-CAPTION              PIC X(10).
  3391
  3392         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  3393             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  3394             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  3395             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  3396             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  3397             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  3398
  3399         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  3400
  3401         16  CF-LIFE-OVERRIDE-L1            PIC X.
  3402         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  3403         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  3404         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  3405
  3406         16  CF-AH-OVERRIDE-L1              PIC X.
  3407         16  CF-AH-OVERRIDE-L2              PIC XX.
  3408         16  CF-AH-OVERRIDE-L6              PIC X(6).
  3409         16  CF-AH-OVERRIDE-L12             PIC X(12).
  3410
  3411         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  3412         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  3413
  3414         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  3415         16  CF-AR-LAST-EL860-DT            PIC XX.
  3416         16  CF-MP-MONTH-END-DT             PIC XX.
  3417
  3418         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  3419         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  3420             88  CF-CLAIM-PAID-TO               VALUE '1'.
  3421
  3422         16  CF-AR-MONTH-END-DT             PIC XX.
  3423
  3424         16  CF-CRDTCRD-USER                PIC X.
  3425             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  3426             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  3427
  3428         16  CF-CC-MONTH-END-DT             PIC XX.
  3429
  3430         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  3431
  3432         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  3433             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  3434             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  3435             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page  61
* NSRASBL.cbl
  3436         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  3437         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  3438         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  3439         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  3440             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  3441             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  3442         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  3443         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  3444         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  3445             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  3446         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  3447
  3448         16  CF-CL-ZIP-CODE.
  3449             20  CF-CL-ZIP-PRIME.
  3450                 24  CF-CL-ZIP-1ST          PIC X.
  3451                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  3452                 24  FILLER                 PIC X(4).
  3453             20  CF-CL-ZIP-PLUS4            PIC X(4).
  3454         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  3455             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  3456             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  3457             20  FILLER                     PIC XXX.
  3458
  3459         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  3460         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  3461         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  3462         16  CF-CO-OPTION-START-DATE        PIC XX.
  3463         16  CF-REM-TRM-CALC-OPTION         PIC X.
  3464           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  3465                                                      '3' '4'.
  3466           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  3467           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  3468           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  3469           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  3470           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  3471           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  3472
  3473         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  3474
  3475         16  CF-PAYMENT-APPROVAL-LEVELS.
  3476             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  3477             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  3478             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  3479             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  3480             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  3481             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  3482
  3483         16  CF-END-USER-REPORTING-USER     PIC X.
  3484             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  3485             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  3486
  3487         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  3488             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  3489             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  3490
  3491         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  3492
  3493         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page  62
* NSRASBL.cbl
  3494         16  FILLER                         PIC X.
  3495
  3496         16  CF-CREDIT-ARCHIVE-CNTL.
  3497             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  3498             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  3499             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  3500
  3501         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  3502
  3503         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  3504             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  3505             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  3506
  3507         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  3508             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  3509             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  3510
  3511         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  3512
  3513         16  CF-CO-ACH-ID-CODE              PIC  X.
  3514             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  3515             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  3516             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  3517         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  3518         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  3519         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  3520         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  3521         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  3522         16  CF-CO-ACH-RECV-NO              PIC X(08).
  3523         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  3524         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  3525         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  3526                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  3527         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  3528                 CF-CO-ACH-TRACE-NO         PIC X(4).
  3529
  3530         16  CF-CO-OVER-SHORT.
  3531             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3532             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3533
  3534*         16  FILLER                         PIC X(102).
  3535         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  3536             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  3537             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  3538
  3539         16  CF-AH-APPROVAL-DAYS.
  3540             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  3541             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  3542             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  3543             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  3544
  3545         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  3546
  3547         16  CF-APPROV-LEV-5.
  3548             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  3549             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  3550             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  3551
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page  63
* NSRASBL.cbl
  3552         16  FILLER                         PIC X(68).
  3553****************************************************************
  3554*             PROCESSOR/USER RECORD                            *
  3555****************************************************************
  3556
  3557     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3558         16  CF-PROCESSOR-NAME              PIC X(30).
  3559         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  3560         16  CF-PROCESSOR-TITLE             PIC X(26).
  3561         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  3562                 88  MESSAGE-YES                VALUE 'Y'.
  3563                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  3564
  3565*****************************************************
  3566****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  3567****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  3568****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  3569****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  3570*****************************************************
  3571
  3572         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  3573             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  3574             20  CF-APPLICATION-FORCE       PIC X.
  3575             20  CF-INDIVIDUAL-APP.
  3576                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  3577                     28  CF-BROWSE-APP      PIC X.
  3578                     28  CF-UPDATE-APP      PIC X.
  3579
  3580         16  CF-CURRENT-TERM-ON             PIC X(4).
  3581         16  CF-PROCESSOR-LIMITS-CLAIMS.
  3582             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  3583             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  3584             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  3585             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  3586             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  3587             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  3588             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  3589         16  CF-PROCESSOR-CARRIER           PIC X.
  3590             88  NO-CARRIER-SECURITY            VALUE ' '.
  3591         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  3592             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  3593         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  3594             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  3595         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  3596             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  3597
  3598         16  CF-PROC-SYS-ACCESS-SW.
  3599             20  CF-PROC-CREDIT-CLAIMS-SW.
  3600                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  3601                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  3602                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  3603                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  3604             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  3605                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  3606                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  3607             20  CF-PROC-LIFE-GNRLDGR-SW.
  3608                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  3609                     88  ACCESS-TO-LIFE             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page  64
* NSRASBL.cbl
  3610                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  3611                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  3612             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  3613                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  3614                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  3615         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  3616             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  3617             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  3618         16  CF-PROCESSOR-PRINTER               PIC X(4).
  3619
  3620         16  CF-APPROVAL-LEVEL                  PIC X.
  3621             88  APPROVAL-LEVEL-1                   VALUE '1'.
  3622             88  APPROVAL-LEVEL-2                   VALUE '2'.
  3623             88  APPROVAL-LEVEL-3                   VALUE '3'.
  3624             88  APPROVAL-LEVEL-4                   VALUE '4'.
  3625             88  APPROVAL-LEVEL-5                   VALUE '5'.
  3626
  3627         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  3628
  3629         16  CF-LANGUAGE-TYPE                   PIC X.
  3630             88  CF-LANG-IS-ENG                     VALUE 'E'.
  3631             88  CF-LANG-IS-FR                      VALUE 'F'.
  3632
  3633         16  CF-CSR-IND                         PIC X.
  3634         16  FILLER                             PIC X(239).
  3635
  3636****************************************************************
  3637*             PROCESSOR/REMINDERS RECORD                       *
  3638****************************************************************
  3639
  3640     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  3641         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  3642             20  CF-START-REMIND-DT         PIC XX.
  3643             20  CF-END-REMIND-DT           PIC XX.
  3644             20  CF-REMINDER-TEXT           PIC X(50).
  3645         16  FILLER                         PIC X(296).
  3646
  3647
  3648****************************************************************
  3649*             STATE MASTER RECORD                              *
  3650****************************************************************
  3651
  3652     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3653         16  CF-STATE-ABBREVIATION          PIC XX.
  3654         16  CF-STATE-NAME                  PIC X(25).
  3655         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  3656         16  CF-ST-CALC-QUOTE-TOLERANCE.
  3657             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  3658             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  3659             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  3660             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  3661                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3662                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3663             20  CF-ST-PREM-REJECT-SW       PIC X.
  3664                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  3665                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  3666             20  CF-ST-REF-REJECT-SW        PIC X.
  3667                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page  65
* NSRASBL.cbl
  3668                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  3669         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  3670         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  3671         16  CF-ST-REFUND-RULES.
  3672             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  3673             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  3674             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  3675         16  CF-ST-FST-PMT-EXTENSION.
  3676             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  3677             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  3678                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  3679                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  3680                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  3681                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  3682         16  CF-ST-STATE-CALL.
  3683             20  CF-ST-CALL-UNEARNED        PIC X.
  3684             20  CF-ST-CALL-RPT-CNTL        PIC X.
  3685             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  3686         16  CF-REPLACEMENT-LAW-SW          PIC X.
  3687             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  3688             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  3689         16  CF-REPLACEMENT-LETTER          PIC X(4).
  3690         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  3691         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  3692         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  3693         16  CF-ST-SPLIT-PAYMENT            PIC X.
  3694         16  FILLER                         PIC X.
  3695         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  3696             20  CF-ST-BENEFIT-CD           PIC XX.
  3697             20  CF-ST-BENEFIT-KIND         PIC X.
  3698                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  3699                 88  CF-ST-AH-KIND              VALUE 'A'.
  3700             20  CF-ST-REM-TERM-CALC        PIC X.
  3701                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  3702                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  3703                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  3704                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  3705                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  3706                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  3707                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  3708                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  3709
  3710             20  CF-ST-REFUND-CALC          PIC X.
  3711                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  3712                 88  ST-REFD-BY-R78             VALUE '1'.
  3713                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  3714                 88  ST-REFD-AS-CALIF           VALUE '3'.
  3715                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  3716                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  3717                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  3718                 88  ST-REFD-UTAH               VALUE '7'.
  3719                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  3720                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  3721                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  3722
  3723             20  CF-ST-EARNING-CALC         PIC X.
  3724                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  3725                 88  ST-EARN-BY-R78             VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page  66
* NSRASBL.cbl
  3726                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  3727                 88  ST-EARN-AS-CALIF           VALUE '3'.
  3728                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  3729                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  3730                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  3731                 88  ST-EARN-MEAN               VALUE '8'.
  3732                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  3733
  3734             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  3735                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  3736                 88  ST-OVRD-BY-R78             VALUE '1'.
  3737                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  3738                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  3739                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  3740                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  3741                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  3742                 88  ST-OVRD-MEAN               VALUE '8'.
  3743                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  3744             20  cf-st-extra-periods        pic 9.
  3745*            20  FILLER                     PIC X.
  3746
  3747         16  CF-ST-COMMISSION-CAPS.
  3748             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  3749             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  3750             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  3751             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  3752         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  3753                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  3754
  3755         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  3756
  3757         16  CF-ST-STATUTORY-INTEREST.
  3758             20  CF-ST-STAT-DATE-FROM       PIC X.
  3759                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  3760                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  3761             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  3762             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  3763             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  3764             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  3765             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  3766
  3767         16  CF-ST-OVER-SHORT.
  3768             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  3769             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  3770
  3771         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  3772
  3773         16  CF-ST-RT-CALC                  PIC X.
  3774
  3775         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  3776         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  3777         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  3778         16  CF-ST-RF-LR-CALC               PIC X.
  3779         16  CF-ST-RF-LL-CALC               PIC X.
  3780         16  CF-ST-RF-LN-CALC               PIC X.
  3781         16  CF-ST-RF-AH-CALC               PIC X.
  3782         16  CF-ST-RF-CP-CALC               PIC X.
  3783*        16  FILLER                         PIC X(206).
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page  67
* NSRASBL.cbl
  3784*CIDMOD         16  FILLER                         PIC X(192).
  3785         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  3786             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  3787         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  3788         16  CF-ST-VFY-2ND-BENE             PIC X.
  3789         16  CF-ST-CAUSAL-STATE             PIC X.
  3790         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  3791         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  3792         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  3793             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  3794         16  CF-ST-NET-ONLY-STATE           PIC X.
  3795             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  3796         16  FILLER                         PIC X(181).
  3797
  3798****************************************************************
  3799*             BENEFIT MASTER RECORD                            *
  3800****************************************************************
  3801
  3802     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3803         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  3804             20  CF-BENEFIT-CODE            PIC XX.
  3805             20  CF-BENEFIT-NUMERIC  REDEFINES
  3806                 CF-BENEFIT-CODE            PIC XX.
  3807             20  CF-BENEFIT-ALPHA           PIC XXX.
  3808             20  CF-BENEFIT-DESCRIP         PIC X(10).
  3809             20  CF-BENEFIT-COMMENT         PIC X(10).
  3810
  3811             20  CF-LF-COVERAGE-TYPE        PIC X.
  3812                 88  CF-REDUCING                VALUE 'R'.
  3813                 88  CF-LEVEL                   VALUE 'L' 'P'.
  3814
  3815             20  CF-SPECIAL-CALC-CD         PIC X.
  3816                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  3817                 88  CF-NP-0-MO-INT             VALUE 'A'.
  3818                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  3819                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  3820                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  3821                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  3822                 88  CF-FARM-PLAN               VALUE 'F'.
  3823                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  3824                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  3825                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  3826                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  3827                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  3828                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  3829                 88  CF-PRUDENTIAL              VALUE 'P'.
  3830                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  3831                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  3832                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  3833                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  3834                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  3835                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  3836
  3837             20  CF-JOINT-INDICATOR         PIC X.
  3838                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  3839
  3840*            20  FILLER                     PIC X(12).
  3841             20  cf-maximum-benefits        pic s999 comp-3.
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page  68
* NSRASBL.cbl
  3842             20  FILLER                     PIC X(09).
  3843             20  CF-BENEFIT-CATEGORY        PIC X.
  3844             20  CF-LOAN-TYPE               PIC X(8).
  3845
  3846             20  CF-CO-REM-TERM-CALC        PIC X.
  3847                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  3848                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  3849                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  3850                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  3851                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  3852
  3853             20  CF-CO-EARNINGS-CALC        PIC X.
  3854                 88  CO-EARN-BY-R78             VALUE '1'.
  3855                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  3856                 88  CO-EARN-AS-CALIF           VALUE '3'.
  3857                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  3858                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  3859                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  3860                 88  CO-EARN-AS-MEAN            VALUE '8'.
  3861                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  3862
  3863             20  CF-CO-REFUND-CALC          PIC X.
  3864                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  3865                 88  CO-REFD-BY-R78             VALUE '1'.
  3866                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  3867                 88  CO-REFD-AS-CALIF           VALUE '3'.
  3868                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  3869                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  3870                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  3871                 88  CO-REFD-MEAN               VALUE '8'.
  3872                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  3873                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  3874                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  3875
  3876             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  3877                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  3878                 88  CO-OVRD-BY-R78             VALUE '1'.
  3879                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  3880                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  3881                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  3882                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  3883                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  3884                 88  CO-OVRD-MEAN               VALUE '8'.
  3885                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  3886
  3887             20  CF-CO-BEN-I-G-CD           PIC X.
  3888                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  3889                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  3890                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  3891
  3892         16  FILLER                         PIC X(304).
  3893
  3894
  3895****************************************************************
  3896*             CARRIER MASTER RECORD                            *
  3897****************************************************************
  3898
  3899     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page  69
* NSRASBL.cbl
  3900         16  CF-ADDRESS-DATA.
  3901             20  CF-MAIL-TO-NAME            PIC X(30).
  3902             20  CF-IN-CARE-OF              PIC X(30).
  3903             20  CF-ADDRESS-LINE-1          PIC X(30).
  3904             20  CF-ADDRESS-LINE-2          PIC X(30).
  3905             20  CF-CITY-STATE              PIC X(30).
  3906             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  3907             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  3908
  3909         16  CF-CLAIM-NO-CONTROL.
  3910             20  CF-CLAIM-NO-METHOD         PIC X.
  3911                 88  CLAIM-NO-MANUAL            VALUE '1'.
  3912                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  3913                 88  CLAIM-NO-SEQ               VALUE '3'.
  3914                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  3915             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  3916                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  3917                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  3918                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  3919
  3920         16  CF-CHECK-NO-CONTROL.
  3921             20  CF-CHECK-NO-METHOD         PIC X.
  3922                 88  CHECK-NO-MANUAL            VALUE '1'.
  3923                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  3924                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  3925                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  3926             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  3927                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  3928
  3929         16  CF-DOMICILE-STATE              PIC XX.
  3930
  3931         16  CF-EXPENSE-CONTROLS.
  3932             20  CF-EXPENSE-METHOD          PIC X.
  3933                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  3934                 88  DOLLARS-PER-PMT            VALUE '2'.
  3935                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  3936                 88  DOLLARS-PER-MONTH          VALUE '4'.
  3937             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  3938             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  3939
  3940         16  CF-CORRESPONDENCE-CONTROL.
  3941             20  CF-LETTER-RESEND-OPT       PIC X.
  3942                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  3943                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  3944             20  FILLER                     PIC X(4).
  3945
  3946         16  CF-RESERVE-CONTROLS.
  3947             20  CF-MANUAL-SW               PIC X.
  3948                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  3949             20  CF-FUTURE-SW               PIC X.
  3950                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  3951             20  CF-PTC-SW                  PIC X.
  3952                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  3953             20  CF-IBNR-SW                 PIC X.
  3954                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  3955             20  CF-PTC-LF-SW               PIC X.
  3956                 88  CF-LF-PTC-USED             VALUE '1'.
  3957             20  CF-CDT-ACCESS-METHOD       PIC X.
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page  70
* NSRASBL.cbl
  3958                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  3959                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  3960                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  3961             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  3962
  3963         16  CF-CLAIM-CALC-METHOD           PIC X.
  3964             88  360-PLUS-MONTHS                VALUE '1'.
  3965             88  365-PLUS-MONTHS                VALUE '2'.
  3966             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  3967             88  360-DAILY                      VALUE '4'.
  3968             88  365-DAILY                      VALUE '5'.
  3969
  3970         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  3971         16  FILLER                         PIC X(11).
  3972
  3973         16  CF-LIMIT-AMOUNTS.
  3974             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  3975             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  3976             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  3977             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  3978             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  3979             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  3980             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  3981             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  3982             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  3983             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  3984
  3985         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  3986         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  3987         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  3988
  3989         16  CF-ZIP-CODE.
  3990             20  CF-ZIP-PRIME.
  3991                 24  CF-ZIP-1ST             PIC X.
  3992                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3993                 24  FILLER                 PIC X(4).
  3994             20  CF-ZIP-PLUS4               PIC X(4).
  3995         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  3996             20  CF-CAN-POSTAL-1            PIC XXX.
  3997             20  CF-CAN-POSTAL-2            PIC XXX.
  3998             20  FILLER                     PIC XXX.
  3999
  4000         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  4001         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  4002         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  4003
  4004         16  CF-RATING-SWITCH               PIC X.
  4005             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  4006             88  CF-NO-RATING                   VALUE 'N'.
  4007
  4008         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  4009
  4010         16  CF-CARRIER-OVER-SHORT.
  4011             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  4012             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  4013
  4014         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  4015         16  CF-SECPAY-SWITCH               PIC X.
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page  71
* NSRASBL.cbl
  4016             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  4017             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  4018         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  4019         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  4020         16  FILLER                         PIC X(444).
  4021*        16  FILLER                         PIC X(452).
  4022
  4023
  4024****************************************************************
  4025*             MORTALITY MASTER RECORD                          *
  4026****************************************************************
  4027
  4028     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4029         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  4030                                INDEXED BY CF-MORT-NDX.
  4031             20  CF-MORT-TABLE              PIC X(5).
  4032             20  CF-MORT-TABLE-TYPE         PIC X.
  4033                 88  CF-MORT-JOINT              VALUE 'J'.
  4034                 88  CF-MORT-SINGLE             VALUE 'S'.
  4035                 88  CF-MORT-COMBINED           VALUE 'C'.
  4036                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  4037                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  4038             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  4039             20  CF-MORT-AGE-METHOD         PIC XX.
  4040                 88  CF-AGE-LAST                VALUE 'AL'.
  4041                 88  CF-AGE-NEAR                VALUE 'AN'.
  4042             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  4043             20  CF-MORT-ADJUSTMENT-DIRECTION
  4044                                            PIC X.
  4045                 88  CF-MINUS                   VALUE '-'.
  4046                 88  CF-PLUS                    VALUE '+'.
  4047             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  4048             20  CF-MORT-JOINT-CODE         PIC X.
  4049                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  4050             20  CF-MORT-PC-Q               PIC X.
  4051                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  4052             20  CF-MORT-TABLE-CODE         PIC X(4).
  4053             20  CF-MORT-COMMENTS           PIC X(15).
  4054             20  FILLER                     PIC X(14).
  4055
  4056         16  FILLER                         PIC X(251).
  4057
  4058
  4059****************************************************************
  4060*             BUSSINESS TYPE MASTER RECORD                     *
  4061****************************************************************
  4062
  4063     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4064* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  4065* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  4066* AND RECORD 05 IS TYPES 81-99
  4067         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  4068             20  CF-BUSINESS-TITLE          PIC  X(19).
  4069             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  4070                                            PIC S9V9(4) COMP-3.
  4071             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  4072             20  FILLER                     PIC  X.
  4073         16  FILLER                         PIC  X(248).
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page  72
* NSRASBL.cbl
  4074
  4075
  4076****************************************************************
  4077*             TERMINAL MASTER RECORD                           *
  4078****************************************************************
  4079
  4080     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4081
  4082         16  CF-COMPANY-TERMINALS.
  4083             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  4084                                  PIC X(4).
  4085         16  FILLER               PIC X(248).
  4086
  4087
  4088****************************************************************
  4089*             LIFE EDIT MASTER RECORD                          *
  4090****************************************************************
  4091
  4092     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4093         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  4094             20  CF-LIFE-CODE-IN            PIC XX.
  4095             20  CF-LIFE-CODE-OUT           PIC XX.
  4096         16  FILLER                         PIC X(248).
  4097
  4098
  4099****************************************************************
  4100*             AH EDIT MASTER RECORD                            *
  4101****************************************************************
  4102
  4103     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4104         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  4105             20  CF-AH-CODE-IN              PIC XXX.
  4106             20  CF-AH-CODE-OUT             PIC XX.
  4107         16  FILLER                         PIC X(248).
  4108
  4109
  4110****************************************************************
  4111*             CREDIBILITY TABLES                               *
  4112****************************************************************
  4113
  4114     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4115         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  4116                             INDEXED BY CF-CRDB-NDX.
  4117             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  4118             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  4119             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  4120         16  FILLER                         PIC  X(332).
  4121
  4122
  4123****************************************************************
  4124*             REPORT CUSTOMIZATION RECORD                      *
  4125****************************************************************
  4126
  4127     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  4128         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  4129             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  4130             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  4131             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page  73
* NSRASBL.cbl
  4132**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  4133****       A T-TRANSFER.                                   ****
  4134             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  4135
  4136         16  FILLER                         PIC XX.
  4137
  4138         16  CF-CARRIER-CNTL-OPT.
  4139             20  CF-CARRIER-OPT-SEQ         PIC 9.
  4140                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  4141                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  4142             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  4143                                            PIC X.
  4144         16  CF-GROUP-CNTL-OPT.
  4145             20  CF-GROUP-OPT-SEQ           PIC 9.
  4146                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  4147                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  4148             20  CF-GROUP-SELECT OCCURS 3 TIMES
  4149                                            PIC X(6).
  4150         16  CF-STATE-CNTL-OPT.
  4151             20  CF-STATE-OPT-SEQ           PIC 9.
  4152                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  4153                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  4154             20  CF-STATE-SELECT OCCURS 3 TIMES
  4155                                            PIC XX.
  4156         16  CF-ACCOUNT-CNTL-OPT.
  4157             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  4158                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  4159                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  4160             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  4161                                            PIC X(10).
  4162         16  CF-BUS-TYP-CNTL-OPT.
  4163             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  4164                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  4165                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  4166             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  4167                                            PIC XX.
  4168         16  CF-LF-TYP-CNTL-OPT.
  4169             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  4170                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  4171                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  4172             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  4173                                            PIC XX.
  4174         16  CF-AH-TYP-CNTL-OPT.
  4175             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  4176                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  4177                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  4178             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  4179                                            PIC XX.
  4180         16  CF-REPTCD1-CNTL-OPT.
  4181             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  4182                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  4183                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  4184             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  4185                                            PIC X(10).
  4186         16  CF-REPTCD2-CNTL-OPT.
  4187             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  4188                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  4189                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page  74
* NSRASBL.cbl
  4190             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  4191                                            PIC X(10).
  4192         16  CF-USER1-CNTL-OPT.
  4193             20  CF-USER1-OPT-SEQ           PIC 9.
  4194                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  4195                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  4196             20  CF-USER1-SELECT OCCURS 3 TIMES
  4197                                            PIC X(10).
  4198         16  CF-USER2-CNTL-OPT.
  4199             20  CF-USER2-OPT-SEQ           PIC 9.
  4200                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  4201                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  4202             20  CF-USER2-SELECT OCCURS 3 TIMES
  4203                                            PIC X(10).
  4204         16  CF-USER3-CNTL-OPT.
  4205             20  CF-USER3-OPT-SEQ           PIC 9.
  4206                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  4207                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  4208             20  CF-USER3-SELECT OCCURS 3 TIMES
  4209                                            PIC X(10).
  4210         16  CF-USER4-CNTL-OPT.
  4211             20  CF-USER4-OPT-SEQ           PIC 9.
  4212                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  4213                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  4214             20  CF-USER4-SELECT OCCURS 3 TIMES
  4215                                            PIC X(10).
  4216         16  CF-USER5-CNTL-OPT.
  4217             20  CF-USER5-OPT-SEQ           PIC 9.
  4218                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  4219                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  4220             20  CF-USER5-SELECT OCCURS 3 TIMES
  4221                                            PIC X(10).
  4222         16  CF-REINS-CNTL-OPT.
  4223             20  CF-REINS-OPT-SEQ           PIC 9.
  4224                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  4225                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  4226             20  CF-REINS-SELECT OCCURS 3 TIMES.
  4227                 24  CF-REINS-PRIME         PIC XXX.
  4228                 24  CF-REINS-SUB           PIC XXX.
  4229
  4230         16  CF-AGENT-CNTL-OPT.
  4231             20  CF-AGENT-OPT-SEQ           PIC 9.
  4232                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  4233                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  4234             20  CF-AGENT-SELECT OCCURS 3 TIMES
  4235                                            PIC X(10).
  4236
  4237         16  FILLER                         PIC X(43).
  4238
  4239         16  CF-LOSS-RATIO-SELECT.
  4240             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  4241             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  4242         16  CF-ENTRY-DATE-SELECT.
  4243             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  4244             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  4245         16  CF-EFFECTIVE-DATE-SELECT.
  4246             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  4247             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page  75
* NSRASBL.cbl
  4248
  4249         16  CF-EXCEPTION-LIST-IND          PIC X.
  4250             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  4251
  4252         16  FILLER                         PIC X(318).
  4253
  4254****************************************************************
  4255*                  EXCEPTION REPORTING RECORD                  *
  4256****************************************************************
  4257
  4258     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  4259         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  4260             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  4261
  4262         16  CF-COMBINED-LIFE-AH-OPT.
  4263             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  4264             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  4265             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  4266             20  CF-CANCELLATION-RATIO      PIC S9(02).
  4267
  4268         16  CF-LIFE-OPT.
  4269             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4270             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4271             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4272             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4273             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4274             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4275             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4276             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4277             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4278             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  4279
  4280         16  CF-AH-OPT.
  4281             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4282             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4283             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4284             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4285             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4286             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4287             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4288             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4289             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4290             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  4291
  4292         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  4293             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  4294             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  4295             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  4296
  4297         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  4298
  4299         16  FILLER                         PIC X(673).
  4300
  4301
  4302****************************************************************
  4303*             MORTGAGE SYSTEM PLAN RECORD                      *
  4304****************************************************************
  4305
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page  76
* NSRASBL.cbl
  4306     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  4307         16  CF-PLAN-TYPE                   PIC X.
  4308             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  4309             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  4310             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  4311         16  CF-PLAN-ABBREV                 PIC XXX.
  4312         16  CF-PLAN-DESCRIPT               PIC X(10).
  4313         16  CF-PLAN-NOTES                  PIC X(20).
  4314         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  4315         16  CF-PLAN-UNDERWRITING.
  4316             20  CF-PLAN-TERM-DATA.
  4317                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  4318                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  4319             20  CF-PLAN-AGE-DATA.
  4320                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  4321                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  4322                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  4323             20  CF-PLAN-BENEFIT-DATA.
  4324                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4325                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4326                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  4327                                            PIC S9(7)V99  COMP-3.
  4328         16  CF-PLAN-POLICY-FORMS.
  4329             20  CF-POLICY-FORM             PIC X(12).
  4330             20  CF-MASTER-APPLICATION      PIC X(12).
  4331             20  CF-MASTER-POLICY           PIC X(12).
  4332         16  CF-PLAN-RATING.
  4333             20  CF-RATE-CODE               PIC X(5).
  4334             20  CF-SEX-RATING              PIC X.
  4335                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  4336                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  4337             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  4338             20  CF-SUB-STD-TYPE            PIC X.
  4339                 88  CF-PCT-OF-PREM            VALUE '1'.
  4340                 88  CF-PCT-OF-BENE            VALUE '2'.
  4341         16  CF-PLAN-PREM-TOLERANCES.
  4342             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  4343             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  4344         16  CF-PLAN-PYMT-TOLERANCES.
  4345             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  4346             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  4347         16  CF-PLAN-MISC-DATA.
  4348             20  FILLER                     PIC X.
  4349             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  4350             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  4351         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  4352         16  CF-PLAN-IND-GRP                PIC X.
  4353             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  4354                                                     '1'.
  4355             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  4356                                                     '2'.
  4357         16  CF-MIB-SEARCH-SW               PIC X.
  4358             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  4359             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  4360             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  4361             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  4362         16  CF-ALPHA-SEARCH-SW             PIC X.
  4363             88  CF-MIB-ALPHA-ALL              VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page  77
* NSRASBL.cbl
  4364             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  4365             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  4366             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  4367             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  4368             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  4369             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  4370             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  4371             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  4372             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  4373                                                     'A' 'B' 'C'
  4374                                                     'X' 'Y' 'Z'.
  4375         16  CF-EFF-DT-RULE-SW              PIC X.
  4376             88  CF-EFF-DT-ENTER               VALUE 'E'.
  4377             88  CF-EFF-DT-MONTH               VALUE 'M'.
  4378             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  4379             88  CF-EFF-DT-SEMI                VALUE 'S'.
  4380             88  CF-EFF-DT-ANN                 VALUE 'A'.
  4381         16  FILLER                         PIC X(4).
  4382         16  CF-HEALTH-QUESTIONS            PIC X.
  4383             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  4384         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  4385         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  4386         16  CF-PLAN-SNGL-JNT               PIC X.
  4387             88  CF-COMBINED-PLAN              VALUE 'C'.
  4388             88  CF-JNT-PLAN                   VALUE 'J'.
  4389             88  CF-SNGL-PLAN                  VALUE 'S'.
  4390         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  4391         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  4392         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  4393         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  4394         16  CF-RERATE-CNTL                 PIC  X.
  4395             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  4396             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  4397             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  4398             88  CF-AUTO-RECALC                 VALUE '4'.
  4399         16  CF-BENEFIT-TYPE                PIC  X.
  4400             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  4401             88  CF-BENEFIT-REDUCES             VALUE '2'.
  4402         16  CF-POLICY-FEE                  PIC S999V99
  4403                                                    COMP-3.
  4404         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  4405         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  4406         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  4407         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  4408         16  FILLER                         PIC  X(32).
  4409         16  CF-TERMINATION-FORM            PIC  X(04).
  4410         16  FILLER                         PIC  X(08).
  4411         16  CF-CLAIM-CAP                   PIC S9(7)V99
  4412                                                       COMP-3.
  4413         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  4414         16  CF-ISSUE-LETTER                PIC  X(4).
  4415         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  4416         16  CF-DEPENDENT-COVERAGE          PIC  X.
  4417             88  CF-YES-DEP-COV                 VALUE 'Y'.
  4418             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  4419         16  CF-MP-REFUND-CALC              PIC X.
  4420             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  4421             88  CF-MP-REFD-BY-R78              VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page  78
* NSRASBL.cbl
  4422             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  4423             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  4424             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  4425             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  4426             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  4427             88  CF-MP-REFD-MEAN                VALUE '8'.
  4428         16  CF-ALT-RATE-CODE               PIC  X(5).
  4429
  4430
  4431         16  FILLER                         PIC X(498).
  4432****************************************************************
  4433*             MORTGAGE COMPANY MASTER RECORD                   *
  4434****************************************************************
  4435
  4436     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4437         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  4438         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  4439             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  4440             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  4441             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  4442             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  4443             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  4444
  4445         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  4446         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  4447         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  4448         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  4449         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  4450
  4451         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  4452             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  4453         16  CF-MP-RECON-USE-IND            PIC X(1).
  4454             88  CF-MP-USE-RECON             VALUE 'Y'.
  4455         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  4456             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  4457         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  4458             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  4459             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  4460         16  FILLER                         PIC X(1).
  4461         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  4462             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  4463         16  CF-MORTG-MIB-VERSION           PIC X.
  4464             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  4465             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  4466             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  4467         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  4468             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  4469                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  4470             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  4471                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  4472             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  4473                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  4474             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  4475                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  4476             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  4477                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  4478             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  4479                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page  79
* NSRASBL.cbl
  4480         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  4481         16  FILLER                         PIC X(7).
  4482         16  CF-MORTG-DESTINATION-SYMBOL.
  4483             20  CF-MORTG-MIB-COMM          PIC X(5).
  4484             20  CF-MORTG-MIB-TERM          PIC X(5).
  4485         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  4486             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  4487         16  FILLER                         PIC X(03).
  4488         16  CF-MP-CHECK-NO-CONTROL.
  4489             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  4490                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  4491                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  4492                                                ' ' LOW-VALUES.
  4493                 88  CF-MP-CHECK-NO-PRE-PRINTED
  4494                                               VALUE '3'.
  4495         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  4496         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  4497         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  4498             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  4499                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  4500             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  4501                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  4502             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  4503                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  4504             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  4505                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  4506             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  4507                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  4508             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  4509                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  4510         16  CF-MORTG-BILLING-AREA.
  4511             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  4512                                            PIC X.
  4513         16  CF-MORTG-MONTH-END-DT          PIC XX.
  4514         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  4515         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  4516         16  CF-MORTG-MIB-DEST-SW           PIC X.
  4517             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  4518             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  4519         16  FILLER                         PIC X.
  4520         16  CF-MORTG-LABEL-CONTROL         PIC X.
  4521             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  4522             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  4523         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  4524         16  FILLER                         PIC X(8).
  4525         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  4526         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  4527         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  4528         16  CF-ACH-COMPANY-ID.
  4529             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  4530                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  4531                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  4532                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  4533             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  4534         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  4535             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  4536         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  4537             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page  80
* NSRASBL.cbl
  4538             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  4539         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  4540         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  4541         16  FILLER                         PIC X(536).
  4542
  4543****************************************************************
  4544*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  4545****************************************************************
  4546
  4547     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  4548         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  4549             20  CF-FEMALE-HEIGHT.
  4550                 24  CF-FEMALE-FT           PIC 99.
  4551                 24  CF-FEMALE-IN           PIC 99.
  4552             20  CF-FEMALE-MIN-WT           PIC 999.
  4553             20  CF-FEMALE-MAX-WT           PIC 999.
  4554         16  FILLER                         PIC X(428).
  4555
  4556     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  4557         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  4558             20  CF-MALE-HEIGHT.
  4559                 24  CF-MALE-FT             PIC 99.
  4560                 24  CF-MALE-IN             PIC 99.
  4561             20  CF-MALE-MIN-WT             PIC 999.
  4562             20  CF-MALE-MAX-WT             PIC 999.
  4563         16  FILLER                         PIC X(428).
  4564******************************************************************
  4565*             AUTOMATIC ACTIVITY RECORD                          *
  4566******************************************************************
  4567     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  4568         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  4569             20  CF-SYS-ACTIVE-SW           PIC X(01).
  4570             20  CF-SYS-LETTER-ID           PIC X(04).
  4571             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  4572             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  4573             20  CF-SYS-RESET-SW            PIC X(01).
  4574             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  4575             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  4576
  4577         16  FILLER                         PIC X(50).
  4578
  4579         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  4580             20  CF-USER-ACTIVE-SW          PIC X(01).
  4581             20  CF-USER-LETTER-ID          PIC X(04).
  4582             20  CF-USER-RESEND-DAYS        PIC 9(03).
  4583             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  4584             20  CF-USER-RESET-SW           PIC X(01).
  4585             20  CF-USER-REPORT-DAYS        PIC 9(03).
  4586             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  4587             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  4588
  4589         16  FILLER                         PIC X(246).
  4590*                                COPY NSCASVARS.
  4591******************************************************************
  4592*                   C H A N G E   L O G
  4593*
  4594*        CURRENT SIZE - 6180
  4595*
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page  81
* NSRASBL.cbl
  4596* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4597*-----------------------------------------------------------------
  4598*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4599* EFFECTIVE    NUMBER
  4600*-----------------------------------------------------------------
  4601* 101612  CR2011022800001  AJRA  REMOVE SIGN FROM CHG TOTALS
  4602* 110612  CR2012101700002  AJRA  ADD NEW FIELDS
  4603* 091213  CR2013090300001  AJRA  ADD NEXT BUSINESS DATE
  4604* 121015  CR2015100900001  TANA  ADD VIN NUMBER
  4605******************************************************************
  4606 01 NAPER-OUTPUT-DATA.
  4607    05  F                       PIC X(07) VALUE "LETTER=".
  4608    05  OUT-LETTER              PIC X(06) VALUE SPACES.
  4609    05  F                       PIC X(08) VALUE "~PROCID=".
  4610    05  OUT-PROC-ID             PIC X(04) VALUE SPACES.
  4611    05  F                       PIC X(10) VALUE "~PROCNAME=".
  4612    05  OUT-PROC-NAME           PIC X(30) VALUE SPACES.
  4613    05  F                       PIC X(11) VALUE "~PROCTITLE=".
  4614    05  OUT-PROC-TITLE          PIC X(30) VALUE SPACES.
  4615    05  F                       PIC X(09) VALUE "~CSRNAME=".
  4616    05  OUT-CSR-NAME            PIC X(30) VALUE SPACES.
  4617    05  F                       PIC X(10) VALUE "~CSRTITLE=".
  4618    05  OUT-CSR-TITLE           PIC X(30) VALUE SPACES.
  4619    05  F                       PIC X(06) VALUE "~CARR=".
  4620    05  OUT-CARRIER             PIC X(01) VALUE SPACES.
  4621    05  F                       PIC X(10) VALUE "~GROUPING=".
  4622    05  OUT-GROUPING            PIC X(06) VALUE SPACES.
  4623    05  F                       PIC X(08) VALUE "~CERTST=".
  4624    05  OUT-STATE               PIC X(02) VALUE SPACES.
  4625    05  F                       PIC X(09) VALUE "~ACCOUNT=".
  4626    05  OUT-ACCOUNT             PIC X(10) VALUE SPACES.
  4627    05  F                       PIC X(11) VALUE "~CERTEFFDT=".
  4628    05  OUT-CERT-EFF-DT         PIC X(21) VALUE SPACES.
  4629    05  F                       PIC X(07) VALUE "~CRTNO=".
  4630    05  OUT-CERT-NO             PIC X(11) VALUE SPACES.
  4631    05  F                       PIC X(08) VALUE "~CRTSUF=".
  4632    05  OUT-CERT-SFX            PIC X(01) VALUE SPACES.
  4633    05  F                       PIC X(08) VALUE "~ILNAME=".
  4634    05  OUT-ILNAME              PIC X(15) VALUE SPACES.
  4635    05  F                       PIC X(08) VALUE "~IFNAME=".
  4636    05  OUT-IFNAME              PIC X(10) VALUE SPACES.
  4637    05  F                       PIC X(08) VALUE "~IFINIT=".
  4638    05  OUT-IFINIT              PIC X(01) VALUE SPACES.
  4639    05  F                       PIC X(08) VALUE "~IMINIT=".
  4640    05  OUT-IMINIT              PIC X(01) VALUE SPACES.
  4641    05  F                       PIC X(09) VALUE "~IISSAGE=".
  4642    05  OUT-IAGE                PIC 99    BLANK WHEN ZERO.
  4643    05  F                       PIC X(06) VALUE "~ISEX=".
  4644    05  OUT-ISEX                PIC X(01) VALUE SPACES.
  4645    05  F                       PIC X(10) VALUE "~INSADDR1=".
  4646    05  OUT-INS-ADDR1           PIC X(30) VALUE SPACES.
  4647    05  F                       PIC X(10) VALUE "~INSADDR2=".
  4648    05  OUT-INS-ADDR2           PIC X(30) VALUE SPACES.
  4649    05  F                       PIC X(09) VALUE "~INSCITY=".
  4650    05  OUT-INS-CITY            PIC X(30) VALUE SPACES.
  4651    05  F                       PIC X(10) VALUE "~INSSTATE=".
  4652    05  OUT-INS-STATE           PIC X(02) VALUE SPACES.
  4653    05  F                       PIC X(08) VALUE "~INSZIP=".
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page  82
* NSRASBL.cbl
  4654    05  OUT-INS-ZIP             PIC X(09) VALUE SPACES.
  4655    05  F                       PIC X(05) VALUE "~SSN=".
  4656    05  OUT-SOC-SEC-NO          PIC X(11) VALUE SPACES.
  4657    05  F                       PIC X(07) VALUE "~MEMNO=".
  4658    05  OUT-MEMBER-NO           PIC X(12) VALUE SPACES.
  4659    05  F                       PIC X(08) VALUE "~JLNAME=".
  4660    05  OUT-JLNAME              PIC X(15) VALUE SPACES.
  4661    05  F                       PIC X(08) VALUE "~JFNAME=".
  4662    05  OUT-JFNAME              PIC X(10) VALUE SPACES.
  4663    05  F                       PIC X(08) VALUE "~JMINIT=".
  4664    05  OUT-JMINIT              PIC X(01) VALUE SPACES.
  4665    05  F                       PIC X(08) VALUE "~JNTAGE=".
  4666    05  OUT-JAGE                PIC 99    BLANK WHEN ZERO.
  4667    05  F                       PIC X(10) VALUE "~ACCTNAME=".
  4668    05  OUT-ACCT-NAME           PIC X(30) VALUE SPACES.
  4669    05  F                       PIC X(11) VALUE "~ACCTADDR1=".
  4670    05  OUT-ACCT-ADDR1          PIC X(30) VALUE SPACES.
  4671    05  F                       PIC X(11) VALUE "~ACCTADDR2=".
  4672    05  OUT-ACCT-ADDR2          PIC X(30) VALUE SPACES.
  4673    05  F                       PIC X(10) VALUE "~ACCTCITY=".
  4674    05  OUT-ACCT-CITY           PIC X(30) VALUE SPACES.
  4675    05  F                       PIC X(11) VALUE "~ACCTSTATE=".
  4676    05  OUT-ACCT-STATE          PIC X(02) VALUE SPACES.
  4677    05  F                       PIC X(09) VALUE "~ACCTZIP=".
  4678    05  OUT-ACCT-ZIP            PIC X(10) VALUE SPACES.
  4679    05  F                       PIC X(11) VALUE "~ACCTPHONE=".
  4680    05  OUT-ACCT-PHONE          PIC X(10) VALUE SPACES.
  4681    05  F                       PIC X(11) VALUE "~ACCTCNTRL=".
  4682    05  OUT-ACCT-CNTRL-NAME     PIC X(30) VALUE SPACES.
  4683    05  F                       PIC X(09) VALUE "~BUSTYPE=".
  4684    05  OUT-ACCT-BUS-TYPE       PIC X(02) VALUE SPACES.
  4685    05  F                       PIC X(10) VALUE "~BENENAME=".
  4686    05  OUT-BENE-NAME           PIC X(30) VALUE SPACES.
  4687    05  F                       PIC X(11) VALUE "~BENEADDR1=".
  4688    05  OUT-BENE-ADDR1          PIC X(30) VALUE SPACES.
  4689    05  F                       PIC X(11) VALUE "~BENEADDR2=".
  4690    05  OUT-BENE-ADDR2          PIC X(30) VALUE SPACES.
  4691    05  F                       PIC X(10) VALUE "~BENECITY=".
  4692    05  OUT-BENE-CITY           PIC X(30) VALUE SPACES.
  4693    05  F                       PIC X(11) VALUE "~BENESTATE=".
  4694    05  OUT-BENE-STATE          PIC X(02) VALUE SPACES.
  4695    05  F                       PIC X(09) VALUE "~BENEZIP=".
  4696    05  OUT-BENE-ZIP            PIC X(09) VALUE SPACES.
  4697    05  F                       PIC X(10) VALUE "~CARRNAME=".
  4698    05  OUT-CARR-NAME           PIC X(30) VALUE SPACES.
  4699    05  F                       PIC X(08) VALUE "~RESPNO=".
  4700    05  OUT-RESP-NO             PIC X(10) VALUE SPACES.
  4701    05  F                       PIC X(12) VALUE "~COACCTNAME=".
  4702    05  OUT-COMP-NAME           PIC X(30) VALUE SPACES.
  4703    05  F                       PIC X(12) VALUE "~COMAILNAME=".
  4704    05  OUT-COMP-MAIL-TO        PIC X(30) VALUE SPACES.
  4705    05  F                       PIC X(11) VALUE "~COMPADDR1=".
  4706    05  OUT-COMP-ADDR1          PIC X(30) VALUE SPACES.
  4707    05  F                       PIC X(11) VALUE "~COMPADDR2=".
  4708    05  OUT-COMP-ADDR2          PIC X(30) VALUE SPACES.
  4709    05  F                       PIC X(10) VALUE "~COMPCITY=".
  4710    05  OUT-COMP-CITY           PIC X(30) VALUE SPACES.
  4711    05  F                       PIC X(11) VALUE "~COMPSTATE=".
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page  83
* NSRASBL.cbl
  4712    05  OUT-COMP-STATE          PIC X(02) VALUE SPACES.
  4713    05  F                       PIC X(09) VALUE "~COMPZIP=".
  4714    05  OUT-COMP-ZIP            PIC X(09) VALUE SPACES.
  4715    05  F                       PIC X(11) VALUE "~COMPPHONE=".
  4716    05  OUT-COMP-PHONE          PIC X(10) VALUE SPACES.
  4717    05  F                       PIC X(09) VALUE "~COMPFAX=".
  4718    05  OUT-COMP-FAX            PIC X(10) VALUE SPACES.
  4719    05  F                       PIC X(12) VALUE "~COMPSTATUS=".
  4720    05  OUT-COMP-STATUS         PIC X(01) VALUE SPACES.
  4721    05  F                       PIC X(12) VALUE "~COMPBILLSW=".
  4722    05  OUT-BILL-SW             PIC X(01) VALUE SPACES.
  4723    05  F                       PIC X(08) VALUE "~RPTCD1=".
  4724    05  OUT-RPT-CD1             PIC X(10) VALUE SPACES.
  4725    05  F                       PIC X(08) VALUE "~RPTCD2=".
  4726    05  OUT-RPT-CD2             PIC X(10) VALUE SPACES.
  4727    05  F                       PIC X(09) VALUE "~ENTRYDT=".
  4728    05  OUT-ENTRY-DT            PIC X(21) VALUE SPACES.
  4729    05  F                       PIC X(07) VALUE "~BATCH=".
  4730    05  OUT-ENTRY-BATCH         PIC X(06) VALUE SPACES.
  4731    05  F                       PIC X(11) VALUE "~ENTSTATUS=".
  4732    05  OUT-ENTRY-STATUS        PIC X(01) VALUE SPACES.
  4733    05  F                       PIC X(10) VALUE "~1STPMTDT=".
  4734    05  OUT-1ST-PMT-DT          PIC X(21) VALUE SPACES.
  4735    05  F                       PIC X(05) VALUE "~APR=".
  4736    05  OUT-LOAN-APR            PIC 999.9(4)  BLANK WHEN ZERO.
  4737    05  F                       PIC X(08) VALUE "~LNTERM=".
  4738    05  OUT-LOAN-TERM           PIC 999   BLANK WHEN ZERO.
  4739    05  F                       PIC X(11) VALUE "~RATECLASS=".
  4740    05  OUT-RATE-CLASS          PIC X(02) VALUE SPACES.
  4741    05  F                       PIC X(09) VALUE "~EXTDAYS=".
  4742    05  OUT-EXT-DAYS            PIC 999   BLANK WHEN ZERO.
  4743    05  F                       PIC X(09) VALUE "~CSRCODE=".
  4744    05  OUT-CSR-CODE            PIC X(04) VALUE SPACES.
  4745    05  F                       PIC X(07) VALUE "~UCODE=".
  4746    05  OUT-UCODE               PIC X(01) VALUE SPACES.
  4747    05  F                       PIC X(10) VALUE "~PREMTYPE=".
  4748    05  OUT-PREM-TYPE           PIC X(01) VALUE SPACES.
  4749    05  F                       PIC X(12) VALUE "~INDGRPTYPE=".
  4750    05  OUT-IND-GRP             PIC X(01) VALUE SPACES.
  4751    05  F                       PIC X(06) VALUE "~SKIP=".
  4752    05  OUT-SKIP-CD             PIC X(01) VALUE SPACES.
  4753    05  F                       PIC X(06) VALUE "~MODE=".
  4754    05  OUT-PMT-MODE            PIC X(01) VALUE SPACES.
  4755    05  F                       PIC X(09) VALUE "~LOANOFF=".
  4756    05  OUT-LOAN-OFF            PIC X(05) VALUE SPACES.
  4757    05  F                       PIC X(06) VALUE "~RTBL=".
  4758    05  OUT-REIN-TABLE          PIC X(03) VALUE SPACES.
  4759    05  F                       PIC X(10) VALUE "~SPECREIN=".
  4760    05  OUT-SPEC-REIN           PIC X(01) VALUE SPACES.
  4761    05  F                       PIC X(09) VALUE "~LFBENCD=".
  4762    05  OUT-LF-BENCD            PIC X(02) VALUE SPACES.
  4763    05  F                       PIC X(08) VALUE "~LFTERM=".
  4764    05  OUT-LF-TERM             PIC 999   BLANK WHEN ZERO.
  4765    05  F                       PIC X(07) VALUE "~LFDEV=".
  4766    05  OUT-LF-DEV-CD           PIC X(03) VALUE SPACES.
  4767    05  F                       PIC X(10) VALUE "~LFDEVPCT=".
  4768    05  OUT-LF-DEV-PCT          PIC 9.9(6)  BLANK WHEN ZERO.
  4769    05  F                       PIC X(07) VALUE "~LFBEN=".
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page  84
* NSRASBL.cbl
  4770    05  OUT-LF-BEN              PIC 9(9).99 BLANK WHEN ZERO.
  4771    05  F                       PIC X(08) VALUE "~LFPREM=".
  4772    05  OUT-LF-PRM              PIC 9(7).99 BLANK WHEN ZERO.
  4773    05  F                       PIC X(08) VALUE "~LFABEN=".
  4774    05  OUT-LF-ALT-BEN          PIC 9(9).99 BLANK WHEN ZERO.
  4775    05  F                       PIC X(09) VALUE "~LFAPREM=".
  4776    05  OUT-LF-ALT-PRM          PIC 9(7).99 BLANK WHEN ZERO.
  4777    05  F                       PIC X(07) VALUE "~LFNSP=".
  4778    05  OUT-LF-NSP              PIC 9(7).99 BLANK WHEN ZERO.
  4779    05  F                       PIC X(08) VALUE "~LFRBEN=".
  4780    05  OUT-LF-REM-BEN          PIC 9(9).99 BLANK WHEN ZERO.
  4781    05  F                       PIC X(07) VALUE "~LFCAN=".
  4782    05  OUT-LF-REF              PIC 9(7).99 BLANK WHEN ZERO.
  4783    05  F                       PIC X(07) VALUE "~LFDTH=".
  4784    05  OUT-LF-DTH              PIC 9(9).99 BLANK WHEN ZERO.
  4785    05  F                       PIC X(08) VALUE "~LFRATE=".
  4786    05  OUT-LF-RATE             PIC 99.9(5) BLANK WHEN ZERO.
  4787    05  F                       PIC X(09) VALUE "~LFARATE=".
  4788    05  OUT-LF-ALT-RATE         PIC 99.9(5) BLANK WHEN ZERO.
  4789    05  F                       PIC X(09) VALUE "~LFEXPDT=".
  4790    05  OUT-LF-EXP-DT           PIC X(21) VALUE SPACES.
  4791    05  F                       PIC X(08) VALUE "~LFSTAT=".
  4792    05  OUT-LF-CUR-STATUS       PIC X(01) VALUE SPACES.
  4793    05  F                       PIC X(09) VALUE "~LFCANDT=".
  4794    05  OUT-LF-CAN-DT           PIC X(21) VALUE SPACES.
  4795    05  F                       PIC X(12) VALUE "~LFCANEXTDT=".
  4796    05  OUT-LF-CAN-EXIT-DT      PIC X(21) VALUE SPACES.
  4797    05  F                       PIC X(07) VALUE "~DTHDT=".
  4798    05  OUT-LF-DTH-DT           PIC X(21) VALUE SPACES.
  4799    05  F                       PIC X(10) VALUE "~DTHEXTDT=".
  4800    05  OUT-LF-DTH-EXIT-DT      PIC X(21) VALUE SPACES.
  4801    05  F                       PIC X(12) VALUE "~LFEXTBATCH=".
  4802    05  OUT-LF-EXIT-BATCH       PIC X(06) VALUE SPACES.
  4803    05  F                       PIC X(08) VALUE "~LFCOMM=".
  4804    05  OUT-LF-COMM-PCT         PIC .9(5) BLANK WHEN ZERO.
  4805    05  F                       PIC X(11) VALUE "~LFBENDESC=".
  4806    05  OUT-LF-DESC             PIC X(02) VALUE SPACES.
  4807    05  F                       PIC X(11) VALUE "~LFBENABRV=".
  4808    05  OUT-LF-ABBRV            PIC X(03) VALUE SPACES.
  4809    05  F                       PIC X(09) VALUE "~AHBENCD=".
  4810    05  OUT-AH-BENCD            PIC X(02) VALUE SPACES.
  4811    05  F                       PIC X(08) VALUE "~AHTERM=".
  4812    05  OUT-AH-TERM             PIC 999   BLANK WHEN ZERO.
  4813    05  F                       PIC X(11) VALUE "~AHCRITPER=".
  4814    05  OUT-CRIT-PER            PIC 99    BLANK WHEN ZERO.
  4815    05  F                       PIC X(09) VALUE "~AHDEVCD=".
  4816    05  OUT-AH-DEV-CD           PIC X(03) VALUE SPACES.
  4817    05  F                       PIC X(10) VALUE "~AHDEVPCT=".
  4818    05  OUT-AH-DEV-PCT          PIC 9.9(6) BLANK WHEN ZERO.
  4819    05  F                       PIC X(07) VALUE "~AHBEN=".
  4820    05  OUT-AH-BEN              PIC 9(7).99 BLANK WHEN ZERO.
  4821    05  F                       PIC X(08) VALUE "~AHPREM=".
  4822    05  OUT-AH-PRM              PIC 9(7).99 BLANK WHEN ZERO.
  4823    05  F                       PIC X(07) VALUE "~AHNSP=".
  4824    05  OUT-AH-NSP              PIC 9(7).99 BLANK WHEN ZERO.
  4825    05  F                       PIC X(07) VALUE "~AHCAN=".
  4826    05  OUT-AH-REF              PIC 9(7).99 BLANK WHEN ZERO.
  4827    05  F                       PIC X(10) VALUE "~AHITDPMT=".
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page  85
* NSRASBL.cbl
  4828    05  OUT-AH-CLM              PIC 9(7).99 BLANK WHEN ZERO.
  4829    05  F                       PIC X(10) VALUE "~AHTOTBEN=".
  4830    05  OUT-AH-TOT-BEN          PIC 9(9).99 BLANK WHEN ZERO.
  4831    05  F                       PIC X(12) VALUE "~AHPDTHRUDT=".
  4832    05  OUT-AH-PDTHRU-DT        PIC X(21) VALUE SPACES.
  4833    05  F                       PIC X(08) VALUE "~AHRATE=".
  4834    05  OUT-AH-RATE             PIC 99.9(5) BLANK WHEN ZERO.
  4835    05  F                       PIC X(09) VALUE "~AHEXPDT=".
  4836    05  OUT-AH-EXP-DT           PIC X(21) VALUE SPACES.
  4837    05  F                       PIC X(08) VALUE "~AHSTAT=".
  4838    05  OUT-AH-CUR-STATUS       PIC X(01) VALUE SPACES.
  4839    05  F                       PIC X(09) VALUE "~AHCANDT=".
  4840    05  OUT-AH-CAN-DT           PIC X(21) VALUE SPACES.
  4841    05  F                       PIC X(12) VALUE "~AHCANEXTDT=".
  4842    05  OUT-AH-CAN-EXIT-DT      PIC X(21) VALUE SPACES.
  4843    05  F                       PIC X(12) VALUE "~AHEXTBATCH=".
  4844    05  OUT-AH-EXIT-BATCH       PIC X(06) VALUE SPACES.
  4845    05  F                       PIC X(08) VALUE "~AHCOMM=".
  4846    05  OUT-AH-COMM-PCT         PIC .9(5) BLANK WHEN ZERO.
  4847    05  F                       PIC X(11) VALUE "~AHBENDESC=".
  4848    05  OUT-AH-DESC             PIC X(35) VALUE SPACES.
  4849    05  F                       PIC X(14) VALUE "~AHBENRETELIM=".
  4850    05  OUT-RET-ELIM            PIC X(01) VALUE SPACES.
  4851    05  F                       PIC X(11) VALUE "~AHBENDAYS=".
  4852    05  OUT-BEN-DAYS            PIC X(02) VALUE SPACES.
  4853    05  F                       PIC X(08) VALUE "~AHWAIT=".
  4854    05  OUT-WAIT-PER            PIC X(03) VALUE SPACES.
  4855    05  F                       PIC X(11) VALUE "~AHMAXPMTS=".
  4856    05  OUT-MAX-PMTS            PIC 99    VALUE ZEROS.
  4857    05  OUT-MAX-PMTS-A REDEFINES OUT-MAX-PMTS
  4858                                PIC X(2).
  4859    05  F                       PIC X(09) VALUE "~TOTPREM=".
  4860    05  OUT-TOT-PRM             PIC 9(7).99 BLANK WHEN ZERO.
  4861    05  F                       PIC X(08) VALUE "~TOTREF=".
  4862    05  OUT-TOT-REF             PIC 9(7).99 BLANK WHEN ZERO.
  4863    05  F                       PIC X(08) VALUE "~SEXPDT=".
  4864    05  OUT-SCHED-EXP-DT        PIC X(21) VALUE SPACES.
  4865    05  F                       PIC X(07) VALUE "~STERM=".
  4866    05  OUT-SCHED-TERM          PIC 999   BLANK WHEN ZERO.
  4867    05  F                       PIC X(12) VALUE "~IORIGLNAME=".
  4868    05  OUT-ORIG-ILNAME         PIC X(15) VALUE SPACES.
  4869    05  F                       PIC X(12) VALUE "~IORIGFNAME=".
  4870    05  OUT-ORIG-IFNAME         PIC X(10) VALUE SPACES.
  4871    05  F                       PIC X(11) VALUE "~IORIGINIT=".
  4872    05  OUT-ORIG-MINIT          PIC X(01) VALUE SPACES.
  4873    05  F                       PIC X(10) VALUE "~IORIGAGE=".
  4874    05  OUT-ORIG-IAGE           PIC 99    BLANK WHEN ZERO.
  4875    05  F                       PIC X(12) VALUE "~JORIGLNAME=".
  4876    05  OUT-ORIG-JLNAME         PIC X(15) VALUE SPACES.
  4877    05  F                       PIC X(12) VALUE "~JORIGFNAME=".
  4878    05  OUT-ORIG-JFNAME         PIC X(10) VALUE SPACES.
  4879    05  F                       PIC X(11) VALUE "~JORIGINIT=".
  4880    05  OUT-ORIG-JMINIT         PIC X(01) VALUE SPACES.
  4881    05  F                       PIC X(10) VALUE "~JORIGAGE=".
  4882    05  OUT-ORIG-JAGE           PIC 99    BLANK WHEN ZERO.
  4883    05  F                       PIC X(13) VALUE "~LFORIGBENCD=".
  4884    05  OUT-ORIG-LF-BENCD       PIC X(02) VALUE SPACES.
  4885    05  F                       PIC X(12) VALUE "~LFORIGTERM=".
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page  86
* NSRASBL.cbl
  4886    05  OUT-ORIG-LF-TERM        PIC 999   BLANK WHEN ZERO.
  4887    05  F                       PIC X(14) VALUE "~LFORIGBENAMT=".
  4888    05  OUT-ORIG-LF-BEN         PIC 9(9).99 VALUE ZEROS.
  4889    05  OUT-ORIG-LF-BEN-A REDEFINES OUT-ORIG-LF-BEN
  4890                                PIC X(12).
  4891    05  F                       PIC X(14) VALUE "~LFORIGPRMAMT=".
  4892    05  OUT-ORIG-LF-PRM         PIC 9(9).99 VALUE ZEROS.
  4893    05  OUT-ORIG-LF-PRM-A REDEFINES OUT-ORIG-LF-PRM
  4894                                PIC X(12).
  4895    05  F                       PIC X(14) VALUE "~LFCALCPRMAMT=".
  4896    05  OUT-LF-CALC-PRM         PIC 9(9).99 VALUE ZEROS.
  4897    05  F                       PIC X(14) VALUE "~LFORIGREFAMT=".
  4898    05  OUT-ORIG-LF-REF         PIC 9(7).99 VALUE ZEROS.
  4899    05  F                       PIC X(14) VALUE "~LFCALCREFAMT=".
  4900    05  OUT-LF-CALC-REF         PIC 9(7).99 VALUE ZEROS.
  4901    05  F                       PIC X(14) VALUE "~LFORIGALTBEN=".
  4902    05  OUT-ORIG-LF-ALT-BEN     PIC 9(9).99 VALUE ZEROS.
  4903    05  OUT-ORIG-LF-ALT-BEN-A REDEFINES OUT-ORIG-LF-ALT-BEN
  4904                                PIC X(12).
  4905    05  F                       PIC X(14) VALUE "~LFORIGALTPRM=".
  4906    05  OUT-ORIG-LF-ALT-PRM     PIC 9(7).99 VALUE ZEROS.
  4907    05  OUT-ORIG-LF-ALT-PRM-A REDEFINES OUT-ORIG-LF-ALT-PRM
  4908                                PIC X(10).
  4909    05  F                       PIC X(13) VALUE "~LFORIGEXPDT=".
  4910    05  OUT-ORIG-LF-EXP-DT      PIC X(21) VALUE SPACES.
  4911    05  F                       PIC X(12) VALUE "~LFORIGDESC=".
  4912    05  OUT-ORIG-LF-DESC        PIC X(02) VALUE SPACES.
  4913    05  F                       PIC X(13) VALUE "~AHORIGBENCD=".
  4914    05  OUT-ORIG-AH-BENCD       PIC X(02) VALUE SPACES.
  4915    05  F                       PIC X(12) VALUE "~AHORIGTERM=".
  4916    05  OUT-ORIG-AH-TERM        PIC 999   BLANK WHEN ZERO.
  4917    05  F                       PIC X(13) VALUE "~AHORIGCRITP=".
  4918    05  OUT-ORIG-CRIT-PER       PIC 99    BLANK WHEN ZERO.
  4919    05  F                       PIC X(14) VALUE "~AHORIGBENAMT=".
  4920    05  OUT-ORIG-AH-BEN         PIC 9(7).99 VALUE ZEROS.
  4921    05  OUT-ORIG-AH-BEN-A REDEFINES OUT-ORIG-AH-BEN
  4922                                PIC X(10).
  4923    05  F                       PIC X(14) VALUE "~AHORIGPRMAMT=".
  4924    05  OUT-ORIG-AH-PRM         PIC 9(7).99 VALUE ZEROS.
  4925    05  OUT-ORIG-AH-PRM-A REDEFINES OUT-ORIG-AH-PRM
  4926                                PIC X(10).
  4927    05  F                       PIC X(14) VALUE "~AHCALCPRMAMT=".
  4928    05  OUT-AH-CALC-PRM         PIC 9(7).99 VALUE ZEROS.
  4929    05  F                       PIC X(14) VALUE "~AHORIGREFAMT=".
  4930    05  OUT-ORIG-AH-REF         PIC 9(7).99 VALUE ZEROS.
  4931    05  F                       PIC X(14) VALUE "~AHCALCREFAMT=".
  4932    05  OUT-AH-CALC-REF         PIC 9(7).99 VALUE ZEROS.
  4933    05  F                       PIC X(13) VALUE "~AHORIGEXPDT=".
  4934    05  OUT-ORIG-AH-EXP-DT      PIC X(21) VALUE SPACES.
  4935    05  F                       PIC X(12) VALUE "~AHORIGDESC=".
  4936    05  OUT-ORIG-AH-DESC        PIC X(35) VALUE SPACES.
  4937    05  F                       PIC X(13) VALUE "~AHORIGRELIM=".
  4938    05  OUT-ORIG-RET-ELIM       PIC X(01) VALUE SPACES.
  4939    05  F                       PIC X(13) VALUE "~ORIGBENDAYS=".
  4940    05  OUT-ORIG-BEN-DAYS       PIC X(02) VALUE ZEROS.
  4941    05  F                       PIC X(10) VALUE "~ORIGWAIT=".
  4942    05  OUT-ORIG-WAIT-PER       PIC X(03) VALUE SPACES.
  4943    05  F                       PIC X(13) VALUE "~ORIGMAXPMTS=".
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page  87
* NSRASBL.cbl
  4944    05  OUT-ORIG-MAX-PMTS       PIC 99    VALUE ZEROS.
  4945    05  OUT-ORIG-MAX-PMTS-A REDEFINES OUT-ORIG-MAX-PMTS
  4946                                PIC X(2).
  4947    05  F                       PIC X(09) VALUE "~OSEXPDT=".
  4948    05  OUT-ORIG-SCHED-EXP-DT   PIC X(21) VALUE SPACES.
  4949    05  F                       PIC X(08) VALUE "~OSTERM=".
  4950    05  OUT-ORIG-SCHED-TERM     PIC 9(09) BLANK WHEN ZERO.
  4951    05  F                       PIC X(11) VALUE "~INEWLNAME=".
  4952    05  OUT-NEW-ILNAME          PIC X(15) VALUE SPACES.
  4953    05  F                       PIC X(11) VALUE "~INEWFNAME=".
  4954    05  OUT-NEW-IFNAME          PIC X(10) VALUE SPACES.
  4955    05  F                       PIC X(10) VALUE "~INEWINIT=".
  4956    05  OUT-NEW-IMINIT          PIC X(01) VALUE SPACES.
  4957    05  F                       PIC X(09) VALUE "~INEWAGE=".
  4958    05  OUT-NEW-IAGE            PIC 9(09) BLANK WHEN ZERO.
  4959    05  OUT-NEW-IAGE-A REDEFINES OUT-NEW-IAGE
  4960                                PIC X(09).
  4961    05  F                       PIC X(11) VALUE "~JNEWLNAME=".
  4962    05  OUT-NEW-JLNAME          PIC X(15) VALUE SPACES.
  4963    05  F                       PIC X(11) VALUE "~JNEWFNAME=".
  4964    05  OUT-NEW-JFNAME          PIC X(10) VALUE SPACES.
  4965    05  F                       PIC X(10) VALUE "~JNEWINIT=".
  4966    05  OUT-NEW-JMINIT          PIC X(01) VALUE SPACES.
  4967    05  F                       PIC X(09) VALUE "~JNEWAGE=".
  4968    05  OUT-NEW-JAGE            PIC 9(09) BLANK WHEN ZERO.
  4969    05  OUT-NEW-JAGE-A REDEFINES OUT-NEW-JAGE
  4970                                PIC X(09).
  4971    05  F                       PIC X(12) VALUE "~LFNEWBENCD=".
  4972    05  OUT-NEW-LF-BENCD        PIC X(09) VALUE SPACES.
  4973    05  F                       PIC X(11) VALUE "~LFNEWTERM=".
  4974    05  OUT-NEW-LF-TERM         PIC 9(09) BLANK WHEN ZERO.
  4975    05  OUT-NEW-LF-TERM-A REDEFINES OUT-NEW-LF-TERM
  4976                                PIC X(09).
  4977    05  F                       PIC X(13) VALUE "~LFNEWBENAMT=".
  4978    05  OUT-NEW-LF-BEN          PIC 9(9).99 VALUE ZEROS.
  4979    05  OUT-NEW-LF-BEN-A REDEFINES OUT-NEW-LF-BEN
  4980                                PIC X(12).
  4981    05  F                       PIC X(13) VALUE "~LFNEWPRMAMT=".
  4982    05  OUT-NEW-LF-PRM          PIC 9(7).99 VALUE ZEROS.
  4983    05  OUT-NEW-LF-PRM-A REDEFINES OUT-NEW-LF-PRM
  4984                                PIC X(10).
  4985    05  F                       PIC X(13) VALUE "~LFNEWREFAMT=".
  4986    05  OUT-NEW-LF-REF          PIC 9(7).99 VALUE ZEROS.
  4987    05  F                       PIC X(13) VALUE "~LFNEWALTBEN=".
  4988    05  OUT-NEW-LF-ALT-BEN      PIC 9(9).99 VALUE ZEROS.
  4989    05  OUT-NEW-LF-ALT-BEN-A REDEFINES OUT-NEW-LF-ALT-BEN
  4990                                PIC X(12).
  4991    05  F                       PIC X(13) VALUE "~LFNEWALTPRM=".
  4992    05  OUT-NEW-LF-ALT-PRM      PIC 9(7).99 VALUE ZEROS.
  4993    05  OUT-NEW-LF-ALT-PRM-A REDEFINES OUT-NEW-LF-ALT-PRM
  4994                                PIC X(10).
  4995    05  F                       PIC X(12) VALUE "~LFNEWEXPDT=".
  4996    05  OUT-NEW-LF-EXP-DT       PIC X(21) VALUE SPACES.
  4997    05  F                       PIC X(11) VALUE "~LFNEWDESC=".
  4998    05  OUT-NEW-LF-DESC         PIC X(10) VALUE SPACES.
  4999    05  F                       PIC X(12) VALUE "~AHNEWBENCD=".
  5000    05  OUT-NEW-AH-BENCD        PIC X(02) VALUE SPACES.
  5001    05  F                       PIC X(11) VALUE "~AHNEWTERM=".
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page  88
* NSRASBL.cbl
  5002    05  OUT-NEW-AH-TERM         PIC 9(09) BLANK WHEN ZERO.
  5003    05  OUT-NEW-AH-TERM-A REDEFINES OUT-NEW-AH-TERM
  5004                                PIC X(09).
  5005    05  F                       PIC X(12) VALUE "~AHNEWCRITP=".
  5006    05  OUT-NEW-CRIT-PER        PIC 9(09) BLANK WHEN ZERO.
  5007    05  OUT-NEW-CRIT-PER-A REDEFINES OUT-NEW-CRIT-PER
  5008                                PIC X(09).
  5009    05  F                       PIC X(13) VALUE "~AHNEWBENAMT=".
  5010    05  OUT-NEW-AH-BEN          PIC 9(7).99 VALUE ZEROS.
  5011    05  OUT-NEW-AH-BEN-A REDEFINES OUT-NEW-AH-BEN
  5012                                PIC X(10).
  5013    05  F                       PIC X(13) VALUE "~AHNEWPRMAMT=".
  5014    05  OUT-NEW-AH-PRM          PIC 9(7).99 VALUE ZEROS.
  5015    05  OUT-NEW-AH-PRM-A REDEFINES OUT-NEW-AH-PRM
  5016                                PIC X(10).
  5017    05  F                       PIC X(13) VALUE "~AHNEWREFAMT=".
  5018    05  OUT-NEW-AH-REF          PIC 9(7).99 VALUE ZEROS.
  5019    05  F                       PIC X(12) VALUE "~AHNEWEXPDT=".
  5020    05  OUT-NEW-AH-EXP-DT       PIC X(21) VALUE SPACES.
  5021    05  F                       PIC X(11) VALUE "~AHNEWDESC=".
  5022    05  OUT-NEW-AH-DESC         PIC X(35) VALUE SPACES.
  5023    05  F                       PIC X(12) VALUE "~AHNEWRELIM=".
  5024    05  OUT-NEW-RET-ELIM        PIC X(01) VALUE SPACES.
  5025    05  F                       PIC X(12) VALUE "~NEWBENDAYS=".
  5026    05  OUT-NEW-BEN-DAYS        PIC X(09) VALUE ZEROS.
  5027    05  F                       PIC X(09) VALUE "~NEWWAIT=".
  5028    05  OUT-NEW-WAIT-PER        PIC X(09) VALUE SPACES.
  5029    05  F                       PIC X(12) VALUE "~NEWMAXPMTS=".
  5030    05  OUT-NEW-MAX-PMTS        PIC 9(09) VALUE ZEROS.
  5031    05  OUT-NEW-MAX-PMTS-A REDEFINES OUT-NEW-MAX-PMTS
  5032                                PIC X(09).
  5033    05  F                       PIC X(09) VALUE "~NSEXPDT=".
  5034    05  OUT-NEW-SCHED-EXP-DT    PIC X(21) VALUE SPACES.
  5035    05  F                       PIC X(08) VALUE "~NSTERM=".
  5036    05  OUT-NEW-SCHED-TERM      PIC 9(09) BLANK WHEN ZERO.
  5037    05  OUT-NEW-SCHED-TERM-A REDEFINES OUT-NEW-SCHED-TERM
  5038                                PIC X(09).
  5039    05  F                       PIC X(12) VALUE "~TOTPREMCHG=".
  5040    05  OUT-TOT-PRM-CHG         PIC 9(7).99 VALUE ZEROS.
  5041    05  F                       PIC X(11) VALUE "~TOTREFCHG=".
  5042    05  OUT-TOT-REF-CHG         PIC 9(7).99 VALUE ZEROS.
  5043    05  F                       PIC X(11) VALUE "~PAYABLETO=".
  5044    05  OUT-PAYEE               PIC X(30) VALUE SPACES.
  5045    05  F                       PIC X(11) VALUE "~SIGNEEDED=".
  5046    05  OUT-SIG-SW              PIC X(01) VALUE SPACES.
  5047    05  F                       PIC X(09) VALUE "~BALLOON=".
  5048    05  OUT-BALLOON-IND         PIC X(01) VALUE SPACES.
  5049    05  F                       PIC X(10) VALUE "~LEASEIND=".
  5050    05  OUT-LEASE-IND           PIC X(01) VALUE SPACES.
  5051    05  F                       PIC X(09) VALUE "~RESCIND=".
  5052    05  OUT-RESCIND             PIC X(01) VALUE SPACES.
  5053    05  F                       PIC X(07) VALUE "~RCD01=".
  5054    05  OUT-REA-CD1             PIC X(04) VALUE SPACES.
  5055    05  F                       PIC X(07) VALUE "~RCD02=".
  5056    05  OUT-REA-CD2             PIC X(04) VALUE SPACES.
  5057    05  F                       PIC X(07) VALUE "~RCD03=".
  5058    05  OUT-REA-CD3             PIC X(04) VALUE SPACES.
  5059    05  F                       PIC X(07) VALUE "~RCD04=".
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page  89
* NSRASBL.cbl
  5060    05  OUT-REA-CD4             PIC X(04) VALUE SPACES.
  5061    05  F                       PIC X(07) VALUE "~RCD05=".
  5062    05  OUT-REA-CD5             PIC X(04) VALUE SPACES.
  5063    05  F                       PIC X(07) VALUE "~RCD06=".
  5064    05  OUT-REA-CD6             PIC X(04) VALUE SPACES.
  5065    05  F                       PIC X(07) VALUE "~RCD07=".
  5066    05  OUT-REA-CD7             PIC X(04) VALUE SPACES.
  5067    05  F                       PIC X(07) VALUE "~RCD08=".
  5068    05  OUT-REA-CD8             PIC X(04) VALUE SPACES.
  5069    05  F                       PIC X(07) VALUE "~RCD09=".
  5070    05  OUT-REA-CD9             PIC X(04) VALUE SPACES.
  5071    05  F                       PIC X(07) VALUE "~RCD10=".
  5072    05  OUT-REA-CD10            PIC X(04) VALUE SPACES.
  5073    05  F                       PIC X(07) VALUE "~RCD11=".
  5074    05  OUT-REA-CD11            PIC X(04) VALUE SPACES.
  5075    05  F                       PIC X(07) VALUE "~RCD12=".
  5076    05  OUT-REA-CD12            PIC X(04) VALUE SPACES.
  5077    05  F                       PIC X(11) VALUE "~CYCLEDATE=".
  5078    05  OUT-CYCLE-DT            PIC X(21) VALUE SPACES.
  5079    05  F                       PIC X(08) VALUE "~ARCHNO=".
  5080    05  OUT-ARCH-NO             PIC 9(9)  VALUE ZEROS.
  5081    05  F                       PIC X(06) VALUE "~FORM=".
  5082    05  OUT-FORM                PIC X(03) VALUE SPACES.
  5083    05  F                       PIC X(09) VALUE "~ENCLINE=".
  5084    05  OUT-ENC-LINE            PIC X(50) VALUE SPACES.
  5085    05  F                       PIC X(08) VALUE "~ATTACH=".
  5086    05  OUT-ATTACH              PIC X(50) VALUE SPACES.
  5087    05  F                       PIC X(10) VALUE "~OUTSTACK=".
  5088    05  OUT-STACK               PIC X(10) VALUE SPACES.
  5089    05  F                       PIC X(11) VALUE "~STATENAME=".
  5090    05  OUT-STATE-NAME          PIC X(25) VALUE SPACES.
  5091    05  F                       PIC X(08) VALUE "~PRTNOW=".
  5092    05  OUT-PRINT-NOW           PIC X(01) VALUE SPACES.
  5093    05  F                       PIC X(05) VALUE "~NCB=".
  5094    05  OUT-CHGBACK             PIC X     VALUE ' '.
  5095    05  F                       PIC X(8) VALUE "~CSOAMT=".
  5096    05  OUT-CSO-PORTION         PIC 9(7).99 VALUE ZEROS.
  5097    05  F                       PIC X(9) VALUE "~ACCTAMT=".
  5098    05  OUT-ACCT-PORTION        PIC 9(7).99 VALUE ZEROS.
  5099    05  F                       PIC X(09) VALUE "~LETRTYP=".
  5100    05  OUT-LETTER-TYPE         PIC X(01) VALUE SPACES.
  5101    05  F                       PIC X(10) VALUE "~PRNTCERT=".
  5102    05  OUT-PRINT-CERTIFICATE   PIC X(01) VALUE SPACES.
  5103    05  F                       PIC X(08) VALUE "~INSBDT=".
  5104    05  OUT-INS-BIRTHDATE       PIC X(21) VALUE SPACES.
  5105    05  F                       PIC X(08) VALUE "~JNTBDT=".
  5106    05  OUT-JNT-BIRTHDATE       PIC X(21) VALUE SPACES.
  5107    05  F                       PIC X(08) VALUE "~TOTINT=".
  5108    05  OUT-TOT-INTEREST        PIC 9(7).99 VALUE ZEROS.
  5109    05  F                       PIC X(8) VALUE "~TOPREM=".
  5110    05  OUT-ORIG-TOT-PREM       PIC 9(7).99 VALUE ZEROS.
  5111    05  F                       PIC X(7) VALUE "~TOREF=".
  5112    05  OUT-ORIG-TOT-REF        PIC 9(7).99 VALUE ZEROS.
  5113    05  F                       PIC X(7) VALUE "~CANDT=".
  5114    05  OUT-CANCEL-DT           PIC X(21) VALUE SPACES.
  5115    05  F                       PIC X(9)  VALUE "~HLTHAPP=".
  5116    05  OUT-HEALTH-APP          PIC X     VALUE SPACES.
  5117    05  F                       PIC X(08) VALUE "~CERTID=".
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page  90
* NSRASBL.cbl
  5118    05  OUT-CERTIFICATE-ID      PIC X(5)  VALUE SPACES.
  5119    05  F                       PIC X(08) VALUE "~UNDWID=".
  5120    05  OUT-UNDW-ID             PIC X(04) VALUE SPACES.
  5121    05  F                       PIC X(8) VALUE "~TNPREM=".
  5122    05  OUT-NEW-TOT-PREM        PIC 9(7).99 VALUE ZEROS.
  5123    05  F                       PIC X(7) VALUE "~TNREF=".
  5124    05  OUT-NEW-TOT-REF         PIC 9(7).99 VALUE ZEROS.
  5125    05  F                       PIC X(8)  VALUE "~COVIND=".
  5126    05  OUT-COVERAGE-IND        PIC X(4)  VALUE SPACES.
  5127    05  F                       PIC X(9)  VALUE "~OCOVIND=".
  5128    05  OUT-ORIG-COVERAGE-IND   PIC X(4)  VALUE SPACES.
  5129    05  F                       PIC X(9)  VALUE "~NCOVIND=".
  5130    05  OUT-NEW-COVERAGE-IND    PIC X(4)  VALUE SPACES.
  5131    05  F                       PIC X(10) VALUE "~LFCMBPRM=".
  5132    05  OUT-LF-CMB-PREM         PIC 9(7).99 VALUE ZEROS.
  5133    05  F                       PIC X(11) VALUE "~LFOCMBPRM=".
  5134    05  OUT-ORIG-LF-CMB-PREM    PIC 9(7).99 VALUE ZEROS.
  5135    05  F                       PIC X(11) VALUE "~LFNCMBPRM=".
  5136    05  OUT-NEW-LF-CMB-PREM     PIC 9(7).99 VALUE ZEROS.
  5137    05  OUT-NEW-LF-CMB-PREM-A REDEFINES OUT-NEW-LF-CMB-PREM
  5138                                PIC X(10).
  5139    05  F                       PIC X(11) VALUE "~LFPREMCHG=".
  5140    05  OUT-LF-PREM-CHG         PIC 9(7).99 VALUE ZEROS.
  5141    05  F                       PIC X(11) VALUE "~LFAPRMCHG=".
  5142    05  OUT-LF-ALT-PREM-CHG     PIC 9(7).99 VALUE ZEROS.
  5143    05  F                       PIC X(11) VALUE "~LFCPRMCHG=".
  5144    05  OUT-LF-CMB-PREM-CHG     PIC 9(7).99 VALUE ZEROS.
  5145    05  F                       PIC X(11) VALUE "~AHPREMCHG=".
  5146    05  OUT-AH-PREM-CHG         PIC 9(7).99 VALUE ZEROS.
  5147    05  F                       PIC X(10) VALUE "~LFREFCHG=".
  5148    05  OUT-LF-REF-CHG          PIC 9(7).99 VALUE ZEROS.
  5149    05  F                       PIC X(10) VALUE "~AHREFCHG=".
  5150    05  OUT-AH-REF-CHG          PIC 9(7).99 VALUE ZEROS.
  5151    05  F                       PIC X(11) VALUE "~ACCTLFAMT=".
  5152    05  OUT-ACCT-LF-PORTION     PIC 9(7).99 VALUE ZEROS.
  5153    05  F                       PIC X(11) VALUE "~ACTALFAMT=".
  5154    05  OUT-ACCT-ALT-LF-PORT    PIC 9(7).99 VALUE ZEROS.
  5155    05  F                       PIC X(11) VALUE "~ACTCLFAMT=".
  5156    05  OUT-ACCT-CMB-LF-PORT    PIC 9(7).99 VALUE ZEROS.
  5157    05  F                       PIC X(11) VALUE "~ACCTAHAMT=".
  5158    05  OUT-ACCT-AH-PORTION     PIC 9(7).99 VALUE ZEROS.
  5159    05  F                       PIC X(10) VALUE "~CSOLFAMT=".
  5160    05  OUT-CSO-LF-PORTION      PIC 9(7).99 VALUE ZEROS.
  5161    05  F                       PIC X(11) VALUE "~CSOALFAMT=".
  5162    05  OUT-CSO-ALT-LF-PORT     PIC 9(7).99 VALUE ZEROS.
  5163    05  F                       PIC X(11) VALUE "~CSOCLFAMT=".
  5164    05  OUT-CSO-CMB-LF-PORT     PIC 9(7).99 VALUE ZEROS.
  5165    05  F                       PIC X(10) VALUE "~CSOAHAMT=".
  5166    05  OUT-CSO-AH-PORTION      PIC 9(7).99 VALUE ZEROS.
  5167    05  F                       PIC X(11) VALUE "~ACTOLFAMT=".
  5168    05  OUT-ACCT-ORIG-LF-PORT   PIC 9(7).99 VALUE ZEROS.
  5169    05  F                       PIC X(12) VALUE "~ACTOALFAMT=".
  5170    05  OUT-ACCT-ORIG-ALT-LF-PORT PIC 9(7).99 VALUE ZEROS.
  5171    05  F                       PIC X(12) VALUE "~ACTOCLFAMT=".
  5172    05  OUT-ACCT-ORIG-CMB-LF-PORT PIC 9(7).99 VALUE ZEROS.
  5173    05  F                       PIC X(11) VALUE "~ACTOAHAMT=".
  5174    05  OUT-ACCT-ORIG-AH-PORT   PIC 9(7).99 VALUE ZEROS.
  5175    05  F                       PIC X(10) VALUE "~ACCTOAMT=".
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page  91
* NSRASBL.cbl
  5176    05  OUT-ACCT-ORIG-PORTION   PIC 9(7).99 VALUE ZEROS.
  5177    05  F                       PIC X(11) VALUE "~CSOOLFAMT=".
  5178    05  OUT-CSO-ORIG-LF-PORT    PIC 9(7).99 VALUE ZEROS.
  5179    05  F                       PIC X(12) VALUE "~CSOOALFAMT=".
  5180    05  OUT-CSO-ORIG-ALT-LF-PORT PIC 9(7).99 VALUE ZEROS.
  5181    05  F                       PIC X(12) VALUE "~CSOOCLFAMT=".
  5182    05  OUT-CSO-ORIG-CMB-LF-PORT PIC 9(7).99 VALUE ZEROS.
  5183    05  F                       PIC X(11) VALUE "~CSOOAHAMT=".
  5184    05  OUT-CSO-ORIG-AH-PORT    PIC 9(7).99 VALUE ZEROS.
  5185    05  F                       PIC X(09) VALUE "~CSOOAMT=".
  5186    05  OUT-CSO-ORIG-PORTION    PIC 9(7).99 VALUE ZEROS.
  5187    05  F                       PIC X(11) VALUE "~ACTNLFAMT=".
  5188    05  OUT-ACCT-NEW-LF-PORT    PIC 9(7).99 VALUE ZEROS.
  5189    05  F                       PIC X(12) VALUE "~ACTNALFAMT=".
  5190    05  OUT-ACCT-NEW-ALT-LF-PORT PIC 9(7).99 VALUE ZEROS.
  5191    05  F                       PIC X(12) VALUE "~ACTNCLFAMT=".
  5192    05  OUT-ACCT-NEW-CMB-LF-PORT PIC 9(7).99 VALUE ZEROS.
  5193    05  F                       PIC X(11) VALUE "~ACTNAHAMT=".
  5194    05  OUT-ACCT-NEW-AH-PORT    PIC 9(7).99 VALUE ZEROS.
  5195    05  F                       PIC X(10) VALUE "~ACCTNAMT=".
  5196    05  OUT-ACCT-NEW-PORTION    PIC 9(7).99 VALUE ZEROS.
  5197    05  F                       PIC X(11) VALUE "~CSONLFAMT=".
  5198    05  OUT-CSO-NEW-LF-PORT     PIC 9(7).99 VALUE ZEROS.
  5199    05  F                       PIC X(12) VALUE "~CSONALFAMT=".
  5200    05  OUT-CSO-NEW-ALT-LF-PORT PIC 9(7).99 VALUE ZEROS.
  5201    05  F                       PIC X(12) VALUE "~CSONCLFAMT=".
  5202    05  OUT-CSO-NEW-CMB-LF-PORT PIC 9(7).99 VALUE ZEROS.
  5203    05  F                       PIC X(11) VALUE "~CSONAHAMT=".
  5204    05  OUT-CSO-NEW-AH-PORT     PIC 9(7).99 VALUE ZEROS.
  5205    05  F                       PIC X(09) VALUE "~CSONAMT=".
  5206    05  OUT-CSO-NEW-PORTION     PIC 9(7).99 VALUE ZEROS.
  5207    05  F                       PIC X(10) VALUE "~ACTLFCHG=".
  5208    05  OUT-ACCT-LF-PORT-CHG    PIC 9(7).99 VALUE ZEROS.
  5209    05  F                       PIC X(11) VALUE "~ACTALFCHG=".
  5210    05  OUT-ACCT-ALT-LF-PORT-CHG PIC 9(7).99 VALUE ZEROS.
  5211    05  F                       PIC X(11) VALUE "~ACTCLFCHG=".
  5212    05  OUT-ACCT-CMB-LF-PORT-CHG PIC 9(7).99 VALUE ZEROS.
  5213    05  F                       PIC X(10) VALUE "~ACTAHCHG=".
  5214    05  OUT-ACCT-AH-PORT-CHG    PIC 9(7).99 VALUE ZEROS.
  5215    05  F                       PIC X(09) VALUE "~ACCTCHG=".
  5216    05  OUT-ACCT-PORTION-CHG    PIC 9(7).99 VALUE ZEROS.
  5217    05  F                       PIC X(10) VALUE "~CSOLFCHG=".
  5218    05  OUT-CSO-LF-PORT-CHG     PIC 9(7).99 VALUE ZEROS.
  5219    05  F                       PIC X(11) VALUE "~CSOALFCHG=".
  5220    05  OUT-CSO-ALT-LF-PORT-CHG PIC 9(7).99 VALUE ZEROS.
  5221    05  F                       PIC X(11) VALUE "~CSOCLFCHG=".
  5222    05  OUT-CSO-CMB-LF-PORT-CHG PIC 9(7).99 VALUE ZEROS.
  5223    05  F                       PIC X(10) VALUE "~CSOAHCHG=".
  5224    05  OUT-CSO-AH-PORT-CHG     PIC 9(7).99 VALUE ZEROS.
  5225    05  F                       PIC X(08) VALUE "~CSOCHG=".
  5226    05  OUT-CSO-PORTION-CHG     PIC 9(7).99 VALUE ZEROS.
  5227    05  F                       PIC X(10) VALUE "~LFOCANDT=".
  5228    05  OUT-ORIG-LF-CAN-DT      PIC X(21) VALUE SPACES.
  5229    05  F                       PIC X(10) VALUE "~LFNCANDT=".
  5230    05  OUT-NEW-LF-CAN-DT       PIC X(21) VALUE SPACES.
  5231    05  F                       PIC X(10) VALUE "~AHOCANDT=".
  5232    05  OUT-ORIG-AH-CAN-DT      PIC X(21) VALUE SPACES.
  5233    05  F                       PIC X(10) VALUE "~AHNCANDT=".
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page  92
* NSRASBL.cbl
  5234    05  OUT-NEW-AH-CAN-DT       PIC X(21) VALUE SPACES.
  5235    05  F                       PIC X(11) VALUE "~ORIGCANDT=".
  5236    05  OUT-ORIG-CAN-DT         PIC X(21) VALUE SPACES.
  5237    05  F                       PIC X(10) VALUE "~NEWCANDT=".
  5238    05  OUT-NEW-CAN-DT          PIC X(21) VALUE SPACES.
  5239    05  F                       PIC X(8)  VALUE "~SCREEN=".
  5240    05  OUT-SCREEN-ID           PIC X(8)  VALUE SPACES.
  5241    05  F                       PIC X(9)  VALUE "~NXTBSDT=".
  5242    05  OUT-NEXT-BUS-DT         PIC X(21) VALUE SPACES.
  5243    05  F                       PIC X(7)  VALUE "~VINNO=".
  5244    05  OUT-VIN-NUMBER          PIC X(17) VALUE SPACES.
  5245    05  F                       PIC X(11) VALUE 'EndOfString'.
  5246    05  f                       pic x(2) value spaces.
  5247*                                COPY ERCARCH.
  5248******************************************************************
  5249*                                                                *
  5250*                            ERCARCH.                            *
  5251*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5252*                            VMOD=2.002                          *
  5253*                                                                *
  5254*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  5255*                                                                *
  5256*   FILE TYPE = VSAM,KSDS                                        *
  5257*   RECORD SIZE = 250  RECFORM = FIXED                           *
  5258*                                                                *
  5259*   BASE CLUSTER = ERARCH                        RKP=2,LEN=5     *
  5260*     ALTERNATE PATH1 = ERARCH2 (CERT/RESP)      RKP=07,LEN=35   *
  5261*     ALTERNATE PATH2 = ERARCH3 (FORM NUMBER)    RKP=44,LEN=28   *
  5262*     ALTERNATE PATH3 = ERARCH4 (PROCCESSOR ID)  RKP=73,LEN=28   *
  5263*     ALTERNATE PATH4 = ERARCH5 (ACCOUNT KEY)    RKP=100,LEN=24  *
  5264*     ALTERNATE PATH5 = ERARCH6 (BTCH/CHK KEY)   RKP=124,LEN=11  *
  5265*                                                                *
  5266*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5267******************************************************************
  5268*                   C H A N G E   L O G
  5269*
  5270* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5271*-----------------------------------------------------------------
  5272*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5273* EFFECTIVE    NUMBER
  5274*-----------------------------------------------------------------
  5275* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  5276* 070711  CR2011022800001  AJRA  NAPERSOFT CHANGES
  5277* 110612    2012101700002  AJRA  ADD NEW FIELDS
  5278******************************************************************
  5279 01  LETTER-ARCHIVE.
  5280     12  LA-RECORD-ID                PIC  X(02).
  5281         88  LA-VALID-ID                VALUE 'LA'.
  5282
  5283     12  LA-CONTROL-PRIMARY.
  5284         16  LA-COMPANY-CD           PIC  X(01).
  5285         16  LA-ARCHIVE-NO           PIC S9(08)    COMP.
  5286
  5287     12  LA-CONTROL-BY-CERT-RESP.
  5288         16  LA-COMPANY-CD-A2        PIC  X(01).
  5289         16  LA-CERT-NO-A2.
  5290             20  LA-CERT-PRIME-A2    PIC  X(10).
  5291             20  LA-CERT-SUFFIX-A2   PIC  X(01).
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page  93
* NSRASBL.cbl
  5292         16  LA-RSP-PERSON-A2 REDEFINES LA-CERT-NO-A2.
  5293             20  LA-RESP-PERSON-A2   PIC  X(10).
  5294             20  LA-TYPE-A2          PIC  X(01).
  5295         16  LA-CARRIER-A2           PIC  X(01).
  5296         16  LA-GROUPING-A2          PIC  X(06).
  5297         16  LA-STATE-A2             PIC  X(02).
  5298         16  LA-ACCOUNT-A2           PIC  X(10).
  5299         16  LA-EFFECT-DATE-A2       PIC  X(02).
  5300         16  LA-ARCHIVE-NO-A2        PIC S9(08)    COMP.
  5301
  5302     12  LA-CONTROL-BY-FORM.
  5303         16  LA-COMPANY-CD-A3        PIC  X(01).
  5304         16  LA-FORM-A3              PIC  X(04).
  5305         16  LA-CARRIER-A3           PIC  X(01).
  5306         16  LA-GROUPING-A3          PIC  X(06).
  5307         16  LA-STATE-A3             PIC  X(02).
  5308         16  LA-ACCOUNT-A3           PIC  X(10).
  5309         16  LA-ARCHIVE-NO-A3        PIC S9(08)    COMP.
  5310
  5311     12  LA-CONTROL-BY-PROCESSOR.
  5312         16  LA-COMPANY-CD-A4        PIC  X(01).
  5313         16  LA-PROCESSOR-CD         PIC  X(04).
  5314         16  LA-CARRIER-A4           PIC  X(01).
  5315         16  LA-GROUPING-A4          PIC  X(06).
  5316         16  LA-STATE-A4             PIC  X(02).
  5317         16  LA-ACCOUNT-A4           PIC  X(10).
  5318         16  LA-ARCHIVE-NO-A4        PIC S9(08)    COMP.
  5319
  5320     12  LA-CONTROL-BY-KEY-FIELDS.
  5321         16  LA-COMPANY-CD-A5        PIC  X(01).
  5322         16  LA-CARRIER-A5           PIC  X(01).
  5323         16  LA-GROUPING-A5          PIC  X(06).
  5324         16  LA-STATE-A5             PIC  X(02).
  5325         16  LA-ACCOUNT-A5           PIC  X(10).
  5326         16  LA-ARCHIVE-NO-A5        PIC S9(08)    COMP.
  5327
  5328     12  LA-CONTROL-BY-GROUP-CODE.
  5329         16  LA-COMPANY-CD-A6        PIC  X(01).
  5330         16  LA-ENTRY-A6.
  5331             20  LA-FILLER           PIC  X(02).
  5332             20  LA-QUE-CONTROL-A6   PIC S9(08)    COMP.
  5333         16  LA-ARCHIVE-NO-A6        PIC S9(08)    COMP.
  5334
  5335     12  FILLER                      PIC  X(09).
  5336
  5337     12  LA-HEADER-RECORD.
  5338         16  LA-NUMBER-LABEL-LINES   PIC S9(04)    COMP.
  5339         16  LA-CREATION-DATE        PIC  X(02).
  5340         16  LA-FOLLOW-UP-DATE       PIC  X(02).
  5341         16  LA-FINAL-ACT-DATE       REDEFINES
  5342               LA-FOLLOW-UP-DATE     PIC  X(02).
  5343         16  LA-INITIAL-PRINT-DATE   PIC  X(02).
  5344         16  LA-NO-OF-COPIES         PIC S9(01).
  5345         16  LA-NO-OF-TEXT-RECORDS   PIC S9(04)    COMP.
  5346         16  LA-REPLY-DATE           PIC  X(02).
  5347         16  LA-RESEND-DATES.
  5348             20  LA-RESEND-DATE      PIC  X(02).
  5349             20  LA-SENT-DATE        PIC  X(02).
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page  94
* NSRASBL.cbl
  5350             20  FILLER              PIC  X(08).
  5351         16  LA-SOURCE-INFORMATION.
  5352             20  LA-DATA-SOURCE      PIC  X(01).
  5353             20  LA-ADDR-SOURCE      PIC  X(01).
  5354         16  LA-STATUS               PIC  X(01).
  5355             88  LA-STATUS-ACTIVE         VALUE 'A'.
  5356             88  LA-STATUS-COMPLETED      VALUE 'C'.
  5357             88  LA-STATUS-ON-HOLD        VALUE 'H'.
  5358             88  LA-STATUS-TO-BE-PURGED   VALUE 'X'.
  5359             88  LA-STATUS-PURGED         VALUE 'P'.
  5360             88  LA-STATUS-VOIDED         VALUE 'V'.
  5361         16  LA-LAST-RESENT-PRINT-DATE
  5362                                     PIC  X(02).
  5363         16  LA-PRINT-RESTRICTION    PIC  X(01).
  5364             88  LA-PRINT-ONLY-WHEN-CNTL-GIVEN
  5365                                          VALUE 'C'.
  5366             88  LA-PRINT-ONLY-WHEN-FORM-GIVEN
  5367                                          VALUE 'F'.
  5368             88  LA-PRINT-ONLY-WHEN-PROC-GIVEN
  5369                                          VALUE 'P'.
  5370         16  LA-PURGED-DATE          PIC  X(02).
  5371         16  LA-VOIDED-DATE          PIC  X(02).
  5372         16  LA-RESEND-LETR          PIC  X(4).
  5373         16  FILLER                  PIC  X(08).
  5374*        16  LA-RESEND-LETR-2        PIC  X(4).
  5375*        16  LA-RESEND-LETR-3        PIC  X(4).
  5376*        16  FILLER                  PIC  X(59).
  5377         16  LA-ARCHIVE-STATUS       PIC  X.
  5378             88  LA-TEMP                VALUE 'T'.
  5379             88  LA-QWS                 VALUE 'Q'.
  5380             88  LA-BATCH               VALUE 'B'.
  5381         16  LA-FINAL-ACT-IND        PIC  X(1).
  5382         16  LA-VA-DISCLOSURE-IND    PIC  X(1).
  5383         16  LA-ENDT-ARCH-NO         PIC S9(8) COMP.
  5384         16  LA-ENDT-ARCH-NO-X REDEFINES LA-ENDT-ARCH-NO
  5385                                     PIC X(4).
  5386         16  FILLER                  PIC  X(42).
  5387*        16  FILLER                  PIC  X(71).
  5388         16  LA-LAST-MAINT-DATE      PIC  X(2).
  5389         16  LA-LAST-MAINT-TIME      PIC S9(6) COMP-3.
  5390         16  LA-LAST-MAINT-TIMEX  REDEFINES LA-LAST-MAINT-TIME
  5391                                     PIC  X(4).
  5392         16  LA-LAST-UPDATED-BY      PIC  X(4).
  5393
  5394******************************************************************
  5395*                                COPY ELCCRTT.
  5396******************************************************************
  5397*                                                                *
  5398*                            ELCCRTT.                            *
  5399*                                                                *
  5400*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  5401*                                                                *
  5402*   FILE TYPE = VSAM,KSDS                                        *
  5403*   RECORD SIZE = 552  RECFORM = FIXED                           *
  5404*                                                                *
  5405*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  5406*                                                                *
  5407*   LOG = YES                                                    *
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page  95
* NSRASBL.cbl
  5408*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5409******************************************************************
  5410*                   C H A N G E   L O G
  5411*
  5412* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5413*-----------------------------------------------------------------
  5414*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5415* EFFECTIVE    NUMBER
  5416*-----------------------------------------------------------------
  5417* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  5418* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  5419* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  5420* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  5421* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  5422* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  5423* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  5424* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  5425******************************************************************
  5426
  5427 01  CERTIFICATE-TRAILERS.
  5428     12  CS-RECORD-ID                      PIC XX.
  5429         88  VALID-CS-ID                      VALUE 'CS'.
  5430
  5431     12  CS-CONTROL-PRIMARY.
  5432         16  CS-COMPANY-CD                 PIC X.
  5433         16  CS-CARRIER                    PIC X.
  5434         16  CS-GROUPING                   PIC X(6).
  5435         16  CS-STATE                      PIC XX.
  5436         16  CS-ACCOUNT                    PIC X(10).
  5437         16  CS-CERT-EFF-DT                PIC XX.
  5438         16  CS-CERT-NO.
  5439             20  CS-CERT-PRIME             PIC X(10).
  5440             20  CS-CERT-SFX               PIC X.
  5441         16  CS-TRAILER-TYPE               PIC X.
  5442             88  COMM-TRLR           VALUE 'A'.
  5443             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  5444             88  CERT-DATA-TRLR      VALUE 'C'.
  5445
  5446     12  CS-DATA-AREA                      PIC X(516).
  5447
  5448     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  5449         16  CS-BANK-COMMISSION-AREA.
  5450             20  CS-BANK-COMMS       OCCURS 10.
  5451                 24  CS-AGT                PIC X(10).
  5452                 24  CS-COM-TYP            PIC X.
  5453                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  5454                 24  CS-RECALC-LV-INDIC    PIC X.
  5455                 24  FILLER                PIC X(10).
  5456         16  FILLER                        PIC X(256).
  5457
  5458     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  5459****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  5460         16  CS-MB-CLAIM-DATA OCCURS 24.
  5461             20  CS-CLAIM-NO               PIC X(7).
  5462             20  CS-CLAIM-TYPE             PIC X.
  5463                 88  CS-AH-CLM               VALUE 'A'.
  5464                 88  CS-IU-CLM               VALUE 'I'.
  5465                 88  CS-GP-CLM               VALUE 'G'.
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page  96
* NSRASBL.cbl
  5466                 88  CS-LF-CLM               VALUE 'L'.
  5467                 88  CS-PR-CLM               VALUE 'P'.
  5468                 88  CS-FL-CLM               VALUE 'F'.
  5469             20  CS-INSURED-TYPE           PIC X.
  5470                 88  CS-PRIM-INSURED          VALUE 'P'.
  5471                 88  CS-CO-BORROWER           VALUE 'C'.
  5472             20  CS-BENEFIT-PERIOD         PIC 99.
  5473             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  5474             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  5475             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  5476         16  FILLER                        PIC X(12).
  5477     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  5478         16  CS-VIN-NUMBER                 PIC X(17).
  5479         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  5480         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  5481         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  5482         16  cs-agent-name.
  5483             20  cs-agent-fname            pic x(20).
  5484             20  cs-agent-mi               pic x.
  5485             20  cs-agent-lname            pic x(25).
  5486         16  cs-license-no                 pic x(15).
  5487         16  cs-npn-number                 pic x(10).
  5488         16  cs-agent-edit-status          pic x.
  5489             88  cs-ae-refer-to-manager      value 'M'.
  5490             88  cs-ae-cover-sheet           value 'C'.
  5491             88  cs-ae-sig-form              value 'S'.
  5492             88  cs-ae-verified              value 'V'.
  5493             88  cs-unidentified-signature   value 'U'.
  5494             88  cs-cert-returned            value 'R'.
  5495             88  cs-accept-no-commission     value 'N'.
  5496         16  FILLER                        PIC X(424).
  5497*        16  FILLER                        PIC X(496).
  5498 01  FILLER                      PIC X(500)  VALUE SPACES.
  5499*                                COPY ELCENCC.
  5500******************************************************************
  5501*                                                                *
  5502*                                                                *
  5503*                            ELCENCC                             *
  5504*                            VMOD=2.001                          *
  5505*                                                                *
  5506*   CLAIM SYSTEM ENCLOSURE CODE TABLE                            *
  5507*                                                                *
  5508*   THIS COPYBOOK IS USED FOR THE ONLINE PROCESS OF CREATING     *
  5509*   A NAPERSOFT DOCUMENT                                         *
  5510*                                                                *
  5511*   FILE DESCRIPTION = ENCLOSURE CODE TABLE                      *
  5512*                                                                *
  5513*   FILE TYPE = VSAM,KSDS                                        *
  5514*   RECORD SIZE = 400   RECFORM = FIX                            *
  5515*                                                                *
  5516*   BASE CLUSTER NAME = ELENCC                    RKP=2,LEN=16   *
  5517*                                                                *
  5518*   LOG = NO                                                     *
  5519*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5520*                                                                *
  5521*                                                                *
  5522******************************************************************
  5523*                   C H A N G E   L O G
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page  97
* NSRASBL.cbl
  5524*
  5525* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5526*-----------------------------------------------------------------
  5527*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5528* EFFECTIVE    NUMBER
  5529*-----------------------------------------------------------------
  5530* 082010    2008100900001  PEMA  NEW COPYBOOK/FILE
  5531******************************************************************
  5532 01  ENCLOSURE-CODES.
  5533     12  NC-RECORD-ID                      PIC XX.
  5534         88  VALID-NC-ID                      VALUE 'NC'.
  5535     12  NC-CONTROL-PRIMARY.
  5536         16  NC-COMPANY-CD                 PIC X.
  5537         16  NC-REC-TYPE                   PIC X.
  5538             88  NC-CLAIMS                   VALUE '1'.
  5539             88  NC-ADMIN                    VALUE '2'.
  5540         16  NC-ENC-CODE                   PIC X(5).
  5541         16  FILLER                        PIC X(09).
  5542     12  NC-MAINT-INFORMATION.
  5543         16  NC-LAST-MAINT-DT              PIC XX.
  5544         16  NC-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  5545         16  NC-LAST-MAINT-USER            PIC X(4).
  5546         16  FILLER                        PIC XX.
  5547     12  NC-OUTPUT-STACK                   PIC XXX.
  5548     12  NC-ENCLOSURE-LINE                 PIC X(100).
  5549     12  NC-ATTACHMENTS                    PIC X(100).
  5550     12  NC-FUTURE                         PIC X(50).
  5551     12  FILLER                            PIC X(117).
  5552******************************************************************
  5553****************************************************************
  5554*
  5555* Copyright (c) 2007 by Clerity Solutions, Inc.
  5556* All rights reserved.
  5557*
  5558****************************************************************
  5559 01  DFHEIV.
  5560   02  DFHEIV0               PIC X(35).
  5561   02  DFHEIV1               PIC X(08).
  5562   02  DFHEIV2               PIC X(08).
  5563   02  DFHEIV3               PIC X(08).
  5564   02  DFHEIV4               PIC X(06).
  5565   02  DFHEIV5               PIC X(04).
  5566   02  DFHEIV6               PIC X(04).
  5567   02  DFHEIV7               PIC X(02).
  5568   02  DFHEIV8               PIC X(02).
  5569   02  DFHEIV9               PIC X(01).
  5570   02  DFHEIV10              PIC S9(7) COMP-3.
  5571   02  DFHEIV11              PIC S9(4) COMP SYNC.
  5572   02  DFHEIV12              PIC S9(4) COMP SYNC.
  5573   02  DFHEIV13              PIC S9(4) COMP SYNC.
  5574   02  DFHEIV14              PIC S9(4) COMP SYNC.
  5575   02  DFHEIV15              PIC S9(4) COMP SYNC.
  5576   02  DFHEIV16              PIC S9(9) COMP SYNC.
  5577   02  DFHEIV17              PIC X(04).
  5578   02  DFHEIV18              PIC X(04).
  5579   02  DFHEIV19              PIC X(04).
  5580   02  DFHEIV20              USAGE IS POINTER.
  5581   02  DFHEIV21              USAGE IS POINTER.
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page  98
* NSRASBL.cbl
  5582   02  DFHEIV22              USAGE IS POINTER.
  5583   02  DFHEIV23              USAGE IS POINTER.
  5584   02  DFHEIV24              USAGE IS POINTER.
  5585   02  DFHEIV25              PIC S9(9) COMP SYNC.
  5586   02  DFHEIV26              PIC S9(9) COMP SYNC.
  5587   02  DFHEIV27              PIC S9(9) COMP SYNC.
  5588   02  DFHEIV28              PIC S9(9) COMP SYNC.
  5589   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  5590   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  5591   02  FILLER                PIC X(02).
  5592   02  DFHEIV99              PIC X(08) VALUE SPACE.
  5593   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  5594   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  5595   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  5596   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  5597 LINKAGE  SECTION.
  5598*****************************************************************
  5599*                                                               *
  5600* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  5601* All rights reserved.                                          *
  5602*                                                               *
  5603*****************************************************************
  5604 01  dfheiblk.
  5605     02  eibtime          pic s9(7) comp-3.
  5606     02  eibdate          pic s9(7) comp-3.
  5607     02  eibtrnid         pic x(4).
  5608     02  eibtaskn         pic s9(7) comp-3.
  5609     02  eibtrmid         pic x(4).
  5610     02  dfheigdi         pic s9(4) comp.
  5611     02  eibcposn         pic s9(4) comp.
  5612     02  eibcalen         pic s9(4) comp.
  5613     02  eibaid           pic x(1).
  5614     02  eibfiller1       pic x(1).
  5615     02  eibfn            pic x(2).
  5616     02  eibfiller2       pic x(2).
  5617     02  eibrcode         pic x(6).
  5618     02  eibfiller3       pic x(2).
  5619     02  eibds            pic x(8).
  5620     02  eibreqid         pic x(8).
  5621     02  eibrsrce         pic x(8).
  5622     02  eibsync          pic x(1).
  5623     02  eibfree          pic x(1).
  5624     02  eibrecv          pic x(1).
  5625     02  eibsend          pic x(1).
  5626     02  eibatt           pic x(1).
  5627     02  eibeoc           pic x(1).
  5628     02  eibfmh           pic x(1).
  5629     02  eibcompl         pic x(1).
  5630     02  eibsig           pic x(1).
  5631     02  eibconf          pic x(1).
  5632     02  eiberr           pic x(1).
  5633     02  eibrldbk         pic x(1).
  5634     02  eiberrcd         pic x(4).
  5635     02  eibsynrb         pic x(1).
  5636     02  eibnodat         pic x(1).
  5637     02  eibfiller5       pic x(2).
  5638     02  eibresp          pic 9(09) comp.
  5639     02  eibresp2         pic 9(09) comp.
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page  99
* NSRASBL.cbl
  5640     02  dfheigdj         pic s9(4) comp.
  5641     02  dfheigdk         pic s9(4) comp.
  5642 01 dfhcommarea                  PIC X(6500).
  5643
  5644 01  var  pic x(30).
  5645 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA VAR.
  5646 0000-DFHEXIT SECTION.
  5647     MOVE '9#                    $   ' TO DFHEIV0.
  5648     MOVE 'NSRASBL' TO DFHEIV1.
  5649     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  5650     display ' entering pgm nsrasbl '
  5651     display ' commarea ' dfhcommarea
  5652     MOVE EIBDATE                TO DC-JULIAN-YYDDD
  5653     MOVE '5'                    TO DC-OPTION-CODE
  5654     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  5655     MOVE DC-GREG-DATE-1-EDIT    TO SAVE-DATE
  5656     MOVE DC-GREG-DATE-A-EDIT    TO WS-SAVE-EDIT-A-DATE
  5657     MOVE DC-BIN-DATE-1          TO SAVE-BIN-DATE
  5658     MOVE DC-DAY-OF-WEEK         TO SAVE-CYCLE-DAY-OF-WEEK
  5659     move dfhcommarea            to srch-commarea
  5660*****************************************************
  5661* The full       key has been established and passed
  5662* to this program via NSRASLTR
  5663*****************************************************
  5664     PERFORM 1115-MATCH-COMPANY  THRU 1115-EXIT
  5665     display ' input data ' bl-carrier ' ' bl-group ' '
  5666        bl-account ' ' bl-eff-dt ' ' bl-cert-no
  5667     MOVE BL-LETTER-ID           TO OUT-LETTER
  5668     MOVE BL-PROC-ID             TO OUT-PROC-ID
  5669     MOVE BL-CARRIER             TO OUT-CARRIER
  5670     MOVE BL-GROUP               TO OUT-GROUPING
  5671     MOVE BL-ACCOUNT             TO OUT-ACCOUNT
  5672     MOVE BL-PRINT-NOW-SW        TO OUT-PRINT-NOW
  5673     MOVE BL-CERT-FORM-ID        TO OUT-CERTIFICATE-ID
  5674     MOVE BL-SOURCE-SCREEN       TO OUT-SCREEN-ID
  5675     STRING DC-EDITA-CCYY DC-EDITA-MONTH
  5676        DC-EDITA-DAY  DELIMITED BY SIZE
  5677        INTO OUT-CYCLE-DT
  5678     END-STRING
  5679
  5680     set P to address of KIXSYS
  5681     CALL "getenv" using by value P returning var-ptr
  5682     if var-ptr = null then
  5683        display ' kixsys not set '
  5684     else
  5685        set address of var to var-ptr
  5686        move 0 to env-var-len
  5687        inspect var tallying env-var-len
  5688          for characters before X'00'
  5689        unstring var (1:env-var-len) delimited by '/'
  5690        into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  5691              WS-KIX-SYS
  5692        end-unstring
  5693     end-if
  5694
  5695     set P to address of KIXHOST
  5696     CALL "getenv" using by value P returning var-ptr
  5697     if var-ptr = null then
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page 100
* NSRASBL.cbl
  5698        display ' kixhost not set '
  5699     else
  5700        set address of var to var-ptr
  5701        move 0 to env-var-len
  5702        inspect var tallying env-var-len
  5703          for characters before X'00'
  5704        MOVE var(1:env-var-len)  to ws-kixhost
  5705        DISPLAY ' WS KIX HOST ' WS-KIXHOST
  5706     end-if
  5707
  5708     MOVE SPACES TO SVR
  5709
  5710**** This routine will connect to the Logic Database on SQL Server
  5711**** and call a stored procedure to determine the next business da
  5712
  5713     PERFORM 4100-CONNECT-TO-DB  THRU 4100-EXIT
  5714     IF SQLCODE = 0
  5715        PERFORM 4200-GET-NEXT-BUS-DT  THRU 4200-EXIT
  5716        IF SQLCODE = 0
  5717            MOVE WS-NEXT-BUS-DT TO SAVE-NEXT-BUS-DT-EDIT-A
  5718                                   WS-EDIT-A-DATE
  5719            MOVE WS-EDIT-A-YY   TO DC-YMD-YEAR
  5720            MOVE WS-EDIT-A-MM   TO DC-YMD-MONTH
  5721            MOVE WS-EDIT-A-DD   TO DC-YMD-DAY
  5722            MOVE '3'            TO DC-OPTION-CODE
  5723            PERFORM 9700-DATE-LINK THRU 9700-EXIT
  5724            IF NO-CONVERSION-ERROR
  5725               MOVE DC-BIN-DATE-1 TO SAVE-BIN-NEXT-BUS-DT
  5726            ELSE
  5727               MOVE SAVE-BIN-DATE TO DC-BIN-DATE-1
  5728               MOVE '6'         TO DC-OPTION-CODE
  5729               MOVE ZEROS       TO DC-ELAPSED-MONTHS
  5730               IF SAVE-CYCLE-DAY-OF-WEEK = 6
  5731                  MOVE 3        TO DC-ELAPSED-DAYS
  5732               ELSE
  5733                 IF SAVE-CYCLE-DAY-OF-WEEK = 7
  5734                    MOVE 2     TO DC-ELAPSED-DAYS
  5735                 ELSE
  5736                    MOVE 1     TO DC-ELAPSED-DAYS
  5737                 END-IF
  5738               END-IF
  5739               PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  5740               IF NO-CONVERSION-ERROR
  5741                   MOVE DC-BIN-DATE-2 TO SAVE-BIN-NEXT-BUS-DT
  5742                   MOVE DC-GREG-DATE-A-EDIT TO
  5743                                SAVE-NEXT-BUS-DT-EDIT-A
  5744               ELSE
  5745                   MOVE SAVE-BIN-DATE TO SAVE-BIN-NEXT-BUS-DT
  5746                   MOVE WS-SAVE-EDIT-A-DATE TO
  5747                                SAVE-NEXT-BUS-DT-EDIT-A
  5748               END-IF
  5749            END-IF
  5750        ELSE
  5751            MOVE SAVE-BIN-DATE TO DC-BIN-DATE-1
  5752            MOVE '6'         TO DC-OPTION-CODE
  5753            MOVE ZEROS       TO DC-ELAPSED-MONTHS
  5754            IF SAVE-CYCLE-DAY-OF-WEEK = 6
  5755               MOVE 3        TO DC-ELAPSED-DAYS
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page 101
* NSRASBL.cbl
  5756            ELSE
  5757              IF SAVE-CYCLE-DAY-OF-WEEK = 7
  5758                 MOVE 2     TO DC-ELAPSED-DAYS
  5759              ELSE
  5760                 MOVE 1     TO DC-ELAPSED-DAYS
  5761              END-IF
  5762            END-IF
  5763            PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  5764            IF NO-CONVERSION-ERROR
  5765                MOVE DC-BIN-DATE-2 TO SAVE-BIN-NEXT-BUS-DT
  5766                MOVE DC-GREG-DATE-A-EDIT TO
  5767                                SAVE-NEXT-BUS-DT-EDIT-A
  5768            ELSE
  5769                MOVE SAVE-BIN-DATE TO SAVE-BIN-NEXT-BUS-DT
  5770                MOVE WS-SAVE-EDIT-A-DATE TO
  5771                                SAVE-NEXT-BUS-DT-EDIT-A
  5772            END-IF
  5773        END-IF
  5774     ELSE
  5775        MOVE SAVE-BIN-DATE TO DC-BIN-DATE-1
  5776        MOVE '6'         TO DC-OPTION-CODE
  5777        MOVE ZEROS       TO DC-ELAPSED-MONTHS
  5778        IF SAVE-CYCLE-DAY-OF-WEEK = 6
  5779           MOVE 3        TO DC-ELAPSED-DAYS
  5780        ELSE
  5781          IF SAVE-CYCLE-DAY-OF-WEEK = 7
  5782             MOVE 2     TO DC-ELAPSED-DAYS
  5783          ELSE
  5784             MOVE 1     TO DC-ELAPSED-DAYS
  5785          END-IF
  5786        END-IF
  5787        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  5788        IF NO-CONVERSION-ERROR
  5789            MOVE DC-BIN-DATE-2 TO SAVE-BIN-NEXT-BUS-DT
  5790            MOVE DC-GREG-DATE-A-EDIT TO
  5791                                SAVE-NEXT-BUS-DT-EDIT-A
  5792        ELSE
  5793            MOVE SAVE-BIN-DATE TO SAVE-BIN-NEXT-BUS-DT
  5794            MOVE WS-SAVE-EDIT-A-DATE TO
  5795                                SAVE-NEXT-BUS-DT-EDIT-A
  5796        END-IF
  5797     END-IF
  5798     PERFORM 4300-DISCONNECT THRU 4300-EXIT
  5799
  5800     MOVE SAVE-NEXT-BUS-DT-EDIT-A  TO WS-EDIT-A-DATE
  5801     STRING WS-EDIT-A-CCYY '-' WS-EDIT-A-MM '-'
  5802           WS-EDIT-A-DD ' 00:00:00.0' DELIMITED BY SIZE
  5803              INTO OUT-NEXT-BUS-DT
  5804     END-STRING
  5805     IF BL-EFF-DT = '99/99/99' OR '99/99/9999'
  5806        MOVE HIGH-VALUES         TO WS-PASSED-DT
  5807     ELSE
  5808        IF BL-EFF-DT = SPACES
  5809           display ' bad eff data ' bl-eff-dt ' ' bl-cert-no
  5810        ELSE
  5811           IF BL-EFF-DT (9:2) = SPACES
  5812              STRING BL-EFF-DT (7:2) BL-EFF-DT (1:2)
  5813                     BL-EFF-DT (4:2)
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page 102
* NSRASBL.cbl
  5814                DELIMITED BY SIZE INTO DC-GREG-DATE-1-YMD-R
  5815              END-STRING
  5816           ELSE
  5817              STRING BL-EFF-DT (9:2) BL-EFF-DT (1:2)
  5818                     BL-EFF-DT (4:2)
  5819                DELIMITED BY SIZE INTO DC-GREG-DATE-1-YMD-R
  5820              END-STRING
  5821           END-IF
  5822           MOVE '3'              TO DC-OPTION-CODE
  5823           PERFORM 9700-DATE-LINK THRU 9700-EXIT
  5824           IF NO-CONVERSION-ERROR
  5825              MOVE DC-BIN-DATE-1 TO WS-PASSED-DT
  5826           ELSE
  5827              MOVE 'BAD EFF DATE CONVERT ' TO BL-MESSAGE
  5828              SET BL-FAIL TO TRUE
  5829              GO TO 0000-RETURN
  5830           END-IF
  5831        END-IF
  5832     END-IF
  5833     perform 0800-init-out-data  thru 0800-exit
  5834     SET BL-FAIL TO TRUE
  5835******************************************************************
  5836* DATA SOURCE MEANINGS  BL-DATA-SRCE
  5837*    1) FROM ACCT MAINT
  5838*    2) FROM CERT UPDATE
  5839*    3) FROM COMP MAINT
  5840*    4) FROM REVIEW AND CORRECTIONS
  5841******************************************************************
  5842     EVALUATE BL-DATA-SRCE
  5843        WHEN '1'
  5844           PERFORM 0100-DATA-SRCE-1 THRU 0100-EXIT
  5845        WHEN '2'
  5846           PERFORM 0200-DATA-SRCE-2 THRU 0200-EXIT
  5847        WHEN '3'
  5848           PERFORM 0300-DATA-SRCE-3 THRU 0300-EXIT
  5849        WHEN '4'
  5850           PERFORM 0400-DATA-SRCE-4 THRU 0400-EXIT
  5851        WHEN OTHER
  5852           MOVE ' BAD DATA SOURCE CODE ' TO BL-MESSAGE
  5853     END-EVALUATE
  5854     IF BL-OK
  5855        display ' bl write erarch ' bl-write-erarch
  5856        PERFORM 1250-GET-ELLETR  THRU 1250-EXIT
  5857        PERFORM 1700-GET-ELENCC  THRU 1700-EXIT
  5858        IF BL-ARCHIVE-NO = ZEROS
  5859           PERFORM 1500-GET-ARCH-NO THRU 1500-EXIT
  5860           MOVE WS-ARCHIVE-NO    TO BL-ARCHIVE-NO
  5861           display ' arch zeros, new arch ' bl-archive-no
  5862        END-IF
  5863        MOVE BL-ARCHIVE-NO       TO OUT-ARCH-NO
  5864        PERFORM 0500-SCRUB-DATA  THRU 0500-EXIT
  5865        display ' bl write erarch ' bl-write-erarch
  5866        IF BL-WRITE-ERARCH = 'T' OR 'B'
  5867           PERFORM 0700-WRITE-EXTR THRU 0700-EXIT
  5868           IF BL-FAIL
  5869              GO TO 0000-RETURN
  5870           END-IF
  5871        END-IF
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page 103
* NSRASBL.cbl
  5872        MOVE W-LETTER-TO-ACCT    TO BL-LETTER-TO-ACCT
  5873        MOVE W-LETTER-TO-BENE    TO BL-LETTER-TO-BENE
  5874     END-IF
  5875     .
  5876 0000-RETURN.
  5877     move srch-commarea          to dfhcommarea
  5878
  5879* exec cics
  5880*       return
  5881*    end-exec
  5882*    MOVE '.(                    ''   #00005781' TO DFHEIV0
  5883     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  5884     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5885     MOVE X'2020233030303035373831' TO DFHEIV0(25:11)
  5886     CALL 'kxdfhei1' USING DFHEIV0,
  5887           DFHEIV99,
  5888           DFHEIV99,
  5889           DFHEIV99,
  5890           DFHEIV99,
  5891           DFHEIV99,
  5892           DFHEIV99
  5893     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5894     .
  5895 0100-DATA-SRCE-1.
  5896     PERFORM 1120-MATCH-CARRIER  THRU 1120-EXIT
  5897     PERFORM 1125-MATCH-STATE    THRU 1125-EXIT
  5898     MOVE ' '                    TO WS-ERACCT-SW
  5899     MOVE LOW-VALUES             TO WS-ERACCT-KEY
  5900     MOVE WS-COMPANY-CD          TO WS-ERACCT-COMPANY-CD
  5901     MOVE BL-CARRIER             TO WS-ERACCT-CARRIER
  5902     MOVE BL-GROUP               TO WS-ERACCT-GROUP
  5903     MOVE BL-STATE               TO WS-ERACCT-STATE
  5904     MOVE BL-ACCOUNT             TO WS-ERACCT-ACCOUNT
  5905     MOVE WS-PASSED-DT           TO WS-ERACCT-EXP-DT
  5906                                    WS-CERT-EFF-DT
  5907     PERFORM 1200-GET-ERACCT     THRU 1200-EXIT
  5908     IF ACCT-FOUND
  5909        MOVE AM-CSR-CODE         TO WS-CSR-ID
  5910        PERFORM 1025-GET-CSR-INFO
  5911                                 THRU 1025-EXIT
  5912        PERFORM 1300-DETERMINE-COMM
  5913                                 THRU 1300-EXIT
  5914        SET BL-OK TO TRUE
  5915     ELSE
  5916        MOVE ' ACCOUNT MASTER NOT FOUND ' TO BL-MESSAGE
  5917        SET BL-FAIL TO TRUE
  5918     END-IF
  5919     .
  5920 0100-EXIT.
  5921     EXIT.
  5922 0200-DATA-SRCE-2.
  5923     display ' made it to data srce 2 '
  5924     PERFORM 1120-MATCH-CARRIER  THRU 1120-EXIT
  5925     PERFORM 1125-MATCH-STATE    THRU 1125-EXIT
  5926     MOVE ' '                    TO WS-ELCERT-SW
  5927     MOVE WS-COMPANY-CD          TO WS-ELCERT-COMPANY-CD
  5928     MOVE BL-CARRIER             TO WS-ELCERT-CARRIER
  5929     MOVE BL-GROUP               TO WS-ELCERT-GROUP
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page 104
* NSRASBL.cbl
  5930     MOVE BL-STATE               TO WS-ELCERT-STATE
  5931     MOVE BL-ACCOUNT             TO WS-ELCERT-ACCOUNT
  5932     MOVE WS-PASSED-DT           TO WS-ELCERT-EFF-DT
  5933                                    WS-CERT-EFF-DT
  5934     MOVE BL-CERT-NO             TO WS-ELCERT-CERT-NO
  5935
  5936     MOVE ' '                 TO WS-ERACCT-SW
  5937     MOVE LOW-VALUES          TO WS-ERACCT-KEY
  5938     MOVE WS-ELCERT-KEY (1:22) TO WS-ERACCT-KEY (1:22)
  5939     PERFORM 1200-GET-ERACCT  THRU 1200-EXIT
  5940     IF ACCT-FOUND
  5941        MOVE AM-CSR-CODE      TO WS-CSR-ID
  5942        PERFORM 1025-GET-CSR-INFO THRU 1025-EXIT
  5943     END-IF
  5944     PERFORM 1100-GET-ELCERT     THRU 1100-EXIT
  5945     IF CERT-FOUND
  5946        PERFORM 1130-MATCH-BENCDS THRU 1130-EXIT
  5947        MOVE WS-LF-ABBRV         TO OUT-LF-ABBRV
  5948        MOVE WS-LF-DESC          TO OUT-LF-DESC
  5949        IF WS-LF-EARN = 'B'
  5950           MOVE 'B'              TO OUT-BALLOON-IND
  5951        END-IF
  5952        MOVE WS-WAIT-PER         TO OUT-WAIT-PER
  5953        MOVE WS-RET-ELIM         TO OUT-RET-ELIM
  5954        MOVE WS-AH-DESC          TO OUT-AH-DESC
  5955        MOVE WS-BEN-DAYS         TO OUT-BEN-DAYS
  5956
  5957        IF BL-ENDT-ARCH-NO > ZERO
  5958           MOVE WS-COMPANY-CD      TO WS-ERENDT-COMPANY-CD-A1
  5959           MOVE BL-ENDT-ARCH-NO    TO WS-ERENDT-ARCHIVE
  5960           PERFORM 0600-GET-ERENDT THRU 0600-EXIT
  5961        ELSE
  5962           IF BL-ARCHIVE-NO > ZERO
  5963              MOVE WS-COMPANY-CD      TO WS-ERENDT-COMPANY-CD-A1
  5964              MOVE BL-ARCHIVE-NO      TO WS-ERENDT-ARCHIVE
  5965              PERFORM 0600-GET-ERENDT THRU 0600-EXIT
  5966           END-IF
  5967        END-IF
  5968
  5969        PERFORM 4500-CHECK-BALLOON-STATE THRU 4500-EXIT
  5970*072312 IF (CM-STATE = 'KY' OR 'MD' OR 'WI')
  5971        IF WS-LOOKUP-VALUE > SPACES
  5972          AND (OUT-BALLOON-IND = 'B')
  5973           MOVE 'B'              TO OUT-FORM (3:1)
  5974        END-IF
  5975        SET BL-OK TO TRUE
  5976     ELSE
  5977        display ' cert not found ' ws-elcert-cert-no
  5978        MOVE ' CERTIFICATE NOT FOUND ' TO BL-MESSAGE
  5979        SET BL-FAIL TO TRUE
  5980     END-IF
  5981     .
  5982 0200-EXIT.
  5983     EXIT.
  5984 0300-DATA-SRCE-3.
  5985     PERFORM 1120-MATCH-CARRIER  THRU 1120-EXIT
  5986     MOVE WS-COMPANY-CD          TO WS-ERCOMP-COMPANY-CD
  5987     MOVE BL-CARRIER             TO WS-ERCOMP-CARRIER
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page 105
* NSRASBL.cbl
  5988     MOVE BL-GROUP               TO WS-ERCOMP-GROUP
  5989     MOVE BL-RESP-NO             TO WS-ERCOMP-RESP-NO
  5990     MOVE BL-ACCOUNT             TO WS-ERCOMP-ACCOUNT
  5991     IF WS-ERCOMP-ACCOUNT = SPACES
  5992        MOVE LOW-VALUES          TO WS-ERCOMP-ACCOUNT
  5993        MOVE 'G'                 TO WS-ERCOMP-REC-TYPE
  5994     ELSE
  5995        MOVE 'A'                 TO WS-ERCOMP-REC-TYPE
  5996     END-IF
  5997     PERFORM 1225-GET-ERCOMP     THRU 1225-EXIT
  5998     IF RESP-NORMAL
  5999        MOVE CO-CSR-CODE         TO WS-CSR-ID
  6000        PERFORM 1025-GET-CSR-INFO
  6001                                 THRU 1025-EXIT
  6002        SET BL-OK TO TRUE
  6003     ELSE
  6004        MOVE ' COMPENSATION MASTER NOT FOUND ' TO BL-MESSAGE
  6005        SET BL-FAIL TO TRUE
  6006     END-IF
  6007     .
  6008 0300-EXIT.
  6009     EXIT.
  6010 0400-DATA-SRCE-4.
  6011     MOVE WS-COMPANY-CD          TO WS-ERPNDB-COMPANY-CD
  6012     MOVE BL-BATCH-NO            TO WS-ERPNDB-BATCH-NO
  6013     MOVE BL-BATCH-SEQ           TO WS-ERPNDB-BATCH-SEQ
  6014     MOVE +0                     TO WS-ERPNDB-CHG-SEQ
  6015     MOVE ' '                    TO WS-ERPNDB-SW WS-ERACCT-SW
  6016                                    WS-ELCERT-SW WS-ERENDT-SW
  6017
  6018* EXEC CICS READ
  6019*         DATASET    ('ERPNDB')
  6020*         INTO       (PENDING-BUSINESS)
  6021*         RIDFLD     (WS-ERPNDB-KEY)
  6022*         RESP       (WS-RESPONSE)
  6023*    END-EXEC
  6024     MOVE LENGTH OF
  6025      PENDING-BUSINESS
  6026       TO DFHEIV11
  6027     MOVE 'ERPNDB' TO DFHEIV1
  6028*    MOVE '&"IL       E          (  N#00005907' TO DFHEIV0
  6029     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  6030     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6031     MOVE X'204E233030303035393037' TO DFHEIV0(25:11)
  6032     CALL 'kxdfhei1' USING DFHEIV0,
  6033           DFHEIV1,
  6034           PENDING-BUSINESS,
  6035           DFHEIV11,
  6036           WS-ERPNDB-KEY,
  6037           DFHEIV99,
  6038           DFHEIV99,
  6039           DFHEIV99
  6040     MOVE EIBRESP  TO WS-RESPONSE
  6041     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6042     IF RESP-NORMAL
  6043        IF PB-RECORD-TYPE = '1' OR '2'
  6044           MOVE PB-CARRIER       TO BL-CARRIER
  6045           MOVE PB-GROUPING      TO BL-GROUP
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page 106
* NSRASBL.cbl
  6046           MOVE PB-STATE         TO BL-STATE
  6047           MOVE PB-ACCOUNT       TO BL-ACCOUNT
  6048           MOVE PB-CERT-NO       TO BL-CERT-NO
  6049           MOVE PB-CSR-ID        TO WS-CSR-ID
  6050           IF PB-ISSUE
  6051              SET PROCESS-ISSUE TO TRUE
  6052              MOVE PB-I-LF-BENEFIT-CD TO WS-LF-BENCD
  6053              MOVE PB-I-AH-BENEFIT-CD TO WS-AH-BENCD
  6054              MOVE PB-I-LF-PREM-CALC TO OUT-LF-CALC-PRM
  6055              MOVE PB-I-AH-PREM-CALC TO OUT-AH-CALC-PRM
  6056           ELSE
  6057              SET PROCESS-CANCEL TO TRUE
  6058              MOVE PB-CI-LF-BENEFIT-CD TO WS-LF-BENCD
  6059              MOVE PB-CI-AH-BENEFIT-CD TO WS-AH-BENCD
  6060              MOVE PB-C-LF-REF-CALC TO OUT-LF-CALC-REF
  6061              MOVE PB-C-AH-REF-CALC TO OUT-AH-CALC-REF
  6062           END-IF
  6063           PERFORM 1120-MATCH-CARRIER
  6064                                 THRU 1120-EXIT
  6065           PERFORM 1125-MATCH-STATE
  6066                                 THRU 1125-EXIT
  6067           PERFORM 1130-MATCH-BENCDS
  6068                                 THRU 1130-EXIT
  6069           MOVE WS-LF-ABBRV      TO OUT-LF-ABBRV
  6070           MOVE WS-LF-DESC       TO OUT-LF-DESC
  6071                                    OUT-ORIG-LF-DESC
  6072           IF WS-LF-EARN = 'B'
  6073              MOVE 'B'           TO OUT-BALLOON-IND
  6074           END-IF
  6075           MOVE WS-WAIT-PER      TO OUT-WAIT-PER
  6076                                    OUT-ORIG-WAIT-PER
  6077           MOVE WS-RET-ELIM      TO OUT-RET-ELIM
  6078                                    OUT-ORIG-RET-ELIM
  6079           MOVE WS-AH-DESC       TO OUT-AH-DESC
  6080                                    OUT-ORIG-AH-DESC
  6081           MOVE WS-BEN-DAYS      TO OUT-BEN-DAYS
  6082                                    OUT-ORIG-BEN-DAYS
  6083           PERFORM 1025-GET-CSR-INFO
  6084                                 THRU 1025-EXIT
  6085
  6086           MOVE LOW-VALUES       TO WS-ERACCT-KEY
  6087           MOVE PB-CONTROL-BY-ACCOUNT (1:22)
  6088                                 TO WS-ERACCT-KEY (1:22)
  6089           MOVE PB-CERT-EFF-DT   TO WS-CERT-EFF-DT
  6090           PERFORM 1200-GET-ERACCT THRU 1200-EXIT
  6091           IF ACCT-FOUND
  6092              MOVE AM-CSR-CODE      TO WS-CSR-ID
  6093              PERFORM 1025-GET-CSR-INFO
  6094                                    THRU 1025-EXIT
  6095              PERFORM 1300-DETERMINE-COMM
  6096                                    THRU 1300-EXIT
  6097           END-IF
  6098
  6099           MOVE PB-CONTROL-BY-ACCOUNT (1:33)
  6100                                 TO WS-ELCERT-KEY
  6101           PERFORM 1100-GET-ELCERT
  6102                                 THRU 1100-EXIT
  6103
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page 107
* NSRASBL.cbl
  6104           IF BL-ENDT-ARCH-NO > ZERO
  6105              MOVE PB-COMPANY-CD   TO WS-ERENDT-COMPANY-CD-A1
  6106              MOVE BL-ENDT-ARCH-NO TO WS-ERENDT-ARCHIVE
  6107              PERFORM 0600-GET-ERENDT THRU 0600-EXIT
  6108           ELSE
  6109              IF BL-ARCHIVE-NO > ZERO
  6110                 MOVE PB-COMPANY-CD TO WS-ERENDT-COMPANY-CD-A1
  6111                 MOVE BL-ARCHIVE-NO TO WS-ERENDT-ARCHIVE
  6112                 PERFORM 0600-GET-ERENDT THRU 0600-EXIT
  6113              END-IF
  6114           END-IF
  6115
  6116           SET BL-OK TO TRUE
  6117           PERFORM 4500-CHECK-BALLOON-STATE THRU 4500-EXIT
  6118*072312     IF (CM-STATE = 'KY' OR 'MD' OR 'WI')
  6119           IF WS-LOOKUP-VALUE > SPACES
  6120             AND (OUT-BALLOON-IND = 'B')
  6121              MOVE 'B'           TO OUT-FORM (3:1)
  6122           END-IF
  6123        END-IF
  6124     END-IF
  6125     .
  6126 0400-EXIT.
  6127     EXIT.
  6128 0500-SCRUB-DATA.
  6129*   THE DECODER DOES NOT LIKE & AND I TRIED TO USE
  6130*   A DIFFERENT DELIMITER IN PROGRAM NSRASLTR BUT
  6131*   COULD NOT GET IT TO WORK SO I AM CONVERTING IT
  6132*   TO A HEX 26 TO GET BY THE DECODER
  6133     MOVE FUNCTION LENGTH(OUT-ACCT-NAME)
  6134                                 TO M1
  6135     MOVE OUT-ACCT-NAME          TO WS-WORK-FIELD
  6136     PERFORM VARYING A1 FROM +1 BY +1 UNTIL
  6137        (A1 > M1)
  6138        OR (WS-WORK-FIELD (A1:1) = '*')
  6139        OR (WS-WORK-FIELD (A1:4) = ' DBA' OR ' AKA')
  6140        OR (WS-WORK-FIELD (A1:4) = '(DBA' OR '(AKA')
  6141     END-PERFORM
  6142     IF A1 > M1
  6143        CONTINUE
  6144     ELSE
  6145        MOVE WS-WORK-FIELD (1:A1 - 1)
  6146                                 TO OUT-ACCT-NAME
  6147     END-IF
  6148     MOVE FUNCTION LENGTH(OUT-BENE-NAME)
  6149                                 TO M1
  6150     MOVE OUT-BENE-NAME          TO WS-WORK-FIELD
  6151     PERFORM VARYING A1 FROM +1 BY +1 UNTIL
  6152        (A1 > M1)
  6153        OR (WS-WORK-FIELD (A1:1) = '*')
  6154        OR (WS-WORK-FIELD (A1:4) = ' DBA' OR ' AKA')
  6155        OR (WS-WORK-FIELD (A1:4) = '(DBA' OR '(AKA')
  6156     END-PERFORM
  6157     IF A1 > M1
  6158        CONTINUE
  6159     ELSE
  6160        MOVE WS-WORK-FIELD (1:A1 - 1)
  6161                                 TO OUT-BENE-NAME
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page 108
* NSRASBL.cbl
  6162     END-IF
  6163     IF OUT-CERT-NO = LOW-VALUES OR SPACES
  6164         MOVE '0000000000 '  TO OUT-CERT-NO
  6165     END-IF
  6166     MOVE +1 TO M1
  6167     MOVE SPACES TO BL-RECORD-PASSED-DATA
  6168     MOVE FUNCTION LENGTH(NAPER-OUTPUT-DATA)
  6169                                 TO NS-LEN
  6170     display ' naper output data length ' ns-len
  6171     PERFORM VARYING A1 FROM +1 BY +1 UNTIL
  6172        (NAPER-OUTPUT-DATA (A1:11) = 'EndOfString')
  6173        OR (A1 > NS-LEN)
  6174        IF NAPER-OUTPUT-DATA (A1:3) = SPACES
  6175           CONTINUE
  6176        ELSE
  6177           IF NAPER-OUTPUT-DATA (A1:1) = '~'
  6178              MOVE '&'           TO BL-RECORD-PASSED-DATA (M1:1)
  6179              MOVE ' '           TO NAPER-OUTPUT-DATA (A1:1)
  6180              ADD +1 TO M1
  6181           ELSE
  6182              IF NAPER-OUTPUT-DATA (A1:1) = '&'
  6183                 MOVE '%26'      TO BL-RECORD-PASSED-DATA (M1:3)
  6184                 ADD +3 TO M1
  6185              ELSE
  6186                 MOVE NAPER-OUTPUT-DATA (A1:1)
  6187                                 TO BL-RECORD-PASSED-DATA (M1:1)
  6188                 ADD +1 TO M1
  6189              END-IF
  6190           END-IF
  6191        END-IF
  6192     END-PERFORM
  6193     .
  6194 0500-EXIT.
  6195     EXIT.
  6196 0600-GET-ERENDT.
  6197
  6198* EXEC CICS READ
  6199*         DATASET    ('ERENDT2')
  6200*         INTO       (ENDORSEMENT-RECORD)
  6201*         RIDFLD     (WS-ERENDT-KEY-BY-ARCH)
  6202*         RESP       (WS-RESPONSE)
  6203*    END-EXEC
  6204     MOVE LENGTH OF
  6205      ENDORSEMENT-RECORD
  6206       TO DFHEIV11
  6207     MOVE 'ERENDT2' TO DFHEIV1
  6208*    MOVE '&"IL       E          (  N#00006068' TO DFHEIV0
  6209     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  6210     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6211     MOVE X'204E233030303036303638' TO DFHEIV0(25:11)
  6212     CALL 'kxdfhei1' USING DFHEIV0,
  6213           DFHEIV1,
  6214           ENDORSEMENT-RECORD,
  6215           DFHEIV11,
  6216           WS-ERENDT-KEY-BY-ARCH,
  6217           DFHEIV99,
  6218           DFHEIV99,
  6219           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page 109
* NSRASBL.cbl
  6220     MOVE EIBRESP  TO WS-RESPONSE
  6221     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6222     DISPLAY ' JUST READ ENDT ' WS-RESPONSE ' '
  6223         WS-ERENDT-ARCHIVE
  6224     IF (RESP-NORMAL)
  6225        SET ENDT-FOUND TO TRUE
  6226        PERFORM 0620-BUILD-ENDT  THRU 0620-EXIT
  6227        PERFORM 0650-PROCESS-NO-Change
  6228                                 THRU 0650-EXIT
  6229     END-IF
  6230     .
  6231 0600-EXIT.
  6232     EXIT.
  6233 0620-BUILD-ENDT.
  6234     MOVE SPACES                 TO OUT-ORIG-LF-CAN-DT
  6235                                    OUT-NEW-LF-CAN-DT
  6236                                    OUT-ORIG-AH-CAN-DT
  6237                                    OUT-NEW-AH-CAN-DT
  6238                                    OUT-ORIG-CAN-DT
  6239                                    OUT-NEW-CAN-DT
  6240     IF EN-REC-TYPE = 'C'
  6241        GO TO 0620-PROCESS-CANCEL
  6242     END-IF
  6243     MOVE EN-LF-ORIG-BENCD       TO WS-LF-BENCD
  6244     MOVE EN-AH-ORIG-BENCD       TO WS-AH-BENCD
  6245     PERFORM 1130-MATCH-BENCDS   THRU 1130-EXIT
  6246     MOVE WS-LF-DESC             TO OUT-ORIG-LF-DESC
  6247     IF WS-LF-EARN = 'B'
  6248        MOVE 'B'                 TO OUT-BALLOON-IND
  6249     END-IF
  6250     MOVE WS-AH-DESC             TO OUT-ORIG-AH-DESC
  6251     MOVE WS-RET-ELIM            TO OUT-ORIG-RET-ELIM
  6252     MOVE WS-BEN-DAYS            TO OUT-ORIG-BEN-DAYS
  6253     MOVE WS-WAIT-PER            TO OUT-ORIG-WAIT-PER
  6254     MOVE EN-INS-ORIG-LAST-NAME    TO OUT-ORIG-ILNAME
  6255     MOVE EN-INS-ORIG-FIRST-NAME   TO OUT-ORIG-IFNAME
  6256     MOVE EN-INS-ORIG-MIDDLE-INIT  TO OUT-ORIG-MINIT
  6257     IF EN-INS-ORIG-AGE-DEF-FLAG = 'Y'
  6258         MOVE ZERO                 TO OUT-ORIG-IAGE
  6259     ELSE
  6260         MOVE EN-INS-ORIG-AGE      TO OUT-ORIG-IAGE
  6261     END-IF
  6262     MOVE EN-JNT-ORIG-LAST-NAME    TO OUT-ORIG-JLNAME
  6263     MOVE EN-JNT-ORIG-FIRST-NAME   TO OUT-ORIG-JFNAME
  6264     MOVE EN-JNT-ORIG-MIDDLE-INIT  TO OUT-ORIG-JMINIT
  6265     IF EN-JNT-ORIG-AGE-DEF-FLAG = 'Y'
  6266         MOVE ZERO                 TO OUT-ORIG-JAGE
  6267     ELSE
  6268         MOVE EN-JNT-ORIG-AGE      TO OUT-ORIG-JAGE
  6269     END-IF
  6270     MOVE EN-LF-ORIG-BENCD         TO OUT-ORIG-LF-BENCD
  6271     MOVE EN-LF-ORIG-TERM          TO OUT-ORIG-LF-TERM
  6272     MOVE EN-LF-ORIG-BEN-AMT       TO OUT-ORIG-LF-BEN
  6273     MOVE EN-LF-ORIG-PRM-AMT       TO OUT-ORIG-LF-PRM
  6274     MOVE EN-LF-ORIG-ALT-BEN-AMT   TO OUT-ORIG-LF-ALT-BEN
  6275     MOVE EN-LF-ORIG-ALT-PRM-AMT   TO OUT-ORIG-LF-ALT-PRM
  6276     COMPUTE WS-WRK-AMOUNT = EN-LF-ORIG-PRM-AMT +
  6277                             EN-LF-ORIG-ALT-PRM-AMT
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page 110
* NSRASBL.cbl
  6278     MOVE WS-WRK-AMOUNT          TO OUT-ORIG-LF-CMB-PREM
  6279     IF EN-LF-ORIG-BENCD EQUAL '00' OR SPACES
  6280         MOVE SPACES             TO OUT-ORIG-LF-BEN-A
  6281                                    OUT-ORIG-LF-PRM-A
  6282                                    OUT-ORIG-LF-ALT-BEN-A
  6283                                    OUT-ORIG-LF-ALT-PRM-A
  6284                                    OUT-ORIG-COVERAGE-IND
  6285     ELSE
  6286         MOVE 'LIFE'             TO OUT-ORIG-COVERAGE-IND
  6287         IF EN-LF-ORIG-PRM-AMT = .01
  6288             MOVE SPACES         TO OUT-ORIG-LF-PRM-A
  6289         END-IF
  6290         IF EN-LF-ORIG-BEN-AMT = 999999999.99
  6291             MOVE SPACES         TO OUT-ORIG-LF-BEN-A
  6292         END-IF
  6293         IF EN-LF-ORIG-ALT-PRM-AMT = .01
  6294             MOVE SPACES         TO OUT-ORIG-LF-ALT-PRM-A
  6295         END-IF
  6296         IF EN-LF-ORIG-ALT-BEN-AMT = 999999999.99
  6297             MOVE SPACES         TO OUT-ORIG-LF-ALT-BEN-A
  6298         END-IF
  6299     END-IF
  6300     MOVE EN-LF-ORIG-EXP-DT      TO DC-BIN-DATE-1
  6301     MOVE ' '                    TO DC-OPTION-CODE
  6302     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  6303     IF NO-CONVERSION-ERROR
  6304        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  6305           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  6306              INTO OUT-ORIG-LF-EXP-DT
  6307        END-STRING
  6308     END-IF
  6309     MOVE EN-AH-ORIG-BENCD       TO OUT-ORIG-AH-BENCD
  6310     MOVE EN-AH-ORIG-TERM        TO OUT-ORIG-AH-TERM
  6311     MOVE EN-AH-ORIG-BEN-AMT     TO OUT-ORIG-AH-BEN
  6312     MOVE EN-AH-ORIG-PRM-AMT     TO OUT-ORIG-AH-PRM
  6313     IF EN-AH-ORIG-BENCD EQUAL '00' OR SPACES
  6314         MOVE SPACES             TO OUT-ORIG-AH-BEN-A
  6315                                    OUT-ORIG-AH-PRM-A
  6316     ELSE
  6317        IF OUT-ORIG-COVERAGE-IND = 'LIFE'
  6318            MOVE 'BOTH'          TO OUT-ORIG-COVERAGE-IND
  6319        ELSE
  6320            MOVE 'AH  '          TO OUT-ORIG-COVERAGE-IND
  6321        END-IF
  6322        IF EN-AH-ORIG-PRM-AMT = .01
  6323            MOVE SPACES          TO OUT-ORIG-AH-PRM-A
  6324        END-IF
  6325        IF EN-AH-ORIG-BEN-AMT = 9999999.99
  6326            MOVE SPACES          TO OUT-ORIG-AH-BEN-A
  6327        END-IF
  6328     END-IF
  6329     COMPUTE WS-WORK-PREM =
  6330        EN-LF-ORIG-PRM-AMT + EN-LF-ORIG-ALT-PRM-AMT
  6331           + EN-AH-ORIG-PRM-AMT
  6332     MOVE WS-WORK-PREM           TO OUT-ORIG-TOT-PREM
  6333     MOVE EN-AH-ORIG-EXP-DT      TO DC-BIN-DATE-1
  6334     MOVE ' '                    TO DC-OPTION-CODE
  6335     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page 111
* NSRASBL.cbl
  6336     IF NO-CONVERSION-ERROR
  6337        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  6338           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  6339              INTO OUT-ORIG-AH-EXP-DT
  6340        END-STRING
  6341     END-IF
  6342     MOVE EN-AH-ORIG-CP          TO OUT-ORIG-CRIT-PER
  6343                                    OUT-ORIG-MAX-PMTS
  6344     IF EN-AH-ORIG-BENCD EQUAL '00' OR SPACES
  6345         MOVE SPACES             TO OUT-ORIG-MAX-PMTS-A
  6346     END-IF
  6347     MOVE EN-INS-NEW-LAST-NAME    TO OUT-NEW-ILNAME
  6348     MOVE EN-INS-NEW-FIRST-NAME   TO OUT-NEW-IFNAME
  6349     MOVE EN-INS-NEW-MIDDLE-INIT  TO OUT-NEW-IMINIT
  6350     IF EN-INS-NEW-AGE-DEF-FLAG = 'Y'
  6351         MOVE ZERO                TO OUT-NEW-IAGE
  6352     ELSE
  6353         MOVE EN-INS-NEW-AGE      TO OUT-NEW-IAGE
  6354     END-IF
  6355     MOVE EN-JNT-NEW-LAST-NAME    TO OUT-NEW-JLNAME
  6356     MOVE EN-JNT-NEW-FIRST-NAME   TO OUT-NEW-JFNAME
  6357     MOVE EN-JNT-NEW-MIDDLE-INIT  TO OUT-NEW-JMINIT
  6358     IF EN-JNT-NEW-AGE-DEF-FLAG = 'Y'
  6359         MOVE ZERO                TO OUT-NEW-JAGE
  6360     ELSE
  6361         MOVE EN-JNT-NEW-AGE      TO OUT-NEW-JAGE
  6362     END-IF
  6363     MOVE EN-LF-NEW-BENCD        TO WS-LF-BENCD
  6364     MOVE EN-AH-NEW-BENCD        TO WS-AH-BENCD
  6365     PERFORM 1130-MATCH-BENCDS   THRU 1130-EXIT
  6366     MOVE WS-LF-DESC             TO OUT-NEW-LF-DESC
  6367     IF WS-LF-EARN = 'B'
  6368        MOVE 'B'                 TO OUT-BALLOON-IND
  6369     END-IF
  6370     MOVE WS-AH-DESC             TO OUT-NEW-AH-DESC
  6371     MOVE WS-RET-ELIM            TO OUT-NEW-RET-ELIM
  6372     MOVE WS-BEN-DAYS            TO OUT-NEW-BEN-DAYS
  6373     MOVE WS-WAIT-PER            TO OUT-NEW-WAIT-PER
  6374     MOVE EN-LF-NEW-BENCD         TO OUT-NEW-LF-BENCD
  6375     MOVE EN-LF-NEW-TERM          TO OUT-NEW-LF-TERM
  6376     MOVE EN-LF-NEW-BEN-AMT       TO OUT-NEW-LF-BEN
  6377     MOVE EN-LF-NEW-PRM-AMT       TO OUT-NEW-LF-PRM
  6378     MOVE EN-LF-NEW-ALT-BEN-AMT   TO OUT-NEW-LF-ALT-BEN
  6379     MOVE EN-LF-NEW-ALT-PRM-AMT   TO OUT-NEW-LF-ALT-PRM
  6380     COMPUTE WS-WRK-AMOUNT = EN-LF-NEW-PRM-AMT +
  6381                             EN-LF-NEW-ALT-PRM-AMT
  6382     MOVE WS-WRK-AMOUNT           TO OUT-NEW-LF-CMB-PREM
  6383     IF EN-LF-NEW-BENCD EQUAL '00' OR SPACES
  6384         MOVE SPACES             TO OUT-NEW-LF-BEN-A
  6385                                    OUT-NEW-LF-PRM-A
  6386                                    OUT-NEW-LF-ALT-BEN-A
  6387                                    OUT-NEW-LF-ALT-PRM-A
  6388                                    OUT-NEW-LF-CMB-PREM-A
  6389                                    OUT-NEW-COVERAGE-IND
  6390     ELSE
  6391         MOVE 'LIFE'             TO OUT-NEW-COVERAGE-IND
  6392     END-IF
  6393    MOVE EN-LF-NEW-EXP-DT        TO DC-BIN-DATE-1
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page 112
* NSRASBL.cbl
  6394     MOVE ' '                     TO DC-OPTION-CODE
  6395     PERFORM 9700-DATE-LINK       THRU 9700-EXIT
  6396     IF NO-CONVERSION-ERROR
  6397        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  6398           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  6399              INTO OUT-NEW-LF-EXP-DT
  6400        END-STRING
  6401     END-IF
  6402     MOVE EN-AH-NEW-BENCD         TO OUT-NEW-AH-BENCD
  6403     MOVE EN-AH-NEW-TERM          TO OUT-NEW-AH-TERM
  6404     MOVE EN-AH-NEW-BEN-AMT       TO OUT-NEW-AH-BEN
  6405     MOVE EN-AH-NEW-PRM-AMT       TO OUT-NEW-AH-PRM
  6406     COMPUTE WS-WORK-PREM =
  6407        EN-LF-NEW-PRM-AMT + EN-LF-NEW-ALT-PRM-AMT
  6408           + EN-AH-NEW-PRM-AMT
  6409     MOVE WS-WORK-PREM           TO OUT-NEW-TOT-PREM
  6410     IF EN-AH-NEW-BENCD EQUAL '00' OR SPACES
  6411         MOVE SPACES             TO OUT-NEW-AH-BEN-A
  6412                                    OUT-NEW-AH-PRM-A
  6413     ELSE
  6414        IF OUT-NEW-COVERAGE-IND = 'LIFE'
  6415            MOVE 'BOTH'          TO OUT-NEW-COVERAGE-IND
  6416        ELSE
  6417            MOVE 'AH  '          TO OUT-NEW-COVERAGE-IND
  6418        END-IF
  6419     END-IF
  6420     MOVE EN-AH-NEW-EXP-DT        TO DC-BIN-DATE-1
  6421     MOVE ' '                     TO DC-OPTION-CODE
  6422     PERFORM 9700-DATE-LINK       THRU 9700-EXIT
  6423     IF NO-CONVERSION-ERROR
  6424        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  6425           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  6426              INTO OUT-NEW-AH-EXP-DT
  6427        END-STRING
  6428     END-IF
  6429     MOVE EN-AH-NEW-CP            TO OUT-NEW-CRIT-PER
  6430                                     OUT-NEW-MAX-PMTS
  6431     IF EN-AH-NEW-BENCD EQUAL '00' OR SPACES
  6432         MOVE SPACES             TO OUT-NEW-MAX-PMTS-A
  6433     END-IF
  6434     IF EN-LF-ORIG-EXP-DT > EN-AH-ORIG-EXP-DT
  6435        MOVE OUT-ORIG-LF-EXP-DT  TO OUT-ORIG-SCHED-EXP-DT
  6436     ELSE
  6437        MOVE OUT-ORIG-AH-EXP-DT  TO OUT-ORIG-SCHED-EXP-DT
  6438     END-IF
  6439     IF EN-LF-NEW-EXP-DT > EN-AH-NEW-EXP-DT
  6440        MOVE OUT-NEW-LF-EXP-DT   TO OUT-NEW-SCHED-EXP-DT
  6441     ELSE
  6442        MOVE OUT-NEW-AH-EXP-DT   TO OUT-NEW-SCHED-EXP-DT
  6443     END-IF
  6444     IF EN-LF-ORIG-TERM > EN-AH-ORIG-TERM
  6445        MOVE EN-LF-ORIG-TERM     TO OUT-ORIG-SCHED-TERM
  6446     ELSE
  6447        MOVE EN-AH-ORIG-TERM     TO OUT-ORIG-SCHED-TERM
  6448     END-IF
  6449     IF EN-LF-NEW-TERM > EN-AH-NEW-TERM
  6450        MOVE EN-LF-NEW-TERM      TO OUT-NEW-SCHED-TERM
  6451     ELSE
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page 113
* NSRASBL.cbl
  6452        MOVE EN-AH-NEW-TERM      TO OUT-NEW-SCHED-TERM
  6453     END-IF
  6454     COMPUTE WS-WORK-PREM =
  6455        (EN-LF-NEW-PRM-AMT + EN-LF-NEW-ALT-PRM-AMT +
  6456        EN-AH-NEW-PRM-AMT) -
  6457        (EN-LF-ORIG-PRM-AMT + EN-LF-ORIG-ALT-PRM-AMT +
  6458        EN-AH-ORIG-PRM-AMT)
  6459     MOVE WS-WORK-PREM           TO OUT-TOT-PRM-CHG
  6460     IF EN-CSO-PORTION NOT NUMERIC
  6461        MOVE ZEROS               TO EN-CSO-PORTION
  6462     END-IF
  6463     IF EN-ACCT-PORTION NOT NUMERIC
  6464        MOVE ZERO                TO EN-ACCT-PORTION
  6465     END-IF
  6466*    MOVE EN-CSO-PORTION         TO OUT-CSO-PORTION
  6467*    MOVE EN-ACCT-PORTION        TO OUT-ACCT-PORTION
  6468     IF WS-WORK-PREM > +0
  6469        MOVE 'CSO'               TO OUT-PAYEE
  6470     ELSE
  6471      IF WS-WORK-PREM = +0
  6472         MOVE 'ZERO'             TO OUT-PAYEE
  6473      ELSE
  6474         MOVE 'ACCT'             TO OUT-PAYEE
  6475      END-IF
  6476     END-IF
  6477     COMPUTE WS-ACCT-ORIG-LF-PORT =
  6478        EN-LF-ORIG-PRM-AMT * EN-LF-ORIG-COMM-PCT
  6479     MOVE WS-ACCT-ORIG-LF-PORT TO OUT-ACCT-ORIG-LF-PORT
  6480     COMPUTE WS-ACCT-ORIG-ALT-LF-PORT =
  6481        EN-LF-ORIG-ALT-PRM-AMT * EN-LF-ORIG-COMM-PCT
  6482     MOVE WS-ACCT-ORIG-ALT-LF-PORT TO OUT-ACCT-ORIG-ALT-LF-PORT
  6483     COMPUTE WS-ACCT-ORIG-CMB-LF-PORT =
  6484        (EN-LF-ORIG-PRM-AMT + EN-LF-ORIG-ALT-PRM-AMT)
  6485        * EN-LF-ORIG-COMM-PCT
  6486     MOVE WS-ACCT-ORIG-CMB-LF-PORT TO OUT-ACCT-ORIG-CMB-LF-PORT
  6487     COMPUTE WS-ACCT-ORIG-AH-PORT =
  6488        EN-AH-ORIG-PRM-AMT * EN-AH-ORIG-COMM-PCT
  6489     MOVE WS-ACCT-ORIG-AH-PORT TO OUT-ACCT-ORIG-AH-PORT
  6490     COMPUTE WS-ACCT-ORIG-PORTION =
  6491        WS-ACCT-ORIG-CMB-LF-PORT + WS-ACCT-ORIG-AH-PORT
  6492     MOVE WS-ACCT-ORIG-PORTION TO OUT-ACCT-ORIG-PORTION
  6493
  6494     COMPUTE WS-CSO-ORIG-LF-PORT =
  6495       EN-LF-ORIG-PRM-AMT - WS-ACCT-ORIG-LF-PORT
  6496     MOVE WS-CSO-ORIG-LF-PORT TO OUT-CSO-ORIG-LF-PORT
  6497     COMPUTE WS-CSO-ORIG-ALT-LF-PORT =
  6498       EN-LF-ORIG-ALT-PRM-AMT - WS-ACCT-ORIG-ALT-LF-PORT
  6499     MOVE WS-CSO-ORIG-ALT-LF-PORT TO OUT-CSO-ORIG-ALT-LF-PORT
  6500     COMPUTE WS-CSO-ORIG-CMB-LF-PORT =
  6501       (EN-LF-ORIG-PRM-AMT + EN-LF-ORIG-ALT-PRM-AMT) -
  6502        WS-ACCT-ORIG-CMB-LF-PORT
  6503     MOVE WS-CSO-ORIG-CMB-LF-PORT TO OUT-CSO-ORIG-CMB-LF-PORT
  6504     COMPUTE WS-CSO-ORIG-AH-PORT =
  6505        EN-AH-ORIG-PRM-AMT - WS-ACCT-ORIG-AH-PORT
  6506     MOVE WS-CSO-ORIG-AH-PORT TO OUT-CSO-ORIG-AH-PORT
  6507     COMPUTE WS-CSO-ORIG-PORTION =
  6508        WS-CSO-ORIG-CMB-LF-PORT + WS-CSO-ORIG-AH-PORT
  6509     MOVE WS-CSO-ORIG-PORTION TO OUT-CSO-ORIG-PORTION
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page 114
* NSRASBL.cbl
  6510     COMPUTE WS-ACCT-NEW-LF-PORT =
  6511        EN-LF-NEW-PRM-AMT * EN-LF-NEW-COMM-PCT
  6512     MOVE WS-ACCT-NEW-LF-PORT TO OUT-ACCT-NEW-LF-PORT
  6513     COMPUTE WS-ACCT-NEW-ALT-LF-PORT =
  6514        EN-LF-NEW-ALT-PRM-AMT * EN-LF-NEW-COMM-PCT
  6515     MOVE WS-ACCT-NEW-ALT-LF-PORT TO OUT-ACCT-NEW-ALT-LF-PORT
  6516     COMPUTE WS-ACCT-NEW-CMB-LF-PORT =
  6517        (EN-LF-NEW-PRM-AMT + EN-LF-NEW-ALT-PRM-AMT)
  6518        * EN-LF-NEW-COMM-PCT
  6519     MOVE WS-ACCT-NEW-CMB-LF-PORT TO OUT-ACCT-NEW-CMB-LF-PORT
  6520     COMPUTE WS-ACCT-NEW-AH-PORT =
  6521        EN-AH-NEW-PRM-AMT * EN-AH-NEW-COMM-PCT
  6522     MOVE WS-ACCT-NEW-AH-PORT TO OUT-ACCT-NEW-AH-PORT
  6523     COMPUTE WS-ACCT-NEW-PORTION =
  6524        WS-ACCT-NEW-CMB-LF-PORT + WS-ACCT-NEW-AH-PORT
  6525     MOVE WS-ACCT-NEW-PORTION TO OUT-ACCT-NEW-PORTION
  6526
  6527     COMPUTE WS-CSO-NEW-LF-PORT =
  6528       EN-LF-NEW-PRM-AMT - WS-ACCT-NEW-LF-PORT
  6529     MOVE WS-CSO-NEW-LF-PORT TO OUT-CSO-NEW-LF-PORT
  6530     COMPUTE WS-CSO-NEW-ALT-LF-PORT =
  6531       EN-LF-NEW-ALT-PRM-AMT - WS-ACCT-NEW-ALT-LF-PORT
  6532     MOVE WS-CSO-NEW-ALT-LF-PORT TO OUT-CSO-NEW-ALT-LF-PORT
  6533     COMPUTE WS-CSO-NEW-CMB-LF-PORT =
  6534       (EN-LF-NEW-PRM-AMT + EN-LF-NEW-ALT-PRM-AMT) -
  6535        WS-ACCT-NEW-CMB-LF-PORT
  6536     MOVE WS-CSO-NEW-CMB-LF-PORT TO OUT-CSO-NEW-CMB-LF-PORT
  6537     COMPUTE WS-CSO-NEW-AH-PORT =
  6538        EN-AH-NEW-PRM-AMT - WS-ACCT-NEW-AH-PORT
  6539     MOVE WS-CSO-NEW-AH-PORT TO OUT-CSO-NEW-AH-PORT
  6540     COMPUTE WS-CSO-NEW-PORTION =
  6541        WS-CSO-NEW-CMB-LF-PORT + WS-CSO-NEW-AH-PORT
  6542     MOVE WS-CSO-NEW-PORTION TO OUT-CSO-NEW-PORTION
  6543
  6544     COMPUTE WS-ACCT-LF-PORT-CHG =
  6545        WS-ACCT-NEW-LF-PORT - WS-ACCT-ORIG-LF-PORT
  6546     MOVE WS-ACCT-LF-PORT-CHG TO OUT-ACCT-LF-PORT-CHG
  6547     COMPUTE WS-ACCT-ALT-LF-PORT-CHG =
  6548        WS-ACCT-NEW-ALT-LF-PORT - WS-ACCT-ORIG-ALT-LF-PORT
  6549     MOVE WS-ACCT-ALT-LF-PORT-CHG TO OUT-ACCT-ALT-LF-PORT-CHG
  6550     COMPUTE WS-ACCT-CMB-LF-PORT-CHG =
  6551        WS-ACCT-NEW-CMB-LF-PORT - WS-ACCT-ORIG-CMB-LF-PORT
  6552     MOVE WS-ACCT-CMB-LF-PORT-CHG TO OUT-ACCT-CMB-LF-PORT-CHG
  6553     COMPUTE WS-ACCT-AH-PORT-CHG =
  6554        WS-ACCT-NEW-AH-PORT - WS-ACCT-ORIG-AH-PORT
  6555     MOVE WS-ACCT-AH-PORT-CHG TO OUT-ACCT-AH-PORT-CHG
  6556     COMPUTE WS-ACCT-PORTION-CHG =
  6557        WS-ACCT-NEW-PORTION - WS-ACCT-ORIG-PORTION
  6558     MOVE WS-ACCT-PORTION-CHG TO OUT-ACCT-PORTION-CHG
  6559
  6560     COMPUTE WS-CSO-LF-PORT-CHG =
  6561        WS-CSO-NEW-LF-PORT - WS-CSO-ORIG-LF-PORT
  6562     MOVE WS-CSO-LF-PORT-CHG TO OUT-CSO-LF-PORT-CHG
  6563     COMPUTE WS-CSO-ALT-LF-PORT-CHG =
  6564        WS-CSO-NEW-ALT-LF-PORT - WS-CSO-ORIG-ALT-LF-PORT
  6565     MOVE WS-CSO-ALT-LF-PORT-CHG TO OUT-CSO-ALT-LF-PORT-CHG
  6566     COMPUTE WS-CSO-CMB-LF-PORT-CHG =
  6567        WS-CSO-NEW-CMB-LF-PORT - WS-CSO-ORIG-CMB-LF-PORT
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page 115
* NSRASBL.cbl
  6568     MOVE WS-CSO-CMB-LF-PORT-CHG TO OUT-CSO-CMB-LF-PORT-CHG
  6569     COMPUTE WS-CSO-AH-PORT-CHG =
  6570        WS-CSO-NEW-AH-PORT - WS-CSO-ORIG-AH-PORT
  6571     MOVE WS-CSO-AH-PORT-CHG TO OUT-CSO-AH-PORT-CHG
  6572     COMPUTE WS-CSO-PORTION-CHG =
  6573        WS-CSO-NEW-PORTION - WS-CSO-ORIG-PORTION
  6574     MOVE WS-CSO-PORTION-CHG TO OUT-CSO-PORTION-CHG
  6575
  6576     COMPUTE WS-WORK-PREM =
  6577         EN-LF-NEW-PRM-AMT - EN-LF-ORIG-PRM-AMT
  6578     MOVE WS-WORK-PREM           TO OUT-LF-PREM-CHG
  6579     COMPUTE WS-WORK-PREM =
  6580         EN-LF-NEW-ALT-PRM-AMT - EN-LF-ORIG-ALT-PRM-AMT
  6581     MOVE WS-WORK-PREM           TO OUT-LF-ALT-PREM-CHG
  6582     COMPUTE WS-WORK-PREM =
  6583        (EN-LF-NEW-PRM-AMT + EN-LF-NEW-ALT-PRM-AMT) -
  6584        (EN-LF-ORIG-PRM-AMT + EN-LF-ORIG-ALT-PRM-AMT)
  6585     MOVE WS-WORK-PREM           TO OUT-LF-CMB-PREM-CHG
  6586     COMPUTE WS-WORK-PREM =
  6587        (EN-AH-NEW-PRM-AMT - EN-AH-ORIG-PRM-AMT)
  6588     MOVE WS-WORK-PREM           TO OUT-AH-PREM-CHG
  6589
  6590     move en-sig-sw              to out-sig-sw
  6591     MOVE EN-HEALTH-APP          TO OUT-HEALTH-APP
  6592     MOVE EN-COMM-CHGBK          TO OUT-CHGBACK
  6593     GO TO 0620-CONTINUE
  6594     .
  6595 0620-PROCESS-CANCEL.
  6596     IF EN-LF-ORIG-REF-DT NOT = LOW-VALUES AND SPACES
  6597        MOVE EN-LF-ORIG-REF-DT   TO DC-BIN-DATE-1
  6598        MOVE ' '                 TO DC-OPTION-CODE
  6599        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  6600        IF NO-CONVERSION-ERROR
  6601           STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  6602              DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  6603                 INTO OUT-ORIG-LF-CAN-DT
  6604           END-STRING
  6605        END-IF
  6606        MOVE OUT-ORIG-LF-CAN-DT  TO OUT-ORIG-CAN-DT
  6607     END-IF
  6608
  6609     IF EN-LF-NEW-REF-DT NOT = LOW-VALUES AND SPACES
  6610        MOVE EN-LF-NEW-REF-DT    TO DC-BIN-DATE-1
  6611        MOVE ' '                 TO DC-OPTION-CODE
  6612        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  6613        IF NO-CONVERSION-ERROR
  6614           STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  6615              DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  6616                 INTO OUT-NEW-LF-CAN-DT
  6617           END-STRING
  6618        END-IF
  6619        MOVE OUT-NEW-LF-CAN-DT   TO OUT-NEW-CAN-DT
  6620     END-IF
  6621
  6622     IF EN-AH-ORIG-REF-DT NOT = LOW-VALUES AND SPACES
  6623        MOVE EN-AH-ORIG-REF-DT      TO DC-BIN-DATE-1
  6624        MOVE ' '                    TO DC-OPTION-CODE
  6625        PERFORM 9700-DATE-LINK      THRU 9700-EXIT
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page 116
* NSRASBL.cbl
  6626        IF NO-CONVERSION-ERROR
  6627           STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  6628              DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  6629                 INTO OUT-ORIG-AH-CAN-DT
  6630           END-STRING
  6631        END-IF
  6632        IF EN-AH-ORIG-REF-DT > EN-LF-ORIG-REF-DT
  6633           MOVE OUT-ORIG-AH-CAN-DT  TO OUT-ORIG-CAN-DT
  6634        END-IF
  6635     END-IF
  6636
  6637     IF EN-AH-NEW-REF-DT NOT = LOW-VALUES AND SPACES
  6638        MOVE EN-AH-NEW-REF-DT       TO DC-BIN-DATE-1
  6639        MOVE ' '                    TO DC-OPTION-CODE
  6640        PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  6641        IF NO-CONVERSION-ERROR
  6642           STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  6643              DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  6644                 INTO OUT-NEW-AH-CAN-DT
  6645           END-STRING
  6646        END-IF
  6647        IF EN-AH-NEW-REF-DT > EN-LF-NEW-REF-DT
  6648           MOVE OUT-NEW-AH-CAN-DT  TO OUT-NEW-CAN-DT
  6649        END-IF
  6650     END-IF
  6651     MOVE EN-LF-ORIG-REF-AMT     TO OUT-ORIG-LF-REF
  6652     MOVE EN-AH-ORIG-REF-AMT     TO OUT-ORIG-AH-REF
  6653     MOVE EN-LF-NEW-REF-AMT      TO OUT-NEW-LF-REF
  6654     MOVE EN-AH-NEW-REF-AMT      TO OUT-NEW-AH-REF
  6655     COMPUTE WS-WORK-PREM =
  6656        EN-LF-ORIG-REF-AMT + EN-AH-ORIG-REF-AMT
  6657     MOVE WS-WORK-PREM           TO OUT-ORIG-TOT-REF
  6658     COMPUTE WS-WORK-PREM =
  6659        EN-LF-NEW-REF-AMT + EN-AH-NEW-REF-AMT
  6660     MOVE WS-WORK-PREM           TO OUT-NEW-TOT-REF
  6661     COMPUTE WS-WORK-PREM =
  6662        (EN-LF-NEW-REF-AMT + EN-AH-NEW-REF-AMT) -
  6663        (EN-LF-ORIG-REF-AMT + EN-AH-ORIG-REF-AMT)
  6664     MOVE WS-WORK-PREM           TO OUT-TOT-REF-CHG
  6665
  6666     COMPUTE WS-WORK-PREM =
  6667        (EN-LF-NEW-REF-AMT - EN-LF-ORIG-REF-AMT)
  6668     MOVE WS-WORK-PREM           TO OUT-LF-REF-CHG
  6669     COMPUTE WS-WORK-PREM =
  6670        (EN-AH-NEW-REF-AMT - EN-AH-ORIG-REF-AMT)
  6671     MOVE WS-WORK-PREM           TO OUT-AH-REF-CHG
  6672
  6673*     MOVE EN-CSO-PORTION         TO OUT-CSO-PORTION
  6674*     MOVE EN-ACCT-PORTION        TO OUT-ACCT-PORTION
  6675     MOVE EN-COMM-CHGBK          TO OUT-CHGBACK
  6676
  6677     IF EN-COMM-CHGBK = 'N'
  6678         MOVE ZERO              TO OUT-CSO-ORIG-LF-PORT
  6679                                   OUT-CSO-ORIG-ALT-LF-PORT
  6680         MOVE EN-LF-ORIG-REF-AMT TO OUT-CSO-ORIG-CMB-LF-PORT
  6681         MOVE EN-AH-ORIG-REF-AMT TO OUT-CSO-ORIG-AH-PORT
  6682         COMPUTE WS-CSO-ORIG-PORTION =
  6683             EN-LF-ORIG-REF-AMT + EN-AH-ORIG-REF-AMT
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page 117
* NSRASBL.cbl
  6684         MOVE WS-CSO-ORIG-PORTION TO OUT-CSO-ORIG-PORTION
  6685         MOVE ZERO              TO OUT-ACCT-ORIG-LF-PORT
  6686                                   OUT-ACCT-ORIG-ALT-LF-PORT
  6687                                   OUT-ACCT-ORIG-CMB-LF-PORT
  6688                                   OUT-ACCT-ORIG-AH-PORT
  6689                                   OUT-ACCT-ORIG-PORTION
  6690
  6691         MOVE ZERO              TO OUT-CSO-NEW-LF-PORT
  6692                                   OUT-CSO-NEW-ALT-LF-PORT
  6693         MOVE EN-LF-NEW-REF-AMT TO OUT-CSO-NEW-CMB-LF-PORT
  6694         MOVE EN-AH-NEW-REF-AMT TO OUT-CSO-NEW-AH-PORT
  6695         COMPUTE WS-CSO-NEW-PORTION =
  6696             EN-LF-NEW-REF-AMT + EN-AH-NEW-REF-AMT
  6697         MOVE WS-CSO-NEW-PORTION TO OUT-CSO-NEW-PORTION
  6698         MOVE ZERO              TO OUT-ACCT-NEW-LF-PORT
  6699                                   OUT-ACCT-NEW-ALT-LF-PORT
  6700                                   OUT-ACCT-NEW-CMB-LF-PORT
  6701                                   OUT-ACCT-NEW-AH-PORT
  6702                                   OUT-ACCT-NEW-PORTION
  6703
  6704         MOVE ZERO              TO OUT-CSO-LF-PORT-CHG
  6705                                   OUT-CSO-ALT-LF-PORT-CHG
  6706         COMPUTE WS-CSO-CMB-LF-PORT-CHG =
  6707           EN-LF-NEW-REF-AMT - EN-LF-ORIG-REF-AMT
  6708         MOVE WS-CSO-CMB-LF-PORT-CHG TO OUT-CSO-CMB-LF-PORT-CHG
  6709         COMPUTE WS-CSO-AH-PORT-CHG =
  6710           EN-AH-NEW-REF-AMT - EN-AH-ORIG-REF-AMT
  6711         MOVE WS-CSO-AH-PORT-CHG TO OUT-CSO-AH-PORT-CHG
  6712         COMPUTE WS-CSO-PORTION-CHG =
  6713           (EN-LF-NEW-REF-AMT + EN-AH-NEW-REF-AMT) -
  6714           (EN-LF-ORIG-REF-AMT + EN-AH-ORIG-REF-AMT)
  6715         MOVE WS-CSO-PORTION-CHG TO OUT-CSO-PORTION-CHG
  6716         MOVE ZERO              TO OUT-ACCT-LF-PORT-CHG
  6717                                   OUT-ACCT-ALT-LF-PORT-CHG
  6718                                   OUT-ACCT-CMB-LF-PORT-CHG
  6719                                   OUT-ACCT-AH-PORT-CHG
  6720                                   OUT-ACCT-PORTION-CHG
  6721     ELSE
  6722         MOVE ZERO              TO OUT-ACCT-ORIG-LF-PORT
  6723                                   OUT-ACCT-ORIG-ALT-LF-PORT
  6724         COMPUTE WS-ACCT-ORIG-CMB-LF-PORT =
  6725           (EN-LF-ORIG-REF-AMT * EN-LF-ORIG-REF-COMM-PCT)
  6726         MOVE WS-ACCT-ORIG-CMB-LF-PORT TO
  6727                                  OUT-ACCT-ORIG-CMB-LF-PORT
  6728         COMPUTE WS-ACCT-ORIG-AH-PORT =
  6729           (EN-AH-ORIG-REF-AMT * EN-AH-ORIG-REF-COMM-PCT)
  6730         MOVE WS-ACCT-ORIG-AH-PORT TO OUT-ACCT-ORIG-AH-PORT
  6731         COMPUTE WS-ACCT-ORIG-PORTION =
  6732            WS-ACCT-ORIG-CMB-LF-PORT + WS-ACCT-ORIG-AH-PORT
  6733         MOVE WS-ACCT-ORIG-PORTION TO OUT-ACCT-ORIG-PORTION
  6734
  6735         MOVE ZERO              TO OUT-CSO-ORIG-LF-PORT
  6736                                   OUT-CSO-ORIG-ALT-LF-PORT
  6737         COMPUTE WS-CSO-ORIG-CMB-LF-PORT =
  6738           (EN-LF-ORIG-REF-AMT - WS-ACCT-ORIG-CMB-LF-PORT)
  6739         MOVE WS-CSO-ORIG-CMB-LF-PORT TO OUT-CSO-ORIG-CMB-LF-PORT
  6740         COMPUTE WS-CSO-ORIG-AH-PORT =
  6741           (EN-AH-ORIG-REF-AMT - WS-ACCT-ORIG-AH-PORT)
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page 118
* NSRASBL.cbl
  6742         MOVE WS-CSO-AH-PORTION  TO OUT-CSO-ORIG-AH-PORT
  6743         COMPUTE WS-CSO-ORIG-PORTION =
  6744            WS-CSO-ORIG-CMB-LF-PORT + WS-CSO-ORIG-AH-PORT
  6745         MOVE WS-CSO-ORIG-PORTION TO OUT-CSO-ORIG-PORTION
  6746
  6747         MOVE ZERO              TO OUT-ACCT-NEW-LF-PORT
  6748                                   OUT-ACCT-NEW-ALT-LF-PORT
  6749         COMPUTE WS-ACCT-NEW-CMB-LF-PORT =
  6750           (EN-LF-NEW-REF-AMT * EN-LF-NEW-REF-COMM-PCT)
  6751         MOVE WS-ACCT-NEW-CMB-LF-PORT TO OUT-ACCT-NEW-CMB-LF-PORT
  6752         COMPUTE WS-ACCT-NEW-AH-PORT =
  6753           (EN-AH-NEW-REF-AMT * EN-AH-NEW-REF-COMM-PCT)
  6754         MOVE WS-ACCT-NEW-AH-PORT TO OUT-ACCT-NEW-AH-PORT
  6755         COMPUTE WS-ACCT-NEW-PORTION =
  6756            WS-ACCT-NEW-CMB-LF-PORT + WS-ACCT-NEW-AH-PORT
  6757         MOVE WS-ACCT-NEW-PORTION TO OUT-ACCT-NEW-PORTION
  6758
  6759         MOVE ZERO              TO OUT-CSO-NEW-LF-PORT
  6760                                   OUT-CSO-NEW-ALT-LF-PORT
  6761         COMPUTE WS-CSO-NEW-CMB-LF-PORT =
  6762           (EN-LF-NEW-REF-AMT - WS-ACCT-NEW-CMB-LF-PORT)
  6763         MOVE WS-CSO-NEW-CMB-LF-PORT TO OUT-CSO-NEW-CMB-LF-PORT
  6764         COMPUTE WS-CSO-NEW-AH-PORT =
  6765           (EN-AH-NEW-REF-AMT - WS-ACCT-NEW-AH-PORT)
  6766         MOVE WS-CSO-NEW-AH-PORT TO OUT-CSO-NEW-AH-PORT
  6767         COMPUTE WS-CSO-NEW-PORTION =
  6768            WS-CSO-NEW-CMB-LF-PORT + WS-CSO-NEW-AH-PORT
  6769         MOVE WS-CSO-NEW-PORTION TO OUT-CSO-NEW-PORTION
  6770
  6771         MOVE ZERO               TO OUT-ACCT-LF-PORT-CHG
  6772                                    OUT-ACCT-ALT-LF-PORT-CHG
  6773         COMPUTE WS-ACCT-CMB-LF-PORT-CHG =
  6774            WS-ACCT-NEW-CMB-LF-PORT - WS-ACCT-ORIG-CMB-LF-PORT
  6775         MOVE WS-ACCT-CMB-LF-PORT-CHG TO OUT-ACCT-CMB-LF-PORT-CHG
  6776         COMPUTE WS-ACCT-AH-PORT-CHG =
  6777            WS-ACCT-NEW-AH-PORT - WS-ACCT-ORIG-AH-PORT
  6778         MOVE WS-ACCT-AH-PORT-CHG TO OUT-ACCT-AH-PORT-CHG
  6779         COMPUTE WS-ACCT-PORTION-CHG =
  6780            WS-ACCT-NEW-PORTION - WS-ACCT-ORIG-PORTION
  6781         MOVE WS-ACCT-PORTION-CHG TO OUT-ACCT-PORTION-CHG
  6782
  6783         MOVE ZERO               TO OUT-CSO-LF-PORT-CHG
  6784                                    OUT-CSO-ALT-LF-PORT-CHG
  6785         COMPUTE WS-CSO-CMB-LF-PORT-CHG =
  6786            WS-CSO-NEW-CMB-LF-PORT - WS-CSO-ORIG-CMB-LF-PORT
  6787         MOVE WS-CSO-CMB-LF-PORT-CHG TO OUT-CSO-CMB-LF-PORT-CHG
  6788         COMPUTE WS-CSO-AH-PORT-CHG =
  6789            WS-CSO-NEW-AH-PORT - WS-CSO-ORIG-AH-PORT
  6790         MOVE WS-CSO-AH-PORT-CHG TO OUT-CSO-AH-PORT-CHG
  6791         COMPUTE WS-CSO-PORTION-CHG =
  6792            WS-CSO-NEW-PORTION - WS-CSO-ORIG-PORTION
  6793         MOVE WS-CSO-PORTION-CHG TO OUT-CSO-PORTION-CHG
  6794
  6795     END-IF
  6796     .
  6797 0620-CONTINUE.
  6798     display ' about to bld reason codes ' en-reason-code (1)
  6799     move en-reason-code (1)     to out-rea-cd1
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page 119
* NSRASBL.cbl
  6800     move en-reason-code (2)     to out-rea-cd2
  6801     move en-reason-code (3)     to out-rea-cd3
  6802     move en-reason-code (4)     to out-rea-cd4
  6803     move en-reason-code (5)     to out-rea-cd5
  6804     move en-reason-code (6)     to out-rea-cd6
  6805     move en-reason-code (7)     to out-rea-cd7
  6806     move en-reason-code (8)     to out-rea-cd8
  6807     move en-reason-code (9)     to out-rea-cd9
  6808     move en-reason-code (10)    to out-rea-cd10
  6809     move en-reason-code (11)    to out-rea-cd11
  6810     move en-reason-code (12)    to out-rea-cd12
  6811*    PERFORM 1300-DETERMINE-COMM
  6812*                                THRU 1300-EXIT
  6813     .
  6814 0620-EXIT.
  6815     EXIT.
  6816 0650-PROCESS-NO-Change.
  6817     IF EN-REC-TYPE = 'C'
  6818        GO TO 0650-PROCESS-CANCEL
  6819     END-IF
  6820     if ((OUT-NEW-ILNAME = OUT-ORIG-ILNAME)
  6821        AND (OUT-NEW-ILNAME NOT = SPACES))
  6822                      AND
  6823        ((OUT-NEW-IFNAME = OUT-ORIG-IFNAME)
  6824        AND (OUT-NEW-IFNAME NOT = SPACES))
  6825                      AND
  6826        ((OUT-NEW-IMINIT = OUT-ORIG-MINIT)
  6827        AND (OUT-NEW-IFNAME NOT = SPACES))
  6828        move 'No Change'         to out-new-Ifname
  6829        MOVE SPACES              TO OUT-NEW-IMINIT
  6830        move spaces              to out-new-Ilname
  6831     ELSE
  6832         IF OUT-NEW-ILNAME = SPACES
  6833           AND OUT-NEW-IFNAME = SPACES
  6834           AND OUT-NEW-IMINIT = SPACES
  6835           AND OUT-ORIG-ILNAME NOT = SPACES
  6836            MOVE 'None'          TO OUT-NEW-IFNAME
  6837            MOVE SPACES          TO OUT-NEW-IMINIT
  6838            MOVE SPACES          TO OUT-NEW-ILNAME
  6839         END-IF
  6840     END-IF
  6841     IF ((OUT-NEW-JLNAME = OUT-ORIG-JLNAME)
  6842        AND (OUT-NEW-JLNAME NOT = SPACES))
  6843                    AND
  6844        ((OUT-NEW-JFNAME = OUT-ORIG-JFNAME)
  6845        AND (OUT-NEW-JFNAME NOT = SPACES))
  6846                    AND
  6847        ((OUT-NEW-JMINIT = OUT-ORIG-JMINIT)
  6848        AND (OUT-NEW-JFNAME NOT = SPACES))
  6849        MOVE 'No Change'         TO OUT-NEW-JFNAME
  6850        MOVE SPACES              TO OUT-NEW-JMINIT
  6851        MOVE SPACES              TO OUT-NEW-JLNAME
  6852     ELSE
  6853         IF OUT-NEW-JLNAME = SPACES
  6854           AND OUT-NEW-JFNAME = SPACES
  6855           AND OUT-NEW-JMINIT = SPACES
  6856           AND OUT-ORIG-JLNAME NOT = SPACES
  6857            MOVE 'None'          TO OUT-NEW-JFNAME
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page 120
* NSRASBL.cbl
  6858            MOVE SPACES          TO OUT-NEW-JMINIT
  6859            MOVE SPACES          TO OUT-NEW-JLNAME
  6860         END-IF
  6861     END-IF
  6862     IF (EN-LF-NEW-BEN-AMT = EN-LF-ORIG-BEN-AMT)
  6863        AND (EN-LF-NEW-BENCD NOT EQUAL '00' AND SPACES)
  6864        MOVE 'No Change'         TO OUT-NEW-LF-BEN-A
  6865     ELSE
  6866         IF (EN-LF-ORIG-BENCD NOT = '00' AND SPACES)
  6867           AND (EN-LF-NEW-BENCD = '00' OR SPACES)
  6868             MOVE ZEROS          TO OUT-NEW-LF-BEN
  6869         END-IF
  6870     END-IF
  6871     IF (EN-LF-NEW-PRM-AMT = EN-LF-ORIG-PRM-AMT)
  6872        AND (EN-LF-NEW-BENCD NOT EQUAL '00' AND SPACES)
  6873        MOVE 'No Change'         TO OUT-NEW-LF-PRM-A
  6874     ELSE
  6875         IF (EN-LF-ORIG-BENCD NOT = '00' AND SPACES)
  6876           AND (EN-LF-NEW-BENCD = '00' OR SPACES)
  6877             MOVE ZEROS          TO OUT-NEW-LF-PRM
  6878         END-IF
  6879     END-IF
  6880     IF (EN-LF-NEW-ALT-BEN-AMT = EN-LF-ORIG-ALT-BEN-AMT)
  6881        AND (EN-LF-NEW-BENCD NOT EQUAL '00' AND SPACES)
  6882        MOVE 'No Change'         TO OUT-NEW-LF-ALT-BEN-A
  6883     ELSE
  6884         IF (EN-LF-ORIG-BENCD NOT = '00' AND SPACES)
  6885           AND (EN-LF-NEW-BENCD = '00' OR SPACES)
  6886             MOVE ZEROS          TO OUT-NEW-LF-ALT-BEN
  6887         END-IF
  6888     END-IF
  6889     IF (EN-LF-NEW-ALT-PRM-AMT = EN-LF-ORIG-ALT-PRM-AMT)
  6890        AND (EN-LF-NEW-BENCD NOT EQUAL '00' AND SPACES)
  6891        MOVE 'No Change'         TO OUT-NEW-LF-ALT-PRM-A
  6892     ELSE
  6893         IF (EN-LF-ORIG-BENCD NOT = '00' AND SPACES)
  6894           AND (EN-LF-NEW-BENCD = '00' OR SPACES)
  6895             MOVE ZEROS          TO OUT-NEW-LF-ALT-PRM
  6896         END-IF
  6897     END-IF
  6898
  6899     COMPUTE WS-WRK-AMOUNT = EN-LF-ORIG-PRM-AMT +
  6900                              EN-LF-ORIG-ALT-PRM-AMT
  6901     COMPUTE WS-WRK-AMOUNT2 = EN-LF-NEW-PRM-AMT +
  6902                               EN-LF-NEW-ALT-PRM-AMT
  6903     IF (WS-WRK-AMOUNT2 = WS-WRK-AMOUNT)
  6904        AND (EN-LF-NEW-BENCD NOT EQUAL '00' AND SPACES)
  6905        MOVE 'No Change'         TO OUT-NEW-LF-CMB-PREM-A
  6906     ELSE
  6907         IF (EN-LF-ORIG-BENCD NOT = '00' AND SPACES)
  6908           AND (EN-LF-NEW-BENCD = '00' OR SPACES)
  6909            MOVE ZEROS          TO OUT-NEW-LF-CMB-PREM
  6910         END-IF
  6911     END-IF
  6912     IF OUT-NEW-SCHED-EXP-DT = OUT-ORIG-SCHED-EXP-DT
  6913        MOVE 'No Change'         TO OUT-NEW-SCHED-EXP-DT
  6914     END-IF
  6915     IF (OUT-NEW-LF-EXP-DT = OUT-ORIG-LF-EXP-DT)
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page 121
* NSRASBL.cbl
  6916        AND (OUT-NEW-LF-EXP-DT NOT = SPACES)
  6917        MOVE 'No Change'         TO OUT-NEW-LF-EXP-DT
  6918     END-IF
  6919     IF (OUT-NEW-LF-DESC = OUT-ORIG-LF-DESC)
  6920        AND (OUT-NEW-LF-DESC NOT = SPACES)
  6921        MOVE 'No Change'         to OUT-NEW-LF-DESC
  6922     ELSE
  6923        IF (EN-LF-ORIG-BENCD NOT = '00' AND SPACES)
  6924          AND (EN-LF-NEW-BENCD = '00' OR SPACES)
  6925            MOVE 'None'          TO OUT-NEW-LF-DESC
  6926        END-IF
  6927     end-if
  6928     IF (OUT-NEW-AH-EXP-DT = OUT-ORIG-AH-EXP-DT)
  6929       AND (OUT-NEW-AH-EXP-DT NOT = SPACES)
  6930        MOVE 'No Change'          TO OUT-NEW-AH-EXP-DT
  6931     END-IF
  6932     IF (EN-AH-NEW-BEN-AMT = EN-AH-ORIG-BEN-AMT)
  6933        AND (EN-AH-ORIG-BEN-AMT NOT = ZEROS)
  6934        MOVE 'No Change'         TO OUT-NEW-AH-BEN-A
  6935     ELSE
  6936         IF (EN-AH-ORIG-BENCD NOT = '00' AND SPACES)
  6937           AND (EN-AH-NEW-BENCD = '00' OR SPACES)
  6938             MOVE ZEROS          TO OUT-NEW-AH-BEN
  6939         END-IF
  6940     END-IF
  6941     IF (EN-AH-NEW-PRM-AMT = EN-AH-ORIG-PRM-AMT)
  6942        AND (EN-AH-ORIG-PRM-AMT NOT = ZEROS)
  6943        MOVE 'No Change'         TO OUT-NEW-AH-PRM-A
  6944     ELSE
  6945         IF (EN-AH-ORIG-BENCD NOT = '00' AND SPACES)
  6946           AND (EN-AH-NEW-BENCD = '00' OR SPACES)
  6947             MOVE ZEROS          TO OUT-NEW-AH-PRM
  6948         END-IF
  6949     END-IF
  6950     IF (OUT-NEW-AH-DESC = OUT-ORIG-AH-DESC)
  6951        AND (OUT-ORIG-AH-DESC NOT = SPACES)
  6952        MOVE 'No Change'         TO OUT-NEW-AH-DESC
  6953     ELSE
  6954         IF (EN-AH-ORIG-BENCD NOT = '00' AND SPACES)
  6955           AND (EN-AH-NEW-BENCD = '00' OR SPACES)
  6956             MOVE 'None'         TO OUT-NEW-AH-DESC
  6957         END-IF
  6958     END-IF
  6959     IF EN-INS-ORIG-AGE-DEF-FLAG <> 'Y'
  6960         MOVE 'N' TO EN-INS-ORIG-AGE-DEF-FLAG
  6961     END-IF
  6962     IF EN-INS-NEW-AGE-DEF-FLAG <> 'Y'
  6963         MOVE 'N' TO EN-INS-NEW-AGE-DEF-FLAG
  6964     END-IF
  6965     IF EN-JNT-ORIG-AGE-DEF-FLAG <> 'Y'
  6966         MOVE 'N' TO EN-JNT-ORIG-AGE-DEF-FLAG
  6967     END-IF
  6968     IF EN-JNT-NEW-AGE-DEF-FLAG <> 'Y'
  6969         MOVE 'N' TO EN-JNT-NEW-AGE-DEF-FLAG
  6970     END-IF
  6971
  6972     IF EN-INS-NEW-AGE = EN-INS-ORIG-AGE
  6973       AND EN-INS-NEW-AGE-DEF-FLAG = EN-INS-ORIG-AGE-DEF-FLAG
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page 122
* NSRASBL.cbl
  6974       AND EN-INS-NEW-AGE-DEF-FLAG <> 'Y'
  6975       AND EN-INS-NEW-LAST-NAME = EN-INS-ORIG-LAST-NAME
  6976       AND EN-INS-NEW-FIRST-NAME = EN-INS-ORIG-FIRST-NAME
  6977       AND EN-INS-NEW-MIDDLE-INIT = EN-INS-ORIG-MIDDLE-INIT
  6978        MOVE 'No Change'         TO OUT-NEW-IAGE-A
  6979     END-IF
  6980     IF (EN-JNT-NEW-AGE = EN-JNT-ORIG-AGE)
  6981        AND (EN-JNT-ORIG-AGE NOT = ZEROS)
  6982        AND EN-JNT-NEW-AGE-DEF-FLAG = EN-JNT-ORIG-AGE-DEF-FLAG
  6983        AND EN-JNT-NEW-AGE-DEF-FLAG <> 'Y'
  6984        AND EN-JNT-NEW-LAST-NAME = EN-JNT-ORIG-LAST-NAME
  6985        AND EN-JNT-NEW-FIRST-NAME = EN-JNT-ORIG-FIRST-NAME
  6986        AND EN-JNT-NEW-MIDDLE-INIT = EN-JNT-ORIG-MIDDLE-INIT
  6987        MOVE 'No Change'         TO OUT-NEW-JAGE-A
  6988     ELSE
  6989         IF (EN-JNT-ORIG-AGE > ZEROS)
  6990           AND (EN-JNT-ORIG-AGE-DEF-FLAG <> 'Y')
  6991           AND (EN-JNT-NEW-AGE = ZEROS OR SPACES)
  6992             MOVE 'None'         TO OUT-NEW-JAGE-A
  6993         END-IF
  6994     END-IF
  6995     IF (EN-LF-NEW-TERM = EN-LF-ORIG-TERM)
  6996        AND (EN-LF-ORIG-TERM NOT = ZEROS)
  6997        MOVE 'No Change'         TO OUT-NEW-LF-TERM-A
  6998     ELSE
  6999         IF (EN-LF-ORIG-BENCD NOT = '00' AND SPACES)
  7000           AND (EN-LF-NEW-BENCD = '00' OR SPACES)
  7001             MOVE ZEROS          TO OUT-NEW-LF-TERM
  7002         END-IF
  7003     END-IF
  7004     IF (EN-AH-NEW-TERM = EN-AH-ORIG-TERM)
  7005        AND (EN-AH-ORIG-TERM NOT = ZEROS)
  7006        MOVE 'No Change'         TO OUT-NEW-AH-TERM-A
  7007     ELSE
  7008         IF (EN-AH-ORIG-BENCD NOT = '00' AND SPACES)
  7009           AND (EN-AH-NEW-BENCD = '00' OR SPACES)
  7010             MOVE ZEROS          TO OUT-NEW-AH-TERM
  7011         END-IF
  7012     END-IF
  7013     IF (EN-AH-NEW-CP = EN-AH-ORIG-CP)
  7014        AND (EN-AH-NEW-BENCD NOT EQUAL '00' AND SPACES)
  7015        MOVE 'No Change'         TO OUT-NEW-CRIT-PER-A
  7016                                    OUT-NEW-MAX-PMTS-A
  7017     ELSE
  7018         IF (EN-AH-ORIG-BENCD NOT = '00' AND SPACES)
  7019           AND (EN-AH-NEW-BENCD = '00' OR SPACES)
  7020             MOVE 'None'         TO OUT-NEW-CRIT-PER-A
  7021                                    OUT-NEW-MAX-PMTS-A
  7022         END-IF
  7023     END-IF
  7024     IF OUT-NEW-SCHED-TERM = OUT-ORIG-SCHED-TERM
  7025        MOVE 'No Change'         TO OUT-NEW-SCHED-TERM-A
  7026     END-IF
  7027     IF (OUT-NEW-WAIT-PER = OUT-ORIG-WAIT-PER)
  7028       AND (OUT-ORIG-WAIT-PER NOT = SPACES)
  7029         MOVE 'No Change'        TO OUT-NEW-WAIT-PER
  7030     ELSE
  7031         IF (EN-AH-ORIG-BENCD NOT = '00' AND SPACES)
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page 123
* NSRASBL.cbl
  7032           AND (EN-AH-NEW-BENCD = '00' OR SPACES)
  7033             MOVE 'None'         TO OUT-NEW-WAIT-PER
  7034         END-IF
  7035     END-IF
  7036     .
  7037 0650-PROCESS-CANCEL.
  7038     .
  7039 0650-EXIT.
  7040     EXIT.
  7041 0700-WRITE-EXTR.
  7042     display ' made it to 0700 '
  7043     PERFORM 1000-BUILD-ERARCH   THRU 1000-EXIT
  7044     IF BL-FAIL
  7045        MOVE ' COULDNT BUILD ERARCH ' TO BL-MESSAGE
  7046        GO TO 0700-EXIT
  7047     END-IF
  7048     MOVE WS-COMPANY-CD          TO NSAS-COMPANY-CD
  7049     MOVE BL-ARCHIVE-NO          TO NSAS-ARCHIVE-NO
  7050     MOVE +0                     TO NSAS-SEQ-NO
  7051     PERFORM 0710-BUILD-NSASEXTR THRU 0710-EXIT
  7052     PERFORM 0720-WRITE-NSASEXTR THRU 0720-EXIT
  7053     IF BL-FAIL
  7054        MOVE ' COULDNT BUILD STD NSASEXTR ' TO BL-MESSAGE
  7055        GO TO 0700-EXIT
  7056     END-IF
  7057     IF W-LETTER-TO-ACCT NOT = SPACES
  7058        display ' acct ne spaces ' bl-archive-no
  7059        MOVE W-LETTER-TO-ACCT   TO NSAS-LETTER-VARIABLES (5:1)
  7060        MOVE WS-COMPANY-CD       TO NSAS-COMPANY-CD
  7061        MOVE BL-ARCHIVE-NO       TO NSAS-ARCHIVE-NO
  7062        MOVE +1                  TO NSAS-SEQ-NO
  7063        PERFORM 0720-WRITE-NSASEXTR
  7064                                 THRU 0720-EXIT
  7065        IF BL-FAIL
  7066           MOVE ' COULDNT BUILD ACCT NSASEXTR ' TO BL-MESSAGE
  7067           GO TO 0700-EXIT
  7068        END-IF
  7069     END-IF
  7070     IF W-LETTER-TO-BENE NOT = SPACES
  7071        display ' bene ne spaces ' bl-archive-no
  7072        MOVE W-LETTER-TO-BENE   TO NSAS-LETTER-VARIABLES (5:1)
  7073        MOVE WS-COMPANY-CD       TO NSAS-COMPANY-CD
  7074        MOVE BL-ARCHIVE-NO       TO NSAS-ARCHIVE-NO
  7075        MOVE +2                  TO NSAS-SEQ-NO
  7076        PERFORM 0720-WRITE-NSASEXTR
  7077                                 THRU 0720-EXIT
  7078        IF BL-FAIL
  7079           MOVE ' COULDNT BUILD BENE NSASEXTR ' TO BL-MESSAGE
  7080        END-IF
  7081     END-IF
  7082     IF W-PRINT-CERTIFICATE = 'Y' AND
  7083        BL-STATE = 'VA'
  7084           MOVE OUT-ACCT-NAME       TO VD-ACCOUNT-NAME
  7085           MOVE WS-COMPANY-CD       TO VD-COMPANY-CD
  7086           MOVE BL-CARRIER          TO VD-CARRIER
  7087           MOVE BL-GROUP            TO VD-GROUPING
  7088           MOVE BL-STATE            TO VD-STATE
  7089           MOVE BL-ACCOUNT          TO VD-ACCOUNT
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page 124
* NSRASBL.cbl
  7090           MOVE WS-ELCERT-EFF-DT    TO VD-CERT-EFF-DT
  7091           MOVE BL-CERT-NO          TO VD-CERT-NO
  7092           MOVE OUT-ILNAME          TO VD-INSURED-LAST-NAME
  7093           MOVE OUT-IFNAME          TO VD-INSURED-FIRST-NAME
  7094           MOVE OUT-IMINIT          TO VD-INSURED-MIDDLE-INIT
  7095           MOVE OUT-JLNAME          TO VD-JOINT-LAST-NAME
  7096           MOVE OUT-JFNAME          TO VD-JOINT-FIRST-NAME
  7097           MOVE OUT-JMINIT          TO VD-JOINT-MIDDLE-INIT
  7098           MOVE OUT-BENE-NAME       TO VD-BENEFICIARY-NAME
  7099           MOVE OUT-ENTRY-BATCH     TO VD-ENTRY-BATCH
  7100           MOVE OUT-CSR-CODE        TO VD-CSR-ID
  7101           MOVE CM-LF-BENEFIT-CD    TO VD-LF-BENEFIT-CD
  7102           MOVE CM-LF-PREMIUM-AMT   TO VD-LF-PREMIUM-AMT
  7103           MOVE CM-LF-BENEFIT-AMT   TO VD-LF-BENEFIT-AMT
  7104           MOVE CM-LF-ORIG-TERM     TO VD-LF-TERM
  7105           MOVE CM-LF-PREMIUM-RATE  TO VD-LF-RATE
  7106           MOVE CM-AH-BENEFIT-CD    TO VD-AH-BENEFIT-CD
  7107           MOVE CM-AH-PREMIUM-AMT   TO VD-AH-PREMIUM-AMT
  7108           MOVE CM-AH-BENEFIT-AMT   TO VD-AH-BENEFIT-AMT
  7109           MOVE CM-AH-ORIG-TERM     TO VD-AH-TERM
  7110           MOVE CM-AH-PREMIUM-RATE  TO VD-AH-RATE
  7111           MOVE CM-LOAN-TERM        TO VD-LOAN-TERM
  7112           MOVE CM-LOAN-APR         TO VD-LOAN-APR
  7113           MOVE CM-LOAN-1ST-PMT-DT  TO VD-1ST-PMT-DT
  7114           MOVE OUT-INS-ADDR1       TO VD-INSURED-ADDRESS-1
  7115           MOVE OUT-INS-ADDR2       TO VD-INSURED-ADDRESS-2
  7116           MOVE OUT-INS-CITY        TO VD-INSURED-CITY
  7117           MOVE OUT-INS-STATE       TO VD-INSURED-STATE
  7118           MOVE OUT-INS-ZIP         TO VD-INSURED-ZIP-CODE
  7119           MOVE 'VADS'              TO VD-LETTER-ID
  7120           MOVE OUT-PROC-ID         TO VD-PROC-ID
  7121           MOVE BL-COMP-ID          TO VD-COMP-ID
  7122           MOVE EIBTIME             TO VD-CURRENT-TIME
  7123           MOVE SAVE-BIN-DATE       TO VD-CURRENT-DATE
  7124           MOVE BL-ARCHIVE-NO       TO VD-ARCHIVE-NO
  7125           MOVE VIRGINIA-DISCLOSURE TO WS-PASS-VADS-REC
  7126
  7127* EXEC CICS LINK
  7128*              PROGRAM    (LINK-ELVADS)
  7129*              COMMAREA   (WS-PASS-AREA)
  7130*              LENGTH     (WS-PASS-AREA-LENGTH)
  7131*          END-EXEC
  7132*    MOVE '."C                   (   #00006978' TO DFHEIV0
  7133     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  7134     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7135     MOVE X'2020233030303036393738' TO DFHEIV0(25:11)
  7136     CALL 'kxdfhei1' USING DFHEIV0,
  7137           LINK-ELVADS,
  7138           WS-PASS-AREA,
  7139           WS-PASS-AREA-LENGTH,
  7140           DFHEIV99,
  7141           DFHEIV99,
  7142           DFHEIV99,
  7143           DFHEIV99
  7144     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7145     END-IF
  7146     .
  7147 0700-EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page 125
* NSRASBL.cbl
  7148     EXIT.
  7149  0710-BUILD-NSASEXTR.
  7150***  i added the extra space in front of the 1st ~
  7151***  only because there may be a letter to acct or bene
  7152     STRING
  7153         OUT-LETTER             ' ~'
  7154         OUT-PROC-ID            '~'
  7155         OUT-PROC-NAME          '~'
  7156         OUT-PROC-TITLE         '~'
  7157         OUT-CSR-NAME           '~'
  7158         OUT-CSR-TITLE          '~'
  7159         OUT-CARRIER            '~'
  7160         OUT-GROUPING           '~'
  7161         OUT-STATE              '~'
  7162         OUT-ACCOUNT            '~'
  7163         OUT-CERT-EFF-DT        '~'
  7164         OUT-CERT-NO            '~'
  7165         OUT-CERT-SFX           '~'
  7166         OUT-ILNAME             '~'
  7167         OUT-IFNAME             '~'
  7168         OUT-IFINIT             '~'
  7169         OUT-IMINIT             '~'
  7170         OUT-IAGE               '~'
  7171         OUT-ISEX               '~'
  7172         OUT-INS-ADDR1          '~'
  7173         OUT-INS-ADDR2          '~'
  7174         OUT-INS-CITY           '~'
  7175         OUT-INS-STATE          '~'
  7176         OUT-INS-ZIP            '~'
  7177         OUT-SOC-SEC-NO         '~'
  7178         OUT-MEMBER-NO          '~'
  7179         OUT-JLNAME             '~'
  7180         OUT-JFNAME             '~'
  7181         OUT-JMINIT             '~'
  7182         OUT-JAGE               '~'
  7183         OUT-ACCT-NAME          '~'
  7184         OUT-ACCT-ADDR1         '~'
  7185         OUT-ACCT-ADDR2         '~'
  7186         OUT-ACCT-CITY          '~'
  7187         OUT-ACCT-STATE         '~'
  7188         OUT-ACCT-ZIP           '~'
  7189         OUT-ACCT-PHONE         '~'
  7190         OUT-ACCT-CNTRL-NAME    '~'
  7191         OUT-ACCT-BUS-TYPE      '~'
  7192         OUT-BENE-NAME          '~'
  7193         OUT-BENE-ADDR1         '~'
  7194         OUT-BENE-ADDR2         '~'
  7195         OUT-BENE-CITY          '~'
  7196         OUT-BENE-STATE         '~'
  7197         OUT-BENE-ZIP           '~'
  7198         OUT-CARR-NAME          '~'
  7199         OUT-RESP-NO            '~'
  7200         OUT-COMP-NAME          '~'
  7201         OUT-COMP-MAIL-TO       '~'
  7202         OUT-COMP-ADDR1         '~'
  7203         OUT-COMP-ADDR2         '~'
  7204         OUT-COMP-CITY          '~'
  7205         OUT-COMP-STATE         '~'
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page 126
* NSRASBL.cbl
  7206         OUT-COMP-ZIP           '~'
  7207         OUT-COMP-PHONE         '~'
  7208         OUT-COMP-FAX           '~'
  7209         OUT-COMP-STATUS        '~'
  7210         OUT-BILL-SW            '~'
  7211         OUT-RPT-CD1            '~'
  7212         OUT-RPT-CD2            '~'
  7213         OUT-ENTRY-DT           '~'
  7214         OUT-ENTRY-BATCH        '~'
  7215         OUT-ENTRY-STATUS       '~'
  7216         OUT-1ST-PMT-DT         '~'
  7217         OUT-LOAN-APR           '~'
  7218         OUT-LOAN-TERM          '~'
  7219         OUT-RATE-CLASS         '~'
  7220         OUT-EXT-DAYS           '~'
  7221         OUT-CSR-CODE           '~'
  7222         OUT-UCODE              '~'
  7223         OUT-PREM-TYPE          '~'
  7224         OUT-IND-GRP            '~'
  7225         OUT-SKIP-CD            '~'
  7226         OUT-PMT-MODE           '~'
  7227         OUT-LOAN-OFF           '~'
  7228         OUT-REIN-TABLE         '~'
  7229         OUT-SPEC-REIN          '~'
  7230         OUT-LF-BENCD           '~'
  7231         OUT-LF-TERM            '~'
  7232         OUT-LF-DEV-CD          '~'
  7233         OUT-LF-DEV-PCT         '~'
  7234         OUT-LF-BEN             '~'
  7235         OUT-LF-PRM             '~'
  7236         OUT-LF-ALT-BEN         '~'
  7237         OUT-LF-ALT-PRM         '~'
  7238         OUT-LF-NSP             '~'
  7239         OUT-LF-REM-BEN         '~'
  7240         OUT-LF-REF             '~'
  7241         OUT-LF-DTH             '~'
  7242         OUT-LF-RATE            '~'
  7243         OUT-LF-ALT-RATE        '~'
  7244         OUT-LF-EXP-DT          '~'
  7245         OUT-LF-CUR-STATUS      '~'
  7246         OUT-LF-CAN-DT          '~'
  7247         OUT-LF-CAN-EXIT-DT     '~'
  7248         OUT-LF-DTH-DT          '~'
  7249         OUT-LF-DTH-EXIT-DT     '~'
  7250         OUT-LF-EXIT-BATCH      '~'
  7251         OUT-LF-COMM-PCT        '~'
  7252         OUT-LF-DESC            '~'
  7253         OUT-LF-ABBRV           '~'
  7254         OUT-AH-BENCD           '~'
  7255         OUT-AH-TERM            '~'
  7256         OUT-CRIT-PER           '~'
  7257         OUT-AH-DEV-CD          '~'
  7258         OUT-AH-DEV-PCT         '~'
  7259         OUT-AH-BEN             '~'
  7260         OUT-AH-PRM             '~'
  7261         OUT-AH-NSP             '~'
  7262         OUT-AH-REF             '~'
  7263         OUT-AH-CLM             '~'
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page 127
* NSRASBL.cbl
  7264         OUT-AH-TOT-BEN         '~'
  7265         OUT-AH-PDTHRU-DT       '~'
  7266         OUT-AH-RATE            '~'
  7267         OUT-AH-EXP-DT          '~'
  7268         OUT-AH-CUR-STATUS      '~'
  7269         OUT-AH-CAN-DT          '~'
  7270         OUT-AH-CAN-EXIT-DT     '~'
  7271         OUT-AH-EXIT-BATCH      '~'
  7272         OUT-AH-COMM-PCT        '~'
  7273         OUT-AH-DESC            '~'
  7274         OUT-RET-ELIM           '~'
  7275         OUT-BEN-DAYS           '~'
  7276         OUT-WAIT-PER           '~'
  7277         OUT-MAX-PMTS           '~'
  7278         OUT-TOT-PRM            '~'
  7279         OUT-TOT-REF            '~'
  7280         OUT-SCHED-EXP-DT       '~'
  7281         OUT-SCHED-TERM         '~'
  7282         OUT-ORIG-ILNAME        '~'
  7283         OUT-ORIG-IFNAME        '~'
  7284         OUT-ORIG-MINIT         '~'
  7285         OUT-ORIG-IAGE          '~'
  7286         OUT-ORIG-JLNAME        '~'
  7287         OUT-ORIG-JFNAME        '~'
  7288         OUT-ORIG-JMINIT        '~'
  7289         OUT-ORIG-JAGE          '~'
  7290         OUT-ORIG-LF-BENCD      '~'
  7291         OUT-ORIG-LF-TERM       '~'
  7292         OUT-ORIG-LF-BEN        '~'
  7293         OUT-ORIG-LF-PRM        '~'
  7294         OUT-LF-CALC-PRM        '~'
  7295         OUT-ORIG-LF-REF        '~'
  7296         OUT-LF-CALC-REF        '~'
  7297         OUT-ORIG-LF-ALT-BEN    '~'
  7298         OUT-ORIG-LF-ALT-PRM    '~'
  7299         OUT-ORIG-LF-EXP-DT     '~'
  7300         OUT-ORIG-LF-DESC       '~'
  7301         OUT-ORIG-AH-BENCD      '~'
  7302         OUT-ORIG-AH-TERM       '~'
  7303         OUT-ORIG-CRIT-PER      '~'
  7304         OUT-ORIG-AH-BEN        '~'
  7305         OUT-ORIG-AH-PRM        '~'
  7306         OUT-AH-CALC-PRM        '~'
  7307         OUT-ORIG-AH-REF        '~'
  7308         OUT-AH-CALC-REF        '~'
  7309         OUT-ORIG-AH-EXP-DT     '~'
  7310         OUT-ORIG-AH-DESC       '~'
  7311         OUT-ORIG-RET-ELIM      '~'
  7312         OUT-ORIG-BEN-DAYS      '~'
  7313         OUT-ORIG-WAIT-PER      '~'
  7314         OUT-ORIG-MAX-PMTS      '~'
  7315         OUT-ORIG-SCHED-EXP-DT  '~'
  7316         OUT-ORIG-SCHED-TERM    '~'
  7317         OUT-NEW-ILNAME         '~'
  7318         OUT-NEW-IFNAME         '~'
  7319         OUT-NEW-IMINIT         '~'
  7320         OUT-NEW-IAGE           '~'
  7321         OUT-NEW-JLNAME         '~'
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page 128
* NSRASBL.cbl
  7322         OUT-NEW-JFNAME         '~'
  7323         OUT-NEW-JMINIT         '~'
  7324         OUT-NEW-JAGE           '~'
  7325         OUT-NEW-LF-BENCD       '~'
  7326         OUT-NEW-LF-TERM        '~'
  7327         OUT-NEW-LF-BEN         '~'
  7328         OUT-NEW-LF-PRM         '~'
  7329         OUT-NEW-LF-REF         '~'
  7330         OUT-NEW-LF-ALT-BEN     '~'
  7331         OUT-NEW-LF-ALT-PRM     '~'
  7332         OUT-NEW-LF-EXP-DT      '~'
  7333         OUT-NEW-LF-DESC        '~'
  7334         OUT-NEW-AH-BENCD       '~'
  7335         OUT-NEW-AH-TERM        '~'
  7336         OUT-NEW-CRIT-PER       '~'
  7337         OUT-NEW-AH-BEN         '~'
  7338         OUT-NEW-AH-PRM         '~'
  7339         OUT-NEW-AH-REF         '~'
  7340         OUT-NEW-AH-EXP-DT      '~'
  7341         OUT-NEW-AH-DESC        '~'
  7342         OUT-NEW-RET-ELIM       '~'
  7343         OUT-NEW-BEN-DAYS       '~'
  7344         OUT-NEW-WAIT-PER       '~'
  7345         OUT-NEW-MAX-PMTS       '~'
  7346         OUT-NEW-SCHED-EXP-DT   '~'
  7347         OUT-NEW-SCHED-TERM     '~'
  7348         OUT-TOT-PRM-CHG        '~'
  7349         OUT-TOT-REF-CHG        '~'
  7350         OUT-PAYEE              '~'
  7351         OUT-SIG-SW             '~'
  7352         OUT-BALLOON-IND        '~'
  7353         OUT-LEASE-IND          '~'
  7354         OUT-RESCIND            '~'
  7355         OUT-REA-CD1            '~'
  7356         OUT-REA-CD2            '~'
  7357         OUT-REA-CD3            '~'
  7358         OUT-REA-CD4            '~'
  7359         OUT-REA-CD5            '~'
  7360         OUT-REA-CD6            '~'
  7361         OUT-REA-CD7            '~'
  7362         OUT-REA-CD8            '~'
  7363         OUT-REA-CD9            '~'
  7364         OUT-REA-CD10           '~'
  7365         OUT-REA-CD11           '~'
  7366         OUT-REA-CD12           '~'
  7367         OUT-CYCLE-DT           '~'
  7368         OUT-ARCH-NO            '~'
  7369         OUT-FORM               '~'
  7370         OUT-ENC-LINE           '~'
  7371         OUT-ATTACH             '~'
  7372         OUT-STACK              '~'
  7373         OUT-STATE-NAME         '~'
  7374         OUT-PRINT-NOW          '~'
  7375         OUT-CHGBACK            '~'
  7376         OUT-CSO-PORTION        '~'
  7377         OUT-ACCT-PORTION       '~'
  7378         OUT-LETTER-TYPE        '~'
  7379         OUT-PRINT-CERTIFICATE  '~'
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page 129
* NSRASBL.cbl
  7380         OUT-INS-BIRTHDATE      '~'
  7381         OUT-JNT-BIRTHDATE      '~'
  7382         OUT-TOT-INTEREST       '~'
  7383         OUT-ORIG-TOT-PREM      '~'
  7384         OUT-ORIG-TOT-REF       '~'
  7385         OUT-CANCEL-DT          '~'
  7386         OUT-HEALTH-APP         '~'
  7387         OUT-CERTIFICATE-ID     '~'
  7388         OUT-UNDW-ID            '~'
  7389         OUT-NEW-TOT-PREM       '~'
  7390         OUT-NEW-TOT-REF        '~'
  7391         OUT-COVERAGE-IND       '~'
  7392         OUT-ORIG-COVERAGE-IND  '~'
  7393         OUT-NEW-COVERAGE-IND   '~'
  7394         OUT-LF-CMB-PREM        '~'
  7395         OUT-ORIG-LF-CMB-PREM   '~'
  7396         OUT-NEW-LF-CMB-PREM    '~'
  7397         OUT-LF-PREM-CHG        '~'
  7398         OUT-LF-ALT-PREM-CHG    '~'
  7399         OUT-LF-CMB-PREM-CHG    '~'
  7400         OUT-AH-PREM-CHG        '~'
  7401         OUT-LF-REF-CHG         '~'
  7402         OUT-AH-REF-CHG         '~'
  7403         OUT-ACCT-LF-PORTION    '~'
  7404         OUT-ACCT-ALT-LF-PORT   '~'
  7405         OUT-ACCT-CMB-LF-PORT   '~'
  7406         OUT-ACCT-AH-PORTION    '~'
  7407         OUT-CSO-LF-PORTION     '~'
  7408         OUT-CSO-ALT-LF-PORT    '~'
  7409         OUT-CSO-CMB-LF-PORT    '~'
  7410         OUT-CSO-AH-PORTION     '~'
  7411         OUT-ACCT-ORIG-LF-PORT  '~'
  7412         OUT-ACCT-ORIG-ALT-LF-PORT '~'
  7413         OUT-ACCT-ORIG-CMB-LF-PORT '~'
  7414         OUT-ACCT-ORIG-AH-PORT  '~'
  7415         OUT-ACCT-ORIG-PORTION  '~'
  7416         OUT-CSO-ORIG-LF-PORT   '~'
  7417         OUT-CSO-ORIG-ALT-LF-PORT '~'
  7418         OUT-CSO-ORIG-CMB-LF-PORT '~'
  7419         OUT-CSO-ORIG-AH-PORT   '~'
  7420         OUT-CSO-ORIG-PORTION   '~'
  7421         OUT-ACCT-NEW-LF-PORT   '~'
  7422         OUT-ACCT-NEW-ALT-LF-PORT '~'
  7423         OUT-ACCT-NEW-CMB-LF-PORT '~'
  7424         OUT-ACCT-NEW-AH-PORT   '~'
  7425         OUT-ACCT-NEW-PORTION   '~'
  7426         OUT-CSO-NEW-LF-PORT    '~'
  7427         OUT-CSO-NEW-ALT-LF-PORT '~'
  7428         OUT-CSO-NEW-CMB-LF-PORT '~'
  7429         OUT-CSO-NEW-AH-PORT    '~'
  7430         OUT-CSO-NEW-PORTION    '~'
  7431         OUT-ACCT-LF-PORT-CHG   '~'
  7432         OUT-ACCT-ALT-LF-PORT-CHG '~'
  7433         OUT-ACCT-CMB-LF-PORT-CHG '~'
  7434         OUT-ACCT-AH-PORT-CHG   '~'
  7435         OUT-ACCT-PORTION-CHG   '~'
  7436         OUT-CSO-LF-PORT-CHG    '~'
  7437         OUT-CSO-ALT-LF-PORT-CHG '~'
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page 130
* NSRASBL.cbl
  7438         OUT-CSO-CMB-LF-PORT-CHG '~'
  7439         OUT-CSO-AH-PORT-CHG    '~'
  7440         OUT-CSO-PORTION-CHG    '~'
  7441         OUT-ORIG-LF-CAN-DT     '~'
  7442         OUT-NEW-LF-CAN-DT      '~'
  7443         OUT-ORIG-AH-CAN-DT     '~'
  7444         OUT-NEW-AH-CAN-DT      '~'
  7445         OUT-ORIG-CAN-DT        '~'
  7446         OUT-NEW-CAN-DT         '~'
  7447         OUT-SCREEN-ID          '~'
  7448         OUT-NEXT-BUS-DT        '~'
  7449         OUT-VIN-NUMBER         '~'
  7450            DELIMITED BY '   ' INTO NSAS-LETTER-VARIABLES
  7451     END-STRING
  7452     .
  7453 0710-exit.
  7454     EXIT.
  7455 0720-WRITE-NSASEXTR.
  7456
  7457* EXEC CICS WRITE
  7458*       DATASET    ('NSASEXTR')
  7459*       FROM       (NSAS-EXTRACT-RECORD)
  7460*       RIDFLD     (NSAS-CONTROL-PRIMARY)
  7461*       RESP       (WS-RESPONSE)
  7462*    END-EXEC
  7463     MOVE LENGTH OF
  7464      NSAS-EXTRACT-RECORD
  7465       TO DFHEIV11
  7466     MOVE 'NSASEXTR' TO DFHEIV1
  7467*    MOVE '&$ L                  ''  N#00007294' TO DFHEIV0
  7468     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7469     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7470     MOVE X'204E233030303037323934' TO DFHEIV0(25:11)
  7471     CALL 'kxdfhei1' USING DFHEIV0,
  7472           DFHEIV1,
  7473           NSAS-EXTRACT-RECORD,
  7474           DFHEIV11,
  7475           NSAS-CONTROL-PRIMARY,
  7476           DFHEIV99,
  7477           DFHEIV99
  7478     MOVE EIBRESP  TO WS-RESPONSE
  7479     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7480     IF NOT RESP-NORMAL
  7481        display ' bad write nsasextr ' ws-response
  7482        SET BL-FAIL TO TRUE
  7483     END-IF
  7484     .
  7485 0720-EXIT.
  7486     EXIT.
  7487 0800-init-out-data.
  7488     MOVE ZEROS                  TO OUT-IAGE
  7489                                    OUT-JAGE
  7490                                    OUT-LOAN-APR
  7491                                    OUT-LOAN-TERM
  7492                                    OUT-EXT-DAYS
  7493                                    OUT-LF-TERM
  7494                                    OUT-AH-TERM
  7495                                    OUT-LF-DEV-PCT
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page 131
* NSRASBL.cbl
  7496                                    OUT-AH-DEV-PCT
  7497                                    OUT-LF-BEN
  7498                                    OUT-AH-BEN
  7499                                    OUT-CRIT-PER
  7500                                    OUT-MAX-PMTS
  7501                                    OUT-SCHED-TERM
  7502                                    OUT-ORIG-IAGE
  7503                                    OUT-ORIG-JAGE
  7504                                    OUT-NEW-IAGE
  7505                                    OUT-NEW-JAGE
  7506                                    OUT-ORIG-LF-TERM
  7507                                    OUT-ORIG-AH-TERM
  7508                                    OUT-NEW-LF-TERM
  7509                                    OUT-NEW-AH-TERM
  7510                                    OUT-ORIG-CRIT-PER
  7511                                    OUT-ORIG-MAX-PMTS
  7512                                    OUT-ORIG-SCHED-TERM
  7513                                    OUT-NEW-SCHED-TERM
  7514                                    OUT-NEW-CRIT-PER
  7515                                    OUT-NEW-MAX-PMTS
  7516                                    OUT-CSO-PORTION
  7517                                    OUT-CSO-LF-PORTION
  7518                                    OUT-CSO-ALT-LF-PORT
  7519                                    OUT-CSO-CMB-LF-PORT
  7520                                    OUT-CSO-AH-PORTION
  7521                                    OUT-ACCT-PORTION
  7522                                    OUT-ACCT-LF-PORTION
  7523                                    OUT-ACCT-ALT-LF-PORT
  7524                                    OUT-ACCT-CMB-LF-PORT
  7525                                    OUT-ACCT-AH-PORTION
  7526                                    OUT-LF-PREM-CHG
  7527                                    OUT-LF-ALT-PREM-CHG
  7528                                    OUT-LF-CMB-PREM-CHG
  7529                                    OUT-AH-PREM-CHG
  7530                                    OUT-LF-REF-CHG
  7531                                    OUT-AH-REF-CHG
  7532     .
  7533 0800-exit.
  7534     exit.
  7535 1000-BUILD-ERARCH.
  7536* DATA SOURCE MEANINGS  BL-DATA-SRCE
  7537*    1) FROM ACCT MAINT
  7538*    2) FROM CERT UPDATE
  7539*    3) FROM COMP MAINT
  7540*    4) FROM REVIEW AND CORRECTIONS
  7541******************************************************************
  7542     MOVE 'LA'                   TO LETTER-ARCHIVE
  7543     MOVE BL-ARCHIVE-NO          TO LA-ARCHIVE-NO
  7544                                    LA-ARCHIVE-NO-A2
  7545                                    LA-ARCHIVE-NO-A3
  7546                                    LA-ARCHIVE-NO-A4
  7547                                    LA-ARCHIVE-NO-A5
  7548                                    LA-ARCHIVE-NO-A6
  7549     MOVE WS-COMPANY-CD          TO LA-COMPANY-CD
  7550                                    LA-COMPANY-CD-A2
  7551                                    LA-COMPANY-CD-A3
  7552                                    LA-COMPANY-CD-A4
  7553                                    LA-COMPANY-CD-A5
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page 132
* NSRASBL.cbl
  7554                                    LA-COMPANY-CD-A6
  7555     MOVE BL-CARRIER             TO LA-CARRIER-A2
  7556                                    LA-CARRIER-A3
  7557                                    LA-CARRIER-A4
  7558                                    LA-CARRIER-A5
  7559     MOVE BL-GROUP               TO LA-GROUPING-A2
  7560                                    LA-GROUPING-A3
  7561                                    LA-GROUPING-A4
  7562                                    LA-GROUPING-A5
  7563     MOVE BL-ACCOUNT             TO LA-ACCOUNT-A2
  7564                                    LA-ACCOUNT-A3
  7565                                    LA-ACCOUNT-A4
  7566                                    LA-ACCOUNT-A5
  7567     MOVE BL-STATE               TO LA-STATE-A2
  7568                                    LA-STATE-A3
  7569                                    LA-STATE-A4
  7570                                    LA-STATE-A5
  7571     IF BL-DATA-SRCE = '2' OR '4'
  7572        MOVE WS-ELCERT-EFF-DT    TO LA-EFFECT-DATE-A2
  7573        MOVE BL-CERT-NO          TO LA-CERT-NO-A2
  7574     ELSE
  7575        MOVE LOW-VALUES          TO LA-EFFECT-DATE-A2
  7576     END-IF
  7577     IF BL-DATA-SRCE = '4'
  7578        MOVE BL-BATCH-NO         TO LA-ENTRY-A6
  7579     END-IF
  7580     MOVE BL-PROC-ID             TO LA-PROCESSOR-CD
  7581                                    LA-LAST-UPDATED-BY
  7582     MOVE LOW-VALUES             TO LA-LAST-RESENT-PRINT-DATE
  7583                                    LA-INITIAL-PRINT-DATE
  7584                                    LA-SENT-DATE
  7585                                    LA-REPLY-DATE
  7586                                    LA-RESEND-DATE
  7587                                    LA-FOLLOW-UP-DATE
  7588     MOVE 'A'                    TO LA-STATUS
  7589     MOVE W-NUMBER-OF-COPIES     TO LA-NO-OF-COPIES
  7590     MOVE W-FORM-TO-RESEND       TO LA-RESEND-LETR
  7591     IF W-DAYS-TO-RESEND NOT NUMERIC
  7592        MOVE ZEROS               TO W-DAYS-TO-RESEND
  7593     END-IF
  7594     IF W-DAYS-TO-RESEND > ZEROS
  7595        MOVE SAVE-BIN-NEXT-BUS-DT TO DC-BIN-DATE-1
  7596        MOVE W-DAYS-TO-RESEND  TO DC-ELAPSED-DAYS
  7597        MOVE ZEROS               TO DC-ELAPSED-MONTHS
  7598        MOVE '6'                 TO DC-OPTION-CODE
  7599        PERFORM 9700-DATE-LINK THRU 9700-EXIT
  7600        IF NO-CONVERSION-ERROR
  7601           MOVE DC-BIN-DATE-2    TO LA-RESEND-DATE
  7602        END-IF
  7603     END-IF
  7604     IF W-DAYS-TO-FOLLOW-UP >= ZEROS
  7605        MOVE SAVE-BIN-DATE       TO DC-BIN-DATE-1
  7606        MOVE W-DAYS-TO-FOLLOW-UP TO DC-ELAPSED-DAYS
  7607        MOVE ZEROS               TO DC-ELAPSED-MONTHS
  7608        MOVE '6'                 TO DC-OPTION-CODE
  7609        PERFORM 9700-DATE-LINK THRU 9700-EXIT
  7610        IF NO-CONVERSION-ERROR
  7611           MOVE DC-BIN-DATE-2    TO LA-FOLLOW-UP-DATE
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page 133
* NSRASBL.cbl
  7612        END-IF
  7613     END-IF
  7614
  7615     MOVE W-AUTO-CLOSE-IND       TO LA-FINAL-ACT-IND
  7616     MOVE BL-LETTER-ID           TO LA-FORM-A3
  7617     MOVE BL-DATA-SRCE           TO LA-DATA-SOURCE
  7618     MOVE BL-WRITE-ERARCH        TO LA-ARCHIVE-STATUS
  7619     IF BL-ENDT-ARCH-NO > ZEROS
  7620        MOVE BL-ENDT-ARCH-NO     TO LA-ENDT-ARCH-NO
  7621     ELSE
  7622        MOVE BL-ARCHIVE-NO       TO LA-ENDT-ARCH-NO
  7623     END-IF
  7624     MOVE SAVE-BIN-DATE          TO LA-CREATION-DATE
  7625                                    LA-LAST-MAINT-DATE
  7626     MOVE ZEROS                  TO LA-NUMBER-LABEL-LINES
  7627                                    LA-NO-OF-TEXT-RECORDS
  7628     MOVE EIBTIME                TO LA-LAST-MAINT-TIME
  7629
  7630* EXEC CICS WRITE
  7631*         DATASET   ('ERARCH')
  7632*         FROM      (LETTER-ARCHIVE)
  7633*         RIDFLD    (LA-CONTROL-PRIMARY)
  7634*         RESP      (WS-RESPONSE)
  7635*    END-EXEC
  7636     MOVE LENGTH OF
  7637      LETTER-ARCHIVE
  7638       TO DFHEIV11
  7639     MOVE 'ERARCH' TO DFHEIV1
  7640*    MOVE '&$ L                  ''  N#00007449' TO DFHEIV0
  7641     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7642     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7643     MOVE X'204E233030303037343439' TO DFHEIV0(25:11)
  7644     CALL 'kxdfhei1' USING DFHEIV0,
  7645           DFHEIV1,
  7646           LETTER-ARCHIVE,
  7647           DFHEIV11,
  7648           LA-CONTROL-PRIMARY,
  7649           DFHEIV99,
  7650           DFHEIV99
  7651     MOVE EIBRESP  TO WS-RESPONSE
  7652     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7653     IF NOT RESP-NORMAL
  7654        DISPLAY ' BAD WRITE ON ERARCH ' WS-RESPONSE ' '
  7655        la-archive-no
  7656        SET BL-FAIL TO TRUE
  7657     END-IF
  7658     .
  7659 1000-EXIT.
  7660     EXIT.
  7661 1025-GET-CSR-INFO.
  7662     MOVE WS-CSR-ID              TO OUT-CSR-CODE
  7663                                    OUT-CSR-TITLE
  7664                                    OUT-PROC-TITLE
  7665                                    OUT-UNDW-ID
  7666     MOVE BL-COMP-ID             TO WS-ELCNTL-KEY
  7667     MOVE '2'                    TO WS-ELCNTL-REC-TYPE
  7668     MOVE WS-CSR-ID              TO WS-ELCNTL-GENL
  7669     MOVE +0                     TO WS-ELCNTL-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page 134
* NSRASBL.cbl
  7670
  7671* EXEC CICS READ
  7672*       INTO    (CONTROL-FILE)
  7673*       DATASET ('ELCNTL')
  7674*       RIDFLD  (WS-ELCNTL-KEY)
  7675*       RESP    (WS-RESPONSE)
  7676*    END-EXEC
  7677     MOVE LENGTH OF
  7678      CONTROL-FILE
  7679       TO DFHEIV11
  7680     MOVE 'ELCNTL' TO DFHEIV1
  7681*    MOVE '&"IL       E          (  N#00007472' TO DFHEIV0
  7682     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  7683     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7684     MOVE X'204E233030303037343732' TO DFHEIV0(25:11)
  7685     CALL 'kxdfhei1' USING DFHEIV0,
  7686           DFHEIV1,
  7687           CONTROL-FILE,
  7688           DFHEIV11,
  7689           WS-ELCNTL-KEY,
  7690           DFHEIV99,
  7691           DFHEIV99,
  7692           DFHEIV99
  7693     MOVE EIBRESP  TO WS-RESPONSE
  7694     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7695     IF RESP-NORMAL
  7696        MOVE CF-PROCESSOR-NAME   TO OUT-CSR-NAME
  7697                                    OUT-PROC-NAME
  7698*       MOVE CF-PROCESSOR-TITLE  TO OUT-CSR-TITLE
  7699*                                   OUT-PROC-TITLE
  7700     END-IF
  7701     IF BL-PROC-ID NOT = PB-CSR-ID
  7702        MOVE BL-COMP-ID          TO WS-ELCNTL-KEY
  7703        MOVE '2'                 TO WS-ELCNTL-REC-TYPE
  7704        MOVE BL-PROC-ID          TO WS-ELCNTL-GENL
  7705                                    OUT-PROC-TITLE
  7706        MOVE +0                  TO WS-ELCNTL-SEQ-NO
  7707
  7708* EXEC CICS READ
  7709*          INTO    (CONTROL-FILE)
  7710*          DATASET ('ELCNTL')
  7711*          RIDFLD  (WS-ELCNTL-KEY)
  7712*          RESP    (WS-RESPONSE)
  7713*       END-EXEC
  7714     MOVE LENGTH OF
  7715      CONTROL-FILE
  7716       TO DFHEIV11
  7717     MOVE 'ELCNTL' TO DFHEIV1
  7718*    MOVE '&"IL       E          (  N#00007490' TO DFHEIV0
  7719     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  7720     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7721     MOVE X'204E233030303037343930' TO DFHEIV0(25:11)
  7722     CALL 'kxdfhei1' USING DFHEIV0,
  7723           DFHEIV1,
  7724           CONTROL-FILE,
  7725           DFHEIV11,
  7726           WS-ELCNTL-KEY,
  7727           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page 135
* NSRASBL.cbl
  7728           DFHEIV99,
  7729           DFHEIV99
  7730     MOVE EIBRESP  TO WS-RESPONSE
  7731     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7732        IF RESP-NORMAL
  7733           MOVE CF-PROCESSOR-NAME   TO OUT-PROC-NAME
  7734*          MOVE CF-PROCESSOR-TITLE  TO OUT-PROC-TITLE
  7735        END-IF
  7736     END-IF
  7737     .
  7738 1025-EXIT.
  7739     EXIT.
  7740 1050-GET-ERMAIL.
  7741     MOVE CM-CONTROL-PRIMARY     TO WS-ERMAIL-KEY
  7742
  7743* EXEC CICS READ
  7744*         DATASET    ('ERMAIL')
  7745*         INTO       (MAILING-DATA)
  7746*         RIDFLD     (WS-ERMAIL-KEY)
  7747*         RESP       (WS-RESPONSE)
  7748*    END-EXEC
  7749     MOVE LENGTH OF
  7750      MAILING-DATA
  7751       TO DFHEIV11
  7752     MOVE 'ERMAIL' TO DFHEIV1
  7753*    MOVE '&"IL       E          (  N#00007506' TO DFHEIV0
  7754     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  7755     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7756     MOVE X'204E233030303037353036' TO DFHEIV0(25:11)
  7757     CALL 'kxdfhei1' USING DFHEIV0,
  7758           DFHEIV1,
  7759           MAILING-DATA,
  7760           DFHEIV11,
  7761           WS-ERMAIL-KEY,
  7762           DFHEIV99,
  7763           DFHEIV99,
  7764           DFHEIV99
  7765     MOVE EIBRESP  TO WS-RESPONSE
  7766     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7767     IF RESP-NORMAL
  7768        MOVE MA-ADDRESS-LINE-1   TO OUT-INS-ADDR1
  7769        MOVE MA-ADDRESS-LINE-2   TO OUT-INS-ADDR2
  7770        MOVE MA-CITY             TO OUT-INS-CITY
  7771        MOVE MA-ADDR-STATE       TO OUT-INS-STATE
  7772        MOVE MA-ZIP              TO OUT-INS-ZIP
  7773        MOVE MA-CRED-BENE-NAME   TO OUT-BENE-NAME
  7774        MOVE MA-CRED-BENE-ADDR   TO OUT-BENE-ADDR1
  7775        MOVE MA-CRED-BENE-ADDR2  TO OUT-BENE-ADDR2
  7776        MOVE MA-CRED-BENE-CITY   TO OUT-BENE-CITY
  7777        MOVE MA-CRED-BENE-STATE  TO OUT-BENE-STATE
  7778        MOVE MA-CRED-BENE-ZIP    TO OUT-BENE-ZIP
  7779        IF MA-INSURED-BIRTH-DT NOT = LOW-VALUES AND SPACES
  7780           MOVE MA-INSURED-BIRTH-DT
  7781                                 TO DC-BIN-DATE-1
  7782           MOVE ' '              TO DC-OPTION-CODE
  7783           PERFORM 9700-DATE-LINK THRU 9700-EXIT
  7784           IF NO-CONVERSION-ERROR
  7785              STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page 136
* NSRASBL.cbl
  7786                DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  7787                INTO OUT-INS-BIRTHDATE
  7788              END-STRING
  7789           END-IF
  7790        END-IF
  7791        IF MA-JOINT-BIRTH-DT NOT = LOW-VALUES AND SPACES
  7792           MOVE MA-JOINT-BIRTH-DT
  7793                                 TO DC-BIN-DATE-1
  7794           MOVE ' '              TO DC-OPTION-CODE
  7795           PERFORM 9700-DATE-LINK THRU 9700-EXIT
  7796           IF NO-CONVERSION-ERROR
  7797              STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  7798                DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  7799                INTO OUT-JNT-BIRTHDATE
  7800              END-STRING
  7801           END-IF
  7802        END-IF
  7803     END-IF
  7804     .
  7805 1050-EXIT.
  7806     EXIT.
  7807 1100-GET-ELCERT.
  7808
  7809* EXEC CICS READ
  7810*         DATASET    ('ELCERT')
  7811*         INTO       (CERTIFICATE-MASTER)
  7812*         RIDFLD     (WS-ELCERT-KEY)
  7813*         RESP       (WS-RESPONSE)
  7814*    END-EXEC.
  7815     MOVE LENGTH OF
  7816      CERTIFICATE-MASTER
  7817       TO DFHEIV11
  7818     MOVE 'ELCERT' TO DFHEIV1
  7819*    MOVE '&"IL       E          (  N#00007553' TO DFHEIV0
  7820     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  7821     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7822     MOVE X'204E233030303037353533' TO DFHEIV0(25:11)
  7823     CALL 'kxdfhei1' USING DFHEIV0,
  7824           DFHEIV1,
  7825           CERTIFICATE-MASTER,
  7826           DFHEIV11,
  7827           WS-ELCERT-KEY,
  7828           DFHEIV99,
  7829           DFHEIV99,
  7830           DFHEIV99
  7831     MOVE EIBRESP  TO WS-RESPONSE
  7832     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7833
  7834     IF RESP-NORMAL
  7835        SET CERT-FOUND TO TRUE
  7836        PERFORM 1110-BUILD-CERT  THRU 1110-EXIT
  7837        PERFORM 1050-GET-ERMAIL  THRU 1050-EXIT
  7838     END-IF
  7839     .
  7840 1100-EXIT.
  7841     EXIT.
  7842 1110-BUILD-CERT.
  7843     PERFORM 1300-DETERMINE-COMM THRU 1300-EXIT
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page 137
* NSRASBL.cbl
  7844     MOVE SPACES                 TO OUT-COVERAGE-IND
  7845     MOVE SPACES                 TO OUT-ORIG-COVERAGE-IND
  7846     MOVE SPACES                 TO OUT-NEW-COVERAGE-IND
  7847     MOVE CM-CARRIER             TO OUT-CARRIER
  7848     MOVE CM-GROUPING            TO OUT-GROUPING
  7849     MOVE CM-STATE               TO OUT-STATE
  7850     MOVE CM-ACCOUNT             TO OUT-ACCOUNT
  7851     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1
  7852     MOVE ' '                    TO DC-OPTION-CODE
  7853     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  7854     IF NO-CONVERSION-ERROR
  7855        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  7856           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  7857              INTO OUT-CERT-EFF-DT
  7858        END-STRING
  7859     END-IF
  7860     MOVE CM-CERT-NO             TO OUT-CERT-NO
  7861     MOVE CM-INSURED-LAST-NAME   TO OUT-ILNAME
  7862                                    OUT-ORIG-ILNAME
  7863     MOVE CM-INSURED-INITIAL1    TO OUT-IFINIT
  7864     MOVE CM-INSURED-INITIAL2    TO OUT-IMINIT
  7865                                    OUT-ORIG-MINIT
  7866     IF (CM-SSN-STATE = CM-STATE)
  7867        AND (CM-SSN-ACCOUNT = CM-ACCOUNT (5:6))
  7868        MOVE SPACES              TO OUT-SOC-SEC-NO
  7869     ELSE
  7870        MOVE CM-SOC-SEC-NO       TO OUT-SOC-SEC-NO
  7871     END-IF
  7872     IF (CM-MEMB-STATE = CM-STATE)
  7873        AND (CM-MEMB-ACCOUNT = CM-ACCOUNT (5:6))
  7874        MOVE SPACES              TO OUT-MEMBER-NO
  7875     ELSE
  7876        MOVE CM-MEMBER-NO        TO OUT-MEMBER-NO
  7877     END-IF
  7878     MOVE CM-INSURED-FIRST-NAME  TO OUT-IFNAME
  7879                                    OUT-ORIG-IFNAME
  7880     MOVE CM-INSURED-ISSUE-AGE   TO OUT-IAGE
  7881                                    OUT-ORIG-IAGE
  7882     MOVE CM-INSURED-SEX         TO OUT-ISEX
  7883     MOVE CM-INSURED-JOINT-AGE   TO OUT-JAGE
  7884                                    OUT-ORIG-JAGE
  7885     MOVE CM-JT-LAST-NAME        TO OUT-JLNAME
  7886                                    OUT-ORIG-JLNAME
  7887     MOVE CM-JT-FIRST-NAME       TO OUT-JFNAME
  7888                                    OUT-ORIG-JFNAME
  7889     MOVE CM-JT-INITIAL          TO OUT-JMINIT
  7890                                    OUT-ORIG-JMINIT
  7891     MOVE CM-LF-BENEFIT-CD       TO OUT-LF-BENCD
  7892                                    OUT-ORIG-LF-BENCD
  7893     MOVE CM-LF-ORIG-TERM        TO OUT-LF-TERM
  7894                                    OUT-ORIG-LF-TERM
  7895     MOVE CM-LF-DEV-CODE         TO OUT-LF-DEV-CD
  7896     IF CM-LF-DEV-PCT NOT NUMERIC
  7897        MOVE ZEROS               TO CM-LF-DEV-PCT
  7898     END-IF
  7899     MOVE CM-LF-DEV-PCT          TO OUT-LF-DEV-PCT
  7900     PERFORM 1160-READ-CERT-TRAILER THRU 1160-EXIT
  7901     IF NOT CERT-TRL-REC-NOT-FOUND
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page 138
* NSRASBL.cbl
  7902         IF CS-INS-AGE-DEFAULT-FLAG = 'Y'
  7903             MOVE ZERO           TO OUT-IAGE
  7904                                    OUT-ORIG-IAGE
  7905         END-IF
  7906         IF CS-JNT-AGE-DEFAULT-FLAG = 'Y'
  7907             MOVE ZERO           TO OUT-JAGE
  7908                                    OUT-ORIG-JAGE
  7909         END-IF
  7910         MOVE CS-VIN-NUMBER      TO OUT-VIN-NUMBER
  7911     END-IF
  7912
  7913     IF BL-DATA-SRCE = '4' AND PROCESS-CANCEL
  7914        IF (PB-C-LF-CANCEL-DT = LOW-VALUES OR SPACES) AND
  7915          ((CM-LF-CANCEL-DT NOT = LOW-VALUES AND SPACES) OR
  7916           (CM-LF-DEATH-DT NOT = LOW-VALUES AND SPACES))
  7917             MOVE SPACES          TO OUT-LF-BENCD
  7918                                     WS-LF-BENCD
  7919                                     OUT-LF-CAN-DT
  7920             MOVE ZEROS           TO OUT-LF-TERM
  7921                                     OUT-LF-BEN
  7922                                     OUT-LF-PRM
  7923                                     OUT-LF-ALT-BEN
  7924                                     OUT-LF-ALT-PRM
  7925                                     OUT-LF-COMM-PCT
  7926                                     OUT-LF-NSP
  7927                                     OUT-LF-REM-BEN
  7928                                     WS-WORK-LF-PREM
  7929                                     WS-WORK-ALT-LF-PREM
  7930                                     WS-WORK-CMB-LF-PREM
  7931                                     OUT-LF-REF
  7932                                     OUT-ORIG-LF-REF
  7933                                     WS-WORK-LF-REF
  7934             MOVE LOW-VALUES      TO OUT-LF-EXP-DT
  7935             GO TO 1100-LF-CONT
  7936        END-IF
  7937     END-IF
  7938
  7939     IF BL-DATA-SRCE = '2' AND BL-FUNC = 'CrtVerif'
  7940        IF (CM-LF-CANCEL-DT NOT = LOW-VALUES AND SPACES)
  7941             MOVE SPACES          TO OUT-LF-BENCD
  7942                                     WS-LF-BENCD
  7943                                     OUT-LF-CAN-DT
  7944             MOVE ZEROS           TO OUT-LF-TERM
  7945                                     OUT-LF-BEN
  7946                                     OUT-LF-PRM
  7947                                     OUT-LF-ALT-BEN
  7948                                     OUT-LF-ALT-PRM
  7949                                     OUT-LF-COMM-PCT
  7950                                     OUT-LF-NSP
  7951                                     OUT-LF-REM-BEN
  7952                                     WS-WORK-LF-PREM
  7953                                     WS-WORK-ALT-LF-PREM
  7954                                     WS-WORK-CMB-LF-PREM
  7955                                     OUT-LF-REF
  7956                                     OUT-ORIG-LF-REF
  7957                                     WS-WORK-LF-REF
  7958             MOVE LOW-VALUES      TO OUT-LF-EXP-DT
  7959             GO TO 1100-LF-CONT
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page 139
* NSRASBL.cbl
  7960        END-IF
  7961     END-IF
  7962     IF CM-LF-BENEFIT-CD NOT = '  ' AND '00'
  7963         MOVE 'LIFE'             TO OUT-COVERAGE-IND
  7964                                    OUT-ORIG-COVERAGE-IND
  7965     END-IF
  7966
  7967     MOVE CM-LF-BENEFIT-CD       TO WS-LF-BENCD
  7968     MOVE CM-LF-BENEFIT-AMT      TO OUT-LF-BEN
  7969                                    OUT-ORIG-LF-BEN
  7970     IF CM-LF-BENEFIT-AMT = 999999999.99
  7971        MOVE SPACES              TO OUT-ORIG-LF-BEN-A
  7972     END-IF
  7973     MOVE CM-LF-PREMIUM-AMT      TO OUT-LF-PRM
  7974                                    OUT-ORIG-LF-PRM
  7975                                    WS-WORK-LF-PREM
  7976     IF CM-LF-PREMIUM-AMT = .01
  7977         MOVE SPACES             TO OUT-ORIG-LF-PRM-A
  7978     END-IF
  7979     IF CM-LF-ALT-BENEFIT-AMT NOT NUMERIC
  7980        MOVE ZEROS               TO CM-LF-ALT-BENEFIT-AMT
  7981     END-IF
  7982     MOVE CM-LF-ALT-BENEFIT-AMT  TO OUT-LF-ALT-BEN
  7983                                    OUT-ORIG-LF-ALT-BEN
  7984     IF CM-LF-ALT-BENEFIT-AMT = 999999999.99
  7985        MOVE SPACES              TO OUT-ORIG-LF-ALT-BEN-A
  7986     END-IF
  7987     IF CM-LF-ALT-PREMIUM-AMT NOT NUMERIC
  7988        MOVE ZEROS               TO CM-LF-ALT-PREMIUM-AMT
  7989     END-IF
  7990     MOVE CM-LF-ALT-PREMIUM-AMT  TO OUT-LF-ALT-PRM
  7991                                    OUT-ORIG-LF-ALT-PRM
  7992                                    WS-WORK-ALT-LF-PREM
  7993     IF CM-LF-ALT-PREMIUM-AMT = .01
  7994         MOVE SPACES             TO OUT-ORIG-LF-ALT-PRM-A
  7995     END-IF
  7996     COMPUTE WS-WRK-AMOUNT = CM-LF-PREMIUM-AMT +
  7997                             CM-LF-ALT-PREMIUM-AMT
  7998     MOVE WS-WRK-AMOUNT          TO OUT-LF-CMB-PREM
  7999                                 OUT-ORIG-LF-CMB-PREM
  8000                                 WS-WORK-CMB-LF-PREM
  8001     IF CM-LF-NSP-PREMIUM-AMT NOT NUMERIC
  8002        MOVE ZEROS               TO CM-LF-NSP-PREMIUM-AMT
  8003     END-IF
  8004     MOVE CM-LF-NSP-PREMIUM-AMT  TO OUT-LF-NSP
  8005     MOVE CM-LF-REMAINING-AMT    TO OUT-LF-REM-BEN
  8006     MOVE CM-LF-ITD-CANCEL-AMT   TO OUT-LF-REF
  8007                                    OUT-ORIG-LF-REF
  8008                                    WS-WORK-LF-REF
  8009     IF CM-LF-DEATH-CLAIM-APPLIED
  8010        AND (PB-C-LF-CANCEL-DT NOT = LOW-VALUES OR SPACES)
  8011            MOVE PB-C-LF-CANCEL-AMT TO OUT-LF-REF
  8012                                    OUT-ORIG-LF-REF
  8013                                    WS-WORK-LF-REF
  8014     END-IF
  8015     MOVE CM-LF-CANCEL-DT        TO DC-BIN-DATE-1
  8016     MOVE ' '                    TO DC-OPTION-CODE
  8017     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page 140
* NSRASBL.cbl
  8018     IF NO-CONVERSION-ERROR
  8019        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  8020           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  8021              INTO OUT-LF-CAN-DT
  8022        END-STRING
  8023     END-IF
  8024
  8025     IF CM-LF-CANCEL-DT NOT = LOW-VALUES AND SPACES
  8026         MOVE ZEROS          TO WS-WORK-LF-PREM
  8027                                WS-WORK-ALT-LF-PREM
  8028                                WS-WORK-CMB-LF-PREM
  8029     END-IF
  8030
  8031      .
  8032 1100-LF-CONT.
  8033
  8034     MOVE CM-LF-ITD-DEATH-AMT    TO OUT-LF-DTH
  8035     IF CM-LF-PREMIUM-RATE NOT NUMERIC
  8036        MOVE ZEROS               TO CM-LF-PREMIUM-RATE
  8037     END-IF
  8038     MOVE CM-LF-PREMIUM-RATE     TO OUT-LF-RATE
  8039     IF CM-LF-ALT-PREMIUM-RATE NOT NUMERIC
  8040        MOVE ZEROS               TO CM-LF-ALT-PREMIUM-RATE
  8041     END-IF
  8042     MOVE CM-LF-ALT-PREMIUM-RATE TO OUT-LF-ALT-RATE
  8043     IF BL-DATA-SRCE = '4' AND PROCESS-CANCEL
  8044        IF (PB-C-AH-CANCEL-DT = LOW-VALUES OR SPACES) AND
  8045          (CM-AH-CANCEL-DT NOT = LOW-VALUES AND SPACES)
  8046              MOVE SPACES              TO OUT-AH-BENCD
  8047                                          WS-AH-BENCD
  8048                                          OUT-AH-CAN-DT
  8049              MOVE ZEROS               TO OUT-AH-TERM
  8050                                          OUT-AH-BEN
  8051                                          OUT-AH-PRM
  8052                                          OUT-AH-NSP
  8053                                          OUT-AH-COMM-PCT
  8054                                          OUT-CRIT-PER
  8055                                          WS-WORK-AH-PREM
  8056                                          OUT-AH-REF
  8057                                          OUT-ORIG-AH-REF
  8058                                          WS-WORK-AH-REF
  8059              MOVE SPACES              TO OUT-MAX-PMTS-A
  8060                                          OUT-WAIT-PER
  8061                                          OUT-RET-ELIM
  8062                                          OUT-AH-DESC
  8063                                          OUT-BEN-DAYS
  8064              MOVE LOW-VALUES          TO OUT-AH-EXP-DT
  8065             GO TO 1100-AH-CONT
  8066        END-IF
  8067     END-IF
  8068
  8069     IF BL-DATA-SRCE = '2' AND BL-FUNC = 'CrtVerif'
  8070        IF (CM-AH-CANCEL-DT NOT = LOW-VALUES AND SPACES)
  8071              MOVE SPACES              TO OUT-AH-BENCD
  8072                                          WS-AH-BENCD
  8073                                          OUT-AH-CAN-DT
  8074              MOVE ZEROS               TO OUT-AH-TERM
  8075                                          OUT-AH-BEN
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page 141
* NSRASBL.cbl
  8076                                          OUT-AH-PRM
  8077                                          OUT-AH-NSP
  8078                                          OUT-AH-COMM-PCT
  8079                                          OUT-CRIT-PER
  8080                                          WS-WORK-AH-PREM
  8081                                          OUT-AH-REF
  8082                                          OUT-ORIG-AH-REF
  8083                                          WS-WORK-AH-REF
  8084              MOVE SPACES              TO OUT-MAX-PMTS-A
  8085                                          OUT-WAIT-PER
  8086                                          OUT-RET-ELIM
  8087                                          OUT-AH-DESC
  8088                                          OUT-BEN-DAYS
  8089              MOVE LOW-VALUES          TO OUT-AH-EXP-DT
  8090             GO TO 1100-AH-CONT
  8091        END-IF
  8092     END-IF
  8093     MOVE CM-AH-BENEFIT-CD       TO WS-AH-BENCD
  8094     MOVE CM-AH-BENEFIT-CD       TO OUT-AH-BENCD
  8095                                    OUT-ORIG-AH-BENCD
  8096     IF CM-AH-BENEFIT-CD NOT = '  ' AND '00'
  8097        COMPUTE OUT-AH-TOT-BEN = CM-AH-ORIG-TERM *
  8098           CM-AH-BENEFIT-AMT
  8099        IF OUT-COVERAGE-IND = 'LIFE'
  8100            MOVE 'BOTH'          TO OUT-COVERAGE-IND
  8101                                    OUT-ORIG-COVERAGE-IND
  8102        ELSE
  8103            MOVE 'AH  '          TO OUT-COVERAGE-IND
  8104                                    OUT-ORIG-COVERAGE-IND
  8105        END-IF
  8106     ELSE
  8107        MOVE ZEROS               TO OUT-AH-TOT-BEN
  8108     END-IF
  8109     MOVE CM-AH-ORIG-TERM        TO OUT-AH-TERM
  8110                                    OUT-ORIG-AH-TERM
  8111     MOVE CM-AH-CRITICAL-PERIOD  TO OUT-CRIT-PER
  8112                                    OUT-ORIG-CRIT-PER
  8113                                    OUT-MAX-PMTS
  8114                                    OUT-ORIG-MAX-PMTS
  8115     IF CM-AH-BENEFIT-CD EQUAL '00' OR SPACES
  8116         MOVE SPACES             TO OUT-MAX-PMTS-A
  8117     END-IF
  8118     MOVE CM-AH-DEV-CODE         TO OUT-AH-DEV-CD
  8119     IF CM-AH-DEV-PCT NOT NUMERIC
  8120        MOVE ZEROS               TO CM-AH-DEV-PCT
  8121     END-IF
  8122     MOVE CM-AH-DEV-PCT          TO OUT-AH-DEV-PCT
  8123     MOVE CM-AH-BENEFIT-AMT      TO OUT-AH-BEN
  8124                                    OUT-ORIG-AH-BEN
  8125     IF CM-AH-BENEFIT-AMT = 9999999.99
  8126        MOVE SPACES              TO OUT-ORIG-AH-BEN-A
  8127     END-IF
  8128     MOVE CM-AH-PREMIUM-AMT      TO OUT-AH-PRM
  8129                                    OUT-ORIG-AH-PRM
  8130                                    WS-WORK-AH-PREM
  8131     IF CM-AH-PREMIUM-AMT = .01
  8132         MOVE SPACES             TO OUT-ORIG-AH-PRM-A
  8133     END-IF
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page 142
* NSRASBL.cbl
  8134     MOVE CM-AH-NSP-PREMIUM-AMT  TO OUT-AH-NSP
  8135     MOVE CM-AH-ITD-CANCEL-AMT   TO OUT-AH-REF
  8136                                    OUT-ORIG-AH-REF
  8137                                    WS-WORK-AH-REF
  8138     IF CM-AH-DEATH-CLAIM-APPLIED
  8139        AND (PB-C-AH-CANCEL-DT NOT = LOW-VALUES OR SPACES)
  8140            MOVE PB-C-AH-CANCEL-AMT TO OUT-AH-REF
  8141                                    OUT-ORIG-AH-REF
  8142                                    WS-WORK-AH-REF
  8143     END-IF
  8144     MOVE CM-AH-CANCEL-DT        TO DC-BIN-DATE-1
  8145     MOVE ' '                    TO DC-OPTION-CODE
  8146     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  8147     IF NO-CONVERSION-ERROR
  8148        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  8149           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  8150              INTO OUT-AH-CAN-DT
  8151        END-STRING
  8152     END-IF
  8153
  8154     IF CM-AH-CANCEL-DT NOT = LOW-VALUES AND SPACES
  8155         MOVE ZEROS          TO WS-WORK-AH-PREM
  8156     END-IF
  8157
  8158      .
  8159 1100-AH-CONT.
  8160
  8161     MOVE CM-AH-ITD-AH-PMT       TO OUT-AH-CLM
  8162     MOVE CM-AH-PAID-THRU-DT     TO DC-BIN-DATE-1
  8163     MOVE ' '                    TO DC-OPTION-CODE
  8164     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  8165     IF NO-CONVERSION-ERROR
  8166        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  8167           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  8168              INTO OUT-AH-PDTHRU-DT
  8169        END-STRING
  8170     END-IF
  8171     IF CM-AH-PREMIUM-RATE NOT NUMERIC
  8172        MOVE ZEROS               TO CM-AH-PREMIUM-RATE
  8173     END-IF
  8174     MOVE CM-AH-PREMIUM-RATE     TO OUT-AH-RATE
  8175     IF CM-LOAN-APR NOT NUMERIC
  8176        MOVE ZEROS               TO CM-LOAN-APR
  8177     END-IF
  8178     MOVE CM-LOAN-APR            TO OUT-LOAN-APR
  8179     MOVE CM-LOAN-TERM           TO OUT-LOAN-TERM
  8180     MOVE CM-RATE-CLASS          TO OUT-RATE-CLASS
  8181     MOVE CM-PMT-EXTENSION-DAYS  TO OUT-EXT-DAYS
  8182     MOVE CM-UNDERWRITING-CODE   TO OUT-UCODE
  8183     MOVE CM-PREMIUM-TYPE        TO OUT-PREM-TYPE
  8184     MOVE CM-IND-GRP-TYPE        TO OUT-IND-GRP
  8185     MOVE CM-LOAN-OFFICER        TO OUT-LOAN-OFF
  8186     MOVE CM-REIN-TABLE          TO OUT-REIN-TABLE
  8187     MOVE CM-SPECIAL-REIN-CODE   TO OUT-SPEC-REIN
  8188     MOVE CM-LF-LOAN-EXPIRE-DT   TO DC-BIN-DATE-1
  8189     MOVE ' '                    TO DC-OPTION-CODE
  8190     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  8191     IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page 143
* NSRASBL.cbl
  8192        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  8193           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  8194              INTO OUT-LF-EXP-DT
  8195        END-STRING
  8196     END-IF
  8197     MOVE OUT-LF-EXP-DT          TO OUT-ORIG-LF-EXP-DT
  8198     MOVE CM-AH-LOAN-EXPIRE-DT   TO DC-BIN-DATE-1
  8199     MOVE ' '                    TO DC-OPTION-CODE
  8200     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  8201     IF NO-CONVERSION-ERROR
  8202        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  8203           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  8204              INTO OUT-AH-EXP-DT
  8205        END-STRING
  8206     END-IF
  8207     MOVE OUT-AH-EXP-DT          TO OUT-ORIG-AH-EXP-DT
  8208     MOVE CM-LOAN-1ST-PMT-DT     TO DC-BIN-DATE-1
  8209     MOVE ' '                    TO DC-OPTION-CODE
  8210     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  8211     IF NO-CONVERSION-ERROR
  8212        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  8213           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  8214              INTO OUT-1ST-PMT-DT
  8215        END-STRING
  8216     END-IF
  8217     MOVE CM-ENTRY-STATUS        TO OUT-ENTRY-STATUS
  8218     MOVE CM-ENTRY-DT            TO DC-BIN-DATE-1
  8219     MOVE ' '                    TO DC-OPTION-CODE
  8220     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  8221     IF NO-CONVERSION-ERROR
  8222        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  8223           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  8224              INTO OUT-ENTRY-DT
  8225        END-STRING
  8226     END-IF
  8227     MOVE CM-LF-CANCEL-EXIT-DT   TO DC-BIN-DATE-1
  8228     MOVE ' '                    TO DC-OPTION-CODE
  8229     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  8230     IF NO-CONVERSION-ERROR
  8231        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  8232           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  8233              INTO OUT-LF-CAN-EXIT-DT
  8234        END-STRING
  8235     END-IF
  8236     MOVE CM-LF-DEATH-DT         TO DC-BIN-DATE-1
  8237     MOVE ' '                    TO DC-OPTION-CODE
  8238     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  8239     IF NO-CONVERSION-ERROR
  8240        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  8241           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  8242              INTO OUT-LF-DTH-DT
  8243        END-STRING
  8244     END-IF
  8245     MOVE CM-LF-DEATH-EXIT-DT    TO DC-BIN-DATE-1
  8246     MOVE ' '                    TO DC-OPTION-CODE
  8247     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  8248     IF NO-CONVERSION-ERROR
  8249        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page 144
* NSRASBL.cbl
  8250           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  8251              INTO OUT-LF-DTH-EXIT-DT
  8252        END-STRING
  8253     END-IF
  8254     MOVE CM-LF-CURRENT-STATUS   TO OUT-LF-CUR-STATUS
  8255     IF OUT-AH-CAN-DT NOT = SPACES
  8256        MOVE OUT-AH-CAN-DT       TO OUT-CANCEL-DT
  8257     ELSE
  8258        MOVE OUT-LF-CAN-DT       TO OUT-CANCEL-DT
  8259     END-IF
  8260     MOVE CM-AH-CANCEL-EXIT-DT   TO DC-BIN-DATE-1
  8261     MOVE ' '                    TO DC-OPTION-CODE
  8262     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  8263     IF NO-CONVERSION-ERROR
  8264        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  8265           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  8266              INTO OUT-AH-CAN-EXIT-DT
  8267        END-STRING
  8268     END-IF
  8269     MOVE CM-AH-CURRENT-STATUS   TO OUT-AH-CUR-STATUS
  8270     IF CM-ENTRY-BATCH = LOW-VALUES
  8271        MOVE SPACES              TO CM-ENTRY-BATCH
  8272     END-IF
  8273     MOVE CM-ENTRY-BATCH         TO OUT-ENTRY-BATCH
  8274     IF CM-LF-EXIT-BATCH = LOW-VALUES
  8275        MOVE SPACES              TO CM-LF-EXIT-BATCH
  8276     END-IF
  8277     MOVE CM-LF-EXIT-BATCH       TO OUT-LF-EXIT-BATCH
  8278     IF CM-AH-EXIT-BATCH = LOW-VALUES
  8279        MOVE SPACES              TO CM-AH-EXIT-BATCH
  8280     END-IF
  8281     MOVE CM-AH-EXIT-BATCH       TO OUT-AH-EXIT-BATCH
  8282     MOVE WS-CHGBK-LIFE-PCT      TO OUT-LF-COMM-PCT
  8283     MOVE WS-CHGBK-AH-PCT        TO OUT-AH-COMM-PCT
  8284     MOVE CM-CERT-SFX            TO OUT-CERT-SFX
  8285     MOVE CM-CONTROL-PRIMARY     TO MA-CONTROL-PRIMARY
  8286     COMPUTE WS-WORK-PREM =
  8287        (CM-LF-PREMIUM-AMT + CM-LF-ALT-PREMIUM-AMT
  8288           + CM-AH-PREMIUM-AMT)
  8289     MOVE WS-WORK-PREM           TO OUT-TOT-PRM
  8290                                    OUT-ORIG-TOT-PREM
  8291     COMPUTE WS-WORK-REF =
  8292        (WS-WORK-LF-REF + WS-WORK-AH-REF)
  8293     MOVE WS-WORK-REF            TO OUT-TOT-REF
  8294                                    OUT-ORIG-TOT-REF
  8295     IF CM-LF-LOAN-EXPIRE-DT > CM-AH-LOAN-EXPIRE-DT
  8296        MOVE OUT-LF-EXP-DT       TO OUT-SCHED-EXP-DT
  8297     ELSE
  8298        MOVE OUT-AH-EXP-DT       TO OUT-SCHED-EXP-DT
  8299     END-IF
  8300     MOVE OUT-SCHED-EXP-DT       TO OUT-ORIG-SCHED-EXP-DT
  8301     IF CM-LF-ORIG-TERM > CM-AH-ORIG-TERM
  8302        MOVE CM-LF-ORIG-TERM     TO OUT-SCHED-TERM
  8303     ELSE
  8304        MOVE CM-AH-ORIG-TERM     TO OUT-SCHED-TERM
  8305     END-IF
  8306     MOVE OUT-SCHED-TERM         TO OUT-ORIG-SCHED-TERM
  8307     IF CM-NH-INT-ON-REFS NUMERIC
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page 145
* NSRASBL.cbl
  8308        IF CM-NH-INT-ON-REFS NOT = ZEROS
  8309           MOVE CM-NH-INT-ON-REFS TO OUT-TOT-INTEREST
  8310        END-IF
  8311     END-IF
  8312
  8313     IF BL-DATA-SRCE = '4' AND PROCESS-CANCEL
  8314        IF PB-C-LF-CANCEL-DT NOT = LOW-VALUES AND SPACES
  8315            MOVE WS-WORK-LF-REF TO WS-WORK-CMB-LF-PREM
  8316        END-IF
  8317        IF PB-C-AH-CANCEL-DT NOT = LOW-VALUES AND SPACES
  8318            MOVE WS-WORK-AH-REF TO WS-WORK-AH-PREM
  8319        END-IF
  8320     END-IF
  8321*
  8322*     IF BL-DATA-SRCE = '2'
  8323*        IF CM-LF-CANCEL-DT NOT = LOW-VALUES AND SPACES
  8324*            MOVE WS-WORK-LF-REF TO WS-WORK-CMB-LF-PREM
  8325*        END-IF
  8326*        IF CM-AH-CANCEL-DT NOT = LOW-VALUES AND SPACES
  8327*            MOVE WS-WORK-AH-REF TO WS-WORK-AH-PREM
  8328*        END-IF
  8329*     END-IF
  8330
  8331     COMPUTE WS-ACCT-LF-PORTION =
  8332        WS-WORK-LF-PREM * WS-CHGBK-LIFE-PCT
  8333     MOVE WS-ACCT-LF-PORTION TO OUT-ACCT-LF-PORTION
  8334                                OUT-ACCT-ORIG-LF-PORT
  8335     COMPUTE WS-ACCT-ALT-LF-PORTION =
  8336        WS-WORK-ALT-LF-PREM * WS-CHGBK-LIFE-PCT
  8337     MOVE WS-ACCT-ALT-LF-PORTION TO OUT-ACCT-ALT-LF-PORT
  8338                                OUT-ACCT-ORIG-ALT-LF-PORT
  8339     COMPUTE WS-ACCT-CMB-LF-PORTION =
  8340        WS-WORK-CMB-LF-PREM * WS-CHGBK-LIFE-PCT
  8341     MOVE WS-ACCT-CMB-LF-PORTION TO OUT-ACCT-CMB-LF-PORT
  8342                                OUT-ACCT-ORIG-CMB-LF-PORT
  8343     COMPUTE WS-ACCT-AH-PORTION =
  8344        WS-WORK-AH-PREM * WS-CHGBK-AH-PCT
  8345     MOVE WS-ACCT-AH-PORTION TO OUT-ACCT-AH-PORTION
  8346                                OUT-ACCT-ORIG-AH-PORT
  8347     COMPUTE WS-ACCT-PORTION =
  8348        WS-ACCT-CMB-LF-PORTION + WS-ACCT-AH-PORTION
  8349     MOVE WS-ACCT-PORTION TO OUT-ACCT-PORTION
  8350                                OUT-ACCT-ORIG-PORTION
  8351
  8352     COMPUTE WS-CSO-LF-PORTION =
  8353       WS-WORK-LF-PREM - WS-ACCT-LF-PORTION
  8354     MOVE WS-CSO-LF-PORTION TO OUT-CSO-LF-PORTION
  8355                               OUT-CSO-ORIG-LF-PORT
  8356     COMPUTE WS-CSO-ALT-LF-PORTION =
  8357       WS-WORK-ALT-LF-PREM - WS-ACCT-ALT-LF-PORTION
  8358     MOVE WS-CSO-ALT-LF-PORTION TO OUT-CSO-ALT-LF-PORT
  8359                                   OUT-CSO-ORIG-ALT-LF-PORT
  8360     COMPUTE WS-CSO-CMB-LF-PORTION =
  8361       WS-WORK-CMB-LF-PREM - WS-ACCT-CMB-LF-PORTION
  8362     MOVE WS-CSO-CMB-LF-PORTION TO OUT-CSO-CMB-LF-PORT
  8363                                   OUT-CSO-ORIG-CMB-LF-PORT
  8364     COMPUTE WS-CSO-AH-PORTION =
  8365        WS-WORK-AH-PREM - WS-ACCT-AH-PORTION
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page 146
* NSRASBL.cbl
  8366     MOVE WS-CSO-AH-PORTION TO OUT-CSO-AH-PORTION
  8367                               OUT-CSO-ORIG-AH-PORT
  8368     COMPUTE WS-CSO-PORTION =
  8369        WS-CSO-CMB-LF-PORTION + WS-CSO-AH-PORTION
  8370     MOVE WS-CSO-PORTION TO OUT-CSO-PORTION
  8371                            OUT-CSO-ORIG-PORTION
  8372     .
  8373 1110-EXIT.
  8374     EXIT.
  8375 1115-MATCH-COMPANY.
  8376     MOVE BL-COMP-ID             TO WS-ELCNTL-KEY
  8377     MOVE '1'                    TO WS-ELCNTL-REC-TYPE
  8378     MOVE +0                     TO WS-ELCNTL-SEQ-NO
  8379
  8380* EXEC CICS READ
  8381*       INTO    (CONTROL-FILE)
  8382*       DATASET ('ELCNTL')
  8383*       RIDFLD  (WS-ELCNTL-KEY)
  8384*       RESP    (WS-RESPONSE)
  8385*    END-EXEC
  8386     MOVE LENGTH OF
  8387      CONTROL-FILE
  8388       TO DFHEIV11
  8389     MOVE 'ELCNTL' TO DFHEIV1
  8390*    MOVE '&"IL       E          (  N#00008104' TO DFHEIV0
  8391     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  8392     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8393     MOVE X'204E233030303038313034' TO DFHEIV0(25:11)
  8394     CALL 'kxdfhei1' USING DFHEIV0,
  8395           DFHEIV1,
  8396           CONTROL-FILE,
  8397           DFHEIV11,
  8398           WS-ELCNTL-KEY,
  8399           DFHEIV99,
  8400           DFHEIV99,
  8401           DFHEIV99
  8402     MOVE EIBRESP  TO WS-RESPONSE
  8403     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8404     IF RESP-NORMAL
  8405        MOVE CF-COMPANY-CD       TO WS-COMPANY-CD
  8406     END-IF
  8407     .
  8408 1115-EXIT.
  8409     EXIT.
  8410 1120-MATCH-CARRIER.
  8411     MOVE BL-COMP-ID             TO WS-ELCNTL-KEY
  8412     MOVE '6'                    TO WS-ELCNTL-REC-TYPE
  8413     MOVE BL-CARRIER             TO WS-ELCNTL-CARR
  8414     MOVE +0                     TO WS-ELCNTL-SEQ-NO
  8415
  8416* EXEC CICS READ
  8417*       INTO    (CONTROL-FILE)
  8418*       DATASET ('ELCNTL')
  8419*       RIDFLD  (WS-ELCNTL-KEY)
  8420*       RESP    (WS-RESPONSE)
  8421*    END-EXEC
  8422     MOVE LENGTH OF
  8423      CONTROL-FILE
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page 147
* NSRASBL.cbl
  8424       TO DFHEIV11
  8425     MOVE 'ELCNTL' TO DFHEIV1
  8426*    MOVE '&"IL       E          (  N#00008121' TO DFHEIV0
  8427     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  8428     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8429     MOVE X'204E233030303038313231' TO DFHEIV0(25:11)
  8430     CALL 'kxdfhei1' USING DFHEIV0,
  8431           DFHEIV1,
  8432           CONTROL-FILE,
  8433           DFHEIV11,
  8434           WS-ELCNTL-KEY,
  8435           DFHEIV99,
  8436           DFHEIV99,
  8437           DFHEIV99
  8438     MOVE EIBRESP  TO WS-RESPONSE
  8439     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8440     IF RESP-NORMAL
  8441        MOVE CF-MAIL-TO-NAME     TO OUT-CARR-NAME
  8442     ELSE
  8443        MOVE 'UNKNOWN'           TO OUT-CARR-NAME
  8444     END-IF
  8445     .
  8446 1120-EXIT.
  8447     EXIT.
  8448 1125-MATCH-STATE.
  8449     MOVE BL-STATE               TO OUT-STATE
  8450     MOVE BL-COMP-ID             TO WS-ELCNTL-KEY
  8451     MOVE '3'                    TO WS-ELCNTL-REC-TYPE
  8452     MOVE BL-STATE               TO WS-ELCNTL-STATE
  8453     MOVE +0                     TO WS-ELCNTL-SEQ-NO
  8454
  8455* EXEC CICS READ
  8456*       INTO    (CONTROL-FILE)
  8457*       DATASET ('ELCNTL')
  8458*       RIDFLD  (WS-ELCNTL-KEY)
  8459*       RESP    (WS-RESPONSE)
  8460*    END-EXEC
  8461     MOVE LENGTH OF
  8462      CONTROL-FILE
  8463       TO DFHEIV11
  8464     MOVE 'ELCNTL' TO DFHEIV1
  8465*    MOVE '&"IL       E          (  N#00008141' TO DFHEIV0
  8466     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  8467     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8468     MOVE X'204E233030303038313431' TO DFHEIV0(25:11)
  8469     CALL 'kxdfhei1' USING DFHEIV0,
  8470           DFHEIV1,
  8471           CONTROL-FILE,
  8472           DFHEIV11,
  8473           WS-ELCNTL-KEY,
  8474           DFHEIV99,
  8475           DFHEIV99,
  8476           DFHEIV99
  8477     MOVE EIBRESP  TO WS-RESPONSE
  8478     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8479     IF RESP-NORMAL
  8480        MOVE CF-STATE-NAME       TO OUT-STATE-NAME
  8481     ELSE
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page 148
* NSRASBL.cbl
  8482        MOVE 'UNKNOWN'           TO OUT-STATE-NAME
  8483     END-IF
  8484     .
  8485 1125-EXIT.
  8486     EXIT.
  8487 1130-MATCH-BENCDS.
  8488     MOVE SPACES                 TO WS-LF-ABBRV
  8489                                    WS-LF-DESC
  8490                                    WS-LF-EARN
  8491                                    WS-WAIT-PER
  8492                                    WS-RET-ELIM
  8493                                    WS-AH-DESC
  8494                                    WS-BEN-DAYS
  8495     IF WS-LF-BENCD NOT = ZEROS AND SPACES
  8496        PERFORM 1140-MATCH-LFBEN THRU 1140-EXIT
  8497     END-IF
  8498     IF WS-AH-BENCD NOT = ZEROS AND SPACES
  8499        PERFORM 1150-MATCH-AHBEN THRU 1150-EXIT
  8500     END-IF
  8501     .
  8502 1130-EXIT.
  8503     EXIT.
  8504 1140-MATCH-LFBEN.
  8505     MOVE BL-COMP-ID             TO WS-ELCNTL-KEY
  8506     MOVE '4'                    TO WS-ELCNTL-REC-TYPE
  8507     MOVE WS-LF-BENCD            TO WS-ELCNTL-BEN-CD
  8508     MOVE +0                     TO WS-ELCNTL-SEQ-NO
  8509
  8510* EXEC CICS READ
  8511*       INTO    (CONTROL-FILE)
  8512*       DATASET ('ELCNTL')
  8513*       RIDFLD  (WS-ELCNTL-KEY)
  8514*       GTEQ
  8515*       RESP    (WS-RESPONSE)
  8516*    END-EXEC
  8517     MOVE LENGTH OF
  8518      CONTROL-FILE
  8519       TO DFHEIV11
  8520     MOVE 'ELCNTL' TO DFHEIV1
  8521*    MOVE '&"IL       G          (  N#00008177' TO DFHEIV0
  8522     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  8523     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8524     MOVE X'204E233030303038313737' TO DFHEIV0(25:11)
  8525     CALL 'kxdfhei1' USING DFHEIV0,
  8526           DFHEIV1,
  8527           CONTROL-FILE,
  8528           DFHEIV11,
  8529           WS-ELCNTL-KEY,
  8530           DFHEIV99,
  8531           DFHEIV99,
  8532           DFHEIV99
  8533     MOVE EIBRESP  TO WS-RESPONSE
  8534     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8535     IF RESP-NORMAL
  8536        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  8537           (WS-LF-BENCD = CF-BENEFIT-CODE (S1))
  8538           OR (S1 > +8)
  8539        END-PERFORM
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page 149
* NSRASBL.cbl
  8540        IF S1 < + 9
  8541           MOVE CF-BENEFIT-ALPHA (S1)
  8542                                 TO WS-LF-ABBRV
  8543           MOVE WS-LF-BENCD      TO WS-LF-DESC
  8544           MOVE CF-CO-EARNINGS-CALC (S1)
  8545                                 TO WS-LF-EARN
  8546        ELSE
  8547           MOVE 'XX'             TO WS-LF-DESC
  8548           MOVE 'XXX'            TO WS-LF-ABBRV
  8549        END-IF
  8550     ELSE
  8551        DISPLAY ' NO LF BEN CD ' WS-LF-BENCD
  8552     END-IF
  8553     .
  8554 1140-EXIT.
  8555     EXIT.
  8556 1150-MATCH-AHBEN.
  8557     MOVE BL-COMP-ID             TO WS-ELCNTL-KEY
  8558     MOVE '5'                    TO WS-ELCNTL-REC-TYPE
  8559     MOVE WS-AH-BENCD            TO WS-ELCNTL-BEN-CD
  8560     MOVE +0                     TO WS-ELCNTL-SEQ-NO
  8561
  8562* EXEC CICS READ
  8563*       INTO    (CONTROL-FILE)
  8564*       DATASET ('ELCNTL')
  8565*       RIDFLD  (WS-ELCNTL-KEY)
  8566*       GTEQ
  8567*       RESP    (WS-RESPONSE)
  8568*    END-EXEC
  8569     MOVE LENGTH OF
  8570      CONTROL-FILE
  8571       TO DFHEIV11
  8572     MOVE 'ELCNTL' TO DFHEIV1
  8573*    MOVE '&"IL       G          (  N#00008210' TO DFHEIV0
  8574     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  8575     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8576     MOVE X'204E233030303038323130' TO DFHEIV0(25:11)
  8577     CALL 'kxdfhei1' USING DFHEIV0,
  8578           DFHEIV1,
  8579           CONTROL-FILE,
  8580           DFHEIV11,
  8581           WS-ELCNTL-KEY,
  8582           DFHEIV99,
  8583           DFHEIV99,
  8584           DFHEIV99
  8585     MOVE EIBRESP  TO WS-RESPONSE
  8586     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8587     IF RESP-NORMAL
  8588        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  8589           (WS-AH-BENCD = CF-BENEFIT-CODE (S1))
  8590           OR (S1 > +8)
  8591        END-PERFORM
  8592        IF S1 < + 9
  8593           MOVE CF-BENEFIT-ALPHA (S1)
  8594                                 TO WS-WAIT-PER
  8595           MOVE CF-BENEFIT-ALPHA (S1) (3:1)
  8596                                 TO WS-RET-ELIM
  8597           MOVE CF-BENEFIT-ALPHA (S1) (1:2)
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page 150
* NSRASBL.cbl
  8598                                 TO WS-BEN-DAYS
  8599           IF CF-SPECIAL-CALC-CD (S1) = 'C'
  8600              IF CF-JOINT-INDICATOR (S1) = 'J'
  8601                 MOVE 'Joint Critical Period Disability'
  8602                                 TO WS-AH-DESC
  8603              ELSE
  8604                 MOVE 'Single Critical Period-Primary Only'
  8605                                 TO WS-AH-DESC
  8606              END-IF
  8607           ELSE
  8608              IF CF-JOINT-INDICATOR (S1) = 'J'
  8609                 MOVE 'Joint Disability'
  8610                                 TO WS-AH-DESC
  8611              ELSE
  8612                 MOVE 'Single Disability (Primary Only)'
  8613                                 TO WS-AH-DESC
  8614              END-IF
  8615           END-IF
  8616        ELSE
  8617           MOVE 'NOT FOUND'      TO WS-AH-DESC
  8618        END-IF
  8619     ELSE
  8620        DISPLAY ' NO AH BEN CD ' WS-AH-BENCD
  8621     END-IF
  8622     .
  8623 1150-EXIT.
  8624     EXIT.
  8625
  8626 1160-READ-CERT-TRAILER.
  8627
  8628     MOVE +0                     TO  WS-CERT-TRL-REC-NOT-FOUND.
  8629     MOVE WS-ELCERT-KEY          TO  WS-ELCRTT-PRIMARY.
  8630     MOVE 'C'                    TO  WS-ELCRTT-REC-TYPE.
  8631
  8632
  8633* EXEC CICS HANDLE CONDITION
  8634*        NOTFND (1160-CERT-TRL-REC-NOTFND)
  8635*    END-EXEC.
  8636*    MOVE '"$I                   ! " #00008262' TO DFHEIV0
  8637     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8638     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8639     MOVE X'2220233030303038323632' TO DFHEIV0(25:11)
  8640     CALL 'kxdfhei1' USING DFHEIV0
  8641     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8642
  8643
  8644
  8645* EXEC CICS READ
  8646*        DATASET  ('ELCRTT')
  8647*        RIDFLD   (WS-ELCRTT-KEY)
  8648*        INTO     (CERTIFICATE-TRAILERS)
  8649*    END-EXEC.
  8650     MOVE LENGTH OF
  8651      CERTIFICATE-TRAILERS
  8652       TO DFHEIV11
  8653     MOVE 'ELCRTT' TO DFHEIV1
  8654*    MOVE '&"IL       E          (   #00008266' TO DFHEIV0
  8655     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page 151
* NSRASBL.cbl
  8656     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8657     MOVE X'2020233030303038323636' TO DFHEIV0(25:11)
  8658     CALL 'kxdfhei1' USING DFHEIV0,
  8659           DFHEIV1,
  8660           CERTIFICATE-TRAILERS,
  8661           DFHEIV11,
  8662           WS-ELCRTT-KEY,
  8663           DFHEIV99,
  8664           DFHEIV99,
  8665           DFHEIV99
  8666     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8667
  8668
  8669     GO TO 1160-EXIT.
  8670
  8671 1160-CERT-TRL-REC-NOTFND.
  8672     MOVE +1                     TO WS-CERT-TRL-REC-NOT-FOUND.
  8673
  8674 1160-EXIT.
  8675     EXIT.
  8676 1200-GET-ERACCT.
  8677     MOVE WS-ERACCT-KEY          TO WS-SAVE-ERACCT-KEY
  8678     MOVE ' UNKNOWN '            TO OUT-ACCT-NAME
  8679                                    OUT-ACCT-ADDR1
  8680                                    OUT-ACCT-ADDR2
  8681                                    OUT-ACCT-CITY
  8682     MOVE ZEROS                  TO WS-CHGBACK
  8683
  8684* EXEC CICS STARTBR
  8685*        DATASET   ('ERACCT')
  8686*        RIDFLD    (WS-ERACCT-KEY)
  8687*        GTEQ
  8688*        RESP      (WS-RESPONSE)
  8689*    END-EXEC
  8690     MOVE 'ERACCT' TO DFHEIV1
  8691     MOVE 0
  8692       TO DFHEIV11
  8693*    MOVE '&,         G          &  N#00008286' TO DFHEIV0
  8694     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8695     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8696     MOVE X'204E233030303038323836' TO DFHEIV0(25:11)
  8697     CALL 'kxdfhei1' USING DFHEIV0,
  8698           DFHEIV1,
  8699           WS-ERACCT-KEY,
  8700           DFHEIV99,
  8701           DFHEIV11,
  8702           DFHEIV99
  8703     MOVE EIBRESP  TO WS-RESPONSE
  8704     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8705     IF RESP-NORMAL
  8706
  8707* EXEC CICS READNEXT
  8708*          INTO    (ACCOUNT-MASTER)
  8709*          DATASET ('ERACCT')
  8710*          RIDFLD  (WS-ERACCT-KEY)
  8711*          RESP    (WS-RESPONSE)
  8712*       END-EXEC
  8713     MOVE LENGTH OF
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page 152
* NSRASBL.cbl
  8714      ACCOUNT-MASTER
  8715       TO DFHEIV12
  8716     MOVE 'ERACCT' TO DFHEIV1
  8717     MOVE 0
  8718       TO DFHEIV11
  8719*    MOVE '&.IL                  )  N#00008293' TO DFHEIV0
  8720     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  8721     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8722     MOVE X'204E233030303038323933' TO DFHEIV0(25:11)
  8723     CALL 'kxdfhei1' USING DFHEIV0,
  8724           DFHEIV1,
  8725           ACCOUNT-MASTER,
  8726           DFHEIV12,
  8727           WS-ERACCT-KEY,
  8728           DFHEIV99,
  8729           DFHEIV11,
  8730           DFHEIV99,
  8731           DFHEIV99
  8732     MOVE EIBRESP  TO WS-RESPONSE
  8733     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8734     END-IF
  8735     IF RESP-NORMAL
  8736        PERFORM UNTIL
  8737           NOT (RESP-NORMAL)
  8738           OR (WS-SAVE-ERACCT-KEY NOT =
  8739                        AM-CONTROL-PRIMARY (1:20))
  8740           IF BL-DATA-SRCE = '4' OR '2'
  8741              IF (WS-CERT-EFF-DT < AM-EXPIRATION-DT
  8742                 AND >= AM-EFFECTIVE-DT)
  8743                 PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  8744                    (AM-COM-TYP (S1) = 'C' OR 'D')
  8745                    OR (S1 > +10)
  8746                 END-PERFORM
  8747                 IF S1 < +11
  8748                    MOVE AM-COMM-CHARGEBACK (S1)
  8749                                 TO WS-CHGBACK
  8750                 END-IF
  8751              END-IF
  8752           END-IF
  8753           MOVE ACCOUNT-MASTER   TO WS-SAVE-ERACCT-REC
  8754
  8755* EXEC CICS READNEXT
  8756*             INTO    (ACCOUNT-MASTER)
  8757*             DATASET ('ERACCT')
  8758*             RIDFLD  (WS-ERACCT-KEY)
  8759*             RESP    (WS-RESPONSE)
  8760*          END-EXEC
  8761     MOVE LENGTH OF
  8762      ACCOUNT-MASTER
  8763       TO DFHEIV12
  8764     MOVE 'ERACCT' TO DFHEIV1
  8765     MOVE 0
  8766       TO DFHEIV11
  8767*    MOVE '&.IL                  )  N#00008319' TO DFHEIV0
  8768     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  8769     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8770     MOVE X'204E233030303038333139' TO DFHEIV0(25:11)
  8771     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page 153
* NSRASBL.cbl
  8772           DFHEIV1,
  8773           ACCOUNT-MASTER,
  8774           DFHEIV12,
  8775           WS-ERACCT-KEY,
  8776           DFHEIV99,
  8777           DFHEIV11,
  8778           DFHEIV99,
  8779           DFHEIV99
  8780     MOVE EIBRESP  TO WS-RESPONSE
  8781     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8782        END-PERFORM
  8783        MOVE WS-SAVE-ERACCT-REC  TO ACCOUNT-MASTER
  8784        IF WS-SAVE-ERACCT-KEY = AM-CONTROL-PRIMARY (1:20)
  8785           SET ACCT-FOUND TO TRUE
  8786           MOVE AM-NAME          TO OUT-ACCT-NAME
  8787           MOVE AM-ADDRS         TO OUT-ACCT-ADDR1
  8788           MOVE SPACES           TO OUT-ACCT-ADDR2
  8789           MOVE AM-ADDR-CITY     TO OUT-ACCT-CITY
  8790           MOVE AM-ADDR-STATE    TO OUT-ACCT-STATE
  8791           MOVE AM-ZIP-PRIME     TO OUT-ACCT-ZIP
  8792           MOVE AM-CONTROL-NAME  TO OUT-ACCT-CNTRL-NAME
  8793           MOVE AM-REPORT-CODE-1 TO OUT-RPT-CD1
  8794           MOVE AM-REPORT-CODE-2 TO OUT-RPT-CD2
  8795           IF AM-ZIP-PLUS4 NOT = SPACES AND ZEROS
  8796              STRING '-' AM-ZIP-PLUS4 DELIMITED BY SIZE
  8797                 INTO OUT-ACCT-ZIP (6:5)
  8798              END-STRING
  8799           END-IF
  8800           MOVE AM-TEL-NO        TO OUT-ACCT-PHONE
  8801           MOVE AM-GPCD          TO OUT-ACCT-BUS-TYPE
  8802           MOVE AM-STATE         TO OUT-FORM
  8803           IF AM-ACCOUNT (10:1) = 'L'
  8804              MOVE 'L'           TO OUT-FORM (3:1)
  8805                                    OUT-LEASE-IND
  8806           END-IF
  8807           MOVE AM-CONTROL-PRIMARY (1:8)
  8808                                 TO WS-ERCOMP-KEY
  8809           IF AM-REMIT-TO NOT NUMERIC
  8810              MOVE 01            TO AM-REMIT-TO
  8811           END-IF
  8812           MOVE AM-AGT (AM-REMIT-TO) TO WS-ERCOMP-RESP-NO
  8813           PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  8814              (AM-COM-TYP (S1) = 'C' OR 'D')
  8815              OR (S1 > +10)
  8816           END-PERFORM
  8817           IF S1 < +11
  8818              MOVE AM-AGT (S1)   TO WS-ERCOMP-ACCOUNT
  8819           END-IF
  8820           MOVE 'A'              TO WS-ERCOMP-REC-TYPE
  8821           PERFORM 1225-GET-ERCOMP THRU 1225-EXIT
  8822        END-IF
  8823     END-IF
  8824
  8825* EXEC CICS ENDBR
  8826*        DATASET   ('ERACCT')
  8827*    END-EXEC
  8828     MOVE 'ERACCT' TO DFHEIV1
  8829     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page 154
* NSRASBL.cbl
  8830       TO DFHEIV11
  8831*    MOVE '&2                    $   #00008367' TO DFHEIV0
  8832     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8833     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8834     MOVE X'2020233030303038333637' TO DFHEIV0(25:11)
  8835     CALL 'kxdfhei1' USING DFHEIV0,
  8836           DFHEIV1,
  8837           DFHEIV11,
  8838           DFHEIV99
  8839     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8840    .
  8841 1200-EXIT.
  8842     EXIT.
  8843 1225-GET-ERCOMP.
  8844
  8845* EXEC CICS READ
  8846*       INTO    (COMPENSATION-MASTER)
  8847*       DATASET ('ERCOMP')
  8848*       RIDFLD  (WS-ERCOMP-KEY)
  8849*       RESP    (WS-RESPONSE)
  8850*    END-EXEC
  8851     MOVE LENGTH OF
  8852      COMPENSATION-MASTER
  8853       TO DFHEIV11
  8854     MOVE 'ERCOMP' TO DFHEIV1
  8855*    MOVE '&"IL       E          (  N#00008374' TO DFHEIV0
  8856     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  8857     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8858     MOVE X'204E233030303038333734' TO DFHEIV0(25:11)
  8859     CALL 'kxdfhei1' USING DFHEIV0,
  8860           DFHEIV1,
  8861           COMPENSATION-MASTER,
  8862           DFHEIV11,
  8863           WS-ERCOMP-KEY,
  8864           DFHEIV99,
  8865           DFHEIV99,
  8866           DFHEIV99
  8867     MOVE EIBRESP  TO WS-RESPONSE
  8868     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8869     IF RESP-NORMAL
  8870        MOVE CO-RESP-NO          TO OUT-RESP-NO
  8871        MOVE CO-ACCT-NAME        TO OUT-COMP-NAME
  8872        MOVE CO-MAIL-NAME        TO OUT-COMP-MAIL-TO
  8873        MOVE CO-ADDR-1           TO OUT-COMP-ADDR1
  8874        MOVE CO-ADDR-2           TO OUT-COMP-ADDR2
  8875        MOVE CO-ADDR-CITY        TO OUT-COMP-CITY
  8876        MOVE CO-ADDR-STATE       TO OUT-COMP-STATE
  8877        MOVE CO-ZIP              TO OUT-COMP-ZIP
  8878        MOVE CO-TELEPHONE        TO OUT-COMP-PHONE
  8879        MOVE CO-FAXNO            TO OUT-COMP-FAX
  8880        MOVE CO-GA-STATUS-CODE   TO OUT-COMP-STATUS
  8881        MOVE CO-BILL-SW          TO OUT-BILL-SW
  8882     END-IF
  8883     .
  8884 1225-EXIT.
  8885     EXIT.
  8886 1250-GET-ELLETR.
  8887     display ' made it to 1250 '
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page 155
* NSRASBL.cbl
  8888     move spaces                 to W-Z-CONTROL-DATA
  8889     MOVE WS-COMPANY-CD          TO WS-ELLETR-COMPANY-CD
  8890     MOVE BL-LETTER-ID           TO WS-ELLETR-LETTER-ID
  8891     MOVE +0                     TO WS-ELLETR-SEQ-NO
  8892
  8893* EXEC CICS READ
  8894*         DATASET    ('ELLETR')
  8895*         INTO       (TEXT-FILES)
  8896*         RIDFLD     (WS-ELLETR-KEY)
  8897*         RESP       (WS-RESPONSE)
  8898*         GTEQ
  8899*    END-EXEC
  8900     MOVE LENGTH OF
  8901      TEXT-FILES
  8902       TO DFHEIV11
  8903     MOVE 'ELLETR' TO DFHEIV1
  8904*    MOVE '&"IL       G          (  N#00008403' TO DFHEIV0
  8905     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  8906     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8907     MOVE X'204E233030303038343033' TO DFHEIV0(25:11)
  8908     CALL 'kxdfhei1' USING DFHEIV0,
  8909           DFHEIV1,
  8910           TEXT-FILES,
  8911           DFHEIV11,
  8912           WS-ELLETR-KEY,
  8913           DFHEIV99,
  8914           DFHEIV99,
  8915           DFHEIV99
  8916     MOVE EIBRESP  TO WS-RESPONSE
  8917     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8918     IF RESP-NORMAL
  8919        IF (LETTER-FILE-TEXT)
  8920           AND (BL-LETTER-ID = TX-LETTER-NO)
  8921           AND (TX-LINE-SQUEEZE-CONTROL = 'Z')
  8922           display ' found good z record '
  8923           PERFORM 1280-PROCESS-Z-CONTROLS
  8924                                 THRU 1280-EXIT
  8925        END-IF
  8926     END-IF
  8927     .
  8928 1250-EXIT.
  8929     EXIT.
  8930 1280-PROCESS-Z-CONTROLS.
  8931     MOVE TX-TEXT-LINE           TO W-Z-CONTROL-DATA
  8932*    IF W-FORM-TO-RESEND > SPACES
  8933*       MOVE W-FORM-TO-RESEND    TO OUT-FORM
  8934*    ELSE
  8935*       MOVE SPACES              TO OUT-FORM
  8936*    END-IF
  8937     IF BL-ENC-CD = SPACES OR LOW-VALUES
  8938        MOVE W-ENCLOSURE-CD         TO BL-ENC-CD
  8939     END-IF
  8940     MOVE W-LETTER-TYPE          TO OUT-LETTER-TYPE
  8941     MOVE W-PRINT-CERTIFICATE    TO OUT-PRINT-CERTIFICATE
  8942     .
  8943 1280-EXIT.
  8944     EXIT.
  8945 1300-DETERMINE-COMM.
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page 156
* NSRASBL.cbl
  8946******************************************************************
  8947* DATA SOURCE MEANINGS  BL-DATA-SRCE
  8948*    1) FROM ACCT MAINT
  8949*    2) FROM CERT UPDATE
  8950*    3) FROM COMP MAINT
  8951*    4) FROM REVIEW AND CORRECTIONS
  8952******************************************************************
  8953     MOVE 'Y'                    TO OUT-CHGBACK
  8954     MOVE ZEROS                  TO WS-DIFF
  8955                                    WS-CHGBK-LIFE-PCT
  8956                                    WS-CHGBK-AH-PCT
  8957     IF BL-DATA-SRCE = '4'
  8958        IF PB-CANCELLATION
  8959           MOVE PB-CI-LIFE-COMMISSION TO WS-CHGBK-LIFE-PCT
  8960           MOVE PB-CI-AH-COMMISSION   TO WS-CHGBK-AH-PCT
  8961           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
  8962           MOVE PB-C-AH-CANCEL-DT TO DC-BIN-DATE-2
  8963           IF PB-C-LF-CANCEL-DT > DC-BIN-DATE-2
  8964              MOVE PB-C-LF-CANCEL-DT
  8965                                 TO DC-BIN-DATE-2
  8966           END-IF
  8967           MOVE '1'              TO DC-OPTION-CODE
  8968           PERFORM 9700-DATE-LINK THRU 9700-EXIT
  8969           IF NO-CONVERSION-ERROR
  8970              MOVE DC-ELAPSED-MONTHS TO WS-DIFF
  8971              IF DC-ODD-DAYS-OVER > +1
  8972                 ADD +1          TO WS-DIFF
  8973              END-IF
  8974              IF (WS-CHGBACK = 99)
  8975                 OR (WS-DIFF > WS-CHGBACK AND WS-CHGBACK > 0)
  8976                   MOVE +0   TO WS-CHGBK-LIFE-PCT
  8977                                WS-CHGBK-AH-PCT
  8978                   MOVE 'N'  TO OUT-CHGBACK
  8979              END-IF
  8980           END-IF
  8981        ELSE
  8982           MOVE PB-I-LIFE-COMMISSION TO WS-CHGBK-LIFE-PCT
  8983           MOVE PB-I-AH-COMMISSION   TO WS-CHGBK-AH-PCT
  8984        END-IF
  8985     ELSE
  8986        MOVE CM-LIFE-COMM-PCT TO WS-CHGBK-LIFE-PCT
  8987        MOVE CM-AH-COMM-PCT   TO WS-CHGBK-AH-PCT
  8988        IF (CM-LF-CANCEL-DT NOT = LOW-VALUES AND SPACES)
  8989           OR (CM-AH-CANCEL-DT NOT = LOW-VALUES AND SPACES)
  8990           MOVE CM-CERT-EFF-DT   TO DC-BIN-DATE-1
  8991           MOVE CM-AH-CANCEL-DT  TO DC-BIN-DATE-2
  8992           IF CM-LF-CANCEL-DT > DC-BIN-DATE-2
  8993              MOVE CM-LF-CANCEL-DT TO DC-BIN-DATE-2
  8994           END-IF
  8995           MOVE '1'              TO DC-OPTION-CODE
  8996           PERFORM 9700-DATE-LINK THRU 9700-EXIT
  8997           IF NO-CONVERSION-ERROR
  8998              MOVE DC-ELAPSED-MONTHS TO WS-DIFF
  8999              IF DC-ODD-DAYS-OVER > +1
  9000                 ADD +1          TO WS-DIFF
  9001              END-IF
  9002              IF (WS-CHGBACK = 99)
  9003                 OR (WS-DIFF > WS-CHGBACK AND WS-CHGBACK > 0)
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page 157
* NSRASBL.cbl
  9004                   MOVE +0   TO WS-CHGBK-LIFE-PCT
  9005                                WS-CHGBK-AH-PCT
  9006                   MOVE 'N'  TO OUT-CHGBACK
  9007              END-IF
  9008           END-IF
  9009        END-IF
  9010     END-IF
  9011     .
  9012 1300-EXIT.
  9013     EXIT.
  9014 1500-GET-ARCH-NO.
  9015     DISPLAY ' MADE IT TO 1500 '
  9016     MOVE BL-COMP-ID             TO WS-ELCNTL-COMPANY-ID
  9017     MOVE '1'                    TO WS-ELCNTL-REC-TYPE
  9018     MOVE SPACES                 TO WS-ELCNTL-GENL
  9019     MOVE +0                     TO WS-ELCNTL-SEQ-NO
  9020
  9021* EXEC CICS READ
  9022*       INTO    (CONTROL-FILE)
  9023*       DATASET ('ELCNTL')
  9024*       RIDFLD  (WS-ELCNTL-KEY)
  9025*       UPDATE
  9026*       RESP    (WS-RESPONSE)
  9027*    END-EXEC
  9028     MOVE LENGTH OF
  9029      CONTROL-FILE
  9030       TO DFHEIV11
  9031     MOVE 'ELCNTL' TO DFHEIV1
  9032*    MOVE '&"IL       EU         (  N#00008512' TO DFHEIV0
  9033     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  9034     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9035     MOVE X'204E233030303038353132' TO DFHEIV0(25:11)
  9036     CALL 'kxdfhei1' USING DFHEIV0,
  9037           DFHEIV1,
  9038           CONTROL-FILE,
  9039           DFHEIV11,
  9040           WS-ELCNTL-KEY,
  9041           DFHEIV99,
  9042           DFHEIV99,
  9043           DFHEIV99
  9044     MOVE EIBRESP  TO WS-RESPONSE
  9045     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9046     IF RESP-NORMAL
  9047        AND (CF-COMPANY-ID  = BL-COMP-ID)
  9048        AND (CF-RECORD-TYPE = '1')
  9049        ADD +1                   TO CF-CREDIT-LAST-ARCH-NUM
  9050        MOVE CF-CREDIT-LAST-ARCH-NUM
  9051                                 TO WS-ARCHIVE-NO
  9052
  9053* EXEC CICS REWRITE
  9054*          FROM    (CONTROL-FILE)
  9055*          DATASET ('ELCNTL')
  9056*       END-EXEC
  9057     MOVE LENGTH OF
  9058      CONTROL-FILE
  9059       TO DFHEIV11
  9060     MOVE 'ELCNTL' TO DFHEIV1
  9061*    MOVE '&& L                  %   #00008525' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page 158
* NSRASBL.cbl
  9062     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9063     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9064     MOVE X'2020233030303038353235' TO DFHEIV0(25:11)
  9065     CALL 'kxdfhei1' USING DFHEIV0,
  9066           DFHEIV1,
  9067           CONTROL-FILE,
  9068           DFHEIV11,
  9069           DFHEIV99
  9070     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9071     ELSE
  9072        MOVE +0                  TO WS-ARCHIVE-NO
  9073     END-IF
  9074    .
  9075 1500-EXIT.
  9076     EXIT.
  9077 1700-GET-ELENCC.
  9078     MOVE WS-COMPANY-CD          TO WS-ELENCC-KEY
  9079     MOVE '2'                    TO WS-ELENCC-REC-TYPE
  9080     MOVE BL-ENC-CD              TO WS-ELENCC-ENC-CODE
  9081     PERFORM VARYING E1 FROM +1 BY +1 UNTIL
  9082        (WS-ELENCC-ENC-CODE (E1:1) = ' ')
  9083        OR (E1 > +5)
  9084     END-PERFORM
  9085     IF E1 < +5
  9086        MOVE BL-STATE            TO WS-ELENCC-ENC-CODE (E1:2)
  9087     END-IF
  9088
  9089* EXEC CICS READ
  9090*        DATASET   ('ELENCC')
  9091*        INTO      (ENCLOSURE-CODES)
  9092*        RIDFLD    (WS-ELENCC-KEY)
  9093*        RESP      (WS-RESPONSE)
  9094*    END-EXEC
  9095     MOVE LENGTH OF
  9096      ENCLOSURE-CODES
  9097       TO DFHEIV11
  9098     MOVE 'ELENCC' TO DFHEIV1
  9099*    MOVE '&"IL       E          (  N#00008546' TO DFHEIV0
  9100     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  9101     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9102     MOVE X'204E233030303038353436' TO DFHEIV0(25:11)
  9103     CALL 'kxdfhei1' USING DFHEIV0,
  9104           DFHEIV1,
  9105           ENCLOSURE-CODES,
  9106           DFHEIV11,
  9107           WS-ELENCC-KEY,
  9108           DFHEIV99,
  9109           DFHEIV99,
  9110           DFHEIV99
  9111     MOVE EIBRESP  TO WS-RESPONSE
  9112     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9113     IF NOT RESP-NORMAL
  9114        display ' elencc resp not normal ' ws-response
  9115        MOVE BL-ENC-CD           TO WS-ELENCC-ENC-CODE
  9116
  9117* EXEC CICS READ
  9118*           DATASET   ('ELENCC')
  9119*           INTO      (ENCLOSURE-CODES)
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page 159
* NSRASBL.cbl
  9120*           RIDFLD    (WS-ELENCC-KEY)
  9121*           RESP      (WS-RESPONSE)
  9122*       END-EXEC
  9123     MOVE LENGTH OF
  9124      ENCLOSURE-CODES
  9125       TO DFHEIV11
  9126     MOVE 'ELENCC' TO DFHEIV1
  9127*    MOVE '&"IL       E          (  N#00008555' TO DFHEIV0
  9128     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  9129     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9130     MOVE X'204E233030303038353535' TO DFHEIV0(25:11)
  9131     CALL 'kxdfhei1' USING DFHEIV0,
  9132           DFHEIV1,
  9133           ENCLOSURE-CODES,
  9134           DFHEIV11,
  9135           WS-ELENCC-KEY,
  9136           DFHEIV99,
  9137           DFHEIV99,
  9138           DFHEIV99
  9139     MOVE EIBRESP  TO WS-RESPONSE
  9140     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9141     END-IF
  9142     IF RESP-NORMAL
  9143        display ' elencc resp normal ' ws-response
  9144        MOVE NC-OUTPUT-STACK     TO OUT-STACK
  9145        MOVE NC-ENCLOSURE-LINE   TO OUT-ENC-LINE
  9146        MOVE NC-ATTACHMENTS      TO OUT-ATTACH
  9147     END-IF
  9148     .
  9149 1700-EXIT.
  9150     EXIT.
  9151
  9152
  9153 4100-CONNECT-TO-DB.
  9154
  9155     IF SVR > SPACES
  9156        CONTINUE
  9157     ELSE
  9158        MOVE 'NTCSO2_LOGIC'         TO SVR
  9159        MOVE 'sa'                   TO USR
  9160        MOVE 'ntcso2'               TO PASS
  9161     END-IF
  9162
  9163     STRING
  9164         USR DELIMITED SPACE
  9165         "." DELIMITED SIZE
  9166         PASS DELIMITED SPACE INTO USR-PASS
  9167     END-STRING
  9168
  9169     EXEC SQL
  9170        CONNECT TO :SVR USER :USR-PASS
  9171     END-EXEC
  9172
  9173     IF SQLCODE NOT = 0
  9174        DISPLAY "ERROR: CANNOT CONNECT "
  9175        DISPLAY SQLCODE
  9176        DISPLAY SQLERRMC
  9177        GO TO 4100-EXIT
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page 160
* NSRASBL.cbl
  9178     END-IF
  9179
  9180     .
  9181 4100-EXIT.
  9182     EXIT.
  9183
  9184
  9185
  9186 4200-GET-NEXT-BUS-DT.
  9187
  9188     MOVE WS-SAVE-EDIT-A-DATE    TO WS-CYCLE-DATE
  9189     MOVE SPACES                 TO WS-NEXT-BUS-DT
  9190
  9191     IF WS-KIXHOST = 'logictest'
  9192        EXEC SQL
  9193          CALL NaperTestCalcNextBusDt
  9194                        @cycledate = :WS-CYCLE-DATE,
  9195                        @nextbusdate = :WS-NEXT-BUS-DT OUT
  9196        END-EXEC
  9197     ELSE
  9198        EXEC SQL
  9199          CALL NaperProdCalcNextBusDt
  9200                        @cycledate = :WS-CYCLE-DATE,
  9201                        @nextbusdate = :WS-NEXT-BUS-DT OUT
  9202        END-EXEC
  9203     END-IF
  9204
  9205     IF SQLCODE NOT = 0
  9206        DISPLAY "ERROR: DID NOT RETURN NEXT BUS DT "
  9207        DISPLAY ' SQL RETURN CODE ' SQLCODE
  9208        DISPLAY ' SQL ERR MESS    ' SQLERRMC
  9209        GO TO 4200-EXIT
  9210     END-IF
  9211
  9212     .
  9213 4200-EXIT.
  9214     EXIT.
  9215
  9216
  9217
  9218 4300-DISCONNECT.
  9219
  9220     EXEC SQL
  9221        DISCONNECT
  9222     END-EXEC
  9223     .
  9224 4300-EXIT.
  9225     EXIT.
  9226
  9227
  9228 4500-CHECK-BALLOON-STATE.
  9229
  9230     IF WS-KIXHOST = 'logictest'
  9231        MOVE 'NTCSO2_NaperRepo'     TO SVR
  9232        MOVE 'sa'                   TO USR
  9233        MOVE 'ntcso2'               TO PASS
  9234        MOVE '1011'                 TO WS-LOOKUPID
  9235     ELSE
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page 161
* NSRASBL.cbl
  9236        MOVE 'NTCSO3_NaperRepo'     TO SVR
  9237        MOVE 'sa'                   TO USR
  9238        MOVE 'ntcso3'               TO PASS
  9239        MOVE '1020'                 TO WS-LOOKUPID
  9240     END-IF
  9241
  9242     MOVE SPACES                 TO WS-LOOKUP-VALUE
  9243
  9244     PERFORM 4100-CONNECT-TO-DB  THRU 4100-EXIT
  9245     MOVE CM-STATE TO WS-LOOKUPKEY
  9246     MOVE 'B'      TO WS-LOOKUPKEY (3:1)
  9247
  9248     EXEC SQL
  9249           SELECT LOOKUPVALUE
  9250             INTO :WS-LOOKUP-VALUE
  9251             FROM LOOKUPVALUES
  9252               WHERE LOOKUPID = :WS-LOOKUPID
  9253                 AND LOOKUPKEY = :WS-LOOKUPKEY
  9254     END-EXEC
  9255
  9256     IF SQLCODE = 0
  9257       OR SQLCODE = 100
  9258        CONTINUE
  9259     ELSE
  9260        DISPLAY "ERROR: INVALID BALLOON STATE SELECT "
  9261        DISPLAY ' SQL RETURN CODE ' SQLCODE
  9262        DISPLAY ' SQL ERR MESS    ' SQLERRMC
  9263     END-IF
  9264
  9265     PERFORM 4300-DISCONNECT THRU 4300-EXIT.
  9266
  9267 4500-EXIT.
  9268     EXIT.
  9269 9700-DATE-LINK.
  9270
  9271* EXEC CICS LINK
  9272*        PROGRAM   ('ELDATCV')
  9273*        COMMAREA  (DATE-CONVERSION-DATA)
  9274*        LENGTH    (DC-COMM-LENGTH)
  9275*    END-EXEC.
  9276     MOVE 'ELDATCV' TO DFHEIV1
  9277*    MOVE '."C                   (   #00008690' TO DFHEIV0
  9278     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9279     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9280     MOVE X'2020233030303038363930' TO DFHEIV0(25:11)
  9281     CALL 'kxdfhei1' USING DFHEIV0,
  9282           DFHEIV1,
  9283           DATE-CONVERSION-DATA,
  9284           DC-COMM-LENGTH,
  9285           DFHEIV99,
  9286           DFHEIV99,
  9287           DFHEIV99,
  9288           DFHEIV99
  9289     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9290
  9291 9700-EXIT.
  9292      EXIT.
  9293
* Micro Focus Server Express         V5.1 revision 000 09-Feb-16 10:12 Page 162
* NSRASBL.cbl
  9294 9999-DFHBACK SECTION.
  9295     MOVE '9%                    "   ' TO DFHEIV0
  9296     MOVE 'NSRASBL' TO DFHEIV1
  9297     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  9298     GOBACK.
  9299 9999-DFHEXIT.
  9300     IF DFHEIGDJ EQUAL 0001
  9301         NEXT SENTENCE
  9302     ELSE IF DFHEIGDJ EQUAL 2
  9303         GO TO 1160-CERT-TRL-REC-NOTFND
  9304         DEPENDING ON DFHEIGDI.
  9305     MOVE '9%                    "   ' TO DFHEIV0
  9306     MOVE 'NSRASBL' TO DFHEIV1
  9307     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  9308     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:      168596     Code:       58483
